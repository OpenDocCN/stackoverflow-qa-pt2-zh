# StackOverflow 问答 15617000-15617999

# javascript - 通过 jquery 将单选按钮的值设置为最近输入文本中的文本

> ID：15617002
> 
> 赞同：0
> 
> 时间：2013-03-25T14:08:06.753
> 
> 标签：javascript, html, jquery-ui, jquery

我有一个动态添加表单元素的表单。我添加的元素是一个文本字段和一个单选按钮。现在，我希望所选单选按钮的值是用户在相邻输入框中键入的文本。这是JS：

```
var $node = "";
var varCount=0; 

$('body').on('click', '.removeVar', function(){        
    $(this).parent().remove();
    varCount--;
});
$('#addfld').on('click', function(){
    varCount++;
    $node = '<label for="losfldlbl[]">Field Name '+varCount+': </label>' +
            '<input type="text" name="losfldlbl[]" id="losfldlbl[]" title="Custom field name cannot be blank" required=true placeholder="Field name'+varCount+'"/>'+
            'Is this the value field? &nbsp;<input type="radio" name="losvaluefld[]" id="losvaluefld[]" value=false />&nbsp;&nbsp;'+
            '<span class="removeVar label label-important"><a id="removeFld" href="#" title="Click here to remove this field"><i class="icon-minus icon-white"></i></a></span>';

    $(this).parent().before($node);
});
$('input:radio').click(function() {
    $(this).attr('value', $(this).prev().attr("value"));
    alert($(this).val());
}); 
```

这是我的 HTML：

```
<form id='myForm'>
click on the yellow button custom fields &nbsp;&nbsp;&nbsp;<span class='label label-warning'><a id='addfld' href='#' title='Click here to add a new field'><i class='icon-plus icon-white'></i></a></span>&nbsp;    
</form> 
```

我在[这里分享了一个 JsFiddle](http://jsfiddle.net/Pyj7K/1/)。问题是我无法将输入文本中的值传递给单选按钮的值。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-25T14:14:04.393

问题是您选择单选按钮并在页面上存在单选按钮之前附加事件处理程序。

我建议使用`on`为将来添加的单选按钮委托事件：

```
$(document.body).on('click', 'input:radio', function() {
  $(this).attr('value', $(this).prev().attr("value"));

    alert($(this).val());
}); 
```

**更新示例：http:** [//jsfiddle.net/Pyj7K/2/](http://jsfiddle.net/Pyj7K/2/)

# oracle - groovy.sql.Sql 使用 Oracle 10g 调用 firstRow 时出错

> ID：15617007
> 
> 赞同：2
> 
> 时间：2013-03-25T14:08:43.157
> 
> 标签：oracle, groovy

我正在使用 Groovy 的 groovy.sql.Sql 来查询 Oracle 10g 数据库。它工作得很好，除了我在[firstRow](http://groovy.codehaus.org/api/groovy/sql/Sql.html#firstRow%28groovy.lang.GString%29)遇到的一个奇怪问题。从本质上讲，我`java.sql.SQLException: Invalid column type`每次使用它都会得到一个——尽管[eachRow](http://groovy.codehaus.org/api/groovy/sql/Sql.html#eachRow%28groovy.lang.GString,%20groovy.lang.Closure%29)有效。

有没有其他人遇到过这个？如果是这样，是否有解决方法？这发生在 Groovy 1.8.8 和 2.1.1 中。到目前为止，我只在 Windows XP 上尝试过。

示例代码：

```
import groovy.sql.Sql

// ojdbc14_ver_10_2_0_4.jar and orai18n_ver_10_2_0_4.jar is in the classpath
// Oracle Database 10g Enterprise Edition Release 10.2.0.5.0 - 64bit

sql = Sql.newInstance("jdbc:oracle:thin:@dbhost:1500:DBNAME", "user", "pass", "oracle.jdbc.driver.OracleDriver")

// This should return only one row (verified by querying the database).
// You can use any query that returns only one row.
String query = "select ITEM_A, ITEM_B, ITEM_C from MY_TBL where ITEM_D = 1233"

Long itemA = 0L
Long itemB = 0L, itemC = 0L

Integer rowCount = 0
sql.eachRow(query) { row ->
    itemA = row.ITEM_A
    itemB = row.ITEM_B
    itemC = row.ITEM_C
    rowCount++
}
assert rowCount <= 1 // 0 or 1 rows returned

println "Item A = $itemA"
println "Item B = $itemB"
println "Item C = $itemC"
// works fine

// now we have a problem:
sql.firstRow(query) { row ->
    itemA = row.ITEM_A
    itemB = row.ITEM_B
    itemC = row.ITEM_C
}
println "Item A = $itemA"
println "Item B = $itemB"
println "Item C = $itemC" 
```

这将产生以下输出：

```
>>groovy firstRowTest.groovy
Item A = 640
Item B = 90
Item C = 90
25-Mar-2013 13:49:24 groovy.sql.Sql$AbstractQueryCommand execute
WARNING: Failed to execute:
                select ITEM_A, ITEM_B, ITEM_C from MY_TBL where ITEM_D = 1233
              because: Invalid column type
Caught: java.sql.SQLException: Invalid column type
java.sql.SQLException: Invalid column type
        at oracle.jdbc.driver.DatabaseError.throwSqlException(DatabaseError.java:112)
        at oracle.jdbc.driver.DatabaseError.throwSqlException(DatabaseError.java:146)
        at oracle.jdbc.driver.DatabaseError.throwSqlException(DatabaseError.java:208)
        at oracle.jdbc.driver.OraclePreparedStatement.setObjectCritical(OraclePreparedStatement.java:9262)
        at oracle.jdbc.driver.OraclePreparedStatement.setObjectInternal(OraclePreparedStatement.java:8843)
        at oracle.jdbc.driver.OraclePreparedStatement.setObjectInternal(OraclePreparedStatement.java:9565)
        at oracle.jdbc.driver.OraclePreparedStatement.setObject(OraclePreparedStatement.java:9548)
        at firstRowTest.run(firstRowTest.groovy:30) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-25T14:15:41.187

`firstRow`不采用闭包作为参数，你能看看这是否给出了同样的错误？

```
def frow = sql.firstRow(query)
itemA = frow.ITEM_A
itemB = frow.ITEM_B
itemC = frow.ITEM_C 
```

我怀疑，它正在尝试[调用此方法](http://docs.groovy-lang.org/latest/html/api/groovy/sql/Sql.html#firstRow-java.lang.String-java.lang.Object:A-)，并将 Closure 作为参数传递

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-26T15:19:38.763

我相信你可以说：

```
sql.firstRow(query).with{row ->
    itemA = row.ITEM_A
    itemB = row.ITEM_B
    itemC = row.ITEM_C     
} 
```

这确实允许您传入从 firstRow 方法返回的 GroovyRowResult 的闭包。

# iphone - 清除 OpenGL 中的颜色缓冲区

> ID：15617008
> 
> 赞同：0
> 
> 时间：2013-03-25T14:08:43.900
> 
> 标签：iphone, opengl-es, opengl-es-2.0

我正在开发一个使用 OpenGL ES 在屏幕上绘制图形的 iPhone 应用程序。每绘制一个新帧，我都会在整个屏幕上绘制，这让我想到了我的问题。是否有必要调用 glClear 来清除每帧的颜色缓冲区，或者我可以用新数据覆盖它吗？glClear 函数目前占帧时间的 9.9%，所以如果我能摆脱它，它将提供很好的提升。

如果这是一个非常幼稚的问题，请原谅我，因为我是这个话题的菜鸟。提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-25T14:19:38.783

从理论上讲，您可以将其排除在外。

但是如果你不清除颜色缓冲区，之前绘制的数据将保留在屏幕上。这将应用程序限制为具有非修改数据的应用程序。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-25T14:35:20.810

如果您有一个不需要重新绘制的静态场景，那么您可以跳过对`glClear()`颜色缓冲区的调用。

来自[Khronos OpenGL ES 文档](http://www.khronos.org/opengles/sdk/docs/man/xhtml/glClear.xml)：

> **glClear**将窗口的位平面区域设置为先前由**glClearColor**选择的值。
> 
> **glClear**采用单个参数指示要清除哪个缓冲区。
> 
> **GL_COLOR_BUFFER_BIT**表示当前启用颜色写入的缓冲区。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-25T14:31:59.003

通常（在制作 3D 游戏时），您不仅要清除颜色缓冲区，还要清除深度缓冲区，并使用深度测试来确保绘制最接近相机的东西。因此，清除深度缓冲区很重要，否则只会重绘 Z 值低于前一帧的像素。绘制透明物体时，不清除颜色缓冲区也会有问题。

如果您正在制作一个 2D 应用程序并自己管理绘图顺序（首先绘制离相机最远的东西，然后绘制更接近的也就是画家算法），那么您可以省略 clear call。需要注意的一点是，使用这种算法，您还有另一个问题 -*过度绘制*，即绘制相同像素的次数超过了必要的次数。

# jquery - 如何在我的表单中使用这个 jquery 验证器

> ID：15617011
> 
> 赞同：0
> 
> 时间：2013-03-25T14:08:53.587
> 
> 标签：jquery, forms, validation

我找到了一个很好的用于美国邮政编码验证的 jquery 脚本：http: [//igorgladkov.com/resources/demos/jquery.validator/demos/zip_us_validation.html](http://igorgladkov.com/resources/demos/jquery.validator/demos/zip_us_validation.html) 如果条目有效，则脚本写入有效，否则写入无效请参阅:) 现在我想在我的表单中使用它：

```
 <form action="search-by-zip.php" method="POST"">
        <span>zip-code:<input type='text' name='zipcode' value='' size='8' maxlength='7' /></span>
        <span>Distance:
            <select id="radius" name="radius">
                <option value="5">5 miles</option>
                <option value="10">10 miles</option>
                <option selected="selected" value="25">25 miles</option>
                <option value="50">50 miles</option>
            </select>
        </span>
        <input type="submit" value="Find Head Shops" name="find">
    </form> 
```

我想这应该是可能的吧？而不是得到有效的消息，我只想提交我的表格并获得在同一页面上列出的结果。我该怎么做。我对javascript不是很熟悉。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-25T14:14:53.367

看看[http://bassistance.de/jquery-plugins/jquery-plugin-validation/](http://bassistance.de/jquery-plugins/jquery-plugin-validation/) ..使用jquery，易于使用，自定义，适当的文档，演示和tutorilas ...只需要加载相关的js文件并打电话

```
 $('#yourFormId').validate(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-25T14:16:45.677

你可以这样做：

```
$('#zipcode').validator({
        format: 'zipUS',
        invalidEmpty: true,
        correct: function() {
            $('#validation_result').text('VALID');//Not needed
            $('form').submit();
        },
        error: function() {
            $('#validation_result').text('INVALID');
        }
    });

    $('#submit_button').click(function(e) {
        $('#zipcode').validator('validate');
    }); 
```

将您的 HTML 更改为：

```
 <form action="search-by-zip.php" method="POST"">
        <span>zip-code:<input type='text' id='zipcode' name='zipcode' value='' size='8' maxlength='7' /></span><br />
        <span id="validation_result" class="result"></span><br />
        <span>Distance:
            <select id="radius" name="radius">
                <option value="5">5 miles</option>
                <option value="10">10 miles</option>
                <option selected="selected" value="25">25 miles</option>
                <option value="50">50 miles</option>
            </select>
        </span>
        <input type="button" id='submit_button' value="Find Head Shops" name="find">
    </form> 
```

我添加了一个**validation_resut 跨度**，将提交按钮更改为一个**简单的按钮**，并将一个**id**添加到**文本输入**中。

我修复了一些小错误，它可以工作......[在这里测试](http://jsfiddle.net/9nrqT/)

# bash - 从所有子目录复制所有具有特定扩展名的文件

> ID：15617016
> 
> 赞同：166
> 
> 时间：2013-03-25T14:09:06.107
> 
> 标签：bash, unix, cp

在unix下，我想将所有具有特定扩展名的文件（所有excel文件）从所有子目录复制到另一个目录。我有以下命令：

```
cp --parents `find -name \*.xls*` /target_directory/ 
```

这个命令的问题是：

*   它也复制目录结构，我只想要文件（所以所有文件都应该在 /target_directory/ 中结束）

*   它不会复制文件名中带有空格的文件（很多）

这些问题有什么解决办法吗？

* * *

## 回答 #1

> 赞同：249
> 
> 时间：2013-03-25T14:10:28.123

`--parents`正在复制目录结构，所以你应该摆脱它。

您编写、`find`执行和输出的方式被放到命令行上，这样`cp`就无法区分分隔文件名的空格和文件名中的*空格*。最好做类似的事情

```
$ find . -name \*.xls -exec cp {} newDir \; 
```

其中对找到`cp`的每个文件名执行`find`，并正确传递文件名。这是有关此技术[的更多信息。](http://www.softpanorama.org/Tools/Find/using_exec_option_and_xargs_in_find.shtml)

除了以上所有内容，您可以使用[zsh](http://www.zsh.org)并简单地输入

```
$ cp **/*.xls target_directory 
```

`zsh`可以扩展通配符以包含子目录并使此类事情变得非常容易。

* * *

## 回答 #2

> 赞同：50
> 
> 时间：2016-05-03T18:48:27.677

根据以上所有，我想出了这个版本。这个版本也适用于我的 mac 恢复终端。

```
find ./ -name '*.xsl' -exec cp -prv '{}' '/path/to/targetDir/' ';' 
```

它将在当前目录中查找并递归地在所有子目录中查找具有 xsl 扩展名的文件。它会将它们全部复制到目标目录。

cp 标志是：

*   p - 保留文件的属性
*   r - 递归
*   v - 详细（显示正在复制的内容）

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2015-01-18T22:47:48.433

我有一个类似的问题。我使用以下方法解决了它：

```
find dir_name '*.mp3' -exec cp -vuni '{}' "../dest_dir" ";" 
```

并在每个文件`'{}'`上`";"`执行副本。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2017-12-03T22:56:17.213

我自己也必须这样做。我通过 cp 的 --parents 参数做到了：

```
find SOURCEPATH -name filename*.txt -exec cp --parents {} DESTPATH \; 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2019-05-13T02:11:04.957

```
find [SOURCEPATH] -type f -name '[PATTERN]' | 
    while read P; do cp --parents "$P" [DEST]; done 
```

您可以删除 --parents 但如果多个文件具有相同的名称，则存在冲突的风险。

# google-api - 域名的 Google Analytics API 问题

> ID：15617017
> 
> 赞同：0
> 
> 时间：2013-03-25T14:09:07.537
> 
> 标签：google-api, dotnetnuke, google-analytics-api, google-code

我有一个面向公众的网站，例如 www.mysite.domain.com，我已在 Google 控制台 API 下注册以获取 API_ID 和 Client_ID。我在我的javascript中使用它。

现在我有另一个网站，我必须专门用于报告目的，例如 www.reports.domain.com。但是，当我在报告站点上使用我的 - mywebsite API 和 ClientID 值时，我无法看到数据。

两个站点都在同一台机器和同一应用程序实例上 - DotNetNuke 框架

谁能告诉我我还需要做什么，以便我可以在一个站点上查看另一个站点上的数据。

谢谢，

阿维纳什

# objective-c - 将 UIImage 添加到 NSMutableArray

> ID：15617020
> 
> 赞同：2
> 
> 时间：2013-03-25T14:09:15.023
> 
> 标签：objective-c, xcode, uiimage, nsmutablearray, nsdata

我有一段代码应该将图像添加到`NSMutableArray`. 由于某种原因，未添加图像（数组的计数保持为 0）。有人可以告诉我我在这里做错了什么吗？

```
- (void)incomingNotification:(NSNotification *)notification {
    [self.popoverController dismissPopoverAnimated:YES];
    _URLString = [notification object];

    for (int i = 0; i < [[self returnLargeUrls] count]; i++) {
        [self getImageFromURL:_URLString];
    }
} 
```

并在`getImageFromUrl:`：

```
-(NSData *) getImageFromURL:(NSString *)fileURL {
    UIImage *result;
    NSData *data = [NSData dataWithContentsOfURL:[NSURL URLWithString:fileURL]];
    result = [UIImage imageWithData:data];

    [self.pageImages addObject:result];

    NSLog(@"%d", self.pageImages.count);
    return data;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-25T14:14:23.150

首先要检查的是你的财产`pageImages`不是`nil`一开始的。

您可以像这样检查：

```
if(!pageImages)
    NSLog(@"The NSMutableArray pageImages is NIL. Damn... :("); 
```

这很可能是您的问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-27T07:56:40.863

1.  确保你是`alloc` `init`第`NSMutableArray`一个。
2.  确保你`NSData`不是`nil`在从`URL`.`NSLog(@"%@", data);`

# jquery - 我们如何在主干 js 中使用 autotab

> ID：15617025
> 
> 赞同：0
> 
> 时间：2013-03-25T14:09:21.943
> 
> 标签：jquery, backbone.js

我有一个 Backbonejs 视图。

如何使用 autotab - 基本上当有人在一个输入字段中输入一定长度的字符时，它会自动转到另一个输入字段 - 在 Backbonejs 视图中？

[http://www.mathachew.com/sandbox/jquery-autotab/](http://www.mathachew.com/sandbox/jquery-autotab/)

基本上，如何将上面的插件集成到主干 js 视图中？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-25T14:30:36.760

插件很烂，写你自己的东西！

HTML

```
<input type="text" data-autotab="4" class="autotab" name="name"></input>
<input type="text" data-autotab="4" class="autotab" name="surname"></input> 
```

jQuery

```
var $autotabs = $('input.autotab');
$autotabs.on('keyup', function() {
    var $this = $(this),
        i = $autotabs.index($this);
    if ($this.data('autotab') === $this.val().length) {
        $this.blur();
        $autotabs.eq(i+1).focus();
    }
}); 
```

演示[http://jsfiddle.net/DACY2/1/](http://jsfiddle.net/DACY2/1/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-25T14:48:48.410

好的，这就是你为那个插件做绑定的方式

```
$('#area_code, #number1, #number2').autotab_magic().autotab_filter('numeric'); 
```

在该视图的主干渲染功能的末尾添加

```
this.$('#area_code, #number1, #number2').autotab_magic().autotab_filter('numeric'); 
```

达到同样的效果

# text - 文本编辑器应用程序中的自动保存触发

> ID：15617034
> 
> 赞同：2
> 
> 时间：2013-03-25T14:09:51.807
> 
> 标签：text, editor, save, text-editor, autosave

我需要在文本编辑器 Web 应用程序中实现自动保存功能，以在用户键入时管理自动保存。我没有关于这种技术的具体知识，所以我想知道它是如何在现代基于 Web 的文本编辑器中处理的，特别是在触发保存功能时：

*   它是由键盘事件本身触发的，还是由检查先前键盘事件的定期扫描（例如每 5 秒）触发的？
*   是否必须在用户不打字时触发（例如在 3 秒不活动后）以减少网络流量？

有什么建议么？

谢谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-25T14:23:05.540

例如，[这里](http://en.support.wordpress.com/autosave/)描述了 Wordpress 中的自动保存。我的观点是，这取决于应用程序的类型。我想，找到最佳解决方案的最佳方式是您希望在访问某个站点时查看的方式。

所以，如果你把“保存”按钮放在某个地方，那么我认为你真的不需要每隔几秒触发一次，而是每隔几分钟触发一次（就像 Wordpress 一样）。

由于您将通过客户端语言（可能是 JavaScript）侦听事件，因此您无需过多担心性能 - 如果您愿意，只需每 10 秒侦听一次，并检查是否满足自动保存的要求。如果是的话，你可以用一些 AJAX 魔法将它保存在某个数据库中。

如果我是您（或者，如果我是您网站的用户），我想开始在第一个 keyUp 上收听事件。然后，当我输入第一个字母时，JS 将通过 AJAX 每 1 分钟或每输入 500-1000 个字符存储在 DB 中，无论第一次遇到什么。我想最好考虑到有人打字更快，有人打字慢。这就是为什么我会检查输入的字符数和时间。

这是我的意见。（最终对语法感到抱歉，免费编辑：D）

编辑：另外，如果网站是您的，并且您期望一些大流量和大量用户，您可以动态查看系统如何工作并相应地设置您的变量（更长/更短的时间/字符）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-25T14:22:23.730

我认为没有“正确答案”。这取决于您期望您的应用程序如何工作。

如果要保持服务器上的数据始终与前端的文本相对应，则应将保存功能绑定到键盘事件。但是，这显然是低效的，占用带宽的，并且在正常情况下是不必要的。

如果数据一致性对您来说不是那么重要，那么在固定时间段后检查文本并保存（如果文本已更新）是一种正确的方法。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-11-09T18:41:40.660

我正在为博客网站开发类似的工具。事实证明，它需要更多的计算储蓄点，而不仅仅是：

*   每 x 秒
*   在 x 秒不活动后

除了上面我还补充了：

*   当点击出文本框时
*   在关闭页面之前
*   跟踪保存操作并确保它们不会冲突或保存太多次
*   没有在文本框中输入时停用自动保存

在我们的例子中，它是一个 Web 应用程序，我使用了 javascript，确保它快速可靠是至关重要的。

[您可以在http://www.omidmufeed.com/autosaving-text-editor-with-javascript/](http://www.omidmufeed.com/autosaving-text-editor-with-javascript/)找到我的解决方案

我希望这可以帮助别人。

# smalltalk - 为什么 GNU Smalltalk 对方法体使用方括号？

> ID：15617052
> 
> 赞同：5
> 
> 时间：2013-03-25T14:10:33.090
> 
> 标签：smalltalk, gnu-smalltalk

在[GNU Smalltalk 手册](http://www.gnu.org/software/smalltalk/manual/gst.html#Using-GNU-Smalltalk)中写道：

```
Unlike other Smalltalks, method statements are inside brackets. 
```

所以我想知道，为什么与 Smalltalk-80 会有如此任意的偏差？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-25T14:56:15.650

原来的 Smalltalk-80 有 UI，所以你添加类，使用 UI 向类添加方法，可以轻松浏览它们。方法并不意味着位于文本文件中的类内部。

现在，当您使用 GNU Smalltalk 时，它对命令行脚本和将脚本存储在文本文件中的影响最大。因此，您需要一种在脚本中定义方法和类的方法。

这同样适用于[珊瑚](http://rmod.lille.inria.fr/coral/index.html)。如果你会读*什么是珊瑚？> 一个微小的语法扩展*，还有一个扩展允许在脚本中定义方法。

# php - 无法通过 jQuery 从外部 php 脚本访问 php cookie

> ID：15617059
> 
> 赞同：-1
> 
> 时间：2013-03-25T14:10:55.903
> 
> 标签：php, jquery, mysql

`$.post`我正在用 php（例如 index.php）编写一个页面，它使用通过 jQuery函数调用的外部 php 脚本（例如 do.php） 。

我正在传递一个名为 doit 的 post 变量，它确定脚本将执行的操作。例如，如果 doit 为 1，它会为用户分配一个唯一的 id，并使用 setcookie() 函数将其存储在一个名为 uid 的 cookie 中。如果 doit 为 2，它将另一个名为 msg 的帖子数据输入到一个表中，它以名称 t+uid 创建该表。例如。如果 uid 为 14，它会创建一个名为 t14 的表并将 msg 放入其中。

我使用以下代码行来设置 cookie：

```
setcookie("uid", $val, time()+3600, '/'); 
```

而这行代码来创建表：

```
$q = "create table t".$_COOKIE["uid"]." (sl int primary key auto_increment, msg varchar(1000), seen int);";
mysql_query($q); 
```

现在我的问题是： sql 查询执行正确，但我没有从 cookie 变量中得到任何值。创建的表简单地命名为 t。

我的问题是：我做错了什么？我应该怎么做才能正确获得值？

PS：当我检查我的页面设置的 cookie 时，我看到了那里的 cookie。我尝试清除 cookie 并再次尝试，但每次都正确设置了 cookie，但没有正确设置表格。

还有另一个问题。只有在我刷新页面后才会执行 sql 查询。例如，我有另一个名为 uu 的表，其中存储了当前用户的 uid 和一些其他信息。该表中的最后一行包含以前的 uid 而不是当前的。如果这次 uid 为 10，并且我刷新页面并获得 uid 为 11，那么只有在表 uu 中更新 uid = 10 的信息。

非常感谢任何帮助:-) 谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-25T14:29:11.867

PHP 的 setcookie 函数在 Response Header 中发送 cookie。如果您的 AJAX 调用在您收到 index.php 的响应之前执行，那么您可能无法在请求中获取 cookie。

您可以尝试将 $.post 请求放在按钮/链接单击上并检查您是否在请求中获取 cookie。如果可能，请提供完整代码（PHP 和 JavaScript）

# ios - 按钮标题中的引号

> ID：15617060
> 
> 赞同：0
> 
> 时间：2013-03-25T14:10:56.733
> 
> 标签：ios, objective-c, unicode, uibutton

如何输入 UIButton 的标题这样的引号`<< >>`。我需要带有 Helvetica-Neue 的 iOS 5。默认我有`" "`引号

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-25T14:38:52.813

这些字符的 unicode 信息是：

```
»
RIGHT-POINTING DOUBLE ANGLE QUOTATION MARK
Unicode: U+00BB, UTF-8: C2 BB

«
LEFT-POINTING DOUBLE ANGLE QUOTATION MARK
Unicode: U+00AB, UTF-8: C2 AB 
```

因此，要将其中一个放入字符串中，请执行以下操作：

```
NSString* rightPointing = [NSString stringWithUTF8String:"\xC2\xBB"];
NSString* leftPointing =  [NSString stringWithUTF8String:"\xC2\xAB"]; 
```

看起来有点麻烦，但是你当然可以将这些字符串与其他字符串组合起来：

```
NSString* buttonLabel = [NSString stringWithFormat:@"%@%@%@", leftPointing, @"Button Title", rightPointing]; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-25T14:43:31.123

Xcode 和编译器完全支持 Unicode，因此您只需输入字符（如果您的键盘上有字符）：

```
NSString *title = @"«title»"; 
```

或者，使用 Unicode 转义序列：

```
NSString *title = @"\u00ABtitle\u00BB"; 
```

# javascript - 如何添加 jquery 正则表达式验证以检查起始字符

> ID：15617061
> 
> 赞同：1
> 
> 时间：2013-03-25T14:10:57.983
> 
> 标签：javascript, jquery, regex, jquery-ui

```
var validate = /^[a-zA-Z0-9]{4}$/; 
```

我正在使用此验证输入数字或字母数字我正在检查

`Indexof("@") == 0 or # ,%,&`索引也是。

但现在我需要检查

```
 var isAccumMatch = (AccumulationString.indexOf("@") == 0 || AccumulationString.indexOf("#") == 0 || AccumulationString.indexOf("%") == 0 || AccumulationString.indexOf("&") == 0);
                       if(isAccumMatch)
                       {
                          var isAMatch = AccumulationString.length == 5 && validateACMSTR.test(AccumulationString);
                          if(!isAMatch)
                          {
                             alert("Value should be numeric or alpha numeric followed by @,#,&,%");
                             return false;
                          }
                       } 
```

任何人都可以帮助我如何验证第一个字符`@,#,%,&`后跟数字或字母数字。

```
User Input : @A234, &5674, %ABC1, #123A 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-25T14:21:20.977

```
/^[@#%&][a-ZA-Z0-9]{4}$/.test(AccumulationString) 
```

应该返回您正在寻找的条件值。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-25T14:19:35.433

您需要的正则表达式是`/^[@#%&][a-zA-Z0-9]{4}$/`

基本上你可以在一个字符组中粘贴*几乎** 任何东西——它有点被方括号`[`和`]`.

字符组内具有特殊含义的字符有：`^`、`-`、`]`和`\`。这些都应该被转义`\`以获得它们的字面意义。连字符`-`也可以放在组的开头或结尾而无需转义，但有些人认为这是不好的做法，因为它可能会意外地从 eg 更改为`[0-9AZ-]`eg`[0-9A-Z]`具有完全不同的含义，而`[0-9AZ\-]`至少给出了一个线索，即连字符是文字​​而不是范围定义的一部分。

# mysql - MySQL 5.1 升级到 5.5 报错

> ID：15617063
> 
> 赞同：2
> 
> 时间：2013-03-25T14:11:03.943
> 
> 标签：mysql, centos, upgrade, whm

从 CENTOS 5.9 x86_64 上的 WHM 我尝试将 MySQL 5.1 升级到 5.5。升级不起作用，MySQL 不再启动。错误：

```
Beginning MySQL upgrade...
Running: /usr/local/cpanel/scripts/check_cpanel_rpms --targets=MySQL50,MySQL51,MySQL55 --fix
[20130325.101333] 
[20130325.101333] Problems were detected with cPanel-provided files which are RPM controlled. 
[20130325.101333] If you did not make these changes intentionally, you can correct them by running: 
[20130325.101333] 
[20130325.101333] > /usr/local/cpanel/scripts/check_cpanel_rpms --fix 
[20130325.101333] The following RPMs are missing from your system: 
[20130325.101333] MySQL55-server.5.5.30-1.cp1136 
[20130325.101334] Removing 0 broken rpms: 
[20130325.101334] rpm: no packages given for erase 
[20130325.101335] Downloading http://httpupdate.cpanel.net/RPM/11.36/centos/5/x86_64/rpm.md5 
[20130325.101336] MySQL55-server-5.5.30-1.cp1136.x86_64.rpm already downloaded 
[20130325.101336] Hooks system enabled 
[20130325.101336] Checking for and running RPM::Versions 'pre' hooks for any RPMs about to be installed 
[20130325.101336] All required 'pre' hooks have been run 
[20130325.101336] No RPMS need to be uninstalled 
[20130325.101336] Installing new rpms: MySQL55-server-5.5.30-1.cp1136.x86_64.rpm 
[20130325.101336] Preparing packages for installation... 
[20130325.101337] You have more than one PID file: 
[20130325.101337] -rw-rw---- 1 mysql mysql 5 Aug 10 2011 /var/lib/mysql/cpanel-x64.pid 
[20130325.101337] -rw-rw---- 1 mysql mysql 5 Jan 8 17:32 /var/lib/mysql/serverpv.pid 
[20130325.101337] Please check which one (if any) corresponds to a running server 
[20130325.101337] and delete all others before repeating the MySQL upgrade. 
[20130325.101337] error: %pre(MySQL55-server-5.5.30-1.cp1136.x86_64) scriptlet failed, exit status 1 
[20130325.101337] error: install: %pre scriptlet failed (2), skipping MySQL55-server-5.5.30-1.cp1136 
[20130325.101337] W Error Code: 1 
[20130325.101337] E The following possible errors were detected while installing RPMs: 
[20130325.101337] E %pre(MySQL55-server-5.5.30-1.cp1136.x86_64) scriptlet failed, exit status 1 install 
[20130325.101337] The Administrator will be notified to review this output when this script completes 
[20130325.101337] Checking for and running RPM::Versions 'post' hooks for any RPMs just installed 
[20130325.101337] All required 'post' hooks have been run 
MySQL upgrade completed successfully 
```

请指教该怎么做。我没有找到要杀死的任何 MySQL 进程，并且在 ssh ls -al 中看不到 /var/lib 中的 mysql 文件夹...“没有这样的文件夹”。

请帮助:) 谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-12T21:00:38.283

对我来说，问题的关键在于以下几行：

```
[20130325.101337] You have more than one PID file: 
[20130325.101337] -rw-rw---- 1 mysql mysql 5 Aug 10 2011 /var/lib/mysql/cpanel-x64.pid 
[20130325.101337] -rw-rw---- 1 mysql mysql 5 Jan 8 17:32 /var/lib/mysql/serverpv.pid 
```

我对这些文件做了一个`cat`（ ） ，它们不对应于任何正在运行的进程（）。所以我删除了它们（）并再次开始 MySQL 升级过程，这一切都奏效了。（如果 EasyApache 仍然无法运行，可能还需要再次运行它。）`cat /var/lib/mysql/xxx.pid``pid``ps ax``rm /var/lib/mysql/xxx.pid`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-25T14:30:28.063

1.  ps -ax| grep mysql 检查正在运行的进程
2.  杀死 -9

确保所有正在运行的进程都被杀死后，重新运行升级。由于该网站正常运行，因此仍然存在 mysql 进程并正在运行。

# c# - System.Timers.Timer.Stop() 是否重新启动间隔倒计时？

> ID：15617068
> 
> 赞同：9
> 
> 时间：2013-03-25T14:11:12.070
> 
> 标签：c#, timer

```
using System.Timers;

var timer = new Timer();
timer.Interval = 1000;
timer.Start();

// Wait for 500

timer.Stop();
timer.Start(); 
```

我的间隔将有 500 个或 1000 个？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2013-03-25T14:11:54.343

简短的问题，简短的回答。您的计时器将在停止后以 1000 毫秒的新间隔开始。另见[MSDN：`System.Timers.Timer.Stop()`](http://msdn.microsoft.com/en-us/library/system.timers.timer.stop.aspx)

# puppet - 使用 Puppet 配置 ulimit

> ID：15617070
> 
> 赞同：4
> 
> 时间：2013-03-25T14:11:12.873
> 
> 标签：puppet, ulimit

我想知道如何使用 Puppets exec 类型运行 ulimit 命令。ulimit 的问题似乎在于它不是二进制文件，因此必须在它前面使用 /bin/bash 来调用它。我正在尝试将核心文件大小更改为无限制。我有这个但不认识ulimit。

```
exec {"ulimit":
        command => "/bin/bash ulimit -c unlimited",
} 
```

我可以在命令行中执行'ulimit -c unlimited'，它会改变值没问题。问题是通过 Puppet 做到这一点。任何帮助都会很棒。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-25T14:55:56.203

我建议尝试使用**/etc/security/limits.conf**进行此更改，例如：

```
<user>   soft   core   unlimited
<user>   hard   core   unlimited 
```

您可以使用类似于[此处找到](http://projects.puppetlabs.com/projects/1/wiki/puppet_augeas#/etc/security/limits.conf)的说明的 Augeas 来执行此操作。不确定您的确切需求/用例，但至少考虑一下途径！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-12-06T00:07:59.517

另一种方法是安装[erwbgy puppet 模块](https://forge.puppetlabs.com/erwbgy/limits)并简单地定义：

```
include limits
limits::entry { 'my-limits':
    domain => $user,
    type   => 'soft',
    item   => 'core',
    value  => 'unlimited',
} 
```

在你的傀儡脚本中。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-25T19:29:40.030

命令错误，应该是：

```
command => "/bin/bash -c 'ulimit -c unlimited'" 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-19T13:05:14.017

如果您使用 /etc/security/limits.conf 更改限制，则必须重新启动进程以使它们使用新限制。

例如，如果您的 puppet 代理需要重新启动服务（“service myservice restart”），则该服务将从以 root 用户和旧限制运行的 puppet 进程启动。

因此 /etc/init.d 中服务的服务初始化脚本必须强制登录，例如使用“su”或“sudo”更改用户，以强制使用新限制的服务。

见[http://linux.die.net/man/5/limits.conf](http://linux.die.net/man/5/limits.conf)

“另外，请注意，所有限制设置都是在每次登录时设置的。它们不是全局的，也不是永久的；仅在会话期间存在。”

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-10-11T14:17:59.343

将系统范围的 ulimit (root) 增加到您喜欢的最高值

```
* soft nofile 1000000
* hard nofile 250000 
```

然后添加用户特定的限制，例如 httpd 用户

```
httpd hard nofile 100000
httpd soft nofile 25000 
```

注意：在这种情况下 httpd 不能超过系统上限 (*)，即使你给 httpd 用户一个更高的值，sysetm 也不会允许

进程可能需要重新启动（无需重新启动系统）才能获取新值，但是您可以通过查看以下内容来仔细检查它们是否已获取它：$cat /proc//limits

如果没有，那么只需重新启动该过程。

# .net - F# 中的哈希计算和 .net 中的弱哈希表

> ID：15617073
> 
> 赞同：17
> 
> 时间：2013-03-25T14:11:14.560
> 
> 标签：.net, f#, hashmap, hashset

[Hash-consing](http://en.wikipedia.org/wiki/Hash_consing)包括在内存中只保留给定对象的一个​​副本；也就是说，如果两个对象在语义上是相等的（相同的内容），那么它们应该在物理上是相等的（在内存中的相同位置）。该技术通常通过保持全局哈希集并仅在它们不等于哈希集中的对象时才创建新对象来实现。

一个额外的要求是，如果哈希表中的对象没有被哈希表之外的任何东西引用，则它们应该是可收集的；否则，哈希表应该包含弱引用。

由于需要恒定的时间，因此问题更加复杂，因此需要进行浅层、散列和相等测试；因此，对象具有唯一标识符，当将新对象添加到表中时，该标识符会递增。

我有一个工作实现，它使用`System.Collections.Generic.Dictionary<key, node>`where`key`是一个元组，给出节点的浅层摘要（适用于默认散列和相等测试）并且`node`是对象。唯一的问题是`Dictionary`对节点的强引用！

我可以使用`Dictionary`to `WeakReference`，但这不会释放指向悬空引用的键。

有些人提倡使用`System.Runtime.CompilerServices.ConditionalWeakTable`，但这个类似乎做相反的事情：它在收集键时释放值，而我需要在收集值时释放键。

可以尝试使用`System.Runtime.CompilerServices.ConditionalWeakTable<node, node>`，但我需要自定义散列和相等测试......并且`ConditionalWeakTable`记录*不*使用`GetHashCode()`虚拟方法，而是使用默认散列函数。

因此我的问题是：是否有一些等价物`Dictionary`会保留对值的弱引用并在引用悬空时释放键？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-27T16:06:34.413

你是对的，CWT 没有解决散列问题，因为它引出了问题——它的键假设引用相等。但是，可能值得指出的是，CWT 不保留键或值。这是一个小测试：

```
open System.Collections.Generic
open System.Runtime.CompilerServices

let big () =
    ref (Array.zeroCreate (1024 * 1024) : byte [])

let test1 () =
    let d = Dictionary(HashIdentity.Reference)
    for i in 1 .. 10000 do
        stdout.WriteLine(i)
        let big = big ()
        d.Add(big, big)
    d

let test2 () =
    let d = ConditionalWeakTable()
    for i in 1 .. 10000 do
        stdout.WriteLine(i)
        let big = big ()
        d.Add(big, big)
    d 
```

在我的机器上，`test1`内存不足并`test2`成功。似乎只有在 CWT 不保留键和值时才会发生这种情况。

对于哈希计算，您最好的选择可能是 Artem 在评论中建议的内容。如果这听起来太复杂，那么只给用户控制权也很有意义，比如：

```
let f = MyFactory() // a dictionary with weak reference values hidden inside
f.Create(..) : MyObject // MyObject has no constructors of its own
f.Cleanup() // explicitly cleans up entries for collected keys 
```

然后你就不需要引入线程，研究 GC 内部是如何工作的，或者做任何魔法。库的用户可以决定在哪里清理或简单地“忘记”工厂对象 - 这将收集整个表。

# openstreetmap - Overpass API：获取具有特定名称的所有公共交通站点

> ID：15617077
> 
> 赞同：3
> 
> 时间：2013-03-25T14:11:25.927
> 
> 标签：openstreetmap, overpass-api

我正在使用 Overpass API 在 OpenStreetMap 中查询指定位置附近具有特定名称的巴士站：

```
http://overpass-api.de/api/interpreter?data=[out:json];node["name"="CITY"];node["around"="15000"];node["name"="STOP_NAME"]["highway"="bus_stop"];out; 
```

现在我需要扩展这个查询：我不仅要获取所有名为`STOP_NAME`near的公共汽车站`CITY`，还要获取与电车站 ( `railway=tram`) 和地铁站 ( `railway=subway`) 匹配的信息`STOP_NAME`。

我试过了，但它仍然只返回巴士站（并包含冗余信息）：

```
http://overpass-api.de/api/interpreter?data=[out:json];node["name"="CITY"];(node(around:15000)["name"="STOP_NAME"]["highway"="bus_stop"];node(around:15000)["name"="STOP_NAME"]["railway"="tram_stop"];node(around:15000)["name"="STOP_NAME"]["railway"="subway_stop"];);(._;>;);out; 
```

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-30T15:46:51.900

我通过在请求 URL 中包含更多冗余信息来解决这个问题：对于每种公共交通类型，我现在重复“城市节点”和“节点周围”。

我不相信这是最好的解决方案，但它运作良好：

```
http://overpass-api.de/api/interpreter?data=[out:json];node["name"="CITY"];node(around:15000)["name"="STATION"]["highway"="bus_stop"];node["name"="CITY"];node(around:15000)["name"="STATION"]["railway"~"tram_stop|station|subway"];out; 
```

# google-drive-api - 如何从融合表访问谷歌驱动器中的图像

> ID：15617079
> 
> 赞同：0
> 
> 时间：2013-03-25T14:11:29.090
> 
> 标签：google-drive-api, google-fusion-tables

我正在尝试从融合表访问图像，因为融合表不支持字节数组。我将我的图像放在 Google Drive 中，并尝试在一个融合表中访问相同的图像，给出图像的 URL。

我创建了一个服务帐户来将图像上传到 Google Drive，但我必须将 URL 提供到融合表中。我不知道将哪个 URL 放入融合表中，尽管我有相同的文件 ID。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-26T05:39:29.280

Google Drive API 有一种方法来检索自链接的 URL。

`file.getSelfLink();`返回您可以访问的链接以在我的情况下显示资源图像。

# mysql - MySql 查询返回我不想要的结果

> ID：15617080
> 
> 赞同：0
> 
> 时间：2013-03-25T14:11:31.270
> 
> 标签：mysql, sql

我有一个如下用户表：

```
 id                      some attribute
1196670907478919031,fb39f78853bfe42279a8f56bc5671eb9,.....
4915018864030990478,44ecf841a778525b925023321761e458, ........
3161434036923224050,2fd54178a92a4b1a83643d9faa1fec9e,...... 
```

现在我有我的friendedges表如下

```
 a                          b               status
 '4915018864030990478', '3161434036923224050', 'accepted'
 '4915018864030990478', '1196670907478919031', 'accepted' 
```

为了获得 id=4915018864030990478 的用户的所有朋友，我编写了以下查询，但我得到了以下结果查询

```
select id, firstName, lastName, gender, pictureSet  FROM  Member m JOIN  friendedges f ON f.a = m.id where a = "4915018864030990478"; 
```

结果

```
 '4915018864030990478', 'sdsds', 'dsd', 'M', '1'
 '4915018864030990478', 'sdsds', 'dsd', 'M', '1' 
```

我必须在哪里获得朋友 ID。而且我不知道为什么它会产生重复的结果。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-25T14:13:26.173

用于`DISTINCT`删除重复项：

```
select DISTINCT f.b, firstName, lastName, gender, pictureSet  
FROM  Member m
JOIN  friendedges f ON f.a = m.id 
where f.a = "4915018864030990478"; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-25T14:13:16.143

你想要的是这个：

```
select f.id, f.firstName, f.lastName, f.gender, f.pictureSet
FROM Member m
JOIN friendedges e ON e.a = m.id
JOIN Member f ON e.b = f.id
where e.a = "4915018864030990478"; 
```

或更简单地说（如果您不需要会员的数据）：

```
select id, firstName, lastName, gender, pictureSet
FROM  Member m JOIN  friendedges f ON f.b = m.id
where a = "4915018864030990478"; 
```

在第二个查询中，我只是更改`f.a`为`f.b`.

# c# - 插件架构 - 在运行时加载程序集时出错

> ID：15617084
> 
> 赞同：0
> 
> 时间：2013-03-25T14:11:58.437
> 
> 标签：c#, reflection

我编写了一个具有抽象类的应用程序。我想支持这个类作为插件的实现。

这是抽象类：

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Xml.Linq;
using System.IO;

namespace Stub.Logic {
    public abstract class Connection {
        …stuff
    }
} 
```

这是一个实现：

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Xml.Linq;
using System.IO;
using Stub.Logic;

namespace MqConnection {
    public class MqConnection : Connection {
        …stuff
    }
} 
```

该插件被放置在一个文件夹中，它被读取和加载。

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.IO;
using System.Reflection;

namespace Stub.Logic {
    public class PluginManager {
        private static List<Type> connectionTypes = new List<Type>();

        public static void LoadConnectionTypes(string path) {
            DirectoryInfo dllDirectory = new DirectoryInfo(path);
            FileInfo[] dlls = dllDirectory.GetFiles("*.dll");
                foreach (FileInfo dllFileInfo in dlls) {
                    try {
                        Assembly assembly = Assembly.LoadFrom(dllFileInfo.FullName);
                        connectionTypes.AddRange(**assembly.GetTypes()**);
                    } catch (Exception ex) {
                        if (ex is System.Reflection.ReflectionTypeLoadException) {
                        var typeLoadException = ex as ReflectionTypeLoadException;
                        var loaderExceptions = typeLoadException.LoaderExceptions;
                        TextWriter writer = new StreamWriter(@"C:\Users\yoav.benzvi\Desktop\error.txt");
                        writer.WriteLine(loaderExceptions[0].ToString());
                        writer.Close();
                    }
                }
            }
        }
    }
} 
```

它在 assembly.GetTypes() 调用时失败。这是我得到的错误：

> System.IO.FileNotFoundException：无法加载文件或程序集“StubLogic，版本=1.0.0.0，Culture=neutral，PublicKeyToken=null”或其依赖项之一。该系统找不到指定的文件。文件名：'StubLogic，版本=1.0.0.0，文化=中性，PublicKeyToken=null'

我需要在插件文件夹中有 StubLogic.dll 吗？似乎是多余的，因为它已经是应用程序的一部分，所以我做错了什么？

编辑：添加参考属性：
![在此处输入图像描述](../Images/eb57fa8d9f3cd11026282010ef266cdc.png)

**Edit2：向所有人道歉。代码正在运行。问题在于我的糟糕测试。再次向在这里浪费时间的人道歉。**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-25T14:25:59.567

我建议你这个代码

我修改了你的路径

```
DirectoryInfo(Path.Combine(Environment.CurrentDirectory, "YourDirectoryRepository")); 
```

所以

```
 DirectoryInfo dInfo = new DirectoryInfo(Path.Combine(Environment.CurrentDirectory, "YourDirectoryRepository"));
 FileInfo[] files = dInfo.GetFiles("*.dll");
 List<Assembly> plugInAssemblyList = new List<Assembly>();

 if (null != files)
 {
      foreach (FileInfo file in files)
      {
           plugInAssemblyList.Add(Assembly.LoadFrom(file.FullName));
      }
 } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-25T14:20:18.517

确保插件引用了您拥有的相同版本的 StubLogic 程序集，或者对于插件程序集项目中的 StubLogic 引用，“使用特定版本”为 false。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-25T14:47:22.710

向所有人道歉。代码正在运行。问题在于我的糟糕测试。再次向在这里浪费时间的人道歉。

# java - 如何从列表视图中的文本视图中获取字符串值并将其传递给数据库？

> ID：15617086
> 
> 赞同：0
> 
> 时间：2013-03-25T14:11:59.570
> 
> 标签：java, android, listview, textview

对不起，如果我刚开始开发 Android 应用程序时在这里问了愚蠢的编码问题。我想将 listview 中的 textview 中的字符串结果保存到我的数据库中作为路由历史记录，但是我怎样才能将字符串传递给我的数据库？saveHistory 类中的 post 参数不断给我错误。提前致谢。

```
public class RouteResult extends Activity {
    private ListView lvRoute;
    private Context context = this;
    String source = null;
    String destination = null;
    String username = null; 
    ProgressDialog dialog;

public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.route_result);
        lvRoute = (ListView) findViewById(R.id.listView1);
        Bundle bundle = this.getIntent().getExtras(); 
        source= bundle.getString("source"); 
        destination=bundle.getString("destination");
        new GetRoute().execute();
    }

    class GetRoute extends AsyncTask<String, String, String> {

        ArrayList<NameValuePair> postParameters;
        private List<HashMap<String, String>> fillMaps;
        private ProgressDialog pDialog;
        String response = null;
        String[] from;
        int[] to;
        ListViewAdapter _adapter;
        /**
         * Before starting background thread Show Progress Dialog
         * */
        @Override
        protected void onPreExecute() {
            super.onPreExecute();

            postParameters = new ArrayList<NameValuePair>();
            fillMaps = new ArrayList<HashMap<String, String>>();

            // column name
            from = new String[] { "source", "s_station","destination","d_station","t_price" };
            to = new int[] { R.id.textView_sourceName, R.id.textView_sourceCode,
                    R.id.textView_destName, R.id.textView_destCode, R.id.textView_price };

            pDialog = new ProgressDialog(context);
            pDialog.setMessage("Calculating. Please wait...");
            pDialog.setIndeterminate(false);
            pDialog.setCancelable(false);
            pDialog.show();
        }

        /**
         * getting All products from url
         * */
        protected String doInBackground(String... args) {
            ArrayList<NameValuePair> postParameters = new ArrayList<NameValuePair>();

            postParameters.add(new BasicNameValuePair("source", source.toString()));
            postParameters.add(new BasicNameValuePair("destination",destination.toString()));
            try {
                response = CustomHttpClient.executeHttpPost(
                        "url",
                        postParameters);
            } catch (Exception e) {
                e.printStackTrace();
            }

            return null;
        }

        /**
         * After completing background task Dismiss the progress dialog
         * **/
        protected void onPostExecute(String file_url) {
            // dismiss the dialog after getting all products
            pDialog.dismiss();
            // updating UI from Background Thread
            runOnUiThread(new Runnable() {
                public void run() {
                    if (response != null) {
                        try {
                            JSONArray jArray = new JSONArray(response);

                            for (int i = 0; i < jArray.length(); i++) {
                                JSONObject json_data = jArray.getJSONObject(i);

                                HashMap<String, String> map = new HashMap<String, String>();
                                map.put("source",
                                        json_data.getString("source"));
                                map.put("s_station",
                                        json_data.getString("s_station"));
                                map.put("destination",
                                        json_data.getString("destination"));
                                map.put("d_station",
                                        json_data.getString("d_station"));
                                map.put("t_price",
                                        json_data.getString("t_price"));
                                fillMaps.add(map);
                            }

                        } catch (JSONException e) {
                            e.printStackTrace();
                        }

                        _adapter = new ListViewAdapter(context, fillMaps,
                                R.layout.route_item, from, to);
                        lvRoute.setAdapter(_adapter);

                    } else {
//                      setDialog("Connection Error",
//                              "Fail to connect to server.");
                    }
                }
            });
        }
    }

     @Override
        public boolean onCreateOptionsMenu(Menu menu)
        {
            MenuInflater menuInflater = getMenuInflater();
            menuInflater.inflate(R.layout.menu, menu);
            return true;
        }

     public boolean onOptionsItemSelected(MenuItem item)
        {

            switch (item.getItemId())
            {
            case R.id.menu_save:
                Toast.makeText(RouteResult.this, "Save is Selected", Toast.LENGTH_SHORT).show();
                new saveHistory().execute() ; 
                return true;

            case R.id.menu_search:
                Toast.makeText(RouteResult.this, "Search is Selected", Toast.LENGTH_SHORT).show();
                return true;

            default:
                return super.onOptionsItemSelected(item);
            }

        }

    @Override
     public void onBackPressed() {

        Intent intent = new Intent(RouteResult.this, MainMenu.class);
        startActivity(intent);
        finish();

    }

    class saveHistory extends AsyncTask<String,String,String>{

        @Override
         protected void onPreExecute() {
             super.onPreExecute();
             dialog = ProgressDialog.show(RouteResult.this, "",
                    "Saving... Please wait", true);
         }

        @Override
        protected String doInBackground(String... arg0) {
            // TODO Auto-generated method stub

            ArrayList<NameValuePair> postParameters = new ArrayList<NameValuePair>();
            postParameters.add(new BasicNameValuePair("s_station", s_station.getText().toString()));
            postParameters.add(new BasicNameValuePair("d_station", d_station.getText().toString()));
            postParameters.add(new BasicNameValuePair("t_price", t_price.getText().toString()));

             String response2 = null;
             String abc = null; 

            try {
                response2 = CustomHttpClient.executeHttpPost(
                        "url",
                        postParameters);

                String result = response2.toString();

        }

    }

} 
```

# iphone - 带有简单动画的 iOS UIViewController

> ID：15617088
> 
> 赞同：1
> 
> 时间：2013-03-25T14:12:02.333
> 
> 标签：iphone, ios, objective-c, ios5, core-animation

我需要能够在 UIView 中创建一些简单的动画。我的主要问题是如何以最简单的方式实现这一点，同时在使用内存时非常高效。

我的目标是让一些图形（例如云）漂浮在主 UIView 上。

这些图形必须在用户与视图的其他部分（例如按下按钮等）交互的整个过程中继续移动。因此动画必须非常轻量级。

你能指出我应该看什么吗？

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-25T15:41:38.107

你可以看看`UIView`。

最简单的方法是

```
[UIView beginAnimations:@"Some animations" context:nil];
self.anyViewOutlet.anyAnimatableProperty = value after animation;
...
[UIView commitAnimations]; 
```

您也可以尝试使用粒子，这可能看起来更令人印象深刻。 [http://www.raywenderlich.com/6063/uikit-particle-systems-in-ios-5-tutorial](http://www.raywenderlich.com/6063/uikit-particle-systems-in-ios-5-tutorial)

本教程展示了如何生成火焰粒子，但它也适用于云图像。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-25T14:18:12.087

你可以用动画块来做到这一点。看看`animateWithDuration:animations:`方法`UIView`

文档：

[http://developer.apple.com/library/ios/#documentation/UIKit/Reference/UIView_Class/UIView/UIView.html](http://developer.apple.com/library/ios/#documentation/UIKit/Reference/UIView_Class/UIView/UIView.html)

# mysql - 如何正确地为遍历表中所有行的mysql游标设置停止条件？

> ID：15617092
> 
> 赞同：0
> 
> 时间：2013-03-25T14:12:19.440
> 
> 标签：mysql, stored-procedures, cursor

我正在学习mysql游标。

以下是一个 mysql 程序，我实际上想遍历表 A 中的所有行，并为每个 A 的行在表 B 中“选择”相关的内容。

现在的问题是，当内部“选择”返回一个空集时，这个 while 循环会中断，这显然不是我所期望的行为。（我希望它遍历 A 的所有行！当当前行在 B 中没有任何相关时，然后转到下一个！）

我了解到光标的停止标准应该是这样`DECLARE CONTINUE HANDLER FOR SQLSTATE '02000' SET stop=1;`的，我也知道这是问题的原因。

但是对于这种情况，传统的解决方法是什么？

```
create procedure SOME_PROC () 
BEGIN
    DECLARE temp_id int; 
    DECLARE cursor_id CURSOR FOR select id from A;
    DECLARE stop int default 0;
    DECLARE CONTINUE HANDLER FOR SQLSTATE '02000' SET stop=1; 
    OPEN cursor_id;
        FETCH cursor_id INTO temp_id;
        while stop <> 1 do
            select B.x from B where B.id = cursor_id;
            FETCH cursor_id INTO temp_id;
        end while;
    CLOSE cursor_id; 
END 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2015-12-30T14:42:23.917

Work Around: Use put SELECT ... INTO that may return no rows into a separate BEGIN ... END block with its own CONTINUE handler for NOT FOUND as a workaround.

# java - 如何有效地查找 IType 的所有子类型

> ID：15617098
> 
> 赞同：2
> 
> 时间：2013-03-25T14:12:33.630
> 
> 标签：java, eclipse, eclipse-jdt

我目前正在研究基于 JDT 的自定义重构工具。在某一时刻，我想找到一种类型的所有子类型，就像 eclipse 中的“类型层次结构”视图一样。我使用搜索引擎编写了一个遍历层次结构的递归函数。这可行，但对于深层层次结构来说确实很慢。我可以使用更高效的 API 吗？

```
private Set<IType> searchForSubTypesOf(IType type, IProgressMonitor monitor) throws CoreException {
    final Set<IType> result = new HashSet<IType>();

    SearchPattern pattern = SearchPattern.createPattern(type, IJavaSearchConstants.REFERENCES, SearchPattern.R_EXACT_MATCH);
    SearchParticipant[] participants = new SearchParticipant[] { SearchEngine.getDefaultSearchParticipant() };
    IJavaSearchScope scope = SearchEngine.createHierarchyScope(inputType);
    SearchRequestor requestor = new SearchRequestor() {
        @Override
        public void acceptSearchMatch(SearchMatch match) throws CoreException {
            if (match.getAccuracy() == SearchMatch.A_ACCURATE && match.getElement() instanceof IType) {
                IType subType = (IType)match.getElement();
                result.add(subType);
                // Recursive search for the type found
                Set<IType> subTypes = searchForSubTypesOf(subType, new NullProgressMonitor());
                result.addAll(subTypes);
            }
        }
    };

    new SearchEngine().search(pattern, participants, scope, requestor, monitor);
    return result;
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-26T13:55:29.097

经过大量代码阅读后，我终于找到了我正在寻找的 API 的这些伟大时刻之一！

我上面的功能归结为：

```
public static IType[] getAllSubtypesOf(IType type, IProgressMonitor monitor) throws CoreException {
    return type.newTypeHierarchy(monitor).getAllSubtypes(type);
} 
```

# r - 从字符向量中获取绘图参数

> ID：15617100
> 
> 赞同：0
> 
> 时间：2013-03-25T14:12:49.420
> 
> 标签：r

如何从 中的字符向量定义调色板`plot()`？

```
pal1 <- c('red', 'green', 'blue')
pal2 <- c('yellow', 'brown', 'orange')

mypal <- c('pal1', 'pal2')

for(i in mypal){
   plot(1:3, col=i, pch=20, cex=5)
   } 
```

我想在多个调色板上循环相同的情节。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-25T14:16:45.237

环绕`get`将`i`做到这一点......有点。但是你只会看到最终的情节，除非你等待或者把情节写到磁盘上。

```
for(i in mypal){
   plot(1:3, col=get(i), pch=20, cex=5)
   } 
```

`pal1`或者您可以将和的值分配`pal2`给您`mypal`的列表：

```
mypal <- list(pal1, pal2) 
```

# javascript - 面向个人用户的带有 Node.js 和 Socket.io 的 Pubsub

> ID：15617101
> 
> 赞同：3
> 
> 时间：2013-03-25T14:12:54.053
> 
> 标签：javascript, php, node.js, socket.io, publish-subscribe

我想通过使用 pubsub 在 Node.js/socket.io 环境中为特定用户收集通知来检查我是否掌握了正确的知识。

这是我的设置：

*   主应用程序是在 Codeigniter 上用 PHP 编写的。Auth 使用 Ion_Auth 处理 CI（会话等）
*   实时（目前只是通知）由 Node.js 和 Socket.io 处理
*   经过身份验证的用户可以邀请朋友加入“群组” - 如果被邀请者已经拥有帐户，则邀请将发送电子邮件和内部通知
*   经过身份验证的用户可以发表评论，对共享内容执行操作。两者都会向该内容的所有订阅用户发出通知。

我相信处理这个问题的正确方法是让每个用户订阅一个通知频道。此频道包含每个用户的每个通知，每当我们执行上述操作之一时，都会通过发布事件将其推送到频道。然后订阅会检查此频道以获取与用户会话相关的特定数据，即：

*   对于与邀请相关的通知，已发布的事件将包含一些唯一标识用户数据，我们将对其进行检查。
*   对于与特定内容相关的通知，我们将检查包含该内容标识标记的已发布事件的频道。

这是正确的方法吗？我对 socket.io、node.js 和 pubsub 还很陌生，但这对我来说似乎很有意义。让我感到困惑的是，我们应该将事件推送给客户端，而不是客户端从服务器拉取事件。这个解决方案似乎两者兼而有之。

如果有更简单的解决方案（即 socket.io 更原生的解决方案），我将不胜感激。在教程或示例中，我真正能找到的只是一遍又一遍地写相同的聊天客户端……

**编辑：**或者，将所有连接的客户端 id 与其相应的用户 id 一起维护是否更实用，然后当有新消息进入时，使用该消息将该消息发送到特定客户端`var socket = hash[userID]; socket.emit(message);`

有人对这种情况下的潜在瓶颈有任何想法吗？该站点可能有成千上万的并发用户正在更新多个事件。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-10-06T21:07:04.127

我建议不要自己实施 PubSub。我必须进行一次这种广播，并使用 RabbitMQ 来处理连接和路由（包括广播）。

[使用反向 Ajax 调用（长期保持的 http 连接，请参阅Comet on Wikipedia](http://en.wikipedia.org/wiki/Comet_(programming))）向浏览器发送实时消息

请参阅[RabbitMQ 服务器](http://www.rabbitmq.com/)和[Node 库](http://www.rabbitmq.com/devtools.html#node-dev)

Rabbit MQ 提供了许多优势：

*   只要 RabbitMQ 正在运行，客户端将始终能够发布消息。
*   只要您需要更高的吞吐量（横向扩展），您就可以通过启动另一个应用程序服务器实例来轻松地确定您的服务器范围。
*   发送到 RabbitMQ 的消息可以被持久化。
*   可以在事务中完成向 RabbitMQ 发布消息。
*   简单的服务器界面来管理您的队列和交换。

# java - Jetty - 为不同的应用程序版本使用符号链接

> ID：15617105
> 
> 赞同：1
> 
> 时间：2013-03-25T14:13:10.583
> 
> 标签：java, servlets, jetty, switching

我正在尝试配置码头以在不同的应用程序文件夹之间切换。例如：我有 2 个应用程序文件夹（包含 WEB-INF、类、war 等）App1 和 App2。我想在 linux "myapp" 中创建一个指向 App1 或 App2 的符号链接，并使用[http://host.com/myapp/resource](http://host.com/myapp/resource)访问我的资源（即我的应用程序的 servlet） ...

我在我的 etc/webdefault.xml 文件中添加了以下行来启用别名，但没有用：

```
<servlet>
<servlet-name>default</servlet-name>
<servlet-class>org.eclipse.jetty.servlet.DefaultServlet</servlet-class>

<init-param>
<param-name>aliases</param-name>
<param-value>true</param-value>
</init-param>

</servlet> 
```

有没有办法启用这种行为？还是我需要另一种方法？基本上我需要一种快速的方法来在生产应用程序的版本之间切换，而无需进行重大更改或重新启动服务器:)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-27T17:24:43.693

使用基于[上下文的部署](http://wiki.eclipse.org/Jetty/Feature/ContextDeployer)。

创建一个`${jetty.home}/contexts/myapp.xml`并指定所需的映射。

```
<?xml version="1.0"  encoding="ISO-8859-1"?>
<!DOCTYPE Configure PUBLIC 
          "-//Mort Bay Consulting//DTD Configure//EN"
          "http://jetty.mortbay.org/configure.dtd">
<Configure class="org.eclipse.jetty.webapp.WebAppContext">
   <Set name="contextPath">/myapp</Set>
   <Set name="war"><SystemProperty name="jetty.home" default="."/>/webapps/App1</Set>
</Configure> 
```

这使得上下文`/myapp`由您的`${jetty.home}/webapps/App1`目录提供服务。

如果您仍然启用热部署（默认情况下启用）。然后只需编辑`${jetty.home}/contexts/myapp.xml`并保存它，码头将接受更改并提供新设置。

# c++ - 碰撞检测有效但有小故障？

> ID：15617108
> 
> 赞同：3
> 
> 时间：2013-03-25T14:13:19.967
> 
> 标签：c++, opengl, glut

我写了一个小程序，当实现时停止一个小正方形穿过一个更大的矩形。

调用该`collision()`函数时，它会检查形状是否发生碰撞。目前它执行以下操作：

*   当正方形`up`向形状移动时，它不会通过。（应该是这样）
*   当正方形`down`向形状移动时，它不会通过。（应该是这样）
*   向形状移动`right`时，它不会通过。（但它向上移动一键）
*   向形状移动`left`时，它不会通过。（但它一键向左移动，一键向上移动）（见图）

![毛刺](../Images/ed5257527775a1d6c6e0b18c821c47d4.png)

这是我的`collision()`功能：

```
if     (sprite_Bottom +y_Vel <= plat_Top    ){return false;}
else if(sprite_Top    +y_Vel >= plat_Bottom ){return false;}
else if(sprite_Right  +x_Vel <= plat_Left   ){return false;}
else if(sprite_Left   +x_Vel >= plat_Right  ){return false;}
//If any sides from A aren't touching B
return true; 
```

这是我的`move()`功能：

```
 if(check_collision(sprite,platform1) || check_collision(sprite,platform2)){ //if colliding...
    if     (downKeyPressed ){ y_Vel += speed; downKeyPressed  = false;} //going down
    else if(upKeyPressed   ){ y_Vel -= speed; upKeyPressed    = false;} //going up
    else if(rightKeyPressed){ x_Vel -= speed; rightKeyPressed = false;} //going right
    else if(leftKeyPressed ){ x_Vel += speed; leftKeyPressed  = false;} //going left
   }
   glTranslatef(sprite.x+x_Vel, sprite.y+y_Vel, 0.0); //moves by translating sqaure 
```

我希望`left`and`right`碰撞与 and 一样`up`工作`down`。我的代码对每个方向都使用相同的逻辑，所以我不明白它为什么这样做......

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-25T14:46:42.127

我认为你应该首先检查你的精灵的角落是否有碰撞。然后，如果您的平台比您的精灵厚，则不需要进一步检查。否则检查你的精灵的每一面是否与平台发生碰撞。

```
if ((plat_Bottom <= sprite_Bottom + y_Vel && sprite_Bottom  + y_Vel <= plat_Top)
    && (plat_Left <= sprite_Left + x_Vel && sprite_Left + x_Vel <= plat_Right))
    // then the left-bottom corner of the sprite is in the platform
    return true;

else if ... // do similar checking for other corners of the sprite.
else if ... // check whether each side of your sprite collides with the platform

return false; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-25T14:54:00.147

原因似乎是因为您在检查碰撞后将速度添加到速度中。

这是一个问题，因为您在碰撞期间正在测试**旧版本的速度。**然后，您将您`speed`的速度添加到可能使精灵发生碰撞的速度。如果您要在碰撞**后将**速度添加到速度，那么您还需要将速度合并到碰撞算法中。

`collision()`在你的函数中试试这个：

```
int xDelta = x_Vel + speed;
int yDelta = y_Vel + speed;

if     (sprite_Bottom +yDelta <= plat_Top    ){return false;}
else if(sprite_Top    +yDelta >= plat_Bottom ){return false;}
else if(sprite_Right  +xDelta <= plat_Left   ){return false;}
else if(sprite_Left   +xDelta >= plat_Right  ){return false;}

//If any sides from A aren't touching B
return true; 
```

# vba - 强制文件和文件夹按字母顺序处理

> ID：15617115
> 
> 赞同：2
> 
> 时间：2013-03-25T14:13:33.583
> 
> 标签：vba, excel

我的应用程序有问题。这是一个重命名所选文件夹中的所有图片和文件夹内的子文件夹的应用程序。

然而，有时它按字母顺序 AZ 处理图片，因此正确地重命名它们，有时它似乎按日期修改顺序处理它们。最旧的在前，最新的在后。这会导致文件的顺序错误。我们在同一台 PC 上获得了这两个结果，我完全不知道接下来要尝试什么。

有谁知道如何更改以下代码，使其始终使用字母顺序 AZ。

请帮忙。

完整代码如下：SUB1

```
 Sub TestListFilesInFolder()
'Workbooks.Add ' create a new workbook for the file list
' add headers

Dim fldr As FileDialog
Dim sItem As String
Set fldr = Application.FileDialog(msoFileDialogFolderPicker)
With fldr
    .Title = "Select a Folder"
    .AllowMultiSelect = False
    .InitialFileName = strPath
    If .Show <> -1 Then
        sItem = "No item selected"
    Else
        sItem = .SelectedItems(1)
    End If
End With

With Range("A1")
    .Formula = "Folder contents:"
    .Font.Bold = True
    .Font.Size = 12
End With
Range("A3").Formula = "Old File Path:"
Range("B3").Formula = "File Type:"
Range("C3").Formula = "File Name:"
Range("D3").Formula = "New File Path:"
Range("A3:H3").Font.Bold = True
'ListFilesInFolder "L:\Pictures\A B C\B526 GROUP", True
ListFilesInFolder sItem, True

' list all files included subfolders
   End Sub 
```

SUB2

```
 Sub ListFilesInFolder(SourceFolderName As String, IncludeSubfolders As Boolean)
   ' lists information about the files in SourceFolder
   ' example: ListFilesInFolder "C:\FolderName", True
    Dim fso As Object
   Dim SourceFolder As Object, SubFolder As Object
   Dim FileItem As Object
   Dim r As Long, p As Long
   Dim fPath As String, fName As String, oldName As String, newName As String
   Dim strVal As String, strVal2 As String, strVal3 As String, strVal4 As String, iSlashPos As Integer

Set fso = CreateObject("Scripting.FileSystemObject")
Set SourceFolder = fso.GetFolder(SourceFolderName)
r = Range("A65536").End(xlUp).Row + 1
p = 1
For Each FileItem In SourceFolder.Files
    ' display file properties
    Cells(r, 1).Formula = FileItem.Path
    fFile = FileItem.Path
    Cells(r, 2).Formula = FileItem.Type
    Cells(r, 3).Formula = FileItem.Name
    fName = FileItem.Name
  If FileItem.Type = "JPEG Image" Then
    oldName = Left(FileItem.Name, InStrRev(FileItem.Name, ".") - 1)
    fPath = Left(FileItem.Path, InStrRev(FileItem.Path, "\") - 1)

    strVal = fPath
    Dim arrVal As Variant
    arrVal = Split(strVal, "\")
    strVal2 = arrVal(UBound(arrVal))
    strVal3 = arrVal(UBound(arrVal) - 1)

    newName = Replace(FileItem.Name, oldName, strVal3 & "_" & strVal2 & "_" & "Pic" & p & "_" & Format(Date, "ddmmyyyy"))

    Name fFile As fPath & "\" & newName
    Cells(r, 4).Formula = fPath & "\" & newName
    p = p + 1
    Else
    End If

    r = r + 1 ' next row number
Next FileItem
If IncludeSubfolders Then
    For Each SubFolder In SourceFolder.subfolders
        ListFilesInFolder SubFolder.Path, True
    Next SubFolder
End If
Columns("A:H").AutoFit
Set FileItem = Nothing
Set SourceFolder = Nothing
Set fso = Nothing
ActiveWorkbook.Saved = True
Set fldr = Nothing
    End Sub 
```

任何帮助将非常感激。

问候，

山姆

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-10T13:16:53.950

因此，在@SkipIntro 提供的[这个链接](http://www.vb-helper.com/howto_dir_quicksorted.html)中，有一个函数和一个子函数。

*   首先，如果您提供最小值和最大值，**快速排序功能将对列表进行排序。**

*   其次，作为主要文件的**sortedfiles 将按**字母顺序返回文件列表。

如果您在发布之前使用以下内容对文件名进行排序，那么它们将按字母顺序排列，例如

```
quicksort myfilenames, 1, ubound(myfilenames, 1) 
```

**快速排序：**

```
' Use Quicksort to sort a list of strings. 
' 
' This code is from the book "Ready-to-Run 
' Visual Basic Algorithms" by Rod Stephens. 
' http://www.vb-helper.com/vba.htm 
Private Sub Quicksort(list() As String, ByVal min As Long, ByVal max As Long) 
Dim mid_value As String 
Dim hi As Long 
Dim lo As Long 
Dim i As Long

' If there is 0 or 1 item in the list, 
' this sublist is sorted. 
If min >= max Then Exit Sub

' Pick a dividing value. 
i = Int((max - min + 1) * Rnd + min) 
mid_value = list(i)

' Swap the dividing value to the front. 
list(i) = list(min)

lo = min 
hi = max 
Do 
' Look down from hi for a value < mid_value. 
Do While list(hi) >= mid_value 
hi = hi - 1 
If hi <= lo Then Exit Do 
Loop 
If hi <= lo Then 
list(lo) = mid_value 
Exit Do 
End If

' Swap the lo and hi values. 
list(lo) = list(hi)

' Look up from lo for a value >= mid_value. 
lo = lo + 1 
Do While list(lo) < mid_value 
lo = lo + 1 
If lo >= hi Then Exit Do Loop 
If lo >= hi Then 
lo = hi 
list(hi) = mid_value 
Exit Do 
End If

' Swap the lo and hi values. 
list(hi) = list(lo) 
Loop

' Sort the two sublists. 
Quicksort list, min, lo - 1 
Quicksort list, lo + 1, max 
End Sub 
```

# sql - 使用以下行详细信息回填

> ID：15617126
> 
> 赞同：1
> 
> 时间：2013-03-25T14:14:13.620
> 
> 标签：sql, sas

我有一个像第一 3 列的表，需要添加第四列：

```
Sequence ID Last Status  Current Status
1        1               New
2        1  New          Open    
3        1               Open
4        1               Open
5        1               Open
6        1  Open         Closed
7        1               Closed
8        1               Closed
9        1  Closed       
10       2               New
11       2  New          Open
12       2               Open
13       2  Open         Closed
14       2  Closed       
15       3               New
16       3  New          Open
etc. 
```

基本上它目前只显示状态更改时的最后状态 - 我需要显示当时的“当前”状态。

我是 SQL 新手，我认为我可以使用 LEAD，但不幸的是，SAS 不支持它。

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-25T14:29:39.167

以下 SQL 适用于大多数方言，包括 SAS SQL：

```
select t.quence, t.id, t.lastStatus, tnext.lastStatus as CurrentStatus
from (select t.*,
             (select min(Sequence) from t t2 where t2.id = t.id and t2.sequence > t.sequence and t2.LastStatus is not null
             ) as NextId
      from t
     ) t left out join
     t tnext
     on t.sequence = tnext.sequence 
```

它找到具有相同 id（如果有）的下一个状态记录，然后将结果重新加入以获取状态。

在 SAS 中，我更倾向于使用`data step`代码。如果数据存储在特定数据库中，则可能存在特定于该数据库的更简单的解决方案。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-25T16:56:26.417

这`data step`是应该做你想做的代码。它没有正确地完成最后一行，因为您没有任何其他行来表明它应该是`Open`. 如果有可以应用的数据逻辑规则，那应该很容易添加。

它确实需要两种类型，这可能很昂贵，但 SQL 连接可能需要在幕后进行类似的操作。如果您有大量数据，我建议您测试这两种方法，看看哪种方法更快。

```
data have;
input Sequence ID LastStatus  $;
infile datalines missover;
datalines;
1        1               
2        1  New           
3        1               
4        1               
5        1               
6        1  Open         
7        1               
8        1               
9        1  Closed       
10       2               
11       2  New          
12       2               
13       2  Open         
14       2  Closed       
15       3               
16       3  New          
;;;;
run;

proc sort data=have;
by id  descending sequence;
run;

data want;
set have;
length CurrentStatus $8;
by id  descending sequence;      *so the last sequence for each ID comes first;
retain CurrentStatus;            *keep its value for each row;
if first.id then 
 call missing(CurrentStatus);    *reset for each ID;
output;                          *put out the current line;
if not missing(LastStatus) then  
   CurrentStatus = LastStatus;   *now update CurrentStatus if needed;
run;

proc sort data=want;             *resort in logical order;
by id sequence;
run; 
```

# sql - 另一个表中的值在 Group by（SQL 服务器）中不起作用

> ID：15617133
> 
> 赞同：0
> 
> 时间：2013-03-25T14:14:46.013
> 
> 标签：sql, sql-server, sql-server-2008, tsql, join

我的数据库中有两个表。

第一个表

```
身份证 | 身份证件数
------------------
1 | 2
2 | 3
3 | 4
4 | 1
5 | 3

```

第二张表

```
身份证 | 身份证件数
------------------
1 | 1
2 | 2
3 | 3
4 | 5
5 | 7

```

现在，我想将第一个表的 ID 计数划分为第二个表，然后按第一个表的 ID 分组。

基本上预期的输出是

```
身份证 | 熵
------------------
1 | 2
2 | 1.5
3 | 1.3
4 | 0.2
5 | 0.42

```

我的查询：

```
 Select t1.ID, Sum(t1.[Count of ID's]/t2.[Count of ID's])
 from FirstTable t1, SecondTable t2 
 group by t1.ID; 
```

我认为我没有有效地使用该组。有人可以帮我吗？

我遇到的问题是总和是聚合所有值 (2+1.5+1.3+0.2+ 0.42= 5.42) 并与每个 ID 一起显示。

电流输出（错一个）

```
身份证 | 熵
------------------
1 | 5.42
2 | 5.42
3 | 5.42
4 | 5.42
5 | 5.42

```

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-25T14:17:09.510

您需要定义在`ON`子句中定义它们关系的列。

```
SELECT  a.ID,
        a.[Count of IDs] * 1.0 / b.[Count of IDs] * 1.0 Entropy
FROM    FirstTable a
        INNER JOIN secondTable b
            ON a.ID = b.ID 
```

*   [SQLFiddle 演示](http://www.sqlfiddle.com/#!3/77cab/3)

要进一步了解有关联接的更多信息，请访问以下链接：

*   [SQL 连接的可视化表示](http://www.codinghorror.com/blog/2007/10/a-visual-explanation-of-sql-joins.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-25T14:17:17.893

您的查询产生两个表的笛卡尔积，因为`from FirstTable t1, SecondTable t2`. `JOIN`他们改为：

```
Select t1.ID, Sum(1.0 * t1.[Count of ID's]/t2.[Count of ID's]) AS Entropy
from FirstTable t1
INNER JOIN  SecondTable t2 ON t1.id = t2.id
group by t1.ID; 
```

# razor - Asp.net Razor，语法错误 - onclick 事件参数

> ID：15617138
> 
> 赞同：11
> 
> 时间：2013-03-25T14:14:58.880
> 
> 标签：razor

```
<input type="button" value="Delete" onclick="deleteMember(@Model.ID, '@ViewBag.returnUrl')"/> 
```

该代码有 4 个错误、2 个语法错误和 2 个未终止的字符串常量。

我应该怎么做才能修复这些错误？

![在此处输入图像描述](../Images/4cb75fc9184bdbf1413ddd27787c1de4.png)

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2013-03-25T14:22:17.120

你可以在一个`Html.Raw`电话中打破它：

```
<input type="button"
       value="Delete"
       onclick="@(Html.Raw(String.Format("deleteMember({0}, '{1}')",
           Model.ID,
           Html.Encode(ViewBag.returnUrl)
       )))"
/> 
```

或将其分配给`string`第一个，然后在属性中引用该变量。

```
@{
  String onclick = String.Format("deleteMember({0}, '{1}')",
      Model.ID, Html.Encode(ViewBag.returnUrl));
}
<input type="button" value="delete" onclick="@onclick" /> 
```

第三种选择是分离关注点；将标记和脚本分开。[尼尔](https://stackoverflow.com/a/15617410/298053)打败了我，但类似：

```
<input type="button" value="delete"
    data-task="delete" data-id="@Model.ID" data-returnurl="@ViewBag.returnUrl" />

<!-- .... -->

<script>
  var buttons = document.getElementsByTagName('INPUT');
  for (var b = 0; b < buttons.length; b++){
    if (buttons[b].type != 'button') continue;
    switch (buttons[b].getAttribute('data-task') || ''){
      case 'delete':
        // read data-id & data-returnurl. Do something with them, and
        // move on.
        break;

      // other actions
      case 'add':
      case 'update':
      default:
        break;
    }
  }
</script> 
```

虽然奇怪的是第一个括号与剃刀混淆（即使它是在属性中声明的）。我自己不会想到这种行为。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-25T14:27:11.477

这更像是 VS 中的一个错误。

它认为它仍然会按照您的预期呈现。

我喜欢布拉德的解决方案。

另一个推荐的选项是将您的值弹出到[data-dash](http://ejohn.org/blog/html-5-data-attributes/)属性中，并使用 jQuery 之类的东西将 data-dash 值传递给您的函数。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-10-03T16:47:30.080

您可以这样做的另一种方法是将值分配给javascript变量并在方法调用中使用它们。

```
<script>
  var memberId = '@Model.ID';
  var returnUrl = '@ViewBag.returnUrl';
</script>

<input type="button" value="Delete" onclick="deleteMember(memberId, returnUrl)"/> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-04-11T09:36:49.427

您也可以使用这种方式在函数中传递参数

```
@Html.DropDownListFor(M => M.SubscriptionType,
   new SelectList(Model.DefaultPlanName, "value", "displayText"),
   new { @onclick = "Testnew('"+Model.CreationTime+"' )",
    @class = "form-control selectpicker" }) 
```

# sql-server - 从日期列表创建日期范围列表

> ID：15617139
> 
> 赞同：-1
> 
> 时间：2013-03-25T14:15:01.013
> 
> 标签：sql-server

我们目前存储的付款时间表如下：

```
Item No | Due Date   | Amount Due
108     | 2013-02-01 | 60.00
108     | 2013-02-26 | 60.00
108     | 2013-03-01 | 60.00
108     | 2013-03-15 | 60.00 
```

*注意：日期之间的差异是不一致的，即某些项目可能是几周、两周或几个月。*

我理想需要解决的是如何将上表重新查询为以下格式：

```
Item No | Due Date   | Date From  | Date To    | Amount Due
108     | 2013-02-01 | 2013-01-14 | 2013-02-25 | 60.00
108     | 2013-02-26 | 2013-02-26 | 2013-02-28 | 60.00
108     | 2013-03-01 | 2013-03-01 | 2013-03-14 | 60.00
108     | 2013-03-15 | 2013-03-15 | 2013-03-25 | 60.00 
```

为使这成为可能而输入的额外两个日期将是开始日期 (2013-01-14) 和今天的日期 (2013-03-25)。

每个范围应从原始到期日到下一个到期日的前一天。

任何建议将不胜感激。

* * *

更新

这是我到目前为止所尝试的：

```
WITH 
    CTE_Repayments(AgreementID, DueDate, AmountDue)
AS 
    (
    -- Anchor Member Definition
        SELECT 
            AgreementID, StartDate, CONVERT(DECIMAL(9,2),0.00)
        FROM
            Loans AS L
        WHERE
            L.AgreementID = 111
        UNION ALL
    -- Recursive Member Definition
        SELECT
            RB.AgreementID, RB.DueDate, CONVERT(Decimal(9,2),RB.AmountDue)
        FROM
            (
                SELECT *
                FROM RepaymentBreakdown
                WHERE AgreementID = 111
            ) AS RB
        INNER JOIN
            CTE_Repayments AS R
            ON RB.AgreementID = R.AgreementID
    )

-- Statement that Executes CTE
SELECT AgreementID, DueDate,  AmountDue
FROM CTE_Repayments 
```

但这不起作用。

我假设我需要添加一条起始日期为 Anchor 成员的记录。

好的，它现在返回带有上面修改后的代码的数据。

我现在遇到的问题是结果集不限于来自 Anchor 的 AgreementID，我收到一个错误：

> Msg 530, Level 16, State 1, Line 1 语句终止。在语句完成之前，最大递归 100 已用完。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-25T15:45:03.970

您的错误是您的语句达到默认递归限制 100 的结果。这可以通过使用[`MAXRECURSION`查询提示](http://msdn.microsoft.com/en-us/library/ms181714.aspx)来更改。要使用未声明限制的提示，您的语句将如下所示：

```
-- Statement that Executes CTE
SELECT AgreementID, DueDate,  AmountDue
FROM CTE_Repayments
OPTION (MAXRECURSION 0) 
```

**警告**：对递归没有限制时要*非常小心。*此限制用于短路无限递归循环。根据数据的外观，您的查询可能很容易产生其他问题。我建议逐渐增加您`MAXRECURSION`的 100 以上以找到合适的上限。在将此代码投入生产之前一定要对此进行测试。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-25T15:30:15.110

在 CTE 中可能有一种更优雅的方法，但这是我的解决方案。

```
WITH cte (rowNo, itemNo, dueDate, amountDue) AS
( 
  SELECT ROW_NUMBER() OVER(ORDER BY [Due Date]) rowNo, 
    [Item No], [Due Date], [Amount Due]
  FROM loans
)
SELECT a.itemNo, a.dueDate,
  CASE WHEN c.dueDate IS NULL THEN '2013-01-14'
    ELSE a.dueDate END AS dateFrom,
  CASE WHEN b.dueDate IS NULL THEN '2013-03-25'
    ELSE DATEADD(day, -1, b.dueDate) END AS dateTo,
  a.amountDue
FROM cte AS a
LEFT JOIN cte AS b ON b.rowNo = a.rowNo + 1
LEFT JOIN cte AS c ON c.rowNo = a.rowNo - 1 
```

**结果**

```
| 项目 | 截止日期 | 日期 | 约会 | 金额 |
-------------------------------------------------- -------------------------------------------------- ----------------------
| 108 | 2013 年 2 月 1 日 00:00:00+0000 | 2013 年 1 月 14 日 00:00:00+0000 | 2013 年 2 月 25 日 00:00:00+0000 | 60 |
| 108 | 2013 年 2 月 26 日 00:00:00+0000 | 2013 年 2 月 26 日 00:00:00+0000 | 2013 年 2 月 28 日 00:00:00+0000 | 60 |
| 108 | 2013 年 3 月 1 日 00:00:00+0000 | 2013 年 3 月 1 日 00:00:00+0000 | 2013 年 3 月 14 日 00:00:00+0000 | 60 |
| 108 | 2013 年 3 月 15 日 00:00:00+0000 | 2013 年 3 月 15 日 00:00:00+0000 | 2013 年 3 月 25 日 00:00:00+0000 | 60 |
```

[查看演示](http://sqlfiddle.com/#!3/e8c8a/1)

# sql - 如何防止在pl-sql中使用触发器将空数据插入表行

> ID：15617140
> 
> 赞同：1
> 
> 时间：2013-03-25T14:15:02.030
> 
> 标签：sql, plsql, oracle11g, sqlplus, plsqldeveloper

我正在尝试在 PL/SQL 中创建一个**插入前触发器**，这将防止将空数据插入到表行中。（强制执行非空条件并防止插入数字或特殊字符的触发器。

这是我创建的表。

```
CREATE TABLE CUSTOMER 
(
  CUSTOMER_ID INTEGER 
, CUST_FORENAME VARCHAR2(50) NOT NULL 
, CUST_SURNAME VARCHAR2(50) NOT NULL 
, GENDER CHAR(1) 
, EMAIL_ADDRESS VARCHAR2(30) NOT NULL 
, CONSTRAINT CUSTOMER_PK PRIMARY KEY (CUSTOMER_ID)
  ENABLE 
); 
```

还有我创建的触发器。

```
create or replace
TRIGGER CUS_MAND before insert OR update on CUSTOMER
begin
  CASE
    WHEN :NEW.CUST_FORENAME = NULL
      THEN DBMS_OUTPUT.PUT_LINE ('Please enter customer forename.');
    WHEN :NEW.CUST_SURNAME = NULL
      THEN DBMS_OUTPUT.PUT_LINE ('Please enter customer surname.');
    WHEN :NEW.EMAIL_ADDRESS = NULL
      THEN DBMS_OUTPUT.PUT_LINE ('Please enter customer email address.');
  END CASE;
END; 
```

但是这个触发器没有成功。有人可以为我解决问题吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-25T15:06:10.193

正如@APC 指出的那样，为此目的使用 NOT NULL 约束比使用触发器更有意义。

但是，如果您想使用触发器，您应该引发错误而不是仅仅打印到 DBMS_OUTPUT，因为

*   打印消息不会阻止插入错误数据
*   通常，INSERTS / UPDATES 将由某种客户端程序运行，并且 DBMS_OUTPUT 不会显示在此客户端程序中

除此之外，您的触发器中有几个错误：

*   您需要将触发器声明为 FOR EACH ROW，否则，您将无法使用 :NEW 和 :OLD （因为您的触发器将在每个*语句*中触发一次，而不是每*行*一次）
*   您的 CASE 语句缺少 DEFAULT 分支，因此如果所有检查都成功，您将在执行期间收到错误；我会改用 IF

一种可能的解决方案：

```
create or replace trigger CUS_MAND before insert OR update on CUSTOMER
for each row        
begin
  if :NEW.CUST_FORENAME is NULL THEN
    RAISE_APPLICATION_ERROR(-20001,
                            'Please enter customer forename.');
  end if;
  if :NEW.CUST_SURNAME is NULL THEN
    RAISE_APPLICATION_ERROR(-20002,
                            'Please enter customer surname.');
  end if;
  if :NEW.EMAIL_ADDRESS is NULL THEN
    RAISE_APPLICATION_ERROR(-20003,
                            'Please enter customer email address.');
  END if;
END; 
```

在这里，我使用 RAISE_APPLICATION_ERROR 来引发用户定义的异常；您可以对所有错误使用相同的错误编号 (-20001)，也可以使用编号来区分它们。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-25T15:15:56.043

您以错误的方式检查空值：

```
:NEW.CUST_FORENAME = NULL 
```

空值检查必须使用“is null”或“is not null”。相等运算符不起作用。没有什么与 NULL 相同或不同。

因此，如果 A := null：

```
a = Null => false
a != null => false
a is null => true
a is not null => false 
```

此外，您的触发器应该是 Frank Schmitt 指出的“FOR EACH ROW”。

如果您的验证很简单，则使用非空约束或检查约束可能是最佳选择。

# javascript - 检查 jQuery .hover 动作是否已经绑定

> ID：15617146
> 
> 赞同：1
> 
> 时间：2013-03-25T14:15:17.337
> 
> 标签：javascript, jquery, oop

有没有办法检查一个元素是否已经有一个由 jQuery .hover 函数触发的动作？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-25T14:19:09.080

您可以通过检查来检查`element.data('events')['eventName']`

在悬停的情况下，它将是：

```
var hasHover = x.data('events')['mouseover'] && x.data('events')['mouseout']; 
```

在 jQuery 1.8 及更高版本中，您必须使用[此答案](https://stackoverflow.com/a/12214688/921204)`$._data`中提到的方法访问它

IE

```
var events = $._data(obj[0], "events");
var hasHover = events['mouseover'] && events['mouseout']; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-25T14:26:22.983

看看选择器上的过滤器

```
$('.result').each(function(){
$(this).hover(function() {
$(this).filter(':not(:animated)').animate({
'height':'110px',
},160);
},function(){$(this).animate({'height':'38px'},80);});
}); 
```

# vb.net - 使用 json.net 解析 json 并处理 jobject 上的 nullexception

> ID：15617149
> 
> 赞同：1
> 
> 时间：2013-03-25T14:15:22.047
> 
> 标签：vb.net, json.net

我正在使用 json.net 解析 json 并将字符串转换为这样的对象

```
 Dim jobj As JObject = JObject.Parse(tweet)
 sid = jobj("id").ToString 
```

它似乎工作正常，但是当特定标签不存在时，我得到了 nullexception。我该如何处理？例如，如果在以下情况下：

```
"id":123456787,
"id_str":"123456787",
"text":"HELLO help with parsing json", 
```

如果 id_str 字段不存在，它将引发错误，并且我不想检查我尝试解析的每个字段上的空值。我尝试的另一个方法是到 jobj 并获取所有孩子的列表，然后遍历它们。

任何建议表示赞赏。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2016-12-23T23:22:48.783

您可以使用带运算符 的[直接](https://msdn.microsoft.com/en-us/library/7k6y2h6x.aspx)转换将具有字符串值的 a 直接转换为字符串：`CType`[`JToken`](http://www.newtonsoft.com/json/help/html/T_Newtonsoft_Json_Linq_JToken.htm)

```
Dim jobj As JObject = JObject.Parse(tweet)
Dim sid = CType(jobj("id"), String) 
```

这是有效的，因为`JToken`有大量内置的原始数据类型的[显式类型转换](http://www.newtonsoft.com/json/help/html/Operators_T_Newtonsoft_Json_Linq_JToken.htm)。并且，当原始类型是引用类型或可为空时，显式转换运算符将返回`Nothing`空输入。样品[小提琴](https://dotnetfiddle.net/OY97vu)。

您还可以在 Visual Studio 2015 中使用[空条件运算符。](https://msdn.microsoft.com/en-us/library/dn986595.aspx)

# xml - 使用 VB.Net 和 networkstream 将文本字符串发布到 Web 浏览器

> ID：15617158
> 
> 赞同：0
> 
> 时间：2013-03-25T14:15:46.907
> 
> 标签：xml, vb.net, browser, networkstream

我搜索了一种将文本字符串发布到套接字以供 Web 浏览器和其他设备查看的方法，但没有成功。我已经实现了 VB.Net 代码，该代码已经生成了所需的字符串输出到日志文件以进行调试。该程序将在连接时将设置变量的初始值推送到客户端，然后以设置的时间间隔扫描变量的更新。任何更新都将以这种方式作为新字符串推出：

时间戳|dataid1|dataitem1|dataid2|dataitem2|dataid3|dataitem3|dataid4|dataitem4|等

如果仅更改 2 和 4，更新可能如下所示：

时间戳|dataid2|dataitem2|dataid4|dataitem4

我相信我需要使用 networkstream 和 TCPListener 来检测客户端的请求并初始化我的通信。我在网上找到了几个例子，但没有成功实施它们。任何帮助是极大的赞赏。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-25T16:36:45.407

这个问题实在是太宽泛了，无法回答，但如果您想实现 TCP 客户端服务器通信，请查看：[http ://code.msdn.microsoft.com/windowsdesktop/Simple-Multi-User-TCPIP-43cc3b44](http://code.msdn.microsoft.com/windowsdesktop/Simple-Multi-User-TCPIP-43cc3b44)

您可能希望[查看 WCF](http://www.codeproject.com/Articles/33995/Getting-Started-with-WCF)，因为这可能是在您的情况下使用的更好的框架

# ckeditor - CKEditor：有没有办法限制用户可以在编辑器中输入/粘贴的字符？

> ID：15617163
> 
> 赞同：1
> 
> 时间：2013-03-25T14:16:01.047
> 
> 标签：ckeditor

我说的不是字符数量，而是字符类型。例如，我可以将我的 CKEditor 实例限制为数字和逗号或字母数字吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-25T16:55:20.730

你正在寻找这样的东西。您也可以仅检查 keyCode。有关更多信息，请查看 google 的键码差异。

```
CKEDITOR.instances.editor1.document.on('keydown', function(e)
{
    var prevent = {'1','2','3','4','5'}
    var character = null;
    var charCode = (CKEDITOR.env.ie ? e.data.$.keyCode : e.data.$.charCode);
    if(charCode != 0)//Mozilla check
    character = String.fromCharCode(charCode);

    //restriction logic
    if(jQuery.inArray(character, prevent))
    {
       e.data.preventDefault(); // To prevent insert
    }
} 
```

但是你总是需要在这个函数中定义字符。没有防止插入字符类型的完整解决方案。据我所知。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-08-26T15:10:11.143

查看 ckeditor 文档，有一个名为“blockedKeystrokes”的选项。

[http://docs.cksource.com/ckeditor_api/symbols/CKEDITOR.config.html#.blockedKeystrokes](http://docs.cksource.com/ckeditor_api/symbols/CKEDITOR.config.html#.blockedKeystrokes)

# javascript - 解析 JSON 给出“意外的令牌 o”错误

> ID：15617164
> 
> 赞同：455
> 
> 时间：2013-03-25T14:16:02.800
> 
> 标签：javascript, json

我在解析简单的 JSON 字符串时遇到问题。我已经在[J​​SONLint](http://www.JSONLint.com)上检查了它们，它表明它们是有效的。但是，当我尝试使用其中一个`JSON.parse`或 jQuery 替代方法解析它们时，它给了我错误`unexpected token o`：

```
<!doctype HTML>
<html>
  <head>
  </head>
  <body>
    <script type="text/javascript">
      var cur_ques_details ={"ques_id":15,"ques_title":"jlkjlkjlkjljl"};
      var ques_list = JSON.parse(cur_ques_details);

      document.write(ques_list['ques_title']);
    </script>
  </body>
</html> 
```

注意：我正在使用`json_encode()`PHP 对字符串进行编码。

* * *

## 回答 #1

> 赞同：811
> 
> 时间：2013-03-25T14:17:54.933

您的数据已经是一个对象。无需解析它。javascript 解释器已经为您解析了它。

```
var cur_ques_details ={"ques_id":15,"ques_title":"jlkjlkjlkjljl"};
document.write(cur_ques_details['ques_title']); 
```

* * *

## 回答 #2

> 赞同：72
> 
> 时间：2015-07-14T15:32:37.537

尝试解析：

```
var yourval = jQuery.parseJSON(JSON.stringify(data)); 
```

* * *

## 回答 #3

> 赞同：14
> 
> 时间：2015-02-25T17:08:52.973

使用`JSON.stringify(data);`：

```
$.ajax({
    url: ...
    success:function(data){
        JSON.stringify(data); //to string
        alert(data.you_value); //to view you pop up
    }
}); 
```

* * *

## 回答 #4

> 赞同：11
> 
> 时间：2013-03-25T14:30:05.797

但是，您的错误来源是您需要将完整的 JSON 字符串放在引号中。以下将修复您的示例：

```
<!doctype HTML>
<html>
    <head>
    </head>
    <body>
        <script type="text/javascript">
            var cur_ques_details ='{"ques_id":"15","ques_title":"jlkjlkjlkjljl"}';
            var ques_list = JSON.parse(cur_ques_details);
            document.write(ques_list['ques_title']);
        </script>
    </body>
</html> 
```

正如其他受访者所提到的，该对象已被解析为 JS 对象，因此您无需解析它。为了演示如何在不解析的情况下完成相同的事情，您可以执行以下操作：

```
<!doctype HTML>
<html>
<head>
</head>
    <body>
        <script type="text/javascript">
            var cur_ques_details ={"ques_id":"15","ques_title":"jlkjlkjlkjljl"};
            document.write(cur_ques_details.ques_title);
        </script>
    </body>
</html> 
```

* * *

## 回答 #5

> 赞同：10
> 
> 时间：2013-03-25T14:17:53.947

`cur_ques_details`已经是JS对象了，不需要解析

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2014-09-29T20:54:29.597

响应已解析，您无需再次解析。如果你再次解析它会给你“ `unexpected token o`”。如果您需要将其作为字符串获取，您可以使用`JSON.stringify()`

* * *

## 回答 #7

> 赞同：6
> 
> 时间：2014-10-08T07:17:57.183

当我使用 jQuery AJAX 提交数据时，我遇到了同样的问题：

```
$.ajax({
   url:...
   success:function(data){
      //server response's data is JSON
      //I use jQuery's parseJSON method 
      $.parseJSON(data);//it's ERROR
   }
}); 
```

如果响应是 JSON，并且你使用这个方法，你得到的数据是一个 JavaScript 对象，但是如果你使用`dataType:"text"`，数据是一个 JSON 字符串。那么使用`$.parseJSON`就OK了。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2015-02-22T06:38:42.753

我看到这个`unexpected token o`错误是因为我的（不完整的）代码之前已经运行过（实时重新加载！）并将特定的键控本地存储值设置为`[object Object]`而不是`{}`. 直到我换了钥匙，事情才开始按预期工作。或者，您可以按照[这些说明删除错误设置的 localStorage 值](https://stackoverflow.com/a/10710029/687274)。

# php - mysql 带来的数据现在显示在 div 中 Ordering them How？

> ID：15617166
> 
> 赞同：-1
> 
> 时间：2013-03-25T14:16:11.590
> 
> 标签：php, mysql

假设我在 6 行从 mysql 带来的单独 div 中显示了以下信息

```
<?php
echo "<div id='id'>
echo $row['id'];

echo "<div id='description'>
echo $row['description'];

echo "<div id='price'>
echo $row['price'];

?> 
```

现在我需要按 ID /price 订购它们，所以我把它们放在一个数组中

```
while ($row = mysql_fetch_array($query)) {
     $id_array[] = $row['id'];
     $price_array[] = $row['price']; 
```

现在我不知道如何显示订购的项目我是否执行我`SELECT*FROM books ORDER BY id DESC` 尝试过但不工作的 sql 方法或我不知道如何编写的 php 数组 ksort。此外，如果我必须成功订购显示的数据，则必须从他们的 div 移动到适当的 div。

如果这听起来真的令人困惑，请提前道歉！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-25T14:22:25.593

您的查询应如下所示，

```
SELECT * FROM books ORDER BY id ASC, price ASC 
```

使用 php 和 while 循环，您可以输出内容，（这是使用 PDO）

```
while($row = mysql_fetch_array($query)) {

    echo '<div id="id">' . $row['id'] . '</div>';

    echo '<div id="description">' . $row['description'] . '</div>';

    echo '<div id="price">' . $row['price'] . '</div>';
} 
```

另请注意，`html` `attributes`被双引号包围`"`！

希望这可以帮助

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-25T14:18:16.617

您可以在 SQL 语句中使用

```
ORDER BY id ASC, Price ASC 
```

要将其添加到您的数组中，您需要执行以下操作：

```
$count = 0;

while ($row = mysql_fetch_array($query)) {
     $array[$count][0] = $row['id'];
     $array[$count][1] = $row['price'];
     $count++;
} 
```

否则，您可以像这样直接输出数据：

```
while ($row = mysql_fetch_array($query)) {
     echo $row['id']. " - ".$row['price']."<br/>";
} 
```

# microsoft-dynamics - Dynamics NAV 2009 RTC 是否包含孤立字段？

> ID：15617167
> 
> 赞同：1
> 
> 时间：2013-03-25T14:16:11.610
> 
> 标签：microsoft-dynamics, dynamics-nav

直到今天，我的印象是，一个字段只能显示在 RTC 布局的数据集中，如果它已在经典报告的某个部分中定义。

然后今天我正在设计一个新报告，并注意到 RTC 布局中有一些我在经典部分中找不到的数据集字段。

为了验证这一点，我将对象导出为文本文件，并搜索字段的名称，因为它出现在 Visual Studio 的数据集结果中：Sales_Shipment_Header_No_Sales_Shipment_Line_Document_No_Sales_Shipment_Line_Line_No_

在相应对象的文本文件中，我发现这三个名称在文件部分中定义。但在其他任何地方都没有发生。如果我搜索其他字段的名称，它们总是在文本字段或标签中具有附加引用。

然后我删除了数据集中所有出现的字段，如果它们的名称没有被其他对象引用，例如标签或文本字段。我确认搜索在文件中不再出现这些字符串，并再次将文件导入 Navision。令我惊讶的是，这些字段在 RTC 布局中仍然可见（我什至尝试生成新布局）。

我的问题：这是一个错误吗？或者是否有其他机制在工作中生成这些字段？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-25T20:58:26.747

在 NAV 2009 下，您将在数据集中获得一些未出现在您的部分中的字段。它们对应于所涉及表的主键。

例子。

使用销售表头和销售行表设置新报告。不要在部分中添加任何内容，然后设计布局。您将拥有以下可用字段 Sales_Header_Document_Type Sales_Header_No_Sales_Line Document_No_Sales_Line_ Document_Type Sales_Line_Line_No_

问候

伊恩

# java - 如何告诉 IntelliJ 使用 Java 1.6 JDK 启动 gradle？

> ID：15617170
> 
> 赞同：13
> 
> 时间：2013-03-25T14:16:15.173
> 
> 标签：java, windows, intellij-idea, gradle

一个简单的问题，即使经过数小时的尝试和搜索，我也无法弄清楚：

我安装了 Java 6 和 7。

**如何告诉 IntelliJ 使用 JDK 1.6 版开始 Gradle 构建？**

无论我做什么，IntelliJ 都会不断地开始我的 gradle

```
"c:\program files\java\jdk1.7.0_10\jre\bin\java" -Dgradle.home=C:\_CODING_\gradle-1.4 [...] 
```

我试过了：

*   所有项目模块都设置为使用 1.6
*   `JAVA_HOME`被设定为`C:\Program Files\Java\jdk1.6.0_38`
*   设置`IDEA_JDK`什么也没做
*   `gradle -v`在命令行上将 1.6 识别为其 JDK
*   重新启动 IntelliJ 和/或计算机并没有改变行为

是否有避免调用 Java 1.7 的设置？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2015-11-10T12:44:50.220

... 2.5 年后：

我正在使用 IntelliJ IDEA 15.0，并且遇到了类似的问题：

此版本的 IDEA 与 JDK 1.8 捆绑在一起，我想在 JDK 1.7 下构建和运行 Gradle 项目

**Gradle 使用的 JDK 可以在首选项中进行配置**（之前可能不是这样）：

IDEA > 首选项 > 构建、执行、部署 > 构建工具 > Gradle

...在“使用本地 gradle 分发”下，您应该看到“Gradle JVM”属性。

注意：就我而言，它似乎仅在系统重新启动后才生效。如果它不能立即工作，可以尝试一下！

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2013-03-25T15:59:04.980

'jre choose' 算法在[这里](https://github.com/JetBrains/intellij-community/blob/master/plugins/gradle/src/org/jetbrains/plugins/gradle/remote/GradleJavaHelper.java)定义，即它尝试以下操作：

1.  'gradle.java.home' 系统属性中引用的 Java 位置（如果有）；
2.  'JAVA_HOME' 环境变量；
3.  项目jdk；
4.  ide配置的任何jdk；

我怀疑你有“gradle.java.home”，它指向 $IDEA_HOME/bin/idea.properties 中的 java 1.7

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2013-03-26T11:29:49.967

尽管[丹尼斯的回答](https://stackoverflow.com/a/15619311/409349)帮助我进一步调查，但起初并不成功。

### 我有 99 个问题，但 gradle 不是一个

我的第一个发现是，实际上问题不是 gradle，而是整个 IDE 都在使用 Java 7，尽管我的设置另有说明。

我有几个问题要解决：

1.  Java 7 安装了一个 java.exe 的副本，该副本`C:\Windows\System32\`早于`%PATH%`同样的设置`%JAVA_HOME%/bin%`

    => 删除副本导致`%JAVA_HOME%/bin/java.exe`正确拾取所需的副本

2.  下一个问题是通过`idea64.exe`仍然使用 JDK7 启动 IntelliJ，我找不到改变它的方法

    =>测试中的**专业提示**：IDEA Plugin [SystemProperties](http://plugins.jetbrains.com/plugin?pr=idea&pluginId=15)显示 IDE 当前使用的所有 JAVA-Props =>`idea.bat`改为使用可配置的方式

3.  `idea.bat`仍然拒绝使用 JDK 中的设置，`%JAVA_HOME%`而是使用捆绑的 JRE ( `%IDEA_HOME%/jre`)

    => 检查 bat 文件的内容导致我找到解决方案来定义`%IDEA_JDK%`指向`%JAVA_HOME%`哪个确实是 bat 在诉诸捆绑的 JRE 之前检查的唯一变量

### 最后的想法

关于设置正确的 JDK/JRE 以启动 IntelliJ 存在一些奇怪的问题，但它完全可行，无需更改任何属性文件或启动文件，因此可以安全升级。

### 奖金提示

如果您使用的是 Windows 并且需要更好的方法来跟踪系统属性，我建议您使用[RapidEE](http://www.rapidee.com/en/about)。它的 GUI 比自 Windows 95 以来没有改变的丑陋的 Windows UI 要好得多。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2015-08-07T08:59:28.653

我的问题是：我想运行 1.8，但它运行的是 1.6。

当我在 IntelliJ 想法中运行“gradle run”时，我可以看到输出：

```
10:50:35: Executing external task 'run'... :compileJava :processResources UP-TO-DATE :classes Exception in thread "main" java.lang.NoClassDefFoundError: org/raig Caused by: java.lang.ClassNotFoundException: org.raig     at java.net.URLClassLoader$1.run(URLClassLoader.java:202)   at java.security.AccessController.doPrivileged(Native Method)   at java.net.URLClassLoader.findClass(URLClassLoader.java:190)   at java.lang.ClassLoader.loadClass(ClassLoader.java:306)    at sun.misc.Launcher$AppClassLoader.loadClass(Launcher.java:301)    at java.lang.ClassLoader.loadClass(ClassLoader.java:247) :run FAILED

FAILURE: Build failed with an exception.

* What went wrong: Execution failed for task ':run'.
> Process 'command '/System/Library/Java/JavaVirtualMachines/1.6.0.jdk/Contents/Home/bin/java'' finished with non-zero exit value 1 
```

我修改了/Applications/IntelliJ IDEA 14 CE.app/Contents/Info.plist

```
<key>JVMOptions</key>
    <dict>
      <key>ClassPath</key>
      <string>$APP_PACKAGE/Contents/lib/bootstrap.jar:$APP_PACKAGE/Contents/lib/extensions.jar:$APP_PACKAGE/Contents/lib/util.jar:$APP_PACKAGE/Contents/lib/jdom.jar:$APP_PACKAGE/Contents/lib/log4j.jar:$APP_PACKAGE/Contents/lib/trove4j.jar:$APP_PACKAGE/Contents/lib/jna.jar</string>

      <key>JVMVersion</key>
      <string>1.6*,1.7+</string> 
```

我在 JVMVersion 键中添加了“1.8*”。

```
<key>JVMVersion</key>
      <string>1.8*,1.6*,1.7+</string> 
```

我重新启动了 IntelliJ，运行了任务，我得到了：

```
Execution failed for task ':run'.
> Process 'command '/Library/Java/JavaVirtualMachines/jdk1.8.0_31.jdk/Contents/Home/bin/java'' finished with non-zero exit value 1 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-03-24T20:18:45.430

只是为了扩展来自 denis.zhdanov 的响应：由于 Intellij 在 Mac OS X 中通过“图标单击”调用它时没有从 bash 中获取系统/env 变量的古老问题 - 你将不得不罚款 Info .plist 并将属性添加到文件中以使其工作。例如：

在您的系统上，找到： */Applications/IntelliJ IDEA 12.app/Contents/Info.plist*

编辑文件以在 Properties 部分中添加值：

`<dict> <key>gradle.java.home</key> <string>/Library/Java/JavaVirtualMachines/jdk1.7.0_51.jdk/Contents/Home</string> </dict>`

路径是您的 JVM 的 $JAVA_HOME。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2016-03-01T17:14:20.373

只需将项目中的 gradle 属性文件更改为包括：

org.gradle.java.home = /Library/Java/JavaVirtualMachines/jdk1.7.0_79.jdk/Contents/Home

或您需要的任何 JDK。我一直在寻找一个像弱者一样的答案，它把我逼疯了。

# android - 有意图地使用 Robotium

> ID：15617173
> 
> 赞同：1
> 
> 时间：2013-03-25T14:16:22.740
> 
> 标签：android, robotium

我有一个应用程序有几个带有列表视图的活动，从第一个列表视图中的选择决定了第二个列表视图的内容，第二个列表视图决定了第三个的内容，等等。

我想测试第三个列表视图，但由于它需要一个意图，所以列表什么也不返回。为了解决这个问题，我可以手动将意图添加到测试中，这确实意味着它可以工作

```
public InspectionListActivityTest() {
    super(InspectionListActivity.class);
    Intent i = new Intent();
    i.putExtra("guid", "abcbbf2b-5e14-4cb1-af1b-e3084b45d4cf");
    setActivityIntent(i);
} 
```

正如您从代码中看到的那样，它使用 guid 来确定我想要避免的列表 - 我在测试时经常清除数据库，所以我必须一直更改这个字段。

理想情况下，我想使用 ContentResolver 从另一个表中获取第一个 guid，这意味着我将能够始终在我的测试中提取信息，即

```
public InspectionListActivityTest() {
    super(InspectionListActivity.class);

    ContentResolver cr = getActivity().getContentResolver();
    Cursor cursor = cr.query(Locations.CONTENT_URI, null, null, null, null);
    if (cursor != null) {
        if (cursor.moveToFirst()) {
            String guid = cursor.getString(cursor.getColumnIndex(Locations.GUID));
            Intent i = new Intent();
            i.putExtra(IntentFilters.LOCATION.getIntent(), guid);
            setActivityIntent(i);
        }
    }
} 
```

但是，我在 getActivity() 方法上得到了一个 nullpointerexception，而且我似乎无法将此 setActivityIntent 放在其他任何地方。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-03T11:27:44.520

可以做，就是有点乱。基本上从我想要的数据库中获取了 guid，为原始测试类创建了一个新的意图，将 guid 附加到意图，然后启动了意图。

```
public void setUp() throws Exception {
     super.setUp(); 

    solo = new Solo(getInstrumentation(), getActivity());

    activity = getActivity();

    UsefulFunctions.insertDummyData(getActivity());

    ContentResolver cr = getActivity().getContentResolver();
    Cursor cursor = cr.query(Locations.CONTENT_URI, null, null, null, null);

    if (cursor != null) {
        if (cursor.moveToFirst()) {
            guid = cursor.getString(cursor.getColumnIndex(Locations.GUID));

        }
    }

    solo.goBack(); 

    Intent i = new Intent(activity.getApplicationContext(), InspectionListActivity.class);
    i.putExtra(IntentFilters.LOCATION.getIntent(), guid);
    setActivityIntent(i);
    activity.startActivity(i); 

} 
```

在某种程度上，从我的第一个列表开始，然后让 Robotium 在列表中“点击”一直到我想要的屏幕更容易，即

```
solo.clickInList(0);

// Locations
solo.clickInList(0);

ListView ls = solo.getCurrentListViews().get(0);

solo.waitForActivity("InspectionListActivity"); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-25T14:23:12.263

这一切都应该在`setup()`您的测试方法中完成，而不是在其构造函数中。测试的构造函数是无用的，应该保持不变。

# php - 在 Magento 中按价格列出产品，但最后价格为零

> ID：15617174
> 
> 赞同：3
> 
> 时间：2013-03-25T14:16:25.063
> 
> 标签：php, magento

产品搜索排序列表中是否有一种方法可以按最高价格到最低价格对产品进行排序，但最后会显示零价格的产品。

正常排序工作正常（从低到高或从高到低），但真的希望能够在最后包含零价格产品，如何列出的示例如下：

> 产品 1：3 英镑
> 
> 产品 2：18 英镑
> 
> 产品 3：0 英镑
> 
> 产品 4：0 英镑

我还没有找到从这里或谷歌搜索的方法，而且对 Magento 不太熟悉，我不确定我会在哪里改变它。如果有人有答案或可以将我指向查询或正确的文件让我自己编辑，我不介意自己去。

使用此处的一些帮助和其他问题，我编辑了`_getProductCollection()`文件中的方法`/app/code/core/Mage/Catalog/Block/Product/List.php`（不用担心我已经复制到本地）并添加了以下几行：

```
$orderFilterType = $this->getRequest()->getParam('order');
$dirFilterType = $this->getRequest()->getParam('dir');

if( isset( $orderFilterType ) && $orderFilterType == 'price' && isset( $dirFilterType ) && $dirFilterType == 'asc' ) {

$this->_productCollection = $layer->getProductCollection()->addAttributeToSort( 'price', 'DESC' );

} else { 

$this->_productCollection = $layer->getProductCollection();

} 
```

这意味着我在这段代码中所做的任何事情都只会在有人使用升序选项选择 orderby 价格下拉菜单后运行。

现在的问题是我不知道该怎么做才能影响`$this->_productCollection = $layer->getProductCollection();`我想要的返回值。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2017-04-20T15:52:13.873

我知道的派对晚了 4 年，但我刚刚以比我找到的其他解决方案更好的方式解决了这个问题，可能会对某人有所帮助。

在 Catalog/Block/Product/List/Toolbar.php 中替换

```
$this->_collection->setOrder($this->getCurrentOrder(), $this->getCurrentDirection()); 
```

和

```
$zeroPriceLast = new Zend_Db_Expr('`price_index`.`price` = 0 ASC, `price_index`.`price`  ASC');

$this->_collection->getSelect()->order($zeroPriceLast); 
```

并包装在条件中，以便仅在按价格排序时应用新逻辑。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-30T23:19:50.543

看看这里这个问题：***[Magento, custom product list](https://stackoverflow.com/questions/5184241/magento-custom-product-list)***这可能适合您的需要

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-31T11:45:10.587

我想你需要这样的东西

1.  为每个产品列表创建一个观察者：

    `<events> <catalog_block_product_list_collection> <observers> <rebuild_collection> <type>singleton</type> <class>XXX_YYY_Model_Catalog_Observer</class> <method>rebuildCollection</method> </rebuild_collection> </observers> </catalog_block_product_list_collection></events>`

其中 XXX - 你的命名空间 YYY - 你的模块

1.  创建.php文件

    ```
    <?php
    class XXX_YYY_Model_Catalog_Observer extends Mage_Catalog_Model_Observer
    {
    public function rebuildCollection($observer)
    {
    $event = $observer->getEvent();
    /** @var $collection Mage_Catalog_Model_Resource_Eav_Mysql4_Product_Collection */
    $collection = $event->getCollection();

    $toolbar = Mage::getBlockSingleton('catalog/product_list_toolbar');

            // here you can add some attributes to collection but it's not required
            // ex. $collection->addAttributeToSelect('brand')
            //    ->addAttributeToSelect('style');
            // you can also force visibility filter Mage::getSingleton('catalog/product_visibility')->addVisibleInCatalogFilterToCollection($collection);

             // and here is main part for your logic
            // getting current sort order
            $arr = $collection->getSelect()->getPart(Zend_Db_Select::ORDER);
            // probably here you will need to add condition like  IF ORDERING BY PRICE
            $r = Mage::app()->getRequest()->getRequestString();

            $order_field = 'new_price_for_sort';
            $collection->getSelect()->joinLeft(array('a' => 'catalog_product_entity_price'), // or here you will need Price Index Table Name if you have Groupped or configurable products. But need to remember that non-simple products always have 0 price and MAX_PRICE/MIN_PRICE should be used then 
                            'a.product_id=e.entity_id AND a.attibute_id=PRICE or SPECIAL PRICE ATTRIBUTE ID', // or here you will not require attribute_id condition if you are using INDEX TABLE
                            array(
                                'new_price_for_sort' => new Zend_Db_Expr('IF(a.value > 0,a.value, 9999999)'), // which mean that in new field we will have price if it's not 0, and will have big integer is real price is zero. 
                            ));
                    }
    // now we are reseting current order by
                    $collection->getSelect()->reset(Zend_Db_Select::ORDER);

    // and creating new order by new field, but with saving direction of order
    $dir = $arr['dir'];
                    if (!$collection->isEnabledFlat()) {
                        $collection->setOrder($order_field, $dir);
                    } else {
                        $collection->getSelect()->order($order_field . ' ' . $dir);
                    }

                }
          //check in log if collection real built well
            Mage::log((string)$collection->getSelect(), null, 'selects.log');
          // add collection to list toolbar
            $toolbar->setCollection($collection);
        }
    return $collection;
    }
    } 
    ```

PS 抱歉，我没有正确地重新检查此代码，而是从真正的工作观察者那里复制了大部分代码。但可能有一些错误类型或遗漏的字符）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-31T05:50:12.403

在原始 SQL 中执行此操作如下所示：

```
SELECT main.*, price.value as price FROM catalog_product_entity AS main
    JOIN catalog_product_entity_decimal AS price ON price.entity_id = main.entity_id
    JOIN eav_attribute AS attr_price ON attr_price = 'price' AND price.attribute_id = attr_price.attribute_id
ORDER BY price == 0, price 
```

您可能必须覆盖核心块才能使该`ORDER BY price ==0, price`子句正常工作。

# linq - 如何使用实体框架每周获取聚合数据

> ID：15617179
> 
> 赞同：1
> 
> 时间：2013-03-25T14:16:30.563
> 
> 标签：linq, entity-framework, sum, aggregate

我有一个名为“VideoData”的后端表，其中包含以下形式的数据：

```
 VideoID       RecordingStarted         RecordingEnded
    ==============================================================
    abc123        2013-03-01 15:30:00      2013-03-01 15:40:00        
    def123        2013-03-06 12:00:00      2013-03-06 12:40:00
    ijk123        2013-03-10 11:00:00      2013-03-10 11:05:00
    klm123        2013-03-12 10:05:00      2013-03-12 10:25:00
    And list goes on .......
    .......................
    ............................. 
```

使用实体框架，我想获取例如 2013 年 3 月的视频总小时数，以这样的方式，捕获的视频总小时数为每周。以下列方式举例：

```
 Mar 1, 2013     Mar 8, 2013      Mar 15, 2013     Mar 22, 2013
   ================================================================
   500              300              350              200 
```

我用谷歌搜索了很多，但无法弄清楚如何准确地做到这一点。请指导。谢谢你的帮助。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-25T19:41:08.200

我讨厌否决 Ilya 的出色工作（对不起，伙计，至少我支持你），但由于这是实体框架，因此可以使用[SqlFunctions](http://msdn.microsoft.com/en-us/library/system.data.objects.sqlclient.sqlfunctions.aspx)让数据库在一个查询中完成这项工作：

```
context.Videos.Select(t => new
  {
      Year = SqlFunctions.DatePart("yyyy", t.RecordingStarted),
      Week = SqlFunctions.DatePart("ww", t.RecordingStarted),
      Hours = SqlFunctions.DateDiff("hh", t.RecordingStarted, t.RecordingEnded)
  })
.GroupBy(x => new { x.Year, x.Week} )
.Select (x => new { x.Key.Year, x.Key.Week, TotalHours = x.Sum(p => p.Hours)} ) 
```

输出将类似于

```
2013  9 500
2013 10 300
... 
```

在 Sql Server 中，从年 + 周到日期是非常困难的。如果这确实是一个要求，您可以考虑构建一个包含年 + 周数和第一天日期的参考表。或者获取内存中的数据 ( `.ToList()`) 并使用 C# 转换数据。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-25T15:35:28.210

好吧，这个任务似乎很有趣。我已经使用本地数据实现了基本功能。随意评论更多功能。你有点乱

```
//local data for testing
var data = new[] {
    new {VideoId = "abc123",RecordindStarted = DateTime.Parse("2013-03-01 15:30:00"),RecordingEnded = DateTime.Parse("2013-03-01 15:40:00")},        
    new {VideoId = "def123",RecordindStarted = DateTime.Parse("2013-03-06 12:00:00"),RecordingEnded = DateTime.Parse("2013-03-06 12:40:00")},
    new {VideoId = "de1223",RecordindStarted = DateTime.Parse("2013-03-06 12:30:00"),RecordingEnded = DateTime.Parse("2013-03-06 12:50:00")},
    new {VideoId = "ijk123",RecordindStarted = DateTime.Parse("2013-03-10 11:00:00"),RecordingEnded = DateTime.Parse("2013-03-10 11:05:00")},
    new {VideoId = "klm123",RecordindStarted = DateTime.Parse("2013-03-12 10:05:00"),RecordingEnded = DateTime.Parse("2013-03-12 10:25:00")},
    new {VideoId = "klm123",RecordindStarted = DateTime.Parse("2013-03-12 10:05:00"),RecordingEnded = DateTime.Parse("2013-03-13 10:25:00")},
};

var calendar = new GregorianCalendar();

var ungroupedTotalHours = data.Select(d => GetHoursPerDays(d.RecordindStarted, d.RecordingEnded));

var groupedTotalHours = 
         ungroupedTotalHours.SelectMany(v => v)
                            .GroupBy(v=> v.Key)
                            .ToDictionary(v => v.Key, v => v.Sum(val => val.Value));

var result = 
 groupedTotalHours.GroupBy(v =>calendar.GetWeekOfYear( v.Key, CalendarWeekRule.FirstDay, DayOfWeek.Monday))
                  .ToDictionary(v => "Week "+ v.Key, row => row.Sum(val => val.Value));

Console.WriteLine ( string.Join(Environment.NewLine, result.Select(r => r.Key +" has "+r.Value+" hours")) ); 
```

核心逻辑转到此方法：

```
public IDictionary<DateTime, int> GetHoursPerDays(DateTime start, DateTime end)
{
    if(end.Date == start.Date)
        return new Dictionary<DateTime, int>{{start.Date, (end -  start).Minutes}};
    return Enumerable.Range(1, (int)(end -  start).TotalHours)
                    .Select(v => start.AddHours(v))
                    .GroupBy(v => v.Date)
                    .ToDictionary( v => v.Key, r => r.Count());
} 
```

印刷：

```
Week 9 has 10 hours
Week 10 has 65 hours
Week 11 has 44 hours 
```

# xpages - XPages 保存数字强制为 2sp

> ID：15617180
> 
> 赞同：0
> 
> 时间：2013-03-25T14:16:32.907
> 
> 标签：xpages

如何强制将用户输入的数字另存为 2dp？我可以设置显示，但我实际上希望它与 2dp 一起保存。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-25T15:47:07.607

我假设您想存储 2 个小数点精度（并截断/舍入任何更长的时间）。在 Notes 文档中，数字没有精度设置，它将始终按从 XPage 接收的形式存储。您有多种选择：

*   使用自定义输入过滤器来操作数字（剪切/舍入，在 . 之后没有点填充 0）
*   在更改后事件中对其进行舍入
*   在 querySave 事件中对其进行舍入
*   在原始表单中使用 @Formula 并将属性设置为使用表单计算（最慢）

# c# - 手动检查用户是否登录asp.net的有效方法

> ID：15617181
> 
> 赞同：0
> 
> 时间：2013-03-25T14:16:33.077
> 
> 标签：c#, asp.net, global-asax

我正在开发一个没有实现 asp.net 成员资格的 asp.net 3.5 应用程序。如果用户登录到应用程序，我将在用户表中维护一个标志，如果用户登录，该标志将设置为 true，如果用户手动注销或用户空闲超过 5 分钟，则设置为 false . 如果此标志的值为 true，则其他用户无法使用相同的用户名登录应用程序。

我正在使用`Session_End`Global.asax 文件的事件在用户空闲超过 5 分钟时将标志值设置为 false，但问题是如果用户空闲超过 5 分钟，有时标志值不会更新为 false这表明 Session_End 不是很可靠。

有人请建议我替代`Session_End`上述情况。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-25T14:19:56.860

使用时间跨度机制。刷新服务器上每个用户操作的时间跨度。当时间跨度超过 5 分钟时，您就会知道他已经走了。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-25T14:21:43.700

我建议使用会话超时来强制结束会话。更多信息可以在这里找到 - [http://msdn.microsoft.com/en-us/library/system.web.sessionstate.httpsessionstate.timeout%28v=vs.110%29.aspx](http://msdn.microsoft.com/en-us/library/system.web.sessionstate.httpsessionstate.timeout%28v=vs.110%29.aspx)

您是否设置了任何超时值？

# php - 根据 jpg/png 或 pdf 从前端上传检测文件类型并以不同方式显示？

> ID：15617182
> 
> 赞同：0
> 
> 时间：2013-03-25T14:16:35.733
> 
> 标签：php, html, wordpress

我创建了一个前端系统，允许人们提交图像和 pdf。

事后看来，我们会将其分成两个单独的字段，但现在为时已晚，因为有超过 500 份提交。

**如何首先检测文件的格式，然后将其显示为`img`jpg/png 或将其显示为链接（如果它是 pdf）？**

这是目前的代码：

```
<?php if(get_field('submit_image_or_pdf1') != "") { ?>
<img src="<?php echo the_field('submit_image_or_pdf1');?>" alt="<?php echo the_title(); ?> - <?php echo the_field('submit_submission_production_title'); ?>" /> 
<?php } ?> 
```

无论格式如何，这都是实际输出文件的内容：

```
<?php echo the_field('submit_image_or_pdf1');?> 
```

* * *

更新：

```
<?php $field = get_field('submit_image_or_pdf1');
    function ($field) {
    if ($_FILES[$field]['type'] == 'application/pdf') { ?>
        <a href="<?php echo the_field('submit_image_or_pdf1');?>">View PDF</a>
        <br /><br /><br /><br />
    <?php } else { ?>
        <img src="<?php echo the_field('submit_image_or_pdf1');?>" alt="<?php echo the_title(); ?> - <?php echo the_field('submit_submission_production_title'); ?>" /> 
        <br /><br /><br /><br />
    <?php } ?>
<?php } ?> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-25T14:25:49.190

您始终可以从发布的文件字段中获取扩展名。这并不完全准确，因为您可以将任何文件命名为“.pdf”。因此，在接受来自用户的文件时要小心，因为它们可能包含病毒或其他东西。

```
function the_field($fileFieldName) {
    if ($_FILES[$fileFieldName]['type'] == 'application/pdf') {
        echo '<a href="/download-the-file-link">Download</a>';
    } else {
        echo '<img src="/the-image-source" />';
    }
} 
```

更新：以下示例适用于 get_field() 返回文件路径的情况。

```
<?php $field = pathinfo(get_field('submit_image_or_pdf1'));?>
<?php if (isset($field['extension']) && $field['extenstion'] == 'pdf') { ?>
    <a href="<?php echo the_field('submit_image_or_pdf1'); ?>">View PDF</a>
<?php } else { ?>
    <img src="<?php echo the_field('submit_image_or_pdf1'); ?>" alt="<?php echo the_title(); ?> - <?php echo the_field('submit_submission_production_title'); ?>" /> 
<?php } ?>

<br /><br /><br /><br /> 
```

# actionscript-3 - AS3 - 隐藏 TileList 的背景

> ID：15617185
> 
> 赞同：0
> 
> 时间：2013-03-25T14:16:50.037
> 
> 标签：actionscript-3, flash, flash-builder, flash-cs6

![这张照片显示了问题](../Images/20b210bb5bb734ab7ea29eec0e57a235.png)

我正在使用带有自定义 ImageCell 类的 tileList，我想隐藏 M15 和 M19 按钮后面的灰色背景。我尝试在 ImageCell 类和 TileList 上设置 background.alpha 和 opaqueBackground ，但没有成功...

任何帮助，将不胜感激。

edit2：为清楚起见，添加 tilelist 设置和整个自定义单元格渲染器...

```
//TileList Settings in main class
tilelist.width = 235.53;
tilelist.height = 592;
tilelist.move(14, 118);
tilelist.columnWidth = 220.53;
tilelist.rowHeight = 53;
tilelist.visible = true;
tilelist.direction = ScrollBarDirection.VERTICAL;

tilelist.setStyle("cellRenderer", UserListRenderer);
tilelist.setStyle("contentBackgroundAlpha", 0);

//Custom CellRenderer
package {

    import fl.controls.listClasses.ICellRenderer;
    import fl.controls.listClasses.ImageCell;
    import fl.controls.TileList;
    import flash.text.*;

    public class UserListRenderer extends ImageCell implements ICellRenderer {

        public function UserListRenderer() {

            //inherit the variables from the parent
            super();

            //we don't want to stretch our images to fit the size of the box
            loader.scaleContent = true;

            //change the cursor as if this was a button
            useHandCursor = true;
        }

        override public function set data(data:Object):void
        {
            super.data = data;

            // Set the default skin to be invisible. This is a bit
            // easier than creating a new skin, if your goal is
            // to hide the white background.

            this.setStyle("contentBackgroundAlpha", 0);
        }

        /**
        * Now we override the function that draws the layout
        * so we can move the image beside the text
        **/
        override protected function drawLayout():void 
        {
            //adjust the icon for any existing padding
            var imagePadding:Number = getStyleValue("imagePadding") as Number;

            //offset the image in the box so it's not touching the top of it
            loader.move(1, 0);

            var h:Number = height-(imagePadding*2);*/

            var w:Number = width + (imagePadding*2);
            var h:Number = height + (imagePadding*2);

            if (loader.width != w && loader.height != h) {
                loader.setSize(w,h);
            }

            //re-draw the image
            loader.drawNow();

            //hide the original cellImage textField so we can display our new one later
            textField.visible = false;

            //adjust the background
            background.width = width;
            background.height = height;
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-05-06T13:58:39.417

对于 Flex：

```
list.setStyle("contentBackgroundAlpha", 0) 
```

或者如果应用程序对性能至关重要，请构建自定义皮肤

对于 Flash Pro：

双击舞台上的列表以更改当前皮肤，或创建新皮肤并分配给它

```
list.setStyle("skin", SkinName) //SkinName is a MovieClip in the library 
```

# at-command - 接收来自 AT 命令的不同响应

> ID：15617186
> 
> 赞同：0
> 
> 时间：2013-03-25T14:16:52.487
> 
> 标签：at-command

当我发送一个 AT 命令时，它将被执行。例如

```
ATD 123456789;
OK; 
```

但是我没有收到 WCNT:* 我在网上进行了搜索，我发现我应该发出这个命令：AT+WUSLMSK 来接收响应。当我成功时，我收到

```
AT+WUSLMSK
ERROR 
```

有人可以帮助我。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-26T14:30:47.280

您尚未指定正在使用的调制解调器/电话。你确定你的手机支持这个命令吗？你从`AT+WUSLMSK?`和得到什么回应`AT+WUSLMSK=?`。是在输出中列出的命令`AT+CLAC`（这是一个（可选）命令，应该列出所有支持的 AT 命令）。AT+WUSLMSK 命令不是标准命令，我找到[了描述它的文档](http://www.multitech.com/en_US/DOCUMENTS/Collateral/manuals/S000478C.pdf)，其中指出“+WCNT:”主动消息是针对`Call State conversation`.

较新版本的 27.007 包含一个`AT+CMCCS - Monitor of current calls`似乎有点相似的命令（但可能太新而无法支持？）。对于[索尼爱立信手机](http://developer.sonymobile.com/downloads/documentation/sony-ericsson-at-commands-online-reference/)，有`*CPII Call progress information`UR 代码（由 AT*CPI 启用）。也许也`AT+CIND`可以使用。

# c# - Android 套接字仅在本地网络中有效

> ID：15617187
> 
> 赞同：1
> 
> 时间：2013-03-25T14:16:57.503
> 
> 标签：c#, java, android, sockets, client-server

我最近遇到了一个非常荒谬的问题......我正在创建一个应用程序，它应该从 Android（当然是 Java）连接到服务器（用 C# 编写）

客户端（Java）的代码如下：

```
InetAddress serverAddr = InetAddress.getByName(SERVERIP); //My IP in a constant, it works with a local one...
Log.e("TCP Client", serverAddr.getHostAddress()); //Just to debug
Socket socket = new Socket(serverAddr, SERVERPORT); //Here I get an exception for the global IP 
```

奇怪的是昨天一切都还在工作......我没有改变任何关于端口转发的东西，端口仍然转发到我的电脑。我还在 Android Manifest 中设置了“INTERNET”权限。

服务器代码是用 C# 编写的，也非常简单，只是为了测试：

```
Console.WriteLine("Waitng for connection");
TcpClient client = Server.AcceptTcpClient();
NetworkStream ns = client.GetStream(); 
```

在这里，我永远不会得到 TCPClient 对象，因为之前客户端上的连接超时。没有任何东西通过服务器。

如上所述，这很奇怪，因为昨天似乎一切正常。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-25T14:25:57.917

可能是您昨天通过 Wifi 连接，而现在您正尝试通过 3G/GPRS 连接进行连接。因为如果您使用的是 Wifi 连接，那么您的服务器和 Android 可能在同一个网络上导致连接成功。

您是否确保服务器可以在网络外部访问，我的意思是公开的？

# node.js - 在 Node.JS 绑定中从 ZMQ 获取 Socket 选项

> ID：15617200
> 
> 赞同：1
> 
> 时间：2013-03-25T14:17:52.367
> 
> 标签：node.js, sockets, zeromq

我正在使用 Node.js 的 ZMQ 绑定，显然我无法访问套接字的选项。这是我为`PULL`and创建套接字的方法`PUSH`：

```
var sender = zmq.socket('push');
var receiver = zmq.socket('pull'); 
```

然后设置消息传递系统非常容易，但我想访问`_ioevents`但很难理解如何通过套接字本身访问该选项。我的目标是达到[此处](http://api.zeromq.org/master%3azmq-getsockopt#toc21)描述`ZMQ_POLLIN`的状态。套接字的内容如下：`ZMQ_POLLOUT``PULL`

```
{ type: 'pull',
  _zmq: { state: 0, onReady: [Function] },
  _outgoing: [],
  _shouldFlush: true,
  _events: { message: [Function], EINTR: [Function] } } 
```

这是没有帮助的。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-27T09:34:50.133

我意识到我问错对象了。创建包含`ZMQ_POLLIN`和`ZMQ_POLLOUT`状态的对象，`zmq`通过`var zmq = require('zmq');`该对象用于创建`sender`和`receiver`对象。

只需这样做，`zmq.ZMQ_POLLIN`我就可以访问标志。我仍然必须弄清楚他们的意思是什么。

# web-applications - Worklight Studio - 连接到控制台提供的移动 URL 时出现错误 http 405

> ID：15617204
> 
> 赞同：0
> 
> 时间：2013-03-25T14:18:05.177
> 
> 标签：web-applications, mobile, ibm-mobilefirst

我已经成功构建并部署了一个带有 android/mobile 连接到本地服务器的 web 应用程序。

5.0.5 没问题（android 预览、普通预览、webapp 预览等）。我已经升级到 5.0.6。

现在控制台给出的 URL（“获取移动 Web 应用程序的 URL”）不起作用，并向我抛出一个 http 错误 405“不支持获取方法”。

5.0.6（工作室）有问题还是我缺少新设置？感谢帮助

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-25T14:49:01.313

确保在构建升级项目之前删除 yourEclipseWorkspace\WorklightServerHome 文件夹。架构发生了变化，它也可能在这里中断。

根据我在 5.0.6 中使用 Mobile Web 环境在新应用程序中进行的测试，没有此类错误。

# python - python的matplotlib.pyplot中3D参数曲线的线条颜色

> ID：15617207
> 
> 赞同：21
> 
> 时间：2013-03-25T14:18:14.493
> 
> 标签：python, matplotlib

我已经在谷歌上搜索了一段时间但没有成功……也许我的关键字很糟糕。无论如何，假设我有三个`numpy.ndarray`相同长度的 1D s，我想将它们绘制为 3D 轨迹。此外，我希望能够执行以下任一操作：

1.  改变线的颜色作为函数`z`
2.  根据时间更改线条的颜色（即数组中的索引）

[这个演示](http://matplotlib.org/examples/mplot3d/lines3d_demo.html)有一个制作这样一条曲线的例子：

```
import matplotlib as mpl
from mpl_toolkits.mplot3d import Axes3D
import numpy as np
import matplotlib.pyplot as plt

fig = plt.figure()
ax = fig.gca(projection='3d')
theta = np.linspace(-4 * np.pi, 4 * np.pi, 100)
z = np.linspace(-2, 2, 100)
r = z**2 + 1
x = r * np.sin(theta)
y = r * np.cos(theta)
ax.plot(x, y, z)

plt.show() 
```

![在此处输入图像描述](../Images/5e3b1f2c31ee12d3115c7489cd28c71a.png)

但是我如何实现`1`or `2`？欢迎仅解决其中一个问题！提前致谢。

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2013-03-25T14:34:52.750

与普通的 2d 绘图一样，您不能沿着普通线使用渐变颜色。但是，您可以这样做`scatter`：

```
import matplotlib as mpl
from mpl_toolkits.mplot3d import Axes3D
import numpy as np
import matplotlib.pyplot as plt

fig = plt.figure()
ax = fig.gca(projection='3d')
theta = np.linspace(-4 * np.pi, 4 * np.pi, 100)
z = np.linspace(-2, 2, 100)
r = z**2 + 1
x = r * np.sin(theta)
y = r * np.cos(theta)

#1 colored by value of `z`
ax.scatter(x, y, z, c = plt.cm.jet(z/max(z))) 

#2 colored by index (same in this example since z is a linspace too)
N = len(z)
ax.scatter(x, y, z, c = plt.cm.jet(np.linspace(0,1,N)))

plt.show() 
```

* * *

我喜欢[@Junuxx 的](https://stackoverflow.com/users/1404505/junuxx) [hack](https://stackoverflow.com/a/15617860/1730674)，所以我在这里应用了它：

```
for i in xrange(N-1):
    ax.plot(x[i:i+2], y[i:i+2], z[i:i+2], color=plt.cm.jet(255*i/N)) 
```

![2-按索引着色](../Images/b8f6dcf23ec342a935072c8e57a2a949.png) ![2色线按索引](../Images/1b14f1270fcae2d5353db51e99a92a04.png)

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2013-03-25T14:48:06.260

您可以分别绘制每条线段，如下所示。这只是循环了 6 种预定义颜色，因为 @askewchan 的回答已经很好地演示了如何使用颜色图。

```
cols = 'rgbcmy'

for i in range(len(x)-1):
    ax.plot(x[i:i+2], y[i:i+2], z[i:i+2], color=cols[i%6]) 
```

![在此处输入图像描述](../Images/848a573545fbf67d0e187298a3f38dd2.png)

# java - 带有图像的 Android HTML.fromHTML()？

> ID：15617210
> 
> 赞同：23
> 
> 时间：2013-03-25T14:18:19.370
> 
> 标签：java, android

我的 Android 应用程序接收包含图像的 HTML 内容。是否可以`fromHTML()`在接收到的 HTML 字符串中显示图像？

如果没有，我如何检索`HTML`字符串中的图像并将它们转换为 TextView 图像？

谢谢

* * *

## 回答 #1

> 赞同：57
> 
> 时间：2013-03-25T14:23:46.713

**URLDrawable.java**

```
public class URLDrawable extends BitmapDrawable {
    // the drawable that you need to set, you could set the initial drawing
    // with the loading image if you need to
    protected Drawable drawable;

    @Override
    public void draw(Canvas canvas) {
        // override the draw to facilitate refresh function later
        if(drawable != null) {
            drawable.draw(canvas);
        }
    }
} 
```

**URLImageParser.java**

```
public class URLImageParser implements ImageGetter {
    Context c;
    View container;

    /***
     * Construct the URLImageParser which will execute AsyncTask and refresh the container
     * @param t
     * @param c
     */
    public URLImageParser(View t, Context c) {
        this.c = c;
        this.container = t;
    }

    public Drawable getDrawable(String source) {
        URLDrawable urlDrawable = new URLDrawable();

        // get the actual source
        ImageGetterAsyncTask asyncTask = 
            new ImageGetterAsyncTask( urlDrawable);

        asyncTask.execute(source);

        // return reference to URLDrawable where I will change with actual image from
        // the src tag
        return urlDrawable;
    }

    public class ImageGetterAsyncTask extends AsyncTask<String, Void, Drawable>  {
        URLDrawable urlDrawable;

        public ImageGetterAsyncTask(URLDrawable d) {
            this.urlDrawable = d;
        }

        @Override
        protected Drawable doInBackground(String... params) {
            String source = params[0];
            return fetchDrawable(source);
        }

        @Override
        protected void onPostExecute(Drawable result) {
            // set the correct bound according to the result from HTTP call
            urlDrawable.setBounds(0, 0, 0 + result.getIntrinsicWidth(), 0 
                    + result.getIntrinsicHeight()); 

            // change the reference of the current drawable to the result
            // from the HTTP call
            urlDrawable.drawable = result;

            // redraw the image by invalidating the container
            URLImageParser.this.container.invalidate();
        }

        /***
         * Get the Drawable from URL
         * @param urlString
         * @return
         */
        public Drawable fetchDrawable(String urlString) {
            try {
                InputStream is = fetch(urlString);
                Drawable drawable = Drawable.createFromStream(is, "src");
                drawable.setBounds(0, 0, 0 + drawable.getIntrinsicWidth(), 0 
                        + drawable.getIntrinsicHeight()); 
                return drawable;
            } catch (Exception e) {
                return null;
            } 
        }

        private InputStream fetch(String urlString) throws MalformedURLException, IOException {
            DefaultHttpClient httpClient = new DefaultHttpClient();
            HttpGet request = new HttpGet(urlString);
            HttpResponse response = httpClient.execute(request);
            return response.getEntity().getContent();
        }
    }
} 
```

**ImageGetter 的使用**

```
String html = "Hello " +
"<img src='http://www.gravatar.com/avatar/" + 
"f9dd8b16d54f483f22c0b7a7e3d840f9?s=32&d=identicon&r=PG'/>" +
" This is a test " +
"<img src='http://www.gravatar.com/avatar/a9317e7f0a78bb10a980cadd9dd035c9?s=32&d=identicon&r=PG'/>";

this.textView = (TextView)this.findViewById(R.id.textview);
URLImageParser p = new URLImageParser(textView, this);
Spanned htmlSpan = Html.fromHtml(html, p, null);
textView.setText(htmlSpan); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-11-04T06:05:28.427

注意：请参考 Talha 给出的答案，我将其作为单独的答案发布，以指出问题的重要修复。

修复图像重叠（如果有多个图像）问题并修复图像和文本重叠

上述问题的解决方法：请调用**container.setText(container.getText());** 在**onPostExecute**结束时避免图像重叠。

# wpf - 虚拟化画布中的连续背景网格？

> ID：15617217
> 
> 赞同：2
> 
> 时间：2013-03-25T14:18:32.383
> 
> 标签：wpf, user-interface, wpf-4.0, ui-virtualization

在我的 WPF 应用程序中，我有 ItemsControl，它具有[ZoomableCanvas](http://blogs.msdn.com/b/kaelr/archive/2010/08/11/zoomableapplication2-a-million-items.aspx)作为面板，它为 Canvas 提供虚拟化机制。**这是完美的工作。**此 Canvas 需要具有类似背景的图形。当我使用下面的 xaml 时，**会生成网格，但仅限于视口的范围**（在加载时）。因此，当滚动时，您会看到背景网格被垂直和水平剪切。在 performant-virtualized-wpf-canvas 中，这是通过将子 Visuals 添加到画布作为背景来处理的。

```
<ListBox.ItemsPanel>
                <ItemsPanelTemplate>
                    <ZoomableCanvas x:Name="ZCanvas" Loaded="ZoomableCanvas_Loaded" >
                        <ZoomableCanvas.Background>
                            <DrawingBrush TileMode="Tile" Stretch="Fill"  
                                          Viewport="0 0 100 60" ViewportUnits="Absolute" 
                                          ViewboxUnits="Absolute" >
                                <DrawingBrush.Drawing>
                                    <GeometryDrawing Geometry="M0,0 L0,1 0.03,1 0.03,0.03 1,0.03 1,0 Z" Brush="Gray" />
                                </DrawingBrush.Drawing>
                            </DrawingBrush>
                        </ZoomableCanvas.Background>
                    </ZoomableCanvas>
                </ItemsPanelTemplate>
            </ListBox.ItemsPanel> 
```

详细说明问题：请看这些图片：

[![在此处输入图像描述](../Images/b698d24d81cc6ee16ef095f08e43071c.png)](https://i.stack.imgur.com/zx0hl.png)

On Load --- 背景网格是可见的，并且孩子的左边离 0,0 很远

On Scrolling Right and back - 背景网格被剪裁，孩子似乎从 Canvas 中的最左边开始

我们怎样才能有一个 Grid 背景，它延伸了 ZoomableCanvas 的整个宽度？我们如何解决 On Scroll 问题？

真诚感谢任何帮助/提示。

# sql - 插入查询错误（无效字符）

> ID：15617223
> 
> 赞同：0
> 
> 时间：2013-03-25T14:18:51.700
> 
> 标签：sql, oracle

这个查询

```
insert into table-name(CONTRACT_TYPE,CATEGORY) ( 
select 'GOLDCHOICE','C-CLASS' 
from tablename2 
where model_no = '1'and part_number not in (
  select part_number from tablename3 
  where contract_type ='GOLDCHOICE' 
  and category = 'C-CLASS' 
  and model_number = '1')
); 
```

在 Oracle(TOAD) 中成功运行。

但是，当我从 asp.net（连接到 oracle）运行它时，它正在抛出

> ORA-00911: 无效字符

但没有`'semicolon(;)'`它运行良好。

这可能是什么原因造成的？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-25T14:23:28.960

尝试`;`从查询末尾删除。一些提供者——比如`ODP`——不喜欢`;`查询末尾的。

# box2d - 逼真的 jumping box2d - 变量配置

> ID：15617224
> 
> 赞同：0
> 
> 时间：2013-03-25T14:18:55.887
> 
> 标签：box2d, physics, libgdx, game-physics, jbox2d

我仍在研究我的 Jump 'n' Run 并且已经解决了“我可以跳跃”的问题。

我现在的问题是，我应该如何配置*Gravity*、*Timesteps*、*Fixturesize*、*应用的 Impulse*和*Fixturedensity*以获得最真实的结果？
Fixturesize 现在是 230x140 并且无法更改，因为我需要 pixelexact 大小进行调试。可以改变的是：

**重力**(10),

**时间步长（ Deltatime** *4）；

**应用脉冲**（1000000）；

**夹具密度（ 0,002**）；

为什么我需要 1 (!) 百万的脉冲来移动当前 65 公斤的质量？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-27T17:40:54.343

请不要使用 pixelexact 大小，这会使引擎性能不佳。它以 mks（米-千克-秒）为单位。230x140 米的物体有点大。物体速度也被限制在 200 m/s 左右，所以你不会很快移动。如果您在转换方面需要帮助，请查看公共包中提供的 OOBViewportTransform 类。

冲量和密度只与其他物体有关。所以你可能想先创建一个关卡，然后测试你的角色如何交互。从 1 开始的密度通常很好。你通常不想让任何一个太高。

# facebook - 如何将 Facebook 图表搜索限制为仅限城市

> ID：15617225
> 
> 赞同：1
> 
> 时间：2013-03-25T14:18:57.323
> 
> 标签：facebook, facebook-graph-api, facebook-javascript-sdk

我们有一个使用 Facebook 连接并通过 JS 和 http 使用 FB 图的网络应用程序。我们希望用户能够在他的时间轴上发布包含城市精确位置图的帖子。Facebook Docs[在这里](https://developers.facebook.com/docs/reference/api/user/#posts)说，对于创建帖子的“地点”参数，我需要编写 Facebook 页面 ID，我希望用户从列表中选择它（否则我将如何正确获取页面 ID？...）所以例如伦敦，我应该使用 - [210582665626133](https://www.facebook.com/pages/London-United-Kingdom/210582665626133)，所以我假设我需要使用 -graph.facebook.com/search?q=london&type=place 来获取位置的 json 查找。这让我想到了我的问题 - 如何将搜索结果限制为仅显示城市？如果没有办法将其指定为图形调用上的参数，并且假设我必须在客户端上过滤这些参数，那么从无关紧要的混乱中发现城市的类别或任何其他方法是什么地方？干杯:)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-25T14:38:42.413

Facebook 位置的信息非常随机。大多数类别都是用户生成的，所以你永远不知道你会得到什么。

例如，然后我在上面运行您的搜索`210582665626133`，即使限制为 500，我也从未在结果中返回 id。

就我个人而言，如果我接近这个，我会使用[Factual Places API](http://www.factual.com/data-apis/places)来查找相关地点，然后使用[Factual Crosswalk API](http://www.factual.com/data-apis/places/crosswalk)来查找匹配的 Facebook ID，然后才开始查询 Facebook。

# java - Java小程序闪烁双缓冲区

> ID：15617234
> 
> 赞同：1
> 
> 时间：2013-03-25T14:19:23.517
> 
> 标签：java, applet

我正在制作一个横向卷轴游戏。为了防止在我的游戏中闪烁，我开始使用后缓冲来获得更流畅的图形。它解决了大部分问题，但是，如果我移动角色足够长的时间，屏幕就会开始闪烁。[我在这里读到了这个问题，](https://stackoverflow.com/questions/7117705/despite-double-buffering-the-ticker-still-flickers)但没有详细说明如何解决这个垂直消隐间隔。我知道它实际上并不是“闪烁”，而是随着新的涂在旧的上而更加“撕裂”。有什么办法可以避免这种“撕裂”？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-25T14:41:17.573

我会在评论中回答，但有太多的细节。下面的代码几乎完全来自一个小程序，在这个小程序中我必须像现在一样限制 FPS（除了它是在 mouseMove 上而不是 keyPressed 上）。

```
private long lastDrawTime = 0;

public void keyPressed(KeyEvent e) {
    if (Calendar.getInstance().getTimeInMillis() - lastDrawTime < 20) return;
    //do whatever needs to be done before redrawing
    draw();
    lastDrawTime = Calendar.getInstance().getTimeInMillis();
} 
```

这里发生的事情是有一个实例变量`lastDrawTime`存储上次重绘发生的时间。此变量与在任何绘图发生之前触发的 keyPressed 事件的当前时间进行比较。如果时间差小于允许的间隔，在本例中为 20 毫秒，或每秒 50 帧，则函数返回并且不进行绘制或更新。但是，如果经过了足够的时间，则所有正常的事情都已完成，并且当前时间存储在变量中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-25T14:42:20.853

您需要实现独立于可变 FPS 的恒定游戏速度。[本文](http://www.koonsolo.com/news/dewitters-gameloop/ "本文")详细介绍了如何执行此操作。

# selenium - 如何告诉 Firefox 在 Selenium webdriver 中的特定版本上运行？

> ID：15617235
> 
> 赞同：3
> 
> 时间：2013-03-25T14:19:28.767
> 
> 标签：selenium, webdriver

我想通过提及各自的版本来在我的机器上安装的不同版本的 Firefox 上运行我的测试，我阅读了这个链接[`https://stackoverflow.com/questions/12596097/how-to-set-particular-firefox-version-in-selenium-webdriver`](https://stackoverflow.com/questions/12596097/how-to-set-particular-firefox-version-in-selenium-webdriver)，但我不想手动创建配置文件并传递相同的配置文件，它们在运行时是否有任何方式来决定哪个版本选择？？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-25T14:30:29.433

`FirefoxBinary`在设置 WebDriver 时尝试使用类。

例如：我假设您安装了 FF 15`C:\testing\ff15\firefox.exe`

然后，在设置 webDriver 之前执行以下操作：

```
 File pathToBinary = new File("C:\\testing\\ff15\\firefox.exe");
 FirefoxBinary binary = new FirefoxBinary(pathToBinary);
 FirefoxDriver driver = new FirefoxDriver(binary, new FirefoxProfile()); 
```

我从未尝试过，但我认为它应该可以工作

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-07-07T02:40:46.353

对于那些使用 python 的用户，请使用**FirefoxBinary**

使用 FirefoxBinary 指定 Firefox 二进制文件的路径：

```
from selenium import webdriver
from selenium.webdriver.firefox.firefox_binary import FirefoxBinary

browser = webdriver.Firefox(firefox_binary=FirefoxBinary('path goes here')) 
```

希望它可以帮助某人:)

# python - 在系统范围或 cron 范围内抑制 python 警告

> ID：15617242
> 
> 赞同：4
> 
> 时间：2013-03-25T14:19:53.860
> 
> 标签：python, cron

我有很多生成的 python 脚本

```
/home/intranet/public_html/intranet/bin/utils.py:172: DeprecationWarning: os.popen4 is deprecated.  Use the subprocess module.
  fin, fout = os.popen4(cmd) 
```

和其他警告。

有没有办法在系统范围或 cron 范围内隐藏它们？

谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-25T14:21:12.203

所有其他警告都是`DeprecationWarning`吗？像这样运行脚本：

```
python -W ignore::DeprecationWarning thescript.py 
```

如果要忽略所有警告，请使用

```
python -W ignore thescript.py 
```

要忽略系统或 cron 范围内的警告，请设置 env 变量`PYTHONWARNINGS`：

```
PYTHONWARNINGS=ignore::DeprecationWarning
# or PYTHONWARNINGS=ignore 
```

文档：[-W 选项](http://docs.python.org/release/2.7/using/cmdline.html#cmdoption-W)和[PYTHONWARNINGS](http://docs.python.org/release/2.7/using/cmdline.html#envvar-PYTHONWARNINGS)。

你用的是什么python版本？在 2.7 中默认应忽略 DeprecationWarning。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-25T14:36:10.260

如果您不想在通过 cron 运行程序时有输出，您只需要`>/dev/null 2>&1`在执行行的末尾添加即可。这会将您的常规输出重定向到 null，但也会重定向错误。

# c# - Automapper，通过链接关联映射对象？

> ID：15617250
> 
> 赞同：1
> 
> 时间：2013-03-25T14:20:11.750
> 
> 标签：c#, automapper

可以说我有这些模型

```
 public class Mouse
    {
        public string Cheese { get; set; }
    }

    public class Cat
    {
        public string Hairball { get; set; }
    }

    public class Dog
    {
        public string ChewyToy { get; set; }
    } 
```

我将鼠标映射到猫，然后将猫映射到狗：

```
 Mapper.CreateMap<Mouse, Cat>().ForMember(m => m.Hairball, o => o.MapFrom(src => src.Cheese));
    Mapper.CreateMap<Cat, Dog>().ForMember(m => m.ChewyToy, o => o.MapFrom(src => src.Hairball)); 
```

通过扩展，鼠标也应该映射到狗，对吧？当我尝试在两者之间进行映射时：

```
 var mouse = new Mouse() { Cheese = "Eat me" };

    Dog dog = Mapper.Map<Mouse, Dog>(mouse); 
```

我得到一个例外：

> 尝试将 App_Start.MapConfig+Mouse 映射到 App_Start.MapConfig+Dog。引发了“AutoMapper.AutoMapperMappingException”类型的异常。

如何在不显式创建鼠标到狗之间的地图的情况下做到这一点？这是一个更大问题的简单示例。如果它们支持这种行为，我也愿意切换框架，例如 Value Injector、Glue 等。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-25T15:00:22.147

> 如何在不显式创建鼠标到狗之间的地图的情况下做到这一点？

答案很简单：*你不能*。

Automapper 具有用于映射对象的非常简单的逻辑。添加新映射时：

```
Mapper.CreateMap<Mouse, Cat>(); 
```

新`TypeMap`创建并添加到类型映射列表中。是的，有简单的清单。每个`TypeMap`都有两个属性：`DestinationType`和`SourceType`。中间什么都没有。当您尝试映射某个对象时，首先简单地搜索列表，`TypeMap`它具有与映射中指定的**完全相同的源和目标类型。**它通过以下方法完成（[ConfigurationStore](https://github.com/AutoMapper/AutoMapper/blob/develop/src/AutoMapper/ConfigurationStore.cs)类负责保存配置的映射）：

```
TypeMap FindExplicitlyDefinedTypeMap(Type sourceType, Type destinationType)
{
    return this._typeMaps.FirstOrDefault<TypeMap>(x => 
               ((x.DestinationType == destinationType) && 
                (x.SourceType == sourceType)));
} 
```

因此，对于您的示例，列表中将有两个`TypeMap`对象，当然它们都不匹配`DestinationType`等于`Dog`和`SourceType`等于的条件`Mouse`。

# powershell-2.0 - 如何使用powershell比较十六进制值

> ID：15617251
> 
> 赞同：2
> 
> 时间：2013-03-25T14:20:12.943
> 
> 标签：powershell-2.0

如何使用 powershell 比较十六进制值？

```
22
32
44
56
de
4f
3f 
```

这些值在一个文件中，我需要比较它们以找到其中的最大值。这些是十六进制值。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-25T14:30:40.763

这是一种方式：

```
$n = 22,32,44,56,"de","4f","3f" # or $n = get-content myfilewithHEX.txt 
[Convert]::ToString( ($n | % { [int]"0x$_" } | Measure-Object -Maximum).maximum , 16) 
```

这返回`de`

另一种方式：

```
 ( $n | sort { [int]"0x$_" } ) | select -Last 1 
```

# php - PHP 表单欺骗和验证

> ID：15617252
> 
> 赞同：2
> 
> 时间：2013-03-25T14:20:13.723
> 
> 标签：php, forms, validation, sanitization, spoofing

我一直在阅读有关表单欺骗的内容，只是无法理解为什么当我们可以确保正确验证传递的值时防止它如此重要？也许我在这里遗漏了一些东西，但这里有一个例子：

example.org/form.html：

```
<form method="post" action="post.php">
    <input type="text" name="content" value="something">
    <input type="submit" name="post" value="Post">
</form> 
```

example.org/post.php：

```
if (isset($_POST['content']))
{
    $content = filter_var($_POST['content'], FILTER_SANITIZE_STRING);
    //use $content as a sanitized variable, pass it to a database, etc.
} 
```

例如，恶意用户可以简单地将 form.html 中的输入字段更改为`<textarea name="content">something here</textarea>`，但这对任何事情有什么影响呢？我们确保无论如何都会从 post.php 脚本中的字符串中删除标签。

所以这是我的问题：是否可以安全地假设，通过适当的输入验证，PHP 表单欺骗在安全性方面应该几乎没有危险？恶意用户还能通过`name="content"`属性（除了 textarea、select 和所有其他标签）向脚本传递什么可以有效地削弱数据库或其他东西？因为如果他们无能为力，为什么还要使用代币？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-25T14:22:47.467

危险在于，如果您`$_POST`在 SQL 查询（SQL 注入）之类的内容中使用任何内容，或者将输入直接放入`exec(...)`调用中（无论如何都不是好的做法）等。只要您正在清理输入（验证 /擦洗）没有危险。关键规则是：

> 永远不要相信用户的输入。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-25T14:30:37.293

特定的表单授予多个攻击向量。

1）sql注入攻击

未经验证的数据可以包含 sql 代码，它可以在整个数据库中修改数据、删除数据或读取数据（取决于应用程序）。

2）跨站请求伪造（XSRF）

如果您不确定，您收到的数据实际上来自您的站点（即带有会话持久令牌），其他站点可以复制您的网页并充当所有请求的代理。

这样做的原因是，他们可以制作传输数据的副本。例如，这可以用于钓鱼。

3）跨站脚本注入

即使数据本身对您的数据库没有损害并且来自您的网站，输入也可以包含 javascript，每次内容显示在您的网站中时都会执行这些内容。（通常可以使用 alert(1) 或类似方法进行测试）。

这可以通过剥离 javascript 来防止。

# c# - SslStream 独立线程

> ID：15617256
> 
> 赞同：1
> 
> 时间：2013-03-25T14:20:24.817
> 
> 标签：c#, multithreading, sslstream

我正在尝试在屏幕上显示来自 ssl 流（来自网站）的任何数据。因为我不知道数据什么时候到达，所以我使用了另一个线程，它一直从流中读取，直到读取字节。这非常有效，但是，我的 CPU 使用率跃升至 25% 并保持在那里（最大使用率为 1 个线程，我的 PC 有 4 个线程）。虽然这确实有点道理，因为线程卡在了一个while循环中，但我没想到线程类的一个实例会消耗我的CPU的整个线程（我可以发誓这在使用简单的客户端时不会发生/服务器应用程序）。

一旦连接初始化，线程就开始运行，用户可以随时向网站发送数据，并且应用程序应该打印出响应。什么是替代解决方案？我应该放弃 SslStream 并开始使用其他东西吗？

这是在这个单独的线程上运行的代码：

```
 void ReadDataAsync(Object obj) {
        byte[] buffer = new byte[65536]; //65536, make sure all bytes can be
                                         //from a single packet
        int bytesRead = -1;

        while (true) {
            //It makes sense for sslStream.Read to block until bytes have been
            //read, but it doesn't.  Which is why I'm checking if bytesRead!=0

            bytesRead = sslStream.Read(buffer, 0, 65536);

            if (bytesRead != 0) {
                Console.WriteLine(Encoding.UTF8.GetString(buffer, 0, bytesRead));
                buffer = new byte[65536];
            }
        }
    } 
```

谢谢大家，感谢您的帮助

**编辑：**
我尝试改用 BeginRead 和 EndRead，正如“gt”所建议的那样。为此，每当用户发送请求时，我都会使用 BeginRead。收到所有数据后，我将它们打印在屏幕上。这似乎工作正常，但我担心将来是否会有任何问题。数据包有没有可能弄乱？例如，是否有可能 EndRead 在第一个数据包的末尾没有返回 0 并且它继续读取第二个数据包？如果可能的话，我将如何继续解决这个问题？接收到的数据只是http层的body，所以无法事先访问IP层知道包的长度。

```
 public void SendData(byte[] message) {
        sslStream.Write(message);
        sslStream.Flush();

        //Start reading for response (if not already reading)
        if (sslStream.CanRead) {
            sslStream.BeginRead(buffer, 0, BufferSize, ReadData, null);
        }
    }

    void ReadData(IAsyncResult ar) {
        int bytesRead = sslStream.EndRead(ar);

        if (bytesRead > 0) {
            //data may be on their way so start reading again
            message.Append(Encoding.UTF8.GetString(buffer, 0, bytesRead));
            sslStream.BeginRead(buffer, 0, BufferSize, ReadData, null);
            Console.WriteLine("Data received but more may be on their way...");
        } else {
            //All data arrived (Checking if length is more than 0 since all the
            //data may had already arrived in the previous check (above)
            if (message.ToString().Length > 0) {
                Console.WriteLine(message.ToString());
                //Clear StringBuilder and reset buffer.
                message.Clear();
                buffer = new byte[BufferSize];
            }
        }
    } 
```

再次感谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-25T14:57:22.920

看到`while(true)`通常是一个不好的迹象......如果您的代码进入没有结束条件的“紧密”循环，它将继续循环并消耗所有可用资源。

仔细检查“if”条件是否符合您的预期。例如，如果流在多个部分中被读取会发生什么？（例如 32768 的两部分）。这是完全可能的。

一旦你对这种行为感到满意，你可以强制线程在尝试下一个之前休眠一段时间`Read`，使用`Thread.Sleep(100)`.

或者，尝试查看异步 IO，使用[`BeginRead`](http://msdn.microsoft.com/en-GB/library/system.net.security.sslstream.beginread.aspx). 请参阅[MSDN 上的此示例](http://msdn.microsoft.com/en-us/library/bew39x2a.aspx)。

* * *

编辑，回答问题的第 2 部分：

我怀疑如果某事可能出错，它就会出错，所以要防御性地编码！下一个问题的解决方案是缓冲从流中读取的所有数据。然后让另一个线程尝试从缓冲区中读取整个数据包。不要忘记使用锁来防止同时读取/写入缓冲区。

为此编写单元测试也是一个好主意，以涵盖“碎片化”行为（以及正常行为）。

或者，您也许可以研究为您处理这些事情的更高级别的协议。我经常看到提到的是 Google 的[Protocol Buffers](https://developers.google.com/protocol-buffers/)。

# javascript - 获取鼠标相对于放置的 div 的位置

> ID：15617257
> 
> 赞同：0
> 
> 时间：2013-03-25T14:20:28.420
> 
> 标签：javascript, jquery

我可以通过以下方式获得鼠标的绝对位置：

```
$(document).mousemove(function(e) {
        window.x = e.pageX;
        window.y = e.pageY;
    }); 
```

如何获得相对于特定 div 的这个位置？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-25T14:22:50.200

您可以使用 div 的偏移量：

```
$(document).mousemove(function(e) {
    var offset = $(yourdiv).offset();
    window.x = e.pageX - offset.left;
    window.y = e.pageY - offset.top;
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-25T14:23:08.217

只需从 div 的 offsetLeft 和 offsetTop 中减去 clientX 和 ClientY

# java - Jersey 客户端无法连接到远程机器（502 Bad Gateway）

> ID：15617258
> 
> 赞同：0
> 
> 时间：2013-03-25T14:20:31.320
> 
> 标签：java, post, curl, jersey, http-post

我无法通过我敲开的一个小球衣客户端测试连接到我在远程机器上运行的服务。

我可以像这样使用 cURL 成功连接和发布：

`curl -X POST -T test.txt -H "Content-Type: application/octet-stream" http://remote-machine:11181/data?start=123`

我设置的服务很`remote-machine`乐意接受这一点并按预期工作，但是当通过我的球衣客户端实现处理完全相同的 URI 时，我收到以下异常：

```
com.sun.jersey.api.client.UniformInterfaceException: POST http://remote-machine:11181/data?start=123 returned a response status of 502 Bad Gateway
    at com.sun.jersey.api.client.WebResource.voidHandle(WebResource.java:707)
    at com.sun.jersey.api.client.WebResource.access$400(WebResource.java:74)
    at com.sun.jersey.api.client.WebResource$Builder.post(WebResource.java:553) 
```

我的泽西岛客户如下：

```
public static void main(String[] args) throws IOException {
    if (args.length < 2) {
        System.err.println("Usage: " + TestJerseyClient.class.getName() + " <uri> <input file>");
        System.exit(-1);
    }

    File file = new File(args[1]);
    if (!file.exists()) {
        System.err.println("File not found: " + file.getAbsolutePath());
        System.exit(-2);
    }

    URI uri = URI.create(args[0]);
    Client client = new Client();
    client.setChunkedEncodingSize(16 * 1024);

    FileInputStream stream = new FileInputStream(file);
    try {
        System.out.println("Sending " + file.getPath());
        client.resource(uri).type(MediaType.APPLICATION_OCTET_STREAM).post(stream);
        System.out.println("Done");
    } catch (Exception e) {
        e.printStackTrace();
    } finally {
        Closeables.closeQuietly(stream);
    }
} 
```

关于为什么我的球衣客户端在获得与 cURL 相同的 URI 后，为什么会收到这些 502 Bad Gateway 错误的任何帮助，我们将不胜感激。

（我想这可能是一个代理问题，但至于让球衣像 cURL 那样被他们选中，我不知道。）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-01T17:01:48.597

我设法通过使用`ApacheHttpClient`而不是标准 Jersey来解决这个问题`Client`。不完全确定表面之下的差异，但似乎它似乎`ApacheHttpClient`比标准的 Jersey 客户端更好地接受任何配置和代理，这很可能是它被创建的原因之一。

我必须改变的是：

```
Client client = new Client(); 
```

至

```
Client client = new ApacheHttpClient(); 
```

当然，相应地更新我的依赖项等。

# java - JTable 未更新

> ID：15617261
> 
> 赞同：0
> 
> 时间：2013-03-25T14:20:39.227
> 
> 标签：java, sql, swing, jdbc, jtable

我正在尝试通过在 java swing 中使用表来创建一个表并向 sql 添加值。但是在 for 循环中，我根本没有增加。我认为这是因为。`while(rs2.next())`当我将其置于 for 循环之外时，我收到此错误：“在结果集开始之前”。我需要帮助！

**编辑：上面的那些问题已经解决，但我现在有新问题。JTable 似乎没有更新自己。当我在组合框中选择表名时，表应用程序崩溃并给出数组索引超出范围异常。**

我的代码在这里：

```
public class DBC extends JFrame{

static String tablo;
static JTextField tf = new JTextField(20);
static int columnCount;
static JPanel tfPanel = new JPanel();
static String[] sutunlar;
static JLabel sutunLabel;
static JPanel sutunPanel = new JPanel(new BorderLayout());
static JTable table;
static JScrollPane scrollPane;

public static void main(String[] args) throws Exception {

    Class.forName("com.mysql.jdbc.Driver");
    Connection connect = DriverManager.getConnection("jdbc:mysql://localhost:3306/project"
              ,"root","123456789");

    final Statement statement = connect.createStatement();

    JLabel tabloSec = new JLabel("Tablo Seçin:");
    final JComboBox<String> tablolar = new JComboBox<String>();
    final DatabaseMetaData md = connect.getMetaData();
    final ResultSet rs = md.getTables(null, null, "%", null);

    while (rs.next()) {
        tablolar.addItem(rs.getString(3));
    }

    tablolar.addActionListener(new ActionListener(){

        @Override
        public void actionPerformed(ActionEvent arg0) {

            tablo = tablolar.getSelectedItem().toString();

            try {

                 ResultSet rs2 = statement.executeQuery("SELECT * FROM "+tablo);
                 ResultSetMetaData rsmd = rs2.getMetaData();
                 columnCount = rsmd.getColumnCount();

                 sutunlar = new String[columnCount];
                 table = new JTable(1,columnCount);
                 Object columnNames[] = new Object[columnCount];
                 Object rowData[][] = {{""}};

                     for(int i=0;i<columnCount;i++){

                         sutunlar[i] = rsmd.getColumnLabel(i+1);
                         columnNames[i] = sutunlar[i];

                         }

                     table = new JTable(rowData, columnNames);
                     table.repaint();
                     scrollPane = new JScrollPane(table);
                     sutunPanel.add(scrollPane);
                     sutunPanel.revalidate();

            } catch (SQLException e) {
                // TODO Auto-generated catch block
                e.printStackTrace();
            }
        }
    });

    JButton ekle = new JButton("Ekle");
    ekle.addActionListener(new ActionListener(){

        @Override
        public void actionPerformed(ActionEvent e) {

            try {
                switch(tablo){
                case "department":

                    statement.executeUpdate("INSERT INTO department(Name,Location) VALUES('"+tf.getText()+"')");
                case "employee":

                    statement.executeUpdate("INSERT INTO employee(Id,FirstName,LastName,Sex,Address,Email,Salary,BirthDate,JoinDate) VALUES('"+tf.getText()+"')");
                case "engineer":

                    statement.executeUpdate("INSERT INTO engineer(EngineerType) VALUES('"+tf.getText()+"')");
                case "manager":

                    statement.executeUpdate("INSERT INTO manager(Department) VALUES('"+tf.getText()+"')");
                case "project":

                    statement.executeUpdate("INSERT INTO project(Name,Number,Value) VALUES('"+tf.getText()+"')");
                case "secretary":

                    statement.executeUpdate("INSERT INTO secretary(TypingSpeed) VALUES('"+tf.getText()+"')");
                }

            } catch (SQLException e1) {
                // TODO Auto-generated catch block
                e1.printStackTrace();
            }
        }
    });

    JButton cik = new JButton("Çık");
    cik.addActionListener(new ActionListener() {

        @Override
        public void actionPerformed(ActionEvent e) {

            System.exit(0);
        }
    });

    JPanel panel = new JPanel(new FlowLayout());

    panel.add(tabloSec);
    panel.add(tablolar);
    panel.add(sutunPanel);
    panel.revalidate();
    panel.add(ekle);
    panel.add(cik);

    JFrame frame = new JFrame("Deneme");
    frame.setSize(600,600);
    frame.setLocationRelativeTo(null);
    frame.add(panel);
    frame.setVisible(true);
  }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-25T15:36:26.010

我认为你混淆了一些东西。当你定义

```
columnCount = rsmd.getColumnCount(); 
```

看来您希望`columnCount`保存表格的列数；但这种情况并非如此。这是元数据提供的列数。

如果要获取所选表的列的名称，请将其放在您的`try/catch`块中：

```
ResultSet rs2 = md.getColumns(null, null, tablo, null);

Set<String> columnNames = new HashSet<String>();
while (rs2.next()) {
  columnNames.add(rs2.getString(4));
}

Object[][] rowData = { null };
table = new JTable({ null }, columnNames.toArray());
scrollPane = new JScrollPane(table);
sutunPanel.add(scrollPane); 
```

你应该真正考虑一下你对静态字段的使用；）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-25T14:31:25.583

我不认为 for 循环有问题。

```
while(rs2.next()){

} 
```

当 i 的其他迭代的条件为假并且它不进入 while 循环时，一旦执行此操作。

如果你想测试你可以这样做：

```
for(int i=0;i<columnCount;i++){  

    while(rs2.next()){              

       sutunlar[i] = rs2.getString(4);
       Set<String> setSutunlar = new HashSet<>(Arrays.asList(sutunlar[i]));
       Object rowData[][] = {null};
       Object columnNames[] = setSutunlar;
       table = new JTable(rowData, columnNames);
       scrollPane = new JScrollPane(table);
       sutunPanel.add(scrollPane);
    }

    System.out.println("Value of i is " + i);// Add this line to check iteration of i.
} 
```

# javascript - JavaScript 中的正则表达式未按预期工作

> ID：15617262
> 
> 赞同：1
> 
> 时间：2013-03-25T14:20:44.110
> 
> 标签：javascript, regex

我将根据以下条件进行验证：

1.  它将允许所有特殊字符
2.  它必须包含至少 1 个字母**或**字母数字
3.  只有特殊字符不起作用

我用了

```
/^\d*[a-zA-Z][a-zA-Z0-9]+/ 
```

它适用于所有场景，但在输入特殊字符之前确实需要 2 个字符或数字或两个字符的组合。

例子：

1.  `a!!@#$*()_`失败但应该通过

2.  `a1!@#$*()_`通行证

请帮助更正正则表达式。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-25T15:01:02.700

tl;dnr 答案：

```
/^(?=[!-~]+$)(?=.*[a-zA-Z0-9])/ 
```

解释：

在正则表达式中表达“AND”条件的常用方法如下：

```
/
    ^
    (?= pattern 1)
    (?= pattern 2)
    (?= pattern 3)
    etc
/ 
```

`^`基本上，只有当其余部分与所有给定模式匹配时，我们才接受输入 ( ) 的开始。否则，整个表达式将失败。

在您的示例中，模式 1 是匹配所有内容，包括“特殊字符”。根据您的评论，您正在寻找可打印的 ASCII 范围。一个 ASCII 字符是`[!-~]`，因为我们不想要任何其他东西（比如“国际字符”）并且不允许空字符串，最终模式是：

```
 [!-~]+$ 
```

第二种模式是“至少一个字母数字”，可以改写为“任何数量的其他任何东西，然后是一个数字或字母”，即

```
 .*[A-Za-z0-9] 
```

把它们放在一起：

```
 /^(?=[!-~]+$)(?=.*[a-zA-Z0-9])/ 
```

一些测试：

```
 re = /^(?=[!-~]+$)(?=.*[a-zA-Z0-9])/

    console.log(re.test("hi"))            // true
    console.log(re.test("a!!@#$*()_"))    // true

    console.log(re.test("~!!@#$*()_"))    // false
    console.log(re.test("π+1"))           // false
    console.log(re.test(""))              // false 
```

似乎工作！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-25T14:27:29.033

您的正则表达式*需要*一个字母字符后跟一个字母数字字符。显然，第一个示例不符合该条件，而第二个示例则通过了。

你的条件也有很大的重叠。说它必须包含“至少一个字母或字母数字字符”与简单地说它必须包含“至少一个字母数字字符”是一样的。这个条件也排除了说字符串不能都是特殊字符的需要；虽然在那里，你可能只是在澄清。您需要的正则表达式非常简单：

```
/[a-zA-Z0-9]/.test(str) 
```

它在任何地方搜索`str`字母数字字符。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-25T14:40:19.623

1.  它将允许所有特殊字符 => 不需要测试，任何字符串都匹配此规则
2.  它必须包含至少 1 个字母或字母数字 =>`/[a-zA-Z0-9]/`
3.  只有特殊字符不起作用=>第二个条件已经解决了这个问题。

你的正则表达式：

```
/[a-zA-Z0-9]/.test(string) 
```

[编辑] 这实际上与@acheong87 的答案相同......

# android - 来自动态页面的 PDF 未下载

> ID：15617263
> 
> 赞同：0
> 
> 时间：2013-03-25T14:20:45.193
> 
> 标签：android, download, android-webview

我有一个动态页面，例如[http://somesite.com/letters/pages/document.jsf](http://somesite.com/letters/pages/document.jsf)，其中包含一个 .pdf 文件，当我在 android 本机浏览器中加载此页面时，我在日志中看到了这一点 -

```
03-25 19:30:50.421: V/BrowserActivity LOG(22302):  BrowserActivity onDownloadStart() Begin - url http://somesite.com/letters/pages/document.jsf contentDisposition - attachment: filename=Letter.pdf mimetype - application/pdf 
```

我想下载这个' **Letter.pdf'**，这是一个附件，如android日志所说，我已经使用DefaultHTTPClient实现了downloadListener，但它下载的是document.jsf页面而不是那个.pdf。

请让我知道我需要提供哪一部分代码。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-11T18:54:35.583

Android 有一种非常特殊的处理下载的方式。也就是说，它将下载请求交给 Android DownloadManager，它基本上基于第一个请求发送第二个请求。

更多细节在这里：[http ://www.digiblog.de/2011/04/android-and-the-download-file-headers/](http://www.digiblog.de/2011/04/android-and-the-download-file-headers/)

# vb.net - 错误填充无效且无法移除

> ID：15617267
> 
> 赞同：1
> 
> 时间：2013-03-25T14:21:10.553
> 
> 标签：vb.net, encryption, cryptography, rijndaelmanaged

`Padding is invalid and cannot be removed`尝试解密数据时出现加密异常。网上和 StackOverflow 上有很多关于这个错误的问题，但我找不到解决方案。更具体地说，将 设置`Padding`为`None`或明确定义`BlockSize`似乎没有帮助。

我有一个 sub 可以加密和解密`XML`放在我硬盘上的一个小文件。作为参数，sub 接收文件的位置以及是否应该加密或解密。这是代码：

```
Private Sub LicenceEncryptOrDecrypt(LizenzDatei As String, EncryptOrDecrypt As String) 

    Dim Rijndael As RijndaelManaged = New RijndaelManaged

    Dim passPhrase As String = "SuperPassword"
    Dim hashAlgorithm As String = "SHA1"
    Dim passwordIterations As Integer = 3
    Dim keySize As Integer = 128

    Dim initVector As String = "16charLongString"
    Rijndael.IV = Encoding.ASCII.GetBytes(initVector)

    Dim saltValue As String = "DoYouWantSomeSalt"
    Dim saltValueBytes As Byte() = Encoding.ASCII.GetBytes(saltValue)

    Dim password As Rfc2898DeriveBytes = New Rfc2898DeriveBytes(passPhrase, saltValueBytes)

    Rijndael.Key = password.GetBytes(keySize / 8)

    Rijndael.Padding = PaddingMode.None

    Dim transform As ICryptoTransform
    Dim tempFile As String

        Select Case EncryptOrDecrypt
            Case "Encrypt"
                transform = Rijndael.CreateEncryptor(Rijndael.Key, Rijndael.IV)
                tempFile = LizenzDatei + ".enc"
            Case "Decrypt"
                transform = Rijndael.CreateDecryptor(Rijndael.Key, Rijndael.IV)
                tempFile = LizenzDatei + ".dec"
            Case Else
                Debug.Print(">< EncryptOrDecrypt: Falshes parameter. Ende Sub.")
                Success = False
        End Select

        Using inFS As FileStream = New FileStream(LizenzDatei, FileMode.Open)
            Dim data() As Byte = New Byte(inFS.Length - 1) {}

            Using outFS As FileStream = New FileStream(tempFile, FileMode.Create)
                Using outStreamEncrypted As CryptoStream = New CryptoStream(outFS, transform, CryptoStreamMode.Write)
                    outStreamEncrypted.Write(data, 0, data.Length)
                    outStreamEncrypted.FlushFinalBlock()
                    outStreamEncrypted.Close()
                End Using
                outFS.Close()
            End Using
            inFS.Close()
        End Using

    File.Delete(LizenzDatei)
    File.Move(tempFile, LizenzDatei)

End Sub 
```

错误发生在该行`outStreamEncrypted.FlushFinalBlock()`。我注意到`data`在加密（156）和解密（160）期间的长度是不同的。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-26T08:57:36.137

根据评论和问题[Rijndael Decryption error-Length of the data to decrypt is invalid](https://stackoverflow.com/questions/1396963/rijndael-decryption-error-length-of-the-data-to-decrypt-is-invalid)，我意识到我的错误来自输入`FileStream`。输入文件实际上从未被读取过。

更换线路

```
Using inFS As FileStream = New FileStream(LizenzDatei, FileMode.Open)
Dim data() As Byte = New Byte(inFS.Length - 1) {} 
```

经过

```
Dim data() As Byte = System.IO.File.ReadAllBytes(LizenzDatei) 
```

解决了我的问题。

谢谢大家！

# intuit-partner-platform - 您如何在 QBD 中按名称查找/搜索/查询供应商/客户？

> ID：15617271
> 
> 赞同：0
> 
> 时间：2013-03-25T14:21:14.367
> 
> 标签：intuit-partner-platform

我有一个用例，用户输入客户或供应商名称，它从 QB、地址、余额返回基本信息......

在 Qbo 中，我执行以下操作；

```
cust_query = new Intuit.Ipp.Data.Qbo.CustomerQuery()
cust_query.name = "CUSTOMER NAME"
cust_query.SpecifyOperatorOption(Intuit.Ipp.Data.Qbo.FilterProperty.Name, Intuit.Ipp.Data.Qbo.FilterOperatorType.EQUALS)
cust_query.ExecuteQuery 
```

所以我的问题是，我如何在 Qbd 中做同样的事情？
我似乎找不到任何示例或文档。
非常感谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-25T14:54:14.977

在 DevKit 中构建查询的信息在这里：添加查询 [http://docs.developer.intuit.com/0025_Intuit_Anywhere/0200_DevKits/0100_IPP_.NET_DevKit/Query_Filters/QuickBooks_Desktop_(Windows)](http://docs.developer.intuit.com/0025_Intuit_Anywhere/0200_DevKits/0100_IPP_.NET_DevKit/Query_Filters/QuickBooks_Desktop_(Windows))

如果您只想知道如何在 REST 服务中进行操作。 [http://docs.developer.intuit.com/0025_Intuit_Anywhere/0050_Data_Services/v2/0500_QuickBooks_Windows/0600_Object_Reference/Customer](http://docs.developer.intuit.com/0025_Intuit_Anywhere/0050_Data_Services/v2/0500_QuickBooks_Windows/0600_Object_Reference/Customer)

您可以使用 FirstLastEnd、FirstLastStart、FirstLastInside 的查询属性。

谢谢贾里德
_

# jakarta-ee - 从我的 web.xml 文件中，我怎样才能访问我的 webapp 名称？

> ID：15617273
> 
> 赞同：0
> 
> 时间：2013-03-25T14:21:15.210
> 
> 标签：jakarta-ee, tomcat

例如，在tomcat下，我的webapp名称与war文件相同。但这可以随时重命名并重新部署，所以我想访问我的web.xml中的webapp名称，专门为tomcat下的log4j和Spring设置webappRootkey。

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-25T20:25:39.393

您可以在 Web 应用程序中以编程方式[检索`<display-name/>`元素](http://docs.oracle.com/javaee/6/api/javax/servlet/ServletContext.html)

```
ServletContext.getServletContextName() 
```

`ServletContext`但是，在 spring 上下文中，您可以使用相同的对象获得相同的（Spring 3.x）

```
value="#{servletContext.servletContextName} 
```

# asp.net - ASP.NET 本地化在 IIS Express 中工作，但在 IIS7.5 中使用表达式语法 (<%$ %>)

> ID：15617282
> 
> 赞同：2
> 
> 时间：2013-03-25T14:21:28.793
> 
> 标签：asp.net, localization, internationalization, webforms, globalization

我有一个应用程序可以在 IIS Express 中正确本地化，但在部署到服务器（IIS 7.5）后会导致错误消息，但仅限于使用表达式语法的地方，例如`<asp:localize id="fooctrl" text="<%$ Resources:SiteResources, Foo_Key %>" runat="server" />`. 在我在 IIS Express 中运行的本地计算机上，这非常有效。但是一旦部署到服务器，这将导致错误：

找不到键为“Foo_Key”的资源对象。

我可以在后面的代码中将属性设置为资源键，而不会出现这样的问题：

```
fooctrl.Text = SiteResource.Foo_Key; 
```

我还可以使用文字服务器端标记或编码的服务器端标记输出资源字符串，没有问题：

```
<%= SiteResource.Foo_Key %>
<%: SiteResource.Foo_Fey %> 
```

我不认为这是一个部署问题，因为它只是似乎不起作用的表达式语法。我想了解我做错了什么或可能导致部署行为的原因？我真的不想在后面的代码中设置服务器控件的所有本地化属性。

**更多信息**

对于 sh_ts 和 gr_ns，我将 App_GlobalResources 文件夹复制到服务器。我的错误消失了。这使我将资源构建操作从 更改`Embedded Resource`为 ，`Content`以便它们与应用程序一起发布。虽然文件夹和 resx 文件在发布后确实出现在服务器上，但我收到错误消息：“找不到任何适合指定文化或中性文化的资源。”

所以这让我对嵌入式资源有点困惑。如果我需要服务器上的资源文件，实际嵌入了什么？如果我不仅需要嵌入资源，如何让 Visual Studio 2012 的 Publish Web 同时编译资源并复制文件，就好像它们是内容一样？我找不到任何设置来做到这一点。

**更多信息**

我今天将资源移至外部程序集，以支持本地化除 Web 应用程序之外的其他支持程序集。我从我的 Web 应用程序中删除了资源文件，添加了对所有适用项目的引用，更新了我的引用等。一切都像 IIS Express 中的重磅炸弹一样工作。Web 应用程序本地化很好，外部程序集本地化很好，但是当我部署到 IIS 7.5 时，Web 应用程序无法本地化。与以前一样处理表达式语法。再次部署 .resx 文件解决了该错误。

我不明白问题是什么。据我所知，这些资源是正确的，如下所示：

![Resx 属性](../Images/48653255ff301d9d052ada1d257873e1.png)

我什至使用 JetBrains dotPeek 来反编译资源程序集，我可以看到嵌入的 XML 完整，其中每个都有值。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-07T16:45:30.407

为了使用表达式语法在 ASP.NET 应用程序中使用嵌入式资源，需要做四件事：

1.  自定义资源提供者工厂
2.  自定义资源提供者
3.  自定义表达式生成器
4.  参考`<compilation><expressionBuilders></expresionBuilders></compilation>`部分中的自定义 ExpressionBuilder

[这篇文章](http://msdn.microsoft.com/en-us/library/aa905797.aspx)详细说明了如何去做，并包括完整的源代码控制。

# html - 卡住了使用 CSS 创建子菜单

> ID：15617283
> 
> 赞同：0
> 
> 时间：2013-03-25T14:21:31.027
> 
> 标签：html, css

我对 css 和 html 很陌生，我使用 css 设计了一个菜单，即使在互联网上搜索了很多之后，我也找不到向其中添加子菜单的方法。他们永远不会出现，甚至他们会重叠我的水平菜单而不是垂直菜单

这是我菜单的CSS：

```
#top-menu { float: left; width: 1000px; height:51px; margin-top: -30px; margin-left: 250px;  }

#top-menu ul {  list-style: none;text-align:center;
}

#top-menu li a{ position: relative; float :left;
display: block;
height: 32px;
width: 100px;
padding-top: 15px;
color: #444;
text-transform: none;
font-size: 12px;
font-weight: bold;

}

#top-menu li a:hover {
color: #f4f4f4;
background: #222;
border-bottom: 4px solid #22aed6; font-weight: bold;}

#top-menu li .active {
color: white;
background: #22aed6;
border-bottom: 4px solid #22aed6;} 
```

和html代码：

```
<div id="top-menu">
<ul>
    <li><a href="index.html" class="active">Home</a></li>
    <li><a href="about.html">About Us</a></li>
    <li><a href="ff.html">Featured</a></li>
    <li><a href="f-e.html">Fests</a></li>
    <li><a href="fye.html">find</a></li>
    <li><a href="tip-us.html">tip US</a></li>
    <li><a href="adwus.html">Advertise</a></li>
    <li><a href="contactus.html">Contact Us</a></li>
</ul> 
```

请帮我创建子菜单！

指向我网站的链接是[http://eventsindu.com](http://eventsindu.com)（旧设计） [http://eventsindu.com/test](http://eventsindu.com/test)（正在开发的新设计）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-25T15:35:41.977

要制作子菜单，只需这样做。

```
<ul id="mainMenu">
    <li><a>blabla</a>
         <ul id="subMenu">
             <li><a>blabla2</a></li>
         </ul>
    </li>
</ul> 
```

去看看这段代码的 CSS 和更深入的[http://jsfiddle.net/BVvc6/1/](http://jsfiddle.net/BVvc6/1/)

发现它在谷歌搜索 10 秒。

[如何在下拉导航css中将第二级添加到子菜单](https://stackoverflow.com/questions/10121146/how-to-add-second-level-to-a-submenu-in-a-dropdown-navigation-css)

# ruby-on-rails-3 - 通过未定义的方法错误测试“应该获取索引”

> ID：15617286
> 
> 赞同：1
> 
> 时间：2013-03-25T14:21:41.577
> 
> 标签：ruby-on-rails-3, associations

所有，我定义了以下模型：

```
class Role < ActiveRecord::Base
  attr_accessible :name

  has_many :users

  validates :name, presence: true
  validates :name, uniqueness: true

end 
```

和

```
class User < ActiveRecord::Base
  attr_accessible :abv, :first_name, :full_name, :last_name, :role_id

  has_many :defects
  belongs_to :role

  validates :first_name, :last_name, :full_name, :abv, :role_id, presence: true
  validates :full_name, :abv, uniqueness: true

end 
```

我最近更改了视图用户“索引”以将 user.role_id 字段显示为 user.role.name 以使视图更友好！这很好用！但是，当运行 rake 测试 users_controller_test 时，会出现以下错误：

1) 错误：test_should_get_index(UsersControllerTest): ActionView::Template::Error: undefined method `name' for nil:NilClass

在搜索博客后，我发现删除和重新创建测试数据库的参考适用于一个人，并将控制器中的“应该获取索引”测试从

```
get :index 
```

获取 :index, :user.role_id => 1 #forced to known value

但我所做的一切都没有纠正测试失败。我在这里缺少什么，这可能是如何定义测试夹具中的数据的问题，还是我缺少核心导轨概念？

一如既往，在此先感谢，

理查德

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-02-25T05:40:15.420

如果您正在使用关联，您可以通过在两个不同的设备之间定义一个参考节点来解决这个问题。

# iphone - 有条件退出（0）；在 applicationDidEnterBackground?

> ID：15617290
> 
> 赞同：0
> 
> 时间：2013-03-25T14:21:53.133
> 
> 标签：iphone, xcode, exit

是否可以使用 exit(0); 像这样？

```
-(void)applicationDidEnterBackground:(UIApplication *)application
{
     if (UserDontWantItRunInBackground) {
        exit(0);
     }
} 
```

苹果会批准吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-25T14:40:10.710

我的理解是Apple根本不喜欢你使用`exit()`。

事实上，来自 Apple 的[人机界面指南](http://developer.apple.com/library/ios/#documentation/userexperience/conceptual/mobilehig/UEBestPractices/UEBestPractices.html#//apple_ref/doc/uid/TP40006556-CH20-SW1)：

```
Don’t Quit Programmatically

Never quit an iOS app programmatically because people tend to interpret this as a crash. 
```

据我所知，尽管它可能完全按照您的意愿工作，但您的应用很有可能会被拒绝。

# javascript - 在 Backbone/RequireJs 中动态加载依赖项

> ID：15617298
> 
> 赞同：0
> 
> 时间：2013-03-25T14:22:18.047
> 
> 标签：javascript, backbone.js, requirejs

我正在使用 Backbone/RequireJs javascript 堆栈。我想要实现的是在设置依赖项之后动态地要求`Model`a的依赖项。`Backbone.Collection``Collection`

我想尽可能地保持`Collection`通用性，并且我想`Models`根据当前的主要上下文分配不同的和休息的 url。目标是，在特定的上下文中只加载需要的内容。

```
window.Collection = Backbone.Collection.extend({

    initialize: function(modelName,apiRoute){

        this.modelName = modelName;
        this.apiRoute = apiRoute;

        if (typeof(window[this.modelName]) === "function") { 
            this.model = window[this.modelName];
            this.url = "./api/" + this.apiRoute;
        }
    }
... 
```

这里的问题是`window[this.modelName]`主上下文中的依赖项必须在`Collection`依赖项之前加载。

假设对象`MainContext`需要一个集合：

```
// MainContext.js    
define([ 
     ...
     "model/Collection" 
```

在里面`MainContext`我解析了`modelName`集合所需依赖项的名称值所需的变量（例如' `Toys`'）。如果 i`require(['model/Toys'])`在 MainContext 中，则该依赖文件将加载得太晚。

在这种情况下会采取什么方法？欣赏。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-25T20:16:13.823

听起来您在描述标准的 Require.js 循环依赖项。换句话说，您有一个依赖于玩具的集合，但其他一些模块或模块使这变得不可能。

您提到的对此的标准解决方案是使用同步形式的require，即。`require(['model/Toys'])`. 但是，听起来将其放入`MainContext`是错误的方式，因为它在加载时尚未加载`MainContext`。

解决这个问题的方法是在加载时不需要它的地方使用同步 require *，*这听起来像你的 Collection。您的 Collection 需要模型，但它在*运行时*需要它（特别`initialize`是在运行时）。如果您将代码更改为：

```
window.Collection = Backbone.Collection.extend({

    initialize: function(modelName,apiRoute){

        this.modelName = modelName;
        this.apiRoute = apiRoute;

        if (typeof(window[this.modelName]) === "function") { 
            this.model = require('model/' + this.modelName);
            this.url = "./api/" + this.apiRoute;
        }
    }
.... 
```

在您的初始化运行时，模型应该已经加载。

希望有帮助。

# mysql - 如何在插入子表时将值从父表插入子表

> ID：15617299
> 
> 赞同：1
> 
> 时间：2013-03-25T14:22:18.357
> 
> 标签：mysql, delimiter

我想在新插入时在父表中生成的子表中插入一个值。

认为，

```
create table head (
head_id int primary key auto_increment,
table_type varchar(60) );

create table table1 (
t1_id int primary key,
name varchar(60) ,
foreign key (t1_id) references head(head_id)
);

create table table2 (
t2_id int primary key,
name varchar(60) ,
foreign key (t2_id) references head(head_id)
); 
```

创建 3 个表头和表 1、表 2。

每当我在 table1 或 table2 中插入值时，我都想要，

```
insert into table1 (name) values('Hi'); 
```

head 和 table1 插入这些值，

```
select * from head;
id      table_type
.
.
5       table1

select * from table1;

t1_id      name
.
.
5          hi 
```

请注意，头表会自动增加 id。它被插入到子表table1中。如何做到这一点我尝试了以下触发器，但它不起作用。

```
DELIMITER $$
CREATE
    TRIGGER `t1` BEFORE INSERT
    ON `table1`
    FOR EACH ROW BEGIN
        insert into head (table_type) values ('table1');
        insert into table1 (t1_id,name) values (NEW.head(id),NEW.table1(name));
    END

$$ 
```

任何帮助，将不胜感激。

# ios - Objective-C 的 ^ 操作符

> ID：15617302
> 
> 赞同：9
> 
> 时间：2013-03-25T14:22:21.710
> 
> 标签：ios, objective-c

我是 Objective C 的新手，并试图弄清楚 ^ 运算符的作用是什么？在探索一些源代码时，我看到了下一个构造：

```
dispatch_once(&onceToken, ^{
    UIGraphicsBeginImageContextWithOptions(CGSizeMake(20.f, 13.f), NO, 0.0f);

    [[UIColor blackColor] setFill];
    [[UIBezierPath bezierPathWithRect:CGRectMake(0, 0, 20, 1)] fill];
    [[UIBezierPath bezierPathWithRect:CGRectMake(0, 5, 20, 1)] fill];
    [[UIBezierPath bezierPathWithRect:CGRectMake(0, 10, 20, 1)] fill];

    [[UIColor whiteColor] setFill];
    [[UIBezierPath bezierPathWithRect:CGRectMake(0, 1, 20, 2)] fill];
    [[UIBezierPath bezierPathWithRect:CGRectMake(0, 6,  20, 2)] fill];
    [[UIBezierPath bezierPathWithRect:CGRectMake(0, 11, 20, 2)] fill];   

    defaultImage = UIGraphicsGetImageFromCurrentImageContext();
    UIGraphicsEndImageContext();

}); 
```

我想知道^是什么？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2013-03-25T14:24:56.223

`^`指示在 Objective-C 中块定义的开始。

看看这里：http: [//developer.apple.com/library/ios/#documentation/cocoa/Conceptual/Blocks/Articles/bxGettingStarted.html#//apple_ref/doc/uid/TP40007502-CH7-SW1](http://developer.apple.com/library/ios/#documentation/cocoa/Conceptual/Blocks/Articles/bxGettingStarted.html#//apple_ref/doc/uid/TP40007502-CH7-SW1)

请注意，在这种情况下，`^`is 不是运算符，它是 Objective-C 语法的一部分 @Mike 被否决的答案严格来说是“^ 运算符”的正确定义

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-03-25T14:32:35.380

它在Objective C中被称为**块**

句法：

```
returnType (^variableName)(parameters); 
```

逐字逐句摘自[Akiel Khan 的教程（您可以](http://code.tutsplus.com/tutorials/understanding-objective-c-blocks--mobile-14319)[在此处](https://web.archive.org/web/20131025011421/http://informalprotocol.com/2012/10/declaring-blocks-in-objective-c)找到另一个很好的教程）：

> *   块文字是“匿名的”（即无名的）
> *   插入符号 (^)
> *   我们不必指定返回类型——编译器可以“推断”它。如果我们愿意，我们可以明确提到它。

[这是官方文档，请阅读以获取更多信息。](http://developer.apple.com/library/ios/#documentation/cocoa/conceptual/ProgrammingWithObjectiveC/WorkingwithBlocks/WorkingwithBlocks.html)

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2013-03-25T14:28:26.660

这是一个开始一个块的信号。

您可以通过阅读一些教程博客或文章找到更多关于块的信息：

[块——iOS 4 中一个有趣的 Objective-C 添加](http://maniacdev.com/2010/07/blocks-an-interesting-objective-c-addition-in-ios-4/)

[如何在 iOS 5 教程中使用块](http://www.raywenderlich.com/9438/how-to-use-blocks-in-ios-5-tutorial-part-2)

了解了 block 的基本知识后，可以参考[苹果关于 block 的文档](http://developer.apple.com/library/ios/#documentation/cocoa/Conceptual/Blocks/Articles/00_Introduction.html)。

事实上，block 最常用的用法是[GCD](https://developer.apple.com/library/mac/#documentation/Performance/Reference/GCD_libdispatch_Ref/Reference/reference.html)（代表 Grand Central Dispatch，这是你的问题）、[UIView 的动画](http://developer.apple.com/library/ios/#documentation/UIKit/Reference/UIView_Class/UIView/UIView.html#//apple_ref/occ/cl/UIView)和其他类似回调的东西。它在现代 Obj-C 编程中非常有用和常见。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-03-25T14:27:31.767

它用于在对象中创建块 c 块就像 c 中的函数指针。这可能会帮助你

[签出此链接](http://developer.apple.com/library/ios/#documentation/cocoa/conceptual/Blocks/Articles/00_Introduction.html)

# css - 将“-webkit-”以外的供应商特定前缀用于“过渡”有什么意义吗？

> ID：15617308
> 
> 赞同：3
> 
> 时间：2013-03-25T14:22:26.103
> 
> 标签：css, css-transitions, vendor-prefix

在我正在学习的课程中，我发现了以下内容（摘录）：

```
p.box{
-webkit-transition: border-radius 1s;
-moz-transition: border-radius 1s;
-o-transition: border-radius 1s;
-ms-transition: border-radius 1s;
transition: border-radius 1s;
}

p.rounded{
border-radius:50px;
} 
```

但是，根据[此表](http://caniuse.com/#feat=css-transitions)，使用其他浏览器特定前缀似乎没有意义，而不是`-webkit-`. 较新版本的 IE、FireFox 和 Opera 始终支持此属性，而旧版本则不支持。所以在我看来，以 , 开头的行`-moz-`无论如何`-o-`都`-ms-`不会影响页面显示。我可以——从现在开始——在 的情况下总是把这些排除在外`transition`吗？还是我误解了什么？还是表格不正确？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-25T14:34:50.767

Firefox 直到 v15 需要`-moz`前缀，而 Opera需要`-o`直到 v12（`-ms`在这种情况下，前缀毫无意义）^*。因此，您说您可以删除这些前缀并且在所有浏览器的*最新版本中看不到任何差异是正确的。*但是，您可能会发现那些稍旧的版本仍然占任何特定站点的大量访问者。

我建议包括前缀，直到需要它们的浏览器版本已经成为过去。这样，您就知道他们只会占您访问者的一小部分。例如，不再值得包含以下前缀`border-radius`：Firefox 一直支持无前缀版本，一直到 v3.6，Chrome 从 v4 开始。

您可以使用[Compass](http://compass-style.org/)或[Prefix free](http://leaverou.github.com/prefixfree/)之类的东西（如果它们适合您的工作流程）来为您解决这个问题。

**编辑**- 我个人不使用无前缀，因为我分享了 OP 在使用 JavaScript 创建样式时并非绝对必要的犹豫。如果 SASS/Compass 不是一个选项，我推荐Sublime Text[的 Prefixr 插件](http://wbond.net/sublime_packages/prefixr)。这样，您只需要担心手动编写非前缀版本，但您仍然会在样式表中发送完全前缀版本。

* 这些统计数据来自[CanIUse...](http://caniuse.com/#feat=css-transitions)，您只需单击兼容性表左上角的“显示所有版本”链接即可查看有关所有浏览器的信息。

# winforms - 如何在不搜索的情况下将节点设置为在 winforms 树视图中选择

> ID：15617316
> 
> 赞同：2
> 
> 时间：2013-03-25T14:22:41.190
> 
> 标签：winforms, treeview

当我说：

```
treeview.SelectedNode = new TreeNode{ Text = "Myname" }; 
```

尽管树视图节点集合中有一个带有此文本的节点，但这将不起作用。

如何在不搜索节点实例之前以编程方式将节点设置为选中然后选择它？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-25T14:28:53.927

添加节点时，您也可以为其设置密钥，例如：

```
treeview.Nodes.Add("a node", "a node");
treeview.Nodes.Add("b node", "b node"); 
```

这样，如果您想选择一个节点，您可以使用它的键来完成，例如：

```
treeview.SelectedNode = treeView.Nodes.Find("b node", true); 
```

这样您就可以避免手动迭代所有节点以检查它们的文本是否匹配。

# javascript - 无法让自定义对话框与 DirtyForms 一起使用

> ID：15617322
> 
> 赞同：3
> 
> 时间：2013-03-25T14:22:51.670
> 
> 标签：javascript, jquery, forms, jquery-dirtyforms

我正在使用[DirtyForms](https://github.com/snikch/jquery.dirtyforms)并且插件的基本功能正在运行。当用户试图离开一个页面时，浏览器会抛出一个确认对话框。

我们使用 jQuery UI 的对话框进行模态确认，我试图让它与 DirtyForms 一起使用，它有一个直接引用 jQuery UI 对话框的示例。我直接从他们的页面使用示例来设置自定义对话框，但它没有使用 jQuery 对话框，它仍然使用浏览器的本机对话框：

```
$.DirtyForms.dialog = {
    selector: '#unsavedChanges',
    fire: function(message, dlgTitle) {
        $('#unsavedChanges').dialog({title: dlgTitle, width: 350, modal: true});
        $('#unsavedChanges').html(message);
    },
    bind: function() {
        $('#unsavedChanges').dialog('option', 'buttons',
            [
                {
                    text: "Stay Here",
                    click: function(e) {
                        $.DirtyForms.choiceContinue = false;
                        $(this).dialog('close');
                    }
                },
                {
                    text: "Leave This Page",
                    click: function(e) {
                        $.DirtyForms.choiceContinue = true;
                        $(this).dialog('close');
                    }
                }
            ] 
        ).bind('dialogclose', function(e) {
            // Execute the choice after the modal dialog closes
            $.DirtyForms.choiceCommit(e);
        });
    },
    refire: function(content) {
        return false;
    },
    stash: function() {
        return false;
    }
} 
```

打开插件的调试后，我没有收到任何错误（或任何其他 JS 错误），但模式对话框没有触发，只有浏览器的原生对话框。其他在同一页面上实现的 jQuery UI 对话框工作。我不确定我可能在这里遗漏了什么。任何帮助或见解将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2016-02-21T11:54:28.290

最可能的问题是`div`您的 HTML 标记中没有带有 id 的标记`unsavedChanges`。因此，您应该添加 HTML ...

```
<div id="unsavedChanges" style="display:none;" /> 
```

或 JavaScript 中的等价物...

```
var $dlg = $('<div id="unsavedChanges" style="display:none;" />'); 
$('body').append($dlg); 
```

如果这不是问题，我建议您通过发布整个 HTML 文档或使用 JSFiddle 之类的服务来编辑您的问题以包含一个[Minimal、Complete 和](https://stackoverflow.com/help/mcve)[Verifiable Example](https://jsfiddle.net/)。

> **注意：**自定义对话框仅在用户单击页面中的超链接时有效。当用户与浏览器的导航交互时，会显示浏览器的对话框（如果有）。这是因为无法使用自定义对话框覆盖浏览器的默认导航行为。
> 
> 在 2.x 版本中，现在可以[自定义事件绑定](https://github.com/snikch/jquery.dirtyforms#event-handler-customization)，因此如果单击它们会离开当前页面，则可以添加超链接以外的元素。

# c# - 无法更新亮星数据库中的记录

> ID：15617325
> 
> 赞同：0
> 
> 时间：2013-03-25T14:22:56.000
> 
> 标签：c#, in-memory-database

不确定社区中是否有人有机会在 Inmemory 数据库（亮星）上工作，我正在尝试通过下面的代码更新记录，但无法这样做。

```
 public void ChangePrice(string strId)
    {
        string configTDDB = ConfigurationManager.AppSettings["TDSDB"];
        double Price = 10.10;
        IMDB.IMDBEntityContext TDcontext = new IMDB.IMDBEntityContext(configTDDB);

        var claim = bdcontext.Price_Lists.FirstOrDefault<TDParser.IMDB.IPrice_List>(m               => m.NDC == strId);
        claim.Price = Price;
        TDContext.SaveChanges(); 

    } 
```

对此的任何建议/帮助都会有很大帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-27T13:12:23.063

嗨团队，感谢您对此线程的回复我找到了不允许执行 CRUD 操作的原因 - 这是许可问题，现在我可以使用上述相同的代码进行更新。

# android - 从移动浏览器调用 Android 服务

> ID：15617326
> 
> 赞同：2
> 
> 时间：2013-03-25T14:23:04.933
> 
> 标签：android, android-manifest, android-service, mobile-browser

当用户单击网页上的按钮时，我必须启动服务。我知道可以通过在清单中添加 Activity 来做到这一点：

```
<activity
    android:name="MyActivity"
    android:label="@string/app_name" >
    <intent-filter>
        <data android:scheme="myscheme" /> 
        <action android:name="android.intent.action.VIEW" />
        <category android:name="android.intent.category.BROWSABLE" />
        <category android:name="android.intent.category.DEFAULT" />
    </intent-filter>
</activity> 
```

我的想法是对服务做同样的事情：

```
<service
        android:name="MyService"
        android:enabled="true"
        android:exported="true" >
        <intent-filter >
            <data android:scheme="myscheme"/>
            <category android:name="android.intent.category.BROWSABLE"/>
            <category android:name="android.intent.category.DEFAULT" />
        </intent-filter>
    </service> 
```

但它不起作用。

那么是否可以从浏览器调用服务以及如何做呢？如果没有，我该怎么办（我不希望在用户单击网页按钮时出现应用程序视图）？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-25T14:44:47.963

> 那么是否可以调用该服务

不，除非可能启动一项活动并让该活动对您的服务做一些事情。

> （当用户单击网页按钮时，我不希望出现应用程序视图）？

欢迎您创建一个`Theme.NoDisplay`活动，该活动`startService()`从其调用`onCreate()`，然后立即调用`finish()`。

# php - jquery在onkey up函数中自动完成

> ID：15617328
> 
> 赞同：0
> 
> 时间：2013-03-25T14:23:06.817
> 
> 标签：php, jquery, jquery-autocomplete

我需要附加来自 jquery 函数的结果。当用户在搜索字段中键入时，会调用一个函数并从我的数据库中返回数据。我可以使用警报功能查看返回的数据

```
<input type="text" name="symbol" id="symbol" required="required"  onkeyup="findmatch();"> 
```

调用的Jquery函数如下

```
 function findmatch(){
    var symbol= document.getElementById("symbol").value;

    $.post("portfolio/searchStock.php",
    {
      search:symbol
    },
    function(data,status){
    alert(data);

    });     
} 
```

我需要将返回的数据作为自动完成附加，我尝试在函数中使用以下内容，我不明白为什么它不起作用

```
$( "#symbol" ).autocomplete({
                source: data
        }); 
```

php文件回显数据如下

```
if (isset ($_POST['search'])){ 
```

$search = $_POST['搜索']; if(!empty ($search)){ $query="select * from companylist where symbol like '".mysql_real_escape_string($search)."%'"; $query_run = mysql_query($query);

```
 while ($query_row = mysql_fetch_assoc($query_run)){
        $symbol = $query_row['symbol'];
        echo $symbol;
    }
} 
```

}

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-26T12:11:24.953

感谢您的回复，这似乎工作。需要从 php 端 JavaScript 文件编码和解析的数组

```
 function findmatch(){   
    var symbol= document.getElementById("tSymbol").value;   
    $.post("portfolio/searchStock.php",
    {
      search:symbol
    },
    function(data,status){
    var arrData = $.parseJSON(data);
    $("#tSymbol").autocomplete({
         source: arrData
    });
    });     
} 
```

搜索股票.php

```
if (isset ($_POST['search'])){ 
```

$search = $_POST['搜索']; if(!empty ($search)){ $query="select * from companylist where symbol like '".mysql_real_escape_string($search)."%'"; $query_run = mysql_query($query);

```
 while ($query_row = mysql_fetch_assoc($query_run)){
        $symbol [] = $query_row['symbol'];

    }
    echo json_encode($symbol);

} 
```

}

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-25T14:29:09.990

您需要格式化 db 调用的输出：

```
while ($query_row = mysql_fetch_assoc($query_run)){
    $symbol[] = $query_row['symbol'];
}
echo json_encode($symbol); 
```

然后，您需要解析返回的数据。

```
var sourceData = [];
var arrData = $.parseJSON(data);
foreach(x in arrData)
{
    sourceData.push(arrData[x]);
}
$( "#symbol" ).autocomplete({
            source: sourceData
}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-25T17:49:40.337

试试这个

```
$( "#symbol" ).autocomplete({
                'search':function(event,ui){
                var newUrl="portfolio/searchStock.php/abc/"+$("#symbol").val();
                $(this).autocomplete("option","source",newUrl)
                },
                'source':[]
    }); 
```

并在 php

```
 function abc($search ){  

 if(!empty ($search)){ $query="select * from companylist where symbol like '".mysql_real_escape_string($search)."%'"; $query_run = mysql_query($query);

    while ($query_row = mysql_fetch_assoc($query_run)){

       $new_row['label']=htmlentities(stripslashes($query_row['symbol']));
     $new_row['value']=htmlentities(stripslashes($query_row['symbol_id']));
    $row_set[] = $new_row; //build an array
  }

 }echo json_encode($row_set);
} 
```

# asp.net - asp.net mvc3 Datetime to shortdate

> ID：15617335
> 
> 赞同：-1
> 
> 时间：2013-03-25T14:23:30.077
> 
> 标签：asp.net, asp.net-mvc-3, datetime-format

我是asp.net 和mvc3 的新手。我正在使用 sql server 和实体框架，并希望在我的详细信息视图中显示日期。

sql 中的数据类型是`DateTime`.

现在我得到的是：`21.03.2013 00:00:00` 我想要的是：`21.03.2013`

现在我正在使用：

```
@Html.DisplayFor(Model => Model.PlanBegPlan.Date) 
```

请帮忙 ...

我的控制器

```
 public ViewResult DetailsTestRelease(int id)
    {
        ViewData["EditTestReleaseId"] = id;

        TRel testrelease = db.TRel.Single(t => t.Id == id);
        Basedata bv = db.BasedataSet.Single(b => b.Id == id);
        ViewData["pid"] = testrelease.ProjectId;
        //ViewData["bid"] = testrelease.Base.Id;

        var tuple = new Tuple<KPI_Container.TRel, KPI_Container.Basedata>(testrelease, bv);

        return View(tuple);
    } 
```

* * *

我的观点：

```
 @model Tuple<KPI_Container.TRel, KPI_Container.Basedata>

    @{
        ViewBag.Title = "Details";
    }

    <h2>Soll-Werte</h2>
    <br />
     <div>
        @Html.ActionLink("Soll-Werte Testrelease Bearbeiten", "EditTestRelease", new { id = ViewData["EditTestReleaseId"] }, new { Class = "action add", title = "Hier können die Testreleasedaten gepflegt werden." }) 

        @Html.ActionLink("Soll-Planung der Basiswerte", "EditBaseValues", new { id = ViewData["EditTestReleaseId"] }, new { Class = "action add", title = "Zum Ansehen und Bearbeiten der Basiswerte." }) |
        @Html.ActionLink("KPI-Werte anzeigen", "ShowKPIs", new { id = ViewData["EditTestReleaseId"] }, new { Class = "action add", title = "Zum Ansehen der KPI-Werte." })
     </div>

    <script src="@Url.Content("~/Scripts/jquery.validate.min.js")" type="text/javascript"></script>
    <script src="@Url.Content("~/Scripts/jquery.validate.unobtrusive.min.js")" type="text/javascript"></script>
    <link rel="stylesheet" href="http://code.jquery.com/ui/1.10.0/themes/base/jquery-ui.css">
    <script src="http://code.jquery.com/jquery-1.9.0.js" type="text/javascript"></script>
    <script src="http://code.jquery.com/ui/1.10.0/jquery-ui.js" type="text/javascript"></script>

    <script>
        $(function () {
            $("#tabs").tabs();
        });
    </script>

    @using (Html.BeginForm())
    {
    @Html.ValidationSummary(true)

    <div id="tabs">
        <ul>
            <li><a href="#tabs-1"><span>Planung Testrelease</span></a></li>
            <li><a href="#tabs-2"><span>Management & Koordination</span></a></li>
            <li><a href="#tabs-3"><span>Zusatzservices / Aktivitäten</span></a></li>
            <li><a href="#tabs-4"><span>PPU Services</span></a></li>
            <li><a href="#tabs-5"><span>Einflussparameter / Steuergrößen</span></a></li>
        </ul>
        <div id="tabs-1">
        <table id="tabletry">
        <tr>
        <th>Testrelease</th>
        <th></th>
        </tr>
        <tr>
        <td title="Name des Testrelease">Name</td>
        <td style="background-color: White">@Html.DisplayFor(Model => Model.Item1.Name)</td>
        </tr>

        <tr>
        <td title="Name des Projektes">@Html.LabelFor(model => model.Item1.ProjectId, "Projekt")</td>
        <td style="background-color: White">@Html.DisplayFor(Model => Model.Item1.Project.Name)</td>
        </tr>

        </table>
        <br />

    <table id="tabletry">
    <tr>
    <th>Soll-Werte</th>
    <th></th>
    <th></th>
    <th></th>
    <th></th>
    </tr>
    <tr>
    <td>Plan( Control)</td>
    <td title="Planned Begin Planning - Geplanter Beginn der Testplanung aus der Baseline">PlanBegPlan</td>
    <td style="background-color: White">@Html.DisplayFor(Model => Model.Item1.PlanBegPlan)</td>
    <td title="Planned End Planning - Geplantes Ende der Testplanung aus der Baseline">PlanEndPLan</td>
    <td style="background-color: White">@Html.DisplayFor(Model => Model.Item1.PlanEndPlan.Date)</td>
    </tr>
    <tr>
    <td>Prep</td>
    <td title="Planned Begin Preparation- Geplanter Beginn der Testvorbereitung aus der Baseline">PlanBegPrep</td>
    <td style="background-color: White">@Html.DisplayFor(Model => Model.Item1.PlanBegPrep.Date)</td>
    <td title="Planned End Preparation - Geplantes Ende der Testvorbereitung aus der Baseline">PlanEndPrep</td>
    <td style="background-color: White">@Html.DisplayFor(Model => Model.Item1.PlanEndPrep.Date)</td>
    </tr>
    <tr>
    <td>Exec</td>
    <td title="Planned Begin Execution- Geplanter Beginn der Testdurchführung aus der Baseline">PlanBegExec</td>
    <td style="background-color: White">@Html.DisplayFor(Model => Model.Item1.PlanBegExe.Date)</td>
    <td title="Planned End Execution- Geplantes Ende der Testdurchführung aus der Baseline">PlanEndExec</td>
    <td style="background-color: White">@Html.DisplayFor(Model => Model.Item1.PlanEndExe.Date)</td>
    </tr>
    <tr>
    <td>Total</td>
    <td title="Planned Begin Total- Geplanter Beginn des Gesamtprojektes aus der Baseline">PlanBegTot</td>
    <td style="background-color: White">@Html.DisplayFor(Model => Model.Item1.PlanBegTot.Value.Date)</td>
    <td title="Planned End Total- Geplantes Ende des Gesamtprojektes aus der Baseline">PlanEndTot</td>
    <td style="background-color: White">@Html.DisplayFor(Model => Model.Item1.PlanEndTot.Value.Date)</td>
    </tr>

    </table>
   </div>
   <div id="tabs-2">
        <table id="tabletry">
                    <tr>
                    <th>Soll-Werte</th>
                    <th></th>
                    </tr>
                    <tr>
                        <td title="xx">Projektmanagement</td>
                        <td style="background-color: white">@Html.DisplayFor(Model => Model.Item2.PM_plan)</td>
                    </tr>
                    <tr>
                        <td title="xx">Qualitätsmanagement</td>
                        <td style="background-color: white">@Html.DisplayFor(Model => Model.Item2.QM_plan)</td>
                    </tr>
                    <tr>
                        <td title="xx">Projektmanagement Office</td>
                        <td style="background-color: white">@Html.DisplayFor(Model => Model.Item2.PMO_plan)</td>
                    </tr>
                    <tr>
                        <td title="xx">Teamkoordination</td>
                        <td style="background-color: white">@Html.DisplayFor(Model => Model.Item2.Tcoord_plan)</td>
                    </tr>
                </table>
                </div>

                <div id="tabs-3">
                <table id="tabletry">
                    <tr>
                        <th>Soll-Werte</th>
                        <th></th>
                    </tr>
                    <tr>
                        <td title="xx">Defektmanagement</td>
                        <td style="background-color: white">@Html.DisplayFor(Model => Model.Item2.Defmgmt_plan)</td>
                    </tr>
                    <tr>
                        <td title="xx">Umgebungsmanagement</td>
                        <td style="background-color: white">@Html.DisplayFor(Model => Model.Item2.Envmgmt_plan)</td>
                    </tr>
                    <tr>
                        <td title="xx">Testdatenmanagement</td>
                        <td style="background-color: white">@Html.DisplayFor(Model => Model.Item2.Testdmgmt_plan)</td>
                    </tr>
                    <tr>
                        <td title="xx">Testvorbereitung</td>
                        <td style="background-color: white">@Html.DisplayFor(Model => Model.Item2.Testprep_plan)</td>
                    </tr>
                    <tr>
                        <td title="xx">Knowledgetransfer/Transition</td>
                        <td style="background-color: white">@Html.DisplayFor(Model => Model.Item2.KTTrans_plan)</td>
                    </tr>
                    <tr>
                        <td title="xx">Consulting</td>
                        <td style="background-color: white">@Html.DisplayFor(Model => Model.Item2.Consulting_plan)</td>
                    </tr>
                    <tr>
                        <td title="xx">Tools-Setup</td>
                        <td style="background-color: white">@Html.DisplayFor(Model => Model.Item2.Toolset_plan)</td>
                    </tr>
                </table>
                </div>

                <div id="tabs-4">
                <h2>Funktionaler Test</h2>
                 <table id="tabletry">
                <tr>
                        <th title="xx">Neue<br />Funktionalität</th>
                        <th title="xx">Anzahl geplant<br />hoch</th>
                        <th title="xx">Anzahl geplant<br />mittel</th>
                        <th title="xx">Anzahl geplant<br />gering</th>
                </tr>
                <tr>
                        <td>Specification</td>
                        <td style="border-right-style: dotted; background-color: white">@Html.DisplayFor(Model => Model.Item2.FUN_Tspec_nf_l_plan)</td>
                        <td style="border-right-style: dotted; background-color: white">@Html.DisplayFor(Model => Model.Item2.FUN_Tspec_nf_m_plan)</td>
                        <td style="background-color: white">@Html.DisplayFor(Model => Model.Item2.FUN_Tspec_nf_s_plan)</td>
                </tr>
                <tr>
                        <td>Execution</td>
                        <td style="border-right-style: dotted; background-color: white">@Html.DisplayFor(Model => Model.Item2.FUN_TEXe_nf_l_plan)</td>
                        <td style="border-right-style: dotted; background-color: white">@Html.DisplayFor(Model => Model.Item2.FUN_TExe_nf_m_plan)</td>
                        <td style="background-color: white">@Html.DisplayFor(Model => Model.Item2.FUN_TExe_nf_s_plan)</td>
                </tr>
                <tr>
                        <th>Regression</th>
                        <td style="border-right-style: dotted;background-color:silver"></td>
                        <td style="border-right-style: dotted;background-color:silver"></td>
                        <td style="background-color:silver"></td>
                </tr>
                <tr>
                        <td>Specification</td>
                        <td style="border-right-style: dotted; background-color: white" >@Html.DisplayFor(Model => Model.Item2.FUN_Tspec_reg_l_plan)</td>
                        <td style="border-right-style: dotted; background-color: white">@Html.DisplayFor(Model => Model.Item2.FUN_Tspec_reg_m_plan)</td>
                        <td style="background-color: white">@Html.DisplayFor(Model => Model.Item2.FUN_Tspec_reg_s_plan)</td>
                </tr>
                <tr>
                        <td>Execution</td>
                        <td style="border-right-style: dotted; background-color: white">@Html.DisplayFor(Model => Model.Item2.FUN_TExe_reg_l_plan)</td>
                        <td style="border-right-style: dotted; background-color: white">@Html.DisplayFor(Model => Model.Item2.FUN_TExe_reg_m_plan)</td>
                        <td style=" background-color: white">@Html.DisplayFor(Model => Model.Item2.FUN_TExe_reg_s_plan)</td>
                </tr>
                </table>

                    <br />
                    <br />
                <h2> Testautomatisierung</h2>
                <table id="tabletry">
                <tr>
                        <th title="xx">Neue<br />Funktionalität</th>
                        <th title="xx">Anzahl geplant<br />hoch</th>
                        <th title="xx">Anzahl geplant<br />mittel</th>
                        <th title="xx">Anzahl geplant<br />gering</th>
                </tr>
                <tr>
                        <td>Specification</td>
                        <td style="border-right-style: dotted; background-color: white">@Html.DisplayFor(Model => Model.Item2.TAU_Tspec_nf_l_plan)</td>
                        <td style="border-right-style: dotted; background-color: white">@Html.DisplayFor(Model => Model.Item2.TAU_Tspec_nf_m_plan)</td>
                        <td style="background-color: white">@Html.DisplayFor(Model => Model.Item2.TAU_Tspec_nf_s_plan)</td>
                </tr>
                <tr>
                        <td>Execution</td>
                        <td style="border-right-style: dotted; background-color: white">@Html.DisplayFor(Model => Model.Item2.TAU_TEXe_nf_l_plan)</td>
                        <td style="border-right-style: dotted; background-color: white">@Html.DisplayFor(Model => Model.Item2.TAU_TExe_nf_m_plan)</td>
                        <td style="background-color: white">@Html.DisplayFor(Model => Model.Item2.TAU_TExe_nf_s_plan)</td>
                </tr>
                <tr>
                        <th>Regression</th>
                        <td style="border-right-style: dotted;background-color:silver"></td>
                        <td style="border-right-style: dotted;background-color:silver"></td>
                        <td style="background-color:silver"></td>
                </tr>
                <tr>
                        <td>Specification</td>
                        <td style="border-right-style: dotted; background-color: white" >@Html.DisplayFor(Model => Model.Item2.TAU_Tspec_reg_l_plan)</td>
                        <td style="border-right-style: dotted; background-color: white">@Html.DisplayFor(Model => Model.Item2.TAU_Tspec_reg_m_plan)</td>
                        <td style="background-color: white">@Html.DisplayFor(Model => Model.Item2.TAU_Tspec_reg_s_plan)</td>
                </tr>
                <tr>
                        <td>Execution</td>
                        <td style="border-right-style: dotted; background-color: white">@Html.DisplayFor(Model => Model.Item2.TAU_TExe_reg_l_plan)</td>
                        <td style="border-right-style: dotted; background-color: white">@Html.DisplayFor(Model => Model.Item2.TAU_TExe_reg_m_plan)</td>
                        <td style=" background-color: white">@Html.DisplayFor(Model => Model.Item2.TAU_TExe_reg_s_plan)</td>
                </tr>
                </table>
                    <br />
                    <br />
                <h2>Last&Performance Test</h2>
                <table id="tabletry">
                <tr>
                        <th title="xx">Neue<br />Funktionalität</th>
                        <th title="xx">Anzahl geplant<br />hoch</th>
                        <th title="xx">Anzahl geplant<br />mittel</th>
                        <th title="xx">Anzahl geplant<br />gering</th>
                </tr>
                <tr>
                        <td>Specification</td>
                        <td style="border-right-style: dotted; background-color: white">@Html.DisplayFor(Model => Model.Item2.LPT_Tspec_nf_l_plan)</td>
                        <td style="border-right-style: dotted; background-color: white">@Html.DisplayFor(Model => Model.Item2.LPT_Tspec_nf_m_plan)</td>
                        <td style="background-color: white">@Html.DisplayFor(Model => Model.Item2.LPT_Tspec_nf_s_plan)</td>
                </tr>
                <tr>
                        <td>Execution</td>
                        <td style="border-right-style: dotted; background-color: white">@Html.DisplayFor(Model => Model.Item2.LPT_TEXe_nf_l_plan)</td>
                        <td style="border-right-style: dotted; background-color: white">@Html.DisplayFor(Model => Model.Item2.LPT_TExe_nf_m_plan)</td>
                        <td style="background-color: white">@Html.DisplayFor(Model => Model.Item2.LPT_TExe_nf_s_plan)</td>
                </tr>
                <tr>
                        <th>Regression</th>
                        <td style="border-right-style: dotted;background-color:silver"></td>
                        <td style="border-right-style: dotted;background-color:silver"></td>
                        <td style="background-color:silver"></td>
                </tr>
                <tr>
                        <td>Specification</td>
                        <td style="border-right-style: dotted; background-color: white" >@Html.DisplayFor(Model => Model.Item2.LPT_Tspec_reg_l_plan)</td>
                        <td style="border-right-style: dotted; background-color: white">@Html.DisplayFor(Model => Model.Item2.LPT_Tspec_reg_m_plan)</td>
                        <td style="background-color: white">@Html.DisplayFor(Model => Model.Item2.FUN_Tspec_reg_s_plan)</td>
                </tr>
                <tr>
                        <td>Execution</td>
                        <td style="border-right-style: dotted; background-color: white">@Html.DisplayFor(Model => Model.Item2.LPT_TExe_reg_l_plan)</td>
                        <td style="border-right-style: dotted; background-color: white">@Html.DisplayFor(Model => Model.Item2.LPT_TExe_reg_m_plan)</td>
                        <td style=" background-color: white">@Html.DisplayFor(Model => Model.Item2.LPT_TExe_reg_s_plan)</td>
                </tr>
                </table>

                    <br />
                    <br />
                    <h2>Security Test</h2>
                <table id="tabletry">
                <tr>
                        <th title="xx">Neue<br />Funktionalität</th>
                        <th title="xx">Anzahl geplant<br />hoch</th>
                        <th title="xx">Anzahl geplant<br />mittel</th>
                        <th title="xx">Anzahl geplant<br />gering</th>
                     @*   <th title="xx">Aufwand geplant</th>*@
                </tr>
                <tr>
                        <td>Specification</td>
                        <td style="border-right-style: dotted; background-color: white">@Html.DisplayFor(Model => Model.Item2.SEC_Tspec_nf_l_plan)</td>
                        <td style="border-right-style: dotted; background-color: white">@Html.DisplayFor(Model => Model.Item2.SEC_Tspec_nf_m_plan)</td>
                        <td style="border-right-style: groove;background-color: white">@Html.DisplayFor(Model => Model.Item2.SEC_Tspec_nf_s_plan)</td>
                        @* <td style="background-color: white">@Html.DisplayFor(Model => Model.Item2.SEC_Tspec_Eff_plan)</td>*@
                </tr>
                <tr>
                        <td>Execution</td>
                        <td style="border-right-style: dotted; background-color: white">@Html.DisplayFor(Model => Model.Item2.SEC_TEXe_nf_l_plan)</td>
                        <td style="border-right-style: dotted; background-color: white">@Html.DisplayFor(Model => Model.Item2.SEC_TExe_nf_m_plan)</td>
                        <td style="border-right-style: groove;background-color: white">@Html.DisplayFor(Model => Model.Item2.SEC_TExe_nf_s_plan)</td>
                    @*    <td style="background-color: white">@Html.DisplayFor(Model => Model.Item2.SEC_TExe_Eff_plan)</td>*@
                </tr>
                <tr>
                        <th>Regression</th>
                        <td style="border-right-style: dotted;background-color:silver"></td>
                        <td style="border-right-style: dotted;background-color:silver"></td>
                        <td style="border-right-style: groove;background-color:silver"></td>
                    @*    <td style="border-right-style: groove;background-color:silver"></td>*@
                </tr>
                <tr>
                        <td>Specification</td>
                        <td style="border-right-style: dotted; background-color: white" >@Html.DisplayFor(Model => Model.Item2.SEC_Tspec_reg_l_plan)</td>
                        <td style="border-right-style: dotted; background-color: white">@Html.DisplayFor(Model => Model.Item2.SEC_Tspec_reg_m_plan)</td>
                        <td style="border-right-style: groove;background-color: white">@Html.DisplayFor(Model => Model.Item2.SEC_Tspec_reg_s_plan)</td>
                   @*     <td style="border-right-style: groove;background-color: white">@Html.DisplayFor(Model => Model.Item2.SEC_Tspec_Eff_plan)</td>*@
                </tr>
                <tr>
                        <td>Execution</td>
                        <td style="border-right-style: dotted; background-color: white">@Html.DisplayFor(Model => Model.Item2.SEC_TExe_reg_l_plan)</td>
                        <td style="border-right-style: dotted; background-color: white">@Html.DisplayFor(Model => Model.Item2.SEC_TExe_reg_m_plan)</td>
                        <td style=" background-color: white; border-right-style: groove">@Html.DisplayFor(Model => Model.Item2.SEC_TExe_reg_s_plan)</td>
                </tr>
                </table>
                </div>

    </div>

  }  

<div>
     @Html.ActionLink("Zurück", "Details", new { id = ViewData["pid"] })
</div> 
```

我用实体框架构建我的模型我有一个表'TRel'和一个表'Basedata'

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-25T14:32:46.943

**更新**

根据您的最后评论，我做了一些检查并发现以下内容。

1.  要以您的文化的默认短格式显示日期，您可以使用：

    ```
    Model.PlanBegPlan.Date.ToShortDateString() 
    ```

    或者，您可以使用以下内容，因此格式将不依赖于区域设置：

    ```
    Model.PlanBegPlan.Date.ToString("dd.MM.yyyy") 
    ```

    这也可以包装在 a`@Html.Display`中，如下所示，但不是 a `@Html.DisplayFor`，因为后者需要 lambda 返回一个字段或属性，并且上述两个都返回字符串值。

    ```
    @Html.Display(Model.PlanBegPlan.Date.ToString("dd.MM.yyyy")) 
    ```

2.  另一个选项是使用属性上的 DisplayFormat 属性来指定模型上的日期格式`Date`。

    ```
    [DisplayFormat(DataFormatString = "{0:dd.MM.yyyy}", ApplyFormatInEditMode = true)]
    public DateTime Date { get; set; } 
    ```

    然后在视图中你可以放：

    ```
    @Html.DisplayFor(m => m.PlanBegPlan.Date) 
    ```

    此选项允许您使用`DisplayFor`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-25T18:12:15.160

试试下面的：

```
@Html.DisplayFor(Model => Model.PlanBegPlan.Date.ToString("MM/dd/yyyy")) 
```

[更多参考](https://stackoverflow.com/questions/7124434/display-only-date-and-no-time-c-sharp)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-25T14:33:04.247

[`ToShortDateString`](http://msdn.microsoft.com/en-us/library/system.datetime.toshortdatestring.aspx) 在您拥有的日期时间对象上使用方法。

```
@Html.DisplayFor(Model => Model.PlanBegPlan.Date.ToShortDateString()) 
```

该`ToShortDateString`方法返回的字符串是区域性的。它反映了当前区域性`DateTimeFormatInfo`对象定义的模式。例如，对于 en-US 文化，标准的短日期模式是“ `M/d/yyyy`”；对于 de-DE 文化，它是“ `dd.MM.yyyy`”；对于 ja-JP 文化，它是“ `yyyy/M/d`”。

# image - R 图像分色和颜色

> ID：15617338
> 
> 赞同：1
> 
> 时间：2013-03-25T14:23:32.407
> 
> 标签：image, r, colors

在 R 图像中，我试图更改中断和颜色，当我的图像值高于 20 时，它必须保持红色。（在我目前的情况下，它变成白色）

```
 colors <- colorpanel(30, "green","red")
  colbreaks <- seq(1,20, length=length(colors)+1) 
```

使用 gplot 中的颜色面板来使用绿色和红色。我的值大多是 1-15，有时高于 20，但因为我想保持差异可见，所以我想限制 20。在我的脚本中，当值为 21 或更高时，正方形变为白色。我怎样才能抓住它，让它保持红色？复制：

```
test123 <- structure(c(2,7,3,18,22,25,12,1), .Dim = c(2L,4L))  
colors <- colorpanel(30, "green","red")  
colbreaks <- seq(1,20, length=length(colors)+1)
image(test123, col=colors, breaks=colbreaks) 
```

![](../Images/4ede606741d2cd163085e388cd4b22f0.png) 图像中的两个白色方块的值是 22 和 25。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-25T14:47:24.427

您还需要定义最后一个断点 (25)。这应该有效：

```
test123 <- structure(c(2,7,3,18,22,25,12,1), .Dim = c(2L,4L))  
colors <- colorpanel(20, "green","red")  
colbreaks <- c(seq(1,20, length=length(colors)),max(test123)) #add the last point
image(test123, col=colors, breaks=colbreaks) 
```

这里 20 到 20 之间的所有内容`max(test123)`都用相同的颜色着色（最后一个值来自`colors`）。

# javascript - Javascript + 基本对象文字范围问题

> ID：15617340
> 
> 赞同：0
> 
> 时间：2013-03-25T14:23:43.877
> 
> 标签：javascript, object-literal

我知道这是非常基本的，但是为什么 x 在这个代码块中返回 undefined 呢？有没有办法定义一个属性并立即使用它来设置另一个属性？

```
 var grid = {
        x : 75,
        y : 75,
        location : [grid.x, grid.y],                
        init : function () {
            console.log(grid.location[0]);
        }
    } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-25T14:38:24.347

在将对象分配给变量之前，您不能使用该变量访问对象的属性。创建对象时，变量`grid`仍未定义。在创建对象时，您没有对它的任何引用。

将对象分配给变量后，您可以使用这些属性：

```
var grid = {
    x : 75,
    y : 75,
    init : function () {
        console.log(grid.location[0]);
    }
}

grid.location = [grid.x, grid.y]; 
```

您还可以将其包装在函数表达式中以获取返回完整对象的代码：

```
var grid =
  (function(){

    var obj = {
      x : 75,
      y : 75,
      init : function () {
        console.log(grid.location[0]);
      }
    };
    obj.location = [obj.x, obj.y];

    return obj;

  })(); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-25T14:25:43.683

> 有没有办法定义一个属性并立即使用它来设置另一个属性？

[不](https://stackoverflow.com/a/9873893/139010)，但是，您可以[使用 getter](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Operators/get)，它或多或少是函数的语法糖：

```
var grid = {
    x : 75,
    y : 75,
    get location() {
        return [this.x, this.y];
    },                
    init : function () {
        console.log(grid.location[0]);
    }
} 
```

[http://jsfiddle.net/mattball/erUJj](http://jsfiddle.net/mattball/erUJj)

这个答案总结了各种选项：[https ://stackoverflow.com/a/15486618](https://stackoverflow.com/a/15486618)

# php - 使用用户定义的字符串对帖子进行客户端加密

> ID：15617343
> 
> 赞同：0
> 
> 时间：2013-03-25T14:23:57.550
> 
> 标签：php, javascript, encryption

我需要在他们的帖子中向我的用户提供隐私保证。

这些帖子是由 tinyMCE 生成的经典 HTML。

我需要用户在保存帖子之前定义他们的加密字符串。我应该能够根据他们的字符串加密 html 内容并将其通过网络发送以存储在数据库中。这样我想我可以向他们保证，除非我知道他们的密钥，否则即使我也无法阅读他们的帖子。

当他们请求他们的帖子时，他们应该提供他们的字符串以便能够正确查看它。

这种情况下最好的方法是什么？

# batch-file - Windows Batch - 文本文件中的随机行

> ID：15617345
> 
> 赞同：1
> 
> 时间：2013-03-25T14:24:01.007
> 
> 标签：batch-file

我无法让以下事情正常工作。我有一个 400 行并且还在增长的文本文件。我需要一个批处理脚本，从该文件中选择一个随机行。

我试图修改一些执行随机化的代码，但有时它会选择一个大于 400 的数字并且脚本返回错误：

```
set "file=C:\Users\User\Desktop\resolutions.txt"
for /f %%N in ('findstr "." "%file%"^|find /c /v ""') do set lines=%%N
set /a "iterations=%random% %% 1 + 1"

set /a randomfixed = %random% * %Lines% / 32767 + 1

for /f "skip=%randomfixed% tokens=* delims=" %%j IN (C:\Users\User\Desktop\useragents.txt) do (
set /a N+=1
    set var!N!=%%j
)
@echo %var1% 
```

我想有一个更简单的方法来处理这个？任何帮助表示赞赏！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-25T15:35:01.473

尝试这个：

```
@echo off &setlocal
set /a count=0
for /f "tokens=1delims=:" %%i in ('findstr /n "^" "file.txt"') do set /a count=%%i
set /a rd=%random%%%count
if %rd% equ 0 (set "skip=") else set "skip=skip=%rd%"
set "found="
for /f "%skip%tokens=1*delims=:" %%i in ('findstr /n "^" "file.txt"') do if not defined found set "found=%%i"&set "var=%%j"
echo.random line %found%: %var%
endlocal 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-25T15:23:37.060

`%RANDOM%`返回 0 到 32767 之间的随机十进制数 ...

通过将 0 和 32767 代入以下内容*（代替 %random%）*，这似乎是您需要从 1 到 400（含）的值：

`SET /a randomfixed = 1 + (%random% * (400-1) / 32767)`
*（您的版本给出的结果从 1 到 401）*

# ruby - 分叉 WEBrick 并等待启动

> ID：15617347
> 
> 赞同：5
> 
> 时间：2013-03-25T14:24:06.533
> 
> 标签：ruby, process, fork, webrick

我有以下代码，其中一个 WEBrick 实例是分叉的，我想等到 webrick 启动，然后再继续其余代码：

```
require 'webrick'

pid = fork do
  server = WEBrick::HTTPServer.new({:Port => 3333, :BindAddress => "localhost"})
  trap("INT") { server.shutdown }
  sleep 10 # here is code that take some time to setup
  server.start
end
# here I want to wait till the fork is complete or the WEBrick server is started and accepts connections
puts `curl localhost:3333 --max-time 1` # then I can talk to the webrick
Process.kill('INT', pid) # finally the webrick should be killed 
```

那么我怎样才能等到分叉完成，或者甚至更好地等到 WEBrick 准备好接受连接？我找到了一段代码，他们在其中处理一个`IO.pipe`和一个读者和一个作家。但这不会等待 webrick 加载。

不幸的是，我没有找到任何关于这个特定案例的东西。希望有人可以提供帮助。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-03-25T15:11:51.910

`WEBRick::GenericServer`有一些未记录的回调钩子（**遗憾的是，事实上，整个 webrick 库的记录很差！**），例如[`:StartCallback`](https://github.com/nahi/webrick/blob/master/lib/webrick/server.rb#L92), [`:StopCallback`](https://github.com/nahi/webrick/blob/master/lib/webrick/server.rb#L122), [`:AcceptCallback`](https://github.com/nahi/webrick/blob/master/lib/webrick/server.rb#L190). `WEBRick::HTTPServer`您可以在初始化实例时提供挂钩。

因此，结合`IO.pipe`，您可以像这样编写代码：

```
require 'webrick'

PORT = 3333

rd, wt = IO.pipe

pid = fork do
  rd.close
  server = WEBrick::HTTPServer.new({
    :Port => PORT,
    :BindAddress => "localhost",
    :StartCallback => Proc.new {
      wt.write(1)  # write "1", signal a server start message
      wt.close
    }
  })
  trap("INT") { server.shutdown }
  server.start
end

wt.close
rd.read(1)  # read a byte for the server start signal
rd.close

puts `curl localhost:#{PORT} --max-time 1` # then I can talk to the webrick
Process.kill('INT', pid) # finally the webrick should be killed 
```

# php - 使用存储过程时出现php错误

> ID：15617348
> 
> 赞同：2
> 
> 时间：2013-03-25T14:24:09.047
> 
> 标签：php, mysql, stored-procedures

我有一个带有 4 个菜单（产品、供应商、采购、客户）的 php 代码。每个菜单都有自己的存储过程。每个meanu都有这些代码：

产品代码：

```
<?php
$sql=$mysqli->query("call selectproducts()");
$i=1;
while($row=mysqli_fetch_array($sql)){
    $id=$row['prodid'];
    $date=$row['prodname'];
    $item=$row['proddescription'];
    $qtyleft=$row['prodsupplier'];
    $qty_sold=$row['proddate'];
    $price=$row['prodprice'];
    $sales=$row['prodquantity'];
    if($i%2){
?>
<tr id="<?php echo $id; ?>" class="edit_tr">
<?php } else { ?>
<tr id="<?php echo $id; ?>" bgcolor="#f2f2f2" class="edit_tr">
<?php } ?>
<td class="edit_td"><span class="text"><?php echo $date; ?></span> </td>
<td><span class="text"><?php echo $item; ?></span> </td>
<td><span class="text"><?php echo $qtyleft; ?></span></td>
<td><span id="last_<?php echo $id; ?>" class="text">
<?php
   echo $qty_sold;
?> 
```

我的问题是，每当我尝试在其他菜单甚至 1 个菜单中使用存储过程时，其他方式（供应商、采购、客户）都会出现此错误：

```
Warning: mysqli_fetch_array() expects parameter 1 to be mysqli_result, boolean given 
```

简而言之，如果我只包含一个 (1) 存储过程，则会发生错误。唯一能正常工作的是，当我以正常方式使用它时（SELECT * from table）。

可能是什么问题？请帮助我..这是我项目中唯一的问题。

Mysql存储过程代码：

```
CREATE DEFINER=`root`@`localhost` PROCEDURE `selectproducts`()
begin
select * from products order by ProdID;
end 
```

这是完整的代码：http: [//jsfiddle.net/WKKD4/](http://jsfiddle.net/WKKD4/)

对不起，我没有其他地方可以放它。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-25T14:44:19.930

MySQL 过程不返回结果集。您可以从 MySQL 过程访问结果的方式如下。

```
CREATE PROCEDURE selectproducts (OUT ver_param VARCHAR(25))
BEGIN
  # Set value of OUT parameter
  SELECT count(ProdId)  INTO ver_param from products;
END; 
```

现在要访问 PHP 脚本中的输出，请在过程调用后立即执行以下查询。

```
$sql = $mysqli->query("call selectproducts(@productcount)");
$results = $mysqli->query ("select @productcount as COUNT");
$rows = mysqli_fetch_array($results); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-28T07:53:41.227

试试这个：

**

```
$sql->close();
$mysqli->next_result(); 
```

**

在获取结果后放置它并查看魔术。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-25T14:43:02.430

尝试对您的代码进行此更改：

```
<?php

    $result = $mysqli->query("call selectproducts()");
    $i=1;
    while($row = $result->fetch_assoc()){
        $id=$row['prodid'];
        $date=$row['prodname'];
        $item=$row['proddescription'];
        $qtyleft=$row['prodsupplier'];
        $qty_sold=$row['proddate'];
        $price=$row['prodprice'];
        $sales=$row['prodquantity'];
        if($i%2){
    ?>
    <tr id="<?php echo $id; ?>" class="edit_tr">
    <?php } else { ?>
    <tr id="<?php echo $id; ?>" bgcolor="#f2f2f2" class="edit_tr">
    <?php } ?>
    <td class="edit_td"><span class="text"><?php echo $date; ?></span> </td>
    <td><span class="text"><?php echo $item; ?></span> </td>
    <td><span class="text"><?php echo $qtyleft; ?></span></td>
    <td><span id="last_<?php echo $id; ?>" class="text">
    <?php
       echo $qty_sold;
    ?> 
```

这是一个微小的变化，但它应该有效。

--------已编辑---------

仅用于调试，将代码替换为：

```
$rs = $mysqli->query("call selectproducts();");
while($row = $rs->fetch_object())
{
var_dump($row);
} 
```

--------- EDIT2------------

继续调试的东西......创建一个名为 test.php 的新 php 脚本......把这段代码放进去：

```
 <?php
  include('db.php');

  $query = "call selectproducts()";

  if ($result = $mysqli->query($query)) {

      /* obtener array asociativo */
      while ($row = $result->fetch_assoc()) {
          echo $row['prodid']."------".$row["prodname"])."</br>";
      }

      /* liberar el resultset */
      $result->free();
  }

?> 
```

如果这以正确的方式显示您的数据，那么您的问题不在这里。你能发布这个脚本的结果吗？

萨卢多斯 ;)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-25T14:46:39.013

您将获得多个结果。SELECT 的结果以及调用的结果。

要获得“下一个”结果，您必须调用：

```
<?php

  // Assuming $connection is your MySQLI object

  while($connection->next_result()) $connection->store_result();

?> 
```

# c# - 使用 Google Apps 帐户从网站发送电子邮件

> ID：15617354
> 
> 赞同：0
> 
> 时间：2013-03-25T14:24:19.237
> 
> 标签：c#, gmail

一直在研究这个问题，但还没有找到任何解决方案。

我可以使用我的常规 gmail 帐户（使用 smtp.gmail.com 作为我的主机和端口 587）从网站发送电子邮件。

我目前的问题是发送邮件没有问题。我不再收到错误。但是，电子邮件永远不会发送。有人有想法么？

这是代码：

**配置：**

```
<smtp from="admin@domain.com">
<network host="smtp.gmail.com" password="password" userName="admin@domain.com" port="587"/>
</smtp> 
```

**代码：**

```
 public void Send() {

        bool bDev = ConfigurationManager.AppSettings["dev"] == "true";

        MailMessage oMsg = new MailMessage();

        foreach (string sAddress in To) {
                if (sAddress != "") oMsg.To.Add(sAddress);
        }

        oMsg.From = ((FromName == null) || (FromName == "")) ?
                    new MailAddress(From) :
                    new MailAddress(From, FromName);
        oMsg.Subject = Subject;

        oMsg.Body = Body.ToString();
        oMsg.IsBodyHtml = true;

        oMsg.BodyEncoding = Encoding.UTF8;
        SmtpClient smtp = new SmtpClient();
        smtp.EnableSsl = (new int[] { 587, 465 }).Contains(smtp.Port);
        smtp.Send(oMsg);
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-25T15:39:34.057

我添加了第二个地址并恢复测试。我开始收到两个帐户的电子邮件。然后在删除第二个地址后，它开始工作。

我遇到了一个新问题，我的回复地址使用的是发件人地址。因此，我添加了额外的代码，将回复地址设置为表单中此人的电子邮件地址。

代码

```
 if (!string.IsNullOrEmpty(ReplyToAddress))
        oMsg.ReplyTo = new MailAddress(ReplyToAddress); 
```

但是，我遇到了 Gmail 忽略我定义的回复地址并使用我的发件人地址的问题。显然这是设计使然。我找不到有关如何覆盖此设置的任何有用信息，因此我做了一个变通方法，可能证明对遇到此问题的其他人有帮助。

我使用 gmail (website@gmail.com) 创建了一个通用电子邮件地址并设置了一个过滤器。来自 admin@domain.com 的任何电子邮件都需要重定向到 admin@domain.com。

现在，当我运行我的测试时，所有的电子邮件都在它们应该去的地方，并且对字段的回复效果很好。

不是最好的解决方案，因为它涉及到我每次遇到这个问题时都要记住设置一个新帐户，但它是一个暂时有效的解决方案，直到出现更好的替代方案。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-25T14:38:01.067

有完全相同的问题，没有发生错误，但也没有发送电子邮件。Google 有时会阻止您的帐户（通常在测试期间）。尝试登录 gmail 帐户并查看它的内容。

UPD1：还要检查您在 gmail 中发送的文件夹。

UPD2：还要确保“发件人”电子邮件与您的 gmail 电子邮件地址相同。

# javascript - 如何获取被JavaScript改变的代码中元素的样式

> ID：15617358
> 
> 赞同：0
> 
> 时间：2013-03-25T14:24:23.477
> 
> 标签：javascript, asp.net, visibility, code-behind

我有一些最初不可见的 ASP.NET 表行。单击时，我正在运行一个 Javascript 函数，该函数正在更改显示或隐藏它的表格行的样式。

要显示它：

```
document.getElementById(id).style.display = ""; 
```

隐藏它：

```
document.getElementById(id).style.display = "none"; 
```

这有效。

问题是，当且仅当行可见时，我才需要对行的内容进行一些过滤。

在样式后面的代码中，保持设计的状态并且不采用当前状态。

如果元素可见与否，获取信息的最佳方法是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-25T14:41:05.737

当您运行该 JavaScript 时，您需要更改服务器控件中某些内容的值（这将使用新值回发到服务器）。如果您还没有任何东西，您可以使用像 HiddenField 控件这样简单的东西。

因此，您可以将其添加到您的标记中：

```
<asp:HiddenField ID="isRowShowing" Value="True" runat="server" /> 
```

然后在您的 JavaScript 函数中执行此操作：

```
//To show
document.getElementById(id).style.display = "";
document.getElementById('<%= isRowShowing.ClientID %>').value = "True";

//To Hide
document.getElementById(id).style.display = "none";
document.getElementById('<%= isRowShowing.ClientID %>').value = "False"; 
```

然后你可以在后面的代码中检查它：

```
if(isRowShowing.Value == "True")
{
    // Do stuff
}
else
{
    // Do other stuff.  Or don't do stuff.  Whatevs.
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-25T14:52:33.717

To show it:

```
document.getElementById(id).style.display="inline"; 
```

To hide it:

```
document.getElementById(id).style.display="none"; 
```

To check it:

```
if(document.getElementById(id).style.display=="inline") {
    //Do your stuff
    } 
```

Or am I missing something?

# css - 如何防止内容出现 - 响应式网页设计

> ID：15617359
> 
> 赞同：0
> 
> 时间：2013-03-25T14:24:26.427
> 
> 标签：css, twitter-bootstrap, responsive-design

是否可以根据设备的大小防止某些数据出现？例如，我正在删除一个表格 - 我正在将其更改为由`<div>`标签组成的网格。

如果用户在桌面上，我希望能够显示如下内容：

```
<div class="row show-grid" id="tblheading" naming="tblheading">
        <div class="span1">Branch</div>
        <div class="span1">Branch Name</div>
        <div class="span1">Building</div>
        <div class="span1">Building Name</div>
        <div class="span1">Room</div>
        <div class="span1">Asset Name</div>
    </div>
    <div class="row show-grid">
        <div class="span1">CAN</div>
        <div class="span1"></div>
        <div class="span1">CAN-Building1</div>
        <div class="span1"></div>
        <div class="span1">CAN-Building1-Room1</div>
        <div class="span1">Value 123</div>
    </div>
    <div class="row show-grid">
        <div class="span1">CAN</div>
        <div class="span1"></div>
        <div class="span1">CAN-Building2</div>
        <div class="span1"></div>
        <div class="span1">CAN-Building2-Room1</div>
        <div class="span1">Value xyz</div>
    </div> 
```

但如果它们在移动设备上，我不想显示带有标题的第一“行”。如果可能的话，我还想删除其他一些字段，只显示移动设备的资产名称。我只是响应式设计的新手，所以对于任何补救问题我深表歉意。如果您能指出我正确的方向，我将不胜感激。

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-25T14:27:27.017

这只是将一个类添加到您想要隐藏的行/单元格然后将该类设置为 display: none 在针对移动设备的媒体查询中的一种情况。我认为 twitter 引导程序甚至已经内置了这样的类，但不记得确切的名称。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-25T14:27:43.047

如果您在 Bootstrap 文档中查看[此处](http://twitter.github.com/bootstrap/scaffolding.html#responsive)，它会讨论为此的内置类。

![在此处输入图像描述](../Images/581b4b6fc6ea47718e167bed97d4067d.png)

您可以使用这些类根据屏幕大小显示和隐藏列或行。如果差异足够大，您可以创建多个表并为每种尺寸显示适当的表。

# linux - 转储和丢弃特定应用程序的网络数据包的最佳方法是什么？

> ID：15617363
> 
> 赞同：2
> 
> 时间：2013-03-25T14:24:47.133
> 
> 标签：linux, networking, tcp, iptables

我想转储特定应用程序的所有网络数据包（IP 数据包），然后丢弃它们（就像一个哑 NIC），这样实际上没有数据包通过 NIC。所有这些都是在没有应用程序意识的情况下完成的。（这意味着应用程序认为包发送成功，但实际上它们被丢弃了。）

我这样做是为了将转储的数据发送到另一台机器并重新发送这些包，只需稍作修改。

平台是 Linux，我认为必须有一些不错的方法来做到这一点，例如使用 iptables、netfilter 或 tap/tun。问题是倾倒和丢弃应该只针对一个应用程序进行。在这种情况下如何设置规则？

不得已的方法是修改内核并添加一些接口供应用程序调用。我希望这不是唯一的方法。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-16T12:52:58.603

如果您可以启动该过程，则：

1) 使用 lxc (Linux Containers) 将应用程序放在它自己的网络命名空间中。您可以仅为该容器设置 netfilter 规则。哎呀，如果你愿意，你可以给应用程序它自己的 IP 地址。

```
/usr/bin/lxc-execute -n app_container -f my_net_lxc.conf your_application 
```

2）正如吴指出的，您可以使用 LD_PRELOAD 覆盖标准库。只需将它指向一些包装函数，您就可以拦截来自应用程序的所有调用。

```
LD_PRELOAD=/usr/lib/mylib.so your_application
# See here for info: https://github.com/wh5a/ld_preload 
```

3) 正如 Giles 指出的，您可以使用 iptables。您必须仅为该应用程序创建一个特殊用户。

```
# Setup: Add a user and give him some rules
adduser --shell /bin/false --no-create-home tempuser
iptables -A OUTPUT -m owner --uid-owner tempuser -j ACCEPT
# Run your app
sudo -u tempuser your_application 
```

4) 您可以在 VM 技术下运行应用程序，例如用户模式 ​​Linux 或 QEMMU，这为应用程序提供了一个完整的内核，您可以在多个级别上修改/控制。

如果您没有启动该进程，您仍然可以使用 ptrace 附加到该进程。这使您可以检查进程进行的每个系统调用。

# java - getServletContext().getRealPath() 在控制器（NPE）中不起作用，但在 jsp 中起作用

> ID：15617365
> 
> 赞同：5
> 
> 时间：2013-03-25T14:24:53.103
> 
> 标签：java, spring-mvc, itext, relative-path, realpath

我正在尝试将图像添加到我的 pdf 文件中。图片位于“WebContent/img/image.png”中。首先，我将相对路径保存为字符串，然后将此相对路径转换为真实路径。

```
String relativeWebPath = "/img/image.png";
String absoluteDiskPath = getServletContext().getRealPath(relativeWebPath);
Image image1 = Image.getInstance(absoluteDiskPath); 
```

甚至这个

```
String absoluteDiskPath = getServletContext().getRealPath("/"); 
```

不起作用。

我在定义相对路径时尝试了一些变体，但无法使它们中的任何一个起作用。`String absoluteDiskPath = getServletContext().getRealPath(relativeWebPath);`当这条线试图执行时，我总是得到 nullPointerException 。我在相对路径或其他方面做错了吗？我不知道这是否相关，但我正在使用**Spring**。

```
@RequestMapping(value = "/exportPhonebook.html", method = RequestMethod.POST)
public void exportPhonebook(Model model, HttpServletResponse response) {
    try {
        setResponseHeaderPDF(response);
        Document document = new Document();
        ByteArrayOutputStream baosPDF = new ByteArrayOutputStream();
        PdfWriter pdfWriter = null;
        pdfWriter = PdfWriter.getInstance(document, baosPDF);
        PageNumbersEventHelper events = new PageNumbersEventHelper();
        pdfWriter.setPageEvent(events);
        document.open();
        addMetaData(document);
        addTitlePage(document);
        String relativeWebPath = "/img/image.png";
        String absoluteDiskPath = getServletContext().getRealPath(relativeWebPath);
        Image image1 = Image.getInstance(absoluteDiskPath);
        document.add(image1);
        addContent(document);
        document.close();
        pdfWriter.close();
        OutputStream os = response.getOutputStream();
        baosPDF.writeTo(os);
        os.flush();
        os.close();
    } catch (Exception e) {
        e.printStackTrace();
    }
} 
```

这是我在jsp中使用它的方式：

```
<input type="hidden" value="<%=getServletContext().getRealPath("/") %>" name="path"> 
```

我将它传递给控制器​​并将相对路径添加到该路径。

```
path = path + "img\\image.png";
Image image = Image.getInstance(path); 
```

这工作得很好。我不明白为什么这在我的控制器中不起作用。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-03-26T14:06:18.057

我错过了这个：

`ServletContext servletContext = request.getSession().getServletContext();`

现在它可以从控制器工作。

```
ServletContext servletContext = request.getSession().getServletContext();
String relativeWebPath = "img/image.png";
String absoluteDiskPath = servletContext.getRealPath(relativeWebPath); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-25T14:36:43.793

尝试从`/WEB-INF/`文件夹开始您的相对路径，因为`/img/image.png`可以在文件夹结构中的多个位置，那么您如何获得绝对路径。

请参阅有关[getRealPath()](http://docs.oracle.com/javaee/6/api/javax/servlet/ServletContext.html#getRealPath%28java.lang.String%29)的文档状态：

> 如果 servlet 容器无法将给定的虚拟路径转换为真实路径，则此方法返回 null。

这意味着您应该在使用它之前检查返回的值。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-05-15T13:17:39.550

[http://ananthkannan.blogspot.ru/2009/12/servletcontextgetrealpath-returns-null.html](http://ananthkannan.blogspot.ru/2009/12/servletcontextgetrealpath-returns-null.html)

当 webapp 部署为 WAR 时 weblogic 的另一个奇怪行为。ServletContext.getRealPath() 在部署为 WAR 时返回 null，但在部署为分解时它可以正常工作。当您仍想部署为 WAR 但想解决此问题时，我们可以通过两种方法解决此问题： 1\. 转到服务器管理控制台-> 域-> Web 应用程序。单击已启用存档真实路径的复选框。这应该在域 config.xml 中创建一个条目，如下所示。真的

2.  第二个选项是在 webapp 级别，通过如下更新 weblogic.xml： true Web 应用程序中设置的值优先于域级别设置的值。此属性的默认值为 false。

# c# - 在 monoTouch 中格式化大量数据

> ID：15617372
> 
> 赞同：0
> 
> 时间：2013-03-25T14:25:14.037
> 
> 标签：c#, iphone, ios, xamarin.ios, xamarin-studio

因此，在我当前的项目中，我下载了一个包含大量数据的大型文本文件。现在我必须搜索该文件并检查它是否包含用户输入的数字。在objective-c中，这看起来像这样：

```
 NSString *securityCodeData = [[NSUserDefaults standardUserDefaults] stringForKey:@"securityCodeData"];

        NSString *trackTraceFileUrlName = [NSString stringWithFormat:@"http://plex.janssen1877.com/app/life/%@",securityCodeData];
        NSData *tmpData = [NSData dataWithContentsOfURL:[NSURL URLWithString:trackTraceFileUrlName] ];

        //convert data to string
        NSString *tmpString = [[NSString alloc] initWithData:tmpData encoding:NSUTF8StringEncoding];
        NSArray *piecesArray = [tmpString componentsSeparatedByString:@"\n"];
        NSMutableArray *trackTraceContent = [NSMutableArray arrayWithArray:piecesArray];
        NSLog(@"RAW:%@",trackTraceContent);

        /*Filtering array for referance*/
        NSPredicate *findStringWithReference = [NSPredicate predicateWithFormat:@"SELF CONTAINS [cd] %@",cRText.text];
        NSArray *trackTraceContentFiltered = [trackTraceContent filteredArrayUsingPredicate:findStringWithReference];
        NSLog(@"Filtered:%@",trackTraceContentFiltered);

    if ([trackTraceContentFiltered count] == 0) {
        UIAlertView *invalidCode = [[UIAlertView alloc] initWithTitle:@"Enter a valid reference number!"
                                                              message:@"Please enter a valid reference number so we can provide the correct information for you."
                                                             delegate:nil
                                                    cancelButtonTitle:@"Close"
                                                    otherButtonTitles:nil];
        [invalidCode show];

    } 
```

在 monoTouch 中执行此操作的最佳方法是什么？我已经尝试了一些代码，但它仍然不正确：

```
void GetTrackTraceData ()
        {

            //Collecting Trace and Trace data from link + security code and converting Track and Trace data into string
            string TracTraceDataString = NSString.FromData (NSData.FromUrl 
                                                    (NSUrl.FromString ("http://plex.janssen1877.com/app/life/" + NSUserDefaults.StandardUserDefaults ["SecurityToken"])), 
                                                     NSStringEncoding.UTF8);

            //Seperating the string and putting each object in the
            string[] TrackTraceDataArray = TracTraceDataString.Split (new char[] { '\n' });

            var TrackTraceFilteredArray = TrackTraceDataArray.Where (x => x.Contains (RefNr.Text));

            if (TrackTraceFilteredArray == null) {

                UIAlertView InvalidAlert = new UIAlertView ("Reference number invalid", "The reference number that you have entered is not linked to the current security code. You can change your security code in the settings.", null, "OK", null);
                InvalidAlert.Show ();
            }else{
                this.PerformSegue ("PushToTrackTraceDetails", this);
            }

            foreach (string s in TrackTraceFilteredArray)
                Console.WriteLine (s);

        } 
```

由于某种原因，TrackTraceFilteredArray 永远不会为空。还是我必须以不同的方式实现它？这段代码是否正确编写？我是 c#/MonoTouch 的新手，所以我认为它可能需要一些优化。以下是存储在文本文件中的数据示例：

```
51405199 0001055479      1302180721 210005     dossier aangemaakt EDI                                                                 
51403415 0001049498      1302150503 TOMTOM101  Order 51403415-3-278065601: ontvangen                                                  
51403415 0001049498      1302151106 TOMTOM241  Order 51403415-3-278065601: gestart                                                    
51403415 0001049498      1302151106 TOMTOM249  Order 51403415-3-278065601: voltooid                                                   
51403577 0001051919      1302150503 TOMTOM101  Order 51403577-3-278065601: ontvangen                                                  
51403577 0001051919      1302151027 TOMTOM241  Order 51403577-3-278065601: gestart                                                    
51403577 0001051919      1302151039 TOMTOM241  Order 51403577-3-278065601: geschatte aankomst 10:57, 18 km op be                      
51403577 0001051919      1302151106 TOMTOM249  Order 51403577-3-278065601: voltooid                                                   
51404608 EK1000204732540 1302151708 TOMTOM101  Order 51404608-2-477100892: ontvangen                                                  
51404608 EK1000204732540 1302151708 TOMTOM101  Order 51404608-3-477100892: ontvangen                                                  
51404772 0001052637      1302150520 210005     dossier aangemaakt EDI                                                                 
51404772 0001052637      1302151732 TOMTOM101  Order 51404772-3-278065684: ontvangen                                                  
51404773 0001052688      1302150520 210005     dossier aangemaakt EDI                                                                 
51404773 0001052688      1302151732 TOMTOM101  Order 51404773-3-278065684: ontvangen                                                  
51404774 0001053872      1302150521 210005     dossier aangemaakt EDI                                                                 
51404775 0001053872      1302150521 210005     dossier aangemaakt EDI                                                                 
51404776 0001052689      1302150521 210005     dossier aangemaakt EDI                                                                 
51404777 0001052690      1302150530 210005     dossier aangemaakt EDI                                                                 
51404778 0001053934      1302150630 210005     dossier aangemaakt EDI                                                                 
51404778 0001053934      1302151733 TOMTOM101  Order 51404778-3-278065681: ontvangen                                                  
51404779 0001053934      1302150630 210005     dossier aangemaakt EDI                                                                 
51404779 0001053934      1302151733 TOMTOM101  Order 51404779-3-278065690: ontvangen                                                  
51404780 0001053934      1302150630 210005     dossier aangemaakt EDI                                                                 
51404780 0001053934      1302151733 TOMTOM101  Order 51404780-3-278065691: ontvangen 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-25T15:34:51.193

LINQ`Where`子句不返回 1 或 null 项，它返回`IEnumerablestring>`0 或更多元素（这也意味着变量名 'TrackTraceFilteredArray' 不正确，因为它不是数组）。

解决此问题的一种方法是创建一个列表并检查计数：

```
var list = new List<string> (TrackTraceFilteredArray);
if (list.Count == 0) {
    // invalid
} else {
    // ok
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-04T18:56:50.880

而不是使用 Where，似乎你想要 Any。如果找到任何匹配项，则 Any 返回一个布尔值。这样您就不必检查计数。

# windows - VB6代码查找windows操作系统版本

> ID：15617375
> 
> 赞同：2
> 
> 时间：2013-03-25T14:25:18.257
> 
> 标签：windows, vb6

我正在使用[OSVERSIONINFO](http://msdn.microsoft.com/en-us/library/windows/desktop/ms724834%28v=vs.85%29.aspx)检查我的 vb6 应用程序中的操作系统。但我无法区分 Windows 7 和 Windows Server 2008 R2，因为它们具有相同的版本号、dwMajorVersion 和 dwMinorVersion。那么如何区分这些。我认为可以使用其他方法在 vb.net 中完成。但是如何在 vb6 中完成呢？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-26T02:30:22.603

正如 Xearinox 在上述评论中指出的那样，`OSVERSIONINFOEX`返回更多信息。

特别是，您可以检查`wProductType`以确定是否`VER_NT_WORKSTATION`设置了 (0x0000001)。如果是，则机器正在运行客户端操作系统，否则为服务器。

[OSVERSIONINFO MSDN 条目](http://msdn.microsoft.com/en-us/library/windows/desktop/ms724834%28v=vs.85%29.aspx)的备注部分中的图表甚至有一列指出使用该结构项检测各种操作系统。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-27T09:33:03.617

右键单击工具栏 > 组件并添加 > Microsoft SysControl 6.0。双击 SysInfo 按钮以添加到表单并使用此代码

```
Private Sub Form_Load()
    Dim HancyRockz as string
    HancyRockz = "OsVersion :- " & SysInfo1.OSVersion & " / Built " & SysInfo1.OSBuild
    Text1.Text=HancyRockz
End Sub 
```

# android - onSwipe（int方向）不起作用

> ID：15617377
> 
> 赞同：0
> 
> 时间：2013-03-25T14:25:23.777
> 
> 标签：android, swipe-gesture

我无法覆盖 onSwipe() 方法。错误是“Adds 类型的 onSwipe(int) 方法必须覆盖或实现超类型方法”。谁能告诉我我做错了什么？我想使用滑动手势在活动之间导航。还有其他方法吗？如果是这样，请解释。我必须导入更多的包吗？

```
package com.mahavega.qcdemo;

import com.mahavega.qcdemo.R;
import android.app.Activity;
import android.content.Intent;
import android.os.Bundle;
import android.view.View;
import android.view.View.OnClickListener;
import android.widget.ImageView;
import android.widget.TextView;

public class Adds extends Activity {
    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.ads);
        TextView tv1 = (TextView) findViewById(R.id.textView1);
        tv1.setOnClickListener(new OnClickListener() {
            @Override
            public void onClick(View v) {
                // TODO Auto-generated method stub
                startActivity(new Intent(Adds.this, Ads2.class));
            }
        });
        ImageView im1 = (ImageView) findViewById(R.id.imageView1);
        im1.setOnClickListener(new OnClickListener() {
            @Override
            public void onClick(View v) {
                // TODO Auto-generated method stub
                startActivity(new Intent(Adds.this, Real.class));
            }
        });
    }
    @Override
    public void onSwipe(int direction) {
        Intent intent = new Intent();

        switch (direction) {
        case SimpleGestureFilter.SWIPE_RIGHT:
            intent.setClass(this, Ads2.class);
            break;

        case SimpleGestureFilter.SWIPE_LEFT:
            intent.setClass(this, Ads3.class);
            break;
        }

        startActivity(intent);
    }
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-25T14:30:53.247

您的活动应该实现 SimpleGestureListener 以便能够接收手势事件。

```
public class Adds extends Activity implements OnGestureListener 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-25T14:48:59.810

您的错误源于 Activity 没有 onSwipe(int) 方法这一事实。所以错误表明您不能覆盖没有超级方法的方法。同样正如@sokie 所说，从他添加的链接中查看 OnGestureListener。至于用于启动新活动的滑动手势，当从左向右滑动时，覆盖调用 onBackPressed（就像你要返回一样）并从右向左滑动开始新的活动。尽管这意味着您必须在每个活动中创建手势侦听器。

# windows-7 - 无法在 Windows 7 上安装 Windows Identity Foundation

> ID：15617389
> 
> 赞同：2
> 
> 时间：2013-03-25T14:26:08.920
> 
> 标签：windows-7, wif

过去 4 个小时，我一直在尝试在 Windows 7 上安装 Windows Identity Foundation，但我尝试的所有操作都没有成功安装。我尝试在 Google 中搜索，但到目前为止没有任何帮助。我有 .NET 4.5，但卸载它并没有帮助。有人可以帮忙吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-25T18:17:29.420

您不必再安装 WIF，它默认包含在 .NET 4.5 核心的 System.IdentityModel 命名空间中。

> 第一个版本的 Windows Identity Foundation (WIF) 以独立下载的形式发布，称为 WIF 3.5，因为它是在 .NET 3.5 SP1 时间范围内引入的。从 .NET 4.5 开始，WIF 是 .NET 框架的一部分。

如果您要从 .NET 3.5/4.0 迁移，您可以[在此处](http://msdn.microsoft.com/en-us/library/jj157091.aspx)找到新命名空间的列表，只需参考这些即可！

# entity-framework - 实体框架 - 为类型为不可为空的成员“RowVersion”返回了一个空存储生成的值

> ID：15617392
> 
> 赞同：1
> 
> 时间：2013-03-25T14:26:16.630
> 
> 标签：entity-framework, entity-framework-4

我有以下 SQL 来创建表：

```
 public const string dropCreate =
        SET ANSI_NULLS ON
        SET QUOTED_IDENTIFIER ON
        IF EXISTS (SELECT name FROM sys.objects WHERE name = 'Application' AND type = 'U')
            DROP TABLE [dbo].[Application]
        CREATE TABLE [dbo].[Application] (
            [ApplicationId] INT IDENTITY (1, 1) NOT NULL,
            [Name] NVARCHAR (50) Not NULL,
            [RowVersion] [varbinary](max) NULL,
            [ModifiedDate] [datetime] NOT NULL,
            CONSTRAINT [PK_dbo.Application] PRIMARY KEY CLUSTERED ([ApplicationId] ASC)
        )"; 
```

这是我的课：

```
public partial class Application
{
    public Application()
    {
        this.TestAccounts = new List<TestAccount>();
    }

    public int ApplicationId { get; set; }
    public string Name { get; set; }
    public byte[] RowVersion { get; set; }
    public System.DateTime ModifiedDate { get; set; }
    public virtual ICollection<TestAccount> TestAccounts { get; set; }
} 
```

映射：

```
 public ApplicationMap()
    {
        // Primary Key
        this.HasKey(t => t.ApplicationId);

        // Properties
        this.Property(t => t.Name)
            .IsRequired()
            .HasMaxLength(35);

        this.Property(t => t.RowVersion)
            .IsRequired()
            .IsFixedLength()
            .HasMaxLength(8)
            .IsRowVersion();

        // Table & Column Mappings
        this.ToTable("Application");
        this.Property(t => t.ApplicationId).HasColumnName("ApplicationId");
        this.Property(t => t.Name).HasColumnName("Name");
        this.Property(t => t.RowVersion).HasColumnName("RowVersion");
        this.Property(t => t.ModifiedDate).HasColumnName("ModifiedDate");
    } 
```

我按如下方式插入：

```
 new TestAccount 
       { 
           Application = app ,
           Name = applicationName, 
           ModifiedDate = DateTime.Now 
       }; 
```

它给了我以下异常

InnerException: System.Data.Entity.Infrastructure.DbUpdateException HResult=-2146233087 消息=为“Relational.Mappings.Contexts.Application”类型的不可为空的成员“RowVersion”返回了一个空的存储生成值。来源=实体框架

有人可以给我一些建议吗？据我所知，我已经正确设置了所有内容。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-12-22T02:03:50.653

将 RowVersion 更改为时间戳

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-25T14:41:21.387

看起来像你的映射：

```
 this.Property(t => t.RowVersion)
        **.IsRequired()**
        .IsFixedLength()
        .HasMaxLength(8)
        .IsRowVersion(); 
```

与您的桌子不同：

```
[RowVersion] [varbinary](max) NULL, 
```

他们需要保持一致。

您是否尝试按照[http://msdn.microsoft.com/en-us/library/ms182776.aspx](http://msdn.microsoft.com/en-us/library/ms182776.aspx)设置行版本列？

# java - JTextField特殊情况的奇怪java自动完成

> ID：15617395
> 
> 赞同：0
> 
> 时间：2013-03-25T14:26:24.130
> 
> 标签：java, swing, autocomplete, jtextfield

我有一个 JTextFields 的自动完成功能，到目前为止似乎可以工作，但是出现了一个特定的子案例，如下所示：尝试插入“em”，而不是“emanuele semani”自动完成，你会得到“eanuemeli li”，它甚至不存在列表（仅包含两项的列表：

1.  伊曼纽尔·塞马尼
2.  曼纽梅里

)

我知道这些名字很奇怪，但是有两本书有这些名字..

```
import java.util.ArrayList;
import javax.swing.*;
import javax.swing.text.Document;
import AutoCompleteDocument;
import CompletionService;

public class AutoCompleteExample
{
    TitleService titleService;
    Document titleAutoCompleteDocument;
    JTextField titleField;

    private class TitleService extends CompletionService
    {
        public TitleService()
        {
            ArrayList<String> eventTitles = getBookTitles();
            for (int i = 0; eventTitles != null && i < eventTitles.size(); i++)
            {
                if (eventTitles.get(i) != null)
                {
                    data.add(eventTitles.get(i));
                }
            }
        }
    }

    public AutoCompleteExample()
    {
        JPanel panel = new JPanel();
        titleField = new JTextField();
        titleField.setColumns(50);
        panel.add(titleField);

        titleService = new TitleService();
        titleAutoCompleteDocument = new AutoCompleteDocument(titleService,
                titleField);

         JFrame frame = new JFrame();
         frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
         frame.add(panel);
         frame.setSize(700, 100);
         frame.setVisible(true);
         refreshCompletionServices();
    }

    public void refreshCompletionServices()
    {
        titleService = new TitleService();
        titleAutoCompleteDocument = new AutoCompleteDocument(titleService,
                titleField);
        titleField.setDocument(titleAutoCompleteDocument);
    }

    private ArrayList<String> getBookTitles()
    {
        ArrayList<String> titles = new ArrayList<>();
        titles.add("emanule semani");
        titles.add("manuemeli li");
        return titles;
    }

    public static void main(String args[])
    {
        AutoCompleteExample ex = new AutoCompleteExample();
    }
} 
```

和 CompletionService.java 类是

```
import java.util.ArrayList;
import java.util.List;

public class CompletionService
{
    public List<String> data = new ArrayList<>();
    String autoComplete(String partialString)
    {
        String hit = null;
        for (String o : data)
        {
            if (o.toLowerCase().contains(partialString.toLowerCase()))
            {
                // CompletionService contract states that we only
                // should return completion for unique hits.
                if (hit == null)
                {
                    int index = o.toLowerCase().indexOf(partialString.toLowerCase());
                    hit = o.substring(index);
                }
                else
                {
                    if (hit.length() > o.length())
                    {
                        hit = o;
                    }
                }
            }
        }
        return hit;
    }
} 
```

和 AUtoCompleteDocument.java 是

```
import javax.swing.text.AttributeSet;
import javax.swing.text.BadLocationException;
import javax.swing.text.JTextComponent;
import javax.swing.text.PlainDocument;

public class AutoCompleteDocument extends PlainDocument
{
    private static final long serialVersionUID = 1L;
    private CompletionService completionService;
    private JTextComponent documentOwner;

    public AutoCompleteDocument(CompletionService service,
            JTextComponent documentOwner)
    {
        this.completionService = service;
        this.documentOwner = documentOwner;
    }

    protected String complete(String str)
    {
        Object o = completionService.autoComplete(str);
        return o == null ? null : o.toString();
    }

    @Override
    public void insertString(int offs, String str, AttributeSet a)
            throws BadLocationException
    {
        if (str == null || str.length() == 0)
        {
            return;
        }

        String text = getText(0, offs); // Current text.
        String completion = complete(text + str);
        int length = offs + str.length();
        if (completion != null && text.length() > 0)
        {
            str = completion.substring(length - 1);
            super.insertString(offs, str, a);
            documentOwner.select(length, getLength());
        }
        else
        {
            super.insertString(offs, str, a);
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-25T14:31:39.513

我的回答是关于`Why to reinvent the wheel`，使用

*   [自动完成 JComboBox / JTextField](https://stackoverflow.com/questions/7255636/is-it-possible-to-have-an-autocomplete-using-jtextfield-and-a-jlist/7255918#7255918)

*   [SwingX 的装饰器](http://www.google.sk/#q=swingx+demo+jnlp&fp=1)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-25T14:53:32.947

你应该更换

```
if (o.toLowerCase().contains(partialString.toLowerCase())) 
```

至

```
if (o.toLowerCase().startsWith(partialString.toLowerCase())) 
```

# iphone - 从 Iphone 到 ipad

> ID：15617398
> 
> 赞同：0
> 
> 时间：2013-03-25T14:26:40.187
> 
> 标签：iphone, objective-c, ipad

我已经为 iPhone 创建了完整的应用程序，但我需要制作 iPad 版本。该应用程序主要是列表，但登录屏幕、徽标和单元格太小（重复一遍 - 它是为 iPhone 创建的）。有什么方法可以创建 iPad 用户界面或拉伸手机视图？

谢谢你的帮助。顺便说一句，如果它与一些类似的问题重复，对不起。只是找不到它（可能是错误的关键字）。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-25T18:49:21.870

您绝对应该为 iPad 和 iPhone 提供单独的 XIB。现在，如果您想尝试节省一些工作并从 iPhone XIBs 作为您的基点开始，您应该看看这个问题的前两个答案：

[Xcode 4 .xib 创建 iPad 版本](https://stackoverflow.com/questions/5347198/xcode-4-xib-create-ipad-version)

# c# - 键盘快捷键在 Windows 8 中不起作用

> ID：15617402
> 
> 赞同：1
> 
> 时间：2013-03-25T14:26:54.410
> 
> 标签：c#, windows, winforms, shortcut

我有一个编写的 winform 应用程序，`C#`它是在`Windows 7`. 其中许多是在当我在系统上运行此应用程序时`menu commands have keyboard shortcuts`定义的，实际上我得到了听起来像 的东西，好像我做错了什么。该程序的其他一些方面也不能完全正确地运行，但这是我期望的工作并且不知道我将如何解决这个问题。提前感谢您提供有关如何解决此问题的任何建议。`control properties``Windows 8``none of the shortcut keys work``default beep`

加里

这都是设计师生成的：

```
this.saveConfigurationToolStripMenuItem.ShortcutKeys = ((System.Windows.Forms.Keys)((System.Windows.Forms.Keys.Control | System.Windows.Forms.Keys.S))); 
```

# sql-server - 如何使用一对多关系和分页订购 sql server 查询

> ID：15617404
> 
> 赞同：1
> 
> 时间：2013-03-25T14:27:02.313
> 
> 标签：sql-server, pagination, one-to-many

我有一个充满产品的 sql server 数据库，每个产品都有 1 条样式记录和 1 条或更多 sku 记录。我能够使用dense_rank（）成功地对这些表上的查询进行分页，但是我一生都无法弄清楚如何根据style_id以外的列对样式进行排序，并且仍然能够添加一个每种风格的递增排名。

我目前正在使用此查询：

```
SELECT *
FROM
(
  SELECT
    styles.style_id
    styles.department,
    styles.style,
    styles.brand,
    styles.description,
    skus.sku_id,
    skus.color,
    skus.size,
    skus.price,
    skus.creation_date,
    DENSE_RANK() OVER (ORDER BY styles.style_id) AS style_rank
  FROM skus
  LEFT OUTER JOIN styles ON styles.style_id=skus.style_id
  WHERE skus.color='blue'
  AND styles.brand='acme'
) AS t1
WHERE
t1.style_rank > 0 AND t1.style_rank <= 25 
```

以上将允许我在样式级别进行分页，但我需要能够根据价格 ASC/DESC 或 creation_date ASC/DESC 对这些样式进行排序。如果能够使用诸如按 MAX(skus.price) 的排序样式之类的聚合函数来控制排序，那就太好了，但这不是必需的。

澄清一下，一种款式可能有三个 skus，这三个 skus 中的每一个都可能是不同的价格。

这似乎是任何使用 RDBMS 的零售网站的基本需求，但我找不到任何有关如何执行此操作的文档。

任何关于如何做到这一点的建议将不胜感激。

编辑：我使用两个查询解决了这个问题（如下面的答案所示）。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-26T02:08:25.373

我想出了一个使用两个查询的解决方案。第一个查询是获取样式。第二个是使用第一个查询中的 style_id 获取所有 sku 的“多获取”查询。

第一个查询：

```
SELECT *
FROM
(
  SELECT DISTINCT
    styles.style_id
    styles.department,
    styles.style,
    styles.brand,
    styles.description,
    MAX(skus.price) AS max_price,
    ROW_NUMBER() OVER (ORDER BY MAX(skus.price) DESC) AS price_rank
  FROM skus
  LEFT OUTER JOIN styles ON styles.style_id=skus.style_id
  WHERE skus.color='blue'
  AND styles.brand='acme'
  GROUP BY styles.style_id, styles.department, styles.style, styles.brand, styles.description
) AS t1
WHERE
t1.price_rank > 0 AND t1.price_rank <= 25 
```

第二个查询：

```
SELECT
  skus.style_id,
  skus.sku_id,
  skus.color,
  skus.size,
  skus.price,
  skus.creation_date
FROM skus
WHERE skus.style_id ='styleid1' OR skus.style_id='styleid2' OR skus.style_id='styleid3' /* etc. */ 
```

现在使用第二个查询中的适当 sku 填充样式对象。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-25T14:30:35.140

我认为您需要添加`PARTITION BY styles.style_id`：

```
SELECT *
FROM
(
  SELECT
    styles.style_id
    styles.department,
    styles.style,
    styles.brand,
    styles.description,
    skus.sku_id,
    skus.color,
    skus.size,
    skus.price,
    skus.creation_date,
    DENSE_RANK() OVER (PARTITION BY styles.style_id
                       ORDER BY skus.createion_date DESC, skus.price) AS style_rank
  FROM skus
  LEFT OUTER JOIN styles ON styles.style_id=skus.style_id
  WHERE skus.color='blue'
  AND styles.brand='acme'
) AS t1
WHERE
t1.style_rank > 0 AND t1.style_rank <= 25 
```

# c# - 当前上下文中不存在名称“X509Certificate2UI”

> ID：15617409
> 
> 赞同：19
> 
> 时间：2013-03-25T14:27:08.463
> 
> 标签：c#, asp.net-mvc, asp.net-mvc-4

有人在 Asp Net MVC4 应用程序中使用 X509Certificate2UI 类有问题吗

```
using System.Security.Cryptography.X509Certificates;

private static X509Certificate2 PickCertificate(StoreLocation location, StoreName name)
{

    try
    {
        store.Open(OpenFlags.ReadOnly);
        //PROBLEM IS HERE
        X509Certificate2 cert = X509Certificate2UI.SelectFromCollection(store.Certificates, "Caption", "Message", X509SelectionFlag.SingleSelection)[0]; 
}
    catch (Exception)
    {               
        throw;
    }
} 
```

它抱怨当前上下文中没有“X509Certificate2UI”名称不知道，因为该类在 System.Security.Cryptography.X509Certificates 中；

* * *

## 回答 #1

> 赞同：46
> 
> 时间：2013-03-25T14:39:10.443

您需要在`System.Security.dll`项目中包含参考，因为它不包含在`mscorlib`程序集中，而是包含在程序集中`System.Security` 。

# java - Ant junit 批量测试

> ID：15617414
> 
> 赞同：0
> 
> 时间：2013-03-25T14:27:22.737
> 
> 标签：java, ant, junit

*我有我的 junit 测试类。我正在用 ant 运行这些类。我正在使用带有参数 includes="* /* Test *.class"的 batchtest 属性，但我的类名称如 * test * 不包含测试方法，当我运行它会给出错误“找不到测试”。是否有一个选项，比如如果课堂上没有测试然后跳过？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-25T14:30:01.633

要回答这个问题，您需要提供更好的模式。

潜在的解决方案：

将所有合法的测试类重构为带有前缀的**BEGIN**`Test` ， 然后将 ant 脚本更改为：

```
includes="*/Test*.class" 
```

为什么你的类中有名为“Test”的类不是测试？我强烈建议遵循一个命名约定，该约定放在`Test`开头并`test`从您的文件名中删除实​​际上不是测试的文件名。

# bash - 在bash中不退出/ EOF的管道到可执行文件

> ID：15617418
> 
> 赞同：10
> 
> 时间：2013-03-25T14:27:29.940
> 
> 标签：bash, sh

我有一个（只读）可执行文件“myexec”，我总是执行它，然后输入“input1”（一个字符串），然后在我喜欢的时候继续我的业务“”和“退出”：

```
$ myexec
> input1
> do something else for as long as I like
> exit 
```

我想做的是使用输入“input1”*自动*执行“myexec”，然后能够“只要我喜欢就可以做其他事情”。据我所知，我的选择是：

```
$ myexec <<< "input1" 
```

或者

```
$ echo "input1" | myexec 
```

或者

```
$ myexec << EOF
input1
EOF 
```

但是这些方法的问题是它们在读取“input1”后终止了“myexec”。如何避免 EOF/退出/终止？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-25T16:42:44.550

您可以`cat`为此使用：

```
$ { echo "input1"; cat; } | my exec 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-03-25T14:50:35.603

您可以使用[expect](/questions/tagged/expect "显示标记为“期望”的问题")来自动化它。例如：

```
#!/usr/bin/expect

spawn /my/exec
expect "> "
send "input1\r"
interact 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-25T14:50:56.187

您可以创建一个`pipe`并监听输入`tail -f`

```
mkfifo pipe
tail -f pipe | ./script.sh 
```

script.sh 的示例内容

```
#!/bin/bash

while read row
do
    if [ "${row}" = "exit" ]; then
        break
    fi
    echo "ROW READ $row"
done

echo "script exit"
exit 0 
```

然后，使用另一个脚本，输入管道

```
echo "example content" > ./pipe
echo "bla bla bla" > ./pipe
echo "exit" > ./pipe
echo "" > ./pipe 
```

你会得到

```
[root@mypc ~]# tail -f pipe | ./script
ROW READ example content
ROW READ bla bla bla
script exit
[root@mypc ~]# 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-25T15:01:28.533

听起来您几乎想要一个 fifo，它是存储在文件系统中的命名管道。您重定向到它的任何输出都会从另一端输出到正在收听的内容中。尝试这个：

```
mkfifo myexec.fifo
myexec < myexec.fifo &
echo input1 > myexec.fifo
echo input2 > myexec.fifo 
```

您可以通过使用 bash 并让它运行发送到 fifo 的命令来对此进行测试，如下例所示：

```
mkfifo bash.fifo
/bin/bash < bash.fifo &
echo uname > bash.fifo
Darwin 
```

& 符号将进程分离到后台，因此只要 myexec 继续侦听，它将继续执行命令。

如果 myexec 正在退出，您可以将其包装在 while 循环中：

```
while [ 1 ]; do myexec < myexec.fifo; done 
```

在 myexec 消耗完 fifo 中等待的内容后，它将迭代循环。如果fifo为空，它将等待。

# smtp - Magento 1.4.0.1 上的 SMTP

> ID：15617421
> 
> 赞同：0
> 
> 时间：2013-03-25T14:27:32.737
> 
> 标签：smtp, magento-1.4

我想在 Magento 1.4.0.1 上配置 SMTP。有人知道与 SMTP Pro 类似的 Magento 1.4.0.1 的 SMTP 邮件扩展名吗（[http://www.magentocommerce.com/magento-connect/aschroder-com-smtp-pro-email-free-and-easy-magento-email -for-smtp-gmail-or-google-apps-email.html](http://www.magentocommerce.com/magento-connect/aschroder-com-smtp-pro-email-free-and-easy-magento-emailing-for-smtp-gmail-or-google-apps-email.html)）。我还在互联网上找到了一个代码（[http://pravams.com/2011/07/30/magento-send-email-using-smtp/](http://pravams.com/2011/07/30/magento-send-email-using-smtp/)），该代码也不适用于 Magento 1.4.0.1。

我的问题是：**有人知道如何在 Magento 1.4.0.1 上启用 SMTP 吗？**

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-25T14:35:45.640

我在 Magento 1.4 和 1.7 中成功使用了这个扩展：

[www.magentocommerce.com/magento-connect/aschroder-com-smtp-pro-email-free-and-easy-magento-email-for-smtp-gmail-or-google-apps-email.html](http://www.magentocommerce.com/magento-connect/aschroder-com-smtp-pro-email-free-and-easy-magento-emailing-for-smtp-gmail-or-google-apps-email.html)

它非常有用且易于配置。我认为最好使用扩展而不是创建代码

另一个扩展是： http: [//www.magentocommerce.com/magento-connect/advanced-smtp-artson-it.html](http://www.magentocommerce.com/magento-connect/advanced-smtp-artson-it.html)

但相信我是更好的 schroder 扩展，因为它比高级 smtp-artson 更可配置且错误更少。

# c# - PrintForm 裁剪表单的右侧

> ID：15617423
> 
> 赞同：0
> 
> 时间：2013-03-25T14:27:44.123
> 
> 标签：c#, .net, printing, printform

好的，所以当我发出

```
this.printform1.print(); 
```

相关代码

```
 this.printForm1.DocumentName = "document";
              this.printForm1.Form = this;
               this.printForm1.PrintAction=System.Drawing.Printing.PrintAction.PrintToPreview;
                 this.printForm1.PrinterSettings =((System.Drawing.Printing.PrinterSettings)(resources.GetObject("printForm1.PrinterSettings")));
                   this.printForm1.PrintFileName = null; 
```

命令 printpreview 并显示打印的文档，它从右侧修剪，边缘很大，我似乎找不到原因。

提前致谢

# java - jdbc error Parameter index out of range (2 > number of parameters, which is 1)

> ID：15617426
> 
> 赞同：0
> 
> 时间：2013-03-25T14:27:55.923
> 
> 标签：java, jdbc

我写了以下java方法，当我调用它时，给了我错误

```
Parameter index out of range (2 > number of parameters, which is 1). 
```

它在preparedStatement.setInt(2,p) 行给出错误；

```
for(int t=0;t<2 & exit;t++){
    sql="SELECT allocationProb FROM trial.teacherallocation where TeacherID=?;";
                    preparedStatement = dbConnection.prepareStatement(sql);
                    preparedStatement.setString(1,var1[t]);
                    ResultSet rs3=preparedStatement.executeQuery();
                    rs3.next();
                    int allocationProb=rs3.getInt(1);
                    rs3.close();
                    System.out.println("INSIDE");
                    int p=0;
                    if(allocationProb==0){ 
                        p=1;
                     sql="UPDATE `trial`.`teacherallocation` SET `AllocationSub1`=?,` allocationProb`=? WHERE `TeacherID`=?;";
                     preparedStatement.setString(1,str1);
                     preparedStatement.setInt(2,p);
                     preparedStatement.setString(3,var1[t]);
                     preparedStatement.executeUpdate();
                    }
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-25T14:32:45.723

虽然你改变了你的`sql`变量

```
sql="UPDATE `trial`.`teacherallocation` SET `AllocationSub1`=?,` allocationProb`=? WHERE `TeacherID`=?;"; 
```

你不会`PreparedStatement`用它创造一个新的。所以当你打电话

```
preparedStatement.setString(1,str1);
preparedStatement.setInt(2,p);
preparedStatement.setString(3,var1[t]);
preparedStatement.executeUpdate(); 
```

你在 SQL 上调用它

```
sql="SELECT allocationProb FROM trial.teacherallocation where TeacherID=?;"; 
```

它只有 1 个参数，如果您尝试添加更多参数，则会引发异常。

您需要`PreparedStatement`在这些行之前创建一个新对象或重新分配一个对象。

```
sql="UPDATE `trial`.`teacherallocation` SET `AllocationSub1`=?,` allocationProb`=? WHERE `TeacherID`=?;";
preparedStatement = dbConnection.prepareStatement(sql);
preparedStatement.setString(1,str1);
preparedStatement.setInt(2,p);
preparedStatement.setString(3,var1[t]);
preparedStatement.executeUpdate(); 
```

此外，您应该在完成所有 jdbc 连接后关闭它们。

`preparedStatement.close();`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-25T14:30:43.940

您对两个不同的 SQL 语句使用相同的准备好的语句。并且参数数量也不同。这就是您收到此错误的原因。

尝试关注

如果（分配概率==0）{ p=1; prepareStatement = dbConnection.prepareStatement(sql);

希望能帮助到你

# regex - 过渡中的歧义：如何在 NFA 中处理字符串？

> ID：15617429
> 
> 赞同：4
> 
> 时间：2013-03-25T14:28:17.317
> 
> 标签：regex, regular-language, dfa, nfa, kleene-star

我已经从给定的正则表达式制作了 DFA 以匹配测试字符串。在某些情况下`.*`会发生。（例如`.*ab`）。现在假设机器处于状态 1。在 DFA 中， `.*`指的是所有字符到自身的转换，以及从状态 1 到“a”的另一个转换。如果测试字符串包含“a”，那么转换可能是什么，因为从状态 1 开始，机器可以进入 DFA 中不可能的两个状态。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-27T14:23:11.113

^(我从你的例子开始，这样人们就会发现它很有帮助)
任何[类型的自动机](http://en.wikipedia.org/wiki/Automata_theory#Classes_of_automata)都可以有两种形式：

*   确定性
*   非确定性的。

在**确定性模型中：**我们只有一个选择（或说没有选择）从一个[祝贺](http://en.wikiversity.org/wiki/Automata_theory/Finite_automata#Configuration)移动到下一个[配置](http://en.wikiversity.org/wiki/Automata_theory/Finite_automata#Configuration)。
在[有限自动](http://www.google.co.in/url?sa=t&rct=j&q=&esrc=s&source=web&cd=3&cad=rja&ved=0CEEQFjAC&url=http://www.eecs.wsu.edu/~ananth/CptS317/Lectures/FiniteAutomata.pdf&ei=FjFTUbC0CsSJrAfo_YGACg&usg=AFQjCNHdmwZViAaLwzD8tHPkNizUjBu2Ow&bvm=bv.44342787,d.bmk)（DFA）的确定性模型中：对于状态（Q）和语言符号（Σ）的每种可能组合，我们总是有唯一的下一个状态。

[DFA 的转移函数定义：δ:Q×Σ → Q](https://stackoverflow.com/questions/14870130/how-does-qq-read-in-the-definition-of-a-dfa-deterministic-finite-accepto?answertab=votes#tab-top)

```
δ(q0, a) → q1
            ^ only single choice 
```

因此，在 DFA 中，从一个状态到下一个状态的每个可能的移动都是*确定的。*

而
在**非确定性模型中：**对于下一个配置，我们可以有多个选择。
在有限自动机（NFA）的非确定性模型中：输出是状态（Q）和语言符号（Σ）的*某种组合的**状态****集。***

 **NFA 的转移函数定义：δ:Q×Σ → 2 ^Q = ⊆ Q

```
δ(q0, a) → {q1, q2, q3}
               ^ is set, Not single state (more than one choice) 
```

在 NFA 中，对于下一个状态，我们可以有多个选择。那就是您所说**的过渡 NFA 中的歧义**。

（*你的例子*）
假设语言符号是`Σ = {a, b}`并且语言/正则表达式是`(a + b)*ab`。您认为这种语言的有限自动机可能如下所示：

> ![[自动机]](../Images/26291e8cb94c2176f8987362aa3c1f46.png)
> **您的问题**是： 我提出了更笼统的问题。*`Which state to move when we have more than one choices for next state?`*

## 如何在 NFA 中处理字符串？

[我正在考虑将*自动机模型作为接受器*，如果它属于自动机语言，则接受字符串。（*注意：我们可以将自动机作为转换器*），下面是我对上述示例的回答]

在上面的 NFA 中，我们找到了 5 个 Tapular 对象：

```
1\.  Σ :  {a, b}  
2\.  Q :  {q1, ,q2, q3}  
3\.  q1:  initial state
4\.  F :  {q3}       <---F is set of final state
5\.  δ : Transition rules in above diagram: 
         δ(q1, a) → { q1, q2 }
         δ(q1, b) → { q1 }
         δ(q2, b) → { q3 } 
```

示例的有限自动机实际上是一个 NFA，因为在生产规则`δ(q1, a) → { q1, q2 }`中，如果我们`a`在当前状态为时获得符号，`q1`则下一个状态可以是`q1`或`q2`（多个选择）。因此，当我们在 NFA 中处理一个字符串时，我们会获得额外的路径，`a`可以在当前状态为`q1`.

*NFA 接受一个字符串，如果有一些可能的移动序列将使机器在字符串处理结束时进入最终状态*。从初始状态到集合中任何最终状态的所有字符串的集合`F`称为 NFA 语言：

我们也可以写，“NFA 定义的语言是什么？” 作为：

> L(nfa) = { w ⊆ Σ* | δ*(q [1] , w) ∩ F ≠ ∅}

[当我是新手时，这对我来说太复杂了，无法理解，但实际上不是]

L(nfa) **表示**：所有字符串都由语言符号组成 = (w ⊆ Σ* ) 在语言中；如果 经过形式初始状态（=δ*(q1, w) ）`(|)`处理后得到的`w`状态集合包含最终状态集合中的一些状态（因此与最终状态的交集不为空 = δ*(q1, w) ∩ F ≠ ∅）。因此，在处理 Σ* 中的字符串时，我们需要跟踪所有可能的路径。

**示例 1**`abab` ：通过 NFS处理字符串：

```
--►(q1)---a---►(q1)---b---►(q1)---a---►(q1)---b---►(q1)
     \                       \ 
      a                       a  
       \                       \
        ▼                       ▼
       (q2)                     (q2)---b---►((q3))
        |                      
        b                      
        |                      
        ▼                                 
       (q3)                   
        |
        a
        |
       halt 
```

上图显示：如何`abab`在 NFA 中处理字符串？

***暂停：***表示*字符串无法完全处理，因此不能将其视为此路径中已接受的字符串*

字符串`abab`可以在两个方向上完全处理，因此 δ*(q1, w) = { q1, q3}。

δ*(q1, w) 与一组最终状态的交集是 {q3}：

```
 {q1, q3} ∩ F 
             ==>  {q1, q3} ∩ {q3}     
             ==>  {q3}  ≠  ∅ 
```

这样，字符串`ababa`就是语言 L(nfa)。

**示例 2：**来自 Σ* 的字符串是`abba`，以下是如何处理：

```
--►(q1)---a---►(q1)---b---►(q1)---b---►(q1)---a---►(q1)
     \                                   \ 
      a                                   a  
       \                                   \
        ▼                                   ▼
       (q2)                                (q2)
        |                      
        b                      
        |                      
        ▼                                 
       (q3)                   
        |
        b
        |
       halt 
```

`abba`对于可达状态的字符串集合是 δ*(q1, w) = { q1, q2} 并且在这个集合中没有状态是最终状态这意味着 => 它与 F 的交集是 ∅ 一个空集，因此字符串`abba`不是一个可接受的字符串（而不是语言）。

这是我们在非确定性有限自动机中处理字符串的方式。

一些额外的重要说明：

*   在有限自动机的情况下，确定性和非确定性模型具有同等的能力。非确定性模型没有额外的能力来定义一种语言。因此 NFA 和 DFA 的范围与正则语言相同。（*这不是所有类自动化的情况，例如 PDA 的范围！=NPDA*）

*   非确定性模型对于理论目的更有用，比较论文绘制。而出于实现目的，我们总是需要确定性模型（*为了效率而最小化*）。幸运的是，在有限自动元类中，每个非确定性模型都可以转换为等效的确定性模型。我们有[将 NFA 转换为 DFA 的](http://www.cs.gsu.edu/~cscskp/Automata/FA/node12.html)算法方法。

*   在 DFA 中由单个状态表示的信息可以由 NFA 状态的组合表示，因此 NFA 中的状态数少于其等效 DFA。（*证明可用 numberOfStates(DFA)<= 2 power numberOfStates(NFA) 因为所有集合组合都是 powerset*）

上述常规语言的 DFA 如下：

> ![(a+b)*ab-dfa](../Images/17c4a2e941f240f47656ab21e4a0eb01.png)

使用此 DFA，您将始终为 Σ* 中的任何字符串找到从初始状态到最终状态的唯一路径，而不是设置，您将到达单个可到达的最终状态，如果该状态属于最终的集合，则输入字符串被称为接受字符串（语言），否则不接受/

（*你的表达通常在理论科学`.*ab`中`(a + b)*ab`是相同的，我们不使用`.`点运算符而不是连接*）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-25T14:53:54.477

与此类正则表达式的匹配通过回溯发生。当对下一个状态有歧义时，评估会选择第一个选择并记住它做出了选择。如果采用第一个选择导致匹配失败，则评估将回溯到它所做的最后一个选择，并尝试从该状态下一个可用的选择。

我不确定这种机制是否映射到严格的 DFA。**

# sass - Yeoman 中处理 Sass 文件的工作流程是什么？

> ID：15617431
> 
> 赞同：39
> 
> 时间：2013-03-25T14:28:21.523
> 
> 标签：sass, compass-sass, gruntjs, yeoman

我尝试使用 yeoman，但我不知道如何使用我自己的 sass 文件。

和

`grunt server`

Sass 文件被监视并编译成

`.tmp/styles/`

但是没有引用编译的样式表，除了`<link rel="stylesheet" href="styles/main.css">`

那么，在开发过程中使用 index.html 中编译好的 sass 文件的推荐方式是什么？

例如`grunt server`，如果我将样式更改`app/styles/my.sass`为`.tmp/styles/my.css`，则会被覆盖，并且位于服务器之外（localhost:9000）。因此，无法将其链接到`index.html`.

With`grunt build`是`main.css`include中的所有内容，`my.sass`但在开发过程中我不知道如何在`index.html`.

你能给我一些简单的例子吗？

这是默认的 yeoman 安装。我这样做了：

1.  `yo angular test`
2.  我加`app/styles/style.sass`
3.  `grunt server`这编译`style.sass`成`.tmp/styles/style.css`
4.  现在我不知道如何将`style.css`它包含在 html 中

（抱歉，这可能是一个愚蠢的问题，但我是 yeoman 的新手，也很咕哝）

这是来自 yeoman 的 Gruntfile.js：

```
'use strict';
var lrSnippet = require('grunt-contrib-livereload/lib/utils').livereloadSnippet;
var mountFolder = function (connect, dir) {
  return connect.static(require('path').resolve(dir));
};

module.exports = function (grunt) {
  // load all grunt tasks
  require('matchdep').filterDev('grunt-*').forEach(grunt.loadNpmTasks);

  // configurable paths
  var yeomanConfig = {
    app: 'app',
    dist: 'dist'
  };

  try {
    yeomanConfig.app = require('./component.json').appPath || yeomanConfig.app;
  } catch (e) {}

  grunt.initConfig({
    yeoman: yeomanConfig,
    watch: {
      coffee: {
        files: ['<%= yeoman.app %>/scripts/{,*/}*.coffee'],
        tasks: ['coffee:dist']
      },
      coffeeTest: {
        files: ['test/spec/{,*/}*.coffee'],
        tasks: ['coffee:test']
      },
      compass: {
        files: ['<%= yeoman.app %>/styles/{,*/}*.{scss,sass}'],
        tasks: ['compass']
      },
      livereload: {
        files: [
          '<%= yeoman.app %>/{,*/}*.html',
          '{.tmp,<%= yeoman.app %>}/styles/{,*/}*.css',
          '{.tmp,<%= yeoman.app %>}/scripts/{,*/}*.js',
          '<%= yeoman.app %>/images/{,*/}*.{png,jpg,jpeg,gif,webp}'
        ],
        tasks: ['livereload']
      }
    },
    connect: {
      livereload: {
        options: {
          port: 9000,
          // Change this to '0.0.0.0' to access the server from outside.
          hostname: 'localhost',
          middleware: function (connect) {
            return [
              lrSnippet,
              mountFolder(connect, '.tmp'),
              mountFolder(connect, yeomanConfig.app)
            ];
          }
        }
      },
      test: {
        options: {
          port: 9000,
          middleware: function (connect) {
            return [
              mountFolder(connect, '.tmp'),
              mountFolder(connect, 'test')
            ];
          }
        }
      }
    },
    open: {
      server: {
        url: 'http://localhost:<%= connect.livereload.options.port %>'
      }
    },
    clean: {
      dist: ['.tmp', '<%= yeoman.dist %>/*'],
      server: '.tmp'
    },
    jshint: {
      options: {
        jshintrc: '.jshintrc'
      },
      all: [
        'Gruntfile.js',
        '<%= yeoman.app %>/scripts/{,*/}*.js'
      ]
    },
    karma: {
      unit: {
        configFile: 'karma.conf.js',
        singleRun: true
      }
    },
    coffee: {
      dist: {
        files: {
          '.tmp/scripts/coffee.js': '<%= yeoman.app %>/scripts/*.coffee'
        }
      },
      test: {
        files: [{
          expand: true,
          cwd: '.tmp/spec',
          src: '*.coffee',
          dest: 'test/spec'
        }]
      }
    },
    compass: {
      options: {
        sassDir: '<%= yeoman.app %>/styles',
        cssDir: '.tmp/styles',
        imagesDir: '<%= yeoman.app %>/images',
        javascriptsDir: '<%= yeoman.app %>/scripts',
        fontsDir: '<%= yeoman.app %>/styles/fonts',
        importPath: '<%= yeoman.app %>/components',
        relativeAssets: true
      },
      dist: {},
      server: {
        options: {
          debugInfo: true
        }
      }
    },
    concat: {
      dist: {
        files: {
          '<%= yeoman.dist %>/scripts/scripts.js': [
            '.tmp/scripts/{,*/}*.js',
            '<%= yeoman.app %>/scripts/{,*/}*.js'
          ]
        }
      }
    },
    useminPrepare: {
      html: '<%= yeoman.app %>/index.html',
      options: {
        dest: '<%= yeoman.dist %>'
      }
    },
    usemin: {
      html: ['<%= yeoman.dist %>/{,*/}*.html'],
      css: ['<%= yeoman.dist %>/styles/{,*/}*.css'],
      options: {
        dirs: ['<%= yeoman.dist %>']
      }
    },
    imagemin: {
      dist: {
        files: [{
          expand: true,
          cwd: '<%= yeoman.app %>/images',
          src: '{,*/}*.{png,jpg,jpeg}',
          dest: '<%= yeoman.dist %>/images'
        }]
      }
    },
    cssmin: {
      dist: {
        files: {
          '<%= yeoman.dist %>/styles/main.css': [
            '.tmp/styles/{,*/}*.css',
            '<%= yeoman.app %>/styles/{,*/}*.css'
          ]
        }
      }
    },
    htmlmin: {
      dist: {
        options: {
          /*removeCommentsFromCDATA: true,
          // https://github.com/yeoman/grunt-usemin/issues/44
          //collapseWhitespace: true,
          collapseBooleanAttributes: true,
          removeAttributeQuotes: true,
          removeRedundantAttributes: true,
          useShortDoctype: true,
          removeEmptyAttributes: true,
          removeOptionalTags: true*/
        },
        files: [{
          expand: true,
          cwd: '<%= yeoman.app %>',
          src: ['*.html', 'views/*.html'],
          dest: '<%= yeoman.dist %>'
        }]
      }
    },
    cdnify: {
      dist: {
        html: ['<%= yeoman.dist %>/*.html']
      }
    },
    ngmin: {
      dist: {
        files: [{
          expand: true,
          cwd: '<%= yeoman.dist %>/scripts',
          src: '*.js',
          dest: '<%= yeoman.dist %>/scripts'
        }]
      }
    },
    uglify: {
      dist: {
        files: {
          '<%= yeoman.dist %>/scripts/scripts.js': [
            '<%= yeoman.dist %>/scripts/scripts.js'
          ],
        }
      }
    },
    copy: {
      dist: {
        files: [{
          expand: true,
          dot: true,
          cwd: '<%= yeoman.app %>',
          dest: '<%= yeoman.dist %>',
          src: [
            '*.{ico,txt}',
            '.htaccess',
            'components/**/*',
            'images/{,*/}*.{gif,webp}'
          ]
        }]
      }
    }
  });

  grunt.renameTask('regarde', 'watch');
  // remove when mincss task is renamed
  grunt.renameTask('mincss', 'cssmin');

  grunt.registerTask('server', [
    'clean:server',
    'coffee:dist',
    'compass:server',
    'livereload-start',
    'connect:livereload',
    'open',
    'watch'
  ]);

  grunt.registerTask('test', [
    'clean:server',
    'coffee',
    'compass',
    'connect:test',
    'karma'
  ]);

  grunt.registerTask('build', [
    'clean:dist',
    'jshint',
    'test',
    'coffee',
    'compass:dist',
    'useminPrepare',
    'imagemin',
    'cssmin',
    'htmlmin',
    'concat',
    'copy',
    'cdnify',
    'usemin',
    'ngmin',
    'uglify'
  ]);

  grunt.registerTask('default', ['build']);
}; 
```

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2013-06-04T01:50:41.530

您正在寻找的内容记录在：[https ://github.com/yeoman/grunt-usemin](https://github.com/yeoman/grunt-usemin)

只需将您的 css 导入包装在注释块中，类似于使用 javascript 文件的方式

```
<!-- build:css styles/main.css -->
<link rel="stylesheet" href="styles/base.css">
<link rel="stylesheet" href="styles/modules.css">
<link rel="stylesheet" href="styles/layout.css">
<!-- endbuild --> 
```

确保您的生成器是最新的，并且您的 grunt 任务已全部设置。做魔术的人是`'useminPrepare'`

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-09-17T10:14:15.967

真正的发展魔法正在发生在

```
mountFolder(connect, '.tmp'), 
```

用于[grunt-contrib-watch](https://github.com/gruntjs/grunt-contrib-watch)的[connect-livereload 中间件](https://github.com/intesso/connect-livereload)。

这使得本地服务器也提供*.tmp*文件夹的内容，这就是为什么您可以引用*styles/main.css*并获取*.tmp/styles/main.css*作为回报。

*通常从不在*服务器*任务中调用*useminPrepare 。**

 ** * *

## 回答 #3

> 赞同：5
> 
> 时间：2013-03-27T12:07:50.530

您只需将其包括在内

```
<link rel="stylesheet" href="styles/style.css"> 
```

Yeoman/grunt 在运行服务器时会知道它应该从临时文件夹中获取 sass 文件。*

# php - 计算两个 HTML 文件的百分比差异

> ID：15617432
> 
> 赞同：4
> 
> 时间：2013-03-25T14:28:25.753
> 
> 标签：php, html, diff, levenshtein-distance

我正在用 php 编写一个工具来比较 HTML 文件并显示差异。现在我正在寻找一种有效的方法来计算两个 HTML 文件之间的百分比差异。这些文件可以任意长（我拥有的文件可以长达 300000 个字符）。

经过一番研究，我偶然发现了 Levensthein 距离，它是 O(n*m) 的算法，需要空间 O(n*m)：php 版本最多只能支持 255 个字符和我自己的 O(n) 空间实现，太慢了。之后，我尝试了php函数similar_text，但该算法对于非常大的HTML文件也太慢了。

所以现在我正在寻找另一种更有效的算法来比较 HTML 文件。近似算法也很好。谁能给我一些关于如何做到这一点的建议？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-03-03T20:30:13.877

您可以设置 xdiff 扩展：

[http://www.php.net/manual/en/function.xdiff-file-diff.php](http://www.php.net/manual/en/function.xdiff-file-diff.php)

然后得到两个文件的差异，根据这个差异，你可以很容易地得到百分比。

例子：

*   第一个文件A：400字
*   第二档B：400字

差异结果：从 A 到 B 的 200 个单词差异

那会给你50%的相似度。

# android - 应用程序 gmaps(com.formation.gmaps) 意外停止

> ID：15617441
> 
> 赞同：2
> 
> 时间：2013-03-25T14:28:42.147
> 
> 标签：android, android-layout, android-emulator

我正在尝试创建一个应用程序位置，但它向我显示了错误`the application of gmaps (com.formation.gmaps) has stopped unexpectedly`。

请注意，我已经卸载了 eclipse，但总是出现这个错误。

这是我的错误日志：

```
03-25 14:21:59.914: E/AndroidRuntime(431): FATAL EXCEPTION: main
03-25 14:21:59.914: E/AndroidRuntime(431): java.lang.RuntimeException: Unable to instantiate activity ComponentInfo{com.formation.gmaps/com.formation.gmaps.MainActivity}: java.lang.ClassNotFoundException: com.formation.gmaps.MainActivity in loader dalvik.system.PathClassLoader[/data/app/com.formation.gmaps-1.apk]
03-25 14:21:59.914: E/AndroidRuntime(431):  at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2585)
03-25 14:21:59.914: E/AndroidRuntime(431):  at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:2679)
03-25 14:21:59.914: E/AndroidRuntime(431):  at android.app.ActivityThread.access$2300(ActivityThread.java:125)
03-25 14:21:59.914: E/AndroidRuntime(431):  at android.app.ActivityThread$H.handleMessage(ActivityThread.java:2033)
03-25 14:21:59.914: E/AndroidRuntime(431):  at android.os.Handler.dispatchMessage(Handler.java:99)
03-25 14:21:59.914: E/AndroidRuntime(431):  at android.os.Looper.loop(Looper.java:123)
03-25 14:21:59.914: E/AndroidRuntime(431):  at android.app.ActivityThread.main(ActivityThread.java:4627)
03-25 14:21:59.914: E/AndroidRuntime(431):  at java.lang.reflect.Method.invokeNative(Native Method)
03-25 14:21:59.914: E/AndroidRuntime(431):  at java.lang.reflect.Method.invoke(Method.java:521)
03-25 14:21:59.914: E/AndroidRuntime(431):  at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:868)
03-25 14:21:59.914: E/AndroidRuntime(431):  at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:626)
03-25 14:21:59.914: E/AndroidRuntime(431):  at dalvik.system.NativeStart.main(Native Method)
03-25 14:21:59.914: E/AndroidRuntime(431): Caused by: java.lang.ClassNotFoundException: com.formation.gmaps.MainActivity in loader dalvik.system.PathClassLoader[/data/app/com.formation.gmaps-1.apk]
03-25 14:21:59.914: E/AndroidRuntime(431):  at dalvik.system.PathClassLoader.findClass(PathClassLoader.java:243)
03-25 14:21:59.914: E/AndroidRuntime(431):  at java.lang.ClassLoader.loadClass(ClassLoader.java:573)
03-25 14:21:59.914: E/AndroidRuntime(431):  at java.lang.ClassLoader.loadClass(ClassLoader.java:532)
03-25 14:21:59.914: E/AndroidRuntime(431):  at android.app.Instrumentation.newActivity(Instrumentation.java:1021)
03-25 14:21:59.914: E/AndroidRuntime(431):  at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2577)
03-25 14:21:59.914: E/AndroidRuntime(431):  ... 11 more 
```

这是 MainActivity.java

```
package com.formation.gmaps;

import android.os.Bundle;
import android.view.Menu;

import com.google.android.maps.MapActivity;

public class MainActivity extends MapActivity {

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_main);
    }

    @Override
    public boolean onCreateOptionsMenu(Menu menu) {
        // Inflate the menu; this adds items to the action bar if it is present.
        getMenuInflater().inflate(R.menu.activity_main, menu);
        return true;
    }

    @Override
    protected boolean isRouteDisplayed() {
        // TODO Auto-generated method stub
        return false;
    }

} 
```

这是 AndroidManifest.xml：

```
<?xml version="1.0" encoding="utf-8"?>
<manifest xmlns:android="http://schemas.android.com/apk/res/android"
    package="com.formation.gmaps.MainActivity"
    android:versionCode="1"
    android:versionName="1.0" >

    <uses-sdk
        android:minSdkVersion="8"
        android:targetSdkVersion="8" />
    <uses-permission android:name="android.permission.INTERNET"/>
    <uses-permission android:name="android.permission.ACCESS_COARSE_LOCATION"/>
    <uses-permission android:name="android.permission.ACCESS_FINE_LOCATION"/>
    <uses-permission android:name="android.permission.ACCESS_MOCK_LOCATION"/>
    <uses-permission android:name="android.permission.ACCESS_GPS"/>
    <uses-permission android:name="android.permission.ACCESS_ASSISTED_GPS"/>
    <uses-permission android:name="android.permission.WRITE_EXTERNAL_STORAGE"/>

    <application
        android:allowBackup="true"
        android:icon="@drawable/ic_launcher"
        android:label="@string/app_name"
        android:theme="@style/AppTheme" >
        <activity
            android:name="com.formation.gmaps.MainActivity"
            android:label="@string/app_name" >
            <intent-filter>
                <action android:name="android.intent.action.MAIN" />

                <category android:name="android.intent.category.LAUNCHER" />
            </intent-filter>
        </activity>
    </application>

</manifest> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-25T19:39:53.940

系统在您的**com.formation.gmaps**包中找不到**MainActivity.class 。**这可能是由很多原因引起的，但您可以**检查是否**：

 ******1.**您在AndroidManifest.xml 中声明了您的活动**com.formation.gmaps.MainActivity** **。**

**2.**您的 MainActivity.java 在文件顶部设置了正确的包名称（例如，包 com.formation.gmaps）。

**3.**你应该有`import com.formation.gmaps.R;`

**4.**在 Eclipse 中使用快捷键 CTRL + SHIFT + O。这将导入任何缺少的类。

**5.** Project -> Clean 也可以提供帮助（前提是您使用的是 Eclipse）。

**编辑**

在您的 AndroidManifest.xml 中更改`package="com.formation.gmaps.MainActivity"`为`package="com.formation.gmaps"`.

**编辑 02**

您的问题是您的 MapActivity.java。**读[这个](https://developers.google.com/maps/documentation/android/)**。如果您使用了最新的 API，那么本段将对其进行解释：

> 因为地图封装在 MapFragment 类中，所以可以通过扩展 Android 标准 Activity 类来实现，而不是扩展版本 1 中使用的 MapActivity。

所以请检查您的 MapActivity.class。如果它扩展了 Fragment，那么问题就在那里。您可以通过将 MainActivity 更改为范围 Activity 而不是 MapActivity 来测试这一点。不要忘记添加`import android.app.Activity;`

如果您仍在使用 V1 地图，请阅读我提供的链接上的文档并切换到 V2。您可能仍在使用需要导入 maps.jar 的过程的旧版本。

**[这](https://stackoverflow.com/questions/3621163/cannot-resolve-mapactivity-class-on-android)**也可能对您有所帮助。

祝您好运，如果您遇到更多麻烦，请告诉我们。****

# c# - 将值从结构分配给变量失败

> ID：15617451
> 
> 赞同：2
> 
> 时间：2013-03-25T14:29:27.333
> 
> 标签：c#, c, struct, assign

*编辑 3 描述了调试后缩小的问题*

*编辑 4 包含解决方案 - 这完全是关于 C 和 C# 之间的类型差异*

今天我遇到了一个奇怪的问题。在 CI 中具有以下结构：

```
typedef struct s_z88i2
{
    long Node;
    long DOF;
    long TypeFlag;
    double CValue;

}s_z88i2; 
```

此外，我有一个功能（这是一个简化版本）：

```
DLLIMPORT int pass_i2(s_z88i2 inp, int total)
{
    long nkn=0,ifg=0,iflag1=0;
    double wert=0;
    int val;

    // Testplace 1
    nkn=inp.Node;
    ifg=inp.DOF;
    iflag1=inp.TypeFlag;
    wert=inp.CValue;
    // Testplace 2

    return 0;
} 
```

分配的值无处使用 - 我知道这一点。当我到达`// Testplace 1`以下语句时执行：

```
char tmpstr[256];
sprintf(tmpstr,"RB, Node#: %li, DOF#: %li, Type#: %li, Value: %f", inp.Node, inp.DOF, inp.TypeFlag, inp.CValue); 
```

`tmpstr`然后传递给消息框。它显示 - 正如人们所期望的那样 - 我以一种很好且有序的方式传递给函数的结构中给出的值。继续通过函数，结构内的值被分配给一些变量。到达`Testplace 2`时执行以下操作：

```
sprintf(tmpstr,"RB, Node#: %li, DOF#: %li, Type#: %li, Value: %f",nkn, ifg, iflag1, wert); 
```

再次，`tmpstr`被传递到一个消息框。然而，这并没有表明人们会期望什么。`Node`和的值`Type`仍然正确。因为`DOF`和`Value`显示的值`0`使我得出结论，在分配值期间出现了严重错误。有时我不知何故设法获得了一种方法来获得长数字的价值 whis 与`0`. 但是在我上次的测试中，我无法重现这个错误。的可能值为`inp`eg `{2,1,1,-451.387}`，因此第一个`1`和`-451.387`被遗忘。

有谁知道我做错了什么或如何解决这个问题？

提前谢谢了！

**编辑：**

改成`%i`，`%li`但结果没有改变。感谢放松！

我正在使用 MinGW（不幸的是）使用 Dev-Cpp 开发这个 dll，因为我无法说服 Visual Studio 2012 Pro 正确编译它。尽管原始来源的文档说它是普通的 ANSI-C。这让我有点恼火，因为我无法使用 Dev-Cpp 正确调试这个 dll。因此消息框。

**编辑2：**

正如 Neil Townsend 建议的那样，我转而通过参考。但这也没有解决问题。当我直接访问结构中的值时，一切都很好。当我将它们分配给变量时，有些会丢失。

关于我如何调用该函数的简短通知。该 dll 将从 C# 访问，所以我正在干预 P/Invoke（据我所知）。

```
[DllImport("z88rDLL", CallingConvention = CallingConvention.Cdecl)]
public static extern int pass_i2(ref s_z88i2 inp, int total); 
```

是我在 C# 中的定义。我导入了许多其他功能，它们都可以正常工作。正是这个功能我第一次遇到这些问题。我通过以下方式调用该函数：

```
s_z88i2 tmpi2 = FilesZ88.z88i2F.ConstraintsList[i];
int res = SimulationsCom.pass_i2(ref tmpi2, FilesZ88.z88i2F.ConstraintsList.Count); 
```

首先我设置结构，然后调用函数。

为什么哦 为什么VS在编译ANSI-C时要挑剔？它肯定会让事情变得更容易。

**编辑3：**

我认为，我可以将问题缩小到`sprintf`。在说服 VS 构建我的 dll 之后，我能够逐步完成它。看来，这些值确实很好地分配给了它们所属的变量。但是，如果我想通过`sprintf`它们打印这些变量，结果却是空的（`0`）。奇怪的是，价值始终是`0`而不是别的东西。我仍然对*为什么会有* `sprintf`这种行为感兴趣，但我认为我最初的问题已经解决/恐慌被打败了。所以谢谢大家！

**编辑4：**

正如 supercat 在下面指出的那样，我重新考虑了 C 和 C# 之间的类型兼容性。我知道`int`C# 中的 a 评估为 C 中的 a `long`。但是经过仔细检查后，我发现在 C 中我的变量确实是`FR_INT4`（出于清晰的原因，我将其排除在原始问题之外=> 坏主意）。内部`FR_INT4`定义为：`#define FR_INT4 long long`，所以为超长-长。一个快速测试表明，从 C# 传递一个 long 可以提供最好的兼容性。所以`sprintf`-issue 可以简化为问题：“long long 的格式标识符是什么？”。

实际上`%lli`，这很简单。所以我可以宣布*我*的问题真的解决了！

```
sprintf(tmpstr,"RB, Node#: %lli, DOF#: %lli, Typ#: %lli, Wert: %f\n", inp.Node, inp.DOF, inp.TypeFlag, inp.CValue); 
```

返回我想要的每个值。**非常感谢大家！**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-25T14:34:54.970

`long`使用格式说明符格式化类型值`%i`无效。你应该使用`%li`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-27T07:45:01.820

为了澄清这一点，回答：

我的结构实际上是：

```
typedef struct s_z88i2
{
    long long Node;
    long long DOF;
    long long TypeFlag;
    double CValue;
}s_z88i2; 
```

这需要`long`从 C# 传递（而不是`int`我以前认为的那样）。通过调试我发现值的赋值行为正常，问题出在`sprintf`. 如果我使用`%lli`格式标识符，即使这个问题也解决了。

```
sprintf(tmpstr,"RB, Node#: %lli, DOF#: %lli, Typ#: %lli, Wert: %f\n", inp.Node, inp.DOF, inp.TypeFlag, inp.CValue); 
```

是我需要使用的语句。所以再次感谢所有贡献的人！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-25T15:09:21.477

在 C 中，将引用或指针传递给结构而不是结构是一种更好的方法。所以：

```
DLLIMPORT int pass_i2(s_z88i2 *inp, int total) {
    long nkn=0,ifg=0,iflag1=0;
    double wert=0;
    int val;

    // Testplace 1
    nkn=inp->Node;
    ifg=inp->DOF;
    iflag1=inp->TypeFlag;
    wert=inp->CValue;
    // Testplace 2

   return 0;
} 
```

您将需要相应地更正 sprintf 行，`inp.X`变为`inp->X`. 要使用此功能：

```
 // Option A - create it in a declaration, fill it, and send a pointer to that
 struct s_z88i2 thing;
 // fill out thing
 // eg. thing.Node = 2;
 pass_i2(&thing, TOTAL); 
```

或者：

```
 // Option B - create a pointer; create the memory for the struct, fill it, and send the pointer
 struct s_z88i2 *thing;
 thing = malloc(sizeof(struct s_z88i2));
 // fill out thing
 // eg thing->Node = 2;
 pass_i2(thing, TOTAL); 
```

这种方式`pass_i2`将对您发送的结构进行操作，并且它所做的任何更改都将在从`pass_i2`.

# javascript - 选定索引未定义

> ID：15617456
> 
> 赞同：0
> 
> 时间：2013-03-25T14:29:50.083
> 
> 标签：javascript, html

我有一个选项字段和onChange，我调用了一个函数，但参数为null

### 标记

```
<select name="estado" id="estado" onchange="setCidade(this.SelectedIndex)">
    <option name="BR" value="BR">Barueri</option>
    <option name="BH" value="BH">Belo Horizonte</option>
    <option name="BS" value="BS">Brasilia</option>
    <option name="CP" value="CP">Campinas</option>
    <option name="CU" value="CU">Cuiaba</option>
    <option name="CT" value="CT">Curitiba</option>
    <option name="DI" value="DI">Diadema</option>
    <option  value="DQ">Duque de Caxias</option>
    <option value="FL">Florianopolis</option>
    <option value="FO">Fortaleza</option>
    <option value="GO">Goiania</option>
    <option value="GU">Guarulhos</option>
    <option value="PA">Porto Alegre</option>
    <option value="OS">Osasco</option>
    <option value="RE">Recife</option>
    <option value="RJ">Rio de Janeiro</option>
    <option value="SS">Salvador</option>
    <option value="SA">Santo Andre</option>
    <option value="SB">São Bernardo do Campo</option>
    <option value="SC">São Caetano do Sul</option>
    <option value="SP">São Paulo</option>
    <option value="VI">Vitória</option>
</select> 
```

### Javascript

```
function setCidade (indiceSelecionado) {
    alert(indiceSelecionado);//the alert show "undefined"
    indexCidade = indiceSelecionado;
    mudarCidade();
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-25T14:32:24.943

代替

```
SelectedIndex 
```

和

```
selectedIndex 
```

第一个“s”是小写的。

# windows-7 - Windows XP 32 位到 Windows 7 64 位上的 PowerBuilder 10.5 应用程序

> ID：15617464
> 
> 赞同：1
> 
> 时间：2013-03-25T14:30:08.827
> 
> 标签：windows-7, oledb, powerbuilder, powerbuilder-build-deploy

我目前有一个 32 位 PowerBuilder 应用程序，我们正在尝试将其移植到 Windows 7 64 位环境。意识到 PowerBuilder 10.5 是在 Window7 出现之前构建的，以及这个应用程序构建在 Windows XP 32 位环境中的明显事实。

32 位 PowerBuilder 应用程序在 Windows 7 64 位计算机上部署时会出现以下错误消息。 **应用程序终止。错误：在对象*objectwindow的函数**ivvisiblecolumn*的第 44 行中指定的 DataWindow 行/列无效**

 *数据库配置文件设置指向 OLEDB，后端数据库是 MSSQL 2008。目前该应用程序确实在 Windows7 64 位环境中运行，并且似乎仅在查询模式下工作。这意味着我们可以读取数据窗口上的一些记录，但是一旦您尝试进行交易，它就会爆炸。

我的问题是 - 是否可以让 32 位应用程序在 64 位环境中运行？

到目前为止，客户要求提出可能的解决方案，但没有升级到 PowerBuilder 12.5 的想法。本质上，他们希望保持在 10.5，但让应用程序从 32 位环境运行到 64 位……如果你明白我的意思的话，苹果到橙子。需要进一步调查代码是否无法在 64 位中运行，或者 64 位中 powerbuilder 客户端运行时的 dll 问题。他们真的试图远离任何应用程序重写，因为应用程序比基督成为木匠时更古老。我认为该应用程序最初是在 PB 6.5 中构建的。

到目前为止，我有以下想法，但我对此并不陌生： - 我了解 Windows 7 带有虚拟机 IIRC。我认为它被称为WOW64。是否可以在服务器上创建虚拟机并让用户在 64 位机器中运行 32 位应用程序？然后创建某种快捷方式供用户简单地点击？

*   我们确实有一台虚拟 XP 机器和一台虚拟 Windows7 64 位机器用于测试。PowerBuilder 10.5 实际安装在 Windows 7 上并且似乎运行良好。然而，在运行模式或调试下运行应用程序会导致许多错误，如您所想。
*   该应用程序已在 XP 中构建并在 Windows 7 上运行，但结果出现上述错误消息。
*   我还没有研究在兼容模式下运行，但是团队告诉我它不起作用。
*   我还没有看过 UAC 或 ALC 用户管理。这会影响 64 位系统吗？

*   我知道这与应用程序无关，但是...我已经看到在某些情况下，32 位应用程序只需针对某些 DLL 文件即可在 Windows 64 位环境中工作。一个示例是 Microsoft Flight Simulator X，其中 32 位游戏会在 64 位 Windows 7 中崩溃。解决方案是简单地获取一个名为 uiautomationcore.dll 的 Vista 64 位 DLL 文件并将其复制到 Windows 环境中。游戏还必须安装在 C: 的根目录上才能运行。

有人对我如何解决这个问题有任何建议吗？

如果我在这里的笔记含糊不清，我深表歉意。

**更新：有人在 64 位机器上使用过 PB 10.5 运行时文件吗？我想知道 powerbuilder 客户端运行时是否将其 dll 安装到应用程序 C:\XXX 的正确位置或找不到它？想知道如何解决这个问题。**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-25T15:34:45.967

*   基本上没有什么可以阻止 10.5 PB 应用程序在 Win7/64 上运行。我在 PB11.5（也是一个 32 位 IDE）中在 win7/64 上开发和运行了几个产品。顺便说一句，一些像 9 这样的旧 PB 仍然在 Win7 上运行，所以很可能是 PB6.5。与应用程序设计相关的问题肯定出在其他地方。
*   WoW64（和注册表中的 Wow6432Node）不是一个真正的 VM，它是一组服务和系统 API，与 32 位应用程序（以及不符合自 Vista 以来引入的新事物的旧应用程序）的回退挂钩
*   `Error: Invalid DataWindow row/column specified at line 44 in function ivvisiblecolumn of object objectwindow`听起来通常像一个错误处理的返回值（在尝试访问给定无效行的属性或数据之前，计算的行号变为负数或 null），或者它可能与从插入后的 db
*   当心 UAC 管理可能导致遗留应用程序出现意外行为，特别是如果应用程序正在使用数据库：UAC 指南告诉不要将应用程序管理的数据安装在`Program Files`现在只读的文件夹中（从 Vista 开始 - 该指南是自 XP 以来）。相反，如果每个人都可以访问它，则必须将其放入`ProgramData`子目录；`AppData`如果数据仅适用于当前用户，则必须将其放入本地用户。Win7/Vista 可以通过将数据本地复制给用户（`Users\username\AppData\Local\VirtualStore`在`Program Files`.
*   您可以尝试使用[Dependency Walker](http://dependencywalker.com)来查找不正确的 dll 问题

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-25T15:49:47.943

我们将许多应用程序移至 Windows 7 64 位。我们遇到的唯一问题是数据库连接。您正在运行一个 32 位应用程序，因此您需要连接到 32 位数据库。如果您从控制面板中调出“数据源 (ODBC)”，您将看到 64 位条目。您需要使用“C:\Windows\SysWOW64\odbcad32.exe”中的 32 位 ODBC。您需要的注册表项位于以下位置...

```
HKEY_LOCAL_MACHINE\SOFTWARE\Wow6432Node\ODBC\ODBCINST.INI
HKEY_LOCAL_MACHINE\SOFTWARE\Wow6432Node\ODBC\ODBCINST.INI\ODBC Drivers
HKEY_LOCAL_MACHINE\SOFTWARE\Wow6432Node\ODBC\ODBC.INI
HKEY_LOCAL_MACHINE\SOFTWARE\Wow6432Node\ODBC\ODBC.INI\ODBC Data Sources 
```

或者

```
HKEY_CURRENT_USER\SOFTWARE\Wow6432Node\ODBC\ODBCINST.INI
HKEY_CURRENT_USER\SOFTWARE\Wow6432Node\ODBC\ODBCINST.INI\ODBC Drivers
HKEY_CURRENT_USER\SOFTWARE\Wow6432Node\ODBC\ODBC.INI
HKEY_CURRENT_USER\SOFTWARE\Wow6432Node\ODBC\ODBC.INI\ODBC Data Sources 
```*

# mysql - 获取海量数据的最佳方式

> ID：15617465
> 
> 赞同：0
> 
> 时间：2013-03-25T14:30:09.027
> 
> 标签：mysql, database, wordpress

首先让我描述一下我的情况：

我需要为每个用户存储大约 200 个额外的详细信息。我正在使用wordpress。现在有一个默认功能来保存与用户关联的数据。但我不确定我应该使用什么。就我而言，我需要 1 页中的一些数据。例如，我在一页中需要 20 个数据，在另一页中需要 100 个数据。用户可能一次需要 20 个数据或一次需要 100 个数据。

我还没有设计我的数据库表。在了解了最好的查询方式后，我会设计它。要获取用户的 200 个数据（字段），如果可以进行 200 个搜索查询，那么我将使用 wordpress 默认元表。结构如下。

```
----------------------------------------------
| umeta_id | user_id | meta_key | meta_value |
---------------------------------------------- 
```

从上面的结构你可以看到 wordpress 将单个用户的每个数据保存为一行。所以在这种情况下，对于一个用户的 200 个数据，wordpress 将保存 200 行。为了检索数据，我必须进行 200 次查询。

现在，如果最好通过单个查询获取用户的所有数据并将其保存在会话中，那么我将创建自己的表。结构如下。

```
---------------------------------------------------------------
| User_ID | User_detail_1 | User_detail_2 | User_detail_3 | ...
--------------------------------------------------------------- 
```

在上述结构中，我可以将所有这 200 个数据保存在一行中，并且可以在一个查询中获取所有数据，然后在需要时保存到会话和用户。

现在在我的网站中，我不需要一页中的所有数据。在一页上我可能需要 100 个数据，而在另一页上我可能需要 50 个数据。因此，考虑到我的情况，我是否应该将每个数据保存为一行（使用 wordpress 元表），然后对需要 100 个数据的页面进行 100 次查询，并在需要 50 个数据的地方进行 50 次查询？

或者我应该使用一个查询并获取所有数据，保存在 SESSION 然后使用来自需要 50 或 100 个数据的 SESSION 的数据？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-25T14:53:02.163

您不需要 200 个查询来获取 200 个值！

例如，如果在 1 页中，您需要获取具有键“my_data_1”、“my_data_2”和“my_data_3”的 3 个字段，则可以在 where 条件中使用“OR”在单个 sql 查询中获取它们。

```
SELECT meta_key, meta_value from TABLE_NAME where meta_key='my_data_1' OR 
meta_key='my_data_2' OR meta_key='my_data_3'; 
```

这将在单个查询中返回单个结果表中的所有 ur 值：

```
------------------------
 meta_key | meta_value |
------------------------
my_data_1 | my_value_1
------------------------
my_data_2 | my_value_2
------------------------
my_data_3 | my_value_3
------------------------ 
```

然后你可以在你的应用程序中处理它们

# java - 将属性文件留在分离的 Java 项目中的最佳方法或最佳实践是什么？

> ID：15617467
> 
> 赞同：0
> 
> 时间：2013-03-25T14:30:20.077
> 
> 标签：java, web-applications, properties, configuration

我有一个项目将分开为：

*   a)**业务层**（包含所有核心 Java 类和一些配置（服务等））和
*   b)**表示层**（包含所有基于 Spring webflow 的 web 结构以及上面的所有配置文件。所以在开发过程中，我们有几个属性文件分布在`java/main/src`一个`resource.properties.*`包中，我们在 web 结构中还有其他属性在下面 `WEB-INF/conf` 和`WEB-INF/i18n`（这是屏幕的标签消息）..所以我的问题如下：

    1.  将属性文件留 `java/main/src`在包中是正确的，以后将`classes` 在 webapp 中的文件夹下？
    2.  将所有属性文件放在一个地方的最佳方法是什么*`WEB-INF/configurations`*？还是将业务层的一些属性文件放在一个地方，将表示层的一些属性文件放在另一个地方？
    3.  以安装 webapp 的最佳方式拥有此属性的最佳方法是什么？在 JAR 文件中交付属性并将其包含在 WAR 或 EAR 中？这允许我们在不部署整个应用程序的情况下即时修改并包含在战争中......或者哪种方法是最好的或使用的方法来实现这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-25T14:45:54.143

我发现将属性分为两类很有帮助：

1.  用于方便更改应用程序外观和行为的属性
2.  环境特定设置的属性（例如 DEV 与 PRODUCTION）

类别 #1 可以嵌入到您的 WAR 文件中，只要有意义。in`WEB-INF/classes`是一个很受欢迎的地方，但是把它们放在`META-INF`jar 文件中也可以很好地工作。选择你喜欢的标准并坚持下去是值得的。底线是这些文件在开发过程中被更改；它们在部署后不会更改，并且在系统发布时保持不变。

类别#2 应该始终与可部署的分开。理想情况下，特定于环境的属性应仅在它们发生更改时才部署。这实际上是他们所在的配置管理 (CM) 决策。开发人员需要提供这些配置文件的基本版本，CM 应该在将它们部署到特定环境（QA、PRE-PROD、PROD）时对其进行编辑。在强制委派职责的情况下（例如，在 SOX 应用的情况下），开发人员绝不应该接触或看到属性文件的生产版本。我见过很多情况，这些文件的不同版本（DEV/QA/PROD）由开发人员维护并保存在源代码控制中，这是不合适的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-25T14:34:00.827

我认为拥有一个单独的源文件夹“资源”并将所有属性文件保存在那里是件好事。这些还确保属性文件不会混淆源代码。

# java - 包含 zip 文件的 base64 字符串的解码在结果字符串中得到 8 个字符代码错误

> ID：15617468
> 
> 赞同：1
> 
> 时间：2013-03-25T14:30:23.267
> 
> 标签：java, character-encoding, zip, base64, decode

我从 SOAP 请求中接收到 base64 编码的 zip 文件（以字符串的形式）。
我可以使用独立程序 b64dec.exe 成功解码字符串，但我需要在 java 例程中完成。我正在尝试使用 Apache commons-codec-1.7.jar 例程对其进行解码（ *theZipString ）：*

```
import org.apache.commons.codec.binary.Base64;  
import org.apache.commons.codec.binary.StringUtils;
StringUtils.newString(Base64.decodeBase64(theZipString), "ISO-8859-1"); 
```

Zip 文件阅读器打开生成的文件并显示内容文件列表，但内容文件有 CRC 错误。

我将我的 java 例程的结果与 b64dec.exe 程序（使用 UltraEdit）的结果进行了比较，发现它们是相同的，除了在 b64dec.exe 结果中出现的八个不同字节值被替换由我的 3F（“？”）。这些值及其 ISO-8859-1 字符名称为 A4（'currency'）、A6（'broken bar'）、A8（'diaeresis'）、B4（'acute accent'）、B8（'cedilla'）、BC （“粗俗分数 1/4”）、BD（“粗俗分数 1/2”）和 BE（“粗俗分数 3/4”）。

我猜 StringUtils.newString 函数没有将这八个值转换为字符串输出，因为我尝试了其他 8 位字符集：UTF-8 和 cp437。他们的结果相似但更糟，有更多的 3F，“？” 换人。

有什么建议么？我应该为 newString 函数使用什么字符集来转换 .zip 字符串？Apache 功能是否无法进行这种翻译？有没有更好的方法来做这个解码？

谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-25T14:33:16.443

zip 文件*不是*字符串。它*不是*编码文本。它可能包含文本文件，但这不是一回事。这只是二进制数据。

如果将任意二进制数据视为字符串，*就会*发生不好的事情。相反，您应该使用流或字节数组。所以这很好：

```
byte[] zipData = Base64.decodeBase64(theZipString); 
```

...但*不要*尝试将其转换为字符串。如果您将其写入`byte[]`文件（可能使用`FileOutputStream`或某些实用程序方法）应该没问题。

# ruby-on-rails - 如何使用 has_and_belongs_to_many 关联实现像 Twitter 这样的追随者系统？

> ID：15617469
> 
> 赞同：0
> 
> 时间：2013-03-25T14:30:26.297
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3, activerecord, twitter

我是Rails的新手。我想创建一个像 Twitter 这样的小型 SNS。
如何在has_and_belongs_to_many 中用AciveRecord 实现follower 系统？
我创建了一个“用户”表。而追随者关系是一个用户和一个用户之间的多对多逻辑。
那么如何对模型类进行减速并创建连接表呢？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-25T15:06:31.533

railstutorial 的最后一章是在谈论你想要什么。 [http://ruby.railstutorial.org/chapters/following-users#top](http://ruby.railstutorial.org/chapters/following-users#top)

# jquery - 在 jQuery Mobile 1.3.0 中更改按钮主题

> ID：15617476
> 
> 赞同：1
> 
> 时间：2013-03-25T14:30:29.593
> 
> 标签：jquery, html, css, jquery-mobile, jquery-mobile-button

我看到 jQuery Mobile 1.3.0 中应该有新功能，我们可以从 JavaScript 动态更改按钮主题：http: [//jquerymobile.com/blog/2013/02/20/jquery-mobile-1-3-0-发布/](http://jquerymobile.com/blog/2013/02/20/jquery-mobile-1-3-0-released/)

但是当我尝试运行以下代码时，我在控制台中收到错误消息。它说**“没有方法'_setOption'”**，所以我开始猜测它是否真的实现了。

这个新功能真的实现了吗？如果是这样，如果让我知道如何从 JavaScript 中使用它，那将不胜感激。谢谢。

```
(HTML)
<a id="btn1" data-role="button" data-theme="e" onClick="clk();">XXX</a>

(JavaScript)
function clk(){
  var $btn = $('#btn1');
  $btn._setOption('data-theme', 'b');
}

(Console)
Uncaught TypeError: Object [object Object] has no method '_setOption' 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-25T14:40:59.377

你使用了不正确的功能，你应该使用这个：

```
$( "a" ).buttonMarkup({ theme: "c" }); 
```

官方文档：[http ://api.jquerymobile.com/button/#option-theme](http://api.jquerymobile.com/button/#option-theme)

现场 jsFiddle 示例：http: [//jsfiddle.net/Gajotres/eqLVV/](http://jsfiddle.net/Gajotres/eqLVV/)

# cmake - 如何使用 CMAKE 设置最大路径长度？

> ID：15617484
> 
> 赞同：2
> 
> 时间：2013-03-25T14:30:45.623
> 
> 标签：cmake

如何使用 CMAKE 在变量中设置最大路径长度？

我知道如何从我的计算机上获取它：

```
cabellos@ozzy:~$ getconf PATH_MAX /
4096
cabellos@ozzy:~$ getconf NAME_MAX /
255 
```

但这仅适用于Linux，不是吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-05-10T09:14:27.033

使用评论，我解决了下一个代码：

```
if(CMAKE_HOST_UNIX)
  execute_process( COMMAND getconf PATH_MAX / 
    OUTPUT_VARIABLE OBJECT_PATH_MAX OUTPUT_STRIP_TRAILING_WHITESPACE)
  execute_process( COMMAND getconf NAME_MAX / 
    OUTPUT_VARIABLE OBJECT_NAME_MAX OUTPUT_STRIP_TRAILING_WHITESPACE)
else()
  set(OBJECT_PATH_MAX 260)
  set(OBJECT_NAME_MAX 255)
endif() 
```

# jquery - 如何改变动态组合框的行为

> ID：15617486
> 
> 赞同：0
> 
> 时间：2013-03-25T14:30:49.457
> 
> 标签：jquery, html, combobox

查询：

```
$('body').on('change', '.combo', function() {
    var selectedValue = $(this).val();

    if ($(this).find('option').size() > 2) {
        var newComboBox = $(this).clone();
        var thisComboBoxIndex = $(this).attr('id').replace("combo", "");
        var newComboBoxIndex = thisComboBoxIndex + 10;

        $('.parentCombo' + thisComboBoxIndex).remove();

        if (selectedValue != '') {
            newComboBox.attr('data-index', newComboBoxIndex);
            newComboBox.attr('id', 'combo' + thisComboBoxIndex);
            newComboBox.find('option[val="' + selectedValue + '"]').remove();
            $('div.'+thisComboBoxIndex).append(newComboBox);
        }
    } 
});​ 
```

HTML：

```
 <div class="1">
    <select id="combo1" class="combo" data-index="1">
        <option></option>
        <option val="1">Opt1</option>
        <option val="2">Opt2</option>
        <option val="3">Opt3</option>
    </select>
</div>
<br>
<div class="2">
    <select id="combo2" class="combo" data-index="2">
        <option></option>
        <option val="1">Opt1</option>
        <option val="2">Opt2</option>
        <option val="3">Opt3</option>
    </select>
</div> 
```

工作 [小提琴](http://jsfiddle.net/JaVVe/19/)

正如您在小提琴中看到的，如果您选择选项 2，则下一个组合框选项将是：选项 1 和选项 3。

我想要的是：

如果我选择选项 2，下一个组合框选项应该是：选项 3（仅限）。

这意味着根据选择的选项，下一个组合框（动态组合框）不应包含低于自身的选项。

那怎么能做到呢？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-25T14:39:50.857

看到这个：

```
 newComboBox.find('option').each(function(){
     if(this.value < selectedValue) $(this).remove();
 }); 
```

[样本](http://jsfiddle.net/JaVVe/39/)

# android - 使用寿命比应用程序长

> ID：15617487
> 
> 赞同：1
> 
> 时间：2013-03-25T14:30:49.997
> 
> 标签：android, android-service

在我的 android 应用程序中，我使用了一个[前台服务](http://developer.android.com/reference/android/app/Service.html)，该服务正在生成一个线程作为工作人员。有时我观察到应用程序被终止，但线程仍在尝试引用一些不再可用的值。

android 可以决定终止我的应用程序而使服务仍在运行吗？

我正在我的服务的 onDestroy() 方法中停止线程，因此想知道 Android 何时终止应用程序，它会调用 Service:onDestroy()。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-25T14:41:39.630

Android 中的所有应用程序都作为类似于 linux 进程的单独进程运行。因此，如果您的服务在单独的进程中运行，那么 Android 可能会决定在某个时候关闭某个进程，此时内存不足且其他进程需要更直接地为用户提供服务。在被杀死的进程中运行的应用程序组件因此被破坏。当这些组件再次有工作要做时，将再次为这些组件启动一个流程。

在决定要杀死哪些进程时，Android 系统会权衡它们对用户的相对重要性。例如，与托管可见活动的流程相比，它更容易关闭托管在屏幕上不再可见的活动的流程。因此，是否终止进程的决定取决于在该进程中运行的组件的状态。下面讨论用于决定终止哪些进程的规则。

您还可以通过使用清单中的 android:process 属性来控制您的服务是否可以在与您的应用程序相同的进程中运行或在单独的进程中运行。

有关更多信息，您可以在以下链接中阅读有关进程和线程的信息：

[http://developer.android.com/guide/components/processes-and-threads.html](http://developer.android.com/guide/components/processes-and-threads.html)

# java - GAE 查询适用于单元测试，但不适用于本地测试

> ID：15617489
> 
> 赞同：0
> 
> 时间：2013-03-25T14:30:51.470
> 
> 标签：java, mysql, google-app-engine

我的单元测试对此查询工作正常，但是当我在本地运行我的应用程序时，它找不到列卖方。

```
String statement = "SELECT * FROM " + TABLE_NAME + " "
+ "INNER JOIN " + DbSeller.TABLE_NAME + " seller ON video.seller = seller.id "
+ "WHERE video.name LIKE ?";        
//create statement
PreparedStatement stmt = DataBase.getInstance().prepareStatement(statement);        
//set data
stmt.setString(1, "%" + s + "%");
//send query
ResultSet rs = stmt.executeQuery();
//the result
while(rs.next()) {          
  Video v = new Video();
  System.out.println("test === " + rs.getInt("seller.id")); // <---- EXCEPTION (Column not found!!!!)
  set(rs, v);           
  listVideo.add(v);         
}   
stmt.close(); 
```

如果我这样做，那很好：（只是为了测试，我不想逐列写出我需要的信息）

```
String statement = "SELECT video.*, seller.id as seller_id FROM " + TABLE_NAME + " "
+ "INNER JOIN " + DbSeller.TABLE_NAME + " seller ON video.seller = seller.id "
+ "WHERE video.name LIKE ?";        
//create statement
PreparedStatement stmt = DataBase.getInstance().prepareStatement(statement);        
//set data
stmt.setString(1, "%" + s + "%");
//send query
ResultSet rs = stmt.executeQuery();
//the result
while(rs.next()) {          
  Video v = new Video();
  System.out.println("test === " + rs.getInt("seller_id")); // <---- NO EXCEPTION
  set(rs, v);           
  listVideo.add(v);         
}   
stmt.close(); 
```

注意：我的应用程序在 MySQL 中的同一个离线数据库上运行，因此唯一的区别是我通过我的应用程序而不是单元测试运行此查询。

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2013-03-25T14:55:17.247

列名`seller_id`（下划线）和`seller.id`（点）对我来说看起来不同

# facebook-graph-api - 图形 API 返回空数据

> ID：15617491
> 
> 赞同：1
> 
> 时间：2013-03-25T14:30:54.597
> 
> 标签：facebook-graph-api, web-crawler

对于一个项目，我需要使用 Graph API（和 R）抓取一些 Facebook 页面。这些页面是 MonsterEnergy、RedBull 和 Rockstar。Monster 和 Rockstar 工作得很好，但 Graph API 在 RedBull 上运行。我只能得到今天发布的帖子。

示例： [https](https://graph.facebook.com/14226545351/posts?access_token=) ://graph.facebook.com/14226545351/posts?access_token= {有效访问令牌}

转到“下一个”URL 时，仅返回一个空数据数组。我在我的访问令牌上启用了所有权限，我可以在他们的页面上看到他们所有的帖子。

知道是什么原因造成的吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-25T14:49:23.043

处理新闻提要的 Facebook 表格在设计上已经步履蹒跚。没有限制的调用将仅返回最近 30 天的数据或 50 个帖子，以较少者为准。如果一个页面超过 30 天没有发布，您最终可能没有任何回报。

如果您需要更多帖子，而不是翻阅它们，最好传递一个`limit`参数来明确请求更多帖子。

尝试这个：

```
https://graph.facebook.com/14226545351/posts?limit=100&access_token=ACCESS_TOKEN 
```

# javascript - 按下按钮时的 Jquery 移动切换按钮数据主题

> ID：15617495
> 
> 赞同：1
> 
> 时间：2013-03-25T14:31:04.500
> 
> 标签：javascript, jquery, css, jquery-mobile

我有某个类别的按钮

```
<div class="prog-day">
    <div class="prog-clear" data-role="controlgroup" data-type="horizontal">
        <a href="#" data-role="button" data-mini="true" data-theme="b">Clear</a>
    </div>  
    <p></p>
</div 
```

我想在点击时切换主题颜色。切换 ID 发生变化并显示数据主题字母，但颜色没有变化。这是我根据其他帖子尝试过的所有事情（触发、创建、刷新）

```
$(".prog-day a").click(function() {
    console.log("clicked a day button");
    progToggle = $(this).attr("progToggle");
    if ( progToggle == "1"  ) {
        $(this).attr("data-theme","b").refresh;
        $(this).attr("progToggle","0");
        $(this).trigger('create');
        $(this).trigger('refresh');
        $('.prog-day p').html($(this).attr("progToggle")+$(this).attr("data-theme"));
        progToggle = $(this).attr("progToggle");
     }
     else {
        $(this).attr("data-theme","d").refresh;
        $(this).attr("progToggle","1");
        $(this).trigger('create');
        $(this).trigger('refresh');
        $('.prog-day p').html($(this).attr("progToggle")+$(this).attr("data-theme"));
        progToggle = $(this).attr("progToggle");
    }           
}); 
```

我在这里想念什么。我最好跳过这个JQM stying 的东西，自己做吗？我实际上希望按钮在按下时切换，而不是释放。也许你可以摆弄[http://jsfiddle.net/PLx8v/3/](http://jsfiddle.net/PLx8v/3/)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-25T14:48:02.910

如果您要检查是否相等，请确保您的 if 语句有 3 个等号

```
if( progToggle === '1' ) {} 
```

# python - 重采样多索引 DataFrame

> ID：15617496
> 
> 赞同：7
> 
> 时间：2013-03-25T14:31:05.217
> 
> 标签：python, pandas

我想使用包含日期时间列和其他一些键的多索引[重新采样 DataFrame 。](https://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.resample.html)数据框看起来像：

```
import pandas as pd
from StringIO import StringIO

csv = StringIO("""ID,NAME,DATE,VAR1
1,a,03-JAN-2013,69
1,a,04-JAN-2013,77
1,a,05-JAN-2013,75
2,b,03-JAN-2013,69
2,b,04-JAN-2013,75
2,b,05-JAN-2013,72""")

df = pd.read_csv(csv, index_col=['DATE', 'ID'], parse_dates=['DATE'])
df.columns.name = 'Params' 
```

因为只允许在数据时间索引上重新采样，所以我认为[取消堆叠](http://pandas.pydata.org/pandas-docs/version/0.20.3/generated/pandas.DataFrame.unstack.html)其他索引列会有所帮助。确实如此，但之后我无法再次堆叠它。

```
print df.unstack('ID').resample('W-THU')

Params      VAR1      
ID               1     2
DATE                    
2013-01-03      69  69.0
2013-01-10      76  73.5 
```

但随后再次[堆叠](https://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.stack.html)“ID”会导致索引错误：

```
print df.unstack('ID').resample('W-THU').stack('ID')

IndexError: index 0 is out of bounds for axis 0 with size 0 
```

奇怪的是，我可以同时堆叠另一列级别：

```
print df.unstack('ID').resample('W-THU').stack(0) 
```

和

```
print df.unstack('ID').resample('W-THU').stack('Params') 
```

如果我重新排序（交换）两个列级别，也会发生索引错误。有谁知道如何克服这个问题？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-03-25T17:34:55.583

该示例取消堆叠一个非数字列“NAME”，该列被静默删除，但在重新堆叠期间会导致问题。下面的代码对我有用

```
print df[['VAR1']].unstack('ID').resample('W-THU').stack('ID')
Params         VAR1
DATE       ID
2013-01-03 A   69.0
           B   69.0
2013-01-10 A   76.0
           B   73.5 
```

# c++ - cin 到布尔向量

> ID：15617501
> 
> 赞同：3
> 
> 时间：2013-03-25T14:31:32.800
> 
> 标签：c++, vector, stl, boolean

我有这个代码：

```
#include <iostream>
#include <vector>

using namespace std;

int main(){
    vector <bool> v;
    cin >> v[0];
return 0;   
} 
```

为什么我不能这样做？编译器不会编译它，但我在向量中有其他变量类型，它会工作得很好。这有什么问题？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-03-25T14:32:55.333

这是因为它`std::vector<bool>`是一种专业化，根本不像一个向量。这被广泛认为是标准中的一个主要缺陷。

为了节省内存，`vector<bool>`将每个元素存储为单个位。但是位不能单独寻址，因此`operator[]`不能返回`bool&`连接到位的引用。相反，它返回`vector<bool>::reference`... 并且`cin`不提供函数重载来处理这个问题。

（juanchopanza 正确地指出你的向量没有元素零。但即使它通过或其他机制做到了，不返回引用`resize`的事实仍然会妨碍。）`operator[]`

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-25T14:34:09.367

在您调用`v[0]`时，向量的大小为零，因此您正在访问越界。这是*未定义的行为*。

此外，由于它不包含单个元素`std::vector<bool>`，因此它具有奇怪的行为。`bool`它`operator[]`返回一种代理对象，对该运算符的调用可能不会达到您的预期。它应该小心使用，或者根本不使用。

您可以通过将值读入局部变量然后将其推入向量的后面来解决该问题，如本工作示例中所示（[此处类似现场演示](http://ideone.com/WkKPNd)）：

```
#include <vector>
#include <iostream>

int main()
{
  std::vector<bool> v;
  std::cout << std::boolalpha;
  v.push_back(true);
  std::cout << v[0] << std::endl;
  bool b;
  cin >> b;
  v[0] = b;
  std::cout << v[0] << std::endl;
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-25T14:34:01.423

这应该有效：

```
#include <iomanip>

...

bool a;
cin >> boolalpha >> a;
v.push_back(a); 
```

（除了 Ben Voigt 提到的问题之外，您当前的代码对于类型不安全，除了`bool`因为您的向量在您访问时为空`v[0]`。）

# ember.js - 控制器属性未更新

> ID：15617504
> 
> 赞同：0
> 
> 时间：2013-03-25T14:31:37.297
> 
> 标签：ember.js

我正在尝试在 a 中执行一个简单的登录操作`LoginController`，并尝试将结果存储在`loggedIn`控制器的属性中。在`tryLogin()`控制器中，当我进行 ajax 调用并设置控制器的属性时`App.LoginController.loggedIn=true`，它不会反映在控制器中。

请检查这个[JSBin](http://jsbin.com/ixupad/264/)

我怀疑我对范围界定的理解有问题，但无法解决这个问题

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-25T16:24:50.793

您需要`loggedIn`在控制器实例上设置属性，而不是控制器类定义。这意味着您需要使用`self.set('loggedIn', true)`而不是`App.LoginController.loggedIn = true`.

另一件事要记住，总是使用`object.set('prop', 'val')`而不是`object.prop = 'val'`

这是[更新的 JSBin](http://jsbin.com/ixupad/267)

# java - 页面刷新上的“地址已在使用中”

> ID：15617509
> 
> 赞同：0
> 
> 时间：2013-03-25T14:31:48.990
> 
> 标签：java, jsp, sockets, web-applications, servlets

我有一个 Web 应用程序，除其他外，它在套接字上侦听来自远程客户端的消息的连接。当用户刷新页面时，我的问题就出现了。页面刷新后，应用程序正在重新加载，并再次尝试侦听存在异常的同一端口 - “地址已在使用中”。

有没有办法解决这个问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-25T14:39:16.010

您正在同一页面上创建 Socket。并且当刷新该页面时，将再次为同一地址发送创建套接字的请求，并且该地址已被绑定。

有几种方法可以解决它。最简单的方法是将 Socket 创建与您的页面分开，并相应地处理连接和刷新。

# windows - 将 QString 转换为 BSTR，反之亦然

> ID：15617510
> 
> 赞同：3
> 
> 时间：2013-03-25T14:31:49.673
> 
> 标签：windows, qt, wchar-t, wstring, bstr

我想转换`QString`为`BSTR`，反之亦然。

这是我尝试转换`QString`为`BSTR`：

```
std::wstring str_ = QString("some texts").toStdWString();
BSTR bstr_ = str_.c_str(); 
```

并转换`BSTR`为`QString`：

```
BSTR bstr_;
wchar_t *str_ = bstr_;
QString qstring_ = QString::fromWCharArray(str_); 
```

这个对吗？换句话说，是否有任何数据丢失？如果是，正确的解决方案是什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-26T04:12:10.430

您可能应该使用它`SysAllocString`来执行此操作 - BSTR 还包含长度前缀，它不包含在您的代码中。

```
std::wstring str_ = QString("some texts").toStdWString();
BSTR bstr_ = SysAllocString(str_.c_str()); 
```

除此之外，这里没有什么可丢失的——BSTR 和 QString 都使用 16 位 Unicode 编码，因此彼此之间的转换根本不应该修改内部数据缓冲区。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-10-31T17:12:59.007

To convert a BSTR to a QString you can simply use the `QString::fromUtf16` function:

```
BSTR bstrTest = SysAllocString(L"ConvertMe");
QString qstringTest = QString::fromUtf16(bstrTest); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2018-09-28T23:13:53.337

BSTR 字符串由两部分组成：四个字节表示字符串长度；以及它本身可以包含空字符的内容。

这样做的简短方法是：

1.  使用 QString::utf16 将 QString 转换为两字节空终止字符串。不要使用 toWCharArray，宽字符在 windows（两个字节）和 linux（四个字节）上是不同的（我知道 COM 是 microsoft tech，但最好确定）

2.  使用 SysAllocString 创建一个已经包含字符串长度的 BSTR 字符串。

3.  使用完毕后，可选择使用 SysFreeString 释放 BSTR 字符串。请阅读以下文章以了解何时需要发布。

[https://docs.microsoft.com/en-us/cpp/atl-mfc-shared/allocating-and-releasing-memory-for-a-bstr?view=vs-2017](https://docs.microsoft.com/en-us/cpp/atl-mfc-shared/allocating-and-releasing-memory-for-a-bstr?view=vs-2017)

```
BSTR bstr = ::SysAllocString(QString("stuff").utf16())
// use it
::SysFreeString(bstr) 
```

要从 BSTR 转换为 QString，您可以将 BSTR 重新解释为 ushort 指针，然后使用 QString::fromUtf16。完成后请记住释放 BSTR。

```
QString qstr = QString::fromUtf16(reinterpret_cast<ushort*>(bstr)); 
```

下一篇有用的文章很好地解释了 BSTR 字符串。

[https://www.codeproject.com/Articles/13862/COM-in-plain-C-Part](https://www.codeproject.com/Articles/13862/COM-in-plain-C-Part)

# mysql - 计算游戏被玩的次数

> ID：15617511
> 
> 赞同：-1
> 
> 时间：2013-03-25T14:31:54.287
> 
> 标签：mysql, sql

```
我想知道每场比赛的次数。

我需要这样的结果：

-------------------------------------------------- ----

    游戏计数
    --------- ---------
    横跨美国的银 5
    第 2 组 7
    游戏 3 10   

背景资料：

    如果不存在“maf_game”，则创建表（
      `id` int(11) NOT NULL AUTO_INCREMENT,
      `name` varchar(250) NOT NULL,
      主键（`id`）
    ) 引擎=InnoDB 默认字符集=latin1 AUTO_INCREMENT=2 ;

    插入“maf_game”（“id”、“name”）值
    （1，“美国农业”）；

    如果不存在“maf_game_attempts”，则创建表（
      `id` int(11) NOT NULL AUTO_INCREMENT,
      `userid` varchar(100) NOT NULL,
      `sessionid` varchar(100) NOT NULL,
      `gid` int(11) 非空，
      `status` varchar(50) NOT NULL,
      `attempttime` 日期时间不为空，
      主键（`id`）
    ) 引擎=InnoDB 默认字符集=latin1 AUTO_INCREMENT=23 ；

    插入`maf_game_attempts`（`id`、`userid`、`sessionid`、`gid`、`status`、`attempttime`）值
    (1, 'JOQHOIGNUFEC945', 'hcn27d3i1kemmgubvti8ic3p87', 1, '开始', '2013-03-25 18:58:14'),
    （2，'JOQHOIGNUFEC945'，'hcn27d3i1kemmgubvti8ic3p87'，1，'开始'，'2013-03-25 18:59:02'），
    （3，'JOQHOIGNUFEC945'，'hcn27d3i1kemmgubvti8ic3p87'，1，'开始'，'2013-03-25 18:59:33'），
    (4, 'JOQHOIGNUFEC945', 'hcn27d3i1kemmgubvti8ic3p87', 1, '结束', '2013-03-25 19:00:41'),
    (5, 'PEHICJWEBEGA391', 'tpv2ebuhtnv5a8thfmltarsl65', 1, '开始', '2013-03-25 19:01:38'),
    (6, 'PEHICJWEBEGA391', 'tpv2ebuhtnv5a8thfmltarsl65', 1, '开始', '2013-03-25 19:01:44'),
    (7, 'PEHICJWEBEGA391', 'tpv2ebuhtnv5a8thfmltarsl65', 1, '开始', '2013-03-25 19:01:48'),
    (8, 'AXDUYNBAUIGC268', 'o9u8tno9qvrj8cfja2g1c516f5', 1, '开始', '2013-03-25 19:01:49'),
    (9, 'ZKHBILGVNJBB040', '8h8r13pnad0ftitsdjt9co49p0', 1, '开始', '2013-03-25 19:01:54'),
    (10, 'PEHICJWEBEGA391', 'tpv2ebuhtnv5a8thfmltarsl65', 1, '开始', '2013-03-25 19:02:08'),
    (11, 'AXDUYNBAUIGC268', 'o9u8tno9qvrj8cfja2g1c516f5', 1, '开始', '2013-03-25 19:02:09'),
    (12, 'ZKHBILGVNJBB040', '8h8r13pnad0ftitsdjt9co49p0', 1, '开始', '2013-03-25 19:02:10'),
    (13, 'PEHICJWEBEGA391', 'tpv2ebuhtnv5a8thfmltarsl65', 1, '结束', '2013-03-25 19:02:15'),
    (14, 'AXDUYNBAUIGC268', 'o9u8tno9qvrj8cfja2g1c516f5', 1, '结束', '2013-03-25 19:02:18'),
    （15，'ZKHBILGVNJBB040'，'8h8r13pnad0ftitsdjt9co49p0'，1，'完成'，'2013-03-25 19:02:20'），
    （16，'JOQHOIGNUFEC945'，'hcn27d3i1kemmgubvti8ic3p87'，1，'开始'，'2013-03-25 19:50:30'），
    (17, 'JOQHOIGNUFEC945', 'hcn27d3i1kemmgubvti8ic3p87', 1, '开始', '2013-03-25 19:50:37'),
    (18, 'JOQHOIGNUFEC945', 'hcn27d3i1kemmgubvti8ic3p87', 1, '开始', '2013-03-25 19:50:45'),
    (19, 'JOQHOIGNUFEC945', 'hcn27d3i1kemmgubvti8ic3p87', 1, '结束', '2013-03-25 19:50:51'),
    (20, 'JOQHOIGNUFEC945', 'bb57a1nfodomuf0i01pcojs0f2', 1, '开始', '2013-03-25 19:52:58'),
    （21，'JOQHOIGNUFEC945'，'bb57a1nfodomuf0i01pcojs0f2'，1，'开始'，'2013-03-25 19:53:01'），
    （22，'JOQHOIGNUFEC945'，'bb57a1nfodomuf0i01pcojs0f2'，1，'结束'，'2013-03-25 19:53:08'）；

    如果不存在“maf_game_stats”，则创建表（
      `id` int(11) NOT NULL AUTO_INCREMENT,
      `userid` varchar(100) NOT NULL,
      `sessionid` varchar(100) NOT NULL,
      `gid` int(11) 非空，
      `qid` int(11) 非空，
      `result` varchar(50) NOT NULL,
      `accesstime` 日期时间不为空，
      主键（`id`）
    ) 引擎=InnoDB 默认字符集=latin1 AUTO_INCREMENT=23 ；

    插入`maf_game_stats`（`id`、`userid`、`sessionid`、`gid`、`qid`、`result`、`accesstime`）值
    (1, 'JOQHOIGNUFEC945', 'hcn27d3i1kemmgubvti8ic3p87', 1, 16, '0', '2013-03-25 18:58:14'),
    (2, 'JOQHOIGNUFEC945', 'hcn27d3i1kemmgubvti8ic3p87', 1, 14, '0', '2013-03-25 18:59:02'),
    (3, 'JOQHOIGNUFEC945', 'hcn27d3i1kemmgubvti8ic3p87', 1, 12, '1', '2013-03-25 18:59:33'),
    (4, 'JOQHOIGNUFEC945', 'hcn27d3i1kemmgubvti8ic3p87', 1, 9, '0', '2013-03-25 19:00:41'),
    (5, 'PEHICJWEBEGA391', 'tpv2ebuhtnv5a8thfmltarsl65', 1, 5, '0', '2013-03-25 19:01:37'),
    (6, 'PEHICJWEBEGA391', 'tpv2ebuhtnv5a8thfmltarsl65', 1, 6, '0', '2013-03-25 19:01:43'),
    (7, 'PEHICJWEBEGA391', 'tpv2ebuhtnv5a8thfmltarsl65', 1, 1, '1', '2013-03-25 19:01:48'),
    (8, 'AXDUYNBAUIGC268', 'o9u8tno9qvrj8cfja2g1c516f5', 1, 9, '0', '2013-03-25 19:01:49'),
    (9, 'ZKHBILGVNJBB040', '8h8r13pnad0ftitsdjt9co49p0', 1, 14, '1', '2013-03-25 19:01:54'),
    (10, 'PEHICJWEBEGA391', 'tpv2ebuhtnv5a8thfmltarsl65', 1, 15, '1', '2013-03-25 19:02:08'),
    (11, 'AXDUYNBAUIGC268', 'o9u8tno9qvrj8cfja2g1c516f5', 1, 7, '0', '2013-03-25 19:02:09'),
    (12, 'ZKHBILGVNJBB040', '8h8r13pnad0ftitsdjt9co49p0', 1, 6, '1', '2013-03-25 19:02:10'),
    (13, 'PEHICJWEBEGA391', 'tpv2ebuhtnv5a8thfmltarsl65', 1, 14, '0', '2013-03-25 19:02:15'),
    (14, 'AXDUYNBAUIGC268', 'o9u8tno9qvrj8cfja2g1c516f5', 1, 6, '0', '2013-03-25 19:02:18'),
    (15, 'ZKHBILGVNJBB040', '8h8r13pnad0ftitsdjt9co49p0', 1, 13, '1', '2013-03-25 19:02:20'),
    (16, 'JOQHOIGNUFEC945', 'hcn27d3i1kemmgubvti8ic3p87', 1, 6, '0', '2013-03-25 19:50:30'),
    (17, 'JOQHOIGNUFEC945', 'hcn27d3i1kemmgubvti8ic3p87', 1, 9, '0', '2013-03-25 19:50:37'),
    (18, 'JOQHOIGNUFEC945', 'hcn27d3i1kemmgubvti8ic3p87', 1, 1, '1', '2013-03-25 19:50:45'),
    (19, 'JOQHOIGNUFEC945', 'hcn27d3i1kemmgubvti8ic3p87', 1, 4, '0', '2013-03-25 19:50:51'),
    (20, 'JOQHOIGNUFEC945', 'bb57a1nfodomuf0i01pcojs0f2', 1, 16, '0', '2013-03-25 19:52:58'),
    (21, 'JOQHOIGNUFEC945', 'bb57a1nfodomuf0i01pcojs0f2', 1, 13, '0', '2013-03-25 19:53:01'),
    (22, 'JOQHOIGNUFEC945', 'bb57a1nfodomuf0i01pcojs0f2', 1, 1, '0', '2013-03-25 19:53:08');

-------------------------------------------
问：昨天查询好，但我需要不结束“结束”，“完成”匿名用户喜欢
“sessionid” uj24ookkdcr3ris0cpbf82dd14 他的用户有 1 次尝试，而 eqs39lv506p150esr274e9a810 用户有 1 次尝试，请帮助...？

如果不存在“maf_game”，则创建表（
  `id` int(11) NOT NULL AUTO_INCREMENT,
  `name` varchar(250) NOT NULL,
  主键（`id`）
) 引擎=InnoDB 默认字符集=latin1 AUTO_INCREMENT=2 ;

插入“maf_game”（“id”、“name”）值
（1，“美国农业”）；

如果不存在“maf_game_attempts”，则创建表（
  `id` int(11) NOT NULL AUTO_INCREMENT,
  `userid` varchar(100) NOT NULL,
  `sessionid` varchar(100) NOT NULL,
  `gid` int(11) 非空，
  `status` varchar(50) NOT NULL,
  `attempttime` 日期时间不为空，
  主键（`id`）
) 引擎=InnoDB 默认字符集=latin1 AUTO_INCREMENT=31 ;

插入`maf_game_attempts`（`id`、`userid`、`sessionid`、`gid`、`status`、`attempttime`）值
(1, 'JOQHOIGNUFEC945', 'hcn27d3i1kemmgubvti8ic3p87', 1, '开始', '2013-03-25 18:58:14'),
（2，'JOQHOIGNUFEC945'，'hcn27d3i1kemmgubvti8ic3p87'，1，'开始'，'2013-03-25 18:59:02'），
（3，'JOQHOIGNUFEC945'，'hcn27d3i1kemmgubvti8ic3p87'，1，'开始'，'2013-03-25 18:59:33'），
(4, 'JOQHOIGNUFEC945', 'hcn27d3i1kemmgubvti8ic3p87', 1, '结束', '2013-03-25 19:00:41'),
(5, 'PEHICJWEBEGA391', 'tpv2ebuhtnv5a8thfmltarsl65', 1, '开始', '2013-03-25 19:01:38'),
(6, 'PEHICJWEBEGA391', 'tpv2ebuhtnv5a8thfmltarsl65', 1, '开始', '2013-03-25 19:01:44'),
(7, 'PEHICJWEBEGA391', 'tpv2ebuhtnv5a8thfmltarsl65', 1, '开始', '2013-03-25 19:01:48'),
(8, 'AXDUYNBAUIGC268', 'o9u8tno9qvrj8cfja2g1c516f5', 1, '开始', '2013-03-25 19:01:49'),
(9, 'ZKHBILGVNJBB040', '8h8r13pnad0ftitsdjt9co49p0', 1, '开始', '2013-03-25 19:01:54'),
(10, 'PEHICJWEBEGA391', 'tpv2ebuhtnv5a8thfmltarsl65', 1, '开始', '2013-03-25 19:02:08'),
(11, 'AXDUYNBAUIGC268', 'o9u8tno9qvrj8cfja2g1c516f5', 1, '开始', '2013-03-25 19:02:09'),
(12, 'ZKHBILGVNJBB040', '8h8r13pnad0ftitsdjt9co49p0', 1, '开始', '2013-03-25 19:02:10'),
(13, 'PEHICJWEBEGA391', 'tpv2ebuhtnv5a8thfmltarsl65', 1, '结束', '2013-03-25 19:02:15'),
(14, 'AXDUYNBAUIGC268', 'o9u8tno9qvrj8cfja2g1c516f5', 1, '结束', '2013-03-25 19:02:18'),
（15，'ZKHBILGVNJBB040'，'8h8r13pnad0ftitsdjt9co49p0'，1，'完成'，'2013-03-25 19:02:20'），
（16，'JOQHOIGNUFEC945'，'hcn27d3i1kemmgubvti8ic3p87'，1，'开始'，'2013-03-25 19:50:30'），
(17, 'JOQHOIGNUFEC945', 'hcn27d3i1kemmgubvti8ic3p87', 1, '开始', '2013-03-25 19:50:37'),
(18, 'JOQHOIGNUFEC945', 'hcn27d3i1kemmgubvti8ic3p87', 1, '开始', '2013-03-25 19:50:45'),
(19, 'JOQHOIGNUFEC945', 'hcn27d3i1kemmgubvti8ic3p87', 1, '结束', '2013-03-25 19:50:51'),
(20, 'JOQHOIGNUFEC945', 'bb57a1nfodomuf0i01pcojs0f2', 1, '开始', '2013-03-25 19:52:58'),
（21，'JOQHOIGNUFEC945'，'bb57a1nfodomuf0i01pcojs0f2'，1，'开始'，'2013-03-25 19:53:01'），
（22，'JOQHOIGNUFEC945'，'bb57a1nfodomuf0i01pcojs0f2'，1，'结束'，'2013-03-25 19:53:08'），
(23, 'GXJVKQTQIJMU436', 'uj24ookkdcr3ris0cpbf82dd14', 1, '开始', '2013-03-26 10:02:02'),
(24, 'PEHICJWEBEGA391', 'eqs39lv506p150esr274e9a810', 1, '开始', '2013-03-26 10:05:06'),
(25, 'PEHICJWEBEGA391', 'eqs39lv506p150esr274e9a810', 1, '开始', '2013-03-26 10:05:12'),
(26, 'EHHYWVGQZKLA633', 'cptl7mvvb88r764n0654avc1l5', 1, '开始', '2013-03-26 10:17:40'),
(27, 'EHHYWVGQZKLA633', 'cptl7mvvb88r764n0654avc1l5', 1, '开始', '2013-03-26 10:17:47'),
(28, 'EHHYWVGQZKLA633', 'cptl7mvvb88r764n0654avc1l5', 1, '开始', '2013-03-26 10:17:56'),
（29，'EHHYWVGQZKLA633'，'cptl7mvvb88r764n0654avc1l5'，1，'结束'，'2013-03-26 10:18:05'），
(30, 'EHHYWVGQZKLA633', 'cptl7mvvb88r764n0654avc1l5', 1, '开始', '2013-03-26 10:18:17');

```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-25T14:39:38.433

简而言之，这是如何做到的：

```
Select maf_game.name as daname , count(maf_game_attempts.id) as danum from maf_game,maf_game_attempts where maf_game_attempts.gid=maf_game.id and maf_game_attempts.status='over'; 
```

您可以丢弃状态或将其更改为您需要的状态，我认为 over 意味着播放。

# php - 从 URL 获取 JSON 对象

> ID：15617512
> 
> 赞同：166
> 
> 时间：2013-03-25T14:31:58.020
> 
> 标签：php, json

我有一个返回 JSON 对象的 URL，如下所示：

```
{
    "expires_in":5180976,
    "access_token":"AQXzQgKTpTSjs-qiBh30aMgm3_Kb53oIf-VA733BpAogVE5jpz3jujU65WJ1XXSvVm1xr2LslGLLCWTNV5Kd_8J1YUx26axkt1E-vsOdvUAgMFH1VJwtclAXdaxRxk5UtmCWeISB6rx6NtvDt7yohnaarpBJjHWMsWYtpNn6nD87n0syud0"
} 
```

我想从 URL 中获取 JSON 对象，然后是`access_token`值。

那么如何通过 PHP 检索它呢？

* * *

## 回答 #1

> 赞同：395
> 
> 时间：2013-03-25T14:33:30.103

```
$json = file_get_contents('url_here');
$obj = json_decode($json);
echo $obj->access_token; 
```

为此，`file_get_contents`需要`allow_url_fopen`启用它。这可以在运行时通过包括：

```
ini_set("allow_url_fopen", 1); 
```

您也可以使用[`curl`](http://www.php.net/manual/en/function.curl-init.php)获取网址。要使用 curl，您可以使用[此处](https://stackoverflow.com/a/16701318/475125)找到的示例：

```
$ch = curl_init();
// IMPORTANT: the below line is a security risk, read https://paragonie.com/blog/2017/10/certainty-automated-cacert-pem-management-for-php-software
// in most cases, you should set it to true
curl_setopt($ch, CURLOPT_SSL_VERIFYPEER, false);
curl_setopt($ch, CURLOPT_RETURNTRANSFER, true);
curl_setopt($ch, CURLOPT_URL, 'url_here');
$result = curl_exec($ch);
curl_close($ch);

$obj = json_decode($result);
echo $obj->access_token; 
```

* * *

## 回答 #2

> 赞同：28
> 
> 时间：2013-03-25T14:35:27.997

```
$url = 'http://.../.../yoururl/...';
$obj = json_decode(file_get_contents($url), true);
echo $obj['access_token']; 
```

PHP 也可以使用带有破折号的属性：

```
garex@ustimenko ~/src/ekapusta/deploy $ psysh
Psy Shell v0.4.4 (PHP 5.5.3-1ubuntu2.6 — cli) by Justin Hileman
>>> $q = new stdClass;
=> <stdClass #000000005f2b81c80000000076756fef> {}
>>> $q->{'qwert-y'} = 123
=> 123
>>> var_dump($q);
class stdClass#174 (1) {
  public $qwert-y =>
  int(123)
}
=> null 
```

* * *

## 回答 #3

> 赞同：18
> 
> 时间：2013-03-25T14:36:32.713

你可以使用 PHP 的[json_decode](http://www.php.net/manual/de/function.json-decode.php)函数：

```
$url = "http://urlToYourJsonFile.com";
$json = file_get_contents($url);
$json_data = json_decode($json, true);
echo "My token: ". $json_data["access_token"]; 
```

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2013-03-25T14:37:31.813

你需要阅读关于 json_decode 函数[http://php.net/manual/en/function.json-decode.php](http://php.net/manual/en/function.json-decode.php)

干得好

```
$json = '{"expires_in":5180976,"access_token":"AQXzQgKTpTSjs-qiBh30aMgm3_Kb53oIf-VA733BpAogVE5jpz3jujU65WJ1XXSvVm1xr2LslGLLCWTNV5Kd_8J1YUx26axkt1E-vsOdvUAgMFH1VJwtclAXdaxRxk5UtmCWeISB6rx6NtvDt7yohnaarpBJjHWMsWYtpNn6nD87n0syud0"}';
//OR $json = file_get_contents('http://someurl.dev/...');

$obj = json_decode($json);
var_dump($obj-> access_token);

//OR 

$arr = json_decode($json, true);
var_dump($arr['access_token']); 
```

* * *

## 回答 #5

> 赞同：8
> 
> 时间：2015-11-19T23:06:31.650

```
// Get the string from the URL
$json = file_get_contents('https://maps.googleapis.com/maps/api/geocode/json?latlng=40.714224,-73.961452');

// Decode the JSON string into an object
$obj = json_decode($json);

// In the case of this input, do key and array lookups to get the values
var_dump($obj->results[0]->formatted_address); 
```

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2016-01-11T07:31:04.673

```
$ch = curl_init();
curl_setopt($ch, CURLOPT_SSL_VERIFYPEER, false);
curl_setopt($ch, CURLOPT_RETURNTRANSFER, true);
curl_setopt($ch, CURLOPT_URL, 'url_here');
$result = curl_exec($ch);
curl_close($ch);

$obj = json_decode($result);
echo $obj->access_token; 
```

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2017-04-28T05:27:14.093

`file_get_contents()`没有从 url 获取数据，然后我尝试`curl`了它，它工作正常。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2018-12-18T17:28:47.330

我们的解决方案，为响应添加了一些验证，因此我们确定我们在**$json**变量中有一个格式良好的 json 对象

```
$ch = curl_init();
curl_setopt($ch, CURLOPT_SSL_VERIFYPEER, false);
curl_setopt($ch, CURLOPT_RETURNTRANSFER, true);
curl_setopt($ch, CURLOPT_URL, $url);
$result = curl_exec($ch);
curl_close($ch);
if (! $result) {
    return false;
}

$json = json_decode(utf8_encode($result));
if (empty($json) || json_last_error() !== JSON_ERROR_NONE) {
    return false;
} 
```

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2019-04-01T20:02:39.190

我的解决方案仅适用于以下情况：如果您将多维数组误认为是一个数组

```
$json = file_get_contents('url_json'); //get the json
$objhigher=json_decode($json); //converts to an object
$objlower = $objhigher[0]; // if the json response its multidimensional this lowers it
echo "<pre>"; //box for code
print_r($objlower); //prints the object with all key and values
echo $objlower->access_token; //prints the variable 
```

我知道答案已经得到了回答，但是对于那些来这里寻找东西的人，我希望这可以帮助你

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2019-11-01T11:47:39.047

```
$curl_handle=curl_init();
curl_setopt($curl_handle, CURLOPT_URL,'https://www.xxxSite/get_quote/ajaxGetQuoteJSON.jsp?symbol=IRCTC&series=EQ');
//Set the GET method by giving 0 value and for POST set as 1
//curl_setopt($curl_handle, CURLOPT_POST, 0);
curl_setopt($curl_handle, CURLOPT_CUSTOMREQUEST, "GET");
curl_setopt($curl_handle, CURLOPT_CONNECTTIMEOUT, 2);
curl_setopt($curl_handle, CURLOPT_RETURNTRANSFER, 1);
$query = curl_exec($curl_handle);
$data = json_decode($query, true);
curl_close($curl_handle);

//print complete object, just echo the variable not work so you need to use print_r to show the result
echo print_r( $data);
//at first layer
echo $data["tradedDate"];
//Inside the second layer
echo $data["data"][0]["companyName"]; 
```

有时您可能会得到 405，请正确设置方法类型。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2018-07-06T09:46:08.413

当您使用`curl`时有时会给您 403（禁止访问）通过添加此行来模拟浏览器来解决。

```
curl_setopt($ch, CURLOPT_USERAGENT, 'Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1; SV1; .NET CLR 1.0.3705; .NET CLR 1.1.4322)'); 
```

希望这对某人有所帮助。

# java-me - 如何使用诺基亚 Java SDK 2.0 在诺基亚 Series 40 中实现推送通知？

> ID：15617514
> 
> 赞同：0
> 
> 时间：2013-03-25T14:31:59.113
> 
> 标签：java-me, push-notification, nokia-s40

我希望我的应用程序在后台运行时能够从服务器接收通知。我不喜欢池，因为我需要几乎实时响应，这会耗尽用户的电池，40 系列是否支持？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-26T09:26:58.517

要回答这个问题，如果您可以在 S40 手机上拦截 SMS，那么我会说是的。您可以使用推送注册表。有关 j2me 示例，请参阅此[链接](http://www.developer.nokia.com/Community/Wiki/How_to_launch_a_MIDlet_remotely_via_SMS_or_locally_via_an_Alarm_with_PushRegistry_in_Java_ME)。这只是问题的一半，因为这是接收端。您需要创建一个服务器，将消息“推送”到其推送注册表端口上的某个手机号码。您可以使用 SMS 网关来推送消息吗？

# php - Windows 命令行 - 多个 PHP 版本

> ID：15617515
> 
> 赞同：6
> 
> 时间：2013-03-25T14:32:00.267
> 
> 标签：php, windows, command-line, wamp

我目前正在运行具有多个 PHP 版本（5.3.8、5.4.3）的 Wampserver。Wampserver 允许您轻松地在您希望 apache 使用的 php 版本之间来回切换。但是，我在处理来自 CLI 的多个版本时遇到了麻烦。我有需要命令行的项目，但有些与 php5.4 兼容，有些则不兼容。

有没有办法在 Windows 中创建某种类型的“别名”，允许我在命令行上指定要使用的 PHP 版本.. IE：“php54 cache:clear”、“php53 cache:clear”？

谢谢！

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2019-10-09T13:27:28.103

我正在做类似下面的事情。

前任。我有两个 php 版本，PHP 5.6 和 PHP 7.3

我有 wamp 环境所以我做了如下

所以我已将 D:\wamp\bin\php\php7.3.6\php.exe 复制到 D:\wamp\bin\php\php7.3.6\php7.exe

我已将 D:\wamp\bin\php\php5.6\php.exe 复制到 D:\wamp\bin\php\php5.6\php56.exe

然后我将两者都添加到环境变量路径中，如下所示。

[![在此处输入图像描述](../Images/afeafe0cf094173606245a3e4188fc3a.png)](https://i.stack.imgur.com/oYO82.png)

现在你需要重新打开 cmd，你可以使用类似下面的命令

```
php56 -v
php7 -v 
```

您还可以运行命令**refreshenv**在打开的 cmd 中重新加载环境变量。

如果要更改默认 php 版本，可以如下移动路径。

例如，如果您希望 php 7.0.23 作为默认值而不是 php 7.3.6

例如看截图[![在此处输入图像描述](../Images/a812ed38107c33f7730bfc6a5860d341.png)](https://i.stack.imgur.com/pDY3V.png)

在上面的屏幕截图中，我将 php 7.0.23 移到了所有其他 php 版本（php 7.3.6 和 php 5.6.31）之上。

我希望这将有所帮助。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-27T01:35:33.193

Its quite simple really.

Create yourself a batch file to add php to the path, place that file in one of the folders that is currently on your PATH so you can run it from anywhere. Then whenever you are in any folder that has CLI scripts in it run the batch file

Example batch file:

Lets call it PHPPATH.CMD

```
path=%path%;c:\wamp\bin\php\php5.4.11
php -v 
```

Now if you want to use another version of the PHP CLI just change the batch file or if you are feeling clever make the batch file accept a paramter so you can specify the version of php you want on the path.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2018-11-27T14:48:15.070

如果您能够这样做，只需创建**别名**：

别名'php56'='/Path/To/php5.6/bin/php'; 别名'php55'='/Path/To/php5.5/bin/php';

如果没有，请在指向二进制文件**的单独目录中创建链接。**

php56 是指向*/Path/To/php5.6/bin/php的链接*

php55 是指向*/Path/To/php5.5/bin/php的链接*

将它们放入 /Seperate/Path/ 并将 '/Seperate/Path/' 添加到 %PATH%

希望这可以帮助

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2020-08-24T17:31:20.960

我已经搜索了如何在不使用命令行更改环境变量路径的情况下真正轻松地做到这一点（因为它的字符有限）并找到了这个解决方案（仅在 Windows 10 上）：在你的环境变量路径中，`[D:\wamp64\bin\php\"your php version"]`更改`[D:\wamp64\bin\php\php]`

然后在您的 php 版本目录之间创建一个联结，并`D:\wamp64\bin\php\php`以管理员身份在 cmd 中运行此命令： `mklink /J D:\wamp64\bin\php\php D:\wamp64\bin\php\php"your php version"`

那么你可以使用这个批处理文件

```
echo off
::read the actual php version
::(read the second word of php -v output )
for /f "tokens=2" %%i in ('php -v') do (

    ::if actual version is 7.4.0 I want 7.4.1
    if "%%i"=="7.4.0" set phpV="7.4.1"
    ::if actual version is 7.4.1 I want 7.4.0
    if "%%i"=="7.4.1" set phpV="7.4.0"
)

::delete the old junction
rmdir "D:\wamp64\bin\php\php"

::create a new one to the version I want
::!!!!!!!!!!!!!!!!!!! paths must not contains spaces
mklink /J D:\wamp64\bin\php\php D:\wamp64\bin\php\php%phpV% 
```

现在您可以在您的 cmd 中运行您的批处理文件，之后甚至不必重新启动它。

# php - PHP 需要 realpath - 需要打开失败

> ID：15617524
> 
> 赞同：2
> 
> 时间：2013-03-25T14:32:31.630
> 
> 标签：php, path, include, require

我正在尝试通过相对路径`require`/`include`文件。路径存在并检查所有权限。要包含的脚本是可读的，可以通过浏览器中的 URL 访问...

但是，我收到了无法打开的错误/警告。调用脚本和要包含的文件都在同一台服务器上。

来电者亲属：

`/devel/phi/dev/appcenter-head/appcenter/application/nm/index.php`

来电者位置：

`/home/devel/wwwroot/phi/dev/appcenter-head/appcenter/application/nm`

要求亲属：

`/devel/nm/dev/http-api/http-api/src/httpapi.inc.php`

要求地点：

`/home/devel/wwwroot/nm/dev/http-api/http-api/src`

我尝试了什么：

```
$strHttpApiUrl = "/devel/nm/dev/http-api/http-api/index.php";
$strFile = "/src/httpapi.inc.php";
$strDirName = dirname( $strHttpApiUrl );
$strRealpath = realpath( $strDirName . $strFile );
require_once $strRealpath; 
```

失败：`PHP Warning: require_once(/home/devel/wwwroot/phi/dev/appcenter-head/appcenter/application/nm) [<a href='function.require-once'>functio n.require-once</a>]: failed to open stream: No such file or directory in /home/devel/wwwroot/phi/dev/appcenter-head/appcenter/application/nm/class/TWinLogin.php`

也失败了：`PHP Fatal error: require_once() [<a href='function.require'>function.require</a>]: Failed opening required '' (include_path='.:/opt/nm/appcenter40-server-php53/lib/php')`

还尝试了简单的包括字符串 URL 或使用绝对路径...

如何包含该文件？

* * *

**编辑**：

这成功地包含了文件：

`require_once '/home/devel/wwwroot/nm/dev/http-api/http-api/src/httpapi.inc.php';`

那么如何获得该工作路径，假设我获得以下相对路径：

`/devel/nm/dev/http-api/http-api/index.php`

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-25T14:55:05.363

realpath 试图获取文件系统中的真实路径——绝对路径。所以它很可能以斜线开头。

如果您生成的路径以斜杠开头并且 php 尝试要求/包含它，则很可能它会认为它是绝对的。如果它没有看到现有文件——它会给你那些错误。

如果要使用相对路径，请避免使用 realpath。

# mysql - 选择分组依据字段 MySQL 的最新记录

> ID：15617525
> 
> 赞同：1
> 
> 时间：2013-03-25T14:32:31.947
> 
> 标签：mysql, sql

```
SELECT AnotherID, TID, TDate, COUNT(*) AS Total
FROM MyTable
GROUP BY TID
HAVING Total > 1 
```

上述查询返回多条记录具有相同 TID 的记录。现在我需要选择最新的日期。

上面的查询返回**TDate**但它不是最新的，基本上我需要按 TID 分组并获取**TDate**最新的记录。我只需要获取多个记录具有相同**TID**的那些记录。

**注意：**不能使用 MAX(TDate)，因为它没有选择正确的**AnotherID**字段

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-25T14:33:49.423

假设`TDate`是数据类型`date`or `datetime`，那么`MAX(TDate)`将为您提供每个分组的最新日期`TID`：

```
SELECT t1.AnotherId, t1.TID, t2.MaxTDate, t2.Total
FROM MyTable AS t1
INNER JOIN
(
   SELECT TID, MAX(TDate) AS MaxTDate, COUNT(*) AS Total
   FROM MyTable 
   GROUP BY TID
   HAVING Total > 1
) AS t2  ON t1.TID   = t2.TID
        AND t1.TDate = t2.MaxTDate; 
```

# java - 忽略 vim java 警告

> ID：15617537
> 
> 赞同：0
> 
> 时间：2013-03-25T14:32:56.927
> 
> 标签：java, vim, macvim

我正在使用vim的janus发行版并开始编辑一些java文件..我在左边有一些错误，说它找不到我的包..

![在此处输入图像描述](../Images/3711e4cdeee8b4f50e129821dd8183be.png)

这些错误来自哪里？以及如何忽略这些错误？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-25T14:53:26.253

我看了一下（不是那么深入）Janus 项目，它使用 syntastic 作为语法检查器。

Syntastic 的 Java 检查器有一个命令`:SyntasticJavacEditClasspath`，允许您添加类路径。它还支持从 maven 存储库加载 cp。看看[https://github.com/scrooloose/syntastic/blob/master/syntax_checkers/java/javac.vim](https://github.com/scrooloose/syntastic/blob/master/syntax_checkers/java/javac.vim)

希望能帮助到你。

# php - 如果语言参数不在 URL 中，则 PHP 重定向

> ID：15617539
> 
> 赞同：2
> 
> 时间：2013-03-25T14:33:00.167
> 
> 标签：php, url, localization

我有一个 url，例如：`http://localhost/project`当用户去那里时，我想重定向到`http://localhost/project/en`. 我该如何做到这一点？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-25T14:38:13.643

您可以通过编程方式或在 Web 服务器级别使用某些东西（例如，使用 Apache 的 mod_rewrite）来执行此操作。由于您明确提到了 PHP，我将为您提供以下内容。

在文档根目录下名为“project”的文件夹中，使用以下内容创建 index.php：

```
<?php
Header( "HTTP/1.1 301 Moved Permanently" );
Header( "Location: http://localhost/project/en" );
exit(0);
?> 
```

这是一个链接，显示了这种风格和其他方法（包括 mod_rewrite）来处理这个：

[http://www.phatz.com/301redirect.php](http://www.phatz.com/301redirect.php)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-25T14:37:10.157

有很多方法。您应该使用虚拟主机并重写 uri 来正确准备您的 URL，但如果您不想打扰这些，并且想要一种“正好有效”的方法来解决您提出的问题，那么试试这个：

```
$explode = explode('/',$_SERVER['REQUEST_URI']);
if (count($explode) == 1)){
   header('Location: http://localhost/project/en');
} 
```

**评论后编辑**

试试这个，但要注意我没有测试它，因为我没有我的产品。这里的环境，但它应该工作。如果没有，请评论:)

```
$explode = explode('/',$_SERVER['REQUEST_URI']);
$endsWithSlash = FALSE;
end($explode);
if (empty($explode[key($explode)])){
   unset($explode[key($explode)]);
   $endsWithSlash = TRUE;
}
if (end($explode) != 'en'){
   $url = 'http://localhost';
   $url .= $_SERVER['REQUEST_URI'];
   if (!$endsWithSlash){ $url .= '/'; }
   $url .= 'en';
   header('Location: '.$url);
} 
```

# javascript - 在 Safari、Firefox 和 Chrome 中工作的代码，但在 IE 中不工作（对齐）

> ID：15617544
> 
> 赞同：0
> 
> 时间：2013-03-25T14:33:20.870
> 
> 标签：javascript, html, css

我有一个混合了 html、css 和 javascript 的代码。显然，这只是我构建的一个测试页面，用于测试将使用 php 内容的页面。问题是，代码在 IE 6 或 8 上似乎不能很好地工作......我可以理解，IE 6 可能不是它的旧浏览器，但为什么它可以在 7、9 和 10 上工作而似乎不行在 8 上工作。上次我检查过，它在 7、9、10 上工作，但现在可能不行。我不确定是 javascript 还是 css 将所有东西都扔掉了，这就是我寻求帮助并将其发布在多个类别中的原因。

现场直播：[http ://www.technicallyworship.com/styles/style3/test.php](http://www.technicallyworship.com/styles/style3/test.php)

JSFiddle：http: [//jsfiddle.net/qu5Vc/](http://jsfiddle.net/qu5Vc/)

提前感谢大家的帮助！我只是在这一点上难住了，无法弄清楚如何解决它。我知道它在 Safari 和 Chrome 上按我想要的方式工作（这样可以给你一个参考点）。我也包括所有这些下面的代码。

```
<style>
/* Syle 3 CSS Document */

.clear { clear: left; }

#style3 { width: 750px;}

#s3_left { 
width: 750px;
}

#s3_right { 
    float: right;
    padding: 10px;
}

    .meDiv
    {
        position:relative;
        border:1px solid black;
        max-width: 400px;
    }

    .meSmall
    {
        display:block;
        max-width: 400px; border: 2px solid #000;
    }

    .meBig
    {
        z-index:10;
        position:absolute;
        left:0px;
        top:0px;
        display:none;
        max-width: 700px;
        border: 2px solid #000;
    }
    #bigOne { max-width: 700px; max-height 800px;}
</style>

<script>
function Big() {
    document.getElementById('bigOne').style.display = "block";
}

function Small() {
    document.getElementById('bigOne').style.display = "none";
}
</script>

<h1>Testing this out</h1>

<div id="style3">

<div id="s3_left">
<div id="s3_right">
<div class="meDiv">
    <img class="meSmall" src="http://openwalls.com/image/399/explosion_of_colors_1920x1200.jpg" onmouseover="Big();" style="align: right;" />
    <img id="bigOne" class="meBig" src="http://openwalls.com/image/399/explosion_of_colors_1920x1200.jpg" onclick="Small();" onmouseout="Small();" />
</div>
</div>  <!-- s3_right -->
This is test content. This is test content. This is test content.This is test content. This is test content. This is test content. This is test content. This is test content. This is test content. This is test content. This is test content. This is test content. This is test content. This is test content. This is test content. This is test content. This is test content. This is test content. This is test content. This is test content. This is test content. This is test content. This is test content.This is test content. This is test content. This is test content. This is test content. This is test content. This is test content. This is test content. This is test content. This is test content. This is test content. This is test content. This is test content. This is test content. This is test content. This is test content. This is test content. This is test content. This is test content. This is test content. This is test content.This is test content. This is test content. This is test content. This is test content. This is test content. This is test content. This is test content. This is test content. This is test content. This is test content. This is test content. This is test content. This is test content. This is test content. This is test content. This is test content. This is test content. This is test content. This is test content. This is test content.This is test content. This is test content. This is test content. This is test content. This is test content. This is test content. This is test content. This is test content. This is test content. This is test content. This is test content. This is test content. This is test content. This is test content. This is test content. This is test content. This is test content. This is test content. This is test content. This is test content.This is test content. This is test content. This is test content. This is test content. This is test content. This is test content. This is test content. This is test content. This is test content. This is test content. This is test content. This is test content. This is test content. This is test content. This is test content. This is test content. This is test content. This is test content. This is test content. This is test content.This is test content. This is test content. This is test content. This is test content. This is test content. This is test content. This is test content. This is test content. This is test content. This is test content. This is test content. This is test content. This is test content. This is test content. This is test content. This is test content. This is test content. This is test content. This is test content. This is test content.This is test content. This is test content. This is test content. This is test content. This is test content. This is test content. This is test content. This is test content. This is test content. This is test content. This is test content. This is test content. This is test content. This is test content. This is test content. This is test content. This is test content. This is test content. This is test content. This is test content.This is test content. This is test content. This is test content. This is test content. This is test content. This is test content. This is test content. This is test content. This is test content. This is test content. This is test content. This is test content. This is test content. This is test content. This is test content. This is test content. This is test content. This is test content. This is test content. This is test content.This is test content. This is test content. This is test content. This is test content. This is test content. This is test content. This is test content. This is test content. This is test content. This is test content. This is test content. This is test content. This is test content. This is test content. This is test content. This is test content. This is test content. 
</div>  <!-- s3_left -->

</div>  <!-- style 3 -->
<div class="clear"></div> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-25T14:44:12.267

问题是您正在使用`min-width`小图片 ( `.meSmall`) 的属性。你也应该定义`width`价值。这就是为什么 IE 不显示小图像的原因。

# grails - 如何在 Grails 中获取请求的 Mime 类型？

> ID：15617545
> 
> 赞同：0
> 
> 时间：2013-03-25T14:33:24.510
> 
> 标签：grails, mime-types, grails-2.0

如何在 Grails 中获取请求的 Mime 类型？

我用了：

```
def f = request.getFile('image')
def mimeType = f.getContentType() 
```

但这并不总是返回正确的~~mime~~文件类型。如何获取选择更新的文件用户的文件？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-25T14:41:10.657

这将返回浏览器为发布的特定部分发送的任何内容类型`multipart/form-data`。这是否是“正确”类型是一个不同的问题......

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2020-06-24T20:34:58.553

你可以得到类似“text/xml; charset=UTF-8”的东西，所以你可能需要用“;”分割 得到正确的值。然后您需要检查该值是否有效，例如检查格式，或检查有效代码列表等。如果该值无效，您可以向用户返回 400 错误。

# silverlight - 在 Silverlight 中以编程方式设置网格背景颜色

> ID：15617548
> 
> 赞同：1
> 
> 时间：2013-03-25T14:33:31.697
> 
> 标签：silverlight, xaml, silverlight-3.0

我有一个数据模板

```
<DataTemplate x:Key="ConnectorItemFactory">
    <Button Style="{StaticResource TextOnlyActionTileButtonStyle}" Margin="0,0,5,0"
                HorizontalAlignment="Stretch"
                VerticalAlignment="Stretch"
                HorizontalContentAlignment="Stretch"
                VerticalContentAlignment="Stretch"
                Content="{Binding}"
                ContentTemplate="{StaticResource TileTemplate}"
                Command="{StaticResource NavigationCommand}"
                CommandParameter="{Binding}"
        Height="156"
        Width="156"
        >
      <i:Interaction.Behaviors>
        <UICommon:XboxBehavior VuiBinding="{Binding VuiTitle}"/>
      </i:Interaction.Behaviors>
    </Button>
  </DataTemplate> 
```

作为 ContentTemplate 它使用另一个数据模板

```
<DataTemplate x:Key="TileTemplate">
  <Grid VerticalAlignment="Stretch" HorizontalAlignment="Stretch" Background="{StaticResource ActionButtonBackgroundBrush}">
    <StackPanel Orientation="Vertical" HorizontalAlignment="Left" VerticalAlignment="Bottom" Margin="7,7,7,4">
      <Controls:TrimmedTextBlock Text="{Binding Title}" Style="{StaticResource TextOnlyTileTitleStyle}" TextWrapping="Wrap" />
      <Controls:TrimmedTextBlock Text="{Binding Converter={StaticResource SubtitleTextFormatter}}" Style="{StaticResource TextOnlyTileSubtitleStyle}"/>
    </StackPanel>
  </Grid>
</DataTemplate> 
```

我正在使用 TemplateFactory 加载内容模板

```
 public class GridTemplateFactory : ModelViewTemplateFactory
        {
            protected override void OnContentChanged(object oldContent, object newContent)
            {
                base.OnContentChanged(oldContent, newContent);

                var dataTemplate = Application.Current.Resources["ConnectorItemFactory"] as DataTemplate;

                // var grid = ((Button)dataTemplate.LoadContent()).ContentTemplate.LoadContent();
                // ((Grid)grid).Background = new SolidColorBrush(Colors.Orange);

                // ((Button)dataTemplate.LoadContent()).ContentTemplate.LoadContent().SetValue(Grid.BackgroundProperty, new SolidColorBrush(Colors.Orange));

                this.ContentTemplate = dataTemplate;
            }
        } 
```

在 OnContentChanged 方法中，我想从 TileTemplate 数据模板更改网格背景颜色。我试着像上面注释的代码那样做，但它不起作用。我怎样才能在这里改变颜色？

# jquery - jQuery垂直手风琴菜单：单击子节点时父节点折叠

> ID：15617549
> 
> 赞同：2
> 
> 时间：2013-03-25T14:33:36.573
> 
> 标签：jquery, accordion

我有一个脚本应该将手风琴功能添加到垂直菜单。我主要使用[这个博客](http://joao-pinho.blogspot.de/2012/11/sharepoint-2013-accordion-quicklaunch.html?m=1)的代码。我制作的菜单由多个级别组成，我在[这个 jsFiddle](http://jsfiddle.net/xMoshii/wxu6f/)中制作的示例只有 3 个级别，但我计划使用更多级别（这是我的客户的要求）。

当一个元素具有“选定”类时，我只希望在页面加载后立即显示该元素及其父元素。在示例中，该元素为绿色，但该元素的父元素当然也应显示。当用户选择要展开的不同元素时，它应该隐藏第一个元素并显示刚刚单击的元素的内容。

请先看一下示例，然后尝试一下。然后和下面的比较。
页面加载后，菜单首先应该是这样的：

```
 - Site 1
        - Site 1, page 1
        - Site 1, page 2
        - Site 1, subsite 1
            - Site 1, subsite 1, page 1
            - Site 1, subsite 1, page 2
        - Site 1, subsite 2
        - Site 1, page 3
    - Site 2 
```

如您所见，唯一应该立即可见的是 HTML 中包含“selected”类的元素。其余的都应该简单地折叠起来。当然，一旦用户单击另一个子站点，或者站点 1 或站点 2，它应该折叠当前已“选择”的子站点，并打开已单击的另一个元素。它现在的行为绝对不是我想要的，我一直在尝试很多，但到目前为止没有成功。

我无法完全了解如何解决此问题。自上周以来，我一直在努力让它发挥作用，但我仍然陷入困境。因此，如果有人可以看一下并告诉我我做错了什么以及为什么会这样，我将不胜感激。

一些附加信息：此菜单将在 SharePoint 2013 环境中使用，它将取代 SharePoint 快速启动菜单。

在此先感谢您的时间！

* * *

**编辑**：
如果 jsFiddle 变得不可用，这里是 HTML 和 JavaScript 代码。

HTML：

```
<body>
<div id="sideNavBox">
    <ul id="rootMenu" class="static root">
        <li class="static level-0 selected"><a class="static menu-item-li" href="#"><span>Site 1</span></a>
            <ul class="static level-0-ul selected">
                <li class="static level-1"><a class="static menu-item-li" href="#"><span>Site 1, page 1</span></a></li>
                <li class="static level-1"><a class="static menu-item-li" href="#"><span>Site 1, page 2</span></a></li>
                <li class="static level-1 selected"><a class="static menu-item-li" href="#"><span>Site 1, subsite 1</span></a>
                    <ul class="static level-1-ul selected">
                        <li class="static level-2 selected"><a class="static menu-item-li selected" href="#"><span>Site 1, subsite 1, page 1</span></a></li>
                        <li class="static level-2"><a class="static menu-item-li" href="#"><span>Site 1, subsite 1, page 2</span></a></li>
                    </ul>
                </li>
            <li class="static level-1"><a class="static menu-item-li" href="#"><span>Site 1, subsite 2</span></a>
                <ul class="static level-1-ul">
                    <li class="static level-2"><a class="static menu-item-li" href="#"><span>Site 1 subsite 2, page 1</span></a></li>
                    <li class="static level-2"><a class="static menu-item-li" href="#"><span>Site 1 subsite 2, page 2</span></a></li>
                </ul>

                </li>
                <li class="static level-1"><a class="static menu-item-li" href="#"><span>Site 1, page 3</span></a></li>
            </ul>
        </li>
        <li class="static level-0"><a class="static menu-item-li" href="#"><span>Site 2</span></a>
            <ul class="static level-0-ul">
                <li class="static level-1"><a class="static menu-item-li" href="#"><span>Site 2, page 1</span></a></li>
                <li class="static level-1"><a class="static menu-item-li" href="#"><span>Site 2, subsite 1</span></a>
                    <ul class="static level-1-ul">
                        <li class="static level-2"><a class="static menu-item-li" href="#"><span>Site 2, subsite 1, page 1</span></a></li>
                    </ul>
                </li>
                <li class="static level-1"><a class="static menu-item-li" href="#"><span>Site 2, subsite 2</span></a>
                    <ul class="static level-1-ul">
                        <li class="static level-2"><a class="static menu-item-li" href="#"><span>Site 2, subsite 2, page 1</span></a></li>
                        <li class="static level-2"><a class="static menu-item-li" href="#"><span>Site 2, subsite 2, page 2</span></a></li>
                    </ul>
                </li>
                <li class="static level-1"><a class="static menu-item-li" href="#"><span>Site 2, page 2</span></a></li>
                <li class="static level-1"><a class="static menu-item-li" href="#"><span>Site 2, page 3</span></a></li>
            </ul>
        </li>
    </ul>
</div> 
```

JavaScript：

```
 // Set dynamic CSS logic:
if($('#sideNavBox .menu-item-li.selected').length){
    // Propagates the selected class, up the three:
    $('li.static').removeClass('selected');
    $('#sideNavBox .menu-item-li.selected').parents('li.static').addClass('selected');
    // Collapses top siblings of selected branch:
    $('#sideNavBox .menu-item-li.selected').parents('li.static').last().siblings().find('> ul').hide();
    $('#sideNavBox .menu-item-li.selected').parents('li.static').siblings().find('> ul').hide();
}
else {
    $('#sideNavBox .root.static > li.static > ul').hide();
}

/* CODE INTENDED FOR COLLAPSING AND EXPANDING THE level-0 AND level-0-ul ELEMENTS */
$('#sideNavBox .root.static > li.static.level-0').each(function(){      // For each element,
    if($(this).find('ul').length){                                      // That has a ul inside it,
        $(this).addClass('father').click(function(){                    // Add the class 'father' to it. 
            if($(this).children('ul').css('display') != 'none'){
                $(this).removeClass('selected').children('ul').slideUp();
            }
            else {
            /*collapse-siblings*/
                $(this).siblings().removeClass('selected').children('ul').slideUp();
            /*expand*/
                $(this).addClass('selected').children('ul').slideDown();
            }
        });
    }
});

/* SAME CODE AS ABOVE BUT NOW INTENDED FOR COLLAPSING AND EXPANDING THE level-1 AND level-1-ul ELEMENTS */
$('#sideNavBox .root.static > li.static > ul.static > li.static').each(function(){
    if($('#sideNavBox .root.static > li.static > ul.static > li.static').find('ul').length){
        $(this).addClass('father2').click(function(){
            if($(this).children('ul').css('display') != 'none'){
                $(this).removeClass('selected').children('ul').slideUp();
            }
            else {
            /*collapse-siblings*/
                $(this).siblings().removeClass('selected').children('ul').slideUp();
            /*expand*/
                $(this).addClass('selected').children('ul').slideDown();
            }
        });
    }
});

/* CODE INTENDED FOR DISABLING DEFAULT LINK BEHAVIOR FOR level-0 AND level-0-ul ELEMENTS */
$('#sideNavBox .root.static > li.static > a.static').click(function(e) {
    /*Prevent the link from activating*/
    e.preventDefault();
    /*Upon clicking header, show contents*/
    $('#sideNavBox .root.static > li.static').addClass('selected').children('ul').slideUp();
});

/* CODE INTENDED FOR DISABLING DEFAULT LINK BEHAVIOR BUT NOW FOR level-1 AND level-1-ul ELEMENTS */
$('#sideNavBox .root.static > li.static.level-0 > ul.static.level-0-ul > li.static.level-1 > a.static').click(function(e) {
    /*Prevent the link from activating*/
    e.preventDefault();
    /*Upon clicking header, show contents*/
    $('#sideNavBox .root.static > li.static.level-0 > ul.static.level-0-ul > li.static.level-1').addClass('selected');
    $('#sideNavBox .root.static > li.static.level-0 > ul.static.level-0-ul > li.static.level-1').children('ul.level-1-ul').slideUp();
}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-26T20:50:56.213

你是我的老同学：http: [//jsfiddle.net/wxu6f/6/](http://jsfiddle.net/wxu6f/6/)

花了一些时间，但至少它的工作...我想？

```
function accordionMe(selector, initalOpeningClass) {

                var speedo = 300;
                var $this = selector;
                var accordionStyle = true; // fancy or not as fancy.. (just set it to true)

                // disable all links with # as href, or the page will jump like a chicken on coce
                $this.find("li").each(function(){
                    // Find all these links
                    if ($(this).find("ul").size() != 0) {
                        // and disable them if needed
                        if ($(this).find("a:first").attr('href') == '#') {
                            $(this).find("a:first").click(function(){ return false; });
                        }
                    }
                });

                // Hide every ul first
                $("#rootMenu li>ul").hide();

                // Open all items (depending on the class you chose)
                $this.find("li."+initalOpeningClass).each(function(){
                    $(this).parents("ul").slideDown(speedo);
                });

                // and now.. time for magic
                $this.find("li a").click(function(){
                    if ($(this).parent().find("ul").size() != 0) {
                        if (accordionStyle) {
                            if(!$(this).parent().find("ul").is(':visible')){

                                // get all parents
                                parents = $(this).parent().parents("ul");

                                // get all visible ul's'
                                visible = $this.find("ul:visible");

                                // Loop through
                                visible.each(function(visibleIndex){

                                    // check if parent was closed
                                    var close = true;
                                    parents.each(function(parentIndex){
                                        if(parents[parentIndex] == visible[visibleIndex]){
                                            close = false;
                                            return false;
                                        }
                                    });

                                    // if closed, close parent
                                    if(close)
                                        if($(this).parent().find("ul") != visible[visibleIndex])
                                            $(visible[visibleIndex]).slideUp(speedo);              
                                });
                            }
                        }

                        // if the parent was shown at first, hide him and vica versa
                        if($(this).parent().find("ul:first").is(":visible"))
                            $(this).parent().find("ul:first").slideUp(speedo);

                        else
                            $(this).parent().find("ul:first").slideDown(speedo);

                    }
                }); // einde klik event
            }

            accordionMe($("#rootMenu"), "selected"); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-26T10:59:49.397

为什么不做一些简单的事情

```
$("#rootMenu li>a").click(function(e){
    var tt = $(this).closest("li");
    if(tt.hasClass("selected"))
    {
        //Collapse all children
        tt.removeClass("selected");
        $("ul",tt).slideUp(500);
        tt.removeClass("selected");
    }
    else
    {
        //expand first level ul, a.k.a direct child
        $(">ul",tt).slideDown(500);
        tt.addClass("selected");
    }
}); 
```

[http://jsfiddle.net/wxu6f/4/](http://jsfiddle.net/wxu6f/4/)

# php - 如何通过文章递归地从表中获取所有类似物？

> ID：15617551
> 
> 赞同：5
> 
> 时间：2013-03-25T14:33:39.077
> 
> 标签：php, recursion

我创建了一个简单的类比表：

```
+----+-------+-------+
| id | sku_1 | sku_2 |
+----+-------+-------+
|  1 | a1    | abcd  |
|  2 | a2    | a3    |
|  3 | a3    | a1    |
+----+-------+-------+
3 rows in set (0.00 sec) 
```

什么意思？这意味着产品与文章`abcd`有一个与文章的类比`a1`，否则例如产品与文章`a3`有一个与文章的类比`a1`。

如何通过一篇文章递归地获取该表中的所有产品？

我的解决方案是错误的：

```
// Small Class to get analogs of products
class Analogs {

    public function get_analogs($sku)
    {
        if (!$sku) return false;

        $link = mysql_connect('localhost','','');
        mysql_select_db('test');

        $sku = mysql_real_escape_string($sku,$link);

        $query = mysql_query("SELECT * FROM analogs WHERE sku_1='".$sku."' OR sku_2='".$sku."'");

        while($analogs[]=mysql_fetch_assoc($query))
        continue;

        return $analogs;    
    }

    public function MixedAnalogs($sku)
    {
        if (!$sku) return false;

        $link = mysql_connect('localhost','','');
        mysql_select_db('test');

        $sku = mysql_real_escape_string($sku,$link);

        $query = mysql_query("select sku_1 sku from analogs where sku_2 = '$sku' UNION
                              select sku_2 sku from analogs where sku_1 = '$sku'");

        while($analogs[]=mysql_fetch_assoc($query))
        continue;

        return $analogs;
    } 

}

$mixed_analogs = AnalogsMix('abcd',$ids=array());

echo "<pre>";
print_r($mixed_analogs);
echo "</pre>";

// Recursive function to get analogs of analog
function AnalogsMix($sku,$ids=array())
{
    $class_analogs = new Analogs();
    $analogs = $class_analogs->get_analogs($sku);

    foreach ($analogs as $analog)
    {
        $cross = null;

        if ($analog['sku_1']==$sku)
        {
            $cross->sku = $analog['sku_2'];
        }
        else
        {
            $cross->sku = $analog['sku_1'];
        }

        $cross->id = $analog['id'];

        if (!in_array($analog['id'],$ids))
        {
            $ids[] = $analog['id'];
            $mixed[] = AnalogsMix($cross->sku,$ids);
        }
    }

    if (isset($mixed))
    {
        return $mixed;
    }
    else
    {
        return false;
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-25T16:34:05.637

我找到了解决这个问题的方法，但这种方法的主要问题是。它可以像`abcd->a1,a1->a3,a3->a2,a2->abcd`. 它使递归函数无穷无尽并且php抛出错误。所以你必须检查它是否是一个大项目。

在我的解决方案中，我认为它是父-> 子关系。如果找到一个孩子，让它成为父母并再次检查，依此类推，直到没有结果。

let`abcd`是父级，第一次执行后`a1`是子级，关系是`abcd->a1`. 但是在下一次调用 `a1`中是父级，并且从表的第一行开始，它给出了一个新的关系，`a1->abcd` 并且循环是无止境的。为了防止检查同一行，我使用`ID`数据库中的最后一行，现在检查 id ！= ID 的行（总是检查其他行）

这是我编写的函数，根据您的类对其进行转换并根据需要将值存储在数组中。我只使用一个字符串。我知道这不是一个好的解决方案，但我工作正常。

```
<?php 

mysql_connect('localhost','','');
mysql_select_db('test');

function getSku($sku, $id, $rel = '') {
    $query = mysql_query("SELECT * FROM analogs WHERE sku_1 = '$sku' AND id != '$id'" );
    if (mysql_num_rows($query)) {
        $row = mysql_fetch_assoc($query);
        $sku = $row['sku_2']; //PARENT SKU
        $id = $row['id']; //LAST ID
        $rel .= $row['sku_1']. '-->' . $row['sku_2']. "<br>";

    } else {
        $query = mysql_query("SELECT * FROM analogs WHERE sku_2 = '$sku' AND id != '$id'" );
        if (mysql_num_rows($query)) {
            $row = mysql_fetch_assoc($query);
            $sku = $row['sku_1']; //PARENT SKU
            $id = $row['id']; //LAST ID
            $rel .=$row['sku_2']. '-->' . $row['sku_1']. '<br>';
        } else {

            return (string)$rel; //NOTHING FOUND
        }
    }
    return getSku($sku,$id,$rel);    

}

echo $new = getSku('abcd','-1'); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-25T14:39:00.807

SQL 联合

```
select sku_1 sku from analogs where sku_2 = $yourid
union
select sku_2 sku from analogs where sku_1 = $yourid 
```

然后你会得到结果只有类似物的 id。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-25T15:01:06.413

在这里，我想您将所有对都放在一个数组中。例如，对于您的示例，您将调用`analogsOf(array(array("a1", "abcd"), array("a2", "a3"), array("a3", "a1")), "abcd")`.

这个想法是您构建一个类似物列表，最初只包含您正在寻找的字符串，并且每次找到一个类似物时，您都将其添加到类似物列表中并重复。你这样做直到你迭代整个对数组而没有找到任何新的东西。

```
function analogsOf(array $pairs, $key) {
    $res = array($key); // The result, with only the given key
    $i = 0;             // Index of the current item
    $changed = false;   // Have we added an item to $res during that iteration ?

    while ($i < count($pairs)) {
        $current = $pairs[$i];

        foreach ($res as $item) {
            if (($current[0] === $item) && (!in_array($current[1], $res)) {
                $res[] = $current[1];
                $i = 0;  // Reiterate as $res changed
            }
            else if (($current[1] === $item) && (!in_array($current[0], $res)) {
                $res[] = $current[0];
                $i = 0; // Reiterate as $res changed
            }
            else {
                $i++;  // Nothing found here, go to next item
            }
        }
    }

    return $res;
} 
```

请注意，此代码未经测试，因此可能到处都有一些错误，但您已经明白了。另请注意，我认为您可以将整个数据库内容放在一个数组中，但由于显而易见的原因，这可能是不可能的，因此您可能必须调整上面的代码。

# python - Gevent 多核使用

> ID：15617553
> 
> 赞同：25
> 
> 时间：2013-03-25T14:33:43.667
> 
> 标签：python, multiprocessing, gevent

我刚开始使用 python gevent，我想知道该库的 cpu / multitcore 使用情况。

尝试通过monkeypatched urllib 执行许多请求的一些示例我注意到，它们仅在一个核心上运行，使用99% 的负载。

如何使用 python 将所有内核与 gevent 一起使用？有最佳实践吗？或者使用多个进程和 gevent 是否有任何副作用？

BR丹

* * *

## 回答 #1

> 赞同：61
> 
> 时间：2013-03-25T14:39:05.247

Gevent 使您能够处理阻塞请求。它不会让您能够在多核上运行。

任何时候都只有一个 greenlet（gevent 的协程）在 python 进程中运行。gevent 的真正好处在于它在处理 I/O 瓶颈时非常强大（这通常适用于一般 Web 应用程序、服务 API 端点的 Web 应用程序、基于 Web 的聊天应用程序或后端，以及通常的联网应用程序） ）。当我们进行一些 CPU 密集型计算时，使用 gevent*不会*带来性能提升。当应用程序受 I/O 限制时，gevent 是纯粹的魔法。

有一个简单的规则：每当 I/O 操作阻塞或您明确地进行切换时（例如使用 gevent.sleep() ），Greenlets 就会被切换

内置的 python 线程实际上以与 gevent 的 greenlets 相同的（伪）“并发”方式运行。

关键区别在于 - greenlets 使用协作多任务，其中线程使用抢占式多任务。这意味着一个greenlet永远不会停止执行并“让步”给另一个greenlet，除非它使用某些“让步”函数（如gevent.socket.socket.recv或gevent.sleep）。

另一方面，线程将根据操作系统决定将它们换出的时间让给其他线程（有时是不可预测的）。

最后，*要在 Python 中使用多核*——如果这是你想要的——我们必须依赖多处理模块（它是 Python 中的内置模块）。这“绕过 GIL”。其他替代方法包括使用 Jython 或使用任务队列（例如 Zeromq）并行执行任务（在不同的 CPU 上）。

我在这里写了一个很长的解释 - [http://learn-gevent-socketio.readthedocs.org/en/latest/](http://learn-gevent-socketio.readthedocs.org/en/latest/)。如果你想深入了解细节。:-D

# validation - 如何替换 p:growl primefaces 的第一条消息

> ID：15617554
> 
> 赞同：1
> 
> 时间：2013-03-25T14:33:45.500
> 
> 标签：validation, jsf-2, primefaces, facelets, growl

我想使用 p:growl 来验证数据表[行编辑的输入](http://www.primefaces.org/showcase/ui/datatableRowEditing.jsf)

但问题是验证消息在 p:growl 上写了两次

如何在 xhtml 页面中将第一个文本替换为另一个文本（例如“错误验证”或“错误转换”）（因为托管 bean 中不会出现此问题）

这是我的专栏之一：

```
 <p:column headerText="Commission" filterBy="#{car.commission}" style="width:25%">
    <p:cellEditor>
        <f:facet name="output">
            <h:outputText value="#{car.commission}" />
        </f:facet>
        <f:facet name="input">
            <p:inputText value="#{car.commission}" label="Commission" requiredMessage="Veuillez saisir une valeur"
            converterMessage="Veuillez saisir un nombre" validatorMessage="Veuillez saisir entre 0 et 100">
                <f:validateDoubleRange minimum="0" maximum="100" />
            </p:inputText>
        </f:facet>
    </p:cellEditor>
</p:column> 
```

先感谢您

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-25T16:45:51.257

根据您希望自定义的特定消息（您对此不清楚），您应该编辑JSF2 捆绑包附带的*jsf-api.jar*包中的**Messages.properties**文件的内容。我想您希望自定义转换器摘要和详细消息（基于您的问题历史记录）。为达到这个`javax.faces`

 *1.  找到`javax.faces.converter.DoubleConverter.DOUBLE`和`javax.faces.converter.DoubleConverter.DOUBLE detail`条目。

2.  根据您正在使用的本地，编辑两个键的消息条目并保存文件*

# iphone - 我的应用中的 AppReview

> ID：15617557
> 
> 赞同：-3
> 
> 时间：2013-03-25T14:33:50.203
> 
> 标签：iphone, objective-c, app-store, mac-app-store

我有可能处理用户评论吗？

例如： - 用户可以在一些 UITextField 中写评论，并在写完后发送吗？（没有找到类似的东西） - 或者我可以在 AppStore 上处理他的评论（但我在 apstore 网页上找不到 userAppleId）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-25T14:36:29.893

我想你是在问你是否可以在你的应用程序中提供一个界面，供用户用来编写你的应用程序的 App Store 评论。

答案是否定的，你不能那样做。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-25T14:42:25.070

在用户为您的应用撰写评论后，您无法对评论进行任何操作。而且您不能制作文本字段来让用户查看您的应用程序。您可以做的是打开一个 url，将用户引导到您的应用程序页面，因此用户只需单击`Write Review`AppStore 中的按钮即可开始撰写评论。有很多开源库可用于简化您的工作以引导用户查看，例如[iRate](https://github.com/nicklockwood/iRate)和[appirater](https://github.com/arashpayan/appirater)。

# c - SIGINT(ctrl+c) 不会中断接受调用

> ID：15617562
> 
> 赞同：4
> 
> 时间：2013-03-25T14:34:05.383
> 
> 标签：c, sockets, unix, signals

在无限循环中，我正在接受新连接，但我需要选择停止该服务器，所以我想使用 ctrl+c (SIGINT)。当我按下它时，它会调用我的信号处理程序，但它不会中断接受调用，因此不会评估中断是否为真的检查（当没有客户端连接时，接受会长时间阻塞）。

```
sig_atomic_t interrupt;
.
.
.
signal(SIGINT, sigintHandler);
.
.
.
while(!interrupt) {
  server.accept();
}
.
.
.
void sigintHandler(int param) {
    interrupt = 1;
} 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-03-25T14:55:32.997

`SA_RESTART`默认情况下，您的操作系统在使用`signal()`. 您应该能够在手册页中确认这一点。由于您不希望发生这种情况，请使用`sigaction()`设置处理程序并省略`SA_RESTART`标志。

# batch-file - 如何通过在批处理文件中设置超时来打破无限条件？

> ID：15617564
> 
> 赞同：0
> 
> 时间：2013-03-25T14:34:13.667
> 
> 标签：batch-file

我正在批处理文件中执行程序。如果批处理脚本运行超过一段时间（比如 10 秒），我想中断。因为它可能会变成一个无限循环。

```
cls
::set timeout here
program.exe
::after timeout continue from here 
```

有什么建议可以在 Windows 批处理文件中执行此操作吗？另外，是否可以在批处理脚本中定义无限循环行？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-25T15:48:17.203

从批处理文件运行程序时，您要么运行它并等待它终止，然后再执行批处理文件中的下一个命令，要么启动程序并立即在批处理文件中继续执行。没有办法衡量一个程序运行了多长时间。但是，您可以使用某些技术来查看程序是否正在运行并终止它。您还可以插入延迟。所以你可以做你所要求的（或多或少）：

```
cls
start program.exe
ping -n 10 -w 1000 127.0.0.1 > nul 2>&1
tasklist | find /i "program.exe"
if %errorlevel%==0 taskkill /im program.exe 
```

这将启动程序并立即开始执行下一行代码，即`ping`. 这`ping`会导致 10 秒的延迟。该`tasklist`命令将列表通过管道传输到`find`，它会查找程序。如果在列表中找到它，则它仍在运行并`errorlevel`设置为`0`，这意味着下一行终止程序。

然而，这并不是万无一失的，因为 if`program.exe`是一个通用的程序名称，然后`tasklist`将`taskkill`终止具有相同程序名称的所有进程（不仅仅是您启动的实例）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-25T15:47:06.070

那个怎么样？

```
start calc.exe
ping -n 10 localhost >nul
taskkill /F /IM calc.exe 
```

# azure - 使用 Azure 缓存调试 Web 应用程序

> ID：15617565
> 
> 赞同：0
> 
> 时间：2013-03-25T14:34:19.807
> 
> 标签：azure, azure-caching

我想找到调试现有 ASP.NET MVC 应用程序的最佳实践。这是已托管在 Azure 中的 Web 角色。该应用程序正在使用 Windows Azure 缓存。配置文件已使用 Azure 帐户的 settgins 定义 ->

```
<dataCacheClient name="default">
   <hosts>
      <host name="xxxx.cache.windows.net" cachePort="22233" />
   </hosts>
</dataCacheClient> 
```

我想调试代码。在这种情况下最好的方法是什么？

我已经通过使用 localhost 更改主机进行了测试，但它不起作用。

谢谢，

PS：我已经安装了新的SDK 1.8

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-26T14:16:24.983

没有与 Azure 共享缓存等效的本地安装。Windows Server AppFabric 缓存有点接近，但[并不完全相同](http://msdn.microsoft.com/en-us/library/windowsazure/gg185678.aspx)。

您可以尝试让 IT 解除对端口的阻塞，以便使用 Azure。尽管如果您在一个项目中有多个开发人员，则每个开发人员都需要自己的缓存实例以避免踩到彼此的数据。

另一种选择是将缓存完全封装在接口中。然后你可以使用完全不同的东西来开发。过去，我使用[MemoryCache](http://msdn.microsoft.com/en-us/library/system.runtime.caching.memorycache.aspx)内存存储进行开发。您还可以使用 AppFabric 缓存、memcached 或其他任何东西。您只需要了解开发系统和生产系统之间的差异。

编辑：另一种选择是从共享缓存切换到[您的角色中的缓存](http://msdn.microsoft.com/en-us/library/windowsazure/hh914161.aspx)（这些天我不确定它的正式名称是什么）。我相信这也适用于本地。主要缺点是它仅在一个托管服务中可见。如果您仍然只有一个托管服务，那没问题。如果您有多个托管服务需要共享数据，那么这可能是个问题。

# position - 自定义 MKAnotaionView，在地图上显示标题/副标题位置

> ID：15617568
> 
> 赞同：-1
> 
> 时间：2013-03-25T14:34:34.353
> 
> 标签：position, mkmapview, mkannotationview, callout

1）我的注释显示了not的标题和副标题。我已经尝试了很多，但我做不到。

2) 如果已选择注释，则注释将位于窗口中间。所以地图被移动了。任何想法？

3）我的标注按钮不再起作用，我有`@ selector (openAnything)`但我想使用这个功能被触发`- (void) mapView: (MKMapView *) mapView annotationView: (MKAnnotationView *) view calloutAccessoryControlTapped: (UIControl *) control {`

够问了，这里有一个视频和一些源代码 [http://www.youtube.com/watch?v=Ur1aqeYEFHw&feature=youtube_gdata_player](http://www.youtube.com/watch?v=Ur1aqeYEFHw&feature=youtube_gdata_player)

谢谢

## **TAPPMapViewControler.m**

```
- (MKAnnotationView *)mapView:(MKMapView *)MapView viewForAnnotation:(id<MKAnnotation>)annotation {

if ([annotation isKindOfClass:[TAPPMapAnnotation class]])
{
    static NSString *shopAnnotationIdentifier = @"Filiale";

    //pinView = (MKPinAnnotationView *)
    TAPPMapAnnotationCustom* pinView = (TAPPMapAnnotationCustom*)[self.myMapView dequeueReusableAnnotationViewWithIdentifier:shopAnnotationIdentifier];
    [self.myMapView dequeueReusableAnnotationViewWithIdentifier:shopAnnotationIdentifier];
    if (pinView == nil)
    {

        // if an existing pin view was not available, create one
        TAPPMapAnnotationCustom *customPinView = [[TAPPMapAnnotationCustom alloc] initWithAnnotation:annotation reuseIdentifier:shopAnnotationIdentifier];
        customPinView.image          = [UIImage imageNamed:@"map_pin.png"];

        return customPinView;
    }
    else
    {
        pinView.annotation = annotation;
    }
    return pinView;
}
return nil;
}

-(void)mapView:(MKMapView *)mapView annotationView:(MKAnnotationView *)view calloutAccessoryControlTapped:(UIControl *)control {
TAPPMapAnnotation *theAnnotation = view.annotation;
TAPPMapAnnotationDetail *theController = [self.storyboard instantiateViewControllerWithIdentifier:@"MapAnnotationDetail"];
theController.theAnnotationId   = theAnnotation.objectId;
[self.navigationController pushViewController:theController animated:YES];

} 
```

## **TAPPMapAnnotationCustom.h**

```
#import <MapKit/MapKit.h>

@interface TAPPMapAnnotationCustom : MKAnnotationView

@property (strong, nonatomic) UIImageView *calloutView;
@property (strong, nonatomic) UILabel *title;
@property (strong, nonatomic) UILabel *subTitle;

- (void)setSelected:(BOOL)selected animated:(BOOL)animated;
- (void)animateCalloutAppearance:(BOOL)inAdd;

@end 
```

## **TAPPMapAnnotationCustom.m**

```
#import "TAPPMapAnnotationCustom.h"
#import "TAPPMapAnnotation.h"

@implementation TAPPMapAnnotationCustom

- (void)setSelected:(BOOL)selected animated:(BOOL)animated{

    [super setSelected:selected animated:animated];

    if(selected)
    {
        // Remove Image, because we set a second large one.
        self.image = Nil;
        UIImage *imageBack = [[UIImage imageNamed:@"map_pin.png"] resizableImageWithCapInsets:UIEdgeInsetsMake(0, 35, 0, 6)];
        self.calloutView = [[UIImageView alloc]initWithImage:imageBack];
        [self.calloutView  setFrame:CGRectMake(0,0,0,0)];
        [self.calloutView  sizeToFit];
        [self addSubview:self.calloutView ];

        // Callout Button
        UIButton* rightButton = [UIButton buttonWithType:UIButtonTypeDetailDisclosure];
        [rightButton addTarget:self action:@selector(openAnything) forControlEvents:UIControlEventTouchUpInside];

        rightButton.frame = CGRectMake(0
                                       , ((self.calloutView.frame.size.height-6) / 2)-(rightButton.frame.size.height / 2)
                                       , rightButton.frame.size.width
                                       , rightButton.frame.size.height);

        self.rightCalloutAccessoryView = rightButton;
        self.rightCalloutAccessoryView.hidden = YES;
        self.rightCalloutAccessoryView.alpha = 0;
        [self addSubview:self.rightCalloutAccessoryView];

        // Start Annimation 
        [self animateCalloutAppearance:YES];

    } else {
        //Start Annimation and Remove from view
        [self animateCalloutAppearance:NO];
    }
}

- (void)didAddSubview:(UIView *)subview{

    if ([[[subview class] description] isEqualToString:@"UICalloutView"]) {
        for (UIView *subsubView in subview.subviews) {
            if ([subsubView class] == [UIImageView class]) {
                UIImageView *imageView = ((UIImageView *)subsubView);
                [imageView removeFromSuperview];
            }else if ([subsubView class] == [UILabel class]) {
                UILabel *labelView = ((UILabel *)subsubView);
                [labelView removeFromSuperview];
            }
        }
    }
}

- (void)animateCalloutAppearance:(BOOL)inAdd {

    if (inAdd == YES) {

        self.rightCalloutAccessoryView.hidden = NO;

        [UIView animateWithDuration:0.4 delay:0 options: UIViewAnimationOptionTransitionNone
                         animations:^{

                             self.calloutView.frame = CGRectMake(self.calloutView.frame.origin.x
                                                                 , self.calloutView.frame.origin.y
                                                                 , self.calloutView.frame.size.width+150
                                                                 , self.calloutView.frame.size.height);

                             self.rightCalloutAccessoryView.alpha = 1;
                             self.rightCalloutAccessoryView.frame = CGRectMake(self.calloutView.frame.size.width - (self.rightCalloutAccessoryView.frame.size.width)
                                                                               , self.rightCalloutAccessoryView.frame.origin.y
                                                                               , self.rightCalloutAccessoryView.frame.size.width
                                                                               , self.rightCalloutAccessoryView.frame.size.height);

                         } completion:^(BOOL finished){ }];

    } else {

        [UIView animateWithDuration:0.4 delay:0 options: UIViewAnimationOptionTransitionNone
                         animations:^{

                             self.rightCalloutAccessoryView.alpha = 0;
                             self.rightCalloutAccessoryView.frame = CGRectMake(0
                                                                               , self.rightCalloutAccessoryView.frame.origin.y
                                                                               , self.rightCalloutAccessoryView.frame.size.width
                                                                               , self.rightCalloutAccessoryView.frame.size.height);

                             self.calloutView.frame = CGRectMake(self.calloutView.frame.origin.x
                                                                 , self.calloutView.frame.origin.y
                                                                 , self.calloutView.frame.size.width-150
                                                                 , self.calloutView.frame.size.height);

                         } completion:^(BOOL finished){

                             self.image = [UIImage imageNamed:@"map_pin.png"];
                             [self.calloutView  removeFromSuperview];
                             [self.rightCalloutAccessoryView removeFromSuperview];

                         }];
    }
}

@end 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-26T08:45:37.080

我修复了第一个：

```
 TAPPMapAnnotation *theAnnotation = (TAPPMapAnnotation *)self.annotation;
    self.title           = [[UILabel alloc]init];
    self.title.font      = [UIFont systemFontOfSize:12.0];
    self.title.textColor = [UIColor whiteColor];
    self.title.backgroundColor = [UIColor clearColor];

    self.title.text      = theAnnotation.title;
    [...]
    [self.theView addSubview:self.title]; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-26T01:34:44.300

你的注释类需要有一个`subtitle`属性，你的有`subTitle`.

如果`calloutAccessoryControlTapped`没有被调用，通常表明您的 MKMapview 的委托尚未设置。但是，您仅在选择附件按钮时才对其进行设置。你有充分的理由吗？由于标注窗口在被选中之前是不可见的，所以我建议您设置附件按钮`viewForAnnotation`并在标注窗口出现时让它出现。

# iphone - 类的全局实例

> ID：15617569
> 
> 赞同：2
> 
> 时间：2013-03-25T14:34:37.213
> 
> 标签：iphone, objective-c, xcode

我试图让一个类的实例在 .m 文件的所有方法中都可用。而不是在每个方法中都这样做：

```
-(void)viewDidLoad
{
    Class *c = [Class new];
} 
```

我在 .h 文件中的尝试：

```
@interface RandomViewController : UIViewController
{
    Class *c [Class new];
} 
```

但它不起作用，我得到错误

> 预期的 ';' 在声明列表的末尾

我将如何使这成为可能？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-25T15:27:14.557

创建一个实例变量，并在您指定的初始化程序中设置它。这是一个示例`@implementation`块。

```
@implementation RandomViewController {
    // Instance variable names should start with an underscore, by convention.
    Class *_c;
}

...

// Designated initializer for UIViewController
- (id)initWithNibName:(NSString *)nibNameOrNil bundle:(NSBundle *)nibBundleOrNil
{
    self = [super initWithNibName:nibNameOrNil bundle:nibBundleOrNil];
    if (self) {
        _c = [[Class alloc] init];
    }
    return self;
}

...

- (void)someMethodThatNeedsAClassInstance
{
    [_c doSomething];
} 
```

如果您不使用 ARC，则需要添加`[_c release]`到您的`dealloc`实现中。

现在，在您的类中的每个方法中，您都可以引用`_c`并获取您在初始化程序中创建的实例。作为旁注，这并不是真正的“全局”实例 - 它是每个对象。您创建的每个单独的视图控制器都有自己的`_c`. 此外，一个更好的方法是声明一个[属性](http://developer.apple.com/library/ios/#documentation/cocoa/conceptual/ProgrammingWithObjectiveC/EncapsulatingData/EncapsulatingData.html)，而不是声明一个实例变量。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-25T14:37:23.487

在 .h 文件中：

```
@interface RandomViewController : UIViewController
{
    Class *c;
} 
```

在 .m 文件中：

```
-(void)viewDidLoad
{
    c = [[Class alloc] init];
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-25T15:24:07.620

它的类方法是做什么的？如果返回无效：

类.h 文件：

```
@interface Class: NSObject
{
}
- (void)new; 
```

随机视图控制器.h

```
@interface RandomViewController : UIViewController
    {
        Class *c;
    } 
```

RandomViewController.m 文件

```
-(void)viewDidLoad
{
    c = [[Class alloc] init];  
    //call the method
    [c new];
} 
```

# html - 在同一页面上使用多个网格 (jqGrid) 时是否存在行 ID 冲突？

> ID：15617575
> 
> 赞同：-1
> 
> 时间：2013-03-25T14:34:50.637
> 
> 标签：html, jqgrid

我正在创建一个表单，它将基于 XML 数据显示多个网格（4 个标准网格和 1 个子网格）。到目前为止，在我的所有测试中，一切正常。我已经能够使用 getRowData、getGridParam 等来遍历网格，但是，在调试时，我注意到对于每个网格，行 ID 只是从 1 开始的数字，似乎无法区分它们。这会产生任何冲突吗？如果没有，有人可以向我解释为什么吗？我只是希望在它上线后限制任何惊喜。提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-25T15:02:20.073

You can use `idPrefix` option of jqGrid to solve the problem. For example if you have two grids of the page you can use `idPrefix: "g1_"` for the first grid and `idPrefix: "g2_"` for the second one. If both grids have ids 1, 2, 3, ... in case of usage without `idPrefix` option then the ids of the grid with `idPrefix: "g1_"` will be "g1_1", "g1_2", "g1_3", ... and the ids of the grid with `idPrefix: "g2_"` will be "g2_1", "g2_2", "g2_3", ... In the way you will have no more id duplicates.

The option `idPrefix` is especially practical if you download the data from server. The option `idPrefix` changes *local* ids only. If one for example modify the row the prefix will be cut from the `id` value which will be sent to the server. In the way one can just work on the server with native ids from database tables.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-25T14:59:28.830

行 ID 应基于您从服务器返回的数据。请参阅此处的文档部分：

[http://www.trirand.com/jqgridwiki/doku.php?id=wiki:retrieving_data](http://www.trirand.com/jqgridwiki/doku.php?id=wiki:retrieving_data)

基本上，您有责任确保返回的 XML 使用唯一`id`值。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-25T14:48:07.070

我不知道您正在使用的网格，但我知道`id`应该是站点 DOM 结构内的唯一标识符。

*   [HTML 4.0.1 规范](http://www.w3.org/TR/html4/struct/global.html#adef-id)

*   [HTML 5 规范](http://www.w3.org/TR/html5/dom.html#the-id-attribute)

如果网格使用该 id 进行任何类型的操作，它可能会失败。如果没有，即使 HTML 无法验证，它也可能运行良好。

# vb.net - vb.net NotifyIcon 显示没有气球的通知

> ID：15617578
> 
> 赞同：0
> 
> 时间：2013-03-25T14:34:56.997
> 
> 标签：vb.net

我有一个程序设置，导致 NotifyIcon 在某些条件下按时钟出现，然后在其他条件下消失，使用 NotifyIcon1.visible = True/False 并使用 Windows 中的任务栏属性将其行为设置为“显示图标和通知”。但是，当它不可见时，如果不打开任务管理器，我就看不到它是否正在运行。

我希望能够在将图标显示在时钟旁边和将其与所有其他图标一起隐藏（当您选择“仅显示通知”时其他程序所做的方式）之间切换，但我想不通了解如何在*不使用气球提示的情况下*做到这一点。

# javascript - CSS 额外的可滚动空白

> ID：15617579
> 
> 赞同：0
> 
> 时间：2013-03-25T14:35:05.003
> 
> 标签：javascript, html, css

嗨，我有一个包含信息的矩形，它也可以滚动，但是我注意到内容下方有额外的滚动空白，我该如何解决这个问题。我不确定它是否会在 jsfiddle 上清晰显示，因为我有很多图像：

[http://jsfiddle.net/Lezuus/EUKxX/1/](http://jsfiddle.net/Lezuus/EUKxX/1/)

滚动框 CSS

```
 #rect {
              font-family: 'OpenSansRegular';
              text-align: justify;
              width: 917px;
              height: 800px;
              background:white;
              position: relative ;
              left:185px;
              top:100px;
              -moz-box-shadow: 0 0 5px #888;
              -webkit-box-shadow: 0 0 5px #888;
              -moz-border-radius: 5px;
              -webkit-border-radius: 5px;
              -khtml-border-radius: 5px;
              border-radius: 5px;
              overflow:scroll;
              overflow-x:hidden;
              color:#484848;

              } 
```

有什么建议么？

# ios - 为什么我的 JSON 请求使用 AFNetworking 失败？

> ID：15617580
> 
> 赞同：0
> 
> 时间：2013-03-25T14:35:05.950
> 
> 标签：ios, objective-c, cocoa-touch, afnetworking

我正在访问[Clear Read API](http://api.thequeue.org/v1/)以从链接中提取文章文本，并且 API 通过将参数放入此 URL 来工作：`http://api.thequeue.org/v1/clear?url=&format=`在 URL 之后可以放置的位置，例如，`http://www.nytimes.com/2013/03/25/business/global/cyprus-and-europe-officials-agree-on-outlines-of-a-bailout.html?hp&_r=0`在格式之后放置`json`.

然后，它将以状态代码、an 的形式返回 JSON，`item`然后在`item`文章的标题、其 URL 和提取的文章文本中返回。

我正在尝试通过 AFNetworking 和 AFHTTPClient（子类为 AFClearReadClient）与以下代码进行交互：

我的 AFClearReadClient 类：

```
#import "AFClearReadClient.h"
#import "AFJSONRequestOperation.h"

@implementation AFClearReadClient

+ (AFClearReadClient *)sharedClient {
    static AFClearReadClient *sharedClient = nil;
    static dispatch_once_t onceToken;
    dispatch_once(&onceToken, ^{
        sharedClient = [[AFClearReadClient alloc] initWithBaseURL:[NSURL URLWithString:@"http://api.thequeue.org/v1/clear?url=&format="]];
    });

    return sharedClient;
}

- (id)initWithBaseURL:(NSURL *)url {
    if (self = [super initWithBaseURL:url]) {
        [self registerHTTPOperationClass:[AFJSONRequestOperation class]];
        [self setDefaultHeader:@"Accept" value:@"application/json"];
    }

    return self;
} 
```

以及我的根视图控制器中的以下内容：

```
- (void)addArticlesToQueueFromList:(NSDictionary *)articles {
    // Restrict amount of operations that can occur at once
    [[AFClearReadClient sharedClient].operationQueue setMaxConcurrentOperationCount:5];

    // Create an array to hold all of our requests to make
    NSMutableArray *requestOperations = [[NSMutableArray alloc] init];

    for (NSString *key in articles) {
        // Create the request from the article's URL and the request parameters
        NSString *articleURL = [[articles objectForKey:key] objectForKey:@"resolved_url"];
        NSDictionary *requestParameters = @{@"url": articleURL,
                                            @"format": @"json"};
        NSMutableURLRequest *request = [[AFClearReadClient sharedClient] requestWithMethod:@"GET" path:nil parameters:requestParameters];

        // Create the request operation and specify behaviour on success and failure
        AFHTTPRequestOperation *requestOperation = [[AFClearReadClient sharedClient] HTTPRequestOperationWithRequest:request success:^(AFHTTPRequestOperation *operation, id responseObject) {
            // Get the item NSDictionary from the JSON responseObject
            NSDictionary *item = [responseObject objectForKey:@"item"];

            // Get the values needed to create an article
            NSString *title = [item objectForKey:@"title"];
            NSString *URL = [item objectForKey:@"link"];
            NSString *body = [item objectForKey:@"description"];

            // Create and add the article to our list of articles
            Article *article = [[Article alloc] initWithTitle:title URL:URL body:body];
            [self.articles insertObject:article atIndex:0];
        } failure:^(AFHTTPRequestOperation *operation, NSError *error) {
            NSLog(@"Request operation error");
        }];

        // Save the request operation in an NSArray so all can be enqueued later
        [requestOperations addObject:requestOperation];
    }

    // Enqueue the request operations
    [[AFClearReadClient sharedClient] enqueueBatchOfHTTPRequestOperations:requestOperations progressBlock:^(NSUInteger numberOfFinishedOperations, NSUInteger totalNumberOfOperations) {
        NSLog(@"Processing...");
        [self.tableView reloadData];
    } completionBlock:^(NSArray *operations) {
        NSLog(@"Done!");
    }];
} 
```

但是每当我运行它时，我都希望我的表格视图被填充（它从 RootViewController 的文章数组中获取它的单元格），但是我在控制台中得到了以下内容：

```
2013-03-25 11:31:35.470 [19020:c07] Processing...
2013-03-25 11:31:35.471 [19020:c07] Request operation error
2013-03-25 11:31:35.476 [19020:c07] Processing...
2013-03-25 11:31:35.476 [19020:c07] Request operation error
2013-03-25 11:31:35.477 [19020:c07] Processing...
2013-03-25 11:31:35.477 [19020:c07] Request operation error
2013-03-25 11:31:35.480 [19020:c07] Processing...
2013-03-25 11:31:35.480 [19020:c07] Request operation error
2013-03-25 11:31:35.481 [19020:c07] Processing...
2013-03-25 11:31:35.482 [19020:c07] Request operation error
2013-03-25 11:31:35.488 [19020:c07] Done! 
```

到底出了什么问题？我已经考虑过了，但我似乎无法弄清楚出了什么问题。当我一次只使用一个 NSURLConnection 时（对于我想做的事情来说效率不够高），它起作用了，但我似乎把 AFNetworking 搞砸了。

它与我的`requestParameters`变量有关吗？我是否错误地向 Clear Read API 发出请求？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-25T15:01:59.240

您应该检查错误对象包含的内容，但我认为您的基本 url 不正确，因为它包含 get 参数的键，但在需要时会从 AFNetworking 添加这些键。

```
sharedClient = [[AFClearReadClient alloc] initWithBaseURL:[NSURL URLWithString:@"http://api.thequeue.org/v1/clear?url=&format="]]; 
```

应该读

```
sharedClient = [[AFClearReadClient alloc] initWithBaseURL:[NSURL URLWithString:@"http://api.thequeue.org/v1/clear"]] 
```

检查错误，做

```
…
} failure:^(AFHTTPRequestOperation *operation, NSError *error) {
    NSLog(@"Request operation error %@", [error localizedDescription]);
}]; 
```

* * *

您也可以尝试将基本网址设置`http://api.thequeue.org/`为

```
NSMutableURLRequest *request = [[AFClearReadClient sharedClient] requestWithMethod:@"GET" 
                                              path: [NSString stringWithFormat:@"/v1/clear?url=%@&format=json", articleURL]
                                        parameters:nil]; 
```

如果这碰巧起作用而另一个不起作用，我认为这是因为 api 文档中规定的限制：

> **重要提示**：url 查询必须始终排在第一位。

* * *

我重新创建了您的项目。Indead 您的第一个代码会产生这个格式错误的网址：

```
 NSErrorFailingURLKey=http://api.thequeue.org/v1/clear/?url=&format=?format=json&url=http%3A%2F%2Fwww.nytimes.com%2F2013%2F03%2F25%2Fbusiness%2Fglobal%2Fcyprus-and-europe-officials-agree-on-outlines-of-a-bailout.html%3Fhp%26_r%3D0 
```

并通过我的修复：

```
http://api.thequeue.org/v1/clear/?format=json&url=http%3A%2F%2Fwww.nytimes.com%2F2013%2F03%2F25%2Fbusiness%2Fglobal%2Fcyprus-and-europe-officials-agree-on-outlines-of-a-bailout.html 
```

什么在技术上是正确的，但是 api 是有限的，因为 url 参数不是第一个。

# asp.net - 在动态数据详细信息视图中单击外键链接时出现索引超出范围错误

> ID：15617582
> 
> 赞同：0
> 
> 时间：2013-03-25T14:35:10.817
> 
> 标签：asp.net, asp.net-dynamic-data

使用 ASP.NET，我使用自定义页面创建了动态数据文件夹。该文件夹引用的数据库中的表有 3 个 FK，当在表内的屏幕上查看时，这些 FK 显示为超链接（见下文）

![DetailsView 控件的屏幕截图](../Images/7bddc8bc71b676ab5b54a14984c26d10.png)

以第一条记录为例，当我点击“thur 21st March”或“100”时，它会将我带到相应的页面，即特定的日记页面或发票页面。

但是，当我单击“那边”以加载应用程序崩溃的分包商页面时，问题是：

```
void DetailsView1_PreRender(object sender, EventArgs e)
{
    int rowCount = DetailsView1.Rows.Count;

    SetDelete(DetailsView1.Rows[rowCount - 1]);
} 
```

错误是：

> 指数超出范围。必须是非负数且小于集合的大小。参数名称：索引

# django - Django 避免为现有数据库创建测试数据库

> ID：15617585
> 
> 赞同：4
> 
> 时间：2013-03-25T14:35:13.433
> 
> 标签：django

我有一个加载了数据的现有数据库“ **A** ”，这是我正在集成的另一个项目的一部分。我正在使用多数据库 Django 支持并将我需要持久保存在Django 建模的数据库“ **B ”中的东西。**

现在我想运行测试，这会为我创建两个测试数据库。问题是测试数据库“A”没有表或数据。

有没有办法避免为“ **A** ”（这是一个只读的非生产数据库）创建测试数据库并直接使用“ **A** ”？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-05-23T00:27:53.147

如果我没看错`django.test.simple.DjangoTestSuiteRunner.setup_databases`，您可以通过为数据库定义设置来避免创建测试`'TEST_MIRROR'`数据库。

该选项旨在用于[测试主/从配置](https://docs.djangoproject.com/en/dev/topics/testing/advanced/#topics-testing-masterslave)，但如果将镜像设置为与配置选项的数据库相同的数据库，则可以达到预期效果：

```
DATABASES = { 
    'A': {
        'ENGINE': ..., # standard configuration goes here
        'TEST_MIRROR': 'A',
    }, 
    'B': {
        'ENGINE': ..., # no TEST_MIRROR, a test database will be created for B
    } 
} 
```

不会为“ **A** ”创建测试数据库，而是将其替换`TEST_MIRROR`为“ **A** ”，因此测试将按预期在“ **A** ”和“ **test_B** ”上运行。

# javascript - 使用 javascript 填充表单字段

> ID：15617587
> 
> 赞同：0
> 
> 时间：2013-03-25T14:35:17.530
> 
> 标签：javascript, playframework-2.0

我有一个表单，其中包含由用户填充的几个字段，并且在提交之前，当一个检查按钮时会调用一些 javascript。它尝试将表单字段的值设置为 js 函数中存在的变量。

```
document.getElementById('var1').innerHTML = test;
alert(test); 
```

我知道 javascript 正在按预期工作，因为我看到了警报，但没有填充表单框：

```
@helper.input(testForm("var1")) { (id,name,value,args) => <input type="text" name="@name" id="@id" @toHtmlArgs(args)> } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-25T14:49:19.577

`innerHTML`用于获取/设置 html 标记的正文，因此您可能最终会在 html 中使用它：

```
<input ...>test</input> 
```

我认为这可能适用于 a `<textarea>`，但对于您`<input type="text">`想要设置`value`属性的您。

```
document.getElementById('var1').value = test; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-09-14T20:12:41.560

如果你想通过 JS 以编程方式设置一个 html 表单字段，有很多方法可以做到这一点，并且有许多库可以让它变得非常容易。

比如各种JS双向组件模板绑定库。

例如，您可以简单地执行以下操作：

HTML：

```
<div id="myapp">
 <input id="var1"/>
 <button>Submit</button>
</div> 
```

JS：

```
mag.module('myapp',{
  view : function(state){
    var test= 'tester';
    state.button= {
      _onclick:function(){
        state.var1=test
      }
    }
 }
}); 
```

这是上述示例的工作示例：http: [//jsbin.com/ciregogaso/edit ?html,js,output](http://jsbin.com/ciregogaso/edit?html,js,output)

希望有帮助！

# jquery - 验证不适用于 jqBootstrapValidation 和 ajax

> ID：15617589
> 
> 赞同：3
> 
> 时间：2013-03-25T14:35:23.560
> 
> 标签：jquery, twitter-bootstrap, validation

在 jQuery 中，我在引导表单上使用带有 jqBootstrapValidation 插件的 $.ajax 方法，但验证无法正常工作。我在用

```
$('#updatenamebutton').click(function(event)
{
   event.preventDefault();
} 
```

`preventDefault`正在停止验证工作，但我不想实际提交值，所以我正在使用`event.preventDefault();`. 有任何想法吗？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-04-14T17:10:44.397

您只需要将 ajax 函数放入 jqBootstrapValidation submitSuccess 回调中。

您不需要在表单上绑定“提交”或“点击”之类的触发器，因为 jqBootstrapValidation 将处理提交事件。

以下代码是不言自明的：

```
$(function() {

  $('form[name="contact"]').find('input,select,textarea').not('[type=submit]').jqBootstrapValidation({

    submitSuccess: function ($form, event) {

      $.ajax({
        type: 'POST',
        url: $form.attr('action'),
        data: $form.serialize(),
        success: function(data)
        { 
          // just to confirm ajax submission
          console.log('submitted successfully!');
        }
      });

      // will not trigger the default submission in favor of the ajax function
      event.preventDefault();
    }

  });

}); 
```

有关插件的更多详细信息： [http ://reactiveraven.github.io/jqBootstrapValidation/](http://reactiveraven.github.io/jqBootstrapValidation/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-30T07:48:35.993

您必须执行以下操作：

```
$(function () { $("input,select,textarea").not("[type=submit]").jqBootstrapValidation({

    preventSubmit: false,
     submitSuccess: function (form, event) {
         event.preventDefault();
         dosubmit(form);
     },
     submitError: function (form, event, errors) {
         event.preventDefault();
         }
    }); } ); 
```

# .htaccess - Codeigniter 和 Backbone.js 的路由问题

> ID：15617590
> 
> 赞同：5
> 
> 时间：2013-03-25T14:35:25.253
> 
> 标签：.htaccess, backbone.js, requirejs, codeigniter-2

**以下是我正在使用的框架：**

*   代码点火器
*   Codeigniter REST API
*   需要.js
*   骨干网.js

**运行应用程序：**

*   htaccess 文件通过 Codeigniter index.php 文件重定向所有内容。
*   Codeigniter 中有一个默认路由设置来调用“开始”控制器。
*   Start Controller 调用 Start View（Codeigniter 中的唯一视图）。
*   Start View 保存整个网站的模板并调用启动 Require.js
*   Require.js 启动 Backbone，应用程序按预期工作。

**问题：路由到其他主干视图：**

*   现在我想通过主干路由到其他主干“视图”。
*   问题是当我尝试在 HREF 中提供类似“localhost/otherPage”的链接时，htaccess 文件会触发，并且 Codeigniter 尝试找到该控制器，我得到了 Codeigniter 生成的 404。
*   我尝试使用`app.navigate("otherPage", {trigger: true});`在Backbone中强制路由而不是HREF，但我得到了由Codeigniter生成的相同404错误。

**我应该采取什么方向：**

*   我想继续使用 Codeigniter 的 RESTFUL API、模型和一些特殊的验证功能。
*   我还想在前端使用 Backbone 和 Require。
*   我可以将 htacess 重定向更改为启动 Require 和 Backbone 的 index.html 文件吗？如果我使用这种方法，Codeigniter RESTFUL API 控制器是否仍能正常触发？
*   我是否在 Codeigniter 中为每个页面创建一个视图并让每个页面开始 Require + Backbone 为每个视图创建一个新视图？
*   我很快就会研究 Node.js。我是否应该直接丢弃框架的 Codeigniter 方面并全力以赴地使用 Node.js？

非常感谢任何指导。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-28T16:32:54.400

如果您还没有这样做，您可能希望通过 Backbone 通过主题标签更改进行路由（这是他的正常行为，pushState：false），因为修改主题标签绝不会导致服务器调用，从而忽略 Codeigniter 的路由器。
在您的示例中，您希望导航到*localhost/#otherPage*。
然后使用 Codeigniter 的路由器进行 ajax REST 调用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-03T14:29:51.690

阻止浏览器使用 HREF 链接提交 http 请求的另一种方法是使用 javascript 和 jquery 覆盖它。如果您不想像 Loamhoof 建议的那样总是使用主题标签，这可能会很有用。

例子：

```
$('#linkID').on('click', function(event) {

    event.preventDefault();

    backboneRouter.navigate($(event.currentTarget).attr('href'), { trigger:true });

}); 
```

# haskell - GHC 中的变量名有长度限制吗？

> ID：15617592
> 
> 赞同：4
> 
> 时间：2013-03-25T14:35:27.827
> 
> 标签：haskell, ghc

我研究了 Haskell 的标准。他们声明变量名称没有长度限制。这是如何在 GHC 中实现的？变量名有长度限制吗？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2013-03-25T14:51:39.063

GHC 实现中没有硬性长度限制。

# django - Django REST框架中的分页关系？

> ID：15617595
> 
> 赞同：18
> 
> 时间：2013-03-25T14:35:44.640
> 
> 标签：django, api, pagination, django-rest-framework, django-pagination

我们正在为我们的 API 使用 Django REST 框架，并且我们需要对返回多个项目的关系字段进行分页。

演示使用类似于[文档](http://django-rest-framework.org/api-guide/relations.html)中的示例：

```
class TrackSerializer(serializers.ModelSerializer):
    class Meta:
        model = Track
        fields = ('order', 'title')

class AlbumSerializer(serializers.ModelSerializer):
    tracks = TrackSerializer(many=True)

    class Meta:
        model = Album
        fields = ('album_name', 'artist', 'tracks') 
```

专辑的示例序列化输出：

```
{
    'album_name': 'The Grey Album',
    'artist': 'Danger Mouse'
    'tracks': [
        {'order': 1, 'title': 'Public Service Annoucement'},
        {'order': 2, 'title': 'What More Can I Say'},
        {'order': 3, 'title': 'Encore'},
        ...
    ],
} 
```

如果专辑中有数百首曲目，这将成为问题。在这种情况下，有没有办法对“曲目”进行分页？

理想情况下，我知道在这种情况下，“曲目”可能应该指向一个 API URL，该 URL 只返回特定专辑的曲目 - 这反过来又可以轻松分页。这种方法的缺点是即使是前几首曲目也需要额外的请求（以及因此的延迟等）。在我们的例子中，重要的是我们能够通过对专辑 API 的单个请求获得至少一些曲目，然后在需要时动态加载其余曲目。

DRF 是否为此提供任何特定功能或模式？或者有什么变通办法吗？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2014-05-08T12:21:05.890

从上面汤姆的链接复制的答案，以防未来位腐烂：

```
class TrackSerializer(serializers.ModelSerializer):
    class Meta:
        model = Track
        fields = ('order', 'title')

class PaginatedTrackSerializer(pagination.PaginationSerializer):
    class Meta:
        object_serializer_class = TrackSerializer

class AlbumSerializer(serializers.ModelSerializer):

    tracks = serializers.SerializerMethodField('paginated_tracks')

    class Meta:
        model = Album
        fields = ('album_name', 'artist', 'tracks')

    def paginated_tracks(self, obj):
        paginator = Paginator(obj.tracks.all(), 10)
        tracks = paginator.page(1)

        serializer = PaginatedTrackSerializer(tracks)
        return serializer.data 
```

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2015-12-23T18:07:13.143

由于 DRF 3.1，`PaginationSerializer`不支持。这是解决方案。

* * *

*设置.py*

```
REST_FRAMEWORK = {
    'DEFAULT_PAGINATION_CLASS': 'rest_framework.pagination.PageNumberPagination',
    'PAGE_SIZE': 5
} 
```

* * *

*序列化程序.py*

```
from myapp.models import Album, Track
from rest_framework import pagination, serializers

class AlbumSerializer(serializers.HyperlinkedModelSerializer):
    tracks = serializers.SerializerMethodField('paginated_tracks')

    class Meta:
        model = Album

    def paginated_tracks(self, obj):
        tracks = Track.objects.filter(album=obj)
        paginator = pagination.PageNumberPagination()
        page = paginator.paginate_queryset(tracks, self.context['request'])
        serializer = TrackSerializer(page, many=True, context={'request': self.context['request']})
        return serializer.data

class TrackSerializer(serializers.HyperlinkedModelSerializer):
    class Meta:
        model = Track 
```

或者你可以`def paginated_tracks`代替

```
from rest_framework.settings import api_settings

    def get_paginated_tracks(self, obj):
        tracks = Track.objects.filter(album=obj)[:api_settings.PAGE_SIZE]
        serializer = TrackSerializer(tracks, many=True, context={'request': self.context['request']})
        return serializer.data 
```

它甚至需要比上面少一个查询。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2017-01-11T12:54:48.260

Malcolm Box 和 Deepak Prakash 的方法可以帮助序列化关系对象，但正如 @eugene 之前所说，它只适用于单个 Alum。对于相册，我们可以这样做：

*序列化程序.py*

```
class TrackSerializer(serializers.ModelSerializer):
    class Meta:
        model = Track
        fields = ('order', 'title')

class AlbumSerializer(serializers.ModelSerializer):
    tracks = TrackSerializer(many=True)

    class Meta:
        model = Album
        fields = ('album_name', 'artist', 'tracks')
        depth=1 
```

*api.py*

```
class getAPIView(generics.ListAPIView):
    serializer_class=TrackSerializer
    filter_backends = (filters.OrderingFilter,)
    def get_queryset(self):
        queryset=Track.objects.all()
        return queryset
    def list(self, request, *args, **kwargs):
        queryset = self.filter_queryset(self.get_queryset())
        page = self.paginate_queryset(queryset)
        serializer = self.get_serializer(page, many=True)
        data=serializer.data
        albums=Album.objects.values_list('album_name').all()
        trackObjs=[]
        albumObjs=[]
        self.categoryKeyList(albums,albumObjs)
        if page is not None:
            for p in page:
                for n,i in enumerate(albums):
                     if re.search(str(p.alum),str(i)):
                        albumObjs[n]['track'].append(p)
        data={}
        data['count']=self.get_paginated_response(self).data['count']
        data['next']=self.get_paginated_response(self).data['next']
        data['previous']=self.get_paginated_response(self).data['previous']
        data['pageNumber'] = self.paginator.page.number
        data['countPage'] = self.paginator.page.paginator._count
        serializer=ClientsCategorySerializer(categoryObjs,many=True)
        data['result']=serializer.data
        return Response({'data':data,'success':'1','detail':u'获得客户列表成功'})
    def categoryKeyList(self,albums,albumObjs):
        for i in albums:
            albumObjs={}
            albumObjs['album_name']=i[0]
            track=[]
            albumObj['track']=track
            albumObjs.append(albumObj) 
```

然后你可能会得到回应：

```
{
    data[
     {
          'album_name': 'The Grey Album',
          'tracks': [
                   {'order': 1, 'title': 'Public Service Annoucement'},
                   {'order': 2, 'title': 'What More Can I Say'},
                   {'order': 3, 'title': 'Encore'},
                      ...

      },
      {'album_name': 'The John Album',
          'tracks': [
                   {'order': 1, 'title': 'Public Annoucement'},
                   {'order': 2, 'title': 'What sd Can I Say'},
                   {'order': 3, 'title': 'sd'},
                      ...
},
 ......
} 
```

# javascript - 如何在 WebStorm 中查看从 typescript 生成的 javascript？

> ID：15617596
> 
> 赞同：1
> 
> 时间：2013-03-25T14:35:44.977
> 
> 标签：javascript, typescript, webstorm

据我了解，打字稿被转换为javascript。我在 webstorm 项目中有一个文件 MyTypeScript.ts。我希望能够看到我生成的 javascript。我如何在 Webstorm 中做到这一点？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-25T22:37:03.270

设置一个[文件观察器](http://blog.jetbrains.com/webide/2013/03/file-watchers-in-webstormphpstorm-6-a-k-a-background-tasks/)，您将在项目视图中看到`.ts`和文件。`.js`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-25T22:43:20.117

如果您还没有安装 TypeScript，请使用 npm 安装：`npm install -g typescript`

完成后，进入 WebStorm 首选项，导航到 File Watchers 并设置一个新的 TypeScript watch。程序字段是您安装的 TypeScript 的路径。

# css - 有没有办法强制长线在所有电子阅读器中换行

> ID：15617599
> 
> 赞同：0
> 
> 时间：2013-03-25T14:35:48.313
> 
> 标签：css, epub, ibooks

我有这个用 indesign 制作的 epub。正文流动得很好，并按照预期的方式换行。

问题出在脚注上。长脚注不会换行，但会延伸到屏幕右侧。它确实包含在 iBooks 中，但不包含在 Adob​​e Digital Editions 或 Bluefire 阅读器中。

有没有办法通过css强制换行长行？

以下是其中一个 xhtml 文件的链接：http: [//dl.dropbox.com/u/22417556/text.xhtml](http://dl.dropbox.com/u/22417556/text.xhtml)

这里是css的链接：http: [//dl.dropbox.com/u/22417556/styling.css](http://dl.dropbox.com/u/22417556/styling.css) （indesign在这里做了很多额外的垃圾，所以也许这就是问题所在。）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-26T11:13:05.127

好的，我刚刚找到~~了~~ **解决**方案！我的“a”标签的样式是“white-space: pre;” 当我注释掉那行时，我得到了脚注，因为它们应该是这样的。现在我只是想知道删除该行是否会导致其他行为异常。

编辑：将其从 pre 更改为 pre-wrap。它也有效。

# c# - 获取字典中值的实例数

> ID：15617607
> 
> 赞同：0
> 
> 时间：2013-03-25T14:36:18.527
> 
> 标签：c#, lambda

如何在包含带有 lambda 表达式的字符串列表的字典中获取值的实例数？

```
private Dictionary<string, List<string>> dict = new Dictionary<string, List<string>>(); 
```

以下需要改进以消除错误；基本上无法将字符串与字符串列表进行比较。

```
int count = dict.Values.Count(v => v == "specific value"); 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-25T14:38:23.380

使用 linq 吗？当然。

```
 dict.Values.SelectMany( v => v).Where( v => v == "specific value").Count(); 
```

IE：

```
dict.Values.SelectMany( v => v).Count(  v => v == "specific value" ); 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-03-25T14:43:34.280

我会使用这个版本：

```
int count = dict.Count(kvp => kvp.Value.Contains("specific value")); 
```

[编辑] 好的，这里有一些比较`Contains()`方法和`SelectMany()`方法的结果（x86 发布版本）：

n1 = 10000，n2 = 50000：

```
Contains() took: 00:00:04.2299671
SelectMany() took: 00:00:13.0385700
Contains() took: 00:00:04.1634190
SelectMany() took: 00:00:12.9052739
Contains() took: 00:00:04.1605812
SelectMany() took: 00:00:12.8953210
Contains() took: 00:00:04.1356058
SelectMany() took: 00:00:12.9109115 
```

n1 = 20000，n2 = 100000：

```
Contains() took: 00:00:16.7422573
SelectMany() took: 00:00:52.1070692
Contains() took: 00:00:16.7206587
SelectMany() took: 00:00:52.1910468
Contains() took: 00:00:16.6064611
SelectMany() took: 00:00:52.1961513
Contains() took: 00:00:16.6167020
SelectMany() took: 00:00:54.5120003 
```

对于第二组结果，我将 n1 和 n2 都翻了一番，这导致字符串总数增加了四倍。

两种算法的时间都增加了 4 倍，这表明它们都是 O(N)，其中 N 是字符串的总数。

和代码：

```
using System;
using System.Diagnostics;
using System.Linq;
using System.Collections.Generic;

namespace Demo
{
    public static class Program
    {
        [STAThread]
        public static void Main(string[] args)
        {
            var dict = new Dictionary<string, List<string>>();
            var strings = new List<string>();

            int n1 = 10000;
            int n2 = 50000;

            for (int i = 0; i < n1; ++i)
                strings.Add("TEST");

            for (int i = 0; i < n2; ++i)
                dict.Add(i.ToString(), strings);

            for (int i = 0; i < 4; ++i)
            {
                var sw = Stopwatch.StartNew();
                dict.Count(kvp => kvp.Value.Contains("specific value"));
                Console.WriteLine("Contains() took: " + sw.Elapsed);

                sw.Restart();
                dict.Values.SelectMany(v => v).Count(v => v == "specific value");
                Console.WriteLine("SelectMany() took: " + sw.Elapsed);
            }
        }
    }
} 
```

# android - Android 模拟器上的 Mockito

> ID：15617610
> 
> 赞同：4
> 
> 时间：2013-03-25T14:36:35.160
> 
> 标签：android, testing, mockito, dalvik, dex

Android 新手在这里尝试在 Android 中使用我最喜欢的 Java 测试工具。我正在尝试使用以下博客文章中概述的 Mockito 1.9.5，但无法在我的模拟器上运行测试（我目前没有物理设备可以测试）。

Mockit-Android 教程： http: [//www.paulbutcher.com/2012/05/mockito-on-android-step-by-step/](http://www.paulbutcher.com/2012/05/mockito-on-android-step-by-step/)

![在此处输入图像描述](../Images/0167201fc911fb7a1635f1d9a9cb98d2.png)

我能够毫无问题地执行所有正常的 Junit 测试，但是我利用 Mockito 进行的任何测试都收到以下信息：

```
Can't open dex cache '/data/dalvik-cache/data@data@com.trendium.peg@cache@Generated-621101.jar@classes.dex': No such file or directory
Unable to open or create cache for /data/data/com.trendium.peg/cache/Generated-621101.jar (/data/dalvik-cache/data@data@com.trendium.peg@cache@Generated-621101.jar@classes.dex)
failed: testStartable(com.trendium.peg.services.RatingServiceTest)
java.lang.AssertionError: java.lang.ClassNotFoundException: RemoteRestTask_Proxy in loader dalvik.system.DexClassLoader@40a4b610 
```

我已经对这些异常进行了大量的谷歌搜索，重建了我的模拟器，重建了项目，以及许多其他各种想法，但没有任何运气来解决这个问题。

旁注：我的目标是 SDK 11 及更高版本，怀疑这会产生影响，但值得注意。我现有的不利用 Mockito 的单元测试在相同的测试运行中运行没有问题（28/28 运行，7 次失败）。

对 LogCat 的进一步分析表明，mockito cglib 显然不在类路径中，但是我现在不确定下一步：

```
03-25 09:10:42.990: W/dalvikvm(411): Unable to resolve superclass of Lorg/mockito/cglib/transform/AbstractProcessTask; (637)
03-25 09:10:43.000: W/dalvikvm(411): Link of class 'Lorg/mockito/cglib/transform/AbstractProcessTask;' failed
03-25 09:10:43.029: D/dalvikvm(411): GC_CONCURRENT freed 618K, 9% free 9226K/10055K, paused 4ms+6ms
03-25 09:10:43.040: W/ClassPathPackageInfoSource(411): Cannot load class. Make sure it is in your apk. Class name: 'org.mockito.cglib.transform.AbstractProcessTask'. Message: org.mockito.cglib.transform.AbstractProcessTask
03-25 09:10:43.040: W/ClassPathPackageInfoSource(411): java.lang.ClassNotFoundException: org.mockito.cglib.transform.AbstractProcessTask
03-25 09:10:43.040: W/ClassPathPackageInfoSource(411):  at java.lang.Class.classForName(Native Method)
03-25 09:10:43.040: W/ClassPathPackageInfoSource(411):  at java.lang.Class.forName(Class.java:234)
03-25 09:10:43.040: W/ClassPathPackageInfoSource(411):  at android.test.ClassPathPackageInfoSource.createPackageInfo(ClassPathPackageInfoSource.java:89)
03-25 09:10:43.040: W/ClassPathPackageInfoSource(411):  at android.test.ClassPathPackageInfoSource.access$000(ClassPathPackageInfoSource.java:40)
03-25 09:10:43.040: W/ClassPathPackageInfoSource(411):  at android.test.ClassPathPackageInfoSource$1.load(ClassPathPackageInfoSource.java:51)
03-25 09:10:43.040: W/ClassPathPackageInfoSource(411):  at android.test.ClassPathPackageInfoSource$1.load(ClassPathPackageInfoSource.java:48)
03-25 09:10:43.040: W/ClassPathPackageInfoSource(411):  at android.test.SimpleCache.get(SimpleCache.java:31)
03-25 09:10:43.040: W/ClassPathPackageInfoSource(411):  at android.test.ClassPathPackageInfoSource.getPackageInfo(ClassPathPackageInfoSource.java:73)
03-25 09:10:43.040: W/ClassPathPackageInfoSource(411):  at android.test.ClassPathPackageInfo.getSubpackages(ClassPathPackageInfo.java:48)
03-25 09:10:43.040: W/ClassPathPackageInfoSource(411):  at android.test.ClassPathPackageInfo.addTopLevelClassesTo(ClassPathPackageInfo.java:61)
03-25 09:10:43.040: W/ClassPathPackageInfoSource(411):  at android.test.ClassPathPackageInfo.getTopLevelClassesRecursive(ClassPathPackageInfo.java:55)
03-25 09:10:43.040: W/ClassPathPackageInfoSource(411):  at android.test.suitebuilder.TestGrouping.testCaseClassesInPackage(TestGrouping.java:156)
03-25 09:10:43.040: W/ClassPathPackageInfoSource(411):  at android.test.suitebuilder.TestGrouping.addPackagesRecursive(TestGrouping.java:117)
03-25 09:10:43.040: W/ClassPathPackageInfoSource(411):  at android.test.suitebuilder.TestSuiteBuilder.includePackages(TestSuiteBuilder.java:102)
03-25 09:10:43.040: W/ClassPathPackageInfoSource(411):  at android.test.InstrumentationTestRunner.onCreate(InstrumentationTestRunner.java:356)
03-25 09:10:43.040: W/ClassPathPackageInfoSource(411):  at android.app.ActivityThread.handleBindApplication(ActivityThread.java:3550)
03-25 09:10:43.040: W/ClassPathPackageInfoSource(411):  at android.app.ActivityThread.access$2200(ActivityThread.java:123)
03-25 09:10:43.040: W/ClassPathPackageInfoSource(411):  at android.app.ActivityThread$H.handleMessage(ActivityThread.java:1031)
03-25 09:10:43.040: W/ClassPathPackageInfoSource(411):  at android.os.Handler.dispatchMessage(Handler.java:99)
03-25 09:10:43.040: W/ClassPathPackageInfoSource(411):  at android.os.Looper.loop(Looper.java:126)
03-25 09:10:43.040: W/ClassPathPackageInfoSource(411):  at android.app.ActivityThread.main(ActivityThread.java:3997)
03-25 09:10:43.040: W/ClassPathPackageInfoSource(411):  at java.lang.reflect.Method.invokeNative(Native Method)
03-25 09:10:43.040: W/ClassPathPackageInfoSource(411):  at java.lang.reflect.Method.invoke(Method.java:491)
03-25 09:10:43.040: W/ClassPathPackageInfoSource(411):  at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:841)
03-25 09:10:43.040: W/ClassPathPackageInfoSource(411):  at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:599)
03-25 09:10:43.040: W/ClassPathPackageInfoSource(411):  at dalvik.system.NativeStart.main(Native Method)
03-25 09:10:43.040: W/ClassPathPackageInfoSource(411): Caused by: java.lang.NoClassDefFoundError: org.mockito.cglib.transform.AbstractProcessTask
03-25 09:10:43.040: W/ClassPathPackageInfoSource(411):  ... 26 more
03-25 09:10:43.040: W/ClassPathPackageInfoSource(411): Caused by: java.lang.ClassNotFoundException: org.mockito.cglib.transform.AbstractProcessTask in loader dalvik.system.PathClassLoader[/system/framework/android.test.runner.jar:/data/app/com.example.mine.test-1.apk:/data/app/com.example.mine-1.apk]
03-25 09:10:43.040: W/ClassPathPackageInfoSource(411):  at dalvik.system.PathClassLoader.findClass(PathClassLoader.java:251)
03-25 09:10:43.040: W/ClassPathPackageInfoSource(411):  at java.lang.ClassLoader.loadClass(ClassLoader.java:548)
03-25 09:10:43.040: W/ClassPathPackageInfoSource(411):  at java.lang.ClassLoader.loadClass(ClassLoader.java:508)
03-25 09:10:43.040: W/ClassPathPackageInfoSource(411):  ... 26 more 
```

基于此错误消息，我查看了 Mockito 源并注意到它正在使用 Ant 的任务。但是，我不认为 Ant 是 Mockito 的依赖项......

[https://fisheye2.atlassian.com/browse/mockito/trunk/cglib-and-asm/src/org/mockito/cglib/transform/AbstractProcessTask.java?r=1430](https://fisheye2.atlassian.com/browse/mockito/trunk/cglib-and-asm/src/org/mockito/cglib/transform/AbstractProcessTask.java?r=1430)

进一步调试，我再次被以下内容阻止：

```
03-25 15:07:01.726: I/dalvikvm(703): Failed resolving Lorg/junit/internal/AssumptionViolatedException; interface 693 'Lorg/hamcrest/SelfDescribing;'
03-25 15:07:01.726: W/dalvikvm(703): Link of class 'Lorg/junit/internal/AssumptionViolatedException;' failed
03-25 15:07:01.746: W/ClassPathPackageInfoSource(703): Cannot load class. Make sure it is in your apk. Class name: 'org.junit.internal.AssumptionViolatedException'. Message: org.junit.internal.AssumptionViolatedException
03-25 15:07:01.746: W/ClassPathPackageInfoSource(703): java.lang.ClassNotFoundException: org.junit.internal.AssumptionViolatedException
03-25 15:07:01.746: W/ClassPathPackageInfoSource(703):  at java.lang.Class.classForName(Native Method)
03-25 15:07:01.746: W/ClassPathPackageInfoSource(703):  at java.lang.Class.forName(Class.java:234)
03-25 15:07:01.746: W/ClassPathPackageInfoSource(703):  at android.test.ClassPathPackageInfoSource.createPackageInfo(ClassPathPackageInfoSource.java:89)
03-25 15:07:01.746: W/ClassPathPackageInfoSource(703):  at android.test.ClassPathPackageInfoSource.access$000(ClassPathPackageInfoSource.java:40)
03-25 15:07:01.746: W/ClassPathPackageInfoSource(703):  at android.test.ClassPathPackageInfoSource$1.load(ClassPathPackageInfoSource.java:51)
03-25 15:07:01.746: W/ClassPathPackageInfoSource(703):  at android.test.ClassPathPackageInfoSource$1.load(ClassPathPackageInfoSource.java:48)
03-25 15:07:01.746: W/ClassPathPackageInfoSource(703):  at android.test.SimpleCache.get(SimpleCache.java:31)
03-25 15:07:01.746: W/ClassPathPackageInfoSource(703):  at android.test.ClassPathPackageInfoSource.getPackageInfo(ClassPathPackageInfoSource.java:73)
03-25 15:07:01.746: W/ClassPathPackageInfoSource(703):  at android.test.ClassPathPackageInfo.getSubpackages(ClassPathPackageInfo.java:48)
03-25 15:07:01.746: W/ClassPathPackageInfoSource(703):  at android.test.ClassPathPackageInfo.addTopLevelClassesTo(ClassPathPackageInfo.java:61)
03-25 15:07:01.746: W/ClassPathPackageInfoSource(703):  at android.test.ClassPathPackageInfo.getTopLevelClassesRecursive(ClassPathPackageInfo.java:55)
03-25 15:07:01.746: W/ClassPathPackageInfoSource(703):  at android.test.suitebuilder.TestGrouping.testCaseClassesInPackage(TestGrouping.java:156)
03-25 15:07:01.746: W/ClassPathPackageInfoSource(703):  at android.test.suitebuilder.TestGrouping.addPackagesRecursive(TestGrouping.java:117)
03-25 15:07:01.746: W/ClassPathPackageInfoSource(703):  at android.test.suitebuilder.TestSuiteBuilder.includePackages(TestSuiteBuilder.java:102)
03-25 15:07:01.746: W/ClassPathPackageInfoSource(703):  at android.test.InstrumentationTestRunner.onCreate(InstrumentationTestRunner.java:356)
03-25 15:07:01.746: W/ClassPathPackageInfoSource(703):  at android.app.ActivityThread.handleBindApplication(ActivityThread.java:3550)
03-25 15:07:01.746: W/ClassPathPackageInfoSource(703):  at android.app.ActivityThread.access$2200(ActivityThread.java:123)
03-25 15:07:01.746: W/ClassPathPackageInfoSource(703):  at android.app.ActivityThread$H.handleMessage(ActivityThread.java:1031)
03-25 15:07:01.746: W/ClassPathPackageInfoSource(703):  at android.os.Handler.dispatchMessage(Handler.java:99)
03-25 15:07:01.746: W/ClassPathPackageInfoSource(703):  at android.os.Looper.loop(Looper.java:126)
03-25 15:07:01.746: W/ClassPathPackageInfoSource(703):  at android.app.ActivityThread.main(ActivityThread.java:3997)
03-25 15:07:01.746: W/ClassPathPackageInfoSource(703):  at java.lang.reflect.Method.invokeNative(Native Method)
03-25 15:07:01.746: W/ClassPathPackageInfoSource(703):  at java.lang.reflect.Method.invoke(Method.java:491)
03-25 15:07:01.746: W/ClassPathPackageInfoSource(703):  at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:841)
03-25 15:07:01.746: W/ClassPathPackageInfoSource(703):  at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:599)
03-25 15:07:01.746: W/ClassPathPackageInfoSource(703):  at dalvik.system.NativeStart.main(Native Method)
03-25 15:07:01.746: W/ClassPathPackageInfoSource(703): Caused by: java.lang.NoClassDefFoundError: org.junit.internal.AssumptionViolatedException
03-25 15:07:01.746: W/ClassPathPackageInfoSource(703):  ... 26 more 
```

这表明 hamcrst-core jar 不在类路径中，但是我已将其正确添加到测试项目的 libs 目录中：

![在此处输入图像描述](../Images/3f92e7a5817b10948fcd0acf2d8fea5a.png)

[https://github.com/junit-team/junit/blob/r4.11/src/main/java/org/junit/internal/AssumptionViolatedException.java](https://github.com/junit-team/junit/blob/r4.11/src/main/java/org/junit/internal/AssumptionViolatedException.java)

请注意，关于 Mockito 1.9.5，我正在为 Junit-4.11 使用正确的（根据我的理解）jar。 [https://code.google.com/p/mockito/wiki/DeclaringMockitoDependency](https://code.google.com/p/mockito/wiki/DeclaringMockitoDependency)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-10-30T09:05:39.450

当我在没有模拟它们的情况下调用本机 API 时，我遇到了同样的问题——确保你有本机调用的模拟。还要检查链接错误，而不仅仅是 Mockito 异常。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-01-16T04:15:06.590

此问题可能是由于您的实际 android 设备上没有这些库，即使您可能已将它们添加到 Eclipse 或 Android Studio。

在我的 android 测试项目中，我能够通过创建一个 libs 文件夹并将三个所需的库放入其中来解决此问题。确保您创建的文件夹的名称实际上是“libs”而不是“lib”

这是来自 android 开发者网站的链接，其中包含有关添加支持库的更详细说明。 [http://developer.android.com/tools/support-library/setup.html](http://developer.android.com/tools/support-library/setup.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-25T15:24:11.390

您必须确保 Mockito 的 JAR 是您的 APK 依赖项的一部分。

如果您使用 Intellij，请打开项目设置和 Module->Dependencies，并将 Mockito 添加为依赖项的一部分。

如果您正在使用混淆，您还必须确保它不会从您构建的 apk 中混淆 mockito 的类。

# html - 在表单中放置下拉选择菜单

> ID：15617611
> 
> 赞同：0
> 
> 时间：2013-03-25T14:36:36.237
> 
> 标签：html

我正在构建一个包含多个字段的表单，并将其放置在表格中以便于阅读。我想在表单内有一个下拉菜单，但是使用“选择/选项”标签，我总是在整个表单之前或之后都有下拉菜单。我能怎么做？这里有一个例子：

```
 document.write('name "Addrow" <form action="xxxxxx.php?Mode=ADD" method="POST" enctype="multipart/form-data">')
    document.write('<table width="900"><th width="250"></th><th width="650"></th>')
    document.write('<TR>')
    document.write('<TD>Codice evento:</td>')
    document.write('<TD><input type="text" name="ID_evcls" maxlength="10" size="10"></td>')
    document.write('</TR>')
    document.write('<TR>')
    document.write('<TD>Tipo evento:</td>')
    document.write('<TD><input type="text" name="ID_tipoev" maxlength="5" size="10"></td>')
    document.write('</TR>')
    document.write('<TR>')
    document.write('<TR>')
    document.write('<TD>Titolo:</td>')
    document.write('<TD><input type="text" name="TitEv" maxlength="35" size="35"></td>')
    document.write('</TR>')
    document.write('<TR>')
    document.write('<TR>')
    document.write('<TD>Descrizione:</td>')
    document.write('<TD><input type="text" name="Descr" maxlength="150" size="75"></td>')
    document.write('</TR>')
    document.write('<TR>')
    document.write('<TR>')
    document.write('<TD>Data manifestazione:</td>')
    document.write('<TD><input type="date" name="DataEv"></td>')
    document.write('</TR>')
    document.write('<TR>')
    document.write('<TR>')
    document.write('<TD>Luogo manifestazione:</td>')
    document.write('<TD><input type="text" name="PlacEv" maxlength="25" size="25"></td>')
    document.write('</TR>')
    document.write('<TR>')
    document.write('<TR>')
    document.write('<TD>Nazione:</td>')
    document.write('<TD><input type="text" name="NatEv" maxlength="3" size="3" value="ITA"></td>')
    document.write('</TR>')
    document.write('<TR>')
    document.write('<TD>Immagine da utilizzare (JPEG):</td>')
    document.write('<TD><input type="file" name="userfile"accept="image/jpeg"></td>')
    document.write('</TR>')
    document.write('</table>')
    fn_buildchooseeventclass()
    document.write('<input type="submit" value="Conferma inserimento">')
    document.write('</form>')
}

function fn_buildchooseeventclass() {
    document.write('<select name="carlist" form="Addrow">')
    document.write('<option value="volvo">Volvo</option>')
    document.write('<option value="saab">Saab</option>')
    document.write('<option value="opel">Opel</option>')
    document.write('<option value="audi">Audi</option>')
    document.write('</select>')
}

</script>

</body>
</html> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-25T14:38:29.713

您必须将其插入`<tr><td>`

所以，如果我按照你的风格去做：

```
document.write('<TR>');
document.write('<TD>');
fn_buildchooseeventclass();
document.write('</TD>');
document.write('</TR>');
document.write('</table>'); 
```

编辑：这里是工作示例：http: [//jsbin.com/axuxiz/1/edit](http://jsbin.com/axuxiz/1/edit)

`<table>`一些旁注：使用 a来布局四页被认为是一种不好的布拉德做法。用来`document.write`创建你的用户界面是相当低效的。

# android - Android 下的 Websockets 与 GCM：电池使用情况？

> ID：15617615
> 
> 赞同：19
> 
> 时间：2013-03-25T14:36:53.020
> 
> 标签：android, websocket, battery, google-cloud-messaging

我需要在 Android 应用程序和外部服务器之间维护一个开放的双向通信通道。我知道我可以为此使用 GCM，但由于与 Android 本身无关的各种原因，如果可能的话，我想使用 websockets。

谁能指出我在使用 GCM 与 Android 下基于 java 的 websockets 客户端时的资源/电池使用统计数据的比较？

提前致谢。

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2013-03-25T14:57:57.597

由于多个应用程序使用 GCM，它使用单个套接字连接到 Google 云，因此让您的应用程序使用 GCM 进行通知根本不会影响电池寿命，因为它只使用现有连接。另一方面，无论您使用 websockets 创建什么进程，电池使用量都将添加到 GCM 之上。

此外，如果即使应用程序不在前台也需要保持连接，则有必要将应用程序创建为前台服务。GCM 会为您处理这个问题。

**更新**
没有使用 GCM 的其他应用程序的设备是非常罕见的情况，因为 gmail 等许多基本应用程序都使用 GCM。我没有 GCM 电池使用量的确切数字。[但是这个视频](https://www.youtube.com/watch?v=PLM4LajwDVc)大约 4 分钟内提到了 C2DM（GCM 的前身，它使用相同的底层通信模型）的电池使用情况。我实际上有一个类似的问题，关于持久套接字连接到外部服务器的电池使用情况（[Android 持久套接字连接规则](https://stackoverflow.com/questions/15254146/android-persistent-socket-connection-rules)）。虽然它不是 websocket，但我会认为电池使用情况相似。但同样，由于 GCM 内置于操作系统的低得多的级别，我将其想象为比自定义解决方案更优化。

除非您有一些反对使用第三方服务器的公司政策或一些非常具体的规范，否则我建议您使用 GCM。我还鼓励观看有关 C2DM 的整个视频以及[GCM 的此视频](http://www.youtube.com/watch?v=YoaP6hcDctM)。

# c# - 如何序列化 System.Timers.Timer

> ID：15617617
> 
> 赞同：2
> 
> 时间：2013-03-25T14:36:56.223
> 
> 标签：c#, serialization

有什么办法可以`System.Timers.Timer`序列化

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-25T14:44:48.527

我在[Timer](http://msdn.microsoft.com/en-us/library/system.timers.timer.aspx)类中看不到任何[Serializable](http://msdn.microsoft.com/en-us/library/system.serializableattribute%28v=vs.71%29.aspx)属性。

但是你可以像这样上课（好教程'[序列化（C#和Visual Basic）](http://msdn.microsoft.com/en-us/library/vstudio/ms233843.aspx) '）：

```
[Serializable]
public class CoolTimerWhatIWantToSerializeButForWhat
{
    public double LocalInterval { get; set; }

    public void SaveSomePropertiesOfTimer(System.Timers.Timer iWannaIt)
    {
        //save to local properties properties of iWannaIt

        LocalInterval = iWannaIt.Interval;
    }

    public System.Timers.Timer GetItBackNOW()
    {
        return new System.Timers.Timer(LocalInterval);
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-25T14:42:35.823

类 Timer 未公开为“可序列化”。

一种选择是将对象标记为`[NonSerialized].`

# javascript - 在您键入时或输入失去焦点时将输入值保存到变量中

> ID：15617618
> 
> 赞同：0
> 
> 时间：2013-03-25T14:36:56.437
> 
> 标签：javascript, input, var

我一直在研究这个问题一段时间，我提出的每个解决方案“几乎都有效”。理想情况下，我想在输入时将输入值保存到变量中，因此在将输入值保存到变量之前我不必执行任何命令。由于我无法找到解决方案，因此我一直在努力在输入失去焦点后立即对其进行更改。我尝试过 .focusout、.change 和 .blur，但在输入失去焦点的那一刻，没有一个真正改变它。

```
//This will save the input value into the variable formInput
var formInput = $("#someForm input[type=text]").val();

//This successfully changes the value of formInput, but only after performing 
//another command, such as clicking go or pressing enter.  
//Tab does not count to the input "losing focus"

$("#someForm input[type=text]").focusout(function() {
$(this).val() = formInput.val();
});

// Same as focusout, as well as blur.
$("#someForm input[type=text]").change(function() {
$(this).val() = formInput.val();
});

//Nope.
$("#someForm input[type=text]").keyup(function() {
    formInput = $("this").val();
}); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-25T15:07:01.573

尝试

```
var inputText;
$("#someForm input[type=text]").keyup(function() {
    inputText = $(this).val();
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-25T15:18:19.867

在现代浏览器中，[监听`input`事件](http://jsfiddle.net/robertc/3kTYt/)：

```
$("#someForm input[type=text]").on("input", function() {    
    formInput = $(this).val();
}); 
```

但是，`keyup`如果您清除关于`formInput`是包含字段值的字符串值还是链接到字段本身的 jQuery 对象（如果`formInput`是字符串，它将没有`val()`方法）的混淆，处理程序也应该工作。

还有这段代码：

```
$("this") 
```

正在选择所有`<this>`元素，如果返回任何内容，我会感到惊讶。

# sql-server-2008 - 如何找出 SQL Server 上 OLE 提供程序权限的原因？

> ID：15617619
> 
> 赞同：1
> 
> 时间：2013-03-25T14:36:58.597
> 
> 标签：sql-server-2008, tsql, oledb, openrowset

我在 Windows 7 64 位上安装了 Office 2010 64 位。Windows 7 上也安装了 SQL Server 2008。

然后我尝试使用`Microsoft.ACE.OLEDB.12.0`T-SQL 从 excel 文件中访问数据。

我在 SQL Server Mgmt Studio 中使用以下类型的查询尝试 T-SQL：

```
SELECT *
FROM OPENROWSET('Microsoft.ACE.OLEDB.12.0', 'Excel 12.0;Database=C:\Temp\book1.xlsx;', 'SELECT * FROM [Sheet1$]') 
```

如果我使用“以管理员身份运行”启动 SQL Server Mgmt Studio，那就没问题了。我可以从/向 Excel 文件访问/插入数据。

如果我直接启动 Mgmt Studio（使用我的 AD 帐户），我会收到如下错误：

> 链接服务器“（null）”的 OLE DB 提供程序“Microsoft.ACE.OLEDB.12.0”返回消息“未指定错误”。
> 消息 7303，级别 16，状态 1，第 1 行
> 无法为链接服务器“（null）”初始化 OLE DB 提供程序“Microsoft.ACE.OLEDB.12.0”的数据源对象。

但实际上，我的帐户也是一个管理员帐户（它在本地管理员组和 AD 管理员组中）。

因为我需要像`OpenRowSet`在代码中一样运行 T-SQL，所以不知道如何解决这个问题。

在这种情况下，看起来 OpenRowSet 只允许本地管理员运行 MSSM。

我尝试从另一台计算机运行 MSSM，并得到与上述相同的错误。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-26T16:35:39.710

想办法：以 sa 身份登录解决了这个问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-25T15:23:50.710

尝试将您的 Excel 文件放在您的用户帐户无需管理员权限即可访问的位置。

例如，您的用户文件夹将是更好的选择。在没有管理员权限的情况下运行时，Windows 将限制对这些类型的文件夹的访问。

# mysql - Mysql - 从多个表中检索记录的最快方法是什么

> ID：15617620
> 
> 赞同：0
> 
> 时间：2013-03-25T14:37:02.503
> 
> 标签：mysql

示例：我创建表格帖子 -

```
post_id primary key

content varchar 
```

然后我创建表格评论 -

```
comment_id primary key

post_id foreign key reference post(post_id)

content varchar 
```

在 ASP（Active Server Pages）中显示记录

```
query1: select * from post;

Do while NOT RS1.EOF
{
response.write RS1("post_id")
response.write RS1("content")

query2: select * from comment where post_id = RS1("post_id")

Do while NOT RS2.EOF
{
    response.write RS2("comment_id")
    response.write RS2("content")
}
} 
```

第二个查询对表帖子中的每条记录执行表评论中的全扫描，有什么方法可以使评论搜索比上述方法更快？我需要在这种情况下使用索引吗？提前致谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-25T14:38:48.860

将“post_id”的索引添加到“评论”。

您还可以在这两个表之间进行连接，以使用一个查询获取每个帖子的所有评论。如果您有很多帖子，这可能会很昂贵...

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-25T14:38:44.197

`JOIN`桌子，

```
SELECT  a.*, b.*
FROM    post a
        INNER JOIN comment b
            ON a.Post_ID = b.Post_ID
-- WHERE   a.Post_ID = @valueHere       -- <<== if you want to get specific post 
```

要进一步了解有关联接的更多信息，请访问以下链接：

*   [SQL 连接的可视化表示](http://www.codinghorror.com/blog/2007/10/a-visual-explanation-of-sql-joins.html)

# tcp - SCTP 中的多流与在 TCP 中打开多个连接有何不同？

> ID：15617621
> 
> 赞同：2
> 
> 时间：2013-03-25T14:37:05.700
> 
> 标签：tcp, network-protocols, sctp

SCTP 中的多个流如何驻留在单个关联中，而在 TCP 中我们必须涉及多个端口。在 SCTP 中，多流是否也以任何方式涉及端口。[RFC 6525](https://www.rfc-editor.org/rfc/rfc6525)说只有 65k+ 个流是可能的，这似乎等于可能的端口数。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-15T13:34:53.017

使用多个流不需要使用多个端口，SCTP 关联只有一个端口（或一个本地端口和一个远程端口），但可以使用多个流。

使用多个流的目的是不需要按顺序传递的消息可以在不同的流上发送，从而避免不必要的线头阻塞。如果您将 SCTP 用于电信信令，则可以在不同的流上发送独立电话呼叫的消息。特定呼叫的所有消息将按顺序传递，但重新传输一个呼叫的消息不需要延迟另一个呼叫的消息传递。

流的使用允许在不创建新关联的情况下实现这一点，这通常需要大量系统资源用于 tx 和 rx 缓冲区以及关联建立成本。

SCTP 用户选择在哪个流上发送消息，并通过 SCTP API 与 SCTP 通信。

# wcf - 验证跨域 WCF 绑定

> ID：15617622
> 
> 赞同：1
> 
> 时间：2013-03-25T14:37:09.843
> 
> 标签：wcf, wcf-binding, wcf-security

我对 WCF 相当陌生，我需要一些帮助/建议，了解我有哪些选项可用于以下 Web 应用程序设置。

我的 WCF 服务托管在一个 Web 应用程序中，该应用程序本身是使用 IIS 中配置的基本身份验证访问的。

我的客户端位于与正在访问的 Web 应用程序不同的另一个域上。

我的服务在 Web 应用程序中调用的代码检查当前登录用户的授权。

从服务部门拨打以下电话：

```
if (WinPrin.IsInRole(WindowsBuiltInRole.Administrator))
.
.
Create customer
.
. 
```

我的问题是如果我希望能够从我的客户端调用我的服务，我应该如何配置我的绑定。我想传递给我的服务的数据需要加密，这将倾向于 wsHttpBinding，但是我可以将基本的身份验证详细信息发送到我的服务以使用它们来处理请求吗？那可能吗。

我尝试了以下代码，但我的网络应用程序无法选择我传递给它的凭据

客户

```
WSHttpBinding binding = new WSHttpBinding();

 binding.SendTimeout = TimeSpan.FromSeconds(120);
 binding.Security.Mode = SecurityMode.Message;
 binding.Security.Transport.ClientCredentialType = HttpClientCredentialType.Basic;

 EndpointAddress address = new EndpointAddress("url");

 Service1Client service = new Service1Client(binding, address);

 //details for an account on the hosting server domain
 service.ClientCredentials.Windows.ClientCredential.UserName = "username";
 service.ClientCredentials.Windows.ClientCredential.Password = "password";
 service.ClientCredentials.Windows.ClientCredential.Domain = "domain"; 
```

感谢您的任何帮助或建议。

# asp.net-mvc - “System.Web.Mvc.MvcWebRazorHostFactory”类型的表达式不能用于返回类型“System.Web.WebPages.Razor.WebRazorHostFactory”

> ID：15617625
> 
> 赞同：41
> 
> 时间：2013-03-25T14:37:20.037
> 
> 标签：asp.net-mvc, asp.net-mvc-3, asp.net-mvc-4, razor

当我尝试运行我接管的项目时出现此错误。

我假设我的*web.config*有问题，但我不知道要查找什么。

> “System.Web.Mvc.MvcWebRazorHostFactory”类型的表达式不能用于返回类型“System.Web.WebPages.Razor.WebRazorHostFactory”

对此的任何建议都将受到高度赞赏。

* * *

## 回答 #1

> 赞同：50
> 
> 时间：2013-08-06T13:03:22.897

尝试替换 Web.Config 中的行

```
<host factoryType="System.Web.Mvc.MvcWebRazorHostFactory, System.Web.Mvc, Version=3.0.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35" /> 
```

至

```
<host factoryType="System.Web.Mvc.MvcWebRazorHostFactory, System.Web.Mvc, Version=4.0.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35" /> 
```

（将 MvcWebRazorHostFactory 设置为版本 4.0.0.0）

* * *

## 回答 #2

> 赞同：36
> 
> 时间：2013-10-18T01:07:07.370

在 ALL Views/web.config 下将 MvcWebRazorHostFactory 设置为版本**5 .0.0.0**

```
<system.web.webPages.razor>
    <host factoryType="System.Web.Mvc.MvcWebRazorHostFactory, System.Web.Mvc, Version=5.0.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35" /> 
```

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2016-05-25T23:34:25.950

对于其他仍在受苦的人，我的解决方案与上面的解决方案一样，但需要进行一些**调整**- 我需要在项目引用中将工厂类型版本与 System.Web.Mvc dll 的版本相匹配。要找出您拥有的版本：

1.  在您的项目中展开“参考”
2.  右键单击 System.Web.Mvc 并查看版本

    [![在此处输入图像描述](../Images/4905459a4ca298f9e10bdd0871909848.png)](https://i.stack.imgur.com/GV89I.png)

3.  **更新Views 文件夹**中的 web.config

 **所以在我的情况下，如下所示：

```
 <system.web.webPages.razor>
    <host factoryType="System.Web.Mvc.MvcWebRazorHostFactory, System.Web.Mvc, Version=5.2.3.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35" /> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-01-12T00:56:06.527

我得到了同样的错误。什么对我有用：右键单击您的项目并选择管理 NuGet 包。安装 Microsoft ASP.NET Razor。重建项目。**

# html - 水平滚动div并固定div的高度

> ID：15617627
> 
> 赞同：1
> 
> 时间：2013-03-25T14:37:23.610
> 
> 标签：html, css

div中有四个图像，我希望所有图像都可以在同一行滚动，所有图像都不会下拉到另一行，我该怎么做？

```
<style>
.more-product-images {
    height:90px;
    background-color:#000;
    width:1000px;
    overflow:scroll;
    overflow-y:hidden;
}
</style>

<div class="more-product-images">
            <a href="http://localhost/test/sites/default/files/styles/uc_product_full/public/45c857_a12aec4157fe68e01dc1d608627a4734.jpg" title="" rel="lightbox[0]" class="lightbox-processed"><img typeof="foaf:Image" src="http://localhost/test/sites/default/files/styles/uc_thumbnail/public/45c857_a12aec4157fe68e01dc1d608627a4734.jpg" width="120" height="92" alt="" title=""></a>
            <a href="http://localhost/test/sites/default/files/styles/uc_product_full/public/45c857_b6f3583a3718298533f4f1f1ae58b690.jpg" title="" rel="lightbox[0]" class="lightbox-processed"><img typeof="foaf:Image" src="http://localhost/test/sites/default/files/styles/uc_thumbnail/public/45c857_b6f3583a3718298533f4f1f1ae58b690.jpg" width="120" height="92" alt="" title=""></a>
            <a href="http://localhost/test/sites/default/files/styles/uc_product_full/public/45c857_db4093c431282a16ff3e80767b3f8ecc.jpg" title="" rel="lightbox[0]" class="lightbox-processed"><img typeof="foaf:Image" src="http://localhost/test/sites/default/files/styles/uc_thumbnail/public/45c857_db4093c431282a16ff3e80767b3f8ecc.jpg" width="120" height="92" alt="" title=""></a>
            <a href="http://localhost/test/sites/default/files/styles/uc_product_full/public/45c857_df2173694b2e1cc56e443a4103f02ede.jpg" title="" rel="lightbox[0]" class="lightbox-processed"><img typeof="foaf:Image" src="http://localhost/test/sites/default/files/styles/uc_thumbnail/public/45c857_df2173694b2e1cc56e443a4103f02ede.jpg" width="120" height="92" alt="" title=""></a>
</div> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-25T14:42:33.567

这应该这样做：

```
.more-product-images img {
    float: left;
} 
```

但这里有一个更详细的示例：（为了简单起见，我将锚标记设为内联块并删除了图像。

[http://jsfiddle.net/f8Cd3/](http://jsfiddle.net/f8Cd3/)

我还建议从单个图像中删除宽度和高度属性，并简单地通过 css 应用宽度和高度。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-25T15:01:22.263

您应该使用**float: left**并且更好的做法是通过 css 定义大小。

```
.more-product-images img {
     width: 120px;
     height: 92px;
     float: left;
} 
```

*这是[使用 float:left的代码](http://jsfiddle.net/YkRWD/)*

也许您应该考虑在图像之间放置一个边距，例如：**margin-left: 5px**

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-25T14:41:21.130

`float: left;`在`lightbox-processed`课堂内使用。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-25T14:51:43.747

You use the word scroll in title and description. Do you want a carousel effect? Sounds like you're looking for something like this [http://flex.madebymufffin.com/examples/basic-carousel.html](http://flex.madebymufffin.com/examples/basic-carousel.html)

```
<style>
.more-product-images {
height:90px;
background-color:#000;
width:1000px;
overflow:scroll;
overflow-y:hidden;
}

.boxes {width: 25%; display: flex-box;}
 </style>

<div class="more-product-images">
        <a           href="http://localhost/test/sites/default/files/styles/uc_product_full/public/45c857_a12aec4157fe68e01dc1d608627a4734.jpg" title="" rel="lightbox[0]" class="lightbox-processed"><img class="boxes" typeof="foaf:Image" src="http://localhost/test/sites/default/files/styles/uc_thumbnail/public/45c857_a12aec4157fe68e01dc1d608627a4734.jpg" alt="" title=""></a>
        <a href="http://localhost/test/sites/default/files/styles/uc_product_full/public/45c857_b6f3583a3718298533f4f1f1ae58b690.jpg" title="" rel="lightbox[0]" class="lightbox-processed"><img class="boxes" typeof="foaf:Image" src="http://localhost/test/sites/default/files/styles/uc_thumbnail/public/45c857_b6f3583a3718298533f4f1f1ae58b690.jpg" alt="" title=""></a>
        <a     href="http://localhost/test/sites/default/files/styles/uc_product_full/public/45c857_db4093c431282a16ff3e80767b3f8ecc.jpg" title="" rel="lightbox[0]" class="lightbox-processed"><img class="boxes" typeof="foaf:Image" src="http://localhost/test/sites/default/files/styles/uc_thumbnail/public/45c857_db4093c431282a16ff3e80767b3f8ecc.jpg" alt="" title=""></a>
        <a    href="http://localhost/test/sites/default/files/styles/uc_product_full/public/45c857_df2173694b2e1cc56e443a4103f02ede.jpg" title="" rel="lightbox[0]" class="lightbox-processed"><img class="boxes" typeof="foaf:Image" src="http://localhost/test/sites/default/files/styles/uc_thumbnail/public/45c857_df2173694b2e1cc56e443a4103f02ede.jpg" alt="" title=""></a>
</div> 
```

# c# - 在 asp.net webforms 中使用带有 objectdatasource 的 Ninject？

> ID：15617629
> 
> 赞同：0
> 
> 时间：2013-03-25T14:37:24.703
> 
> 标签：c#, asp.net, ninject, objectdatasource

我正在尝试在我的 asp.net webforms 应用程序中使用 Ninject 3。它工作正常，除了一些包含. throws`ObjectDataSource`的`Select`方法的页面。我的代码如下：`ObjectDataSource``NullReferenceException`

`Web.Admin.Grades.aspx`：

```
<asp:ObjectDataSource ID="ObjectDataSource1" runat="server"
                    EnablePaging="true" TypeName="Web.Admin.Grades"
                    SelectMethod="GetData" SelectCountMethod="GetDataCount"
                    StartRowIndexParameterName="StartRowIndex" MaximumRowsParameterName="MaximumRows">
                    <SelectParameters>
                        <asp:ControlParameter ControlID="SearchTxtBox" Type="String" Name="SearchKeyWord" PropertyName="Text" />
                    </SelectParameters>
                </asp:ObjectDataSource> 
```

`Web.Admin.Grades.cs`：

```
[Inject]
public IGradesRepository _Grades { get; set; }

public IList GetData(string SearchKeyWord, int StartRowIndex, int MaximumRows)
{
    return _Grades.GetGrades(SearchKeyWord, StartRowIndex, MaximumRows);
}

public int GetDataCount(string SearchKeyWord)
{
    return _Grades.GetGradesCount(SearchKeyWord);
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-26T10:07:45.800

抱歉造成误解我解决问题如下

```
 <asp:ObjectDataSource ID="ObjectDataSource1" runat="server"
                EnablePaging="true" TypeName="Domain.Abstract.IGradesRepository"
                SelectMethod="GetGrades" SelectCountMethod="GetGradesCount"   OnObjectCreating="ObjectDataSource1_ObjectCreating"
                StartRowIndexParameterName="StartRowIndex" MaximumRowsParameterName="MaximumRows">
                <SelectParameters>
                    <asp:ControlParameter ControlID="SearchTxtBox" Type="String" Name="SearchKeyWord"  PropertyName="Text" />
                </SelectParameters>
            </asp:ObjectDataSource> 
```

和 Web.Admin.Grades.cs：

```
[Inject]
    public IGradesRepository _Grades { get; set; }
protected void ObjectDataSource1_ObjectCreating(object sender, ObjectDataSourceEventArgs e)
    {
        e.ObjectInstance = _Grades;
    } 
```

# sql-server-2008 - SQL Server 存储过程查询

> ID：15617630
> 
> 赞同：4
> 
> 时间：2013-03-25T14:37:25.943
> 
> 标签：sql-server-2008, microsoft-dynamics

我最近继承了一个使用 SQL Server 2008 作为后端服务器的内部 ASP.NET 网站。SQL Server 有一个数据库，每个数据库`Database1`中有几个`Companies`，都具有相同的表集。

例如：

```
Database1
     Company1.Table1
     Company1.Table2
     Company2.Table1
     Company2.Table2 
```

该网站调用了几个存储过程。但是，存储过程已被编码为从硬编码的公司名称中选择数据。

例如：

```
SELECT * FROM Company1.Table2 
```

迄今为止，这一直运行良好，因为该网站仅链接到`Company1`. 现在的计划是将网站链接到`Company2`. 实际上，`Company 2`通过 IIS 上的单独设置被用作测试平台

有没有一种简单的方法，可能通过公司名称传递给存储过程，以便能够保留此设置？

也有人建议另一种方法是单独的 SQL 实例，因此我可以使用相同的`database\company`名称，这意味着更改很少。

另一个建议是简单地将存储过程从 to 复制`Company 1`并`Company 2`更改硬编码名称`Company 2`？

对不起，如果我有点含糊不清，但今天早上我已经把它放在我的桌子上了，我既不是 SQL Server 也不是网站专家。

提前感谢您的任何建议。

干杯

贾斯汀

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-26T10:18:57.007

> 有没有一种简单的方法，可能通过公司名称传递给存储过程，以便能够保留此设置？

保留此设置的最简单方法（不了解 ASP.net 代码）是运行整个数据库的单独副本以进行测试。我建议第三个副本用于开发，但这已经离题了。

以上所有方法都是可行的，但简单地复制数据库意味着您不必更改数据库中的任何代码。希望数据库名称不会在 ASP.net 代码中硬编码，因此您应该能够轻松地将其指向新数据库。

这为您提供了拥有用于测试的独立数据集的额外好处，因此您在测试更改时不会追逐移动目标。

对其他建议方法的简要评论：

> 可能通过公司名称传递给存储过程

这不仅意味着重构存储过程，还可能需要一些动态 SQL，并可能使您面临 SQL 注入（不一定是问题，因为它是内部的）。

> 另一个建议是简单地将存储过程从公司 1 复制到公司 2 并更改公司 2 中的硬编码名称？

同样，这将涉及重构存储过程（尽管只是使用查找/替换），我建议它需要进行全面测试以证明重构工作正常。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-08-02T06:37:20.957

这将合并来自具有相同表结构的两个不同数据库表的数据

```
SELECT * FROM Company1.Table2
UNION ALL
SELECT * FROM Company2.Table2 
```

# c++ - 使用 OpenCV win32 C++ 进行缩放

> ID：15617635
> 
> 赞同：1
> 
> 时间：2013-03-25T14:37:41.730
> 
> 标签：c++, winapi, opencv, flicker

我有一些 OpenCV 项目，可以在静态控件上查看图像并具有放大/缩小功能。这是我得到的：

```
void UpdateImage(HWND hwnd, int zoom) {
if(img) {
    RECT rc;
    HWND hStatic = GetDlgItem(hwnd, IDC_IMG);
    HDC imgdc = GetDC(hStatic);
    GetClientRect(hStatic, &rc);
    HDC hdcMem = CreateCompatibleDC(imgdc);
    HBITMAP hbmMem = CreateCompatibleBitmap(imgdc, rc.right-rc.left, rc.bottom-rc.top);
    HGDIOBJ hbmOld = SelectObject(hdcMem, hbmMem);
    HBRUSH hbrBkGnd = GetSysColorBrush(COLOR_3DFACE);
    FillRect(hdcMem, &rc, hbrBkGnd);
    DeleteObject(hbrBkGnd);
    SetBkMode(hdcMem, TRANSPARENT);
    int wnow = zoom * img->width / 100;
    int hnow = zoom * img->height / 100;
    IplImage* temp = cvCreateImage(cvSize(wnow, hnow), img->depth, img->nChannels);
    if(wnow > img->width && hnow > img->height) {
        cvResize(img, temp, CV_INTER_LINEAR);
    } else {
        cvResize(img, temp, CV_INTER_AREA);
    }
    if(temp->width < rc.right && temp->height < rc.bottom) {
        ShowImage(temp, hdcMem, 0, 0, wnow, hnow, 0, 0);
    } else {
        ShowImage(temp, hdcMem, 0, 0, rc.right, rc.bottom, 0, 0);
    }
    BitBlt(imgdc, rc.left, rc.top, rc.right-rc.left, rc.bottom-rc.top, hdcMem, 0, 0, SRCCOPY);
    SelectObject(hdcMem, hbmOld);
    DeleteObject(hbmMem);
    DeleteDC(hdcMem);
    ReleaseDC(hStatic, imgdc);
    cvReleaseImage(&temp);
}
} 
```

我`ShowImage()`从[这个链接](http://opencv-users.1802565.n2.nabble.com/Convert-IplImage-to-Bitmap-td3784378.html)得到了这个功能。问题是当我通过缩放滑块更新图像时，静态控件闪烁。如何获得无闪烁功能？

提前致谢！

# c - 在 C 中使用后增量时返回一个变量

> ID：15617638
> 
> 赞同：8
> 
> 时间：2013-03-25T14:37:59.897
> 
> 标签：c, global-variables, standards, c99, language-lawyer

我有一个名为的全局变量`var`和一个函数`foo`。（我知道这是一种不好的做法，但有时这是不可避免的）我想知道 C 标准（我正在使用 c99 编译）是否说明`var`如果我尝试执行会发生什么：

```
long foo(){
    return var++;
} 
```

谢谢。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-03-25T15:11:22.497

简短的回答：

它将返回一个副本，`var`然后立即递增 global `var`。

长答案：

C11 6.5.2.4

> “后缀 ++ 运算符的结果是操作数的值。作为副作用，操作数对象的值增加了......”。/--/ 结果的值计算在更新操作数的存储值的副作用之前排序。

标准 5.1.2.3“程序执行”规定必须在程序遇到*序列点之前评估所有**副作用*。（大量关于序列点可以在[这里](https://stackoverflow.com/questions/4176328/undefined-behavior-and-sequence-points)找到）。

 *语句后有一个序列点`return`(C11 6.8/4)。

这意味着`var++`在 main() 中的任何代码继续之前，保证表达式被完全评估。

您的机器代码将如下所示的伪代码：

*   将本地副本存储`var`在堆栈上（或寄存器等）
*   将全局增加`var`1。
*   从子程序返回。
*   使用“副本- `var`”。

如果您改为使用前缀增量，则增量操作将在存储副本之前进行排序。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-03-25T14:41:35.487

作为`var++`一个后增量，它基本上是这样的：

```
long foo(){
  long tmp = var;
  var++;
  return tmp;
} 
```

如果您`++var`改为使用，它将返回增加的值（因为它会在返回值*之前*增加变量）。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-03-25T14:39:52.480

`foo()`将返回 的当前值`var`，并`var`增加。*

# inno-setup - 从桌面 innosetup 替换相同的快捷方式

> ID：15617643
> 
> 赞同：6
> 
> 时间：2013-03-25T14:38:07.503
> 
> 标签：inno-setup

桌面上已经有一个同名的快捷方式，但它是由 setupfactory 安装的（我想用 inno 替换它）。现在，当我使用由 innosetup 创建的设置进行安装时，它会创建一个新图标，而不是替换当前图标。我添加了 [installDelete] 部分但不起作用。我刚刚检查了快捷方式属性。我发现的差异是一个快捷方式的所有者是管理员组，另一个是我的用户。但两者都是由同一用户安装的。会是这个原因吗？有什么解决方法吗？或者我可以检查是否存在同名的快捷方式？谢谢

两者都指向同一路径中的同一 exe。我在 Windows 7 中安装

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-25T15:05:06.783

在这种情况下，您应该检查两个快捷方式的位置。

可能其中一个是在 Public Desktop 文件夹中创建的（对于所有用户） -`{commondesktop}`第二个是为 Current User Desktop 文件夹预定制的 - `{userdesktop}`。

一个。

```
[Icons]
Name: "{commondesktop}\{#MyAppName}"; Filename: "{app}\{#MyAppExeName}"; 
WorkingDir: "{app}"; Tasks: desktopicon 
```

B.

```
[Icons]
Name: "{userdesktop}\{#MyAppName}"; Filename: "{app}\{#MyAppExeName}"; 
WorkingDir: "{app}"; Tasks: desktopicon 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-26T20:12:41.053

当您在安装程序框架之间切换时，通常最好在安装新版本之前卸载旧版本（通过其卸载程序）。（您可以自动执行此操作。）

如果您不这样做，那么用户最终可能会在其驱动器上看到杂散的卸载程序文件以及多个“添加/删除程序”条目；这两个都很丑。

（这是一次性的——从一个 Inno 或应用程序版本更改为另一个时无需卸载旧版本，只有从非 Inno 更改为 Inno 或相反时才需要卸载旧版本。）

# ruby-on-rails - 条件 order_by 取决于 Sunspot 中的数据

> ID：15617647
> 
> 赞同：3
> 
> 时间：2013-03-25T14:38:18.773
> 
> 标签：ruby-on-rails, solr, sunspot

我想知道是否有一种方法可以使用某种`if/then`语义进行排序。

我试图解决的基本要求是：

*   我的记录有一个 contact_again_time 时间属性，可以是`nil`.
*   列表的排序方式应使所有具有`contact_again_time`优先顺序的记录按`contact_again_time`降序排列。
*   其余`contact_again_time`为 nil 的位置应按 created_at 升序排序。

所以在我的脑海中，我可以通过将订单字段具体化到索引中来解决这个问题，让我`searchable`看起来像这样：

```
integer :sort_key do                                                                                                                                             
  contact_again_time.nil? ? (created_at.to_i * -1) : contact_again_time.to_i                                                                                     
end 
```

然后做一个`order_by(:sort_key, :desc)`得到我想要的。但是通过这种方式，我将部分排序逻辑放在了我的模型中，更重要的是放在了 Lucene 索引中。

我宁愿避免的事情，因为它感觉很不对劲。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-26T02:02:50.003

在 Solr 中，您可以通过向`sort`查询添加参数来执行此操作： `sort=contact_again_time desc,created_at asc`

无论何时`contact_again_time`出现，它都会按降序排序（并用于`created_at`打破关系，这与您无关）。只有`created_at`存在时，它们将按升序排序。

这应该以直接的方式转化为太阳黑子。

**更新**：如果你想排序，`sort=contact_again_time asc,created_at asc`你会得到`contact_again_time`首先丢失的文件，就像你在下面的评论中提到的那样。要将这些文档推送到最后，请添加`sortMissingLast="true"`到`contact_again_time`您的 Solr schema.xml。如果`created_at`某些文档中也可能不存在并且您希望具有相同的行为，那么您也应该添加`sortMissingLast`它。

# ios - 如何首先在 UIPicker 中选择具有特定标题的数组

> ID：15617654
> 
> 赞同：0
> 
> 时间：2013-03-25T14:38:39.540
> 
> 标签：ios, objective-c, xcode, multidimensional-array, uipickerview

您好，我想在 UIPicker 中显示一个列表，该列表保存在数组中。

它有效，但我想选择一个特定的标题作为标准。它应该是自动选择的。

例子：

> 大批
> 
> 索引***_ _* ___** _标题
> 
> 0_ ***_* __ *_* ___** _水
> 
> 1_ ***_* __ *_* ___** _Fire <---名称为Fire的标题应自动选择为标准。
> 
> 2_ ***_* __ *_* ___** _风暴

我的列表很灵活，我不能每次都选择索引 1。你对这个问题有什么想法吗？

提前致谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-25T14:40:58.017

为此，您需要使用 [selectRow:inComponent:animated:](http://developer.apple.com/library/ios/#documentation/uikit/reference/UIPickerView_Class/Reference/UIPickerView.html)

```
self.pickerView = [[UIPickerView alloc] initWithFrame:CGRectMake(0, 155, 0, 0)];
self.pickerView.delegate = self;
self.pickerView.showsSelectionIndicator = YES;
[self.pickerView selectRow:[YouArray indexOfObject:@"YourTitle"] inComponent:0 animated:NO];

[self.view addSubview:self.pickerView]; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-25T15:15:31.027

首先你需要找到Fire的索引

```
 NSArray *array = @[@"Water",@"Fire",@"Storm"];

    NSString *stringToBeSelected = @"Fire";

    NSUInteger index = [array indexOfObjectPassingTest:^BOOL(id obj, NSUInteger idx, BOOL *stop) {
        NSString *currentString = (NSString *)obj;
        return [currentString isEqualToString:stringToBeSelected];

    }]; 
```

选择pickerView所在的行

```
[self.pickerView selectRow:index inComponent:0 animated:YES]; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-25T14:40:45.580

快速浏览文档将为您提供答案。这样做：请记住，您必须在`viewDidLoad`ViewController 生命周期的某个地方或之后的某个地方执行此操作。

```
[myPickerView selectRow:indexYouWantSelected inComponent:columnInCaseYouHaveMany animated:NO]; 
```

# jquery - jQuery :nth-child()

> ID：15617659
> 
> 赞同：0
> 
> 时间：2013-03-25T14:38:48.813
> 
> 标签：jquery, css, css-selectors

我有一个清单

```
<article class="post">Bla bla bla</article>
<article class="post">Bla bla bla</article>
<article class="post">Bla bla bla</article>
<article class="post">Bla bla bla</article>
<article class="post">Bla bla bla</article>
<article class="post">Bla bla bla</article>
<article class="post">Bla bla bla</article> 
```

我会选择第 5 个和第 6 个元素，第 8 个和第 9 个，第 11 个和第 12 个，第 14 个和第 15 个等...

```
$('div#elencoNonHome > article.post:nth-child(???)').css('margin-left', '20px'); 
```

我可以用 jQuery 函数做到这一点吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-25T14:52:11.653

You can do this with nth-child. Just add the two statements together.

```
$('div#elencoNonHome > article.post:nth-child(3n+6)')
 .add('div#elencoNonHome > article.post:nth-child(3n+5)')
 .css('margin-left', '20px'); 
```

See [DEMO](http://jsfiddle.net/W8N3A/).

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-25T14:43:29.907

您不能直接使用 nth-child 执行此操作。它有相当简单的行匹配逻辑。但是，如果您颠倒逻辑，使默认边距为`20px`，则使用 nth-child 将行 #​​7、#10、#13 等拉到其他应有的位置

例如

```
$('div#elencoNonHome > article.post').css('margin-left', '20px');
$('div#elencoNonHome > article.post:nth-child("3n+7")').css('margin-left', 0) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-25T14:43:43.153

当然，为什么不呢。

```
$('div#elencoNonHome > article.post').filter( function() {
    var index = $( this ).index();
    return index >= 4 && index % 3;
}).css('margin-left', '20px'); 
```

演示：http: [//jsfiddle.net/R4vX2/1/](http://jsfiddle.net/R4vX2/1/)

# javascript - 有什么理由使用 !0 而不是 true？

> ID：15617667
> 
> 赞同：11
> 
> 时间：2013-03-25T14:39:07.643
> 
> 标签：javascript

我发现一些代码使用

```
!0
!1 
```

我想这只是一样的东西

```
true
false 
```

有这样做的理由还是只是一些缩写？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2013-03-25T14:40:15.823

如果您真的关心带宽和加载时间，那么您需要代码压缩。`!0`and`!1`是 and 的压缩`true`版本`false`。

# php - php获取数组的逆序

> ID：15617670
> 
> 赞同：2
> 
> 时间：2013-03-25T14:39:12.823
> 
> 标签：php

我有非常基本的 php 问题。我正在从数据库中获取数据并使用一些样式逐行打印它们。问题是这些数据代表新闻，我希望它们以相反的顺序打印（我获取的最后一行应该首先打印）。我不确定我是否可以一次获取整个表格并应用反向功能（我尝试过，但没有用）。

这是我的代码：

```
<?php
                include 'dbconnect.php';
                $data = mysql_query("SELECT * FROM news") or die(mysql_error()); 

                while($info = mysql_fetch_array( $data )) 
                {
                echo '<article><h3> '.$info['subject'].'</h3><div id="date">'.$info['date']. '</div>';
                echo '<p>'.$info['news']. '</p></article>';

                } 
?> 
```

我试过这样的事情：

```
$data = [];
array_push($array, $info); 
```

在while循环内，然后打印它，但结果却没有工作。感谢您的任何回答！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-25T14:41:09.923

你应该直接在 sql 中而不是之后在 php 中：

```
SELECT * FROM news ORDER BY date DESC 
```

您还应该切换到 PDO（或 mysqli），因为这些`mysql_*`功能已被弃用。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-25T14:41:28.630

```
"SELECT * FROM news ORDER BY id DESC" 
```

如果您对每条新闻都有一个 ID，则可以使用它。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-03-25T14:42:11.617

尝试这个：

```
$data = mysql_query("SELECT * FROM news ORDER BY date DESC") or die(mysql_error()); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-25T14:41:01.970

mysql 查询中 PHP 或`ORDER BY`id的array_reverse() 函数`(or time/date column) DESC`

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-03-25T14:42:51.760

```
mysql_query("SELECT * FROM news ORDER BY date DESC") 
```

我相信这就是您正在寻找的。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-03-27T08:44:33.750

```
$query = "SELECT * FROM news ORDER BY date DESC";
$data = mysql_query($query) or die(mysql_error()); 
```

# github - Git：如何删除除最后一个以外的所有提交

> ID：15617673
> 
> 赞同：4
> 
> 时间：2013-03-25T14:39:21.243
> 
> 标签：github

我在 git 上加载了一些包含一些个人数据的项目。现在我更改了所有行并提交它。现在我需要删除除最后一个之外的所有提交，以防止丢失个人数据。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2018-04-09T21:11:55.023

鉴于您的主分支称为 master，并且您希望从 master 中删除除最后一个之外的所有提交：

1.  `git checkout --orphan tmp`
2.  `git add . --all`
3.  `git commit -m "Init."`
4.  `git push origin tmp`
5.  *在您的远程 git repo 上选择 tmp 作为主分支*
6.  `git branch -D master`
7.  `git push origin :master`
8.  `git checkout -b master`
9.  `git push origin master`
10.  *在您的远程 git repo 上选择 master 作为主分支*
11.  `git branch -D tmp`
12.  `git push origin :tmp`

# magento - 在 magento 上捕获重新排序事件

> ID：15617675
> 
> 赞同：3
> 
> 时间：2013-03-25T14:39:26.400
> 
> 标签：magento, events

当在 magento 的管理面板中单击重新订购按钮时，我需要从订单中删除产品。

我`sales_order_save_after`在`global`节点中使用的 ATM。它会在完成、取消和类似事件时触发 - 但不会在重新排序时触发。

```
 <events>
        <sales_order_save_after>
            <observers>
                <isThisTagTotallyRandom>
                    <type>model</type>
                    <class>mymodule/observer</class>
                    <method>onOrderSaved</method>
                </isThisTagTotallyRandom>
            </observers>
        </sales_order_save_after>
    </events> 
```

所以我的问题是：

*   捕获重新订购的正确事件是什么？
*   毕竟，在重新排序时，有时应该有一个保存动作，为什么不调用这个事件？
*   作为奖励问题：标签`<isThisTagTotallyRandom>`真的是完全随机的吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-25T16:34:14.253

重新订购时，只会首先创建报价。这解释了为什么到目前为止没有保存订单。

如果您查看它的重新排序操作，它`Mage_Adminhtml_Sales_Order_CreateController`会调用`initFromOrder`. `Mage_Adminhtml_Model_Sales_Order_Create`在这个方法中，有一个被调度的事件被调用`sales_convert_order_to_quote`并且你可以收听。您可以从中获取报价和订单（并从中删除产品）。

此时仅创建一个报价，当单击提交订单按钮时​​将转换为订单（此时您可以做出反应，`sales_order_save_after`我猜）。

# thread-safety - 微软的 T4 模板引擎不是线程安全的

> ID：15617677
> 
> 赞同：1
> 
> 时间：2013-03-25T14:39:31.760
> 
> 标签：thread-safety, t4

Microsoft 的 T4 模板引擎不是线程安全的。我们有一个实用程序可以将图表转换为可执行的 C++。有人对我们如何并行翻译多个文件有任何建议吗？理想情况下，我们希望开发一个在多个线程中执行翻译器的多个实例的单个进程，但如果需要，我们也可以使用多个单个进程。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-21T02:50:03.173

我们故意不测试产品的线程安全性，因为它超出了我们的支持范围。我建议您运行 texttransform.exe 命令的多个实例。

# javascript - 更好的缓存以消除丢帧

> ID：15617678
> 
> 赞同：3
> 
> 时间：2013-03-25T14:39:33.873
> 
> 标签：javascript, html, html5-canvas, kineticjs

我第一次做一个小游戏，只是为了练习。正如你在我的小提琴中看到的那样，当屏幕上有很多子弹和/或敌人时，它会在一段时间后开始掉帧。有没有办法通过以某种方式缓存它来减少这种情况？

我读过一些关于预渲染的东西。但由于我使用的是 Kinetic 库，所以我认为这不是我能做的。是否有一些提示和技巧来减少它的丢帧？还是一种使用 KineticJS 进行预渲染的方法？

这是我的小提琴：http: [//jsfiddle.net/3nEUv/3/](http://jsfiddle.net/3nEUv/3/)

我认为子弹的绘制是一个真正的交易破坏者：（小提琴中的第 713 行）

```
function Enemybullet(destinationX, destinationY, enemySprite) {
    this.id = 'enemyBullet';
    this.x = enemySprite.getX()+(enemySprite.getWidth()/2);
    this.y = enemySprite.getY()+(enemySprite.getHeight()/2);

    this.damage = enemy.damage;

    //The targetX and Y are compensated by the player width and height. Subtract or add the halve of the player accordingly
    if (this.x > player.sprite.x) {
        var targetX = (destinationX - this.x)-(player.sprite.getWidth()/2);
        targetY = (destinationY - this.y)-(player.sprite.getHeight()/2);
    } else {
        var targetX = (destinationX - this.x)+(player.sprite.getWidth()/2);
        targetY = (destinationY - this.y)+(player.sprite.getHeight()/2);
    }

    var distance = Math.sqrt(targetX * targetX + targetY * targetY);

    this.velX = (targetX / distance) * enemyAttackSpeed;
    this.velY = (targetY / distance) * enemyAttackSpeed;

    this.finished = false;

    this.sprite = new Kinetic.Circle({
        x: this.x,
        y: this.y, 
        radius: 2,
        fill: 'black',
        name: 'enemyProjectile'
    });

    this.draw = function(indexEnemy, indexBullet) {

        var mayDelete = false;

        this.x += this.velX;
        this.y += this.velY;

        this.sprite.setAbsolutePosition(this.x, this.y);
        //console.log(this.sprite.getX());

        if(collisionDetection(this, player) == true) {
            player.collide(this);
            mayDelete = true;
        }

        if (bulletLeftField(this.sprite) == true) {
            mayDelete = true;
        }

        if (mayDelete == true) {
            delete this;
            this.sprite.remove();
            //console.log(enemies[indexEnemy].bullets);
            if (enemies[indexEnemy]) {
                enemies[indexEnemy].bullets.splice(indexBullet, 1);
            }
        }

        ammoLayer.draw();
    }

} 
```

提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-25T18:44:11.780

**一些想法并没有真正上升到答案的水平**

我注意到你以 5 发子弹的方式发射子弹。发火速度如此之快，以至于所有 5 发子弹都或多或少地朝着目标直线移动。我的建议是只对领先的子弹进行碰撞测试。如果领先的子弹击中，尾随的子弹最终会击中您的静止目标。

KineticJS 形状非常智能，因此非常占用处理器资源。因此，您可以使用缓存的子弹图像，而不是创建智能子弹。Eric Drowell（KineticJS 的创建者）说，使用“愚蠢”图像而不是“智能”形状可以将性能提升 4 倍。您可以缓存 5 种子弹图像模式（1-子弹、2-子弹、3-子弹、4-子弹、5-子弹）。在发射时，您遍历 1-5 个子弹图像，直到获得 5 个子弹。然后，您只需沿着射击线的斜面移动 5 子弹图像。

最后，从屏幕外缓冲区画布进行 blitting**确实**很有帮助，但不可能，因为 KineticJS 拒绝放弃对其画布的可写引用。Eric Drowlell，如果你在听……爱你的作品，但是给我们一个缓冲画布怎么样！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-25T20:21:14.980

我能想到的几件事会有所作为。

* * *

1/**对象池**

这是回收对象的技术。创建新的（并通过垃圾收集删除旧的）是浪费的。

这是通过在不再需要时将子弹移动到临时阵列来完成的。就像它离开屏幕或击中敌人一样。然后，当您需要新的子弹时，您从临时数组中取出对象并重新初始化子弹。

查看[此链接](http://creativejs.com/tutorials/create-an-ipad-optimised-game/)（搜索标题“回收鱼”）

* * *

2/**四叉树碰撞检测**

这是一个很好的碰撞优化技术。而不是检查你的子弹是否在每个滴答声中都与每个敌人发生碰撞，你只检查那些与你的子弹在同一个“四边形”中的敌人。

这是一个很好的[教程](http://gamedev.tutsplus.com/tutorials/implementation/quick-tip-use-quadtrees-to-detect-likely-collisions-in-2d-space/)。

* * *

3/**缓冲**

使用屏幕外画布。我会有一个用于背景、用户界面、玩家/敌人/子弹。这有一些变化，但根据我的经验，最有效的是将所有元素绘制到屏幕外层；然后每次打勾时，如果该图层已更改，则仅重绘（到屏幕外图层）图像。完成后，您将每个屏幕外图层编译为一个可见图层。我已经在我的手机游戏中成功使用了这种技术，它一次在屏幕上显示超过 90 个对象，在 iPhone4s 上以 60fps 的速度运行。

* * *

编辑：刚刚看到这个有趣的演示，展示了 3 个不同框架的性能，包括 Kinetic。Kinetic 在我的台式机和移动设备上对我来说最糟糕。

[互动演示在这里](http://jsdo.it/djankey/test-kineticjs)。

# android - 从活动调用对话框（作为一个类） - 必须定义一个显式构造函数

> ID：15617680
> 
> 赞同：0
> 
> 时间：2013-03-25T14:39:42.793
> 
> 标签：android, dialog

我有一个活动，我想将对话称为：

```
Intent intent = new Intent(MainActivity.this, start_dialog.class);
             MainActivity.this.startActivity(intent); 
```

我有 start_dialog 类：

```
public class start_dialog extends Dialog implements android.view.View.OnClickListener{

     EditText Dialog1=(EditText)findViewyId(R.id.Dialog1);
     EditText Dialog2=(EditText)findViewyId(R.id.Dialog2);

    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
       // setContentView(R.layout.dialog_view);

        LayoutInflater li = LayoutInflater.from(getContext());
        View promptsView = li.inflate(R.layout.dialog_view, null);

        AlertDialog.Builder alertDialogBuilder = new AlertDialog.Builder(
                getContext());

        alertDialogBuilder.setView(promptsView);

            final EditText userInput1 = (EditText) promptsView
            .findViewById(R.id.Dialog1);
    final EditText userInput2 = (EditText) promptsView
            .findViewById(R.id.Dialog2
                    );
        // set dialog message
        alertDialogBuilder
            .setCancelable(false)
            .setPositiveButton("OK",
              new DialogInterface.OnClickListener() {
                public void onClick(DialogInterface dialog,int id) {

                Dialog1.setText(userInput1.getText());
                Dialog2.setText(userInput2.getText());
                }
              })
            .setNegativeButton("Cancel",
              new DialogInterface.OnClickListener() {
                public void onClick(DialogInterface dialog,int id) {
                dialog.cancel();
                }
              });

        AlertDialog alertDialog = alertDialogBuilder.create();

        alertDialog.show();

    }

} 
```

我的问题是：

1）它给了我“必须定义一个显式的构造函数”，我不知道该放什么。

2）我不确定这是否有效。我希望对话框有 2 个编辑文本字段（和 2 个 texview），并且当用户输入填充列表视图时。

- - - - - - - - - - - - - - - - - 更新 - - - - - - - - ---------------

我的 start_dialog 是：

```
public  class   start_dialog extends Dialog {

    public  start_dialog(Context context) {
        super(context);
        // TODO Auto-generated constructor stub
        requestWindowFeature(Window.FEATURE_NO_TITLE);
        setContentView(R.layout.dialog_view);

    }

     public void onCreate(Bundle savedInstanceState) {
            super.onCreate(savedInstanceState);
           // setContentView(R.layout.dialog_view);
     //public void onClick(View v) {
            LayoutInflater li = LayoutInflater.from(getContext());
            View promptsView = li.inflate(R.layout.dialog_view, null);

            AlertDialog.Builder alertDialogBuilder = new AlertDialog.Builder(
                    getContext());

            // set prompts.xml to alertdialog builder
            alertDialogBuilder.setView(promptsView);

            final EditText userInput1 = (EditText) promptsView
                    .findViewById(R.id.Dialog1);
            final EditText userInput2 = (EditText) promptsView
                    .findViewById(R.id.Dialog2);

            final EditText Dialog1 = (EditText) findViewById(R.id.Dialog1);
            final EditText Dialog2 = (EditText) findViewById(R.id.Dialog2);

            // set dialog message
            alertDialogBuilder
                .setCancelable(false)
                .setPositiveButton("OK",
                  new DialogInterface.OnClickListener() {
                    public void onClick(DialogInterface dialog,int id) {
                    // get user input and set it to result
                    // edit text
                    Dialog1.setText(userInput1.getText());
                    Dialog2.setText(userInput2.getText());
                    }
                  })
                .setNegativeButton("Cancel",
                  new DialogInterface.OnClickListener() {
                    public void onClick(DialogInterface dialog,int id) {
                    dialog.cancel();
                    }
                  });

    // create alert dialog
            AlertDialog alertDialog = alertDialogBuilder.create();

            // show it
            alertDialog.show();

    }

} 
```

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-25T14:47:17.693

您正在从对话框扩展您的类，并尝试实例化类似的活动，因此您会遇到错误。

**MainActivity.java**

```
public class MainActivity extends Activity {

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_main);

        Start_dialog start_dialog = new Start_dialog(this);
        start_dialog.show();

    }

} 
```

**start_dialog.java**

```
public class Start_dialog extends Dialog{

    public Start_dialog(Context context) {
        super(context);
        // TODO Auto-generated constructor stub
        /** 'Window.FEATURE_NO_TITLE' - Used to hide the title */
        requestWindowFeature(Window.FEATURE_NO_TITLE);
        /** Design the dialog in main.xml file */
        setContentView(R.layout.dialog_layout); 

        Dialog1 = (EditText) findViewById(R.id.Dialog1);
        Dialog2 = (EditText) findViewById(R.id.Dialog2);

        BtnOk = (Button) findViewById(R.id.BtnOk);
        BtnCancel = (Button) findViewById(R.id.BtnCancel);

        .
        .
        .
        .

    }

    @Override
    public void onClick(View v) {
    /** When OK Button is clicked, dismiss the dialog */
    if (v == BtnOk)
        // do stuff
    }

    if (v == BtnCancel)
        dismiss();
    }   

} 
```

**清单.Xml**

```
<activity android:name=".Start_dialog" android:label="Dialog Example"
                  android:theme="@android:style/Theme.NoTitleBar" /> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-09-18T09:42:18.997

这是我用于我的项目的简单代码：

NotificarionDialog.class ：

```
 public class NotificationDialog extends Dialog implements android.view.View.OnClickListener
{
    String nMessage;
    TextView nMessageTv;
    Button okBtn;

    public NotificationDialog(Context context){
        super(context);
        setupView();
        setupEvent();
    }

    public NotificationDialog(Context context, String message){
        super(context);
        setMessage(message);
        setupView();
        setupEvent();
    }

    public NotificationDialog(Context context, String title, String message){
        super(context);
        this.setNotificationTitle(title);
        this.setMessage(message);
        setupView();
        setupEvent();
    }

    public void setNotificationTitle(String title){
        this.setTitle(title);
    }

    public void setMessage(String message){
        this.nMessage = message;
        nMessageTv.setText(nMessage);
    }

    private void setupView(){
        this.setContentView(R.layout.notification_dialog_layout);
        this.nMessageTv = (TextView) this.findViewById(R.id.notifDialog_text);
        this.okBtn = (Button) this.findViewById(R.id.notifDialog_ok);

    }

    private void setupEvent(){
        this.okBtn.setOnClickListener(this);
    }

    @Override
    public void onClick(View v)
    {
        // TODO Auto-generated method stub
        switch (v.getId())
        {
            case R.id.notifDialog_ok:
                this.dismiss();
                break;

            default:
                break;
        }
    }

} 
```

以及如何从其他类中使用它：

```
NotificationDialog notifDialog = new NotificationDialog(this);
            notifDialog.setTitle(NotificationString.NOTIFICATION_TITLE);
            notifDialog.setMessage(NotificationString.FAIL_LOGIN);
            notifDialog.show(); 
```

# javascript - mvc4：将位置信息传递给地理定位的javascript变量

> ID：15617687
> 
> 赞同：1
> 
> 时间：2013-03-25T14:39:52.860
> 
> 标签：javascript, jquery, asp.net-mvc-4

我是 mvc 和 jquery 的新手。我想通过用数据库中的多个城市替换这些位置来替换它们。我想知道我是怎么做到的。

```
function initialize() {

    var locations = [
        ['Hougang', 1.37265, 103.893658],
        ['Punggol', 1.400617, 103.907833],
        ['MacRitchie Reservoir', 1.346002, 103.825436],
        ['Bishan', 1.352051, 103.849125],
        ['Sentosa', 1.251226, 103.830757]
        ];

    var map = new google.maps.Map(document.getElementById('map'), {
        zoom: 0,
        center: new google.maps.LatLng(1.37265, 103.893658),
        mapTypeId: google.maps.MapTypeId.ROADMAP
    });

    var infowindow = new google.maps.InfoWindow();

    var marker, i;

    for (i = 0; i < locations.length; i++) {
        marker = new google.maps.Marker({
            position: new google.maps.LatLng(locations[i][1], locations[i][2]),
            map: map
        });

        google.maps.event.addListener(marker, 'click', (function(marker, i) {
            return function() {
                infowindow.setContent(locations[i][0]);
                infowindow.open(map, marker);
            }
        })(marker, i));
    }

    // Check if user support geo-location
    if (navigator.geolocation) {
        navigator.geolocation.getCurrentPosition(function(position) {
            var latitude = position.coords.latitude;
            var longitude = position.coords.longitude;
            var geolocpoint = new google.maps.LatLng(latitude, longitude);

            var mapOptions = {
                zoom: 8,
                center: geolocpoint,
                mapTypeId: google.maps.MapTypeId.HYBRID
            }
            // Place a marker
            var geolocation = new google.maps.Marker({
                position: geolocpoint,
                map: map,
                title: 'Your geolocation',
                icon: 'http://labs.google.com/ridefinder/images/mm_20_green.png'
            });
        });
    }
}
google.maps.event.addDomListener(window, 'load', initialize);

</script> 
```

会是这些线上的东西吗？问题是我不知道如何将两者联系起来。

```
public JsonResult Autolocations()
        {
            var locations = from s in db.Tble_content
                              select s.EN_Title;
            // return namelist.ToList();
            return Json(locations, JsonRequestBehavior.AllowGet);
        } 
```

非常感谢提前赫什

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-25T14:52:34.297

You should use ajax to connect the controller with a view, something like this

```
$(document).ready(function() {

    $.getJSON("/Locations/Autolocations", null, function (locations) {
          initialize(locations);
    });
});

function initialize(locations) {
    var map = new google.maps.Map(document.getElementById('map'), {
        zoom: 0,
        center: new google.maps.LatLng(1.37265, 103.893658),
        mapTypeId: google.maps.MapTypeId.ROADMAP
    });

    //the rest of your javascript code
} 
```

And your controller should something like this

```
public class LocationsController : Controller    
{
    public JsonResult Autolocations()
    {
        var locations = from s in db.Tble_content
                          select s;
        return Json(locations.ToList(), JsonRequestBehavior.AllowGet);
    }
} 
```

# sql - SQL 表更新

> ID：15617691
> 
> 赞同：0
> 
> 时间：2013-03-25T14:40:17.077
> 
> 标签：sql

我有 2 个表，如下所示，我需要使用 WorksTracking 中的数据更新 WorksOperation Table

作品跟踪表。

```
ID  WorksID  WorksOperationID  DateTime                 SubOperationID  EmployeeID 
1   2182     5363              2012-11-26 12:30:00.000  3               96
2   6866     9856              2012-11-26 10:26:00.000  3               100
3   2182     5363              2012-11-26 16:13:00.000  4               96
4   6866     9856              2012-11-26 13:42:00.000  4               100
6   2182     5363              2012-11-26 06:30:00.000  3               96
7   2182     5363              2012-11-26 12:30:00.000  4               96 
```

SubOperationID = 3 = 开始 4 = 结束

这就是我需要的

作品操作表。

```
ID  WorksID  WorksOperationID  StartTime                EndTime                SubOpID  EmpID 
1   2182     5363              2012-11-26 12:30:00.000  2012-11-26 16:13:00.000  4       96
2   6866     9856              2012-11-26 10:26:00.000  2012-11-26 13:42:00.000  4       100
3   2182     5363              2012-11-26 06:30:00.000  2012-11-26 12:30:00.000  4       96 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-25T15:20:44.783

这将适用于 SQL Server（2005 和更高版本），但如果这不是您的 RDBMS，它可以很容易地进行调整：

```
 ;WITH ALLSTARTS AS 
( 
    SELECT * FROM WorksTracking WHERE SubOperationID = 3
)
--INSERT INTO WorksOperation 
SELECT  s.WorksID ,
        s.WorksOperationID ,
        s.DateTime AS StartTime,
        e.DateTime AS EndTime,
        e.SubOperationID AS SubOpID,
        e.EmployeeID FROM ALLSTARTS s 
INNER JOIN dbo.WorksTracking e ON e.SubOperationID = 4 
AND e.DateTime = (SELECT MIN(e.DateTime) FROM WorksTracking e WHERE s.WorksID = e.WorksID AND s.WorksOperationID = e.WorksOperationID AND e.DateTime>s.DateTime) 
```

[SqlFiddle](http://sqlfiddle.com/#!6/74da2/4)

# php - INET_ATON 在 where 语句教义2 querybuilder zend2

> ID：15617695
> 
> 赞同：3
> 
> 时间：2013-03-25T14:40:22.593
> 
> 标签：php, mysql, doctrine-orm, doctrine, zend-framework2

问题：我想在 Doctrine2 中使用 querybuilder 运行查询，例如：

```
SELECT * FROM TABLE WHERE `column1` = 'x' and (`column2` = INET_ATON('1.1.1.1') OR `column3` like '%bla%'...) 
```

我应该如何使用 Zend2 在 Doctrine2 中执行此操作？

我试过这个：

```
$where->add($qb->expr()->eq('column2', $qb->expr()->literal('inet_aton('1.1.1.1')))); 
```

但这不起作用。Doctrine 仍然在 inet_aton 函数周围添加引号。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-26T06:10:19.820

好的，我自己想通了：

你应该做的几件事：

先做一个DQL函数

```
<?php

namespace Application\DQL;

use Doctrine\ORM\Query\Lexer;

class InetAtonFunction extends \Doctrine\ORM\Query\AST\Functions\FunctionNode
{
    public $valueExpression = null;

    /**
     * parse
     *
     * @param \Doctrine\ORM\Query\Parser $parser
     * @access public
     * @return void
     */
    public function parse(\Doctrine\ORM\Query\Parser $parser)
    {
        $parser->match(Lexer::T_IDENTIFIER);
        $parser->match(Lexer::T_OPEN_PARENTHESIS);
        $this->valueExpression = $parser->StringPrimary();
        $parser->match(Lexer::T_CLOSE_PARENTHESIS);
    }

    /**
     * getSql
     *
     * @param \Doctrine\ORM\Query\SqlWalker $sqlWalker
     * @access public
     * @return string
     */
    public function getSql(\Doctrine\ORM\Query\SqlWalker $sqlWalker)
    {
        return 'INET_ATON('. $this->valueExpression->dispatch($sqlWalker) . ')'; 
    }
} 
```

之后将函数添加到 Doctrine ORM

```
<?php
namespace Observer;

//...

class Module implements
    AutoloaderProviderInterface,
    ConfigProviderInterface,
    ServiceProviderInterface
{
//...
    public function onBootstrap($e)
    {

        $application = $e->getParam('application');
        $sm  = $application->getServiceManager();
        $em  = $application->getEventManager();

        $entityManager = $sm->get('doctrine.entitymanager.orm_default');
        $entityManager->getConfiguration()->addCustomStringFunction('inet_aton', 'Application\DQL\InetAtonFunction');       
    }
... 
```

之后你就可以走了。现在您可以使用 querybuilder 运行查询，例如

```
SELECT whatever FROM someting where cloumn = inet_aton(:?) 
```

我希望这可以帮助其他在 Doctrine 和 Zend Framework2 中具有特殊功能的人

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2016-01-12T22:42:39.270

只是更新的答案：（对于新的 SF 版本）

创建 DQL 函数后（参见较早的帖子），

我们想像这样在 Yaml (config.yml) 中注册我们自定义的 DQL 类：

```
doctrine:
    dbal:
        driver:   "%database_driver%"
        host:     "%database_host%"
        port:     "%database_port%"
        dbname:   "%database_name%"
        user:     "%database_user%"
        password: "%database_password%"

    orm:
        auto_generate_proxy_classes: "%kernel.debug%"
        auto_mapping: true
        dql:
            string_functions:
                inet_aton: home\myBundle\myFolderContaintClass\InetAton 
```

这是官方 Symfony 文档中的[解释](http://symfony.com/doc/current/cookbook/doctrine/custom_dql_functions.html)。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-26T06:09:22.037

这个问题似乎是[等同于 ROUND() 的 Doctrine 2 DQL MySQL 的副本？](https://stackoverflow.com/questions/15623257/doctrine-2-dql-mysql-equivalent-to-round)

您需要为此实现[自定义 DQL 函数](http://www.doctrine-project.org/blog/doctrine2-custom-dql-udfs.html)。

[DoctrineExtensions](https://github.com/beberlei/DoctrineExtensions/tree/master/lib/DoctrineExtensions/Query/Mysql)中有一些例子。

你可以像下面这样实现它：

```
<?php

namespace MyApp\DQL;

use Doctrine\ORM\Query\AST\Functions\FunctionNode;
use Doctrine\ORM\Query\Lexer;
use Doctrine\ORM\Query\SqlWalker;

class InetAnon extends FunctionNode
{
    private $arithmeticExpression;

    public function getSql(SqlWalker $sqlWalker)
    {

        return 'INET_ANON(' . $sqlWalker->walkSimpleArithmeticExpression(
            $this->arithmeticExpression
        ) . ')';
    }

    public function parse(\Doctrine\ORM\Query\Parser $parser)
    {

        $lexer = $parser->getLexer();

        $parser->match(Lexer::T_IDENTIFIER);
        $parser->match(Lexer::T_OPEN_PARENTHESIS);

        $this->arithmeticExpression = $parser->SimpleArithmeticExpression();

        $parser->match(Lexer::T_CLOSE_PARENTHESIS);
    }
} 
```

然后，您可以在引导 ORM 时将其注册到配置中：

```
$config = new \Doctrine\ORM\Configuration();

$config->addCustomNumericFunction('INET_ANON', 'MyApp\DQL\InetAnon'); 
```

# regex - 如何找到正则表达式匹配的特异性？

> ID：15617696
> 
> 赞同：3
> 
> 时间：2013-03-25T14:40:23.343
> 
> 标签：regex, url, routing, controller, routes

我正在考虑一个路由系统。想象一下我有以下两个正则表达式

*   `pathpart1/pathpart2` => 路由到控制器 1 的特定匹配
*   `.*`=> 捕获所有路由到控制器 2

我让它们匹配一个 URL，例如“pathpart1/pathpart2”。

它们都匹配，但我想对第一个正则表达式的特定匹配进行流行。有没有办法看到第一个正则表达式*非常具体*（所以我想使用那个匹配）而第二个完全不具体（所以一个匹配基本上是万不得已的最后手段）......？

我不知道哪些路由已注册到路由器，所以我不能按特定顺序循环它们（即首先是特定的，如果所有其他路由都不匹配，则最后是全部）。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-25T14:57:13.043

换句话说，您正在寻找一种方法来确定正则表达式范围的**基数。**这不是一项简单的任务。例如，考虑最明显的复杂性：当涉及量词`*`和时`+`，显然基数在任何一种情况下都是∞。但在我们的直觉中，一些无穷大[似乎比其他](http://en.wikipedia.org/wiki/Georg_Cantor)无穷大，所以我们觉得好像我们应该能够对包含这些无穷大量词的各种正则表达式进行排序。

我认为你必须要么（1）考虑一个不需要按特异性对正则表达式进行排序的替代设置*，*要么（2）考虑一个粗略的近似，*例如*只有两个“类”的正则表达式：那些一个或多个无限量词（未转义`*`或`+`不在方括号内），以及那些没有。

不是说没有希望！[也可以尝试在cs.stackexchange.com](http://cs.stackexchange.com)上发布这个问题。

# r - 按依赖列拆分 R 中的矩阵或数据集

> ID：15617697
> 
> 赞同：2
> 
> 时间：2013-03-25T14:40:25.673
> 
> 标签：r, matrix, set

对我来说，这是一个简单但可笑的艰苦过程。我试图弄清楚如何从数据中制作一组矩阵。

如果你有 R，

做

```
data(iris)
dim(iris)

[1] 150   5 
```

是维度

iris 是 R 编程中给出的数据

当你这样做

```
iris(3)
dim(iris3)

[1] 50  4  3 
```

你得到一组三个矩阵，分为“物种”相关列

我如何编程/编码，以便我可以为其他数据集执行此操作？？？

感谢您的时间和访问

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-25T14:47:18.177

`abind`您正在从`abind`包中寻找功能：

```
> library(abind)
> IrisArray <- abind(split(iris[, -5], iris[,5]), along=3)
> dim(IrisArray)
[1] 50  4  3  # these are the dimensions you want. 
```

如果你想要一个函数，那么看看这个：

```
library(abind)
Splitbyfactor <- function(x, by='Species'){
  ind <-  which(colnames(x)==by)
  abind(split(x[, -ind], x[,ind]), along=3)
}

dim(Splitbyfactor(iris,  by='Species'))
[1] 50  4  3 
```

编辑

此编辑用于回答您的评论，假设您有一个名为的 data.frame，`df`由两列随机数和第三个包含 ID 的列组成，这些 ID 是大写字母 A、B、C、D、E 和 F，这意味着您有 5 个不同的 ID 进行分割，则`along`调用中的参数`abind`不必设置为 5，因为它不是指 ID 的数量，而是指结果数组的维度；）。看这个例子

```
> df <- data.frame(A=rnorm(10), B=rnorm(10), ID=rep(LETTERS[1:5], each=6)) 
> dim(df)
[1] 30  3
> dim(Splitbyfactor(df,  by='ID'))
[1] 6 2 5 
```

# javascript - 如何在 json 中显示每个清单的输入标签和子清单？

> ID：15617701
> 
> 赞同：0
> 
> 时间：2013-03-25T14:40:48.067
> 
> 标签：javascript, jquery, json

我分别有一组问题和子问题。每个问题和子问题都有一个代码。
**清单**是问题。**子清单** 是子问题。例子 ：-

**代码 问题**
**4.1** 问题 1
**4.1.1**子问题 1

**5.1** 问题 2
**5.1.1**子问题 1
**5.1.2**子问题 2

每个问题旁边都有复选框。当我单击它们时，应显示子问题。

我的问题是：所有问题的子问题都显示在第一个问题本身下。

这是我的代码：

```
var json = $.parseJSON(master_checklists);

        var count_checklists = Object.keys(json).length;
        //console.log("No of checklists:"+count_checklists);
            var flag;
            var data1='';

        $(json).each(function(i,val_masterChecklist)
        {

            data = ++count + ') ' ;
            data += val_masterChecklist['code'] + '&nbsp;&nbsp;&nbsp;'
            data += val_masterChecklist['checklist'] + '&nbsp;&nbsp;&nbsp;'

            db.transaction(function (tx) 
            {   
                tx.executeSql('SELECT flag FROM checklists WHERE code ="'+val_masterChecklist['code']+'"', [], function (tx, results)
                {
                    flag = results.rows.item(0).flag;

                    if(flag == 0)
                    {
                        data = '<input type="checkbox" onclick="all_toggle_flag('+val_masterChecklist['code']+',1)">'+'<br>';
                        $("#all_checklists").append(data);
                    }

                    else if (flag == 1 || flag == 2)
                    {

                        data = '<input type="checkbox" onclick="all_toggle_flag('+val_masterChecklist['code']+',0)" checked>'+'<br>';
                        $("#all_checklists").append(data);
                        var checklistcode = chcode_from_schcode(val_masterChecklist['schcode'])

                        if(val_masterChecklist['code']==checklistcode)
                        {

                            data1 = '&nbsp;'+'&nbsp;'+'&nbsp;'
                            data1 += ++count_subchecklist + ') ' ;

                            data1 += val_masterChecklist['subchecklist'];

                            fetch_input_type(val_masterChecklist['data_type'],val_masterChecklist['schcode'],val_masterChecklist['code']);

                        }

                        $("#all_subchecklists").append(data1);
                    }   
                });

            });

                data += '<div id = "all_subchecklists"></div>'+'<br>'+'<br>'; 
                $("#all_checklists").append(data);          
        }); 
```

问题和子问题来自 json 。

请分享您的想法来解决这个问题。

谢谢 ..

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-25T14:47:06.320

我认为您应该将 JSON 字符串格式化或构造为`Arrays`.

所以你有一系列问题（主要问题），并且对于数组中的每个项目，它都有它的子问题数组作为数组（再次）。

如何实现它取决于您的编程语言，并在 JavaScript 中解析 JSON，我相信您会在这里找到很多帮助

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-25T14:50:12.237

您可以将其放置在单击复选框时调用的函数中。

```
$(this).closest("tr") 
```

代替

```
$("#all_checklists").append(data); 
```

我还使用 $(this).closest("tr").find(".classname") 来查找相对于单击内容的重复位置。

# java - 在 Unix 机器上运行时，日文字体无法正确显示

> ID：15617723
> 
> 赞同：1
> 
> 时间：2013-03-25T14:41:43.473
> 
> 标签：java, javascript, jakarta-ee, unix, character-encoding

我有一个基于 Spring MVC 的 Java webapp。我有一些数据要以日文字体显示。我做了一些在线研究，发现 UTF-8 是我需要的字符集编码。我将以下行添加到我的应用程序中。它所做的只是将字符集编码添加到响应标头。

```
 response.setCharacterEncoding("UTF-8"); 
```

当我在 Windows 7 上测试时，日文字体正确显示。

当我在 Unix 机器上运行相同的 war 文件时，我只看到这些字符： ��� 和 numbers if any 。我检查了 Chrome 调试器中的响应标头，我仍然看到 UTF-8 编码。

我在标题信息中看到的唯一区别是 Windows 的服务器是 Apache-Coyote/1.1，而 unix 上的服务器是 apache。

有人可以建议我还需要检查什么吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-25T15:03:27.063

问题可能是如何创建字符串。它是从文件中读取的吗？

如果是这样，则文件本身具有编码，您可能正在根据默认平台编码读取它。如果文件采用一种编码，但您以另一种编码读取，则字符串中的文本一开始就会不正确。

使用调试/记录的快速检查是字符串的长度。如果它在 Windows 上报告一个长度而在 Unix 上报告另一个长度，那么在生成字符串时可能存在编码错误。例如，当 UTF-8 中的一个字符被解释为 ISO-8859 时，您会看到如下内容：-€“</p>

在这种情况下，您希望字符串的长度为 1，但它的长度为 3。如果它嵌入到其他文本中，您会看到长度差异为 2，即使文本应该是相同。

# php - PHP打开文件不在网络服务器上进行编辑

> ID：15617726
> 
> 赞同：0
> 
> 时间：2013-03-25T14:42:09.320
> 
> 标签：php, file, fopen, editing

我正在创建一个用于编辑 html 和 php 代码的简单脚本。我正在使用 fopen() 和 fwrite() 打开和保存文件。但是，我只能打开我的网络服务器上的文件，而不是我的计算机上的文件。我可以做些什么来使从我的计算机打开文件成为可能？

我想避免设置 ftp 服务器等，因为 1）最终会破坏对象 - 还不如设置本地 Web 服务器 2）我希望其他人能够轻松下载和使用脚本

任何帮助，将不胜感激。谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-25T14:44:58.277

好的-根据您上面的评论，我想我现在明白了... ;-)

[http://www.w3.org/TR/html-markup/input.file.html](http://www.w3.org/TR/html-markup/input.file.html)

[https://developer.mozilla.org/en-US/docs/HTML/Element/Input](https://developer.mozilla.org/en-US/docs/HTML/Element/Input)

这将允许某人通过他们的浏览器将文件上传到您启用 PHP 的站点（在他们浏览到您的站点之后）。

然后，在文件保存到服务器后，您的 PHP 代码可以使用例如`get_file_contents()`获取文件并使用它。

PHP 需要将文件（即更多的 HTML）呈现为下载链接/按钮等，以便用户在处理后再次收集。

# node.js - 在早午餐中引用 node_module 的 .styl

> ID：15617733
> 
> 赞同：0
> 
> 时间：2013-03-25T14:42:21.333
> 
> 标签：node.js, twitter-bootstrap, stylus, brunch, chaplinjs

我有一个与卓别林一起吃早午餐的应用程序。我想使用 Twitter Bootstrap，但由于它是用 LESS 编写的，我更愿意切换到手写笔版本。幸运的是，那里有一个 bootstrap-stylus node_module。所以我通过`npm install bootstrap-stylus`. 但是我如何引用模块内的手写笔文件呢？正在做

```
@import 'bootstrap-stylus' 
```

不起作用。也不附加`/lib/bootstrap`路径。

我`"bootstrap-stylus": ">= 0.2"`在我`dependencies`的`package.json`文件里，但还是不行。有任何想法吗？谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-26T19:34:21.513

npm 安装到你的 node_modules 文件夹中，你可以从那里@import stylus 文件。

在我的测试中有效的行是：

`@import 'node_modules/bootstrap-stylus/lib/bootstrap.styl'`

* * *

## 回答 #2

> 赞同：-5
> 
> 时间：2013-03-26T04:17:51.633

`node_modules`适用于 node.js。早午餐适用于前端/html5。你不能把它们组合起来那么简单。

您将需要手动将内容复制到`app`或`vendor`目录。

# apache - 玻璃鱼和阿帕奇

> ID：15617736
> 
> 赞同：0
> 
> 时间：2013-03-25T14:42:26.260
> 
> 标签：apache, dns, glassfish

我想将我现有的 apache 与新的 glassfish 安装“结合”起来。Apache 在端口 80 上运行，glassfish 的部署工件正在侦听 8080。

Glassfish 安装了 X Server 的特定用户和开发人员权限“userX”。Apache 默认以“www-data”权限运行。

是否有机会以用户不会意识到重定向的方式将特定子域的所有数据（如“glassfish.localhost”）内部从端口 80 链接到 8080？

我意识到权限和凭据也存在问题。

你有想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-25T14:52:32.203

You need to configure an AJP connector between Glassfish and Apache using Apache mod_jk plugin.

By default glassfish has an AJP connector on port 8009, so you need to configure apache with a jk worker using the same port, and set a virtual host "glassfish.yourdomain.ext" using this worker.

The steps are :

1- install mod_jk plugin on apache and configure an AJP worker `ajpworker` using a `worker.properties` file containing :

```
worker.list=ajpworker
worker.ajpworker.type=ajp13
worker.ajpworker.host=localhost
worker.ajpworker.port=8009 
```

2- configure apache to load mod_jk with the worker.properties file above, and redirect your subdomain to `ajpworker` by definig a virtual host :

```
LoadModule jk_module modules/mod_jk.so
JkWorkersFile /etc/httpd/workers.properties
JkLogFile     /var/log/httpd/mod_jk.log
JkLogLevel    info
NameVirtualHost *:80
<VirtualHost *:80>
        ServerName yourdomain.ext
        JkMount / ajpworker
        JkMount /* ajpworker
</VirtualHost> 
```

3- Create a virtual host with your subdomain in glassfish (can be done on glassfish administration page)

Note that users won't be redirected to port 8080, the traffic will go trough port 80, Apache acting as a intermediate between the user and glassfish. You can even close HTTP 8080 listener on glassfish, the data between glassfish and apache will use the AJP 8009 port.

# session - 使用 IIS7 处理会话

> ID：15617739
> 
> 赞同：0
> 
> 时间：2013-03-25T14:42:37.413
> 
> 标签：session, iis-7

我有一个 Web 应用程序，直到最近才在使用 IIS6 的虚拟服务器上运行，我们目前在使用 IIS7 的物理服务器上运行，到目前为止没有任何问题。但是，客户现在抱怨该应用程序不再按预期工作。

该应用程序专门在 Internet Explorer（依赖于 NHS）上运行，并且是前段时间编写的，当时模式窗口不存在，而是在需要时打开新窗口，而且非常频繁。它在会话中存储页面到页面所需的信息，并在每次页面加载时检查所述会话的有效性。如果会话不存在或不是预期的，它会显示错误页面或将您返回到登录页面。（后退按钮、前进按钮和 F5 会中断会话并导致页面重新加载，用户必须再次登录才能继续。）

我知道会话正在工作，因为它允许用户登录和浏览应用程序，但是一旦他们打开一个弹出窗口，他们就会在弹出窗口中显示错误屏幕或登录页面。他们可以在弹出屏幕显示错误后继续使用该应用程序，这证明会话仍然有效。如果我将用户指向我们的旧生产服务器 (IIS6)，她可以毫无问题地使用该应用程序，并且所有弹出窗口都按预期工作。

该应用程序是用 PHP 编写的，他们使用的是 IE8（特定版本的 8.0.6001.18702）。我无法重现该问题，因为我的浏览器仍然是 IE8，它是较新的。奇怪的是它可以在旧服务器上运行，但不能在新服务器上运行，而且她是唯一遇到此问题的人（无论如何都已向我报告过）。

我假设两个版本的 IIS 在会话处理和 cookie 等方面存在细微差别，但我找不到。任何帮助/建议都将受到欢迎。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-05T19:21:18.800

事实证明，客户端浏览器存在问题，因为他们使用的是带有某种 Chrome 框架的 IE。自从删除它后，他们就可以正常使用该系统了。

# json - 具有从数据库中查找的值的 REST 更新字段

> ID：15617740
> 
> 赞同：0
> 
> 时间：2013-03-25T14:42:40.193
> 
> 标签：json, rest, lookup, put

采取以下场景：

我想通过 REST PUT 调用更新汽车对象上的制造商字段。应该发送的数据如下所示：

```
{
  "Id": "1000000251"
  "Manufacturer": "Honda"
} 
```

这里的关键是制造商字段的值来自存储在数据库中的一组选项列表。我还为客户提供了一个单独的 GET 调用，让他们可以检索有效制造商的列表。如果用户提供值“Honnnda”，我将返回验证错误。

在数据库中，我有以下选择要查找：

```
1 Honda
2 Toyota
3 Ford 
```

是否最好强制他们知道我们每个人的内部唯一 ID（更安全），从而在我的 JSON 对象中包含 ManufacturerId 字段，或者我可以允许他们通过文本值更新该字段？我将在这两种情况下验证输入。此外，在发送 PUT 请求之前，他们将被要求获取可用制造商的列表。

编辑 - 用户需要在进行 PUT 调用之前获取可用制造商的列表，因为他们需要提前知道他们可以做出的有效选择是什么。我用汽车作为一个“更具体”的例子，但我的系统实际上并不处理汽车。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-25T14:54:45.060

REST 并没有真正谈论这个主题。但是，通常 REST 确实更喜欢您使用 URI 作为标识符，因此有人可能会争辩说您应该发送..

```
{
  "Id": "1000000251"
  "Manufacturer": "http://myapi.com/manufacturers/1"
} 
```

我不相信这是必要的。REST 社区中有一部分人认为在表示中使用标识符使表示不是`self-descriptive`因为标识符的含义可能会在用户代理获取标识符和使用标识符之间发生变化。就个人而言，我也不买那个。

我会说，不要出汗。做最适合您的方案的任何事情。

# android - Android关于下载数据和片段列表

> ID：15617742
> 
> 赞同：1
> 
> 时间：2013-03-25T14:42:42.757
> 
> 标签：android, android-asynctask, android-listfragment

我对 API 15 及更高版本上的新片段有点困惑。我一直在开发旧 API 10 的姜饼版本。我用来获取我想要的数据的方法是通过`AsyncTask`下载主要活动的数据并将其存储到内部存储中，然后使用另一个`AsyncTask`来填充我的列表视图。

现在我决定从 API 15 Master Detail Flow 开始构建一个新的应用程序，它从 Fragment Activity 和 Fragment 开始，这对于手机和平板电脑来说有点酷。所以我的问题是使用旧方法`AsyncTask`仍然可行还是建议使用其他方法下载数据和填充列表视图？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-25T14:46:24.707

对于长时间运行的任务，例如从 Internet 下载数据，始终建议任何版本的 API 使用单独的线程（在本例中为 AsyncTask doInBackground 方法）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-25T14:48:45.227

你肯定想在他们自己的线程上分拆慢任务。但请注意`AsyncTask`，因为根据操作系统版本和您自己的设置，您一次可能无法运行多个`AsyncTask`。[在此处](https://stackoverflow.com/a/12865486/1029773)查看我的其他答案和评论

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-25T14:58:02.147

建议使用 Loader 来填充列表视图。

你可以让你的 ListActivity 实现`LoaderManager.LoaderCallbacks<E>`

您将获得三个覆盖方法：onLoaderCreate、onLoaderFinish、onLoaderReset。

在 onLoaderCreate 中，您可以告诉它您希望 Loader 加载什么对象。如果是游标，您可以创建一个 cursorLoader 对象，它会在您完成加载时返回一个 Cursor 对象（onLoaderFinish）。然后，您可以使用光标为 listView 填充适配器。

至于用于下载的 Asyn。你可以实现一个 IntentService。您可以通过以下方式运行它：

```
Intent intent = new Intent(mContext, IntentService.class);
startService(intent); 
```

您可以使用广播接收器从该后台服务中获得回叫。

# eclipse - 如何使用编辑器进行构建定义的输入？

> ID：15617744
> 
> 赞同：0
> 
> 时间：2013-03-25T14:42:53.090
> 
> 标签：eclipse, eclipse-plugin, build-definition

我正在开发一个定义构建定义的插件。我有一个选项，您可以在其中添加文件。该选项应该是项目特定的，因此数据不应该在项目之间保留。我正在使用 fieldEditor 来获取输入值。

我遇到的问题是它保留了不同项目之间的选项值。

这就是我在 plugin.xml 中的选项

```
<option
      browseType="file"
      category="test.category.applications"
      fieldEditor="com.test.FieldEditor"
      command="${value}"
      id="test.applicationFiles"
      name="%option.app.files.name"
      valueType="string">
</option> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-25T15:05:29.770

当您使用字段编辑器时，我猜您也在使用 IPreferenceStore 来保存用户首选项。

如果是这样，那么您必须更改范围内容。您现在可能正在使用 INSTANCE 范围：

```
IScopeContext context = InstanceScope.INSTANCE; 
```

并且您应该改用项目范围的首选项范围：

```
IProject handle = ...
IScopeContext context = new ProjectScope(handle); 
```

# ios - if 语句创建货币知道汇率

> ID：15617746
> 
> 赞同：0
> 
> 时间：2013-03-25T14:42:55.880
> 
> 标签：ios, objective-c, cocoa-touch

```
- (IBAction)poga1:(id)sender {

    float kurss = 0.702804;

    if ([_lauks2.text isequaltostring:@"") { 

    float atbilde = [_lauks1 floatValue] * kurss; 
    NSString *string = [[NSString alloc] initWithFormat:@"%.2f",atbilde];
    NSLog(@"%@",string);
    [_lauks2 setStringValue:string];

    }

    else if ([_lauks1.text isequaltostring:@"") {

    float atbilde2 = [_lauks2 floatValue] / kurss; 
    NSString *string2 = [[NSString alloc] initWithFormat:@"%.2f",atbilde2];
    NSLog(@"%@",string);
    [_lauks1 setStringValue:string2];

    }

}
@end 
```

我正在努力让它工作，它从第一个领域到另一个领域以一种方式工作，但不是回来......我是新手，所以请温柔:)

我有 2 个文本字段和一个按钮，我需要以两种方式创建公式 - 当我在一个文本字段中输入数字时，它会在另一个文本字段中显示答案。和其他方式。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-25T15:14:13.777

阅读该代码有点困难，但在第一次浏览时，至少有一个问题是 isequaltostring 的拼写，需要大写字母，例如`isEqualToString`:。另一个问题很可能是一个或两个文本字段出口没有连接，给你 lauks1 的空值。如果它是 nil，lauks1.text 将永远是 nil 并且永远不会是`@""`。

请检查您的网点是否已连接到 IB，并且在调用此方法时不为零。关于其余代码，我认为决定计算方向的更好测试是在文本字段上测试 isFirstResponder 。空白文本的逻辑取决于您，可能会导致其他字段为空白。它会是这样的（我还建议在计算方面更简单的代码）：

```
- (IBAction)pressedConvertButton:(id)sender {

    if ([self.currencyATextField isFirstResponder]) {  // assume you have outlets for the text fields
        float aValue = [self.currencyATextField.text floatValue];
        float bValue = aValue * kCURRENCY_A_TO_B_EXCHANGE;
        self.currencyBTextField.text = [[NSNumber numberWithFloat:bValue] stringValue];
    } else {
        float bValue = [self.currencyBTextField.text floatValue];
        float aValue = bValue * kCURRENCY_B_TO_A_EXCHANGE;
        self.currencyATextField.text = [[NSNumber numberWithFloat:aValue] stringValue];
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-25T16:53:52.237

我建议您使用文本更改通知，每当一个字段中的文本更改时，它将在另一个字段中更新，而无需按钮干预（如果您仍然想要按钮，请在文本更改方法中跟踪当前编辑字段以及何时按钮按下更新另一个字段。）

```
// add the observer
[[NSNotificationCenter defaultCenter] addObserver:self 
                                         selector:@selector(textFieldDidChange:) 
                                             name:@"UITextFieldTextDidChangeNotification" 
                                          object:nil];

// the method to call on a change
- (void)textFieldDidChange:(NSNotification*)aNotification 
{
    float kurss = 0.702804;

   if(aNotification.object == _lauks1) {
        float atbilde = [_lauks1.text floatValue] * kurss; 
        NSString *string = [[NSString alloc] initWithFormat:@"%.2f",atbilde];
        NSLog(@"%@",string);
        [_lauks2 setText:string];
   } else if (aNotification.object == _lauks2) {
        float atbilde2 = [_lauks2.text floatValue] / kurss; 
        NSString *string2 = [[NSString alloc] initWithFormat:@"%.2f",atbilde2];
        NSLog(@"%@",string);
        [_lauks1 setText:string2];
   }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-25T15:03:45.893

Can you try this

```
- (IBAction)poga1:(id)sender {

        float kurss = 0.702804;

        if ([_lauks1.text length]) { 

        float atbilde = [_lauks1.text floatValue] * kurss; 
        NSString *string = [[NSString alloc] initWithFormat:@"%.2f",atbilde];
        NSLog(@"%@",string);
        [_lauks2 setText:string];

        }

        else if ([_lauks2.text length]) {

        float atbilde2 = [_lauks2.text floatValue] / kurss; 
        NSString *string2 = [[NSString alloc] initWithFormat:@"%.2f",atbilde2];
        NSLog(@"%@",string2);
        [_lauks1 setText:string2];

        }

    } 
```

# c# - Web 服务错误“提供的 URI 方案 'http' 无效；应为 'https'。”

> ID：15617751
> 
> 赞同：4
> 
> 时间：2013-03-25T14:43:19.117
> 
> 标签：c#, asp.net, web-services

我有一个导致以下错误的服务调用：“提供的 URI 方案 'http' 无效；应为 'https'。”

app.config 值：

```
<basicHttpBinding>
<binding name="xx_xxxxx_spcName" closeTimeout="00:01:00"
              openTimeout="00:01:00" receiveTimeout="00:10:00" sendTimeout="00:01:00"
              allowCookies="false" bypassProxyOnLocal="false" hostNameComparisonMode="StrongWildcard"
              maxBufferSize="655360" maxBufferPoolSize="524288" maxReceivedMessageSize="655360"
              messageEncoding="Text" textEncoding="utf-8" transferMode="Buffered"
              useDefaultWebProxy="true">
          <readerQuotas maxDepth="32" maxStringContentLength="8192" maxArrayLength="16384"
              maxBytesPerRead="4096" maxNameTableCharCount="16384" />
          <security mode="Transport">
            <transport clientCredentialType="None" />
          </security>
        </binding>
</basicHttpBinding>

<client>
<endpoint address="http://server/serviceaddress_removed" 
                binding="basicHttpBinding" bindingConfiguration="xx_xxxxx_spcName" 
                contract="xx.xx_xxxxx_spcName" name="xx_xxxxx_spcName" />
</client> 
```

我试过 Https:// 但一切都是内部的，所以我不希望我需要这个，此外它还会给出客户端/服务器错误。

我也尝试过更改绑定类型

我还查看了此处和 asp.net 上的其他论坛帖子，所有帖子似乎都指向使用 Transport 并传入我在代码中执行的客户端凭据，如下所示：

```
client.ClientCredentials.UserName.UserName = "XXXXX";
client.ClientCredentials.UserName.Password = "XXXXX"; 
```

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2013-10-10T20:37:32.827

您必须更改`<security mode="Transport">`为无。运输力 https。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-25T14:50:37.927

如果我记得我的 WCF 配置培训，传输安全特别意味着您正在使用 HTTPS。如果您不使用 HTTPS，您的安全类型应设置为“无”，因为您知道您的消息将是未加密的。

我相信您也可以使用“消息”并手动提供证书，但我之前没有这样做过。

# javascript - 如何从 Google Drive 同步下载文件？

> ID：15617760
> 
> 赞同：0
> 
> 时间：2013-03-25T14:43:47.617
> 
> 标签：javascript, google-drive-api, synchronous

或者有没有办法产生相同的效果，即 JavaScript 程序停止直到下载完成（不使用`setTimeout`）？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-25T15:00:13.897

Javascript 是异步的，因此您需要异步处理下载。这主要是因为 javascript 运行单线程并且通常与 UI 线程共享，因此如果您在下载时阻止了您的代码，那么在您的代码完成之前，用户将根本无法与页面交互。

但是，异步处理它应该不难，只要您用于下载文件的机制在完成时支持回调（大多数情况下应该这样做）。

假设您有以下代码：

```
function doDownload(url) {
  doSomeInitialStuff();
  startDownload(url);  // assuming this would block, which it can't
  doSomeOtherStuff();
  doMoreOtherStuff();
} 
```

如果您的下载机制在完成时支持回调（下载完成或失败后调用的函数），那么您可以像这样重构代码：

```
function doDownload(url) {
  doSomeInitialStuff();
  startDownload(url, onDownloadComplete);
}

function onDownloadComplete() {
  doSomeOtherStuff();
  doMoreOtherStuff();
} 
```

回调如何工作的细节（传递给它的参数，它如何提供给下载代码）将根据您使用的 js 库而有所不同，但这是如何异步处理它的基本思想。

# authentication - openldap 堡垒 vs Apache Shiro

> ID：15617761
> 
> 赞同：2
> 
> 时间：2013-03-25T14:43:49.347
> 
> 标签：authentication, identity, openldap, shiro, fortress

我正在尝试下载 openldap，但遇到了一个名为 OpenLdap fortress 的 ldap Java JDK。[http://www.openldap.org/fortress/](http://www.openldap.org/fortress/) 好像对Identity Management Access 有好处，听起来不错，因为我正要使用开源的Identity Management Tool (Apache Shiro) 我应该坚持使用Apache shiro 还是使用只是 OpenLdap Fortress 还是两者兼而有之？身份和访问管理的最佳解决方案是什么？有什么区别？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-26T14:42:08.243

我对 Apache Shiro 不是很熟悉，但它似乎是 IAM 的一个框架，它为基于 Java Web 的应用程序提供身份验证、基于角色的授权和加密服务。所以从这个角度来看，这两种产品是匹配的。

两者分开的是 Fortress 提供 IdM 基础设施并符合 ANSI RBAC。它与 OpenLDAP 目录捆绑在一起（因此您不必弄清楚如何执行此操作）并提供与 Java EE servlet 容器（如 Tomcat）捆绑在一起的 RESTful API（如果 IAM API 调用必须通过防火墙），并且很快将包括一个用于管理 Fortress 身份/RBAC 策略和 OpenLDAP 的 Web UI。

因此，如果您正在寻找与现有 IdM 基础架构集成的框架，并且不需要 ANSI RBAC、Web 管理员或 REST，Shiro 可能是一个不错的选择。

如果 ANSI RBAC 合规性很重要，并且您需要开源 IdM 基础架构（如 OpenLDAP）、REST 和 UI 以及框架，您应该关注 Fortress。

# app-store-connect - iTunes Connect - 如何删除公司联系人？

> ID：15617762
> 
> 赞同：3
> 
> 时间：2013-03-25T14:43:52.280
> 
> 标签：app-store-connect

我正在尝试删除一个让我坐在菜单中的旧联系人。当我单击合同的联系信息，然后查看“公司联系人”下的菜单时，它就会出现。有一个添加公司联系人的按钮，但我找不到如何删除？

有任何想法吗？

这是支持说的：

有关更正 iOS 付费应用程序合同中的高级管理联系人的信息，请参阅 iTunes connect 常见问题解答“如何为我的公司编辑联系人？”

我挖掘了常见问题解答，谷歌搜索，但找不到那个具体问题。

# ios - 如何在 Xcode 中制作一个类似 facebook 的盒子

> ID：15617763
> 
> 赞同：-1
> 
> 时间：2013-03-25T14:43:55.213
> 
> 标签：ios, objective-c, xcode, facebook

你们中有人知道如何在 xcode 中制作这样的盒子吗： ![在此处输入图像描述](../Images/ce12a3fab0bcfa9e0739b73b383b971d.png) 我在许多应用程序中都看到了这样的盒子，现在想将它实施到我的项目中！有什么框架或东西吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-25T14:52:59.013

[可可控件](http://www.cocoacontrols.com/search?utf8=%E2%9C%93&q=popover)中有自定义控件可用

[看看这个](http://www.cocoacontrols.com/search?utf8=%E2%9C%93&q=popover)
[fppopover](http://www.cocoacontrols.com/controls/fppopover)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-25T15:26:23.877

您可能无需使用任何库即可实现它。看看这个基本教程：[http ://www.edumobile.org/iphone/ipad-development/presenting-a-popover-in-ipad/](http://www.edumobile.org/iphone/ipad-development/presenting-a-popover-in-ipad/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-25T14:57:17.907

您可以使用为 iPhone [http://code4app.com/ios/Popover-View-in-iPhone/4fa931bd06f6e78d0f000000制作的自定义 popoverController](http://code4app.com/ios/Popover-View-in-iPhone/4fa931bd06f6e78d0f000000)

# c - inotify_event 返回 wd -1

> ID：15617764
> 
> 赞同：0
> 
> 时间：2013-03-25T14:43:56.823
> 
> 标签：c, linux, inotify

我正在`INOTIFY`通过使用进行初始化，`inotify_init()`并且我`read`在没有掩码标志的情况下调用。当我想使用监视描述符`wd`时，我可以看到它返回值为 -1。阅读手册页我可以看到只有当偶数队列溢出时才设置此值，但仅当对 read 的调用设置了 mas 位 IN_Q_OVERFLOW 所以这不是我的情况。

将 wd 设置为 -1 的原因可能是什么？最重要的是，我没有通过读取返回-1，因此这意味着在此过程中没有错误。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-25T14:53:52.507

然后你误读了手册，[inotify_init(2)](http://man7.org/linux/man-pages/man2/inotify_init.2.html)清楚地说：

> 成功后，这些系统调用会返回一个新的文件描述符。出错时返回 -1，并设置 errno 以指示错误。

所以看看错误，看看你做错了什么。

# c# - 从表中获取最后一个用户定义的行

> ID：15617765
> 
> 赞同：0
> 
> 时间：2013-03-25T14:43:57.940
> 
> 标签：c#, sql, sql-server, database

我有这样的桌子

```
Sr_No / AccessionNo / Roll_nO   / Price
---------------------------------------    
1  /     101     /      45   /     1000

2  /     102        /   46     /   2000

3   /    101       /    43    /    500 
```

我希望当用户在文本框 2 中键入时，最后 2 行应该被检索，但我不知道在这里使用哪个函数，我是一名学生，几个月前就开始了我的 c#，并且仅从几个月开始使用 sql server。我已经用谷歌搜索并找到了一些查询，但我认为这不会有帮助，因为这个查询给了我上半部分是否有任何功能可以提供用户定义的下半部分？

```
SELECT TOP 5 * FROM [TableName] 
```

对不起，我的英语不好。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-25T14:45:30.413

指定一个`ORDER BY ... DESC`子句以获取底部行：

```
SELECT TOP 5 * 
FROM [TableName]
ORDER BY Sr_No DESC; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-25T14:45:39.813

`TOP`肯定会工作。您只需要使用子句*重新排序*记录，`ORDER BY`

```
SELECT TOP 2 * FROM [TableName] ORDER BY SR_NO DESC 
```

*   [SQLFiddle 演示](http://www.sqlfiddle.com/#!3/0dc5e4/1)

# c# - Convert.ToDateTime(D) 与 (DateTime)D 的比较

> ID：15617769
> 
> 赞同：1
> 
> 时间：2013-03-25T14:44:15.263
> 
> 标签：c#

如果我有一个值**D**并且想确保它是 datetime 类型，那么以下之间有区别吗？

1.  `DateTime dtm = Convert.ToDateTime(D)`
2.  `DateTime dtm = (DateTime)D`

1 是转换，而 2 是强制转换？（我假设在某些方面 2 是一个*更轻*的操作？）
我什么时候应该使用 1 而不是 2？

* * *

**编辑**

（问题的背景）

**D**来自 a 中的一个单元格`DataTable`。我正在做的是找到任何日期的单元格（通过`datatable.columnname`），然后将`ToOADate`函数应用于结果，然后再将其移动到 xl。所以如果`dr`是我的`DataRowView`，那么我有以下两种选择：

```
//Convert
DateTime dtm;
dtm = Convert.ToDateTime(dr[i - 1]);
xlWorkSheet.Cells[rowCount, i].value = dtm.ToOADate();

//Cast
DateTime dtm;
dtm = (DateTime)dr[i - 1];
xlWorkSheet.Cells[rowCount, i].value = dtm.ToOADate(); 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-25T14:45:51.977

`Convert.ToDateTime`有几个重载可以将其他类型转换为`DateTime`. 当您将不是 DateTime 的实例转换为 DateTime 实例时，应该使用它。您也可以使用[`DateTime.Parse`](http://msdn.microsoft.com/en-us/library/1k1skd40.aspx)and [`DateTime.TryParse`](http://msdn.microsoft.com/en-us/library/ch92fbc1.aspx)（如果您尝试解析字符串表示形式）。

`(DateTime)D`尝试直接将实例转换为`DateTime`. 如果实例在调用之前还不是`DateTime`，则会引发异常。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-25T15:20:01.117

通过使用“Convert”类，您实际上可以在不同类型之间进行转换。例如，您可以将字符串转换为日期时间。铸造只适用于相同的类型。因此，您不能将 String 转换为 Int32，因为这会引发转换异常。

关于您的示例：如果 D 的内容始终是 DateTime 类型，那么您应该更喜欢转换它，因为转换非常快。如果您不知道 D 中的类型是什么（可能是因为它是 Object 类型），您可能希望转换它，因为这比普通转换更优雅，因为此方法允许您也通过 String 设置 DateTime（Date字符串）或 Int32（刻度）。

# c++ - C++ 结构中私有和受保护的可用性

> ID：15617772
> 
> 赞同：5
> 
> 时间：2013-03-25T14:44:42.410
> 
> 标签：c++, c

我们可以在 C++ 结构（而不​​是类）中使用访问说明符 -`private`和- 吗？`protected`

另外，C 中是否存在访问修饰符？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-03-25T19:13:16.787

C doesn't have C++style access modifiers. A C `struct` is just a composite object type containing members of other object types.

In C++, a `struct` and a `class` are *almost* identical; the only difference is that struct members are `public` by default, and class members are `private` by default. So this:

```
struct foo {
private:
    // ...
}; 
```

is equivalent to this:

```
class foo: {
    // ...
}; 
```

This has been [answered elsewhere](https://stackoverflow.com/questions/92859/what-are-the-differences-between-struct-and-class-in-c).

This implies that the `private`, `public`, and `protected` keywords are equally valid in either a `struct` definition or a `class` definition.

As a matter of programming style, on the other hand, if you're going to be using access modifiers, it's probably best to define your type as a `class` rather than as a `struct`. Opinions will differ on this, but IMHO the `struct` keyword should be used for [POD (Plain Old Data)](http://en.wikipedia.org/wiki/Plain_Old_Data_Structures) types, or for types that could be defined as `struct`s in C.

C++ structs, strictly speaking, are very different from C structs, and are nearly identical to C++ classes. But if I see something defined in C++ as a `struct`, I expect (or at least prefer) it to be something similar to a C `struct`.

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-25T14:46:24.910

在 C++ 中，结构与类相同，唯一的区别是默认作用域是公共的，而私有作用域是类的默认作用域。In`C`访问说明符不存在，但毕竟你会用它们做什么？

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-03-25T14:45:49.057

是的，您可以在 C++ 结构中使用`public`, `protected`in 。`private`

不，C 中不存在访问修饰符。

`class`在 C++ 中，和之间的唯一区别`struct`是 a 的成员`class`是默认`private`的，而 a 的成员`struct`是默认的`public`。这意味着 C++`struct`可以具有成员函数、构造函数、重载运算符并使用`class`.

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-03-25T14:46:03.607

`struct`与c ++中没有太大区别`class`。默认可见性是公开的而不是私有的。C 不支持这些。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-03-25T14:47:15.050

> 我们可以在 c++ 的结构中使用访问说明符 - 私有的和受保护的吗？

是的。A`struct`是一个类；唯一的区别是如果您未指定默认可访问性（ `public`for`struct`和`private`for ）。`class`

> C语言也允许使用访问修饰符吗？访问说明符真的存在于 C 中吗？

不，C 没有访问说明符。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-03-25T14:46:16.160

C++ 中a`struct`和 a的唯一区别是 a的成员是默认的，而 a的成员是默认的。您可以在它们中使用访问说明符，就像您可以在它们中使用其他任何东西一样。`class``struct``public``class``private`

C 中没有访问说明符。

# macports - 更改 macports 的默认安装位置

> ID：15617775
> 
> 赞同：0
> 
> 时间：2013-03-25T14:44:46.803
> 
> 标签：macports

是否可以更改从 macports 安装的软件包的默认安装位置？

我正在尝试安装 numpy/scipy 模块。但它转到 /opt/local/Library/Frameworks/... 而不是 /System/Library/Frameworks/...

还是一开始就不是一个好主意？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-25T23:36:44.887

MacPorts 的目标是自包含，因此不涉及任何系统安装的东西（甚至不通过安装 python 模块）。如果您想使用使用 MacPorts 安装的 python 模块，请使用 MacPorts python。

改变这种行为是不可能的（没有*很多*努力）。

# objective-c - Xcode 不兼容的指针类型子类

> ID：15617783
> 
> 赞同：11
> 
> 时间：2013-03-25T14:44:56.523
> 
> 标签：objective-c, xcode, cocoa, warnings

当我尝试发送作为预期类的子类的对象时，我在 Xcode 中收到此警告。

`[reminder addContactsObject:individual];`addContactsObject 方法期望输入应该是 type `Contact`。`individual`我发送的是 ( ) 的子`Contact`类`Individual : Contact`。

那么为什么会产生警告呢？

编辑：添加代码...

**提醒.h**

```
@interface Reminder : NSManagedObject

- (void)addContactsObject:(Contact *)value; 
```

**联系人.h**

```
@interface Contact : NSManagedObject 
```

**个人.h**

```
@interface Individual : Contact 
```

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2013-03-25T14:56:33.487

可能需要包含个人标题。如果您不这样做，编译器将不知道超类

# c++ - qt在创建表单时执行代码

> ID：15617787
> 
> 赞同：0
> 
> 时间：2013-03-25T14:45:03.133
> 
> 标签：c++, qt

如何在创建主窗体时执行代码？说，我必须调用一个简单
`MessageBox(0, L"Hello World!", L"Debug", MB_OK)`的，它将在表单创建之后但在它出现在屏幕上之前调用。提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-25T14:47:30.407

编写一个继承自这种*形式的新***类**（？？）。然后，在类的**构造函数**上，执行：*`QWidget``QMainWindow`*

 ***```
MessageBox(0, L"Hello World!", L"Debug", MB_OK) 
```***

# c# - Sharepoint 2010 未绑定到 Active Directory

> ID：15617789
> 
> 赞同：0
> 
> 时间：2013-03-25T14:45:14.880
> 
> 标签：c#, .net, binding, sharepoint-2010, active-directory

我正在尝试从活动目录中获取用户的经理名称，我创建了一个控制台程序来测试它并且一切正常，当我在我的 Sharepoint 2010 程序中尝试代码时，它只是给了我一个例外“一个发生操作错误”。

进一步调试后，我发现主体上下文出错，引发异常“为了执行此操作，必须在连接上完成成功绑定。” 代码如下（注意：try catch 中的代码与我在控制台应用程序中的代码完全相同。）：

```
 public override void ItemAdding(SPItemEventProperties properties)
   {
       base.ItemAdding(properties);

       try 
       {
               // set up domain context
               PrincipalContext ctx = new PrincipalContext(ContextType.Domain);

               // find a user
               UserPrincipal user = UserPrincipal.FindByIdentity(ctx, Environment.UserName);
               string samAccountName = "";

               if (user != null)
               {
                   // do something here....     
                   samAccountName = user.SamAccountName;
               }

               //Get the manager name from the active directory
               var domain = System.Net.NetworkInformation.IPGlobalProperties.GetIPGlobalProperties().DomainName;

               using (DirectoryEntry dir = new DirectoryEntry("LDAP://" + domain))
               {
                   using (DirectorySearcher ds = new DirectorySearcher(dir, "samAccountName=" + samAccountName))
                   {

                       SearchResult result = ds.FindOne();

                       string managerName = result.Properties["manager"][0].ToString();
                   }
               }

       }
       catch(Exception ex)
       {
           var message = ex.Message;

       }
   } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-25T15:56:35.660

尝试改变：

```
PrincipalContext ctx = new PrincipalContext(ContextType.Domain); 
```

至

```
PrincipalContext ctx = new PrincipalContext(ContextType.Domain, "YOURDOMAINNAME"); 
```

# security - Api首页和单页应用

> ID：15617793
> 
> 赞同：1
> 
> 时间：2013-03-25T14:45:43.013
> 
> 标签：security, rest, web, oauth, single-page-application

我正在构建一个单页应用程序和一个 REST API 来处理来自客户端和任何可能的第三方客户端的请求。

我的想法是创建三个服务器：

*   A - API，基于 OAuth
*   B - 带有 html/css/js 文件 + 部分/视图的静态文件
*   C - 处理登录的 Web 服务器（节点或 python 或任何东西）

可能是第四个处理 Redis 或其他任何东西的会话。

我希望 SPA 让用户注册和/或登录到服务器 C，给他一个访问令牌并让他直接与 API (A) 对话。

我的问题是处理这个问题的正确机制是什么？

*   将带有访问令牌的会话 cookie 设置到主应用程序客户端（SPA），以便只要会话存在，它就可以与 REST API 对话
*   为了避免创建服务器 C 并在服务器 A 中处理身份验证，（那么第三方服务呢？）
*   还要别的吗

我的问题有点混乱，所以请随时向我询问更多详细信息。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-25T16:03:57.383

您基本上描述的是“票务”系统，只是您将票称为“令牌”。多年来，这个问题已经通过不同的标准化协议以不同的方式得到解决。麻省理工学院开发的一个非常流行的开放标准是[Kerberos](https://en.wikipedia.org/wiki/Kerberos_%28protocol%29)。

如果可能的话，我强烈建议使用现有的协议和现有的实现。尝试“推出自己的”安全性非常非常困难，并且通常会导致应用程序易受攻击。想想多年来困扰微软的瘟疫，与 *nix 系统相对安全的声誉相比 :-)

我的第一种方法是采用 Kerberos 或其他类似协议。如果您一心想自己动手，那么越简单越好。我会选择你的第二个解决方案并废弃服务器 C。让不同的服务器执行身份验证时出错的空间太大。

我知道这并不完全是您希望的答案，但我希望它有所帮助。

# jquery - JQuery - 将对象输出为文本？

> ID：15617794
> 
> 赞同：0
> 
> 时间：2013-03-25T14:45:43.113
> 
> 标签：jquery, html, output

所以，我有一个小部件，它希望将实时 HTML 源输出为文本，作为审查过程的一部分。有没有一种方法可以获取选定元素，将其附加到目标 div，并将其输出为文本而不是 DOM 中的子元素？

**更新**：如果可能的话，我想避免使用 textareas - 它们在我的表单设置中提出了一个复杂的问题，并且对于任何具有 firebug/inspectEl 基本技能的人来说都是一个漏洞。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-25T14:48:25.933

您可以将代码插入到 textarea 标签中，html 将被打印为文本

```
 jQuery('#idOfTextArea').text(html); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-25T14:59:40.823

您需要转义 html 字符，因此 < 变为 < 等等 - 在这里查看答案：[Escaping HTML strings with jQuery](https://stackoverflow.com/questions/24816/escaping-html-strings-with-jquery)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-25T15:05:24.847

如果你想避免，`textarea`那么我知道的唯一其他可能的选项是`<code>`标签，`<pre>`标签将识别空格，以便代码正确缩进。试试这个小提琴。

**[jsfiddle](http://jsfiddle.net/NZFrQ/1/)**

# cocoa - 通过 NSOrderedSet 对 NSArray 进行排序

> ID：15617795
> 
> 赞同：1
> 
> 时间：2013-03-25T14:45:45.927
> 
> 标签：cocoa, core-data, nsarray, nssortdescriptor, nsorderedset

我正在`NSFetchRequest`使用以下谓词：

```
[NSPredicate predicateWithFormat:@"index IN %@", indexes]; 
```

...`indexes`一个`NSOrderedSet`数字在哪里。

这给了我一组具有给定索引的“随机排序”对象。我需要对此进行排序，以便对象以与有序集中相同的顺序出现。

最有效的方法是什么？

**更新**

这是基于 Martin R 回答的类别：

```
@implementation NSArray (SortUsingValues)

- (NSArray *)sortedArrayUsingValues:(NSOrderedSet *)values keyPath:(NSString *)keyPath
{
    NSAssert([values isKindOfClass:[NSOrderedSet class]], nil);
    NSAssert([keyPath isKindOfClass:[NSString class]], nil);
    return [self sortedArrayUsingComparator:^NSComparisonResult(id object, id otherObject) {
        id value = [object valueForKeyPath:keyPath];
        id otherValue = [otherObject valueForKeyPath:keyPath];
        NSUInteger indexOfValue = [values indexOfObject:value];
        NSUInteger indexOfOtherValue = [values indexOfObject:otherValue];
        if (indexOfValue > indexOfOtherValue) return NSOrderedDescending;
        else if (indexOfValue < indexOfOtherValue) return NSOrderedAscending;
        else return NSOrderedSame;
    }];
}

@end 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-25T15:08:59.270

我想不出为此目的在获取请求中使用排序描述符的方法。但是你可以根据索引对获取后的结果数组进行排序：

```
NSArray *sorted = [results sortedArrayUsingComparator:^NSComparisonResult(id obj1, id obj2) {
    NSUInteger idx1 = [indexes indexOfObject:[obj1 valueForKey:@"index"]];
    NSUInteger idx2 = [indexes indexOfObject:[obj2 valueForKey:@"index"]];
    return idx1 - idx2;
}]; 
```

# c# - 使用 DropDowns 和 ViewData 进行过滤

> ID：15617797
> 
> 赞同：0
> 
> 时间：2013-03-25T14:45:49.533
> 
> 标签：c#, visual-studio-2010, asp.net-mvc-4, drop-down-menu, filter

我一直在论坛上四处寻找，因此试图使用下拉列表过滤我的索引页面。

这是我想出的。

首先我的控制器看起来像这样：

```
public ActionResult Index(string searchString)
    {
        var projects = from s in db.Project select s;
        var themeList = db.Theme.ToList();
        var projectList = db.Project.ToList();

        if (Request.Form["FilterTheme"] != null && Request.Form["FilterTheme"] != "")
        {
            int i = int.Parse(Request.Form["FilterTheme"]);
            projects = from s in db.Project
                      from c in s.Themes
                      where c.ThemeID == i
                      select s;             
        }

        if (Request.Form["Styles"] != null && Request.Form["Styles"] != "")
        {
            int i = int.Parse(Request.Form["Styles"]);
            projets = from s in db.Project
                      where s.ID == i
                      select s;
        }

        ViewData["Theme"] = new SelectList(themeList,"ThemeID", "Name");
        ViewData["Style"] = new SelectList(projectList, "ID", "Style");

        return View(projects);
    } 
```

视图看起来像：

```
@using (Html.BeginForm())
{
<table>
    <thead>
        <tr align="left">
            <th>
                Project name :
            </th>
            <th>
                Theme(s) :
                <br /><br />
                @Html.DropDownList("FilterTheme", (SelectList)ViewData["Theme"], "Select a theme", new { onchange = "this.form.submit()" })
            </th>
            <th>
                Style :
                <br /><br />
                @Html.DropDownList("Styles", (SelectList)ViewData["Style"], "Select a style", new { onchange = "this.form.submit()" })
            </th>
            <th>
                Date :
            </th>
        </tr>    
    </thead>

    <tbody>
        ...
    </tbody>
</table>
} 
```

终于成功了！！！

现在，如果我想删除样式下拉列表中的重复项，那将如何工作？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-26T14:55:56.890

DropDownList 第一个参数和 ViewData 不应使用相同的名称。在您的情况下，您已经使用`Style`了两次，这是错误的。您应该使用单独的名称：

```
@Html.DropDownList(
    "SelectedStyle", 
    (SelectList)ViewData["Styles"], 
    "Select a style", 
    new { onchange = "this.form.submit()" }
) 
```

和你的控制器：

```
public ActionResult Index(int? filterTheme, int? selectedStyle)
{
    var projects = from s in db.Project select s;

    if (filterTheme != null)
    {
        projects = from s in db.Project
                   from c in s.Themes
                   where c.ThemeID == filterTheme.Value
                   select s;             
    }

    if (selectedStyle != null)
    {
        projects = from s in projects
                   from c in s.Style
                   where s.ID == selectedStyle.Value
                   select s;
    }

    ViewData["Theme"] = new SelectList(db.Theme.ToList(), "ThemeID", "Name");
    ViewData["Styles"] = new SelectList(db.Project.ToList(), "ID", "Style");

    return View(projects);
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-26T14:59:04.473

好吧，让我们从显而易见的事情开始，你需要更好地命名你的对象，如果你有你会很快看到这个明显的问题，看看：

```
 /*if (Request.Form["Style"] != null && Request.Form["Style"] != "")
    {
        int i = int.Parse(Request.Form["Style"]);
        projets = from s in db.Project
                  from c in s.Style
                  where s.ID == i
                  select s;
    }*/ 
```

您正在设置 i = 样式，但您正在根据项目 ID 检查它，这里重命名的是您当前拥有的内容：

```
 if (Request.Form["Style"] != null && Request.Form["Style"] != "")
    {
        int styleID = int.Parse(Request.Form["Style"]);
        projects = from projects in db.Project
                  from styles in projects.Style
                  where projects.ID == styleID
                  select projects;
    } 
```

我猜这是你真正想要的：

```
 if (Request.Form["Style"] != null && Request.Form["Style"] != "")
    {
        int styleID = int.Parse(Request.Form["Style"]);
        projects = (from projects in db.Project
                  where projects.StyleID == styleID
                  select projects).Distinct();
    } 
```

根据要求，我在其中添加了一个 .Distinct() 以删除重复项。以下是一些资源：

[http://code.msdn.microsoft.com/101-LINQ-Samples-3fb9811b](http://code.msdn.microsoft.com/101-LINQ-Samples-3fb9811b) [http://blogs.msdn.com/b/charlie/archive/2006/11/19/linq-farm-group-and-distinct .aspx](http://blogs.msdn.com/b/charlie/archive/2006/11/19/linq-farm-group-and-distinct.aspx)

# erlang - erlang rebar escriptize & nifs

> ID：15617798
> 
> 赞同：11
> 
> 时间：2013-03-25T14:45:50.670
> 
> 标签：erlang, rebar, erlang-nif

如果我自己编写 escript，我可以使用 nif，但是当我使用 rebar escriptize 时，找不到 nif 函数。我认为这是因为 *.so 对象没有像梁文件那样被打包。这是一个简单的例子；

`rebar.config`：

```
{deps, [
   {'jiffy', "", {git, "https://github.com/davisp/jiffy.git", {branch, master}}}
]}.
{escript_incl_apps, [jiffy]}.
%% I tried this to see what happens if the so got in there but didn't help
{escript_incl_extra, [{"deps/jiffy/priv/jiffy.so", "/path/to/my/proj"}]}. 
```

`test.erl`：

```
-module(test).

-export([main/1]).

main(_Args) ->
    jiffy:decode(<<"1">>),
    ok. 
```

rebar get-deps 编译 escriptize
./test

结果是

```
escript: exception error: undefined function jiffy:decode/1
  in function  test:main/1 (src/test.erl, line 7)
  in call from escript:run/2 (escript.erl, line 741)
  in call from escript:start/1 (escript.erl, line 277)
  in call from init:start_it/1
  in call from init:start_em/1 
```

有没有办法克服这个？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-28T15:34:11.730

问题是该`erlang:load_nif/1`函数**没有**隐式使用任何搜索路径**，也没有**做任何聪明的尝试来查找`.so`文件。它只是尝试按文件名参数给出的字面意思加载文件。如果它不是绝对文件名，那么它将尝试加载相对于当前工作目录的文件。它**完全**加载您告诉它加载的内容。

因此，如果您调用`erlang:load_nif("jiffy.so")`，它将尝试`"jiffy.so"`从您当前的工作目录加载。`NIF_DIR`我使用的一个简单的解决方法是使用环境变量做这样的事情：

```
load_nifs() ->
    case os:getenv("NIF_DIR") of
        false -> Path = ".";
        Path -> Path
    end,
    ok = erlang:load_nif(Path ++ "/gpio_nifs", 0). 
```

这可以很容易地扩展到循环搜索路径以查找文件。请注意，这`NIF_DIR`不是一个特殊的名称，只是我“发明”的一个。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-27T19:36:41.103

似乎无法从 escript 加载 nif，因为`erlang:load_nif`不查看档案。这是因为大多数操作系统都需要`*.so`可以映射到内存的物理副本。

克服这个问题的最佳方法是将 *.so 文件复制到 escript 的输出目录中。

```
 {ok, _Bytes} = file:copy("deps/jiffy/priv/jiffy.so", "bin/jiffy.so"), 
```

看[一下](https://github.com/inaka/edis/blob/master/priv/script_builder#l45)`edis`. _ 您将看到这是他们如何加载 eleveldb 的 nif 以从 escript 执行。

# api - 访问 PayPay 的电话验证？

> ID：15617802
> 
> 赞同：0
> 
> 时间：2013-03-25T14:45:55.727
> 
> 标签：api, validation, paypal, phone-number

PayPal 似乎对电话号码的合法性进行了非常密集的检查。它不仅具有正确的位数，还可以检查真实的区号等等。paypal 是否有一些 api，我可以在其中提交电话号码，如果它被认为有效，它会返回？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-25T17:52:04.390

没有任何通过 PayPal 提供的 API 可用于验证电话号码。

# windows - “基于之上”是什么意思？

> ID：15617807
> 
> 赞同：0
> 
> 时间：2013-03-25T14:46:09.983
> 
> 标签：windows, term

我总是看到这个术语，但从来没有理解过，例如：

*TCP 正在 IP（Internet 协议）之上使用。*

这是另一个：

*一些 RemObjects SDK 组件基于 Indy 控件。*

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-25T14:50:54.290

当有人说“A 基于 B 之上”时，通常意味着 A 是使用 B 提供的功能构建的。因此，对于您的第一个示例，这意味着 TCP 依赖于 IP 来实现其较低级别的功能。

# android - ArrayAdapter 复选框行为

> ID：15617809
> 
> 赞同：0
> 
> 时间：2013-03-25T14:46:12.550
> 
> 标签：android, android-arrayadapter

我有一个`ArrayAdapter`自定义组件和复选框。当我检查一个项目并向下滚动时（在 中创建了新项目`getView()`，以前未选中`CheckBoxes`的被标记为已选中。我部分理解它为什么会发生，但我该如何避免呢？

这是我的`getView(...)`方法：

```
@Override
            public View getView(final int position, final View convertView,
                    final ViewGroup parent) {
                View v = convertView;
                TagHolder tagHolder = null;
                if (v == null) {
                    Log.d("Inside adapter getView()", "Extras have "
                            + CurrentRequest.getCarDetalized().getExtra()
                                    .size() + " items");
                    final LayoutInflater vi = (LayoutInflater) getContext()
                            .getSystemService(Context.LAYOUT_INFLATER_SERVICE);
                    v = vi.inflate(R.layout.additional_component, null);

                    tagHolder = new TagHolder();
                    tagHolder.extraName = (TextView) v
                            .findViewById(R.id.additional_info);
                    tagHolder.extraPrice = (TextView) v
                            .findViewById(R.id.additional_price);
                    v.setTag(tagHolder);
                    tagHolder.box = (CheckBox) v.findViewById(R.id.select);

                    tagHolder.box.setOnCheckedChangeListener(checkedItem);

                } else {
                    tagHolder = (TagHolder) v.getTag();
                }
                try {
                    final CarDetails.Extra extra = getItem(position);
                    tagHolder.box.setTag(position);
                    tagHolder.extraName.setText(extra.getName());
                    tagHolder.extraPrice.setText(extra.getCurrency() + " "
                            + extra.getPrice());
                    Log.d("Adapter",
                            "Set up adapter field with name " + extra.getName());
                    Log.d("Inside adapter", "extras size is "
                            + d.getExtra().size());
                    } catch (final Exception e) {
                    e.printStackTrace();
                    System.exit(0);
                    Log.e("CarList", "Error setting cell" + e);
                }
                return v;
            } 
```

解决了！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-25T14:51:50.410

Android reuses a previous row when scrolling; some of them being already checked. You'll need to set it directly:

```
 final CarDetails.Extra extra = getItem(position);
                tagHolder.box.setTag(position);
                tagHolder.extraName.setText(extra.getName());
                tagHolder.extraPrice.setText(extra.getCurrency() + " "
                        + extra.getPrice())
                // Add this:
                tagHolder.box.setChecked(myMethodToCheckIfItemIsChecked(extra)) 
```

# php - 迭代在 PHP 的数组中不起作用

> ID：15617814
> 
> 赞同：1
> 
> 时间：2013-03-25T14:46:24.117
> 
> 标签：php, mysql, session, login

我有这个基本查询，显示哪个用户可以访问哪个页面。

```
$query = mysql_query("SELECT UserName FROM tblUsers WHERE PageOne = 1") or die (mysql_error()); 
```

本质上，这是对所有有权访问 PageOne 的用户进行检查。

我正在尝试比较**$currentUser = $_SESSION['username']**（正确显示登录的用户）是否是此人。

在获得所有用户之后，

我做了这个简单的循环来检查他们是否可以访问。

```
while ($row = mysql_fetch_assoc($query))
{
    if (in_array($currentUser,$row["UserName"]))
       echo "you have access"; //for testing purposes
    else
        die("you're not authorized");
} 
```

当它不应该时，这将始终进入 else 语句。如果我尝试对此进行调试，我发现在查询中应该有三个用户，但**$row["UserName"]**只返回一个用户（第一个用户）。

但是，如果我摆脱 if/else 语句并简单地打印 $row["UserName"]，它会打印正确的用户。

那么，我将如何解决这个问题？

谢谢你！

编辑

在 while 循环中，如果我运行 echo **$row["UserName"]**，我会得到 User1User2User3 （其中 User3 是 CurrentUser）

要调试，我运行

```
if ($currentUser == $row["UserName"])
    echo "you have access";
else
    echo $row["UserName"]; 
```

我得到

**User1User2你有权限**

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-25T15:15:29.403

您发布的代码仅在返回的第一行恰好与当前用户匹配时才有效。否则循环终止。你可能想要更像这样的东西：

```
$has_access = false;
while ($row = mysql_fetch_assoc($query))
{
    if ($currentUser==$row["UserName"])
    {
        $has_access = true;
        break;
    }
}
// check $has_access here ... 
```

但是，如果我这样做，我会将整个检查移到您的 SQL 查询中并完全摆脱循环（未经测试）：

```
$query = sprintf("SELECT UserName FROM tblUsers WHERE PageOne = 1 AND UserName = '%s'", mysql_real_escape_string($currentUser));
$result = mysql_query($query) or die (mysql_error());
$has_access = mysql_num_rows($result) > 0;
// check $has_access 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-25T15:18:08.867

不是解决问题的方法。

首先，您的数据库模式看起来好像没有标准化 - 用户是一个实体，页面是不同的实体，谁有权访问应该在第三个表中定义的页面（分解 N:M 关系）。

> 我正在尝试比较 $currentUser = $_SESSION['username']

为什么要获取每一行数据以查明当前用户是否具有访问权限：

```
$qry=mysql_query("SELECT COUNT(username) 
FROM tblUsers 
WHERE PageOne = 1 and username='" 
. mysql_real_escape_string($_SESSION['username'])
. "'"); 
```

请记住，您还应该使用未弃用的 API 重新实现代码。因此，它确实应该是：

```
$qry=mysqli_query("SELECT COUNT(username) as allowed_match
FROM users u
INNER JOIN permissions p
ON u.id=p.user_id 
WHERE p.page='PageOne'
and p.allowed = 1 
and u.username='" 
. mysqli_real_escape_string($_SESSION['username'])
. "'"); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-25T14:51:24.760

在 while 的每个循环中，它都会获取查询结果的值。另外，如果你在元素不等于当前用户的时候死掉，每次都会死掉，除非$currentUser是$row[]的第一个元素所以if应该是：

```
 public function checkUserInTable($tableNumber){

         $query = mysql_query("SELECT UserName FROM tblUsers WHERE PageOne = ".$tableNumber."") or die (mysql_error());

         while ($row = mysql_fetch_assoc($query)) {
              if($currentUser == $row["UserName"]){ 
                   echo "you have access"; 
                   return true; 
              } 
         } 

         return false; 
    } 
```

函数调用：

```
if(checkUserInTable(1))
    echo "User Accepted";
else
    die("Error Message"); 
```

# python - python类中方法的动态分配

> ID：15617817
> 
> 赞同：1
> 
> 时间：2013-03-25T14:46:31.983
> 
> 标签：python

`__init__`我想在类方法中动态创建一堆方法。到目前为止还没有运气。

代码：

```
class Clas(object):
    def __init__(self):
        for i in ['hello', 'world', 'app']:
            def method():
                print i
            setattr(self, i, method) 
```

比我创建适合列表的方法和调用方法。

```
>> instance = Clas()

>> instance.hello()

'app' 
```

我希望它不会`hello`打印`app`。问题是什么？此外，这些动态分配的方法中的每一个都引用了内存中的相同函数，即使我这样做了`copy.copy(method)`

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-25T14:47:22.980

您需要`i`正确绑定：

```
for i in ['hello', 'world', 'app']:
    def method(i=i):
        print i
    setattr(self, i, method) 
```

然后将`i`变量设置为`method`. 另一种选择是使用一个新的范围（单独的函数）来生成你的方法：

```
def method_factory(i):
    def method():
        print i
    return method 

for i in ['hello', 'world', 'app']:
    setattr(self, i, method_factory(i)) 
```

# c# - 关于 AverageTimer32 PerformanceCounter 的困惑

> ID：15617818
> 
> 赞同：10
> 
> 时间：2013-03-25T14:46:33.630
> 
> 标签：c#, .net, performancecounter

我正在尝试设置一个`PerformanceCounter`来测量某个方法的平均执行时间。我试图继续阅读`AverageTimer32`并查看了很多示例，但我似乎无法正确理解。

我设置了类别

```
CounterCreationDataCollection CCDC = new CounterCreationDataCollection();

// Add the counter.
CounterCreationData averageTimer32 = new CounterCreationData();
averageTimer32.CounterType = PerformanceCounterType.AverageTimer32;
averageTimer32.CounterName = counterName;
CCDC.Add(averageTimer32);

// Add the base counter.
CounterCreationData averageTimer32Base = new CounterCreationData();
averageTimer32Base.CounterType = PerformanceCounterType.AverageBase;
averageTimer32Base.CounterName = baseCounterName;
CCDC.Add(averageTimer32Base);

// Create the category.
PerformanceCounterCategory.Create(categoryName, "Demonstrates usage of the AverageTimer32 performance counter type", PerformanceCounterCategoryType.SingleInstance, CCDC); 
```

然后我创建计数器

```
PC = new PerformanceCounter(categoryName, counterName, false);

BPC = new PerformanceCounter(categoryName, baseCounterName, false);

PC.RawValue = 0;
BPC.RawValue = 0; 
```

最后，每次调用我的方法时，我都会记录经过的时间

```
private void TheMethodIWantToMeasure() {
    Stopwatch stopwatch = Stopwatch.StartNew();

    // Fake work that take ~50ms
    Thread.Sleep(50 + random.Next(-10, 10));

    stopwatch.Stop();

    PC.IncrementBy(stopwatch.ElapsedTicks);
    BPC.Increment();
} 
```

这样做，我最终得到的性能监视器看起来像这样。我在 50 毫秒左右得到尖峰而不是连续曲线： ![图片](../Images/f9b57e8d495f5fa2acea98a80830d7e1.png)

我误解了`AverageTimer32`吗？我读过它，但它有点令人困惑。但是，我已经看到示例与我做几乎相同的事情，所以我猜它应该可以工作。我只得到尖峰的原因可能是什么？

**编辑** 可能值得一提的`TheMethodIWantToMeasure`是，每隔约 5 秒调用一次，我刚刚意识到我每隔约 5 秒就会收到一次尖峰信号。但我不明白如果`AverageTimer32`使用公式 ((N 1 -N 0)/F)/(B 1 -B 0) 会如何影响结果。它不应该取决于我存储 N 和 B 值的频率吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2015-02-02T13:33:35.317

您的答案在于您的 permon 设置的刷新/采样率。如果您要取出**~5s**间隔或至少将其更改为**~10ms**，您可能会注意到图表看起来更像您最初的预期。或者，将您的性能计数器刷新率更新为更高的间隔（30 秒）将是相同的。（*通过右键单击 perfMon 图 -> 属性 -> 常规选项卡 -> 每 x 秒采样一次*）。

原因是 perfMon 每 1 秒刷新一次（默认情况下），然后需要显示你的平均值。因此，它需要“*所有*”您在那一秒内添加到计数器的操作并将其绘制在图表上。

**示例：**如果您在一秒钟内执行了*3 个操作（* **0.1ms、0.2ms 和 0.3,ms**），则 perfMon 将显示您的平均值为**0.2ms**，这是正确的。

为什么会有差距？我相信这是因为现在在计算出平均值并看到“峰值”之后，下一秒（当 perfMon 再次刷新时），它将计算 0secs = 0 内 0 次操作的平均值。

我的建议（如果你想真正看到平均`TheMethodIWantToMeasure`运行时间的平均值，就是完全**取消 ~5 秒的间隔，**让方法持续运行。这应该可以解决问题。

# wordpress - 仅用于帖子的 Wordpress 自定义永久链接

> ID：15617820
> 
> 赞同：16
> 
> 时间：2013-03-25T14:46:35.380
> 
> 标签：wordpress, custom-post-type, permalinks

我的 Wordpress 安装具有三种帖子类型：页面、帖子和作品集。目前的结构如下：

*   页：`example.com/page-name`,
*   发布列表页面：`example.com/blog`，
*   **个人帖子**：`example.com/post-name`，
*   投资组合列表页面：`example.com/portfolio`，
*   个人投资组合职位：`example.com/portfolio/portfolio-name`。

我想改变的是个别帖子的永久链接，但没有别的。我希望它成为 example.com/blog/post-name。

我找不到说明如何在不影响其他类型的情况下进行此更改的文档。

**编辑**：我当前的永久链接结构设置为`/%postname%/`，在阅读设置下，我的帖子页面设置为博客。

```
register_post_type('portfolio', array(  
'label' => 'Portfolio Items',
'description' => '',
'public' => true,
'show_ui' => true,
'show_in_menu' => true,
'capability_type' => 'post',
'hierarchical' => true,
'rewrite' => array('slug' => 'portfolio'),
'with_front' => false,
'query_var' => false,
'has_archive' => true,
'exclude_from_search' => false,
'supports' => array('title','editor','excerpt','trackbacks','custom-fields','comments','revisions','thumbnail','author','page-attributes'),
'taxonomies' => array('category','post_tag'),
'labels' => array (
    'name' => 'Portfolio Items',
    'singular_name' => 'Portfolio Item',
    'menu_name' => 'Portfolio Items',
    'add_new' => 'Add Portfolio Item',
    'add_new_item' => 'Add New Portfolio Item',
    'edit' => 'Edit',
    'edit_item' => 'Edit Portfolio Item',
    'new_item' => 'New Portfolio Item',
    'view' => 'View Portfolio Item',
    'view_item' => 'View Portfolio Item',
    'search_items' => 'Search Portfolio Items',
    'not_found' => 'No Portfolio Items Found',
    'not_found_in_trash' => 'No Portfolio Items Found in Trash',
    'parent' => 'Parent Portfolio Item',
)
)); 
```

* * *

## 回答 #1

> 赞同：46
> 
> 时间：2013-03-25T16:03:59.867

您只需将其设置`/blog/%postname%/`为永久链接结构，这不会更改您的页面永久链接。

为了保持您的投资组合永久链接，您应该在注册此帖子类型时设置[`with_front`](http://codex.wordpress.org/Function_Reference/register_post_type)为。`false`

> `'with_front' => bool`永久结构是否应该与前基地一起使用。（例如：如果您的永久链接结构是`/blog/`，那么您的链接将是：`false->/news/`, `true->/blog/news/`）。默认为真

编辑 1：之后您可能应该[刷新 Wordpress 重写规则](http://codex.wordpress.org/Function_Reference/flush_rewrite_rules)。

编辑 2：`with_front`参数是一个`rewrite`参数：

```
'rewrite' => array('slug' => 'portfolio', 'with_front' => false), 
```

# security - Windows 8 应用程序 - 本地存储安全

> ID：15617821
> 
> 赞同：6
> 
> 时间：2013-03-25T14:46:36.310
> 
> 标签：security, windows-8, windows-store-apps

本地数据的安全性如何

```
ApplicationData.Current.LocalSettings 
```

Windows 8 应用商店应用程序中使用的存储空间？

这篇[应用程序数据存储](http://msdn.microsoft.com/en-us/library/windows/apps/xaml/hh464917.aspx)文章没有提到安全性，这篇文章也[没有](http://msdn.microsoft.com/en-us/library/windows/apps/xaml/hh700361.aspx)。

可以从应用程序外部操纵这些数据吗？

我查看了数据的位置

> C:\Users[用户名]\AppData\Local\Packages[package_namespace]\LocalState)

但没有找到。它具体保存在哪里？

我正在尝试评估这种存储机制的安全性，以决定我是否可以在那里存储安全关键信息。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-25T14:54:34.330

经过一番调查，我发现：

[http://lunarfrog.com/blog/2012/09/13/inspect-app-settings/](http://lunarfrog.com/blog/2012/09/13/inspect-app-settings/)

数据存储在

> C:\Users[用户名]\AppData\Local\Packages[package_namespace]\LocalState\Settings\settings.dat

这是一个 Windows NT 注册表文件 (REGF)，可以用注册表编辑器打开，也可以进行操作。

**意思是，本地存储是不安全的。**

如果没有其他方法，[加密数据](http://msdn.microsoft.com/en-us/library/windows/apps/windows.security.cryptography.dataprotection.dataprotectionprovider)和混淆密钥是可能的。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-26T05:52:40.650

如果您要存储的是用户凭据，请查看[`PasswordVault`](http://msdn.microsoft.com/en-us/library/windows/apps/br227089.aspx)类。否则，请按照您自己的建议使用[DPAPI](http://msdn.microsoft.com/en-us/library/windows/apps/hh464970.aspx)。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-03-26T03:17:48.563

> 这篇应用程序数据存储文章没有提到安全性，这篇文章也没有。可以从应用程序外部操纵这些数据吗？

该存储类似于[iOS 的 Core Data](http://developer.apple.com/library/ios/#documentation/DataManagement/Conceptual/iPhoneCoreData01/Introduction/Introduction.html)。除非存储受到保护（低于应用程序级别），否则它本质上是不受信任的输入。即使存储受到加密保护，它也可能未经身份验证，因此容易被篡改。

> 如果没有其他方法加密数据和混淆密钥是可能的。

在 Windows 平台上，保护敏感数据的标准方法是使用数据保护 API (DPAPI)。将 DPAPI 与用户提供的机密（API 中的附加熵）一起使用以获得最佳保护。您将 DPAPI 的数据与用户的配置文件、注册表或文件系统一起存储。例如，请参阅[Windows 数据保护](http://msdn.microsoft.com/en-us/library/ms995355.aspx)、[如何：使用数据保护](http://msdn.microsoft.com/en-us/library/ms229741.aspx)和[数据保护 API（Windows 应用商店应用程序）](http://msdn.microsoft.com/en-us/library/windows/apps/hh464970.aspx)。Michael Howard 和 David LeBlanc 在*[Writing Secure Code, Second Edition](http://www.microsoft.com/learning/en/us/book.aspx?id=5957)*中对这个主题进行了很好的处理。请参阅第 9 章，*保护机密数据*，从第 299 页开始。

如果您想要像加密一样的数据库，请查看[SQLCipher](http://sqlcipher.net/)。它使用经过身份验证的加密，因此它提供机密性和完整性。Windows 8 支持本地库，包括在他们的手机上（例如，参见[Windows Phone 8 上的本地代码](http://msdn.microsoft.com/en-us/library/windowsphone/develop/jj681687%28v=vs.105%29.aspx)）。

# php - $结果 = mysql_query()

> ID：15617824
> 
> 赞同：4
> 
> 时间：2013-03-25T14:46:48.380
> 
> 标签：php, mysql

我是 php/mysql 的新手，所以请原谅我在这里的知识水平，如果我正在做的事情已经过时，请随时指导我朝着更好的方向前进。

我正在从数据库中提取信息以填写登录页面。布局从左侧的图像和右侧的标题开始。在这里，我使用查询来检索页面标题文本：

```
<?php
$result = mysql_query("SELECT banner_headline FROM low_engagement WHERE thread_segment = 'a3'", $connection);
if(!$result) {
    die("Database query failed: " . mysql_error());
}
while ($row = mysql_fetch_array($result)) {
    echo $row["banner_headline"];
}
?> 
```

这很好用，但现在我想在**img alt**标签内复制标题文本。在 alt 标记内复制此查询信息的最佳方法是什么？是否有任何我可以使用的缩写代码，或者最好将此代码复制到 alt 标签内并运行两次？

感谢您的任何见解！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-25T14:57:32.223

正如评论所说，您正在使用不推荐使用的函数，但要回答您的问题，您应该声明一个变量来保存从数据库中检索到的值，以便您可以随时使用它。

```
<?php
$result = mysql_query("SELECT banner_headline FROM low_engagement WHERE thread_segment = 'a3'", $connection);
if(!$result) {
    die("Database query failed: " . mysql_error());
}

$bannerHeadline = "";

while ($row = mysql_fetch_array($result)) {
    $bannerHeadline = $row["banner_headline"];
}

echo $bannerHeadline; //use this wherever you want

?> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-25T14:58:30.377

如果不了解更多信息，很难提供帮助。您将结果泵入一个数组，您希望只返回一个结果还是多个`banner_headline`结果？如果您只会得到一个结果，那么您需要做的就是这样的事情：

PHP：

```
$result = mysql_query("
    SELECT `banner_headline`
    FROM `low_engagement`
    WHERE `thread_segment` = 'a3'", $connection) or die(mysql_error());
// This will get the zero index, meaning first result only
$alt = mysql_result($result,0,"banner_headline"); 
```

HTML：

```
<html>
<body>
<!--- Rest of code -->
<img src="" alt="<?php echo $alt ?>"> 
```

* * *

附带说明一下，您应该停止使用`mysql-*`函数，它们已被弃用。
你应该调查`PDO`或`mysqli`

# android - 共享偏好“限制”

> ID：15617825
> 
> 赞同：48
> 
> 时间：2013-03-25T14:46:50.860
> 
> 标签：android, sharedpreferences

我知道与这个问题类似的问题已经被问过很多次了，通过浏览所以我部分找到了答案，但并不完整，而且 android 文档并没有真正的帮助。显然我知道它们是如何工作的，并且以前曾多次使用过共享偏好，但我想知道什么时候（多少）太多了，我读过人们存储了 ~ 100KBS 没有任何问题。长话短说——是否有人在共享首选项中存储了太多数据，问题是什么，数据是否被删除？

** 这只是一个出于好奇的问题，我已经将我的大值存储在 SQL DB 中，只是想知道如果有人出于某种原因将所有内容存储在共享首选项中会出现什么问题以及是否会有任何问题

* * *

## 回答 #1

> 赞同：58
> 
> 时间：2013-03-25T15:21:43.653

由于`SharedPreferences`存储在 XML 文件中，因此缺乏 SQLite 的强大事务支持，我不建议将“100KBS”存储在`SharedPreferences`.

话虽如此，我知道的最小大小限制将是您的可用堆空间量，因为`SharedPreferences`将整个 XML 文件的内容读入内存。

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2015-06-04T08:27:52.220

SharedPreference 数据存在局限性。在我的情况下，当 SharedPreference 数据跨越 1428.51-kb 时，它会引发内存异常。

因此，当您需要存储大量数据时，最好使用 SQLite 数据库。

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2013-03-25T15:25:33.247

通过阅读您的问题，我认为您不应该使用 SharedPreferences，因为（a）它们旨在存储更少量的数据（因此使用 XML），并且（b）有许多简单的替代方案。

SharedPreferences 唯一“特别”的是与 Preferences Activity 的集成，用于向用户显示您的偏好，根据您计划存储的数量，这可能不适用于您的情况。（哦，SharePreferences 也为您处理并发问题。）

您可以使用 Java 的序列化将 Preference 类存储在二进制文件中。这些将比可比较的 PreferenceFile 小得多，并且可以轻松地通过 GZIPInputStream 传递以使其更小（或 CipherInputStream）以对其进行加密。我发现这种替代方法是一种强大、简单且跨平台的方式来存储不需要 SQLite 功能的应用程序数据。

（对不起，这不是一个直接的答案。）

# express - ExpressJS：使用 Javascript 将 Include 注入 Jade

> ID：15617826
> 
> 赞同：1
> 
> 时间：2013-03-25T14:46:51.540
> 
> 标签：express, pug

假设我有如下文件

包括/person.jade

```
.person
  .name= name
  .desc= desc 
```

现在我想在我的页面上有一个按钮，当点击它时，将前一个注入到文档中。我想要这个，因为我需要向页面添加人员。我该怎么做呢？

在这种情况下我应该只使用 HTML 文件吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-26T08:48:10.400

Jade 在服务器端渲染。因此，您应该使用将返回呈现的 html 的 ajax 调用方法。另一种选择是使用 JavaScript 执行此操作：

```
function addPerson(name, desc, parentId){
    var container = document.createElement('div');
    container.className = 'person';
    var nameContainer = document.createElement('div');
    nameContainer.className = 'name';
    nameContainer.innerHTML = name;
    container.appendChild(nameContainer);
    var descContainer = document.createElement('div');
    descContainer.className = 'desc';
    descContainer.innerHTML = desc;
    container.appendChild(descContainer);
    var parent = document.getElementById(parentId);
    parent.appendChild(container);
} 
```

玉：

```
#personContainer
input(onclick="addPerson('#{name}', '#{desc}', 'personContainer');", type="button") 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-30T17:40:19.713

与前面的示例类似，我使用 express 来托管 Jade HTML，以便在其自己的 url 中输入人员输入，如下所示......

```
self.app.get('/person/:name/:desc',adddoc.person2); 
```

当然 person2 的实现只是 Jade 的渲染。

```
.person
  mixin personField(desc,name,valuefname,valuelname) 
```

然后在我的 Javascript 中（使用 JQuery）

```
function stump(name, desc){
  $.get(
    "/person/"+desc+"/"+name,
    "{}",
    function(data) {
      var $parents = $( "#parents" );
      $parents.append($(data).filter('.person'));
    },
    "html"
  );
} 
```

# css - @font-face 不适用于 Chrome、Firefox、IE

> ID：15617828
> 
> 赞同：0
> 
> 时间：2013-03-25T14:46:53.503
> 
> 标签：css, fonts

这是我的 CSS 代码：

字体不工作。我错过了什么？

我想提一下，它没有安装在本地操作系统上，我确信 URL 会准确地转到字体

```
@font-face {
    font-family: 'ma';
    src: url('http://localhost/header/images/FS_Old.ttf');
}

.menu_head {
    width: 100%;
    position: relative;
    height: 30px;
    font-family: 'ma';
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-25T15:09:46.993

瑞恩是对的。我用一个有效的 URL 替换了你的 URL，它工作得很好。这是我用的。

```
 @font-face {
    font-family: 'ma';
    src: url('http://www.cse.buffalo.edu/~rsd7/BaroqueScript.ttf');
}

.menu_head {
    width: 100%;
    position: relative;
    height: 30px;
    font-family: 'ma';
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-25T15:10:49.657

应该是因为 Chrome、Firefox、IE 不支持`ttf`扩展。您可以尝试放置其他扩展名：

```
@font-face {
   font-family: 'ma';
   src: url('FS_Old.eot'); /* IE9 Compat Modes */
   src: url('FS_Old.eot?#iefix') format('embedded-opentype'), /* IE6-IE8 */
        url('FS_Old.ttf.woff') format('woff'), /* Modern Browsers */
        url('FS_Old.ttf.ttf')  format('truetype'), /* Safari, Android, iOS */
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-25T15:55:33.417

我使用该网站将字体转换为其他类型[http://www.fontsquirrel.com/tools/webfont-generator](http://www.fontsquirrel.com/tools/webfont-generator)并使用了不同的支持字体类型，这似乎解决了问题。这是适用于所有浏览器的新代码。

```
<html>
<head>
<style>

    @font-face {
    font-family: 'baroque_scriptregular';
    src: url('baroquescript.eot');
    src: url('baroquescript.eot?#iefix') format('embedded-opentype'),
         url('baroquescript.woff') format('woff'),
         url('baroquescript.ttf') format('truetype'),
         url('baroquescript.svg#baroque_scriptregular') format('svg');
    font-weight: normal;
    font-style: normal;

}

    .menu_head {
        width: 100%;
        position: relative;
        height: 30px;
        font-family: baroque_scriptregular;
    }
</style>
</head>
<body>
<div class="menu_head" >

    hellod
    </div>
</body> 
```

# wicket - Wicket DefaultDataTable - 在浏览器后退按钮上刷新它

> ID：15617829
> 
> 赞同：2
> 
> 时间：2013-03-25T14:46:59.413
> 
> 标签：wicket, wicket-1.5, wicketstuff

在我的应用程序中，我将 DefaultDataTable 与具有 LoadableDetachableModel 作为模型的 SortableDataProvider 一起使用。

我用它来显示一组记录（比如**RecordList**页面）。当我添加或删除一些记录并再次加载页面 **RecordList**时，它会显示更改。但是，如果我使用浏览器的后退按钮并转到之前租用的 **RecordList**页面（在添加/删除记录之前）。DefaultDataTable 仍然有旧的记录集。当记录被删除时，这是一个大问题。

例如，如果我删除一条记录并按下后退按钮，则页面将失败，因为它试图显示的记录在数据库中不存在。添加不会产生问题，因为它根本没有在记录集中列出。

在另一个页面中，我只有带有 LoadableDetachableModel 的 PageableListView。它工作正常，没有问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-27T11:26:46.587

对此，您可以做一两件事。

首先请检查数据提供者是否有最新的数据。

其次，确保在点击浏览器后退按钮时刷新数据提供者的记录集。确保提供给数据提供者的数据在构造函数之外的方法中刷新。因为当你回击时不会调用构造函数。因此，您需要使用单独的方法。理想情况下，您可以使用相同的方法，但从构造函数和按下后退按钮时调用。

# objective-c - 数千次使用可可的 performSelectorOnMainThread 的安全性

> ID：15617830
> 
> 赞同：1
> 
> 时间：2013-03-25T14:46:59.633
> 
> 标签：objective-c, multithreading, cocoa

在我的应用程序中，我有一个工作线程，它围绕着做大量的处理。在处理过程中，它会将更新发送到使用信息更新 GUI 元素的主线程。这是用`performSelectorOnMainThread`. 为简化代码，对这些更新没有限制，它们以高速率（每秒数百或数千）发送，并且`waitUntilDone`是`false`. 调用的方法只是获取变量并将其复制到视图控制器的私有成员。其中一些直接更新GUI（因为我很懒！）。每隔几秒钟，工作线程调用一次`performSelectorOnMainThread`，`waitUntilDone`设置为`true`（这与保存当前计算批处理的输出有关）。

我的问题：这是安全使用`performSelectorOnMainThread`吗？我问是因为我最近遇到了一个问题，即我的显示值停止更新，尽管后台线程继续工作而没有问题（并产生正确的输出）。由于它们以这种方式被馈送值，我想知道它是否可能达到了消息数量的限制。我已经检查了常见的问题（溢出、泄漏等），一切都很干净。但是，我无法重现该问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-25T15:41:16.890

> 为简化代码，对这些更新没有限制，它们以高速率（每秒数百或数千）发送，waitUntilDone 为假。

是的。不要那样做。甚至不是为了在内部应用程序中的懒惰。

除了使主运行循环无响应之外，它还可能导致各种潜在问题。

最重要的是，它会使您的工作线程因 CPU 周期而饿死，因为您的主线程会不断旋转，试图在消息到达时尽快更新 UI。鉴于绘图通常在辅助线程中完成，这可能会导致更多的线程争用，从而进一步减慢速度。

其次，所有这些消息都会消耗资源。可能有很多，也可能是相对稀缺的，具体取决于实施细节。

虽然不应该有一个限制，但可能有一个实际限制，当超过这个限制时，事情就会停止工作。如果是这种情况，这将是系统中的一个错误，但除了控制台日志显示“消息太多，速度太快，减少。”之外，不太可能修复这个错误。

不过，它也可能是您的代码中的错误。线程之间的状态转移是一个充满陷阱的领域。您确定您的跨线程通信代码是防弹的吗？（而且，如果它是防弹的，它很可能会为您的数千/秒更新通知带来巨大的性能成本）。

限制更新并不难。虽然评论的建议都是合理的，但它可以更容易地完成（NSNotificationQueue 很棒，但可能会过度杀伤，除非您从计算中的许多不同位置更新主线程）。

*   每当您通知主线程并将日期存储在 ivar 中时创建一个 NSDate
*   下次去通知主线程，检查是否超过N秒
*   如果有，请更新您的 ivar
*   [奖励性能] 如果所有日期比较都太昂贵，请考虑重新访问您的算法以将“立即更新”触发器移动到不那么频繁的地方。除此之外，创建一个 int ivar 计数器，并且只检查每 N 次迭代的日期

# php - 如何在循环中为图像添加不同的“标题”标签？

> ID：15617833
> 
> 赞同：0
> 
> 时间：2013-03-25T14:47:07.497
> 
> 标签：php, jquery, wordpress

我正在尝试将帖子标题作为标题标签添加到图像（实际上是自定义字段）。我尝试使用 each() 函数没有成功，但也许解决方案将来自 php ？这是我尝试过的事情之一：

```
$('.front a img').each(function(){
var frontvalue = '<?php the_title_attribute(); ?>';
$(this).attr('title',frontvalue);
}); 
```

提前致谢 ！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-25T15:03:04.947

在循环内，您可以执行以下操作：

```
<img src="image.jpg" alt="<?php echo get_the_title();?>"> 
```

或使用自定义字段：

```
<img src="<?php echo get_post_meta(get_the_ID(), "yourCustomFieldName", true);?>" alt="<?php the_title();?>"> 
```

* * *

在您的特定情况下，您可以删除最后一个右括号，然后附加 alt 属性：

```
<?php
$From = substr(trim($From),0,-1);        //cut the last char
$From .= ' alt="'.get_the_title().'">';  //append the title
?> 
```

或者更好的是，如果它是旧类型的自定义字段，请提取 url，但不要触摸新类型的自定义字段（这只是 url）

```
if(substr(trim($From),0,5) == '<img '){  //is this an img tag i see?
  $boom = explode('"', $From, 3);        //it is, aim for the quotes
  $From = $boom[1];                      //salvage the url
} 
```

然后从那里重建你的 img 标签。如果旧格式不同于[：](http://www.php.net/manual/en/function.explode.php)

```
<img src="xxxxxx"> 
```

# .net - Inno Setup 运行 setup.exe 时修改 app.config 文件

> ID：15617834
> 
> 赞同：6
> 
> 时间：2013-03-25T14:47:08.317
> 
> 标签：.net, wcf, web-services, c#-4.0, inno-setup

我有一个作为 Windows 服务托管的 WCF 服务。我通常会去VS命令提示符并使用installutil.exe安装服务，然后根据我正在安装它的机器名称修改app.config中服务的基地址并运行服务。

基地址是这样的：

```
<endpoint address="http://MACHINE_NAME/NFCReader/" binding="webHttpBinding"/> 
```

我修改了 app.config 文件中的 MACHINE_NAME。

我想使用 inno setup 为我做同样的事情。

我想要的是当用户运行 setup.exe 文件来安装服务时，我想提示用户输入服务的基地址并使用该地址来托管它。我无法弄清楚是否有可能或如何去做。

请问有什么帮助吗？提前致谢。:)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-25T14:57:52.820

只是我用来替换我的应用程序配置中的字符串的一个例子。
我相信它可以做得更好:-)

我替换的是：

添加键="AppVersion" 值="YYMMDD.HH.MM"

```
[Code]
procedure Update;
var
C: AnsiString;
CU: String;
begin
        LoadStringFromFile(ExpandConstant('{src}\CdpDownloader.exe_base.config'), C);
        CU := C;
        StringChange(CU, 'YYMMDD.HH.MM', GetDateTimeString('yymmdd/hh:nn', '.', '.'));
        C := CU;
        SaveStringToFile(ExpandConstant('{src}\Config\CdpDownloader.exe.config'), C, False);          
end;

function InitializeSetup: Boolean;
begin
  Update;
result := True;
end; 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-25T18:13:01.673

我建议您使用 XML 解析器来更新您的配置文件。以下功能可以帮助您。它使用 MSXML 作为文件解析器：

```
[Code]
const
  ConfigEndpointPath = '//configuration/system.serviceModel/client/endpoint';

function ChangeEndpointAddress(const FileName, Address: string): Boolean;
var
  XMLNode: Variant;
  XMLDocument: Variant;  
begin
  Result := False;
  XMLDocument := CreateOleObject('Msxml2.DOMDocument.6.0');
  try
    XMLDocument.async := False;
    XMLDocument.preserveWhiteSpace := True;
    XMLDocument.load(FileName);    
    if (XMLDocument.parseError.errorCode <> 0) then
      RaiseException(XMLDocument.parseError.reason)
    else
    begin
      XMLDocument.setProperty('SelectionLanguage', 'XPath');
      XMLNode := XMLDocument.selectSingleNode(ConfigEndpointPath);
      XMLNode.setAttribute('address', Address);
      XMLDocument.save(FileName);
      Result := True;
    end;
  except
    MsgBox('An error occured during processing application ' +
      'config file!' + #13#10 + GetExceptionMessage, mbError, MB_OK);
  end;
end; 
```

# sql - 降低 SQL 查询的 CPU 成本

> ID：15617845
> 
> 赞同：1
> 
> 时间：2013-03-25T14:47:23.833
> 
> 标签：sql, sql-server-2008, query-optimization

我有一个如下查询，其中 table150k 有 150k 条记录，而 table3m 有 3m 条记录。在我们的生产服务器上，我们必须非常频繁地一次针对一条记录运行此查询。这会消耗大量的 CPU 功率。

```
select t.id, t1.field1 as f1, t2.field1 as f2, t3.field1 as f3, ..., t12.field1 as f12
from table150k t
inner join table3m t1 on t1.fk = t.id and t1.[type] = 1
inner join table3m t2 on t2.fk = t.id and t2.[type] = 2
inner join table3m t3 on t3.fk = t.id and t3.[type] = 3
...
inner join table3m t12 on t12.fk = t.id and t12.[type] = 12
where t.id = @id 
```

当我从此查询中删除内部联接时，它工作正常。当它们被包含在内时，我们的服务器会受到 CPU 的影响。

我应该如何优化这个查询、数据结构或场景，以使频繁获取数据的 CPU 成本不那么高？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-25T14:50:14.233

你有索引`table3m(fk)`吗？

那应该可以解决您的问题。

另一种表述是：

```
select t.id,
       max(case when m.[type] = 1 then field end) as field1,
       max(case when m.[type] = 2 then field end) as field2,
       . . .
       max(case when m.[type] = 12 then field end) as field12
from table150k t join
     table3m m
     on m.fk = t.id and m.[type] in (1,2,3,4,5,6,7,8,9,10,11,12)
where t.id = @id
group by t.id 
```

此结构的所有数据都来自“3m”表中的同一列。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-25T14:51:06.773

如果两个表中的数据不经常更改，我会按照另一种方法创建一个缓存表（只是另一个表），它只保存上述查询的结果。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-25T14:51:47.613

Try this:

```
select *
from table150k t
inner join table3m t1 on t1.fk = t.id and t1.[type] in (1,2,3,4,5,6,7,8,9,10,11,12)
where t.id = @id 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-25T15:06:07.617

```
select t.id, t1.type, t1.field1
from table150k as t
inner join table3m as t1 on t1.fk = t.id 
where t.id = @id and t1.[type] in (1,2,3,4,5,6,7,8,9,10,11,12) 
```

这将带回 12 条记录（假设它们都存在）。

这里的优点是服务器端的速度，缺点是一旦将每个记录放入应用程序中，就必须根据类型值将每条记录映射到数据表中的相应列或对象上的值。

# java - 运行批处理命令卡在 Runtime.exec.waitFor()

> ID：15617847
> 
> 赞同：2
> 
> 时间：2013-03-25T14:47:29.080
> 
> 标签：java, runtime.exec, thread-sleep

我从 Java 运行一个批处理命令，如下所示：

```
String command ="cmd /c " + mPathToZip + " a -tzip " + source
            + "foo.zip " + source + "* && exit";
    try {
        Runtime.getRuntime().exec(command).waitFor();
    } catch (IOException e) { // TODO Auto-generated catch block
        e.printStackTrace();
    } catch (InterruptedException e) {
        // TODO Auto-generated catch block
        e.printStackTrace();
    } 
```

所以基本上我需要它来运行命令并等到它完成后再做其他事情。

问题是 JVM 卡在 Runtime.getRuntime().exec(command).waitFor();

我在解压缩某些东西时已经尝试过这个并且工作正常，但是现在当我压缩某些东西时它会卡住。另外，我已经手动尝试了该命令并且它有效。

感谢任何帮助，因为我是线程新手。

# android - Android GridLayout 和 EditText

> ID：15617849
> 
> 赞同：3
> 
> 时间：2013-03-25T14:47:31.080
> 
> 标签：android, android-edittext, grid-layout

一张图抵万字。: ) 右上角显示不正确。谢谢！

```
 <RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
xmlns:tools="http://schemas.android.com/tools"
android:layout_width="match_parent"
android:layout_height="match_parent"
android:layout_margin="15dp"
tools:context=".MainActivity" >

                    <GridLayout
                         android:layout_width="fill_parent"
                         android:layout_height="fill_parent"
                         android:columnCount="2"
                         android:rowCount="2"
                         android:layout_weight="6" >

                         <TextView 
                             android:text="Blala:"
                             android:layout_weight="1"
                              />
                         <EditText 
                             android:layout_width="fill_parent"
                             android:layout_height="wrap_content"
                             android:layout_gravity="center"
                             android:singleLine="true"
                             android:layout_weight="2"
                             />
                         <TextView 
                             android:text="Blalalallalalalalallaa:"
                             android:layout_weight="1"
                              />
                         <EditText 
                             android:layout_width="fill_parent"
                             android:layout_height="wrap_content"
                             android:singleLine="true"
                             android:layout_weight="2" />
                     </GridLayout> 
```

更新：权重 ![在此处输入图像描述](../Images/8ec0e98958a7216942cfc32367b76e44.png)

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-03-27T08:47:13.807

回答：

您可以使用下一个布局：

```
<GridLayout xmlns:android="http://schemas.android.com/apk/res/android" 
android:layout_width="fill_parent" 
android:layout_height="fill_parent" 
android:columnCount="2" 
>
<TextView
android:text="Blala:" 
android:layout_row="0" 
android:layout_gravity="fill_horizontal" 
/>
<EditText
android:singleLine="true" 
android:layout_gravity="fill_horizontal" 
/>
<TextView
android:text="Blal234243a:" 
android:layout_row="0" 
android:layout_gravity="fill_horizontal" 
/>
<EditText
android:singleLine="true" 
android:layout_gravity="fill_horizontal" 
/>

</GridLayout> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-25T15:30:42.420

任一属性都可以应用于 View 的（视觉控制）水平或垂直尺寸。它用于根据其内容或其父布局的大小设置视图或布局大小，而不是显式指定维度。

fill_parent（在 API 级别 8 及更高版本中已弃用并重命名为 MATCH_PARENT）

将小部件的布局设置为 fill_parent 将强制它展开以占用它所在的布局元素中的可用空间。这大致相当于将 Windows 窗体控件的停靠样式设置为填充。

将顶级布局或控件设置为 fill_parent 将强制它占据整个屏幕。

包装内容

将 View 的大小设置为 wrap_content 将强制它仅扩展到足以包含它所包含的值（或子控件）的程度。对于控件——如文本框 (TextView) 或图像 (ImageView)——这将包装正在显示的文本或图像。对于布局元素，它将调整布局大小以适应作为其子元素添加的控件/布局。

它大致相当于将 Windows 窗体控件的 Autosize 属性设置为 True。

# user-interface - 状态GUI划分

> ID：15617850
> 
> 赞同：1
> 
> 时间：2013-03-25T14:47:35.563
> 
> 标签：user-interface, sap, status

我想知道我必须在状态 GUI 中写入/输入什么，这样我才能得到一个除法管道。它应该如下所示： ![在此处输入图像描述](../Images/f20ca72102f541148ca746f010b446db.png)

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-25T14:54:12.827

我找到了答案，左键单击该字段并选择“分隔线”。

还是非常感谢。

# java - 如何使用 Java Servlet 将图像从 Mongo DB 发送到 Ext JS

> ID：15617852
> 
> 赞同：0
> 
> 时间：2013-03-25T14:47:40.853
> 
> 标签：java, servlets, extjs, extjs4

我有一个 Java Servlet，它试图将图像从 Mongo DB 发送到 Ext JS：

```
@Override
protected void doGet(HttpServletRequest req, HttpServletResponse resp) throws ServletException, IOException {

    String action = req.getParameter("action");

    if (action != null && action.equals("download")) {

        resp.setContentType("text/html");
        resp.setHeader("Content-Disposition", "attachment;filename=" + "images.jpg");

        try {
            DB db = DataBaseMongoService.getDb("forum_images"); //class that manages Mongo DB access
            GridFS gfs = new GridFS(db, "image");
            GridFSDBFile imageForOutput = gfs.findOne("images.jpg");

            InputStream in = imageForOutput.getInputStream();

            ServletOutputStream out = resp.getOutputStream();
            out.write(IOUtils.toByteArray(in));
            out.flush();
            in.close();
            out.close();

        } catch (UnknownHostException e) {
            e.printStackTrace();
        } catch (NamingException e) {
            e.printStackTrace();
        }
    }
} 
```

我的 Ext JS 调用如下所示：

```
Ext.Ajax.request({
url: 'ForumImageServlet',
method: 'GET',
params: {
    action: 'download'
},}); 
```

响应是图像的字节流，如下所示：

```
ï¿½ï¿½ï¿½ï¿½JFIFï¿½ï¿½ï¿½ "" $(4,$&1'-=-157:::#+?D?8C49:77%w777777777777777777777777777777777777777777777777ï¿½ï¿½Pp"ï¿½ï¿½ï... 
```

如何获得真实图像作为对我的 servlet 的响应？提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-27T06:52:54.713

你为什么要`ContentType`设置`text/html`？

尝试使用`image/jpg`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-27T19:52:12.110

您可以注入一个带有 src 属性的 img-tag，而不是使用 ajax 请求。当您提供正确的 mime 类型时，您的浏览器会加载图像

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-27T11:25:13.340

最终的解决方案是将字节流编码为 base64：

```
 byte[] buf = IOUtils.toByteArray(in);

        String prefix = "{\"url\":\"data:image/jpeg;base64,";
        String postfix = "\"}";
        String fileJson = prefix + Base64.encodeBytes(buf).replaceAll("\n", "") + postfix; 
        PrintWriter out = resp.getWriter();
        out.write(fileJson);
        out.flush();
        in.close();
        out.close(); 
```

# javascript - 带有 Apache 2 代理重写规则和 Plone 的 Javascript

> ID：15617854
> 
> 赞同：0
> 
> 时间：2013-03-25T14:47:48.653
> 
> 标签：javascript, proxy, apache2, rewrite, plone

我有一个 Plone 站点和 Apache2 代理服务器，它有两个使用 java 脚本的网页。在没有 Apache 2 代理服务器的情况下，该 Plone 站点和 Java 脚本功能正确。Plone 在代理服务器后面的 Web Plone 页面上运行正常。但是，JavaScript 无法与 Apache 代理服务器一起正常工作。请参阅下面的 Apache 访问日志。我相信原因与 Javascript 尝试发布到错误的位置有关。如果您查看 GET 服务，我相信 POST 是从 java 脚本返回的，并且它正在发布到服务/服务。那么有人会有正确的 Apache 重写来纠正这个问题的想法吗？下面贴出的是我一直在尝试的规则。

```
My host - - [24/Mar/2013:21:16:16 -0400] **"GET /services** HTTP/1.0" 200 19149 "http://rcms.xxxx.com/our-team" "Mozilla/5.0 (Windows NT 6.0; WOW64) AppleWebKit/537.22 (KHTML, like Gecko) Chrome/25.0.1364.172 Safari/537.22"
184.56.129.45 - - [24/Mar/2013:21:16:17 -0400] "GET /portal_css/HedDex%20Tranquility%20Plone3%20Theme/resourceplone.app.jquerytools.overlays-cachekey8212.css HTTP/1.0" 200 2023 "http://rcms.xxxx.com/" "Mozilla/5.0 (Windows NT 6.0; WOW64) AppleWebKit/537.22 (KHTML, like Gecko) Chrome/25.0.1364.172 Safari/537.22"
My Host - - [24/Mar/2013:21:16:18 -0400] "POST **/services/services/@@merged**Request/getMergedData HTTP/1.0" 200 16826 "http://rcms.xxxx.com/services" "Mozilla/5.0 (Windows NT 6.0; WOW64) AppleWebKit/537.22 (KHTML, like Gecko) Chrome/25.0.1364.172 Safari/537.22" 
```

规则：

```
RewriteRule ^/(.*)$
balancer://lbesa/siteX/rbt/VirtualHostBase/http/rcms.xxxx.com:80/siteX/rdt/VirtualHostRoot/$1 [L,P]

ProxyPassReverse /services/
balancer://lbesa/VirtualHostBase/http/rcms.xxxx.com:80/siteX/rdt/VirtualHostRoot/services/services/ 
```

# eclipse - 将 jars 添加到 Tomcat 类路径

> ID：15617855
> 
> 赞同：0
> 
> 时间：2013-03-25T14:47:53.790
> 
> 标签：eclipse, tomcat, dependencies, war

我有一个在 Tomcat 上运行的 Eclipse 项目，我的依赖项 jar 位于 WEB-INF/lib 目录中。一切都很好。但是导出时创建的war文件很大，我需要将它来回发送到测试服务器，这将非常耗时。这似乎是一种浪费。

因此，我将所有依赖项 jar 放在我的文件系统中的一个文件夹 dependency_jars 中，并将构建配置为指向那里。构建工作，但是当我运行它（仍然在我的本地机器上）时，应用程序抛出运行时错误。

环顾四周，我转到项目属性并将 jars 添加到 Web 部署程序集。现在运行时可以工作了，但是导出的战争再次将所有的 jar 打包在一起。

那么我如何让我的依赖项可用于运行时环境，而不需要 Eclipse 将它们打包到战争中呢？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-27T16:10:44.017

好的，我不确定这是最优雅的解决方案，但我所做的是将 Tomcat 配置为使用外部库，将依赖项 jar 放在那里，然后让 eclipse 用其中的所有内容创建战争，从命令行爆炸，去掉依赖jar，重新打包war，最后发送出去。

好吧，绝对不是一个优雅的解决方案。但它有效。以下是步骤：

1.  配置 Tomcat 以使用外部资源库。转到 tomcat_home/conf/catalina.properties 并在以“定义“通用”类加载器内容的逗号分隔路径列表...”开头的注释下添加您的目录

2.  通过 Eclipse 导出战争。

3.  引爆战争（双关语可能值得在这里：） jar -xvf MyWar.war

4.  删除您的依赖项 jars（现在位于上述步骤 1 的外部目录中。）

5.  重新打包战争：jar cvf MyWar.war WEB-INF

# java - 如何检查点是否在对角线周围的矩形内？

> ID：15617856
> 
> 赞同：1
> 
> 时间：2013-03-25T14:47:55.540
> 
> 标签：java, gwt, vector, java-canvas

首先：我知道我可以计算从 a`point`到 a的距离`line`来检查该点是否在线。这就是我为检测`offset`一行上的点击（带有 ）所做的。

但在此之前，我想对`diagonal line`. 带有起点和终点的线本身定义了一个矩形区域：

```
Pstart(sx, sy), Pend(ex, ey). 
```

我可以使用边界检查来确定是否在`Point(px, py)`里面`rectangle`：

```
sx <= px && ex >= px && sy <= px && ey >= py 
```

但这仅适用于线条从左上角到右下角的情况。如果它走向不同的方向，我必须修改算法。无论线方向如何，我如何使用上面的公式？

我怎样才能得到公式来相应地尊重方向？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-25T14:50:16.210

只需比较`Math.min(sx, ex) <= px <= Math.max(sx, ex)`尺寸`y`即可。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-25T14:52:05.483

[Line2D.ptSegDist(x1, y1, x2, y2, xP, yP)](http://docs.oracle.com/javase/1.5.0/docs/api/java/awt/geom/Line2D.html#ptSegDist%28double,%20double,%20double,%20double,%20double,%20double%29) returns 0.0 iff the point (xP, yP) is on the line segment from (x1, y1) to (x2, y2). [Line2D.ptLineDist](http://docs.oracle.com/javase/1.5.0/docs/api/java/awt/geom/Line2D.html#ptLineDist%28double,%20double%29) does the same thing for the infinite line.

# visual-studio-2010 - 如何向 Visual Studio 解决方案资源管理器添加操作？

> ID：15617861
> 
> 赞同：0
> 
> 时间：2013-03-25T14:48:06.337
> 
> 标签：visual-studio-2010, visual-studio-2008

请让我知道如何在 Visual Studio 的“解决方案资源管理器”的上下文菜单中添加操作？

我想将我的操作添加到此资源管理器中列出的文件的上下文菜单中（例如，请参见屏幕截图），然后能够启动我的应用程序（EXE 文件），该应用程序可以获取文件名（包括其路径）为一个论点。

我目前使用 VS2008，但是请让我知道 VS2010 和 VS2012 是否应该有所不同。

![在此处输入图像描述](../Images/763036ec8b71dbe6de247bf24cb5742b.png)

谢谢你

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-25T14:58:52.673

编写您自己的[视觉工作室加载项](http://www.codeproject.com/Articles/42876/Boosting-Developer-Productivity-by-Writing-Extensi)，看看那个链接，这是一个很好的起点。但这并不容易...

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-25T16:02:12.563

您将不得不编写一个 Visual Studio 加载项。

查看codeplex 上[Xsd2Code](http://xsd2code.codeplex.com/)插件的代码。特别是[Connect 类](http://xsd2code.codeplex.com/SourceControl/changeset/view/99803#1382412)。此插件的功能与您想要的类似...它添加了一个上下文菜单选项，当您右键单击项目项时可用（在这种情况下，仅对 .xsd 文件启用）。

此外，请查看[Visual Studio 2005 自动化示例](http://www.microsoft.com/en-us/download/details.aspx?id=9122)下载中的**解决方案资源管理器上下文菜单**示例。

# node.js - 对 mongoose 执行 find() 时找到的每个文档执行回调

> ID：15617864
> 
> 赞同：2
> 
> 时间：2013-03-25T14:48:07.870
> 
> 标签：node.js, mongodb, mongoose

我有：

```
Emotion.find (query, "-_id", opts, function (error, e){
    if (error) return cb (error, 500);
    for (var i=0, len=e.length; i<len; i++){
        e[i] = convert (e[i]);
    }
    cb (null, e);
}); 
```

如果函数返回 1k 个文档，我必须迭代 1k 次。

如何添加为每个文档执行的回调？就像是：

```
var each = function (e){
    return convert (e);
};

Emotion.find (query, "-_id", opts, each, function (error, e){
    if (error) return cb (error, 500);
    cb (null, e);
}); 
```

我基本上需要使用来自 mongodb 的 each()：http: [//mongodb.github.com/node-mongodb-native/api-generated/cursor.html#each](http://mongodb.github.com/node-mongodb-native/api-generated/cursor.html#each)

* * *

编辑：也许这可以通过从流中侦听数据事件并将文档推送到数组来完成：

[http://mongoosejs.com/docs/api.html#query_Query-stream](http://mongoosejs.com/docs/api.html#query_Query-stream)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-25T15:17:40.103

正如我所说，使用流：

```
var emotions = [];

Emotion.find (query, "-_id", opts).stream ()
        .on ("error", function (error){
            cb (error, 500);
        })
        .on ("data", function (doc){
            emotions.push (convert (doc));
        })
        .on ("close", function (){
            cb (null, emotions)
        }); 
```

* * *

编辑：上述解决方案比这慢得多：

```
var emotions = [];

//Get the collection... then:

collection.find (query, opts, function (error, cursor){
    if (error) return cb (error, 500);

    cursor.each (function (error, doc){
        if (error) return cb (error, 500);
        if (!doc) return cb (null, emotions);
        emotions.push (convert (doc));
    });
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-25T15:04:57.707

似乎您可以使用[查询流](http://mongoosejs.com/docs/api.html#query_Query-stream)来做您想做的事 - 但是，即使使用`each()`某种调用，您本质上仍然在迭代所有返回的文档，只需使用一点语法糖。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2017-11-21T11:27:35.250

mongoose/eachAsync 的简单示例代码对这种情况很有用：

```
functionProcess = (callback) => {

  userModel.find().cursor().eachAsync(user => {
    return user.save().exec();        // Need promise
  }).then(callback);     //Final loop

} 
```

# javascript - jquery validate .resetForm() 不清除表单，验证消息在手动重置时触发

> ID：15617865
> 
> 赞同：1
> 
> 时间：2013-03-25T14:48:09.627
> 
> 标签：javascript, jquery, jquery-plugins

我有几个按钮，将不同的参数传递给相同的功能。该函数最终将进行大量客户端处理，但首先需要验证。验证工作正常，但成功后，我需要重置表单。在我下面的小提琴中，您可以看到 .resetForm() 调用什么也不做，如果我手动清除该字段，它会引发验证错误，就像我试图提交一样。

看我的小提琴：http: [//jsfiddle.net/uT6pw/10/](http://jsfiddle.net/uT6pw/10/)

html:

```
 <form id="frm" method="post" onsubmit="return false;">
         <input type="text" id="FName" class="required">
         <span class="field-validation-valid" data-valmsg-for="FName" data-valmsg-replace="true"></span>    
         <button id="btn1" onclick="addContact('1')">1</button>
         <button id="btn2" onclick="addContact('2')">2</button>
         <button id="btn3" onclick="addContact('3')">3</button>
    </form> 
```

javascript:

```
function addContact(num){
    var v = $("#frm").validate()
    if (v.form())
    {
        v.resetForm();
        //$("#frm").validate().resetForm()
        $("#FName").val('');
    }
} 
```

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-25T14:53:23.600

我还没有听说过resetForm，试试这个：

```
form.reset(); 
```

**更新**：您有发布表单的按钮标签，这就是单击它们时表单得到验证的原因。而是`<button>`改为`<input type="button"/>`

[见小提琴](http://jsfiddle.net/uT6pw/13/)

# android - Android webView 缩小

> ID：15617866
> 
> 赞同：0
> 
> 时间：2013-03-25T14:48:09.667
> 
> 标签：android, android-webview

我想在 web 视图中显示谷歌开发者控制台。问题是最小缩放真的很大。

使用此代码，我可以很好地放大网站，但不能缩小。

这

```
 webView.setInitialScale(50); 
```

字符串允许在加载时显示缩小的页面，但是一旦我捏缩放网页就会缩放到大页面并且我不能再次缩小。

```
 @Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);

    webView = new WebView(this);
    webView.setInitialScale(50);
    webView.getSettings().setBuiltInZoomControls(true);
    webView.getSettings().setJavaScriptEnabled(true);

    setContentView(webView);

    final Activity activity = this;
webView.setWebViewClient(new WebViewClient() {
        public void onReceivedError(WebView view, int errorCode, String description, String failingUrl) {
            Toast.makeText(activity, "Oh no! " + description, Toast.LENGTH_SHORT).show();
        }
    });

    webView.loadUrl("https://play.google.com/apps/publish/");
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-05-03T03:23:24.530

你找到答案了吗？我也遇到这个问题。使用它可能会对您有所帮助。但我需要设置初始比例。

```
 webView.getSettings().setUseWideViewPort(true);
             webView.getSettings().setLoadWithOverviewMode(true); 
```

# python - CondingBat Python 拼图导致“超时”

> ID：15617869
> 
> 赞同：2
> 
> 时间：2013-03-25T14:48:24.217
> 
> 标签：python

我正在尝试解决这个 CodingBat 问题：

> 我们想做一包目标公斤的巧克力。我们有小条（每条 1 公斤）和大条（每条 5 公斤）。返回要使用的小柱的数量，假设我们总是在小柱之前使用大柱。如果无法完成，则返回 -1。

我理解问题的逻辑，但每当我尝试运行它时，都会出现超时异常。那么谁能告诉我我做错了什么？

```
def make_chocolate(small, big, goal):

  total = 0

  if goal < 5:
    big = 0
  for i in xrange(big):
    total += 5
    if total == goal:
      return 0
    elif total+5>goal:
      break
  for k in xrange(small):
    total +=1
    if total == goal:
      return (k+1)

  return -1 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-12-20T01:21:36.473

失败是由执行此测试所需的时间引起的：

```
makeChocolate(1000, 1000000, 5000006) 
```

即使其他测试可以通过，一旦一个测试超时，报告会将所有测试显示为超时。要看到这是真的，请更改`xrange(big)`为`xrange(big if big < 101 else 0)`，您将看到除上述测试之外的所有测试通过。

出于性能原因，基于 Web 的评估器需要像这样的超时。一定是 Python 超时允许的循环少于 Java 超时。

这是通过的非循环解决方案：

```
def make_chocolate(small, big, goal):
    big *= 5
    if big + small < goal or small < goal%5:
        return -1
    small = goal - big
    return small%5 if small < 0 else small 
```

Java 需要一个稍微不同的解决方案，因为它如何处理负数的模数。

```
public int makeChocolate(int small, int big, int goal) {
    big *= 5;
    if (big + small < goal || small < goal%5)
        return -1;
    small = goal - big;
    return small < 0 ? (big+small)%5 : small;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-08-28T05:46:37.530

你可以简单地这样做：

```
def make_chocolate(small, big, goal):
    noOfBigs = big if(5 * big <= goal) else goal / 5
    return  goal - (noOfBigs * 5)  if small >= (goal - (noOfBigs * 5)) else -1 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-12-03T03:42:20.103

如果您首先将 Big value 减少到您实际使用的数字，这似乎是更清晰的逻辑：

```
def make_chocolate(small, big, goal):
  while big * 5 > goal:
    big -= 1
  if (goal - (big * 5)) <= small:
    return goal - (big * 5)
  else:
    return -1 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-03-12T16:49:11.730

This is clunky, but it works:

```
def make_chocolate(small, big, goal):
    bigbars=goal//5
    if bigbars<=big:
        smallgoal=goal-(bigbars*5)
        if smallgoal>=0 and smallgoal<=small:
            return smallgoal
        if smallgoal>small:
            return -1
    if bigbars>big:
        smallgoal=goal-(big*5)
        if smallgoal<=small:
            return smallgoal
        if smallgoal>small:
            return -1 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-10-15T15:52:35.090

```
def make_chocolate(small, big, goal):  
    big = big*5  
    if (goal >= big) and (small >= goal - big):  
        return goal - big  
    if (goal < big) and (small >= goal % 5):  
        return goal % 5  
    return -1 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2019-02-16T15:04:50.250

```
def make_chocolate(small,big,goal):
    if goal > small + big * 5:
        return -1
    else:
        if goal % 5 <= small:
            if big * 5 <=goal:
                return goal - (big * 5)
            else:
                return goal % 5
        else:
            return -1 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2018-12-24T12:19:39.000

```
def make_chocolate(small, big, goal):
  i = goal // 5
  b_big = big*5
  x = i*5
  y = goal - x

  if big == 0:
    if small >= goal:
      return small - (goal - small)
    else:
      return -1
  elif b_big == goal:
    return 0
  elif big >= i:
    if x + small < goal:
      return -1 
    else:
      return (goal - (x))
  else:
    if b_big + small < goal:
      return -1
    else:
      return(goal - b_big) 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2022-02-23T02:03:11.680

```
def make_chocolate(small, big, goal):
  if(goal>=big*5) and(small+big*5>=goal) and (goal%5 <=small):
     rem_cho=abs(goal-big*5)
     return(rem_cho)
  elif(goal%5>small):
     return(-1)
  elif(goal<big*5):
     return(goal%5)
  else:
     return(-1) 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2017-03-07T07:41:23.383

以下代码适用于所有测试数据。对不起，由于它是自我解释的，我没有提供任何解释。

```
def make_chocolate(small, big, goal):
    s = small*1
    b = big*5
    mod = goal%5
    if b < goal:
        if s+b == goal:
            return s
        elif s+b > goal:
            return goal-b
        elif s+b < goal:
            return -1
    elif b > goal:
        if s < mod:
            return -1
        return mod
    elif b == goal:
        return 0 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2020-06-06T07:18:11.577

```
def make_chocolate(small, big, goal):
    can_do = small + 5*big
    if can_do<goal:
        return -1
    elif can_do==goal:
        return small
    else:
        b_max = goal/5
        b_max = b_max if b_max<=big else big
        s_req = goal - (b_max)*5
        if s_req <= small:
            return s_req
        else:
            return -1 
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2018-08-09T10:00:55.533

```
 def make_chocolate(small, big, goal):
  s_cnt = 0;
  t = goal;
  for i in range(**550**):
    if(goal >= 5 and big > 0):
        goal = goal-5;
        big = big-1;
    elif(goal > 0 and small > 0):
        goal = goal-1;
        small = small-1;
        s_cnt = s_cnt+1;

  if (goal == 0):
    return s_cnt;
  else:
    return -1; 
```

// 在大写字母范围（550）中，您可以看到我已经对其进行了硬编码，因为对于较大的值，它将使循环运行时间过长，因此您会收到超时错误。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2020-05-28T18:17:19.613

```
def make_chocolate(small, big, goal):
    if goal - 5 * big == 0:
        return 0
    elif (goal - 5 * big) < 0:
        return -1 if (goal % 5) > small else goal % 5
    elif (goal - 5 * big) > small:
        return -1
    else:
        return (goal - 5 * big) 
```

* * *

## 回答 #13

> 赞同：-1
> 
> 时间：2015-07-27T06:52:28.117

```
def make_chocolate(small, big, goal):        
  while big*5>goal:
    if goal%5==0:
      return 0
    else:
      if goal%5<=small:
        return goal%5
      else:
        return -1
    else:
      if goal-(big*5)<=small:
        return goal-(big*5)
      else:
        return -1 
```

* * *

## 回答 #14

> 赞同：-1
> 
> 时间：2017-01-27T14:46:29.963

```
def permutations(amount, size, threshold):

if amount == 1:
      return size
  combinations = []
  for i in range(1, amount + 1):
    combinations.append(size * i)
  if combinations[-1] == threshold:
      return combinations[-1]
  elif combinations[-1] > threshold:
      if size == 1:
        return combinations[-1] - threshold
      elif size == 5:
        return combinations[-2]
  else:
      return combinations

def make_chocolate(small_amount, big_amount, goal):
    "Adjusts values for small and big chocolate bars until we find out whether there is a solution"
    if big_amount == 0 and small_amount == goal:
        return goal
    elif big_amount == 0 and small_amount != goal:
        return -1
    else:
        big_size = 5
        small_size = 1
        big_sums_list = permutations(big_amount, big_size, goal)
        big_sum = big_sums_list
        if type(big_sum) == list: #If none of the sums reached our goal
            new_threshold_value = goal - big_sums_list[-1] # We adjust the new threshold value for the permutations function
            small_sums_list = permutations(small_amount, small_size, goal) #Get all possible sums with our given small values
            small_sum = small_sums_list # If the sum of our small values has indeed equaled or exceeded our goal
            if type(small_sums_list) == list:  # If the sum of our small values has not equaled nor exceeded our goal
                small_sums_list = permutations(small_amount, small_size, new_threshold_value)
                small_sum = small_sums_list
                if type(small_sums_list) == list: # If the sum of small bars has not exceeded the threshold value
                    return -1
                elif small_sum == new_threshold_value:
                    return small_sum # Whichever value we choose will be correct
                elif small_sum > new_threshold_value:
                    return new_threshold_value # It is the number of small bars we have left before our goal that matters
            elif small_sum == goal:
                return small_sum # If the sum has equaled our goal, it is indiferent whether we choose one or the other variable
            elif small_sum > goal: # If the sum has exceeded our goal
                return goal #Since the size is one, we can return goal as the result
        elif big_sum >= goal:
            return make_chocolate(small_amount, big_amount - 1, goal) # We adjust the amounts by - 1, to check for different combinations
        elif big_sum == 5:
            new_threshold_value = goal - big_sum # We adjust the new threshold value for the permutations function
            small_sums_list = permutations(small_amount, small_size, new_threshold_value) #Get all possible sums with our given small values
            small_sum = small_sums_list # If the sum of our small values has indeed equaled or exceeded our goal
            if type(small_sum) == list:  # If the sum of our small values has not equaled nor exceeded our goal
                return -1
            elif small_sum == new_threshold_value:
                return small_sum # If the sum has equaled our goal, it is indiferent whether we choose one or the other variable
            elif small_sum > new_threshold_value: # If the sum has exceeded our goal
                return goal #Since the size is one, we can return goal as the result

print(make_chocolate(4, 1, 10)) 
```

# c - 您一般如何从用户模式代码中检测缓存行关联性？

> ID：15617871
> 
> 赞同：17
> 
> 时间：2013-03-25T14:48:34.657
> 
> 标签：c, valgrind, cpu-architecture, cpu-cache

我正在为[valgrind 中的 cachegrind/callgrind 工具制作](http://valgrind.org/docs/manual/cg-manual.html)一个小补丁，该补丁将使用完全通用的代码、CPU 指令和缓存配置进行自动检测（现在只有 x86/x64 自动配置，其他架构不提供CPUID 类型配置到非特权代码）。该代码将需要完全在非特权上下文中执行，即纯用户模式代码。它还需要在非常不同的 POSIX 实现中可移植，所以 grokking /proc/cpuinfo 不会做，因为我们的目标系统之一没有这样的东西。

检测 CPU 的频率、缓存的数量、它们的大小，甚至缓存行大小都可以使用 100% 通用 POSIX 代码完成，它没有任何特定于 CPU 的操作码（只是很多合理的假设，例如添加两个数字在一起，如果没有内存或寄存器依赖停顿，可能会在一个周期内执行）。这部分相当简单。

什么不是那么简单，为什么我问 StackOverflow，是如何检测给定缓存的缓存行关联性？关联性是高速缓存中有多少位置可以包含来自主存储器的给定高速缓存行。我可以看到可以检测到 L1 缓存关联性，但是 L2 缓存呢？L1 关联性肯定会妨碍吗？

我很欣赏这可能是一个无法解决的问题。但我把它扔到 StackOverflow 上，希望有人知道我不知道的事情。请注意，如果我们在这里失败，我将简单地以四种方式的关联性默认值进行硬编码，假设它不会对结果产生巨大影响。

谢谢，
尼尔

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-04-14T05:28:35.703

这是一个方案：

具有跨度**S**的内存访问模式，访问的唯一元素数 = **N**。该测试首先接触每个唯一元素，然后通过**大量**访问相同模式来测量访问每个元素的平均时间。

示例：对于 S = 2 和 N = 4，地址模式将为 0,2,4,6,0,2,4,6,0,2,4,6,...

考虑一个多级缓存层次结构。您可以做出以下合理的假设：

*   n+1 级缓存的大小是第 n 级缓存大小的两倍
*   第 n+1 个缓存的关联性也是第 n 个缓存的关联性的两倍的幂。

这两个假设允许我们说，如果两个地址映射到第 n+1 个缓存（例如 L2）中的同一组，那么它们必须映射到第 n 个缓存（例如 L1）中的同一组。

假设您知道 L1、L2 缓存的大小。**您需要找到 L2 缓存的关联性。**

*   设置步幅**S** = L2 缓存的大小（以便每次访问都映射到 L2 和 L1 中的相同集合）
*   变化**N**（2 的幂）

你得到以下制度：

*   **方案1：** N <= L1 的结合性。（L1 中的所有访问 HIT）
*   **方案2：** L1 的关联性 < N <= L2 的关联性（L1 中的所有访问都未命中，但 L2 中的 HIT）
*   **方案3：** N > L2 的关联性（L2 中的所有访问都未命中）

因此，如果您针对 N 绘制平均访问时间（当 S = L2 的大小时），您将看到类似阶梯的图。最低步骤的结尾为您提供 L1 的关联性。下一步为您提供 L2 的关联性。

您可以在 L2-L3 等之间重复相同的过程。请让我知道这是否有帮助。通过改变内存访问模式的步长来获取缓存参数的方法类似于 LMBENCH 基准测试使用的方法。我不知道 lmbench 是否也能推断出关联性。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-18T11:52:19.233

你能做一个只访问同一集合中的行的小程序吗？然后你可以增加访问之间的堆栈距离，当执行时间急剧下降时，你可以假设你已经达到了关联性。

它可能不是很稳定，但也许这可以带来领先，不知道。我希望它可以帮助。

* * *

## 回答 #3

> 赞同：-3
> 
> 时间：2013-05-06T16:03:30.033

对于 x86 平台，您可以使用`cpuid`：

有关详细信息，请参阅[http://www.intel.com/content/www/us/en/processors/processor-identification-cpuid-instruction-note.html](http://www.intel.com/content/www/us/en/processors/processor-identification-cpuid-instruction-note.html)。

你需要类似的东西：

```
long _eax,_ebx,_ecx,_edx;
long op = func;

asm ("cpuid"
    : "=a" (_eax),
    "=b" (_ebx),
    "=c" (_ecx),
    "=d" (_edx)
    : "a" (op)
); 
```

然后根据上述链接中的文档使用信息。

# solr - 将 mahout 0.6 与 solr 4.2 一起使用时出现 IndexFormatTooOldException

> ID：15617873
> 
> 赞同：0
> 
> 时间：2013-03-25T14:48:40.733
> 
> 标签：solr, mahout

我正在使用 mahout 发行版 0.6 和 solr 4.2，我想为 solr 索引生成 mahout 向量，但该命令给出了兼容性错误。为什么我会收到此错误以及如何解决？

```
~/mahout$ bin/mahout lucene.vector --dir /home/newscontext/solr/solr-4.2.0/example/solr/collection1/data/index --output tmp/part-out.vec --field 0 --dictOut /tmp/dict.out --norm 2
MAHOUT_LOCAL is not set; adding HADOOP_CONF_DIR to classpath.
no HADOOP_HOME set, running locally
SLF4J: Class path contains multiple SLF4J bindings.
SLF4J: Found binding in [jar:file:/home/newscontext/mahout/examples/target/mahout-examples-0.6-job.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: Found binding in [jar:file:/home/newscontext/mahout/examples/target/dependency/slf4j-jcl-1.6.1.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: Found binding in [jar:file:/home/newscontext/mahout/examples/target/dependency/slf4j-log4j12-1.6.1.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: See http://www.slf4j.org/codes.html#multiple_bindings for an explanation.
Exception in thread "main" org.apache.lucene.index.IndexFormatTooOldException: Format version is not supported in file 'segments_2': 1071082519 (needs to be between -1 and -11). This version of Lucene only supports indexes created with release 3.0 and later.
    at org.apache.lucene.index.SegmentInfos.read(SegmentInfos.java:275)
    at org.apache.lucene.index.DirectoryReader$1.doBody(DirectoryReader.java:79)
    at org.apache.lucene.index.SegmentInfos$FindSegmentsFile.run(SegmentInfos.java:754)
    at org.apache.lucene.index.DirectoryReader.open(DirectoryReader.java:75)
    at org.apache.lucene.index.IndexReader.open(IndexReader.java:421)
    at org.apache.lucene.index.IndexReader.open(IndexReader.java:281)
    at org.apache.mahout.utils.vectors.lucene.Driver.dumpVectors(Driver.java:84)
    at org.apache.mahout.utils.vectors.lucene.Driver.main(Driver.java:250)
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
    at java.lang.reflect.Method.invoke(Method.java:616)
    at org.apache.hadoop.util.ProgramDriver$ProgramDescription.invoke(ProgramDriver.java:68)
    at org.apache.hadoop.util.ProgramDriver.driver(ProgramDriver.java:139)
    at org.apache.mahout.driver.MahoutDriver.main(MahoutDriver.java:188) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-25T15:09:16.697

0.6 是旧的。即使是当前版本的 0.7，也已经很老了。我确信他们不使用相当新的 Lucene 4.2。事实上，它可能在 Lucene 2.x 上，因为它是 2 多年前发布的。使用来自 SVN 的最新版本，而不是 0.6。

# xml - XSD 文件生成 - 结构问题

> ID：15617874
> 
> 赞同：0
> 
> 时间：2013-03-25T14:48:40.920
> 
> 标签：xml, xsd

我是 .xml/.xsd 世界的新手，我必须说我在这里很难，即使我想做的任务对我来说听起来很简单！

我目前正在将数据从 API 检索到 Excel 中，我想使用第一行生成一个 xml 文件，其中包含标题 - >元素的名称和数据本身的以下行。

使用 Excel 提供的工具导入 .xsd 架构，然后能够将数据导出到 .xml 文件中，我在正确准备 .xsd 文件时遇到了困难。

问题：我想在我的 .xml 文件中有几层，但看起来很难做到（原因我不明白）。就像是 ：

```
<element1>
      <subelement1>
      <subelement2>
      <subelement3>
<element2>
<element3> 
```

等等

这是我当前的 .xsd 文件：

```
 <?xml version="1.0" encoding="UTF-8"?>
<xs:schema xmlns:xs="http://www.w3.org/2001/XMLSchema">
    <xs:element name="Offers">
        <xs:complexType>
            <xs:sequence>
                <xs:element ref="offer" minOccurs="0" maxOccurs="unbounded"/>
            </xs:sequence>
        </xs:complexType>
        <xs:element name="offer">
            <xs:complexType>
                <xs:sequence>
                    <xs:element name="code" type="xs:string"/>
                    <xs:element name="bathroom_count" type="xs:string"/>
                    <xs:element name="bedroom_count" type="xs:string"/>
                    <xs:element name="average_rating" type="xs:string"/>
                    <xs:element name="title" type="xs:string"/>
                    <xs:element name="description" type="xs:string"/>
                    <xs:element name="content_language" type="xs:string"/>
                    <xs:element name="main_photo" maxOccurs="unbounded"/>
                        <xs:complexType>
                            <xs:sequence>
                                <xs:element name="lalala" type="xs:string"/>
                                <xs:element name="slip" type="xs:string"/>
                            </xs:sequence>
                        </xs:complexType>
                </xs:sequence>
            </xs:complexType>
        </xs:element>
    </xs:element>
</xs:schema> 
```

我已经阅读了大量有关它的帮助，并且我通常会在论坛上提问之前找到解决方案，但我很困在这里。在我看来，这种结构是完美的，但它仍然不起作用。:( 每次我尝试在 Excel 中导入它时都会出现错误，并且此布局的错误是

> 说明 /schema/element[1][@name = 'Offers']/element[1][@name = 'offer'] 在此上下文中不允许使用元素 'xs:element'。

我不明白，因为我已经读过 ComplexType 需要在两者之间使用元素作为另一个元素的子元素。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-25T14:59:43.880

如果要引用元素，则必须将它们放在 xs:schema 下，例如：

```
<xs:schema xmlns:xs="http://www.w3.org/2001/XMLSchema">
    <xs:element name="Offers">
    <xs:complexType>
        <xs:sequence>
            <xs:element ref="offer" minOccurs="0" maxOccurs="unbounded"/>
        </xs:sequence>
    </xs:complexType>

</xs:element>

<xs:element name="offer">
    <xs:complexType>
        <xs:sequence>
            <xs:element name="code" type="xs:string"/>
            <xs:element name="bathroom_count" type="xs:string"/>
            <xs:element name="bedroom_count" type="xs:string"/>
            <xs:element name="average_rating" type="xs:string"/>
            <xs:element name="title" type="xs:string"/>
            <xs:element name="description" type="xs:string"/>
            <xs:element name="content_language" type="xs:string"/>
            <xs:element name="main_photo" maxOccurs="unbounded">
                <xs:complexType>
                    <xs:sequence>
                        <xs:element name="lalala" type="xs:string"/>
                        <xs:element name="slip" type="xs:string"/>
                    </xs:sequence>
                </xs:complexType>
            </xs:element>
        </xs:sequence>
    </xs:complexType>
</xs:element> 
```

如果要嵌套复杂类型，则需要嵌套它。

# r - 为什么有些函数不会忽略 R 中的空值？

> ID：15617876
> 
> 赞同：-2
> 
> 时间：2013-03-25T14:48:47.717
> 
> 标签：r, function, null, na

我有一个每日回报的时间序列。没有可用数据的观察具有价值`NaN`。

尝试应用诸如包中的函数`StdDev`，`PerformanceAnalytics`该函数正确执行计算并仅返回非 Null 值的标准偏差。

尝试应用诸如`mean`, `min`, `max`... 之类的函数会返回错误的结果，即`NaN`.

`mean`" " 函数中可能有什么要指定的？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-25T14:50:20.483

来自[`?mean`](http://stat.ethz.ch/R-manual/R-patched/library/base/html/mean.html)：

> `na.rm`
> 
> 一个逻辑值，指示在计算继续之前是否应剥离 NA 值。

`min`并`max`进行`na.rm`辩论。

最后，可能值得熟悉一下[`?na.omit`](http://stat.ethz.ch/R-manual/R-patched/library/stats/html/na.fail.html).

# .net - 如何以编程方式将 ADO 变量设置为 SSIS 中的 ForEach 循环枚举器？

> ID：15617881
> 
> 赞同：4
> 
> 时间：2013-03-25T14:49:02.060
> 
> 标签：.net, ssis, ado

我正在使用 SSIS 对象模型以编程方式创建一个 SSIS 包。

我想要一个使用我创建为枚举器的 ADO 对象变量的 ForEach 循环。如何将变量分配给枚举器并在循环中使用它的值？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-25T14:49:02.060

假设：

*   您有一个 ADO 对象变量**User::ADOObject**包含两列*Key*和*Value*。

代码：

```
using Microsoft.SqlServer.Dts.Runtime.Enumerators;
using Microsoft.SqlServer.Dts.Runtime;
using Microsoft.SqlServer.Dts.Runtime.Enumerators.ADO;

ForEachLoop f = new ForEachLoop();
ForEachADOEnumerator ado_enum = (ForEachADOEnumerator) f.ForEachEnumerator.InnerObject;
ado_enum.Type = ADOEnumerationType.EnumerateRowsInFirstTable;
ado_enum.DataObjectVariable = "User::ADOObject";

f.VariableMappings.Add();
f.VariableMappings[0].VariableName = "User::Key";
f.VariableMappings[0].ValueIndex = "Key";

f.VariableMappings.Add();
f.VariableMappings[1].VariableName = "User::Value";
f.VariableMappings[1].ValueIndex = "Value"; 
```

如果您使用的是[EzAPI](https://sqlsrvintegrationsrv.codeplex.com/releases/view/21238)，首先您必须修改 EzAPI 源代码，因为*EzForEachLoop*类不会公开开箱即用的**VariableMappings 。**将此属性添加到 EzExecutables.cs 中的 EzForEachLoop 类：

```
public ForEachVariableMappings VariableMappings
{
    get { return (m_exec as ForEachLoop).VariableMappings; }

} 
```

然后在您的代码中像这样初始化*EzForEachLoop*（假设 this 在自定义包类中调用，构造函数中的“this”参数指的是该包）：

```
EzForEachLoop ezf = new EzForEachLoop(this); 
ezf.Initialize(ForEachEnumeratorType.ForEachADOEnumerator); 
```

现在**ezf**的枚举数和变量映射可以按照与上面的*ForEachLoop* **f**相同的方式设置。

# c# - 无法访问该文件，因为它正被另一个进程使用

> ID：15617883
> 
> 赞同：6
> 
> 时间：2013-03-25T14:49:07.430
> 
> 标签：c#, asp.net, itextsharp, pdfstamper

我的网络方法在我的 %temp% 文件夹中创建了一个 pdf 文件，并且可以正常工作。然后我想使用下面的代码向该文件添加一些自定义字段（元）。

无论我使用它的方法还是块刚刚结束，该类`PdfStamper`都会生成一个。仍然保留文件句柄的进程是 webdev Web 服务器本身（我在 VS2010 SP1 中调试）。`IOException``.Close()``using`

```
private string AddCustomMetaData(string guid, int companyID, string filePath)
{
    try
    {
        PdfReader reader = new PdfReader(filePath);

        using (FileStream fs = new FileStream(filePath, FileMode.Open, FileAccess.ReadWrite, FileShare.ReadWrite))
        {
            PdfStamper st = new PdfStamper(reader, fs);
            Dictionary<string, string> info = reader.Info;
            info.Add("Guid", guid);
            info.Add("CompanyID", companyID.ToString());

            st.MoreInfo = info;
            st.Close();
        }

        reader.Close();

        return guid;
    }
    catch (Exception e)
    {
        return e.Message;
    }
} 
```

无论我尝试什么，它都会不断抛出异常`st.Close();`，更准确地说：

> 该进程无法访问文件“C:\Users[my username]\AppData\Local\Temp\53b96eaf-74a6-49d7-a715-6c2e866a63c3.pdf”，因为它正被另一个进程使用。

要么是我忽略了一些明显的事情，要么是`PdfStamper`我尚未意识到的课程存在问题。使用的 itextsharp 版本是 5.3.3.0 和 5.4.0.0，问题是一样的。

任何见解将不胜感激。

**编辑：**我目前正在“围绕”这个问题进行编码，但我还没有找到任何解决方案。

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2013-03-26T13:56:40.043

您的问题是您在读取文件的同时正在写入文件。与将所有数据“加载”到内存中的某些文件类型（JPG、PNG 等）不同，iTextSharp 将数据作为流读取。您要么需要使用两个文件并在最后交换它们，要么可以强制 iTextSharp 通过将您绑定`PdfReader`到文件的字节数组来“加载”第一个文件。

```
PdfReader reader = new PdfReader(System.IO.File.ReadAllBytes(filePath)); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-25T14:53:44.333

我建议你在`FileShare enumerator`打开文件时使用，所以尝试用`None sharing`

```
 File.Open(fileName, FileMode.Open, FileAccess.Read, FileShare.None); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-25T14:51:09.987

首次保存文件时尝试 .Dispose() 您的 PDF 阅读器（或用于创建它的任何工具）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-25T15:34:12.013

如果您认为它对您可行，请尝试此解决方案 - 一旦 web 方法在 Temp 文件夹中创建文件，您需要复制文件并将其粘贴到其他位置或具有不同名称的相同位置，并将新复制的文件路径传递给您的 PDF 阅读器。

# ms-word - Word Styles 让两个元素共享相同的背景/边框

> ID：15617886
> 
> 赞同：0
> 
> 时间：2013-03-25T14:49:15.663
> 
> 标签：ms-word, word-2010

在 MS Word 2013 中，我正在尝试创建一个文本元素以及它下面的列表，所有这些都包裹在带有背景底纹的彩色边框内（见图）。所附图像以纯文本形式显示文本。

我想在标题和列表周围放置*一个*蓝色*边框*。我可以通过将两个对象放在一个 1x1 表中并将着色规则应用于单元格来实现这一点，但从语义上讲这似乎很糟糕（我来自 HTML 开发背景，这是**非常**错误的！）

当我编辑样式规则以创建边框/背景时，它运行良好，直到我创建列表，然后出现严重错误。是否可以仅使用样式规则而不使用表格来实现表格单元格方法的输出？

![好款式和坏款式！](../Images/d6efc4969b7fc65f9b29da32b8a39966.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-28T10:16:44.233

经过一天的实验，我能得到的最接近的是执行以下操作：

1.  根据**Normal**创建一个名为**Tips Heading**的样式规则，然后将其设置为 Bold 并带有蓝色背景。
***   根据**List Paragraph创建另一个名为****Tips List**的样式规则，并将其设置为蓝色背景。**

 ****不幸的是，列表不能缩进，因为背景颜色也会缩进。边框也以这种方式受到影响，所以我忽略了边框和缩进。它工作得非常好，并且在语义上结构良好。****

# javascript - 如何将文本从 UIWebView 打印到 JavaScript 表单？

> ID：15617889
> 
> 赞同：0
> 
> 时间：2013-03-25T14:49:20.047
> 
> 标签：javascript, objective-c, forms, uiwebview

我正在尝试使用网站填充 UIWebView。我希望应用程序显示比网站本身更好的登录视图。因此，我在后台有一个 UIWebView 。我正在尝试用我在视图控制器中创建的文本字段填写网站上的表单，但我的代码不起作用。

这是网站上的表格：

```
<div class="centerloginform">

<form name="userForm" action="Login.jsp" method="post" autocomplete="off">
  <input type="hidden" name="action" class="hidden" id="action" value="login" />
  <div class="loginheader">Logga in</div>

  <div class="login_formtable">
    <label class="login_label">Jag är</label>
    <div id="loginselect" style="clear:both:">
      <select name="usertype" size="1"  id="usertype" class="select1" >   
        <option value="0"  selected="selected">Personal</option>
        <option value="1" >Elev</option>
        <option value="2" >Vårdnadshavare</option>
      </select>
    </div>

    <label class="login_label">Användarnamn</label>
    <input autocomplete="off" type="text" value="" name="ssusername" size="20" maxlength="50" />
    <label class="login_label">Lösenord</label>
    <input autocomplete="off" type="password" name="sspassword" size="20" maxlength="20" value=""/>

    <div><input type="submit" name="button" value="Logga in"  class="btn btn-primary" />
    </div>
    <br />
    <center> 
```

这是我的代码：

```
- (IBAction)submit:(id)sender {

    NSString *loadUsernameJS = [NSString stringWithFormat:@"document.getElementsByName('ssusername') ssusername.value='%@';", _username.text];

    NSString *loadPasswordJS = [NSString stringWithFormat:@"document.getElementsByName('sspassword')[0]; sspassword.value='%@';", _password.text];

    [self.webView stringByEvaluatingJavaScriptFromString: loadUsernameJS];
    [self.webView stringByEvaluatingJavaScriptFromString: loadPasswordJS];

    [self.webView stringByEvaluatingJavaScriptFromString:@"document.getElementsByClassName('btn btn-primary');"];

} 
```

任何人都可以帮助我，以便用户在应用程序的文本字段中写入的文本以网站上的形式打印吗？我怀疑我的 Java`getElementsBy`字符串有问题。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-25T15:51:11.530

你可以在一个 JS 调用中做到这一点：

```
NSString *submitFormJS = [NSString stringWithFormat:
                          @"document.getElementsByName('ssusername')[0].value='%@';"
                          "document.getElementsByName('sspassword')[0].value='%@';"
                          "document.getElementsByName('userForm')[0].submit();",
                          _username.text, _password.text]; 
```

*PS 这是一个好主意，用'id='*更改HTML 代码中的*'name='*属性并访问类似的元素

 *```
document.getElementById('ssusername').value = 'smth'; 
```*

# vba - 为什么我的宏/VB 不能在我的 PowerPoint 演示文稿中运行

> ID：15617896
> 
> 赞同：0
> 
> 时间：2013-03-25T14:49:41.390
> 
> 标签：vba, powerpoint

我正在尝试在我正在处理的 PowerPoint 演示文稿中添加一些交互。我编写了一个小 VB，它会在脚本运行时增加特定图表对象的大小和位置。我在设计模式下测试了脚本，一切似乎都正常。但是，当我将代码链接到操作按钮并尝试从幻灯片放映中运行它时，代码不会运行。我的大部分 VB 都是在 Excel 中完成的，所以我以前没有遇到过这个问题。任何人都可以建议解决此问题。我的代码如下：

```
 Sub MoveChart23()
    Dim s
    For Each s In ActiveWindow.Selection.SlideRange.Shapes
     If s.Name = "Chart 23" Then
      s.Top = 50
      s.Width = 620
      s.Left = 50
      s.Height = 400
     End If
    Next
End Sub 
```

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-25T15:12:02.523

无论如何，我认为您的问题出在以下行：

```
For Each s In ActiveWindow.Selection.SlideRange.Shapes 
```

而您在演示模式下没有选择。根据您运行和控制整个演示文稿的方式，您应该使用以下内容：

```
For Each s In ActiveWindow.Slides(1).Shapes 
```

但是，如果您需要参考当前查看的幻灯片，您应该这样：

```
For Each s In SlideShowWindows(1).View.Slide.Shapes 
```

# vba - 自动绘制来自不同工作表的图形

> ID：15617902
> 
> 赞同：0
> 
> 时间：2013-03-25T14:49:50.917
> 
> 标签：vba, graph

我正在编写一个excel应用程序，它从表格中获取信息（它也被编程并且每个表格的长度和位置可以改变）并在按下按钮时为另一个表格中的每个表格生成一个图形，称为估算表.

我设法为第一个图形（对应于第一个表）完成了这项任务，但是当我尝试对第二个图形使用相同的方法时......它不起作用。这是用于绘制第一个图形的方法：

```
 Public Sub generateGraphicsC(RowResistiveC As Integer)

       Dim FirstRow As Integer, FirstColumn As Integer, LastRow As Integer, LastColumn As Integer,         GraphLocation As Integer
       Dim XelementsC As Integer, Yelements As Integer

       Dim myChtObj As ChartObject
       Dim rngChtData As Range
       Dim rngChtXVal As Range
       Dim i As Integer

       Dim WSD As Worksheet
       Set WSD = Worksheets(2)     'Data source

       Dim CSD As Worksheet
       Set CSD = Worksheets(3)     'ChartOutput

       'Dim chrt As ChartObject
       'Dim cw As Long
       'Dim rh As Long

       ' get the current charts so proper overwriting can happen Dim chtObjs As ChartObjects
       Set chtObjs = CSD.ChartObjects
       WSD.AutoFilterMode = False       ' Turn off autofilter mode
       'Dim finalRow As Long            ' Find the last row with data
       'finalRow = WSD.Cells(Application.Rows.Count, 1).End(xlUp).Row

       FirstRow = RowResistiveC
       FirstColumn = 5

       XelementsC = countXelementsC(FirstRow - 1, FirstColumn)                  'Count the x         Elements (amperes)
       Yelements = countYelements(FirstRow)                                      'Count the y Elements (Combinations)

       LastRow = FirstRow + Yelements - 1                                      'The last row and column I will read
       LastColumn = FirstColumn + XelementsC - 1

       '---------------------DRAW THE GRAPHIC----------------------------------------------'

       ' Delete any previous existing chart
        'Dim chtObj As ChartObject

       ' define the x axis values
       WSD.Activate
       Set rngChtXVal = WSD.Range(Cells(FirstRow - 1, FirstColumn), Cells(FirstRow - 1, LastColumn))

       ' add the chart
          Charts.Add

          With ActiveChart
          ' make a XY chart
             .ChartType = xlXYScatterLines
             ' remove extra series
             Do Until .SeriesCollection.Count = 0
                .SeriesCollection(1).Delete
             Loop

             .Location Where:=xlLocationAsObject, Name:="Estimation Sheets"
          End With

          '-----------------------------------------------------------------------------
          With ActiveChart
             .HasTitle = True
             .ChartTitle.Characters.Text = "Factor C"

             'To Interpolate between the ungiven values
             .DisplayBlanksAs = xlInterpolated

              'TITLE STYLE
             .ChartTitle.AutoScaleFont = False
             With .ChartTitle.Font
                .Name = "Calibri"
                .FontStyle = "Bold"
                .Size = 14
                .Strikethrough = False
                        .Superscript = False
                .Subscript = False
                .OutlineFont = False
                .Shadow = False
                .Underline = xlUnderlineStyleNone
                .ColorIndex = xlAutomatic
                .Background = xlAutomatic
             End With

             'AXIS STYLE-----------------------------------------------------------------------

             .Axes(xlCategory).TickLabels.AutoScaleFont = False
             With .Axes(xlCategory).TickLabels.Font
                .Name = "Arial"
                .FontStyle = "Regular"
                .Size = 10
                .Strikethrough = False
                .Superscript = False
                .Subscript = False
                .OutlineFont = False
                .Shadow = False
                .Underline = xlUnderlineStyleNone
                .ColorIndex = xlAutomatic
                .Background = xlAutomatic
             With Selection.Border
                .ColorIndex = 15
                .LineStyle = xlContinuous
            End With

             End With
             .Axes(xlValue).TickLabels.AutoScaleFont = False
             With .Axes(xlValue).TickLabels.Font
                .Name = "Calibri"
                .FontStyle = "Regular"
                .Size = 8
                .Strikethrough = False
                .Superscript = False
                .Subscript = False
                .OutlineFont = False
                .Shadow = False
                .Underline = xlUnderlineStyleNone
                .ColorIndex = xlAutomatic
                .Background = xlAutomatic
             End With

          End With
          '-----------------------------------------------------------------------------
          ' HEIGHT; WIDTH AND POSITION

          GraphLocation = CSD.Cells(Rows.Count, 2).End(xlUp).Row + 3

          Dim RngToCover As Range
          Set RngToCover = ActiveSheet.Range(Cells(GraphLocation, 2), Cells(GraphLocation + 20, 11))
          With ActiveChart.Parent
             .Height = RngToCover.Height ' resize
             .Width = RngToCover.Width   ' resize
             .Top = RngToCover.Top       ' reposition
             .Left = RngToCover.Left     ' reposition
          End With

       ' for each row in the sheet
       For i = FirstRow To LastRow
          Dim chartName As String
          ' define chart data range for the row (record)
           Set rngChtData = WSD.Range(WSD.Cells(i, FirstColumn), WSD.Cells(i, LastColumn))

          'To get the serie name that I´m going to add to the graph
          Dim serieName As String
          Dim varItemName As Variant
          WSD.Activate
          varItemName = WSD.Range(Cells(i, 1), Cells(i, 4))
          serieName = CStr(varItemName(1, 1) + " " + varItemName(1, 2) + " " + varItemName(1, 3) + " " + varItemName(1, 4))

          ' add series from selected range, column by column

             CSD.ChartObjects.Select

            With ActiveChart
                With .SeriesCollection.NewSeries
                .Values = rngChtData
                .XValues = rngChtXVal
                .Name = serieName
            End With
            End With

        Next i

         'We let as last view the page with all the info
         CSD.Select

    End Sub 
```

我正在从另一个调用这个 Sub。下一步将为其他类型的表格和图形调用类似的方法（完全相同但其他起点来获取数据和一些不同的格式属性）：

```
 Public Sub printGraphics()

       Modul4.ClearGraphs

       Modul4.generateGraphicsC (RowResistiveC)

       Modul4.generateGraphicsT (RowResistiveT)

    End Sub 
```

等等。CountXelements 和 Yelements 计算来自 Tables Sheet 和 RowResistiveC 的元素数量，例如，保持表格的位置。

GenerateGraphicsC 工作，但 generateGraphicsT （完全相同）在行中粉碎：

`With .SeriesCollection.NewSeries`

Whit 错误 91（我有一个德语版的 excel 在工作，但它类似于变量对象或未给出块对象）。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-26T13:18:04.247

正如我怀疑错误来自：

`CSD.ChartObjects.Select`

这在我的第一个图形的解决方案中有效，因为我选择了工作表上的单个图形，但是当我添加更多时它不会。

我刚刚将该行更改为：

`CSD.ChartObjects(1).Activate`

等等。它完美地工作。我还必须进行一些调整以避免所有图表都绘制在前一个图表上，但效果很好。

# sql - 使用光标将数据垂直插入临时表

> ID：15617905
> 
> 赞同：0
> 
> 时间：2013-03-25T14:49:58.887
> 
> 标签：sql, stored-procedures, cursor, temp-tables

如上所述。我在 SQL 中创建了 2 个临时表，需要垂直插入以完成所有列，但据我了解，您只能水平插入数据吗？

有没有解决的办法？

例子 ：

```
ForgeinKey  |  Q1  |  Q2  |  Q3  |  Q4  |  Q5  | 
   1234     |    1 |     1|    0 |    2 |     0|
   1235     |    0 |     2|    1 |    2 |     0|
   1236     |    2 |     2|    0 |    0 |     1| 
```

我认为会发生的事情是这样的：

```
ForgeinKey  |  Q1  |  Q2  |  Q3  |  Q4  |  Q5 |
   1234     | 1    |NULL  | NULL |  NULL| NULL|
   1234     |NULL  | 1    | NULL |  NULL| NULL|
   1234     |NULL  |NULL  |  0   |  NULL| NULL|
   1234     |NULL  |NULL  | NULL |    2 | NULL|
   1234     |NULL  |NULL  | NULL |  NULL|   0 |      (etc) 
```

目前，我的临时表 (2) 的前几列中有所有数据，但之后我有 22 个列，我应该用另一个临时表 (1) 中的数据填充这些数据。

在临时表（1）中，我将所有数据水平显示：

```
Answers  |  Questions  |  ForeignKey
   1     |      Q1     |       1234     
   1     |      Q2     |       1234  
   0     |      Q3     |       1234  
   2     |      Q4     |       1234  
   0     |      Q5     |       1234 
```

如上所示，我需要临时表（1）使用外键垂直填充临时表（2）来识别行：

```
ForgeinKey  |  Q1  |  Q2  |  Q3  |  Q4  |  Q5|
   1234     |    1 |     1|    0 |     2|   0|
   1235     |    0 |     2|    1 |     2|   0|
   1236     |    2 |     2|    0 |     0|   1| 
```

这是我目前与 bluefeet 的解决方案一起使用的代码：

```
BEGIN
SET DATEFORMAT ymd;

--Temp Table 1 (Answers)
DECLARE @AnswersTempTable TABLE
(
    tblManagerSpotCheckAnswer_ID    bigint, 
    lManagerSpotCheck_ID            bigint, 
    lManagersSpotCheckQuestion_ID   bigint, 
    lManagersSpotCheckAnswer        int, 
    sDescription                    varchar(100)
)

INSERT INTO @AnswersTempTable
SELECT     tblManagerSpotCheckAnswers.tblManagerSpotCheckAnswer_ID,           tblManagerSpotCheckAnswers.lManagerSpotCheck_ID, 
                  tblManagerSpotCheckAnswers.lManagersSpotCheckQuestion_ID,   tblManagerSpotCheckAnswers.lManagersSpotCheckAnswer, 
                  tblManagerSpotCheckQuestions.sDescription
FROM         tblManagerSpotCheckAnswers INNER JOIN
                      tblManagerSpotChecks ON   tblManagerSpotCheckAnswers.lManagerSpotCheck_ID = tblManagerSpotChecks.lManagerSpotCheck_ID     INNER JOIN
                      tblManagerSpotCheckQuestions ON 
                      tblManagerSpotCheckAnswers.lManagersSpotCheckQuestion_ID = tblManagerSpotCheckQuestions.lManagersSpotCheckQuestion_ID LEFT OUTER JOIN
                      tblCallDiary ON tblManagerSpotChecks.lCallDiary_ID = tblCallDiary.lCallDiary_ID
WHERE     (tblCallDiary.lCycle_ID = @lCycle_ID) AND (tblManagerSpotChecks.lRMStaff_ID = @Staff_ID)
ORDER BY tblManagerSpotChecks.lManagerSpotCheck_ID

--SELECT * FROM @AnswersTempTable 
```

--温度表2（结果）

```
DECLARE @ResultTempTable    TABLE
(
    Completed_Date          date, 
    Call_Date               date,
    Outlet                  varchar(100), 
    Channel_Manager         varchar(100), 
    Area                    varchar(100), 
    TE                      varchar(100), 
    Spot_Checker            varchar(100), 
    lChannel_ID             bigint, 
    lManagerSpotCheck_ID    bigint,
    lCycle_ID               int,
    All_Handsets_displayed  int,
    All_Starter_Packs_displayed int,
    Handset_stock_rotated   int,
    Starter_Pack_stock_rotated  int,
    All_Handsets_priced_correctly   int,
    All_Starter_Packs_priced_correctly  int,
    All_Handsets_Starter_Packs_Orders_Checked   int,
    Stock_order_placed  int,
    Minimum_Handset_stock_in_store  int,
    Minimum_Starter_Pack_stock_in_store int,
    Latest_Deal_Generic_poster_on_display   int,
    Branding_as_per_Planogram   int,
    Sufficient_Contract_Forms   int,
    Sufficient_Brochures_in_store   int,
    Kiosk_functional    int,
    Cycle_Objective_Training    int,
    All_staff_trained_on_all_modules    int,
    Closed_group_training_session_booked    int,
    Outlet_is_able_to_RICA_8ta_starter_packs    int,
    All_OBF_Repairs_actioned    int,
    TE_Known_to_Store_Manager   int,
    Escalated_Relationship_issues   int
)

INSERT INTO @ResultTempTable(Completed_Date, Call_Date, Outlet, Channel_Manager, Area,  TE, Spot_Checker, lChannel_ID, lManagerSpotCheck_ID, lCycle_ID)
        SELECT DISTINCT 
                      tblManagerSpotChecks.dDateCaptured AS [Completed Date], tblManagerSpotChecks.dCallDate AS [Call Date], tblSites.sSitename AS Outlet, 
                      tblChannel.sChannelManager AS [Channel Manager], PC_Location.sDescription AS Area, tblStaff_1.sNameSurname AS TE, tblStaff.sNameSurname AS [Spot Checker], 
                      tblChannel.lChannel_ID, tblManagerSpotChecks.lManagerSpotCheck_ID, tblCallDiary.lCycle_ID
        FROM         tblCallDiary LEFT OUTER JOIN
                              tblStaff AS tblStaff_1 ON tblCallDiary.lStaff_ID = tblStaff_1.lStaff_ID RIGHT OUTER JOIN
                              tblChannel RIGHT OUTER JOIN
                              PC_Location RIGHT OUTER JOIN
                              tblSites ON PC_Location.lPC_Location_ID = tblSites.lPC_Location_ID ON tblChannel.lChannel_ID = tblSites.lChannel_ID RIGHT OUTER JOIN
                              tblManagerSpotCheckQuestions RIGHT OUTER JOIN
                              tblManagerSpotCheckAnswers RIGHT OUTER JOIN
                              tblStaff RIGHT OUTER JOIN
                              tblManagerSpotChecks ON tblStaff.lStaff_ID = tblManagerSpotChecks.lRMStaff_ID ON 
                              tblManagerSpotCheckAnswers.lManagerSpotCheck_ID = tblManagerSpotChecks.lManagerSpotCheck_ID ON 
                              tblManagerSpotCheckQuestions.lManagersSpotCheckQuestion_ID = tblManagerSpotCheckAnswers.lManagersSpotCheckQuestion_ID ON 
                              tblSites.lSites_ID = tblManagerSpotChecks.lSite_ID ON tblCallDiary.lSite_ID = tblSites.lSites_ID
        WHERE     (tblManagerSpotChecks.dDateCaptured IS NOT NULL) AND (tblStaff.lStaff_ID = @Staff_ID) AND 
                              (tblCallDiary.lCycle_ID = @lCycle_ID)
        ORDER BY tblManagerSpotChecks.lManagerSpotCheck_ID

--SELECT * FROM @ResultTempTable

--SOLUTION FROM bluefeet
SELECT      Completed_Date           
            ,Call_Date              
            ,Outlet                 
            ,Channel_Manager            
            ,Area                   
            ,TE                      
            ,Spot_Checker            
            ,lChannel_ID                 
            ,lManagerSpotCheck_ID   
            ,lCycle_ID              
            ,All_Handsets_displayed 
            ,All_Starter_Packs_displayed    
            ,Handset_stock_rotated  
            ,Starter_Pack_stock_rotated 
            ,All_Handsets_priced_correctly  
            ,All_Starter_Packs_priced_correctly 
            ,All_Handsets_Starter_Packs_Orders_Checked  
            ,Stock_order_placed 
            ,Minimum_Handset_stock_in_store 
            ,Minimum_Starter_Pack_stock_in_store    
            ,Latest_Deal_Generic_poster_on_display  
            ,Branding_as_per_Planogram  
            ,Sufficient_Contract_Forms  
            ,Sufficient_Brochures_in_store  
            ,Kiosk_functional   
            ,Cycle_Objective_Training   
            ,All_staff_trained_on_all_modules   
            ,Closed_group_training_session_booked   
            ,Outlet_is_able_to_RICA_8ta_starter_packs   
            ,All_OBF_Repairs_actioned   
            ,TE_Known_to_Store_Manager  
            ,Escalated_Relationship_issues
    FROM
    (

        SELECT      tblManagerSpotCheckAnswer_ID     
                    ,lManagerSpotCheck_ID            
                    ,lManagersSpotCheckQuestion_ID   
                    ,lManagersSpotCheckAnswer        
                    ,sDescription   
        FROM    @AnswersTempTable       

    ) src
    pivot
    (
        MAX(lManagersSpotCheckAnswer)
        FOR lManagersSpotCheckQuestion_ID IN    (           All_Handsets_displayed  
                                                            ,All_Starter_Packs_displayed    
                                                            ,Handset_stock_rotated  
                                                            ,Starter_Pack_stock_rotated 
                                                            ,All_Handsets_priced_correctly  
                                                            ,All_Starter_Packs_priced_correctly 
                                                            ,All_Handsets_Starter_Packs_Orders_Checked
                                                            ,Stock_order_placed 
                                                            ,Minimum_Handset_stock_in_store 
                                                            ,Minimum_Starter_Pack_stock_in_store    
                                                            ,Latest_Deal_Generic_poster_on_display  
                                                            ,Branding_as_per_Planogram  
                                                            ,Sufficient_Contract_Forms  
                                                            ,Sufficient_Brochures_in_store  
                                                            ,Kiosk_functional   
                                                            ,Cycle_Objective_Training   
                                                            ,All_staff_trained_on_all_modules   
                                                            ,Closed_group_training_session_booked   
                                                            ,Outlet_is_able_to_RICA_8ta_starter_packs   
                                                            ,All_OBF_Repairs_actioned   
                                                            ,TE_Known_to_Store_Manager  
                                                            ,Escalated_Relationship_issues
                                                )
    )piv; 
```

结尾

这样做时我仍然会出错。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-25T15:28:13.310

您的问题并不完全清楚，但您可以应用`UNPIVOT`将数据从列转换为行的`PIVOT`函数或将行转换为列的函数。

一旦数据获得您需要的格式，您就可以`INSERT`根据需要进行处理。

**枢：**

```
select ForeignKey, Q1, Q2, Q3, Q4, Q5
from
(
  select ForeignKey, questions, answers
  from table1
) src
pivot
(
  max(answers)
  for questions in (Q1, Q2, Q3, Q4, Q5)
) piv; 
```

**取消透视：**

```
select ForgeinKey, questions, answers
from table2
unpivot
(
  answers
  for questions in (Q1, Q2, Q3, Q4, Q5)
) unpiv 
```

请参阅带有两个版本[的演示的 SQL Fiddle](http://sqlfiddle.com/#!3/8ecde/4)

# django - 没有 Django 应用程序的 Django 命令？

> ID：15617906
> 
> 赞同：2
> 
> 时间：2013-03-25T14:50:03.173
> 
> 标签：django, django-commands

有什么方法可以添加不需要底层应用程序或项目工作的自定义 Django 命令（非常像`startapp`or `startproject`）？

`$ django-admin.py startveryniceproject projectname`

我可以想象这可以实现的一种方法是将 a 复制`startveryniceproject.py`到`django.core.management.commands`，但这听起来真的“干净”吗？

# jquery - 谷歌地图 V3 缩放设置

> ID：15617907
> 
> 赞同：0
> 
> 时间：2013-03-25T14:50:04.210
> 
> 标签：jquery, google-maps-api-3

我正在使用以下代码使用单个标记拖入谷歌地图：

```
$('#mapx').gmap({'callback':function(){
    var self=this;
    var scope=latitude+','+longitude;
    self.addMarker({'position':scope, 'bounds':true}).click(function(){
        self.openInfoWindow({'content': 'Hello World'),this);
    });
}}); 
```

尽管地图以最大缩放尺寸显示，但它工作正常。我已经尝试了文档中的各种方法来设置缩放，但无法使用此代码进行任何操作。

```
$('#mapx').gmap({'option', 'zoom', 7}); 
```

以上似乎不起作用，但我认为这可能是我的代码中这一行的位置。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-25T15:19:13.293

`'bounds':true`从传递给 addMarker 的选项中删除。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-25T15:18:04.067

试试这个：`$('#map_canvas').gmap('option', 'zoom', 7);`，没有大括号。

# java - CDI。如何检查bean是否实例化？

> ID：15617912
> 
> 赞同：0
> 
> 时间：2013-03-25T14:50:17.520
> 
> 标签：java, cdi

我有一个 CDI @Named bean 的名称。例如，'firedEmployeeBean'。

在其他 CDI bean 中是否有任何方法检查“firedEmployeeBean”是否已经实例化？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-26T09:10:09.047

如前所述，如果您使用`@Inject`一次检查将是。相反，您想要的是拥有一个属性来告诉您您想要什么：

```
boolean initiated; 
```

如果这个简单的解决方案不能解决它，我建议使用 Deltaspike：

```
MyBean myBean = BeanProvider.getContextualReference(MyBean.class, true); 
```

请注意第二个参数 true - 来自文档：*如果您查找给定接口的实现并且不需要实现或者不需要存在具有给定限定符的实例，则将 true 作为第二个参数传递（请参阅限定符示例以获取更多详细信息）。* [http://incubator.apache.org/deltaspike/core.html](http://incubator.apache.org/deltaspike/core.html)

最后，您可以使用事件。在 CDI 中使用事件非常简单。您需要做的是在创建 bean 时触发事件并让另一个 bean 观察该事件。 [http://docs.jboss.org/weld/reference/latest/en-US/html/events.html](http://docs.jboss.org/weld/reference/latest/en-US/html/events.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-28T15:34:51.717

作为替代方案，您可以使用 CDI[`BeanManager`](http://docs.jboss.org/cdi/api/1.0/javax/enterprise/inject/spi/BeanManager.html)在给定上下文（或根本没有上下文）中手动提取 bean。以 JSF 上下文为例，您可以使用以下代码片段来拉取`MyBean`上下文中的所有活动实例。

```
 public void findBean(String beanName, FacesContext facesContext){
       BeanManager cdiBeanManager = (BeanManager)((ServletContext) facesContext.getExternalContext().getContext()).getAttribute("javax.enterprise.inject.spi.BeanManager"); //get the BeanManager in your operational context
       Bean bean = cdiBeanManager.getBeans(beanName).iterator().next(); //this actually returns a Set, but you're only interested in one
       CreationalContext ctx = cdiBeanManager.createCreationalContext(bean);
       MyBean theActualBean = cdiBeanManager.getReference(bean, bean.getClass(),ctx); //retrieve the bean from the manager by name. You're guaranteed to retrieve only one of the same name within the given context;

   } 
```

这是一个纯 Java EE 实现，没有第三方库

# java - 在 java (JDBC) 中读取在 python 中使用 sqlite 3 创建的 blob

> ID：15617914
> 
> 赞同：2
> 
> 时间：2013-03-25T14:50:27.633
> 
> 标签：java, python, jdbc, sqlite, blob

我有一个 sql 表，其中包含使用以下 python 命令生成的 blob：sqlite3.Binary(numpy.float64(array)) 或 sqlite3.Binary(array)。

我保存了数据库，现在我想用 java 中的 JDBC 加载它。似乎不推荐使用 getBlob 方法，但我可以使用 getBytes("myarray") 来检索数组。从那时起，我不清楚如何让我的花车或双打回来。我在互联网上发现了几个或多或少相同的“解决方案”。目前，我使用类似于下面加入的方法，但它没有为我提供预期的浮点值。我做错了什么或者我忘记了什么？

```
static float[] ConvertByteArrayToFloat(byte[] bytes)
{
    float[] floats = new float[bytes.length / 8];
    ByteBuffer buf2 = ByteBuffer.wrap(bytes);
    for (int i = 0; i < floats.length; i++){
        floats[i] = buf2.getFloat(i*8);
    }
    return floats;
} 
```

# azure - Azure 网站 - 跨子域共享登录状态

> ID：15617917
> 
> 赞同：4
> 
> 时间：2013-03-25T14:50:38.540
> 
> 标签：azure, asp.net-mvc-4, simplemembership, azure-web-app-service

我在 Azure 网站上有两个网站，我使用 CNAME 将它们与我自己的域名一起使用。

我们将这两个站点称为 site1.example.com 和 site2.example.com。

我正在使用 ASP.NET MVC 4 和 SimpleMembership。我希望用户能够登录 site1.example.com，并让 site2.example.com 接受该登录状态。

这是我到目前为止所做的：

*   site1 和 site2 都指向同一个成员数据库（web.config 中的连接字符串设置相同，并且 InitializeSimpleMembershipAttribute 设置为查看该连接字符串）
*   我已将 cookie 域设置为 .example.com（在 web.config、system.web 身份验证部分）
*   我已手动将 system.web 配置中的 machineKey 设置为两个站点的相同内容

但是，如果我在 site1 上登录，那么我没有在 site2 上登录。我可以看到 .ASPXAUTH cookie 已在 .example.com 上正确设置，因此两者都可见。

那么，我错过了什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-12-18T12:01:29.753

如果您使用 AJAX 请求登录（例如通过 Web API），请尝试包含

```
xhrFields: { withCredentials: true } 
```

就像是

```
$.ajax({ method: 'POST',
        url: 'yourloginurl.com/api/login',
        xhrFields: { withCredentials: true }, 
        success: function (data) { ... } }); 
```

在 httpCookie 上设置域后。

我花了一天时间找到这个解决方案，这解决了我的问题。

# java - 在执行 mmap 时，C 或 Java 会有任何显着的性能差异吗？

> ID：15617920
> 
> 赞同：1
> 
> 时间：2013-03-25T14:50:44.693
> 
> 标签：java, c, mmap, memory-mapped-files

我有一个 50GB 的文件，它是一个排序的 csv 文件。

如果我使用 C 或 java 使用内存映射访问对该文件执行查找，理论上会有什么不同吗？

我猜因为文件访问被推到操作系统级别，它真的不应该有太大的区别，对吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-25T15:19:40.163

*理论上*，由于Java 的面向对象的方法调用需要额外的间接调用，并且可能需要跨越 Java/JNI 边界，Java 将无限慢。

在*实践*中，Hotspot 编译器优化了直接的 ByteBuffer 访问，页面错误的代价将远远超过额外的内存间接访问。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-05-21T21:09:12.390

Java 一次只能映射 2 GB。这是因为 ByteBuffer 使用 32 位整数来表示长度、大小等。因此，您的 50 GB 文件需要 25 个 mmap。C 可以只创建一个 mmap，尽管它不能移植到 1990 年代的计算机（如果你关心的话）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-25T16:06:47.610

直接回答问题。

C`mmap()`和 Java`FileChannel.map()`被认为是非常等价的，不会有显着的性能差异。

# java - 使用可比较或比较器接口使用字符串 s1 的顺序对字符串 s2 进行排序

> ID：15617928
> 
> 赞同：3
> 
> 时间：2013-03-25T14:51:04.460
> 
> 标签：java, string, comparator, comparable

我有两个字符串 s1 和 s2，我想根据 s1 中字母的出现顺序对 s2 进行排序，如果其他字母留在 s2 中，则按字母顺序对它们进行排序。

假设我有以下内容；

字符串 s1 = "战争";

String s2 = "做程序员真棒";

输出：waaarrrIbeeeeggimmmnoopsst。

我已经编写了一个代码来做到这一点，但我想知道是否可以使用比较器/可比较接口来解决它。

下面列出的是我的代码片段。

```
public class Sort {

    private static String a = "war";
    private static String b = "Its awesome being a programmer";
    static List<Character> list = new ArrayList<>();

    static public void main(String[] args) {
        Character s;
        Character x;

        System.out.println("String to be sorted: '" + b + "'");
        System.out.println("Key for sort: '" + a + "'");

        /* 
         * put all the string in a list 
         */
        for (int i = 0; i < b.length(); i++) {
            s = b.charAt(i);
            if (s != ' ') {
                list.add(s);
            }
        }
        /* 
         * compare individual chac in key with individaul char in string to sort 
         */
        StringBuilder sb = new StringBuilder();
        for (int j = 0; j < a.length(); j++) {
            x = a.charAt(j);
            for (int k = 0; k < b.length(); k++) {
                s = b.charAt(k);
                if (x == s) {
                    sb.append(s);
                    list.remove(x);
                }
            }
        }

        /* 
         * check if list is empty if not, sort and append the rest to the stringbuilder 
         */
        if (!list.isEmpty()) {
            Collections.sort(list);
            for (char c : list) {
                sb.append(c);
            }
        }
        System.out.println("Sorted version of string: '" + sb.toString() + "'");
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-25T15:33:43.003

```
private static String a = "war";
private static String b = "Its awesome being a programmer".replace(" ","");
private static String answer = "waaarrrIbeeeeggimmmnoopsst";

public static void main(String[] args) {
    List<String> characters = new ArrayList<String>(b.length());
    for (int i=0;i<b.length();i++){
        characters.add(String.valueOf(b.charAt(i)));
    }
    Collections.sort(characters,new CompareIt(a));
    String sortedString = listToString(characters);
    System.out.println(sortedString);
    System.out.println(answer);
    System.out.println(answer.equals(sortedString));
}
private static String listToString(List<String> listOfStrings){
    StringBuilder builder = new StringBuilder();
    for (String str : listOfStrings){
        builder.append(str);
    }
    return builder.toString();
}
private static class CompareIt implements Comparator<String>{

    private final String source;

    public CompareIt(String source) {
        super();
        this.source = source;
    }

    public int compare(String o1, String o2) {
        int i1 = source.indexOf(o1);
        int i2 = source.indexOf(o2);
        if (i1==-1 && i2!=-1){
            return 1;
        } else if (i1!=-1 && i2==-1){
            return -1;
        } else if (i1!=-1 && i2!=-1){
            return i1 > i2 ? 1:-1;
        } else {
            return o1.compareTo(o2);
        }
    }

} 
```

这似乎有效。已编辑：包括结果与所提供的预期答案相匹配的 sysout。EDIT2：我有最终索引比较的错字？1:0 而不是 1:-1。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-25T16:09:43.847

```
public static Comparator<Character> compareOn(final String key) {
    return new Comparator<Character>() {
        public int compare(Character c1, Character c2) {
            final int indexInKey1 = key.indexOf(c1);
            final int indexInKey2 = key.indexOf(c2);
            final int result;
            if (indexInKey1 == -1 && indexInKey2 == -1) {
                result = c1.compareTo(c2); //fall back to natural ordering
            } else {
                if (indexInKey1 == -1) {
                    result = 1;
                } else if (indexInKey2 == -1) {
                    result = -1;
                } else {
                    result = indexInKey1 - indexInKey2;
                }
            }
            return result;
        }
    };
}

public static void main(String[] args) {
    final String a = "war";
    final String b = "Its awesome being a programmer";
    final List<Character> chars = new ArrayList<Character>();
    for (char c: b.toCharArray()) {
        if (c != ' ') {
          chars.add(c);
        }
    }
    Collections.sort(chars, compareOn(a));
    System.out.println(chars);
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-25T15:07:11.123

```
public static void main(String[] args) {
    String s1 = "war";
    String s2 = "Its awesome being a programmer";
    String result = "";
    for (int i = 0; i < s1.length(); i++) {
        int len = s2.length()
                - s2.replace(String.valueOf(s1.charAt(i)), "").length();
        s2 = s2.replace(String.valueOf(s1.charAt(i)), "").replace(" ", "");
        for (int j = 0; j < len; j++)
            result = result + String.valueOf(s1.charAt(i));
    }
    char[] remaining = s2.toCharArray();
    Arrays.sort(remaining);
    for (Character c : remaining)
        result = result + String.valueOf(c);

    System.out.println(result);
} 
```

试试这个：我试过没有使用任何界面。

输出：

```
waaarrrIbeeeeggimmmnoopsst 
```

# git - Git 稀疏检出后工作副本中的目录过多

> ID：15617933
> 
> 赞同：1
> 
> 时间：2013-03-25T14:51:23.480
> 
> 标签：git, msysgit, sparse-checkout

我们有一个 git repo *（远程托管在 github - 我们称之为 Clients repo）*，根目录中有 210 多个目录。我们有 210 多台 Windows 服务器，每台服务器都需要其中一个根目录，而实际上并不需要其他根目录。

所以我们登录到其中一台服务器，并使用*1.8.1.msysgit.1*

1.  从 git hub 克隆客户端 repo
2.  打开稀疏结帐
3.  使用我们希望在此服务器工作副本中的单个 *directory/* 更新稀疏签出文件
4.  执行我们的读树操作

10 次中有 9 次一切正常，并且工作副本包含我们期望的单个目录。

然而，每隔一段时间，它就不会像预期的那样工作，我们也会得到一些其他目录流到工作副本中。它从来都不是完整的 210+，但会在 6-10 个其他目录之间。这些目录与所需目录的模式不匹配，也没有与所述模式匹配的任何子目录。

一旦发生这种情况，我们就永远无法解决本地 repo。我们尝试过：

*   各种复位
*   各种读树
*   禁用/重新启用稀疏结帐
*   检查日志以查看是否发生了任何奇怪的事情

最终，我们通常最终会删除本地 repo，再次执行相同的步骤，并且它只是第二次工作。

除了重复克隆、设置稀疏签出等之外，我们还没有找到可靠地重现该问题的方法。在这种情况发生的 20 次左右中，它只在非 Windows 机器上发生过一次（我们有一个运行 git v1.8.1.5 的 ubuntu 服务器，两周前显示了同样的问题）。

我的 Google-Fu 在这方面很弱。我希望能深入了解为什么会发生这种情况，以及任何不让我们删除存储库并重新克隆它的潜在解决方法。提前致谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-25T17:51:50.020

我曾经有朋友遇到过这个问题。事实证明，他们已经从 Unix 系统上的子目录中删除了文件，然后当他们`git reset`在 Windows 系统上删除文件时，它会从（现在）空目录中删除所有文件，但不会删除目录本身，因为 Git只跟踪内容，不跟踪目录。

是 Windows 系统上“更大”的文件夹子集吗？这些目录是空的吗？这可能是你的问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-25T17:47:09.763

Windows 的权限很不稳定。这些文件夹可能在稀疏结帐清理后遗留下来，可能需要进入并手动删除它们。他们可能是空的；）

# ios - 我在 uiview 上的 Imageview 没有响应触摸事件

> ID：15617936
> 
> 赞同：1
> 
> 时间：2013-03-25T14:51:33.980
> 
> 标签：ios, objective-c, uigesturerecognizer

```
viewImageView=[[UIImageView alloc] initWithImage:viewImage];
viewImageView.center=self.center;
[[self superview] addSubview:viewImageView]; 
```

我已将 imageview 添加到`superview.self`子`UIView`类中。但是当我点击或从右到左滚动`touchesbegin: withEvent:`并被`touchesEnded:withEvent:`调用时。但是当我点击或从左到右移动时..`touchesEnded:withEvent:`没有被调用。它正在调用`touchesCancelled:withEvent:`请帮助我解决这个问题。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-25T18:50:59.443

代替

```
[[self superview] addSubview:viewImageView]; 
```

尝试这个：

```
[[self view] addSubview:viewImageView]; 
```

# android - Android show two TimePickerDialog when pressing a button

> ID：15617943
> 
> 赞同：0
> 
> 时间：2013-03-25T14:51:56.837
> 
> 标签：android

is it possible to show two `TimePickerDialog` when clicking on a button. I want to show `TimePickerDialog` for `FROM` label and one `TimePickerDialog` for `TO` label.

I am creating application for football.

I found this howto: [http://www.botskool.com/geeks/how-create-time-picker-dialog-selecting-time-android](http://www.botskool.com/geeks/how-create-time-picker-dialog-selecting-time-android)

but is only for one TimePickerDialog

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-25T14:55:06.783

*   使用两个 TimePicker 小部件创建布局
*   将此布局与对话框一起使用。
*   添加适当的验证，您应该能够实现您所需要的。

# php - Fedex Shipping Labels API not sending Address 2

> ID：15617945
> 
> 赞同：1
> 
> 时间：2013-03-25T14:52:01.107
> 
> 标签：php, api, soap, wsdl, fedex

THE SOAP REQUEST AS SENT

```
<?xml version="1.0" encoding="UTF-8"?>
<SOAP-ENV:Envelope xmlns:SOAP-ENV="http://schemas.xmlsoap.org/soap/envelope/" xmlns:ns1="http://fedex.com/ws/ship/v12">
  <SOAP-ENV:Body>
    <ns1:ProcessShipmentRequest>
      <ns1:WebAuthenticationDetail>
        <ns1:UserCredential>
          <ns1:Key>kQyj3MtQGLJ3ZYWG</ns1:Key>
          <ns1:Password>66ywMwyasljK5uRkaNENRZCZW</ns1:Password>
        </ns1:UserCredential>
      </ns1:WebAuthenticationDetail>
      <ns1:ClientDetail>
        <ns1:AccountNumber>510087682</ns1:AccountNumber>
        <ns1:MeterNumber>100154483</ns1:MeterNumber>
      </ns1:ClientDetail>
      <ns1:TransactionDetail>
        <ns1:CustomerTransactionId>*** Express Domestic Shipping Request v12 using PHP ***</ns1:CustomerTransactionId>
      </ns1:TransactionDetail>
      <ns1:Version>
        <ns1:ServiceId>ship</ns1:ServiceId>
        <ns1:Major>12</ns1:Major>
        <ns1:Intermediate>1</ns1:Intermediate>
        <ns1:Minor>0</ns1:Minor>
      </ns1:Version>
      <ns1:RequestedShipment>
        <ns1:ShipTimestamp>2013-03-25T14:33:08+00:00</ns1:ShipTimestamp>
        <ns1:DropoffType>REGULAR_PICKUP</ns1:DropoffType>
        <ns1:ServiceType>FEDEX_GROUND</ns1:ServiceType>
        <ns1:PackagingType>YOUR_PACKAGING</ns1:PackagingType>
        <ns1:TotalWeight>
          <ns1:Units>LB</ns1:Units>
          <ns1:Value>17.22</ns1:Value>
        </ns1:TotalWeight>
        <ns1:Shipper>
          <ns1:Contact>
            <ns1:PersonName>Shipping Department</ns1:PersonName>
            <ns1:CompanyName>Big Dog Treestands</ns1:CompanyName>
            <ns1:PhoneNumber>3092636800</ns1:PhoneNumber>
          </ns1:Contact>
          <ns1:Address>
            <ns1:StreetLines>120 E. Detroit Parkway</ns1:StreetLines>
            <ns1:City>Morton</ns1:City>
            <ns1:StateOrProvinceCode>IL</ns1:StateOrProvinceCode>
            <ns1:PostalCode>61550</ns1:PostalCode>
            <ns1:CountryCode>US</ns1:CountryCode>
          </ns1:Address>
        </ns1:Shipper>
        <ns1:Recipient>
          <ns1:Contact>
            <ns1:PersonName>David Sinc</ns1:PersonName>
            <ns1:CompanyName>TEST COMPANY</ns1:CompanyName>
            <ns1:PhoneNumber>3093701229</ns1:PhoneNumber>
          </ns1:Contact>
          <ns1:Address>
            <ns1:StreetLines>1202 Chalet Ln</ns1:StreetLines>
            <ns1:StreetLines>HIDDLY- Test Account</ns1:StreetLines>
            <ns1:City>PEORIA</ns1:City>
            <ns1:StateOrProvinceCode>IL</ns1:StateOrProvinceCode>
            <ns1:PostalCode>61614</ns1:PostalCode>
            <ns1:CountryCode>US</ns1:CountryCode>
            <ns1:Residential>false</ns1:Residential>
          </ns1:Address>
        </ns1:Recipient>
        <ns1:ShippingChargesPayment>
          <ns1:PaymentType>SENDER</ns1:PaymentType>
          <ns1:Payor>
            <ns1:ResponsibleParty>
              <ns1:AccountNumber>510087682</ns1:AccountNumber>
              <ns1:Contact/>
              <ns1:Address>
                <ns1:CountryCode>US</ns1:CountryCode>
              </ns1:Address>
            </ns1:ResponsibleParty>
          </ns1:Payor>
        </ns1:ShippingChargesPayment>
        <ns1:LabelSpecification>
          <ns1:LabelFormatType>COMMON2D</ns1:LabelFormatType>
          <ns1:ImageType>PDF</ns1:ImageType>
          <ns1:LabelStockType>PAPER_8.5X11_TOP_HALF_LABEL</ns1:LabelStockType>
        </ns1:LabelSpecification>
        <ns1:RateRequestTypes>ACCOUNT</ns1:RateRequestTypes>
        <ns1:PackageCount>1</ns1:PackageCount>
        <ns1:RequestedPackageLineItems>
          <ns1:SequenceNumber>1</ns1:SequenceNumber>
          <ns1:GroupPackageCount>1</ns1:GroupPackageCount>
          <ns1:Weight>
            <ns1:Units>LB</ns1:Units>
            <ns1:Value>17.22</ns1:Value>
          </ns1:Weight>
        </ns1:RequestedPackageLineItems>
      </ns1:RequestedShipment>
    </ns1:ProcessShipmentRequest>
  </SOAP-ENV:Body>
</SOAP-ENV:Envelope> 
```

Fedex APpplication Code

```
<?php

// Copyright 2009, FedEx Corporation. All rights reserved.
// Version 12.0.0

require_once('library/fedex-common.php5');

//The WSDL is not included with the sample code.
//Please include and reference in $path_to_wsdl variable.
$path_to_wsdl = "http://bigdog.webdesign309.com/wp-content/themes/bigdogtreestands-new/woocommerce/emails/ShipWebServiceClient/wsdl/ShipService_v12.wsdl";
$uploads = wp_upload_dir();
define('SHIP_LABEL', $uploads['basedir'].'/shippinglabels/shipexpresslabel'.str_replace('#','',$order->get_order_number()).'.pdf');  // PNG label file. Change to file-extension .pdf for creating a PDF label (e.g. shiplabel.pdf)

ini_set("soap.wsdl_cache_enabled", "0");

$client = new SoapClient($path_to_wsdl, array('trace' => 1)); // Refer to http://us3.php.net/manual/en/ref.soap.php for more information

$request['WebAuthenticationDetail'] = array(
    'UserCredential' => array(
        'Key' => getProperty('key'), 
        'Password' => getProperty('password')
    )
);
$request['ClientDetail'] = array(
    'AccountNumber' => getProperty('shipaccount'), 
    'MeterNumber' => getProperty('meter')
);
$request['TransactionDetail'] = array('CustomerTransactionId' => '*** Express Domestic Shipping Request v12 using PHP ***');
$request['Version'] = array(
    'ServiceId' => 'ship', 
    'Major' => '12', 
    'Intermediate' => '1', 
    'Minor' => '0'
);
$ships = $order->get_shipping_method();
$shippingType = "FEDEX_GROUND";
if($ships == "Fedex  Ground"){
    $shippingType = "FEDEX_GROUND"; 
}
else if( $ships == "Fedex  2 Day"){
    $shippingType = "FEDEX_2_DAY"; 
}
else if($ships == "Fedex  Standard Overnight"){
    $shippingType = "STANDARD_OVERNIGHT"; 
}
else if($ships == "Fedex  Home Delivery"){
         $shippingType = "GROUND_HOME_DELIVERY"; 
}
function totalOrderWeight($orders) {
    $totalWeight = 0;
    $items = $orders->get_items();
    foreach($items as $item) {
        $product = get_product( $item['product_id'] );
        $quantity = intval( $item['qty'] );
        $totalWeight +=  $product->get_weight() * $quantity;
    }
    return $totalWeight;
}

$request['RequestedShipment'] = array(
    'ShipTimestamp' => date('c'),
    'DropoffType' => 'REGULAR_PICKUP', // valid values REGULAR_PICKUP, REQUEST_COURIER, DROP_BOX, BUSINESS_SERVICE_CENTER and STATION
    'ServiceType' => $shippingType, // valid values STANDARD_OVERNIGHT, PRIORITY_OVERNIGHT, FEDEX_GROUND, ...
    'PackagingType' => 'YOUR_PACKAGING', // valid values FEDEX_BOX, FEDEX_PAK, FEDEX_TUBE, YOUR_PACKAGING, ...
    'TotalWeight' => array('Value' => totalOrderWeight($order), 'Units' => 'LB'), // valid values LB and KG
    'Shipper' => addShipper(),
    'Recipient' => addRecipient($order),
    'ShippingChargesPayment' => addShippingChargesPayment(),
    'LabelSpecification' => addLabelSpecification(),  
    'RateRequestTypes' => array('ACCOUNT'), // valid values ACCOUNT and LIST
    'PackageCount' => 1,
    'RequestedPackageLineItems' => array(
        '0' => addPackageLineItem1(totalOrderWeight($order))
    )
);
try 
{
    if(setEndpoint('changeEndpoint'))
    {
        $newLocation = $client->__setLocation(setEndpoint('endpoint'));
    }

    $response = $client->processShipment($request);  // FedEx web service invocation

    if ($response->HighestSeverity != 'FAILURE' && $response->HighestSeverity != 'ERROR')
    {       
        printSuccess($client, $response);

        $label = 
        // Create PNG or PDF label
        // Set LabelSpecification.ImageType to 'PDF' or 'PNG for generating a PDF or a PNG label       
        $fp = fopen(SHIP_LABEL, 'wb');   
        fwrite($fp, $response->CompletedShipmentDetail->CompletedPackageDetails->Label->Parts->Image); //Create PNG or PDF file
        fclose($fp);
     //   echo '<a href="'.$uploads['url'].'/shippinglabels/shipexpresslabel'.str_replace('#','',$order->get_order_number()).'.pdf">Click Here to Download Shipping Label</a> was generated.';
    }
    else
    {
        printError($client, $response);
    }

    writeToLog($client);    // Write to log file

} catch (SoapFault $exception) {
    printFault($exception, $client);
}
function addShipper(){
    $shipper = array(
        'Contact' => array(
            'PersonName' => 'Shipping Department',
            'CompanyName' => 'Big Dog Treestands',
            'PhoneNumber' => '3092636800'),
        'Address' => array(
            'StreetLines' => array('120 E. Detroit Parkway'),
            'City' => 'Morton',
            'StateOrProvinceCode' => 'IL',
            'PostalCode' => '61550',
            'CountryCode' => 'US')
    );
    return $shipper;
}
function addRecipient($orders){ 
    $residential = get_post_meta($orders->get_order_number(), '_residential-indicator');
/*  echo 'Shipping Address 2:'.$orders->shipping_address_2;
    echo 'Shipping Address 1:'.$orders->shipping_address_1; */
    if($orders->shipping_address_2){
        $addressArray = array($orders->shipping_address_1, $orders->shipping_address_2); 
/*      echo 'Shipping Address 2'; */
            /* $addressArray =array('StreetLines' => array('Address Line 1' => $orders->shipping_address_1, 'Address Line 2' => $orders->shipping_address_2)); */
    }
    else{
        $addressArray = array($orders->shipping_address_1);
/*      echo 'Shipping Address 1'; */
    }
    $joy = false;
    if($residential == 1){
        $joy = true;
    }
    else{
        $joy = false;
    }
            $recipient = array(
        'Contact' => array(
            'PersonName' =>  $orders->billing_first_name . ' ' . $orders->billing_last_name,
            'CompanyName' => $orders->shipping_company,
            'PhoneNumber' => $orders->billing_phone),
/*          'Address' => array(
            'StreetLines' =>  array($orders->shipping_address_1, $orders->shipping_address_2),
            'City' => $orders->shipping_city,
            'StateOrProvinceCode' => $orders->shipping_state,
            'PostalCode' => $orders->shipping_postcode,
            'CountryCode' => 'US',
            'Residential' => $joy) */
        'Address' => array(
             'StreetLines'=>array($orders->shipping_address_1, $orders->shipping_address_2),
            //array(utf8_encode($orders->shipping_address_1), utf8_encode($orders->shipping_address_2)),
            'City' => $orders->shipping_city,
            'StateOrProvinceCode' => $orders->shipping_state,
            'PostalCode' => $orders->shipping_postcode,
            'CountryCode' => 'US',
            'Residential' => $joy)
    );
    return $recipient;                                      
}
function addShippingChargesPayment(){
    $shippingChargesPayment = array('PaymentType' => 'SENDER',
        'Payor' => array(
        'ResponsibleParty' => array(
            'AccountNumber' => getProperty('billaccount'),
            'Contact' => null,
            'Address' => array('CountryCode' => 'US'))));
    return $shippingChargesPayment;
}
function addLabelSpecification(){
    $labelSpecification = array(
        'LabelFormatType' => 'COMMON2D', // valid values COMMON2D, LABEL_DATA_ONLY
        'ImageType' => 'PDF',  // valid values DPL, EPL2, PDF, ZPLII and PNG
        'LabelStockType' => 'PAPER_8.5X11_TOP_HALF_LABEL');
    return $labelSpecification;
}
function addPackageLineItem1($weight){
    $packageLineItem = array(
        'SequenceNumber'=>1,
        'GroupPackageCount'=>1,
        'Weight' => array(
            'Value' => $weight,
            'Units' => 'LB')

    );
    return $packageLineItem;
}

?> 
```

It returns this [http://bigdog.webdesign309.com/assets/shippinglabels/shipexpresslabel1303.pdf](http://bigdog.webdesign309.com/assets/shippinglabels/shipexpresslabel1303.pdf)

I have tried everything even calling fedex and they say that they provide no support for this issue as the code is a convenience rather than a service. If anyone can shed some light on this most puzzling issue as to why the second address field never shows up that would be great. Any thoughts on this one?

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2016-05-03T19:00:51.050

如果其他人遇到此问题，请注意 FedEx 的暂存环境中的测试标签似乎从未包含第二个地址行。

我所有的测试标签都没有第二行地址，但是一旦我切换到生产服务器，标签就有第二行。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-11-14T17:08:11.383

它应该有多个地址行，因为您的 XML 看起来有效。FedEx 支持应该能够根据 SOAP 请求/响应提供帮助，但不会为您的 PHP 编码提供帮助。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-10-24T18:01:22.610

根据 Ship Service Docs，您只有两条地址行，我这样解决：

```
'Address' => array(
        'StreetLines' => array($array_recipient["address_1"],$array_recipient["address_2"]),
        'City' => $array_recipient["City"],
        'StateOrProvinceCode' => $array_recipient["StateOrProvinceCode"],
        'PostalCode' => $array_recipient["PostalCode"],
        'CountryCode' => 'MX',
        'Residential' => true
    ) 
```

如果您需要更多“空间”，您可以使用 CUSTOMER_REFERENCE（尺寸后的刚性）：

```
$packageLineItem = array(
    'SequenceNumber'=>1,
    'GroupPackageCount'=>1,
    'Weight' => array(
        'Value' => $dimension_array["weight"],
        'Units' => 'KG'
    ),
    'Dimensions' => array(
        'Length' => $dimension_array["length"],
        'Width' => $dimension_array["width"],
        'Height' => $dimension_array["height"],
        'Units' => 'CM'
    ),
    'CustomerReferences' => array(
    'CustomerReferenceType' => 'CUSTOMER_REFERENCE',
    'Value' => $dimension_array["more_references"]
    ), 
```

如果您在测试环境中提出请求，第二个地址不会显示，但在生产后，第二个地址会显示。

希望这对您有所帮助。

# html - span tag with and without content works differently

> ID：15617946
> 
> 赞同：2
> 
> 时间：2013-03-25T14:52:01.967
> 
> 标签：html, css

I have html code:

```
<ul>
     <li><span class="a">aaa</span><span class="b">bbb</span></li>
     <li><span class="a">aaa</span><span class="b">bbb</span></li>
     <li><span class="a">aaa</span><span class="b">bbb</span></li>
</ul> 
```

and css:

```
ul {
    list-style: none;
    margin: 0;
    padding: 0;
}

.a {
    width: 100px;
    height: 60px;
    display: inline-block;
    background-color: #900;
}

.b {
    width: 100px;
    height: 60px;
    display: inline-block;
    background-color: #009;
} 
```

Works fine if in both spans (`class="a"` and `class="b"`) are some content writed.

If remove text from `span class="b"`, now result is not desirable

[http://jsfiddle.net/hm3sh/1/](http://jsfiddle.net/hm3sh/1/)

Tell please why this happened ?

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-25T14:54:22.250

添加`vertical-align: top`到两个跨度；即使两者都没有内容，这也应该使它们按需要工作。

[http://jsfiddle.net/ExplosionPIlls/hm3sh/2/](http://jsfiddle.net/ExplosionPIlls/hm3sh/2/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-25T14:59:11.247

尝试放入`float:left;`span 类

[http://jsfiddle.net/hm3sh/7/](http://jsfiddle.net/hm3sh/7/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-25T14:57:20.020

这对我来说很好：http: [//jsfiddle.net/hm3sh/4/](http://jsfiddle.net/hm3sh/4/)

```
.a {
    width: 100px;
    height: 60px;
    float: left;
    clear: both;
    background-color: #900;
}

.b {
    width: 100px;
    height: 60px;
    background-color: #009;
    display: block;
    float: left;
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-25T15:27:15.043

添加后我尝试尝试不同的情况：

```
.a {
....
float:left;
....
} 
```

它工作得很好，特别是在边距和填充设置为 0 时`ul {...`。我知道还有其他解决方案，但我认为这个可能性很小。

# c - C - reading a file and segmentation fault

> ID：15617949
> 
> 赞同：0
> 
> 时间：2013-03-25T14:52:06.950
> 
> 标签：c, linux, file, readfile

Im writing a program in C (eclipse in linux) so I need to open a big text file and read it (and than try with diffrent size of buffer each time)

Anyways, this is the code and I don't understand why Im getting segmentation fault from the open function

```
int main(void)
{
    int fd;
    char* buff[67108864];
    FILE *testfile;
    double dif;
    fd = open("testfile.txt", O_RDONLY);
    if (fd>=0) {
        read(fd,buff,67108864);
        close(fd);      }

    return 0;
} 
```

I have edited my question but now if I change my buffer to the biggest size I need (67108864 bytes) im still getting segmentation fault...

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-25T14:54:21.027

```
char buff; 
```

应该是一个指针

```
char *buff; 
```

此外，在阅读之后，`read(fd,buff,(sizeof(char)));`您应该分配更多内存来使用 realloc 进行缓冲。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-25T14:54:16.697

好吧，如果您想将内存分配给buff，则需要将其设为指针..

```
char* buff; 
```

还要注意你只分配一个字符..你应该考虑一下，我认为你想使用更多的内存..

另一个常见的事情是不使用动态内存进行文件读取..

尝试：

```
char buff[100]; 
```

然后只是相同的代码...

```
read(fd,buff,100)); 
```

然后继续读取直到查找完成，读取返回实际读取的字节数。

也像上面评论的那样，您在初始化它之前使用 testfile ..这也是访问冲突

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-25T17:49:22.047

改变

```
char* buff[67108864] 
```

至

```
char buff[67108864] 
```

你需要的是一个字符数组，而不是一个字符点数组。

# jms - JMS selector to test if variable exists?

> ID：15617954
> 
> 赞同：1
> 
> 时间：2013-03-25T14:52:16.153
> 
> 标签：jms, selector

I want to create a JMS selector to test if a variable exists and if the variable exists, if its value is right. A selector like this :

```
(uid NOT EXISTS) OR (uid='foo') 
```

What is the right statement please to do this ?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-26T09:55:45.043

为尚未设置的名称获取属性值的处理方式就像该属性以空值存在一样。因此，如果属性不存在，则将其视为空值。

在 JMS 命名法中，它被称为不存在的属性。

因此，您可以将 JMS 选择器设置为，

```
uid is null or uid='foo' 
```

# amazon-ec2 - How to monitor different metrics for scaling an application on Amazon

> ID：15617955
> 
> 赞同：1
> 
> 时间：2013-03-25T14:52:16.750
> 
> 标签：amazon-ec2, scalability, amazon-cloudwatch

Is that possible to decide about scalability based upon multiple metrics. For example, I wanna check both the "CPU Utilization" and "number of requests" together and then decide whether I need to Scale my application or not.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-25T15:00:03.127

[目前，根据https://forums.aws.amazon.com/thread.jspa?messageID=223753](https://forums.aws.amazon.com/thread.jspa?messageID=223753)和[https://forums.aws.amazon.com/thread.jspa](https://forums.aws.amazon.com/thread.jspa?threadID=94984)，我不认为这是可能的[?threadID=94984](https://forums.aws.amazon.com/thread.jspa?threadID=94984)。

您确实可以使用自定义 CloudWatch 指标作为扩展来源。因此，您可以根据其他数据创建自己的指标来决定如何/何时扩展，而不是尝试使用两个指标。

[这是有关自定义 CloudWatch 指标](http://aws.typepad.com/aws/2011/05/amazon-cloudwatch-user-defined-metrics.html)可用性的原始博客文章。此外，这是一篇关于[将 AutoScaling 与它们一起使用](http://www.thatsgeeky.com/2012/01/autoscaling-with-custom-metrics/)的帖子。

这应该使您能够根据您的系统的可扩展事件的构成来尽可能细化。

# odata - breezejs with odata error (odata4j)

> ID：15617957
> 
> 赞同：0
> 
> 时间：2013-03-25T14:52:30.630
> 
> 标签：odata, breeze

Using breeze.js (master branch) and angular on client with odata4j on the server-side, I'm receiving the following error if i want to query for countries:

```
var query = breeze.EntityQuery.from('Country');
entityManager.executeQuery(query).then(...).fail(...);

-> Unable to locate a 'Type' by the name: Country:#odataContainer 
```

I've configured breeze as follows:

```
 breeze.config.initializeAdapterInstances({dataService: "OData"});
  breeze.NamingConvention.none.setAsDefault(); 
```

.../$metadata OData response:

```
<?xml version="1.0" encoding="utf-8"?>
<edmx:Edmx Version="1.0" xmlns:edmx="http://schemas.microsoft.com/ado/2007/06/edmx">
 <edmx:DataServices m:DataServiceVersion="2.0" xmlns:m="...">
   <Schema Namespace="odataContainer" xmlns="...">
     <EntityContainer Name="odataEntities" m:IsDefaultEntityContainer="true">
       <EntitySet Name="Country" EntityType="odataModel.Country">
       </EntitySet>
     </EntityContainer>
   </Schema>
   <Schema Namespace="odataModel" xmlns="...">
     <EntityType Name="Country">
       <Key>
         <PropertyRef Name="countryCode"></PropertyRef>
       </Key>
       <Property Name="region" Type="Edm.String" Nullable="true"></Property>
       <Property Name="population" Type="Edm.Int32" Nullable="false"></Property>
       <Property Name="countryCode" Type="Edm.String" Nullable="false"></Property>
       <Property Name="name" Type="Edm.String" Nullable="true"></Property>
     </EntityType>
   </Schema>
 </edmx:DataServices>
</edmx:Edmx> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-18T17:30:04.933

您需要在项目中包含模型的命名空间。如果您的`Country`班级在`odataModel.Country`您需要添加第三行来配置`oData`服务：

```
ODataModelBuilder builder = new ODataConventionModelBuilder();
builder.EntitySet<Department>("Countries");
builder.Namespace = "odataModel.Country"; 
```

# mysql - Unit testing CakePHP application that uses stored procedures

> ID：15617961
> 
> 赞同：4
> 
> 时间：2013-03-25T14:52:36.283
> 
> 标签：mysql, unit-testing, cakephp, stored-procedures

Does anyone know of the correct way to develop unit tests for a CakePHP 2.3.1 application that utilises MySQL stored procedures?

I've looked on the cake site but the documentation on testing isn't huge. I've checked out SO and Google as well - can't seem to find mention of the problem/situation.

The unit testing is using fixtures, not a real database for the data.

Any help/pointers are really appreciated!

J

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-26T10:28:23.380

重载 Fixture 的 create() 方法。不要忘记调用父级的 create() 并删除创建过程语句中结束 END 之后的最终分隔符。

例如：

```
public function create($db){
    parent::create($db);
    // create stored procedures ...
    $db->execute("CREATE PROCEDURE … <insert SQL here> … END", array('log' => false));
} 
```

create() 方法可以在夹具表创建后执行您需要的任何语句。

我希望它会工作

# c# - Json.NET Primitive Types - use Decimal instead of Double

> ID：15617963
> 
> 赞同：11
> 
> 时间：2013-03-25T14:52:44.207
> 
> 标签：c#, json.net

How can I make JSON.NET return a decimal instead of a double when parsing floats from JSON? (it's an object with a `Dictionary<string,object>` that is serialized).

I've tried writing a JsonConverter but the CanConvert method doesn't get called with a Double type in order to try and convert it. There's other code regarding overriding JsonTextReader but this doesn't seem possible in the latest versions of Json.Net.

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2013-06-12T10:44:13.783

在 Json.NET 5.0 中，`Newtonsoft.Json.JsonSerializerSettings`类有新的属性`FloatParseHandling`，你可以设置这个属性值`Newtonsoft.Json.FloatParseHandling.Decimal`

# mysql - 从 MySQL 中选择作为“检查点”开始

> ID：15617964
> 
> 赞同：0
> 
> 时间：2013-03-25T14:52:47.487
> 
> 标签：mysql

我不确定这是如何正确调用的，所以我将尝试用一个例子来解释自己：

想象一下，在 2013 年 1 月 1 日，你开始上学`X`。我们将其输入到 MySQL 表中，例如：

```
user | day      | school
1    | 1.1.2013 | X 
```

现在，在 2013 年 6 月 1 日，您将学校更改为`Y`. 让我们输入这个事实：

```
user | day      | school
1    | 1.1.2013 | X
1    | 1.6.2013 | Y 
```

再一次，你第三次换学校：

```
user | day      | school
1    | 1.1.2013 | X
1    | 1.6.2013 | Y
1    | 4.3.2015 | Z 
```

现在，**查询**：

> 2013 年 3 月 1 日你在哪所学校上学？

答案是：`X`

我们如何将这样的查询写入 MySQL 以获得正确的答案？

*注意：*如果需要，MySQL 表结构可以与我提供的不同。
*注2：*这**不是**家庭作业。这是我面临的真实情况，但我还没有创建我的表，因为我不确定到目前为止最好的解决方案是什么。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-25T15:02:16.060

In order to make it properly store the 'day' column in DATE format - yyyy-mm-dd so you can sort it. and then run this. It will give you all days (actually only the most recent one, because of the LIMIT 1) in the past of the selected date, when the user signed in a school starting from the most recent one.

```
SELECT * FROM {table_name} WHERE day <= '2013-03-01' ORDER BY day DESC LIMIT 1 
```

In your case you will get school **1** since **2013-01-01**

Edit:

in case your expediture table contains the date (in DATE format) you can use a subquery.

```
SELECT e.*, (SELECT school FROM {table_name} WHERE day <= e.date ORDER BY day DESC LIMIT 1) AS school_attended
FROM expenditures e; 
```

If you provide the expeditures table scheme I can provide a better way probably.

# c# - 检查请求是否来自 Windows 应用程序

> ID：15617965
> 
> 赞同：0
> 
> 时间：2013-03-25T14:52:53.743
> 
> 标签：c#, php

我有一个生成 XML 文件的 .php 文件。我在我的 C# 应用程序中使用这个 XML，如果请求来自 Windows 应用程序，我想在这个 .php 文件中检查，因为我不希望用户在浏览器中查看这个页面。请帮我。祝你今天过得愉快。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-25T14:58:40.500

如何添加一些关键字来获取该 xml 文件？制作一些密码来获取该 xml，并请求像 myxml.php?key=mykeywordishere 这样的 php 文件，关键字可以用一些 md5 编码，这很重要。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-25T14:59:07.987

一种简单的方法可能是使用某个密钥作为秘密参数调用 php 脚本。

```
www.myweb.com/myfunction.php?pass=secretPassword 
```

此密钥将在您的#C 应用程序的调用中被硬编码。

然后您可以检查密码是否是您期望的密码，例如：

```
//hardcoded hashed pass with sha1, for example.
$myHashedPass = '40bd001563085fc35165329ea1ff5c5ecbdbbeef';

if(sha1($_GET['pass']) != $myHashedPass){
    die();
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-25T15:03:19.107

您应该考虑使用自定义**User-Agent**字符串并将**Content-Type**设置为类似`"application/octet-stream".`

或者在 C# 应用程序中使用硬编码密码。

如果安全性很重要，您还应该使用**HTTPS**，因为对 Wireshark 或任何类似程序有基本了解的人可以检索所有以前的信息。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-25T15:00:08.537

您可以在请求的标头中使用特殊的用户代理，因此您可以检查，例如，用户代理是“我的 C# 应用程序”。如果不是，则该请求不是由您的应用程序发出的。

有关如何更改用户代理的信息，请参阅[HttpRequest.UserAgent属性。](http://msdn.microsoft.com/en-us/library/system.web.httprequest.useragent.aspx)在 PHP 中，使用它来获取用户代理字符串：

```
$userAgent = $_SERVER['HTTP_USER_AGENT']; 
```

# ember.js - emberjs 和 ember-data - 通过表单提交创建记录返回未定义

> ID：15617967
> 
> 赞同：1
> 
> 时间：2013-03-25T14:53:01.800
> 
> 标签：ember.js, ember-data

我有这个**[jsfiddle](http://jsfiddle.net/mzseQ/5/)**。除了我无法通过提交评论表单来创建新评论外，一切正常。当我**提交表单时，控制台显示 undefined**。我希望实现的是获取现有帖子，然后创建属于该帖子的评论。所以这是事情的流程，用户将单击**帖子**，然后单击特定**的帖子标题**以显示它，然后单击**添加评论**以对该帖子发表评论。需要注意的是，此时点击**添加评论按钮**将返回**undefined**。

*代码的相关部分带有**addComment**和**save**方法。*

```
EmBlog.CommentNewController = Em.ObjectController.extend({

  needs: ['postsShow'],
  isAddingNew: false,

  addComment: function(body){

    post = this.get('controllers.postsShow.model');

    store = post.get('transaction');

    store.createRecord(EmBlog.Comment, {body: body});

    this.set('isAddingNew', true);
  },

 save: function(){
  console.log(this.store.commit());
 }  
}); 
```

**车把模板中的相关部分

```
<script type='text/x-handlebars' data-template-name='comment/new'>
  {{#if controller.isAddingNew}}
    <form {{action save on='submit'}}>
    {{view Ember.TextArea valueBinding="body" placeholder="body"}}
    <button type="submit"> save comment </button>  
    </form>
  {{/if}} 
  <br/>
  <div>
    <button {{action addComment}} {{bindAttr disabled="isAddingNew"}}>
      Add Comment
   </button>
 </div>
</script> 
```

**评论表单是通过“posts/show template”使用渲染提交的**

```
 <script type="text/x-handlebars" data-template-name="posts/show">
    <p> Comments</p>
    {{render 'comment/new' comments}}
</script> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-25T15:48:28.030

您需要`Comment`使用以下方法创建记录：

```
var comment = EmBlog.Comment.createRecord() 
```

或者

```
var transaction = this.get('store').transaction();
var comment = transaction.createRecord(EmBlog.Comment); 
```

您可以在用户填写表单之前创建记录，并将值绑定到该创建的记录并仅在用户单击保存时提交，或者您可以将文本区域绑定到控制器属性，然后创建并提交记录用户点击保存。

这是第二种方法的[更新小提琴](http://jsfiddle.net/mzseQ/6/)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-07-25T20:41:41.780

很棒的帖子。只说一句。使用最新的库，deletePost 不起作用...

未捕获的类型错误：无法调用未定义的方法“deleteRecord”

解决方案：

```
destroyPost: function (post) {
  post.one('didDelete', this, function () {
    this.transitionTo('posts.index');
  });
  post.deleteRecord();
  post.get('transaction').commit();
} 
```

# javascript - 等待 css 转换

> ID：15617970
> 
> 赞同：9
> 
> 时间：2013-03-25T14:53:11.650
> 
> 标签：javascript, jquery, css, css-transitions

我正在使用 css 转换来设置我的一个 div 的边距。我需要知道如何等待这种效果结束，以便我可以调用其他函数......有什么办法吗？我读了一些关于堆栈溢出的其他帖子，但它们看起来都与我的问题不同。

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2013-03-25T14:56:41.173

试试[这个](https://stackoverflow.com/a/9090128/973578)答案

每个浏览器的转换监听器事件都不同，因此下面的函数将找到要使用的监听器并返回正确的监听器。

```
function whichTransitionEvent(){
    var t;
    var el = document.createElement('fakeelement');
    var transitions = {
      'transition':'transitionend',
      'OTransition':'oTransitionEnd',
      'MozTransition':'transitionend',
      'WebkitTransition':'webkitTransitionEnd'
    }

    for(t in transitions){
        if( el.style[t] !== undefined ){
            return transitions[t];
        }
    }
}

var transitionEnd = whichTransitionEvent();
element.addEventListener(transitionEnd, theFunctionToInvoke, false);

function theFunctionToInvoke(){
// set margin of div here
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-25T14:58:10.590

您可以通过两种方式进行（假设在每个示例中转换需要 1 秒）：

[1.) 使用jQuery.animate](http://api.jquery.com/animate/)为该元素设置动画（而不是 CSS 过渡）：

```
$('#mydiv').animate({
    'margin-left': '10px',
}, {
    duration: 1000,
    complete: function () {
        // do stuff after animation has finished here
    }
}); 
```

2.) 在一段时间后制作动画：

```
window.setTimeout(function () {
    // do stuff after animation has finished here
}, 1000); 
```

编辑：我知道#2 是一个糟糕的解决方案，但我会继续这样做，以防其他人正在考虑与我相同的道路。

# ruby - 在 Ruby 中将 XLSX 和 XLS 文件拆分为更小的文件

> ID：15617971
> 
> 赞同：0
> 
> 时间：2013-03-25T14:53:16.090
> 
> 标签：ruby, ruby-on-rails-3.2

我需要使用 ruby​​ 解析 XLS/XLSX 文件。有一些很棒的 gem（roo、rubyXL、Spreadsheet 等）可用于这项工作，但不幸的是，这些都不能处理超过 50K 行的文件（~ 6-8 MB 文件）。

我正在考虑将 XLS/XLSX 文件拆分成更小的块。有没有办法拆分这些文件，然后我可以解析较小的文件？

**更新：** 正如@YevgeniyAnfilofyev 提到的，我最终为 XLS（电子表格）和 XLSX（rubyXL）使用了不同的库。不过，使用 ruby​​XL 时，内存占用量确实很高。

# php - UPDATE DB SET ... 用 0 或 1 填充一个特定的 VARCHAR，而不管我设置的值如何

> ID：15617972
> 
> 赞同：1
> 
> 时间：2013-03-25T14:53:21.727
> 
> 标签：php, mysql, database, sql-update

我正在通过 php mysqli 运行以下查询`$con->query($sql);`

PHP代码：

```
$sql = 'UPDATE registrations SET '.$update_columns_list.' WHERE registrationkey = "'.$registration['RegistrationKey'].'"';
echo "RESULT: ".$result = $con->query($sql); 
```

上例中的值`$sql`：

```
UPDATE registrations SET referenceid = "4469731" and action = "newregistration" and status = "newregistration" and registrationdatetimegmt = "1363371386" and billingmonth = "2013-03" and accessexpirationdatetimegmt = "1373957999" and returnurl = "https://api.mywebsite.com/login.aspx?siteid=209" and lastmodifieddatetimegmt = "1363371398" and studentkey = "12345-67890-12345-67890" and firstname = "amanda" and lastname = "hemingway" and email = "amandamhemingway@trashymail.com" and phonenumber = "111-111-1111" and city = "city" and state = "ca" and postalcode = "90210" and country = "us" and coursecode = "ABC-406" and coursetitle = "example course title" and courseproductcode = "t3310" WHERE registrationkey = "12345-67890-12345-67890" 
```

当我运行此查询时，一切似乎都很好（我收到“成功”消息并且受影响的行数与预期的一样）。但是，当我通过 phpMyAdmin 查看数据库中受影响的行时，我不断在“referenceid”列中找到 1 或 0 值。没有其他脚本影响此表或数据库。我无法确定何时放置 0 而不是 1 的任何模式。

`referenceid`和`keyid`字段都是' `VARCHAR(100)`s。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-25T14:59:36.690

您正在执行的更新语句执行布尔运算。这是我不喜欢的mysql中的一种行为。

当前的更新语句如下所示：

```
UPDATE tableName SET col1 = 2 AND col2 = 3 
```

并且`MySQL`服务器不会抛出任何异常，因为语法是允许的，并且它读取为：

```
UPDATE tableName SET col1 = (2 AND (col2 = 3)) 
```

如果要更新多个列，请使用`,`not 分隔列`AND`。

```
UPDATE registrations 
SET    referenceid = "4469731",
       action = "newregistration", ..... 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-25T15:03:43.573

When you update you don't add columns with and, rather than with a comma, so your Update should look like:

```
UPDATE registrations 
 SET referenceid = "4469731",
     action = "newregistration",
     status = "newregistration",
     registrationdatetimegmt = "1363371386",
     billingmonth = "2013-03",
     accessexpirationdatetimegmt = "1373957999",
     returnurl = "https://api.mywebsite.com/login.aspx?siteid=209",
     lastmodifieddatetimegmt = "1363371398",
     studentkey = "12345-67890-12345-67890",
     firstname = "amanda",
     lastname = "hemingway",
     email = "amandamhemingway@trashymail.com",
     phonenumber = "111-111-1111",
     city = "city",
     state = "ca",
     postalcode = "90210",
     country = "us",
     coursecode = "ABC-406",
     coursetitle = "example course title",
     courseproductcode = "t3310"
 WHERE registrationkey = "12345-67890-12345-67890" 
```

# excel - Excel找到合适的值将公式放在范围内

> ID：15617973
> 
> 赞同：1
> 
> 时间：2013-03-25T14:53:21.800
> 
> 标签：excel

抱歉标题不好，我不知道如何更好地表达这个。

这是我的问题，我有一个用于引用工作的电子表格。我手动调整材料的加价，直到总利润/总零售=保证金。有没有办法自动调整标记以达到所需的保证金？目前我只需要输入一个数字，看看结果如何，然后增加或减少数字，直到边距达到我想要的位置。

这是我目前使用的公式的概要...

```
Margin = Total Profit / Total Retail
Total Profit = Total Retail - Total Cost
Total Retail = Labor + Marked up Equipment
Marked up Equipment = (Tax and Shipping(10%) + Markup %) * Equipment Cost + Equipment cost 
```

所以我正在寻找的是让 excel 自动计算所需边距的标记百分比。

这可能吗？

附加信息。电子表格是用 Excel 2003 编写的，但我们将在一年内更新到 2013。因此，理想情况下，该解决方案将在 2003 年和 2013 年有效，但最终只能在 2013 年有效。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-25T14:56:24.060

如果这只是一个用于计算的电子表格，而不是您传递给客户的东西，Excel Solver Add-In（包含在 Excel 中，但默认情况下未激活）将满足您的需求。

# html - dijit 声明式事件处理程序

> ID：15617976
> 
> 赞同：1
> 
> 时间：2013-03-25T14:53:32.443
> 
> 标签：html, css, dojo

我正在尝试声明 a`dijit TextBox`但我无法将`focus`事件附加到它。

我试过以声明方式这样做：

```
<div class="midArea_div">
 <div class="searchBox_div">
   <input type="text" data-dojo-name="searchBox_input" data-dojo-type="dijit.form.TextBox" data-dojo-props="placeHolder:'Search...'"class="searchBox"></input>
    <script type="dojo/on" data-dojo-event="onFocus" data-dojo-args="evt">
         alert("hi");
   </script>
 <div class="searchIcon_overlay"></div>
 </div>
</div> 
```

并且还以编程方式。[http://jsfiddle.net/YyFw5/](http://jsfiddle.net/YyFw5/)

## js：

```
require([
  "dijit/dijit",
  "dojo/parser",
  "maqetta/space",
  "maqetta/AppStates",
  "dijit/layout/BorderContainer",
  "dijit/layout/ContentPane",
  "dijit/form/TextBox",
  "dojo/on"
]);
require(["dojo/ready", "dojo/dom", "dojo/_base/fx", "dojo/on", "dijit/registry"], function(ready, dom, base_fx, on, registry){
     ready(function(){
         // logic that requires that Dojo is fully initialized should go here
        //on(registry.byId("searchBox_input"), "focus", function(a){alert("hi");});
     });
}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-25T19:22:20.170

在您的**声明性**示例中，您正在使用该`dojo/on`模块，该模块执行自己的原生 DOM 事件规范化。回调是一个 Dijit 小部件构造（如果您想查看源代码，`onFocus`则通过 _FormMixin 混合到 _WidgetBase 中），当小部件因为它或其中的小部件具有焦点或已被单击而变为“活动”时使用它。

您希望在事件处理程序中使用[规范化的事件名称](http://dojotoolkit.org/reference-guide/1.8/quickstart/events.html#events-available-for-connection)，如下所示：

```
<script type="dojo/on" data-dojo-event="focus" data-dojo-args="evt">
     alert("hi");
</script> 
```

我没有看到您的**程序**示例有任何明显错误，只是您`registry.byId("searchBox_input")`使用的 ID （来自您的代码示例）不存在。也许您应该在您的节点上添加一个`id`键`data-dojo-props`或作为属性。`<input>`

# c# - Tessnet2 Init-Method 在某些 tessdata 路径下崩溃

> ID：15617979
> 
> 赞同：1
> 
> 时间：2013-03-25T14:53:39.400
> 
> 标签：c#, ocr, tesseract, tessnet2

我正在使用 Tessnet2 程序集（它使用 Tesseract）来进行 OCR。不幸的是，在我调用 init 方法后程序崩溃，没有任何异常：

```
tessnet2.Tesseract ocr = new tessnet2.Tesseract();
ocr.Init(@"D:\Test\Tessdata\german", "deu", false); 
```

德语文件夹包含以下 tesseract 2 字数据：

*   deu.DangAmigs
*   deu.freq-dawg
*   deu.inttemp
*   deu.normproto
*   deu.pffmtable
*   deu.unicharset
*   deu.user-words
*   deu.word-dawg

如果我使用`null`路径它工作正常，因为我在我的机器上安装了 tesseract。但是我需要一个带有路径的解决方案，因为将部署程序的位置不能确保安装了 tesseract。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-27T09:29:04.043

问题是，如果您安装了 Tesseract，则会有一个环境变量集 ( `TESSDATA_PREFIX`)，其中包含 tessdata 的路径。要使用您自己的路径，必须卸载 Tesseract 并删除环境变量。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-05T13:59:25.893

```
Try the path:
     @"D:\Test\Tessdata" 
```

# linux - Linux bash：组合两个具有不同标题的csv文件

> ID：15617998
> 
> 赞同：0
> 
> 时间：2013-03-25T14:54:46.917
> 
> 标签：linux, bash, csv

我有这两个文件

第一的：

```
a;b;c;d
1;2;3;4 
```

第二：

```
d;e;f;g
4;5;6;7 
```

我需要这个结果：

```
a;b;c;d;e;f;g
1;2;3;4;;;
;;;4;5;6;7 
```

在 Linux 中有没有捷径可以做到这一点？

编辑：每个 csv 文件的标题/列可以更改并且可以包含重复的列。

编辑 2：Hmpf。链接的问题是完全不同的情况，没有回答我的问题。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-25T15:01:18.553

您可以加入标题列，然后调整剩余的行

```
head1=`head -1 file1.txt`
head2=`head -1 file2.txt`
echo "$head1;$head2"
sed -e 1d -e 's/$/;;;/' file1.txt
sed -e 1d -e 's/^/;;;/' file2.txt 
```

# c++ - Xcode 每次都给出不同的输出（但不是正确的输出）

> ID：15617999
> 
> 赞同：0
> 
> 时间：2013-03-25T14:54:52.127
> 
> 标签：c++, xcode

我有一个非常简单的程序，可以读取包含文本的文件：

```
start
costam
stop 
```

该程序是：

```
#include <iostream>
#include <fstream>

using namespace std;

int main (int argc, const char * argv[])
{
printf("init\n");

char c = NULL;

ifstream file;
file.open(argv[1]);

while (file.good()){
    c = file.get();
    printf("%c", c);
}

return 0;
} 
```

从控制台初始化的 xcode 构建给出：

```
init
start
costam
stop? 
```

但是 xcode 控制台给了我：

```
init 
```

或者

```
init
start 
```

或者

```
init
start
costam 
```

或者有时什么都没有。它没有模式。我正在使用带有 Xcode 4.2 的 Snow Leopard

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-25T15:01:11.387

首先修复bug

```
while (file.good()){
    c = file.get();
    printf("%c", c);
} 
```

应该

```
for (;;){
    c = file.get();
    if (!file.good())
        break;
    printf("%c", c);
} 
```

因为你应该只在阅读`file.good()` **之后**检查，而不是之前。这样就可以摆脱虚假了？您在第一个输出中看到。它是否有助于解决我不知道的主要问题。可能不是。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-25T15:01:46.397

您真的不应该将 CI/O（`printf` *等*）与 C++ I/O（`ifstream`）混合使用。尝试这个：

```
int main (int argc, const char * argv[])
{
    cout << "init" << endl;

    char c;

    ifstream file;
    file.open(argv[1]);

    while (file.good()) {
        c = file.get();
        cout << c;
    }

    cout << endl;

    return 0;
} 
```