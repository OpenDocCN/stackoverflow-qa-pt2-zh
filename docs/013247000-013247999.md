# StackOverflow 问答 13247000-13247999

# google-app-engine - 如何使用谷歌应用引擎发布静态网页？

> ID：13247000
> 
> 赞同：-1
> 
> 时间：2012-11-06T08:17:57.303
> 
> 标签：google-app-engine

抱歉，我自己无法解决这个问题。例如，我有一个静态网页，想用自己的域名（如“http://myowndomain.ru”）将其发布到互联网上。为此我必须采取哪些步骤？我已经下载了 Python 和 SDK。接下来是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-06T08:25:29.880

1.  在您的 IDE 中创建一个新的 Web 应用程序项目
2.  将您的静态内容放在`war/`应用程序的目录中。
3.  [在appengine.google.com](http://appengine.google.com)上创建一个新应用程序
4.  在 app.yaml 中设置应用 ID
5.  将您的应用程序部署到您的 App Engine 应用程序。
6.  [使用 Google Apps 注册您的域](https://www.google.com/a/cpanel/standard/new3)。
7.  在管理控制台的“应用程序设置”页面下，选择“添加域”
8.  在框中输入您的域名（例如 mydomain.ru）。
9.  按照屏幕上的步骤完成此过程。
10.  等待 DNS 传播...
11.  您现在应该能够访问您的静态内容。

# c# - 避免使用一本字典的更好代码 - 区分大小写问题

> ID：13247001
> 
> 赞同：2
> 
> 时间：2012-11-06T08:18:01.997
> 
> 标签：c#, .net, linq

我有以下方法用来自数据阅读器的值填充字典。数据读取器字段和传递给方法的属性之间可能存在大小写不匹配。在以下方法中，我首先将属性转换为小写以解决此问题。这会导致两个字典。有没有更好的方法可以用一本字典来实现这一目标？

```
private Dictionary<string, object> FillDictionaryWithReaderValues(List<string> propertiesOfAllEntities, IDataReader reader)
{
   Dictionary<string, object> lowerCaseDictionary = new Dictionary<string, object>();
   Dictionary<string, object> propertyResultList = new Dictionary<string, object>();

   foreach (var item in propertiesOfAllEntities)
   {
      lowerCaseDictionary.Add(item.ToLower(), null);
   }

   for (int i = 0; i < reader.FieldCount; i++)
   {
      lowerCaseDictionary[reader.GetName(i).ToLower()] = reader[i];
   }

   foreach (var item in propertiesOfAllEntities)
   {
      propertyResultList.Add(item, lowerCaseDictionary[item.ToLower()]);
   }

   return propertyResultList;
} 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-11-06T08:25:16.290

您可以忽略大小写`Dictionary`，`Dictionary`具有接受的[重载构造函数](http://msdn.microsoft.com/en-us/library/ms132072.aspx)`IEqualityComparer`，`StringComparer.InvariantCultureIgnoreCase`用于忽略键的大小写敏感：

```
var dic = 
      new Dictionary<string, object>(StringComparer.InvariantCultureIgnoreCase); 
```

因此，只有一本带有忽略大小写的字典就足以满足您的代码

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-06T09:10:58.087

感谢@CuongLe。如果您喜欢以下内容，请点赞@Cuong Le 回答。

为了他人的利益，我将在这里写下答案：

```
 private Dictionary<string, object> FillDictionaryWithReaderValues(List<string> propertiesOfAllEntities, IDataReader reader)
    {

        Dictionary<string, object> propertyResultList = new Dictionary<string, object>(StringComparer.InvariantCultureIgnoreCase);
        for (int i = 0; i < reader.FieldCount; i++)
        {
            string readerFieldName = reader.GetName(i);
            //Whether propertiesOfAllEntities.Contains the property
            if (propertiesOfAllEntities.FindIndex(x => x.Equals(readerFieldName, StringComparison.OrdinalIgnoreCase)) != -1)
            {
                propertyResultList.Add(readerFieldName, reader[i]);
            }

        }

        return propertyResultList;
    } 
```

参考：

1.  [不区分大小写的列表搜索](https://stackoverflow.com/questions/3947126/case-insensitive-list-search)

# java - HIbernate 查询语言错误

> ID：13247006
> 
> 赞同：0
> 
> 时间：2012-11-06T08:18:26.873
> 
> 标签：java, sql, hibernate, netbeans

我对基于 Hibernate 的应用程序开发非常陌生。最近我在 Eclipse Juno IDE 中运行相同的代码（如下所示）。它工作正常。但是当来到 Netbeans 时它不起作用。它显示错误为

> 严重：您的 SQL 语法有错误；检查与您的 MySQL 服务器版本相对应的手册，以在第 1 行的 '.users users0_ where users0_.uname='username'' 附近使用正确的语法

这里我使用的是 Mysql 5.5，IDE-NetBeans-7.2.1。

这里我正在执行的代码是，

休眠.cfg.xml

```
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE hibernate-configuration PUBLIC "-//Hibernate/Hibernate Configuration DTD 3.0//EN" "http://hibernate.sourceforge.net/hibernate-configuration-3.0.dtd">
<hibernate-configuration>
  <session-factory>
    <property name="hibernate.dialect">org.hibernate.dialect.MySQLDialect</property>
    <property name="hibernate.connection.driver_class">com.mysql.jdbc.Driver</property>
    <property name="hibernate.connection.url">jdbc:mysql://localhost:3306/office manager?zeroDateTimeBehavior=convertToNull</property>
    <property name="hibernate.connection.username">root</property>
    <property name="hibernate.connection.password">root</property>
    <mapping resource="hibernatefiles/Users.hbm.xml"/>
  </session-factory>
</hibernate-configuration> 
```

休眠映射文件：

```
<?xml version="1.0"?>
<!DOCTYPE hibernate-mapping PUBLIC "-//Hibernate/Hibernate Mapping DTD 3.0//EN"
"http://hibernate.sourceforge.net/hibernate-mapping-3.0.dtd">
<!-- Generated Nov 6, 2012 12:42:42 PM by Hibernate Tools 3.2.1.GA -->
<hibernate-mapping>
    <class name="hibernatefiles.Users" table="users" catalog="OFFICE MANAGER">
        <id name="uid" type="java.lang.Integer">
            <column name="Uid" />
            <generator class="identity" />
        </id>
        <property name="uname" type="string">
            <column name="uname" length="50" />
        </property>
        <property name="upass" type="string">
            <column name="upass" length="30" />
        </property>
        <property name="ename" type="string">
            <column name="ename" length="100" />
        </property>
        <property name="edesg" type="string">
            <column name="edesg" length="100" />
        </property>
        <property name="contactnumber" type="java.lang.Integer">
            <column name="contactnumber" />
        </property>
    </class>
</hibernate-mapping> 
```

Users.java（POJO 文件）

```
package hibernatefiles;
public class Users  implements java.io.Serializable {

     private Integer uid;
     private String uname;
     private String upass;
     private String ename;
     private String edesg;
     private Integer contactnumber;

    public Users() {
    }

    public Users(String uname, String upass, String ename, String edesg, Integer contactnumber) {
       this.uname = uname;
       this.upass = upass;
       this.ename = ename;
       this.edesg = edesg;
       this.contactnumber = contactnumber;
    }

    public Integer getUid() {
        return this.uid;
    }

    public void setUid(Integer uid) {
        this.uid = uid;
    }
    public String getUname() {
        return this.uname;
    }

    public void setUname(String uname) {
        this.uname = uname;
    }
    public String getUpass() {
        return this.upass;
    }

    public void setUpass(String upass) {
        this.upass = upass;
    }
    public String getEname() {
        return this.ename;
    }

    public void setEname(String ename) {
        this.ename = ename;
    }
    public String getEdesg() {
        return this.edesg;
    }

    public void setEdesg(String edesg) {
        this.edesg = edesg;
    }
    public Integer getContactnumber() {
        return this.contactnumber;
    }

    public void setContactnumber(Integer contactnumber) {
        this.contactnumber = contactnumber;
    }

} 
```

我正在使用查询类在下面的 JSP 文件中执行 HQL。

```
<%@page import="hibernatefiles.Users"%>
<%@page import="java.util.Iterator"%>
<%@page import="org.hibernate.Query"%>
<%@page import="org.hibernate.Session"%>
<%@page import="org.hibernate.Transaction"%>
<%
    String user_id = request.getParameter("uid");
    String u_pass = request.getParameter("upass");
    out.println("got it dude we get the details..."+user_id+"\n"+u_pass);

    //writing the hibernate code

    Transaction transaction;

    Session ses = hibernatefiles.NewHibernateUtil.getSessionFactory().openSession();
    try{
             transaction = ses.beginTransaction();
             String HQL = "FROM Users u WHERE u.uname='"+user_id+"'";
             Query query = ses.createQuery(HQL);
            java.util.List li = query.list();
            Iterator itera = li.iterator();
            while(itera.hasNext()){
        //getting record
                Users u= (Users) itera.next();
        out.println("user name is:"+u.getUname());
                out.println("user password is :"+u.getUpass());         

            }

    }
    catch(Exception error){
        error.printStackTrace();

    }

%> 
```

这里是 NetBeans 日志

```
Nov 06, 2012 2:31:27 PM org.apache.catalina.core.StandardContext reload
INFO: Reloading Context with name [/Office_Manager] is completed
Nov 06, 2012 2:31:45 PM org.hibernate.cfg.annotations.Version <clinit>
INFO: Hibernate Annotations 3.3.1.GA
Nov 06, 2012 2:31:45 PM org.hibernate.cfg.Environment <clinit>
INFO: Hibernate 3.2.5
Nov 06, 2012 2:31:45 PM org.hibernate.cfg.Environment <clinit>
INFO: hibernate.properties not found
Nov 06, 2012 2:31:45 PM org.hibernate.cfg.Environment buildBytecodeProvider
INFO: Bytecode provider name : cglib
Nov 06, 2012 2:31:45 PM org.hibernate.cfg.Environment <clinit>
INFO: using JDK 1.4 java.sql.Timestamp handling
Nov 06, 2012 2:31:45 PM org.hibernate.cfg.Configuration configure
INFO: configuring from resource: /hibernate.cfg.xml
Nov 06, 2012 2:31:45 PM org.hibernate.cfg.Configuration getConfigurationInputStream
INFO: Configuration resource: /hibernate.cfg.xml
Nov 06, 2012 2:31:45 PM org.hibernate.cfg.Configuration addResource
INFO: Reading mappings from resource : hibernatefiles/Users.hbm.xml
Nov 06, 2012 2:31:46 PM org.hibernate.cfg.Configuration doConfigure
INFO: Configured SessionFactory: null
Nov 06, 2012 2:31:46 PM org.hibernate.cfg.HbmBinder bindRootPersistentClassCommonValues
INFO: Mapping class: hibernatefiles.Users -> users
Nov 06, 2012 2:31:46 PM org.hibernate.cfg.AnnotationConfiguration secondPassCompile
INFO: Hibernate Validator not found: ignoring
Nov 06, 2012 2:31:46 PM org.hibernate.connection.DriverManagerConnectionProvider configure
INFO: Using Hibernate built-in connection pool (not for production use!)
Nov 06, 2012 2:31:46 PM org.hibernate.connection.DriverManagerConnectionProvider configure
INFO: Hibernate connection pool size: 20
Nov 06, 2012 2:31:46 PM org.hibernate.connection.DriverManagerConnectionProvider configure
INFO: autocommit mode: false
Nov 06, 2012 2:31:46 PM org.hibernate.connection.DriverManagerConnectionProvider configure
INFO: using driver: com.mysql.jdbc.Driver at URL: jdbc:mysql://localhost:3306/office manager?zeroDateTimeBehavior=convertToNull
Nov 06, 2012 2:31:46 PM org.hibernate.connection.DriverManagerConnectionProvider configure
INFO: connection properties: {user=root, password=****}
Nov 06, 2012 2:31:47 PM org.hibernate.cfg.SettingsFactory buildSettings
INFO: RDBMS: MySQL, version: 5.5.25a
Nov 06, 2012 2:31:47 PM org.hibernate.cfg.SettingsFactory buildSettings
INFO: JDBC driver: MySQL-AB JDBC Driver, version: mysql-connector-java-5.1.18 ( Revision: tonci.grgin@oracle.com-20110930151701-jfj14ddfq48ifkfq )
Nov 06, 2012 2:31:47 PM org.hibernate.dialect.Dialect <init>
INFO: Using dialect: org.hibernate.dialect.MySQLDialect
Nov 06, 2012 2:31:47 PM org.hibernate.transaction.TransactionFactoryFactory buildTransactionFactory
INFO: Using default transaction strategy (direct JDBC transactions)
Nov 06, 2012 2:31:47 PM org.hibernate.transaction.TransactionManagerLookupFactory getTransactionManagerLookup
INFO: No TransactionManagerLookup configured (in JTA environment, use of read-write or transactional second-level cache is not recommended)
Nov 06, 2012 2:31:47 PM org.hibernate.cfg.SettingsFactory buildSettings
INFO: Automatic flush during beforeCompletion(): disabled
Nov 06, 2012 2:31:47 PM org.hibernate.cfg.SettingsFactory buildSettings
INFO: Automatic session close at end of transaction: disabled
Nov 06, 2012 2:31:47 PM org.hibernate.cfg.SettingsFactory buildSettings
INFO: JDBC batch size: 15
Nov 06, 2012 2:31:47 PM org.hibernate.cfg.SettingsFactory buildSettings
INFO: JDBC batch updates for versioned data: disabled
Nov 06, 2012 2:31:47 PM org.hibernate.cfg.SettingsFactory buildSettings
INFO: Scrollable result sets: enabled
Nov 06, 2012 2:31:47 PM org.hibernate.cfg.SettingsFactory buildSettings
INFO: JDBC3 getGeneratedKeys(): enabled
Nov 06, 2012 2:31:47 PM org.hibernate.cfg.SettingsFactory buildSettings
INFO: Connection release mode: auto
Nov 06, 2012 2:31:47 PM org.hibernate.cfg.SettingsFactory buildSettings
INFO: Maximum outer join fetch depth: 2
Nov 06, 2012 2:31:47 PM org.hibernate.cfg.SettingsFactory buildSettings
INFO: Default batch fetch size: 1
Nov 06, 2012 2:31:47 PM org.hibernate.cfg.SettingsFactory buildSettings
INFO: Generate SQL with comments: disabled
Nov 06, 2012 2:31:47 PM org.hibernate.cfg.SettingsFactory buildSettings
INFO: Order SQL updates by primary key: disabled
Nov 06, 2012 2:31:47 PM org.hibernate.cfg.SettingsFactory buildSettings
INFO: Order SQL inserts for batching: disabled
Nov 06, 2012 2:31:47 PM org.hibernate.cfg.SettingsFactory createQueryTranslatorFactory
INFO: Query translator: org.hibernate.hql.ast.ASTQueryTranslatorFactory
Nov 06, 2012 2:31:47 PM org.hibernate.hql.ast.ASTQueryTranslatorFactory <init>
INFO: Using ASTQueryTranslatorFactory
Nov 06, 2012 2:31:47 PM org.hibernate.cfg.SettingsFactory buildSettings
INFO: Query language substitutions: {}
Nov 06, 2012 2:31:47 PM org.hibernate.cfg.SettingsFactory buildSettings
INFO: JPA-QL strict compliance: disabled
Nov 06, 2012 2:31:47 PM org.hibernate.cfg.SettingsFactory buildSettings
INFO: Second-level cache: enabled
Nov 06, 2012 2:31:47 PM org.hibernate.cfg.SettingsFactory buildSettings
INFO: Query cache: disabled
Nov 06, 2012 2:31:47 PM org.hibernate.cfg.SettingsFactory createCacheProvider
INFO: Cache provider: org.hibernate.cache.NoCacheProvider
Nov 06, 2012 2:31:47 PM org.hibernate.cfg.SettingsFactory buildSettings
INFO: Optimize cache for minimal puts: disabled
Nov 06, 2012 2:31:47 PM org.hibernate.cfg.SettingsFactory buildSettings
INFO: Structured second-level cache entries: disabled
Nov 06, 2012 2:31:47 PM org.hibernate.cfg.SettingsFactory buildSettings
INFO: Echoing all SQL to stdout
Nov 06, 2012 2:31:47 PM org.hibernate.cfg.SettingsFactory buildSettings
INFO: Statistics: disabled
Nov 06, 2012 2:31:47 PM org.hibernate.cfg.SettingsFactory buildSettings
INFO: Deleted entity synthetic identifier rollback: disabled
Nov 06, 2012 2:31:47 PM org.hibernate.cfg.SettingsFactory buildSettings
INFO: Default entity-mode: pojo
Nov 06, 2012 2:31:47 PM org.hibernate.cfg.SettingsFactory buildSettings
INFO: Named query checking : enabled
Nov 06, 2012 2:31:47 PM org.hibernate.impl.SessionFactoryImpl <init>
INFO: building session factory
Nov 06, 2012 2:31:48 PM org.hibernate.impl.SessionFactoryObjectFactory addInstance
INFO: Not binding factory to JNDI, no JNDI name configured
Nov 06, 2012 2:31:48 PM org.hibernate.util.JDBCExceptionReporter logExceptions
WARNING: SQL Error: 1064, SQLState: 42000
Nov 06, 2012 2:31:48 PM org.hibernate.util.JDBCExceptionReporter logExceptions
SEVERE: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '.users users0_ where users0_.uname='manikanta'' at line 1
org.hibernate.exception.SQLGrammarException: could not execute query
Hibernate: 
    select
        users0_.Uid as Uid0_,
        users0_.uname as uname0_,
        users0_.upass as upass0_,
        users0_.ename as ename0_,
        users0_.edesg as edesg0_,
        users0_.contactnumber as contactn6_0_ 
    from
        OFFICE MANAGER.users users0_ 
    where
        users0_.uname='manikanta'
    at org.hibernate.exception.SQLStateConverter.convert(SQLStateConverter.java:67)
    at org.hibernate.exception.JDBCExceptionHelper.convert(JDBCExceptionHelper.java:43)
    at org.hibernate.loader.Loader.doList(Loader.java:2223)
    at org.hibernate.loader.Loader.listIgnoreQueryCache(Loader.java:2104)
    at org.hibernate.loader.Loader.list(Loader.java:2099)
    at org.hibernate.loader.hql.QueryLoader.list(QueryLoader.java:378)
    at org.hibernate.hql.ast.QueryTranslatorImpl.list(QueryTranslatorImpl.java:338)
    at org.hibernate.engine.query.HQLQueryPlan.performList(HQLQueryPlan.java:172)
    at org.hibernate.impl.SessionImpl.list(SessionImpl.java:1121)
    at org.hibernate.impl.QueryImpl.list(QueryImpl.java:79)
    at org.apache.jsp.Employers.checking_jsp._jspService(checking_jsp.java:88)
    at org.apache.jasper.runtime.HttpJspBase.service(HttpJspBase.java:70)
    at javax.servlet.http.HttpServlet.service(HttpServlet.java:722)
    at org.apache.jasper.servlet.JspServletWrapper.service(JspServletWrapper.java:432)
    at org.apache.jasper.servlet.JspServlet.serviceJspFile(JspServlet.java:390)
    at org.apache.jasper.servlet.JspServlet.service(JspServlet.java:334)
    at javax.servlet.http.HttpServlet.service(HttpServlet.java:722)
    at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:305)
    at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:210)
    at org.netbeans.modules.web.monitor.server.MonitorFilter.doFilter(MonitorFilter.java:393)
    at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:243)
    at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:210)
    at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:225)
    at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:169)
    at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:472)
    at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:168)
    at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:98)
    at org.apache.catalina.valves.AccessLogValve.invoke(AccessLogValve.java:927)
    at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:118)
    at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:407)
    at org.apache.coyote.http11.AbstractHttp11Processor.process(AbstractHttp11Processor.java:999)
    at org.apache.coyote.AbstractProtocol$AbstractConnectionHandler.process(AbstractProtocol.java:565)
    at org.apache.tomcat.util.net.JIoEndpoint$SocketProcessor.run(JIoEndpoint.java:309)
    at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1110)
    at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:603)
    at java.lang.Thread.run(Thread.java:722)
Caused by: com.mysql.jdbc.exceptions.jdbc4.MySQLSyntaxErrorException: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '.users users0_ where users0_.uname='manikanta'' at line 1
    at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)
    at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:57)
    at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
    at java.lang.reflect.Constructor.newInstance(Constructor.java:525)
    at com.mysql.jdbc.Util.handleNewInstance(Util.java:411)
    at com.mysql.jdbc.Util.getInstance(Util.java:386)
    at com.mysql.jdbc.SQLError.createSQLException(SQLError.java:1052)
    at com.mysql.jdbc.MysqlIO.checkErrorPacket(MysqlIO.java:3609)
    at com.mysql.jdbc.MysqlIO.checkErrorPacket(MysqlIO.java:3541)
    at com.mysql.jdbc.MysqlIO.sendCommand(MysqlIO.java:2002)
    at com.mysql.jdbc.MysqlIO.sqlQueryDirect(MysqlIO.java:2163)
    at com.mysql.jdbc.ConnectionImpl.execSQL(ConnectionImpl.java:2624)
    at com.mysql.jdbc.PreparedStatement.executeInternal(PreparedStatement.java:2127)
    at com.mysql.jdbc.PreparedStatement.executeQuery(PreparedStatement.java:2293)
    at org.hibernate.jdbc.AbstractBatcher.getResultSet(AbstractBatcher.java:186)
    at org.hibernate.loader.Loader.getResultSet(Loader.java:1787)
    at org.hibernate.loader.Loader.doQuery(Loader.java:674)
    at org.hibernate.loader.Loader.doQueryAndInitializeNonLazyCollections(Loader.java:236)
    at org.hibernate.loader.Loader.doList(Loader.java:2220)
    ... 33 more 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-06T09:54:11.603

问题似乎出在“OFFICE MANAGER”模式中。它有空格，所以需要引用。“OFFICE MANAGER”真的是正确的名字吗？如果是正确的，那么您必须更改您的休眠映射文件，以引用目录属性：

```
<class name="hibernatefiles.Users" table="users" catalog="`OFFICE MANAGER`"> 
```

但是，我不知道为什么它在 Eclipse 中起作用。如果你很好奇，你可以尝试在 eclipse 中再次运行它，`<property name="hibernate.show_sql">true</property> <property name="hibernate.format_sql">true</property>`以便显示查询。

# c++ - 位操作，主要是~

> ID：13247007
> 
> 赞同：1
> 
> 时间：2012-11-06T08:18:36.593
> 
> 标签：c++

我目前正在将十进制转换为二进制，确保它是 8 位。除 ~ (NOT) 操作外，所有位操作均有效。它们以巨大的整数值出现。我不知道为什么，因为其他位操作有效。这是我的代码：（注释掉的行是不起作用的）

编辑：如果我想获得 8 位二进制字符串，我该怎么办？使用无符号字符？如果我将所有无符号整数更改为无符号字符，那么我的 BinaryToDecimal 函数会产生不正确的二进制转换。

```
#include <iostream>
#include <string>

using namespace std;

string BinaryToDecimal(unsigned int dec)
{
    string binary   = "";
    float remainder = 0.0f;

    while( dec != 0 )
    {
        remainder = dec % 2;
        dec      /= 2;

        if( remainder == 0 )
            binary.append("0");
        else
            binary.append("1");
    }

    // Reverse binary string
    string ret = string(binary.rbegin(), binary.rend());

    return ret;
}

int main()
{
    unsigned int a = 0;
    unsigned int b = 0;

    cout << "Enter a number to convert to binary: ";
    cin  >> a;
    cout << "Enter a number to convert to binary: ";
    cin  >> b;

    cout << "A = " << BinaryToDecimal(a) << endl;
    cout << "B = " << BinaryToDecimal(b) << endl;

    unsigned int c = a & b;
    unsigned int d = a | b;
    //unsigned int e = ~a;
    //unsigned int f = ~b;
    unsigned int g = a ^ b;
    unsigned int h = a << 2;
    unsigned int i = b >> 3;

    cout << "A & B  = " << BinaryToDecimal(c) << endl;
    cout << "A | B  = " << BinaryToDecimal(d) << endl;
    //cout << "~A     = " << BinaryToDecimal(e) << endl;
    //cout << "~B     = " << BinaryToDecimal(f) << endl;
    cout << "A ^ B  = " << BinaryToDecimal(g) << endl;
    cout << "A << 2 = " << BinaryToDecimal(h) << endl;
    cout << "B >> 3 = " << BinaryToDecimal(i) << endl;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-06T08:21:20.797

如果您对一个小的无符号整数执行二进制 NOT，您将得到一个大数字，因为大多数最高有效位将被设置为 1（它们在操作数中的倒数）。

在这种情况下，您所做`~ 0`的肯定会给您一个很大的数字，实际上是最大可能的无符号整数，因为所有位都将设置为 1。

（你期待什么结果？）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-06T09:03:58.450

您正在使用`unsigned int`for 操作，因为从 MSB 开始的前导 1，所以小数的反转变成了大数。如果您只希望表示仅为 8 位，则应使用`unsigned char`它的存储。
但是您不能将 a 或 b 更改为`unsigned char`。否则，`cin >> a`会将数字的 ASCII 码放入`a`，而不是数字。例如，您的输入是 5，它输入 0x35（'5'），而不是数字 5。

如果你不想改变`unsigned int`你的代码，你可以做一些小的改进

```
string BinaryToDecimal(unsigned int dec)
{
    string binary   = "";
    float remainder = 0.0f;

    dec &= 0xff;        // only 8 bits you care about
    while( dec != 0 )
    {
        .... 
```

但是您正在使用`while( dec !=0 )`，这是错误的。如果结果已经为 0，则该函数返回一个空字符串，而不是“0000”。相反，您应该使用计数器仅计数 8 位。

```
 for (int i = 0; i < 8; i++ ) {
        if ((dec & 1) != 0)
            binary.append("1");
        else
            binary.append("0");
        dec >>= 1;
    } 
```

此外，使用逐位`AND`测试位是 0 还是 1，并且移位操作优于 / 和 % 运算符。

最后，对于 8 位 5 (0000_0101)，它的反转是 250 (1111_1010)，而不是 1010。

# javascript - 在字符串中搜索特定单词，然后更改它

> ID：13247010
> 
> 赞同：0
> 
> 时间：2012-11-06T08:18:44.863
> 
> 标签：javascript, jquery

我有许多带有标题的标签，它们指定了合同类型和合同提供者。

我想要做的是获取标题标签并将其存储在一个数组中并用破折号替换所有内容。

问题是，必须存储合同类型的特定格式。目前'payg'是正确的，但由于它的标记方式，我不知道如何用'替换'按月支付'支付'

请在这里找到我的代码：http: [//jsbin.com/ikumar/4/edit/](http://jsbin.com/ikumar/4/edit/)

我也无权访问标记。

乙

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-06T08:21:50.980

[http://www.w3schools.com/jsref/jsref_replace.asp](http://www.w3schools.com/jsref/jsref_replace.asp)

```
$anaLinksTitle = $this.attr('title').replace("pay monthly", "paym"); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-06T08:25:09.520

```
$anaLinksTitle = $anaLinksTitle.toLowerCase()
                 .replace(/ /g, '-')
                 .replace('pay-monthly', 'paym'); 
```

# titanium - Titanium 中的自动布局

> ID：13247012
> 
> 赞同：2
> 
> 时间：2012-11-06T08:18:49.763
> 
> 标签：titanium, titanium-mobile

我正在尝试定位我的视图并让它们自动调整大小。

对于这个例子，我有 3 个视图，一个红色、一个蓝色和一个绿色，它们都布置在一个具有 VERTICAL 布局的窗口中，它们的宽度都是“100%”：

```
var mainView = Ti.UI.createView({
    backgroundColor : "white",
    width : "100%",
    height : "100%",
    layout : "vertical"
});

var redView = Ti.UI.createView({
    backgroundColor : "red",
    width : "100%",
    height : "40%",
});
mainView.add(redView);

var blueView = Ti.UI.createView({
    backgroundColor : "blue",
    width : "100%",
    height : "30%",
});
mainView.add(blueView);

var greenView = Ti.UI.createView({
    backgroundColor : "green",
    width : "100%",
    height : "30%"
});
mainView.add(greenView); 
```

这看起来不错的样子。现在我想将控件添加到红色视图中，并且我希望发生一些事情：

1.  我将在红色视图中放置一个控件，它的每个方向的 MARGIN 为 10 点/像素。
2.  当我调整内部控件的大小时，RED 视图会自动调整自身大小以适应内部控件，但会保持每个方向的 10 点边距。
3.  BLUE 和 GREEN 视图将自动减小它们的大小以占据屏幕的其余部分。

例子：

```
var blackView = Ti.UI.createView({
    backgroundColor : "black",
    top : 10,
    bottom : 10,
    left : 10,
    right : 10
});

...
...

blackView.height = blackView.height + 50; 
```

当我将 blackView 的高度增加 50 时，应该会发生以下情况：

1）redView的高度要增加50。 2）blueView和greenView的高度要减少25，并且要自动放置。

任何想法如何实现这种自动行为？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-28T08:22:42.330

有几种方法可以做到这一点。

**简单的方法：** 当你增加内视图的大小时，你必须增加外视图的大小，所有其他相关视图都应该相应地减小。

**推荐：** 使用事件监听器。例如 1\. 当你改变大小时触发一个自定义事件 例如

```
Ti.App.fireEvent("myViewSizeChanged",{newSize:"50",control:redview}); 
```

1.  听这个事件调用你的计算方法来调整你的每个视图的大小。例如

    Ti.App.addEventListener("myViewSizeChanged",function(e){ //这里可以获取e的值 //e.newSize //e.redView });

两个参数都会告诉你哪个控件的新大小......你可以相应地调整其余的视图大小

# c# - 自动滚动到文本区域底部

> ID：13247013
> 
> 赞同：0
> 
> 时间：2012-11-06T08:18:49.667
> 
> 标签：c#, jquery, textarea, onchange, autoscroll

我有一个在 c# 中动态更改的文本区域，方法是这样做：

```
TextBox1.Text=(String)Application["chat"]; 
```

当文本对于文本区域来说太大时，我希望滚动始终位于底部。我试图在 JS(jquery) 中使用 change 事件来做到这一点。

```
$("#TextBox1").change(function () {
    alert("alert");
    // $('#TextBox1').scrollTop($('#TextBox1')[0].scrollHeight);
}); 
```

这是我在 Javascript 中使用的代码。问题是事件不会发生，即使文本区域中的文本发生更改，我已经通过使用不执行的警报对其进行调试来证明这一点。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-06T08:22:42.010

```
var textarea = document.getElementById('textarea_id');
textarea.scrollTop = textarea.scrollHeight; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-06T08:23:59.410

关于您的事件未触发的问题：如果这是 ASP.NET 网络表单，则文本框（输入）的客户端 ID 不太可能是 TextBox1。

在生成的页面上查看源代码并检查 ID 呈现的内容并相应地更新您的 JS。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-06T08:49:39.217

您可以使用此代码将 textarea 向下滚动到底部：

```
$("#TextBox1").scrollTop($("#TextBox1").height());​ 
```

如果你想向下滚动，当它的内容发生变化时，使用这个：

```
$("#TextBox1").change(function(){
    $(this).scrollTop($(this).height());​
}); 
```

# android - 如果任何 antcall 失败，如何继续？

> ID：13247017
> 
> 赞同：1
> 
> 时间：2012-11-06T08:19:01.617
> 
> 标签：android, ant, antcall

我正在尝试运行 ANT 脚本。我在其中调用多个目标。

```
 <target name="mySuite">
                <antcall target="TC1"> </antcall>
                <antcall target="TC2"> </antcall>
                <antcall target="TC3"> </antcall>
                <antcall target="TC4"> </antcall>
                <antcall target="TC5"> </antcall>
                <antcall target="TC6"> </antcall>
                .
                .
                .
              </target> 
```

如果任何 antcall 目标失败，我的 ANT 脚本就会失败。但我希望我的 ANT 脚本能够继续，即使他的任何 antcall 目标失败。我需要做哪些改变？

# arrays - 排序与插入的 Big-O 运行时间

> ID：13247021
> 
> 赞同：0
> 
> 时间：2012-11-06T08:19:12.707
> 
> 标签：arrays, sorting, insert, runtime, big-o

因此，如果您使用快速排序对数组进行排序，您可以使用快速排序在 O(nlogn) 中进行排序，然后一旦对它进行排序，就可以使用二进制搜索式算法在 O(logn) 中将新元素插入数组中。

我的问题是，有没有办法证明如果你可以在 O(logn) 时间内插入一个排序数组，那么这意味着排序算法必须至少是 O(nlogn)？

换句话说，这两种算法的运行时间之间是否存在关系？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-06T08:24:59.950

否：可以使用冒泡排序 (O(n²)) 对数组进行排序。之后，仍然可以使用相同的算法在 O(log(n)) 时间插入。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-06T08:26:04.093

好吧，保持顺序的插入是 O(log n) 的事实意味着只需将每个元素依次插入数组中，就可以在 O(n log n) 中执行排序操作。但是，这可能与您真正要问的相反；它证明了存在 O(n log n) 排序，但并没有反驳更快排序的可能性。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-13T15:50:54.703

首先，一些需要特殊条件的排序算法可能具有较低的时间复杂度。例如复杂度为 O(n+k) 的[计数排序](http://en.wikipedia.org/wiki/Counting_sort)（其中 k 是数组中的最高数字）或复杂度为 O(n*k) 的[基数排序](http://www.google.co.il/url?sa=t&rct=j&q=&esrc=s&source=web&cd=1&cad=rja&ved=0CB8QFjAA&url=http://en.wikipedia.org/wiki/Radix_sort&ei=vmuiUN7-I-ei0QX98YHQAg&usg=AFQjCNGfaterKCZkUX6qcwxj09zmb_6HVQ)（其中 k 是数组中的最大位数元素）。
O(nlogn) 的界限适用于**比较算法**。

其次，回答这个问题，不（可悲）。插入和排序之间的关系是相反的，就像 davmac 说的那样。

比较下限的原因是您至少需要 nlogn 比较才能找到正确的顺序。有关更多详细信息，请参阅[有关比较排序算法](http://en.wikipedia.org/wiki/Comparison_sort#Lower_bound_for_the_average_number_of_comparisons)的此 wiki 页面。请注意，教授与插入无关（教授实际上并不假设任何插入）。

# tooltwist - Tooltwist Designer 存储库同步失败

> ID：13247024
> 
> 赞同：1
> 
> 时间：2012-11-06T08:19:26.627
> 
> 标签：tooltwist

当我从 ToolTwist 设计器同步时，我选择了我希望发布的文件，但是当我按 OK 时出现错误，提示同步失败并查看服务器日志文件。

如果我再试一次，我选择的文件不再在列表中，但是如果我检查 Git，我可以看到它们没有被推送到存储库。

在日志文件中，我看到推送失败，如果我转到 webdesign 目录并测试推送命令，我会得到同样的错误：

```
$ git push --dry-run
To git@github.com:MyRepository/design-project.git
 ! [rejected]        master -> master (non-fast-forward) 
```

我正在使用“设计”分支，所以我不确定为什么“主”分支上会出现错误。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-06T22:20:19.527

在正常情况下，Designer 只使用一个 git 分支，通常命名为“design”。上面的错误消息表明 master 分支上存在冲突。

似乎更改已提交到本地计算机上的主分支但未推送，而其他更改已提交到主分支并*已*推送到远程存储库。

要清除此冲突，您需要签出 master 分支并拉取以合并远程上的更改，然后下一次推送将起作用。*完成后不要忘记改回设计分支。*

```
[stop the Designer]
$ git checkout master
$ git pull
[resolve any conflicts]
$ git push origin master

$ git checkout design
[start the Designer] 
```

默认情况下，git 会尝试在所有分支上推送提交。在这种情况下，您可能会发现主分支上的冲突正在阻止您在设计分支上的网页设计更改被提交。为了防止这种情况发生，您可以将 git 的默认行为配置为仅推送当前分支。

```
$ git config push.default current 
```

您可能还想调查为什么要更改主分支（并且在两个位置）。

# mysql - RDBM MySQL Foregin 键约束多项选择

> ID：13247034
> 
> 赞同：0
> 
> 时间：2012-11-06T08:19:54.453
> 
> 标签：mysql, foreign-keys, constraints

我刚刚为我的一门课进行了一些过去的测试，并遇到了这个问题

考虑表 X 中的以下外键声明。

外键 a 参考文献 Y (b)

本声明：

(a) 在 b 中的主记录和 a 中的详细记录之间建立主从关系

(b) 在 X 中的主记录和 Y 中的详细记录之间建立主从关系

(c) 在 Y 中的主记录和 X 中的详细记录之间建立主从关系

(d) 在 a 中的主记录和 b 中的详细记录之间建立主从关系

我知道大师代表让我们说“用户”，而详细信息则是“用户的朋友”

答案是d？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-06T21:34:08.017

a = 表 x 中的一个字段 b = 表 y 中的一个字段

所以如果主人有细节你把它放在细节创建脚本中

FOREIGN KEY M_id REFERENCES Master(id)

所以主表是 Y 明细表是 X a = detail M_id b = master id

所以答案是C

# android - 如何将图像从一个图像视图拖放到另一个图像视图。

> ID：13247050
> 
> 赞同：0
> 
> 时间：2012-11-06T08:21:25.410
> 
> 标签：android, drag-and-drop, android-imageview

```
 public class Quiz extends Activity {

        int windowwidth;
        int windowheight;
        ImageView ima ima2;
        private View selected_item = null;
        private int offset_x = 0;
        private int offset_y = 0;

        private android.widget.LinearLayout.LayoutParams layoutParams1,
                layoutParams2;

        @Override
        public void onCreate(Bundle savedInstanceState) {
            super.onCreate(savedInstanceState);
            requestWindowFeature(Window.FEATURE_NO_TITLE);
            setContentView(R.layout.quiz);

            windowwidth = getWindowManager().getDefaultDisplay().getWidth();
            windowheight = getWindowManager().getDefaultDisplay().getHeight();

            System.out.println("width" + windowwidth);
            System.out.println("height" + windowheight);
   //on touch listener for image view 
            ima1 = (ImageView) findViewById(R.id.shuffledimage);
            ima1.setOnTouchListener(new View.OnTouchListener() {

                @Override
                public boolean onTouch(View v, MotionEvent event) {
                    layoutParams1 = (LinearLayout.LayoutParams) ima1
                            .getLayoutParams();
                    try {//action performed in image view
                        switch (event.getActionMasked()) {
                        case MotionEvent.ACTION_DOWN:
                            break;
                        case MotionEvent.ACTION_MOVE:
                            int x_cord = (int) event.getRawX();
                            int y_cord = (int) event.getRawY();
                            if (x_cord > windowwidth) {
                                x_cord = windowwidth;
                            }
                            if (y_cord > windowheight) {
                                y_cord = windowheight;
                            }
                            layoutParams1.leftMargin = x_cord - 25;
                            layoutParams1.topMargin = y_cord - 75;
                            ima1.setLayoutParams(layoutParams1);
                            break;

                        default:
                            break;
                        }
                    } catch (Exception e) {
                        // TODO: handle exception
                        e.getMessage();
                    }

                    return true;
                }
            });

            ima2 = (ImageView) findViewById(R.id.userimage);
            ima2.setOnTouchListener(new View.OnTouchListener() {

                @Override
                public boolean onTouch(View v, MotionEvent event) {

                    layoutParams2 = (LinearLayout.LayoutParams) ima2
                            .getLayoutParams();
                    try {
                        switch (event.getActionMasked()) {
                        case MotionEvent.ACTION_DOWN:
                            break;
                        case MotionEvent.ACTION_MOVE:
                            int x_cord = (int) event.getRawX();
                            int y_cord = (int) event.getRawY();
                            if (x_cord > windowwidth) {
                                x_cord = windowwidth;
                            }
                            if (y_cord > windowheight) {
                                y_cord = windowheight;
                            }
                            layoutParams2.leftMargin = x_cord - 25;
                            layoutParams2.topMargin = y_cord - 75;
                            ima2.setLayoutParams(layoutParams2);
                            break;
                        default:
                            break;

                        }

                    } catch (Exception e) {
                        e.getMessage();
                    }
                    return true;

                }

            });

        }

    } 
```

//xml文件

```
 <?xml version="1.0" encoding="utf-8"?>
    <LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
        android:id="@+id/layout"
        android:layout_width="match_parent"
        android:layout_height="match_parent"
        android:background="@drawable/ipodbackground"
        android:orientation="vertical" >

        <RelativeLayout
            android:layout_width="match_parent"
            android:layout_height="48dp"
            android:background="@drawable/headingmain1"
            android:gravity="center_horizontal" >

            <Button
                android:id="@+id/button1"
                android:layout_width="65dp"
                android:layout_height="match_parent"
                android:layout_marginLeft="10dp"
                android:background="#00000000" />

            <Button
                android:id="@+id/button2"
                android:layout_width="40dp"
                android:layout_height="match_parent"
                android:layout_alignParentRight="true"
                android:layout_alignParentTop="true"
                android:background="#00000000" />

            <TextView
                android:id="@+id/textView2"
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                android:layout_centerHorizontal="true"
                android:background="@drawable/quiztitle1" />
        </RelativeLayout>

        <RelativeLayout
            android:layout_width="match_parent"
            android:layout_height="75dp"
            android:layout_marginBottom="10dp"
            android:layout_marginLeft="10dp"
            android:layout_marginRight="10dp"
            android:layout_marginTop="10dp" >

            <LinearLayout
                android:id="@+id/l1"
                android:layout_width="250dp"
                android:layout_height="wrap_content"
                android:layout_marginRight="25dp"
                android:background="@drawable/box"
                android:orientation="horizontal" >

                <TextView
                    android:id="@+id/name"
                    android:layout_width="wrap_content"
                    android:layout_height="match_parent"
                    android:layout_marginLeft="5dp"
                    android:text="TextView" />

                <ImageView
                    android:id="@+id/userimage"
                    android:layout_width="match_parent"
                    android:layout_height="wrap_content"
                    android:layout_gravity="center_vertical"
                    android:layout_marginLeft="160dp"
                    android:layout_weight="1"
                    android:background="#FFFFFF"
                    android:src="@drawable/ic_launcher" />

            </LinearLayout>

            <LinearLayout
                android:layout_width="100dp"
                android:layout_height="match_parent"
                android:layout_alignParentRight="true"
                android:layout_marginRight="5dp"
                android:layout_toRightOf="@+id/l1" >

                <ImageView
                    android:id="@+id/shuffledimage"
                    android:layout_width="match_parent"
                    android:layout_height="wrap_content"
                    android:layout_gravity="center_vertical"
                    android:src="@drawable/iconsearch" />
            </LinearLayout>
        </RelativeLayout>

    </LinearLayout> 
```

// 我想将图像从一个图像视图拖放到另一个图像视图，并且在上面的代码部分中，当我拖动时可以正确拖动图像，但图像不能拖放到源图像视图。任何人请给出解决方案

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-06T08:36:43.003

对于拖放，请通过以下链接。

[http://blahti.wordpress.com/2011/10/03/drag-drop-for-android-gridview/](http://blahti.wordpress.com/2011/10/03/drag-drop-for-android-gridview/)

[http://www.twylah.com/dodulz/tweets/169426982533206016](http://www.twylah.com/dodulz/tweets/169426982533206016)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-06-28T06:18:46.937

您可以通过以下方式实现它

```
public class DragAndDropBasicActivity extends Activity implements OnTouchListener {
    private ImageView letterView;                       // The letter that the user drags.
    private ImageView emptyLetterView;              // The letter outline that the user is supposed to drag letterView to.
    private AbsoluteLayout mainLayout;

    /** Called when the activity is first created. */
    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.main);

        mainLayout = (AbsoluteLayout) findViewById(R.id.mainLayout);
        mainLayout.setOnTouchListener(this);
        letterView = (ImageView) findViewById(R.id.letterView);
        letterView.setOnTouchListener(this);

        emptyLetterView = (ImageView) findViewById(R.id.emptyLetterView);
    }

    private boolean dragging = false;
    private Rect hitRect = new Rect();

    @Override
    /** NOTE:  Had significant problems when I tried to react to ACTION_MOVE on letterView.   Kept getting alternating (X,Y) 
     * locations of the motion events, which caused the letter to flicker and move back and forth.  The only solution I could 
     * find was to determine when the user had touched down on the letter, then process moves in the ACTION_MOVE 
     * associated with the mainLayout.
    */
    public boolean onTouch(View v, MotionEvent event) {
        boolean eventConsumed = true;
        int x = (int)event.getX();
        int y = (int)event.getY();

        int action = event.getAction();
        if (action == MotionEvent.ACTION_DOWN) {
            if (v == letterView) {
                letterView.setImageResource(R.drawable.carkey1);
                dragging = true;
                eventConsumed = false;
            }
        } else if (action == MotionEvent.ACTION_UP) {

            if (dragging) {
                emptyLetterView.getHitRect(hitRect);
                if (hitRect.contains(x, y)) {
                    letterView.setImageResource(R.drawable.carkey3);
                    setSameAbsoluteLocation(letterView, emptyLetterView);
                }
            }
            dragging = false;
            eventConsumed = false;

        } else if (action == MotionEvent.ACTION_MOVE) {
            if (v != letterView) {
                if (dragging) {
                    setAbsoluteLocationCentered(letterView, x, y);
                }
            }
        }

        return eventConsumed;

    }

    private void setSameAbsoluteLocation(View v1, View v2) {
        AbsoluteLayout.LayoutParams alp2 = (AbsoluteLayout.LayoutParams) v2.getLayoutParams();
        setAbsoluteLocation(v1, alp2.x, alp2.y);
    }

    private void setAbsoluteLocationCentered(View v, int x, int y) {
        setAbsoluteLocation(v, x - v.getWidth() / 2, y - v.getHeight() / 2);
    }

    private void setAbsoluteLocation(View v, int x, int y) {
        AbsoluteLayout.LayoutParams alp = (AbsoluteLayout.LayoutParams) v.getLayoutParams();
        alp.x = x;
        alp.y = y;
        v.setLayoutParams(alp);
    }
} 
```

xml

```
<xml version="1.0" encoding="utf-8"?>
    <AbsoluteLayout xmlns:android="http://schemas.android.com/apk/res/android"
        android:id="@+id/mainLayout"
        android:layout_width="fill_parent"
        android:layout_height="fill_parent" >

         <ImageView
            android:id="@+id/emptyLetterView"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:src="@drawable/carkey2" >
        </ImageView>

        <ImageView
            android:id="@+id/letterView"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:layout_x="200dp"
            android:layout_y="450dp"
            android:src="@drawable/carkey1" >
        </ImageView>

</AbsoluteLayout> 
```

# javascript - jQuery attr 与道具？

> ID：13247058
> 
> 赞同：104
> 
> 时间：2012-11-06T08:22:03.887
> 
> 标签：javascript, jquery, attr, prop

* * *

## 回答 #1

> 赞同：71
> 
> 时间：2012-11-06T08:31:56.227

Unfortunately none of your links work :(

Some insight though, `attr` is for all attributes. `prop` is for properties.

In older jQuery versions (<1.6), we just had `attr`. To get to DOM properties such as `nodeName`, `selectedIndex`, or `defaultValue` you had to do something like:

```
var elem = $("#foo")[0];
if ( elem ) {
  index = elem.selectedIndex;
} 
```

That sucked, so `prop` was added:

```
index = $("#foo").prop("selectedIndex"); 
```

This was great, but annoyingly this wasn't backward compatible, as:

```
<input type="checkbox" checked> 
```

has no attribute of `checked`, but it does have a property called `checked`.

So, in the final build of 1.6, `attr` does also do `prop` so that things didn't break. Some people wanted this to be a clean break, but I think that the right decision was made as things didn't break all over the place!

Regarding:

> Prop: The value in it's current state after any modifications via JavaScript
> 
> Attr: The value as it was defined in the html on page load.

This isn't always true, as many times the attribute is actually changed, but for properties such as checked, there isn't an attribute to change, so you need to use prop.

References:

[http://blog.jquery.com/2011/05/03/jquery-16-released/](http://blog.jquery.com/2011/05/03/jquery-16-released/)

[http://ejohn.org/blog/jquery-16-and-attr](http://ejohn.org/blog/jquery-16-and-attr)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-11T12:36:54.637

There is a clear case to see differences between .prop and .attr

consider the HTML below :

```
<form name="form" action="#">
    <input type="text" name="action" value="myvalue" />
    <input type="submit" />
</form>
<pre id="return">
</pre> 
```

and the JS below using jQuery :

```
$(document).ready(function(){
    $("#return").append("$('form').prop('action') : " + $('form').prop('action') + '\r\n');
    $("#return").append("$('form').attr('action') : " + $('form').attr('action') + '\r\n');
    $("#return").append("document.form.action : " + document.form.action);
}); 
```

creates the following output:

```
$('form').prop('action') : [object HTMLInputElement]
$('form').attr('action') : #
document.form.action : [object HTMLInputElement] 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-06T08:33:21.610

I have tried this

```
console.log(element.prop(property));
console.log(element.attr(property)); 
```

and it outputs as below

```
http://fiddle.jshell.net/test/
/test/ 
```

this may indicates that the `action` is normalized only when it is **read** with `prop`.

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2014-07-27T12:35:45.707

since jquery 1.6.1+ attr() returns/changes property like before 1.6\. thus your tests do not make much sense.

be aware of minor changes in return values.

e.g.

attr(‘checked’): before 1.6 true/false is returend, since 1.6.1\. “checked”/undefined is returned.

attr(‘selected’): before 1.6 true/false is returned, since 1.6.1 “selected”/undefined is returned

a detailed overview to this topic in german can be found here:

[http://mabraham.de/jquery-prop-attr-val-richtig-verwenden/](http://mabraham.de/jquery-prop-attr-val-richtig-verwenden/)

# php - PHP电子邮件问题

> ID：13247059
> 
> 赞同：1
> 
> 时间：2012-11-06T08:22:10.437
> 
> 标签：php, mysql

我有一个带有 php 的 HTML 注册表单。成功提交后，它会向用户电子邮件地址发送一封确认电子邮件。

好吧，当用户看到他/她的电子邮件时，它显示为：

```
Yoursite.comr@mediaplan.ovh.net 
```

但是我没有将*@mediaplan.ovh.net*部分添加到电子邮件地址中。为什么它显示在此地址中。*@mediaplan.ovh.net*？以及如何删除它？

**php邮箱代码：**

```
$to = "$email";                     
$subject = "Signup | Verification";
$message = "Congratulation $f_name $l_name you have been successfully registered. 
Please click the link to active your account.\r\n";
$message .= "http://www.maaks.fr/hotel/verify.php?email=$email&hash=$hash\r\n";

$from = "Yoursite.com";
$headers = "MIME-Version: 1.0\r\n";
$headers .= "Content-rype: text/html; charset=iso-8859-1\r\n";
$headers .= "Content-Transfer-Encoding; 7bit\r\n";
$headers = "From:" . $from . "r\n";

$mailsent = mail($to,$subject,$message,$headers); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-06T08:28:46.493

首先，您在*from*标头部分缺少斜线。

```
$headers = "From:" . $from . "r\n";
                          //  ^ Here 
```

发送邮件时更改`From`标题

```
$from = "WebsiteName <Your@mail.com>";
$headers = "MIME-Version: 1.0\r\n";
$headers .= "Content-rype: text/html; charset=iso-8859-1\r\n";
$headers .= "Content-Transfer-Encoding; 7bit\r\n";
$headers = "From: " . $from . "\r\n"; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-06T08:26:43.637

尝试将 $from 更改为电子邮件地址。

```
$from = "noreply@yoursite.com"; 
```

# java - 会话超时后是否可以获取用户名/上次访问的页面

> ID：13247060
> 
> 赞同：1
> 
> 时间：2012-11-06T08:22:10.857
> 
> 标签：java, spring, cookies, spring-security, httpresponse

在我的应用程序中，我有一个`invalid-session-url`，我想知道是否可以在 中获取用户名`invalid-session-url`？如果是这样，请告知如何做到这一点。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-06T10:22:59.960

是的，有可能。当用户通过身份验证时，您可以将带有用户名值的 cookie 发送到用户的 Web 浏览器。当会话过期时，您仍然可以访问该 cookie。您需要做的就是将其生命周期设置为足够长。

您可以实现自己的`Filter`. 我建议扩展`UsernamePasswordAuthenticationFilter`. 覆盖`Authentication attemptAuthentication(HttpServletRequest request, HttpServletResponse response)`使您可以访问 cookie - 您可以使用`HttpServletResponse.addCookie(Cookie cookie)`.

您可以轻松注入自己的过滤器。有关配置的更多信息：http: [//static.springsource.org/spring-security/site/docs/3.1.x/reference/springsecurity-single.html#nsa-custom-filter](http://static.springsource.org/spring-security/site/docs/3.1.x/reference/springsecurity-single.html#nsa-custom-filter)

还要考虑到发送这样的 cookie 可能是不安全的。我没有看到任何其他方式来完成你想要的。但是您可以通过配置轻松提高此解决方案的安全性`LogoutHandler`。这个接口有一个实现`CookieClearingLogoutHandler`。当用户决定手动注销时，您可以使用它来清除该 cookie。

```
<bean id="cookieClearingLogoutHandler" class="org.springframework.security.web.authentication.logout.CookieClearingLogoutHandler">
    <constructor-arg>
        <!-- Names of the cookies you want to remove when user logs out -->
        <list>
            <value>username</value>
        </list>
    </constructor-arg>
</bean>

<bean id="logoutFilter" class="org.springframework.security.web.authentication.logout.LogoutFilter">
    <constructor-arg value="/login"/>
    <constructor-arg>
        <array>
            <ref local="securityContextLogoutHandler"/>
            <!-- Inject it -->
            <ref local="cookieClearingLogoutHandler"/>
        </array>
    </constructor-arg>
    <property name="filterProcessesUrl" value="/logout"/>
</bean> 
```

# linux - 检查文件是否仅通过文件名存在（没有扩展名）

> ID：13247069
> 
> 赞同：3
> 
> 时间：2012-11-06T08:22:46.050
> 
> 标签：linux, bash, shell

这工作得很好

```
if [[ -e img.png ]]
then
     echo "exist"
else
     echo "doesn't exist"
fi 
```

但是，如果我知道可能存在名为 img 的图像，但我不知道文件是 .jpg 、 .gif 、 .jpeg 、 .tff 等，该怎么办。

我不在乎扩展名是什么我只想知道是否有一个名为“img”的文件

我怎样才能做到这一点 ？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-06T08:28:27.740

您可以使用以下脚本

```
files=`ls img.* 2>/dev/null`
if [ "$files" -a ${#files[@]} ]; then
    echo "exist"
else
    echo "doesn't exist"
fi 
```

在此代码段中，您用于`ls img.*`列出当前工作目录中名称与模式匹配的所有文件`img.*`。结果存储在名为 的数组`files`中。然后检查数组的大小以确定是否存在所需的文件。

请参阅[this](http://www.cyberciti.biz/faq/finding-bash-shell-array-length-elements/)了解如何获取数组的长度。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-06T08:28:48.180

你可以做：

```
files=$(ls img.* 2> /dev/null | wc -l)
if [ "$files" != "0" ]
then
echo "exist"
else
echo "doesn't exist"
fi 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-06T08:45:24.690

像这样的东西应该可以完成这项工作：

```
if [[ $(ls img.*) ]]; then
  echo "file exist";
else
  echo "file does not exist";
fi 
```

我建议看看 bash 的模式匹配： [http ://tldp.org/LDP/Bash-Beginners-Guide/html/sect_04_03.html](http://tldp.org/LDP/Bash-Beginners-Guide/html/sect_04_03.html)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-06T09:01:54.517

没有任何外部命令：

```
$ for i in img.*
> do
>  [ -f $i ] && echo exist || echo not exist
>  break
> done 
```

检查是否存在任何文件。如果存在 print 存在，否则不存在，并立即中断。需要“-f”检查，因为如果不存在文件，循环仍然会运行一次，i 作为“img.*”本身。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-11-06T11:26:55.843

```
shopt -s nullglob
files=( img.* )
if (( ${#files[@]} == 0 )); then
    echo "there are no 'img' files"
fi 
```

如果不使用`nullglob`then，如果没有这样的文件，则数组将有 1 个元素，即文字字符串“img.*”。

# iphone - 子视图上的 UITextField 返回键

> ID：13247079
> 
> 赞同：1
> 
> 时间：2012-11-06T08:23:20.557
> 
> 标签：iphone, xcode

我有一个我在它上面创建`UIViewController`的额外的小`UIView`东西（子视图）。当我单击一个按钮时，此视图将悬停在屏幕中央。问题是我有一个`UITextField`额外的`UIView`，我似乎无法让返回键工作。

虽然我将我设置`IBAction`为文本字段的事件“编辑确实结束”，但当我单击返回键时，`IBAction`它不会运行。

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-06T08:39:54.040

确保 UITextFieldDelegate 在界面

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-06T08:41:04.310

例如，您只需设置您的代表 :-`yourtextfile.delegate=self;`并且不要忘记将委托方法添加到 .h 文件中

`@interface contacts_detailView : UIViewController<UITextFieldDelegate>`

然后你委托`textFieldDidEndEditing`

```
- (void)textFieldDidEndEditing:(UITextField *)textField
{
//your new view apear code here 
    [textField resignFirstResponder];
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-06T08:41:53.940

单击“返回”不会触发“编辑结束”事件。只有当您在 UITextField 上调用 resignFirstResponder 时，您才会看到触发的事件。

您应该做的是将您的 UIViewController 设置为 UITextField 的委托并实现该方法

```
- (BOOL)textFieldShouldReturn:(UITextField *)textField
{
    [textField resignFirstResponder];
    return YES;
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-06T08:46:31.320

首先，将 TextField 委托给文件的所有者，如下所示：

`yourtextField.delegate = self`在你的 viewDidLoad 中。

然后将其添加到视图控制器

```
- (BOOL)textFieldShouldReturn:(UITextField *)textField
{
    [textField resignFirstResponder];
    return YES;
} 
```

它应该工作。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-11-06T09:12:15.740

无需为键盘返回编写更多代码。请在您的 .m 文件中写入，它适用于任意数量的文本字段，无需为不同的文本字段再次写入。

`<UItextfieldDelegate>` 在您的 .h 文件中使用。然后在 nib 文件中与文件所有者进行连接。

```
- (BOOL)textFieldShouldReturn:(UITextField *)textField
    {
     [self.view endEditing:YES];
     return YES;
     } 
```

# c# - 单击 FileUpload 按钮时的 OnClick 事件

> ID：13247082
> 
> 赞同：1
> 
> 时间：2012-11-06T08:23:33.103
> 
> 标签：c#, asp.net

*单击asp:FileUpload*按钮时是否可以触发`OnClick`事件？

 ** * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-06T08:31:45.257

根据[w3schools](http://www.w3schools.com/jsref/dom_obj_fileupload.asp)，文件类型的输入可以支持所有标准[事件](http://www.w3schools.com/jsref/dom_obj_event.asp)。所以你可以做的是给你的控件写一个点击的javascript事件：

```
YOURCONTROL.Attributes.Add("onclick","YourLogic"); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-06T13:47:26.673

您可以使用闪存代码，它将文件上传器作为可点击的按钮。但为此，您需要下载 swfupload.swf 文件。

```
 <input type="file" id="uplaodExcel" name="uplaodExcel" /> 
```

以下是javascript代码：

```
Sys.Application.add_init(function () {
    HideError();
    $("#uplaodExcel").makeAsyncUploader({
        upload_url: 'EventName',//Event you want to occur on click
        flash_url: '../Scripts/swfupload.swf',//flash file path that you download
        button_image_url: '@Url.Content("~/Content/blankButton.png")',// for button style
        file_size_limit: "10MB",
        file_types: "*.XLS; *.xlsx", //File extension you can provide any
        disableDuringUpload: 'INPUT[type="submit"]',
        upload_success_handler: function (file, server_data, receivedResponse) {
            var data = "";
            try {
                // you can add your code here
            } catch (e) { }

        }
    });
}); 
```*

# android - 带有 HeaderView 的 Android setSelection(index) ListView 设置少 1 个索引

> ID：13247083
> 
> 赞同：1
> 
> 时间：2012-11-06T08:23:41.447
> 
> 标签：android, android-listview

有 ListView 和**HeaderView**，当我使用 setSelection API 设置索引时，它会将错误（少 1 个）索引设置为选定索引。

以下是代码片段：

```
final ListView lst = (ListView)findViewById(R.id.listView1);
LinearLayout headerLayout = new LinearLayout(this);
headerLayout.setLayoutParams(new ListView.LayoutParams(ListView.LayoutParams.WRAP_CONTENT,ListView.LayoutParams.WRAP_CONTENT));
headerLayout.setId(9);
lst.addHeaderView(headerLayout, null, false);'code' 
```

例如

```
listView.setSelection(6); 
```

* * *

```
Button btn6 = (Button)findViewById(R.id.button6);
        btn6.setOnClickListener(new OnClickListener(){

            @Override
            public void onClick(View arg0) {

                lst.setSelection(6);
                View v1 = lst.getChildAt(0);
                int top = (v1 == null) ? 0 : v1.getTop();
                lst.setSelectionFromTop(6, top);    

                //lst.setSelection(6);

            }}); 
```

这会将焦点设置为选定项目的**第 5 个位置**项目。

我试过了

```
View v1 = listView.getChildAt(0);
View n = lst.findViewById(9); // 9 is id of listView's header.
listView.setSelectionFromTop(6, n.getMeasuredHeight()); 
```

和

```
View v1 = listView.getChildAt(0);
int top = (v1 == null) ? 0 : v1.getTop();
listView.setSelectionFromTop(6, top); 
```

但这也行不通。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-06T08:29:57.373

尝试这个 `int index = 6(this can be any number or value) + 1`

```
listView.setSelection(index);
View v1 = listView.getChildAt(0);
int top = (v1 == null) ? 0 : v1.getTop();
listView.setSelectionFromTop(index, n.getMeasuredHeight()); 
```

# git - 集中式 GIT 工作流/部署 - 存储库初始化和功能分支

> ID：13247085
> 
> 赞同：3
> 
> 时间：2012-11-06T08:23:48.763
> 
> 标签：git, workflow, branch, centralized, unfuddle

好的，我只想检查我的 GIT 设置的工作流程是否正确，并且在我开始正确使用它之前我完全理解它。我正在遵循[这个](http://nvie.com/posts/a-successful-git-branching-model/)工作流程，这个主题只是从初始化和创建功能分支开始，然后当我确信我将为发布和修补程序创建一个新主题时。希望这将有助于其他希望在类似工作流程中使用 GIT 的人。

有 3 个开发人员，我们称他们为 A、B 和 C，他们都将在他们的本地计算机上工作，我们有 4 个远程服务器 - 'Development'、'Staging'、'Production' 和 Unfuddle（作为集中式服务器）。开发人员 A 在其本地计算机上拥有文件目录。

所以，我认为工作流程如下。

首先，我需要在 Unfuddle 上创建存储库，然后在本地将我的文件推送到 Unfuddle 服务器。

1.  在 Unfuddle 中创建一个名为“website”的存储库，并将其缩写为“web”

2.  在“开发”、“暂存”和“生产”服务器上创建一个 SSH 密钥对，并将它们添加到 Unfuddle 帐户。

3.  开发人员 A 在其文档根目录中初始化一个 Git 存储库：

    `git init`

4.  将 Unfuddle 存储库与开发人员 A 的本地存储库相关联，并将其指定为上游服务器：

    `git remote add unfuddle git@subdomain.unfuddle.com:username/web.git`

    `git config remote.unfuddle.push refs/heads/master:refs/heads/master`

5.  开发人员 A 将所有文件添加到索引

    `git add *`

6.  开发者 A 提交所有文件

    `git commit -am 'initial commit'`

7.  开发人员 A 将本地提交的内容推送到 Unfuddle Git 存储库。

    `git push unfuddle master`

我现在应该在我的 Unfuddle 存储库中看到我的所有文件。开发人员 B 和 C 现在可以克隆存储库以获取网站文件的副本。

```
`git clone git@subdomain.unfuddle.com:username/web.git` 
```

**功能分支：**

每个开发人员现在都可以使用以下工作流程开始创建功能分支：

1.  `git checkout -b develop`
2.  `git checkout -b feature\test develop`
3.  进行任何代码更改
4.  `git commit -a -m "Make test code changes"`
5.  `git checkout develop`
6.  `git merge --no-ff feature\test`
7.  `git branch -d feature\test`
8.  `git push unfuddle develop`

好的，所以下一部分我不确定。我们已将功能更改推送到集中式 Unfuddle 服务器，但是其他开发人员需要获取更改，因此他们是否需要创建一个“开发”分支然后执行`git pull unfuddle develop`？我读过 fetch and merge 比 pull 好，是这样吗？如果是的话，会是`git fetch unfuddle develop`那时`git merge develop`吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-06T17:20:20.023

听起来很扎实。

关于`pull`vs `fetch`，我认为如果你确切地知道 pull 的作用（`fetch`/ `merge`），你就可以自由地使用它。很多 git 的新手在`pull`不了解它的作用的情况下使用它，但似乎你掌握了它。我只是确保你的团队知道有什么区别。

我没有看到的唯一步骤是部署到您的网络服务器 - 这些也应该执行`fetch`/`merge`或`pull`更新。您可能希望从手动开始此过程，并考虑在未来将其自动化。您应该可以使用 git hooks 来做到这一点（Unfuddle 应该支持它们）。这些脚本会因您正在运行的服务器类型而异。

# python - QAbstractTableModel 和 QComboBox 一起

> ID：13247089
> 
> 赞同：1
> 
> 时间：2012-11-06T08:24:12.273
> 
> 标签：python, model-view-controller, pyqt

我有一个 a 的子类，`QAbstractTableModel`我想用它`QComboBox`来显示这个表的保管箱。

但默认情况下，它只显示我表的第一列，这不是我想要的。我试图`setModelColumn`显示第 1 列而不是 0 但它不起作用。

在互联网上环顾四周后，我找到了2个解决方案：

1.  `QAbstractListModel`使用相同的数据创建另一个`QAbstractTableModel`
2.  使用 a`QSortFilterProxyModel`隐藏其他列

哪个是最好的？谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-06T08:45:29.890

使用`setModelColumn`应该工作。我会尝试解决这个问题。也许您`modelColumn`在错误的时间设置了，[文档](http://doc.qt.digia.com/qt/qcombobox.html#modelColumn-prop)对此有这样的说法：

> 如果在填充组合框之前设置，弹出视图不会受到影响，并且会显示第一列（使用此属性的默认值）。

如果这真的不起作用，我很确定它应该，然后使用`QSortFilterProxyModel`. 这将少很多工作，而且应该几乎是微不足道的。

# android - 哪个更好的解决方案获取服务器响应数据？

> ID：13247098
> 
> 赞同：1
> 
> 时间：2012-11-06T08:24:49.243
> 
> 标签：android, inputstream, inputstreamreader

我们通常在android开发中从服务器响应中获取数据。

```
/*
* get server response inputStream
*/
InputStream responseInputStream; 
```

解决方案1：通过多次读取获取响应字符串。

```
 /*
       * get server response string
      */
    StringBuffer responseString = new StringBuffer();
    responseInputStream = new InputStreamReader(conn.getInputStream(),"UTF-8");

    char[] charBuffer = new char[bufferSize];
    int _postion = 0;
    while ((_postion=responseInputStream.read(charBuffer)) > -1) {
        responseString.append(charBuffer,0,_postion);
        }
    responseInputStream.close(); 
```

解决方案2：仅获得一次读取响应。

```
String responseString = null;
int content_length=1024;
// we can get content length from response header, here assign 1024 for simple.
responseInputStream = new InputStreamReader(conn.getInputStream(),"UTF-8");

char[] charBuffer = new char[content_length];
int _postion = 0;
int position = responseInputStream.read(charBuffer)
if(position>-1){
   responseString = new String(charBuffer,0,position );
 }
responseInputStream.close(); 
```

哪种解决方案具有更好的性能？为什么？

**注意**：服务器响应json格式数据，小于1M字节。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-11T19:07:05.383

为什么要重新发明轮子？;)

如果您使用的是 HttpClient，那么只需使用`EntityUtils.toString(...)`.
我猜你正在使用`HttpURLConnection`. 然后`EntityUtils.toString(...)`从 Apache HttpClient中查看[源代码](http://www.docjar.org/html/api/org/apache/http/util/EntityUtils.java.html)。您的第一种方法与它类似。

顺便说一句，第二个代码更糟糕，因为：

`new String(charBuffer,0,position )`运行垃圾收集器

在 EntityUtils 中，甚至在 EntityUtils 中：

`int content_length = 1024;`在大多数情况下 8192 是套接字缓冲区的默认值，因此您的代码运行 while 循环的频率可能是它的 8 倍。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-09T03:38:27.550

**如果您不想**显示下载/传输的数据量，我会推荐**第二种**方法。由于对象是作为一个整体读取的，并且由于您的 JSON 字符串的大小与 1M 相当，因此下载需要一些时间。到时候你最多可以给用户发一条文字，说正在**下载……** 您无法通知用户下载的数量。 但是，如果您想显示下载的数据量，请使用您提供的**第**一种方法。您从服务器部分读取数据的位置。您可以使用下载的数量更新*UI*。例如**，下载了 25%...**

 *******```
char[] charBuffer = new char[bufferSize];
    int _postion = 0;
    int i=0;
    while ((_postion=responseInputStream.read(charBuffer)) > -1) {

       //((i*buffer_size)/content_length) * 100  % completed..

        i++;
        } 
```

所以，我会说秒方法更好。

顺便说一句，你考虑过这个吗？

```
ObjectInputStream in = new InputStreamReader(conn.getInputStream(),"UTF-8");
if(resposeCode==200)
{
 String from_server=(String)  in.readObject();
} 
```

将输入字符串作为对象读取。类实现可序列化的任何对象都可以使用传递`ObjectOutputStream` 和接收使用`ObjectInputStream()`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-06T09:09:47.630

我觉得**第一个很好**

因为，**首先** ，这将在 char to char method 中读取您的响应。

其中，**第二个** 将尝试读取整个响应对象或作为对象的关键字段。

因此，据我所知，根据我的知识，首先最好与第二个露营。如果有人想编辑，那将不胜感激。*******

# ios - 每次进入此视图时内存都会增加，并且我无法在此代码中使用 arc

> ID：13247100
> 
> 赞同：1
> 
> 时间：2012-11-06T08:24:58.477
> 
> 标签：ios, memory-management, memory-leaks, nszombie

每次我进入相同的视图内存都在增加。即使我发布什么也没发生，由于较旧的应用程序问题，我无法使用 ARC。不知道如何解决这个问题。

```
#import <UIKit/UIKit.h>
#import "CareServices.h"

@interface AttachedImage : UIViewController<ServerConnectionDelegate,UIScrollViewDelegate>

{
  IBOutlet  UIImageView *imageView;
    CareServices *careServices;
    UIScrollView *_scrollView;
    UIView  *activityView;
    UIActivityIndicatorView *_activity;
}

@property (nonatomic,retain)UIImageView *imageView;
@end

#import "AttachedImage.h"
#import"XMLParserForOtherAttachments.h"
#import "ColorSchemes.h"

@implementation AttachedImage
@synthesize imageView;

- (id)initWithNibName:(NSString *)nibNameOrNil bundle:(NSBundle *)nibBundleOrNil
{
    self = [super initWithNibName:nibNameOrNil bundle:nibBundleOrNil];
    if (self) {
        // Custom initialization
    }
    return self;
}

- (void)didReceiveMemoryWarning
{
    // Releases the view if it doesn't have a superview.
    [super didReceiveMemoryWarning];

    // Release any cached data, images, etc that aren't in use.
}

#pragma mark - View lifecycle

- (void)viewDidLoad
{
    activityView = [[UIView alloc]initWithFrame:CGRectMake(self.view.frame.size.width/2.5,self.view.frame.size.height/2.5, 60, 60)];
    activityView.backgroundColor = [UIColor clearColor];

    [self.view addSubview:activityView];

    UIImageView *activityImageView = [[UIImageView alloc]initWithFrame:CGRectMake(0, 0, activityView.frame.size.width, activityView.frame.size.height)];
    activityImageView.image = [UIImage imageNamed:@"indicatorImage.jpeg"];
    [activityView addSubview:activityImageView];
    [activityImageView release];

    _activity = [[UIActivityIndicatorView alloc]initWithActivityIndicatorStyle:UIActivityIndicatorViewStyleWhiteLarge];
    [_activity setFrame:CGRectMake(activityView.frame.size.width/5.8, activityView.frame.size.height/5.3, 40, 40)];
    [activityView addSubview:_activity];
    [_activity startAnimating];
    [_activity release];

    careServices = [CareServices currentInstance];
    careServices.delegate = self;
    [[NSURLCache sharedURLCache] removeAllCachedResponses];

    [super viewDidLoad];

    self.navigationItem.title = @"Attachment View";
//    self.view.backgroundColor = [ColorSchemes sharedInstance].primaryColor1;

    self.view.backgroundColor = [UIColor blackColor];;
    // Do any additional setup after loading the view from its nib.
}

-(void)viewDidAppear:(BOOL)animated {

 NSString *senderTagStr;
    NSUserDefaults *senderD = [NSUserDefaults standardUserDefaults];
    senderTagStr = [senderD valueForKey:@"sender tag"];
    _scrollView = [[UIScrollView alloc]initWithFrame:CGRectMake(0, 0, self.view.frame.size.width, self.view.frame.size.height)];
    _scrollView.maximumZoomScale = 4.0;
    _scrollView.minimumZoomScale = 1.0;
    _scrollView.delegate = self;
    _scrollView.contentSize = CGSizeMake(400, 500);
    if (careServices.loginMode == ELoginModeDemo) {
    if ([senderTagStr isEqualToString:@"0"]) {
        imageView.image = [UIImage imageNamed:@"R1.bmp"];
    }
    else {
        imageView.image = [UIImage imageNamed:@"8.jpg"];
      }
    }

 else {

  NSString *str = [NSString stringWithString:[XMLParserForOtherAttachments sharedManager].fileURlStr];
    NSString *trimmedStr = [str stringByTrimmingCharactersInSet:[NSCharacterSet whitespaceAndNewlineCharacterSet]];
    NSData *imgData = [[NSData alloc]initWithContentsOfURL:[NSURL URLWithString:trimmedStr]];
        UIImage   *myImage = [UIImage imageWithData:imgData];
    imageView.image = myImage;
        [imgData release];
    }
    [_scrollView addSubview:imageView];
    [self.view addSubview:_scrollView];
    [_activity stopAnimating];
    [activityView removeFromSuperview];    

}
- (void)viewDidUnload {

    [[NSURLCache sharedURLCache] removeAllCachedResponses];

    self.imageView = nil;
    [super viewDidUnload];

}

- (void)dealloc{
    [imageView release];
    [super dealloc];
}

- (UIView *)viewForZoomingInScrollView:(UIScrollView *)scrollView {
    return imageView;
}
@end 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-06T08:38:13.320

一旦你[学会了使用 Heapshot Analysis ，](http://www.friday.com/bbum/2010/10/17/when-is-a-leak-not-a-leak-using-heapshot-analysis-to-find-undesirable-memory-growth/)定位有问题的分配/实现就很容易了。

Heapshot Analysis 允许您在执行期间拍摄快照，以检测一段时间内的增长，在许多情况下您当然可以将其与用户操作相关联。因此，例如，您可以将视图控制器推送到 iOS 中的导航堆栈上，然后退后一步，轻松确定这样做的增长情况。然后导航到导致增长的实现。

# linker - CMAKE DSO 链接

> ID：13247107
> 
> 赞同：1
> 
> 时间：2012-11-06T08:25:22.447
> 
> 标签：linker, cmake, shared-libraries, ld

我对cmake完全陌生。在 svn 更新后（还有 binutils，我怀疑这是导致问题的原因），我收到一个错误（我之前成功编译并使用过该程序）

```
Linking CXX executable gmsh
/usr/bin/ld: /usr/local/lib/liblapack.a(dgesvd.o): undefined reference to symbol '_gfortran_concat_string@@GFORTRAN_1.0'
/usr/bin/ld: note: '_gfortran_concat_string@@GFORTRAN_1.0' is defined in DSO /usr/lib/libgfortran.so.3 so try adding it to the linker command line
/usr/lib/libgfortran.so.3: could not read symbols: Invalid operation
collect2: error: ld returned 1 exit status
make[2]: *** [gmsh] Error 1
make[1]: *** [CMakeFiles/gmsh.dir/all] Error 2
make: *** [all] Error 2 
```

也许它与这个[Fedoraproject DSO Change](http://fedoraproject.org/wiki/UnderstandingDSOLinkChange)有关？

我有一个最新的 archlinux (binutils-2.23-1)。

我试图编辑`ccmake .`菜单中的行。点击 [c] 后，原始选项被恢复（因此我无法添加`/usr/lib/libgfortran.so.3`到`GMSH_EXTERNAL_LIBRARIES`变量中以订购 `[g] generate`新的 Makefile）。

*我还尝试添加一些在cmake irc chat*中推荐的选项，但最终没有奏效。

```
 cmake . -DCMAKE_LINK_FLAGS=-Wl,--add-needed 
```

或者

```
 cmake . -DCMAKE_LINK_FLAGS=-lgfortran 
```

导致同样的错误。我能做些什么？

附加信息：`make VERBOSE=1` [pastebin 链接](http://pastebin.com/xhbzasvb)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-06T20:42:30.030

要将库添加到链接命令，您可以使用[`target_link_libraries`](http://www.cmake.org/cmake/help/v2.8.10/cmake.html#command%3atarget_link_libraries). 显然在这种情况下你想要：

```
target_link_libraries(gmsh ${LINK_LIBRARIES} gfortran) 
```

# android - 图片或相机浏览器

> ID：13247109
> 
> 赞同：0
> 
> 时间：2012-11-06T08:25:22.983
> 
> 标签：android

我正在尝试下一步：我有一个 ImageView，我希望它在用户触摸它以让他选择或拍照时显示为图片浏览器或相机。我发现：

```
private void openPictureBrowser()
{
   Intent intent = new Intent(Intent.ACTION_GET_CONTENT);
   intent.setType("image/*");
   intent.putExtra(Intent.EXTRA_TITLE,"A Custom Title"); //optional
   intent.addFlags(Intent.FLAG_ACTIVITY_EXCLUDE_FROM_RECENTS); //optional
   try {
      startActivityForResult(intent, 1);
   } catch (Exception e) {
      e.printStackTrace();
   }
}

@Override
protected void onActivityResult(int requestCode, int resultCode, Intent data){
   switch (requestCode) {
      case 1: {
         if (resultCode == RESULT_OK && data != null && data.getData() != null) {
            String filePath = data.getData().getPath(); //WARNING: this is NOT your real path (in my case, value is set to "/external/images/media/4"
         }
      }
   }
} 
```

如果我想添加相机，我可以在 openPictureBrowser 中做什么？

我应该在 onActivityResult 中做什么来将 filePath 设置为 ImageView 背景？

有人可以给我一个提示吗？？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-06T10:36:19.427

```
public class Set_image extends Activity implements OnClickListener
{
    Button btn_capture_image,btn_share_from_gallery;
    ImageView iv_set_image;
    private static final int REQUEST_CODE = 1;
     private static final int CAMERA_REQUEST = 1888; 
    String filePath="";
    Bitmap Main_bitmap;

 @Override
    public void onCreate(Bundle savedInstanceState)
    {

        super.onCreate(savedInstanceState);
        setContentView(R.layout.set_image);

        btn_capture_image =(Button) findViewById(R.id.button_capture_image);
        btn_share_from_gallery =(Button) findViewById(R.id.button_share_from_gallery);
        iv_set_image = (ImageView) findViewById(R.id.imageView_set_iamge);

        btn_capture_image.setOnClickListener(this);
        btn_share_from_gallery.setOnClickListener(this);

    }

public void onClick(View v) 
{

        if (v == btn_capture_image)
        {
            Intent cameraIntent = new Intent(android.provider.MediaStore.ACTION_IMAGE_CAPTURE); 
            startActivityForResult(cameraIntent, CAMERA_REQUEST); 
        }

        if (v == btn_share_from_gallery)
        {
            Intent intent = new Intent();
            intent.setType("image/*");
            intent.setAction(Intent.ACTION_GET_CONTENT);
            intent.addCategory(Intent.CATEGORY_OPENABLE);
            startActivityForResult(intent, REQUEST_CODE);
        }
}

    @Override
    protected void onActivityResult(int requestCode, int resultCode, Intent data) 
    {

        if (requestCode == CAMERA_REQUEST)
        {  
            Main_bitmap = (Bitmap) data.getExtras().get("data");  
            iv_set_image.setImageBitmap(Main_bitmap);    
        }   

        if (requestCode == REQUEST_CODE && resultCode == Activity.RESULT_OK)

            try 
             {

                    Uri selectedImage = data.getData();
                    String[] filePathColumn = {MediaStore.Images.Media.DATA};
                    Cursor cursor = getContentResolver().query(selectedImage, filePathColumn, null, null, null);

              if (cursor.moveToFirst()) 
              {
                     int columnIndex = cursor.getColumnIndex(filePathColumn[0]);
                     filePath = cursor.getString(columnIndex);
                     BitmapFactory.Options options4 = new BitmapFactory.Options();
                     options4.inSampleSize = 1;
                     Main_bitmap = BitmapFactory.decodeFile(filePath, options4);                         iv_set_image.setImageBitmap(Main_bitmap);

               }
                    cursor.close();
             } 
             catch (Exception e)
             {
                    e.printStackTrace();
             }
            super.onActivityResult(requestCode, resultCode, data);
} 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-11-06T08:32:54.103

使用以下代码：

```
import java.io.File;
import java.util.ArrayList;
import java.util.Calendar;

import android.app.Activity;
import android.app.ProgressDialog;
import android.content.Context;
import android.content.Intent;
import android.database.Cursor;
import android.graphics.Bitmap;
import android.graphics.BitmapFactory;
import android.graphics.drawable.BitmapDrawable;
import android.graphics.drawable.Drawable;
import android.net.Uri;
import android.os.AsyncTask;
import android.os.Bundle;
import android.os.Environment;
import android.provider.MediaStore;
import android.util.Log;
import android.view.ContextMenu;
import android.view.Gravity;
import android.view.MenuInflater;
import android.view.MenuItem;
import android.view.View;
import android.view.Window;
import android.view.ContextMenu.ContextMenuInfo;
import android.view.View.OnClickListener;
import android.view.ViewGroup.LayoutParams;
import android.widget.Button;
import android.widget.ImageView;
import android.widget.TableLayout;
import android.widget.TableRow;
import android.widget.TextView;

public class LoadImage extends Activity 
{
    Activity activity=null;
    Context context=null;

    Button header_left_btn=null;
    Button header_right_btn=null;
    TextView header_text=null;
    TableLayout image_table=null;

    ArrayList<String> image_list=new ArrayList<String>();
    ArrayList<Drawable> image_drawable=new ArrayList<Drawable>();
    String path="";

    /** Called when the activity is first created. */
    @Override
    public void onCreate(Bundle savedInstanceState) 
    {
        super.onCreate(savedInstanceState);
        requestWindowFeature(Window.FEATURE_CUSTOM_TITLE);
        setContentView(R.layout.main);
        getWindow().setFeatureInt(Window.FEATURE_CUSTOM_TITLE,R.layout.header);

        activity=LoadImage.this;
        context=LoadImage.this;

        header_left_btn=(Button)findViewById(R.id.header_left_btn);
        header_right_btn=(Button)findViewById(R.id.header_right_btn);
        header_text=(TextView)findViewById(R.id.header_text);
        image_table=(TableLayout)findViewById(R.id.image_table);

        header_text.setText("Image Table");
        header_left_btn.setText("Select");
        header_right_btn.setText("Clear");
        registerForContextMenu(header_left_btn);

        header_left_btn.setOnClickListener(new OnClickListener(){

            @Override
            public void onClick(View v) 
            {
                // TODO Auto-generated method stub
                openContextMenu(header_left_btn);
            }
        });

        header_right_btn.setOnClickListener(new OnClickListener(){

            @Override
            public void onClick(View v) 
            {
                // TODO Auto-generated method stub
                image_list.clear();
                image_drawable.clear();
                deletePhotos();
                updateImageTable();
            }
        });
    }

    public void deletePhotos()
    {
        String folder=Environment.getExternalStorageDirectory() +"/LoadImg";
        File f=new File(folder);
        if(f.isDirectory())
        {
            File[] files=f.listFiles();
            Log.v("Load Image", "Total Files To Delete=====>>>>>"+files.length);
            for(int i=0;i<files.length;i++)
            {
                String fpath=folder+File.separator+files[i].getName().toString().trim();
                System.out.println("File Full Path======>>>"+fpath);
                File nf=new File(fpath);
                if(nf.exists())
                {
                    nf.delete();
                }
            }
        }
    }

    @Override
    public void onCreateContextMenu(ContextMenu menu, View v, ContextMenuInfo menuInfo)
    {

        super.onCreateContextMenu(menu, v, menuInfo);
        menu.setHeaderTitle("Post Image");
        MenuInflater inflater = getMenuInflater();
        inflater.inflate(R.menu.camer_menu, menu);
    }

    @Override
    public boolean onContextItemSelected(MenuItem item)
    {
      switch (item.getItemId())
      {
          case R.id.take_photo:
              //Toast.makeText(context, "Selected Take Photo", Toast.LENGTH_SHORT).show();
              takePhoto();
              break;

          case R.id.choose_gallery:
              //Toast.makeText(context, "Selected Gallery", Toast.LENGTH_SHORT).show();
              Intent photoPickerIntent = new Intent(Intent.ACTION_PICK);
              photoPickerIntent.setType("image/*");
              startActivityForResult(photoPickerIntent, 1);

              break;

          case R.id.share_cancel:
              closeContextMenu();
              break;
          default:
            return super.onContextItemSelected(item);
      }
      return true;
    }

    public void takePhoto() 
    {
         Intent intent = new Intent("android.media.action.IMAGE_CAPTURE");
         File folder = new File(Environment.getExternalStorageDirectory() + "/LoadImg");

         if(!folder.exists())
         {
             folder.mkdir();
         }         
         final Calendar c = Calendar.getInstance();
         String new_Date= c.get(Calendar.DAY_OF_MONTH)+"-"+((c.get(Calendar.MONTH))+1)   +"-"+c.get(Calendar.YEAR) +" " + c.get(Calendar.HOUR) + "-" + c.get(Calendar.MINUTE)+ "-"+ c.get(Calendar.SECOND);
         path=String.format(Environment.getExternalStorageDirectory() +"/LoadImg/%s.png","LoadImg("+new_Date+")");
         File photo = new File(path); 
         intent.putExtra(MediaStore.EXTRA_OUTPUT,Uri.fromFile(photo));
         startActivityForResult(intent, 2);
    }

    @Override
    public void onActivityResult(int requestCode, int resultCode, Intent data) 
    {
        super.onActivityResult(requestCode, resultCode, data);

        if(requestCode==1)
        {
            Uri photoUri = data.getData();
            if (photoUri != null)
            {
                String[] filePathColumn = {MediaStore.Images.Media.DATA};
                Cursor cursor = getContentResolver().query(photoUri, filePathColumn, null, null, null);
                cursor.moveToFirst();
                int columnIndex = cursor.getColumnIndex(filePathColumn[0]);
                String filePath = cursor.getString(columnIndex);
                cursor.close();
                Log.v("Load Image", "Gallery File Path=====>>>"+filePath);
                image_list.add(filePath);
                Log.v("Load Image", "Image List Size=====>>>"+image_list.size());

                //updateImageTable();
                new GetImages().execute();
            }
        }

        if(requestCode==2)
        {
            Log.v("Load Image", "Camera File Path=====>>>"+path);
            image_list.add(path);
             Log.v("Load Image", "Image List Size=====>>>"+image_list.size());
            //updateImageTable();
             new GetImages().execute();
        }
    }

    public void updateImageTable()
    {
        image_table.removeAllViews();

        if(image_drawable.size() > 0)
        {
            for(int i=0; i<image_drawable.size(); i++)
            {
                TableRow tableRow=new TableRow(this);
                tableRow.setLayoutParams(new LayoutParams(LayoutParams.FILL_PARENT, LayoutParams.WRAP_CONTENT));
                tableRow.setGravity(Gravity.CENTER_HORIZONTAL);
                tableRow.setPadding(5, 5, 5, 5);
                for(int j=0; j<1; j++)
                {
                    ImageView image=new ImageView(this);
                    image.setLayoutParams(new LayoutParams(LayoutParams.FILL_PARENT, LayoutParams.WRAP_CONTENT));

                    /*Bitmap bitmap = BitmapFactory.decodeFile(image_list.get(i).toString().trim());
                    bitmap = Bitmap.createScaledBitmap(bitmap,500, 500, true);
                    Drawable d=loadImagefromurl(bitmap);*/
                    image.setBackgroundDrawable(image_drawable.get(i));

                    tableRow.addView(image, 200, 200);
                }
                image_table.addView(tableRow);
            }
        }
    }

    public Drawable loadImagefromurl(Bitmap icon)
    {
        Drawable d=new BitmapDrawable(icon);        
        return d;
    }

    public class GetImages extends AsyncTask<Void, Void, Void> 
    {
        public ProgressDialog progDialog=null;

        protected void onPreExecute() 
        {
            progDialog=ProgressDialog.show(context, "", "Loading...",true);
        }
        @Override
        protected Void doInBackground(Void... params) 
        {
            image_drawable.clear();
            for(int i=0; i<image_list.size(); i++)
            {
                Bitmap bitmap = BitmapFactory.decodeFile(image_list.get(i).toString().trim());
                bitmap = Bitmap.createScaledBitmap(bitmap,500, 500, true);
                Drawable d=loadImagefromurl(bitmap);

                image_drawable.add(d);
            }
            return null;
        }    

        protected void onPostExecute(Void result) 
        {
            if(progDialog.isShowing())
            {
                progDialog.dismiss();
            }
            updateImageTable();
        }
    }
} 
```

我从以下链接获得此代码：http: [//tjkannan.blogspot.in/2012/01/load-image-from-camera-or-gallery.html](http://tjkannan.blogspot.in/2012/01/load-image-from-camera-or-gallery.html)

希望这会帮助你 。

# ios - 如何处理 UISplitView 嵌套控制器中的点击事件

> ID：13247116
> 
> 赞同：0
> 
> 时间：2012-11-06T08:26:22.097
> 
> 标签：ios, mono, xamarin.ios

我是 iOS 开发的 Monotouch。我有一个用于 iPad 的 SplitView，主视图控制器是 UITabBar，里面有 UINavigation，UITableView 嵌套在里面。那是一个相当复杂的控制器链。而且我需要处理 TableView 中的行单击事件并将其返回给 UISplitView 以对 DetailView 控制器进行适当的操作。在控制器链中的每个控制器中定义一个事件并将事件从最后传输到最开始调用中间事件是否是一个好的设计？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-06T08:55:44.727

我建议保持简单。通常splitViewController是一个属性`AppDelegate`（如果没有，你可以只添加一个）。因此，您可以通过调用从应用程序中的任何位置访问 splitViewController

```
[[[[UIApplication sharedApplication] delegate] splitViewController] anyMethodYouWantToCallOnTheSplitVC]; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-14T20:25:58.807

@Tobi 走在正确的轨道上，您可以使用 AppDelegate 访问您的 AppDelegate `var myApp = UIApplication.SharedApplication.Delegate as AppDelegate;`，然后引用您的 UISplitViewController 的公共实例或从`myApp`.

# mysql - 为什么在 Joomla 3.0.1 安装 sql 脚本中使用 ENGINE=InnoDB？

> ID：13247117
> 
> 赞同：2
> 
> 时间：2012-11-06T08:26:23.560
> 
> 标签：mysql, joomla, joomla3.0

有人可以在 Joomla 中解释为什么！3.0.1 MySQL的安装sql脚本使用**ENGINE=InnoDB** !?! 有什么特别的原因吗！？？？？！？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-11-06T09:16:30.643

MySQL 数据库的两种主要类型的表存储引擎是 InnoDB 和 MyISAM。总结一下功能和性能的差异，

1.  InnoDB 较新，而 MyISAM 较旧。

2.  InnoDB 更复杂，而 MyISAM 更简单。

3.  InnoDB 在数据完整性方面更加严格，而 MyISAM 是松散的。

4.  InnoDB 实现了用于插入和更新的行级锁，而 MyISAM 实现了表级锁。

5.  InnoDB 有事务，而 MyISAM 没有。

6.  InnoDB 有外键和关系约束，而 MyISAM 没有。

7.  InnoDB 有更好的崩溃恢复，而 MyISAM 在系统崩溃时恢复数据完整性方面很差。

8.  MyISAM 有全文搜索索引，而 InnoDB 没有。

    *鉴于这些差异，InnoDB 和 MyISAM 各有其独特的优势和劣势。它们在某些情况下都比另一个更适合。*

***InnoDB 的优势***

InnoDB 应该用于优先考虑数据完整性的地方，因为它在关系约束和事务的帮助下固有地处理它们。

在写入密集型（插入、更新）表中更快，因为它利用行级锁定并且只保留对正在插入或更新的同一行的更改。

***InnoDB 的缺点***

由于 InnoDB 必须处理表之间的不同关系，数据库管理员和方案创建者必须花费更多时间来设计比 MyISAM 更复杂的数据模型。

消耗更多的系统资源，例如 RAM。事实上，许多人建议在安装 MySQL 后如果没有实质性的需要，关闭 InnoDB 引擎。

没有全文索引。

***MyISAM 的优势***

设计和创建更简单，因此更适合初学者。不用担心表之间的外部关系。

由于结构更简单，因此总体上比 InnoDB 更快，因此服务器资源的成本要低得多。

全文索引。

特别适用于读取密集型（选择）表。

***MyISAM 的缺点***

没有数据完整性（例如关系约束）检查，这是数据库管理员和应用程序开发人员的责任和开销。

不支持在银行等关键数据应用程序中必不可少的交易。

对于经常插入或更新的表，比 InnoDB 慢，因为整个表都被锁定以进行任何插入或更新。

*比较非常简单。*

InnoDB 更适合需要频繁插入和更新的数据危急情况。

另一方面，MyISAM 在不太依赖于数据完整性并且大多只是选择和显示数据的应用程序中表现更好。

[***阅读更多***](http://dev.mysql.com/doc/refman/5.5/en/innodb-storage-engine.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-12-08T20:17:58.337

考虑到他们没有使用任何外键约束这一事实，这实际上是一个非常好的问题。

由于他们自己没有使用外部约束，因此我想到了为什么他们可能使用 InnoDB 而不是 MyISAM 的几个原因是：

1.  他们有一些未来计划在某个时间点严格数据完整性。

2.  他们希望允许为 Joomla 编写扩展程序的人引用现有数据并在创建者想要的情况下进行硬约束。IE：让我们想象一个在 Joomla 系统中为用户存储笔记的组件。然后作者可以像这样创建一个表：

    ```
    CREATE TABLE IF NOT EXISTS `#__notes` (
      `id`    INT(11) UNSIGNED NOT NULL AUTO_INCREMENT,
      `note`  VARCHAR(255)     NOT NULL,
      `owner` INT(11)          NOT NULL,
      PRIMARY KEY (`id`),
      INDEX (`owner`),
      CONSTRAINT FOREIGN KEY (`owner`) REFERENCES `#__users` (`id`) ON DELETE CASCADE ON UPDATE CASCADE
    ) ENGINE=InnoDB DEFAULT CHARSET=utf8; 
    ```

    那么作者可以确定笔记的所有者确实存在，并且如果用户从系统中删除，他将不会有任何垃圾剩余，因为属于某个用户的所有笔记也会因设置而被删除如果您不想手动维护干净的数据库，则删除操作上的 CASCADE 非常方便，如果您想要引用的数据库将使用不同的引擎，即 MyISAM，则这是不可能的。

# c# - Server.MapPath 问题？

> ID：13247123
> 
> 赞同：3
> 
> 时间：2012-11-06T08:27:04.450
> 
> 标签：c#, asp.net, .net, .net-4.0, server.mappath

所以我正在阅读一本关于 asp.net 安全性的书。其中一节是：如何防止目录遍历文件名（被黑的文件名）。

所以代码行是：

`string fullPath = Server.MapPath(System.IO.Path.Combine(@"d:\inetpub\inbound\",filename));`

但后来我注意到合并的结果将是：

```
d:\inetpub\inbound\myfile.txt 
```

但我记得参数类型应该是**虚拟**路径而不是文件系统路径！

![在此处输入图像描述](../Images/e2fe3adbe035ee794c9d2250657a3811.png)

`d:\inetpub\inbound\myfile.txt`不是虚拟路径！

我错过了什么？

![在此处输入图像描述](../Images/f5117ce0053ccc087820ae4319d5e827.png)

ps这是书：（wrox）

![在此处输入图像描述](../Images/02a6453899d284a7a6940f24b68dc4ee.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-06T08:40:11.187

代码示例是错误的。

的作用`Server.MapPath`确实是将虚拟路径转换为物理路径。如果您已经有物理路径，则无需`Server.MapPath`.

该代码可能会抛出一个带有消息的异常：

> 'd:\inetpub\inbound\myfile.txt' 是物理路径，但应该是虚拟路径。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-06T08:30:22.557

您必须使用`Server.MapPath`将*虚拟*路径（即网站内部的路径）转换为*物理*路径（例如`D:\InetPub\`...）。

所以你可以这样做：

```
var physicalPath = Server.MapPath("~/Incoming/Receivedfile.txt"); 
```

然后您可以使用`physicalPath`实际访问该文件。

顺便说一句，上面文件名中的波浪号代表运行代码的网站的根目录。

# c++ - c++ new/delete 和 char *

> ID：13247126
> 
> 赞同：21
> 
> 时间：2012-11-06T08:27:12.223
> 
> 标签：c++, char, new-operator

谁能帮助我，为什么我在尝试释放分配的内存时收到错误消息：检测到堆损坏。CTR 检测到应用程序在堆缓冲区结束后写入内存。

```
char *ff (char *s){
    char *s1 = new char [strlen(s)];
    strcpy(s1, s);
    return s1;
}

int _tmain(int argc, _TCHAR* argv[])
{
    char *s = new char [5];

    strcpy(s, "hello");
    char *s2 = ff(s);

    delete []s;     // This works normal
    delete []s2;    // But I get an error on that line
    return 0;
} 
```

* * *

## 回答 #1

> 赞同：50
> 
> 时间：2012-11-06T08:29:50.293

```
char *s = new char [5];
strcpy(s, "hello"); 
```

导致**未定义的行为（UB）**。
您正在写超出分配内存的范围。您为字符分配了足够的内存，`5`但您的字符串包含`6`字符，包括`\0`.

一旦你的程序导致了这个 UB，所有的赌注都结束了，任何行为都是可能的。

你需要：

```
char *s = new char [strlen("hello") + 1]; 
```

事实上，**理想的解决方案是使用`std::string`而不是`char *`**. 这些正是`std::string`避免的错误。在您的示例中并没有真正需要使用`char *`而不是。 与： `std::string`
`std::string`

*   你不需要`new`任何东西
*   你不需要`delete`任何东西&
*   你可以用 来做任何事情`std::string`，你可以用`char *`.

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2012-11-06T08:29:32.563

`new char [strlen(s)];`不计算结束`\0`字符，因此您的缓冲区太短了一个字符。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2012-11-06T08:29:41.627

`strcpy`包括空终止符；`strlen`才不是。写：

```
char *s1 = new char [strlen(s) + 1]; 
```

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2012-11-06T08:30:20.443

从 man [strcpy(3)](http://linux.die.net/man/3/strcpy)：

> strcpy() 函数将 src 指向的字符串， **包括终止的空字节 ('\0')**复制到 dest 指向的缓冲区。

所以你需要为字符串和字节保留`6`字节`5``1``NULL`

```
char *s = new char [6];
strcpy(s, "hello"); 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2012-11-06T08:43:10.860

到目前为止，所有答案都解决了第一个或第二个分配问题。总而言之，您必须进行*两项更改：*

```
char *s1 = new char [strlen(s) + 1];
...
char *s = new char [5 + 1]; 
```

在这两种情况下，您必须为字符串分配足够的空间，并**为终止的 '\0' 分配一个字节**。

正如其他人已经指出的那样，使用 c++ 更容易和更安全地使用`std::string`. 不必大惊小怪地分配和释放内存或注意 '\0' 字节：

```
std::string ff (const std::string &s){
    std::string s1(s);
    // do something else with s1
    return s1;
}

int main(int argc, char* argv[])
{
    std::string s("hello");
    std::string s2 = ff(s);
    return 0;
} 
```

如果它只是复制字符串：

```
std::string s("hello");
std::string s2(s); 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-11-06T08:30:17.293

您需要指定`char *s1 = new char [strlen(s) + 1];`为`'\0'`终止字符串的 腾出空间。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2012-11-06T08:32:55.150

您已经损坏了 s2 指针

```
strcpy(s, "hello"); 
```

因为 s 的大小为 5，而您错过了 strcpy 包含字符串终止符。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2012-11-06T08:29:50.800

您的初始字符串`s`只有五个字符长，因此不能以空值结尾。`"hello"`将通过`strcpy`包含空终止符进行复制，但您将超出缓冲区。`strlen`需要它以空值终止，因此如果空值不存在，您将遇到问题。尝试更改此行：

字符 *s = 新字符 [6];

更好的是，更喜欢`std::string`C 风格的字符串函数——它们同样高效，更安全，更易于使用。此外，尽量避免`new`，`delete`除非你真的必须使用它们。你遇到的问题很常见，很容易避免。

# bash - 如何从bash中的变量构造列表？

> ID：13247131
> 
> 赞同：1
> 
> 时间：2012-11-06T08:27:33.310
> 
> 标签：bash, unix

> **可能重复：**
> [如何在 bash 中迭代一系列数字？](https://stackoverflow.com/questions/169511/how-do-i-iterate-over-a-range-of-numbers-in-bash)

我正在尝试打印“Hello World！” 通过下面的代码 10 次，但它只打印一次。我在哪里缺少正确的语法？

```
RUNS=10

for RUN in {1..$RUNS}
do
    echo "Hello World!"
done 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-06T08:33:20.470

[这个问题包含您需要的所有答案](https://stackoverflow.com/questions/169511/how-do-i-iterate-over-a-range-of-numbers-in-bash)

简而言之，我建议您使用：

```
RUNS=10
for RUN in $(seq 1 $RUNS)
do
    echo "Hello World!"
done 
```

因为它也更有可能在其他 shell 上工作。

如果要避免子外壳的开销，可以使用：

```
RUNS=10
i=0;
while [ $i -lt $RUNS ]
do
    echo "Hello World!"
    i=$(($i+1))
done 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-06T08:38:22.560

你想做一个大括号扩展，但 bash 不做双扩展（它需要 expand `$RUNS`）。您可以通过以下方式强制双扩展

```
for RUN in $(eval echo {1..$RUNS})
do 
    echo "Hello World!"
done 
```

但我建议你避免像瘟疫一样的混乱，然后做

```
for RUN in $(seq 1 $RUNS) 
do 
    echo "Hello World!"
done 
```

或者

```
for ((RUN=1; RUN<RUNS; RUN++))
do 
    echo "Hello World!"
done 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-06T08:35:14.577

*{A..B}*语法似乎没有替换变量

```
for ((i=0; i < $RUNS; ++i)); do echo "hello world"; done 
```

# c# - 将 JSON 字符串转换为 XML 字符串

> ID：13247132
> 
> 赞同：1
> 
> 时间：2012-11-06T08:27:38.897
> 
> 标签：c#, asp.net, json, xml-serialization

我有一个 JSON 字符串：

```
var jsonString = JSON.stringify(dataObject);
document.getElementById("hdnChromedata").value = jsonString; 
```

**==> hdnChromedata = JSON 字符串**

但是在不同的代码部分中，我将 XML 序列化字符串存储到 "hdnChromedata" .as ：

```
XmlSerializer xmlSerializer = new XmlSerializer(vinDescription.GetType());
StringWriter textWriter = new StringWriter();

xmlSerializer.Serialize(textWriter, vinDescription);
this.hdnChromedata.Value = textWriter.ToString(); 
```

**==> hdnChromedata = XML 字符串**

并且在检索值时，我正在反序列化这样的字符串：

```
XmlDocument doc = new XmlDocument();
doc.LoadXml(this.hdnChromedata.Value);
XmlNodeReader reader = new XmlNodeReader(doc.DocumentElement);

XmlSerializer ser = new XmlSerializer(decodedInfo.GetType());
object textObj = ser.Deserialize(reader);
vinDescription = (AutoExact.AEVINDecoderService.VINDescription)textObj; 
```

***当 hdnChromedata 是 JSON 字符串时，此处的 doc.LoadXml(this.hdnChromedata.Value) 行会引发错误。***

我的问题是，如何将此 JSON 字符串转换为 XML 字符串？

或者还有其他方法可以解决这个问题吗？

**基本上我需要一种在 ASP.NET 1.1 中将 JSON 字符串转换为 XML 字符串的方法**

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-06T08:33:01.767

您可以为此使用 Json.NET 库`JsonConvert`。请参阅[http://james.newtonking.com/projects/json/help/index.html?topic=html/ConvertingJSONandXML.htm](http://james.newtonking.com/projects/json/help/index.html?topic=html/ConvertingJSONandXML.htm)中的详细信息。

Json.NET 是一个用于 .NET 的开源 JSON 处理库，它是最好的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-06T08:31:38.960

无需转换，只需在反序列化之前测试字符串的第一个字符。如果字符串以 开头`<`，则将其视为 XML，如果以 开头`{`，则将其视为 JSON。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-11-06T08:33:16.807

使用 json-lib，一个为任何 Java 程序添加 JSON 支持的库。json-lib 提供了一个 XMLSerializer，可用于从 JSON 对象输出 XML。

[https://discursive.atlassian.net/wiki/display/CJCOOK/Converting+JSON+to+XML](https://discursive.atlassian.net/wiki/display/CJCOOK/Converting+JSON+to+XML)

# azure - 按分区和行键对列表查询 Azure 表存储

> ID：13247137
> 
> 赞同：1
> 
> 时间：2012-11-06T08:28:00.880
> 
> 标签：azure, azure-table-storage

我有一个来自同一个表的已知分区和行键对的列表（例如 P1R1、P2R2、P3R3、P-PartitionKey、R-Row 键），任何人都知道如何从 Azure 表存储中查询以将这 3 个实体合二为一要求？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-06T08:55:49.543

我认为除了在 Where/Filter 子句中明确说明之外没有其他选择。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-11-07T13:11:31.667

你可以这样做，但你不想这样做。这将导致表扫描并且非常慢。分别触发每个请求会更好地为您服务。

如果您一心只想使用一个查询，请在此处发表评论，我会为您提供代码。我现在在我的 iPad 上，所以我手边没有。

# html - html {{^Foo}} ^ 选择器标签

> ID：13247138
> 
> 赞同：1
> 
> 时间：2012-11-06T08:28:02.757
> 
> 标签：html, syntax, template-engine

我一直在我正在查看的 html 代码中看到这一点。显然它的 Jquery 标签添加了 html 模板。

```
{{#Foo}} 
<div> bla bla </div> 
```

我猜是Foo类？？

和

```
{{^Foo}}
<div> bla bla </div> 
```

^ 是干什么用的？？

现在我知道它做了什么，它将 HTML 元素存储在 variable 中`Foo`，然后这些 HTML 元素稍后会被添加。但我不知道它是如何工作的，也不知道为什么它的 # 和 ^ 或更多关于这里发生的事情......

感谢您的任何帮助。

我使用 html + javascript 代码。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-06T08:38:47.997

它实际上不是 jQuery 模板（如您所建议的），而是这里使用的[Mustache](http://mustache.github.com/mustache.5.html)。这种语法...

```
{{#Foo}}
...something
{{/Foo}}
{{^Foo}}
...something
{{/Foo}} 
```

... 用于涵盖这两种情况：

*   当`Foo`集合不为空时，它将使用`{{#Foo}}`普通部分的内部块进行模板化：
*   当`Foo`collection 为空时，将使用所谓的`inverted section`(set within `{{^Foo}}`) 的模板来代替：

文档中的示例：

```
{{#repo}}
  <b>{{name}}</b>
{{/repo}}
{{^repo}}
  No repos :(
{{/repo}} 
```

它实际上非常有用：我们经常需要为“无项目”案例提供单独的模板。通常它是用块之类的东西来完成的`{{#if... }} ... {{#else}}`，但这会在模板中注入逻辑。Mustache 提供了一种替代方法——我可以说非常优雅——解决这个问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-06T08:34:45.910

我的朋友..您首先要了解更多关于**把手**的知识。

检查这些链接：

[http://handlebarsjs.com/block_helpers.html](http://handlebarsjs.com/block_helpers.html)

[http://blog.teamtreehouse.com/handlebars-js-part-2-partials-and-helpers](http://blog.teamtreehouse.com/handlebars-js-part-2-partials-and-helpers)

[http://www.raymondcamden.com/index.cfm/2012/4/19/Demo-of-Handlebars-and-why-you-should-consider-a-templating-engine](http://www.raymondcamden.com/index.cfm/2012/4/19/Demo-of-Handlebars-and-why-you-should-consider-a-templating-engine)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-06T08:36:19.533

这看起来不像 jQuery 语法。

然而，这确实看起来像大多数模板引擎的语法，例如[underscore.js](http://underscorejs.org/)、[handlebars](http://handlebarsjs.com/)或[twig](http://twig.sensiolabs.org/)。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-06T08:36:57.303

这既不是 HTML 也不是 jQuery。模板引擎或其他脚本使用它来根据他们能够在文档的源代码中识别的代码做一些工作（例如，在您的情况下以双花括号开头和结尾）。

# iphone - 可达性在模拟器上工作但在设备上不工作

> ID：13247139
> 
> 赞同：1
> 
> 时间：2012-11-06T08:28:12.467
> 
> 标签：iphone, ios, ipad, reachability

在我的项目中，我使用的是 Apple 提供的可达性类。当没有互联网连接时，我会显示一条警报消息。一切正常，当我在模拟器上测试它时，但在 iPad 上运行它时，没有互联网时不会显示警报消息。

我在 iOS 5.0 上运行代码。

任何帮助，将不胜感激。

编辑：

```
-(BOOL)isInternetConnectionPresent{

Reachability *objReachability = [Reachability reachabilityForInternetConnection];    
NetworkStatus internetStatus = [objReachability currentReachabilityStatus];

if(internetStatus != NotReachable)
{
    return YES;
}

   return NO;
} 
```

更新：

使用 NSLog 进行调试。即使没有 SIM 卡，WWAN 似乎也有问题。重新启动 iPad 并再次关闭和打开 Wi Fi。现在它工作正常。谢谢你们的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-06T08:44:04.960

您必须检查所有**NetworkStatus**并再次交叉检查设备**Wifi 连接状态**

**例子：**

```
// to check if, wifi connected properly in current device.
- (BOOL)networkCheck {

    Reachability *wifiReach = [Reachability reachabilityForInternetConnection];
    NetworkStatus netStatus = [wifiReach currentReachabilityStatus];

    switch (netStatus)
    {
        case NotReachable:
        {
            NSLog(@"NETWORKCHECK: Not Connected");          
            return NO;
            break;
        }
        case ReachableViaWWAN:
        {
            NSLog(@"NETWORKCHECK: Connected Via WWAN");
            return NO;
            break;
        }
        case ReachableViaWiFi:
        {
            NSLog(@"NETWORKCHECK: Connected Via WiFi");
            return YES;
            break;
        } 
    }
    return false;

} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-06T10:11:45.940

在我的情况下，以下代码片段与 iOS 5 完美配合。在这里，我正在检查 WIFI 的互联网连接。

```
- (NSString *)stringFromStatus:(NetworkStatus ) status {
NSString *string;
switch(status) {
    case NotReachable:
        string = @"Not Reachable";
        break;
    case ReachableViaWiFi:
        string = @"Reachable via WiFi";
        break;
    case ReachableViaWWAN:
        string = @"Reachable via WWAN";
        break;
    default:
        string = @"Unknown";
        break;
}
return string; 
```

}

------------------------------------ 现在可以使用以下代码行进行检查。

```
 Reachability *reach =[Reachability reachabilityForLocalWiFi] ;
NetworkStatus status = [reach currentReachabilityStatus];
NSLog(@"%@", [self stringFromStatus: status]);

if ([[self stringFromStatus: status] isEqualToString: @"Not Reachable"]) 
{
    UIAlertView *alert = [[UIAlertView alloc]
                          initWithTitle:@"Connection Failure !"
                          message:@"Your Device is not Connected to any active WIFI Connection."
                          delegate:self
                          cancelButtonTitle:@"OK"
                          otherButtonTitles:nil];
    [alert show];
}
else
{ //connected to internet. 
```

}

# java - AnimationDrawable.start() 是否在新线程中运行？

> ID：13247142
> 
> 赞同：0
> 
> 时间：2012-11-06T08:28:22.537
> 
> 标签：java, android, multithreading, runnable

我阅读了文档[http://developer.android.com/reference/android/graphics/drawable/AnimationDrawable.html](http://developer.android.com/reference/android/graphics/drawable/AnimationDrawable.html)

它扩展了看起来像一种 UI 的 DrawableContainer，它实现了 Runnable，所以它应该在一个新线程中运行（应该是吧？因为它实现了 Runnable）。那么在这种情况下，我们是否应该遵循“只在 UI 线程中更新 UI 组件”的规则呢？

我测试了一个在 AnimationDrawable.start() 之后执行繁重循环的程序，并且程序崩溃（有著名的停止响应错误）。现在我很困惑，AnimationDrawable.start() 是否在新线程中运行？

编辑：

```
AnimationDrawable.start();

for (int i = 0 ; i< 10000000 ; i ++){
    System.out.println(i);
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-06T08:34:05.737

如果您查看源代码：http: [//developer.android.com/reference/android/graphics/drawable/AnimationDrawable.html](http://developer.android.com/reference/android/graphics/drawable/AnimationDrawable.html)

此类中没有启动新线程。实际上，这个组件每次在屏幕上绘制时都会创建一个新的动画帧。而已。

我不知道您所说的“在 AnimationDrawable.start() 之后执行繁重循环的程序”到底是什么意思，但我很清楚 AnimationDrawable 执行的任何操作都必须快速，基本上无非是图像交换必须在这里进行。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-06T09:02:44.693

现在我知道它为什么实现 Runnable 了：

```
new Thread(){
   public void run(){
     AnimationDrawable.start();
   }
}.start();

for (int i = 0 ; i< 10000000 ; i ++){
   System.out.println(i);
} 
```

我想在我分派`start()`到新线程之后，它会在一个新线程中运行并且不会导致任何“无响应错误”，但实际上它仍然崩溃。现在我知道它实现了 Runnable，因为 Android 将它发送回 UI 线程来执行。

# ruby-on-rails - 从 csv 文件导入数据时无法批量分配受保护的属性

> ID：13247149
> 
> 赞同：2
> 
> 时间：2012-11-06T08:28:52.760
> 
> 标签：ruby-on-rails, ruby-on-rails-3, csv, import

我有一个这样的导入数据表格：

```
<%= form_tag({ controller: 'courses', action: :import }, multipart: true) do %> 
  <%= label_tag 'file', 'Import data' %>
  <%= file_field_tag 'file' %>
  <%= submit_tag "Import", name: nil, class: 'btn' %>
<% end %> 
```

这是我的导入操作：

```
def import
  require 'csv'

  csv_text = File.read(params[:file].tempfile.to_path.to_s)
  csv = CSV.parse(csv_text, headers: true )
  csv.each do |row|
    row = row.to_hash.with_indifferent_access
    Course.create(row.to_hash.symbolize_keys)
  end
  flash[:success] = "Successfully import data."
  redirect_to courses_url
end 
```

但是当我在浏览器中选择一个文件并按下按钮`Import`时，我得到了错误：

```
ActiveModel::MassAssignmentSecurity::Error in CoursesController#import
Can't mass-assign protected attributes: Name, Code 
```

在我的`Course`模型中，`name`并且`code`已经是 attr_accessible：

```
class Course < ActiveRecord::Base
  attr_accessible :code, :name
end 
```

我的代码有什么问题？

**更新**
这是我的 csv 文件：

```
name, code
ERP System, HT555DV01
Data Mining, HT459DV01 
```

**创建数据的新代码**

```
csv.each do |row|
  Course.create!(name: row[0], code: row[1])
end 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-06T08:38:13.657

尝试这个

```
csv.each do |row|
  row = row.to_hash.with_indifferent_access
  Course.create(row.to_hash.symbolize_keys)
end 
```

替换为

```
 csv.each do |row|
    Course.create(row.to_hash)
  end 
```

**更新**

```
csv_file = File.read(params[:file].tempfile.to_path.to_s)
csv = CSV.parse(csv_file, :headers => true) 
csv.each do |row|
   Course.create!(:name => row[0], :code => row[1])    
end 
```

**更新 2**

```
csv_file = params[:file].read
CSV.parse(csv_file) do |row|
   course = Course.create(row)
   course.save
end 
```

来源 => [http://www.funonrails.com/2012/01/csv-file-importexport-in-rails-3.html](http://www.funonrails.com/2012/01/csv-file-importexport-in-rails-3.html) [http://erikonrails.snowedin.net/?p=212](http://erikonrails.snowedin.net/?p=212)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-06T08:47:40.683

尝试`Course.create(row.to_hash.symbolize_keys, :without_protection => true)`甚至将其与 Dipak 的建议结合起来。

或者，我更喜欢`Course.create!(name: row['name'], code: row['code'])`.

# windows-phone - Windows Phone 8 中的 FM 收音机发生了什么变化？

> ID：13247153
> 
> 赞同：4
> 
> 时间：2012-11-06T08:29:13.017
> 
> 标签：windows-phone, windows-phone-8

FM 收音机是 Windows Phone 7 中的强制性硬件要求，但它不存在于任何当前的 Windows Phone 8 设备上。
为什么 WP8 的 Music Hub 中没有 FM 收音机？我们至少可以使用[FMRadio API](http://msdn.microsoft.com/en-us/library/microsoft.devices.radio.fmradio%28v=vs.92%29.aspx)吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-11-06T08:29:13.017

根据 MSDN： http:
[//msdn.microsoft.com/en-us/library/windowsphone/develop/jj206947 (v=vs.105).aspx](http://msdn.microsoft.com/en-us/library/windowsphone/develop/jj206947(v=vs.105).aspx)

> Windows Phone 8 不支持 FM 收音机功能。如果您在 Windows Phone 8 应用程序中使用 FM 收音机 API，则会发生 RadioDisabledException。

同样从我听到的：

> ... FM 收音机功能原计划包括在内，但由于稳定性与时间限制而从该版本中删除。
> （......我不知道是否有计划在未来的更新中重新启用此功能。）

您可以使用此测试安全地确定 FMRadio 是否可以在当前手机上使用：

```
/// <summary>
/// Flag is radio device is available in this phone.
/// </summary>
public bool IsRadioAvailable
{
    get
    {
        if (!radioInitialized)
        {
            radioInitialized = true;
            try
            {
                radio = FMRadio.Instance;
                isRadioAvailable = true;
            }
            catch (RadioDisabledException e)
            {
                isRadioAvailable = false;
            }
        }
        return isRadioAvailable;
    }
}
private bool radioInitialized;
private bool isRadioAvailable;

private FMRadio radio; 
```

**更新：**
[根据各种消息来源，](http://www.theverge.com/2013/5/14/4327026/nokia-lumia-windows-phone-update-fm-radio-july) FM 收音机将在即将于 2013 年夏季到来的 Windows Phone 8 更新中启用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-21T09:18:48.347

我读到 Lumia 920 有 FMRX，只需要“利用”。不确定他们是否有任何帮助

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-09-12T15:15:53.640

[FM Radio](http://www.windowsphone.com/en-us/how-to/wp8/basics/windows-phone-8-update-history)在支持的硬件上返回 Windows Phone 8 'GDR2' (8.0.10327.77/78)。

目前尚不清楚 API 支持是否也返回以及它的行为方式：

> ### 警告：
> 
> FM 收音机仅在面向 Windows Phone OS 7.1 的应用程序中受支持。如果您在面向 Windows Phone OS 8.0 或更高版本的应用程序中使用 FMRadio 类，则 RadioDisabledException 指示 FM 收音机功能不可用。在具有 8.0.10322 或更高版本的 Windows Phone 8 设备上，如果您使用 FMRadio API，则可能不会发生运行时异常。但是，面向 Windows Phone OS 8.0 的应用程序不支持 FMRadio API。

*   [http://msdn.microsoft.com/en-us/library/windowsphone/develop/microsoft.devices.radio.fmradio.frequency(v=vs.105).aspx](http://msdn.microsoft.com/en-us/library/windowsphone/develop/microsoft.devices.radio.fmradio.frequency(v=vs.105).aspx)

换句话说，没有用于控制收音机的 Windows Phone 运行时 API。

我刚刚从商店试用了一个 FM Radio 应用程序，它确实有效。

# graph - 求解最短哈密顿路径的扩展

> ID：13247155
> 
> 赞同：10
> 
> 时间：2012-11-06T08:29:28.080
> 
> 标签：graph, pseudocode, shortest-path, np-complete

我正在考虑对最短哈密顿路径（SHP）问题的扩展，但我找不到解决它的方法。我知道它是 NP 完全的，但我想我会在这里征求意见，因为我不想简单地暴力破解这个问题。

扩展相当简单：给定一个具有*n*个顶点的无向、完整、加权图，找到末端顶点为*v*和*u*的最短哈密顿路径。

因此，暴力破解仍然需要 O( *n* !) 时间，因为剩余的*n* -2 个顶点可以在 ( *n* -2) 中访问！方法。我试图找到一种方法来*稍微*更快地解决这个问题。到目前为止，我为找到一种有益的方式解决这个问题的方法所做的努力都没有结果。

有人知道如何利用终端顶点的知识吗？最好与一些伪代码一起解释。需要找到最佳的解决方案。

我想这可以通过整数规划来解决，因为端节点的知识相当有限，并且很容易避免循环，但它不会真正利用问题的组成。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-06T11:14:29.107

如果你想找到连接所有节点的最短路径，那么你应该看看[旅行商](http://en.wikipedia.org/wiki/Travelling_salesman_problem)算法。我不完全明白您为什么将其视为 HSP。我能想到的唯一原因是你想指定你的起始城市，但是通过稍微改变你的图表应该很容易解决这个问题（如果你需要我可以发布它）。

**编辑：添加如何调整图表**

添加 1 个节点（称为 E）并仅将其连接到您的起始节点和结束节点。TSP 将通过连接所有节点来计算问题的解决方案。由于 E 只能通过从 start 到 E 然后到 end 到达，因此解决方案（一个循环是）将包含 start - E - end。然后你从 E 中删除 2 条边，你就有了最优解。在 TSP 内，从开始到结束的路径将是最优的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-06T09:03:07.363

您可以使用元启发式算法。它们有很多种（本地搜索、建设性搜索等）。其中之一可能基于：

对于属于顶点集合 X 的每个 x：
- 找到最接近 x C 的顶点集合。
- 过滤集合 C 以便将其中一个包含在路径 P 中。
重复直到 X 的所有顶点都包含在路径 P 中路径 P.
结束。

# c# - 自上次运行同一方法以来获取所有最新更新的方法

> ID：13247160
> 
> 赞同：0
> 
> 时间：2012-11-06T08:29:49.627
> 
> 标签：c#, list

我不知道如何写标题，但无论如何。我有一种方法可以在 10 到 60 秒内随机向我发送（电子邮件）对象。现在的问题是我需要创建一个名为 getNewMessages 的新方法，该方法返回一个电子邮件列表，该列表从上次调用该方法时是新的。

因此，假设我第一次调用此方法时它会收到所有新电子邮件（这部分不是问题），但第二次调用它时，旧电子邮件应从列表中删除，新电子邮件应填写列表，自从我们上次调用该方法以来。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-06T08:37:15.400

制作一个封闭实体，以便检索最后一个日期，然后使用 Linq 查询仅获取新日期

样本：

```
var result = list.Where(v=>v.LastUpdate > _lastUpdate);
_lastUpdate = DateTime.Now;
result.ToList().ForEach(v=>v.LastUpdate = _lastUpdate); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-06T08:51:01.917

你的问题很模糊，所以很难给出具体的答案。但也许一些想法可能会对你有所帮助。

您收到的每封邮件都会获得某种唯一的 ID。在您的情况下，此 id 可以从发件人和收到邮件的时间戳派生。也许你应该为你的实现编写一个[`IEqualityComparer`](http://msdn.microsoft.com/en-us/library/ms132151.aspx)并考虑这个[`GetHashCode`算法](https://stackoverflow.com/questions/263400/what-is-the-best-algorithm-for-an-overridden-system-object-gethashcode)。然后，您只需将所有邮件放入 a 中[`new HashSet<Email>(MyEqualityComparer)`](http://msdn.microsoft.com/en-us/library/bb359438.aspx)，当您的方法被调用时，您可以简单地检查您是否已经计算了此消息。

如果您不喜欢将所有邮件存储在其中`HashSet<T>`（也许是为了改善内存占用），您可以调用`MyMailComparer.GetHashCode(email)`并将所有结果放入 a`HashSet<int>`中，然后丢弃邮件。但请注意，这可能会丢弃一条新消息，因为两条不同的消息可能会产生相同的哈希码，因此需要该`Equals()`方法在这种情况下检查两条消息是否真的相等，但这会使它有必要将邮件保存在内存中。

# objective-c - iOS将默认日期设置为日期选择器？

> ID：13247165
> 
> 赞同：1
> 
> 时间：2012-11-06T08:30:19.793
> 
> 标签：objective-c, ios, uidatepicker

我有一个与文本字段关联的日期选择器。文本字段的值类似于**11 月 22 日星期四**（从服务器调用收到的字符串）。现在我希望当我点击文本字段时，日期选择器应该播种显示在文本字段中的默认日期。我想我必须打电话`[datePicker setDate:date animated:YES];`，但问题是如何将**11 月 22 日星期四**的字符串转换为`NSDate`？提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-06T08:45:59.233

我假设你想在你的日期当前年份：

```
NSDateFormatter *dateFormat = [[NSDateFormatter alloc] init];
[dateFormat setDateFormat:@"yyyy"];
NSString *yeardate = [dateFormat stringFromDate:[NSDate date]];

NSString *string = @"Thursday, November 22nd";
if ( [string length] > 0)
  string = [string substringToIndex:[string length] - 2];

NSString *finalstr = [NSString stringWithFormat:@"%@ %@",string,yeardate];
[dateFormat setDateFormat:@"EEEE,MMMM dd yyyy"];

NSDate *date = [dateFormat dateFromString:finalstr];
NSLog(@"%@",date); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-06T09:07:22.993

您可以按照下面的代码片段

```
NSDateFormatter *formatter = [[NSDateFormatter alloc] init];
[formatter setDateFormat:@"EEEE MMMM d, yyyy"];
NSString *dateStr;
NSDate *date;

date  = [NSDate date];
dateStr= [formatter stringFromDate:date];
NSLog(@"%@", dateStr); // -> Tuesday November 6, 2012

dateStr= @"Tuesday November 6, 2012";
date = [formatter dateFromString:dateStr];
 NSLog(@"%@",date); // -> 2012-11-05 18:15:00 +0000 
```

# java - 如何在 Eclipse 中将常量重构为枚举？

> ID：13247168
> 
> 赞同：11
> 
> 时间：2012-11-06T08:30:23.090
> 
> 标签：java, eclipse, refactoring

如何使用 Eclipse 将 Java 常量重构为枚举？

我在 Eclipse 中没有发现内置功能： [http ://help.eclipse.org/juno/index.jsp?topic=%2Forg.eclipse.jdt.doc.user%2Freference%2Fref-menu-refactor.htm](http://help.eclipse.org/juno/index.jsp?topic=%2Forg.eclipse.jdt.doc.user%2Freference%2Fref-menu-refactor.htm)

我找到了一个插件： [http](http://code.google.com/p/constants-to-enum-eclipse-plugin/) ://code.google.com/p/constants-to-enum-eclipse-plugin/ 。我想知道插件是要走的路还是有人使用更好的方法。

我总是可以自己创建一个枚举类并剪切和粘贴 2012 年乏味的常量。请不要将我指向另一个 IDE，我太老了，也改变了坏习惯；-)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2014-12-12T11:50:02.750

这里有一组自动和手动的步骤来进行重构。

步骤 1 在常量上封装字段

步骤 2 （可选）重命名常量。如果您想重用名称，请执行此操作。

第 3 步（手动）使用常量的值创建枚举。为枚举提供一个返回常量的 getValue 方法。

第 4 步（手动）将 getter 中的返回值替换为枚举中的 getValue。

步骤 5 内联 getter。选择“所有引用”和“删除方法声明”。

第 6 步内联常量。选择“所有引用”和“删除常量声明”。

如果你愿意，你可以在 6 之后停止，但要使用枚举的力量还有更多工作要做。

步骤 7 对于使用 enum.getValue() 作为参数的每个方法，将传递的常量替换为枚举。

步骤 7a 更改方法签名以将枚举添加为参数。

步骤 7b（手动）将枚举实例作为新参数与 getValue 调用一起传递。确保找到所有实例，否则以后会有问题。

步骤 7c（手动）在该方法中，使用新的枚举参数而不是常量。如果您在步骤 7b 中错过了一个电话，您的测试将在此处失败。

步骤 7d 更改方法签名以删除旧常量。

第 8 步（手动）对于布尔逻辑中 enum.getValue() 的每次使用，确定您是否可以使用 enum 代替。

步骤 9 如果不再使用 getValue 方法，可以将其删除。

步骤 9a（手动）删除未使用的 getValue 方法

步骤 9b（手动）删除构造函数中的字段和赋值。

步骤 9c 更改方法签名以从枚举构造函数中删除值。

步骤 9d（手动）如果没有其他参数，删除枚举构造函数。

* * *

例如：

```
public class Initial {
public static final String CONSTANT1 = "value1";
public static final String CONSTANT2 = "value2";

public void method(String aConstant)
{
    if(aConstant.equals(CONSTANT2))
    {
        //do something
    }
}

public void anotherMethod()
{
    method(CONSTANT1);
}

} 
```

第1步

```
private static final String CONSTANT1 = "value1";
private static final String CONSTANT2 = "value2";

public void method(String aConstant)
{
    if(aConstant.equals(getConstant2()))
    {
        //do something
    }
}

public void anotherMethod()
{
    method(getConstant1());
}

public static String getConstant1() {
    return CONSTANT1;
}

public static String getConstant2() {
    return CONSTANT2;
} 
```

步骤 2 重命名常量

```
private static final String _CONSTANT1 = "value1";
private static final String _CONSTANT2 = "value2";
...
public static String getConstant1() {
    return _CONSTANT1;
}

public static String getConstant2() {
    return _CONSTANT2;
} 
```

步骤 3 创建枚举

```
 public static enum AnEnum {
    CONSTANT1(_CONSTANT1), CONSTANT2(_CONSTANT2);

    private final String value;

    AnEnum(String aValue)
    {
        value = aValue;
    }

    public String getValue()
    {
        return value;
    }
} 
```

步骤 4 替换常量 getter 中的返回值

```
 public static String getConstant1() {
    return AnEnum.CONSTANT1.getValue();
}

public static String getConstant2() {
    return AnEnum.CONSTANT2.getValue();
} 
```

步骤 5 内联常量 getter

```
public void method(String aConstant)
{
    if(aConstant.equals(AnEnum.CONSTANT2.getValue()))
    {
        //do something
    }
}

public void anotherMethod()
{
    method(AnEnum.CONSTANT1.getValue());
} 
```

第 6 步内联常量

```
 public static enum AnEnum {
    CONSTANT1("value1"), CONSTANT2("value2"); 
```

步骤 7a 更改方法签名以添加枚举作为参数。

```
 public void method(String aConstant, AnEnum theEnum)
    ....
    public void anotherMethod()
{
    method(AnEnum.CONSTANT1.getValue(), null);
} 
```

步骤 7b 将枚举实例作为新参数与 getValue 调用一起传递

```
 public void anotherMethod()
{
    method(AnEnum.CONSTANT1.getValue(), AnEnum.CONSTANT1);
} 
```

步骤 7c 使用新的枚举参数而不是旧的传递值。

```
 if(theEnum.getValue().equals(AnEnum.CONSTANT2.getValue()))
    { 
```

步骤 7d 更改方法签名以删除旧常量

```
public void method(AnEnum theEnum)
....

public void anotherMethod()
{
    method(AnEnum.CONSTANT1);
} 
```

第 8 步对于布尔逻辑中 enum.getValue() 的每次使用，确定您是否可以改用枚举。

```
 if(theEnum.equals(AnEnum.CONSTANT2))
    {
        //do something
    } 
```

步骤 9a 删除未使用的 getValue 方法 步骤 9b（手动）删除构造函数中的字段和赋值。步骤 9c 更改方法签名以从枚举构造函数中删除值。步骤 9d（手动）如果没有其他参数，删除枚举构造函数。

```
 public static enum AnEnum {
    CONSTANT1, CONSTANT2;
} 
```

所以最后代码看起来像这样：

```
public class Step9d {

public static enum AnEnum {
    CONSTANT1, CONSTANT2;
}

public void method(AnEnum theEnum)
{
    if(theEnum.equals(AnEnum.CONSTANT2))
    {
        //do something
    }
}

public void anotherMethod()
{
    method(AnEnum.CONSTANT1);
}

} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-06T11:26:16.207

重构永远不会改变“外部行为”！

例如：

```
public enum Test {
    NAME1("abc");

    Test(String name) {}

    public static final String _NAME1="abc";
    public static void main(String[] args) {
        String k = Test._NAME1;
        String m = Test.NAME1;
    }
} 
```

如果重构`_NAME1`为`NAME1`(enum) ，则代码在`m`. 重构永远不会成功！

# jquery - 多个 jQuery 包括导致fancybox 崩溃？

> ID：13247169
> 
> 赞同：0
> 
> 时间：2012-11-06T08:30:24.063
> 
> 标签：jquery, wordpress, include, fancybox, multiple-instances

我不确定这里发生了什么，我有点困惑。

这是我目前正在处理的页面：http: [//tinyurl.com/a8yuzdt](http://tinyurl.com/a8yuzdt)

当您转到该页面时，一切正常，对吗？所有脚本运行良好！除了fancybox jquery 插件，它给了我错误：

```
Uncaught TypeError: Object [object Object] has no method 'fancybox' 
```

似乎由于某种原因它没有加载。我不知道为什么。我尝试检查是否正确加载了 jQuery（也许在 jquery 或其他东西之前包含了 fancybox 脚本），并发现我在每次加载时都包含*了两个*jquery 实例。第二个包括来自 wordpress，我认为它自动包含 jQuery。

问题是，如果我删除我自己的 jquery 包含，没有任何效果！如果我`$`在控制台中运行，我会得到`undefined`. 如果我跑步，`jQuery`我会得到这个：

```
function (a,b){return new e.fn.init(a,b,h)} 
```

所以我想......它有点工作，但只有当我使用`jQuery`而不是`$`？自己查，去页面，`jquery`在源码中搜索。

任何想法我如何解决这个问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-06T08:33:02.387

如果您包含 jQuery，那么一些插件（例如，fancyBox）和另一个 jQuery，那么之前加载的所有插件都将丢失。

编辑。我检查了你的页面，发现

1.  实际的错误信息是 -`TypeError: $ is not a function`

2.  这是因为您的 jQuery 运行到“noConflict”模式。由于某些原因，您的 jQuery 文件的最后一行是 -`jQuery.noConflict();`

因此，您必须使用`jQuery`代替`$`或删除`jQuery.noConflict();`行。

# php - php dom 获取图像 src 路径编码

> ID：13247172
> 
> 赞同：7
> 
> 时间：2012-11-06T08:30:33.067
> 
> 标签：php

我使用以下代码提取图像 src 路径。但是当图像文件名具有特殊字符时，这是一个问题（例如：~ DQBTZ_UC（G@STWO_1R2U_Q4.gif），输出变成这样：~ 6Z6W4%255BO29FQ%255BA4YN_% 255BFR9%2529M.gif

如何解决这个问题？对不起我糟糕的英语。

```
function _get_imagepath($content){

    $doc = new DOMDocument();
    $doc->loadHTML($content);
    $imagepaths=array();
    $imageTags = $doc->getElementsByTagName('img');
    $folder=file_directory_path();
    foreach($imageTags as $tag) {

        $imagepaths[]=$tag->getAttribute('src');
    }

    if(!empty($imagepaths)){

        return $imagepaths;
    }else{

        return FALSE;
    }

} 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-11-06T08:37:41.390

您的文件名似乎是 URL 编码的。看看[http://php.net/manual/en/function.urldecode.php](http://php.net/manual/en/function.urldecode.php)

IE：

```
foreach($imageTags as $tag) {
    $imagepaths[]=urldecode($tag->getAttribute('src'));
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-06T08:37:18.927

您将获得编码的 URL。

你想使用`urldecode`：

> 解码给定字符串中的任何 %## 编码。加号 ('+') 被解码为空格字符。

[PHP 手册中的 urldecode()](http://www.php.net/manual/en/function.urldecode.php)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-06T08:39:26.393

代替

```
return $imagepaths; 
```

和

```
return urldecode($imagepaths); 
```

解码您的图片网址。

# iphone - 如何推送 ViewController 并使第一个控制器部分可见？

> ID：13247175
> 
> 赞同：1
> 
> 时间：2012-11-06T08:30:43.667
> 
> 标签：iphone, ios, cocoa-touch, uiview, uinavigationcontroller

我有一个基于 UINavigationController 的应用程序。我想实现呈现（推送）视图控制器的效果，同时让前一个控制器的一部分可见。所以我想有这样的效果：

![在此处输入图像描述](../Images/0f9fda191c77ae4a7b0fcd5f984b5139.png)

理想情况下，第二个图像的底部将是第一个控制器视图的一部分。

这可以使用 UINavigationController 方法完成吗？如果可以，怎么做？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-06T08:45:38.880

这是可能的，但它需要相当多的努力。

在我的脑海中，我将实现一个自定义容器视图控制器，它具有`UINavigationController`另一个自定义容器视图控制器（我们称之为`PreviousVCContainer`）作为子视图控制器。请参阅[创建自定义容器视图控制器](http://developer.apple.com/library/ios/#featuredarticles/ViewControllerPGforiPhoneOS/CreatingCustomContainerViewControllers/CreatingCustomContainerViewControllers.html#//apple_ref/doc/uid/TP40007457-CH18-SW6)。“内部容器视图控制器”将在底部提供视图，并将前一个视图控制器（具有“第一个标题”的视图控制器）作为子视图控制器。

这个想法是以当 navVC 推送或弹出 vc 时收到通知的方式`PreviousVCContainer`连接。`UINavigationController`然后它会去寻找合适的 vc 以显示在底部视图中，并将这个 vc 添加为 childVC。

我希望你开始了。如果您需要有关某些特定点的更多详细信息，请告诉我。

# database - DB中位掩码的替代设计

> ID：13247179
> 
> 赞同：2
> 
> 时间：2012-11-06T08:31:11.180
> 
> 标签：database, oracle, database-design, oracle11g, bitmask

我有一张`users`表格，格式如下：

```
users(id,name.....,settings) 
```

`settings`字段是类型`number`并包含设置的位掩码。

我必须支持（除其他外）查询，例如：

*   查找所有具有 setting1、setting23、setting125 的用户

今天这样的查询看起来像：

```
 select * from users where bit_and(settings,2^1+2^23+2^125) = 2^1+2^23+2^125 
```

当然它不是一个完美的实现，但它已经以这种方式工作了很多时间。

问题是今天我们有 126 种不同的设置，这正是`oracle 11g`按位运算的限制。这意味着我们不能再添加新设置。

我正在尝试找到解决此问题的替代方法。显而易见的方法是创建映射表（用户->设置）而不是设置字段，例如：

```
user_id | setting
  128   |   1
  128   |   23
  128   |   125 
```

但是上面的查询将是这样的：

```
select * 
from users u1 join settings s1 on u1.id = s1.user_id and s1.setting  = 1
              join settings s2 on u1.id = s2.user_id and s2.setting  = 23
              join settings s3 on u1.id = s3.user_id and s3.setting  = 125 
```

看起来不太好...

因此，如果有人可以就这个问题提出任何解决方案/方法，那将非常有帮助......

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-06T11:00:57.667

[这](https://stackoverflow.com/questions/5708239/when-is-it-better-to-store-flags-as-a-bitmask-rather-than-using-an-associative-t/5708369#5708369)是我对一个相关问题的回答。

您可以轻松地简化您的查询：

```
select * 
from  users     u 
join  settings  s 
on    u.id = s1.user_id 
and   s1.setting  in (1, 23, 125) 
```

这为您提供了查询的“或”版本。

```
select u.userid, sum(s.setting) 
from  users     u 
join  settings  s 
on    u.id = s1.user_id 
and   s.setting  in (1, 23, 125)
group by u.userid
having sum(s.setting) = 149 
```

为您提供查询的“和”版本。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-06T13:41:07.130

您的新设计基本上没问题，但假设“获取给定设置的用户”将是一个主要查询，您可以通过以下方式对其进行微调......

```
CREATE TABLE "user" (
    user_id INT PRIMARY KEY
    -- Other fields ...
);

CREATE TABLE user_setting (
    setting INT,
    user_id INT,
    PRIMARY KEY(setting, user_id),
    CHECK (setting BETWEEN 1 AND 125),
    FOREIGN KEY (user_id) REFERENCING "user" (user_id)
) ORGANIZATION INDEX COMPRESS; 
```

注意 PRIMARY KEY 和 ORGANIZATION INDEX COMPRESS 子句中字段的顺序：

*   ORGANIZATION INDEX 将[聚集](http://use-the-index-luke.com/sql/clustering/index-organized-clustered-index)（物理上靠近存储）具有相同`setting`.
*   `setting`COMPRESS 将最小化重复字段的存储（和缓存！）成本。

然后，您可以让用户连接到**任何**给定的设置，像这样......

```
SELECT * FROM "user"
WHERE user_id IN (
    SELECT user_id FROM user_setting
    WHERE setting IN (1, 23, 125)
); 
```

...由于有利的索引和最小化的 I/O，这将非常快。

您还可以获取具有**所有**给定设置的用户，如下所示：

```
SELECT * FROM "user"
WHERE user_id IN (
    SELECT user_id
    FROM user_setting
    WHERE setting IN (1, 23, 125)
    GROUP BY user_id
    HAVING COUNT(setting) = 3
); 
```

* * *

对所有设置使用位域会使查询变得很尴尬，并且难以优化查询性能（在您的旧设计中，每个查询都是表扫描！）。OTOH，“每个设置的列”设计需要每列单独的索引以获得良好的性能，并且您仍然会有一些不太优雅的查询。

此外，这些方法不灵活，不像您的新设计可以轻松扩展以接受更多设置或通过添加另一个表并从`user_setting`.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-06T08:52:15.777

将每个设置存储在它自己的列中。

# php - zend_gdata：如果已登录应用程序，则获取谷歌日历

> ID：13247180
> 
> 赞同：1
> 
> 时间：2012-11-06T08:31:22.030
> 
> 标签：php, google-calendar-api, zend-gdata, yii-extensions

我在 YiiFramework 中创建了一个具有两个功能的应用程序。

```
1\. Login to google 
```

为了登录谷歌，我按照以下网站上的教程进行操作。

教程：[https](https://github.com/Nodge/yii-eauth)
://github.com/Nodge/yii-eauth 教程演示： http: [//nodge.ru/yii-eauth/demo/login](http://nodge.ru/yii-eauth/demo/login)

```
2  Get calendar using Zend_Gdata Library 
```

教程：[http](http://www.bcits.co.in/googlecalendar/index.php/site/install)
://www.bcits.co.in/googlecalendar/index.php/site/install 教程演示：[http ://www.bcits.co.in/googlecalendar/index.php/site/page?view=关于](http://www.bcits.co.in/googlecalendar/index.php/site/page?view=about)

[第一步] 我使用 yii-eauth 成功登录到我的应用程序。
[第 2 步] 当我需要使用日历时，我提供了硬编码的 gmail ID 和密码。

我正在以这种方式访问​​日历。

```
 <?php 
     $user = 'your gmail username';
     $pass ='your gmail password';
     Yii::app()->CALENDAR->login($user, $pass);
  ?> 
```

googlecalendar.php 文件中的 login()。

```
 public function login($user, $pass) {

    $service = Zend_Gdata_Calendar::AUTH_SERVICE_NAME;
    $client = Zend_Gdata_ClientLogin::getHttpClient($user, $pass, $service);// It uses hard-coded gmail/password to get login again
    $calenderlist = $this->outputCalendarList($client);
    $events = $this->outputCalendar($client);
    $calendardate = $this->outputCalendarByDateRange($client, $startDate = '2011-05-01', $endDate = '2011-06-01');
     .........
  } 
```

Zend_Gdata 库是否包含任何无需再次登录即可自动获取当前用户日历的功能（此处为硬编码）。

坚持这一点。感谢帮助。谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-06T08:42:43.480

据我了解，`Zend_Gdata_ClientLogin`设置了一些参数，`$client`这些参数是返回的对象。请参阅该函数的以下摘录：

```
if ($loginToken || $loginCaptcha) {
    if ($loginToken && $loginCaptcha) {
        $client->setParameterPost('logintoken', (string) $loginToken);
        $client->setParameterPost('logincaptcha', (string) $loginCaptcha);
    } else {
        require_once 'Zend/Gdata/App/AuthException.php';
        throw new Zend_Gdata_App_AuthException(
            'Please provide both a token ID and a user\'s response ' .
            'to the CAPTCHA challenge.');
    }
} 
```

您可以做的是存储该令牌或该`$client`对象（它是 的一个实例`Zend_Gdata_HttpClient`）。几乎所有 Zend_Gdata 组件都接受一个`$client`参数。

查看以下`__construct()`方法`Zend_Gdata_Calendar`：

所以无论如何，你会想要类似于这个逻辑的东西（对不起，我不熟悉 Yii）：

```
$client = Yii::app()->getClient();
if (!$client) {
    $client = Zend_Gdata_ClientLogin::getHttpClient($user, $pass, $service);
    Yii::app()->setClient($client);
} 
```

当然，*您*必须以`getClient()`某种方式定义该方法。

希望这可以帮助！

# debugging - JVM 是否侦听 IPv6 调试端口？

> ID：13247181
> 
> 赞同：3
> 
> 时间：2012-11-06T08:31:22.793
> 
> 标签：debugging, jvm, ipv6

我无法连接到只有 IPv6 接口的主机上的远程 JVM。

应该将什么参数传递给 JVM 以启用对 IPv6 接口的侦听？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-03T05:55:03.810

不幸的是你不能。正在调试的 Java VM 仅侦听 IPv4。这是一个已知问题，在[Oracle 的文档](http://docs.oracle.com/javase/8/docs/technotes/guides/jpda/conninv.html)中：

> 目标 VM 端的当前实现仅支持 IPv4，但这可能会在未来版本中更改，以便同时支持 IPv4 和 IPv6。

`xinetd`解决此问题的一种方法是在主机上安装一个程序（例如`rinetd`基于 *nix 的服务器），侦听 IPv6，并将连接转发到 JVM 正在侦听的 IPv4 端口。

# microsoft-metro - 是否可以在 Windows 8 Metro 应用程序中将附件附加到 mailto 应用程序？

> ID：13247182
> 
> 赞同：1
> 
> 时间：2012-11-06T08:31:24.967
> 
> 标签：microsoft-metro, windows-runtime, winrt-xaml, email-attachments

我正在以这种方式启动 mailto 应用程序：-

```
 using Windows.System;
    //starts the default mail app with a subject, cc, bcc, and body
    Launcher.LaunchUriAsync(new Uri("mailto:windows8devs@almostbeta.com?subject=Code Request&cc=kevin@almostbeta.com&bcc=admin@almostbeta.com&body=Hi!")); 
```

1) 我们不能在 Windows 8 中将附件附加到 mailto 应用程序吗？

2）如果是这样，请让我知道解决方法是什么？

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-06T09:01:29.167

不，您不能将文件附加到 Windows 8 中的邮件应用程序。

您需要使用共享。看看这个： http: [//msdn.microsoft.com/en-us/library/windows/apps/xaml/hh871371.aspx](http://msdn.microsoft.com/en-us/library/windows/apps/xaml/hh871371.aspx)，例如如何共享文件。

# android - 通过编写java代码启动一个像“对话框”这样的活动

> ID：13247191
> 
> 赞同：0
> 
> 时间：2012-11-06T08:32:12.723
> 
> 标签：android, themes, android-theme

我想做一个像“对话”这样的活动，到目前为止我知道两种方法：

**方式1）**在Android ApiDemos中，通过在activity中添加属性来实现，如

```
android:theme="@android:style/Theme.Dialog"> 
```

结果是：新 Activity 出现在现有 Activity 之上，这就是我想要的。

**方式2）**我尝试`setTheme(android.R.style.Theme_Dialog)`在`Activity.onCreate(Bundle)`方法中调用，新的活动也出现了，但背景全黑。这不是我想要的。代码如下：

```
 super.onCreate(savedInstanceState);
            setTheme(android.R.style.Theme_Dialog);
            requestWindowFeature(Window.FEATURE_NO_TITLE);
            setContentView(R.layout.selecte_date); 
```

谁能告诉我如何通过编写Java代码来实现效果？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-06T10:25:03.097

最简单的方法是在您的 xml 中添加第二个布局，这是现有布局的覆盖。然后您可以将叠加层设置为在您的活动中可见。因此，您在 1 个活动中获得了多个视图。

```
<?xml version="1.0" encoding="utf-8"?>
<RelativeLayout
    xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"
    android:background="@android:color/transparent"  >
<LinearLayout

    android:orientation="vertical"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"
    android:layout_alignParentTop="true"
    android:background="@android:color/transparent">

    <ImageView
        android:id="@+id/icon" 
        android:layout_width="fill_parent" 
        android:layout_height="wrap_content"/>

    <TextView 
        android:id="@+id/title"
        android:layout_width="fill_parent" 
        android:layout_height="fill_parent" />

</LinearLayout>
<LinearLayout
    android:layout_alignParentTop="true"
    android:id="@+id/overlay"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"
    android:background="@color/translucent_black"
    android:visibility="false" >
</LinearLayout>
</RelativeLayout> 
```

# image - pinterest 图片 url 中存储了哪些信息？

> ID：13247192
> 
> 赞同：0
> 
> 时间：2012-11-06T08:32:18.197
> 
> 标签：image, node.js, pinterest

_ 之前的第一位是引脚的 id ... *ZZtfjmGQ*是做什么用的？我假设 _c 可能与大小有关。

```
http://media-cache-lt0.pinterest.com/upload/33284484717557666_HZtfjmFQ_c.jpg 
```

我正在 node.js 中构建图像上传服务，并且很好奇其他站点如何存储图像。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-07T16:39:28.787

最终图像由 CDN 提供，URL 中的子域很明显。正如您所指出的，第一位是图像的 id，第二位是 UID，用于解决图像版本的缓存限制，最后一位是图像大小。

CDN 的一个限制是无法在上传后处理图像。为了解决这个问题，我的服务将文件上传到我的 Nodejs 服务器，然后我将图像返回给客户端。我使用用户可以用来裁剪图像的 jQuery 脚本，该脚本将裁剪坐标发送回服务器，我使用 ImageMagick 创建上传图像的各种尺寸。您显然可以消除裁剪步骤，只需使用纵横比来自动创建所需的图像尺寸。然后我将最终图像上传到 CDN 以托管给最终用户。

当用户需要更新 CDN 中已有的照片时，用户上传到 nodejs 服务器，对图像进行处理和调整大小，更新 UID 哈希，然后上传到 CDN。如果您想保持干净（并降低 CDN 成本），您也可以在此步骤中删除旧的“版本”。但是，在我的服务中，如果需要，我可以选择回溯到旧版本。

其余的 CRUD 操作是不言自明的。您可以使用 ID 读取 CDN 中可用的图像列表（我的服务有一个用户 ID 和一个图像 ID 以允许更强大的查询操作），删除就像识别要删除的图像一样简单。

# asp.net - 显示来自不同服务器的 Pdf

> ID：13247193
> 
> 赞同：0
> 
> 时间：2012-11-06T08:32:19.177
> 
> 标签：asp.net, iis

我有 2 个服务器 1\. IIS 服务器（Internet 访问），2\. 文件服务器（无 Internet 访问），但两个服务器都在同一个网络上。我想从我的文件服务器显示 pdf，但是当我使用 asp.net 运行网站时，它的工作原理.. 但是当我托管网站时，它不显示 pdf。页面出现空白.. 我的朋友告诉我，您需要使用模拟，但之后它也不起作用.. 任何帮助将不胜感激。

（Asp.Net 开发服务器）：- 工作

![在此处输入图像描述](../Images/d0bc6d56023b60001116a6049bd145ec.png)

在 IIS 中托管网站后当我使用我的内部 IP 地址查看网站时，它没有显示 Pdf 下面是屏幕截图

![在此处输入图像描述](../Images/f0311c3238fd8d86d98d7998c8f61d98.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-06T08:36:12.590

听起来好像您将不得不使用[UNC](http://www.uwplatt.edu/oit/terms/uncpath.html)来获取您的文件。

如果您能告诉我们您在托管环境中遇到了什么错误，那将是最好的。

我还会检查：[Determining if file exists using c# and resolve UNC path](https://stackoverflow.com/q/458363/395890)

# asp.net - 使用目标 _blank 跨页发布会使源页面无法正常工作

> ID：13247201
> 
> 赞同：2
> 
> 时间：2012-11-06T08:32:59.610
> 
> 标签：asp.net

我试图用尽可能少的步骤来描述它：我有**Page1.aspx**有很多控件，其中包括预览和保存按钮。我也有**Page2.aspx**，它是预览按钮单击的重定向目标。

由于我需要从 Page1 中选择所有控件才能在 Page2 上绘制预览，因此重定向是通过设置 Preview's 来完成的`PostBackUrl`。我还必须在新选项卡或窗口上显示预览，因此我用于`onClientClick="aspnetForm.target='_blank'"`预览按钮定义。

保存按钮单击回调，在将数据存储到数据库后重定向到一些 Page0.aspx（报告的初始列表 - 代码的主题）

预览按钮工作正常 - 预览在新选项卡中呈现，但是当我转到旧选项卡并单击保存时，我从调试器中看到，首先加载了 Page2.aspx(?)，然后加载了 Page1.aspx。然后所有数据都存储在数据库中，但是尽管执行了 Page0 重定向，但 Page1.aspx 仍然加载在浏览器中。

我不知道这背后是什么过程。有知道的可以给我介绍一下吗？或者，如果您认为我的方法无法实施，请给出一些想法如何做同样的事情？

如果它很重要，那么 Page1 上的所有内容都位于更新面板中。

非常感谢您的回复

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-06T08:50:39.317

在 ASP.NET 中，基本上有零 (0) 种情况，您将表单数据从一个页面发送到另一个页面。尽管您想要完成的具体内容含糊不清，但您可以考虑以下几点：

*   将独特的操作/系统隔离到单个页面。如果你有类似用户配置文件的东西，不要有三个不同的 aspx 页面；只需为用户或管理员使用一个页面来管理该数据/功能。回发事件是您的朋友。
*   了解 ViewState 与传统表单数据的区别。我猜如果您尝试将表单数据从一个页面发布到另一个页面，您可能不理解 ViewState 的意义。使用单个页面来维护用户当前正在使用的临时数据是 ViewState 的一大用途。如果您希望数据出现在另一页上，则需要将上一页中的数据视为最终数据，因此应将其保存到数据库或其他介质中。

这些只是一些一般性的指导方针，因为如果不说“你做错了”之类的一般性的话，就没有确切的答案来解决你的问题。我建议从不再尝试将表单数据从一个 aspx 页面发布到另一个页面开始。

# itextsharp - 在 IIS 中托管时，iTextsharp pdf 无法打开

> ID：13247203
> 
> 赞同：0
> 
> 时间：2012-11-06T08:33:00.347
> 
> 标签：itextsharp

我正在使用 iTextSharp 为 ASP.Net (c#) 中的报告创建 PDF。Pdf 已成功创建并且可以在运行应用程序时打开，但是当 iam 托管在 IIS 中时，它无法在 PDF 中打开并给出错误：

“adobe reader 无法打开 pdf，因为它不是受支持的文件类型或文件已损坏”

我的代码如下：

```
Document pdfDoc = new Document();
pdfDoc.SetPageSize(PageSize.A4.Rotate());

string filepath = "Demo" + ".pdf";

string attachment = "attachment; filename=" + filepath;
Response.Charset = String.Empty;
Response.ClearContent();
Response.AddHeader("content-disposition", attachment);
Response.ContentType = "application/PDF";

PdfWriter.GetInstance(pdfDoc, Response.OutputStream);

pdfDoc.Open();

//Adding some paragraph in to the pdfdoc.            

pdfDoc.Close();

Response.Write(pdfDoc);
Response.End(); 
```

我在等你的好主意

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-10-23T23:07:59.997

我知道这是一篇旧帖子，但我遇到了 itextsharp 的问题，就我而言，是关于 iis 用户的文件夹权限。

我只是右键单击我的主文件夹，转到安全选项卡并选择 .Net 用户（对我来说是 2 个）并完全控制。那是我的问题，并且解决了。希望这可以帮助别人。

# android - 什么是独立工具链？

> ID：13247206
> 
> 赞同：12
> 
> 时间：2012-11-06T08:33:02.853
> 
> 标签：android, toolchain, android-ndk-r5

我试图了解独立工具链的含义。以下是我的发现。一个工具链，可以与正确路径中的系统头文件和库的所有配置一起使用。对于 Android，它还将在工具链可以查找的路径中包含 API 标头。为什么叫“独立”？这可能与常规工具链不同，因为 RT 需要配置并准备好用于 android 使用给定的 sysroot 和 libc 标头路径等。请评论。

嗯，我正在为 android 编译，一个进程正在运行一个名为 make-standalone-toolchain.sh 的脚本，创建了一个独立的工具链。我正在通过这个脚本来了解它在做什么。不太擅长shell脚本。但是弄出来了一些东西。""生成一个定制的 Android 工具链安装，其中包括一个工作的 sysroot。结果是可以更容易地用作独立的交叉编译器，例如运行配置和制作脚本。" --toolchain arch ndk-dir package-dir 系统平台变量已设置 Compute source sysroot SRC_SYSROOT="$NDK_DIR/平台/$PLATFORM arch-$ARCH" 正在复制 sysroot 头文件和库... libstdc++ 头文件和库... 预构建的 binaries.all 到一个临时文件夹然后从 Tmp 目录复制到安装目录创建一个 tar 即一个包文件来添加 tmpdir 想知道这里到底发生了什么或链接或建议在哪里看。但当然不想阅读非常详尽的手册。~

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-05-02T21:16:01.593

这篇博文可能会回答您的问题：

[http://clseto.mysinablog.com/index.php?op=ViewArticle&articleId=3480794](http://clseto.mysinablog.com/index.php?op=ViewArticle&articleId=3480794)

推荐一种在 Android 上构建原生 C/C++ 程序的方法：在脚本 (Android.mk) 中列出源文件并运行“ndk-build”。如果您正在编写新程序，这可能不是问题，但如果您已经有一个可以在 Linux 上很好地构建您的程序的工作构建脚本（如那些开源软件），那么将您的脚本迁移到 Android.mk 将是一件令人头疼的事情. 在这种情况下，您只需要一个 C/C++ 交叉编译器，然后将脚本中的变量（例如 CC、CXX、AR、AS、RANLIB...）替换为“arm-linux-androideabi-gcc”之类的东西, 'arm-linux-androideabi-g++', ...

Fortunatley，在“Android NDK 开发指南”中，有一个“独立工具链”部分，它只是描述了我们需要什么......

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2018-08-28T12:54:10.863

首先，Android 中独立工具链的最佳指南在这里：[https](https://developer.android.com/ndk/guides/standalone_toolchain) ://developer.android.com/ndk/guides/standalone_toolchain 。我已经多次将它用于不同的设备和平台。

您需要下载 NDK，然后使用一些参数（如上面的链接中所述）运行脚本“make-standalone-toolchain.sh”，这些参数将确定您的应用程序的 API 级别、设备的架构等。

脚本的输出将是一个目录，您可以将其用作工具链，以便交叉编译本机 C/C++ 代码以在 Android 设备上运行。您需要在 Makefile 中放入工具链目录的路径，并为其中的二进制文件添加架构后缀（例如“arm-eabi-”）。就像是：

```
CROSS_COMPILE = /path-to-toolchain-dir/bin/arm-eabi- 
```

在您的工具链目录中应该有类似“/path-to-toolchain-dir/bin/arm-eabi-gcc”的文件。

无论如何，这将告诉 Makefile 使用您的工具链的二进制文件来编译 C/C++ 本机代码并为您的目标机器创建兼容的可执行文件。

例如，这是我用来为某个 Android 设备创建独立工具链的命令：

```
./make-standalone-toolchain.shj --arch=arm --platform=android-21 --install-dir=<dest-dir> --toolchain=arm-linux-androideabi-4.9 
```

# c# - 如何从asp.net mvc3中的下拉列表中访问所选项目

> ID：13247207
> 
> 赞同：1
> 
> 时间：2012-11-06T08:33:01.767
> 
> 标签：c#, asp.net-mvc, asp.net-mvc-3

我正在使用 asp.net mvc3，并使用以下模型填充创建视图

**模型**

```
public class CategoryModel
{
    public  int Id { get; set; }
    public string Name { get; set; }
    public  string URL { get; set; }
    public  string Description { get; set; }
    public  string Logo { get; set; }
    public  bool IsActive { get; set; }
    public  bool isPopular { get; set; }
    public IList<Category> Parentcategories { get; set; }

} 
```

在我的创建视图中，我像这样填充

**看法**

```
 <div class="editor-field">
        @Html.DropDownList("parentcategories", new SelectList(Model.Parentcategories.Select(c => c.Name), Model.Parentcategories.Select(c => c.Name)))
        @Html.ValidationMessageFor(model => model.Parentcategories)
    </div> 
```

现在我如何访问我的控制器方法中的选定项目

**方法**

```
 [HttpPost]
    public ActionResult Create( CategoryModel model , HttpPostedFileBase file)
    {
     // 
    } 
```

谢谢，阿山

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-06T08:39:50.337

试试这个：

```
public ActionResult Create(string parentcategories, CategoryModel model , HttpPostedFileBase file) 
```

`parentcategories`将包含选定的`option`值。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-07T00:09:51.403

正如**Smartboy**已经提到的，您应该使用 DropDownListFor：
1\. 将您的模型附加到`public int ParentCategoryId { get; set; }`字段中。
2\. 而不是使用@Html.DropDownList 使用：
`@Html.DropDownListFor(m => m.ParentCategoryId, new SelectList(...))`
3\. 服务器端可以保持不变：

```
[HttpPost]
public ActionResult Create(CategoryModel model)
{
   // 
} 
```

将在哪里`model.ParentCategoryId`选择项目值。
另请注意，您可以首先为您的视图设置选定的项目值：

```
public ActionResult Index()
{
  var model = CategoryModel();
  ...
  model.ParentCategoryId = some_selected_value;
  return View(model);
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-06T09:00:22.990

**详细信息：**您可以直接从模型中访问它。

```
[HttpPost]
public ActionResult Create( CategoryModel model , HttpPostedFileBase file)
{
      var selectedCategory = model.parentcategories;  // something like that
} 
```

# asp.net - 在 asp.net 中找不到“使用”选项

> ID：13247210
> 
> 赞同：1
> 
> 时间：2012-11-06T08:33:16.290
> 
> 标签：asp.net, asp.net-mvc, visual-studio-2010, using

这可能是一个愚蠢的问题，但我已经看过并且没有找到一个直接的答案。我最近开始学习 ASP.net，并开始学习教程。我首先创建一个项目，一个 MVC2 Web 应用程序，但是当它启动时，我找不到“使用系统”；, "使用 system.web;" 等等......我做错了什么？

编辑：我正在使用 Visual Studio 2010 Ultimate

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-06T08:51:38.040

根据您的评论，您使用的是 VB.Net 而不是 C#。你应该使用`Import System`not `Using System;`。

此外，VB.Net 允许在项目级别导入命名空间，而不是需要在每个文件中都这样做。这是通过项目属性完成的（如果我没记错的话，参考选项卡）。这意味着每个文件中都不需要 , 等`Import System`。`Import System.Web`

# android - 带代理设置的 webView

> ID：13247217
> 
> 赞同：0
> 
> 时间：2012-11-06T08:34:01.487
> 
> 标签：android, webview, 3g

我只知道 :WebView.enablePlatformNotifications(); 现在已经过时了。我在我的活动中添加了这段代码

```
 DefaultHttpClient httpClient = new DefaultHttpClient();

    HttpHost proxy = new HttpHost("X.X.X.X", portNumber); //proxy that i need 

    httpClient.getParams().setParameter(ConnRouteParams.DEFAULT_PROXY, proxy); 
```

我添加了这段代码：

```
WebView testWebView = new WebView(this);
// WebView.enablePlatformNotifications();// it's obsoleted!
testWebView.loadUrl("http://www.google.com"); 
```

结果是：我的设备无法通过 3g 打开 google.com。

我怎样才能让 testWebView 知道我所使用的代理？

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-11-06T08:47:39.473

您应该关注此链接，它可能对您有所帮助。

*   [https://gist.github.com/2297083](https://gist.github.com/2297083)
*   [WebView 安卓代理](https://stackoverflow.com/questions/4488338/webview-android-proxy)
*   [android WebView 上网问题，因为代理？](https://stackoverflow.com/questions/6673159/android-webview-internet-access-problem-because-of-proxy)

# java - 如何在 swig 中使用相同的接口生成两个代理类

> ID：13247223
> 
> 赞同：1
> 
> 时间：2012-11-06T08:34:22.947
> 
> 标签：java, c++, swig, typedef, proxy-classes

我有一些如下代码：

```
class SingleValue
{
public:
   SingleValue()
   {}

   ~SingleValue()
   {}

   const std::string& getValue()const
   {
    return m_nSingleValue;
   }
private:
   int m_nSingleValue;
};

typedef SingleValue RoadType;
typedef SingleValue RoadSubType;
typedef SingleValue FunctionalClass; 
```

现在我想使用 SWIG 生成一个 Java 包装器，但它只生成一个代理类“SingleValue”，我想知道如何使用 swig 生成另一个代理类，但我在谷歌搜索后找不到一些相关信息。

我尝试%rename，但它只生成一个代理类，而不是三个。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-11T16:44:19.840

您要实现的目标似乎是强类型。默认情况下，SWIG 尝试公开具有与 C++ 中相同行为的接口，因此在这种情况下，行为是预期的 - 弱类型定义都是 C++ 提供的。你可以解决这个问题。

给定头文件：

```
#include <string>

class SingleValue
{
public:
   SingleValue()
   {}

   ~SingleValue()
   {}

   std::string getValue() const
   {
      return std::to_string(m_nSingleValue);
   }
private:
   int m_nSingleValue;
};

typedef SingleValue RoadType;
typedef SingleValue RoadSubType;
typedef SingleValue FunctionalClass;

inline RoadType make_road() { return RoadType(); }
FunctionalClass make_func() { return FunctionalClass(); } 
```

与您的不同之处仅在于更正`getValue()`和添加了两个用于测试的内联函数，我们可以包装它并通过执行以下操作来接近强 typedef 语义：

```
%module test

%{
#include "test.h"
%}

%include <std_string.i>

class SingleValue
{
public:
   SingleValue();
   ~SingleValue();
   std::string getValue() const;
};

struct RoadType : public SingleValue {
};

struct RoadSubType : public SingleValue {
};

struct FunctionalClass : public SingleValue {
};

RoadType make_road();
FunctionalClass make_func(); 
```

请注意，我根本没有向 SWIG 显示 typedef，并且我完全对`RoadType`等的类型和存在撒谎，但这没关系，因为 SWIG 生成的所有代码仍然是合法且正确的。

这会导致生成一个接口，其中`make_X`函数返回不同的类型。

* * *

如果你想避免头文件和接口文件之间的重复，你可以引入一个宏来帮助，头文件变成：

```
#include <string>

class SingleValue
{
public:
   SingleValue()
   {}

   ~SingleValue()
   {}

   std::string getValue() const
   {
      return std::to_string(m_nSingleValue);
   }
private:
   int m_nSingleValue;
};

#ifndef STRONG_TYPEDEF
#define STRONG_TYPEDEF(o,n) typedef o n
#endif

STRONG_TYPEDEF(SingleValue, RoadType);
STRONG_TYPEDEF(SingleValue, RoadSubType);
STRONG_TYPEDEF(SingleValue, FunctionalClass);

inline RoadType make_road() { return RoadType(); }
FunctionalClass make_func() { return FunctionalClass(); } 
```

这意味着接口文件可以简单地变成：

```
%module test

%{
#include "test.h"
%}

%include <std_string.i>

#define STRONG_TYPEDEF(o, n) struct n : o {};

%include "test.h" 
```

这部分是因为`SingleValue`它是一个类，所以强 typedef 可以成为 Java 类型系统中的子类，以便它强制检查。如果类型不是一个类，你仍然可以在不使用继承的情况下做同样的事情，例如[，我在使用 D 的类似问题上给出的答案的第一部分](https://stackoverflow.com/a/11602306/168175)会起作用 - 你想详细说明空结构，但如果游戏中没有任何继承。

# h.264 - 高效复制、倍增和保存 H.264 电影文件

> ID：13247228
> 
> 赞同：0
> 
> 时间：2012-11-06T08:34:46.503
> 
> 标签：h.264, movie, video-editing

我试图寻找可以执行上述任务的免费 H.264 编辑器，但我找不到任何合适的结果（可能是由于我不正确的（？）搜索词）。

基本上，我有很多 20 到 40 秒的循环电影文件（用 Adob​​e Premiere 渲染），我想将单个电影乘以大约 10 或 20 倍，然后再次保存，最好不需要重新渲染（或重新编码？）。这可能吗？

希望我设法让自己理解，谢谢:)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-07T06:35:13.843

经过大量的搜索和测试，我最终选择了 Avidemux，这一次它完美地完成了任务。我敢肯定会有一种方法可以使文件的附加/“倍增”自动化，但是使用数位板笔（主要单击设置为双击）和特定的文件夹，它确实轻而易举地过去了。

我也对 Smart Cutter 很感兴趣（习惯后我非常喜欢它的界面），但由于它是试用软件，所以选择很明确。不过，如果我不得不更频繁地执行此类任务，我*可能会*考虑购买它。

# java - 学习java自定义异常，需要以某种方式改变实现

> ID：13247231
> 
> 赞同：1
> 
> 时间：2012-11-06T08:35:03.233
> 
> 标签：java, exception-handling

我正在学习java，我应该为一个固定队列的类添加一个异常处理程序。似乎需要更改界面，但我不确定如何更改。

代码：

```
//ICharQ.java
package qpack;

public interface ICharQ {
    void put(char ch);

    char get();

    void reset();
}

//QExcDemo.java
package qpack;

class QueueFullException extends Exception {
    int size;

    QueueFullException(int s) { size = s; }

    public String toString() {
        return "\nQueue is full. Max size is " + size;
    }
}

class QueueEmptyException extends Exception {
    public String toString() {
        return "\nQueue is empty.";
    }
}

//Excerpt from IQClasses.java
package qpack;

class FixedQueue implements ICharQ {
        private char q[];
        private int putloc, getloc;

        public FixedQueue(int size) {
                q = new char[size+1];
                putloc = getloc = 0;
        }

        public void put(char ch)
         throws QueueFullException {
                if (putloc == q.length-1)
                        throw new QueueFullException(q.length-1);

                putloc++;
                q[putloc] = ch;
        }

        public char get()
         throws QueueEmptyException {
                if (getloc == putloc)
                        throw new QueueEmptyException();

                getloc++;
                return q[getloc];
        }

        public void reset() {
                putloc = getloc = 0;
        }
} 
```

编译器输出...

```
qpack/IQClasses.java:22: error: get() in FixedQueue cannot implement get() in ICharQ
public char get() 
            ^
   overridden method does not throw QueueEmptyException
qpack/IQClasses.java:12: error: put(char) in FixedQueue cannot implement put(char) in ICharQ
public void put(char ch) 
            ^
   overridden method does not throw QueueFullException 
```

2 个错误

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-06T08:38:07.730

在 FixedQueue 中，您有已检查的异常。

```
 public void put(char ch)
     throws QueueFullException {

    public char get()
     throws QueueEmptyException { 
```

这意味着这些方法的接口必须具有相同的“抛出”。

顺便说一句，我会制作`QueueFullException`并`QueueEmptyException`扩展不是检查异常的[IllegalStateException](http://docs.oracle.com/javase/7/docs/api/java/lang/IllegalStateException.html)，但我仍会将其添加到界面中的 throws 子句中。

为了比较，您可以查看[队列](http://docs.oracle.com/javase/7/docs/api/java/util/Queue.html)，我会尽可能地遵循它抛出的命名和异常。

我会考虑将您的 FixedBuffer 变成一个环形缓冲区，也称为[循环缓冲区](http://en.wikipedia.org/wiki/Circular_buffer) 这样，您的队列不会因为到达末尾而用完空间。

* * *

这就是我基于 Queue 设置接口的方式。

```
public interface CharQueue {

    /**
     * Inserts the specified element into this queue if it is possible to do so
     * immediately without violating capacity restrictions, returning
     * <tt>true</tt> upon success and throwing an <tt>IllegalStateException</tt>
     * if no space is currently available.
     *
     * @param ch the char to add
     * @return <tt>true</tt> (as specified by {@link Collection#add})
     * @throws IllegalStateException if the element cannot be added at this
     *         time due to capacity restrictions
     * @throws IllegalArgumentException if some property of this element
     *         prevents it from being added to this queue
     */
    boolean add(char ch) throws IllegalStateException;

    /**
     * Inserts the specified element into this queue if it is possible to do
     * so immediately without violating capacity restrictions.
     * When using a capacity-restricted queue, this method is generally
     * preferable to {@link #add}, which can fail to insert an element only
     * by throwing an exception.
     *
     * @return <tt>true</tt> if the element was added to this queue, else
     *         <tt>false</tt>
     * @throws IllegalArgumentException if some property of this element
     *         prevents it from being added to this queue
     */
    boolean offer(char ch);

    /**
     * Retrieves and removes the head of this queue.  This method throws an exception if this
     * queue is empty.
     *
     * @return the head of this queue
     * @throws NoSuchElementException if this queue is empty
     */
    char remove() throws NoSuchElementException;

    /**
     * Removes all of the elements from this collection.
     * The collection will be empty after this method returns.
     */
    void clear();
} 
```

这样，您可以在精神上（如果不在代码中）替换`Queue<Character>`为`CharQueue` As the documentation notes,`offer`更可取，`add`并且您可能希望根据您的要求选择其中之一。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-06T08:38:09.280

在您的`FixedQueue`课程中，您的方法`put`throws `QueueFullException`，但未在您的 interface 中指定`ICharQ`。与`get`和相同`QueueEmptyException`。

您可以：

*   在界面中也指定这些异常
*   或使这两个例外都扩展`RuntimeException`而不是`Exception`

# windows-phone-8 - WP8 自定义联系人商店

> ID：13247232
> 
> 赞同：4
> 
> 时间：2012-11-06T08:35:10.320
> 
> 标签：windows-phone-8

我尝试在 WP8 创建自定义联系人存储。我的代码（来自 msdn）：

```
 async public void AddContact(string remoteId, string givenName, string familyName, string email, string codeName)
    {
        ContactStore store = await ContactStore.CreateOrOpenAsync();
    }

    private void Button_Click_1(object sender, RoutedEventArgs e)
    {
        AddContact("0", "Sample", "Sample", "sample@tut.by", "32");

    } 
```

当我单击按钮时，它会发生 System.UnauthorizedAccessException：访问被拒绝。.

我不明白，会发生什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-06T10:29:20.317

尝试将**ID_CAP_CONTACTS**功能添加到项目中的 WMAppManifest.xml 文件中。

UnauthorizedAccessException 是一种常见的异常类型，当清单中缺少某个功能时会抛出该异常类型。我们只能想知道为什么 MS 家伙忘记在 MSDN 文档中添加如此重要的提示。

# java - Spring MVC 控制器：重定向而不将参数添加到我的 url

> ID：13247239
> 
> 赞同：39
> 
> 时间：2012-11-06T08:35:54.757
> 
> 标签：java, spring-mvc, restful-url

我正在尝试重定向而不将参数添加到我的 URL。

```
@Controller
...
public class SomeController
{
  ...
  @RequestMapping("save/")
  public String doSave(...)
  {
    ...
    return "redirect:/success/";
  }

  @RequestMapping("success/")
  public String doSuccess(...)
  {
    ...
    return "success";
  } 
```

重定向后，我的 url 看起来总是像这样：`.../success/?param1=xxx&param2=xxx`。由于我希望我的 URL 具有 RESTful 风格，并且在重定向后我从不需要参数，因此我不希望将它们添加到重定向中。

任何想法如何摆脱它们？

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2012-11-06T08:41:41.740

在 Spring 3.1 中，控制此行为的首选方法是[`RedirectAttributes`](http://static.springsource.org/spring/docs/3.1.x/javadoc-api/org/springframework/web/servlet/mvc/support/RedirectAttributes.html)向您的方法添加参数：

```
@RequestMapping("save/")
public String doSave(..., RedirectAttributes ra)
{
    ...
    return "redirect:/success/";
} 
```

它默认禁用添加属性，并允许您控制要显式添加的属性。

在以前的 Spring 版本中，它更复杂。

* * *

## 回答 #2

> 赞同：31
> 
> 时间：2013-05-30T16:44:14.997

在 Spring 3.1 中，使用选项[ignoreDefaultModelOnRedirect](http://static.springsource.org/spring/docs/3.1.x/javadoc-api/org/springframework/web/method/support/ModelAndViewContainer.html#setIgnoreDefaultModelOnRedirect%28boolean%29)禁用自动将模型属性添加到重定向：

```
<mvc:annotation-driven ignoreDefaultModelOnRedirect="true" /> 
```

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2015-09-04T20:27:46.810

添加`RedirectAttributes`参数对我不起作用（可能是因为我的 HandlerInterceptorAdapter 向模型添加了一些东西），但是这种方法可以（感谢@reallynic 的[评论](https://stackoverflow.com/questions/13247239/spring-mvc-controller-redirect-without-parameters-being-added-to-my-url#comment40067949_16841663)）：

```
@RequestMapping("save/")
public View doSave(...)
{
    ...
    RedirectView redirect = new RedirectView("/success/");
    redirect.setExposeModelAttributes(false);
    return redirect;
} 
```

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2016-10-27T14:42:10.463

在 Spring 4 中有一种方法可以通过 java config 使用注解来做到这一点。我正在分享它，以防有人需要它，因为我需要它。

在扩展的配置类上`WebMvcConfigurerAdapter`，您需要添加：

```
@Autowired
private RequestMappingHandlerAdapter requestMappingHandlerAdapter;

@PostConstruct
public void init() {
    requestMappingHandlerAdapter.setIgnoreDefaultModelOnRedirect(true);
} 
```

有了这个，你不需要使用`RedirectAttributes`，它在 java config 中等同于**Matroskin**的答案。

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2012-11-06T08:43:57.993

如果您使用的是 Spring 3.1，则可以使用[Flash Scope](http://www.javacodegeeks.com/2012/02/spring-mvc-flash-attributes.html)，否则您可以在此处查看投票最多（未接受）的答案中使用的方法：

[Spring MVC 控制器使用 URL 参数重定向而不是响应](https://stackoverflow.com/questions/2500592/spring-mvc-controller-redirect-using-url-parameters-instead-of-in-response)

编辑：

3.1 用户的好文章：

[http://www.tikalk.com/java/redirectattributes-new-feature-spring-mvc-31](http://www.tikalk.com/java/redirectattributes-new-feature-spring-mvc-31)

非 3.1 用户的解决方法：

[Spring MVC 自定义范围 bean](https://stackoverflow.com/questions/5863472/spring-mvc-custom-scope-bean/5883270#5883270)

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2017-02-03T12:58:54.597

尝试这个：

```
public ModelAndView getRequest(HttpServletRequest req, Locale locale, Model model) {

    ***model.asMap().clear();*** // This clear parameters in url

    final ModelAndView mav = new ModelAndView("redirect:/test");

    return mav;
} 
```

# .net - Windows 窗体数据绑定和可为空的类型

> ID：13247240
> 
> 赞同：0
> 
> 时间：2012-11-06T08:36:01.467
> 
> 标签：.net, winforms, data-binding, nullable

我知道我在这里使用的是日落技术，但我仍然想找到解决问题的方法。

我有一个包含一些简单字段的实体。我可以在这样的表单上绑定文本框

```
nameTextBox.DataBindings.Add(new Binding("Text", entity, "Name")); 
```

我对日期字段做了同样的事情，

```
evaluationDatePicker.DataBindings.Add(new Binding("Value", entity, "EvaluationDate")); 
```

只要 EvaluationDate 属性是 DateTime 类型，这也可以正常工作。

但是，如果我现在修改实体并使 EvaluationDate 可以为空，则绑定变为单向。也就是说，控件反映了属性值（只要它不为空），但当我在 UI 中选择另一个日期时，它不会更新实体。

与最近的 Windows 窗体策略一致，即不抛出异常，而是假装一切都很好，即使事情失败了（我书中的一个主要烦恼；Form_Load 现在也只是吞下异常，尽管在这种情况下，我们当然已经超越了 Form_Load发生错误）。所以实际上我什至无法判断它是否*正在尝试*做任何事情，但我必须假设它是，因为只要属性不可为空，双向绑定就可以正常工作。

我该如何克服呢？

我要做的是为应用程序中的演示者编写一个基类，该基类能够基于简单的命名约定对控件进行数据绑定。演示者知道，对于 TextBox，它应该绑定 Text 属性，对于 CheckBox，它应该绑定“Checked”，等等。属性和控件之间的映射是按约定完成的 - 呈现字段的控件应该与字段和控件类型具有相同的名称。因此，在 TextBox 中呈现的“Name”映射到“NameTextBox”（这是我无论如何都喜欢使用的约定 - 我从来不明白为什么人们仍然喜欢专门用于 GUI 控件的前缀，但没有其他类型的代码！？）和复选框中的“IsMarried”将变为“IsMarriedCheckBox”。

所有这些都允许演示者提供一种方法，该方法接受一个对象、“数据源”和一个要绑定的控件所在的容器。与必须使用绑定源和编写代码相比，这使得向屏幕添加一堆字段的工作非常快速，像我的解决方案不提供任何编译器检查，并且确实意味着很容易通过错误类型和属性重命名来破坏事情。

但是为了制作我的小 PoC，我想知道我能用它处理什么，以及什么样的事情仍然需要其他解决方案。如果它可以支持可为空类型的属性，那么整个事情将更有价值，因为我们经常使用它们。（我也不想停止使用它们；将“有一个值”的概念捆绑在一起，如果是的话，“哪个值”是优雅的，并且可以减少代码，以及更多的编译器帮助。）

有办法吗？有什么可以勾搭的吗？或者可以创建我自己的泛型类型来替换 Nullable<T>？由于我不明白为什么它不工作，我必须做任何事情，所以很难想象有什么值得尝试解决它。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-06T11:11:14.823

```
evaluationDatePicker.DataBindings.Add(
    new Binding("Value", entity, "Nullable", true, DataSourceUpdateMode.OnValidation)); 
```

最后一个参数可以根据需要替换为 DataSourceUpdateMode.OnPropertyChanged

# c# - 从 2 个类获取数据的 DataReader 问题

> ID：13247241
> 
> 赞同：0
> 
> 时间：2012-11-06T08:36:06.663
> 
> 标签：c#, sql, sql-server, sqldatareader

我对 SQL 非常缺乏经验，只上过一节课。我试图弄清楚如何使用 DataReader 从 2 个类中获取信息。

我的客户类别：

```
public class Customer
{
    private CreditCard _creditCard;
    private List<Subscription> _subscriptions;
    private int _customerId;
    private string _name;
    private string _address;
    private int _zipCode;
    private string _city;
    private string _email;
    private string _password;

    public Customer(int id, string name, string email, string password)
    {
        this._customerId = id;
        this._name = name;
        this._email = email;
        this._password = password;
        this._subscriptions = new List<Subscription>();
    }

    public Customer(int id, string name)
    {
        this._customerId = id;
        this._name = name;
        _subscriptions = new List<Subscription>();
    }

    public override string ToString()
    {
        return _customerId + " " + _name;
    }

    public int CustomerId
    {
        get { return _customerId; }
        set { _customerId = value; }
    }

    public string Name
    {
        get { return _name; }
        set { _name = value; }
    }

    public string Address
    {
        get { return _address; }
        set { _address = value; }
    }

    public int ZipCode
    {
        get { return _zipCode; }
        set { _zipCode = value; }
    }

    public string City
    {
        get { return _city; }
        set { _city = value; }
    }

    public string Email
    {
        get { return _email; }
        set { _email = value; }
    }

    public string Password
    {
        get { return _password; }
        set { _password = value; }
    }

    public List<Subscription> Subscriptions
    {
        get { return _subscriptions; }
    }

    public void AddSubscription(Subscription s)
    {
        _subscriptions.Add(s);
    }

    public Subscription FindSubscription(int sId)
    {
        bool found = false;
        int i = 0;
        while (!found && i < _subscriptions.Count)
        {
            if (_subscriptions[i].SubscriptionId == sId)
                found = true;
            else
                i++;
        }
        if (found)
            return _subscriptions[i];
        else
            return new Subscription();
    }

} 
```

我的订阅课程：

```
public class Subscription
{
    private SubscriptionType _subscriptionType;
    private CarModel _carModel;
    private List<Booking> _bookings;
    private int _subscriptionId;

    public Subscription(int subscriptionId, SubscriptionType subscriptionType, CarModel carModel)
    {
        this._subscriptionId = subscriptionId;
        this._subscriptionType = subscriptionType;
        this._carModel = carModel;
        _bookings = new List<Booking>();
    }

    public Subscription()
    { }

    public int SubscriptionId
    {
        get { return _subscriptionId; }
        set { _subscriptionId = value; }
    }

    public SubscriptionType SubscriptionType
    {
        get { return _subscriptionType; }
    }

    public CarModel CarModel
    {
        get { return _carModel; }
    }

    public override string ToString()
    {
        return this.SubscriptionId + "\t " + this.SubscriptionType + "\t " + this.CarModel;
    }
} 
```

我的数据库类：

```
public class DBCustomer
{
    private static SqlCommand dbCmd = null;

    public static List<Customer> GetCustomers()
    {
        List<Customer> returnList = new List<Customer>();
        string sql = "select * from Customer";
        dbCmd = AccessDBSQLClient.GetDbCommand(sql);

        IDataReader dbReader;
        dbReader = dbCmd.ExecuteReader();

        Customer c;

        while (dbReader.Read())
        {
            c = new Customer(Convert.ToInt32(dbReader["cId"].ToString()), dbReader["cName"].ToString());
            returnList.Add(c);
        }
        AccessDBSQLClient.Close();
        return returnList;

    }

    public static List<Customer> GetCustomersByEmail(string email)
    {
        List<Customer> returnList = new List<Customer>();
        string sql = "select * from Customer where cEmail = '" + email+"'";
        dbCmd = AccessDBSQLClient.GetDbCommand(sql);

        IDataReader dbReader;
        dbReader = dbCmd.ExecuteReader();

        Customer c;

        while (dbReader.Read())
        {
            c = new Customer(Convert.ToInt32(dbReader["cId"].ToString()), dbReader["cName"].ToString());
            returnList.Add(c);
        }
        AccessDBSQLClient.Close();
        return returnList;

    }

    public static List<Subscription> GetCustomerSubscriptions(int cId)
    {
        List<Subscription> returnList = new List<Subscription>();
        string sql = "select S.sId, ST.stName,CM.cmDescription "
                   + "from Customer C, Subscription S, SubscriptionType ST, CarModel CM "
                   + "where C.cId = S.cId "
                   + "and S.stId = ST.stId "
                   + "and S.cmId = CM.cmId "
                   + "and C.cId = " + cId;
        dbCmd = AccessDBSQLClient.GetDbCommand(sql);

        IDataReader dbReader;
        dbReader = dbCmd.ExecuteReader();

        Subscription s;

        while (dbReader.Read())
        {
            //s = new Subscription();
            s = new Subscription((int)(dbReader["sId"]).ToString(),
                    dbReader["stName"],
                    dbReader["cmDescription"]);
            returnList.Add(s);
        }
        AccessDBSQLClient.Close();
        return returnList;

    } 
```

显然 GetCustomers 和 GetCustomersByEmail 方法正在工作，但我不知道如何制作 GetCustomerSubscriptions 方法，因为它必须返回 2 个类的数据，而且我不能只构建一个 Customer 添加到结果集中。

# mysql - 关于 db2 的查询

> ID：13247243
> 
> 赞同：0
> 
> 时间：2012-11-06T08:36:16.647
> 
> 标签：mysql, database

我有查询，我在下表之间有以下关系

```
select * from PRODGP_STRUCTURE
select * from PRODGP_STR_LINK
select * from PRODUCT_GROUP
select * from PROD_PGRP_LINK
select * from PRODUCT 
```

关系是……

```
select pstr.PSTR_NAME, PG.PRGP_NAME, PRD.PROD_NAME
from prodgp_structure pstr
JOIN PRODGP_STR_LINK pgstrlnk
  ON pgstrlnk.PSTR_ID = pstr.PSTR_ID  
JOIN PRODUCT_GROUP pg 
  ON pgstrlnk.PRGP_CHILD_ID = PG.PRGP_ID
JOIN PROD_PGRP_LINK prdprdgp
  ON prdprdgp.PRGP_ID = pg.PRGP_ID
JOIN product prd
  ON prdprdgp.PROD_ID = prd.PROD_ID; 
```

我提出了以下查询，

```
select * from PRODGP_STRUCTURE where pstr_id in 
(select pstr_id from PRODGP_STR_LINK where PRGP_CHILD_ID  in
(select  prgp_id from PRODUCT_GROUP where PRGP_ID in ( select  PRGP_ID from PROD_PGRP_LINK where PROD_ID in ( select PROD_ID from product where PROD_ID=2)))) 
```

请让 e 知道是否有任何其他方式来编写此查询..!!

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-09T10:26:11.290

将您的表内部连接在一起，然后您只需要按 PROD_ID 过滤

```
SELECT pstr.PSTR_NAME, PG.PRGP_NAME, PRD.PROD_NAME
FROM prodgp_structure pstr
INNER JOIN PRODGP_STR_LINK pgstrlnk
  ON pgstrlnk.PSTR_ID = pstr.PSTR_ID  
INNER JOIN PRODUCT_GROUP pg 
  ON pgstrlnk.PRGP_CHILD_ID = PG.PRGP_ID
INNER JOIN PROD_PGRP_LINK prdprdgp
  ON prdprdgp.PRGP_ID = pg.PRGP_ID
INNER JOIN product prd
  ON prdprdgp.PROD_ID = prd.PROD_ID
WHERE prd.PROD_ID = 2; 
```

# php - PHP 语法错误。我瞎了吗？

> ID：13247249
> 
> 赞同：0
> 
> 时间：2012-11-06T08:36:56.513
> 
> 标签：php

我有这个 PHP 代码，我收到这个错误：解析错误：语法错误，意外的 '}'，期待 ';' 在第 120 行的 [文件位置]

while($array etc etc) 所在的行是第 120 行。

```
if($numrows != 0)
{
    do
    {
        //echo "<a href='approve.php?ref=" . $array['id'] . "'>Your '" . $array['keywords'] . "' article has been written and needs to be reviewed.</a>";
        //echo "<br />";
    } while($array = mysql_fetch_array($result)) //While there are still rows in the SELECT query.
} 
```

想法？我一定是个盲人。谢谢！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-11-06T08:38:08.783

`} while($array = mysql_fetch_array($result))`

应该

`} while($array = mysql_fetch_array($result));`

[做时](http://php.net/manual/en/control-structures.do.while.php)

顺便说一句，该代码片段看起来可能应该使用`while`循环，除非您故意使用`$array`第一次的旧值。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-06T08:39:18.313

在您的 while 语句结束时 a ; 不见了 ：）`while($array = mysql_fetch_array($result));`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-06T08:39:26.770

语句`;`末尾缺少分号`while`

```
while($array = mysql_fetch_array($result)); //<---- add semicolon here 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-06T08:39:26.850

```
 if($numrows != 0)
                {
                    do
                    {
                        //echo "<a href='approve.php?ref=" . $array['id'] . "'>Your '" . $array['keywords'] . "' article has been written and needs to be reviewed.</a>";
                        //echo "<br />";
                    } while($array = mysql_fetch_array($result)); //While there are still rows in the SELECT query.
                } 
```

你忘了**;** 经过一段时间的条件

# php - 将时间存储到数据库并与当前时间进行比较

> ID：13247257
> 
> 赞同：0
> 
> 时间：2012-11-06T08:37:18.613
> 
> 标签：php, mysql

我有一个简单的问题，只需要验证，它是关于时间如何存储在 mysql 中的，这是我存储它的方式：

```
 if(isset($_SESSION['user']))
{
$u_id=$_SESSION['user'];
//insert current time to db, i set the type of time to TIME 
$query="INSERT INTO time(id,u_id,time) VALUES('NULL','".$u_id."',CURTIME())";
mysql_query($query);
} 
```

这就是我存储它的方式，现在我还需要将它与一个值进行比较，稍后：

```
 //set current time
$curr_time=time();
//set maximum time to 5min
$max=300; 
//get previous time from db
$query="SELECT * FROM time";
$result=mysql_query($query);
$row=mysql_fetch_array($result); 
$prev_time=$row['time'];
//get difference in time
$diff=$curr_time-$prev_time;
//if max time is surpassed
if($diff>$max)
{
  echo "maximum time surpassed!";

    } 
```

这是简单的代码，首先，是将时间插入表的语法好吗（CURTIME（）东西），比较也很好，存储在$diff中的结果会产生秒数吗？谢谢，如果你认为这个问题是浪费时间。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-06T08:42:51.163

`CURTIME()`只会给你时间，你可能想要`NOW()`的是日期和时间。然后，您将需要使用`strtotime`将保存的值从数据库转换为自纪元以来的秒数。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-06T08:43:37.850

在您的查询中执行此操作：

```
 $query = "SELECT id FROM time WHERE time + INTERVAL 5 MINUTES > NOW()"; 
```

是不是没有结果，时间已经过去了。

MySQL 具有极好的时间和日期处理功能。使用它们。

（我还会在`WHERE`子句中添加一些额外的部分，如果您有多个记录，您可能会查看错误的记录。）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-06T08:44:20.497

由于 CURTIME 只是每天一次，我怀疑你希望你的函数覆盖几天的跨度，我建议你使用 NOW() 代替，因为它给你这种格式：

2012-11-06 09:39:34

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-06T08:59:16.037

```
 also is the comparison fine, will the result stored in $diff yield seconds? 
```

您不能直接将 mysql CURTIME() 与 PHP 中的 time() 函数进行比较。

例如：

在 MySql 中：

[CURTIME()](http://dev.mysql.com/doc/refman/5.5/en/date-and-time-functions.html#function_curtime)将只返回时间。

```
select CURTIME();
+-----------+
| CURTIME() |
+-----------+
| 14:15:11  |
+-----------+ 
```

在 PHP 中

[time()](http://in3.php.net/time)将返回当前的 Unix 时间戳。

```
echo time();
1352191547 
```

看看 sberry 对同情的回答。

# jquery - CSS3 过渡 v jQuery 动画 - 强大的方法？

> ID：13247259
> 
> 赞同：1
> 
> 时间：2012-11-06T08:37:29.160
> 
> 标签：jquery, css

这个问题之前已经被问过，但与性能有关。SO 的答案省略了在 IE 上实现的问题。

我接受 CSS3 过渡比 jQuery 动画更快。

但是我注意到 CSS3 在 IE 6-8 中遇到了问题，因此需要使用像 ie9.js 或 select[ivizer] 这样的插件。两者在 SO 和其他地方都有不同的写作。

因此，我想在这里澄清一下。据我了解，jQuery animate 将跨浏览器及其版本进行规范化。

因此，即使回顾 ie-8 也是使用 jQuery 的最佳建议，而不管速度方面有什么影响？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-06T08:43:21.077

这有点个人意见和个人需求的问题，

如果跨浏览器支持是一个问题，我的建议是坚持使用 jQuery，因为 CSS3 仍然在跨浏览器快速变化。尽管 CSS3 在各种基准测试中确实证明更快。

或者，您可以使用使用 CSS3 转换的专用插件，并在找到不受支持的属性时回退到动画，一个好的插件是[jQuery Transit](http://ricostacruz.com/jquery.transit/)，尽管它没有满足所有需求的完整解决方案。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-06T08:45:07.377

jQuery 使用 window.setTimeout(); 动画元素 在最佳情况下，您可以获得 60 FPS。

这还不够好，而 CSS3 对动画使用硬件加速。

如果你认为你不应该被困在 jQuery Animation 上。

用户 moderinzr 检查 CSS 过渡而不是使用 CSS3。

如果不支持 CSS3，我认为[TweenMax](http://www.greensock.com/get-started-js/)是比 jQuery 更好的动画方法。

PS：我建议你阅读[这篇文章](http://paulirish.com/2011/requestanimationframe-for-smart-animating/)。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-06T08:45:46.300

尽可能使用 CSS 过渡，在旧浏览器上使用 jQuery animate，或者在事情变得太复杂而无法轻松实现过渡的地方。

CSS 过渡不再改变（从一开始就没有改变），因为它们在某些浏览器中是在没有前缀的情况下实现的。

如果您喜欢 jQuery animate 的工作方式，可以在此处找到替换项：

[http://playground.benbarnett.net/jquery-animate-enhanced/](http://playground.benbarnett.net/jquery-animate-enhanced/)

这在可能的情况下智能地使用了过渡，这意味着您可以像往常一样编写 jQuery，但您会从新浏览器中更好的动画中受益。

根据我的经验，该插件有时工作得非常好，并且时不时地完全破坏了一切——你应该在生产中使用之前仔细测试 CSS 过渡版本是否正确。（例如某些动画上的 jQuery Cycle break 之类的东西）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-02-28T06:50:04.630

你可以使用`.animate()`，这有点困难，但我找到了一个让你的工作变得轻松的插件。

[循环插件](http://jquery.malsup.com/cycle/)

这个插件给你平滑的过渡。我检查了 IE 9，它工作正常。

# visual-studio-2012 - Visual Studio 2012 Profiler 不会产生任何输出（Win 8）

> ID：13247260
> 
> 赞同：3
> 
> 时间：2012-11-06T08:37:29.350
> 
> 标签：visual-studio-2012, windows-8, profiler

我搜索了网络和stackoverflow，我觉得我是唯一的一个，所以很可能我在做一些非常简单的错误。我在 Win 8 64 机器上运行 VS11（2012），一切都很好而且很整洁，分析器似乎（！）也可以正常工作，因为它应该在最后他永远无法显示任何结果。我得到一个几乎是空的窗口，上面说没有要显示的数据。我使用了“采样”

我在浏览网页时发现一篇 MS 文章说“采样”（我使用的）不可用，这可以解释它，但是 A）这篇文章是关于 Win8 预览和 B）我还发现一些人给出了很好的例子在 Win 8 上使用 VS11 Profiler（在采样中），所以我知道有些人得到了它的工作。但是如何？

我也尝试以管理员身份显式运行 VS，但没有任何区别。是的，仪器*正在*工作，但这对我们的项目没有帮助，我们需要采样。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-13T18:02:37.280

我也遇到了这个问题（我正在运行 Visual Studio Ultimate 2012，Windows 8 x64）。似乎如果程序运行得非常快（我的运行不到一秒钟），就没有结果。我决定让它运行几秒钟，并且采样配置文件起作用了。在搜索了互联网之后，我发现了一些无用的网页 - 但也许他们将来会报告修复：

关于这个问题的 msdn 上的一个线程 [http://social.msdn.microsoft.com/Forums/en-US/vstsprofiler/thread/c609d76c-be22-4ffb-858c-73ccab591a78/](http://social.msdn.microsoft.com/Forums/en-US/vstsprofiler/thread/c609d76c-be22-4ffb-858c-73ccab591a78/)

一个博客说您应该使用 Windows 7 来配置任何采样（我希望能够降低采样频率，但这是不可能的）。 [http://blogs.msdn.com/b/profiler/archive/2012/12/10/the-visual-studio-profiler-on-windows-8.aspx](http://blogs.msdn.com/b/profiler/archive/2012/12/10/the-visual-studio-profiler-on-windows-8.aspx)

# c - 从 TCP 套接字读取错误数据

> ID：13247264
> 
> 赞同：1
> 
> 时间：2012-11-06T08:38:06.123
> 
> 标签：c, linux, sockets, networking, tcp

我正在尝试通过 TCP 套接字逐块发送数据。服务器代码执行以下操作：

```
#define CHECK(n) if((r=n) <= 0) { perror("Socket error\n"); exit(-1); }
int r;

//send the number of blocks
CHECK(write(sockfd, &(storage->length), 8)); //p->length is uint64_t

for(p=storage->first; p!=NULL; p=p->next) {
  //send the size of this block
  CHECK(write(sockfd, &(p->blocksize), 8)); //p->blocksize is uint64_t

  //send data
  CHECK(write(sockfd, &(p->data), p->blocksize));
} 
```

在客户端，我读取大小，然后读取数据（相同的 CHECK makro）：

```
CHECK(read(sockfd, &block_count, 8));
for(i=0; i<block_count; i++) {
  uint64_t block_size;
  CHECK(read(sockfd, &block_size, 8));

  uint64_t read_in=0;
  while(read_in < block_size) {
    r = read(sockfd, data+read_in, block_size-read_in); //assume data was previously allocated as char*
    read_in += r;
  }
} 
```

只要客户端和服务器都在同一台机器上运行，它就可以很好地工作，但是一旦我通过网络尝试它，它就会在某些时候失败。特别是，前 300-400 个块（à ~587 字节）左右工作正常，但随后我得到一个不正确的 block_size 读数：

```
received block #372 size : 586
read_in: 586 of 586
received block #373 size : 2526107515908 
```

然后它显然崩溃了。我的印象是 TCP 协议确保不会丢失任何数据并且以正确的顺序接收所有内容，但是考虑到它已经在本地工作，这怎么可能？我的错误是什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-06T08:45:02.220

不能保证当你阅读时`block_count`，`block_size`你会一口气读完所有 8 个字节。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-06T08:45:22.393

> 我的印象是 TCP 协议可确保不会丢失任何数据并且以正确的顺序接收所有内容

是的，但这就是 TCP 的全部保证。它不保证数据在单个数据包中发送和接收。您需要收集数据并将它们拼凑在缓冲区中，直到获得所需的块大小，然后再将数据复制出来。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-06T08:47:22.953

也许读取调用在没有读取完整的 8 个字节的情况下返回。我会检查他们报告他们阅读的长度。

您可能还会发现 valgrind 或 strace 信息丰富，可以更好地理解您的代码为何如此运行。如果你的读取时间很短，strace 会告诉你系统调用返回了什么，valgrind 会告诉你正在读取长度变量中未初始化的字节。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-11-10T07:13:12.377

它在同一台机器上工作的原因是 block_size 和 block_count 作为二进制值发送，当它们被客户端接收和解释时，它们具有相同的值。

但是，如果通信的两台机器使用不同的字节顺序来表示整数，例如 x86 与 SPARC，或者 sizeof(int) 不同，例如 64 位与 32 位，则代码将无法正常工作。

您需要验证两台机器的 sizeof(int) 和字节顺序是否相同。在服务器端，打印出 sizeof(int) 以及 storage->length 和 p->blocksize 的值。在客户端打印出 sizeof(int) 以及 block_count 和 block_size 的值。

当它不能正常工作时，我想你会发现它们不一样。如果这是真的，那么如果数据的内容包含任何二进制数据，它也会被误解。

# android - 如何仅在 Android 版本 4.0.3 的 Android Tabs2 上为我的应用程序隐藏 android 状态栏？

> ID：13247268
> 
> 赞同：1
> 
> 时间：2012-11-06T08:38:10.157
> 
> 标签：android, statusbar

任何人都可以告诉我任何方式来完全隐藏状态栏，只是为了我在所有活动中的应用程序。我的应用程序仅在 4.0.3 Android 的 android 选项卡上运行。我实际上想删除状态栏上的后退、主页和所有其他点击侦听器，或者只是完全隐藏它。这背后的要求是，如果我的应用程序在选项卡上启动，它会一直保持打开状态，直到用户关闭设备设备并且不应该有任何退出点。我将不胜感激您的谦虚回应。我添加了 android:theme="@android:style/Theme.Black.NoTitleBar.Fullscreen" manifest.xml。仍然无法禁用状态栏。我的活动课程如下

```
package com.plugin.myapp;
import org.apache.cordova.CordovaWebView;
import org.apache.cordova.CordovaWebViewClient;
import org.apache.cordova.DroidGap;
import org.apache.cordova.CordovaChromeClient;

import android.content.res.Configuration;
import android.os.Bundle;
import android.os.Handler;
import android.os.Message;
import android.view.View;
import android.view.Window;
import android.view.WindowManager;
import android.webkit.WebView;

public class MainActivity extends DroidGap  {
     private static MainActivity instance;

    // private WebView mWebView;
    @Override
    public void onCreate(Bundle savedInstanceState) {            
        super.onCreate(savedInstanceState);   
        super.init(); 

        //getWindow().getDecorView().setSystemUiVisibility(View.SYSTEM_UI_FLAG_LOW_PROFILE);
        getWindow().getDecorView().setSystemUiVisibility(View.STATUS_BAR_HIDDEN);
        super.loadUrl("file:///android_asset/www/tdc_tutorial.html");

    }
 // handler for the background updating
    Handler progressHandler = new Handler() 
    {
        public void handleMessage(Message msg) 
        {
            getWindow().setFlags(WindowManager.LayoutParams.FLAG_FULLSCREEN, WindowManager.LayoutParams.FLAG_FULLSCREEN);
        }
    };
    @Override
    public void onConfigurationChanged(Configuration newConfig) {
        // TODO Auto-generated method stub
        super.onConfigurationChanged(newConfig);

        System.out.println("onConfigurationChanged");
    }
  @Override
    public void init() {
    super.init((CordovaWebView) new WebView(this), new GWTCordovaWebViewClient(this), new CordovaChromeClient(this));
    }

   @Override
    public void onBackPressed() {
        // TODO Auto-generated method stub
        //super.onBackPressed();
    } 

   /* (non-Javadoc)
     * @see org.apache.cordova.DroidGap#onConfigurationChanged(android.content.res.Configuration)
     */

} 
```

我的 manifest.xml 在下面给出

```
<manifest xmlns:android="http://schemas.android.com/apk/res/android"
    package="com.plugin.myapp"
    android:versionCode="1"
    android:versionName="1.0" >

     <uses-sdk
        android:minSdkVersion="15"
        android:targetSdkVersion="15" />

    <uses-permission android:name="android.permission.VIBRATE" />
    <uses-permission android:name="android.permission.ACCESS_COARSE_LOCATION" />
    <uses-permission android:name="android.permission.ACCESS_FINE_LOCATION" />
    <uses-permission android:name="android.permission.ACCESS_LOCATION_EXTRA_COMMANDS" />
    <uses-permission android:name="android.permission.READ_PHONE_STATE" />
    <uses-permission android:name="android.permission.RECEIVE_SMS" />
    <uses-permission android:name="android.permission.RECORD_AUDIO" />
    <uses-permission android:name="android.permission.MODIFY_AUDIO_SETTINGS" />
    <uses-permission android:name="android.permission.READ_CONTACTS" />
    <uses-permission android:name="android.permission.WRITE_CONTACTS" />
    <uses-permission android:name="android.permission.WRITE_EXTERNAL_STORAGE" />
    <uses-permission android:name="android.permission.WRITE_INTERNAL_STORAGE" />
    <uses-permission android:name="android.permission.ACCESS_NETWORK_STATE" />
    <uses-permission android:name="android.permission.GET_ACCOUNTS" />
    <uses-permission android:name="android.permission.BROADCAST_STICKY" />
    <uses-permission android:name="android.permission.INTERNET" />
<supports-screens     
      android:largeScreens="true"    
      android:normalScreens="true"    
      android:smallScreens="true"  
      android:xlargeScreens="true"  
      android:resizeable="true"    
      android:anyDensity="true"

      /> 

    <application
        android:icon="@drawable/ic_launcher"
        android:label="Android Test"
        android:theme="@android:style/Theme.NoTitleBar.Fullscreen" > 

        <activity
            android:name=".MainActivity"
            android:label="@string/title_activity_main"            
            android:screenOrientation="sensorLandscape"
            android:configChanges="orientation">
            <intent-filter>
                <action android:name="android.intent.action.MAIN" />

                <category android:name="android.intent.category.LAUNCHER" />
            </intent-filter>
        </activity>
    </application>

</manifest> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-06T08:41:39.027

看看[ICS 的 GMD HideBar](http://forum.xda-developers.com/showthread.php?t=1769761)。我在我的 4.0.3 平板电脑上使用它，效果非常好！如果您使用 dex2jar 从 apk 文件中获取 jar，我可以在您的构建路径中导入 jar 文件并使用函数`SystemUI.hidebar`来隐藏或`SystemUI.showbar`显示 :)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-06T08:42:24.577

对于没有硬件密钥的设备，除非您“Root”设备，否则无法完全隐藏该栏。[但是，您可以使用setSystemUIVisiblity](http://developer.android.com/reference/android/view/View.html#setSystemUiVisibility%28int%29)将其置于“低调”模式。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-12-10T18:13:34.773

默认情况下，您**不应该**删除状态栏，因为它是 Android UI 中的一项服务。然后谷歌让你隐藏它，但是如果用户向上滑动它，它就会回来。

但是，是的，如果您在设备上具有 root 访问权限，**则可以这样做。**

此代码可以通过杀死它的进程并再次调用它来隐藏和显示状态栏。

```
package com.example.statusbar;

import android.app.Activity;
import android.os.Bundle;
import android.view.View;
import android.view.Window;
import android.view.WindowManager;
import android.widget.Button;

public class MainActivity extends Activity {

    String commandToExecute;

    @Override
    protected void onCreate(Bundle savedInstanceState) {

        super.onCreate(savedInstanceState);
        requestWindowFeature(Window.FEATURE_NO_TITLE);
        getWindow().setFlags(WindowManager.LayoutParams.FLAG_FULLSCREEN,
                WindowManager.LayoutParams.FLAG_FULLSCREEN);
        setContentView(R.layout.activity_main);

        commandToExecute = "/system/xbin/su";
        executeShellCommand(commandToExecute);

        Button btHideStatusBar = (Button) findViewById(R.id.buttonHide);
        Button btShowStatusBar = (Button) findViewById(R.id.buttonShow);

        btHideStatusBar.setOnClickListener(new View.OnClickListener() {

            @Override
            public void onClick(View v) {

                commandToExecute = "/system/xbin/su -c /system/bin/service call activity 42 s16 com.android.systemui";
                executeShellCommand(commandToExecute);

            }
        });

    btShowStatusBar.setOnClickListener(new View.OnClickListener() {

        @Override
        public void onClick(View arg0) {

            commandToExecute = "/system/xbin/su -c /system/bin/am startservice -n com.android.systemui/.SystemUIService";
            executeShellCommand(commandToExecute);

        }
    });

    }

    private boolean executeShellCommand(String command) {
        try {

            Runtime.getRuntime().exec(command);

            return true;
        } catch (Exception e) {
            return false;

        }
    }

} 
```

# c# - 将字符串转换为可空日期时间

> ID：13247273
> 
> 赞同：42
> 
> 时间：2012-11-06T08:38:26.390
> 
> 标签：c#, datetime, nullable

> **可能重复：**
> [如何将 DateTime.TryParse 与 Nullable<DateTime> 一起使用？](https://stackoverflow.com/questions/192121/how-do-i-use-datetime-tryparse-with-a-nullabledatetime)

我有这行代码

```
DateTime? dt = Condition == true ? (DateTime?)Convert.ToDateTime(stringDate) : null; 
```

这是将字符串转换为 Nullable DateTime 的正确方法，还是有直接的方法可以在不*将*其转换为 DateTime 并再次将其*转换*为 Nullable DateTime 的情况下进行转换？

* * *

## 回答 #1

> 赞同：78
> 
> 时间：2012-11-06T08:39:54.117

你可以试试这个： -

```
 DateTime? dt = string.IsNullOrEmpty(date) ? (DateTime?)null : DateTime.Parse(date); 
```

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2012-11-06T08:43:31.630

您可以构建一种方法来执行此操作：

```
public static DateTime? TryParse(string stringDate)
{
    DateTime date;
    return DateTime.TryParse(stringDate, out date) ? date : (DateTime?)null;
} 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-11-06T08:41:52.713

```
DateTime? dt = (String.IsNullOrEmpty(stringData) ? (DateTime?)null : DateTime.Parse(dateString)); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-11-06T08:43:21.083

简单地分配，根本没有演员:)

```
DateTime? dt = Condition == true ? Convert.ToDateTime(stringDate) : null; 
```

# sql-server - 用 sum 在 sql 中交叉应用

> ID：13247275
> 
> 赞同：0
> 
> 时间：2012-11-06T08:38:39.883
> 
> 标签：sql-server, sum, cross-apply

我有以下查询：

```
insert into [MyDB].[dbo].[Reports_ActivityStat] (ActivityID,TaskID,LS_HowOthersAnswered,LS_ImproveMyChances)
(
SELECT
ActivityID=tasks.ActivityID,
TaskID=tasks.ID,
CAST(
        CASE 
            WHEN CHARINDEX('stats',item.value('(UsedLifeSavers)[1]', 'NVARCHAR(MAX)'))>0
                THEN 1 
            ELSE 0 
        END AS bit) as LS_HowOthersAnswered,
CAST(
        CASE 
            WHEN CHARINDEX('FiftyFifty',item.value('(UsedLifeSavers)[1]', 'NVARCHAR(MAX)'))>0
                THEN 1 
            ELSE 0 
        END AS bit) as LS_ImproveMyChances

FROM  [MyDB].[dbo].[Tasks] as tasks CROSS APPLY [Progress].nodes ('//Progress/Steps/ProgressStep') Progress(item)
) 
```

它作用于下`Tasks`表：

```
 ID  |   ActivityID    |      Progress  
  1  |        1        |  [example below..]  
  2  |        1        |  [example below..] 
```

`Progress`这样的xml 在哪里：

```
<Progress xmlns:i="http://www.w3.org/2001/XMLSchema-instance">
  <Steps>
    <ProgressStep>
      <FinishedOn>2012-10-30T13:07:52.6374861+02:00</FinishedOn>
      <Score>0</Score>
      <StartedOn>2012-10-30T13:07:45.8234861+02:00</StartedOn>
      <Status>Finished</Status>
      <StepIndex>0</StepIndex>
      <StepType>Summary</StepType>
      <UsedLifeSavers xmlns:a="http://schemas.datacontract.org/2004/07/MindLab.Logic.Study" />
    </ProgressStep>
    <ProgressStep>
      <FinishedOn i:nil="true" />
      <PartNumber>1</PartNumber>
      <Score>0</Score>
      <StartedOn>2012-10-30T13:07:52.6374861+02:00</StartedOn>
      <Status>NotFinished</Status>
      <StepIndex>1</StepIndex>
      <StepType>Information</StepType>
      <SubmittedAnswersCount>0</SubmittedAnswersCount>
      <UsedLifeSavers xmlns:a="http://schemas.datacontract.org/2004/07/MindLab.Logic.Study">
        <a:LifeSavers>Stats</a:LifeSavers>
        <a:LifeSavers>FiftyFifty</a:LifeSavers>
      </UsedLifeSavers>
    </ProgressStep>  
  </Steps>
</Progress> 
```

（通常有超过 2 个步骤..）

我的查询产生（不是实际数据，只是样本）：

```
 ID  |   ActivityID    |   TaskID   |    LS_HowOthersAnswered   |   LS_ImproveMyChances
  1  |        1        |      1     |             0             |             0
  2  |        1        |      1     |             1             |             0  
  3  |        1        |      1     |             0             |             0 
```

这几乎是我需要的，但不完全是。
我需要所有唯一的`SUM`TaskID`LS_HowOthersAnswered`和`LS_ImproveMyChances`.
我试图分组，但没能成功，因为这与常规的内部连接太不同了..

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-06T11:31:12.350

发现：

```
insert into [MyDB].[dbo].[Reports_ActivityStat] (ActivityID,TaskID,LS_HowOthersAnswered,LS_ImproveMyChances)
(
SELECT
ActivityID=tasks.ActivityID,
TaskID=tasks.ID,    
SUM (CAST(
        CASE 
            WHEN CHARINDEX('stats',item.value('(UsedLifeSavers)[1]', 'NVARCHAR(MAX)'))>0
                THEN 1 
            ELSE 0 
        END AS int)
        ),

SUM (CAST(
        CASE 
            WHEN CHARINDEX('FiftyFifty',item.value('(UsedLifeSavers)[1]', 'NVARCHAR(MAX)'))>0
                THEN 1 
            ELSE 0 
        END AS int)
        )  

FROM  [MyDB].[dbo].[Tasks] as tasks CROSS APPLY [Progress].nodes ('//Progress/Steps/ProgressStep') Progress(item)
group by tasks.ID
) 
```

# proof - 证明小于和小于或等于 nat

> ID：13247276
> 
> 赞同：0
> 
> 时间：2012-11-06T08:38:40.860
> 
> 标签：proof, coq

假设以下定义（前两个取自[http://www.cis.upenn.edu/~bcpierce/sf/Basics.html](http://www.cis.upenn.edu/~bcpierce/sf/Basics.html)）：

```
Fixpoint beq_nat (n m : nat) : bool :=
  match n with
  | O => match m with
         | O => true
         | S m' => false
         end
  | S n' => match m with
            | O => false
            | S m' => beq_nat n' m'
            end
  end.

Fixpoint ble_nat (n m : nat) : bool :=
  match n with
  | O => true
  | S n' =>
      match m with
      | O => false
      | S m' => ble_nat n' m'
      end
  end.

Definition blt_nat (n m : nat) : bool :=
  if andb (ble_nat n m) (negb (beq_nat n m)) then true else false. 
```

我想证明以下几点：

```
Lemma blt_nat_flip0 : forall (x y : nat),
  blt_nat x y = false -> ble_nat y x = true.

Lemma blt_nat_flip : forall (x y : nat),
  blt_nat x y = false -> beq_nat x y = false -> blt_nat y x = true. 
```

我能做的最远的事情就是证明`blt_nat_flip`假设`blt_nat_flip0`。我花了很多时间，我快到了，但总的来说，它似乎比它应该的要复杂。有人对如何证明这两个引理有更好的想法吗？

到目前为止，这是我的尝试：

```
Lemma beq_nat_symmetric : forall (x y : nat),
  beq_nat x y = beq_nat y x.
Proof.
  intros x. induction x.
    intros y. simpl. destruct y.
      reflexivity. reflexivity.
    intros y. simpl. destruct y.
      reflexivity.
      simpl. apply IHx.
  Qed. 

Lemma and_negb_false : forall (b1 b2 : bool),
  b2 = false -> andb b1 (negb b2) = b1.
Proof. 
  intros. rewrite -> H. unfold negb. destruct b1.
    simpl. reflexivity.
    simpl. reflexivity.
  Qed.

Lemma blt_nat_flip0 : forall (x y : nat),
  blt_nat x y = false -> ble_nat y x = true.
Proof.
  intros x.
  induction x.
    intros. destruct y.
      simpl. reflexivity.
      simpl. inversion H.
    intros. destruct y. simpl. reflexivity.
    simpl. rewrite -> IHx. reflexivity. 
    (* I am giving up for now at this point ... *)
  Admitted.

Lemma blt_nat_flip : forall (x y : nat),
  blt_nat x y = false -> beq_nat x y = false ->
    blt_nat y x = true.
Proof.
  intros. 
  unfold blt_nat.
  rewrite -> beq_nat_symmetric. rewrite -> H0.
  rewrite -> and_negb_false.
  replace (ble_nat y x) with true.
  reflexivity. 
  rewrite -> blt_nat_flip0\. reflexivity. apply H. reflexivity.
  Qed. 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-06T10:32:58.593

`inversion`coq在`H`你归纳的最后一种情况下似乎有麻烦，但如果你`unfold blt_nat`以前，它似乎按预期工作。

# c# - WPF（C#）如何使用发布请求传输文件？

> ID：13247279
> 
> 赞同：4
> 
> 时间：2012-11-06T08:39:10.047
> 
> 标签：c#, wpf, httpwebrequest

我有一张以字节数组形式呈现的图片。我需要将其保存到文件并发送发布请求。告诉我如何做得更好

这是我所做的

```
private Stream file;

 public void Fun1()

  {

   using (file = IsolatedStorageHelper.OpenFile(Picture, FileMode.Create))

      {

       file.Write(bt, 0, bt.Length);
       _cookies = DataHolder.Instance.Cookies;
       HttpWebRequest request = (HttpWebRequest)WebRequest.Create(String.Concat("http://   Mysite.com/image.php?image=FILE",file));
            request.Method = "POST";
            request.ContentType = "multipart/form-data";
            request.CookieContainer = _cookies;     
            request.BeginGetRequestStream(new AsyncCallback(GetRequestStreamCallbackPlayersfun1), request);

      }

   }

 private void GetRequestStreamCallbackPlayersfun1(IAsyncResult asynchronousResult)

{

        HttpWebRequest request = (HttpWebRequest)asynchronousResult.AsyncState;
        Stream postStream = request.EndGetRequestStream(asynchronousResult);
 using (file = IsolatedStorageHelper.OpenFile(Picture, FileMode.Open))
        {

            BinaryReader br = new BinaryReader(file, Encoding.UTF8);
            byte[] buffer = br.ReadBytes(2048);
            while (buffer.Length > 0)
            {
                postStream.Write(buffer, 0, buffer.Length);
                buffer = br.ReadBytes(2048);
            }
        }
        postStream.Close();

        request.BeginGetResponse(new AsyncCallback(ReadCallbackSavePlayersfun1), request);

}

 private void ReadCallbackSavePlayersfun1(IAsyncResult asynchronousResult)

{

  lock (__SYNC)

{

    HttpWebRequest request = (HttpWebRequest)asynchronousResult.AsyncState;
                HttpWebResponse response = (HttpWebResponse)request.EndGetResponse(asynchronousResult);

            }
        } 
```

结果，服务器没有来，告诉我我做错了什么

* * *

感谢您的回复。

但我还有另一个问题。我的图片被编码在一个字符串中，我将字符串写入流并尝试发送到服务器。作为响应，一切正常，但请求的类型是“Get”（可变响应，方法 ReadCallbackSavePlayersfun1）。请告诉我怎么了

```
public void Fun1()

{

string str = "iVBORw0KGgoAAAANSUhEUgAAAGQAAABkCAYAAA";

using (file = IsolatedStorageHelper.OpenFile(Picture, FileMode.Create))

{
                StreamWriter w = new StreamWriter(file,Encoding.UTF8);
                w.WriteLine(str);
                 _cookies = DataHolder.Instance.Cookies;

                HttpWebRequest request = (HttpWebRequest)WebRequest.Create(String.Concat("http://Mysite.com/image.php"));
                string boundary = "----------" + DateTime.UtcNow.Ticks.ToString("x", CultureInfo.InvariantCulture);
                request.Method = "POST";
                request.ContentType = "multipart/form-data; boundary=" + boundary;
                request.CookieContainer = _cookies;

                request.BeginGetRequestStream(new AsyncCallback(GetRequestStreamCallbackPlayersfun1), request);
                w.Close();

             }

}

 private void GetRequestStreamCallbackPlayersfun1(IAsyncResult asynchronousResult)

 {

        HttpWebRequest request = (HttpWebRequest)asynchronousResult.AsyncState;
        Stream postStream = request.EndGetRequestStream(asynchronousResult);
 string boundary = "----------" + DateTime.UtcNow.Ticks.ToString("x", CultureInfo.InvariantCulture);
        var sbHeader = new StringBuilder();
        if (file != null)

 {
            sbHeader.AppendFormat("--{0}\r\n", boundary);
            sbHeader.AppendFormat("Content-Disposition: form-data; name=\"{0}\"; filename=\"{1}\"\r\n", "picture", file);
            sbHeader.AppendFormat("Content-Type: {0}\r\n\r\n", request.ContentType);

}
        using (file = IsolatedStorageHelper.OpenFile(Picture, FileMode.Open))

{
            byte[] header = Encoding.UTF8.GetBytes(sbHeader.ToString());
            byte[] footer = Encoding.UTF8.GetBytes("\r\n--" + boundary + "--\r\n");
            long contentLength = header.Length + (file != null ? file.Length : 0) + footer.Length;

            postStream.Write(header, 0, header.Length);
 if (file != null)

{

                BinaryReader br = new BinaryReader(file, Encoding.UTF8);
                byte[] buffer = br.ReadBytes(2048);
                while (buffer.Length > 0)

{
                    postStream.Write(buffer, 0, buffer.Length);
                    buffer = br.ReadBytes(2048);

 }
                br.Close();

}

            postStream.Write(footer, 0, footer.Length);
            postStream.Flush();
            postStream.Close();
}

 request.BeginGetResponse(new AsyncCallback(ReadCallbackSavePlayersfun1), request);

}

  private void ReadCallbackSavePlayersfun1(IAsyncResult asynchronousResult)

{
            lock (__SYNC)

{
                HttpWebRequest request = (HttpWebRequest)asynchronousResult.AsyncState;
                HttpWebResponse response = (HttpWebResponse)request.EndGetResponse(asynchronousResult);

                try

{
                    String doc = "";
                    using (Stream streamResponse = response.GetResponseStream())

 {
                        Encoding encode = System.Text.Encoding.GetEncoding("utf-8");
                        StreamReader readStream = new StreamReader(streamResponse, encode);
                        Char[] read = new Char[256];  
                        int count = readStream.Read(read, 0, 256);
                        while (count > 0)

{
                            String str = new String(read, 0, count);
                            doc += str;
                            count = readStream.Read(read, 0, 256);

}

}

}
                catch 
{ }

}

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-06T12:30:44.330

在 .Net 中发布 web byte[] 数据并不是那么简单。将 a 保存`byte[]`到存储器很容易，因此我不会为此编写代码，但这是我用来发布二进制数据的方法。

这最初来自[http://skysanders.net/subtext/archive/2010/04/12/c-file-upload-with-form-fields-cookies-and-headers.aspx](http://skysanders.net/subtext/archive/2010/04/12/c-file-upload-with-form-fields-cookies-and-headers.aspx)我的修改以适应

要获取 FileInfo，只需传入

```
new FileInfo(fullPath) 
```

祝你好运 ： ）

```
 /// <summary>
    /// Create a new HttpWebRequest with the default properties for HTTP POSTS
    /// </summary>
    /// <param name="url">The URL to be posted to</param>
    /// <param name="referer">The refer</param>
    /// <param name="cookies">CookieContainer that should be used in this request</param>
    /// <param name="postData">The post data</param>
    private string CreateHttpWebUploadRequest(string url, string referer, CookieContainer cookies, NameValueCollection postData, FileInfo fileData, string fileContentType)
    {
        var request = (HttpWebRequest)HttpWebRequest.Create(url);
        string boundary = "----------" + DateTime.UtcNow.Ticks.ToString("x", CultureInfo.InvariantCulture);

        // set the request variables
        request.Method = WebRequestMethods.Http.Post;
        request.ContentType = "multipart/form-data; boundary=" + boundary;
        request.CookieContainer = cookies;
        request.UserAgent = "Mozilla/5.0 (Windows; U; Windows NT 6.1; en-US) AppleWebKit/533.4 (KHTML, like Gecko) Chrome/5.0.375.55 Safari/533.4";
        request.Accept = "image/gif, image/jpeg, image/pjpeg, image/pjpeg, */*";
        request.Headers.Add("Accept-Encoding: gzip,deflate");
        request.AutomaticDecompression = DecompressionMethods.Deflate | DecompressionMethods.GZip;
        request.Headers.Add("Accept-Language: en-us");
        request.Referer = referer;
        request.KeepAlive = true;
        request.AllowAutoRedirect = false;

        // process through the fields
        var sbHeader = new StringBuilder();

        // add form fields, if any
        if (postData != null)
        {
            foreach (string key in postData.AllKeys)
            {
                string[] values = postData.GetValues(key);
                if (values != null) 
                {
                    foreach (string value in values)
                    {
                        if (!string.IsNullOrEmpty(value))
                            sbHeader.AppendFormat("--{0}\r\n", boundary);
                            sbHeader.AppendFormat("Content-Disposition: form-data; name=\"{0}\";\r\n\r\n{1}\r\n", key, value);
                    }
                }
            }
        }

        if (fileData != null)
        {
            sbHeader.AppendFormat("--{0}\r\n", boundary);
            sbHeader.AppendFormat("Content-Disposition: form-data; name=\"{0}\"; filename=\"{1}\"\r\n", "media", fileData.Name);
            sbHeader.AppendFormat("Content-Type: {0}\r\n\r\n", fileContentType);
        }

        byte[] header = Encoding.UTF8.GetBytes(sbHeader.ToString());
        byte[] footer = Encoding.UTF8.GetBytes("\r\n--" + boundary + "--\r\n");
        long contentLength = header.Length + (fileData != null ? fileData.Length : 0) + footer.Length;

        // set content length
        request.ContentLength = contentLength;

        // ref http://stackoverflow.com/questions/2859790/the-request-was-aborted-could-not-create-ssl-tls-secure-channel
        // avoid The request was aborted: Could not create SSL/TLS secure channel exception
        ServicePointManager.Expect100Continue = false;
        ServicePointManager.SecurityProtocol = SecurityProtocolType.Ssl3;

        using (var requestStream = request.GetRequestStream())
        {
            requestStream.Write(header, 0, header.Length);

            // write the uploaded file
            if (fileData != null)
            {
                // write the file data, if any
                byte[] buffer = new Byte[fileData.Length];
                var bytesRead = fileData.OpenRead().Read(buffer, 0, (int)(fileData.Length));
                requestStream.Write(buffer, 0, bytesRead);
            }

            // write footer
            requestStream.Write(footer, 0, footer.Length);
            requestStream.Flush();
            requestStream.Close();

            using (var response = request.GetResponse() as HttpWebResponse)
            using (var stIn = new System.IO.StreamReader(response.GetResponseStream()))
            {
                return stIn.ReadToEnd();
            }
        }
    } 
```

# iphone - 使用sqlite3删除iphone sdk中表中的所有记录

> ID：13247283
> 
> 赞同：-2
> 
> 时间：2012-11-06T08:39:19.427
> 
> 标签：iphone, database, sqlite

**编辑：-**这就是我的工具：-

```
- (void) Delete_LoginData {
    sqlite3 *database;
    if(sqlite3_open([self.databasePath UTF8String], &database) == SQLITE_OK)
    {
        const char *sql = "DELETE FROM Login";
        sqlite3_stmt *statement;
        if(sqlite3_prepare_v2(database, sql,-1, &statement, NULL) == SQLITE_OK)
        {
            sqlite3_reset(statement);
        }       
    }
} 
```

我想一键删除数据库中的所有行。我实现了以下方法：-

```
- (void) Delete_LoginData {
        sqlite3 *database;
        if(sqlite3_open([self.databasePath UTF8String], &database) == SQLITE_OK) {
            const char *sql = "DELETE * FROM Login";
            sqlite3_stmt *statement;

            statement = [self PrepareStatement:sql];    
          //  int a1 = sqlite3_bind_int(statement, 1, 1);

            sqlite3_step(statement);
            sqlite3_reset(statement);
        }       
    }

    -(sqlite3_stmt*) PrepareStatement:(const char *)sql{
        // Setup the database object
        sqlite3 *database;
        // Init the animals Array

        // Open the database from the users filessytem
        if(sqlite3_open([self.databasePath UTF8String], &database) == SQLITE_OK) {
            // Setup the SQL Statement and compile it for faster access
            const char *sqlStatement = sql;
            sqlite3_stmt *compiledStatement;

            if(sqlite3_prepare_v2(database, sqlStatement,-1, &compiledStatement, NULL) == SQLITE_OK) {
                //NSLog(@"COMPILED STATEMENT: %@",compiledStatement);
                return compiledStatement;

            }
        }
        return nil;
    } 
```

但它不起作用。我得到这个语句的 0X0 = [self PrepareStatement:sql]; 在 delete_logindata 方法中。

如何解决这个问题。有什么解决方案吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-06T08:48:46.070

请更改您的方法，例如：

```
- (void) Delete_LoginData
{
        sqlite3 *database;
        if(sqlite3_open([self.databasePath UTF8String], &database) == SQLITE_OK)
        {
            const char *sql = "DELETE FROM Login";
            sqlite3_stmt *statement;
             if(sqlite3_prepare_v2(database, sql,-1, &statement, NULL) == SQLITE_OK)
             {
               sqlite3_step(statement);
             }       
         }
} 
```

在您的代码中，您打开数据库两次。在第二种方法中，您正在打开一个已经打开的数据库！我不知道这是否是实际问题，但我建议不要这样做。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-06T08:49:55.380

写`const char *sql = "DELETE FROM Login"`；代替`const char *sql = "DELETE * FROM Login";`

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-06T09:00:44.453

改变你的 const char*sql

```
const char *sql = "DELETE * FROM Login"; 
```

用这个改变上面

```
const char *sql = "DELETE FROM Login"; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-06T10:02:01.123

我不知道它的正确答案是什么。但我可以建议你这个链接 [http://klanguedoc.hubpages.com/hub/IOS-5-SDK-Database-Insert-Update-Delete-with-SQLite-and-Objective-CC-How-To](http://klanguedoc.hubpages.com/hub/IOS-5-SDK-Database-Insert-Update-Delete-with-SQLite-and-Objective-C-C-How-To) 可能会帮助你。

# ruby - 在 Ruby 中将 Time 类对象转换为 RFC3339

> ID：13247288
> 
> 赞同：10
> 
> 时间：2012-11-06T08:39:34.377
> 
> 标签：ruby, time, iso

[Google Calendar API(v2)](https://developers.google.com/google-apps/calendar/v2/developers_guide_protocol)的时间相关查询需要采用 RFC3339 格式。当我在'需要“时间”'之后查找时间类时，我看不到 rfc3339 方法。

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2014-11-05T23:41:57.763

如果您使用 ActiveRecord，则可以使用该`to_datetime`方法将时间转换为`DateTime`对象。

```
Time.now.to_datetime.rfc3339 #=> "2014-11-06T10:40:54+11:00" 
```

请参阅：
[http](http://www.ruby-doc.org/stdlib-2.4.1/libdoc/date/rdoc/Time.html) ://www.ruby-doc.org/stdlib-2.4.1/libdoc/date/rdoc/Time.html 。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-11-06T08:43:07.940

这有帮助吗？[http://www.ruby-doc.org/stdlib-1.9.3/libdoc/date/rdoc/DateTime.html#method-i-rfc3339](http://www.ruby-doc.org/stdlib-1.9.3/libdoc/date/rdoc/DateTime.html#method-i-rfc3339)

```
DateTime.parse('2001-02-03T04:05:06.123456789+07:00').rfc3339(9)
                          #=> "2001-02-03T04:05:06.123456789+07:00" 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2013-08-15T06:15:40.993

我选择这样做的方式`Time.now.utc.strftime('%FT%TZ')` `#=> "2013-08-15T06:13:28Z"`非常适合 HTML5`type='datetime'`输入字段。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-06T08:39:34.377

[一个网站](http://info.michael-simons.eu/2008/11/01/ruby-formatting-time-values-as-rfc3339/)提到RFC3339是RSS提要中最常见的日期格式，因此转换方法实现为#xmlschema，而不是#rfc3339。

# c# - 带有文件上传字段的 Ext 表单（提交后响应）

> ID：13247295
> 
> 赞同：0
> 
> 时间：2012-11-06T08:39:54.710
> 
> 标签：c#, asp.net-mvc, extjs

真的不明白哪里错了。。

我有一个带有文件上传字段的表单。请求发送良好，我的控制器上的操作获取所有参数，使用它们，并向浏览器发送响应。但是在html页面中，提交表单后，总是触发FAILURE事件，并且永远不会成功。

客户端代码

```
Ext.create('Ext.form.Panel', {
        renderTo: 'Container',
        bodyPadding: '10 10 0',
        items: [
        {
            xtype: 'form',
            width: 300,
            border: false,
            fileUpload: true,
            items: [
            {
                xtype: 'combobox',
                id: 'PayTypes',
                width: 215,
                store: PayTypesStore,
                valueField: 'id',
                displayField: 'Name',
                editable: false,
                name: 'id'
            }
            ,
            {
                xtype: 'filefield',
                id: 'form-file',
                name: 'file',
                buttonText: '',
                buttonConfig: {
                    iconCls: 'upload-icon'
                }
            }
            ],
            buttons: [
            {
                text: 'Send',
                handler: function () {
                    var form = this.up('form').getForm();
                    if (form.isValid()) {
                        form.submit({
                            url: 'UploadFile',
                            waitMsg: 'Uploading your photo...',
                            success: function (fp, o) {
                                console.log("success");
                                msg('Success', 'Processed file on the server');
                            },
                            failure: function (form, action) {
                                console.log(action);
                                Ext.Msg.alert('Failed', action.result ? action.result.message : 'No response');
                            }
                        });
                    }
                }
            }
            ]
        }
        ]
    }); 
```

服务器端代码：

```
public JsonResult UploadFile(HttpPostedFileWrapper file, int id)
    {
        var response = Json(new { success = true });
        response.ContentType = "text/html";

        return Json(response);
    } 
```

响应，在客户端收到：

```
{"ContentEncoding":null,"ContentType":"text/html","Data":"success":true},"JsonRequestBehavior":1,"MaxJsonLength":null,"RecursionLimit":null} 
```

我需要在我的代码中修复什么以在 sumniting 表单后获得 SUCCESS 事件？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-06T08:47:27.260

你调用`Json`了两次方法。你唯一需要的是

```
public JsonResult UploadFile(HttpPostedFileWrapper file, int id)
{
    return Json(new { success = true });
} 
```

# javascript - 将随机类添加到 div

> ID：13247300
> 
> 赞同：2
> 
> 时间：2012-11-06T08:40:11.213
> 
> 标签：javascript, jquery, random

目前在我的游戏中，当它完成时，一个随机图像被传递给“显示包装器”以显示在最后。

我仍然想这样做，但我不想这样做，而是每次都向“revael-wrapper”添加一个随机类，以使其成为“.reveal-wrapper .image1”。将有 5 个不同的图像，我希望它每次随机选择一个。

目前它的代码如下：

```
$(document).ready(function () {
    bgImageTotal = 5;
    randomNumber = Math.round(Math.random() * (bgImageTotal - 1)) + 1;
    imgPath = ('images/reward-images/' + randomNumber + '.png');
    $('.reveal-wrapper').css('background-image', ('url("' + imgPath + '")'));
}); 
```

有什么想法可以添加一个随机类吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-06T08:42:23.127

你已经有了逻辑，你只需要添加类。试试这个：

```
$(document).ready(function () {
    bgImageTotal = 5;
    randomNumber = Math.round(Math.random() * (bgImageTotal - 1)) + 1;
    $('.reveal-wrapper').addClass('image' + randomNumber);
}); 
```

然后你需要做的就是在你的 CSS 中设置类：

```
.image1 { background-image: url('images/reward-images/1.png'); }
.image2 { background-image: url('images/reward-images/2.png'); }
.image3 { background-image: url('images/reward-images/3.png'); }
.image4 { background-image: url('images/reward-images/4.png'); }
.image5 { background-image: url('images/reward-images/5.png'); } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-06T08:42:41.403

由于您已经有了随机数，并且您的图像具有相同的文件名结构（image1、image2 等）

```
$('.reveal-wrapper').addClass('image' + randomNumber); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-06T08:46:45.470

Rory 有一个很好的解决方案，但如果你很好奇，这里有一些更通用的东西：

```
function add_rand_class (classes, elem) {
  $(elem).addClass(classes[Math.random() * classes.length >> 0]);
} 
```

向函数传递一个类字符串数组和你想要类的元素，你就可以开始了。

# javascript - 用于在网站中验证用户的 HTML 编码

> ID：13247304
> 
> 赞同：0
> 
> 时间：2012-11-06T08:40:22.413
> 
> 标签：javascript, html, authentication

我对是否可以使用 html 编码对用户进行身份验证有疑问？如果是，我希望 html 脚本在我的网站中对用户进行身份验证。或者告诉我提供免费用户认证的网站就足够了。

关于阿南德

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-06T08:43:31.567

您不能使用纯 HTML 来创建身份验证系统，出于安全原因，使用客户端 JavaScript 也不是一个好主意。为了使身份验证系统可靠，您必须使用某种服务器端语言，如 ASP.NET、PHP、Ruby 或类似语言。

如果您不想自己动手，有很多 CMS 解决方案都具有内置身份验证功能。您可以选择像[Wordpress](http://wordpress.com/)这样的托管解决方案，也可以选择您喜欢的任何 CMS 解决方案并自行托管。

这里有一些可供选择：

*   [http://www.orchardproject.net/](http://www.orchardproject.net/) (ASP.NET)
*   [http://drupal.org/](http://drupal.org/) (PHP)
*   [http://wordpress.org/](http://wordpress.org/) (PHP)

[Microsoft 还为Azure 网站](https://www.windowsazure.com/en-us/home/scenarios/web-sites/)提供免费托管解决方案，他们为大量 CMS 解决方案提供简单的点击设置服务，包括上面提到的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-06T08:44:57.203

使用 javascript 进行密码和用户名身份验证是一个非常糟糕的主意，任何人都可以通过您的 html 文件或 js 文件绕过它。您应该使用 PHP 和 PDO 或 mySqli 对用户进行身份验证。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-06T08:46:56.553

```
HyperText Markup Language (HTML) is the main markup language for displaying web pages and other information that can be displayed in a web browser. 
```

HTML 只是用来为用户输出一些东西。您无法使用 HTML 制作身份验证系统。

最好和最简单的身份验证方法是将 HTML 与 PHP 结合起来。您也可以使用任何其他`server side programming language`.

您可以查看非常可靠的 PHP 登录系统。您当然可以获取可以按原样使用的代码片段。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-06T08:47:00.103

HTML 是不可能的，OpenID 怎么样？

# ios - 通过 NSUserDefaults 设置 ios UserAgent：工作一半？

> ID：13247305
> 
> 赞同：3
> 
> 时间：2012-11-06T08:40:23.067
> 
> 标签：ios, uiwebview, user-agent

这真让我抓狂。我有两个只是 UIWebViews 的应用程序，使用 XCode 4.5.2 和 iOS 6.0 SDK。我想更改网络调用的 UserAgent。我在这两个中都使用了这个代码：

```
NSString *secretagent = @"MyUserAgent";
NSDictionary *dictionary = [[NSDictionary alloc]
    initWithObjectsAndKeys:secretAgent, @"UserAgent", nil];
[[NSUserDefaults standardUserDefaults] registerDefaults:dictionary]; 
```

根据我对网络日志的扫描，让我感到沮丧的是，它在一个中起作用，而不在另一个中起作用。根据我对 objectsForKey:@"UserAgent" 的检查，一个不起作用的仍然是更改 UserAgent 密钥。只是网络请求实际上没有任何变化。

有任何想法吗？现在是凌晨 3 点 30 分，我只是想不通...

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-06T18:41:03.697

弄清楚了。初始化 webview 后，您无法更改用户代理。在初始化 webview 之前，我将代码移动到 viewDidLoad，它可以工作。

# matlab - 二维积分

> ID：13247307
> 
> 赞同：1
> 
> 时间：2012-11-06T08:40:32.320
> 
> 标签：matlab, vectorization, integral

我想我有一个直截了当的问题要回答。

我有这段代码：

```
clc, clear all, close all

Nx = 8192;
Ny = 16;
Nz = 16;
delta = 6;
UHub = 11.4;
IECturbC = 'A';
HubHt = 90;

%%INITIALISATION

% definition of constants
twopi=2*pi;
%constants and derived parameters from IEC
gamma = 3.9; %IEC, (B.12)
alpha = 0.2; %IEC, sect. 6.3.1.2

%set delta1 according to guidelines (chap.6)
if HubHt<=60,
    delta1=0.7*HubHt;
else
    delta1=42;
end;

%IEC, Table 1, p.22
if IECturbC == 'A',
    Iref=0.16;
elseif IECturbC == 'B',
    Iref=0.14; 
elseif IECturbC == 'C',
    Iref=0.12;
else
    error('IECturbC can be equal to A,B or C;adjust the input value')
end;

%IEC, sect. 6.3.1.3
b=5.6;
sigma1=Iref*(0.75*UHub+b);
sigma2=0.7*sigma1;
sigma3=0.5*sigma1;
%derived constants
l=0.8*delta1; %IEC, (B.12)
sigmaiso=0.55*sigma1; %IEC, (B.12)

Cij2=zeros(3,3,Nx,Ny,Nz);
ikx=cat(2,-Nx/2:-1,1:Nx/2-1);
[x y z]=ndgrid(ikx,1:Ny,1:Nz);
k1=(x)*l/(Nx*delta)*twopi;
k2=(y-Ny/2)*l/(Ny*delta)*twopi;
k3=(z-Nz/2)*l/(Nz*delta)*twopi;
kabs=sqrt(k1.^2+k2.^2+k3.^2);
beta= gamma./((kabs.^(2/3).*(hypergeometric2f1(1/3, 17/6,4/3,-kabs.^(-2),11))).^(0.5));
k03=k3+beta.*k1;
k0abs=sqrt(k1.^2+k2.^2+k03.^2);
Ek0=1.453*k0abs.^4./(1+k0abs.^2).^(17/6);
C1=beta.*k1.^2.*( k0abs.^2 - 2*k03.^2 + beta.*k1.*k03 )./( kabs.^2.*( k1.^2 + k2.^2 ));
C2=k2.*k0abs.^2./ (exp( (3/2).*log( k1.^2 + k2.^2 ) )) .* atan2( beta.*k1.* sqrt( k1.^2 + k2.^2 ) ,( k0abs.^2 - k03.*k1.*beta));
xhsi1=C1 - k2.*C2./k1;
xhsi2=k2.*C1./k1 + C2;
CC=sigmaiso*sqrt(twopi*pi*l^3.*Ek0./(Nx*Ny*Nz*delta^3.*k0abs.^4)); 
```

然后，我定义

```
phi_11 = (Ek0./4*pi.*kabs.^4).*(k0abs.^2 - k1.^2 - 2*k1.*k03.*xhsi1 + (k1.^2 + k2.^2).*xhsi1.^2); 
```

现在我想执行这个积分

![在此处输入图像描述](../Images/b482e62542b6fb009adb05451614c4fd.png)

用 phi_11 代替 phi_ii。

我如何在 Matlab 中执行它，因为我有所有矢量化变量？

我预先感谢您的支持。

WKR，弗朗切斯科

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-06T09:01:24.510

我没有`hypergeometric2f1`（函数？变量？），所以我无法测试这个。

无论如何，解决这个问题的正常方法是这样定义`phi_11`：

```
phi_11 = @(k1,k2) (Ek0./4*pi.*kabs.^4).*(k0abs.^2 - k1.^2 - 2*k1.*k03.*xhsi1 + (k1.^2 +  k2.^2).*xhsi1.^2); 
```

然后使用双正交方法：

```
F_11 = dblquad(phi_11, -inf,inf, -inf,inf); 
```

您可能需要调整一大堆变量，因为`k1`和的`k2`尺寸会相当随意（`dblquad`是一种自适应方法，它将在取决于函数的局部行为的点处评估函数）。

# matlab - 高斯混合（EM）如何计算责任

> ID：13247310
> 
> 赞同：0
> 
> 时间：2012-11-06T08:41:05.363
> 
> 标签：matlab, machine-learning, gaussian

我有一个任务是在 matlab 中用 EM 实现 MoG。那作业： ![在此处输入图像描述](../Images/e2f6ca8237a52c13df19f1b032ddfd32.png)

我的自动取款机；

```
clear
clc

load('data2')

%% INITIALIZE
K = 20
pi =  0.01:((1-0.01)/K):1;
for k=1:20
    sigma{k} = eye(2);
    mu(k,:) = [rand(1),rand(1)];
end

%% Posterior over the laten variables
addition = 0;

for k =1:20 
    addition = addition + (pi(k)*mvnpdf(x,mu(k,:), sigma{k}));
end
test = 0;
for k =1:20 
   gamma{k} =  (pi(k)*mvnpdf(x,mu(k), sigma{k})) ./ addition;  
end 
```

数据有 1000 行和 2 列（所以 1000 个数据点）。我现在的问题是如何计算责任。当我尝试计算协方差矩阵时，我得到一个 1x1000 矩阵。虽然我相信协方差矩阵应该是 2x2。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-06T11:29:12.303

不幸的是，我不会说 Matlab，所以我真的看不出你的代码在哪里不正确，但我可以大致回答（也许知道 Matlab 的人可以看看你的代码是否可以挽救）。每个数据点都有一个与之关联的 gamma，它是混合物中每个成分的指示变量的期望值。计算它们非常简单：对于第 i 个数据点和第 k 个分量，gamma_ik 只是第 i 个点的第 k 个分量的密度乘以第 k 个混合系数（先验概率该点来自第 k 个组件，即您的作业中的 pi），通过在所有 k 上计算的这个数量进行归一化。因此，对于每个数据点，您都有一个总和为 1 的职责向量（长度为 k）。

# ruby-on-rails - 限制开发人员对网站 git 存储库的访问以及如何部署它

> ID：13247313
> 
> 赞同：0
> 
> 时间：2012-11-06T08:41:19.757
> 
> 标签：ruby-on-rails, git, capistrano, web-deployment

我正在考虑为我的基于 Rails 的网站聘请一位新开发人员，但由于我不认识他们，我不希望他们对我的代码具有完全的读取权限。我只希望他们能够读取和写入一个目录。

**要求：**

我也希望他们能够部署他们的更新/更改。

我自己和开发人员都使用 Windows，所以符号链接不是一个好主意......

我目前使用 capistrano 来部署网站，但将使用 vlad 或其他任何可行的方法......

**背景阅读**

所以，我一直在阅读有关子模块、子树（apenwarr 的 git-subtree 和子树合并策略）、giternal、活塞、编织等的内容，我完全一头雾水！任何可以提供的帮助将不胜感激！

**我现在的想法**

我认为**子模块**在这里不是正确的选择，因为：

1）我想对主存储库进行尽可能少的更改

2）i）开发人员需要访问主存储库以通知它子模块的更改......这违背了使它们与子模块一起工作的目的。

ii）我可以创建一个主存储库来引用网站的划分部分，但我不知道如何做到这一点，或者它是否可以工作。

**子树**

如果我理解正确，有人可以在子树上工作并提交它，就好像他们只能完全访问主存储库的那部分一样。乍一看，这似乎使它们完全符合我的需要 - 特别是因为主存储库默认情况下可以引用子树的当前 HEAD 并且不需要手动更新。不幸的是，我看不到如何使用子树部署网站，也无法判断这是否真的是我想要的。关于子模块、子树等有很多相互矛盾的意见，很难对其进行分类。

非常感谢您花时间阅读本文以及您可以提供的任何帮助！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-06T09:05:22.030

子模块：2）通过电子邮件或基于网络的系统向您发送“拉取请求”。

# android - CountdownTimer 暂停和恢复功能

> ID：13247315
> 
> 赞同：1
> 
> 时间：2012-11-06T08:41:30.763
> 
> 标签：android, countdown, countdowntimer

我根据在 Google 中搜索的教程创建了一个倒数计时器。但我无法恢复倒计时。当我按下按钮时，它将从 10 点再次重新启动。

我想创建一个能够暂停和恢复的倒数计时器。谢谢！这是我的代码：

```
import android.app.Activity;
import android.os.Bundle;
import android.os.CountDownTimer;
import android.view.View;
import android.view.View.OnClickListener;
import android.widget.Button;
import android.widget.TextView;

public class TimerC extends Activity {
Button btns;
    TextView tv;

  @Override
  public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_timer_c);

    btns = (Button)findViewById(R.id.btnstartpause);
    tv  = (TextView)findViewById(R.id.tv);
    tv.setText("10"); 
    btns.setText("Start");

    final MyCounter timer = new MyCounter(10000,1000);

  btns.setOnClickListener(new OnClickListener() {
        @Override
        public void onClick(View v) {

            if (btns.getText()== "Start")
            {
                timer.start();  

                btns.setText("Pause");
            }
            else if (btns.getText()== "Pause")
            {
                btns.setText("Start");
                timer.cancel();                 
            }
        }
    });    
}

public class MyCounter extends CountDownTimer{

    public MyCounter(long millisInFuture, long countDownInterval) {
        super(millisInFuture, countDownInterval);
    }

    @Override
    public void onFinish() {
        System.out.println("Timer Completed.");
        tv.setText("Timer Completed.");
    }

    @Override
    public void onTick(long millisUntilFinished) {
        tv.setText((millisUntilFinished/1000)+"");
        System.out.println("Timer  : " + (millisUntilFinished/1000));
    }
  }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-06T09:31:13.230

`millisUntilFinished`将时间值保存`onTick`在类属性中。当您想重新启动计时器时，使用此值作为第一个参数重新实例化它，如下所示：
**编辑：**
将计时器设置为类属性：

```
private MyCounter timer; 
```

并将侦听器更改为此：

```
btns.setOnClickListener(new OnClickListener() {
    @Override
    public void onClick(View v) {

        if (btns.getText().equals("Start"))
        {
            timer = new MyCounter(remainingTime, 1000);
            timer.start();  

            btns.setText("Pause");
        }
        else if (btns.getText().equals("Pause"))
        {
            btns.setText("Start");
            timer.cancel();                 
        }
    }
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-06T09:27:53.137

你的问题应该是这里的字符串比较：

```
 btns.setOnClickListener(new OnClickListener() {
    @Override
    public void onClick(View v) {

        if (btns.getText()== "Start")
        {
            timer.start();  

            btns.setText("Pause");
        }
        else if (btns.getText()== "Pause")
        {
            btns.setText("Start");
            timer.cancel();                 
        }
    }
}); 
```

您应该使用 object.equals(otherObject) 因为 == 运算符比较引用而不是值。例子：

```
 btns.setOnClickListener(new OnClickListener() {
    @Override
    public void onClick(View v) {

        if (btns.getText().equals("Start"))
        {
            timer.start();  

            btns.setText("Pause");
        }
        else if (btns.getText().equals("Pause"))
        {
            btns.setText("Start");
            timer.cancel();                 
        }
    }
}); 
```

# json - 块中的 MODX MIGX 数据

> ID：13247317
> 
> 赞同：0
> 
> 时间：2012-11-06T08:41:35.523
> 
> 标签：json, modx, modx-revolution, modx-chunks

我创建了与此类似的表 [http://rtfm.modx.com/display/ADDON/MIGX.Simple+opening+hours+table](http://rtfm.modx.com/display/ADDON/MIGX.Simple+opening+hours+table)

我已成功将数据导出到资源，但我想将它显示在一个块中，以便我可以在 getresources 中显示它。

我使用 getresources 来显示资源，除了标题和介绍文本之外，我还想显示 datesTV 数据。

我将模板块用于 Migx：

```
 [[+date:notempty=`<td>[[+date:strtotime:date=`%d.%m.%Y, %H.%M`]]</td>`:default=`<td colspan="2">No show!</td>`]] 
```

如果我在 getresources [[+tv.datesTV]] 的其他块中使用它，我会得到这个数组：

```
 [{"MIGX_id":"1","date":"2012-10-28 21:00:00"},{"MIGX_id":"2","date":"2012-10-28 01:45:00"},{"MIGX_id":"3","date":"2012-10-30 02:45:00"}] 
```

我怎样才能显示这些数据，因为它应该是一个块。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-19T13:32:11.440

好的，您可以在这里看到我的代码片段的样子..

```
<?php
$strJSON = $modx->resource->getTVValue('spored');
$arrJSON = $modx->fromJSON($strJSON);

foreach($arrJSON as $arrJSONDataSet)
{
  foreach($arrJSONDataSet as $key => $value)
 {
    echo $key . ' => ';
    echo $value;
    echo '<br />';
  }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-09T06:06:29.863

使用 MIGX，您需要一个片段来解析和格式化存储为 JSON 的原始电视数据。

有关如何执行此操作的粗略示例，请返回您提到的链接并尝试 getImageList 片段： [http ://rtfm.modx.com/display/ADDON/MIGX.Simple+opening+hours+table#MIGX.Simpleopeninghourstable -解析数据](http://rtfm.modx.com/display/ADDON/MIGX.Simple+opening+hours+table#MIGX.Simpleopeninghourstable-ParsingtheData)

您需要在 getResources 块中包含该片段调用，这将非常低效；最好编写一个自定义片段来检索必要的数据。

但先看看它是如何进行的......

# java - Android视图手势旋转“轻松”和固定度数

> ID：13247318
> 
> 赞同：2
> 
> 时间：2012-11-06T08:41:37.187
> 
> 标签：java, android, rotation, gesture

我正在尝试通过使用[此](http://mobile.tutsplus.com/tutorials/android/android-sdk-creating-a-rotating-dialer/)示例来开发类似主菜单活动的轮子，但我想让这个旋转视图仅停止在 36 度及其乘数（我将通过将 10 个项目（按钮）除以 10 个相等的部分将其放在圆圈上） .我试图实现 pid 控制器算法，但无法管理它。请有人指出正确的方向来做到这一点。谢谢（对不起我的英语不足）

我想要这个轮停止像 android 画廊。

# c# - 问题序列化/反序列化具有双值的自定义对象

> ID：13247326
> 
> 赞同：0
> 
> 时间：2012-11-06T08:42:01.950
> 
> 标签：c#, .net

试图反序列化这个类的一个实例

```
[Serializable]
public class InstalledMeter : ISerializable 
{
    public string Description { get; set; }

    public double Latitude { get; set; }
    public double Longitude { get; set; }

    public void GetObjectData(SerializationInfo info, StreamingContext context)
    {
        info.AddValue("Description", Description);
        info.AddValue("Latitude", Latitude);
        info.AddValue("Longitude", Longitude);
    }
} 
```

实例：

```
new InstalledMeter {Description = "Something", Latitude = 0.0, Longitude = 0.0}; 
```

我的序列化方法

```
public static class SerializeString
{
    public static string SerializeObject<T>(this T toSerialize)
    {
        var xmlSerializer = new XmlSerializer(toSerialize.GetType());
        var textWriter = new StringWriter();

        xmlSerializer.Serialize(textWriter, toSerialize);
        return textWriter.ToString();
    }

    public static T XmlDeserializeFromString<T>(this string objectData)
    {
        return (T)XmlDeserializeFromString(objectData, typeof(T));
    }

    public static object XmlDeserializeFromString(string objectData, Type type)
    {
        var serializer = new XmlSerializer(type);
        object result;

        using (TextReader reader = new StringReader(objectData))
        {
            result = serializer.Deserialize(reader);
        }

        return result;
    }
} 
```

但是当我序列化对象时，它具有这些值 ![在此处输入图像描述](../Images/d127d659f3359667d28587b82c62d49c.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-06T10:19:38.977

（根据您之前的问题猜测答案 -[将参数传递给 mvvmcross viewmodels 时出错](https://stackoverflow.com/questions/13230528/error-passing-parameters-to-mvvmcross-viewmodels)）

如果您在 MvvmCross 中执行此操作，那么我将完全避免这个 xml 问题，而只使用 JSON 序列化

```
 var jsonText = JSONConvert.SerializeObject(installedMeter); 
```

和

```
 var installedMeter = JSONConvert.DeserializeObject<InstalledMeter>(jsonText); 
```

仅使用：

```
 public class InstalledMeter
    {
        public string Description { get; set; }
        public double Latitude { get; set; }
        public double Longitude { get; set; }
    } 
```

# c# - 如何将数据表转换为实体框架类？

> ID：13247328
> 
> 赞同：0
> 
> 时间：2012-11-06T08:42:20.017
> 
> 标签：c#, asp.net, entity-framework-4

我想运行一个存储过程（对于性能问题，我更喜欢存储过程），最后我想拥有像下面这样的模块。

你是否也认为为了实现这个存储过程是一个更好的解决方案？

![在此处输入图像描述](../Images/8d258230cf3cb4e363f9a188fa7ae8a6.png)

而且，如果我使用存储过程，我想保留我的 EF 结构。因此，我可能需要将`DataTable`存储过程转换为 EF 类结构。

.NET 是否有某种方法可以处理这种转换，还是我必须自己构建一些东西？

再一次，您真的认为使用**存储过程**执行此操作比**通过 EF 获取数据****更好**，并**在 ASP.NET C# 上开发一些算法以使其看起来像**我上传的图片上的那个吗？如果您还可以提供***WHY***，那将是非常棒的。

 *****非常感谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-06T09:22:42.850

为什么要将 DataTable 转换为 EF 实体？您不必使用 DataTable 从存储过程中获取结果，您可以直接从存储过程中检索 EF 对象

看看这篇文章

[实体框架中的存储过程](http://msdn.microsoft.com/en-us/data/gg699321.aspx)*****

# c# - 将十进制转换为不太准确的整数作为字符串

> ID：13247347
> 
> 赞同：0
> 
> 时间：2012-11-06T08:43:14.637
> 
> 标签：c#, formatting

因为有些人显然认为千兆字节作为十进制是准确存储可用存储空间的好方法，所以我现在有以下代码将其转换为字节表示：

```
Convert.ToString(Convert.ToInt64(Math.Floor(someDecimal * 1024 * 1024))); 
```

现在虽然这有效（如返回预期结果），但它并不完全优雅。

有没有更优雅的方式来进行这种转换？（地板是必要的）。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-06T08:46:23.607

你为什么不直接使用这个：

```
var result = ((Int64)(someDecimal * 1024 * 1024 * 1024)).ToString(); 
```

当然，这应该封装在一些辅助方法中。您不希望在您的代码中散布这些内容。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-06T08:55:59.237

尝试：

```
(someDecimal * Math.Pow(1024,3) - 0.5m).ToString("F0") 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-06T08:46:46.377

考虑将此行移至单独的方法（例如`gigabytesToBytes(someDecimal)`）。这将使您的意图更加清晰，如果您发现错误 - 就像评论中发现的错误 - 您可以在一个地方修复它们。

# c# - 在 webBrowser 控件中禁用 Ctrl+P

> ID：13247351
> 
> 赞同：2
> 
> 时间：2012-11-06T08:43:24.700
> 
> 标签：c#, browser, webbrowser-control

似乎不可能在 webBrowser 控件中禁用打印。

这是我尝试过的：

*   将 WebBrowserShortcutsEnabled 设置为 FALSE

    *   按下 ctrl+p 时，这仍然会显示一个打印对话框。这种行为看起来很奇怪，但根据我的测试，您可以在 webbrowser 控件仍然具有焦点时触发对话框。如果单击另一个控件使网络浏览器失去焦点，然后再次单击网络浏览器，则无法触发打印对话框。
*   在窗体的 KeyDown 事件中覆盖 Ctrl+P

    *   这似乎根本没有做任何事情。
*   使用 Webbrowser 的 PreviewKeyDown

    *   这似乎不是为了拦截键，只是预览它们，因为你不能用它取消按键。

如果禁用所有键盘快捷键，那将是最佳选择。

必须有某种方法来实现这一点？谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-06T09:03:21.457

您可以尝试通过 CSS 禁用打印。

```
<style type="text/css" media="print">
 .noprint { display:none }
 </style>

<body>
 <div> This can print</div> 
<div class="noprint"> This can't print</div> 
<div> This can print</div> 
</body> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-08T05:12:50.863

工作示例..

```
$(document).ready(function(e){
    $('body').keydown(function(event) {
       // alert('this');
        if (event.which == 80 && event.ctrlKey) {
            return false;
             //alert('me');   
        }
    });
}); 
```

[http://jsfiddle.net/rhPxU/](http://jsfiddle.net/rhPxU/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-03T16:28:19.793

最干净的方法可能是使用 IDocHostUIHandler 的 TranslateAccelerator 方法。另一方面，它是一堆代码并且需要处理 HtmlInterop 类。

然后代码如下所示：

```
int IDocHostUIHandler.TranslateAccelerator(ref tagMSG msg, ref Guid group, uint nCmdID)
{
  KeyEventArgs e = new KeyEventArgs((Keys)((int)msg.wParam & 0xff) | Control.ModifierKeys);
  if (e.Modifiers == Keys.Control && e.KeyCode == Keys.P )
    return 0;
  return 1;
} 
```

DocHostUIHandler 可以在 DocumentCompleted 事件中附加到文档：

# svn - 如何更新现有的 svn（乌龟）以反映更改的项目和目录结构，同时保持历史记录

> ID：13247356
> 
> 赞同：1
> 
> 时间：2012-11-06T08:43:46.043
> 
> 标签：svn, tortoisesvn

我想将我的遗留 c# 解决方案从 5 个项目简化为 3 个。我想保留所有相关的源文件，但将它们移动到本地磁盘上以反映新的项目结构。SVN 存储库反映了旧的项目/目录结构。如何最好地让 svn 反映这种新结构，同时保持文件的修订历史？例如我有一个带有路径的文件

`c:\workarea\BigSolution\DefunktProj\foo.cs`

带svn路径

`trunk/BigSolution/DefunktProj/foo.cs`.

我想将 foo.cs 移至

`c:\workarea\BigSolution\AliveProj\foo.cs`

并希望 svn 看到这一点并维护文件历史记录。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-06T14:27:41.153

**如果**两者`/DefunktProj`和`/AliveProj`都是普通 SVN 存储库中的目录（以及聚合的工作副本，包括两个目录），您可以轻松完成：只需重新组织树，**仅对文件使用 SVN 移动**，而不是纯资源管理器移动

[TortoiseSVN 网站上最被遗忘的专题](http://tortoisesvn.net/mostforgottenfeature.html)文章详细解释了 RClick 移动

# azure - 如何将大文件上传到 Azure 中的 blob

> ID：13247362
> 
> 赞同：-1
> 
> 时间：2012-11-06T08:44:14.773
> 
> 标签：azure

我需要将一个大文件（>6 MB）上传到 Windows Azure 中的一个 blob。我该怎么做 ？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-06T08:46:11.557

我为此使用 azure storage explorer

[http://azurestorageexplorer.codeplex.com/](http://azurestorageexplorer.codeplex.com/)

超过 30 MB 没有问题

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-11T15:44:40.780

试试我看到的这个新工具（在已删除的答案中）：

[http://www.vic.ms/windows-azure/blob-transfer-utility/](http://www.vic.ms/windows-azure/blob-transfer-utility/)

它提供了一些功能，例如排队和并行操作。

# javascript - Harmony 模块 - 如何处理平台差异？

> ID：13247370
> 
> 赞同：2
> 
> 时间：2012-11-06T08:45:02.843
> 
> 标签：javascript, module, ecmascript-harmony

我对 node.js 的模块加载器以及新的和谐模块规范非常感兴趣。

总的来说，我喜欢这个规范，但有一个问题我不确定它是如何解决的。

如果想要构建一个跨平台的 JavaScript 库，有时需要在不同平台上使用不同的库来完成相同的工作。例如，node.js 中的 Buffer 模块在浏览器中不存在，因此必须编写一个抽象模块，根据平台加载不同的代码。

既然 Harmony 在执行任何代码之前解决了依赖关系，它怎么知道它只需要为一个平台加载代码，而不是为所有平台加载代码？

在浏览器中，我不想加载只在node.js中运行的代码，那么这个问题是怎么解决的呢？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-06T11:42:12.380

在 ES6 中加载模块有两种方法：(1) 静态地，通过`module X at "url"`声明（或任何最终的具体语法），或 (2) 动态地，通过[loader](http://wiki.ecmascript.org/doku.php?id=harmony%3amodule_loaders)`load`的方法。对于您的方案，您可能希望对依赖于上下文的模块使用选项 2。

在浏览器中，您还可以使用多个标签来*暂存*`<script>`您的程序，但由于这不适用于 node.js，它可能对您的用例没有帮助。

# c++ - 可以将不同类型的对象放在一个数组中吗？

> ID：13247389
> 
> 赞同：0
> 
> 时间：2012-11-06T08:46:15.067
> 
> 标签：c++

事情是这样的，我有几个`std::map`s，像这样：

```
std::map<int, std::set> map_1;
std::map<int, std::string> map_2;
std::map<int, long> map_3;
... 
```

还有几个数字，每个数字都与上面列出的一张地图有关，比如

```
1 -> map_2
2 -> map_1
3 -> map_3
... 
```

我要做的是，将所有地图放入一个数组中，然后访问每个数字的地图就像访问该数组的元素一样，如下所示：

```
arr = [map_2, map_1, map_3];
// let x be a number
map_x = arr[x];
do_something(map_x) 
```

这样，我就可以不用写字了`switch...case`，对吧？

但是我可以把它们放在一起吗？如何？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-06T09:07:14.820

做这样的事情的正确方法是使用类。为特定类型的地图创建基类`map`和模板化子类。`map*`然后你可以创建一个元素数组。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-06T12:23:16.443

另一个解决方案是使用[boost::variant](http://www.boost.org/libs/variant "提升::变体")。

将所有地图类型放入变量 ( `boost::variant<std::map<int, std::set>, std::map<int, std::string>, std::map<int, long>>`)，然后像 (`do_something`应该已经重载了，对吧？)：

```
class do_something_visitor
    : public boost::static_visitor<>
{
public:
    template <typename T>
    void operator()(T &map) const
    {
        do_something(map);
    }
}; 
```

`boost::apply_visitor`然后对变体数组中的项目应用访问 ( )。

# c++ - 传递参数、列表和复制构造函数 C++

> ID：13247393
> 
> 赞同：0
> 
> 时间：2012-11-06T08:46:29.943
> 
> 标签：c++, list, parameter-passing, copy-constructor

我在考试中得到了这个问题

> 在传递参数中，在函数调用期间，参数被复制 => 调用每个参数的复制构造函数。假设一个列表作为参数传递，列表的所有元素都被复制。如果是对列表的引用，则只复制列表的地址。你对这些言论有什么看法？

我的回答是“如果它是对列表的引用，不仅地址会被复制，而且值也会被复制”，我得到了 10 分中的 5 分。我的回答错了吗？对我来说，这就是我得到的。上面的说法正确吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-06T08:47:56.850

如果您通过引用传递，则不会制作对象的副本。这就是按引用传递和按值传递之间的区别。

在底层，引用是作为指针实现的，所以你可以说地址是复制的，但这是一个实现细节。

公式虽然是错误的：

> 假设一个列表作为参数传递，列表的所有元素都被复制。如果是对列表的引用，则只复制列表的地址。

传递列表或对列表的引用都没有关系。重要的是该方法如何获取参数 - 通过值或通过引用：

```
void foo(list l);
void goo(list& l);

list x;
list& y = x;

foo(x);  //pass a list by value          --copy is made
foo(y);  //pass a reference by value     --copy is made

goo(x);  //pass a list by reference      --no copy of the list
goo(y);  //pass a reference by reference --no copy of the list 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-06T08:49:01.203

你的答案是错误的。当您通过引用传递变量时，它与将指针传递给变量（地址）然后取消引用它相同，在此过程中不会复制变量。

# ruby-on-rails - rails 在 db 中动态创建表

> ID：13247395
> 
> 赞同：5
> 
> 时间：2012-11-06T08:46:38.587
> 
> 标签：ruby-on-rails, activerecord

通常要在数据库中创建/更改表，我使用迁移（手动运行`rake db:migrate`），然后在我的代码中使用 ActiveRecord。这非常酷，因为我不必担心 db 中数据的表示以及特定类型的 db（sqlserver、pg 或其他）。

但是现在客户希望自己能够即时创建“事物”，例如，他开始销售计算机，所以他想要一个界面，他可以在其中动态创建具有“名称、RAM、高清， ...”。在 db 中创建一个包含所有这些字段的单独表似乎很自然。但是我怎样才能在 RoR 中做到这一点并保留 ActiveRecord 的所有这些优点呢？

请建议。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-06T09:28:35.373

通常的方法是完全相反：

*   有一个对象类型表
*   每个对象类型都有一个字段名称表
*   有一个非常大的表，其中包含任何类型的每个对象的所有自定义属性

这称为 EAV（实体属性值模型，请参阅[http://en.wikipedia.org/wiki/Entity-attribute-value_model](http://en.wikipedia.org/wiki/Entity-attribute-value_model)）。而且它的扩展性很差。

或者，您可以使用`store`文本列而不是大 EAV 表（请参阅[http://api.rubyonrails.org/classes/ActiveRecord/Store.html](http://api.rubyonrails.org/classes/ActiveRecord/Store.html)），这样您就不必进行 EAV 典型的那些困难的属性检索. 您仍然需要将“对象类型”定义存储在某处，因此在构建表单和表格时可以使用预期的字段等。

这种方法的问题是您无法查询（where/join/select）这些属性，因为它们不是列。有很多解决方案：

*   不要对这些属性进行过滤（嗯...）
*   拥有能够进行分面搜索的外部搜索服务器
*   （正如@Amar 正确所说）使用文档数据库
*   使用 postgreSQL 并使用`hstore`而不是简单的序列化列。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-06T09:07:39.573

NoSQL 数据库（文档数据库 Mongodb，CouchDB）可以最适合这个或使用 redis。根据我的想法，您可以使用[Vertical Table 概念](http://paramitech.com/vertical-table-in-rails/)尝试运行MySQL[应用程序的 Rails 2.x Demo 。](https://github.com/amardaxini/vertical_table_demo)您可以尝试使用 Mongodb，检查是否需要。

# c# - 从 GridView Windows Mobile 6.0 获取列的值

> ID：13247404
> 
> 赞同：0
> 
> 时间：2012-11-06T08:47:00.457
> 
> 标签：c#, gridview, windows-mobile

有人请告诉我如何在 Windows 移动应用程序 6.0（模拟器是标准的）中获取 gridview 所选行的第一列的值。我曾经使用下面显示的代码从 windows 应用程序中获取此值，但这在 windows mobile 6.0 标准版本中不起作用

```
dgridShipmentItemTypes.Rows[nIndex].Cells["dgridShmtItmTypeName"].Value.ToString(); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-07T16:58:12.470

试试这个：

```
int rowIndex = dgridShipmentItemTypes.CurrentCell.RowNumber;
int nIndex = 0; // Whatever your column index is.
object obj = dgridShipmentItemTypes[rowIndex, nIndex];
if ((obj != null) && (obj != DBNull.Value)) {
  // do something with it
} 
```

# java - 在不创建 DSN 的情况下运行 Swing 应用程序

> ID：13247405
> 
> 赞同：1
> 
> 时间：2012-11-06T08:47:03.250
> 
> 标签：java, swing, awt, installation, dsn

如何在客户端不创建 DSN 的情况下运行 Swing 应用程序

我正在开发一个 Swing 应用程序，在该应用程序中我必须将 mdb 数据库提供给具有密码保护的客户端，我不希望需要在客户端创建 DSN

有没有办法在编码部分给出数据库路径而不是指定 DSN 名称。因为 DSN 创建对客户端来说是一项复杂的任务。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-06T08:56:47.840

使用下面的代码来创建您的连接：

```
Class.forName("sun.jdbc.odbc.JdbcOdbcDriver");
Connection con = DriverManager.getConnection("jdbc:odbc:Driver={Microsoft Access Driver (*.mdb)};Dbq=c:\\as\\sampleDB.mdb"); 
```

这可能对您有所帮助。

# c# - 在其参考上使用 Copy Local 参考另一个项目

> ID：13247409
> 
> 赞同：2
> 
> 时间：2012-11-06T08:47:27.117
> 
> 标签：c#, .net, visual-studio, msbuild, visual-studio-2012

我有一个项目“ProjA”，它包含了对其他几个项目和一些“插件”程序集的引用。所有这些引用都将 Copy Local 设置为“True”。请注意，插件程序集中的代码（它们是项目引用）不是直接在“ProjA”中引用的，而是通过 DI/Ninject 加载和定位的。（所以我使用这些项目引用作为将插件程序集放入输出文件夹的一种方式，原因见下文）

我也有引用 ProjA 的项目“ProjB”。它使用引用的插件程序集调用应该执行此操作的 ProjA 代码。

问题是，它不起作用。插件程序集不会从 ProjA 输出文件夹（它们被“复制到本地”）复制到 ProjB 输出文件夹中。所以 Ninject 没有加载它们，事情就失败了。

所以我的两个问题：

*   如果我向 VS/msbuild 指示 ProjA 引用项目 P1、P2、P3、P4，并将本地复制设置为 true - 为什么它会假设只需要主输出程序集来使 ProjA 工作？我可以让它有不同的想法吗？
*   我猜想将复制本地引用添加到插件程序集作为让 VS 识别插件和使用它们的项目之间的构建依赖关系的一种方式（目前是一组固定的插件，因此这条路线） - 并不理想。然后我认为将插件程序集作为“内容”添加到项目中会起作用，但是我有两个问题：1）TFS 源代码控制；插件项目需要一个可写的目标来构建，大概 - 内容文件将被“签入”并且 2）一些插件有自己的内容：有了引用，我不必担心会丢失一些东西。走内容路线我需要参考另一个项目的构建输出文件夹，包括它的所有内容，但不包括 PDB .. 似乎更 hacky！

我还考虑并使用了插件项目的构建后步骤（不理想：我将它们从另一个解决方案中拉入这个新解决方案，如果我添加构建后步骤可能会搞砸另一个解决方案）或项目这取决于它们（这没关系，但是具有相对路径的 XCopy，并且必须手动设置项目依赖关系.. 似乎又更老套了）。

有什么我想念的吗，有什么想法吗？如果 Copy Local 跨项目引用链接，它将非常适合..

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-30T23:37:54.373

Visual Studio 或 msbuild 似乎不可能。

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2012-11-06T09:08:05.343

复制 local = true 是 VS 万恶之源。好吧，至少是大多数。

我只想说 - 不要使用它。拥有一个不错的输出目录，例如 T:\Bin，然后使用构建后脚本将所需的所有内容复制到该目录。并从那里跑。不要只相信VS，像瞎老鼠一样四处走动。

您也可以考虑使用 GAC。

# java - Socket.getInputStream().read(byte[]) 是否保证至少在读取一些数据后不会阻塞？

> ID：13247410
> 
> 赞同：8
> 
> 时间：2012-11-06T08:47:27.337
> 
> 标签：java, io, inputstream

InputStream 类的 JavaDoc 说明如下：

> 从输入流中读取最多 len 个字节的数据到一个字节数组中。尝试读取多达 len 个字节，但可能会读取较小的字节数。实际读取的字节数以整数形式返回。在输入数据可用、检测到文件结尾或引发异常之前，此方法会一直阻塞。

这也符合我的经验。例如，请参见下面的示例代码：

```
Client:
Socket socket = new Socket("localhost", PORT);
OutputStream out = socket.getOutputStream();
byte[] b = { 0, 0 };
Thread.sleep(5000);
out.write(b);
Thread.sleep(5000);
out.write(b);

Server:
ServerSocket server = new ServerSocket(PORT);
Socket socket = server.accept();
InputStream in = socket.getInputStream();
byte[] buffer = new byte[4];
System.out.println(in.read(buffer));
System.out.println(in.read(buffer));

Output:
2   // Two bytes read five seconds after Client is started.
2   // Two bytes read ten seconds after Client is started. 
```

对 read(buffer) 的第一次调用会阻塞，直到输入数据可用。然而，该方法在读取两个字节后返回，即使字节缓冲区中仍有空间，这与 JavaDoc 声明“尝试读取尽可能多的 len 个字节，*但可能读取较小的数字*”相对应。但是，当输入流来自套接字时，是否保证一旦读取了至少一个字节的数据，该方法就不会阻塞？

[我问的原因是我在小型 Java Web 服务器NanoHTTPD](http://elonen.iki.fi/code/nanohttpd/)中看到了以下代码，我想知道小于 8k 字节（大多数请求是）的 HTTP 请求是否可能使线程无限期阻塞，除非有保证它一旦读取一些数据就不会阻塞。

```
InputStream is = mySocket.getInputStream();
// Read the first 8192 bytes. The full header should fit in here.
byte[] buf = new byte[8192];
int rlen = is.read(buf, 0, bufsize); 
```

* * *

**编辑**：

让我尝试用一​​个相对相似的代码示例再次说明。EJP 表示*该方法会阻塞，直到 EOS 发出信号或至少一个字节的数据已经到达，在这种情况下，它会读取已经到达的数据字节，而不会再次阻塞，并返回该数字*，这对应于方法的[JavaDoc](http://docs.oracle.com/javase/7/docs/api/java/io/InputStream.html#read%28byte%5B%5D,%20int,%20int%29)类 InputStream 中的 read(byte[], int, int)。但是，如果实际查看源代码，则很明显该方法确实会阻塞，直到缓冲区已满。我已经通过使用与上面相同的客户端并将 InputStream 代码复制到我的服务器示例中的静态方法对其进行了测试。

```
public static void main(String[] args) throws Exception {
    ServerSocket server = new ServerSocket(PORT);
    Socket socket = server.accept();
    InputStream in = socket.getInputStream();
    byte[] buffer = new byte[4];
    System.out.println(read(in, buffer, 0, buffer.length));
}

public static int read(InputStream in, byte b[], int off, int len) throws IOException {
    if (b == null) {
        throw new NullPointerException();
    }
    else if (off < 0 || len < 0 || len > b.length - off) {
        throw new IndexOutOfBoundsException();
    }
    else if (len == 0) {
        return 0;
    }

    int c = in.read();
    if (c == -1) {
        return -1;
    }
    b[off] = (byte)c;

    int i = 1;
    try {
        for (; i < len; i++) {
            c = in.read();
            if (c == -1) {
                break;
            }
            b[off + i] = (byte)c;
        }
    }
    catch (IOException ee) {
    }
    return i;
} 
```

此代码将作为其输出：

```
4   // Four bytes read ten seconds after Client is started. 
```

现在显然 5 秒后有可用的数据，但是该方法仍然会阻止尝试填充整个缓冲区。Socket.getInputStream() 返回的输入流似乎并非如此，但它是否**保证**一旦数据可用它就永远不会阻塞，就像JavaDoc所说但不像源代码显示的那样？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-06T09:30:14.647

> 但是，当输入流来自套接字时，是否保证一旦读取了至少一个字节的数据，该方法就不会阻塞？

我认为这个问题没有任何意义。该方法阻塞，直到 EOS 发出信号或至少一个字节的数据已经到达，在这种情况下，它会读取已经到达的数据字节，而不会再次阻塞，并返回该数字。

> 我在小型 Java Web 服务器 NanoHTTPD 中看到了以下代码

代码是错误的。它使整个标头将在第一次读取时交付的假设无效。我希望在这里看到一个循环，直到检测到一个空行。

> 我想知道小于 8k 字节（大多数请求是）的 HTTP 请求是否可能使线程无限期阻塞，除非有保证一旦读取某些数据就不会阻塞。

我再次认为这没有任何意义。该方法将阻塞，直到至少一个字节到达，或 EOS。时期。

# tomcat - 2 个 Tomcat 服务器之间的 SSL

> ID：13247411
> 
> 赞同：0
> 
> 时间：2012-11-06T08:47:28.753
> 
> 标签：tomcat, liferay, cas

我目前正在尝试配置 2 个 Tomcat，一个带有 CAS，另一个带有 Liferay。我已经使用 OpenSSL 为 CAS 服务器创建了一个证书，当 Liferay 将我重定向到浏览器中的 CAS 页面登录时会显示该证书，但是当 CAS 将我重定向回 Liferay 时（当 Liferay 尝试验证 CAS 创建的票证时） )，我只得到一个漂亮的白页，Liferay 服务器显示“无法找到请求目标的有效认证路径”。我尝试使用 keytool 创建证书，或者将其添加到传递给 Liferay 的自定义信任库中，但一切都让我失望。

也许你们可以帮忙？

谢谢。

更新：我用wireshark查看了SSL流量，似乎liferay不使用ssl来验证CAS票证，这解释了为什么它可以验证证书，因为信任库是在SSL连接器中定义的......但我没有知道如何解决

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-06T10:12:06.797

对于自签名证书，您应该在 server.xml 中指定 SSL 连接器的属性“truststoreFile”：

```
<Connector port="8443" sslProtocol="TLS" scheme="https" clientAuth="false" 
...
keystoreFile="tomcat.keystore" keystorePass="password" keyAlias="tomcat"

<!-- Here's attribute "truststoreFile" -->
truststoreFile="%JAVA_HOME%/jre/lib/security/cacerts"
... /> 
```

尝试使用位于“%JAVA_HOME%/jre/lib/security/cacerts”中的通用信任库文件。您应该使用 keytool 命令将您的证书导入该信任库文件：

```
keytool -import -file tomcat.crt -alias tomcat -keystore %JAVA_HOME%/jre/lib/security/cacerts 
```

默认密码是“changeit”。不必`<connector />`在 server.xml 的标签中指定默认密码。

# php - 在php中将内容从一个页面传输到另一个页面

> ID：13247416
> 
> 赞同：0
> 
> 时间：2012-11-06T08:47:43.687
> 
> 标签：php, mysql

我正在创建一个 php 脚本。我要做的是将内容从一个页面发送到另一个页面。

例如 ：

员工申请休假（从开始到现在）。此休假详细信息应发送到他的经理页面以供他批准（包括开始日期和结束日期）。如果“A”是经理，“B”是员工，则 B 的休假详细信息应仅发送到 A 页面，而不是发送给所有经理。如何实现这一点。

提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-06T09:03:58.500

实现此目的的一种方法是通过数据库在人员 A 和人员 B 之间创建链接。这样，您可以为经理运行查询，该查询仅提取与他们有关系的员工的休假日期。

由于经理 -> 员工关系可能是多对多的，因此将休假表作为两者之间的关系表是有意义的。

然后，您将能够运行查询以提取特定经理的所有休假请求

`SELECT * FROM employee_table JOIN leave_table ON leave_table.employee_id = employee_table.id JOIN manager_table on manager_table.id = leave_table.manager_id WHERE manager_id = xxx`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-06T08:57:45.713

```
Make two Tables:

employee:
1.id
2.emp_name
3.emp_designation
4.manager

Leaves Table:

1.id
2.emp_id
3.from:
4.to

//While Login Make Session
$_SESSION['user'];
$_SESSION['emp_designation'];

//Check if the login user emp_designation is Manager
$query="select a.*,b.emp_id from leaves a left join employee b on a.emp_id=b.id where a.manager='".$_SESSION[user]."'"; 
```

# r - R重塑功能

> ID：13247417
> 
> 赞同：0
> 
> 时间：2012-11-06T08:47:44.913
> 
> 标签：r, dataframe, reshape

我对重塑功能有疑问。我已经厌倦了一段时间，但它只是不起作用。我的数据如下所示：

```
 KeyItem    Year    Value
    Income     2011     10000
    Income     2010     29299
    Depth      2010     29393
    Market Cap 2010     39393
    Depth      2011     20000
    Market Cap 2011     30000 
```

对于我的功能，我需要它看起来像这样：

```
 KeyItem        2011         2010
   Income         10000        29299
   Depth          20000        29393
   Market Cap     30000        39393 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-06T08:55:11.010

最简单的方法是使用包`dcast`中的函数`reshape2`。首先，加载数据：

```
dd = read.table(textConnection("KeyItem Year Value
Income 2011 10000
Income 2010 29299
Depth 2010 29393
Market 2010 39393
Depth 2011 20000
Market 2011 30000"), header=TRUE) 
```

然后加载包：

```
library(reshape2) 
```

最后，只是`dcast`函数：

```
dcast(dd, KeyItem ~ Year) 
```

要得到：

```
R> dcast(dd, KeyItem ~ Year)
Using Value as value column: use value.var to override.
  KeyItem  2010  2011
1   Depth 29393 20000
2  Income 29299 10000
3  Market 39393 30000 
```

反之，只需使用以下`melt`功能：

```
melt(dcast(dd, KeyItem ~ Year)) 
```

* * *

您可以按照通常的方式重新排列列：

```
dd1 = dcast(dd, KeyItem ~ Year) 
dd1[,c("KeyItem", sort(colnames(dd1[, 2:ncol(dd1)]),TRUE))] 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-06T08:55:14.283

```
df <- read.table(text="KeyItem    Year    Value
Income     2011     10000
Income     2010     29299
Depth      2010     29393
Market_Cap 2010     39393
Depth      2011     20000
Market_Cap 2011     30000",header=TRUE)

library(reshape2)
df2 <- dcast(df,KeyItem~Year)

#     KeyItem  2010  2011
#1      Depth 29393 20000
#2     Income 29299 10000
#3 Market_Cap 39393 30000 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-27T18:04:07.380

“reshape” 和 “reshape2” 包通常会得到大家的喜爱，但在 base R 中也有选项。假设你`data.frame`被称为“df”，这里有两个（半）基本 R 选项：

```
## Using base R reshape()
reshape(df, direction = "wide", idvar="KeyItem", timevar="Year")
#      KeyItem Value.2011 Value.2010
# 1     Income      10000      29299
# 3      Depth      20000      29393
# 4 Market_Cap      30000      39393

## Using xtabs()
xtabs(Value ~ KeyItem + Year, df)
#             Year
# KeyItem       2010  2011
#   Depth      29393 20000
#   Income     29299 10000
#   Market_Cap 39393 30000

## Here's the "half": Using xtabs(), but as a data.frame
as.data.frame.matrix(xtabs(Value ~ KeyItem + Year, df))
#             2010  2011
# Depth      29393 20000
# Income     29299 10000
# Market_Cap 39393 30000 
```

# java - 如何使用 PHP 的参数实例化/调用 java 类？

> ID：13247418
> 
> 赞同：1
> 
> 时间：2012-11-06T08:47:46.163
> 
> 标签：java, php, jasper-reports, php-java-bridge

例如，我有 java 类 JRXlsExporter，如果我从 java 实例化该 java，我的代码是：

```
 JRXlsExporter myObject= new JRXlsExporter(); 
```

并从 PHP 变为：

```
 $myObject = new Java("net.sf.jasperreports.engine.export.JRXlsExporter"); 
```

它可以工作，但是如果我有带参数的 java 类，例如：

```
 JRXlsExporter myObject= new JRXlsExporter(param1,param2); 
```

如何从 PHP 实例化/调用该 java 类？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-06T09:05:22.907

这是[一个](http://publib.boulder.ibm.com/infocenter/wsmashin/v1r1/index.jsp?topic=/com.ibm.websphere.sMash.doc/using/zero.php/ZeroAdvancedPHPJavaBridge.html)如何`java.util.Date`实例化对象的示例，带有一些构造函数参数：

```
$date = new Java("java.util.Date", 70, 9, 4); 
```

此外，它说：

> new Java("java.util.Date", 70, 9, 4) 调用使用 java.util.Date(int year, int month, int day) 构造函数创建 java.util.Date 类的新实例。

所以，你也许可以试试这个：

```
$myObject = new Java("net.sf.jasperreports.engine.export.JRXlsExporter", param1, param2); 
```

# android - 如何从android缓存目录播放视频？

> ID：13247419
> 
> 赞同：2
> 
> 时间：2012-11-06T08:47:46.683
> 
> 标签：android, android-videoview

在我的 android 应用程序中，我想从缓存目录播放视频它在 android 4.1.1 中运行良好，但在 android 2.3.3 中它显示类似**“抱歉，此视频无法播放”**的消息。我想在 android 视频视图中播放该视频。如何从缓存目录中读取文件。

# wordpress - Wordpress 中的 Flexslider 1.8 - 添加拇指导航/编辑选项

> ID：13247424
> 
> 赞同：1
> 
> 时间：2012-11-06T08:48:19.233
> 
> 标签：wordpress, flexslider

我正在开发一个使用 Flexslider 1.8 的 Wordpress 主题

[http://wp.themecss.com/Square/portfolio-item/graphicriver/](http://wp.themecss.com/Square/portfolio-item/graphicriver/)

我希望添加我在 flexslider 和 github 网站上看到的缩略图滑块 controlNav 功能。

我找到了一些代码示例，说明了执行此操作所需的内容，但是我不确定如何/在何处实现这些更改。它在 jquery.flexslider.js 中吗？主题中是否还有其他文件也需要更改，例如 .css？

我很擅长破解 php，但这是我第一次尝试在主题中编辑 .js

所以，我真的可以做一些帮助

1.  实现此功能所需的代码是什么？
2.  需要编辑哪些文件才能实现此目的？

# c#-4.0 - C# 4、COM 互操作和 UPnP：三驾马车

> ID：13247432
> 
> 赞同：11
> 
> 时间：2012-11-06T08:49:01.923
> 
> 标签：c#-4.0, com, upnp, idispatch

[我正在尝试使用 C# 4 和 Microsoft 基于 COM 的NAT 遍历 API](http://msdn.microsoft.com/en-us/library/windows/desktop/aa366187%28v=vs.85%29.aspx) (Hnetcfg.dll)编写一些使用 UPnP 进行 NAT 遍历的代码（仅供家庭使用）。

不幸的是（或者幸运的是）我最后一次必须在 .NET 中进行 COM 互操作是在最后一个冰河时代左右，我似乎对 C# 使用动态类型进行互操作以及如何编写回调从根本上感到困惑（这样COM 服务器调用我的托管代码）。

这是令人兴奋的几行代码：

```
// Referencing COM NATUPNPLib ("NATUPnP 1.0 Type Library")

using System;
using NATUPNPLib;

class NATUPnPExample
{
    public delegate void NewNumberOfEntriesDelegate(int lNewNumberOfEntries);

    public static void NewNumberOfEntries(int lNewNumberOfEntries)
    {
        Console.WriteLine("New number of entries: {0}", lNewNumberOfEntries);
    }

    public static void Main(string[] args)
    {
        UPnPNAT nat = new UPnPNAT();
        NewNumberOfEntriesDelegate numberOfEntriesCallback = NewNumberOfEntries;

        nat.NATEventManager.NumberOfEntriesCallback = numberOfEntriesCallback;

        nat.StaticPortMappingCollection.Add(4555, "TCP", 4555, "192.168.0.1", true, "UPnPNAT Test");

        // Presumably my NewNumberOfEntries() method should be called by the COM component about now

        nat.StaticPortMappingCollection.Remove(4555, "TCP");
    }
} 
```

在上面的代码中，Add 和 Remove 调用工作得很好。了不起。

麻烦的是，我还想知道端口映射条目的数量什么时候发生了变化，为此我需要注册一个回调接口（[INATEventManager::put_NumberOfEntriesCallback](http://msdn.microsoft.com/en-us/library/windows/desktop/aa365067%28v=vs.85%29.aspx)），它必须支持 INATNumberOfEntriesCallback 或 IDispatch 接口。VS2012 的对象浏览器是这样描述 INATEventManager::put_NumberOfEntriesCallback 的：

```
dynamic NumberOfEntriesCallback { set; } 
```

是的，所以我的印象是，在 C# 4 中，我不应该用花哨的属性来装饰任何东西，我可以通过将委托以粗俗的方式插入 INATEventManager::put_NumberOfEntriesCallback 并让 .NET 担心来注册我的回调关于 IDispatch 并收拾残局；但看来我大错特错了。

所以，呃......我应该怎么做才能确保调用我的 NewNumberOfEntries 方法？

我也有点担心我可以写`nat.NATEventManager.NumberOfEntriesCallback = 1;`或`nat.NATEventManager.NumberOfEntriesCallback = "Sausages";`不抛出异常。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-06-10T00:41:28.497

我遇到了与您相同的问题，并且由于在该主题上没有太多帮助，因此您的帖子帮助很大！它不会让我评论你的答案，因为我没有足够的分数或其他任何东西，但你的答案是最好的，但并不完全符合我的想法。

```
nat.NATEventManager.ExternalIPAddressCallback = new CallbackDisp(); 
```

工作，使用相同的调度，并会在外部 IP 更改时告诉您。然而，

```
nat.NATEventManager.NumberOfEntriesCallback = new CallbackDisp(); 
```

仅报告来自这些条件的 UPnP 映射更改：A.) 它是由 NATUPnP 实例添加/删除的。在这种情况下：

```
 nat.StaticPortMappingCollection.Add(); 
```

或 B.) 在创建实例时它已经被映射：

```
 var nat = new UPnPNAT(); 
```

例如，如果 Utorrent 在您启动程序时正在运行，并且您有一些东西阻止程序退出（Console.WriteLine();) 例如.. 当您退出 Utorrent 时，回调将触发，并通知您地图变化。这正是我一开始想要的。但是，如果您重新打开 Utorrent 或任何其他使用 UPnP 的应用程序，它不会触发回调，也不会通知您更改。

不用说，这非常令人沮丧。如果你弄清楚了，请分享！我知道我可以通过在给定的时间间隔轮询 StaticPortMappingCollection 轻松实现该功能，但对我来说似乎有点“hacky”。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-12-27T03:57:49.060

看来我能够使它工作。两个选项 - 使用自定义接口“INATNumberOfEntriesCallback”（顺便说一句，它似乎没有在类型库中声明，您需要自己声明）和使用 DispId(0) 的普通调度。向 IDispatch/IUnknown 的转换由框架自动执行。所以：

选项1。

声明 INATNumberOfEntriesCallback 并创建一个实现该接口的回调类（棘手的部分是 Guid - 它来自“Natupnp.h”文件，并且似乎不在类型库中）。

```
// declare INATNumberOfEntriesCallback interface 
[ComVisible(true)]
[Guid("C83A0A74-91EE-41B6-B67A-67E0F00BBD78")]
[InterfaceType(ComInterfaceType.InterfaceIsIUnknown)]
public interface INATNumberOfEntriesCallback
{
    void NewNumberOfEntries(int val);
};

// implement callback object
[ComVisible(true)]
[ClassInterface(ClassInterfaceType.None)]
public class CallbackNewNumberOfEntries : INATNumberOfEntriesCallback
{
    public void NewNumberOfEntries(int val)
    {
        Console.WriteLine("Number of entries changed: {0}", val);
    }
}

class NATUPnPExample
{
    public static void Main(string[] args)
    {
        var nat = new UPnPNAT();

        nat.NATEventManager.NumberOfEntriesCallback = new CallbackNewNumberOfEntries();

        nat.StaticPortMappingCollection.Add(4555, "TCP", 4555, "192.168.0.1", true, "UPnPNAT Test");

        // Presumably my NewNumberOfEntries() method should be called by the COM component about now

        nat.StaticPortMappingCollection.Remove(4555, "TCP");
    }
} 
```

选项 2。

使用普通调度。文档说您可以使用 dispid(0) 并且应该使用 4 个（！）参数调用它（请参阅[文档](http://msdn.microsoft.com/en-us/library/windows/desktop/aa365067%28v=vs.85%29.aspx)中的备注部分）。所以基本上以下构造似乎以“调度”方式工作：

```
[ComVisible(true)]
[ClassInterface(ClassInterfaceType.AutoDispatch)]
public class CallbackDisp
{
    [DispId(0)]
    public void OnChange(string updateType, object obj, object name, object val)
    {
        Console.WriteLine("{0}: {1} = {2}", updateType, name, val);
    }
}

class NATUPnPExample
{
    public static void Main(string[] args)
    {
        var nat = new UPnPNAT();

        nat.NATEventManager.NumberOfEntriesCallback = new CallbackDisp();

        nat.StaticPortMappingCollection.Add(4555, "TCP", 4555, "192.168.0.1", true, "UPnPNAT Test");

        // Presumably my NewNumberOfEntries() method should be called by the COM component about now

        nat.StaticPortMappingCollection.Remove(4555, "TCP");
    }
} 
```

# winforms - WebClient 返回 404 错误，但此 url 在 WebBrowser.Navigate 方法中有效

> ID：13247435
> 
> 赞同：1
> 
> 时间：2012-11-06T08:49:07.253
> 
> 标签：winforms, c#-4.0, uri, webclient

我尝试使用`WebClient`.

这是我的代码：

```
public string GetWebData(string url)
{
        string html = string.Empty;

        using (WebClient client = new WebClient())
        {
            Uri innUri = null;
            Uri.TryCreate(url, UriKind.RelativeOrAbsolute, out innUri);

            try
            {
                client.Headers.Add("Accept-Language", " en-US");
                client.Headers.Add("Accept-Encoding", "gzip, deflate");
                client.Headers.Add("Accept", " text/html, application/xhtml+xml, */*");
                client.Headers.Add("User-Agent", "Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.1; Trident/5.0)");

                using (StreamReader str = new StreamReader(client.OpenRead(innUri)))
                {
                    html = str.ReadToEnd();
                }
            }
            catch (WebException we)
            {
                throw we;
            }

            return html;
        }
    } 
```

网址是 `http://www.paginegialle.it/roma-rm/abbigliamento/alberto-aspesi-c`。

![在此处输入图像描述](../Images/77ce4cc851a52447eefb21b319b2ef1a.png)

但我可以毫无问题地在 IE9 和 Firefox 和 Chrome 浏览器中导航到这个 URL。我使用 Fiddler 来解决这个问题。

我发现 URL 在之后发生了变化`WebClient.Request`- 请参见下图：

实际网址：`http://www.paginegialle.it/roma-rm/abbigliamento/alberto-aspesi-c.`

![在此处输入图像描述](../Images/71f326613081e36ff4be59eba11d2115.png)

![在此处输入图像描述](../Images/84ea77632147637ea3f47617c2f66008.png)

请看区别。我删除了网址末尾的点。但它不适用于浏览器（IE9、Firefox、Chrome）。如何将实际网址更改为此网址？

请帮我。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-07T23:25:37.993

我认为您在 .NET URI 对象中发现了一个很酷的错误。

```
MessageBox.Show(new Uri("http://example.com/bug/here.")); 
```

显示：

> [http://example.com/bug/这里](http://example.com/bug/here)

请注意，缺少尾随期间。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-06T12:38:23.853

此行之后的网址是否仍然正确：

```
 Uri.TryCreate(url, UriKind.RelativeOrAbsolute, out innUri); 
```

我猜它适用于其他网站？

# android - 带有致命信号 11 (SIGSEGV) 的 android 内存不足

> ID：13247436
> 
> 赞同：0
> 
> 时间：2012-11-06T08:49:11.793
> 
> 标签：android, out-of-memory

当重复脉冲按钮移动我在应用程序中时，总是会出现这种内存错误。

我已经检查过它是否在同一个按钮上被多次单击，我还设置了一个条件，即不加载另一个意图来打开另一个活动，直到你不使电流过载。但这不是这个原因。

在我的许多活动中加载许多在滚动视图中膨胀的视图。

对于空闲内存，我试过这个：

在更改活动之前，我执行此视图是一个 android:id 每个活动中使用的布局。

**1.-**

```
if (view.getBackground() != null) {
    view.getBackground().setCallback(null);
}
if (view instanceof ViewGroup) {
    for (int i = 0; i < ((ViewGroup) view).getChildCount(); i++) {
        unbindDrawables(((ViewGroup) view).getChildAt(i));
    }
    ((ViewGroup) view).removeAllViews();
} 
```

**2.-**

```
System.gc(); 
```

但这似乎还不够。这是我的LogCat：

```
11-06 09:23:34.480: I/dalvikvm-heap(9160): Grow heap (frag case) to 39.174MB for 3133456-byte allocation
11-06 09:23:34.519: D/dalvikvm(9160): GC_CONCURRENT freed 5K, 33% free 40059K/59463K, paused 13ms+7ms, total 43ms
11-06 09:23:34.613: D/dalvikvm(9160): GC_FOR_ALLOC freed 0K, 33% free 40059K/59463K, paused 24ms, total 24ms
11-06 09:23:34.613: I/dalvikvm-heap(9160): Forcing collection of SoftReferences for 12533776-byte allocation
11-06 09:23:34.652: D/dalvikvm(9160): GC_BEFORE_OOM freed 0K, 33% free 40059K/59463K, paused 39ms, total 39ms
11-06 09:23:34.652: E/dalvikvm-heap(9160): Out of memory on a 12533776-byte allocation.
11-06 09:23:34.660: I/dalvikvm(9160): "main" prio=5 tid=1 RUNNABLE
11-06 09:23:34.660: I/dalvikvm(9160):   | group="main" sCount=0 dsCount=0 obj=0x40c7c568 self=0x40bbcab0
11-06 09:23:34.660: I/dalvikvm(9160):   | sysTid=9160 nice=0 sched=0/0 cgrp=apps handle=1075234352
11-06 09:23:34.660: I/dalvikvm(9160):   | schedstat=( 0 0 0 ) utm=2490 stm=234 core=1
11-06 09:23:34.660: I/dalvikvm(9160):   at android.graphics.BitmapFactory.nativeDecodeAsset(Native Method)
11-06 09:23:34.660: I/dalvikvm(9160):   at android.graphics.BitmapFactory.decodeStream(BitmapFactory.java:500)
11-06 09:23:34.660: I/dalvikvm(9160):   at android.graphics.BitmapFactory.decodeResourceStream(BitmapFactory.java:353)
11-06 09:23:34.660: I/dalvikvm(9160):   at android.graphics.drawable.Drawable.createFromResourceStream(Drawable.java:781)
11-06 09:23:34.660: I/dalvikvm(9160):   at android.content.res.Resources.loadDrawable(Resources.java:1930)
11-06 09:23:34.660: I/dalvikvm(9160):   at android.content.res.TypedArray.getDrawable(TypedArray.java:601)
11-06 09:23:34.660: I/dalvikvm(9160):   at android.view.View.<init>(View.java:3336)
11-06 09:23:34.660: I/dalvikvm(9160):   at android.view.ViewGroup.<init>(ViewGroup.java:427)
11-06 09:23:34.660: I/dalvikvm(9160):   at android.widget.LinearLayout.<init>(LinearLayout.java:176)
11-06 09:23:34.660: I/dalvikvm(9160):   at android.widget.LinearLayout.<init>(LinearLayout.java:172)
11-06 09:23:34.660: I/dalvikvm(9160):   at java.lang.reflect.Constructor.constructNative(Native Method)
11-06 09:23:34.660: I/dalvikvm(9160):   at java.lang.reflect.Constructor.newInstance(Constructor.java:417)
11-06 09:23:34.660: I/dalvikvm(9160):   at android.view.LayoutInflater.createView(LayoutInflater.java:587)
11-06 09:23:34.660: I/dalvikvm(9160):   at com.android.internal.policy.impl.PhoneLayoutInflater.onCreateView(PhoneLayoutInflater.java:56)
11-06 09:23:34.660: I/dalvikvm(9160):   at android.view.LayoutInflater.onCreateView(LayoutInflater.java:660)
11-06 09:23:34.660: I/dalvikvm(9160):   at android.view.LayoutInflater.createViewFromTag(LayoutInflater.java:685)
11-06 09:23:34.660: I/dalvikvm(9160):   at android.view.LayoutInflater.inflate(LayoutInflater.java:466)
11-06 09:23:34.660: I/dalvikvm(9160):   at android.view.LayoutInflater.inflate(LayoutInflater.java:396)
11-06 09:23:34.660: I/dalvikvm(9160):   at android.view.LayoutInflater.inflate(LayoutInflater.java:352)
11-06 09:23:34.660: I/dalvikvm(9160):   at com.android.internal.policy.impl.PhoneWindow.setContentView(PhoneWindow.java:256)
11-06 09:23:34.660: I/dalvikvm(9160):   at android.app.Activity.setContentView(Activity.java:1867)
11-06 09:23:34.660: I/dalvikvm(9160):   at com.hiberus.campus.seas.views.Estudios.onCreate(Estudios.java:81)
11-06 09:23:34.660: I/dalvikvm(9160):   at android.app.Activity.performCreate(Activity.java:5008)
11-06 09:23:34.660: I/dalvikvm(9160):   at android.app.Instrumentation.callActivityOnCreate(Instrumentation.java:1079)
11-06 09:23:34.660: I/dalvikvm(9160):   at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2023)
11-06 09:23:34.660: I/dalvikvm(9160):   at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:2084)
11-06 09:23:34.660: I/dalvikvm(9160):   at android.app.ActivityThread.access$600(ActivityThread.java:130)
11-06 09:23:34.660: I/dalvikvm(9160):   at android.app.ActivityThread$H.handleMessage(ActivityThread.java:1195)
11-06 09:23:34.660: I/dalvikvm(9160):   at android.os.Handler.dispatchMessage(Handler.java:99)
11-06 09:23:34.660: I/dalvikvm(9160):   at android.os.Looper.loop(Looper.java:137)
11-06 09:23:34.660: I/dalvikvm(9160):   at android.app.ActivityThread.main(ActivityThread.java:4745)
11-06 09:23:34.660: I/dalvikvm(9160):   at java.lang.reflect.Method.invokeNative(Native Method)
11-06 09:23:34.660: I/dalvikvm(9160):   at java.lang.reflect.Method.invoke(Method.java:511)
11-06 09:23:34.660: I/dalvikvm(9160):   at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:786)
11-06 09:23:34.660: I/dalvikvm(9160):   at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:553)
11-06 09:23:34.660: I/dalvikvm(9160):   at dalvik.system.NativeStart.main(Native Method)
11-06 09:23:34.660: A/libc(9160): Fatal signal 11 (SIGSEGV) at 0x00000000 (code=1), thread 9160 (rus.campus.seas) 
```

你怎么能解决这个问题？谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-06T10:30:00.517

在我的应用程序中，每个布局都有他的背景。给我错误的行总是“setContentView（R.layout.xxx）”，所以我减少了所有用作背景的图像，我已经解决了我的内存问题。

# java - 最有效的工件复制方式？

> ID：13247438
> 
> 赞同：0
> 
> 时间：2012-11-06T08:49:28.263
> 
> 标签：java, file, maven, copy

我是软件交付工程师，我需要将工件作为产品交付给客户。使用 Maven，我可以从存储库下载工件。下载工件后，我需要将这些工件复制到特定文件夹位置最好的方法是什么？

如何使用java做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-06T08:59:27.080

如果您要向客户交付成品，我强烈建议您使用 Maven 本身打包交付物，也许是[Maven 发布插件](http://maven.apache.org/plugins/maven-release-plugin/)。这将允许您生成结构化输出，包括二进制文件、依赖项、文档等。

一旦您配置了发布格式以满足您的需求，您就可以为客户提供 Maven 构建的结果。无需担心如何在 Java 中执行此操作。

# php - 如果 PDO 和 mysqli 不可用，使用 mysql_* 函数是否安全？

> ID：13247440
> 
> 赞同：5
> 
> 时间：2012-11-06T08:49:44.793
> 
> 标签：php, mysql, pdo, mysqli, sql-injection

我有一个托管在共享主机上的网站。他们安装了 php 5.2.13。

我知道 SQL 注入的漏洞，我想阻止它。

所以我想使用 PDO 或 mysqli 来防止它。

但是我`phpinfo();`以前查看托管环境php设置信息的时候，
发现里面没有PDO的mysql驱动，里面也没有对mysqli的支持。

所以我想知道使用旧的 mysql_* 函数（以及类似的函数`mysql_real_escape_string`）是否安全。

我在 SO 上看了这个，但它对我没有多大帮助。 [当 mysqli 和 PDO 不可用时，可以使用准备好的语句吗？](https://stackoverflow.com/questions/11089862/prepared-statements-possible-when-mysqli-and-pdo-are-not-available)

**更新：**

我忘了提到大多数查询都很简单。没有使用任何表单，因此不会使用用户输入来进行查询。所有查询都将使用必要的参数进行硬编码，并且一旦设置就不会更改。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-06T08:52:52.230

不会。缺乏更安全的解决方案绝不是退回到更不安全或更易受攻击的解决方案的正当借口。

你最好找到一个不同的托管服务提供商，即使在他们的共享托管包中也不会禁用任意 PHP 功能。哦，尝试获得一个使用 PHP 5.3 的，或者如果可以的话，使用 PHP 5.4 更好。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-06T08:57:52.027

如果您对始终使用`mysql_real_escape_string()`所有用户提供的输入非常严格，那么我认为您应该免受准备好的语句保护您免受任何 SQL 注入的影响。

你在这方面有多完美？我敢打赌，大多数缓冲区溢出漏洞都是由认为自己擅长检查输入的程序员创建的......

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-06T08:59:49.220

一个很好的方法是实现一个 Wrapper 类以使用 mysql_* 函数，并使用一些方法来创建准备好的语句。

这个想法是您必须在查询中传递强类型参数。

例如，这是一段具有一般思想的代码。当然，它需要更多的工作。但如果实施得当，这可以防止 SQL 注入攻击。

您还可以搜索已经实现该功能的 3rd 方库，因为这很常见。

```
<?php

class MyDb
{
  protected $query;

  public function setQuery($query)
  {
    $this->query = $query;
  }

  public function setNumericParameter($name, $value)
  {
    if (is_numeric($value)) // SQL Injection check, is the value really an Int ?
    {
       $this->query = str_replace(':'.$name, $value);
    }
    // else, probably an intent of SQL Injection
  }

  // Implement here the methods for all the types you need, including dates, strings, etc

  public function fetchArray()
  {
     $res = mysql_query($this->query);
     return mysql_fetch_array($res);
  }
}

MyDb $db = new MyDb();
$db->setQuery('SELECT * FROM articles WHERE id = :id');
$db->setNumericParameter('id', 15);

while ($row = $db->fetchArray())
{
// do your homework
} 
```

# ios5 - 无法在 iOS 5 + 中获取用户当前位置

> ID：13247443
> 
> 赞同：0
> 
> 时间：2012-11-06T08:50:02.833
> 
> 标签：ios5, gps, core-location, cllocationmanager

我想获取用户当前位置。这是我的代码

```
 // In LoginViewController.h

@interface LoginViewController : UIViewController <UserLocationDelegate,UIAlertViewDelegate> {

    CLLocation *usersLocation;
}
@property (nonatomic,strong) CLLocation *usersCurrentLocation;
@end

// In LoginViewController.m

@implementation LoginViewController

@synthesize usersCurrentLocation;

- (void)viewDidLoad
{
    [super viewDidLoad];
    // Do any additional setup after loading the view from its nib.
    self.usersCurrentLocation = nil;
    [self currentLocationOfUser];
}

-(void)currentLocationOfUser {

    UserLocation *userLocation = [[UserLocation alloc]init];//UserLocation];
    userLocation.delegate = self;
    [userLocation getCurrentLocationOfUser];
}

#pragma mark - User Location Delegate Methods

- (void)locationUpdate:(CLLocation *)location
{
    self.usersCurrentLocation = location;
    NSLog(@"Latitude:- %.6f",self.usersCurrentLocation.coordinate.latitude);
    NSLog(@"Longitude:- %.6f",self.usersCurrentLocation.coordinate.longitude);

}

- (void)locationError:(NSString *)errorMsg
{
    [Common showAlertWithTitle:@"Error" andMessage:errorMsg];
}

// In UserLocation.h

#import <Foundation/Foundation.h>
#import <CoreLocation/CoreLocation.h>

@protocol UserLocationDelegate <NSObject>

@required
- (void)locationUpdate:(CLLocation *)location; 
- (void)locationError:(NSString *)errorMsg;

@end

@interface UserLocation : NSObject <CLLocationManagerDelegate> {

    CLLocationManager *locationManager;
    __weak id<UserLocationDelegate>delegate;

}

@property (nonatomic,strong) CLLocationManager *locationManager;
@property (nonatomic,weak) id<UserLocationDelegate>delegate;

-(id)initUserLocation;
-(void)getCurrentLocationOfUser;

@end

// In UserLocation.m

#import "UserLocation.h"

@implementation UserLocation

@synthesize locationManager;
@synthesize delegate;
@synthesize geoCodingDelegate;

-(id)initUserLocation 
{
    if (self == [super init]) {
        self.locationManager = [[CLLocationManager alloc]init];
        self.locationManager.delegate = self;
        self.locationManager.desiredAccuracy = kCLLocationAccuracyKilometer;
    }
    return self;
}

-(void)getCurrentLocationOfUser {

    self.locationManager = [[CLLocationManager alloc]init];
    self.locationManager.delegate = self;
    self.locationManager.desiredAccuracy = kCLLocationAccuracyKilometer;

    if ([CLLocationManager locationServicesEnabled]) {
        //[self.locationManager startMonitoringSignificantLocationChanges];
        [self performSelector:@selector(startLocationUpdate) withObject:nil afterDelay:2.0];
    }
    else {
        if ([delegate respondsToSelector:@selector(locationError:)]) {
            [self.delegate locationError:@"Please Turn On Location Services in Settings To Retrive User's Current Location"];
        }
        else {
            [Common showAlertWithTitle:@"Error" andMessage:@"Please Turn On Location Services in Settings To Retrive User's Current Location"];
        }
    }
}

-(void)startLocationUpdate
{
    [self.locationManager startMonitoringSignificantLocationChanges];
}

#pragma mark CLLocationManagerDelegate

-(void)locationManager:(CLLocationManager *)manager
   didUpdateToLocation:(CLLocation *)newLocation
          fromLocation:(CLLocation *)oldLocation
{
    if ([delegate respondsToSelector:@selector(locationUpdate:)]) {
        [delegate locationUpdate:newLocation];
    }
}

-(void)locationManager:(CLLocationManager *)manager 
      didFailWithError:(NSError *)error
{
    if ([delegate respondsToSelector:@selector(locationError:)]) {
        [delegate locationError:@"Some Error Occured While Retriving Users's Location"];
    }
    else {
        [Common showAlertWithTitle:@"Error" andMessage:@"Some Error Occured While Retriving Users's Location"];
    }
}

@end 
```

但它没有返回任何位置更新。它也没有询问用户使用位置的权限。我的应用未在定位服务中列出。如何在 Location Serverices 中添加我的应用程序？上面的代码有什么问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-06T15:20:28.143

我通过在 .h 和写入属性中声明 UserLocation *userLocation 解决了这个问题。由于我使用的是 ARC ，它释放了 userLocation ，所以我没有得到位置更新。

# cordova - 微软同步框架phonegap

> ID：13247446
> 
> 赞同：-1
> 
> 时间：2012-11-06T08:50:11.103
> 
> 标签：cordova, frameworks, synchronization, microsoft-sync-framework

需要将我的移动应用程序中的数据同步到我的 SQL Server，有人愿意帮忙吗？任何代码或建议都会有所帮助基本上，这就是我需要的：

从 SQL 数据库服务器（使用 microsoft 同步框架）下载数据库记录到 SQLite >> 数据库（需要找到这样做的最佳方法）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-08T06:26:02.403

看看[同步框架工具包](http://code.msdn.microsoft.com/wpapps/Sync-Framework-Toolkit-4dc10f0e)

SqlLite 没有同步提供程序，但该工具包有一个用于 SQL Ce 的示例，您可能可以对其进行改造以针对 SqlLite 工作。

# c# - 使用新标签和属性以及根自定义 XML 序列化

> ID：13247449
> 
> 赞同：3
> 
> 时间：2012-11-06T08:50:20.163
> 
> 标签：c#, xml, serialization, xml-serialization

这是我的类型：

```
public class MyObject {

    public string destAdd { get; set; }
    public long Time { get; set; }
    public int maxNumb { get; set; }
    public Account AccountCredentials { get; set; }

    public System.String Serialize() {
        String result = "";
        XmlSerializer xs = new XmlSerializer(typeof(MyObject));
        MemoryStream ms = new MemoryStream();
        xs.Serialize(ms, this);
        result = System.Text.Encoding.UTF8.GetString(ms.ToArray());
        ms.Close();
        ms.Dispose();
        xs = null;
        return result;
    }

    public static MyObject DeSerialize(String s) {
        MyObject result = new MyObject();
        XmlSerializer xs = new XmlSerializer(typeof(MyObject));
        MemoryStream ms = new MemoryStream(Encoding.UTF8.GetBytes(s));
        result = (MyObject)xs.Deserialize(ms);
        ms.Close();
        ms.Dispose();
        xs = null;
        return result;
    }
} 
```

然后我像这样序列化它：

```
 MyObject obj = new MyObject();
        obj.destAdd = "Destination";
        obj.maxNumb = 99;
        obj.Time = 128;
        obj.Account = new Account { username = "user", password = "pass" };
        string seializeObj = obj.Serialize(); 
```

结果是：

```
<?xml version="1.0"?>
<MyObject xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema">
  <destAdd>Destination</destAdd>
  <Time>128</Time>
  <maxNumb>99</maxNumb>
  <Account>
    <username>user</username>
    <password>pass</password>
  </Account>
</MyObject> 
```

但我需要以下结果：

```
<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/"
xmlns:smag="http://targetaddress.com/">
  <soapenv:Header>
    <Account>
      <username>user</username>
      <password>pass</password>
    </Account>
  </soapenv:Header>
  <soapenv:Body>
    <smag:myobjinfos>
      <destAdd>Destination</destAdd>
      <Time>128</Time>
      <maxNumb>99</maxNumb>
    </smag:myobjinfos>
  </soapenv:Body>
</soapenv:Envelope> 
```

如何实现序列化以获得此结果？有什么建议吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-06T12:54:26.233

您似乎正在尝试使用自定义安全标头调用 Web 服务。通常，最简单的方法是从目标 Web 服务的 WSDL 生成一组代理类。

任何一个

*   在 Visual Studio 中右键单击使用添加服务引用/添加 Web 引用
*   或者，如果您有服务的 WSDL 和 xsd 文件，则使用[wsdl.exe 命令行工具](http://msdn.microsoft.com/en-us/library/7h3ystb6(v=vs.80).aspx)（例如`wsdl.exe *.wsdl *.xsd //language:c#`）
*   请参阅[此处](https://stackoverflow.com/questions/2139190/adding-soapheader-username-and-password-with-wse-3-0)了解如何在[ws:security 标头上设置安全信息](http://msdn.microsoft.com/en-us/library/ms977327.aspx)

但是，如果您 100% 确定您需要获得上述准确`soapEnv Xml`信息，我建议您保持代码“原样”（即，使用`XmlSerializer`or将 MyObject 序列化为其默认格式`DataContractSerializer`），然后使用[XslCompiledTransform](https://stackoverflow.com/questions/34093/how-to-apply-an-xslt-stylesheet-in-c-sharp%20to%20the%20result)。

这个 XSLT 将完全做到这一点：

```
<?xml version="1.0" encoding="utf-8"?>
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
    <xsl:output indent="yes"/>
    <xsl:template match="/MyObject">
        <soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/"
                          xmlns:smag="http://targetaddress.com/">
            <soapenv:Header>
                <Account>
                    <username><xsl:value-of select="Account/username"/></username>
                    <password><xsl:value-of select="Account/password"/></password>
                </Account>
            </soapenv:Header>
            <soapenv:Body>
                <smag:myobjinfos>
                    <destAdd><xsl:value-of select="destAdd"/></destAdd>
                    <Time><xsl:value-of select="Time"/></Time>
                    <maxNumb><xsl:value-of select="maxNumb"/></maxNumb>
                </smag:myobjinfos>
            </soapenv:Body>
        </soapenv:Envelope> </xsl:template>
</xsl:stylesheet> 
```

转换

```
<?xml version="1.0"?>
<MyObject>
  <destAdd>Destination</destAdd>
  <Time>128</Time>
  <maxNumb>99</maxNumb>
  <Account>
    <username>user</username>
    <password>pass</password>
  </Account>
</MyObject> 
```

对此：

```
<?xml version="1.0" encoding="utf-8"?>
<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:smag="http://targetaddress.com/">
  <soapenv:Header>
    <Account>
      <username>user</username>
      <password>pass</password>
    </Account>
  </soapenv:Header>
  <soapenv:Body>
    <smag:myobjinfos>
      <destAdd>Destination</destAdd>
      <Time>128</Time>
      <maxNumb>99</maxNumb>
    </smag:myobjinfos>
  </soapenv:Body>
</soapenv:Envelope> 
```

# struts2 - Struts 2 项目部署错误

> ID：13247450
> 
> 赞同：4
> 
> 时间：2012-11-06T08:50:37.123
> 
> 标签：struts2

在 jboss 上部署我的 struts2 项目时，出现以下错误：

```
10:28:44,937 INFO  [TomcatDeployer] deploy, ctxPath=/simu_interface, warUrl=.../deploy/simu_interface.war/
10:28:45,161 ERROR [[/simu_interface]] Exception starting filter struts2
java.lang.NoSuchMethodError: com.opensymphony.xwork2.config.ConfigurationManager.addConfigurationProvider(Lcom/opensymphony/xwork2/config/ConfigurationProvider;)

The web.xml file contains the following fragment:

   <filter> 
        <filter-name>struts2</filter-name> 
        <filter-class>org.apache.struts2.dispatcher.ng.filter.StrutsPrepareAndExecuteFilter</filter-class> 
    </filter> 

    <filter-mapping> 
        <filter-name>struts2</filter-name> 
        <url-pattern>/*</url-pattern> 
    </filter-mapping> 
```

以下 jars 包含在 WEB-INF/lib 文件夹中：

*   asm-3.3.jar
*   asm-commons-3.3.jar
*   asm-tree-3.3.jar
*   commons-fileupload-1.2.2.jar
*   commons-io-2.0.1.jar
*   commons-lang3-3.1.jar
*   freemarker-2.3.19.jar
*   javassist-3.11.0.GA.jar
*   log4j-1.2.14.jar
*   ognl-3.0.5.jar
*   struts2-core-2.3.4.1.jar
*   xwork-core-2.3.4.1.jar

通过按照第一个答案中的建议将 xwork-core 替换为 xwork，我收到以下错误： - 无法加载 bean：类型：com.opensymphony.xwork2.FileManager 类：com.opensymphony.xwork2.util.fs.DefaultFileManager - bean - jar:file:/D:/opt/FERMA/absapp/jboss/server/default/lib/struts2-core-2.3.4.1.jar!/struts-default.xml:32:127

跟踪如下：

```
12:04:29,617 INFO  [TomcatDeployer] deploy, ctxPath=/simu_interface, warUrl=.../deploy/simu_interface.war/
12:04:29,872 INFO  [STDOUT] 2012-11-06 12:04:29,868 DEBUG com.opensymphony.xwork2.config.providers.XmlConfigurationProvider.debug:57 - Loading action configurations from: struts-default.xml
12:04:29,899 INFO  [STDOUT] 2012-11-06 12:04:29,898 DEBUG com.opensymphony.xwork2.config.providers.XmlConfigurationProvider.debug:57 - Loaded action configuration from: struts-default.xml
12:04:29,908 INFO  [STDOUT] 2012-11-06 12:04:29,908 INFO  com.opensymphony.xwork2.config.providers.XmlConfigurationProvider.info:31 - Parsing configuration file [struts-default.xml]
12:04:29,914 INFO  [STDOUT] 2012-11-06 12:04:29,913 DEBUG com.opensymphony.xwork2.config.providers.XmlConfigurationProvider.debug:57 - Loaded type: name:xwork impl:com.opensymphony.xwork2.ObjectFactory
12:04:29,919 INFO  [STDOUT] 2012-11-06 12:04:29,918 DEBUG com.opensymphony.xwork2.config.providers.XmlConfigurationProvider.debug:57 - Loaded type:com.opensymphony.xwork2.ObjectFactory name:struts impl:org.apache.struts2.impl.StrutsObjectFactory
12:04:29,928 INFO  [STDOUT] 2012-11-06 12:04:29,926 ERROR org.apache.struts2.dispatcher.Dispatcher.error:27 - Dispatcher initialization failed
Unable to load configuration. - bean - jar:file:/D:/opt/FERMA/absapp/jboss/server/default/lib/struts2-core-2.3.4.1.jar!/struts-default.xml:32:127
    at com.opensymphony.xwork2.config.ConfigurationManager.getConfiguration(ConfigurationManager.java:58)
    at org.apache.struts2.dispatcher.Dispatcher.init_PreloadConfiguration(Dispatcher.java:390)
    at org.apache.struts2.dispatcher.Dispatcher.init(Dispatcher.java:437)
    at org.apache.struts2.dispatcher.ng.InitOperations.initDispatcher(InitOperations.java:74)
    at org.apache.struts2.dispatcher.ng.filter.StrutsPrepareAndExecuteFilter.init(StrutsPrepareAndExecuteFilter.java:51)
    at org.apache.catalina.core.ApplicationFilterConfig.getFilter(ApplicationFilterConfig.java:275)
    at org.apache.catalina.core.ApplicationFilterConfig.setFilterDef(ApplicationFilterConfig.java:397)
    at org.apache.catalina.core.ApplicationFilterConfig.<init>(ApplicationFilterConfig.java:108)
    at org.apache.catalina.core.StandardContext.filterStart(StandardContext.java:3722)
    at org.apache.catalina.core.StandardContext.start(StandardContext.java:4367)
    at org.apache.catalina.core.ContainerBase.addChildInternal(ContainerBase.java:790)
    at org.apache.catalina.core.ContainerBase.addChild(ContainerBase.java:770)
    at org.apache.catalina.core.StandardHost.addChild(StandardHost.java:553)
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
    at java.lang.reflect.Method.invoke(Method.java:597)
    at org.apache.tomcat.util.modeler.BaseModelMBean.invoke(BaseModelMBean.java:296)
    at org.jboss.mx.server.RawDynamicInvoker.invoke(RawDynamicInvoker.java:164)
    at org.jboss.mx.server.MBeanServerImpl.invoke(MBeanServerImpl.java:659)
    at org.apache.catalina.core.StandardContext.init(StandardContext.java:5312)
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
    at java.lang.reflect.Method.invoke(Method.java:597)
    at org.apache.tomcat.util.modeler.BaseModelMBean.invoke(BaseModelMBean.java:296)
    at org.jboss.mx.server.RawDynamicInvoker.invoke(RawDynamicInvoker.java:164)
    at org.jboss.mx.server.MBeanServerImpl.invoke(MBeanServerImpl.java:659)
    at org.jboss.web.tomcat.service.TomcatDeployer.performDeployInternal(TomcatDeployer.java:301)
    at org.jboss.web.tomcat.service.TomcatDeployer.performDeploy(TomcatDeployer.java:104)
    at org.jboss.web.AbstractWebDeployer.start(AbstractWebDeployer.java:375)
    at org.jboss.web.WebModule.startModule(WebModule.java:83)
    at org.jboss.web.WebModule.startService(WebModule.java:61)
    at org.jboss.system.ServiceMBeanSupport.jbossInternalStart(ServiceMBeanSupport.java:289)
    at org.jboss.system.ServiceMBeanSupport.jbossInternalLifecycle(ServiceMBeanSupport.java:245)
    at sun.reflect.GeneratedMethodAccessor3.invoke(Unknown Source)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
    at java.lang.reflect.Method.invoke(Method.java:597)
    at org.jboss.mx.interceptor.ReflectedDispatcher.invoke(ReflectedDispatcher.java:155)
    at org.jboss.mx.server.Invocation.dispatch(Invocation.java:94)
    at org.jboss.mx.server.Invocation.invoke(Invocation.java:86)
    at org.jboss.mx.server.AbstractMBeanInvoker.invoke(AbstractMBeanInvoker.java:264)
    at org.jboss.mx.server.MBeanServerImpl.invoke(MBeanServerImpl.java:659)
    at org.jboss.system.ServiceController$ServiceProxy.invoke(ServiceController.java:978)
    at $Proxy0.start(Unknown Source)
    at org.jboss.system.ServiceController.start(ServiceController.java:417)
    at sun.reflect.GeneratedMethodAccessor9.invoke(Unknown Source)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
    at java.lang.reflect.Method.invoke(Method.java:597)
    at org.jboss.mx.interceptor.ReflectedDispatcher.invoke(ReflectedDispatcher.java:155)
    at org.jboss.mx.server.Invocation.dispatch(Invocation.java:94)
    at org.jboss.mx.server.Invocation.invoke(Invocation.java:86)
    at org.jboss.mx.server.AbstractMBeanInvoker.invoke(AbstractMBeanInvoker.java:264)
    at org.jboss.mx.server.MBeanServerImpl.invoke(MBeanServerImpl.java:659)
    at org.jboss.mx.util.MBeanProxyExt.invoke(MBeanProxyExt.java:210)
    at $Proxy44.start(Unknown Source)
    at org.jboss.web.AbstractWebContainer.start(AbstractWebContainer.java:466)
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
    at java.lang.reflect.Method.invoke(Method.java:597)
    at org.jboss.mx.interceptor.ReflectedDispatcher.invoke(ReflectedDispatcher.java:155)
    at org.jboss.mx.server.Invocation.dispatch(Invocation.java:94)
    at org.jboss.mx.interceptor.AbstractInterceptor.invoke(AbstractInterceptor.java:133)
    at org.jboss.mx.server.Invocation.invoke(Invocation.java:88)
    at org.jboss.mx.interceptor.ModelMBeanOperationInterceptor.invoke(ModelMBeanOperationInterceptor.java:142)
    at org.jboss.mx.interceptor.DynamicInterceptor.invoke(DynamicInterceptor.java:97)
    at org.jboss.system.InterceptorServiceMBeanSupport.invokeNext(InterceptorServiceMBeanSupport.java:238)
    at org.jboss.wsf.container.jboss42.DeployerInterceptor.start(DeployerInterceptor.java:87)
    at org.jboss.deployment.SubDeployerInterceptorSupport$XMBeanInterceptor.start(SubDeployerInterceptorSupport.java:188)
    at org.jboss.deployment.SubDeployerInterceptor.invoke(SubDeployerInterceptor.java:95)
    at org.jboss.mx.server.Invocation.invoke(Invocation.java:88)
    at org.jboss.mx.server.AbstractMBeanInvoker.invoke(AbstractMBeanInvoker.java:264)
    at org.jboss.mx.server.MBeanServerImpl.invoke(MBeanServerImpl.java:659)
    at org.jboss.mx.util.MBeanProxyExt.invoke(MBeanProxyExt.java:210)
    at $Proxy45.start(Unknown Source)
    at org.jboss.deployment.MainDeployer.start(MainDeployer.java:1025)
    at org.jboss.deployment.MainDeployer.deploy(MainDeployer.java:819)
    at org.jboss.deployment.MainDeployer.deploy(MainDeployer.java:782)
    at sun.reflect.GeneratedMethodAccessor21.invoke(Unknown Source)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
    at java.lang.reflect.Method.invoke(Method.java:597)
    at org.jboss.mx.interceptor.ReflectedDispatcher.invoke(ReflectedDispatcher.java:155)
    at org.jboss.mx.server.Invocation.dispatch(Invocation.java:94)
    at org.jboss.mx.interceptor.AbstractInterceptor.invoke(AbstractInterceptor.java:133)
    at org.jboss.mx.server.Invocation.invoke(Invocation.java:88)
    at org.jboss.mx.interceptor.ModelMBeanOperationInterceptor.invoke(ModelMBeanOperationInterceptor.java:142)
    at org.jboss.mx.server.Invocation.invoke(Invocation.java:88)
    at org.jboss.mx.server.AbstractMBeanInvoker.invoke(AbstractMBeanInvoker.java:264)
    at org.jboss.mx.server.MBeanServerImpl.invoke(MBeanServerImpl.java:659)
    at org.jboss.mx.util.MBeanProxyExt.invoke(MBeanProxyExt.java:210)
    at $Proxy9.deploy(Unknown Source)
    at org.jboss.deployment.scanner.URLDeploymentScanner.deploy(URLDeploymentScanner.java:421)
    at org.jboss.deployment.scanner.URLDeploymentScanner.scan(URLDeploymentScanner.java:610)
    at org.jboss.deployment.scanner.AbstractDeploymentScanner$ScannerThread.doScan(AbstractDeploymentScanner.java:263)
    at org.jboss.deployment.scanner.AbstractDeploymentScanner$ScannerThread.loop(AbstractDeploymentScanner.java:274)
    at org.jboss.deployment.scanner.AbstractDeploymentScanner$ScannerThread.run(AbstractDeploymentScanner.java:225)
Caused by: Unable to load bean: type:com.opensymphony.xwork2.FileManager class:com.opensymphony.xwork2.util.fs.DefaultFileManager - bean - jar:file:/D:/opt/FERMA/absapp/jboss/server/default/lib/struts2-core-2.3.4.1.jar!/struts-default.xml:32:127
    at com.opensymphony.xwork2.config.providers.XmlConfiguration
12:04:29,928 INFO  [STDOUT] Provider.register(XmlConfigurationProvider.java:222)
    at org.apache.struts2.config.StrutsXmlConfigurationProvider.register(StrutsXmlConfigurationProvider.java:102)
    at com.opensymphony.xwork2.config.impl.DefaultConfiguration.reloadContainer(DefaultConfiguration.java:165)
    at com.opensymphony.xwork2.config.ConfigurationManager.getConfiguration(ConfigurationManager.java:55)
    ... 96 more
Caused by: java.lang.ClassNotFoundException: com.opensymphony.xwork2.util.fs.DefaultFileManager
    at org.apache.catalina.loader.WebappClassLoader.loadClass(WebappClassLoader.java:1358)
    at org.apache.catalina.loader.WebappClassLoader.loadClass(WebappClassLoader.java:1204)
    at com.opensymphony.xwork2.util.ClassLoaderUtil.loadClass(ClassLoaderUtil.java:146)
    at com.opensymphony.xwork2.config.providers.XmlConfigurationProvider.register(XmlConfigurationProvider.java:193)
    ... 99 more
12:04:29,930 ERROR [[/simu_interface]] Exception starting filter struts2
Unable to load configuration. - bean - jar:file:/D:/opt/FERMA/absapp/jboss/server/default/lib/struts2-core-2.3.4.1.jar!/struts-default.xml:32:127
    at org.apache.struts2.dispatcher.Dispatcher.init(Dispatcher.java:450)
    at org.apache.struts2.dispatcher.ng.InitOperations.initDispatcher(InitOperations.java:74)
    at org.apache.struts2.dispatcher.ng.filter.StrutsPrepareAndExecuteFilter.init(StrutsPrepareAndExecuteFilter.java:51)
    at org.apache.catalina.core.ApplicationFilterConfig.getFilter(ApplicationFilterConfig.java:275)
    at org.apache.catalina.core.ApplicationFilterConfig.setFilterDef(ApplicationFilterConfig.java:397)
    at org.apache.catalina.core.ApplicationFilterConfig.<init>(ApplicationFilterConfig.java:108)
    at org.apache.catalina.core.StandardContext.filterStart(StandardContext.java:3722)
    at org.apache.catalina.core.StandardContext.start(StandardContext.java:4367)
    at org.apache.catalina.core.ContainerBase.addChildInternal(ContainerBase.java:790)
    at org.apache.catalina.core.ContainerBase.addChild(ContainerBase.java:770)
    at org.apache.catalina.core.StandardHost.addChild(StandardHost.java:553)
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
    at java.lang.reflect.Method.invoke(Method.java:597)
    at org.apache.tomcat.util.modeler.BaseModelMBean.invoke(BaseModelMBean.java:296)
    at org.jboss.mx.server.RawDynamicInvoker.invoke(RawDynamicInvoker.java:164)
    at org.jboss.mx.server.MBeanServerImpl.invoke(MBeanServerImpl.java:659)
    at org.apache.catalina.core.StandardContext.init(StandardContext.java:5312)
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
    at java.lang.reflect.Method.invoke(Method.java:597)
    at org.apache.tomcat.util.modeler.BaseModelMBean.invoke(BaseModelMBean.java:296)
    at org.jboss.mx.server.RawDynamicInvoker.invoke(RawDynamicInvoker.java:164)
    at org.jboss.mx.server.MBeanServerImpl.invoke(MBeanServerImpl.java:659)
    at org.jboss.web.tomcat.service.TomcatDeployer.performDeployInternal(TomcatDeployer.java:301)
    at org.jboss.web.tomcat.service.TomcatDeployer.performDeploy(TomcatDeployer.java:104)
    at org.jboss.web.AbstractWebDeployer.start(AbstractWebDeployer.java:375)
    at org.jboss.web.WebModule.startModule(WebModule.java:83)
    at org.jboss.web.WebModule.startService(WebModule.java:61)
    at org.jboss.system.ServiceMBeanSupport.jbossInternalStart(ServiceMBeanSupport.java:289)
    at org.jboss.system.ServiceMBeanSupport.jbossInternalLifecycle(ServiceMBeanSupport.java:245)
    at sun.reflect.GeneratedMethodAccessor3.invoke(Unknown Source)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
    at java.lang.reflect.Method.invoke(Method.java:597)
    at org.jboss.mx.interceptor.ReflectedDispatcher.invoke(ReflectedDispatcher.java:155)
    at org.jboss.mx.server.Invocation.dispatch(Invocation.java:94)
    at org.jboss.mx.server.Invocation.invoke(Invocation.java:86)
    at org.jboss.mx.server.AbstractMBeanInvoker.invoke(AbstractMBeanInvoker.java:264)
    at org.jboss.mx.server.MBeanServerImpl.invoke(MBeanServerImpl.java:659)
    at org.jboss.system.ServiceController$ServiceProxy.invoke(ServiceController.java:978)
    at $Proxy0.start(Unknown Source)
    at org.jboss.system.ServiceController.start(ServiceController.java:417)
    at sun.reflect.GeneratedMethodAccessor9.invoke(Unknown Source)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
    at java.lang.reflect.Method.invoke(Method.java:597)
    at org.jboss.mx.interceptor.ReflectedDispatcher.invoke(ReflectedDispatcher.java:155)
    at org.jboss.mx.server.Invocation.dispatch(Invocation.java:94)
    at org.jboss.mx.server.Invocation.invoke(Invocation.java:86)
    at org.jboss.mx.server.AbstractMBeanInvoker.invoke(AbstractMBeanInvoker.java:264)
    at org.jboss.mx.server.MBeanServerImpl.invoke(MBeanServerImpl.java:659)
    at org.jboss.mx.util.MBeanProxyExt.invoke(MBeanProxyExt.java:210)
    at $Proxy44.start(Unknown Source)
    at org.jboss.web.AbstractWebContainer.start(AbstractWebContainer.java:466)
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
    at java.lang.reflect.Method.invoke(Method.java:597)
    at org.jboss.mx.interceptor.ReflectedDispatcher.invoke(ReflectedDispatcher.java:155)
    at org.jboss.mx.server.Invocation.dispatch(Invocation.java:94)
    at org.jboss.mx.interceptor.AbstractInterceptor.invoke(AbstractInterceptor.java:133)
    at org.jboss.mx.server.Invocation.invoke(Invocation.java:88)
    at org.jboss.mx.interceptor.ModelMBeanOperationInterceptor.invoke(ModelMBeanOperationInterceptor.java:142)
    at org.jboss.mx.interceptor.DynamicInterceptor.invoke(DynamicInterceptor.java:97)
    at org.jboss.system.InterceptorServiceMBeanSupport.invokeNext(InterceptorServiceMBeanSupport.java:238)
    at org.jboss.wsf.container.jboss42.DeployerInterceptor.start(DeployerInterceptor.java:87)
    at org.jboss.deployment.SubDeployerInterceptorSupport$XMBeanInterceptor.start(SubDeployerInterceptorSupport.java:188)
    at org.jboss.deployment.SubDeployerInterceptor.invoke(SubDeployerInterceptor.java:95)
    at org.jboss.mx.server.Invocation.invoke(Invocation.java:88)
    at org.jboss.mx.server.AbstractMBeanInvoker.invoke(AbstractMBeanInvoker.java:264)
    at org.jboss.mx.server.MBeanServerImpl.invoke(MBeanServerImpl.java:659)
    at org.jboss.mx.util.MBeanProxyExt.invoke(MBeanProxyExt.java:210)
    at $Proxy45.start(Unknown Source)
    at org.jboss.deployment.MainDeployer.start(MainDeployer.java:1025)
    at org.jboss.deployment.MainDeployer.deploy(MainDeployer.java:819)
    at org.jboss.deployment.MainDeployer.deploy(MainDeployer.java:782)
    at sun.reflect.GeneratedMethodAccessor21.invoke(Unknown Source)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
    at java.lang.reflect.Method.invoke(Method.java:597)
    at org.jboss.mx.interceptor.ReflectedDispatcher.invoke(ReflectedDispatcher.java:155)
    at org.jboss.mx.server.Invocation.dispatch(Invocation.java:94)
    at org.jboss.mx.interceptor.AbstractInterceptor.invoke(AbstractInterceptor.java:133)
    at org.jboss.mx.server.Invocation.invoke(Invocation.java:88)
    at org.jboss.mx.interceptor.ModelMBeanOperationInterceptor.invoke(ModelMBeanOperationInterceptor.java:142)
    at org.jboss.mx.server.Invocation.invoke(Invocation.java:88)
    at org.jboss.mx.server.AbstractMBeanInvoker.invoke(AbstractMBeanInvoker.java:264)
    at org.jboss.mx.server.MBeanServerImpl.invoke(MBeanServerImpl.java:659)
    at org.jboss.mx.util.MBeanProxyExt.invoke(MBeanProxyExt.java:210)
    at $Proxy9.deploy(Unknown Source)
    at org.jboss.deployment.scanner.URLDeploymentScanner.deploy(URLDeploymentScanner.java:421)
    at org.jboss.deployment.scanner.URLDeploymentScanner.scan(URLDeploymentScanner.java:610)
    at org.jboss.deployment.scanner.AbstractDeploymentScanner$ScannerThread.doScan(AbstractDeploymentScanner.java:263)
    at org.jboss.deployment.scanner.AbstractDeploymentScanner$ScannerThread.loop(AbstractDeploymentScanner.java:274)
    at org.jboss.deployment.scanner.AbstractDeploymentScanner$ScannerThread.run(AbstractDeploymentScanner.java:225)
Caused by: Unable to load configuration. - bean - jar:file:/D:/opt/FERMA/absapp/jboss/server/default/lib/struts2-core-2.3.4.1.jar!/struts-default.xml:32:127
    at com.opensymphony.xwork2.config.ConfigurationManager.getConfiguration(ConfigurationManager.java:58)
    at org.apache.struts2.dispatcher.Dispatcher.init_PreloadConfiguration(Dispatcher.java:390)
    at org.apache.struts2.dispatcher.Dispatcher.init(Dispatcher.java:437)
    ... 94 more
Caused by: Unable to load bean: type:com.opensymphony.xwork2.FileManager class:com.opensymphony.xwork2.util.fs.DefaultFileManager - bean - jar:file:/D:/opt/FERMA/absapp/jboss/server/default/lib/struts2-core-2.3.4.1.jar!/struts-default.xml:32:127
    at com.opensymphony.xwork2.config.providers.XmlConfigurationProvider.register(XmlConfigurationProvider.java:222)
    at org.apache.struts2.config.StrutsXmlConfigurationProvider.register(StrutsXmlConfigurationProvider.java:102)
    at com.opensymphony.xwork2.config.impl.DefaultConfiguration.reloadContainer(DefaultConfiguration.java:165)
    at com.opensymphony.xwork2.config.ConfigurationManager.getConfiguration(ConfigurationManager.java:55)
    ... 96 more
Caused by: java.lang.ClassNotFoundException: com.opensymphony.xwork2.util.fs.DefaultFileManager
    at org.apache.catalina.loader.WebappClassLoader.loadClass(WebappClassLoader.java:1358)
    at org.apache.catalina.loader.WebappClassLoader.loadClass(WebappClassLoader.java:1204)
    at com.opensymphony.xwork2.util.ClassLoaderUtil.loadClass(ClassLoaderUtil.java:146)
    at com.opensymphony.xwork2.config.providers.XmlConfigurationProvider.register(XmlConfigurationProvider.java:193)
    ... 99 more
12:04:29,930 ERROR [StandardContext] Error filterStart
12:04:29,930 ERROR [StandardContext] Context [/simu_interface] startup failed due to previous errors
12:04:29,953 WARN  [ServiceController] Problem starting service jboss.web.deployment:war=simu_interface.war,id=-1286432096
org.jboss.deployment.DeploymentException: URL file:/D:/opt/FERMA/absapp/jboss/server/default/deploy/simu_interface.war/ deployment failed
    at org.jboss.web.tomcat.service.TomcatDeployer.performDeployInternal(TomcatDeployer.java:379)
    at org.jboss.web.tomcat.service.TomcatDeployer.performDeploy(TomcatDeployer.java:104)
    at org.jboss.web.AbstractWebDeployer.start(AbstractWebDeployer.java:375)
    at org.jboss.web.WebModule.startModule(WebModule.java:83)
    at org.jboss.web.WebModule.startService(WebModule.java:61)
    at org.jboss.system.ServiceMBeanSupport.jbossInternalStart(ServiceMBeanSupport.java:289)
    at org.jboss.system.ServiceMBeanSupport.jbossInternalLifecycle(ServiceMBeanSupport.java:245)
    at sun.reflect.GeneratedMethodAccessor3.invoke(Unknown Source)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
    at java.lang.reflect.Method.invoke(Method.java:597)
    at org.jboss.mx.interceptor.ReflectedDispatcher.invoke(ReflectedDispatcher.java:155)
    at org.jboss.mx.server.Invocation.dispatch(Invocation.java:94)
    at org.jboss.mx.server.Invocation.invoke(Invocation.java:86)
    at org.jboss.mx.server.AbstractMBeanInvoker.invoke(AbstractMBeanInvoker.java:264)
    at org.jboss.mx.server.MBeanServerImpl.invoke(MBeanServerImpl.java:659)
    at org.jboss.system.ServiceController$ServiceProxy.invoke(ServiceController.java:978)
    at $Proxy0.start(Unknown Source)
    at org.jboss.system.ServiceController.start(ServiceController.java:417)
    at sun.reflect.GeneratedMethodAccessor9.invoke(Unknown Source)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
    at java.lang.reflect.Method.invoke(Method.java:597)
    at org.jboss.mx.interceptor.ReflectedDispatcher.invoke(ReflectedDispatcher.java:155)
    at org.jboss.mx.server.Invocation.dispatch(Invocation.java:94)
    at org.jboss.mx.server.Invocation.invoke(Invocation.java:86)
    at org.jboss.mx.server.AbstractMBeanInvoker.invoke(AbstractMBeanInvoker.java:264)
    at org.jboss.mx.server.MBeanServerImpl.invoke(MBeanServerImpl.java:659)
    at org.jboss.mx.util.MBeanProxyExt.invoke(MBeanProxyExt.java:210)
    at $Proxy44.start(Unknown Source)
    at org.jboss.web.AbstractWebContainer.start(AbstractWebContainer.java:466)
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
    at java.lang.reflect.Method.invoke(Method.java:597)
    at org.jboss.mx.interceptor.ReflectedDispatcher.invoke(ReflectedDispatcher.java:155)
    at org.jboss.mx.server.Invocation.dispatch(Invocation.java:94)
    at org.jboss.mx.interceptor.AbstractInterceptor.invoke(AbstractInterceptor.java:133)
    at org.jboss.mx.server.Invocation.invoke(Invocation.java:88)
    at org.jboss.mx.interceptor.ModelMBeanOperationInterceptor.invoke(ModelMBeanOperationInterceptor.java:142)
    at org.jboss.mx.interceptor.DynamicInterceptor.invoke(DynamicInterceptor.java:97)
    at org.jboss.system.InterceptorServiceMBeanSupport.invokeNext(InterceptorServiceMBeanSupport.java:238)
    at org.jboss.wsf.container.jboss42.DeployerInterceptor.start(DeployerInterceptor.java:87)
    at org.jboss.deployment.SubDeployerInterceptorSupport$XMBeanInterceptor.start(SubDeployerInterceptorSupport.java:188)
    at org.jboss.deployment.SubDeployerInterceptor.invoke(SubDeployerInterceptor.java:95)
    at org.jboss.mx.server.Invocation.invoke(Invocation.java:88)
    at org.jboss.mx.server.AbstractMBeanInvoker.invoke(AbstractMBeanInvoker.java:264)
    at org.jboss.mx.server.MBeanServerImpl.invoke(MBeanServerImpl.java:659)
    at org.jboss.mx.util.MBeanProxyExt.invoke(MBeanProxyExt.java:210)
    at $Proxy45.start(Unknown Source)
    at org.jboss.deployment.MainDeployer.start(MainDeployer.java:1025)
    at org.jboss.deployment.MainDeployer.deploy(MainDeployer.java:819)
    at org.jboss.deployment.MainDeployer.deploy(MainDeployer.java:782)
    at sun.reflect.GeneratedMethodAccessor21.invoke(Unknown Source)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
    at java.lang.reflect.Method.invoke(Method.java:597)
    at org.jboss.mx.interceptor.ReflectedDispatcher.invoke(ReflectedDispatcher.java:155)
    at org.jboss.mx.server.Invocation.dispatch(Invocation.java:94)
    at org.jboss.mx.interceptor.AbstractInterceptor.invoke(AbstractInterceptor.java:133)
    at org.jboss.mx.server.Invocation.invoke(Invocation.java:88)
    at org.jboss.mx.interceptor.ModelMBeanOperationInterceptor.invoke(ModelMBeanOperationInterceptor.java:142)
    at org.jboss.mx.server.Invocation.invoke(Invocation.java:88)
    at org.jboss.mx.server.AbstractMBeanInvoker.invoke(AbstractMBeanInvoker.java:264)
    at org.jboss.mx.server.MBeanServerImpl.invoke(MBeanServerImpl.java:659)
    at org.jboss.mx.util.MBeanProxyExt.invoke(MBeanProxyExt.java:210)
    at $Proxy9.deploy(Unknown Source)
    at org.jboss.deployment.scanner.URLDeploymentScanner.deploy(URLDeploymentScanner.java:421)
    at org.jboss.deployment.scanner.URLDeploymentScanner.scan(URLDeploymentScanner.java:610)
    at org.jboss.deployment.scanner.AbstractDeploymentScanner$ScannerThread.doScan(AbstractDeploymentScanner.java:263)
    at org.jboss.deployment.scanner.AbstractDeploymentScanner$ScannerThread.loop(AbstractDeploymentScanner.java:274)
    at org.jboss.deployment.scanner.AbstractDeploymentScanner$ScannerThread.run(AbstractDeploymentScanner.java:225)
12:04:29,953 ERROR [MainDeployer] Could not start deployment: file:/D:/opt/FERMA/absapp/jboss/server/default/deploy/simu_interface.war/
org.jboss.deployment.DeploymentException: URL file:/D:/opt/FERMA/absapp/jboss/server/default/deploy/simu_interface.war/ deployment failed
    at org.jboss.web.tomcat.service.TomcatDeployer.performDeployInternal(TomcatDeployer.java:379)
    at org.jboss.web.tomcat.service.TomcatDeployer.performDeploy(TomcatDeployer.java:104)
    at org.jboss.web.AbstractWebDeployer.start(AbstractWebDeployer.java:375)
    at org.jboss.web.WebModule.startModule(WebModule.java:83)
    at org.jboss.web.WebModule.startService(WebModule.java:61)
    at org.jboss.system.ServiceMBeanSupport.jbossInternalStart(ServiceMBeanSupport.java:289)
    at org.jboss.system.ServiceMBeanSupport.jbossInternalLifecycle(ServiceMBeanSupport.java:245)
    at sun.reflect.GeneratedMethodAccessor3.invoke(Unknown Source)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
    at java.lang.reflect.Method.invoke(Method.java:597)
    at org.jboss.mx.interceptor.ReflectedDispatcher.invoke(ReflectedDispatcher.java:155)
    at org.jboss.mx.server.Invocation.dispatch(Invocation.java:94)
    at org.jboss.mx.server.Invocation.invoke(Invocation.java:86)
    at org.jboss.mx.server.AbstractMBeanInvoker.invoke(AbstractMBeanInvoker.java:264)
    at org.jboss.mx.server.MBeanServerImpl.invoke(MBeanServerImpl.java:659)
    at org.jboss.system.ServiceController$ServiceProxy.invoke(ServiceController.java:978)
    at $Proxy0.start(Unknown Source)
    at org.jboss.system.ServiceController.start(ServiceController.java:417)
    at sun.reflect.GeneratedMethodAccessor9.invoke(Unknown Source)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
    at java.lang.reflect.Method.invoke(Method.java:597) 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-06T09:02:56.570

xwork-core-2.3.4.1.jar 中的 ConfigurationManager 没有这样的方法`com.opensymphony.xwork2.config.ConfigurationManager.addConfigurationProvider(Lcom/opensymphony/xwork2/config/ConfigurationProvider;)`

删除 xwork-core-2.3.4.1.jar 和

将此[xwork-2.1.2.jar](http://www.findjar.com/jar/com/opensymphony/xwork/2.1.2/xwork-2.1.2.jar.html;jsessionid=4333293EE29CA3C8FDC5574047462BBC)添加到您的 lib 文件夹

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2020-12-02T23:46:51.463

..我最近正在处理这个错误，我可以解决它。所以我想我会在这里分享我的想法。我在观察 com.opensymphony.xwork2.config.ConfigurationManager.addConfigurationProvider(Lcom/opensymphony/xwork2/config/ConfigurationProvider;) 的 jar 文件中的代码时注意到，自 struts2.1 以来，该方法已被弃用。因此，我尝试使用旧版本，并将以下 jar 文件包含在我的 lib 文件夹中。

1.  struts2-core-2.0.11.jar
2.  xwork-2.0.4.jar

我使用的是 tomcat 8.0，因为 Tomcat 7.0 无法识别某些方法。我还想分享 jar 文件版本的已弃用类和方法的链接。通过这种方式，您将了解要使用哪些 jar 文件以及不推荐使用哪些方法。请检查以下链接：

[http://javadox.com/org.apache.struts/struts2-core/2.1.8/deprecated-list.html#method](http://javadox.com/org.apache.struts/struts2-core/2.1.8/deprecated-list.html#method)

当我更改 jar 文件时它对我有用..希望对你也有用..快乐编码！！！！

# email - CakeEmail 无法发送电子邮件

> ID：13247452
> 
> 赞同：0
> 
> 时间：2012-11-06T08:50:49.880
> 
> 标签：email, cakephp, cakephp-2.2

我需要帮助，伙计们。我无法让这个工作。你可以帮帮我吗？

提前致谢！

**配置/电子邮件.php**

```
public $default = array(
        'transport' => 'Mail',
        'from' => 'sender@yahoo.com',
        'charset' => 'utf-8',
        'headerCharset' => 'utf-8',
); 
```

反馈控制器.php

```
App::uses('AppController', 'Controller');
App::uses('CakeEmail', 'Network/Email');
*
*
*
public function send() {
     $email    = new CakeEmail('default');
     $email->emailFormat('text')
           ->to('recipient@yahoo.com')
           ->from('sender@yahoo.com')
           ->send('Message Body');
} 
```

上面的代码给了我一个错误：

无法发送电子邮件。

```
Error: An Internal Error Has Occurred. 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-02-11T09:06:28.547

你可以使用这个：在 app/config/email.php 添加这个新配置

```
public $gmail = array(
    'host' => 'ssl://smtp.gmail.com',
    'port' => 465,
    'username' => 'adresse@gmail.com',
    'password' => 'secret',
    'transport' => 'Smtp',
    'timeout' => 1
); 
```

之后，在您的控制器中，您必须调用：

```
$email    = new CakeEmail('gmail'); 
```

这就对了。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-06T09:45:18.473

根据我的经验，我在将 ->from 设置为单个字符串时遇到了问题，并且发现 ->from(array('emailaddress' => 'name')) 更成功。

我也不确定是否需要设置主题值才能成功工作？

# javascript - 如何在gridview内部的表格中找到控件

> ID：13247455
> 
> 赞同：1
> 
> 时间：2012-11-06T08:51:10.850
> 
> 标签：javascript, asp.net

我想在**表格中获取 ASP 控件的 ID，并且该表格位于 gridview**中......下面的代码可以让您更好地了解：

```
 <asp:GridView ID="gvTest" runat="server">
        <Columns>
            <asp:TemplateField>
                <ItemTemplate>
                    <table width="100%">
                        <tr>
                            <td><asp:Label ID="lblTestLabel" runat="server"></asp:Label></td>
                        </tr>
                    </table>
                </ItemTemplate>
            </asp:TemplateField>
        </Columns>
    </asp:GridView> 
```

**我在gridview**中获取控件没有问题，这是代码：

```
function TestFunction(sender, e)   {
    var gridview = document.getElementById('gvTest.ClientID');
    var i = gridview.rows.length - 1;
    var node1 = gridview.rows[i].cells[1].children[0];
} 
```

但是我需要将表格放在gridview中以解决格式化问题，当我这样做时，控件无法访问....所以我的问题是如何在javascript中获取ASP标签的ID（在这种情况下为lblTestLabel“） ?

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-06T10:00:29.360

如果您使用母版页，则控件名称会在运行时被替换。您可以在浏览器中按 F12 看到调试它的“真实”名称（下载 firebug for firefox）。

检索控件的最佳方法是使用 jQuery，您可以使用占位符访问它，例如

```
var value = $('[id$=lblTestLabel]').val(); 
```

# java - If else 按钮 的条件，Grails

> ID：13247456
> 
> 赞同：0
> 
> 时间：2012-11-06T08:51:19.380
> 
> 标签：java, grails, if-statement, gsp

我在 Grails 中寻找按钮 if/else 的控制器代码。

当用户选择时，我有单选按钮的代码：

```
<g:radio name="myGroup" value ="input2" />

if (request.getParameter("myGroup").equals("input1"))
        {

        println("asdasdasdasdasdhelloipass")
        redirect (action: radio)

        } 
```

这就是它的工作原理，但是对于按钮，当用户单击按钮时它的 if 条件是什么。提前致谢。

```
 <g:actionSubmit value="Submit" action="abc"/> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-23T03:25:01.063

你想做什么？“actionSubmit”标签会将表单参数提交给名为“abc”的动作。

```
class SomeController {

    def index() { }

def abc() {
        log.debug("called abc")
    }
} 
```

一些/index.gsp

```
<html>
    <head>
    </head>
    <body>
        <g:form>
            <g:actionSubmit value="blah" action="abc"/>
        </g:form>
    </body>
</html> 
```

# algorithm - 二维空间中点的秩查找算法

> ID：13247457
> 
> 赞同：1
> 
> 时间：2012-11-06T08:51:24.713
> 
> 标签：algorithm, sorting, rank

秩查找问题：在二维空间中，`A=(a1,a2)`当且仅当 a1>b1 且 b1>b2 时，我们将说一个点支配一个点 B=(b1,b2)。给定一组 n 个点，点 X 的等级是由 X 支配的点数。设计一个算法来找到每个点的等级。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-06T09:05:43.260

按第一个坐标对点进行排序。然后将它们插入到 order-statistics 树中，按第二个坐标对它们进行排序。

插入时排序统计树中的点的排名正是点的数量，由该点支配。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-25T04:36:55.623

小波树数据结构解决了这个问题。我认为它的构建与 Evgeny 和 pogo 所描述的过程基本相同。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-06T09:10:56.390

使用稳定排序两次，按第一个属性排序，然后按第二个属性排序。最终排序数组中的位置给出了给定点占主导地位的点数。

# asp.net - asp.net + facebook 创建事件

> ID：13247460
> 
> 赞同：0
> 
> 时间：2012-11-06T08:51:34.510
> 
> 标签：asp.net, facebook

我正在尝试在我的应用程序中创建一个事件，但不断收到此“无效参数”错误：

```
(OAuthException - #100) (#100) Invalid parameter 
```

当它击中时：

```
JsonObject result = facebookClient.Post("/me/events", createEventParameters) as JsonObject; 
```

改了好几次参数还是没用，大家可以指点一下：

```
 public string CreateEvent()
    {
            var accessToken = accessTok;
            FacebookClient facebookClient = new FacebookClient(accessToken);
            Dictionary<string, object> createEventParameters = new Dictionary<string, object>();
            createEventParameters.Add("owner", "Me");
            createEventParameters.Add("name", "Test Event");
            createEventParameters.Add("description", "This is a test event.");
            createEventParameters.Add("start_time", DateTime.Now.AddDays(2).ToUniversalTime().ToString());
            createEventParameters.Add("end_time", DateTime.Now.AddDays(2).AddHours(4).ToUniversalTime().ToString());
            createEventParameters.Add("location", "A Street");

            // Sample venue
            JsonObject venueParameters = new JsonObject();
            venueParameters.Add("street", "19 Phipps St");
            venueParameters.Add("city", "Toronto");
            venueParameters.Add("state", "ON");
            venueParameters.Add("zip", "L2A 2V2");
            venueParameters.Add("country", "Canada");
            venueParameters.Add("latitude", "43.6654507");
            venueParameters.Add("longitude", "-79.38569580000001");
            createEventParameters.Add("venue", venueParameters);

            createEventParameters.Add("privacy", "SECRET");
            createEventParameters.Add("updated_time", DateTime.Now.ToString());

            //Add the event logo image
            FacebookMediaObject logo = new FacebookMediaObject()
                                           {
                                               ContentType = "image/png",
                                               FileName = @"D:/Downloads/bb.png"
                                           };
            logo.SetValue(File.ReadAllBytes(logo.FileName));
            createEventParameters[@"D:/Downloads/bb.png"] = logo;

            JsonObject result = facebookClient.Post("/me/events", createEventParameters) as JsonObject;
            return result["id"].ToString();
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-06T12:25:20.417

好吧，我的日期格式无效。对于 FB 文档：

注意 - 在“事件时区”迁移之后，所有事件时间都是 ISO-8601 格式的字符串；它们不能再被指定为时间戳。接受以下格式：

仅日期（例如，'2012-07-04'）：有日期但还没有具体时间的事件。精确时间（例如，'2012-07-04T19:00:00-0700'）：在特定时间点开始的事件，在与 UTC 的特定偏移量中。这是新的 Facebook 事件跟踪时间的方式，并允许用户查看不同时区的事件。

# neo4j - 如何在 CypherFluentQuery 中使用 NodeReferences？

> ID：13247462
> 
> 赞同：1
> 
> 时间：2012-11-06T08:51:51.860
> 
> 标签：neo4j, cypher, neo4jclient

我一直在试验 Neo4J，文本查询工作得很好。然后我切换到 .Net 中的 Neo4JClient，现在我想使用 CypherFluentQuery，但由于某些非常奇怪的原因，生成的查询不包括节点 ID，而只包括像 {p0}、p{1} 这样的占位符...... ) 我错过了什么？

下面是我的简单查询示例：

文本查询（工作正常）：

```
string textQuery = "START user=node(9,7,8,10,11) " +
"MATCH user-[:is_friend_of]->isfriendof " +
"RETURN user.name as user,isfriendof.name as IsFriendOf";

CypherQuery query = new CypherQuery(textQuery,
new Dictionary<string, object>(),
CypherResultMode.Projection);
var nodes = client.ExecuteGetCypherResults<MyNode>(query).ToList(); 
```

现在是 CypherFluentQuery（抛出异常）：

```
NodeReference<TestNode> node1 = new NodeReference<TestNode>(9);
NodeReference<TestNode> node2 =new NodeReference<TestNode>(7);
NodeReference<TestNode> node3 = new NodeReference<TestNode>(8);
NodeReference<TestNode> node4 = new NodeReference<TestNode>(10);
NodeReference<TestNode> node5 = new NodeReference<TestNode>(11);

NodeReference [] nodes = { node1, node2, node3, node4, node5  };
var results = new CypherFluentQuery(client)
                                    .Start("user", nodes)
                                    .Match("user-[:is_friend_of]->isfriendof")
                                    .Return<MyNode>("user.name as user,isfriendof.name as     IsFriendOf", CypherResultMode.Projection)
                                    .Results.ToList(); 
```

引用的节点类如下：

```
public class MyNode
{
    public string user { get; set; }
    public string IsFriendOf { get; set; }
}

public class TestNode 
{

    public string name { get; set; }
} 
```

**抛出异常：**

```
Received an unexpected HTTP status when executing the request.

The query was: START user=node({p0}, {p1}, {p2}, {p3}, {p4})
MATCH user-[:is_friend_of]->isfriendof
RETURN user.name as user,isfriendof.name as IsFriendOf

The response status was: 400 Bad Request 
```

***更新*** 我用 nugget 更新了 Neo4JClient，现在显然我不能使用 ExecuteGetCypherResults，所以我想我现在的问题比以往任何时候都更有效：-/

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-02T13:55:59.937

`{p0}`样式占位符是正确的。（请参阅[https://bitbucket.org/Readify/neo4jclient/wiki/cypher的](https://bitbucket.org/Readify/neo4jclient/wiki/cypher)*参数*部分以了解它们存在的原因）。

Neo4j 返回的 400 错误意味着它不喜欢发送的查询文本。

在您的问题中，您已经在有用的部分截断了异常消息。我们需要响应主体来查看 Neo4j 有什么问题，这在响应状态之后。

要在本地调试查询文本，还有[https://bitbucket.org/Readify/neo4jclient/wiki/cypher中描述的技术](https://bitbucket.org/Readify/neo4jclient/wiki/cypher)

# ios - 如何将相机拍摄的图像缩小到 320x320 分辨率？

> ID：13247466
> 
> 赞同：0
> 
> 时间：2012-11-06T08:52:02.317
> 
> 标签：ios, xcode, ipad, uiimagepickercontroller

> **可能重复：**
> [使用 iPhone SDK 调整/优化图像大小的最简单方法是什么？](https://stackoverflow.com/questions/612131/whats-the-easiest-way-to-resize-optimize-an-image-size-with-the-iphone-sdk)

我想将从相机拍摄的图像分辨率更改为 320x320。谁能告诉我该怎么做。

我知道如何从相机拍摄图像。所以请告诉我剩下的（即）改变图像的分辨率。

提前致谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-06T09:00:10.523

这在这篇文章中被称为：[https ://stackoverflow.com/a/613380/1648976](https://stackoverflow.com/a/613380/1648976)

```
+ (UIImage*)imageWithImage:(UIImage*)image 
           scaledToSize:(CGSize)newSize;
{
UIGraphicsBeginImageContext( newSize );
[image drawInRect:CGRectMake(0,0,newSize.width,newSize.height)];
UIImage* newImage = UIGraphicsGetImageFromCurrentImageContext();
UIGraphicsEndImageContext();

return newImage;
} 
```

就图像的存储而言，iPhone 使用最快的图像格式是 PNG，因为它对该格式进行了优化。但是，如果您想将这些图像存储为 JPEG，您可以使用 UIImage 并执行以下操作：

```
 NSData *dataForJPEGFile = UIImageJPEGRepresentation(theImage, 0.6); 
```

这将创建一个 NSData 实例，其中包含质量设置为 60% 的 JPEG 图像的原始字节。然后可以将该 NSData 实例的内容写入磁盘或缓存在内存中。

这会进行转换，而不是完全转换为 320*320.. 但您可以将 0.6 调整为更低或更高。

如果这不是您想要的，请更准确地告诉我

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-06T09:00:54.627

1) 对原始图像进行低通滤波和
2) 抽取或
3) 重新采样

如果原始尺寸为 640x320，则进行 LP 过滤然后选择每隔一个样本就足够了。那是抽取。

如果原始尺寸是例如 480x320，那么仍然必须为那些与原始像素不完全对齐的像素进行 LP 过滤和内插像素值。

LP 过滤至关重要，因为没有它，例如非常高分辨率的棋盘图案将被重新采样为噪声或奇怪的图案，这是由称为“频率混叠”的效果引起的。

# java - 将字符串数组转换为 JSON 对象？

> ID：13247468
> 
> 赞同：0
> 
> 时间：2012-11-06T08:52:17.663
> 
> 标签：java, json, gson

我从 UI 得到了 json[]。我必须将其转换为 Json 对象，如何使用**`gson`**. 接收到的对象是这样的：

```
 [{"name":"name","value":"value"},{"name":"first","value":"100"},{"name":"hor","value":"95"},{"name":"conf","value":"95"}],[{"name":"vaRType","value":"INCRE"},{"name":"per","value":"100"},{"name":"hor","value":"95"},{"name":"conf","value":"95"}] 
```

我用过`JsonObject obj = new JsoParser().parse(jsonStrnig).getAsJsonObject();` ，但它会引发异常。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-06T08:53:44.873

因为它不是有效的 json 对象。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-06T09:18:53.837

您的 JSON 应如下所示，因为目前它是无效的...

```
[
    [
        {
            "name": "name",
            "value": "value"
        },
        {
            "name": "first",
            "value": "100"
        },
        {
            "name": "hor",
            "value": "95"
        },
        {
            "name": "conf",
            "value": "95"
        }
    ],
    [
        {
            "name": "vaRType",
            "value": "INCRE"
        },
        {
            "name": "per",
            "value": "100"
        },
        {
            "name": "hor",
            "value": "95"
        },
        {
            "name": "conf",
            "value": "95"
        }
    ]
] 
```

# php - AJAX 从服务器获取数据

> ID：13247471
> 
> 赞同：0
> 
> 时间：2012-11-06T08:52:22.743
> 
> 标签：php, ajax, database

页面正在向服务器发送 AJAX 调用，并应获取项目信息作为响应。要查找/返回的数组是一个相当大的数组，我无法将它保存在 PHP 文件中以接受请求。因此，就我的知识和经验而言，有两种方法：

1.  访问每个请求的数据库。
2.  将项目存储在文件中（例如“item12.txt”）并将内容发送给用户。

我的 C 经验表明，打开和关闭文件比程序的其余部分花费更多的系统时间。它在 PHP 中如何？首选方法是什么（最重要的是资源方面）——**文件系统还是数据库**？您是否会推荐任何其他方式（例如 JavaScript 直接从服务器为每个请求加载带有变量数组的文件）？**也许你知道周围有一些创新的方法？**

*PS 在服务器端，只接受一个数字，所以不用担心有人试图访问服务器中的文件或试图在数据库上做一些花哨的事情。*

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-06T08:56:12.723

没有什么创新的。如果您对数据的调用频率较低，并且希望对数据进行超级简单的访问，请使用文件。但是我认为今天使用任何数据库（SQL lite）都好得多。如果您需要更高的性能，请使用 MySQL 或 NoSQL 解决方案。用来解决问题的工具。根据您的目的使用正确的工具。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-06T09:16:36.117

# 插座

根据您要处理的请求数量，您可以查看套接字连接。套接字为您提供客户端和服务器之间的两种通信方式，这将允许您根据需要进行交互操作。

[插座教程1](http://net.tutsplus.com/tutorials/javascript-ajax/start-using-html5-websockets-today/)
[插座教程2](http://srchea.com/blog/2011/12/build-a-real-time-application-using-html5-websockets/)

# 节点.js

node.js 是新来的。您编写自己的套接字网络服务器，并使用 javascript 与之通信。这是 Ajax 的一个很好的替代方案，因为它更加高效和可靠。

**node.js 可以与 PHP 一起运行，并且仅用于类似 ajax 的调用。**

[node.js](http://nodejs.org/)
[node.js 套接字教程](http://socket.io/)

# c - 找出 C 声明，如：double (*b)[n]

> ID：13247473
> 
> 赞同：17
> 
> 时间：2012-11-06T08:52:33.857
> 
> 标签：c, declaration

我正在尝试找出一些 C 声明。这些 C 声明的含义是什么？

```
double (*b)[n];
double (*c[n])();
double (*d())[n]; 
```

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-11-06T08:55:06.950

```
double (*b)[n]; 
```

b 是指向 n 个双精度数组的指针

```
double (*c[n])(); 
```

c 是一个包含 n 个指向函数的指针数组，该函数接受未指定数量的参数并返回 double

```
double (*d())[n]; 
```

d 是一个函数，它接受未指定数量的参数并返回指向 n 个双精度数组的指针

通常，为了在您的脑海中解析这些类型的声明，请采用以下方法。让我们看看最后一个声明，例如

```
 double (*d())[n]; 
```

对 d 做的第一件事是什么？它是用 () 调用的，因此**它是一个接受未指定数量的参数和 returnig 的函数**......结果做了什么？它被取消引用 (*)，因此它是**一个指向**. 然后对结果进行索引，因此它是**一个由 n 组成的数组**……还剩下什么？一个双，因此是**双打**。阅读粗体部分，您将得到答案。

让我们看另一个例子

```
 void (*(*f)(int)[n])(char) 
```

在这里，**f**首先被取消引用，因此它是**一个指向**...的指针，然后用 (int) 调用它，因此一个函数**采用 int 并返回**，然后用 [n] 索引结果，因此**是一个 n 的数组**。结果再次被取消引用，因此**指向**. 然后结果由 (char) 调用，因此**函数采用 char**并返回（剩下的都是 void）**void**。所以 f 是**一个指向函数的指针，该函数采用 int 并返回一个 n 指针数组，该数组指向采用 char 并返回 void 的函数**。

高温高压

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2012-11-06T09:04:05.643

解析C 声明的基本规则是“从右向左阅读，离开一对括号时由内向外跳向右”，即从嵌套最深的一对括号开始，然后向右看。从技术上讲，您必须了解运算符关联性，但它在大多数情况下都足够好用。

现在让我们将此（简化）规则应用于您的问题：

* * *

> ```
> double (*b)[n];
>          ^ 
> ```

b 是一个

> ```
> double (*b)[n];
>         ^ 
> ```

指向的指针

> ```
> double (*b)[n];
>            ^^^ 
> ```

和数组

> ```
> double (*b)[n];
> ^^^^^^ 
> ```

双打。

* * *

> ```
> double (*c[n])();
>          ^^^^ 
> ```

c 是一个数组

> ```
> double (*c[n])();
>         ^ 
> ```

指向

> ```
> double (*c[n])();
>               ^^ 
> ```

职能

> ```
> double (*c[n])();
> ^^^^^^ 
> ```

返回双倍。

* * *

> ```
> double (*d())[n];
>          ^^^ 
> ```

d 是一个函数

> ```
> double (*d())[n];
>         ^ 
> ```

返回一个指向

> ```
> double (*d())[n];
>              ^^^ 
> ```

一个数组

> ```
> double (*d())[n];
> ^^^^^^ 
> ```

双打

* * *

在大多数 *nixes 上都有一个简洁的实用程序，称为*cdecl*，它采用 C 声明字符串并将其转换为自然语言句子。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-11-06T09:37:53.297

让我们试试这个方法。

首先，你应该熟悉这三个符号：

```
1\. * -- 一个指针。
2\. [] -- 一个数组。
3\. () -- 一个函数。（注意：不是括号）
```

我们以“double (*d())[n]”为例。

第一步是找出声明中的标识符，标识符是变量的名称，这里是“d”。

```
（一世）
——什么是“d”？
-------------------------------------------------- ----------------------
查看标识符的右侧，看看是否有 "[]" 或 "()" ：
...d[]...: d 是一个数组。
...d()...: d 是一个函数。

如果两者都没有，请查看左侧，看看是否有“*”：
...*d...: d 是一个指针。
-------------------------------------------------- ----------------------
```

现在我们发现 d 是一个函数。用 x 代替 d()，则声明变为“double (*x)[n]”

```
(二)
——什么是“x”？
-------------------------------------------------- ----------------------
重复(i)，我们发现x是一个指针。
这意味着， d 是一个返回指针的函数。
-------------------------------------------------- ----------------------
```

用y代替*x，则声明变为“double y[n]”

```
㈢
——什么是“y”？
-------------------------------------------------- ----------------------
重复(i)，我们发现y是n个元素的数组。
这意味着，d 是一个函数，它返回一个指向 n 个元素的数组的指针。
-------------------------------------------------- ----------------------
```

用z代替y[n]，则声明变为“双z”

```
(四)
——什么是“z”？
-------------------------------------------------- ----------------------
重复 (i)，我们发现 z 是一个双精度数。
这意味着， d 是一个函数，它返回一个指向 n 个双精度元素的数组的指针。
-------------------------------------------------- ----------------------
```

让我们看另一个表达式：

```
无效 (*(*f)(int)[n])(char)
```

```
1.
  我们找到 f。
2.
  f 是一个指针。*f -> 一个
  无效 (*a(int)[n])(char)
3.
  a 是一个函数。a() -> b
  无效 (*b[n])(char)
  --f 是指向函数的指针（带有 int 参数）--
4.
  b 是一个数组。b[] -> c
  无效 (*c)(char)
  --f 是一个指向函数的指针，该函数返回一个数组（包含 n 个元素）--
5.
  c 是一个指针。*c -> d
  无效d（字符）
  --f 是一个指向函数的指针，该函数返回一个包含 n 个指针的数组--
6.
  d 是一个返回 void 的函数。
  --f 是一个指向函数的指针，它返回一个包含 n 个指向函数（带有 char 参数）的指针的数组，返回 void--
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-11-06T09:09:17.957

有两个很好的资源可以理解“C 胡言乱语”：

*   [http://cdecl.org/](http://cdecl.org/) - 翻译“C 胡言乱语 ↔ 英语”的在线服务
*   [大卫安德森的“顺时针/螺旋规则”](http://c-faq.com/decl/spiral.anderson.html)，如果你想更好地了解正在发生的事情

cdecl.org 的输出：

*   `double (*c[n])()`: 语法错误（`n`此处无效）
*   `double (*c[])()`: 将 c 声明为指向返回 double 的函数的指针数组

# matlab - Matlab中的Convhull

> ID：13247475
> 
> 赞同：-1
> 
> 时间：2012-11-06T08:52:44.400
> 
> 标签：matlab, convex-hull

我有 3 个位置数据向量`x`：`y`和`z`

```
x = [0.1524 0.1219 0.0610 0.0914 0.0610 0.1219 0.0305 0.0914 0.2134 0.0610 0.1219
0.0305 0.0610 0.1219 0.0914 0.1524 0.0610 0.1524 0.0610 0.0610 0.0610 0.0610
0.1524 0.0914 0.0610 0.1524 0.0610 0.2134 0.0610 0.0914 0.1524];

y = [0.1219 0.1524 0.0305 0.1219 0.1524 0.1524 0.0610 0.1219 0.1219 0.1524 0.1524
0.0610 0.0914 0.1524 0.1829 0.1829 0.0914 0.1829 0.2134 0.0914 0.2134 0.0914
0.1829 0.0610 0.0914 0.1829 0.0914 0.1829 0.2134 0.1219 0.1829];

z = [0.0305 0.0305 0.0610 0.0610 0.0610 0.0610 0.0914 0.0914 0.0914 0.0914 0.0914
0.1219 0.1219 0.1219 0.1219 0.1219 0.1524 0.1524 0.1524 0.1829 0.1829 0.2134
0.2134 0.2438 0.2438 0.2438 0.2743 0.2743 0.2743 0.3048 0.3048]; 
```

我想知道如何在这个集合上应用凸包？Matlab 不接受这种格式，但有规则间隔的网格。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-06T09:02:17.243

您可以使用[`convhulln`](http://www.mathworks.com/help/matlab/ref/convhulln.html)计算大于 2 的维度的凸包。如果要绘制结果，请使用[`trisurf`](http://www.mathworks.com/help/matlab/ref/trisurf.html). 请参阅下面的输入示例代码：

```
X = [x;y;z]'; %# involves a 3D point on each row  
K = convhulln(X);
trisurf(K,X(:,1),X(:,2),X(:,3)) 
```

![在此处输入图像描述](../Images/a7c650d17f103cb2febd3fc316f89132.png)

# winapi - 使用 c++ 和浏览器帮助对象在浏览器中打开文件时确定文件的 MIME 类型

> ID：13247476
> 
> 赞同：0
> 
> 时间：2012-11-06T08:52:49.977
> 
> 标签：winapi, visual-c++, browser, mime-types, bho

当我单击浏览器上打开文件的链接（。PDF，.doc，....）时，如何找到使用浏览器帮助对象打开的该文件的 MIME 类型？我是新来的，请帮助我提前谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-06T19:30:24.803

您可以[安装 PassThru 应用程序并读取 HTTP 标头](http://www.codeproject.com/Articles/157329/Http-Monitor-for-Webbrowser-Control)。然后您可以解析标题文本以获取 MIME 类型，祝您[好运](https://stackoverflow.com/questions/4400678/http-header-should-use-what-character-encoding)。

# xsl-fo - 如何使文本从一个表格单元格流到下一个表格单元格

> ID：13247478
> 
> 赞同：2
> 
> 时间：2012-11-06T08:52:53.807
> 
> 标签：xsl-fo, apache-fop

在基于 Apache FOP 的报告解决方案中，我们想要一个布局，当第一个单元格变得太多时，文本（具体来说是一个表格）从一个单元格流到下一个单元格。是否可以在 xsl-fo 中定义跨表格单元格的文本流？有问题的三个单元格是定义页面布局的较大表格的一部分。

编辑（澄清问题）：

我们不只是想要一个更大的单元格来容纳所有文本，而是希望文本从一个单元格流到下一个单元格，就像多列页面上的文本一样，即文本应该从第一个单元格的顶部到底部流动并且如有必要，在行中下一个单元格的顶部继续。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-28T15:36:42.147

就在这里！它像 HTML 的 colspan 一样工作：http: [//www.w3.org/TR/xsl/#number-columns-spanned](http://www.w3.org/TR/xsl/#number-columns-spanned)

# python - 如何提取一些锚标签之间的文本？

> ID：13247479
> 
> 赞同：3
> 
> 时间：2012-11-06T08:52:55.757
> 
> 标签：python, anchor, beautifulsoup, scraper

我需要从 HTML 页面中提取艺术家的姓名。这是页面的一个片段：

```
 </td>
 <td class="playbuttonCell">
   <a class="playbutton preview-track" href="/music/example" data-analytics-redirect="false"  >
      <img class="transparent_png play_icon" width="13" height="13" alt="Play" src="http://cdn.last.fm/flatness/preview/play_indicator.png" style="" />
    </a>
  </td>
  <td class="subjectCell" title="example, played 3 times">
    <div>
      <a href="/music/example-artist"   >Example artist name</a> 
```

我已经尝试过了，但没有完成这项工作。

```
import urllib
from bs4 import BeautifulSoup

html = urllib.urlopen('http://www.last.fm/user/Jehl/charts?rangetype=overall&subtype=artists').read()
soup = BeautifulSoup(html)
print soup('a')

for link in soup('a'):
    print html 
```

我在哪里搞砸了？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-06T08:56:53.973

你可以试试这个：

```
In [1]: from bs4 import BeautifulSoup

In [2]: s = # Your string here...

In [3]: soup = BeautifulSoup(s)

In [4]: for anchor in soup.find_all('a'):
   ...:     print anchor.text
   ...:
   ...:

here lies the text i need 
```

在这里，该`find_all`方法返回一个包含所有匹配锚标记的列表，之后我们可以打印`text`属性以获取标记之间的值。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-06T09:50:36.443

```
for link in soup.select('td.subjectCell a'):
    print link.text 
```

它[选择（就像 CSS 一样）](http://www.crummy.com/software/BeautifulSoup/bs4/doc/#css-selectors)具有*subjectCell*类的`a`元素内的元素。`td`

 ** * *

## 回答 #3

> 赞同：1
> 
> 时间：2020-01-21T17:59:17.747

```
spans = soup.find_all("div", {"class": "overlay tran3s"})
    for span in spans:
        links = span.find_all('a')
        for link in links:
            print(link.text) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2020-01-21T18:36:27.247

`soup.findAll`并可`link.attrs`用于`href`轻松读取属性。

**工作代码：**

```
soup = BeautifulSoup(html)

for link in soup.findAll('a'):
    print (link.attrs['href']) 
```

**输出：**

```
/music/example
/music/example-artist 
```

* * *

## 回答 #5

> 赞同：-2
> 
> 时间：2012-11-06T09:18:14.713

正则表达式是你的朋友。作为 RocketDonkey 正确使用 BeautifulSoup 的答案的替代方案；您可以使用正则表达式解析 soup('a')

```
>([a-zA-Z]*|[0-9]|(\w\s*)*)</a> 
```

您可以利用[re.findall](http://docs.python.org/2/library/re.html#re.findall "重新查找")方法直接抓取锚标记之间的文本。*

# ios - 在具有多个图钉的地图中定位用户的位置

> ID：13247484
> 
> 赞同：1
> 
> 时间：2012-11-06T08:53:32.547
> 
> 标签：ios, mkmapview, mkannotation, user-location

我需要使用自定义注释查看用户位置，然后在用户附近添加更多各种类型的注释（例如纪念碑、餐馆电影院......）。如果我在这个方法中编写代码显示用户的位置。

```
- (void) locationManager:(CLLocationManager *) manager
 didUpdateToLocation:(CLLocation *) newLocation
        fromLocation:(CLLocation *) oldLocation {

    //......

   MyAnnotation *annotationUser = [[MyAnnotation alloc]initWithCoordinates:self.coordinate  title:@"YOU ARE HERE" subTitle:@"via Giorgio Giulini 2"];

   [self.mapView addAnnotation:self.annotationUser];

} 
```

如果我添加方法

```
 - (MKAnnotationView *)mapView:(MKMapView *)mapview viewForAnnotation:(id <MKAnnotation>)annotation
 {
      //.....
  } 
```

创建其他注释时，不再显示用户的位置。为什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-06T09:04:37.790

试试这个

```
 - (MKAnnotationView *)mapView:(MKMapView *)mapview viewForAnnotation:(id <MKAnnotation>)annotation
 {
    if ([annotation isKindOfClass:[MyAnnotation class]]) {

        return nil;

    } else {

        //.....

    }

  } 
```

# java - java sockets SocketException 套接字关闭

> ID：13247490
> 
> 赞同：0
> 
> 时间：2012-11-06T08:53:57.153
> 
> 标签：java, sockets

我扩展了 Socket 类并遇到了一些我不理解的错误，所以我寻求您的帮助。下面是一个简短的片段 - 没什么。如果我插入了错误的主机地址，它第一次给出的错误为`operation time out`. 但是，随后当我尝试使用有效地址时，错误显示`socket closed`。我没有明确关闭套接字并且 println 说`socket closed is false`。知道为什么套接字关闭了吗？

```
java.net.SocketException: Socket closed
    at java.net.PlainSocketImpl.socketConnect(Native Method)
    at java.net.PlainSocketImpl.doConnect(PlainSocketImpl.java:351)
    at java.net.PlainSocketImpl.connectToAddress(PlainSocketImpl.java:213)
    at java.net.PlainSocketImpl.connect(PlainSocketImpl.java:200)
    at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:432)
    at java.net.Socket.connect(Socket.java:529)
    at edu.astar.i2r.ppdf.exchange.p2p.PeerClient.connect(PeerClient.java:251)
    at edu.astar.i2r.ppdf.exchange.p2p.PeerClient.connectToServer(PeerClient.java:89)
    at edu.astar.i2r.ppdf.demo.ui.client.peertopeer.P2PParamsPage$1.actionPerformed(P2PParamsPage.java:87)
    at javax.swing.AbstractButton.fireActionPerformed(AbstractButton.java:2028)
    at javax.swing.AbstractButton$Handler.actionPerformed(AbstractButton.java:2351)
    at javax.swing.DefaultButtonModel.fireActionPerformed(DefaultButtonModel.java:387)
    at javax.swing.DefaultButtonModel.setPressed(DefaultButtonModel.java:242)
    at javax.swing.plaf.basic.BasicButtonListener.mouseReleased(BasicButtonListener.java:236)

@Override
    public void connect(SocketAddress endPoint) throws IOException{
        System.out.println("socket closed is " + this.isClosed());
        super.connect(endPoint);
        logger.info("Connected to server...");

        this.ostream = new ObjectOutputStream(this.getOutputStream());
        this.istream = new ObjectInputStream(this.getInputStream()); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-11-21T18:02:48.760

有可能在整个程序的某个地方，您调用了对套接字本身或 ObjectOutputStream 或 ObjectInputStream 或程序中使用的任何其他读取器/写入器的 close()。尝试注释掉整个程序中的所有 .close() 语句，然后再次运行程序。发现问题后不要忘记将它们取消注释。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-06T09:24:57.790

此异常意味着您的应用程序已经关闭了套接字，现在正试图继续使用它。

# jquery - jQuery mouseout 不将链接视为 DIV 的一部分？

> ID：13247491
> 
> 赞同：1
> 
> 时间：2012-11-06T08:53:57.797
> 
> 标签：jquery, html, hyperlink, mouseover, mouseout

很抱歉，如果这已被回答，但我找不到答案..

我所拥有的是一个带有一些链接的 DIV。我想要它做的是在鼠标在它上面时显示，但在鼠标离开它时淡出（DIV）。唯一的问题是，只要鼠标点击其中的链接，DIV 就会淡出。那么有没有办法让它意识到链接也是 DIV 的一部分，或者最好的解决方案是什么？

这是当前代码：

jQuery

```
$("#hoverbox").mouseover(function() {
    $("#hoverbox").fadeOut();
    $("#sub-menu").fadeIn("slow");
});

$('#sub-menu').mouseout(function() {
  $("#sub-menu").fadeOut();
  $("#hoverbox").fadeIn();
}); 
```

HTML

```
<div id="sub-menu">
<a href="test.html">test</a>
</div>
<div id="hoverbox"></div> 
```

我不能是唯一一个遇到这个问题的人，所以我很可能在这里错过了一些非常基本的东西。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-06T09:19:07.113

问题是您使用了错误的事件，您想使用[`mouseleave`](http://api.jquery.com/mouseleave/)而不是`mouseout`，请查看以下可以使用的事件列表：

```
mouseenter / mouseout
mouseover / mouseleave 
```

您已经了解了两对之间的区别（包括或不包括内部元素），并且您正在混合两组。

因此，您只需要更改以下行：

```
$('#sub-menu').mouseout(function() { 
```

对于这个：

```
$('#sub-menu').mouseleave(function() { 
```

请参阅工作[**演示**](https://tinker.io/9d202/2)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-06T09:25:34.930

这接近你想要的吗？

```
$("#hoverbox").mouseenter(function() {
    $("#hoverbox").hide("slow");
    $("#sub-menu").show("fast");
});

$('#sub-menu').mouseleave(function() {
   $("#sub-menu").hide();
   $("#hoverbox").show();
});​ 
```

演示在这里：http: [//jsfiddle.net/UTaFL/](http://jsfiddle.net/UTaFL/)

在这里使用 mouseenter 和 mouseleave 更好，因为它们忽略子元素并且只寻找鼠标进入/离开指定元素的边界。

我还更改了fadeIn 和fadeOut，因为它们可能会导致问题，因为它们能够在页面上实际可见之前调用mouseenter 和mouseleave（以及mouseover 和mouseout）事件。

# java - 同时访问数据库

> ID：13247492
> 
> 赞同：1
> 
> 时间：2012-11-06T08:54:00.437
> 
> 标签：java, database, google-app-engine, simultaneous

我正在使用 Java 中的 Google App Engine 和 JDO 为移动应用程序开发服务器端，但同时访问数据库时遇到了一些问题。

我正在做的应用程序是聊天，当两个人同时访问数据库时，其中一条消息丢失了。我认为这是因为这两种访问中的一种是在另一种之前完成的，即在它保存在数据库中之前，这就是其中一条消息丢失的原因。

你知道一些解决方案吗？诸如获取对数据库中相同注册表的访问权并将它们放入队列或堆栈中以供最近访问之类的东西。

提前致谢！

这是我的代码：

**对话.java：**

```
import java.util.LinkedList;
import javax.jdo.annotations.IdGeneratorStrategy;
import javax.jdo.annotations.IdentityType;
import javax.jdo.annotations.PersistenceCapable;
import javax.jdo.annotations.Persistent;
import javax.jdo.annotations.PrimaryKey;

@PersistenceCapable(identityType = IdentityType.APPLICATION)  
public class Conversation 
{
    @PrimaryKey  
    @Persistent(valueStrategy = IdGeneratorStrategy.IDENTITY)  
    private Long id;

    @Persistent
    private Long idUser;

    @Persistent(mappedBy = "conversation")
    private LinkedList<Message> messages;

    public Conversation(Long idUser) 
    {
        this.idUser = idUser;

        messages = new LinkedList<Message>();       
    }

    public Long getId() {
        return id;
    }

    public Long getIdUser() {
        return idUser;
    }

    public LinkedList<Message> getMessages() {
        return messages;
    }
} 
```

**消息.java：**

```
import javax.jdo.annotations.IdGeneratorStrategy;
import javax.jdo.annotations.IdentityType;
import javax.jdo.annotations.PersistenceCapable;
import javax.jdo.annotations.Persistent;
import javax.jdo.annotations.PrimaryKey;
import com.google.appengine.api.datastore.Key;

@PersistenceCapable(identityType = IdentityType.APPLICATION)  
public class Message 
{
    @PrimaryKey  
    @Persistent(valueStrategy = IdGeneratorStrategy.IDENTITY)  
    private Key id;

    @Persistent
    private Conversation conversation;

    @Persistent
    private String text;

    @Persistent
    private String hour;

    public Message(String text, String hour)
    {
        this.text = text;
        this.hour = hour;
    }

    public String getText() 
    {
        return text;
    }

    public String getHour() 
    {
        return hour;
    }

    public Key getId() 
    {
        return id;
    }

    public Conversation getConversation() {
        return conversation;
    }
} 
```

**保存消息：**

```
final PersistenceManager persistenceManager = PMF.get().getPersistenceManager();      

String strQuery = "select from " + Conversation.class.getName() + " where id == " + id;
persistenceManager.getFetchPlan().setGroup(FetchGroup.ALL);
final Query query = persistenceManager.newQuery(strQuery);

try 
{
    List<Conversation> conversations = (List<Conversation>) query.execute;

    Conversation detached = null;
    detached = persistenceManager.detachCopy(conversations.get(0));

    detached.getMessages().add(message);
    persistenceManager.makePersistent(detached);
} finally {
    persistenceManager.close();
} 
```

# c - 试图理解 GCC 和 Windows 的主要功能

> ID：13247493
> 
> 赞同：0
> 
> 时间：2012-11-06T08:54:03.723
> 
> 标签：c, windows, gcc, export, main

他们说*main()*是一个与任何其他函数一样的函数，但“标记”为二进制文件中的入口点，操作系统可能会找到（**不知道如何**）并从那里启动程序的入口点。因此，我正在尝试了解有关此功能的更多信息。我做了什么？我创建了一个简单的 .C 文件，其中包含以下代码：

```
int main(int argc, char **argv) {
     return (0);
} 
```

我保存了文件，安装了 GCC 编译器（在 Windows，MingW 环境中）并创建了一个批处理文件，如下所示：

```
gcc -c test.c -nostartfiles -nodefaultlibs -nostdlib -nostdinc -o test.o
gcc -o test.exe -nostartfiles -nodefaultlibs -nostdlib -nostdinc -s -O2 test.o
@%comspec% 
```

我这样做是为了获得一个非常简单的编译器和链接器，没有库，没有头文件，只有编译器。因此，编译顺利，但链接停止并出现此错误：

```
test.c:(.text+0xa): undefined reference to '___main'
collect2.exe: error: Id returned 1 exit status 
```

我认为主要功能是由链接器导出的，但我相信您不需要任何包含有关它的附加信息的库。但它看起来确实如此。就我而言，我认为它必须是标准的 GCC 库，所以我下载了它的源代码并打开了这个文件：*libgcc2.c* 现在，我不知道这是否是构建 main 函数的文件由 GCC 链接。其实我不明白 GCC 是怎么使用 main 函数的。为什么链接器需要 gcc 标准库？**想知道主线呢？**我希望这使我的问题非常具体和明确。谢谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-06T09:02:04.293

当 gcc 将所有对象文件 (test.o) 和库放在一起形成二进制文件时，它还会预先添加一个小对象（通常是 crt0.o 或 crt1.o），它负责调用您的`main()`. `-v`当您在命令行中添加时，您可以看到 gcc 在做什么：

> $ gcc -v -o test.exe test.o

crt0/crt1 进行一些设置，然后调用 main。但是链接器最终负责根据操作系统构建可执行文件。`-v`您还可以看到目标系统的一个选项。就我而言，它适用于 Linux 64 位：`-m elf_x86_64`. 对于您的系统，这将类似于`-m windows`or `-m mingw`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-06T09:00:35.503

发生错误是因为您使用了以下两个选项：`-nodefaultlibs -nostdlib`

这些告诉 GCC 它不应该将您的代码链接到`libc.a`/`c.lib`包含真正调用的代码`main()`。简而言之，每个操作系统都略有不同，其中大多数都不关心 C 和`main()`. 每个都有自己特殊的方式来启动一个进程，并且大多数都与 C API 不兼容。

因此 C 开发人员的解决方案是将“胶水代码”放入`libc.a`包含操作系统期望接口的 C 标准库中，创建标准 C 环境（设置内存分配结构，以便`malloc()`映射操作系统的内存管理功能，设置up stdio 等）并最终调用`main()`

对于 C 开发人员来说，这意味着他们可以获得`libc.a`适用于他们的操作系统（以及编译器二进制文件）的版本，并且他们不需要关心设置的工作方式。

另一个混淆来源是参考的名称。在大多数系统上，`main()`is的符号名称`_main`（即一个下划线），`__main`而是由设置代码调用的内部函数的名称，最终调用真正的`main()`

# javascript - 没有jquery的简单动画改变高度

> ID：13247494
> 
> 赞同：1
> 
> 时间：2012-11-06T08:54:04.493
> 
> 标签：javascript, animation

我需要简单 js 上的简单动画。我认为 jquery 太多了。我需要通过按下按钮来增加或减少块的高度，但这仅适用于 Opera (.

[例子](http://jsfiddle.net/9DCA5/)

```
function global_animate(element, property_to_map, duration, callback) {
   duration = duration || 1000;
   var delta = function (a) { return a; };
   var start = new Date().getTime();
   var property_from_map = {};
    var property_units_map = {};

    for (var property in property_to_map) {
        property_from_map[property] = window.getComputedStyle(element, null)[property] || element.currentStyle[property];
        property_units_map[property] = parseUnits(property_from_map[property]);
        property_from_map[property] = parseInt(property_from_map[property]);
        property_to_map[property] = parseInt(property_to_map[property]);
    }

    function parseUnits(a) {
        try {
        return a.match(/^\d+(\w{2}|%);?$/i)[1];
        } catch (e) {
        return "";
        }                   
    }

    setTimeout(function() {
    var now = (new Date().getTime()) - start;
    var progress = now / duration; 

    for (var property in property_to_map) {
        var result = (property_to_map[property] - property_from_map[property]) * delta(progress) + property_from_map[property];
        element.style[property] = result.toFixed(2) + property_units_map[property];
    }

    if (progress < 1)
        setTimeout(arguments.callee, 10);
    else
        if (typeof callback == 'function')
        callback();
    }, 10);
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-06T09:09:38.833

我认为问题在于您的正则表达式：`a.match(/^\d+(\w{2}|%);?$/i)[1];`. 第二次运行时，它没有正确捕获单元。

如果我将单位硬编码为“px”，它对我有用（在 chrome 中）：http: [//jsfiddle.net/9DCA5/5/](http://jsfiddle.net/9DCA5/5/)

也许你可以从那里调试？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-06T09:19:50.107

你需要改变正则表达式

```
alert("23.2px".match(/^\d+(\w{2}|%);?$/i));​ // alert null 
```

像这样

```
alert("23.2px".match(/^\d+\.*\d*(\w{2}|%);?$/i));​ // alert ["23.2px", "px"] 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-06T09:22:11.620

IE 不支持方法 getComputedStyle()，它使用“currentStyle”属性代替。

# c# - c#编码中的一个奇怪的事情

> ID：13247497
> 
> 赞同：4
> 
> 时间：2012-11-06T08:54:09.890
> 
> 标签：c#, encoding

我将 a 转换`byte array`为 a `string`，然后将其转换`string`为`byte array`. 这两个字节数组是不同的。

如下：

```
byte[] tmp = Encoding.ASCII.GetBytes(Encoding.ASCII.GetString(b)); 
```

假设 b 是一个字节数组。

> b[0]=3, b[1]=188, b[2]=2 //十进制

结果：

> tmp[0]=3, tmp[1]=63, tmp[2]=2

所以这是我的问题，有什么问题吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-06T08:59:29.040

188 超出了 ASCII 的范围。不在对应字符集中的字符被转置为'?' 设计使然（您更喜欢转换为“1/4”吗？）

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-11-06T09:08:48.317

ASCII 只有 7 位，所以其他无效。[默认情况下，它用于`?`替换任何无效字节，这就是您获得`?`.](http://msdn.microsoft.com/en-us/library/ms404377%28v=vs.100%29.aspx#FallbackStrategy)

对于 8 位字符集，您应该查找**[扩展 ASCII](http://en.wikipedia.org/wiki/Extended_ASCII)**（后来定义为“ISO 8859-1”）或**[代码页 437](http://en.wikipedia.org/wiki/Code_page_437)**（经常与扩展 ASCII*混淆*，但实际上不是）。

您可以使用以下代码：

```
Encoding enc = Encoding.GetEncoding("iso-8859-1");
// For CP437, use Encoding.GetEncoding(437)
byte[] tmp = enc.GetBytes(enc.GetString(b)); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-06T08:59:34.350

该字符`188`没有为 ASCII 定义。相反，你得到`63`的是一个问号。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-11-06T09:00:35.817

[ASCII](http://en.wikipedia.org/wiki/ASCII)字符集的范围是 1 到 127。可以看到 188 不在此范围内，而是转换为 ? （= ASC 63）。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-11-06T09:01:17.703

并非每个字节序列都必须是特定编码的有效编码值序列。

因此，任意字节数组 的结果`Encoding.ASCII.GetString(b)`定义*不*明确`b`。（并且对于任何其他编码也可能是）。

如果您需要获取*任意*字节数组并获取字符序列，您可能需要查看`Convert`类[`ToBase64String`](http://msdn.microsoft.com/en-us/library/system.convert.tobase64string.aspx)和[`FromBase64String`](http://msdn.microsoft.com/en-us/library/system.convert.frombase64string.aspx). 如果这不是您想要做的，也许可以向我们解释最初的*问题*。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-11-06T09:10:13.107

`188`不在 ASCII（7 位）范围内，您应该使用[`Encoding.Default`](http://msdn.microsoft.com/en-gb/library/system.text.encoding.default.aspx)来获取 ANSI 编码：

```
byte[] b = new byte[3]{ 3, 188, 2 };
byte[] tmp = Encoding.Default.GetBytes(Encoding.Default.GetString(b)); 
```

# php - PHP包含路径顺序和状态缓存

> ID：13247498
> 
> 赞同：6
> 
> 时间：2012-11-06T08:54:09.813
> 
> 标签：php, caching, zend-server-ce

我正在构建一个框架，其中产品实例使用主框架文件，直到有它自己的该文件版本的副本。为了实现这一点，我做了以下事情：

```
set_include_path(MY_PRODUCT_ROOT.'/' . PATH_SEPARATOR . MY_FRAMEWORK_ROOT.'/'); 
```

因此，如果我调用`include('view-users.php');`它，它将首先在 MY_PRODUCT_ROOT 中查找 /view-users.php，如果未找到，它将查找 MY_FRAMEWORK_ROOT/view-users.php。

在我将文件添加到产品根目录之前，此过程运行良好。我知道 PHP/Apache 正在缓存包含，并且会考虑运行`clearstatcache(true);`以清除任何状态缓存。PHP 可能在它的 include() 中使用 file_exists；并认为新文件仍然不存在。我尝试重新启动 Apache，但没有任何效果。

不幸的是，跑步`clearstatcache(true);`也无济于事。只有在我删除了 MY_FRAMEWORK_ROOT/file 后，它才会考虑清除缓存并重试，从而找到 MY_PRODUCT_ROOT/file。

我有点难过，我知道我们需要刷新 PHP/Apache 对文件是否存在的理解，但`clearstatcache(true);`没有帮助......

有任何想法吗？

**更新**：更正，重新启动 Apache 现在似乎有帮助。我重申，这仅在​​尝试将文件添加到 MY_PRODUCT_ROOT 以与现有的 MY_FRAMEWORK_ROOT 文件重叠以进行自定义时发生

**更新**：开发环境是 Windows 上的 Zend Server CE PHP 5.3.14，生产环境 Centos linux httpd，PHP 5.3+。在我的开发环境中启用 Zend 优化器这一事实可能会产生影响，也不使用 APC 或任何其他缓存脚本

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-06T11:11:05.400

[Zend Optimizer+](http://en.wikipedia.org/wiki/List_of_PHP_accelerators#Zend_Optimizer.2B)通过操作码缓存和优化来加速 PHP 的执行。它将预编译的脚本字节码存储在共享内存中。这消除了从磁盘读取代码并在将来访问时对其进行编译的阶段。为了进一步提高性能，对存储的字节码进行了优化以加快执行速度。

这是缓存包含中找到的文件内容，因此 clearstatcache 不起作用。我禁用了我的 Zend Optimizer，它现在可以工作了。

# c# - 将 SQL 存储过程和参数存储在数据库表中是不好的做法吗

> ID：13247500
> 
> 赞同：2
> 
> 时间：2012-11-06T08:54:24.180
> 
> 标签：c#, sql

我们有一个用例，其中发送电子邮件的应用程序在电子邮件中找到特定字符串（“智能标签”）并将其替换为存储过程的结果。

因此，例如电子邮件可能`Dear <ST:Name>`在正文中，然后代码将识别此字符串，运行存储过程以查找作为参数传入客户端 ID 的客户端名称。

这些标签列表和需要运行的存储过程目前是硬编码的，因此每次需要添加新的“智能标签”时，都需要更改代码和部署。

我们的 BA 精通 SQL，希望能够手动添加新标签。

将过程和参数存储在数据库表中是不好的做法吗？这对这样的桌子来说是一个合适的设计吗？是否有必要存储参数类型？

**智能标签**

```
SmartTagId   SmartTag   StoredProcedure 
```

**智能标签参数**

```
SmartTagParameterId   SmartTagId   ParameterName 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-06T09:02:24.353

表驱动配置，数据驱动编程，都不错。

需要注意的主要事情是 SQL 注入风险（或者在您的情况下，它被称为“标签注入”......）：人们可以使用电子邮件作为攻击媒介，通过插入一个精心设计的过程来获得提升的权限，该过程将是在更高的权限下运行。请注意，这不仅仅是关于 SQL 注入的通常注意事项，因为您已经接受了要执行的*任意代码。*这更像是一个[沙盒](http://en.wikipedia.org/wiki/Sandbox_%28computer_security%29)问题。

典型的问题来自类型系统：参数有多种类型，但声明表有一个字符串类型。[`SQL_VARIANT`](http://msdn.microsoft.com/en-us/library/ms173829.aspx)可以帮忙。

另一个潜在的问题是声明和发现标签的语言。很快你会被要求识别`<tag:foo>`，但只是在之前`<tag:bar>`。一个完全成熟的上下文敏感解析器通常在第一次迭代后不久出现......如果您可以通过利用已经熟悉的东西来提供帮助（例如，想想 JQuery 如何使用 CSS 选择器语法），那将会很有帮助。[HTMLAgilityPack](http://htmlagilitypack.codeplex.com/)或许可以帮助您（顺便说一句，这是一项非常适合 SQLCLR 的任务，不要尝试在 T-SQL 中构建精细的全状态解析器......）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-06T09:05:06.887

这不是坏习惯，你所做的一切都很好。只要只有您的管理员/BA 可以添加和更改参数以及更改配置，您就不必担心注入。如果用户可以添加和更改参数，您确实需要检查输入并将某些字符列入白名单。

您不仅要检查 sql 注入，还需要检查跨站点脚本和 dom 注入以及跨站点请求伪造。合并后的文本显示在用户计算机上，因此您在查看合并结果时必须保护他。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-06T09:07:36.523

有趣的问题，将跟进，因为它[与我的有关](https://stackoverflow.com/q/9946983/1297603)。一点也不坏。事实上，我们正在使用相同的方法。我正在尝试在我的 XSL 编辑器上实现类似的目标。我正在使用 XML 标记、存储过程和 VB.Net 逻辑的组合来进行替换。

我正在使用一个表与所有使用的 XML 标记（它们在应用程序的其他地方使用）和完成所有脏工作的存储过程的组合。一组 sp 从带有标签的文本转换为*用户可读*的文本。其他程序集从 XML 标记表创建 XML 树，以便用户可以从中选择来编辑他们的文本。

SQL 注入对我们来说不是问题，因为我们使用这些程序来创建电子邮件，而不是从外部来源解析它们。

关于对其中一个问题的评论，我们也直接从 SSMS 管理标签，没有管理窗口来管理它们，至少目前是这样。但是我们计划添加一个简单的管理窗口来管理标签，以便在部署应用程序后更容易添加/删除/修改它们。

# spring - 春天框架。访问 SOAP Web 服务的问题

> ID：13247501
> 
> 赞同：2
> 
> 时间：2012-11-06T08:54:34.837
> 
> 标签：spring, soap-client

我试图访问 SOAP 网络服务。从客户端 UI。我在访问网络服务时收到以下错误消息。我不确定需要做什么来解决这个问题。当我将调试点放入客户端代码并运行时，相同的代码可以正常工作，并且我能够在调试模式下正常访问 web 服务。请协助。

```
DEBUG http-8080-3 org.springframework.ws.soap.server.SoapMessageDispatcher - Endpoint invocation resulted in exception - responding with Fault
org.springframework.ws.soap.saaj.SaajSoapEnvelopeException: Could not access envelope: Unable to create envelope from given source: ; nested exception is com.sun.xml.internal.messaging.saaj.SOAPExceptionImpl: Unable to create envelope from given source: 
at org.springframework.ws.soap.saaj.SaajSoapMessage.getEnvelope(SaajSoapMessage.java:90)
at org.springframework.ws.soap.AbstractSoapMessage.getSoapHeader(AbstractSoapMessage.java:41)
at org.springframework.ws.soap.server.SoapMessageDispatcher.handleHeaders(SoapMessageDispatcher.java:102)
at org.springframework.ws.soap.server.SoapMessageDispatcher.handleRequest(SoapMessageDispatcher.java:92)
at org.springframework.ws.server.MessageDispatcher.dispatch(MessageDispatcher.java:205)
at org.springframework.ws.server.MessageDispatcher.receive(MessageDispatcher.java:168)
at org.springframework.ws.transport.support.WebServiceMessageReceiverObjectSupport.handleConnection(WebServiceMessageReceiverObjectSupport.java:88)
at org.springframework.ws.transport.http.WebServiceMessageReceiverHandlerAdapter.handle(WebServiceMessageReceiverHandlerAdapter.java:57)
at org.springframework.ws.transport.http.MessageDispatcherServlet.doService(MessageDispatcherServlet.java:197)
at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:647)
at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:563)
at javax.servlet.http.HttpServlet.service(HttpServlet.java:637)
at javax.servlet.http.HttpServlet.service(HttpServlet.java:717)
at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:290)
at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)
at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:233)
at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:191)
at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:128)
at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:102)
at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:109)
at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:286)
at org.apache.coyote.http11.Http11Processor.process(Http11Processor.java:845)
at org.apache.coyote.http11.Http11Protocol$Http11ConnectionHandler.process(Http11Protocol.java:583)
at org.apache.tomcat.util.net.JIoEndpoint$Worker.run(JIoEndpoint.java:447)
at java.lang.Thread.run(Unknown Source)
Caused by: com.sun.xml.internal.messaging.saaj.SOAPExceptionImpl: Unable to create envelope from given source: 
at com.sun.xml.internal.messaging.saaj.soap.EnvelopeFactory.createEnvelope(Unknown Source)
at com.sun.xml.internal.messaging.saaj.soap.ver1_1.SOAPPart1_1Impl.createEnvelopeFromSource(Unknown Source)
at com.sun.xml.internal.messaging.saaj.soap.SOAPPartImpl.getEnvelope(Unknown Source)
at org.springframework.ws.soap.saaj.Saaj13Implementation.getEnvelope(Saaj13Implementation.java:169)
at org.springframework.ws.soap.saaj.SaajSoapMessage.getEnvelope(SaajSoapMessage.java:86)
... 24 more
Caused by: javax.xml.transform.TransformerException: javax.xml.transform.TransformerException: org.w3c.dom.DOMException: NAMESPACE_ERR: An attempt is made to create or change an object in a way which is incorrect with regard to namespaces.
at com.icl.saxon.IdentityTransformer.transform(IdentityTransformer.java:92)
at com.sun.xml.internal.messaging.saaj.util.transform.EfficientStreamingTransformer.transform(Unknown Source)
... 29 more
Caused by: javax.xml.transform.TransformerException: org.w3c.dom.DOMException: NAMESPACE_ERR: An attempt is made to create or change an object in a way which is incorrect with regard to namespaces.
at com.icl.saxon.ContentEmitter.startElement(ContentEmitter.java:124)
at org.xml.sax.helpers.XMLFilterImpl.startElement(Unknown Source)
at com.sun.xml.internal.messaging.saaj.util.RejectDoctypeSaxFilter.startElement(Unknown Source)
at com.sun.org.apache.xerces.internal.parsers.AbstractSAXParser.startElement(Unknown Source)
at com.sun.org.apache.xerces.internal.impl.XMLNSDocumentScannerImpl.scanStartElement(Unknown Source)
at com.sun.org.apache.xerces.internal.impl.XMLNSDocumentScannerImpl$NSContentDriver.scanRootElementHook(Unknown Source)
at com.sun.org.apache.xerces.internal.impl.XMLDocumentFragmentScannerImpl$FragmentContentDriver.next(Unknown Source)
at com.sun.org.apache.xerces.internal.impl.XMLDocumentScannerImpl$PrologDriver.next(Unknown Source)
at com.sun.org.apache.xerces.internal.impl.XMLDocumentScannerImpl.next(Unknown Source)
at com.sun.org.apache.xerces.internal.impl.XMLNSDocumentScannerImpl.next(Unknown Source)
at com.sun.org.apache.xerces.internal.impl.XMLDocumentFragmentScannerImpl.scanDocument(Unknown Source)
at com.sun.org.apache.xerces.internal.parsers.XML11Configuration.parse(Unknown Source)
at com.sun.org.apache.xerces.internal.parsers.XML11Configuration.parse(Unknown Source)
at com.sun.org.apache.xerces.internal.parsers.XMLParser.parse(Unknown Source)
at com.sun.org.apache.xerces.internal.parsers.AbstractSAXParser.parse(Unknown Source)
at com.sun.org.apache.xerces.internal.jaxp.SAXParserImpl$JAXPSAXParser.parse(Unknown Source)
at org.xml.sax.helpers.XMLFilterImpl.parse(Unknown Source)
at com.icl.saxon.IdentityTransformer.transform(IdentityTransformer.java:90)
... 30 more 
```

# ruby-on-rails - 将rails从ubuntu迁移到osx时未初始化的常量

> ID：13247502
> 
> 赞同：0
> 
> 时间：2012-11-06T08:54:36.423
> 
> 标签：ruby-on-rails, macos, devise

我正在尝试将我的 Rails 应用程序从 ubuntu 移动到 osx。运行 rspec 时，出现以下模糊错误：

```
/Users/josh/dev/myproject/spec/support/devise.rb:3:in `block in <top (required)>': uninitialized constant RequestHelpers (NameError)
    from /Users/josh/.rvm/gems/ruby-1.9.3-p286@myproject/gems/rspec-core-2.11.1/lib/rspec/core.rb:92:in `configure'
    from /Users/josh/dev/myproject/spec/support/devise.rb:1:in `<top (required)>'
    from /Users/josh/dev/myproject/spec/spec_helper.rb:21:in `block (2 levels) in <top (required)>'
    from /Users/josh/dev/myproject/spec/spec_helper.rb:21:in `each'
    from /Users/josh/dev/myproject/spec/spec_helper.rb:21:in `block in <top (required)>'
    from /Users/josh/.rvm/gems/ruby-1.9.3-p286@myproject/gems/spork-0.9.2/lib/spork.rb:24:in `prefork'
    from /Users/josh/dev/myproject/spec/spec_helper.rb:4:in `<top (required)>'
    from /Users/josh/dev/myproject/spec/controllers/comments_controller_spec.rb:1:in `require'
    from /Users/josh/dev/myproject/spec/controllers/comments_controller_spec.rb:1:in `<top (required)>'
    from /Users/josh/.rvm/gems/ruby-1.9.3-p286@myproject/gems/rspec-core-2.11.1/lib/rspec/core/configuration.rb:780:in `load'
    from /Users/josh/.rvm/gems/ruby-1.9.3-p286@myproject/gems/rspec-core-2.11.1/lib/rspec/core/configuration.rb:780:in `block in load_spec_files'
    from /Users/josh/.rvm/gems/ruby-1.9.3-p286@myproject/gems/rspec-core-2.11.1/lib/rspec/core/configuration.rb:780:in `map'
    from /Users/josh/.rvm/gems/ruby-1.9.3-p286@myproject/gems/rspec-core-2.11.1/lib/rspec/core/configuration.rb:780:in `load_spec_files'
    from /Users/josh/.rvm/gems/ruby-1.9.3-p286@myproject/gems/rspec-core-2.11.1/lib/rspec/core/command_line.rb:22:in `run'
    from /Users/josh/.rvm/gems/ruby-1.9.3-p286@myproject/gems/rspec-core-2.11.1/lib/rspec/core/runner.rb:66:in `rescue in run'
    from /Users/josh/.rvm/gems/ruby-1.9.3-p286@myproject/gems/rspec-core-2.11.1/lib/rspec/core/runner.rb:62:in `run'
    from /Users/josh/.rvm/gems/ruby-1.9.3-p286@myproject/gems/rspec-core-2.11.1/lib/rspec/core/runner.rb:8:in `block in autorun' 
```

一切都在 Ubuntu 中运行良好，所以我想它一定是环境的。任何想法从哪里开始挖掘？

谢谢 - 乔什

编辑：不知道为什么，但是 rake 找不到文件 request_helpers.rb。把它移到别处解决了这个问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-06T10:53:52.273

这似乎不是操作系统问题，而是配置问题。确保您的环境在以下方面是相同的：

*   使用 rvm 安装方式相同
*   在 Gemfile 中拥有所有需要的宝石
*   使用 bundle 执行 rspec
*   使用相同版本的所有内容。

顺便说一句，这不是一条晦涩难懂的信息，实际上很清楚：

> `uninitialized constant RequestHelpers (NameError)`

所以`spec/support/devise.rb`文件找不到所需的类。

你写过那个文件吗？如果没有，您是如何生成的？重复该过程以生成它（可能是`rake something`或`rails generate something`），它就可以了。

# c - 变量的范围。内部工作基础

> ID：13247504
> 
> 赞同：3
> 
> 时间：2012-11-06T08:54:47.127
> 
> 标签：c, memory-management

这是关于假设变量范围的一个非常基本的问题。我有以下代码：

```
int main()
{
    int *p;
    p=func();
    printf("%d",*p);
    return 0;
}

int *func()
{
   int i;
   i=5;
   return &i;
} 
```

我的问题

*   i 的范围已完成，`func()`但是，由于我要返回的地址，`i`我可以访问`print`5 in`main()`吗？
*   如果不是，为什么？编译器是否在该地址空间中放置了一个垃圾值（我认为这还没有完成）。
*   它实际上是什么意思**`the scope of a variable is ended`**？分配给的内存`i`是否在其范围结束时被释放？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-06T08:57:39.567

**变量的范围**是可以访问它的区域。
**变量的生命周期**是保证变量存在的时间。

在您的情况下，**生命周期**在`i`功能范围内而不是超出功能范围内。这意味着`i`不保证在功能之外存在。访问函数之外的局部变量不是必需的，而且是**未定义的行为。**

> **的范围`i`已完成，`func()`但是，由于我要返回的地址，我`i`可以访问和打印吗？`5``main()`**

你可能会，但它是未定义的行为。所以不要这样做。

> **如果不是，为什么？编译器是否在该地址空间中放置了一个垃圾值（我认为这还没有完成）**

编译器可以将它选择的任何内容放在该位置，一旦函数返回地址位置保存一个**Indeterminate**值。

> **变量的范围结束实际上意味着什么？分配给的内存`i`是否在其范围结束时被释放？**

`i`是一个自动/局部变量，一旦声明它们的范围结束`{`，所有自动变量都会被释放。`}`因此名称自动。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-06T08:57:51.690

超出范围后访问变量是*未定义的行为。*这意味着不可能说肯定会发生什么。在发布的代码中，`5`可能会打印一些其他值，或者可能会发生一些其他行为（例如访问冲突）。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-11-06T08:58:01.987

您示例中的行为未定义。您`printf`可能会输出 5 但这取决于运气而不是良好的设计。

在这种情况下，当变量的作用域结束时，进一步的函数调用可能会重用堆栈地址`&i`来更改`p`变量指向的值。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-11-06T08:58:22.420

不，访问超出范围的变量会导致未定义的行为。v 变量曾经所在的存储空间已被回收，因此您可能会覆盖其他可能导致崩溃或无法预测的行为的内容。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2012-11-06T08:58:32.337

您的函数可能会打印 5，但您永远不应该这样做。这是未定义的行为，因为您的程序不再拥有返回的指针所指向的位置（换句话说，您的程序不再拥有`i`）。

基本上每次调用函数时，堆栈指针都会被下推以容纳新的堆栈帧。当函数调用结束时，堆栈指针会重新升起。这意味着如果要调用不同的函数，它将与前一个函数调用重叠相同的堆栈空间。

为了更好地说明这一点，请考虑以下内容：

```
int main()
{
    int *p;
    p=func();
    printf("%d\n",*p);
    func2();
    printf("%d\n",*p);
    return 0;
}

int *func()
{
   int i;
   i=5;
   return &i;
}

void func2()
{
    int i = 1;
} 
```

输出很可能是 5 1。这是因为第二次调用将重用相同的堆栈空间。

（请注意，上面的代码片段很*糟糕*——你永远不应该做这样的事情——它是未定义的行为并且高度依赖于实现。）

* * *

直接回答您的问题：

> i 的范围在 func() 中完成，但是，由于我返回 i 的地址，我是否能够在 main() 中访问和 print5？

不，你*可以*，但你不应该。这就是 C 的美妙之处。根据编译器/操作系统/等，它可能输出 5，或者它可能输出随机车库。

> 如果不是，为什么？编译器是否在该地址空间中放置了一个垃圾值（我认为这还没有完成）。

用于局部变量的空间被重用。希望答案的前半部分说明了这是如何工作的。（嗯，它*通常是*如何工作的。）

> 变量的范围结束实际上意味着什么？分配给 i 的内存是否在其范围结束时被释放？

[基于堆栈的内存分配](http://en.wikipedia.org/wiki/Stack-based_memory_allocation)是幕后发生的事情。

# c# - 水晶报表登录失败

> ID：13247505
> 
> 赞同：1
> 
> 时间：2012-11-06T08:54:47.653
> 
> 标签：c#, crystal-reports

我想打印我的报告，但是当我设置 server = (IP)\SQLEXPRESS 总是无法登录时，在管理工作室工作正常。如果我设置 server = .\SQLEXPRESS 它正在工作。为什么我不能使用 ip 将报表连接到数据库？

```
public class PrintService : IPrintService
{
    readonly ReportDocument _reportDocument = new ReportDocument();

    private readonly string _reportPath = ConfigurationManager.AppSettings["ReportPath"];
    private readonly string _reportUser = ConfigurationManager.AppSettings["ReportUser"];
    private readonly string _reportPassword = ConfigurationManager.AppSettings["ReportPassword"];
    private readonly string _reportServer = ConfigurationManager.AppSettings["ReportServer"];
    private readonly string _reportDatabase = ConfigurationManager.AppSettings["ReportDatabase"];
    private readonly string _spbuNumber = ConfigurationManager.AppSettings["SPBUNumber"];
    private readonly string _spbuAddress = ConfigurationManager.AppSettings["SPBUAddress"];
    private readonly string _spbuPhone = ConfigurationManager.AppSettings["SPBUPhone"];

    public void Print(string number, string reportName)
    {
        var path = _reportPath + reportName;
        _reportDocument.Load(path);
        _reportDocument.SetDatabaseLogon(_reportUser, _reportPassword, _reportServer, _reportDatabase);
        _reportDocument.SetParameterValue("@Number", number);
        _reportDocument.SetParameterValue("@Location", _spbuNumber );
        _reportDocument.SetParameterValue("@Address", _spbuAddress);
        _reportDocument.SetParameterValue("@Phone", _spbuPhone);
        var print = new PrintDocument();
        _reportDocument.PrintOptions.PrinterName = print.PrinterSettings.PrinterName;
        _reportDocument.PrintOptions.PaperSize = (PaperSize) print.PrinterSettings.DefaultPageSettings.PaperSize.RawKind;
        _reportDocument.PrintToPrinter(1, false, 1, 1);
    }
} 
```

谢谢 ：）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-07-19T11:12:56.430

要在运行时加载报告，在客户端 PC 上，我需要找出连接字符串以找到客户端的本地服务器名称。我尝试了不同的方法来更改水晶报表表单登录连接，但只有这对我有用。这是最新的 13.0.9.1312.Cortez_CR4VS 版本，WPF 中包含 Windows 表单版本。在此代码中，prepap 是完整的 Crystal 报表名称，包括路径和 dbName，只是附加的 SQL 数据库的名称。csName 来自 app.config：添加名称的字符串。新连接保存在报告中。

```
ReportDocument doc = new ReportDocument();
String CS = (String)ConfigurationManager.ConnectionStrings[csName].ConnectionString;
doc.Load(prerap);
String DS = CS.Substring(12 + CS.IndexOf("data source"), CS.IndexOf("SQLEXPRESS") - CS.IndexOf("data source") - 2);
            if (doc.DataSourceConnections[0].ServerName != DS)
            {
                for(int i=0;i<doc.DataSourceConnections.Count;i++) 
                {
                    doc.DataSourceConnections[i].SetConnection(DS, dbName, true);               
                }

                doc.SaveAs(prerap);

            } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-06T09:30:57.487

IS (IP) 是服务器名称或 ip 地址，id Ip 是服务器名称，然后删除括号。或者使用该服务器的直接 IP 地址。

# iphone - JSON为不同的值解析相同的键

> ID：13247506
> 
> 赞同：-1
> 
> 时间：2012-11-06T08:54:50.467
> 
> 标签：iphone, objective-c, xcode, json

我正在做一个 Json 解析，因为我需要解析“TStatus”键来显示表格。

**在该 TStatus 键中，值为 3 种类型。它们是 100001、100002、100003。**

我只想要 100001 个值...如何获取这些值并将其存储在数组中。

```
NSMutableArray *array = [arrayOfoccupiedTables valueForKey:@"TStatus"]; 
```

回应是

```
 {
        Msg = "";
        TStatus = 100003;
        "Table_Id" = 446;
    },
        {
        Msg = "";
        TStatus = 100001;
        "Table_Id" = 447;
    },
        {
        Msg = "";
        TStatus = 100001;
        "Table_Id" = 448;
    },
        {
        Msg = "";
        TStatus = 100001;
        "Table_Id" = 449;
    },
        {
        Msg = "";
        TStatus = 100001;
        "Table_Id" = 450;
    },
        {
        Msg = "";
        TStatus = 100001;
        "Table_Id" = 451;
    },
        {
        Msg = "";
        TStatus = 100001;
        "Table_Id" = 452;
    },
        {
        Msg = "";
        TStatus = 100003;
        "Table_Id" = 453;
    },
        {
        Msg = "";
        TStatus = 100001;
        "Table_Id" = 454;
    },
        {
        Msg = "";
        TStatus = 100001;
        "Table_Id" = 455;
    },
        {
        Msg = "";
        TStatus = 100001;
        "Table_Id" = 456;
    },
        {
        Msg = "";
        TStatus = 100001;
        "Table_Id" = 457;
    },
        {
        Msg = "";
        TStatus = 100001;
        "Table_Id" = 458;
    },
        {
        Msg = "";
        TStatus = 100001;
        "Table_Id" = 459;
    },
        {
        Msg = "";
        TStatus = 100001;
        "Table_Id" = 460;
    },
        {
        Msg = "";
        TStatus = 100001;
        "Table_Id" = 461;
    },
        {
        Msg = "";
        TStatus = 100001;
        "Table_Id" = 462;
    },
        {
        Msg = "";
        TStatus = 100003;
        "Table_Id" = 463;
    },
        {
        Msg = "";
        TStatus = 100001;
        "Table_Id" = 464;
    },
        {
        Msg = "";
        TStatus = 100001;
        "Table_Id" = 465;
    },
        {
        Msg = "";
        TStatus = 100001;
        "Table_Id" = 466;
    },
        {
        Msg = "";
        TStatus = 100001;
        "Table_Id" = 467;
    },
        {
        Msg = "";
        TStatus = 100001;
        "Table_Id" = 468;
    },
        {
        Msg = "";
        TStatus = 100001;
        "Table_Id" = 469;
    },
        {
        Msg = "";
        TStatus = 100001;
        "Table_Id" = 470;
    },
        {
        Msg = "";
        TStatus = 100001;
        "Table_Id" = 471;
    },
        {
        Msg = "";
        TStatus = 100001;
        "Table_Id" = 472;
    },
        {
        Msg = "";
        TStatus = 100001;
        "Table_Id" = 473;
    },
        {
        Msg = "";
        TStatus = 100001;
        "Table_Id" = 474;
    },
        {
        Msg = "";
        TStatus = 100001;
        "Table_Id" = 477;
    },
        {
        Msg = "";
        TStatus = 100001;
        "Table_Id" = 478;
    },
        {
        Msg = "";
        TStatus = 100001;
        "Table_Id" = 479;
    }
) 
```

请帮我摆脱这些家伙...在此先感谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-06T09:06:11.073

您必须使用**NSPredicate 过滤数组。**

`NSPredicate *predicate = [NSPredicate predicateWithFormat:@"TStatus == 100001"];`

`NSArray *filtered = ["Your Array" filteredArrayUsingPredicate:predicate];`

在过滤后的数组中，您将获得**Tstatus = 100001 的值；**

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-06T09:11:50.083

您有一个包含所有数据的数组，例如，`arrList`当您想要获取 TStatus 为 100001 的整个数据时，只需使用下面的代码，然后使用下面的代码过滤即可。

```
NSMutableArray *arrTStatus = [[NSMutableArray alloc]init];
 for (int i =0; i<[arrList count]; i++) 
 {
     if ([[[arrList objectAtIndex:i]valueForKey:@"TStatus"] isEqualToString:@"100001"] ) 
     {
          [arrTStatus addObject:[arrList objectAtIndex:i]];   
     }
 } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-06T09:21:13.233

尝试这个

```
for (NSDictionary *status in statuses) {

NSString *Tstatus = [status objectForKey:@"TStatus"]
if([Tstatus isEqualToString:@"100001"){
//Do your code here
}
} 
```

参考这个[关于json的更多信息](http://blog.zachwaugh.com/post/309924609/how-to-use-json-in-cocoaobjective-c)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-06T09:15:43.080

希望这会有所帮助

```
[allObject filteredArrayUsingPredicate:[NSPredicate predicateWithFormat:@"TStatus = 100001"]]; 
```

# macos - Cocoa 布局 OSX（WebView - 填充左侧的空间 + TextView - 右侧固定宽度的侧边栏）怎么样？

> ID：13247512
> 
> 赞同：2
> 
> 时间：2012-11-06T08:55:13.713
> 
> 标签：macos, cocoa, layout

我花了几个小时在谷歌上搜索并试图弄清楚如何使布局按照问题中的描述工作。我已将 WebView 控件放在 Window 内，这样它就可以填充空间，这相当容易，而且一切都像魅力一样工作。不过，在右侧，我想要一个侧边栏——它基本上是一个带有固定的 TextView（我可以对此进行调整）。

奇怪的是，如果我将这些视图彼此相邻放置（左侧的 WebView）并且我正在调整窗口大小，那么 Web 视图只会保持大小而 TextView 正在调整大小。当我将 TextView 放在左侧时，TextView 再次被调整大小并且 WebView 保持大小，但我希望 TextView 保持其宽度和 WebView 调整大小。我错过了什么吗？大概是..

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-07T09:00:05.250

因此，感谢 TheAmateurProgrammer，检查了问题 Auto-layout @ xib 文件。

# tsql - 触发器插入 - 不会在带有 where 子句的真实表上触发

> ID：13247514
> 
> 赞同：0
> 
> 时间：2012-11-06T08:55:25.330
> 
> 标签：tsql, triggers, insert

嗨，我创建了触发器插入，它在测试字段 1 上工作正常。当我将数据复制到设置触发器的表或我使用代码插入时。插入看起来像这样：

```
SET ANSI_NULLS ON GO

SET QUOTED_IDENTIFIER ON GO
Create TRIGGER sometr ON [dbo].[mpomiar] For INSERT
 AS
Begin 
iNSERT INTO  
[Database].dbo.[eksport] ([Repair_Date],[idKard],[Position],[error][Pos_X],[Pos_Y],[Pos_Z],[name],[model],[parent]) 

SELECT i.[Repair_Date],c.idKard,i.[Position],i.error,i.[Pos_X],i.[Pos_Y],i.[Pos_Theta],s.name, mo.Model, pn.Parent 

FROM inserted i
 inner join dbo.test t on i.idtst=t.idtst

 inner join dbo.Kard c on t.idKard=c.idKard

 inner join dbo.TFILE AS s ON t.idTFILE = s.idTFILE INNER JOIN

        dbo.MACHINE AS mc ON t.idMC = mc.idMC INNER JOIN

         dbo.PANEL AS p ON c.idPANEL = p.idPANEL INNER JOIN

        dbo.PARENT AS pn ON i.idPARENT = pn.idPARENT INNER JOIN

         dbo.MODEL AS mo ON pn.idMOD = mo.idMOD

where [Repair_Error] in (400,300)     and c.idKard not in (select idKard from dbo.eksport)

end 
```

但是，当触发器设置在 MS SQL Server 2005 中的真实表上时，它只会在我从代码中删除时触发

> > 其中 [Repair_Error] 在 (400,300) 和 c.idKard 不在（从 dbo.eksport 选择 idKard）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-07T07:04:06.630

我们测试了触发器，它在没有以下情况下工作：

```
where [Repair_Error] in (400,300) 
```

但它适用于：

```
where c.idKard not in (select idKard from dbo.eksport) 
```

触发器必须工作`with where [Repair_Error] in (400,300)`

# objective-c - 在 Obj-C 中生成大数组合

> ID：13247517
> 
> 赞同：0
> 
> 时间：2012-11-06T08:55:32.680
> 
> 标签：objective-c, combinatorics

**tl;dr**：我应该如何处理像`20! * 20!`Objective-C 中的数字？

* * *

我正在通过[Project Euler](https://projecteuler.net)学习 Objective-C 。这很有趣，但我一直遇到的一个问题是处理任意大的数字。我对这些东西还是很陌生，所以我不知道为什么像 Python 这样的东西比 Obj-C 更容易处理大量数字。

举个例子`Problem 15`：

> `Starting in the top left corner of a 2 x 2 grid, there are 6 routes (without backtracking) to the bottom right corner.`
> 
> `How many routes are there through a 20 x 20 grid?`

这很容易。使用组合学：

> （20+20）！/ 20!(20!)
> -> 815915283247897734345611269596115894272000000000 / 5919012181389927685417441689600000000
> -> 137846528820

在 Python 中：

```
import math  
print math.factorial(40) / (math.factorial(20) * math.factorial(20)) 
```

但是在 Objective-C 中呢？我还没有找到一种方法来迫使如此大量的人通过。使用 2 x 2 示例可以正常工作。我可以得到`9C4 = 126`，因为它应该是。但是我应该如何处理像这样的数字`20!`？

我已经尝试使用`NSDecimalNumber`，它似乎支持每个数字更多的数字，假设您可以将其转换为`Mantissa x Exponent`并且不介意精度损失，但这并没有证明太有用，因为我无法计算了解如何让 Obj-C 从 a 创建尾数`%llu`，我*确实*介意精度损失。

到目前为止，我的代码正确地生成了阶乘，因为它似乎`unsigned long long`处理了如此大的值，但在 上阻塞`x * y`，因此`getCombinatoricOf:20 and:20`返回`1`。

```
#import "Problem15.h"

@implementation Problem15

- (unsigned long long)factorial:(NSNumber *)number {
    unsigned long long temp = 1;
    for (int i = [number intValue]; i > 0; i--) {
        temp *= i;
    }
    return temp;
}

- (unsigned long long)getCombinatorcOf:(NSNumber *)x and:(NSNumber *)y {
    NSNumber *n = @([x intValue] + [y intValue]);
    NSNumber *n_factorial = @([self factorial:n]);
    NSNumber *x_factorial = @([self factorial:x]);
    NSNumber *y_factorial = @([self factorial:y]);
    return ([n_factorial unsignedLongLongValue] / ([x_factorial unsignedLongLongValue] * [y_factorial unsignedLongLongValue]));
}

- (NSString *)answer {
    NSNumber *x = @5;
    NSNumber *y = @4;
    unsigned long long answer = [self getCombinatoricOf:x and:y];
    return [NSString stringWithFormat:@"\n\nProblem 15: \nHow many routes are there through a 20 x 20 grid? \n%llu", answer];
}

@end 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-06T09:13:13.760

它不是 Objective-C，但您可以将[GMP](http://gmplib.org)用作普通的 C 库。

还有 GMP 的 Objective-C 包装器，例如[GMPInt](https://github.com/bmorton/GMPInt)。

# jboss - 如何将 Jboss 默认页面更改为我的应用程序的主页？

> ID：13247519
> 
> 赞同：1
> 
> 时间：2012-11-06T08:55:34.910
> 
> 标签：jboss

我在 JBOSS 中部署了一个应用程序，它的访问方式为： localhost/appname 当我只输入 IP 地址时，我会被重定向到 JBOSS 默认页面。有没有一种无需提供 /appname 即可访问应用程序主页的方法？

我希望这个问题很清楚。提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-06T19:20:56.930

您必须将应用程序部署在名为“ROOT.war”的文件中。您还必须删除部署目录中现有的 ROOT.war。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-06T22:13:26.700

作为 Nightsorrow 提供的解决方案的一部分，您还可以使用 WEB-INF/jboss-web.xml 文件的 context-root 标记定义 Web 应用程序的上下文根。因此将其定义为'/'，您可以保留原始文件名。这样您就可以覆盖 JBoss 的默认行为，即将 Web 应用程序的上下文根定义为应用程序的文件名（除非应用程序名称是 ROOT.war，其默认上下文是“/”）。

所以 jboss-web.xml 文件看起来类似于：

```
<jboss-web>
   ... other tags ...
   <context-root>/</context-root>
   ... other tags ...
</jboss-web> 
```

请注意，不能有两个应用程序具有相同的上下文根，因此首先您必须删除 ROOT.war，或者按照相同的过程更改其上下文根：

*   将 context-root 标签添加到 jboss-web.xml（例如：`<context-root>/oldRoot</context-root>`，这将使旧的 ROOT.war 应用程序可以通过 localhost/oldRoot 使用），或者
*   只是更改其文件名。

如果您想部署一个内部带有 web 模块 (war) 的 EAR 文件（而不仅仅是一个普通的 war 文件），您必须使用 EAR 的 META-INF/application.xml。以这种方式定义 Web 模块：

```
<application>
        ... other tags and other modules (ejb, web ...) ...
    <module>
        <web>
            <web-uri>nameOfYourWarFile.war</web-uri>
            <context-root>/</context-root>
        </web>
    </module>
        ... other tags and other modules (ejb, web ...) ... 
</application> 
```

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2014-09-10T14:40:13.710

我正在使用eap6。这是我第一次使用jboss。我没有看到我有 $JBOSS_HOME/server。我看到了 $JBOSS_HOME/domain/server。我已经搜索了 $JBOSS_HOME 下的所有文件。我找不到任何 WEB-INF 和 jboss-web.xml

# jquery - Jquery 每个函数中的每个都返回 undefined

> ID：13247523
> 
> 赞同：1
> 
> 时间：2012-11-06T08:55:48.783
> 
> 标签：jquery

我正在使用`$.each`函数循环一个对象，但我得到了不确定的值。

我的代码有什么问题？

```
var mainPageCircle = {
    circles: {
        c1: {
            color: '#730000',
            text: 'Content'
        },
        c2: {
            color: '#004f74',
            text: 'Consulting'
        },
        c3: {
            color: '#146c00',
            text: 'Commerce'
        }
    },
    radious: 100,
    stroke: 10,
    strokeColor: '#fff',
    opacity: 0.7
}

$.each(mainPageCircle, function(key, value) {
    var circles = value.circles,
        radious = value.radious;
    $.each(circles, function(index, c) {
        console.log(index, c); // i am getting error; i need index should be 0,1,2 and c should be : c1,c2,c3 values
    })
}) 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-06T09:00:18.987

像这样的东西？

```
var mainPageCircle = {
    circles :{
        c1:{color:'#730000',text:'Content'},
        c2:{color:'#004f74',text:'Consulting'},
        c3:{color:'#146c00',text:'Commerce'}
    },
    radious:100,
    stroke:10,
    strokeColor:'#fff',
    opacity:0.7
};

var i = 0;

$.each(mainPageCircle.circles, function(){
    console.log(i, this); 
    //i: current index
    //this: c1, c2 etc
    //use properties on this to fetch the values
    //this.color for example
    i++;
});​ 
```

您将无法`key`在示例中将其用作索引整数，因为它将获取对象键，而不是循环中的当前索引。

## [小提琴](http://jsfiddle.net/PxHFg/)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-06T09:11:28.097

您的 each 正在运行 mainPageCircle 的所有项目，而不仅仅是其中定义的圆圈。这可能是您的目标：

```
var mainPageCircle = {
    circles :{
        c1:{color:'#730000',text:'Content'},
        c2:{color:'#004f74',text:'Consulting'},
        c3:{color:'#146c00',text:'Commerce'}
    },
    radious:100,
    stroke:10,
    strokeColor:'#fff',
    opacity:0.7
    }
$.each(mainPageCircle.circles , function (key,value) {
       var circles = value,radious = mainPageCircle.radious;
       $.each(circles, function (index,c) {
            console.log(index,c);
        });
}); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-11-06T09:01:10.913

我不确定您的意图是什么，但您可能打算执行以下操作：

```
var mainPageCircle = {
    circles :{
        c1:{color:'#730000',text:'Content'},
        c2:{color:'#004f74',text:'Consulting'},
        c3:{color:'#146c00',text:'Commerce'}
    },
    radious:100,
    stroke:10,
    strokeColor:'#fff',
    opacity:0.7
}

var circles = mainPageCircle.circles,
    radious = mainPageCircle.radious;
$.each(circles, function (index, c) {
    console.log(index,c); // c1, props, etc...
    console.log(parseInt(index,10)); // 1,2,3...
}); 
```

# c - realloc 但只有前几个字节有意义

> ID：13247526
> 
> 赞同：8
> 
> 时间：2012-11-06T08:56:08.357
> 
> 标签：c, memory-management, malloc, realloc, libc

假设我曾经用字节`ptr = malloc(old_size);`分配内存块。`old_size`只有第一个`header_size`字节是有意义的。我要把尺寸增加到`new_size`.

`new_size`大于`old_size`并且`old_size`大于`header_size`。

前：

```
/- - - - - - - old_size - - - - - - - \
+===============+---------------------+
 \-header_size-/ 
```

后：

```
/- - - - - - - - - - - - - - - new_size - - - - - - - - - - - - - - - - - - -\
+===============+------------------------------------------------------------+
\- header_size-/ 
```

我不在乎之后存储了什么，`ptr + header_size`因为我会在那里读取一些数据。

### 方法一：直接去`new_size`

```
ptr = realloc(ptr, new_size); 
```

### 方法2：收缩到`header_size`增长到`new_size`

```
ptr = realloc(ptr, header_size);
ptr = realloc(ptr, new_size); 
```

### 方法3：分配一个新的内存块并复制第一个`header_size`字节

```
void *newptr = malloc(new_size);
memcpy(newptr, ptr, header_size);
free(ptr);
ptr = newptr; 
```

哪个更快？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-06T09:00:11.247

`malloc`（对于整个块）和（对于增加大小时超出旧块大小的空间）都不能`realloc`保证您收到的内存将包含什么，因此，如果您希望将这些多余的字节设置为零（例如），您'必须自己做一些类似的事情：

```
// ptr contains current block.
void *saveptr = ptr;
ptr = realloc (ptr, new_size);
if (ptr == NULL) {
    // do something intelligent like recover saveptr and exit.
}
memset (ptr + header_size, 0, new_size - header_size); 
```

但是，由于您已声明您不关心标题之外的内容，因此几乎可以肯定最快的是单个`realloc`，因为这可能会在幕后进行优化。

调用它两次进行收缩和扩展，或者调用`malloc-new/memcpy/free-old`不太可能像所有优化一样有效，你应该*测量，不要猜测！*

请记住，`realloc`不一定要复制您的记忆。如果扩展可以就地完成，那么智能堆管理器只会增加块的大小而不复制任何内容，例如：

```
+-----------+   ^        +-----------+ <- At same address,
| Old block |   | Need   | New block |      no copying
|           |   | this   |           |      involved.
+-----------+   | much   |           |
| Free      |   | now.   |           |
|           |   v        +-----------+
|           |            | Free      |
|           |            |           |
+-----------+            +-----------+ 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-06T09:33:08.340

It almost certainly depends on the values of `old_size`, `new_size` and `header_size`, and also it depends on the implementation. You'd have to pick some values and measure.

1) is probably best in the case where `header_size == old_size-1 && old_size == new_size-1`, since it gives you the best chance of the single `realloc` being basically a no-op. (2) should be only very slightly slower in that case (2 almost-no-ops being marginally slower than 1).

3) is probably best in the case where `header_size == 1 && old_size == 1024*1024 && new_size == 2048*1024`, because the `realloc` would have to move the allocation, but you avoid copying 1MB of data you don't care about. (2) should be only very slightly slower in that case.

2) is probably best when `header_size` is much smaller than `old_size`, and `new_size` is in a range where it's reasonably likely that the `realloc` will relocate, but *also* reasonably likely that it won't. Then you can't predict which of (1) and (3) it is that will be very slightly faster than (2).

In analyzing (2), I have assumed that realloc downwards is approximately free and returns the same pointer. This is not guaranteed. I can think of two things that can mess you up:

*   realloc downwards copies to a new allocation
*   realloc downwards splits the buffer to create a new chunk of free memory, but then when you realloc back up again the allocator *doesn't* merge that new free chunk straight back onto your buffer again in order to return without copying.

Either of those could make (2) significantly more expensive than (1). So it's an implementation detail whether or not (2) is a good way of hedging your bets between the advantages of (1) (sometimes avoids copying anything) and the advantages of (3) (sometimes avoids copying too much).

Btw, this kind of idle speculation about performance is more effective in order to tentatively explain your observations, than it is to tentatively predict what observations we would make in the unlikely event that we actually cared enough about performance to test it.

Furthermore, I suspect that for large allocations, the implementation might be able to do even a relocating `realloc` without copying anything, by re-mapping the memory to a new address. In which case they would all be fast. I haven't looked into whether implementations actually do that, though.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-06T09:04:43.960

这可能取决于大小以及是否需要复制。

方法 1 将复制旧块中包含的所有内容 - 但如果您不经常这样做，您将不会注意到。

方法 2 只会复制您需要保留的内容，因为您事先丢弃了其他所有内容。

方法 3 将无条件复制，而其他方法仅在内存块无法调整大小时复制。

就个人而言，如果您经常这样做，我更喜欢方法 2，如果您很少这样做，我更喜欢方法 1。分别地，我会介绍其中哪些会更快。

# android - 在android中从上到下移动imageview

> ID：13247534
> 
> 赞同：1
> 
> 时间：2012-11-06T08:56:32.537
> 
> 标签：android, android-layout, android-animation

我的屏幕中心有一个 ImageView，我想向上移动。它仍然在顶部。我看到 Tween Animation Documents 并尝试过，但它不起作用。任何人都可以帮助我解决这个问题。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-06T09:16:38.570

你试过查看动画吗？

```
Animation an = new TranslateAnimation(fromX,fromY,toX,toY);//0,0 is the current       coordinates
an.setFillAfter(true);// to keep the state after animation is finished
yourView.startAnimation(an);// to start animation obviously 
```

让它从下到上移动，获取屏幕高度并使用它来设置“toY”参数。

经过几次尝试，你一定会做到的。

# java - JMM 顺序一致性

> ID：13247539
> 
> 赞同：2
> 
> 时间：2012-11-06T08:56:45.643
> 
> 标签：java, multithreading

我试图在 Java 内存模型方面理解“顺序一致性”。JLS第17章的定义对我来说不是那么清楚。

我会给出我的愿景，如果我错了，请纠正我。具有一个线程顺序一致性的程序意味着如果 action1 在程序顺序中位于 action2 之前，那么 action2 应该看到 action1 的结果。

有两个线程。

线程1：

```
action1
action2 
```

线程2：

```
action3
action4 
```

如果`action3`看到 的结果`action2`，那么它也应该看到 的结果`action1`。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-06T09:01:06.523

你是对的; 顺序一致性意味着每个动作都是原子执行的，并且对所有线程立即可见。就好像您将所有线程交错到一个线程中，一个一个地执行操作。

请注意，顺序一致性**并不是 Java 内存模型实际工作的方式**。

引用[17.4.3，程序和程序顺序](http://docs.oracle.com/javase/specs/jls/se7/html/jls-17.html#jls-17.4.3)：

> 如果我们使用顺序一致性作为我们的内存模型，我们讨论过的许多编译器和处理器优化都是非法的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-06T09:04:37.447

> 一个线程顺序一致性意味着如果 action1 在程序顺序中出现在 action2 之前，那么 action2 应该看到 action1 的结果。

这是正确的，没有这个原则就不可能编程。

> 如果 action3 看到 action2 的结果，那么它也应该看到 action1 的结果。

没有使用`volatile`或锁定就没有这样的保证。例如 action1 可以更新一个缓存行，而 action2 可以更新另一个。当这种情况发生时，无法保证第二个线程何时或是否会看到这些更改。

# ruby-on-rails - 在 Rails 中何处放置复杂的 require 语句？

> ID：13247547
> 
> 赞同：1
> 
> 时间：2012-11-06T08:57:17.037
> 
> 标签：ruby-on-rails

我正在编写一些我希望同时兼容 1.8.7 和 1.9 的 Rails 代码。在几个不同的文件中，我做了一些 CSV 解析，所以我目前在每个文件中有以下要求行：

```
if RUBY_VERSION < "1.9"
  require "rubygems"
  require "fastercsv"
  CSV = FCSV
else
  require "csv"
end 
```

但是，为了避免所有重复，这个块可能应该放在一个地方。放在哪里最好？是`application.rb`正确的地方吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-06T09:08:51.690

我会把它放在一个初始化程序中`config/initializers/csv.rb`。这会自动加载到 rails 中，并且不会混入加载路径（因此您不必担心文件名）。

请注意，某些加载机制不执行“要求”，而只是在加载程序上下文中运行文件，因此如果您遇到异常，您可能不会以通常的方式处理它。

# c# - 在剃刀视图中实例化对象Asp.net Mvc 4

> ID：13247551
> 
> 赞同：5
> 
> 时间：2012-11-06T08:57:35.903
> 
> 标签：c#, asp.net-mvc, razor, asp.net-mvc-4

我有一个强烈绑定到视图模型的剃刀视图：

```
@model MyNamespace.MyViewModel 
```

我想在同一视图页面中创建另一个视图模型的实例并使用它：

```
@test = new MyNamespace.AnotherViewModel();

@test.SomeAction(); 
```

我收到编译错误：

```
The name 'test' does not exist in the current context 
```

我对 asp.net mvc 非常陌生，无法使其工作。任何帮助将不胜感激。谢谢！

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-11-06T09:01:33.527

`@{ code }`您可以通过将其包装在for 多行语句中来表示多行代码：

```
@{ 
    var test = new MyNamespace.AnotherViewModel();
    test.SomeAction();
} 
```

# php - 使用自动加载功能获取文件以在 Ajax 中使用的路径问题

> ID：13247553
> 
> 赞同：0
> 
> 时间：2012-11-06T08:57:39.130
> 
> 标签：php, ajax, path

所以我的项目使用了一个 MVC 框架，并且我有一个带有 Ajax 脚本的页面，我运行该脚本来从服务器获取内容。当在 Ajax 脚本中调用 PHP 脚本时，我想访问我的库中已有的类以在 PHP 脚本中使用。为此，我使用我所谓的 ajaxBootstrap 来调用适当的函数，然后实例化该特定 Ajax 脚本所需的对象。

要从我的库中加载这些类，我的 ajaxBootstrap 中有一个自动加载功能，因此我不需要使用一堆 require 和 include 语句。我的问题是由于自动加载功能的路径问题而没有加载这些文件。当我使用具有相同路径的 require 语句时，类加载没有问题，只有当我尝试使用自动加载功能加载它们时，才会收到 500 内部服务器错误。

这是我的 ajaxBootstrap 文件：

```
// This file routes Ajax requests made in JS files and instantiates a specific object to carry out the actions needed for that particular Ajax operation 

// Autoload any classes that are required
function autoLoad($classToLoad)
{
    if(file_exists('../library/' . $classToLoad . 'class.php')) // File in the library folder
    {
        require('../library/' . $classToLoad . '.class.php');
   }
    else if(file_exists('../../app/models/' . $classToLoad . 'class.php')) // File in the models folder
    {
        require('../../app/models/' . $classToLoad . '.class.php');
    }
}

spl_autoload_register('autoLoad');

// Determine which function to call based on the url that's listed in the Ajax request
switch($_GET['action'])
{
    case 'pageOne':
        pageOne();
        break;
    case 'pageTwo':
        pageTwo();
        break;
}

function pageOne()
{
    $test = new Test();
    $test->funcThatReturnStuff();
}

function pageTwo()
{
    $test2 = new Test2();
    $test2->funcThatReturnStuff();
} 
```

就像我之前提到的，如果我使用 require 语句，例如：

```
require('../library/Test.class.php');
$test = new Test();
$test->funcThatReturnStuff(); 
```

类加载和工作得很好。但是在自动加载器函数中使用相同的路径会引发错误。真正奇怪的是，如果我在自动加载器中放置一个 else if 语句，该语句从我的 ajaxBootstrap 所在的文件夹中加载一个类，它也可以正常工作......

我知道我可以只使用 require 语句并解决问题，但我希望能够扩展项目并且将来不需要使用大量的 require 语句。顺便说一句，我使用“../”从我的 ajaxBootstrap 文件所在的位置获取到我的其他文件夹。

另外，为了添加到我之前的帖子中，我尝试`../`使用绝对路径替换`define('ROOT', dirname(__FILE__) . '/')`，`define('ROOT', $_SERVER['DOCUMENT_ROOT'] . '/path/to/folder/')`但两者都不起作用，仍然给我 Firebug 中的内部服务器错误。此外，我的错误日志中也没有收到任何错误。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-06T20:43:41.437

没关系......即使在过去几个小时盯着我的代码之后，我还是以某种方式错过了两个文件路径中缺少的时间段。我有时讨厌编码...感谢任何花时间阅读本文的人。

# tooltwist - 如何针对以下提到的场景执行复杂的 SQL 查询

> ID：13247554
> 
> 赞同：1
> 
> 时间：2012-11-06T08:57:43.420
> 
> 标签：tooltwist

```
XpcSecurity credentials = ud.getCredentials();
    Xpc xpc = new Xpc(credentials);
    xpc.start("training.getEmployees", "select");
    xpc.attrib("id", "10");
   XData result = xpc.run(); 
```

• 如果我们想要获取 id 在 10 到 30 之间的员工怎么办 • 如果我想根据时间戳/日期选择记录怎么办 • 如果想要连接多个表并查询它。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-06T10:52:58.063

您似乎正在使用基于 xpc.start("training.getEmployees", "select") 中的实体“training.getEmployees”的 XPC 插件（XPC 类文件）。在这种情况下，请执行以下操作：

```
XpcSecurity credentials = ud.getCredentials();
Xpc xpc = new Xpc(credentials);
xpc.start("training.getEmployees", "select");
xpc.attrib("idLower", "10");
xpc.attrib("idUpper", "30");
XData result = xpc.run(); 
```

在runMethod内的Xpc插件（可能命名为“GetEmployeesXpc”）中，执行以下操作来获取通过上面的xpc代码传递的数据

```
// Get the method passed through xpc.start
String method = elem.getAttribute("method"); 

// Get the attrib using the following
XData input = new XData(elem);
String upperLimit = input.getText("//idUpper");
String lowerLimit = input.getText("//idLower");

// process the query depending on how you access your data source
if (method.equals("select")) {
    // put your logic here to access your data source
    String query = "select * from employees where id>"+lowerLimit+" &&  id<"+upperLimit";"
     :
     :
} else {
     // Do something else
} 
```

您可以对日期/时间戳或连接执行相同的操作。只需传递数据并在 Xpc 插件中处理它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-05T06:06:03.007

我的回答可能为时已晚，但出于参考目的，您可以试试这个：

```
XpcSecurity credentials = ud.getCredentials();
Xpc xpc = new Xpc(credentials);
xpc.start("training.getEmployees","select");

StringBuffer whereClause = new StringBuffer();

//In xpc this is the equivalent of "id between idLower and idUpper"
whereClause.append("<whereClause>\n");
whereClause.append("    <expr op='and' returnType='char'>\n");
whereClause.append("        <expr op='ge' returnType='char'>\n");
whereClause.append("            <operand>id</operand>\n");
whereClause.append("            <operand type='literal'>"+idLower+"</operand>\n");
whereClause.append("        </expr>\n");
whereClause.append("        <expr op='le' returnType='char'>\n");
whereClause.append("            <operand>id</operand>\n");
whereClause.append("            <operand type='literal'>"+idUpper+"</operand>\n");
whereClause.append("        </expr>\n"); whereClause.append("    </expr>\n");
whereClause.append("</whereClause>\n");

xpc.input(whereClause);
XData result = xpc.run(); 
```

对于表连接：

我看到你已经在使用 xpc 类了。在这个类中把它放在初始化函数中：

```
mapEntity("training.getEmployees");

addLevel("employees");  
mapTable("employee", "employee", null);
mapColumn("employee_id", "employeeId", "employeeId", true, false);
mapColumn("first_name", "firstName", "firstName", false, false);
mapColumn("last_name", "lastName", "lastName", false, false);

mapTable("time_track", "timeTrack", null);
mapColumn("time_track_id", "timeTrackId", "timeTrackId", true, false);
mapColumn("time_in", "timeIn", "timeIn", false, false);
mapColumn("time_out", "timeOut", "timeOut", false, false);
mapColumn("employee_id", "employeeId", "employeeId", false, false);

addJoin("employee", "employeeId", "timeTrack", "employeeId"); 
```

这相当于 Select * from employee a internal join time_track b on a.employee_id = b.employee_id

您现在可以在选择时应用条件

# ios - MPMoviePlayerController 看似随机崩溃

> ID：13247556
> 
> 赞同：2
> 
> 时间：2012-11-06T08:57:47.070
> 
> 标签：ios, ios5, ios6, mpmovieplayercontroller, mpmovieplayer

有时，我的应用程序会因此崩溃日志而崩溃。

一个神奇的解决方案将是理想的，但一些关于从哪里开始调试的帮助也会有所帮助。该应用程序非常难以调试，因为它是基于 GPS 的应用程序，所以如果我知道要寻找什么，我可以构建某种压力测试。

```
Exception Type:  EXC_CRASH (SIGABRT)
Exception Codes: 0x00000000, 0x00000000
Crashed Thread:  0

Last Exception Backtrace:
0   CoreFoundation      0x3789c88f __exceptionPreprocess + 163
1   libobjc.A.dylib     0x31911259 objc_exception_throw + 33
2   AVFoundation        0x309301d9 -[AVPlayer _attachItem:andPerformOperation:withObject:] + 249
3   AVFoundation        0x309300db -[AVPlayer _insertItem:afterItem:] + 27
4   AVFoundation        0x30943b9d -[AVQueuePlayer insertItem:afterItem:] + 137
5   MediaPlayer         0x364a68b7 __block_global_2 + 199
6   libdispatch.dylib   0x34a4bc59 _dispatch_call_block_and_release + 13
7   libdispatch.dylib   0x34a4dee7 _dispatch_main_queue_callback_4CF$VARIANT$mp + 195
8   CoreFoundation      0x3786f2ad __CFRunLoopRun + 1269
9   CoreFoundation      0x377f24a5 CFRunLoopRunSpecific + 301
10  CoreFoundation      0x377f236d CFRunLoopRunInMode + 105
11  GraphicsServices    0x379eb439 GSEventRunModal + 137
12  UIKit               0x309fecd5 UIApplicationMain + 1081
13  App                 0x000b5b6f main (main.m:14) 
```

我正在播放各种电影（mov（H.264、1024 x 576、AAC、44100 Hz、立体声（LR））和声音（MP3 和 WAV），有时是混合的。

电影使用 MPMoviePlayer 播放，声音使用 AVAudioPlayer。

发生在 ios 5 和 6 上。（iPad）

--- 编辑：添加代码 ----

视频在这里准备：

```
- (void) prepareLayer:(NSDictionary*) aUserInfo{
    mMoviePlayerController.contentURL = [aUserInfo objectForKey:@"contenturl"];                     // set content
    [mMoviePlayerController prepareToPlay];
    mMoviePlayerController.shouldAutoplay = NO;                                                     // prevent autoplay
    mMovieShouldLoop = NO;
    [mWrapper setOpacity: 0];                                                                       // hide video view (we don't want to see the previous video file)                                                                           
} 
```

mWrapper 用于将视频封装在一个 cocos2d 节点中

```
- (void) showLayer {
    [mWrapper setVisible: YES];
    [mMoviePlayerController pause];
    mRetryCounter = 0;
    mMovieStarted = NO;
    self.visible = YES;
}

- (void) updateLayer {
    if (!self.visible)      {   return; }                                                                                       // not visible, so not updating (prevents accidental playing of video)

    if (mWarningHidden && !mMovieStarted)                                                                                       // if warning is hidden and the movieStarted flag is false
    {
        if (mMoviePlayerController.playbackState == MPMoviePlaybackStatePlaying) {                                              // if movie did start successfully.
            mMovieStarted = YES;                                                                                                // set flag
            [mWrapper setOpacity: 255];                                                                                         // show video view
        }
        else {                                                                                                                  // if movie is not playing yet          
            if (mRetryCounter == 0) {                                                                                           // if this is the first try
                [[[CCDirector sharedDirector] openGLView] addGestureRecognizer:mSwipe];                                         // enable swipe gesture
            }
            [mMoviePlayerController play];                                                                                      // start playing
            if (mMovieShouldLoop) {                                                                                             // and set loop or not
                if (mMoviePlayerController.repeatMode != MPMovieRepeatModeOne) {
                    mMoviePlayerController.repeatMode = MPMovieRepeatModeOne;
                }
            } else {
                if (mMoviePlayerController.repeatMode != MPMovieRepeatModeNone) {
                    mMoviePlayerController.repeatMode = MPMovieRepeatModeNone;
                }
            }

            if (mMoviePlayerController.playbackState != MPMoviePlaybackStatePlaying && mRetryCounter > 5) {                     // if movie not playing and retried for 5 times,
                mMoviePlayerController.contentURL = [[NSBundle mainBundle] URLForResource:@"novideo" withExtension:@"m4v"];     // switch to movie of static, indicating something went wrong
                [mMoviePlayerController play];                                                                                  // and play that.
            }

            if (mRetryCounter > 10) {
                mMovieStarted = YES;                                                                                            // if movie still doesn't run after switched to static and retrying that for 5 times, skip it.
                NSLog(@"A Movie was skipped after trying to play it for 10 times.");
            }           
            mRetryCounter++;                                                                                                    // count retries.           
        }
    }
} 
```

-- 编辑：删除了代码片段的声音部分，因为它们不是问题的一部分，并更改了标题以反映问题出在 MPMoviePlayerController 中，而不是在 AVPlayer 中。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-21T09:30:27.270

我通过使用较低级别的 AVPlayer 而不是 MPMoviePlayer 解决了这个问题。这完全解决了我的问题。

# entity-framework - 实体框架并发：事务或并发固定？

> ID：13247560
> 
> 赞同：0
> 
> 时间：2012-11-06T08:58:01.870
> 
> 标签：entity-framework, concurrency, transactions

我需要进行库存控制，所以我需要确保当我修改产品数量时，是以正确的方式进行的。我正在使用实体框架 4.0

例如，如果我使用事务，当我从数据库中加载记录时，记录被阻止，因此我可以减去或添加到加载的数量，即我需要的项目数。但是，这块数据库中的记录可能出于性能原因并不是最好的方法。这让我问何时使用 EF 交易。

另一种选择是使用实体框架的并发固定，使用时间跨度列来检测记录是否已更改。在这种情况下，如果在我的加载和更新之间修改了记录，我会遇到并发异常。但是在我的异常处理程序中，如果我用数据库数据更新我的上下文，在我的刷新和 savechanges 之间可能会再次发生变化。

另一个问题是我终于可以保存更改了。例如，我有 10 个单位，我需要减去 8，但在我的加载和更新之间，其他人减去 5 个单位。如果我减去 8，那么在库存中我有 -3 个单位。这是不可能的。如果我有一个事务，我加载记录，被阻塞，所以我可以检查我是否有足够的单位，如果有，我可以子跟踪，如果没有，我发送一个异常。

所以我的问题是，我知道 EF 本身就是一个事务，但它在 EF 中也存在事务，所以在某些情况下它会很有用。何时使用固定的 EF 和 cocurrency 以及何时使用事务？

谢谢。戴姆洛克。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-07T01:33:08.050

事务不应该用于解决并发问题。您应该使事务尽可能短，以免阻塞您的数据库。此处采用的方法是乐观并发——在数据库 (SqlServer) 中，您创建一个 rowversion 列，该列在每次修改一行时都会自动更改。您将其用作并发令牌。保存更改时，EF 会根据实体上的值对此进行检查，如果它们不匹配，则会引发异常。请注意，对于 SaveChanges，EF 始终创建一个事务，因为通常您保存多个实体，如果出现问题，数据库需要恢复到原始状态 - 否则它将处于损坏状态。为了防止低于零——如果你使用乐观并发——你会' 如果数据库中的值发生更改，则无法保存，因为并发令牌将不同，因为行已被修改，因此对客户端的检查应该足够了。或者，您可以将保存实体映射到存储过程，该过程将在保存之前检查值，如果保存后的值不正确，则会返回错误。

# expressionengine - 将现有快递店导出到新站点

> ID：13247561
> 
> 赞同：4
> 
> 时间：2012-11-06T08:58:05.993
> 
> 标签：expressionengine, expresso-store

我已经在一个旧站点上设置并运行了 Expresso Store。我一直在开发一个新站点，安装了新版本的 Store 并设置了一些测试产品。知道如何将旧产品导出到新站点吗？

据我所见，产品存储在数据库中的 exp_channels 和 exp_store_products 中。我可以在数据库之间进行一些导出/导入吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-06T19:42:40.233

正如卡尔所说，如果您不想转储整个数据库并将其导入新站点，DataGrab 将是您最好的选择。

商店在 exp_channel_data 中确实有一些数据，但如果您正在考虑手动传输数据，您的产品的 exp_store_products、exp_store_product_modifiers、exp_store_product_options、exp_store_stock、exp_store_stock_options 中也会有数据。z

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-06T09:42:59.043

我建议从 AJ Weaver [http://devot-ee.com/add-ons/datagrab获得类似 DataGrab 的东西](http://devot-ee.com/add-ons/datagrab)

数据存储在 Channel Entries 中，因此应该像从旧通道导出并导入新通道一样简单。

# javascript - 仅允许从移动和平板设备访问

> ID：13247563
> 
> 赞同：0
> 
> 时间：2012-11-06T08:58:08.820
> 
> 标签：javascript, jquery, jquery-mobile, modernizr

我的客户有非常具体的要求。他想阻止所有“经典”计算机（台式机/笔记本电脑）。

因此，如果我从 iPhone、Android 或平板电脑访问该网站，它会显示所有内容（我可以通过响应式设计处理不同的分辨率）。但是，当来自 Mac、Windows 或 Linux（我知道 Android 也是基于 gnu/linux ；））的人访问网络时，他只会收到一条消息，即“此网络仅适用于移动设备”或类似的东西。

但我不确定如何“禁止”mac os、win、linux 等。

javascript(jQuery) 库，例如 Modernizr 或其他“只是移动设备”可以做这样的特定条件吗？

Windows 8 怎么样 :( ？

我真的很感谢任何建议，因为我以前从未有过这样的要求？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-06T09:07:10.893

我认为您可以通过多种方式做到这一点。

您可以通过 javascript 检查，但是如果有人关闭 javascript，您将再次被搞砸，因为他们可以查看该网站：

```
if( /Android|webOS|iPhone|iPad|iPod|BlackBerry/i.test(navigator.userAgent) ) {
 // some code..
} 
```

或者你可以通过modernizr检查它，但我不知道如何在modernizr中进行检查，你也会遇到关闭javascript代码的问题，

或者您可以通过以下方式下载适合您情况的脚本：

[http://detectmobilebrowsers.com/](http://detectmobilebrowsers.com/)

您可以做的另一件事是检查屏幕分辨率，但是，我们又回到了 javascript 案例。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-06T09:09:34.323

根据[MSDN](http://msdn.microsoft.com/en-us/library/ms537503%28v=vs.85%29.aspx)`Tablet PC` ，如果它是平板电脑，Windows 会添加到浏览器用户代理中。

我建议不要通过 javascript 执行此操作，因为如上所述：如果禁用 javascript，人们将能够访问您的站点。

# android - 在 Android 中调用 WebService

> ID：13247565
> 
> 赞同：0
> 
> 时间：2012-11-06T08:58:10.067
> 
> 标签：android

它主要执行SQL。我下载断点。也许在句子中`if (envelope.getResponse() != null)`它得到了空对象，所以它在返回空值后完成。我在SQL中监控，发现它没有执行SQL语句。比如：`ht.call("http://toeye.net/" + MothodName, envelope);`它也没有在webservice中执行。

```
public static String sSQL(String SQL)
{
    String MothodName = "ExecSQL";
    HttpTransportSE ht = new HttpTransportSE("http://192.168.1.80/YFService.asmx?WSDL");
    ht.debug = true;
    // use SOAP1.1 creat Envelop object
    SoapSerializationEnvelope envelope = new SoapSerializationEnvelope(
        SoapEnvelope.VER12);
    // instantiate SoapObject
    SoapObject soapObject = new SoapObject("http://toeye.net/", MothodName);
    soapObject.addProperty("SQLString", SQL);
    envelope.bodyOut = soapObject;
    // set the Web Service which applied by .Net and keep the compatibility
    envelope.dotNet = true;
    try
    {
        // call Web Service
        ht.call("http://toeye.net/" + MothodName, envelope);
        if (envelope.getResponse() != null)
        {
            // Access server response and return SOAP message
            SoapObject result = (SoapObject) envelope.bodyIn;
            SoapObject detail = (SoapObject) result.getProperty(MothodName
                + "Result");
            // Analytic server response SOAP message
            return detail.toString();
        }
    }
    catch (IOException e)
    {
        e.printStackTrace();
    }
    catch (XmlPullParserException e)
    {
        e.printStackTrace();
    }
    return null;
} 
```

# java - Android - 使用 SimpleCursorAdapter 动态 ListView

> ID：13247569
> 
> 赞同：0
> 
> 时间：2012-11-06T08:58:29.947
> 
> 标签：java, android, sqlite, simplecursoradapter

我正在使用 SimpleCursorAdapter 填充 ListView

```
@Override
public Loader<Cursor> onCreateLoader(int arg0, Bundle arg1) {

    String[] projection = new String[] { BlogTable.TITLE_PLAIN, BlogTable.DATE_MODIFIED, BlogTable.EXCERPT, BlogTable.ID };

    CursorLoader loader = new CursorLoader(parent, BlogContentProvider.CONTENT_URI, projection, null, null, BlogTable.DATE_MODIFIED + " DESC LIMIT " + BlogContentProvider.QUERY_LIMIT);

    return loader;
}

private void fillData(){

    //_id is expected from this method that is why we used it earlier
    String[] from = new String[] { BlogTable.TITLE_PLAIN, BlogTable.DATE_MODIFIED, BlogTable.EXCERPT};
    int[] to = new int[] { R.id.text_news_title, R.id.text_news_date, R.id.text_news_excerpt};

    //initialize loader to call this class with a callback
    getLoaderManager().initLoader(0, null, this);

    //We create adapter to fill list with data, but we don't provide any data as it will be done by loader
    adapter = new SimpleCursorAdapter(parent, R.layout.news_list_view, null, from, to, 0);

    setListAdapter(adapter);
} 
```

我想一次只加载 10 个项目，然后在列表的末尾调用一个方法 addData() 并再获得 10 行，依此类推。我知道为此有 CWAC EndlessAdapter，但是我不知道要向当前 ListView 添加另外 10 行并同时保持位置的调用。

我知道这听起来像是一个愚蠢的问题，但我对 Android 开发还比较陌生，而且还在学习。任何人都可以帮忙吗？

编辑：

这是我正在使用的 ContentProvider，也许它可以提供帮助

```
package com.brndwgn.database;

import android.content.ContentProvider;
import android.content.ContentResolver;
import android.content.ContentValues;
import android.content.UriMatcher;
import android.database.Cursor;
import android.database.sqlite.SQLiteDatabase;
import android.database.sqlite.SQLiteQueryBuilder;
import android.net.Uri;
import android.text.TextUtils;

public class BlogContentProvider extends ContentProvider {

    private DbHelper dbh;

    //identifiers for URI types
    public static final int BLOG_LIST = 1;
    public static final int BLOG_ITEM = 2;

    //elements of our URI to identify our COntentProvider
    public static final String AUTHORITY = "com.brndwgn.database";
    public static final String BASE_PATH = "blog";

    //URI to query from this Content provider
    public static final Uri CONTENT_URI = Uri.parse("content://" + AUTHORITY + "/" + BASE_PATH);

    //MIME data types we offer
    public static final String BLOG_LIST_TYPE = ContentResolver.CURSOR_DIR_BASE_TYPE + "/bloglist";
    public static final String BLOG_ITEM_TYPE = ContentResolver.CURSOR_ITEM_BASE_TYPE + "/blogitem";

    public static UriMatcher matcher = new UriMatcher(UriMatcher.NO_MATCH);
    //patterns for our provider
    static {
        matcher.addURI(AUTHORITY, BASE_PATH, BLOG_LIST);
        matcher.addURI(AUTHORITY, BASE_PATH + "/#", BLOG_ITEM);
    }

    public static final int QUERY_LIMIT = 2;

    @Override
    public boolean onCreate() {
        dbh = new DbHelper(getContext());
        return true;
    }

    @Override
    public String getType(Uri uri) {
        int uriId = matcher.match(uri);
        //we check id of URI and return correct MIME type, we defined all of them before
        switch(uriId) {
        case BLOG_ITEM: return BLOG_ITEM_TYPE;
        case BLOG_LIST: return BLOG_LIST_TYPE;
        default:
            throw new IllegalArgumentException("Unknown uri: " + uri);
        }
    }   

    @Override
    public Cursor query(Uri uri, String[] projection, String selection,
            String[] selectionArgs, String sortOrder) {
        int uriId = matcher.match(uri);

        //we create object of SQL query builder so we don't need to use plain SQL
        SQLiteQueryBuilder builder = new SQLiteQueryBuilder();

        //Set a name for the table to query
        builder.setTables(BlogTable.TABLE_NAME);

        switch(uriId) {
        case BLOG_ITEM: 
            //set where condition to get just one row
            builder.appendWhere(BlogTable.ID + "=" + uri.getLastPathSegment());
            break;
        case BLOG_LIST:
            //we don't need to do anything here
            break;
        default:
            new IllegalArgumentException("Unknown uri: " + uri);
        }

        //get instance of database
        SQLiteDatabase db = dbh.getReadableDatabase();

        //execute query
        Cursor cursor = builder.query(db, projection, selection, selectionArgs, null, null, sortOrder);

        //set notifications for this URI
        cursor.setNotificationUri(getContext().getContentResolver(), uri);

        return cursor;
    }

    @Override
    public int delete(Uri uri, String selection, String[] selectionArgs) {
        int uriId = matcher.match(uri);

        int deleted=0;

        SQLiteDatabase db = dbh.getWritableDatabase();
        switch(uriId) {
        case BLOG_LIST:
            deleted = db.delete(BlogTable.TABLE_NAME, selection, selectionArgs);
            break;
        case BLOG_ITEM:
            if(TextUtils.isEmpty(selection)) {
                deleted = db.delete(BlogTable.TABLE_NAME, BlogTable.ID + "=" + uri.getLastPathSegment(), selectionArgs);
            }
            else {
                deleted = db.delete(BlogTable.TABLE_NAME, selection + " and " + BlogTable.ID + "=" + uri.getLastPathSegment(), selectionArgs);
            }
            break;
        default:
            throw new IllegalArgumentException("Unknow uri: " + uri);
        }
        getContext().getContentResolver().notifyChange(uri, null);
        return deleted;
    }

    @Override
    public Uri insert(Uri uri, ContentValues values) {
        int uriId = matcher.match(uri);

        //Variable for ID of new record
        long newId;

        switch(uriId) {
        case BLOG_LIST:
            //get instance of Database
            SQLiteDatabase db = dbh.getWritableDatabase();

            //execute query
            newId = db.replace(BlogTable.TABLE_NAME, null, values);
            //newId = db.insertWithOnConflict(BlogTable.TABLE_NAME, null, values, SQLiteDatabase.CONFLICT_IGNORE);

            //create URI for new added record
            Uri newuri = Uri.parse(CONTENT_URI + "/" + newId);

            //notify change for list URI
            getContext().getContentResolver().notifyChange(uri, null);

            return newuri;

        default:
            throw new IllegalArgumentException("Unknown uri: " + uri);
        }

    }

    @Override
    public int update(Uri uri, ContentValues values, String selection,
            String[] selectionArgs) {

        int uriId = matcher.match(uri);

        int updated=0;

        SQLiteDatabase db = dbh.getWritableDatabase();

        switch(uriId) {
        case BLOG_LIST:
            updated = db.update(BlogTable.TABLE_NAME, values, selection, selectionArgs);
            break;
        case BLOG_ITEM:
            if(TextUtils.isEmpty(selection)) {
                updated = db.update(BlogTable.TABLE_NAME, values, BlogTable.ID + "=" + uri.getLastPathSegment(), null);
            }
            else {
                updated = db.update(BlogTable.TABLE_NAME, values, selection + " and " + BlogTable.ID + "=" + uri.getLastPathSegment(), selectionArgs);
            }
            break;
        default:
            throw new IllegalArgumentException("Unknown URI: " + uri);
        }
        getContext().getContentResolver().notifyChange(uri, null);
        return updated;
    }

} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-06T09:01:35.313

利用

```
adapter.notifyDataSetChanged(); 
```

`adapter`你`SimpleCursorAdapter`的列表视图在哪里

编辑：

在此之前，您应该将数据添加到您的适配器。为此，请为您的适配器添加一个从数据库查询的方法。

# c# - MVC 3 Razor - 如何处理成功/错误消息

> ID：13247571
> 
> 赞同：1
> 
> 时间：2012-11-06T08:58:31.623
> 
> 标签：c#, asp.net-mvc-3, error-handling

我正在将 MVC3 用于一个新项目，并且我能够将模型中的值传递到我的 DAL 并成功地将数据提交到数据库。作为 MVC 的新手，我不确定如何处理成功和错误消息。

我想做的是在提交表单后给用户一些反馈，我不知道我是否打算为此创建一个新控制器或重用我当前的控制器，但在视图中编写一些逻辑来隐藏表单和显示消息。

**ActionResult CreateUser 是表单，ActionResult CreateUser 与 httppost 处理表单提交**

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Web;
using System.Web.Mvc;
using UserManager.Models;

namespace UserManager.Controllers
{
    public class UserManagerController : Controller
    {
        //
        // GET: /UserManager/

        public ActionResult Index()
        {
            try
            {
                var data = new UserManager.Models.UserManagerTestEntities();
                return View(data.vw_UserManager_Model_Add_Users.ToList());

            }
            catch (Exception ex)
            {
                return View(ViewBag);
            }

        }

        public ActionResult LookUpGroupName(string q, int limit)
        {
            //TODO: Map list to autocomplete textbox control
            DAL d = new DAL();
            List<string> groups = d.groups();

            var GroupValue = groups
                .Where(x => x.Contains(q))
                .OrderBy(x => x)
                .Take(limit)
                .Select(r => new { group = r });

            // Return the result set as JSON
            return Json(GroupValue, JsonRequestBehavior.AllowGet);
        }

        public ActionResult CreateUser()
        {
            //var data = new UserManager.Models.UserManagerTestEntities();
            ViewBag.Message = "Create New User";
            return View();
        }

        [HttpPost]
        public ActionResult CreateUser(vw_UserManager_Model_Add_Users newUser)
        {
            try
            {
                if (ModelState.IsValid)
                {
                    //var data = new UserManager.Models.UserManagerTestEntities();
                    // Pass model to Data Layer
                    List<string> outcome =  UserManager.DAL.CreateUser(newUser);
                    //data.SaveChanges();
                }
                return View();
            }

            catch (Exception ex)
            {
                return View(ex.ToString());
            }

        }
    }
} 
```

**我的 DAL**

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Web;
using System.Data.SqlClient;
using System.Data;
using System.Configuration;
using UserManager.Models;
using System.Security.Cryptography;
using System.Web.Security;

namespace UserManager
{
    public class DAL
    {
        #region hashingpassword
        private static string CreateSalt(int size)
        {
            // Generate a cryptographic random number.
            RNGCryptoServiceProvider rng = new RNGCryptoServiceProvider();
            byte[] buff = new byte[size];
            rng.GetBytes(buff);

            // Return a Base64 string representation of the random number.
            return Convert.ToBase64String(buff);
        }

        private static string CreatePasswordHash(string pwd, string salt)
        {
            string saltAndPwd = string.Concat(pwd, salt);
            string hashedPwd =
                FormsAuthentication.HashPasswordForStoringInConfigFile(
                saltAndPwd, "sha1");
            return hashedPwd;
        }

        #endregion

        private static SqlConnection BradOnline()
        {
            UserManagerTestEntities DBContext = new UserManagerTestEntities();
            string connectionstring = DBContext.Database.Connection.ConnectionString;
            SqlConnection conn = new SqlConnection(connectionstring);
            return conn;
        }

        public List<string> groups()
        {
            List<string> groups = new List<string>();
            using (SqlConnection conn = BOnline())
            {
                using (var command = new SqlCommand("Select name from aspnet_Custom_Groups", conn))
                {
                    try
                    {
                        conn.Open();
                        command.CommandType = CommandType.Text;
                        SqlDataAdapter adapter = new SqlDataAdapter(command);
                        DataSet dataset = new DataSet();
                        adapter.Fill(dataset);
                        foreach (DataRow dr in dataset.Tables[0].Rows)
                        {
                            groups.Add(dr["name"].ToString());
                        }

                    }
                    catch (SqlException ex)
                    {
                        ex.ToString();
                    }
                    return groups;
                }
            }
        }

        public static List<string> CreateUser(Models.vw_UserManager_Model_Add_Users newUser)
        {
            List<string> outcome = new List<string>();
            try
            {
                using (SqlConnection conn = BOnline())
                {
                    conn.Open();
                    UserManager.Models.vw_UserManager_Model_Add_Users model = new Models.vw_UserManager_Model_Add_Users();
                    using (var command = new SqlCommand("sp_UserManager_Add", conn))
                    {
                        command.CommandType = CommandType.StoredProcedure;
                        command.Parameters.Add("@salutation", SqlDbType.NVarChar).SqlValue = newUser.salutation;
                        command.Parameters.Add("@username", SqlDbType.NVarChar).SqlValue = newUser.email;
                        command.Parameters.Add("@firstname", SqlDbType.NVarChar).SqlValue = newUser.firstname;
                        command.Parameters.Add("@lastname", SqlDbType.NVarChar).SqlValue = newUser.lastname;
                        command.Parameters.Add("@password", SqlDbType.NVarChar).SqlValue = newUser.password;

                        string salt = CreateSalt(20);
                        string passwordSalt = CreatePasswordHash(newUser.password, salt);

                        command.Parameters.Add("@passwordsalt", SqlDbType.NVarChar).SqlValue = passwordSalt;
                        command.Parameters.Add("@passwordquestion", SqlDbType.NVarChar).SqlValue = "test";
                        command.Parameters.Add("@passwordanswer", SqlDbType.NVarChar).SqlValue = "test";
                        command.Parameters.Add("@email", SqlDbType.NVarChar).SqlValue = newUser.email;
                        command.Parameters.Add("@CurrentTimeUtc", SqlDbType.DateTime).SqlValue = DateTime.UtcNow;

                        switch (newUser.isactive)
                        {
                            case true:
                                command.Parameters.Add("@isapproved", SqlDbType.TinyInt).SqlValue = 1;
                                break;
                            case false:
                                command.Parameters.Add("@isapproved", SqlDbType.TinyInt).SqlValue = 0;
                                break;
                        }

                        switch (newUser.alfConnect)
                        {
                            case true:
                                command.Parameters.Add("@Connect", SqlDbType.TinyInt).SqlValue = 1;
                                break;
                            case false:
                                command.Parameters.Add("@Connect", SqlDbType.TinyInt).SqlValue = 0;
                                break;
                        }

                        switch (newUser.alfIntelligence)
                        {
                            case true:
                                command.Parameters.Add("@Intelligence", SqlDbType.TinyInt).SqlValue = 1;
                                break;
                            case false:
                                command.Parameters.Add("@Intelligence", SqlDbType.TinyInt).SqlValue = 0;
                                break;
                        }

                        switch (newUser.brad)
                        {
                            case true:
                                command.Parameters.Add("@rad", SqlDbType.TinyInt).SqlValue = 1;
                                break;
                            case false:
                                command.Parameters.Add("@rad", SqlDbType.TinyInt).SqlValue = 0;
                                break;
                        }

                        command.Parameters.Add("@ApplicationName", SqlDbType.NVarChar).SqlValue = "bradlink";
                        command.Parameters.Add("@Group", SqlDbType.NVarChar).SqlValue = newUser.group_name;
                        int rowsCreated = command.ExecuteNonQuery();

                        if (rowsCreated > 0)
                        {
                            outcome.Add("New user created successfully.");
                            foreach (SqlParameter p in command.Parameters)
                            {
                                outcome.Add(p.Value.ToString());
                            }
                        }

                    }
                }
            }
            catch (Exception ex)
            {
                List<string> error = new List<string>();
                error.Add("Error creating new user. Check error message for more details.");
                error.Add(ex.Message);
            }
            return outcome;
        }
    }
} 
```

**我对表单提交的看法**

```
<!-- Declare model to be used for view -->
@model UserManager.Models.vw_UserManager_Model_Add_Users 
@{
    ViewBag.Title = "Create New User";
}
<h2>
    CreateUser</h2>
@using (Html.BeginForm())
{
    @Html.ValidationSummary(true)
    <fieldset>
        <legend>New User Details</legend>
        <div class="editor-label">
            @Html.LabelFor(Model => Model.salutation)
        </div>
        <div class="editor-field">
            @Html.EditorFor(model => Model.salutation)
            @Html.ValidationMessageFor(model => Model.salutation)
        </div>
        <div class="editor-label">
            @Html.LabelFor(Model => Model.firstname)
        </div>
        <div class="editor-field">
            @Html.EditorFor(model => Model.firstname)
            @Html.ValidationMessageFor(model => Model.firstname)
        </div>
        <div class="editor-label">
            @Html.LabelFor(Model => Model.lastname)
        </div>
        <div class="editor-field">
            @Html.EditorFor(model => Model.lastname)
            @Html.ValidationMessageFor(model => Model.lastname)
        </div>
        <div class="editor-label">
            @Html.LabelFor(Model => Model.password)
        </div>
        <div class="editor-field">
            @Html.EditorFor(model => Model.password)
            @Html.ValidationMessageFor(model => Model.password)
        </div>
        <div class="editor-label">
            @Html.LabelFor(Model => Model.email)
        </div>
        <div class="editor-field">
            @Html.EditorFor(model => Model.email)
            @Html.ValidationMessageFor(model => Model.email)
        </div>
        <div class="editor-label">
            @Html.LabelFor(Model => Model.isactive)
        </div>
        <div class="editor-field">
            @Html.EditorFor(model => Model.isactive)
            @Html.ValidationMessageFor(model => Model.isactive)
        </div>
        <div class="editor-label">
            @Html.Label("Group Name")
            <!-- GroupName -->
        </div>
        <div class="editor-field">
            @Html.EditorFor(model => Model.group_name, new { ID = "group_name" })
            @Html.ValidationMessageFor(model => Model.group_name)
        </div>
        <div class="editor-label">
            @Html.Label("Subscription Options")
            <!-- GroupName -->
        </div>
        <div class="editor-field">
            @Html.Label("Connect")
            @Html.CheckBoxFor(Model => Model.Connect)
            @Html.Label("ALF Intelligence")
            @Html.CheckBoxFor(Model => Model.Intelligence)
            @Html.Label("BRAD")
            @Html.CheckBoxFor(Model => Model.rad)
        </div>
        <p>
            <input type="submit" value="Create" onclick="return submitWith();"/>
            <span id="validationMessage"></span>
        </p>
    </fieldset>

    <div>
        @Html.ActionLink("Back to List", "Index")
    </div>
}

<script type="text/javascript">
// Count checkboxes that are checked.
    function submitWith() {
        var checkedCount = $("input:checked").length; 
        var valid = checkedCount > 0;
        if (!valid) {
            $('#validationMessage').html('You must select at least one option');
        }
        return valid;
    }
</script>

<script type="text/javascript">
    $(document).ready(function () {
        $("#group_name").autocomplete('@Url.Action("LookUpGroupName")', // Call LookUpGroupName ActionResult in UserManager Controller
        {
        dataType: 'json',
        parse: function (data) {
            var rows = new Array();
            for (var i = 0; i < data.length; i++) {
                rows[i] = {
                    data: data[i],
                    value: data[i].group,
                    result: data[i].group
                }
            }
            return rows;
        },
        formatItem: function (row, i, max) {
            return row.group;
        },
        width: 300,
        highlight: false,
        multiple: false
    }); // End of autocomplete
});
</script> 
```

处理这个有什么建议吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-06T09:32:03.760

```
 [HttpPost]
    public ActionResult CreateUser(vw_UserManager_Model_Add_Users newUser)
    {
        try
        {
            if (ModelState.IsValid)
            {
                //var data = new UserManager.Models.UserManagerTestEntities();
                // Pass model to Data Layer
                List<string> outcome =  UserManager.DAL.CreateUser(newUser);
                //data.SaveChanges();
            }
            return View();
        }

        catch (Exception ex)
        {
            return RedirectToAction("showError", ex.Message);
        }

    }

public ActionResult showError(String sErrorMessage)
{
    //All we want to do is redirect to the class selection page
    ViewBag.sErrMssg = sErrorMessage;
    return PartialView("ErrorMessageView");
} 
```

我会按照这些思路做一些事情。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-06T10:41:37.490

您可以使用 TempData 来显示消息。
例如，在您的控制器操作中，您可以设置 TempData Like

TempData["SuccessMsg"] ="记录保存成功。

然后返回您要返回的视图并在该视图中使用 TempData["SuccessMsg"]。

```
e.g.
@model UserManager.Models.vw_UserManager_Model_Add_Users 
@{
    ViewBag.Title = "Create New User";
}
<h2>
    CreateUser</h2>
@using (Html.BeginForm())
{
@Html.ValidationSummary(true)
if(TempData["SuccessMsg"]!=null)
{
<div>TempData["SuccessMsg"].ToString()</div>
}    
} 
```

# javascript - kendo-ui图表的类别标签中的换行符

> ID：13247577
> 
> 赞同：11
> 
> 时间：2012-11-06T08:58:50.217
> 
> 标签：javascript, asp.net-mvc, kendo-ui, kendo-chart

我有一个图表，其中标签包含两个部分，一个名称和一个数字。我希望数字出现在名称下方，由`<br/>`标签说明：

![越线](../Images/954dba8e3e03d85204e9aefdc8b12794.png)

我加载图表的内容，并在我的控制器中设置标签： ![标签](../Images/6d901680b06f1932529a8cd74b364f99.png)

当我尝试在标签上使用模板时，换行后的文本与图表的其余文本一起出现在图表底部：

![在此处输入图像描述](../Images/185d0c8f282cbdb5e089862fc8f6d042.png)

javascript代码：

```
$("#chart1").kendoChart({
        theme: "BlueOpal",
        title: { text: "My reported hours" },
        legend: { position: "bottom" },
        seriesDefaults: { type: "column" },
        dataSource: {
            transport: {
                read: {
                    url: dataUrl,
                    dataType: "json"
                }
            }
        },
        series: [{ field: "SeriesField" }],
        categoryAxis: {
            field: "CategoryAxis",
            labels: {
                rotation: 0,
                template: "#=value#<br/>newline"
            },

        },
        valueAxis: {
            labels: { format: "{0}h" },
            min: 0
        },
        tooltip: {
            visible: true,
            template: "#= formatDecimal(value) #<br/> newline"
        },
        seriesClick: onSeriesClick
    }); 
```

我如何使换行符起作用？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-01-03T17:23:38.990

**请参阅最后的更新，这现在是可能的......离开下面，因为我认为它仍然相关。**

如果您不需要标签的位置为“动态”（即有多个标签需要具有特定位置），则可以使用另一种方法。

您可以使用该`<tspan>`元素。

由于 Kendo 呈现的是老式 SVG 而不是 HTML5 Canvas，因此 html 标签不起作用。您必须使用 SVG 标签。这些都不是很好，因为 SVG 1.1 规范不容易允许文本换行。SVG 中文本换行的建议是 tspan。

例如

```
<tspan x="30" dy="0" text-anchor="middle">Test</tspan>
<tspan x="30" dy="1.5em"text-anchor="middle">Other 7</tspan> 
```

如果您将上述内容设置为您的标签，它会让您更接近，但在 Kendo 升级到 HTML5 技术（如 Canvas（极不可能））或 SVG 1.2 出现（2014 年 8 月）`<tbreak/>`之前，这是我们拥有的最好的。

还有另一个问题是图表的呈现似乎没有考虑文本的图形表示，因此您可能会得到一些不需要的剪辑。

**更新（2014 年 17 月 1 日）**

根据这个 UserVoice [http://kendoui-feedback.telerik.com/forums/127393-telerik-kendo-ui-feedback/suggestions/3434807-chart-multi-line-labels](http://kendoui-feedback.telerik.com/forums/127393-telerik-kendo-ui-feedback/suggestions/3434807-chart-multi-line-labels)

他们计划在 2014 年第一季度实现该功能，一旦它普遍可用，我将更新答案。

**更新（2014 年 4 月 27 日）** 他们说现在计划在第一季度之后进行……谁知道现在什么时候……哦，好吧……

**更新 (09/01/2015)** 确认它在带有“\n”的 Kendo UI v2014.3.1119 中工作。请参阅文档：[http ://docs.telerik.com/kendo-ui/api/javascript/dataviz/ui/chart#configuration-categoryAxis.title.text](http://docs.telerik.com/kendo-ui/api/javascript/dataviz/ui/chart#configuration-categoryAxis.title.text)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2014-10-02T13:11:07.560

最终由 Telerik 实现

请参阅[http://docs.telerik.com/kendo-ui/api/javascript/dataviz/ui/chart#configuration-categoryAxis.title.text](http://docs.telerik.com/kendo-ui/api/javascript/dataviz/ui/chart#configuration-categoryAxis.title.text)

可以使用换行符（“\n”）将文本分成多行。

发生在文本、标题、标签、注释上！

# asp.net - 在 IIS 5.1 和 6 中发布我的 asp.net Web 应用程序后无法登录

> ID：13247579
> 
> 赞同：-1
> 
> 时间：2012-11-06T08:58:52.570
> 
> 标签：asp.net, iis

我已经发布了我的网站并尝试在我的本地系统中托管。我正在获取登录页面但无法登录到我的应用程序。当我单击登录页面中的提交按钮时，页面只是刷新并返回。页面没有显示任何内容像`'invalid username or password'`我为不正确登录设置的错误

我正在使用`visualstudio 2008`和`iis 5.1`。这个错误可能是什么原因？

现在我安装了iis6，但仍然有同样的问题............

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-06T09:13:10.740

如果您使用内置的 asp.net 成员资格和角色，则必须为已发布的网站设置新用户和角色，因为当前数据库中的用户和角色仅对开发应用程序有效；他们将有不同的 applicationId。你通常会这样做是 IIS 但我从未使用过 5.1 所以不知道如何在那里。

# jquery - jQuery 用字符串值替换 attr href

> ID：13247581
> 
> 赞同：3
> 
> 时间：2012-11-06T08:59:02.203
> 
> 标签：jquery, html, string, href, attr

我尝试用一​​些 DIV 的 ID 替换一些 href 属性。

我有一个包含（例如）三个链接且没有 href 值的列表，例如：

```
<ul id="Downloads">
    <li><a href="">Some content 1</a></li>
    <li><a href="">Some content 2</a></li>
    <li><a href="">Some content 3</a></li>
</ul> 
```

我在同一页面上还有一些 DIV，它们在容器中具有唯一 ID：

```
<div id="DownloadsContent">
    <div id="221">Some content</div>
    <div id="325">Some content</div>
    <div id="124">Some content</div>
</div> 
```

我想获取三个 DIV 的 ID，并将它们设置为三个链接的 href 属性，例如：

```
<li><a href="#221">Some content 1</a></li>
<li><a href="#325">Some content 2</a></li>
<li><a href="#124">Some content 3</a></li> 
```

我尝试使用 .map 和 .each 函数，但在我当前的尝试中，我得到了类似`<a href="221,325,124"></a>`的链接——因此 href 属性被整个字符串替换。

这是我的方法：

```
var id = $('#DownloadsContent > div').map(function() { return this.id }).get();

$.each(id,function() {
    $("#Downloads li a").attr('href', id);
}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-06T09:04:34.443

你可以使用`attr`方法。

```
var $divs = $('#DownloadsContent > div');

$('#Downloads a').attr('href', function(i, c){
   return '#' + $divs.eq(i).attr('id')
}) 
```

[http://jsfiddle.net/AG2LQ/](http://jsfiddle.net/AG2LQ/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-06T09:01:58.657

您需要使用 THIS 进行迭代，并每次选择不同的（在本例中为 i）：

```
$.each(id,function(i) {
   $("#Downloads li a").eq(i).attr('href', this);
}); 
```

**（编辑感谢评论）**

# visual-studio - VS2005 和 Windows SDK 7.1

> ID：13247583
> 
> 赞同：1
> 
> 时间：2012-11-06T08:59:13.670
> 
> 标签：visual-studio, visual-c++, platform-sdk

运行 Platform SDK 7.1 附带的 WindowsSdkVer.exe 不起作用。VS 2005 中的 .BAT 文件都没有更新。

谁能告诉我如何纠正这个问题？另外，如何验证 VS2005 使用的是 Platform SDK 7.1？

MSDN 中有几篇关于此的文章，但没有一篇是针对上述配置的。此外，他们都没有描述验证这一点的具体方式/确定方式

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-06T10:34:01.353

您可以尝试在下面手动设置 VS 环境的 include 和 lib 路径

> 工具->选项->VC++ 目录

或类似的东西（已经有一段时间了）。

为了验证，您可以将`[/showIncludes](http://msdn.microsoft.com/en-us/library/hdkef6tk%28v=vs.80%29.aspx)`参数添加到项目的附加编译器选项中，并`[/verbose:lib](http://msdn.microsoft.com/en-us/library/wdsk6as6%28v=vs.80%29.aspx)`添加到附加链接器选项中，以仔细检查编译/链接项目时是否使用了正确的头文件/库。

IIRC 在 SDK 的一个较新版本（可能是版本 7）和使用 VS2005 之间存在某种不兼容，但我不记得那是什么。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2016-07-07T01:52:59.233

您可以使用以下方法将 Windows SDK 7.1 与 Visual Studio 2005 结合使用。

[使用 Windows SDK 为 Visual C++ 开发配置 Visual Studio](https://msdn.microsoft.com/en-us/library/ff660764(v=vs.100).aspx)

在链接中，您可以找到“在 Visual Studio 2008 中使用 Windows SDK 配置工具”的内容。

即使它有这样的标题，您也可以对 VS2005 使用相同的程序。

1.  通过依次单击开始、所有程序、Microsoft Windows SDK v7.1 和**Visual Studio 注册**来启动 Windows SDK 配置工具。
2.  右键单击**Windows SDK 配置工具**，然后单击以管理员身份运行。
3.  在 Windows SDK 配置工具的列表中，选择**v7.1**。
4.  单击**设为当前**。

# java - Eclipse：缺少项目描述文件 (.project)

> ID：13247586
> 
> 赞同：14
> 
> 时间：2012-11-06T08:59:25.080
> 
> 标签：java, eclipse, project

在我重新启动系统之前，我在 Eclipse 中的项目运行良好。在重新打开 Eclipse IDE 时，我开始收到“错误：无法找到或加载主类...”。在“修复”事情的过程中，我也删除了 .project 文件。（我真是太天真了！）现在一切似乎都搞砸了。我看不到我的文件在“包资源管理器”中列出。打开项目时出错，提示：**项目描述文件（.project）丢失**。我仍然在各自的目录中拥有所有源文件和编译的 .class 文件。

请帮帮我。感谢您的建议。

谢谢！

我遵循了其中一项建议（复制 .project 文件并修改项目名称）。这让我回到了可以在项目资源管理器中查看所有文件的阶段。但是现在从 Eclipse 运行项目时，无法在 java 文件中找到 Main 方法（**实际上**包含 main()），并且错误输出为： **Error: Main method not found in class , please define the主要方法为：public static void main(String[] args)**

我说的 main() 方法就在那里。令人困惑的是，我自 5 个月以来一直在做的一个项目，一切都运行良好，但突然变得无法使用。有人可以提供有关最新错误的任何见解。

谢谢！

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-11-06T09:02:40.577

1.  创建一个虚拟项目
2.  取.project文件并修改这部分

<名称> PROJECT_NAME </名称>

1.  把它放在你的旧项目中

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-11-06T09:02:11.083

也许您可以使用类似的内容创建另一个（将其保存为项目目录中的 .project ）：

```
<?xml version="1.0" encoding="UTF-8"?>
<projectDescription>
    <name>Project Name</name>
    <comment></comment>
    <projects>
    </projects>
    <buildSpec>
        <buildCommand>
            <name>org.eclipse.jdt.core.javabuilder</name>
            <arguments>
            </arguments>
        </buildCommand>
    </buildSpec>
    <natures>
        <nature>org.eclipse.jdt.core.javanature</nature>
    </natures>
</projectDescription> 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-11-06T09:02:27.087

尝试以下操作：

在eclipse中创建一个新项目（最好与另一个项目类型相同），当它创建时将新项目文件复制到旧项目中并手动编辑它，它不应该太难或太多编辑。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-10-04T04:44:51.527

我遇到了同样的问题，这是因为该项目来自需要身份验证的外部驱动器。
- 在文件资源管理器中输入外部驱动器的密码
- 重新启动 eclipse

# jquery - Rails 嵌套资源 - 使用 form_for 部分创建和编辑 2 个级别

> ID：13247589
> 
> 赞同：2
> 
> 时间：2012-11-06T08:59:31.290
> 
> 标签：jquery, ruby-on-rails, ruby, ajax, ruby-on-rails-3

真的在这件事上绞尽脑汁。我对 Rails 比较陌生，并且尝试做一些我确信不会太难的事情。

我有一个模型“Trip”，它有很多“天”，里面有很多“活动”

我在“Trip”的 show.html.erb 视图中，在这个视图中，我正在渲染一个表单的部分内容，该表单应该允许我创建一个新的“活动”以与“日”相关联或编辑现有的已经属于“日”的“活动”

如何在表单部分中传递给 form_for，我想为其创建新的“活动”的“天”的局部变量。并且使用相同的表单部分，我如何检索与“活动”相关联的“日”？最终这些将是 AJAX 加载的对象。在过去的几个小时里，我用谷歌搜索，找不到任何类似的例子。我真的很感激帮助。

**路线.rb**

```
 resources :trips do
    resources :days    
  end

  resources :days do
    resources :activities
  end 
```

**行程的 show.html.erb**

```
<div id="activities_list">
  <%= render :partial => "activities" %>
</div> 

<div id="activity_form">
  <%= render :partial => "/activities/form", :locals => { :activity => @activity}  %>
</div>

<div id="bottom">
<%= link_to 'Edit', edit_trip_path(@trip) %> |
<%= link_to 'Back', trips_path %>
</div> 
```

**_activities.html.erb 部分**

```
<h1><%= @trip.title %></h1>

<% @trip.days.each do |day| %>
<div id="blech_<%= day.id %>">
  <b><%= day.summary %></b>
      <% day.activities.each do |activity| %>
            <li id="activity_<%= activity.id %>"><%= link_to activity.address, edit_day_activity_path(day, activity), :remote => true  %></li>
      <% end %>
    <% end %>
  <%= link_to 'New Activity', new_day_activity_path(day), :remote => true %>
</div>
<% end %> 
```

**_form.html.erb 部分**我知道我需要使用 (@day,@activity) 变量调用 day_activity_path。但我不知道如何在这里获取@day 变量

```
 <%= form_for([@activity], :remote => true) do |f| %>
     <fieldset>
       <%= f.label :title, "Activity" %><br />
       <%= f.text_field :title, :rows => 1 %><br />
     </fieldset>

    <div class="actions">
      <%= f.submit %>
    </div>
  <% end %> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-06T14:29:36.573

好的，假设您想在一天中添加一个新活动。

不要忘记我们在这里使用的是 REST (http://old.thoughtsincomputation.com/posts/understanding-rest-in-rails-3)

我们的一天必须有很多活动，我们的活动属于一天

```
class Day < ActiveRecord::Base
  has_many :activities
end

class Activity < ActiveRecord::Base
  belongs_to :day
end 
```

我们的路线应该像

```
resources :days do
  resources :activities
end 
```

有了这条路线，我们所拥有的生成路径就像

```
days_path
day_path
new_day_path

new_day_activity_path
delete_day_activity_path
edit_day_activity_path 
```

在我们的日视图中，我们位于类似 localhost:3000/days/1 的 URL 中（DaysController，动作秀）

在这种情况下，我们可以添加 @activity = Activity.new 并部分添加以下表格

```
<%= form_for [@day, @activity] do |form_field| %>
  rest_code_goes_here
<% end %> 
```

此表单将在 ActivityController 中提交，action :create 与日期一起，控制器将检查验证并保存它。

看看链接是一个小应用程序，我用过类似的东西 [https://github.com/leftis/tefteraki/blob/master/app/views/debts/_new_dose.haml](https://github.com/leftis/tefteraki/blob/master/app/views/debts/_new_dose.haml)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-07T14:41:31.953

哦，这实际上意味着旅行有很多天，资源有更多的嵌套，比如

```
resources :trips
  resources :days
    resources :activities
  end
end 
```

因此，当您在 local/trips/1/ 中时，您实际上在 TripController 中，如果不创建一天 texhnicaly，您就无法做到这一点，您可以在一天中使用嵌套表单进行活动。

简单的方法是 ryan bates [https://github.com/ryanb/nested_form](https://github.com/ryanb/nested_form)的宝石， 但要做到这一点，您必须首先将您的关系从 habtm 更改为

```
class Day
  has_many :activities
end

class Activity
  belongs_to :day
end 
```

然后您将在您的旅行显示视图中添加一个日期表格

```
<% nested_form_for [:trip, Day.new], :remote => true do |form| %>

  <%= form.text_field :date %>

  <%= form.fields_for :activities do |activity_form| %>
    <%= activity_form.text_field :name %>
    <%= activity_form.link_to_remove "Remove this activity" %>
  <% end %>
  <p><%= form.link_to_add "Add an activity", :tasks %></p>

<% end %> 
```

该表单现在向 DaysController.create 发出请求，其中包含旅行和活动的参数，并要求以 ajaxly 方式提供服务

检查 gem 和我的应用程序，我正在使用所有这些，希望对您有所帮助！！！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-10T21:49:31.423

这就是我最终做的事情并且它有效。

在我的“Trip”的 show.html.erb 中。

**显示.html.erb**

```
<div id="activity_form">
<h2>Activities</h2>
</div> 
```

链接到“编辑”一个活动。注意 :remote => true 告诉 Rails 控制器这将是一个 AJAX 请求，以便呈现 edit.js.erb

```
<%= link_to activity.location[0, 20], edit_day_activity_path(day, activity), :class=>"btn btn-info fixedwidthbtn", method: :get, :remote => true 
```

**_form.html.erb**此表单部分位于活动视图目录 (../views/activities/_form.html.erb) 下。

```
<%= form_for([@day, @activity], :remote => true) do |f| %>
<fieldset>
  <%= f.label :title, "Activity" %>
  <%= f.text_field :title, :rows => 1 %> 
</fieldset>
  <div class="actions">
    <%= f.submit %>
  </div>
</form>
   <%= link_to 'Delete', [@day, @activity], method: :delete, data: { confirm: 'Are you sure?' } %>
<% end %> 
```

**edit.js.erb**这是活动视图目录 (../views/activities/edit.js.erb) 下的一个文件。说要抓取 ID 为“activity_form”的 DOM 元素并渲染部分“表单”

```
$("#activity_form").html("<%= escape_javascript(render(:partial => "form"))%>"); 
```

**update.js.erb**在编辑表单上点击更新以呈现活动列表的更新部分后，我包含了这个 javascript。这样我就不必重新加载页面来查看更新。

```
$("#activities_list").html("<%= escape_javascript( render(:partial => "/trips/activities") ) %>"); 
```

**routes.rb**这就是我嵌套路由的方式。仅按照最佳实践进行 1 级。

资源：旅行做资源：天结束

资源：天做资源：活动结束

# excel - Excel 查找最后两个下划线之间的文本

> ID：13247592
> 
> 赞同：2
> 
> 时间：2012-11-06T08:59:43.460
> 
> 标签：excel, excel-formula

我需要一个 excel 公式来查找 excel 单元格中最后两个下划线之间的文本：

IE

> `AAA_BBB_CCC_DDDD_E => DDDD
> AAA_BBB_CCC_DDD_EEE_E => EEE
> AAA_BBB_CCC_DDD_EEE_F_ => F
> AAA_BBB_CCC_DDD_EE_GGGGGGGGGG => EE
> AAA_BBB_CCC_DDD_EEE_FFF_GGGGGGGGGGGG_H => GGGGGGGGGGGG`

我得到的公式是基于最后一个索引： [EXCEL LAST INDEX OF](http://geekswithblogs.net/prash/archive/2011/11/02/excel-last-index-of.aspx)

> `=RIGHT(LEFT(A2,SEARCH("@",SUBSTITUTE(A2,"_","@",LEN(A2)-LEN(SUBSTITUTE(A2,"_",""))))-1),LEN(LEFT(A2,SEARCH("@",SUBSTITUTE(A2,"_","@",LEN(A2)-LEN(SUBSTITUTE(A2,"_",""))))-1))-SEARCH("@",SUBSTITUTE(LEFT(A2,SEARCH("@",SUBSTITUTE(A2,"_","@",LEN(A2)-LEN(SUBSTITUTE(A2,"_",""))))-1),"_","@",LEN(LEFT(A2,SEARCH("@",SUBSTITUTE(A2,"_","@",LEN(A2)-LEN(SUBSTITUTE(A2,"_",""))))-1))-LEN(SUBSTITUTE(LEFT(A2,SEARCH("@",SUBSTITUTE(A2,"_","@",LEN(A2)-LEN(SUBSTITUTE(A2,"_",""))))-1),"_","")))))`

我需要让这不那么复杂，有什么想法吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-11-06T10:26:43.313

尝试这个

```
=TRIM(LEFT(RIGHT(SUBSTITUTE(H3,"_",REPT(" ",100)),200),100)) 
```

请注意，如果任何段可能超过 50 个字符，请相应增加 100 和 200 个数字

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-06T14:22:23.703

Here's another variation.....

`=MID(A1,FIND("^",SUBSTITUTE(A1,"_","^",LEN(A1)-LEN(SUBSTITUTE(A1,"_",""))-1))+1,SUM(FIND("^",SUBSTITUTE(A1,"_","^",LEN(A1)-LEN(SUBSTITUTE(A1,"_",""))-{0,1}))*{1,-1})-1)`

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-11-06T10:44:22.693

克里斯的解决方案非常简洁 - 但是，我也想出了一个替代方案。

```
=MID(A1,1+SEARCH("@", 
     SUBSTITUDE(A1,"_","@",LEN(A1)-1-LEN(SUBSTITUDE(A1,"_","")))),
     SEARCH("@",SUBSTITUDE(A1,"_","@",LEN(A1)-LEN(SUBSTITUDE(A1,"_",""))))-1-
     SEARCH("@",SUBSTITUDE(A1,"_","@",LEN(A1)-1-LEN(SUBSTITUDE(A1,"_",""))))) 
```

# facebook - 在灯中设置虚拟主机

> ID：13247595
> 
> 赞同：2
> 
> 时间：2012-11-06T08:59:51.587
> 
> 标签：facebook, heroku, lamp, virtualhost

我想在本地开发 facebook 应用程序并尝试按照说明进行操作

[https://devcenter.heroku.com/articles/facebook#working-locally](https://devcenter.heroku.com/articles/facebook#working-locally)

我在 Linux Mint 13 上安装了 lamp 并创建了 /etc/apache2/conf/extra/httpd-vhosts.conf，如下所示。

```
名称虚拟主机 *:80

虚拟主机 *:80>
     DocumentRoot "/home/ashish"
     服务器名称本地主机
 /虚拟主机>

虚拟主机 *:80>
    DocumentRoot /home/ashish/savefromiad/blooming-stream-1211/
    服务器名称 mycoolapp-dev.localhost
    SetEnv FACEBOOK_APP_ID 461561000551920
    SetEnv FACEBOOK_SECRET 00000000000000000000000
/虚拟主机>

```

在我的浏览器中 localhost 运行良好，但尝试在浏览器中访问 mycoolapp-dev.localhost 失败。

“糟糕！谷歌浏览器找不到 mycoolapp-dev.localhost”

有任何想法吗？

当我重新启动 apache 时，我也会收到此错误

NameVirtualHost *:80 没有 VirtualHosts

PS：在所有“VirtualHost”之前有一个“小于”的标志。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-06T09:17:50.610

您还必须编辑 `/etc/hosts`文件。

添加类似的东西

```
127.0.0.1 mycoolapp-dev.localhost 
```

另外，请仔细检查您的`/etc/apache2/conf/extra/httpd-vhosts.conf`我认为您不需要两个 DocumentRoot 和 ServerName 用于一个虚拟主机（正如您在问题中粘贴的那样）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-06T11:37:09.573

我懂了。

我需要在 /etc/hosts 中有一个单独的条目，如下所示。

```
127.0.0.1 本地主机
127.0.0.1 mycoolapp-dev.localhost

```

感谢 icrew 指向 /etc/hosts。

我还在“/etc/apache2/ports.conf”中注释掉了“NameVirtualHost *:80”，因为它已经在“/etc/apache2/conf/extra/httpd-vhosts.conf”中了。

# php - Opencart-检查用户是否在类别页面上

> ID：13247606
> 
> 赞同：0
> 
> 时间：2012-11-06T09:00:31.057
> 
> 标签：php, opencart

我有一个要求，只有当用户在类别页面上时，才必须显示产品搜索和登录/注册链接。该块不应在静态页脚页面上显示为联系我们或其他静态页脚链接。

奇怪的是，客户可能对这件事有非常具体的要求。

在社区的帮助下，我尽可能地靠自己工作。但到目前为止，我已经能够完全启用或禁用该块。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-06T10:44:28.503

一种解决方案可能是：

编辑模板文件`catalog/view/template/your_theme/product/category.tpl`并将搜索输入和登录/注册链接直接添加到该模板（某处），同时使用 CSS 正确定位以满足您的需求。

然后编辑控制器文件并在此处复制登录/注册链接`catalog/controller/product/category.php`的代码片段。`catalog/controller/common/header.php`

当然`catalog/view/template/your_theme/common/header.tpl`，从这里编辑和删除搜索输入和登录/注册链接。

这应该够了……

另一种解决方案：

*   复制`catalog/view/template/your_theme/common/header.tpl`到`catalog/view/template/your_theme/common/header_category.tpl`
*   复制`catalog/controller/common/header.php`到`catalog/controller/common/header_category.php`
*   编辑`catalog/view/template/your_theme/common/header.tpl`并删除搜索输入和注册/登录链接...
*   编辑`catalog/controller/product/category.php`并找到片段代码，例如`$this->data['children'] = array(...);`->这里替换`header`为`header_category`

从来没有这样做过，但它可能会工作......

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-07T08:17:11.537

最后我发现这篇文章正是我想要的……

[http://craigmurray.me.uk/opencart-mods/how-to-highlight-the-current-category-in-the-header-in-opencart/](http://craigmurray.me.uk/opencart-mods/how-to-highlight-the-current-category-in-the-header-in-opencart/)

我做了

```
if (isset($this->request->get['path'])) {

<<DISPLAY SECTION>>

} 
```

但不确定如果链接是 SEO 友好的，这是否可行。现在这正在工作。

# android - 如何使用android连接到sql server express

> ID：13247618
> 
> 赞同：1
> 
> 时间：2012-11-06T09:01:18.947
> 
> 标签：android

首先，我不想让你知道我真的很努力地寻找我的问题，但我什么也没找到……我无法使用 android 应用程序连接到express`sql server`实例，但是我尝试连接. 我不要忘记在文件中添加这一行：`jdbc:jtds:sqlserver``sourceforge``manifest`

```
<uses-permission android:name="android.permission.INTERNET" /> 
```

并且错误消息是无法从中获取信息`sql server :HostName`

这里我的源代码可能有问题：

```
public class MainActivitySF extends Activity {
    private Connection connection;
    private Statement statement;
    private ResultSet resultat;
    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_main);
    }

    @Override
    public boolean onCreateOptionsMenu(Menu menu) {
        getMenuInflater().inflate(R.menu.activity_main, menu);
        return true;
    }

    public void OnClick(View v) {
        TextView tv = (TextView) findViewById(R.id.textView1);
        EditText ehost = (EditText) findViewById(R.id.ehost);
        EditText eport = (EditText) findViewById(R.id.eport);
        EditText ebase = (EditText) findViewById(R.id.ebase);
        EditText euser = (EditText) findViewById(R.id.euser);
        EditText epasswd = (EditText) findViewById(R.id.epasswd);
        switch (v.getId()) {
        case  R.id.Connection:
            try {
                Class.forName("net.sourceforge.jtds.jdbc.Driver").newInstance();
            } catch (InstantiationException e){
                Toast.makeText(this, "Instantiation failled",
                        Toast.LENGTH_LONG).show();
                return;
            } catch (ClassNotFoundException e1) {
                Toast.makeText(this, "Instantiation failled",
                        Toast.LENGTH_LONG).show();
                return;
            } catch(IllegalAccessException e2){
                Toast.makeText(this, "Instantiation failled",
                        Toast.LENGTH_LONG).show();
                return;
            }
            try {
                String connString = "jdbc:jtds:sqlserver://"+ehost.getText().toString()+"" +
                                    ":"+eport.getText().toString()+"/"+ebase.getText().toString()+"" +
                                    ";encrypt=false;user="+euser.getText().toString()+";" +
                                    "password="+epasswd.getText().toString()+";instance=SQLEXPRESS;";
                String username = euser.getText().toString();
                String password = epasswd.getText().toString();
                connection = DriverManager.getConnection(connString,username,password);

            } catch (SQLException e) {
                connection = null;
                Toast.makeText(this, "connection failled",
                        Toast.LENGTH_LONG).show();
                tv.setText(e.getLocalizedMessage());
                return;
            }
            tv.setText("connection OK !!");
            break;

        case  R.id.statement:
            try {
                statement = connection.createStatement();
            } catch (SQLException e) {
                statement=null;
                Toast.makeText(this, "statement failled",
                        Toast.LENGTH_LONG).show();
                return;
            }
            tv.setText("statement OK !!");
            break;

        case  R.id.req:
            try {
                resultat = statement.executeQuery(
                        "SELECT * FROM produits");
                tv.setText(resultat.getString("LIB_PRODUIT")+ " OK !!");
            } catch (SQLException e) {
                Toast.makeText(this, "req failled",
                        Toast.LENGTH_LONG).show();
                return;
            }
            break;
        default:
            break;
        }
    }
} 
```

# java - 我正在尝试以下代码，但它显示 Exception:java.lang.NoSuchFieldError

> ID：13247619
> 
> 赞同：1
> 
> 时间：2012-11-06T09:01:23.830
> 
> 标签：java, exception, cassandra

> 685 [main] INFO org.apache.cassandra.cql.jdbc.CassandraConnection - 使用 Keyspace 演示和 CQL 版本 2.0.0 连接到 localhost:9160 线程“main”java.lang.NoSuchFieldError 中连接的 ABC 异常：org.apache 的模式.cassandra.cql.jdbc.CassandraResultSet.(CassandraResultSet.java:121) 在 org.apache.cassandra.cql.jdbc.CassandraStatement.doExecute(CassandraStatement.java:167) 在 org.apache.cassandra.cql.jdbc.CassandraStatement。在 App.main(App.java:32) 处执行查询（CassandraStatement.java:227）

这是代码：

```
try 
{ 
    Class.forName("org.apache.cassandra.cql.jdbc.CassandraDriver"); 
    Connection conn = DriverManager.getConnection("jdbc:cassandra://localhost:9160/demo"); 

    if (conn != null)
    {
            System.out.println("Connected");
    }

    //String sql = "INSERT INTO employee (eid,eadd,ename,esal,sex) VALUES (2499,'bangalore','amit',10000,'male')"; 
    Statement stmt = conn.createStatement(); 

    //stmt.execute(sql);
    System.out.println("ABC");
    String sql="select *  from employee";       
    ResultSet rs=stmt.executeQuery(sql);
    //System.out.println(rs);
    //System.out.println("value inserted");
    while(rs.next()) 
         {

            System.out.println("id="+rs.getString(1));

            System.out.println();

        }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-06T09:12:53.740

**当您有 jar 冲突时，会出现**NoSuchMethod 。**即当您使用 jar 构建项目并使用不同版本的 jar 运行应用程序时。**

 **检查版本是否相同。

人们常犯的错误是，将 jars 添加到项目以在 eclipse 中构建路径，然后再次在服务器库中添加 jars。这在一段时间内容易受到 jar 冲突的影响。

给你的问题。你可以做两件事

1.  从项目构建路径和服务器路径中删除 Cassandra Jar。并在两个地方放置一个干净的同一个罐子。

2.  从构建路径和服务器路径中删除所有 jar。将所有 JARS 放在 WEB-INF/lib 文件夹中。现在您的应用程序非常便携。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-06T20:50:22.120

是的@madhairsilence 是正确的，您得到的 jar 与编译时使用的 jar 不兼容。重新启动或检查 jar 文件的版本，因为您有两个不兼容的 jar（它们没有相互编译，而是使用不同版本的 jar 编译）。**

# c# - TextBlock 中的自定义文本换行算法

> ID：13247621
> 
> 赞同：2
> 
> 时间：2012-11-06T09:01:25.740
> 
> 标签：c#, wpf, wpf-controls, textblock, word-wrap

有没有办法在**TextBlock**元素中实现自定义文本换行算法？我的意思是根据控件大小自动包装。目前我使用**TextWrapping**属性，但它没有按我预期的那样工作。例如我有这个字符串：

```
pleasant /'plez(ə)nt/ 
```

目前，此文本可以包装为：

```
pleasant /'plez
(ə)nt/ 
```

但我需要这样的东西（只在空白处换行）：

```
pleasant
/'plez(ə)nt/ 
```

据我了解，当前的实现也包含标点符号，但这会导致复杂文本（如单词转录）出现意外行为。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-06T09:14:35.660

你试过了吗

```
string s = "pleasant /'plez(ə)nt/";
string[] words = s.Split(' ');
foreach (string word in words)
{
    Console.WriteLine(word);
} 
```

输出应该是：
令人愉快
的 /'plez(ə)nt/

# c# - 禁用 Windows 窗体关闭按钮

> ID：13247629
> 
> 赞同：1
> 
> 时间：2012-11-06T09:01:39.237
> 
> 标签：c#, methods

经过数小时的谷歌搜索后，我发现了以下代码片段，它实际上只禁用了表单的关闭按钮。

```
private const int CP_NOCLOSE_BUTTON = 0x200;

protected override CreateParams CreateParams
{
     get
     {
           CreateParams myCp = base.CreateParams;
           myCp.ClassStyle = myCp.ClassStyle | CP_NOCLOSE_BUTTON;
           return myCp;
     }
} 
```

现在，我不只是以每种形式编写相同的代码段，而是试图找出一种方法将其打包成一个可能的类的静态方法，以便我可以从任何地方仅通过一行对其进行分类。

但是我遇到了一个问题，因为这个片段也是一个被覆盖的方法，因此我不知道如何将它放入另一个静态方法中。

我尝试了以下

```
using System;
using System.Windows.Forms;

namespace WindowsFormsApplication1
{
    public class Common
    {
        private const int CP_NOCLOSE_BUTTON = 0x200;

        protected override CreateParams CreateParams
        {
            get
            {
                CreateParams myCp = base.CreateParams;
                myCp.ClassStyle = myCp.ClassStyle | CP_NOCLOSE_BUTTON;
                return myCp;
            }
        }
    }
} 
```

但它会引发此错误：*'WindowsFormsApplication1.Common.CreateParams'：找不到合适的方法来覆盖*

我的问题是如何使这个片段可重用？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-06T09:03:01.560

创建一个从该类继承的基类`Form`，然后使您的所有表单都从该类继承。

```
public class BaseForm : Form
{
    private const int CP_NOCLOSE_BUTTON = 0x200;

    protected override CreateParams CreateParams
    {
        get
        {
            CreateParams myCp = base.CreateParams;
            myCp.ClassStyle = myCp.ClassStyle | CP_NOCLOSE_BUTTON;
            return myCp;
        }
    }
}

public partial class Form1 : BaseForm
{
//your form code
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-06T09:05:54.530

在 C# windows 窗体中启用/禁用/隐藏关闭按钮

你可以检查[这个](http://dotnetcodelearner.wordpress.com/2012/07/20/79/)

# mysql - postgresql 查询到 mysql

> ID：13247632
> 
> 赞同：0
> 
> 时间：2012-11-06T09:01:54.283
> 
> 标签：mysql, sql, postgresql, plpgsql

我想在 MySQL 中创建类似于以下 PostgreSQL 的查询：

```
CREATE FUNCTION check_unique_pair(IN id1 INTEGER, IN id2 INTEGER) RETURNS INTEGER AS   $body$
DECLARE retval INTEGER DEFAULT 0;
BEGIN 
 SELECT COUNT(*) INTO retval FROM (
  SELECT * FROM edges WHERE a = id1 AND b = id2
  UNION ALL
  SELECT * FROM edges WHERE a = id2 AND b = id1
)  AS pairs;
RETURN retval;
END
$body$
LANGUAGE 'plpgsql';

ALTER TABLE edges ADD CONSTRAINT unique_pair CHECK (check_unique_pair(a, b) < 1); 
```

我是 MySQL 新手。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-06T12:07:28.087

查询可以简化为：

```
SELECT COUNT(*)
FROM edges
WHERE a IN (id1, id2)
AND b in (id1, id2)
AND a <> b
   ; 
```

，它可能在 {a,b} 上使用复合索引

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-06T09:49:22.353

您似乎正在尝试实现`ASSERTION`表级`CHECK`约束或[排除约束](http://www.postgresql.org/docs/current/static/ddl-constraints.html#DDL-CONSTRAINTS-EXCLUSION)，尽管显示的实现不会可靠地工作。

MySQL 不支持`CREATE ASSERTION`；据我所知，任何其他当前的 RDBMS 也没有。通常也不支持`CHECK`对表级断言的子查询支持。

您可能需要使用触发器来模拟您想要的行为。看：

*   [MySQL 类断言约束](https://stackoverflow.com/q/8839540/398670)
*   [mysql触发器模拟断言](https://stackoverflow.com/questions/4866757)
*   [为什么 DBMS 不支持 ASSERTION](https://stackoverflow.com/questions/6368349/why-dont-dbmss-support-assertion)
*   [https://kb.askmonty.org/en/create-assertion-statement/](https://kb.askmonty.org/en/create-assertion-statement/)

@a_horse_with_no_name 在评论中指出，您可以使用复合唯一表达式索引来实现这一点。MySQL[不支持表达式索引](http://bugs.mysql.com/bug.php?id=4990)，因此如评论中所述，它在 MySQL 中不起作用。密切注意那个错误。

# asp.net - 如何在剃须刀引擎（ASP MVC）中的@var之后添加字符串

> ID：13247633
> 
> 赞同：3
> 
> 时间：2012-11-06T09:01:55.377
> 
> 标签：asp.net, asp.net-mvc, razor

我在 ASP MVC 应用程序中的代码有问题。

我使用剃须刀引擎编写一个变量，如：

```
@var 
```

但现在我需要在 var 之后直接添加一些文本：

```
@varMyText 
```

但这不起作用，只有一个空格：

```
@var MyText 
```

如何在没有空格的情况下做到这一点？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-11-06T09:05:45.783

那将是

```
@(var)MyText 
```

或者

```
@(var + "MyText") 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-06T09:03:59.357

你可以试试

```
@string.Format("{0}MyText", variable) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-06T09:08:54.480

尝试使用任何[HtmlHelpers](http://msdn.microsoft.com/en-us/library/system.web.mvc.htmlhelper%28v=vs.108%29.aspx)例如[Raw](http://msdn.microsoft.com/en-us/library/gg480740%28v=vs.108%29.aspx)：

```
@Html.Raw("Your string"); 
```

# android - Android：从视图扩展类调用活动方法

> ID：13247641
> 
> 赞同：3
> 
> 时间：2012-11-06T09:02:28.100
> 
> 标签：android, view, methods, android-activity, call

我有两个课程：

*   `MenuActivity`- “空白”活动，它从调色板加载带有视图的布局作为控件。
*   `MenuView`- 使用 View 扩展的类，将其作为调色板的控件放入`layout`。

在`MenuView`我有`handler`触摸屏时，我想在此操作后更改活动，答案是：如果将此类作为布局控制，如何从视图类调用活动中的方法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-06T09:49:12.920

通常这是通过侦听器模式完成的 - 您的活动将自己（或匿名内部类）注册到您的自定义视图，然后视图在侦听器上调用一些自定义方法。

# routes - Ruby on Rails：如何使用具有唯一 ID 的 rspec 测试路线？

> ID：13247642
> 
> 赞同：1
> 
> 时间：2012-11-06T09:02:35.697
> 
> 标签：routes, ruby-on-rails-3.2, rspec2

我正在尝试这样做：

*   [如何使用 rspec-rails 测试控制器？](https://stackoverflow.com/questions/13185552/how-do-i-test-a-controller-with-rspec-rails)

我的测试如下：

```
describe "User pages" do

subject { page }

describe "edit" do
  let(:user) { FactoryGirl.create(:user) }
  before do
    log_in user 
    #visit edit_user_path(user) <-- did not work
  end

describe "page" do
  it "should render edit page" do
    get :edit, :id => user.id
    should have_selector('h1',    text: "Update")
    should have_selector('h2',    text: user.username)
    should have_selector('title', text: "Edit user")
  end
end

describe "with invalid information" do
  before { click_button "Save changes" }
  it { should have_content('error') }
end 
```

结尾

我尝试添加`get :edit, :id => user.id`，但它引发了异常：

```
Failure/Error: get :edit, :id => user.id
 ArgumentError:
   bad argument (expected URI object or URI string) 
```

还有什么我想念的吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-06T12:13:22.837

1）确保您的测试文件有一个块，如：

```
 describe UsersController do
   # your tests here
 end 
```

2）尝试像这样重写get

```
 it "should render edit page" do
    get :edit, :id => user.to_param
    should have_selector('h1',    text: "Update")
    # ...
 end 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-06T09:53:47.057

试试这个

```
describe "page" do
  it "should render edit page" do
    p = FactoryGirl.create(:user)
    get :edit, :id => p.id
    should have_selector('h1',    text: "Update")
    should have_selector('h2',    text: user.username)
    should have_selector('title', text: "Edit user")
  end
end 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-07T04:24:12.227

我最终这样做了：

```
visit edit_user_path(user.id) 
```

我不确定是否阅读了有关哪种方法（获取与访问）是首选的内容。

# go - Go 中的 ToString() 函数

> ID：13247644
> 
> 赞同：126
> 
> 时间：2012-11-06T09:02:41.077
> 
> 标签：go, tostring

该`strings.Join`函数仅采用字符串切片：

```
s := []string{"foo", "bar", "baz"}
fmt.Println(strings.Join(s, ", ")) 
```

但是能够传递实现`ToString()`函数的任意对象会很好。

```
type ToStringConverter interface {
    ToString() string
} 
```

Go 中是否有类似的东西，或者我是否必须`int`使用 ToString 方法装饰现有类型并编写一个包装器`strings.Join`？

```
func Join(a []ToStringConverter, sep string) string 
```

* * *

## 回答 #1

> 赞同：217
> 
> 时间：2012-11-06T09:22:46.480

将`String() string`方法附加到任何命名类型并享受任何自定义“ToString”功能：

```
package main

import "fmt"

type bin int

func (b bin) String() string {
        return fmt.Sprintf("%b", b)
}

func main() {
        fmt.Println(bin(42))
} 
```

游乐场：[http ://play.golang.org/p/Azql7_pDAA](http://play.golang.org/p/Azql7_pDAA)

* * *

输出

```
101010 
```

* * *

## 回答 #2

> 赞同：27
> 
> 时间：2015-10-21T06:31:31.517

当您拥有 own`struct`时，您可以拥有自己的*转换为字符串的*功能。

```
package main

import (
    "fmt"
)

type Color struct {
    Red   int `json:"red"`
    Green int `json:"green"`
    Blue  int `json:"blue"`
}

func (c Color) String() string {
    return fmt.Sprintf("[%d, %d, %d]", c.Red, c.Green, c.Blue)
}

func main() {
    c := Color{Red: 123, Green: 11, Blue: 34}
    fmt.Println(c) //[123, 11, 34]
} 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2018-02-07T14:59:58.173

另一个带有 struct 的例子：

```
package types

import "fmt"

type MyType struct {
    Id   int    
    Name string
}

func (t MyType) String() string {
    return fmt.Sprintf(
    "[%d : %s]",
    t.Id, 
    t.Name)
} 
```

使用时要小心，
**与 '+' 的连接** 不会编译：

```
t := types.MyType{ 12, "Blabla" }

fmt.Println(t) // OK
fmt.Printf("t : %s \n", t) // OK
//fmt.Println("t : " + t) // Compiler error !!!
fmt.Println("t : " + t.String()) // OK if calling the function explicitly 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2021-07-07T22:36:19.113

*   这很好用

` 包主

```
import "fmt"

type Person struct {
    fname, sname string 
    address string 
}

func (p *Person) String() string {
    s:=  fmt.Sprintf("\n %s %s  lives at %s \n", p.fname, p.sname, p.address)
    return s
}

func main(){
    alex := &Person{"Alex", "Smith", "33 McArthur Bvd"}
    fmt.Println(alex)

} 
```

` 输出：

亚历克斯·史密斯住在麦克阿瑟大道 33 号

* * *

## 回答 #5

> 赞同：-2
> 
> 时间：2021-03-31T15:23:51.477

这是处理此问题的简单方法：

```
package main

import (
    "fat"
    "strconv"
)

type Person struct {
    firstName, lastName string
    age int
}

func (p Person) GetFullName() string {
    return p.firstName + " " + p.lastName
}

func (p Person) GetAge() int {
    return p.age
}

func (p Person) GetAgeAsString() string {
    return strconv.Itoa(p.age)
}

func main() {
    p := Person {"John", "Doe", 21}
    fmt.Println(p.GetFullName())
    fmt.Println(p.GetAgeAsString())
} 
```

输出：

```
"John Doe"
"21" 
```

* * *

## 回答 #6

> 赞同：-7
> 
> 时间：2014-12-26T12:47:54.290

我更喜欢以下内容：

```
type StringRef []byte

func (s StringRef) String() string {
        return string(s[:])
}

…

// rather silly example, but ...
fmt.Printf("foo=%s\n",StringRef("bar")) 
```

# jsf - 在不使用过滤器和包装器的情况下删除 URL 中的 JSESSIONID

> ID：13247645
> 
> 赞同：2
> 
> 时间：2012-11-06T09:02:42.073
> 
> 标签：jsf, session, servlet-filters, jsessionid, session-fixation

我在`Filter`/* 的 url 模式上创建了一个监听，它用实现替换`HttpServletRequest`了`HttpServletRequestWrapper`。

我有一个`Servlet`并且在此`Servlet`用于`h:graphicImage`渲染从`Apache`Web 服务器获取的图像。

`<h:graphicImage value="/locationInMyWebServer/myImage.jgp"></h:graphicImage>`

当我点击访问此页面（包含图像）的 URL 时，图像没有显示为`JSESSIONID`附加到我的图像名称。正在形成的 URL 如下所示。

`http:/myDomain/myServlet/../myImage.jpg;JSESSIONID=ABCDEFGHIJKLMM`

因此，我使用了问题开头所述的`Filter`（有关此过滤器的更多详细信息，请参见[此处）。](http://java.dzone.com/articles/java-jsessionid-harmful)

从这里`Servlet`有一个用于登录的链接。当用户登录时，`JSESSIONID`即使经过身份验证，也会保留相同的内容。由于 Session ID 在登录之前和用户登录之后是相同的，这导致了 Session-fixation 攻击。

如何避免使用此过滤器并解决我`JSESSIONID`在使用时附加到图像的问题`h:graphicImage`

**PS：**我不能使用`<img src>`，因为我`h:graphicImage`在里面`h:commandLink`

登录前和登录后的会话 ID 不同，在使用此之前`Filter`

**我在下面添加了相关代码。**

下面的代码来自我的`web.xml`其中有条目`Filter`

```
<filter> 
   <filter-name>URLSessionFilter</filter-name>
   <filter-class>myPackage.web.filter.URLSessionFilter</filter-class>
</filter>
<filter-mapping>
   <filter-name>URLSessionFilter</filter-name> 
   <url-pattern>/*</url-pattern>
</filter-mapping>
<filter> 
```

我的代码`URLSessionFilter`如下，

```
public class URLSessionFilter implements Filter
{
  public void doFilter(ServletRequest request, ServletResponse response, FilterChain   chain)
throws IOException, ServletException
  {
        if (!(request instanceof HttpServletRequest))
{
  chain.doFilter(request, response);
  return;
}

HttpServletResponse httpResponse = (HttpServletResponse)response;

HttpServletResponseWrapper wrappedResponse = new HttpServletResponseWrapper(httpResponse)
{
  public String encodeRedirectUrl(String url)
  {
    return url;
  }

  public String encodeRedirectURL(String url) {
    return url; }

  public String encodeUrl(String url) {
    return url; }

  public String encodeURL(String url) {
    return url;
  }
};
chain.doFilter(request, wrappedResponse);
  }

  public void init(FilterConfig filterConfig)
  {
  }

  public void destroy()
  {
  }
} 
```

单击将显示哪个登录页面时，我的 Servlet 中有一个链接。代码如下，

```
<h:commandLink  action="#{myBean.myMethod}">
<h:graphicImage value="/myLocInWebserver/myImage.jpg">
</h:commandLink> 
```

在`myBean.myMethod`，我正在做一些数据库清理活动并重定向到登录页面。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2017-09-20T23:30:44.987

另一种方法是避免 servlet 容器将某些内容解释为 URL。为此，您将避免使用任何特殊的 JSP 或 JSF 标记，而直接使用 HTML 标记。在您的情况下 - 这可能如下所示：

```
<h:commandLink  action="#{myBean.myMethod}">
  <img src="#{request.contextPath}/myLocInWebserver/myImage.jpg"/>
</h:commandLink> 
```

没有了`<h:graphicImage>`...

您仍然希望在没有任何硬编码的情况下为您的上下文路径添加前缀 - 因此使用`#{request.contextPath}`.

我最近遇到了这个解决方案，因为我正在将 JavaMelody 与我的应用程序集成，并为管理员提供了该工具的链接。然而不知何故，JavaMelody 失败了`;jsessionid`。因此，我目前正在生成如下 URL：

```
<a href="#{request.contextPath}/monitoring" 
   target="_blank" 
   class="ui-link ui-widget"
>
  Java Melody Performance Monitoring
</a> 
```

而不是典型的 JSF 解决方案

```
<p:link value="Java Melody Performance Monitoring" 
        href="/monitoring" 
        target="_blank" 
/> 
```

这根本行不通。

这个解决方案的好处是我现在可以逐个 URL 控制它，我不必担心`<tracking-mode>COOKIE</tracking-mode>`全局设置。

# c - 将整数从（纯）二进制转换为 BCD

> ID：13247647
> 
> 赞同：6
> 
> 时间：2012-11-06T09:02:45.540
> 
> 标签：c, binary, bcd

我现在很愚蠢，无法解决这个问题...

我得到一个 BCD 数字（每个数字都是自己的 4 位表示）

例如，我想要什么：

*   输入：202（十六进制）== 514（十进制）
*   输出：BCD 0x415

*   输入：0x202

*   位表示：0010 0000 0010 = 514

我尝试了什么：

```
unsigned int uiValue = 0x202;
unsigned int uiResult = 0;
unsigned int uiMultiplier = 1;
unsigned int uiDigit = 0;

// get the dec bcd value
while ( uiValue > 0 )
{
    uiDigit= uiValue & 0x0F;
    uiValue >>= 4;
    uiResult += uiMultiplier * uiDigit;
    uiMultiplier *= 10;
} 
```

但我知道这是非常错误的，这将是位表示的 202，然后分成 5 个半字节，然后再次表示为十进制数

我可以在纸上解决问题，但我无法用简单的 C 代码解决

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-11-06T09:16:09.880

你弄错了。正如您的问题（原始）标题所说，您的代码正在从**BCD 转换为 binary 。**但是您提供的输入和输出值只有在您从**binary 转换为 BCD**时才是正确的。在这种情况下，请尝试：

```
#include <stdio.h>

int main(void) {

   int binaryInput = 0x202; 
   int bcdResult = 0;
   int shift = 0;

   printf("Binary: 0x%x (dec: %d)\n", binaryInput , binaryInput );

   while (binaryInput > 0) {
      bcdResult |= (binaryInput % 10) << (shift++ << 2);
      binaryInput /= 10;
   }

   printf("BCD: 0x%x (dec: %d)\n", bcdResult , bcdResult );
   return 0;
} 
```

证明：http: [//ideone.com/R0reQh](http://ideone.com/R0reQh)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-10T16:28:09.783

试试下面的。

```
unsigned long toPackedBcd (unsigned int val)
{
  unsigned long bcdresult = 0; char i;

  for (i = 0; val; i++)
  {
    ((char*)&bcdresult)[i / 2] |= i & 1 ? (val % 10) << 4 : (val % 10) & 0xf;
    val /= 10;
  }
  return bcdresult;
} 
```

也可以尝试以下变体（尽管可能效率低下）

```
/*
Copyright (c) 2016 enthusiasticgeek<enthusiasticgeek@gmail.com> Binary to Packed BCD
This code may be used (including commercial products) without warranties of any kind (use at your own risk)
as long as this copyright notice is retained.
Author, under no circumstances, shall not be responsible for any code crashes or bugs.
Exception to copyright code: 'reverse string function' which is taken from http://stackoverflow.com/questions/19853014/reversing-a-string-in-place-in-c-pointers#19853059
Double Dabble Algorithm for unsigned int explanation

255(binary) - base 10 -> 597(packed BCD) - base 16
     H|    T|    U|        (Keep shifting left)
               11111111
             1 1111111
            11 111111  
           111 11111
          1010 11111    <-----added 3 in unit's place (7+3 = 10) 
        1 0101 1111  
        1 1000 1111     <-----added 3 in unit's place (5+3 = 8)
       11 0001 111
      110 0011 11       
     1001 0011 11       <-----added 3 in ten's place (6+3 = 9)
   1 0010 0111 1  
   1 0010 1010 1        <-----added 3 in unit's place (7+3 = 10)
  10 0101 0101  -> binary 597 but bcd 255
  ^    ^    ^  
  |    |    |
  2    5    5   
*/
#include <stdio.h>   
#include <string.h>

//Function Prototypes
unsigned int binaryToPackedBCD (unsigned int binary); 
char * printPackedBCD(unsigned int bcd, char * bcd_string);

// For the following function see http://stackoverflow.com/questions/19853014/reversing-a-string-in-place-in-c-pointers#19853059
void reverse(char *str);

//Function Definitions
unsigned int binaryToPackedBCD (unsigned int binary) {
  const unsigned int TOTAL_BITS = 32;
  /*Place holder for bcd*/
  unsigned int bcd = 0;
  /*counters*/
  unsigned int i,j = 0;
  for (i=0; i<TOTAL_BITS; i++) {
     /*
      Identify the bit to append  to LSB of 8 byte or 32 bit word -
      First bitwise AND mask with 1\. 
      Then shift to appropriate (nth shift) place. 
      Then shift the result back to the lsb position. 
     */
      unsigned int binary_bit_to_lsb = (1<<(TOTAL_BITS-1-i)&binary)>>(TOTAL_BITS-1-i);
      /*shift by 1 place and append bit to lsb*/
      bcd = ( bcd<<1 ) | binary_bit_to_lsb;       
      /*printf("=> %u\n",bcd);*/
      /*Don't add 3 for last bit shift i.e. in this case 32nd bit*/
      if( i >= TOTAL_BITS-1) { 
      break;
      }
      /*else continue*/
      /* Now, check every nibble from LSB to MSB and if greater than or equal 5 - add 3 if so */
      for (j=0; j<TOTAL_BITS; j+=4) {
        unsigned int temp = (bcd & (0xf<<j))>>j;
        if(temp >= 0x5) {
        /*printf("[%u,%u], %u, bcd = %u\n",i,j, temp, bcd);*/
        /*Now, add 3 at the appropriate nibble*/
         bcd = bcd  + (3<<j);
        // printf("Now bcd = %u\n", bcd);
        }
      }
  }
  /*printf("The number is %u\n",bcd);*/
  return bcd;
}   

char * printPackedBCD(unsigned int bcd, char * bcd_string) {
  const unsigned int TOTAL_BITS = 32;
  printf("[LSB] =>\n");
   /* Now, check every nibble from LSB to MSB and convert to char* */
  for (unsigned int j=0; j<TOTAL_BITS; j+=4) {
  //for (unsigned int j=TOTAL_BITS-1; j>=4; j-=4) {
      unsigned int temp = (bcd & (0xf<<j))>>j;
      if(temp==0){
    bcd_string[j/4] = '0';      
      } else if(temp==1){
    bcd_string[j/4] = '1';
      } else if(temp==2){
    bcd_string[j/4] = '2';
      } else if(temp==3){
    bcd_string[j/4] = '3';
      } else if(temp==4){
    bcd_string[j/4] = '4';
      } else if(temp==5){
    bcd_string[j/4] = '5';
      } else if(temp==6){
    bcd_string[j/4] = '6';
      } else if(temp==7){
    bcd_string[j/4] = '7';
      } else if(temp==8){
    bcd_string[j/4] = '8';
      } else if(temp==9){
    bcd_string[j/4] = '9';
      } else {
    bcd_string[j/4] = 'X';
      }
      printf ("[%u - nibble] => %c\n", j/4, bcd_string[j/4]);
  }      
  printf("<= [MSB]\n");
  reverse(bcd_string);
  return bcd_string;
}

// For the following function see http://stackoverflow.com/questions/19853014/reversing-a-string-in-place-in-c-pointers#19853059
void reverse(char *str)
{ 
    if (str != 0 && *str != '\0') // Non-null pointer; non-empty string
    {
    char *end = str + strlen(str) - 1; 
    while (str < end)
    {
        char tmp = *str; 
        *str++ = *end; 
        *end-- = tmp;
    } 
    }
}

int main(int argc, char * argv[])
{
  unsigned int number = 255;
  unsigned int bcd = binaryToPackedBCD(number);
  char bcd_string[8];
  printPackedBCD(bcd, bcd_string);
  printf("Binary (Base 10) = %u => Packed BCD (Base 16) = %u\n OR \nPacked BCD String = %s\n", number, bcd, bcd_string);
  return 0;
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-06T09:13:52.727

这里真正的问题是基础和单位的混淆

202 应该是十六进制，等于十进制 514 ......因此 BCD 计算是正确的

二进制代码十进制将十进制 (514) 转换为三个半字节大小的字段： - 5 = 0101 - 1 = 0001 - 4 = 0100

更大的问题是您的标题错误，并且您正在将 Uint 转换为 BCD，而标题要求将 BCD 转换为 Unint

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2021-07-08T23:00:57.640

我的 2 美分，我需要类似的 RTC 芯片，它使用 BCD 来编码时间和日期信息。想出了以下可以很好地满足要求的宏：

#define MACRO_BCD_TO_HEX(x) ((BYTE) ((((x >> 4) & 0x0F) * 10) + (x & 0x0F)))

#define MACRO_HEX_TO_BCD(x) ((BYTE) (((x / 10 ) << 4) | ((x % 10))))

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-11-06T09:17:20.550

一个天真的但简单的解决方案：

```
char buffer[16];
sprintf(buffer, "%d", var);
sscanf(buffer, "%x", &var); 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2017-02-17T22:31:53.407

这是我开发的解决方案，适用于嵌入式系统，例如 Microchip PIC 微控制器：

```
#include <stdio.h>
void main(){
    unsigned int output = 0;
    unsigned int input;
    signed char a;
    //enter any number from 0 to 9999 here:
    input = 1265;
    for(a = 13; a >= 0; a--){
        if((output & 0xF) >= 5)
            output += 3;
        if(((output & 0xF0) >> 4) >= 5)
            output += (3 << 4);
        if(((output & 0xF00) >> 8) >= 5)
            output += (3 << 8);
        output = (output << 1) | ((input >> a) & 1);
    }
    printf("Input decimal or binary: %d\nOutput BCD: %X\nOutput decimal: %u\n", input, output, output);
} 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2020-09-17T12:57:16.337

这是我的字节转换版本：

```
//----------------------------------------------
// This function converts n bytes Binary (up to 8, but can be any size)
// value to n bytes BCD value or more.
//----------------------------------------------

void bin2bcdn(void * val, unsigned int8 cnt)
{
    unsigned int8  sz, y, buff[20];         // buff = malloc((cnt+1)*2);

    if(cnt > 8) sz = 64;                    // 8x8
    else        sz = cnt * 8 ;              // Size in bits of the data we shift

    memset(&buff , 0, sizeof(buff));        // Clears buffer
    memcpy(&buff, val, cnt);                // Copy the data to buffer

    while(sz && !(buff[cnt-1] & 0x80))      // Do not waste time with null bytes,
    {                                       // so search for first significative bit
        rotate_left(&buff, sizeof(buff));   // Rotate until we find some data
        sz--;                               // Done this one
    }
    while(sz--)                             // Anyting left?
    {
        for( y = 0; y < cnt+2; y++)         // Here we fix the nibbles
        {
            if(((buff[cnt+y] + 0x03) & 0x08) != 0) buff[cnt+y] += 0x03;
            if(((buff[cnt+y] + 0x30) & 0x80) != 0) buff[cnt+y] += 0x30;
        }
        rotate_left(&buff, sizeof(buff));   // Rotate the stuff
    }
    memcpy(val, &buff[cnt], cnt);           // Copy the buffer to the data
//  free(buff);       //in case used malloc
}   // :D Done 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2020-11-22T14:12:49.110

```
long bin2BCD(long binary) { // double dabble: 8 decimal digits in 32 bits BCD
  if (!binary) return 0;
  long bit = 0x4000000; //  99999999 max binary
  while (!(binary & bit)) bit >>= 1;  // skip to MSB

  long bcd = 0;
  long carry = 0;
  while (1) {
    bcd <<= 1;
    bcd += carry; // carry 6s to next BCD digits (10 + 6 = 0x10 = LSB of next BCD digit)
    if (bit & binary) bcd |= 1;
    if (!(bit >>= 1)) return bcd;
    carry = ((bcd + 0x33333333) & 0x88888888) >> 1; // carrys: 8s -> 4s
    carry += carry >> 1; // carrys 6s  
  }
} 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2020-11-26T15:23:03.677

简单的解决方案

```
#include <stdio.h>

int main(void) {

   int binaryInput = 514 ;      //0x202 
   int bcdResult = 0;
   int digit = 0;
   int i=1;

   printf("Binary: 0x%x (dec: %d)\n", binaryInput , binaryInput );

   while (binaryInput > 0) {

      digit = binaryInput %10;          //pick digit
      bcdResult = bcdResult+digit*i;
      i=16*i;
      binaryInput = binaryInput/ 10;
   }
   printf("BCD: 0x%x (dec: %d)\n", bcdResult , bcdResult );
   return 0;
} 
```

二进制：0x202（十进制：514）

BCD：0x514（十进制：1300）

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2022-02-09T13:39:45.713

您还可以尝试以下方法：

在每次迭代中，剩余部分（表示为 nibble ）位于其相应的位置。

```
uint32_t bcd_converter(int num)
{                          
  uint32_t temp=0;              
  int i=0;                 
  while(num>0){            
    temp|=((num%10)<<i);   
    i+=4;                  
    num/=10;               
  }                        

  return temp;             
} 
```

# java - 将文件从内部存储复制到外部存储

> ID：13247657
> 
> 赞同：2
> 
> 时间：2012-11-06T09:03:08.547
> 
> 标签：java, android, android-intent

我试图使用 Adob​​e 阅读器读取从服务器下载的 pdf 文件，问题是当我将其存储在内部存储中时，其他应用程序无法读取该文件。现在我想知道如何将此文件**复制****到外部存储（/sdcard/）**中，以便 pdf 查看器查看。

由于安全原因，我将文件存储在内部存储中，之后会删除外部存储中的文件。

**我的问题是如何在不使用原始或资产放入输入流的情况下复制保存在内部存储中的文件。**

```
 InputStream myInput = getResources().openRawResource(R.raw.p13);

        FileOutputStream fos = openFileOutput("sample", Context.MODE_PRIVATE);

        // transfer bytes from the input file to the output file
        byte[] buffer = new byte[1024];
        int length;
        while ((length = myInput.read(buffer)) > 0)
        {
            fos.write(buffer, 0, length);
        }
        // Close the streams
        fos.flush();
        fos.close();
        myInput.close(); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-06T09:22:43.533

您在哪个路径存储 pdf 文件？

请参阅下面的一个从 android Assets 获取文件并将其复制到特定的 sdcard 位置。

我将首先检查 pdf 文件是否已在期望路径中可用。

```
 File file1 = new File("/sdcard/SampleProjectApp/WindsorONE_Mobile_Molding.pdf");
    File file2 = new File("/sdcard/SampleProjectApp/WindsorONE_Mobile_PK.pdf");
    File file3 = new File("/sdcard/SampleProjectApp/Alone.mp4");

    if(!((file1.exists())) || !((file2.exists())) || !((file3.exists()))) {
        ArrayList<String> files = new ArrayList<String>();
        files.add("WindsorONE_Mobile_Molding.pdf");         
        files.add("WindsorONE_Mobile_PK.pdf"); 
        files.add("Alone.mp4");
        new myAsyncTask().execute(files);
    } 
```

现在，如果该位置不存在该文件，那么它将执行 myAsyncTask 以将文件从资产复制到 SdCard。

```
 // AsyncTass for the Progress Dialog and to do Background Process
private class myAsyncTask extends AsyncTask<ArrayList<String>, Void, Void> {         
    ArrayList<String> files;         
    ProgressDialog dialog;         
    @Override         
    protected void onPreExecute() {             
        dialog = ProgressDialog.show(ListSample.this, "W1 SALES (beta)", "Loading...");         
    }         
    @Override         
    protected Void doInBackground(ArrayList<String>... params) {              
        files = params[0];             
        for (int i = 0; i < files.size(); i++) {                 
            copyFileFromAssetsToSDCard(files.get(i));                
        }             return null;         
    }         
    @Override         
    protected void onPostExecute(Void result) {             
        dialog.dismiss();         
    }      
} 

 // Function to copy file from Assets to the SDCard
public void copyFileFromAssetsToSDCard(String fileFromAssets){
    AssetManager is = this.getAssets();
    InputStream fis;
    try {

        fis = is.open(fileFromAssets);
        FileOutputStream fos;
        if (!APP_FILE_PATH.exists()) {
            APP_FILE_PATH.mkdirs();
        }
        fos = new FileOutputStream(new File(Environment.getExternalStorageDirectory()+"/SampleProjectApp", fileFromAssets));
        byte[] b = new byte[8];
        int i;
        while ((i = fis.read(b)) != -1) {
            fos.write(b, 0, i);
        }
        fos.flush();
        fos.close();
        fis.close();
    } 
    catch (IOException e1) {
        e1.printStackTrace();
    }
} 
```

**更新**

就你而言：

替换 **SampleProjectApp/WindsorONE_Mobile_Molding.pdf**

和

**Android/data/com.project.projectname/cache/YOUR_PDF_FILE.pdf**

希望它有意义。

**更新 2**

下面的代码是将文件从一个路径复制到另一个路径。您只需传递文件所在的路径和必须复制的路径。

代码：

```
public static boolean copyFile(String from, String to) {
try {
    int bytesum = 0;
    int byteread = 0;
    File oldfile = new File(from);
    if (oldfile.exists()) {
        InputStream inStream = new FileInputStream(from);
        FileOutputStream fs = new FileOutputStream(to);
        byte[] buffer = new byte[1444];
        while ((byteread = inStream.read(buffer)) != -1) {
            bytesum += byteread;
            fs.write(buffer, 0, byteread);
        }
        inStream.close();
        fs.close();
    }
    return true;
} catch (Exception e) {
    return false;
} 
```

}

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-06T09:17:05.247

你可以使用这个方法

```
boolean isSDPresent = android.os.Environment.getExternalStorageState().equals(android.os.Environment.MEDIA_MOUNTED);

if(isSDPresent)
{
    InputStream in = null;
    OutputStream out = null;
      in = //Place your file in the inputstream
      out = new FileOutputStream(Environment.getExternalStorageDirectory().getAbsolutePath() + filename);
      byte[] buffer = new byte[1024];
      int read;
      while((read = in.read(buffer)) != -1){
        out.write(buffer, 0, read);
      }
      in.close();
      in = null;
      out.flush();
      out.close();
      out = null;
}
else
{
Toast.makeText(getApplicationContext(), "SD Card not present", Toast.LENGTH_LONG).show();
} 
```

# java - 在 GWT 中使用连字符

> ID：13247661
> 
> 赞同：1
> 
> 时间：2012-11-06T09:03:32.143
> 
> 标签：java, javascript, gwt

谁能告诉我如何在 GWT 中使用[连字符](http://code.google.com/p/hyphenator/)（方法`Hyphenator.run()`？）。当我简单地插入 JS 代码时

```
<script type="text/javascript">
            Hyphenator.run();
</script 
```

我的文字不可见:(

谢谢！

PS。没有标签连字符 - 任何人都可以添加它吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-06T09:26:07.453

我是hypenator的新手，但我可以建议这种解决方法。将此添加到您的`EntryPoint`班级并在其中调用此方法`onModuleLoad`

```
public static native void startHypenator() 
    /*-{
      $wnd.Hypenator.run();
    }-*/; 
```

# linux - 如何使用我自己的 PCI 声音驱动程序构建 ALSA

> ID：13247662
> 
> 赞同：1
> 
> 时间：2012-11-06T09:03:33.913
> 
> 标签：linux, drivers, alsa

我正在尝试为我的 PCI 声卡创建一个简单的驱动程序，我将在其中使用 ALSA api。要运行我的驱动程序，我已将原始 snd_intel8x0 声卡驱动程序列入黑名单。此时我的探测函数被调用，我的 PCI IO 端口被分配，并且 PCI 设备被启用。

不幸的是，当我尝试使用 ALSA api 时，出现以下错误：

[...] alsa：未知符号 snd_card_register（错误 0）

[...] alsa：未知符号 snd_card_create（错误 0）

[...] alsa：未知符号 snd_card_free（错误 0）

[...] alsa：未知符号 snd_device_new（错误 0）

同样在文件 /proc/kallsyms 中没有 snd* 符号（如果原始驱动程序 snd_intel8x0 正在运行所有上述 snd* 函数在 /proc/kallsyms 中可用）

当原始驱动程序被列入黑名单时，文件夹 /proc/asound 消失（如果 snd_intel8x0 正在运行，则存在一个sound文件夹）

**我在互联网上的搜索以及在这里和其他论坛中的问题表明，我必须以某种方式用我的驱动程序构建 ALSA。我该怎么做？任何指南，教程链接都非常感谢。**

非常感谢提前。我希望能得到一些有用的答案。我试图解决这个问题很长时间没有成功。

问候，内德林。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-08T08:30:28.597

您在编译或加载模块时做错了什么，但由于您没有提及您是如何尝试这样做的，因此没有更具体的说明。

有关如何编译和加载模块的说明，请参阅[Linux 设备驱动程序](http://lwn.net/Kernel/LDD3/)的第 2 章。
对于 ALSA 驱动程序，请参阅[编写 ALSA 驱动程序](http://www.alsa-project.org/~tiwai/writing-an-alsa-driver/)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-08T20:43:15.813

好吧，我将尽可能详细地解释我所做的事情。

所以这是我使用的makefile

> obj-m := alsa.o
> 
> KERNELDIR ?= /lib/modules/$(shell uname -r)/build
> 
> 密码 := $(shell 密码)
> 
> 全部：$(MAKE) -C $(KERNELDIR) M=$(PWD)
> 
> 干净： rm -rf *.o *~ core .depend 。*.cmd *.ko *.mod.c .tmp_versions

我用**sudo insmod .ko加载**

在这里我会说，最初我不想使用 ALSA。那时我创建了一个准系统 PCI 驱动程序，它只初始化 PCI 设备并在探测函数中注册 IO 端口和 IO 内存。我成功加载了这个模块（执行了探测并保留了 IO 区域）。为了构建这个 PCI 驱动程序，我使用了上面提到的 Makefile。后来我决定我需要 ALSA，从那以后我得到 **[...] alsa: Unknown symbol snd_card_register (err 0)**错误

如您发送给我的链接中所述，我还尝试将我的驱动程序包含在 ALSA 树中。以下是我如何更改 /sound/pci 中的 Makfile 和 Kconfig 文件（我在 /sound/pci/Nedelin_ALSA_PCI.o 中创建了一个指向实际代码的链接。我提到这一点是为了避免对文件名）：

> 生成文件
> 
> ...
> 
> snd-nedelinxalsaxpci-objs := Nedelin_ALSA_PCI.o
> 
> ...
> 
> obj-$(CONFIG_SND_NEDELINXALSAXPCI) += snd-nedelinxalsaxpc
> 
> 配置
> 
> 配置 SND_NEDELINXALSAXPCI
> 
> 三态“英特尔/SiS/nVidia/SND_NEDELINXALSAXPCI 驱动程序”
> 
> 选择 SND_AC97_CODEC
> 
> help 这是我的司机...

这似乎很成功。我在 make menuconfig 中找到了我的驱动程序并将其作为模块加载。重新编译我的内核，也OK。我在 /lib/modules//kernel/sound/pci 中看到了我的驱动程序。如果我尝试使用 modprobe 加载它，它似乎已加载（执行了 module_init()）但我的探测函数未执行。

我完全糊涂了。

# android - LinearLayout中的Edittext在滚动背景时闪烁

> ID：13247663
> 
> 赞同：2
> 
> 时间：2012-11-06T09:03:36.597
> 
> 标签：android, background, android-edittext, android-linearlayout

我以编程方式在线性布局中添加视图（Edittext）。其实是一种形式。但问题是所有这一切都在一个相对和一个滚动视图中的相对中。每当我滚动线性布局（表单）的背景时都会闪烁。我注意到如果我从edittext中删除可聚焦属性，它会停止这样做，但我无法按下edittext。

我怎样才能停止这种闪烁？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-06T10:16:09.863

好吧，我没有正确解决它，但我发疯了 android-hack :)

问题与编辑文本的焦点有关。我尝试将 requestfocus 或 android:descendantFocusability 添加到 linearLayout 没有结果。

所以我制作了另一个具有所需背景的LinearLayout，使用实际表单和没有背景的实际表单alignBottom。

我确信会发生相同的闪烁，但没有背景，因此存在任何视觉问题。

# jquery - 获取元素的索引

> ID：13247664
> 
> 赞同：0
> 
> 时间：2012-11-06T09:03:42.253
> 
> 标签：jquery, indexing

我有一个进入文本区域的代码。这里是[http://clip2net.com/s/2tnj2](http://clip2net.com/s/2tnj2) 当我单击提交按钮时，所有这些代码都放入变量中。

```
$('#fc-send2').live('click',function () {

var code = $('textarea.site-code').val();

alert($(code).find('li').index('.my-class')); }); 
```

但它总是向我显示“-1”。这意味着，未找到元素。如何从变量“代码”中查找元素的索引。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-06T09:05:21.393

代替

```
var code = $('textarea.site-code').val(); 
```

利用

```
var code = $('textarea.site-code'); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-06T09:53:58.537

```
$('#fc-send2').live('click',function () {

  var code = $('textarea.site-code').val(); 
```

// 代码 var 是一个字符串，而不是一个 DOM 元素

```
 alert($(code).find('li').index('.my-class')); 
```

// 这就是为什么你不能在这里做 .find

```
}); 
```

你应该

```
var someHiddenContainer = $("#some-hidden-container");

someHiddenContainer.html( code ); //insert your code var to DOM

alert( someHiddenContainer.find("li").index(".my-class") );

someHiddenContainer.empty(); //optional 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-06T09:08:31.047

```
try this 

$('#fc-send2').live('click',function () {

var code = $('textarea.site-code');

alert($(code).find('li').index('.my-class')); }); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-06T09:24:05.013

试试这个（$() 已添加到索引中）

```
alert($(code).find('li').index($('.my-class'))); 
```

**更新：** [小提琴样本](http://jsfiddle.net/BrrblK/3NdXc/)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-11-06T09:34:58.107

只需更换线路

```
var code = $('textarea.site-code'); 
```

和

```
var code = $('#textarea.site-code'); 
```

您刚刚错过了`#`带有 ID 的 。

# c# - 在 C# .NET 中实现接口

> ID：13247670
> 
> 赞同：1
> 
> 时间：2012-11-06T09:04:09.390
> 
> 标签：c#, .net, interface, compilation

考虑以下接口

```
public interface ICustomData
{
    String CustomData { set; get; }
} 
```

根据 MSDN 文档，接口成员是自动公开的。

假设我现在想实现我的接口：

```
public class CustomDataHandler : ICustomData
{
} 
```

这会在编译时中断，告诉我我没有实现“CustomData”

另一方面，这将起作用：

```
public class CustomDataHandler : ICustomData
{
    public String CustomData { set; get; }
} 
```

我的问题是：如果接口的成员自动公开，为什么我必须在类中声明实现？如果接口声明在语法上与类声明相同，为什么编译器不能从我的接口自动推断出来？

**编辑：**

我问的理由。想象一下您正在构建数据模型、实体等的场景。我可能会为这些模型编写一些接口，如下所示：

```
public interface IUserAccount
{
    Guid Identity { set; get; }
    String FirstName { set; get; }
    String LastName { set; get; }
    String EmailAddress { set; get; }
    String Password { set; get; }
}

public interface IUserDataEntry
{
    Guid DataIdentity { set; get; }
    String DataName { set; get; }
    String Data { set; get; }
} 
```

像这样构建模型会简单得多：

```
public class UserAccount : IUserAccount
{
}

public class UserDataEntry : IUserDataEntry
{
}

public class Combined : IUserAccount, IUserDataEntry
{
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-06T09:07:50.523

接口不是用来提供实现的，它是用来定义契约的。然后，这允许构建实现它的不同实现。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-06T09:08:04.687

它们在句法上可能相同，但它们的含义不同（即它们在语义上*并不相同）。*

在接口中，语法意味着实现类必须公开这样的属性，`get`并`set`按照它认为合适的方式实现访问器（显式或隐式）。接口仅仅定义了一个类必须提供的*外在行为；*它不提供该行为的任何实现。

在该类中，语法是“自动属性”，是接口定义的属性的实现，并且*和*`get`访问`set`器被隐式转换为具有支持字段的完整实现。编译后看起来像这样：

```
public class CustomDataHandler : ICustomData
{
    private string customData;

    public string CustomData
    {
        get
        {
            return customData;
        }
        set
        {
            customData = value;
        }
    }
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-06T09:06:40.573

您正在隐式实现接口。在这种情况下，类的方法签名必须与接口的方法签名匹配（包括可访问性）。确保方法被标记为公共确保在查看类时不会出现意外，例如：

```
public class CustomDataHandler : ICustomData
{
  String CustomData {get; set}
  String PrivateCustomData {get;set;}
} 
```

即使两个属性声明相同，CustomData 属性也将是公共的，因为它是在接口上声明的，即使声明看起来与 PrivateCustomData 的声明相同。这将是不一致的，并导致更难维护代码。

如果您不想设置访问修饰符，则可以显式实现该接口：

```
public class CustomDataHandler : ICustomData
{
    String ICustomData.CustomData { set; get; }
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-06T09:09:11.440

您必须明确地实现它，因为......您不仅限于以这种方式实现它。您可以使用一个字段，或者在您的方法中执行其他操作。接口只是保证该方法存在的方法契约。

```
public class CustomDataHandler : ICustomData
{
    public String CustomData
    {
        get { return "None of your business!"; }
        set { } // Decide to do nothing
    }
} 
```

接口只保证这个方法会存在。不是你要用它做什么。

**编辑：**至于您对问题的编辑，如果您只想为一组类实现一次方法，您可能会寻求拥有一个父类而不是接口。但是，虽然可以组合接口，但不能组合父类。但是，您可以在类层次结构的不同点添加接口。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-11-06T09:10:47.210

`CustomData`这是一个属性`private`位于派生类中的示例：

```
public class CustomDataHandler : ICustomData
{
    private string CustomData { set; get; }

    string ICustomData.CustomData { get; set; }
} 
```

但是这段代码可以编译，因为还有一个显式的属性实现。

因此，`public`在这种情况下，修饰符不是多余的。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-11-06T09:08:06.543

接口声明仅指定接口定义的行为。在您的情况下，这是一个名为的属性`CustomData`，它有一个`get`and `set`（它是一个读/写属性），它的类型是`string`。

实现接口的类需要完全做到这一点——*以指定实现*。

现在，在您的情况下，您使用的自动实现的属性`{ get; set; }`看起来与接口声明相同，但是您的 get 或 set 方法中也可以有一个支持字段和行为。

# java - 在 java webservice 客户端中覆盖 XMLGregorianCalendar 类的 XML 绑定

> ID：13247674
> 
> 赞同：0
> 
> 时间：2012-11-06T09:04:28.000
> 
> 标签：java, web-services, soap

我正在为 3rdparty Web 服务编写 Web 服务客户端。Web 服务使用 XMLGregorianCalendar 发送时间戳。当我调用 web 方法时，我收到带有错误消息的异常

```
Input request field Start Date/Time has an invalid value.
Invalid DateTime value 2012-01-01T05:05:05, expected in format YYYY-MM-DD-HH.MM.SS 
```

是否可以在 Web 服务的客户端覆盖 xml 绑定，如果可能的话如何。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-08T06:58:01.543

我也遇到了同样的问题，并且能够通过在客户端自定义 jaxb 绑定来解决它。

您可以通过创建一个 jaxb 自定义 xml 并在生成客户端存根时使用它来做到这一点。

下面添加了我创建的 jaxb 自定义文件

```
<?xml version="1.0" encoding="UTF-8"?>
    <jaxws:bindings  node="wsdl:definitions/wsdl:types/xsd:schema" 
        xmlns:jaxws="http://java.sun.com/xml/ns/jaxws"
        xmlns:jaxb="http://java.sun.com/xml/ns/jaxb"
        xmlns:wsdl="http://schemas.xmlsoap.org/wsdl/"
        xmlns:xsd="http://www.w3.org/2001/XMLSchema" 
        wsdlLocation="relative url to wsdl location">

<jaxb:globalBindings>
     <jaxb:serializable/>
     <jaxb:javaType name="java.lang.String" xmlType="xsd:dateTime"/>
</jaxb:globalBindings>

</jaxws:bindings> 
```

在上述文件中，dateTime 将在存根中创建为字符串。希望有帮助。

# jquery - jquery validate - 提交时需要2个字段之一

> ID：13247675
> 
> 赞同：2
> 
> 时间：2012-11-06T09:04:28.547
> 
> 标签：jquery, validation, jquery-validate

我正在使用 jQuery validate 来验证我的表单，但我想知道是否有可能需要 2 个字段中的任何一个。我只知道使 1 成为必需的方法，但它们中的任何一个都应该是必需的。

谁能指出我正确的方向？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-11-06T09:09:40.920

像这样试试

```
<form id="from1" name="from1"   method="post">
      <input type='text' id='textbox1' name='textbox1'/>
      <input type='text' id='textbox2' name='textbox2' />
      <input type='submit' value='submit' id='save' name='save'/>
</form>​

    <script>
    var gobalvar=false; 

    $("#from1").validate({ 
      rules: {
            textbox2:{required: function(){
                if($('#textbox1').val()=="")//return value based on textbox1 status
                     return true;
                else
                     return false;
               }
            } 
        },
            messages: {
            textbox2:'required'
            }
    });
</script> 
```

## [演示](http://jsfiddle.net/6ujLy/2/)

# c# - 如何从 MvcContrib 中的代码访问嵌入式资源？

> ID：13247681
> 
> 赞同：0
> 
> 时间：2012-11-06T09:04:45.947
> 
> 标签：c#, asp.net, embedded-resource, mvccontrib

我有一个图书馆项目，我将它用作使用 MvcContrib 的便携式区域项目。

在`Library`项目内部，我正在从后面的代码访问本地图像。

```
string imagePath = Path.Combine(AppDomain.CurrentDomain.BaseDirectory, string.Format("Controls\\images\\expander_opened_hover.png"));
using (Bitmap bmp = (Bitmap)Bitmap.FromFile(imagePath))
{
   // do somthing with this image
} 
```

代码在`Library`项目上运行，但是当我从“主机”项目访问相同的函数时，我收到一个错误，指出找不到文件。该文件`Embedded Resource`在`Library`项目中设置，但在宿主项目中不存在。

如何设置路径以便它会找到嵌入的图标？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-06T09:19:17.303

可能是这样的：

```
var assembly = Assembly.GetExecutingAssembly();
var imageStream = _assembly.GetManifestResourceStream(
        "[AssemblyNamespace].Controls.images.expander_opened_hover.png");
var bitmap = new Bitmap(imageStream) 
```

看看这里：http: [//support.microsoft.com/kb/319292](http://support.microsoft.com/kb/319292)

# php - PHP 和 MySQL 编码和奇怪的迹象

> ID：13247683
> 
> 赞同：2
> 
> 时间：2012-11-06T09:05:01.913
> 
> 标签：php, mysql, encoding

我正在从网站以 ISO-8859-2 格式从网站接收数据，然后将其转换为 UTF-8（也用作 MySQL 中的编码）并进行一些修改和存储数据......

当我打印数据时，一切似乎都很好......当我将数据存储到我的表并从那里打印时，一切都很好......但是当我比较新收到的数据并与存储在 mysql 中的数据进行比较时，我总是找不到匹配项数据是一样的。所以我检查了 DB .. 当我在 DB 中打开数据时，我看到末尾或中间有一个符号……示例：Ä、‡ 等。

任何想法？

更新：我使用 InnoDB 存储引擎来启用事务.. 确切的 DB 编码是 UTF8_GENERAL_CI

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-09T10:11:13.413

我得到了 ISO-8859-2 输入数据...

首先，我使用以下方法替换了奇怪的符号：

```
$data = str_replace(chr(194), "", $data);

chr() uses ASCII code to search sign... 
```

接下来是将数据转换为 UTF-8 编码

```
$data = iconv('ISO-8859-2', 'UTF-8//TRANSLIT', $data); 
```

我收到带有字符转换的字符串，但同样的迹象再次以某种方式出现，所以我做到了

```
$data = str_replace(chr(194), "", $data); 
```

再次......之后我做了：

```
$data = @iconv('UTF-8', 'UTF-8//IGNORE', $data); 
```

即使仍然包含一些奇怪的字符，这也给了我干净的 UTF-8...@ 开头是为了避免在失败时抛出错误...

我相信这确实是一个特定的案例——我用外部数据做了很长时间，没有像这样的案例，但希望有一天有人会需要它......

感谢大家的帮助与合作……如果没有社区的支持，我将无法解决这个问题！谢谢！

# objective-c - 带有图像的 ios 标签栏自定义

> ID：13247687
> 
> 赞同：1
> 
> 时间：2012-11-06T09:05:10.657
> 
> 标签：objective-c, ios

我正在`ios`应用程序中工作，我需要自定义`tabbar`为[这样](http://postimage.org/image/jxm57t89j/)

首先，我`viewcontrollers`在导航控制器中创建了 5 个，然后将它们放入`tabbbarcontroller`

我用谷歌搜索了这个问题，我找到了解决方案

```
[self.tabBarItem setFinishedSelectedImage:<#(UIImage *)#> withFinishedUnselectedImage:<#(UIImage *)#>] 
```

但它适用于 iOS 5，我需要适用于 iOS 4 和 iOS 5 的解决方案。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-06T09:20:47.050

对于在 ios4 中自定义选项卡栏，您需要为我们制作自定义选项卡栏的代码不可用，您可以参考此 Que。

[如何自定义标签栏控制器](https://stackoverflow.com/questions/9990644/how-to-customize-the-tabbarcontroller)

或者你也可以像这样制作完整的标签栏图像来做简单的逻辑![在此处输入图像描述](../Images/467a8ed38c3dbd613e60563b24f96430.png)

在这里，我在 appdel did finish 方法上制作了一个图像视图，并在应用程序中完成了这样的操作。

```
self.imgV.frame=CGRectMake(0, 431, 320, 49);
[self.tabbarcontroller.view addSubview:self.imgV];

- (BOOL)tabBarController:(UITabBarController *)tabBarController shouldSelectViewController:(UIViewController *)viewController{
    NSUInteger index=[[tabBarController viewControllers] indexOfObject:viewController];
    NSString *deviceType = [UIDevice currentDevice].model;
    NSLog(@"Device%@",deviceType);

    if(UI_USER_INTERFACE_IDIOM()==UIUserInterfaceIdiomPad){
      //  self.imgV.frame=CGRectMake(0, 975, 768, 49);
        //[self.tabbarcontroller.view addSubview:self.imgV];

        switch (index) {
            case 0:
                self.imgV.image=[UIImage imageNamed:@"reservation_tab~iPad.png"];
                break;
            case 1:
                self.imgV.image=[UIImage imageNamed:@"place_order_tab~iPad.png"];
                break;
            case 2:
                self.imgV.image=[UIImage imageNamed:@"location_tab~iPad.png"];
                break;
            case 3:
                self.imgV.image=[UIImage imageNamed:@"favorite_tab~iPad.png"];
                break;
            case 4:

                self.imgV.image=[UIImage imageNamed:@"signature_dishes_tab~iPad.png"];

                break;
            case 5:
                self.imgV.image=[UIImage imageNamed:@"history_tab~iPad.png"];
                break;
            case 6:

                self.imgV.image=[UIImage imageNamed:@"contact_us_tab~iPad.png"];

                break;
            default:
                break;
        }

    }
    else{

    switch (index) {
        case 0:
            self.imgV.image=[UIImage imageNamed:@"reservation_tab.png"];
            break;
        case 1:
            self.imgV.image=[UIImage imageNamed:@"place_order_tab.png"];
            break;
        case 2:
            self.imgV.image=[UIImage imageNamed:@"location_tab.png"];
            break;
        case 3:
            self.imgV.image=[UIImage imageNamed:@"favorite_tab.png"];
            break;
        case 4:

                       self.imgV.image=[UIImage imageNamed:@"gallery_tab.png"];

            break;
        default:
            break;
    }
    }
    return YES;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-06T12:51:47.027

试试这个粘贴它.h文件

```
 #import <UIKit/UIKit.h>
    @class MapViewController,MenuViewController;
    @interface UITabBar (ColorExtensions)
    - (void)recolorItemsWithColor:(UIColor *)color shadowColor:(UIColor *)shadowColor shadowOffset:(CGSize)shadowOffset shadowBlur:(CGFloat)shadowBlur;
    @end

    @interface UITabBarItem (Private)
    @property(retain, nonatomic) UIImage *selectedImage;
    - (void)_updateView;
    @end

    @interface SegmentedControlExampleAppDelegate : NSObject <UIApplicationDelegate> {

        UIWindow * window;
        UINavigationController * navigationController;
        NSMutableArray *breads;
        NSMutableArray *categorys;
        NSMutableArray *collections;
        NSString *databaseName;
        NSString *databasePath;
        MapViewController *mapViewController;

        MenuViewController *wvTutorial;

    }

    @property (nonatomic, retain) IBOutlet UIWindow * window;
    @property (nonatomic, retain) UINavigationController * navigationController;
    @property (nonatomic,retain) NSMutableArray *breads;
    @property (nonatomic,retain) NSMutableArray *categorys;
    @property (nonatomic,retain) NSMutableArray *collections;
    @property (nonatomic, retain) UITabBarController *tabBarController;
    @property (nonatomic, retain) MenuViewController *wvTutorial;

    @end

In .m file

    #import "SegmentedControlExampleAppDelegate.h"
    #import "SegmentManagingViewController.h"
    #import "sqlite3.h"
    #import "AtoZHomePageViewController.h"
    #import "CategoryViewHomePage.h"
    #import "CollectionsListHomePageViewController.h"
    #import "AboutUs.h"
    #import "StoreLocatorViewController.h"
    #import "UINavigationBar+CustomImage.h"
    #import "MenuViewController.h"
    @implementation UITabBar (ColorExtensions)

    - (void)recolorItemsWithColor:(UIColor *)color shadowColor:(UIColor *)shadowColor shadowOffset:(CGSize)shadowOffset shadowBlur:(CGFloat)shadowBlur
    {
        CGColorRef cgColor = [color CGColor];
        CGColorRef cgShadowColor = [shadowColor CGColor];
        for (UITabBarItem *item in [self items])
            if ([item respondsToSelector:@selector(selectedImage)] &&
                [item respondsToSelector:@selector(setSelectedImage:)] &&
                [item respondsToSelector:@selector(_updateView)])
            {
                CGRect contextRect;
                contextRect.origin.x = 0.0f;
                contextRect.origin.y = 0.0f;
                contextRect.size = [[item selectedImage] size];
                // Retrieve source image and begin image context
                UIImage *itemImage = [item image];
                CGSize itemImageSize = [itemImage size];
                CGPoint itemImagePosition; 
                itemImagePosition.x = ceilf((contextRect.size.width - itemImageSize.width) / 2);
                itemImagePosition.y = ceilf((contextRect.size.height - itemImageSize.height) / 2);
                UIGraphicsBeginImageContext(contextRect.size);
                CGContextRef c = UIGraphicsGetCurrentContext();
                // Setup shadow
                CGContextSetShadowWithColor(c, shadowOffset, shadowBlur, cgShadowColor);

                // Setup transparency layer and clip to mask
                CGContextBeginTransparencyLayer(c, NULL);
                CGContextScaleCTM(c, 1.0, -1.0);
                CGContextClipToMask(c, CGRectMake(itemImagePosition.x, -itemImagePosition.y, itemImageSize.width, -itemImageSize.height), [itemImage CGImage]);

                           // Fill and end the transparency layer
                CGContextSetFillColorWithColor(c, cgColor);
                contextRect.size.height = -contextRect.size.height;
                CGContextFillRect(c, contextRect);
                CGContextEndTransparencyLayer(c);

                // Set selected image and end context
                [item setSelectedImage:UIGraphicsGetImageFromCurrentImageContext()];
                UIGraphicsEndImageContext();
                // Update the view
                [item _updateView];

            }

    }
    @end

    @implementation SegmentedControlExampleAppDelegate

    @synthesize window,tabBarController, navigationController,breads,categorys,collections,wvTutorial;

    - (BOOL)application:(UIApplication *)application didFinishLaunchingWithOptions:(NSDictionary *)launchOptions {
        databaseName = @"ProductsConnect_Master.sqlite";

        NSArray *documentPaths = NSSearchPathForDirectoriesInDomains(NSDocumentDirectory, NSUserDomainMask, YES);
        NSString *documentsDir = [documentPaths objectAtIndex:0];
        databasePath = [documentsDir stringByAppendingPathComponent:databaseName];

        self.tabBarController = [[UITabBarController alloc] init];
        UIViewController *viewController = [[AboutUs alloc] initWithNibName:@"AboutUs" bundle:nil];
        UIViewController *viewController2 = [[StoreLocatorViewController alloc] initWithNibName:@"StoreLocatorViewController" bundle:nil];
        //UIViewController *viewController3 = [[MenuViewController alloc] initWithNibName:@"MenuViewController" bundle:nil];

        self.wvTutorial = [[MenuViewController alloc]initWithNibName:@"MenuViewController" bundle:nil];

        SegmentManagingViewController * segmentManagingViewController = [[SegmentManagingViewController alloc] init];
        self.navigationController = [[UINavigationController alloc] initWithRootViewController:segmentManagingViewController];

        tabBarController.viewControllers = [NSArray arrayWithObjects:navigationController,viewController ,viewController2,wvTutorial , nil]; 

        [[UITabBar appearance] 
         setTintColor: [UIColor colorWithRed:120.0f/255.0f green:69.0f/255.0f blue:50.0f/255.0f alpha:1.0f]];
        [[UITabBar appearance] setSelectedImageTintColor:[UIColor colorWithRed:255.0f/255.0f green:252.0f/255.0f blue:235.0f/255.0f alpha:1.0f]];

        //[[UITabBar appearance] 

        // setBackgroundColor: [UIColor colorWithRed:255.0f/255.0f green:252.0f/255.0f blue:235.0f/255.0f alpha:0.8f]];

        navigationController.title = NSLocalizedString(@"HomePage", @"HomePage");
        navigationController.tabBarItem.image = [UIImage imageNamed:@"logoSmall"];

        [[UIApplication sharedApplication] setStatusBarHidden:YES];

        UIImage *navImage = [UIImage imageNamed:@"logoSmall.png"];
        // self.navigationItem.setImage: navImage;

        [[navigationController navigationBar] performSelectorInBackground:@selector(setBackgroundImage:) withObject:navImage];

        // UIImage *navImage = [UIImage imageNamed:@"logoSmall.png"];
        //[[navigationController navigationBar] performSelectorInBackground:@selector(setBackgroundImage:) withObject:navImage];

        [self.window addSubview:tabBarController.view];
        [segmentManagingViewController release];
        //[window addSubview:self.navigationController.view];
        [window makeKeyAndVisible];

        return YES;
    } 
```

我已经使用此代码对我来说很好。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-06T09:16:56.067

在**AppDelegate.m**文件中，添加以下代码。在那段代码中，我们创建了四个视图并将它们添加到选项卡控制器中。这些视图现在是空的，因为对于这个项目，我们不需要其中的任何内容。

```
- (BOOL)application:(UIApplication *)application didFinishLaunchingWithOptions:(NSDictionary *)launchOptions

{

    self.window = [[UIWindow alloc] initWithFrame:[[UIScreen mainScreen] bounds]];

    UITabBarController *tabController = [[UITabBarController alloc] init];  

    UIViewController *viewController1 = [[UIViewController alloc] init];  

    UIViewController *viewController2 = [[UIViewController alloc] init];  

    UIViewController *viewController3 = [[UIViewController alloc] init];    

    UIViewController *viewController4 = [[UIViewController alloc] init];  

    tabController.viewControllers = [NSArray arrayWithObjects:viewController1, 

                                     viewController2, 

                                     viewController3, 

                                     viewController4, nil];

    self.window.rootViewController = tabController;  

    [self.window makeKeyAndVisible];

    return YES;

} 
```

[你可以在这里](http://ios-blog.co.uk/tutorials/how-to-customize-the-tab-bar-using-ios-5-appearance-api/)看到一个很好的教程

# jquery - 我想发布数据并在浏览器上显示服务器发送的 http 响应，但我卡在浏览器上，没有显示任何内容

> ID：13247688
> 
> 赞同：6
> 
> 时间：2012-11-06T09:05:12.493
> 
> 标签：jquery, html, post, http-post

我想发布数据并在浏览器上显示服务器发送的 http 响应，但我卡在浏览器上，没有显示任何内容

我通过 Wire Shark 检查了服务器正在发送 json 响应，但浏览器上没有显示任何内容，我想获取响应正文并对其进行解析，然后将其显示给用户。

是否有任何方法可以获取表单详细信息，然后将其包装在变量上并将其发布到服务器

```
<!DOCTYPE html>
<html>
<head>
    <script src="http://code.jquery.com/jquery-latest.js"></script>
    <script>
        $(document).ready(function(){
            $("button").click(function(){
                $.post(
                    "http://192.168.0.135:8080/uid",
                    {
                        "type" : "CREATE_ACCOUNT",
                        "data" : '{ "hardwareID" : "SAM1234567890123", "name" : "Jain", "emailID" : "jain@gmail.com", "password" : "dgbedbeifkfk" }'
                    },
                    function(data,status) {
                        alert("Data: " + data + "\nStatus: " + status);
                    }
                );
            });
        });
    </script>
</head>

<body>
    <button>Send an HTTP POST request to a page and get the result back</button>
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-06T09:12:59.553

只是让您知道，您的 JSON 无效，这是您的 JSON 的正确版本：

```
{
    "type": "CREATE_ACCOUNT",
    "data": {
        "hardwareID": "SAM1234567890123",
        "name": "Jain",
        "emailID": "jain@gmail.com",
        "password": "dgbedbeifkfk"
    }
} 
```

删除“数据”行中 { 前面的 '。

我强烈建议您在搜索其他错误之前通过[jsonLint.com](http://jsonlint.com/)**验证**您的 JSON 。

# typo3 - TYPO3：直接邮件的调度程序不起作用

> ID：13247694
> 
> 赞同：0
> 
> 时间：2012-11-06T09:05:26.823
> 
> 标签：typo3

我已经安装了 TYPO3 扩展“direct_mail”，并且我试图将调度程序配置为自动调用邮件引擎，但任务不断延迟（显示黄色按钮），并且从未真正起作用。我错过了什么？

**定时任务：**

*/15 * * * * /html/cronjobs/scheduler.sh

**调度程序.sh：**

```
#!/bin/bash
php_cli /home/www/pXXXXXX/html/typo3/typo3/cli_dispatch.phpsh scheduler 
```

**调度器：** ![在此处输入图像描述](../Images/07b5626ed87cf8b30a54a167306582c7.png)

**设置检查：** ![在此处输入图像描述](../Images/ec12f8eb5aa410bf4483148ee52b8d4d.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-06T09:38:45.860

我只是猜测您没有配置调度程序。一般来说，Scheduler 是一个扩展，它允许您轻松运行 TYPO3 任务，但是您需要从系统 cron 调用 Scheduler 才能使其工作。清单：

*   在`ADMIN TOOLS`>`Scheduler`从上方选择中选择“设置检查”
*   如果您没有创建`_cli_scheduler`BE 帐户，请确保第二个框架是绿色的 - 这是必需的
*   在第三个框 ( `CLI script`) 中有一个命令从命令行运行调度程序， `/Absolute/path/to/your/typo3-instance/typo3/cli_dispatch.phpsh scheduler` 复制它并在终端中运行，以检查它是否工作
*   如果一切正常，将该行添加到您的系统 cron 并设置一些时间段（即：每 5 分钟）
*   为您的 DM 任务设置新的时间并在 5 分钟后进行控制，如果最后一次执行是使用 cron 完成的（在您的屏幕截图中，目前它是“手动”）

# c++ - 在重叠处分割轮廓

> ID：13247697
> 
> 赞同：0
> 
> 时间：2012-11-06T09:05:37.490
> 
> 标签：c++, image-processing, opencv

我有一个图像，我用第一个）cvCanny 和第二个）findContours 提取了几个轮廓。我只对外部点感兴趣，所以我得到了几个我做进一步分析的闭合轮廓。我正在寻找椭圆或圆形，由于图像中有一些重叠，我得到了一些对我来说实际上很有趣的轮廓，但我的算法丢弃了它们，因为它们看起来不是椭圆的。
有没有办法划分这些轮廓，例如基于检测为一个的两个重叠轮廓之间的小连接“桥梁”？

![示例轮廓](../Images/02fe59032ee8209d48e51ced6861e628.png)

在这个例子中，我只想切割右下角的杆。
由于性能问题，霍夫圆检测不是一种选择。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-06T09:37:30.487

以前从未使用过这类算法，但这里有一个想法：定义点之间的最小长度 L，小于您想要创建桥梁的长度。然后对于轮廓上的每个点，构造长度为 L 的切线段，其原点位于该点。无论该切线段与两点相交*的*何处，您都会有一个轮廓被有效地“挤压”的地方，就像您图中的杆/椭圆连接处一样。发生这种情况时，请绘制桥，这将是切线段本身。

如果您在单个点（例如在曲线的顶部，朝向左侧）取一个段，然后围绕轮廓移动该段，沿着在线创建的桥移动它，则可能更容易想象或做满足以上条件。

# android - 如何在android中的QR码中添加徽标

> ID：13247701
> 
> 赞同：9
> 
> 时间：2012-11-06T09:05:56.420
> 
> 标签：android, zxing

我在中心看到了一些带有公司徽标的二维码。是否可以在android中生成带有任何徽标的QR码？如果可能的话，请解释这样做的方式。目前我正在使用 Zxing 生成二维码。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-06T09:09:52.657

二维码是一种快速响应码，您可以使用[zxing](http://code.google.com/p/zxing/)制作二维码。但默认情况下，中心或任何其他部分没有公司徽标。您可以做的是**创建一个二维码并在其上绘制公司的徽标图像**

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2014-05-23T12:32:54.873

参考[生成带有徽标的二维码中](http://skrymerdev.wordpress.com/2012/09/22/qr-code-generation-with-zxing/)提供的指南和源代码， 请找到我用来在 Android 上实现类似结果的示例 Android 代码。

我确信可以优化此代码，特别是通过使用 Paint 类来优化图像覆盖不透明度，但此代码在这方面有效。

```
 /**
 * Writes the given Overlay on a new Bitmap object.
 * @param Bitmap the Bitmap to overlay.
 * @return the new {@link Bitmap}-object.
 */ 
public static Bitmap overlayBitmap(Bitmap overlay) {        
    BitMatrix matrix = null;
    QRCodeWriter writer = new QRCodeWriter();

    //Error correction

    //Sometimes your QRCode will get damaged or covered up by something – like an image overlay for instance – 
    //therefore the designers of the QRCode has added four levels; 7% (L), 15 % (M), 25% (Q), 30% (H) of error 
    //correction were a error correction of level H should result in a QRCode that are still valid even when it’s 
    //30% obscured – for more info on error correction check this       

    Map<EncodeHintType,  Object> hints; 

    hints = new HashMap<EncodeHintType, Object>();
            hints.put(EncodeHintType.ERROR_CORRECTION, ErrorCorrectionLevel.H);             

    //create qr code matrix
    writer = new  QRCodeWriter();
    try {
        matrix = writer.encode(redirectUrl, 
                                 BarcodeFormat.QR_CODE,
                                 QRCODE_IMAGE_WIDTH,
                                 QRCODE_IMAGE_HEIGHT,
                                 hints);
    } catch (WriterException e) {
        // TODO Auto-generated catch block
        e.printStackTrace();
    } 

    Bitmap image = toBitmap(matrix);
    int height = image.getHeight();
    int width = image.getWidth();

    Bitmap combined = Bitmap.createBitmap(width, height, image.getConfig());

    Canvas canvas = new Canvas(combined);
    int canvasWidth = canvas.getWidth();
    int canvasHeight = canvas.getHeight();

    canvas.drawBitmap(image, new Matrix(), null);

    int centreX = (canvasWidth  - overlay.getWidth()) /2;
    int centreY = (canvasHeight - overlay.getHeight()) /2 ; 

    //http://stackoverflow.com/a/12235235/1635441
    //http://stackoverflow.com/a/5119093/1635441        
    //Paint p = new Paint();
    //p.setXfermode(new PorterDuffXfermode(Mode.DST_ATOP)); //http://stackoverflow.com/a/17553502/1635441
    //p.setAlpha(180);
    //p.setARGB(a, r, g, b);

    //canvas.drawBitmap(bitmapToBeOverlay, 0, 0, p);        

    //canvas.drawBitmap(overlay, new Matrix(), null);
    canvas.drawBitmap(overlay, centreX, centreY, null);

    return combined;
}

    /**
 * Writes the given Matrix to a new colour Bitmap object.
 * @param matrix the matrix to write.
 * @param Color the Color to be added.
 * @return the new {@link Bitmap}-object.
 */
public static Bitmap toBitmapColour(BitMatrix matrix, int colour){
    int height = matrix.getHeight();
    int width = matrix.getWidth();
    Bitmap bmp = Bitmap.createBitmap(width, height, Bitmap.Config.RGB_565);
    for (int x = 0; x < width; x++){
        for (int y = 0; y < height; y++){
            bmp.setPixel(x, y, matrix.get(x,y) ? colour : Color.WHITE);
        }
    }
    return bmp;
} 
```

高温高压

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2017-04-04T02:56:23.590

这是一个技巧，实际上您的 QR 码生成器（如果您使用 zxing）返回一个位图值，因此您可以将您的*QR 码位图*与您的*徽标位*图合并，这是一个示例：

首先，您必须有 void 合并两个位图并调整徽标大小，以便您可以将其放在 QR 码的中心

```
 public Bitmap mergeBitmaps(Bitmap logo, Bitmap qrcode) {

    Bitmap combined = Bitmap.createBitmap(qrcode.getWidth(), qrcode.getHeight(), qrcode.getConfig());
    Canvas canvas = new Canvas(combined);
    int canvasWidth = canvas.getWidth();
    int canvasHeight = canvas.getHeight();
    canvas.drawBitmap(qrcode, new Matrix(), null);

    Bitmap resizeLogo = Bitmap.createScaledBitmap(logo, canvasWidth / 5, canvasHeight / 5, true);
    int centreX = (canvasWidth - resizeLogo.getWidth()) /2;
    int centreY = (canvasHeight - resizeLogo.getHeight()) / 2;
    canvas.drawBitmap(resizeLogo, centreX, centreY, null);
    return combined;
} 
```

然后你使用那​​个空白来合并你的二维码位图和你的标志位图，并将它推到你的图像视图中

```
 Bitmap yourLogo = BitmapFactory.decodeResource(getResources(), R.drawable.your_logo);
 Bitmap merge = mergeBitmaps(yourLogo, qrcode_bitmap);
 yourImageView.setImageBitmap(merge); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-11-28T08:50:44.267

您可以在中心制作带有背景徽标的二维码

首先使用以下代码制作一个 QRCodeEncoder 类：

```
public final class QRCodeEncoder {
private static final int WHITE = 0xFFFFFFFF;
private static final int BLACK = 0xFF000000;
private int dimension = Integer.MIN_VALUE;
private String contents = null;
private String displayContents = null;
private String title = null;
private BarcodeFormat format = null;
private boolean encoded = false;

public QRCodeEncoder(String data, Bundle bundle, String type,
        String format, int dimension) {
    this.dimension = dimension;
    encoded = encodeContents(data, bundle, type, format);
}

public String getContents() {
    return contents;
}

public String getDisplayContents() {
    return displayContents;
}

public String getTitle() {
    return title;
}

private boolean encodeContents(String data, Bundle bundle, String type,
        String formatString) {
    // Default to QR_CODE if no format given.
    format = null;
    if (formatString != null) {
        try {
            format = BarcodeFormat.valueOf(formatString);
        } catch (IllegalArgumentException iae) {
            // Ignore it then
        }
    }
    if (format == null || format == BarcodeFormat.QR_CODE) {
        this.format = BarcodeFormat.QR_CODE;
        encodeQRCodeContents(data, bundle, type);
    } else if (data != null && data.length() > 0) {
        contents = data;
        displayContents = data;
        title = "Text";
    }
    return contents != null && contents.length() > 0;
}

private void encodeQRCodeContents(String data, Bundle bundle, String type) {
    if (type.equals(Contents.Type.TEXT)) {
        if (data != null && data.length() > 0) {
            contents = data;
            displayContents = data;
            title = "Text";
        }
    } else if (type.equals(Contents.Type.EMAIL)) {
        data = trim(data);
        if (data != null) {
            contents = "mailto:" + data;
            displayContents = data;
            title = "E-Mail";
        }
    } else if (type.equals(Contents.Type.PHONE)) {
        data = trim(data);
        if (data != null) {
            contents = "tel:" + data;
            displayContents = PhoneNumberUtils.formatNumber(data);
            title = "Phone";
        }
    } else if (type.equals(Contents.Type.SMS)) {
        data = trim(data);
        if (data != null) {
            contents = "sms:" + data;
            displayContents = PhoneNumberUtils.formatNumber(data);
            title = "SMS";
        }
    } else if (type.equals(Contents.Type.CONTACT)) {
        if (bundle != null) {
            StringBuilder newContents = new StringBuilder(100);
            StringBuilder newDisplayContents = new StringBuilder(100);

            newContents.append("MECARD:");

            String name = trim(bundle
                    .getString(ContactsContract.Intents.Insert.NAME));
            if (name != null) {
                newContents.append("N:").append(escapeMECARD(name))
                        .append(';');
                newDisplayContents.append(name);
            }

            String address = trim(bundle
                    .getString(ContactsContract.Intents.Insert.POSTAL));
            if (address != null) {
                newContents.append("ADR:").append(escapeMECARD(address))
                        .append(';');
                newDisplayContents.append('\n').append(address);
            }

            Collection<String> uniquePhones = new HashSet<String>(
                    Contents.PHONE_KEYS.length);
            for (int x = 0; x < Contents.PHONE_KEYS.length; x++) {
                String phone = trim(bundle
                        .getString(Contents.PHONE_KEYS[x]));
                if (phone != null) {
                    uniquePhones.add(phone);
                }
            }
            for (String phone : uniquePhones) {
                newContents.append("TEL:").append(escapeMECARD(phone))
                        .append(';');
                newDisplayContents.append('\n').append(
                        PhoneNumberUtils.formatNumber(phone));
            }

            Collection<String> uniqueEmails = new HashSet<String>(
                    Contents.EMAIL_KEYS.length);
            for (int x = 0; x < Contents.EMAIL_KEYS.length; x++) {
                String email = trim(bundle
                        .getString(Contents.EMAIL_KEYS[x]));
                if (email != null) {
                    uniqueEmails.add(email);
                }
            }
            for (String email : uniqueEmails) {
                newContents.append("EMAIL:").append(escapeMECARD(email))
                        .append(';');
                newDisplayContents.append('\n').append(email);
            }

            String url = trim(bundle.getString(Contents.URL_KEY));
            if (url != null) {
                // escapeMECARD(url) -> wrong escape e.g.
                // http\://zxing.google.com
                newContents.append("URL:").append(url).append(';');
                newDisplayContents.append('\n').append(url);
            }

            String note = trim(bundle.getString(Contents.NOTE_KEY));
            if (note != null) {
                newContents.append("NOTE:").append(escapeMECARD(note))
                        .append(';');
                newDisplayContents.append('\n').append(note);
            }

            // Make sure we've encoded at least one field.
            if (newDisplayContents.length() > 0) {
                newContents.append(';');
                contents = newContents.toString();
                displayContents = newDisplayContents.toString();
                title = "Contact";
            } else {
                contents = null;
                displayContents = null;
            }

        }
    } else if (type.equals(Contents.Type.LOCATION)) {
        if (bundle != null) {
            // These must use Bundle.getFloat(), not getDouble(), it's part
            // of the API.
            float latitude = bundle.getFloat("LAT", Float.MAX_VALUE);
            float longitude = bundle.getFloat("LONG", Float.MAX_VALUE);
            if (latitude != Float.MAX_VALUE && longitude != Float.MAX_VALUE) {
                contents = "geo:" + latitude + ',' + longitude;
                displayContents = latitude + "," + longitude;
                title = "Location";
            }
        }
    }
}

public Bitmap encodeAsBitmap() throws WriterException {
    if (!encoded)
        return null;

    Hashtable hints = null;
    String encoding = guessAppropriateEncoding(contents);
    if (encoding != null) {
        hints = new Hashtable();
        hints.put(EncodeHintType.CHARACTER_SET, encoding);
    }
    MultiFormatWriter writer = new MultiFormatWriter();
    ByteMatrix result = writer.encode(contents, format, dimension,dimension, hints);
    int width = result.getWidth();
    int height = result.getHeight();
    int[] pixels = new int[width * height];
    // All are 0, or black, by default
    for (int y = 0; y < height; y++) {
        int offset = y * width;
        for (int x = 0; x < width; x++) {

            if (result.get(x, y) == 0) {
                pixels[offset + x] = BLACK;
            }       
        }
    }

    Bitmap bitmap = Bitmap.createBitmap(width, height,
            Bitmap.Config.ARGB_8888);
    bitmap.setPixels(pixels, 0, width, 0, 0, width, height);
    return bitmap;
}

private static String guessAppropriateEncoding(CharSequence contents) {
    // Very crude at the moment
    for (int i = 0; i < contents.length(); i++) {
        if (contents.charAt(i) > 0xFF) {
            return "UTF-8";
        }
    }
    return null;
}

private static String trim(String s) {
    if (s == null) {
        return null;
    }
    String result = s.trim();
    return result.length() == 0 ? null : result;
}

private static String escapeMECARD(String input) {
    if (input == null || (input.indexOf(':') < 0 && input.indexOf(';') < 0)) {
        return input;
    }
    int length = input.length();
    StringBuilder result = new StringBuilder(length);
    for (int i = 0; i < length; i++) {
        char c = input.charAt(i);
        if (c == ':' || c == ';') {
            result.append('\\');
        }
        result.append(c);
    }
    return result.toString();
} 
```

}

比在您想要制作带有图像的 QR 码的愿望活动中使用波纹管代码：

```
 private Bitmap generateQRCode(String encryptData) {
// here encryptData data will be your data
    WindowManager manager = (WindowManager) this.getSystemService(Context.WINDOW_SERVICE);
    Display display = manager.getDefaultDisplay();
    Point point = new Point();
    display.getSize(point);
    int width = point.x;
    int height = point.y;
    int smallerDimension = width < height ? width : height;
    smallerDimension = smallerDimension * 3 / 4;

    // Encode with a QR Code image
    QRCodeEncoder qrCodeEncoder = new QRCodeEncoder(encryptData, null, Contents.Type.TEXT, BarcodeFormat.QR_CODE.toString(), smallerDimension);
    Bitmap bitmap = null;
    Bitmap bitMerged = null;
    try {
        bitmap = qrCodeEncoder.encodeAsBitmap();
        Bitmap myLogo = BitmapFactory.decodeResource(getResources(), R.drawable.pay365logo);
        bitMerged = mergeBitmaps(bitmap,myLogo);
    } catch (WriterException e) {
        e.printStackTrace();
    }

    return bitMerged;

}

public static Bitmap mergeBitmaps(Bitmap qrCode, Bitmap myLogo) {
    Bitmap bmOverlay = Bitmap.createBitmap(qrCode.getWidth(), qrCode.getHeight(), qrCode.getConfig());
    Canvas canvas = new Canvas(bmOverlay);
    canvas.drawBitmap(myLogo, (qrCode.getWidth() - myLogo.getWidth()) / 2, (qrCode.getHeight() - myLogo.getHeight()) / 2, null);
    canvas.drawBitmap(qrCode, new Matrix(), null);
    return bmOverlay;
} 
```

它会是这样的： [![会是这样](../Images/941f40278711d9a845c3668e0ba70480.png)](https://i.stack.imgur.com/F5hPR.jpg)

# java - 代码在 localhost 上运行良好，但在远程服务器上运行良好

> ID：13247702
> 
> 赞同：0
> 
> 时间：2012-11-06T09:06:04.060
> 
> 标签：java, hibernate, session, tomcat, struts2

我有android经验，但不熟悉hibernate和advanced java。但我必须解决这个问题。请提出建议。

问题是，下面的代码在我的 tomcat 本地主机服务器上运行良好。但显示远程服务器上的错误。当我登录时，它说“无效登录”尝试使用相同的 id 密码登录两次或三次。

```
public String Login() {
        boolean isValidUser = applicationManager.isValidUser(getUserName(), getUserPassword());

        if (isValidUser == false) {
            if (getLang()!=null && getLang().equals("de")) {
                setLang("de");
                addActionMessage("Ungültige Anmeldung");
            } else {
                setLang("en");
                addActionMessage("Invalid login");
            }
            return ERROR;
        } else { 
            session = ActionContext.getContext().getSession();
            session.put("loggedIn","true");
            session.put("userName", getUserName());
            session.put("userPassword", getUserPassword());

            try {

                HttpSession session1;
                session1 = ServletActionContext.getRequest().getSession();
                session1.setAttribute("lang", getLang());
                session1.setAttribute("loggedIn", "true");
                session1.setAttribute("userName", getUserName());
                session1.setAttribute("userPassword", getUserPassword());
            } catch(Exception e) {
                System.out.println(e);
                e.printStackTrace();
            }
            this.countryList = applicationManager.getCountries();
            return SUCCESS;
        }
    } 
```

HibernateUtil.java：

```
public class HibernateUtil {

    private static final SessionFactory sessionFactory = buildSessionFactory();

    private static SessionFactory buildSessionFactory(){
        try{
            // create session factory from hibernate.cfg.xml
            return new AnnotationConfiguration().configure().buildSessionFactory();
        }catch(Throwable ex){
            System.err.println("Initial SessionFactory creation failed." + ex);
            throw new ExceptionInInitializerError(ex);
        }
    }

    public static SessionFactory getSessionFactory(){
        return sessionFactory;
    }
} 
```

用户管理器.java：

```
public class UserManager extends HibernateUtil{

    public ArrayList<User> validateUser(String userName,String userPassword){
        Session session = HibernateUtil.getSessionFactory().getCurrentSession();
        session.beginTransaction();
        ArrayList<User> userList =  new ArrayList<User>();
        try{
            Query query = session.createQuery("from User where userName=:userName and userPassword=:userPassword");
            query.setString("userName", userName);
            query.setString("userPassword", userPassword);
            for(Iterator itr = query.iterate();itr.hasNext();){
                User user = (User) itr.next();
                userList.add(user);
            }
            return userList;
        }catch(HibernateException he){
            he.printStackTrace();
            session.getTransaction().rollback();
        }
        session.getTransaction().commit();
        return userList; 
    }
} 
```

Hibernate.cfg.xml 看起来像这样：

> ```
>  <hibernate-configuration>
>       <session-factory>
>           <property name="connection.driver_class">
>               com.mysql.jdbc.Driver
>           </property>
> 
>           <property name="connection.url">
>               jdbc:mysql://xxxxx/xxxxx
>           </property>
> 
>           <property name="connection.username">samir</property>
>           <property name="connection.password">samir</property>
>           <property name="c3p0.acquire_increment">1</property> 
>           <property name="c3p0.idle_test_period">100</property> <!-- seconds --> 
>           <property name="c3p0.max_size">100</property> 
>           <property name="c3p0.max_statements">0</property> 
>           <property name="c3p0.min_size">10</property> 
>           <property name="c3p0.timeout">100</property> <!-- seconds -->               
>           <property name="dialect">
>               org.hibernate.dialect.MySQLDialect
>           </property>
>           <property name="current_session_context_class">thread</property>
>           <property name="cache.provider_class">
>               org.hibernate.cache.NoCacheProvider
>           </property>
>           <property name="show_sql">true</property>
>           <property name="hibernate.use_sql_comments">true</property>
> 
>           <property name="hbm2ddl.auto">update</property>
> 
>           <mapping class="login.model.User" />
> 
>       </session-factory>
>     </hibernate-configuration> 
> ```

日志 ：

```
 Hibernate: /* from User where userName=:userName and userPassword=:userPassword */ select user0_.USER_ID as col_0_0_ from users user0_ where user0_.USER_NAME=? and user0_.USER_PASSWORD=?
org.hibernate.exception.JDBCConnectionException: could not execute query using iterate
    at org.hibernate.exception.SQLStateConverter.convert(SQLStateConverter.java:97)
    at org.hibernate.exception.JDBCExceptionHelper.convert(JDBCExceptionHelper.java:66)
    at org.hibernate.loader.hql.QueryLoader.iterate(QueryLoader.java:450)
    at org.hibernate.hql.ast.QueryTranslatorImpl.iterate(QueryTranslatorImpl.java:403)
    at org.hibernate.engine.query.HQLQueryPlan.performIterate(HQLQueryPlan.java:248)
    at org.hibernate.impl.SessionImpl.iterate(SessionImpl.java:1219)
    at org.hibernate.impl.QueryImpl.iterate(QueryImpl.java:69)
    at application.controller.ApplicationManager.isValidUser(ApplicationManager.java:177)
    at application.view.ApplicationAction.Login(ApplicationAction.java:95)
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(Unknown Source)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(Unknown Source)
    at java.lang.reflect.Method.invoke(Unknown Source)
    at com.opensymphony.xwork2.DefaultActionInvocation.invokeAction(DefaultActionInvocation.java:440)
    at com.opensymphony.xwork2.DefaultActionInvocation.invokeActionOnly(DefaultActionInvocation.java:279)
    at com.opensymphony.xwork2.DefaultActionInvocation.invoke(DefaultActionInvocation.java:242)
    at com.opensymphony.xwork2.interceptor.DefaultWorkflowInterceptor.doIntercept(DefaultWorkflowInterceptor.java:163)
    at com.opensymphony.xwork2.interceptor.MethodFilterInterceptor.intercept(MethodFilterInterceptor.java:87)
    at com.opensymphony.xwork2.DefaultActionInvocation.invoke(DefaultActionInvocation.java:236)
    at com.opensymphony.xwork2.validator.ValidationInterceptor.doIntercept(ValidationInterceptor.java:249)
    at org.apache.struts2.interceptor.validation.AnnotationValidationInterceptor.doIntercept(AnnotationValidationInterceptor.java:68)
    at com.opensymphony.xwork2.interceptor.MethodFilterInterceptor.intercept(MethodFilterInterceptor.java:87)
    at com.opensymphony.xwork2.DefaultActionInvocation.invoke(DefaultActionInvocation.java:236)
    at com.opensymphony.xwork2.interceptor.ConversionErrorInterceptor.intercept(ConversionErrorInterceptor.java:122)
    at com.opensymphony.xwork2.DefaultActionInvocation.invoke(DefaultActionInvocation.java:236)
    at com.opensymphony.xwork2.interceptor.ParametersInterceptor.doIntercept(ParametersInterceptor.java:195)
    at com.opensymphony.xwork2.interceptor.MethodFilterInterceptor.intercept(MethodFilterInterceptor.java:87)
    at com.opensymphony.xwork2.DefaultActionInvocation.invoke(DefaultActionInvocation.java:236)
    at com.opensymphony.xwork2.interceptor.ParametersInterceptor.doIntercept(ParametersInterceptor.java:195)
    at com.opensymphony.xwork2.interceptor.MethodFilterInterceptor.intercept(MethodFilterInterceptor.java:87)
    at com.opensymphony.xwork2.DefaultActionInvocation.invoke(DefaultActionInvocation.java:236)
    at com.opensymphony.xwork2.interceptor.StaticParametersInterceptor.intercept(StaticParametersInterceptor.java:148)
    at com.opensymphony.xwork2.DefaultActionInvocation.invoke(DefaultActionInvocation.java:236)
    at org.apache.struts2.interceptor.CheckboxInterceptor.intercept(CheckboxInterceptor.java:93)
    at com.opensymphony.xwork2.DefaultActionInvocation.invoke(DefaultActionInvocation.java:236)
    at org.apache.struts2.interceptor.FileUploadInterceptor.intercept(FileUploadInterceptor.java:235)
    at com.opensymphony.xwork2.DefaultActionInvocation.invoke(DefaultActionInvocation.java:236)
    at com.opensymphony.xwork2.interceptor.ModelDrivenInterceptor.intercept(ModelDrivenInterceptor.java:89)
    at com.opensymphony.xwork2.DefaultActionInvocation.invoke(DefaultActionInvocation.java:236)
    at com.opensymphony.xwork2.interceptor.ScopedModelDrivenInterceptor.intercept(ScopedModelDrivenInterceptor.java:128)
    at com.opensymphony.xwork2.DefaultActionInvocation.invoke(DefaultActionInvocation.java:236)
    at org.apache.struts2.interceptor.ProfilingActivationInterceptor.intercept(ProfilingActivationInterceptor.java:104)
    at com.opensymphony.xwork2.DefaultActionInvocation.invoke(DefaultActionInvocation.java:236)
    at org.apache.struts2.interceptor.debugging.DebuggingInterceptor.intercept(DebuggingInterceptor.java:267)
    at com.opensymphony.xwork2.DefaultActionInvocation.invoke(DefaultActionInvocation.java:236)
    at com.opensymphony.xwork2.interceptor.ChainingInterceptor.intercept(ChainingInterceptor.java:126)
    at com.opensymphony.xwork2.DefaultActionInvocation.invoke(DefaultActionInvocation.java:236)
    at com.opensymphony.xwork2.interceptor.PrepareInterceptor.doIntercept(PrepareInterceptor.java:138)
    at com.opensymphony.xwork2.interceptor.MethodFilterInterceptor.intercept(MethodFilterInterceptor.java:87)
    at com.opensymphony.xwork2.DefaultActionInvocation.invoke(DefaultActionInvocation.java:236)
    at com.opensymphony.xwork2.interceptor.I18nInterceptor.intercept(I18nInterceptor.java:148)
    at com.opensymphony.xwork2.DefaultActionInvocation.invoke(DefaultActionInvocation.java:236)
    at org.apache.struts2.interceptor.ServletConfigInterceptor.intercept(ServletConfigInterceptor.java:164)
    at com.opensymphony.xwork2.DefaultActionInvocation.invoke(DefaultActionInvocation.java:236)
    at com.opensymphony.xwork2.interceptor.AliasInterceptor.intercept(AliasInterceptor.java:128)
    at com.opensymphony.xwork2.DefaultActionInvocation.invoke(DefaultActionInvocation.java:236)
    at com.opensymphony.xwork2.interceptor.ExceptionMappingInterceptor.intercept(ExceptionMappingInterceptor.java:176)
    at com.opensymphony.xwork2.DefaultActionInvocation.invoke(DefaultActionInvocation.java:236)
    at org.apache.struts2.impl.StrutsActionProxy.execute(StrutsActionProxy.java:52)
    at org.apache.struts2.dispatcher.Dispatcher.serviceAction(Dispatcher.java:468)
    at org.apache.struts2.dispatcher.FilterDispatcher.doFilter(FilterDispatcher.java:395)
    at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:235)
    at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)
    at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:233)
    at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:191)
    at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:128)
    at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:102)
    at org.apache.catalina.valves.AccessLogValve.invoke(AccessLogValve.java:567)
    at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:109)
    at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:293)
    at org.apache.coyote.http11.Http11Processor.process(Http11Processor.java:849)
    at org.apache.coyote.http11.Http11Protocol$Http11ConnectionHandler.process(Http11Protocol.java:583)
    at org.apache.tomcat.util.net.JIoEndpoint$Worker.run(JIoEndpoint.java:454)
    at java.lang.Thread.run(Unknown Source)
Caused by: com.mysql.jdbc.exceptions.jdbc4.MySQLNonTransientConnectionException: No operations allowed after connection closed.Connection was implicitly closed due to underlying exception/error:

** BEGIN NESTED EXCEPTION ** 

com.mysql.jdbc.exceptions.jdbc4.CommunicationsException
MESSAGE: Communications link failure

Last packet sent to the server was 47 ms ago.

STACKTRACE:

com.mysql.jdbc.exceptions.jdbc4.CommunicationsException: Communications link failure

Last packet sent to the server was 47 ms ago.
    at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)
    at sun.reflect.NativeConstructorAccessorImpl.newInstance(Unknown Source)
    at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(Unknown Source)
    at java.lang.reflect.Constructor.newInstance(Unknown Source)
    at com.mysql.jdbc.Util.handleNewInstance(Util.java:406)
    at com.mysql.jdbc.SQLError.createCommunicationsException(SQLError.java:1074)
    at com.mysql.jdbc.MysqlIO.reuseAndReadPacket(MysqlIO.java:2873)
    at com.mysql.jdbc.MysqlIO.reuseAndReadPacket(MysqlIO.java:2763)
    at com.mysql.jdbc.MysqlIO.checkErrorPacket(MysqlIO.java:3299)
    at com.mysql.jdbc.MysqlIO.sendCommand(MysqlIO.java:1837)
    at com.mysql.jdbc.MysqlIO.sqlQueryDirect(MysqlIO.java:1961)
    at com.mysql.jdbc.ConnectionImpl.execSQL(ConnectionImpl.java:2543)
    at com.mysql.jdbc.PreparedStatement.executeInternal(PreparedStatement.java:1737)
    at com.mysql.jdbc.PreparedStatement.executeQuery(PreparedStatement.java:1888)
    at org.hibernate.jdbc.AbstractBatcher.getResultSet(AbstractBatcher.java:208)
    at org.hibernate.loader.Loader.getResultSet(Loader.java:1808)
    at org.hibernate.loader.Loader.doQuery(Loader.java:697)
    at org.hibernate.loader.Loader.doQueryAndInitializeNonLazyCollections(Loader.java:259)
    at org.hibernate.loader.Loader.doList(Loader.java:2228)
    at org.hibernate.loader.Loader.listIgnoreQueryCache(Loader.java:2125)
    at org.hibernate.loader.Loader.list(Loader.java:2120)
    at org.hibernate.loader.hql.QueryLoader.list(QueryLoader.java:401)
    at org.hibernate.hql.ast.QueryTranslatorImpl.list(QueryTranslatorImpl.java:361)
    at org.hibernate.engine.query.HQLQueryPlan.performList(HQLQueryPlan.java:196)
    at org.hibernate.impl.SessionImpl.list(SessionImpl.java:1148)
    at org.hibernate.impl.QueryImpl.list(QueryImpl.java:102)
    at application.controller.ApplicationManager.getCountries(ApplicationManager.java:34)
    at application.view.ApplicationAction.execute(ApplicationAction.java:90)
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(Unknown Source)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(Unknown Source)
    at java.lang.reflect.Method.invoke(Unknown Source)
    at com.opensymphony.xwork2.DefaultActionInvocation.invokeAction(DefaultActionInvocation.java:440)
    at com.opensymphony.xwork2.DefaultActionInvocation.invokeActionOnly(DefaultActionInvocation.java:279)
    at com.opensymphony.xwork2.DefaultActionInvocation.invoke(DefaultActionInvocation.java:242)
    at com.opensymphony.xwork2.interceptor.DefaultWorkflowInterceptor.doIntercept(DefaultWorkflowInterceptor.java:163)
    at com.opensymphony.xwork2.interceptor.MethodFilterInterceptor.intercept(MethodFilterInterceptor.java:87)
    at com.opensymphony.xwork2.DefaultActionInvocation.invoke(DefaultActionInvocation.java:236)
    at com.opensymphony.xwork2.validator.ValidationInterceptor.doIntercept(ValidationInterceptor.java:249)
    at org.apache.struts2.interceptor.validation.AnnotationValidationInterceptor.doIntercept(AnnotationValidationInterceptor.java:68)
    at com.opensymphony.xwork2.interceptor.MethodFilterInterceptor.intercept(MethodFilterInterceptor.java:87)
    at com.opensymphony.xwork2.DefaultActionInvocation.invoke(DefaultActionInvocation.java:236)
    at com.opensymphony.xwork2.interceptor.ConversionErrorInterceptor.intercept(ConversionErrorInterceptor.java:122)
    at com.opensymphony.xwork2.DefaultActionInvocation.invoke(DefaultActionInvocation.java:236)
    at com.opensymphony.xwork2.interceptor.ParametersInterceptor.doIntercept(ParametersInterceptor.java:195)
    at com.opensymphony.xwork2.interceptor.MethodFilterInterceptor.intercept(MethodFilterInterceptor.java:87)
    at com.opensymphony.xwork2.DefaultActionInvocation.invoke(DefaultActionInvocation.java:236)
    at com.opensymphony.xwork2.interceptor.ParametersInterceptor.doIntercept(ParametersInterceptor.java:195)
    at com.opensymphony.xwork2.interceptor.MethodFilterInterceptor.intercept(MethodFilterInterceptor.java:87)
    at com.opensymphony.xwork2.DefaultActionInvocation.invoke(DefaultActionInvocation.java:236)
    at com.opensymphony.xwork2.interceptor.StaticParametersInterceptor.intercept(StaticParametersInterceptor.java:148)
    at com.opensymphony.xwork2.DefaultActionInvocation.invoke(DefaultActionInvocation.java:236)
    at org.apache.struts2.interceptor.CheckboxInterceptor.intercept(CheckboxInterceptor.java:93)
    at com.opensymphony.xwork2.DefaultActionInvocation.invoke(DefaultActionInvocation.java:236)
    at org.apache.struts2.interceptor.FileUploadInterceptor.intercept(FileUploadInterceptor.java:235)
    at com.opensymphony.xwork2.DefaultActionInvocation.invoke(DefaultActionInvocation.java:236)
    at com.opensymphony.xwork2.interceptor.ModelDrivenInterceptor.intercept(ModelDrivenInterceptor.java:89)
    at com.opensymphony.xwork2.DefaultActionInvocation.invoke(DefaultActionInvocation.java:236)
    at com.opensymphony.xwork2.interceptor.ScopedModelDrivenInterceptor.intercept(ScopedModelDrivenInterceptor.java:128)
    at com.opensymphony.xwork2.DefaultActionInvocation.invoke(DefaultActionInvocation.java:236)
    at org.apache.struts2.interceptor.ProfilingActivationInterceptor.intercept(ProfilingActivationInterceptor.java:104)
    at com.opensymphony.xwork2.DefaultActionInvocation.invoke(DefaultActionInvocation.java:236)
    at org.apache.struts2.interceptor.debugging.DebuggingInterceptor.intercept(DebuggingInterceptor.java:267)
    at com.opensymphony.xwork2.DefaultActionInvocation.invoke(DefaultActionInvocation.java:236)
    at com.opensymphony.xwork2.interceptor.ChainingInterceptor.intercept(ChainingInterceptor.java:126)
    at com.opensymphony.xwork2.DefaultActionInvocation.invoke(DefaultActionInvocation.java:236)
    at com.opensymphony.xwork2.interceptor.PrepareInterceptor.doIntercept(PrepareInterceptor.java:138)
    at com.opensymphony.xwork2.interceptor.MethodFilterInterceptor.intercept(MethodFilterInterceptor.java:87)
    at com.opensymphony.xwork2.DefaultActionInvocation.invoke(DefaultActionInvocation.java:236)
    at com.opensymphony.xwork2.interceptor.I18nInterceptor.intercept(I18nInterceptor.java:148)
    at com.opensymphony.xwork2.DefaultActionInvocation.invoke(DefaultActionInvocation.java:236)
    at org.apache.struts2.interceptor.ServletConfigInterceptor.intercept(ServletConfigInterceptor.java:164)
    at com.opensymphony.xwork2.DefaultActionInvocation.invoke(DefaultActionInvocation.java:236)
    at com.opensymphony.xwork2.interceptor.AliasInterceptor.intercept(AliasInterceptor.java:128)
    at com.opensymphony.xwork2.DefaultActionInvocation.invoke(DefaultActionInvocation.java:236)
    at com.opensymphony.xwork2.interceptor.ExceptionMappingInterceptor.intercept(ExceptionMappingInterceptor.java:176)
    at com.opensymphony.xwork2.DefaultActionInvocation.invoke(DefaultActionInvocation.java:236)
    at org.apache.struts2.impl.StrutsActionProxy.execute(StrutsActionProxy.java:52)
    at org.apache.struts2.dispatcher.Dispatcher.serviceAction(Dispatcher.java:468)
    at org.apache.struts2.dispatcher.FilterDispatcher.doFilter(FilterDispatcher.java:395)
    at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:235)
    at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)
    at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:233)
    at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:191)
    at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:128)
    at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:102)
    at org.apache.catalina.valves.AccessLogValve.invoke(AccessLogValve.java:567)
    at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:109)
    at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:293)
    at org.apache.coyote.http11.Http11Processor.process(Http11Processor.java:849)
    at org.apache.coyote.http11.Http11Protocol$Http11ConnectionHandler.process(Http11Protocol.java:583)
    at org.apache.tomcat.util.net.JIoEndpoint$Worker.run(JIoEndpoint.java:454)
    at java.lang.Thread.run(Unknown Source)
Caused by: java.io.EOFException: Can not read response from server. Expected to read 4 bytes, read 0 bytes before connection was unexpectedly lost.
    at com.mysql.jdbc.MysqlIO.readFully(MysqlIO.java:2332)
    at com.mysql.jdbc.MysqlIO.reuseAndReadPacket(MysqlIO.java:2774)
    ... 86 more

** END NESTED EXCEPTION **

    at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)
    at sun.reflect.NativeConstructorAccessorImpl.newInstance(Unknown Source)
    at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(Unknown Source)
    at java.lang.reflect.Constructor.newInstance(Unknown Source)
    at com.mysql.jdbc.Util.handleNewInstance(Util.java:406)
    at com.mysql.jdbc.Util.getInstance(Util.java:381)
    at com.mysql.jdbc.SQLError.createSQLException(SQLError.java:985)
    at com.mysql.jdbc.SQLError.createSQLException(SQLError.java:957)
    at com.mysql.jdbc.SQLError.createSQLException(SQLError.java:927)
    at com.mysql.jdbc.ConnectionImpl.checkClosed(ConnectionImpl.java:1113)
    at com.mysql.jdbc.ConnectionImpl.prepareStatement(ConnectionImpl.java:4038)
    at com.mysql.jdbc.ConnectionImpl.prepareStatement(ConnectionImpl.java:4004)
    at org.hibernate.jdbc.AbstractBatcher.getPreparedStatement(AbstractBatcher.java:534)
    at org.hibernate.jdbc.AbstractBatcher.getPreparedStatement(AbstractBatcher.java:452)
    at org.hibernate.jdbc.AbstractBatcher.prepareQueryStatement(AbstractBatcher.java:161)
    at org.hibernate.loader.Loader.prepareQueryStatement(Loader.java:1573)
    at org.hibernate.loader.hql.QueryLoader.iterate(QueryLoader.java:422)
    ... 71 more
org.hibernate.exception.JDBCConnectionException: could not execute query using iterate 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-06T11:39:06.570

（不是答案，而是一些代码注释。）

1) 用小写字母命名函数，例如：

```
public String login() { ... } 
```

2) 使用规范的 Java 检查布尔值，例如：

```
if (!isValidUser) { ... } 
```

3) 使用使规范代码正确“读取”的变量名称，例如：

```
if (!validUser) { ... } 
```

4) 在进行字符串比较时不再需要空值检查，例如：

```
if ("de".equals(getLang()) { ... } 
```

另外，我不清楚是否`setLang()`只是用`getLang()`;检索的内容的设置器。这有点令人困惑，并且在没有进一步知识的情况下使那段代码有点奇怪。

5) 不要将有效的用户代码放在同一个条件中；如果是无效用户，则将其视为特例并返回。然后将有效的用户代码与保护子句区分开来，例如：

```
if (!validUser) {
    // actionMessage stuff.
    return ERROR;
} 

session = ActionContext.getContext().getSession();
// The rest of valid user code. 
```

6）对布尔值使用布尔值，例如：

```
session.put("loggedIn", true); 
```

7) 对作用域变量使用常量，例如：

```
session = ActionContext.getContext().getSession();
session.put(SessionKeys.LOGGED_IN, true); 
```

8）使用`SessionAware`，它使测试更容易；`session`那么只是一个动作属性：

```
session.put(SessionKeys.LOGGED_IN, true); 
```

9）当它是完全不同的东西时不要命名`session1`......在这种情况下，它甚至不是不同的东西，所以你将相同的信息放入两次。

10) 访问动作属性时保持一致；不要使用`setXxx()` *and* `this.xxx`。`xxx`大多数情况下，无论如何您都可以使用。

```
setCountryList(applicationManager.getCountries()); // Or, my preference in most cases:
countryList = appManager.getCountries(); 
```

11) 不要按类型命名变量，除非在需要特别区分的情况下，例如：

```
countries = appManager.getCountries(); 
```

这给我们留下了一个更易于管理的：

```
public String Login() {
    if (!appManager.isValidUser(username, password)) {
        handleInvalidUser();
        return ERROR;
    } 

    session.put(SessionKeys.LANG,          lang);
    session.put(SessionKeys.LOGGED_IN,     true);
    session.put(SessionKeys.USER_NAME,     username);
    session.put(SessionKeys.USER_PASSWORD, password);

    countries = appManager.getCountries();

    return SUCCESS;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-06T09:39:32.690

您的远程服务器到 mysqlDB 服务器的连接问题（延迟响应）似乎

替换这个

```
for(Iterator itr = query.iterate();itr.hasNext();){
            User user = (User) itr.next();
            userList.add(user);
        }
        return userList; 
```

这样

```
return (ArrayList<User>)query.list(); 
```

试试看，可能对你有帮助

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-06T21:36:58.720

检查 mysql 日志：也许您达到了 mysql 用户与服务器允许的最大连接数。C3p0 max_size 必须小于服务器的最大连接数。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-06T16:52:58.913

我认为您的远程服务器和数据库之间存在通信问题，可能是防火墙。这将解释为什么它在您当地为您工作。确保您可以从远程应用服务器访问数据库服务器。

希望能帮助到你。

# c# - 是否可以获得 C# 对象地址的字符串表示形式？

> ID：13247705
> 
> 赞同：4
> 
> 时间：2012-11-06T09:06:17.117
> 
> 标签：c#, reference, identity

我正在尝试调试多线程代码的一些奇怪行为，我需要一些方法来可靠地跟踪对象身份。在 C++ 中，我只需获取对象地址并将它们转换为字符串，这样我就可以知道这两个地址是否属于同一个对象。

看起来[引用完全等同](https://stackoverflow.com/a/750958/57428)于 C# 中的 C++ 对象地址。

我可以将引用转换为字符串地址表示吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-06T09:18:17.783

您可以将引用转换为指针，然后转换为数字，但这不是在 C# 中跟踪对象的可靠方法，因为垃圾收集器可以随时更改引用。从引用中复制值后，您无法知道它仍然代表引用。

但是，您可以安全地比较参考。只要引用仍然是引用，垃圾收集器就会确保它是最新的。如果垃圾收集器移动了一个对象，它会更新对它的所有引用。

因此，您可以安全地将引用用作对象的标识，只要您将其保留为引用即可。您可以比较两个引用以查看它们是否指向同一个对象。

如果您将引用的值转换为不同的形式，您将获得当时引用的闪存副本。虽然查看该值可能仍然有用，但它不是 100% 可靠的，即仅仅因为两个引用的表示不同并不意味着它们不能指向同一个对象，因为引用可能在复制之间发生了变化第一个和第二个。

也就是说，您可以通过以下方式获取指向对象的指针并将其转换为`IntPtr`:

```
string str = "asdfasdf";
IntPtr p;

unsafe {
  // tell GC not to move the object, so that we can use a pointer to it
  fixed (void* ptr = str) {
    // here the object stays in place
    // make an IntPtr from the pointer, so we can keep it outside the fixed block
    p = new IntPtr(ptr);
  }
  // now the object can move again
}

Console.WriteLine(p); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-01-07T20:30:36.523

创建一个`ConditionalWeakTable<Object,String>`，并且任何时候您看到不在表中的每个对象都给它某种名称并将其存储在表中。然后，您可以轻松地使用表格打印出您以前见过的任何对象的名称。如果一个对象不复存在，表项就会消失，因此不必担心表中会填满与早已被遗弃的对象相关的信息。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-06T09:24:12.987

在某种程度上，您可以：

```
GCHandle.Alloc(obj, GCHandleType.Pinned).AddrOfPinnedObject().ToString(); 
```

请不要将此作为调试多线程应用程序的一种方式。按照达米安的指示去做。

# varnish - 如何读取 varnishtop 的输出？

> ID：13247707
> 
> 赞同：7
> 
> 时间：2012-11-06T09:06:36.727
> 
> 标签：varnish

使用 varnish-cache，我正在运行`varnishtop -c -i RxURL`以显示来自缓存的客户端请求数。输出看起来有点像这样：

```
list length 40                                                                                                                                                    

   121.76 RxURL          /some/path/to/file
   105.17 RxURL          /some/other/file
    42.91 RxURL          /and/another
    14.61 RxURL          /yet/another
    14.59 RxURL          /etc
    13.63 RxURL          /etc/etc 
```

数字`121.76`等`105.17`代表什么？

首次发布时它们正在增加`varnishtop`，但随后趋于稳定，因此我倾向于相信每个特定时间范围内的代表点击数。是这样吗，时间表是什么？

这在 中没有解释`man page`。感谢您的任何帮助！

**编辑**：清漆版本是`2.1`

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2013-03-21T13:57:45.230

该`varnishtop`命令显示 60 秒内的滚动聚合计数。这意味着即使所有交通都停止，显示屏上的平均下降也需要 60 秒。

> 列表长度 40

列表中的项目总数，因为屏幕一次只能显示这么多。

> 121.76 RxURL /some/path/to/file

在过去 60 秒内收到约 121 个请求`/some/path/to/file`。

其他一些有趣的监控统计数据：

```
# most frequent cookies
varnishtop -i RxHeader -I Cookie

# continually updated list of frequent URLs
varnishtop -i RxURL

# most frequent UA strings
varnishtop -i RxHeader -C -I ^User-Agent

# frequent charset (Accept-Charset can be replaced with any other HTTP header)
varnishtop -i RxHeader -C -I '^Accept-Charset'

# Requests resulting in 404's
varnishlog -b -m "RxStatus:404" 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-07T07:38:56.250

这是每 60 秒的平均请求数。手册确实说了 - 但在参数说明而不是工具的一般描述中：

`-p period Specifies the number of seconds to measure over, the default is 60 seconds. The first number in the list is the average number of requests seen over this time period.`

# c# - 从 Visual Studio 2010 解决方案中卸载 .vdproj（Visual Studio 部署项目）

> ID：13247710
> 
> 赞同：1
> 
> 时间：2012-11-06T09:06:43.477
> 
> 标签：c#, .net, visual-studio-2010, visual-studio, deployment-project

我有一个受源代码控制的解决方案，其中一个项目是 vdproj（Visual Studio 部署项目）或安装项目，每次我尝试构建解决方案时，这个项目都会给我带来非常烦人的数十条消息

```
---------------------------
Microsoft Visual Studio
---------------------------
The command you are attempting cannot be completed because the file 'XXXXInstaller.vdproj' is under source code control and is not checked out.
---------------------------
OK   Help   
--------------------------- 
```

![Visual Studio 错误消息 - VDProj 错误](../Images/55c07a3d7c4305163be24f36ae17e890.png)

问题是：如何从解决方案中卸载这个项目，当我尝试卸载它时，右键单击上下文菜单中没有这样的选项！

![在此处输入图像描述](../Images/bcb6acc8308c6055d800b9ecc1c6e8bb.png)

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-08-05T07:34:21.807

我发现[了 Microsoft Connect 上提出的问题](http://connect.microsoft.com/VisualStudio/feedback/details/288663/no-unload-project-on-context-menu-with-right-clicking-setup-project-in-solution-explorer)。似乎支持“卸载”，但只是未显示在上下文菜单中。换句话说，选择项目并使用普通的“项目”菜单（“查看”旁边）仍然显示“卸载项目”选项。

另一个想法：如果您将部署项目保存在解决方案文件夹中，您可以使用[Microsoft Productivity Power Tools](http://visualstudiogallery.msdn.microsoft.com/d0d33361-18e2-46c0-8ff2-4adea1e34fef)提供的上下文菜单中的“卸载解决方案文件夹中的所有项目” 。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-06T09:28:11.493

@MSS，作为一种解决方法，您可以通过注释相应的 .vdproj 项目来编辑解决方案文件。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2018-09-14T10:40:54.790

您还可以在解决方案资源管理器中选择多个项目（您至少可以卸载其中一个）并卸载它们。然后重新加载所需的项目。

# c# - 访问已加载的用户控件

> ID：13247713
> 
> 赞同：0
> 
> 时间：2012-11-06T09:06:58.280
> 
> 标签：c#, asp.net

我正在做一个 Asp.net 项目，我正在将两个用户控件加载到另一个 ascx 控件中。首先，我正在加载`control1.ascx`，然后是 control2。在将它们都加载到 control2.ascx 之后，我想访问一个重新加载 control1 的一些数据的函数。我正在使用以下代码进行操作：

```
 private ASP.control1_ascx tree; 
 tree = (ASP.control1_ascx)LoadControl("control1.ascx");
 tree.aload(); 
```

当我调试代码时，它似乎调用了 aload() 函数并更新了数据。但问题是在调用函数后我看不到它们，相反我可以在回发事件后看到正确的数据。为什么会出现这种情况？。当我调用函数时，有没有办法看到它们？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-06T16:30:42.210

您是否尝试过在每个用户控件中创建委托事件，然后使用它重新绑定数据？

在您的用户控件中：

```
public delegate void RefreshRequired(object sender, any other params to pass to event method)

public event OnRefreshRequired OnRefreshRequired; 
```

在你的 ASPX 的 Page_Load

```
UserControl.OnRefreshRequired+= TAB TWICE; 
```

在此方法中实现代码以刷新用户控件中的数据

# asp.net-mvc - jqGrid页面返回null

> ID：13247714
> 
> 赞同：1
> 
> 时间：2012-11-06T09:07:02.657
> 
> 标签：asp.net-mvc, jqgrid

我有 jqGrid 和动态数据绑定的问题。问题是，我总是为参数页面获取 Null。我正在使用 MVC3 和 jqGrid 4.4.1。

```
 var dataToSend = {
            mrpId: selPRid,
            mrpFilter: cookMainFilter,
            divId: randomId,
            chartId: chartId
        };

        $("#gridMeasurementsTableView" + randomId).jqGrid({
            url: '/DataMonitor/CreateMeasurementTableView/',
            datatype: "json",
            mtype: 'POST',
            postData: $.toDictionary(dataToSend),
            jsonReader : {
                root: "rows",
                page: "page",
                total: "total",
                records: "records",  
                repeatitems: false,
                cell: "cell",
                id: "id" 
               },  
            colNames: ['Date', 'Value'],
            colModel: [
                { name: 'Timestamp', index: 'Timestamp', width: 280, 
                    formatter: function (cellvalue, options, rowObject) {
                            return new Date(parseInt(cellvalue.substr(6, cellvalue.length - 8), 10));
                        }  
                },
                { name: 'Value', index: 'Value', width: 200, align: 'center' }  
            ],
            loadui: "disable",
            loadtext: "Loading",
            viewrecords: true,
            height: "100%",
            caption: "Measurements2",
            pager: $("#gridpager" + randomId),
            rowNum: 10,
            sortname: 'Value',
            sortorder: "asc",
            rowList: [10, 50, 100]
        }); 
```

获取数据的函数定义如下：

```
 public ActionResult CreateMeasurementTableView(string sidx, string sord, int page, int rows, int mrpId, FilterMRPParameters mrpFilter, string divId, string chartId) 
```

兄弟，一月

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-06T09:27:56.210

尝试更改`postData: $.toDictionary(dataToSend)`为`postData: dataToSend`.

# iphone - 如何将 iPod 作为快捷方式集成到我的应用程序中？

> ID：13247717
> 
> 赞同：-1
> 
> 时间：2012-11-06T09:07:10.690
> 
> 标签：iphone, integration, ipod

我想在我的应用程序中显示 iPod 作为快捷方式，方便用户点击它来调用真正的 iPod 应用程序。我该怎么做？我可以参考任何代码吗？谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-06T09:12:35.113

在 iOS 5 中，您可以调用：

```
if ([[UIApplication sharedApplication] canOpenURL:[NSURL URLWithString:@"music://"]]){     
    [[UIApplication sharedApplication] openURL:[NSURL URLWithString:@"music://"]];
    } 
```

# android - 如何解决android中的Sqlite Cursor异常

> ID：13247723
> 
> 赞同：-1
> 
> 时间：2012-11-06T09:07:31.463
> 
> 标签：android, sqlite, exception

成功获取数据后出现异常。我已**关闭光标**。

**例外-**

```
11-06 14:31:09.942: I/dalvikvm(598): Uncaught exception thrown by finalizer (will be discarded):
11-06 14:31:09.942: I/dalvikvm(598): Ljava/lang/IllegalStateException;: Finalizing cursor android.database.sqlite.SQLiteCursor@44c115b8 on null that has not been deactivated or closed
11-06 14:31:09.942: I/dalvikvm(598):    at android.database.sqlite.SQLiteCursor.finalize(SQLiteCursor.java:596)
11-06 14:31:09.942: I/dalvikvm(598):    at dalvik.system.NativeStart.run(Native Method)
11-06 14:31:09.942: I/dalvikvm(598): Uncaught exception thrown by finalizer (will be discarded):
11-06 14:31:09.942: I/dalvikvm(598): Ljava/lang/IllegalStateException;: Finalizing cursor android.database.sqlite.SQLiteCursor@44c10768 on null that has not been deactivated or closed
11-06 14:31:09.942: I/dalvikvm(598):    at android.database.sqlite.SQLiteCursor.finalize(SQLiteCursor.java:596)
11-06 14:31:09.942: I/dalvikvm(598):    at dalvik.system.NativeStart.run(Native Method)
11-06 14:31:09.942: I/dalvikvm(598): Uncaught exception thrown by finalizer (will be discarded):
11-06 14:31:09.942: I/dalvikvm(598): Ljava/lang/IllegalStateException;: Finalizing cursor android.database.sqlite.SQLiteCursor@44c0f918 on null that has not been deactivated or closed
11-06 14:31:09.942: I/dalvikvm(598):    at android.database.sqlite.SQLiteCursor.finalize(SQLiteCursor.java:596)
11-06 14:31:09.942: I/dalvikvm(598):    at dalvik.system.NativeStart.run(Native Method)
11-06 14:31:09.942: I/dalvikvm(598): Uncaught exception thrown by finalizer (will be discarded):
11-06 14:31:09.942: I/dalvikvm(598): Ljava/lang/IllegalStateException;: Finalizing cursor android.database.sqlite.SQLiteCursor@44c0df08 on null that has not been deactivated or closed
11-06 14:31:09.942: I/dalvikvm(598):    at android.database.sqlite.SQLiteCursor.finalize(SQLiteCursor.java:596)
11-06 14:31:09.942: I/dalvikvm(598):    at dalvik.system.NativeStart.run(Native Method)
11-06 14:31:09.942: I/dalvikvm(598): Uncaught exception thrown by finalizer (will be discarded):
11-06 14:31:09.942: I/dalvikvm(598): Ljava/lang/IllegalStateException;: Finalizing cursor android.database.sqlite.SQLiteCursor@44c0c990 on null that has not been deactivated or closed
11-06 14:31:09.942: I/dalvikvm(598):    at android.database.sqlite.SQLiteCursor.finalize(SQLiteCursor.java:596)
11-06 14:31:09.942: I/dalvikvm(598):    at dalvik.system.NativeStart.run(Native Method) 
```

**Sql 语句**

```
 String tableName="StateList_Tbl";
         String databaseName="TravelguideDb";
         int databaseVersion=3;

         assetDatabaseHelper=new AssetDatabaseOpenHelper(HomeScreen.this, databaseName,databaseVersion);
         assetDatabaseHelper.openDatabase();
         assetDatabaseHelper.openReadableMode();
         groupEntityList=new ArrayList<GroupEntity>();

        String selectQuery = "SELECT State_id,State_name FROM " +tableName +" where country_part=36";

       groupCursor=assetDatabaseHelper.executeQuery(selectQuery);

        if (groupCursor.moveToFirst()) 
        {
                 do {
                     groupEntityObj=new GroupEntity();
                     groupEntityObj.setGroupId(groupCursor.getInt(0));
                     System.out.println("stateid"+groupCursor.getInt(0));
                     groupEntityObj.setGroupName(groupCursor.getString(1));
                     System.out.println("stateid"+groupCursor.getString(1));
                    String stateQuery="SELECT State_id,State_name FROM " +tableName +" where country_part="+groupCursor.getInt(0);
                    stateCursor=assetDatabaseHelper.executeQuery(stateQuery);
                    stateArrayList=new ArrayList<StateMetaData>();
                    if(stateCursor.moveToFirst())
                    {
                        do{
                         stateMetaDataObj=new StateMetaData();
                         stateMetaDataObj.setStateId(stateCursor.getInt(0));
                         System.out.println("stateid"+stateCursor.getInt(0));
                         stateMetaDataObj.setStateName(stateCursor.getString(1));
                         System.out.println("stateid"+stateCursor.getString(1));
                         stateArrayList.add(stateMetaDataObj);

                        }while(stateCursor.moveToNext());
                    }

                    groupEntityObj.setStatesList(stateArrayList);

                    groupEntityList.add(groupEntityObj);
                 } while (groupCursor.moveToNext());

        }

        System.out.println("gr "+groupEntityList.size());
        stateCursor.close();
        groupCursor.close();
        assetDatabaseHelper.close();

        System.out.println("cursor"+stateCursor.getColumnCount());
        System.out.println("cursor"+groupCursor); 
```

**AssetDatabaseOpenHelper 类**

```
 public class AssetDatabaseOpenHelper {
    private Context context;
    private SQLiteDatabase sqliteDatabaseObj;
    private String database_name;
    private CreateQueries createQueriesObj;
    private MySQLiteHelper mySQLitehelperObj;
    private int database_version;

    private  String databaseName="TravelguideDb";
    private  int databaseVersion=3;
    public AssetDatabaseOpenHelper(Context context,String databaseName,int database_version) {
        this.context = context;
        this.database_name=databaseName;
        this.database_version=database_version;
    }

    public AssetDatabaseOpenHelper(Context context) {

        this.context = context;
        this.database_name = databaseName;
        this.database_version = databaseVersion;
    }

    public void openDatabase() {
        mySQLitehelperObj = new MySQLiteHelper(context, database_name,
                database_version);

        File dbFile = context.getDatabasePath(database_name);
System.out.println("Assests"+dbFile.exists());
        if (!dbFile.exists()) {
            try {
                copyDatabase(dbFile);
            } catch (IOException e) {
            throw new RuntimeException("Error creating source database", e);
            //  e.printStackTrace();
            }
        }
 //  sqliteDatabaseObj= SQLiteDatabase.openDatabase(dbFile.getPath(), null, SQLiteDatabase.OPEN_READONLY);
//        sqliteDatabaseObj = mySQLitehelperObj.getReadableDatabase();

    }
public void openReadableMode()
{
     sqliteDatabaseObj = mySQLitehelperObj.getReadableDatabase();
}
public void openWriteableMode()
{
     sqliteDatabaseObj = mySQLitehelperObj.getWritableDatabase();
}
public void close() {

    mySQLitehelperObj.close();
}

    private void copyDatabase(File dbFile) throws IOException {

        OutputStream os = new FileOutputStream(dbFile);

        InputStream is = null;
        byte[] buffer = new byte[1024];
        for(int i=1;i<5;i++)
        {
       is = context.getAssets().open("TravelguideDb.sqlite.00"+1);
         int length;
        while ((length=is.read(buffer))!=-1) {
            os.write(buffer,0,length);
        }
        is.close();
    }

        os.flush();
        os.close();
        is.close();
    }

   public Cursor executeQuery(String query)
   {
     Cursor outputCursor=  sqliteDatabaseObj.rawQuery(query, null);
    return outputCursor;
   }
    public void createTable(String tableName, String[] columns, String[] value) {
        createQueriesObj = new CreateQueries();
        String createTableQuery = createQueriesObj.CreateTableQuery(tableName,
                columns, value);
        sqliteDatabaseObj.execSQL(createTableQuery);
        System.out.println("Query" + createTableQuery);
    }
    public void deleteTable(String tableName) 
    {
        sqliteDatabaseObj.execSQL("Drop table " + tableName);
    }

    public void deleteAllDataFromTable(String tableName) {
        // truncate table
        sqliteDatabaseObj.delete(tableName, null, null);
    }
    public void deletePerticularRows(String tableName, String whereClause,
            String[] whereArgs) {
        sqliteDatabaseObj.delete(tableName, whereClause, whereArgs);
    }

    public Cursor fetchAllRows(String tableName) {

        return sqliteDatabaseObj.query(tableName, null, null, null, null, null,
                null);
    }
    public Cursor selectOnWhereCondition(String tableName,
            String[] columnsToSelect, String whereColumnName,
            String[] whereEqualsTo, String groupBy, String having,
            String orderBy) {
        return sqliteDatabaseObj.query(tableName, columnsToSelect,
                whereColumnName, whereEqualsTo, groupBy, having, orderBy);
    }

} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-06T09:35:19.400

在日志消息关闭后，您正在访问它们的游标。

为确保正确关闭，请使用如下游标：

```
 Cursor c = DB.rawQuery(queryString);
    try{    
        while(c.moveToNext()){

           Cursor c2 = DB.rawQuery(queryString2);
           try{
               while(c2.moveToNext()){                 
               //--do stuff---
               }

           } finally {
               c2.close();
           }

        }
    }finally {
        c.close();
    } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-06T09:45:51.487

一旦打开`Cursor`或`SQLiteDatabase`对象，您必须在读/写数据库任务和游标任务结束时关闭。换句话说，当不再需要访问游标对象或 SQLiteDatabase 对象时，每次打开它们时都必须将其关闭。

# python - 通过 Matplotlib 进行 Python 绘图 - 无法让 xlabel 和 ylabel 显示在绘图上

> ID：13247735
> 
> 赞同：0
> 
> 时间：2012-11-06T09:08:24.187
> 
> 标签：python, numpy, plot, matplotlib

这是一些运行代码的片段。但是，该图会生成 xlabel 和 ylabel 由于某种原因不会出现。

```
 pl.ion()
    pl.plot(t[1000:10000:250],E_values,'ro')
    pl.xlabel('Time')
    pl.ylabel('Concentration')
    pl.legend(['[E2F]'],loc='lower right')
    pl.show() 
```

有谁知道我做错了什么？我在 Mac OS X 上。谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-06T09:19:03.403

我发现了我自己的问题 - 抱歉，已经晚了。`label`and命令应该在`legend`调用`plot`. 以下作品：

```
 pl.ion()
    pl.xlabel('Time')
    pl.ylabel('Concentration')
    pl.legend(['[E2F]'],loc='lower right')
    pl.plot(t[1000:10000:250],E_values,'ro')
    pl.show() 
```

# javascript - AngularJS 真的是 MVC 吗？

> ID：13247738
> 
> 赞同：27
> 
> 时间：2012-11-06T09:08:35.370
> 
> 标签：javascript, model-view-controller, angularjs

我正在浏览[AngularJS 主页上的](http://angularjs.org/)示例——特别是“添加一些控件”。我不太明白它如何映射到 MVC 模式。

模板（index.html）可以被认为是视图，或由 todo.js 中的 TodoCtrl 构造的对象作为控制器，但模型在哪里呢？诸如`ng-model`映射到框架的一些内部部分的属性并不直接暴露我们可以称为模型的对象。

将 AngularJS 称为 MVC 框架是否正确？

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2014-10-30T05:33:21.267

MVC 背后的核心思想是，您的代码在管理其数据（模型）、应用程序逻辑（控制器）和向用户呈现数据（视图）之间有明确的分离。视图从模型中获取数据以显示给用户。当用户通过单击或键入与应用程序交互时，控制器会通过更改模型中的数据来响应。最后，模型通知视图发生了变化，以便它可以更新它显示的内容。 ***在 Angular 应用程序***中，**视图**是文档对象模型 (DOM)，**控制器** 是 JavaScript 类，**模型**数据存储在对象属性中。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2013-12-07T02:12:54.177

我还没有读过Angular。但是，请记住，“真正的”MVC 意味着模型包含业务逻辑，控制器负责将用户输入传递给模型，视图从模型中获取自己的数据。许多所谓的 MVC 框架实际上并没有以正确的方式实现 MVC：它们使 Controller 承担了太多责任，例如让 Controller 也负责更新 View。这不是控制器的意图，在这种情况下，您会得到所谓的“胖控制器”。许多 web 开发人员有一个误解，即视图只是一个“模板”。这既是对的，也是错的；它是一个模板，但它直接从模型中获取自己的数据——而不是通过控制器。

但正如我开始说的：我还没有阅读过关于 Angular 的文章，但你自己可能已经阅读过，你应该能够通过查看框架中不同组件的作用来确定 Angular 是否真的是一个 MVC 框架。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-11-06T10:51:53.017

属性映射到控制器中定义的范围变量。例如，如果您有一些代表您的业务逻辑的 JS 对象，您可以将它们放在范围变量中，然后属性可以映射到模型本身，而不是范围变量中的一些任意值。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2017-09-29T18:03:25.840

如果任何可以在对象中存储数据的东西都被视为模型，那么每个前端框架（视图）都可以被视为具有模型。它们都可以将数据存储在对象中并在视图中呈现它们。我认为将 Angular 称为 mvc 确实是一种营销策略，试图让 Angular 看起来比它本身更重要。

请参阅： [https ://www.pluralsight.com/blog/software-development/tutorial-angularjs-mvc-implementation](https://www.pluralsight.com/blog/software-development/tutorial-angularjs-mvc-implementation)

在控制器中，他们给出了 angular 作为模型的示例。如果它不能帮助存储持久数据，那么它就不是一个模型。

# cocos2d-iphone - 试图检测 CCSprite 的触摸结束和触摸移动

> ID：13247739
> 
> 赞同：1
> 
> 时间：2012-11-06T09:08:37.713
> 
> 标签：cocos2d-iphone

我有一个 CCSprite 子类，最初我用一个

所以我有以下代码：

```
 -(void)onEnter {
        [super onEnter];

       [[[CCDirector sharedDirector] touchDispatcher] addTargetedDelegate:self priority:0 swallowsTouches:YES];
    }

    -(void)onExit {
        [super onExit];

        [[[CCDirector sharedDirector] touchDispatcher] removeDelegate:self];
    }

    -(BOOL)ccTouchBegan:(UITouch *)touch withEvent:(UIEvent *)event {
        if ([self containsTouch:touch]) {
            // do stuff
            return YES;
        }
        return NO;
    } 
```

但后来我意识到我实际上并不想使用 touchBegan，因为我想检测一个精灵是否被向下拖动——所以我想使用 touchMoved 和 touchEnded 而不是 touchBegan。

但是，当我实现这些方法时，它们不会被调用......

我如何知道精灵的触摸何时结束，以及它是否被“滑动”？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-06T11:47:49.480

1.  启用多点触控：在`applicationDidFinishLaunching:application`您的 appdelegate 的方法中，将多点触控设置为 YES：`[glView setMultipleTouchEnabled:YES];` 然后在您的 CCLayer 子类（您正在用于检测触控的类）中，在 init 方法中，添加`self.isTouchEnabled = YES;` 现在应该调用您的多点触控方法。

2.  滑动：cocos2d 不支持开箱即用的手势。你可能不得不自己工作。[您可以从有关手势](http://developer.apple.com/library/ios/#documentation/EventHandling/Conceptual/EventHandlingiPhoneOS/GestureRecognizers/GestureRecognizers.html)的苹果事件处理指南开始。raywenderlich.com 上的[How To Drag and Drop Sprites with Cocos2D](http://www.raywenderlich.com/2343/how-to-drag-and-drop-sprites-with-cocos2d)教程帮助了我。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-06T14:08:26.960

为了让调度程序调用您的方法（移动、结束、取消），您必须首先声明触摸，即。您将处理这些事件。当您返回 YES 时，这是在 ccTouchBegan 中完成的。之后，您将收到其他事件。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-10T22:47:28.077

[CCTouchableSprite](https://github.com/m1entus/CCTouchableSprite) - 我的带有 Objective-C 块的 CCSprite 的可触摸子类，你可以使用 touchMoved 来检测你想要的东西。

# android - 无法启动活动 ComponentInfo android.view.InflateException：

> ID：13247740
> 
> 赞同：3
> 
> 时间：2012-11-06T09:08:43.123
> 
> 标签：android

我收到以下运行时错误。你们能帮我纠正错误吗？这是日志猫。

```
11-06 14:28:06.262: E/AndroidRuntime(398): java.lang.RuntimeException: Unable to start activity ComponentInfo{com.xxxx.xxx/com.xxxx.xxx..Page1SubActivity}: android.view.InflateException: Binary XML file line #76: Error inflating class <unknown>
11-06 14:28:06.262: E/AndroidRuntime(398):  at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1647)
11-06 14:28:06.262: E/AndroidRuntime(398):  at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:1663)
11-06 14:28:06.262: E/AndroidRuntime(398):  at android.app.ActivityThread.access$1500(ActivityThread.java:117)
11-06 14:28:06.262: E/AndroidRuntime(398):  at android.app.ActivityThread$H.handleMessage(ActivityThread.java:931)
11-06 14:28:06.262: E/AndroidRuntime(398):  at android.os.Handler.dispatchMessage(Handler.java:99)
11-06 14:28:06.262: E/AndroidRuntime(398):  at android.os.Looper.loop(Looper.java:123)
11-06 14:28:06.262: E/AndroidRuntime(398):  at android.app.ActivityThread.main(ActivityThread.java:3683)
11-06 14:28:06.262: E/AndroidRuntime(398):  at java.lang.reflect.Method.invokeNative(Native Method)
11-06 14:28:06.262: E/AndroidRuntime(398):  at java.lang.reflect.Method.invoke(Method.java:507)
11-06 14:28:06.262: E/AndroidRuntime(398):  at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:839)
11-06 14:28:06.262: E/AndroidRuntime(398):  at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:597)
11-06 14:28:06.262: E/AndroidRuntime(398):  at dalvik.system.NativeStart.main(Native Method)
11-06 14:28:06.262: E/AndroidRuntime(398): Caused by: android.view.InflateException: Binary XML file line #76: Error inflating class <unknown>
11-06 14:28:06.262: E/AndroidRuntime(398):  at android.view.LayoutInflater.createView(LayoutInflater.java:518)
11-06 14:28:06.262: E/AndroidRuntime(398):  at com.android.internal.policy.impl.PhoneLayoutInflater.onCreateView(PhoneLayoutInflater.java:56)
11-06 14:28:06.262: E/AndroidRuntime(398):  at android.view.LayoutInflater.createViewFromTag(LayoutInflater.java:568)
11-06 14:28:06.262: E/AndroidRuntime(398):  at android.view.LayoutInflater.rInflate(LayoutInflater.java:623)
11-06 14:28:06.262: E/AndroidRuntime(398):  at android.view.LayoutInflater.rInflate(LayoutInflater.java:626)
11-06 14:28:06.262: E/AndroidRuntime(398):  at android.view.LayoutInflater.inflate(LayoutInflater.java:408)
11-06 14:28:06.262: E/AndroidRuntime(398):  at android.view.LayoutInflater.inflate(LayoutInflater.java:320)
11-06 14:28:06.262: E/AndroidRuntime(398):  at android.view.LayoutInflater.inflate(LayoutInflater.java:276)
11-06 14:28:06.262: E/AndroidRuntime(398):  at com.android.internal.policy.impl.PhoneWindow.setContentView(PhoneWindow.java:207)
11-06 14:28:06.262: E/AndroidRuntime(398):  at android.app.Activity.setContentView(Activity.java:1657)
11-06 14:28:06.262: E/AndroidRuntime(398):  at com.xxxx.xxx.Page1SubActivity.onCreate(Page1SubActivity.java:30)
11-06 14:28:06.262: E/AndroidRuntime(398):  at android.app.Instrumentation.callActivityOnCreate(Instrumentation.java:1047) 
```

这是Java文件

```
import android.app.Activity;
import android.content.Intent;
import android.content.pm.ActivityInfo;
import android.os.Bundle;
import android.view.View;
import android.view.View.OnClickListener;
import android.widget.EditText;
import android.widget.ImageButton;
import android.widget.TextView;

public class Page1SubActivity extends Activity {

    /** Called when the activity is first created. */

    private EditText edit1;
    private EditText edit2;
    private TextView textview;
    private TextView titleview ;
    private TextView tview1 ;
    private TextView tview2;
    private TextView tview3 ;

    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);

        // this activity is used for button 1 and button 4 in the main menu
        /*
         * String titles; String texts1; String texts2; String texts3;
         */

        setContentView(R.layout.page1sub);
        setRequestedOrientation(ActivityInfo.SCREEN_ORIENTATION_PORTRAIT);
        Intent intent = getIntent();
        int id = intent.getIntExtra("id", 0);

         titleview = (TextView) findViewById(R.id.textView1);
         tview1 = (TextView) findViewById(R.id.textView2);
         tview2 = (TextView) findViewById(R.id.textView3);
         tview3 = (TextView) findViewById(R.id.textView4);

        if (id == 1)// gold page
        {

            addTranslate(R.string.page1subgoldtitle, titleview);
            addTranslate(R.string.page1subgoldtext1, tview1);
            addTranslate(R.string.page1subgoldtext2, tview2);
            addTranslate(R.string.page1subgoldtext3, tview3);

            ImageButton rightbuton = (ImageButton) findViewById(R.id.rightbutton);
            ImageButton imb = (ImageButton) findViewById(R.id.back_arrow);
            imb.setOnClickListener(new OnClickListener() {

                public void onClick(View v) {
                    // if the user come through 1 st button he will be navigate
                    // page1activity with id =1
                    Intent intent = new Intent(Page1SubActivity.this,
                            Page1Activity.class);
                    intent.putExtra("id", 1);
                    startActivity(intent);

                }
            });

            rightbuton.setOnClickListener(new OnClickListener() {

                public void onClick(View v) {
                    // TODO Auto-generated method stub
                    edit1 = (EditText) findViewById(R.id.editText1);
                    edit2 = (EditText) findViewById(R.id.editText2);
                    textview = (TextView) findViewById(R.id.textView5);

                    Double number2 = Double.parseDouble(edit1.getText()
                            .toString());
                    Double number3 = Double.parseDouble(edit2.getText()
                            .toString());
                    number3 = number2 * number3;

                    int number2int = (int) (number2 * number3);
                    int number3int = (int) (number3 / 40);

                    number2 = number2 * number3;
                    number3 = number3 / 40;

                    if (number2int - number2 != 0) {
                        String number2val = Double.toString(number2);
                        textview.setText(number2val);

                    } else {
                        String number2val = Integer.toString(number2int);
                        textview.setText(number2val);
                        // label.text = [NSString stringWithFormat:@"%d",
                        // number2int];

                    }

                    if (number3int - number3 != 0) {
                        String number3val = Double.toString(number3);
                        textview.setText(number3val);

                    } else {

                        String number3val = Integer.toString(number3int);
                        textview.setText(number3val);

                    }

                }
            });

        } else if (id == 4)// silver
        {

            addTranslate(R.string.page1subsilvertitle, titleview);
            addTranslate(R.string.page1subsilvertext1, tview1);
            addTranslate(R.string.page1subsilvertext2, tview2);
            addTranslate(R.string.page1subsilvertext3, tview3);

            ImageButton imb = (ImageButton) findViewById(R.id.back_arrow);

            imb.setOnClickListener(new OnClickListener() {

                public void onClick(View v) {
                    // if the user come through 4th button he will be navigate
                    // page1activity with id =4
                    Intent intent = new Intent(Page1SubActivity.this,
                            Page1Activity.class);
                    intent.putExtra("id", 4);
                    startActivity(intent);

                }
            });

        }

    }

    private void addTranslate(int rid, TextView txt1) {
        String textv = getResources().getString(rid);
        txt1.setText(Farsi.Convert(textv));
    }

    public void onClickBtn(View v) {

        int butid = v.getId();
        switch (butid) {
        case R.id.leftbutton:
            edit1 = (EditText) findViewById(R.id.editText1);
            edit2 = (EditText) findViewById(R.id.editText2);

            edit1.setText("");
            edit2.setText("");
            textview.setText("");
            break;

        }

    }
} 
```

这是xml文件。

```
<?xml version="1.0" encoding="utf-8"?>
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"
    android:background="@drawable/page1background"
    android:paddingRight="@dimen/padding_large" >

    <TextView
        android:id="@+id/textView1"
        android:layout_width="fill_parent"
        android:layout_height="wrap_content"
        android:gravity="center_horizontal"
        android:paddingTop="@dimen/padding_Xlarge"
        android:text="@string/text"
        android:textAppearance="?android:attr/textAppearanceMedium"
        android:textColor="@color/textbody" />

    <LinearLayout
        android:id="@+id/linearLayout2"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_centerInParent="true"
        android:layout_centerVertical="true"
        android:orientation="vertical" >

        <TextView
            android:id="@+id/textView2"
            android:layout_width="fill_parent"
            android:layout_height="wrap_content"
            android:gravity="center_horizontal"
            android:text="@string/text"
            android:textAppearance="?android:attr/textAppearanceMedium"
            android:textColor="@color/textbody" />

        <EditText
            android:id="@+id/editText1"
            android:layout_width="262dp"
            android:layout_height="45dp"
            android:layout_gravity="center_horizontal"
            android:background="@drawable/textbg"
            android:inputType="numberDecimal"
            android:paddingLeft="@dimen/padding_small" >

            <requestFocus />
        </EditText>

        <TextView
            android:id="@+id/textView3"
            android:layout_width="fill_parent"
            android:layout_height="wrap_content"
            android:gravity="center_horizontal"
            android:text="@string/text"
            android:textAppearance="?android:attr/textAppearanceMedium"
            android:textColor="@color/textbody" />

        <EditText
            android:id="@+id/editText2"
            android:layout_width="262dp"
            android:layout_height="45dp"
            android:layout_gravity="center_horizontal"
            android:background="@drawable/textbg"
            android:inputType="numberDecimal"
            android:paddingLeft="@dimen/padding_small" >
        </EditText>

        <TextView
            android:id="@+id/textView4"
            android:layout_width="fill_parent"
            android:layout_height="wrap_content"
            android:gravity="center_horizontal"
            android:text="@string/text"
            android:textAppearance="?android:attr/textAppearanceMedium"
            android:textColor="@color/textbody" />

        <TextView
            android:id="@+id/textView5"
            android:layout_width="262dp"
            android:layout_height="45dp"
            android:layout_gravity="center_horizontal"
            android:background="@drawable/textbg"
            android:paddingLeft="@dimen/padding_small"
            android:paddingTop="@dimen/padding_small"
            android:textAppearance="?android:attr/textAppearanceMedium"
            android:textColor="?android:attr/editTextColor" />

        <LinearLayout
            android:id="@+id/linearLayout3"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:layout_gravity="center"
            android:orientation="horizontal" >

            <ImageButton
                android:id="@+id/leftbutton"
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                android:layout_marginRight="25dp"
                android:background="@drawable/leftbutton"
                android:contentDescription="@string/Description"
                android:onClick="onClickBtn" />

            <ImageButton
                android:id="@+id/rightbutton"
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                android:background="@drawable/rightbutton"
                android:contentDescription="@string/Description"
                android:onClick="onClickBtn" />
        </LinearLayout>
    </LinearLayout>

    <LinearLayout
        android:id="@+id/linearLayout9"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_alignParentBottom="true"
        android:layout_centerHorizontal="true"
        android:weightSum="10" >

        <View
            android:id="@+id/view10"
            android:layout_width="0dip"
            android:layout_height="10dp"
            android:layout_marginBottom="35dp"
            android:layout_weight="4.5" />

        <ImageButton
            android:id="@+id/back_arrow"
            android:layout_width="0dip"
            android:layout_height="wrap_content"
            android:layout_gravity="center_horizontal"
            android:layout_marginBottom="30dp"
            android:layout_weight="1"
            android:background="@drawable/backbut"
            android:contentDescription="@string/Description"
            android:onClick="onClickBtn"
            android:src="@drawable/backarrowpress" />

        <View
            android:id="@+id/view20"
            android:layout_width="0dip"
            android:layout_height="10dp"
            android:layout_marginBottom="35dp"
            android:layout_weight="4.5" />
    </LinearLayout>

</RelativeLayout> 
```

我在问题中添加了 xml 文件和 java 文件。这个运行良好。更新代码后，我得到了错误。请帮我纠正这个问题。提前致谢..

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-06T10:00:39.540

当我删除 `android:textColor="?android:attr/editTextColor"`txtview5 中的行时，它开始按原样工作。但是，通过删除此行可以解决该问题。但我对此并没有很酷的感觉。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2019-11-22T08:04:13.703

我在 CircleImageView 上遇到错误。我只需要删除 scaleType 就可以了。

# php - 如何获取一个ip当前位置的位置

> ID：13247741
> 
> 赞同：-5
> 
> 时间：2012-11-06T09:08:44.703
> 
> 标签：php

> **可能重复：**
> [我可以使用哪些服务来根据用户的 IP 地址查找用户的位置？](https://stackoverflow.com/questions/37015/what-services-can-i-used-to-find-a-users-location-based-on-their-ip-address)

嗨，我必须访问 ip 并将位置放在地图上，但我想要的是获取 ip 的当前位置，没有 isp 地址，有人可以建议我如何在 php 中执行此操作

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-06T09:17:22.453

$ipaddress=$_SERVER['HTTP_HOST']; $license_key="输入您的许可证密钥";

```
 $query = "http://geoip3.maxmind.com/b?l=" . $license_key . "&i=" . $ipaddress;
    $url = parse_url($query);
    $host = $url["host"];
    $path = $url["path"] . "?" . $url["query"];
    $timeout = 1;
    $fp = fsockopen ($host, 80, $errno, $errstr, $timeout)
        or die('Can not open connection to server.');
    if ($fp) {
      fputs ($fp, "GET $path HTTP/1.0\nHost: " . $host . "\n\n");
      while (!feof($fp)) {
        $buf .= fgets($fp, 128);
      }
      $lines = explode("\n", $buf);
      $data_geo = $lines[count($lines)-1];
      fclose($fp);
    } else {
      # enter error handing code here
    }
    //echo $data;

    $geo = explode(",",$data_geo);print_r($geo);enter code here 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-06T09:20:33.900

**您可以使用 3 种方法：**

1) 任何地理位置数据库站点的 API。

例如： http: [//www.maxmind.com/en/home](http://www.maxmind.com/en/home)

2) 可下载的地理定位数据库，然后您可以参考，一旦您拥有 IP 地址即可找到该位置

例如： http: [//www.hostip.info/dl/index.html](http://www.hostip.info/dl/index.html)

[http://dev.maxmind.com/geoip/geolite](http://dev.maxmind.com/geoip/geolite) <<`This looks good`

3）从显示细节的网站上抓取。- 这不是专业的，你需要稍微调整一下才能不被抓到，但它可以很好地完成工作。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-06T09:12:32.073

到目前为止，您使用了什么代码？您可以使用 Maxmind API，但它限制为每天 500 个查询。

[http://www.maxmind.com/en/home](http://www.maxmind.com/en/home)

您还可以使用 PHP GeoIP 扩展（如果您编译/安装它）

[http://php.net/manual/en/book.geoip.php](http://php.net/manual/en/book.geoip.php)

# python - 如何在python中更改节点值

> ID：13247749
> 
> 赞同：0
> 
> 时间：2012-11-06T09:08:58.833
> 
> 标签：python, xml, xml-parsing

```
<?xml version="1.0"?>
<info>
  </tags>
  </tags>
  <area>
<media>
    <options>
         <name>Jaipur</name>
    </options>
</media>
  </area>
</info> 
```

我在 python 中是全新的，这是我的 xml 文件，我想在运行时在 python 中编辑元素值，
这意味着我想**`<name>Jaipur</name>`将`<name>Mumbai</name>`**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-06T09:33:21.083

首先，该示例不是有效的 xml。您可以使用`xml.etree`随附的：

```
from xml.etree import ElementTree as et
xmlstr="""\
<?xml version="1.0"?>
<area>
  <media>
    <options>
         <name>Jaipur</name>
    </options>
 </media>
</area>"""
doc=et.fromstring(xmlstr)
doc.find('.//name').text='Mumbai'
print et.tostring(doc) 
```

输出：

```
<area>
  <media>
    <options>
         <name>Mumbai</name>
    </options>
 </media>
</area> 
```

# python - 在 Haskell 中以通用方式导航 JSON 对象

> ID：13247750
> 
> 赞同：5
> 
> 时间：2012-11-06T09:09:04.213
> 
> 标签：python, json, haskell, casting, aeson

我的目标是在 Haskell 中编写一个程序，该程序采用 json 文件的名称并将其余参数解释为导航该 json 文件并打印导航到的值的路径。问题是因为 JSON 可以包含多种值类型，我不知道如何让 Haskell 的类型系统理解我想要的。这是我无法正确实现的带有“导航”功能的 Haskell 代码：

```
import qualified Data.Aeson as A
import qualified Data.ByteString.Char8 as BS
import qualified Data.ByteString.Lazy.Char8 as BSL
import Data.List
import Data.Maybe
import System.Environment

parse :: String -> A.Value
parse = fromJust . A.decode . BSL.pack

isInteger xs = case reads xs :: [(Integer, String)] of
    [(_, "")] -> True
    _ -> False

navigate :: A.Value -> String -> String
navigate value [] = value
navigate value [x:xs]
    | isInteger x = ??? -- value is an array, get the xth element of it.
    | otherwise = ??? -- value is an map, x is a key in it.

main :: IO ()
main = do
     [filename:path] <- getArgs
     contents <- readFile filename
     let d = parse contents
     putStrLn (show (navigate d path)) 
```

作为参考，下面是用 Python 编写相同程序的方式：

```
from json import load
from sys import argv    
def navigate(obj, path):
    if not path:
        return obj
    head, tail = path[0], path[1:]
    return navigate(obj[int(head) if head.isdigit() else head], tail)    
if __name__ == '__main__':
    fname, path = argv[1], argv[2:]
    obj = load(open(fname))
    print navigate(obj, path) 
```

该程序将像这样运行：

```
$ cat data.json
{"foo" : [[1, 2, 3, {"bar" : "barf"}]]} 
$ python showjson.py data.json foo 0 3 bar
barf 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-06T12:53:14.047

您可以简单地在构造函数上进行模式匹配，`A.Value`以确定您正在处理的 JSON 对象类型：

```
import qualified Data.HashMap.Strict as M
import qualified Data.Vector as V
import qualified Data.Text as T

-- ... rest of the code more or less as before ...

navigate :: A.Value -> [String] -> BSL.ByteString
navigate value        []       = A.encode value
navigate (A.Array vs) (x : xs) = navigate (vs V.! read   x) xs
navigate (A.Object o) (x : xs) = navigate (o  M.! T.pack x) xs 
```

注意 的定义`A.Value`如下：

```
data Value
  = Object !(HashMap Text Value)
  | Array  !(Vector Value)
  | ...  -- other constructors 
```

因此，代码在向量和哈希映射上`navigate`使用了查找函数（在这两种情况下都调用）。`!`该函数`read`用于在需要时将命令行参数解释为数字（如果不是，则会严重失败），而`T.pack`将字符串重新解释为 type 的值`Text`。

# c# - 获取画布背景的图像刷控件的实际大小

> ID：13247756
> 
> 赞同：5
> 
> 时间：2012-11-06T09:09:36.103
> 
> 标签：c#, wpf, xaml, wpf-controls

我试图弄清楚如何获取设置为`Canvas`控件背景的图像的“视图大小”。背景设置为`ImageBrush`，strech 设置为 UniForm。
如果 strech 属性设置为 Fill，那么我可以只使用画布的 ActualWidth 和 ActualHeight。

UniForm 无法做到这一点，那么我应该如何处理呢？

这是我的 XAML：

```
<Grid DataContext="{Binding ImageViewerVM.CurrentImage}">
    <controls:RubberBandingCanvas x:Name="RubCanvas">
        <controls:RubberBandingCanvas.Resources>
            <Converters:ControlVisibilityConverter x:Key="VisibilityHiddenConverter" />
            <Converters:StringToBitmapConverter x:Key="StringToBitmapConverter" />
        </controls:RubberBandingCanvas.Resources>
        <controls:RubberBandingCanvas.Background>
            <ImageBrush x:Name="ibCurrentImage" ImageSource="{Binding Path=Path, Converter={StaticResource StringToBitmapConverter}}" Stretch="Uniform"></ImageBrush>
        </controls:RubberBandingCanvas.Background>
        <Ellipse Canvas.Top="10" Canvas.Right="10" Fill="Red" Stroke="Black" Height="15" Width="15" Visibility="{Binding Path=IsMultiTiff, Converter={StaticResource VisibilityHiddenConverter}}"/>            
    </controls:RubberBandingCanvas>
</Grid> 
```

最好的问候，
杰斯珀詹森

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-09T10:00:38.747

没有办法让 ImageBrush 的实际大小开箱即用。我要做的是根据 Canvas RenderSize 手动计算这个大小。

```
var ratio = Math.Min(RubCanvas.RenderSize.Width / CanvasBackground.ImageSource.Width, RubCanvas.RenderSize.Height / CanvasBackground.ImageSource.Height);
var imageBrushWidth = CanvasBackground.ImageSource.Width * ratio;
var imageBrushHeight = CanvasBackground.ImageSource.Height * ratio; 
```

# ios - 使用 SDK 6.0 的 Jailcoder

> ID：13247764
> 
> 赞同：1
> 
> 时间：2012-11-06T09:09:53.447
> 
> 标签：ios, jailbreak, ios6

我是新手`iOS`。`XCode`我正在安装最新版本`SDK 6.0`。我已经成功地测试了我`SDK 6.0`在模拟器上开发的应用程序。现在我想在没有开发人员计划帐户的真实设备上对其进行测试。为此，我使用`Jailcoder`. 我有一个`iPhone 3GS`,`AppSync 5.0+`已安装。我试过`"Quick XCode Patch"`和`"Patch My Project"`. 但是我仍然收到签名错误。它说，

> CodeSign 错误：SDK“iOS 6.0”中的产品类型“应用程序”需要代码签名

似乎是因为`iOS 6.0 SDK`没有支持`jailbroken`设备。我需要一些提示和解决方法来处理这个错误。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-18T21:54:32.330

我在越狱的 iPhone 4S 上遇到了同样的问题，上面的解决方案对我不起作用。

因此，对于遇到相同错误消息的其他任何人：JailCoder 确实适用于 XCode 4.5 + Mac OS 10.8。

作为一个绝对的菜鸟，我错过了本指南中的第 8 步：[为越狱 iPhone 开发 A 到 Z](http://www.alexwhittemore.com/developing-jailbroken-iphone-ios-401/)：

> ...链接设备和计算机。插入你的 iPhone 并打开 Xcode。打开窗口>组织者。从左侧列表中选择设备，然后单击“用于开发”。系统将提示您登录配置网站，单击取消。它可以使合法的配置更容易，但不会使非法的不配置变得更加困难。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-06T22:44:53.777

默认情况下，Xcode 要求对 iOS 应用进行签名。但是，`plist`Xcode 使用了一个文件，您可以在其中更改它。你可以告诉 Xcode 不需要代码**签名**。

检查这个文件：

```
/Applications/Xcode.app/Contents/Developer/Platforms/iPhoneOS.platform/Developer/SDKs/iPhoneOS6.0.sdk/SDKSettings.plist 
```

您可以在 Mac 上使用**Property List Editor**应用程序对其进行编辑。

确保在该文件中，`CODE_SIGNING_REQUIRED`设置为`NO`. 每次安装新的 iOS SDK（例如 5.0、5.1、6.0 等）时，您可能都需要这样做

[您可以在此处的 BigBoss 网站上](http://thebigboss.org/hosting-repository-cydia/submit-your-app/compile-for-cydia-submission)找到更多相关信息。BigBoss 是流行的 Cydia 存储库之一，用于分发越狱应用程序和调整。

# python - python-shell 在 emacs 中不起作用

> ID：13247766
> 
> 赞同：1
> 
> 时间：2012-11-06T09:10:03.320
> 
> 标签：python, emacs

我正在尝试为 python 开发配置 emacs。我已经从 melpa - python-mode ipython 安装了以下软件包。

我想进行交互式开发，在一帧中打开代码文件，在另一帧中打开 python shell，并且能够在 shell 中重新加载我的代码文件中的更改。

根据文章 - [http://pedrokroger.net/2010/07/configuring-emacs-as-a-python-ide-2/](http://pedrokroger.net/2010/07/configuring-emacs-as-a-python-ide-2/)，我应该能够使用 Cc 将我的代码加载到 shell 中！或 Mx python-shell。然而，在执行这其中任何一个都没有发生！

我没有手动下载 python-mode.el，而是从 repos 安装了包，这会造成问题吗？

我会很感激帮助解决这个问题

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-06T14:25:27.040

通过安装 python 和 ipython 包，然后将 python.el 文件中提到的配置添加到 init.el 来解决它。

# ruby-on-rails - omn iauth-facebook 给出“错误：发生错误。请稍后再试。”

> ID：13247768
> 
> 赞同：0
> 
> 时间：2012-11-06T09:10:13.070
> 
> 标签：ruby-on-rails, omniauth, facebook-oauth, facebook-login

我有 Ruby on Rails 网站。用户可以使用他们的 Facebook 帐户登录。它使用`omniauth`+ [`omniauth-facebook`](http://rubygems.org/gems/omniauth-facebook)gems 完成。

一切正常，但在*10 月 30 日*之后facebook 开始返回“错误：发生错误。请稍后再试。” 信息。

我认为这个问题与[删除 offline_access 权限有关](https://developers.facebook.com/roadmap/offline-access-removal/)。但是从请求的范围中删除“offline_access”并不能解决问题。

这是omniauth重定向到的查询：

```
https://www.facebook.com/dialog/permissions.request?app_id=239854476109563&display=page&next=http%3A%2F%2Fwww.inmyroom.ru%2Faccounts%2Fauth%2Ffacebook%2Fcallback&response_type=code&perms=email%2Coffline_access%2Cuser_birthday%2Cpublish_stream%2Cuser_photos%2Cuser_hometown%2Cuser_location%2Cuser_website&fbconnect=1 
```

任何帮助。谢谢

* * *

更新：哦，好像我找到了原因： `Sandbox mode`自动启用。而且 FB 不允许我禁用它，因为我的应用程序`privacy policy url`设置为空。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-22T06:02:20.407

我找到了原因：沙盒模式是自动启用的（我没有收到通知）。而且 FB 不允许我禁用它，因为我的应用程序的隐私政策 url 设置为空。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-06T10:24:01.840

在你的**`omniauth.rb`**文件中

```
 provider :facebook, 'fb_app_id', 'fb_app_secret',{:scope => 'email, publish_stream', :client_options => { :ssl => { :ca_file => "#{Rails.root}/config/ca-bundle.crt" } } } 
```

更多信息请参见 railcast 视频

[http://railscasts.com/episodes/360-facebook-authentication](http://railscasts.com/episodes/360-facebook-authentication)

# vba - Excel 宏，在运行时插入国际有效的公式

> ID：13247771
> 
> 赞同：25
> 
> 时间：2012-11-06T09:10:41.827
> 
> 标签：vba, excel, excel-formula, internationalization

我有一个带有宏的 Excel 电子表格，它插入条件格式，如下所示：

```
Selection.FormatConditions.Add Type:=xlExpression, Formula1:="=UND($A3=""" & lastName & """; $B3=""" & firstName & """)" 
```

如您所见，我使用了德语公式来表示“AND”（即“UND”），显然，一旦我在法语或英语版本的 Excel 上使用此代码，它就无法正常工作。通常公式会自动本地化，但是如何在运行时插入适用于所有版本的公式？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-11-06T15:46:33.767

好的，谢谢你帮我解决这个问题，你帮我破解了这个。

确实不可能只使用英语。对公式进行操作时可以使用英语，例如。通过设置编码`Range("A1").formula="AND(TRUE)"`，但这不适用于`FormatConditions`.

我的解决方案是一个将公式临时写入单元格的函数，通过`FormulaLocal`属性读取它，然后返回本地化的公式，如下所示：

```
Function GetLocalizedFormula(formula As String)
' returns the English formula from the parameter in the local format
  Dim temporary As String
  temporary = Range("A1").formula
  Range("A1").formula = formula
  Dim result As String
  result = Range("A1").FormulaLocal
  Range("A1").formula = temporary
  GetLocalizedFormula = result
End Function 
```

返回的公式可用于`FormatConditions`，当文档稍后在不同语言版本的 Excel 上打开时，将重新本地化或取消本地化。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2015-10-13T18:45:48.280

我刚刚在德语 Excel 论坛中找到了一个非常优雅[的解决方案。](http://www.herber.de/forum/archiv/1184to1188/1185861_VBA_EnglFunktionsnamen_in_Bedingte_Formatierung.html#1186007)这不会写入虚拟单元格，而是使用**临时命名的 range**。我使用最初的想法（归功于 bst）为两个方向编写了一个翻译函数。

**将本地化公式转换为英文公式：**

```
Public Function TranslateFormula_LocalToGeneric(ByVal iFormula As String) As String
    Names.Add "temporaryFormula", RefersToLocal:=iFormula
    TranslateFormula_LocalToGeneric = Names("temporaryFormula").RefersTo
    Names("temporaryFormula").Delete
End Function 
```

**将英文公式转换为本地化公式：**

```
Public Function TranslateFormula_GenericToLocal(ByVal iFormula As String) As String
    Names.Add "temporaryFormula", RefersTo:=iFormula
    TranslateFormula_GenericToLocal = Names("temporaryFormula").RefersToLocal
    Names("temporaryFormula").Delete
End Function 
```

如果您需要处理**条件格式**的公式，这将非常方便，因为这些公式始终存储为本地化公式（但您可能需要它们的通用版本，例如使用`Application.Evaluate(genericFormula)`）。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-11-06T09:32:10.747

将公式存储（简单版本）在工作簿的（隐藏）单元格中。

然后，当您打开工作簿时，该公式将由 Excel 自动为用户翻译。

现在你只需要在你的脚本中剖析这个公式（找到左括号“（”并将过去的左边取走：

使用类似的东西：

`strLocalizedFormula = Mid(strYourFormula, 2, InStr(1, strYourFormula, "(") - 2)`

`strYourFormula`工作表中公式的副本在哪里。

我希望这可行，因为我只使用英语环境。

同样通过阅读：http: [//vantedbits.blogspot.nl/2010/10/excel-vba-tip-translate-formulas.html](http://vantedbits.blogspot.nl/2010/10/excel-vba-tip-translate-formulas.html) 我认为您应该（仅）能够使用英文版的单元格公式VBA。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-11-06T10:42:42.490

也许试试这个（未经测试，因为我只有英文版）

使用 .将您的国际版本的公式写入一个偏僻的单元格`Range.Formula`。然后从 读取它`Range.FormulaLocal`，并将该字符串写入`FormatConditions`

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2021-02-03T13:28:48.740

我知道这个线程已经很久了，有人可能已经找到了一个优雅的解决方案，但我只是遇到了同样的问题，我需要应用条件格式而不修改工作表、创建临时单元格内容或命名范围。所有用户使用的都是英文版的Excel，所以公式中用到的函数是一样的，只是地域设置不同，所以参数分隔符也不同；在挪威语中，它是“;” 而不是“，”，就像欧洲其他地方一样，我猜。

例如，我需要自动创建条件格式，使用 Excel 公式作为以下标准：

```
.FormatConditions.Add xlExpression, Formula1:="=AND(ISNUMBER(B" & I & "),B" & I & ">=" & Ul1 & ")" 
```

其中“Ul1”是在上一步中定义的值，它对解决方案并不重要。

但是，我需要能够在具有挪威语和英语设置的计算机上运行它

我在这里找到了 Andrew Pulsom 的一个非常简短的解决方案：[https](https://www.mrexcel.com/board/threads/french-vba-vs-english-vba.729570/) ://www.mrexcel.com/board/threads/french-vba-vs-english-vba.729570/ 。他只是把参数分隔符变成了一个变量：

```
If Application.International(xlDecimalSeparator) = "," Then
    Sep = ";"
Else
    Sep = ","
End If

Cl1 = "=AND(ISNUMBER(B" & I & ")" & Sep & "B" & I & "<" & Ul1 & ")" 
```

对我来说就像一个魅力:)

我知道这只能解决部分问题，但我认为这可能适用于许多使用具有本地区域设置的英语 Office 安装的国际公司。

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2016-08-23T15:47:01.327

谢谢大家！我发现这篇文章非常有用。

我的解决方案是其他人的组合，我添加它以防有人发现它有用。

```
Dim tempform As String
Dim strlocalform1 As String
Dim strlocalform2 As String

' Get formula stored in WorksheetA Cell O1 =IFERROR(a,b)
tempform = Worksheets("Sheet").Range("O1").Formula

' Extract from the formula IFERROR statement in local language.
strlocalform1 = Mid(tempform, 2, InStr(1, tempform, "(") - 1)

' Extract from the formula separator , (comma) in local settings.
strlocalform2 = Mid(tempform, InStr(1, tempform, "a") + 1, 1)

' Add formula in local language to desired field.
pvt.CalculatedFields.Add Name:="NewField", Formula:="=" & strlocalform1 & "FORMULA" & strlocalform2 & ")" 
```

希望这可以帮助！

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2018-03-12T10:55:34.390

更多解释请参考链接：[https ://bettersolutions.com/csharp/excel-interop/locale-culture.htm](https://bettersolutions.com/csharp/excel-interop/locale-culture.htm)

```
CultureInfo baseCulture = System.Threading.Thread.CurrentThread.CurrentCulture; 
Thread.CurrentThread.CurrentCulture = new CultureInfo(xlapp.LanguageSettings.LanguageID(Office.MsoAppLanguageID.msoLanguageIDUI)); 
// do something 
System.Threading.Thread.CurrentThread.CurrentCulture = baseCulture; 
```

# java - 坚持使用 sql / hql 查询组

> ID：13247774
> 
> 赞同：3
> 
> 时间：2012-11-06T09:10:48.440
> 
> 标签：java, sql, oracle, hql

```
id          device_id   config_status   update_finished
1           5015001     SUCCESS     11-OCT-2012
2           5015001     SUCCESS     23-OCT-2012
3           5015001     PENDING     23-OCT-2012
4           5015001     PENDING     23-OCT-2012
5           5016222     PENDING     12-OCT-2012
6           5016222     PENDING     22-OCT-2012 
```

嗨，上面是我的表格，上面有一些示例数据。我想要实现的是为每个 device_id 获取最后的 SUCCESS 状态（日期在 update_finished 字段中）和所有 PENDING 状态。从上面的示例中，结果查询应具有：

```
id          device_id   config_status   update_finished
2           5015001     SUCCESS     23-OCT-2012
3           5015001     PENDING     23-OCT-2012
4           5015001     PENDING     23-OCT-2012
5           5016222     PENDING     12-OCT-2012
6           5016222     PENDING     22-OCT-2012 
```

因此，这意味着只有按日期列 update_finished 的最后一个 SUCCESS 状态以及每个 device_id 的所有 PENDING 状态。

目前我正试图搞乱 GROUP BY：`SELECT device_id, config_status, max(update_finished) AS "LastUpdate" from config_status WHERE config_status = 'SUCCESS' group by device_id, config_status`

这实际上只返回每个 device_id 的最后一个 SUCCESS 状态，但它错过了 PENDING 状态并且它没有`id`列。如果我将`id`字段添加到 GROUP BY 那么分组将是`id`无论如何。

任何人都可以帮助我进行正确的查询吗？它也应该有子查询吗？最后我需要将它作为 HQL，但我认为它与 SQL 非常相似。

**编辑：**

谢谢大家帮助我。所有这些查询都有效，但最适合我@Remigio 提供的查询，因为将其转换为返回参数化对象的 HQL 查询是最简单的，而不仅仅是对象。

这是我在初始示例中省略的附加字段的工作 HQL 查询

```
List<ConfigStatus> statuses = getHibernateTemplate().find("select c from ConfigStatus c " +
                "where (configStatus = 'SUCCESS' and updateFinished = (select max(updateFinished) from " +
                "ConfigStatus c1 where c1.device.deviceId = c.device.deviceId and c1.configStatus = 'SUCCESS' and c1.configFile.configFileId = ?)) " +
                "or configStatus = 'PENDING' and configFile.configFileId = ?", new Object[] {configFileId, configFileId}); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-06T09:52:56.563

你可以试试这个查询：

```
select * from device d
where (config_status='SUCCESS' and update_finished = (select max(update_finished) from
device d1 where d1.device_id = d.device_id and d1.config_status='SUCCESS'))
or config_status='PENDING' 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-06T09:17:46.900

基于[oracle 示例](http://docs.oracle.com/cd/B19306_01/server.102/b14200/functions137.htm)：

```
SELECT last_name FROM 
   (SELECT last_name, ROW_NUMBER() OVER (ORDER BY last_name) R FROM employees)
   WHERE R BETWEEN 51 and 100; 
```

您的查询应该是：

```
select * from (
  SELECT device_id, config_status, update_finished AS "LastUpdate" ,
  ROW_NUMBER() OVER (ORDER BY update_finished desc) R
  from config_status WHERE config_status = 'SUCCESS' 
) where R = 1 
```

**已编辑**

```
select device_id, config_status, update_finished
from (
  SELECT device_id, config_status, update_finished  ,
  ROW_NUMBER() OVER (ORDER BY update_finished desc) R
  from config_status WHERE config_status = 'SUCCESS' 
) where R = 1
union all
SELECT device_id, config_status, update_finished  
from config_status WHERE config_status = 'PENDING' 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-06T12:07:53.697

```
    - 尝试这个：

    与 T_CONFIG_STATUS 作为 (
      从 DUAL union 中选择 1 作为 id，5015001 作为 DEVICE_ID，'SUCCESS' 作为 CONFIG_STATUS，TO_DATE('11-OCT-2012','DD-MON-YYYY') 作为 update_finished
      从 DUAL 联合中选择 2, 5015001, 'SUCCESS', TO_DATE('23-OCT-2012','DD-MON-YYYY')
      从 DUAL 联合中选择 3, 5015001, 'PENDING', TO_DATE('23-OCT-2012','DD-MON-YYYY')
      从双重联合中选择 4, 5015001, 'PENDING', TO_DATE('23-OCT-2012','DD-MON-YYYY')
      从双重联合中选择 5, 5016222, 'PENDING', TO_DATE('12-OCT-2012','DD-MON-YYYY')
      从 DUAL 中选择 6, 5016222, 'PENDING', TO_DATE('22-OCT-2012','DD-MON-YYYY')
    )
    , q1 为 (
      选择 id、DEVICE_ID、CONFIG_STATUS、UPDATE_FINISHED、
        max(UPDATE_FINISHED) over(partition by DEVICE_ID, CONFIG_STATUS) as MAX_UPDATE_FINISHED    
      从 T_CONFIG_STATUS
    )
    , q2 为 (
      选择 id、device_id、config_status、update_finished、max_update_finished、
        案子
          当 config_status='SUCCESS' 和 update_finished=max_update_finished 然后 'keep'
          当 config_status='PENDING' 然后 'keep'
          否则“丢弃”
        以 KEEP_RECORD 结尾
      从第一季度开始
    )
    选择 id、device_id、config_status、update_finished
    从第二季度开始，其中 KEEP_RECORD='keep'
    按 ID 排序；

```

因此，表 t_config_status 只不过是一个包含 Skyzer 问题中的样本数据的虚拟表。

查询 q1 然后获取具有相同 device_id 和 cojnfig_status 的所有记录集中的每个记录的最大更新日期。

查询 q2 然后计算另一个标志来决定是保留还是丢弃记录。因此，它保留每条具有 PE​​NDINGstatus 的记录。但它只保留那些具有最新更新完成日期的 SUCCESS 状态的记录。

最后的查询然后只使用过滤器来显示标志值为'keep'的记录，并忽略那些标志值为'discard'的记录。

希望这能澄清逻辑。

# python - 在 apache2+uwsgi 和命令行中运行 python 代码有什么区别？

> ID：13247780
> 
> 赞同：0
> 
> 时间：2012-11-06T09:11:25.733
> 
> 标签：python, apache2, execution, uwsgi

考虑以下 python 代码（在所有情况下都以 apache 服务器的用户身份运行）：

```
import subprocess as sp
_fname_in ='/path/to/existing/dir/file_in.pdf'
_fname_out='/path/to/existing/dir/file_out.pdf'
_from_page=1
_to_page=4
cmd = [
    '/usr/bin/pdftk',
    'A=%(_fname_in)s'%locals(),
    'cat',
    '%(_from_page)s-%(_to_page)s'%locals(),
    'output',
    '%(_fname_out)s'%locals(),
]
p = sp.Popen(cmd,stdout=sp.PIPE,stderr=sp.PIPE)
output, errors = p.communicate() 
```

上面的代码在 uwsgi 和 ipython 中运行时表现不同：

*   ipython - 简单有效。
*   当通过 apache + uwsgi 访问时，代码只会卡在最后一行。

发生这种情况时，ps 输出显示与该命令相关的 2 个进程：

1.  使用 uwsgi python 的 PID 的 PPID 调用 shell，cmd 行如下：

    sh -c /usr/bin/pdftk A /path/to/existing/dir/file_in.pdf

2.  pdftk 进程本身，带有这个“A <>”的东西。

注意现在替换`'='`的东西`' '` ，如果我从 ipython 运行那个命令，我会得到第三种行为：来自 pdftk 的语法错误。令我困惑的是，相同的命令，在相同的外壳下呈现不同的结果。

请解释为什么会发生这种情况......

# java - 我如何从 jasperserver 获取报告

> ID：13247782
> 
> 赞同：4
> 
> 时间：2012-11-06T09:11:31.527
> 
> 标签：java, swing, noclassdeffounderror, jasperserver

有了这段代码，我得到了错误：

```
Exception in thread "AWT-EventQueue-0" java.lang.NoClassDefFoundError: org/apache/axis/EngineConfiguration 
```

我正在尝试获取有关 Jasper 服务器的报告。（没有足够的关于 Jasper 服务器的文档）。我如何解决它？

```
 JServer server = new JServer();
    server.setUrl("http://localhost:8080/jasperserver/services/repository");
    server.setUsername("jasperadmin");
    server.setPassword("jasperadmin");
    WSClient client = new WSClient(server);

    ResourceDescriptor resourceDescriptor = new ResourceDescriptor();
    resourceDescriptor.setUriString ("/reports/samples/AllAccounts");
  Map<String, Object> parameterMap = new HashMap<String, Object>();
   parameterMap.put("MY_PARAMETER_NAME", "myparametervalue");
    JasperPrint printer = client.runReport(resourceDescriptor, parameterMap);
    JasperViewer.viewReport(printer, false, Locale.ENGLISH); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-06T10:33:58.040

要解决该错误，需要将包含`EngineConfiguration`该类的 Jar 添加到应用程序的运行时类路径中。

[`EngineConfiguration`在 JarFinder 上](http://www.jarfinder.com/index.php/java/info/org.apache.axis.EngineConfiguration)搜索应该会给你一个可能的嫌疑人列表。

# asp.net - Kendo Ui Mobile 模态视图

> ID：13247783
> 
> 赞同：0
> 
> 时间：2012-11-06T09:11:34.763
> 
> 标签：asp.net, kendo-ui

我在我的 aspx 页面中使用 kendo ui Mobile ModalView 但我无法获得所需的输出。单击按钮时它显示相同的页面。我是剑道ui的新手。请任何人帮助我。请参考 kendo ui 移动模式视图并建议我如何在我的项目中使用它。

```
My code is
<head runat="server">
<title>Untitled Page</title>
<link href="CSS/kendo.common.css" rel="stylesheet" type="text/css" />
<%--<link href="CSS/kendo.dataviz.min.css" rel="stylesheet" type="text/css" />--%>
<link href="CSS/kendo.default.css" rel="stylesheet" type="text/css" />
<link href="CSS/kendo.mobile.all.css" rel="stylesheet" type="text/css" />
<link href="CSS/Example.css" rel="stylesheet" type="text/css" />

<script src="Js/jquery1.7.1.min.js" type="text/javascript"></script>

<script src="CSS/kendo.min.js" type="text/javascript"></script>
 <script type="text/javascript">
function closeModalViewLogin() {
    $("#modalview-login").data("kendoModalView").open();
}
</script>

<script type="text/javascript">
var app = new kendo.mobile.Application(document.body);
</script>
</head>

 <body>

<form id="form1" runat="server">
<div data-role="view" id="modalview-camera" data-title="HTML5 Camera">
<img src="../../content/mobile/modalview/lens.png" class="camera-image" /><br />
<a data-role="button" data-rel="modalview" href="#modalview-login" id="modalview-open-  
button">Login</a>
</div>

<div data-role="modalview" id="modalview-login" style="width: 95%; height: 80%;">
<div data-role="header">
    <div data-role="navbar">
        <span>Login</span>
        <a data-click="closeModalViewLogin" data-role="button" data- 
align="right">Cancel</a>
    </div>
</div>

<ul data-role="listview" data-style="inset">
    <li><label for="username">Username:</label> <input type="text" id="username" />  

</li>
    <li><label for="password">Password:</label> <input type="password" id="password" />  
</li>
</ul>
<a data-click="closeModalViewLogin" id="modalview-login-button" type="button" data-  
role="button">Login</a>
<a data-click="closeModalViewLogin" id="modalview-reg-button" type="button" data-  
role="button">Register</a>
</div>
</form>
</body> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-07T05:56:28.443

此外，您可以在表单而不是正文上初始化移动应用程序，因为视图应该是应用程序元素的直接后代。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-20T11:13:11.800

**根据要求更改代码**

```
<html>
<head runat="server">
    <title>Model view sample</title>
    <script src="http://code.jquery.com/jquery-1.7.2.min.js"></script>
    <script src="http://cdn.kendostatic.com/2012.2.710/js/kendo.mobile.min.js"></script>
    <link href="http://cdn.kendostatic.com/2012.2.710/styles/kendo.mobile.all.min.css" rel="stylesheet" />

    <script type="text/javascript">
        function closeModalViewLogin() {
            $("#modalview-login").data("kendoModalView").open();
        }
    </script>
</head>

<body>

    <div data-role="view" id="modalview-camera" data-title="HTML5 Camera">
        <a data-role="button" data-rel="modalview" href="#modalview-login" id="modalview-open-button">Login</a>

        <div data-role="modalview" id="modalview-login" style="width: 95%; height: 80%;">
            <div data-role="header">
                <div data-role="navbar">
                    <span>Login</span>
                    <a data-click="closeModalViewLogin" data-role="button" data-align="right">Cancel</a>
                </div>
            </div>

            <ul data-role="listview" data-style="inset">
                <li>
                    <label for="username">Username:</label>
                    <input type="text" id="username" />

                </li>
                <li>
                    <label for="password">Password:</label>
                    <input type="password" id="password" />
                </li>
            </ul>
            <a data-click="closeModalViewLogin" id="modalview-login-button" data-role="button">Login</a>
            <a data-click="closeModalViewLogin" id="modalview-reg-button" data-role="button">Register</a>
        </div>
    </div>

    <script type="text/javascript">
        var app = new kendo.mobile.Application(document.body);
    </script>
</body>
</html> 
```

这工作正常。

**笔记**

1：模型视图应始终在内部使用`<div data-role="view" ...>...</div>`

2：文档准备好后初始化kendo移动应用程序（即var app = new kendo.mobile.Application(document.body)）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-06T09:29:35.653

如果您查看您用作起点的代码示例@ [http](http://demos.kendoui.com/mobile/modalview/index.html) ://demos.kendoui.c​​om/mobile/modalview/index.html - 您会发现调用 Kendo 框架的脚本标签的位置位于在正文标记的底部，如果您将它们放在正文上方，如示例代码中所示，则在该阶段没有任何内容可以执行脚本。您需要将它们移动到正确的位置。或者使用 jQuery 就绪命令并从那里调用 Kendo 脚本。

```
 $(document).ready(function () {
  $("p").text("The DOM is now loaded and can be manipulated.");
}); 
```

# java - Java小程序使用httprespon

> ID：13247784
> 
> 赞同：1
> 
> 时间：2012-11-06T09:11:36.827
> 
> 标签：java, http, post, web, applet

*   这是我的代码。
*   我使用一种简单的方法来制作 POST httprespon。
*   安装在小程序上。
*   我在 Eclipse 中工作正常。
*   但挂载在appletviewer 导致被击落。
*   网页也会被击落。
*   数据量太大无法处理？
*   还是有其他原因？
*   我需要帮助 谢谢

    ```
    public class we extends Applet
    {
    Button sd = new Button("11");
    Label title= new Label();
    Label prompt = new Label();
    TextField input = new TextField(8);
    Label result = new Label();

    public void init()
    {
        add(sd);
            }

    public void start() {

    }

    public void paint (Graphics g) {

    }

    public boolean action(Event e, Object o) {
        if (e.target == input) {
            match();
        } else if (e.target == sd) {
            abandon();
        }
        return true;
    }   
    private void match() {      
    }
    private void abandon() {
        String url="http://119.14.80.132/ACT_ID_355";

    HttpPost httppost=new HttpPost(url);

    List<NameValuePair> params=new ArrayList<NameValuePair>();

    params.add(new BasicNameValuePair("UNCLOSE1","1"));

    try {
        httppost.setEntity(new UrlEncodedFormEntity(params,HTTP.ISO_8859_1));
    } catch (UnsupportedEncodingException e1) {

        e1.printStackTrace();
    }

    HttpResponse response = null;
    try {
        response = new DefaultHttpClient().execute(httppost);
    } catch (ClientProtocolException e1) {

        e1.printStackTrace();
    } catch (IOException e1) {

        e1.printStackTrace();
    }

    if(response.getStatusLine().getStatusCode()==200){
        try {
            String resultq=EntityUtils.toString(response.getEntity());
        } catch (ParseException e1) {

            e1.printStackTrace();
        } catch (IOException e1) {

            e1.printStackTrace();
        }
    }

    } 
    ```

    }

小程序查看器

```
Exception in thread "AWT-EventQueue-1" java.security.AccessControlException: acc
ess denied ("java.net.SocketPermission" "119.14.80.132:80" "connect,resolve")
        at java.security.AccessControlContext.checkPermission(AccessControlConte
xt.java:366)
        at java.security.AccessController.checkPermission(AccessController.java:
560)
        at java.lang.SecurityManager.checkPermission(SecurityManager.java:549)
        at java.lang.SecurityManager.checkConnect(SecurityManager.java:1051)
        at java.net.Socket.connect(Socket.java:574)
        at org.apache.http.conn.scheme.PlainSocketFactory.connectSocket(PlainSoc
ketFactory.java:127)
        at org.apache.http.impl.conn.DefaultClientConnectionOperator.openConnect
ion(DefaultClientConnectionOperator.java:180)
        at org.apache.http.impl.conn.ManagedClientConnectionImpl.open(ManagedCli
entConnectionImpl.java:294)
        at org.apache.http.impl.client.DefaultRequestDirector.tryConnect(Default
RequestDirector.java:640)
        at org.apache.http.impl.client.DefaultRequestDirector.execute(DefaultReq
uestDirector.java:479)
        at org.apache.http.impl.client.AbstractHttpClient.execute(AbstractHttpCl
ient.java:906)
        at org.apache.http.impl.client.AbstractHttpClient.execute(AbstractHttpCl
ient.java:805)
        at org.apache.http.impl.client.AbstractHttpClient.execute(AbstractHttpCl
ient.java:784)
        at we.abandon(we.java:130)
        at we.action(we.java:49)
        at java.awt.Component.handleEvent(Component.java:6751)
        at java.awt.Component.postEvent(Component.java:5160)
        at java.awt.Component.postEvent(Component.java:5170)
        at java.awt.Component.dispatchEventImpl(Component.java:4877)
        at java.awt.Component.dispatchEvent(Component.java:4687)
        at java.awt.EventQueue.dispatchEventImpl(EventQueue.java:723)
        at java.awt.EventQueue.access$200(EventQueue.java:103)
        at java.awt.EventQueue$3.run(EventQueue.java:682)
        at java.awt.EventQueue$3.run(EventQueue.java:680)
        at java.security.AccessController.doPrivileged(Native Method)
        at java.security.ProtectionDomain$1.doIntersectionPrivilege(ProtectionDo
main.java:76)
        at java.security.ProtectionDomain$1.doIntersectionPrivilege(ProtectionDo
main.java:87)
        at java.awt.EventQueue$4.run(EventQueue.java:696)
        at java.awt.EventQueue$4.run(EventQueue.java:694)
        at java.security.AccessController.doPrivileged(Native Method)
        at java.security.ProtectionDomain$1.doIntersectionPrivilege(ProtectionDo
main.java:76)
        at java.awt.EventQueue.dispatchEvent(EventQueue.java:693)
        at java.awt.EventDispatchThread.pumpOneEventForFilters(EventDispatchThre
ad.java:244)
        at java.awt.EventDispatchThread.pumpEventsForFilter(EventDispatchThread.
java:163)
        at java.awt.EventDispatchThread.pumpEventsForHierarchy(EventDispatchThre
ad.java:151)
        at java.awt.EventDispatchThread.pumpEvents(EventDispatchThread.java:147)

        at java.awt.EventDispatchThread.pumpEvents(EventDispatchThread.java:139)

        at java.awt.EventDispatchThread.run(EventDispatchThread.java:97) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-06T09:24:33.450

小程序在“沙盒”中运行。它只允许打开与下载它的服务器的连接。您看到的错误是安全违规，因为您正在尝试连接到另一台服务器。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-07T07:47:37.583

已答复。我觉得非常愚蠢。我花了十几个小时都不想出来。答案实际上只是一行文字。

```
public void init()
{
System.setSecurityManager(null);
add(sd);
add(sd2);
} 
```

我还是不明白为什么？？？？？？？？？

# java - Java和python进程可以在linux上独占锁定同一个文件

> ID：13247787
> 
> 赞同：5
> 
> 时间：2012-11-06T09:11:56.407
> 
> 标签：java, python, linux

我有一个 java 应用程序和一个 python 启动器。Java 应用程序使用以下代码锁定文件以避免多次启动：

```
java.nio.channels.FileLock lock = lockWrapper.getChannel().tryLock();
if (lock == null) {
     logger.info("Anotheris already running");
}
lock.release();
staticLock = lockWrapper.getChannel().lock(); 
```

python 启动器尝试使用 fcntl 锁定同一个文件，它可以。两个 java 进程不能这样做，两个 python 进程都不能独占锁定同一个文件。但是 java 和 python 可以在任何方向。我在使用 openjdk 6 和 python2.7 的 xubuntu 上，我将 portalocker 用于 python。

```
 lockfile =open(lockfilename, 'w+')
    portalocker.lock(lockfile, portalocker.LOCK_EX| portalocker.LOCK_NB) 
```

在win7上也能正常工作。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-06T09:26:01.630

我从同事那里得到了答案，很简单。Java 不使用 POSIX 锁，但 python 使用。所以他们不能互操作...

* * *

实际上他们可以，但前提是可以强制两个运行时使用相同的锁定机制。但这会迫使您对其进行硬编码，从而使代码变得脆弱且非常依赖于平台。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2016-02-11T01:47:50.360

这适用于我在 Linux el6 上。使用 FileLock 和 python 2.6 的 Oracle Java 7 可以正确锁定文件。编辑：使用 F_SETLKW 进行阻塞/等待操作。

Python 代码不可移植。这在我的环境中不是问题。

```
import fcntl, struct, time

f = open("/tmp/TestLock","w")

lockdata = struct.pack('hhllhh', fcntl.F_WRLCK, 0, 0, 0, 0, 0)
unlockdata = struct.pack('hhllhh', fcntl.F_UNLCK, 0, 0, 0, 0, 0)
while True:
    try:
        fcntl.fcntl(f.fileno(),fcntl.F_SETLK, lockdata)
        print "Lock held"
        time.sleep(5)
    except IOError as ex:
        print "Lock failed: "+ex.strerror
        if ex.errno == 11:
            time.sleep(0.5)
        else:
            break
        continue
    else:
        fcntl.fcntl(f.fileno(),fcntl.F_SETLK, unlockdata) 
```

参考：[https](https://docs.python.org/2/library/fcntl.html) : //docs.python.org/2/library/fcntl.html SVR4的搜索页面（在底部）

参考：[https ://community.dur.ac.uk/physics.astrolab/file_locking.html](https://community.dur.ac.uk/physics.astrolab/file_locking.html)

# c# - 使用由 0 和 1 组成的数据实现最佳压缩？

> ID：13247789
> 
> 赞同：0
> 
> 时间：2012-11-06T09:12:00.200
> 
> 标签：c#, compression

我正在尝试对矩阵中仅包含 1 和 0 的数据实现最佳压缩。

为了说明我的意思，这是一个 6 x 6 矩阵示例：

```
1,0,0,1,1,1
0,1,0,1,1,1
1,0,0,1,0,0
0,1,1,0,1,1
1,0,0,0,0,1
0,1,0,1,0,1 
```

我想将其压缩为尽可能小的字符串或字节数组。我需要压缩的矩阵更大（**总是 4096 x 4096** 1 和 0）。

我想它可能会被严重压缩，但我不确定如何。我会将最佳压缩标记为答案。性能无关紧要。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-06T11:21:20.457

我假设您想将字符串压缩成其他字符串，即使您的数据确实是二进制的。我不知道最好的压缩算法是什么（这将取决于您的数据），但您可以将输入文本转换为位，压缩这些，然后使用 base-64 编码再次将压缩字节转换为字符串。这将允许您从一个字符串转到另一个字符串，并且仍然应用您选择的压缩算法。

.NET 框架提供了[`DeflateStream`](http://msdn.microsoft.com/en-us/library/system.io.compression.deflatestream.aspx)允许您压缩字节流的类。第一步是创建一个自定义`Stream`，允许您读取和写入您的文本格式。由于没有更好的名字，我给它取了名字`TextStream`。请注意，为了简化问题，我将`\n`其用作行尾（而不是`\r\n`）。

```
class TextStream : Stream {

  readonly String text;

  readonly Int32 bitsPerLine;

  readonly StringBuilder buffer;

  Int32 textPosition;

  // Initialize a readable stream.
  public TextStream(String text) {
    if (text == null)
      throw new ArgumentNullException("text");
    this.text = text;
  }

  // Initialize a writeable stream.
  public TextStream(Int32 bitsPerLine) {
    if (bitsPerLine <= 0)
      throw new ArgumentException();
    this.bitsPerLine = bitsPerLine;
    this.buffer = new StringBuilder();
  }

  public override Boolean CanRead { get { return this.text != null; } }

  public override Boolean CanWrite { get { return this.buffer != null; } }

  public override Boolean CanSeek { get { return false; } }

  public override Int64 Length { get { throw new InvalidOperationException(); } }

  public override Int64 Position {
    get { throw new InvalidOperationException(); }
    set { throw new InvalidOperationException(); }
  }

  public override void Flush() {
  }

  public override Int32 Read(Byte[] buffer, Int32 offset, Int32 count) {
    // TODO: Validate buffer, offset and count.
    if (!CanRead)
      throw new InvalidOperationException();

    var byteCount = 0;
    Byte currentByte = 0;
    var bitCount = 0;
    for (; byteCount < count && this.textPosition < this.text.Length; this.textPosition += 1) {
      if (text[this.textPosition] != '0' && text[this.textPosition] != '1')
        continue;
      currentByte = (Byte) ((currentByte << 1) | (this.text[this.textPosition] == '0' ? 0 : 1));
      bitCount += 1;
      if (bitCount == 8) {
        buffer[offset + byteCount] = currentByte;
        byteCount += 1;
        currentByte = 0;
        bitCount = 0;
      }
    }
    if (bitCount > 0) {
      buffer[offset + byteCount] = currentByte;
      byteCount += 1;
    }
    return byteCount;
  }

  public override void Write(Byte[] buffer, Int32 offset, Int32 count) {
    // TODO: Validate buffer, offset and count.
    if (!CanWrite)
      throw new InvalidOperationException();

    for (var i = 0; i < count; ++i) {
      var currentByte = buffer[offset + i];
      for (var mask = 0x80; mask > 0; mask /= 2) {
        if (this.buffer.Length > 0) {
          if ((this.buffer.Length + 1)%(2*this.bitsPerLine) == 0)
            this.buffer.Append('\n');
          else
            this.buffer.Append(',');
        }
        this.buffer.Append((currentByte & mask) == 0 ? '0' : '1');
      }
    }
  }

  public override String ToString() {
    if (this.text != null)
      return this.text;
    else
      return this.buffer.ToString();
  }

  public override Int64 Seek(Int64 offset, SeekOrigin origin) {
    throw new InvalidOperationException();
  }

  public override void SetLength(Int64 length) {
    throw new InvalidOperationException();
  }

} 
```

然后，您可以编写使用`DeflateStream`. 请注意，未压缩的输入是一个字符串，就像您在问题中提供的那样，压缩输出是一个 base-64 编码的字符串。

```
String Compress(String text) {
  using (var inputStream = new TextStream(text))
    using (var outputStream = new MemoryStream()) {
      using (var compressedStream = new DeflateStream(outputStream, CompressionMode.Compress))
        inputStream.CopyTo(compressedStream);
      return Convert.ToBase64String(outputStream.ToArray());
    }
}

String Decompress(String compressedText, Int32 bitsPerLine) {
  var bytes = Convert.FromBase64String(compressedText);
  using (var inputStream = new MemoryStream(bytes))
    using (var outputStream = new TextStream(bitsPerLine)) {
      using (var compressedStream = new DeflateStream(inputStream, CompressionMode.Decompress))
        compressedStream.CopyTo(outputStream);
      return outputStream.ToString();
    }
} 
```

为了测试它，我使用了一种方法来创建一个随机字符串（使用固定种子来始终创建相同的字符串）：

```
String CreateRandomString(Int32 width, Int32 height) {
  var random = new Random(0);
  var stringBuilder = new StringBuilder();
  for (var i = 0; i < width; ++i) {
    for (var j = 0; j < height; ++j) {
      if (i > 0 && j == 0)
        stringBuilder.Append('\n');
      else if (j > 0)
        stringBuilder.Append(',');
      stringBuilder.Append(random.Next(2) == 0 ? '0' : '1');
    }
  }
  return stringBuilder.ToString();
} 
```

创建一个随机的 4,096 x 4,096 字符串的未压缩大小为 33,554,431 个字符。这被压缩为 2,797,056 个字符，减少到原始大小的 8% 左右。

跳过 base-64 编码会进一步提高压缩率，但输出将是二进制而不是字符串。如果您还将输入视为二进制，您实际上会得到以下随机数据的结果，其概率为 0 和 1：

```
  输入字节：4,096 x 4,096 / 8 = 2,097,152
  输出字节数：2,097,792
  压缩后尺寸：100%

```

简单地转换为字节比在放气之后进行转换要好。但是，使用随机输入但使用 25% 0 和 75% 1 时，您会得到以下结果：

```
  输入字节：4,096 x 4,096 / 8 = 2,097,152
  输出字节数：1,757,846
  压缩后尺寸：84%

```

压缩数据的程度实际上取决于数据的性质。如果它是完全随机的，那么在将文本转换为字节后，您将无法获得太多压缩。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-06T10:03:31.513

嗯......在不知道问题域的情况下，尽可能小是不可能的。

这是一般方法：

1.  使用位而不是字节或字符或其他方式表示数组中的一和零。
2.  使用通用无损压缩算法进行压缩。最常见的两种是：霍夫曼编码和某种类型的 LZW。

霍夫曼可以在数学上被证明可以提供最好的数据压缩，关键是为了解压缩数据，您还需要可能与原始数据一样大的霍夫曼树。对于大多数输入，LZW 为您提供相当于 Huffman 的压缩（在百分之几内），但在文本等重复段的数据上表现最佳。压缩算法的实现应该很容易实现（GZIP 使用 LZ77，它是 LZW 的较早的稍微不太理想的版本。）

使用现代算法的压缩算法的良好实现转到 7zip.org。它是开源的，他们有一个带有 DLL 的 C API，但你必须创建 .Net 接口（除非有人已经制作了。）

非通用方法：这依赖于数据的已知特征。例如：如果您知道大部分数据为零，则可以只编码这些数据的坐标。如果数据包含 1 和 0 的补丁，则可以使用 RLE 或算法的二维变体对其进行编码。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-06T10:07:56.720

使用[Huffman Coding](http://en.wikipedia.org/wiki/Huffman_coding)，您可以将其压缩很多：

```
0  => 111
1  => 10
,  => 0
\r => 1100
\n => 1101 
```

为您生成示例矩阵（以位为单位）：

```
10011101 11010010 01011001 10111101 00111010 01001011 00110110 01110111
01001110 11111001 10111101 00100111 01001011 00110110 01110111 01110111 
01011001 10111101 00111010 0111010 
```

如果可以排除逗号、换行和回车，那么您只需要一个[BitArray](http://msdn.microsoft.com/en-us/library/system.collections.bitarray.aspx)来存储每个值。虽然现在你需要在解码时知道矩阵的维数。如果不这样做，则可以将其存储为 int，然后如果您打算序列化数据，则可以将其存储为数据本身。

就像是：

```
var input = @"1,0,0,1,1,1
              0,1,0,1,1,1
              1,0,0,1,0,0
              0,1,1,0,1,1
              1,0,0,0,0,1
              0,1,0,1,0,1";

var values = new List<bool>();
foreach(var c in input)
{
  if (c == '0')
    values.Add(false);
  else if (c == '1')
    values.Add(true);
}

var ba = new BitArray(values.ToArray()); 
```

然后序列化 BitArray。~~您可能需要添加填充位数才能正确解码数据~~。（4096 * 4096 可以被 8 整除）。

除非矩阵中有大量重复模式（是的，我假设数据大部分是随机的），否则 BitArray 方法应该可以为您提供最大的压缩。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-06T09:35:09.037

尝试创建自己的算法来专门压缩此数据很可能不会产生太多效果。

```
Create a GZipStream with Max CompressionLevel
Run a 4096x4096 loop
 - set all 64 bits of a ulong to bits of the array
 - when 64 bits are done write the ulong to the compressionstream and start at the first bit again 
```

这将很容易地将您的多维数据集添加到一个非常压缩的内存块中

# assembly - 关于编译器和汇编器的一些问题

> ID：13247792
> 
> 赞同：1
> 
> 时间：2012-11-06T09:12:09.497
> 
> 标签：assembly, compiler-construction, machine-code, object-code

很多基本的问题都在我的脑海里。我需要清除它们。

**语句 1：**编译器将人类可读的代码转换为目标代码，然后通过链接器将这些代码转换为机器代码（可执行文件）。

我在这里吗？

在[wikipedia](http://en.wikipedia.org/wiki/Object_file)上，它是这样写的

```
Object files are produced by an assembler, compiler, or other language
translator, and used as input to the linker. 
```

**问题 1：**汇编程序将汇编语言代码 ( `MOV A, B` `ADD C`) 转换为机器代码。对于像 C++ 这样的高级语言，它是由上面的链接器生成的。所以汇编程序不在任何地方使用。那么它如何创建一个上面写的目标文件呢？

生成中间代码以使代码在不同的架构上运行。

**问题 2：** *.class（字节码）文件是由 java 编译器目标文件创建的吗？如果是，那么我们可以说运行它们的 JVM 是一种链接器（但是它不创建可执行文件）？

**问题 3：**当我们在 Turbo C++ 中编译 C++ 程序时，我们会得到 *.obj 文件，它们是目标文件。我们可以使用它们在其他架构中生成可执行文件吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-06T09:57:52.157

问题 1：是的，汇编程序（as、gas、nasm、masm）将汇编指令编译为目标代码。在高级语言 (H) 的情况下，编译器将 H 编译为另一种语言（例如 GHC，Glorious Haskell 编译器可以生成 C，但它也可以生成 C--，并且尝试（？）生成Java），或通过中间步骤（或语言 C-- 或核心）转换为目标代码。

生成中间代码的原因有很多： 1\. 可移植性，例如来自 java 的 .class 文件，用于 Pascal 的 p 代码 2\. 便于代码优化

问题 2：java 编译器可以生成 .class 文件，但 Scala 也生成 .class 文件，AspectJ（面向方面​​的风格）也生成 .class 文件。.class 文件不是目标文件，因为它们需要 Java 虚拟机（并且 unix 链接器`ld`不会将 .class 文件链接到 .o 文件）。原始 JVM 是 .class 文件的解释器，但您也可以即时编译 java。

问题 3：Turbo C++ .obj 文件（在 64 位 intel 上编译）在 Z80 机器上不会令人满意，除非编译器可以选择交叉编译另一个架构，所以对于 Turbo C++，目标文件的用途不是跨平台的可移植性。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-06T09:36:57.753

*目标文件是要链接*的“机器代码”（.text）、初始化数据和符号的集合。

一个有效的目标文件可以只包含数据，例如字节码。

链接器是将一大堆对象映射到虚拟地址空间并解析某些外部符号属于哪个地址的程序。这允许程序的增量开发，因为在调用例如函数 printf 时只需要知道一个接口。链接器将在链接阶段将 printf 的真实地址注入机器代码中。这是通过*重定位表*完成的。

这部分回答了问题 #3：不能直接使用由另一种架构创建的目标文件。接口方法不一定是二进制兼容的。obj 文件格式也可以不同。但是，如果真的付出努力，可以编写包装器（很可能在汇编中），它可以从 Visual C 调用在 Turbo C 中编译的对象。如果指令集和内存模型等完全不同，仍然可以编写一个仿真器来调用功能。在编写例如视频播放框架时会经常使用这些方法，这些框架可以调用一些仅在 .dll 中提供的传统视频解码器。

当操作系统将可执行文件从磁盘加载到内存或程序与“动态库”链接时，链接也会部分发生。在这些情况下，可以向“printf”注入许多调用，但链接器只调用“存根”，一旦被调用，就会从操作系统加载正确的库并用库函数替换自身。

声明#1 不够正确。编译器和汇编器将人类可读的代码转换为机器代码，尽管一些编译器会产生中间语言来解释（和/或“及时”编译）。在这最后阶段，编译真正意味着它应该做的——编译成机器代码。

Gcc 包含一个汇编器和链接器。可以`int main() { printf("HelloW\n");}`用`gcc -S hw.c`汇编器（hw.s）编译，这是*符号机器码*，插入或替换一些行并重新编译为目标代码`gcc -c hw.s`，最后链接`gcc -o hw.exe hw.o`

# asp.net - 将变量从后面的 aspx JScript 代码传递到标记 aspx 文件

> ID：13247795
> 
> 赞同：0
> 
> 时间：2012-11-06T09:12:25.490
> 
> 标签：asp.net, code-behind, jscript

我找不到将我的代码隐藏 aspx.js 文件中声明的变量传递给相应的代码隐藏.aspx 标记文件的方法。我不断收到的错误是：

```
Parser Error Message: Code blocks are not allowed in this file. 
```

我的 Code-Behind.aspx.js 看起来像这样：

```
import System;

package Test {
    class CodeBehind extends System.Web.UI.Page {
        public var my_var;

        public function Page_Load(sender, E:System.EventArgs) {
            my_var = "This is my_var.";
        }
    }
} 
```

我像这样手动编译代码隐藏文件：

> jsc.exe /t:library /out:bin\codebehind.dll codebehind.aspx.js

Code-Behind.aspx 如下所示：

```
<%@ Page Language="JScript"  Inherits="Test.CodeBehind" CompilationMode="Never" %>
<HTML>
<HEAD>
<TITLE>Hello World Test</TITLE>
</HEAD>
<BODY STYLE="font-size:12;font-family:arial,verdana,sans-serif;">
<FORM RUNAT="server">
    <%= my_var %>
</FORM>
</BODY>
</HTML> 
```

我知道有 ASP.NET 服务器控件，例如 asp:label 和所有这些东西，但我想要的只是打印出用作占位符的简单变量的内容。

我不希望网站在每次请求时都进行编译，我希望将 CompilationMode 选项设置为“从不”，并尽可能手动编译所有代码。

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-06T09:37:20.127

**代码隐藏**

```
protected string my_var { get; set; }

protected void Page_Load(object sender, EventArgs e)
{
    my_var = "Hello";
} 
```

**html**

```
<%= my_var %> 
```

# javascript - 如何防止 iFrame 中的 JavaScript 访问外部站点的属性，即使 iFrame 的内容来自同一来源？

> ID：13247798
> 
> 赞同：6
> 
> 时间：2012-11-06T09:12:33.117
> 
> 标签：javascript, iframe, same-origin-policy

基本上我想要一个 iFrame，它总是限制它的内容，就好像它来自不同的域一样，即使内容来自同一个来源。

有没有办法做到这一点？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-11-28T19:17:25.417

最好的解决方案可能是在 iframe 上使用 HTML5 沙箱属性，它（默认情况下）显式禁用脚本和对父 DOM 的同源访问。

[在http://msdn.microsoft.com/en-us/hh563496.aspx](http://msdn.microsoft.com/en-us/hh563496.aspx)很好的介绍

[截至 2012 年 12 月，大多数当前浏览器](http://caniuse.com/iframe-sandbox)似乎都支持此功能。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-06T10:19:38.657

这将隐藏`window.parent`在子框架/窗口中，但不会隐藏在`top`属性中。

但是在`window.parent`子窗口/框架的 onload 事件结束之前，该属性仍然可以访问。

```
<html>
  <head>
    <style type="text/css">
      #wrapper {width:1000px;height:600px;}
    </style>
    <script type="text/javascript">
      window.onload = function() {
        var frm = document.getElementById('childFrame');
        var win = frm.contentWindow || (frm.contentDocument && frm.contentDocument.parentWindow) || (frm.document && frm.document.parentWindow);
        if (win) win.parent = null;
      }
    </script>
  </head>
  <body>
    <div id="wrapper">
      <iframe id="childFrame" src="child.html" frameborder="0" style="width:100%;height:100%;"></iframe>
    </div>
  </body>
</html> 
```

# ruby-on-rails - ActiveRecord 是否缓存 table_name？

> ID：13247799
> 
> 赞同：1
> 
> 时间：2012-11-06T09:12:34.230
> 
> 标签：ruby-on-rails, ruby-on-rails-3, activerecord

我有一个`ActiveRecord`类需要根据配置开关查看两个不同的表，所以我打算执行以下操作：

```
def table_name
  config_is_on? ? :table1 : :table2  
end 
```

我想知道在`table_name`针对此模型运行查询时是否始终调用该方法：配置更改时不会重新启动应用程序**，**因此无法缓存此值。

在应用程序启动/初始化期间是否`ActiveRecord`总是评估或只评估一次？`table_name`如果它被缓存了，我如何强制它`table_name`每次都进行评估？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-06T09:16:59.290

不仅是表名，还有列定义。您最好使用像 Apartment gem 这样的模式设置。根据请求的某些状态，数据库中的实际表搜索路径被设置为某个值。所以你可以做两个模式，一个与第一个表，一个与第二个（其余表可能仅在一个模式上）并更改搜索路径，您将获得不同的数据。

# javascript - 在javascript中动态生成行？

> ID：13247801
> 
> 赞同：4
> 
> 时间：2012-11-06T09:12:37.173
> 
> 标签：javascript

我是 javascript 的新手，我想在按下“Tab”时动态生成行，并希望获取在动态生成的行中输入的值，以便我可以在我的 servlet 代码中使用这些值。

这是我的html

```
<html>
<head>
<title> Add/Remove dynamic rows in HTML table </title>
<script src="table.js" language="javascript" /></script>
</head>
<body onload="hello()">
    <form action="servletname">
<input type="button" value="Delete Row" onclick="deleteRow()" />        
<table id="table1" width="350px" border="2">
<tr>
    <td align="center"> Sr.No </td>
    <td align="center" style="width:50px;"> Code </td>
    <td align="center" style="width:1100px;"> Test Name </td>
    <td align="center" style="width:80px;"> Rate </td>
</tr>
</table> 
<table id="table2" width="350px" border="2">
<tr>
    <td><input type="checkbox" name="chk"/></td>
    <td> 1 </td>
    <td> <input type="text" id="tc" style="width:50px;" /> </td>
    <td> <input type="text" id="tn" style="width:190px;" /> </td>
    <td> <input type="text" id="rt" style="width:80px;" onkeypress="KeyCheck(event)" /> </td>   
</tr>
</table> 
<br><input type="text" id="rt1" style="width:80px;"/>
</form>
</body>
</html> 
```

“row.js”文件的代码是：

```
function hello()
{   
   document.getElementById("tc").focus();
}

function KeyCheck(e)
{
   var KeyID = (window.event) ? event.keyCode : e.keyCode;
   if(KeyID==9)
   {
      addRow();
   }
}

function addRow()
{
    var table = document.getElementById("table2");

    var rowCount = table.rows.length;
    var row = table.insertRow(table.rows.length);

    var cell1 = row.insertCell(0);
    var element1 = document.createElement("input");
    element1.type = "checkbox";
    cell1.appendChild(element1);

    var cell2 = row.insertCell(1);
    cell2.innerHTML = rowCount + 1;

    var cell3 = row.insertCell(2);
    var element2 = document.createElement("input");
    element2.type = "text";
    element2.style.width = "50px";
    cell3.appendChild(element2); 

    var cell4 = row.insertCell(3);
    var element3 = document.createElement("input");
    element3.type = "text";
    cell4.appendChild(element3); 

    var cell5 = row.insertCell(4);
    var element4= document.createElement("input");
    element4.type = "text";
    element4.style.width = "80px";
    cell5.appendChild(element4);

    element4.focus();   // to shift focus on last cell in newly generated row

    //to generate new row if enter is pressed in focused cell of newly generated row.
    element4.onkeypress=KeyCheck; 
} 
```

但它不检测“Tab”或除“Enter”键之外的任何其他键。请告诉我如何在该程序中检测“Tab”或其他键，以及如何访问在这些动态生成的行中输入的值。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-06T09:43:15.740

Use the following js function for add row:

function addRow() { var table = document.getElementById("table2");

```
 var rowCount = table.rows.length;
          var row = table.insertRow(table.rows.length);

          var cell1 = row.insertCell(0);
          var element1 = document.createElement("input");
          element1.type = "checkbox";
          cell1.appendChild(element1);

          var cell2 = row.insertCell(1);
          cell2.innerHTML = rowCount + 1;

          var cell3 = row.insertCell(2);
          var element2 = document.createElement("input");
          element2.type = "text";
          element2.style.width = "50px";
          cell3.appendChild(element2);

          var cell4 = row.insertCell(3);
          var element3 = document.createElement("input");
          element3.type = "text";
          cell4.appendChild(element3);

          var cell5 = row.insertCell(4);
          var element4 = document.createElement("input");
          element4.type = "text";
          element4.style.width = "80px";
          element4.onkeypress = KeyCheck;
          cell5.appendChild(element4);
          element4.focus();// to shift focus on last cell in newly generated row
          //to generate new row if enter is pressed in focused cell of newly generated row.

      } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-06T09:22:22.643

您正在错误地设置事件处理程序。它应该是：

`element4.onkeypress=KeyCheck`

[http://jsfiddle.net/SMDhu/4/](http://jsfiddle.net/SMDhu/4/)

对于`Tab`键，您需要`keydown`使用键码 9 处理。要获取字段内值内的值，只需访问`value`DOM 元素的属性。

[http://jsfiddle.net/mihaifm/24s8e/2/](http://jsfiddle.net/mihaifm/24s8e/2/)

# web-applications - 在不使用 iframe 的情况下更快地加载另一个页面

> ID：13247802
> 
> 赞同：0
> 
> 时间：2012-11-06T09:12:52.217
> 
> 标签：web-applications, iframe

我有一个带有表单和 iframe 的主页，显示表单的结果。每次用户更改表单中的某些内容时，都会重新加载 iframe 中的页面以显示结果。但是，iframe 真的很慢。有没有更快的方法来执行像 iframe 一样的操作？或者有没有办法让 iframe 更快？预先感谢。

编辑：每次按键后 iframe 都不会刷新。例如，如果用户在表单中选择“apple”，则表单会提交给 php，然后由 php 检索苹果照片，然后将其显示在 iframe 中。我的问题是加载速度很慢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-06T09:20:20.043

无论您只是刷新 iFrame 还是通过 ajax 获取数据，仍然需要一个 http 请求，我想您的选择是查看优化返回的数据以及如何呈现数据，并查看调用次数是否可以减少，即如果每次按键后刷新 iframe，可能会检测到用户何时停止键入，然后刷新 iframe？

# android - onCreateOptionsMenu 无法正常工作

> ID：13247807
> 
> 赞同：1
> 
> 时间：2012-11-06T09:13:05.930
> 
> 标签：android, android-menu

我有这个`onCreateOptionsMenu`方法反复出现的问题。我已经设置好了，所以它根据 some 的值启用或禁用选项`SharedPreferences`，但是由于某种原因，当你第一次打开菜单时它不能正常工作，应该禁用的选项被启用，反之亦然大约。如果我关闭它并重新打开它，它工作正常。

```
 @Override
public boolean onCreateOptionsMenu(Menu menu) {
    getMenuInflater().inflate(R.menu.activity_main, menu);
    menuConfig(menu);
    return true;
}

@Override
public boolean onPrepareOptionsMenu (Menu menu) {
    menuConfig(menu);
    return true;
}

public void menuConfig(Menu menu){
    menu.getItem(getResources().getInteger(R.integer.MENU_ABOUT)).setEnabled(true);
    if (preferences.getBoolean(getString(R.string.PREFS_STARTED), false)){
        menu.getItem(getResources().getInteger(R.integer.MENU_START)).setEnabled(false);
        menu.getItem(getResources().getInteger(R.integer.MENU_STOP)).setEnabled(true);
    }else{
        menu.getItem(getResources().getInteger(R.integer.MENU_START)).setEnabled(true);
        menu.getItem(getResources().getInteger(R.integer.MENU_STOP)).setEnabled(false);
    }
    if(!preferences.getBoolean(getString(R.string.PREFS_STARTED),false) && preferences.getBoolean(getString(R.string.PREFS_FILES_CREATED),false)){
        menu.getItem(getResources().getInteger(R.integer.MENU_DELETE)).setEnabled(true);
        menu.getItem(getResources().getInteger(R.integer.MENU_SET_ID)).setEnabled(true);
    }
    else{
        menu.getItem(getResources().getInteger(R.integer.MENU_DELETE)).setEnabled(false);
        menu.getItem(getResources().getInteger(R.integer.MENU_SET_ID)).setEnabled(false);
    }
} 
```

这两张照片是在每次按下菜单键之间的几秒钟后拍摄的。 ![第一次按菜单键，错误](../Images/e2b91d330ae095b696e0baa239be40fc.png) ![第二个菜单键按下，RIGHT](../Images/05cd47a1f5d1dc6539099c79f14f073b.png)

第一个是错误的，它应该看起来像第二个。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-06T09:39:45.280

我通过将查询返回的默认值更改为`SharedPreferences`对象来修复它，但我不知道实际发生了什么。

# c++ - 在 C++ 中将 DWORD 值写入注册表

> ID：13247811
> 
> 赞同：2
> 
> 时间：2012-11-06T09:13:11.557
> 
> 标签：c++, windows, registry, registrykey, dword

我正在尝试在 C++ 中以编程方式将 DWORD 值写入注册表。

我做了一些搜索，发现以前有人问过这个问题。我试图遵循他们的解决方案，但提出了一个非常令人沮丧的问题，据我所知，他们的解决方案尚未解决。

这是我的代码：

```
HKEY hKey;
LPCWSTR sKeyPath;
int iResult;

sKeyPath = L"Software\\ABI\\";
iResult = RegOpenKeyEx(HKEY_CURRENT_USER, sKeyPath, NULL, KEY_ALL_ACCESS, &hKey);
DWORD value = 0x00000003;
iResult = RegSetValueEx(hKey, L"Test", NULL, REG_DWORD, (const BYTE*)value, sizeof(value));
RegCloseKey(hKey); 
```

我做了一些基本的调试，发现`iResult`调用后的值为998 `RegSetValueEx`。我确信这个键存在于 Windows 注册表中，因为我使用 regedit.exe 手动创建了它以进行测试。DWORD "Test" 的值最初是 0x00000009，并且在我运行我的程序后没有改变。

我不确定我错在哪里。

任何帮助，将不胜感激。

PS 对于错误 998，我没有设法在网上找到任何有用的站点。我发现的唯一参考资料提到这是处理注册表时可能遇到的最严重错误。

PPS 顺便说一句，我在 Windows 8 上运行这个程序。我不认为这会改变任何东西，但我之前在 Windows 8 上遇到过一些奇怪的安全问题。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-11-06T09:16:31.020

您需要传递的*地址*`value`：

```
iResult = RegSetValueEx(hKey,
                        L"Test",
                        NULL,
                        REG_DWORD,
                        (const BYTE*)&value, // Change made here.
                        sizeof(value)); 
```

错误代码的`998`意思是：

> 对内存位置的无效访问。

当`value`未传递的地址时，其实际值 ( `3`) 被用作内存地址，从而导致失败。

# expressionengine - 最后一段丢失时重定向

> ID：13247822
> 
> 赞同：6
> 
> 时间：2012-11-06T09:14:03.040
> 
> 标签：expressionengine

我有一个单一的条目 url 结构，如：

www.site.com/template_group/template_1/entry_id

但我希望它是：

www.site.com/template_group/template_1/entry_id/url_title。

Entry_id 将是馈送 exp:channel:entries 的段。如何将 www.site.com/template_group/template_1/entry_id 重定向到 www.site.com/template_group/template_1/entry_id/url_title。

非常感谢！

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-11-06T09:30:16.213

像下面这样的东西应该可以工作 - 它未经测试，但它会让你很好地了解如何继续它。

```
{if segment_4==""}
{exp:channel:entries channel="x" limit="1" dynamic="no" entry_id="{segment_3}"}
    {redirect="template_group/template_1/{entry_id}/{url_title}"}
{/exp:channel:entries}
{/if} 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-11-06T09:30:45.230

把它放在模板的最顶部：

```
{if segment_4 == ""}
   {exp:channel:entries channel="channel_goes_here" entry_id="{segment_3}"}
       {redirect="{site_url}/{segment_1}/{segment_2}/{segment_3}/{url_title}
   {/exp:channel:entries}
{/if} 
```

这将检查您是否设置了第四个片段，如果没有，它将包含您的 entry_id 的第三个片段，将其提供给频道条目标签，该标签返回您需要的 url_title。使用此 url_title，您可以轻松地重定向到正确的页面。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-11-06T11:00:40.540

janvl 和 madebyhippo 的好答案

快速注意，如果您使用[复杂的条件](http://expressionengine.com/forums/viewthread/168268/)（答案中的条件很简单，所以您不会遇到这个问题）是 EE 将解析它们包含的频道条目标签，这会降低性能。

[如果您发现自己处于这种情况，最好使用诸如switchee](http://devot-ee.com/add-ons/switchee)或[ifelse 之](http://devot-ee.com/add-ons/ifelse)类的 Mark "The croxton" 插件来完全避免该问题

# jetty - 嵌入 Restlet + Jetty 的压缩

> ID：13247824
> 
> 赞同：1
> 
> 时间：2012-11-06T09:14:10.430
> 
> 标签：jetty, restlet, embedded-jetty, maven-jetty-plugin, restlet-2.0

我正在尝试在嵌入的restlet + jetty中启用压缩，但在我的测试应用程序中，压缩仅适用于servlet直接处理的请求，而不适用于restlet处理的请求。

我的测试代码：

```
package restlettest;

import java.io.IOException;
import java.util.EnumSet;

import javax.servlet.DispatcherType;
import javax.servlet.ServletException;
import javax.servlet.http.HttpServlet;
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;

import org.eclipse.jetty.server.Server;
import org.eclipse.jetty.servlet.ServletContextHandler;
import org.eclipse.jetty.servlets.GzipFilter;
import org.restlet.Application;
import org.restlet.Restlet;
import org.restlet.ext.servlet.ServerServlet;
import org.restlet.routing.Router;

public class RestletTestServerJettyEmbedded {

    public static class RestletTestApplication extends Application {

        @Override
        public synchronized Restlet createInboundRoot() {

            Router router = new Router(getContext());
            router.attach("/sayHello", HelloWorldResource.class);

            return router;
        }
    }

    @SuppressWarnings("serial")
    public static class JettyServlet extends HttpServlet {

        @Override
        protected void doGet(HttpServletRequest req, HttpServletResponse resp)
                throws ServletException, IOException {

            resp.getWriter().println("Hello from jetty!");
        };
    }

    public static void main(String[] args) throws Exception {

        Server server = new Server(8080);

        final ServletContextHandler serveltContext = new ServletContextHandler(
                ServletContextHandler.SESSIONS);
        serveltContext.setContextPath("/");
        serveltContext.setInitParameter("org.restlet.application",
                RestletTestApplication.class.getName());

        serveltContext.addFilter(GzipFilter.class, "/*",
                EnumSet.of(DispatcherType.REQUEST));

        serveltContext.addServlet(ServerServlet.class, "/restlet/*");
        serveltContext.addServlet(JettyServlet.class, "/jetty/*");

        server.setHandler(serveltContext);

        server.start();
        server.join();
    }
} 
```

项目POM：

```
<project xmlns="http://maven.apache.org/POM/4.0.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd">

    <modelVersion>4.0.0</modelVersion>
    <groupId>com.devmao.restlettest</groupId>
    <artifactId>restlettest</artifactId>
    <packaging>jar</packaging>
    <version>0.0.1-SNAPSHOT</version>

    <properties>

        <project.build.sourceEncoding>UTF-8</project.build.sourceEncoding>

        <jetty.version>8.1.7.v20120910</jetty.version>
        <restlet.version>2.1.0</restlet.version>

    </properties>

    <dependencies>

        <!-- Jetty -->
        <dependency>
            <groupId>org.eclipse.jetty</groupId>
            <artifactId>jetty-servlets</artifactId>
            <version>${jetty.version}</version>
        </dependency>

        <dependency>
            <groupId>org.eclipse.jetty</groupId>
            <artifactId>jetty-webapp</artifactId>
            <version>${jetty.version}</version>
        </dependency>
        <!-- /Jetty -->

        <!-- Restlet -->
        <dependency>
            <groupId>org.restlet.jee</groupId>
            <artifactId>org.restlet.ext.servlet</artifactId>
            <version>${restlet.version}</version>
            <scope>compile</scope>
        </dependency>

        <dependency>
            <groupId>org.restlet.jee</groupId>
            <artifactId>org.restlet.ext.httpclient</artifactId>
            <version>${restlet.version}</version>
            <scope>compile</scope>
        </dependency>
        <!-- /Restlet -->

        <dependency>
            <groupId>org.apache.httpcomponents</groupId>
            <artifactId>httpclient</artifactId>
            <version>4.2.2</version>
            <scope>compile</scope>
        </dependency>

    </dependencies>

    <build>
        <plugins>

            <plugin>
                <groupId>org.apache.maven.plugins</groupId>
                <artifactId>maven-compiler-plugin</artifactId>
                <version>2.3.2</version>
                <configuration>
                    <source>1.6</source>
                    <target>1.6</target>
                </configuration>
            </plugin>

        </plugins>
    </build>

    <repositories>

        <!-- Restlet Repositories -->
        <repository>
            <id>maven-restlet</id>
            <name>Public online Restlet repository</name>
            <url>http://maven.restlet.org</url>
        </repository>
        <!-- /Restlet Repositories -->

    </repositories>
</project> 
```

测试 servlet 请求：

```
$ curl -i -H 'Accept-Encoding: gzip,deflate' http://localhost:8080/jetty
HTTP/1.1 200 OK
Vary: Accept-Encoding
Content-Encoding: gzip
Transfer-Encoding: chunked
Server: Jetty(8.1.7.v20120910) 
```

测试 restlet 请求：

```
$ curl -i -H 'Accept-Encoding: gzip,deflate' http://localhost:8080/restlet/sayHello
HTTP/1.1 200 OK
Vary: Accept-Encoding
Content-Type: text/plain;charset=UTF-8
Date: Tue, 06 Nov 2012 09:24:01 GMT
Accept-Ranges: bytes
Server: Restlet-Framework/2.1.0
Vary: Accept-Charset, Accept-Encoding, Accept-Language, Accept
Content-Length: 12 
```

# gpu - Direct X 11 和 GPU 加速（模拟等） - 从哪里开始？

> ID：13247826
> 
> 赞同：1
> 
> 时间：2012-11-06T09:14:18.453
> 
> 标签：gpu, directx-11, hardware-acceleration

我正在使用 SharpDX 并且目前对它相当满意，但是对于大学的评估，我需要创建一个利用某种 GPU 加速的演示。这是一项“独立研究”任务——这意味着，我给自己分配了这个任务。我对游戏中的 GPU 加速非常感兴趣，但现在感觉就像我把自己扔得太深了。

我打算做一个粒子系统（这将是一个非常基本的系统，粒子发射/下降/死亡），但我需要一个起点。

有人可以指出我正确的方向吗？要阅读的文章？要考虑的事情？我已经用谷歌搜索了“GPU 加速 DirectX”之类的东西，但我找不到任何可靠的结果！我希望我有一种用于 GPU 加速的“hello world”……！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-06T11:55:40.937

如果您想了解如何构建 GPU 粒子系统，建议您阅读《[Practical Rendering And Compution with Direct3D11](https://rads.stackoverflow.com/amzn/click/com/1568817207)》一书，其中有一整章专门介绍如何实现简单的 GPU 粒子系统。

然后最棘手的部分可能是上一本书中没有详细介绍的排序算法，但是您可以查看旧 DirectX 2010 年 6 月的 ComputeShaderSort11 示例，它可以帮助您很多（实现非常高效）。

此外，我在工作中使用 SharpDX 在 GPU 上做了一个完整的粒子引擎，因此使用 SharpDX 可以完美实现。

# quickfix - QuickFIX - 设置 StartTime\EndTime

> ID：13247829
> 
> 赞同：3
> 
> 时间：2012-11-06T09:14:23.910
> 
> 标签：quickfix

[QuickFIX](http://www.quickfixengine.org/)有一个[配置文件](http://www.quickfixengine.org/quickfix/doc/html/configuration.html)，您可以在其中设置`StartTime`和`EndTime`. 不幸的是，AFAIK QuickFIX 仅支持此配置的 UTC，而交换通常取决于时区。这意味着您需要记住每次时钟更改时更新此配置文件。

**有没有办法以编程方式而不是通过配置文件设置`StartTime`\参数？`EndTime`**这样您就可以通过编程方式调整时间设置正确的值。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-06T09:23:38.387

有一种方法可以设置它。您可以按如下方式设置时区：

```
TimeZone=America/New_York 
```

请参阅[配置](http://www.quickfixj.org/quickfixj/usermanual/1.5.1/usage/configuration.html#Session)指南。

奇怪的是，它不在 quickfix 配置指南中，而在 quickfixJ 指南中。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-06T15:21:00.087

在我们的生产环境中，我们始终使用 UTC 时间。

在 QuickFIX 配置文件中，为每个交易对手添加以下行：

> 使用本地时间=N

请阅读此处的文档： [http ://www.quickfixengine.org/quickfix/doc/html/configuration.html#Session](http://www.quickfixengine.org/quickfix/doc/html/configuration.html#Session)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2018-06-07T15:26:09.300

[根据 quickfix 文档](http://www.quickfixengine.org/quickfix/doc/html/configuration.html)，您应该添加

`set UseLocalTime=Y`

> 指示 StartTime 和 EndTime 以本地时间而不是 UTC 表示。消息中的时间仍将设置为 UTC，因为这是 FIX 规范所要求的。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2022-02-01T11:23:57.653

我们有一个错误

```
System.ArgumentException: Only UTC time is supported
Parameter name: oldtime
at QuickFix.SessionSchedule.IsNewSession(DateTime oldtime_utc, DateTime testtime_utc)
at QuickFix.Session.get_IsNewSession() 
```

修复它的唯一方法是删除`store`目录。大概是`session`这样的时间戳

[![在此处输入图像描述](../Images/99a51baa0c434031885446c6578a4360.png)](https://i.stack.imgur.com/a4mjA.png)

# android - getApplicationContext 到 Activity CastException

> ID：13247833
> 
> 赞同：2
> 
> 时间：2012-11-06T09:14:35.733
> 
> 标签：android, android-lifecycle, android-context

我必须发送`getApplicationContext`到一个方法，在这个方法中，我必须将上下文转换为要使用的活动

```
getWindowManager().getDefaultDisplay().getMetrics(dm) 
```

但它显示了一个例外

> 原因：java.lang.ClassCastException：android.app.Application 无法转换为 android.app.Activity。

为什么`getApplicationContext`？因为我在主要活动中检查我的应用程序更新并且不想将其限制为活动（我想要生命周期）。

怎么处理？

**更新**
我有`FN.java`所有静态函数都在这里。一种方法 job ( `getUniqueID`) 是获取设备 ID 和屏幕宽度和高度等。另一方面，我有一个`Update.java`用于检查应用程序更新的方法。
在这堂课中，我使用`getUniqueID`.
为了在我的主要活动中使用更新类，我这样做：

```
if(updateInstance == null)
            updateInstance = new Update(getApplicationContext()); 
```

如果我通过`this`而不是`getApplicationContext`，我知道没关系，但我想使用`getApplicationContext`，因为也许用户单击某个菜单项并立即转到另一个活动或关闭应用程序；无论如何，我想显示通知。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-07-23T14:18:57.913

我只是用

```
this 
```

一切正常。

对于更新检查，请使用单例。

# android - Android：java.net.protocolException 不支持输出

> ID：13247836
> 
> 赞同：11
> 
> 时间：2012-11-06T09:14:39.287
> 
> 标签：android, httpurlconnection

我以前使用的是**HttpClient**和**BasicNameValuePairs**，出于某种原因我不得不转向**HttpUrlConnection**。

因此，这段代码使用某些参数发出 HttpPost 请求：

```
public class MConnections {

    static String BaseURL = "http://www.xxxxxxxxx.com";
    static String charset = "UTF-8";
    private static String result;
    private static StringBuilder sb;
    private static List<String> cookies = new ArrayList<String>();

    public static String PostData(String url, String sa[][]) {

        HttpURLConnection connection = null;
        try {
            connection = (HttpURLConnection) new URL(BaseURL + url)
                    .openConnection();
        } catch (MalformedURLException e1) {
        } catch (IOException e1) {
        }

        cookies = connection.getHeaderFields().get("Set-Cookie");
        try{
        connection.setDoOutput(true); // Triggers POST.
        connection.setRequestProperty("Accept-Charset", charset);
        connection.setRequestProperty("Content-Type",
                "application/x-www-form-urlencoded;charset=" + charset);
        }catch (Exception e) {

            //Here i get Exception that "java.lang.IllegalStateException: Already connected"
        }
        OutputStream output = null;
        String query = "";
        int n = sa.length;
        for (int i = 0; i < n; i++) {
            try {
                query = query + sa[i][0] + "="
                        + URLEncoder.encode(sa[i][1], "UTF-8");
            } catch (UnsupportedEncodingException e) {
            }
        }
        try {
            output = connection.getOutputStream();
            output.write(query.getBytes(charset));
        } catch (Exception e) {

            //Here i get Exception that "android: java.net.protocolException: Does not support output"
        } finally {

            if (output != null)
                try {
                    output.close();
                } catch (IOException e) {
                }
        }
        InputStream response = null;
        try {
            response = connection.getInputStream();
        } catch (IOException e) {

            //Here i get Exception that "java.io.IOException: BufferedInputStream is closed"
        } finally {

            //But i am closing it here
            connection.disconnect();
        }
        try {
            BufferedReader reader = new BufferedReader(new InputStreamReader(
                    response, "iso-8859-1"), 8);
            sb = new StringBuilder();
            sb.append(reader.readLine());
            String line = "0";
            while ((line = reader.readLine()) != null) {
                sb.append("\n" + line);
            }
            response.close();
            result = sb.toString();
        } catch (Exception e) {
        }
        return result;
    }
} 
```

但是我得到了代码中注释的**异常。**

实际上，我使用 AsyncTask 从我的 Activity调用**MConnections.PostData()两次。**这可能会导致**异常：已连接**但我正在使用**connection.disconnect**。但为什么我仍然得到那个异常？

我是否以错误的方式使用它？

谢谢你

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2013-09-03T17:49:19.723

对于协议异常，请在调用 getOutputStream() 之前尝试添加以下内容：

```
connection.setDoOutput(true); 
```

感谢 Brian Roach 在这里的回答发现了这个答案： [https ://stackoverflow.com/a/14026377/387781](https://stackoverflow.com/a/14026377/387781)

旁注：我在运行 Gingerbread 的 HTC Thunderbolt 上遇到了这个问题，但在运行 Jelly Bean 的 Nexus 4 上没有。

# javascript - 来自用户的输入，没有标签

> ID：13247845
> 
> 赞同：1
> 
> 时间：2012-11-06T09:14:59.560
> 
> 标签：javascript, html, css, input

我需要从用户那里获得输入，例如他的名字，但用户将无法编辑他的名字，就像在文本框中一样。这就是我现在正在使用的：

```
<input id="number_input" type="text" size="12" maxlength="19" /> 
```

为了编写或编辑他的名字，用户将使用已经存在的按钮。就像在计算器中一样。我怎样才能在 html 中实现这一点？

谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-06T09:18:56.037

我可能会考虑使用这个： http: [//net.tutsplus.com/tutorials/javascript-ajax/creating-a-keyboard-with-css-and-jquery/](http://net.tutsplus.com/tutorials/javascript-ajax/creating-a-keyboard-with-css-and-jquery/)

[在这里演示](http://d2o0t5hpnwv4c1.cloudfront.net/378_jqueryKeyboard/demo/index.html)

# c# - 每当浏览器在 asp.net 中关闭时，这是否可以清除会话？

> ID：13247848
> 
> 赞同：7
> 
> 时间：2012-11-06T09:15:22.483
> 
> 标签：c#, asp.net, session

在我的 asp.net 应用程序中，每当我的浏览器关闭或我的选项卡（如果我的浏览器包含多个选项卡）关闭时，我想清除会话。

请指导我摆脱这个问题......

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-11-06T09:20:53.927

短版，不。服务器没有可靠的方法来检测客户端是否关闭了浏览器。这只是 Web 开发异步模式的本质。

长版，如果它对你真的非常重要；在页面中放置一些 javascript，在后台向您的网站发送常规帖子，并设置服务器端代理或服务，如果它没有收到这些常规“心跳”信号，则处理会话。

您可以将 javascript 回发放到页面的 unload() 事件上，但不要依赖它，它并不总是触发。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-06T09:20:17.237

每当您关闭浏览器时，默认情况下都会发生这种情况，这不仅适用于 ASP.NET。它适用于大多数具有会话状态的服务器端编程语言。基本上，任何未指定到期日期的 cookie 都会在浏览器关闭时被删除。

这不适用的地方是当您关闭选项卡时，这是您无法控制的，因为选项卡关闭事件不会被发送回 Web 服务器。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-06T09:20:08.937

您可以尝试使用 javascript 来做到这一点。检查它：

[http://www.codeproject.com/Tips/154801/How-to-end-user-session-when-browser-closed](http://www.codeproject.com/Tips/154801/How-to-end-user-session-when-browser-closed)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-11-06T09:57:25.497

或者，您可以在每次新浏览器打开时检查您之前的会话状态，并且可以 Session.clear() 或 Session.abandon() 之前的会话。

这将确保每次启动应用程序时都会获得新会话。

1.  在您的 .net 应用程序中使用 BasePage。
2.  检查基本页面加载时的 session.sessionid。
3.  更多信息如何检测基本页面中的新会话。[BasePage.Session.Link](http://www.dreamincode.net/forums/topic/45300-base-page-for-detecting-session-timeout-in-aspnetc#/)

希望这对Shaz有所帮助

```
public class BasePage : Page
{

            protected string mySessionId;   

            private CurrentUser _currentUser;
            public CurrentUser _CurrentUser
            {
                get { return ((CurrentUser)HttpContext.Current.Session["myCurrentUser"]); }
                set { _currentUser = value; }
            }

            protected override void OnLoad(EventArgs e)
            {

                if (Session["myCurrentUser"] != null)
                {
                    if (_CurrentUser.ProUser)
                    {

                       mySessionId = Session.SessionID; // it means New Session

                    }

                    if (!mySessionId.IsNullOrDefault() && mySessionId != Session.SessionID)
                    {
                        Session.Abandon(); //Abandon current session and start new one                

                    }
                }

            }

} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-11-06T09:20:13.213

我认为`cookies`可以更好地满足您对会话管理的要求。

> 这意味着会话数据不应该存储在服务器上，并且应该与您的通话一起使用，这样您就不必担心清除服务器上的数据。

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2017-05-23T10:22:44.387

是的。首先，当浏览器关闭时，浏览器会自动清除会话。您可以尝试使用卸载前和卸载时的 javascript 函数在浏览器中捕获浏览器关闭或选项卡关闭事件。大多数情况下，onbefore unload 事件捕获 chrome、Firefox、IE 11 中的浏览器关闭事件。

* * *

## 回答 #7

> 赞同：-2
> 
> 时间：2012-11-06T09:43:31.200

您可以使用 Global.aspx 的 Session_End 事件

```
//For Specific Session
Session.Remove("SessionName");

//All the Session
Session.Abandon(); 
```

# javascript - 在动画完成之前禁用点击事件

> ID：13247849
> 
> 赞同：8
> 
> 时间：2012-11-06T09:15:24.233
> 
> 标签：javascript, jquery

在我的游戏中，我有一个填满单词的网格。要拼写单词，用户必须单击称为“拖动”的一侧的字母。当一个字母被点击时，它会动画到网格上的位置。

我遇到的问题是用户可以快速单击字母，这会使程序崩溃。为了解决这个问题，我想禁用点击事件，直到动画完成。

过去我曾经使用过一个`setTimeOut`函数，但它不是一个可靠的方法，因为时间完全取决于浏览器的速度。

这是点击事件：

```
$('.drag').on('click', function (e) {
    e.preventDefault();
    var target = $('.highlight-problem .drop-box:not(.occupied):first');
    var targetPos = target.parents('td').position();
    console.log(targetPos);
    var currentPos = $(this).offset();
    var b = $(this);
    if (target.length) {
        target.addClass("occupied");
        $(".occupied").parent(".flip-wrapper").addClass("flipped");
        var clonedObject = b.clone()
        if (b.data("letter") == target.parents('td').data("letter")) {
            clonedObject.addClass("right-letter");
            target.addClass('right-letter');
            setTimeout(function () {
                hitSound.play();
            }, 550);
        } else {
            clonedObject.addClass("wrong-letter");
            target.addClass('wrong-letter');
            setTimeout(function () {
                missSound.play();
            }, 550);
        }
        clonedObject.appendTo("table").css({
            position: "absolute",
            top: currentPos.top,
            left: currentPos.left
        }).stop().animate({
            top: targetPos.top,
            left: targetPos.left
        }, "slow", function () {
            $(this).prop('disabled', false).css({
                top: 0,
                left: 0
            }).appendTo(target);
            var spellWord = $('.highlight-problem .drop-box');
            if (!spellWord.filter(':not(.occupied)').length) {
                var wordIsCorrect = 0;
                spellWord.each(function () {
                    if ($(this).parents('td').data("letter") == $(this).find("div").data("letter")) {
                        console.log('letter is: ' + $(this).find("div").data("letter"))
                        wordIsCorrect++;
                    }
                }); 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-11-06T09:17:50.297

### 您可以通过简单的 3 个步骤来完成。

1.  声明一个名为的全局变量`animationComplete`并将其设置为`false`.

    ```
    var animationComplete = false; 
    ```

2.  在您的`.animate({...});`函数中，在动画完成后切换值。

    ```
    .animate({
        top: targetPos.top,
        left: targetPos.left
    }, "slow", function () {
        ...
        animationComplete = true;
    }); 
    ```

3.  使用全局变量检查完整性。

    ```
    if (animationComplete)
    {
        // Do something!
    } 
    ```

### 完整代码

**JavaScript**

```
animationComplete = true;
$(document).ready(function(){
    animationComplete = false;
    $(".background").animate({
        height: 50,
        width: 50
    }, 10000, function(){
        animationComplete = true;
    });
    $("button").click(function(){
        if (animationComplete)
            $(".background").animate({
                height: 200,
                width: 200
            }, 10000, function(){
                animationComplete = false;
            });
        else
            alert("Please wait till the animation is complete!");
    });
}); 
```

**HTML**

```
<div class="background"></div>
<button>Click me!</button>​ 
```

**CSS**

```
.background {background: red;} 
```

### 小提琴：http: [//jsfiddle.net/KAryP/](http://jsfiddle.net/KAryP/)

### 在这里为您的代码小提琴：http: [//jsfiddle.net/smilburn/Dxxmh/94/](http://jsfiddle.net/smilburn/Dxxmh/94/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-06T09:18:25.557

无法测试代码 atm，但应该检查元素是否在 click 函数中没有动画

```
if(!$('selector:animated')){

} 
```

# c - HiC：结构中的结构？

> ID：13247853
> 
> 赞同：2
> 
> 时间：2012-11-06T09:15:37.700
> 
> 标签：c, compiler-errors, structure

这是我第一次在结构中使用结构。编译程序时遇到此错误。错误：字段“结果”的类型不完整。

错误是指这行代码。-->struct result_t 结果；

请问有什么帮助吗？：） 谢谢。

```
typedef struct {
char moduleCode[8];
char grade[3];
} result_t;

typedef struct {
char name[31];
struct result_t results;
} student_t; 
```

编辑：

我改变了我的代码：

```
typedef struct {
char moduleCode[8];
char grade[3];
} result_t;

typedef struct {
char name[31];
result_t results;
} student_t; 
```

我得到了一个新的编译错误。错误：下标值既不是数组也不是指针。

触发该错误的代码行如下。printf(" %-7s %-2s %d\n", student.results[i].module_code, student.results[i].grade, student.results[i].mc);

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-06T09:32:48.950

结果不是数组。你应该改变结构学生：

```
typedef struct {
    char name[31];
    result_t results[MAX_NUM_RESULTS];
} student_t; 
```

或将 printf 更改为：

```
printf(" %-7s %-2s %d\n", student.results.module_code, student.results.grade, student.results.mc); 
```

这取决于一个学生可能有多少可能的结果。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-06T09:17:29.613

因为你使用 typedef 使用这个

```
typedef struct {
char name[31];
result_t results;<---remove struct
} student_t; 
```

# java - 我是否正确关闭了这些并发线程

> ID：13247859
> 
> 赞同：2
> 
> 时间：2012-11-06T09:16:15.710
> 
> 标签：java, multithreading

在主题中，我是否正确关闭了这些同时线程？

我分配了一个 volatile 字段并在 while 循环中反复检查它。

**是否有替代方法**（例如使用 synchronize 或 wait() 方法），请告诉我。

**编辑**我编辑了代码。有什么方法可以通过 isAlive(); 的不同方法检查 Thread 是否还活着？也许：

```
boolean isAlive(){
    return running;
} 
```

* * *

```
import javax.swing.JOptionPane;

public class Wat extends Thread {
    private char c;
    private int interv;
    private volatile boolean running = true;
    Object synchObj;

    public Wat(char c, int interv) {
        this.c = c;
        this.interv = interv;
        synchObj = new Object();
    }

    public void run() {
        while (running) {
            synchronized (synchObj) {
                try {
                    showChar(c);
                    synchObj.wait(interv * 100);
                } catch (InterruptedException e) {
                    e.printStackTrace();
                }
            }
        }

    }

    public synchronized static void showChar(char c) {
        System.out.println(c);
    }

    public void shutdown() {
        running = false;
        synchronized (synchObj) {
            synchObj.notify();
        }
    }

    public static void main(String[] args) throws InterruptedException {
        Wat w1 = new Wat('A', 3);
        Wat w2 = new Wat('B', 4);
        Wat w3 = new Wat('C', 5);
        w1.start();
        w2.start();
        w3.start();
        Object[] options = { "Shutdown A", "Shutdown B", "Shutdown C" };
        int option;
        while (w1.isAlive() || w2.isAlive() || w3.isAlive()) {
            option = JOptionPane.showOptionDialog(null,
                    "Which one would you like to shut?", "Threads",
                    JOptionPane.YES_NO_CANCEL_OPTION,
                    JOptionPane.QUESTION_MESSAGE, null, options, options[2]);
            switch (option) {
            case JOptionPane.YES_OPTION:
                w1.shutdown();
                break;
            case JOptionPane.NO_OPTION:
                w2.shutdown();
                break;
            case JOptionPane.CANCEL_OPTION:
                w3.shutdown();
                break;
            }
            Thread.sleep(1);
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-06T09:24:40.880

您的代码可能会正常工作，但 Thread.sleep 不是很优雅。我会按照这些思路做一些事情，调用 shutdown() 方法来退出线程

```
 Object synchObj = new Object();

 public void run() {
    while (running) {
      synchronized (synchObj) {
         try {
            System.out.println(new Date());
            synchObj.wait(5000);
         } catch (InterruptedException e) {
             // error handling
         }
      }
    }
 }

 public void shutdown() {
    running = false;
    synchronized (synchObj) {
        synchObj.notify();
    }
 }

public static void main(String[] args) throws InterruptedException,
        IOException {
    ThreadTest test = new ThreadTest();
    test.start();
    BufferedReader tReader = new BufferedReader(new InputStreamReader(
            System.in));
    tReader.readLine();
    test.shutdown();
} 
```

**编辑**添加测试代码

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-06T09:19:11.143

是的，您正确地关闭了线程。唯一的评论是您在这里打破了封装，因为`running`直接访问了标志。我建议您添加`shutdown()`将此标志更改为`false`.

编辑。

我刚刚注意到您`sleep()`在循环内调用。在大多数情况下，这确实是不好的做法。你可能应该打电话给`wait(timeout)`. 在这种情况下，您的`shutdown()`方法会将标志更改为`false`，然后`notify()`在同一监视器上调用。这将导致您的线程立即退出。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-06T09:28:24.960

看起来程序很完美，使用 volatile 布尔变量并使其为假。

同步只需要多线程访问。您可以使用等待代替睡眠，它具有对象访问而不是静态睡眠，也可以随时中断等待。

# postgresql - 如何从 postgresql 中的 plpgsql 函数返回的 SELECT 查询中提取字符串（或文本）？

> ID：13247863
> 
> 赞同：3
> 
> 时间：2012-11-06T09:16:31.193
> 
> 标签：postgresql, plpgsql, psql

我可能在这里扭曲了 postgres，但从根本上说，我想做的是获取一个字符串变量并将其传递给仅使用 psql 的 sql 命令（在本例中为 COPY）。

所以这就是我想出的。这些命令被分成 2 个文件，因为我希望能够在其他情况下使用 mydb_functions：

文件一：mydb_functions--1.0.sql （在共享/扩展和 mydb_functions.control 中也按照手册中的描述进行设置。给定文件名，返回完整的文件路径。这样做只是为了在下面的 add_data.sql 中制作 COPY 语句，更整洁。

```
CREATE OR REPLACE FUNCTION fpn(filename text) RETURNS TEXT as '
  DECLARE 
    mypath text := ''/path/to/my/directory/'';
  BEGIN
    RETURN mypath || filename;
  END
' LANGUAGE plpgsql; 
```

文件二： add_data.sql 。这仅用于在命令行使用 psql 将数据复制到现有的 postgres 表中。注意：由于 CREATE EXTENSION 命令，需要以超级用户权限运行 psql。

```
CREATE EXTENSION IF NOT EXISTS mydb_functions;
-- haven't figured out how to create a function without arguments yet.
CREATE OR REPLACE FUNCTION test (dummyvar text) RETURNS text as '     
  DECLARE 
    filepath RECORD;
  BEGIN 
    SELECT * INTO filepath from fpn(''mydatafile.data'');
    COPY tablename (columnname) FROM filepath;
  END
' LANGUAGE plpgsql; 
```

我坚持的部分是如何从文件路径记录中提取文本以在 COPY 命令中使用。也欢迎任何有关实现此目标的更简单方法的提示。我认为创建一个表来存储变量比这容易得多。但我想完成最后一步。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-06T10:56:12.690

如果您的问题`COPY`使用动态目标路径运行，`EXECUTE`请用于运行`format`ted SQL 查询。

```
CREATE OR REPLACE FUNCTION test () RETURNS text as $$ 
  DECLARE 
    filepath RECORD;
  BEGIN 
    SELECT * INTO filepath from fpn('mydatafile.data');
    EXECUTE format('COPY tablename (columnname) FROM %L', filepath);
  END
$$ LANGUAGE plpgsql; 
```

看，这失败了：

```
DO
$$
DECLARE
    somevar text;
BEGIN
    somevar := '/tmp/somepath.csv';
    COPY tablename(columnname) FROM somevar;
END;
$$; 
```

但这有效：

```
DO
$$
DECLARE
    somevar text;
BEGIN
    somevar := '/tmp/somepath.csv';
    EXECUTE format('COPY tablename(columnname) FROM %L', somevar);
END;
$$; 
```

看：

*   [`EXECUTE`](http://www.postgresql.org/docs/current/interactive/plpgsql-statements.html)
*   [`format()`](http://www.postgresql.org/docs/current/interactive/functions-string.html)

`format()`的`%L`说明符自动引用文字。`%I`对标识符做同样的事情。

* * *

如果正如我最初所想的那样，您正在谈论`psql`从外部获取数据，您可能会发现`psql`变量和变量插值很有用：

```
$ psql -v filepath=/path/to/my/directory/mydatafile.data regress
regress=> SELECT :'filepath';
               ?column?                
---------------------------------------
 /path/to/my/directory/mydatafile.data
(1 row) 
```

注意冒号不加引号，然后变量名加引号。奇怪的语法，我知道。这仅适用于`psql`; 它在（比如）PgAdmin-III 中不起作用。

或者，您可以使用 here-document（特定于类 unix 的 shell，在 Windows' 中不起作用`cmd.exe`）来进行引用文本插值：

```
$ FILEPATH=/path/to/my/directory/mydatafile.data
$ psql regress <<__END__
SELECT '$FILEPATH';
__END__

               ?column?                
---------------------------------------
 /path/to/my/directory/mydatafile.data
(1 row) 
```

这两个都展示了如何将一个变量从 shell 级别插入到`psql`. 从那里开始，在你的函数中使用它是一个问题。像这样，说，与`-v filename=myfilename.csv`：

```
CREATE OR REPLACE FUNCTION test() RETURNS text as $$
  DECLARE 
    filepath RECORD;
  BEGIN 
    SELECT * INTO filepath from fpn(:'filename');
    COPY tablename (columnname) FROM filepath;
  END
$$ LANGUAGE plpgsql; 
```

或者只是这个`-v filepath=/full/path/to/myfilename.csv`：

```
$ psql -v filepath=/path/to/my/directory/mydatafile.data regress
regress=> COPY tablename (columnname) FROM :'filepath'; 
```

# javascript - Javascript - 替换括号之间的字符串，但括号应该保留

> ID：13247864
> 
> 赞同：15
> 
> 时间：2012-11-06T09:16:32.237
> 
> 标签：javascript, replace

我想替换字符串中的字符，例如

草稿 [ **2** ]

到：

草稿 [ **3** ]

此正则表达式仅返回 Drafts **3**：

```
str.replace(/\[(.+?)\]/g, 3) 
```

提前感谢您的帮助

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2012-11-06T09:19:21.793

你需要比下面更多的东西吗？

```
 var num=2 // parse this from drafts [2]
 num++;
 var newstr=str.replace(/\[(.+?)\]/g, "["+num+"]") 
```

或者括号可以更改为 <> {} 每个输入？

您还可以提供一个函数而不是替换字符串。

```
var str = "Drafts [2]";

function replacer(match, p1, p2, p3, offset, string) {
  return p1 + (1+parseInt(p2)) + p3;
}
var newstr=str.replace(/([\[(])(.+?)([\])])/g, replacer);
alert(newstr); // alerts "Drafts [3]" 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-11-06T09:18:29.957

使用零宽度*断言*而不是实际匹配括号。

**编辑**：Javascript 没有后视。：C

作为一般解决方案，您可以捕获周围的内容并使用反向引用将其放回替换字符串中。

```
str.replace(/(\[).+?(\])/g, "$13$2") 
```

或者，您可以在替换中包含硬编码的括号。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-11-06T09:21:46.913

您可以像这样将括号添加到替换文本中：

```
str.replace(/\[(.+?)\]/g, "["+3+"]") 
```

编辑：如果您需要对括号中的数字做任何事情，您可以使用函数而不是替换文本：

```
str.replace(/\[(.+?)\]/g, function(string, first){
  // string is the full result of the regex "[2]"
  //first is the number 2 from "draft [2]"
  return "["+(first++)+"]";
}) 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2020-03-27T23:30:16.353

如果您需要更多这样的功能，那么您可以使用**方法借用**技巧创建功能。

```
const args = {
    source: "Lorem [ipsum] dolor [sit] amet",
    prefix: `<i style="background-color:yellow">`,
    suffix: '</i>',
    global: true,
    deleteBrackets: true
}

const bracketsToTags = (args) => {
    const { source, prefix, suffix, global = true, deleteBrackets = false } = args;
    const reg = /\[(.+?)\]/;
    source.replace = ''.replace;
    return source.replace(new RegExp(reg, global ? 'g': ''), 
                             (withBrackets, withoutBrackets) => (
        `${prefix}${deleteBrackets ? withoutBrackets: withBrackets}${suffix}`
    ))
} 
```

所以，运行函数

```
bracketsToTags(args) 
```

你会得到

```
"Lorem <i style="background-color:yellow">ipsum</i> dolor <i style="background-color:yellow">sit</i> amet" 
```

PS：对 React 使用“React HTML Parser” -[链接](https://www.npmjs.com/package/react-html-parser)

# jquery - 内联内容未显示在一页以上

> ID：13247867
> 
> 赞同：0
> 
> 时间：2012-11-06T09:16:40.317
> 
> 标签：jquery, jsp, inline, jsp-fragments

我面临以下问题：我正在尝试在页面上按下链接时`jQuery`显示一个。`inline pop-up`内联弹出窗口在`.jspf`页面内定义如下：

```
<div id="x" style="display:none">
    <a id="y" class="thickbox" href="#TB_inline?height=150&width=400&inlineId=w&modal=true">Show hidden modal content.</a>
</div>

<div id="w" style="display: none;">
...
</div> 
```

我在`onclick="checkLogout(); return false;"` 哪里使用

```
function checkLogout(){
    document.getElementById("y").click();
} 
```

显示内联内容。

包含此内容的 jspf 文件在多个 jsp 文件中使用，但是当单击链接时，只有连续使用的第一个页面`jspf`显示内容并正常运行。其他人调用该`checkLogout()`函数但不显示内联内容。

有谁知道我做错了什么？

提前致谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-08T18:12:47.697

我发现了这个问题，似乎来自 jsp 页面的 java-script 源没有包含在正确的顺序中。

该`jquery.js`文件需要是第一个 js 文件，只有在您之后才能使用其他`.js`文件。

例如。

```
<script type="text/javascript" src="jquery-1.4.4.min.js" />
<script type="text/javascript" src="otherJavaScriptFile.js" /> 
```

# ios - iOS 并发相机使用情况

> ID：13247876
> 
> 赞同：2
> 
> 时间：2012-11-06T09:17:12.830
> 
> 标签：ios, camera, jailbreak, avcapturesession, avcapturedevice

我正在开发一个定期使用相机的后台应用程序。此应用程序适用于我的越狱设备，因此公共 SDK 限制没有问题。我想以自动方式拍摄我白天去的不同地方的照片。

我正在使用`AVCaptureSession`，从视频中获取帧以不产生声音。

问题是，如果另一个应用程序想要使用相机（例如**相机**应用程序），而我的应用程序尝试拍照，**相机**界面就会冻结。然后我需要再次重新打开相机应用程序才能使其工作。我猜这是因为阻止使用以前的相机会话的`startRunning`方法。`AVCaptureSession`

有没有办法在共享模式下或*同时*使用相机？

我不知道是否有某种`mixWithOthers`属性包含在声音兼容性中。

# javascript - jqplot 错误：未设置未捕获的画布尺寸

> ID：13247880
> 
> 赞同：1
> 
> 时间：2012-11-06T09:17:26.223
> 
> 标签：javascript, jquery, jqplot

我有一个由数组组成的简单图表，如下所示：

```
var plot2 = [[1,1.3,"1.3"],[2,0.3,"0.3"],[3,3.3,"3.3"],[4,1.7,"1.7"]]; 
```

然后它被添加到这样的 div 中。

```
var plot1 = $.jqplot ('graph', [plot2],{
  grid:{
    background:"transparent",
    borderColor:"#6c9922",
    gridLineColor:"#6c9922",
    shadow:false
  },
  axes: {
    xaxis: {
      tickOptions:{formatString:'%.0f'},
      pad: 0,
      min:0,
      max:5
    },
    yaxis: {
      tickOptions:{formatString:'%.1f'},
      pad: 0,
      min:0,
      max:5
    },
  },
  series:[{
    lineWidth:2,
    markerOptions: {size:2,style:"circle"}
  }],
  seriesDefaults:{
    showMarker:true,
    pointLabels:{ show:true }
  },
  seriesColors:["#ffffff"]
}); 
```

我的问题是我网站的一些用户报告说他们看不到图表，使用最新的 Chrome 和 Firefox，他们得到并错误说

```
Uncaught Canvas dimension not set jquery.jqplot.min.js:57 
```

他们中的一些人说，只有将缩放级别设置为 100% 时，该图表才有效。

从那以后，这一切都没有多大意义，并且在我尝试过的每个系统上一切都完美无缺。

那么有人知道什么是错的吗？

我已经搜索了错误，但我唯一能找到的地方是 jqplot 插件的源代码。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-12T10:19:45.590

我对属性数组进行了以下更改，这似乎有效。它一定与轴上的最小值和/或最大值有关，尽管我不确定，因为我从来没有遇到任何错误。

```
var plot1 = $.jqplot ('graph', [plot2],{
  grid:{
    background:"transparent",
    borderColor:"#6c9922",
    gridLineColor:"#6c9922",
    shadow:false
  },
  axes: {
    xaxis: {
      tickOptions:{formatString:'%.0f'},
      pad: 0
    },
    yaxis: {
      tickOptions:{formatString:'%.1f'},
      pad: 0
    },
  },
  series:[{
    lineWidth:2,
    markerOptions: {size:2,style:"circle"}
  }],
  seriesDefaults:{
    showMarker:true,
    pointLabels:{ show:true }
  },
  seriesColors:["#ffffff"]
}); 
```

# linux - 在调试 perl 代码期间修改变量的值

> ID：13247883
> 
> 赞同：4
> 
> 时间：2012-11-06T09:17:34.527
> 
> 标签：linux, perl, debugging

我正在使用“perl -d”开关在 SuSe Linux 上调试 perl 程序。

调试时，程序正在报告`XYZ variable is not set`

如何在调试器中设置 XYZ 的值？

我尝试在调试器内部进行跟踪，但没有工作。

```
set XYZ=ABC
my $XYZ=ABC
setenv XYZ ABC 
```

我对此做了一些谷歌。但是找不到我想要的。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-06T09:32:14.540

调试控制台采用 Perl 表达式，因此如果它是字符串，则需要引用该值。

您必须将程序移动到引发错误的行之前（查看断点，它`b <line>`在调试器中），然后设置值。

```
> $XYZ='ABC' 
```

这是一个很好的资源： http: [//obsidianrook.com/devnotes/talks/perl_debugger/](http://obsidianrook.com/devnotes/talks/perl_debugger/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-06T09:42:24.937

假设您尝试将 $XYZ 设置为字符串 ABC 尝试：

```
$XYZ = 'ABC' 
```

如果你使用

```
my $XYZ='ABC' 
```

它将仅在当前范围内定义变量 $XYZ。从调试器中的测试来看，该范围似乎没有扩展到调试控制台之外（即只能在控制台的该行上访问）。例如

```
 DB<2> my $x = "hello"; print "$x"
hello
  DB<3> print $x
Use of uninitialized value $x in print at (eval 8)[/usr/share/perl/5.12/perl5db.pl:638] line 2. 
```

# ruby-on-rails - 基于当前控制器动作的重定向

> ID：13247894
> 
> 赞同：1
> 
> 时间：2012-11-06T09:18:15.367
> 
> 标签：ruby-on-rails

现在，我有两个正在使用该`users#create`操作的视图：`users/new.thml.erb`和`enter_email.html.erb`.

问题在于，使用当前代码，`new.html.erb`当表单`enter_email.html.erb`出现验证错误时，用户会被重定向到。所以我尝试了这个：

```
 def create
    @user = User.new(params[:user])
    if @user.save
      sign_in @user
      flash[:success] = "Welcome to the Sample App!"
      redirect_to @user
    else
      if params[:action] == "enter_email"
        render 'enter_email'
      else
        render 'new'
      end
    end
  end 
```

我希望用户`enter_email.html.erb`在操作为“enter_email”时被重定向到。但我仍然被重定向到“new.html.erb”。

有什么建议可以解决这个问题吗？（这是因为正在执行的动作实际上是`create`？如果是这样，如何修改代码以使重定向起作用？）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-06T10:04:53.680

我看到了几种方法：

*   向两个表单添加一个隐藏字段，并检查`params`该字段的值，这样您就知道您来自哪个表单

    ```
    # in your new.html.erb view
    hidden_field_tag 'form_name', 'new'

    # in your enter_email.html.erb view 
    ```

      hidden_​​field_tag 'form_name', 'enter_email'

    ```
    # in controller
    if params[:form_name] == "enter_email"
      render 'enter_email'
    else
      render 'new'
    end 
    ```

*   使用不同的操作进行创建，例如`create_from_enter_email`，并将`enter_email`表单指向它。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-06T09:27:40.033

如您所想，问题在于操作 is`create`和 not `enter_email`，因此 if/else 条件总是转到 else 分支并`new`呈现视图。

要呈现以前的视图，您可以按照[此答案](https://stackoverflow.com/questions/4877093/rails-redirect-back-unless-previous-page-was-artist-page)`request.referrer`中的建议使用：

```
def create
  @user = User.new(params[:user])
  if @user.save
    sign_in @user
    flash[:success] = "Welcome to the Sample App!"
    redirect_to @user
  else
    if request.referrer == root_url
      render 'enter_email'
    else
      render 'new'
    end
  end
end 
```

我正在检查是否`request.referrer`基于`root_url`登录部分位于主页上的事实（您在下面的评论中提到）。这应该有效。

# asp.net-mvc - 如何获取复选框中的值

> ID：13247896
> 
> 赞同：0
> 
> 时间：2012-11-06T09:18:17.830
> 
> 标签：asp.net-mvc, html

我有 4 个复选框。我希望当我更新页面时复选框正在填充数据库中的值。

我的代码是

```
 <div class="editor-field">
        <%: Html.CheckBox("Any")%> Any  
        <%: Html.CheckBox("Contract")%> Contract  
        <%: Html.CheckBox("PartTime") %>Part Time
        <%: Html.CheckBox("FullTime") %>Full Time
        <%: Html.CheckBox("WorkFromHome") %>Work From Home
        </div> 
```

帮我解决这个问题..

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-06T09:56:16.340

您能否包含有关数据模型和 viewdata 的详细信息？确保代表模型中这些复选框的布尔属性，并且模型是从数据库值刷新的？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-15T10:05:53.520

我找到了解决这个问题的方法。

我采取男性和女性领域。<%: Html.Label("性别")%>

```
 <div class="editor-field">
    <%var male = Model.Male; %>
    <%var female = Model.Female; %>                
    <%if (male.HasValue == true || female.HasValue==true)
      { %>
    <%:Html.CheckBox("Male")%>Male
    <%:Html.CheckBox("Female")%>Female
    <%} else
      {%>
    <%:Html.CheckBox("Male")%>Male
    <%:Html.CheckBox("Female")%>Female
     <%} %> 
```

它正确检索值，当我们要选择新的值时，它会显示新的复选框。希望您对所有其他人有用。

# android - 如何创建动态壁纸容器？

> ID：13247902
> 
> 赞同：0
> 
> 时间：2012-11-06T09:18:29.367
> 
> 标签：android, live-wallpaper, launch

我正在创建一个启动器应用程序，我想在其中设置动态壁纸，任何人都知道如何为动态壁纸创建容器。

让我知道是否有任何建议/想法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-15T14:28:21.280

我不确定你想要完成什么，但是如果你想从你自己的应用程序中设置动态壁纸，你仍然需要对 android.xml 进行适当的调用。我不知道有一种方法可以自己实际设置并绕过经理。我敢肯定，您仍然需要扩展 WallpaperService 和 Engine 才能制作动态壁纸。

# c# - 定义频率上的音量（C#）

> ID：13247904
> 
> 赞同：0
> 
> 时间：2012-11-06T09:18:34.167
> 
> 标签：c#, .net, fft, aforge

我不明白为什么音量定义的频率不符合预期。

我依次用几个指定的频率向我的麦克风发送声音。然后我对麦克风缓冲区进行 FFT。在 FFT 退出时，我有一个复数数组。要知道定义频率上的音量，我查看我的数组，这个数组中的元素数是这样得到的：

```
MyFrequency = n*SamplingRate/SizeOfArray. 
```

接下来，我得到复数的大小

```
(sqrt(Re^2+Im^2) 
```

如果我是对的，这会告诉我这个频率的音量。但是这个值变化很大，取决于频率。如果我错了，请向我解释我需要做什么才能纠正我的错误。如果我是对的，请解释为什么这个值变化如此之大。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-06T09:59:58.823

您是否在 FFT 之前应用了[窗口函数？](http://en.wikipedia.org/wiki/Window_function)如果不是，那么您将看到[频谱泄漏](http://en.wikipedia.org/wiki/Spectral_leakage)的影响，并且任何给定 FFT 箱的幅度只有在原始频率是采样率的精确约数时才是正确的。

# jquery - 太多点击 jQuery

> ID：13247906
> 
> 赞同：1
> 
> 时间：2012-11-06T09:18:38.483
> 
> 标签：jquery, attr

我有代码：

```
 $(".click1").click(function() {
  $('.input').attr('name', 'name1');
});
$(".click2").click(function() {
  $('.input').attr('name', 'name2');
});
$(".click3").click(function() {
  $('.input').attr('name', 'name3');
});
$(".click4").click(function() {
  $('.input').attr('name', 'name4');
});
$(".click5").click(function() {
  $('.input').attr('name', 'name5');
}); 
```

还要怎么写？如何将其更改为简短版本？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-06T09:23:45.437

html:

```
 <a class="clickable" href="..." rel="1">...</a>
    <a class="clickable" href="..." rel="2">...</a>
    .... 
```

JS：

```
 $('.clickable').click(function(){
      var _id = $(this).attr('rel');
      $('.input').attr('name', 'name' + _id);
 }); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-06T09:24:19.190

像这样：

这应该可以帮助人`:)`

说明：从你的班级中取出最后一个字符并将其放入。

**代码**

```
$(".click1,.click2,.click3").click(function() {

    var num = $(this).attr('class');
    //get the number at the end of the class of this particular div           
    var lastChar = num.substr(num.length - 1)

    $('.input').attr('name', 'name'+lastChar);
});

​ 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-06T10:02:51.007

```
$(".click1, .click2, .click3, .click4, .click5").click(function() {
  $('.input').attr('name', 'name' + this.className.slice(-1));
}); 
```

或者有趣的方式（**不推荐**），如果你有无限数量（无论出于何种原因，不想[添加另一个类](https://stackoverflow.com/a/13247992/851498)）：

```
[1, 2, 3, 4, 5].forEach(function(e) {
    var f = '$(".click' + e + '").click(function() {';
    f += '$(".input").attr("name", "name' + e + '");';
    f += '});';
    new Function(f).call();
}); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-06T09:35:01.320

为什么不这样！

所有组件都有一个公共类说“可点击”并使用简单的 if 条件

```
$('.clickable').click(function(){

  if this object has 'click1' class { // do something }
  if this object has 'click2' class { // do something }
  if this object has 'click3' class { // do something }

}); 
```

* * *

## 回答 #5

> 赞同：-2
> 
> 时间：2012-11-06T09:23:40.057

javascript提供了一个`eval()`功能。这是未经测试的，但它应该是这样的：

```
for(var i = 1; i <= 5; i++){
    eval("$(\".click" + i +
        "\").click(function() {$('.input').attr('name', 'name" +
        i + "'); });");
} 
```

# c# - AutoMapper 在程序集加载时添加配置文件

> ID：13247907
> 
> 赞同：2
> 
> 时间：2012-11-06T09:18:40.083
> 
> 标签：c#, automapper

我想将我的**业务层**中的所有映射注册到**数据层**，并将**数据层**注册到**业务层**类，就像我的业务层程序集加载一样。目前我正在使用一个静态类来为我完成这项任务：

```
public static class AutoMapperBootstrapper
{
    public static void InitMappings()
    {
        Mapper.Initialize(a => a.AddProfile<MyProfile>());
    }
} 
```

但是每次我用 Mapper.Map 和配置文件中添加的映射进行调用时，它仍然说缺少类型映射信息。

**我应该如何解决这个问题？**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-13T05:17:35.843

应用程序启动时，您似乎`Mapper.AddProfile`没有调用。尝试这个，

在`Global.asax.cs`[ `Application_Start`] 中，

```
protected void Application_Start(object sender, EventArgs e)
{
    Mapper.AddProfile<MyProfile>();
} 
```

`MyProfile`看起来像下面，

```
public class MyProfile : Profile
{
    public override string ProfileName
    {
        get { return "Name"; }
    }

    protected override void Configure()
    {
        //// BL to DL
        Mapper.CreateMap<BLCLASS, DLCLASS>();

        ////  and DL to BL
        Mapper.CreateMap<DLCLASS, BLCLASS>();
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-02T04:55:40.263

我不知道你是否已经得到了这个问题的答案。你在正确的轨道上，但不要使用`Mapper.Initialize`. 如果您使用初始化，您将清除所有现有映射，然后在初始化调用中添加这些映射。相反，只需调用`AddProfile`您的静态方法。或者更好的是，只需在 BL 或 DL 类的构造函数中添加配置文件。

```
public static class AutoMapperBootstrapper
{
    public static void AddMappings()
    {
        Mapper.AddProfile<MyProfile>();
    }
} 
```

因此，简而言之，正在发生的事情是您正在添加 Web 层所需的任何映射，`Global.asax`或者添加它们的任何位置。然后第一次加载 BL 或 DL 时，您将调用 initialize 来清除所有现有映射。因此，下次您使用已添加的映射时，您会收到消息说它不存在，因为它已被初始化调用清除。

# ios - 计算某个对象在 JSON 查询中出现的数量

> ID：13247912
> 
> 赞同：0
> 
> 时间：2012-11-06T09:18:52.747
> 
> 标签：ios, json, for-loop, nsdictionary, nsjsonserialization

我正在返回具有如下结构的粗略结构的 JSON，并且我试图弄清楚如何计算有多少平台（在本例中为三个，但可能是 1 到 20 左右）。我已将 JSON 返回到 an 中`NSDictionary`，并正在使用诸如此类的行来检索我需要的数据：

```
_firstLabel.text = _gameDetailDictionary[@"results"][@"name"]; 
```

在上述情况下，它将`name`从`results`部分中获取。由于有多个平台，我需要构建一个循环来循环遍历`name`该部分内的每个平台`platforms`。不太清楚该怎么做。所有帮助表示赞赏！

```
"results":{
    "platforms":[
        {
            "api_detail_url":"http://",
            "site_detail_url":"http://",
            "id":18,
            "name":"First Name"
        },
        {
            "api_detail_url":"http://",
            "site_detail_url":"http://",
            "id":116,
            "name":"Second Name"
        },
        {
            "api_detail_url":"http://",
            "site_detail_url":"http://",
            "id":22,
            "name":"Third Name"
        }
    ], 
```

编辑：这是我的 fetchJSON 方法：

```
- (NSDictionary *) fetchJSONDetail: (NSString *) detailGBID {

    [[UIApplication sharedApplication] setNetworkActivityIndicatorVisible: YES];

    NSString *preparedDetailURLString = [NSString stringWithFormat:@"http://whatever/format=json", detailGBID];
    NSLog(@"Doing a detailed search for game ID %@", detailGBID);

    NSData *jsonData = [NSData dataWithContentsOfURL: [NSURL URLWithString:preparedDetailURLString]];

    _resultsOfSearch = [[NSDictionary alloc] init];
    if (jsonData) {
        _resultsOfSearch = [NSJSONSerialization JSONObjectWithData: jsonData
                                                           options: NSJSONReadingMutableContainers
                                                             error: nil];
    }

    [[UIApplication sharedApplication] setNetworkActivityIndicatorVisible: NO];

    NSString *results = _resultsOfSearch[@"number_of_page_results"];
    _numberOfSearchResults = [results intValue];

    NSArray *platforms = [_resultsOfSearch valueForKey:@"platforms"];
    int platformsCount = [platforms count];
    NSLog(@"This game has %d platforms!", platformsCount);

    return _resultsOfSearch; 
```

}

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-06T09:31:53.067

“平台” JSON 字段是一个数组，因此假设您使用类似的方式对 JSON 进行反序列化，

```
NSMutableDictionary *responseJSON = [NSJSONSerialization JSONObjectWithData:resultsData options:NSJSONReadingMutableContainers error:&error]; 
```

然后，您可以将平台分配给 NSArray，

```
NSDictionary *results = [responseJSON valueForKey:@"results"];

NSArray *platforms = [results valueForKey:@"platforms"]; 
```

...并通过以下方式找到平台数量，

```
int platformsCount = [platforms count]; 
```

在您的情况下，您想要遍历平台，您可以使用，

```
for (NSDictionary *platform in platforms)
{
    // do something for each platform
} 
```

# ios - OCR：图像到文本？

> ID：13247914
> 
> 赞同：14
> 
> 时间：2012-11-06T09:18:59.833
> 
> 标签：ios, ocr, xcode4.5, tesseract, leptonica

> **在标记为复制或重复问题之前，请先阅读整个问题。**

我现在能做的如下：

1.  获取图像并裁剪 OCR 所需的部分。
2.  `tesseract`使用和处理图像`leptonica`。
3.  当应用的文档被裁剪成块，即每张图像 1 个字符时，它提供了 96% 的准确度。
4.  如果我不这样做并且文档背景为白色而文本为黑色，则它提供几乎相同的准确性。

例如，如果输入是这张照片：

**照片开始**

![在此处输入图像描述](../Images/1eecfba49a08706d9297be876e6ee4d4.png)

**照片结束**

我想要的是能够在![在此处输入图像描述](../Images/a324d80e828b534c08b5525fc43fb27f.png)
不生成块的情况下为这张照片获得相同的精度。

我用来初始化 tesseract 并从图像中提取文本的代码如下：

对于 tesseract 的初始化

**在 .h 文件中**

```
tesseract::TessBaseAPI *tesseract;
uint32_t *pixels; 
```

**在 .m 文件中**

```
tesseract = new tesseract::TessBaseAPI();
tesseract->Init([dataPath cStringUsingEncoding:NSUTF8StringEncoding], "eng");
tesseract->SetPageSegMode(tesseract::PSM_SINGLE_LINE);
tesseract->SetVariable("tessedit_char_whitelist", "0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ");
tesseract->SetVariable("language_model_penalty_non_freq_dict_word", "1");
tesseract->SetVariable("language_model_penalty_non_dict_word ", "1");
tesseract->SetVariable("tessedit_flip_0O", "1");
tesseract->SetVariable("tessedit_single_match", "0");
tesseract->SetVariable("textord_noise_normratio", "5");
tesseract->SetVariable("matcher_avg_noise_size", "22");
tesseract->SetVariable("image_default_resolution", "450");
tesseract->SetVariable("editor_image_text_color", "40");
tesseract->SetVariable("textord_projection_scale", "0.25");
tesseract->SetVariable("tessedit_minimal_rejection", "1");
tesseract->SetVariable("tessedit_zero_kelvin_rejection", "1"); 
```

从图像中获取文本

```
- (void)processOcrAt:(UIImage *)image
{
    [self setTesseractImage:image];

    tesseract->Recognize(NULL);
    char* utf8Text = tesseract->GetUTF8Text();
    int conf = tesseract->MeanTextConf();

    NSArray *arr = [[NSArray alloc]initWithObjects:[NSString stringWithUTF8String:utf8Text],[NSString stringWithFormat:@"%d%@",conf,@"%"], nil];

    [self performSelectorOnMainThread:@selector(ocrProcessingFinished:)
                           withObject:arr
                        waitUntilDone:YES];
    free(utf8Text);
}

- (void)ocrProcessingFinished0:(NSArray *)result
{
    UIAlertView *alt = [[UIAlertView alloc]initWithTitle:@"Data" message:[result objectAtIndex:0] delegate:self cancelButtonTitle:nil otherButtonTitles:@"OK", nil];
   [alt show];
} 
```

但是我没有得到正确的车牌图像输出，或者它是空的，或者它为图像提供了一些垃圾数据。

如果我使用第一个图像，即白色背景，文本为黑色，那么输出的准确率是 89% 到 95%。

请帮帮我。

任何建议将不胜感激。

**更新**

感谢@jcesar 提供链接，也感谢@konstantin pribluda 提供有价值的信息和指导。

我能够将图像转换为正确的黑白形式（几乎）。因此所有图像的识别效果都更好:)

> 需要帮助进行正确的图像二值化。任何想法将不胜感激

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-07T09:10:29.330

Hi all Thanks for your replies, from all of that replies I am able to get this conclusion as below:

1.  I need to get the only one cropped image block with number plate contained in it.
2.  From that plate need to find out the portion of the number portion using the data I got using the method provided [here](https://stackoverflow.com/a/1262893/1132951).
3.  Then converting the image data to almost black and white using the RGB data found through the above method.
4.  Then the data is converted to the Image using the method provided [here](https://stackoverflow.com/a/1581805/1132951).

Above 4 steps are combined in to one method like this as below :

```
-(void)getRGBAsFromImage:(UIImage*)image
{
    NSInteger count = (image.size.width * image.size.height);
    // First get the image into your data buffer
    CGImageRef imageRef = [image CGImage];
    NSUInteger width = CGImageGetWidth(imageRef);
    NSUInteger height = CGImageGetHeight(imageRef);
    CGColorSpaceRef colorSpace = CGColorSpaceCreateDeviceRGB();
    unsigned char *rawData = (unsigned char*) calloc(height * width * 4, sizeof(unsigned char));
    NSUInteger bytesPerPixel = 4;
    NSUInteger bytesPerRow = bytesPerPixel * width;
    NSUInteger bitsPerComponent = 8;
    CGContextRef context = CGBitmapContextCreate(rawData, width, height,
                                                 bitsPerComponent, bytesPerRow, colorSpace,
                                                 kCGImageAlphaPremultipliedLast | kCGBitmapByteOrder32Big);
    CGColorSpaceRelease(colorSpace);

    CGContextDrawImage(context, CGRectMake(0, 0, width, height), imageRef);
    CGContextRelease(context);

    // Now your rawData contains the image data in the RGBA8888 pixel format.
    int byteIndex = 0;
    for (int ii = 0 ; ii < count ; ++ii)
    {
        CGFloat red   = (rawData[byteIndex]     * 1.0) ;
        CGFloat green = (rawData[byteIndex + 1] * 1.0) ;
        CGFloat blue  = (rawData[byteIndex + 2] * 1.0) ;
        CGFloat alpha = (rawData[byteIndex + 3] * 1.0) ;

        NSLog(@"red %f \t green %f \t blue %f \t alpha %f rawData [%d] %d",red,green,blue,alpha,ii,rawData[ii]);
        if(red > Required_Value_of_red || green > Required_Value_of_green || blue > Required_Value_of_blue)//all values are between 0 to 255
        {
            red = 255.0;
            green = 255.0;
            blue = 255.0;
            alpha = 255.0;
            // all value set to 255 to get white background.
        }
        rawData[byteIndex] = red;
        rawData[byteIndex + 1] = green;
        rawData[byteIndex + 2] = blue;
        rawData[byteIndex + 3] = alpha;

        byteIndex += 4;
    }

    colorSpace = CGColorSpaceCreateDeviceRGB();
    CGContextRef bitmapContext = CGBitmapContextCreate(
                                                       rawData,
                                                       width,
                                                       height,
                                                       8, // bitsPerComponent
                                                       4*width, // bytesPerRow
                                                       colorSpace,
                                                       kCGImageAlphaNoneSkipLast);

    CFRelease(colorSpace);

    CGImageRef cgImage = CGBitmapContextCreateImage(bitmapContext);

    UIImage *img = [UIImage imageWithCGImage:cgImage];

    //use the img for further use of ocr

    free(rawData);
} 
```

**Note:**

> The only drawback of this method is the time consumed and the RGB value to convert to white and other to black.

**UPDATE :**

```
 CGImageRef imageRef = [plate CGImage];
    CIContext *context = [CIContext contextWithOptions:nil]; // 1
    CIImage *ciImage = [CIImage imageWithCGImage:imageRef]; // 2
    CIFilter *filter = [CIFilter filterWithName:@"CIColorMonochrome" keysAndValues:@"inputImage", ciImage, @"inputColor", [CIColor colorWithRed:1.f green:1.f blue:1.f alpha:1.0f], @"inputIntensity", [NSNumber numberWithFloat:1.f], nil]; // 3
    CIImage *ciResult = [filter valueForKey:kCIOutputImageKey]; // 4
    CGImageRef cgImage = [context createCGImage:ciResult fromRect:[ciResult extent]];
    UIImage *img = [UIImage imageWithCGImage:cgImage]; 
```

Just replace the above method's(`getRGBAsFromImage:`) code with this one and the result is same but the time taken is just 0.1 to 0.3 second only.

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-11-29T19:15:30.530

我能够使用提供的演示照片以及生成正确的字母来实现近乎即时的结果。

[我使用GPUImage](https://github.com/BradLarson/GPUImage)对图像进行了预处理

```
// Pre-processing for OCR
GPUImageLuminanceThresholdFilter * adaptiveThreshold = [[GPUImageLuminanceThresholdFilter alloc] init];
[adaptiveThreshold setThreshold:0.3f];
[self setProcessedImage:[adaptiveThreshold imageByFilteringImage:_image]]; 
```

然后将处理后的图像发送到 TESS

```
- (NSArray *)processOcrAt:(UIImage *)image {
    [self setTesseractImage:image];

    _tesseract->Recognize(NULL);
    char* utf8Text = _tesseract->GetUTF8Text();

    return [self ocrProcessingFinished:[NSString stringWithUTF8String:utf8Text]];
}

- (NSArray *)ocrProcessingFinished:(NSString *)result {
    // Strip extra characters, whitespace/newlines
    NSString * results_noNewLine = [result stringByReplacingOccurrencesOfString:@"\n" withString:@""];
    NSArray * results_noWhitespace = [results_noNewLine componentsSeparatedByCharactersInSet:[NSCharacterSet whitespaceCharacterSet]];
    NSString * results_final = [results_noWhitespace componentsJoinedByString:@""];
    results_final = [results_final lowercaseString];

    // Separate out individual letters
    NSMutableArray * letters = [[NSMutableArray alloc] initWithCapacity:results_final.length];
    for (int i = 0; i < [results_final length]; i++) {
        NSString * newTile = [results_final substringWithRange:NSMakeRange(i, 1)];
        [letters addObject:newTile];
    }

    return [NSArray arrayWithArray:letters];
}

- (void)setTesseractImage:(UIImage *)image {
    free(_pixels);

    CGSize size = [image size];
    int width = size.width;
    int height = size.height;

    if (width <= 0 || height <= 0)
        return;

    // the pixels will be painted to this array
    _pixels = (uint32_t *) malloc(width * height * sizeof(uint32_t));
    // clear the pixels so any transparency is preserved
    memset(_pixels, 0, width * height * sizeof(uint32_t));

    CGColorSpaceRef colorSpace = CGColorSpaceCreateDeviceRGB();

    // create a context with RGBA pixels
    CGContextRef context = CGBitmapContextCreate(_pixels, width, height, 8, width * sizeof(uint32_t), colorSpace,
                                                 kCGBitmapByteOrder32Little | kCGImageAlphaPremultipliedLast);

    // paint the bitmap to our context which will fill in the pixels array
    CGContextDrawImage(context, CGRectMake(0, 0, width, height), [image CGImage]);

    _tesseract->SetImage((const unsigned char *) _pixels, width, height, sizeof(uint32_t), width * sizeof(uint32_t));
} 
```

这为 - 留下了 ' 标记，但这些也很容易删除。根据您拥有的图像集，您可能需要对其进行微调，但它应该能让您朝着正确的方向前进。

如果您在使用它时遇到问题，请告诉我，它来自我正在使用的一个项目，我不想剥离所有内容或从头开始创建一个项目。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-06T11:18:06.410

我敢说 tesseract 对你的目的来说太过分了。您不需要字典匹配来提高识别质量（您没有这本字典，但可能意味着计算许可证号的校验和），并且您已经为 OCR 优化了字体。最重要的是，您有标记（附近的橙色和蓝色区域很好）来查找图像中的区域。

在我的 OCR 应用程序中，我使用人工辅助的兴趣区域检索（只是瞄准帮助覆盖在相机预览上）。通常使用 haar cascade 之类的东西来定位有趣的特征，比如人脸。您也可以计算橙色区域的质心，或者只是通过遍历所有图像并存储合适颜色的最左边/最右边/最顶部/最底部像素来计算橙色像素的边界框

至于识别本身，我建议使用不变矩（不确定是否在 tesseract 中实现，但您可以轻松地将其从 java 项目中移植：http: [//sourceforge.net/projects/javaocr/](http://sourceforge.net/projects/javaocr/)）

我在监视器图像上尝试了我的演示应用程序，它识别了运动中的数字（未接受字符训练）

至于二值化（将黑色与白色分开），我会推荐 sauvola 方法，因为这可以提供最佳的亮度变化容差（也在我们的 OCR 项目中实施）

# spring - Spring MVC - 找不到带有 URI 的 HTTP 请求的映射

> ID：13247921
> 
> 赞同：1
> 
> 时间：2012-11-06T09:19:27.503
> 
> 标签：spring, spring-mvc, jetty, http-status-code-404, url-mapping

我知道关于这个话题有很多问题，但我在这里找到的解决方案都没有对我有用。我在 Jetty 6 中使用 Spring，所以我没有 web.xml 文件。spring dispatcher servlet 的映射在 jetty 的配置中设置为“/”

调度员：

```
<bean class="org.mortbay.jetty.servlet.ServletHolder">
    <property name="name" value="spring" />
    <property name="servlet">
        <bean class="org.springframework.web.servlet.DispatcherServlet" />
    </property>
    <property name="initParameters">
        <map>
            <entry key="contextConfigLocation" value="classpath:com/project/config/spring-servlet.xml" />
        </map>
    </property>
</bean> 
```

...映射：

```
<bean class="org.mortbay.jetty.servlet.ServletMapping">
    <property name="servletName" value="spring"></property>
    <property name="pathSpec" value="/"></property>
</bean> 
```

spring-servlet.xml 如下所示：

```
<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="..." ...>

<context:component-scan base-package="com.project.web" />
<mvc:annotation-driven />

<bean
    class="org.springframework.web.servlet.view.InternalResourceViewResolver">
    <property name="prefix">
        <value>/WEB-INF/pages/</value>
    </property>
    <property name="suffix">
        <value>.jsp</value>
    </property>
</bean>

</beans> 
```

我有一个名为 HelloController 的简单控制器：

```
@Controller
public class HelloController {

    @RequestMapping(method = RequestMethod.GET, value="/welcome")
    public String sayHello(ModelMap model){
    model.addAttribute("message", "Spring 3 MVC Hello World");
    return "hello";
} 
```

}

阅读日志它似乎工作，但我得到以下错误：

在名称为“spring”的 DispatcherServlet 中找不到具有 URI [/WEB-INF/pages/hello.jsp] 的 HTTP 请求的映射

我不明白。它将“/welcome”映射到/WEB-INF/pages/hello.jsp，但它仍然说找不到页面，它就在它似乎在寻找它的地方。我将 WEB-INF 文件夹添加到类路径中，但它仍然相同。你知道这是为什么吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-12-23T19:15:31.093

你确定这个包名是正确的吗？

```
<context:component-scan base-package="com.project.web" /> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-06T21:05:24.077

你的 hello.jsp 是直接在 WEB-INF/pages 下吗？您可以将 Dispatcher Servlet 映射更改为此并尝试

```
<property name="pathSpec" value="*.html"></property> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-06T10:35:59.983

控制器中的请求映射路径是相对于您的`http://your-domain/your-app/`. 如果您的应用名称是`welcome`使用 url`http://localhost:25001/welcome/welcome`或将 requestmapping 更改为`@RequestMapping(method = RequestMethod.GET, value="/")`以便您可以使用 url`http://localhost:25001/welcome`

# apache-flex - SpriteVisualElement 中的事件侦听器没有响应

> ID：13247922
> 
> 赞同：0
> 
> 时间：2012-11-06T09:19:29.487
> 
> 标签：apache-flex, actionscript, air, event-handling

我在我的 Flex/Air 项目中嵌入了 Flashpunk 游戏库，其中一些 Flex 组件呈现在 FP 之上。事物显示正确，Flex 组件响应鼠标输入。然而，Flashpunk 没有。我像这样嵌入它：

```
 <?xml version="1.0" encoding="utf-8"?>
<s:WindowedApplication xmlns:fx="http://ns.adobe.com/mxml/2009" 
                       xmlns:s="library://ns.adobe.com/flex/spark" 
                       xmlns:mx="library://ns.adobe.com/flex/mx" 
                       resize="windowedapplication1_resizeHandler(event)"
                       initialize="init();"
                       applicationComplete="complete();"
                       showStatusBar="false"
                       mouseEnabled="false"
                       xmlns:local="*">
    <fx:Declarations>
        <!-- Place non-visual elements (e.g., services, value objects) here -->

    </fx:Declarations>
    <s:SpriteVisualElement id="flashpunk" depth="-2" mouseEnabled="true" mouseChildren="true">
    </s:SpriteVisualElement>

    <mx:MenuBar id="myMenubar" width="832" itemClick="menuHandler(event);" labelField="@label" depth="0">
        <fx:XMLList xmlns="">
            <item label="File">
                <item label="New" id="new" />
                <item label="Open" id="open"/>
                <item label="Save" id="save"/>
                <item label="Save As" id="saveas"/>
                <item label="Quit" id="quit"/>
            </item>

            <item label="Edit">
                <item label="Undo" id="undo"/>
                <item label="Redo" id="redo"/>
                <item label="Preferences" id="preferences"/>
            </item>

            <item label="Level">
                <item label="New Scene" id="newroom"/>
                <item label="Properties" id="properties"/>
            </item>

            <item label="Objects">
                <item label="Clickable" id="clickable"/>
                <item label="Character" id="character"/>
                <item label="Door" id="door"/>
                <item label="Treasure" id="treasure"/>
            </item>
        </fx:XMLList>

    </mx:MenuBar>

    <fx:Script>

        <![CDATA[
            import basicui.Global;
            import basicui.NewUI;

            import flash.display.NativeWindow;
            import flash.display.StageScaleMode;
            import flash.filesystem.File;

            import mx.collections.*;
            import mx.controls.Alert;
            import mx.core.IUIComponent;
            import mx.core.InteractionMode;
            import mx.core.mx_internal;
            import mx.effects.effectClasses.FadeInstance;
            import mx.events.FlexNativeWindowBoundsEvent;
            import mx.events.MenuEvent;
            import mx.events.ResizeEvent;
            import mx.utils.object_proxy;

            import net.flashpunk.FP;
            import net.flashpunk.Screen;

            import org.osmf.elements.F4MElement;

            import spark.components.Application;
            import spark.components.supportClasses.InteractionState;

            public var Maini:Main = new Main; 
            public static var windowsize:Point = new Point(640, 480);
            private var started:Boolean = false;

            private function init():void
            {

                flashpunk.addChild(Maini);
                Global.main = this;

            }

            private function complete():void
            {

                stage.scaleMode = StageScaleMode.NO_SCALE;
                stage.align = StageAlign.TOP_LEFT;

                //calculate system chrome
                //nativeWindow.width = 640;
                //nativeWindow.height = 480;
                Global.chromew=nativeWindow.width-nativeWindow.stage.stageWidth;
                Global.chromeh=nativeWindow.height-nativeWindow.stage.stageHeight;

                Global.uibarh = 50;
                //default windowsize
                resizewindow(windowsize.x, windowsize.y);
                started = true;

            }

            public function resizewindow(w:int, h:int):void
            {

                if (w < 640)
                    w = 640;
                if (h < 480)
                    h = 480;
                windowsize.x = w+Global.chromew;
                windowsize.y = h+Global.chromeh+Global.uibarh;

                nativeWindow.width = w+Global.chromew;
                nativeWindow.height = h +Global.chromeh+Global.uibarh;

                myMenubar.width = nativeWindow.width;

                //resize flashpunk
                FP.width = nativeWindow.width; 
                FP.height =  nativeWindow.height; 
                FP.screen = new net.flashpunk.Screen;
                FP.bounds.width = Number(FP.width);
                FP.bounds.height = Number(FP.height);
            }

            private function menuHandler(evt:MenuEvent):void  
            {
                // Don't open the Alert for a menu bar item that 
                // opens a popup submenu.
                if (evt.item.@id == "new")
                {

                    var a:NewUI = new NewUI;
                    a.begin(this);
                    addElement(a);

                }

                if (evt.item.@id == "open")
                {
                    var filter:FileFilter = new FileFilter("Levels", "*.ael");
                    var file:File = new File;
                    file.browseForOpen("",[filter]);

                    file.addEventListener(Event.SELECT, fileselected);

                }

                if (evt.item.@id == "quit")
                {
                    //close the program
                    //could ask if there is unsaved data...?
                    close();

                }

                    /*Alert.show("Label: " + evt.item.@label + "\n" + 
                        "Data: " + evt.item.@data, "Clicked menu item");
                    */

            }

            private function fileselected(event:Event):void
            {
                //user selected a file:

                File(event.currentTarget).addEventListener(Event.COMPLETE, fileloaded)
                File(event.currentTarget).load();

            }

            private function fileloaded(event:Event):void
            {
                //user selected file is loaded:

                Global.levelfile = File(event.currentTarget);
                Global.levelXML = XML(File(event.currentTarget).data.toString());
                //initialize level project
                Global.editor.initlevel();
            }

            protected function windowedapplication1_resizeHandler(event:ResizeEvent):void
            {
                // TODO Auto-generated method stub
                if (started)
                {
                    windowsize.x = nativeWindow.width;
                    windowsize.y = nativeWindow.height
                    myMenubar.width = nativeWindow.width;
                }
            }

        ]]>

    </fx:Script>

</s:WindowedApplication> 
```

Flashpunk 库有自己的用于输入“Input.as”的事件侦听器。由于某种原因，它们似乎没有运行。我认为 flex 组件以某种方式劫持了这些侦听器，或者 SpriteVisualElement 不允许或识别它们。如何启用 SpriteVisualElement 事件侦听器？我需要设置什么设置吗？请注意，鼠标或键盘输入都不起作用。

编辑：添加了我的主要 mxml 代码。有没有办法创建一个“catch all”侦听器，然后将事件提供给 FP 的 Input 类？

# android - Android MediaPlayer.getCurrentPosition 未更新

> ID：13247926
> 
> 赞同：5
> 
> 时间：2012-11-06T09:19:42.870
> 
> 标签：android, streaming, mp3, media-player

我已经按照 Igor Khrupin 的关于使用 MediaPlayer 类在 Android 中流式传输 mp3 文件的教程：[http ://www.hrupin.com/2011/02/example-of-streaming-mp3-mediafile-with-android-mediaplayer-class](http://www.hrupin.com/2011/02/example-of-streaming-mp3-mediafile-with-android-mediaplayer-class)

除了搜索栏的主要进度没有正确更新之外，这一切都很好。它在开始之后停止。在调试时，我可以看到 MediaPlayer.getCurrentPosition() 方法总是返回 261（毫秒），即使 mp3 歌曲播放正常。

有没有人遇到过这个问题或对如何解决它有任何想法？

非常感谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2018-07-14T17:08:20.410

我也有同样的问题。我通过使用以下方法确定流的类型来解决问题`setAudioStreamType(int)`：

```
Uri myUri = ....; // initialize Uri here
MediaPlayer mediaPlayer = new MediaPlayer();
mediaPlayer.setAudioStreamType(AudioManager.STREAM_MUSIC);
mediaPlayer.setDataSource(getApplicationContext(), myUri);
mediaPlayer.prepare();
mediaPlayer.start(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-06T11:02:40.550

我在这里发现了问题。首先，我运行的模拟器没有打开音频，所以我需要在 Eclipse 的 AVD 管理器中添加启用音频的布尔值。没有打开音频是导致它总是返回 261 毫秒的原因。还有第二个问题。请参阅下面的 2 个代码片段。第一个是我的代码，第二个是教程中的代码。有一个细微的差异（括号的数量）导致第一个总是评估为 0。

```
seekBarProgress.setProgress((int)((float) mediaPlayer.getCurrentPosition() / getMp3Duration()) * 100);

seekBarProgress.setProgress((int) (((float) mediaPlayer.getCurrentPosition() / getMp3Duration()) * 100)); 
```

# php - TABLE TD 中的可拖放和可拖动

> ID：13247936
> 
> 赞同：2
> 
> 时间：2012-11-06T09:20:26.257
> 
> 标签：php, javascript, jquery, html

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-06T13:22:22.647

I made 2 changes:

In the HTML I replaced the content of the div ('start') with this:

```
<span class="dragHandle" style="position: fixed">start</span> 
```

In the JS I replaced your

```
$( ".drag" ).draggable(); 
```

with this:

```
 $( ".dragHandle" ).draggable({
        drag: function ( event, ui) {
            $(this).parent().offset({ top: ui.offset.top, left: ui.offset.left});
        }
    }); 
```

This way it's only the handle at the top that being dropped (and not the center of the tall DIV) and we still move your colorful DIVs :-)

# html - HTML Help Workshop 中父目录中文件的相对路径

> ID：13247937
> 
> 赞同：4
> 
> 时间：2012-11-06T09:20:31.383
> 
> 标签：html, chm

*.hhc 文件或帮助页面 .htm 的 html 代码中的父目录的相对路径在编译的 .chm 帮助文件中不起作用。

在本例中，file1.htm 与 *.hcc 文件位于同一目录中，而 file2.htm 位于需要通过父目录访问的其他目录中。HELP Workshop IDE 创建以下 *.hhc：

```
<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<HTML>
<HEAD>
<meta name="GENERATOR" content="Microsoft&reg; HTML Help Workshop 4.1">
<!-- Sitemap 1.0 -->
</HEAD><BODY>
<OBJECT type="text/site properties">
    <param name="ImageType" value="Folder">
</OBJECT>
<UL>
    <LI> <OBJECT type="text/sitemap">
        <param name="Name" value="Introduction">
        <param name="Local" value="file1.htm">
        </OBJECT>
    <LI> <OBJECT type="text/sitemap">
        <param name="Name" value="Topic">
        <param name="Local" value="..\common\file2.htm">
        </OBJECT>
</UL>
</BODY></HTML> 
```

文件 1 的内容以这样的开头：

```
<html>
    <head>
        <title>Documentation</title>
        <meta name="GENERATOR" content="Microsoft FrontPage 4.0" />
        <link rel="stylesheet" type="text/css" href="..\common\webformat.css" />
        <script language="JavaScript" type="text/javascript" src="..\common\WindowControl.java">
        </script>
    </head>

    <body>

    <table cols=2>
    <tr>
        <td align="left" valign="bottom"><h2>Overview</h2></td>
        <td align="right"><img src="..\common\images\klein.gif" alt="Logo"></td>
    </tr>
    </table> 
```

在已编译的 *.chm 文件中，样式表未应用，javascript 不起作用并且图像不显示。目录中的 file2 也无法访问。

用7zip解压*.chm文件可以看出，编译器将所有文件都放在了同一层，但是却保留了*.htm文件和*.hhc文件中的相对路径不变。这就是它们无法访问的原因：

帮助项目中的帮助文件夹层次结构：

```
Help
  |-common
  |   |-file2.htm
  |   |-webformat.css
  |   |-WindowControl.java
  |   |-images
  |       |-klein.gif
  |-private
      |-file1.htm 
```

在解压后的 *.chm 文件层次结构中：

```
Help
  |-file1.htm
  |-file2.htm
  |-webformat.css
  |-WindowControl.java
  |-klein.gif 
```

通过 javascript 指定所有相对路径的替代路径是一个非常不干净的解决方案。此外，它并没有解决 *.hhc 文件中的链接问题。

有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-06T11:03:48.430

路径应该相对于目录的根目录，并且 URL 使用 FORWARD 斜杠。

配置文件中的所有路径都应相对于文档根目录。所以如果在 CHM 中可以看到 HELP 目录，那么 help 的父级就是 documentroot，而 CHM 项目的项目文件类似于 help/common/xxx.gif。

Afaik 在 html 文件中，url 可以是相对的，也许它偶然发现了错误的斜杠。

（ps 要查看 CHM 的内部结构，我使用 Free Pascal 中的“chmls”命令，但 iirc 一些 *nix CHM 查看器也显示路径）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2018-08-26T15:04:25.017

我遇到了类似的问题，我为我的情况找到了解决方法。我希望我的项目在网络共享上可用，因此我在该共享上的目录中创建了我的 *.hhp 文件。我尝试了很长时间让 HHP 软件找到我非常简单的 HTML 文件，这些文件位于 HHP 文件的子目录中，但没有成功。我最终在我的本地 C 驱动器上创建了我的 HHP 项目。当我这样做时，我可以从我们网络上的任何地方访问支持文件。将我的 HTML、CSS 等文件留在共享中对我有利，但它们可以在任何地方。唯一的缺点是编译项目后，您必须将 *.chm 文件复制到您想要的位置，但这并不是一个主要的不便。您甚至可以为该作业创建一个简单的 .bat 文件。

# android - 我如何使用迭代器从android中的hashmaps数组列表中获取每个数据？

> ID：13247941
> 
> 赞同：2
> 
> 时间：2012-11-06T09:20:38.187
> 
> 标签：android, arraylist, iterator, hashmap

我创建了从先前意图传递值的哈希映射数组列表，如下所示：

```
final ArrayList<HashMap<String, String>> saleArrList = (ArrayList<HashMap<String, String>>) intent.getSerializableExtra("saleArrList"); 
```

然后，我想从这个哈希图数组列表中获取数据，并使用迭代器来指向它。

```
 Iterator<HashMap<String, String>> it = saleArrList.iterator();
                while(it.hasNext()){
                    HashMap<String, String> value = it.next();
                    List<NameValuePair> params = new ArrayList<NameValuePair>();
                     params.add(new BasicNameValuePair("sProductID", saleArrList.get(.....).get("ProductID").toString() ));
            } 
```

我使用 Hashmap 作为迭​​代器来指向 Arraylist 中的每个 Hashmap。

如何从这个 Arraylist 中获取指定的 Hashmaps 数据？

（我应该在 get(...) 中放入什么代码或值）

感谢所有回答，对不起我的语法错误。

如果您想要更多代码，请告诉我:)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-06T10:13:25.600

尝试

```
for (HashMap<String, String> arrValue : saleArrList) {
    params.add(new BasicNameValuePair("sProductID", arrValue.get("ProductID") ));   
} 
```

您不需要 HashMap 值中的 toString()，因为它们已经是字符串。

# ruby-on-rails - 太阳黑子/Solr 无法按布尔值搜索

> ID：13247952
> 
> 赞同：3
> 
> 时间：2012-11-06T09:21:12.770
> 
> 标签：ruby-on-rails, heroku, solr, sunspot, websolr

我有一个带有布尔字段的 RoR 模型：

```
field :active, :type => Boolean 
```

在可搜索块中列出：

```
searchable do
  boolean :active 
```

而且在搜索查询中：

```
s = Document.search do
  with(:active, true)
end 
```

而且在我的 Solr schema.xml 文件中：

```
<field name="active_b" type="boolean" indexed="true" stored="true"/> 
```

问题是我的搜索并未将结果限制为仅将活动设置为 true 的文档。这适用于我的本地开发环境，但不适用于 Heroku。

有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-11T11:24:00.967

如果它正在开发中，那么这是部署或 Heroku 问题，而不是 solr/sunspot 问题。

来自 Heroku 文档[https://devcenter.heroku.com/articles/websolr](https://devcenter.heroku.com/articles/websolr)

Websolr 在[http://websolr.com/](http://websolr.com/)提供了一个控制面板，您可以在其中对索引进行更改，例如添加或删除不同的 Solr 功能、选择不同的 Solr 客户端、提供您自己的 schema.xml 等等。

您需要将 schema.xml 上传到 Websolr。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-05-13T23:46:31.487

对我来说，这是一个使用问题

```
with :deleted, false 
```

当它显然需要时：

```
with :deleted, 0 
```

不知道你是否和我有同样的问题。

# mongodb - 来自 yii mongodb 集合的不同值

> ID：13247955
> 
> 赞同：-2
> 
> 时间：2012-11-06T09:21:26.837
> 
> 标签：mongodb

我如何从 yii 中的 mongodb 集合中获取不同的值。是否和 sql 中的一样 ie 我可以在 yii 中使用 distinct(fieldname) 吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-06T09:31:53.727

在 Yii 中，我相信您必须直接访问 mongodb 对象并使用以下`distinct()`命令对其进行处理：

```
Yii::app()->mongodb->command(array("distinct" => "your_field", "key" => "your_key")) 
```

这不会返回结果的 AR 格式，因为 MongoDBs distinct 不像 SQLs 那样工作，但是您可以模拟一些与聚合框架不同的 SQLs，最有可能`$group`在您的领域。

可能有一种方法可以使用您在 Yii 中使用的任何插件执行此操作，但是除了您正在使用 Yii 之外，我们不知道...

# python - python/django 生成后台进程并避免僵尸进程

> ID：13247956
> 
> 赞同：1
> 
> 时间：2012-11-06T09:21:28.193
> 
> 标签：python, django, linux, fork, zombie-process

我需要在 django 中生成一个后台进程，视图立即返回，后台进程继续进行一些更改，然后更新数据库。这是通过`os.spawnl()`调用单独的 .py 文件的函数来完成的。

问题是后台进程完成后，变成了僵尸函数`[python] <defunct>`。

我该如何避免呢？我遵循[了这个](https://stackoverflow.com/a/972383/41948)和[这个](https://stackoverflow.com/a/5218394/41948)例子，但在 django 渲染过程之后我仍然把子进程作为僵尸。

我想借此机会练习我的 *nix 进程管理技能，所以请帮我一个忙，不要给我 Celery 或其他 mq/async 任务解决方案，我讨厌依赖。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-08T13:55:48.757

这很长一段时间的评论 -

系统`wait`调用（它`os.wait`是一个包装器）从死进程中获取退出代码/pid。您将希望`os.wait`在您的僵尸进程之上一代的进程中；僵尸进程的父进程。`SIGCHLD`当其子进程之一死亡时，父进程将收到一个信号。如果您坚持自己做所有这些，您将需要安装一个信号处理程序来捕获`SIGCHLD`信号处理程序调用和在信号处理程序调用`os.wait`中。阅读有关 unix 进程处理的一些文档和`os`模块上的 Python 文档，因为该函数的变体`os.wait`将是非阻塞的，这可能会有所帮助。

```
import signal
signal.signal(signal.SIGCHLD, lambda _x,_y: os.wait()) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-04-15T23:19:35.620

我有一个类似的问题。我使用了多处理模块中的 active_children() 。

```
import multiprocessing

# somewhere in middleware or where appropriate call
active_children() 
```

# python - MySQL 没有给出错误，但没有一个行被填充

> ID：13247957
> 
> 赞同：0
> 
> 时间：2012-11-06T09:21:34.573
> 
> 标签：python, mysql, mysql-python

我尝试使用 MySQLdb 在数据库中填充表。它没有给出任何错误，并且曾经发出警告

```
main.py:23: Warning: Data truncated for column 'other_id' at row 1
  cur.execute("INSERT INTO map VALUES(%s,%s)",(str(info[0]).replace('\n',''), str(info[2].replace('\n','').replace("'","")))) 
```

所以我认为它工作正常。但是，当它完成并且我进行了行数时，结果发现没有添加任何内容。为什么没有将数据添加到数据库中？代码如下

```
def fillDatabase():
    db = MySQLdb.connect(host="127.0.0.1", 
                         user="root", 
                         passwd="", 
                         db="uniprot_map") 

    cur = db.cursor() 
    conversion_file = open('idmapping.dat')
    for line in conversion_file:
        info = line.split('\t')
        cur.execute("INSERT INTO map VALUES(%s,%s)",(str(info[0]).replace('\n',''), str(info[2].replace('\n','').replace("'",""))))

def test():
    db = MySQLdb.connect(host="127.0.0.1", 
                         user="root", 
                         passwd="", 
                         db="uniprot_map") 

    cur = db.cursor() 
    cur.execute("SELECT COUNT(*) FROM map")
    rows = cur.fetchall()

    for row in rows:
        print row

def main():
    fillDatabase()
    test() 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-06T09:24:45.607

`db.commit()`添加所有条目后，您需要执行 a 。即使更新不是事务性的，DBAPI 也会对每个更改强加一个隐式事务。

# uwsgi - Supervisor 在 8 核机器上占用 20%-30% 的 CPU 时间

> ID：13247958
> 
> 赞同：0
> 
> 时间：2012-11-06T09:21:35.410
> 
> 标签：uwsgi, supervisord

根据以下内容...supervisord 占用了大量 CPU。主管正在管理我的 uWSGI 应用程序。这看起来很多吗？我怎样才能减少这个负载？我可以将nice更改为+1吗？

```
 1  [|||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||                       76.6%]     5  [||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||            85.4%]
  2  [|||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||           85.4%]     6  [||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||          87.2%]
  3  [||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||                82.2%]     7  [||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||                            72.8%]
  4  [||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||95.3%]     8  [||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||                      77.3%]
  Mem[|||||||||||||||||||||||                                                                                        1558/16050MB]     Tasks: 57, 15 thr; 12 running
  Swp[                                                                                                                   0/7627MB]     Load average: 8.75 8.08 7.21 
                                                                                                                                       Uptime: 01:51:59

  PID USER      PRI  NI  VIRT   RES   SHR S CPU% MEM%   TIME+  Command
29617 root       20   0  491M  144M  2604 R 84.0  0.9  1:13.48 /usr/local/bin/uwsgi --loop gevent --carbon 103.4.112.50:2003 --socket 127.0.0.1:8060 --processes 7 --pp /home/ubuntu/workspace/rtbopsConfig/rtbServers/rtbUwsgiBidderServer/ --wsgi-file /home/ubuntu/works
29615 root       20   0  421M  146M  2616 R 84.0  0.9  1:13.79 /usr/local/bin/uwsgi --loop gevent --carbon 103.4.112.50:2003 --socket 127.0.0.1:8060 --processes 7 --pp /home/ubuntu/workspace/rtbopsConfig/rtbServers/rtbUwsgiBidderServer/ --wsgi-file /home/ubuntu/works
29337 root       20   0  444M  169M  2644 R 83.0  1.1  1:31.70 /usr/local/bin/uwsgi --loop gevent --carbon 103.4.112.50:2003 --socket 127.0.0.1:8060 --processes 7 --pp /home/ubuntu/workspace/rtbopsConfig/rtbServers/rtbUwsgiBidderServer/ --wsgi-file /home/ubuntu/works
29613 root       20   0  423M  148M  2624 R 82.0  0.9  1:16.76 /usr/local/bin/uwsgi --loop gevent --carbon 103.4.112.50:2003 --socket 127.0.0.1:8060 --processes 7 --pp /home/ubuntu/workspace/rtbopsConfig/rtbServers/rtbUwsgiBidderServer/ --wsgi-file /home/ubuntu/works
29333 root       20   0  591M  172M  2604 R 82.0  1.1  1:35.10 /usr/local/bin/uwsgi --loop gevent --carbon 103.4.112.50:2003 --socket 127.0.0.1:8060 --processes 7 --pp /home/ubuntu/workspace/rtbopsConfig/rtbServers/rtbUwsgiBidderServer/ --wsgi-file /home/ubuntu/works
29474 root       20   0  428M  153M  2600 R 81.0  1.0  1:20.31 /usr/local/bin/uwsgi --loop gevent --carbon 103.4.112.50:2003 --socket 127.0.0.1:8060 --processes 7 --pp /home/ubuntu/workspace/rtbopsConfig/rtbServers/rtbUwsgiBidderServer/ --wsgi-file /home/ubuntu/works
29611 root       20   0  429M  154M  2616 R 80.0  1.0  1:20.54 /usr/local/bin/uwsgi --loop gevent --carbon 103.4.112.50:2003 --socket 127.0.0.1:8060 --processes 7 --pp /home/ubuntu/workspace/rtbopsConfig/rtbServers/rtbUwsgiBidderServer/ --wsgi-file /home/ubuntu/works
24760 root       20   0 49932 12520  1744 R 33.0  0.1 26:05.37 /usr/bin/python /usr/local/bin/supervisord 
```

监督配置：

```
# -*- conf -*-

[include]
files = *.supervisor

[supervisord]
pidfile = /var/run/supervisord.pid
nodaemon=false

[supervisorctl]
serverurl=unix:///var/run/supervisord.sock ; use a unix:// URL for a unix socket

[unix_http_server]
file = /var/run/supervisord.sock

[rpcinterface:supervisor]
supervisor.rpcinterface_factory = supervisor.rpcinterface:make_main_rpcinterface

[program:uwsgiBidder]
autostart=true
autorestart=true
process_name = uwsgiBidder-%(process_num)s
<% if @enviroment=='production' -%>
command = /usr/local/bin/uwsgi --loop gevent --carbon <%=@carbon_ip_address%>:2003 --socket 127.0.0.1:8060 --processes <%= @bidder_cores %> --pp /home/ubuntu/workspace/rtbopsConfig/rtbServers/rtbUwsgiBidderServer/ --wsgi-file /home/ubuntu/workspace/rtbopsConfig/rtbServers/rtbUwsgiBidderServer/uwsgiBidderServer.py -b 62768 --master --async 2000 --enable-threads --listen 2048 --reload-on-rss 1200 --touch-reload /home/ubuntu/workspace/rtbopsConfig/rtbServers/rtbUwsgiBidderServer/uwsgiBidderServer.py 
<% end -%>

numprocs = 1
numprocs_start = 8060
stopsignal=QUIT
#user=www-data
#--uid www-data 
```

这是iotop的输出

```
> Total DISK READ:       0.00 B/s | Total DISK WRITE:      27.46 K/s  
> TID  PRIO  USER     DISK READ  DISK WRITE  SWAPIN     IO>    COMMAND  
> 280 be/3 root        0.00 B/s    0.00 B/s  0.00 %  0.27 %
> [jbd2/dm-1-8] 24760 be/4 root        0.00 B/s  388.30 K/s  0.00 % 
> 0.00 % python /usr/local/bin/supervisord
>     1 be/4 roo 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-06T11:10:00.653

您需要关闭 uwsgi 请求日志记录 ( )，或者配置 uwsgi 以使用或提供的[UDP 日志记录选项](http://projects.unbit.it/uwsgi/wiki/UdpLogging)`--disable-logging`在别处记录请求。`--logto`

现在发生的事情是您的 uwsgi 进程在其标准输出上发送大量数据，因此内核正在唤醒您的 supervisord 进程以处理日志数据（通过`select()`调用）。使用 6K qps，您真的希望有其他东西来处理大量的日志数据。

# ios - SLComposeViewController 对 Facebook 和 Twitter 的处理方式不同？

> ID：13247960
> 
> 赞同：18
> 
> 时间：2012-11-06T09:21:39.427
> 
> 标签：ios, slcomposeviewcontroller

我有一些看起来像这样的社交分享代码：

```
SLComposeViewController *composer = [SLComposeViewController composeViewControllerForServiceType:…];
[composer setInitialText:…];
[composer addURL:…];
[composer setCompletionHandler:^(SLComposeViewControllerResult result) {
    [someController dismissViewControllerAnimated:YES completion:^{
        … // 1
    }];
}];
[someController presentModalViewController:composer animated:YES]; 
```

问题是 Facebook 和 Twitter 的代码行为不同。当用户确认 Facebook 撰写屏幕时，作曲家显然会自行解散，因为标记为 1 的完成处理程序从未被调用，即使我删除了`dismissViewControllerAnimated:`调用，一切正常。

另一方面，当用户确认 Twitter 撰写屏幕并且我没有手动关闭它时，撰写屏幕滑出，但应用程序仍然卡住，就像某个控制器仍在前台一样。当我添加`dismissViewControllerAnimated:`调用时，问题消失了，完成处理程序 (1) 被正确调用。

您是否也注意到了这种行为？难道我做错了什么？这是当前的 iOS 6，[GitHub 上的示例代码](https://github.com/zoul/Social-Composer-Test)。我已向 Apple (Radar #12642889) 报告了该问题，但还没有任何反应。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-26T23:17:29.753

我在我的应用程序中做类似的事情，与您的代码的唯一区别是我发送`dismissModalViewControllerAnimated:`到`self`而不是发送到视图控制器。
facebook 和 twitter 作曲家都滑走了。

这是我的代码：

```
SLComposeViewController *composer = [SLComposeViewController composeViewControllerForServiceType:SLServiceTypeTwitter];
[composer setInitialText:text];
[composer setCompletionHandler:^(SLComposeViewControllerResult result) {
    ...
    [self dismissModalViewControllerAnimated:YES];
}];
[self presentModalViewController:composer animated:YES]; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-08-26T08:44:13.317

该问题显然已在 iOS 7 中得到解决，并在 7.0 beta build 11A4449d 上进行了测试。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-07-01T19:44:32.827

我已确认您的行为问题：

Twitter 版本调用您在视图控制器上设置的完成处理程序，并期望您将从该处理程序中调用dismissViewController。

然而，Facebook 版本在调用完成处理程序之前调用了 dismissViewController 本身。如果您随后自己调用dismissViewController，则不会发生任何事情，并且您不会从您可能传递给dismissViewController 的任何完成块中获得任何回调。

如果您忽略了dismissViewController 调用，那么Twitter 共享就会卡住，但Facebook 可以工作。

如果 Apple 要修复该行为，那么创建解决方案是一个问题，因为您的解决方案会被破坏。主要问题是同一社交分享VC的微博、Twitter和Facebook分享版本之间的行为不一样。

这是我解决问题的方法：

```
SLComposeViewController *vc = [SLComposeViewController composeViewControllerForServiceType:serviceType];
if(vc==nil)
{
    [self.delegate imageSaveDidSucceed:NO];
}
else
{
    [vc addImage:self.image];
    vc.completionHandler = ^(SLComposeViewControllerResult result) {
        DEBUG_LOG(@"social sharing completed");
        if(self.presentedViewController)
        {
            DEBUG_LOG(@"presented vc is not nil");
            [self dismissViewControllerAnimated:YES completion:^{
                DEBUG_LOG(@"dismissed vc and calling imageSaveDidSucceed");
                [self.delegate imageSaveDidSucceed:YES];
            }];
        }
        else
        {
            DEBUG_LOG(@"presented vc is nil");
            [self.delegate imageSaveDidSucceed:YES];
        }
    };
    [self presentViewController:vc animated:YES completion: ^{DEBUG_LOG(@"vc was presented");}];
} 
```

# iphone - uisearchdisplaycontroller 预加载搜索结果和搜索栏

> ID：13247963
> 
> 赞同：1
> 
> 时间：2012-11-06T09:21:51.433
> 
> 标签：iphone, ios, uitableview, uisearchdisplaycontroller

如何在 UISearchDisplayController 中预加载搜索查询。目前我正在做以下事情：

```
 [self.searchDisplayController setActive: YES animated: YES];
    self.searchDisplayController.searchBar.hidden = NO;
    self.searchDisplayController.searchBar.text = self.pendingSearchTerm;
    [self.searchDisplayController.searchBar becomeFirstResponder]; 
```

尽管这会显示搜索结果窗口并搜索表格，但它不会像用户单击搜索栏时那样在导航栏中显示搜索栏。如果未显示搜索栏，则用户可能不清楚搜索是否已执行。

有没有办法让搜索栏出现？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-01-25T00:34:18.223

您可以做的是当用户单击搜索并且字符串为空时，将 searchBartext 更改为“\n”回车

```
self.searchDisplayController.searchBar.text = @"\n"; 
```

回车不会显示在搜索栏中，也不会是相同的字符串，就像用户键入“\n”一样。所以它工作正常。在里面

```
-(BOOL)searchDisplayController:(UISearchDisplayController *)controller shouldReloadTableForSearchString:(NSString *)searchString 
```

方法您可以将搜索栏文本设置回@""。如果搜索字符串是 @"\n"

```
self.searchDisplayController.searchBar.text = @""; 
```

这对我有用！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-07T11:47:45.327

所以经过一番蛮力，我终于想出了一个可行的解决方案。

这是我的设置：我有两个表视图 - T1、T2。T1 的数据是本地的，T2 从 Internet 获取数据。当用户在 T1 中搜索并且没有结果时，用户可以点击一个按钮在 T2 上执行相同的搜索。所以现在当 T2 出现时，它会默认显示导航项 - 这是我无法更改的。

在-[T2 viewDidAppear:]

```
 [self.searchDisplayController setActive: YES animated: NO];
    self.searchDisplayController.searchBar.text = self.pendingSearchTerm;
    self.searchDisplayController.searchResultsTableView.hidden = YES; // so that we don't see "no results" 
```

当 T2 的数据准备好时：

```
[self.tableView reloadData];
self.searchDisplayController.searchBar.text = self.searchDisplayController.searchBar.text; // to reload search
self.searchDisplayController.searchResultsTableView.hidden = NO; 
```

希望这可以帮助某人。如果您能够找到一种最初隐藏导航栏的方法，那将解决我剩下的问题。

# google-app-engine - 在生产运行代码两天后，GAE servlet 抛出 IncompatibleRemoteServiceException

> ID：13247968
> 
> 赞同：0
> 
> 时间：2012-11-06T09:22:20.593
> 
> 标签：google-app-engine

周日下午，我确实推出了一个新版本的网站。从那时起，约有 50 名用户一直在使用这项新服务。在周一到周二的晚上，一个 servlet 在客户端和服务器之间交换 DTO 时抛出了“IncompatibleRemoteServiceException”。

看起来就像在某个时候使用了以前版本的服务器（或客户端）代码。有没有人遇到过这种类型的问题？

任何帮助将不胜感激！

javax.servlet.ServletContext 日志：ExternalService：处理此调用时引发了 IncompatibleRemoteServiceException。com.google.gwt.user.client.rpc.IncompatibleRemoteServiceException：在 com.google.gwt.user.server.rpc.RPC.decodeRequest(RPC. java:315) 在 com.google.gwt.user.server.rpc.RemoteServiceServlet.processCall(RemoteServiceServlet.java:206) 在 com.google.gwt.user.server.rpc.RemoteServiceServlet.processPost(RemoteServiceServlet.java:248)在 com.google.gwt.user.server.rpc.AbstractRemoteServiceServlet.doPost(AbstractRemoteServiceServlet.java:62) 在 javax.servlet.http.HttpServlet.service(HttpServlet.java:637) 在 javax.servlet.http.HttpServlet.service (HttpServlet.java:717) 在 org.mortbay.jetty.servlet.ServletHolder。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-06T17:47:17.083

如果您在初始部署后随时更新和部署代码，则您的一个客户端可能正在使用缓存的客户端代码。看到这个[答案](https://stackoverflow.com/a/9523874/498860)。

# javascript - 检查现有日期对象是否为 UTC - Javascript

> ID：13247970
> 
> 赞同：3
> 
> 时间：2012-11-06T09:22:23.070
> 
> 标签：javascript, date, timezone

我使用 Javascript 函数将日期转换为 UTC 日期，如下所示：

```
Date.prototype.convertToUTC = function () {
var month = this.getMonth();
var day = this.getDate();
var year = this.getFullYear();
return new Date(Date.UTC(year, month, day));
} 
```

现在，当应用此函数的日期已经是 UTC 时，就会出现问题。由于我不知道用户是否会在 UTC/Local 日期调用此方法，因此我想确保只有在不是 UTC 时才会发生转换。请帮忙。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-06T09:32:23.567

All dates have a [UTC time value](http://ecma-international.org/ecma-262/5.1/#sec-15.9.1.1) at their heart. Date objects created in a host are given a read–only [timezone offset](http://ecma-international.org/ecma-262/5.1/#sec-15.9.5.26) based on the system settings, and values read using [getDate](http://ecma-international.org/ecma-262/5.1/#sec-15.9.5.14), [getHours](http://ecma-international.org/ecma-262/5.1/#sec-15.9.5.18), etc. are based on that offset.

If you want UTC milliseconds since the epoch, just use the [getTime()](http://ecma-international.org/ecma-262/5.1/#sec-15.9.5.9) method. Alternatively, there are the UTC methods, [getUTCDay](http://ecma-international.org/ecma-262/5.1/#sec-15.9.5.17), [getUTCHours](http://ecma-international.org/ecma-262/5.1/#sec-15.9.5.19), etc. to build your own formatted string.

Finally, there is [toISOString](http://ecma-international.org/ecma-262/5.1/#sec-15.9.5.43) which should return an ISO formatted date string for UTC, but support may be lacking in not so old browsers.

### Some examples

To create a local date object for 2012-11-06T15:45:01Z:

```
var date = new Date(Date.UTC(2012, 10, 6, 15, 45, 1)); 
```

To get an ISO date string from that (or any) date object:

```
var isoString = date.toISOString(); 
```

To get a UTC time value in milliseconds (ms since 1970-01-01T00:00:00Z):

```
var timeValue = date.getTime(); 
```

To turn that time value back into a local date object:

```
var date = new Date(timeValue); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-06T09:33:41.483

JavaScript `Date` object has the method `getTimezoneOffset()`. You could use that. Or use the `getUTC*` methods:

```
 var d = new Date();
 var utcyear = d.getUTCFullYear(); 
```

# android - 要在 android 的 Twitter 中单击按钮发布照片？

> ID：13247971
> 
> 赞同：0
> 
> 时间：2012-11-06T09:22:31.427
> 
> 标签：android

在我的应用程序中，我想通过单击按钮在 Twitter 中发布照片。
所以我使用了这么多代码但不起作用。所以我想一键获取在推特上分享照片的代码

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-06T09:29:55.297

在去问问题之前。尝试谷歌或搜索类似的问题。

见这里：[见这里](https://stackoverflow.com/questions/8381671/is-there-any-twitter-demo-exmaple-to-post-photo-on-twitter-with-using-oauth-in-t)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-06T09:36:46.137

尝试这个：

```
 Intent targetedShare = new Intent(android.content.Intent.ACTION_SEND);
                targetedShare.setType("image/jpeg"); // put here your mime type
                targetedShare.putExtra(Intent.EXTRA_TEXT,     "My body of post/email");
                targetedShare.putExtra(Intent.EXTRA_STREAM, Uri.fromFile(new File(imagePath)) );

                Intent chooserIntent = Intent.createChooser(targetedShare, "Select app to share");
                chooserIntent.putExtra(Intent.EXTRA_INITIAL_INTENTS, targetedShare);
                startActivity(chooserIntent); 
```

# mysql - AUTO_INCREMENT 在我的情况下是否正确实施？

> ID：13247972
> 
> 赞同：3
> 
> 时间：2012-11-06T09:22:32.310
> 
> 标签：mysql, last-insert-id

[**这个问题与我的旧问题Getting last record from mysql**](https://stackoverflow.com/questions/8923366/getting-last-record-from-mysql)有点相关。

根据这些答案，我了解到***SELECT 不能保证以任何特定顺序返回行（当然，不使用 ORDER BY 子句）。***

我遵循@YaK 的答案并`AUTO_INCREMENT`使用以下命令在表中添加。

```
ALTER TABLE maxID ADD sequence INT DEFAULT NULL;
ALTER TABLE maxID ADD INDEX(sequence);
ALTER TABLE maxID MODIFY sequence INT AUTO_INCREMENT; 
```

然而今天我有一个问题。

**什么时候`SELECT`不能保证以任何特定顺序返回行（`ORDER BY`当然不使用子句），那么在更改表时，`AUTO_INCREMENT`会正确实现吗？**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-12T16:39:50.247

Depends on Engine type for what is happening in the background:

'For MyISAM and BDB tables you can specify AUTO_INCREMENT on a secondary column in a multiple-column index. In this case, the generated value for the AUTO_INCREMENT column is calculated as MAX(auto_increment_column) + 1 WHERE prefix=given-prefix. This is useful when you want to put data into ordered groups.'

This will create tables with multiple values on the auto_increment, non-unique values.

So what you really mean is to have a PRIMARY KEY with auto_increment (though not necessary) for InnoDB tables. A simple select will return values in the Primary Key order when selecting without a order by clause because it is stored in this order and will use the Primary Key for sorting.

If you want a specific order ALWAYS specify it, use the PRIMARY KEY if you want, but ALWAYS specify it.

# xml - 带有样式模板的 XML 到 HTML 生成器

> ID：13247980
> 
> 赞同：0
> 
> 时间：2012-11-06T09:22:53.383
> 
> 标签：xml, xslt, xml-parsing, html-generation

使用样式模板从 xml 数据生成 html 文件的最佳方法是什么？我知道 XSLT 和 XML，但我需要使用样式模板（XSLT/CSS）生成 html 文件。

例如：

```
XML+ XSLT/CSS + images+ javascript -->  工具  --> html 文件。
```

为什么我要生成 html 文件是因为当我们尝试打开 xml（使用 xslt 样式）时，我使用的浏览器显示“bad mimetype”。

任何类型的方向或工具实施建议（在 java、php、c++ 中）都值得赞赏。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-05T11:50:04.850

好的，经过调查，我找到了这个工具的最佳解决方案。

XML + XSLT + 图像 + javascript/CSS -> 工具 -> html 站点

实现此工具的最佳方式是使用基于 XSLT 2.0 处理器/转换器的 API；在 java 中的实现以不同的方式可用：例如，Saxon 正在被广泛使用。

# jquery - jQuery 特殊事件 hoverintent 不能与“mouseleave”函数一起正常工作

> ID：13247981
> 
> 赞同：2
> 
> 时间：2012-11-06T09:23:05.533
> 
> 标签：jquery, mouseleave, hoverintent

我很难让`jQuery`特殊事件`hoverintent`与`mouseleave`函数一起使用。*（我也尝试过`mouseout`替换`mouseleave`）*

我需要使用相同的功能，以便`mouseleave`仅在用户的鼠标速度低于灵敏度阈值时触发事件。

我已经包含了下面的脚本，并且还上传了一个工作示例到[http://click2fit.com/test_files/accordion_hoverintent.html](http://click2fit.com/test_files/accordion_hoverintent.html)

```
$(function () {     
    $(".accordion_close_leave").accordion({
                event: "click hoverintent",
                collapsible: true,
                active: false,     
                autoHeight: false,
             }).mouseleave(function() {
    $(this).accordion({ active: false}); 
    });  

var cfg = ($.hoverintent = {
    sensitivity: 100,
    interval: 500
});
$.event.special.hoverintent = {
    setup: function() {
        $( this ).bind( "mouseover", jQuery.event.special.hoverintent.handler );
    },
    teardown: function() {
        $( this ).unbind( "mouseover", jQuery.event.special.hoverintent.handler );
    },
    handler: function( event ) {
        var that = this,
            args = arguments,
            target = $( event.target ),
            cX, cY, pX, pY;
        function track( event ) {
            cX = event.pageX;
            cY = event.pageY;
        };
        pX = event.pageX;
        pY = event.pageY;
        function clear() {
            target
                .unbind( "mousemove", track )
                .unbind( "mouseout", arguments.callee );
            clearTimeout( timeout );
        }
        function handler() {
            if ( ( Math.abs( pX - cX ) + Math.abs( pY - cY ) ) < cfg.sensitivity ) {
                clear();
                event.type = "hoverintent";
                event.originalEvent = {};
                jQuery.event.handle.apply( that, args );
            } else {
                pX = cX;
                pY = cY;
                timeout = setTimeout( handler, cfg.interval );
            }
        }
        var timeout = setTimeout( handler, cfg.interval );
        target.mousemove( track ).mouseout( clear );
        return true;
    }
}; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-10T18:15:41.300

事实证明，jQuery 的 hoverintent 特殊事件代码在这里不起作用，因为它是专门为包含 Accordion 的事件选项而设计的（它被定义为手风琴标题响应以激活相关面板的事件）。

好消息是[Brian Cherne 的 hoverintent 插件](http://cherne.net/brian/resources/jquery.hoverIntent.html/ "Brian Cherne 的 hoverIntent 插件")可以：-D 我已经包含了下面的脚本，这里有一个可用的小提琴：http: [//jsfiddle.net/chayacooper/GZV5V/26/](http://jsfiddle.net/chayacooper/GZV5V/26/)

重要的是要记住将 mouseleave 绑定到手风琴本身，以便在用户将鼠标从整个手风琴上移开之前它不会被触发。如果用户在进入标题时立即单击标题，则双重激活存在一个小问题，但我愿意接受这一点，以便能够在手风琴内使用 Select 元素。

```
$(document).ready(function() {
$("#Trigger2").accordion({
    active: false,
    collapsible: true
}).hoverIntent({
    over: function() {},
    out: function() {
        $('.ui-accordion-header-active', this).trigger('click').blur();
    },
    timeout: 1000
})

.children('h3').hoverIntent({
    over: function() {
        $(this).not('.ui-accordion-header-active').trigger('click');
    },
    out: function() {},
    timeout: 1000
});
}); 
```

# wordpress - 如何将代码插入wordpress

> ID：13247984
> 
> 赞同：34
> 
> 时间：2012-11-06T09:23:16.963
> 
> 标签：wordpress

在许多 wordpress 博客中，我们看到如下代码。 ![在此处输入图像描述](../Images/3841cd8786c518e7869c3e2f7ff4d11b.png)

现在我想把我的代码也这样？怎么做？它是属于任何第三方工具还是内置于 wordpress 中？当我将代码复制并粘贴到博客中时，它看起来很难看。请给我建议，使我的博客更具可读性。谢谢

* * *

## 回答 #1

> 赞同：64
> 
> 时间：2012-11-07T12:35:13.717

*如果您在 Wordpress.com 上运行您的博客*，您只需在代码前包含以下几行。

```
[sourcecode language="csharp"]
//your code comes here
[/sourcecode] 
```

Wordpress.com 为我们提供了避免担心代码高亮的便利。如果您的代码位于这些块之间，那么它将根据您指定的语言自动呈现。它可以支持多种语言。

他们之中有一些是..

html

javascript

爪哇

javafx

matlab（仅关键字）

对象

perl

php

*如果您有一个自托管站点，或者托管在 wordpress.org 上的站点，*您应该使用 SyntaxHighlighter 插件：[wordpress.org/plugins/syntaxhighlighter](http://wordpress.org/plugins/syntaxhighlighter)。

这是 WordPress 团队为在 wordpress.com 上创建此功能而采购的插件

有关更多信息，请参阅此[链接](http://en.support.wordpress.com/code/posting-source-code/)

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2013-11-27T13:08:53.460

## 很抱歉，但是您提到了以下代码`WONT WORK`

```
[sourcecode language="csharp"]
//your code comes here
[/sourcecode] 
```

因此，在[Wordpress 网站](http://en.support.wordpress.com/code/posting-source-code/)上将代码片段添加到 wordpress 博客是：

```
[code language="javascript"]
//your language script here
[/code] 
```

希望这对您有所帮助！:)

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2012-11-06T10:39:43.990

您正在寻找的是某种语法荧光笔。代码在您的帖子中显示在一个带有行数等的框中的位置，对吗？

wordpress 中有一些插件可以做到这一点。

查看：

[http://wordpress.org/extend/plugins/syntaxhighlighter/](http://wordpress.org/extend/plugins/syntaxhighlighter/)

[http://wordpress.org/extend/plugins/crayon-syntax-highlighter/](http://wordpress.org/extend/plugins/crayon-syntax-highlighter/)

希望能帮助到你。干杯

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2016-11-24T15:52:49.167

添加到 SHEKHAR SHETE 的答案。

**对于内联代码块：**

选择文本然后执行`Alt+Shift+x`将使文本如下：

```
THIS is an example 
```

这实际上将围绕文本`<code></code>`

在里面写文字``..``是另一种方式

[资源](https://codex.wordpress.org/Keyboard_Shortcuts)

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2019-02-21T13:31:08.533

如果您想在 wordpress 帖子中添加代码，请执行此操作：

在您的 wordpress 编辑器中从 HTML 切换到文本，然后 `<code>` 作为起始标签和 `</code>` 结束标签插入。

在我写答案时，这是在最新的 wordpress 中唯一有效的方法。玩得开心！

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2022-01-07T22:15:27.467

最新：在编辑帖子中，开始输入 /syntax。选择语法高亮。您可以更改块中的语言类型。

WordPress[帮助](https://wordpress.com/support/wordpress-editor/blocks/syntax-highlighter-code-block/)

# c - 返回类型为二维数组

> ID：13247988
> 
> 赞同：1
> 
> 时间：2012-11-06T09:23:40.070
> 
> 标签：c, calloc

以下代码在编译时给出了函数 fun2() 冲突类型的错误。

```
#include<stdio.h>
#include<stdlib.h>

char ***  fun(){
    char *** b;
    calloc(10,sizeof(char **));
    b[0]=fun2();
    return b;
}

char ** fun2(){
    char **a;
    a=calloc(10,sizeof(char*));
    a[0]=calloc(10,sizeof(char));
    return a;
}
main(){
    char **c;
    c=fun();
} 
```

但是，这段代码没有 -

```
#include<stdio.h>
#include<stdlib.h>

char ***  fun(){
    char *** b;
    calloc(10,sizeof(char **));
    b=fun2();
    char **a;
    a=calloc(10,sizeof(char*));
    a[0]=calloc(10,sizeof(char));
    return a;
}

main(){
    char **c;
    c=fun();
} 
```

但是，这两个程序都在做同样的任务。编译错误背后的原因是什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-06T09:27:08.207

第一个代码片段的问题在于`fun2()`它在第一次使用之前没有被定义或声明。编译器生成一个隐式函数声明，该声明返回 an`int`但是实际定义`fun2()`返回 a `char**`，这是冲突类型编译器错误的原因。要更正冲突的类型错误，您可以将 的定义`fun2()`或声明置于 的`fun2()`定义之前`fun()`。

请注意，某些`calloc()`调用的返回值*并未*分配给任何变量。

只需提及`calloc()`将所有位设置为零，根据 C99 标准：

> 请注意，这不必与浮点零或空指针常量的表示相同。

所以对指针数组的使用`calloc()`可能`NULL`是*不*正确的（实际上我不知道这是否曾经是这种情况）。另一种方法是显式分配`NULL`给指针数组中的每个元素。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-06T09:30:11.927

编译器还没有看到 的定义`fun2()`。您必须在 fun2() 之前声明该函数：

```
char ** fun2();

char ***  fun(){
... 
```

或将 fun2() 移到 fun() 之前：

```
char ** fun2(){
...
} 
```

请注意，`b`在这两种情况下您都没有分配值，分配的内存`calloc()`会丢失。您应该将其修改为：

```
char *** b = calloc(10,sizeof(char **)); 
```

# r - 将日期中的月份更改为第一天 (01)

> ID：13247993
> 
> 赞同：22
> 
> 时间：2012-11-06T09:23:45.183
> 
> 标签：r, date, datetime

我想在`Date`当前月份的开始日期（`01`）中设置月份中的某天。现在我使用以下内容：

```
currentDate <- Sys.Date()  #for getting current system date eg:2012-11-06
formatDate <- format(currentDate, "%Y-%m")  #it return 2012-11
startDate <- as.Date(paste(formatDate, "-01", sep = ""))
# 2012-11-01 
```

有什么简单的方法可以做到这一点？

* * *

## 回答 #1

> 赞同：35
> 
> 时间：2012-11-06T09:27:42.077

是的，有一个使用函数的单行代码`cut`：

```
cut(Sys.Date(), "month")
[1] 2012-11-01
Levels: 2012-11-01 
```

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2017-06-19T09:34:39.730

还有一行使用格式功能：

```
format(Sys.Date(),"01-%m-%Y")
[1] "01-06-2017" 
```

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2018-05-08T15:18:41.190

`lubridate`'s`floor_date`保持日期

```
library(lubridate)

floor_date(Sys.Date(), "month") 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2017-12-28T00:41:28.853

```
as.Date(paste0(format(Sys.Date(), "%Y-%m"), "-01")) 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2018-01-17T01:32:35.903

使用`lubridate`（也与`sec`, `min`, `hour`,`mon`等一起使用`year` ）

```
library(lubridate)

dt <- Sys.Date()
day(dt) <- 01

dt
# [1] "2018-01-01" 
```

# html - 如何获得适合给定宽度行的多个等宽字母？

> ID：13247995
> 
> 赞同：1
> 
> 时间：2012-11-06T09:23:48.523
> 
> 标签：html, css, xslt

我需要实现像素完美的标记。想法如下：有两个字符串需要打印为单个文本块。文本必须分成几行。第一个字符串必须以一种方式格式化，第二个以另一种方式格式化。以下是可能存在的示例：

![标记示例](../Images/215585df785ab188c53eca9e475e07c5.png)

我想我可以`<table>`为每一行使用 a 并放置`<p>aragraphs`在其中以获得不同的字体样式。我的问题是我唯一可能使用的东西是 XSL 和 HTML+CSS。所以我希望编写一个模板来提供所需的 HTML 作为其输出。

为此，我需要知道一行中可以放置多少个字母（线宽和字体大小可以改变），并在必要时对单词进行换行。我将使用等宽字体。有没有办法根据线宽和字体大小来计算一行中可以容纳的字母数量？

# php - 如何从表的 2 列中对精确的串联值进行分组？

> ID：13247996
> 
> 赞同：-1
> 
> 时间：2012-11-06T09:23:50.817
> 
> 标签：php, mysql, sql, group-by

我有一张有 2 列`latitude`和`longitude`.
一些数据行在 2 列上有完全匹配的串联值。

```
/* Points Table */
lat |long
2.1 |5.8
2.1 |5.6    -Set as Group
2.1 |5.6    -Set as Group
2.1 |5.6    -Set as Group
2.3 |5.2
2.4 |5.3
2.5 |5.3    -Set as Group
2.5 |5.3    -Set as Group
2.6 |5.3
2.5 |5.3 
```

我想设置为 2 列的组串联值，例如我的 SQL Query Like 的结果：

```
/* Points Table */
lat |long
2.1 |5.8
2.1 |5.6    -Grouped
2.3 |5.2
2.4 |5.3
2.5 |5.3    -Grouped
2.6 |5.3
2.5 |5.3 
```

我怎样才能做到这一点 ？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-06T09:27:15.427

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-06T09:27:00.423

你可以在mysql中分组：

```
SELECT lat, long FROM your_table GROUP BY lat, long; 
```

您还可以通过向这 2 列添加索引来避免将来出现相等的值：

```
ALTER TABLE your_table ADD UNIQUE INDEX(lat, long); 
```

# php - $_SERVER['PHP_SELF'] 漏洞没有“工作”？

> ID：13247997
> 
> 赞同：0
> 
> 时间：2012-11-06T09:23:52.397
> 
> 标签：php, security

查看客户的旧代码，他正在使用

```
<form action="<?php echo $_SERVER['PHP_SELF']; ?>" /> 
```

我想知道它是否受到 XSS 的影响，但是当我尝试时：

*   `form.php"><script>alert('xss');</script>`=> 404 未从 Apache 中找到
*   `form.php/"><script>alert('xss');</script>`=> 404 来自我的应用

我必须指定我还在 url 中使用 ?action=specific_page 以供正常使用。

这是否意味着无法使用 XSS，`PHP_SELF`或者这是否意味着我以错误的方式尝试它？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-06T09:40:09.573

如果您的表单位于`form.php`脚本中，请尝试使用浏览器中的 url 访问它，`http://yoursite.com/form.php/"><script>alert('XSS')</script>`以查看它是否容易被注入。

如果它不做任何事情，您的配置会阻止这种情况，至少对于这个特定文件是这样。

（当然，`htmlspecialchars($_SERVER['SCRIPT_NAME'])`无论如何你都应该使用类似的东西。）