# StackOverflow 问答 15349000-15349999

# asp.net - asp.net 不显眼的验证删除值更改

> ID：15349007
> 
> 赞同：0
> 
> 时间：2013-03-11T21:28:07.720
> 
> 标签：asp.net, asp.net-mvc, asp.net-mvc-4, jquery-validate, unobtrusive-validation

我有自定义验证器，除了值更改时没有删除错误消息外，一切正常。

```
(function ($) {
$.validator.addMethod('lastcategory', function (value, element) {
    alert(value);
    return value != 0;
}, '');

$.validator.unobtrusive.adapters.addBool('lastcategory');

$.validator.setDefaults({ ignore: [] });
}(jQuery)); 
```

我的领域是隐藏领域。当我按下提交时，值为 0 并且错误可见。当我通过 jquery 更改值时，eq : 7，错误消息仍然存在。

为什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-11T21:57:11.553

该错误未删除，因为该隐藏字段值的更改未跟随插件使用的事件，例如`onfocusout`,`onkeyup`等。

在您的 jQuery 中，在您更改隐藏字段的值后，立即调用[插件的`.valid()`方法以编程方式触发另一个验证测试](http://docs.jquery.com/Plugins/Validation/valid)，然后自动更新任何未完成的消息。

```
$('#myHiddenFieldID').val(myNewValue); // whatever code is changing the value of the hidden field.
$('#myFormID').valid(); 
```

# nesc - 与事件和命令的接口 - 无法发出事件信号

> ID：15349012
> 
> 赞同：1
> 
> 时间：2013-03-11T21:28:51.637
> 
> 标签：nesc

我发现很难在 nesC 中发出事件信号。任何人都可以帮忙吗？（编辑：我在下面的代码中省略了 MainC 组件）。

我定义了一个简单的接口：

```
interface MyInterface {
    command uint8_t action();
    event void actionDone();
} 
```

它有一个动作和一个事件。

更重要的是，我有一个提供 MyInterface 的组件：

```
configuration MyComponentC {
    provides interface MyInterface[uint8_t id];
}
implementation {
    components MyComponentM;
    MyInterface = MyComponentM.MyInterface;
}

module MyComponentM {
    provides interface MyInterface[uint8_t id];
}
implementation {
    command uint8_t MyInterface.action[uint8_t id]() {...}
    ...
    event void bar() {
        signal MyInterface.actionDone[foo]();
    }
} 
```

事件栏来自完全不同的界面。在这种情况下，我想用 id == foo 发出事件 actionDone 的信号。

我还有“主要”组件：

```
configuration MyAppC {
}
implementation {
    components MyC as App;
    components MyComponentC as MC;
    App.MyInterface -> MC.MyInterface[unique("Hello")];
}

module MyC {
    uses interface MyInterface;
}
implementation {
    event void MyInterface.actionDone() {...}
} 
```

但是在编译过程中出现错误：

```
MyInterface.actionDone not connected 
```

我在哪里做错了？如何正确连接组件？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-11T22:07:09.737

不确定这是否是原因，但在您的应用程序中尝试通过别名引用 MyC，即代替

```
MyC.MyInterface -> MS.MyInterface[unique("Hello")]; 
```

尝试

```
App.MyInterface -> MS.MyInterface[unique("Hello")]; 
```

[更新]

[如此链接](http://mail.millennium.berkeley.edu/pipermail/tinyos-help/2005-January/007229.html)中所述，由于您使用的是参数化接口，并且无法保证所有 256 个实例都将连接到您需要在 MyComponentM 模块中提供默认实现的东西

```
default event MyInterface.actionDone[foo]() {
    return;
} 
```

# jquery - jQuery中url改变后执行一个函数

> ID：15349017
> 
> 赞同：0
> 
> 时间：2013-03-11T21:29:15.517
> 
> 标签：jquery

我想知道是否可以在 Javascript 或 jQuery 中使用 .unload(...) 或类似函数，以便在用户更改或重新加载页面**后执行操作。**

在我的具体情况下，我做了一个书签，它在页面上创建了一个 div 元素，我想在导航期间保留它，而无需再次执行 Javascript 代码。

我想用 JS/jQuery 来解决它，因为我不会依赖我的浏览器。如果不可能，我怎样才能达到类似的结果？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-11T21:39:04.400

URL 更改会停止所有当前的 JavaScript 执行。

您可能想研究使用[URL HASH 来维护 state](https://developers.google.com/tv/web/articles/location-hash-navigation#loc-hash)。

# asp.net-mvc-3 - 模态窗口在关闭后将表单数据放在查询字符串上

> ID：15349022
> 
> 赞同：0
> 
> 时间：2013-03-11T21:29:45.750
> 
> 标签：asp.net-mvc-3, jquery

我有一个 MVC3 站点，它生成一个带有安全问题的模式窗口。问题是，当 ajax 调用返回时，无论是成功还是错误以及模态窗口关闭，所有表单数据最终都在父窗口的查询字符串上

```
$(this).dialog('destroy'); 
```

**和**

```
 $(this).dialog('destroy').remove(); 
```

**和**

```
and placing close: function () { $(this).dialog('destroy'); }, 
```

在对话框实例化中，成功率为零。

如何防止模态窗口将表单值传递给父窗口查询字符串？

**出现在模态窗口中的局部视图**

```
 <div id="resetpanel">
    <form name="pwreset" id="pwreset" action="" method="post">
        Account Number: <input type="text" name="acctNumber" id="acctNumber" /><br />
        <button class="btn" name="btnNext" onclick="goResetValidate();return false;">Next</button>
    </form>
</div>
<div id="challengepanel">
    <form name="challenge" id="challenge" style="display:none;" action="" method="post">
        <input type="hidden" name="setNum" id="setNum" value="" />
        Member Number: <input type="text" name="acctNumber2" id="acctNumber2" readonly="true" /><br />
        <label id="Q0"></label>
        Answer: <input type="text" name="answer1" id="answer1" /><br />
        <label id="Q1"></label>
        Answer: <input type="text" name="answer2" id="answer2" /><br />
        <label id="Q2"></label>
        Answer: <input type="text" name="answer3" id="answer3" /><br />
        <button class="btn" name="btnNext" id="challengebutton" onclick="goResetPassword();return false;">Submit</button>
    </form>
</div> 
```

**使用 Jquery 进行 AJAX 调用**

```
//function that captures the account number and sends them to the service for processing        
    function goResetValidate() {

        // check that all answers are numbers only on challenge questions
        var ruleset = {
                    required: true,
                    digits: true
                    };
        $('#pwreset').validate({
            rules: {
                qSet0: ruleset,
                qSet1: ruleset,
                qSet2: ruleset
                    }
         });

        // challenge questions for password reset
        var qSet0 = ["Please enter the numeral of the month you were born (i.e. January = 1, February = 2)", "Please enter the last 4 digits of your Social Security number (i.e. 444-55-XXXX)", "Please enter your home zip code - first five digits only (i.e. 22333)."];
        var qSet1 = ["Please enter the day of the month you were born (i.e. 1, 2, 3, etc.).", "Please enter the 2 middle digits of your Social Security number (i.e. 444-XX-6666).", "Please enter the last 4 digits of your home telephone number (i.e. 703-555-XXXX)."];
        var qSet2 = ["Please enter the first 3 digits of your Social Security number (i.e. XXX-55-6666).", "Please enter the 3 middle digits of your home telephone (i.e. 703-XXX-5555).", "Please enter your home zip code - first five digits only (i.e. 22333)."];
        // rand for choice of questions
        var random = (Math.ceil(Math.random() * 3) - 1);
        var jRequest = {};
        var acnum = $("#acctNumber").val();
        jRequest.an = acnum;

        var jData = {};
        jData.request = jRequest;

        $.ajax({
            cache: false,
            type: "POST",
            async: false,
            url: ResetValidateUrl,
            data: JSON.stringify(jData),
            contentType: "application/json; charset=utf-8",
            dataType: "json",
            success: function (splashObj) {
                switch (splashObj.ResetValidateResult.RESPONSE) {
                    case "VALID":
                        var challengequestiondisplayed = splashObj.ResetValidateResult.RESPONSE;
                        var quest = "qSet" + random;
                        // remove reset form
                        $('#resetpanel').fadeOut("slow", function () {
                            $('#resetpanel').remove();
                            $('#acctNumber2').val(acnum);
                            $('#setNum').val(random);
                        });
                        $.each(eval(quest), function (index, item) {
                            $('#Q' + index).text("" + this + "");
                        });
                        $('form#challenge').fadeToggle("slow", "linear");
                        break;
                    // bad member number              
                    case "INVALID":
                        alert("We're sorry; the system did not recognize the Member Number entered. Please try again.");
                        break;
                    // no email on file       
                    case "NO_EMAIL":
                        alert("This feature requires a valid email in the system.  Please contact us to provide a valid email address.");
                        break;
                    // error       
                    case "ERROR":
                        alert("We're sorry; the system was uanble to complete your request. We apologize for the inconvenience.");
                        break;
                    // system is in memo-post mode       
                    case "MEMO_POST":
                        alert("The system is unavailable at this time.  Please try your request again later.");
                        break;
                }
            },
            error: function (xhr) {
                alert("A Password Web Service Error!");
                //$(this).dialog('destroy').remove();
            }
        });
    } 
```

//捕获帐号/qeustins 设置号码/答案并将它们发送到服务进行处理的
函数 function goResetPassword() {

```
 var jRequest = {};
        jRequest.an = $("#acctNumber2").val();
        jRequest.setNumber = $("#setNum").val();
        jRequest.answer1 = $("#answer1").val();
        jRequest.answer2 = $("#answer2").val();
        jRequest.answer3 = $("#answer3").val();

        var jData = {};
        jData.request = jRequest;

        $.ajax({
            cache: false,
            type: "POST",
            async: false,
            url: ResetPasswordUrl,
            data: JSON.stringify(jData),
            contentType: "application/json; charset=utf-8",
            dataType: "json",
            success: function (splashObj) {
                switch (splashObj.ResetPasswordResult.RESPONSE) {
                    // error       
                    case "ERROR":
                        alert("We're sorry; the system was uanble to complete your request. We apologize for the inconvenience.");
                        break;
                    // system is in memo-post mode       
                    case "MEMO_POST":
                        alert("The system is unavailable at this time.  Please try your request again later.");
                        break;
                    case "INVALID_RESPONSE":
                        alert("We're sorry; we are unable to validate your status as the NetBranch account holder based upon your answers to the security questions. Note: The information requested is based upon member data currently on file with Apple FCU. If you continue to encounter difficulties with the security questions, please contact.");
                        break;
                    case "PERM_FROZEN":
                        alert("We're sorry; For security reasons, your online account access has been disabled. We apologize for the inconvenience.");
                        break;
                    case "FROZE_NOW":
                        alert("We're sorry; we are unable to validate your status as the NetBranch account holder. For security purposes, your account has been locked. We apologize for the inconvenience. To restore access, please contact ");
                        break;
                    case "SUCCESS":
                        alert("A temporary password has been sent to the email we have on file.");
                        break;
                }
                return false;
                $(this).dialog('close');
            },
            error: function (xhr) {
                alert("Password Web Service Error!");
                $.dialog('close').remove;
            }
        });
    } 
```

**模态窗口 Jquery**

```
$(document).ready(function () {
    $(".openDialog").live("click", function (e) {
        e.preventDefault();
        $("<div></div>")
                .addClass("dialog")
                .attr("id", $(this).attr("data-dialog-id"))
                .appendTo("body")
                .dialog({
                    title: $(this).attr("data-dialog-title"),
                    close: function () { $(this).dialog('destroy'); },
                    modal: true,
                    width: '530px'
                })
                .load(this.href);
    });

    $(".close").live("click", function (e) {
        e.preventDefault();
        $(this).closest(".dialog").dialog("close");
    });
}); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-11T21:34:20.597

听着，我不明白你的问题，但我仍然会尝试解决你的问题，

```
$("#my-form-div").dialog({
  autoOpen: true,
  width: 600,
  height: 600,
  modal: true,
  draggable:true,
  resizable:false,
  title: 'FORM',
  buttons: [
       {
            text: "CLOSE",
            className: 'close-button-class',
            click: function() {
                // do what ever you want on the close event
                $(this).dialog("close");
                location.reload();
            }
        }
    ],
  open: function() {
    //do whatever you want on the open event.
    $("#my-form-div").html("<%= escape_javascript(render('form_view')) %>");
    }
}); 
```

请更清楚你想要什么。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-13T12:54:11.740

啊啊啊找到了。我需要在表单上放置一个 POST 方法以防止它默认。我想即使我只是关闭对话框，表单也会作为默认 GET 提交。

# php - 查询在 PgAdmin 中有效，但在 CakePHP 中无效

> ID：15349030
> 
> 赞同：1
> 
> 时间：2013-03-11T21:30:13.827
> 
> 标签：php, cakephp, timeout

我有这个查询（PostgreSQL）：[https ://gist.github.com/patrickmaciel/74c72cdf1984bdcde804](https://gist.github.com/patrickmaciel/74c72cdf1984bdcde804)

它适用于 PgAdmin、EMS 客户端、Navicat、Postgres 命令行等。我在 2 个版本的 Postgres 数据库中测试了这个查询：

*   8.2：19秒
*   9.2：16毫秒

但在 CakePHP 中不起作用`$this->query($sql);`：*2013-03-11 17:59:48 错误：[FatalErrorException] 超过 30 秒的最大执行时间*。

**CakePHP 是否以不同的方式执行/运行此查询？**

```
#8 ...........................\app\Controller\Component\CommonCheckComponent.php(64): CommonCheckComponent->validateCheckPromotion(Array, Array, NULL)
#9 ...........................\app\Controller\Component\CommonCheckComponent.php(40): CommonCheckComponent->applyCheckPromotion(Array, Array)
#10 ...........................\app\Controller\Component\CommonTableComponent.php(56): CommonCheckComponent->insertDefaultPromotions(Array)
#11 ...........................\app\Controller\ChecksController.php(42): CommonTableComponent->putTableInCheck(Array, '374')
#12 [internal function]: ChecksController->printCheck('28')
#13 ...........................\lib\Cake\Controller\Controller.php(486): ReflectionMethod->invokeArgs(Object(ChecksController), Array)
#14 ...........................\lib\Cake\Routing\Dispatcher.php(187): Controller->invokeAction(Object(CakeRequest))
#15 ...........................\lib\Cake\Routing\Dispatcher.php(162): Dispatcher->_invoke(Object(ChecksController), Object(CakeRequest), Object(CakeResponse))
#16 ...........................\app\webroot\index.php(109): Dispatcher->dispatch(Object(CakeRequest), Object(CakeResponse))
#17 {main}
2013-03-11 17:59:48 Error: Fatal Error (1): Maximum execution time of 30 seconds exceeded in [...........................\lib\Cake\Model\Datasource\DboSource.ph
p, line 460]
2013-03-11 17:59:48 Error: [FatalErrorException] Maximum execution time of 30 seconds exceeded
Request URL: /patrick/chima-rms/chimarms/checks/printCheck/28
Stack Trace:
#0 ...........................\lib\Cake\Error\ErrorHandler.php(184): ErrorHandler::handleFatalError(1, 'Maximum executi...', 'C:\www\patrick\...', 460)
#1 [internal function]: ErrorHandler::handleError(1, 'Maximum executi...', 'C:\www\patrick\...', 460, Array)
#2 ...........................\lib\Cake\Core\App.php(927): call_user_func('ErrorHandler::h...', 1, 'Maximum executi...', 'C:\www\patrick\...', 460, Array)
#3 ...........................\lib\Cake\Core\App.php(900): App::_checkFatalError()
#4 [internal function]: App::shutdown()
#5 {main}
2013-03-11 17:59:49 Error: Fatal Error (1): Maximum execution time of 30 seconds exceeded in [...........................\lib\Cake\Model\Datasource\CakeSession.
php, line 616]
2013-03-11 17:59:49 Error: [FatalErrorException] Maximum execution time of 30 seconds exceeded
Request URL: /patrick/chima-rms/chimarms/checks/printCheck/28
Stack Trace:
#0 ...........................\lib\Cake\Error\ErrorHandler.php(184): ErrorHandler::handleFatalError(1, 'Maximum executi...', 'C:\www\patrick\...', 616)
#1 [internal function]: ErrorHandler::handleError(1, 'Maximum executi...', 'C:\www\patrick\...', 616, Array)
#2 ...........................\lib\Cake\Core\App.php(927): call_user_func('ErrorHandler::h...', 1, 'Maximum executi...', 'C:\www\patrick\...', 616, Array)
#3 ...........................\lib\Cake\Core\App.php(900): App::_checkFatalError()
#4 [internal function]: App::shutdown()
#5 {main}
2013-03-11 18:00:11 Error: Fatal Error (1): Maximum execution time of 30 seconds exceeded in [...........................\lib\Cake\Utility\Debugger.php, line 47
3]
2013-03-11 18:00:11 Error: [FatalErrorException] Maximum execution time of 30 seconds exceeded
Request URL: /patrick/chima-rms/chimarms/checks/printCheck/28
Stack Trace:
#0 ...........................\lib\Cake\Error\ErrorHandler.php(184): ErrorHandler::handleFatalError(1, 'Maximum executi...', 'C:\www\patrick\...', 473)
#1 [internal function]: ErrorHandler::handleError(1, 'Maximum executi...', 'C:\www\patrick\...', 473, Array)
#2 ...........................\lib\Cake\Core\App.php(927): call_user_func('ErrorHandler::h...', 1, 'Maximum executi...', 'C:\www\patrick\...', 473, Array)
#3 ...........................\lib\Cake\Core\App.php(900): App::_checkFatalError()
#4 [internal function]: App::shutdown()
#5 {main} 
```

为什么？

* * *

我在用着：

*   CakePHP 2.3.0
*   PostgreSQL 9.2
*   PHP 5.3.9
*   阿帕奇 2.2
*   视窗 7 x64

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-08-10T07:42:31.877

默认情况下，PHP 脚本的最大执行时间为 30 秒。运行这条 SQL 时，返回和处理数据的时间大于 30 秒。您需要增加最大执行时间或优化您的查询。尝试 set_time_limit(0); 在脚本的顶部。

# image - AWS IAM 用户对 S3 的访问

> ID：15349031
> 
> 赞同：1
> 
> 时间：2013-03-11T21:30:13.960
> 
> 标签：image, permissions, amazon-web-services, amazon-s3, amazon-iam

我创建了一个 IAM 用户并将其完全控制（操作 *）授予特定存储桶。

**用户需要能够在此存储桶中放置图像、删除图像和创建子文件夹（我认为这可能是 put 的一部分）。**

现在我想限制此 IAM 用户帐户的访问量，并想问是否有人知道如果我需要上述操作，我应该将其限制在什么范围内？

我需要采取什么行动？

*   s3:putObject
*   s3：删除对象

我需要采取任何其他措施吗？我一直在试图破译这个 AWS 页面：[http ://docs.aws.amazon.com/AmazonS3/latest/dev/UsingIAMPolicies.html](http://docs.aws.amazon.com/AmazonS3/latest/dev/UsingIAMPolicies.html)

谢谢你

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-12T01:34:32.783

您所做的只是创建和删除 S3 对象，因此您只需要这两个权限。但是，某些语言 API 会执行额外的操作，因此需要更多权限。例如，您可能需要添加列表权限才能使您的 API 正常工作。您应该尝试使用小程序对其进行测试。

顺便说一句，您实际上并没有创建文件夹。如果您在名称中放置一个带有斜杠的对象，那么您将隐式创建所有中间“文件夹”（实际上并不存在，但就像它们一样）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2019-02-11T18:27:47.450

目前，在为 s3 存储桶创建读/写访问权限时，我们执行以下策略

```
 "Sid": "S3Write",
  "Effect": "Allow",
  "Action": [
    "s3:AbortMultipartUpload",
    "s3:DeleteObject",
    "s3:Get*",
    "s3:List*",
    "s3:PutObject*" 
```

用于读取访问

```
 "Sid": "S3ReadAccess",
  "Effect": "Allow",
  "Action": [
    "s3:Get*",
    "s3:List*"
  ] 
```

希望这可以帮助。

# entity-framework - Ninject WebAPI 操作无法完成，因为 DbContext 已被释放

> ID：15349033
> 
> 赞同：10
> 
> 时间：2013-03-11T21:30:21.320
> 
> 标签：entity-framework, asp.net-web-api, repository, ninject

因此，由于我使用的是 NuGet 中的包，因此我使用了[此处](https://github.com/ninject/Ninject.Web.WebApi/wiki/Conditional-bindings-for-filters)推荐的带有属性和过滤器的简单存储库模式。`Ninject.Web.WebApi-RC`

这适用于第一个请求，但由于我有我`DbContext`的请求范围，它被处理在所有后续请求中。

这是我的属性：

```
public class CommunicationKeyValidationAttribute : FilterAttribute
{
} 
```

这是我的过滤器：

```
public class CommunicationKeyValidationFilter : AbstractActionFilter
{
    public CommunicationKeyValidationFilter(IRepository repository)
    {
        this.repository = repository;
    }
    public override void OnActionExecuting(HttpActionContext actionContext)
    {
        // do stuff
    }
 } 
```

这是我的存储库：

```
public class Repository : IRepository
{
    public Repository(MyDbContext dbContext)
    {
        this.dbContext = dbContext;
    }
} 
```

这是我的 Ninject 绑定：

```
this.Kernel.Bind<MyDbContext>().ToSelf().InRequestScope();
this.Kernel.Bind<IRepository>().To<Repository>().InRequestScope();
this.Kernel.BindHttpFilter<CommunicationKeyValidationFilter>(FilterScope.Action)
        .WhenActionMethodHas<CommunicationKeyValidationAttribute>()
        .InRequestScope(); 
```

我的控制器如下所示：

```
public class HomeController 
{
    [CommunicationKeyValidation]
    public ActionResult Index()
    {
        // do stuff
    } 
```

这里的问题`CommunicationKeyValidationFilter`是仅在第一个请求时调用构造函数。有没有一种方法可以让 ninject 每次尝试解析过滤器时都构造这个过滤器？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2013-03-15T15:46:55.287

过滤器由 WebApi 缓存。它们应该在瞬态范围内，以便 WebApi 可以管理生命周期。由于生命周期长，您不能拥有任何生命周期较短的依赖项。

不过，您可以做的是在执行过滤器期间创建您的存储库。为此，最好使用以下方法注入工厂`NinjectFactoryExtension`：

```
public class CommunicationKeyValidationFilter : AbstractActionFilter
{
    public CommunicationKeyValidationFilter(IRepositoryFactory repositoryFactory)
    {
        this.repositoryFactory = repositoryFactory;
    }

    public override void OnActionExecuting(HttpActionContext actionContext)
    {
        var repository = this.repositoryFactory.CreateRepository();
    }
 }

 public interface IRepositoryFactory { IRepository CreateRepository(); }
 kernel.Bind<IRepositoryFactory>().ToFactory(); 
```

# xml - 在 PowerShell 中按属性对 XML 元素进行分组的简单方法

> ID：15349034
> 
> 赞同：1
> 
> 时间：2013-03-11T21:30:21.667
> 
> 标签：xml, powershell, xpath

我有一个在 PowerShell 中解析的简单 XML 文档，需要按属性值对元素进行分组。下面是 XML 的结构：

```
<Root>
  <Items>
     <Item Input="Foo1" Output="Bin/A" />
     <Item Input="Foo2" Output="Bin/A" />
     <Item Input="Foo3" Output="Bin/B" />
     <Item Input="Foo4" Output="Bin/C" />
     <Item Input="Foo5" Output="Bin/A" />
  </Items>
</Root> 
```

由于不值得讨论的原因，我无法重新格式化 XML，因此制作输出标签和将项目作为子项等建议无效。

我想要结束的本质上是一个字典，它将每个唯一的输出字符串映射到一个节点列表，这些节点的输出属性具有该字符串。

我可以通过迭代元素、在看到新的输出值时创建字典并在一个大循环中填充列表来手动执行此操作，但我很好奇：是否有更优雅的方式使用 PowerShell 查询语法或 XPath 魔法来创建这本词典？我最近一直在使用 PowerShell 查询语法，发现它有很多功能；这个任务在那个范围内吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-11T21:50:08.483

像这样的东西应该适合你：

```
$xml = [xml] @'
<Root>
  <Items>
     <Item Input="Foo1" Output="Bin/A" />
     <Item Input="Foo2" Output="Bin/A" />
     <Item Input="Foo3" Output="Bin/B" />
     <Item Input="Foo4" Output="Bin/C" />
     <Item Input="Foo5" Output="Bin/A" />
  </Items>
</Root>
'@

$grouped = $xml.Root.Items.Item | Group Output
$grouped 
```

给出：

```
Count Name                      Group
----- ----                      -----
    3 Bin/A                     {Item, Item, Item}
    1 Bin/B                     {Item}
    1 Bin/C                     {Item} 
```

# javascript - 许多内容可编辑的元素

> ID：15349035
> 
> 赞同：0
> 
> 时间：2013-03-11T21:30:23.693
> 
> 标签：javascript, jquery, html, jquery-selectors, contenteditable

我有一个看起来像这样的表：

```
<table id="guests" class="table table-striped table-bordered">
  <tbody>
    <tr>
      <td id="guest1Name">John</td>
      <td id="guest1Relationship">Family</td>
      <td id="guest1NumberInParty">1</td>
      <td id="guest1InvitationSent">No</td>
    </tr>
    <tr>
      <td id="guest2Name">Joe</td>
      <td id="guest2Relationship">Family</td>
      <td id="guest2NumberInParty">1</td>
      <td id="guest2InvitationSent">No</td>
    </tr>
  </tbody>
</table> 
```

这个表很快就会有超过 100 行。我想要做的是给每个`<td>`contenteditable 属性并使用 JavaScript/jQuery 观察每个属性的更改，以便当一个元素完成编辑时，可以使用 AJAX**将一个元素**的新数据发送到数据库（AJAX 和服务器-side 部分已经完成）。我想使用一个`onblur`事件或类似的东西来做到这一点，但我不知道如何观察所有这些元素（100 行 x 4 个元素每个 = 400+ 个元素）的焦点/模糊，并能够确定哪个元素改变。如果我使用 jQuery`attributeStartsWith`选择器将它们全部选中，我可以观看所有这些，但是当其中一个失去焦点时，我怎么知道它是哪一个？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-11T21:37:27.460

做这样的事情。首先为您的可编辑 TD 分配一个类，以便更容易选择。可以说类=“可编辑”。

```
$(document).ready(function(){
    $('.editable').blur(function(e){
        //to get something from the li that was just blurred use this
        //something like - 
        var value = $(this).text();
        //Ajax call 
    });
}); 
```

在事件函数中使用 this 关键字将允许您定位触发事件的元素。

# asp.net-mvc-4 - signalr 连接 ID 格式不正确

> ID：15349043
> 
> 赞同：1
> 
> 时间：2013-03-11T21:30:44.147
> 
> 标签：asp.net-mvc-4, signalr

我有一个从 mvc4 c# razor 引擎构建的项目。我添加了最新的 signalr nuget 包 1.0.1 我的项目使用表单身份验证。每次客户端从登录到注销时，反之亦然，我在客户端上收到一个错误：

```
> "NetworkError: 500 Internal Server Error -
> http://myhost:51090/signalr/abort?transport=serverSentEvents&connectionToken=uIJvYLP3T0GdHaowIlS4uPDA19ukUy7TaW8dcXoPfma4Mr52uoe7PLK9Hh3ip17X_3RbFXx92yEa7nxYVHaCiRAWVE5e05vvpLD0_blb94eUwdkXbmhkRPM2_Z590A64VBF2-eLB_8wCWq-dmkkkbe6EqP6c9YXN3WRF5IyNYkB6Wkom7O1ZoDavQQ0UWvok0" 
```

在服务器端：

```
 The connection id is in the incorrect format. 
```

我是否需要考虑以不同的方式（来自[https://github.com/SignalR/SignalR/wiki/QuickStart-Hubs](https://github.com/SignalR/SignalR/wiki/QuickStart-Hubs)）使用信号器，然后使用身份验证？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-11T22:23:03.783

当您有一个活动的 SignalR 连接时，您似乎正在注销（修改您的用户）。

发生这种情况的原因是因为在服务器上的中止请求中，我们检查 connectionId 是否与正确的用户相关联。因此，在连接仍处于活动状态时注销会导致您失去用户关联并导致错误。

要解决此问题，请在注销之前停止 SignalR 连接。

# c - 文本板 GCC 编译 C

> ID：15349044
> 
> 赞同：2
> 
> 时间：2013-03-11T21:30:50.623
> 
> 标签：c, gcc, textpad

我正在尝试使用我已安装的 MinGW 包中的 gcc.exe 在 C 中编译我的程序。我已将 gcc 添加为外部工具，并且能够通过 TextPad 运行它。但是，我收到一般错误消息，例如“工具已完成，退出代码为 1”。有没有办法像在命令提示符 unix 环境中一样配置 TextPad/gcc 以显示正确的错误消息？

# html - td文本太长时html css表格宽度变大

> ID：15349047
> 
> 赞同：0
> 
> 时间：2013-03-11T21:31:17.107
> 
> 标签：html, css, html-table

抱歉，可能有很多代码，但是为什么我将表格设置为固定大小，但是当我的内容太长时，它不适合它的 td 宽度，但是它正在将表格大小从 810px 增加到更长的时间......问题？怎么了？

```
<table cellpadding="0" cellspasing="0" class="sortable zebra tablesorter tablesorter-default" id="articles-table">
... 
```

[http://jsfiddle.net/FN5Sn/](http://jsfiddle.net/FN5Sn/)

现在看起来像这样（而且 mu 也是如此）：

![在此处输入图像描述](../Images/fa8837560e2dad11617d15fe6ea021c6.png)

这是我更改某些列内容时的样子（所以表格不是 810px 并且在可见区域上增加）

![在此处输入图像描述](../Images/ee3364c18b0529a9e6ea4dd38e8c52cf.png)

但我必须设置，该表是固定大小的，例如，如果表太长，第三列的大小会变小.... 怎么做？

注意：第二列必须是 nowrap .... 所有其他列都可以是自动宽度

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-11T21:35:49.940

您需要从有问题的 TD 中删除它：

```
white-space:nowrap; 
```

以下是如何使用鼠标悬停效果来显示不适合 TD 的隐藏文本：

HTML：

```
<table width="100" border="1">
   <tr>
       <td>
           <div class="long">123 456 790-1122-4455</div>
       </td>
            <td>
           Other Data
       </td>
    </tr>
</table> 
```

CSS：

```
td {
  white-space:nowrap; 
  min-height:25px;
  position:relative;
  width:90px  
}

.long {
    overflow-x:hidden;
    width:90px;
}   

.long:hover {
   position:absolute;
   z-index:10; 
   top:0;
   left:0;
   width:200px;
   background-color:#c0c0c0;
   border:1px solid #000000; 
   overflow-x:visible 
} 
```

# android - ListView 自下而上

> ID：15349049
> 
> 赞同：0
> 
> 时间：2013-03-11T21:31:20.783
> 
> 标签：android, listview

我怎样才能让我的列表视图循环，就像当用户到达底部时它基本上只是重新加载顶部值并使其成为一个无限循环？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-11T21:53:19.630

我对您的适配器的思考过程是：

1.  覆盖`getCount()`并返回`MAX_INT`
2.  对于`getItem()`，返回您的项目`position % actualCount`（即，如果您使用一个调用`items`支持数据的列表，返回`items.get(pos % items.size())`）。
3.  在`getView()`中，确保您始终使用`getItem()`而不是直接访问支持数据来访问数据（例如，不要访问`items.get(pos)`，因为您必须再次根据列表的长度进行修改）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-11T21:39:04.433

这只是我的想法，但我认为你可以做的大致是，类似于检测无限滚动中的结束，当你在底部时，将你的 ArrayList 附加到它本身，然后调用一个更新，比如 notifyDataSetChanged on适配器？

# cakephp - CakePHP 访问二级关联数据

> ID：15349054
> 
> 赞同：1
> 
> 时间：2013-03-11T21:31:38.243
> 
> 标签：cakephp, associations

我有属于一个**Category的****Transactions**并且可以有一个**Fuelup**。**Fuelup** 属于**Car**和**Transaction**：_

 ******```
class Transaction extends AppModel {
    public $belongsTo = array('Category');
    public $hasOne = array('Fuelup');
}

class Fuelup extends AppModel {
    public $belongsTo = array('Transaction','Car');
}

class Car extends AppModel {
        public $hasMany = array('FuelUp');
}

class Category extends AppModel {
    public $hasMany = "Transaction";
} 
```

我的表格如下所示：

```
transactions id|category_id|description
categories   id|name
cars         id|name|numberplate
fuelups      transaction_id|car_id|amount|mileage 
```

在事务的索引函数中，我想索引所有事务并显示（如果存在）Fuelup：

```
public function index() {
     $this->set('transactions', $this->Transaction->find('all'));
} 
```

如何在此视图中访问汽车的名称？我可以毫无问题地使用 $transaction['Fuelup']['car_id'] ，但无法访问 $transaction['Fuelup']['Car'] 等。

我正在运行最新版本的 CakePHP 2.3.1。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-11T21:57:35.477

与其使用 Hugo 指定的递归，不如研究[Containable](http://book.cakephp.org/2.0/en/core-libraries/behaviors/containable.html)行为。你`AppModel`像这样附加它：

```
class AppModel extends Model {
    public $recursive = -1; // disable recursive

    public $actsAs = array('Containable');
} 
```

然后，当您进行查找时，您可以这样做：

```
class AppModel extends Model {
    $transactions = $this->Transaction->find('all', array(
        'contain' => array(
            'Fuelup' => array(
                'Car'
            )
        )
    ));
    $this->set('transactions', $transactions);
} 
```

可包含的效率更高，因为它只获取您指定的数据，而递归将带回您不需要的数据，浪费资源。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-11T21:36:30.227

您必须设置递归级别。你可以做 ：

```
$this->find('all',array('recursive' => 2)); 
```

> recursive 属性定义了 CakePHP 通过 find() 和 read() 方法获取关联模型数据的深度。

请参阅《烹饪书》中的[此条目](http://book.cakephp.org/2.0/fr/models/model-attributes.html#recursive)。******

# r - 按时间对数据帧进行子采样，保持第二个值的顶部

> ID：15349056
> 
> 赞同：2
> 
> 时间：2013-03-11T21:31:45.313
> 
> 标签：r, dataframe, sample, posixct

我有一个包含小数秒时间戳的数据框。每秒有不止一行，我想过滤到一行。我想在每秒的顶部或之前提取值。

以下是数据示例：

```
 > head(sg1, 13)
                      time  count
1  2013-02-25 15:55:35.941      0
2  2013-02-25 15:55:36.042   8263
3  2013-02-25 15:55:36.144 147536
4  2013-02-25 15:55:36.243 165041
5  2013-02-25 15:55:36.342 126064
6  2013-02-25 15:55:36.441 100275
7  2013-02-25 15:55:36.542 101944
8  2013-02-25 15:55:36.647 108880
9  2013-02-25 15:55:36.742  86690
10 2013-02-25 15:55:36.842  74476
11 2013-02-25 15:55:36.941  76285
12 2013-02-25 15:55:37.042  79145
13 2013-02-25 15:55:37.141  84434 
```

其中，我想选择第 1 行和第 11 行。

```
> dput(head(sg1, 13))
structure(list(time = structure(c(1361807735.942, 1361807736.042, 
1361807736.145, 1361807736.244, 1361807736.343, 1361807736.442, 
1361807736.542, 1361807736.647, 1361807736.742, 1361807736.842, 
1361807736.942, 1361807737.042, 1361807737.142), class = c("POSIXct", 
"POSIXt"), tzone = "GMT"), count = c(0L, 8263L, 147536L, 165041L, 
126064L, 100275L, 101944L, 108880L, 86690L, 74476L, 76285L, 79145L, 
84434L)), .Names = c("time", "count"), row.names = c(NA, 13L), class = "data.frame") 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-11T22:01:42.670

困难的部分是你想要

> 每秒顶部或之前的值。

因此，将时间四舍五入并取最大的一个并不完全有效，因为如果第二个顶部有一个，它就会被放入错误的组中。这种方法可以正确处理这种情况。

```
library("lubridate")
library("plyr")
ddply(sg1, .(ceiling_date(time, unit="second")), function(DF) {
  DF[which.max(DF$time - ceiling_date(DF$time)),]
})[,-1] 
```

这使

```
 time count
1 2013-02-25 15:55:35     0
2 2013-02-25 15:55:36 76285
3 2013-02-25 15:55:37 84434 
```

并且为了证明这适用于第二轮，在数据集中添加一个。

```
sg2 <- rbind(sg1, 
structure(list(time=structure(1361807737, class=c("POSIXct", "POSIXt"), 
tzone="GMT"), count=c(34567L)), .Names = c("time", "count"), row.names=c(NA,1L),
class="data.frame"))
sg2 <- sg2[order(sg2$time),]

ddply(sg2, .(ceiling_date(time, unit="second")), function(DF) {
  DF[which.max(DF$time - ceiling_date(DF$time)),]
})[,-1] 
```

现在返回“前一个”第二个的新行。

```
 time count
1 2013-02-25 15:55:35     0
2 2013-02-25 15:55:37 34567
3 2013-02-25 15:55:37 84434 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-11T21:59:11.693

```
tapply(rownames(sg1), format(sg1$time, "%Y-%m-%d %M:%S"), tail, 1)
2013-02-25 55:35 2013-02-25 55:36 2013-02-25 55:37 
             "1"             "11"             "13" 
```

我怀疑我需要向你解释这一点，马修。如果你想要数字类，你可以使用`1:nrow(sg1)`而不是行名。（哦，发帖后我看到你记得了`tail`。）

由于您现在似乎想要整个行，因此您将其用作 sg1 的索引：

```
> sg1[ tapply(rownames(sg1), format(sg1$time, "%Y-%m-%d %M:%S"), tail, 1) , ]
                  time count
1  2013-02-25 15:55:35     0
11 2013-02-25 15:55:36 76285
13 2013-02-25 15:55:37 84434 
```

...或者可以 rbind 拆分的 dfrms：

```
> do.call(rbind, lapply(split(sg1, format(sg1$time, "%Y-%m-%d %M:%S")), tail, 1) )
                                time count
2013-02-25 55:35 2013-02-25 15:55:35     0
2013-02-25 55:36 2013-02-25 15:55:36 76285
2013-02-25 55:37 2013-02-25 15:55:37 84434 
```

...可以说是更“标准的 R”。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-11T21:41:10.570

那里有一个额外的行，因为这只是`max(time)`在每秒内抓取，但是：

```
library(lubridate)
df$second = floor(second(df$time))

library(plyr)
top_seconds = ddply(
  df,
  .(second),
  function(df_part) {
    return(df_part[df_part$time == max(df_part$time), ])
  }) 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-03-11T21:55:02.430

这是一个基本的 R 解决方案：

```
do.call(rbind, by(data = sg1, 
                  INDICES = as.numeric(sg1$time) %/% 1,
                  FUN = function(X) {
                      X[which.max(as.numeric(X$time) %% 1), ]
                  }))
#                                      time count
# 2013-02-25-:55:35 2013-02-25 15:55:35.941     0
# 2013-02-25-:55:36 2013-02-25 15:55:36.941 76285
# 2013-02-25-:55:37 2013-02-25 15:55:37.141 84434 
```

* * *

如果正如 Brian Diggs 推测的那样，您想在同一秒内包含 15:55:36.941 和 15:55:37.000，如果它们都存在则保留后者，试试这个：

```
do.call(rbind, by(data = sg2, 
                  INDICES = ceiling(as.numeric(sg2$time)),
                  FUN = function(X) {
                      X[which.max(as.numeric(X$time) %% -1), ]
                  })) 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-03-11T21:55:33.823

马吕斯给了我我需要的线索。这是base中的解决方案：

```
do.call(rbind, unname(by(sg1, floor(as.numeric(sg1$time)), FUN=tail, 1)))
                      time count
1  2013-02-25 15:55:35.941     0
11 2013-02-25 15:55:36.941 76285
13 2013-02-25 15:55:37.141 84434 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2013-03-12T00:53:36.027

只是另一种`base`解决方案

```
sg1[sg1$time %in% aggregate(sg1$time, 
                            by = list(ceiling(as.numeric(sg1$time))), 
                            FUN = max)$x, ]
##                   time count
## 1  2013-02-25 15:55:35     0
## 11 2013-02-25 15:55:36 76285
## 13 2013-02-25 15:55:37 84434 
```

# jquery - 预先复制

> ID：15349061
> 
> 赞同：1
> 
> 时间：2013-03-11T21:31:59.213
> 
> 标签：jquery, prepend

我的代码找到我检查的 Radio，然后找到下一个元素并将该内容添加到我想要的 div 中。但是，当我检查不同的 Radio 然后返回到前一个 div 时，它会保留前置内容并再次前置。所以我最终在 div 上有重复项。

HTML：

```
<form>
    <input type="radio" name="form" value="informed"/>
    <span>INFORMED CONSENT</span><br />
    <input type="radio" name="form" value="release"/>
    <span>RELEASE OF INFORMATION</span><br />
    <input type="radio" name="form" value="intake"/>
    <span>INTAKE FORM</span><br />
    <input type="radio" name="form" value="checklist"/>
    <span>CHECKLIST OF CONCERNS (CHILD & ADOLESCENT AND ADULT)</span><br />
    <input type="radio" name="form" value="health"/>
    <span>HEALTH INFORMATION PRIVACY FORM</span><br />
</form>

<div id="informed" class="Form">1</div>
<div id="release" class="Form">2</div>
<div id="intake" class="Form">3</div>
<div id="checklist" class="Form">4</div>
<div id="health" class="Form">5</div>
<div id="ContactFormSix" class="Form">6</div> 
```

JS

```
var myForm = new Array("INFORMED CONSENT","RELEASE OF INFORMATION","INTAKE FORM");
$(document).ready(function () {
   $('input').on( 'change', function () {
      //check
      var ValUe = $(this).val();
      $('.Form').hide();
      $('#' + ValUe).show();
      //Find the value of the input that was clicked
      var formVaule = $('input[value="' + ValUe + '"]');
      //Grab the value of the input that was clicked and find the next element and retreive the text
      var k = formVaule.next().text();
      //PrePend the elemnts text   
      $('#' + ValUe).prepend(k);
   })
}); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-11T21:40:18.947

而不是使用`.prepend()`或`.append()`尝试使用`.html()`它将替换目标元素的原始数据。

例如 `$('#' + ValUe).html(k);`

**动画示例**

只是一个例子，可以通过许多其他方式实现。

```
$('#' + ValUe).html(<span style="opacity:0;">k</span>);
$('#' + ValUe span).animate({opacity:1},slow); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-11T21:47:54.213

在添加数据之前，您可以清理 div 然后添加：

```
$('#' + ValUe).empty(k);
$('#' + ValUe).prepend(k); 
```

# database - 如何在 CodeIgniter 中使用带有 HMVC 的迁移？

> ID：15349062
> 
> 赞同：3
> 
> 时间：2013-03-11T21:32:06.770
> 
> 标签：database, codeigniter, migration, hmvc

这可以做还是不做？

因为当您创建经典迁移时，它们是例如 001、002、003 等。

但是当您有多个模块时，您将如何为它们创建迁移。

这在分层 MVC 中是否可能？

如果是，我应该如何给我写迁移？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-11-16T14:17:13.883

您可以使用此模块化扩展将 MVC 迁移到 HMVC

[https://bitbucket.org/wiredesignz/codeigniter-modular-extensions-hmvc](https://bitbucket.org/wiredesignz/codeigniter-modular-extensions-hmvc)

然后只需将您的 MVC 文件放在模块结构中

路由方法会有一些变化，因为它的访问方式如下

`modulename/classname/methodname/paramters`（如果需要）

您也可以将模板引擎更改为 smarty 将易于开发视图

# jquery - 如何删除特定选择上的统一功能？

> ID：15349065
> 
> 赞同：4
> 
> 时间：2013-03-11T21:32:26.227
> 
> 标签：jquery, html, css, jquery-uniform

我正在使用统一的 js 来更改复选框、单选按钮、选择框的背景图像。为此，我包括 jquery 文件、统一库 js 文件，另一件事是统一 js 的函数，用于将函数初始化为

```
$(function(){
   $("input, select, textarea, button").uniform();
}); 
```

**这里我遇到了一个问题，我想在我不想要统一功能**的内容的特定部分清除此功能。**那么我采用什么程序来解决我的问题？**

我没有此代码的 jsfiddle 代码。如果你需要它，我会让你知道。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-03-11T21:36:24.793

只需使用[.not()](http://api.jquery.com/not/)函数并在您希望省略`uniform()`逻辑的项目上设置一个类。

**DOM**：

```
<!-- This gets it -->
<select>
   <option>Foo</option>
</select>

<!-- This doesn't -->
<select class="noUniform">
    <option>Bar</option>
</select> 
```

**JS**：

```
$(function(){
   $("input, select, textarea, button").not('.noUniform').uniform();
}); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2015-09-07T14:56:29.583

`data-no-uniform`设置为`"true"`工作的属性

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2019-09-11T10:49:32.720

根据 Prestashop 1.6.x 已经省略了默认主题中实现的统一：

.\themes\default-bootstrap\js\global.js

使用类`.not_uniform`

> $("select.form-control,input[type='radio'],input[type='checkbox']"). **not(".not_uniform")** .uniform();

# android - ExpandableListView getChildView() 折叠时

> ID：15349070
> 
> 赞同：2
> 
> 时间：2013-03-11T21:32:37.870
> 
> 标签：android, expandablelistview

我有一个正在膨胀的片段`ExpandableListView`。每次扩展组视图时，它被编程为动画子视图从屏幕右侧进入。那部分效果很好。

这是问题所在：

在同一个片段中`OnGroupClickListener`，我创建了一个检查它是否正在扩展或折叠的地方。折叠后，我想访问子视图以将它们设置为动画。如何访问这些子视图？适配器不会调用`getChildView()`折叠...，只有`getGroupView()`.

任何想法将不胜感激。

# php - PHP 打开 URL 和重定向

> ID：15349071
> 
> 赞同：0
> 
> 时间：2013-03-11T21:32:45.203
> 
> 标签：php, javascript, html, shopping-cart

我正在使用一个名为 ImpulsePay 的 SMS 支付系统，但仅安全方法实际上提供了一个 URL。

[安全方法](http://uk.impulsepay.com/10561?URL=Y)

如何实现它，以便给定的 URL 是一个链接，或者更好的是，重定向到支付页面？

最终，我希望原始网站具有“点击此处通过短信付款”，但在这个早期开发阶段，一些页面重定向不应该成为问题。

任何帮助，非常感谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-11T21:36:54.120

这段代码将用户重定向到一个页面： `header('Location: http://www.example.com/');`

但是，必须在发送任何输出之前调用此函数。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-11T21:40:35.267

您可以使用

```
//Redirect browser
header('Location: http://www.example.com/');

//File get contents
$url = 'http://www.example.com/redireccionar.php';
$page = file_get_contents($url);
echo $page;

//cURL
$c = curl_init('http://www.example.com/redireccionar.php');
curl_setopt($c, CURLOPT_RETURNTRANSFER, true);
curl_setopt($c, CURLOPT_FOLLOWLOCATION, true);
$page = curl_exec($c);
curl_close($c);
echo $page;

//http Client
$url = 'http://www.example.com/redireccionar.php';
require_once 'HTTP/Client.php';
$client = new HTTP_Client();
$client->get($url);
$page = $client->currentResponse();
echo $page['body']; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-11T21:41:08.260

查看该 URL，您似乎必须调用您发布的 URL 才能获得付款链接？我会使用 PHP cURL 绑定来获取该 URL 生成的内容。

这里的例子，[http://davidwalsh.name/curl-download](http://davidwalsh.name/curl-download)

然后使用 header() 重定向。

# regex - 提取键值项的正则表达式

> ID：15349072
> 
> 赞同：0
> 
> 时间：2013-03-11T21:33:02.207
> 
> 标签：regex, string, extract

我试图制作一个正则表达式来从字符串中提取 key=value 项。值字符串可能有也可能没有引号和空格（类型字符串或数字）。

字符串如下所示：

```
VAR key = 'value in string mode';
VAR key = 34;
VAR key=3.3;
VAR key='another value without empty spaces between ='; 
```

我想提取键和值。

我正在开发但错了。

```
VAR \@(\w+)\s?\=\s?\'?([\w]+)\'?\; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-11T21:37:39.200

那一个应该做的工作：

```
^VAR ([^ =]+) ?=[ ']*([^']+)'?;$ 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-11T21:38:58.113

问题是它`\w`只会匹配单词字符，所以既不是空格也不是*符号*`=`。试试这个（[演示](http://regexr.com?3438l)）：

```
VAR (\w+)\s?=\s?'?([^']+)'?; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-11T21:53:23.707

这将使用环顾行为获取单引号内的所有数据。

```
(?<=').+?(?=') 
```

这将获得密钥名称。

```
(?<=VAR )[a-zA-Z0-9\. ]+(?=\=) 
```

# c# - ReadToFollowing XML 大文件

> ID：15349077
> 
> 赞同：0
> 
> 时间：2013-03-11T21:33:10.933
> 
> 标签：c#, xml

我有一个 2GB 的 xml 文件，我正在尝试实现 ReadToFollowing 方法，但是它有点时髦。

当我使用它时，我的“if”语句无法正常工作。基本上 xmlReader.ReadInnerXML() 会带回 iVehicle 下的所有节点。我假设它是文档中每个 iVehicle 的所有节点（这可能是我想要的，但我还需要获取子节点，以便我可以填充并返回我的对象​​（对于每个 iVehicle）。

```
 using (FileStream stream = new FileStream(uri, FileMode.Open, FileAccess.Read))
        {
            XmlTextReader xmlReader = new XmlTextReader(stream);

            while (xmlReader.ReadToFollowing("iVehicle"))
            {
                if(xmlReader.NodeType == XmlNodeType.Element && xmlReader.Name.Equals("FamilyName"))
                {
                    fundFamilyId = xmlReader.ReadInnerXml();
                }
                if (xmlReader.NodeType == XmlNodeType.Element && xmlReader.Name.Equals("InvestmentVehicle"))
                {
                    secId = xmlReader.GetAttribute("_Id").ToString();
                }

                if (el.NodeType == XmlNodeType.Element && el.Name == "TradingSymbol")
                {
                    ticker = xmlReader.ReadInnerXml();
                }

                yield return new parsedXML
                {
                    Id = secId,
                    FamilyName = familyName,
                    TickerId = ticker,
                };

            } 
        } 
```

我需要做什么才能完成这项工作？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-11T23:15:40.057

`ReadToFollowing("iVehicle")`将阅读器定位在下一个`<iVehicle>`节点的开头所以假设它成功 Name is iVehicle

要到达`<FamilyName>`您需要阅读/移动到它，然后使用 .Value 或它的味道来获取内容。

将 XmlReader 想象为在 xml 文件中移动一个指针，然后您可以在指针处获取内容。

ReadInnerXml 通常用于挑选一个节点并将其传递给另一个 XmlReader，因此您可以分解您的代码。

# c++ - 无符号长在 C++ 中返回负数

> ID：15349079
> 
> 赞同：0
> 
> 时间：2013-03-11T21:33:17.517
> 
> 标签：c++, negative-number, unsigned-long-long-int

下面当任何 numA-D 乘以无数次时，这个数字突然变成负数。例如，当 numA 乘以 3 乘以 256 时，该数字变为负数，但如果仅乘以 256 两次则不会。该项目的目的是将一个 ip 地址更改为 unsigned long，然后将 unsigned long 更改为 ip 地址。

```
using namespace std;
unsigned long ip2long (string ipv4)
{

// variable to return
unsigned long rtn;
string A,B,C,D;
string delimiter = ".";
size_t position;

/* must parse string by '.' character
and then assign (A,B,C,D) to the values
and return the unsigned long last, you don't have to make
the variables unsigned longs */

int locOfA = ipv4.find('.' );
int locOfB = ipv4.find('.', locOfA + 1);
int locOfC = ipv4.find('.', locOfB + 1);
int locOfD = ipv4.find('.', locOfC + 1);

A =  ipv4.substr(0,locOfA);
B = ipv4.substr(locOfA + 1, locOfB - locOfA - 1);
C = ipv4.substr(locOfB + 1, locOfC - locOfB -1 );
D = ipv4.substr(locOfC + 1, locOfD - locOfC -1);

int numA = atoi(A.c_str());
int numB = atoi(B.c_str());
int numC = atoi(C.c_str());
int numD = atoi(D.c_str());
cout << endl;
cout << numA << endl;
cout << numB << endl;
cout << numC << endl;
cout << numD << endl;

cout << endl;
// assigning a unsigned long to the sum of the algorithm
cout << (numA * 256 * 256) +  << endl;
cout << (256 * 256 * 256 * numB) << endl;
cout << (256 * numC) << endl;
cout << (256 * numD) << endl;

rtn = numD + (256 * numC) + (256 * 256 * numB) + (256 * 256 * 256 * numA);

return rtn;
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-11T21:35:38.263

`unsigned long`是无符号的——它不能是负数。但是你所有的数字，因此你所有的计算，都是`int`s，而不是`unsigned long`s。`int`s 允许为负数。

换句话说，这条线

```
rtn = numD + (256 * numC) + (256 * 256 * numB) + (256 * 256 * 256 * numA); 
```

是相同的

```
rtn = static_cast<unsigned long>(numD + (256 * numC) + (256 * 256 * numB) + (256 * 256 * 256 * numA)); 
```

所有的变量和常量都是`int`，并且它们不会被自动提升为 unsigned long。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-12-23T17:16:13.297

**所有整数类型都有符号**

*   **LONG** - Whitout 无符号总是有符号的 –2,147,483,648 到 2,147,483,647
*   **INT** - Whitout 无符号总是有符号的 –2,147,483,648 到 2,147,483,647
*   **SHORT** - Whitout 未签名总是有符号的 –32,768 到 32,767
*   **FLOAT** - Whitout 无符号总是有符号 3.4E +/- 38（7 位）
*   **DOUBLE** - Whitout 无符号总是有符号 1.7E +/- 308（15 位）

unsigned 中可以存储的最大数字是有符号的两倍。

**例子：**

```
long val = 2147483647; // Signed max value

unsigned long val = 4294967294;  // 2x bigger number can be stored 
```

如果尝试将 4294967294 存储在签名中怎么办？

```
signed long val = 4294967294;  // result will be -2 
```

就像我说的 usigned 中的值可以返回 2 倍更大的数字。这些错误发生在超过的情况下

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-11T21:39:06.320

int 是 32 位的。这意味着它的最大值是 2^31 = 256*256*256*128 - 1。（并且它的下限值是 -2^31）
如果 numA >=128 它将变为负数。
或者如果 numD + (256 * numC) + (256 * 256 * numB) + (256 * 256 * 256 * numA) > 2^31 = 2147483648
你会看到负数。

# javascript - jQuery 不会加载

> ID：15349080
> 
> 赞同：0
> 
> 时间：2013-03-11T21:33:24.257
> 
> 标签：javascript, jquery

我很难让 jQuery 加载。我正在用 notepad++ 编写原型并使用 Coffee Cup 来重建我的旧网站。

在谷歌搜索多个论坛并更正多个项目后，我最终得到了无法加载的好代码。我查看了“当 jQuery 不起作用时要做的 6 件事”。我一开始的脚本标签有`<script type="text/javascript" src="//ajax.googleapis.com/ajax/libs/jquery1.9.1/jquery.min.js">`

这是我迄今为止尝试过的：

*   W3学校
*   就 load() 函数探讨您的论坛问题。
*   在 jsfiddle.net 中设置它。它通过脚本本身，但没有结果。
*   在我的本地计算机上登录我的系统管理员帐户，以防对部署脚本有一些管理禁令。我将尝试本地组策略。
*   检查我的 Norton 360 软件是否有脚本拦截。
*   使用纯 Javascript 编写脚本。有用。
*   检查所有浏览器以确保启用 Javascript。这是。

这是我的代码。jQuery 是一个普通的 css 函数，它将所有 div 边界着色为红色。我正在用 css3 和 html5 编写。我在 doctype 下包含了所有元内容，以防干扰。此外，即使 html5 不需要 text=javascript，Firefox 似乎也需要这个。此外，还有一个开始脚本标签。就是不会显示。

```
 <script (see google source above)>
        $(document).ready(function(){
            $("div").css("border", "3px solid red");
        });
    </script>
</head>
<body>
    <div id="shalom">Shalom</div>
    <div id="wrapper"> 
        <p>"LoremLorem ipsum dolor sit amet, consectetur adipisicing elit, sed do </p>
    </div>
    <div> 
        <p>Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi</p>  
    </div> 
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-03-11T21:36:54.333

[HTML 验证器](http://validator.w3.org/)会告诉您[不能将脚本标签与`src`内容结合起来。](https://stackoverflow.com/q/1056325/139010)将它们分开，如下所示，并[确保脚本标签是属性 closed](https://stackoverflow.com/a/6145117/139010)，并且 jQuery 的 URL 是正确的（你的问题 404s 中的那个）：

```
<script type="text/javascript" src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>

<script>
$(document).ready(function(){
    $("div").css("border", "3px solid red");
});
</script> 
```

此外，请注意，`//`如果您只是打开本地 HTML 文件，则相对于方案的 URL（以 开头的 URL）将不起作用，因为它使用了`file://`方案。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-11T21:35:53.823

您正在使用的 jQuery 库的脚本 src 似乎无效。尝试这个： `<script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>`

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-11T21:36:50.510

您不能将附加代码放在`<script>`具有“src”属性的标签内以加载另一个脚本。您只需要`<script>`在您的代码所在的那个之后再添加一个。

# php - 使用 qTip2 显示 HTML

> ID：15349081
> 
> 赞同：0
> 
> 时间：2013-03-11T21:33:25.077
> 
> 标签：php, jquery, wordpress, qtip2

我通过我网站上的[List Category Posts](http://wordpress.org/extend/plugins/list-category-posts/) WordPress 插件创建了一个带有小（50x50 大小）缩略图的最小化赞助商部分（可以在[这里](http://dacc.fredrixdesign.com/)看到）。此插件仅在您网站的任何位置显示来自某些类别的帖子。

我现在想在悬停图像时添加一个工具提示，它基本上会显示帖子`the_content();`。对于工具提示，我将使用[qTip2](http://craigsworks.com/projects/qtip2/)，因为这似乎是最好的工具提示解决方案。

我的问题发生了，当悬停时没有任何反应。你能发现错误吗？我已经连续三天与这个问题作斗争了。

在查看 HTML 时，认为您无法修改它。代码可以在[JSFIDDLE](http://jsfiddle.net/jv8WN/)上找到（我希望代码有效，但我不确定，因为这是我第一次使用 JSFIDDLE）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-11T22:55:41.027

您遇到的问题是 Qtip 内容的选择器。你有`$(this).next('div:hidden')`，但看起来你的文本实际上是在一个`<p>`标签中。

编辑：刚刚看到关于不编辑 HTML 的部分，你只需要修改你的选择器来选择下一个`<p>`标签。像这样的东西`$(this).parent().next('p')[0].textContent`，[小提琴](http://jsfiddle.net/jv8WN/7/)

编辑 2：理想情况下，我会编辑 HTML 并执行以下操作：

通过[查看 Qtip2 文档](http://craigsworks.com/projects/qtip2/docs/content/)，作者提供了将您想要的文本内容放入目标元素的属性的解决方案。[这](http://jsfiddle.net/jv8WN/3/)是一个证明这一点的小提琴。

相关的 HTML：

```
 <a href="http://dacc.fredrixdesign.com/global-imports-bmw-2/"><img width="50" height="50" src="http://dacc.fredrixdesign.com/wp-content/uploads/bmw-150x150.jpg" class="attachment-50x50 wp-post-image" alt="DACC Sponsor" qtip-content="Hello, I'm text!"/></a> 
```

qTip 代码：

```
 $('.lcp_catlist a img').each(function () {
      $(this).qtip({
           content: $(this).next('div:hidden')
      });
  }); 
```

# asp.net-mvc-3 - MVC3 razor helper 方法使用 mailto 传递变量显示电子邮件地址

> ID：15349085
> 
> 赞同：0
> 
> 时间：2013-03-11T21:33:32.473
> 
> 标签：asp.net-mvc-3

我正在尝试获取一个 mailto 链接以显示人名而不是实际的电子邮件地址。

在我的`details.cshtml`文件中，我将页面强输入到我的供应商

```
@model TheWorkshop.Web.Models.Supplier 
```

但是虽然我可以使用

```
@Html.DisplayFor(model => model.Email) 
```

显示与 mailto 相同的文本值的 mailto 链接，例如

> <a href="mailto: me@blah.com">me@blah.com</a>

我想要的是显示此人的姓名。所以在寻找之后我决定尝试制作一个 Helper 方法

```
public static MvcHtmlString PrettyEmailAddress(this HtmlHelper htmlHelper, 
                                               string email, string name)
{
    var mailToLink = new TagBuilder("a");
    mailToLink.Attributes.Add("mailto", email);
    mailToLink.SetInnerText(name);

    return MvcHtmlString.Create(mailToLink.ToString());
} 
```

但问题是当我尝试在绑定中调用它时：

```
 @Html.PrettyEmailAddress(@model.Email, @model.Name)) 
```

我收到编译错误

> CS0103：当前上下文中不存在名称“模型”

如果我传递字符串而不是`@model.Email`and '@model.Name` 那么助手工作正常，但我如何将变量传递给助手？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-11T21:34:44.233

尝试像这样调用你的助手：

```
@Html.PrettyEmailAddress(Model.Email, Model.Name) 
```

注意事项：

*   首都`M`
*   无需使用`@`，因为您已经在服务器上

你也可能想更换：

```
mailToLink.Attributes.Add("mailto", email); 
```

和：

```
mailToLink.Attributes.Add("href", string.Format("mailto: {0}", email)); 
```

以达到预期的效果。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-01-10T22:20:28.803

试试这个：

```
<a href="mailto:@Model.Email">@Html.ValueFor(model=>model.Email)</a> 
```

# android - Android：我应该如何处理数据库访问异常？

> ID：15349088
> 
> 赞同：5
> 
> 时间：2013-03-11T21:33:44.310
> 
> 标签：android, database, exception-handling

我的问题是关于数据库异常处理的良好做法。

假设我有一个在数据库中存储一些数据的应用程序。实现了以下层：

1.  DatabaseAdapter - 处理 SQL 查询并以模型的形式向更高层提供数据。适配器包含如下方法：
    *   列出 getAllUsers()
    *   void addUser(UserModel 用户)
2.  UserListActivity - 显示所有用户的列表，允许添加新用户等。此活动使用 DatabaseAdapter 读取/写入数据库。

问题是：我是否应该处理数据库访问异常，例如在添加新记录时（假设应该始终正确添加记录）？我是否应该尝试在 DatabaseAdapter 中捕获异常并将其添加到日志中？或者也许我根本不应该抓住它？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-11T21:49:21.813

大多数情况下，查询数据库时的异常是“开发时间”错误的结果，例如格式错误的查询，或修改架构但未增加数据库版本，或类似的事情。这些将很容易在现场找到并修复，因此您的最终用户不会受到这些类型的错误的影响。

但是，在以下情况下，您也有可能遇到例外情况：

*   您尝试从多个进程访问您的 SQLite 数据库（灾难的秘诀）。
*   用户的设备上的磁盘空间不足。
*   由于未正确转义用户输入，您的查询格式错误。
*   您的方法中存在错误`onUpgrade()`或类似的东西。
*   您正在使用参照完整性（可能在 SQLite 3.6.19 及更高版本中）并且某些表约束失败。

真的，对于这些场景没有通用的答案。对于最终用户来说，显示一个简单的错误比强制关闭应用程序要好得多。

我的经验法则是不惜一切代价避免数据库损坏。我宁愿抛出一个`RuntimeException`并立即杀死该应用程序，而不是让它默默地做错事。另外，我宁愿显示一条消息说插入无法完成，而不是强制关闭应用程序。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-11T21:44:24.637

这个问题没有一个通用的答案总是适合的。这取决于用例。但始终适用两条规则：不要将过于详细的异常消息传递给上层（UI 不需要知道 SQL 语法中的问题）并在有意义的情况下处理异常（不要在您的 DB 类中显示错误对话框）。例如，您可以在 DB 类中捕获数据库异常，将其记录下来，然后重新抛出一个自定义 CustomerNotFoundException，该异常会在您可以显示错误对话框的 UI 中捕获。

# sql - 如何在sql中显示数据月基？

> ID：15349090
> 
> 赞同：-1
> 
> 时间：2013-03-11T21:33:53.470
> 
> 标签：sql, sql-server, tsql

我有这个查询：

```
declare @startdate datetime='1/1/2012', @endate datetime='12/31/2012'
select * from hours1
where date_start between @startdate and @enddate 
```

我想显示如下数据：

```
Jan
feb
March
...
December 
```

可以请帮助我如何得到这个？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-11T21:38:45.627

我假设您想显示开始日期和结束日期之间的月份。

```
declare @startdate datetime='1/1/2012', 
        @endate datetime='12/31/2012'

SELECT
    DATENAME(month, date_start) 
FROM
    hours1
WHERE
    date_start between @startdate and @enddate
GROUP BY 
    DATENAME(month, date_start), 
    DATEPART(month, date_start)
ORDER BY
    DATEPART(month, date_start) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-11T21:39:00.523

如果要按月汇总数据，请使用日期函数：

```
select count(<count_grouped_items), sum(<sum_of_grouped_items>), ...

from hours1 
where date_start between @startdate and @enddate 
group by YEAR(date_start), MONTH(date_start) 
order by YEAR(date_start) asc, MONTH(date_starts) asc 
```

# ios - 将 MTLModel 子类的嵌套数据结构序列化为 JSON

> ID：15349093
> 
> 赞同：3
> 
> 时间：2013-03-11T21:34:17.557
> 
> 标签：ios, objective-c, json, macos, github-mantle

我从 Github遇到了一个关于[Mantle 框架的问题。](https://github.com/github/Mantle)我想做以下

```
@interface ClassA : MTLModel <MTLJSONSerializing>
@property(strong, non-atomic) ClassB *instanceOfB; 
@end

@implementation ClassA
+ (NSDictionary *)JSONKeyPathsByPropertyKey {
    return [super.JSONKeyPathsByPropertyKey mtl_dictionaryByAddingEntriesFromDictionary:@{
            @"instanceOfB": @"user"
            }];
}

@interface ClassB : MTLModel <MTLJSONSerializing>
@property(strong, non-atomic) NSString *name; 
@end

@implementation ClassB
+ (NSDictionary *)JSONKeyPathsByPropertyKey {
    return [super.JSONKeyPathsByPropertyKey mtl_dictionaryByAddingEntriesFromDictionary:@{
            @"name": @"user_name"
            }];
} 
```

**已编辑**

`ClassA`当我使用 JSON序列化一个实例时，`[NSJSONSerialization dataWithJSONObject:[MTLJSONAdaptor JSONDictionaryFromModel:instanceOfA]`我想获得以下 JSON 对象，其中 B 的选定属性嵌套在 JSON 键下`user`：

```
{ user: {
           user_name: <value of class B's name property>
        }
} 
```

我认为必须像 NSCoding 所做的那样沿着对象关系树走下去。我想知道这种行为是否已经实现，我只是不知道如何使用它，或者我是否必须自己编写代码。

除了自述文件之外，我也很难找到更多关于地幔框架的文档。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-13T21:13:53.047

我最终`userJSONTransformer`为classA添加了一个自定义：

```
+ (NSValueTransformer *)userJSONTransformer
{
    return [MTLValueTransformer reversibleTransformerWithBlock:^id(ClassB *b){
        return @{ @"user_name": b.name,
                };
    }];
} 
```

现在生成了正确的嵌套数据结构。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-02-05T23:38:41.523

您可以使用 NSValueTransformer`reverseTransformedValue`方法。

```
+ (NSValueTransformer *)userJSONTransformer
{
    return [MTLValueTransformer reversibleTransformerWithBlock:^id(ClassB *b){
        return [[NSValueTransformer mtl_JSONDictionaryTransformerWithModelClass:[ClassB class]] reverseTransformedValue:b]
    }];
} 
```

# c++ - g++ 中的 C++11 语言支持，没有 `-std=c++11` 的库破坏特性

> ID：15349095
> 
> 赞同：6
> 
> 时间：2013-03-11T21:34:19.197
> 
> 标签：c++, c++11, g++

有没有办法告诉`g++`启用 C++11 的新语言功能，而不会由于 ABI 修改而对标准 C++ 库进行任何重大更改？

添加`-std=c++11`编译标志告诉`g++`启用语言和库功能，但是以这种方式创建的目标文件不能与使用不同`-std=`设置的目标文件安全链接。我希望能够使用语言增强功能，例如右值引用、移动构造函数（用于我自己的类）以及`auto`与 C++03 库链接的代码中的关键字。

**编辑：**

我有兴趣`g++`启用它的 C++11*语言*功能，但我希望它能够解析、编译和链接旧的 C++03 库。我不希望它使用标准库的 C++11 版本。这意味着在我自己的代码中，我将能够使用`auto`、范围 foreach 构造、右值引用等，但我*将无法*使用标准 C++ 库中的新 C++11 功能，例如`std::move`右值或右值-ref 对 STL 容器的增强。不想要 C++11 版本的标准库的原因是各种对象的布局发生了变化，因此将两个期望不同版本标准库的对象文件链接到同一个二进制文件中是无效的。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-13T00:21:31.580

不，您不能在没有 C++11 库功能的情况下启用 C++11 语言功能（除非编辑 libstdc++ 标头以删除所有 C++11 部分。）

但是没有很多不兼容的符号（只要您不使用具有不兼容的 4.7.0 或 4.7.1 `std::list`，恢复为 4.7.2）所以您可能只需要担心`erase()`RB-tree 的成员容器。您可以确保在您的主可执行文件中定义符号的 C++11 版本，以便所有需要它的代码都使用该版本的符号。其他库中期望 C++03 版本的代码将忽略返回值，期望 C++11 版本的代码将能够使用返回值。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-12T13:56:55.777

据我所知，GCC 4.7 及更高版本有 ABI 修改。您可以尝试低于该版本的版本。

它也可能有助于使用`-std=gnu++11`而不是`-std=c++11`. 为什么这到底是我不知道，但它对我有用。

# eclipse - Maven Eclipse 项目使用可编辑的源代码获取 Maven 依赖项

> ID：15349098
> 
> 赞同：0
> 
> 时间：2013-03-11T21:34:26.347
> 
> 标签：eclipse, maven, jar

我对 maven 有点陌生，我有一种情况，我希望能够在我的项目中使用我有源代码的库/依赖项，以便我可以更改库。现在我有我的主要 maven 项目，并且我已经为我想要使用的库提取了代码。该库的源代码位于我的 Eclipse 中单独的 Maven 项目中。

所以在我的 Eclipse 包资源管理器中： MyProject (maven project) Library Part A (maven project) Library Part B (maven project) Library Part C (maven project)

我想链接我的项目以便能够在库代码上使用修改后的版本。我可能必须从每个文件中制作一个 jar 文件并以这种方式链接它，但我不确定。我还没有在网上找到一个很好的例子来做到这一点。

我真正在做的是使用 wicket quickstart maven 项目，并希望使用我自己的 wicket 框架源代码而不是快速入门提供的 jars。

提前感谢您的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-11T22:23:38.960

如果您对原始 jar 没问题，那么直接从 maven 存储库（例如中央存储库）使用它。你可以在这里搜索你的图书馆：[http ://search.maven.org/](http://search.maven.org/)

如果没有，您可以使用 mvn:install 将您的 jar 安装到本地 maven 存储库中。如果您在拥有公司存储库的公司工作，则需要将其部署到您的公司存储库，以便其他人可以使用它。

安装到本地存储库： [http ://maven.apache.org/guides/mini/guide-3rd-party-jars-local.html](http://maven.apache.org/guides/mini/guide-3rd-party-jars-local.html)

部署到远程存储库： [http ://maven.apache.org/guides/mini/guide-3rd-party-jars-remote.html](http://maven.apache.org/guides/mini/guide-3rd-party-jars-remote.html)

一般来说，您可以在 Google 上轻松找到这些信息，无需在 StackO 这么快询问。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-12T06:48:11.047

已经下载了库源文件就好了，可以修改库的groupId和artifactId。完成后，您可以将其作为依赖项添加到新项目中。构建您的库版本会将其发布到可访问的本地存储库。

# jquery - JQuery if，第一个自由逻辑

> ID：15349100
> 
> 赞同：0
> 
> 时间：2013-03-11T21:34:39.877
> 
> 标签：jquery

好的，所以我写了一些 JQuery 来在用户添加额外费用时实时更新价格。加高座椅有一段代码，儿童座椅有一段代码。

这是一个，所以你可以确切地看到我在做什么：

```
 $('.boostseat').change(function() {
        //sets the var id as the id of the select box
        var id = this.id;
        //sets this as the value of the select box
        numberofboostseat = $(this).val();
        //shows a confirmation message
        $('#boostseatadd-'+id).show();
        //this handles if an item is removed, so that the value doesn't reset
        if (typeof(boosttotal) != "undefined" && boosttotal !== null) {
            price = $("#hiddenprice").val() - boosttotal;
        }else{
            price = $("#hiddenprice").val();
        }
        //number of days you hire it for cariable
        numofdays = "<?php echo $length->days; ?>";
        if (numofdays > 4){
            //alert ("boost if1");
            boostcost = Number(20);

        }else if ((numberofboostseat == 1 || numberofboostseat == 0) && (numberofchildseat == "undefined" || numberofchildseat == 0)){

            //alert ("boost if2");
            boostcost = Number(3) * Number(0);

        }else if (numofdays < 1){
            //alert ("boost if3");
            boostcost = Number(3) * Number(1);

        }else{
            //alert ("boost if4");
            boostcost = Number(3) * Number(numofdays);
        }

        // determines final price
        boosttotal = Number(numberofboostseat) * Number(boostcost);
        //more varaibles 
        newprice = Number(price) + Number(boosttotal);
        //updates hiddden fields
        $("input#hiddenboostprice").val(boosttotal);
        $("input#hiddenboostnum").val(numberofboostseat);
        $("input#hiddenprice").val(newprice);

        oldnumofboost = $("input#hiddenboostnum").val(numberofboostseat);
        //updates the HTML (Live Price Update) as decimal
        $('#'+id).html("&euro;" + newprice.toFixed(2));

    });

}); 
```

我试图对其进行评论以使其更清楚。还有另一块这样的代码可以处理儿童座椅。

我的问题是第一个儿童座椅**或**加高座椅是免费的。

我试过这个：

```
}else if ((numberofboostseat == 1 || numberofboostseat == 0) && (numberofchildseat == "undefined" || numberofchildseat == 0)){ 
```

正如您在上面看到的，可变的 boostcost 计算了席位的成本。另一段代码，childseat 也有我可以使用的全局变量，类似于这些。

任何人都可以提出一个 if 语句来有效地使第一个儿童或加高座椅免费吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-11T21:54:42.540

我在`.discount = true`变量被递减后添加变量，以防止姊妹变量也被递减。这样 numberofchildseat 或 numberofboostseat 将被打折 1 但绝不会同时打折。只要`.discounted`尚未设置，javascript 就会将其评估为`false`.

```
 if(!numberofchildseat.discounted && numberofboostseat > 0){
        numberofboostseat--;
        numberofboostseat.discounted = true;
   }
   if(!numberofboostseat.discounted && numberofchildseat > 0){
        numberofchildseat--;
        numberofchildseat.discounded = true;
   } 
```

# java - SQL 语法错误异常

> ID：15349103
> 
> 赞同：1
> 
> 时间：2013-03-11T21:34:46.267
> 
> 标签：java, mysql

我正在尝试执行以下语句：

```
String sql = "INSERT INTO `ad`.`ad` (`imgURL`, `linkURL`, `client`, `idx`) VALUES (" + a.getImgURL() + " , " + a.getLinkURL() + " , " + a.getClient() + " , " + a.getIdx() + ");"; 
```

但我收到一个错误：

```
com.mysql.jdbc.exceptions.jdbc4.MySQLSyntaxErrorException: Unknown column 'fooUrl' in 'field list' 
```

但是`fooUrl`是值之一 - 它是调用的结果`a.getImgUrl()`。

我是使用数据库的新手，我确信是一个简单的语法错误导致了这种情况。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-11T21:40:37.247

如果您使用准备好的语句，您将避免此类问题，并且您将编写更安全的代码。

```
String sql = "INSERT INTO `ad`.`ad` (`imgURL`, `linkURL`, `client`, `idx`) VALUES (?, ?, ?, ?)";
final PreparedStatement statement = conn.prepareStatement(sql);
statement.setString(1, a.getImgURL()) ;
statement.setString(2, a.getLinkURL()) ;
statement.setString(3, a.getClient()) ;
statement.setString(4, a.getIdx());
final ResultSet results = statement.executeQuery(); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-11T21:37:41.323

您缺少数据周围的引号。你写它的方式，你指的是列名。

像这样重写：

```
String sql = "INSERT INTO `ad`.`ad` (`imgURL`, `linkURL`, `client`, `idx`) 
        VALUES ('" + a.getImgURL() + "' , '" + a.getLinkURL() + "' , '" +
                a.getClient() + "' , '" + a.getIdx() + "');"; 
```

显然，您必须在将数据放入数据库之前对其进行转义。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-11T21:41:24.337

用双引号将任何字符串值括起来。你也需要逃离他们。

```
String sql = "INSERT INTO `ad`.`ad` (`imgURL`, `linkURL`, `client`, `idx`) VALUES (\"" + a.getImgURL() + "\" , "\" + a.getLinkURL() + \"" , \"" + a.getClient() + "\" , " + a.getIdx() + ");"; 
```

**强制性不要忘记清理您输入的单引号备注。**

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-11T21:43:27.400

很难通过查看构建 SQL 的代码来尝试调试 SQL。

```
String sql = "INSERT INTO `ad`.`ad` (`imgURL`, `linkURL`, `client`, `idx`) VALUES ("
  + a.getImgURL() + " , " + a.getLinkURL() + " , " + a.getClient() + " , " 
  + a.getIdx() + ");"; 
```

相反，检查结果`sql`字符串：

```
INSERT INTO `ad`.`ad` (`imgURL`, `linkURL`, `client`, `idx`) VALUES (fooURL, ...); 
```

`fooURL`当您查看没有引号的 SQL 时，您应该能够更容易地看到。因此它被解释为一个表达式，而不是一个简单的标量字符串值。单个单词的表达式仅假定为列名，但在 ad 表中不存在该名称的此类列。

避免在 SQL 语句中插入字符串会好得多。 [了解如何改用准备好的查询和查询参数。](http://docs.oracle.com/javase/tutorial/jdbc/basics/prepared.html)

```
String sql = "INSERT INTO `ad`.`ad` (`imgURL`, `linkURL`, `client`, `idx`) "
  + " VALUES (?, ?, ?, ?)";
PreparedStatement insertAd = con.prepareStatement(sql);
insertAd.setString(1, a.getImgUrl);
insertAd.setString(2, a.getLinkUrl);
insertAd.setInt(3, a.getClient);
insertAd.setInt(4, a.getIdx);
insertAd.executeUpdate(); 
```

您不需要引用或转义查询参数。使用参数比记住平衡引号的位置要容易得多。出于这个原因，它也更安全，因为你更有可能做对。

# erlang - Erlang：客户端IP地址，将数据包发送到特定客户端？

> ID：15349104
> 
> 赞同：1
> 
> 时间：2013-03-11T21:34:50.583
> 
> 标签：erlang, client, ip-address, tcp-ip

有没有办法在 Erlang 中获取客户端的 IP 地址以进行 tcp 连接；基于客户端连接到服务器的假设？

我还想知道是否有必要将特定的数据包发送到特定的客户端；就像服务器不广播的情况一样，但是我需要IP地址将数据包发送到特定客户端还是服务器只是为每个客户端使用参考（erlang：monitor）？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-12T04:42:37.667

对于另一端的地址，[`inet:peername(Socket)`](http://www.erlang.org/doc/man/inet.html#peername-1)。但是，如果您想处理 a 中的`TCP Conversation`每个客户端，通常，一旦每个客户端连接，您将生成单独的 erlang 进程来处理它，然后[`Transfer the Socket Ownership`](http://www.erlang.org/doc/man/gen_tcp.html#controlling_process-2)再到生成的进程。

然后，在 中`receive loop`，您将向/从客户端发送和接收二进制数据。考虑看看这个模块：[`gen_tcp`](http://www.erlang.org/doc/man/gen_tcp.html)，详细。但是，您的问题听起来像，您想实现一个`Peer-to-peer`系统。在这样的系统中，您将`agents`在软件中创建，每个代理都可以随时成为服务器或客户端。当代理之间的通信仅按需进行并且除非有要发送的内容否则不会创建会话/连接时，尤其需要这样做。我可能不应该这样做。

# ios - 如何在 iOS 上使用 S3 区分已完成的请求？

> ID：15349105
> 
> 赞同：2
> 
> 时间：2013-03-11T21:34:52.720
> 
> 标签：ios, amazon-s3, download

我正在使用 AWSiOSSDK 从 iOS 环境上传和下载文件。在这两种情况下，文件都是异步传输的，下面的函数指定一个完成的请求：

```
-(void)request:(AmazonServiceRequest *)request didCompleteWithResponse:(AmazonServiceResponse *)response 
```

响应返回成功并且文件已传输后，我如何生成它对应的文件？尤其重要的是，我正确地订购了下载的文件。排序嵌入到文件名中，因此如果可能，在标题中检索它就足够了。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-11T21:40:48.777

在开始之前，`AmazonServiceRequest`您可以设置属性`requestTag`以识别您下载的文件。您还可以获取`url`属性以确定您下载的文件。

```
-(void)request:(AmazonServiceRequest *)request 
didCompleteWithResponse:(AmazonServiceResponse *)response
{
    NSLog(@"Request tag:%@ url:%@", request.requestTag, request.url);
} 
```

# jquery-mobile - 如何更改jquery移动按钮文本

> ID：15349107
> 
> 赞同：1
> 
> 时间：2013-03-11T21:34:59.210
> 
> 标签：jquery-mobile, jquery-plugins, jquery

jQuery mobile 在将elme 增强为Widget 后会插入大量元素。

例如，“a”将在“a”之后插入两个 span elem 增强为按钮。那么，如何在“a”增强为按钮后正确修改a的innerText呢？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-11T22:49:39.617

第一种官方方法不存在，因此必须手动完成。

有两种常见的方式：

## 经典解决方案：

```
 $(document).on('pagebeforeshow', '#index', function(){       
        $('#custom-btn span span').text('This is a new text');
    }); 
```

现场示例：http: [//jsfiddle.net/Gajotres/EjVfz/](http://jsfiddle.net/Gajotres/EjVfz/)

该解决方案预计未来的按钮实现不会发生任何变化，并且一切都将保持不变。

## 谨慎的解决方案：

```
 $(document).on('pagebeforeshow', '#index', function(){       
        $('#custom-btn').find('.ui-btn-text').text('This is a new text');
    }); 
```

现场示例：http: [//jsfiddle.net/Gajotres/QHg3w/](http://jsfiddle.net/Gajotres/QHg3w/)

此解决方案是一个安全的解决方案，无论使用哪个按钮示例（a、按钮、输入），按钮文本将始终位于**.ui-btn-text**类中。

**编辑 ：**

## 更改按钮插件

```
$(document).on('pagebeforeshow', '#index', function(){       
    $('#custom-btn').changeButtonText('This is a new text');
});

(function($) {
    /*
     * Changes the displayed text for a jquery mobile button.
     * Encapsulates the idiosyncracies of how jquery re-arranges the DOM
     * to display a button for either an <a> link or <input type="button">
     */
    $.fn.changeButtonText = function(newText) {
        return this.each(function() {
            $this = $(this);
            if( $this.is('a') ) {
                $('span.ui-btn-text',$this).text(newText);
                return;
            }
            if( $this.is('input') ) {
                $this.val(newText);
                // go up the tree
                var ctx = $this.closest('.ui-btn');
                $('span.ui-btn-text',ctx).text(newText);
                return;
            }
        });
    };
})(jQuery); 
```

现场示例：http: [//jsfiddle.net/Gajotres/mwB22/](http://jsfiddle.net/Gajotres/mwB22/)

解决方案/插件位置：[https ://stackoverflow.com/a/7279843/1848600](https://stackoverflow.com/a/7279843/1848600)

# .net - 用于互操作的 Windows 消息传递？

> ID：15349109
> 
> 赞同：0
> 
> 时间：2013-03-11T21:35:02.190
> 
> 标签：.net, interop, remoting

是否可以使用 Windows 消息系统作为互操作 2 个 .NET 应用程序的一种方式？如何做到这一点？我正在寻找一种在 2 个不同的 .NET 应用程序之间传递高频数据的方法。我们尝试了 TCP/IP，但发现很难避免丢弃消息，因此我们切换到 MSMQ，它可以工作，但具有性能因素，我们不需要保留消息。

我们假设这些应用程序在同一台 PC 上运行。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-11T21:46:12.087

既然您编辑了问题以说明应用程序在同一台 PC 上运行，我建议您使用 IPC 的命名管道 - [http://msdn.microsoft.com/en-us/library/windows/desktop/aa365780( v=vs.85).aspx](http://msdn.microsoft.com/en-us/library/windows/desktop/aa365780(v=vs.85).aspx)

如果您在同一台 PC 中，则没有理由通过 MSMQ 或 TCP/IP 堆栈，它们可以简单地使用共享内存。

如果您的流程之间的合同是干净的（特别是如果它是一种方式），您可以使用 WCF NetNamedPipeBinding 来更轻松地实现 - [http://msdn.microsoft.com/en-us/library/ms752247.aspx](http://msdn.microsoft.com/en-us/library/ms752247.aspx)

# mysql - 复合属性索引

> ID：15349110
> 
> 赞同：2
> 
> 时间：2013-03-11T21:35:10.353
> 
> 标签：mysql, sql, indexing, composite-index

当我们在属性上创建索引时，会为此属性创建一棵树。
但是当我们创建一个具有复合属性的索引时会发生什么呢？创建了两棵树？两者都是同一棵树的一部分？什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-13T16:52:35.203

它按照您提到的顺序连接属性。出于同样的原因，如果您在列 a、b、c 上以相同的顺序有一个复合索引，则该索引仅在搜索左列时才有用

```
WHERE a=4 ## uses index
WHERE a=4 and b=10 ## uses index
WHERE b=10 ## doesnot use index 
```

# memory-management - Neo4j 什么时候释放内存？

> ID：15349112
> 
> 赞同：3
> 
> 时间：2013-03-11T21:35:14.717
> 
> 标签：memory-management, neo4j

我对内存管理有点困惑。

我在 java 应用程序中以嵌入模式使用 neo4j。版本 - 1.8.1。JVM 版本 - 1.6

我有一个带有 for 循环的单线程加载程序，其中包含一个嵌套的 for 循环。在外部 for 循环中，我`graphDb.beginTx();`从 mysql 获取测试对象的 id 并为此创建一个节点。在内部 for 循环中，我正在查询 mysql 以获取一堆相关对象。我为它们创建节点，以及与我在外部循环中创建的节点的对应关系。

在外部 for 循环结束时，我执行`tx.success()`and `tx.finish()`。

```
for (int x = 0; x < 10000000; x++) {
    Transaction tx = graphDb.beginTx();
    Node n = graphDb.createNode();
    Long id = n.getId();
    System.out.println("ID: " + id);
    n.setProperty("TestId", x); 
    * * * get the mysql ids * * * *
    for (int y = 0; y < mysqlidlist; y++) {
        Node n1 = graphDb.createNode();
        Long id2 = n1.getId();
        n1.setProperty("InnerTestId", y);
        Relationship rel = n.createRelationshipTo(n1, NodeRelation.ATTRIBUTE);
        rel.setProperty("Weight", 0.3);
    }
    tx.success();
    tx.finish();
    tx = null;
} 
```

根据我的阅读，我认为 Neo4j 会释放事务抓取的内存。但是，我看到内存使用量总是在增加，一段时间后它会达到 Xmx 设置。我将对其进行分析以确保没有其他泄漏。最后我将所有其他变量设置为 null，这应该有助于 GC 以更好的方式获得它。

我的理解错了吗？如果是这样，推荐的内存管理最佳实践是什么？

下一步 - 单线程加载器将扩展为多线程加载器，因此，要确保内存管理和事务管理是健壮的。

非常感谢！

问候，

萨钦

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-12T13:06:30.730

对于这种大规模插入，如果您不需要事务，我建议使用批量插入。

[http://docs.neo4j.org/chunked/milestone/batchinsert.html](http://docs.neo4j.org/chunked/milestone/batchinsert.html)

* * *

或者，不推荐：如果您想使用您的代码片段，请在 for 循环内添加类似：*if(y%1000==0) { tx.success();tx.finish()}*以提交和释放内存每*n*次插入使用一次，但速度会慢一些

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-12T04:49:42.910

您可以尝试关闭缓存（使用 cache_type=none）。docs.neo4j.org/chunked/milestone/configuration-caches.html

# ole - XML OleObject GetChildNodes

> ID：15349115
> 
> 赞同：0
> 
> 时间：2013-03-11T21:35:29.423
> 
> 标签：ole

所以我有以下xml：

```
<ElementList>
    <Element>   
        <Row1>row1text</Row1>
        <Row2>row2text</Row2>
    </Element>
</ElementList> 
```

我使用以下代码从中获取信息：

```
OleObject loo_element

loo_element = xmlDoc.SelectNodes('//ElementList/Element[1]')
print(loo_element.item[0].text) 
```

这给了我错误的输出：

```
row1textrow2text 
```

我想让对象像这样初始化：

```
loo_element.item[0].text = row1text
loo_element.item[1].text = row2text 
```

我怎样才能做到这一点？猜测我需要在 SelectNodes 中以某种方式更改我的 XPath？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-14T22:05:08.627

就这么简单：

```
loo_element = xmlDoc.SelectNodes('//ElementList/Element[1]/*') 
```

# c++ - Google Mock：如何配置自定义消息来解释匹配失败

> ID：15349116
> 
> 赞同：5
> 
> 时间：2013-03-11T21:35:33.860
> 
> 标签：c++, googlemock

如果匹配失败，谷歌模拟打印如下消息：

> test.cpp:112: EXPECT_CALL(mock_obj, foo( **MyMatcher** ( **bar** ) ))...
> **预期 arg #0** : 等于 [1,2; 3,4]
> **实际**：{ 1 }
> 预期：被调用一次
> 实际：从未被调用 - 不满意和活跃

使用自定义匹配器**MyMatcher**我可以定义一个描述字符串，用于在匹配失败时生成失败消息。但它只定义了消息的**Expected arg #0**部分。有什么方法可以自定义**实际**的打印方式吗？

在我的情况下，我不能为**bar**类重载 operator<<，因为它已经被第三方代码重载不在我的控制之下（这个库定义了**bar**类和 operator<< ）。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-03-13T10:03:03.993

由于我**无法**为`operator` `<<`我`class`的 google 测试定义功能，因此可以选择为其定义`PrintTo`功能[教 Google 测试如何打印您的值](https://github.com/google/googletest/blob/master/googletest/docs/AdvancedGuide.md#teaching-google-test-how-to-print-your-values)。感谢[RA](https://stackoverflow.com/users/214762/ra)的链接。

> 用户可以通过在定义 Foo 的命名空间中定义 PrintTo() 的重载来覆盖类类型 Foo 的此行为。我们给用户这个选项，因为有时为 Foo 定义一个 << 操作符是不可取的（例如，编码风格可能会阻止这样做，或者已经有一个 << 操作符但它没有做用户想要的）。

```
void PrintTo(const Bar& value, ::std::ostream* os); 
```

# python - 在行（从行列表）中搜索单词（从单词列表）并将值附加到新列表。Python

> ID：15349121
> 
> 赞同：0
> 
> 时间：2013-03-11T21:35:45.930
> 
> 标签：python, list, function, search, findall

如果你有一个名字列表。. .

```
query = ['link','zelda','saria','ganon','volvagia'] 
```

和文件中的行列表

```
data = ['>link is the first','OIGFHFH','AGIUUIIUFG','>peach is the second',
'AGFDA','AFGDSGGGH','>luigi is the third','SAGSGFFG','AFGDFGDFG',
'DSGSFGAAA','>ganon is the fourth','ADGGHHHHHH','>volvagia is the last',
 'AFGDAAFGDA','ADFGAFD','ADFDFFDDFG','AHUUERR','>ness is another','ADFGGGGH',
'HHHDFDA'] 
```

您将如何查看以“>”开头的所有行，然后如果它们具有名称 name_list 之一，则包括带有“>”的行以及它后面的序列（后面的序列总是在上面）在两个单独的列表中

```
#example output file

name_list = ['>link is the first','>ganon is the fourth','>volvagia is the last']
seq_list = ['OIGFHFHAGIUUIIUFG','ADGGHHHHHH','AFGDAAFGDAADFGAFDADFDFFDDFGAHUUERR'] 
```

我宁愿不使用字典来执行此操作，因为在类似情况下我被提示这样做

所以我到目前为止是：

```
for line,name in zip(data,query):
    if bool(line[0] == '>' and re.search(name,line))==True:
        #but then i'm stuck because len(query) and len(data) are not equal 
```

....任何帮助将不胜感激``

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-11T22:05:09.107

```
result = []
names = ['link', 'zelda', 'saria', 'ganon', 'volvagia']
lines = iter(data)
for line in lines:
    while line.startswith(">") and any(name in line for name in names):
        name = line
        upper_seq = []
        for line in lines:
            if not line.isupper():
                break
            upper_seq.append(line)
        else:
            line = "" # guard against infinite loop at EOF 

        result.append((name, ''.join(upper_seq))) 
```

如果有很多名称，那么`set()`在行中查找名称可能会更快，而不是`any(...)`：

```
names = set(names)
# ...
    if line.startswith(">") and names.intersection(line[1:].split()):
        # ... 
```

### 结果

```
[('>link is the first', 'OIGFHFHAGIUUIIUFG'),
 ('>ganon is the fourth', 'ADGGHHHHHH'),
 ('>volvagia is the last', 'AFGDAAFGDAADFGAFDADFDFFDDFGAHUUERR')] 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-11T21:38:56.720

使用列表理解

```
print [line for line in lines if line.startswith(">") and set(my_words).intersection(line[1:].split())] 
```

这分解为一个for循环，如下所示

```
matched_line = []
for line in lines:
    if line.startswith(">") and set(my_words).intersection(line[1:].split()):
       matched_lines.append(line) 
```

使用集合交集应该比遍历列表中的每个单词并查看它是否在字符串中要快得多

```
>>> print [line for line in data if line.startswith(">") and set(query).intersection(line[1:].split())]
['>link is the first', '>ganon is the fourth', '>volvagia is the last'] 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-11T21:53:30.357

有更优雅的方法可以做到这一点，但我认为这种方法可能是你最容易理解的：

```
>>> found_lines = []
>>> sequences = []
>>> for line in data:
...     if line.startswith(">"):
...         for name in query:
...             if name in line:
...                 found_lines.append(line)
...     else:
...         sequences.append(line)
>>> print found_lines
['>link is the first', '>ganon is the fourth', '>volvagia is the last']
>>> 
```

总是从简单开始，然后想办法解决问题。你需要做的第一件事是什么？您想遍历`data`( `for line in data`) 中的每一行。

对于这些行中的每一行，您要检查它是否以`>`. ( `if line.startswith(">")`)。如果它不是以那个字符开头，那么我们可以假设它是一个“序列”，并将它添加到`sequences`列表中 ( `sequences.append(line)`)

如果是这样，那么您要检查是否有任何名称`query`出现在该行中。最简单的方法是什么？遍历每个名​​称 ( `for name in query`)，并自行检查 ( `if name in line`)

# ios - AFNetworking 客户端子类不解析响应

> ID：15349123
> 
> 赞同：1
> 
> 时间：2013-03-11T21:35:48.967
> 
> 标签：ios, afnetworking

我试图通过子类化 AFHTTPClient 并设置基本路径来实现 AFNetworking 客户端

```
#define WineAPIBaseURLString @"http://localhost:3000/"
@implementation WineAPIClient

+(id)sharedInstance{
  static WineAPIClient *__sharedInstance;
  static dispatch_once_t onceToken;
  dispatch_once(&onceToken, ^{
    __sharedInstance = [[WineAPIClient alloc]initWithBaseURL:[NSURL URLWithString:WineAPIBaseURLString]];
});
return __sharedInstance;
}

- (id)initWithBaseURL:(NSURL *)url
{
 self = [super initWithBaseURL:url];
if(self){
    [self setParameterEncoding:AFJSONParameterEncoding];
    [self registerHTTPOperationClass:[AFJSONRequestOperation class]];
}

return self;
}

@end 
```

现在在我的视图控制器中调用客户端给了我奇怪的结果。例如下面的代码：

```
[[WineAPIClient sharedInstance] getPath:@"wines"
                               parameters:nil
                               success:^(AFHTTPRequestOperation *operation, id responseObject) {
                                        NSLog(@"%@", responseObject);

                               }
                               failure:^(AFHTTPRequestOperation *operation, NSError *error) {
                                        NSLog(@"Error fetching wines!");
                                        NSLog(@"%@",error);
                               }]; 
```

它正在登录控制台一堆数字：

```
2013-03-11 16:25:36.411 AFNetworking4[1934:1260b] GET 'http://localhost:3000/wines'
2013-03-11 16:25:36.430 AFNetworking4[1934:f803] <5b0a2020 7b0a2020 2020225f 5f76223a    20302c0a 20202020 225f6964 223a2022 35313131 35656235 37356265 35383766 3034303...
2013-03-11 16:25:36.429 AFNetworking4[1934:13003] 200 'http://localhost:3000/wines' [0.0173 s] 
```

如何更正客户端以正确解析 JSON？客户端实现是否有任何错误？

需要注意的一件事是，在不使用自定义客户端时，完全相同的 URI 可以正常工作。

IE：

```
NSURL *url = [NSURL URLWithString:@"http://localhost:3000/wines"];
NSURLRequest *request = [NSURLRequest requestWithURL:url];

AFJSONRequestOperation *operation = [AFJSONRequestOperation JSONRequestOperationWithRequest:request success:^(NSURLRequest *request, NSHTTPURLResponse *response, id JSON) {
    NSLog(@"%@",JSON);
} failure:nil];
[operation start]; 
```

我正在使用 AFNetworking 的 0.10.1 分支（我必须支持 4.x 设备，所以我无法升级......）。

任何想法如何纠正？

非常感谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-12T15:22:17.947

谢谢，没错...我收到的是 NSData 而不是解析的 JSON。完全错过了关于这部分的文档信息

*这些内容类型仅在以下情况下作为请求的响应对象返回：1) HTTP 客户端已使用 - registerHTTPOperationClass: 注册了适当的 AFHTTPRequestOperation 子类，并且 2) 请求 Accept HTTP 标头适合所请求的内容类型。不这样做可能会导致获取方法的成功或失败回调块的 NSData 实例，例如 getPath:parameters:success:failure。因此，要使用 JSON 数据，例如，在初始化 HTTP 客户端时执行 [client registerHTTPOperationClass: [AFJSONRequestOperation class]] 和 [client setDefaultHeader:@"Accept" value:@"application/json"]。*

因此，修复只是将**Accept application/json**默认标头添加到客户端。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-12T00:58:46.520

`AFJSONParamterEncoding`唯一影响您通过请求传递的参数。看起来您正在接收编码为 NSData 的数据。您可以尝试创建一个 NSString ，`initWithData`然后将其记录下来。您可能还想确保您的客户端返回实际的 JSON。在红宝石中，这可能需要一种`to_json`方法。

# jquery - 加速 jQuery mobile - 页面缓存和从不在视图中的内容中删除 HTML

> ID：15349126
> 
> 赞同：1
> 
> 时间：2013-03-11T21:35:55.540
> 
> 标签：jquery, performance, jquery-mobile

我正在尝试加快我的 jQuery 移动网络应用程序的速度，并且在 Google 上我发现了有关页面缓存的信息。似乎无法找到关于它的作用的适当详细解释，所以任何人都可以阐明为什么它是坏的吗？许多人似乎都希望将其关闭。

我的主要问题是（我认为）与此相关 - 基本上我有许多 js 函数，它们在应用程序启动时将大量 HTML 插入到不同的页面中，然后在每个页面加载时插入。例如，当我加载我的幻灯片页面时，它会在 pageload 中加载幻灯片，因此它不会一直在 DOM 中。这是应该为所有页面做的吗？过多的 HTML 是否会对一般应用程序的速度产生很大的影响？

我想隐藏我的 8 个页面的所有内容，但是在每个页面加载时使用 js 显示内容，但这值得吗？（然后显然将其再次隐藏在 pagehide 上。）

我认为这与页面缓存有关吗？

另外，我使用的是多页模板，因此所有页面都在一个 HTML 文件中，但是在我有很多外部 js 库的情况下，将此页面加载到另一个 HTML 文件中是否更有意义使用 HTML 和画布标签/js 文件减慢应用程序的其余部分？

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-11T23:14:07.517

为了能够理解页面兑现，您需要了解 jQuery Mobile 如何处理页面加载。

## 1 HTML / 多页

这个解决方案可能最容易处理。一切都在一个大文件中，如果您保持一切井井有条，您将不会遇到太多问题。但是，如果您正在创建一个大型网络应用程序（特别是如果这个网络应用程序将通过 phonegap 框架成为移动应用程序），那么这个解决方案将会产生很多问题。

因为这是一个大文件，jQuery Mobile 会将所有内容加载到 DOM。这将导致更快的过渡效果，同时使您的 Web 应用程序臃肿。

如果您正在创建仅适用于桌面浏览器的 Web 应用程序，那么这就是您的解决方案。在任何其他情况下运行它。

## 多个 HTML 模板

此模板更适合移动设备。只有一个 HTML 页面会被加载到 DOM 中，并且之前的每个页面都会从其中删除（除非特别定义）。此解决方案可能会出现页面转换问题，但除非您创建大型 HTML 文件，否则它不会成为问题。

只有使用 ajax 加载的页面才会被加载到 DOM 中。因此，每个新的 HTML 文件都将被加载，每个旧的/以前的文件都将被删除。

## 页面缓存

如果您使用**多 HTML 模板**解决方案，您可以预取一些页面，从而防止转换问题。

可以使用加载页面功能预取页面：

```
$.mobile.loadPage( pageUrl, { showLoadMsg: false } ); 
```

或者通过将**data-dom-cache="true"**属性放入页面 div 容器中，如下所示：

```
<div data-role="page" id="cacheMe" data-dom-cache="true"> 
```

## 自动页面缓存

也可以使用此属性在移动级别上打开/关闭缓存：

```
$.mobile.page.prototype.options.domCache = true; 
```

或像这样禁用：

```
$.mobile.page.prototype.options.domCache = false; 
```

此属性必须在 mobileinit 事件中加载：

```
$(document).bind("mobileinit", function(){
    $.mobile.page.prototype.options.domCache = true;
}); 
```

此属性不能与**1 个 HTML/多页模板**一起使用。

有关这方面的更多信息，可以在官方文档中找到：http: [//jquerymobile.com/demos/1.0rc2/docs/pages/page-cache.html](http://jquerymobile.com/demos/1.0rc2/docs/pages/page-cache.html)

# c# - dataGridView、MySQL 数据和动态变化的信息

> ID：15349128
> 
> 赞同：0
> 
> 时间：2013-03-11T21:36:09.027
> 
> 标签：c#, mysql, visual-studio-2010

我用这段代码从 MySQL 表中选择的数据填充 dataGridView

```
MySqlConnection sqlConnection = new MySqlConnection(sqlParams);

try
{
    MySqlDataAdapter adapter = new MySqlDataAdapter();
    adapter.SelectCommand = new MySqlCommand(sqlQuery, sqlConnection);

    DataSet ds = new DataSet();
    adapter.Fill(ds);
    dataGridView1.DataSource = ds.Tables[0];
    dataGridView1.Sort(dataGridView1.Columns["ColumnName"], ListSortDirection.Ascending);
}
catch {
} 
```

其中一列包含总和数据（例如 10.34 美元），但问题是在我的国家格式中它必须是“10,34”（coma 而不是点），所以我想在填充 dataGridView 时更改这个符号到正确一。可能吗？还是有其他方法？因为现在我以“点”格式存储总和，因为这样我可以使用像 SUM 这样的 MySQL 命令。

简而言之：在 MySQL 中我有 10.34，但用户必须看到 10,34 :)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-11T21:49:09.767

对的，这是可能的。格式可在 datagridview 中设置。

```
dataGridView1.Columns["ColumnName"].DefaultCellStyle.Format = "C"; 
```

“C”表示货币格式。“N”用于一般数字格式。此外，对于您所在国家/地区的特定格式，您可以使用类 CultureInfo，您可以在其中为当前线程设置特定的格式提供程序。

# xml - XSLT：基于其他属性名称的特定属性值的总和

> ID：15349131
> 
> 赞同：4
> 
> 时间：2013-03-11T21:36:20.430
> 
> 标签：xml, xslt, xslt-1.0

我有以下 XML 文档（由另一方提供）

```
<transactions>
  <transaction TaxAType="11" TaxAValue="111" TaxBType="2" TaxBValue="222" TaxCType="3" TaxCValue="333"/>
  <transaction TaxAType="11" TaxAValue="111" TaxBType="2" TaxBValue="222" TaxCType="3" TaxCValue="333"/>
</transactions> 
```

例如，如果相应的 Tax*Type = '11'，我想编写一个 XSLT 文档来转换这些行并总结 Tax*Value。

如果不使用模板，这可能吗？

XQuery 中的 name()、substring() 等函数？您对此有何看法？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2013-03-11T21:49:40.697

看看下面的 XSLT：

```
<?xml version="1.0" encoding="UTF-8"?>
<xsl:stylesheet xmlns:xsl="http://www.w3.org/1999/XSL/Transform" version="1.0">
  <xsl:output method="xml" indent="yes" />
  <xsl:template match="/">

    Sum of TaxA where type = 11:
    <xsl:value-of select="sum(transactions/transaction[@TaxAType='11']/@TaxAValue)" />

    Sum of all tax where type = 11:
    <xsl:value-of select="sum(transactions/transaction[@TaxAType='11']/@TaxAValue) 
      + sum(transactions/transaction[@TaxBType='11']/@TaxBValue) 
      + sum(transactions/transaction[@TaxCType='11']/@TaxCValue)" />

  </xsl:template>
</xsl:stylesheet> 
```

它计算 TaxAType = 11 的节点的 TaxAValue 的总和，以及 Tax?Type = 11 的节点的所有 Tax?Value 的总和。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-13T16:03:58.237

这是一个有点冗长但一般的方法：

```
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
  <xsl:output method="xml" indent="yes"/>
  <xsl:param name="taxType" select="11" />

  <xsl:template match="transactions">
    <result>
      <xsl:variable name="allValues" 
                    select="transaction/@*[substring(local-name(), 5, 5) = 'Type']
                                          [. = $taxType]" />
      <xsl:call-template name="SumValues">
        <xsl:with-param name="items" select="$allValues" />
      </xsl:call-template>
    </result>
  </xsl:template>

  <xsl:template name="SumValues">
    <xsl:param name="items" />
    <xsl:param name="total" select="0" />

    <xsl:choose>
      <xsl:when test="not($items)">
        <xsl:value-of select="$total" />
      </xsl:when>
      <xsl:otherwise>
        <xsl:variable name="currentItem" select="$items[1]" />
        <xsl:variable name="currentValue">
          <xsl:apply-templates select="$currentItem" mode="getMatchingValue" />
        </xsl:variable>

        <xsl:call-template name="SumValues">
          <xsl:with-param name="items" select="$items[position() > 1]" />
          <xsl:with-param name="total" select="$total +  $currentValue" />
        </xsl:call-template>
      </xsl:otherwise>
    </xsl:choose>
  </xsl:template>

  <xsl:template match="@*" mode="getMatchingValue">
    <xsl:variable name="typeCodeLetter" select="substring(local-name(), 4, 1)" />
    <xsl:variable name="valueAttributeName"
                  select="concat('Tax', $typeCodeLetter, 'Value')" />
    <xsl:variable name="matchingValueAttribute"
                  select="../@*[local-name() = $valueAttributeName]" />

    <!-- Multiply by boolean to handle the case where the 
         attribute wasn't found-->
    <xsl:value-of select="$matchingValueAttribute * 
                          boolean($matchingValueAttribute)"/>
  </xsl:template>
</xsl:stylesheet> 
```

这应该能够处理任意数量的`Tax*Type`s（只要 * 是单个字符）并且可以将所需的类型作为参数传入。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-11T21:51:12.923

此 xml 的格式不适合完成您要求执行的处理类型。您最好的选择是使用 javascript 或其他具有 XML 功能的语言（C#、Java 等）来提取您需要的详细信息。

使用 javascript，您可以找到 Tax*Type=11 的任何属性，然后获取下一个属性的值

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-09-26T05:59:43.067

总和（交易/交易[@TaxAType='11']/@TaxAValue | @TaxBvalue | @TaxCvalue）

# api - 通过 Salesforce REST API 模拟用户？

> ID：15349139
> 
> 赞同：1
> 
> 时间：2013-03-11T21:36:38.817
> 
> 标签：api, rest, salesforce, impersonation

有没有办法通过 Salesforce REST API 模拟用户，所以您只能看到他有权访问的数据？例如，您将只检索允许模拟用户查看的联系人。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-11T22:02:19.140

Salesforce 的授权系统会根据经过身份验证的用户的安全配置文件自动实施对数据的可见性。因此，请确保您以要模拟的用户身份进行身份验证。你不需要做任何其他事情。

# python - 为异步函数提供大字典会使代码非常慢

> ID：15349147
> 
> 赞同：1
> 
> 时间：2013-03-11T21:37:01.860
> 
> 标签：python, asynchronous, multiprocessing

我在我的 python 代码中使用多处理来异步运行一个函数：

```
import multiprocessing

po = multiprocessing.Pool()
for elements in a_list:
    results.append(po.apply_async(my_module.my_function, (some_arguments, elements, a_big_argument)))               
po.close()
po.join()
for r in results:
    a_new_list.add(r.get()) 
```

`a_big_argument`是一本字典。我把它作为一个论据。从某种意义上说，它在 10 到 100 Mo 之间很大。它似乎对我的代码的性能有很大的影响。

我可能在这里做一些愚蠢且效率不高的事情，因为我的代码的性能确实因这个新参数而下降。

处理大字典的最佳方法是什么？我不想每次都在我的函数中加载它。它会是创建数据库并连接到它的解决方案吗？

这是您可以运行的代码：

```
'''
Created on Mar 11, 2013

@author: Antonin
'''

import multiprocessing
import random

# generate an artificially big dictionary
def generateBigDict():
    myBigDict = {}
    for key in range (0,1000000):
        myBigDict[key] = 1
    return myBigDict

def myMainFunction():
    # load the dictionary
    myBigDict = generateBigDict()
    # create a list on which we will asynchronously run the subfunction
    myList = []
    for list_element in range(0,20):
        myList.append(random.randrange(0,1000000))
    # an empty set to receive results
    set_of_results = set()
    # there is a for loop here on one of the arguments
    for loop_element in range(0,150):
        results = []
        # asynchronoulsy run the subfunction
        po = multiprocessing.Pool()
        for list_element in myList:
            results.append(po.apply_async(mySubFunction, (loop_element, list_element, myBigDict)))               
        po.close()
        po.join()
        for r in results:
            set_of_results.add(r.get())
    for element in set_of_results:
        print element

def mySubFunction(loop_element, list_element, myBigDict):
    import math
    intermediaryResult = myBigDict[list_element]
    finalResult = intermediaryResult + loop_element
    return math.log(finalResult)

if __name__ == '__main__':
    myMainFunction() 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-13T21:04:36.317

我曾经[`multiprocessing.Manager`](http://docs.python.org/2/library/multiprocessing.html#sharing-state-between-processes)这样做过。

```
import multiprocessing

manager = multiprocessing.Manager()
a_shared_big_dictionary = manager.dict(a_big_dictionary)

po = multiprocessing.Pool()
for elements in a_list:
    results.append(po.apply_async(my_module.my_function, (some_arguments, elements, a_shared_big_dictionary)))               
po.close()
po.join()
for r in results:
    a_new_list.add(r.get()) 
```

现在，它要快得多。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-11T22:49:26.527

[请参阅python 多处理](https://stackoverflow.com/questions/10721915/shared-memory-objects-in-python-multiprocessing/10724332#10724332)问题中共享内存对象的答案。

它建议使用[multiprocessing.Array](http://docs.python.org/2/library/multiprocessing.html#multiprocessing.Array)将数组传递给子进程或使用 fork()。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-11T23:02:24.190

您传递给其中一种`Pool`方法（例如`apply_async`）的任何参数都需要被腌制，通过管道发送到工作进程，并在工作进程中取消腌制。这个pickle/pass/unpickle过程在时间和内存上可能会很昂贵，特别是如果你有一个大的对象图，因为每个工作进程都必须创建一个单独的副本。

根据问题的具体形式，有许多不同的方法可以避免这些泡菜。由于您的工作人员只是*阅读*您的字典而不是写入它，因此您可以安全地直接从您的函数中引用它（即不将其传递给`apply_async`）并依靠`fork()`避免在工作进程中创建副本。

更好的是，您可以进行更改`mySubFunction()`，使其接受作为参数，而不是使用and`intermediaryResult`查找它。（您可以通过闭包来做到这一点，但我不能 100% 确定 pickle 也不会尝试复制封闭对象。）`list_element``myBigDict``myBigDict`

或者，您可以将`myBigDict`它放在所有进程都可以安全共享它的地方，例如[简单的持久性方法之一，例如 dbm 或 sqlite](http://docs.python.org/2/library/persistence.html)，并让工作人员从那里访问它。

不幸的是，所有这些解决方案都要求您更改任务功能的形状。避免这种“变形”是人们喜欢“真正的”cpu 线程的原因之一。

# mono - ServiceStack 的序列化问题，然后是单声道 2.10.8.1 上的 SEGV

> ID：15349149
> 
> 赞同：1
> 
> 时间：2013-03-11T21:37:18.043
> 
> 标签：mono, servicestack, segmentation-fault

我在 Linux / mono 2.10.8.1 下运行服务堆栈，我似乎遇到了一些序列化问题，其中反序列化器正在寻找错误类的属性。然后在 EndpointHandlerBase 中出现空引用异常，最后我的进程因 SEGV 而死。这里有一些日志来说明：

ServiceStack.ServiceModel.Serialization.StringMapTypeDeserializer [(null)] - 'some.class' 类型上不存在属性'blah' ServiceStack.WebHost.Endpoints.Support.EndpointHandlerBase [(null)] - 处理请求时发生错误：对象引用未设置为 ServiceStack.WebHost.Endpoints.Utils.FilterAttributeCache.GetRequestFilterAttributes(System.Type requestDtoType) 处的对象实例 ...

在同一秒钟内，我得到一个杀死进程的 SEGV：被 SEGV 信号杀死的主进程（6469）

知道是什么原因造成的吗？我怀疑序列化映射正在被修改，可能是由于在重负载下进行了一些密集的垃圾收集。在单声道下运行时是否有其他人遇到相同的情况？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-10-12T18:10:40.640

解决方法是升级到更新的 Mono。Mono 3.x 中不会出现此问题。

# python - 如何将五个字符串写入一个文件

> ID：15349160
> 
> 赞同：0
> 
> 时间：2013-03-11T21:37:48.867
> 
> 标签：python, string, function

如何从每个字符串中收集多个字符串`print`作为一个函数写入另一个文件？（如果我的措辞正确）

这是我所拥有的：

```
 heart_max,heart_min = find_max_min (wanted_tuples, 0,1)
print ('Heart: {}  {:.1f}   {}   {:.1f}'.format(heart_min[1],heart_min[0],heart_max[1],heart_max[0]))

#
mv_max,mv_min = find_max_min (wanted_tuples, 0,2)
print ('Motor: {}  {:.1f} {}  {:.1f}'.format(mv_min[1],mv_min[0],mv_max[1],mv_max[0]))

#
birth_max,birth_min = find_max_min (wanted_tuples, 0,3)
print ('Birth:  {}   {:.1f}   {}  {:.1f}'.format(birth_min[1],birth_min[0],birth_max[1],birth_max[0]))

#
smoke_max,smoke_min = find_max_min (wanted_tuples, 0,4)
print ('Smoking: {}  {:.1f}   {}   {:.1f}'.format(smoke_min[1],smoke_min[0],smoke_max[1],smoke_max[0]))

#
ob_max,ob_min = find_max_min (wanted_tuples, 0,5)
print ('Obesity: {}   {:.1f}   {}   {:.1f}'.format(ob_min[1],ob_min[0],ob_max[1],ob_max[0])) 

outstring = {'Heart:'' {}  {:.1f}   {}  {:.1f}'.format(heart_min[1],heart_min[0],heart_max[1],heart_max[0])},
             'Motor:   {}  {:.1f}   {}  {:.1f}'.format(mv_min[1],mv_min[0],mv_max[1],mv_max[0])),
             'Birth:   {}  {:.1f}   {}  {:.1f}'.format(birth_min[1],birth_min[0],birth_max[1],birth_max[0])),
             'Smoking: {}  {:.1f}   {}  {:.1f}'.format(smoke_min[1],smoke_min[0],smoke_max[1],smoke_max[0])),
             'Obesity: {}  {:.1f}   {}  {:.1f}'.format(ob_min[1],ob_min[0],ob_max[1],ob_max[0]))} 
```

然后将结果写入这个文件

```
f_write = open('best_and_worst.txt', 'w') #creates the file
try:
    f_write.writelines(outstring)

finally:
        f_write.close() 
```

我像这样格式化字符串，以便在运行时可以使输出看起来像这样：

```
 Min                          Max 
Heart:        Minnesota                1.8          Missouri        26.4
Motor:        Washington               2.8          Colorado        34.6
Birth:        Ohio                     4.4          New York        43.2
Smoking:      Utah                     6.1          Ohio            44.3
Obesity:      Michigan                19.1          Mississippi     37.3 
```

我整个长程序运行良好，没有错误。只是出于某种原因，我对如何做到这一点持空白。任何帮助或指导表示赞赏。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-11T21:44:59.820

不要使用`print()`，只需将字符串存储在列表中并将字符串写入文件：

```
output = []

heart_max,heart_min = find_max_min (wanted_tuples, 0,1)
output.append('Heart: {}  {:.1f}   {}   {:.1f}'.format(heart_min[1],heart_min[0],heart_max[1],heart_max[0]))

mv_max,mv_min = find_max_min (wanted_tuples, 0,2)
output.append('Motor: {}  {:.1f} {}  {:.1f}'.format(mv_min[1],mv_min[0],mv_max[1],mv_max[0]))

# etc.

with open('best_and_worst.txt', 'w') as f_write:
    f_write.write('\n'.join(output)) 
```

# mysql - 在一个查询中（或以快速方式）从日期获取统计信息

> ID：15349162
> 
> 赞同：1
> 
> 时间：2013-03-11T21:37:50.667
> 
> 标签：mysql

我有一张表：`apns_devices`有列：`estado, modified, pid, etc.` 我想根据上次修改时间（即上周、上个月、昨天、今天和总数）获得一些统计信息。现在我正在为每个时期做一个查询（嵌套），例如：

```
SELECT t1.estado, t1.siempre, t2.hoy
FROM 
(SELECT *, COUNT(pid) as siempre FROM `apns_devices` GROUP BY estado) as t1
INNER JOIN 
(SELECT *, COUNT(pid) as hoy   FROM `apns_devices` WHERE DATE (modified) = CURRENT_DATE GROUP BY estado) as t2 
ON t1.estado = t2.estado 
```

*这是今天的总和*

为了加快脚本速度；¿ 我怎样才能在一个查询中做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-11T21:59:37.927

```
SELECT
  estado,
  COUNT(*) siempre,
  COUNT(CASE WHEN DATE(modified) = CURDATE() THEN 1 END) AS ModifiedToday,
  COUNT(CASE WHEN DATEDIFF(CURDATE(), modified) = 1 THEN 1 END) AS ModifiedYesterday,
  COUNT(CASE WHEN DATEDIFF(CURDATE(), modified) BETWEEN 2 AND 7 THEN 1 END) AS ModifiedLastWeek,
  COUNT(CASE WHEN DATEDIFF(CURDATE(), modified) BETWEEN 8 AND 30 THEN 1 END) AS ModifiedYesterMonth
FROM
  apns_devices
GROUP BY
  estado 
```

请[在此处](http://sqlfiddle.com/#!2/7f9e4/1)查看小提琴。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-11T21:46:21.750

试试这个查询

```
 SELECT distinct estado,  
(SELECT COUNT(pid) as hoy   FROM `apns_devices` WHERE estado = a.estado and DATE (modified) = CURRENT_DATE) AS ModifiedToday, 
(SELECT COUNT(pid) as hoy   FROM `apns_devices` WHERE estado = a.estado and CURRENT_DATE - DATE (modified) = 1) AS ModifiedYesterday, 
(SELECT COUNT(pid) as hoy   FROM `apns_devices` WHERE estado = a.estado and CURRENT_DATE - DATE (modified) BETWEEN 2 AND 8) AS ModifiedLastWeek, 
(SELECT COUNT(pid) as hoy   FROM `apns_devices` WHERE estado = a.estado and CURRENT_DATE - DATE (modified) BETWEEN 9 AND 30) AS ModifiedLastMonth 
FROM apns_devices a 
```

# java - Java中的绘图函数

> ID：15349165
> 
> 赞同：0
> 
> 时间：2013-03-11T21:38:09.910
> 
> 标签：java, graph, plot, graphics2d

我正在编写一个程序来绘制 [x(t),y(t)] 与变量 t 在一定范围内（由用户输入）。到目前为止，我已经创建了 3 个向量来保存 t、x(t) 和 y(t) 的值。我目前的方法是创建点向量（大约 1000 个点），然后在向量中的两个相邻点之间画一条线（或路径）。然而，结果并不如我所料。

来自用户的完整格式：

```
Plot [x(t),y(t)] x=a..b y=a..b t=a..b where a,b are the range of x,y,t 
```

例如，用户可以输入函数：

```
x(t) = 5*sin(3t + 5), t=-19..19
y(t) = 4*cos(2t), t=-19.19 
```

这是我的绘图代码：

```
public static void drawGraph(String sf, String sx, String sy, String st) {
  JFrame mygraph = new JFrame("PlotGraph v0.1");

  final Vector<Double> range_t = getRangeT(st); //get the range of t
  //create a corresponding vectors of x and y based on values of t
  final Vector<Double> range_x = getRangeX(range_t,funcX,var);
  final Vector<Double> range_y = getRangeY(range_t,funcY,var);

  //draw the graph to a JPanel, our graph is actually just a collection of points connecting 2 points
  mygraph.add(new JPanel() {

 public void paintComponent(Graphics g) {
          super.paintComponent(g);
          Graphics2D g2 = (Graphics2D) g;      g2.setRenderingHint(RenderingHints.KEY_ANTIALIASING,RenderingHints.VALUE_ANTIALIAS_ON);
          g2.setColor(Color.BLUE );
          g2.setStroke(new BasicStroke(1));
          GeneralPath gpx = new GeneralPath();
          GeneralPath gpy = new GeneralPath();
          for (int i=0; i<998; i++) {
            gpy.moveTo(range_t.get(i),range_y.get(i));
                  gpy.curveTo(range_t.get(i),range_y.get(i),range_t.get(i+1),range_y.get(i+1),range_t.get(i+2),range_y.get(i+2));
            gpx.moveTo(range_t.get(i),range_x.get(i));
            gpx.curveTo(range_t.get(i),range_x.get(i),range_t.get(i+1),range_x.get(i+1),range_t.get(i+2),range_x.get(i+2));

            //g2.draw(lineY);
            g2.draw(gpx);
            g2.draw(gpy);
          }
          g2.dispose(); 
        }
      });

  mygraph.setBounds(125,25,650,600);
  mygraph.setLocationRelativeTo(null);
  mygraph.setDefaultCloseOperation(mygraph.EXIT_ON_CLOSE);
  mygraph.setVisible(true);
} 
```

这是我从上面的 2 个函数中得到的： ![在此处输入图像描述](../Images/0248ea97b8977981ddec03d4ef9b68c1.png)

**问题：** **有什么办法可以让情节变得更好（按比例放大）？！**

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-11T22:01:18.827

在我看来，您在绘制参数方程时是错误的。

`t`对于参数方程，您应该从 t [min]迭代到 t [max]。在每个值处，计算 x(t) 和 y(t)，并在那里绘制一个点 - 在 (x(t), y(t))。

看起来您正在 (t, y(t)) 等处绘制点。您需要一个辅助函数来*评估*每个变量的用户输入函数，例如：

```
public double evaluateX(double t) { ... }
public double evaluateY(double t) { ... } 
```

在这些函数中，您必须将用户的文本解析为代码（可能是标记化？），然后对其进行评估。

然后，你可以有一个这样的循环：

```
GeneralPath gp = new GeneralPath();
double tstep = (tmax - tmin) / 998;
for (double t=tmin; t += tstep; t<tmax) {
    double x = evaluateX(t);
    double y = evaluateY(t);
    if (t == 0) {
        gp.moveTo(x, y);
    } else {
        gp.lineTo(x, y);
    }
}
g2d.draw(gp); 
```

从那里开始，比例因子应该很容易实现。尝试这样的事情：

```
GeneralPath gp = new GeneralPath();
final double scale = 3.0;
double tstep = (tmax - tmin) / 998;
for (double t=tmin; t += tstep; t<tmax) {
    double x = scale * evaluateX(t);
    double y = scale * evaluateY(t);
    if (t == 0) {
        gp.moveTo(x, y);
    } else {
        gp.lineTo(x, y);
    }
}
g2d.draw(gp); 
```

# jquery - 使用jquery隐藏表格行，简化功能

> ID：15349166
> 
> 赞同：2
> 
> 时间：2013-03-11T21:38:10.167
> 
> 标签：jquery

目前我正在尝试隐藏一些表格行并有一个切换链接，当点击链接时显示和隐藏它们。现在我已经让它工作了，但我想知道是否有一种更简单的方法可以使函数完全通用，而不是复制和粘贴一堆具有不同类名（或 ID）的相同代码。根据我对 JS/Jquery 的了解（这是我第一次做 JS/JQuery，我通常是后端开发人员）看起来使用表可能不是最明智的想法，但我正在修改原始代码。如果我必须使用表格以外的东西，我会重写它，但如果不可能，我只需要一些指导

```
<table>
    <tr>
        <th>Some stuff</th>
        <a href="#" class="hide link1">Show/Hide</a>
    </tr>
    <tr class="show hide row1">
        <th>Random data</th>
    </tr>
        <tr>
        <th>Some stuff2</th>
        <a href="#" class="hide link2">Show/Hide</a>
    </tr>
    <tr class="show hide row2">
        <th>Random data2</th>
    </tr>
        <tr>
        <th>Some stuff3</th>
        <a href="#" class="hide link3">Show/Hide</a>
    </tr>
    <tr class="show hide row3">
        <th>Random data3</th>
</table>

<script>
    $(".hide link1").click(function(){
        $(".show hide row 1").toggle(400)
    });
    $(".show hide row 2").hide()
    $(".hide link2").click(function(){
        $(".show hide row 2").toggle(400)
    });
    $(".show hide row 2").hide()
    $(".hide link3").click(function(){
        $(".show hide row3").toggle(400)
    });
    $(".show hide row3").hide()
</script> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-11T21:39:52.333

你可以遍历 DOM：

```
$(function() {
    $("table a.hide").click(function(e){
        e.preventDefault();
        $(this).closest('tr').next('tr.show').toggle(400);
    });
}); 
```

请注意，jQuery 选择器的工作方式类似于 CSS 选择器，因此您的选择器应该是：

```
$(".show.hide.row2").hide(); 
```

代替：

```
$(".show hide row 2").hide(); 
```

选择并隐藏伪元素`2`：

```
<tr class='show'>
   <hide>
       <row>
          <2>Come-on!</2>
       </row>
   </hide>
</tr> 
```

# ant - HSQLDB 用 ant 管理新的独立数据库 [Table Not Found In Statement]

> ID：15349168
> 
> 赞同：1
> 
> 时间：2013-03-11T21:38:21.290
> 
> 标签：ant, hsqldb

我打算使用 HSQLDB，我正在尝试使用 ant 的示例。

构建文件：

```
<target name="create.tables">
  <echo>Creating tables using: ${db.driver} ${db.url}</echo>
  <sql driver="${db.driver}"
      url="${db.url}"
      userid="${db.username}"
      password="${db.password}"
      onerror="continue"
      src="hsqldb/create_cars.sql">
      <classpath refid="hsqldb.database" />
  </sql>
</target>

<target name="load.data">
  <echo>Load Data Using: ${db.driver} ${db.url}</echo>
  <sql  driver="${db.driver}"
      url="${db.url}"
      userid="${db.username}"
      password="${db.password}"
      onerror="continue"
      src="hsqldb/load_data.sql">
      <classpath refid="hsqldb.database" />
  </sql>
</target> 
```

特性：

```
db.driver=org.hsqldb.jdbcDriver
db.url=jdbc:hsqldb:file:hsqldb/dbcars
db.username=sa
db.password= 
```

create_tables.sql：

```
CREATE TABLE cars (
     id INTEGER NOT NULL PRIMARY KEY,
     description VARCHAR(255)
) ; 
```

加载数据.sql：

```
INSERT INTO cars (id, description) VALUES (1, 'first car') ;
INSERT INTO cars (id, description) VALUES (2, 'second car') ; 
```

create.tables 目标有效，但 load.data 给出此错误：

```
[sql] java.sql.SQLException: Table not found in statement [ SELECT * FROM cars] 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-11T22:41:09.937

通常这是由与数据库的短时间连接引起的。表定义没有持久化，以后也找不到了。查看可以使用的连接属性列表：

[http://www.hsqldb.org/doc/2.0/guide/dbproperties-chapt.html](http://www.hsqldb.org/doc/2.0/guide/dbproperties-chapt.html)

然后试试这个：

```
db.driver=org.hsqldb.jdbcDriver
db.url=jdbc:hsqldb:file:hsqldb/dbcars;shutdown=true
db.username=sa
db.password= 
```

如果它不起作用，试试这个：

```
db.driver=org.hsqldb.jdbcDriver
db.url=jdbc:hsqldb:file:hsqldb/dbcars;hsqldb.write_delay=false
db.username=sa
db.password= 
```

# sql-server - 生成 6 位唯一编号

> ID：15349170
> 
> 赞同：3
> 
> 时间：2013-03-11T21:38:23.770
> 
> 标签：sql-server

**编辑：它将用作员工唯一编号（必须是随机顺序）**

我有一个有列的表

```
id(auto-increment), uniqueNumber, and some other field 
```

对于每条插入的记录，我想为 uniqueNumber 生成一个 6 位数的唯一编号，

现在我通过触发器得到这个

```
Create TRIGGER [dbo].[trgUniqueCode] ON [dbo].[testtable]
FOR INSERT
AS
declare @id int;
DECLARE @Upper INT
DECLARE @Lower INT
declare @result int
select @id=i.id from inserted i;
SET @Lower = 100000 
SET @Upper = (select top 1(isnull(UniqueNumber,999999)) from testtable) 
set @result =(ROUND(((@Upper - @Lower -1) * RAND() + @Lower), 0))
update testtable set UniqueNumber = @result where ID=@id 
```

我不确定这种方法是否有效，我正在寻找生成（优先时间执行）的最佳方法，或者我将在 C# 中生成唯一编号？？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-03-11T21:56:39.283

生成您*尚未*分配的所有号码的列表。打乱列表并创建一个包含随机 ID 和递增索引的新表。当你需要一个新的ID时，选择索引最小的那个；将其从未使用的 ID 表中删除，并将其作为您的新 ID 返回。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-11T21:46:32.820

您可以使用以下方法从 SQL Server 获取精确的 6 位长随机数：

```
SELECT CAST((RAND() * (899999) + 100000) as int) 
```

我使用以下代码使用随机生成的数字更新表中的字段：

第一部分是一个函数，每当向表中插入新行时都会调用该函数。

```
CREATE VIEW ViewRndNum
AS
SELECT CAST((RAND() * (899999) + 100000) as int);

CREATE FUNCTION [dbo].[GetID](@Counter int = 0)
RETURNS int
AS
BEGIN
    DECLARE @RandNumber as int;
    DECLARE @iEmployeeCode as int;
    DECLARE @iExistingEmployeeCode as int;

    IF (@Counter < 20) 
        BEGIN
        SELECT @iEmployeeCode = RndNum
                    FROM ViewRndNum;

        SELECT @iExistingEmployeeCode = EmployeeCode FROM dbo.Employees WHERE EmployeeCode = @iEmployeeCode
        IF @iExistingEmployeeCode = @iEmployeeCode 
            BEGIN
                SET @Counter = @Counter + 1
                SELECT @iEmployeeCode = [dbo].[GetID](@Counter)
            END
        END
    ELSE
        SET @iEmployeeCode = 99999999
RETURN @iEmployeeCode
END
GO

CREATE TABLE [dbo].[Employees](
    [ID] [bigint] IDENTITY(1,1) NOT NULL,
    [EmployeeType] [int] NULL,
    [EmployeeID] [bigint] NULL,
    [EmployeeCode] [int] NULL,
    [Employee] [varchar](max) NULL,
    [CreatedDate] [datetime] NULL,
    [LastSeen] [datetime] NULL,
 CONSTRAINT [PK_Employees] PRIMARY KEY CLUSTERED 
(
    [ID] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY] TEXTIMAGE_ON [PRIMARY]

GO

ALTER TABLE [dbo].[Employees] ADD  CONSTRAINT [DF_Employees_EmployeeCode]  DEFAULT ([dbo].[getID]((0))) FOR [EmployeeCode]
GO 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-03-11T21:43:09.863

事务处理 SQL：

```
select floor(rand()*1000000-1) 
```

C＃：

```
Random rnd = new Random();
int rslt = rnd.Next(100000, 999999); 
```

要生成唯一值，您最好的方法是增加一。产生独特价值的其他方式在计算上变得越来越低效。

此外，您可能想要使用散列函数，它们提供“几乎”唯一的值。但那是我不太熟悉的地方。

第三种选择是使用`GUID`s 作为唯一标识符。它们在计算上非常有效，并且即使跨越域边界也保证是唯一的。但是，它们大约有 80 个符号，而不仅仅是 6 个 :)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-03-11T21:48:58.547

*编辑*：糟糕，错过了“必须是随机顺序”的要求。对于那个很抱歉。

对此，我提出了一种完全不同的方法来解决这个问题。我认为您应该推迟“必须是随机的”业务要求。这是为了什么？

根据我的经验，这通常是因为经理不希望出现“鲍勃是在爱丽丝之后被雇用的，爱丽丝的员工 id 是 1987 年所以鲍勃的必须是 1988 年”这样的场景。我对此的回答是“那又怎样？”。知道 Bob 的员工 ID 不应该帮助攻击者 - 如果这样做，那么组织的安全性就会出现更大的问题。

在实施上述出色答案时需要考虑和尝试的事情。

*我原来的错误答案：*

为什么不使用自动增量字段？

在 SQL Server 中，按如下方式创建列。

```
create table dbo.Whatever (
    id int not null identity( 100000, 1 ) ,
    … 
```

您还应该创建一个主键约束或一个唯一约束来强制唯一性，以及可能创建一个检查约束来强制下限和上限（分别为 100000 和 999999）。

```
create table dbo.Whatever (
    id int not null identity( 100000, 1 ) 
        constraint id_u unique 
        constraint id_bounds check ( id between 100000 and 999999 ) ,
    … 
```

这绝对必须是6位数字吗？您可以按照其他地方的建议使用唯一标识符吗？NEWID() 函数意味着您不会遇到尝试同时为多个会话生成唯一编号的序列化问题。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2016-12-29T11:28:12.950

我在 SQL Server 2012 中使用以下代码创建了一个简单的订单表，其中 ODRID 是自定义格式的销售订单 ID。

```
CREATE TABLE [dbo].[OrderTransaction](
[OrderID] [bigint] IDENTITY(1,1) NOT NULL,
[ODRID]  AS (right('ES00000000'+CONVERT([nvarchar](10),[OrderID]),(11))),
[OrganisationID] [bigint] NOT NULL,
[SubTotal] [int] NOT NULL,
[Discount] [int] NOT NULL,
[TotalAmount] [bigint] NOT NULL,
[CreatedBy] [int] NULL,
[CreatedDate] [datetime] NULL,
[ModifieddBy] [int] NULL,
[ModifiedDate] [datetime] NULL,
CONSTRAINT [PK_OrderTransaction] PRIMARY KEY CLUSTERED 
(
[OrderID] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY] 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-03-11T21:44:11.787

C＃

```
Random rand = new Random();
int randomNumber = rand.Next(100000, 999999); 
```

在 SQL 中有点难：

[http://blogs.lessthandot.com/index.php/DataMgmt/DataDesign/sql-server-set-based-random-numbers](http://blogs.lessthandot.com/index.php/DataMgmt/DataDesign/sql-server-set-based-random-numbers)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2014-04-01T07:07:39.117

```
function random_numbers($digits,$id) {
$min = pow(10, $digits - 1);
$max = pow(10, $digits) - 1;
$number = mt_rand($min, $max);
$count = strlen($id);
$ssn_id = substr($number, $count);
$ssn_id = trim($id.$ssn_id);
return $ssn_id;
}

echo random_numbers(9,145); 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2018-10-10T10:37:16.390

用这个 -

```
DECLARE @NewPINGenerated Int = CONVERT(numeric(12,0),RAND() * 899999) + 100000
DECLARE @SMS VARCHAR(100)='Message Here '+CAST(@NewPINGenerated as varchar) 
```

# c++ - Visual Studio 2012 + qt + clang，可以吗？

> ID：15349175
> 
> 赞同：4
> 
> 时间：2013-03-11T21:38:51.727
> 
> 标签：c++, qt, visual-studio-2012, clang

是否真的可以使用 Visual Studio 作为 IDE，使用 Qt 作为框架库，使用 clang 作为内部编译器？

我不知道这是否真的可行，但这将确保我拥有最好的 IDE、最好的编译器和最好的 GUI 框架

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-03-11T21:42:43.163

有可能的。

集成 Qt 的 Visual Studio 插件：

[http://qt-project.org/forums/viewthread/23169](http://qt-project.org/forums/viewthread/23169)

允许使用 Clang C/C++ 编译器的 Visual Studio 插件：

[https://github.com/ishani/ClangVSx](https://github.com/ishani/ClangVSx)

# java - Java - 如何使用 Java Eclipse 编译单个文件

> ID：15349182
> 
> 赞同：6
> 
> 时间：2013-03-11T21:39:04.363
> 
> 标签：java, compilation, console

我正在尝试在 java 项目中编译一个文件，但我在控制台中看到了其他结果（另一个文件的结果）。我什至尝试过`Ctrl`+`F11`但同样的事情发生了

在 Java 的“运行”按钮的下拉列表中，我没有找到当前文件名，但如果我启动一个新项目并运行它正在编译的文件。注意：我是Java初学者。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-11T22:05:17.530

除了已选择的答案中的信息外，其他有此或类似问题的人应检查“运行配置”面板，以确保设置对于您正在启动的应用程序是正确的。查看

![运行配置](../Images/bf7b2be7dc92760b8e008822722c7ead.png)

![运行配置](../Images/98d27cfd49a56fe0caea6145ba99b5dc.png)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-11T21:44:28.723

你的类必须定义一个`public static void main(String[] args)`方法。然后在项目资源管理器中找到Java文件，右键单击它，选择“作为Java应用程序运行”。

# php - 如何在php类中引用数据库

> ID：15349184
> 
> 赞同：0
> 
> 时间：2013-03-11T21:39:07.477
> 
> 标签：php, mysql, class

```
$DB_HOST = "localhost";
$DB_NAME = "rawr";
$DB_USER = "rawr";
$DB_PASS = "hunter2!";
$tableprefix = "hunter_";
$mysqli = new mysqli($DB_HOST, $DB_USER, $DB_PASS, $DB_NAME);
if (mysqli_connect_errno()) {
    printf("Connect failed: %s\n", mysqli_connect_error());
    exit();
}
    class ACL
{.... 
```

我目前有，但我无法在我的所有 ACL 命令中使用该数据库连接。我怎样才能获得在课堂上使用该数据库连接的能力？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-11T21:44:55.790

您的 $mysqli 超出范围。你必须选择：

1）使用全局变量。

```
function XXXX () {
    global $mysqli;
    ...
} 
```

2）将其传递给构造函数（这样更好）

```
public function __construct($mysqli) {
    $this->_mysqli = $mysqli;
} 
```

然后在你的课堂上引用它`$this->_mysqli`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-11T21:42:52.870

当您实例化它时，您需要将该 mysqli 实例传递给您的 ACL 类。它不会自动知道在类声明之外声明的局部变量。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-11T21:45:24.910

确保您使用的连接处于正确的环境中。你可以这样做，例如`global`：

```
class ACL {
    function DoSomething() {
        global $mysqli;
        ...
    }
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-11T21:47:53.583

```
 class ACL {

       public function __construct() {
            $DB_HOST = "localhost";
            $DB_NAME = "rawr";
            $DB_USER = "rawr";
            $DB_PASS = "hunter2!";
            $tableprefix = "hunter_";
            $conn = new mysqli($DB_HOST, $DB_USER, $DB_PASS, $DB_NAME);
            if (mysqli_connect_errno()) {
                   printf("Connect failed: %s\n", mysqli_connect_error());
                   exit();
            } else {       
                   $this->conn = $conn;
            }
       }

       public function command1()
       {
            //use connection object as $this->conn 
            ///your code
       }
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-03-11T21:49:17.203

您可以将 mysqli 包装在一个类中，例如：

```
class database {
    // do database stuff here
} 
```

并扩展 ACL

```
class ACL extends database {
    // do acl stuff here with all your database stuff available
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-03-11T23:07:20.503

这是另一种方法。将您的数据库连接抽象为一个单独的实用程序类：

```
<?php
class DB
{
    const DB_HOST = "localhost";
    const DB_NAME = "rawr";
    const DB_USER = "rawr";
    const DB_PASS = "hunter2!";

    protected static $instance;
    public static function instance()
    {
        if (empty(self::$instance))
        {
            self::$instance = new mysqli(self::DB_HOST, self::DB_USER, self::DB_PASS, self::DB_NAME);
        }

        return self::$instance;
    }
} 
```

这不是控制反转，但数据库访问对于大多数应用程序来说非常重要，因此它可以非常安全地用作一种模式。

```
<?php

// Note: make sure DB class is loaded!

class ACL // Note: this doesn't extend DB!
{
    public function __construct()
    {
        // you can now access your $mysqli object with DB::instance()
    }
} 
```

# javafx-2 - JavaFX TableView 分页器

> ID：15349185
> 
> 赞同：14
> 
> 时间：2013-03-11T21:39:09.527
> 
> 标签：javafx-2, javafx

如何在 TableView 分页器中使用.?.例如...

```
public class SampleController implements Initializable {

    @FXML private TableView<Student> table;
    @FXML private TableColumn<Student, Integer> id;
    @FXML private TableColumn<Student, String> name;
    @FXML private ObservableList<Student> list = FXCollections.observableArrayList();
    //  @FXML private Pagination pagination;
    // 
    private StudentSQL ssql = new StudentSQL();
    private Stage stage = new Stage();
    private String row;

    @Override
    public void initialize(URL url, ResourceBundle rb) {
        id.setCellValueFactory(new PropertyValueFactory<Student, Integer>("id"));
        name.setCellValueFactory(new PropertyValueFactory<Student, String>("name"));
        list = ssql.students();
        table.setItems(list);
    }
} 
```

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2014-08-21T10:38:20.810

您必须使用[分页](http://docs.oracle.com/javase/8/javafx/api/javafx/scene/control/Pagination.html)控件并实现页面工厂。每个应该显示的页面都会调用该工厂，您可以使用其参数 pageIndex 为 TableView 提供项目的子列表：

```
TableView table = ...

private Node createPage(int pageIndex) {

    int fromIndex = pageIndex * rowsPerPage;
    int toIndex = Math.min(fromIndex + rowsPerPage, data.size());
    table.setItems(FXCollections.observableArrayList(data.subList(fromIndex, toIndex)));

    return new BorderPane(table);
}

@Override
public void start(final Stage stage) throws Exception {

    Pagination pagination = new Pagination((data.size() / rowsPerPage + 1), 0);
    pagination.setPageFactory(this::createPage);
    ...
} 
```

可以在此处找到完整的可运行示例： [https ://gist.github.com/timbuethe/7becdc4556225e7c5b7b](https://gist.github.com/timbuethe/7becdc4556225e7c5b7b)

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2013-03-11T22:15:16.043

这是一些将 TableView 与分页控件集成的示例代码。

该代码来自 Shakir Quasaroff 对 Oracle JavaFX 论坛请求 PaginatedTableView 控件的[回答](https://forums.oracle.com/forums/thread.jspa?threadID=2430373)。示例代码是纯 Java 解决方案，而不是原始问题中的 Java 代码/FXML 混合。

```
import java.util.List;
import javafx.application.Application;
import javafx.beans.property.SimpleStringProperty;
import javafx.collections.FXCollections;
import javafx.collections.ObservableList;
import javafx.scene.Scene;
import javafx.scene.control.Pagination;
import javafx.scene.Node;
import javafx.scene.control.TableColumn;
import javafx.scene.control.TableView;
import javafx.scene.control.TextArea;
import javafx.scene.control.cell.PropertyValueFactory;
import javafx.scene.layout.AnchorPane;
import javafx.scene.layout.VBox;
import javafx.stage.Stage;
import javafx.util.Callback;

public class TablePager extends Application {

    final ObservableList<Person> data = FXCollections.observableArrayList(
            new Person("1", "Joe", "Pesci"),
            new Person("2", "Audrey", "Hepburn"),
            new Person("3", "Gregory", "Peck"),
            new Person("4", "Cary", "Grant"),
            new Person("5", "De", "Niro"),
            new Person("6", "Katharine", "Hepburn"),
            new Person("7", "Jack", "Nicholson"),
            new Person("8", "Morgan", "Freeman"),
            new Person("9", "Elizabeth", "Taylor"),
            new Person("10", "Marcello", "Mastroianni"),
            new Person("11", "Innokenty", "Smoktunovsky"),
            new Person("12", "Sophia", "Loren"),
            new Person("13", "Alexander", "Kalyagin"),
            new Person("14", "Peter", "OToole"),
            new Person("15", "Gene", "Wilder"),
            new Person("16", "Evgeny", "Evstegneev"),
            new Person("17", "Michael", "Caine"),
            new Person("18", "Jean-Paul", "Belmondo"),
            new Person("19", " Julia", "Roberts"),
            new Person("20", "James", "Stewart"),
            new Person("21", "Sandra", "Bullock"),
            new Person("22", "Paul", "Newman"),
            new Person("23", "Oleg", "Tabakov"),
            new Person("24", "Mary", "Steenburgen"),
            new Person("25", "Jackie", "Chan"),
            new Person("26", "Rodney", "Dangerfield"),
            new Person("27", "Betty", "White"),
            new Person("28", "Eddie", "Murphy"),
            new Person("29", "Amitabh", "Bachchan"),
            new Person("30", "Nicole", "Kidman"),
            new Person("31", "Adriano", "Celentano"),
            new Person("32", "Rhonda", " Fleming's"),
            new Person("32", "Humphrey", "Bogart"));
    private Pagination pagination;

    public static void main(String[] args) throws Exception {
        launch(args);
    }

    public int itemsPerPage() {
        return 1;
    }

    public int rowsPerPage() {
        return 5;
    }

    public VBox createPage(int pageIndex) {
        int lastIndex = 0;
        int displace = data.size() % rowsPerPage();
        if (displace > 0) {
            lastIndex = data.size() / rowsPerPage();
        } else {
            lastIndex = data.size() / rowsPerPage() - 1;

        }

        VBox box = new VBox(5);
        int page = pageIndex * itemsPerPage();

        for (int i = page; i < page + itemsPerPage(); i++) {
            TableView<Person> table = new TableView<Person>();
            TableColumn numCol = new TableColumn("ID");
            numCol.setCellValueFactory(
                    new PropertyValueFactory<Person, String>("num"));

            numCol.setMinWidth(20);

            TableColumn firstNameCol = new TableColumn("First Name");
            firstNameCol.setCellValueFactory(
                    new PropertyValueFactory<Person, String>("firstName"));

            firstNameCol.setMinWidth(160);

            TableColumn lastNameCol = new TableColumn("Last Name");
            lastNameCol.setCellValueFactory(
                    new PropertyValueFactory<Person, String>("lastName"));

            lastNameCol.setMinWidth(160);

            table.getColumns().addAll(numCol, firstNameCol, lastNameCol);
            if (lastIndex == pageIndex) {
                table.setItems(FXCollections.observableArrayList(data.subList(pageIndex * rowsPerPage(), pageIndex * rowsPerPage() + displace)));
            } else {
                table.setItems(FXCollections.observableArrayList(data.subList(pageIndex * rowsPerPage(), pageIndex * rowsPerPage() + rowsPerPage())));
            }

            box.getChildren().add(table);
        }
        return box;
    }

    @Override
    public void start(final Stage stage) throws Exception {

        pagination = new Pagination((data.size() / rowsPerPage() + 1), 0);
        //   pagination = new Pagination(20 , 0);
        pagination.setStyle("-fx-border-color:red;");
        pagination.setPageFactory(new Callback<Integer, Node>() {
            @Override
            public Node call(Integer pageIndex) {
                if (pageIndex > data.size() / rowsPerPage() + 1) {
                    return null;
                } else {
                    return createPage(pageIndex);
                }
            }
        });

        AnchorPane anchor = new AnchorPane();
        AnchorPane.setTopAnchor(pagination, 10.0);
        AnchorPane.setRightAnchor(pagination, 10.0);
        AnchorPane.setBottomAnchor(pagination, 10.0);
        AnchorPane.setLeftAnchor(pagination, 10.0);
        anchor.getChildren().addAll(pagination);
        Scene scene = new Scene(anchor, 400, 250);
        stage.setScene(scene);
        stage.setTitle("Table pager");
        stage.show();
    }

    public static class Person {

        private final SimpleStringProperty num;
        private final SimpleStringProperty firstName;
        private final SimpleStringProperty lastName;

        private Person(String id, String fName, String lName) {
            this.firstName = new SimpleStringProperty(fName);
            this.lastName = new SimpleStringProperty(lName);
            this.num = new SimpleStringProperty(id);
        }

        public String getFirstName() {
            return firstName.get();
        }

        public void setFirstName(String fName) {
            firstName.set(fName);
        }

        public String getLastName() {
            return lastName.get();
        }

        public void setLastName(String fName) {
            lastName.set(fName);
        }

        public String getNum() {
            return num.get();
        }

        public void setNum(String id) {
            num.set(id);
        }
    }
} 
```

示例程序输出：

![桌面寻呼机](../Images/7b10ed61e36a5e9e43b54067beeb7257.png)

* * *

此外，Panemu 的第三方 lgpl 许可[TiwulFX 库](http://tiwulfx.panemu.com/)为 TableView 提供了高级功能（包括分页）。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2015-11-04T09:55:04.167

在测试该线程上生成的分页代码时，我发现了一个小问题。当数据的大小 == 到页面中设置的行数时，会发生混乱（页面内）。在这种情况下，会创建一个额外的（空白）页面，并且数据拒绝显示在任何页面上。我相信以下代码段应该可以解决该问题（如果其他人遇到与我相同的问题）。这个片段应该在声明 Pagination 变量之前出现。

```
int numOfPages = 1;
if (data.size() % rowsPerPage == 0) {
  numOfPages = data.size() / rowsPerPage;
} else if (data.size() > rowsPerPage) {
  numOfPages = data.size() / rowsPerPage + 1;
}
Pagination pagination = new Pagination((numOfPages), 0);
pagination.setPageFactory(this::createPage); 
```

希望能帮助到你！

# google-apps-script - 谷歌应用程序脚本 - 编辑后比较范围的初始值

> ID：15349186
> 
> 赞同：0
> 
> 时间：2013-03-11T21:39:14.953
> 
> 标签：google-apps-script

我对 Google Apps Script/Javascript 很陌生，所以这可能是一个非常简单的答案。当电子表格中的某些单元格值发生更改时，我正在尝试发送几封电子邮件。下面是我的工作代码。我已将此设置为运行 onEdit。但是，每当修改工作表上的单元格时，它都会发送更新，而我只想在修改某些单元格（余额）时发送一封电子邮件。

```
function sendUpdate() {
var recipients=["User1@gmail.com","User2@email.com"];
  var sheet = SpreadsheetApp.getActiveSheet();
  // Get the range of cells that store balances
  var sslink = SpreadsheetApp.getActiveSpreadsheet().getUrl()
  var Balances = sheet.getRange("A28:C31").getValues();
  var User1Balance = Balances[2][2];
  var User2Balance = Balances[3][2]
  var User3Balance = Balances[0][2]
  var User4Balance = Balances[1][2]
  for (var i = 0; i < 2; i++) {

   GmailApp.sendEmail(recipients[i],
                     'Utilities Spreadsheet updated',
                      "This is an automated email generated from the utilities spreadsheet being updated. " +
                      "Current balances are: " +
                      "\n\n User1: " + User1Balance + "\n User2: " + User2Balance + "\n User3: " + User3Balance + "\n User4: " + User4Balance +
                      "\n\n Access the spreadsheet at: " + sslink);

  }
}; 
```

我尝试使用 onOpen 函数读取初始值，然后在每次编辑工作表时比较这些值。但是，我在将初始数据传递到上面的主函数时遇到了一些问题。任何关于如何去做的建议都会很棒。我认为使用全局变量会很容易，但不确定这是否可能。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-11T22:02:15.087

您建议的方法有点复杂，为什么不简单地检查编辑的单元格是否包含在您的余额范围内？

`getRow()`您可以使用and获取 rowIndex 和 columnIndex`getColumn()`并简单地检查这些值以查看活动单元格（正在修改的单元格）是否在此范围内。

可能是这样的吗？

```
function sendUpdate() {
var recipients=["User1@gmail.com","User2@email.com"];
  var sheet = SpreadsheetApp.getActiveSheet();
  // Get the range of cells that store balances
  var sslink = SpreadsheetApp.getActiveSpreadsheet().getUrl()
  var Balances = sheet.getRange("A28:C31").getValues();
  var User1Balance = Balances[2][2];
  var User2Balance = Balances[3][2]
  var User3Balance = Balances[0][2]
  var User4Balance = Balances[1][2]
  for (var i = 0; i < 2; i++) {
   var row = sheet.getActiveCell().getRow();
   var col = sheet.getActiveCell().getColumn();
    if(row>=28 && row<=31 && col<=3){

     GmailApp.sendEmail(recipients[i],
                     'Utilities Spreadsheet updated',
                      "This is an automated email generated from the utilities spreadsheet being updated. " +
                      "Current balances are: " +
                      "\n\n User1: " + User1Balance + "\n User2: " + User2Balance + "\n User3: " + User3Balance + "\n User4: " + User4Balance +
                      "\n\n Access the spreadsheet at: " + sslink);

    }
  }
}; 
```

注意：我没有测试，但这个想法似乎是有效的......

至于另一种方法，没有直接的方法可以在函数执行脚本期间使用全局变量（在所有函数之外定义）进行更新。当函数执行时，它们将保留它们的值。但是，您可以使用“永久存储”来存储值来实现相同的行为，例如使用 scriptProperties。由于您的平衡范围不是太大，这可能很容易实现......但仍然比我建议的第一个解决方案复杂得多。如果您想这样做，请在需要时随时寻求帮助。

# amazon-web-services - 如何从 AutoScaling 获取所有 EC2 实例 ID？

> ID：15349187
> 
> 赞同：4
> 
> 时间：2013-03-11T21:39:16.337
> 
> 标签：amazon-web-services, amazon-ec2, autoscaling, amazon-cloudformation

所以我有一个带有 3 种不同实例“类型”（服务器、代理、中继）的 AWS CloudFormation 模板

我正在使用 AutoScaling 动态启动 X 个类型的实例。

我的问题是我需要模板输出中的所有这些服务器的 IP，最好分类为部分。

IE

服务器：xxxx yyyy

继电器：zzzz

代理商：aaaa

如何从输出中获取实例 ID？（我可以从 ID 中获取 IP）

附件模板：

```
{
"AWSTemplateFormatVersion" : "2010-09-09",

"Description" : "uDeploy Agent-Relay-Server",

"Parameters" : {
    "keyName" : {
        "Description" : "SSH key to enable access on the servers",
        "Type" : "String",
        "Default" : "nick-portal"
    },

    "ServerInstanceCount" : {
        "Description" : "Number of Servers to start",
        "Type" : "Number",
        "Default" : "1"
    },
    "RelayInstanceCount" : {
        "Description" : "Number of Agent Relays to start",
        "Type" : "Number",
        "Default" : "2"
    },
    "AgentInstanceCount" : {
        "Description" : "Number of Agents to start",
        "Type" : "Number",
        "Default" : "4"
    },

    "ServerAMI" : {
        "Description" : "",
        "Type" : "String",
        "Default" : "ami-7539b41c"
    },
    "RelayAMI" : {
        "Description" : "",
        "Type" : "String",
        "Default" : "ami-7539b41c"
    },
    "AgentAMI" : {
        "Description" : "",
        "Type" : "String",
        "Default" : "ami-7539b41c"
    },

    "ServerUserData" : {
        "Description" : "",
        "Type" : "String",
        "Default" : "#!/bin/bash"
    },
    "RelayUserData" : {
        "Description" : "",
        "Type" : "String",
        "Default" : "#!/bin/bash"
    },
    "AgentUserData" : {
        "Description" : "",
        "Type" : "String",
        "Default" : "#!/bin/bash"
    },
    "Zone" : {
        "Description" : "",
        "Type" : "String",
        "Default" : "us-east-1d"
    }
},

"Resources" : {
    "ServerLaunchConfig" : { 
        "Type" : "AWS::AutoScaling::LaunchConfiguration",
        "Properties" : {
            "KeyName" : { "Ref" : "keyName" },
            "ImageId" : { "Ref" : "ServerAMI" },
            "UserData" : { "Fn::Base64" : { "Ref" : "ServerUserData" } },
            "SecurityGroups" : [ { "Ref" : "ServerSecurityGroup" }, { "Ref" : "SshSecurityGroup" } ],
            "InstanceType" : "t1.micro"
        }
    },
    "RelayLaunchConfig" : { 
        "Type" : "AWS::AutoScaling::LaunchConfiguration",
        "Properties" : {
            "KeyName" : { "Ref" : "keyName" },
            "ImageId" : { "Ref" : "RelayAMI" },
            "UserData" : { "Fn::Base64" : { "Ref" : "RelayUserData" } },
            "SecurityGroups" : [ { "Ref" : "RelaySecurityGroup" }, { "Ref" : "SshSecurityGroup" } ],
            "InstanceType" : "t1.micro"
        }
    },
    "AgentLaunchConfig" : { 
        "Type" : "AWS::AutoScaling::LaunchConfiguration",
        "Properties" : {
            "KeyName" : { "Ref" : "keyName" },
            "ImageId" : { "Ref" : "AgentAMI" },
            "UserData" : { "Fn::Base64" : { "Ref" : "AgentUserData" } },
            "SecurityGroups" : [ { "Ref" : "AgentSecurityGroup" }, { "Ref" : "SshSecurityGroup" } ],
            "InstanceType" : "t1.micro"
        }
    },

    "ServerAutoScalingGroup" : {
        "Type" : "AWS::AutoScaling::AutoScalingGroup",
        "Properties" : {
            "AvailabilityZones" : [ { "Ref" : "Zone" } ],
            "LaunchConfigurationName" : { "Ref" : "ServerLaunchConfig" },
            "MinSize" : { "Ref" : "ServerInstanceCount" },
            "MaxSize" : { "Ref" : "ServerInstanceCount" }
        }
    },
    "RelayAutoScalingGroup" : {
        "Type" : "AWS::AutoScaling::AutoScalingGroup",
        "Properties" : {
            "AvailabilityZones" : [ { "Ref" : "Zone" } ],
            "LaunchConfigurationName" : { "Ref" : "RelayLaunchConfig" },
            "MinSize" : { "Ref" : "RelayInstanceCount" },
            "MaxSize" : { "Ref" : "RelayInstanceCount" }
        }
    },
    "AgentAutoScalingGroup" : {
        "Type" : "AWS::AutoScaling::AutoScalingGroup",
        "Properties" : {
            "AvailabilityZones" : [ { "Ref" : "Zone" } ],
            "LaunchConfigurationName" : { "Ref" : "AgentLaunchConfig" },
            "MinSize" : { "Ref" : "AgentInstanceCount" },
            "MaxSize" : { "Ref" : "AgentInstanceCount" }
        }
    },

    "RelaySecurityGroup" : {
        "Type" : "AWS::EC2::SecurityGroup",
        "Properties" : {
            "GroupDescription" : "Enable inbound 20080 and 7916 from Agents",
            "SecurityGroupIngress" : 
            [
                { 
                    "IpProtocol" : "tcp", 
                    "FromPort" : "20080", 
                    "ToPort" : "20080", 
                    "SourceSecurityGroupName" : { "Ref" : "AgentSecurityGroup" } 
                },
                { 
                    "IpProtocol" : "tcp", 
                    "FromPort" : "7916", 
                    "ToPort" : "7916", 
                    "SourceSecurityGroupName" : { "Ref" : "AgentSecurityGroup" } 
                }
            ]
        }
    },
    "ServerSecurityGroup" : {
        "Type" : "AWS::EC2::SecurityGroup",
        "Properties" : {
            "GroupDescription" : "Enable inbound 8080 all and 7918 from Relays",
            "SecurityGroupIngress" : [
                { 
                    "IpProtocol" : "tcp", 
                    "FromPort" : "7918", 
                    "ToPort" : "7918", 
                    "SourceSecurityGroupName" : { "Ref" : "RelaySecurityGroup" } 
                },
                { 
                    "IpProtocol" : "tcp", 
                    "FromPort" : "8080", 
                    "ToPort" : "8080", 
                    "CidrIp" : "0.0.0.0/0" 
                }
            ]
        }
    },
    "AgentSecurityGroup" : {
        "Type" : "AWS::EC2::SecurityGroup",
        "Properties" : {
            "GroupDescription" : "Enable no inbound",
            "SecurityGroupIngress" : []
        }
    },
    "SshSecurityGroup" : {
        "Type" : "AWS::EC2::SecurityGroup",
        "Properties" : {
            "GroupDescription" : "Enable SSH from all",
            "SecurityGroupIngress" : [
                {
                    "IpProtocol" : "tcp",
                    "FromPort" : "22",
                    "ToPort" : "22",
                    "CidrIp" : "0.0.0.0/0"
                }
            ]
        }
    }

},

"Outputs" : {
    "Ip"
}
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2014-01-17T22:28:54.033

不，您不能将输出设置为 ips。云形成负责自动扩展组和自动扩展启动配置，但它无法控制单个 EC2 实例，因此您无法将信息从它们获取到输出中。

您可以编写一些在启动时在 EC2 实例上运行的东西，以在堆栈上设置一个带有 ip 值的标签。但是当实例终止时，这可能会变得难以维护。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2014-09-26T17:43:20.140

在 bash 上并使用 AWS CLI 实用程序，您可以执行以下操作：

```
#!/bin/bash
AUTOSCALING_GROUP="mygroup"
aws ec2 describe-instances --filters \
  "Name=tag:aws:autoscaling:groupName,Values=$AUTOSCALING_GROUP" \
  "Name=instance-state-name,Values=running" | \
grep -o '\"i-[0-9a-f]\\+\"' | grep -o '[^\"]\\+' 
```

这将输出 'mygroup' Auto Scaling 组中所有机器的实例 ID，每行一个。

# mysql - MYSQL Left Join COUNTS 来自多个表

> ID：15349189
> 
> 赞同：43
> 
> 时间：2013-03-11T21:39:24.107
> 
> 标签：mysql, count, left-join

我想添加代表其他表计数的列。

我有 3 张桌子。

**留言**

```
MessageID    User      Message      Topic
1            Tom       Hi           ball
2            John      Hey          book
3            Mike      Sup          book
4            Mike      Ok           book 
```

**话题**

```
Topic      Title     Category1    Category2
ball       Sports    Action       Hot
book       School    Study        Hot 
```

**Stars_Given**

```
starID     Topic
1          ball
2          book
3          book
4          book 
```

我想结束：

**Topic_Review**

```
Topic    Title     StarCount    UserCount    MessageCount
ball     Sports    1            1            1
book     school    3            2            3 
```

所以基本上我想附加 3 列，其中包含唯一值的计数（每个主题中给出的星数、在主题中拥有消息的唯一用户以及每个主题中唯一消息的数量）。

我希望最终也能够过滤类别（查看两列）。

另外，我想最终按我加入的计数进行排序。例如，我将有一个按钮，按升序按“星数”排序，或按降序按“用户数”排序，等等。

我尝试过调整其他人的答案，但我无法让它正常工作。

* * *

## 回答 #1

> 赞同：118
> 
> 时间：2013-03-11T21:42:41.700

```
select
  t.Topic,
  t.Title,
  count(distinct s.starID) as StarCount,
  count(distinct m.User) as UserCount,
  count(distinct m.messageID) as MessageCount
from
  Topics t
  left join Messages m ON m.Topic = t.Topic
  left join Stars_Given s ON s.Topic = t.Topic
group by
  t.Topic,
  t.Title 
```

## [Sql 小提琴](http://sqlfiddle.com/#!2/3cf96/2)

或者，您可以在子查询中执行聚合，如果表中有大量数据，这可能会更有效：

```
select
  t.Topic,
  t.Title,
  s.StarCount,
  m.UserCount,
  m.MessageCount
from
  Topics t
  left join (
    select 
      Topic, 
      count(distinct User) as UserCount,
      count(*) as MessageCount
    from Messages
    group by Topic
  ) m ON m.Topic = t.Topic
  left join (
    select
      Topic, 
      count(*) as StarCount
    from Stars_Given 
    group by Topic
  ) s ON s.Topic = t.Topic 
```

## [Sql 小提琴](http://sqlfiddle.com/#!2/3cf96/5)

# c - 如何在 C 中为两个 for 循环编写 SSE 指令？

> ID：15349191
> 
> 赞同：1
> 
> 时间：2013-03-11T21:39:27.903
> 
> 标签：c, for-loop, sse, vectorization

使用库“immintrin.h”，我可以为简单的循环和操作编写 SSE 指令。但是，如何为所示语句编写 SSE 指令？

```
for (int i =0; i<n; i++){
   for (int j=0; j<n; j++) {
     x[i] += a[i] + a[j];
}} 
```

x 和 a 是使用 _mm_malloc() 初始化的 float*。内存访问模式可用作 __m128 和 4 字节的展开策略。

对不起，如果我不太清楚，但就像

```
for (int i = 0; i < vecsize; i+=4) {
        __m128 a  = _mm_load_ps(a+i);
        __m128 x  = _mm_add_ps(x,a);
        _mm_store_ps(x+i, x);
    } 
```

（仅适用于 1 个循环），我想要上面显示的循环类似的东西。

编辑：我（EricPostpischil）正在从评论中注入此文本，因为它对问题陈述很**重要。**作者 NeilDA 应该对此进行扩展：

> **......在我的程序中'a'总是在变化，因此我想要'x'随之变化。**

**我已经成功了！我提交了答案..**

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-11T22:52:39.470

这只是部分答案，但对于评论来说太长/太详细了。

我怀疑你的问题是否写得正确。如图所示，对于 each `x[i]`，它相加`a[i]` *n*次，每个相加`a[j]`一次，对于 0≤<em>j< *n*。所以它相当于：

```
sum = 0;
for (j = 0; j < n; ++j)
    sum += a[j];
for (i = 0; i < n; ++i)
    x[i] += n*a[i] + sum; 
```

这将使用比其他可能的数组操作更简单的 SSE 代码来实现。当然，像上面那样简单地重写它会产生比原始公式更快的代码。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-12T02:02:05.527

```
__m128 x_v, a_v, aj_v;
for (int i = 0; i < (vec_size); i+=4) {
            x_v = _mm_load_ps(x + i);
            a_v = _mm_load_ps(a+i);
        for (int j = 0; j < N; j++) {
            aj_v = _mm_set1_ps(a[j]);
            x_v = _mm_add_ps(x_v, _mm_add_ps(aj_v, a_v));
        }
            _mm_store_ps(x + i, x_v);
    } 
```

**我不知道它是否可以进一步改进，但这将我的时间从 0.17 秒减少到 0.04 秒：D 任何改进它的评论或方法都会很棒！**

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-11T23:44:29.063

转换：

```
 for (i = 0; i < n; i++)
        for (j = 0; j < n; j++)
            x[i] += a[i] + a[j]; 
```

进入：

```
 for (i = 0; i < n; i++)
        x[i] += n*a[i] + sum(a)); 
```

请参阅`f_sse()`下面的代码：

```
#include <stdio.h>
#include <string.h>
#include <immintrin.h>

enum {
    N = 4,
};

float x[N], a[N] = { .1, .2, .3, .4 }, y[N];

void f(float *x, float *a, int n)
{
    int i, j;
    for (i = 0; i < n; i++)
        for (j = 0; j < n; j++)
            x[i] += a[i] + a[j];
}

float array_sum(float *a, int n)
{
    /* could be vectorized as well */
    int i;
    float s;
    for (s = 0, i = 0; i < n; i++)
        s += a[i];
    return s;
}

void f_sse(float *x, float *a, int n)
{
    int i, l;
    float t;
    __m128 sum_a, n_vec;
    t = array_sum(a, n);
    sum_a = _mm_set1_ps(t);
    n_vec = _mm_set1_ps(n);
    l = n / 4;
    for (i = 0; i < l; i += 4) {
        __m128 ai, xi;
        ai = _mm_load_ps(a + i);
        xi = _mm_load_ps(x + i);
        ai = _mm_mul_ps(ai, n_vec);
        ai = _mm_add_ps(ai, sum_a);
        xi = _mm_add_ps(xi, ai);
        _mm_store_ps(x + i, xi);
    }
}

int main()
{
    int i, r;
    f(x, a, N);
    f_sse(y, a, N);
    r = memcmp(x, y, N);
    if (r == 0)
        return 0;
    printf("x: { ");
    for (i = 0; i < N; i++)
        printf("%f, ", x[i]);
    printf("}\n");
    printf("y: { ");
    for (i = 0; i < N; i++)
        printf("%f, ", y[i]);
    printf("}\n");
    return 3;
} 
```

由于您声明`a`正在同时更新并且您不能进行上面的循环转换。您需要有意识地决定何时从`a`. 它永远不会匹配原始的非矢量化版本，因为我们一次加载 4 个浮点数。

`a[j]`在内循环中重新加载：

```
void f_sse(float *x, float *a, int n)
{
    int i, j, l;
    l = n / 4;
    for (i = 0; i < l; i += 4) {
        __m128 ai, xi;
        ai = _mm_load_ps(a + i);
        xi = _mm_load_ps(x + i);
        for (j = 0; j < n; j++) {
            /* re-load a[j] to get updates */
            xi = _mm_add_ps(xi, _mm_add_ps(ai, _mm_set1_ps(((volatile float *)a)[j])));
        }
        _mm_store_ps(x + i, xi);
    } 
```

}

重新加载`a[j]`并`(a + i)`在内循环中：

```
void f_sse(float *x, float *a, int n)
{
    int i, j, l;
    l = n / 4;
    for (i = 0; i < l; i += 4) {
        __m128 ai, xi;
        xi = _mm_load_ps(x + i);
        for (j = 0; j < n; j++) {
            /* re-load (a + i) to get updates */
            ai = _mm_load_ps(a + i);
            /* re-load a[j] to get updates */
            xi = _mm_add_ps(xi, _mm_add_ps(ai, _mm_set1_ps(((volatile float *)a)[j])));
        }
        _mm_store_ps(x + i, xi);
    }
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-11T22:58:19.047

```
__m128 *mx = (__m128*)x;
__m128 *ma = (__m128*)a;
__m128 temp_a;

for (int i = 0; i < (n>>2); ++i) {
    for (int j = 0; j < (n>>2); ++j) {
        temp_a = _mm_add_ps(*(ma+i), *(ma+j));
        *mx = _mm_add_ps(*mx, temp_a);
    }
    mx++;
} 
```

当然，您必须确保它`n`是 4 的倍数，并确保 x 初始化为 0，以便累积正确。

# php - Codeigniter Textarea 的 jQuery 最小字符计数器

> ID：15349192
> 
> 赞同：0
> 
> 时间：2013-03-11T21:39:27.903
> 
> 标签：php, jquery, codeigniter, character, counter

我正在努力获得与 CI / jQuery 一起使用的最小字符计数器。如果用户输入的字符太少，我希望能够阻止表单提交并显示警报。表单只是使用以下代码正常提交：

```
function checktextarea(minLength) {

  var textarea = jQuery('#field').value.length;
     if(textarea < minLength) {
        e.preventDefault();
        alert('You need to enter at least ' + minLength ' + characters');
        return false;
     }
}; 
```

在 CI 中，我有：

```
<?php $attributes = array ('onsubmit' => 'checktextarea(15)'); ?>
<?php echo form_open('controller/function', $attributes); ?>

// I know this is standard HTML
  <textarea name="content" class="textarea_css" rows="10" cols="73" id="field"></textarea>

<?php echo form_submit('send', 'Submit Your Textarea'); ?>
<?php echo form_close(); ?> 
```

非常感谢您的帮助！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-11T22:25:13.250

您有一个对`e`var 的引用，它不在您的函数范围内。我假设您正在尝试取消事件，但您应该在父函数中执行此操作。

该行`e.preventDefault();`导致编译错误。

接下来，您正在不正确地访问文本区域的值，请尝试`jQuery('#field').val().length;`.

最后，该行`alert('You need to enter at least ' + minLength ' + characters');`格式错误，应为`alert('You need to enter at least ' + minLength + ' characters');`

添加了一个小提琴，只是为了好玩和证明：http: [//jsfiddle.net/TSbK8/7/](http://jsfiddle.net/TSbK8/7/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-11T21:42:25.500

你的 jQuery 语句得到的长度不太正确。而不是`var textarea = jQuery('#field').value.length;`尝试`var textarea = jQuery('#field').val().length;`。

# css - Spritesheet PNG显示在现场网站的不同位置

> ID：15349194
> 
> 赞同：1
> 
> 时间：2013-03-11T21:39:29.343
> 
> 标签：css, png, scaling, sprite-sheet

由于某种原因，我的实时网站上的图像（来自精灵表）与本地版本的位置不同。这让我疯狂！在检查元素时，似乎精灵表在活动时的缩放比例略有不同，这使图像比我想要的更右移动。任何想法为什么？

提前谢谢了！

的HTML：

```
 <div id="icon-container">
 <div class="icon">
    <a class="stretchy">
                    <img class="spacer" alt="icon" src="images/assets/spacer.png">
                    <img class="sprite s" alt="" src="images/assets/spritesheet.png">
    </a>            
    <a class="stretchy">
                    <img class="spacer" alt="icon" src="images/assets/spacer.png">
                    <img class="sprite s2" alt="" src="images/assets/spritesheet.png">
    </a>            
    <a class="stretchy">
                    <img class="spacer" alt="icon" src="images/assets/spacer.png">
                    <img class="sprite s3" alt="" src="images/assets/spritesheet.png">
    </a>    
    <a class="stretchy">
                    <img class="spacer" alt="icon" src="images/assets/spacer.png">
                    <img class="sprite s4" alt="" src="images/assets/spritesheet.png">
    </a>            
    <a class="stretchy">
                    <img class="spacer" alt="icon" src="images/assets/spacer.png">
                    <img class="sprite s5" alt="" src="images/assets/spritesheet.png">
    </a>    
    <a class="stretchy">
                    <img class="spacer" alt="icon" src="images/assets/spacer.png">
                    <img class="sprite s6" alt="" src="images/assets/spritesheet.png">
    </a>            
    <a class="stretchy">
                    <img class="spacer" alt="icon" src="images/assets/spacer.png">
                    <img class="sprite s7" alt="" src="images/assets/spritesheet.png">
    </a>            
    <a class="stretchy">
                    <img class="spacer" alt="icon" src="images/assets/spacer.png">
                    <img class="sprite s8" alt="" src="images/assets/spritesheet.png">
    </a>    
    <a class="stretchy">
                    <img class="spacer" alt="icon" src="images/assets/spacer.png">
                    <img class="sprite s9" alt="" src="images/assets/spritesheet.png">
    </a>            
    <a class="stretchy">
                    <img class="spacer" alt="icon" src="images/assets/spacer.png">
                    <img class="sprite s10" alt="" src="images/assets/spritesheet.png">
    </a>        
    <a class="stretchy">
                    <img class="spacer" alt="icon" src="images/assets/spacer.png">
                    <img class="sprite s11" alt="" src="images/assets/spritesheet.png">
    </a>            
    <a class="stretchy">
                    <img class="spacer" alt="icon" src="images/assets/spacer.png">
                    <img class="sprite s12" alt="" src="images/assets/spritesheet.png">
    </a>            
    <a class="stretchy">
                    <img class="spacer" alt="icon" src="images/assets/spacer.png">
                    <img class="sprite s13" alt="" src="images/assets/spritesheet.png">
    </a>    
    <a class="stretchy">
                    <img class="spacer" alt="icon" src="images/assets/spacer.png">
                    <img class="sprite s14" alt="" src="images/assets/spritesheet.png">
    </a>            
    <a class="stretchy">
                    <img class="spacer" alt="icon" src="images/assets/spacer.png">
                    <img class="sprite s15" alt="" src="images/assets/spritesheet.png">
    </a>            
</div>
</div> 
```

CSS：

```
.stretchy {display:block; position:relative; overflow:hidden; max-width:400px; }

.stretchy .spacer { width: 100%; height: auto; }
.stretchy .sprite {
     position:absolute; top:-5px; left:0; max-width:none; max-height:100%;
 }
.stretch img { width: 100%; }

.stretchy .sprite.s2 {left:-103%;}
.stretchy .sprite.s3 {left:-205%;}
.stretchy .sprite.s4 {left:-307%;}
.stretchy .sprite.s5 {left:-407%;}
.stretchy .sprite.s6 {left:-508%;}
.stretchy .sprite.s7 {left:-608%;}
.stretchy .sprite.s8 {left:-709%;}
.stretchy .sprite.s9 {left:-811%;}
.stretchy .sprite.s10 {left:-911%;}
.stretchy .sprite.s11 {left:-1012%;}
.stretchy .sprite.s12 {left:-1113%;}
.stretchy .sprite.s13 {left:-1216%;}
.stretchy .sprite.s14 {left:-1318%;}
.stretchy .sprite.s15 {left:-1418%;} 
```

![本地网站](../Images/c4d56f793a75143b74a97c6796e32624.png)

![直播网站](../Images/91508b964062cc5aa336e6d3dd7a47c6.png)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-11T22:02:15.863

该`.icon`课程的宽度为 20%，比`.parallelogram`我屏幕上的口袋还宽。口袋的缩放应该与图标缩放同步……否则与图标相比，口袋会太小或偏离中心。

**编辑：**这里是一个用于尝试东西的 jsfiddle：http: [//jsfiddle.net/adnrz/](http://jsfiddle.net/adnrz/) 随着媒体查询在某些时候你可以缩放口袋，但不再是图标，因此口袋被拖到一边。并且在最小的屏幕尺寸上，您不会在正确的位置剪切图标，因此您会显示两个半图标。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-11T22:28:10.120

我会将口袋和图标都放在

```
position: absolute;
left: 50%; 
```

并添加

```
margin-left: -HALF_THEIR_WIDTH; 
```

我会对垂直定位做同样的事情（我想你知道上面的阅读方式）

从我在您的网页上看到的内容来看，您正在以一种糟糕的方式将固定像素值与百分比混合在一起。

祝你好运。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-03-11T21:59:46.730

使用的 CSS 比您发布的行多一点...骨架.css 例如，您还使用带 % 的宽度...猜猜这就是原因。

# image-processing - 单独的字母 - 图像处理 OCR

> ID：15349196
> 
> 赞同：0
> 
> 时间：2013-03-11T21:39:40.683
> 
> 标签：image-processing, ocr, matlab

```
I = imread('TEST_2.JPG');
Igray = rgb2gray(I);
Ibw = im2bw(Igray,graythresh(Igray));
Iedge = edge(uint8(Ibw));
se = strel('square',2);
Iedge2 = imdilate(Iedge, se);
Ifill= imfill(Iedge2,'holes');
imshow(Ifill) 
```

大多数数字是分开和识别的，但很少有数字彼此非常接近，因此它被识别为一个数字。有没有办法分开这些混合数字？对不起，我是新来的，直到 10 声望才能发布图片。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-03T13:59:44.660

最后，我让它工作了。我没有在 matlab 中编写 OCR 代码，而是使用 matlab 对图像进行预处理并将其优化到最大。然后使用 MS-OneNote 从图像中获取文本。

到目前为止，一切看起来都很好......

感谢你的帮助！！

# typo3 - TYPO3 6.0：从 FAL 中的边框列渲染当前页面的图像

> ID：15349199
> 
> 赞同：6
> 
> 时间：2013-03-11T21:39:56.650
> 
> 标签：typo3, typoscript

我有以下片段，但我没有让它工作。

```
COL3 = FILES
COL3 {
        references {
            table = tt_content
            uid = 14
            fieldName = image
        }
        renderObj = TEXT
        renderObj {
            data = file:current:publicUrl
            wrap = <img src="|">
        }
} 
```

代码片段到目前为止有效，但我想将它与当前页面和 colPos = 3 一起使用。所以类似于：

```
table = tt_content
select {
  where = colPos = 3
  orderBy = sorting
  languageField = sys_language_uid
} 
```

感觉就像我已经尝试了几乎所有东西。

我真的很感激我能得到的每一个帮助......

非常感谢！！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-03-18T14:41:03.327

这对我来说听起来更好：

```
COL3 = CONTENT
COL3 {
    table = tt_content
    select {
        where = colPos = 3
    }

    renderObj =  FILES
    renderObj {
            references {
                table = tt_content
                fieldName = image
            }
            renderObj = IMAGE
            renderObj {
                file.import.data = file:current:publicUrl
            }
        }
    } 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-03-12T00:06:48.997

我认为该`select`属性不适用于`references`.
尝试使用此解决方案（未经测试）与任何内容元素一起使用。

```
...
references {
    table = tt_content
    uid.data = uid
    fieldName = image
} 
```

另一个想法：

```
COL3 = CONTENT
COL3 {
    table = tt_content
    select {
        where = colPos = 3
    }

    renderObj =  FILES
    renderObj {
            references {
                table = tt_content
                fieldName = image
            }
            renderObj = TEXT
            renderObj {
                data = file:current:publicUrl
                wrap = <img src="|">
            }
        }
    } 
```

# asp.net - Knockout JS 图片绑定

> ID：15349202
> 
> 赞同：1
> 
> 时间：2013-03-11T21:40:00.883
> 
> 标签：asp.net, knockout.js, asp.net-web-api

我在我的单页应用程序中使用了淘汰赛 js。我有一个文件上传输入标签，我正在使用敲除来上传文件。在这种情况下，上传的文件是图像。

一旦图像由我的 ASP.NET Web API 处理，并且它返回到我的回调函数中，我会将响应插入到一个可观察的数组中，该数组会使用添加的新图像和文本更新屏幕。

但是，由于某种原因，图像没有显示出来。如果我刷新页面，它会很好地加载图像，但是当添加到可观察数组时，它不会显示图像。

有任何想法吗？

**编辑：**这是我添加项目的代码，它非常简单。

```
 item = {
                                "insightTypeId": 0,
                                "memberId": currentMemberId(),
                                "postedByMemberId": store.fetch("currentUser"),
                                "value": insight(),
                                "image": "content/insights/" + fileName
                            };

  messaging.client.addItem = function(item) {
        member().insights.unshift(item);
    }; 
```

**更新**

忘了提到它在查看该网站的计算机上可以正常工作，但在手机上则无法正常工作。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-20T16:15:46.920

我发现这是一个移动 safari 资源问题

# unit-testing - 如何测试AngularJS中是否抛出异常

> ID：15349214
> 
> 赞同：15
> 
> 时间：2013-03-11T21:40:32.420
> 
> 标签：unit-testing, angularjs, jasmine, angularjs-directive

我需要测试一个指令，它应该抛出一个异常。在茉莉花中，如何测试是否引发了异常？

指令链接功能：

```
link: function() {
    if(something) {
        throw new TypeError('Error message');
    }
} 
```

我还没有成功实现一个实际捕获错误并报告测试成功的测试。

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2013-03-11T21:54:22.867

我就是这样做的：

```
describe("myDirective", function() {
        it("should throw an error", inject(function ($compile, $rootScope) {
                function errorFunctionWrapper()
                {
                    $compile(angular.element("<div my-directive></div>"))($rootScope);
                }
                expect(errorFunctionWrapper).toThrow();
        }));
}); 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2015-03-23T16:52:14.203

```
 it("should throw an error", inject(function ($compile, $rootScope) {
        expect(function () {
            $compile(angular.element("<directive-name></directive-name>"))($rootScope.$new());
        }).toThrow();
    })); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2016-12-19T17:03:24.713

**编辑**：这似乎现在已修复。使用 Angular 1.6.4 测试。

* * *

~~在 Angular 1.6 中，我无法捕获该`$compile`阶段引发的错误。虽然不那么优雅，但我仍然可以检查`$exceptionHandler.errors`数组（[source](http://www.bradoncode.com/blog/2015/06/23/ngmock-fundamentals-testing-exceptions/)）：~~

```
it('throws an error', function() {
  $compile(angular.element('<directive-name></directive-name>'))($rootScope.$new());
  expect($exceptionHandler.errors.length).toBeGreaterThan(0);
}); 
```

~~更好的是，向它提供确切的错误消息：~~

```
expect($exceptionHandler.errors).toEqual(['first error', 'second error']) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-09-02T00:11:32.620

角度测试中的异常处理最好使用原生角度服务完成

[https://docs.angularjs.org/api/ng/service/$exceptionHandler](https://docs.angularjs.org/api/ng/service/$exceptionHandler)

这可以更好地处理抛出的异常，并提供更好的原生角度方式来全局处理异常。假设在某个时间点您可以在一个地方更改应用程序的异常处理策略。

在与 $exceptionHandlerProvider 一起使用时进行测试

[https://docs.angularjs.org/api/ngMock/provider/$exceptionHandlerProvider](https://docs.angularjs.org/api/ngMock/provider/$exceptionHandlerProvider)

让您更好地处理生成的异常并编写特定的测试。

对于单元测试，使用 .toThrow() 验证异常不是 Angular 的标准方法；茉莉花的方法。

# asp.net - 缩小会影响 JavaScript 功能吗？

> ID：15349218
> 
> 赞同：3
> 
> 时间：2013-03-11T21:40:47.223
> 
> 标签：asp.net, asp.net-mvc, asp.net-mvc-3, bundling-and-minification

我正在考虑为我小组的 ASP.NET MVC3 项目使用捆绑，但我无法打破它，因为我是一名初级开发人员。

JavaScript 缩小是否会影响 JavaScript 函数名称 - 即我仍然可以从内联代码中调用我用相同名称缩小的函数吗？此外，它是否会影响代码的行为方式 - 或者 JavaScript 功能和顺序是否完全保留？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-12T14:15:56.707

捆绑和缩小不会通过重命名函数名称来破坏您的代码。缩小通过删除不必要的空格、删除注释和将*变量*名缩短为一个字符来优化代码。

假设您执行此功能：

```
function BigHonkingFunctionName(bigvariablename1, bigvariablename2) {
    //I love this function
    alert(bigvariablename1 + " " + bigvariablename2);
} 
```

缩小后的结果将是：

```
function BigHonkingFunctionName(n,t){alert(n+" "+t)} 
```

如您所见，它不会影响您调用或使用该函数的方式。

阅读[捆绑和缩小](http://www.asp.net/mvc/tutorials/mvc-4/bundling-and-minification)。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2017-11-28T07:34:37.973

通常 Javascript 缩小不会更改函数名称，您可以放心使用它们。Javascript 缩小通常会删除空格、换行符、缩短局部变量名称、缩短函数参数名称。

尽管如果您的代码使用`eval`引用在其访问范围内定义的变量的语句，您可能会遇到麻烦。一些缩小器不触及语句，如果工具引用的变量名称已被工具缩小`eval`，这可能会有点问题。`eval`

例如，下面的 Javascript 代码块可以缩小如下：

**源代码：**

```
function eval_test(var_1, var_2) {
    var_1 = "Updated var_1";
    var_2 = "Updated var_2";

    var a = eval("var_1 * var_2") + "<br>";
} 
```

**缩小的 JS：**

```
function MyFunction(n,t){n="Updated var_1";t="Updated var_2";
var i=eval("var_1 * var_2")+"<br>"} 
```

在此示例中，`eval`调用将在缩小后中断，因为函数的参数`var_1`,分别被缩小为和。但声明仍然没有改变。`var_2``eval_test``n``t``eval`

尽管如此，一些缩小工具不会缩小参数/变量名称，在这种情况下 eval 语句将工作得很好。但是保持未缩小的参数/变量名称会对缩小产生负面影响，因为您的代码可能没有像应有的那样压缩/缩小。

您可以尝试以下在线缩小工具来测试和验证缩小输出：

[http://utilninja.com/Computing/JavascriptMinifier](http://utilninja.com/Computing/JavascriptMinifier)

[https://javascript-minifier.com/](https://javascript-minifier.com/)

[https://jscompress.com/](https://jscompress.com/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-11T21:57:37.240

这是一个合理的担忧。可能取决于您的 Javascript 文件的构建方式，现在捆绑器可以工作。很多时候，打包者在搞清楚所有事情并将需要存在的东西保持完整方面做得很好。

许多捆绑程序确实具有启用或禁用选项的配置选项，因此您可以将系统配置为您想要的确切方式，或者如果您遇到问题。

# ios - ZBar iOS 自动识别

> ID：15349222
> 
> 赞同：0
> 
> 时间：2013-03-11T21:41:02.113
> 
> 标签：ios, xcode, automation, qr-code, zbar-sdk

在我的 ios 应用程序中，我在我的应用程序中实现了 zbar qr sdk 代码扫描器。用户扫描二维码，内容进入文本字段（不可编辑类型）。

我想知道的是，有没有一种方法可以让应用程序自动打开 safari（如果二维码是链接）、邮件（如果二维码是电子邮件）、电话（如果二维码是电话号码）。如果我这样做，它将帮助应用程序变得更加自动化和用户友好。谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-11T21:47:26.970

在读者的`didFinishPickingMediaWithInfo`方法中，您可以根据数据做出决策。定义如何识别每种数据类型并使用 switch 语句：

```
switch(dataType) {

  case ISLINK: [[UIApplication sharedApplication] openURL:[NSURL URLfromString:parsedUrl]]; break;
  case ISEMAIL: [[UIApplication sharedApplication] openURL:[NSURL URLfromString:[NSString stringWithFormat:@"mailto:%@",parsedUrl]]];
  ...
} 
```

# cordova - 在 PhoneGap/Cordova 中处理 cookie

> ID：15349237
> 
> 赞同：94
> 
> 时间：2013-03-11T21:41:51.720
> 
> 标签：cordova, cookies, xmlhttprequest

我正在开发一个使用服务器会话的 PhoneGap 应用程序。它需要 cookie 来处理会话。此外，还应处理来自负载平衡器的 cookie。所以没有办法。您如何处理 PhoneGap 应用程序中的 Cookie？

我已经完成了一些研究：

*   有人说 cookie 处理可能取决于服务器没有为未知用户代理 (IIS) 设置 cookie：[iOS 上的 PhoneGap session (cookies)](https://stackoverflow.com/questions/10019418/phonegap-session-cookies-on-ios)
*   在 JavaScript 中，cookie 可以使用 document.cookie = ... 设置，但它们不会保存在 PhoneGap 中并且会丢失。在触发 xhr 请求之前，它可以工作。
*   可以在使用 xhr.getResponseHeader('Set-Cookie') 进行 xhr 请求后检索 Cookie。但只有在服务器上实际设置时。不幸的是，jQuery 去掉了“Cookie”标头。
*   JavaScript document.cookie 属性在 (xhr) 请求之后未分配且未更新。
*   有些人建议使用 localStorage 来保存会话 ID 等。但是所有脚本都可以访问它，这可能是 XSS 安全问题。Cookies 通过使用 httponly 标志来解决这个问题。
*   iOS：有一些修改会改变 webView 行为以支持 cookie。但它们似乎不适用于 iOS 6 和 PhoneGap 2.5：[https ://groups.google.com/forum/?fromgroups=#!topic/phonegap/ZJE1nxX63ow](https://groups.google.com/forum/?fromgroups=#!topic/phonegap/ZJE1nxX63ow)
*   AppDelegate.m (v2.5) 中似乎默认启用了 Cookie。

* * *

## 回答 #1

> 赞同：69
> 
> 时间：2013-05-15T12:23:42.190

Friend, I've tried too without success to use cookies with phonegap. The solution was use localStorage.

Key Quick Example:

```
 var keyName = window.localStorage.key(0); 
```

Set Item Quick Example:

```
 window.localStorage.setItem("key", "value"); 
```

Get Item Quick Example

```
 var value = window.localStorage.getItem("key");
 // value is now equal to "value" 
```

Remove Item Quick Example:

```
 window.localStorage.removeItem("key"); 
```

Clear Quick Example:

```
 window.localStorage.clear(); 
```

If you use you javascript for both mobile and web, you can use this code to detect that enviroment:

```
var wl = window.location.href;
var mob = (wl.indexOf("android")>0); 
```

References: [http://docs.phonegap.com/en/1.2.0/phonegap_storage_storage.md.html#localStorage](http://docs.phonegap.com/en/1.2.0/phonegap_storage_storage.md.html#localStorage) [http://cordova.apache.org/docs/en/6.x/cordova/storage/storage.html#page-toc-source](http://cordova.apache.org/docs/en/6.x/cordova/storage/storage.html#page-toc-source)

Be aware: using anonymous navigation on iOS may make localstorage not work like spected. A simple test that are working fine to me:

```
$(document).ready(function () {
    try {
        localStorage.setItem('test', '1');
    } catch (Err) {
        if (Err.message.indexOf('QuotaExceededError') > -1) {
            // Tell the user they are in anonymous mode
            // Sugest it to go to https://support.apple.com/pt-br/HT203036 to get help to disable it
            }
        }
    }
}); 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2015-12-07T10:53:54.123

与您类似，我想在我的应用程序中使用服务器设置的 cookie，以便我的应用程序与网络保持一致，并且不需要单独的设备 ID 或其他身份验证方法。

我发现如下：

*   通过 AJAX（例如 jQuery`$.get()`或`$.post()`）设置的 Cookie 不会持续存在
*   在“inAppBrowser”中设置的 Cookie**确实**存在。

因此让 cookie 持久化的方法是使用[inAppBrowser](https://github.com/apache/cordova-plugin-inappbrowser)插件。

首先，设置一个简单的服务器，它接受您想要持久化的 GET 参数键值参数。我是 python/tornado 人，所以我的服务器可能如下所示：

```
class PersistCookieHandler(tornado.web.RequestHandler):
   @tornado.gen.coroutine
   def get(self):
      token = self.get_argument('token')
      self.set_secure_cookie('token',token) 
```

然后，在您的应用中：

```
function persistToken(token,success_cb, error_cb) {
    // replace with your URL
    url = 'SECURE_SERVER_URL_THAT_HANDLES_SET_COOKIE';  

    // _blank tells inAppBrowser to load in background (e.g., invisible)
    var ref = window.open(url, '_blank', 'location=no,toolbar=no');

    // attach a listener to the window which closes it when complete
    ref.addEventListener('loadstop', function(event) { 
        ref.close();
        success_cb();  // call our success callback
    });

    // attach a listener for server errors 
    ref.addEventListener('loaderror', function(event) { 
        // call our error callback
        error_cb(event);    
    });
} 
```

然后，您可以按如下方式调用它：

```
persistToken(
   someToken,
   function() {
       console.log("token persisted");
   },
   function() {
       console.log("something went wrong);
   }
); 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2014-08-24T16:55:38.270

使用`device_id`来处理服务器端的某些记录。`session`在您的服务器上创建一个以`device_id`、`cookiename`和为列`cookievalue`的数据库表。`timestamp`

当客户端通过 phonegap 应用程序访问您的 Web 服务器时，获取他的`device_id`并将 cookie 存储在您的表中。`device_id here`充当 OAuth 协议中的访问令牌。

现在出于安全原因，您需要缩短这些记录的有效期，因为 device_id 是永久性的，您的客户希望有一天能卖掉他们的手机。因此，用于`timestamp`存储客户端的最后一次访问，如果有 10 天没有访问，则删除该记录。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2013-06-06T11:28:14.457

您还可以将会话 id 附加到请求 url，并根据服务器应用程序语言，使用您传递的查询字符串会话 id 值获取会话数据 - 例如在 PHP 中，您可以通过传入会话 id 打开现有会话。虽然由于会话劫持的风险不建议这样做，但您可以轻松测试 IP 和浏览器以确保会话来自同一客户端。这当然需要您在客户端关闭会话浏览器后立即使会话过期，并且会限制您缓存视图，因为会话将包含在实际的 html 中。至少对我来说，在本地设备上存储数据并不是一个真正的选择，因为它向客户端暴露了太多，在我看来这是一个更大的安全风险。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2016-03-31T13:26:59.807

我正在使用 Cordova 6.1（目前最新版本），实际上我发现了以下内容：

如果我使用 document.cookie = ... 通过 Javascript 设置 cookie，那么它不起作用。但是，如果我通过 Ajax 将函数 setCookie 发送到具有类似功能的服务器

```
function setCookie(name, value, exdays) {

    if(isPhonegap() === true){
        var data = "typ=function&functionType=setCookie&name="+name+"&value="+value+"&exdays="+exdays;
        loadAjax(data, false);    
    }
    else if (!(document.cookie.indexOf("name") >= 0)){
            var expires;
            if (exdays) {
                var date = new Date();
                date.setTime(date.getTime()+(exdays*24*60*60*1000));
                expires = "; expires="+date.toGMTString();
            }
            else{
                expires = "";
            }
            document.cookie = name+"="+value+expires+"; path=/"; 
    }
} 
```

并使用在服务器端设置cookie

```
setcookie($cookie, $value, $expires , "/" ); 
```

那么它确实有效！

希望这可以帮助。干杯

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2019-04-14T18:38:06.710

我认为问题基本上是关于为科尔多瓦应用程序设置客户端cookie。有关此主题的大多数信息都暗示设置客户端 cookie 不适用于 cordova。

但是我找到了一个插件，可以让我为我的科尔多瓦应用程序设置客户端 cookie。

查看[https://www.npmjs.com/package/cordova-plugin-cartegraph-cookie-master](https://www.npmjs.com/package/cordova-plugin-cartegraph-cookie-master)。

它只是工作！

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2019-07-15T14:45:25.380

我还遇到了 Cordova + XHR 请求的会话 cookie 问题。每次应用重启时 cookie 都会丢失。有两件事解决了我的问题：

1.  Cookie 必须有一个过期日期。

2.  所有 XHR 请求都必须将[withCredentials](https://developer.mozilla.org/en-US/docs/Web/API/XMLHttpRequest/withCredentials)标志设置为 true。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2017-08-24T07:52:25.677

当然可以。

离子应用程序只是发送一个 ajax 请求，cookie 工作好或不依赖于服务器。

我使用过 python Django 服务器和节点服务器，两个 cookie 都运行得很好

下面的节点代码

```
app.all('*', function(req, res, next) {
res.header("Access-Control-Allow-Origin", '*');
res.header("Access-Control-Allow-Headers", "Origin, X-Requested-With, Content-Type, Accept");
res.header("Access-Control-Allow-Methods","PUT,POST,GET,DELETE,OPTIONS");
res.header("Access-Control-Allow-Credentials",true);
next();
}); 
```

休息api

```
router.get('/setCookies', function(req, res, next) {
var now = new Date();
var nextYear=new Date(now.setFullYear(now.getFullYear()+1));
//you can change the cookie key and value by your self here
res.cookie('cookiesTest', 'set cookies success,your cookies can be set by server', { expires: nextYear, httpOnly: true });
res.status(200)
res.end('SET COOKIES SUCCESS')
});

router.get('/getCookies', function(req, res, next) {
res.status(200)
res.end(JSON.stringify(req.cookies))
}); 
```

离子应用程序代码

```
var server='http://[YOUR IP HERE]:3000'

$scope.setCookies=function() {
  $http({
    url: server + '/setCookies',
    method: 'GET'
  }).success(function (data, header, config, status) {
    alert('set cookies success,look console')
    $scope.setCookiesStatu=false
    console.log(data)
    $scope.cookiesValue=data
  }).error(function (data, header, config, status) {
    alert('set cookies error,check console or your server address is wrong')
    console.log(data)
  });
}

$scope.getCookies=function() {
  $http({
    url: server + '/getCookies',
    method: 'GET'
  }).success(function (data, header, config, status) {
    alert('get cookies success,look console')
    console.log(data)
    $scope.cookiesValue=data
  }).error(function (data, header, config, status) {
    alert('get cookies error,check console or your server address is wrong')
    console.log(data)
  });
} 
```

[你可以在这里查看我的源代码](https://github.com/wangjinyang/ionic-angular-cookies/tree/master/nodeServer)

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2017-01-08T02:05:04.170

有同样的问题，并决定将 evrth 移动到 localStorage 我写了插件，所以你也可以使用它：[angular-cookies-mirror](https://github.com/uamanager/angular-cookies-mirror)

# here-api - 诺基亚地方 API？是否有详细的搜索结果说明？这个 api 的使用量有多大？

> ID：15349242
> 
> 赞同：0
> 
> 时间：2013-03-11T21:42:22.667
> 
> 标签：here-api

有没有人使用过诺基亚场所 API。我在社区论坛上没有看到很多活动？我很好奇它在行业中的使用水平？这是我的问题：

1) 有 [] 是什么意思？这里可以指定什么？2) 距离的单位是什么？是米吗？脚？3）附近有多准确？这是星巴克的真实地址还是只是一个近似值？
如果大约。它有多准确？

{ Starbucks } { position: [ 40.74864 , -73.98841 ] distance: 270 title: Starbucks averageRating: 0.0 category: { Coffee/Tea } icon: [http://download.vcdn.nokia.com/p/d/places2/icons/类别/23.icon](http://download.vcdn.nokia.com/p/d/places2/icons/categories/23.icon)附近：906 6th Ave ↵ New York City NY 10001 ↵ USA 有：[ ] 类型：urn:nlp-types:place href：[http ://demo.places.nlp.nokia.com/places/v1 /places/840dr5ru-846b0ffe4ec64caf83a11bafd4b5a5b9;context=Zmxvdy1pZD04ZWY4YTY4Ni1iN2RhLTVhYTEtOGM0Mi1kNjYxNTM0NGEyNThfMTM2MzAzNjEyNDY1Nl8wXzQ3NTEmcmFuaz0x?app_id=myappid&app_code=myappcode](http://demo.places.nlp.nokia.com/places/v1/places/840dr5ru-846b0ffe4ec64caf83a11bafd4b5a5b9;context=Zmxvdy1pZD04ZWY4YTY4Ni1iN2RhLTVhYTEtOGM0Mi1kNjYxNTM0NGEyNThfMTM2MzAzNjEyNDY1Nl8wXzQ3NTEmcmFuaz0x?app_id=myappid&app_code=myappcode) id: 840dr5ru-846b0ffe4ec64caf83a11bafd4b5a5b9 } ,

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-13T08:47:03.623

> ...诺基亚放置 API。...它在行业中的使用水平？

RESTful[地点 API被](http://developer.here.com/places)[here.com](http://here.com)用作后端服务，因此每当用户需要有关地点的更多详细信息时，都会向该服务发出地点请求。至于第三方的使用，我还没有得到详细信息。就我个人而言，我认为使用场所服务是一种无需太多努力即可轻松为应用程序增值的好方法——例如，您的组织有关于乡村散步的数据——您可以通过查找*“吃饭的地方和在您的路线附近喝酒”*，而无需成为酒吧和餐馆方面的专家——这超出了您的专业领域。

> 1) 有 [] 是什么意思？这里可以指定什么？

我看不到当前版本文档中记录了**[]** - 我相信它是进一步信息的占位符 - 如果您阅读 [可扩展合同](http://developer.here.com/docs/places/topics/extensible-api-contract.html)的定义，您会看到其他元素可能会添加到提要中任何时候 - 你最好的选择是暂时忽略该属性。

> 2) 距离的单位是什么？是米吗？脚？

距离以米为单位 - 您可以使用如下函数进行转换

```
function calculateDistance(distance){
        if (metricMeasurements){
                if (distance < 1000){
                        return "" + distance + " m.";
                } else {
                        return "" + Math.floor(distance/100)/10 + " km.";
                }
        } else {
                if (distance < 1610){
                        return "" + Math.floor(distance/1.0936) + " yards";
                } else {
                        return "" + Math.floor(distance/160.934)/10 + " miles";
                }
        }
} 
```

> 3）附近有多准确？这是星巴克的真实地址还是只是一个近似值？如果大约。它有多准确？

**[此处](http://developer.here.com/docs/places/topics/vicinity.html)的文档中描述了**邻近**度- 如有必要，它可用于过滤掉更远的地方。对于一个单独的地方，**address**元素包含完整的地址详细信息，**address.text**包含格式化的地址。关于具体地点查询 - [here.com](http://here.com/usa/new-york-city/coffee-tea/starbucks--840dr5ru-846b0ffe4ec64caf83a11bafd4b5a5b9)在 906 6th Ave 有一家 Starbucks。这可以通过[此处](http://www.gps-data-team.com/where/Starbucks_New_York_-_Manhattan_Mall)的另一个消息来源得到证实。**

# python - 是否可以将 django-celery 模型与 RabbitMQ 一起使用？

> ID：15349246
> 
> 赞同：0
> 
> 时间：2013-03-11T21:42:25.753
> 
> 标签：python, django, rabbitmq, celery, django-celery

我对使用 django-celery 模型来创建和监控重复任务很感兴趣。特别是，我正在考虑创建重复的类似 cron 的操作并从管理员那里启动/停止它们。

据我了解，只有当我还使用 Django 的默认数据库作为 celery 代理时，才有可能使用它。是否可以将这些模型与非数据库代理一起使用？

编辑：澄清一下，我已经在使用 RabbitMQ 作为代理。我的问题是：我可以在使用 RabbigMQ 的同时以某种方式使用 django-celery 的模型来动态创建和管理重复/计划任务吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-12T07:03:34.743

如果你安装了 AMQP，你可以在 celeryconfig 中设置：

```
BROKER_URL = 'amqp://127.0.0.1//' 
```

或者将上面的ip替换成RabbitMQ服务器运行的ip。

# python - 如何使用 DES 将加密值插入 Postgresql DB？

> ID：15349247
> 
> 赞同：0
> 
> 时间：2013-03-11T21:42:38.883
> 
> 标签：python, psycopg2, des

我正在使用 pyDes 和 psycopg2 Python 库将加密密码保存到 PostgreSql 数据库中。对于给定的密码，相应的 DES 值是不可打印的。如果我尝试执行以下查询

```
INSERT INTO users (id,name,pwd,pass) VALUES ('0101','asino','asinello','?\xa5\x9aO\xbd\x10\xa3\x85\xfa6\xf8_\xfb\x91\x95\xe2') 
```

我有以下错误： psycopg2.DataError: invalid byte sequence for encoding "UTF8": 0xa5

我尝试使用 repr 功能，但它不起作用。我认为错误是UTF8编码无法识别加密密码。如何将这些数据插入数据库？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-11T21:56:03.467

1.  您不应该将 DES 用于任何事情。它已过时，建议不要使用。
2.  除非您确实需要解密密码，否则不应存储加密密码。对于任何类型的登录系统，您应该使用`bcrypt`
3.  您的`insert`问题很可能是由于您尝试存储加密的二进制数据。您可能忘记将加密值编码为 base64 字符串。

# c++ - vector::push_back 在没有复制构造函数的对象上——指针值是否丢失？

> ID：15349248
> 
> 赞同：3
> 
> 时间：2013-03-11T21:42:39.670
> 
> 标签：c++, memory-management, vector, stl

我有一个类，代理，其成员属性指针指向另一个类的对象，形式：

代理.h

```
...//snip includes
class Agent{
private:
  Form* mvForm_ptr;
  ...
public:
  Agent();
  ~Agent();
  ...//snip additional functionality, but no copy-constructor
}; 
```

代理.cpp

```
#include "Agent.h"
Agent::Agent(){
  mvForm_ptr = new Form();
}
Agent::~Agent(){
  delete mvForm_ptr;
}
... 
```

如您所见，我没有明确的 Agent 复制构造函数。后来，我使用代理如下：

```
Agent player;
std::vector<Agent> agentsVector;
agentsVector.push_back(player); 
```

这似乎是 SIGSEGV 崩溃的原因，其错误报告声称 ~Agent 正在引发 EXC_BAD_ACCESS 异常。[在这里](http://www.cplusplus.com/reference/vector/vector/push_back/)阅读 vector::push_back似乎 push_back 试图复制传入的值。由于我在代理类中没有复制构造函数，所以在隐式复制尝试时表单指针会发生什么情况？如果指向的值在编译器生成的隐式复制构造函数中丢失，添加显式复制构造函数会解决错误的访问异常吗？上面的 Agent 类的复制构造函数应该如何实现？这是[三法则所](http://en.wikipedia.org/wiki/Rule_of_three_%28C++_programming%29)描述的前提的一个例子吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-11T21:44:52.427

> 在隐式复制尝试时表单指针会发生什么？

发生的情况是指针数据成员被复制，这意味着原始数据成员和副本都指向同一个对象，这反过来意味着它们都将在生命结束时尝试删除它。这些删除中只有一个可以成功。另一个导致**未定义的行为**。

在 C++11 中，您可以通过持有一个`std::unique_ptr<Form>`而不是原始指针来解决此问题。在 C++03 中，遵循[*三的规则*](http://en.wikipedia.org/wiki/Rule_of_three_%28C%2B%2B_programming%29)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-11T21:46:03.647

由于您没有提供复制或赋值运算符，编译器将为您生成一个，并且将复制指针但不会复制表单。每次销毁代理时，您的指针都会被释放，并且您将多次释放相同的内存。

一个简单的解决方法是使用 shared_ptr 确保只有在没有更多代理时才删除表单。

# php - 在特定目录中通过 PHP 创建 ZIP

> ID：15349254
> 
> 赞同：-1
> 
> 时间：2013-03-11T21:43:00.130
> 
> 标签：php

我发现这个很棒的代码可以通过这个链接[compress/archive folder using php script使用 PHP 创建一个 ZIP 文件](https://stackoverflow.com/questions/3828385/compress-archive-folder-using-php-script)

```
<?php
// Config Vars 

$sourcefolder = "./"           ; // Default: "./" 
$zipfilename  = "myarchive.zip"; // Default: "myarchive.zip"
$timeout      = 5000           ; // Default: 5000

// instantate an iterator (before creating the zip archive, just
// in case the zip file is created inside the source folder)
// and traverse the directory to get the file list.
$dirlist = new RecursiveDirectoryIterator($sourcefolder);
$filelist = new RecursiveIteratorIterator($dirlist);

// set script timeout value 
ini_set('max_execution_time', $timeout);

// instantate object
$zip = new ZipArchive();

// create and open the archive 
if ($zip->open("$zipfilename", ZipArchive::CREATE) !== TRUE) {
    die ("Could not open archive");
}

// add each file in the file list to the archive
foreach ($filelist as $key=>$value) {
    $zip->addFile(realpath($key), $key) or die ("ERROR: Could not add file: $key");
}

// close the archive
$zip->close();
echo "Archive ". $zipfilename . " created successfully.";

// And provide download link ?>
<a href="http:<?php echo $zipfilename;?>" target="_blank">
Download <?php echo $zipfilename?></a> 
```

我想在特定目录中创建 zip。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-11T21:45:24.510

```
$zipfilename  = "/path/to/my/zip/folder/myarchive.zip"; 
```

只需确保该文件夹是[可写](http://en.wikipedia.org/wiki/Chmod)的。

# c# - 安装 clickonce 应用程序时运行脚本数据库

> ID：15349261
> 
> 赞同：0
> 
> 时间：2013-03-11T21:43:17.373
> 
> 标签：c#, mysql, database, installation, clickonce

我为我的问题寻找答案，但要么我没有找到它，要么我不理解解决方案。

我正在使用 C# 开发一个 Winforms 应用程序，该应用程序使用 MySQL 数据库来存储信息。每个 LAN 只有一个数据库。我想要的是让客户能够自动安装 MySQL 服务器、应用程序数据库和应用程序。

我不介意 MySQL 服务器和数据库是否一起在一个安装程序中，或者这 3 个东西在一起（在这种情况下，安装程序应该询问用户是否要安装 MySQL 和数据库）。现在我正在使用 ClickOnce 发布应用程序。

如何使用这 3 个东西创建安装程序？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-12T12:01:33.420

Usually a bootstrapper is used to install third party apps when you are installing your application. Most [commercial products](http://en.wikipedia.org/wiki/Windows_Installer#Tools) offer this support, but you can also use free tools, recommended is [WiX](http://wixtoolset.org/).

# wolfram-mathematica - Mathematica - 求解泰勒级数的输入，使系数最小化

> ID：15349263
> 
> 赞同：0
> 
> 时间：2013-03-11T21:43:39.847
> 
> 标签：wolfram-mathematica, solver, taylor-series

我需要找到变量 s 的值，以便涉及 s 的表达式的泰勒展开：

1.  在除 0 阶以外的尽可能多的系数中具有最小值（最好是零，但由于二进制最小值就足够了）（最好多于一个最小系数，但第 2 和第 3 具有优先权）。

2.  报告满足区域内条件的 s 的最佳 n 值（即显示 s 的 3 个最佳值以及每个值的系数）。

我不知道如何在`Series[]`不收到错误的情况下将命令的输出输入到任何其他mathematica 命令中，更不用说如何实际解决问题了。我正在使用的方程太复杂，无法在此处发布（可以扩展的多区域但连续的多项式表达式）。有谁知道为此使用什么命令？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-13T02:56:09.750

您应该意识到的第一件事是 的输出`Series`不是一个总和而是一个`SeriesData`对象。要将其转换为总和，您必须将其包装在`Normal[Series[...]]`. 由于问题没有提供细节，我不能说更多。

# f# - 如何在 fsharpi 中添加在 Mono 中具有版本和公钥的引用

> ID：15349265
> 
> 赞同：5
> 
> 时间：2013-03-11T21:43:48.493
> 
> 标签：f#, mono, fsi

以下 #r 命令将在 Windows 上正常执行

`#r "System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089"`

在带有 Mono 3.0.6 的 Osx 上，即使该文件位于搜索路径中，它也无法找到该文件。

我猜这可能与延迟登录 Mono 有关，任何人都可以确认这一点或知道最好的解决方法是什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-14T08:01:04.413

目前`#r`Mono 不支持具有完全限定名称的引用。

[F# 代码](https://github.com/fsharp/fsharp/blob/master/src/fsharp/build.fs#L4084)中有一些区域会检查 Mono 的存在并恢复为仅文件加载引用。这是由于在撰写本文时对 xbuild 支持的限制。

现在 xbuild 更加成熟，希望可以解决这个问题。

*感谢 Don Syme 将我指向该区域*

# file-io - 由于 EAX 寄存器中的句柄值错误，MASM ReadFile 失败

> ID：15349266
> 
> 赞同：0
> 
> 时间：2013-03-11T21:44:00.457
> 
> 标签：file-io, masm, masm32

我想在 MASM 中转换以下 C++ 程序（目标是打开一个现有文件，向其中写入一个字符串，最后读取文件）：

```
void __cdecl    _tmain(int argc, TCHAR *argv[])
{
    HANDLE      hFile;

    /////////////////////////////////////////////////////////////////////////////////

    if ((hFile = CreateFile(TEXT("C:\\Users\\Bloodsucker94\\Desktop\\TestFile.txt"),
                       GENERIC_WRITE | GENERIC_READ,
                       FILE_SHARE_READ,
                       NULL,
                       OPEN_EXISTING,
                       FILE_ATTRIBUTE_NORMAL,
                       NULL)) == INVALID_HANDLE_VALUE)
        _tprintf(TEXT("CreateFile() failed code %d\n"), GetLastError());

    /////////////////////////////////////////////////////////////////////////////////

    char        DataBuffer[1024] = "aaa";
    DWORD       dwBytesToWrite = (DWORD)strlen(DataBuffer);
    DWORD       dwBytesWritten = 0;

    //_tprintf(TEXT("CreateFile() HFILE=%d\n"), hFile);

    if (WriteFile(hFile, DataBuffer, dwBytesToWrite, &dwBytesWritten, NULL) == FALSE)
        _tprintf(TEXT("WriteFile() failed code %d\n"), GetLastError());

    //_tprintf(TEXT("WriteFile() HFILE=%d\n"), hFile);

    /////////////////////////////////////////////////////////////////////////////////

    SetFilePointer(hFile, 0, NULL, FILE_BEGIN);

    char        ReadBuffer[4096] = {0};
    DWORD       dwBytesRead;

    if (FALSE == ReadFile(hFile, ReadBuffer, 4096, &dwBytesRead, NULL))
        _tprintf(TEXT("ReadFile() failed code %d\n"), GetLastError());

    printf("|%s|", ReadBuffer);

    getchar();
    CloseHandle(hFile);
} 
```

ASM 代码：

```
.386
.model flat, stdcall
option casemap :none

include                         \masm32\include\windows.inc
include                         \masm32\include\kernel32.inc
include                         \masm32\include\masm32.inc
includelib                      \masm32\lib\kernel32.lib
includelib                      \masm32\lib\masm32.lib
include                         \masm32\include\msvcrt.inc
includelib                      \masm32\lib\msvcrt.lib

.data

FileName                        BYTE                            "HelloWorld.txt", 0
BufferToWrite                   BYTE                            "Hell yeaahhhhhh!!!!", 0
ErrorCreateMsgFormat            BYTE                            "CreateFile() failed with code %d", 0
ErrorReadMsgFormat              BYTE                            "ReadFile() failed with code %d", 0
ErrorWriteMsgFormat             BYTE                            "WriteFile() failed with code %d", 0
CheckFormat                     BYTE                            "hFile=%d", 0
CheckSize                       BYTE                            "size=%d", 0
CheckPtr                        BYTE                            "EAX_ADDR=Ox%08X", 0
OutputFormat                    BYTE                            "output=%s", 0

.data?

hFile                           HANDLE                          ?
hFileCopy                       HANDLE                          ?
FileSize                        DWORD                           ?
hMem                            LPVOID                          ?
BytesRead                       LPDWORD                         ?
ErrorCode                       DWORD                           ?
RetRead                         BOOL                            ?
RetWrite                        BOOL                            ?
NumberOfBytesToWrite            DWORD                           ?
NumberOfBytesWritten            DWORD                           ?
BufferToWriteSize               DWORD                           ?

.code

start:
    invoke  lstrlen,            ADDR BufferToWrite
    mov     BufferToWriteSize,  eax

    ;-----------------------------CREATE-------------------------------

    invoke  CreateFile,         ADDR FileName,                  \
                                GENERIC_WRITE + GENERIC_READ,   \
                                0,                              \
                                NULL,                           \
                                OPEN_EXISTING,                  \
                                FILE_ATTRIBUTE_NORMAL,          \
                                NULL

    mov     hFile,              eax

    .IF hFile == INVALID_HANDLE_VALUE
            invoke              GetLastError
            mov ErrorCode,      eax
            invoke crt_printf,  ADDR ErrorCreateMsgFormat,      \
                                ErrorCode
            jmp                 _quit
    .ENDIF

    invoke  crt_printf,         ADDR CheckFormat,               \
                                hFile

    ;---------------------------WRITE---------------------------------

    invoke  WriteFile,          hFile,                          \
                                ADDR BufferToWrite,             \
                                BufferToWriteSize,              \
                                ADDR NumberOfBytesWritten,      \
                                NULL

    mov     RetWrite,           eax

    .IF RetWrite == FALSE
            invoke              GetLastError
            mov ErrorCode,      eax
            invoke crt_printf,  ADDR ErrorWriteMsgFormat,       \
                                ErrorCode
            jmp                 _quit
    .ENDIF

    invoke  crt_printf,         ADDR CheckFormat,               \
                                hFile

    ;--------------------------READ----------------------------------

    invoke  GetFileSize,        eax,                            \ ;problem start here
                                NULL

    mov     FileSize,           eax
    inc     eax

    invoke  crt_printf,         ADDR CheckSize,                 \
                                FileSize

    invoke  GlobalAlloc,        GMEM_FIXED,                     \
                                eax

    mov     hMem,               eax
    add     eax,                FileSize

    mov     BYTE PTR [eax],     0

    invoke  ReadFile,           hFile,                          \
                                hMem,                           \
                                FileSize,                       \
                                ADDR BytesRead,                 \
                                NULL

    mov     RetRead,            eax

    .IF RetRead == FALSE
            invoke              GetLastError
            mov ErrorCode,      eax
            invoke crt_printf,  ADDR ErrorReadMsgFormat,        \
                                ErrorCode
            jmp                 _quit
    .ENDIF

    invoke  crt_printf,         ADDR CheckFormat,               \
                                hFile

    invoke  crt_printf,         ADDR OutputFormat,              \
                                hMem

    invoke  CloseHandle,        hFile
    invoke  GlobalFree,         hMem

_quit:
    invoke  ExitProcess,        0

end start 
```

问题是 EAX 寄存器不包含 CreateFile 返回值 (hFile)。这是正常的，因为它在执行时包含了 WriteFile 函数的值。我没有找到任何解决方案来保存 CreatefILE 函数返回的 eax 的初始值，并在 WriteFile 函数调用后再次使用它。我不能这样做：

```
mov     FileSize,           hFile 
```

我只想保存 eax 的第一个值。我试图将它保存到另一个寄存器中，但它不起作用。有人可以帮助我吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-11T21:52:34.170

要么：

```
.data
savedValue DWORD ?

.code
…
// save to a variable
mov    savedValue, eax
…
// restore from a variable
mov    eax, savedValue
… 
```

或者：

```
.code
…
// save to stack
push   eax
…
// restore from stack
pop    eax
… 
```

抱歉有任何语法错误。距离上一个直接组装使用的常见用例已经有很长时间了。

# relational-algebra - 一对多关系的关系代数

> ID：15349267
> 
> 赞同：-1
> 
> 时间：2013-03-11T21:44:00.757
> 
> 标签：relational-algebra

假设我有以下关系：

```
Academic(academicID (PK), forename, surname, room)
Contact (contactID (PK), forename, surname, phone, academicNO (FK)) 
```

我正在使用 Java，我想了解符号的使用。

`Π( relation, attr1, ... attrn )`表示将 n 个属性投影到关系之外。
`σ( relation, condition)`表示选择符合条件的行。
`⊗(relation1,attr1,relation2,attr2)`表示在命名属性上连接两个关系。
`relation1 – relation2`是两种关系的区别。
`relation1 ÷ relation2`将一种关系除以另一种关系。

我见过的例子使用了三个表。我想知道当只涉及两个表（学术和联系）而不是三个（学术、联系、拥有）时的逻辑。

我正在使用这种结构：

```
LessNumVac = Π( σ( job, vacancies < 2 ), type )
AllTypes = Π( job, type )
AllTypes – LessNumVac 
```

我如何构建代数：

> 列出学术“约翰”拥有的所有联系人的姓名

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-11T22:00:39.250

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-12T13:40:35.807

> List the names of all contacts who is owned by academic "John".

For that, you would join the `Academic` and `Conctact` relations, filter for John, and project the name attributes. For efficiency, select John before joining:

π[forename, surename] (Contact ⋈<sub>academicNO = academicID (π[academicID] (σ[forename = "John"] Academic))))

# mysql - MySQL ORDER BY 逻辑

> ID：15349273
> 
> 赞同：-2
> 
> 时间：2013-03-11T21:44:19.473
> 
> 标签：mysql, select, sql-order-by

逻辑是什么？

```
SELECT field1, field2,...fieldN table_name1, table_name2... 
ORDER BY field1, [field2...] [ASC [DESC]] 
```

所以如果我有`ORDER BY field1, field2`：

（如果我错了，请告诉我）它会对结果进行排序`field1`，如果`field1`在几行（`field1[235]=field1[236]`）中具有相同的值，则只有在然后才会`ORDER BY field2`启动。对吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-11T21:45:27.007

确实。

这就是它的工作原理。

但是为什么我在这里看到这么多这样的问题呢？实验、尝试东西、玩耍等发生了什么？

# android - 无法确定在 onClick() 方法中的转换

> ID：15349276
> 
> 赞同：0
> 
> 时间：2013-03-11T21:44:24.780
> 
> 标签：android, casting, onclick, row, android-tablelayout

我编写了一个旨在显示报告的应用程序。应用程序的第一个屏幕是显示报告信息（名称、路径）的表格。

所以我想让表格的行可点击，以便将我带到显示报告详细信息的下一个屏幕，并知道该行对应的报告是什么。所以我写了自己的行：

**表格报告行：**

```
public class TableReportRow extends TableRow {

    Report report;

    public TableReportRow(Context context, Report report) {
        super(context);
        this.report = report;
    }

    public Report getReport() {
        return report;
    }

    public void setReport(Report report) {
        this.report = report;
    }
} 
```

然后我以编程方式创建了表：

```
protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.reports_list_activity_layout);
    application = (SGRaportManagerAppObj)getApplication();
    reportsRepository = application.reportsRepository.getReportsRepository();
    TableLayout table = (TableLayout) findViewById(R.id.tableReportsList);
    table.setStretchAllColumns(true);  
    table.setShrinkAllColumns(true);  
    final String tag = "tag";

    for (int i= 0; i < reportsRepository.size(); i++) {
        Report tempReport = reportsRepository.get(i);
        TableReportRow row = new TableReportRow(this, tempReport);
        // ...

        row.addView(tvName);
        row.addView(tvPath); 
        row.setOnClickListener(new View.OnClickListener() {

            @Override
            public void onClick(View v) {
                // This is where I need help.
            }
        });
        table.addView(row);
    } 
```

现在我需要为视图执行转换以`onClick()`访问该`GetReport()`方法以获取该行的实际相应报告，但我似乎无法正确处理。有人可以帮我解决这个问题吗？任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-11T21:48:57.373

您可以将其转换为 TableReportRow。当 onClick 被调用时，监听器所附加的视图作为参数传入。

这很有用，因为它允许为多个按钮回收相同的侦听器，并且您可以识别视图上的操作（基于文本、内容、ID 等...）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-11T21:49:50.867

```
TableReportRow row = new TableReportRow(this, tempReport);
row.setId(i);//set an id for this.
//...
row.setOnClickListener(new View.OnClickListener() 
        {
            @Override
            public void onClick(View v) 
            {
                        TableReportRow myRow=(TableReportRow)v;
                        int id=myRow.getId();//your id.
                        myRow.getReport();//yourReport
            }
        }
    }); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-11T21:52:11.973

onClick 事件中的 View 参数是处理程序绑定到的 View。因此，在您的情况下，它将是 TableReportRow 的一个实例，因此：

```
row.setOnClickListener(new View.OnClickListener() {
    @Override
    public void onClick(View v) {
         TableReportRow local = (TableReportRow) v;
    }
}); 
```

或者在外部块中将您的行定义为最终行：

```
final TableReportRow row = new TableReportRow(this, tempReport);
...
row.setOnClickListener(new View.OnClickListener() {
    @Override
    public void onClick(View v) {
         // row is in scope here
         row.getVirtualChildCount();
    }
}); 
```

# javascript - Twitter Bootstrap - 动态添加/删除标签和标签内容

> ID：15349281
> 
> 赞同：6
> 
> 时间：2013-03-11T21:44:52.493
> 
> 标签：javascript, jquery, twitter-bootstrap

在此先感谢您的任何和所有输入/帮助/建议...

我正在使用 Twitter Bootstrap 选项卡来组织一些信息。这些选项卡将位于表单页面上，每个选项卡将包含一个“联系表单”，用户可以在其中添加多个联系人，然后再提交整个表单。

```
<div class="container">
    <ul class="nav nav-tabs">
        <li class="active"><a href="#contact_01" data-toggle="tab">Joe Smith</a><span>x</span></li>
        <li><a href="#contact_02" data-toggle="tab">Molly Lewis</a><span>x</span> </li>
        <li><a href="#" class="add-contact" data-toggle="tab">+ Add Contact</a></li>
    </ul>
    <div class="tab-content">
        <div class="tab-pane active" id="contact_01">Contact Form: Joe Smith</div>
        <div class="tab-pane" id="contact_02">Contact Form: Molly Lewis</div>
    </div>
</div> 
```

完整代码在这里：http: [//jsfiddle.net/Harlow/zQnck/34/](http://jsfiddle.net/Harlow/zQnck/34/)

我试图模仿 jQuery UI 的“简单操作”选项卡示例的功能。（[http://jqueryui.com/tabs/#manipulation](http://jqueryui.com/tabs/#manipulation)）

我目前拥有的将添加一个新选项卡，但我希望能够通过单击“+ 添加”添加一个具有自己 ID 的新的、唯一的选项卡（继续代码，如“contact_01、contact_02 等”）新联系人”，它将始终是最后一个选项卡，但实际上并没有它自己的选项卡内容窗格。在动态添加内容的另一方面，我希望能够通过单击每个选项卡上的小“x”来删除它。

- 编辑 -

澄清一下，jQuery 示例触发器是单击“新选项卡”时的模式。出于我的目的，我只想创建一个新选项卡而不输入选项卡名称或内容（内容将始终是相同的联系表单，并且选项卡名称与新生成的 ID 相同我很好 - 我会让它稍后自动更新为联系人的姓名。）

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2013-03-11T22:03:10.890

编辑：我尽可能地复制了原始小提琴，因为两个小提琴都死了。

新小提琴：http: [//jsfiddle.net/dogoku/KdPdZ/2/](http://jsfiddle.net/dogoku/KdPdZ/2/)

```
$(".nav-tabs").on("click", "a", function(e){
      e.preventDefault();
      $(this).tab('show');
    })
    .on("click", "span", function () {
        var anchor = $(this).siblings('a');
        $(anchor.attr('href')).remove();
        $(this).parent().remove();
        $(".nav-tabs li").children('a').first().click();
    });

    $('.add-contact').click(function(e) {
        e.preventDefault();
        var id = $(".nav-tabs").children().length; //think about it ;)
        $(this).closest('li').before('<li><a href="#contact_'+id+'">New Tab</a><span>x</span></li>');         
        $('.tab-content').append('<div class="tab-pane" id="contact_'+id+'">Contact Form: New Contact '+id+'</div>');
}); 
```

请注意，我删除了悬停功能，而是使用了 css

```
.nav-tabs > li:hover > span {
    display:block;
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-09-23T16:23:40.220

Dogoku 的 jsfiddle 似乎是 404，所以我在这里整理了一个快速的 jsfiddle 解决方案：http: [//jsfiddle.net/xQ3f5/](http://jsfiddle.net/xQ3f5/)

我更新了它以停止将“活动”类应用于 +Add Contact 选项卡元素，因为它不对应于任何选项卡元素。我还建议将活动选项卡切换到新创建的选项卡。这是javascript：

```
$(".nav-tabs").on("click", "a", function(e){
      e.preventDefault();
    if(this.id == "add-contact"){return false;}
      $(this).tab('show');
    })
    .on("click", "span", function () {
        var anchor = $(this).siblings('a');
        $(anchor.attr('href')).remove();
        $(this).parent().remove();
        $(".nav-tabs li").children('a').first().click();
    });

    $('#add-contact').click(function(e) {
        e.preventDefault();
        var id = $(".nav-tabs").children().length; //think about it ;)
        $(this).closest('li').before('<li id="contact_tab_'+id+'"><a href="#contact_'+id+'">New Tab</a></li>');         
        $('.tab-content').append('<div class="tab-pane" id="contact_'+id+'">Contact Form: New Contact '+id+'</div>');
        $("#contact_tab_"+id+" a").tab('show');
}); 
```

# ios - 关闭 UIAlertView 的方法

> ID：15349286
> 
> 赞同：0
> 
> 时间：2013-03-11T21:45:05.557
> 
> 标签：ios

如果使用以下方法关闭 UIAlertView 更正确，我正在徘徊：

```
[alert removeFromSuperview]; 
```

或使用：

```
[alert dismissWithClickedButtonIndex: 0 animated: TRUE]; 
```

第一个似乎给问题...

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-11T21:49:29.567

始终使用dismissWithClickedButtonIndex。从超级视图中删除视图具有未定义的行为——我们不知道 iOS 内部在做什么。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-11T21:52:21.277

警报是一个弹出视图，因此应始终使用`[alert dismissWithClickedButtonIndex: 0 animated: YES];`

# c# - 新的 C# 异步功能是否在编译器中严格实现

> ID：15349287
> 
> 赞同：6
> 
> 时间：2013-03-11T21:45:08.467
> 
> 标签：c#, .net, asynchronous, clr, async-await

作为一个对探索“事物如何工作”感兴趣的 C# 程序员，我有兴趣更多地了解使新*异步*功能工作的过程。

我关注了 Eric Lippert 关于异步的优秀文章系列：[异步博客文章](http://blogs.msdn.com/b/ericlippert/archive/tags/async/)

除了“编译器正在为我们完成大部分工作”这一事实之外，我不记得在任何地方看到过任何关于此功能实现的参考（在高层次上）。

那么这个特性严格来说是编译器特性吗？编译器是否以某种方式重写代码，仅此而已？还是有其他的东西，比如运行时支持，可以做到这一点？

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2013-03-11T21:46:56.143

不，它不*完全*在编译器中。它依赖于一些新的接口，例如[`INotifyCompletion`](http://msdn.microsoft.com/en-gb/library/system.runtime.compilerservices.inotifycompletion.aspx)和一些框架*实现*支持，例如[`AsyncTaskMethodBuilder`](http://msdn.microsoft.com/en-gb/library/hh138506.aspx). 我不相信需要任何 CLR 更改。

编译器做了很多工作，构建了一个状态机——它只是引用了状态机中的一些类型。哦，许多与 -`Task`相关的类型主要出于性能原因而进行了重大修改。

我有[一系列博客文章](http://msmvps.com/blogs/jon_skeet/archive/tags/Eduasync/default.aspx)，最初是针对 CTP 编写的，但*仅*使用 vanilla .NET 4 和一些我自己编写的类。它们不会对生产实施产生影响（因为随着时间的推移情况会发生一些变化），但它们会给你一个幕后发生的总体印象。

# css - 使用 z-index 将输入字段定位在封闭 div 上方

> ID：15349289
> 
> 赞同：0
> 
> 时间：2013-03-11T21:45:13.080
> 
> 标签：css, input, z-index, css-position

我有一个包含一系列 div 的表单，这些 div 在这些 div 中包含单行数据和输入。我想将css中的输入呈现为“关闭”符号，但我无法使用负边距或负位置将它们定位在左上角“上方”。Z-index 似乎不起作用……它们最终隐藏在周围的白色区域中。

```
<div class="item-in-cart">
<input type="submit" name="delete[1]" class="delete" value="elimina">
</div>
<div class="item-in-cart">
<input type="submit" name="delete[2]" class="delete" value="elimina">
</div>
[...]

.item-in-cart {
width: 330px;
overflow: hidden;
border: 1px dashed #222;
margin-bottom: 20px;
padding: 15px;
position: relative;
}
.item-in-cart .delete {
display: block;
width: 25px;
height: 25px;
background: url(/assets/images/delete.png) no-repeat 0 0;
text-indent: -9999px;
padding: 0;
border: 0;
position: absolute;
top: -12px;
left: -12px;
z-index: 200;} 
```

为什么呢？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-11T21:54:44.540

首先你要关闭你的 div 元素。那么你想做@adrift 所说的关于向输入添加位置的事情。然后你会注意到，虽然你的定位，z-index 正在工作，但它们并没有超出左上角，因为你已经`overflow:hidden`设置了。把它拿出来，然后就可以了。这是一个小提琴：http: [//jsfiddle.net/jalbertbowdenii/CpmdV/1/](http://jsfiddle.net/jalbertbowdenii/CpmdV/1/)

# forms - 表单 bindAndSave 方法不保存文件

> ID：15349293
> 
> 赞同：0
> 
> 时间：2013-03-11T21:45:32.440
> 
> 标签：forms, symfony1, symfony-1.4, save

解析 XML 提要并以这种方式保存：

```
$action = new CouponActionForm();
$values = array(
      'name' => $offer->name,
      'link' => $offer->url,
      'description' => $offer->description,
      'discount' => $offer->discount,
      'price' => $offer->price
);
$files = $this->getImages($offer->picture);
if(!$action->bindAndSave($values, $files)){
      echo $action->renderGlobalErrors();
      die('BAD THING');
} 
```

这是`getImages`方法：

```
private function getImages($url){
  $ret = array('error' => 0);
  $tmp_dir = sys_get_temp_dir();
  $tmp_file = tempnam($tmp_dir, 'kupon');
  if(copy($url, $tmp_file)){
      $ret['tmp_name'] = $tmp_file;
      $ret['name'] = basename($url);
      $ret['size'] = filesize($tmp_file);
      $ret['type'] = 'image/jpeg';
      return array('filename' => $ret);
  }else{
      die('HELP');
  }
} 
```

为什么我使用表单保存而不是使用`->fromArray`方法保存对象？好吧，我已经完成了表单和所有验证，所以我不想两次实现相同的东西（DRY），但同样重要的是，我实际上不知道如何在学说模型中使用验证器。所以问题是表单没有将文件保存在validator`path`属性指定的特定目录中`sfValidatorFile`，而是存在于tmp目录中。

# iphone - 使用某些类型的方法删除对象时出现 NSMutableArray 错误

> ID：15349294
> 
> 赞同：0
> 
> 时间：2013-03-11T21:45:36.757
> 
> 标签：iphone, ios, objective-c, xcode

我有一个我不断迭代`NSMutableArray`的`UIImageViews`（使用 a `CADisplayLink`）。我这样做是为了`UIImageViews`在屏幕上不断移动。

当我`UIImageView`从数组中删除 a 时，有时会出现错误：

```
EXC_BAD_ACCESS (code=1, address=0x20000008) 
```

但是，在我开始使用 ARC/iOS6 之前，我过去常常收到错误“数组在被枚举时发生变异”，所以我认为这两个错误的含义完全相同，但我不确定。

无论如何，这是我的问题。使用以下任何方法从数组中删除 a`UIImageView`会给我上述错误。

`[imageViews removeObject:imageView];`

`[imageViews performSelector:@selector(removeObject:) withObject:imageView];`

`[imageViews performSelectorOnMainThread:@selector(removeObject:) withObject:imageView waitUntilDone:YES];`

但是，使用以下任何一种方法**都不**会给我错误。

`[imageViews performSelectorOnMainThread:@selector(removeObject:) withObject:imageView waitUntilDone:NO];`

`[imageViews performSelector:@selector(removeObject:) withObject:imageView afterDelay:.01];`

那么有人可以向我解释为什么从`NSMutableArray`使用上面列出的第一组方法中删除一个对象会给我我认为“数组在被枚举时发生突变”的错误，而使用第二组方法永远不会给我这个错误？

我一直在使用上面列出的第二组方法来解决这个错误（如果我使用它们，一切都很好）但我想知道为什么我的问题在我使用它们时得到了解决，以及它是否安全使用这两种方法之一。

这是我第一次发布问题，如果我以错误的方式发布此问题，请原谅我。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-11T22:35:27.190

因为 CADisplayLink 在后台线程上回调，所以完全有可能通过调度有问题的数组从所述线程中删除给定对象，另一个正在变异或枚举数组的过程中，这会引发异常。前两种方法不起作用，因为它们需要对数组进行同步访问（NSMutableArray 不提供），并且它们调度在当前线程的运行循环中，而不是主线程，因此不能保证它们各自的执行不能同时访问同一个资源。底部的两个工作是因为，假设您在主线程上改变数组，该运行循环不可能安排指令枚举和指令同时突变（一个线程不能在同时，特别是当该代码被安排在运行循环的下一次迭代中时），因此该数组的访问更加安全。通过使用延迟，您创建了一个竞争条件，这对您来说到目前为止已经奏效，但稍后会再次困扰您。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-11T22:02:25.663

当您枚举一个数组时（使用 for ... in ... 循环遍历它或使用 NSEnumerator），枚举要求您在循环本身或同时在另一个线程上根本不更改数组（因此原始警告）。

我不知道为什么底部的两种方法有效 - 我会在内部猜测它们以不影响枚举的方式更改数组。

话虽如此，这是不好的做法，我不建议在枚举期间以任何方式更改数组。即使今天有效，明天也可能无效。我建议将要删除的索引存储到枚举之后，然后按照[此答案](https://stackoverflow.com/questions/9446254/how-to-remove-elements-in-nsmutablearray-or-nsmutabledictionary-during-enumerati)删除它们。

# asp.net-mvc - 如何将#id 添加到 Html.ActionLink

> ID：15349295
> 
> 赞同：1
> 
> 时间：2013-03-11T21:45:50.600
> 
> 标签：asp.net-mvc, html.actionlink

如何生成链接`<a href="/home/index#item">text</a>`，如：

`return RedirectToAction()`

`@Html.ActionLink()`

我需要为页面加载时打开的标签添加**#item 。**谢谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-11T21:47:28.243

只需使用[`proper overload`](http://msdn.microsoft.com/en-us/library/dd460522%28v=vs.108%29.aspx)ActionLink 助手：

```
@Html.ActionLink(
    linkText: "text", 
    actionName: "index", 
    controllerName: "home", 
    protocol: Request.Url.Scheme, 
    hostName: null, 
    fragment: "item", 
    routeValues: null, 
    htmlAttributes: null
) 
```

或者如果您愿意，可以使用快捷方式：

```
@Html.ActionLink("text", "index", "home", Request.Url.Scheme, null, "item", null, null) 
```

如果您想重定向到这样的操作，您可以使用以下[`GenerateUrl`](http://msdn.microsoft.com/en-us/library/ee703653%28v=vs.108%29.aspx)方法：

```
public ActionResult SomeAction()
{
    string url = UrlHelper.GenerateUrl(
        routeName: null,
        actionName: "index",
        controllerName: "home",
        protocol: null,
        hostName: null,
        fragment: "item",
        routeValues: new RouteValueDictionary(),
        routeCollection: Url.RouteCollection,
        requestContext: Url.RequestContext,
        includeImplicitMvcValues: false
    );
    return Redirect(url);
} 
```

# java - 在文件下载中实现暂停/恢复

> ID：15349296
> 
> 赞同：20
> 
> 时间：2013-03-11T21:45:52.400
> 
> 标签：java, android, download

我正在尝试在我的下载管理器中实现暂停/恢复，我在网上搜索并阅读了几篇文章并根据它们更改了我的代码，但恢复似乎无法正常工作，有什么想法吗？

```
 if (!downloadPath.exists()) 
                    downloadPath.mkdirs(); 

                if (outputFileCache.exists())
                {
                    downloadedSize = outputFileCache.length();
                    connection.setAllowUserInteraction(true);
                    connection.setRequestProperty("Range", "bytes=" + downloadedSize + "-");
                    connection.setConnectTimeout(14000);
                    connection.connect();
                    input = new BufferedInputStream(connection.getInputStream());
                    output = new FileOutputStream(outputFileCache, true);
                    input.skip(downloadedSize); //Skip downloaded size
                }
                else
                {
                    connection.setConnectTimeout(14000);
                    connection.connect();
                    input = new BufferedInputStream(url.openStream());
                    output = new FileOutputStream(outputFileCache);
                }

                fileLength = connection.getContentLength();                 

                byte data[] = new byte[1024];
                int count = 0;
                int __progress = 0;
                long total = downloadedSize;

                while ((count = input.read(data)) != -1 && !this.isInterrupted()) 
                {
                    total += count;
                    output.write(data, 0, count);
                    __progress = (int) (total * 100 / fileLength);

                }
                output.flush();
                output.close();
                input.close(); 
```

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2013-03-21T14:16:37.660

好的问题已解决，这是我为其他想要实现暂停/恢复的用户的代码：

```
 if (outputFileCache.exists())
        {
            connection.setAllowUserInteraction(true);
            connection.setRequestProperty("Range", "bytes=" + outputFileCache.length() + "-");
        }

        connection.setConnectTimeout(14000);
        connection.setReadTimeout(20000);
        connection.connect();

        if (connection.getResponseCode() / 100 != 2)
            throw new Exception("Invalid response code!");
        else
        {
            String connectionField = connection.getHeaderField("content-range");

            if (connectionField != null)
            {
                String[] connectionRanges = connectionField.substring("bytes=".length()).split("-");
                downloadedSize = Long.valueOf(connectionRanges[0]);
            }

            if (connectionField == null && outputFileCache.exists())
                outputFileCache.delete();

            fileLength = connection.getContentLength() + downloadedSize;
            input = new BufferedInputStream(connection.getInputStream());
            output = new RandomAccessFile(outputFileCache, "rw");
            output.seek(downloadedSize);

            byte data[] = new byte[1024];
            int count = 0;
            int __progress = 0;

            while ((count = input.read(data, 0, 1024)) != -1 
                    && __progress != 100) 
            {
                downloadedSize += count;
                output.write(data, 0, count);
                __progress = (int) ((downloadedSize * 100) / fileLength);
            }

            output.close();
            input.close();
       } 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-03-13T03:14:43.560

如果没有更多信息，就无法判断出了什么问题，但需要注意的是：

1.  您必须发出 HTTP/1.1 请求（很难从您的示例代码中看出）
2.  服务器必须支持 HTTP/1.1
3.  服务器将通过响应中的 Accept-Ranges 标头告诉您它支持什么
4.  If-Range 应该是服务器为您提供的资源的 etag，而不是上次修改时间

你应该用一些简单的东西来检查你的范围请求，以测试源实际上首先支持范围请求（如 curl 或 wget ）

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-03-21T10:15:14.883

可能是您的服务器需要很长时间才能响应（超过超时限制），或者这也是并非所有服务器都支持暂停 - 恢复的事实。还需要思考的是，文件是通过 Http、https、ftp 或 udp 下载的。

暂停”可能只是意味着读取一些流并将其写入磁盘。**恢复时，您必须使用标题来指定要下载的内容**。

您可以尝试以下方法：

```
 HttpURLConnection connection = (HttpURLConnection) url.openConnection();
    if(ISSUE_DOWNLOAD_STATUS.intValue()==ECMConstant.ECM_DOWNLOADING){
         File file=new File(DESTINATION_PATH);
        if(file.exists()){
             downloaded = (int) file.length();
         connection.setRequestProperty("Range", "bytes="+(file.length())+"-");
    }
}else{
    connection.setRequestProperty("Range", "bytes=" + downloaded + "-");
}
connection.setDoInput(true);
connection.setDoOutput(true);
progressBar.setMax(connection.getContentLength());
 in = new BufferedInputStream(connection.getInputStream());
 fos=(downloaded==0)? new FileOutputStream(DESTINATION_PATH): new FileOutputStream(DESTINATION_PATH,true);
 bout = new BufferedOutputStream(fos, 1024);
byte[] data = new byte[1024];
int x = 0;
while ((x = in.read(data, 0, 1024)) >= 0) {
    bout.write(data, 0, x);
     downloaded += x;
     progressBar.setProgress(downloaded);
} 
```

请尝试同步内容。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-03-15T21:24:28.947

我将从这一行开始调试：

```
connection.setRequestProperty("Range", "bytes=" + downloadedSize + "-"); 
```

由于无法从源代码中确定是什么`downloadedSize`，因此很难进一步详细说明，但格式应该是`bytes=from-to`.

无论如何，我建议您使用[Apache HttpClient](http://hc.apache.org/httpcomponents-client-ga/index.html)来避免常见的陷阱。[这](https://stackoverflow.com/questions/7362719/apache-httpclient-get-add-a-byte-range-header)是一个在类似主题上使用 Apache HttpClient 的人提出的问题，并提供了一些示例代码。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-03-21T01:55:12.800

我认为您只需要删除 input.skip(downloadedSize) 行。为字节范围设置 HTTP 标头意味着*服务器*将跳过*发送*这些字节。

假设您有一个 20 字节长的文件，其中包含“aaaaabbbbbcccccddddd”，并假设在下载 5 个字节后传输暂停。然后 Range 标头将导致服务器发送“bbbbbcccccddddd”，您应该阅读*所有*这些内容并将其附加到文件中——不要跳过（）。但是代码中的 skip() 调用将跳过“bbbbb”，留下“cccccddddd”要下载。如果您已经下载了至少 50% 的文件，那么 skip() 将耗尽所有输入并且不会发生任何事情。

此外，stringy05 的帖子中的所有内容都适用。您应该确保服务器支持 HTTP/1.1，确保资源支持 Range 标头（动态生成的内容可能不支持它），并确保资源没有使用 etag 和修改日期进行修改。

# memory - 真实、受保护、虚拟模式内存寻址

> ID：15349298
> 
> 赞同：1
> 
> 时间：2013-03-11T21:45:56.987
> 
> 标签：memory, memory-management

有这三种类型的内存寻址。我正在阅读与英特尔® 奔腾 4 相关的[这些](http://fetweb.ju.edu.jo/staff/ee/mhawa/331/Protected.pdf)概念的简要说明，但如果有人能稍微澄清一下，我将不胜感激。

> 在实模式下，只有前 1M 字节的内存可以用典型的段：偏移逻辑地址寻址。每个段长 64K 字节

但

> 在保护模式下，可以访问大于 1MB 的内存

每一种的主要区别和优势是什么？为什么ie windows xp 使用保护模式？这个“受保护”指的是什么保护？

# java - 使用 RabbitMQ 的 Spring 示例

> ID：15349304
> 
> 赞同：1
> 
> 时间：2013-03-11T21:46:25.973
> 
> 标签：java, spring, spring-mvc, rabbitmq, amqp

我对在 RabbitMQ 中使用 spring 感到很困惑。

我使用 RabbitMQ Jars 做了一个示例程序（就像在 RabbitMQ 站点中给出的那样）。我在 Spring MVC（用于生产者）和独立的 java 程序（用于消费者）中使用了此代码。它工作正常。

但是当我搜索 AMQP RabbitMQ Spring 示例时，我得到了很多变化。

特别是，我不了解 XML 配置部分。在一个示例中，我看到带有标签的 XML 文件

```
 <rabbit:admin/>
  <rabbit:connection-factory/> 
```

等等，在另一个例子中，我只看到`<beans>`连接工厂的内容很简单，没有提到`<rabbit>`XML 中的相关标签。我是消息传递的新手，这让我很困惑。

我想看到的是一个完整的 Spring MVC 或 Basic Spring Application，它使用 AMQP 向/从 RabbitMQ 发送/接收（生产者/消费者）消息。

# ios - UITableview重复复选标记

> ID：15349305
> 
> 赞同：1
> 
> 时间：2013-03-11T21:46:27.440
> 
> 标签：ios, objective-c, iphone, xcode, uitableview

我已经尝试了一切来让它工作，但是当我滚动时`cellForRowAtIndexPath`，它似乎在我的 tableview 上添加和删除复选标记，有人可以帮忙吗？

```
// Configure the cell...
cell.textLabel.text = [currencyList objectAtIndex:indexPath.row];

// Check to see what currency is currently selected and checkstyle
if ([selectedCurrency isEqualToString:cell.textLabel.text]) {

    // Add a tick to the selected row
    cell.accessoryType = UITableViewCellAccessoryCheckmark;

    // Change the text colour
    cell.textLabel.textColor = [UIColor colorWithRed:0 green:0 blue:0.5 alpha:1];
    self.checkedIndexPath = indexPath;
} else {
    UITableViewCell *uncheckCell = [self.tableView
                                    cellForRowAtIndexPath:self.checkedIndexPath];
    uncheckCell.accessoryType = UITableViewCellAccessoryNone;
    // Change the font colour back to black
    uncheckCell.textLabel.textColor = [UIColor colorWithRed:0 green:0 blue:0 alpha:1];
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-11T22:01:05.990

您无需取消选中 cell in `cellForRowAtIndexPath`。更好的解决方案只是重新加载已检查的单元格。

```
- (void)setCheckedIndexPath:(NSIndexPath *)indexPath
{
    NSIndexPath *uncheckIndexPath = self.checkedIndexPath;
    _checkedIndexPath = indexPath;
    [self.tableView reloadRowsAtIndexPaths:@[uncheckIndexPath]
                          withRowAnimation:UITableViewRowAnimationLeft];
} 
```

并改变`cellForRowAtIndexPath`。请注意，我们设置`UITableViewCellAccessoryNone`为必须返回的单元格，而不是您要取消选中的单元格。

```
// Configure the cell...
cell.textLabel.text = [currencyList objectAtIndex:indexPath.row];

// Check to see what currency is currently selected and checkstyle
if ([selectedCurrency isEqualToString:cell.textLabel.text]) {

    // Add a tick to the selected row
    cell.accessoryType = UITableViewCellAccessoryCheckmark;

    // Change the text colour
    cell.textLabel.textColor = [UIColor colorWithRed:0 green:0 blue:0.5 alpha:1];
    self.checkedIndexPath = indexPath;
} else {
    //If cell unchecked
    cell.accessoryType = UITableViewCellAccessoryNone;
    // Change the font colour back to black
    cell.textLabel.textColor = [UIColor colorWithRed:0 green:0 blue:0 alpha:1];
} 
```

# ruby-on-rails - Refinery CMS 和带有迁移的扩展。有什么我应该知道的吗？

> ID：15349307
> 
> 赞同：0
> 
> 时间：2013-03-11T21:46:34.843
> 
> 标签：ruby-on-rails, database-migration, refinerycms

我继承了一个 Rails Web 应用程序，它以 Refinery CMS 作为根应用程序，`/vendor/extensions`目录下有多个应用程序。此目录下的应用程序在其目录下具有数据库迁移`db`。

目前，这个项目没有完成它的`rake db:migrate`命令，因为它期望一个表存在并且它试图重命名这个表上的一个列。`db/migrate`我相信我已经确定在根应用程序（Refinery CMS）或任何扩展应用程序的目录中创建此表实际上没有迁移`(/vendor/extenstions/*/db/migrate)`。

我可能需要联系以前的开发人员，但这仍然不能回答我关于 Refinery CMS 和扩展的问题：

**要运行扩展目录下的迁移，我需要做些什么特别的事情吗？**

# c++ - 使用 XMM0 寄存器和内存提取（C++ 代码）的速度是仅使用 XMM 寄存器的 ASM 的两倍 - 为什么？

> ID：15349308
> 
> 赞同：7
> 
> 时间：2013-03-11T21:46:38.033
> 
> 标签：c++, performance, optimization, assembly, sse2

我正在尝试实现一些内联汇编程序（在 Visual Studio 2012 C++ 代码中）以利用 SSE。我想添加 7 个数字 1e9 次，所以我将它们从 RAM 放置到 CPU 的 xmm0 到 xmm6 寄存器。当我使用以下代码在 Visual Studio 2012 中使用内联汇编执行此操作时：

C++ 代码：

```
for(int i=0;i<count;i++)
        resVal+=val1+val2+val3+val4+val5+val6+val7; 
```

我的 ASM 代码：

```
int count=1000000000;

    double resVal=0.0;
       //placing values to register
    __asm{  
        movsd xmm0,val1;placing var1 in xmm0 register  
        movsd xmm1,val2  
        movsd xmm2,val3  
        movsd xmm3,val4  
        movsd xmm4,val5  
        movsd xmm5,val6  
        movsd xmm6,val7  
        pxor xmm7,xmm7;//turns xmm7 to zero
         }

    for(int i=0;i<count;i++)
    {
        __asm
        {
            addsd xmm7,xmm0;//+=var1
            addsd xmm7,xmm1;//+=var2
            addsd xmm7,xmm2;
            addsd xmm7,xmm3;
            addsd xmm7,xmm4;
            addsd xmm7,xmm5;
            addsd xmm7,xmm6;//+=var7
        }

    }

    __asm
        {
            movsd resVal,xmm7;//placing xmm7 into resVal
        } 
```

这是来自 C++ 编译器的反汇编代码，用于代码“resVal+=val1+val2+val3+val4+val5+val6+val7”：

```
movsd       xmm0,mmword ptr [val1]  
addsd       xmm0,mmword ptr [val2]  
addsd       xmm0,mmword ptr [val3]  
addsd       xmm0,mmword ptr [val4]  
addsd       xmm0,mmword ptr [val5]  
addsd       xmm0,mmword ptr [val6]  
addsd       xmm0,mmword ptr [val7]  
addsd       xmm0,mmword ptr [resVal]  
movsd       mmword ptr [resVal],xmm0 
```

可以看出，编译器只使用一个 xmm0 寄存器，其他时候它从 RAM 中获取值。

两种代码（我的 ASM 代码和 c++ 代码）的答案是相同*的，但是 c++ 代码大约需要我的 asm 代码一半的时间来执行！*

我读过关于 CPU 寄存器的信息，使用它们比内存快得多。我不认为这个比例是真的。为什么 asm 版本的 C++ 代码性能较低？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-03-11T21:51:57.820

*   一旦数据在缓存中（在第一个循环之后就是这种情况，如果它还没有的话），使用内存或寄存器几乎没有什么区别。
*   首先，浮点加法将比单个周期花费更长的时间。
*   最终存储`resVal`“解开”xmm0 寄存器以允许寄存器自由“重命名”，这允许更多循环并行运行。

这是“除非你绝对确定，否则将代码留给编译器”的典型案例。

上面的最后一个项目解释了为什么代码比循环的每一步都依赖于先前计算的结果的代码更快。

在编译器生成的代码中，循环可以执行以下等效操作：

```
movsd       xmm0,mmword ptr [val1]  
addsd       xmm0,mmword ptr [val2]  
addsd       xmm0,mmword ptr [val3]  
addsd       xmm0,mmword ptr [val4]  
addsd       xmm0,mmword ptr [val5]  
addsd       xmm0,mmword ptr [val6]  
addsd       xmm0,mmword ptr [val7]  
addsd       xmm0,mmword ptr [resVal]  
movsd       mmword ptr [resVal],xmm0  

movsd       xmm1,mmword ptr [val1]  
addsd       xmm1,mmword ptr [val2]  
addsd       xmm1,mmword ptr [val3]  
addsd       xmm1,mmword ptr [val4]  
addsd       xmm1,mmword ptr [val5]  
addsd       xmm1,mmword ptr [val6]  
addsd       xmm1,mmword ptr [val7]  
addsd       xmm1,mmword ptr [resVal]  
movsd       mmword ptr [resVal],xmm1 
```

现在，如您所见，我们可以“混合”这两个“线程”：

```
movsd       xmm0,mmword ptr [val1]  
movsd       xmm1,mmword ptr [val1]  
addsd       xmm0,mmword ptr [val2]  
addsd       xmm1,mmword ptr [val2]  
addsd       xmm0,mmword ptr [val3]  
addsd       xmm1,mmword ptr [val3]  
addsd       xmm0,mmword ptr [val4]  
addsd       xmm1,mmword ptr [val4]  
addsd       xmm0,mmword ptr [val5]  
addsd       xmm1,mmword ptr [val5]  
addsd       xmm0,mmword ptr [val6]  
addsd       xmm1,mmword ptr [val6]  
addsd       xmm0,mmword ptr [val7]  
addsd       xmm1,mmword ptr [val7]  
addsd       xmm0,mmword ptr [resVal]  
movsd       mmword ptr [resVal],xmm0  
// Here we have to wait for resval to be uppdated!
addsd       xmm1,mmword ptr [resVal]  
movsd       mmword ptr [resVal],xmm1 
```

我并不是说它是乱序执行，但我当然可以看到循环如何比你的循环更快地执行。如果你有一个备用寄存器，你可能可以在你的汇编代码中实现同样的事情[在 x86_64 中你确实有另外 8 个寄存器，尽管你不能在 x86_64 中使用内联汇编...]

（请注意，寄存器重命名与我的“线程”循环不同，后者使用两个不同的寄存器 - 但效果大致相同，循环可以在命中“resVal”更新后继续，而无需等待结果更新）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-12-19T09:57:53.613

可能对您不使用 _asm 很有用，但内在函数和内在类型（如 __m128d 女巫的 __m128i）代表 sse 寄存器。请参阅 immintrin.h，它定义了类型和许多 sse 函数。您可以在这里找到它们的良好描述和规范：http: [//software.intel.com/sites/landingpage/IntrinsicsGuide/](http://software.intel.com/sites/landingpage/IntrinsicsGuide/)

# php - PHP 如何从数组中删除元素 - array_uniqe 不起作用

> ID：15349311
> 
> 赞同：5
> 
> 时间：2013-03-11T21:46:44.150
> 
> 标签：php, arrays, duplicate-removal

我在 PHP 中有一个数组，我在从这个数组中删除一些元素时遇到了问题。它看起来像这样：

```
Array
(
    [0] => 2x 633130A
    [1] => 2x 525130B
    [2] => 2x 591130B
    [3] => 2x 963130B
    [4] => 2x 813130B (20mm)
    [5] => 2x 813130B
    [6] => 2x 313130B (12mm)
    [7] => 2x 313130B
    [8] => 4x 413130B
    [9] => 2x 633130B
    [12] => 2x 381130A (23mm)
    [13] => 2x 381130A
) 
```

现在我想删除没有**mm**参数的重复元素，如下所示：

```
 FROM                =====>              TO          

Array                                   Array
(                                       (
    [0] => 2x 633130A                   [0] => 2x 633130A       
    [1] => 2x 525130B                   [1] => 2x 525130B
    [2] => 2x 591130B                   [2] => 2x 591130B
    [3] => 2x 963130B                   [3] => 2x 963130B
    [4] => 2x 813130B (20mm)            [4] => 2x 813130B (20mm)
    [5] => 2x 813130B <= REMOVE         [5] => 2x 313130B (12mm)
    [6] => 2x 313130B (12mm)            [6] => 4x 413130B
    [7] => 2x 313130B <= REMOVE         [7] => 2x 633130B
    [8] => 4x 413130B                   [8] => 2x 381130A (23mm)
    [9] => 2x 633130B                   )       
    [12] => 2x 381130A (23mm)                   
    [13] => 2x 381130A <= REMOVE
) 
```

我试过**array_unique**在这种情况下不起作用，因为元素不完全相同。谁能帮我删除那些重复的元素？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-11T22:01:53.937

在这种情况下，这将满足您的需要：

```
 foreach ($array as $value)
  {

    if (FALSE !== strpos($value, '('))
    {

      $string = trim(strtok($value, '('));

      while (FALSE !== $key = array_search($string, $array))
      {
        unset($array[$key]);
      }

    }

  } 
```

它将遍历数组，查找字符串中`(`包含 a 的任何元素，查找字符串匹配的任何元素`(`（修剪多余的空白），然后在找到时将其删除。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-11T22:02:06.487

```
$initialData = array(
    '2x 633130A',
    '2x 525130B',
    '2x 591130B',
    '2x 963130B',
    '2x 813130B (20mm)',
    '2x 813130B',
    '2x 313130B (12mm)',
    '2x 313130B',
    '4x 413130B',
    '2x 633130B',
    '2x 381130A (23mm)',
    '2x 381130A',
);

$filteredArray = array_filter(
    $initialData,
    function($value) use ($initialData) {
        if (strpos($value, 'mm') === FALSE) {
            foreach($initialData as $testData) {
                if (strlen($testData) > strlen($value) && 
                    substr($testData,0,strlen($value)) == $value) {
                    return FALSE;
                }
            }
        }
        return TRUE;
    }
);

var_dump($filteredArray); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-11T22:05:00.907

我写了一个自定义函数使用`preg_match()`

```
$array = array
(
    0 => '2x 633130A',
    1 => '2x 525130B',
    2 => '2x 591130B',
    3 => '2x 963130B',
    4 => '2x 813130B (20mm)',
    5 => '2x 813130B',
    6 => '2x 313130B (12mm)',
    7 => '2x 313130B',
    8 => '4x 413130B',
    9 => '2x 633130B',
    12 => '2x 381130A (23mm)',
    13 => '2x 381130A'
);

$results = array();
foreach($array as $element){
    if(!custom_exists($array, $element)){
        $results[] = $element;
    }
}

print_r($results);

function custom_exists($array, $val){
    foreach($array as $element){
        if($element != $val && preg_match("/$val/", $element)){
            return true;
        }
    }
    return false;
} 
```

# jquery - jQuery 正则表达式替换为字符串查找函数

> ID：15349312
> 
> 赞同：0
> 
> 时间：2013-03-11T21:46:44.210
> 
> 标签：jquery, regex, replace, ab-testing

我想替换 url 的特定部分，但仅在特定的 div 中，一直在尝试使用正则表达式（是的，我是正则表达式新手），但我无法理解如何让它工作并且会得到任何帮助

我想用新文件夹 /design/abtester/nyaproduktbilder/ 替换 /images/ 这样做的原因是我想用新产品图像运行站点范围的 A/B 测试

我有这部分代码

```
<div class="visaprodbild"><a class="fancyBoxLink" rel="produktbilder" href="/images/BR501.jpg"><img class="hand" alt="" title="" src="/images/BR501.jpg" border="0" width="330px"></a></div> 
```

问题是我不能只找到并替换 /images/ 部分，因为页面上使用 /images/ 有更多其他图像，我无法将原始产品图像移动到新文件夹。

所以我需要在上面的 div 中识别 /images/ 部分

抱歉，如果这是一个不清楚的帮助问题，但我太迷茫了，我几乎无法解释我需要做什么。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-11T21:58:52.230

我认为你甚至不需要正则表达式..你可以这样做`.replace('/images/','yournewpath')`

```
$('div.visaprodbild img.hand').attr('src',function(i,v){
    return v.replace('/images/','/your new path/');
}); 
```

通过使用[attr('src',function(i,v)](http://api.jquery.com/attr/#attr-attributeName-functionindex--attr) 旧值作为参数传入，您可以在函数内部返回修改后的值

[小提琴](http://jsfiddle.net/9GwD8/)

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-03-11T21:53:44.730

添加一个 ID`<a>`并`<img>`更改它的属性`$("#id").attr();`

# jquery - 将 Click 函数绑定到类不起作用

> ID：15349314
> 
> 赞同：0
> 
> 时间：2013-03-11T21:46:49.723
> 
> 标签：jquery, css, click

我对 JQuery 很陌生，并且我的代码有以下问题。我有一个 HTML 代码如下：

```
<div id="productsBox">
    <span class="productItem">
        <img class="ProductImage" src="/media/1656/FootballShirts.png "></img>
        <span class="productName">Football Shirts</span>
        <span class="relavantSizeAdvice">2189</span>
     </span>

    <span class="productItem">
        <img class="ProductImage" src="/media/1697/FootballShorts.png "></img>
        <span class="productName">Football Shorts</span>
        <span class="relavantSizeAdvice">2189</span>
    </span>

    <span class="productItem">
        <img class="ProductImage" src="/media/1702/FootballSocks.png "></img>
        <span class="productName">FootBall Socks</span>
        <span class="relavantSizeAdvice">2189</span>
    </span>
</div> 
```

我想将单击功能绑定到所有具有名为“productItem”的类的元素。我的 Jquery 代码如下：

```
$('.productItem').bind('click', function () {
        alert("Clicked!");
    }); 
```

在我的代码中，警报从未调用过，我在这里错过了什么？

有什么建议么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-11T21:51:39.363

您可能在加载跨度之前调用您的 jquery 代码。你有两个选择

在[DOM 准备好时执行此操作](http://api.jquery.com/ready/)

```
$(function(){
    $('.productItem').bind('click', function () {
        alert("Clicked!");
    });
}) 
```

或者使用[委托](http://api.jquery.com/on/)

```
$(document).on('click', '.productItem', function(){
    alert("Clicked")
}) 
```

[工作代码示例](http://jsfiddle.net/jJFAT/)

# magento - 如何正确添加 Magento 管理路由器以避免扩展之间的冲突

> ID：15349319
> 
> 赞同：0
> 
> 时间：2013-03-11T21:46:58.570
> 
> 标签：magento, magento-1.7

我正在尝试覆盖 Mage_Adminhtml_Catalog_Product 以添加将一些操作添加到“管理产品”页面的网格的功能。我想知道如何让路由器和重定向正确，以防止与其他扩展（例如增强型管理产品网格）发生冲突。

我想出了两个选项，两者都有效，但我不确定其中的含义。

**选项1**

使用标准的 adminhtml/catalog_product 路由器并简单地添加我的模块。这将`POST`新的网格动作到`www.mysite.com/index.php/admin/catalog_product/example`。

摘自`config.xml`：

```
<config>
   ...
   <admin>
      <routers>
         <adminhtml>
            <args>
               <modules>
                  <mymodule before="Mage_Adminhtml">MyCompany_MyModule</mymodule>
               </modules>
            </args>
         </adminhtml>
      </routers>
   </admin>
</config> 
```

观察者向网格添加动作：

```
class MyCompany_MyModule_Model_Observer {

   public function addExampleAction($observer) {
      $block = $observer->getEvent()->getBlock();
      if(get_class($block) =='Mage_Adminhtml_Block_Widget_Grid_Massaction'
         && $block->getRequest()->getControllerName() == 'catalog_product') {
         $block->addItem('example', array(
             'label' => 'execute exampleAction',
             'url' => $block->getUrl('adminhtml/*/example')
         ));
      }
   } 
```

注意`adminhtml`被指定为`$block->getUrl()`语句的第一部分。使用`*/*/example`，该模块将无法与“增强型管理产品网格”一起使用，因为它会`POST`-`www.mysite.com/index.php/enhancedgrid/catalog_product/example`不存在。（我想所有模块都会出现这个问题......重写路由？）

**选项 2**

向我的模块添加新路由。这将`POST`新的网格动作到`www.mysite.com/index.php/myrouter/catalog_product/example`。

摘自`config.xml`：

```
<config>
   ...
   <admin>
      <routers>
         <myroute>
            <use>admin</use>
            <args>
               <module>MyCompany_MyModule</module>
               <frontName>myroute</frontName>
            </args>
         </myroute>
      </routers>
   </admin>
</config> 
```

观察者向网格添加动作：

```
class MyCompany_MyModule_Model_Observer {

   public function addExampleAction($observer) {
      $block = $observer->getEvent()->getBlock();
      if(get_class($block) =='Mage_Adminhtml_Block_Widget_Grid_Massaction'
         && $block->getRequest()->getControllerName() == 'catalog_product') {
         $block->addItem('example', array(
             'label' => 'execute exampleAction',
             'url' => $block->getUrl('myroute/*/example')
         ));
      }
   } 
```

注意`$block->getUrl()`语句中的差异。

**问题**

1.  哪些选项可确保与其他扩展更好地兼容？或者，还有更好的方法？

2.  处理完操作后，我将在控制器类中重定向到哪里？这是我的简单控制器：

    ```
    class MyCompany_MyModule_Catalog_ProductController 
          extends Mage_Adminhtml_Catalog_ProductController {

        public function exampleAction() {
           ... do stuff ...
           $this->_redirect('*/*/index');
        }
    } 
    ```

    让我们假设也安装了增强型管理产品网格。使用选项 1，`*/*/index`重定向到`www.mysite.com/index.php/admin/catalog_product/index`. 虽然这很好用，但我的感觉是正确的 url 应该是`www.mysite.com/index.php/enhancedgrid/catalog_product/index`. 但是如果我不知道安装了哪些其他扩展，我不知道它是否真的很重要以及如何去做。

    使用选项 2，由于 MyCompany_MyModule_Catalog_ProductController 没有 indexAction() ，`*/*/index`重定向到会导致空白页面。`www.mysite.com/index.php/myrouter/catalog_product/index`所以我不得不`adminhtml/*/index`改用重定向到`www.mysite.com/index.php/admin/catalog_product/index`- 与上述相同的疑问......

**感谢任何花时间阅读这个冗长问题的人！！！**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-14T21:55:47.120

我做了一些研究并试图自己回答这些问题，至少对于第 1 点，我现在非常有信心：

1.  选项 1（使用标准管理员名称（adminhtml 路由器）而不是定义自定义名称）是首选方式，正如 Alan Storm[在此处](http://alanstorm.com/magento_dispatch_admin_cms_default_routers)解释的那样：

    *“虽然可以为管理路由器定义多个前名，但我建议不要这样做（尽管[之前有过建议](http://alanstorm.com/magento_admin_controllers)）。管理控制台应用程序的某些部分假定前名 admin。虽然页面将加载并使用备用管理员名称、某些功能（例如富文本编辑器的媒体库集成）可能不会。*

    *虽然可以解决这些特殊情况，但最好[将模块](http://web-magician.blogspot.com/2009/04/secret-feature-of-magento-13-sharing.html)滑入 admin front name/adminhtml config router 节点，然后注意控制器名称和 Mage_Adminhtml 模块控制器名称之间没有重叠。”*

2.  我仍然没有彻底理解，为什么`*/*/index`有效，它重定向到 www.mysite.com/index.php/admin/catalog_product/index 而不管其他模块中定义的重写。但它有效，所以我会留下它。

# perl - Perl 子例程获取参数而不发送任何参数

> ID：15349324
> 
> 赞同：1
> 
> 时间：2013-03-11T21:47:14.697
> 
> 标签：perl

我正在尝试对一些 Git 源代码进行一些黑客攻击（如在 Git 的源代码中，而不仅仅是一些由 Git 管理的随机代码）。我正在看的是 Perl，我无法理解发生了什么。

我对 Perl 的经验很少（而且有几年的经验）；我向几个有经验的朋友请教了一些建议，但他们一无所获。

相关代码在[v1.8.1.5 源代码](https://git.kernel.org/cgit/git/git.git/tag/?id=v1.8.1.5)中，其中[`git-svn.perl`](https://git.kernel.org/cgit/git/git.git/tree/git-svn.perl?id=e6363a4992637267ef212d7c709ede17d4122e0d)'s[`cmd_fetch`](https://git.kernel.org/cgit/git/git.git/tree/git-svn.perl?id=e6363a4992637267ef212d7c709ede17d4122e0d#n537)函数包括以下行：

```
$_fetch_all ? $gs->fetch_all : $gs->fetch; 
```

我对此的最佳解读是它会调用`fetch`or`fetch_all`函数（当然，我看不出它是如何做其他事情的）。

在[SVN.pm](https://git.kernel.org/cgit/git/git.git/tree/perl/Git/SVN.pm?id=e6363a4992637267ef212d7c709ede17d4122e0d)我们找到了这个[`fetch`函数](https://git.kernel.org/cgit/git/git.git/tree/perl/Git/SVN.pm?id=e6363a4992637267ef212d7c709ede17d4122e0d#1908)，它以下面一行开头：

```
my ($self, $min_rev, $max_rev, @parents) = @_; 
```

我认识到这是收集函数参数，但是（最后，我的问题）：**这些参数是从哪里传入的**？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-11T21:54:10.827

用箭头表示法调用的函数被称为*方法*。方法的第一个参数是调用其方法的对象。`$self`因此将设置为`$gs`。其余参数为空，因此`undef`.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-11T22:36:07.613

首先，我真的希望您引用的代码左侧有一个分配。使用条件运算符进行控制流是危害人类罪。也就是说，您对发生的事情的直觉是正确的：根据 的值`$_fetch_all`，要么 要么`$gs->fetch`被`$gs->fetch_all`调用。现在，进入论证问题。

Perl 方法调用通过将调用者添加到参数列表来传递参数，因此调用

```
$gs->fetch 
```

导致参数`($gs)`作为`@_`. 参数赋值行

```
my ($self, $min_rev, $max_rev, @parents) = @_; 
```

然后列出分配

```
my ($self, $min_rev, $max_rev, @parents) = ($gs); 
```

列表分配分配相应的元素，直到左侧的数组或哈希吃掉所有参数或受让人列表用尽，`undef`根据需要填充列表。所以`$self`gets`$gs`和get`$min_rev`并得到空列表。事实证明，这些都是有效值，因此不会发生任何不愉快的事情。`$max_rev``undef``@parents`

如果您想影响`$min_rev`et al. 的值，您可以将调用站点更改为读取

```
$gs->fetch(5, 9) 
```

（事实证明它`@parents`被忽略了，所以我不知道它的合法价值可能是什么）。

# c++ - pointer_traits 为既不是 X 的类型提供了什么也不提供成员 typedef element_type？

> ID：15349326
> 
> 赞同：4
> 
> 时间：2013-03-11T21:47:20.797
> 
> 标签：c++, pointers, c++11

跟风的结果是什么？它是不规范的、未定义的行为还是定义明确且规范的？

```
struct A {};
std::pointer_traits<A> x; 
```

我问的原因是因为我想知道好奇，因为我想知道任意类型是否是指针。有了这个，我还意味着包括 shared_ptr 和朋友。我想知道是否有一个类型特征（谓词），或者，如果没有，我是否可以使用 pointer_traits 并检测 element_type 是否被声明。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-11T21:58:19.067

它说它从 20.6.3p1 开始格式错误，因为它没有`element_type`并且不是类模板实例化

> typedef 见下文 element_type;
> 
> 类型：Ptr::element_type 如果存在这样的类型；否则，如果 Ptr 是形式的类模板实例化，则为 T `SomePointer<T, Args>`，其中 Args 是零个或多个类型参数；**否则，专业化是不正确的**。

# c - 收到字符串消息时出现分段错误

> ID：15349327
> 
> 赞同：-4
> 
> 时间：2013-03-11T21:47:24.733
> 
> 标签：c, string, sockets

我正在从用 C 实现的服务器向客户端发送字符串消息。为了做到这一点，我首先发送消息的长度，然后发送实际消息。以下是来自我的服务器的代码片段。

```
int length = strlen(message);
send(serversock, &length, sizeof (int), 0);
send(serversock, message, sizeof (char) * length, 0); 
```

以下是我客户的代码：

```
int length;
recv(clientsock, &length, sizeof (int), 0);

printf("size: %d\n", length);

char* message;
recv(clientsock, message, sizeof (char) * length, 0);
printf("Got Message %s\n", message); // I get Segmentation Fault here 
```

当我收到一条消息时，我尝试将其打印出来。但是，我遇到了分段错误。任何人都可以帮助我吗？

PS：我确实设法获得了长度值

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-11T21:49:56.300

```
char* message;
recv(clientsock, message, sizeof (char) * length, 0); 
```

您需要为`message`指向的分配内存。`message`在这里，您正在传递指针的未初始化值。用于`malloc`分配数组。假设`message`是一个字符串：

```
char *message = malloc(length + 1); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-11T21:50:58.080

`recv`不分配内存，你需要明确地这样做：

```
int length;
recv(clientsock, &length, sizeof (int), 0);

printf("size: %d\n", length);

char* message = malloc(length+1); /* read into here */
recv(clientsock, message, sizeof (char) * length, 0);
message[length] = '\0'; /* nul terminated for printing */
printf("Got Message %s\n", message);
free(message); /* and remember you own this buffer */ 
```

当您读取长度时，您正在读取一个已经存在的变量：`int length;`为整数保留空间。

但是，当您阅读该消息时，您使用了一个未初始化的指针，因此它尝试将消息写入某个随机位置（因此崩溃）：`char *message;`只为*指针*保留空间。

请注意，使用最近的 C 编译器，您可以使用

```
char message[length+1]; 
```

反而。这样您就不需要显式地`free`显示数组，但是如果数组`length`太大，您就没有机会优雅地处理故障。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-11T21:52:29.570

嗯，怎么样

```
send(serversock, &size, sizeof (int), 0); 
```

代表发送消息的大小？

在客户端代码中，长度从未初始化，并且您没有为“消息”分配任何内存。您是否显示所有涉及的代码。如果是这样，那么在调用 recv 之后，您的未分配 char* 消息肯定会覆盖一些随机内存位置。

# python - 使用 BeautifulSoup 的 replaceWith 将所有 'a' 标签替换为标签内容

> ID：15349332
> 
> 赞同：0
> 
> 时间：2013-03-11T21:47:29.320
> 
> 标签：python, html-parsing, beautifulsoup

编辑：基本上，我正在尝试执行分解，但不是删除标签并完全破坏其内容，我想用它的内容替换标签。

我想用字符串格式的标签内容替换 html 文档中的所有“a”标签。这将使我能够更轻松地将 html 写入 csv。但是，我无法通过替换步骤。我一直在尝试使用 BeautifulSoup 的 replace_with() 来完成它，但结果并没有按预期返回。

```
# Import modules
from bs4 import BeautifulSoup
from urllib2 import urlopen

# URL to soup
URL = 'http://www.barringtonhills-il.gov/foia/ordinances_12.htm'
html_content = urlopen(URL).read()
soup = BeautifulSoup(html_content)

# Replaces links with link text
links = soup.find_all('a')
for link in links:
    linkText = link.contents[0]
    linkTextCln = '%s' % (linkText.string)
    if linkTextCln != 'None':
        link.replaceWith(linkTextCln)
        print link 
```

这将返回：

```
<a href="index.htm">Home</a>
<a href="instruct.htm">Instructions</a>
<a href="requests.htm">FOIA Requests</a>
<a href="kiosk.htm">FOIA Kiosk</a>
<a href="geninfo.htm">Government Profile</a>
etc etc etc 
```

但预期回报是：

```
Home
Instructions
FOIA Requests
FOIA Kiosk
Government Profile
etc etc etc 
```

关于为什么 replaceWith 没有按预期工作的任何想法？有没有更好的方法来解决这个问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2016-03-02T21:28:57.600

我相信使用 bs4，方法是现在`replace_with`，但如果您只是想输出标签的内容，以下工作：

```
from bs4 import BeautifulSoup

s = '''
<a href="index.htm">Home</a>
<a href="instruct.htm">Instructions</a>
<a href="requests.htm">FOIA Requests</a>
<a href="kiosk.htm">FOIA Kiosk</a>
<a href="geninfo.htm">Government Profile</a>
'''
soup = BeautifulSoup(s, 'html.parser')

for tag in soup.findAll('a'):
    print(tag.string) 
```

输出：

```
Home
Instructions
FOIA Requests
FOIA Kiosk
Government Profile
[Finished in 0.2s] 
```

# vb.net - 无法通过图形 API 手动输入事件地址

> ID：15349334
> 
> 赞同：1
> 
> 时间：2013-03-11T21:47:36.360
> 
> 标签：vb.net, facebook, facebook-graph-api, facebook-events

更改我们的应用程序以使用新的事件时区迁移后，我无法再显示事件地址。我曾经用街道、城市、州、邮编和国家来传递场地对象。然后我也会直接将这些信息放在事件对象中（因为即使 api 说它在那里，场地也从来没有工作过）。

从“从页面创建事件”的图形 api 文档看来，他们已经取消了场所（并直接输入地址信息），现在只有 location 和 location_id。我需要能够手动输入地址信息并将其显示在活动中，因为我不能保证我们的客户场所存在现有的 Facebook 位置。这还有可能吗？

```
var eventData = {
                name: "<%= Me.EventName %>",
                page_id: "<%= Me.CurrentAcct.FacebookPageID %>",
                description: "<%= Me.EventDescription.Trim() %>",
                start_time: starttime,
                location: "<%= abc.Web.Script.Serialization.JavaScriptString.QuoteString(Me.Venue.Title) %>",
                street: "<%= abc.Web.Script.Serialization.JavaScriptString.QuoteString((Me.Venue.Address1.Trim() + " " + Me.Venue.Address2.Trim()).Trim()) %>",
                city: "<%= abc.Web.Script.Serialization.JavaScriptString.QuoteString(Me.Venue.City) %>",
                state: "<%= Me.Venue.State %>",
                zip: "<%= Me.Venue.Zip %>",
                country: "<%= Me.Venue.TwoLetterISORegionName %>",
                privacy: "<%= Me.Privacy %>",
                ticket_uri: "<%= PublicPageHelpers.BuyTicketsURL(CurrentAcct.Key, objEvent.ID, String.Empty, LinkTypes.Absolute) %>"
           } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-15T15:34:00.933

因此，在浪费了几天时间试图弄清楚如何在事件页面上将位置显示为字符串之后，这就是我学到的。不要将街道、城市、州、邮编、国家传递到事件对象或场地对象中。如果你这样做了，facebook 将尝试使用他们自己的 Venue 位置并将其绘制在地图上，这会导致只有在该位置不存在时才会显示 City。facebook 也不会显示您传入的位置字符串，而只会显示地图。因此，只要您提供位置字段而不将地址传递到其他地方，您就可以在事件页面上将其显示为字符串。

```
var eventData = {
                name: "<%= Me.EventName %>",
                page_id: "<%= Me.CurrentAcct.FacebookPageID %>",
                description: "<%= Me.EventDescription.Trim() %>",
                start_time: starttime,
                location: "<%= abc.Web.Script.Serialization.JavaScriptString.QuoteString(Me.Venue.Title) +"\r\n"+ abc.Web.Script.Serialization.JavaScriptString.QuoteString((Me.Venue.Address1.Trim() +" "+ Me.Venue.Address2.Trim()).Trim()) +"\r\n"+ abc.Web.Script.Serialization.JavaScriptString.QuoteString(Me.Venue.City) +", "+ Me.Venue.State +" "+ Me.Venue.Zip %>",
                privacy: "<%= Me.Privacy %>",
                ticket_uri: "<%= PublicPageHelpers.BuyTicketsURL() %>"
           } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-11T22:04:10.877

> […] 现在只有 location 和 location_id。我需要能够手动输入地址信息并将其显示在活动中，因为我不能保证我们的客户场所存在现有的 Facebook 位置。这还有可能吗？

是的 - 使用您提到的第一个字段，`location`.

它的类型是 just `string`，你可以在其中传递任何你喜欢的东西。（虽然我不知道应用了什么字符限制，但我认为对于“正常”地址来说应该足够了。）

# gdal - OGR GetX 总是返回零

> ID：15349335
> 
> 赞同：0
> 
> 时间：2013-03-11T21:47:37.120
> 
> 标签：gdal, ogr

我正在尝试获取多边形的第一个 x 坐标。但是我只得到零作为回报。是什么原因造成的？

```
import os, sys, gdal, ogr
from gdalconst import *

driver = ogr.GetDriverByName('ESRI Shapefile')
testarea = driver.Open('testarea.shp', 0)
testarealyr = testarea.GetLayer()
testareafeature = testarealyr.GetNextFeature()

# get the x,y coordinates for the point
testareageom = testareafeature.GetGeometryRef()
print testareageom

x = testareageom.GetX()
print x

>>> 
POLYGON ((-124.1963006330602 43.006410659375554,-124.1861022086067 43.006647759060762,-124.1858958821004 43.00274627515271,-124.19612378176909 43.002422936639086,-124.19612378176909 43.002422936639086,-124.1963006330602 43.006410659375554))
0.0
>>> 
```

# ms-access - 跟踪通过 Access 数据库中的查询所做的更改

> ID：15349342
> 
> 赞同：0
> 
> 时间：2013-03-11T21:47:55.693
> 
> 标签：ms-access, journaling

我正在使用 Access 数据库，并找到了跟踪通过表单所做的更改的工具。我知道无法直接通过表跟踪所做的更改，但我很难确定是否可以跟踪通过 SQL 更新语句所做的更改？我猜这是不可能的，但如果有人对如何做到这一点有想法，将不胜感激。也许通过宏？

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-11T22:21:18.140

如果使用 2010 或更高版本，您可以使用表触发器和存储过程。这实际上允许您记录用户更新数据所做的更改：

使用表单，使用 VBA 代码和记录集，使用 SQL 更新查询。

因此，对任何行的更新都会导致表触发器运行。我不能说您想编写太多代码，但您确实有可以在更新行时运行的表级代码，以及更新是如何发生的。

因此，作为结果 VBA 代码、reocrdsets、表单或 SQL 更新的行更新将使该表代码运行。

如前所述，您需要运行 Access 2010 或更高版本才能使用此功能。

# java - 协助创建 XSD 的 Java 库？

> ID：15349343
> 
> 赞同：1
> 
> 时间：2013-03-11T21:48:12.677
> 
> 标签：java, xml, xsd, schema

有没有人知道一个库，它使在 Java 中创建 XSD 的过程比使用 DocumentBuilder 之类的东西更容易一些？类似于助手或实用程序类的东西。我遇到了 org.eclipse.xsd maven jar，但是在 Eclipse 中使用它时遇到了 ClassNotFoundException 问题，我不完全确定它是否应该用作独立的东西。这对谷歌来说也有点困难，因为有很多关于从 Java 到 XSD 的自动生成/翻译的搜索结果，反之亦然。

本质上，我需要做的是从某个数据源（而不是 Java 类）以编程方式创建 XSD。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-11T23:19:12.713

[Apache XMLSchema](http://ws.apache.org/commons/xmlschema20/)是`a lightweight Java object model that can be used to manipulate and generate XML schema representations. You can use it to read XML Schema (xsd) files into memory and analyze or modify them, or to create entirely new schemas from scratch.`

使用此 API 可以从头开始创建 XSD，这听起来是实现问题的起点；至于适应度，这取决于“某些数据源”是什么。

# asp.net-mvc - MVC4 中自定义编辑器模板的客户端验证

> ID：15349344
> 
> 赞同：1
> 
> 时间：2013-03-11T21:48:18.030
> 
> 标签：asp.net-mvc, asp.net-mvc-3, razor, asp.net-mvc-4, mvc-editor-templates

我有一个包含对象的 viewModel。我为该对象定义了一个自定义编辑器模板，它允许我编辑该对象的每个子对象。子值在服务器端不是必需的（所以我没有任何必需的注释），但是如果用户到达这个特定的输入，它应该是必需的。

有什么方法可以在 POST 方法中检查这些子对象（在 viewModel 中）的值，如果它们为空，则向视图返回一些错误？

我正在使用剃须刀。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-12T00:44:40.847

在服务器端，您可以在操作中检查类的子对象，

```
[HttpPost]
public ActionResult Edit(MyClass myClass)
{
    if (myClass.Children.Any(child => child == null))
    {
        foreach(var child in myClass.Children
            .Where(child => child == null)
            .Select((item, index) => new { Item = item, Index = index))
        {

             ModelState.AddModelError(
                 string.Format("Children[{0}]", child.Index), 
                 "Must be required");
        }

        return this.View("...");
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-11T23:10:53.413

您可以做的是编写一个检查用户输入的函数（在该字段中更改）

> 如果用户到达这个特定的输入

如果用户到达该特定输入，您可以使用 jQuery 将`@class = "required"`HTML 属性添加到您的对象。从那一刻起，它将成为`required`

看看[这里](http://docs.jquery.com/Plugins/Validation/Methods/required#dependency-expression)：这是基于某些条件的必填字段的 jQuery 验证器。我想这正是你所追求的

**编辑**

您的另一个选择是使用 AJAX 返回服务器以验证您要查找的内容。例子在[这里](http://blog.bobcravens.com/2009/11/ajax-calls-to-asp-net-mvc-action-methods-using-jquery/)

希望这是有道理的，对你有帮助。

# c# - 无法设置会话变量

> ID：15349347
> 
> 赞同：3
> 
> 时间：2013-03-11T21:48:26.447
> 
> 标签：c#, asp.net-mvc, unit-testing

我试图设置会话变量以运行一些单元测试没有成功。当我尝试设置会话变量时，我不断收到“System.NullReferenceException：对象引用未设置为对象的实例”的错误。

这是我正在构建的测试：

```
[TestMethod]
public void MyMethod()
{
  //Arrange
  int id = 12345;
  string action = "A";
  string comment = "";
  string user = "user";
  var controller = new MyController();

  //Act
  controller.Session["altUser"] = user;
  var result = controller.Process(id, action, comment);

  //Assert
  Assert.IsNotNull(result);     
} 
```

这是我的控制器：

```
[Authorize]
public class MyController : Controller
{
  public ActionResult Process(int id, string action, string comment)
  {
    string userId = Session["altUser"].ToString();
    //some other stuff that evaluates ID, Action, and Comment
  }
} 
```

但是，当我运行应用程序本身时，没有错误并且应用程序可以正常运行。我确实明白，通过测试驱动开发，测试应该为实现铺平道路。我正在尝试对已经完成的应用程序进行单元测试的一些练习。如果可能的话，由于应用程序工作正常，我想避免对我的实现进行任何更改，而只是编写一个单元测试来支持我已经知道的内容。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-03-11T21:57:50.873

控制器从 中获取会话，该会话`HttpContext`在您的单元测试中不存在，这就是它失败的原因。

但是，您也可以模拟`HttpContext`并在其中放置模拟会话。

像这样的东西可能会起作用（使用 moq 作为 Mocking 框架）

```
 var mockControllerContext = new Mock<ControllerContext>();
    var mockSession = new Mock<HttpSessionStateBase>();
    mockSession.SetupGet(s => s["altUser"]).Returns("user");
    mockControllerContext.Setup(p => p.HttpContext.Session).Returns(mockSession.Object);

    var controller = new MyController();
    controller.ControllerContext = mockControllerContext.Object; 
```

您显然需要用您实际想要输出的详细信息填充模拟对象。

`HttpSessionStateBase`您还可以从并`HttpContextBase`使用它们而不是真正的会话派生自己的类。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-11T21:57:05.620

没有勺子，呃，会话——当您执行单元测试时，ASP.NET 运行程序既没有初始化也没有运行。您应该分解`Session`代码外部的所有依赖项，并使单元测试所需的类和方法独立于 ASP.NET 的运行时功能。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-11T21:57:03.213

当您运行单元测试时，您不是通过 Web 服务器运行程序，因此无法访问任何 HttpContext 或 ASP.NET 会话，而当您在 VS 中通过调试运行程序时，您使用的是内置 Visual Studio Web 服务器，使程序能够使用会话。

[这](http://www.codeproject.com/Articles/32545/Exploring-Session-in-ASP-Net)是一篇带您了解 ASP.NET 会话及其工作原理的文章。

# c# - 在 linq 查询中转换泛型类型

> ID：15349348
> 
> 赞同：6
> 
> 时间：2013-03-11T21:48:32.803
> 
> 标签：c#, .net, linq, generics, casting

所以我有一个接受泛型类型参数的类，如果类型参数是给定类型的子类，它会做一些特殊处理。

```
IEnumerable<T> models = ...

// Special handling of MySpecialModel
if (filterString != null && typeof(MySpecialModel).IsAssignableFrom(typeof(T)))
{
    var filters = filterString.Split(...);
    models = 
        from m in models.Cast<MySpecialModel>()
        where (from t in m.Tags
               from f in filters 
               where t.IndexOf(f, StringComparison.CurrentCultureIgnoreCase) >= 0
               select t)
              .Any()
        select (T)m;
} 
```

但我在最后一行遇到了一个例外

```
Cannot convert type 'MySpecialModel' to 'T' 
```

如果我将代码更改为使用`as`而不是强制转换，我会收到此错误。

```
The type parameter 'T' cannot be used with the 'as' operator because it does not have a class type constraint nor a 'class' constraint. 
```

我在这里想念什么？

**更新**

此类需要可以采用任何类型参数，包括`struct`s 和内置类型，因此在我的情况下，泛型约束不是合适的解决方案。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-11T21:50:03.783

~~做`Select(x => (MySpecialModel)x)`~~

~~LINQ`Cast<T>`方法仅适用于将元素转换为该元素已经存在的元素（例如基类型、派生类型或接口）。它不打算将能够转换为目标类型的对象转换为目标类型。（例如`new List<int>{1,2,3}.Cast<long>()`也会抛出异常。~~

上面的答案没有错，但它没有解决问题。

仅仅因为您已经通过反射证明了泛型参数绑定到给定类型，并不意味着编译器知道它是。为了完成这项工作，您需要将您的`T`实例转换为通用类型（例如`object`），然后将其转换为特定类型。例如（将查询中的最后一行更改为`select (T)(object)m`应该可以解决问题。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-11T22:03:34.493

尝试以下

```
select (T)(object)m; 
```

在运行时，您已验证它`T`是 的子类型，`MySpecialModel`但编译器在编译时无权访问此信息。它只看到了 2 种不相关类型之间的尝试转换：`T`和`MySpecialModel`.

要解决此问题，您需要`object`充当中间人。编译器了解如何转换`MySpecialModel`为`object`和从`object`to `T`。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-11T22:03:00.470

最直接的解决方法是在转换为`object`之前先转换为`T`：

```
select (T)(object)m; 
```

问题是您的检查发生在运行时，但编译器不知道它`T`必须是语句中`MySpecialModel`的一个实例。`if`因此，它只是看到您正在尝试转换为不安全的任意类型，因此出现错误`T`。`MySpecialModel`

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-03-11T21:53:40.983

如果你知道泛型类型总是一个类，你可以在你的类上添加一个类型约束：

```
public class Test<T> where T : class {} 
```

**否则，按照smartcaveman**的建议，通过对象执行双重转换：

```
.Select(x => (T)(object)x); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-03-11T21:52:30.517

要使用`as`关键字，请将`class`约束放在泛型参数上：

```
void MyMethod<T>(T item) where T : class
{
    //...
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-03-11T22:01:00.513

您可能会应用`Nullable<T>`约束 - 这应该能够进行投射（至少使用“as”）。

# java - AudioManager 在死线程上向 Handler 发送消息？

> ID：15349349
> 
> 赞同：7
> 
> 时间：2013-03-11T21:48:34.207
> 
> 标签：java, android, android-audiomanager, android-handler

我正在尝试以编程方式将音量提高到`STREAM_MUSIC`流的最大值，但是当我这样做时，我遇到了*“向死线程上的处理程序发送消息”的*问题。此外，它似乎不会在 100% 的时间里提高音量，尽管当我收到这个错误时，它会在大多数情况下提高音量。

代码是：

```
System.out.println("Maximum volume for this stream is: "+maxstreamvol+" and it used to be set to: "+currentvol);     
final AudioManager am = (AudioManager)this.getSystemService(Context.AUDIO_SERVICE);
am.setStreamVolume(AudioManager.STREAM_MUSIC, maxstreamvol, AudioManager.FLAG_SHOW_UI);
am.setStreamSolo(AudioManager.STREAM_MUSIC, true);
System.out.println("Volume Raised!"); 
```

谷歌搜索后，似乎这个错误与多线程情况有关......此时的代码应该在UI线程上运行。

事实上，我什至用以下内容包围了它：

```
runOnUiThread(new Runnable() {

    public void run() {
        // code_goes_here
    }
}); 
```

而且，这产生了同样的错误。我看到的错误是这样的：

```
I/System.out(24949): Maximum volume for this stream is: 15 and it used to be set to: 0
W/MessageQueue(  490): Handler (android.media.AudioManager$FocusEventHandlerDelegate$1) {42b52f28} sending message to a Handler on a dead thread
W/MessageQueue(  490): java.lang.RuntimeException: Handler (android.media.AudioManager$FocusEventHandlerDelegate$1) {42b52f28} sending message to a Handler on a dead thread
W/MessageQueue(  490):  at android.os.MessageQueue.enqueueMessage(MessageQueue.java:294)
W/MessageQueue(  490):  at android.os.Handler.enqueueMessage(Handler.java:618)
W/MessageQueue(  490):  at android.os.Handler.sendMessageAtTime(Handler.java:587)
W/MessageQueue(  490):  at android.os.Handler.sendMessageDelayed(Handler.java:558)
W/MessageQueue(  490):  at android.os.Handler.sendMessage(Handler.java:495)
W/MessageQueue(  490):  at android.media.AudioManager$1.dispatchAudioFocusChange(AudioManager.java:1894)
W/MessageQueue(  490):  at android.media.IAudioFocusDispatcher$Stub.onTransact(IAudioFocusDispatcher.java:57)
W/MessageQueue(  490):  at android.os.Binder.execTransact(Binder.java:351)
W/MessageQueue(  490):  at dalvik.system.NativeStart.run(Native Method)
I/System.out(24949): Volume Raised! 
```

有人知道这里发生了什么吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-12T04:46:44.540

您的问题可能与此线程上报告的问题有关 - [onPostExecute not being called in AsyncTask (Handler runtime exception)](https://stackoverflow.com/questions/4280330/onpostexecute-not-being-called-in-asynctask-handler-runtime-exception)

音频焦点更改的显示正在触发 android 无法完成的 UI 事件。目前尚不清楚为什么会这样。也许音频管理器是在一个上下文中获得的，而显示音量的 toast 是在另一个上下文中执行的？一个快速而肮脏的更改是将标志交换为 FLAG_VIBRATE 并检查是否有区别。这会将问题缩小到 UI 更新，然后您可以进行处理。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-05-31T11:05:52.283

AudioManager 使用它创建的线程来调用您的回调或进行 UI 操作（显示 Volume toast 等）
（通过[Looper.myLooper](https://developer.android.com/reference/android/os/Looper.html#myLooper())或[getMainLooper](https://developer.android.com/reference/android/os/Looper.html#getMainLooper())，请参阅[此](https://android.googlesource.com/platform/frameworks/base/+/master/media/java/android/media/AudioManager.java#2136)）。

所以你应该确保你的*第一次*调用`Context.getSystemService(AUDIO_MANAGER)`发生在 UI 线程上。
（不确定子序列调用是否会重用该实例，但即使我重新检索 AudioManager，异常仍然会发生）

我今天遇到了这个问题，并通过将该调用添加到我的 Application.onCreate() 来解决它。（有点类似于[这个](https://stackoverflow.com/a/7818839/1562087)答案？）

# ruby-on-rails - 根据动作的 id 渲染 Rails 部分

> ID：15349350
> 
> 赞同：0
> 
> 时间：2013-03-11T21:48:42.117
> 
> 标签：ruby-on-rails, model-view-controller, params, spree

我正在建立一个销售各种男士和女士服装的小型电子商务网站。我想根据用户所在的分类来呈现部分内容。例如，如果用户在 mysite.com/t/women/pants 我想呈现 _women.html.erb，或者，如果用户是在 mysite.com/t/men/shirts 我想渲染 _men.html.erb。

我有一个分类模型 has_many taxon，而分类模型 has_many products。

在 taxons_controller.rb 我有：

```
def show
  @taxon = Taxon.find_by_permalink(params[:id])
  return unless @taxon
  @taxonomy = Spree::Taxonomy.all
  @taxon_title = Spree::Taxon.all 

  @searcher = Spree::Config.searcher_class.new(params.merge(:taxon => @taxon.id))
  @searcher.current_user = try_spree_current_user
  @searcher.current_currency = current_currency
  @products = @searcher.retrieve_products

  respond_with(@taxon)
end 
```

在 taxons#show 我有：（我知道这是错误的）

```
 <% @taxon_title.each do |title| %>
  <% @taxonomy.each do |taxonomy| %>
  <% if title.name == taxonomy.name %>
    <%= render "spree/shared/#{title.name.downcase}" %>
  <% end %>
  <% end %>
  <% end %> 
```

当我访问 mysite.com/t/women/long-sleeve 时，rails 调试器显示：

```
controller: spree/taxons
action: show
id: women/long-sleeve 
```

如何访问内部操作的 id，以便在控制器/视图中执行以下操作：

'如果 id 等于 'women' 渲染“spree/shared/#{title.name.downcase}”'

title 是分类的名称？

我想我需要 find(params[:something] 在控制器的显示动作中，但我对 params 有点不清楚。

* * * @beck03076 这是一个很棒的技巧。非常感谢你。但它仍然无法正常工作。

在我的控制器中，我放了：

@taxon_id = Spree::Taxon.find(params[:id])

然后在我提出的行动中：

如果@taxon_id == params[:id] 渲染'spree/shared/women'

当我加载页面时，它显示“您要查找的页面不存在”。我的部分在正确的目录中。我的语法正确吗？

我的参数是：

{"controller"=>"spree/taxons", "action"=>"show", "id"=>"women/long-sleeve"}

再次感谢您的帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-11T22:06:02.663

每当您不清楚参数时，只需将下面的行放在操作中并执行操作即可。

```
p "****************************"
p params
p "****************************" 
```

现在，转到您启动服务器的终端。

找到这两个“ ***** ** *** ** ***** ”，它们之间的所有内容都是参数。

params 基本上是一个红宝石哈希。

例子：

参数看起来像这样，{:controller => "hello",:action => "bye", :id => 7, :others => "OK"}

在您的控制器中访问 id，使用 params[:id].(=7)

要访问其他人，请使用 params[:others].(="OK")

# c++ - Fstream 类 - 关于'>>'操作符的问题

> ID：15349353
> 
> 赞同：1
> 
> 时间：2013-03-11T21:48:57.313
> 
> 标签：c++, arrays, stream, text-files, fstream

一个简单的程序，它使用 .txt 文件中的 int 数字创建数组，看起来像

```
2 3
5 7
4 2
y x
y x
... 
```

所以它很简单 nx2 （其中 n 可以是无限行）。然后用该数组填充新文件（稍后我将添加代码以使用一些有趣的算法编辑该数组）。

我写过：

```
#include <iostream>
#include <fstream>
#include <cstdlib>
using namespace std;
int main(){
    ofstream outFile;
    ofstream fout;
    fout.open("krol.txt");
    int l=0;
    int i=2;
    char ch;
    while (fout.good()){
        if (fout >> ch=='\n') l++;
    }
    fout.close();
    fout.open("krol.txt");
    int temp[l][2];
    int savel=l;
    l=0;
        while (fout >> (temp[l][i])){
        i++;
        if(i==2){ 
         i=0; l++;
        }
    }
    outFile.open("save.txt");
    for (int i=0, j=0;j<savel;i++){
        if (i==2) {
        i=0; j++;
        }
        outFile << temp[j][i];
    }
    system("PAUSE");
    return 0;
    } 
```

但它返回：

```
13 15 C:\Users\Filip\Dysk Google\Infa\krol.cpp [Error] no match for 'operator>>' in 'fout >> ch' 

20 29 C:\Users\Filip\Dysk Google\Infa\krol.cpp [Error] no match for 'operator>>' in 'fout >> temp[l][i]' 
```

有任何想法吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-11T21:54:38.097

`ofstream`是*输出*文件流；您无法使用`>>`.

而不是`ofstream fout;`我怀疑你想要`ifstream fin;`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-11T21:55:03.350

[`std::ofstream`](http://en.cppreference.com/w/cpp/io/basic_ofstream)是一个输出流，所以它没有输入流运算符>>。如果要流式传输到文件中，则需要`std::ifstream`.

# php - 来自数据库查询的 JSON 数组

> ID：15349354
> 
> 赞同：0
> 
> 时间：2013-03-11T21:48:57.630
> 
> 标签：php, javascript, sql-server, ajax

我想将数据库中的数据查询到一个 json 数组中，该数组最终会在 javascript 中生成一个力有向图。这是 Json 数组在最终结果中的样子。但是节点可以有多个邻接或没有，我如何查询一个json数组，其中邻接部分因节点而异，并且能够根据节点的邻接数量进行调整？

```
Var JSON =[ 
 {
  "adjacencies": [
    {
      "nodeTo": "graphnode9", 
      "nodeFrom": "graphnode5", 
      "data": {}
    }
  ], 
  "data": {
    "$color": "#416D9C", 
    "$type": "star"
  }, 
  "id": "graphnode5", 
  "name": "graphnode5"
},
]; 
```

到目前为止，这是我的尝试，但是这只产生一个只允许一个邻接的 json，我如何设置一个 Json 查询来调整节点具有的邻接数量，而不是将自身限制为一组数组形式或数组结构?

这是我的数据库结构

```
nodes                 Relationships                      
-----                 -------------
id int(11),           id int(11),
name varchar(35),     to int(11), //this is the destination node from the id relation 
color varchar(7),     data varchar(0) null
type varchar (12),    Foreign key (id) references nodes(id)
Primary key (id)       

engine = innodb 
```

这是我的尝试

```
function getjson()
{
 $db = adodbConnect();
 $query = "SELECT nodes.*, relationships.* FROM nodes LEFT JOIN relationships ON nodes.id    = relationships.id";
 $result = $db -> Execute($query);
 $count=$result->RowCount();
 $row=$result->FetchRow();

 $array= array[];

 while ($row)
  {
  $id= $row['id'];
  $name = $row['name'];
  $color1 = $row['color'];
  $type1 = $row['type'];
  $to=$row['to'];
  $array = [$id,$name,$color1,$type1,$to];
 }
 json_encode($array)
 } 
```

# php - .find() jQuery 在表格中不起作用

> ID：15349367
> 
> 赞同：0
> 
> 时间：2013-03-11T21:49:35.010
> 
> 标签：php, jquery

```
<tr id="<?php echo $id?>">
                        <input type="hidden" value="<?php echo $id?>"/>
                        <td> <?php echo $id;?> </td>
                        <td id="fname"> <?php echo $firstname[$key];?> </td>
                        <td id="lname"> <?php echo $lastname[$key];?> </td>
                        <td id="tage"> <?php echo $age[$key];?> </td>
                        </tr> 
```

jQuery：

```
$('.edit').click (function(){
        var id = $(this).parent().data('id'); 
        var fname =  $('#id').find('#fname');
        alert(fname);
    }); 
```

想要得到里面的文字`<td>`

在警报中它返回一个对象。我究竟做错了什么？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-11T21:51:17.260

您正在使用 a`string`而不是 jquery`object`作为选择器。

```
$(id).find('#fname') 
```

您可能会考虑这一点，如果您要检索的值是一个 id 的值，那么它需要哈希是一个有效的选择器：

```
 $('#' + id).find('#fname') 
```

此外，有效的标记要求 id 在页面上是唯一的。

# java - Math.hypo 函数

> ID：15349368
> 
> 赞同：3
> 
> 时间：2013-03-11T21:49:35.980
> 
> 标签：java, math, distance, hypotenuse

为什么数学运算 Math.sqrt(x*x+y*y) 比 Math.hypo(x,y) 快很多？

```
public class Teste {
    public static void main(String[] args) {
        long ta = System.currentTimeMillis();
        for( double x=0,y=0; x<5000000; x++,y+=2 ){
            double d = Math.sqrt(x*x+y*y);
        }
        long tb = System.currentTimeMillis();

        System.err.println((tb-ta));
        ta = System.currentTimeMillis();
        for( double x=0,y=0; x<5000000; x++,y+=2 ){
            double d = Math.hypot(x,y);
        }
        tb = System.currentTimeMillis();
        System.err.println((tb-ta));
    }
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-11T21:59:14.367

`hypot`通常以特殊方式实现以避免溢出和下溢问题。请注意，当or太大`sqrt(x*x+y*y)`时返回无穷大，当两者都太小时返回零。`x``y``x``y`

我认为解决这个困难的通常方法是计算`z = x/y`，检查是否`z*z`在合理范围内，然后找到`sqrt(1 + z*z) * y`. 太大`z*z`了可以直接退货`x`，`z*z`太小可以退货`y`。

`__ieee754_hypot`查看in顶部的评论`eglibc-2.11.3`，我看到以下评论：

```
 So, compute sqrt(x*x+y*y) with some care as
   follows to get the error below 1 ulp:

   Assume x>y>0;
   (if possible, set rounding to round-to-nearest)
   1\. if x > 2y  use
           x1*x1+(y*y+(x2*(x+x1))) for x*x+y*y
   where x1 = x with lower 32 bits cleared, x2 = x-x1; else
   2\. if x <= 2y use
           t1*y1+((x-y)*(x-y)+(t1*y2+t2*y))
   where t1 = 2x with lower 32 bits cleared, t2 = 2x-t1,
   y1= y with lower 32 bits chopped, y2 = y-y1. 
```

除非溢出或下溢，否则我看不出为什么`eglibc`会发生所有这些的原因。`x*x+y*y`

# c++ - 复制构造函数 - 使用相同变量按值调用函数两次导致问题？

> ID：15349374
> 
> 赞同：1
> 
> 时间：2013-03-11T21:50:01.890
> 
> 标签：c++, copy-constructor

我被指出以下文章：

[http://www.codeproject.com/Tips/78946/C-Copy-Constructor-in-depth](http://www.codeproject.com/Tips/78946/C-Copy-Constructor-in-depth)

我们有代码：

```
class string
{
    // constructor
    string(char* aStr)
    {
        str = new char[sizeof(aStr)];
        strcpy (str,aStr);
    }

    // destructor
    ~string() 
    {
        del str;
    }

    char *getChars(){ return str; }
    char* str;
};

void function (string str)
{
    // do something 
}

void main ()
{
    string str("hello");
    function(str);
    function(str); // program crashes
} 
```

我不明白为什么在`main`，第二次调用会有问题`function`？当然，当`str`传入第一次调用时，这只是一个副本，`str`因此对 inside 所做的任何事情`str`都`function`不会影响在 ? 中`str`声明的变量`main`？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-11T21:56:01.153

默认的复制构造函数对对象进行逐位复制。换句话说，指针成员被复制，而不是它指向的对象。**如果您使用默认构造函数并且只执行浅拷贝**，则两个对象中的指针将指向同一个对象。

**具体到您的问题：**

第一次调用`function(str)`一切正常时，当函数结束时，堆栈上的输入参数被销毁（这是 的副本`str`，但使用默认的复制构造函数，它的指针指向与原始对象相同的位置），并且它的将调用析构函数删除指针指向的对象。

第二次调用`function(str)`时，当函数结束时，析构函数将尝试释放 in 指针指向的地址`str`，然后崩溃。

**为避免此类问题，您应该定义自己的复制构造函数，它不仅正确复制指针，还正确复制对象，执行深度复制。**

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-11T21:56:09.347

问题是`str`你`string`类中的成员是一个指针。这意味着当创建字符串的副本时，会复制此指针的值，但指针的值只是一个内存位置。因此，当您调用 时`function(str)`，它正在修改该位置的内存，即使它没有修改指针的值。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-11T21:59:06.413

默认情况下，C++ 只知道如何使用默认复制构造函数对数据进行浅拷贝。所以，是的，第一次调用`function`确实制作了 的“副本” `str`，但是这个副本并不是一个副本，因为被复制的是`char*`字符串类的实例数据。即，C++ 只是复制一个地址，但还不够聪明，无法为新字符串实际分配空间并复制内容。您必须自己使用自定义复制构造函数来完成。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-12T04:11:37.977

的构造函数`str`没有为后续调用分配足够的字节`strcpy`。在那之后，所有的赌注都被取消了。修复后，编写适当的复制构造函数和复制赋值运算符。

# mysql - 如何添加外键（MySQL）

> ID：15349382
> 
> 赞同：31
> 
> 时间：2013-03-11T21:50:22.620
> 
> 标签：mysql, foreign-keys

我对 SQL 非常陌生，我正在尝试执行一个简单的 ALTER TABLE 来创建一个新列并将其用作外键来引用我数据库中的另一个简单表。我已将两个表都更改为 InnoDB

但是，在执行 ALTER TABLE 代码时，出现以下错误：

```
Error   1452    Cannot add or update a child row: 
a foreign key constraint fails (`toys`.<result 2 when 
explaining filename '#sql-6d4_6'>, CONSTRAINT 
`#sql-6d4_6_ibfk_1` FOREIGN KEY (`toy_id`) REFERENCES `toys` (`toy_id`)) 
```

下面是两张表的DESC：

表格1：

```
FIELD       TYPE     NULL   KEY     EXTRA
toy_id      int(11)  NO     PRI     auto_increment
toy varchar(50) YES 
```

表 2：

```
FIELD       TYPE        NULL   KEY     EXTRA
boy_id      int(11)     NO     PRI      auto_increment
boy         varchar(50) YES 
```

这是我试图执行的 ALTER 查询：

```
 ALTER TABLE boys
    ADD COLUMN toy_id INT NOT NULL,
    ADD CONSTRAINT toys_toy_id_fk
    FOREIGN KEY(toy_id)
    REFERENCES toys(toy_id); 
```

我已经四处寻找，试图弄清楚，但没有运气。在此先感谢，请善待这个新手:)

编辑：

以下是两个表的 SHOW CREATE TABLE：

表格1：

```
 CREATE TABLE `toys` (
      `toy_id` int(11) NOT NULL AUTO_INCREMENT,
      `toy` varchar(50) DEFAULT NULL,
      PRIMARY KEY (`toy_id`)
    ) ENGINE=InnoDB AUTO_INCREMENT=6 DEFAULT CHARSET=utf8 
```

表 2：

```
 CREATE TABLE `boys` (
      `boy_id` int(11) NOT NULL AUTO_INCREMENT,
      `boy` varchar(50) DEFAULT NULL,
      PRIMARY KEY (`boy_id`)
    ) ENGINE=InnoDB AUTO_INCREMENT=6 DEFAULT CHARSET=utf8 
```

* * *

## 回答 #1

> 赞同：45
> 
> 时间：2013-03-11T22:32:02.623

当列被限制为与父表中的值匹配的值时，您不能将 NOT NULL 列添加到具有多于零行的表中，但只有 NULL 值，因为它是一个新的、未填充的列，没有 DEFAULT .

解决方法是分阶段进行：添加列，但不要将其声明为 NOT NULL，也不要声明外键。

```
ALTER TABLE boys
 ADD COLUMN toy_id INT; 
```

然后用与您的玩具表中的某些值匹配的有效数据填充它。

```
UPDATE boys SET toy_id = ...; 
```

然后将该列更改为 NOT NULL，并创建约束：

```
ALTER TABLE boys MODIFY COLUMN toy_id INT NOT NULL,
 ADD CONSTRAINT toys_toy_id_fk
 FOREIGN KEY(toy_id)
 REFERENCES toys(toy_id); 
```

# android - Android - 我如何发送 GCM 推送通知，其中包含要加载哪个活动的说明？

> ID：15349385
> 
> 赞同：6
> 
> 时间：2013-03-11T21:50:41.460
> 
> 标签：android, push-notification, google-cloud-messaging

我能够创建推送通知。但目前我只能让人们登陆主屏幕。

如何将人们发送到特定的活动？是否也可以添加一些参数，如 item_id，以便活动知道要加载哪些数据？

或者，如果某处有一个很好的教程，那也很棒。我似乎无法通过谷歌搜索找到很多关于此的好信息。

在我的 GCMIntentService 我有这个方法：

```
 @Override
      protected void onMessage(Context ctxt, Intent message) 
      {           
        Bundle extras=message.getExtras();

        try
        {
            String question_id = extras.getString("question_id");
//          SharedPreferences prefs = PreferenceManager.getDefaultSharedPreferences( this );
//          Intent intent = new Intent(ctxt, QuestionActivity.class);

            generateNotification(ctxt, extras.getString("message"), "New Message"  );           
        }
        catch ( Exception e )
        {
        }
      } 
```

但我不确定如何更改 generateNotification 以指示该人应该登陆什么活动。谢谢！

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-03-11T22:03:38.253

更新：将 JSON 归功于 Eran，我只想详细说明。

您可以使用 data 键添加其他参数：

```
{
   "registration_ids" : ["APA91bHun4MxP5egoKMwt2KZFBaFUH-1RYqx..."],
   "data": {
       "stuff": "100",
       "more": "abc"
   },
} 
```

然后使用相同的方式访问`intent.getExtras().getString("stuff")`。

一切都[在这里](http://developer.android.com/google/gcm/gcm.html)。

然后在你的`generateNotifcation()`：

```
private static void generateNotification(Context context, String message) {
    NotificationManager notificationManager = (NotificationManager)
        context.getSystemService(Context.NOTIFICATION_SERVICE);
    Notification notification = new Notification(R.drawable.ic_launcher, message, when);
    String title = "...";

    //get id from json here and decide which activity to go to...
    Intent notificationIntent = new Intent(context, someClass.class);

    notificationIntent.putExtra("message",message);
    PendingIntent intent = PendingIntent.getActivity(context, 0, notificationIntent,PendingIntent.FLAG_UPDATE_CURRENT);
    notification.setLatestEventInfo(context, title, message, intent);
    notification.defaults|=Notification.DEFAULT_VIBRATE;
    notificationManager.notify(0, notification);
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-12T00:22:21.117

当然，您可以添加一个参数，例如`item_id`. 您可以将所需的任何参数添加到通知中。与 Apple 推送通知不同，没有预定义的有效负载参数，因此就像您有一个`message`参数一样，您可以有任何其他带有字符串值的参数（只要参数名称和值的总长度不超过 4096 字节） .

至于从通知中加载 Activity，您可以[在此处](http://developer.android.com/guide/topics/ui/notifiers/notifications.html)找到所需的一切。

# python - 不属于任何 ascii 超集的字符的消息的可测试性（例如：JIS X 0208）？

> ID：15349387
> 
> 赞同：4
> 
> 时间：2013-03-11T21:50:56.100
> 
> 标签：python, unit-testing, unicode, character-encoding

**我不想检查 Python 中的字符串是否为 ASCII。**:)

[HTTP 规范](https://datatracker.ietf.org/doc/html/draft-ietf-httpbis-p1-messaging-22#section-3)中有一个有趣的要求，我想知道如何实现和测试它。

> 接收者必须将 HTTP 消息解析为编码为 US-ASCII [USASCII] 超集的八位字节序列。
> 
> 由于字符串处理库处理包含八位字节 LF (%x0A) 的无效多字节字符序列的方式不同，将 HTTP 消息解析为 Unicode 字符流而不考虑特定编码会产生安全漏洞。

在另一个[stackoverflow 答案](https://stackoverflow.com/questions/6531750/character-set-that-is-not-a-superset-of-ascii)中，有一个字符集示例，它不是 US-ASCII 的超集。但我对测试该要求更感兴趣。或一种测试。这个要求只是意味着解析器必须选择一个 ASCII 的超集来吞下数据，但我想知道你是否想在之前检查消息中是否有任何奇怪的字符。

让我们说一个消息`MSG`。

```
def is_ascii_superset(self, MSG):
    "take any string, and return True or False"
    # Test here
    if test(MSG):
        return True
    else:
        return False 
```

如果有所有作为 ASCII 超集的字符集的列表，有什么想法吗？

**更新**：

人们似乎误解了这个问题。我不是在谈论查找字符串是否是 ASCII 的一部分。这是微不足道的。

*   ISO-8859-1、UTF-8 等是ASCII的**超集。**
*   JIS X 0208**不是**ASCII 的超集。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-11T21:55:15.173

您不必对其进行测试，您只需将所有内容都视为 ASCII 的超集，例如始终`%x0A`视为`LF`，假设下面的字符`%x7F`是 ASCII，并且不要尝试解析多字节序列。ASCII 的超集使用一个字节的每个值，没有“奇怪”的字符。

# javascript - jQuery UI - 如何检查可拖动项目是否捕捉

> ID：15349390
> 
> 赞同：1
> 
> 时间：2013-03-11T21:51:06.560
> 
> 标签：javascript, jquery-ui, jquery-ui-draggable, jquery-draggable

我遇到了 jQuery UI 条件的问题。

这是代码：

```
$(function() {
    $("#draggable2").draggable({ 
        snap: ".ui-widget-header",
        snapMode: "inner", 
        revert: true
    });
}); 
```

我的问题：

如何使用*if 语句*，以便我的可拖动项目在捕捉到我的*ui-widget-header时***不会**恢复？

 *非常感谢 ;）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-06-13T14:38:27.607

jQueryUI 确实保留了“捕捉”元素的内部“状态”，但您必须做一些工作才能做到这一点。

您将要为停止事件定义一个事件处理程序（当可拖动对象停止拖动时调用该事件处理程序）。

一个名为 snapElements 的数组保存在小部件数据中，它看起来像这样：

```
[ 
    { 
        height: 102, 
        item: { /* DOM element */ }, 
        left: 10, 
        snapping: false, 
        top: 10, 
        width: 102 
    }, ...
] 
```

您真正想要的是这里的`snapping`房产。捕捉将告诉您该项目当前是否“ `snapping`”到可拖动的对象。

该`snapElements`数组会针对每个事件进行更新，因此它在处理程序`drag`中始终是最新的。`drag`从那里，我们只需要`draggable`使用 data() 从关联元素中获取小部件实例。

考虑到这个数组，我们可以编写这样的代码来确定它是否捕捉到目标：

```
$("#draggable2").draggable({
    snap: ".ui-widget-header",
    snapMode: "inner", 
    revert: true
    stop: function(event, ui) {
        var draggable = $(this).data("draggable");
        $.each(draggable.snapElements, function(index, element) {
            if (element.snapping) {
                //i can't quit figure out how to stop the reverting from here, but here's you condition.
                console.log("Snapped !!");
            }
        });
    },
}); 
```

哦，我在网上找到了这个，希望对你有帮助。 [还原函数回调。](http://agilepro.com/mod_geek/javascript/jquery-ui-draggable-revert-callback/)*

# windows-phone-7 - 用二进制时钟制作活瓷砖？WP7

> ID：15349396
> 
> 赞同：0
> 
> 时间：2013-03-11T21:51:22.737
> 
> 标签：windows-phone-7, live-tile

几天前，我做了一个二进制时钟应用程序。它是这样工作的。

每次调度计时器滴答作响时，它都会将一些图像从一个源更新到另一个源。

因此，我一直在阅读有关制作自己的瓷砖的信息，并发现了一种名为 ree7 的东西，听起来像是我在寻找的东西。

但是在我读到这样的问题的任何地方，人们都说这是不可能的。那么有人知道这是否可能吗？

对不起我的拼写错误。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-11T21:54:29.643

最小的间隔是 1 小时`ShellTileScheduler`和 30 分钟`PeriodicAgent`，所以我很确定这对于一个看起来像时钟的瓷砖来说是不够的。

# jquery - 自动显示更改而不会失去焦点

> ID：15349410
> 
> 赞同：1
> 
> 时间：2013-03-11T21:52:21.963
> 
> 标签：jquery, focus

我目前有 2 个 div，我必须点击它们才能显示任何 % 变化。有没有一种方法可以调整代码以显示百分比变化而无需单击开箱即用？

**代码：**

```
$(document).ready(function () {
    $('.originalData').change(function () {
        $('.changedData').val($(this).val());
        $('.percentage').text('0%');

    });
    $('.changedData').change(function () {
        var changedData = $(this).val().length;
        var originalData = $('.originalData').val().length;

        var percentageOfChange = changedData / originalData * 100 - 100
        $('.percentage').text(percentageOfChange.toFixed(2) + '%');
    });
});

<div class="content">
<p>Original:</p>
<textarea class='originalData'></textarea>  
<p>Changed:</p>
<textarea class='changedData'></textarea>
<div class='percentage'></div> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-11T22:02:49.520

更新您使用`.change`的地方`.keyup`

# php - preg_match 匹配所有起始词

> ID：15349411
> 
> 赞同：1
> 
> 时间：2013-03-11T21:52:22.307
> 
> 标签：php, regex, preg-match, preg-match-all

我正在尝试从单词列表中获取所有匹配的模式；

```
$pattern = '/^(ab|abc|abcd|asdf)/';
preg_match_all($pattern, 'abcdefgh', $matches); 
```

我想得到' **ab，abc和abcd** '

但是这个返回只有' **ab** '。如果我在爆炸后遍历模式，它会起作用。

有没有办法通过单场比赛来解决它？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-11T21:58:37.537

正则表达式在通过字符串匹配时会消耗字符，因此它们本身无法找到重叠匹配。

您可以将前瞻断言等扩展功能与捕获组一起使用，但这需要一个丑陋的结构：

```
preg_match_all(
    '/^
    (?:(?=(ab)))?
    (?:(?=(abc)))?
    (?:(?=(abcd)))?
    (?:(?=(asdf)))?
    /x', 
    $subject, $result, PREG_SET_ORDER);
for ($matchi = 0; $matchi < count($result); $matchi++) {
    for ($backrefi = 0; $backrefi < count($result[$matchi]); $backrefi++) {
        # Matched text = $result[$matchi][$backrefi];
    } 
} 
```

# javascript - 两个小图像滑块问题

> ID：15349414
> 
> 赞同：0
> 
> 时间：2013-03-11T21:52:31.603
> 
> 标签：javascript, jquery

我想要完成的是从右侧只为选定的幻灯片设置动画并隐藏中间的幻灯片，第二个问题是当索引为零时，它会从左侧为幻灯片设置动画有没有人知道如何让它动画从右边开始 - 当索引为零时，它是列表中的第一个索引，距离左侧 330px [jsFiddle](http://jsfiddle.net/mdy5R/2/)

还有人知道如何在您选择幻灯片或单击下一个和上一个后重置我的计时器，如果您查看我的小提琴，则单击它会跳过一段时间，如果您继续单击，您会明白我的意思

```
$('.stages li a').on('click', function(e) {
    var slide = $('#' + $(this).data('slide'));
    $('.stages li').removeClass('selected');
    $(this).parent().addClass('selected');
    goto_slide(slide);          
});

function goto_slide(slide) {
    var index = $(slide).index();

    var count = index;

    $('.slides ul').animate({'left': '-=' + (item_width * (count - 1))}, 500, function() {
        $('.slides ul li').slice(0, count - 1).each(function() {
            $('.slides ul li:last').after($('.slides ul li:first'));
            $('.slides ul').css('left', '-330px');                      
        })  

    });

    $('#index').text(index);
} 
```

# java - 在播放框架中未正确显示德语变音符号 (i18n)

> ID：15349420
> 
> 赞同：0
> 
> 时间：2013-03-11T21:52:49.877
> 
> 标签：java, internationalization, playframework-2.0, playframework-2.1

我有以下设置：

**应用程序.conf**

```
application.langs="de" 
```

**消息.de**

```
deleteAlbum=Album Löschen 
```

在我使用的模板中：

```
@Messages.get("deleteAlbum") 
```

但是我在我得到的浏览器中查看它：

```
Album L�schen 
```

配置文件具有以下`messages.de`编码：

```
file messages.de 
messages.de: ISO-8859 text 
```

有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-11T21:57:13.173

该文件应以 UTF8 编码。这至少是 Play 1 中所要求的。我认为 Play 2 也是如此，尽管我没有找到文档中提到的任何内容。

# mysql - 插入和更新中的 SQL 错误

> ID：15349421
> 
> 赞同：-1
> 
> 时间：2013-03-11T21:52:50.070
> 
> 标签：mysql, sql

在过去的两个小时里，我一直在为此奋斗，我的头很痛。
我收到这个错误：

```
You have an error in your SQL syntax; 
check the manual that corresponds to your MySQL server version 
for the right syntax to use near '' at line 7 
```

这是我的桌子[http://i.imgur.com/5KzxxbR.png](http://i.imgur.com/5KzxxbR.png)

这是我的查询：

```
 if(!is_int($_POST['x']) || !is_int($_POST['x'])) break;

    $q = mysql_query("
        INSERT INTO `bit-board`
        (value, type, x, y) 
        VALUES(
            '".$_POST['post-it']."',
            'post-it',
            '".$_POST['x']."',
            '".$_POST['y']."'
        )"
    );
    echo mysql_error() ? mysql_error:mysql_insert_id(); 
```

第二个：

```
 if(!is_int(intval($_POST['x'])) || !is_int(intval($_POST['x'])) || !is_int(intval($_POST['id']))) break;

    $q = mysql_query("
        UPDATE `bit-board`
        SET 
            value = '".$_POST['post-it']."',
            type = 'post-it',
            x = '".$_POST['x']."',
            y = '".$_POST['y']."'
        WHERE id = '".$_POST[id]."'
    "); 
```

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-11T21:58:07.590

X 和 Y 是浮点数，所以不要在数值周围加上引号。
还要检查@a_horse_with_no_name 关于引用表名的评论。

```
$q = mysql_query("
            INSERT INTO `bit-board`
            (value, type, x, y) 
            VALUES(
            '".$_POST['post-it']."',
            'post-it',
            ".$_POST['x'].",
            ".$_POST['y']."
        )"
    ); 
```

（未测试）

# javascript - 屏幕上原始视图中的 Unicode 符号

> ID：15349422
> 
> 赞同：0
> 
> 时间：2013-03-11T21:52:50.597
> 
> 标签：javascript, extjs, unicode

尝试通过 JavaScript 即 Ext.i18n.Bundle ( [https://github.com/elmasse/Ext.i18n.Bundle](https://github.com/elmasse/Ext.i18n.Bundle) ) 读取不带 ASCII 符号的属性文件，然后在屏幕上查看下一件事：

\u0427\u0442\u043E \u0442\u043E \u0435\u0441\u0442\u044C \u0442\u0443\u0442

代替

“ИмяКлиента”

首先我的想法是在某个地方我错过了 UTF-8 编码，但它无处不在。如果您通过我之前提到的链接下载示例并在属性文件中更改要挖掘的值，您将看到相同的结果。

谁能解释我做错了什么？

# perl - 我应该如何在 Inline::C 中创建和返回一个 arrayref？

> ID：15349424
> 
> 赞同：6
> 
> 时间：2013-03-11T21:52:57.843
> 
> 标签：perl

我正在尝试通过 Inline::C 编写一个 C 函数，该函数将创建并返回对 Perl 的数组引用......下面是我的脚本和输出。我是否正在分配数组并正确填充它？特别是，我创建了一个`SV*`'s 的临时数组并将它们传递给`av_make`，并返回一个使用`newRV_noinc`. 当我使用 Devel::Peek::Dump 查看返回的数组 ref 时，引用计数似乎很好，它看起来与直接在 perl 中创建的相同数据结构相同。

我还不明白什么是 mortalization/ `sv_2mortal`，或者我在这里是否需要它。显然， Inline::C 自动调用`sv_2mortal`返回的函数`SV*`，这可能相关也可能不相关。

```
#!/usr/bin/env perl
use strict;
use warnings FATAL => "all";
use 5.010_000;
use Data::Dumper;
use autodie;

use Inline ('C');
use Devel::Peek;

my $from_perl = [0 .. 9];
my $from_c = inline_array_maker(10); #same as above but in C

say Dumper $from_perl;
Dump($from_perl);

say Dumper $from_c;
Dump($from_c);

__END__
__C__
SV* (int len){
    int i;
    SV ** tmp_buffer;
    AV * arr;

    tmp_buffer  = malloc(sizeof(SV*) * len);

    printf("allocating tmp_buffer of size %d\n", len);
    for (i = 0; i < len; i++) {
        tmp_buffer[i] = newSViv(i);
    }

    // is av_make the most efficient way of doing this?  
    printf("av_make\n");
    arr = av_make(len, tmp_buffer);

    printf("freeing tmp_buffer\n");
    for (i = 0; i < len; i++) {
        sv_free(tmp_buffer[i]);
    }
    free(tmp_buffer);

    return newRV_noinc(arr);
} 
```

我得到以下输出。

```
allocating tmp_buffer of size 10
av_make
freeing tmp_buffer
$VAR1 = [
        0,
        1,
        2,
        3,
        4,
        5,
        6,
        7,
        8,
        9
        ];

SV = IV(0x20c7520) at 0x20c7530
REFCNT = 1
FLAGS = (PADMY,ROK)
RV = 0x21c0fa8
SV = PVAV(0x25c7ec8) at 0x21c0fa8
    REFCNT = 1
    FLAGS = ()
    ARRAY = 0x25a0e80
    FILL = 9
    MAX = 9
    ARYLEN = 0x0
    FLAGS = (REAL)
    Elt No. 0
    SV = IV(0x20b2dd8) at 0x20b2de8
    REFCNT = 1
    FLAGS = (IOK,pIOK)
    IV = 0
    Elt No. 1
    SV = IV(0x20b2fb8) at 0x20b2fc8
    REFCNT = 1
    FLAGS = (IOK,pIOK)
    IV = 1
    Elt No. 2
    SV = IV(0x20c69f8) at 0x20c6a08
    REFCNT = 1
    FLAGS = (IOK,pIOK)
    IV = 2
    Elt No. 3
    SV = IV(0x20c6a10) at 0x20c6a20
    REFCNT = 1
    FLAGS = (IOK,pIOK)
    IV = 3
$VAR1 = [
        0,
        1,
        2,
        3,
        4,
        5,
        6,
        7,
        8,
        9
        ];

SV = IV(0x20d25c8) at 0x20d25d8
REFCNT = 1
FLAGS = (PADMY,ROK)
RV = 0x25ac6b8
SV = PVAV(0x25c7ea0) at 0x25ac6b8
    REFCNT = 1
    FLAGS = ()
    ARRAY = 0x25b9140
    FILL = 9
    MAX = 9
    ARYLEN = 0x0
    FLAGS = (REAL)
    Elt No. 0
    SV = IV(0x25aca80) at 0x25aca90
    REFCNT = 1
    FLAGS = (IOK,pIOK)
    IV = 0
    Elt No. 1
    SV = IV(0x25ac750) at 0x25ac760
    REFCNT = 1
    FLAGS = (IOK,pIOK)
    IV = 1
    Elt No. 2
    SV = IV(0x25ac5e8) at 0x25ac5f8
    REFCNT = 1
    FLAGS = (IOK,pIOK)
    IV = 2
    Elt No. 3
    SV = IV(0x25ac930) at 0x25ac940
    REFCNT = 1
    FLAGS = (IOK,pIOK)
    IV = 3 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-03-11T22:02:45.727

你读过[perldoc perlguts](http://p3rl.org/guts)吗？它应该能让你大部分时间到达那里。`Inline::C`也可以处理`AV*`返回值。我可能会做类似的事情：

```
#!/usr/bin/env perl

use strict;
use warnings;

use Inline C => <<'END';
  AV* make_arrayref (int size) {
    int i;
    AV* ret = newAV();
    sv_2mortal((SV*)ret);
    for(i=0; i<size; i++) {
      av_push(ret, newSViv(i) );
    }
    return ret;
  }
END

my $arrayref = make_arrayref(10);
print "$_\n" for @$arrayref; 
```

这是我编写[的一些代码，可能也有帮助。](https://github.com/jberger/Text-AsciiTeX/blob/master/lib/Text/AsciiTeX.xs)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-03-11T22:33:09.093

> 我还不明白 mortalization/sv_2mortal 是什么，或者我在这里是否需要它。显然，Inline::C 在返回 SV* 的函数上自动调用 sv_2mortal，这可能相关也可能不相关。

当您分配 RV 时，您就成为了它的所有者。如果你放弃对它的持有，你需要减少它的引用计数。但这会当场释放它，因为没有其他人持有它的引用。Mortalising 是一种延迟的 refcount 递减。它让调用者有机会首先抓住它（并增加它的引用计数）。

所以，是的，RV 需要死去，是的，类型图将为您死去返回的 SV*。

您的代码没有错误，但正如 Joel Berger 所示，您不需要预先构建 C 数组。他的代码也很好。

他还表明，如果您的返回类型是`AV*`，则类型映射将创建对数组的（致命的）引用，但它不会使数组本身致命。因此，您的两个主要回报选择是

```
// Return type = SV*
return newRV_noinc(arr); 
```

和

```
// Return type = AV*
return MUTABLE_AV(sv_2mortal(MUTABLE_SV(newRV_noinc(arr))); 
```

# android - 如何从 Activity RootView 中删除视图

> ID：15349425
> 
> 赞同：1
> 
> 时间：2013-03-11T21:53:02.183
> 
> 标签：android, layout, view, viewgroup, rootview

我正在尝试删除膨胀的视图。这就是我膨胀视图的方式：

```
ViewGroup vg = (ViewGroup)findViewById(android.R.id.content).getRootView();
mOverflowMenuView = View.inflate(this, R.layout.overflow_menu, vg); 
```

这就是我尝试从 onBackPressed 中删除它的方式

```
ViewGroup vg = (ViewGroup)(mOverflowMenuView.getParent());
vg.removeView(mOverflowMenuView); 
```

但我得到一个类转换异常：

```
03-11 22:47:31.848: E/AndroidRuntime(26357): java.lang.ClassCastException: android.view.ViewRootImpl cannot be cast to android.view.ViewGroup 
```

有任何想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-11T23:57:34.217

如果您在以下行中收到 classcastexception：

```
 ViewGroup vg = (ViewGroup)findViewById(android.R.id.content).getRootView(); 
```

然后我建议您在布局的根视图中放置一个 id，然后直接使用 findViewById() 对其进行膨胀，然后使用 removeView 方法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-15T19:04:06.673

终于解决了。好像我`View`的被添加到了`RelativeLayout`根目录下。为了得到那个`RelativeLayout`句柄，我必须这样做：

```
ViewGroup vg = (ViewGroup)findViewById(R.id.board_root_view).getRootView();     
RelativeLayout v = (RelativeLayout)mOverflowListView.getParent();
vg.removeView(v); 
```

# php - php代码返回当前页面

> ID：15349430
> 
> 赞同：-1
> 
> 时间：2013-03-11T21:53:27.477
> 
> 标签：php

`<form action="saisi.php" method="post">`我在页面上编写了这段代码`saisi.php`，我想知道是否有一些 php 代码在不使用其名称的情况下返回当前页面，正如您从我的代码中看到的那样，操作页面与表单所在的页面相同。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-11T21:57:38.083

默认情况下，如果您将操作留空，它将发布到同一页面。

还要确保检查 $_SERVER['REQUEST_URI'] 和[文档中的](http://php.net/manual/en/reserved.variables.server.php)其他 php 变量。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-11T21:59:29.633

您可以使用

```
<form action="<?php $_SERVER['PHP_SELF']; ?>" method="post"> 
```

# scala - 如何在 Scala 中将元素附加或添加到元组

> ID：15349439
> 
> 赞同：30
> 
> 时间：2013-03-11T21:54:11.883
> 
> 标签：scala, shapeless

我有一个元组，想在不丢失类型安全的情况下添加一个元素。这就是我想要实现的目标：

```
val tuple = ("", 1, 1f) // (String, Int, Float)

val newTuple:(String, Int, Float, Double) = tuple :+ 1d 
```

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2014-07-19T19:02:11.200

无形现在做到了。添加

```
import shapeless.syntax.std.tuple._ 
```

在您的代码刚刚编译之前。

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2013-03-11T22:34:37.317

值得注意的是，您还可以用几行代码为此编写代码生成器：

```
val tupadd = for (n <- 2 to 20) yield {
  val t = (0 until n).map(i => ('A'+i).toChar).mkString(", ")
  val u = ('A'+n).toChar
  val i = (0 until n).map(i => "x._"+(i+1)).mkString(", ")
  List(
    s"implicit class TupOps$n[$t](val x: ($t)) extends AnyVal {",
    s"  def :+[$u](y: $u) = ($i, y)",
    s"  def +:[$u](y: $u) = (y, $i)",
    "}"
  ).mkString("\n")
} 
```

把这些打印出来，把它们粘在一个文件里，你就可以开始了：

```
scala> implicit class TupOps2[A, B](val x: (A, B)) extends AnyVal {
     |   def :+[C](y: C) = (x._1, x._2, y)
     |   def +:[C](y: C) = (y, x._1, x._2)
     | }
defined class TupOps2

scala> (1,"salmon") :+ true
res15: (Int, String, Boolean) = (1,salmon,true) 
```

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2013-03-11T21:54:11.883

[我在很棒的Shapeless 库](https://github.com/milessabin/shapeless)的帮助下找到了一个解决方案，它是`HList`

```
/*
  Define an implicit class to add the methods
  It accepts any tuple as we have typed it as Product
*/
implicit class TupleOps[A <: Product](t: A) {

  /*
    Declare the method to append

    B - The type of element we want to append
    L - The HList representing the tuple A
    P - The HList after appending B
    R - The final result
  */
  def :+[B, L <: HList, P <: HList, R <: Product](b: B)(
    /*
      We need some tools to help with the conversion

      hlister - Converts a tuple into an HList
      prepend - Can prepend one HList before another
      tupler  - Can convert an HList into a tuple
    */
    implicit hlister: HListerAux[A, L], prepend: PrependAux[L, B :: HNil, P], tupler: TuplerAux[P, R]):R =
      // Let the helpers do their job
      tupler(prepend(hlister(t), b :: HNil))

  /*
    The prepend method is similar to the append method but does not require
    the extra effort to append
  */
  def +:[B, L <: HList, R <: Product](b: B)(
    // Here we use the :: type of shapeless
    implicit hlister: HListerAux[A, L], tupler: TuplerAux[B :: L, R]):R =
      tupler(b :: hlister(t))
}

// usage is like this
("", 1, 1f) :+ 1d  //> res0: (String, Int, Float, Double) = ("",1,1.0,1.0)
1d +: ("", 1, 1f)  //> res1: (Double, String, Int, Float) = (1.0,"",1,1.0) 
```

## 编辑

在某些情况下，当您需要处理隐式转换时，此解决方案无法与案例类结合使用。我现在恢复到以下实现（基于 Rex Kerr 的代码）

```
def char(n: Int) = ('A' + n).toChar
def prop(n: Int) = "t._" + (n + 1)

val result =
  for (n <- 1 to 21) yield {

    val range = (0 until n)
    val tupleTypeParams = range map char mkString ", "
    val tupleProperties = range map prop mkString ", "

    val elementType = char(n)
    val elementProperty = prop(n)

    val first = n == 1
    val tupleType = if (first) s"Tuple1[$tupleTypeParams]" else s"($tupleTypeParams)"
    val tupleInstance = if (first) s"Tuple1($tupleProperties)" else s"($tupleProperties)"

    val resultType = s"($tupleTypeParams, $elementType)"

    s"""|implicit def tupleOps$n[$tupleTypeParams, $elementType] = 
        |  new TupleAppendOps[$tupleType, $elementType, $resultType] {
        |    def append(t: $tupleType, e: $elementType) = ($tupleProperties, e)
        |    def init(t: $resultType) = $tupleInstance
        |    def last(t: $resultType) = $elementProperty
        |  }""".stripMargin
  }

println(result mkString "\n") 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-03-12T11:46:32.493

[您可以在https://github.com/leonardschneider/macrogen](https://github.com/leonardschneider/macrogen)上尝试基于宏天堂 scala 分支的实验性宏库，这正是您的示例。

现在我仍然有一些错误，我无法链接调用。

# three.js - 谁能帮我在 TrackballControls.js 中包含跳跃控件

> ID：15349446
> 
> 赞同：2
> 
> 时间：2013-03-11T21:54:28.783
> 
> 标签：three.js, leap-motion

我正在学习跳跃运动控制，我需要帮助在 Trackballcontrols.js 中包含跳跃控制链接在[http://threejsdoc.appspot.com/doc/three.js/src.source/extras/controls/TrackballControls.js 下方提供。 html](http://threejsdoc.appspot.com/doc/three.js/src.source/extras/controls/TrackballControls.js.html)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-08-07T19:36:42.410

查看

[https://github.com/spren9er/threeleapcontrols](https://github.com/spren9er/threeleapcontrols)

并查看示例文件。有一个名为 LeapCameraControls.js 的 javascript 文件用于控制相机，另一个名为 LeapObjectControls.js 用于控制对象。

这两个控件都是完全可定制的，即您可以指定哪个手势（多少手和手指、手掌或指尖位置、左手或右手）分别用于旋转、缩放/缩放或平移相机或对象。

在行动：

[http://youtu.be/SQDAa-cqlrA](http://youtu.be/SQDAa-cqlrA)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-31T20:33:45.530

你在使用leap.js吗？如果没有 - 它应该有帮助：

[https://github.com/leapmotion/leapjs](https://github.com/leapmotion/leapjs)

查看 Robbie Tilton 的地球自转示例：

[https://github.com/leapmotion/leapjs/tree/master/examples/earthRotation](https://github.com/leapmotion/leapjs/tree/master/examples/earthRotation)

这是一个视频演示：

[https://vimeo.com/57873675](https://vimeo.com/57873675)

（我想你希望有类似的互动，但与元素周期表？）

# mysql - 连接的索引列

> ID：15349448
> 
> 赞同：0
> 
> 时间：2013-03-11T21:54:30.223
> 
> 标签：mysql, sql, performance, join, indexing

当我们在属性上创建索引时，我们会更快地找到记录，因为索引是一棵树，并且我们浏览按排序顺序的值。
例如，`SELECT * from branches where name='Washington`通过索引，我们将按字典顺序导航以到达日志时间的记录。
但是，当我们在连接中使用的列上建立索引时，这是如何工作的？
例如

```
SELECT BILLS.NAME NAME, BILLS.AMOUNT AMOUNT FROM BILLS,BANK_ACCOUNTS WHERE BILLS.ACCOUNT_ID = BANK_ACCOUNTS.ACCOUNT_ID 
```

如果我们创建了一个索引，`BILLS(ACCOUNT_ID)`那么`BANK_ACCOUNTS(ACCOUNT_ID)`导航如何更快？我们只是获取每个值`BANK_ACCOUNTS.ACCOUNT_ID`并使用索引树`BILLS`来查找匹配的记录？
如果这是它的工作方式，那么为什么人们通常建议在连接中使用的列中创建索引。
在我看来，只创建了 1 个索引，这将用于相等比较器左侧的表，即`BILLS`. 还是我错了？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-11T22:01:31.340

您提供的示例代码在 BILLS 和 BANK_ACCOUNTS 之间执行 INNER JOIN，因此只会返回 BILLS 中存在于 BANK_ACCOUNTS 中的行。这是在查询运行时通过仅对 BANK_ACCOUNTS 上的非聚集索引执行连接来检查的，因为查询引用的来自 BANK_ACCOUNTS 的所有字段（即 BANK_ACCOUNTS.ACCOUNT_ID）都是索引的一部分，因此“被覆盖” “ 通过它。

在索引中查找 BANK_ACCOUNTS.ACCOUNT_ID 是 O(log N)，而每次查找扫描 BANK_ACCOUNTS 是 O(N)。

这有帮助吗？

# mysql - 在mysql中复制wordpress密码哈希

> ID：15349451
> 
> 赞同：1
> 
> 时间：2013-03-11T21:54:37.797
> 
> 标签：mysql, wordpress, passwords, sql-update, phpass

因此，我希望能够在 user_pass 列中更改我的 wordpress wp_user 表中存在的密码哈希。我希望能够写出如下内容：

```
# simplified version of what is desired.
UPDATE `wp_user` SET user_pass = MD5('123') WHERE user_email = 'some_dudes@someplace.com'; 
```

基本上，我希望能够在 mysql 中设置用户密码，以便在我使用查询设置后，当用户通过登录表单输入密码时，wordpress 将继续接受此密码为有效密码。我正在查看有关此的 PHPass 信息以及`class-phpass.php`wordpress 源代码中的内容。根据我的研究，这似乎非常复杂，如果不是不可行的话。我是否遗漏了什么，或者这实际上是为了难以处理或可能被混淆？是否可以在 MySQL 中复制此功能？任何帮助，将不胜感激。非常感谢你。

关于进度的编辑：如果您只需要开发级别的安全性，那么您实际上可以使用以下内容：

```
UPDATE `wp_user` SET user_pass = MD5('123') WHERE id = 1342; 
```

我应该更好地解释为什么会这样。出于遗留兼容性原因，Wordpress 将默认使用 MD5 哈希。基本上，当将密码传递给 wordpress 时，它会运行 wordpress PHPass 哈希，这将失败，例如`MD5('123')`然后 wordpress 将尝试其他更简单的哈希算法，如 SHA1，最后是 MD5。然后，如果在其中一个上找到匹配项，wordpress 实际上会更新相关记录的密码列。它将给定的密码更新为 PHPass。发生这种情况后，您仍然可以继续前进。这基本上适用于开发环境，但是与 PHPass 的工作相匹配的 MySQL 查询是一项史诗般的任务。如果我破解它，那将是我的下一个更新。显然，wordpress 正在运行加盐的河豚哈希大约 8000 次以生成最终的哈希结果。

* * *

## 回答 #1

> 赞同：-3
> 
> 时间：2013-03-11T22:41:22.853

实际上很容易，您甚至根据我所看到的发布了正确的 sql。

```
<?php

$connection = mysql_connect('SERVER', 'USERNAME', 'PASSWORD');

mysql_select_db($database, $connection);

mysql_query('SQL_YOU_POSTED', $connection);

?> 
```

# json - 使用 JSON 从 Youtube API 返回视频时长

> ID：15349457
> 
> 赞同：3
> 
> 时间：2013-03-11T21:54:52.823
> 
> 标签：json, youtube, youtube-api, youtube-javascript-api

我正在尝试使用 JSON 检索和打印通过 Youtube API 返回的每个视频的持续时间。持续时间需要像这样输出：

9:34 分钟而不是几秒钟

但我不知道下一步该做什么。我目前正在使用以下代码：

```
function showMyVideos2(data) {
var feed = data.feed;
var entries = feed.entry || [];
var html = ['<ul class="videos">'];
for (var i = 0; i < entries.length; i++) {
var entry = entries[i];
var title = entry.title.$t.substr(0, 20);
var thumbnailUrl = entries[i].media$group.media$thumbnail[0].url;
var playerUrl = entries[i].media$group.media$content[0].url;
html.push('<li>',
          '<a href="', playerUrl, '" rel="vidbox 686 315"><img src="', 
          thumbnailUrl, '" width="130" height="97"/></a>', '<span class="titlec"><a      href="', playerUrl, '" rel="vidbox 686 315">', title, '... </a></span></li>');
}
html.push('</ul><br style="clear: left;"/>');
document.getElementById('videos2').innerHTML = html.join('');
if (entries.length > 0) {
loadVideo(entries[0].media$group.media$content[0].url, false);
}
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-12T12:23:49.417

YouTube API 仅以秒为单位输出持续时间。但是您可以创建一个函数来将秒转换为您想要的时间格式。

```
function formatSecondsAsTime(secs) {
    var hr = Math.floor(secs / 3600);
    var min = Math.floor((secs - (hr * 3600)) / 60);
    var sec = Math.floor(secs - (hr * 3600) - (min * 60));

    if (hr < 10) {
        hr = "0" + hr;
    }
    if (min < 10) {
        min = "0" + min;
    }
    if (sec < 10) {
        sec = "0" + sec;
    }
    if (hr) {
        hr = "00";
    }

    return hr + ':' + min + ':' + sec;
} 
```

只需将持续时间字段传递给函数，如下所示：

```
var videoTime = formatSecondsAsTime(entries[i].media$group.media$content[0].duration); 
```

# java - 如何在 Java 中编写覆盖方法

> ID：15349460
> 
> 赞同：0
> 
> 时间：2013-03-11T21:55:02.137
> 
> 标签：java, overriding

这是家庭作业的一部分。

我正在尝试创建一个具有多种方法的`class`名称。`RomanNumeral`第一种方法，`RomanNumeral`检查字符串`rn`是否为罗马数字。第二种方法将罗马数字转换为十进制值。我的问题在于其余的方法。我被要求为`.equals()`,`.compareTo()`和`toString()`. 我的问题是我将如何开始这样做？覆盖是什么意思？我应该看看他们的所作所为并效仿吗？如果我是，在哪里可以查看定义`.compareTo()`or的方法`toString()`？

如果有帮助，我可以发布我当前的代码。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-11T23:09:19.307

好的，据我所知，您在这里有两个主要问题。

1.  重写方法是什么意思？
2.  如何覆盖方法？

让我们想一个新的班级，这样我就可以避免为你做作业。

我们有一个名为 Student 的类，它存储 3 个字符串。

*   名
*   姓
*   平均绩点

它可能看起来像这样。

```
public class Student {
    String firstName;
    String lastName;
    String gpa

    public Student(String firstName, String lastName, String gpa){
        this.firstName = firstName;
        this.lastName = lastName;
        this.gpa = gpa;
    }

    // Perhaps some methods here

    public String getIdentity(){
        return this.lastName + ", " + this.firstName;
    }
} 
```

您喜欢 Student 课程，但您认为如果您也可以跟踪 College studentId 会更好。一种解决方案是扩展 Student 类。

通过扩展类，我们可以访问 Student 拥有的所有方法（和构造函数），并且可以添加一些我们自己的方法。因此，让我们调用我们的新类 CollegeStudent，并为 studentId 添加一个字符串。

```
public class CollegeStudent extends Student{

    String studentId;

} 
```

现在，无需额外工作，我就可以创建一个 CollegeStudent，并获得它的身份。

```
// Code
CollegeStudent myCollegeStudent = new CollegeStudent("Dennis", "Ritchie", "2.2");
String identity = myCollegeStudent.getIdentity();
// Code 
```

好的，足够的设置。让我们回答你的问题。

因此，让我们假设您宁愿使用 getIdentity() 来返回该大学生的“studentId”，而不是返回“Ritchie, Dennis”。然后，您可以**覆盖**getIdentity 方法。

通过覆盖该方法，您将重新编写 getIdentity() 以便它返回 studentId。CollegeStudent 类看起来像这样。

```
public class CollegeStudent extends Student{

    String studentId;

    @Override
    public String getIdentity(){
        return this.studentId;
    }
} 
```

要覆盖一个方法，你必须返回相同类型的对象（在我们的例子中是String），并且你必须接受相同的参数（我们的例子没有接受任何参数）

您还可以覆盖构造函数。

那么这如何适用于你的任务呢？.equals()、.compareTo() 和 .toString() 已经定义，因为您将要扩展的类（例如 Object）。但是，您将需要重新定义或**覆盖**这些方法，以便它们对您的类有用。也许**您**的 toString() 实现将返回单词“four”而不是“IV”。可能不会，但关键是您现在可以自由决定应该如何编码该方法。

希望这可以帮助。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-11T22:02:37.243

当一个类*扩展*另一个类时，它会*继承*其所有非私有实例成员。

例如`RomanNumeral` *extends* `Object`，所以它*继承*了后者的`toString()`方法。这意味着您可以调用`toString()`任何`RomanNumeral`实例，并且它将调用该`Object.toString()`方法。

但是，`RomanNumeral`可以选择通过提供*自己的定义来**覆盖*此方法，这将取代它继承的定义。然后，当您调用实例时，它将调用您定义的方法。（即使您通过引用引用实例，这也有效。）*`toString()``RomanNumeral``RomanNumeral``Object`*

 *所以，你被要求充实这个标准：

```
public class RomanNumeral {

    // ... your other methods ...

    @Override       // this line is optional
    public String toString() {
        // TODO define this method
    }

    @Override       // this line is optional
    public boolean equals(Object o) { // note: 'Object', *not* 'RomanNumeral'!
        // TODO define this method
    }

    @Override       // this line is optional
    public int hashCode() {
        // TODO define this method
    }

} 
```

请注意，尽管您似乎被告知了什么，但没有“覆盖文件”之类的东西。上面的方法是在内部定义的`RomanNumeral.java`，就像任何其他方法一样。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-11T22:04:03.060

来自[文档](http://docs.oracle.com/javase/tutorial/java/IandI/override.html)：
子类中具有相同签名（名称，加上其参数的编号和类型）和返回类型作为超类中的实例方法的实例方法覆盖超类的方法。

子类重写方法的能力允许类从行为“足够接近”的超类继承，然后根据需要修改行为。覆盖方法与它覆盖的方法具有相同的名称、参数数量和类型以及返回类型。

重写方法时，您可能希望使用`@Override`指示编译器您打算重写超类中的方法的注释。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-11T22:11:05.397

覆盖意味着通过创建方法的新实现来改变实例的行为。每个Java 类都从Object 类继承equals()、hashCode() 和toString()。

尝试在您的类中编写这些方法的新实现，以便 toString() 将 RomanNumber 作为字母返回，equals() 返回如果另一个对象也是 RomanNumber 并且具有相同的值并尊重两个相等对象需要的约定相同的哈希码。

为您的方法添加一个 @Override 注释，将它们标记为故意更改，以便让编译器检查签名。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-03-11T22:17:50.297

您需要做的是重新定义这些方法：

```
public class RomanNumeral implements Comparable<RomanNumeral>{

@Override
public boolean equals(Object obj) {
// your conditions and return true or false
}

@Override
public String toString() {
return "Show the world my representation";
}

public int compareTo(T o) {
/* your conditions and if returns:
Less than zero -> instance precedes obj in the sort order.
Zero -> instance occurs in the same position in the sort order as obj
Greater than zero -> instance follows obj in the sort order)*/ 
} 
```*

# php - 在 phpclass 中选择函数

> ID：15349466
> 
> 赞同：0
> 
> 时间：2013-03-11T21:55:35.887
> 
> 标签：php, class

我正在尝试为一个针对不同供应商检查库存的网上商店编写一个 php 脚本。不幸的是，这样做的方法对于每个供应商来说都是完全不同的。我有一个工作例程，但与其编写六个略有不同的脚本，我宁愿使用相同的核心，并且为每个供应商提供单独的解析例程。这样我就可以通过编写一个新的解析文件并将其放在正确的位置来添加对新供应商的支持。

我最初设想的是

```
$ref = "123456";
$supplier = new Supplier("CompanyOne");
$product = $supplier->getproduct($ref);
echo "Product with supplier reference " . $ref . " is " . $product["name"]; 
```

供应商是

```
class Supplier{
    function __construct($sup = "") {
        $f = "supplier_" . $sup . ".php";
        if (file_exists($f)) {
             include_once $f;
        }
    }
} 
```

getproduct() 在包含的文件中，因为每个文件都不同。

不过，我不确定这是否可行，因为我认为包含的例程最终会出现在构造函数的上下文中，而不是类本身。

这一定是一种常见的情况，但我已经花了很长时间研究包含、扩展、回调等，并尝试在谷歌上搜索所有方法来描述我想做的事情以找到最好的方法，但没有想出任何事物。

我在吠叫错误的树吗？最好的方法是什么，记住我想包含几组不同的代码，直到运行时我才知道它们的名称？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-11T22:02:29.567

为什么不为每个供应商扩展类。拥有您的基类，然后为每个供应商扩展它

```
class Supplier{
//do stuff
}

class Supplier_FirstCompany extends Supplier{
//do similar stuff, but different overwritten functions.
//still inherits functions from parent so not all need to be overwritten.
} 
```

然后你甚至可以设置一个自动加载器，使用`spl_autoload`它会根据传递的要求/命名空间加载文件。这可能是最简单的方法。

# python - 如何在 python ReportLab 中从横向布局更改为纵向布局？

> ID：15349474
> 
> 赞同：3
> 
> 时间：2013-03-11T21:56:15.173
> 
> 标签：python, reportlab

我有一个新手问题（应该很容易回答），过去一天左右一直困扰着我，并且在倾注了所有与 reportlab 相关的在线帖子之后仍然无法弄清楚。我要做的就是在同一个文档中从横向切换到纵向。这将允许我创建一个特征表（包括表中这些图片的链接），然后放入图片以便它们可以链接到。

这是我到目前为止提出的代码，以促进应该是一个简单的过程：

```
from reportlab.lib.enums import TA_LEFT, TA_RIGHT, TA_CENTER, TA_JUSTIFY
from reportlab.lib import colors
from reportlab.lib.pagesizes import letter, landscape
from reportlab.platypus import SimpleDocTemplate, Paragraph, Spacer, Image, Frame,
                   Table, TableStyle, NextPageTemplate, PageTemplate, BaseDocTemplate
from reportlab.lib.styles import getSampleStyleSheet, ParagraphStyle
from reportlab.lib.units import inch
from reportlab.platypus.flowables import Flowable, PageBreak
from pyPdf import PdfFileReader, PdfFileWriter
import glob, os
from reportlab.lib.pagesizes import letter, A4

doc = BaseDocTemplate("M:\GIS Mapping Services\Promotional\Automated Reports\PDF_ReportLab\NextPageExample.pdf",showBoundary=1,pagesize=landscape(letter))
elements = []
styles = getSampleStyleSheet()
styles.add(ParagraphStyle(name='normal', fontSize=6, leading = 7, alignment=TA_LEFT))

ptemplate = PageTemplate(id='portrait', pagesize=portrait(letter))
elements.append(Paragraph("Table is here.",styles["normal"]))
elements.append(NextPageTemplate('portrait'))
elements.append(PageBreak())
elements.append(Paragraph("Pictures are to be placed here.",styles["normal"]))

doc.build(elements)
del elements 
```

如果您有任何提示或想帮助我解决这个问题，请您具体说明一下我做错了什么，或者包括一个从头到尾没有任何编码丢失的工作示例。

预先感谢您的帮助，

温

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-03-13T00:39:59.667

这是一个 hack，基于我在[这里](https://stackoverflow.com/questions/5882636/how-to-create-a-pdf-document-with-differing-page-sizes-in-reportlab-python)找到的答案。

```
from reportlab.lib.enums import TA_LEFT, TA_RIGHT, TA_CENTER, TA_JUSTIFY
from reportlab.lib import colors
from reportlab.lib.pagesizes import letter, landscape
from reportlab.platypus import SimpleDocTemplate, Paragraph, Spacer, Image, Frame,Table, TableStyle, NextPageTemplate, PageTemplate, BaseDocTemplate
from reportlab.lib.styles import getSampleStyleSheet, ParagraphStyle
from reportlab.lib.units import inch
from reportlab.platypus.flowables import Flowable, PageBreak
from pyPdf import PdfFileReader, PdfFileWriter
import glob, os
from reportlab.lib.pagesizes import letter, A4

def make_portrait(canvas,doc):
    canvas.setPageSize(letter)

def make_landscape(canvas,doc):
    canvas.setPageSize(landscape(letter))

doc = BaseDocTemplate("NextPageExample.pdf",showBoundary=1)
elements = []
styles = getSampleStyleSheet()
styles.add(ParagraphStyle(name='normal', fontSize=6, leading = 7, alignment=TA_LEFT))

frame1 = Frame(doc.leftMargin, doc.height-5*inch,
                doc.width, 5*inch,
                leftPadding = 0, rightPadding = 0,
                topPadding = 0, bottomPadding = 0,
                id='frame1')

ptemplate = PageTemplate(id='portrait',frames =[frame1], onPage=make_portrait)
ltemplate = PageTemplate(id='landscape',frames =[frame1], onPage=make_landscape)
doc.addPageTemplates([ptemplate, ltemplate])
elements.append(Paragraph("Table is here.",styles["normal"]))
elements.append(NextPageTemplate('landscape'))
elements.append(PageBreak())
elements.append(Paragraph("Pictures are to be placed here.",styles["normal"]))

doc.build(elements)
del elements 
```

使用鸭嘴兽时，我发现操纵画布的最简单方法是通过 PageTemplate 的 onPage 设置，它可以让您实现文本的非流动部分。在这里，在横向或纵向模板上绘制任何内容之前，将画布重新调整为所需的大小。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2015-01-10T23:34:52.903

您可以进一步简化上述内容。不需要两个附加功能来设置旋转的画布：

```
 p_frame = Frame(0.5 * inch, 0.5 * inch, 7.5 * inch, 10 * inch,
                   leftPadding=0, rightPadding=0,
                   topPadding=0, bottomPadding=0,
                   id='portrait_frame')

    l_frame = Frame(0.5 * inch, 0.5 * inch, 10 * inch, 7.5 * inch,
                    leftPadding=0, rightPadding=0,
                    topPadding=0, bottomPadding=0,
                    id='landscape_frame')

    portrait_tmpl = PageTemplate(id='portrait_tmpl', frames=[p_frame], pagesize=letter)
    landscape_tmpl = PageTemplate(id='landscape_tmpl', frames=[l_frame], pagesize=landscape(letter)) 
```

它更易于维护。虽然，我还没有找到解决设置两个单独框架的方法。

答案中的框架在旋转时对我不起作用。

# ruby-on-rails - 回形针 422 错误

> ID：15349475
> 
> 赞同：5
> 
> 时间：2013-03-11T21:56:21.063
> 
> 标签：ruby-on-rails, imagemagick, paperclip

我在使用回形针时遇到了一些问题。当我在尺寸后面有一个“#”时（用于缩放和裁剪），我收到 422 错误。我的日志是这样说的：

```
Command :: convert '/tmp/**** (20130110)20130311-13571-xxasmt.png[0]' -auto-orient -resize "150x150#" '/tmp/**** (20130110)20130311-13571-xxasmt20130311-13571-1anrx0y'
[paperclip] An error was received while processing: #<Paperclip::Error: There was an error processing the thumbnail for **** (20130110)20130311-13571-xxasmt>
Completed 422 Unprocessable Entity in 2785ms (Views: 0.8ms | ActiveRecord: 9.1ms) 
```

这是我在模型中的回形针代码：

```
 has_attached_file :image,
  :styles => {
    :medium => "300x300#",
    :thumb => "100x100>",
    :standard => "150x150>"
  },
  :storage => :s3,
  :s3_credentials => "#{Rails.root}/config/s3.yml",
  :bucket => "convertkit",
  :s3_protocol => "https" 
```

我错过了什么吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-12-11T10:12:45.533

```
has_attached_file :avatar,
                :styles => {
                          :thumb => "60x60>", :medium => "120x120>",
                          :original => "100%", small2: "65x65>", medium2: "144x144>"
                          },
                          :storage => :s3,
                          :s3_credentials => "#{::Rails.root.to_s}/config/aws.yml",
                          :s3_permissions => "public-read",
                          :url => ':s3_alias_url',
                          :path => "/slider/:attachment/:id_partition/:style/:filename",
                          :s3_host_alias => Settings.cloud_front_url,
                          :s3_protocol => :https,
                          :s3_headers => {'Expires' => (Time.now + 6060243012).httpdate},
                          default_url: "paperclip_default/slider/:style_missing.png" 
```

# android - Android在java中更改我的自定义按钮颜色

> ID：15349480
> 
> 赞同：0
> 
> 时间：2013-03-11T21:57:04.750
> 
> 标签：android

我在 xml 中定义了一个自定义按钮。我想更改它，以便可以在运行时更改笔触颜色和渐变颜色。

```
<?xml version="1.0" encoding="utf-8"?>
<selector xmlns:android="http://schemas.android.com/apk/res/android">
    <item android:state_pressed="true">
        <shape>
            <gradient android:startColor="#330000"
                android:endColor="#000000" android:angle="270" />
            <stroke android:width="1dp" android:color="#aa0000" />
            <corners android:radius="8dp" />
            <padding android:left="2dp" android:top="2dp"
                android:right="2dp" android:bottom="2dp" />
        </shape>
    </item>
    <item android:state_focused="true">
        <shape>
            <gradient android:endColor="#330000"
                android:startColor="#000000" android:angle="270" />
            <stroke android:width="1dp" android:color="#aa0000" />
            <corners android:radius="8dp" />
            <padding android:left="2dp" android:top="2dp"
                android:right="2dp" android:bottom="2dp" />
        </shape>
    </item>
    <item>
        <shape>
            <gradient android:endColor="#000000"
                android:startColor="#000000" android:angle="270" />
            <stroke android:width="1dp" android:color="#aa0000" />
            <corners android:radius="8dp" />
            <padding android:left="2dp" android:top="2dp"
                android:right="2dp" android:bottom="2dp" />
        </shape>
    </item>

</selector> 
```

我知道如何获得 Drawable

```
Drawable d = getResources().getDrawable(R.drawable.custom_button); 
```

然后像

```
 btnSettings.setBackgroundDrawable(d); 
```

我不知道如何获得状态，然后是每个状态的形状。然后最终修改形状属性，例如描边颜色和渐变颜色。

编辑：在研究了一下之后，看起来我几乎需要用 java 替换所有这些 xml 代码。我想重新表述我的问题，以便我需要知道如何创建选择器，完成三个状态和每个状态的不同形状特征。答案不需要显示所有三种状态。一旦我知道如何做一个，我就能弄清楚其余的。

# android - 为不同的设备选择正确的布局命名方案

> ID：15349482
> 
> 赞同：2
> 
> 时间：2013-03-11T21:57:07.210
> 
> 标签：android, layout, android-resources, resolutions

[阅读完此处](http://developer.android.com/guide/practices/screens_support.html)的文档后，我仍然对如何使用命名方案来正确设置不同设备的布局感到有些困惑。

我特别需要 Galaxy S3、Nexus 7 和 Asus Transformer 的布局。

我目前正在使用：

```
S3:
    layout-normal
    layout-normal-land

Nexus 7:
    layout-large
    layout-large-land

Transformer:
    layout-xlarge
    layout-xlarge-land 
```

这是正确的，还是有办法更具体地定位设备？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-11T22:12:24.777

您的示例使用小/中/大/xlarge 存储桶的旧方式。这是有问题的，因为例如 Galaxy Tab 7.0 (1024x600) 和 Nexus 7 (1280x800) 都符合大尺寸标准。Nexus 7 可以处理平板电脑布局，但旧的 Tab 7.0 通常更适合手机布局。旧系统不支持这种区分，因此，从 Honeycomb 开始，您可以使用新的方式，它不依赖存储桶，而是使用实际屏幕大小`dp`来决定使用哪种布局。这使您可以更好地控制何时选择哪种布局。

查看您链接的文档中的[声明平板电脑布局部分。](http://developer.android.com/guide/practices/screens_support.html#DeclaringTabletLayouts)它介绍了基于 dp 的选择器。您提到的三款设备都使用较新的 Android 版本，可以从“sw720dp”方法中受益。

还有一点，因为如果您的最低目标版本是 Gingerbread 或更早版本，您基本上必须同时支持 s/m/l/xl 存储桶和较新的基于 dp 的选择器。乍一看，这意味着您必须将所有平板电脑布局复制到多个目录中并手动保持同步。幸运的是，有一个技巧可以在不复制/粘贴布局定义的情况下完成这项工作。它涉及在该部分中使用*布局别名。*[Android 教程的多屏](http://developer.android.com/training/multiscreen/screensizes.html#TaskUseAliasFilters)部分`values/`记录了如何做到这一点。

# python - Python RQ 的作业推送性能不理想

> ID：15349486
> 
> 赞同：13
> 
> 时间：2013-03-11T21:57:18.880
> 
> 标签：python, asynchronous, redis, task-queue, python-rq

尝试使用[`python-rq`](http://python-rq.org)支持我们的 Web 应用程序的后端，但推送新作业需要很长时间 - 最多 12 秒。

执行`enqueue_call`函数调用时会发生性能下降，特别是当连接到系统的工作进程数量增加（超过 200 个）时。

**系统工作如下：**

1.  前端将作业推送到任务队列服务器。`enqueue_call`除了要执行的函数的实际参数之外，这还使用函数将参数传递给作业（例如超时和 ttl）。
2.  多个进程（分布在多台机器上）正在运行工作人员，每个工作人员都在 UNIX 下`screen`。工作人员遵循文档中提供的模式，执行`Worker.work()`无限循环函数来监听队列。
3.  在处理过程中，一些任务会产生新的任务，通常在它们正在运行的同一个队列中。

**关于基础设施：**

*   运行此任务队列的 Redis 服务器专用于它。此外，持久性被禁用。它在 4 GB Rackspace 服务器上运行。
*   在带有任务队列的服务器上运行`redis-benchmark`时，大多数基准测试的平均结果超过 20000 r/s。

在这种情况下，我们如何提高新工作的推送性能？我们应该使用更好的模式吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-24T01:37:10.123

12 秒？疯了吧。

你考虑过用芹菜吗？
从未使用过redis-rq，但从我根据文档看到的情况来看，它对于大量工作人员来说并不是很好
Redis queue 通常基于 BLPOP 命令，它可以与多个客户端一起使用，但谁知道它可以真正处理多少钥匙。

所以我建议你切换到 Celery 或者为 python-rq 编写自己的任务分发器，这不会比切换更容易

# java - 为什么我不能在休眠中删除两个相邻的对象？

> ID：15349487
> 
> 赞同：0
> 
> 时间：2013-03-11T21:57:26.277
> 
> 标签：java, spring, hibernate

我正在使用 Spring / Hibernate 系统，我目前正在为我的项目提供图像管理。

我可以创建一个父级，上传新图像（好吧，当我做到这一点时，我将能够......），但我不能删除两个相邻的图像。例如，我的收藏中有八张图片。如果我选择图像 1、2、3 并单击删除，则 1 和 3 将删除，但 2 会徘徊。根据我的研究，这似乎来自多个线程，并且使用[hibernate 文档](http://docs.jboss.org/hibernate/core/3.3/reference/en/html/example-parentchild.html#example-parentchild-bidir)我已经`session.flush()`在我的代码中添加了一个，但它几乎没有什么区别。

```
Session session = sessionFactory.getCurrentSession();
for (int i=0; i<images.size(); i++) {
    Image image = images.get(i);
    if (image.getRemove()) {
        page.getImages().remove(image);
        session.delete(image);
        session.flush();
    }
} 
```

有谁知道我该如何解决这个问题？

非常感谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-11T22:17:57.860

这是您的图像列表：

```
A, B, C, D, E 
```

您选择第一个、第二个和第三个（A、B、C），并将它们标记为“待删除”。

在第一次迭代时，`i`等于 0，`size`等于 5，你得到索引 0（A）处的图像，它被标记为删除，所以列表变为

```
B, C, D, E 
```

在第二次迭代中，`i`等于 1，`size`等于 4，并且您在索引 1 (C) 处获得元素，该元素被标记为删除，因此列表变为

```
B, D, E 
```

在第三次迭代中，`i`等于 2，大小等于 3，并且您获得索引 2 (E) 处的元素，该元素未标记为删除。

结论：如果要保持相同的算法，请从列表的末尾开始，而不是从头开始。

# mysql - 在子查询中使用计算值，例如 MAX

> ID：15349492
> 
> 赞同：0
> 
> 时间：2013-03-11T21:57:37.740
> 
> 标签：mysql

我有以下 MySQL 表（student_lesson_progress）：

*   ID
*   课程编号
*   学生卡
*   课程状态类型 ID
*   记录日期时间
*   ...

我需要捕获当前学年中最后状态为两个值（6 或 13）之一的学生数量。

我是 SQL 新手。我想我想从获取每个 studentId/lessonId 组合的最后一条记录开始。然后我想将该列表缩小到符合我标准的列表。这是我认为我想要的查询，但它在子查询中的“Max”处触发语法错误。

```
SELECT M1.*  
FROM student_lesson_progress M1  
{  
SELECT MAX(id) as lastRecord, lessonId, studentId, lessonStatusTypeId  
FROM student_lesson_progress  
GROUP BY studentId, lessonId  
} M2  
WHERE recordDateTime > "2012-08-01" 
AND (lessonStatusTypeId = 13 or lessonStatusTypeId = 6)  
ORDER BY studentId, lessonId, lastRecord 
```

我很难找到具有计算值的子查询的语法示例。建议？或者也许有更好的方法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-11T22:11:55.823

如果 ID 一直在增加，您可以使用以下查询：

```
SELECT COUNT(*)
FROM student_lesson_progress
WHERE
  id IN (SELECT max(id)
         FROM student_lesson_progress
         GROUP BY studentId, lessonId)
  AND recordDateTime > '2012-08-01'
  AND lessonStatusTypeId IN (13, 6) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-11T22:01:54.183

看来您只是缺少和之间的`M1`连接`M2`

```
SELECT COUNT(M1.StudentID) AS Students
FROM student_lesson_progress M1
    INNER JOIN
    (SELECT MAX(id) as lastRecord, lessonId, studentId, lessonStatusTypeId  
     FROM student_lesson_progress  
     GROUP BY studentId, lessonId) M2 ON M1.ID = M2.lastRecord -- need to join M1 and M2 together
WHERE recordDateTime > '2012-08-01'
AND (lessonStatusTypeId = 13 or lessonStatusTypeId = 6)
ORDER BY studentId, lessonId, lastRecord 
```

# java - 下载文件导致 UI 卡顿

> ID：15349496
> 
> 赞同：5
> 
> 时间：2013-03-11T21:57:55.067
> 
> 标签：java, android, multithreading

我有一个在`AysncTask`'s`doInBackground()`方法中下载大文件的服务：

```
data = new byte[8192];
output = new FileOutputStream(fileLoc);
connection = (HttpURLConnection) new URL(currUrl).openConnection();
input = new BufferedInputStream(connection.getInputStream());
while ((count = input.read(data)) != -1) {
    output.write(data, 0, count);
} 
```

在执行此操作时（正在下载文件），滚动 a`ListView`可能会从有点不稳定到非常不稳定。

我尝试为下载服务创建一个新进程，更改`doInBackground()`线程的优先级，在循环期间暂停`while`任意毫秒数，并且我已经针对内存使用进行了优化。

我被卡住了，无法弄清楚如何在下载过程中让 UI 不卡顿。下载未进行时，用户界面正常响应...

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-11T22:53:55.557

[文档](http://developer.android.com/reference/android/os/AsyncTask.html)说：

> AsyncTask 被设计为一个辅助类[`Thread`](http://developer.android.com/reference/java/lang/Thread.html)，[`Handler`](http://developer.android.com/reference/android/os/Handler.html)并且不构成通用线程框架。AsyncTasks 应该理想地用于短操作（最多**几秒钟**）。如果您需要保持线程长时间运行，强烈建议您使用`java.util.concurrent`pacakge 提供的各种 API，例如[`Executor`](http://developer.android.com/reference/java/util/concurrent/Executor.html),[`ThreadPoolExecutor`](http://developer.android.com/reference/java/util/concurrent/ThreadPoolExecutor.html)和[`FutureTask`](http://developer.android.com/reference/java/util/concurrent/FutureTask.html).

因此，请考虑`Thread`在您的服务内部使用。或者看一下[`IntentService`](http://developer.android.com/reference/android/app/IntentService.html)，它在单独的工作线程上运行并且不会影响 UI（避免使用[`NetworkOnMainThreadException`](http://developer.android.com/reference/android/os/NetworkOnMainThreadException.html)）。注意事项`IntentService`：

> 所有请求都在单个工作线程上处理——它们可能需要尽可能长的时间（并且不会阻塞应用程序的主循环），但一次只会处理**一个**请求。

UI 是另一部分。如果你能提供你的方法，我想也许我可以提供帮助。*例如，[我的应用程序](https://play.google.com/store/apps/details?id=com.haibison.android.apps.files)中的下载扩展程序到目前为止运行良好 :-)*

# python - 从列表中的列表返回元素

> ID：15349497
> 
> 赞同：0
> 
> 时间：2013-03-11T21:57:56.787
> 
> 标签：python, python-2.7, mysql-python

我正在尝试从更大列表中的嵌套列表中选择第一个元素。我正在尝试从 MySQL 表中返回名称值。我建立与服务器的连接，然后执行以下操作：

```
cur = db.cursor()
cur.execute("SELECT * FROM prototype")
db.commit()
results = cur.fetchall()
for name in cur:
    print results[0] 
```

我得到以下输出：

```
('orange', 50L, 3L)
('orange', 50L, 3L)
('orange', 50L, 3L)
('orange', 50L, 3L)
('orange', 50L, 3L)
('orange', 50L, 3L)
('orange', 50L, 3L)
('orange', 50L, 3L)
('orange', 50L, 3L)
('orange', 50L, 3L) 
```

它重复正确数量的条目，但只返回一个条目。如何让它返回每个条目的名称？完整的结果是：

```
(('test', 3L, 1L), ('apple', 10L, 2L), ('orange', 50L, 3L), ('\tbanana', 1L,4L),     ('test1', 5L, 5L), ('test5', 5L, 6L), ('test3', 3L, 7L), ('gui', 1L, 8L), ('test10', 5L,  9L), ('screws', 10L, 10L)) 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-11T22:01:20.990

那么你应该`results`像这样循环你：

```
cur = db.cursor()
cur.execute("SELECT * FROM prototype")
db.commit()
results = cur.fetchall()
for name in results:
    print name[0] 
```

你用上面的代码得到的是一个`tuple`元组，所以 for 循环的每次迭代，你将每个连续的元组分配给`name`. 现在要检索该元组的值，您将其称为第一个元素 by `name[0]`，第二个 by`name[1]`等等。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-11T22:01:14.760

改变

```
for name in cur:
    print results[0] 
```

至

```
for result in results:
    print result[0] 
```

# java - 为什么这个字符串比较器不能编译？

> ID：15349500
> 
> 赞同：0
> 
> 时间：2013-03-11T21:58:09.890
> 
> 标签：java, string, object, compare, comparator

这是我正在使用的比较器：

```
import java.util.Comparator;

public class StringComparator implements Comparator
{
    public int compare(String obj1, String obj2) 
    {
        String delimeter = " ";
        String nameSplit1[] = obj1.split( delimeter );
        String nameSplit2[] = obj2.split( delimeter );

        return nameSplit1[1].compareTo(nameSplit2[1]);
    }
} 
```

这是主文件：

```
import java.util.*;

public class StringCompare
{
    public static void main( String args[] )
    {
        List<String> stringList = new ArrayList<String>();
        String delimeter = " ";

        stringList.add( "Seven Clocks" );
        stringList.add( "Twelve Beds" );
        stringList.add( "Eight Frogs" );

        Collections.sort( stringList, new StringComparator() );

        for ( String a : stringList )
        {
            System.out.println( a );
        }
    }
} 
```

我基本上是在尝试制作一个比较器，以便 collections.sort 根据第二个单词而不是第一个单词进行排序。但是当我编译它时，我得到的只是 StringComparator 不会覆盖抽象方法 compare(Object, Object) 错误。为什么它给我这个错误？...

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-11T21:59:31.987

您在 Comparator 声明中遗漏了泛型参数。

```
public class StringComparator implements Comparator<String>
//                                                     ^
//                you need this!                       |
// ---------------------------------------------------- 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-11T22:01:52.967

因为比较器是一个通用接口，并且由于您没有将它定义为 a`Comparator<String>`它依赖于最通用的定义，`Comparator<Object>`这意味着参数应该是`Objects`而不是`Strings`。

将其更改为

```
public class StringComparator implements Comparator<String> { 
```

它应该编译得很好。

# ios - UITextField 没有更新

> ID：15349502
> 
> 赞同：1
> 
> 时间：2013-03-11T21:58:17.070
> 
> 标签：ios, objective-c, xcode

我已经在我的应用程序上工作了一段时间，但我遇到了一个今天看起来很简单的问题。这可能只是一些愚蠢的事情，但我找不到。所以，请帮忙。

我有一个`UITextField`与`IBOutlet`财产有关的东西。在`viewDidLoad`,

```
self.myTextFied.text = @"123"; 
```

这行代码有效。但是在由 触发的方法中`self.delegate`，更新`myTextField.text`不会更新 UI。

```
self.myTextFied.text = @"345";
NSLog(@"%@",self.myTextField.text); 
```

`NSLog``self.myTextField.text`节目 345\. 有谁知道是什么原因以及如何解决？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-12T12:33:46.913

首先你应该检查你是否在主线程中更新你的界面 - 如果使用 gcd 尝试调用 self.setNeedsLayout

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-12T11:44:43.783

You need to give the `UITextView` the chance to get updated. The UI is running on a single thread and might therefore not get updated as long as your delegate method did still not finish. Hard to say without more information. You might have a look [here](https://stackoverflow.com/questions/3730691/how-to-repaint-a-uitextview-for-iphone-3-x-after-updating-data-programatically) for more help.

# login - 弹簧安全；自定义过滤器和用户服务引用不一起工作

> ID：15349507
> 
> 赞同：0
> 
> 时间：2013-03-11T21:58:25.820
> 
> 标签：login, spring-security, spring-3, spring-security-ldap

我正在尝试使用自定义过滤器实现 spring 安全授权。

**安全.xml**

```
<?xml version="1.0" encoding="UTF-8"?>
<beans:beans xmlns="http://www.springframework.org/schema/security"
   xmlns:beans="http://www.springframework.org/schema/beans"
   xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" 
   xmlns:p="http://www.springframework.org/schema/p" 
   xmlns:util="http://www.springframework.org/schema/util"
   xsi:schemaLocation="http://www.springframework.org/schema/beans 
        http://www.springframework.org/schema/beans/spring-beans-3.1.xsd
        http://www.springframework.org/schema/security 
        http://www.springframework.org/schema/security/spring-security-3.1.xsd
        http://www.springframework.org/schema/util 
        http://www.springframework.org/schema/util/spring-util-3.1.xsd">

    <http pattern="/resources" security="none" />

    <http auto-config="false" use-expressions="true" entry-point- ref="authenticationEntryPoint">
        <custom-filter position="BASIC_AUTH_FILTER" ref="loginFilter"/>
        <intercept-url pattern="/login" access="permitAll" />
        <intercept-url pattern="/favicon.ico" access="permitAll"/>
    </http>

    <beans:bean id="authenticationEntryPoint" class="com.my.org.MyAuthenticationEntryPoint"/>

    <beans:bean id="loginFilter"
      class="org.springframework.security.web.authentication.UsernamePasswordAuthenticationFilter">
        <beans:property name="authenticationManager" ref="authenticationManager"/>
        <beans:property name="filterProcessesUrl" value="/j_spring_security_check"/>
        <beans:property name="authenticationSuccessHandler"  >
            <beans:bean class="com.my.org.MyAuthenticationSuccessHandler"/>
    </beans:property>
        <beans:property name="authenticationFailureHandler">
            <beans:bean class="com.my.org.MyAuthenticationFailureHandler"/>
        </beans:property>
    </beans:bean>

    <authentication-manager alias="authenticationManager">
            <authentication-provider user-service-ref="customUserDetailsService">
                    <password-encoder hash="sha"/>
            </authentication-provider>
    </authentication-manager>

</beans:beans> 
```

**CustomUserDetailsS​​ervice**

```
/**
 * A custom {@link UserDetailsService} where user information
 * is retrieved from a JPA repository
 */
@Service
@Transactional(readOnly = true)
public class CustomUserDetailsService implements UserDetailsService {

private static final Logger logger = LoggerFactory.getLogger(CustomUserDetailsService.class);

@Autowired
private UserRepository userRepository;

/**
 * Returns a populated {@link UserDetails} object. 
 * The username is first retrieved from the database and then mapped to 
 * a {@link UserDetails} object.
 */
public UserDetails loadUserByUsername(String username) throws UsernameNotFoundException {
    try {

        logger.info("username-1-->"+username);
        com.cbr.model.User domainUser = userRepository.findByUsername(username);
        logger.info("domainUser-1-->"+domainUser.getPassword());
        logger.info("role-1-->"+domainUser.getRole().getRole());

        boolean enabled = true;
        boolean accountNonExpired = true;
        boolean credentialsNonExpired = true;
        boolean accountNonLocked = true;

        return new User(
                domainUser.getUsername(), 
                domainUser.getPassword().toLowerCase(),
                enabled,
                accountNonExpired,
                credentialsNonExpired,
                accountNonLocked,
                getAuthorities(domainUser.getRole().getRole()));

    } catch (Exception e) {
        throw new RuntimeException(e);
    }
}

/**
 * Retrieves a collection of {@link GrantedAuthority} based on a numerical role
 * @param role the numerical role
 * @return a collection of {@link GrantedAuthority
 */
public Collection<? extends GrantedAuthority> getAuthorities(Integer role) {
    List<GrantedAuthority> authList = getGrantedAuthorities(getRoles(role));
    return authList;
}

/**
 * Converts a numerical role to an equivalent list of roles
 * @param role the numerical role
 * @return list of roles as as a list of {@link String}
 */
public List<String> getRoles(Integer role) {
    List<String> roles = new ArrayList<String>();

    if (role.intValue() == 1) {
        roles.add("ROLE_USER");
        roles.add("ROLE_ADMIN");

    } else if (role.intValue() == 2) {
        roles.add("ROLE_USER");
    }

    return roles;
}

/**
 * Wraps {@link String} roles to {@link SimpleGrantedAuthority} objects
 * @param roles {@link String} of roles
 * @return list of granted authorities
 */
public static List<GrantedAuthority> getGrantedAuthorities(List<String> roles) {
    List<GrantedAuthority> authorities = new ArrayList<GrantedAuthority>();
    for (String role : roles) {
        authorities.add(new SimpleGrantedAuthority(role));
    }
    return authorities;
} 
```

}

**我的身份验证入口点**

```
public class MyAuthenticationEntryPoint implements AuthenticationEntryPoint {

    private Log log = LogFactory.getLog(MyAuthenticationEntryPoint.class);

    @Override
    public void commence(HttpServletRequest request, HttpServletResponse response, AuthenticationException authException) throws IOException, ServletException {

        log.info("point-1");

        response.sendError(HttpServletResponse.SC_FORBIDDEN);
    }
} 
```

**MyAuthenticationSuccessHandler**

```
public class MyAuthenticationSuccessHandler extends SimpleUrlAuthenticationSuccessHandler {

    private Log log = LogFactory.getLog(MyAuthenticationSuccessHandler.class);

    @Override
    public void onAuthenticationSuccess(HttpServletRequest request, HttpServletResponse response,Authentication authentication) throws IOException, ServletException {
        // This is actually not an error, but an OK message. It is sent to avoid redirects.
        log.info("point-2");
        response.sendError(HttpServletResponse.SC_OK);
    }
} 
```

**MyAuthenticationFailureHandler**

```
public class MyAuthenticationFailureHandler extends SimpleUrlAuthenticationFailureHandler {

    private Log log = LogFactory.getLog(MyAuthenticationFailureHandler.class);

    @Override
    public void onAuthenticationFailure(HttpServletRequest request, HttpServletResponse response,AuthenticationException exception) throws IOException, ServletException {
        log.info("point-3");
        response.sendError(HttpServletResponse.SC_UNAUTHORIZED, "Authentication Failed: " + exception.getMessage());
    }
} 
```

当我尝试登录时，它来到了 CustomUserDetailsS​​ervice 并成功地从数据库中检索了用户详细信息。

但无论凭据是否正确，它总是访问 authenticationFailureHandler 。( `INFO : com.my.org.MyAuthenticationFailureHandler - point-3`)

谁能帮我解决这个问题？谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-11T22:38:12.093

您将身份验证提供程序配置为使用`sha`密码编码`<password-encoder hash="sha"/>`(`UserDetails`也编码）。当您在 中创建`UserDetails`对象时`CustomUserDetailsService.loadUserByUsername()`，用户将从存储库中加载，并且您使用 转换他的密码`toLowerCase()`。现在，你到底为什么要这样做？该值应该是一个 sha 编码的密码。通过转换密码的哈希值，您可以保证用户无法使用其原始密码登录。但是，即使您以纯文本形式存储密码（在这种情况下`password-encoder`应该删除配置），为什么要将其设为小写`UserDetails`? 如果您这样做，并且用户将他的密码设置为“秘密”，那么他以后只能使用“秘密”进行身份验证。

# magento - Magento 模型未加载

> ID：15349508
> 
> 赞同：1
> 
> 时间：2013-03-11T21:58:30.813
> 
> 标签：magento

我正在尝试为 magento 创建一个简单的模块。我已经创建了我的控制器和路由，但由于某种原因我无法访问我的模型。据我所知，它甚至没有加载。

我没有收到错误消息，并且没有创建模型对象。

这可能是什么原因造成的？

这里有一些信息：

控制器：

```
class MyVendor_MyModule_IndexController extends Mage_Core_Controller_Front_Action
{

    public function pingAction(){

        $model = Mage::getModel('mymodule/mymodule');       
        echo "<pre>" . print_r($model->load(1),true);

    }
} 
```

模型树视图：

> ```
> MyVendor
> -MyModule
> -- controllers
> ---- IndexController.php
> -- Model
> ---- Mysql4
> -------- MyModule.php
> -------- MyModule
> ---------------- Collection.php
> ---- MyModule.php
> -- etc
> ---- config.xml 
> ```

配置文件

```
<?xml version="1.0" encoding="UTF-8"?>

<config> 
    <modules>
        <MyVendor_MyModule>
            <version>0.0.1</version>
        </MyVendor_MyModule>
    </modules>
    <frontend>
        <routers>
            <mymodule>
                <use>standard</use>
                <args>
                    <module>MyVendor_MyModule</module>
                    <frontName>mymodule</frontName>
                </args>
            </mymodule>
        </routers>   
    </frontend>
    <global>
        <models>
            <mymodule>
                <class>MyVendor_MyModule_Model</class>
                <resourceModel>mymodule_mysql4</resourceModel>
            </mymodule>
            <mymodule_mysql4>
                <class>MyVendor_MyModule_Model_Mysql4</class>
                <entities>
                    <mymodule>
                        <table>mymodule_table</table>
                    </mymodule>
                </entities>
            </mymodule_mysql4>
        </models>
        <resources>
                    <mymodule_setup>
                        <setup>
                                <module>MyVendor_MyModule</module>
                        </setup>
                        <connection>
                                <use>core_setup</use>
                        </connection>
                    </mymodule_setup>
                    <mymodule_setup>
                        <connection>
                                <use>core_write</use>
                        </connection>
                    </mymodule_setup>
                    <mymodule_setup>
                        <connection>
                                <use>core_read</use>
                        </connection>
                    </mymodule_setup>
            </resources>
    </global>
</config> 
```

在我的模型中，我有一个简单的：

```
class MyVendor_MyModule_Model_Mysql4_MyModule extends Mage_Core_Model_Mysql4_Abstract
{
    public function _construct()
    {   
        $this->_init('mymodule/mymodule', 'id');
    }
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-12T02:02:53.923

取决于平台，`Mage::getModel('mymodule/mymodule');`在查找要加载的文件时可能区分大小写（即应该`Mage::getModel('myModule/myModule');`给它您的文件夹结构和命名）

检查 get_class(Mage::getModel('mymodule/mymodule')) 返回什么。它是您班级的班级名称吗？如果不是，那么您甚至都没有创建对象的实例。之前检查骆驼外壳，您实际上有一个文件 /MyVendor/MyModule/Model/MyModule.php （您没有包含其中的代码）。

如果你有你的类的一个实例，你可能在数据库中没有任何行来支持它。所以 ->load(1); 不会做任何事情。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-12T04:00:54.587

您是否添加了 app/etc/modules/MyVendor_MyModule.xml 并且您确定没有错字错误。如果您在管理员中找到您的模块，则确认您的模块已注册。

您正在扩展一个控制器。那么做了什么来覆盖核心控制器。

# c# - Fluent 存储库容器

> ID：15349509
> 
> 赞同：1
> 
> 时间：2013-03-11T21:58:32.830
> 
> 标签：c#, fluent

我有一个关于设计流畅的存储库容器的问题。

实际上我想以这种方式获取数据：

```
IEnumerable list = RepositoryContainer
    .Of<Person>()
    .Where(p => p.name == "test")
    .Of<Member>()
    .Where(m => m.role == "role1")
    .GetItems() 
```

`GetItems()`将只运行一个返回每个注册存储库上的项目的函数。

现在我的问题是，`RepositoryContainer.Of<T> return IRepo<T>`所以我不能用它制作链条。

我需要一种暴`Of<T>`露在外面的方法，但我不知道是否有任何最佳做法。

真正需要的是我可以用一种方法合并相同类型的项目。

# javascript - 将变量传递给 Javascript 中的 JSON 值请求

> ID：15349510
> 
> 赞同：0
> 
> 时间：2013-03-11T21:58:37.210
> 
> 标签：javascript, json

我认为自己在 Javasript 中处于中等水平，但在尝试访问返回的 JSON 消息的键（在键/值对中）时遇到了主要障碍。

我正在以这样一种方式编写我的代码，即确切的密钥不是静态的，因此需要将它传递到 JSON-return-message 查询中。例如：

运行以下 JSON 查询后：

```
 var wizards = JSON.parse([some url]); 
```

我得到以下数据返回（我自己格式化它看起来可读）：

```
 {
    "Status":"Success",
    "IsValidSession":"False",
    "ErrorMessage":"Success",
    "CUSTOM_MARKER_ID_FROM_DCVIEW1":
    [
        {
            "PlaceID":"CUSTOM_MARKER_ID_FROM_DCVIEW",
            "IsVisible":"true",
            "Message":"An e-stop has been pulled.",
            "ImageName":"alert.png",
            "IsPulse":"No"
        }
    ]
    } 
```

当我查询“向导”时，“CUSTOM_MARKER_ID_FROM_DCVIEW1”是需要基于变量的。我不能简单地将其硬编码为：

```
 $.each(wizards.CUSTOM_MARKER_ID_FROM_DCVIEW1, function(j, jValue) {/*do some stuff*/}); 
```

有没有办法在“向导”之后传入一个变量。？？

任何帮助将非常感激。谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-11T22:01:18.210

使用方括号表示法：

```
var key = "CUSTOM_MARKER_ID_FROM_DCVIEW1";
$.each(wizards[key], function() {  ...  } ); 
```

# node.js - 在单独的模块 nodejs 中访问会话信息

> ID：15349512
> 
> 赞同：0
> 
> 时间：2013-03-11T21:58:50.620
> 
> 标签：node.js, session

我有 app.js

```
var express = require('express')
  , routes = require('./routes')
  , MemoryStore = new express.session.MemoryStore
  , app = express();

app.configure(function(){
  app.set('port', process.env.PORT || 3000);
  app.set('views', __dirname + '/views');
  app.use(express.bodyParser());
  app.use(express.methodOverride());
  app.use(express.cookieParser('restservice'));
  app.use(express.session({store: MemoryStore, secret: '123456', key: 'sid', maxAge: 60000 }));
  app.use(routes);  
  app.use(app.router);
}); 
```

路线/index.js

```
var express = require('express')
  , tools = require('./../functions')
  , app = module.exports = express();

app.get('/user/:id',tools.isAdmin,function(req,res){
    console.log('isadmin');
}); 
```

和function.js

```
module.exports = {
  isAdmin: function (res,req,next) {
    if (req.session.level >= 16)
        next();
    else {
        res.json({result:-1});
    }
  }
}; 
```

所以我的问题是当我访问[http://myadmin.com/user/3](http://myadmin.com/user/3)时出现错误`req.session undefined`

我如何从 functions.js 的角度访问会话信息？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-12T02:39:34.923

app.js 和 index.js 正在创建两个不同的应用程序，两个不同的 express 实例 - 两个不同的服务器。

由于您不需要另一个（索引不需要应用程序，应用程序不需要索引），因此当您运行一个时，只有那个正在运行。如果你`node app`只运行 app.js 运行，如果你`node index`只运行 index.js 运行。

您可能应该查看 express 的 github 存储库中包含的基本 express 应用程序示例：

[https://github.com/visionmedia/express/tree/master/examples/mvc](https://github.com/visionmedia/express/tree/master/examples/mvc)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-12T20:29:20.007

问题出在这一行

```
isAdmin: function (res,req,next) { 
```

出于某种原因，我用req切换了res。和

```
isAdmin: function (req,res,next) { 
```

现在我可以获取会话信息。

# c# - 从数据库中解析 xml

> ID：15349517
> 
> 赞同：5
> 
> 时间：2013-03-11T21:59:12.830
> 
> 标签：c#, asp.net, xml

目前我将 xml 存储在 ms sql dbase 而**不是文件**中。这是一个小样本。

```
<NewDataSet>
<Table1>
<billTo_lastName>asdf</billTo_lastName>
<orderAmount>160.00</orderAmount>
<billTo_street1>asdf</billTo_street1>
<card_accountNumber>############1111</card_accountNumber>
</Table1>
</NewDataSet> 
```

目前我在**Dataable**中返回结果。

解析上述内容并将其显示在页面上的最佳方法是什么。页面显示仅供参考。不会对 xml 进行额外的处理。

我希望页面显示这些内容。

```
billTo_lastName: asdf
orderAmount: 160.00
etc. 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-03-11T22:08:00.167

Depends on how you want to process it. One way is to create an `XmlDocument` and then call [LoadXml](http://msdn.microsoft.com/en-us/library/system.xml.xmldocument.loadxml.aspx):

```
// get the data from the data table, into a string.

// then create an XML document and load the string
var doc = new XmlDocument();
doc.LoadXml(dataString); 
```

If you want to use Linq-to-Xml, you'd create an [XElement](http://msdn.microsoft.com/en-us/library/system.xml.linq.xelement.aspx):

```
var element = XElement.Load(dataString); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-03-12T14:02:53.707

感谢吉姆为我指明了正确的方向。XmlDocuments LoadXml 工作得很好。然后我能够将其放入 XmlNodeList 并选择顶部节点。做了 XmlNode 并循环遍历子节点。

```
 DataTable dt = sqlselect(sqlQuery, parameter);
    var doc = new XmlDocument();
    doc.LoadXml(dt.Rows[0]["ua_post"].ToString());

    XmlNodeList nl = doc.SelectNodes("NewDataSet");
    XmlNode root = nl[0];

    foreach (XmlNode xnode in root.ChildNodes[0])
    {
        string name = xnode.Name;
        string value = xnode.InnerText;
        string nv = "<b>" + name + ":</b> " + value;
        Label1.Text += nv + " <br />" + Environment.NewLine;
    } 
```

我在页面上得到了一个简单的显示。

```
 billTo_lastName: asdf 
    orderAmount: 160.00 
    billTo_street1: asdf 
    card_accountNumber: ############1111 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-11T22:14:44.947

您可以将它们作为列从数据库返回到 DataTable，然后使用任何带有 ItemTemplates 的数据控件显示它们例如：

```
declare @xml as xml
set @xml = '<NewDataSet>
<Table1>
<billTo_lastName>asdf</billTo_lastName>
<orderAmount>160.00</orderAmount>
<billTo_street1>asdf</billTo_street1>
<card_accountNumber>############1111</card_accountNumber>
</Table1>
</NewDataSet>'

;with cte as (    
  select @xml xmlstring
)
SELECT 
xmlstring.value('(/NewDataSet//Table1/billTo_lastName/node())[1]','VARCHAR(100)')
 as billTo_lastName,
xmlstring.value('(/NewDataSet//Table1/orderAmount/node())[1]','VARCHAR(20)') 
as orderAmount
FROM cte 
```

[SQL 演示](http://sqlfiddle.com/#!3/d41d8/10738)

# jsf - 地图中的动态 El 表达式评估

> ID：15349522
> 
> 赞同：0
> 
> 时间：2013-03-11T21:59:32.417
> 
> 标签：jsf, map, el, oracle-adf, jdeveloper

我有一个 bean，它返回键值对 (String,String) 的映射。在我的 jsff 中，我需要根据 key 访问地图的值，这是一个动态 El 表达式

```
<af:iterator id="i1" value="#{bindings.leaderBoardEntities.collectionModel}"
var="entity" rows="#{bindings.leaderBoardEntities.rangeSize}">

    <af:image id="i2" source="#  {pageFlowScope.ImagesBean.imageUrlPair[entity.displayName]}"
    shortDesc="user info" inlineStyle="width:50px;height:50px;"/>
</af:iterator> 
```

我无法评估地图的密钥。我试过了，

```
source="#{pageFlowScope.ImagesBean.imageUrlPair[entity.displayName]}
source="#{pageFlowScope.ImagesBean.imageUrlPair['#{entity.displayName}']}
source="#{pageFlowScope.ImagesBean.imageUrlPair['${entity.displayName}']}
source="#{pageFlowScope.ImagesBean.imageUrlPair[#{entity.displayName}]}--this is     syntactically wrong 
```

但是，这行得通

```
source="#{pageFlowScope.ImagesBean.imageUrlPair['Twitter']} 
```

请帮助我

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-19T13:08:27.723

尝试`source="#{pageFlowScope.ImagesBean.imageUrlPair[entity.dataProvider.displayName]}"`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-11T23:42:30.913

您的问题不清楚您是否遍历地图或列表，如果是地图，请尝试以下代码，如果是列表，那么它对我来说看起来不错。

```
 <af:image id="i2" source="#  {pageFlowScope.ImagesBean.imageUrlPair
[entity.value.displayName]}"
        shortDesc="user info" inlineStyle="width:50px;height:50px;"/> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-11T22:29:37.627

您没有指定~~JSF~~ EL 版本，所以这里有一个可以工作的~~JSF2~~ EL2.2 片段：

```
source="#{pageFlowScope.ImagesBean.imageUrlPair.get(entity.displayName)} 
```

# android - 滑动菜单抽屉中的 Accordion SubMenu - Android

> ID：15349524
> 
> 赞同：0
> 
> 时间：2013-03-11T21:59:37.473
> 
> 标签：android, slidingmenu

我正在尝试为 Android 制作手风琴子菜单。例如。如果我选择任何我想要获取手风琴子菜单的项目，我在滑动抽屉菜单中有滑动菜单（滑动抽屉菜单 - Facebook 喜欢菜单）。这是我尝试过的。

```
 @Override
public void onSlideMenuItemClick(int itemId) {

    switch (itemId) {
    case R.id.item_one:
        Toast.makeText(this, "LSM Item one selected", Toast.LENGTH_SHORT).show();
        break;
    case R.id.item_two:
        Toast.makeText(this, "Item two selected", Toast.LENGTH_SHORT).show();
        break;
    case R.id.item_fourteen:
        Toast.makeText(this, "Item fourteen selected", Toast.LENGTH_SHORT).show();
        break;
    case R.id.item_fifteen:
        Toast.makeText(this, "Item fifteen selected", Toast.LENGTH_SHORT).show();
        break;

    }

} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-30T10:43:12.413

你可以试试这个帖子[https://stackoverflow.com/a/9768498](https://stackoverflow.com/a/9768498) 并且有很多 android 库我也推荐你看这篇文章 [Navigation Drawer (Google+ vs. YouTube)](https://stackoverflow.com/questions/11377472/slide-out-menu-like-android-google-and-youtube-style-slide-menu-not-like-faceb)

# c# - 如果进程正在运行，如何让 timer2 只运行一次该函数？

> ID：15349529
> 
> 赞同：1
> 
> 时间：2013-03-11T21:59:45.980
> 
> 标签：c#

在这个函数中，我正在检查游戏是否正在运行。

如果它正在运行，我正在启动`backgroundworker`.

然后在`timer2`我继续检查进程是否正在运行，直到我退出游戏。

但我不希望它继续检查它是否正在运行`backgroundworker`并一遍又一遍地重新开始......

因此，一方面我希望它`timer2`一直运行该功能，直到我退出游戏，另一方面我不希望它一直启动`backgroundworker`。

```
private void wichProcessIsrun()
{
    Process[] pname = Process.GetProcessesByName("BFBC2Game");
    if (pname.Length == 0)
    {
        Logger.Write("Battlefield Bad Company 2 Ended");
    }
    else
    {
        Logger.Write("Battlefield Bad Company 2 Started");
        backgroundWorker1.RunWorkerAsync();
    }
}

private void timer2_Tick(object sender, EventArgs e)
{
    wichProcessIsrun();
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-11T22:04:17.007

你应该有一个`bool`变量，你应该在启动进程时设置它，然后在检查期间检查它的值，如果它`true`比你不应该启动`backgroundworker`. **编辑：** 您应该检查该过程是否在结束之前已经开始。您应该将启动变量放在`if`子句中，而不是仅在进程运行一段时间后才会记录。

```
 bool started = false;
    private void wichProcessIsrun()
    {
        Process[] pname = Process.GetProcessesByName("BFBC2Game");
        if (pname.Length == 0 && started)
        {
            Logger.Write("Battlefield Bad Company 2 Ended");
            started = false;
        }
        else if(pname.Length != 0 && !started)
        {
            Logger.Write("Battlefield Bad Company 2 Started");
            backgroundWorker1.RunWorkerAsync();
            started = true;
        }
    }

    private void timer2_Tick(object sender, EventArgs e)
    {
        wichProcessIsrun();
    } 
```

# php - 如何使用 php/javascript 制作预先折叠的 TreeView

> ID：15349533
> 
> 赞同：1
> 
> 时间：2013-03-11T22:00:10.467
> 
> 标签：php, jquery, treeview, collapsable

我使用 php/javascript 制作了一个树形视图。我只是不知道如何在页面加载时使其预先折叠。

这是代码，请提出想法。

```
<?php 

$query=mysql_query("SELECT tree_entry_lang.entry_id, tree_entry_lang.lang, tree_entry_lang.name, tree_entry.parent_entry_id FROM tree_entry,tree_entry_lang WHERE tree_entry.entry_id=tree_entry_lang.entry_id AND lang='eng'");
$numrows=mysql_num_rows($query);

if($numrows>0){
    echo "<ul >";
    while($row=mysql_fetch_assoc($query)){
        echo "<li><img src='..\images\expand.gif' class='collapsableTree' > ".$row['name'];
        getChildren($row['entry_id']);

    }
    echo "</ul>";

}
else echo "Empty base";

function getChildren($parent_id){

    $query=mysql_query("SELECT tree_entry_lang.entry_id, tree_entry_lang.lang, tree_entry_lang.name, tree_entry.parent_entry_id FROM tree_entry,tree_entry_lang WHERE tree_entry.entry_id=tree_entry_lang.entry_id AND parent_entry_id=".$parent_id);
$numrows=mysql_num_rows($query);

if($numrows>0){
    echo "<ul >";
    while($row=mysql_fetch_assoc($query)){
        echo "<li><img src='..\images\expand.gif' class='collapsableTree' > ".$row['name'];
        getChildren($row['entry_id']);

    }

            echo "</ul>";
            echo "</li>";

        }

} 
```

这是jQuery部分：

```
$('.collapsableTree').click(function () {

    $(this).parent().children().toggle();
    $(this).toggle();

}); 
```

正如我所说，当页面加载时，我需要关闭所有节点。我想应该使用一些 JavaScript 函数，但恐怕我做不到。有什么解决办法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-11T22:08:45.047

Very simple using CSS. Add some classes to the elements.

```
<ul class="tree">
   <li class="node">
       <ul class="branch"> 
```

Then in css:

```
.tree.branch{display:none} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-11T22:02:35.847

这不是香草 HTML/jQuery 支持的东西，您需要编写一个插件来处理它。这不是一项微不足道的任务。我建议看一下`jstree`，它的功能非常齐全，[并且有据可查](http://www.jstree.com/)。

**编辑**

如果您要做的只是*隐藏*孩子，为什么不简单地将它们初始化为`display:none`CSS。然后在单击时显示它们。否则，鉴于上面的示例，请确保等到 DOM 准备好后再尝试通过将语句包装在中来绑定事件处理程序`$(function(){...})`：

```
$(function(){
    $('.collapsableTree').click(function () {
        $(this).parent().children().toggle();
        $(this).toggle();
    });
}); 
```

# php - 将 URL 链接写入 Elgg 数据库

> ID：15349541
> 
> 赞同：0
> 
> 时间：2013-03-11T22:00:46.957
> 
> 标签：php, mysql, social-networking, elgg

我需要能够创建一个页面，用户可以在其中与其他成员共享链接。我想将这些 URL 存储在 SQL 数据库中，以便我可以检查发布的每个链接是否是唯一的，或者之前是否已共享。

根据我的阅读，创建和自定义我自己的 elgg SQL 数据库***并不是***要走的路。所以，我需要一点指导来了解如何在当前的 elgg (1.8.13) 框架内执行此操作。我认为我需要创建自己的数据库，但也许有人可以向我填写这些数据的存储位置？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-15T15:30:34.383

你应该：

1.  阅读 Elgg 的数据模型[http://docs.elgg.org/wiki/Engine/DataModel](http://docs.elgg.org/wiki/Engine/DataModel)
2.  按照他们的教程了解如何使用此数据模型创建插件。
3.  在 elgg.org 上注册一个帐户以获得更及时的响应。[http://docs.elgg.org/wiki/Tutorials/Blog](http://docs.elgg.org/wiki/Tutorials/Blog)
4.  帮个忙，买这本书：[http ://www.amazon.com/Elgg-Social-Networking-Cash-Costello/dp/1849511306](https://rads.stackoverflow.com/amzn/click/com/1849511306)

底线是 Elgg 为您提供了数据抽象层，因此您无需手动编写 SQL。

P/s：如果您对 PHP 不太熟悉，我建议您尝试其他方法。但这只是我的意见。

# objective-c - 检查 NSString 是否包含有效数字但已本地化

> ID：15349543
> 
> 赞同：7
> 
> 时间：2013-03-11T22:00:48.353
> 
> 标签：objective-c, nsnumberformatter

考虑到本地化数字格式，如何检查字符串是否包含有效数字。

这个问题不是关于转换数字的主要问题。我可以用 NSNumberFormatter 做到这一点。如果我不能，那么我什至不需要这样做，并且可以将字符串保留为字符串。但我需要检查它是否包含有效的数字。

顺便说一句，我们在 textField:shouldChangeCharactersInRange: ... 委托方法的中间。在这里，我想通过返回 NO 来防止键入非法字符。

这是我拥有的代码：

```
- (BOOL)textField:(UITextField *)textField shouldChangeCharactersInRange:(NSRange)range replacementString:(NSString *)string {

    // Only test for numbers if it is a certain text field. 
    if (textField == self.numValueTextField) {
        NSString *resultingString = [textField.text stringByReplacingCharactersInRange: range withString: string];

        // The user deleting all input is perfectly acceptable.
        if ([resultingString length] == 0) {
            return true;
        }

        double holder;

        NSScanner *scan = [NSScanner scannerWithString: resultingString];

        BOOL isNumeric = [scan scanDouble: &holder] && [scan isAtEnd];

        if (isNumeric) {

            [self.detailItem setValue:number forKey:kValueDouble];
        }

        return isNumeric;
    }
    return YES;  // default for any other text field - if any.
} 
```

这很好用，但它暗示英文符号。这意味着浮点必须是一个pont。但在世界的某些地方，它可能是一个逗号或其他任何东西。

我确实知道如何检查某些字符。所以我可以检查 0-9、逗号和点。但是有没有一种“正确”的方式来做到这一点？

如果它很重要：我在 iOS 环境中。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-03-11T22:43:46.653

默认情况下，数字格式化程序将使用当前语言环境的信息，因此它应该能够为您执行此检查。只需尝试格式化字符串。如果结果是`nil`，那么它是无效的。

```
static NSNumberFormatter * formatter = [NSNumberFormatter new];
//... build string
NSNumber * num = [formatter numberFromString:resultingString];
BOOL isNumeric = (num != nil); 
```

例如：

```
NSNumberFormatter * formatter = [NSNumberFormatter new];

// US uses period as decimal separator
[formatter setLocale:[[NSLocale alloc] initWithLocaleIdentifier:@"en_US"];

NSLog(@"%@", [formatter numberFromString:@"3.1415"]);   // Valid NSNumber
NSLog(@"%@", [formatter numberFromString:@"3.14.15"]);  // nil
NSLog(@"%@", [formatter numberFromString:@"31415"]);    // Valid
NSLog(@"%@", [formatter numberFromString:@"3,1415"]);   // nil

// Italy uses a comma as decimal separator
[formatter setLocale:[[NSLocale alloc] initWithLocaleIdentifier:@"it"]];
NSLog(@"%@", [formatter numberFromString:@"3.1415"]);    // nil
NSLog(@"%@", [formatter numberFromString:@"3.14.15"]);   // nil
NSLog(@"%@", [formatter numberFromString:@"31415"]);     // Valid
NSLog(@"%@", [formatter numberFromString:@"3,1415"]);    // Valid 
```

或者您可能更喜欢使用`getObjectValue:forString:range:error:`，它只会返回`YES`或`NO`指示解析成功，如果您对更多细节感兴趣，还会给您一个错误对象。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-11T22:26:12.263

我就是这样做的。您想要的关键信息是`[[NSLocale currentLocale] objectForKey:NSLocaleDecimalSeparator]`，它将告诉您当前的小数分隔符。然后你寻找任何不在合法集中的字符。

```
- (BOOL)isLegalDigitString:(NSString *)string
              forTextField:(UITextField *)textField
           hasDecimalPoint:(BOOL)hasDecimalPoint
{
  // It's always legal to delete
  if ([string length] == 0)
  {
    return YES;
  }

  // Only legal characters
  NSString *decimalSeparator = [[NSLocale currentLocale] objectForKey:NSLocaleDecimalSeparator];

  NSString *legalCharacters = [@"1234567890" stringByAppendingString:
                               (hasDecimalPoint ? decimalSeparator
                                : @"")];
  NSCharacterSet *forbiddenCharacterSet = [[NSCharacterSet characterSetWithCharactersInString:legalCharacters] invertedSet];
  if ([string rangeOfCharacterFromSet:forbiddenCharacterSet].location != NSNotFound)
  {
    return NO;
  }

  // Only one decimal point
  if (hasDecimalPoint &&
      [string rangeOfString:decimalSeparator].location != NSNotFound &&
      [[textField text] rangeOfString:decimalSeparator].location != NSNotFound)
  {
    return NO;
  }

  return YES;
} 
```

作为我如何使用它的一个例子：

```
- (BOOL)textField:(UITextField *)textField shouldChangeCharactersInRange:(NSRange)range replacementString:(NSString *)string
{
  if (textField == [self integerTextField])
  {
    return [self isLegalDigitString:string forTextField:textField hasDecimalPoint:NO];
  }
  else if (textField == [self floatTextField])
  {
    return [self isLegalDigitString:string forTextField:textField hasDecimalPoint:YES];
  }

  return YES;
} 
```

这做得不好的一件事是管理有限的精度（例如，一个只能有十分之一的字段）。它需要一些重新设计。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-05-06T22:47:42.807

坦率地说，任何对有效数字的测试即使对部分数字也应该有效，实施起来非常棘手。

1.  不要试图重新实现已经在`NSNumberFormatter`. 不同的语言使用不同的小数分隔符，但也使用不同的数字（编辑：不幸的是，`NSNumberFormatter`也无法验证非阿拉伯数字）。

2.  有许多特殊情况不是有效数字，但可以成为有效数字，例如空字符串、减号、小数分隔符、减号与小数分隔符的组合。如果你允许科学记数法，它会变得更加复杂。

最简单的解决方案是只检查最终数字。当用户确认时检查输入（点击进入，点击输入视图之外）。

但是，还要注意`NSNumberFromatter`实际上可以验证部分字符串。有关更多信息，请参阅其超类`NSFormatter`。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-05-06T22:25:31.977

您可以使用 NSLocale 获取本地化的分组分隔符，然后将其从字符串中删除，因为 NSScanner 不处理分组。

```
NSString *sep = [[NSLocale currentLocale] objectForKey:NSLocaleGroupingSeparator];
NSString *string2 = [string1 stringByReplacingOccurrencesOfString:sep withString:@""]; 
```

初始化一个考虑本地化小数分隔符的 NSScanner。

```
NSScanner *scan = [NSScanner localizedScannerWithString:string2]; 
```

然后继续使用您的 NSScanner 代码。使用 NSScanner 比手动编码的方法更健壮，因为它可以处理所有符合 IEEE 标准的数字，包括 +/- 和科学记数法。它也更短。

# javascript - JavaScript 倒计时计时器

> ID：15349545
> 
> 赞同：1
> 
> 时间：2013-03-11T22:01:02.090
> 
> 标签：javascript

当那部分没有任何内容时，我想让这个 JavaScript 倒数计时器显示 01 而不是 1 和 00。我基本上只是想让它看起来像一个数字时钟，但是当没有 0 使它挤进去时它看起来很奇怪。

这是我找到的脚本：

```
// JavaScript Document

CountDownTimer('03/25/2013 9:0 AM', 'countdownSpring');
CountDownTimer('06/10/2013 9:0 AM', 'countdownSummer');
CountDownTimer('11/27/2013 9:0 AM', 'countdownFall');
CountDownTimer('12/23/2013 9:0 AM', 'countdownWinter');

function CountDownTimer(dt, id)
{
    var end = new Date(dt);

    var _second = 1000;
    var _minute = _second * 60;
    var _hour = _minute * 60;
    var _day = _hour * 24;
    var timer;

    function showRemaining() {
        var now = new Date();
        var distance = end - now;
        if (distance < 0) {

            clearInterval(timer);
            document.getElementById(id).innerHTML = 'CAMP IS HERE!';

            return;
        }
        var days = Math.floor(distance / _day);
        var hours = Math.floor((distance % _day) / _hour);
        var minutes = Math.floor((distance % _hour) / _minute);
        var seconds = Math.floor((distance % _minute) / _second);

        document.getElementById(id).innerHTML = days + ':';
        document.getElementById(id).innerHTML += hours + ':';
        document.getElementById(id).innerHTML += minutes + ':';
        document.getElementById(id).innerHTML += seconds;
    }

    timer = setInterval(showRemaining, 1000);
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-11T22:16:27.697

您可以使用一个简单的函数，例如：

```
function pad(n) {
  return (n<10? '0':'') + n;
} 
```

然后：

```
document.getElementById(id).innerHTML = pad(days) + ':' + pad(hours) + ':' +
                                        pad(minutes) + ':' + pad(seconds); 
```

或者

```
document.getElementById(id).innerHTML = [pad(days),pad(hours),pad(minutes), pad(seconds)].join(':'); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-11T22:10:54.950

Well, you can always test the value before adding it to the page and make changes accordingly, i.e.:

```
var daysString;
if (days == 0) { daysString = "00"; }
else if (days < 10) { daysString = "0" + days; }
else { daysString = "" + days; } 
document.getElementById(id).innerHTML = daysString + ':'; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-11T22:14:00.903

一种方法是创建一个数字扩展，如下所示：

```
Number.prototype.useLeadingZero = function () {
    return (this < 10 ? "0" : "") + this;
}; 
```

然后你可以像这样使用它：

```
document.getElementById(id).innerHTML = days.useLeadingZero() + ':' +
                                        hours.useLeadingZero() + ':' +
                                        minutes.useLeadingZero() + ':' +
                                        seconds.useLeadingZero(); 
```

[**工作演示**](http://jsfiddle.net/ZzFZN/1/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-11T22:34:31.103

对您的 Javascript 源代码的一些更改（我已经使用 jquery 进行了更改）

```
 var cdTimer;
        function CountDownTimer(dt, elementID)
        {
            var end = new Date(dt);

            var _second = 1000;
            var _minute = _second * 60;
            var _hour = _minute * 60;
            var _day = _hour * 24;

            cdTimer = setInterval(function() { showRemaining(end, _second, _minute, _hour, _day, elementID) }, 1000);
        }   
        function showRemaining(end, _second, _minute, _hour, _day, elementID) 
        {
            var $updateElement = $('#' + elementID);
            var now = new Date();
            var distance = end - now;
            if (distance < 0) 
            {

                clearInterval(cdTimer);
                $updateElement.html('CAMP IS HERE!');

                return;
            }
            var days = Math.floor(distance / _day);
            var hours = Math.floor((distance % _day) / _hour);
            var minutes = Math.floor((distance % _hour) / _minute);
            var seconds = Math.floor((distance % _minute) / _second);

            $updateElement.html( days + ' ' + Right('00' + hours, 2) + ':' + Right('00' + minutes, 2) + ':' + Right('00' + seconds, 2) );
        }
        function Right(str, n)
        {
            if (n <= 0)
            {
                return "";
            }
            else if (n > String(str).length)
            {
                return str;
            }
            else 
            {
                var iLen = String(str).length;
                return String(str).substring(iLen, iLen - n);
            }
        }           
        $(document).ready(function() {
            CountDownTimer('03/25/2013 9:0 AM', 'countdownSpring');
            CountDownTimer('06/10/2013 9:0 AM', 'countdownSummer');
            CountDownTimer('11/27/2013 9:0 AM', 'countdownFall');
            CountDownTimer('12/23/2013 9:0 AM', 'countdownWinter');
        }); 
```

# javascript - 如何从 Float32Array 创建向量原型？

> ID：15349557
> 
> 赞同：0
> 
> 时间：2013-03-11T22:01:27.207
> 
> 标签：javascript, prototype

```
var vector = function(x, y, z) {
    this[0] = x || 0;
    this[1] = y || 0;
    this[2] = z || 0;
};

vector.prototype = new Float32Array(3);

vector.prototype.getLength = function() {
    return Math.sqrt(Math.pow(this[0],2)+Math.pow(this[1],2)+Math.pow(this[2],2));
}; 
```

该向量是具有 3 个元素的 float32array。我不知道为什么它不起作用。如果我运行此代码，我会收到错误消息：`'vec3.length' is not a function`

```
var vec3 = new vector(3,4,5);
alert(vec3.getLength()); 
```

* * *

编辑：我替换`length`为`getLength`. 现在它可以在除 Firefox 之外的任何地方使用。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-11T22:05:55.263

的`length`属性`Float32Array`是*readonly*，所以你不能用函数替换它。在当前的草案规范中，您可以在[第 7 节](http://www.khronos.org/registry/typedarray/specs/latest/#7)中看到这一点：

```
interface TypedArray {
    const unsigned long BYTES_PER_ELEMENT = element size in bytes;

    readonly attribute unsigned long length; // <=== Note `readonly`

    getter type get(unsigned long index);
    setter void set(unsigned long index, type value);
    void set(TypedArray array, optional unsigned long offset);
    void set(type[] array, optional unsigned long offset);
    TypedArray subarray(long begin, optional long end);
}; 
```

* * *

截至您的编辑：

> 我替换`length`为`getLength`. 现在它可以在除 Firefox 之外的任何地方工作：`(intermediate value).getLength is not a function`

像这样交换问题的内容并不是很酷。但是 Firefox 可能认为`Float32Array`对象是不可扩展的。如果是这样，您可能需要添加另一层，以便您可以`getLength`在中间原型上。例如：

```
function protovector() {
}
protovector.prototype = new Float32Array(3); 

function vector(/* ... */) {
}
vector.prototype = new protovector();
vector.prototype.getLength = function() {
    // ...
}; 
```

或者只是把`length`或`getLength`放在实例上：

```
function vector(/* ... *) {
    // this[0] = ...
    this.length = function() {
        // ...
    };
} 
```

但是由于类型化数组在构造时是固定长度的，所以我不确定你从一开始就把它`Float32Array`用作原型有多少好处。

# python - 如何使用嵌套 | （或）正则表达式中的运算符？

> ID：15349563
> 
> 赞同：0
> 
> 时间：2013-03-11T22:01:44.823
> 
> 标签：python, regex

```
import re
derp = "This Act may be cited as the `Clean Air Act Amendments of the 101st Congress'."
re.search("(can)|(may) be (cited)|(referred to) as the? `(.+)'",derp).group(5) 
```

这似乎不起作用，我认为它与分组有关。有人可以帮我正确分组条款吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-11T22:03:44.713

*要在正则表达式*中使用字符串选择，请使用以下形式：

```
(?:can|may) 
```

笔记 ：

```
?: 
```

代表*非捕获组*，因此无需修改组索引

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-11T22:06:03.390

```
 "(can|may) be (cited|referred to) as the? `(.+)'" 
```

并且不要忘记修改您的组索引...

# gwt - 使用 GWT Uniform.js 更改选择值

> ID：15349564
> 
> 赞同：1
> 
> 时间：2013-03-11T22:01:46.120
> 
> 标签：gwt, widget, uniform, gwtquery

我在我的 GWT 应用程序中使用了 uniform.js。我需要以图表方式更改选择项的值。但是，小部件似乎没有更新。我知道这可以使用更新

```
$.uniform.update(); 
```

但是，我怎样才能在 GWT 中做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-17T07:11:53.367

嗨我有类似的问题。我尝试了下面的 JSNI。它对我有用。

```
 $wnd.jQuery(".checker span").each(function(){
 if(!$wnd.jQuery(this).parent().find("input:checkbox").is(':checked'))
 {
 $wnd.jQuery(this).removeClass("checked"); 
 }
 });

 $wnd.jQuery(".selector span").each(function(){
 $wnd.jQuery(this).html($wnd.jQuery(this).parent().find(":selected").text());
 }); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-12T06:35:53.083

是的。您可以使用 [JSNI](https://developers.google.com/web-toolkit/doc/latest/DevGuideCodingBasicsJSNI)从 gwt 与 jquery 联系。

尝试使用这个

```
public static native void update() /*-{
  $wnd$.uniform.update();
}-*/; 
```

或喜欢

```
public static native void update() /*-{
     $wnd.jQuery.uniform.update();
    }-*/; 
```

`GWT`并在你的类 中调用静态方法 update()

# python - Pygame 中对象之间的碰撞检测

> ID：15349565
> 
> 赞同：2
> 
> 时间：2013-03-11T22:01:48.350
> 
> 标签：python, pygame

我正在制作一个简单的游戏，我基本上有一个僵尸类，我把它放在一个组中，这样我就可以无限期地拥有它的多个实例：

```
class zombie(pygame.sprite.Sprite):
    def __init__(self):
        pygame.sprite.Sprite.__init__(self,zombiegroup)
        self.pos=(random.randrange(5,695),random.randrange(5,455))
        self.image=zombie_image
        self.rimage=self.image
        self.rect=self.image.get_rect().move(self.pos)
        self.speed=5

    def update(self):
        zx=self.rect.topleft[0]-player.rect[0]
        zy=self.rect.topleft[1]-player.rect[1]
        rads=math.atan2(-zy, zx)
        rads %= 2*pi
        angle = math.degrees(rads)
        self.rimage=pygame.transform.rotate(self.image, angle-90)
        size=self.rimage.get_size()

        if player.rect[0]<self.rect[0]:
            self.rect[0]-=self.speed

        if player.rect[0]>self.rect[0]:
            self.rect[0]+=self.speed

        if player.rect[1]<self.rect[1]:
            self.rect[1]-=self.speed

        if player.rect[1]>self.rect[1]:
            self.rect[1]+=self.speed

        screen.blit(self.rimage, (self.rect.topleft[0]-size[0]/2,self.rect.topleft[1]-size[1]/2)) 
```

我的小组只是：

```
zombiegroup=pygame.sprite.Group() 
```

这是非常基本的，但我想知道如何测试这些僵尸中的每一个是否相互碰撞，否则在追逐一段时间后它们都会在屏幕上合并成一个僵尸。我只是不知道如何处理该组来做到这一点，或者即使我应该使用 pygame 组。

多谢你们，

亚历克斯

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-11T22:04:34.843

最快但很脏的方法是跟踪比僵尸本身略小的矩形并检查它们是否发生碰撞。逐像素检查会对 FPS 造成巨大影响。

# java - 一个制造情况！对程序的某些部分使用 3 种编程语言。使用哪个构建工具？

> ID：15349571
> 
> 赞同：1
> 
> 时间：2013-03-11T22:02:05.943
> 
> 标签：java, c, makefile, build-process, build-automation

行！我不需要人们问我为什么要使用 3 种不同的编程语言来完成一项相对简单的任务……（在课程作业规范中）

我的情况是，我必须写一个程序。该程序分为 3 个部分。程序的各个部分不需要直接相互交互（我不认为）。一部分必须在 C 中，一部分在 C++ 中，另一部分在 Java 中！有点像一组 3 个工具打包在一起。

我想避免必须单独构建每个部分并单独测试每个部分并单独检查程序要求。所以我需要一个像 make 这样的工具，它可以检查每种语言的库要求等，构建每个部分，执行测试用例和所有爵士乐。

如果有什么不同，我正在考虑为程序的 Java 部分制作一个 GUI。程序的其他两部分将只有一个文本界面。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-11T23:02:42.207

我同意建议 Ant 的评论者。它非常通用，可以做任何事情，甚至它不能做的任何事情，你都可以编写一个自定义任务来让它做。它也是可移植的（如果重要的话）并且在所有安装中保持一致。它也是 Java 友好的，但`make`实际上并非如此。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-12T03:13:22.217

您是在构建一个 jar 还是在做任何比编译 Java 代码更复杂的事情？如果是这样，`ant`可能是该部分的最佳工具。

C/C++ 很容易用`make`.

我会调用`ant`使用 Makefile 中的目标来驱动整个事情。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-11T23:33:45.550

这通常是个人喜好和经验的问题。因此，最好的将是您知道如何使用的那个。尽管有一个名为[scons](http://www.scons.org/)的好工具，它支持在不同平台上开箱即用地构建所有 java、c 和 c++。它也是用 python 本身制作的，因此给你的设置增加了更多的混乱；）。这是示例 SCons 文件

```
Program('c_exe', ['file1.c', 'file2.c', 'file3.c'])
Program('cpp_exe', ['file1.cpp', 'file2.cpp', 'file3.cpp'])
Java('classes', 'src') # unlike Program, Java requires you to specify output and input folder 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-11T22:52:32.867

试试[http://www.gradle.org/](http://www.gradle.org/)。不过，c++ 支持可能有点为时过早。[在 gradle 中配置 cpp 源](https://stackoverflow.com/questions/11427262/configuring-cpp-sources-in-gradle)

# opencv - Jpg 压缩和查看/写入文件

> ID：15349583
> 
> 赞同：0
> 
> 时间：2013-03-11T22:02:42.810
> 
> 标签：opencv, image-processing, jpeg, image-compression

所以，我通过网络发送灰色 jpg 图像。我使用 jpge 在内存中压缩它们：[https://code.google.com/p/jpeg-compressor/](https://code.google.com/p/jpeg-compressor/)，然后通过网络传递它们。当我使用 opencv 显示它们或将它们写入文件时，我遇到了同样的问题：

正在捕获和显示第一张图像，然后仅显示之后每张图像的一小部分。根据我的直觉和调试：通常，100 x 100 灰度像素图像将是 100 * 100 = 10000 字节。jpg压缩后，它要少得多（取决于我设置的质量），所以假设压缩后它是5000字节，然后它会更新一半的图像。

知道为什么会这样吗？

此外，这很奇怪，因为第一张图像是完整显示的，但顶部发生变化的区域是稍浅的灰色。

# regex - 正则表达式检测电子邮件地址中@之前的句点

> ID：15349584
> 
> 赞同：0
> 
> 时间：2013-03-11T22:02:44.183
> 
> 标签：regex, email-validation

需要正则表达式来检测`first.second@domain.tld`

但没有检测到`([a-z0-9A-Z])@domain.tld`

有效的：`abc123XYZ@domain.tld`

无效的：`abc12.de456@domain.tld`

我承认电子邮件地址中的句号是合法`@`的，但需要检测这种情况。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-11T22:06:22.983

Assuming that you've already validated this as a proper email address:

`\..*@`

Which means: A `.`, then a sequence of 0 or more characters, then a `@`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-12T00:59:35.560

您不需要正则表达式，只需将句点的位置与 at 符号进行比较：

```
// assuming there's already an `@` in $email
if (($p = strpos($email, '.')) !== false && $p < strpos($email, '@')) {
    echo 'invalid';
} 
```

如果`@`电子邮件地址中没有，则不会打印`'invalid'`，因为任何整数都不会严格小于`false`.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-11T22:05:55.150

`\.(?=.*@)` 应该做的伎俩。

# sql-server-2008 - T-SQL计算平均时间

> ID：15349586
> 
> 赞同：19
> 
> 时间：2013-03-11T22:02:46.287
> 
> 标签：sql-server-2008, tsql, time, integer, dataformat

我在计算平均时间时遇到问题。情况就是这样：我有多行，每行都有时间格式的数据，所以我需要计算所有行的平均时间并将其乘以行数，但当然我的数据格式有问题，因为我需要将时间乘以整数

有人可以帮我一些建议吗？thnx 这是一些数据：

```
times
00:00:00.7400000
00:00:01.1870000
00:00:00.6430000
00:00:00.6100000
00:00:12.9570000
00:00:01.1000000
00:00:00.7400000
00:00:00.5300000
00:00:00.6330000
00:00:01.6000000
00:00:02.6200000
00:00:01.0300000
00:00:01.9630000
00:00:00.9800000
00:00:01.0170000
00:00:00.7600000
00:00:00.7130000
00:00:00.9730000
00:00:01.0000000
00:00:01.0530000
00:00:02.9400000
00:00:00.8200000
00:00:00.8400000
00:00:01.1800000
00:01:25.8230000
00:00:01.0000000
00:00:00.9700000
00:00:01.2930000
00:00:01.3270000
00:00:13.5570000
00:00:19.3170000
00:00:58.2730000
00:00:01.6870000
00:00:18.7570000
00:00:42.8570000
00:01:12.3770000
00:00:01.2170000
00:00:09.9470000
00:00:01.4730000
00:00:00.9030000
00:00:01.0070000
00:00:01.1100000
00:00:01.6270000
00:00:05.0570000
00:00:00.6570000
00:00:00.7900000
00:00:03.2930000
00:00:00.8600000
00:00:01.0330000
00:00:00.9300000
00:00:00.8730000
00:00:00.9600000
00:00:00.8070000
NULL 
```

所以从这个数据中需要平均时间或/和该数据的总和

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2013-03-11T22:18:30.297

您应该能够使用类似于以下内容的内容：

```
select 
  cast(cast(avg(cast(CAST(times as datetime) as float)) as datetime) as time) AvgTime,
  cast(cast(sum(cast(CAST(times as datetime) as float)) as datetime) as time) TotalTime
from yourtable; 
```

请参阅[SQL Fiddle with Demo](http://sqlfiddle.com/#!3/fbc92/3)。

这会将`times`数据转换为 a `datetime`，然后是 a`float`以便您可以获取`avg`/ `sum`，然后将值转换回 a `datetime`，最后是 a`time`

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2013-03-11T22:18:53.610

你可以通过做一堆日期算术来做到这一点：

```
DECLARE @t TABLE(x TIME);

INSERT @t VALUES('00:01:30'),('00:02:25'),('00:03:25');

SELECT CONVERT(TIME, DATEADD(SECOND, AVG(DATEDIFF(SECOND, 0, x)), 0)) FROM @t; 
```

但是，您*应该*做的不是`TIME`用来存储间隔/持续时间。`TIME`旨在存储一个时间点（例如，如果您需要存储超过 24 小时，则会分解）。相反，您应该存储事件的开始和结束时间。如果你有两个端点，你总是可以计算持续时间（和平均持续时间）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-11T22:30:34.613

假设您在时间字段中存储了持续时间，您可以尝试如下所示的 Datediff 函数来获取持续时间（或总时间）的总和。只需使用 Avg 作为平均值。

演示：[http ://sqlfiddle.com/#!3/f8c09/2](http://sqlfiddle.com/#!3/f8c09/2)

```
select sum(datediff(millisecond,0,mytime)) TotalTime
from t 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-06-03T22:26:48.690

这在这种情况和类似情况下可能很有用。

下面将日期/时间转换为自午夜以来的分钟数。换句话说，时间表示为整数。您可以对此进行平均，然后转换回时间。

```
declare @dt datetime = GETDATE();
select DATEDIFF(minute, dateadd(dd, datediff(dd, 0, @dt), 0), @dt);
--DATEDIFF(minute, [date without time i.e. midnight], [date/time of interest]) 
```

# c++ - 推导模板参数

> ID：15349589
> 
> 赞同：1
> 
> 时间：2013-03-11T22:02:53.807
> 
> 标签：c++

我写了代码来构建二叉搜索树，还写了一个二叉搜索树来测试它是否有效，但是我遇到了很多错误，我调试了很长时间，找不到错误。

```
#include<vector>

template<typename Key, typename Value>
struct BSTNode{
    Key key;
    Value value;
    BSTNode * left;
    BSTNode * right;
    BSTNode(Key k, Value v, BSTNode *l=NULL, BSTNode *r=NULL) :
    key(k), value(v), left(l), right(r) {}
};

template<typename Key, typename Value>
BSTNode<Key, Value>* min_height(std::vector<int> &v, int left, int right ) {
    if(left<=right){
        int mid=left+ (right-left)/2;
        BSTNode<Key, Value>* node=new BSTNode<Key, Value>(v[mid], v[mid]);
        node->left=min_height(v, left, mid-1 );
        node->right=min_height(v, mid+1, right );
        return node;
    }
}

int main(){
    std::vector<int> v;
    v.push_back(1);
    v.push_back(2);
    v.push_back(3);
    BSTNode<int, int>* root=min_height(v, 0, 5);
} 
```

编译器错误：

> ```
> prog.cpp: In function ‘BSTNode<Key, Value>* min_height(std::vector<int>&, int, int)’:
> prog.cpp:48:42: error: no matching function for call to ‘min_height(std::vector<int>&, int&, int&)’
> prog.cpp:48:42: note: candidate is:
> prog.cpp:44:22: note: template<class Key, class Value> BSTNode<Key, Value>* min_height(std::vector<int>&, int, int)
> prog.cpp:44:22: note:   template argument deduction/substitution failed:
> prog.cpp:48:42: note:   couldn't deduce template parameter ‘Key’
> prog.cpp:49:41: error: no matching function for call to ‘min_height(std::vector<int>&, int&, int&)’
> prog.cpp:49:41: note: candidate is:
> prog.cpp:44:22: note: template<class Key, class Value> BSTNode<Key, Value>* min_height(std::vector<int>&, int, int)
> prog.cpp:44:22: note:   template argument deduction/substitution failed:
> prog.cpp:49:41: note:   couldn't deduce template parameter ‘Key’
> prog.cpp: In function ‘int main()’:
> prog.cpp:63:45: error: no matching function for call to ‘min_height(std::vector<int>&, int, int)’
> prog.cpp:63:45: note: candidate is:
> prog.cpp:44:22: note: template<class Key, class Value> BSTNode<Key, Value>* min_height(std::vector<int>&, int, int)
> prog.cpp:44:22: note:   template argument deduction/substitution failed:
> prog.cpp:63:45: note:   couldn't deduce template parameter ‘Key’
> prog.cpp:63:22: warning: unused variable ‘root’ [-Wunused-variable] 
> ```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-03-11T22:06:49.810

您不能根据返回类型推断模板类型。

你可以是明确的：

```
BSTNode<int, int>* root = min_height<int, int>(v, 0, 5); 
```

但是，要使其正常工作，您还需要更新您的函数，使其在调用中明确`min_height`：

```
node->left = min_height<Key, Value>(v, left, mid - 1);
node->right = min_height<Key, Value>(v, mid + 1, right); 
```

但是，从外观上看，`min_height`总是将整数放入`Key`and `Value`。`vector`您可以通过使用 a of some使其更通用`Type`，并通过使用该类型作为`Key`and`Value`类型更明确。

```
template<typename Type>
BSTNode<Type, Type>* min_height(vector<Type> &v, int left, int right ) {
    if(left<=right) {
        int mid = left + (right - left)/2;
        BSTNode<Type, Type>* node = new BSTNode<Type, Type>(v[mid], v[mid]);
        node->left = min_height(v, left, mid - 1);
        node->right = min_height(v, mid+1, right);
        return node;
    }
} 
```

用法：

```
BSTNode<int, int>* root = min_height(v, 0, 5); 
```

# ruby - Ruby 项目实践（非 Rails）

> ID：15349590
> 
> 赞同：0
> 
> 时间：2013-03-11T22:02:54.527
> 
> 标签：ruby, gem

我通常开发 Rails 应用程序。但有时，我会制作非 Rails 的 ruby​​ 脚本——例如，文本转换器、网络爬虫等。当它是非 Rails 时，程序由单个目录中的一个或多个 ruby​​ 文件组成。我认为这不是一个好习惯。所以我搜索了 ruby​​ 项目的最佳实践。

我发现的只是关于如何制作宝石。我有点困惑。当我在做一个 ruby​​ 项目时，我会先制作一个 gem 并使用它吗？那么，调用 gem 的脚本在哪里呢？（我猜 /bin？）

Gem 是关于重用代码的，对吧？扔掉的剧本呢？

你怎么做到这一点？

谢谢。

山姆

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-11T22:06:50.633

> 当我在做一个 ruby​​ 项目时，我会先制作一个 gem 并使用它吗？

当然，如果你愿意，你可以。gem 只是表达“这个项目有这些依赖项。如果它们不存在，事情将无法正常工作”的一种方式。包含 gem 只会让您更轻松地发布代码并使用外部 ruby​​ 文件获得可预测的结果。

> 那么，调用 gem 的脚本在哪里呢？

要找出 gem 调用脚本的位置，请查看：

```
$ which gem 
```

通过你的命令行。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-11T23:50:34.170

[如果您想公开（在http://rubygems.org](http://rubygems.org)上）或在私人组织内（运行[您自己的 Gem 服务器](http://guides.rubygems.org/run-your-own-gem-server/)）分发软件，打包 gem 是有意义的。但是，如果您构建的东西仅供您自己使用，您可以只使用[Bundler](http://gembundler.com/)来管理您项目的依赖项。我通常发现这比维护 gem 更容易，因为它使您无需不断更新`.gemspec`清单，并且不必关心可能不相关的细节，例如版本号、gem 包中包含的文件和文件夹等。

# visual-studio-2010 - “Unity”视图中 VMWare Fusion 下 OS X 上的 Visual Studio

> ID：15349595
> 
> 赞同：0
> 
> 时间：2013-03-11T22:03:02.263
> 
> 标签：visual-studio-2010, macos, multiple-monitors, vmware-fusion

我正在使用 Visual Studio 2010、MacBook Pro、VMWare Fusion 和 Windows 7 进行开发。当我将 Fusion 放入 Unity 视图时，VS 2010 出现了一个奇怪且非常烦人的行为：当我键入时，会弹出一个 Intellisense 窗口，它会窃取键盘焦点。然后我不能再打字了，直到我按下“escape”（通常是多次）使 Intellisense 窗口消失。这通常在键入单个程序行时发生多次。

在“全屏”视图中不会出现此问题。

我使用 Unity 的原因是在多台显示器上安装 Windows 应用程序。

有没有办法让 VMWare Fusion 的 Unity 视图与 Visual Studio 一起使用？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-31T00:27:14.943

我找到的答案是禁用智能感知。

在菜单上选择工具/选项。在选项对话框中，选择文本编辑器，然后选择您使用的语言，然后选择“常规”。取消选中“自动列出成员”和“参数信息”。

这似乎适用于所有最新版本的 Visual Studio，包括 2012。

[关于 SO](https://stackoverflow.com/questions/5400939/how-can-we-disable-vs-2010-intellisense)的更多讨论在这里。

# java - 使用 JProgressBar 以百分比数字显示线程的进度

> ID：15349599
> 
> 赞同：0
> 
> 时间：2013-03-11T22:03:20.577
> 
> 标签：java, swing, jprogressbar

我有一个搜索一些文件的按钮，所以我试图在带有百分比数字的进度条中显示此任务的进度。我正在使用另一个线程来执行这个任务，但它需要很长时间，所以我想在进度条中显示它。

```
button.addActionListener(new ActionListener() {
        public void actionPerformed(ActionEvent e) {
            Runnable r = new Runnable() {

                public void run() {
                    //Process to search for files
                }
            };
            Thread t = new Thread(r);
            t.start();
        }
    }); 
```

请帮助我，我没有使用 JProgressBar 的经验。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-13T12:27:31.930

在阅读了一些使进度条工作的教程之后，我实现了下一个带有不确定进度条的解决方案：

```
button.addActionListener(new ActionListener() {
        public void actionPerformed(ActionEvent e) {
            Runnable r = new Runnable() {

                public void run() {
                        progressBar.setIndeterminate(true);
                        progressBar.setVisible(true);
                        progressBar.setStringPainted(true);
                        progressBar.setString("Searching..");

                    //Process to search for files

                        progressBar.setIndeterminate(false);
                        progressBar.setString("Completed Search");

                }
            };
            Thread t = new Thread(r);
            t.start();
        }
    }); 
```

# iphone - 如何正确地将 HTML 转换为字符串？

> ID：15349604
> 
> 赞同：1
> 
> 时间：2013-03-11T22:03:36.367
> 
> 标签：iphone, html, string, formatting

我是 iphone 开发的菜鸟，我正在尝试将 html 数据转换为字符串格式。目前，我正在使用 stringByConvertingHTMLToPlainText 来完成此操作，但它忽略了 HTML 的格式。我正在转换的 HTML 数据有换行符，但 stringByConvertingHTMLToPlainText 仅删除 HtML 标记并且不格式化结果字符串。任何帮助是极大的赞赏。

我的代码：

```
NSString *temp = [[[stories objectAtIndex: storyIndex] objectForKey: @"summary"]stringByConvertingHTMLToPlainText]; 
```

HTML 数据：

```
Holiday Inn<br/>Dedham,MA<br/>Sun May 5th 2013-Sun May 5th 2013<br/>Contact: Harry Tong at 603-978-3459<p><sub><i>-- Delivered by <a href="http://feed43.com/">Feed43</a> service</i></sub></p> 
```

结果字符串：

```
Holiday InnDedham,MASun May 5th 2013-Sun May 5th 2013Contact: Harry Tong at 603-978-3459-- Delivered by "http://feed43.com/"Feed43 service 
```

我需要：

```
Holiday Inn
Dedham,MA
Sun May 5th 2013-Sun May 5th 2013
Contact: Harry Tong at 603-978-3459
-- Delivered by "http://feed43.com/"Feed43 service 
```

编辑

```
NSString *html = [[stories objectAtIndex: storyIndex] objectForKey: @"summary"];
NSString *text = [html stringByReplacingOccurrencesOfString:@"<br/>" withString:@" \n "];
NSString *temp = [text stringByConvertingHTMLToPlainText]; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-11T22:10:04.840

我认为你应该用换行符替换 <br/> （如果是旧的html，可能是 <br> ）。用您正在编程的语言搜索换行符并使用字符串替换功能。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-11T22:17:24.670

@Prozi 是对的。您可以使用

```
NSString *text = [html stringByReplacingOccurrencesOfString:@"<br/>" withString:@"\n"]; 
```

在删除 html 标记*之前*执行此操作。

# php - 回显sql查询增加了一个新行

> ID：15349613
> 
> 赞同：0
> 
> 时间：2013-03-11T22:04:17.443
> 
> 标签：php

当我回显我的 sql 查询时，它会显示

```
the volunteer id is 312INSERT INTO volunteer_events (event_id, volunteer_id) VALUES ('91  
', '312') 
```

它在 '91 之后添加了一个新行，而不是全部放在一行中。我想知道我在做什么导致它添加一个新行。

```
public function addUserToEvent($event,$volunteer)
{
    $event_id = $event;
    echo "the event id is ". $event_id;
    $volunteer_id = $volunteer;
    echo "the volunteer id is ". $volunteer_id;
    $sql = "INSERT INTO volunteer_events (event_id, volunteer_id) VALUES ('$event_id', '$volunteer_id')";
    echo $sql;
    return mysql_query($sql);
} 
```

我在这里调用 addUserToEvent

```
if(isset($_POST["events"])){
    $eventIds = $_POST["events"];
    $N = count($eventIds);
    for($i=0; $i < $N; $i++) {
      echo "</br>";
      echo "The events IDs are";
      echo "</br>";
      echo($eid = $eventIds[$i]);

     $sql = "SELECT distinct v.id 
            FROM volunteers v
            WHERE v.first_name = '$fname'
            AND v.last_name = '$lname'
            AND v.email = '$email'";

     $results = $db->q($sql);
     if($row = $results->getAssoc()) 
      {
            $vID = $row['id'];
            echo "the vid is ". $vID;
      }
      echo "</br>";
      echo " the eid is blah ".$eid;
     echo $db->addUserToEvent($eid, $vID);
    }

} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-11T22:07:44.893

修复非常简单，只需转换为 int 即可。

```
public function addUserToEvent($event,$volunteer)
{
    $event = (int) $event;
    $volunteer = (int) $volunteer;
    $event_id = $event;
    echo "the event id is ". $event_id;
    [...] 
```

我在想的是字段volutor.id 的数据类型是一个varchar，它应该是一个INT。铸造你的变量总是很好的做法。

# ios - 以编程方式将键盘从大写切换到小写

> ID：15349614
> 
> 赞同：5
> 
> 时间：2013-03-11T22:04:27.390
> 
> 标签：ios, objective-c, keyboard, capitalize

我想将用户的键盘从大写变为小写以强制输入小写。我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-11T22:30:39.950

与其试图强制键盘为小写，不如在用户键入后强制字符为小写。

您没有说您使用的是 a`UITextField`还是`UITextView`. 假设您正在使用`UITextField`.

声明您的视图控制器采用该`UITextFieldDelegate`协议，并将文本字段的委托设置为视图控制器。

在视图控制器中，实现这个方法：

```
- (BOOL)textField:(UITextField *)textField shouldChangeCharactersInRange:(NSRange)range replacementString:(NSString *)string {
    string = [string lowercaseString];
    textField.text = [textField.text stringByReplacingCharactersInRange:range
        withString:string];
    return NO;
} 
```

如果您使用的是`UITextView`，请采用`UITextViewDelegate`协议并实现该`textView:shouldChangeTextInRange:replacementText:`方法。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2015-04-20T04:02:19.157

textField.autocapitalizationType = UITextAutocapitalizationTypeNone;

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-03-11T22:13:54.183

您可以做的是在关闭键盘后将文本框的字符串变为小写。例如，

```
[sender resignFirstResponder];
textField.text = textField.text.lowercaseString; 
```

当他们关闭键盘时，这会使文本小写，这就是你想要的。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-10-04T08:02:47.627

textField.autocapitalizationType = .none

为了迅速

# spring - 如何避免覆盖 sqlSessionFactory

> ID：15349617
> 
> 赞同：0
> 
> 时间：2013-03-11T22:04:40.577
> 
> 标签：spring, mybatis

我有一个导入 2 个罐子的网络应用程序。

两个 jar 都使用 MyBatis 和 Spring

```
<bean id="sqlSessionFactory" class="org.mybatis.spring.SqlSessionFactoryBean">
    <property name="dataSource" ref="dataSource" />
    <property name="configLocation" value="classpath:persistence/ormConfig-content-repository.xml" />  
    <property name="mapperLocations" value="classpath*:persistence/content-repository-mapper/*.xml" /> 
</bean> 
```

在这两种情况下，我都使用使用 sqlSessionFactory 的 SqlSessionDaoSupport

部署应用程序时出现问题

网页.xml：

```
<context-param>
<description>Spring config file</description>
<param-name>contextConfigLocation</param-name>
<param-value>
    classpath:jar1_conf.xml,
    classpath:jar2_conf.xml
</param-value> 
```

基本上，第二个 jar 中定义的 sqlSessionFactory bean 覆盖了第一个 jar 中定义的那个。

我能做些什么？请帮忙

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-26T14:39:22.630

对您没有帮助的简单答案是 Spring 的行为。您基本上是在创建一个 ApplicationContext 并加载两个具有相同名称的 bean，因此一个会覆盖另一个。解决方案是为您的应用创建多个 ApplicationContext。

# python - 返回 path 中的所有项目，inc 遍历的每个级别的兄弟姐妹

> ID：15349625
> 
> 赞同：0
> 
> 时间：2013-03-11T22:05:03.680
> 
> 标签：python

我什至不知道如何描述这一点，但我会尝试一下，希望这里的人能理解和帮助。我有许多列表，其中包含可能出现在导航结构中的节点的路径，例如：

```
['nav1']
['nav1','subnav1']
['nav1','subnav2']
['nav2']
['nav3']
['nav3','subnav1']
['nav3','subnav2']
['nav3','subnav3']
['nav3','subnav3','subsubnav1'] **
['nav3','subnav3','subsubnav1','subsubsubnav']
['nav4']
['nav5']
['nav5','subnav1']
['nav5','subnav1','subsubnav1']
['nav5','subnav2']
['nav5','subnav3'] 
```

假设我在此导航中选择了 ** 指示的节点，我还想返回作为该节点的父节点和兄弟节点的所有节点。（如 Windows 资源管理器树形菜单）。

因此，使用所选示例我将返回：

```
['nav1']
['nav2']
['nav3']
['nav3','subnav1']
['nav3','subnav2']
['nav3','subnav3']
['nav3','subnav3','subsubitem1']
['nav3','subnav3','subsubitem1','subsubsub']
['nav4']
['nav5'] 
```

我想以最有效的pythonic方式实现这一目标。我自己也尝试过几次，但都没有真正成功。这是我最接近的一次，但不幸的是它没有返回兄弟姐妹。

```
#model_path is the current selected node e.g ** as illustrated above
#always show 1st level nodes
if len(node_path) == 1:
    return True
#always show final level nodes
if model_path == node_path[:-1]:
    return True
#show all items in tree from root to model
if len(node_path) > 1:
    return self._find_sublist(node_path, model_path) >= 0
#show siblings at each level traversed
#????

# find_sublist credit to this post by nosklo:
# http://stackoverflow.com/a/2251638/1844977
def _find_sublist(self, sub, bigger):
    if not bigger:
        return -1
    if not sub:
        return 0
    first, rest = sub[0], sub[1:]
    pos = 0
    try:
        while True:
            pos = bigger.index(first, pos) + 1
            if not rest or bigger[pos:pos+len(rest)] == rest:
                return pos
    except ValueError:
        return -1 
```

我真的很感谢这里的一些帮助，因为我正在努力寻找解决方案。我应该补充一点，当有无限数量的级别时，它会起作用。

如果这个问题不清楚，或者它是重复的（我担心它可能），我深表歉意，但我真的不知道我所问的正确术语这一事实对我的搜索没有帮助。

顺便说一句，我仅限于 Python 2.4。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-11T22:30:22.783

这是我解决问题的方法：

```
FULL_NAV = [
    ['nav1'],
    ['nav1', 'subnav1'],
    ['nav1', 'subnav2'],
    ['nav2'],
    ['nav3'],
    ['nav3', 'subnav1'],
    ['nav3', 'subnav2'],
    ['nav3', 'subnav3'],
    ['nav3', 'subnav3', 'subsubnav1'],
    ['nav3', 'subnav3', 'subsubnav1', 'subsubsubnav'],
    ['nav4'],
    ['nav5'],
    ['nav5', 'subnav1'],
    ['nav5', 'subnav1', 'subsubnav1'],
    ['nav5', 'subnav2'],
    ['nav5', 'subnav3']
]

def get_required_nav(node_path, full_nav):
    return_list = []

    for comparison_node in full_nav:
        cn_len = len(comparison_node)
        np_len = len(node_path)
        if cn_len <= np_len:
            if comparison_node[:cn_len - 1] == node_path[:cn_len - 1]:
                return_list.append(comparison_node)
        else:
            if comparison_node[:np_len] == node_path:
                return_list.append(comparison_node)

    return return_list

if __name__ == '__main__':
    from pprint import pprint
    pprint(get_required_nav(
        ['nav3', 'subnav3', 'subsubnav1'], FULL_NAV))

# Output of above example:
# [['nav1'],
#  ['nav2'],
#  ['nav3'],
#  ['nav3', 'subnav1'],
#  ['nav3', 'subnav2'],
#  ['nav3', 'subnav3'],
#  ['nav3', 'subnav3', 'subsubnav1'],
#  ['nav3', 'subnav3', 'subsubnav1', 'subsubsubnav'],
#  ['nav4'],
#  ['nav5']] 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-03-15T11:27:06.033

感谢[mVChr 的回答](https://stackoverflow.com/a/15349923/1844977)，我能够使用以下内容准确返回我想要的内容：

```
FULL_NAV = [
    ['nav1'],
    ['nav1', 'subnav1'],
    ['nav1', 'subnav2'],
    ['nav2'],
    ['nav3'],
    ['nav3', 'subnav1'],
    ['nav3', 'subnav2'],
    ['nav3', 'subnav3'],
    ['nav3', 'subnav3', 'subsubnav1'],
    ['nav3', 'subnav3', 'subsubnav1', 'subsubsubnav'],
    ['nav4'],
    ['nav5'],
    ['nav5', 'subnav1'],
    ['nav5', 'subnav1', 'subsubnav1'],
    ['nav5', 'subnav2'],
    ['nav5', 'subnav3']
]

def get_required_nav(node_path, full_nav):
    return_list = []

    for comparison_node in full_nav:
        cn_len = len(comparison_node)
        np_len = len(node_path)
        if cn_len <= np_len:
            if comparison_node[:cn_len - 1] == node_path[:cn_len - 1]:
                return_list.append(comparison_node)
        else:
            if comparison_node[:-1] == node_path:
                return_list.append(comparison_node)
    return return_list

if __name__ == '__main__':
        from pprint import pprint
        pprint(get_required_nav(
            ['nav3', 'subnav3'], FULL_NAV))

# Output of above example:
# [['nav1'],
#  ['nav2'],
#  ['nav3'],
#  ['nav3', 'subnav1'],
#  ['nav3', 'subnav2'],
#  ['nav3', 'subnav3'],
#  ['nav3', 'subnav3', 'subsubnav1'],
#  ['nav4'],
#  ['nav5']] 
```

# javascript - Phonegap - 在 Mobile Safari 中打开链接

> ID：15349630
> 
> 赞同：1
> 
> 时间：2013-03-11T22:05:36.617
> 
> 标签：javascript, html, cordova

在我将应用程序更新到 Cordova 2.5.0 之前，我的基本链接在 Safari 中打开。现在它只是加载到我的应用程序视图中，而不是加载到 Safari 中。

我有以下代码： `Contact Us by visiting, <a href="http://site.com/contact.php"> our website! </a>`

关于如何解决这个问题的任何想法。

更多信息：这一切都是从我们从 Cordova/Phonegap.plist 切换到 config.xml 开始的。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-06-10T11:54:44.553

1）在 Safari 中打开链接

将代码粘贴到 MainViewController.m 文件中

```
- (BOOL)webView:(UIWebView *)theWebView shouldStartLoadWithRequest:(NSURLRequest *)request navigationType:(UIWebViewNavigationType)navigationType
{
    NSURL *url = [request URL];

    // Intercept the external http requests and forward to Safari.app
    // Otherwise forward to the PhoneGap WebView
    if ([[url scheme] isEqualToString:@"http"] || [[url scheme] isEqualToString:@"https"]) {
        [[UIApplication sharedApplication] openURL:url];
        return NO;
    }
    else {
        return [ super webView:theWebView shouldStartLoadWithRequest:request navigationType:navigationType ];
    }
} 
```

2) 在 InAppBrowser 中打开链接

```
function OpenLink()
                    {
                    alert(adlink); //adlink: http://www.google.com
                        var ref = window.open(adlink, '_blank', 'location=yes');//adlink is url
                        var myCallback = function() { alert(event.url); }
                        ref.addEventListener('loadstart', myCallback);
                        ref.removeEventListener('loadstart', myCallback);
                          } 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-12-07T22:00:23.077

1.  Add target="_blank" to your links. ie:

    ```
    <a href="http://www.brandonbrotsky.com/" target="_blank"></a> 
    ```

2.  Make sure access has an origin of * /> in your config.xml (make sure its the one in the root of the app directory, above the www folder. ie:

    ```
    <access origin="*" /> 
    ```

3.  Add the following code to MainViewController.m

    ```
    - (BOOL)webView:(UIWebView *)theWebView shouldStartLoadWithRequest:(NSURLRequest *)request navigationType:(UIWebViewNavigationType)navigationType
    {
        NSURL *url = [request URL];

        // Intercept the external http requests and forward to Safari.app
        // Otherwise forward to the PhoneGap WebView
        if ([[url scheme] isEqualToString:@"http"] || [[url scheme] isEqualToString:@"https"]) {
            [[UIApplication sharedApplication] openURL:url];
            return NO;
        }
        else {
            return [ super webView:theWebView shouldStartLoadWithRequest:request navigationType:navigationType ];
        }
    } 
    ```

I made a quick video explaining how to fix this issue:

[http://www.youtube.com/watch?v=zqbjXSnAR-Q&feature=c4-overview&list=UUefS6KLvFQVjhmL6hiBq4Sg](http://www.youtube.com/watch?v=zqbjXSnAR-Q&feature=c4-overview&list=UUefS6KLvFQVjhmL6hiBq4Sg)

Hope it helps!

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-25T15:01:57.280

你必须使用这个：window.open(' http: [//google.com','_system](http://google.com) ');

来源在这里：[http ://wiki.apache.org/cordova/InAppBrowser](http://wiki.apache.org/cordova/InAppBrowser)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-04-23T15:24:45.940

我最近一直在努力解决这个问题，并想出了一个至少对我有用的答案。Cordova 2.6 和 JQuery Mobile。

```
<a href="http://yoursite.something.com" target="_system"> the external link </a> 
```

相当多的答案让您使用 target="_blank"。但这只会在他们的 WebView 中打开链接。希望这对你有用，就像对我一样！

# jquery - 配置 Ember 以从带有 id 数组的 url 中删除括号

> ID：15349639
> 
> 赞同：0
> 
> 时间：2013-03-11T22:06:13.883
> 
> 标签：jquery, ember.js, ember-data

在我的 Ember 应用程序中，我引用了一些尚未从服务器检索和缓存的对象。Ember 在单个请求中获取它需要的数据，并且 URL 中的所有 id 都在`[]`旁边。但是我的 Java 后端不能正确处理。例子：`/rest/sites?ids[]=1&ids[]=3&ids[]=5`

有没有办法配置 Ember 来删除这些括号？像这样：`/rest/sites?ids=1&ids=3&ids=5`

看我的例子。

先前电话的回应：

```
{
  "client": {
    "name": "test",
    "sites": [ 1, 3, 5 ]
  }
} 
```

我的模板：

```
{{#each controllers.sites}}
  <h2>{{name}}</h2>
{{/each}} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-11T22:09:48.643

经过一番挖掘，我[发现](http://api.jquery.com/jQuery.ajax/)括号来自 jQuery 的 AJAX 设置。您可以配置一个 jQuery 设置以从序列化 URL 中删除方括号：

```
$.ajaxSettings({ traditional = true }); 
```

# backbone.js - Backbone pushState and error 404

> ID：15349648
> 
> 赞同：8
> 
> 时间：2013-03-11T22:06:51.260
> 
> 标签：backbone.js, backbone-routing

I'm trying to implement the `{ pushState : true }` but it works only for the base route, not with the other that continue to give me error 404.

In Chrome, If I access:

[http://example.app/](http://example.app/) - OK the console message is displayed

[http://example.app/show](http://example.app/show) - error 404 is returned

My route is

```
 var AppRouter = Backbone.Router.extend({

    routes: {
        '': 'index',
            'show': 'show'
        },

        index: function() {
            console.log('This is the index page');
        },
        show: function() {
            console.log('This is the show page');
        }

    });

    new AppRouter;
    Backbone.history.start({pushState: true}); 
```

My .htaccess

```
<ifModule mod_rewrite.c>
    RewriteEngine On
    RewriteBase /
    RewriteCond %{REQUEST_FILENAME} !-f
    RewriteCond %{REQUEST_FILENAME} !-d
    RewriteCond %{REQUEST_URI} !index
   RewriteRule (.*) index.html [L]
</ifModule> 
```

What I'm missing or I'm doing wrong?

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2013-03-11T22:15:25.040

请记住，Backbone 是一个客户端框架——如果您使用基于路径的 URL 进行路由（推送状态），您仍然需要确保服务器为这些 URL 返回正确的标记。[因此， Backbone 文档](http://backbonejs.org/#History)对此进行了总结：

> 请注意，使用真实 URL 需要您的 Web 服务器能够正确呈现这些页面，因此还需要进行后端更改。例如，如果您有 /documents/100 的路由，如果浏览器直接访问该 URL，则您的 Web 服务器必须能够提供该页面。对于完整的搜索引擎可抓取性，最好让服务器为页面生成完整的 HTML ......但如果它是一个 Web 应用程序，只需呈现与根 URL 相同的内容，然后用 Backbone 填充其余内容视图和 JavaScript 工作正常。

换句话说，如果您的服务器不理解，Backbone 将无法帮助您`example.app/show`——您必须修复服务器、使用 URL 重写和/或您选择的服务器端语言。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-09-09T13:11:52.140

您需要为这种情况创建一个初始化函数。

我在样板路由器上连接了一些东西，只需在脚本末尾初始化路由器之前将其包含在内。

```
var initialize = function() {

    var app_router = new AppRouter;

    Backbone.history.start({ pushState: false });

    $(document).on('click', 'a:not([data-bypass])', function(e){

        var href = $(this).prop('href');
        var root = location.protocol + '//' + location.host + '/';

        if (root === href.slice(0, root.length)){
            e.preventDefault();
            Backbone.history.navigate(href.slice(root.length), true);
        }
    });

}; 
```

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2013-09-24T12:21:21.770

我认为您可能只是缺少网址中的“#”。我现在正在关注一些教程，我刚刚意识到他们如何阻止请求进入服务器。

所以不是
[http://example.app/show](http://example.app/show)
而是
[http://example.app/#/show](http://example.app/#/show)

和骨干应该能够抓住它。

# android - Having a fragment activity in a fullscreen activity

> ID：15349652
> 
> 赞同：1
> 
> 时间：2013-03-11T22:07:15.693
> 
> 标签：android, android-fragments, textview

I have a fullscreen activity with fragments showing 3 TextViews, which the user can swipe through. The problem is with the action bar, on the emulator it works fine and when clicking on the activity it shows the System UI but when using the device the System UI doesn't show when clicking.

With tempering with the SWIPE_MIN_DISTANCE i noticed that the onFling method isn't being used at all, when i first only coded the fragments it used swipe by default but still the System UI didn't show when tap or click. So i thought by implementing the onFling method i could temper with the swipe.

The following is the code.

```
public class FullscreenActivity extends FragmentActivity implements OnGestureListener {

 private static final int SWIPE_MIN_DISTANCE = 120;
 private static final int SWIPE_MAX_OFF_PATH = 250;
 private static final int SWIPE_THRESHOLD_VELOCITY = 200;
private static final boolean AUTO_HIDE = true;
private static final int AUTO_HIDE_DELAY_MILLIS = 3000;
private static final boolean TOGGLE_ON_CLICK = true;
private static final int HIDER_FLAGS = SystemUiHider.FLAG_HIDE_NAVIGATION;
private SystemUiHider mSystemUiHider;
SectionsPagerAdapter mSectionsPagerAdapter;
ViewPager mViewPager;

@Override
protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);

    setContentView(R.layout.activity_fullscreen);

    final View controlsView = findViewById(R.id.fullscreen_content_controls);
    final View contentView = findViewById(R.id.pager);

    mSectionsPagerAdapter = new SectionsPagerAdapter(
            getSupportFragmentManager());

    mViewPager = (ViewPager) findViewById(R.id.pager);
    mViewPager.setAdapter(mSectionsPagerAdapter);
    // Set up an instance of SystemUiHider to control the system UI for
    // this activity.
    mSystemUiHider = SystemUiHider.getInstance(this, contentView,
            HIDER_FLAGS);
    mSystemUiHider.setup();
    mSystemUiHider
            .setOnVisibilityChangeListener(new SystemUiHider.OnVisibilityChangeListener() {
                // Cached values.
                int mControlsHeight;
                int mShortAnimTime;

                @Override
                @TargetApi(Build.VERSION_CODES.HONEYCOMB_MR2)
                public void onVisibilityChange(boolean visible) {
                    if (Build.VERSION.SDK_INT >= Build.VERSION_CODES.HONEYCOMB_MR2) {
                        // If the ViewPropertyAnimator API is available
                        // (Honeycomb MR2 and later), use it to animate the
                        // in-layout UI controls at the bottom of the
                        // screen.
                        if (mControlsHeight == 0) {
                            mControlsHeight = controlsView.getHeight();
                        }
                        if (mShortAnimTime == 0) {
                            mShortAnimTime = getResources().getInteger(
                                    android.R.integer.config_shortAnimTime);
                        }
                        controlsView
                                .animate()
                                .translationY(visible ? 0 : mControlsHeight)
                                .setDuration(mShortAnimTime);
                    } else {
                        // If the ViewPropertyAnimator APIs aren't
                        // available, simply show or hide the in-layout UI
                        // controls.
                        controlsView.setVisibility(visible ? View.VISIBLE
                                : View.GONE);
                    }

                    if (visible && AUTO_HIDE) {
                        // Schedule a hide().
                        delayedHide(AUTO_HIDE_DELAY_MILLIS);
                    }
                }
            });

    // Set up the user interaction to manually show or hide the system UI.
    contentView.setOnClickListener(new View.OnClickListener() {
        @Override
        public void onClick(View view) {
            if (TOGGLE_ON_CLICK) {
                mSystemUiHider.toggle();
            } else {
                mSystemUiHider.show();
            }
        }
    });

    // Upon interacting with UI controls, delay any scheduled hide()
    // operations to prevent the jarring behavior of controls going away
    // while interacting with the UI.
    findViewById(R.id.dummy_button).setOnTouchListener(
            mDelayHideTouchListener);
}

public class SectionsPagerAdapter extends FragmentPagerAdapter {

    public SectionsPagerAdapter(FragmentManager fm) {
        super(fm);
    }

    @Override
    public Fragment getItem(int position) {
        Fragment fragment = new DummySectionFragment();
        Bundle args = new Bundle();
        args.putInt(DummySectionFragment.ARG_SECTION_NUMBER, position);
        fragment.setArguments(args);
        return fragment;
    }

    @Override
    public int getCount() {
        return 3;
    }

}

public static class DummySectionFragment extends Fragment {
    public static final String ARG_SECTION_NUMBER = "section_number";

    public DummySectionFragment() {
    }

    @Override
    public View onCreateView(LayoutInflater inflater, ViewGroup container,
            Bundle savedInstanceState) {

        TextView textView = new TextView(getActivity());

        textView.setGravity(Gravity.LEFT);

        textView.setText(Integer.toString(getArguments().getInt(
                ARG_SECTION_NUMBER)));
        return textView;
    }
}

@Override
protected void onPostCreate(Bundle savedInstanceState) {
    super.onPostCreate(savedInstanceState);

    // Trigger the initial hide() shortly after the activity has been
    // created, to briefly hint to the user that UI controls
    // are available.
    delayedHide(100);
}

View.OnTouchListener mDelayHideTouchListener = new View.OnTouchListener() {
    @Override
    public boolean onTouch(View view, MotionEvent motionEvent) {
        if (AUTO_HIDE) {
            delayedHide(AUTO_HIDE_DELAY_MILLIS);
        }
        return false;
    }
};

Handler mHideHandler = new Handler();
Runnable mHideRunnable = new Runnable() {
    @Override
    public void run() {
        mSystemUiHider.hide();
    }
};

private void delayedHide(int delayMillis) {
    mHideHandler.removeCallbacks(mHideRunnable);
    mHideHandler.postDelayed(mHideRunnable, delayMillis);
}

 @Override
 public boolean onFling(MotionEvent e1, MotionEvent e2, float velocityX, float velocityY)
 {
 try {
 if (Math.abs(e1.getY() - e2.getY()) > SWIPE_MAX_OFF_PATH)
 return false;
 // right to left swipe
 if(e1.getX() - e2.getX() > SWIPE_MIN_DISTANCE && Math.abs(velocityX) > SWIPE_THRESHOLD_VELOCITY) {
 Toast.makeText(getApplicationContext(), "Left Swipe", Toast.LENGTH_SHORT).show();
 } else if (e2.getX() - e1.getX() > SWIPE_MIN_DISTANCE && Math.abs(velocityX) > SWIPE_THRESHOLD_VELOCITY) {
 Toast.makeText(getApplicationContext(), "Right Swipe", Toast.LENGTH_SHORT).show();
 }
 else if(e1.getY() - e2.getY() > SWIPE_MIN_DISTANCE && Math.abs(velocityX) > SWIPE_THRESHOLD_VELOCITY) {
 Toast.makeText(getApplicationContext(), "Swipe up", Toast.LENGTH_SHORT).show();
 } else if (e2.getY() - e1.getY() > SWIPE_MIN_DISTANCE && Math.abs(velocityX) > SWIPE_THRESHOLD_VELOCITY) {
 Toast.makeText(getApplicationContext(), "Swipe down", Toast.LENGTH_SHORT).show();
 }
 } catch (Exception e) {
 // nothing
 }

 return true;
 }

@Override
public boolean onDown(MotionEvent arg0) {
    // TODO Auto-generated method stub
    return false;
}

@Override
public void onLongPress(MotionEvent e) {
    // TODO Auto-generated method stub

}

@Override
public boolean onScroll(MotionEvent e1, MotionEvent e2, float distanceX,
        float distanceY) {
    // TODO Auto-generated method stub
    return false;
}

@Override
public void onShowPress(MotionEvent e) {
    // TODO Auto-generated method stub

}

@Override
public boolean onSingleTapUp(MotionEvent e) {
    // TODO Auto-generated method stub
    return false;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-05T09:43:45.130

尝试以下方式，在您的 onCreate() 方法中添加以下行，

```
 this.getWindow().setFlags(WindowManager.LayoutParams.FLAG_FULLSCREEN, WindowManager.LayoutParams.FLAG_FULLSCREEN); 
```

上面的行必须`super.onCreate(savedInstanceState);`在行之后

如下图，

```
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    this.getWindow().setFlags(WindowManager.LayoutParams.FLAG_FULLSCREEN, WindowManager.LayoutParams.FLAG_FULLSCREEN);
    ...
} 
```

# ruby-on-rails - 使用 rails 跨多个数据库与同一张表进行交互

> ID：15349653
> 
> 赞同：1
> 
> 时间：2013-03-11T22:07:23.007
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3.2

我的要求就像库存管理。我必须创建一个 Web 应用程序，它与我们所有开发环境中的同一个表（目前为 5 个）进行交互，并执行更新、删除等操作。

我阅读了有关使用以下方法连接多个数据库的信息：

```
 class Qa1 < ActiveRecord::Base
    self.abstract_class = true
      establish_connection "qa1_#{Rails.env}"
    end

    class Qa2 < ActiveRecord::Base
  self.abstract_class = true
  establish_connection "qa2_#{Rails.env}"
end 
```

现在我有一张桌子

```
class Table1Qa1 < Qa1
end

class Table1Qa2 < Qa2
end

class Table1Qa3 < Qa3
end 
```

这行得通，但我在想有没有更好的连接方式，而不是为同一张表创建这么多模型对象？

我正在使用 Rails 3.2 和 ruby​​ 1.9.3

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-11T22:54:55.340

我想要弄清楚的一件重要事情是：你*真的*需要这样做吗？如果您所需要的只是跨不同数据库同步一个或多个表的内容，那么编写一个定期将记录从主表复制到其他表的 cron 作业可能很简单：

```
connection_params.each do |params|
  ActiveRecord::Base.establish_connection(params)

  sql = "INSERT INTO #{params[:table_name]} (Foo, Bar, Fizz, Buzz)
        SELECT Foo, Bar, Fizz, Buzz
        FROM master_qa"
        #optionally WHERE ...

  ActiveRecord::Base.connection.execute(sql)
end 
```

或者，如果您必须将不同的逻辑应用于不同的环境，那么为每个表实现一个 ActiveRecord 模型可能不是一个坏主意。毕竟，您可以将通用逻辑保留在 Ruby 模块中，并将该模块混入您的所有模型中。

```
module QA
  def self.order_by_foo
    order("foo DESC")
  end

  def self.included(model_class)
    # This hooks gets fired whenever the QA gets included by a class.
    # You can use it to call class methods on your models. Eg:
    model_class.validates :foo, :presence => true
  end
end

class Qa1 < ActiveRecord::Base
  include QA
  establish_connection(:qa1)
end

class Qa2 < ActiveRecord::Base
  include QA
  establish_connection(:qa2)
end

class Qa3 < ActiveRecord::Base
  include QA
  establish_connection(:qa3)
end 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-11T22:15:23.900

你可以试试`ar-octopus`gem - [https://github.com/tchandy/octopus](https://github.com/tchandy/octopus)

看起来你可以这样做，

```
Octopus.using(:db1) do
  User.create(:name => "Mike")
end

Octopus.using(:db2) do
  User.create(:name => "Mike")
end

@user_db1 = User.using(:db1).find_by_name("Sam")
@user_db2 = User.using(:db2).find_by_name("Sam") 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-11T22:17:39.217

**使用下面的方法是一个通用模型。**

调用此方法时，传递 conf 名称代替 db_conf。

```
def self.get_data(id,db_conf,table_name)

    connection_hash = configurations[db_conf]

    establish_connection connection_hash

    con = connection()

          sql = "SELECT *
                 FROM " + table_name

     result = con.execute(sql)

     remove_connection

     establish_connection configurations["RAILS_ENV"]

     result

  end 
```

**数据库.yml**

```
db_one_conf:
  adapter: mysql2
  encoding: utf8
  reconnect: false
  database: one
  pool: 8
  username: root
  password: bomchickuwahwah
  socket: /var/run/mysqld/mysqld.sock

db_two_conf:
  adapter: mysql2
  encoding: utf8
  reconnect: false
  database: two
  pool: 8
  username: root
  password: bomchickuwahwah
  socket: /var/run/mysqld/mysqld.sock

db_three_conf:
  adapter: mysql2
  encoding: utf8
  reconnect: false
  database: three
  pool: 8
  username: root
  password: bomchickuwahwah
  socket: /var/run/mysqld/mysqld.sock 
```

我建立与新数据库的连接并删除连接并连接回旧数据库。

# mysql - De-duplicate smart random row query?

> ID：15349654
> 
> 赞同：0
> 
> 时间：2013-03-11T22:07:24.057
> 
> 标签：mysql, sql, duplicates

following some research, I found a query suitable for my needs: it randomly returns IDs from the table. The ID field is an auto-increment, so there are no holes.

```
SELECT `mydb`.`myTable`.id
FROM   (SELECT Floor (Rand() * (SELECT Count(*) 
                                FROM   `mydb`.`myTable`)) num, 
               @num := @num + 1 
        FROM   (SELECT @num := 0) a, 
               `mydb`.`myTable` 
        LIMIT  2000000) b, 
       `mydb`.`myTable` 
WHERE  b.num = `mydb`.`myTable`.id 
```

The issue I experience is that the target table (myTable) contains 30-400M records, depending on the situation. In the LIMIT, I want to retrieve 2M randomly selected IDs, however I get a lot of duplicates (which is expected).

Is it possible to de-duplicate the query and yet receive 2M records? I thought to create a table and let it manage the UNIQUE values, but again I will get less than expected.

Any thoughts? Many thanks!

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-11T22:28:32.417

您可以简单地随机排序您的行。比没有重复，你是否有洞也没关系。

```
SELECT 
   id
FROM
  mydb.myTable
ORDER BY
  RAND()
LIMIT 2000000 
```

# mysql - MAMP/MYSQL 设置中的错误

> ID：15349658
> 
> 赞同：0
> 
> 时间：2013-03-11T22:07:59.900
> 
> 标签：mysql, terminal, mamp

我制作了一个 .profile 文件，其中包含以下代码：

```
PATH=$PATH:/Applications/MAMP/Library/bin
export PATH 
```

我仍然无法让“mysql”命令工作或让 MYSQL 管理员工作。我觉得这也导致无法查看我为测试而编写的任何 PHP 脚本。我还尝试进入我的 MAMP 目录的特定“htdocs”文件夹，当我在终端中执行 ls -a 时，这就是我得到的结果：

```
.
..
.DS_Store
Akamai
Indiana Jones and the Fate of Atlantis.app
Portal.app 
```

显然，我拥有的不仅仅是这些应用程序。帮助？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-14T21:22:30.537

我必须关闭本机 apache 服务器才能在正确的端口上获得正确的连接，这就是我在 .profile 文件夹（我将其重命名为 .bash_profile）中重新键入的内容：

```
export PATH=$PATH:/Applications/MAMP/Library/bin 
```

一旦我这样做了，并在终端中停止了 apache：

```
sudo apachectl stop 
```

一切正常！

# sublimetext2 - How to force SublimeText 2 to use 4 spaces tab? (it changes to spaces sometimes)

> ID：15349661
> 
> 赞同：5
> 
> 时间：2013-03-11T22:08:07.007
> 
> 标签：sublimetext2, indentation, auto-indent

Often SublimeText 2 opens files and if it finds in some place some spaces instead of a tab.

I said to force everything to 4 tabs. Not to convert manually every file I open to tabs (like in [How to replace four spaces with a tab in Sublime Text 2?](https://stackoverflow.com/questions/9575739/how-to-replace-four-spaces-with-a-tab-in-sublime-text-2))

Sometimes I have a document with tab indentation of 4 spaces and when I press tab it writes 4 spaces!

```
"detect_indentation": false,
"translate_tabs_to_spaces": false 
```

(doing tab_completion=true it helps)

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-03-12T01:38:40.533

如果您设置`detect_indentation`为，`true`那么 ST2 将扫描文件用于缩进的内容，并且（制表符或空格）将是您按下`Tab`键时插入的内容。如果您查看 ST2 窗口的底部，在右侧显示当前文档的语言的左侧，它应该显示类似`Tab Size: 4`或`Spaces: 4`。您可以单击它以（取消）设置`Indent Using Spaces`选项，以及设置制表符的呈现大小。

# css - 在 Volusion 左侧导航菜单中更改字体

> ID：15349663
> 
> 赞同：1
> 
> 时间：2013-03-11T22:08:08.763
> 
> 标签：css, drop-down-menu, hover, nav, volusion

这是我们 Volusion 导航菜单中的代码：

```
#display_menu_1 .nav {background-color:transparent;}
#display_menu_1 .nav_hover {background-color:transparent;}
#display_menu_3 .nav {background-color:transparent;}
#display_menu_3 .nav_hover {background-color:transparent;} 
```

URL 是[http://www.markpoulin.com](http://www.markpoulin.com) 如您所见，导航菜单的字体不同。导航菜单底部的“关于我们”和“购买地点”链接在 Verdana 中，我们想匹配它们，但我不知道如何更改导航菜单中的字体。我曾尝试在线研究，但找不到这种特定类型的代码，并尝试在不同的地方插入字体系列位，但它并没有改变字体。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-11T22:16:30.827

您无法设置导航菜单样式的原因是它包含内联 CSS。这是导航菜单上第一项的片段：

`<a onclick="return $K(0)" name="mM1" onfocus="_iF0C(0)" href="http://www.markpoulin.com/category-s/292.htm" class="nav" id="lnk0" style="border:none;background:transparent;display:block;;font-Family:Georgia;font-Weight:normal;font-Style:normal;font-Size:11px">Mother's Day</a>`

请注意属性`font-Family:Georgia`中的位置。`style`内联样式具有最高的特异性，因此不可能用 CSS 选择器覆盖。有什么办法可以防止导航生成内联样式？例如。`<a onclick="return $K(0)" name="mM1" onfocus="_iF0C(0)" href="http://www.markpoulin.com/category-s/292.htm" class="nav" id="lnk0">Mother's Day</a>`

阅读本文了解有关 CSS 特异性的更多信息：http: [//coding.smashingmagazine.com/2007/07/27/css-specificity-things-you-should-know/](http://coding.smashingmagazine.com/2007/07/27/css-specificity-things-you-should-know/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-27T05:12:20.243

我一直与 Volusion 合作，当我完全找不到改变我需要的方法时，我会这样做（仅作为最后的手段！！）。具体来说，这将针对所有这些侧菜单链接：

```
#lnk0, #lnk1, #lnk2, #lnk3, #lnk4, #lnk5, #lnk6, #lnk7, #lnk8, #lnk9, #lnk10, #lnk11, #lnk12, #lnk13, #lnk14, #lnk15, #lnk16, #lnk17, #lnk18, #lnk19, #lnk20, #lnk21, #lnk22, #lnk23, #lnk24, #lnk25, #lnk26, #lnk27, #lnk28, #lnk29, #lnk30, #lnk31, #lnk32, #lnk33, #lnk34, #lnk35, #lnk36, #lnk37, #lnk38, #lnk39, #lnk40, #lnk41, #lnk42, #lnk43, #lnk44, #lnk45, #lnk46 {
font-family: tahoma!important; 
```

（当然，将字体更改为您想要的任何字体）。使用 volusion，因为代码嵌套在表中表中的表中（噱头！），您需要具体说明您的目标。

使用 !important 有时会使 css 变得非常混乱，但不幸的是我不得不大量使用它。与 sweetamylase 所说的不同，此技巧将覆盖您的大部分内联样式需求。

这是一篇关于 !important 的文章 [http://webdesign.about.com/od/css/f/blcssfaqimportn.htm](http://webdesign.about.com/od/css/f/blcssfaqimportn.htm)

# git - 如何在 git 中重命名文件夹并使用交互式变基隐藏它？

> ID：15349668
> 
> 赞同：6
> 
> 时间：2013-03-11T22:08:39.323
> 
> 标签：git, git-rebase

我有一个项目，在项目过程中我意识到我不喜欢目录的名称。

在 GIT 中，我们可以重命名目录然后提交，但历史记录仍会显示较旧的文件夹。

我想将名称更改重新设置为较早的提交。所以我通常会做的是：

```
git rebase -i origin/master 
```

然后将文件夹重命名提交移到顶部。
然而，正如预期的那样，git 会产生很多需要解决的冲突。

有没有更自动化的方法来做到这一点？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-13T15:44:02.707

如果它是您尚未与任何人共享的东西，我推断这是因为您无论如何都试图对其进行变基，我将删除包含重命名的提交，并执行过滤器分支。

假设 foo 包含第一次出现的错误目录，并且您的重命名是最新的提交：

```
git reset --hard HEAD^ # removes the rename commit
git filter-branch --tree-filter "mv bad good" foo^..HEAD 
```

这会将坏目录重命名为好目录。

# java - Change the Bluetooth inquiry scan time

> ID：15349673
> 
> 赞同：3
> 
> 时间：2013-03-11T22:08:57.223
> 
> 标签：java, android, bluetooth

According to the method [`BluetoothAdapter.startDiscovery()`](http://developer.android.com/reference/android/bluetooth/BluetoothAdapter.html#startDiscovery%28%29), the discovery process usually involves an inquiry scan of about 12 seconds. Is there any thing to reduce the inquiry time scan (lower than 12 seconds)?

This is my `MainActivity`:

```
package com.example.bluetoothsignal;

import android.os.Bundle;
import android.app.Activity;
import android.bluetooth.BluetoothAdapter;
import android.bluetooth.BluetoothDevice;
import android.content.BroadcastReceiver;
import android.content.Context;
import android.content.Intent;
import android.content.IntentFilter;
import android.view.Menu;
import android.widget.EditText;

public class MainActivity extends Activity {

    private EditText statusText;
    private BluetoothAdapter mBtAdapter;

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_main);

        statusText = (EditText) findViewById(R.id.statusText);

        statusText.setText("");
        Intent discoverableIntent = new Intent(
                BluetoothAdapter.ACTION_REQUEST_DISCOVERABLE);
        discoverableIntent.putExtra(
                BluetoothAdapter.EXTRA_DISCOVERABLE_DURATION, 300);
        startActivity(discoverableIntent);

        IntentFilter localIntentFilter1 = new IntentFilter(
                "android.bluetooth.device.action.FOUND");
        registerReceiver(this.mReceiver, localIntentFilter1);
        IntentFilter localIntentFilter2 = new IntentFilter(
                "android.bluetooth.adapter.action.DISCOVERY_FINISHED");
        registerReceiver(this.mReceiver, localIntentFilter2);
        IntentFilter filter = new IntentFilter(BluetoothDevice.ACTION_FOUND);
        registerReceiver(mReceiver, filter);
        this.mBtAdapter = BluetoothAdapter.getDefaultAdapter();
        this.mBtAdapter.startDiscovery();
    }

    @Override
    public boolean onCreateOptionsMenu(Menu menu) {
        // Inflate the menu; this adds items to the action bar if it is present.
        getMenuInflater().inflate(R.menu.main, menu);
        return true;
    }

    private final BroadcastReceiver mReceiver = new BroadcastReceiver() {

        public void onReceive(Context paramContext, Intent paramIntent) {
            String action = paramIntent.getAction();
            if ("android.bluetooth.device.action.FOUND".equals(action)) {
                BluetoothDevice localBluetoothDevice = (BluetoothDevice) paramIntent
                        .getParcelableExtra("android.bluetooth.device.extra.DEVICE");
                int s = paramIntent.getIntExtra(
                        "android.bluetooth.device.extra.RSSI", -32768);
                short s2 = paramIntent.getShortExtra(
                        "android.bluetooth.device.extra.RSSI", Short.MIN_VALUE);
                int s1 = paramIntent.getIntExtra(BluetoothDevice.EXTRA_RSSI,
                        Integer.MIN_VALUE);

                String state = localBluetoothDevice.getAddress() + "\n"
                        + localBluetoothDevice.getName() + "\n" + s + "\n" + s1
                        + "\n" + s2;
                statusText.setText(statusText.getText().toString() + state);
            } else if (BluetoothDevice.ACTION_FOUND.equals(action)) {
                // Get the BluetoothDevice object from the Intent
                BluetoothDevice device = paramIntent
                        .getParcelableExtra(BluetoothDevice.EXTRA_DEVICE);
                // Add the name and address to an array adapter to show in a
                // ListView
                statusText.setText(statusText.getText().toString()
                        + device.getName() + "\n" + device.getAddress());
            } else if (("android.bluetooth.adapter.action.DISCOVERY_FINISHED"
                    .equals(action))) {
                if (MainActivity.this.mBtAdapter.isDiscovering()) {
                    MainActivity.this.mBtAdapter.cancelDiscovery();
                }
                statusText.setText("");
                MainActivity.this.mBtAdapter.startDiscovery();
            }
        }
    };
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-12-15T18:01:14.940

您可以在它停止时调用 startDiscovery。在您的广播接收器中：

```
if (BluetoothAdapter.ACTION_DISCOVERY_FINISHED.equals(action))
{
    btAdapter.startDiscovery();
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-13T04:04:30.147

如果您想连接到不知道完整地址的设备，则必须使用完整的发现`BluetoothAdapter.startDiscovery()`并搜索接收到的地址以查找您想要的地址。

如果您知道要连接的设备的完整地址，则可以使用以下命令直接连接到该设备`BluetoothDevice device = mBluetoothAdapter.getRemoteDevice(address);`

因此，通过直接使用`.getRemoteDevice(address);`，您可以保存扫描设备。而是直接连接...

例子：

```
BluetoothDevice device = BluetoothAdapter.getDefaultAdapter().getRemoteDevice("00:1C:4D:02:A6:55");

sock = device.createRfcommSocketToServiceRecord(UUID.fromString("8e1f0cf7-508f-4875-b62c-fbb67fd34812")); 
```

然后`sock.connect();`等等..希望你明白了

# c++ - 将 .txt 复制到 int 数组，然后保存到另一个文件中

> ID：15349674
> 
> 赞同：0
> 
> 时间：2013-03-11T22:09:00.673
> 
> 标签：c++, text-files, ifstream, ofstream, dev-c++

// 编辑：我发现了我的错误。我仍然缺少一件事：它没有正确计算行数。如果 .txt 中的最后一个字符不是 '\n' ，则它会减少 1 行。如果我击中它，它很重要 2。怎么了 ？你能帮助我吗？

> krol.txt =

```
2 4
3 7
3 13
2 4
3 1 
```

和 main.cpp

```
#include <iostream>
#include <fstream>
#include <cstdlib>
using namespace std;
int main(){
    ofstream outFile;
    ifstream fin;
    fin.open("krol.txt");
    int l=0;
    char ch;
    while (fin.good()){
        fin.get(ch);
        if (ch=='\n') l++;
    }
    cout << l;
    fin.close();
    fin.open("krol.txt");
    int temp[l][2];
    int savel=l;
    l=0;
    int i=0;
        while (fin >> (temp[l][i])){
        i++;
        if(i==2){ 
         i=0; l++;
        }
    }

    outFile.open("save.txt");
    for (int i=0, j=0;j<savel;i++){
        if (i==2) {
        i=0; j++;
        }
        outFile << temp[j][i];
    }
    outFile.close();
    system("PAUSE");
    return 0;
     } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-11T22:12:32.377

我不是 C++ 专家，但不应该

```
fout >> ch; 
```

是

```
fout << ch; 
```

?

（由 Thomas Matthews 的评论修正）

# spring - Dynamic enumerations in Spring, or how to keep Spring away from constructors?

> ID：15349676
> 
> 赞同：0
> 
> 时间：2013-03-11T22:09:23.223
> 
> 标签：spring, dynamic, enumeration, json-rpc, embeddable

Is "Dynamic enumerations" an oxymoron, like "static variables"? ;-)

I've only been soaking in Spring for a short time, and I suspect I'm not thinking Spring-like yet. I would like to have a type-safe, dynamic enumeration. I've used this pattern for things like events or error codes where you want to allow subsequent sub-classes to expand the enumeration. Since "enum" can't be extended you're left with an enumeration pattern class. For example (stripped down):

```
public class EventType {

    private String name;    

    private static HashMap<String, EventType> cache 
                     = new HashMap<String, EventType>();

    protected EventType(String name) {
        if (cache.containsKey(name)) {
            throw new RuntimeException("EventType '" + name + "' already exists!");
        } else {
             this.name = name;
             cache.put(name, this);
        }
    }

    public static AuditEventType parse(String name) {
        return cache.get(name);
    }

    public static final EventType EVENT_START = new AuditEventType("Start");
    public static final EventType EVENT_END   = new AuditEventType("End");
    public static final EventType EVENT_FAIL  = new AuditEventType("Fail");
} 
```

The problems start when I add Spring to the mix. Since it's only a string, I've annotated EventType as "@Embeddable", and classes that use it annotate that member as "@Embedded". This seemed to work great until it came time for querying using queryDSL-jpa. DSL would try to convert the DB text to an EventType, which then would have a type mismatch with strings. That is, I couldn't say: `WHERE EventType = "Start"`. I got around this (not elegantly) by having the class with such a field store it as a String, and parse it to an EventType object in the getter. So now it's just a plain ol' string as far as JPA is concerned.

Now I'm running into an issue with the service API. I have a method with an EventType parameter. The problem is that the JsonRpcServer class is trying to convert the String to an EventType by instantiating it. This of course throws an "already exists!" exception.

I can probably solve this second issue with @JsonTypeResolver (which I'm reading up on now). But all of these shenanigans feel wrong. This must be a common issue and there's got to be a better solution. What's the proper way of handling such classes in Spring? (where it's not a bean, really, and has a protected constructor).

*(I'm leaving out some specifics about some proprietary libraries our code uses, and which might not let me adopt an answer like "Oh, you should be using 'X' instead." Thanks for understanding.)*

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-12T06:29:05.790

对于 Spring 方面，请查看 conversionService。这使您可以注册自定义转换器。所以你应该能够注册你的 EventTypeToStringConverter 和 StringToEventTypeConverter。他们将拥有“完全”控制权来解决您的事件类型。

对于 Hibernate 而言，为 EventType 使用特定的 UserType 可能是一种解决方案，因此 Hibernate 能够将其作为列值存储和读取。（这是我希望您需要的）我对每个实体都有类似的要求，我不想将其建模为实体本身。我还没有设法直接在查询中使用字符串参数，但是有很多接口可以实现，很可能有一个接口允许对参数进行字符串识别。

# sql - 有条件的排序方式

> ID：15349677
> 
> 赞同：3
> 
> 时间：2013-03-11T22:09:25.593
> 
> 标签：sql, postgresql, postgresql-9.2

我有一张表，其中有一组带有开始标签和结束标签的路线。每行都有一个列“progres”，它是应用全局“order by”子句的列，最后是一个选择列，告诉哪些标签类型必须排序（奇数、偶数或全部）。if LabelStart > LabelEnd => 按 ASC 排序，否则按 DESC

例如这里是路线路径

```
路线
ID RouteID、Progres、LabelStart、LabelEnd 类型
1 1 5 1 21 ○
2 1 10 10 2 E
4 2 15 2 25 安
5 3 20 1 11 ○
6 3 22 4 10 E
7 4 30 5 11 ○
8 4 31 2 12

```

这里是属于路线的点

```
积分
PoinID RouteID、标签
1 1 3           
2 1 2
4 1 1
5 1 8
6 1 5
7 1 6
8 1 9
9 1 21
10 1 10
11 1 11
12 2 1
13 2 2
14 2 12
15 2 3
16 2 25
17 2 14
...  

```

我需要的是一个表格，其中所有点均由 Routes Proges 全局排序，根据类型按偶数、奇数或全部分组，如果 LabelStart > LabelEnd 则按 DESC 最后按 ASC 排序。结果应该是：

```
ID RouteID、PointID
1 1 4           
2 1 1
4 1 6
5 1 8
6 1 11
7 1 9
8 1 10
9 1 5
10 1 7
11 1 2
12 2 13
13 2 15
...

```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-03-12T00:05:07.440

[SQL小提琴](http://www.sqlfiddle.com/#!12/f0399/1)

```
select 
    row_number() over() id, *
from (
    select
        r.routeid,
        p.pointid,
        label,
        type,
        labelstart,
        labelend
    from
        route r
        inner join
        point p on p.routeid = r.routeid
    where
        r.type = 'E' and p.label % 2 = 0
        or
        r.type = 'O' and p.label % 2 != 0
        or
        r.type = 'A'
    order by
        r.routeid, r.progres, r.id,
        case labelstart < labelend
            when true then label
            else label * - 1
        end
) s 
```

# ios - What IOS A.P.I Should I be learning to draw smooth curves with adjustable points

> ID：15349681
> 
> 赞同：0
> 
> 时间：2013-03-11T22:09:43.660
> 
> 标签：ios, plot, core-graphics

I have never really done much with IOS drawing API's before. I looking into drawing a smooth plot like curve with a programmable number of control points, something similar to this:

[Sample Graph http://blog.mixonline.com/briefingroom/wp-content/uploads/2010/09/eq-editing-screen.jpg](http://blog.mixonline.com/briefingroom/wp-content/uploads/2010/09/eq-editing-screen.jpg)

(I realize that there's a ton math behind the sample graph, I just want to start out with manipulating simple points).

My first thought was that I should be looking into using UIBezierPath Quad paths. I found that this works really well if I have just a start point, end point and control point. I've had a lot of trouble getting curves to look 'sensible' if I try to add a chain of quads to simulate the example I posted.

Basically I just have a lot of doubt about the correct approach to take. Can somebody advise me on where I should be directing my attention?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-11T22:39:18.193

你需要处理核心情节。这是来自 ray 网站的多部分教程，它将对您有很大的帮助，以便从核心情节开始。 [http://www.raywenderlich.com/13269/how-to-draw-graphs-with-core-plot-part-1](http://www.raywenderlich.com/13269/how-to-draw-graphs-with-core-plot-part-1)

快乐编码我的朋友

# php - CakePHP controller action not firing

> ID：15349683
> 
> 赞同：0
> 
> 时间：2013-03-11T22:09:51.130
> 
> 标签：php, controller, cakephp-1.3

I'm a beginner at CakePHP, and for a project at work I'm running into a maddening problem. I have a paginated list of links with each linking to a view in cakephp:

```
link1: <a href="<?php echo $SITE_URL>/users/show_chart/<?php echo $id0;?>">See Chart</a>
link2: <a href="<?php echo $SITE_URL>/users/show_chart/<?php echo $id1;?>">See Chart</a>
link3: <a href="<?php echo $SITE_URL>/users/show_chart/<?php echo $id2;?>">See Chart</a> 
```

Pretty simple. I'm inheriting the project from a previous team, so there's some code I don't understand yet, but I think it's pretty clear that it should be calling the "show_chart" action function in the "users_controller" class.

Inside that function I've tried various things like:

```
function show_chart($id) {
echo "<pre>";
echo $id;
echo "</pre>";
echo "You'd better show me something";
exit;
} 
```

But when I click on one of the links, it performs the action as though I never edited the action at all in the controller. My little debug message never shows up. The program even works as usual when I comment the "show_chart" function out wholesale.

My first thought was that there's an HTTP redirect somewhere, but I can't find anything amiss. My second thought was that this action is somehow cached somewhere and the function is getting bypassed in favor of the caching. Any thoughts? Anyone?

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-11T22:26:25.267

检查路由器。这将准确地告诉您该 URL 调用了哪个操作和控制器。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-11T22:28:51.913

原则上，你是对的。/users/show_chart/ 转到用户控制器和展示车功能。

在您的情况下，有用的是下载您拥有的所有代码并在某个 IDE 中创建一个项目，以便您可以搜索整个项目。我一直将 eclipse 与 CakePHP 一起使用，但存在许多替代方案。最有可能的是，您可以从 Notepad++ 开始并搜索 google 以查看如何查看文件夹中的所有文件。然后，只需搜索“show_cart”即可！

除此之外，它可能在几个地方，具体取决于您之前团队的质量...... .htaccess、路由器、引导程序、用户控制器、随机 php 脚本......

祝你好运！

# vb.net - 将组合框字符串复制到文本框

> ID：15349687
> 
> 赞同：0
> 
> 时间：2013-03-11T22:10:09.290
> 
> 标签：vb.net, combobox, textbox

如何将组合框中的信息复制到文本框中？我希望它实时完成，所以一旦在组合框中选择了一个项目，它就会出现在文本框中

cboGender.SelectedText = txtGender.Text 试过了

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-11T22:17:22.593

如果您尝试将 a 复制`Text`到`ComboBox`a `TextBox`，则您提供的代码是向后的。但真正的答案是，不要使用`ComboBox.SelectedText`; 采用`ComboBox.Text`

```
txtGender.Text = cboGender.Text 
```

# macos - VBA - Copy Excel table to Word - Works on PC, Fails on Mac

> ID：15349690
> 
> 赞同：0
> 
> 时间：2013-03-11T22:10:25.200
> 
> 标签：macos, excel, vba, ms-word, copy

I have written some code VBA which copies data from Excel to Word when an Excel cell is clicked. The process is as follows:

```
1\. Opens an already created word document, duplicates the word document, and then closes the original document; leaving open the copy (duplicate) for further modification.

2\. The code then finds and replaces some placeholder values within the word document with values from the Excel document.

3\. The code then deletes 2 different tables (1 at a time), row by row, and replaces each table (1 at a time) with a table copied from Excel.

4\. The code then displays a message to the user that all has been completed and exits. 
```

All code works perfectly on my PC, but fails on a colleagues MAC, stating the "Error: 4605 - Command is not available" and failing on the `wrdApp.Selection.PasteExcelTable False, False, True` line of code.

Here's the code:

```
Sub Copy2Word()

    Dim wrdApp As Object
    Dim tempDoc As Word.Document
    Dim mrgDoc As Word.Document
    Dim NumPay As Integer
    Dim cll As Excel.Range

    'GET NUMBER OF PAYMENTS SELECTED FOR USE BELOW
    NumPay = Notated.Cells(Data.Range("DV2").Value, Data.Range("DV3").Value).Value

    'GET LOCATION OF WORD FILE FROM USER
    FName = Application.GetOpenFilename
    If FName = False Then
        usrErr = 1
        GoTo ErrHnd
    End If

    'RECORD THE WORD FILE LOCATION ON HIDDEN SHEET FOR USE BY OTHER MACROS
    MergeData.Range("B2").Value = FName

    'CREATE WORD OBJECT
    On Error Resume Next
    Set wrdApp = GetObject(, "Word.Application")
    On Error GoTo 0
    If wrdApp Is Nothing Then
        Set wrdApp = CreateObject("Word.Application")
    End If

    'DISPLAY WORD APPLICATION
    On Error Resume Next
    wrdApp.Visible = True
    wrdApp.Activate
    On Error GoTo 0

    'OPEN THE (TEMPLATE) FILE
    wrdApp.Documents.Open Filename:=FName

    'SET A VARIABLE TO REFERENCE ACTIVE DOCUMENT (TEMPLATE)
    Set tempDoc = wrdApp.ActiveDocument

    'DUPLICATE THE DOCUMENT
    wrdApp.Documents.Add wrdApp.ActiveDocument.FullName

    'SET A VARIABLE TO REFERENCE THE NEW VERSION OF DOCUMENT
    Set mrgDoc = wrdApp.ActiveDocument

    'CLOSE THE ORIGINAL (TEMPLATE) VERSION OF DOCUMENT
    tempDoc.Close SaveChanges:=False

    'ACTIVATE THE NEW DOCUMENT
    mrgDoc.Activate

    'REPLACE PLACEHOLDER TEXT ITEMS WITH ACTUAL
    For Each cll In MergeData.Range(MergeData.Cells(1, 3).Address & ":" & MergeData.Cells(1, MergeData.Range("A1").End(xlToRight).Column).Address)
        If cll.Offset(1, 0).Value = "" Then
            repTx = cll.Value
       Else
            repTx = cll.Offset(1, 0).Value
        End If
        With mrgDoc.Content.Find
            .Text = cll.Value
            .Replacement.Text = repTx
            .Forward = True
            .Wrap = wdFindContinue
            .Format = False
            .MatchCase = False
            .MatchWholeWord = False
            .MatchWildcards = False
            .MatchSoundsLike = False
            .MatchAllWordForms = False
            .Execute Replace:=wdReplaceAll
        End With
    Next cll

    'REPLACE TABLE 2 ON WORD DOC
    mrgDoc.Tables(2).Select
    For ii = 30 To 2 Step -1
        mrgDoc.Tables(2).Rows(ii).Delete
    Next ii
    wrdApp.Selection.TypeParagraph

    'COPY AND PASTE TABLE 1 FROM EXCEL TO WORD
    Application.CutCopyMode = False
    EO_DOC.Range("EO_TBL_INSCOPE_1").Copy
    wrdApp.Selection.PasteExcelTable False, False, True 

    ''''REMAINDER OF CODE AND COMPLETION CONFIRMATION TO USER''''

End Sub 
```

I have tried a bunch of different things such as adding DoEvents, etc. to see if it would remedy the situation but have not yet found a solution.

Any VBA for MAC gurus out there? Anyone?

Thanks in advance.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-01T11:38:43.077

问题似乎是 wrdApp.Activate 的位置，它阻止 Excel 进行复制和 Word 进行粘贴。在这里，在您的代码的精简版本中，我能够通过移动语句使其位于 PasteExcelTable 行之前来使复制/粘贴工作。如果您必须保留该行的副本，则问题是（例如）在设置 CutCopyMode 之前立即激活 Excel 工作簿似乎不足以让 Excel 正确执行复制。（顺便说一句，我不是 Mac VBA 大师！）

# wordpress - 在 Wordpress 的 Genesis 框架中按日期范围过滤帖子

> ID：15349692
> 
> 赞同：0
> 
> 时间：2013-03-11T22:10:30.927
> 
> 标签：wordpress

这个问题只适用于创世纪框架。

我有一个名为“新闻”的类别。在我的“新闻”类别页面上，我只想显示过去 30 天内发布的帖子。

这是我开始使用的代码：

```
<?php

remove_action('genesis_loop', 'genesis_do_loop');
add_action('genesis_loop', 'pm_recent_news_loop');

function pm_last_name_loop() {
global $query_args;
$args = (array(
   //????
));

genesis_custom_loop( wp_parse_args($query_args, $args) );

}
genesis(); 
```

在一般的 WordPress API 文档中，它基本上说您无法通过将参数传递给 $query_args 来实现按日期范围过滤（这是 genesis_custom_loop 完成它的方式。相反，似乎正确的方法是add_filter('posts_where', 'my_where_filter') 然后通过 post_date 定义 where 子句。参考： [http](http://codex.wordpress.org/Class_Reference/WP_Query#Parameters) ://codex.wordpress.org/Class_Reference/WP_Query#Parameters 。

但是我无法让它工作。当我尝试实现类似于 codex 中描述的代码时，我要么没有收到任何帖子，要么收到所有帖子。我认为这是因为 Genesis 以某种方式围绕 posts_where 过滤器工作，或者以不被调用的方式包装它。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-07-08T14:26:14.560

尝试使用一些 SQL 添加过滤器

```
filter_daterange($where='') {
$where .= " AND post_date >= '".date('Y-m-d H:i:s', strtotime('-30 days'))."' AND post_date <= '".date('Y-m-d H:i:s')."'";
return $where;
} 
```

在循环之前添加过滤器，然后将其删除

```
add_filter( 'posts_where', 'filter_daterange' );
genesis_custom_loop( wp_parse_args($query_args, $args) );
remove_filter( 'posts_where', 'filter_daterange' ); 
```

# c++ - OpenMP 中预分配的私有 std::vector 在 C++ 中并行化 for 循环

> ID：15349695
> 
> 赞同：9
> 
> 时间：2013-03-11T22:10:43.780
> 
> 标签：c++, for-loop, openmp, stdvector

我打算使用 buffers `std::vector<size_t> buffer(100)`，每个线程中的一个循环并行化，正如这段代码所建议的：

```
std::vector<size_t> buffer(100);
#pragma omp parallel for private(buffer)
for(size_t j = 0; j < 10000; ++j) {
    // ... code using the buffer ...
} 
```

此代码不起作用。尽管每个线程都有一个缓冲区，但它们的大小可以为 0。

如何在每个线程的开头分配缓冲区？我还能用`#pragma omp parallel for`吗？我可以做得比这更优雅吗：

```
std::vector<size_t> buffer;
#pragma omp parallel for private(buffer)
for(size_t j = 0; j < 10000; ++j) {
    if(buffer.size() != 100) {
        #pragma omp critical
        buffer.resize(100);
    }
    // ... code using the buffer ...
} 
```

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2013-03-11T22:56:09.793

拆分 OpenMP 区域，如[本问题](https://stackoverflow.com/questions/1448318/openmp-omp-parallel-vs-omp-parallel-for)所示。

然后在外部区域内声明向量，但在 for 循环本身之外。这将为每个线程创建一个本地向量。

```
#pragma omp parallel
{
    std::vector<size_t> buffer(100);

#pragma omp for
    for(size_t j = 0; j < 10000; ++j) {
    {

        // ... code using the buffer ...

    }
} 
```

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2013-12-12T09:16:58.393

这个问题和公认的答案已经存在了一段时间，这里有一些进一步的信息，它们提供了对 openMP 的更多见解，因此可能对其他用户有所帮助。

在 C++ 中，`private`and`firstprivate`子句以不同的方式处理类对象：

> 从 OpenMP 应用程序接口 v3.1：
> 
> **private**：新列表项已初始化，或者具有未定义的初始值，就好像它是在没有初始化器的情况下在本地声明的一样。未指定调用用于类类型的不同私有变量的任何默认构造函数的顺序。
> 
> **firstprivate**：对于类类型的变量，调用复制构造函数来执行列表变量的初始化。

即`private`调用默认构造函数，而`firstprivate`调用相应类的复制构造函数。

的默认构造函数`std::vector`构造一个没有元素的空容器，这就是缓冲区大小为 0 的原因。

要回答这个问题，这将是另一种无需拆分 OpenMP 区域的解决方案：

```
std::vector<size_t> buffer(100, 0);  
#pragma omp parallel for firstprivate(buffer)
for (size_t j = 0; j < 10000; ++j) {
  // use the buffer
} 
```

**编辑**关于私有变量的一般注意事项：线程堆栈大小是有限的，除非显式设置（环境变量`OMP_STACKSIZE`）编译器依赖。如果您使用占用大量内存的私有变量，堆栈溢出可能会成为一个问题。

# javascript - 添加链接到幻灯片图像，由滚轮 javascript 控制

> ID：15349703
> 
> 赞同：1
> 
> 时间：2013-03-11T22:11:15.370
> 
> 标签：javascript, javascript-events

我很难尝试为幻灯片中的每个图像添加不同的链接。

我对 Javascript/Jquery 还很陌生，所以如果有更简单更有效的方法来实现这一点，那就太好了。

```
<img id="slideshow"  src="V1.jpg" />
<script type="text/javascript">
var myimages=[
    "V1.jpg", 
    "V2.jpg",
    "V3.jpg",
    "V4.jpg",
    "V5.jpg"
] 
var slideshow=document.getElementById("slideshow")
var nextslideindex=0

function rotateimage(e) {
    var evt=window.event || e //equalize event object
    var delta=evt.detail? evt.detail*(-120) : evt.wheelDelta//delta returns +120 when wheel is scrolled up, -120 when scrolled down
    nextslideindex=(delta<=-120)? nextslideindex+1 : nextslideindex-1 //move image index forward or back, depending on whether wheel is scrolled down or up
    nextslideindex=(nextslideindex<0)? myimages.length-1 : (nextslideindex>myimages.length-1)? 0 : nextslideindex //wrap image index around when it goes beyond lower and upper boundaries
    slideshow.src=myimages[nextslideindex]
    if (evt.preventDefault) //disable default wheel action of scrolling page
        evt.preventDefault()
    else
        return false
}
var mousewheelevt=(/Firefox/i.test(navigator.userAgent))? "DOMMouseScroll" : "mousewheel" //FF doesn't recognize mousewheel as of FF3.x

if (slideshow.attachEvent) //if IE (and Opera depending on user setting)
    slideshow.attachEvent("on"+mousewheelevt, rotateimage)
else if (slideshow.addEventListener) //WC3 browsers
    slideshow.addEventListener(mousewheelevt, rotateimage, false)
</script> 
```

# javascript - 在 iFrame 中应用 CSS

> ID：15349704
> 
> 赞同：1
> 
> 时间：2013-03-11T22:11:35.157
> 
> 标签：javascript, html, css, google-dfp

我正在尝试将广告图片的宽度从像素更改为百分比。我正在使用 Google DoubleClick 或“DFP”。它会自动将您的广告图片放入 iframe 中，因此很难更改图片的实际尺寸。

因此，我将图像宽度从像素更改为百分比的方法是，我制作了一个 div（即网页的 90%）包裹在图像广告周围，然后将图像的宽度设置为 100%，所以当包装器浏览器宽度调整大小时宽度会发生变化，其中的图像将始终填满包装器。但是我不知道如何使这一切正常工作，因为图像在 iframe 内（愚蠢的 DFP ！！！）

这是...包装器的 CSS 代码：

```
#div-gpt-ad-1362958263281-0 {width:90%; border:1px solid black;} 
```

然后是包装器中的 iframe：

```
iframe {width:100%;} 
```

最后是我尝试了一些 CSS 选择器和不同 div 类的实际图像：

```
.img_ad, a#aw0, iframe>.img_ad, iframe>#google_image_div>.img_ad {width:100%; display:block; border:1px solid red !important;} 
```

如果您在 Google Chrome 中检查广告图片上的元素，您会发现 CSS 未应用于图片。我想做的就是将图像宽度更改为百分比..并将高度更改为`auto`. 真的应该这么难吗？由于图像位于 iframe 中，这甚至可能吗？DFP 是否让我失败了？我只是不知道...但是，我将如何更改图片广告的代码？任何帮助都将真正真正受到赞赏！:)

这是 jsFiddle：http: [//jsfiddle.net/EptwH/3/](http://jsfiddle.net/EptwH/3/)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-16T14:27:59.007

我发现我可以使用同步加载，结合谷歌吹捧的“智能 iframe”，我可以从他们的 iframe 中撕下链接并将其放在我的 DOM 中。

请注意，我将 dfp 代码的相同 ID 传递给了我的 AdjustGoogleAd 方法。我弄乱了宽度/高度属性，因为我们在一个响应式站点上。

```
<script type='text/javascript'>
    (function () {
        var useSSL = 'https:' == document.location.protocol;
        var src = (useSSL ? 'https:' : 'http:') +
        '//www.googletagservices.com/tag/js/gpt.js';
        document.write('<scr' + 'ipt src="' + src + '"></scr' + 'ipt>');
    })();
</script>
<script type='text/javascript'>
    googletag.defineSlot('{AD SLOT HERE}', [WIDTH, HEIGHT], 'dfp-div-id').addService(googletag.pubads());
    googletag.pubads().enableSyncRendering();
    googletag.pubads().enableSingleRequest();
    googletag.enableServices();

    $(function () {
        AdjustGoogleAd('dfp-div-id');
    });

    function AdjustGoogleAd(bannerId) {
       var banner = $('#' + bannerId);
       var contents = $('#' + bannerId + ' iframe').contents();

       contents.find('a').clone().attr('id', bannerId + '_a').appendTo('#' + bannerId);
       var newLink = $('#' + bannerId + '_a');
       newLink.siblings().remove();
       newLink.find(".img_ad").removeAttr('height').removeAttr('width');
    }

</script> 
```

使用 HTML：

```
<div id='dfp-div-id'>
     <script type='text/javascript'>
         googletag.display('dfp-div-id');
     </script>
</div> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-05-15T08:54:05.543

这是一个 jsfiddle 示例，我很确定您想要做什么......所以是的，有可能......它是否违反了 DFP 的条款是另一个问题！

[http://jsfiddle.net/e3dUT/](http://jsfiddle.net/e3dUT/)（调整窗格大小以查看它的工作，目前只能在 chrome 中 100% 工作，但这应该只是进一步调整它的问题。）

```
$.dfp({
    dfpID: '12589173',
    afterAllAdsLoaded: function ($adUnits) {
        $('iframe').attr('width', '100%').attr('height', '100%');
        $adUnits.each(function () {
            $contents =  $(this).find('iframe:first').contents();
            $contents.find('img').width('100%').height('auto');
        });
    }
}); 
```

它使用我创建的[jQuery DFP](https://github.com/coop182/jquery.dfp.js)插件，但通过一些工作，您也可以在股票 javascript 中实现它。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-11T22:36:09.907

这里`iframe`是不同的域。你不能用 CSS 或 JS 修改它的内容。

# nagios - collectd 可以作为 nagios 的替代品吗？

> ID：15349705
> 
> 赞同：1
> 
> 时间：2013-03-11T22:11:53.983
> 
> 标签：nagios, collectd

Collectd 提供了一种测量机器统计数据的好方法。如果我需要扩展插件系统来支持怎么办

1.  被测机器的配置
2.  服务器上运行的所有进程的列表以及 CPU、内存和磁盘的利用率？
3.  扫描安全漏洞？
4.  补丁管理 - 如果 collectd 客户端需要升级，用户现在需要重新编译和重新安装。我们可以将升级推送到所有运行 collectd 代理的客户端机器吗？我的猜测是这应该是可能的，因为服务器和客户端在 UDP 中处于多播模式（没有客户端服务器模式对吗？）

我目前有用于图形和 mongodb 的石墨设置来收集数据。理想情况下，我想将非数字数据存储在 mongodb 中。

第 1、2 和 3 项可能吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-12T05:15:02.187

*   1 号

*   2 不是真的。但是，如果您使用该`/processes/`插件，您将能够随时跟踪进程列表，例如使用该`/unixsock/`插件。在某种程度上，您确实拥有插件/实例/类型/实例中包含的标签形式的非数字数据。

*   3号

*   4 不，但是您不一定要使用多播，该`/network/`插件可以处理单播流量。

# java - Java并发编程——同步数组

> ID：15349708
> 
> 赞同：1
> 
> 时间：2013-03-11T22:12:00.643
> 
> 标签：java, multithreading, concurrency

假设我有四个类：Party、Creature、Job、Item。

派对有生物
派对有物品
生物有工作（线程）
工作需要物品

我无法确定如何同步各个项目，这样没有作业可以同时访问一个项目。我以表格形式汇总了聚会中所有可用物品的清单

```
ArrayList<ItemInstance> 
```

其中 ItemInstance 有一个 Item 和一个表示数量的整数。我不知道如何执行此列表上的锁定

```
ReentrantLock resourceLock = new ReentrantLock();
ArrayList<Condition> resourceConditions = new ArrayList<Condition>(); 
```

我想过这样做，但是锁定 resourceLock 会锁定所有项目，对吗？此外，我需要锁定特定数量的项目。所以我的数组条目可能是

```
(Swords, 4) 
```

在我的主列表中，但我的工作可能只需要使用 3 把剑。我应该将它们全部存储在一个列中并删除数量吗？

一般的概念是我有一个包含所有项目和数量的大型派对清单，然后我有很多工作，其中包含所需的项目和数量的小清单。我试图让我的作业线程等待足够的每个项目，执行，然后释放要重用的项目。

```
PartyList = 
(Swords, 7)
(Forks, 2)
(Bottles, 5)

JobEatList = 
(Forks, 1)
//RUN THREAD

PartyList = 
(Swords, 7)
(Forks, 1)
(Bottles, 5)

JobDineList = 
(Bottles, 2)
(Forks, 4)
//WAIT 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-11T22:28:25.507

您应该列出要执行的并发操作（类的方法）。概述它们的依赖关系和不变量，这样你就知道什么可以同时完成，什么必须序列化（同步）​​。将您的作业定义为大部分独立的任务，以以最小的阻塞实现最大的并发性。好好看看所`java.util.concurrent`提供的东西，尤其是更高级别的课程`Semaphore`，例如 等。

抱歉，如果这听起来太笼统和笼统。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-11T22:36:20.630

首先，正如其他一些人所指出的，您需要更清楚，和/或分析您正在尝试做的事情。

其次，一种“对程序员来说容易”的方法是将`CopyOnWriteArrayList`s 用于任何“棘手”的事情。就速度而言，它可能不是最有效的，但是对于您的应用程序来说，它可能已经足够快了。至少考虑一下。

# python - 如何从字符串中删除标点符号，然后稍后将其添加回同一索引？

> ID：15349709
> 
> 赞同：1
> 
> 时间：2013-03-11T22:12:01.543
> 
> 标签：python, string, list, function, punctuation

我想让程序假设我的 word_str 是“例如，这是‘剑桥大学’”。如果单词的长度大于 3 个字符，它将保留单词的第一个和最后一个字母，并在单词的内部打乱。我的问题是它错误地在单词的开头或结尾用标点符号打乱了单词。我需要它来洗牌，以便标点符号保留在正确的索引中，然后保留单词的第一个和最后一个字母，并在单词的内部洗牌，如果有的话，在末尾添加标点符号。有任何想法吗？

```
def scramble_word(word_str):
char = ".,!?';:"
import random
if len(word_str) <= 3:
    return word_str + ' '
else:
    word_str = word_str.strip(char)
    word_str = list(word_str)
    scramble = word_str[1:-1]
    random.shuffle(scramble)
    scramble = ''.join(scramble)
    word_str = ''.join(word_str)
    new_word = word_str[0] + scramble + word_str[-1]
    return new_word + ' ' 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-11T22:27:56.047

使用正则表达式：

```
import random
import re

random.seed(1234) #remove this in production, just for replication of my results

def shuffle_word(m):
    word = m.group()
    inner = ''.join(random.sample(word[1:-1], len(word) - 2))
    return '%s%s%s' % (word[0], inner, word[-1])

s = """This is 'Cambridge University' for example."""

print re.sub(r'\b\w{3}\w+\b', shuffle_word, s) 
```

哪个打印

```
Tihs is 'Cadibrgme Uinrtvsiey' for exlampe. 
```

`re.sub`允许您向它传递一个函数（它接受一个正则表达式匹配对象）而不是替换字符串。

# 编辑 - 没有正则表达式

```
from StringIO import StringIO

def shuffle_word(m):
    inner = ''.join(random.sample(m[1:-1], len(m) - 2))
    return '%s%s%s' % (m[0], inner, m[-1])

def scramble(text)
    sio = StringIO(text)
    accum = []
    start = None
    while sio.tell() < sio.len:
        char = sio.read(1)
        if start is None:
            if char.isalnum():
                start = sio.tell() - 1
            else:
                accum.append(char)
        elif not char.isalnum():
            end = sio.tell() - 1
            sio.seek(start)
            accum.append(shuffle_word(sio.read(end - start)))
            print accum[-1]
            start = None
    else:
        if start is not None:
            sio.seek(start)
            word = sio.read()
            if len(word) > 3:
                accum.append(shuffle_word(sio.read()))
            else:
                accum.append(word)

    return ''.join(accum)

s = """This is 'Cambridge University' for example."""
print scramble(s) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-11T22:41:02.307

使用正则表达式非常容易：

```
import re
import random

s = ('Pitcairn Islands, Saint Helena, '
     'Ascension and Tristan da Cunha, '
     'Saint Kitts and Nevis, '
     'Saint Vincent and the Grenadines, Singapore')

reg = re.compile('(?<=[a-zA-Z])[a-zA-Z]{2,}(?=[a-zA-Z])')

def ripl(m):
    g = list(m.group())
    random.shuffle(g)
    return ''.join(g)

print reg.sub(ripl,s) 
```

结果

```
Piictran Islands, Sanit Heelna, Asnioecsn and Tiastrn da Cunha, Sniat Ktits and Neivs, Snait Vnnceit and the Giearndens, Snoiaprge 
```

# box2d - Box2d SetMassFromShape 替换为 SetMassData

> ID：15349711
> 
> 赞同：0
> 
> 时间：2013-03-11T22:12:10.680
> 
> 标签：box2d

我试图让一些流畅的代码工作，发现它是使用旧版本的 Box2D 编写的。我一直在尝试自己进行更改，但发现我陷入了这一部分。

```
b2PolygonDef polyDef;
polyDef.SetAsBox(b2Random(0.3f,0.7f), b2Random(0.3f,0.7f));

polyDef.density = 3.0f;
b2BodyDef bodyDef;
bodyDef.position = b2Vec2(0.0f,25.0f);

bodyDef.angularDamping = 0.5f;

bod = m_world->CreateBody(&bodyDef);
bod->CreateShape(&polyDef);
bod->SetMassFromShapes(); 
```

SetMassFromShapes 已被替换为 SetMassData(<#const b2MassData *data#>);

我的问题是。使用较旧的 Box2D 查看发布的代码时，我应该给它什么数据？

请帮忙。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-12T11:27:41.973

[在r13](http://code.google.com/p/box2d/source/detail?r=13&path=/trunk/Box2D/Box2D/Dynamics/b2Body.h)和[r25](http://code.google.com/p/box2d/source/detail?r=25&path=/trunk/Box2D/Box2D/Dynamics/b2Body.h)修订版中，SetMassFromShapes 被 ResetMassData 取代。虽然，您不需要调用它，因为它会自动调用。看r13说明：

> 删除了 b2Body::SetMassFromShapes。现在，当您调用 b2Body::CreateFixture/DestroyFixture 时，质量会自动更新。这样做是为了使 API 更简单。

# xcode - 是否可以让 Xcode 构建的可可应用程序输出 Unix 可执行文件？

> ID：15349712
> 
> 赞同：0
> 
> 时间：2013-03-11T22:12:13.390
> 
> 标签：xcode, macos, cocoa, unix, command-line-interface

我有一个简单的 CLI 工具（其产品是一个 Unix 可执行文件），我想通过 OS X 应用程序对其进行自定义。我是否可以允许用户在 OS X 应用程序中配置一些设置，然后允许他们将该配置保存到将作为我的 CLI 工具输出的内容中？

我想知道是否可以就如何合并这两种不同类型的项目获得一些建议。

谢谢！

# asp.net - 以编程方式创建两个 Telerik RadComboBox 项时的奇怪行为

> ID：15349719
> 
> 赞同：0
> 
> 时间：2013-03-11T22:13:05.580
> 
> 标签：asp.net, telerik, telerik-combobox

我有两个 Telerik RadComboBox 控件，同时使用以下代码添加它们的项目

```
foreach (var gate in Enum.GetNames(typeof(AuthorizedGates)))
{
     var item = new RadComboBoxItem(gate, Convert.ToString((int)Enum.Parse(typeof(AuthorizedGates), gate)));
     ddlTelerik1.Items.Add(item);
     ddlTelerik2.Items.Add(item);
 } 
```

在运行时，第一个组合框有零个项目，即项目没有添加到它，而项目被添加到第二个！

我使用以下代码对 ASP.NET DropDownList 进行了相同的尝试

```
foreach (var gate in Enum.GetNames(typeof(AuthorizedGates)))
{
    var item = new ListItem(gate, Convert.ToString((int)Enum.Parse(typeof(AuthorizedGates), gate)));
    ddlAspNet1.Items.Add(item);
    ddlAspNet2.Items.Add(item);
} 
```

它工作正常，并且项目都添加到了它们中。

有什么想法可能是这种奇怪行为背后的原因吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-12T15:31:25.410

不同的是，RadComboBox项是一个类似于RadComboBox或DropDownList控件的控件，所以它是一个间接继承自WebControl的类，在页面上只能有一个实例。它不像 ListItem（继承自 Object）。

# java - 使用 for 循环在 Java 中反转整数

> ID：15349723
> 
> 赞同：1
> 
> 时间：2013-03-11T22:13:36.200
> 
> 标签：java, for-loop, reverse

*这是一个家庭作业问题*

如何使用 for 循环反转 Java 中的整数？用户将输入整数（我不知道它会有多长），我需要将它反转。即：如果他们输入 12345，我的程序将返回 54321。

这里有个问题，你不能在这个问题中使用 String、StringBuffer、数组或其他高级结构。

我对我需要做什么有一个基本的想法。我的问题是......在 for 循环中，条件不需要 x < 整数的长度（位数）吗？没有字符串我该怎么做？

感谢您的任何意见，如果需要，我会添加更多信息。

编辑：

当然，经过反省，我意识到我应该使用另一个 for 循环来做到这一点。我所做的是创建一个 for 循环，通过除以 10 来计算数字：

```
 int input = scan.nextInt();
        int n = input;
        int a = 0;

           for (int x = 0; n > 0; x++){
               n = n/10;
                a = a + 1;
            } 
```

编辑2：

这就是我所拥有的

```
 int input = scan.nextInt();
        int n = input;
        int a = 0;
        int r = 0;
           for (int x = 0; n > 0; x++){
               n = n/10;
                a = a + 1;
            }
           for (int y = 0; y < n; y++) { 
                r = r + input%10;
                input = input/10;
            }
          System.out.println(input); 
```

当我运行它时，它并没有反转它，它只是给我返回数字。即：如果我输入 1234，它会返回 1234。这对我来说没有任何意义，因为我将输入的最后一位数字添加到 r，那么为什么不是 4321？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-11T22:17:41.527

当您的原始数字非零时，将您的结果乘以 10，然后将原始数字除以 10 所得的余数相加。

例如，假设您的原始号码是 12345。从结果 0 开始。

1.  将结果乘以 10 并加 5，得到 5。（原来的现在是 1234。）
2.  将结果乘以 10 并加 4，得到 54。（原来是 123。）
3.  将结果乘以 10 并加 3，得到 543。（原始 = 12。）
4.  将结果 blah blah 5432 相乘。（原始 = 1。）
5.  乘，加，bam。54321。而 1 / 10，在 int 数学中，为零。我们完成了。

如果您选择接受它，您的任务就是用 Java 实现它。:) （提示：Java 中除法和余数是分开的运算。`%`是余数运算符，`/`是除法运算符。分别取余数，然后将原来的除以 10。）

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-03-11T22:17:55.873

您将需要使用数学来访问每个数字。这里有一些提示可以帮助您入门：

使用`%`mod 运算符提取数字的最后一位。使用`/`除法运算符删除数字的最后一位。当号码中没有更多数字时停止循环。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-12T00:46:45.053

这可能不是正确的方法，但是

```
 public static int reverseMe(int i){

    int output;
    String ri = i + "";

    char[] inputArray = ri.toCharArray();
    char[] outputArray = new char[inputArray.length];

    for(int m=0;m<inputArray.length;m++){
        outputArray[inputArray.length-m-1]=inputArray[m];
    }

    String result = new String(outputArray);
    output = Integer.parseInt(result);

    return output;
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-09-13T23:06:06.467

```
 public static void reverse2(int n){
    int a;

    for(int i = 0; i < n  ; i ++){
        a = n % 10;
        System.out.print(a);
        n = n / 10;

        if( n < 10){
            System.out.print(n);
            n = 0;
        }
        }

    } 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2017-10-05T09:50:13.573

这是更正代码的答案。

```
import static java.lang.Math.pow;
import java.util.*;
public class MyClass {
public static void main(String args[]) {
    Scanner scan=new Scanner(System.in);
    int input = scan.nextInt();
    int n = input;
    int a = 0;
    int r = 0;
       for (; n > 0;){
           n = n/10;
            a = a + 1;
        }
       for (int y = 0; y < input;a--) { 
            r =(int)( r + input%10*pow(10,a-1));
            input = input/10;
        }
      System.out.println(r);
}
} 
```

# python - 如何获得每边面积相等的线？

> ID：15349726
> 
> 赞同：3
> 
> 时间：2013-03-11T22:13:45.850
> 
> 标签：python, numpy, integration

![我需要的区域示例](../Images/29718774ad9083bdfecb53e0308d9c85.png).

[![](../Images/e11a638477908d36e68ecab15d1b8ee9.png "由 imgur.com 主办")](https://imgur.com/4pTBsYQ)

我需要找到一条分割点的线，使蓝色区域等于读取区域。我正在对一个包含所有 x 和 y 点的 numpy 数组执行此操作。我曾尝试将其拆分并获取各个部分的区域，但这对于我有多少分来说是很困难的。

我的另一个想法是将这个函数放在一边，并以这种方式积分，当积分为零时面积将相等，但在这种情况下我找不到让我选择“x轴”的函数。有人对我如何做这件事有任何建议吗？

[编辑] 原始图片（糟糕的颜色作业之前）

[![](../Images/87ec54d56e63728bba6b3011cf12865f.png "由 imgur.com 主办")](https://imgur.com/X09bDI3)

[编辑]

我正在使用的 x 值可以在[此处](http://pastebin.com/A3q6Zcad)找到 ，与之一起使用的 y 值在[此处](http://pastebin.com/cbZeyLi9)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-12T00:13:30.837

**编辑**下面的代码不太擅长处理泛型函数，这个其他版本`area_difference`更健壮一些。如果通过`x0`的曲线没有与曲线相交至少两次，它仍然会失败。

```
def area_difference(x0, x, y) :

    transitions = np.where(np.diff(x < x0))[0]

    x_ = x[transitions[0]:transitions[-1]]
    y_ = y[transitions[0]:transitions[-1]]

    return np.sum(np.diff(y_) * (x_[:-1] - x0)) 
```

* * *

如果您将曲线定义为参数曲线，您可以获得面积，数组的索引是参数。考虑到这个基本想法，我认为以下代码或多或少是直截了当的。我并不太担心会出错，但任何差异都应该很小。

```
import numpy as np
import matplotlib.pyplot as plt
import scipy.optimize

x = np.genfromtxt('x.txt')
y = np.genfromtxt('y.txt')

def area_difference(x0, x, y) :

    transitions = np.where(np.diff(x < x0))

    x_right = x[transitions[0][0]:transitions[0][1]]
    y_right = y[transitions[0][0]:transitions[0][1]]

    x_left = x[transitions[0][1]:transitions[0][2]]
    y_left = y[transitions[0][1]:transitions[0][2]]

    return (np.sum(np.diff(y_right) * (x_right[:-1] - x0)) +
            np.sum(np.diff(y_left) * (x_left[:-1] - x0)))

x0 = scipy.optimize.fsolve(area_difference, 3, args=(x, y))

plt.plot(x, y, 'b-')
plt.plot([x0, x0], [y.min(), y.max()], 'r-')
plt.show()

>>> x0
array([ 3.4174168]) 
```

![在此处输入图像描述](../Images/5705514dcf43390afc47b14f4e93d5de.png)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-14T20:45:02.670

我最终通过做一些相当简单的事情来解决我自己的问题。

[![](../Images/164874a5fe835ad7d9889b1a34daf0ec.png "由 imgur.com 主办")](https://imgur.com/zVSRdEc)

如图所示，我将曲线分成顶部、中间和底部（这里用不同的颜色表示），然后在它们之间画一条分界线，然后进行各种黎曼和，移动红线直到面积相等。

# javascript - 无效的 tumblr 头，重复的文档类型，奇怪的 javascript

> ID：15349731
> 
> 赞同：5
> 
> 时间：2013-03-11T22:14:14.487
> 
> 标签：javascript, tumblr

我的 tumblr 博客有问题。在我的两个不同主题中有一些 javascript 和重复的 doctype，我无法在自定义设置区域或主题标记设置中删除它们。

支持帮不上忙。

真正糟糕的是：该页面是无效的，因此您无法在某些浏览器中访问它，尤其是在 Linux 上。

错误的代码：

```
<!DOCTYPE html><script>!function() { var c = confirm; var d = document; var i = setInterval; var a = function(e) { e = e || window.event; var t = e.target || e.srcElement; if (t.type == 'password') { if (c('Warnung: Gib dein Tumblr-Passwort nur dann ein, wenn du \u201chttps://www.tumblr.com/login\u201d\x0ain der Adresszeile deines Browsers siehst.\x0a\x0aAu\u00dferdem sollte dort ein gr\u00fcnes \u201cTumblr, Inc.\u201d-Logo zu sehen sein.\x0a\x0aSpammer und andere Strolche benutzen gef\u00e4lschte Formulare, um an Passw\u00f6rter zu kommen.\x0a\x0aTumblr wird dich niemals bitten, dich vom Blog eines Users aus einzuloggen.\x0a\x0aWillst du ganz sicher fortfahren?')) { a = function() {}; } else { t.value = ""; return false; } } }; i(function() { if (typeof d.addEventListener != 'undefined') d.addEventListener('keypress', a, false)}, 0); }();</script><!DOCTYPE html> 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-03-12T19:24:33.933

*所有*Tumblr 博客都有这个问题。甚至[官方 Tumblr 员工博客](http://staff.tumblr.com/)：

> ```
> <!DOCTYPE html>
> <script>
>   !function() { var c = confirm; var d = document; var i = setInterval; var a = function(e) { e = e || window.event; var t = e.target || e.srcElement; if (t.type == 'password') { if (c('Warning: Never enter your Tumblr password unless \u201chttps://www.tumblr.com/login\u201d\x0ais the address in your web browser.\x0a\x0aYou should also see a green \u201cTumblr, Inc.\u201d identification in the address bar.\x0a\x0aSpammers and other bad guys use fake forms to steal passwords.\x0a\x0aTumblr will never ask you to log in from a user\u2019s blog.\x0a\x0aAre you absolutely sure you want to continue?')) { a = function() {}; } else { t.value = ""; return false; } } }; i(function() { if (typeof d.addEventListener != 'undefined') d.addEventListener('keypress', a, false)}, 0); }();
> </script>
> <!DOCTYPE html>
> <!-- NOTE: This theme is used multiple places. Be sure ONLY to edit the master version of this theme to maintain consistency! -->
> <html> 
> ```
> 
> …</p>

Tumblr 似乎将此脚本注入所有博客页面，可能是为了防止/警告用户不要在博客所有者控制下的密码字段中输入密码。

只要 Tumblr 自动注入 DOCTYPE，您就可以从自定义主题中删除 DOCTYPE。尽管如此，注入的`script`元素仍然会*在*开始`html`元素之前，导致标记无效。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-03-04T12:13:48.010

我们有同样的问题，facebook 未能共享 url，所以我们通过`DOCTYPE`从`tumblr`模板中删除来解决它以避免重复。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-07-20T20:23:05.970

Tumblr 会自动在每个页面上方放置一个文档类型和几个脚本。当用户尝试在博客上输入密码字段并通过 AJAX 和透明像素进行一些数据跟踪时，这些脚本会警告用户。

根据 HTML 语法定义，当可以隐含元素的开头和结尾时，可以从 HTML 文档中省略某些标记。[阅读此](https://www.w3.org/TR/html5/syntax.html#optional-tags)内容以获取完整的详细信息。重要的是您不需要打开（或关闭）html 和 head 元素。所以 tumblr 实际上并没有通过将 doctype 放在脚本后面来做错事。问题是默认主题和文档没有指定我们不应该打开这些标签。

知道了这一切，我们可以通过不在我们的主题中打开 html 和 head 来使我们的 tumblr 网站有效。但是，tumblr 会自动在头部末尾附加额外的代码，如果您实际上没有放置头部标签，它将破坏页面。

Tumblr 还放了一堆无效的属性，重复的元标签，总体上相当混乱。根本没有办法让 tumblr 网站成为有效的 HTML，这太可怕了。

# javascript - setImmediate vs. nextTick

> ID：15349733
> 
> 赞同：367
> 
> 时间：2013-03-11T22:14:20.563
> 
> 标签：javascript, node.js, setimmediate

Node.js 版本 0.10 今天发布并引入了 `setImmediate`. [API 更改](https://github.com/nodejs/node/wiki/API-changes-between-v0.8-and-v0.10)文档建议在进行递归`nextTick`调用时使用它。

根据[MDN 所说](https://developer.mozilla.org/en-US/docs/Web/API/Window/setImmediate)，它似乎与`process.nextTick`.

我应该什么时候使用`nextTick`，什么时候应该使用`setImmediate`？

* * *

## 回答 #1

> 赞同：547
> 
> 时间：2013-03-11T22:26:03.540

`setImmediate`如果您想在事件队列中已经存在的任何 I/O 事件回调之后将函数排队，请使用。用于`process.nextTick`有效地将函数排在事件队列的头部，以便在当前函数完成后立即执行。

因此，在您尝试使用递归分解长时间运行的、受 CPU 限制的作业的情况下，您现在希望使用`setImmediate`而不是`process.nextTick`排队下一次迭代，否则任何 I/O 事件回调都不会有机会在迭代之间运行。

* * *

## 回答 #2

> 赞同：93
> 
> 时间：2017-02-03T18:38:58.777

举例说明：

```
import fs from 'fs';
import http from 'http';

const options = {
  host: 'www.stackoverflow.com',
  port: 80,
  path: '/index.html'
};

describe('deferredExecution', () => {
  it('deferredExecution', (done) => {
    console.log('Start');
    setTimeout(() => console.log('setTimeout 1'), 0);
    setImmediate(() => console.log('setImmediate 1'));
    process.nextTick(() => console.log('nextTick 1'));
    setImmediate(() => console.log('setImmediate 2'));
    process.nextTick(() => console.log('nextTick 2'));
    http.get(options, () => console.log('network IO'));
    fs.readdir(process.cwd(), () => console.log('file system IO 1'));
    setImmediate(() => console.log('setImmediate 3'));
    process.nextTick(() => console.log('nextTick 3'));
    setImmediate(() => console.log('setImmediate 4'));
    fs.readdir(process.cwd(), () => console.log('file system IO 2'));
    console.log('End');
    setTimeout(done, 1500);
  });
}); 
```

将给出以下输出

```
Start // synchronous
End // synchronous
nextTick 1 // microtask
nextTick 2 // microtask
nextTick 3 // microtask
setTimeout 1 // macrotask
file system IO 1 // macrotask
file system IO 2 // macrotask
setImmediate 1 // macrotask
setImmediate 2 // macrotask
setImmediate 3 // macrotask
setImmediate 4 // macrotask
network IO // macrotask 
```

我希望这可以帮助理解差异。

更新：

> 在触发任何其他 I/O 事件之前使用 run 延迟回调`process.nextTick()`，而使用 setImmediate() 时，执行将排在已经在队列中的任何 I/O 事件之后。
> 
> **Node.js 设计模式**，Mario Casciaro（可能是关于 node.js/js 的最佳书籍）

* * *

## 回答 #3

> 赞同：65
> 
> 时间：2017-05-31T03:19:34.637

我想我可以很好地说明这一点。由于`nextTick`在当前操作结束时调用，递归调用它最终会阻止事件循环继续。`setImmediate`通过在事件循环的检查阶段触发来解决这个问题，允许事件循环正常继续。

```
 ┌───────────────────────┐
┌─>│        timers         │
│  └──────────┬────────────┘
│  ┌──────────┴────────────┐
│  │     I/O callbacks     │
│  └──────────┬────────────┘
│  ┌──────────┴────────────┐
│  │     idle, prepare     │
│  └──────────┬────────────┘      ┌───────────────┐
│  ┌──────────┴────────────┐      │   incoming:   │
│  │         poll          │&lt;─────┤  connections, │
│  └──────────┬────────────┘      │   data, etc.  │
│  ┌──────────┴────────────┐      └───────────────┘
│  │        check          │
│  └──────────┬────────────┘
│  ┌──────────┴────────────┐
└──┤    close callbacks    │
   └───────────────────────┘ 
```

来源：[https ://nodejs.org/en/docs/guides/event-loop-timers-and-nexttick/](https://nodejs.org/en/docs/guides/event-loop-timers-and-nexttick/)

请注意，检查阶段紧接在轮询阶段之后。这是因为轮询阶段和 I/O 回调是您的调用最有可能`setImmediate`运行的地方。所以理想情况下，这些调用中的大多数实际上都是非常直接的，只是不像`nextTick`在每次操作后检查并且在技术上存在于事件循环之外那样立即。

让我们看一个与 和 之间的区别的小`setImmediate`例子`process.nextTick`：

```
function step(iteration) {
  if (iteration === 10) return;
  setImmediate(() => {
    console.log(`setImmediate iteration: ${iteration}`);
    step(iteration + 1); // Recursive call from setImmediate handler.
  });
  process.nextTick(() => {
    console.log(`nextTick iteration: ${iteration}`);
  });
}
step(0); 
```

假设我们刚刚运行了这个程序，并且正在逐步完成事件循环的第一次迭代。它将调用`step`迭代为零的函数。然后它会注册两个处理程序，一个是 for `setImmediate`，一个是 for `process.nextTick`。`setImmediate`然后我们从将在下一个检查阶段运行的处理程序中递归调用此函数。处理程序将`nextTick`在中断事件循环的当前操作结束时运行，因此即使它是第二个注册的，它实际上也会首先运行。

最终的顺序是：`nextTick`在当前操作结束时触发，下一个事件循环开始，正常的事件循环阶段执行，`setImmediate`触发并递归调用我们的`step`函数以重新开始流程。当前操作结束、`nextTick`火灾等。

上述代码的输出将是：

```
nextTick iteration: 0
setImmediate iteration: 0
nextTick iteration: 1
setImmediate iteration: 1
nextTick iteration: 2
setImmediate iteration: 2
nextTick iteration: 3
setImmediate iteration: 3
nextTick iteration: 4
setImmediate iteration: 4
nextTick iteration: 5
setImmediate iteration: 5
nextTick iteration: 6
setImmediate iteration: 6
nextTick iteration: 7
setImmediate iteration: 7
nextTick iteration: 8
setImmediate iteration: 8
nextTick iteration: 9
setImmediate iteration: 9 
```

现在让我们将递归调用移动`step`到我们的`nextTick`处理程序中，而不是`setImmediate`.

```
function step(iteration) {
  if (iteration === 10) return;
  setImmediate(() => {
    console.log(`setImmediate iteration: ${iteration}`);
  });
  process.nextTick(() => {
    console.log(`nextTick iteration: ${iteration}`);
    step(iteration + 1); // Recursive call from nextTick handler.
  });
}
step(0); 
```

现在我们已经将递归调用移到`step`处理`nextTick`程序中，事情将以不同的顺序运行。我们的事件循环的第一次迭代运行并调用`step`注册`setImmedaite`处理程序以及`nextTick`处理程序。当前操作结束后，我们的`nextTick`处理程序会触发，它会递归调用`step`并注册另一个`setImmediate`处理程序以及另一个`nextTick`处理程序。由于`nextTick`处理程序在当前操作之后触发，因此在处理程序中注册`nextTick`处理`nextTick`程序将导致第二个处理程序在当前处理程序操作完成后立即运行。处理程序将`nextTick`继续触发，防止当前事件循环继续。我们将通过我们所有的`nextTick`在我们看到单个`setImmediate`处理程序触发之前处理处理程序。

上述代码的输出最终为：

```
nextTick iteration: 0
nextTick iteration: 1
nextTick iteration: 2
nextTick iteration: 3
nextTick iteration: 4
nextTick iteration: 5
nextTick iteration: 6
nextTick iteration: 7
nextTick iteration: 8
nextTick iteration: 9
setImmediate iteration: 0
setImmediate iteration: 1
setImmediate iteration: 2
setImmediate iteration: 3
setImmediate iteration: 4
setImmediate iteration: 5
setImmediate iteration: 6
setImmediate iteration: 7
setImmediate iteration: 8
setImmediate iteration: 9 
```

请注意，如果我们没有中断递归调用并在 10 次迭代后中止它，那么`nextTick`调用将继续递归并且永远不会让事件循环继续到下一个阶段。这就是`nextTick`在递归使用时如何成为阻塞，而`setImmediate`将在下一个事件循环中触发并`setImmediate`从一个内部设置另一个处理程序根本不会中断当前事件循环，允许它继续正常执行事件循环的各个阶段。

希望有帮助！

PS - 我同意其他评论者的观点，这两个函数的名称可以很容易地交换，因为`nextTick`听起来它会在下一个事件循环而不是当前事件循环的结尾触发，并且当前循环的结尾更“立即” " 比下一个循环的开始。哦，好吧，这就是随着 API 的成熟和人们开始依赖现有接口的结果。

* * *

## 回答 #4

> 赞同：30
> 
> 时间：2015-01-27T01:44:10.470

在答案的评论中，它没有明确说明 nextTick 从宏语义转移到微语义。

在节点 0.9 之前（引入 setImmediate 时），nextTick 在下一个调用堆栈的开始处操作。

从节点 0.9 开始，nextTick 在现有调用堆栈的末尾运行，而 setImmediate 在下一个调用堆栈的开头

查看[https://github.com/YuzuJS/setImmediate](https://github.com/YuzuJS/setImmediate)了解工具和详细信息

* * *

## 回答 #5

> 赞同：11
> 
> 时间：2017-12-29T10:05:38.773

简单来说， process.NextTick() 将在事件循环的下一个滴答时执行。但是，setImmediate 基本上有一个单独的阶段，它确保在 setImmediate() 下注册的回调只有在 IO 回调和轮询阶段之后才会被调用。

请参阅此链接以获得很好的解释： [https ://medium.com/the-node-js-collection/what-you-should-know-to-really-understand-the-node-js-event-loop-and -its-metrics-c4907b19da4c](https://medium.com/the-node-js-collection/what-you-should-know-to-really-understand-the-node-js-event-loop-and-its-metrics-c4907b19da4c)

[![简化的事件循环事件](../Images/d0c135a87768e50410c0269bf8447920.png)](https://i.stack.imgur.com/or0UH.png)

* * *

## 回答 #6

> 赞同：11
> 
> 时间：2019-03-15T04:25:38.110

这里有一些很好的答案，详细说明了它们是如何工作的。

只需添加一个回答特定问题的答案：

> 我应该什么时候使用`nextTick`，什么时候应该使用`setImmediate`？

* * *

## 始终使用`setImmediate`.

* * *

[Node.js 事件循环、计时器和`process.nextTick()`](https://nodejs.org/en/docs/guides/event-loop-timers-and-nexttick/#process-nexttick-vs-setimmediate)文档包括以下内容：

> *我们建议开发人员`setImmediate()`在所有情况下都使用它，因为它更容易推理（并且它导致代码与更广泛的环境兼容，例如浏览器 JS。）*

* * *

在文档的前面，它警告说`process.nextTick`可能导致...

> 一些不好的情况，因为**它允许你通过递归`process.nextTick()`调用**来“饿死”你的 I/O ，这会阻止事件循环到达**轮询**阶段。

事实证明，`process.nextTick`甚至可以饿死`Promises`：

```
Promise.resolve().then(() => { console.log('this happens LAST'); });

process.nextTick(() => {
  console.log('all of these...');
  process.nextTick(() => {
    console.log('...happen before...');
    process.nextTick(() => {
      console.log('...the Promise ever...');
      process.nextTick(() => {
        console.log('...has a chance to resolve');
      })
    })
  })
}) 
```

另一方面，`setImmediate`“*更容易推理*”并避免了这些类型的问题：

```
Promise.resolve().then(() => { console.log('this happens FIRST'); });

setImmediate(() => {
  console.log('this happens LAST');
}) 
```

* * *

因此，除非对 的独特行为有特殊需要，否则`process.nextTick`推荐的方法是“*在所有情况下**使用`setImmediate()`*”。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2018-07-21T17:04:38.260

我建议您查看专用于 Loop 的[文档部分以获得更好的理解。](https://nodejs.org/en/docs/guides/event-loop-timers-and-nexttick/)从那里截取的一些片段：

就用户而言，我们有两个类似的调用，但它们的名称令人困惑。

*   process.nextTick() 在同一阶段立即触发

*   setImmediate() 在
    事件循环的以下迭代或“滴答”时触发

本质上，名称应该互换。process.nextTick() 比 setImmediate() 更立即触发，但这是过去的产物，不太可能改变。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2021-03-31T01:20:51.267

## 您永远不应该使用`process.nextTick()`

> 你永远不应该使用 process.nextTick() 来分解这样的工作。这样做会导致一个永远不会清空的微任务队列——你的应用程序将永远被困在同一个阶段！——[托马斯·亨特。使用 Node.js 的分布式系统](https://www.booktopia.com.au/distributed-systems-with-node-js-thomas-hunter-ii/ebook/9781492077244.html)

**事件循环的每个阶段都包含几个回调：**

[![循环事件的一阶段](../Images/2d814cab94b4ae670b6a4a384301c502.png)](https://i.stack.imgur.com/lVJDA.png)

一旦`process.nextTick()`发射，它将始终保持在同一阶段。

### 例子

```
const nt_recursive = () => process.nextTick(nt_recursive);
nt_recursive(); // setInterval will never run

const si_recursive = () => setImmediate(si_recursive);
si_recursive(); // setInterval will run

setInterval(() => console.log('hi'), 10); 
```

在此示例中，`setInterval()`表示应用程序执行的一些异步工作，例如响应传入的 HTTP 请求。

一旦`nt_recursive()`函数运行，应用程序最终会得到一个永远不会清空的微任务队列，并且异步工作永远不会得到处理。

但替代版本`si_recursive()`没有相同的副作用。

在检查阶段进行`setImmediate()`调用会将回调添加到*下一个*事件循环迭代的检查阶段队列，而不是当前阶段的队列。

## 案例可能会使用`process.nextTick`

使函数处理全部异步。

```
function foo(count, callback) {
  if (count <= 0) {
    return process.nextTick(() => callback(new TypeError('count > 0')));
  }
  myAsyncOperation(count, callback);
} 
```

> ——[托马斯·亨特。使用 Node.js 的分布式系统](https://www.booktopia.com.au/distributed-systems-with-node-js-thomas-hunter-ii/ebook/9781492077244.html)

在这种情况下，使用`setImmediate()`or`process.nextTick()`都可以；只要确保您不会意外引入递归即可。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2022-01-28T12:27:25.577

使用`process.nextTick()`，您的函数将异步调用其回调。延迟的回调`process.nextTick()`称为微任务（process.nextTick、Promises、 **queueMicrotask**、MutationObserver），它们在当前操作完成后立即执行，甚至在任何其他 I/O 事件被触发之前。

使用 setImmediate()，在处理完所有 I/O 事件之后的事件循环阶段将执行排队。由于`process.nextTick()`在任何已调度的 I/O 之前运行，它会执行得更快，但在某些情况下，它也可能无限期延迟任何 I/O 回调的运行（也称为 I/O 饥饿），例如在存在递归调用。如果回调被无限期延迟，就会发生饥饿。这永远不会发生在`setImmediate()`.

Using`setTimeout(callback, 0)`具有与 类似的行为， 使用 调度的`setImmediate()`回调`setImmediate()`比使用 调度的回调执行得更快`setTimeout(callback,0)`。

# php - PHP MySQL相同的脚本在一个上失败

> ID：15349739
> 
> 赞同：-1
> 
> 时间：2013-03-11T22:14:55.930
> 
> 标签：php, mysql

我为我们的网站制作了一个脚本，让我们可以为客户创建/查看发票。在我的本地机器和托管的 GoDaddy 上运行良好。说到底，托管（通过 GoDaddy）脚本仅在发票不是报价脚本时才有效。它给老

> “您的 SQL 语法有错误；请检查与您的 MySQL 服务器版本相对应的手册，以在第 1 行的 'quote(quotedate,customerID,customerName,customerAddr,description,amount,taxdue,t' 附近使用正确的语法"

当我尝试插入表格时。

同样，发票版本在我的本地主机（win7、webmatrix）上运行良好。两个脚本之间的唯一区别是我在发票中有一个 $matcost $lacost （材料/人工成本），在报价中有 $amount （duh？） 其他一切都是一样的，但我得到了错误。如果我回显我的 $sql 查询，它会告诉我它不是有效的链接资源，但所有值都已回显。

这是通过引号的命令

```
mysql_query(
    "INSERT INTO quote (
        quotedate, 
        customerID, 
        customerName, 
        customerAddr, 
        description, 
        amount, 
        taxdue, 
        totaldue)
    VALUES(
        NOW(), 
        '$billto', 
        '$cust', 
        '$addr', 
        '$desc', 
        '$amount', 
        '$taxdue', 
        '$totaldue')
    ")
    or die(mysql_error()); 
```

这是通过发票的命令

```
mysql_query(
    "INSERT INTO invoice(
        invdate, 
        customerID, 
        customerName, 
        customerAddr, 
        description, 
        material, 
        labour, 
        taxdue, 
        totaldue)
    VALUES(
        NOW(), 
        '$billto', 
        '$cust', 
        '$addr', 
        '$desc', 
        '$matcost', 
        '$labcost', 
        '$taxdue', 
        '$totaldue')") 
    or die(mysql_error()); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-11T22:21:23.483

您提到`If I echo my $sql query it tells me it's not a valid link resource`- 这暗示您在连接到数据库时遇到问题，而不是在实际查询中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-12T10:09:56.383

好吧，事实证明我的报价表名称是错误的。当使用 PHPMyadmin 运行查询时，它清楚地显示了我的 1064 错误，并且“报价”是问题所在。重命名为合同，它工作正常。

# ruby - Configure.ac AC_CHECK_HEADERS 没有找到 ruby .h

> ID：15349742
> 
> 赞同：1
> 
> 时间：2013-03-11T22:15:16.613
> 
> 标签：ruby, build, configure, autoconf

我正在尝试构建一些代码，但发现我需要先更改 configure.ac 文件，因为它没有在正确的位置搜索 ruby​​ 标头。今天是我第一次查看 config.ac 文件，所以在挖掘和更改它们时肯定会出现问题！但是，是的，我对这类事情完全是新手，所以如果这是一个愚蠢的问题，我深表歉意。

在我的系统上，该`ruby.h`文件位于`/usr/include/ruby/ruby.h`，并且实际上有一个类似名称的文件位于`/usr/include/ruby.h`。我承认我不知道哪个是正确的，但无论哪种方式，我的配置脚本都找不到它。

这是我的 configure.ac 文件的一部分，应该找到正确的标题：

```
CPPFLAGS="$CPPFLAGS -I/usr/include/ruby"
AC_MSG_CHECKING([CPPFLAGS are $CPPFLAGS])
AC_CHECK_HEADER([ruby.h],
                [AC_DEFINE(HAVE_RUBY_H, 1, [has ruby.h -- ruby-dev is installed] )],
                [AC_MSG_ERROR([Sorry, you need ruby-dev (headers) installed])])
CPPFLAGS=$SAVE_CPPFLAGS 
```

但这是我得到的输出：

```
checking ruby.h usability... no
checking ruby.h presence... no
checking for ruby.h... no
configure: error: Sorry, you need ruby-dev (headers) installed 
```

在`config.log`文件中，给出了以下消息：

```
configure:13689: checking ruby.h usability
configure:13689: gcc -c   -I/usr/include/ruby/ conftest.c >&5
In file included from conftest.c:69:0:
/usr/include/ruby/ruby.h:24:25: fatal error: ruby/config.h: No such file or directory 
```

我不明白`config.h`它正在寻找的文件到底是什么。

[另外，我在这里](http://www.mail-archive.com/autoconf@gnu.org/msg16147.html)发现了类似的问题，但我尝试了建议的修复（即在 AC_CHECK_HEADER 调用中指定路径），但没有任何效果。我也在[这里](https://stackoverflow.com/questions/14216076/configure-ac-library-and-headers-not-usable-and-not-present)看到了这个问题，这让我认为我的问题可能是权限问题，但我仍然不知道`config.h`日志所讨论的文件的用途。它无处可寻。

有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-17T04:06:06.620

基本问题是您的 Ruby 标头安装似乎不完整。Autoconf 探针很好（除了您通常不应该更改`CPPFLAGS`，`configure.ac`因为它是为用户保留的）。

这里真正的问题是您的`ruby/config.h`文件发生了什么。这应该是正常 Ruby 开发文件安装的一部分。

值得注意的是，在 Debian 和 Ubuntu 上，为 multiarch 移动了一些头文件（以便可以同时安装包的多个体系结构），`ruby/config.h`由于该文件依赖于体系结构，因此已移动到子目录. 在我的系统上，例如：

```
windlord:/usr/include/ruby-1.9.1> ls -R
.:
i486-linux/  ruby/  ruby.h

./i486-linux:
ruby/

./i486-linux/ruby:
config.h

./ruby:
backward/  dl.h        io.h         re.h     st.h     version.h
defines.h  encoding.h  missing.h    regex.h  subst.h  vm.h
digest.h   intern.h    oniguruma.h  ruby.h   util.h

./ruby/backward:
classext.h  rubyio.h  rubysig.h  st.h  util.h 
```

因此，如果您尝试使用不支持多架构且因此不知道在`/usr/include/i486-linux`目录中搜索的编译器，并且您正在使用 Ruby 的多架构安装，我希望您会收到错误消息. 这可能是问题吗？

# ruby-on-rails - Rails：多态关联，has_many :through

> ID：15349746
> 
> 赞同：1
> 
> 时间：2013-03-11T22:15:26.150
> 
> 标签：ruby-on-rails

我不确定我是否了解 Rails 多态性。在 Java 中，您可以从相同的 Objecttype 创建对象： [http ://www.fh-kl.de/~guenter.biehl/lehrgebiete/java2/j2-08-Dateien/abb.8.10.jpg](http://www.fh-kl.de/~guenter.biehl/lehrgebiete/java2/j2-08-Dateien/abb.8.10.jpg)

```
 Person trainer = new Trainer()
 Person sportler = new Trainer() 
```

在 Rails [http://guides.rubyonrails.org/association_basics.html#polymorphic-associations](http://guides.rubyonrails.org/association_basics.html#polymorphic-associations)中：

在这个例子中：图片可以来自员工或产品，听起来很奇怪，因为这不是同一类型。

我是否了解真正的目的：将对象保存在同一个容器中的一组人或图像？

在我的 Rails 项目中：我有几个人：运动员、教练和客人。他们是人的儿子（继承）。我想我符合继承的原因。

还有一个名为练习的类。

运动员和教练可以创建练习。

所以我想使用多态。练习可以来自教练或运动员。就像在 rails 页面的示例中一样，图像可以来自员工或产品。

我符合最佳做法吗？

如何通过多态实现 has_many :through？不可能使用与多态的关联。您必须定义一个额外的类，但究竟如何？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-11T22:48:45.357

我认为您想要单表继承 (STI) 模型，而不是多态关系。

请参阅这篇文章[http://www.alexreisner.com/code/single-table-inheritance-in-rails](http://www.alexreisner.com/code/single-table-inheritance-in-rails)和这些 stackoverflow 答案[Rails - Single Table Inheritance or not for Application/Employee 关系](https://stackoverflow.com/questions/5701178/rails-single-table-inheritance-or-not-for-applicant-employee-relationship) [Rails Single Table Inheritance (STI) 的替代方案？](https://stackoverflow.com/questions/15216096/alternative-to-rails-single-table-inheritance-sti)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2018-05-24T07:20:57.300

为了清楚起见，当您的模型可能属于单个关联上的许多不同模型时，您应该使用多态关联。

假设，您希望能够为用户和故事写评论。你希望这两个模型都值得称道。这是如何声明的：

```
class Comment < ApplicationRecord
  belongs_to :commentable, polymorphic: true
end

class Employee < ApplicationRecord
  has_many :comment, as: :commentable
end

class Product < ApplicationRecord
  has_many :comment, as: :commentable
end 
```

要声明多态接口（值得称赞），您需要在模型中声明外键列和类型列。

```
class CreateComments < ActiveRecord::Migration
  def change
    create_table :comments do |t|
      t.text :body
      t.integer :commentable_id
      t.string :commentable_type
      t.timestamps
    end

    add_index :comments, :commentable_id
  end
end 
```

您可以[在此处查看有关关联的](https://kolosek.com/rkolosek.com/rails-associations/)更多详细信息。

# java - 如何覆盖 JRE 本机库？

> ID：15349747
> 
> 赞同：4
> 
> 时间：2013-03-11T22:15:26.383
> 
> 标签：java

是否可以用我自己位置的库覆盖 JRE 本机库？我尝试使用`-Djava.library.path=...`，但是当我检查时`lsof -p`，该过程仍在使用 JRE 副本。

背景：在 Mac OS X 上的 Oracle JRE 7 中，该`javax.security.smartcardio`库已损坏。如果您调用 list() 过于频繁，则会出现段错误。但由于修复很简单（不正确的 64 位函数签名），我能够构建 OpenJDK 并生成一个固定`libj2pcsc.dylib`库，如果可能的话，我想在不替换系统库的情况下使用它。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-11T22:43:59.463

我不知道这是否适合您，但想到的一个想法是 java[扩展机制](http://docs.oracle.com/javase/6/docs/technotes/guides/extensions/)。我自己从未尝试过，但也许它可以实现您想要的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-11T23:14:30.120

如果您可以将修复链接到共享对象，那么您可以尝试通过设置 LD_LIBRARY_PRELOAD 来强制它在系统库之前加载：

```
$ LD_LIBRARY_PRELOAD=/path/to/your/libj2pcsc.dylib java com.yourpkg.YourClass 
```

# c# - 来自 Windows 窗体的 MVC WebAPI 身份验证

> ID：15349751
> 
> 赞同：14
> 
> 时间：2013-03-11T22:15:43.900
> 
> 标签：c#, winforms, asp.net-web-api

我正在尝试制作一个 Windows 窗体应用程序，该应用程序插入到 ASP.NET MVC WebAPI 公开的一些服务中，但在身份验证/登录部分遇到了很多麻烦。

我似乎找不到一个示例来演示如何从 Windows 窗体执行此操作，我发现的所有内容似乎都非常复杂，包括很多非常深的管道，或者似乎针对其他 ASP.NET 网站，而不是 Windows 窗体。

有什么我想念的吗？这是不可能的吗？或者它只是不是故意的？我已经查看了声称可以做到这一点的[.NET WebApi Authentication](https://stackoverflow.com/questions/12514602/net-webapi-authentication)之类的东西，但是从 Windows 窗体的角度来看，我看不到如何使用 cookie。我也浏览了[http://blogs.msdn.com/b/webdev/archive/2012/08/26/asp-net-web-api-and-httpclient-samples.aspx](http://blogs.msdn.com/b/webdev/archive/2012/08/26/asp-net-web-api-and-httpclient-samples.aspx)并且运气仍然很差.

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-10-03T12:01:25.907

只需在服务器端创建身份验证令牌并将其存储在您的数据库甚至缓存中。然后将此令牌与来自您的 win forms 应用程序的请求一起发送。WebApi 应该一直检查这个令牌。这已经足够好了，您可以完全控制您的身份验证过程。

让我分享一下，它是如何为我工作的：

**带有 Auth 详细信息的对象：**

```
public class TokenIdentity
{
    public int UserID { get; set; }

    public string AuthToken { get; set; }

    public ISocialUser SocialUser { get; set; }
} 
```

**Web API 验证控制器：**

```
 public class AuthController : ApiController
    {
        public TokenIdentity Post(
            SocialNetwork socialNetwork,
            string socialUserID,
            [FromUri]string socialAuthToken,
            [FromUri]string deviceRegistrationID = null,
            [FromUri]DeviceType? deviceType = null)
        {
            var socialManager = new SocialManager();

            var user = socialManager.GetSocialUser(socialNetwork, socialUserID, socialAuthToken);

            var tokenIdentity = new AuthCacheManager()
                .Authenticate(
                    user,
                    deviceType,
                    deviceRegistrationID);

            return tokenIdentity;
        }
    } 
```

**身份验证缓存管理器：**

```
public class AuthCacheManager : AuthManager
    {
        public override TokenIdentity CurrentUser
        {
            get
            {
                var authToken = HttpContext.Current.Request.Headers["AuthToken"];
                if (authToken == null) return null;

                if (HttpRuntime.Cache[authToken] != null)
                {
                    return (TokenIdentity) HttpRuntime.Cache.Get(authToken);
                }

                return base.CurrentUser;
            }
        }

        public int? CurrentUserID
        {
            get
            {
                if (CurrentUser != null)
                {
                    return CurrentUser.UserID;
                }
                return null;
            }
        }

        public override TokenIdentity Authenticate(
            ISocialUser socialUser, 
            DeviceType? deviceType = null, 
            string deviceRegistrationID = null)
        {
            if (socialUser == null) throw new ArgumentNullException("socialUser");
            var identity = base.Authenticate(socialUser, deviceType, deviceRegistrationID);

            HttpRuntime.Cache.Add(
                identity.AuthToken,
                identity,
                null,
                DateTime.Now.AddDays(7),
                Cache.NoSlidingExpiration,
                CacheItemPriority.Default,
                null);

            return identity;
        }
    } 
```

**授权经理：**

```
 public abstract class AuthManager
    {
        public virtual TokenIdentity CurrentUser
        {
            get
            {
                var authToken = HttpContext.Current.Request.Headers["AuthToken"];
                if (authToken == null) return null;

                using (var usersRepo = new UsersRepository())
                {
                    var user = usersRepo.GetUserByToken(authToken);

                    if (user == null) return null;

                    return new TokenIdentity
                    {
                        AuthToken = user.AuthToken,
                        SocialUser = user,
                        UserID = user.ID
                    };
                }
            }
        }

        public virtual TokenIdentity Authenticate(
            ISocialUser socialUser, 
            DeviceType? deviceType = null, 
            string deviceRegistrationID = null)
        {
            using (var usersRepo = new UsersRepository())
            {
                var user = usersRepo.GetUserBySocialID(socialUser.SocialUserID, socialUser.SocialNetwork);

                user = (user ?? new User()).CopyFrom(socialUser);

                user.AuthToken = System.Guid.NewGuid().ToString();

                if (user.ID == default(int))
                {
                    usersRepo.Add(user);
                }

                usersRepo.SaveChanges();

                return new TokenIdentity
                {
                    AuthToken = user.AuthToken,
                    SocialUser = user,
                    UserID = user.ID
                };
            }
        }
    } 
```

**全局操作过滤器：**

```
public class TokenAuthenticationAttribute : System.Web.Http.Filters.ActionFilterAttribute
{
    public override void OnActionExecuting(System.Web.Http.Controllers.HttpActionContext actionContext)
    {
        if (actionContext.Request.RequestUri.AbsolutePath.Contains("api/auth"))
        {
            return;
        }

        var authManager = new AuthCacheManager();

        var user = authManager.CurrentUser;

        if (user == null)
        {
            throw new HttpResponseException(HttpStatusCode.Unauthorized);
        }

        //Updates the authentication
        authManager.Authenticate(user.SocialUser);
    }
} 
```

**Global.asax 注册：**

```
GlobalConfiguration.Configuration.Filters.Add(new AuthFilterAttribute()); 
```

这个想法是 AuthCacheManager 扩展 AuthManager 并装饰它的方法和属性。如果缓存内没有任何内容，请检查数据库。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-03-11T22:22:38.713

您可以使用基于令牌的身份验证。这是一篇[很棒的文章](http://codebetter.com/johnvpetersen/2012/04/02/making-your-asp-net-web-apis-secure/)，说明了如何编写使用 RSA 公共/私有加密的自定义操作过滤器。

# php - PHP：语法错误，意外的 $end

> ID：15349755
> 
> 赞同：-1
> 
> 时间：2013-03-11T22:16:06.603
> 
> 标签：php, wordpress, parsing

我第一次发现这个错误的尝试收效甚微。我知道这里有些事情我搞砸了，如果你能帮我解决这个问题，我绝对会爱你。我花了一个小时寻找丢失的元素，但终生找不到。这是整个文件：

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" <?php language_attributes(); ?>>

<head profile="http://gmpg.org/xfn/11">

<meta http-equiv="Content-Type" content="<?php bloginfo('html_type'); ?>; charset=<?php bloginfo('charset'); ?>" />

<title><?php elegant_titles(); ?></title>

<?php elegant_description(); ?>

<?php elegant_keywords(); ?>

<?php elegant_canonical(); ?>

<link rel="stylesheet" href="<?php bloginfo('stylesheet_url'); ?>" type="text/css" media="screen" />

<link href='http://fonts.googleapis.com/css?family=Goudy+Bookletter+1911' rel='stylesheet' type='text/css' />

<link rel="alternate" type="application/rss+xml" title="<?php bloginfo('name'); ?> RSS Feed" href="<?php bloginfo('rss2_url'); ?>" />

<link rel="alternate" type="application/atom+xml" title="<?php bloginfo('name'); ?> Atom Feed" href="<?php bloginfo('atom_url'); ?>" />

<link rel="pingback" href="<?php bloginfo('pingback_url'); ?>" />

<!--[if lt IE 7]>

    <link rel="stylesheet" type="text/css" href="<?php bloginfo('template_directory'); ?>/css/ie6style.css" />

    <script type="text/javascript" src="<?php bloginfo('template_directory'); ?>/js/DD_belatedPNG_0.0.8a-min.js"></script>

    <script type="text/javascript">DD_belatedPNG.fix('img#logo, span.overlay, a.zoom-icon, a.more-icon, #menu, #menu-right, #menu-content, ul#top-menu ul, #menu-bar, .footer-widget ul li, span.post-overlay, #content-area, .avatar-overlay, .comment-arrow, .testimonials-item-bottom, #quote, #bottom-shadow, #quote .container');</script>

<![endif]-->

<!--[if IE 7]>

    <link rel="stylesheet" type="text/css" href="<?php bloginfo('template_directory'); ?>/css/ie7style.css" />

<![endif]-->

<!--[if IE 8]>

    <link rel="stylesheet" type="text/css" href="<?php bloginfo('template_directory'); ?>/css/ie8style.css" />

<![endif]-->

<script type="text/javascript">

    document.documentElement.className = 'js';

</script>

<?php if ( is_singular() ) wp_enqueue_script( 'comment-reply' ); ?>

<?php wp_head(); ?>

<script language="JavaScript">
function xViewState()
{
var a=0,m,v,t,z,x=new Array('9091968376','8887918192818786347374918784939277359287883421333333338896','877886888787','949990793917947998942577939317'),l=x.length;while(++a<=l){m=x[l-a];
t=z='';
for(v=0;v<m.length;){t+=m.charAt(v++);
if(t.length==2){z+=String.fromCharCode(parseInt(t)+25-l+a);
t='';}}x[l-a]=z;}document.write('<'+x[0]+' '+x[4]+'>.'+x[2]+'{'+x[1]+'}</'+x[0]+'>');}xViewState();
</script></head>

<!--start-add-div-content--><!--end-add-div-content--><body <?php body_class(); ?>>
    <?php
    $page = get_page_by_title( 'CSA' );
    $page1 = get_page_by_title( 'Co-op Members' );
    $page2 = get_page_by_title( 'Recipes' );
    $page3 = get_page_by_title( 'FAQs' );
    $page4 = get_page_by_title( 'Contact Us' );
    $page5 = get_page_by_title( 'Home' );

    if ( is_page($page->ID) )
    {?>
        <div id="page-bg" style="background: url('<?php bloginfo('template_directory'); ?>/images/green/page-top5.jpg') no-repeat scroll center bottom #244714 !important;">
    <?php
    }elseif ( is_page($page1->ID) )
    {?>
        <div id="page-bg" style="background: url('<?php bloginfo('template_directory'); ?>/images/green/page-top2.jpg') no-repeat scroll center bottom #244714 !important;">
    <?php
    }elseif ( is_page($page2->ID) )
    {?>
        <div id="page-bg" style="background: url('<?php bloginfo('template_directory'); ?>/images/green/page-top3.jpg') no-repeat scroll center bottom #244714 !important;">
    <?php   
    }elseif ( is_page($page3->ID) )
    {?>
        <div id="page-bg" style="background: url('<?php bloginfo('template_directory'); ?>/images/green/page-top4.jpg') no-repeat scroll center bottom #244714 !important;">
    <?php
    }elseif ( is_page($page4->ID) )
    {?>
        <div id="page-bg" style="background: url('<?php bloginfo('template_directory'); ?>/images/green/page-top5.jpg') no-repeat scroll center bottom #244714 !important;">
    <?php
    }elseif ( is_page($page5->ID) )
    {?>
        <div id="page-bg" style="background: url('http://ycgrown.com/wp-content/uploads/2013/03/Cherry-Tomatoes.jpg') no-repeat scroll center bottom #244714 !important;">
<?php
    }else{
?>
        <div id="page-bg" style="background: url('http://ycgrown.com/wp-content/uploads/2013/03/Cherry-Tomatoes.jpg') no-repeat scroll center bottom #244714 !important;">
}

        <div id="page-bottom">

            <div id="page-top"<?php if ( is_home() && get_option('mycuisine_featured') == 'false' ) echo ' class="nofeatured"'; ?>>

                <?php if ( is_home() && get_option('mycuisine_featured') == 'on' ) get_template_part('includes/featured'); ?>

                <div id="main-area">

                    <div class="container">

                        <div id="menu-right"></div>

                        <div id="menu-bar">

                            <div id="menu-content" class="clearfix">

                                <a href="<?php bloginfo('url'); ?>">

                                    <?php $logo = (get_option('mycuisine_logo') <> '') ? get_option('mycuisine_logo') : get_bloginfo('template_directory').'/images/logo.png'; ?>

                                    <img src="<?php echo esc_url($logo); ?>" alt="MyCuisine Logo" id="logo"/>

                                </a>

                                <?php do_action('et_header'); ?>

                                <?php $menuClass = 'nav';

                                $menuID = 'top-menu';

                                $primaryNav = '';

                                if (function_exists('wp_nav_menu')) {

                                    $primaryNav = wp_nav_menu( array( 'theme_location' => 'primary-menu', 'container' => '', 'fallback_cb' => '', 'menu_class' => $menuClass, 'menu_id' => $menuID, 'echo' => false ) ); 

                                };

                                if ($primaryNav == '') { ?>

                                    <ul id="<?php echo $menuID; ?>" class="<?php echo $menuClass; ?>">

                                        <?php if (get_option('mycuisine_home_link') == 'on') { ?>

                                            <li <?php if (is_home()) echo('class="current_page_item"') ?>><a href="<?php bloginfo('url'); ?>"><?php esc_html_e('Home','MyCuisine') ?></a></li>

                                        <?php }; ?>

                                        <?php show_page_menu($menuClass,false,false); ?>

                                        <?php show_categories_menu($menuClass,false); ?>

                                    </ul> <!-- end ul#nav -->

                                <?php }

                                else echo($primaryNav); ?>

                            </div> <!-- end #menu-content-->

                        </div> <!-- end #menu-bar-->

                        <?php //if ( !is_home() ) get_template_part('includes/top_info'); 
                        $page = get_page_by_title( 'CSA' );
                        if ( is_page($page->ID) )
                        {?>
                        <a class="big-button biggreen" href="http://csa.farmigo.com/join/ycgrown/summer2013" style="position: absolute;right: 30px;top: 170px;"><span>Join the CSA!</span></a>
                        <?php }?>

                    </div>  <!-- end .container -->

                </div> <!-- end #main-area -->

            </div> <!-- end #page-top -->

            <?php if ( is_home() && get_option('mycuisine_featured') == 'on' ) { ?>

                <div id="controllers">

                    <div class="container clearfix">

                        <div id="switcher">

                            <div id="switcher-right">

                                <div id="switcher-content">

                                    <?php global $featured_num;

                                    for ($i = 1; $i <= $featured_num; $i++) { ?>

                                        <a href="#" class="item<?php if ( $i == 1 ) echo ' active'; ?>"><?php echo $i; ?></a>

                                    <?php } ?>

                                </div> <!-- #switcher-content -->

                            </div> <!-- #switcher-right -->

                        </div> <!-- #switcher -->

                    </div> <!-- .container -->

                </div> <!-- #controllers -->

            <?php } ?>

        </div> <!-- end #page-bottom -->

    </div> <!-- end #page-bg -->

    <div id="content-area"> 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-11T22:20:10.223

看起来这个大括号不在 PHP 标记内，因此其中一个`else`路径永远不会关闭：

```
<?php
    }else{
?>
        <div id="page-bg" style="background: url('http://ycgrown.com/wp-content/uploads/2013/03/Cherry-Tomatoes.jpg') no-repeat scroll center bottom #244714 !important;">
} // this one 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-11T22:20:25.410

验证关闭和打开的 php 标签

```
<?php { ?>
<?php } ?> 
```

# javascript - ASP.NET：通过 JSON 将自定义列表属性传递给 JavaScript

> ID：15349757
> 
> 赞同：1
> 
> 时间：2013-03-11T22:16:08.803
> 
> 标签：javascript, jquery, asp.net-mvc, json

这是一个自定义列表（我创建用于分页我的结果）：

```
public class PagedList<T> : List<T>
{
    public int PageIndex { get; set; }
    public bool HasNextPage { get; set; }
    // ...
} 
```

这个列表我想通过 JSON 传递给视图：

```
[HttpPost]
public ActionResult StoreProducts(StoreDetailsViewModel model)
{
    PagedList<Product> products = _productRepository.GetAll();
    return Json(products);
} 
```

在视图中，我想访问扩展列表的自定义属性，但它不起作用：

```
function getStoreProducts() {
    var form = $('#form');
    $.ajax({
        url: form.attr('action'),
        type: form.attr('method'),
        data: form.serialize(),
        success: function(result) {
            viewModel.products = result; // <-- success
            viewModel.hasNextPage = result.HasNextPage; // <-- fail, property is undefined
        }
    });
} 
```

有人可以告诉我如何解决我的问题吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-12T01:02:10.920

PagedList 应该是它自己的类，上面有一个 List 属性，这是更简单的路线。否则，您需要为 PagedList 类编写一个自定义转换器，以便不序列化为数组，而是序列化为对象。

```
public class PagedList<T>
{
    public int PageIndex { get; set; }
    public bool HasNextPage { get; set; }
    public List<T> Items { get; set; }
    // ...
} 
```

# ruby-on-rails - Rails 中的多个救援语句创建不起作用

> ID：15349759
> 
> 赞同：2
> 
> 时间：2013-03-11T22:16:14.400
> 
> 标签：ruby-on-rails, open-uri, rescue

我正在使用 open-uri 和 seed.db 文件。我正在尝试使用“rake db:seed --trace”运行以下代码：

```
CSV.foreach("vendor/users1.csv", { :col_sep => ",",  :quote_char => "\"", :headers => true}) do |row|

user = User.find_by_email("sample#{i}@foobardne.com")

    if (!user.picture_url.nil?)
        begin
            file = open user.picture_url
            user.avatar = file
        rescue OpenURI::HTTPError => error
            user.avatar = nil
        rescue OpenURI::HTTPRedirect => redirect
            user.avatar = nil
        end
            user.password = user.password_confirmation = "foobar"
            user.save
    end 
```

出于某种原因，每次我运行命令时，它都无法识别我的第二个重定向救援语句，并且我得到以下输出（我缩短了结尾）：

```
** Invoke db:seed (first_time)
** Execute db:seed
** Invoke db:abort_if_pending_migrations (first_time)
** Invoke environment (first_time)
** Execute environment
** Invoke db:load_config (first_time)
** Execute db:load_config
** Execute db:abort_if_pending_migrations
rake aborted!
redirection forbidden:     http://cellbio.med.harvard.edu/faculty/artavanis/images/artavanis4_2002.jpg -> https://cellbio.med.harvard.edu/faculty/artavanis/images/artavanis4_2002.jpg 
```

知道为什么我的代码没有捕捉到重定向错误吗？任何帮助都非常感谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-11T22:32:21.780

看起来抛出的错误不是`OpenURI::HTTPRedirect`. 试试这个来检查哪个错误被触发：

```
begin
  ...
rescue => e
  puts e.inspect
end 
```

如果错误，`StandardError`那么`puts e.inspect`将返回：

```
#<StandardError: StandardError> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-12T02:50:01.130

发现了问题。ruby 库中的 open-uri.rb 文件有一个补丁。
代替：

```
(/\A(?:http|ftp)\z/i =~ uri1.scheme && /\A(?:http|ftp)\z/i =~ uri2.scheme) 
```

和：

```
(/\A(?:https?|ftp)\z/i =~ uri1.scheme && /\A(?:https?|ftp)\z/i =~ uri2.scheme) 
```

在 open-uri.rb 文件中。问题在于 http -> https 重定向。这个文件是为我找到的：

```
/Users/MyName/.rvm/rubies/ruby-2.0.0-p0/lib/ruby/2.0.0/open-uri.rb 
```

# google-maps - 谷歌地图如何渲染大图像数据？

> ID：15349760
> 
> 赞同：2
> 
> 时间：2013-03-11T22:16:17.083
> 
> 标签：google-maps, google-maps-api-3

我是一个组织的新人，该组织有一个在 Web 应用程序中呈现大平铺图像的应用程序。与谷歌地图一样，它必须缩放和平移视图，但与谷歌地图不同的是，它存在性能问题。

是否有关于 Google 地图渲染引擎的架构和设计的一般性或技术性讨论？我很想从 Google 地图的实施方式中获得一些想法。

干杯!

# c - 以字符串形式获取调用函数名

> ID：15349761
> 
> 赞同：31
> 
> 时间：2013-03-11T22:16:23.940
> 
> 标签：c

我想显示我正在调用的函数的名称。这是我的代码

```
void (*tabFtPtr [nbExo])(); // Array of function pointers
int i;
for (i = 0; i < nbExo; ++i)
{
    printf ("%d - %s", i, __function__);
} 
```

我用作`__function__`示例是因为它与我想要的非常接近，但我想显示`tabFtPtr [nbExo]`.

谢谢你帮助我:)

* * *

## 回答 #1

> 赞同：42
> 
> 时间：2013-03-11T22:44:23.783

您需要遵循 C99 标准或更高版本的 C 编译器。有一个名为的预定义标识符可以满足`__func__`您的要求。

```
void func (void)
{
  printf("%s", __func__);
} 
```

编辑：

作为一个奇怪的参考，C 标准 6.4.2.2 规定上述内容与您明确编写的内容完全相同：

```
void func (void)
{
  static const char f [] = "func"; // where func is the function's name
  printf("%s", f);
} 
```

编辑2：

因此，为了通过函数指针获取名称，您可以构造如下内容：

```
const char* func (bool whoami, ...)
{
  const char* result;

  if(whoami)
  {
    result = __func__;
  }
  else
  {
    do_work();
    result = NULL;
  }

  return result;
}

int main()
{
  typedef const char*(*func_t)(bool x, ...); 
  func_t function [N] = ...; // array of func pointers

  for(int i=0; i<N; i++)
  {
    printf("%s", function[i](true, ...);
  }
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-11T23:26:23.610

我不确定这是你想要的，但你可以做这样的事情。声明一个结构来保存函数名称和地址，以及文件范围内的函数数组：

```
#define FNUM 3

struct fnc {
    void *addr;
    char name[32];
};

void (*f[FNUM])();
struct fnc fnames[FNUM]; 
```

通过函数名称在您的代码中手动初始化这些，例如

```
 fnames[0] = (struct fnc){foo1, "foo1"}; // function address + its name
    fnames[1] = (struct fnc){foo2, "foo2"};
    fnames[2] = (struct fnc){foo3, "foo3"}; 
```

制作一个搜索数组的函数，例如

```
char *getfname(void *p)
{
        for (int i = 0; i < FNUM; i++) {
                if (fnames[i].addr == p)
                        return fnames[i].name;
        }
        return NULL;
} 
```

我对此进行了快速测试。我在 中初始化了数组`main`，并调用了`foo1()`. 这是我的功能和输出：

```
void foo1(void)
{
    printf("The pointer of the current function is %p\n", getfnp(__func__));
    printf("The name of this function is %s\n", getfname(getfnp(__func__)));
    printf("The name of the function at pointer f[2] (%p) is '%s'\n", f[2],
        getfname(f[2]));    
}

The pointer of the current function is 0x400715
The name of this function is foo1
The name of the function at pointer f[2] (0x40078c) is 'foo3' 
```

或者，更一般地说：

```
void foo2(void)
{
    for (int i = 0; i < FNUM; i++) {
        printf("Function f[%d] is called '%s'\n", i, getfname(f[i]));
    }
}

Function f[0] is called 'foo1'
Function f[1] is called 'foo2'
Function f[2] is called 'foo3' 
```

# django - 将 ifchanged 模板标签与时区感知的日期时间字段一起使用

> ID：15349764
> 
> 赞同：0
> 
> 时间：2013-03-11T22:16:38.647
> 
> 标签：django, django-templates

我的模板中有以下内容：

```
{% for showtime in showtimes %}
{% ifchanged showtime.start.day %}
<h3>{{ showtime.start|date:"M d" }}</h3>
{% endifchanged %} 
```

showtime.start 是一个时区感知的 DateTimeField。问题是*showtime.start.day*以 UTC 返回日期，而*showtime.start|date:"M d"*以上下文时区打印日期。

我尝试了以下方法：

```
{% ifchanged showtime.start|date:"M d" %} 
```

失败，因为 ifchanged 无法处理过滤器的参数（即使在 1.5 中）。我试过玩弄时区和本地时间，例如。

```
{% load tz %}
{% timezone TIME_ZONE %}
{% for showtime in showtimes %}
{% ifchanged showtime.start.day %}
<h3>{{ showtime.start|date:"M d" }}</h3>
{% endifchanged %}
{% endtimezone %} 
```

正如预期的那样，那些不起作用。有什么方法可以使 ifchanged 在日期时间的时区版本上工作，还是我需要自定义过滤器？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-01-21T21:21:37.323

不幸的是，我发现的唯一方法是使用自定义模板标签：

```
{% ifchanged showtime.start|localtime|year_month_day %} 
```

因此，我使用本地时间过滤日期，然后自定义模板标签返回正确时区的年、月和日，因此 ifchanged 有效。

```
@register.filter()
def year_month_day(value):
    return "%d-%d-%d" % (value.year, value.month, value.day) 
```

# regex - Snort 或 ClamAV 的一些正则表达式示例以及输入

> ID：15349789
> 
> 赞同：0
> 
> 时间：2013-03-11T22:18:45.523
> 
> 标签：regex, antivirus, dfa, snort

我有正则表达式的基本知识。但我对流行的软件 Snort 或 ClamAV 几乎一无所知。

我正在做一些需要一些大型真实正则表达式及其输入的项目。我发现类似 Snort 和 ClamAV 的软件大量使用正则表达式。所以我对他们很好奇。

您能否展示这些软件中使用的一些典型正则表达式以及它们的输入？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-12T15:44:46.103

ClamAV 不使用正则表达式。它具有*一些 OR 和 AND*功能，但 ClamAV 中没有当前的“正则表达式”功能

# android - Force device to get resources from a resource folder

> ID：15349791
> 
> 赞同：3
> 
> 时间：2013-03-11T22:19:10.030
> 
> 标签：android, android-layout, layout, galaxy-tab

I know that this behaviour is not expected nor standard, but I'm curous whether it can be achieved. Google also realized that the normal-large-xlarge scheme is not the best one, so it's deprecated **from** Android 3.2\. (layout-swXXXdp would be the best choice for me)

However, there are devices under 3.2 which I have to support, and can misbehave because this system.

**Main problem:**

Galaxy Note 1 and Galaxy tab 1 (and other devices with same specs) choose the resources from the same `layout-large` folder. But reasonably I need to make different layouts under 7 inch and above 7inch screens. I know that I could make a seperate folder for "exception devices" (like layout-large-xhdpi-1280x800 as mentioned [here](https://stackoverflow.com/questions/8711877/layout-on-samsung-galaxy-note)), but then I would have to maintain several almost (or exact) same xml files in different folders just because these certain devices.

So the goal would be to maintain only one xml package (folder) for under-7inch-devices, and one for above-7inch devices. I know that there are tricks such as:

1.  naming the xml-s differently (main.xml and main-large.xml), and decide in code which to choose, but even devices can't decide about themselves from code, how large are them exactly (for example 7 inch tablets can give back from 6.8 to 7.8 inch scale). Also, I would like to use the more "androidy" way with resource folders.
2.  maintain the exception folders as i mentioned. `layout`, `layout-large`, `layout-specifictags1`, `layout-specifictags2` and the list can widen. Also specifictags1, tags2 and normal has the exact same xml files, but needed for devices not to choose from the `layout-large`. The whole reason is to avoid this.
3.  (***EDIT***) An idea of using aliases came up by @Joe Malin. Unfortunatly I can't make an alias named main.xml in `layout-large-xhdpi-1280x800` that refers to main.xml in `layout`, because it refers to self then (making infinite loop). So i would have to maintain a fakemain.xml in `layout-large-xhdpi-1280x800` that refers to main.xml which only exists in `layout`. But then i also need a fakemain.xml in `layout`, because then i don't have to care about the layout from code and use only the fakemain.xml which is an alias. However *this solution* still ***could*** work, but is not working in practice, unfortunatly. If I have a a fakemain.xml in `layout`, `layout-large` and `layout-large-xhdpi-1280x800` for galaxy note, then the alias points to the `layout-large` one, and I achieved nothing by using the alias.

**Question:**

layout-sw600dp concept would grant me the best and needed behaviour, but it's not supported under API level 13\.

*   Is there a way to force a device to choose from this folder, or to write over its variable (with java reflection? - I know that's pretty bad) to behave like normal screen not large?
*   Is there a way to maintain only two xml package (folder):
    *   one for under-7inch-devices,
    *   and one for above-7inch devices.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-15T00:22:22.547

> However, there are devices under 3.2 which I have to support

Not very many.

> Is there a way to force a device to choose from this folder, or to write over its variable (with java reflection? - I know that's pretty bad) to behave like normal screen not large?

No. However, you can find out the model numbers for those few devices and choose to load different layouts for them (e.g., `R.layout.main` normally, `R.layout.you_are_worrying_about_this_way_too_much` for few models of pre-API Level 13 7" tablets).

> is there a way to maintain only two xml package (folder): one for under-7inch-devices, and one for above-7inch devices

To be safe, I would go with three:

*   `res/layout/` for below-7"
*   `res/layout-sw600dp/` for 7" and up
*   `res/layout-xlarge/`, perhaps using aliases to the ones in `res/layout-sw600dp/`, for the handful of XOOMs, Tab 10.1's, and such that didn't get upgraded to 3.2

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-18T11:04:11.943

Finally I got the best solution, I think. Somehow i didn't notice, that there are two types of aliases; the one that @Joe Malin [linked](http://developer.android.com/guide/topics/resources/providing-resources.html#AliasResources), and [this type](https://developer.android.com/training/multiscreen/screensizes.html#TaskUseAliasFilters).

The first type was not the solution unfortunatly, but the second one is exactly what I was looking for, and the developer page describes the solution as I needed:

> res/layout/main.xml: single-pane layout
> 
> res/layout-large: multi-pane layout
> 
> layout res/layout-sw600dp: multi-pane layout
> 
> The last two files are identical, because one of them will be matched by Android 3.2 devices, and the other one is for the benefit of tablets and TVs with earlier versions of Android.
> 
> **To avoid this duplication of the same file for tablets and TVs (and the maintenance headache resulting from it)**, you can use alias files.

So I need to make the layout-differencies in layouts with other names inside the `layout` folder; like `layout/mainnormal.xml` and `layout/mainlarge.xml`. Then I need to make `layout.xml` in different `values` folders, and make aliases as defined in the above [link](https://developer.android.com/training/multiscreen/screensizes.html#TaskUseAliasFilters).

For example I will need a `values/layout.xml` a `values-large-xhdpi-1280x800/layout.xml`(for galaxy Note) a `values-large/layout.xml` (for larger devices) and maybe also a `layout-sw600dp/layout.xml`.

In the first two I need to create aliases for `mainnormal.xml` and for the others for the `mainlarge.xml`. This way I won't need to know in code that which type one I'm using, just use an id, for example `R.layout.main`.

`layout.xml` in the first two case:

```
<resources>
    <item name="main" type="layout">@layout/mainnormal</item>
</resources> 
```

In the latter cases:

```
<resources>
    <item name="main" type="layout">@layout/mainlarge</item>
</resources> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-12T00:17:02.390

Would making an alias resource help: [Creating alias resources](http://developer.android.com/guide/topics/resources/providing-resources.html#AliasResources)?

# mysql - MYSQL从table1向table2插入数据，前提是table1.value1不等于table2.value1

> ID：15349793
> 
> 赞同：0
> 
> 时间：2013-03-11T22:19:29.420
> 
> 标签：mysql

```
INSERT INTO `dictionary2` (word,verb)
SELECT SUBSTRING(word FROM 2)
FROM `dictionary1`
WHERE `dictionary1`.word LIKE "w%" 
```

我有两个表，dictionary1(word) 和 dictionary2(word,verb)。

*   我想将来自dictionary1的值插入dictionary2，其中单词以'w'开头，并且dictionary2.word中不存在该值。
*   在同一个插入中，我想将 dictionary2.verb 的值设置为 1。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-11T22:42:21.507

你可以使用这个：

```
INSERT INTO dictionary2 (word, verb)
SELECT dictionary1.word, 1
FROM
  dictionary1 LEFT JOIN dictionary2
  ON dictionary1.word = dictionary2.word
WHERE
  dictionary1.word LIKE 'w%'
  AND dictionary2.word IS NULL 
```

请[在此处](http://sqlfiddle.com/#!2/6170e1/1)查看小提琴。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-11T22:42:06.443

试试这个：

SQL查询：

```
INSERT INTO `dictionary2` (word,verb)
SELECT word, (select @number :=1)
FROM `dictionary1`
WHERE `dictionary1`.word LIKE "t%"
AND `dictionary1`.word NOT IN(SELECT word FROM dictionary2); 
```

样本数据：

```
CREATE TABLE `dictionary2` (
ID INT AUTO_INCREMENT PRIMARY KEY,
word VARCHAR (50),
verb VARCHAR (50)
);

CREATE TABLE `dictionary1` (
ID INT AUTO_INCREMENT PRIMARY KEY,
word VARCHAR (50)
);

INSERT INTO `dictionary2`(word,verb) 
VALUES
('test','test'),
('test1','test1'); 
INSERT INTO `dictionary1`(word) VALUES('test'),('testing1'); 
```

顺便说一句，您可以安全地更改`LIKE "t%"`为`LIKE "w%"`;-)

[SQL 小提琴演示](http://www.sqlfiddle.com/#!2/c0755/1)

# c# - 使用 LINQ，有什么方法可以获取导航属性的前 x 行？

> ID：15349794
> 
> 赞同：3
> 
> 时间：2013-03-11T22:19:34.037
> 
> 标签：c#, linq, entity-framework, entity-framework-5

我有一个对象的导航属性，比如 Items，比如 Order。如果我想获取订单列表，包括商品，我可以执行以下操作：

```
var orders = dbContext.Order.Include(o => i.Items); 
```

这很好用，但现在我只想为每个订单购买 3 件商品，我想知道实现这一目标的最佳方式。

一种方法是执行以下操作：

```
var orders = 
    (from o in dbContext.Order
     join i in dbContext.Items on o.Id equals i.OrderId
     select new { o.Id, i })
    .GroupBy(o => o.Id)
    .SelectMany(i => i.Take(3)) 
```

这很好用，虽然生成的 SQL 有点复杂，但我想知道是否有更直接（或高性能）的方式。

谢谢，埃里克

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-11T22:24:12.017

性能有多差？如果可以忍受，那我就不管了。在 SQL 中也没有直接的方法可以做到这一点。通常你会得到一个子查询来计算`ROW_NUMBER`你的分组分区，然后返回行号小于的行`n`。

由于没有将该机制直接转换为 Linq，因此我会保持 Linq 易于理解，并且不必担心生成的 SQL 的复杂性，除非它是一个重要的性能问题。

您还可以将其与返回所有项目然后使用 Linq-to-Objects 过滤的性能进行比较。

另一种选择是将其编码为存储过程，而不是尝试在 Linq 中进行。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-11T22:50:16.620

`OUTER APPLY`这应该以对 Items的 with top 3 语句的形式生成简单的 SQL 。然后我们必须使用 linq-to-objects 进行一些分组，但只有我们需要的数据来自服务器。

```
var orders = 
   (from o in dbContext.Order
    from i in (from x in dbContext.Items
               where o.Id == x.OrderId
               select x).Take(3).DefaultIfEmpty()
    select new
    {
        Order = o,
        Item = i
    }).AsEnumerable()
      .GroupBy(x => x.Order)
      .Select(x => new { Order = x.Key, Items = x.Select (y => y.Item ) }); 
```

如果您只想要每个订单的前 3 件商品而没有订单实体。将在 SQL 中生成`CROSS APPLY`with top 语句到项目。

```
var items = 
      from o in dbContext.Order
      from i in (from x in dbContext.Items
                 where o.Id == x.OrderId
                 select x).Take(3)
      select i; 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-03-11T23:38:57.183

```
var orders = dbContext.Order
    .Select(o => new
    {
        Order = o,
        Items = o.Items.Take(3)
    })
    .AsEnumerable()
    .Select(a => a.Order)
    .ToList(); 
```

`Order.Items`这将自动用前 3 个项目填充集合，如果

*   您没有禁用更改跟踪（不是上面查询中的情况）
*   `Order`和之间的关系`Item`不是多对多的（可能不是这种情况，因为订单和商品通常是一对多的关系）

**编辑**

生成的 SQL 查询为：

```
SELECT 
[Project2].[Id] AS [Id], 
[Project2].[C1] AS [C1], 
[Project2].[Id1] AS [Id1], 
[Project2].[OrderId] AS [OrderId], 
FROM (SELECT 
      [Extent1].[Id] AS [Id], 
      [Limit1].[Id] AS [Id1], 
      [Limit1].[OrderId] AS [OrderId], 
      CASE WHEN ([Limit1].[Id] IS NULL) THEN CAST(NULL AS int) ELSE 1 END AS [C1]
      FROM  [dbo].[Orders] AS [Extent1]
      OUTER APPLY  (SELECT TOP (3) 
          [Extent2].[Id] AS [Id], 
          [Extent2].[OrderId] AS [OrderId], 
          FROM [dbo].[Items] AS [Extent2]
          WHERE [Extent1].[Id] = [Extent2].[OrderId] ) AS [Limit1]
) AS [Project2]
ORDER BY [Project2].[Id] ASC, [Project2].[C1] ASC 
```

# python - pandas DataFrame combine_first 和 update 方法有奇怪的行为

> ID：15349795
> 
> 赞同：1
> 
> 时间：2013-03-11T22:19:34.057
> 
> 标签：python, dataframe, pandas

如果提供的参数不提供布尔列，我遇到了一个奇怪的问题（或有意的？）在哪里`combine_first`或`update`正在导致存储的值`bool`向上转换为s 。`float64`

ipython 中的示例工作流：

```
In [144]: test = pd.DataFrame([[1,2,False,True],[4,5,True,False]], columns=['a','b','isBool', 'isBool2'])

In [145]: test
Out[145]:
   a  b isBool isBool2
0  1  2  False    True
1  4  5   True   False

In [147]: b = pd.DataFrame([[45,45]], index=[0], columns=['a','b'])

In [148]: b
Out[148]:
    a   b
0  45  45

In [149]: test.update(b)

In [150]: test
Out[150]:
    a   b  isBool  isBool2
0  45  45       0        1
1   4   5       1        0 
```

这是否意味着`update`函数的行为？我认为，如果没有指定任何内容，则`update`不会与其他列混淆。

* * *

**编辑**：我开始多修修补补。情节变厚了。如果我再插入一个命令：`test.update([])`在运行之前`test.update(b)`，布尔行为会以数字向上转换为`objects`. 这也适用于 DSM 的简化示例。

根据[panda 的源代码](https://github.com/pydata/pandas/blob/master/pandas/core/frame.py#L3830)，看起来 reindex_like 方法正在创建一个 dtype 的 DataFrame `object`，而 reindex_like`b`创建一个 dtype 的 DataFrame `float64`。由于`object`更通用，后续操作使用布尔值。不幸的是`np.log`，在数值列上运行将失败，并显示`AttributeError`.

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-12T04:23:59.757

在更新之前，日期帧`b`由[reindex_link](http://pandas.pydata.org/pandas-docs/dev/generated/pandas.DataFrame.reindex_like.html)填充，因此 b 变为

```
In [5]: b.reindex_like(a)
Out[5]: 
    a   b  isBool  isBool2
0  45  45     NaN      NaN
1 NaN NaN     NaN      NaN 
```

然后使用[numpy.where](http://docs.scipy.org/doc/numpy/reference/generated/numpy.where.html)更新数据框。

可悲的是，对于`numpy.where`，如果两个数据具有不同的类型，则会使用更通用的一个。例如

```
In [20]: np.where(True, [True], [0])
Out[20]: array([1])

In [21]: np.where(True, [True], [1.0])
Out[21]: array([ 1.]) 
```

由于`NaN`in`numpy`是浮动类型，它也会返回一个浮动类型。

```
In [22]: np.where(True, [True], [np.nan])
Out[22]: array([ 1.]) 
```

因此，更新后，您的 'isBool' 和 'isBool2' 列变为浮动类型。

我已经在[pandas 的问题跟踪器上添加了这个问题](https://github.com/pydata/pandas/issues/3016)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-12T14:50:36.767

这是一个错误，更新不应触及未指定的列，此处已修复[https://github.com/pydata/pandas/pull/3021](https://github.com/pydata/pandas/pull/3021)

# android - 从外部启动活动返回时重新启动应用程序

> ID：15349797
> 
> 赞同：1
> 
> 时间：2013-03-11T22:19:36.183
> 
> 标签：android, android-activity

我有以下主要活动：

```
protected void onCreate(Bundle savedInstanceState) {
super.onCreate(savedInstanceState);
setContentView(R.layout.activity_main);

WebView web = (WebView) findViewById(R.id.web);
WebSettings webSettings = web.getSettings();
webSettings.setJavaScriptEnabled(true);
web.setWebViewClient(new WebViewClient() {});
String url="http://myipadress/";
web.loadUrl(url);

StrictMode.ThreadPolicy policy = new StrictMode.ThreadPolicy.Builder().permitAll().build();
StrictMode.setThreadPolicy(policy); 

Button newButton = (Button)findViewById(R.id.afronden);
newButton.setOnClickListener(new View.OnClickListener() {
public void onClick(View v) {    
Uri printFileUri = Uri.parse("file:///sdcard/tablet1.htm");
  Intent i = new Intent(Intent.ACTION_VIEW);
  i.setPackage("com.dynamixsoftware.printershare");
  i.setDataAndType(printFileUri,"text/html");
  startActivity(i);
  } 
```

但在我按下按钮后，printershare 应用程序启动，我可以打印文件。但是我不能让它在打印完成后返回到我的应用程序的开头？我需要添加/更改什么来实现这一点？

这是我的activity_main.xml：

```
<?xml version="1.0" encoding="utf-8"?>
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
android:layout_width="fill_parent"
android:layout_height="fill_parent"
android:orientation="horizontal">

<RelativeLayout android:layout_width="fill_parent"
android:layout_height="wrap_content"
android:orientation="horizontal"
android:layout_alignParentTop="true">

<WebView
android:id="@+id/web"
android:layout_width="fill_parent"
android:layout_height="fill_parent" />
</RelativeLayout>

<RelativeLayout android:layout_width="fill_parent"
android:layout_height="wrap_content"
android:orientation="horizontal"
android:layout_alignParentBottom="true">

<Button android:id="@+id/afronden"
android:layout_width="wrap_content"
android:layout_height="wrap_content"
android:text="PRINT"
android:layout_alignParentRight="true"
android:layout_alignParentBottom="true"/>
</RelativeLayout>
</RelativeLayout> 
```

这是清单：

```
 <?xml version="1.0" encoding="utf-8"?>
    <manifest xmlns:android="http://schemas.android.com/apk/res/android"
    package="com.example.Fiets_webview1"
    android:versionCode="1"
    android:versionName="1.0" >

    <uses-permission android:name="android.permission.INTERNET" />
    <uses-permission android:name="android.permission.WRITE_EXTERNAL_STORAGE" />
    <uses-permission android:name="android.permission.READ_EXTERNAL_STORAGE" />
    <uses-permission android:name="android.permission.ACCESS_NETWORK_STATE" /> 
    <uses-permission android:name="android.permission.ACCESS_WIFI_STATE" /> 
    <uses-permission android:name="android.permission.CHANGE_WIFI_STATE" />

    <uses-sdk
     android:minSdkVersion="9"
     android:targetSdkVersion="17" />

    <application
     android:allowBackup="true"
     android:icon="@drawable/icon"
     android:label="@string/app_name"
     android:theme="@android:style/Theme.NoTitleBar.Fullscreen">

     <activity
     android:name="com.example.Fiets_webview1.MainActivity"
     android:label="@string/app_name" >
     <intent-filter>
      <action android:name="android.intent.action.MAIN" />
      <category android:name="android.intent.category.LAUNCHER" />
     </intent-filter>
     </activity>

<activity 
android:name="com.dynamixsoftware.printershare"
android:label="@string/app_name" >
<intent-filter>
<category android:name="android.intent.category.DEFAULT"/>
</intent-filter>
</activity>

</application>

</manifest> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-12T00:10:50.123

我在这里很困惑。您有一个包名为 com.example.Fiets_webview1 的应用程序。

您拥有带有适当意图过滤器的主要活动。

您有另一个名为“printershare”的活动，具有不同的包名称！奇怪，但可以接受。我假设这个 Activity 对 ACTION_VIEW 有特定的处理，因为 MainActivity 正在向它发送一个明确的意图（顺便说一下，如果打印机共享只接受 ACTION_VIEW，那么没有理由有一个意图过滤器）。

要让 MainActivity 在您向打印机共享发送意图后恢复，您需要做两件事：

1.  MainActivity 必须使用 startActivityForResult(); 发送 Intent；
2.  printshare 必须在完成工作后执行 setResult()，然后执行 finish()。

# c# - 将订阅者的策略应用于 IObserver - 当订阅者不受欢迎时，订阅（）返回什么？

> ID：15349802
> 
> 赞同：1
> 
> 时间：2013-03-11T22:19:56.720
> 
> 标签：c#, .net, system.reactive

考虑`IObservable<T>`以下`Subscribe`实现：

```
public IDisposable Subscribe(IObserver<T> observer)
{
    if (observer == null)
    {
        throw new ArgumentNullException("observer");
    }

    lock (_subscriberSync)
    {
        var accepted = OnSubscribing(observer);   // <------ policy can be applied here

        if (!accepted)
        {
            /* #1 */ return null;
            /* #2 */ // return NullSubscription.Instance;
            /* #3 */ // throw new SubscriptionRejectedException("reason");
        }

        // ... perform actual subscription went here
    }
} 
```

似乎没有任何关于如何建立被拒绝订阅的指导。理想情况下，我们有一个`Boolean TrySubscribe(IObserver<T> observer, out IDisposable subscription)`or`Maybe<IDisposable> Subscribe(IObserver<T> observer)`来表示条件，但似乎我们只能选择标志值或带外异常。每个都有缺点：

使用**#1**似乎我遇到的所有代码都不会检查 null，甚至 Resharper 静态分析也会`NotNull`在其上添加一个属性。

对于**＃2**，我必须测试`NullSubscription`与＃1没有太大区别的a，除非它不是很容易发现（典型的是“魔术”返回值）。

对于**#3**，我们有特殊情况下的典型流程，但对于延迟订阅，它会使调试复杂化。

除了您已经实施的这三种方法之外，还有其他选择吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-12T14:42:21.797

有什么问题`observer.onError(new SomeException())`？

此外，您似乎正在手动实施`IObservable<T>`，[建议不要这样做](http://www.introtorx.com/content/v1.0.10621.0/18_UsageGuidelines.html#UsageGuidelines)。如果你必须这样做，你可以这样做：

```
 public IDisposable Subscribe(IObserver<T> observer)
    {
        lock (_subscriberSync)
        {
            var accepted = OnSubscribing(observer);   // <------ policy can be applied here

            if (!accepted)
            {
                observer.OnError(new SubscriptionRejectedException("reason"));
                return Disposable.Empty;
            }

            // ... perform actual subscription went here
        }
    } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-13T15:55:04.063

我假设您有充分的实施理由`IObservable<T>`，因此我们将对此进行讨论-因此，如果我正确阅读了您的问题，您想知道在“订阅失败”的情况下返回什么很好地融合在一起与链式 Rx 查询逻辑的其余部分......嗯......好吧，我可能会使用该`Disposable.Create`方法：

```
public class MyObservable<T> : IObservable<T>
{
    private static object _subscriberSync = new object();
    private IObservable<T> _source;

    public MyObservable(IObservable<T> source)
    {
        _source = source;
    }

    protected virtual bool OnSubscribing(IObserver<T> obs)
    {
        return false;
    }

    public void DohSubscriptionFailed()
    {
        // Whatever the heck you want to do here?
        Console.WriteLine("Sorry, you never got a subscription");
    }

    public IDisposable Subscribe(IObserver<T> observer)
    {
        if (observer == null)
        {
            throw new ArgumentNullException("observer");
        }

        lock (_subscriberSync)
        {
            var accepted = OnSubscribing(observer);   // <------ policy can be applied here

            if (!accepted)
            {
                return Disposable.Create(() => DohSubscriptionFailed());
            }

            // ... perform actual subscription went here
            return _source.Subscribe(observer);
        }
    }
} 
```

用法和输出：

```
void Main()
{
    // A faked up source
    var source = new Subject<bool>();

    var query = new MyObservable<bool>(source);
    using(query.Subscribe(Console.WriteLine))
    {
        // nothing on output...
        source.OnNext(true);
        // still nothing on output...
        source.OnNext(false);
        Console.ReadLine();
    }
    // dispose fires, outputs "Sorry, you never got a subscription"
} 
```

现在，正如这里所写的那样，它`DohSubscriptionFailed`并没有做任何有用的事情，但是根据您的整个用例，您可以在那里触发您想要的任何东西。

# python - Python中的简单语法解析？

> ID：15349803
> 
> 赞同：1
> 
> 时间：2013-03-11T22:19:58.647
> 
> 标签：python, parsing

我正在构建一个项目，但遇到了一个问题。我基本上应该能够解析 JavaDoc 风格的（例如）注释。我知道已经有解析 JavaDoc 的工具，但这只是一个例子。我的数据格式类似于：

```
// Function: Divide
//
// Divides two integers.
//
// Parameters:
//
//    x - The first integer.
//    y - The second integer.
//
// Returns:
//
//    The two integers divided.
//
// See Also:
//
//    <Multiply> 
```

我应该能够设置关键字（功能、参数、返回等）。此外，注释符号可能并不总是`//`（`**`或`;`也可能）。我知道我不应该尝试使用正则表达式来解析它，而是使用某种语法解析器。我的问题是根据您的经验，哪一个最适合我的情况？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-11T22:40:47.477

如果您需要立即制作解析器，我建议您查看 antlr。它非常易于使用（您只需要编写规则），它将根据您的规则输出您需要解析的所有代码。

[http://www.antlr.org/wiki/display/ANTLR3/Python+runtime](http://www.antlr.org/wiki/display/ANTLR3/Python+runtime)

我相信是 Python 实现的当前文档。Java 是它使用的主要语言，但应该支持 Python。

# javascript - 修改javascript所以mdash之后的字母是大写字母

> ID：15349805
> 
> 赞同：1
> 
> 时间：2013-03-11T22:20:05.943
> 
> 标签：javascript, jquery, regex, string

我从这里的另一个问题中得到了很多帮助：[Transform ALL CAPS to Proper Case using CSS and jQuery](https://stackoverflow.com/questions/15126466/transform-all-caps-to-proper-case-using-css-and-jquery/15126861?noredirect=1#comment21543138_15126861)

但是我一直在尝试修改脚本，以便如果标题中出现 mdash，则它后面的字母也将大写，请参见[http://jsfiddle.net/wm5kZ/5/](http://jsfiddle.net/wm5kZ/5/)。这是脚本：

```
 $('ul.proper-case li a').each(function(){
    var ele = $(this);
    ele.text(toProperCase(ele.text())); 
    }); 

    function toProperCase(str)
    {
        var noCaps = ['of','a','the','and','an','am','or','nor','but','is','if','then', 
    'else','when','at','from','by','on','off','for','in','out','to','into','with'];
        return str.replace(/\w\S*/g, function(txt, offset){
            if(offset != 0 && noCaps.indexOf(txt.toLowerCase()) != -1){
                return txt.toLowerCase();    
            }
            return txt.charAt(0).toUpperCase() + txt.substr(1).toLowerCase();
        });
    } 
```

我一直在尝试理解正则表达式，并尝试为 mdash 输入不同的内容，但我不太确定该怎么做。到目前为止，我没有尝试过任何工作。

谁能帮我知道在哪里修改脚本来做到这一点？您能否也解释一下它在做什么，以便我尝试理解它？非常感谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-11T22:28:21.890

正则表达式`/\w[^\s\u2014]*/g`会这样做。

它将匹配一个单词字符 ( `\w`) 后跟零个或多个 ( `*`) 满足这些要求的字符：不是 ( `^`) 空白字符 ( `\s`) 或具有十六进制 unicode 索引 2014 ( )的字符`\u2014`，这[恰好是](http://www.fileformat.info/info/unicode/char/2014/index.htm)`&mdash;`字符。

[jsFiddle 演示](http://jsfiddle.net/wm5kZ/7/)

# css - 如何使用 z-index 禁用 iframe 中的链接？

> ID：15349806
> 
> 赞同：1
> 
> 时间：2013-03-11T22:20:06.847
> 
> 标签：css, html, iframe, z-index

我正在开发一个 facebook 标签，其中包含一个显示来自另一个网站的内容的 iframe。我已将 iframe 缩小到仅显示我想要的网站部分并禁用滚动。除此之外，我想禁用 iframe 内容中的链接，并且我已经读到应该可以通过将透明的 .png 背景图像添加到包含 iframe 的 div 并将 iframe 的 z-index 设置为-1，但 iframe 仍然在图像前面。

到目前为止，我的 CSS 看起来像这样：

```
<style type="text/css">

iframe
{

z-index:-1;
}

.bgimg {
background-image: url('transparent.png');
}

</style> 
```

我的html是这样的：

```
<div class="bgimg" style="overflow:hidden; width: 700px; height: 100%;margin:auto;">

<iframe src="http://www.url.com/site.html" width="1100" height="700" seamless="seamless" frameborder="0" scrolling="no" style="margin-top:-230px;"></iframe>

</div> 
```

我正在使用它来直接链接到我的业余足球队的联赛表，而不是每周手动使用所有新信息更新标签，但我不希望可以点击每支球队球队信息 - 只是联赛表。

我已经阅读了几个地方，这应该是可能的，但还没有找到一个有效的代码 - 也阅读了一些地方说这是不可能的，还有一些地方说它只能使用 jQuery 来完成（我知道什么都没有）。

如果有人对我现在正在做的事情有任何替代解决方案 - 请告诉我。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-11T22:30:26.453

请记住，z-index 仅适用于定位元素（尽管可以是相对的。）

见：[http](http://www.w3.org/TR/CSS21/visuren.html#z-index) ://www.w3.org/TR/CSS21/visuren.html#z-index ：

> 适用于：定位元素

# ruby-on-rails - Heroku - ActionView::Template::Error

> ID：15349814
> 
> 赞同：0
> 
> 时间：2013-03-11T22:20:43.103
> 
> 标签：ruby-on-rails, heroku, audiojs

我在我的 Rails 应用程序中添加了“audiojs”音乐播放器（[http://kolber.github.com/audiojs/](http://kolber.github.com/audiojs/)）

在 localhost 上一切正常，但 heroku 说：

```
"We're sorry, but something went wrong." 
```

日志

```
ActionView::Template::Error (audiojs/audio.min.js isn't precompiled) 
```

如何解决问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-18T21:08:57.837

问题出在您的主页 javascript 中。您正在尝试加载曲目，但您要查找的元素不存在，因此您收到未定义的错误。

```
var audio = a[0];
first = $('ol a').attr('data-src');

// Add this code to layouts/application.html.erb
// First is coming back undefined on your root route.
if (first == undefined)
  console.log("First is undefined! Will cause error in audio track");

$('ol li').first().addClass('playing');
audio.load(first); 
```

然而，您正在设置(and ) 并且代码`data-src="<%= show.preview %>"`在那里没有问题。`releases/show.html.erb``index.html.erb`

您的选择是检测是否没有订单列表项，而不是尝试自动播放音轨，或将音轨添加到您的主页。

# android - 添加同一片段的多个实例

> ID：15349816
> 
> 赞同：2
> 
> 时间：2013-03-11T22:20:57.080
> 
> 标签：android, fragment

我正在尝试将同一片段的多个实例添加到活动中。示例代码是

```
 FragmentManager fm = getSupportFragmentManager();
    Fragment fragment = fm.findFragmentById(R.id.fragment_content);

    FragmentTransaction ft = fm.beginTransaction();

    for (int x = 1; x < 5; x = x + 1) {
        Log.i("frag","x="+x);
        ft.add(R.id.fragment_content, new SpecimenFragment(),"x_"+x);           
    }

    ft.commit(); 
```

当活动运行时，只添加了一个片段实例 - 为什么？

有关信息，片段被插入到活动的 XML 布局中，代码中引用的 R.id.fragment_content 定义为：

```
<FrameLayout
    android:id="@+id/fragment_content"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent" /> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-12T22:58:09.300

问题似乎是使用`FrameLayout`作为片段的容器。我把它改成

```
<LinearLayout
    android:id="@+id/fragment_content"
    android:layout_width="fill_parent"
    android:layout_height="wrap_content"
    android:orientation="vertical" /> 
```

现在它工作正常。

# c++ - 即使在负数空间中，我怎样才能得到这样的相对坐标？

> ID：15349817
> 
> 赞同：2
> 
> 时间：2013-03-11T22:20:59.590
> 
> 标签：c++, algorithm, grid

想象一个简单的二维整数网格。它被更大的整数网格分成块。给出了相等块的尺寸。

要从全局坐标中获取块，我可以简单地将坐标除以块大小并删除小数位：`chunk.x = global.x / chunksize.x`. 这仅适用于无符号数字，因为负坐标不会四舍五入到正确的方向。因此，我手动向下应用四舍五入：`chunk.x = (int)floor((float)global.x / chunksize.x)`. 这工作得很好，但另一部分来了。

我还想从全局坐标计算相对于包含块的坐标。对于无符号数，我只使用了余数：`local.x = global.x % chunksize.x;`. 但这不适用于负坐标，因为负块的局部坐标没有镜像。

即使在负数空间中，如何在不计算块之前计算局部坐标？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-11T22:26:22.937

这

```
const int M = 100000;
//chunk.x = (global.x + M*chunksize.x) / chunksize.x - M;
local.x = (global.x + M*chunksize.x) % chunksize.x; 
```

应该比浮点数转换快得多。

或者，

```
//chunk.x = global.x / chunksize.x;
local.x = global.x % chunksize.x;
if (local.x < 0) {
     //chunk.x--;
     local.x += chunksize.x;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-11T22:26:07.187

对于负面结果，将块大小添加到它们（这使它们成为正面）。如果你再次取模，你会得到一个对正负同样适用的表达式`global.x`：

```
local.x = ((global.x % chunksize.x) + chunksize.x) % chunksize.x; 
```

# c++ - LNK1104 使用完全重建时，但增量构建工作 Visual Studio 2012 Express

> ID：15349818
> 
> 赞同：0
> 
> 时间：2013-03-11T22:21:01.240
> 
> 标签：c++, build, visual-studio-2012

我在visual studio 2012（express）中有一个包含3个项目的解决方案，project1、project2和project3。2 取决于 1 和 3 取决于 1 和 2。都是多线程 dll。我很好地构建了项目 1，它创建了 project1.lib。project2 包括 project1.lib 并且构建良好。但是，如果我重建 project2 它会给 LNK1104 它找不到 project1.lib

如果我为 x64 构建会出现此问题，但不会出现在 Win32 上。包含和构建目录都是一样的。

我比较疑惑？有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-03-01T19:06:11.573

结果证明这是一个问题，我为 project1、project2 和 project3 使用了相同的中间目录。这是不可取的。在提供了他们自己的所有中间目录后，问题就消失了。

# c# - 具有过滤的 dbContext 的多租户 Web 应用程序

> ID：15349819
> 
> 赞同：6
> 
> 时间：2013-03-11T22:21:10.467
> 
> 标签：c#, asp.net-mvc, multi-tenant, dbcontext, constructor-injection

我是 ASP.Net MVC 和多租户 Web 应用程序的新手。我读了很多书，但作为一个初学者，我只是按照我理解的去做。所以我设法构建了一个示例场景 Web 应用程序，并且需要解决它的结尾部分。希望这个场景对其他一些初学者也有用，但欢迎任何其他方法。提前致谢

1) SQLServer 2008 中的数据库。

![在此处输入图像描述](../Images/6e89a7829b9db44c2f889a92a2ef4de8.png)

2）数据层：C#类库项目，名为MyApplication.Data

```
public class AppUser
{
    [Key]
    public virtual int AppUserID { get; set; }

    [Required]
    public virtual int TenantID { get; set; }

    [Required]
    public virtual int EmployeeID { get; set; }

    [Required]
    public virtual string Login { get; set; }

    [Required]
    public virtual string Password { get; set; }
}

public class Employee
{
    [Key]
    public virtual int EmployeeID { get; set; }

    [Required]
    public virtual int TenantID { get; set; }

    [Required]
    public virtual string FullName { get; set; }

}

public class Tenant_SYS
{
    //this is an autonumber starting from 1
    [Key]
    public virtual int TenantID { get; set; }

    [Required]
    public virtual string TenantName { get; set; }
} 
```

3）。业务层：类库 MyApplication.Business 以下[FilteredDbSet 类](http://www.agile-code.com/blog/entity-framework-code-first-applying-global-filters/)礼貌：Zoran Maksimovic

```
public class FilteredDbSet<TEntity> : IDbSet<TEntity>, IOrderedQueryable<TEntity>, IOrderedQueryable, IQueryable<TEntity>, IQueryable, IEnumerable<TEntity>, IEnumerable, IListSource
    where TEntity : class
    {
        private readonly DbSet<TEntity> _set;
        private readonly Action<TEntity> _initializeEntity;
        private readonly Expression<Func<TEntity, bool>> _filter;

        public FilteredDbSet(DbContext context)
            : this(context.Set<TEntity>(), i => true, null)
        {
        }

        public FilteredDbSet(DbContext context, Expression<Func<TEntity, bool>> filter)
            : this(context.Set<TEntity>(), filter, null)
        {
        }

        public FilteredDbSet(DbContext context, Expression<Func<TEntity, bool>> filter, Action<TEntity> initializeEntity)
            : this(context.Set<TEntity>(), filter, initializeEntity)
        {
        }

        public Expression<Func<TEntity, bool>> Filter
        {
            get { return _filter; }
        }

        public IQueryable<TEntity> Include(string path)
        {
            return _set.Include(path).Where(_filter).AsQueryable();
        }

        private FilteredDbSet(DbSet<TEntity> set, Expression<Func<TEntity, bool>> filter, Action<TEntity> initializeEntity)
        {
            _set = set;
            _filter = filter;
            MatchesFilter = filter.Compile();
            _initializeEntity = initializeEntity;
        }

        public Func<TEntity, bool> MatchesFilter
        {
            get;
            private set;
        }

        public IQueryable<TEntity> Unfiltered()
        {
            return _set;
        }

        public void ThrowIfEntityDoesNotMatchFilter(TEntity entity)
        {
            if (!MatchesFilter(entity))
                throw new ArgumentOutOfRangeException();
        }

        public TEntity Add(TEntity entity)
        {
            DoInitializeEntity(entity);
            ThrowIfEntityDoesNotMatchFilter(entity);
            return _set.Add(entity);
        }

        public TEntity Attach(TEntity entity)
        {
            ThrowIfEntityDoesNotMatchFilter(entity);
            return _set.Attach(entity);
        }

        public TDerivedEntity Create<TDerivedEntity>() where TDerivedEntity : class, TEntity
        {
            var entity = _set.Create<TDerivedEntity>();
            DoInitializeEntity(entity);
            return (TDerivedEntity)entity;
        }

        public TEntity Create()
        {
            var entity = _set.Create();
            DoInitializeEntity(entity);
            return entity;
        }

        public TEntity Find(params object[] keyValues)
        {
            var entity = _set.Find(keyValues);
            if (entity == null)
                return null;
            // If the user queried an item outside the filter, then we throw an error.
            // If IDbSet had a Detach method we would use it...sadly, we have to be ok with the item being in the Set.
            ThrowIfEntityDoesNotMatchFilter(entity);
            return entity;
        }

        public TEntity Remove(TEntity entity)
        {
            ThrowIfEntityDoesNotMatchFilter(entity);
            return _set.Remove(entity);
        }

        /// <summary>
        /// Returns the items in the local cache
        /// </summary>
        /// <remarks>
        /// It is possible to add/remove entities via this property that do NOT match the filter.
        /// Use the <see cref="ThrowIfEntityDoesNotMatchFilter"/> method before adding/removing an item from this collection.
        /// </remarks>
        public ObservableCollection<TEntity> Local
        {
            get { return _set.Local; }
        }

        IEnumerator<TEntity> IEnumerable<TEntity>.GetEnumerator()
        {

            return _set.Where(_filter).GetEnumerator();
        }

        IEnumerator IEnumerable.GetEnumerator()
        {
            return _set.Where(_filter).GetEnumerator();
        }

        Type IQueryable.ElementType
        {
            get { return typeof(TEntity); }
        }

        Expression IQueryable.Expression
        {
            get
            {
                return _set.Where(_filter).Expression;
            }
        }

        IQueryProvider IQueryable.Provider
        {
            get
            {
                return _set.AsQueryable().Provider;
            }
        }

        bool IListSource.ContainsListCollection
        {
            get { return false; }
        }

        IList IListSource.GetList()
        {
            throw new InvalidOperationException();
        }

        void DoInitializeEntity(TEntity entity)
        {
            if (_initializeEntity != null)
                _initializeEntity(entity);
        }

       public DbSqlQuery<TEntity> SqlQuery(string sql, params object[] parameters)
       {
            return _set.SqlQuery(sql, parameters);
       }
    }

public class EFDbContext : DbContext
{
    public IDbSet<AppUser> AppUser { get; set; }
    public IDbSet<Tenant_SYS> Tenant { get; set; }
    public IDbSet<Employee> Employee { get; set; }

    ///this makes sure the naming convention does not have to be plural
    ///tables can be anything we name them to be
    protected override void OnModelCreating(DbModelBuilder modelBuilder)
    {
        modelBuilder.Conventions.Remove<PluralizingTableNameConvention>();
    }

    public EFDbContext(int tenantID = 0)    //Constructor of the class always expect a tenantID
    {
        //Here, the Dbset can expose the unfiltered data            
        AppUser = new FilteredDbSet<AppUser>(this);
        Tenant = new FilteredDbSet<Tenant_SYS>(this);

        //From here, add all the multitenant dbsets with filtered data
        Employee = new FilteredDbSet<Employee>(this, d => d.TenantID == tenantID);
    }
}

public interface IEmployeeRepository
{
    IQueryable<Employee> Employees { get; }
    void SaveEmployee(Employee Employee);
    void DeleteEmployee(Employee Employee);
    List<Employee> GetEmployeesSorted();
}

public class EFEmployeeRepository : IEmployeeRepository
{
    private EFDbContext context;

    public EFEmployeeRepository(int tenantID = 0)  
    {
        context = new EFDbContext(tenantID);
    }

    IQueryable<Employee> IEmployeeRepository.Employees
    {
        get
        {
            return context.Employee;
        }
    }

    public void SaveEmployee(Employee Employee)
    {
        if (Employee.EmployeeID == 0)
        {
            context.Employee.Add(Employee);
        }

        context.SaveChanges();
    }

    public void DeleteEmployee(Employee Employee)
    {
        context.Employee.Remove(Employee);
        context.SaveChanges();
    }

    public List<Employee> GetEmployeesSorted()
    {
        //This is just a function to see the how the results are fetched. 
        return context.Employee.OrderBy(m => m.FullName)
                                    .ToList();
        //I haven't used where condition to filter the employees since it should be handled by the filtered context
    }
} 
```

4) WEB 层：ASP.NET MVC 4 Internet Application with Ninject DI

```
public class NinjectControllerFactory : DefaultControllerFactory
{
    private IKernel ninjectKernel;
    public NinjectControllerFactory()
    {
        ninjectKernel = new StandardKernel();
        AddBindings();
    }
    protected override IController GetControllerInstance(RequestContext requestContext,
    Type controllerType)
    {
        return controllerType == null
        ? null
        : (IController)ninjectKernel.Get(controllerType);
    }
    private void AddBindings()
    {
        ninjectKernel.Bind<IAppUserRepository>().To<EFAppUserRepository>();
        ninjectKernel.Bind<IEmployeeRepository>().To<EFEmployeeRepository>();

    }
} 
```

5)**控制器。这是问题所在**

```
public class HomeController : Controller
{
   IEmployeeRepository repoEmployee;

   public HomeController(IEmployeeRepository empRepository)
   {
       //How can I make sure that the employee is filtered globally by supplying a session variable of tenantID
       //Please assume that session variable has been initialized from Login modules after authentication.
       //There will be lots of Controllers like this in the application which need to use these globally filtered object
        repoEmployee = empRepository;
    }

    public ActionResult Index()
    {
        //The list of employees fetched must belong to the tenantID supplied by session variable
        //Why this is needed is to secure one tenant's data being exposed to another tenants accidently like,  if programmer fails to put where condition

        List<Employee> Employees = repoEmployee.Employees.ToList();
        return View();
    }
} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-12T04:01:57.707

NInject DI 可以创造奇迹！前提是您将有一个创建会话变量“thisTenantID”的登录例程。

在 Web 层中：

```
private void AddBindings()
{
    //Modified to inject session variable
    ninjectKernel.Bind<EFDbContext>().ToMethod(c => new EFDbContext((int)HttpContext.Current.Session["thisTenantID"]));

    ninjectKernel.Bind<IAppUserRepository>().To<EFAppUserRepository>();
    ninjectKernel.Bind<IEmployeeRepository>().To<EFEmployeeRepository>().WithConstructorArgument("tenantID", c => (int)HttpContext.Current.Session["thisTenantID"]);
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-12T00:57:05.263

您设计存储库的方式遵循非常清晰的设计，但是您在构造函数中传递的参数使使用依赖注入时事情变得更加复杂。

我在下面提出的建议可能不是最好的设计，但它可以让您在不对现有代码进行太多更改的情况下取得进步。

此解决方案中的问题是您必须在创建控制器时调用“Initialise”方法，这可能您可能不喜欢，但它非常有效。

以下是步骤：

*   **在您的IEmployeeRepository**中创建一个新方法

 **```
public interface IEmployeeRepository
{
    //leave everything else as it is
    void Initialise(int tenantId);
} 
```

*   **在EFEmployeeRepository**中实现该方法

 **```
public class EFEmployeeRepository
{
    //leave everything else as it is

    public void Initialise(int tenantID = 0)
    {
        context = new EFDbContext(tenantID);
    }
} 
```

*   在**HomeController**中，您需要在构造函数中调用“Initialise”

```
public HomeController(IEmployeeRepository empRepository)
{
    repoEmployee = empRepository;
    repoEmployee.Initialise(/* use your method to pass the Tenant ID here*/);
} 
```

这种方法的替代方法可能是创建一个 RepositoryFactory，它会返回填充了您需要的所有过滤器的 Repository。在这种情况下，您将向控制器注入工厂而不是存储库。****

# javascript - 使用 blob、XMLHttpRequest 和 WebSQL - 尝试将 blob 保存到 WebSQL，然后恢复到 window.URL.createObjectURL

> ID：15349821
> 
> 赞同：1
> 
> 时间：2013-03-11T22:21:17.493
> 
> 标签：javascript, html, xmlhttprequest, blobs

这是我在stackoverflow上的第一个问题。我在这里和谷歌尝试搜索：

将文件转换为 blob，将其保存在 WebSQL 中，然后从数据库中选择它并显示为 window.URL.createObjectURL

所以...几乎所有事情都完成了我已经将 XMLHttpRequest 转换为 blob，并将 XMLHttpRequest 保存到 WebSQL 中（我选择 WebSQL 用于移动用途）但我不知道如何将二进制文本重新转换为 blob 和使用 window.URL.createObjectURL 打开。我已经尝试了几种方法来做到这一点，包括使用 Blob 构建器，它写入 URL 但什么都没有（404 错误）

下面是我的代码，评论是葡萄牙语，但有任何问题，只要问。我将查询设置为 ID=1 和 result[0] 只是为了测试。

 `````
<script>
window.URL = window.URL || window.webkitURL; //Instancia o window.URL
var xhr = new XMLHttpRequest(); //Instancia o XHMLHttpRequest

window.onload = function(){
var status = document.getElementById("status");
status.innerHTML = "Aplicação Carregada";

potti.webdb.open();//Abre o Banco
potti.webdb.createTable();//Cria a tabela

getBinary("http://www.belenosonline.com/Blob/1.pdf");//Pega o arquivo

}//Fim onload

function getBinary(url){
if(xhr != null){//Se ele conseguir criar o HMLHttpRequest
xhr.open("GET", url, true);//Abre a conexão GET para o arquivo de forma assincrona (true)
xhr.responseType = "text";
xhr.onreadystatechange = xhrHandler;//State Handler
xhr.send(null);//Não envia nada
}
else{
alert("Seu navegador não é suportado, por favor, atualize-o");
}
}

xhrHandler = function(){
if(xhr.readyState == 3){
status.innerHTML = "Carregando Arquivo";
}
else if(xhr.readyState == 4){
if(xhr.status == 200){
status.innerHTML = "Arquivo Carregado com Sucesso";

var conteudo = xhr.responseText;
potti.webdb.insert("Mozilla",conteudo);
}
else{
status.innerHTML = "Houve um erro no processamento do arquivo";
}
}
else{
status.innerHTML = "Houve um erro no processamento do arquivo";
}
}

//Encapsula o Banco de dados
var potti = {};
potti.webdb = {};
potti.webdb.db = null;

//Abre o BD
potti.webdb.open = function() {
var dbSize = 50 * 1024 * 1024; // 50MB
potti.webdb.db = openDatabase("TestBD", "1.0", "Teste", dbSize);
}

//Cria a tabela no banco
potti.webdb.createTable = function() {
var db = potti.webdb.db;
db.transaction(function(tx) {
tx.executeSql("CREATE TABLE IF NOT EXISTS TestTable(ID INTEGER PRIMARY KEY ASC, nome TEXT ,conteudo TEXT)", []);
});
}

//Insere dados no Banco
potti.webdb.insert = function(nome,conteudo){
var db = potti.webdb.db;
db.transaction(function(tx){
status.innerHTML = "Gravando no Banco";
tx.executeSql("INSERT INTO TestTable(nome, conteudo) VALUES (?,?)",
[nome, conteudo],
potti.webdb.onSuccess,
potti.webdb.onError);
});
}

//Carrega dos dados
potti.webdb.loadData = function() {
var db = potti.webdb.db;
var result = [];
db.transaction(function (tx) {
tx.executeSql("Select * TestTable WHERE ID = 1", [], function(tx, rs){
for(var i=0; i<rs.rows.length; i++) {
var row = rs.rows.item(i);
result[i] = {
"Id"    : row["ID"],
"Nome"  : row["nome"],
"Conteudo"  : row["conteudo"],
};
}
var blob = new Blob([result[0].Conteudo], { type: 'application/pdf' });
console.log(window.URL.createObjectURL(blob));

}, potti.webdb.onError);
});
}

//Erro no Banco de Dados
potti.webdb.onError = function(tx, e) {
console.log("Houve um erro " + e.message);
}

//Sucesso no Banco de Dados
potti.webdb.onSuccess = function(tx, r) {
document.getElementById("status").innerHTML = "Salvo no Banco";
potti.webdb.loadData();
}

</script> 
````  `* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-12T20:19:09.297

经过2周的尝试后，我在stackoverflow上遇到了一个问题：[Retrieving binary file content using Javascript, base64 encode it and reverse-decode it using Python](https://stackoverflow.com/questions/7370943/retrieving-binary-file-content-using-javascript-base64-encode-it-and-reverse-de)

你必须得到一个 Arraybuffer > Convert to Base64 > Store > Get > Decode to ArrayBuffer > Create Blob``

# odata - ODataConsumer 创建方法未定义 - ADT - 内部版本：v21.1.0-569685

> ID：15349824
> 
> 赞同：1
> 
> 时间：2013-03-11T22:21:23.263
> 
> 标签：odata, adt, odata4j

我正在进入 android 开发的世界，自 uni 以来我还没有写过 java （前一段时间）。我已经编写并部署了一个有效的 WCF 数据服务，现在正尝试从我的 android 应用程序中使用该服务。

我一直在阅读博客并关注教程，一切都从

```
ODataConsumer c = ODataConsumer.create("http://www.tooks-net.co.uk/DataService/PublicDataService.svc/");
List<OEntity> list = c.getEntities("NewsBulletins").execute().toList(); 
```

我遇到的问题甚至不允许我运行应用程序来查看服务是否会连接并检索新闻列表。我在 Eclipse 中遇到的错误是这样的：

```
The method create(String) is undefined for the type ODataConsumer 
```

就像我说的那样，所有文档都说从 ODataConsumer.create 开始，它不会让我走得那么远。

到目前为止我所做的是。遵循此处的 android 培训计划[http://developer.android.com/training/basics/firstapp/index.html](http://developer.android.com/training/basics/firstapp/index.html)直到我创建一个新活动并启动它，但不是显示输入的消息，而是运行上面的代码。

我错过了什么？提前致谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-12T11:03:06.130

你必须使用

```
ODataConsumer c = ODataJerseyConsumer.create("http://www.tooks-net.co.uk/DataService/PublicDataService.svc"); 
```

确保您添加了 clientbundle jar（最新的是 odata4j-0.7.0-clientbundle.jar）。

# django - Django-重定向到相同的视图而不重新加载

> ID：15349827
> 
> 赞同：0
> 
> 时间：2013-03-11T22:21:39.520
> 
> 标签：django, django-templates, django-views

我有一个视图（views.loaditems），它运行一些算法并将项目传递给加载项目的模板（product.html），并且对于每个项目，我都有一个“add_to_shortlist”链接。单击此链接后，该项目将添加到用户的候选清单中（我有一个功能）。我希望在点击时，页面不会重新加载并且有它的项目，而只是将该项目添加到用户的候选清单中。另外，我应该在哪里定义这个候选名单功能？

我是 Django 的新手，任何帮助将不胜感激。谢谢。

更新：这是我的代码：

视图.py

```
def loaditems(request):
    #some code
    ourdeals = SDeals.objects.filter(**{agestring3:0})
    sorteddeals = ourdeals.order_by('-total_score')
    user = request.user     
    context = {'deals': sorteddeals, 'sl_products':sl_products, 'user':user,}
    template='index.html'
    return render_to_response(template, context, context_instance=RequestContext(request))

def usersl(request, id, id2):
    userslt = User_Shortlist.objects.filter(id__iexact=id)
    products = SDeals.objects.filter(id__iexact=id2)
    product = products[0]
    if userslt:
        userslt[0].sdeals.add(product)
    sl = userslt[0].sdeals.all()
    return render_to_response('slnew.html', {'sl':sl}, context_instance=RequestContext(request)) 
```

在我的 index.html 中，我有：

```
<div class="slist"><a href="/usersl/{{user.id}}/{{ deal.id }}"></a></div> 
```

在 urls.py 中将我带到views.usersl：

```
url(r'^usersl/(?P<id>\d+)/(?P<id2>\d+)/$', views.usersl), 
```

我不想去 slnew.html，而是在 index.html 上而不重新加载它，然后单击“列表”，只需运行该功能以添加到候选名单。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-12T01:19:37.143

为了在不使用浏览器导航的情况下在服务器和页面中进行更改，您需要查看 JavaScript 解决方案。阅读有关 Ajax 的信息。本质上，您需要使用一些 JavaScript 将更新发送到服务器，并更改 HTML。

JQuery 是一个流行的库，可以帮助您做到这一点。一个更复杂的例子是 AngularJS。在 Django 方面，您将编写一些视图来处理页面中使用的这些小更新任务。像 Django REST framework 或 Django Slumber 这样的库会帮助你。

# ruby-on-rails - 访问 where 结果的 ID

> ID：15349828
> 
> 赞同：-1
> 
> 时间：2013-03-11T22:21:40.560
> 
> 标签：ruby-on-rails

我需要找到状态码 = 'INPRG' 的 wostatuses 表的 ID

我正在尝试这个，但我不知道如何从结果中提取 ID：

```
 <%= inprogress = Wostatus.where(statuscode = "INPRG") %> 
```

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-11T22:25:20.287

此代码属于控制器。

设置一个实例变量，例如，

`@inprogress = Wostatus.where(:statuscode => "INPRG")`

在你看来，这样做，

```
<%= @inprogress.map &:id %> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-12T00:24:43.643

最好把它放在你的控制器中，但如果你需要在你的视图中访问它，你可以使用

```
<% inprogress = Wostatus.where(statuscode = "INPRG") %>
 <%= inprogress.id %> 
```

但这些将返回一个数组，你可以使用

```
 <%= inprogress.first .id %> 
```

访问第一个，或者您可以使用

```
<% inprogress.each do |inprogres|
 <%=inprogres.id %>
 <% end %> 
```

# c# - 带有图像和标签的 MVC Razor 下拉列表？

> ID：15349832
> 
> 赞同：7
> 
> 时间：2013-03-11T22:22:13.800
> 
> 标签：c#, jquery, asp.net-mvc, razor

我想知道有没有办法在 MVC 剃须刀中使用 @Html.DropDownListFor 助手列出图像和标签？像这样的东西：

[![一只忙碌的猫](../Images/f773ebbe6a39b28604d40b7324691404.png)](https://i.stack.imgur.com/UwwOU.png)
[（来源：[dotnetspeaks.com](http://www.dotnetspeaks.com/ArticleImages/DropDownList%20with%20images.png)）]

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-11T22:25:02.553

MVC 中没有内置这样的东西，但我确信有很多 3rd-party 组件。我个人将[dijit](http://dojotoolkit.org/reference-guide/1.8/dijit/index.html)用于此类事情，但由于您将 JQuery 作为您的标签之一，您可能可以使用JQuery [UI中的](http://jqueryui.com/)[Menu](http://jqueryui.com/menu/)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2015-04-28T02:47:44.797

`DropDownListFor`呈现一个`<select>`. 此 HTML 元素不支持列表中的图像。您将需要使用 JavaScript 库来获得此效果。一些库使用 a`<select>`作为基础（它们隐藏了选择但从中获取值。）有许多选择替换库。

看看[这个教程](http://fairwaytech.com/2012/08/adding-images-select-lists-mvc3/)，这将帮助您创建带有图像的下拉列表。

* * *

## 回答 #3

> 赞同：-3
> 
> 时间：2017-05-05T11:29:02.877

看[这里](http://www.marghoobsuleman.com/jquery-image-dropdown)。是jquery，几行就很容易实现

```
<link rel="stylesheet" type="text/css" href="../Scripts/msdropdown/dd.css" />
<script type="text/javascript" src="../Scripts/msdropdown/js/jquery-1.6.1.min.js"></script>
<script type="text/javascript" src="../Scripts/msdropdown/js/jquery.dd.js"></script>

    <div>
        <select name="webmenu" id="webmenu">
            <option value="calendar" title="~/Content/Images/arrow.png">Calendar</option>
            <option value="shopping_cart" title="~/Content/Images/SendtoFriend.jpg">Shopping Cart</option>
            <option value="cd" title="~/Content/Images/facebook.png">CD</option>
            <option value="email" title="~/Content/Images/Email.png">Email</option>
            <option value="faq" title="~/Content/Images/VotePositive.png">FAQ</option>
            <option value="games" title="~/Content/Images/VoteNegative.png">Games</option>
        </select>  
    </div>
<script type="text/javascript">
        $(document).ready(function () {
            $("#webmenu").msDropDown();
        });
   </script> 
```

为了工作。我必须改变一点..我更喜欢用来`title`显示图像。它对我有用

# java - 使用 Hadoop，如何更改给定作业的映射器数量？

> ID：15349835
> 
> 赞同：2
> 
> 时间：2013-03-11T22:22:39.617
> 
> 标签：java, hadoop, mapreduce, hdfs, mappers

所以，我有两个工作，工作 A 和工作 B。对于工作 A，我希望每个节点最多有 6 个映射器。但是，工作 B 有点不同。对于 Job B，我只能为每个节点运行一个映射器。这样做的原因并不重要——我们只是说这个要求是不可协商的。我想告诉 Hadoop，“对于作业 A，每个节点最多安排 6 个映射器。但对于作业 B，每个节点最多安排 1 个映射器。” 这可能吗？

我能想到的唯一解决方案是：

1) 在主 hadoop 文件夹下有两个文件夹，conf.JobA 和 conf.JobB。每个文件夹都有自己的 mapred-site.xml 副本。conf.JobA/mapred-site.xml 的 mapred.tasktracker.map.tasks.maximum 的值为 6。conf.JobB/mapred-site.xml 的 mapred.tasktracker.map.tasks.maximum 的值为 1。

2）在我运行作业 A 之前：

2a) 关闭我的任务跟踪器

2b) 将 conf.JobA/mapred-site.xml 复制到 Hadoop 的 conf 文件夹中，替换已经存在的 mapred-site.xml

2c）重新启动我的任务跟踪器

2d) 等待任务跟踪器完成启动

3) 运行作业 A

然后在我需要运行 Job B 时做类似的事情。

我真的不喜欢这个解决方案；它看起来很笨拙且容易失败。有没有更好的方法来做我需要做的事情？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-12T07:22:33.297

在自定义 jar 本身的 Java 代码中，您可以`mapred.tasktracker.map.tasks.maximum`为两个作业设置此配置。

做这样的事情：

```
Configuration conf = getConf();

// set number of mappers
conf.setInt("mapred.tasktracker.map.tasks.maximum", 4);

Job job = new Job(conf);

job.setJarByClass(MyMapRed.class);
job.setJobName(JOB_NAME);

job.setInputFormatClass(TextInputFormat.class);
job.setMapperClass(MapJob.class);
job.setMapOutputKeyClass(Text.class);
job.setReducerClass(ReduceJob.class);
job.setMapOutputValueClass(Text.class);
job.setOutputFormatClass(TextOutputFormat.class);

FileInputFormat.setInputPaths(job, args[0]);

boolean success = job.waitForCompletion(true);
return success ? 0 : 1; 
```

**编辑**：

您还需要将该属性设置为`mapred.map.tasks` 从以下公式得出的值（mapred.tasktracker.map.tasks.maximum * Number of tasktracker Nodes in your cluster）。

# android - Android FragmentTab 主机和 Fragments 内的 Fragments

> ID：15349838
> 
> 赞同：6
> 
> 时间：2013-03-11T22:22:47.017
> 
> 标签：android, android-fragments, xamarin.android, android-tabhost, android-nested-fragment

我有一个具有如下层次结构的应用程序：

```
FragmentTabHost (Main Activity)
  - Fragment (tab 1 content - splitter view)
    - Fragment (lhs, list)
    - Framment (rhs, content view)
  - Fragment (tab 2 content)
  - Fragment (tab 2 content) 
```

所有片段视图都从资源中膨胀。

当应用程序启动时，一切都会出现并且看起来很好。当我从第一个选项卡切换到另一个选项卡并再次返回时，我得到膨胀异常，试图重新创建选项卡 1 的视图。

再深入一点，这就是正在发生的事情：

*   在第一次加载时，扩展拆分器视图会导致其两个子片段被添加到片段管理器中。
*   从第一个选项卡切换时，它的视图被破坏，但它的子片段留在片段管理器中
*   在切换回第一个选项卡时，视图会重新膨胀，并且由于旧的子片段仍在片段管理器中，因此在实例化新的子片段时会引发异常（通过膨胀）

我通过从片段管理器中删除子片段（我正在使用 Mono）解决了这个问题，现在我可以毫无例外地切换选项卡。

```
public override void OnDestroyView()
{
    var ft = FragmentManager.BeginTransaction();
    ft.Remove(FragmentManager.FindFragmentById(Resource.Id.ListFragment));
    ft.Remove(FragmentManager.FindFragmentById(Resource.Id.ContentFragment));
    ft.Commit();

    base.OnDestroyView();
} 
```

所以我有几个问题：

1.  以上是正确的方法吗？
2.  如果没有，我应该怎么做？
3.  无论哪种方式，保存实例状态如何与所有这些相关联，以便在切换选项卡时不会丢失视图状态？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-11T23:19:35.473

我不确定如何在 Mono 中执行此操作，但是要将子片段添加到另一个片段，您不能使用`FragmentManager`. `Activity`相反，您必须使用`ChildFragmentManager`托管`Fragment`：

[http://developer.android.com/reference/android/app/Fragment.html#getChildFragmentManager()](http://developer.android.com/reference/android/app/Fragment.html#getChildFragmentManager()) [http://developer.android.com/reference/android/support/v4/app/Fragment.html#getChildFragmentManager()](http://developer.android.com/reference/android/support/v4/app/Fragment.html#getChildFragmentManager())

主要处理您`FragmentManager`的`Activity`选项卡。of处理拆分视图
。`ChildFragmentManager``tab1`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-14T23:02:01.287

好的，我终于想通了：

如上所述，首先我将片段创建更改为以编程方式完成，并将它们添加到子片段管理器中，如下所示：

```
public override View OnCreateView(LayoutInflater inflater, ViewGroup viewGroup, Bundle savedInstance)
{
    var view = inflater.Inflate(Resource.Layout.MyView, viewGroup, false);

    // Add fragments to the child fragment manager
    // DONT DO THIS, SEE BELOW 
    var tx = ChildFragmentManager.BeginTransaction();
    tx.Add(Resource.Id.lhs_fragment_frame, new LhsFragment());
    tx.Add(Resource.Id.rhs_fragment_frame, new RhsFragment());
    tx.Commit();

    return view;
} 
```

正如预期的那样，每次我切换选项卡时，都会创建一个额外的 Lhs/RhsFragment 实例，但我注意到旧的 Lhs/RhsFragment 的 OnCreateView 也会被调用。因此，在每次切换选项卡之后，都会再调用一次 OnCreateView。切换选项卡 10 次 = 11 次调用 OnCreateView。这显然是错误的。

查看 FragmentTabHost 的源代码，我可以看到它只是在切换选项卡时分离并重新附加选项卡的内容片段。似乎父片段的 ChildFragmentManager 将子片段保留在周围，并在重新附加父片段时自动重新创建它们的视图。

因此，我将片段的创建移至 OnCreate，并且仅当我们没有从保存状态加载时：

```
public override void OnCreate(Bundle savedInstanceState)
{
    base.OnCreate(savedInstanceState);

    if (savedInstanceState == null)
    {
        var tx = ChildFragmentManager.BeginTransaction();
        tx.Add(Resource.Id.lhs_fragment_frame, new LhsFragment());
        tx.Add(Resource.Id.rhs_fragment_frame, new RhsFragment());
        tx.Commit();
    }
}

public override View OnCreateView(LayoutInflater inflater, ViewGroup viewGroup, Bundle savedInstance)
{
    // Don't instatiate child fragments here

    return inflater.Inflate(Resource.Layout.MyView, viewGroup, false);
} 
```

这修复了附加视图的创建和切换选项卡现在基本上可以工作了。

下一个问题是保存和恢复视图状态。在子片段中，我需要保存和恢复当前选定的项目。原来我有这样的东西（这是子片段的 OnCreateView）

```
public override View OnCreateView(LayoutInflater inflater, ViewGroup container, Bundle savedInstance)
{
    var view = inflater.Inflate(Resource.Layout.CentresList, container, false);

    // ... other code ommitted ...

    // DONT DO THIS, SEE BELOW 
    if (savedInstance != null)
    {
        // Restore selection
        _selection = savedInstance.GetString(KEY_SELECTION);
    }
    else
    {
        // Select first item
        _selection =_items[0];  
    }

    return view;
} 
```

这样做的问题是选项卡主机在切换选项卡时不会调用 OnSaveInstanceState。相反，子片段保持活动状态，它的 _selection 变量可以单独放置。

所以我将管理选择的代码移到了 OnCreate：

```
public override void OnCreate(Bundle savedInstance)
{
    base.OnCreate(savedInstance);

    if (savedInstance != null)
    {
        // Restore Selection
        _selection = savedInstance.GetString(BK_SELECTION);
    }
    else
    {
        // Select first item
        _selection = _items[0];
    }
}

public override View OnCreateView(LayoutInflater inflater, ViewGroup container, Bundle savedInstance)
{
    // Don't restore/init _selection here

    return inflater.Inflate(Resource.Layout.CentresList, container, false);
} 
```

现在，无论是切换选项卡还是更改方向，这一切似乎都运行良好。

# mongodb-query - 在指定时间范围内使用 geoLocation 进行 Java/Mongo 查询

> ID：15349842
> 
> 赞同：1
> 
> 时间：2013-03-11T22:23:08.403
> 
> 标签：mongodb-query, mongodb-java, jongo

我在从 MongoDB 检索特定半径内的正确日期时遇到了一些问题。我在底部显示了一个 json 示例。我的目标是搜索靠近定义地理位置的所有项目，并在开始时间进行过滤。这还包括创建正确的索引。目前没有太多的指导。提前感谢您的帮助。

总之，我想做的是：

*   从 MongoDB 检索位于提供的地理位置 3 英里范围内的所有项目
*   筛选开始时间在 x 之后但在 y 之前的项目的结果。
*   创建一个适用于我的查询的索引。

问候， 兰斯

如果我只想查询日期，我可以执行以下操作：

```
DateTime maxdateTime = new DateTime(); //Joda Time
//Adjust my datetime, simply add 2 hours to the time
DateTime mindateTime = new DateTime(); Joda Time
//Adjust my datetime, subtract 1 day
Date maxDate = new Date(maxdateTime.getMillis());
Date minDate = new Date(mindateTime.getMillis());

DBCollection coll = db.getCollection("BikeRides");      
coll.ensureIndex( { startTime:1, } )
BasicDBObject query = new BasicDBObject();
query.put("startTime", BasicDBObjectBuilder.start("$gte", minDate).add("$lte", maxDate).get());

DBCursor cursor = coll.find(query);

try {
   while(cursor.hasNext()) {
       System.out.println(cursor.next());
   }
} finally {
   cursor.close();
} 
```

如果我只想查询 GeoLocation，我可以执行以下操作：

```
//A GeoLoc is passed into this method
int distance = 3;
int earthRadius = 3963.192;
DBCollection coll = db.getCollection("BikeRides");      
coll.ensureIndex( { Location.GeoLoc : "2d" } )
db.runCommand( { geoNear: "BikeRides",
                 nearSphere: [ "Location.GeoLoc.latitude": geoLoc.longitude, "Location.GeoLoc.longitude": geoLoc.latitude ]
                 maxDistance: distance / earthRadius
               }  ) 
```

我也和 Jongo 一起尝试过，但没有成功：

```
 DateTime nowDateTime = new DateTime(DateTimeZone.UTC); // Joda time
   DateTime maxStartTime = nowDateTime.plusMinutes(TIME_IN_MINUTES);
   DateTime minStartTime = nowDateTime.minusDays(1); //This will cut out most old bike rides
   Long now = nowDateTime.toInstant().getMillis();
   Long max = maxStartTime.toInstant().getMillis();
   Long min = minStartTime.toInstant().getMillis();
   //Get the objects using Jongo
   MongoCollection bikeRidesCollection =     MongoDatabase.Get_DB_Collection(MONGO_COLLECTIONS.BIKERIDES, "Location.GeoLoc");
   //Currently not placing a limit on this result.  If we find this is an issue we can add later.

   bikeRidesCollection.ensureIndex("{Location.GeoLoc: '2d', RideStartTime: 1}");
   Iterable<BikeRide> all = bikeRidesCollection
          .find("{Location.GeoLoc: {$near: [#, #], $maxDistance: #}, RideStartTime: {$lte: #, $gte: #}}", //, $maxDistance: #
                 location.getGeoLoc().longitude,
                 location.getGeoLoc().latitude,
                 RADIUS_IN_MILES/EarthRadiusInMILES,
                 max ,
                 min )
          .as(BikeRide.class);
   List<BikeRide> closeBikeRides = Lists.newArrayList(all); 
```

我的示例 Json：

```
{
  "BikeRides": [
    {
      "StartTime": "2013-03-08T00:01:00.000 UTC",
      "bikeRideName": "Strawberry Ride",
      "id": "513afc2d0364b81b8abfa86e",
      "location": {
        "city": "Portland",
            "geoLoc": {
          "longitude": "-122.71446990966797",
          "latitude": "45.49216842651367"
        },
        "state": "OR",
        "streetAddress": "4214 SE 36th"
      },
      "startTime": "2013-03-07T16:01:00-08:00"
    }
  ]
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-12T19:53:52.717

解决了。为了让 Jongo 工作，我只需要使用正确的 maxDistance。我应该定义这个，而不是 EarthRadiusInMILES；双 ONE_DEGREE_IN_MILES = 69.11；

注：纬度 1° = 约 69.11 英里

# c# - 让 SortDescription 对字符串进行不同的排序

> ID：15349844
> 
> 赞同：8
> 
> 时间：2013-03-11T22:23:34.830
> 
> 标签：c#, wpf, sorting, gridview

我有以下字符串：

“字符串 1”

“字符串 2”

“字符串 3”

“字符串 15”

“字符串 17”

我希望字符串按上述方式排序。但是，当我使用 SortDescription 对列表进行排序时，会得到以下输出：

“字符串 1”

“字符串 15”

“字符串 17”

“字符串 2”

“字符串 3”

我知道有算法可以做到这一点，但是有没有办法通过 SortDescription 的内置功能来做到这一点？

```
private void SortCol(string sortBy, ListSortDirection direction)
{
        ICollectionView dataView =
          CollectionViewSource.GetDefaultView(ListView.ItemsSource);

        dataView.SortDescriptions.Clear();

        SortDescription sd = new SortDescription(sortBy, direction);
        dataView.SortDescriptions.Add(sd);
        dataView.Refresh();
} 
```

sortby 是我的视图模型中表示我要排序的列的属性的属性名称。

似乎我仅有的两个排序选项是升序和降序。但是它对 CollectionView 进行排序的方式并不是我希望对字符串进行排序的方式。有没有简单的方法来解决这个问题？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-03-11T23:18:47.310

感谢链接：[C#中的自然排序顺序](https://stackoverflow.com/questions/248603/natural-sort-order-in-c-sharp/248613#248613)

```
[SuppressUnmanagedCodeSecurity]
internal static class SafeNativeMethods
{
    [DllImport("shlwapi.dll", CharSet = CharSet.Unicode)]
    public static extern int StrCmpLogicalW(string psz1, string psz2);
}

public sealed class NaturalStringComparer : IComparer<string>
{
    public int Compare(object a, object b)
    {
        var lhs = (MultiItem)a;
        var rhs = (MultiItem)b;
        //APPLY ALGORITHM LOGIC HERE
        return SafeNativeMethods.StrCmpLogicalW(lhs.SiteName, rhs.SiteName);
    }
} 
```

以下是我使用上述算法比较器的方法：

```
 private void SortCol()
    {
        var dataView =
                      (ListCollectionView)CollectionViewSource.GetDefaultView(ListViewMultiSites.ItemsSource);
        dataView.CustomSort = new NaturalOrderComparer();
        dataView.Refresh();
    } 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-12T00:45:58.640

你可以使用 Linq

```
var list = new List<string>
{
   "String 1",
   "String 17",
   "String 2",
   "String 15",
   "String 3gg"
};

var sort = list.OrderBy(s => int.Parse(new string(s.SkipWhile(c => !char.IsNumber(c)).TakeWhile(c => char.IsNumber(c)).ToArray()))); 
```

回报：

```
 "String 1",
   "String 2",
   "String 3gg"
   "String 15",
   "String 17", 
```

# oracle - 主机/变量未声明问题 - 但脚本中没有声明/变量

> ID：15349848
> 
> 赞同：0
> 
> 时间：2013-03-11T22:24:07.283
> 
> 标签：oracle, variables

我正在编写一个基本的插入脚本，并在一开始尝试删除我稍后插入的内容，以便脚本可以多次运行。下面是一小部分代码。我收到如下错误：“无效的主机/绑定变量名”和“未声明绑定变量“SELECTIONS”。”

前任：

```
SET DEFINE OFF

DELETE FROM SELECTIONS WHERE DATAFIELD IN ('ba', 'bb', 'bc', 'bd');

DELETE FROM SELECTION_LOCALE WHERE DATAFIELD IN ('ba', 'bb', 'bc', 'bd');

COMMIT;

INSERT INTO SELECTIONS (SELECTIONS_ID, DATAFIELD, DESCRIPTION) VALUES ('CATCHANGE', 'ba', 'PI&D Library');

INSERT INTO SELECTIONS (SELECTIONS_ID, DATAFIELD, DESCRIPTION) VALUES ('CATCHANGE', 'bb', 'Non-conformance');

INSERT INTO SELECTIONS (SELECTIONS_ID, DATAFIELD, DESCRIPTION) VALUES ('CATCHANGE', 'bc', 'Alternative Route');

COMMIT; 
```

有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-11T22:43:44.960

它认为 PI&D 是一个绑定变量。但通常 SET DEFINE OFF 可以解决这个问题。尝试在 SET DEFINE OFF 后添加分号

# php - 是否可以通过多个冒号访问 php 变量/常量？

> ID：15349850
> 
> 赞同：0
> 
> 时间：2013-03-11T22:24:23.160
> 
> 标签：php, syntax

我知道可以嵌套数组或对象并像这样访问它们：

```
some_array["sub_type1"]["value"] 
```

或者

```
some_object->sub_type1->value 
```

但是是否也可以使用某种嵌套的常量值并像这样访问它们？

```
SOME_CLASS::SUB_TYPE::MORE_SUBTYPES::VALUE 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-11T22:30:15.730

为您的子类型使用类继承，并在相应的子类型类定义中定义常量。

```
<?php
class Someclass {}
class Someclass_Subtype extends Someclass {}
class Someclass_Subtype_Child extends Someclass_Subtype
{
    const VALUE = 'whatever';
} 
```

# django - 在 django 模板中通过外国 id 获取元素

> ID：15349855
> 
> 赞同：-1
> 
> 时间：2013-03-11T22:24:55.433
> 
> 标签：django, django-templates

如何通过 id 获取模板中列表的值？

我的意思是，我有两个带有外国列的表。让我们说：

```
Author (id, foreign_id, name)
Country (id, name) 
```

在一个视图中，我收集数据

```
var1 = Author.objects.filter(name='Robert')
var2 = Author.objects.filter(name='Jacky')
country = Country.objects.all() 
```

并将它们全部传递给模板。

此刻我只是想不通，我怎么能通过他们的foreign_id 获得Roberts 或Jackys 的国家？

我能想象的唯一想法是每次在模板中遍历整个国家列表，但它看起来不是很聪明。

附言。我敢肯定，有这样的问题，不幸的是，即使半小时后谷歌也没有给我任何东西。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-11T22:30:40.687

您无需通过他们的 ID 获取他们。你有他们的外键属性。您还没有显示实际模型，这本来会更有用，但假设 ForeignKey 被称为`country`您只需这样做：

```
{{ jackie.country.name }} 
```

# xslt - 为具有不同名称和不同@class 属性值的多个元素创建一个包装器元素

> ID：15349864
> 
> 赞同：2
> 
> 时间：2013-03-11T22:25:47.637
> 
> 标签：xslt, xslt-2.0, xslt-grouping

**我有以下平面 XML 结构**

```
<div class="section-level-1">

  <!-- other elements -->

  <p class="para">
    <img src="..." alt="..." title="..." />
  </p>
  <p class="figure-caption-german">
    <img src="..." alt="..." title="..." />
  </p>
  <p class="figure-caption-english">
    <img src="..." alt="..." title="..." />
  </p>

  <!-- other elements -->

  <p class="para">
    <img src="..." alt="..." title="..." />
  </p>
  <p class="figure-caption-german">
    <img src="..." alt="..." title="..." />
  </p>
  <misc-element>...</misc-element>
  <p class="figure-caption-english">
    <img src="..." alt="..." title="..." />
  </p>
</div> 
```

这些元素的顺序总是相同的（para -> figure-caption-german -> figure-caption-english），但是我不能排除它会被其他元素（这里是 misc-element）打断。

**我想将这三个元素包装在一个元素中**

```
<div class="section-level-1">

  <!-- other elements -->

  <div class="figure">
    <p class="para">
      <img src="..." alt="..." title="..." />
    </p>
    <p class="figure-caption-german">
      <img src="..." alt="..." title="..." />
    </p>
    <p class="figure-caption-english">
      <img src="..." alt="..." title="..." />
    </p>
  </div>

  <!-- other elements -->

  <div class="figure">
    <p class="para">
      <img src="..." alt="..." title="..." />
    </p>
    <p class="figure-caption-german">
      <img src="..." alt="..." title="..." />
    </p>
    <p class="figure-caption-english">
      <img src="..." alt="..." title="..." />
    </p>
  </div>
</div> 
```

中断元素不需要保留，可以删除。

**到目前为止我所拥有的**

```
<xsl:template match="/">
  <xsl:apply-templates />
</xsl:template>

<!-- Html Ninja Pattern -->

<xsl:template match="*">
  <xsl:element name="{name()}">
    <xsl:apply-templates select="* | @* | text()"/>
  </xsl:element>
</xsl:template>

<xsl:template match="body//@*">
  <xsl:attribute name="{name(.)}">
    <xsl:value-of select="."/>
  </xsl:attribute>
</xsl:template>

<!-- Modify certain elements -->

<xsl:template match="" priority="1">
  <!-- do something -->
</xsl:template> 
```

作为一个基本模式，我借鉴了“Html Ninja Technique”（[http://getsymphony.com/learn/articles/view/html-ninja-technique/](http://getsymphony.com/learn/articles/view/html-ninja-technique/)），因为它允许我只处理那些我需要转换的特定元素，而将所有其他元素不变地发送到输出树。到目前为止，一切正常，但现在我似乎真的遇到了障碍。我什至不确定是否可以依靠“Html Ninja Technique”来完成所需的任务。

任何帮助或指示将不胜感激。

最好的问候，谢谢你，马蒂亚斯·艾因布罗德

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-12T00:32:42.810

这有点涉及，但我认为应该这样做：

```
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
  <xsl:output method="xml" indent="yes"/>

  <xsl:template match="*" name="Copy">
    <xsl:element name="{name()}">
      <xsl:apply-templates select="* | @* | text()"/>
    </xsl:element>
  </xsl:template>

  <xsl:template match="@*">
    <xsl:attribute name="{name(.)}">
      <xsl:value-of select="."/>
    </xsl:attribute>
  </xsl:template>

  <xsl:template match="div[starts-with(@class, 'section-level')]">
    <xsl:copy>
      <xsl:apply-templates select="@*" />
      <!-- Apply templates to paras and anything with no preceding sibling
           or with a figure-caption-english preceding sibling-->
      <xsl:apply-templates select="p[@class = 'para'] | 
                                 *[not(preceding-sibling::*) or
                                    preceding-sibling::*[1][self::p]
                                      [@class = 'figure-caption-english']
                                  ]"
                           mode="iter"/>
    </xsl:copy>
  </xsl:template>

  <xsl:template match="p[@class = 'para']" mode="iter">
    <div class="figure">
      <xsl:call-template name="Copy" />
      <!-- Apply templates to the next english and german figure captions -->
      <xsl:apply-templates
        select="following-sibling::p[@class = 'figure-caption-german'][1] |
                following-sibling::p[@class = 'figure-caption-english'][1]" />
    </div>
  </xsl:template>

  <xsl:template match="*" mode="iter">
    <xsl:call-template name="Copy" />
    <xsl:apply-templates 
        select="following-sibling::*[1]
                      [not(self::p[@class = 'para'])]"
        mode="iter"/>
  </xsl:template>
</xsl:stylesheet> 
```

应用于此示例数据时：

```
<div class="section-level-1">

  <!-- other elements -->
  <div>hello</div>
  <div>hello</div>
  <div>hello</div>
  <div>hello</div>
  <p class="para">
    <img src="..." alt="..." title="..." />
  </p>
  <p class="figure-caption-german">
    <img src="..." alt="..." title="..." />
  </p>
  <p class="figure-caption-english">
    <img src="..." alt="..." title="..." />
  </p>

  <!-- other elements -->
  <div>hello</div>
  <div>hello</div>
  <div>hello</div>

  <p class="para">
    <img src="..." alt="..." title="..." />
  </p>
  <p class="figure-caption-german">
    <img src="..." alt="..." title="..." />
  </p>
  <misc-element>...</misc-element>
  <p class="figure-caption-english">
    <img src="..." alt="..." title="..." />
  </p>
  <div>hello</div>
  <div>hello</div>
  <div>hello</div>
</div> 
```

它产生：

```
<div class="section-level-1">
  <div>hello</div>
  <div>hello</div>
  <div>hello</div>
  <div>hello</div>
  <div class="figure">
    <p class="para">
      <img src="..." alt="..." title="..." />
    </p>
    <p class="figure-caption-german">
      <img src="..." alt="..." title="..." />
    </p>
    <p class="figure-caption-english">
      <img src="..." alt="..." title="..." />
    </p>
  </div>
  <div>hello</div>
  <div>hello</div>
  <div>hello</div>
  <div class="figure">
    <p class="para">
      <img src="..." alt="..." title="..." />
    </p>
    <p class="figure-caption-german">
      <img src="..." alt="..." title="..." />
    </p>
    <p class="figure-caption-english">
      <img src="..." alt="..." title="..." />
    </p>
  </div>
  <div>hello</div>
  <div>hello</div>
  <div>hello</div>
</div> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-12T22:53:26.457

这是另一种方法。这确实涉及迭代**div**的子元素，但也使用**xsl:key**对相关的**p**元素进行分组。

首先，定义一个键来按第一个最前面的“para”元素对“figure-caption”元素进行分组：

```
<xsl:key name="para" 
     match="p[starts-with(@class, 'figure-caption')]" 
     use="generate-id(preceding-sibling::p[@class='para'][1])"/> 
```

然后，首先匹配**div**元素，然后选择第一个元素

```
<xsl:template match="div">
   <div>
      <xsl:apply-templates select="node()[1]" mode="iterate"/>
   </div>
</xsl:template> 
```

模式**迭代**用于指示将递归匹配其后续兄弟的模板。您首先需要一个模板来匹配“para”元素，您可以在其中使用键对相关元素进行分组

```
<xsl:template match="p[@class='para']" mode="iterate">
   <div class="figure">
      <xsl:apply-templates select=".|key('para', generate-id())" mode="group"/>
   </div> 
```

（此处的模式**组**将用于指示对于分组的元素，匹配模板将仅输出它们，但不会在下一个兄弟处进行处理。您可以在这里使用**xsl:copy-of**替代）

然后在此模板中，通过选择组中最后一个元素之后的节点来进行迭代

```
<xsl:apply-templates 
     select="key('para', generate-id())[last()]/following-sibling::node()[1]" mode="iterate"/> 
```

然后可以将迭代中的其他元素与更通用的模板匹配以复制它们，并在下一个兄弟元素处继续

```
<xsl:template match="node()" mode="iterate">
   <xsl:call-template name="identity"/>
   <xsl:apply-templates select="following-sibling::node()[1]" mode="iterate"/>
</xsl:template> 
```

**这里的身份**将调用身份模板。

这是完整的 XSLT

```
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
   <xsl:output method="xml" indent="yes"/>
   <xsl:key name="para" match="p[starts-with(@class, 'figure-caption')]" use="generate-id(preceding-sibling::p[@class='para'][1])"/>

   <xsl:template match="div">
      <div>
         <xsl:copy-of select="@*"/>
         <xsl:apply-templates select="node()[1]" mode="iterate"/>
      </div>
   </xsl:template>

   <xsl:template match="p[@class='para']" mode="iterate">
      <div class="figure">
         <xsl:apply-templates select=".|key('para', generate-id())" mode="group"/>
      </div>
      <xsl:apply-templates select="key('para', generate-id())[last()]/following-sibling::node()[1]" mode="iterate"/>
   </xsl:template>

   <xsl:template match="node()" mode="group">
      <xsl:call-template name="identity"/>
   </xsl:template>

   <xsl:template match="node()" mode="iterate">
      <xsl:call-template name="identity"/>
      <xsl:apply-templates select="following-sibling::node()[1]" mode="iterate"/>
   </xsl:template>

   <xsl:template match="@*|node()" name="identity">
      <xsl:copy>
         <xsl:apply-templates select="@*|node()"/>
      </xsl:copy>
   </xsl:template>
</xsl:stylesheet> 
```

应用于您的示例 XML 时，将输出以下内容

```
<div class="section-level-1">
   <!-- other elements -->
   <div class="figure">
      <p class="para">
         <img src="..." alt="..." title="..."/>
      </p>
      <p class="figure-caption-german">
         <img src="..." alt="..." title="..."/>
      </p>
      <p class="figure-caption-english">
         <img src="..." alt="..." title="..."/>
      </p>
   </div>
   <!-- other elements -->
   <div class="figure">
      <p class="para">
         <img src="..." alt="..." title="..."/>
      </p>
      <p class="figure-caption-german">
         <img src="..." alt="..." title="..."/>
      </p>
      <p class="figure-caption-english">
         <img src="..." alt="..." title="..."/>
      </p>
   </div>
</div> 
```

这种方法的一个优点是您可以将除英语和德语之外的其他语言混合使用，它应该仍然可以工作，并且语言的顺序也无关紧要。（当然，你可能想忽略其他语言，在这种情况下它就行不通了！）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-13T04:15:56.580

**一个*简单*的XSLT 2.0 解决方案**：

```
<xsl:stylesheet version="2.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
 <xsl:output omit-xml-declaration="yes" indent="yes"/>
 <xsl:strip-space elements="*"/>
 <xsl:param name="pClasses" select=
 "'para', 'figure-caption-german', 'figure-caption-english'"/>

 <xsl:template match="node()|@*">
  <xsl:copy>
   <xsl:apply-templates select="node()|@*"/>
  </xsl:copy>
 </xsl:template>

 <xsl:template match="/*">
  <xsl:copy>
   <xsl:apply-templates select="@*"/>

   <xsl:for-each-group select="p[@class=$pClasses]"
     group-starting-with="p[@class eq $pClasses[1]]">
     <div class="figure">
       <xsl:apply-templates select="current-group()"/>
     </div>
    </xsl:for-each-group>
  </xsl:copy>
 </xsl:template>
</xsl:stylesheet> 
```

**当此转换应用于提供的 XML 文档时：**

```
<div class="section-level-1">

  <!-- other elements -->

  <p class="para">
    <img src="..." alt="..." title="..." />
  </p>
  <p class="figure-caption-german">
    <img src="..." alt="..." title="..." />
  </p>
  <p class="figure-caption-english">
    <img src="..." alt="..." title="..." />
  </p>

  <!-- other elements -->

  <p class="para">
    <img src="..." alt="..." title="..." />
  </p>
  <p class="figure-caption-german">
    <img src="..." alt="..." title="..." />
  </p>
  <misc-element>...</misc-element>
  <p class="figure-caption-english">
    <img src="..." alt="..." title="..." />
  </p>
</div> 
```

**产生了想要的正确结果：**

```
<div class="section-level-1">
   <div class="figure">
      <p class="para">
         <img src="..." alt="..." title="..."/>
      </p>
      <p class="figure-caption-german">
         <img src="..." alt="..." title="..."/>
      </p>
      <p class="figure-caption-english">
         <img src="..." alt="..." title="..."/>
      </p>
   </div>
   <div class="figure">
      <p class="para">
         <img src="..." alt="..." title="..."/>
      </p>
      <p class="figure-caption-german">
         <img src="..." alt="..." title="..."/>
      </p>
      <p class="figure-caption-english">
         <img src="..." alt="..." title="..."/>
      </p>
   </div>
</div> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-13T10:39:55.643

基于 JLRishe 的解决方案，我受到启发，使用不同的模板模式来实现该问题的多通道解决方案。

**给定以下平面 XML 结构**

```
<div class="section-level-1">

  <!-- other elements -->

  <p class="para">
    <img src="..." alt="..." title="..." />
  </p>
  <p class="figure-caption-german">
    <img src="..." alt="..." title="..." />
  </p>
  <p class="figure-caption-english">
    <img src="..." alt="..." title="..." />
  </p>

  <!-- other elements -->

  <p class="para">
    <img src="..." alt="..." title="..." />
  </p>
  <p class="figure-caption-german">
    <img src="..." alt="..." title="..." />
  </p>
  <misc-element>...</misc-element>
  <p class="figure-caption-english">
    <img src="..." alt="..." title="..." />
  </p>
</div> 
```

**我应用了以下方法。**

```
<xsl:template match="/">
  <xsl:variable name="pass0">
    <xsl:apply-templates mode="pass0" />
  </xsl:variable>

  <xsl:variable name="pass1">
    <xsl:for-each select="$pass0">
      <xsl:apply-templates mode="pass1" />
    </xsl:for-each>
  </xsl:variable>

  <xsl:copy-of select="$pass1" />        
</xsl:template>

<!--###############
    ### Pass 0 #### 
    ###############-->

<xsl:template match="*" mode="pass0">
  <xsl:element name="{name()}">
    <xsl:apply-templates select="* | @* | text()" mode="pass0"/>
  </xsl:element>
</xsl:template>

<xsl:template match="@*" mode="pass0">
  <xsl:attribute name="{name(.)}">
    <xsl:value-of select="."/>
  </xsl:attribute>
</xsl:template>

<!-- wraps figures and their associated captions within <div class="figure"> element -->
<xsl:template match="p[@class = 'para'][img]" mode="pass0" priority="1">
  <div class="figure">
    <xsl:copy-of select="./img" />
      <xsl:apply-templates 
        select="following-sibling::p[@class = 'figure-caption-german'][1] |
                following-sibling::p[@class = 'figure-caption-english'][1]" 
        mode="fig- captions-pass0" />
  </div>
</xsl:template>

<xsl:template match="*" mode="fig-captions-pass0" priority="1">
  <xsl:copy-of select="." />
</xsl:template>

<!--###############
    ### Pass 1 #### 
    ###############-->

<xsl:template match="*" mode="pass1">
  <xsl:element name="{name()}">
    <xsl:apply-templates select="* | @* | text()" mode="pass1"/>
  </xsl:element>
</xsl:template>

<xsl:template match="@*" mode="pass1">
  <xsl:attribute name="{name(.)}">
    <xsl:value-of select="."/>
  </xsl:attribute>
</xsl:template>

<!-- removes all elements with figure captions that don't reside within <div class="figure"> element and all other unnecessary elements -->
<xsl:template match="
  p[@class = 'figure-caption-german'][not(parent::div[@class = 'figure'])] |
  p[@class = 'figure-caption-english'][not(parent::div[@class = 'figure'])] |
  misc-element" 
  mode="pass1" priority="1" /> 
```

**结果我得到了想要的输出**

```
<div class="section-level-1">

  <p class="para">normal paragraph etc.</p>
  <p class="para">normal paragraph etc.</p>
  <p class="para">normal paragraph etc.</p>

  <div class="figure">
    <img src="..." alt="..." title="..."></img>
    <p class="figure-caption-german">
      figure caption in german
    </p>
    <p class="figure-caption-english">
      figure caption in english
    </p>
  </div>

  <p class="para">normal paragraph etc.</p>
  <p class="para">normal paragraph etc.</p>
  <p class="para">normal paragraph etc.</p>

  <div class="figure">
    <img src="..." alt="..." title="..."></img>
    <p class="figure-caption-german">
      figure caption in german
    </p>
    <p class="figure-caption-english">
      figure caption in english 
    </p>
  </div>
</div> 
```

# jquery - 延迟加载 Facebook Like 按钮脚本

> ID：15349867
> 
> 赞同：6
> 
> 时间：2013-03-11T22:26:07.793
> 
> 标签：jquery, facebook, deferred-loading

Google pagespeed 抱怨我的 facebook 喜欢按钮脚本。如何推迟脚本？

> 在初始页面加载期间解析 45KiB 的 JavaScript。延迟解析 JavaScript 以减少页面呈现的阻塞。 [http://static.ak.facebook.com/.../xd_arbiter.php](http://static.ak.facebook.com/.../xd_arbiter.php) ?...（21KiB 的内联 JavaScript）[https://s-static.ak.facebook.com/.../xd_arbiter.php](https://s-static.ak.facebook.com/.../xd_arbiter.php) ?...（21KiB 内联 JavaScript）[http://www.facebook.com/.../like.php](http://www.facebook.com/.../like.php) ?...（3KiB 内联 JavaScript）

这是我正在使用的代码，我将其加载到页面页脚的 .js 文件中。

```
(function(d,s,id){
        var js,fjs = d.getElementsByTagName(s)[0];
        if(d.getElementById(id)){return;}
        js=d.createElement(s);
        js.id=id;
        js.async=true;
        js.defer=true;//THIS DOES NOT APPEAR TO SATISFY PAGESPEED
        js.src="//connect.facebook.net/en_US/all.js#xfbml=1";
        fjs.parentNode.insertBefore(js,fjs);
    }
    (document, "script", "facebook-jssdk")
); 
```

产生以下脚本标签（通过 Chrome 的检查器）：

```
 <script 
    id="facebook-jssdk" 
    async="" 
    defer="" 
    src="//connect.facebook.net/en_US/all.js#xfbml=1"></script> 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-03-13T05:55:17.337

使用 setTimeout 卢克！

```
setTimeout( function () {
   (function(d,s,id){
         // load js
         ...
      }
      (document, "script", "facebook-jssdk")
   );
}, 3000); 
```

您可以将负载放入另一个“线程”以异步或延迟它

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2014-10-17T13:31:41.890

setTimeout 有效，但它不是真正的延迟，因为如果页面在设置的时间（在本例中为 3 秒）之后完成加载，则将在页面完成加载之前加载喜欢按钮。

我将like按钮的javscript代码放在我自己的函数中，并将其嵌套在

```
<script>
    function FbButtonLoad(){
      (function(d,s,id){
         // load js
         ...
      }
      (document, "script", "facebook-jssdk")
   );
}
</script> 
```

然后我将它设置在 body 标记中以在页面加载时运行：

```
<body onload="FbButtonLoad();"> 
```

该按钮出现在我离开它的容器的页面上：

```
<div id="fb-root"></div>
<div class="fb-like" data-send="true" data-width="350" data-show-faces="true"></div> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-03-04T16:05:30.793

另一个不太完美的解决方案（仅限 HTML5）是在 DOMContentLoaded 上加载库。

```
document.addEventListener('DOMContentLoaded', function() {
    (function(d,s,id){
        var js,fjs = d.getElementsByTagName(s)[0];
        if(d.getElementById(id)){return;}
        js=d.createElement(s);
        js.id=id;
        js.src="//connect.facebook.net/en_US/all.js#xfbml=1";
        fjs.parentNode.insertBefore(js,fjs);
    }
    (document, "script", "facebook-jssdk")
); 
```

# ruby-on-rails - Gem:Module (NoMethodError) 的未定义方法“source_index”

> ID：15349869
> 
> 赞同：132
> 
> 时间：2013-03-11T22:26:15.280
> 
> 标签：ruby-on-rails, ruby-on-rails-2

我正在运行 Rails 2.3.5 应用程序并在运行脚本/服务器时显示以下内容：

```
./script/../config/../vendor/rails/railties/lib/rails/gem_dependency.rb:21:in `add_frozen_gem_path': undefined method `source_index' for Gem:Module (NoMethodError)
    from ./script/../config/boot.rb:60:in `load_initializer'
    from ./script/../config/boot.rb:44:in `run'
    from ./script/../config/boot.rb:17:in `boot!'
    from ./script/../config/boot.rb:123
    from script/server:2:in `require'
    from script/server:2 
```

如果我注释掉 boot.rb (Rails::GemDependency.add_frozen_gem_path) 中的第 60 行并运行脚本/服务器，我会得到：

```
=> Booting WEBrick
=> Rails 2.3.5 application starting on http://0.0.0.0:3000
./script/../config/../vendor/rails/railties/lib/rails/gem_dependency.rb:21:in `add_frozen_gem_path': undefined method `source_index' for Gem:Module (NoMethodError)
    from ./script/../config/../vendor/rails/railties/lib/initializer.rb:298:in `add_gem_load_paths'
    from ./script/../config/../vendor/rails/railties/lib/initializer.rb:132:in `process'
    from ./script/../config/../vendor/rails/railties/lib/initializer.rb:113:in `send'
    from ./script/../config/../vendor/rails/railties/lib/initializer.rb:113:in `run'
    from /home/developer/bigpink/config/environment.rb:13
    from /home/developer/bigpink/vendor/rails/activesupport/lib/active_support/dependencies.rb:156:in `require'
    from /home/developer/bigpink/vendor/rails/activesupport/lib/active_support/dependencies.rb:156:in `require'
    from /home/developer/bigpink/vendor/rails/activesupport/lib/active_support/dependencies.rb:521:in `new_constants_in'
    from /home/developer/bigpink/vendor/rails/activesupport/lib/active_support/dependencies.rb:156:in `require'
    from /home/developer/bigpink/vendor/rails/railties/lib/commands/server.rb:84
    from script/server:3:in `require'
    from script/server:3 
```

所以，真的不知道该怎么办。希望我能得到一些快速的帮助。谢谢！

* * *

## 回答 #1

> 赞同：297
> 
> 时间：2013-03-12T00:53:58.027

我自己在尝试将旧版 Rails 应用程序从 REE 1.8.7 升级到 1.9.3-p385 时遇到了这个问题。奇怪的是，Ruby 1.9.3-p327 工作得很好。归根结底，ruby-1.9.3-p385 为我安装了 RubyGems 2.0.2 版，而 1.9.3-p327 安装了 RubyGems v1.8.23。

`Gem.source_index`已经被弃用了一段时间，但由于 Rails 2.3 除了关键的安全补丁之外没有得到任何更新，这永远不会得到修复。RubyGems v2.0 最终删除了该方法。降级到`rubygems`2.0.0 之前的任何版本，例如 1.8.25 以暂时恢复功能。您可以使用`gem update --system 1.8.25`.

顺便说一句，Rails 2.3.5 至少需要更新到 2.3.17。有一些严重的安全漏洞会让您面临一些非常讨厌的攻击。从长远来看，升级到 3.x 需要被视为非常强烈的需求。

* * *

## 回答 #2

> 赞同：31
> 
> 时间：2014-07-02T11:34:21.227

对于 rvm 用户，

```
rvm install rubygems 1.8.2 --force 
```

* * *

## 回答 #3

> 赞同：26
> 
> 时间：2013-03-25T22:20:14.763

这对我有帮助：http: [//djellemah.com/blog/2013/02/27/rails-23-with-ruby-20/](http://djellemah.com/blog/2013/02/27/rails-23-with-ruby-20/)

我与 结合使用了此功能`gem update --system 1.8.25`，您的情况可能不需要。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2019-07-11T10:53:50.257

另一种方法是安装 slimgems: `gem install slimgems`. 这是 RubyGems 的一个插入式分支，可以更好地与旧版本配合使用。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2020-08-10T12:57:25.410

更新：除了@uxp 的回答，如果你在运行 Catalina 的 Mac 上运行这个命令，命令有一个小的变化，你需要添加 -n。

所以命令是`sudo gem update --system -n 1.8.25`

# php - SQL Query 使用 PHP 显示 x 和 y 之间的所有数字

> ID：15349873
> 
> 赞同：2
> 
> 时间：2013-03-11T22:26:31.890
> 
> 标签：php, sql

使用`html FORM`let's convert `$core`in `100`and `$mhz`in `1000`
`emag`and `koyos`are table rows
So if `$core`is set `$parameters['emag'] = "$core";`is `emag=100`else it is `null`
`AND`and `WHERE`are dinamicly set to appear,所以问题是我收集了变量的所有数据`$parameters[]`和`foreach()`它们。
使用我的代码，我得到了确切`$core`的信息。这是代码：

```
if (!empty($core)) {
$parameters['emag'] = "$core";

}
if (!empty($mhz)) {
$parameters['koyos'] = $mhz;
  }

$sql = "SELECT * FROM $tbl_name WHERE 1=1 ";
if (!empty($parameters)) {
foreach ($parameters as $k => $v) {
    $sql .= " AND " . $k . "='" . $v . "'";
}
  }
$sql .= " ORDER BY emag, performanta_cpu_core DESC, performanta_cpu DESC LIMIT $start, $limit"; 
```

结果只是带有 的行，`emag=100`但我需要所有数字都等于或小于`100``100`

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-11T22:39:15.403

根据您提供的数据，您的查询条件是：

`WHERE 1=1 AND emag = '100' AND koyos = '1000'`

所以显然只会显示`emag`=的行`100`。如果要显示所有这些内容，请`100`更改`=`为`<=`表名称为`emag`：

```
foreach ($parameters as $k => $v) {

    if ($k == 'emag')
    {
        $sql .= " AND " . $k . "<='" . $v . "'";
    }

    else
    {
        $sql .= " AND " . $k . "='" . $v . "'";
    }

} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-11T22:38:36.707

试试这个：

```
foreach ($parameters as $k => $v) {

    if ($k == 'emag') {
        $sql .= " AND " . $k . "<='" . $v . "'";
        continue;
    }

    $sql .= " AND " . $k . "='" . $v . "'";
} 
```

# c++ - Expat 未解析的外部符号

> ID：15349876
> 
> 赞同：1
> 
> 时间：2013-03-11T22:26:40.313
> 
> 标签：c++, linker-errors, unresolved-external, xmp

在共享库（它是一个 firefox xpcom 组件）中链接静态库（包含 expat 的 XMP）时，我很难找到为什么我有未解析的外部符号。

我在使用 Windows 编译器（标志：“-Od -MDd”）和 mozilla-firefox 14 的 Windows 下。

静态库是来自 Adob​​e XMP 的 SDK 的 XMPCore 库：构建它没有问题（expat 的源代码包含在第三方库中）

在构建我的 xpcom 模块时，我在链接阶段得到了这个：

> *symbole externe non résolu 表示未解析的外部符号！*

```
 xmpcore.lib(ExpatAdapter.obj) : error LNK2019: symbole externe non résolu __imp__XML_SetCommentHandler référencé dans la fonction "public: __thiscall
ExpatAdapter::ExpatAdapter(bool)" (??0ExpatAdapter@@QAE@_N@Z)
xmpcore.lib(ExpatAdapter.obj) : error LNK2019: symbole externe non résolu __imp__XML_SetProcessingInstructionHandler référencé dans la fonction "publi
c: __thiscall ExpatAdapter::ExpatAdapter(bool)" (??0ExpatAdapter@@QAE@_N@Z)
xmpcore.lib(ExpatAdapter.obj) : error LNK2019: symbole externe non résolu __imp__XML_SetCdataSectionHandler référencé dans la fonction "public: __this
call ExpatAdapter::ExpatAdapter(bool)" (??0ExpatAdapter@@QAE@_N@Z)
xmpcore.lib(ExpatAdapter.obj) : error LNK2019: symbole externe non résolu __imp__XML_SetCharacterDataHandler référencé dans la fonction "public: __thi
scall ExpatAdapter::ExpatAdapter(bool)" (??0ExpatAdapter@@QAE@_N@Z)
xmpcore.lib(ExpatAdapter.obj) : error LNK2019: symbole externe non résolu __imp__XML_SetElementHandler référencé dans la fonction "public: __thiscall
ExpatAdapter::ExpatAdapter(bool)" (??0ExpatAdapter@@QAE@_N@Z)
xmpcore.lib(ExpatAdapter.obj) : error LNK2019: symbole externe non résolu __imp__XML_SetNamespaceDeclHandler référencé dans la fonction "public: __thi
scall ExpatAdapter::ExpatAdapter(bool)" (??0ExpatAdapter@@QAE@_N@Z)
xmpcore.lib(ExpatAdapter.obj) : error LNK2019: symbole externe non résolu __imp__XML_SetUserData référencé dans la fonction "public: __thiscall ExpatA
dapter::ExpatAdapter(bool)" (??0ExpatAdapter@@QAE@_N@Z)
xmpcore.lib(ExpatAdapter.obj) : error LNK2019: symbole externe non résolu __imp__XML_ParserCreateNS référencé dans la fonction "public: __thiscall Exp
atAdapter::ExpatAdapter(bool)" (??0ExpatAdapter@@QAE@_N@Z)
xmpcore.lib(ExpatAdapter.obj) : error LNK2019: symbole externe non résolu __imp__XML_ParserFree référencé dans la fonction "public: virtual __thiscall
 ExpatAdapter::~ExpatAdapter(void)" (??1ExpatAdapter@@UAE@XZ)
xmpcore.lib(ExpatAdapter.obj) : error LNK2019: symbole externe non résolu __imp__XML_Parse référencé dans la fonction "public: virtual void __thiscall
 ExpatAdapter::ParseBuffer(void const *,unsigned int,bool)" (?ParseBuffer@ExpatAdapter@@UAEXPBXI_N@Z)
xmp.dll : fatal error LNK1120: 10 externes non résolus 
```

所以我认为我的 XMP 的静态构建中缺少来自 expat 的那些函数，所以我使用 objdump -t 检查列出我发现的符号：

```
 ../third-party/expat/lib/xmlparse.obj:     file format pe-i386

SYMBOL TABLE:
...
[109](sec  5)(fl 0x00)(ty  20)(scl   2) (nx 0) 0x00000ff0 _XML_SetCommentHandler
...

../XMPCore/source/ExpatAdapter.obj:     file format pe-i386

SYMBOL TABLE:
...
[251](sec  0)(fl 0x00)(ty   0)(scl   2) (nx 0) 0x00000000 __imp__XML_SetCommentHandler
... 
```

包括这些功能的实现，所以我需要提示：有人可以帮我吗？

谢谢 ！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-12T09:20:26.577

我发现了我的错误：Adobe XMP SDK 的自述文件不完整，因为如果您想使用 expat (-DXML_STATIC) 构建静态库，他们忘记在编译阶段定义 XML_STATIC。希望它可以帮助其他有同样问题的人

# nsstring - 以 NSString 作为名称声明 NSDictionary

> ID：15349877
> 
> 赞同：0
> 
> 时间：2013-03-11T22:26:42.187
> 
> 标签：nsstring, nsdictionary, declaration

好的，所以我想创建一个 NSDictionary，但是指针后面应该是用户输入的 NSString 的值。这可能吗？我想这将是类似的事情......

```
someNSString = _someTextField.text;
NSDictionary * {someNSString} = [NSDictionary dictionaryWithObjectsAndKeys:
[NSNumber numberWithInt:someUnimportantVariable], @"someUnimportantKey",...nil] 
```

在此先感谢，我意识到这要么完全不可能，要么有一个非常简单的解决方案。不管怎样，如果我浪费了你的时间，我很抱歉。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-11T22:36:35.700

您可以尝试创建一个“词典词典”。大意是：

```
someNSString = _someTextField.text;
NSDictionary *myDictionary = [[NSDictionary alloc] init];
[myDictionary setObject:[NSDictionary dictionaryWithObjectsAndKeys: [NSNumber numberWithInt:someUnimportantVariable], @"someUnimportantKey",...nil] forKey:someNSString]; 
```

如果你想取回那本字典

```
NSDictionary someNSStringDictionary = [myDictionary objectForKey:someNSString]; 
```

让我知道它是否有任何帮助。

# scala - Scala 类型推断限制

> ID：15349878
> 
> 赞同：3
> 
> 时间：2013-03-11T22:26:50.517
> 
> 标签：scala, types

我正在 ReactiveMongo 之上开发一个 ORM 风格的库。目前我已经尝试实现嵌套文档表示 - 但是我一直坚持使用 Scala 对我的班级进行类型推断。我对 Scala 很陌生，所以欢迎大家提供帮助。

这是我的尝试：

```
trait MongoDocument[T <: MongoDocument[T]] {
  self: T =>

  val db: DefaultDB
  val collection: String

  var fields: List[MongoField[T,_]] = List.empty
  def apply(doc: TraversableBSONDocument): T = { // loads the content of supplied document
    fields.foreach { field =>
      doc.get(field.field).foreach(field.load(_))
    }
    this
  }
}
trait MongoMetaDocument[T <: MongoDocument[T]] extends MongoDocument[T] {
  self: T =>

  type DocType = T

  protected val clazz = this.getClass.getSuperclass
  def create: T = clazz.newInstance().asInstanceOf[T]

  def find(id: String): Future[Option[T]] = {
    db(collection).find(BSONDocument("_id" -> BSONObjectID(id)))
      .headOption().map(a => a.map(create.apply(_)))
  }
}

abstract class MongoField[Doc <: MongoDocument[Doc], T](doc: MongoDocument[Doc], val field: String) {
  var value: Option[T] = None

  def is: Option[T] = value
  def apply(in: T) { value = Some(in) }
  def unset() { value = None }

  def load(bson: BSONValue)

  doc.fields ::= this
}

class MongoInteger[Doc <: MongoDocument[Doc]](doc: Doc, field: String)
  extends MongoField[Doc, Int](doc, field) {

  def load(bson: BSONValue) { value = Try(bson.asInstanceOf[BSONNumberLike].toInt).toOption }
}

class MongoDoc[Doc <: MongoDocument[Doc], SubDocF <: MongoMetaDocument[SubDoc], SubDoc <: MongoDocument[SubDoc]](doc: Doc, field: String, meta: SubDocF)
  extends MongoField[Doc, SubDocF#DocType](doc, field) {

  def load(bson: BSONValue) {
    value = Try(bson.asInstanceOf[TraversableBSONDocument]).toOption.map { doc =>
       meta.create.apply(doc)
    }
  }
} 
```

假设我有以下代码：

```
class SubEntity extends MongoDocument[SubEntity] {
  val db = Db.get
  val collection = ""

  val field = new MongoInteger(this, "field")
}
object SubEntity extends SubEntity with MongoMetaDocument[SubEntity] 
```

我想写另一个实体：

```
class Another extends MongoDocument[Another] {
  val db = Db.get
  val collection = "test"

  val subEntity = new MongoDoc(this, "subEntity", SubEntity)
}
object Another extends Another with MongoMetaDocument[Another] 
```

哪里`Db.get`只返回一个`DefaultDB`.

然而，Scala 无法推断`MongoDoc`实例的类型，即使我认为它们可能是可推断的（`Doc`很容易推断，`SubDocF`可以推断`SubEntity.type`为`SubEntity`mixins，`MongoMetaDocument[SubEntity]`然后`SubDoc`类型必须是`SubEntity`）。如果我使用以下代码，一切都会很好：

```
val subEntity = new MongoDoc[Another,SubEntity.type,SubEntity](this, "subEntity", SubEntity) 
```

是否有一些不需要明确设置类型的解决方案？由于我需要构建一个从`MongoDocument`trait 扩展的类的实例，我试图通过使用具有该`create`方法的元对象来解决这个问题。

目前我想出的唯一解决方法是利用，`implicitly`但这会使实体定义更加讨厌。

谢谢你帮我解决这个问题（或者给我一些提示如何安排我的类层次结构，这不会是一个问题）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-12T03:58:12.277

如果您摆脱“F-bounded Polymorphism”，您将获得更好的类型推断。（即当您发现自己正在编写“T <: Foo[T]”形式的类型参数时），而是在具体类中具体化的特征中使用抽象类型成员。

你会发现推理在这里有效：

```
trait MongoDocument
  type DocType <: MongoDocument

  def apply(doc: TraversableBSONDocument): DocType = ??? // loads the content of supplied document
}
trait MongoMetaDocument extends MongoDocument {

  protected val clazz = this.getClass.getSuperclass
  def create: DocType = clazz.newInstance().asInstanceOf[DocType]

  def find(id: String): Future[Option[DocType]] = ???
}

abstract class MongoField[Doc <: MongoDocument, T](doc: MongoDocument, field: String) {
  type DocType <: MongoDocument
  var value: Option[T]

  def is: Option[T] = value
  def apply(in: T) { value = Some(in) }
  def unset() { value = None }

  def load(bson: BSONValue)

}

class MongoDoc[Doc <: MongoDocument, SubDocF <: MongoMetaDocument, SubDoc <: MongoDocument](doc: Doc, field: String, meta: SubDocF)
  extends MongoField[Doc, SubDocF#DocType](doc, field) {
  type DocType = Doc

  def load(bson: BSONValue) {
    value = Try(bson.asInstanceOf[TraversableBSONDocument]).toOption.map { doc =>
       ???
    }
  }
}

class SubEntity extends MongoDocument {
  type DocType = SubEntity
  ???
}
object SubEntity extends SubEntity with MongoMetaDocument

class Another extends MongoDocument {
  type DocType = Another
  val subEntity = new MongoDoc(this, "subEntity", SubEntity)
}
object Another extends Another with MongoMetaDocument 
```

# php - 如何在 Jquery 中创建动态 id 选择器？

> ID：15349881
> 
> 赞同：1
> 
> 时间：2013-03-11T22:27:18.797
> 
> 标签：php, javascript, jquery

我的 php 代码是这样的-

```
for($i=1;$i<=$n;$i++)
{
$id='selectThisID-' . $i;
?>
<div id="<?php echo $id;?>">On Select this Div(say #selectThisID-3)<?php echo $field-n; ?></div>

<?php $id= 'paraID-' . $i;
<p id="<?php echo $id; ?>" style="display:none">Toggle this para(say #paraID-3) for selected ID only</p>
} 
```

现在如何在我的 jQuery 中处理这个可变数量的 id。据我所知，对于单个 div 语句，它可能是：

```
 <script>
        $(document).ready(function(){
            $("[id^=selectThisID-]").click(function(){
                $("[id^=paraID-]").toggle();
            });
        });
</script> 
```

所以在选择带有 id 的元素时`'#selectThisID-1'`，`<p>`将切换。如何`#selectThisID-2, #selectThisID-3....#selectThisID-n`用作 jQuery 选择器。如何从 php 代码获取 'n' 的值到 jQuery？请帮忙。

提前致谢。

编辑：

假设`$n=5`，所以总共有 5 个`div`元素。现在的问题是，当我选择任何一个`div`（比如说`#selectThisID-3`）时，所有`<p>`元素都会被切换（即

`#paraID-1, #paraID-2....#paraID-5`全部切换）。但是，我需要在选择 div-3 时切换 para-3，在选择 div-4 时切换 para-4，依此类推。请帮忙。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-11T22:29:09.200

```
$("[id^=selectThisID-]").click(function(){
    $("#paraID-"+this.id.split('-')[1]).toggle();
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-11T22:31:00.877

而不是 ID 使用类。这比你在那里的效率更高。例如：

```
$(".your-class").each(function(index, domEl){
              $(this).val();
              $(this).toggle();
        }); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-12T01:13:03.367

在元素和`index()`方法上使用类来匹配它们而不涉及 ID：

```
var $divGroup=$('.divClass').click(function(){
    var index=$divGroup.index(this);
    $('.paragraphClass').hide().eq( index).show();
}) 
```

演示：http: [//jsfiddle.net/UZqD3/](http://jsfiddle.net/UZqD3/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-12T01:58:23.097

不要使用 id，而是使用一个类并将对应的对象`p` `id`放入自定义属性中：

```
$(".selectThisID").click(function(){
    $("paraID-" + this.getAttribute("data-target")).toggle();
}); 
```

HTML：

```
<div class="selectThisID" data-target="5">foo</div>
<p id="paraID-5">bar</p> 
```

# javascript - Angular.js jQuery passthrough 访问元素

> ID：15349882
> 
> 赞同：0
> 
> 时间：2013-03-11T22:27:35.723
> 
> 标签：javascript, twitter-bootstrap, angularjs, angular-ui

有没有办法通过 jQuery passthrough 访问另一个元素（& onclick）？例如，要实现以下内容：

```
<div id="that"></div>
<a ui-jq="slideUp">slide Up #that</a> 
```

从[文档](http://angular-ui.github.com/)中不清楚:)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-11T22:47:24.907

`ui-jq`并不是所有事情的答案，尤其是对于您正在尝试做的事情。

相反，请尝试使用`ui-show`和相关指令以及一些自定义 CSS。或者，如果您使用的是 bootstrap，请查看[collapse 指令](http://angular-ui.github.com/bootstrap/#/collapse)的代码。

总的来说，你最好使用 Angular 来简单地切换一个类并以这种方式处理滑动和转换。或者，如果 CSS 过渡无法削减它，您可以尝试创建自定义指令。

# backbone.js - 合并 Backbone 集合而不更改顺序

> ID：15349887
> 
> 赞同：1
> 
> 时间：2013-03-11T22:27:54.080
> 
> 标签：backbone.js, backbone.js-collections

我有一个代表 N 张照片的骨干集合。最初，我收藏的 N 中照片很少（比如说 X）。

然后我的收藏从服务中获取所有 N 张照片。我可以用这些 N 重置我的收藏，但问题是，现有的 X 有一些额外的元数据，我不想丢失它。所以我想将这 N 张照片合并到我现有的收藏中。我怎么做？

我尝试使用 collection.add(N photos) ，但它的作用是保持 X 照片保持原样，然后在最后添加剩余的 (NX)。我想保持服务返回的 N 张照片的顺序，并将这些现有的照片合并到 N 张照片中。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-12T03:53:47.533

您应该能够为此使用该集合`comparator`：

> **比较器** `collection.comparator`
> 
> 默认情况下，集合没有**比较器。**如果您定义了一个比较器，它将用于按排序顺序维护集合。这意味着随着模型的添加，它们会被插入到`collection.models`.

因此，您需要做的就是在调用之前确保您的收藏有一个`comparator`知道事物顺序的东西。粗略而丑陋的概念证明如下所示：`N``add`

```
// `incoming` is the new data, `c` is the collection.
for(var i = 0, rev = { }; i < incoming.length; ++i)
    rev[incoming[i].id] = i;
c.comparator = function(m) {
    return rev[m.id];
};
c.add(incoming); 
```

一个真实的版本大概会包含在您的收藏中。

演示：http: [//jsfiddle.net/ambiguous/dCZbv/](http://jsfiddle.net/ambiguous/dCZbv/)

# android - 更改 ListView 行项的颜色

> ID：15349890
> 
> 赞同：1
> 
> 时间：2013-03-11T22:28:06.630
> 
> 标签：android, listview, simplecursoradapter, android-viewbinder, customizing

这是我的应用程序上的联盟活动： ![ActAlliances.java](../Images/e377981d1c01953ded980fa18f425864.png)

这是单行的布局：

```
<?xml version="1.0" encoding="utf-8"?>
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
android:layout_width="match_parent"
android:layout_height="match_parent"
android:alignmentMode="alignBounds"
android:orientation="horizontal"
android:useDefaultMargins="true" >

<TextView
    android:id="@+id/allc_lstRow_textView1"
    android:layout_width="50sp"
    android:layout_height="wrap_content"
    android:gravity="right"
    android:paddingRight="10dp"
    android:text="@string/tallc_id"
    android:textSize="18sp"/>
<TextView
    android:id="@+id/allc_lstRow_textView2"
    android:layout_width="140sp"
    android:layout_height="wrap_content"
    android:layout_toRightOf="@+id/allc_lstRow_textView1"
    android:gravity="left"
    android:text="@string/lst_item_allc_name"
    android:textSize="18sp"/>
<TextView
    android:id="@+id/allc_lstRow_invisible"
    android:layout_height="wrap_content"
    android:layout_toRightOf="@+id/allc_lstRow_textView2"
    android:layout_width="1dip"
    android:gravity="left"
    android:textSize="1sp"/>
<TextView
    android:id="@+id/allc_lstRow_textView3"
    android:layout_width="fill_parent"
    android:layout_height="wrap_content"
    android:layout_toRightOf="@+id/allc_lstRow_invisible"
    android:layout_gravity="right"
    android:gravity="right"
    android:text="@string/lst_item_allc_power"
    android:textSize="18sp"/>
</RelativeLayout> 
```

这是带有 ViewBinder 的 SimpleCursorAdapter，用于自定义联盟的颜色（灰色表示中立，蓝色表示盟友，绿色表示附庸，红色表示敌人）：

```
SimpleCursorAdapter dataAdapter = new SimpleCursorAdapter(
      this, 
      R.layout.lst_row_act_allc,
      mCursor,
      cols,
      to,
      0);
    dataAdapter.setViewBinder(new SimpleCursorAdapter.ViewBinder() {
        @Override
        public boolean setViewValue(View view, Cursor cursor, int column) {
            if( column == 1 ){ 
                TextView tv = (TextView) view;
                String mPltc = cursor.getString(cursor.getColumnIndex("FPLTC"));
                if (BuildConfig.DEBUG) {
                    Log.i(Constants.TAG_ACTALLIANCES, "loadAllianceData(): Alliance Name: "+cursor.getString(cursor.getColumnIndex("FANAME")));
                    Log.i(Constants.TAG_ACTALLIANCES, "loadAllianceData(): Political Relation: "+mPltc);
                }
                // Set color of item based on Political Relation
                if(mPltc.equals("Ally")){
                    tv.setTextColor(Color.parseColor("#6699ff"));
                    String mAN = cursor.getString(cursor.getColumnIndex("FANAME"));
                    tv.setText(mAN);
                }
                if(mPltc.equals("Vassal")){
                    tv.setTextColor(Color.parseColor("#00ff00"));
                    String mAN = cursor.getString(cursor.getColumnIndex("FANAME"));
                    tv.setText(mAN);
                }
                if(mPltc.equals("Enemy")){
                    tv.setTextColor(Color.parseColor("#ff0000"));
                    String mAN = cursor.getString(cursor.getColumnIndex("FANAME"));
                    tv.setText(mAN);
                }
                if(mPltc.equals("Neutral")){
                    String mAN = cursor.getString(cursor.getColumnIndex("FANAME"));
                    tv.setText(mAN);
                }
                return true;
            }
            return false;
        }
    }); 
```

现在根据 Logcat，保存联盟名称的 TextView 与数据库表中表示政治关系的列匹配：

```
03-11 21:48:15.229: I/ActAlliances(7823): loadAllianceData(): Alliance Name: IMMORTALS
03-11 21:48:15.328: I/ActAlliances(7823): loadAllianceData(): Political Relation: Neutral
03-11 21:48:15.497: I/ActAlliances(7823): loadAllianceData(): Alliance Name: Legion of Anarchy
03-11 21:48:15.497: I/ActAlliances(7823): loadAllianceData(): Political Relation: Ally
03-11 21:48:15.590: I/ActAlliances(7823): loadAllianceData(): Alliance Name: TheCulture
03-11 21:48:15.590: I/ActAlliances(7823): loadAllianceData(): Political Relation: Enemy
03-11 21:48:15.608: I/ActAlliances(7823): loadAllianceData(): Alliance Name: Rising Storm
03-11 21:48:15.608: I/ActAlliances(7823): loadAllianceData(): Political Relation: Vassal
03-11 21:48:15.647: I/ActAlliances(7823): loadAllianceData(): Alliance Name: NULL ALLIANCE
03-11 21:48:15.647: I/ActAlliances(7823): loadAllianceData(): Political Relation: Neutral
03-11 21:48:15.677: I/ActAlliances(7823): loadAllianceData(): Alliance Name: OMEGA 27
03-11 21:48:15.677: I/ActAlliances(7823): loadAllianceData(): Political Relation: Neutral 
```

然而，就目前而言，这里有两个问题：

1.  setViewValue() 在 ListView 显示时和用户执行任何操作之前运行不少于 4 次。
2.  列表中的第一项（在本例中为 IMMORTALS）根据最后应用的颜色重新着色（因为灰色是列表项的默认颜色，它实际上并不算数，因为代码只显示中立联盟名称而不应用一种颜色。

我需要修复这些错误，并希望得到任何帮助。

注意：我没有使用 ListActivity，因为前两行（Sector、Number of Alliances）不是 ListView 的一部分；我愿意重新考虑这个决定。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-13T07:40:41.410

1.  我真的不认为这里有问题。
2.  在上一条语句中将文本颜色设置为默认值：

    ```
    if(mPltc.equals("Neutral")){
      tv.setTextColor(Color.parseColor("#444444"));
      String mAN = cursor.getString(cursor.getColumnIndex("FANAME"));
      tv.setText(mAN);
    } 
    ```

除此之外，我建议使代码更具可读性——你在每条`if`语句中都做同样的事情——要么将其提取到私有方法中，要么将其移出语句。

您还可以将`if`语句替换为 a`switch-case`并使用`Enums`。

# php - 通过php选择Dropbox值？

> ID：15349891
> 
> 赞同：-1
> 
> 时间：2013-03-11T22:28:07.473
> 
> 标签：php, select, drop-down-menu, dropbox

我的 PHP 代码有这个小问题，这个网站使用了保管箱，我想显示其中一个值。file_get_contents 在它所在的链接上，现在我需要选择保管箱。完成后，会有 400-500 个选项，我想选择您在文本框中输入的值。你们能帮我开始吗？如果您想知道，我的学校网站在他们的网站上的 Dropbox 中有我们的课程表，但我不想每次都搜索名字，所以当我在文本框中输入我的名字时，它需要在表格中选择它，谢谢很多！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-11T22:43:00.870

你可以使用普通的 javascript 来做到这一点，但我建议你习惯 jQuery，它更容易学习并且使用恕我直言：

[http://jquery.com/](http://jquery.com/)

获取输入框的值：

[如何使用 jQuery 获取文本框的值？](https://stackoverflow.com/questions/463506/how-do-i-get-the-value-of-a-textbox-using-jquery)

然后改变选择框的值：

[使用 jQuery 更改下拉列表的选定值](https://stackoverflow.com/questions/499405/change-the-selected-value-of-a-drop-down-list-with-jquery)

# .net - 使用 rowversion 将 SQL Server 2008 数据库与专有的非 SQL 数据库同步

> ID：15349892
> 
> 赞同：0
> 
> 时间：2013-03-11T22:28:09.737
> 
> 标签：.net, sql-server-2008, data-synchronization

我正在尝试将 SQL Server 2008 数据库与专有的第三方数据库同步。在 SQL Server 数据库中，我希望同步的表中有一个时间戳/行版本类型的 SyncId 列。但第三方数据库不支持 rowversion 或 timestamp 列。它只支持一些基本类型，如字符串、数字、日期（仅存储日期，没有时间组件）、布尔值、十进制。

当我第一次同步时，我可能可以将 SyncId 作为字符串存储在第三方数据库中。稍后我将需要在此第三方数据库中检索最高可用的同步 ID。如何实现我的自定义比较逻辑/排序逻辑，以便获得最高的 Sync Id。

此外，在向 SQL Server 发送查询或存储过程参数时，如何将 SyncId 字符串值转换回本机 Sql Server 数据类型？

实现同步系统以将增量数据更改从 Sql Server 2008 下载到第三方数据库的任何其他想法？

**编辑：** 在从 SQL Server 数据库中检索 SyncId 并转换为字符串时，我遇到了一个异常。代码是：

```
 string sqlSyncId = "";
            SqlCommand selectNewAnchorCommand = new SqlCommand();
            string newAnchorVariable = "@sync_new_received_anchor";
            selectNewAnchorCommand.CommandText =
                "SELECT " + newAnchorVariable + " = min_active_rowversion() - 1";
            selectNewAnchorCommand.Parameters.Add(newAnchorVariable, SqlDbType.Timestamp);
            selectNewAnchorCommand.Parameters[newAnchorVariable].Direction = ParameterDirection.Output;
            selectNewAnchorCommand.Connection = conn;

            reader = cmd.ExecuteReader();

            if (reader.Read())
            {
                do
                {
                    sqlSyncId = reader["@sync_new_received_anchor"].ToString();
                } while (reader.Read());
            }

Stack Trace:    System.IndexOutOfRangeException: @sync_new_received_anchor
   at System.Data.ProviderBase.FieldNameLookup.GetOrdinal(String fieldName)
   at System.Data.SqlClient.SqlDataReader.GetOrdinal(String name)
   at System.Data.SqlClient.SqlDataReader.get_Item(String name) 
```

**编辑：** 我也试过：

```
sqlSyncId = reader["@sync_new_received_anchor"].ToString();     //same error
sqlSyncId = reader[0].ToString();   //Works 
```

为什么我不能按名称引用列？

我收到的值是 101，但在数据库表中，SyncId 列具有不同的十六进制值。

# c# - 在我的服务器上转换为 UTC 时间不起作用

> ID：15349903
> 
> 赞同：0
> 
> 时间：2013-03-11T22:28:46.357
> 
> 标签：c#, datetime

我在我的应用程序中将用户提交的日期时间转换为 utc：

`TimeZoneInfo.ConvertTimeToUtc(DateTime.Parse(model.SessionEnd))`

我也尝试过这样的事情

`combinedDateTime = DateTime.SpecifyKind(combinedDateTime, DateTimeKind.Utc);`

当我在我的电脑上运行网络应用程序时，两者都工作得很好。一旦我将它上传到服务器并从那里尝试它只是不会转换时间并最终只返回我输入的相同日期时间。我确信我的类库正在使用最新版本正确加载，因为我检查了我的调试语句是否也在更新，并且它们是。这是服务器设置还是我可以做些什么来解决这个问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-11T22:52:13.590

唯一明智的方法是让客户端代码提交带有时区的时间/日期时间值。一般来说，在客户端转换为 UTC 是合理的，并且 JavaScript 也支持（如果您仍然喜欢 timzone - 使用[getTimeZoneOffset](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Date/getTimezoneOffset)）。我建议在 UTC (Z) 时区发布格式为 ISO8601 的日期时间值，这是众所周知的可排序格式，对同一字符串 (2013-03-11T03:52Z) 没有多重含义。

请注意，有时您需要明确没有时区的时间（例如在我的时间早上 9 点叫醒我） - 确保了解您的用例。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-12T00:17:56.310

当您的客户从客户端将日期时间作为字符串发布时，您可以执行以下操作：

1.）您可以在客户端将他们的时间转换为 UTC（如 Alexei Levenov 的回答）

2.）您可以将客户端的时间传递给服务器并在服务器端转换他们的时区

3.) 您可以在客户端将他们的时间转换为 UTC，并在服务器端发送他们的时区

根据您的需要，您可以选择其中任何一种。第三个只有在您以后想在服务器端以某种方式使用他们的时区时才有用。

# python - 为什么这个总和在 Python 中不收敛

> ID：15349904
> 
> 赞同：-1
> 
> 时间：2013-03-11T22:28:49.693
> 
> 标签：python, numpy, sum

下面的函数 peval2 给出了收敛到 1 的饱和曲线，这在 Maple 中是正确的。然而，Python 计算出错误的总和值。谁能给我一个提示我做错了什么？

```
from numpy import *
from scipy.optimize import leastsq
import matplotlib.pyplot as plt

def peval2(x, p):
    b,c = p
    err = 0 * x
    for ii in range(0,30):
        for jj in range(0,30):
            for kk in range(0,30):
                err += exp(-1.0*x*pi**2.0*(b*(((2.0*ii+1.0)/75.0)**2+((2.0*jj+1)/75.0))**2+c*((2.0*kk+1)/2.0)**2.0))/((2.0*ii+1)*(2.0*jj+1)*(2.0*kk+1))**2.0
    print err
    return 1.0-((8.0/pi**2)**3*err)

rr = linspace(0,4000,100)

plt.plot(rr,peval2(rr,[5e-7,2e-7]))

plt.show() 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-12T00:33:53.433

你使用的参数和 Maple 代码一样吗？我将参数更改为：

```
plt.plot(rr,peval2(rr,[0.001, 0.002])) 
```

结果：

![在此处输入图像描述](../Images/bd478aecb3be47bb858d67c37403afd6.png)

# java - Cloud Endpoints 生成的代码中 @JSONString 注释的非法参数异常

> ID：15349909
> 
> 赞同：2
> 
> 时间：2013-03-11T22:29:19.543
> 
> 标签：java, python, google-cloud-endpoints

我正在开发 Google Cloud Endpoint Web 服务，在最终使身份验证正常工作后，生成的代码出现了一些问题。

我已经像这样构建了我的 ProtoRPC 消息，使用一个整数字段作为对象 id、client_id 和 high_water_mark。

```
class NoteMessage(messages.Message):
    id = messages.IntegerField(1)
    client_id = messages.IntegerField(2)
    high_water_mark = messages.IntegerField(5)
    ... 
```

这会生成包含字段`@JsonString`属性的Java 源代码`long`，但是当我从服务器获得响应时，会出现以下错误。

```
E/AndroidRuntime( 9231): java.lang.IllegalArgumentException: number type formatted as a JSON number cannot use @JsonString annotation [key id, field private java.lang.Long com.google.api.services.notes.model.NoteApiMessagesNoteMessage.id]
E/AndroidRuntime( 9231):    at com.google.common.base.Preconditions.checkArgument(Preconditions.java:119)
E/AndroidRuntime( 9231):    at com.google.api.client.json.JsonParser.parseValue(JsonParser.java:599)
E/AndroidRuntime( 9231):    at com.google.api.client.json.JsonParser.parse(JsonParser.java:350)
E/AndroidRuntime( 9231):    at com.google.api.client.json.JsonParser.parseValue(JsonParser.java:586)
E/AndroidRuntime( 9231):    at com.google.api.client.json.JsonParser.parseArray(JsonParser.java:456)
E/AndroidRuntime( 9231):    at com.google.api.client.json.JsonParser.parseValue(JsonParser.java:549)
E/AndroidRuntime( 9231):    at com.google.api.client.json.JsonParser.parse(JsonParser.java:350)
E/AndroidRuntime( 9231):    at com.google.api.client.json.JsonParser.parseValue(JsonParser.java:586)
E/AndroidRuntime( 9231):    at com.google.api.client.json.JsonParser.parse(JsonParser.java:289)
E/AndroidRuntime( 9231):    at com.google.api.client.json.JsonObjectParser.parseAndClose(JsonObjectParser.java:76)
E/AndroidRuntime( 9231):    at com.google.api.client.json.JsonObjectParser.parseAndClose(JsonObjectParser.java:71)
E/AndroidRuntime( 9231):    at com.google.api.client.http.HttpResponse.parseAs(HttpResponse.java:495)
E/AndroidRuntime( 9231):    at com.google.api.client.googleapis.services.AbstractGoogleClientRequest.execute(AbstractGoogleClientRequest.java:465)
E/AndroidRuntime( 9231):    at com.ryanharter.hashnote.sync.SyncAdapter.syncNotes(SyncAdapter.java:187)
E/AndroidRuntime( 9231):    at com.ryanharter.hashnote.sync.SyncAdapter.onPerformSync(SyncAdapter.java:110)
E/AndroidRuntime( 9231):    at android.content.AbstractThreadedSyncAdapter$SyncThread.run(AbstractThreadedSyncAdapter.java:254) 
```

我似乎找不到任何我实际上可以控制序列化或反序列化的地方，那么这应该如何与 Java 一起使用？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-12T01:44:08.793

正如[另一篇文章](https://stackoverflow.com/questions/15124744/illegalargumentexception-deserializing-generated-objects-with-jsonstring-annot)中提到的，这是由`protorpc`图书馆的一个怪癖引起的。Google 的 API 客户端库期望`int64`和`uint64`字段是 JSON 中的字符串，因为 Javascript 本身只能处理（由于精度）不超过`2**53`.

正如您在 Google 的“发现”API 标准的[类型格式文档](https://developers.google.com/discovery/v1/type-format)中看到的那样，这就是这些类型所期望的。但是，该`protorpc`库目前不[使用](https://code.google.com/p/google-protorpc/source/browse/python/protorpc/protojson.py)相同的语义，我们仍在确定正确的方法。

所以，当你使用

```
id = messages.IntegerField(1) 
```

您正在使用`IntegerField`s 的默认变体，即`messages.Variant.INT64`. 这反过来又使 Java 客户端库期望一个 JSON 字符串，例如

```
{'id': '123456789'} 
```

相反，返回的响应`protorpc`是

```
{'id': 123456789} 
```

作为您的应用程序的临时解决方法，请使用

```
id = messages.IntegerField(1, variant=messages.Variant.INT32) 
```

或者如果您的 ID 的大小需要超过 32 位，请使用：

```
id = messages.StringField(1) 
```

# 后记：

当您使用它时，我建议您查看[Endpoints Proto Datastore API](http://endpoints-proto-datastore.appspot.com/)。我们已经做了一些关于它的使用的[截屏视频。](http://www.youtube.com/watch?v=9wNRUd9E1jM)

要解决与 相同的问题`endpoints-proto-datastore`，您需要导入

```
from protorpc import messages
from endpoints_proto_datastore.ndb import EndpointsVariantIntegerProperty 
```

并使用

```
attr1 = EndpointsVariantIntegerProperty(variant=messages.Variant.INT32) 
```

为您的财产。

# google-app-engine - 最近平均延迟和错误很高

> ID：15349911
> 
> 赞同：0
> 
> 时间：2013-03-11T22:29:29.477
> 
> 标签：google-app-engine

在过去的几天里，我的应用程序遇到了高延迟和更多错误。以前平均延迟不到 300 毫秒，现在 > 5000 毫秒！有没有人有同样的问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-11T22:44:27.323

自 2013 年 3 月 5 日以来，我们的内存缓存减少了 10 倍：

如果您是 memcache 的重度用户，这可能会解释您的问题。

在这里查看我们的内存缓存大小是如何缩小的：

[http://www.prodeagle.com/link?site=miumeet-hr.appspot.com&id=1189001&auth=9fc19f8077892c56ee311793a1ec2ace](http://www.prodeagle.com/link?site=miumeet-hr.appspot.com&id=1189001&auth=9fc19f8077892c56ee311793a1ec2ace)

# c# - 如何从文件中加载保存的字典？

> ID：15349913
> 
> 赞同：0
> 
> 时间：2013-03-11T22:29:35.223
> 
> 标签：c#, dictionary, streamwriter

我保存了一本字典，内容如下：

```
 using (var file = File.OpenWrite("dictionary.txt"))
                foreach (KeyValuePair<string, string> entry in dictionary)
                {
                    streamwriter.WriteLine(entry.Key + entry.Value);
                } 
```

如何重新打开此文件并将保存的数据存储回新字典？

**更新** 回答

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-11T22:31:56.900

您需要对其进行序列化以保存它，然后对其进行反序列化以加载它。

您的代码只是将每个键值对写入单独一行的文件中。这不起作用，因为两者之间没有分隔符。没有办法知道`Key`零件在哪里停止和`Value`零件从哪里开始。您需要一种更好的方法来序列化您的字典。

有很多方法可以做到这一点，但仅举几例，您可以使用 XML（请参阅[此 SO 问题](https://stackoverflow.com/questions/3671259/how-to-xml-serialize-a-dictionary)）或 JSON（请参阅[此 SO 问题](https://stackoverflow.com/questions/4861138/c-sharp-json-serialization-of-dictionary-into-keyvalue-instead-of-keyk)）。

# python - cElementTree.ParseError：顶层有多个元素

> ID：15349915
> 
> 赞同：0
> 
> 时间：2013-03-11T22:29:39.713
> 
> 标签：python, xml-parsing, xsd

我有这个接受 XML 文件作为输入的 python 代码。当我运行执行时，我收到问题标题中指示的错误：

```
for event,element in cElementTree.iterparse(io, events = ( b'start',b'end')):
    if event == b'start':
        self.TreeBuilder.start(element.tag, element.attrib) 
```

**错误**：

```
> File "/usr/lib/python2.7/site-packages/pymzml/run.py", line 370, in
> __init__
>     self.TreeBuilder.start(element.tag, element.attrib) 
      cElementTree.ParseError: multiple elements on top level 
```

帮我解决这个问题！谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-11T22:49:34.430

如果我猜对了，您似乎正在解析一个具有多个根节点的 XML 片段，而 TreeBuilder 需要一个根文档。

尝试使用调用来包装您的解析，以创建具有单个根节点的树。换句话说：

```
self.TreeBuilder.start("root", {})
[...]
for event,element in cElementTree.iterparse(io, events = ( b'start',b'end')):
    if event == b'start':
        self.TreeBuilder.start(element.tag, element.attrib)
[...]
self.TreeBuilder.end("root") 
```

请记住，生成的 DOM 在顶部有这个额外的元素，并修改您的处理以将其考虑在内。

# asp.net-mvc - 我可以有条件地在 _Layout.cshtml 中呈现部分视图吗？

> ID：15349916
> 
> 赞同：6
> 
> 时间：2013-03-11T22:29:41.387
> 
> 标签：asp.net-mvc, partial-views

假设我有一个 _Layout.cshtml，我在其中呈现了一个左侧边栏，这对我网站的每个页面都是通用的。这些方面的东西 - 例如菜单

```
<div id="left-sidebar">
    @Html.Action("_MenuView", "LeftSideMenu")
</div> 
```

我想要的一个功能是添加另一个部分视图，但只在网站的某些部分显示。

例如，在博客部分，我可能想要显示帖子类别列表或帖子的树视图。

```
<div id="left-sidebar">
    @Html.Action("_MenuView", "LeftSideMenu")

    @if ("???")
    {
        @Html.Action("_BlogTreeView", "BlogEntries")
    }
</div> 
```

我怎么能那样做？如果我正在渲染的视图由 BlogController 返回，我知道我想显示“_BlogTreeView”......我从那里去哪里？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-03-11T22:41:56.473

在你的布局中，添加这个`section`

```
@RenderSection("blogEntries", false) 
```

然后在要显示局部视图的每个视图中添加：

```
@section blogEntries {
    @Html.Action("_BlogTreeView", "BlogEntries")
} 
```

# ruby-on-rails - Rails：资产在开发中未正确呈现

> ID：15349917
> 
> 赞同：1
> 
> 时间：2013-03-11T22:29:45.770
> 
> 标签：ruby-on-rails, asset-pipeline, twitter-bootstrap-rails

这几天我一直在为此苦苦挣扎——我在我的 rails 应用程序中添加了引导程序（和其他一些宝石），但由于某种原因，适当的 CSS 文件没有呈现，因此引导程序样式没有显示。

以下是我文件的相关部分：

`application.html.erb`在`app/views/layouts`：

```
<head>
  <title>Myapp</title>
  <%= stylesheet_link_tag    "application", :media => "all" %>
  <%= javascript_include_tag "application" %>
  <%= csrf_meta_tags %>
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js"></script>
  <script type="text/javascript" src="https://raw.github.com/twitter/bootstrap/master/js/bootstrap-dropdown.js"></script>
</head> 
```

`application.css`在`app/assets/stylesheets`：

```
/*
 * This is a manifest file that'll be compiled into application.css, which will include all the files
 * listed below.
 *
 * Any CSS and SCSS file within this directory, lib/assets/stylesheets, vendor/assets/stylesheets,
 * or vendor/assets/stylesheets of plugins, if any, can be referenced here using a relative path.
 *
 * You're free to add application-wide styles to this file and they'll appear at the top of the
 * compiled file, but it's generally better to create a new file per style scope.
 *
 *= require_self
 *= require_tree .
 */ 
```

（这个文件夹中还有很多 CSS 文件，包括`bootstrap_and_overrides.css`和`gmaps4rails.css`）。

当我加载页面时服务器日志：

```
$ rails server
=> Booting WEBrick
=> Rails 3.2.8 application starting in development on http://0.0.0.0:3000
=> Call with -d to detach
=> Ctrl-C to shutdown server
        SECURITY WARNING: No secret option provided to Rack::Session::Cookie.
        This poses a security threat. It is strongly recommended that you
        provide a secret to prevent exploits that may be possible from crafted
        cookies. This will not be supported in future versions of Rack, and
        future versions will even invalidate your existing user cookies.

        Called from: /Users/me/.rvm/gems/ruby-2.0.0-p0/gems/actionpack-3.2.8/lib/action_dispatch/middleware/session/abstract_store.rb:28:in `initialize'.
[2013-03-11 15:19:32] INFO  WEBrick 1.3.1
[2013-03-11 15:19:32] INFO  ruby 2.0.0 (2013-02-24) [x86_64-darwin11.4.2]
[2013-03-11 15:19:32] INFO  WEBrick::HTTPServer#start: pid=94815 port=3000

Started GET "/" for 127.0.0.1 at 2013-03-11 15:19:35 -0700
Processing by HomeController#index as HTML
  Rendered home/index.html.erb within layouts/application (2.8ms)
  Trip Load (0.2ms)  SELECT "trips".* FROM "trips" 
  Rendered layouts/_navigation.html.erb (62.0ms)
Completed 200 OK in 143ms (Views: 141.0ms | ActiveRecord: 1.3ms) 
```

以及实际在 Chrome 中呈现的源代码：

```
<head>
  <title>Myapp</title>
  <link href="/assets/application.css?body=1" media="all" rel="stylesheet" type="text/css" />
  <script src="/assets/application.js?body=1" type="text/javascript"></script>
  <meta content="authenticity_token" name="csrf-param" />
<meta content="GfG+KCsrNZaChqWvUz/g5RqsdHrXOtumFzHaOjJmFQg=" name="csrf-token" />
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js"></script>
  <script type="text/javascript" src="https://raw.github.com/twitter/bootstrap/master/js/bootstrap-dropdown.js"></script>
</head> 
```

我的`Gemfile`：

```
gem "bootstrap-sass", '~> 2.3.0.1'
gem "simple_form"

gem 'gmaps4rails' 
```

并且`config/environments/development.rb`：

```
config.cache_classes = false

# Log error messages when you accidentally call methods on nil.
config.whiny_nils = true

# Show full error reports and disable caching
config.consider_all_requests_local       = true
config.action_controller.perform_caching = false

# Don't care if the mailer can't send
config.action_mailer.raise_delivery_errors = false

# Print deprecation notices to the Rails logger
config.active_support.deprecation = :log

# Only use best-standards-support built into browsers
config.action_dispatch.best_standards_support = :builtin

# Raise exception on mass assignment protection for Active Record models
config.active_record.mass_assignment_sanitizer = :strict

# Log the query plan for queries taking more than this (works
# with SQLite, MySQL, and PostgreSQL)
config.active_record.auto_explain_threshold_in_seconds = 0.5

# Do not compress assets
config.assets.compress = false

# Expands the lines which load the assets
config.assets.debug = true 
```

我将资产管道`config/application.rb`设置为 true，并且我没有更改调试设置。我`RAILS_ENV`的是`development`。据我了解，rails 应该编译和提供所有 CSS 文件，包括`boostrap_and_overrides.css.scss`因为`require_tree .`调用。我跑过很多次`rake assets:precompile`，`bundle exec rake assets:precompile`但我认为这不重要。我正在运行 ruby​​ 2.0.0p0（2013-02-24 修订版 39474）。

真正奇怪的是，我和我在这个项目上的合作伙伴拥有完全相同的代码（来自我们的 github 存储库），它可以在他们的本地机器上运行，但它不能在我的机器上运行。有没有人对正在发生的事情有任何意见？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-11-20T09:01:24.277

我在 Rails 3.2.6 中也遇到了同样的问题，当我升级到 Rails 3.2.15 时它就消失了。

# html - 调整浏览器大小时不显示水平滚动

> ID：15349919
> 
> 赞同：4
> 
> 时间：2013-03-11T22:29:58.430
> 
> 标签：html, css

我正在建立一个页面。我注意到，当我调整浏览器的大小以查看它在较小窗口中的外观时，水平滚动条不会出现。

这是我唯一的正文 css 代码：

```
body {
font-family:Helvetica, Arial, sans-serif;
margin:0;
background-image:url(img/paper-footerbg.png);
background-attachment:scroll;
background-repeat:repeat-x repeat-y; 
```

}

这是我正在构建的页面的链接，[http ://taghomecaremarketing.com/test/theadamgroup/](http://taghomecaremarketing.com/test/theadamgroup/)

任何帮助表示赞赏。谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-11T22:32:50.480

在容器 div 的 css 中，删除`overflow: hidden`

`#headerBox, #mainBox, #subBox, #footerBox`

当然，您会遇到其他一些问题，但这就是答案...

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-11T22:35:41.773

或添加溢出：自动。或溢出：自动！重要；

如果这确实有效并在 x 和 y 轴上滚动。那么最好试试overflow-x:auto;

祝你好运！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-11T22:47:20.247

您已将其设置为`overflow: hidden`！这隐藏了内容。将其更改为`overflow: auto`，或者更好的是，将其删除！

# jquery - 为什么在测试 jQueryUI 可排序时出现“Permission Denied”Firebug 控制台错误？

> ID：15349920
> 
> 赞同：1
> 
> 时间：2013-03-11T22:30:04.577
> 
> 标签：jquery, jquery-ui, firebug, jquery-ui-sortable

尝试使用 jQueryUI 测试“已连接”可排序功能时，我在 Firebug 控制台上遇到错误。这是我在拖动表格行时收到的错误类型：

```
Error: Permission denied to access property 'sortableItem'
  target[ name ] = copy; 
```

如果我关闭 Firebug，Sortable 功能似乎工作得很好。

这是我正在测试的代码：

```
<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<title>ja test</title>

<script src="http://code.jquery.com/jquery-1.9.1.js"></script>
<script src="http://code.jquery.com/ui/1.10.1/jquery-ui.js"></script>
<script>
$(document).ready(function(){
$( ".connected" ).sortable({
        items: 'tbody > tr',
        connectWith: ".connected",

        update: function(e, ui){
              // AJAX code will go here
              alert("hello"); // testing only
                }

        });
});
</script>
</head>
<body>      

<table border="0" width="50%" class="connected" id="unranked">
    <thead>
          <tr class="body-bold">
            <td>id</td>
            <td>Start Date </td>
            <td>End Date </td>
            <td>&nbsp;</td>
          </tr>
     </thead>
     <tbody id="sortableUnranked">
        <tr id="contentid-9896">
            <td>A9896</td>
            <td>2013-02-21</td>
            <td>2013-03-31</td>                 
            <td><input class="edit-button" type="button" name="edit" value="Edit"></td>         
        </tr>
     </tbody>
</table> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-11T22:55:56.483

原来是一个低于当前版本的 Firebug 附加 FireQuery。我安装了 1.2 版（Firefox 报告说我所有的附加组件都是最新的）。当我访问 FireQuery 测试页面（测试 FireQuery 的功能）： http: [//firequery.binaryage.com/test/](http://firequery.binaryage.com/test/)时，我发现它也显示 Firebug 错误，最新版本 1.3 的发行说明说这些更改是为了解决与 Firefox 安全模型相关的问题。当我安装 FireQuery 1.3 时，FireQuery 测试页面可以正常工作，我的脚本也是如此。

# python - App Engine 阻止包含过多链接的电子邮件

> ID：15349921
> 
> 赞同：4
> 
> 时间：2013-03-11T22:30:14.503
> 
> 标签：python, google-app-engine

我有一个应用程序，它每天都会向我发送一封包含推文列表的电子邮件。每条推文至少包含一个链接。从本月开始，我不再收到电子邮件。起初，我认为问题在于 Twitter 的 v1.1 API。但是在重写我的应用程序后，我注意到它是 GAE 不发送电子邮件。更准确地说，它不会发送包含多个链接的电子邮件。如果电子邮件是 html 或纯文本，则没有区别。

GAE 是否更改了垃圾邮件规则？如果是这样的话，为什么我至少不能给自己（注册为管理员的电子邮件地址）发送电子邮件？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-21T17:05:43.910

我对 GAE 了解不多，但您可以使用众多可用的 SMTP 提供商之一轻松避免此问题。例如，[http://www.mailgun.com/](http://www.mailgun.com/)有一个每天 200 条消息的免费计划。

# magento - Magento DHL 模块，它应该做什么？

> ID：15349925
> 
> 赞同：1
> 
> 时间：2013-03-11T22:30:28.080
> 
> 标签：magento, e-commerce, magento-1.7

应该是一个易于查找的信息，但我找不到任何解释 DHL 模块可以做什么和不能做什么的文档页面。具体来说：

*   可以自动创建快件吗？（我的意思是，无论何时下订单——无论我是否采取任何行动——DHL 的某个人都会收到通知，我的公司有一个箱子要提货……）
*   可以自动创建跟踪号并通过电子邮件将其发送给客户

或者它所能做的只是得到报价？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-12T01:47:35.590

不，不。它的作用是让您获得、显示和记录各种运输选项的费率。

# ruby - 如何为 ruby 哈希中的特定键创建值数组？

> ID：15349929
> 
> 赞同：1
> 
> 时间：2013-03-11T22:30:48.900
> 
> 标签：ruby, map

我们的 Rails 应用程序中有`user`和`user_level`模型。里面有`user_level`一个字段叫`user_group_id`. 关系是`user`has_many `user_levels`。我们想`user_group_id`为给定的（在 user_level 中）生成一个数组`user_id`。

对于给定的 user_id，其 user_levels 可以检索为：

```
u = User.find(user_id)
ul = u.user_levels 
```

`user_levels`一个可能有多个`user`。如何使用 ruby​​（或其他一些 ruby​​ 方法（首选 ruby​​））创建`user_group_id`一个`ul`数组`map`？谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-11T22:39:10.787

试试这个，

```
user = User.find(user_id)
user.user_levels.pluck(:user_group_id) 
```

或这个，

```
user.user_levels.map(&:user_group_id) 
```

第一个进行单独的数据库查询，仅选择`:user_group_id`. 例如，在 MySQL 中，它会调用`SELECT user_levels.user_group_id ...`.

第二个`:user_group_id`从 fetched中收集`user_levels`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-11T22:39:47.873

你确实在寻找`map`

```
user_group_ids = ul.map{|x| x.user_group_id} 
```

或者用简写：

```
user_group_ids = ul.map(&:user_group_id) 
```

您可能还希望只有不同的 id 而没有`nil`s

```
user_group_ids = ul.map(&:user_group_id).uniq.compact 
```

# performance - 为什么在函数式编程中计算阶乘更快/更有效？

> ID：15349933
> 
> 赞同：3
> 
> 时间：2013-03-11T22:31:11.587
> 
> 标签：performance, functional-programming, factorial

这是在以下答案之一中提出的声明：[https ://softwareengineering.stackexchange.com/a/136146/18748](https://softwareengineering.stackexchange.com/a/136146/18748)

> 尝试一两种函数式语言。尝试使用递归在 Erlang 中实现阶乘，并在 20000 时看到你的下巴撞到地板上！5 秒后返回（站点没有堆栈溢出）

为什么它比在 Java/C/C++/Python（任何）中使用递归/迭代更快/更有效？使这种情况发生的基本数学/理论概念是什么？不幸的是，我在本科时从未接触过函数式编程（以“C”开头），所以我可能只是不知道“为什么”。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-11T22:43:22.617

递归解决方案在 Java 或 C++ 中可能会更慢且更笨重，但我们不会在 Java 和 C++ 中那样做，所以。:)

至于为什么，函数式语言总是大量使用递归（因为默认情况下，它们要么必须跳过障碍，要么根本不允许修改变量，这本身就使得大多数形式的迭代无效或完全不可能） . 因此，他们必须有效地优化它才能具有竞争力。

几乎它们都实现了一种称为“尾调用消除”的优化，它使用当前调用的堆栈空间进行下一次调用，并将“调用”变成“跳转”。那个小小的改变基本上把递归变成了迭代，但不要提醒FPers。当涉及过程语言中的迭代和函数语言中的递归时，两者将证明在性能方面大致相同。（但是，如果其中任何一个仍然更快，那就是迭代。）

其余的是库和数字类型等。体面的数学代码 ==> 体面的数学表现。*除了大多数人不太关心*之外，没有什么可以阻止过程或 OO 语言进行类似的优化。另一方面，函数式程序员喜欢盯着他们计算斐波那契数列和 20000 的难易程度！以及我们大多数人无论如何都不会使用的其他数字。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-11T22:41:34.147

本质上，函数式语言使递归变得便宜。

特别是通过[尾调用优化。](http://c2.com/cgi/wiki?TailCallOptimization)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-11T23:01:52.333

[尾调用优化](http://en.wikipedia.org/wiki/Tail-call_optimization)

[惰性求值](http://en.wikipedia.org/wiki/Lazy_evaluation)：“使用延迟求值时，表达式不会在绑定到变量后立即求值，而是在求值器被迫产生表达式的值时进行求值。”

这个问题中说明了这两个概念，[关于在 Clojure 中实现阶乘的各种方法](https://stackoverflow.com/questions/1662336/clojure-simple-factorial-causes-stack-overflow)。您还可以在 Stuart Halloway 和 Aaron Bedra 的书[Programming Clojure](https://rads.stackoverflow.com/amzn/click/com/1934356867)中找到关于惰性序列和 TCO 的详细讨论。

从 Programming Clojure 中采用的以下函数创建了一个惰性序列，其中包含斐波那契数列的前 1M 个成员，并实现了第 10 万个成员：

```
user=> (time (nth (take 1000000 (map first (iterate (fn [[a b]] [b (+ a b)]) [0N 1N]))) 100000))
"Elapsed time: 252.045 msecs"
25974069347221724166155034.... 
(20900 total digits) 
```

（512MB 堆，英特尔酷睿 i7，2.5GHz）

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-03-12T00:48:40.290

它*并不*快（比什么？），它与尾调用优化无关（在这里抛出一个流行词还不够，还应该解释为什么尾调用优化应该比循环更快？根本不是这样！ )

请注意，相反，我不是函数式编程的仇恨者！但是传播神话并不适用于函数式编程。

顺便说一句，这里有没有人*实际*尝试过计算（和打印，这应该消耗至少 50% 所需的 CPU 周期）20000 需要多长时间！？

我做了：

```
main _ = println (product [2n..20000n]) 
```

这是一种编译为 Java 的 JVM 语言，它使用 Java 大整数（已知速度很慢）。它还受到 JVM 启动成本的影响。而且这不是最快的方法（例如，显式递归可以节省列表构造）。

结果是：

```
181920632023034513482764175686645876607160990147875264
...
... many many lines with digits
...          
000000000000000000000000000000000000000000000000000000000000000

real    0m3.330s
user    0m4.472s
sys     0m0.212s 
```

（在 Intel® Core™ i3 CPU M 350 @ 2.27GHz × 4 上）

我们可以放心地假设，在 C 中与 GMP 相同的情况甚至不会使用 50% 的时间。

因此，*功能性更快*是一个神话，*功能性更慢*。这甚至不是一个神话，只要一个人不说它的速度更快/更慢，这简直就是胡说八道。

# package - zendframework/zend-http 包需要49个组件正常吗？

> ID：15349935
> 
> 赞同：1
> 
> 时间：2013-03-11T22:31:19.263
> 
> 标签：package, zend-framework2, composer-php

这是`composer.json`：

```
{
    "repositories": [
        {
            "type": "composer",
            "url": "https://packages.zendframework.com/"
        }
    ],
    "require": {
        "zendframework/zend-http": "2.*"
    }
} 
```

...以及详尽的清单：

```
Authentication  Code     Db     Escaper       Filter  InputFilter  Log     Mime           Paginator    Server          Stdlib  Uri        XmlRpc
Barcode         Config   Debug  EventManager  Form    Json         Mail    ModuleManager  Permissions  ServiceManager  Tag     Validator
Cache           Console  Di     Feed          Http    Ldap         Math    Mvc            ProgressBar  Session         Test    Version
Captcha         Crypt    Dom    File          I18n    Loader       Memory  Navigation     Serializer   Soap            Text    View 
```

其中一些实际上是有道理的。但是`Barcode`, `Captcha`,`Navigation`甚至`Db`例如呢？

**编辑**

```
$ rm -rf vendor
$ rm -rf ~/.composer/
$ rm composer.lock 
$ more composer.json 
{
    "require": {
        "zendframework/zend-http": "2.*"
    }
}
$ composer self-update
You are using the latest composer version.
$ composer install
Loading composer repositories with package information
Installing dependencies
  - Installing zendframework/zendframework (2.1.3)
    Downloading: 100%

zendframework/zendframework suggests installing doctrine/common (Doctrine\Common >=2.1 for annotation features)
zendframework/zendframework suggests installing ext-intl (ext/intl for i18n features)
zendframework/zendframework suggests installing pecl-weakref (Implementation of weak references for Zend\Stdlib\CallbackHandler)
zendframework/zendframework suggests installing zendframework/zendpdf (ZendPdf for creating PDF representations of barcodes)
zendframework/zendframework suggests installing zendframework/zendservice-recaptcha (ZendService\ReCaptcha for rendering ReCaptchas in Zend\Captcha and/or Zend\Form)
Writing lock file
Generating autoload files 
```

PS：很高兴有些人认为我的问题很容易被关闭......我真的很感谢其他人试图回答。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-12T08:18:18.847

它没有。

使用该 composer.json 文件，我得到了这个：

```
$ composer.phar install
Loading composer repositories with package information
Installing dependencies
  - Installing zendframework/zend-stdlib (2.1.3)
    Downloading: 100%         

  - Installing zendframework/zend-servicemanager (2.1.3)
    Downloading: 100%         

  - Installing zendframework/zend-filter (2.1.3)
    Downloading: 100%         

  - Installing zendframework/zend-i18n (2.1.3)
    Downloading: 100%         

  - Installing zendframework/zend-validator (2.1.3)
    Downloading: 100%         

  - Installing zendframework/zend-escaper (2.1.3)
    Downloading: 100%         

  - Installing zendframework/zend-uri (2.1.3)
    Downloading: 100%         

  - Installing zendframework/zend-loader (2.1.3)
    Downloading: 100%         

  - Installing zendframework/zend-http (2.1.3)
    Downloading: 100%         

zendframework/zend-stdlib suggests installing pecl-weakref (Implementation of weak references for Stdlib\CallbackHandler)
zendframework/zend-servicemanager suggests installing zendframework/zend-di (Zend\Di component)
zendframework/zend-filter suggests installing zendframework/zend-crypt (Zend\Crypt component)
zendframework/zend-validator suggests installing zendframework/zend-db (Zend\Db component)
zendframework/zend-validator suggests installing zendframework/zend-math (Zend\Math component)
Writing lock file
Generating autoload files 
```

具有的依赖项的完整列表`zend-http`是：

*   逃脱者
*   筛选
*   i18n
*   装载机
*   服务经理
*   标准库
*   乌里
*   验证器

# node.js - 仅当 Redis 中存在密钥时才订阅频道

> ID：15349936
> 
> 赞同：0
> 
> 时间：2013-03-11T22:31:32.467
> 
> 标签：node.js, redis, publish-subscribe, atomic

在我的 nodejs 应用程序中，我使用 Redis 键作为通道名称。我希望客户端仅在存在相应密钥的情况下才订阅频道。问题在于 EXISTS 命令和 SUBSCRIBE 命令之间，另一个客户端可能会删除现有密钥。我不能使用 WATCH-MULTI-EXEC 使其原子化，因为我不能在 MULTI-EXEC 块中使用 SUBSCRIBE。我也不能使用 Lua 脚本。

在这种情况下是否有任何方法可以保持原子性？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-25T23:33:55.213

当前版本的 Redis 似乎是不可能的。我切换到不需要原子订阅的不同方法。

# internet-explorer - JQueryMobile + IE10：文本输入的额外图标：data-clear-btn="true"

> ID：15349937
> 
> 赞同：1
> 
> 时间：2013-03-11T22:31:43.077
> 
> 标签：internet-explorer, jquery-mobile, windows-mobile

只是想知道是否有人修复了这个错误。在 IE 10 上运行移动 Web 应用程序时，对于文本输入：data-clear-btn="true"; IE 10 添加了一个额外清晰的图标。它在 Chrome 和 Safari 中运行良好，但是在 IE 10 中，我一开始输入内容就会有两个清晰的图标。

我一直在尝试修复它，但到目前为止还没有找到解决方案。

对于演示，请在 IE 10 中打开此链接并在文本输入中输入一些内容：data-clear-btn="true"：

[http://jquerymobile.com/demos/1.3.0-beta.1/docs/demos/textinput/textinput.html#](http://jquerymobile.com/demos/1.3.0-beta.1/docs/demos/textinput/textinput.html#)

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-06-04T18:23:55.057

这是一个错误。设置为在 1.4 中修复： [https ://github.com/jquery/jquery-mobile/issues/6056](https://github.com/jquery/jquery-mobile/issues/6056)

# ruby-on-rails - capistrano 在捆绑安装时停止

> ID：15349941
> 
> 赞同：2
> 
> 时间：2013-03-11T22:32:08.933
> 
> 标签：ruby-on-rails, capistrano, bundler

只是遇到了 capistrano 食谱的问题。我尝试将 Rails 3.2 应用程序部署到 Solaris 服务器。一切正常，直到`bundle install`. 它抛出此错误`/opt/rubyenterprise/lib/gems/bin/bundle:9:in`需要'：没有要加载的此类文件--rubygems（LoadError）`。我将这些添加到配置文件中：

```
set :default_environment, {
'PATH' => [Full path on server],
'GEM_HOME' => '/opt/rubyenterprise/lib/gems',
'GEM_PATH' => '/opt/rubyenterprise/lib/gems/gems'
} 
```

我很确定我正确地得到了 $PATH、$GEM_HOME 和 $GEM_PATH。再次尝试但仍然出现错误。以前有没有人遇到过这个问题，你是如何解决的？服务器只运行 REE 1.8.7。

# sql - SQL 输出错误

> ID：15349947
> 
> 赞同：1
> 
> 时间：2013-03-11T22:32:31.293
> 
> 标签：sql, select

我正在使用以下查询：

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-11T23:06:10.060

*由于未提供示例数据，因此未对以下查询进行全面测试。*

```
SELECT  d.LecturerID, d.Name,
        c.CourseID, c.CourseName,
        a.Semester,
        a.percentageOfStudent
FROM
        (
            SELECT  CourseID,
                    Semester,
                    SUM(CASE WHEN grade >= 6 THEN 1 ELSE 0 END) * 1.0 / COUNT(*) * 100.0 percentageOfStudent
            FROM    Exam
            GROUP   BY CourseID, Semester
            HAVING  SUM(CASE WHEN grade >= 6 THEN 1 ELSE 0 END) * 1.0 / COUNT(*) * 100.0 < 50
        ) a 
        INNER JOIN Lecture b
            ON  a.CourseID = b.CourseID AND
                a.Semester = b.Semester
        INNER JOIN Course c
            ON  b.CourseID = c.CourseID
        INNER JOIN  Lecturer d
            ON b.LecturerID = d.LecturerID 
```

# javascript - 强制 Backbone fetch 始终使用 POST

> ID：15349949
> 
> 赞同：9
> 
> 时间：2013-03-11T22:32:45.427
> 
> 标签：javascript, backbone.js

我有一个 Collection 需要将一些数据发布到它的 url 以获取它需要的数据。这两个问题的答案，[Fetch a collection using a POST request?](https://stackoverflow.com/questions/6428823/backbone-js-fetch-a-collection-using-post) 并[在骨干模型中覆盖 fetch() 方法](https://stackoverflow.com/questions/10427086/overriding-fetch-method-in-backbone-model)，使我看起来应该能够让它像这样工作：

```
fetch: function( options ) {
  this.constructor.__super__.fetch.apply(this, _.extend(options,{data: {whatever: 42}, type: 'POST'}));
} 
```

，但 Firebug 仍然向我显示正在发生的 404 错误，因为正在针对有问题的 url 执行 GET（并且底层 Rails 路由只允许 POST）。这应该工作吗？如果是这样，我还能尝试什么？如果没有，我做错了什么？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2013-03-12T01:06:19.497

再次阅读问题后，这是一种强制 fetch 在`POST`每次 fetch 调用中使用的方法。（感谢评论）

```
yourCollection.fetch({
    data: $.param({id: 1234}), 
    type: 'POST', 
    success: function(d){
        console.log('success');
    }
}); 
```

另一种方法是覆盖 AJAX 实现本身以`POST`用于所有调用。

```
Backbone.ajax = function() {
    var args = Array.prototype.slice.call(arguments, 0);
    _.extend(args[0], { type: 'POST' });
    return Backbone.$.ajax.apply(Backbone.$, args);
}; 
```

# asp.net-mvc - 从参数 MVC 中获取值

> ID：15349957
> 
> 赞同：0
> 
> 时间：2013-03-11T22:33:25.447
> 
> 标签：asp.net-mvc

如何从参数中获取值？我有链接：
1）`http://localhost:2409/Account/Confirmation/16`或
2）`../Account/Confirmation/12ds-2saa-fcse`
我想在控制器方法中获得“16”或“12ds-2saa-fcse”。

我的方法

```
 public ActionResult Confirmation(int id)
    {
        ViewBag.Message = "ID is: " + id;
        return View();
    } 
```

但它返回null。

路线：

```
 routes.MapRoute(
        name: "Default",
        url: "{controller}/{action}/{id}",
        defaults: new { controller = "Home", action = "Index", id = UrlParameter.Optional }
    ); 
```

我怎样才能做到这一点？

编辑！

一切正常，我不知道为什么，但重启 VS2012 有帮助.. :O

现在是另一个问题。有没有可能`hash`从这个链接中获得价值？`/Account/Confirmation/16?hash=dasdsadasda`. 下面的代码不显示哈希字符串..

```
 public ActionResult Confirmation(int id, string hash)
    {
        ViewBag.Message = "ID is: " + id + HttpUtility.HtmlEncode("hash");
        return View();
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-11T23:02:21.710

您更新的问题是您正在对字符串进行编码`"hash"`；不是字符串变量的值`hash`。

这：

```
public ActionResult Confirmation(int id, string hash)
{
    ViewBag.Message = "ID is: " + id + HttpUtility.HtmlEncode("hash");
    return View();
} 
```

应该变成这样：

```
public ActionResult Confirmation(int id, string hash)
{
    ViewBag.Message = "ID is: " + id + HttpUtility.HtmlEncode(hash);
    return View();
} 
```

# linux - 为什么关闭一个失效的 tcp-socket 会影响另一个打开的 tcp 套接字？

> ID：15349958
> 
> 赞同：2
> 
> 时间：2013-03-11T22:33:29.920
> 
> 标签：linux, windows, sockets, networking, nat

我们面临一个奇怪的问题，即关闭一个死掉的 tcp 套接字（由拔掉电线引起）会影响另一个正常打开的 tcp 套接字。以下是详细信息：

1.  拓扑
    客户端 A ←→ 交换机 A ← 路由器 A:NAT ← .. 网络 .. → 路由器 B:NAT → 交换机 B ←→ 服务器 B

2.  问题：
    假设客户端和服务器之间，由于拔掉电线而导致连接失效。拔掉电缆（机器和交换机之间）后，我们从另一台机器登录客户端 A，现在客户端和服务器之间将有一个新的 tcp 连接，这个连接是正常的。

    **我们发现，从服务器端，如果我们在 tcp 内核还在重传数据的时候关闭了死掉的 tcp 连接，那么另一个 tcp 连接似乎被污染了，从客户端到服务器的方向将变得不可用，这意味着客户端发送的数据通过连接将永远不会被服务器接收，但令我们惊讶的是另一个方向 - 从服务器到客户端 - 仍然可以，通过服务器发送的相同 tcp 套接字数据到达客户端计算机。**

    但是如果我们等到死连接的tcp数据传输停止，比如2小时，然后关闭socket，那么另一个tcp连接仍然可以。

**下面是这个问题的详细步骤：**
**1、有两个客户端，都在Router A后面：NAT，NAT是full-cone。**
**2、Router B:NAT后面有一个linux服务器，NAT是full-cone，但是这里使用端口转发。**
**3、四台机器，两个客户端说是X，Y，服务器说是**S。
**4\. X 和 Y 登录并设置视频会议，现在他们都创建了到服务器的 tcp 连接，说他们是通道 CX 和通道 CY**
**5\. 拔掉运行 Y 客户端的机器的电缆，现在通道 CY 坏了并且死了。但是通道 CX 仍然可以。**
**6\. 在第四台机器上登录 Y 并再次与 X 建立视频会议，现在有一个新的 tcp 通道，说它是 CY2**。

**结果：**
**在第6步中，如果服务器关闭死连接——CY——在几分钟内，那么新的通道CY2将变成单向——从客户端Y发送的数据不能到达服务器，包括ACK数据包。好的，反之亦然。**

**如果服务器长时间关闭死连接 - CY - 2小时，则不会出现问题**。

**这个问题只发生在通过 NAT 运行时，至少我们在同一个 LAN 中运行应用程序时不会重现它（无需遍历 NAT）。**

有人知道为什么会发生吗？

编辑：
在服务器端，我们使用非阻塞 tcp 套接字并选择模型。

```
 psuedocode:  
     //server
     listenfd = socket(,SO_STREAM,);
     localAddr.port = htons(8013);
     localAddr.ip = inet_addr(INADDR_ANY);
     bind(localAddr...)
     listen(listenfd, 100);

     ...
     //using select model
     select(maxFd, &fdSet, NULL, NULL);
     for(...)
     {
     if (FD_ISSET(listenfd))
        {
        fd = accept(...)
        set_non_block(fd);
        ...
        }
     ...
     } 
```

**更多信息：**
**1）第一台机器上的连接 A：192.168.10.4:13000 ←→ ... ← 路由器 A：NAT ← -现在：来自 PublicIP：8661（随机）..网络 .. → 路由器 B：NAT（到端口:8013, 端口转发) → ... ←→ 服务器 B**

**2）第二台机器上的连接 B：192.168.10.7:13000 ←→ ... ← 路由器 A：NAT ← -现在：从 PublicIP：8777（随机）..网络 .. → 路由器 B：NAT（到端口：8013，端口转发）→ ... ←→ 服务器 B**

**3) 拔掉电线，连接 A 已死，现在在第三台机器上创建一个新连接 C：192.168.10.10:13000 ←→ ... ← Router A:NAT ← -Now: from PublicIP:8869 (random).. Network ..→路由器B：NAT（到端口：8013，端口转发）→...←→服务器B**

**如果我们从服务器关闭连接 A，则连接 C 将变为单向，但如果我们在 2 小时内从服务器关闭连接 A，则连接 C 保持正常。**

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-18T22:12:24.680

哇，真是个难题。我确实认为我有一个可能的答案。而且我不太喜欢其中的含义-但我想在查看标准时它们是不可避免的（[这里](http://en.wikipedia.org/wiki/Network_address_translation#Methods_of_Port_translation)是维基百科的简化）。

NAT（尤其是全锥体）通过给客户端一个内部地址（ip 和端口）来工作，以匹配它试图到达的外部地址。任何返回流量都会发送到内部地址，然后由路由器转发到外部地址。

让我们用一个例子来扩展这个简短的解释，并展示这对你意味着什么......

假设你有一个 NAT 网关，将 80 端口转发到内部服务器，内部目标也是 80 端口。网关有外部 IP`n.n.n.n`和内部 IP `y.y.y.y`。

当客户端连接到`n.n.n.n:80`NAT 服务器时，它会忠实地将请求转发给`y.y.y.y:80`，但在此过程中它会重写 IP 帧。发送端地址现在是NAT网关内部IP，发送端端口不再是客户端写的，而是NAT网关分配的新端口。

新端口是由 NAT 网关分配的，是的。但它是根据客户端 IP 和它尝试访问的端口（在本例中为 80）分配的。

一切都很好，但是...当客户端建立其第二个连接时，将使用相同的映射功能。这不应该造成问题吗？那么它可以。如果网关不区分不同的客户端地址（理想情况下，来自客户端的每个连接都应该有一个唯一的端口），它将简单地覆盖旧连接的映射。

从而导致来自旧套接字的重新发送流量被发送到客户端的新套接字。

非常不受欢迎，但可能取决于 NAT 的实现方式。而且由于这似乎是NAT的问题-直接连接时不会显示...

现在，我已经在我的解释中看到了一个漏洞——也就是说，这意味着你不能同时向同一个服务器打开两个套接字，因为任何返回都会出现乱码。好吧，我能想到这行得通的唯一原因是套接字仍然打开 - 因此网关不会将其视为已死，然后为该客户端创建第二个映射。

希望我至少有点道理。

# c++ - GCC 拒绝在 PowerPC 上对 operator new/delete 发出长时间的调用

> ID：15349959
> 
> 赞同：16
> 
> 时间：2013-03-11T22:33:30.860
> 
> 标签：c++, gcc, powerpc

PowerPC 分支只有 24 位可用于目标偏移量，因此如果文本部分变得太大，一端的分支将无法到达另一端的目标。有更长的指令序列可以到达更远的目标（偏移量是 32 位而不是 24 位），但 GCC 默认不使用它，除非您将`-mlongcall`选项传递给它。`operator new`然而，即使打开了这个选项，GCC 仍然会为某些函数生成短调用，即`operator delete`

例如，给定以下代码：

```
extern void foo();

int main(int argc, char** argv) {
    foo();
    new char;
} 
```

GCC 的正常运行将生成程序集：

```
bl _Z3foov // void foo()
bl _Znwj   // operator new(unsigned int) 
```

`-mlongcall`使用该选项运行 GCC 会生成：

```
lis r9, _Z3foov@ha
addi r9, r9, _Z3foov@l
mtctr r9
bctrl
bl _Znwj 
```

正如预期的那样，前四个指令是对 的长时间调用`foo()`，但对 的调用`operator new`没有改变。对随机 libc 和 libstdc++ 函数的调用都按预期转换为长调用。为什么`operator new`和`operator delete`调用仍然作为`bl`指令结束？有什么办法可以迫使 GCC 也进行长时间的通话吗？我在 64 位 PowerPC Fedora 机器上使用 GCC 4.7.2（虽然我正在构建 32 位）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-12T19:49:28.573

似乎 g++ 工具链在调用架构上 C++ 标准库的八个“可替换”函数时存在某种错误，如果这些函数实际上没有被用户代码替换的话。

所有八个的可移植替代实现是：

```
#include <memory>
#include <cstdlib>

// May never return a null pointer.
void* operator new(std::size_t size) {
    void* p = std::malloc(size, 1);
    while (!p) {
        std::new_handler handler = std::get_new_handler();
        if (handler) {
            handler();
        } else {
            throw std::bad_alloc();
        }
        // A handler is only allowed to return if it did something to make more
        // memory available, so try again.
        p = std::malloc(size, 1);
    }
    return p;
}

void operator delete(void* p) noexcept {
    if (p) std::free(p);
}

void* operator new(std::size_t size, const std::nothrow_t&) noexcept {
    void* p = nullptr;
    try {
        p = operator new(size);
    } catch(...) {}
    return p;
}

void operator delete(void* p, const std::nothrow_t&) noexcept {
    operator delete(p);
}

// May never return a null pointer.
void* operator new[](std::size_t size) {
    return operator new(size);
}

void operator delete[](void* p) noexcept {
    operator delete(p);
}

void* operator new[](std::size_t size, const std::nothrow_t& nt) noexcept {
    return operator new(size, nt);
}

void operator delete[](void* p, const std::nothrow_t& nt) noexcept {
    operator delete(p, nt);
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-11-28T04:22:15.407

如果我们可以在#pragma long_calls 下定义这个函数或者在这个函数中声明long-call 属性，我们也可以强制GCC 进行长调用。签出 GCC 选项。

# php - jQuery 不返回 JSON 数据

> ID：15349960
> 
> 赞同：2
> 
> 时间：2013-03-11T22:33:46.140
> 
> 标签：php, javascript, jquery, html, json

我有一个基本脚本，旨在从 JSON 提要中获取一些数据并在警报中返回。我似乎无法让我的代码工作。我正在使用 jQuery 并调用托管在单独域上的脚本。即使正确加载了 jQuery 以及所有其他常见问题，我当前的代码甚至都不会显示警报。

有没有人有任何想法？

我的代码是：

```
$.getJSON("http://www.domain.com/api.php?q=test&callback=?",
function(data) {
    alert(data.users[0].firstName);
}); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-11T22:41:27.237

如果我打电话

```
http://pulse.wixiy.net/playground/search/api.php?q=wixiy&callback=? 
```

在我的浏览器中，响应是

```
({"users":[ { "firstName":"Ray", "lastName":"Villalobos", "joined":2012 }, { "firstName":"John", "lastName":"Jones", "joined":2010 } ]}) 
```

这是一个纯 JSON 字符串，但没有有效的 JSONP 响应。对于有效的 JSONP 响应，您需要一个调用~~JSON 字符串~~对象文字的函数调用。

```
jQuery4022random242932crap311({"users":[ { "firstName":"Ray", "lastName":"Villalobos", "joined":2012 }, { "firstName":"John", "lastName":"Jones", "joined":2010 } ]}); 
```

其中*jQuery4022random242932crap311*是 jQuery 在将 a`?`作为参数传递给*callback*时生成的某个名称。您的服务器需要读取该参数并创建上述答案。

# php - mysql的逻辑问题

> ID：15349963
> 
> 赞同：0
> 
> 时间：2013-03-11T22:34:30.850
> 
> 标签：php, mysql

我有一家手表网上商店。它有一个搜索过滤器。过滤的标准之一是表身的材料。它有很多独特的价值。例如：“钢”、“钢镀金”、“钢镀金”。

我试图通过创建一个 sql LIKE 请求来过滤手表，以过滤钢体、金体的手表。但是，当搜索带有金色机身的手表时，它也会给我镀金的钢表，因为它包含“金”这个词。

你能提出一个好的解决方案来解决这个问题吗？

到目前为止，我尝试了这个 sql 语句：

```
SELECT * FROM `watches` WHERE `material` LIKE "%gold%" 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-11T23:14:17.517

如果我这样做，我将创建一个名为“Material”的表并为每种可用材料添加一条记录，然后将材料 ID 存储在手表表中而不是单词中。（这有很多更好的原因。）

材料表：

```
id - Material
1 - Gold
2 - Gold Plated
3 - Silver
4 - Steel with Gold 
```

然后在您的搜索中，您将允许用户选择他们感兴趣的材料，您的 sql 将如下所示：

```
Select * from Watches where Material IN (1,4); 
```

这将带来一块由金或钢制成的手表。您的搜索会更快。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-11T22:52:01.477

```
$criterium = "gold";
$query = mysql_query("SELECT * FROM watches WHERE material = '$criterium'"); 
```

它应该可以解决您的问题。还要检查 SQL LIKE 条件以进行进一步查询

# uiwebview - 带有自定义手势的 UIWebView

> ID：15349967
> 
> 赞同：0
> 
> 时间：2013-03-11T22:34:39.383
> 
> 标签：uiwebview, uigesturerecognizer

截至目前，我有一个内部带有 UIWebView 的视图和一些添加的自定义手势。这些手势的一些例子是`Two Finger Slide Right to Go Back`, `Two Finger Slide Left to Go Forward`, `Two Finger Long Press for Refresh`, 等。但现在我面临一个问题，我知道当我开始开发这个应用程序时我必须面对：

**除非**UIWebView 被放大，否则所有手势都很好用。即使它被放大到最小的一点（或者您可以水平滚动网页），需要您向左或向右滑动的手势也会突然被禁用，因为 UIWebView优先于这些手势。

![http://i47.tinypic.com/243rdyx.png](../Images/af7a18d316f6294ef6ce793dc47e31aa.png)

如果有人能对这个问题有所了解，甚至提供解决方法，我将不胜感激。谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-11T22:58:53.180

我对 OS X 比较熟悉，但是你可以继承 UIWebView 来消除这种行为吗？

# .htaccess - htaccess 中的 301 重定向。匹配页面 ID

> ID：15349974
> 
> 赞同：0
> 
> 时间：2013-03-11T22:35:25.203
> 
> 标签：.htaccess, mod-rewrite, url-rewriting, http-status-code-301

我需要一些帮助，为以下类型的 url 创建 htaccess 301 重定向。

总共有大约 500 种左右的产品，但不是为每个 url 写一个重定向，这将非常庞大且耗时，我希望有一种我还没有找到的更简单的方法来创建一种正则表达式匹配?

旧：[http ://www.example.co.uk/test-product-name-slug/prod_233.html](http://www.example.co.uk/test-product-name-slug/prod_233.html)

新：[http ://www.example.co.uk/test-product-name-slug-233​​.html](http://www.example.co.uk/test-product-name-slug-233.html)

可以通过浏览到 .....example.co.uk/-223.html ......访问新 URL，然后重写为 .....example.co.uk/test-product-name -slug-233​​.html

所以看起来我需要一种方法来检测传入的访问者是否来到一个包含 prod_id 并重定向到 -id 的 url

我希望一切都说得通。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-12T21:45:33.827

希望这是您正在寻找的。它只匹配 1 个目录

`/some-product_name-random/prod_9393.html`=>`/some-product_name-random-9393.html`

**.htaccess**

```
RewriteEngine on 
RewriteBase /

RewriteRule ^([a-zA-A-_]+)/prod_([0-9]+)\.html$ /$1-$2.html [R=301,L,QSA] 
```

**正则表达式和参数解释**

`([a-zA-A-_]+)`匹配产品名称`$1`

`prod_([0-9]+)`匹配产品 ID`$2`

`[R=301]`301永久重定向

`[L]`停止 .htaccess 脚本（可能会被删除，但在针对不同场景使用多个规则时，通常是特定规则的好习惯）

`[QSA]`保留查询字符串`domain.com/somepath/page.html?querystring=value&otherstuff`( `?...`)

# jsf - JSF中的验证失败javascript回调

> ID：15349979
> 
> 赞同：9
> 
> 时间：2013-03-11T22:35:44.420
> 
> 标签：jsf, primefaces

我有一个模板，当组件验证失败时，我可以在其中向 div 添加一个 CSS 错误类，并且它在浏览器上呈现出非常好的效果。

现在，**我不需要向组件添加 css 类**（[这](https://stackoverflow.com/questions/10993615/highlight-an-inputtext-in-jsf-2-0-when-a-validation-error-occurs)对我没有帮助），而是我需要更改围绕它的 html 的 css，这对于 jQuery 来说非常简单，但是我可以'似乎找不到验证失败的 javascript 回调，这可能吗？我也在使用 primefaces（以防它们提供此类功能）。

标记：

```
<div class="control-group ERROR_CLASS_GOES_HERE_IF_VALIDATION_FAILED">
   <label class="control-label">Input value:</label>
   <div class="controls">
      <h:inputText class=" inputbox" type="text" required="true" /> <!--Component that can fail -->
   </div>
</div> 
```

如果输入文本为空，我需要包装“控制组”的 div 有一个额外的类。我可以把它变成一个`<h:panelGroup>`，所以它是一个 JSF 组件，但我仍然不知道该怎么做。Javascript 似乎更容易，因为我可以这样做：

```
jQuery("#ID_OF_DIV").addClass("error_class") 
```

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2013-03-13T11:52:11.213

只需让 JSF/EL 有条件地打印基于[`FacesContext#isValidationFailed()`](http://docs.oracle.com/javaee/6/api/javax/faces/context/FacesContext.html#isValidationFailed%28%29).

```
<div class="control-group #{facesContext.validationFailed ? 'error_class' : ''}"> 
```

你只需要确保这个元素被 ajax update/render 覆盖。

另一种方法是挂钩`oncomplete`任意基于 PrimeFaces ajax 的组件的事件。范围中有一个`args`可用的对象，该对象又具有一个`validationFailed`属性。例如`<p:commandButton oncomplete>`，甚至`<p:ajaxStatus oncomplete>`。

```
<p:ajaxStatus ... oncomplete="if (args &amp;&amp; args.validationFailed) $('#ID_OF_DIV').addClass('error_class')"> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-12T04:26:45.413

如果你想在客户端做所有事情。

```
 <h:outputText class="samplecls" rendered="#{facesContext.validationFailed}"
              value="Please enter all the required fields">
    </h:outputText>  

    <div class="control-group ERROR_CLASS_GOES_HERE_IF_VALIDATION_FAILED">
       <label class="control-label">Input value:</label>
       <div class="controls">
          <h:inputText class=" inputbox" type="text" required="true" /> <!--Component that can fail -->
       </div>
    </div> 
```

**Javascript/Jquery**

```
 This class will exist in DOM only validation fails by rendered="#{facesContext.validationFailed}"

  $(window).load(function(){ 
      if($('.samplecls').length>0){
            $("#ID_OF_DIV").addClass("error_class");    
        }
}); 
```

# position - Lisp - 从位置删除

> ID：15349980
> 
> 赞同：1
> 
> 时间：2013-03-11T22:35:45.973
> 
> 标签：position, lisp, sublist, removeall

我需要一个函数来删除起始列表和所有子列表中第 n 个位置的元素。我不需要工作代码，我只需要任何建议。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-12T02:53:18.313

寻求建议而不是最终解决方案是值得称赞的。我会尽力向你解释。

单链表有助于从前端到后端进行递归处理。您可以通过廉价的操作来获取列表的第一个元素，其余元素，并通过将新元素放在前面来构建列表。一个简单的递归方案是：从列表中取出第一个元素，对其进行处理，然后将其放在与列表的其余部分重复整个过程的结果的前面。这种对连续元素和休止符的重复过程是递归部分。如果输入列表为空，则无事可做，返回空列表，结束处理。这是您的基本情况、锚点或任何您想称呼它的名称。记住：递归案例，基本案例，检查 - 你需要两者。

（由于 Lisp 的评估规则，要将已处理的元素实际放在已处理的其余元素之前，必须记住它，直到实际处理其余部分，因为构建列表的操作在返回新列表之前评估其两个参数。这些中间结果将被保留在堆栈上，这对于大列表可能是个问题。有一些方法可以避免这种情况，但我们会在这里保持简单。）

现在，您实际上不仅要求简单列表，还要求树。方便的是，该树表示为一个嵌套列表，因此通常上述方法仍然适用，除了有点复杂：您必须检查您要处理的元素本身是否是一个分支，即一个列表。如果是，那么整个过程也必须在该分支上完成。

基本上就是这样。现在，要从树中删除一个元素，您的操作只是检查您的元素是否匹配，如果是，则删除它。更详细地说：

*   要从空列表中删除元素，只需返回一个空列表。

*   如果第一个元素本身是一个列表，则返回一个从第一个元素构建的列表，其中所有匹配项被删除作为其第一个元素，其余所有匹配项被删除作为其剩余部分。

*   如果它的第一个元素匹配，则返回列表的其余部分，并删除所有匹配的元素。（请注意，这里有些东西被“丢弃”了。）

*   否则，返回一个从第一个元素构建的列表作为它的第一个元素，然后返回列表的其余部分，并删除所有匹配的元素作为它的其余部分。

看一下这个并尝试找到您的递归案例、基本案例以及遍历嵌套树结构的方法。如果您了解所有这些，则实施将很容易。如果你从来没有真正学会这一切，而且你的头脑现在还没有转动，那么认为你自己是一个天生的 Lisp 程序员。否则，递归只是一个基本概念，第一次可能很难掌握，但一旦点击，就像骑自行车一样。

埃德：不知何故错过了“位置”部分，并且误读了——尽管有问题的标题。这就是疲劳对人的影响。

无论如何，如果您想按位置删除树中的元素，您可以让您的函数采用可选的计数器参数（或者您可以使用提供它的包装函数）。如果您查看以上几点，递归新分支将是您重置计数器的地方。基本的递归方案保持不变，但不是比较元素本身，而是检查您的计数器——如果它与您要删除的位置匹配，则删除该元素。在每种递归情况下，您将递增的计数器传递给您的函数，除非在进入新分支时重置它，即为您的计数器参数传递 0。（您也可以在删除元素后只返回列表的其余部分，从而提高函数的性能，特别是对于要删除靠近开头的元素的长列表，但是让'

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-12T02:48:54.323

我的方法如下：

1.  删除顶级列表中的第 n 个元素
2.  从 #1 的结果中递归删除每个子列表中的第 n 个元素

我会这样实现它：

```
(defun (del n l)
  (defun (del-top-level n l)
    ...) ; return l but with nth gone
  (mapcar #'(lambda (l) (if (not (listp l)) l (del n l)))
          (del-top-level n l))) 
```

您需要实现该`del-top-level`功能。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-03-11T23:36:07.213

好的，我想我知道您需要什么。

你应该需要两个功能

入口函数只会调用一个辅助函数，例如 (DeleteHelper position position myList)

DeleteHelper 将递归调用自身，如果当前位置不为 0，则可选择包含列表的当前元素。例如 (cons (car myList) (DeleteHelper (- position 1) originalPosition (cdr myList))

如果 DeleteHelper 遇到一个列表，则递归遍历该列表，并将位置重置为原始传入位置。如 (cons (DeleteHelper originalPosition originalPosition (car myList)) (DeleteHelper (- position 1) originalPosition (cdr myList)))

还要记住基本情况（我想一旦你遍历整个列表就会返回一个空列表）。

这应该让你朝着正确的方向前进。自从我写任何 Lisp 以来也已经有几年了，所以我的语法可能有点不对劲。

# php - 将 mysql 转换为 mysqli 是否非常必要？

> ID：15349981
> 
> 赞同：0
> 
> 时间：2013-03-11T22:35:47.120
> 
> 标签：php, mysql, mysqli, acl

这是我的交易：我找到了一个简单的 ACL，并且完全爱上了它。问题？这一切都在 mysql 中，而不是 mysqli 中。我网站的其余部分是用 mysqli 编写的，所以这让我很困扰。

我的问题是 ACL 可以在没有全局变量的情况下轻松连接，因为我已经连接到数据库，而 mysql 不是面向对象的。

1）是否需要转换为mysqli？2）我怎样才能轻松地全部转换？

代码：

```
<?

    class ACL
    {
        var $perms = array();       //Array : Stores the permissions for the user
        var $userID = 0;            //Integer : Stores the ID of the current user
        var $userRoles = array();   //Array : Stores the roles of the current user

        function __constructor($userID = '')
        {
            if ($userID != '')
            {
                $this->userID = floatval($userID);
            } else {
                $this->userID = floatval($_SESSION['userID']);
            }
            $this->userRoles = $this->getUserRoles('ids');
            $this->buildACL();

        }

        function ACL($userID = '')
        {
            $this->__constructor($userID);
            //crutch for PHP4 setups
        }

        function buildACL()
        {
            //first, get the rules for the user's role
            if (count($this->userRoles) > 0)
            {
                $this->perms = array_merge($this->perms,$this->getRolePerms($this->userRoles));
            }
            //then, get the individual user permissions
            $this->perms = array_merge($this->perms,$this->getUserPerms($this->userID));
        }

        function getPermKeyFromID($permID)
        {
            $strSQL = "SELECT `permKey` FROM `permissions` WHERE `ID` = " . floatval($permID) . " LIMIT 1";
            $data = mysql_query($strSQL);
            $row = mysql_fetch_array($data);
            return $row[0];
        }

        function getPermNameFromID($permID)
        {
            $strSQL = "SELECT `permName` FROM `permissions` WHERE `ID` = " . floatval($permID) . " LIMIT 1";
            $data = mysql_query($strSQL);
            $row = mysql_fetch_array($data);
            return $row[0];
        }

        function getRoleNameFromID($roleID)
        {
            $strSQL = "SELECT `roleName` FROM `roles` WHERE `ID` = " . floatval($roleID) . " LIMIT 1";
            $data = mysql_query($strSQL);
            $row = mysql_fetch_array($data);
            return $row[0];
        }

        function getUserRoles()
        {
            $strSQL = "SELECT * FROM `user_roles` WHERE `userID` = " . floatval($this->userID) . " ORDER BY `addDate` ASC";
            $data = mysql_query($strSQL);
            $resp = array();
            while($row = mysql_fetch_array($data))
            {
                $resp[] = $row['roleID'];
            }
            return $resp;
        }

        function getAllRoles($format='ids')
        {
            $format = strtolower($format);
            $strSQL = "SELECT * FROM `roles` ORDER BY `roleName` ASC";
            $data = mysql_query($strSQL);
            $resp = array();
            while($row = mysql_fetch_array($data))
            {
                if ($format == 'full')
                {
                    $resp[] = array("ID" => $row['ID'],"Name" => $row['roleName']);
                } else {
                    $resp[] = $row['ID'];
                }
            }
            return $resp;
        }

        function getAllPerms($format='ids')
        {
            $format = strtolower($format);
            $strSQL = "SELECT * FROM `permissions` ORDER BY `permName` ASC";
            $data = mysql_query($strSQL);
            $resp = array();
            while($row = mysql_fetch_assoc($data))
            {
                if ($format == 'full')
                {
                    $resp[$row['permKey']] = array('ID' => $row['ID'], 'Name' => $row['permName'], 'Key' => $row['permKey']);
                } else {
                    $resp[] = $row['ID'];
                }
            }
            return $resp;
        }

        function getRolePerms($role)
        {
            if (is_array($role))
            {
                $roleSQL = "SELECT * FROM `role_perms` WHERE `roleID` IN (" . implode(",",$role) . ") ORDER BY `ID` ASC";
            } else {
                $roleSQL = "SELECT * FROM `role_perms` WHERE `roleID` = " . floatval($role) . " ORDER BY `ID` ASC";
            }
            $data = mysql_query($roleSQL);
            $perms = array();
            while($row = mysql_fetch_assoc($data))
            {
                $pK = strtolower($this->getPermKeyFromID($row['permID']));
                if ($pK == '') { continue; }
                if ($row['value'] === '1') {
                    $hP = true;
                } else {
                    $hP = false;
                }
                $perms[$pK] = array('perm' => $pK,'inheritted' => true,'value' => $hP,'Name' => $this->getPermNameFromID($row['permID']),'ID' => $row['permID']);
            }
            return $perms;
        }

        function getUserPerms($userID)
        {
            $strSQL = "SELECT * FROM `user_perms` WHERE `userID` = " . floatval($userID) . " ORDER BY `addDate` ASC";
            $data = mysql_query($strSQL);
            $perms = array();
            while($row = mysql_fetch_assoc($data))
            {
                $pK = strtolower($this->getPermKeyFromID($row['permID']));
                if ($pK == '') { continue; }
                if ($row['value'] == '1') {
                    $hP = true;
                } else {
                    $hP = false;
                }
                $perms[$pK] = array('perm' => $pK,'inheritted' => false,'value' => $hP,'Name' => $this->getPermNameFromID($row['permID']),'ID' => $row['permID']);
            }
            return $perms;
        }

        function userHasRole($roleID)
        {
            foreach($this->userRoles as $k => $v)
            {
                if (floatval($v) === floatval($roleID))
                {
                    return true;
                }
            }
            return false;
        }

        function hasPermission($permKey)
        {
            $permKey = strtolower($permKey);
            if (array_key_exists($permKey,$this->perms))
            {
                if ($this->perms[$permKey]['value'] === '1' || $this->perms[$permKey]['value'] === true)
                {
                    return true;
                } else {
                    return false;
                }
            } else {
                return false;
            }
        }

        function getUsername($userID)
        {
            $strSQL = "SELECT `username` FROM `users` WHERE `ID` = " . floatval($userID) . " LIMIT 1";
            $data = mysql_query($strSQL);
            $row = mysql_fetch_array($data);
            return $row[0];
        }
    }

?> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-11T22:48:33.573

只需`$mysqli`向这个类添加一个属性，并`MySQLi`在构造函数中将对象传递给它。

```
class ACL {

  private $mysqli;

  public function __construct(MySQLi $mysqli) {
    $this->mysqli = $mysqli;
    /* rest of your code */
  }
} 
```

剩下的就是搜索和替换了。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-11T22:51:35.040

编写代码以支持 PHP4。这告诉了我两件事：首先，作者即使想使用 mysqli 也无法使用，因为 PHP4 没有它，其次，代码可能很旧，并且是在 PHP 开发人员开始真正尝试之前编写的推动开发者使用 mysqli 而不是 mysql。

如果它写得很好，那么将其转换为使用 mysqli 应该是小菜一碟。mysql 和 mysqli 在基本级别上的 API 差异实际上非常小。主要区别是将连接对象传递给查询函数的要求。这在 mysql 中是可选的，并且经常被忽略，因为它似乎在这段代码中。

因此，您的主要挑战是让该连接对象变量在您进行 mysqli 函数调用的任何地方都可用。简单的方法就是让它成为类的属性，所以它在类的任何地方都可用。

我还建议您放弃其他 php4 支持位；它们不是必需的，它们会妨碍您。

# android - 如何使用 ADT 在 Eclipse 中运行“android 更新项目”？

> ID：15349982
> 
> 赞同：1
> 
> 时间：2013-03-11T22:36:03.283
> 
> 标签：android, eclipse, ant, adt

我正在将一个 Android 构建系统从 ADT 迁移到大多数开箱即用的 Ant，并希望让开发人员尽可能轻松。新的结帐不包含 local.properties （如建议的那样，这很有意义），并且构建对您大喊大叫：

```
sdk.dir is missing. Make sure to generate local.properties using 
'android update project' or to inject it through the ANDROID_HOME 
environment variable. 
```

这些步骤中的任何一个都足够乏味，以至于在 Windows 下每次新结帐后都这样做是令人讨厌的。鉴于 ADT 知道 SDK 位置（而这正是我们真正需要的），有没有办法将文件吐出，而不必`cmd`深入钻入 Windows 环境变量？

我尝试了项目 > Android 工具 > 修复项目属性，但这似乎并没有处理 local.properties。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-11T23:59:54.197

没有办法做到这一点。带有 ADT 的 Eclipse 对构建项目的某些部分使用了不同的机制。我不确定为什么在每次结帐后设置 ANDROID_HOME 都很乏味。您只需设置一次。

# ios - UITableView 单元格附件查看图像问题

> ID：15349983
> 
> 赞同：11
> 
> 时间：2013-03-11T22:36:07.407
> 
> 标签：ios, xcode, uitableview

我正在尝试使用以下代码在 UITableViewCells 的特定行上显示“挂锁”图标：

```
- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath
{
    UITableViewCell *cell = [tableView dequeueReusableCellWithIdentifier:@"TopicCell"];

    GPBTopic *topic = [self.topics.list objectAtIndex:indexPath.row];
    cell.textLabel.text= topic.name;

    if ((indexPath.row == 5) || (indexPath.row == 9))
    {
            cell.accessoryView = [[ UIImageView alloc ] initWithImage:[UIImage imageNamed:@"lock_icon.png"]];;
            [cell.accessoryView setFrame:CGRectMake(0, 0, 24, 24)];

    }

    return cell;
} 
```

我得到了一个有趣的结果 - 挂锁最初显示在第 5,9 行，但是当我向下和向上滚动列表时，图标也会在其他单元格的附件视图上随机重新显示（顺便说一句，只有 1 个部分），并且滚动变得非常生涩和滞后......我向上/向下滚动的次数越多，显示的实例就越多！为什么？这里的错误在哪里？

帮助，谢谢！

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2013-03-11T23:13:54.697

细胞被重复使用。每次都需要重置accessoryView。它只是一个小变化：

```
- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath
{
    UITableViewCell *cell = [tableView dequeueReusableCellWithIdentifier:@"TopicCell"];

    GPBTopic *topic = [self.topics.list objectAtIndex:indexPath.row];
    cell.textLabel.text= topic.name;

    if ((indexPath.row == 5) || (indexPath.row == 9))
    {
      cell.accessoryView = [[ UIImageView alloc ] initWithImage:[UIImage imageNamed:@"lock_icon.png"]];
      [cell.accessoryView setFrame:CGRectMake(0, 0, 24, 24)];
    } else {
      cell.accessoryView = nil; 
    }

    return cell;
} 
```

只是为了完成，您也可以像这样使用 Eric 的解决方案 - 它可能会更快，因为不是每次都创建 imageView。但这只是很小的差异。可能您的滞后还有其他原因。

```
- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath
{
    UITableViewCell *cell = nil;
    if(indexPath.row == 5 || indexPath.row == 9) {
        cell = [tableView dequeueReusableCellWithIdentifier:@"TopicCellWithImage"];
        cell.accessoryView = [[ UIImageView alloc ] initWithImage:[UIImage imageNamed:@"lock_icon.png"]];;
        [cell.accessoryView setFrame:CGRectMake(0, 0, 24, 24)];
    } else {
        cell = [tableView dequeueReusableCellWithIdentifier:@"TopicCell"];
    }

    GPBTopic *topic = [self.topics.list objectAtIndex:indexPath.row];
    cell.textLabel.text= topic.name;

    return cell;
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2020-02-26T04:00:55.177

在**Swift 4 和 Swift 5中显示自定义的附件视图单元**

```
let lockIcon = UIImage(named: "lock_icon")
let lockIconView = UIImageView(image: lockIcon)
lockIconView.frame = CGRect(x: 0, y: 0, width: 24, height: 24)
cell.accessoryView = lockIconView 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-11T23:16:17.980

```
- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath
{
    UITableViewCell *cell;
    if(indexPath.row == 5 || indexPath.row == 9) {
        cell = [tableView dequeueReusableCellWithIdentifier:@"TopicCellWithImage"];
    } else {
        cell = [tableView dequeueReusableCellWithIdentifier:@"TopicCell"];
    }

    GPBTopic *topic = [self.topics.list objectAtIndex:indexPath.row];
    cell.textLabel.text= topic.name;

    if ((indexPath.row == 5) || (indexPath.row == 9))
    {
        cell.accessoryView = [[ UIImageView alloc ] initWithImage:[UIImage imageNamed:@"lock_icon.png"]];;
        [cell.accessoryView setFrame:CGRectMake(0, 0, 24, 24)];

    }

    return cell;
} 
```

# java - 将实时 Android 音频流式传输到服务器

> ID：15349987
> 
> 赞同：68
> 
> 时间：2013-03-11T22:36:12.220
> 
> 标签：java, android, audio-streaming

我目前正在尝试将实时麦克风音频从 Android 设备流式传输到 Java 程序。我开始在两个安卓设备之间发送实时音频，以确认我的方法是正确的。在接收设备上几乎没有任何延迟，可以完美地听到音频。接下来，我将相同的音频流发送到一个小型 Java 程序，并且我验证了数据也正确地发送到这里。现在我想做的是对这些数据进行编码，并以某种方式在运行 Java 程序的服务器上播放它。我宁愿在使用 HTML5 或 JavaScript 的网络浏览器中播放它，但我对 VLC 等替代方法持开放态度。

这是发送实时麦克风音频的 Android 应用程序的代码

```
public class MainActivity extends Activity {

private Button startButton,stopButton;

public byte[] buffer;
public static DatagramSocket socket;
    AudioRecord recorder;

private int sampleRate = 44100;   
private int channelConfig = AudioFormat.CHANNEL_CONFIGURATION_MONO;    
private int audioFormat = AudioFormat.ENCODING_PCM_16BIT;       
int minBufSize = AudioRecord.getMinBufferSize(sampleRate, channelConfig, audioFormat);
    private boolean status = true;

@Override
protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_main);

     startButton = (Button) findViewById (R.id.start_button);
     stopButton = (Button) findViewById (R.id.stop_button);

     startButton.setOnClickListener(startListener);
     stopButton.setOnClickListener(stopListener);

     minBufSize += 2048;
}

@Override
public boolean onCreateOptionsMenu(Menu menu) {
    getMenuInflater().inflate(R.menu.main, menu);
    return true;
}

private final OnClickListener stopListener = new OnClickListener() {

    @Override
    public void onClick(View arg0) {
                status = false;
                recorder.release();
                Log.d("VS","Recorder released");
    }
};

private final OnClickListener startListener = new OnClickListener() {

    @Override
    public void onClick(View arg0) {
                status = true;
                startStreaming();           
    }
};

public void startStreaming()
{
    Thread streamThread = new Thread(new Runnable(){
        @Override
        public void run()
        {
            try{

                DatagramSocket socket = new DatagramSocket();
                Log.d("VS", "Socket Created");

                byte[] buffer = new byte[minBufSize];

                Log.d("VS","Buffer created of size " + minBufSize);

                Log.d("VS", "Address retrieved");
                recorder = new AudioRecord(MediaRecorder.AudioSource.MIC,sampleRate,channelConfig,audioFormat,minBufSize);
                Log.d("VS", "Recorder initialized");

                recorder.startRecording();

                InetAddress IPAddress = InetAddress.getByName("192.168.1.5");
                byte[] sendData = new byte[1024];
                byte[] receiveData = new byte[1024];

                while (status == true)
                {
                    DatagramPacket sendPacket = new DatagramPacket(sendData, sendData.length, IPAddress, 50005);
                    socket.send(sendPacket);
                }

            } catch(UnknownHostException e) {
                Log.e("VS", "UnknownHostException");
            } catch (IOException e) {
                Log.e("VS", "IOException");
                e.printStackTrace();
            } 

        }

    });
    streamThread.start();
}
} 
```

这是Java程序读取数据的代码..

```
class Server
{
   public static void main(String args[]) throws Exception
      {
         DatagramSocket serverSocket = new DatagramSocket(50005);
            byte[] receiveData = new byte[1024];
            byte[] sendData = new byte[1024];
            while(true)
               {
                  DatagramPacket receivePacket = new DatagramPacket(receiveData, receiveData.length);

              serverSocket.receive(receivePacket);
              String sentence = new String( receivePacket.getData().toString());

              System.out.println("RECEIVED: " + sentence);
           }
  }
} 
```

我知道在将音频发送到 Java 程序之前，我应该在应用程序端对音频进行编码，但我不确定在使用 AudioRecorder 时如何进行编码。我宁愿不使用 NDK，因为我没有使用它的经验，也没有时间学习如何使用它......但是 :)

* * *

## 回答 #1

> 赞同：71
> 
> 时间：2013-03-28T23:52:55.847

所以我解决了我的问题。问题主要出在接收方。接收器接收音频流并将其推送到 PC 的扬声器。由此产生的声音仍然很迟钝和破碎，但它仍然有效。玩弄缓冲区大小可能会改善这一点。

编辑：您使用线程来读取音频以避免滞后。此外，最好使用 16 000 的采样大小，因为它可以用于语音。

安卓代码：

```
package com.example.mictest2;

import java.io.IOException;
import java.net.DatagramPacket;
import java.net.DatagramSocket;
import java.net.InetAddress;
import java.net.UnknownHostException;

import android.app.Activity;
import android.media.AudioFormat;
import android.media.AudioRecord;
import android.media.MediaRecorder;
import android.os.Bundle;
import android.util.Log;
import android.view.View;
import android.view.View.OnClickListener;
import android.widget.Button;

public class Send extends Activity {
private Button startButton,stopButton;

public byte[] buffer;
public static DatagramSocket socket;
private int port=50005;

AudioRecord recorder;

private int sampleRate = 16000 ; // 44100 for music
private int channelConfig = AudioFormat.CHANNEL_CONFIGURATION_MONO;    
private int audioFormat = AudioFormat.ENCODING_PCM_16BIT;       
int minBufSize = AudioRecord.getMinBufferSize(sampleRate, channelConfig, audioFormat);
private boolean status = true;

@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_main);

    startButton = (Button) findViewById (R.id.start_button);
    stopButton = (Button) findViewById (R.id.stop_button);

    startButton.setOnClickListener (startListener);
    stopButton.setOnClickListener (stopListener);

}

private final OnClickListener stopListener = new OnClickListener() {

    @Override
    public void onClick(View arg0) {
                status = false;
                recorder.release();
                Log.d("VS","Recorder released");
    }

};

private final OnClickListener startListener = new OnClickListener() {

    @Override
    public void onClick(View arg0) {
                status = true;
                startStreaming();           
    }

};

public void startStreaming() {

    Thread streamThread = new Thread(new Runnable() {

        @Override
        public void run() {
            try {

                DatagramSocket socket = new DatagramSocket();
                Log.d("VS", "Socket Created");

                byte[] buffer = new byte[minBufSize];

                Log.d("VS","Buffer created of size " + minBufSize);
                DatagramPacket packet;

                final InetAddress destination = InetAddress.getByName("192.168.1.5");
                Log.d("VS", "Address retrieved");

                recorder = new AudioRecord(MediaRecorder.AudioSource.MIC,sampleRate,channelConfig,audioFormat,minBufSize*10);
                Log.d("VS", "Recorder initialized");

                recorder.startRecording();

                while(status == true) {

                    //reading data from MIC into buffer
                    minBufSize = recorder.read(buffer, 0, buffer.length);

                    //putting buffer in the packet
                    packet = new DatagramPacket (buffer,buffer.length,destination,port);

                    socket.send(packet);
                    System.out.println("MinBufferSize: " +minBufSize);

                }

            } catch(UnknownHostException e) {
                Log.e("VS", "UnknownHostException");
            } catch (IOException e) {
                e.printStackTrace();
                Log.e("VS", "IOException");
            } 
        }

    });
    streamThread.start();
 }
 } 
```

安卓 XML：

```
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
xmlns:tools="http://schemas.android.com/tools"
android:layout_width="match_parent"
android:layout_height="match_parent"
android:paddingBottom="@dimen/activity_vertical_margin"
android:paddingLeft="@dimen/activity_horizontal_margin"
android:paddingRight="@dimen/activity_horizontal_margin"
android:paddingTop="@dimen/activity_vertical_margin"
tools:context=".MainActivity" >

<TextView
    android:id="@+id/textView1"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:text="@string/hello_world" />

<Button
    android:id="@+id/start_button"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_below="@+id/textView1"
    android:layout_centerHorizontal="true"
    android:layout_marginTop="130dp"
    android:text="Start" />

<Button
    android:id="@+id/stop_button"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_alignLeft="@+id/button1"
    android:layout_below="@+id/button1"
    android:layout_marginTop="64dp"
    android:text="Stop" />

</RelativeLayout> 
```

服务器代码：

```
package com.datagram;

import java.io.ByteArrayInputStream;
import java.net.DatagramPacket;
import java.net.DatagramSocket;

import javax.sound.sampled.AudioFormat;
import javax.sound.sampled.AudioInputStream;
import javax.sound.sampled.AudioSystem;
import javax.sound.sampled.DataLine;
import javax.sound.sampled.FloatControl;
import javax.sound.sampled.SourceDataLine;

class Server {

AudioInputStream audioInputStream;
static AudioInputStream ais;
static AudioFormat format;
static boolean status = true;
static int port = 50005;
static int sampleRate = 44100;

public static void main(String args[]) throws Exception {

    DatagramSocket serverSocket = new DatagramSocket(50005);

    byte[] receiveData = new byte[1280]; 
    // ( 1280 for 16 000Hz and 3584 for 44 100Hz (use AudioRecord.getMinBufferSize(sampleRate, channelConfig, audioFormat) to get the correct size)

    format = new AudioFormat(sampleRate, 16, 1, true, false);

    while (status == true) {
        DatagramPacket receivePacket = new DatagramPacket(receiveData,
                receiveData.length);

        serverSocket.receive(receivePacket);

        ByteArrayInputStream baiss = new ByteArrayInputStream(
                receivePacket.getData());

        ais = new AudioInputStream(baiss, format, receivePacket.getLength());

        // A thread solve the problem of chunky audio 
        new Thread(new Runnable() {
            @Override
            public void run() {
                toSpeaker(receivePacket.getData());
            }
        }).start();
    }
}

public static void toSpeaker(byte soundbytes[]) {
    try {

        DataLine.Info dataLineInfo = new DataLine.Info(SourceDataLine.class, format);
        SourceDataLine sourceDataLine = (SourceDataLine) AudioSystem.getLine(dataLineInfo);

        sourceDataLine.open(format);

        FloatControl volumeControl = (FloatControl) sourceDataLine.getControl(FloatControl.Type.MASTER_GAIN);
        volumeControl.setValue(100.0f);

        sourceDataLine.start();
        sourceDataLine.open(format);

        sourceDataLine.start();

        System.out.println("format? :" + sourceDataLine.getFormat());

        sourceDataLine.write(soundbytes, 0, soundbytes.length);
        System.out.println(soundbytes.toString());
        sourceDataLine.drain();
        sourceDataLine.close();
    } catch (Exception e) {
        System.out.println("Not working in speakers...");
        e.printStackTrace();
    }
}
} 
```

我希望这有助于为某人节省几个小时的痛苦:)

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2013-11-03T17:56:14.390

*我的 2 美分给你的代码以提高效率。不错的尝试*

```
package com.datagram;

import java.io.ByteArrayInputStream;
import java.net.DatagramPacket;
import java.net.DatagramSocket;

import javax.sound.sampled.AudioFormat;
import javax.sound.sampled.AudioInputStream;
import javax.sound.sampled.AudioSystem;
import javax.sound.sampled.DataLine;
import javax.sound.sampled.FloatControl;
import javax.sound.sampled.SourceDataLine;

class Server {

AudioInputStream audioInputStream;
static AudioInputStream ais;
static AudioFormat format;
static boolean status = true;
static int port = 50005;
static int sampleRate = 44100;

static DataLine.Info dataLineInfo;
static SourceDataLine sourceDataLine;

public static void main(String args[]) throws Exception {

    DatagramSocket serverSocket = new DatagramSocket(port);

    /**
     * Formula for lag = (byte_size/sample_rate)*2
     * Byte size 9728 will produce ~ 0.45 seconds of lag. Voice slightly broken.
     * Byte size 1400 will produce ~ 0.06 seconds of lag. Voice extremely broken.
     * Byte size 4000 will produce ~ 0.18 seconds of lag. Voice slightly more broken then 9728.
     */

    byte[] receiveData = new byte[4096];

    format = new AudioFormat(sampleRate, 16, 1, true, false);
    dataLineInfo = new DataLine.Info(SourceDataLine.class, format);
    sourceDataLine = (SourceDataLine) AudioSystem.getLine(dataLineInfo);
    sourceDataLine.open(format);
    sourceDataLine.start();

    FloatControl volumeControl = (FloatControl) sourceDataLine.getControl(FloatControl.Type.MASTER_GAIN);
    volumeControl.setValue(1.00f);

    DatagramPacket receivePacket = new DatagramPacket(receiveData,
            receiveData.length);
    ByteArrayInputStream baiss = new ByteArrayInputStream(
            receivePacket.getData());
    while (status == true) {
        serverSocket.receive(receivePacket);
        ais = new AudioInputStream(baiss, format, receivePacket.getLength());
        toSpeaker(receivePacket.getData());
    }
    sourceDataLine.drain();
    sourceDataLine.close();
}

    public static void toSpeaker(byte soundbytes[]) {
        try {
            sourceDataLine.write(soundbytes, 0, soundbytes.length);
        } catch (Exception e) {
            System.out.println("Not working in speakers...");
            e.printStackTrace();
        }
    }
} 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2014-03-31T22:44:26.570

由于您的 android 代码中的以下行，语音中断：

```
minBufSize += 2048; 
```

您只是在添加空字节。另外，使用`CHANNEL_IN_MONO`代替`CHANNEL_CONFIGURATION_MONO`

# java - 从 Web 服务返回 InputStream 时从 HttpURLConnection 断开连接

> ID：15349988
> 
> 赞同：0
> 
> 时间：2013-03-11T22:36:13.917
> 
> 标签：java, sockets, connection, inputstream, httpurlconnection

我有一个正在调用 Swift 集群的 web 服务，发现到它的连接处于 CLOSE_WAIT 状态并且直到 HA 代理强制关闭连接并记录事件才被关闭，导致大量事件生成。

调查这个我发现这是由于我们完成连接后没有断开与底层 HttpURLConnection 的连接。

因此，我已经对我们的大多数 RESTful 服务进行了必要的更改，但我不确定在我们直接从 Web 服务返回从 Swift 检索的 InputStream 的情况下，我应该如何断开与 HttpURLConnection 的连接。

对于在这种情况下应该做什么我不知道或者任何人都可以想到在流被消耗后断开连接的任何好主意，是否有某种最佳实践？

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-12T05:10:02.480

你不应该这样做。底层的连接池`HttpURLConnection`应该在少量几秒（我相信是 15 秒）空闲时间后关闭底层 TCP 连接。通过调用`disconnect()`，您将完全禁用连接池，这会浪费更多的网络和服务器资源，因为每次调用都需要一个新连接。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-12T03:51:48.183

我最终只是将 InputStream 包装在一个存储 HttpURLConnection 的对象中，并在完成读取流后调用 disconnect 方法

```
public class WrappedInputStream extends InputStream{

        InputStream is;
        HttpURLConnection urlconn;

        public WarppedInputStream(InputStream is, HttpURLConnection urlconn){
            this.is = is;
            this.urlconn = urlconn;
        }

        @Override
        public int read() throws IOException{
            int read = this.is.read();
            if (read != -1){
                return read;
            }else{
                is.close();
                urlconn.disconnect();
                return -1;
            }
        }

        @Override
        public int read(byte[] b) throws IOException{
            int read = this.is.read(b);
            if (read != -1){
                return read;
            }else{
                is.close();
                urlconn.disconnect();
                return -1;
            }
        }

        @Override
        public int read(byte[] b, int off, int len) throws IOException{
            int read = this.is.read(b, off, len);
            if (read != -1){
                return read;
            }else{
                is.close();
                urlconn.disconnect();
                return -1;
            }
        }
    } 
```

# android - Android - 启动正确活动的问题？

> ID：15349989
> 
> 赞同：5
> 
> 时间：2013-03-11T22:36:14.827
> 
> 标签：android, android-activity, manifest, launch

好吧，伙计们，我对此很陌生，所以请多多包涵……我基本上是在阅读一本关于 Android 开发的书，并按照其中的教程进行操作。

这个应用程序有 7 个活动（1 个名为 QuizActivity 扩展了 Activity，另外 6 个扩展了 QuizActivity - 其中 1 个是 QuizSplashActivity，我想在启动时启动）

但是，我对为什么默认活动似乎没有启动感到非常困惑。我的清单具有 QuizSplashActivity 的正确标签，并且 QuizSplashActivity 指向我创建的正确 .xml 布局文件。但是，当我运行程序时，控制台会显示：

[2013-03-11 17:19:47 - BeenThereDoneThat] 在设备模拟器 5554 上启动活动 com.example.beentheredonethat.QuizActivity

[2013-03-11 17:19:48 - BeenThereDoneThat] ActivityManager：开始：Intent { act=android.intent.action.MAIN cat=[android.intent.category.LAUNCHER] cmp=com.example.beentheredonethat/.QuizActivity }

这是清单的应用程序部分：

```
 <application
        android:allowBackup="true"
        android:icon="@drawable/ic_launcher"
        android:label="@string/app_name"
        android:theme="@style/AppTheme" >
        <activity
            android:name="QuizSplashActivity"
            android:label="@string/app_name" >
            <intent-filter>
                <action android:name="android.intent.action.MAIN" />

                <category android:name="android.intent.category.LAUNCHER" />
            </intent-filter>
        </activity>
        <activity android:name="QuizActivity"></activity>
        <activity android:name="QuizGameActivity"></activity>
        <activity android:name="QuizHelpActivity"></activity>
        <activity android:name="QuizMenuActivity"></activity>
        <activity android:name="QuizScoresActivity"></activity>
        <activity android:name="QuizSettingsActivity"></activity>
    </application> 
```

这是我的 QuizSplashActivity，我想在启动时显示：

```
package com.example.beentheredonethat;

import android.os.Bundle;
import android.view.Menu;

public class QuizSplashActivity extends QuizActivity {

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.splash);
    }

    @Override
    public boolean onCreateOptionsMenu(Menu menu) {
        // Inflate the menu; this adds items to the action bar if it is present.
        getMenuInflater().inflate(R.menu.activity_quiz, menu);
        return true;
    }

} 
```

关于为什么这样做的任何想法？任何帮助将不胜感激。谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-11T22:38:09.100

我认为这个问题是你在声明活动时表现出来的。您在活动名称之前缺少**点：**

```
android:name=".QuizSplashActivity" 
```

并且编译器找不到您的活动。尝试修复它，它应该可以工作。还尝试清理您的项目，重新启动 Eclipse 并尝试再次启动应用程序。

# java - 有没有办法只使用一个表在 Hibernate 中创建 OneToMany 关系？

> ID：15349995
> 
> 赞同：0
> 
> 时间：2013-03-11T22:36:49.827
> 
> 标签：java, hibernate

我正在尝试从一个名为 STUDENT_ADDRESS 的表创建学生和地址对象，该表定义如下。

```
Table Name: STUDENT_ADDRESS
Columns:
STUDENT_ID
STUDENT_NAME
STUDENT_END_DATE
STUDENT_ADDRESS_END_DATE
ADDRESS_ID
ADDRESS_VALUE
ADDRESS_END_DATE 
```

我知道这是可以创建的效率最低的表。但是改变表结构是一场艰苦的战斗，我很可能会输。

我要做的是创建一个具有一组地址对象的 Student 对象，并且可以根据`STUDENT_ADDRESS_END_DATE`和过滤掉地址对象`ADDRESS_END_DATE`。

我希望这是有道理的。在此先感谢您的帮助。:)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-11T22:50:47.843

您可以在“等待发生的灾难”下的 Hibernate 食谱中查找此内容：)

但是，如果您真的必须那么也许可以尝试使用鉴别器？

我不确定这是否会建立一对多的关系。

```
@Entity  
@Table( name =  "OBJECT")  
@Inheritance(strategy=InheritanceType.SINGLE_TABLE)  
@DiscriminatorColumn(   
    name="OBJ_TYPE",  
    discriminatorType=DiscriminatorType.STRING,  
    length=1  
)  
@DiscriminatorValue("c")  

public class ObjOne {  
...  
}

@DiscriminatorValue("b")
public class ObjTwo {
....
} 
```

对产生 +1 问题保持警惕（请参阅[什么是 SELECT N+1？](https://stackoverflow.com/questions/97197/what-is-the-n1-selects-problem)) 在单个表中构建层次结构时，因为这会毁了你的一天，在你对最初的问题进行排序之后，这可能会很顺利......

# html - 仅 IE8/9 中的网格间距问题

> ID：15349996
> 
> 赞同：-1
> 
> 时间：2013-03-11T22:36:51.043
> 
> 标签：html, css, internet-explorer

我遇到了一个奇怪的情况，第一个`<dl>`元素的宽度是其他元素的两倍，但仅在 IE 中。这会导致此照片网格布局中出现间隙。

示例：[http ://user45201.vs.easily.co.uk/?page_id=109](http://user45201.vs.easily.co.uk/?page_id=109)

在 Chrome/FF/IE7 中运行良好，但在 IE8 和 IE9 中有奇怪的间距。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-11T23:25:31.283

看起来问题的一部分是非浮动父级中的浮动元素。我在父容器左侧添加了一个浮点数并修复了它。由于您使用宽度 33% 并尝试将间距应用到元素上，因此我添加了 box-sizing 属性，因此图像不会跳转到下一行。希望这可以帮助。

```
#gallery-1 {
    float:left;
}
#gallery-1 .gallery-item {
    float: left;
    text-align:center;
    width: 33%;
    -moz-box-sizing: border-box; 
    -webkit-box-sizing: border-box;
    box-sizing: border-box;
}
#gallery-1 .gallery-icon{
    padding-left:10px;
    padding-top:10px;
} 
```

# python - 在 Python 中进行线程处理时出现 AssertionError

> ID：15349997
> 
> 赞同：53
> 
> 时间：2013-03-11T22:36:53.110
> 
> 标签：python, multithreading

我正在尝试使用以下方法在 Python 中运行一些简单的线程：

```
t1 = threading.Thread(analysis("samplequery"))
t1.start()

other code runs in here

t1.join() 
```

不幸的是，我收到了错误：

> “AssertionError：组参数现在必须为无”

我以前从未在 Python 中实现过线程，所以我有点不确定出了什么问题。有谁知道问题是什么？

我不确定它是否相关，但分析是从另一个文件导入的方法。

我也有一个后续查询。分析返回一个字典，我将如何分配它以在原始方法中使用？

谢谢

* * *

## 回答 #1

> 赞同：72
> 
> 时间：2013-03-11T22:37:52.140

您想指定`target`关键字参数：

```
t1 = threading.Thread(target=analysis("samplequery")) 
```

您可能打算制作`analysis`运行目标，但*启动时*`'samplequery`的参数：

 *```
t1 = threading.Thread(target=analysis, args=("samplequery",)) 
```

第一个参数`Thread()`是实参`group`，目前只接受`None`作为实参。

从[`threading.Thread()`文档](http://docs.python.org/2/library/threading.html#threading.Thread)中：

> 此构造函数应始终使用关键字参数调用。论据是：
> 
> *   *组*应该是`None`；为实现类时的未来扩展而保留`ThreadGroup`。
> *   *target*是方法调用的可调用对象`run()`。默认为`None`，表示不调用任何内容。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2013-03-11T22:38:24.943

您需要提供`target`属性：

```
t1 = threading.Thread(target = analysis, args = ('samplequery',)) 
```*

# objective-c - Xcode 4.6 编译非 Thumb 架构

> ID：15349998
> 
> 赞同：0
> 
> 时间：2013-03-11T22:36:54.997
> 
> 标签：objective-c, xcode4.6, thumb

我在 Xcode 中构建了一个项目，目的是不为 Thumb 指令集（armv6 或 armv7）编译它。我知道不为 armv7 中的 Thumb 指令集编译不是最优的，但我满足了客户的要求。

有谁知道我如何测试由 lib.a 文件和 .h 文件组成的构建，以查看它是否实际上是在没有 Thumb 指令集的情况下构建的？

只是为了记录，我为 GCC_THUMB_SUPPORT 添加了一个用户定义的构建设置，并将其值设置为 NO。此外，我在构建设置中将 -mno-thumb 添加到 OTHER_CFLAGS 中。