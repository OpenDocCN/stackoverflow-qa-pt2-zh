# StackOverflow 问答 16115000-16115999

# javascript - 每次更改javascript的内容，在“一段时间”？

> ID：16115000
> 
> 赞同：0
> 
> 时间：2013-04-19T23:46:16.150
> 
> 标签：javascript, testing, popup

我需要一些 javascripts 的帮助。
我正在使用这个 --> [javascript onclick create(element) div viz 弹出框，我在一段时间内在一个](https://stackoverflow.com/questions/11542822/javascript-onclick-createelement-div-viz-popup-box)**php 页面**中 使用它。
问题是当我使用

```
<div id="test" class="popup"> 
```

因为每次我都会让它打印“测试”到我的javascript。

```
 function openPopup() 
{
    document.getElementById('test').style.display = 'block';
} 
```

它总是需要我打印的第一行，它会忘记所有其他的。我如何使用某些东西使每条线与其他线不同？

# python - 将命令行参数传递到 Python 脚本会导致错误

> ID：16115001
> 
> 赞同：0
> 
> 时间：2013-04-19T23:46:19.230
> 
> 标签：python

我有一些来自 ADAFRUIT 的 python 示例脚本，它控制着一个伺服系统，它可以工作！

我想通过从命令行调用两个值来执行它以更改 ServoMin 和 ServoMax 值。我遇到的问题是，当我`import sys`设置它时它似乎不喜欢它`ServoMin = (sys.argv)`。我不确定为什么它不接受 int 或 str。有任何想法吗？

这是代码主体：

```
#!/usr/bin/python

from Adafruit_PWM_Servo_Driver import PWM
import time
import sys

# ===========================================================================
# Example Code
# ===========================================================================

# Initialise the PWM device using the default address
# bmp = PWM(0x40, debug=True)
pwm = PWM(0x50, debug=True)

servoMin = 150  # Min pulse length out of 4096
servoMax = 600  # Max pulse length out of 4096

def setServoPulse(channel, pulse):
  pulseLength = 1000000                   # 1,000,000 us per second
  pulseLength /= 60                       # 60 Hz
  print "%d us per period" % pulseLength
  pulseLength /= 4096                     # 12 bits of resolution
  print "%d us per bit" % pulseLength
  pulse *= 1000
  pulse /= pulseLength
  pwm.setPWM(channel, 0, pulse)

pwm.setPWMFreq(60)                        # Set frequency to 60 Hz
while (True):
  # Change speed of continuous servo on channel O
  pwm.setPWM(0, 0, servoMin)
  time.sleep(1)
  pwm.setPWM(0, 0, servoMax)
  time.sleep(1) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-19T23:52:13.120

`sys.argv`是参数列表，您需要访问参数，然后将它们转换为 Ints。

这应该这样做：

```
servoMin = int(sys.argv[1])
servoMax = int(sys.argv[2]) 
```

# php - Doctrine Mongo ODM UniqueIndex 被复制

> ID：16115002
> 
> 赞同：1
> 
> 时间：2013-04-19T23:46:29.953
> 
> 标签：php, mongodb, doctrine-odm

我正在玩我从 Doctrine ODM 的文档中挑选的 UniqueIndex，似乎我误解了它的目的。

事实上，我有一个由 Doctrine ODM 映射的关键字文档：

```
Namespace App\Document;

use Doctrine\ODM\MongoDB\Mapping\Annotations as ODM;

/**
 * @ODM\Document
 * @ODM\UniqueIndex(keys={"name"="asc", "lang"="asc"})
 */
class Keyword {

    /** @ODM\Id(strategy="AUTO") */
    protected $id;

    /** @ODM\String */
    protected $name;

    /** @ODM\String */
    protected $lang;

    .... 
```

如您所见，文档在 2 个键（名称和语言）上有一个 uniqueIndex

我有一个简单的脚本来保存这个文档

```
 ....
    ....
    $keyword=new \App\Document\Keyword();
    $keyword->setCreateDate(new \DateTime());
    $keyword->setLang("fr");
    $keyword->setLastParseDate(new \DateTime());
    $keyword->setName("test");

    $dm->persist($keyword);

    $dm->flush(); 
```

现在，当我从 mongo shell 中找到时，我的具有相同名称/语言对的数据在它们应该是唯一的时候被复制：

```
> db.Keyword.find()
{ "_id" : ObjectId("5171c72c6155795e47000000"), "name" : "test", "lang" : "fr", "createDate" : ISODate("2013-04-19T22:37:32Z"), "lastParseDate" : ISODate("2013-04-19T22:37:32Z") }
{ "_id" : ObjectId("5171c7366155796147000000"), "name" : "test", "lang" : "fr", "createDate" : ISODate("2013-04-19T22:37:42Z"), "lastParseDate" : ISODate("2013-04-19T22:37:42Z") }
{ "_id" : ObjectId("5171c7406155796447000000"), "name" : "test", "lang" : "fo", "createDate" : ISODate("2013-04-19T22:37:52Z"), "lastParseDate" : ISODate("2013-04-19T22:37:52Z") }
{ "_id" : ObjectId("5171c7fd615579a747000000"), "name" : "test", "lang" : "fo", "createDate" : ISODate("2013-04-19T22:41:01Z"), "lastParseDate" : ISODate("2013-04-19T22:41:01Z") }
{ "_id" : ObjectId("5171c7fe615579aa47000000"), "name" : "test", "lang" : "fo", "createDate" : ISODate("2013-04-19T22:41:02Z"), "lastParseDate" : ISODate("2013-04-19T22:41:02Z") } 
```

我的目标是使这对名称/语言对持久性具有唯一性。

所以我最后有两个问题：

*   UniqueIndex 是做什么用的？（因为它不会阻止复制）
*   我应该使用`custom strategy`连接 Name 和 Lang 作为唯一 id 吗？这是一种常见的用法吗？

编辑 ：

感谢@gview 的建议，我发现我没有确保索引。我通过这个链接修复了：[http ://www.testically.org/2011/08/25/using-a-unique-index-in-mongodb-with-doctrine-odm-and-symfony2/](http://www.testically.org/2011/08/25/using-a-unique-index-in-mongodb-with-doctrine-odm-and-symfony2/)

但是现在它没有更新我的条目，而是引发重复条目的错误。我应该像上面所说的那样使用自定义 ID 吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2018-12-11T13:05:07.877

尝试像这样使用 ensureIndexes：

```
$dm = $this->get('doctrine_mongodb')->getManager();
$dm->getSchemaManager()->ensureIndexes(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-29T10:03:05.510

该索引仅确保文档不会重复。

如果您想做相当于“REPLACE INTO”的操作，您应该：

* * *

**获取文档（如果存在），然后设置值：**

```
$keyword= $dm->findBy(array("name"=> $name, "lang"=> $lang));
if(!$keyword) {
    $keyword= new Keyword();
    $dm->persist($keyword);
}
$keyword->setCreateDate(new \DateTime());
$keyword->setLang("fr");
$keyword->setLastParseDate(new \DateTime());
$keyword->setName("test"); 
```

这将导致 2 个查询。

* * *

或者：

**做一个 upsert：**

```
$dm->createQueryBuilder('Keyword')
   ->setNewObj(array(
       'lang' => 'fr',
       'name' => 'test',
       // ... other fields
   ))
   ->field('lang')->equals('fr')
   ->field('name')->equals('test')
   ->getQuery()
   ->execute(); 
```

这将更新文档（如果存在），否则将创建一个新文档。

但是，新文档是从原始数组创建的，**实际上绕过了所有 Doctrine 事件**（如 @Timestampeble 注释）。

因此，如果额外的查询不是问题，请使用第一种方法。

# c# - 对相关的 ICommand 进行分组

> ID：16115004
> 
> 赞同：1
> 
> 时间：2013-04-19T23:46:56.247
> 
> 标签：c#, wpf, mvvm

我是 C# 新手，这是我的第一个 WPF 项目。我正在关注[本教程](http://www.codeproject.com/Articles/165368/WPF-MVVM-Quick-Start-Tutorial)（使用他们的 RelayCommand 实现并尝试使用 MVVM。我正在实现标准 Windows 计算器的克隆。我想找到一种方法来对类似按钮的功能进行分组，因为我正在做的事情似乎很笨拙。

例如，这是我的三个按钮的 XAML

```
<Button Content="_7" Focusable ="False" Command="{Binding Seven}" Style="{DynamicResource NumberButton}" Margin="0,134,184,129"/>
<Button Content="_8" Focusable ="False" Command="{Binding Eight}" Style="{DynamicResource NumberButton}" Margin="46,134,138,129"/>
<Button Content="_9" Focusable ="False" Command="{Binding Nine}" Style="{DynamicResource NumberButton}" Margin="92,134,92,129"/> 
```

这是那些的 ICommands：

```
public ICommand Nine { get { return new RelayCommand(NineExecute); } }
public ICommand Eight { get { return new RelayCommand(EightExecute); } }
public ICommand Seven { get { return new RelayCommand(SevenExecute); } } 
```

和方法：

```
void NineExecute()
{
   NumberPressed("9");
}
void EightExecute()
{
   NumberPressed("8");
}
void SevenExecute()
{
   NumberPressed("7");
} 
```

为了将类似的功能按钮（例如数字）分组到一个 ICommand 中，我应该调查什么，使用一个可以确定发送者的方法 - 同时仍然没有将代码放在 Window 类中，正如文章所警告的那样。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-20T01:56:57.987

按钮的 Xlam 代码（假设您定义了数据上下文）：

```
 <....DataContext>
        <loc:Commands/>
    </....DataContext>
    <Button Content="_9" 
            Command="{Binding Path=ShowMeABox}" 
            CommandParameter="{Binding RelativeSource={RelativeSource Mode=Self}, Path=Content}"/> 
```

我们的虚拟命令（使用`RelayCommand<T>`提供的链接）：

```
public class Commands
{
    private static readonly ICommand _showShowBoxCommand = 
        new RelayCommand<string>(str => MessageBox.Show(str));
    public static ICommand ShowMeABox { get { return _showShowBoxCommand; } }
} 
```

而已。

供参考。

1.  您似乎明确指定了按钮大小，这通常是一种不好的做法。要定位您的按钮，请使用堆栈或环绕面板，或网格/统一网格。
2.  阅读有关样式和模板的信息以增加代码重用。

例子：

```
 <UniformGrid Columns="3" Rows="3">
    <UniformGrid.DataContext>
        <loc:Commands/>
    </UniformGrid.DataContext>
    <UniformGrid.Resources>
        <Style TargetType="Button">
            <Setter Property="Command" Value="{Binding ShowMeABox}"/>
            <Setter Property="CommandParameter" Value="{Binding RelativeSource={RelativeSource Mode=Self}, Path=Content}"/>
        </Style>
    </UniformGrid.Resources>
    <Button Content="_1"/>
    <Button Content="_2"/>
    <Button Content="_3"/>
    <Button Content="_4"/>
    <Button Content="_5"/>
    <Button Content="_6"/>
    <Button Content="_7"/>
    <Button Content="_8"/>
    <Button Content="_9"/>
</UniformGrid> 
```

1.  可能可以绑定`Enumerable.Range(0,10)`以 MVVM 方式自动填充控件。

祝你好运！

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-20T00:06:58.633

使用 CommandParameter 属性 - 这样您可以将所有按钮绑定到同一个*命令*，但每个数字使用不同的*CommandParameter*（即，CommandParameter 应该是一个整数，表示实际按下的按钮）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-20T00:06:08.163

我会亲自使用构造函数编写此代码：

```
public YourType()
{
    this.Seven = new RelayCommand( () => NumberPressed("7"));
    this.Eight = new RelayCommand( () => NumberPressed("8"));
    this.Nine = new RelayCommand( () => NumberPressed("9"));
}

public ICommand Nine { get; private set; }
public ICommand Eight { get; private set; }
public ICommand Seven { get; private set; } 
```

`CommandParameter`请注意，使用, 和单个命令也可能有意义。许多框架在`RelayCommand`/ `ActionCommand`/etc 上提供了一个变体，它接受一个命令参数，然后您可以在 XAML 中指定它。该特定实现不允许它，但许多都允许，并将映射到`CommandParameter`直接获取作为参数的方法。

# jquery - 使用 parseFloat jQuery 进行乘法运算

> ID：16115009
> 
> 赞同：1
> 
> 时间：2013-04-19T23:48:01.127
> 
> 标签：jquery

**增加产出的额外成本**

这是计算总运输成本，拆分单个包裹并输出组合包裹的总数。哪个有效，但我想（另外）在输出中增加 20%。

```
 var adjusted_total = parseFloat(rate[1]) * custom_packages; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-20T02:35:53.067

尝试

```
var adjusted_total = parseFloat(rate[1]) * custom_packages; //if adjusted_total  = 100
adjusted_total *= 1.2 // will give 120 
```

# jquery - jQuery 和 IFrame 加载事件

> ID：16115010
> 
> 赞同：0
> 
> 时间：2013-04-19T23:48:03.090
> 
> 标签：jquery, events, iframe, load

我在几篇文章中读到 jquery 可以促进 iframe 上的事件侦听 - 用于每次重新加载。

我只收到初始事件通知 - 所有后续重新加载事件都是静默/忽略的。

代码示例：

```
$('#some_frame_id').bind('load', modNamespace.eHandler()); 
```

但是，如果我回到现在看似皱眉的`onLoad`语法，我会得到预期的结果 - 使用相同的处理程序：

```
iframe(class='foo'src='/path/to/resource' id='some_frame_id' name-'some_frame_id' onload='modNamespace.eHandler();') 
```

这让我得到了我正在寻找的结果，但我仍然想了解我的 jQuery 实现的问题。

（注意：iframe 标记是 Jade）

# python - 队列在python中是如何工作的？

> ID：16115011
> 
> 赞同：2
> 
> 时间：2013-04-19T23:48:04.490
> 
> 标签：python

我正在尝试学习 Python 的东西，并且想知道是否有人可以帮助我提供一些使用优先级队列的示例。我知道它们在 java 中是如何工作的，但似乎看不到它们在 Python 中如何工作的清晰示例。就像我看到的队列的大小是 .qsize() 从这里：[http](http://docs.python.org/2/library/queue.html) ://docs.python.org/2/library/queue.html但它没有显示获取最小值、最大值、组织的示例，弹出，添加到队列中，对它们进行排序，遍历它们。如果有人可以给我一个例子或指出我在哪里学习这个的正确方向，我会非常感激。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-20T02:26:00.857

`Queue`不是您要查找的优先级队列。相反，您正在寻找[`heapq`](http://docs.python.org/2/library/heapq.html)适用于 Python`list`的 . 您可以使用空列表 ( `[]`) 或`heapify`现有列表，如下所示：

> 堆是二叉树，每个父节点的值都小于或等于其任何子节点。此实现使用数组 which`heap[k] <= heap[2*k+1]`和`heap[k] <= heap[2*k+2]`for all `k`，从零开始计数元素。

此属性称为堆不变量。您应该注意的一件事是，在这种情况下，排序列表作为堆已经是有效的（可以很容易地观察到原因 - 因为每个项目都小于它的右邻居，所以必须如此）。堆也是平衡的，保证`1`所有叶子节点到根的高度之间存在最大差异，这将在后面证明。如果您的列表未排序，或者还不是堆，则必须调用`heapq.heapify`以获取有效堆。

```
>>> import heapq
>>> L = [2, 3, 1, 9, 10]
>>> heapq.heapify(L)
>>> L
[1, 3, 2, 9, 10] 
```

作为一个堆，这现在看起来像

```
 1
        /   \
      3      2
    /   \
  9      10 
```

此操作在线性时间（`O(N)`时间）内工作。如您所见，最小的项目始终位于`0th`列表的索引处。这使得检索变得简单：

```
>>> L[0]
1 
```

对于最大的项目，情况并非如此。在这种情况下，您必须`heapq.nlargest`与`n=1`项目一起使用：

```
>>> heapq.nlargest(1, L)
[10] 
```

要从堆中弹出一个项目，您可以使用`heapq.heappop()`它将从堆中弹出最小的项目。

```
>>> heapq.heappop(L)
1 
```

执行此操作的代码如下所示：

```
def heappop(heap):
    """Pop the smallest item off the heap, maintaining the heap invariant."""
    lastelt = heap.pop()    # raises appropriate IndexError if heap is empty
    if heap:
        returnitem = heap[0]
        heap[0] = lastelt
        _siftup(heap, 0)
    else:
        returnitem = lastelt
    return returnitem 
```

这样做是返回`0th`元素。但首先它将堆中的最后一项（`heap.pop()`将从列表中删除`heap[-1]`）与第一项（`heap[0] = lastelt`）交换。必须调用模块中的隐藏函数`_siftup`来`heapq`保持堆不变。出于科学目的，这是执行此操作的代码（`heapq`使用更快的`C`代码实现，但它在语义上等效之前有一个 Python 实现）：

```
def _siftup(heap, pos):
    endpos = len(heap)
    startpos = pos
    newitem = heap[pos]
    # Bubble up the smaller child until hitting a leaf.
    childpos = 2*pos + 1    # leftmost child position
    while childpos < endpos:
        # Set childpos to index of smaller child.
        rightpos = childpos + 1
        if rightpos < endpos and not cmp_lt(heap[childpos], heap[rightpos]):
            childpos = rightpos
        # Move the smaller child up.
        heap[pos] = heap[childpos]
        pos = childpos
        childpos = 2*pos + 1
    # The leaf at pos is empty now.  Put newitem there, and bubble it up
    # to its final resting place (by sifting its parents down).
    heap[pos] = newitem
    _siftdown(heap, startpos, pos) 
```

它基本上一直在用它最小的孩子交换父母。此操作需要`O(log n)`时间，`log n`即平衡二叉树的高度。要将项目添加到堆中，请使用：

```
>>> heapq.heappush(L, 7)
>>> L
[3, 7, 10, 9] 
```

这需要`O(log n)`时间。它首先将项目附加到列表的末尾，因为这会在列表的高度添加一个新节点，比如说，`h`该新节点的索引将等于`2*k + 1`或`2*k + 2`，让我们假设`2*k + 1`某个节点在索引处的（）`k`与高度`h - 1`。因此，如果您附加另一个项目，索引将是`2*k + 2`，同一节点的右子节点，那么您添加的下一个索引将是另一个节点的左子节点，位于 height 的最后一个节点的右侧`h - 1`，这意味着树始终是平衡的. 如果您最终继续添加，您将填充该行并创建一个新行，等等。

无论如何，它会调用模块中的`_siftdown`隐藏函数，`heapq`如下所示：

```
def _siftdown(heap, startpos, pos):
    newitem = heap[pos]
    # Follow the path to the root, moving parents down until finding a place
    # newitem fits.
    while pos > startpos:
        parentpos = (pos - 1) >> 1
        parent = heap[parentpos]
        if cmp_lt(newitem, parent):
            heap[pos] = parent
            pos = parentpos
            continue
        break
    heap[pos] = newitem 
```

它基本上不断检查孩子是否小于其父母，如果是，则交换两者。由于它是一棵平衡二叉树，树的高度将是`O(log n)`，`log n`即可能需要交换的父级数量，以保持堆不变。

如果你想对 heapq 进行排序，你可以在最佳排序时间内`O(N log N)`使用 heapsort 进行排序，只需重复调用`heappop`队列即可：

```
[heappop(L) for i in range(len(L))] 
```

当然，Python 的内置`sorted`代码比这段代码优化得多，并且执行速度更快，尽管如果你不使用 Python 并且只是说在 中实现了一个堆`C`，你会这样做。最后遍历堆很容易，只需遍历您的列表：

```
for x in L:
    print x 
```

尽管我认为这不会是任何理想的顺序。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-04-19T23:53:11.903

模块中的队列`Queue`主要用于实现多线程的生产者/消费者模式。如果您对通用优先级队列数据结构感兴趣，请[使用`heapq`模块](http://docs.python.org/2/library/heapq.html#module-heapq).

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-04-20T02:45:20.583

您可以使用 PriorityQueue。这是示例。

```
In [1]: from Queue import PriorityQueue
In [2]: pq = PriorityQueue()
In [3]: pq.put((1, "girl"))    # put data in the form of tuple (priority, data)
In [4]: pq.put((3, "forest"))
In [5]: pq.put((2, "rain"))
In [6]: pq.get()               # retrieves data. lowest priority number first.
Out[6]: (1, 'girl')
In [7]: pq.empty()             # checks if empty
Out[7]: False
In [8]: pq.full()              # checks if full
Out[8]: False
In [9]: pq.qsize()             # current size of the queue.
Out[9]: 2 
```

此外，您将能够扩展 PriorityQueue 类并自定义事物。

# c++ - 与 std::memory_order 和三个线程的同步谜语

> ID：16115014
> 
> 赞同：6
> 
> 时间：2013-04-19T23:49:02.280
> 
> 标签：c++, c++11, atomic

`std::memory_order`当涉及到三个线程时，这里有一个关于 C++11 中规则的问题。比如说，一个线程**生产者**保存了一个值并设置了一个标志。然后，另一个线程**中继**在设置另一个标志之前等待这个标志。最后，第三个线程**consumer**等待来自**relay**的标志，这应该表示`data`已为**consumer**准备好。

这是一个最小程序，采用 C++ 参考 ( [http://en.cppreference.com/w/cpp/atomic/memory_order](http://en.cppreference.com/w/cpp/atomic/memory_order) ) 中的示例样式：

```
#include <thread>
#include <atomic>
#include <cassert>

std::atomic<bool> flag1 = ATOMIC_VAR_INIT(false);
std::atomic<bool> flag2 = ATOMIC_VAR_INIT(false);
int data;

void producer()
{
  data = 42;
  flag1.store(true, std::memory_order_release);
}

void relay_1()
{
  while (!flag1.load(std::memory_order_acquire))
    ;
  flag2.store(true, std::memory_order_release);
}

void relay_2()
{
  while (!flag1.load(std::memory_order_seq_cst))
    ;
  flag2.store(true, std::memory_order_seq_cst);
}

void relay_3()
{
  while (!flag1.load(std::memory_order_acquire))
    ;
  // Does the following line make a difference?
  data = data;
  flag2.store(true, std::memory_order_release);
}

void consumer()
{
  while (!flag2.load(std::memory_order_acquire))
    ;
  assert(data==42);
}

int main()
{
  std::thread a(producer);
  std::thread b(relay_1);
  std::thread c(consumer);
  a.join(); b.join(); c.join();
} 
```

### 注释：

1.  第一个功能`relay_1()`不足，可以触发`assert`in **consumer**。根据上面引用的 C++ 参考，`memory_order_acquire`关键字“确保在其他线程中释放相同原子变量的所有写入在当前线程中都是可见的”。因此，设置 时对**中继**`data=42`是可见的。它将它设置为“确保当前线程中的所有写入在获取相同原子变量的其他线程中可见”。但是，由于没有被**relay**触及，因此**消费者**可能会看到内存访问顺序不同，并且在**消费者**看到时可能未初始化。**`flag2``memory_order_release``data`****`data`**`flag2==True`********

*******   相同的论点适用于`relay_2()`. 顺序一致的排序意味着“在所有标记为 的原子操作之间建立了同步`std::memory_order_seq_cst`”。但是，这并没有说明变量`data`。

    还是我在这里理解错误并且`relay_2()`足够了？

    *   让我们通过访问来解决这种`data`情况`relay_3()`。在这里，该行`data = data`表示在go to`data`之后读取，**中继线**程在设置之前写入， 。因此，**消费者**线程必须看到正确的值。`flag1``true`**`data``flag2`**

     ****然而，这个解决方案似乎有点奇怪。该行`data = data`似乎编译器会（在顺序代码中）立即优化。

    虚拟线在这里起作用吗？`std::memory_order`使用 C++11特性实现跨三个线程同步的更好方法是什么？********** 

 ******顺便说一句，这不是一个学术问题。想象这`data`是一个大数据块而不是单个整数，第*i*个线程需要将信息传递给第 ( *i* +1) 个线程，直到数据已被所有具有索引的线程处理的元素≤<em>i。

### 编辑：

阅读迈克尔伯尔的回答后，很明显这就`relay_1()`足够了。请阅读他的帖子以获得完全令人满意的问题解决方案。C++11 标准提供了比仅从 cppreference.com 网站推断出的更严格的保证。因此，请认为 Michael Burr 帖子中的论点是权威的，而不是我上面的评论。要走的路是在所讨论的事件之间建立一个“线程间发生之前”的关系（它是可传递的）。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-20T09:39:29.660

I think that `relay_1()` is sufficient to pass the value `42` from the producer to the consumer through `data`.

To show this, first I'll give single-letter names to the operations of interest:

```
void producer()
{
    /* P */ data = 42;
    /* Q */ flag1.store(true, std::memory_order_release);
}

void relay_1()
{
  while (/* R */ !flag1.load(std::memory_order_acquire))
    ;

  /* S */ flag2.store(true, std::memory_order_release);
}

void consumer()
{
  while (/* T */ !flag2.load(std::memory_order_acquire))
    ;
  /* U */ assert(data==42);
} 
```

I'm going to use the notation `A -> B` to mean that "A inter-thread happens before B" (C++11 1.10/11).

I argue that `P` is a visible side-effect with respect to `U` because:

*   `P` is sequenced before `Q`, `R` is sequenced before `S`, and `T` is sequenced before `U` (1.9/14)
*   `Q` synchronizes with `R`, and `S` synchronizes with `T` (29.3/2)

All of the next points are supported by the definition of "inter-thread happens before" (1.10/11):

*   `Q -> S` since the standard says "A inter-thread happens before an evaluation B if ... for some evaluation X, A synchronizes with X and X is sequenced before B" (`Q` synchronizes with `R` and `R` is sequenced before `S`, so `Q -> S`)

*   `S -> U` following similar logic (`S` synchronizes with `T` and `T` is sequenced before `U`, so `S -> U`)

*   `Q -> U` because `Q -> S` and `S -> U` ("A inter-thread happens before an evaluation B if ... A inter-thread happens before X and X inter-thread happens before B")

And finally,

*   `P -> U` because `P` is sequenced before `Q` and `Q -> U` ("A inter-thread happens before an evaluation B if ... A is sequenced before X and X inter-thread happens before B")

Since `P` inter-thread happens before `U`, `P` happens before `U` (1.10/12) and `P` is a "visible side-effect" with respect to `U` (1.10/13).

`relay_3()` is also sufficient because the `data=data` expression is irrelevant.

And for the purpose of this producer/consumer problem, `relay_2()` is at least as good as `relay_1()` because in a store operation `memory_order_seq_cst` is a release and in a load operation `memory_order_seq_cst` is an acquire (See 29.3/1). So the exact same logic can be followed. Operations using `memory_order_seq_cst` have some additional properties having to do with how all `memory_order_seq_cst` are sequenced among other `memory_order_seq_cst` operations, but those properties don't come into play in this example.

I think that `memory_order_acquire` and `memory_order_release` would not be very useful for implementing higher level synchronization objects if there weren't a transitive behavior such as this.******

# sql - 从另一个域登录 SQL

> ID：16115017
> 
> 赞同：1
> 
> 时间：2013-04-19T23:49:35.990
> 
> 标签：sql, sql-server, windows, visual-studio

我正在尝试将单独域上的 SQL Server 2012 连接到 Visual Studio/我的计算机。（这是我在工作组中的个人机器）。

我可以访问服务器并且可以使用 SQL 身份验证正常登录，但想通过 Windows 身份验证登录。当我尝试时，出现以下错误：

登录来自不受信任的域，不能与 Windows 身份验证一起使用。

这是在 Visual Studio 的数据连接上 - 与任何代码无关。

如何使域受信任（无需在我的机器上通过 AD 登录）或解决此问题？

我尝试使用控制面板凭据管理器，但没有运气。

谢谢你

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-20T01:05:19.590

这是域控制器上的设置，而不是您的计算机上的设置。SQL Server 所在的域需要信任您登录的域。由于您有一台工作组计算机，因此该域就是您的计算机。

与您的域管理员交谈，看看他们是否可以做到这一点。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-20T19:36:03.597

我设法通过从与软件相同的文件夹中运行以下命令来解决它：

```
 runas /netonly /user:<Username and Domain> <name of exe> 
```

# ios - 使用 Document Interaction 将专有文件保存到 Dropbox

> ID：16115019
> 
> 赞同：0
> 
> 时间：2013-04-19T23:49:45.983
> 
> 标签：ios, dropbox

我正在尝试使用 DocumentInteractionController 将带有我的扩展名的自定义文件保存到 Dropbox。当我的文件具有可识别的扩展名（例如 .txt）时，Dropbox 确实会显示在 DocumentInteractionController 的“打开方式”菜单中。我试图关注许多相关的主题。一个例子：[在 iOS 中关联我的应用程序的自定义文件](https://stackoverflow.com/questions/9434574/associating-my-apps-custom-file-in-ios)。

下面显示了我的 UIExportedTypeDeclarations：

```
<key>UIExportedTypeDeclarations</key>
<array>
    <dict>
        <key>UITypeIdentifier</key>
        <string>com.mysite.myapp.myext</string>
        <key>UITypeDescription</key>
        <string>My Special File</string>
        <key>UITypeTagSpecification</key>
        <dict>
            <key>public.filename-extension</key>
            <string>myext</string>
            <key>public.mime-type</key>
            <string>application/octet-stream</string>
        </dict>
        <key>UITypeConformsTo</key>
        <array>
            <string>public.data</string>
            <string>public.content</string>
        </array>
    </dict>
</array> 
```

我什至不确定 Dropbox 是否查看 ConformsTo 甚至 TagSpecification。当我测试一个 .txt 文件时，它确实出现在 Open In 菜单中，并且无意中为 public.filename-extension 键留下了“myextension”。所以，也许我对 UIExportedTypeDeclarations 的想法，或者我对 Dropbox 文件处理的期望，是不合时宜的。任何帮助将不胜感激。我在转动我的轮子。谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-28T12:30:50.823

拼写错误：UIExportedTypeDeclaration 不是 UTExportedTypeDeclaration。大脑中的 UIKit 有点太多了。修复拼写解决了问题。当然，所有标签都需要修复。

# intel - TBB concurrent_queue 错误

> ID：16115022
> 
> 赞同：1
> 
> 时间：2013-04-19T23:50:43.620
> 
> 标签：intel, tbb

即使提到并发队列，似乎也无法编译程序。

代码包含这个

```
#include <tbb/concurrent_queue.h> 
```

其次，我在代码中的任何地方添加

```
concurrent_queue<int> tbbqueue; 
```

这是我在编译时遇到的错误。我可以使用任务等编译其他一些与 tbb 相关的代码，但由于某种原因这不起作用。

```
 g++ -O3 -Wall -pthread -std=c++11 -ltbb -o tbbqueue.o tbbqueue.cpp 
tbbqueue.cpp: In function ‘void* Agent(void*)’:
tbbqueue.cpp:46:10: warning: unused variable ‘elements’ [-Wunused-variable]
tbbqueue.cpp:47:9: warning: unused variable ‘elementsSize’ [-Wunused-variable]
/tmp/ccQg8OKZ.o: In function `tbb::strict_ppl::internal::concurrent_queue_base_v3<int>::~concurrent_queue_base_v3()':
tbbqueue.cpp:(.text._ZN3tbb10strict_ppl8internal24concurrent_queue_base_v3IiED2Ev[_ZN3tbb10strict_ppl8internal24concurrent_queue_base_v3IiED5Ev]+0x10): undefined reference to `tbb::internal::NFS_Free(void*)'
/tmp/ccQg8OKZ.o: In function `tbb::strict_ppl::concurrent_queue<int, tbb::cache_aligned_allocator<int> >::deallocate_block(void*, unsigned long)':
tbbqueue.cpp:(.text._ZN3tbb10strict_ppl16concurrent_queueIiNS_23cache_aligned_allocatorIiEEE16deallocate_blockEPvm[_ZN3tbb10strict_ppl16concurrent_queueIiNS_23cache_aligned_allocatorIiEEE16deallocate_blockEPvm]+0x4): undefined reference to `tbb::internal::NFS_Free(void*)'
/tmp/ccQg8OKZ.o: In function `tbb::strict_ppl::concurrent_queue<int, tbb::cache_aligned_allocator<int> >::allocate_block(unsigned long)':
tbbqueue.cpp:(.text._ZN3tbb10strict_ppl16concurrent_queueIiNS_23cache_aligned_allocatorIiEEE14allocate_blockEm[_ZN3tbb10strict_ppl16concurrent_queueIiNS_23cache_aligned_allocatorIiEEE14allocate_blockEm]+0xf): undefined reference to `tbb::internal::NFS_Allocate(unsigned long, unsigned long, void*)'
tbbqueue.cpp:(.text._ZN3tbb10strict_ppl16concurrent_queueIiNS_23cache_aligned_allocatorIiEEE14allocate_blockEm[_ZN3tbb10strict_ppl16concurrent_queueIiNS_23cache_aligned_allocatorIiEEE14allocate_blockEm]+0x2b): undefined reference to `tbb::internal::throw_exception_v4(tbb::internal::exception_id)'
/tmp/ccQg8OKZ.o: In function `tbb::strict_ppl::internal::concurrent_queue_base_v3<int>::~concurrent_queue_base_v3()':
tbbqueue.cpp:(.text._ZN3tbb10strict_ppl8internal24concurrent_queue_base_v3IiED0Ev[_ZN3tbb10strict_ppl8internal24concurrent_queue_base_v3IiED0Ev]+0x10): undefined reference to `tbb::internal::NFS_Free(void*)'
/tmp/ccQg8OKZ.o: In function `tbb::strict_ppl::concurrent_queue<int, tbb::cache_aligned_allocator<int> >::~concurrent_queue()':
tbbqueue.cpp:(.text._ZN3tbb10strict_ppl16concurrent_queueIiNS_23cache_aligned_allocatorIiEEED2Ev[_ZN3tbb10strict_ppl16concurrent_queueIiNS_23cache_aligned_allocatorIiEEED5Ev]+0x12d): undefined reference to `tbb::internal::NFS_Free(void*)'
/tmp/ccQg8OKZ.o: In function `tbb::strict_ppl::concurrent_queue<int, tbb::cache_aligned_allocator<int> >::~concurrent_queue()':
tbbqueue.cpp:(.text._ZN3tbb10strict_ppl16concurrent_queueIiNS_23cache_aligned_allocatorIiEEED0Ev[_ZN3tbb10strict_ppl16concurrent_queueIiNS_23cache_aligned_allocatorIiEEED0Ev]+0x12d): undefined reference to `tbb::internal::NFS_Free(void*)'
/tmp/ccQg8OKZ.o: In function `main':
tbbqueue.cpp:(.text.startup+0x32): undefined reference to `tbb::internal::NFS_Allocate(unsigned long, unsigned long, void*)'
collect2: error: ld returned 1 exit status
make: *** [tbbqueue.o] Error 1 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-10-03T12:37:43.430

为链接指定库和源/目标文件的顺序很重要。在此处查看更多详细信息：[为什么链接库的顺序有时会导致 GCC 中的错误？](https://stackoverflow.com/questions/45135/linker-order-gcc)

在这种情况下，与 TBB ( `-ltbb`) 链接的标志是在程序源文件 ( ) 之前的命令行中指定的`tbbqueue.cpp`。因此，当链接器处理 TBB 库时，它没有看到任何使用它的代码，决定它是不必要的，并从考虑中删除了它的所有符号。然后，它在从 编译的目标文件中看到了外部符号`tbbqueue.cpp`，但没有看到可以找到这些符号的库。

如果选项的顺序改变如下：

```
g++ -O3 -Wall -pthread -std=c++11 -o tbbqueue.o tbbqueue.cpp -ltbb 
```

编译应该成功。

# c++ - C++ 中的数值数据验证

> ID：16115023
> 
> 赞同：0
> 
> 时间：2013-04-19T23:50:52.807
> 
> 标签：c++, validation, while-loop, numeric

我到处寻找，但似乎找不到并实现只接受整数的输入验证，我的代码运行得非常好，但我唯一的问题是，由于我添加了验证代码，它需要用户输入两次在它接受第二个输入之前，我想要的只是用户只需输入一次并进行良好的验证，以便程序识别它不是 int 并显示适当的消息，我非常感谢任何帮助！

这是我的代码：

```
cout<<"Please enter your first value: \n";
cin>>a;

//Error checker to check if input is a number
while(!(cin >> a))
{    
    cin.clear();
    std::cin.ignore(numeric_limits<streamsize>::max(), '\n');
    cout << "Invalid input. Please Try again: "<<endl;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-19T23:54:49.487

您尝试`cin>>a`在循环之前执行一次`while`，然后在 while 循环条件下再次执行。只需删除初始提取。

```
cout<<"Please enter your first value: \n";
// cin>>a; <- remove this

//Error checker to check if input is a number
while(!(cin >> a)) 
```

# java - 关闭服务器按钮问题

> ID：16115024
> 
> 赞同：1
> 
> 时间：2013-04-19T23:50:56.290
> 
> 标签：java, multithreading, syntax

我是java新手。我用一个按钮启动我的服务器

```
 JButton startServerButton = new JButton("Start");
    startServerButton.addActionListener(new ActionListener() {
        public void actionPerformed(ActionEvent e) {
            if (e.getActionCommand().equals("Start")) {
                Runnable serverRunnable = new Runnable() {
                    public void run() {
                        runServer();
                    }
                };
                Thread serverThread = new Thread(serverRunnable);
                serverThread.start();
            }
        }
    }); 
```

我想用一个按钮关闭它

```
 JButton endServerButton = new JButton("End");
    endServerButton.addActionListener(new ActionListener() {
        public void actionPerformed(ActionEvent e) {
            if (e.getActionCommand().equals("End")) {
                closeConnection();
            }
        }
    }); 
```

但关闭按钮不起作用......请帮忙！这是关闭功能

```
private void closeConnection() {
    displayMessage("\nTerminating connection\n");
    try {
        output.close();
        input.close();
        connection.close();

    } catch (IOException ioException) {
        ioException.printStackTrace();
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-20T01:29:15.683

尝试以下选项：

**1)**将**End**操作放在一个新线程中，然后关闭**Start**线程的 IO 和套接字连接。（意味着从另一个线程关闭第一个线程套接字连接）

**2）**在**End**操作线程中，设置**Start** thread'socket timeout。

问候，

# python - Python 的 sys.settrace 不会创建 c_call 事件

> ID：16115027
> 
> 赞同：8
> 
> 时间：2013-04-19T23:51:33.413
> 
> 标签：python, debugging

的文档`sys.settrace`说它可以报告对 c 或内置函数的调用。当我尝试以下程序时，我希望看到一个`c_call`事件，但没有任何反应：

```
import sys

def tracer(frame, event, arg):
    print(frame, event, arg)
    return tracer

sys.settrace(tracer)

x = len([1,2,3]) 
```

有什么想法吗？

`sys.settrace`任何人都可以发布一个生成`c_call`事件的示例使用吗？

编辑：最初我用 Python 3.2 尝试过，但它没有给我任何事件。现在我用 Python 2.7 试了一下，它给了我两个`call`-s（不是`c_call`-s）。还是很奇怪。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-04-20T11:27:35.140

文档是错误的，`c_call`事件将永远不会发送到您的跟踪功能：[http ://bugs.python.org/issue17799](http://bugs.python.org/issue17799)

# java - JLabel 文字乱码

> ID：16115028
> 
> 赞同：2
> 
> 时间：2013-04-19T23:51:34.520
> 
> 标签：java, swing, character-encoding, jlabel, off-by-one

我看到一个涉及`JLabel`用于显示一系列数字的奇怪问题。标签的文本通常类似于**0.0 - 100.0**（例如）。问题在于，对于少数几个用户，文本出现乱码。在此示例中，文本将显示为**/-/,0//-/**。

到目前为止，这是我所知道的：

*   这似乎是某种错误的错误，因为显示的每个字符都是预期字符后面的一个 Unicode 字符。
*   两个数字之间的短划线字符在应用程序中被硬编码为字符串文字。
*   它发生在各种版本的 Oracle JVM 上，包括 1.6.x 和 1.7.x。
*   它发生在一些选定的 Windows 7 机器上。

什么可能导致此类问题？我还应该调查什么？谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-23T00:34:29.140

当您将字体设置为`JLabel`Windows 字体缓存中损坏的字体时，就会发生这种情况。

要重建缓存：以管理员身份删除此文件并重新启动 PC：

```
del %WINDIR%\System32\FNTCACHE.DAT 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-20T01:01:46.560

它看起来像一个错误`DateFormat`的 ，其中的实例“通常不同步”。如果它是间歇性的，而不是选择性的，请验证 的正确使用 [`invokeLater()`](http://docs.oracle.com/javase/tutorial/uiswing/concurrency/initial.html)，并“为每个线程创建单独的格式实例”。另请参阅[`Format`](http://docs.oracle.com/javase/7/docs/api/java/text/Format.html)。

附录：错误符号可能来自`DateFormatSymbols`或`DecimalFormatSymbols`的具体子类使用`Format`。您可以通过多种方式验证事件调度线程的正确使用：

*   检查 的结果`SwingUtilities.isEventDispatchThread()`。

*   [采用此处](https://stackoverflow.com/q/7787998/230513)引用的文章中显示的方案之一。

*   [*按照内存一致性属性*](http://docs.oracle.com/javase/7/docs/api/java/util/concurrent/package-summary.html#MemoryVisibility)中总结的原则检查源代码。

由于您无法重现该问题，因此您必须寻求用户的帮助。理想情况下，您需要征集以下内容：

*   主机名、平台、语言环境和 JVM 版本来自`System.getProperty()`？

*   断断续续的还是连贯的？

*   [截图](https://meta.stackexchange.com/questions/99734/how-do-i-create-a-screenshot-to-illustrate-a-post)？

[您可以按照此处](https://stackoverflow.com/a/15817368/230513)`Desktop#mail()`的建议，在使用准备好的消息中填写一些详细信息，从而使用户更轻松。

# oauth - 如何在经典 sinatra 应用程序中配置omniauth 使用memcached 作为谷歌的后备存储？

> ID：16115030
> 
> 赞同：1
> 
> 时间：2013-04-19T23:52:00.757
> 
> 标签：oauth, sinatra, omniauth

我正在尝试调试一个问题，即当 EC2 ELB 后面有多个应用服务器时使用 Google 执行 oauth 失败。我认为该问题与未共享 oauth 后备存储这一事实有关。我们采用的解决方案运行了 2 年多，然后突然在 2 天前开始失败，我不知道这是我的配置问题还是谷歌改变了一些东西。

我相信要解决问题，我必须使用共享存储，例如 memcached。

这是我在经典风格的 sinatra 应用程序中的尝试：

```
Sinatra::Application.use ::OmniAuth::Strategies::OpenID do
  OpenID::Store::Memcache.new(Memcached.new('my_memcached_machine'))
end 
```

不幸的是，这仍然没有解决问题。据我所知，OmniAuth 从未对 memcached 执行任何获取或设置请求。

这是让omniauth在经典风格的sinatra应用程序中尝试向谷歌进行身份验证时使用memcached的正确方法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-20T00:49:15.480

这是我发现的一种方法，但我确信有更好的方法......

```
module Rack
  class OpenID
    def initialize(app, store = nil)
      @app = app
      @store = ::OpenID::Store::Memcache.new(OpenIDMemcachedManager.new('...'))
    end
  end
end 
```

# javascript - 使用 eq() 获取第 n 个输入元素的值

> ID：16115035
> 
> 赞同：0
> 
> 时间：2013-04-19T23:52:45.590
> 
> 标签：javascript, jquery

```
var i = input.eq(2).val();
alert(parseInt(i)); 
```

我正在尝试获取第三个输入的值，但它什么也没返回。我曾经说过[对象] [对象]。我如何才能获得输入的值？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-20T00:23:04.990

如果您提供有关以下方面的更多信息，将会很有帮助：

1.  输入是什么？Sachin 提到的 jQuery 对象？

2.  我的价值是多少？执行后是你想要的吗？

3.  调用 parseInt 后会返回什么？

您还可以在输入选择器中使用 eq：

```
var i = $("input:eq(2)").val();
alert(i); 
```

希望它有帮助。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-19T23:58:45.633

像这样使用[Jquery 的 .eq()](http://api.jquery.com/eq/) api

```
 var i = $('input').eq(2).val();
  alert(parseInt(i)); 
```

或者当您的代码看起来将输入作为变量时，您需要执行此操作

```
var input = $('input');
var i = input.eq(2).val();
alert(parseInt(i)); 
```

[JS 小提琴示例](http://jsfiddle.net/sachinyadav/aTaxs/)

# sql - Sql存储过程while循环

> ID：16115043
> 
> 赞同：6
> 
> 时间：2013-04-19T23:53:17.843
> 
> 标签：sql, stored-procedures, database-cursor

数据示例：

```
ID  Name       ParentID
1   parent-1   NULL
2   parent-2   NULL
3   sub        1
4   child-1-1  3
5   child-1-2  1
6   child-2-1  2 
```

**现在，如果我搜索 Name like '%child-1%'，我想要以下记录：上述数据中的第 1 行、第 3 行、第 4 行和第 5 行。如果我可以编写返回不同行的存储过程会怎样？**

我的想法是如果我搜索文本，它将继续从表中选择记录，直到 parentID 为空。因此，如果我对“child-1”进行类似搜索，则基本 sql 查询将返回第 4 行和第 5 行。但是我的程序在一个循环中检查第 4 行的 parentid 不为空，因此它得到一个 ID= 第 4 行的 parentid 为 3 的行。现在它得到一个 ID = 第 3 行的 parentid 的行为 1 并获得第 1 行。现在 row-1 的 parentd 为 NULL，所以它停止了。

我正在使用此存储过程在树视图中实现搜索功能，我希望在搜索后保留父子层次结构。

到目前为止，我已经尝试过了，但我对存储过程很陌生：

```
USE DBname
Go
DECLARE @ParentID int
Declare @myresultset Cursor
Set @myresultset = CURSOR for Select ParentID from mytable where Name like 'child-1%'
OPEN @myresultset 
Fetch NEXT from @myresultset
into @ParentID
While @@Fetch_Status=0
Begin
 While @ParentID is not NULL
  Begin
    Select @ParentID = ParentID from mytable where ID=@ParentID
    Select distinct * from mytable where ID=@ParentID
  End
 Fetch Next from @myresultset
 into @ParentID
End
close @myresultset 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-22T02:42:30.690

我没有使用过程代码对此进行编码，而是使用面向集合的 SQL 对其进行了重新编码。我正在使用递归 CTE 来查找给定孩子的“父母”。这是我的存储过程：

```
CREATE PROC find_parents (@childname varchar(20)) as

;WITH heirarchy_cte (ID, Name, ParentID, Level) as
(SELECT e.ID, e.Name, e.ParentID, 0 as Level
    FROM mytable as e
    where e.Name like @childname
UNION ALL
SELECT e.ID, e.Name, e.ParentID, Level+1
    FROM mytable as e
    INNER JOIN heirarchy_cte as h
    ON h.ParentID=e.ID
    )
SELECT DISTINCT ID, Name, ParentID
FROM heirarchy_cte
ORDER BY ID 
```

然后我运行它：

```
exec find_parents @childname='child-1%' 
```

如果我的结果是正确的，那么这个解决方案应该可以更好地适应更多的数据。正如您所指出的，我还将其编码为存储过程。

要查看完整代码，请参阅 SQL Fiddle： [Find Parents SQL Fiddle Demo](http://sqlfiddle.com/#!3/a9cbd/1)

如果我的解决方案是正确的，请将其标记为答案。谢谢。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-02-26T10:00:34.170

试试这个简单的例子

```
CREATE PROCEDURE proc (
    IN i INTEGER,
    IN j INTEGER)
BEGIN
    DECLARE z integer;
    set z=i;
   while (z<j) do
     begin
       set z=z+1;
     end;
  end while;
END; 
```

# java - 为什么从列表中删除元素会引发 ConcurrentModificationException？

> ID：16115044
> 
> 赞同：2
> 
> 时间：2013-04-19T23:53:36.783
> 
> 标签：java, exception, iterator

`ConcurrentModificationException`当我运行以下代码时，我的程序会抛出异常。通过一些研究，我发现在迭代器循环中无法添加或删除列表中的元素。我现在该怎么做才能删除`List<Bean>`?

```
for (Iterator<Entry<String, List<Bean>>> iterator = dataMap.entrySet().iterator(); iterator.hasNext();) {
    Entry<String, List<Bean>> entry = (Entry<String, List<Bean>>)iterator.next();
    List<Bean> dateWiseValues = (List<Bean>) entry.getValue();
    int j = 0;
    for (Bean statBean : dateWiseValues) {
        for (int i = 0; i < commonElements.size(); i++) {
            if(statBean.getDate().equalsIgnoreCase(commonElements.get(i))) {
                //remove the bean
                entry.getValue().remove(j);
            }
        }
        j++;
    }
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-20T00:02:32.020

*与其使用基于范围的for*循环`dateWiseValues`，不如使用`Iterator`显式的，以便您可以调用[`Iterator#remove()`](http://docs.oracle.com/javase/7/docs/api/java/util/Iterator.html#remove%28%29)：

```
for (final Iterator<? extends Bean> it = dateWiseValues.iterator();
     it.hasNext();) {
  final Bean statBean = it.next();
  for (int i = 0, last = commonElements.size(); i != last; ++i)
    if (statBean.getDate().equalsIgnoreCase(commonElements.get(i)))                
      it.remove();
} 
```

通常，只要您通过集合的迭代器之一进行迭代，就可以安全地从集合和底层集合中删除元素。

* * *

虽然我们看不到 的具体类型`dateWiseValues`，但我们知道它是 的子类型`List`。两种常见的具体实现类型`List`是[`ArrayList`](http://docs.oracle.com/javase/7/docs/api/java/util/ArrayList.html)和[`LinkedList`](http://docs.oracle.com/javase/7/docs/api/java/util/LinkedList.html)。这些类中的每一个的散文类级别文档都包含以下警告：

> 此类的`iterator`和`listIterator`方法返回的迭代器是快速失败的：如果在创建迭代器后的任何时候列表在结构上被修改，除了通过`Iterator`自己的`remove`或`add`方法之外的任何方式，迭代器将抛出一个`ConcurrentModificationException`. 因此，面对并发修改，迭代器快速而干净地失败，而不是在未来不确定的时间冒任意的、非确定性的行为。

请注意，它警告您必须在迭代期间使用突变，否则下次使用相同或任何其他迭代器遍历相同的基础列表时，`Iterator#remove()`您将面临抛出异常。`ConcurrentModificationException`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-20T00:02:33.317

当您使用增强循环时，它会在幕后`for`隐式使用。`Iterator`这是`Iterator`抛出的，而不是您在外循环中定义`ConcurrentModificationException`的显式迭代器。在 an 迭代列表时，您不能从列表中删除，除非您调用，这将删除当前列表项并避免.`iterator``for``Iterator`[`Iterator#remove()`](http://docs.oracle.com/javase/7/docs/api/java/util/Iterator.html#remove%28%29)`ConcurrentModificationException`

你的两个选择：

*   重写增强`for`循环以显式使用`while`循环和`Iterator`，然后`remove()`在要删除项目时调用。
*   创建一个`List`要删除的项目。当您确定要删除该项目时，`add`将其添加到要删除的项目列表中。然后， *在*您完成迭代后，调用[`removeAll`](http://docs.oracle.com/javase/7/docs/api/java/util/List.html#removeAll%28java.util.Collection%29)原始列表以删除您希望删除的所有项目。

# c# - 如何以标准方式返回数据？

> ID：16115049
> 
> 赞同：2
> 
> 时间：2013-04-19T23:54:12.740
> 
> 标签：c#, .net, json, asp.net-web-api

我试图弄清楚如何以标准方式返回我的数据。我的意思是当我返回 json 或 xml 时，最好为所有内容（成功和错误）提供一种格式。

假设我有以下 json 结果。

```
{
  "person": {
    "id": 12345,
    "firstName": "John",
    "lastName": "Doe",
    "phones": {
      "home": "800-123-4567",
      "work": "888-555-0000",
      "cell": "877-123-1234"
    },
    "email": [
      "jd@example.com",
      "jd@example.org"
    ],
    "dateOfBirth": "1980-01-02T00:00:00.000Z",
    "registered": true,
    "emergencyContacts": [
      {
        "name": "",
        "phone": "",
        "email": "",
        "relationship": "spouse|parent|child|other"
      }
    ]
  }
} 
```

这一切都很好，但现在如果出现验证错误会发生什么

我可以使用内置方法 CreateErrorResponse

```
{
  "Message": "The request is invalid.",
  "ModelState": {
    "item": [
      "Required property 'Name' not found in JSON. Path '', line 1, position 14."
    ],
    "item.Name": [
      "The Name field is required."
    ],
    "item.Price": [
      "The field Price must be between 0 and 999."
    ]
  }
} 
```

*是的，我知道数据没有意义并且有所不同，但数据仅与结构无关。

现在如果我有错误会发生什么，在这种情况下它有一个自定义错误代码。

我可以返回这样的东西（使用 HttpError）

```
{
  "Message": "My custom error message",
  "CustomErrorCode": 37
} 
```

现在你可以看到我有 3 种不同格式的 json 回来了。现在在客户端我必须这样做

1.  检查 HttpStatusCode
    *   如果是 200，那么在这种情况下使用 Person 的格式解析 json。
    *   如果 400 则可能是验证错误或服务器错误。
    *   如果发现客户错误，则使用该格式，否则使用 modlestate。

我一直在使用foursquare，似乎他们总是将相同的格式返回给用户，但我不知道如何在我这样做时获得相同的东西。

```
 {
          "meta": {
            "code": 200,
             ...errorType and errorDetail...
          },
          "notifications": {
             ...notifications...
          },
          "response": {
             ...results...
          }
        } 
```

我想做类似的事情

这将是一个好的要求。

```
{
    "meta": {
        "code": 200,
         "ModelState": {}
    },
    "response": {
        "person": {
            "id": 12345,
            "firstName": "John",
            "lastName": "Doe",
            "phones": {
                "home": "800-123-4567",
                "work": "888-555-0000",
                "cell": "877-123-1234"
            },
            "email": [
                "jd@example.com",
                "jd@example.org"
            ],
            "dateOfBirth": "1980-01-02T00:00:00.000Z",
            "registered": true,
            "emergencyContacts": [
                {
                    "name": "",
                    "phone": "",
                    "email": "",
                    "relationship": "spouse|parent|child|other"
                }
            ]
        }
    }
} 
```

服务器错误看起来像这样

```
{
    "meta": {
        "code": 500,
        "message": "this is a server error",
        "ModelState": {}
    },
    "response": {}
} 
```

验证看起来像这样

```
{
    "meta": {
        "code": 400,
        "message": "validation errors",
        "Message": "The request is invalid.",
        "ModelState": {
            "item": [
                "Required property 'Name' not found in JSON. Path '', line 1, position 14."
            ],
            "item.Name": [
                "The Name field is required."
            ],
            "item.Price": [
                "The field Price must be between 0 and 999."
            ]
        }
    },
    "response": {}
} 
```

但就像我说的不确定如何做这样的事情，也不是 100% 确定这仍然是最好的方法。至少它应该是一种格式呢？

**编辑** @Erik Philips

当我只做 asp.net mvc 项目时，我会做这样的事情。

```
public readonly IValidation validation;

public PersonService(IValidation validation)
{
    this.validation = validation;
}

public Person GetPerson(int id)
{

    try
    {
       return FindPerson(id);
    }
    catch(Exception ex)
    {
        //log real error with elmah
        validation.addError("internal", "Something went wrong");
    }
}

public class PersonController
{
     public readonly IPersonService personService;
     public PersonController(IPersonService personService)
     {
       this.personService = personService;
     }

    public ActionResult GetPerson(int id)
    {
        personService.GetPerson(id);

        if(personService.Validation.IsValid)
        {
          // do something
        }
        else
        { 
          // do something else
        }

        return View();
    }
} 
```

我喜欢你的设置方式，但我想保持这种方式。我不认为我可以使用界面，但我正在考虑这样的事情

```
public PersonService()
{

}

public ResponseResult<Person> GetPerson(int id)
{
    var result = ResponseResult<Person>();
    try
    {
       return FindPerson(id);
    }
    catch(Exception ex)
    {
       result.Errorcode = 200;
       result.Msg = "Failed";
    }
}

public class PersonController
{
     public readonly IPersonService personService;
     public PersonController(IPersonService personService)
     {
       this.personService = personService;
     }

    public HttpResponseMessage GetPerson(int id)
    {
       var result = personService.GetPerson(id);
       if(result.isValid)
       {
          Request.CreateResponse<ResponseResult<Person>>(HttpStatusCode.OK, result);
       }

         Request.CreateResponse<ResponseResult<Person>>(HttpStatusCode.BadRequest, result);
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-20T00:31:42.593

这是一个很大的问题，因为它是发送包含多个部分的数据的设计，但我相信这是一个相当简单、小巧且优雅的解决方案。

这不完全是我使用的，但它是一个很好的例子：

首先让我们构建一个模型来表示所有响应需要什么，或者可以在不需要结果数据时使用：

```
public class ResponseResult
{
    public ResponseResult()
    {
    }

    public ResponseResult(ModelStateDictionary modelState)
    {
        this.ModelState = new ModelStateResult (modelState);
    }

    // Is this request valid, in the context of the actual request
    public bool IsValid { get; set; }
    // Serialized Model state if needed
    public ModelStateResult ModelState { get; set; }
} 
```

接下来，可能有大量不同类型的结果要返回，这里泛型就派上用场了：

```
public class ResponseResult<T> : ResponseResult
{
    public ResponseResult() : base()
    {
    }

    public ResponseResult(ModelStateDictionary modelState)
        : base(modelState)
    {
    }

    public ResponseResult(T Data, ModelStateDictionary modelState)
        : base (modelState)
    {
        this.Data = Data;
    }

    public T Data { get; set; }
} 
```

所以现在如果你需要返回 a`Person`你可以返回：

```
var result = ResponseResult<Person>();

result.Data = person;

//serialize result and send to client. 
```

我的 API 可以被 Javascript 使用，所以我更改了 Http 状态代码，并举例说明如何使用 jQuery 重定向和使用数据。

```
request = $.ajax({
  type: "POST",
  url: url,
  data: data,
  success: function(data, textStatus, jqXHR)
  {
    processResponseResult(data);
  }
  complete: function(e, xhr, settings)
  {
    if(e.status === 401)
    {
      // login to 
    }
    // else if (e.status == ) 
    else
    {
      // unknown status code
    }
)}; 
```

您可能希望扩展结果以供将来甚至可能不使用 http (WCF) 的客户端使用：

```
public class ResponseResult
{
   ....
   ....
   public int ErrorCode { get; set; }
   public string ErrorMessage { get; set; }
} 
```

或者更进一步：

```
public class ResponseErrorBase
{
   public int ErrorCode { get; set; }
   public string ErrorMessage { get; set; }
}

public class ResponseResult
{
   ....
   ....
   public ResponseErrorBase Error { get; set; }
} 
```

因此您将来可以添加更多错误类型/信息。

**更新每条评论**

*评论1：如果你有一群人，那么你有..*

```
List<Person> persons = new List<Person>();
var result = new ResponseResult<List<Person>>();
result.Data = persons; 
```

*评论2：有2个类..*

如果您的 API 有调用，`FileExists(fileName)`那么您实际上不必返回对象，只要调用成功即可。

```
var result = new ResponseResult();
result.IsValid = FileExists(fileName); 
```

如果您的 API 想要返回新的 ID，`Person`您可以返回新的 ID。

```
var result = new ResponseResult<Guid?>();
result.IsValid = CreatePerson(personInfo);
if (result.IsValid)
{
  result.Data = personInfo.ID;
} 
```

或者您可以返回新的成功`Person`对象，如果不成功，则返回 null。

```
var result = new ResponseResult<Person>();
result.IsValid = CreatePerson(personInfo);
if (result.IsValid)
{
  result.Data = Person;
} 
```

**更新每条评论**

我推荐的是我之前写的并包含`ResponseErrorBase`在 ResponseResult 中：

```
public class ResponseResult
{
  public ResponseResult()
  {
  }

  public ResponseResult(ModelStateDictionary modelState)
  {
    this.ModelState = new ModelStateResult (modelState);
  }

  public bool IsValid { get; set; }
  public ModelStateResult ModelState { get; set; }
  public ResponseErrorBase Error { get; set; }
} 
```

然后将您的错误从基础推导出到特定的东西：

```
// this isn't abstract because you may want to just return
// non-specific error messages
public class ResponseErrorBase
{
  public int Code { get; set; }
  public string Message { get; set; }
}

public class InternalResponseError : ResponseErrorBase
{
  // A Property that is specific to this error but
  // not for all Errors
  public int InternalErrorLogID { get; set; }
} 
```

然后返回它（返回值的示例，您需要更多逻辑）：

```
var result = new ResponseResult<Person>();

try
{
  result.Data = db.FindPerson(id);
}
catch (SqlException ex)
{
  var error = ResponseErrorBase();
  error.Code = 415;
  error.Message = "Sql Exception";
}
catch (Exception ex)
{
  var error = InternalResponseError();
  error.InternalErrorLogID  = Log.WriteException(ex);
  error.Code = 500;
  error.Message = "Internal Error";
}

// MVC might look like:
return this.Json(result); 
```

# objective-c - 为什么从 plist 读取数据时第二个值（Null）？

> ID：16115050
> 
> 赞同：0
> 
> 时间：2013-04-19T23:54:36.040
> 
> 标签：objective-c, cocos2d-iphone, plist, kobold2d, nsenumerator

这个问题来自 makegameswith.us 网站和他们的 Peeved Penguin 项目。我正在尝试修改它以从 plist 而不是 GameLayer.mm 读取关卡数据，第一个精灵数据按预期读取，第二次通过 while 循环返回（Null）精灵名称。我查看了 plist，两个精灵应该具有相同的文件名“tallblock”。

以下是相关的代码片段：

```
CCLOG(@"About to load level data.");

    // Load Level Data and Draw Level Sprits
    NSString *path = [[NSBundle mainBundle] pathForResource:@"Level1" ofType:@"plist"];
    NSDictionary *level = [NSDictionary dictionaryWithContentsOfFile:path];
    NSArray *levelBlocks = [level objectForKey:@"Blocks"]; // Capitalization matters

    NSEnumerator *enumerator = [levelBlocks objectEnumerator];
    id object;
    NSString *spriteName;
    NSString *spriteFile;
    NSNumber *xPos;
    NSNumber *yPos;

    // One of my sprite names is invalid...
    while (object = [enumerator nextObject])
    {
        spriteName = [object objectForKey: @"spriteName"];
        spriteFile = [spriteName stringByAppendingString:@".png"];

        CCLOG(@"Sprite File is : %@", spriteFile); // Second sprite doesn't load is null...
        sprite = [CCSprite spriteWithFile: spriteFile];
        xPos = [object objectForKey: @"x"];
        yPos = [object objectForKey: @"y"];
        sprite.position = CGPointMake([xPos floatValue], [yPos floatValue]);
        [blocks addObject:sprite];
        [self addChild: sprite
                     z: 7];
    }

    CCLOG(@"Finished Loading Level Data."); 
```

我把这个问题/问题[放在官方论坛上](http://www.makegameswith.us/community/qa/help-peeved-penguins/questions/37)，但我没有收到任何建议。我已经在调试器中多次单步执行代码，但我不明白为什么它在第一遍时发现 tallblocks 而在第二遍时却没有。

我截取了 plist 文件的屏幕截图。任何想法为什么代码在第二个精灵上失败？

![Plist 屏幕截图](https://i.stack.imgur.com/uKDfl.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-20T00:00:11.417

第 1 项的 spriteName 中缺少一个 R...

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-20T00:08:48.637

你的第二个数组条目有键 'spiteName' 而不是 'spriteName'

# mysql - Flyway：init 不创建模式数据库

> ID：16115055
> 
> 赞同：5
> 
> 时间：2013-04-19T23:54:51.140
> 
> 标签：mysql, maven, flyway

我正在使用 flyway 来管理 mysql 中的多模式数据库，并且我已经使用 Maven 配置了 flyway。我已经将一个名为“元数据”的数据库列为`<schemas>`标签中的第一个数据库，因此 flyway 会将`schema_version`表格放在这里。当我运行时`mvn flyway:migrate`，我期望创建此表**和`metadata`**数据库。Flyway 2.1.1 尝试创建表，但没有先创建数据库，因此失败。

```
[调试] 架构：元数据、临时、OTHER_DBS_REDACTED
[DEBUG] Schema `temp` 已经存在。跳过架构创建。
[调试] 数据库：MySQL 5.6  
[错误] com.googlecode.flyway.core.api.FlywayException：设置当前 sc 时出错
hema 到“元​​数据”
[错误] 由 com.mysql.jdbc.exceptions.jdbc4.MySQLSyntaxErrorException 引起：Unk
现在的数据库“元数据”

```

我认为`mvn flyway:init`可能会创建模式，但这会失败并出现不同但明显相关的错误。

```
[INFO] --- flyway-maven-plugin:2.1.1:init (default-cli) @ database ---
[INFO] 创建元数据表：`metadata`.`schema_version`
[错误] com.googlecode.flyway.core.api.FlywayException：在第 17 行执行语句时出错：CREATE TABLE `metadata`.`schema_version`（
    `version_rank` INT NOT NULL，
    `installed_rank` INT NOT NULL，
    `version` VARCHAR(50) NOT NULL,
    `description` VARCHAR(200) NOT NULL,
    `type` VARCHAR(20) NOT NULL,
    `script` VARCHAR(1000) NOT NULL,
    `校验和` INT，
    `installed_by` VARCHAR(100) NOT NULL,
    `installed_on` TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP,
    `execution_time` INT NOT NULL，
    `成功` BOOL NOT NULL
) 引擎=InnoDB
[错误] 由 com.mysql.jdbc.exceptions.jdbc4.MySQLSyntaxErrorException 引起：未知数据库“元数据”

```

如果我`create database metadata`那么事情进展顺利。事实上，我很喜欢flyway。没有手动运行一些sql，有没有办法让flyway创建这个数据库？这只是一个错误吗？

TIA

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-20T09:48:02.967

现在，创建模式支持是全有或全无。如果所有模式都缺失，它们都将被创建，否则将不创建任何模式。

# bash - 按 id 加数字的最佳方法

> ID：16115056
> 
> 赞同：-2
> 
> 时间：2013-04-19T23:54:52.990
> 
> 标签：bash

假设我有一个文件，它有 2 列。

```
12,1
12,2
11,3
11,2 
```

我想在第一列之前添加第二列。输出应如下所示

```
12,3
11,5 
```

在 Linux 环境（在命令行上）有什么简单的方法可以做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-20T00:09:57.423

在 perl 脚本中：

```
#!/usr/bin/env perl

use strict;
use warnings;

my %sum;
my %pos;

my $i = 0;

while(<>){
   chomp;
   my($x,$y) = split/,/;
   $pos{$x} = $i unless exists $pos{$x};
   $sum{$x} += $y;
   $i++;       
}

my @keys = sort { $pos{$a} <=> $pos{$b} } keys %pos;
for my $key(@keys){
   print "$key,$sum{$key}\n"
} 
```

将其放入脚本中，并将您的号码放入文件中，然后运行：

```
perl $script $file 
```

这也保持秩序。Python具有类似的结构。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-20T00:10:07.220

```
$ cat file
12,1
12,2
11,3
11,2 
```

这是一种`awk`方法：

```
$ awk -F, '$1 { a[$1]+=$2 } END { for (i in a) { printf "%s,%d\n", i, a[i] } }' file
11,5
12,3 
```

这里有一个`bash`：

```
$ cat ./id.sh
#!/bin/bash

IFS=','
while read id value; do
        [ -n "${id}" ] || continue
        (( a[id] += value ))
done < file

for id in "${!a[@]}"; do
        echo "${id},${a[${id}]}"
done

$ ./id.sh
11,5
12,3 
```

它们都按照相同的原理工作——它们逐行读取，并将它们的字段/输入分隔符设置为`,`并组装一个由第一列索引的数组——第二列的值只是相加。完成所有艰苦的工作后，我们将数组打印回来。

# algorithm - 循环不变证明

> ID：16115060
> 
> 赞同：3
> 
> 时间：2013-04-19T23:55:12.817
> 
> 标签：algorithm, loops, post-conditions, loop-invariant

我遇到了一个问题，提出了后置条件并显示了这段代码的部分正确性。

```
{ m = A ≥ 0 }
  x:=0; odd:=1; sum:=1;
  while sum<=m do
    x:=x+1; odd:=odd+2; sum:=sum+odd
  end while
{ Postcondition } 
```

我不是在寻找答案，因为这是学校的作业，只是洞察力，也许是一些指向正确方向的东西。我已经构建了值表，并且无法提出循环不变量。

```
x   odd sum m   (x + 1)^2   odd - x (odd - x)^2
0   1   1   30    1            1        1
1   3   4   30    4            2        4
2   5   9   30    9            3        9
3   7   16  30    16           4        16
4   9   25  30    25           5        25
5   11  36  30    36           6        36

sum = (odd - x)^2 
```

我知道循环的结果是 m 后面的完美正方形，但我不确定如何写。

一如既往，感谢所有帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-20T05:28:17.190

Loop invariant is:

```
odd = 2x+1
sum = (x+1)^2 
```

Proof:

*Induction base*: trivial.

*Induction step*:

```
new_x = x+1
new_odd = odd+2 = 2(x+1)+1 = 2*new_x+1
new_sum = sum+new_odd = (x+1)^2+2(x+1)+1 = new_x^2+2*new_x+1 = (new_x+1)^2 
```

# java - 在文本字段中插入值 - struts2+liferay

> ID：16115063
> 
> 赞同：1
> 
> 时间：2013-04-19T23:55:50.930
> 
> 标签：java, jsp, struts2, liferay

在我的jsp中，我有这个代码：

```
.....
    // get userid
    long userid = com.liferay.portal.util.PortalUtil.getUserId(request);
    String userName = com.liferay.portal.util.PortalUtil.getUserName(userid , "guest");
    %> 

    <s:textfield name="user" value="<%=userName%>"></s:textfield> 
```

我无法在文本字段中显示用户名值。

你能帮我吗。谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-20T09:20:40.997

Scriptlet 不允许与 Struts 标记一起使用。而且您无法访问脚本变量`userName`，因为它不在值堆栈上。要使其可用，只需在具有脚本变量值的值堆栈中创建一个新变量。

```
<s:set var="userName"><%=userName%></s:set>
<s:textfield name="user" value="%{#userName}"/> 
```

另一种意料之外的方法是使用已知容器，例如 struts 标签可访问的 request。

```
<% request.setAttribute("userName", userName); %>
<s:textfield name="user" value="%{#request.userName}"/> 
```

您可能会注意到，在第一个示例中，创建了新变量并且脚本变量通过值作为字符串打印到输出中传递。在第二个示例中，脚本变量通过引用传递。

# python - 手势识别 (PCA) - Python

> ID：16115068
> 
> 赞同：2
> 
> 时间：2013-04-19T23:56:36.200
> 
> 标签：python, numpy, gesture-recognition, pca

我正在尝试使用 python 通过主成分分析 (PCA) 进行手势识别。我正在按照本教程中的步骤操作：http: [//onionesquereality.wordpress.com/2009/02/11/face-recognition-using-eigenfaces-and-distance-classifiers-a-tutorial/](http://onionesquereality.wordpress.com/2009/02/11/face-recognition-using-eigenfaces-and-distance-classifiers-a-tutorial/)

这是我的代码：

```
import os
from PIL import Image
import numpy as np
import glob
import numpy.linalg as linalg

#Step 1: put training images into a 2D array
filenames = glob.glob('C:\\Users\\Karim\\Desktop\\Training & Test images\\New folder\\Training/*.png')
filenames.sort()
img = [Image.open(fn).convert('L').resize((90, 90)) for fn in filenames]
images = np.asarray([np.array(im).flatten() for im in img])

#Step 2: find the mean image and the mean-shifted input images
mean_image = images.mean(axis=0)
shifted_images = images - mean_image

#Step 3: Covariance
c = np.asmatrix(shifted_images) * np.asmatrix(shifted_images.T)

#Step 4: Sorted eigenvalues and eigenvectors
eigenvalues,eigenvectors = linalg.eig(c)
idx = np.argsort(-eigenvalues)
eigenvalues = eigenvalues[idx]
eigenvectors = eigenvectors[:, idx]

#Step 6: Finding weights
w = eigenvectors.T * np.asmatrix(shifted_images)  
w = np.asarray(w)

#Step 7: Input (Test) image
input_image = Image.open('C:\\Users\\Karim\\Desktop\\Training & Test images\\New folder\\Test\\31.png').convert('L').resize((90, 90))
input_image = np.asarray(input_image).flatten()

#Step 8: get the normalized image, covariance, eigenvalues and eigenvectors for input image
shifted_in = input_image - mean_image
c = np.cov(input_image)
cmat = c.reshape(1,1)
eigenvalues_in, eigenvectors_in = linalg.eig(cmat)

#Step 9: Fing weights of input image
w_in = eigenvectors_in.T * np.asmatrix(shifted_in) 
w_in = np.asarray(w_in)

#Step 10: Euclidean distance
df = np.asarray(w - w_in)                # the difference between the images
dst = np.sqrt(np.sum(df**2, axis=1))     # their euclidean distances
idx = np.argmin(dst)                     # index of the smallest value in 'dst' which should be equal to index of the most simillar image in 'images'
print idx 
```

检测到的图像应该是从训练图像到测试图像最近的图像，但结果是完全不同的，尽管对于每个测试图像，训练图像中有 10 个相似的图像。

任何人都可以帮忙吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-20T00:27:08.290

原始图像位图上的 PCA 是一种糟糕的人脸识别算法。坦率地说，不要指望它可以使用人脸的真实图像来实际工作。它作为一种学习工具很有用，但仅此而已。

尝试用极其简单的图像测试你的算法——想想在不同地方有黑色形状的白色图像。PCA 应该能够很好地做到这一点。如果它适用于那些，恭喜，你写得对。然后升级到更复杂的算法。

或者下载已在研究中显示的人脸图像的标准学术数据集以与 PCA 一起使用。对于这样一个简单的算法，对齐和颜色等小问题至关重要。

# facebook-graph-api - Facebook 广告 API：offline_access 是如何工作的？

> ID：16115072
> 
> 赞同：0
> 
> 时间：2013-04-19T23:56:54.293
> 
> 标签：facebook-graph-api, facebook-oauth

根据[文档，如果您有一个可以访问 Ads API 的首选开发人员应用程序，您可以请求 offline_access 权限](https://developers.facebook.com/roadmap/offline-access-removal/)

它是如何工作的？当我获得令牌时，我得到如下信息：

```
access_token=hehehehehe&expires=5183795 
```

.. 这意味着令牌通常会在两个月内到期。会自动延长吗？还是我必须采取一些额外的措施才能获得未过期的令牌？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-07-11T11:32:06.850

一段时间后，我终于找到了答案。如果您有一个列入白名单的应用程序，您将不会在响应中获得过期字段：

```
access_token=hehehehehe 
```

无论您是否要求，这都适用于列入白名单的应用程序`offline_access`。

# javascript - 为什么我的正则表达式不匹配整个文档？

> ID：16115076
> 
> 赞同：2
> 
> 时间：2013-04-19T23:57:27.720
> 
> 标签：javascript, jquery, regex

我正在尝试构建一个小型 Javascript 应用程序，该应用程序加载第三方站点，查找给定单词并使用 Jquery 扩展[Highlight 突出显示](http://bartaz.github.io/sandbox.js/jquery.highlight.html)文档的最接近上下文（具有允许正则表达式的小自定义）。

首先，我试图通过将上下文设置为 500 个字符来让应用程序突出显示周围环境，但由于某种原因，它在奇怪的地方被切断了。对于[这篇文章](http://www.dailymail.co.uk/news/article-2311114/President-Obama-console-reeling-nation-honors-victims-Marathon-bombings-memorial-service-Boston.html?ITO=1490&ns_campaign=1490&ns_mchannel=rss)，我试图匹配术语*Obama*，正如你从我的截图中看到的那样，它在不应该出现的地方被切断了。

有没有人知道发生了什么？

```
$(document).ready(function() {
    $.get(getUrlVars()["url"],
    function(data) {
        var fdata = $(data);
        var associationScope= 500;

        $.each(getUrlVars()["topics"].split(","), function(index, value) {
            if (getUrlVars()["associationScope"] == "context") {
                var associationScopeRegex = "((?!</span>)[\\s\\S]{0," + associationScope + "})" 
                    + value + "((?!<span class=\"associationScope\">)[\\s\\S]{0," + associationScope + "})";

                fdata.highlight(associationScopeRegex, {className: "associationScope"});
            }

            fdata.highlight(value, {className: "topicHighlight"});
        });

        $("#externalPage").html(fdata);

    });
}); 
```

![高亮结果截图](https://i.stack.imgur.com/RKHDu.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-20T00:00:09.780

当您通过字符串构建时，您需要转义一些正则表达式元字符（在您的情况下是反斜杠）：

```
 var associationScopeRegex = "((?!</span>)(.|\\n|\\r|\\t){0," + associationScope + "})" 
       + value + "((?!<span class=\"associationScope\">)(.|\\n|\\r|\\t){0," + associationScope + "})"; 
```

当您从字符串构建正则表达式时，您必须考虑到 JavaScript 解析器不知道您的字符串将成为正则表达式的事实；它只是将其解析为字符串。字符串常量的语法对某些特殊字符使用反斜杠，因此这些字符将被解释为字符串的一部分。

（您不必在双引号字符的反斜杠上加倍，因为可以将它们保留为正则表达式的简单双引号。）

# javascript - 如何设置 ExtJS 窗口显示/隐藏动画？

> ID：16115079
> 
> 赞同：4
> 
> 时间：2013-04-19T23:57:39.580
> 
> 标签：javascript, extjs

这是我的源代码：

```
Ext.create('Ext.window.Window', {
    id:'edit_segtype_win',
    标题：'味精'，
    布局：'适合'，
    html：数据，
    模态：真，
    可调整大小：假，
    约束：真
}).show(未定义,bind_ajax_success);

```

当我调用 show(...) 时，窗口将显示没有任何动画。我想添加一些动画，例如淡入/淡出/滑入/滑出。有人可以帮助我吗？谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-20T00:20:49.787

您可以使用动画对象[http://docs.sencha.com/extjs/4.2.0/#!/api/Ext.fx.Anim](http://docs.sencha.com/extjs/4.2.0/#!/api/Ext.fx.Anim)在您的窗口组件中使用，如下所示：

```
var myWindow = Ext.create('Ext.window.Window', {
    html:"hello world",
});

Ext.create('Ext.fx.Anim', {
    target: myWindow,
    duration: 1000,
    from: {
        width: 400, //starting width 400
        opacity: 0,       // Transparent
        color: '#ffffff', // White
        left: 0
    },
    to: {
        width: 300, //end width 300
        height: 300 // end height 300
    }
}); 
```

然后，当您调用

```
window.show(); 
```

# html - CSS：无法使用 user-select:auto 选择子文本，而父级有 user-select:none

> ID：16115083
> 
> 赞同：0
> 
> 时间：2013-04-19T23:58:16.810
> 
> 标签：html, css

我正在尝试编写带有说明的输入表单。我希望文本不可选择，但当然我希望输入是可选择的，以便用户可以轻松修改他们的文本。

我的 HTML 看起来像这样：

```
<div id="form">
<header> Some header text </header>
Instructions on what to do.
<form>
<label>first name:</label><input type="text" name="fname" />
<label>last:</label><input type="text" name="lname" />
<label>email:</label><input type="text" name="email" />
</form>
<div id="extras"> A bunch of separate notes and maybe a textarea box</div>
</div> 
```

我的 CSS 看起来像这样：

```
#form{ user-select:none; }
#form form input{user-select:auto} 
```

一些注意事项：
我在我的实际代码中包含了各种浏览器的所有 css。
我尝试了用户选择：文本，但它不起作用。
我将许多文本分成不同的部分，因此我非常喜欢删除选择作为默认行为的能力，而只是将选择能力应用于输入。应用代码使每一点文本都无法选择会很痛苦。
即使我做了上述修复，我仍然会对这个问题感到好奇。

有谁知道为什么会这样？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-07-27T11:41:12.933

没有`user-select: auto;`你应该使用`user-select: text;` [你给定的代码作品这样的东西，](http://jsfiddle.net/ELzga/)所以你可能想要包含其余的代码或链接到它。

# java - 更改和改进了将数据从 WebServlet 传递到 WebService

> ID：16115087
> 
> 赞同：1
> 
> 时间：2013-04-19T21:36:42.323
> 
> 标签：java, web-services, rest

我对编写 Servlet 和 REST 服务还很陌生，但现在我遇到了一个问题，我不确定我是否做得正确。我的服务如下所示：

```
@POST
@Produces ("application/json")
@Path ("/register")
public String register(
    @FormParam("name") String name,
    @FormParam("username") String username,
    @FormParam("password") String password,
    @Context HttpServletResponse servletResponse) throws IOException {

    if( this.user_taken(username) ) return "USERNAME_TAKEN";
    User user = new User(name,username,password);

    .....

    return mapper.writeValueAsString(user);

} 
```

因此，正如您所看到的，`Service`负责后端（数据库和创建用户），`Servlet`另一方面负责从表单获取请求，正确验证并将其传递给`Service`. 小服务程序代码：

```
... validate user input form ...

ClientConfig config = new DefaultClientConfig();
Client client = Client.create(config);
WebResource service = client.resource("http://localhost/Jaba");

String map = mapper.writeValueAsString(request.getParameterMap());
MultivaluedMap<String, String> obj = mapper.readValue(map, MultivaluedMap.class);

String result = 
    service.path("api").path("register")
        .accept("application/json")
        .post(String.class, obj); 
```

如您所见，客户端（Servlet）必须做很多令人讨厌的工作，才能将数据传递给服务。如何更改/改进/优化或更好地重构？我正在尝试遵循最佳实践以及在现实生活中的例子。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-19T21:46:54.110

这是我可能会做的：

而不是做

```
String result = 
    service.path("api").path("register")
        .accept("application/json")
        .post(String.class, obj); 
```

我会做一些更像是创建一个 DTO 对象、填写它然后将其传递给您的服务的事情。这就是您将在客户端调用上应用一个方面以及 JSR 验证和注释（您可以对您拥有的东西执行此操作，但它不会那么好）。

例子：

```
@Aspect
public class DtoValidator {

    private Validator validator;

    public DtoValidator() {
    }

    public DtoValidator(Validator validator) {
        this.validator = validator;
    }

    public void doValidation(JoinPoint jp){
        for( Object arg : jp.getArgs() ){
            if (arg != null) {
                Set<ConstraintViolation<Object>> violations = validator.validate(arg);
                if( violations.size() > 0 ){
                    throw buildError(violations);
                }
            }
        }
    }

    private static BadRequestException buildError( Set<ConstraintViolation<Object>> violations ){
        Map<String, String> errorMap = new HashMap<String, String>();
        for( ConstraintViolation error : violations ){
            errorMap.put(error.getPropertyPath().toString(), error.getMessage());
        }
        return new BadRequestException(errorMap);
    }
} 
```

您可以注释性地声明您的方面，也可以在配置中进行（使其可重用）。像这样：

```
<aop:config proxy-target-class="true">
    <aop:aspect id="dtoValidator" ref="dtoValidator" order="10">
        <aop:before method="doValidation" pointcut="execution(public * com.mycompany.client.*.*(..))"/>
    </aop:aspect>
</aop:config> 
```

现在您可以拥有这样的 DTO：

```
@XmlAccessorType(XmlAccessType.FIELD)
@XmlRootElement
public class LoginRequest extends AbstractDto{

    @NotNull
    private String userName;

    @NotNull
    private String password;

    private LoginRequest() {
    }

    public LoginRequest(String userName, String password) {
        this.userName = userName;
        this.password = password;
    }

    public String getUserName() {
        return userName;
    }

    public String getPassword() {
        return password;
    }

} 
```

当它未能通过这些`@NotNull`检查时，您将得到如下信息：

```
{
   "message":"{username=must not be null",
   "httpStatusCode":400,
   "httpMessage":"Bad Request",
   "details":{
      "username":"must not be null"
   }
} 
```

然后使用 RestOperation 客户端

```
org.springframework.web.client.RestOperations restClient ...
restClient.postForObject(URL,new Dto(...),args); 
```

把方面放在这个周围`restClient`，你就是黄金（而且，实际上，在你的服务调用上也是如此）。

# c++ - 类模板中没有成员函数声明

> ID：16115097
> 
> 赞同：0
> 
> 时间：2013-04-20T00:00:14.670
> 
> 标签：c++, templates, c++11, g++, syntax-error

我有一个名为的模板类`SkipList`和一个在其中命名的嵌套类`Iterator`。

`SkipList`遵循以下定义：

```
template <typename Key_T, typename Mapped_T, size_t MaxLevel = 5>
class SkipList
{
  typedef std::pair<Key_T, Mapped_T> ValueType;

public:

  class Iterator
  {
      Iterator (const Iterator &);
      Iterator &operator=(const Iterator &);
      Iterator &operator++();
      Iterator operator++(int);
      Iterator &operator--();
      Iterator operator--(int);

    private:
      //some members
  }; 
```

`Iterator`有一个复制构造函数，我在它的定义之后在类之外声明它，如下所示：

```
template <typename Key_T, typename Mapped_T,size_t MaxLevel>
SkipList<Key_T,Mapped_T,MaxLevel>::Iterator(const SkipList<Key_T,Mapped_T,MaxLevel>::Iterator &that) 
```

但我收到以下错误：

```
SkipList.cpp:134:100: error: ISO C++ forbids declaration of ‘Iterator’ with no type [-fpermissive]
SkipList.cpp:134:100: error: no ‘int SkipList<Key_T, Mapped_T, MaxLevel>::Iterator(const SkipList<Key_T, Mapped_T, MaxLevel>::Iterator&)’ member function declared in class ‘SkipList<Key_T, Mapped_T, MaxLevel>’ 
```

怎么了？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-20T00:06:13.487

试试这个：

```
template <typename Key_T, typename Mapped_T,size_t MaxLevel>
SkipList<Key_T,Mapped_T,MaxLevel>::Iterator::Iterator
   (const SkipList<Key_T,Mapped_T,MaxLevel>::Iterator &that) { ... 
```

您忘记用 来限定 Iterator 复制构造函数`SkipList::Iterator::Iterator`，因此它正在寻找一个名为 的 SkipList 成员函数`SkipList::Iterator`，因此出现错误“无成员函数”。

# r - 预测新数据的 LDA 主题

> ID：16115102
> 
> 赞同：21
> 
> 时间：2013-04-20T00:01:58.400
> 
> 标签：r, lda, topic-modeling

看起来这个问题之前可能已经被问过几次（[这里](https://stackoverflow.com/questions/10483349/topic-modeling-how-do-i-use-my-fitted-lda-model-to-predict-new-topics-for-a-new) [和这里](https://stackoverflow.com/questions/14875493/lda-with-topicmodels-how-can-i-see-which-topics-different-documents-belong-to?rq=1)），但还没有回答。如评论所示，我希望这是由于先前所问问题的模棱两可。如果我再次提出类似问题而违反协议，我深表歉意，我只是假设这些问题不会看到任何新答案。

无论如何，我是潜在狄利克雷分配的新手，并且正在探索将其用作文本数据降维的一种手段。最终，我想从一个非常大的词袋中提取一组较小的主题，并使用这些主题作为模型中的几个变量来构建一个分类模型。我已经成功地在训练集上运行 LDA，但我遇到的问题是能够预测哪些相同的主题出现在其他一些测试数据集中。我现在正在使用 R 的 topicmodels 包，但如果有其他方法可以使用其他包，我也对此持开放态度。

这是我正在尝试做的一个例子：

```
library(topicmodels)
data(AssociatedPress)

train <- AssociatedPress[1:100]
test <- AssociatedPress[101:150]

train.lda <- LDA(train,5)
topics(train.lda)

#how can I predict the most likely topic(s) from "train.lda" for each document in "test"? 
```

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2013-04-20T12:44:25.967

在 Ben 出色的文档阅读技巧的帮助下，我相信使用后验 () 函数可以做到这一点。

```
library(topicmodels)
data(AssociatedPress)

train <- AssociatedPress[1:100]
test <- AssociatedPress[101:150]

train.lda <- LDA(train,5)
(train.topics <- topics(train.lda))
#  [1] 4 5 5 1 2 3 1 2 1 2 1 3 2 3 3 2 2 5 3 4 5 3 1 2 3 1 4 4 2 5 3 2 4 5 1 5 4 3 1 3 4 3 2 1 4 2 4 3 1 2 4 3 1 1 4 4 5
# [58] 3 5 3 3 5 3 2 3 4 4 3 4 5 1 2 3 4 3 5 5 3 1 2 5 5 3 1 4 2 3 1 3 2 5 4 5 5 1 1 1 4 4 3

test.topics <- posterior(train.lda,test)
(test.topics <- apply(test.topics$topics, 1, which.max))
#  [1] 3 5 5 5 2 4 5 4 2 2 3 1 3 3 2 4 3 1 5 3 5 3 1 2 2 3 4 1 2 2 4 4 3 3 5 5 5 2 2 5 2 3 2 3 3 5 5 1 2 2 
```

# javascript - AngularJS - 对 Facebook API 的异步调用

> ID：16115105
> 
> 赞同：2
> 
> 时间：2013-04-20T00:02:29.457
> 
> 标签：javascript, angularjs

我正在尝试使用 AngularJS 调用 Facebook API。

问题是来自 FB API 的所有调用都是异步的，所以我需要知道我在 facebook 上的查询何时可以在 agularjs 中使用。

为此，我在控制器中调用此方法：

`Facebook.getLoginStatus();`

哪个 Facebook 是我的服务，定义为：

> app.factory('Facebook', function() {
> 
> ```
>  getLoginStatus: function() {
> 
>         FB.getLoginStatus(function(stsResp) {
>             console.log(stsResp);
>             if(stsResp.authResponse) {
>                 // User is already logged in
>                 return true;
>             } else {
>                 // User is not logged in.
>                 return false;
>             }
>         });
>     } 
> ```
> 
> }

在这种情况下，我想要检查用户是否已登录。如果为真，我将显示一些选项，否则，我将显示登录按钮。

我已经尝试使用 $q.defer() 函数、承诺、工厂来观察响应数据，一切。但是任何事情都可以按我的意愿进行。我检查了一些基于[Egghead.io](http://www.egghead.io/)示例的开发示例，但我认为我并不完全理解 angularjs 中的异步调用。

提前致谢。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-04-20T05:37:37.937

这是将 Facebook API 包装在 Angular 服务中的完整基本工作示例：

[http://plnkr.co/edit/0GRLdWPJOzGFY14irxLT?p=preview](http://plnkr.co/edit/0GRLdWPJOzGFY14irxLT?p=preview)

另请参阅我对这个问题的回答（其中有一些 Angular-FB 集成的部分示例）：

[AngularJS：在哪里使用承诺？](https://stackoverflow.com/questions/15604196/promises-in-angularjs-and-where-to-use-them/)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2014-05-09T08:06:43.523

如果您想让所有 fb 代码的风格稍微有点棱角分明，请考虑做一些事情，比如将 FB 类封装在提供程序中。FB 是一个罕见的例子，提供者模式实际上很好用（在配置部分设置你的应用程序 ID）。

这是一个 Angular facebook 提供程序的示例，它具有基本的登录功能和用于进行图形 api 调用的通用方法：

```
app.provider('facebook', function() {
  var fbReady = false
  this.appID = 'Default';

  function fbInit(appID) {
    (function(d, s, id) {
      var js, fjs = d.getElementsByTagName(s)[0];
      if (d.getElementById(id)) return;
      js = d.createElement(s); js.id = id;
      js.src = "//connect.facebook.net/en_US/sdk.js";
      fjs.parentNode.insertBefore(js, fjs);
    }(document, 'script', 'facebook-jssdk'));  
    window.fbAsyncInit = function() {
     FB.init({
      appId      : appID,
      cookie     : true,  
      xfbml      : true,  
      version    : 'v2.0' 
    });
     fbReady = true;
   }   
 }

 this.setAppID = function(appID) {
  this.appID = appID;
};

this.$get = function() {
  var appID = this.appID;
  var self = this;
  fbInit(appID);

  return {
    graph : function(path, cb) {
      FB.api(path, function(response) {
        cb(response);
      });
    },
    getAuth: function() {
      return self.auth;
    },
    getLoginStatus: function(cb) {
      if (!fbReady) {
        setTimeout(function() { 
          self.$get()['getLoginStatus'](cb);
        } , 100);
        console.log('fb not ready');
        return;
      }
      FB.getLoginStatus(function(response) {
        cb(response);
      });
    },
    login: function(cb) {
      if (!fbReady) {
        self.$get()['login'](cb);
        console.log('fb not ready');
        return;
      }
      FB.login(function(response) {
        if (response.authResponse) {
          self.auth = response.authResponse;
          cb(self.auth);
        } else {
          console.log('Facebook login failed', response);
        }
      }, {"scope" : "manage_notifications"});

    },
    logout: function() {
      FB.logout(function(response) {
        if (response) {
          self.auth = null;
        } else {
          console.log('Facebook logout failed.', response);
        }

      });
    }
  }
}
}); 
```

稍后当您想使用它时，只需在配置部分设置您的应用程序 ID：

```
app.config(function(facebookProvider){
 facebookProvider.setAppID('<your_app_id>');
}) 
```

将其注入控制器：

```
.controller('MainCtrl', function ($scope, facebook) { 
```

然后在控制器/运行部分执行一些调用：

```
facebook.graph('/me/notifications', onNotificationsGotten); 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-08-18T17:02:26.593

我编写了这个模块 angularjs-facebook 作为提供者，这样在配置中您可以配置您的应用程序 ID，然后您可以使用 facebook 异步调用。还有一些方法可以监听控制器。

[https://github.com/ciul/angularjs-facebook](https://github.com/ciul/angularjs-facebook)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-10-22T00:20:39.797

这是使用 iTunes API 发出异步 http 请求的一个很好的例子。它也应该可以帮助您弄清楚如何使用 Facebook API 来实现。

[Angular JS 中的异步 HTTP 请求](http://blog.jpamorgan.com/searching-the-itunes-api-asynchronously-with-angular-js/)

# android - android 上的 Google Drive 错误：java.lang.IllegalArgumentException：名称不能为空：null

> ID：16115109
> 
> 赞同：9
> 
> 时间：2013-04-20T00:02:44.763
> 
> 标签：android, google-drive-api, illegalargumentexception

我在 Google Drive Android 应用程序上遇到了“java.lang.IllegalArgumentException：名称不能为空：null”异常。

我已经在谷歌上搜索了几天没有得到任何线索。这是我在 Google Drive 上获取文件列表的代码（一个简单的示例）：（取自此处：[Google Drive SDK Exception](https://stackoverflow.com/questions/13462952/google-drive-sdk-exception)）

```
import java.io.IOException;
import java.util.ArrayList;

import android.accounts.Account;
import android.accounts.AccountManager;
import android.app.Activity;
import android.app.ProgressDialog;
import android.content.Context;
import android.content.DialogInterface;
import android.content.Intent;
import android.os.AsyncTask;
import android.os.Bundle;
import android.util.Log;
import android.view.View;
import android.widget.Button;

import com.google.android.gms.auth.GoogleAuthException;
import com.google.android.gms.auth.GoogleAuthUtil;
import com.google.android.gms.auth.UserRecoverableAuthException;
import com.google.android.gms.common.AccountPicker;
import com.google.api.client.auth.oauth2.BearerToken;
import com.google.api.client.auth.oauth2.Credential;
import com.google.api.client.extensions.android.http.AndroidHttp;
import     com.google.api.client.googleapis.extensions.android.accounts.GoogleAccountManager;
import com.google.api.client.googleapis.extensions.android.gms.auth.GoogleAccountCredential;
import com.google.api.client.http.HttpRequestFactory;
import com.google.api.client.http.HttpTransport;
import com.google.api.client.http.json.JsonHttpRequest;
import com.google.api.client.http.json.JsonHttpRequestInitializer;
import com.google.api.client.json.jackson.JacksonFactory;
import com.google.api.services.drive.Drive;
import com.google.api.services.drive.Drive.Files;
import com.google.api.services.drive.DriveRequest;
import com.google.api.services.drive.DriveScopes;
import com.google.api.services.drive.model.File;
import com.google.api.services.drive.model.FileList;
import com.maiko.xscanpet.R;
import com.maiko.xscanpet.cloud.GDriveHelper;

public class Fool_5 extends Activity {
private static final int CHOOSE_ACCOUNT=0;
private static String accountName;
private static int REQUEST_TOKEN=0;
private Button btn_drive;
private Context ctx = this;
private Activity a = this;

GoogleAccountCredential mCredential= null;

public void onCreate(Bundle savedInstanceState) {

    super.onCreate(savedInstanceState);
    // set up the GUI layout
    setContentView(R.layout.fool_5);
    // set the variables to access the GUI controls
    btn_drive = (Button) findViewById(R.id.btn_drive);
        btn_drive.setOnClickListener(new View.OnClickListener() {
        public void onClick(View v) {
            chooseAccount();
        }
        });
}

public void chooseAccount() {
    Intent intent = AccountPicker.newChooseAccountIntent(null, null, new String[]{"com.google"}, false, null, null, null, null);
    startActivityForResult(intent, CHOOSE_ACCOUNT);
}

// Fetch the access token asynchronously.
void getAndUseAuthTokenInAsyncTask(Account account) {
    AsyncTask<Account, String, String> task = new AsyncTask<Account, String, String>() {
        ProgressDialog progressDlg;
        AsyncTask<Account, String, String> me = this;

        @Override
        protected void onPreExecute() {
            progressDlg = new ProgressDialog(ctx, ProgressDialog.STYLE_SPINNER);
            progressDlg.setMax(100);
            progressDlg.setTitle("Validating...");
            progressDlg.setMessage("Verifying the login data you entered...\n\nThis action will time out after 10 seconds.");
            progressDlg.setCancelable(false);
            progressDlg.setIndeterminate(false);
            progressDlg.setOnCancelListener(new android.content.DialogInterface.OnCancelListener() {
                public void onCancel(DialogInterface d) {
                    progressDlg.dismiss();
                    me.cancel(true);
                }
            });
            progressDlg.show();
        }

        @Override
        protected String doInBackground(Account... params) {
            return getAccessToken(params[0]);
        }

        @Override
        protected void onPostExecute(String s) {
            if (s == null) {
                // Wait for the extra intent
            } else {
                accountName = s;
                getDriveFiles();
            }
            progressDlg.dismiss();
        }
    };
    task.execute(account);
}

/**
 * Fetches the token from a particular Google account chosen by the user.  DO NOT RUN THIS DIRECTLY.  It must be run asynchronously inside an AsyncTask.
 * @param activity
 * @param account
 * @return
 */
private String getAccessToken(Account account) {
    try {
        return GoogleAuthUtil.getToken(ctx, account.name, "oauth2:" + DriveScopes.DRIVE);  // IMPORTANT: DriveScopes must be changed depending on what level of access you want
    } catch (UserRecoverableAuthException e) {
        // Start the Approval Screen intent, if not run from an Activity, add the Intent.FLAG_ACTIVITY_NEW_TASK flag.
        a.startActivityForResult(e.getIntent(), REQUEST_TOKEN);
        e.printStackTrace();
        return null;
    } catch (GoogleAuthException e) {
        e.printStackTrace();
        return null;
    } catch (IOException e) {
        e.printStackTrace();
        return null;
    }
}

private Drive getDriveService() {
    mCredential = GoogleAccountCredential.usingOAuth2(this, DriveScopes.DRIVE);
    mCredential.setSelectedAccountName(accountName);
    return GDriveHelper.getDriveService(mCredential,getResources().getString(R.string.app_name));

}

/**
 * Obtains a list of all files on the signed-in user's Google Drive account.
 */
private void getDriveFiles() {
    Thread t = new Thread(new Runnable() {
        @Override
        public void run() {
            Drive service = getDriveService();
            Log.d("SiteTrack", "FUNCTION getDriveFiles()");
            Files.List request;
            try {
                request = service.files().list(); // .setQ("mimeType=\"text/plain\"");
            } catch (IOException e) {

                e.printStackTrace();
                return;
            }
            do {
                FileList files;
                try {
                    System.out.println("got here");
                    Log.d("SiteTrack", request.toString());
                    //mCredential.setSelectedAccountName(accountName);
                    files = request.execute();

                } catch (IOException e) {
                    e.printStackTrace();
                    Log.d("SiteTrack", "Exception");
                    return;
                }
                ArrayList<File> fileList = (ArrayList<File>) files.getItems();
                Log.d("SiteTrack", "Files found: " + files.getItems().size());
                for (File f : fileList) {
                    String fileId = f.getId();
                    String title = f.getTitle();
                    Log.d("SiteTrack", "File " + fileId + ": " + title);
                }
                request.setPageToken(files.getNextPageToken());
            } while (request.getPageToken() != null && request.getPageToken().length() >= 0);
        }
    });
    t.start();

}

protected void onActivityResult(final int requestCode, final int resultCode, final Intent data) {
    if (requestCode == CHOOSE_ACCOUNT && resultCode == RESULT_OK) {
        accountName = data.getStringExtra(AccountManager.KEY_ACCOUNT_NAME);
        GoogleAccountManager gam = new GoogleAccountManager(this);
        getAndUseAuthTokenInAsyncTask(gam.getAccountByName(accountName));
        Log.d("SiteTrack", "CHOOSE_ACCOUNT");
    } else if (requestCode == REQUEST_TOKEN && resultCode == RESULT_OK) {
        accountName = data.getStringExtra(AccountManager.KEY_ACCOUNT_NAME);
        Log.d("SiteTrack", "REQUEST_TOKEN");
    }
}   
} 
```

这会在 files = request.execute(); 上生成 this 跟踪 或任何 request.execute()：

```
04-20 01:40:26.105: E/AndroidRuntime(27203): FATAL EXCEPTION: Thread-39033
04-20 01:40:26.105: E/AndroidRuntime(27203): java.lang.IllegalArgumentException: the name must not be empty: null
04-20 01:40:26.105: E/AndroidRuntime(27203):    at android.os.Parcel.readException(Parcel.java:1429)
04-20 01:40:26.105: E/AndroidRuntime(27203):    at android.os.Parcel.readException(Parcel.java:1379)
04-20 01:40:26.105: E/AndroidRuntime(27203):    at com.google.android.gms.internal.x$a$a.a(Unknown Source)
04-20 01:40:26.105: E/AndroidRuntime(27203):    at com.google.android.gms.auth.GoogleAuthUtil.getToken(Unknown Source)
04-20 01:40:26.105: E/AndroidRuntime(27203):    at com.google.android.gms.auth.GoogleAuthUtil.getToken(Unknown Source)
04-20 01:40:26.105: E/AndroidRuntime(27203):    at com.google.api.client.googleapis.extensions.android.gms.auth.GoogleAccountCredential.getToken(GoogleAccountCredential.java:192)
04-20 01:40:26.105: E/AndroidRuntime(27203):    at com.google.api.client.googleapis.extensions.android.gms.auth.GoogleAccountCredential$RequestHandler.intercept(GoogleAccountCredential.java:217)
04-20 01:40:26.105: E/AndroidRuntime(27203):    at com.google.api.client.http.HttpRequest.execute(HttpRequest.java:888)
04-20 01:40:26.105: E/AndroidRuntime(27203):    at com.google.api.client.googleapis.services.AbstractGoogleClientRequest.executeUnparsed(AbstractGoogleClientRequest.java:407)
04-20 01:40:26.105: E/AndroidRuntime(27203):    at com.google.api.client.googleapis.services.AbstractGoogleClientRequest.executeUnparsed(AbstractGoogleClientRequest.java:340)
04-20 01:40:26.105: E/AndroidRuntime(27203):    at com.google.api.client.googleapis.services.AbstractGoogleClientRequest.execute(AbstractGoogleClientRequest.java:458)
04-20 01:40:26.105: E/AndroidRuntime(27203):    at com.maiko.fool.Fool_5$3.run(Fool_5.java:184)
04-20 01:40:26.105: E/AndroidRuntime(27203):    at java.lang.Thread.run(Thread.java:856) 
```

我对此感到迷茫，不知道可能出了什么问题。我遵循了有关配置 Google API 服务的本教程：https: [//plus.google.com/u/0/114042449736049687152/posts/CD3L8zcJg5Z](https://plus.google.com/u/0/114042449736049687152/posts/CD3L8zcJg5Z)

谢谢您的帮助。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-27T13:46:21.570

验证您传递给“mCredential”对象的 var“accountName”。通常这就是这些错误的原因。问候。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2017-01-06T17:50:06.323

对于面临同样问题的其他人，

尝试 credential.setAccount() 而不是 credential.setAccountName();

因为有时需要的帐户对象中有一个额外的“类型”参数。对于存储，您可以执行以下操作：（伪代码）

```
GoogleSignInAccount account = initAccount();
Account acct = account.getAccount();
storeStringInPrefs("NAME" , acct.name);
storeStringInPrefs("TYPE" , acct.type); 
```

然后进行检索

```
GoogleAccountCredential credential = GoogleAccountCredential.usingOauth(...);
String name = getPrefs("NAME");
String type = getPrefs("TYPE");
credential.setSelectedAccount(new Account(name , type)); 
```

现在它应该可以工作了：D，这只是您基本理解的伪代码，如果复制到您的项目中将不起作用。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2019-10-31T07:52:18.913

只需添加`.requestEmail()`到签名选项：

```
GoogleSignInOptions.Builder options =
                            new GoogleSignInOptions.Builder(GoogleSignInOptions.DEFAULT_SIGN_IN)
                                    .requestEmail()
                                    .requestScopes(new Scope(DriveScopes.DRIVE_APPDATA)); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2015-03-14T14:52:05.877

`@gmail.com`当用户名中缺少时，我得到了这个。认为它是可选的，因为它在大多数 Google 表单中......

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2016-12-20T11:43:01.823

请确保已启用**READ_CONTACTS**权限。由于许可，我在使用 Youtube Data API v3 时遇到了同样的错误。

# c# - 在列表中搜索数组或列表

> ID：16115112
> 
> 赞同：6
> 
> 时间：2013-04-20T00:03:29.850
> 
> 标签：c#, .net, linq, list

有

```
List<byte> lbyte 
```

有

```
byte[] searchBytes 
```

如何搜索 lbyte 不仅是单个字节，而且是 searchBytes 的索引？
例如

```
Int32 index = lbyte.FirstIndexOf(searchBytes); 
```

这是我想出的蛮力。
不是我正在寻找的性能。

```
public static Int32 ListIndexOfArray(List<byte> lb, byte[] sbs)
{
    if (sbs == null) return -1;
    if (sbs.Length == 0) return -1;
    if (sbs.Length > 8) return -1;
    if (sbs.Length == 1) return lb.FirstOrDefault(x => x == sbs[0]);
    Int32 sbsLen = sbs.Length;
    Int32 sbsCurMatch = 0;
    for (int i = 0; i < lb.Count; i++)
    {
        if (lb[i] == sbs[sbsCurMatch])
        {
            sbsCurMatch++;
            if (sbsCurMatch == sbsLen)
            {
                //int index = lb.FindIndex(e => sbs.All(f => f.Equals(e)));  // fails to find a match
                IndexOfArray = i - sbsLen + 1;
                return;
            }
        }
        else 
        {
            sbsCurMatch = 0;
        }
    }
    return -1;
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-20T00:16:49.683

蛮力总是一种选择。尽管与其他一些方法相比速度较慢，但​​在实践中通常并不算太糟糕。`lbyte`如果不是很大并且没有病理数据，它很容易实现并且完全可以接受。

[这与蛮力字符串搜索](http://www.stoimen.com/blog/2012/03/27/computer-algorithms-brute-force-string-matching/)的概念相同。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-20T00:24:23.910

您可能会发现[Boyer-Moore 算法](http://en.wikipedia.org/wiki/Boyer%E2%80%93Moore_string_search_algorithm)在这里很有用。将您的列表转换为数组并搜索。算法代码取自[这篇文章](https://stackoverflow.com/a/9890164/187697)。

```
static int SimpleBoyerMooreSearch(byte[] haystack, byte[] needle)
{
    int[] lookup = new int[256];
    for (int i = 0; i < lookup.Length; i++) { lookup[i] = needle.Length; }

    for (int i = 0; i < needle.Length; i++)
    {
        lookup[needle[i]] = needle.Length - i - 1;
    }

    int index = needle.Length - 1;
    var lastByte = needle.Last();
    while (index < haystack.Length)
    {
        var checkByte = haystack[index];
        if (haystack[index] == lastByte)
        {
            bool found = true;
            for (int j = needle.Length - 2; j >= 0; j--)
            {
                if (haystack[index - needle.Length + j + 1] != needle[j])
                {
                    found = false;
                    break;
                }
            }

            if (found)
                return index - needle.Length + 1;
            else
                index++;
        }
        else
        {
            index += lookup[checkByte];
        }
    }
    return -1;
} 
```

然后你可以像这样搜索。如果`lbyte`在一定时间后保持不变，您只需将其转换为数组并传递它。

```
//index is returned, or -1 if 'searchBytes' is not found
int startIndex = SimpleBoyerMooreSearch(lbyte.ToArray(), searchBytes); 
```

根据评论更新。这是`IList`实现，这意味着数组和列表（以及`IList`可以传递的任何其他实现）

```
 static int SimpleBoyerMooreSearch(IList<byte> haystack, IList<byte> needle)
 {
    int[] lookup = new int[256];
    for (int i = 0; i < lookup.Length; i++) { lookup[i] = needle.Count; }

    for (int i = 0; i < needle.Count; i++)
    {
        lookup[needle[i]] = needle.Count - i - 1;
    }

    int index = needle.Count - 1;
    var lastByte = needle[index];
    while (index < haystack.Count)
    {
        var checkByte = haystack[index];
        if (haystack[index] == lastByte)
        {
            bool found = true;
            for (int j = needle.Count - 2; j >= 0; j--)
            {
                if (haystack[index - needle.Count + j + 1] != needle[j])
                {
                    found = false;
                    break;
                }
            }

            if (found)
                return index - needle.Count + 1;
            else
                index++;
        }
        else
        {
            index += lookup[checkByte];
        }
    }
    return -1;
} 
```

由于数组和列表实现了 IList，因此在您的情况下调用它时无需进行转换。

```
int startIndex = SimpleBoyerMooreSearch(lbyte, searchBytes); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-20T00:39:00.223

您可以使用 lambda 表达式的另一种方法

```
int index = lbyte.FindIndex(e => searchBytes.All(i => i.Equals(e)); 
```

# jquery - jQuery addClass 到父级和它的兄弟姐妹

> ID：16115115
> 
> 赞同：1
> 
> 时间：2013-04-20T00:03:38.523
> 
> 标签：jquery, css, addclass

我正在尝试将一个类应用于元素的父级和兄弟级。到目前为止，我只通过应用两行 jQuery 取得了成功，这使得最终结果应用在两个阶段，看起来非常难看。

```
<style type="text/css">
td.rostered {
    opacity: 0.3;
}
</style>

<table>
<tr class="flight_search">
    <td class="" style="width: 6%; text-align: left"><img id="525" class="roster" src="images/link_image.png" alt="Link Image"></td>
    <td class="" style="width: 7%">Option 1</td>
    <td class="" style="width: 24%">London -<strong>Paris</strong></td>
    <td class="" style="width: 25%">Dep: <strong>0355</strong>  Arr: 0615 (02:20)</td>
    <td class="" style="width: 30%">Boeing 767</td>
    <td class="" style="width: 8%"><a class="rego" href="#">ABCDE</a></td>
</tr>
</table> 
```

当用户单击图像（id="525"）时，一些 ajax 运行以将该航班分配给用户的名册。然后它返回 id 以运行一些 jQuery 以使表格的该行变灰，表明它已经被花名册。

```
function set_rostered(id) {
//This line adds the class 'rostered' the siblins of the <td>
$("#" + id).parent().siblings().addClass('rostered');
//This line removes the id so the flight cannot be rostered again and adds the class to the parent <td> itself.
$("#" + id).attr('id', '').parent().addClass('rostered');
} 
```

有没有办法可以结合这两行代码使该类同时应用于所有元素（父元素和它的兄弟元素）？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-20T00:06:10.797

尝试将其添加回来（使用 addBack() 函数）：

```
$("#" + id).parent().siblings().addBack().addClass('rostered'); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-20T00:56:36.400

$("#" + id).attr('id', '').parent().parent().children().addClass('rostered');

# python - 当向 Tkinter 输入框的 show 参数提供回调时，数字 4 的意义是什么？

> ID：16115121
> 
> 赞同：4
> 
> 时间：2013-04-20T00:04:48.947
> 
> 标签：python, tkinter, tkinter-entry

**问题**

为什么我的随机 ascii 字符选择器函数*会输出四，数字四在这种情况下的意义是什么？为什么我没有收到错误消息？*

请记住，问题**不**在于如何解决问题，而在于为什么输出该特定数字。

**背景和代码**

我正在尝试创建一个基本的电子邮件客户端。我认为让我的密码框显示随机字符而不是明显的 *. 因此，我创建了一个选择随机 ascii 字母的函数。

```
import random
import string

def random_char():

    char_select = random.randrange(52)

    char_choice = string.ascii_letters[char_select]

    return char_choice 
```

当我在交互式终端中运行它时，它会随机输出一个字母。但是，当我通过我的小部件运行它时

```
self.Password = Entry (self, show = lambda: random_char()) 
```

我遇到了一堆四人组。

**额外学分**

如果您有时间，请访问我的相关问题，[如何让 Tkinter 输入框在每次输入字符时重复一个功能？](https://stackoverflow.com/q/16111544/1993598)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-20T00:32:11.573

show 参数接受一个值而不是回调。Tkinter 正在获取您的回调对象并尝试将其转换为字符串，这就是您在“输入”框中键入时得到的结果。

相反，您可以在键入后使用绑定重新配置您的条目：

```
def key(event):
    entry.configure(show = random_char())

entry = tk.Entry (self)
entry.pack()
entry.bind("<Key>", key) 
```

**编辑**

Bryan Oakley 是正确的，因为这将在您键入时将所有字符更改为相同的单个随机字符。在您键入时显示不同的随机字符不是您应该使用 Entry 小部件的方式。您可以尝试以下方法：

```
def key(event):
    global real_password
    global garbage
    current_len = len(v.get())
    if event.char and event.char in string.ascii_letters:
        real_password += event.char
        garbage += random_char()
    garbage = garbage[:current_len]
    v.set(garbage)

v = tk.StringVar()
real_password = ""
garbage = ""
entry = tk.Entry (self, textvariable = v)
entry.pack()
entry.bind("<KeyRelease>", key) 
```

当然有很多限制，最后输入的字符在释放键时改变，而不是在按下时改变，所以你必须快速输入:)，无法控制光标移动键等。但无论如何尝试很有趣.

# c++ - 改进makefile以查看子目录

> ID：16115122
> 
> 赞同：0
> 
> 时间：2013-04-20T00:05:00.620
> 
> 标签：c++, makefile

前段时间，我需要创建一个 makefile 来处理我正在制作的许多小型测试项目。整个范围是简单地编译其目录中的所有 .cpp 文件，并整理出目标文件和依赖项。然而，其中一个项目最终增长得足够多，以至于我需要创建自定义子文件夹来保持所有代码的组织性。

问题是我对makefile了解不多，而我制作的文件是由我在互联网上找到的零碎组成的。我想知道如何修改此代码以包含来自不同文件夹的文件。我现在拥有的是这样的：

```
SHELL=/bin/bash
CC=g++
EXECUTABLE=ruletheskies

CFLAGS=-std=c++0x -Wall -pedantic #-I/usr/include/boost_1_51_0/
LDFLAGS=-L./
LIBRARIES=-ljson_linux-gcc-4.6_libmt -lbprinter
WINLIBRARIES=-ljson_mingw_libmt -lbprinter_mingw

WINDEFINES=-DWINVER=0x0400 -D__WIN95__ -D__GNUWIN32__ -DSTRICT -DHAVE_W32API_H -D__WXMSW__ -D__WINDOWS__
WINLDFLAGS=-I./ # $(shell find /usr/include/ -maxdepth 1 -type d | sed 's/^/-I/g') #-L/usr/lib/ -I/usr/include/
WINBASELIBRARIES=-lodbc32 -lwsock32 -lwinspool -lwinmm -lshell32 -lcomctl32 -lctl3d32 -lodbc32 -ladvapi32 -lodbc32 -lwsock32 -lopengl32 -lglu32 -lole32 -loleaut32 -luuid
WINSTATIC=-static-libstdc++ -static-libgcc
WINOPTIONS=--verbose

SOURCES := $(wildcard *.cpp)
HEADERS := $(wildcard *.h)

OBJECTSFOLDER=objects
OBJECTS=$(addprefix $(OBJECTSFOLDER)/, $(SOURCES:.cpp=.o))

DEPFOLDER=dependencies
df=$(DEPFOLDER)/$(*F)
odf=$(OBJECTSFOLDER)/$(*F)

EXEFOLDER=bin

.PHONY : all
# Brute force compiling statement for simple compilation and no .o residual files
all: $(EXEFOLDER)
    $(CC) $(CFLAGS) $(LDFLAGS) *.cpp $(LIBRARIES) -o $(EXEFOLDER)/$(EXECUTABLE)

.PHONY: debug
# Compiles using object files in OBJECTSFOLDER, only modified stuff
debug: folders $(SOURCES) $(EXEFOLDER)/$(EXECUTABLE)

.PHONY: windows
# cross-compilation: mingw has to be selected, adds libraries for windows, brute force
windows: $(EXEFOLDER)
    $(CC) $(CFLAGS) $(WINDEFINES) $(WINSTATIC) $(LDFLAGS) $(WINLDFLAGS) *.cpp $(LIBRARIES) $(WINLIBRARIES) $(WINBASELIBRARIES) -o $(EXEFOLDER)/$(EXECUTABLE).exe $(WINOPTIONS)

# Final linking of the executable
$(EXEFOLDER)/$(EXECUTABLE): $(OBJECTS) 
    $(CC) $(LDFLAGS) $(OBJECTS) $(LIBRARIES) -o $@

# Creation of object files
# ( Actual compilation is only last instruction, the rest is creating dependency header rules )
$(OBJECTSFOLDER)/%.o: %.cpp
    @$(CC) -MMD -c $(CFLAGS) -o $@ $<
    @cp $(odf).d $(df).P; \
        sed -e 's/#.*//' -e 's/^[^:]*: *//' -e 's/ *\\$$//' \
            -e '/^$$/ d' -e 's/$$/ :/' < $(odf).d >> $(df).P; \
    rm -f $(odf).d
    $(CC) -c $(CFLAGS) $< -o $@

-include $(DEPFOLDER)/*.P

# Creation of folders
.PHONY : folders
folders: $(OBJECTSFOLDER) $(DEPFOLDER) $(EXEFOLDER)
$(OBJECTSFOLDER):
    mkdir $@
$(DEPFOLDER):
    mkdir $@
$(EXEFOLDER):
    mkdir $@

# Cleanup of object files
# ( .PHONY is to avoid calling the rule in case a file named clean exists )
.PHONY : clean
clean:
    rm -rf $(OBJECTSFOLDER)
    rm -rf $(DEPFOLDER) 
```

我想我将不得不修改该`SOURCES := $(wildcard *.cpp)`行，但是我将如何包含我必须查看的子目录，无论它们是什么？如果这样可以简化事情，我打算将相应的头文件和源文件放在一起。

# django - 如何动态指定 django ModelAdmin 类的“list_display”属性？

> ID：16115124
> 
> 赞同：13
> 
> 时间：2013-04-20T00:05:09.890
> 
> 标签：django, django-admin

在尝试动态更改在 django 管理员的模型列表页面中显示的列时，我尝试覆盖`__init__()`我的 ModelAdmin 类的方法，以根据当前权限从 list_display 属性中动态添加或删除特定字段用户。但是，我发现 ModelAdmin 类每次重启只实例化一次，所以这不起作用......

还有另一种动态更改 list_display 字段的方法吗？

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2013-04-20T00:05:09.890

在问这个问题时，我偶然发现了答案，所以我想我会分享......

票证[#14206](https://code.djangoproject.com/ticket/14206#no1%20#14206)表明此功能已在一段时间前添加到 django（我相信是 1.4 版）。ModelAdmin 类现在支持 get_list_display() 方法：

```
def get_list_display(self, request):
    if request.user.has_perm('my_app.my_permission'):
        list_display = ('field_1', 'field_2', 'dynamic_field',)
    else:
        list_display = ('field_1', 'field_2',)
    return list_display 
```

# python - 两个简单递归函数的大 O 表示法

> ID：16115129
> 
> 赞同：8
> 
> 时间：2013-04-20T00:06:02.080
> 
> 标签：python, algorithm, math, recursion, big-o

我在 Python 中有两个递归函数，只是想知道它们的大 O 表示法。每个这些的大 O 是什么？

```
def cost(n):
    if n == 0:
        return 1
    else:
        return cost(n-1) + cost(n-1)

def cost(n):
    if n == 0:
        return 1
    else:
        return 2*cost(n-1) 
```

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2013-04-20T00:20:26.877

让我们使用递归关系来解决这个问题！第一个函数的运行时可以递归地描述为

> T(0) = 1
> 
> T(n + 1) = 2T(n) + 1

也就是说，基本情况需要一个时间单位才能完成，否则我们对问题的较小实例进行两次递归调用，并进行一些设置和清理工作。展开这个递归中的一些项，我们得到

*   T(0) = 1
*   T(1) = 2T(0) + 1 = 2 + 1 = 3
*   T(2) = 2T(1) + 1 = 2 × 3 + 1 = 7
*   T(3) = 2T(2) + 1 = 2 × 7 + 1 = 15

这个系列 1, 3, 7, 15, ... 可能看起来很熟悉，因为它是 2 ¹ - 1, 2 ² - 1, 2 ³ - 1 等。更一般地，我们可以证明

> T(n) = 2 ^(n+1) - 1

我们可以通过归纳来做到这一点。作为我们的基本情况，T(0) = 1 = 2 ¹ - 1，因此对于 n = 0 的主张成立。现在假设对于某些 n，T(n) = 2 ^(n+1) - 1。然后我们有

> T(n + 1) = 2T(n) + 1 = 2(2 ^(n+1) - 1) + 1 = 2 ^(n+2) - 2 + 1 = 2 ^(n+2) - 1

我们完成了！由于这个递归的结果是 2 ^(n+1) - 1 = 2(2 ^n ) - 1，我们有运行时间是 Θ(2 ^n )。

第二个函数的运行时可以递归地描述为

> T(0) = 1
> 
> T(n + 1) = T(n) + 1

扩展一些术语：

*   T(0) = 1
*   T(1) = T(0) + 1 = 1 + 1 = 2
*   T(2) = T(1) + 1 = 2 + 1 = 3
*   T(3) = T(2) + 1 = 3 + 1 = 4

这给出了 1, 2, 3, 4, ...，所以更一般地说，我们可能会猜测

> T(n) = n + 1

我们可以再次归纳证明这一点。作为基本情况，如果 n = 0，则 T(0) = 1 = 0 + 1。对于归纳步​​骤，假设对于某些 n，T(n) = n + 1。然后

> T(n + 1) = T(n) + 1 = n + 1 + 1 = n + 2

我们完成了！由于运行时间为 n + 1，因此运行时间为 Θ(n)。

希望这可以帮助！

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2013-04-20T03:56:55.607

**使用递归树（通过可视化图表）查找成本。**

函数cost(n)的递推关系

```
 T(n) = 2T(n-1)+c 
```

![在此处输入图像描述](https://i.stack.imgur.com/94XEy.jpg)

```
If at kth level input size become 0 (base condition where func terminates)
                                           n-k =0
                                              k=n

Total cost of the function (adding cost of each level) :
             T(n) = 2^0*c+ 2^1*c + 2^2*c + 2^3*c +.. .. . .+ 2^n * c
                  = O(2^n) 
```

类似的方法我们可以找到第二个函数的时间复杂度。

# android - 如何从 rss 提要 xml 文件中删除 html 标签。我在 Eclipse 中使用 DOM 解析器

> ID：16115142
> 
> 赞同：2
> 
> 时间：2013-04-20T00:07:35.977
> 
> 标签：android, eclipse, dom, xml-parsing, rss

我试图使用 dom 解析器获取 rss 提要，但我没有从 xml 文件中获取描述标记，因为它包含一些 html 标记。

如何解析描述标签中的文本？

# arrays - 保存和恢复陷阱状态？管理多个陷阱处理程序的简单方法？

> ID：16115144
> 
> 赞同：19
> 
> 时间：2013-04-20T00:08:44.003
> 
> 标签：arrays, bash, stack, bash-trap

什么是覆盖`bash`不会永久践踏可能已设置或尚未设置的现有陷阱处理程序的好方法？那么动态管理任意的陷阱例程链呢？

有没有办法保存陷阱处理程序的当前状态，以便以后可以恢复它们？

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2013-04-20T00:08:44.003

## 在 Bash 中保存和恢复您的陷阱处理程序状态

我将提交以下堆栈实现来跟踪和恢复陷阱状态。使用这种方法，我可以推送陷阱更改，然后在完成后将它们弹出。这也可以用于将许多陷阱例程链接在一起。

请参阅以下源文件 (.trap_stack.sh)

```
#!/bin/bash
trap_stack_name() {
  local sig=${1//[^a-zA-Z0-9]/_}
  echo "__trap_stack_$sig"
}

extract_trap() {
  echo ${@:3:$(($#-3))}
}

get_trap() {
  eval echo $(extract_trap `trap -p $1`)
}

trap_push() {
  local new_trap=$1
  shift
  local sigs=$*
  for sig in $sigs; do
    local stack_name=`trap_stack_name "$sig"`
    local old_trap=$(get_trap $sig)
    eval "${stack_name}"'[${#'"${stack_name}"'[@]}]=$old_trap'
    trap "${new_trap}" "$sig"
  done
}

trap_pop() {
  local sigs=$*
  for sig in $sigs; do
    local stack_name=`trap_stack_name "$sig"`
    local count; eval 'count=${#'"${stack_name}"'[@]}'
    [[ $count -lt 1 ]] && return 127
    local new_trap
    local ref="${stack_name}"'[${#'"${stack_name}"'[@]}-1]'
    local cmd='new_trap=${'"$ref}"; eval $cmd
    trap "${new_trap}" "$sig"
    eval "unset $ref"
  done
}

trap_prepend() {
  local new_trap=$1
  shift
  local sigs=$*
  for sig in $sigs; do
    if [[ -z $(get_trap $sig) ]]; then
      trap_push "$new_trap" "$sig"
    else
      trap_push "$new_trap ; $(get_trap $sig)" "$sig"
    fi
  done
}

trap_append() {
  local new_trap=$1
  shift
  local sigs=$*
  for sig in $sigs; do
    if [[ -z $(get_trap $sig) ]]; then
      trap_push "$new_trap" "$sig"
    else
      trap_push "$(get_trap $sig) ; $new_trap" "$sig"
    fi
  done
} 
```

这可以管理定义为命名函数的处理程序，也可以管理像此示例中定义的临时例程`trap "kill $!" SIGTERM SIGINT`。

这是我用来帮助我编写它的测试脚本：

```
#!/bin/bash
source .trap_stack.sh

initial_trap='echo "messy" ;'" echo 'handler'"
non_f_trap='echo "non-function trap"'
f_trap() {
  echo "function trap"
}

print_status() {
  echo "    SIGINT  trap: `get_trap SIGINT`"  
  echo "    SIGTERM trap: `get_trap SIGTERM`"
  echo "-------------"
  echo
}

echo "--- TEST START ---"
echo "Initial trap state (should be empty):"
print_status

echo 'Setting messy non-function handler for SIGINT ("original state")'
trap "$initial_trap" SIGINT
print_status

echo 'Pop empty stacks (still in original state)'
trap_pop SIGINT SIGTERM
print_status

echo 'Push non-function handler for SIGINT'
trap_push "$non_f_trap" SIGINT
print_status

echo 'Append function handler for SIGINT and SIGTERM'
trap_append f_trap SIGINT SIGTERM
print_status

echo 'Prepend function handler for SIGINT and SIGTERM'
trap_prepend f_trap SIGINT SIGTERM
print_status

echo 'Push non-function handler for SIGINT and SIGTERM'
trap_push "$non_f_trap" SIGINT SIGTERM
print_status

echo 'Pop both stacks'
trap_pop SIGINT SIGTERM
print_status

echo 'Prepend function handler for SIGINT and SIGTERM'
trap_prepend f_trap SIGINT SIGTERM
print_status

echo 'Pop both stacks thrice'
trap_pop SIGINT SIGTERM
trap_pop SIGINT SIGTERM
trap_pop SIGINT SIGTERM
print_status

echo 'Push non-function handler for SIGTERM'
trap_push "$non_f_trap" SIGTERM
print_status

echo 'Pop handler state for SIGINT (SIGINT is now back to original state)'
trap_pop SIGINT
print_status

echo 'Pop handler state for SIGTERM (SIGTERM is now back to original state)'
trap_pop SIGTERM
print_status 
```

# android - onUtteranceCompleted 方法中的意图不起作用

> ID：16115146
> 
> 赞同：0
> 
> 时间：2013-04-20T00:08:48.313
> 
> 标签：android, android-intent, onutterancecompleted

我正在尝试实现在 TextToSpeech 功能完成后将用户带回主屏幕的意图，但它不起作用，我不知道为什么。这是我的代码：

```
public void playText(){     
    String text = typeNewMessageEditText.getText().toString();
    HashMap<String, String> myHashRender = new HashMap<String, String>();
    myHashRender.put(TextToSpeech.Engine.KEY_PARAM_UTTERANCE_ID, "completed");
    tts.speak(text, TextToSpeech.QUEUE_FLUSH, myHashRender);        
}

@Override
public void onUtteranceCompleted(String utteranceId) {
    if (utteranceId.equals("completed")){   
                Intent displayMainActivity = new Intent (this, MainActivity.class);
                startActivity(displayMainActivity);
    }   
} 
```

# php - 如何使用 PHP 检查某组单词是否在字符串中

> ID：16115150
> 
> 赞同：0
> 
> 时间：2013-04-20T00:09:18.310
> 
> 标签：php, string, variables

所以我在下面有这段代码，但我想知道如何判断'$text' 是否包含'by owner' 字样。我该怎么做呢？我环顾四周，但找不到任何东西。

```
foreach($anchors as $a) { 
    $i = $i + 1;
    $text = $a->nodeValue;
    $href = $a->getAttribute('href');
    if ($i > 22 && $i < 64 && ($i % 2) == 0) {
        //if ($i<80) {
         echo "<a href =' ".$href." '>".$text."</a><br/>";
    }
   // }
        //$str = file_get_contents($href);
//$result = (substr_count(strip_tags($str),"ipod"));
//echo ($result);
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-20T01:06:59.010

就像是：

```
$text = $a->nodeValue;
if(strpos($text, "by owner") == -1){  // if you want the text to *start* with "by owner", you can replace this with strpos($text, "by owner") != 0
    echo "Doesn't have by owner";
}
else{
    echo "Has by owner";
} 
```

# jquery - 使用 JQuery 解析 WordPress RSS 提要

> ID：16115153
> 
> 赞同：0
> 
> 时间：2013-04-20T00:10:00.173
> 
> 标签：jquery, xml, rss

我正在使用 JQuery 来读取和解析自托管的 WordPress atom 提要。以下是 WordPress 生成的 XML 示例：

```
<?xml version="1.0" encoding="UTF-8"?>
<feed
  xmlns="http://www.w3.org/2005/Atom"
  xmlns:thr="http://purl.org/syndication/thread/1.0"
  xml:lang="en-US"
  xml:base="http://example.com/wp/wp-atom.php"
   >
    <title type="text">Feed Title</title>
    <subtitle type="text">Feed Subtitle</subtitle>
    <updated>2013-04-19T21:33:48Z</updated>
    <link rel="alternate" type="text/html" href="http://example.com/wp" />
    <id>http://example.com/wp/index.php/feed/atom/</id>
    <link rel="self" type="application/atom+xml" href="http://example.com/wp/index.php/feed?feed=atom&#038;cat=10" />
    <generator uri="http://wordpress.org/" version="3.5.1">WordPress</generator>
    <entry>
        <author>
        <name>Author Name</name>
        </author>
        <title type="html">Article Title</title>
        <link rel="alternate" type="text/html" href="http://example.com/wp/index.php/2013/04/19/article-title/" />
        <id>http://example.com/wp/?p=1418</id>
        <updated>2013-04-19T21:33:48Z</updated>
        <published>2013-04-19T21:33:16Z</published>
        <category scheme="http://example.com/wp" term="firstcategory" />
        <category scheme="http://example.com/wp" term="secondcategory" />
        <category scheme="http://example.com/wp" term="thirdcategory" />
        <summary type="html">A summary excerpt of the article [...]</summary>
        <content type="html" xml:base="http://example.com/wp/index.php/2013/04/19/tons-vs-tonnes/">A summary excerpt of the article with a whole bunch more text taht is not in the summary.
        </content>
        <link rel="replies" type="text/html" href="http://example.com/wp/index.php/2013/04/19/article-title/#comments" thr:count="0"/>
        <link rel="replies" type="application/atom+xml" href="http://example.com/wp/index.php/2013/04/19/article-title/feed/atom/" thr:count="0"/>
        <thr:total>0</thr:total>
    </entry>
</feed> 
```

这是我使用此提要并显示它的 JQuery ajax 代码：

```
$.ajax({
    url: "//example.com/wp/index.php/feed?feed=atom&cat=10",
    dataType: "xml",
    success: function(data) {
        console.log(data);
        var $xml = $(data),
            items = [];

        $xml.find("entry").each(function(i) {
            if (i === 30) return false;
            var $this = $(this);
            console.log($this);

            items.push('<div><h3>' + $this.find("title").text() + '</h3><p><small>Published by ' + $this.find("author").text().trim() + ' on ' + publisheddate.toDateString() + ' ' + publisheddate.toTimeString() + '</small></h3>' + $this.find("content").text() + '</div><hr />');
        });
        $("#displayDiv").html(items.join('')); 
```

这是工作！我想通过该条目的所有类别标签列表来增强这一点，如下所示：

```
firstcategory | secondcategory | thirdcategory 
```

如果查看 XML，您会注意到示例条目中有三个类别元素。

我尝试了几种方法，但都失败了。我已恢复为从中提取上述示例 javascript 的工作代码，因此我没有失败的尝试向您展示。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-21T10:44:12.293

在您使用的代码中，`publisheddate.toTimeString()`它会给出错误。

要获得您的类别，请使用以下内容：

```
 var categories = ""; 
            $this.find("category").each(function(j) {
                categories += " " + ($(this).attr("term"));
            })  
            items.push("categories:" + categories); 
```

# android - android google maps zoom导致调用ontap方法

> ID：16115159
> 
> 赞同：0
> 
> 时间：2013-04-20T00:10:52.137
> 
> 标签：android, google-maps

在 on tap 方法中，我正在执行某些代码。当用户点击地图时工作良好。但是当用户放大或缩小地图时，有时手指触摸会被检测为点击，并调用 on tap 方法。

如何防止这种情况并清楚地区分这两种行为？

谢谢。

# html - 为什么我的 html 页面顶部有多余的边距？

> ID：16115160
> 
> 赞同：1
> 
> 时间：2013-04-20T00:10:59.913
> 
> 标签：html, css, browser, dreamweaver, margin

我不断得到不需要的上边距并且无法删除它，我尝试了一切，这也影响了我的其他项目之一，可以找到任何解决方案。请帮助继承我的html：

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Joy The Designert</title>
<link href="style1.css" rel="stylesheet" type="text/css" />
</head>

<body topmargin=0 marginheight=0>
<div id="Wrapper">
<div id="topBanner"><div class="container"><h2>top banner content</h2></div></div>
<div id="nav"><div class="container">Navigation Text<?include ("navigation.php");?></div></div>
<div id="featured"><div class="container"></div></div>
<div id="info"><div class="container">test</div></div>
<div id="support"><div class="container">test</div></div>
<div id="footer"><div class="container">testing footer<?include ("footer.php");?></div></div>
</div>
</body>
</html> 
```

这是我的CSS内容：

```
 @charset "utf-8";
/* CSS Document */
html {
    margin:!important 0px;
    padding:0px;
}
body {
    margin-top:!important 0px;
    margin-left:0px;
    margin-right:0px;
    margin-botton:0px;
    padding:0px;
    border:none;
    color: #292929;
    font-family: Arial,Helvetica,sans-serif;
    font-size: 81.25%;

}
#wrapper {
    margin:0px;
    Width:1000px;
    height:auto;

}
.container {
    width:900px;
    margin:auto;

}
#topBanner{
    background-image:url(images/scr_gray-bkgd.png);
    background-repeat:repeat-x;
    height:44px;
    width:100%;
}
#nav{
    height:72px;
    width:100%;
    padding
    color:#666666;
    background-color: #F5F5F5;
    border-bottom: 1px solid #FFFFFF;
    box-shadow: 0 -5px 5px #5A595D;
    color: #666666;
    font-weight: bold;
    height: 72px;
}
#featured {
    min-height:420px;
    width:100%;
    background: url(none) no-repeat scroll center top #ECECEC;
    border-bottom: 1px solid #FFFFFF;
}

#info{

    background: url(images/gradient-bg.png);
    background-repeat:repeat-x;
    height: 256px;
    width: 100%;

}
#support{
    background-color: #F5F5F5;
    border-top: 1px solid #FFFFFF;
    box-shadow: 0 5px 5px #5A595D;
    height:55px;
    width:100%;
    }
#footer{
    width:100%;
    height:150px;
    background-image:url(images/scr_gray-bkgd.png);
    background-repeat:repeat;

} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-20T00:22:30.477

```
#topBanner h2{
    margin:0px;
} 
```

这应该解决它;）

# python - Google App Engine Python urlfetch 期间时间限制的确切机制？

> ID：16115161
> 
> 赞同：0
> 
> 时间：2013-04-20T00:11:00.367
> 
> 标签：python, google-app-engine

我的代码中有一个 http 请求，需要大约 5-10 秒才能运行。通过搜索该站点，我找到了增加超时前限制的代码：

```
from google.appengine.api import urlfetch
urlfetch.set_default_fetch_deadline(60) 
```

我的问题：那个数字“60”是什么？秒还是十分之一秒？大多数回应似乎暗示它是几秒钟，但这是不对的。当我使用 60 时，我在 localhost 上进行测试时会在不到 10 秒的时间内超时。我必须将数字设置为至少 100 以避免这个问题——我担心这会引起谷歌众神的愤怒。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-20T07:11:08.440

这是几秒钟，你可以在 fetch 函数中传递它。您是否尝试过获取其他网站？您确定这是超时而不是另一个错误吗？ [https://developers.google.com/appengine/docs/python/urlfetch/fetchfunction](https://developers.google.com/appengine/docs/python/urlfetch/fetchfunction)

# mysql - 如何根据 MySQL 中的相关性将两个表的行相互映射？

> ID：16115162
> 
> 赞同：0
> 
> 时间：2013-04-20T00:11:06.167
> 
> 标签：mysql, sql, mapping, model-associations, relevance

我的数据库中有以下表格：（`courses`体育课的全部数据），`coursedata`（带有副本`courses.title`和`courses.description`-`FULLTEXT`索引/相关性搜索所需），`sports`（体育列表）和`courses_sports`（关联表） - 见下文。

现在我想*根据运动映射课程相关性*并自动填充`courses_sports`这些数据。它需要两个步骤。

1.  使用适当的`SELECT`.

2.  将数据写入关联表。

这篇文章是关于第一步。我在编写查询时遇到了一些麻烦。我试过的：

```
SELECT
    courses.id,
    sports.id
FROM
    courses
JOIN
    coursedata ON coursedata.id = courses.coursedata_id
JOIN
    sports ON MATCH (coursedata.title) AGAINST (sports.title) > 0
-- The test with
-- sports ON MATCH (coursedata.title) AGAINST ('Basketball') > 0
-- works. 
```

此查询不起作用：

> 错误代码：1210
> 
> 反对的论据不正确

如何正确实现此映射？

* * *

**附加信息：相关表格**

**`courses`**

```
Field               Type             Key    
------------------  ---------------  ------ 
id                  int(11)          PRI             
title               varchar(100)                     
description         varchar(1000)                    
coursedata_id       int(11)          UNI     
... 
```

**`coursedata`**

```
Field        Type           Collation        Null    Key     
-----------  -------------  ---------------  ------  ------  
id           int(11)        (NULL)           NO      PRI     
title        varchar(100)   utf8_general_ci  YES     MUL     
description  varchar(1000)  utf8_general_ci  YES     MUL     

CREATE TABLE `coursedata` (
  `id` int(11) NOT NULL AUTO_INCREMENT,
  `title` varchar(100) DEFAULT NULL,
  `description` varchar(1000) DEFAULT NULL,
  PRIMARY KEY (`id`),
  FULLTEXT KEY `searchcoursetitle` (`title`),
  FULLTEXT KEY `searchcoursedescription` (`description`)
) ENGINE=MyISAM AUTO_INCREMENT=5208 DEFAULT CHARSET=utf8 
```

**`sports`**

```
Field     Type                   Collation        Null    Key     
--------  ---------------------  ---------------  ------  ------  
id        int(11)                (NULL)           NO      PRI     
title     varchar(50)            utf8_general_ci  NO              
category  varchar(50)            utf8_general_ci  YES             
type      enum('sport','dance')  utf8_general_ci  YES 
```

**`courses_sports`**

```
Field      Type     Collation  Null    Key     
---------  -------  ---------  ------  ------  
course_id  int(11)  (NULL)     NO      PRI     
sport_id   int(11)  (NULL)     NO      PRI 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-20T01:53:43.343

您忘记提供在这种情况下您加入的运动和课程之间的共同领域。您还忘记了 MATCH 之前的 WHERE 语句。

```
JOIN
    sports ON MATCH (coursedata.title) AGAINST (sports.title) > 0 AND
    sports ON MATCH (coursedata.description) AGAINST (sports.title) > 0 
```

所以，它应该是这样的：

```
JOIN
    sports ON (course.commonid = sports.commonid) WHERE MATCH 
```

而且由于您需要 coursedata.title 和 coursedata.description ，您可以将它们加入匹配。

```
JOIN
    sports ON (course.commonid = sports.commonid) WHERE MATCH(coursedata.title, coursedata.description) 
```

最后你不能在sports.title 中使用该字段，因为这意味着所有的体育标题都要与你进行比较，你可能会遍历并将值放在反对中。

```
JOIN
    sports ON (course.commonid = sports.commonid) WHERE MATCH(coursedata.title, coursedata.description) AGAINST('Martial') 
```

并且可能您也可以使用 BOOLEAN 模式，因为如果您有 50% 或更多的 AGAINST 匹配，它将无法工作

```
JOIN
    sports ON (course.commonid = sports.commonid) WHERE MATCH(coursedata.title, coursedata.description) AGAINST('Martial' IN BOOLEAN MODE) 
```

我有一个[SQL Fiddle](http://www.sqlfiddle.com/#!2/f0a1a/13)示例，但只有两个表，即 coursedata 和 sports，并在两者之间添加了一个公共字段。

最后可能您不必加入运动表而是遍历它然后匹配？也许你可以将所有结果联合起来。

# lua - Lua中顺序表的长度可能会跳过索引？

> ID：16115164
> 
> 赞同：1
> 
> 时间：2013-04-20T00:11:11.833
> 
> 标签：lua, indices, lua-table

在 Lua 中，如果表中缺少单个数字键，则长度仍会继续计数：

```
> print(#{[1]=1,[2]=2,[4]=4})
4 
```

但是这个跳过两个索引在休息时停止

```
> print(#{[1]=1,[2]=2,[5]=5})
2 
```

它不仅仅是非常规的构造函数。即使在创建表之后创建了跳过的索引，它仍然会超过它，所以只要中断只是一个。

```
> x={1,2}
> print(#x)
2
> x[4]=4
> print(#x) 
```

这是一个实现错误还是 Lua 应该如何工作。为什么会这样？对此文档的任何引用都会很有趣。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-20T01:21:35.340

这就是它的工作原理。仅当表是序列且没有孔时才定义表的长度。请参阅[http://www.lua.org/manual/5.2/manual.html#3.4.6](http://www.lua.org/manual/5.2/manual.html#3.4.6) 。

# c - 使用命令行参数进行分叉

> ID：16115168
> 
> 赞同：1
> 
> 时间：2013-04-20T00:11:52.473
> 
> 标签：c, linux, exec, fork, command-line-arguments

我正在构建一个 Linux Shell，我目前的头痛是将命令行参数传递给分叉/执行的程序和系统函数。

目前，所有输入都在全局变量 char * parsed_arguments 中以空格和换行符标记。例如，输入**目录 /usa/folderb**将被标记为：

```
parsed_arguments[0] = dir
parsed_arguments[1] = /usa/folderb 
```

parsed_arguments 完美地标记了一切；我现在的问题是我希望只获取 parsed_arguments 的一个子集，它不包括要在 shell 中运行的可执行文件的命令/第一个参数/路径，并将它们存储在一个名为 pass_arguments 的新数组中。

所以在前面的例子中**dir /usa/folderb**

```
parsed_arguments[0] = dir
parsed_arguments[1] = /usa/folderb

passed_arguments[0] = /usa/folderb
passed_arguments[1] = etc.... 
```

目前我对此没有任何运气，所以我希望有人可以帮助我。这是我到目前为止工作的一些代码：

我如何尝试复制参数：

```
void  command_Line()
{

  int i = 1;
  for(i;parsed_arguments[i]!=NULL;i++)
    printf("%s",parsed_arguments[i]);

} 
```

读取命令的功能：

```
void readCommand(char newcommand[]){

printf("readCommand: %s\n", newcommand);

//parsed_arguments =  (char* malloc(MAX_ARGS));
//  strcpy(newcommand,inputstring);
  parsed =  parsed_arguments;
  *parsed++ = strtok(newcommand,SEPARATORS);   // tokenize input
    while ((*parsed++ = strtok(NULL,SEPARATORS)))
      //printf("test1\n"); // last entry will be NULL

      //passed_arguments=parsed_arguments[1];

    if(parsed[0]){  
      char *initial_command =parsed[0];

  parsed= parsed_arguments;
  while (*parsed) fprintf(stdout,"%s\n ",*parsed++);
  // free (parsed);
  // free(parsed_arguments);

    }//end of if

  command_Line();

}//end of ReadCommand 
```

分叉功能：

```
else if(strstr(parsed_arguments[0],"./")!=NULL)
    {
      int pid;
      switch(pid=fork()){
      case -1:
       printf("Fork error, aborting\n");
       abort();
      case 0:
        execv(parsed_arguments[0],passed_arguments);

      }

    } 
```

![在此处输入图像描述](https://i.stack.imgur.com/YjToQ.png)

这是我的外壳当前输出的内容。我第一次运行它时，它会输出一些接近我想要的东西，但每次后续调用都会破坏程序。此外，每个额外的调用都会将解析的参数附加到输出中。

![](https://i.stack.imgur.com/a9FBq.png)

这是原始外壳产生的。再次接近我想要的，但不完全。我想省略命令（即“./testline”）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-20T02:09:49.910

您的`testline`程序在您的工具箱中是一个明智的选择；我有一个类似的程序，我调用`al`（用于参数列表）打印它的参数，每行一个。虽然它不打印`argv[0]`（我知道它被称为`al`）。您也可以轻松安排您`testline`的跳过`argv[0]`。请注意，Unix 约定是`argv[0]`程序的名称；你不应该试图改变它（你将与整个系统作斗争）。

```
#include <stdio.h>

int main(int argc, char **argv)
{
    while (*++argv != 0)
        puts(*argv);
    return 0;
} 
```

您的函数`command_line()`也是合理的，只是它不必要地依赖于全局变量。将全局变量视为难闻的气味（例如 H [2] S）；尽可能避免它们。它应该更像：

```
void command_Line(char *argv[])
{
    for (int i = 1; argv[i] != NULL; i++)
        printf("<<%s>>\n", argv[i]);
} 
```

如果您坚持使用 C89，则需要`int i;`在循环外部声明并仅`for (i = 1; ...)`在循环控制中使用。请注意，此处的打印将每个参数单独分隔在一行上，并将其括在标记字符中（`<<`并且`>>`- 更改以适应您的突发奇想和偏见）。可以跳过循环中的换行符（可能使用空格代替），然后在循环后添加换行符（`putchar('\n');`）。这使得一个更好的、更接近通用的调试例程。（当我写一个“转储”函数时，我通常使用`void dump_argv(FILE *fp, const char *tag, char *argv[])`这样我可以打印到标准错误或标准输出，并包含一个标签字符串来标识转储的写入位置。）

不幸的是，鉴于您的`readCommand()`功能的碎片性，不可能连贯地批评它。注释掉的行足以引起关注，但是如果没有您正在运行的实际代码，我们无法猜测您正在犯什么问题或错误。如图所示，它等价于：

```
void readCommand(char newcommand[])
{
    printf("readCommand: %s\n", newcommand);

    parsed = parsed_arguments;
    *parsed++ = strtok(newcommand, SEPARATORS);
    while ((*parsed++ = strtok(NULL, SEPARATORS)) != 0)
    {
        if (parsed[0])
        {
            char *initial_command = parsed[0];
            parsed = parsed_arguments;
            while (*parsed)
                fprintf(stdout, "%s\n ", *parsed++);
        }
    }

    command_Line();
} 
```

变量`parsed`和`parsed_arguments`都是全局变量，变量`initial_command`已设置但未使用（又名“无意义”）。测试`if (parsed[0])`不安全；您在上一行中增加了指针，因此它指向不确定的内存。

从表面上看，从屏幕截图来看，您在第二次使用时没有正确重置`parsed_arguments[]`和/或`passed_arguments[]`数组；它可能是一个未设置为零的索引。如果不知道数据是如何分配的，就很难知道你可能做错了什么。

我建议关闭这个问题，回到你的系统并生成一个最小的 SSCCE。它应该在大约 100 行以下；它不需要执行`execv()`（或），但应该使用上述函数`fork()`的变体打印要执行的命令。`command_Line()`如果此答案阻止您删除（关闭）此问题，请使用您的 SSCCE 代码对其进行编辑，并通过对此答案的评论通知我，以便我看到您已完成此操作。

# c - fprintf 字符串终止的心理障碍

> ID：16115176
> 
> 赞同：0
> 
> 时间：2013-04-20T00:13:32.197
> 
> 标签：c, c-strings, null-terminated

我对这个完全不知所措。我不知道为什么这不起作用。带有 NULL 终止符的简单字符数组 - 除了当我输出它时，它不会终止！

```
int file_create(const char *path) {
    //trying to trap situations where the path starts with /.goutputstream
    char path_left_15[16];
    strncpy(path_left_15, path, 15);
    printf("%d\n", strlen("/.goutputstream")+1);
    path_left_15[strlen("/.goutputstream")+1] = '\0'; 
    printf("%d\n", strlen(path_left_15));
    printf("path_left_15: %s\n", path_left_15);
    //continue on...
} 
```

这是我的输出：

```
> 16 

> 16 

>/.goutputstream\B7<random memory stuff> 
```

我无法弄清楚为什么这不能正确终止。我试过让数组更长，但每次都得到相同的结果。我快疯了！

有人看到吗？谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-20T00:17:27.180

您的数组只有 16 个元素，但您正试图写入第 17 个元素。所以这是未定义的行为。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-20T00:21:41.147

您超出了数组的范围。而不是`path_left_15[strlen("/.goutputstream")+1] = '\0';`尝试`path_left_15[15] = '\0';`

您将截断您的字符串，但在打印时会很安全。

# ruby-on-rails - 何时在 Rails 中使用 Rake 任务

> ID：16115178
> 
> 赞同：1
> 
> 时间：2013-04-20T00:14:16.993
> 
> 标签：ruby-on-rails, ruby, rake

我对将一些代码放在 Rake 任务还是模型中是否是 Rails 方式感到困惑。

1.  我有一些代码仅作为后台作业运行，如果他们的一个朋友一天有任何活动，则向用户发送电子邮件
2.  我正在使用[Each gem](https://github.com/javan/whenever)来安排方法/任务的执行，这允许我从模型或 Rake 任务运行代码

有人可以帮助我解决这个新手问题，即 Rails 方式是否是将后台作业代码放入模型或 Rake 任务中？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-20T00:52:26.090

这与 Rails 方式无关，但与面向对象编程无关。我会说你应该把行为放在一个类中，这样你就可以在你的应用程序的每个地方使用它。如果你把它放在 rake 任务中，你就会有行为。而这种 rake 任务是做某事，但谁应该知道如何去做，应该是模型或其他一些类。例如，如果您想在将来使用 resque，如果您将代码放在类中并且没有锁定在 rake 任务中，那么对代码的更改将更容易进行。

# matlab - 在matlab中的同一趋势线上绘制两个函数

> ID：16115179
> 
> 赞同：0
> 
> 时间：2013-04-20T00:14:20.167
> 
> 标签：matlab

这是我的原始代码：

```
function a = graph_times()
merge_times = [];
for i = 100:100:1000
    curr = sort_timer(i);
    merge_times = [merge_times, curr(1)];
end
plot(100:100:1000, merge_times);

a = 1;
end 
```

`insertion_sort`我想修改此代码，以便`merge_sort`在同一图表上绘制趋势线。下面是函数`merge_sort`和`insertion_sort`

```
function c = insertion_sort(list1)
inserted = [];
for i = 1:size(list1,2)
inserted = insert_in_order(inserted,list1(1,i))
c = inserted
end
steps2=0;

function b = merge_sort(nums)
    if size(nums,2) == 1
        b = nums;
        return;
    end 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-20T00:46:08.610

`plot`您可以为 MATLAB 的函数提供多组坐标。您可以像这样绘制两种排序算法的时间：

```
plot(100:100:1000, merge_times, 100:100:1000, insertion_times); 
```

# javascript - 在 ul 末尾添加两个 li 元素

> ID：16115180
> 
> 赞同：1
> 
> 时间：2013-04-20T00:15:06.673
> 
> 标签：javascript, jquery

这是我尝试这样做的**jsfiddle ：http:** [//jsfiddle.net/fxMFh/](http://jsfiddle.net/fxMFh/)

我想用jquery在子菜单的末尾添加两个li，但这似乎没有导航到它需要的ul：

```
$(document).ready(function() {
   $(".navigation_container nav > ul > li > ul").append('<li><a href="#">test</a></li>');
}); 
```

这一定是问题所在：

```
$(".navigation_container nav > ul > li > ul") 
```

我必须在这里做一些非常*无聊*的事情..

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-20T00:18:59.163

尝试

```
$(document).ready(function() {
    $(".navigation_container nav > ul > li > div.sub-menu > ul").append('<li><a href="#">test</a></li>');
}); 
```

演示：[小提琴](http://jsfiddle.net/FczCs/)

但可能我会将选择器缩短为

```
$(document).ready(function() {
    $(".navigation_container nav div.sub-menu > ul").append('<li><a href="#">test</a></li>');
}); 
```

演示：[小提琴](http://jsfiddle.net/FczCs/1/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-20T00:19:53.313

三个问题：

1.  小提琴不包括 jQuery。

2.  选择器缺少 div 包装器。它应该是：

    `$(".navigation_container nav > ul > li > div > ul")`

3.  `.appendTo()`应该`.append()`

[http://jsfiddle.net/ryanbrill/fxMFh/5/](http://jsfiddle.net/ryanbrill/fxMFh/5/)

# apache - Apache 负载均衡器和 JBoss

> ID：16115183
> 
> 赞同：1
> 
> 时间：2013-04-20T00:15:59.023
> 
> 标签：apache, jboss, load-balancing

我正在使用带有 JBOSS 的 apache 负载均衡器 2.1，其中我配置了 10 个 jboss 节点以由 apache 负载均衡器管理。apache 负载均衡器中是否有可用的控制台来管理所有这些节点，并查看当环境中有一些负载时每个节点处理了多少用户？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-22T19:39:57.133

有一个 JKManager 控制台。这不是什么令人兴奋的事情，但非常有用。

看：

*   [http://tomcat.apache.org/connectors-doc/generic_howto/loadbalancers.html](http://tomcat.apache.org/connectors-doc/generic_howto/loadbalancers.html)
*   [http://www.gesea.de/en/techdocs/admin/tomcat/JKManager-Apache-mod_jk-loadbalancer-status-monitor.htm](http://www.gesea.de/en/techdocs/admin/tomcat/JKManager-Apache-mod_jk-loadbalancer-status-monitor.htm)

# c++ - 使用运算符将 字符串流传递给 istream >>

> ID：16115188
> 
> 赞同：7
> 
> 时间：2013-04-20T00:17:06.613
> 
> 标签：c++, operators, overloading, stringstream, extraction

我正在尝试将一个字符串流传递给一个对象（类），该对象（类）具有一个`>>`已声明和定义的重载提取运算符。例如，object1 中重载提取运算符的声明是

```
friend istream& operator >>(istream& in, Object1& input); 
```

在object2中，我的声明几乎一样

```
friend istream& operator >>(istream& in, Object2& input); 
```

在 object1 提取函数期间，func. 获取一行，将其转换为字符串流并尝试使用 Object2 的提取（>>）运算符。

```
istream& operator >>(istream& in, Object1& input){
     Object2 secondObj;
     string data;
     string token;
     in>>data;
     in.ignore();
     token = GetToken(data, ' ', someint); //This is designed to take a part of data
     stringstream ss(token); // I copied token into ss
     ss >> secondObj; // This is where I run into problems.
} 
```

我得到错误`No match for operator >>`。这是因为我需要将 stringstream 转换为 istream 吗？如果是这样，我该怎么做？

最小程序如下所示： 在 main.cpp 中：

```
#include "Object1.h"
#include "Object2.h"
#include "dataClass.h"
using namespace std;
int main(){
    Object1<dataClass> firstObj;
    cin>>firstObj;
    cout<<firstObj<<endl;
} 
```

在 Object1.h 中：

```
#ifdef OBJECT1_H_
#define OBJECT1_H_
#include <iostream>
#include <string>
#include <cstddef>
#include "Object2.h"
template<class T>
class Object1{
public:
    //Assume I made the Big 3
    template<class U>friend istream& operator >>(istream& in, Object1<U>& input);
    template<class U>friend ostream& operator <<(ostream& out, const Object1<U>& output);
private:
    Object2<T>* head;
};
template<class T>
istream& operator >>(istream& in, Object1<T>& input){
     Object2 secondObj;
     string data;
     string token;
     in>>data;
     in.ignore();
     token = GetToken(data, ' ', someint); //This is designed to take a part of data
     stringstream ss(token); // I copied token into ss
     ss >> secondObj; // This is where I run into problems.
}
template<class T>
ostream& operator <<(ostream out, const Object1<T>& output){
     Object2<T>* ptr;
     while(GetNextPtr(ptr) != NULL){
         cout<<ptr;
         ptr = GetNextPtr(ptr); //Assume that I have this function in Object2.h
     }
} 
```

Object2.h 文件与 Object1.h 类似，除了：

```
template<class T>
class Object2{
public:
//similar istream and ostream funcions of Object1
//a GetNextPtr function
private:
    T data;
    Object2<T>* next;
};
template<class T>
istream& operator >>(istream& in, Object2<T>& input){
      in>>data; //data is the private member variable in Object2.
                //it is of a templated class type.
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-20T00:26:43.760

以下编译良好：

```
#include <string>
#include <sstream>
#include <iostream>

using namespace std;

struct X{};

struct Y{};

istream& operator>>(istream&, X&) {}

istream& operator>>(istream&, Y&)
{
    stringstream ss("foo");

    X x;
    ss >> x;
}

int main()
{
    Y y;
    cin >> y;
} 
```

你的问题一定在别处

你能发布一个完整的最小独立程序来演示这个问题吗？或者只是你对函数的声明和定义`istream& operator >>(istream& in, Object2& input)`？它是否在翻译单元中的 Object1 版本之前声明？

# ruby-on-rails - Authority Ruby Gem 可以与注销的用户一起使用吗？

> ID：16115191
> 
> 赞同：3
> 
> 时间：2013-04-20T00:17:22.217
> 
> 标签：ruby-on-rails, authority-gem

我收到以下错误：

```
 undefined method `can_read?' for nil:NilClass 
```

..当尝试使用已注销的用户访问产品页面时。目前我有

```
class ProductAuthorizer < ApplicationAuthorizer

  def self.readable_by?(user)
    true
  end

end 
```

我想允许甚至未登录的用户查看该页面。这可能吗？

我尝试将默认用户方法更改为：

```
config.user_method = :current_user ||= User.new 
```

但是，这会导致问题，我的服务器甚至无法启动。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-04-20T01:01:14.213

好的，我在[https://github.com/nathanl/authority/pull/32](https://github.com/nathanl/authority/pull/32)找到了这个：

> 好的！为了其他阅读此问题的人，我和 Chris 聊了聊，并商定了最好的方法。这是它的要点。
> 
> 当局不会专门处理 nil 用户或给出这样做的特定选项。我们希望将授权限制为授权并保持身份验证完全独立。如果没有用户登录，那就是身份验证问题；权威无法有意义地回答“这个用户可以做 X 吗？”这个问题。如果它没有给用户或类似的东西。
> 
> 除了哲学观点之外，拥有身份验证处理这是一种更好的用户体验。如果管理员忘记登录并尝试一些仅限管理员的操作，那么说“访问被拒绝”会让他们感到困惑。说“请登录”会更有帮助。
> 
> 使用权威的开发者可以做的是：
> 
> 有类似 Devise 的 before_filter :authenticate_user 的东西！在对请求进行任何授权检查之前运行（因为任何需要授权的操作显然都需要身份验证）。让他们的用户方法返回一个像用户一样嘎嘎作响的 NullUser 对象，然后让他们的授权者知道如何处理那些权威可以做的是改善它给你的错误，如果你通过 nil 或其他任何不像用户那样嘎嘎作响的东西. Chris 将实现这一点。

嗨，我刚刚放了这个

```
 class ApplicationController < ActionController::Base
      def current_or_null_user
        if current_user == nil
          User.new
        else
          current_user
        end
     end
  end 
```

...

```
Authority.configure do |config|
   config.user_method = :current_or_null_user
end 
```

# java - 在 IntelliJ IDEA 中运行 vaadin Web 应用程序时，此警告意味着什么 - 没有启动 URL

> ID：16115200
> 
> 赞同：1
> 
> 时间：2013-04-20T00:18:04.333
> 
> 标签：java, intellij-idea, vaadin

我能够运行 vaadin 应用程序并启动开发模式任务，并显示以下警告：

```
[WARN] No startup URLs supplied and no plausible ones found -- use -startupUrl 
```

我找不到有关此警告及其含义的任何信息。IntelliJ idea 没有启动我选择的网络浏览器，我怀疑是这个警告的原因，但我不知道如何按照上述指示进行操作，因为我什至不知道是什么告诉我这个，以及在哪里Idea 项目我可能会添加`-startupUrl`参数。

我的问题是，虽然开发模式任务在我运行我的项目时开始，但我似乎无法找到`http://localhost:8000`可以加载我的应用程序的某个 url（或其他任何内容）。

我运行我的应用程序时的完整输出是：

```
 /System/Library/Java/JavaVirtualMachines/1.6.0.jdk/Contents/Home/bin/java -Xmx256m -Didea.launcher.port=7535 "-Didea.launcher.bin.path=/Applications/IntelliJ IDEA 12.app/bin" ....
  [WARN] No startup URLs supplied and no plausible ones found -- use -startupUrl
  Dev Mode initialized 
```

# mysql - Mysql 案例 - 计算窗帘时间的字段

> ID：16115201
> 
> 赞同：0
> 
> 时间：2013-04-20T00:18:06.697
> 
> 标签：mysql, sql

我正在尝试设置具有以下字段的报告：

![在此处输入图像描述](https://i.stack.imgur.com/BU5G3.png)

几乎需要报告显示日期，该日期的总记录（所以我按日期分组）然后按小时计算 12 小时工作日（从上午 8 点到晚上 8 点）我需要计算什么时候在这些时间内存在记录。经过一些头脑风暴和头脑放屁后，我想为什么不使用一个案例。这是我尝试过的：

```
 SELECT 
        DATE_FORMAT(signintime, '%b %d, %Y') Date, 
        COUNT(session_id) as Total,
        SUM(CASE WHEN HOUR(signintime) > 08 AND HOUR(signintime) < 09 THEN 1 ELSE 0 END) '8AM-9PM',
        SUM(CASE WHEN HOUR(signintime) > 09 AND HOUR(signintime) < 10 THEN 1 ELSE 0 END) '9AM-10AM',
        SUM(CASE WHEN HOUR(signintime) > 10 AND HOUR(signintime) < 11 THEN 1 ELSE 0 END) '10AM-11AM',
        SUM(CASE WHEN HOUR(signintime) > 11 AND HOUR(signintime) < 12 THEN 1 ELSE 0 END) '11AM-12PM',
        SUM(CASE WHEN HOUR(signintime) > 12 AND HOUR(signintime) < 13 THEN 1 ELSE 0 END) '12PM-1PM',
        SUM(CASE WHEN HOUR(signintime) > 13 AND HOUR(signintime) < 14 THEN 1 ELSE 0 END) '1PM-2PM',
        SUM(CASE WHEN HOUR(signintime) > 14 AND HOUR(signintime) < 15 THEN 1 ELSE 0 END) '2PM-3PM',
        SUM(CASE WHEN HOUR(signintime) > 15 AND HOUR(signintime) < 16 THEN 1 ELSE 0 END) '3PM-4PM',
        SUM(CASE WHEN HOUR(signintime) > 16 AND HOUR(signintime) < 17 THEN 1 ELSE 0 END) '4PM-5PM',
        SUM(CASE WHEN HOUR(signintime) > 17 AND HOUR(signintime) < 18 THEN 1 ELSE 0 END) '5PM-6PM',
        SUM(CASE WHEN HOUR(signintime) > 18 AND HOUR(signintime) < 19 THEN 1 ELSE 0 END) '6PM-7PM',
        SUM(CASE WHEN HOUR(signintime) > 19 AND HOUR(signintime) < 20 THEN 1 ELSE 0 END) '7PM-8PM'
 FROM session 
 WHERE session.status = '3'
 GROUP by HOUR(signintime), Date; 
```

如果您注意到上面的图片，那么现在一整天（2013 年 4 月 19 日）的总数是 1，如果您注意到时间（上午 8 点到晚上 8 点）它们都被清零了。我不确定在哪里转向/在哪里调试它。希望用另一双眼睛，我可以继续前进。

问候。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-20T00:31:52.460

您不需要同时使用`>`and`<`来获得结果，您只需检查`hour`值：

```
select DATE_FORMAT(signintime, '%b %d, %Y') Date, 
  count(session_id) as Total,
  SUM(CASE WHEN HOUR(signintime) = 08 THEN 1 ELSE 0 END) '8AM-9AM',
  SUM(CASE WHEN HOUR(signintime) = 09 THEN 1 ELSE 0 END) '9AM-10AM',
  SUM(CASE WHEN HOUR(signintime) = 10 THEN 1 ELSE 0 END) '10AM-11AM',
  SUM(CASE WHEN HOUR(signintime) = 11 THEN 1 ELSE 0 END) '11AM-12PM',
  SUM(CASE WHEN HOUR(signintime) = 12 THEN 1 ELSE 0 END) '12PM-1PM',
  SUM(CASE WHEN HOUR(signintime) = 13 THEN 1 ELSE 0 END) '1PM-2PM',
  SUM(CASE WHEN HOUR(signintime) = 14 THEN 1 ELSE 0 END) '2PM-3PM',
  SUM(CASE WHEN HOUR(signintime) = 15 THEN 1 ELSE 0 END) '3PM-4PM',
  SUM(CASE WHEN HOUR(signintime) = 16 THEN 1 ELSE 0 END) '4PM-5PM',
  SUM(CASE WHEN HOUR(signintime) = 17 THEN 1 ELSE 0 END) '5PM-6PM',
  SUM(CASE WHEN HOUR(signintime) = 18 THEN 1 ELSE 0 END) '6PM-7PM',
  SUM(CASE WHEN HOUR(signintime) = 19 THEN 1 ELSE 0 END) '7PM-8PM'
from session
WHERE session.status = '3'
group by DATE_FORMAT(signintime, '%b %d, %Y'); 
```

请参阅[带有演示的 SQL Fiddle](http://sqlfiddle.com/#!2/fb9dc1/3)

# ios - 检测在分组的 UITableView 中单击了哪个按钮

> ID：16115203
> 
> 赞同：0
> 
> 时间：2013-04-20T00:18:23.527
> 
> 标签：ios, objective-c, xcode, uitableview

我有一个分组的 UITableView （这个有 4 个部分），每个部分有几行。我以编程方式在每个单元格中创建了 2 个按钮。

这就是我创建`UITableViewCell`. 在这段代码中，我试图检测按下的按钮的 indexPath.row 和 indexPath.section 并将其传递给方法。我怎么能做到这一点？

```
-(UITableViewCell*)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath{
    static NSString *cellId = @"Cell";
    UITableViewCell *cell ;//= [tableView dequeueReusableCellWithIdentifier:nil];

if (cell == nil) {
    cell = [[UITableViewCell alloc] initWithStyle:UITableViewCellStyleDefault reuseIdentifier:cellId];
}

NSString *docTitle = [currentDocument objectForKey:@"displayname"];

UIView *cellView = [[UIView alloc] initWithFrame:CGRectMake(cell.contentView.frame.origin.x+5, cell.contentView.frame.origin.y, cell.contentView.frame.size.width, cell.contentView.frame.size.height)];
UILabel *cellTitle = [[UILabel alloc] initWithFrame:CGRectMake(cellView.frame.origin.x + 5, cellView.frame.origin.y + 5, cellView.frame.size.width - 10, 25)];
cellTitle.backgroundColor = [UIColor clearColor];
cellTitle.text = docTitle;
[cellView addSubview:cellTitle];

[cell.contentView addSubview:cellView];

UIButton *viewDocumentButton = [UIButton buttonWithType:UIButtonTypeRoundedRect];
[viewDocumentButton setTitle:@"View Online" forState:UIControlStateNormal];
viewDocumentButton.frame = CGRectMake(cellView.frame.origin.x + 5,       cellTitle.frame.origin.y + cellTitle.frame.size.height + 5, 150, 35);
[viewDocumentButton addTarget:self action:@selector(openDocumentButtonPressedMethod:) forControlEvents:UIControlEventTouchDown];
[viewDocumentButton setTag:indexPath.row];
[cell.contentView addSubview:viewDocumentButton];

UIButton *downloadDocumentButton = [UIButton buttonWithType:UIButtonTypeRoundedRect];
[downloadDocumentButton setTitle:@"Download Document" forState:UIControlStateNormal];
downloadDocumentButton.frame = CGRectMake(cellView.frame.origin.x + 5, viewDocumentButton.frame.origin.y + viewDocumentButton.frame.size.height + 5, 150, 35);
[downloadDocumentButton addTarget:self action:@selector(openDocumentButtonPressedMethod:) forControlEvents:UIControlEventTouchDown];
[downloadDocumentButton setTag:indexPath.row];
[cell.contentView addSubview:downloadDocumentButton];

cell.selectionStyle = UITableViewCellSelectionStyleNone;
return cell;  
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-20T03:53:40.110

此外，您可以...

```
- (IBAction)openDocumentButtonPressedMethod:(id)sender {
    UIButton *button = (UIButton *)sender;
    UIView *contentView = button.superview;
    UITableViewCell *cell = (UITableViewCell *)contentView.superview;
    NSIndexPath *indexPath = [self.tableView indexPathForCell:cell];

    // do something with the indexPath
} 
```

如果您想使用相同的方法来处理两个按钮事件，那么您可以使用按钮上的标签来区分两个按钮。

```
if (button.tag == 1) {
    // do something with the indexPath view related
}
else {
    // do something with the indexPath download related
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-20T00:46:18.593

创建一个子类`UIButton`

```
@interface MyButton : UIButton 
{ /* indexPath, other stuff */ }
@end 
```

然后实施

```
- (void)sendAction:(SEL)action to:(id)target forEvent:(UIEvent *)event 
```

`indexPath`在调用`super`for 这个方法之前对 the 和其他东西做一些事情。

创建按钮时，提供`indexPath`.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-20T00:49:38.733

在你的`openDocumentButtonPressedMethod:`方法中，做

```
CGPoint pointInTableView = [self.tableView convertPoint:sender.bounds.origin fromView:sender];

NSIndexPath *indexPath = [self.tableView indexPathForRowAtPoint:pointInTableView]; 
```

# workflow - Plone 4 - 第二个工作流程的历史不会显示在@@historyview

> ID：16115204
> 
> 赞同：2
> 
> 时间：2013-04-20T00:18:35.223
> 
> 标签：workflow, plone, dexterity

我在 Plone 4.2.4 中有一个敏捷内容类型。版本控制适用`default workflow`于这种内容类型，尽管它不是 plone 附带的工作流，而是定制的。

但是，当我为同一类型启用第二个工作流时，除了版本控制之外的所有内容都可以正常工作。

*   由第二个工作流管理的其他权限正在运行
*   状态变化正在起作用

区别：

*   我为工作流使用了不同`state_variable`的名称，这似乎很有意义，以便为第二个工作流的状态提供一个可编目字段。

我尝试使用相同的状态变量名称，但这没有帮助。我`review_history`还在第二个工作流中设置了工作流变量，并在上下文中有足够的权限。我（大部分）很确定，我得到了权限概念，但是当涉及多个工作流时，我不知道权限是如何计算的。

知道吗，为什么第二个工作流程不会在我的内容类型历史记录中留下痕迹？

首先十分感谢。

**乌馆**

我已经按照 Ida Ebkes 的建议对工作流程进行了重新排序，并且确实看到了，来自第二个工作流程的所有转换都得到了正确存储。所以这似乎是历史视图的问题。

由于这些工作流确实描述了内容类型的并发行为，我真的很想坚持使用单独的工作流和理想的不同工作流状态变量和目录索引。

我现在认为需要做的是调整历史视图。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-24T03:26:30.807

这是我的做法。它至少适用于 plone 4.2.4。

由于问题是显示问题，我只需要调整我的 historyviewlet。因此，我创建了一个以`viewlets`我的产品根目录命名的文件夹并创建了一个`__init__.py`和一个`configure.zcml`文件。然后我将`content_history.pt`, `history_view.pt`,`review_history.pt`和`content.py`从`plone/app/layout/viewlets/`(omelette) 复制到新创建的文件夹中。

`configure.zcml`包含两个视图注册：

```
<browser:view
    for="*"
    name="my-contenthistory"
    class=".content.ContentHistoryView"
    permission="zope2.View"
    />

<browser:page
    for="*"
    name="my-historyview"
    template="history_view.pt"
    permission="zope2.View"
    /> 
```

此外，我将整个`WorkflowHistoryViewlet`班级从复制`content.py`到不同的班级名称。`TransferHistory`在这种情况下。然后我主要更改了与工作流状态变量相对应的部分，它不是`review_state`，而是`transfer_state`。我进一步发现，第二个工作流程的初始使用还在第二个工作流程`created`的历史记录中创建了一个条目，我刚刚过滤了 .

```
transfer_history = [x for x in transfer_history if x['action'] != None] 
```

我将视图名称更正`history_view.pt`为我的新视图名称。

```
<div tal:replace="structure here/@@my-contenthistory">Content History</div> 
```

最后，我将我的班级作为父母添加到`ContentHistoryViewlet`班级中`content.py`

```
class ContentHistoryViewlet(WorkflowHistoryViewlet, TransferHistoryViewlet):

    index = ViewPageTemplateFile("content_history.pt")

    @memoize
    def getUserInfo(self, userid):

    [...]

    def fullHistory(self):
        history = self.workflowHistory() + self.revisionHistory() + self.transferHistory()
        if len(history) == 0:
            return None
        history.sort(key=lambda x: x["time"], reverse=True)
        return history 
```

并在产品中注册了.zcml`configure.zcml`

```
 <include package=".viewlets" /> 
```

然后我修改`content_history.pt`并更改了`action_id`文件上部的定义。

```
[...]
action_id python:item['action'] or item.get('review_state', False) or item.get('transfer_state', False);
[...] 
```

重新启动怪物并重新安装产品后，两个工作流的所有状态更改都显示在 my-historyview 中。

# gnuplot - 如何让 gnuplot 使用默认的 matlab 配色方案？

> ID：16115205
> 
> 赞同：1
> 
> 时间：2013-04-20T00:18:42.843
> 
> 标签：gnuplot

我正在尝试将我的数据与使用 matlab 制作的图进行比较。我想使用 gnuplot，但配色方案不同，很难比较图。如何让 gnuplot 使用 matlab 的“jet”颜色主题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-20T00:18:42.843

解决方案取自[此页面](https://gist.github.com/bagrow/805122)：

```
set palette defined (0 0.0 0.0 0.5, \
1 0.0 0.0 1.0, \
2 0.0 0.5 1.0, \
3 0.0 1.0 1.0, \
4 0.5 1.0 0.5, \
5 1.0 1.0 0.0, \
6 1.0 0.5 0.0, \
7 1.0 0.0 0.0, \
8 0.5 0.0 0.0 ) 
```

# php - 如何以设定的时间间隔重新解析 XML 文档？

> ID：16115208
> 
> 赞同：2
> 
> 时间：2013-04-20T00:18:57.967
> 
> 标签：php, javascript, jquery, xml, ajax

我在客户的网站上建立了一个区域，显示当前正在播放的歌曲，通过 PHP 从 XML 文件中解析。但是，我的客户希望歌曲自动刷新，而不是手动刷新页面。

我尝试使用 jQuery.get() 和 .ajax() 解析文件，但由于 XML 文件的结构方式，似乎我只能将艺术家和名称压缩成一个字符串，或者当我尝试具体化时，它只返回 [object Object]。

我什至没有尝试过计算歌曲的长度，然后根据该长度刷新提要。我可能看不到，因为这对我来说显然是个问题。

任何帮助或一般指导将不胜感激。

示例工作 PHP 代码（显然，非 AJAX）：

```
<?php
    $recentlyPlayed = simplexml_load_file('http://publicapi.streamtheworld.com/public/nowplaying?mountName=ABCDFM&numberToFetch=1&eventType=track');
    $trackTitle = $recentlyPlayed->{'nowplaying-info'}[0]->property[1];
    $trackArtist = $recentlyPlayed->{'nowplaying-info'}[0]->property[0];
    echo "<h6>" . $trackArtist . "<span class=\"song-title\">" . $trackTitle . "</span></h6>";
?> 
```

我已经尝试了几种不同的方法来使其正常工作，但似乎最初的障碍是尝试使用属性而不是节点名称来引用 XML 文件中的数据。节点都被命名为相同的，这是区分它们的属性。因此，除非艺术家/歌曲标题为空白，否则此代码将正确呈现，然后它会呈现第三个字段，该字段有点神秘地命名为“cue_time_start”。

```
<script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js" ></script>
<script type="text/javascript">
    $(document).ready(function() {
        setInterval("songPull()",1000);
    });

    function songPull() {
        $.get(
            "http://publicapi.streamtheworld.com/public/nowplaying?mountName=ABCDFM&numberToFetch=1&eventType=track", 
            "xml",
            function(data) {
                $(data).find("nowplaying-info").each(function(){
                    var artist = $(this).find("property").eq(0).text();
                    var title = $(this).find("property").eq(1).text();
                    $('body').html("<h1>" + artist + "<small class=\"song-title\">" + title + "</small></h1>");
                    console.log (artist);
                    console.log (title);
                });
            }
        );
    }
</script>
<body>

</body> 
```

在尝试做此类事情时，任何指导、建议或最佳实践示例将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-20T05:18:59.263

我不确定这是否是您想要的，但您可以简单地使用属性选择器从 XML 文档中提取您想要的数据。

[http://jsfiddle.net/P8dc6/](http://jsfiddle.net/P8dc6/)

```
$.get("http://publicapi.streamtheworld.com/public/nowplaying?mountName=KROXFM&numberToFetch=1&eventType=track", 
    "xml",
    function(data) {
        var $nowPlaying = $(data).find('nowplaying-info');
        console.log($nowPlaying.find('[name=track_artist_name]').text());
        console.log($nowPlaying.find('[name=cue_title]').text());
    }
); 
```

此外，永远不要将 a 传递`string`给`setInterval`or `setTimeout`，您可以直接传递函数引用：

```
setInterval(songPull ,1000); 
```

# c - sscanf 在以字符 n 或 i 开头的字符串中搜索 float 时返回 1

> ID：16115212
> 
> 赞同：2
> 
> 时间：2013-04-20T00:19:18.797
> 
> 标签：c, scanf

在下面的代码中，我希望 sscanf 返回 0，但它返回 1 并将 0.000000 分配给浮点变量 x。当字符串以字母 i 开头但没有其他字母时，也会发生相同的行为。

```
void main() {
    int ss_return;
    float x;
    char str_to_sscanf[] = "noduh";

    ss_return = sscanf( str_to_sscanf, "%f", &x );

    printf( "\n\nThe word passed to sscanf is %s", str_to_sscanf );
    printf( "\n\nWhen looking for a float, sscanf returned %d", ss_return );
    printf( "\n\nand assigned %f to x (declared as float)", x );
    printf( "\n\nWHY DID sscanf NOT RETURN ZERO????" );
} 
```

程序的输出是：“两个奇怪的字符”duh

我错过了什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-20T00:37:49.047

我的猜测是，您的库的状态机将“n”视为“NaN”的可能开始，将“i”视为“inf”的可能开始，这使其落入浮点转换代码中。然后它立即退出，因为它无法完成解析并分配一个默认值。

# python - “for”循环中的索引超出范围

> ID：16115215
> 
> 赞同：0
> 
> 时间：2013-04-20T00:19:53.463
> 
> 标签：python, for-loop, indexing, arcgis

我正在研究将 csv 文件转换为 ArcGIS shapefile 的项目，这涉及将输出写入单独的文件。我为每一行中的每一列创建了一个列表，并试图索引第 36 和 37 列。但是，`list index out of range`这样做时我收到一条错误消息。关于我可能在做什么的任何建议？

```
while line:
    count = count + 1
    line = inFile.readline()
    print 'Row', count, 'line info=', line[:72]
    lineList = line.split(',')
    newList = lineList[:72]
    print 'line info =', newList   
    for item in newList[36]:
        item.replace("", "0")
    for item in newList[37]:
        item.replace("", "0")
    newLine = ','.join(newList)
    newLine = newLine + '\n'   
    formatLine = newLine.replace("/","_")
    outFile.write(formatLine) 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-20T00:33:06.043

如果您可以编辑问题以包含错误所说的索引超出范围问题的哪一行，这将有所帮助。

我相信问题很可能是这样的：

```
while line: # line is something other than whitespace
    line = inFile.readline() # next line becomes whitespace, there might be a trailing newline character in the file
    ...
    newList = line.split(',')[:72] # Even if line.split(',') doesn't return a list with at least 72 values, there will not be an error here- it will merely return a shorter list.
    for item in newList[36]: # newList is probably an empty list at this point.
    ... 
```

在旁注中，我在 Python shell 中输入了以下内容：

```
>>> bool("")
False
>>> bool(" ")
True
>>> bool("\n")
True 
```

正如你所看到的，如果有一行只有一个空格，那么循环也会继续。

# javascript - 从 DOM 中插入删除元素

> ID：16115216
> 
> 赞同：0
> 
> 时间：2013-04-20T00:19:56.527
> 
> 标签：javascript, html, dom, angularjs

`div`我有一个代码，每当用户单击按钮时都会插入带有内容的内容。从 DOM 中插入或删除元素的 angularjs 方法是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-20T03:05:47.777

如果您要添加的元素在某种程度上与按钮相关或靠近按钮，请使用指令。通常所有 DOM 操作都由指令执行。

但是，这条规则似乎有一个例外：如果您想插入类似于模式对话框的东西——即，不必放置在特定位置的东西——您可能想要使用服务。听[几分钟米斯科](http://www.youtube.com/watch?v=ZhfUv0spHCY&feature=youtu.be&t=28m30s)关于这个的内容。

如果您确实想要一个对话框，请参阅[http://angular-ui.github.io/bootstrap/#/dialog](http://angular-ui.github.io/bootstrap/#/dialog)，这是一个在 plunker 中使用它的[SO 答案。](https://stackoverflow.com/a/15653255/215945)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-22T15:19:20.313

您应该始终使用指令来操作 DOM，尤其是当数据来自控件时

# serial-port - com0com 拦截 opos 打印机 x 离线

> ID：16115219
> 
> 赞同：0
> 
> 时间：2013-04-20T00:20:20.810
> 
> 标签：serial-port, thermal-printer, opos, com0com

我们正在尝试拦截 pos 和打印机之间的数据。

我们遇到的问题是当我们将打印机 x 连接到 com0com 端点时，POS 报告打印机 x 处于脱机状态。

com0com 端点两侧的超级终端实例确实相互通信。

我从来不知道有一种方法可以检测硬件是否实际连接到串行端口。通常，无论是否有设备在侦听，我都会写入 com 端口。我知道 pos 使用 opos，因为它是与打印机通信的基本方式。opos 触发什么事件以通知 pos 应用程序认为打印机离线？硬件如何识别设备是否已连接？使用 com0com 时是否有规避此事件的方法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-22T20:49:30.570

OPOS 遵循三个步骤过程：Open()、ClaimDevice() 和 Enable。调用 Open() 将导致 OPOS 公共控制对象 (OPOS CCO) 构造供应商提供的设备特定服务对象 (SO)，然后它将调用 SO 上的 Open() 方法。这会初始化软件，但此时可能不会尝试与设备对话。

ClaimDevice() 与 SO 协商以确保设备可共享且可供应用程序使用。正是在这个时候，设备可以被报告离线。ClaimDevice() 将引发异常，ResultCode 指示 OPOS_E_OFFLINE。

如果设备处于脱机状态，将启用设置为 true 或执行打印活动可能会使呼叫失败。例如，有人可能会在打印过程中拔掉打印机电源。

SO 负责执行与设备的协商和通信。供应商提供的 OPOS 安装包通常会为您安装和配置 SO。但您有责任确保正确配置 SO 以与正确的端口和设备通信。如果配置不正确，调用 ClaimDevice() 时会出现设备离线错误。

# architecture - 编写第一个 Angular 应用程序。我应该如何构建这个？

> ID：16115222
> 
> 赞同：0
> 
> 时间：2013-04-20T00:20:31.983
> 
> 标签：architecture, angularjs, controller

在弄乱了一些基本的待办事项类型应用程序之后，我正在编写我的第一个角度应用程序，并且很好奇从高层次构建控制器的正确方法是什么。

该应用程序将允许用户从地块中动态添加/删除房屋，并且每个房屋中都可以有房间，并且该房屋中的每个房间都可以在其中放置产品。房屋、房间和产品都可以即时添加/删除，一个房屋的房间可以移动到其他房屋。

我第一次通过它让我想我需要一个家庭控制器（所有家庭的集合），然后是每个家庭的控制器。房间和产品也是如此。所有房间的控制器，然后每个房间的控制器。

这是最好的方法吗？我是从骨干的角度来看的，但想遵循 Angular 规定的指导方针，但在网上看不到任何这样做的东西。

任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-20T02:44:17.337

我建议你首先考虑你的模型，然后是你的视图，最后是你的控制器。

您的模型可能应该在服务中，而不是控制器中。（这样，如果多个视图需要访问相同的模型数据，与这些视图关联的控制器可以简单地注入服务来访问共享数据/模型。）

将您的页面分解为单独的视图。将控制器附加到每个视图，并让控制器仅从注入的服务中获取它需要的模型数据，以便视图可以完成其工作。使控制器尽可能薄。

（以上大部分内容来自我写的[另一个答案。）](https://stackoverflow.com/a/14994393/215945)

# jquery - jquery fancybox firefox 尺寸问题

> ID：16115224
> 
> 赞同：1
> 
> 时间：2013-04-20T00:20:41.473
> 
> 标签：jquery, fancybox

我正在使用 jquery fancybox 在我的网站上显示覆盖视频。以下 jquery 代码在 Chrome 中运行良好，但在 Firefox 中，视频被缩小了，包含视频的容器的尺寸也被缩小了。以下是jquery代码

```
$('.fancybox-media').fancybox({
    'type': 'iframe',
    'width': 800,
    'height': 580,
    'autoDimensions':   false,
    helpers     : {
         media: true
    }
}); 
```

下面是来自 chrome 和 firefox 的图片

![铬图像](https://i.stack.imgur.com/Z2Wth.png)

![火狐图片](https://i.stack.imgur.com/iK0W0.png)

在这方面的任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-22T01:27:58.520

如果您正在使用`type : "iframe"`，则可能不需要使用`media helpers`（实际上将内容移动到 中`iframe`）。

此外，如果您希望 fancybox 保持固定尺寸，则需要添加`fitToView: false`，否则 fancybox 将调整大小以适应较小屏幕的视口。

此外，您可能需要禁用`iframe preload`以避免在内容未完全加载时出现一些已知问题（浏览器可能会以不同的方式处理大小计算）

所以这段代码应该可以在 Firefox、Chrome 甚至 IE7+ 中发挥作用：

```
$('.fancybox-media').fancybox({
    type: 'iframe',
    width: 800,
    height: 580,
    // add
    fitToView: false,
    iframe : {
      preload : false
    }
}); 
```

# css - 对 CSS 代码进行升序排序

> ID：16115226
> 
> 赞同：0
> 
> 时间：2013-04-20T00:20:51.950
> 
> 标签：css, sorting, optimization, stylesheet, notepad++

我正在尝试对我的 CSS 代码进行排序，但没有运气。
我有超过 2000 行的 CSS 代码，因此无法手动对它们进行排序。

例如，我想对此进行排序：

```
#sidebar{color:#aaa}
body{font-size:20px}
#sidebar .h3{color:#555}
footer{border:solid 1px #eee} 
```

...进入这个：

```
body{font-size:20px}
footer{border:solid 1px #eee}
#sidebar{color:#aaa}
#sidebar .h3{color:#555} 
```

有没有记事本++的插件或任何在线网站可以做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-20T00:28:57.170

一个简单的谷歌搜索产生了几个“排序”选项

[http://www.cleancss.com/](http://www.cleancss.com/)

[http://www.styleneat.com/](http://www.styleneat.com/)

如果您正在谈论“缩短”您的文件，那么@Sunyatasattva 有使用缩小的正确方法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-20T00:43:39.410

如果要排序，则需要 Notepad++ 插件：

1.  菜单 => 插件 => 插件管理器 => 显示插件管理器

2.  可用 => =>在询问时`TextFX Characters`按下并重新启动 Notepad++（保存您的工作）。`Install`

3.  选择要排序的文本

4.  Menu => TextFX Tools => Sort lines *（这里有多个选项）

    ![在此处输入图像描述](https://i.stack.imgur.com/RHkeJ.jpg)

当然，[适当的编辑器](http://www.vim.org/)将具有此内置功能；）

# java - 下载 Java 类文件并运行？

> ID：16115229
> 
> 赞同：1
> 
> 时间：2013-04-20T00:21:08.720
> 
> 标签：java

好的，我正在尝试为我的 Java 类文件添加安全性。我不希望它被反编译。所以我所做的是创建了一个登录系统，Java 应用程序通过 Web 请求对其进行检查。如果登录信息正确，那么它将运行脚本。但是，我想进一步提高安全性并在线托管类文件。

如何让它下载并运行在线托管文件？

此外，当应用程序/脚本停止运行或关闭时，.class 文件将被删除。

我更喜欢不必下载文件的地方，只需从在线服务器获取并编译/运行。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-20T01:02:32.617

让我们来看看你做过的事情，以及你打算做的事情，看看它们是否真的有效：

*   要求输入密码。这很容易击败：
    1.  捕获类文件。
    2.  反编译它。
    3.  确定进行远程调用的位置进行登录检查，并检查响应。
    4.  修改字节码以删除所有这些。
*   无需安装类文件，而是按需下载并在完成后将其删除。也很容易被打败。
    1.  捕获下载文件的网络请求。
    2.  使用 (say) `curl`or重放请求`wget`并捕获下载的类文件。
    3.  如上进行。

并且变体也相对容易被击败：

*   混淆最终总是可以通过**手动**反编译和/或使用调试器运行字节码来解决。
*   通过对过程进行逆向工程并在使用一次性密钥之前提取一次性密钥，可以击败使用一次性密钥或其他方式进行下载。
*   加密字节码可能会失败，因为 JVM 必须在某些时候将字节码解密为解密形式。因此，字节码的解密手段必须嵌入在可以被逆向工程的代码中。

* * *

底线是，不可能阻止熟练和坚定的人击败依赖于对控制他/她自己的执行平台的用户保密的安全方案。

您能做的最好的事情就是阻止低技能的攻击者，并减慢熟练的攻击者的速度。你需要问问自己……真的值得付出努力吗？

（注意：无论您使用哪种实现语言，都会遇到同样的问题。）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-20T00:34:42.983

创建一个新的[URLClassLoader](http://docs.oracle.com/javase/7/docs/api/java/net/URLClassLoader.html)（“默认”Java 类加载器）并将其指向您保存文件的位置：

```
// the directory where you're saving the .class file
File tmpDir = new File("/tmp/yadda/blah/");
ClassLoader cl = new URLClassLoader(new URL[] { tmpDir.toURI().toURL() }, Thread.currentThread().getContextClassLoader());
Class<?> cls = cl.loadClass("SuperSecretClass");
// use reflection to instantiate cls, call methods, etc. 
```

（在非 web 应用程序中可能不需要传入父类加载器，但我懒得测试那个细节。显式使用线程的类加载器会以一种或另一种方式工作。

这假设您的秘密类不在包中，如果是，则必须在临时目录中创建适当的目录结构，并将类加载器指向包树的根目录，就像往常一样。

另外：这种隐蔽的安全性听起来是个坏主意。您仍在下载文件，如果它通过不安全的连接，确定的攻击者可以嗅探它，并且仍然有一段时间它在磁盘上。您*可以*创建一个`ClassLoader`直接读取流的完全自定义，但即使是类文件也可能需要更多的努力才能恢复。（就像将调试器指向您的主应用程序并拦截流读取一样。）[javadoc for`ClassLoader`](http://docs.oracle.com/javase/7/docs/api/java/lang/ClassLoader.html)提供了如何执行此操作的示例。

# java - Java 计算器历史功能

> ID：16115230
> 
> 赞同：1
> 
> 时间：2013-04-20T00:21:40.070
> 
> 标签：java, history, calculator

我希望有人可以帮助我提供一项功能，该功能可以将我的计算器的历史记录存储为字符串，并在用户按下 H 键时显示历史记录。我正在寻找它来记录按下的每个按钮，包括操作员。任何帮助表示赞赏。谢谢。

```
public class GUI extends JPanel implements KeyListener {

private JButton b1;
private JButton b2;
private JButton b3;
private JButton b4;
private JButton b5;
private JButton b6;
private JButton b7;
private JButton b8;
private JButton b9;
private JButton b0;
private JButton add;
private JButton subtract;
private JButton multiply;
private JButton divide;
private JButton solve;
private JButton clear;
private JButton decimal;
private JButton sqrt;
private JButton recip;
private JButton backSpace;
private JButton ms;
private JButton mr;
private JButton mc;
private JButton percent;
private JButton love;
private JTextField jtf;
String display = "";
String mStore;
String history;
boolean multiplyBool = false;
boolean divideBool = false;
boolean addBool = false;
boolean subtractBool = false;
boolean percentBool = false;
ImageIcon heart = new ImageIcon("heartt.png");

private CalcLogic cl = new CalcLogic();

public GUI(){
setLayout(new BorderLayout());

JPanel p3 = new JPanel(new BorderLayout());
p3.setFont(new Font("Arial", Font.BOLD, 30));
p3.add(jtf = new JTextField("0",12));
jtf.setEditable(false);
jtf.setHorizontalAlignment(JTextField.RIGHT);
jtf.setFont(new Font("Arial", Font.BOLD, 40));

JPanel p2 = new JPanel();
p2.setBackground(Color.CYAN);

p2.setLayout(new GridLayout(5,5,2,2));

//row 1 buttons

p2.add(mc = new JButton("MC"));
mc.setFont(new Font("Arial", Font.BOLD, 12));

p2.add(mr = new JButton("MR"));
mr.setFont(new Font("Arial", Font.BOLD, 12));

p2.add(ms = new JButton("MS"));
ms.setFont(new Font("Arial", Font.BOLD, 12));

p2.add(divide = new JButton("\u00F7"));
divide.setFont(new Font("Arial", Font.PLAIN, 20));

p2.add(backSpace = new JButton("\u2190"));
backSpace.setFont(new Font("Arial Bold", Font.BOLD, 18));

//row 2 buttons

p2.add(b7 = new JButton("7"));
b7.setFont(new Font("Arial", Font.PLAIN, 20));

p2.add(b8 = new JButton("8"));
b8.setFont(new Font("Arial", Font.PLAIN, 20));

p2.add(b9 = new JButton("9"));
b9.setFont(new Font("Arial", Font.PLAIN, 20));

p2.add(multiply = new JButton("\u00D7"));
multiply.setFont(new Font("Arial", Font.PLAIN, 20));

p2.add(sqrt = new JButton("\u221A"));
sqrt.setFont(new Font("Arial", Font.PLAIN, 20));

//row 3 buttons

p2.add(b4 = new JButton("4"));
b4.setFont(new Font("Arial", Font.PLAIN, 20));

p2.add(b5 = new JButton("5"));
b5.setFont(new Font("Arial", Font.PLAIN, 20));

p2.add(b6 = new JButton("6"));
b6.setFont(new Font("Arial", Font.PLAIN, 20));

p2.add(subtract = new JButton("\u2212"));
subtract.setFont(new Font("Arial", Font.PLAIN, 20));

p2.add(recip = new JButton("1/x"));
recip.setFont(new Font("Arial", Font.PLAIN, 14));

//row 4 buttons

p2.add(b1 = new JButton("1"));
b1.setFont(new Font("Arial", Font.PLAIN, 20));

p2.add(b2 = new JButton("2"));
b2.setFont(new Font("Arial", Font.PLAIN, 20));

p2.add(b3 = new JButton("3"));
b3.setFont(new Font("Arial", Font.PLAIN, 20));

p2.add(add = new JButton("+"));
add.setFont(new Font("Arial", Font.PLAIN, 20));

p2.add(percent = new JButton("%"));
percent.setFont(new Font("Arial", Font.PLAIN, 20));

//row 5 buttons

p2.add(b0 = new JButton("0"));
b0.setFont(new Font("Arial", Font.PLAIN, 20));

p2.add(decimal = new JButton("."));
decimal.setFont(new Font("Arial", Font.PLAIN, 20));

p2.add(clear = new JButton("C"));
clear.setFont(new Font("Arial", Font.PLAIN, 20));

p2.add(solve = new JButton("="));
solve.setFont(new Font("Arial", Font.PLAIN, 20));

p2.add(love = new JButton(heart));
love.addActionListener(new LoveListener());

add(p3, BorderLayout.NORTH);
add(p2, BorderLayout.CENTER);
this.setFocusable(true);
addKeyListener(this);

ActionListener buttonListener = new buttonListener();

ActionListener ClearListener = new ClearListener();

b7.addActionListener(buttonListener);
b8.addActionListener(buttonListener);
b9.addActionListener(buttonListener);
add.addActionListener(new addListener());
b4.addActionListener(buttonListener);
b5.addActionListener(buttonListener);
b6.addActionListener(buttonListener);
subtract.addActionListener(new subtractListener());
b1.addActionListener(buttonListener);
b2.addActionListener(buttonListener);
b3.addActionListener(buttonListener);
multiply.addActionListener(new multiplyListener());
b0.addActionListener(buttonListener);
decimal.addActionListener(buttonListener);
clear.addActionListener(ClearListener);
solve.addActionListener(new solveListener());
divide.addActionListener(new divideListener());
sqrt.addActionListener(new sqrtListener());
recip.addActionListener(new recipListener());
backSpace.addActionListener(new backSpaceListener());
ms.addActionListener(new msListener());
mr.addActionListener(new mrListener());
mc.addActionListener(new mcListener());
percent.addActionListener(new percentListener());

} //GUI()

    private void action_clear(){

jtf.setText("");
display = jtf.getText();
//op = "";
cl.setTotal("0");
multiplyBool = false;
addBool = false;
subtractBool = false;
divideBool = false;

    }

    public class buttonListener implements ActionListener
    {   
public void actionPerformed(ActionEvent e)
{       
    String digit = e.getActionCommand();

    jtf.setText(display + digit );
    display = jtf.getText();
    playSound("Click.wav");
}
    }//buttonListener

    public class multiplyListener implements ActionListener
    {
private CalcLogic cl = new CalcLogic();

public void actionPerformed(ActionEvent e)
{   
    if(multiplyBool == true)
    {   
        if (percentBool==true)
        {
            cl.percentage(display);
            display = cl.getPercent();
        }
        cl.multiply(display);
        jtf.setText(cl.getString());
        display = "";
    }else if(divideBool == true)
    {
        if (percentBool==true)
        {
            cl.percentage(display);
            display = cl.getPercent();
        }
        cl.divide(display);
        jtf.setText(cl.getString());
        display = "";
    }else if(addBool == true)
    {
        if (percentBool==true)
        {
            cl.percentage(display);
            display = cl.getPercent();
            cl.percMult(display);
            display = cl.getPercent();

        }

        cl.add(display);

        jtf.setText(cl.getString());
        display = "";
    }else if (subtractBool == true)
    {
        if (percentBool==true)
        {
            cl.percentage(display);
            display = cl.getPercent();
            cl.percMult(display);
            display = cl.getPercent();
        }
        cl.subtract(display);
        jtf.setText(cl.getString());
        display = "";
    }else 
    {
    cl.setTotal(display);
    jtf.setText("");
    multiplyBool = true;
    divideBool = false;
    addBool = false;
    subtractBool = false;
    percentBool = false;
    display = "";
    }

    multiplyBool = true;
    divideBool = false;
    addBool = false;
    subtractBool = false;
    percentBool = false;
}

    }

    public class divideListener implements ActionListener
   {
public void actionPerformed(ActionEvent e)
{
    if(multiplyBool == true)
    {   
        if (percentBool==true)
        {
            cl.percentage(display);
            display = cl.getPercent();
        }
        cl.multiply(display);
        jtf.setText(cl.getString());
        display ="";
    }else if(divideBool == true)
    {
        if (percentBool==true)
        {
            cl.percentage(display);
            display = cl.getPercent();
        }
        cl.divide(display);
        jtf.setText(cl.getString());
        display = "";
    }else if(addBool == true)
    {
        if (percentBool==true)
        {
            cl.percentage(display);
            display = cl.getPercent();
            cl.percMult(display);
            display = cl.getPercent();

        }

        cl.add(display);

        jtf.setText(cl.getString());
        display = "";
    }else if (subtractBool == true)
    {
        if (percentBool==true)
        {
            cl.percentage(display);
            display = cl.getPercent();
            cl.percMult(display);
            display = cl.getPercent();
        }
        cl.subtract(display);
        jtf.setText(cl.getString());
        display = "";
    }else
    {
    cl.setTotal(display);
    jtf.setText("");
    divideBool = true;
    multiplyBool = false;
    addBool = false;
    subtractBool = false;
    percentBool = false;
    display = "";
    }

    multiplyBool = false;
    divideBool = true;
    addBool = false;
    subtractBool = false;
    percentBool = false;
}
    }
    public class addListener implements ActionListener
    {
public void actionPerformed(ActionEvent e)
{
    if(multiplyBool == true)
    {   
        if (percentBool==true)
        {
            cl.percentage(display);
            display = cl.getPercent();
        }
        cl.multiply(display);
        jtf.setText(cl.getString());
        display ="";
    }else if(divideBool == true)
    {
        if (percentBool==true)
        {
            cl.percentage(display);
            display = cl.getPercent();
        }
        cl.divide(display);
        jtf.setText(cl.getString());
        display = "";
    }else if(addBool == true)
    {
        if (percentBool==true)
        {
            cl.percentage(display);
            display = cl.getPercent();
            cl.percMult(display);
            display = cl.getPercent();

        }

        cl.add(display);

        jtf.setText(cl.getString());
        display = "";
    }else if (subtractBool == true)
    {
        if (percentBool==true)
        {
            cl.percentage(display);
            display = cl.getPercent();
            cl.percMult(display);
            display = cl.getPercent();
        }
        cl.subtract(display);
        jtf.setText(cl.getString());
        display = "";
    }else
    {
    cl.setTotal(display);
    jtf.setText("");
    divideBool = false;
    multiplyBool = false;
    addBool = true;
    subtractBool = false;
    percentBool = false;
    display = "";
    }

    divideBool = false;
    multiplyBool = false;
    subtractBool = false;
    addBool = true;
    percentBool = false;

}
    }//addListener

    public class subtractListener implements ActionListener
    {
public void actionPerformed(ActionEvent e)
{
    if(multiplyBool == true)
    {   
        if (percentBool==true)
        {
            cl.percentage(display);
            display = cl.getPercent();
        }
        cl.multiply(display);
        jtf.setText(cl.getString());
        display ="";
    }else if(divideBool == true)
    {
        if (percentBool==true)
        {
            cl.percentage(display);
            display = cl.getPercent();
        }
        cl.divide(display);
        jtf.setText(cl.getString());
        display = "";
    }else if(addBool == true)
    {
        if (percentBool==true)
        {
            cl.percentage(display);
            display = cl.getPercent();
            cl.percMult(display);
            display = cl.getPercent();

        }

        cl.add(display);

        jtf.setText(cl.getString());
        display = "";
    }else if (subtractBool == true)
    {
        if (percentBool==true)
        {
            cl.percentage(display);
            display = cl.getPercent();
            cl.percMult(display);
            display = cl.getPercent();
        }
        cl.subtract(display);
        jtf.setText(cl.getString());
        display = "";
    }else
    {
    cl.setTotal(display);
    jtf.setText("");
    divideBool = false;
    multiplyBool = false;
    addBool = false;
    subtractBool = true;
    percentBool = false;
    display = "";
    }
    divideBool = false;
    multiplyBool = false;
    addBool = false;
    subtractBool = true;
    percentBool = false;

}
    }//subtractListener

    public class sqrtListener implements ActionListener
    {
public void actionPerformed(ActionEvent e)
{
    cl.setTotal(display);
    cl.squareRoot(display);
    jtf.setText(cl.getString());
    playSound("Click.wav");
}
    }

    public class recipListener implements ActionListener
    {
public void actionPerformed(ActionEvent e)
{
    cl.setTotal(display);
    cl.reciprical(display);
    jtf.setText(cl.getString());
    playSound("Click.wav");
}
    }

    public class backSpaceListener implements ActionListener
    {
public void actionPerformed(ActionEvent e)
{
    jtf.setText("");
    display = "";
}

    }

    public class msListener implements ActionListener
    {
public void actionPerformed(ActionEvent e)
{
    mStore = jtf.getText();
}
    }

    public class mrListener implements ActionListener
    {
public void actionPerformed(ActionEvent e)
{
    jtf.setText(mStore);
    display = mStore;

}
    }

    public class mcListener implements ActionListener
    {
public void actionPerformed(ActionEvent e)
{
    mStore = "";
}
    }

    public class percentListener implements ActionListener
    {
public void actionPerformed(ActionEvent e)
{

    percentBool = true;
}
    }

    public class solveListener implements ActionListener
    {
public void actionPerformed(ActionEvent e)
{
    playSound("that_was_easy.wav");

    if(multiplyBool == true)
    {   
        if (percentBool==true)
        {
            cl.percentage(display);
            display = cl.getPercent();
        }
        cl.multiply(display);
        jtf.setText(cl.getString());
    }else if(divideBool == true)
    {
        if (percentBool==true)
        {
            cl.percentage(display);
            display = cl.getPercent();
        }
        cl.divide(display);
        jtf.setText(cl.getString());
    }else if(addBool == true)
    {
        if (percentBool==true)
        {
            cl.percentage(display);
            display = cl.getPercent();
            cl.percMult(display);
            display = cl.getPercent();

        }

        cl.add(display);

        jtf.setText(cl.getString());
    }else if (subtractBool == true)
    {
        if (percentBool==true)
        {
            cl.percentage(display);
            display = cl.getPercent();
            cl.percMult(display);
            display = cl.getPercent();
        }
        cl.subtract(display);
        jtf.setText(cl.getString());
    }
    multiplyBool = false;
    addBool = false;
    subtractBool = false;
    divideBool = false;
    percentBool = false;

    //display = jtf.getText();

}

    }

public class ClearListener implements ActionListener
    {
public void actionPerformed(ActionEvent e)
{
    action_clear();
    playSound("Click.wav");
}//ClearListener

    }
public void keyTyped(KeyEvent e){

if(e.getKeyCode() == KeyEvent.VK_H){
    System.out.println(history);
)
public void keyTyped(KeyEvent e){

}
public void keyReleased(KeyEvent e){   

}
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-20T02:02:26.923

只需在擦除之前将每个单行计算器命令作为字符串存储到数组中。然后当你按 H 时显示它。

例如：

> Array array = new Array(5) **（您也可以使用集合类使其动态且更高效）**

```
123 (Line#1 in calculator) >> array[0]
+ (Line#2 in calculator) >> array[1]
34567 (Line#3 in calculator) >> array[2]
% (Line#4 in calculator) >> array [3]
345 (Line#5 in calculator) >> array [4] 
```

等等等等。

问候，

# javascript - 尝试使用 Javascript 在 HTML 标记中显示数据库中的数据

> ID：16115233
> 
> 赞同：0
> 
> 时间：2013-04-20T00:21:49.477
> 
> 标签：javascript, html

我试图在我的主页中调用一个函数，该函数将在页面加载之前将 HTML 中的文章内容从占位符更改为来自数据库的信息。但是，我不断收到错误消息，说我缺少形式参数。我做错了什么？

的HTML：

```
<article id="article1">
    <img src="images/sadface.png" alt="The image didn't load, sorry" id="img0">
    <h4 id="heading0">Not working</h4>
    <p id="p0">This item hasn't loaded, sorry</p>
    <script>
        window.onload = function splashFunction(0);
    </script>
</article> 
```

和 Javascript：

```
function splashFunction(x){

document.getElementById("img" + x).src="images/cart2.jpg";

document.getElementById("heading" + x).innerHTML="cart";

document.getElementById("p" + x).innerHTML="cart";
}; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-20T00:24:40.630

为了通过调用数据库来更改 DOM，您必须使用[AJAX](https://en.wikipedia.org/wiki/Ajax_%28programming%29)，我希望您知道这一点。

至于您的代码，您将`function`再次定义 on `window.onload`。要调用该函数，只需使用其名称，如下所示：

```
window.onload = splashFunction(0); 
```

# parsing - LR解析算法中的负前瞻

> ID：16115234
> 
> 赞同：2
> 
> 时间：2013-04-20T00:21:50.150
> 
> 标签：parsing, generator, conflict, resolve, negative-lookahead

考虑 LR 系列解析生成器（例如 YACC、BISON 等）的语法规则：

```
Nonterminal : [ lookahead not in {Terminal1, ..., TerminalN} ] Rule ; 
```

这是一条普通的规则，只是它有一个限制：用这条规则产生的短语不能以 . 开头`Terminal1, ..., TerminalN`。（当然，这个规则可以用一套常用的规则来代替，但它会导致更大的语法）。这对于解决冲突很有用。

问题是，是否存在接受此类限制的 LR 表构造算法的修改？在我看来，这样的修改是可能的（如优先关系）。

当然，它可以在运行时检查，但我的意思是编译时检查（在构建解析表时执行的检查，如yacc兼容生成器中的 、 和指令`%prec`。）`%left``%right``%nonassoc`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-21T06:02:41.783

我不明白为什么这是不可能的，但我也看不出有任何明显的理由说明它会有用。你有一个例子吗？

最简单的方法是进行括号中提到的语法转换。这会产生更大的语法，但不会人为地增加 LR 状态的数量。

基本的转变，只需要一点点挥手：

对于任何有终端限制的生产：

*   如果生产以不可为空的非终端开始，请将非终端替换为终端限制版本。

*   如果生产以终端限制列表中的终端开始，则删除生产

*   如果生产以不在终端限制列表中的终端开始，则无需更改。

如果产生式以可空非终结符开头，则必须创建可空非终结符的两个版本，一个始终为空，另一个不可为空；然后创建两个版本的产品，一个从每个新的非终端开始。然后应用上述转换，但将“开始于”解释为“在任何始终为空的非终结符之后开始”。

您实际上不需要修改语法，因为上述转换可以在底层 SLR 机器的构建过程中即时完成，至少对于 LR(0) 和 LALR(1) 构造。

# javascript - 访问模板内的角度指令（元素）的文本

> ID：16115238
> 
> 赞同：9
> 
> 时间：2013-04-20T00:23:00.903
> 
> 标签：javascript, angularjs, angularjs-directive

所以我正在关注[这个关于自定义组件的 EggHead.io 教程](http://www.youtube.com/watch?v=A6wq16Ow5Ec)，我遇到了这个问题。声明指令时，例如：

```
angular.module('myApp', [])
    .directive('myDir', function(){
        return {
            restrict: "E",
            controller: "myController",
            link: function(scope, element, attrs) {
                scope.foo = element.text();
            },
            templateUrl: "myDirTemplate.html"
        }
    }); 
```

模板是：

```
<div>The value is: {{foo}}</div> 
```

以及正在使用的指令如下：

```
<html>
...
<myDir>Bar</myDir> 
...
</html> 
```

**链接函数*中的*元素*是指*

 *```
<div>The value is: {{foo}}</div> 
```

在模板中。如果我没有指定*templateUrl*，那么*element*指的是

```
<myDir>Bar</myDir> 
```

在主视图中，这就是我想要的。我希望该指令将“Bar”文本插入 {{foo}} 中，最终结果为：

```
<div>The value is: Bar</div> 
```

但我不知道如何绕过每次选择模板元素的角度。

有任何想法吗？

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2013-04-20T01:23:48.397

您需要使用[ngTransclude](http://docs.angularjs.org/api/ng.directive:ngTransclude)：

```
app.directive('myDir', function(){
  return {
    restrict: "E",
    transclude: true,
    templateUrl: "myDirTemplate.html",
    replace: true
  }
}); 
```

然后你的外部模板变成类似于：

```
<div>The value is: <span ng-transclude></span></div> 
```

在此处查看代码：[http ://plnkr.co/edit/EuT5UlgyxgM8d54pTpOr?p=preview](http://plnkr.co/edit/EuT5UlgyxgM8d54pTpOr?p=preview)*

# javascript - 多个 else if with indexOf

> ID：16115241
> 
> 赞同：-3
> 
> 时间：2013-04-20T00:23:05.193
> 
> 标签：javascript

我有以下代码：

```
var aaaa = exploded[1];

if (aaaa.indexOf("bbbb")>=0) { //Do something Here } 
```

一切都很好，但是当我添加时：

```
else if (aaaa.indexOf("cccc")>=0) { //Do something Else }
else if (aaaa.indexOf("dddd")>=0) { //Do something Else 2 }
else if (aaaa.indexOf("eeee")>=0) { //Do something Else 3 } 
```

我收到一条消息“aaaa 未定义”并且代码不会运行。我怎样才能解决这个问题？

谢谢

**编辑：**当我在 Stacoverflow 中写到这里时，评论花括号是一个错误，它与我的问题无关。我解决了我的问题，删除了第一个 else if 中丢失的花括号。问题解决了！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-20T00:30:01.220

工作正常：

```
var aaaa = "bbbb";

if (aaaa.indexOf("bbbb")>=0) { 
    alert('aa') ;
}
else if (aaaa.indexOf("cccc")>=0) { 
    alert('cc');
}
else if (aaaa.indexOf("dddd")>=0) { 
    alert('dd');
}
else if (aaaa.indexOf("eeee")>=0) { 
    alert('ee');
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-20T00:25:10.187

您通过不在单独的行上使用花括号来破坏您的代码 - 因为您使用的是单行注释，所以它也在注释您的最后一个花括号。

改变：

```
else if (aaaa.indexOf("cccc")>=0) { //Do something Else }
else if (aaaa.indexOf("dddd")>=0) { //Do something Else 2 }
else if (aaaa.indexOf("eeee")>=0) { //Do something Else 3 } 
```

至：

```
else if (aaaa.indexOf("cccc")>=0) {
    //Do something Else
}
else if (aaaa.indexOf("dddd")>=0) {
    //Do something Else 2
}
else if (aaaa.indexOf("eeee")>=0) {
    //Do something Else 3
} 
```

除此之外，一切看起来都很好。

# python - 批处理文件可以在 python shell 中执行命令吗？

> ID：16115242
> 
> 赞同：3
> 
> 时间：2013-04-20T00:23:06.887
> 
> 标签：python, batch-file

我可以使用批处理文件来启动 python shell 并执行命令吗？我知道

```
python 
```

将启动一个 python shell，但是一个批处理文件包含

```
python
1+1 
```

将首先运行python，然后只有当您退出python时才会尝试运行1+1。它不会在 python shell 中执行任何命令。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-20T00:50:42.207

经过一番搜索，我设法找到了这个有方法的[网站。](http://halotis.com/2009/08/21/running-python-code-in-windows-batch-file-trick/)正如您将在网站上看到的，您需要做的就是：

```
@setlocal enabledelayedexpansion && python -x "%~f0" %* & exit /b !ERRORLEVEL! 
#start python code here 
print "hello world" 
```

这对我不起作用，但我认为它可能会有所帮助。

我还没有找到任何其他来源说这是可能的。

只是想到了一些我没有测试过的东西。我结合了贝尔的答案和我的答案。

```
@for /f "skip=1 delims=" %i in (%0) do @python -c "%i"
#Start Python here. 
```

但是，应该使用其他方法。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-20T02:13:14.023

我知道这有一个可接受的答案，但您也可以尝试该命令的`-c`参数。将“2”打印到控制台。该标志的意思是“命令”，并由 python 立即解释。`python``python -c "print(1+1)"``-c`

# java - 从 Java 程序运行 Bash 以在 Raspberry Pi 上捕获网络摄像头图像

> ID：16115244
> 
> 赞同：1
> 
> 时间：2013-04-20T00:23:09.967
> 
> 标签：java, bash, webcam, image-capture

在我的 Raspberry Pi 上，我可以使用以下 bash 行从 LXTerminal 的 Logitech Pro 9000 USB 网络摄像头成功捕获和保存图像：

```
fswebcam -d /dev/video0 /home/pi/image.jpg 
```

我想编写一个运行上述 bash 行的 java 程序，因为它是捕获和保存图像的最简单方法。到目前为止，我有：

```
import java.io.*;

public class GrabNSave {
  public static void main(String[] args) throws IOException {
  Runtime.getRuntime().exec("/bin/bash -c fswebcam -d /dev/video0 /home/pi/image.jpg");
  }
} 
```

它不工作。我没有收到错误消息。请帮忙！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2014-08-10T22:45:38.297

首先，您需要**安装 fswebcam** ....

```
sudo apt-get install fswebcam 
```

然后，在您的 Java 程序中，您需要 **运行以下**命令：

```
Runtime.getRuntime().exec("fswebcam -d /dev/video0 /home/username/Desktop/test.jpg"); 
```

为我工作，希望它对你有用！=)

*顺便说一句，我一开始也有同样的问题.. =)*

祝你好运！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-21T19:02:36.900

`/bin/bash -c fswebcam -d /dev/video0 /home/pi/image.jpg`在 bash 中也不起作用，您需要添加引号，以便 bash 将命令作为单个参数接收：

```
 /bin/bash -c 'fswebcam -d /dev/video0 /home/pi/image.jpg' 
```

但我建议使用更简单的版本：

```
 Runtime.getRuntime().exec("fswebcam -d /dev/video0 /home/pi/image.jpg") 
```

或者，如果您需要在以下几行中更改参数：

```
 String[] command = {"fswebcam", "-d", "/dev/video0", "/home/pi/image.jpg"}
 Runtime.getRuntime().exec(command) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-05-04T14:24:23.770

如果您处理从 Process 获得的 InputStream，它应该可以工作：`

```
 Process process = Runtime.getRuntime().exec("sudo fswebcam -r 320x240 -d /dev/video0 /home/pi/apache-tomcat-7.0.37/webapps/co/cam1.jpg");
            InputStream ips = process.getErrorStream();

            int b = 0;
            while ((b = ips.read()) > 0) {
                // do something 
            } 
```

`

# php - 基于其他表单元素的表单元素验证

> ID：16115245
> 
> 赞同：0
> 
> 时间：2013-04-20T00:23:26.853
> 
> 标签：php, forms, zend-framework2, validation

我正在渲染一个表单以向数据库添加一个类（课程）。该类有一定的开始时间和结束时间。两者都是时间字段。我为该类创建了一个字段集：

```
<?php
namespace Admin\Form;

use Zend\Form\Fieldset;
use Zend\InputFilter\InputFilterInterface;
use Zend\InputFilter\InputFilterProviderInterface;

class ArtClassFieldset extends Fieldset implements InputFilterProviderInterface
{
    public function __construct()
    {
        parent::__construct('artclass');

        $this->add(array(
            'name'          => 'dayofweek',
            'type'          => 'Zend\Form\Element\Select',
            'options'       => array(
                'label'             => 'Day of week:',
                'value_options'     => array(
                    1           => 'Monday',
                    2           => 'Tuesday',
                    3           => 'Wednesday',
                    4           => 'Thursday',
                    5           => 'Friday',
                    6           => 'Saturday',
                ),
            ),
        ));

        $this->add(array(
                'name' => 'starttime',
                'type' => 'Zend\Form\Element\Time',
                'options' => array(
                    'label' => 'Start time:',
                    'format' => 'H:ia',
                ),
            )
        );

        $this->add(array(
                'name' => 'endtime',
                'type' => 'Zend\Form\Element\Time',
                'options' => array(
                    'label' => 'End time:',
                    'format' => 'H:ia',
                ),
            )
        );

        $this->add(array(
                'name' => 'teacher',
                'type' => 'Admin\Form\TeacherSelectorFieldset',
                'options' => array(
                    'label' => 'Teacher:',
                )
            )
        );
    }

    public function getInputFilterSpecification()
    {
        return array(
                'dayofweek' => array(
                    'required' => true,
                    'filters' => array(
                        array('name' => 'Int'),
                    ),
                    'validators' => array(
                        array(
                            'name' => 'Between',
                            'break_chain_on_failure' => true,
                            'options' => array(
                                'min' => 1,
                                'max' => 6, 
                            ),
                        ),
                    ),
                ),
                'starttime' => array(
                    'required' => true,
                ),
                'endtime' => array(
                    'required' => true,
                ),
                'teacher' => array(
                ),
        );
    }
} 
```

在我的 Form 类中，我只需将此字段集添加到我的表单中：

```
<?php 
namespace Admin\Form;

use Zend\Form\Form;

class ArtClassAdd extends Form
{
    public function __construct()
    {
        parent::__construct("artclass-add");
        $this->setAttribute('action', '/admin/artclass/add');
        $this->setAttribute('method', 'post');

        $this->add(array(
                'type' => 'Admin\Form\ArtClassFieldset',
                'options' => array('use_as_base_fieldset' => true)
            )
        );

        $this->add(array(
                'name' => 'submit',
                'attributes' => array(
                    'type' => 'submit',
                    'value' => 'Save'                   
                )
            )
        );
    }
} 
```

两个时间字段的格式是“H:ia”，这意味着我会得到类似“11:00am”的信息。我现在想做的是验证开始时间是否在结束时间之前。问题是我该怎么做？我想我可能应该使用 Zend\Validator\Callback，但不确定。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-20T00:46:31.177

你在正确的轨道上。您必须使用`Callback`验证器。`endtime`对输入规范使用类似的东西：

```
return array(
    'endtime' => array(
        'required' => true,
        'validators' => array(
            array(
                'name' => 'Callback',
                'options' => array(
                    'callback' => function($value, $context)
                    {
                        $endtime = DateTime::createFromFormat'H:ia', $value);
                        $starttime = DateTime::createFromFormat('H:ia', $context['starttime']);
                        return $endtime > $starttime;
                    }
                ),
            ),
        ),
    ),
); 
```

# python - 通过子类从超类调用Python方法未按预期工作

> ID：16115249
> 
> 赞同：0
> 
> 时间：2013-04-20T00:24:33.067
> 
> 标签：python, inheritance, polymorphism, pygame, duck-typing

我已经延长`pygame.Rect`了我的`Ball`班级。当我使用`nstanceOfBall.colliderect()`（第 66 行）时，不会抛出任何错误，但它永远不会返回 true。`colliderect`任何关于为什么不适用于我的 Ball 实例的见解？

```
 import sys, pygame
    import os
    import ball
    import random
    import math
    #from ball import Ball

    ###############################################################################################

    class Ball(pygame.Rect):
        def __init__(self, x, y, width, height, screenWidth, screenHeight):
            super(pygame.Rect,self).__init__(x, y, width, height)
            self.floatX=x
            self.floatY=x
            self.screenWidth=screenWidth
            self.screenHeight=screenHeight
            self.speed=[random.random()*5-2.5, random.random()*5-2.5]

        def runLogic(self):
            self.floatX+=self.speed[0]
            self.floatY+=self.speed[1]

            if self.floatX+16<0: self.floatX=self.screenWidth
            if self.floatX>self.screenWidth: self.floatX=-16
            if self.floatY+16<0: self.floatY=self.screenHeight
            if self.floatY>self.screenHeight: self.floatY=-16

            self.x=self.floatX
            self.y=self.floatY

    ###############################################################################################

    os.environ['SDL_VIDEO_WINDOW_POS'] = "%d,%d" % (700, 200)#1680,1440)

    pygame.init()

    size = width, height = 320, 240
    white = 255, 255, 255
    blue=0,0,255

    screen = pygame.display.set_mode(size)

    image = pygame.image.load("ball.png")
    ballRect=image.get_rect()
    balls = []

    for x in range(0, 100):
        balls.append(Ball(random.random()*width, random.random()*height, ballRect.width, ballRect.height, width, height))

    lastFrameStartTime=pygame.time.get_ticks()

    while 1:
        for event in pygame.event.get():
            if event.type == pygame.QUIT: 
                sys.exit()

            if event.type == pygame.KEYDOWN:
                if event.key == pygame.K_ESCAPE:
                    sys.exit()

        for ball in balls:
            ball.runLogic()

            for ball2 in balls:
                if ball != ball2:                
                    if ball.colliderect(ball2):
                        print("collision detected!")
                        balls.pop(balls.index(ball))
                        balls.pop(balls.index(ball2))
                        #balls.remove(ball2)

        screen.fill(blue)
        for ball in balls:
            screen.blit(image, ball)
        pygame.display.flip()

        pygame.time.wait(33-(pygame.time.get_ticks()-lastFrameStartTime))
        lastFrameStartTime=pygame.time.get_ticks() 
```

在 Ball.init 中使用 super(Ball, self) 而不是 super(pygame.Rect, self) 就可以了。

谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-20T08:18:26.037

第一个参数`super`必须是当前类，即`Ball`代替`pygame.Rect`：

```
class Ball(pygame.Rect):
    def __init__(self, x, y, width, height, screenWidth, screenHeight):
        super(Ball, self).__init__(x, y, width, height)
        ... 
```

[super](http://docs.python.org/2/library/functions.html#super)的文档中有一个示例。

关键`super`是它允许您按继承顺序调用下一个方法，而无需显式引用父类。这在使用多重继承时会派上用场，请参见例如[超级混乱的 python 多重继承 super()](https://stackoverflow.com/questions/11354786/super-confusing-python-multiple-inheritance-super)

# php - 将函数参数发送到另一个包含文件中的数组？

> ID：16115250
> 
> 赞同：0
> 
> 时间：2013-04-20T00:24:33.787
> 
> 标签：php, arrays, class, email, include

我正在尝试构建一个用户注册类，我在其中使用了一个语言文件，该文件已包含在我的类中。当用户尝试注册时，我希望我的班级向用户发送一封包含信息的电子邮件。但是，我在邮件功能中使用的文本来自语言文件。在这个语言文件中，我有一个数组，我在类中的函数中使用用户名 in 调用变量，但我似乎无法开始工作。我在互联网上搜索，但找不到任何解决方案。

如果您想知道我的语言文件是什么语言，我可以说它是丹麦语。

------ 类文件：

```
class User {
  #Variables for mail
  public $mail;
  private $LANG;        
  public function __construct(){
    global $RealName;
    require_once ('_lang/class.langdk.inc.php');
    require_once ('class.phpmailer.php');
    $this->LANG = $LANG;

  }

  public function registerUser($RealName,$UserEmail){
     echo 'Brugeren er oprettet med: ' . $this->LANG['welcome'];
  }
} 
```

在我的 class.langdk.inc.php 中，我有：

```
$LANG= array(
    #Mailsetup
    'welcome'      => 'Hej '. $RealName .', velkommen som bruger!',
); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-20T00:30:09.863

一种可能的方法：

```
echo 'Brugeren er oprettet med: ' . str_replace('$RealName', $RealName, $this->LANG['welcome']); 
```

和 ：

```
$LANG = array(
    'welcome' => 'Hej $RealName velkommen som bruger!'
); 
```

# java - 为“此”访问发出空检查？

> ID：16115251
> 
> 赞同：2
> 
> 时间：2013-04-20T00:24:34.257
> 
> 标签：java, android, dalvik, null-check

当您通过**this引用访问****自己的**实例字段时（例如，来自私有方法的or字段），生成的 Android Dalvik 字节码将包含一个字节码指令：**`object``int``iget`**

 **```
iget v2, p0, Lcom/example/myapp/MyClass;->status:I 
```

这是当您访问另一个对象的字段（即不是通过`this`指针）时发出的相同指令，因此它似乎无法区分其他对象和您自己。在字节码中，这是可以理解的，但 JIT 可以做得更多。

检查Android源代码，我没有看到JIT会自动消除这种情况下的空检查（即当您访问时`this`）。它在已经空检查的 Dalvik 寄存器的基本块中被消除，很好，但是（对我来说）它似乎也可以被消除`this`访问（即使它是基本块的第一条指令，或任何指令，因为`this`不能为空）。

我错过了什么？是出于安全/运行时类型安全的原因吗？或者我只是忽略了源代码？为什么 VM (JIT) 不能`this`以独特的方式处理？（我理解本机代码显然不能，因为`this`内存地址就像其他任何东西一样。）

* * *

编辑：据我所见，每次基本块在 dvm 中结束时，都会清除“已检查空”标志。我要说的是，保存*它*的寄存器的“已检查空”标志可以预先设置为 1（即使在基本块之间的转换期间也不需要清除该值）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-20T02:04:47.047

从字节码的角度来看，访问“this”对象上的字段与访问任何其他对象上的字段没有什么不同——您仍然必须传入一个包含“this”引用的寄存器。由于无法保证传入的寄存器实际上包含非空值，因此它仍然必须执行空性检查，就像对任何其他对象一样。**

# android - ViewHolder 模式的问题

> ID：16115252
> 
> 赞同：0
> 
> 时间：2013-04-20T00:24:35.700
> 
> 标签：android, performance

所以我在我的应用程序中使用了一个众所周知的 ViewHolder 模式。我的视图持有者：

```
protected static class ViewHolder{
    final ImageView itemImage;
    final TextView txtName;
    final TextView txtTitle;
    final WebView webView;

    public ViewHolder (final ImageView itemImage,  final TextView txtName, final TextView txtTitle, final WebView webView){
        this.itemImage = itemImage;
        this.txtName = txtName;
        this.txtTitle = txtTitle;
        this.webView = webView;
    }

    public ViewHolder (View convertView){
        itemImage = (ImageView) convertView.findViewById(R.id.fav_item_icon);
        txtName = (TextView) convertView.findViewById(R.id.fav_item_name);
        txtTitle = (TextView) convertView.findViewById(R.id.fav_item_title);
        webView = (WebView) convertView.findViewById(R.id.fav_webView);
    }
} 
```

因此，如果我将它与第一个构造函数一起使用，则一切正常，例如：

```
...
                public View getView(final int position, View convertView, final ViewGroup parent) {

                    final Searchable searchResultsItem = searchResults.get(position);

                    ViewHolder viewHolder = null;
                    if (convertView==null){
                        convertView = inflater.inflate(R.layout.search_list_item, null);

                        final ImageView itemImage = (ImageView) convertView.findViewById(R.id.search_item_icon);
                        final TextView txtName = (TextView) convertView.findViewById(R.id.search_item_name);
                        final TextView txtTitle = (TextView) convertView.findViewById(R.id.search_item_title);
                        final WebView webView = (WebView) convertView.findViewById(R.id.search_webView);
                        viewHolder = new ViewHolder(itemImage, txtName, txtTitle, webView);

                        convertView.setTag(viewHolder);
                    }else
                        viewHolder = (ViewHolder)convertView.getTag();

                    viewHolder.webView.setFocusable(false);
    ... 
```

但如果我尝试使用第二个构造函数失败：

```
...
                public View getView(final int position, View convertView, final ViewGroup parent) {

                    final Searchable searchResultsItem = searchResults.get(position);

                    ViewHolder viewHolder = null;
                    if (convertView==null){
                        convertView = inflater.inflate(R.layout.search_list_item, null);

                        viewHolder = new ViewHolder(convertView);
                        convertView.setTag(viewHolder);
                    }else
                        viewHolder = (ViewHolder)convertView.getTag();

                    viewHolder.webView.setFocusable(false);
    ... 
```

它在 line 处与 NPE 一起崩溃`viewHolder.webView.setFocusable(false)`。当我尝试调试时，它说创建的 ViewHolder 实例的所有字段都为空。为什么会发生这种情况？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-20T00:50:14.987

id似乎不同，这是故意的吗？
`final WebView webView = (WebView)convertView.findViewById(R.id.search_webView); R.id.search_webView` （这个有效）

和

`webView = (WebView) convertView.findViewById(R.id.fav_webView);
R.id.fav_webView`（这个不行）

# android - Android - 分享按钮没有响应

> ID：16115256
> 
> 赞同：0
> 
> 时间：2013-04-20T00:24:50.207
> 
> 标签：android, shareactionprovider

我有这个意图

```
 Button share = (Button)findViewById(R.id.share);
    share.setOnClickListener(new Button.OnClickListener() 
    {  
        public void onClick(View v) 
        {

                    //createShareIntent( );
        }
    }); 
```

以及类中的这两个方法：

```
@Override
public boolean onCreateOptionsMenu(Menu menu) 
{
    getMenuInflater().inflate(R.layout.menu, menu);
    MenuItem item = menu.findItem(R.id.menu_item_share);
    myShareActionProvider = (ShareActionProvider)item.getActionProvider();
    myShareActionProvider.setShareHistoryFileName(
      ShareActionProvider.DEFAULT_SHARE_HISTORY_FILE_NAME);
    myShareActionProvider.setShareIntent(createShareIntent());
    return true;
}

private Intent createShareIntent() 
{
       Intent shareIntent = new Intent(Intent.ACTION_SEND);
       shareIntent.setType("text/plain");
       shareIntent.putExtra(Intent.EXTRA_TEXT, 
         "testing");
       return shareIntent;
}

public void doShare(Intent shareIntent) 
{
    // When you want to share set the share intent.
    myShareActionProvider.setShareIntent(shareIntent);
} 
```

和这个 sdk 版本配置：

```
<uses-sdk android:minSdkVersion="4" android:targetSdkVersion="15"/> 
```

但我的问题是我不知道如何称呼它。单击共享按钮后，如何实际显示菜单？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-20T04:03:39.997

您可以通过调用`openOptionsMenu()`方法从代码中打开选项菜单。从[这里](http://developer.android.com/reference/android/app/Activity.html#openOptionsMenu%28%29)的文档中可以看到-

> 以编程方式打开选项菜单。如果选项菜单已打开，则此方法不执行任何操作。

但问题是你为什么要这样做。您有硬件菜单按钮来打开选项菜单。所以最好还是这样。即使您想通过单击按钮向用户显示某些选项，也请使用对话框。为什么选择菜单？

# c# - 匹配控制字符之前出现的字符，如果控制字符不存在则匹配零

> ID：16115261
> 
> 赞同：4
> 
> 时间：2013-04-20T00:25:14.033
> 
> 标签：c#, regex, algorithm

我正在研究允许用户为文件夹层次结构中的项目指定“通配符”路径以及当项目与该路径匹配时将执行的关联操作的功能。例如：

```
 Path         Action
    -----------  -------
 1\. $/foo/*/baz  include
 2\. $/foo/bar/*  exclude 
```

现在有了上面的例子，一个项目 at`$/foo/bar/baz`将匹配这两个动作。鉴于此，我想提供通配符路径特异性的粗略分数，这将基于第一个通配符出现的“深度”。最深的路径将获胜。重要的是，只有`*`以正斜杠 ( `/*/`) 为界的通配符才允许使用（除非在末尾 then `/*`），并且可以在路径中的各个点指定任何数字。

**TL;博士;**

所以，我认为在第一个之前计算正斜杠数量的正则表达式`*`是要走的路。但是由于多种原因，如果路径中没有通配符，正斜杠的匹配将为零。我必须进行以下负面回顾：

```
 (?<!\*.*)/ 
```

当有通配符时效果很好（例如，上面的路径#1 有 2 个正斜杠匹配，#2 有 3 个正斜杠匹配），但是当没有通配符时，它自然匹配所有正斜杠。我确信这是一个简单的步骤，但由于生锈的正则表达式技能，我被卡住了。

理想情况下，从学术的角度来看，我想看看单个正则表达式是否可以捕捉到这一点，但是为更优雅的问题解决方案提供了加分！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-20T06:45:31.373

这将是一种方法：

```
match = Regex.Match(subject, 
    @"^       # Start of string
    (         # Match and capture in group number 1...
     [^*/]*   #  any number of characters except slashes or asterisks
     /        #  followed by a slash
    )*        # zero or more times.
    [^*/]*    # Match any additional non-slash/non-asterisk characters.
    \*        # Then match an asterisk", 
    RegexOptions.IgnorePatternWhitespace); 
```

现在，如果字符串中没有星号`subject`（分数`0`），则此正则表达式将无法匹配。如果正则表达式匹配，您可以确定其中至少有一个星号。

现在的聪明之处在于 .NET 正则表达式，与大多数其他正则表达式风格不同，实际上可以计算重复捕获组匹配的次数（大多数其他正则表达式引擎只是丢弃该信息），这使我们能够确定斜杠之前的数量字符串中的第一个星号。

该信息可以在

```
match.Groups[1].Captures.Count 
```

（当然这意味着“第一个星号之前没有斜线”和“根本没有星号”都会得到分数`0`，这似乎是你在问题中要求的，但我不确定为什么会这样说得通）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-20T03:58:56.617

这里不需要正则表达式。

使用 LINQ，它是一个 2-liner：

```
string s = "$/foo/bar/baz";
var asteriskPos = s.IndexOf('*');  // will be -1 if there is no asterisk
var slashCount = s.Where((c, i) => c == '/' && i < asteriskPos).Count(); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-20T01:22:21.730

A way that would approach the task:

1.  Validate all test paths (make sure they are valid and contain either `\*\` or end by `*`).

2.  Use a sorted collection to keep track of the test paths and associated actions.

3.  Sort the collection based on the position of the wildcard in the string.

4.  Test the item against each path in the sorted collection.
    You can replace the `*` in the string by `.*?` to use it in a regex.

5.  Stop at the first match and return the associated action, otherwise continue with the next test in the collection.

A quick test implementation of some of the above:

```
void Main()
{
    // Define some actions to test and add them to a collection
    var ActionPaths = new List<ActionPath>() {
        new ActionPath() {TestPath = "/foo/*/baz",   Action = "include"},
        new ActionPath() {TestPath = "/foo/bar/*",   Action = "exclude"},
        new ActionPath() {TestPath = "/foo/doo/boo", Action = "exclude"},
    };
    // Sort the list of actions based on the depth of the wildcard
    ActionPaths.Sort();

    // the path for which we are trying to find the corresponding action
    string PathToTest = "/foo/bar/baz";

    // Test all ActionPaths from the top down until we find something
    var found = default(ActionPath);
    foreach (var ap in ActionPaths) {
        if (ap.IsMatching(PathToTest)) {
            found = ap;
            break;
        }
    }

    // At this point, we have either found an Action, or nothing at all
    if (found != default(ActionTest)) {
        // Found an Action!
    } else {
        // Found nothing at all :-(
    }
}

// Hold and Action Test
class ActionPath : IComparable<ActionPath>
{
    public string TestPath;
    public string Action;

    // Returns true if the given path matches the TestPath
    public bool IsMatching(string path) {
        var t = TestPath.Replace("*",".*?");
        return Regex.IsMatch(path, "^" + t + "$");
    }

    // Implements IComparable<T>
    public int CompareTo(ActionPath other) {
       if (other.TestPath == null) return 1;
       var ia = TestPath.IndexOf("*");
       var ib = other.TestPath.IndexOf("*");
       if (ia < ib) return 1;       
       if (ia > ib) return -1;
       return 0;
   }
} 
```

# c++ - [] 不允许重载 c++ 函数数组

> ID：16115262
> 
> 赞同：0
> 
> 时间：2013-04-20T00:25:34.000
> 
> 标签：c++, node.js, graph, overloading

您好，我正在尝试创建图表并正在处理我的函数原型，在我的 [] 运算符重载函数上，我收到以下错误：此处不允许的函数数组是我的原型：

```
BinaryTree& ooperator[](int vertex); 
```

二叉树是一个二叉树类我需要改变什么才能让它工作

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-20T00:26:36.810

你拼错`operator`了`ooperator`。哎呀！

```
BinaryTree& operator[](int vertex);
//          ^ 
```

# facebook - 在几个月没有问题后出现此错误 - redirect_uri 不属于应用程序

> ID：16115265
> 
> 赞同：0
> 
> 时间：2013-04-20T00:25:59.033
> 
> 标签：facebook, fb.ui

当我开始我们网站的 Facebook 集成时，我最初遇到了这个问题。经过一番搜索，找到了解决方案并修复了它。

现在，几个月后，它刚刚停止工作。Facebook 开发者网站上的 javascript 代码或应用程序设置均未发生任何更改。我再次开始搜索，并找到了与以前相同的答案：Site URL must match redirect_uri 等。

我目前有应用程序域：“domain.com”
和站点 URL：“http://www.domain.com”

给出的错误：

> API 错误代码：191
> API 错误描述：指定的 URL 不属于应用程序
> 错误消息：redirect_uri 不属于应用程序。

我不知道发生了什么。Facebook 改变了他们的 API 吗？（我确实检查了他们的文档，它仍然是一样的）。

任何帮助将不胜感激。Javascript代码如下：

```
var publish = {
    method: 'feed',
    redirect_uri: 'http://www.domain.com',
    link: 'http://www.domain.com',
    picture: 'http://pathtoimage/logo.png',
    name: 'Name',
    caption: 'Title',
    description: 'Description, blah blah'
};

function fbcallback(response) {
    // do stuff here
}

FB.ui(publish, fbcallback); 
```

谢谢

编辑：
我检查了时间戳，自 3 月 16 日以来 JS 文件没有被触及，Facebook 上的应用程序设置也没有，我的同事在一周前测试了这个（当时还在工作）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-20T08:47:36.757

解决：

对于其他有同样问题的人，这对我有用。

FB 似乎加强了他们的安全性，这就是它最初运作的原因。
我们正在开发一个新版本，并使用 IP 地址而不是域来访问该站点。一条我以前没见过的新消息开始出现在开发控制台中：

```
When using FB.ui, you should not specify a redirect_uri. 
```

看起来 FB api 现在检查浏览器地址字段中的 URL 域（而不是 redirect_uri）与 Facebook 应用程序设置中的站点 URL。通过暂时将我们的域指向 IP 地址并通过域加载的站点运行 Facebook api 代码来测试这一点，它可以工作。因此，当我们在发布前进行测试时，我将使用`http://localhost:8080`它作为站点 URL，然后在它上线时将其更新到站点的域。

感谢那些帮助我指出正确方向的人！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-20T01:18:37.157

Try to check if in your app settings (on Facebook Developers) you have set:

*   'App domain' with the domain where you're using the app
*   Check the 'Website with Facebook Login' option and then set the domain there

# java - TimerTask() 没有做应该做的事情，只打印一次

> ID：16115269
> 
> 赞同：1
> 
> 时间：2013-04-20T00:27:16.007
> 
> 标签：java

```
public static void main(String[] args) {

        Timer ttt = new Timer();
        TimerTask test = new TimerTask() {

            @Override
            public void run() {

                System.out.println("IN");
                        }
                 };

        ttt.schedule(test, 1000);
} 
```

这应该每秒打印一次“IN”，但它只打印一次。有小费吗？谢谢

什么

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-20T00:29:16.200

您正在使用`schedule`. 只需使用接受间隔时间的[重载版本：](http://docs.oracle.com/javase/7/docs/api/java/util/Timer.html#schedule%28java.util.TimerTask,%20long,%20long%29)

```
ttt.schedule(test, 0, 1000); 
```

* * *

*旁白：*较新的[ExecutorService](http://docs.oracle.com/javase/tutorial/essential/concurrency/exinter.html)优于`java.util.Timer`. 定时器只有一个执行线程，所以长时间运行的任务会延迟其他任务。可以`ExecutorService`使用线程池进行操作。[在这里](https://stackoverflow.com/questions/409932/java-timer-vs-executorservice)讨论更多

# java - 将类调用为函数是什么意思？

> ID：16115270
> 
> 赞同：0
> 
> 时间：2013-04-20T00:27:38.300
> 
> 标签：java, code-conversion

我正在将一些代码从 Java（我对这种语言一无所知）移植到 C。事实上，Java 是一种类似 C 的语言，我在转换大多数语句时没有问题。但我不知道代码的某些部分是什么意思。它将java类作为函数调用并作为参数传递：

假设类是：

```
public class foo { 
    public foo(Typex x) { //etc }
}

public class baa {
    public baa(Typex x) { //etc }
} 
```

在另一个类中，它被称为：`new foo(baa())`

这是什么意思？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-20T00:30:05.980

它被称为构造函数。看[这里](http://docs.oracle.com/javase/tutorial/java/javaOO/constructors.html)

```
public class Foo { 
   public foo(Typex x) { //etc }
}

public class Baa {
 public baa(Typex x) { //etc }
}

Foo f = new Foo(x);  // Creates a new instance of Foo.
Baa b = new Baa(x);  // Creates a new instance of Baa. 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-20T00:43:05.600

这是错误的！新富（咩（））

你不能在 Java 中做到这一点，而是你需要做的是

```
new foo(new baa().bar()) . 
```

这意味着您首先创建 baa 的引用（对象）并调用该引用的 bar() 方法。记住 Java 中的 new 关键字是从一个类中创建一个新的引用。它调用类的构造方法并为该引用分配内存。

此外，在上述情况下，它将 bar() 方法返回的任何内容作为参数传递给 foo 类，进而创建 foo 类的引用。

这是一个好的开始：[1]：[http ://docs.oracle.com/javase/tutorial/java/javaOO/index.html](http://docs.oracle.com/javase/tutorial/java/javaOO/index.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-20T00:31:10.663

它是一个构造函数——这个小东西让创建新对象变得更容易。你可以做

```
Object Name = new Object(Param1, Param2); 
```

代替

```
Object Name = new Object();
Name.Param1 = foo;
Name.Param2 = bar; 
```

# css - iPad 上的 CSS 倾斜锯齿状边缘

> ID：16115271
> 
> 赞同：3
> 
> 时间：2013-04-20T00:27:45.290
> 
> 标签：css, ipad, webkit, skew

我有一个网站在设计中广泛使用 CSS 倾斜。使用背面可见性解决了锯齿状边缘问题，iPad 除外。在包括 iphone 在内的所有其他 webkit 浏览器中，边缘都是光滑的，但由于某种原因 iPad 无法正常工作。这是倾斜的代码：

```
-webkit-backface-visibility: hidden;
-ms-backface-visibility:     hidden;
-moz-backface-visibility:    hidden;
backface-visibility:         hidden;
overflow:                    hidden;

-webkit-transform: skewX(16deg);
-moz-transform:    skewX(16deg);
-ms-transform:     skewX(16deg);
transform:         skewX(16deg);

/* IE8+ */ 
-ms-filter: "progid:DXImageTransform.Microsoft.Matrix(M11=1, M12=0.28674538575880865, M21=0, M22=1, SizingMethod='auto expand')";

/* IE6 and 7 */ 
filter: progid:DXImageTransform.Microsoft.Matrix(M11=1, M12=0.28674538575880865, M21=0, M22=1, SizingMethod='auto expand'); 
```

这是网站：[acumen.org](http://acumen.org)

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-10-28T12:28:11.317

```
-webkit-backface-visibility: hidden;
-ms-backface-visibility:     hidden;
-moz-backface-visibility:    hidden;
backface-visibility:         hidden; 
```

除此之外，只需添加以下行：

```
outline: 1px solid transparent; 
```

# autohotkey - 如何使用 autohotkey 通过右键单击 -> 新建 -> 新建文本文档来创建新的文本文件？

> ID：16115278
> 
> 赞同：5
> 
> 时间：2013-04-20T00:29:04.627
> 
> 标签：autohotkey

我想通过右键单击 -> 新建 -> 使用 AutoHotKey 新建文本文档来创建一个新的文本文件。我该怎么做呢？我是 AutoHotKey 的新手。

编辑：

使用 Autohotkey，您可以为某些任务分配快捷方式，例如运行记事本等特定程序。您可以通过编写脚本来做到这一点。您可以在 Autohotkey 网站上找到详细信息。我想编写一个键盘快捷键来手动自动化“右键单击->新建->新建文本文档”功能。

我发现可以通过将以下脚本添加到 AutohotKey 的现有脚本来完成。

```
^+t::
  Click, right, 1024, 355 (or any other mouse co-ordinates for that matter)
  Send w
  Send t
 return 
```

但是，当我尝试时，这种语法不起作用。有人可以告诉我出了什么问题并告诉我应该如何使用正确的语法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-20T11:46:32.160

正如 Ken White 所说，您已经在 Windows 资源管理器中内置了它，右键单击 > 新建 > 新建文本文档，所以让另一个人做同样的事情有点毫无意义。

但是，如果您想使用 AutoHotKey 更有效、更快地创建新的文本文件，那么我会推荐这个脚本

```
SetTitleMatchMode RegEx
MsgBox, 64, NewTextFile, USAGE: When in a folder in Windows Explorer press Ctrl + Shift + T to create empty text file.`nIf you press multiple times, multiple files will be created (e.g. NewTextFile0.txt, NewTextFile1.txt)

#IfWinActive ahk_class ExploreWClass|CabinetWClass
    ^+t::
        NewTextFile()
        return
#IfWinActive

NewTextFile()
{
    WinGetText, full_path, A
    StringSplit, word_array, full_path, `n
    Loop, %word_array0%
    {
        IfInString, word_array%A_Index%, Address
        {
            full_path := word_array%A_Index%
            break
        }
    } 
    full_path := RegExReplace(full_path, "^Address: ", "")
    StringReplace, full_path, full_path, `r, , all

    IfInString full_path, \
    {
        NoFile = 0
        Loop
        {
            IfExist  %full_path%\NewTextFile%NoFile%.txt
                    NoFile++
                else
                    break
        }
        FileAppend, ,%full_path%\NewTextFile%NoFile%.txt
    }
    else
    {
        return
    }
} 
```

当你运行它并且你在使用 Windows 资源管理器（或桌面）的文件夹中时，按 Ctrl+Shift+T 来创建新的文本文件，只要你愿意。

[https://github.com/ilirb/ahk-scripts/blob/master/executable/source/NewTextFile.ahk](https://github.com/ilirb/ahk-scripts/blob/master/executable/source/NewTextFile.ahk)

# jquery - 来自 Greasemonkey 的 jQuery Waypoints

> ID：16115286
> 
> 赞同：2
> 
> 时间：2013-04-20T00:30:40.433
> 
> 标签：jquery, greasemonkey, jquery-waypoints

我正在尝试使用 Greasemonkey 脚本中的 jQuery Waypoints 插件，但似乎无法进行基本测试。有谁知道 Waypoints 不能从用户脚本中工作的原因？

@require 行：

```
// @require     http://ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js
// @require     http://cdn.jsdelivr.net/jquery.waypoints/2.0.2/waypoints.min.js 
```

脚本：

```
$('div.container').waypoint(function(){
    alert('you hit bottom');
},{ offset: 'bottom-in-view' }); 
```

有趣的是，如果这个带有“容器”类的 div 存在，脚本就会中断，并且该语句之外的代码将不会运行。如果我更改选择器以查找一些不存在的元素，则脚本的其余部分运行良好。

有谁知道这里发生了什么？我正用头撞墙。谢谢！

PS。我还尝试将 Waypoints 插件代码直接粘贴到脚本中（而不是使用 CDN），我得到了相同的结果。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-20T08:05:15.600

不幸的是，该扩展不如许多其他 jQuery 扩展编写得好。它使用`this`, 和`jQuery`，比方说，“不幸”的方式。这意味着它会从用户脚本范围内崩溃，即使`@grant none`已设置。

对于像这样的库，您的选择是：

*   **寻找更好的图书馆（推荐）。**

*   自己找一个更好的方法来编码，如果它不是太复杂的话。

*   如果页面不使用 jQuery，或者使用兼容版本的 jQuery，那么您可以通过*Script Injection*使用此类扩展。见下文。

*   如果页面使用不兼容的 jQuery 版本，那么您可能无法在不破坏页面的情况下做任何事情。 *有时*可以使用解决方法，但这是另一个问题。

* * *

# 页面已经使用兼容版本的 jQuery 的情况：

你只需要注入 Waypoints 和任何使用 Waypoints 的代码。不要使用`@require`.
像这样：

```
// ==UserScript==
// @name        _YOUR_SCRIPT_NAME
// @include     http://YOUR_SERVER.COM/YOUR_PATH/*
// @grant       GM_addStyle
// ==/UserScript==
/*- The @grant directive is needed to work around a design change
    introduced in GM 1.0\.   It restores the sandbox.
*/

function GM_main () {
    $('div.container').waypoint(function(){
        alert('you hit bottom');
    },{ offset: 'bottom-in-view' });
}

addJS_Node (
    null,
    "http://cdn.jsdelivr.net/jquery.waypoints/2.0.2/waypoints.min.js",
    null,
    function () {addJS_Node (null, null, GM_main); }
);

//-- This is a standard-ish utility function.
function addJS_Node (text, s_URL, funcToRun, runOnLoad) {
    var D                                   = document;
    var scriptNode                          = D.createElement ('script');
    if (runOnLoad) {
        scriptNode.addEventListener ("load", runOnLoad, false);
    }
    scriptNode.type                         = "text/javascript";
    if (text)       scriptNode.textContent  = text;
    if (s_URL)      scriptNode.src          = s_URL;
    if (funcToRun)  scriptNode.textContent  = '(' + funcToRun.toString() + ')()';

    var targ = D.getElementsByTagName ('head')[0] || D.body || D.documentElement;
    targ.appendChild (scriptNode);
} 
```

* * *

# 页面根本不使用 jQuery 的情况：

您需要注入 jQuery，然后将 Waypoints 的注入和任何使用 Waypoints 的代码链接起来。不要使用`@require`.
像这样：

```
// ==UserScript==
// @name        _YOUR_SCRIPT_NAME
// @include     http://YOUR_SERVER.COM/YOUR_PATH/*
// @grant       GM_addStyle
// ==/UserScript==
/*- The @grant directive is needed to work around a design change
    introduced in GM 1.0\.   It restores the sandbox.
*/

function GM_main () {
    $('div.container').waypoint(function(){
        alert('you hit bottom');
    },{ offset: 'bottom-in-view' });
}

//-- Add jQuery.
addJS_Node (
    null,
    "http://ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js",
    null,
    addWaypointsAndFireMain
);

function addWaypointsAndFireMain () {
    addJS_Node (
        null,
        "http://cdn.jsdelivr.net/jquery.waypoints/2.0.2/waypoints.min.js",
        null,
        function () {addJS_Node (null, null, GM_main); }
    );
}

//-- This is a standard-ish utility function.
function addJS_Node (text, s_URL, funcToRun, runOnLoad) {
    var D                                   = document;
    var scriptNode                          = D.createElement ('script');
    if (runOnLoad) {
        scriptNode.addEventListener ("load", runOnLoad, false);
    }
    scriptNode.type                         = "text/javascript";
    if (text)       scriptNode.textContent  = text;
    if (s_URL)      scriptNode.src          = s_URL;
    if (funcToRun)  scriptNode.textContent  = '(' + funcToRun.toString() + ')()';

    var targ = D.getElementsByTagName ('head')[0] || D.body || D.documentElement;
    targ.appendChild (scriptNode);
} 
```

* * *

* * *

`GM_`不幸的是，当您必须注入脚本代码时，使用函数变得更加混乱。如果这适用于您，请参阅：[“如何从必须在目标页面范围内运行的代码调用 Greasemonkey 的 GM_ 函数？”](https://stackoverflow.com/q/14229539/331508)

# windows - 想要一个实现 '@include' 的 AWK

> ID：16115291
> 
> 赞同：6
> 
> 时间：2013-04-20T00:31:07.790
> 
> 标签：windows, awk

在 gawk 手册中，我描述了一个**@include**运算符。这使您可以制作 .awk 模块和共享脚本等。包含文件。

到目前为止，我发现 Windows 的最新 cgywin、mingw 和 gnu awk-s（awk、gawk、mawk、nawk，...）在第一个失败：**@include**声明。

有人可以指出一个为 Windows 实现整个 nawk 或 awk 实现的版本吗？我很确定至少有一个 nawk，早在那天，我们已经下载了运行 Windows NT。

在此期间，另一种解决方法会有所帮助。（比如说一个预先测试过的 awk 包含程序？？）

*蒂亚*,威尔

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-04-20T00:49:39.170

据我所知，`@include`gawk 在 4.x 之前不支持文件。但是，至少在 Linux 上，它附带了一个名为的 shell 脚本`igawk`，您可以使用它来代替；它预处理 awk 脚本并将`@include`s 替换为包含文件的内容（通过 找到`$AWKPATH`）。也许 Cygwin 也有这个脚本？

```
$ cat foo.awk
@include bar.awk
$ cat bar.awk
BEGIN {print "Hello, world!" }
$ awk -f foo.awk
awk: foo.awk:1: @include bar.awk
awk: foo.awk:1: ^ invalid char '@' in expression
$ gawk -f foo.awk
gawk: foo.awk:1: @include bar.awk
gawk: foo.awk:1: ^ invalid char '@' in expression
$ igawk -f foo.awk
Hello, world! 
```

但是请注意，这`igawk`和 gawk 4 的`@include`语法不兼容。gawk 4 中的 native`@include`需要一个带引号的字符串作为包含的文件名；`igawk`'s 是一个裸词，如果你引用它，它会尝试查找名称中带有引号的文件。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-20T16:11:07.993

你可以试试`runawk`。

*RunAWK 是 AWK 解释器的小型包装器，可帮助在 AWK 中编写独立程序。它提供对模块和其他强大功能的支持。它带有几十个模块，这些模块提供了处理命令行选项的有效方法、操作字符串和数组的强大功能以及排序、数学、tmpfile、braceexpand 函数和许多其他函数。*

[http://sourceforge.net/projects/runawk](http://awk.info/?tools/runawk)

[http://awk.info/?tools/runawk](http://awk.info/?tools/runawk)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-12-04T06:33:05.710

如果您想坚持使用标准 awk，请执行以下操作。

创建您的库 awk 文件，我们将其命名为 myawklib.awk。在库文件中，有您的 awk 程序语句。不要包括 BEGIN 和 END 块。不要包含 BODY 块，除非您知道自己在做什么。只有库函数。

您可以在命令行上运行：

awk -f myawklib.awk -f main.awk program_arguments

和

awk -f myawklib.awk -f another_main.awk 程序参数

希望这可能会有所帮助。

*   医学博士

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-20T00:54:47.237

检查[unixtools——](http://unxutils.sourceforge.net/)它看起来会为你排序。祝你好运...

# javascript - is(':first') 返回不同的（错误的？）结果应该是相同的元素。jsFiddle里面

> ID：16115294
> 
> 赞同：6
> 
> 时间：2013-04-20T00:31:26.863
> 
> 标签：javascript, jquery

[http://jsfiddle.net/garnwraly/sfrwU/2/](http://jsfiddle.net/garnwraly/sfrwU/2/)

仅给定 HTML

```
<li>
    <button id="bam">click</button>
</li> 
```

和这个脚本

```
$('body').on('click', 'button', function (e) {
    //console.log( e.currentTarget == $('button')[0] ); //true;
    //console.log($('li').is('li:first')); //true

    console.log($(e.currentTarget).parent().is('li:first')) //false
    console.log($('button').parent().is('li:first')); //true
    console.log($($('button')[0]).parent().is('li:first')); //false
}); 
```

为什么是`$(e.currentTarget).parent().is('li:first')`假的？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-20T02:17:37.620

在运行时通过 jQuery 代码进行逐步调试后，结果证明这是方法在`jQuery()`方法中使用的方式的问题`is()`。众所周知，[您可以将上下文传递给方法](http://api.jquery.com/jQuery/#jQuery-selector-context)，并且在内部，此上下文与`is()`方法一起使用（并且为各种选择器设置不同的设置）。

使用`$(e.currentTarget)`时，上下文设置为触发事件的按钮。当`$('button')`使用时，上下文被设置为`Document`对象。当您考虑需要如何限定这些选择器时，这是有道理的。

这是该`is()`方法的相关部分：

```
jQuery( selector, this.context ).index( this[0] ) >= 0 
```

基于此，当作为 $(e.currentTarget) 运行时，对该`jQuery()`方法的调用将评估为：

```
jQuery("li:first", "button#bam").index( this[0] ) >= 0 
```

这显然是返回-1，并报告为`false`

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-20T00:48:50.107

我认为它可能`:first`只关心*匹配*- 如果 jQuery 对象是从 DOM 元素构造的，则不会进行选择器匹配。注意

```
console.log($(document.getElementById('bam')).is(':first')); 
```

也记录`false`。

我不认为这种行为是正确的，并且可能应该记录一个错误，但即使它工作正常，我也不认为在这种情况下测试`:first`真的有任何好处。如果您使用`.parent()`从单个元素开始向上导航 DOM 到父节点，那么询问父节点是否是第一个元素是没有意义的 - 总会有一个父节点（当然除了 DOM 根），并且总是只有一个。

如果你用 来做这件事`:first-child`，这实际上会很有趣但不一定相关，那么它会像人们预期的那样工作，因为`:first-child`它实际上是关于 DOM 的结构。`:first`限定符只是第一个匹配的元素。

# php - 如何避免显示随机图像脚本中的重复项？

> ID：16115296
> 
> 赞同：1
> 
> 时间：2013-04-20T00:31:48.793
> 
> 标签：php

以下脚本非常适合我的需求，但不幸的是经常显示重复的图像。

如何修改以解决此问题？

或者代替这个是否有一个类似的脚本允许在一列中显示随机图像并且每个图像都有自己的链接？

谢谢。

```
<?php

function display_random_img($array) {
$key = rand(0 , count($array) -1);
$link_url = $array[$key]['url'];
$alt_tag = $array[$key]['alt'];
$random_img_url = $array[$key]['img_url'];
list($img_width, $img_height) = getimagesize($random_img_url);
return "<a href=\"$link_url\"><img src=\"$random_img_url\" width=\"$img_width\" height=\"$img_height\" alt=\"$alt_tag\" /></a>";
}
//-----------------------
$ads_array = array(
array(
    'url' => 'http://www.mysite.com/',
    'alt' => 'Image1',
    'img_url' => 'http://www.mysite.com/pic1.jpg'
),
array(
    'url' => 'http://www.yoursite.com/',
    'alt' => 'Image2',
    'img_url' => 'http://www.mysite.com/pic2.jpg'
),
array(
    'url' => 'http://www.theirsite.com/',
    'alt' => 'Image3',
    'img_url' => 'http://www.mysite.com/pic3.jpg'
)
);
//-----------------------
$ads_array_1 = array( 
array(
    'url' => 'http://www.mysite.com/',
    'alt' => 'Image1',
    'img_url' => 'http://www.mysite.com/pic1.jpg'
),
array(
    'url' => 'http://www.yoursite.com/',
    'alt' => 'Image2',
    'img_url' => 'http://www.mysite.com/pic2.jpg'
),
array(
    'url' => 'http://www.theirsite.com/',
    'alt' => 'Image3',
    'img_url' => 'http://www.mysite.com/pic3.jpg'
)
);

//-----------------------
$ads_array_2 = array( 
array(
    'url' => 'http://www.mysite.com/',
    'alt' => 'Image1',
    'img_url' => 'http://www.mysite.com/pic1.jpg'
),
array(
    'url' => 'http://www.yoursite.com/',
    'alt' => 'Image2',
    'img_url' => 'http://www.mysite.com/pic2.jpg'
),
array(
    'url' => 'http://www.theirsite.com/',
    'alt' => 'Image3',
    'img_url' => 'http://www.mysite.com/pic3.jpg'
)
);

//-----------------------
echo display_random_img($ads_array);
echo display_random_img($ads_array_1); 
echo display_random_img($ads_array_2);
?> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-20T00:36:45.043

如果您的图像集中只有 3 张图像，则图像显示两次的可能性为 1/3。所以增加你的图像列表。

但是，您应该使用`mt_rand()`能给您带来*更好*随机性的东西。但主要问题是图像量少

* * *

更新：

在考虑了你的问题之后，我认为你需要这样的东西：

你只需要一个数组：

```
$ads_array = array(
array(
    'url' => 'http://www.mysite.com/',
    'alt' => 'Image1',
    'img_url' => 'http://www.mysite.com/pic1.jpg'
),
array(
    'url' => 'http://www.yoursite.com/',
    'alt' => 'Image2',
    'img_url' => 'http://www.mysite.com/pic2.jpg'
),
array(
    'url' => 'http://www.theirsite.com/',
    'alt' => 'Image3',
    'img_url' => 'http://www.mysite.com/pic3.jpg'
)
); 
```

这个函数用于`shuffle()`生成随机性：

```
function display_random_images($array, $maxcount = 3) {
    // shuffle $array elements
    shuffle($array);
    $html = '';
    for($i = 0; $i < min(count($array), $maxcount); $i++) {
        $img = $array[$i];
        $link_url = $img['url'];
        $alt_tag = $img['alt'];
        $random_img_url = $img['img_url'];
        list($img_width, $img_height) = getimagesize($random_img_url);
        $html .= "<a href=\"$link_url\"><img src=\"$random_img_url\" width=\"$img_width\" height=\"$img_height\" alt=\"$alt_tag\" /></a>";
    }
    return $html;
} 
```

现在调用该函数，它将输出`$maxcount`图像，默认情况下`3`

```
echo display_random_images($ads_array); 
```

如果你有更多的图像，那么你可以这样称呼它：

```
echo display_random_images($ads_array, 10); // 10 imgs or whatever 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-20T00:49:01.153

这可能有效，或者至少是这样的想法：

```
function display_random_img($array) {
    static $displayedImages = array();
    // ...
    $length = count($array);
    if(count($displayedImages) === $length) {
        // Every image was picked, restarting.
        $displayedImages = array();
    }
    while(true) {
        $rand = rand(0, $length - 1);
        if( ! isset($array[$rand])) {
            // Image at $rand not shown yet.
            $displayImages[$rand] = true;
            break;
        }
    }
    $imageDetails = $array[$rand];
    // ...
} 
```

不过，使用巨大的图像阵列可能会很慢

# dart - 响应事件启动多个异步期货

> ID：16115298
> 
> 赞同：1
> 
> 时间：2013-04-20T00:31:53.710
> 
> 标签：dart, dart-async

我想启动一个相当昂贵的操作来响应用户点击画布元素。

```
mouseDown(MouseEvent e) {
  print("entering event handler");
  var future = new Future<int>(expensiveFunction);
  future.then((int value) => redrawCanvas(value);
  print("done event handler");
}

expensiveFunction() {
  for(int i = 0; i < 1000000000; i++){
    //do something insane here
  }
}

redrawCanvas(int value) {
  //do stuff here
  print("redrawing canvas");
} 
```

我对 M4 Dart 的理解是，这个未来的构造函数应该异步启动“expensiveFunction”，也就是在与主线程不同的线程上。它确实以这种方式出现，因为“完成事件处理程序”立即打印到我在 IDE 中的输出窗口中，然后一段时间后打印“重绘画布”。但是，如果我再次单击该元素，则在我的“expensiveFunction”从上一次单击运行完成之前不会发生任何事情。

如何使用期货在新线程上简单地启动计算密集型功能，以便我可以将其中的多个排队以响应多次点击，即使第一个未来尚未完成？

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-20T04:53:24.230

正如在另一个答案中提到的，期货只是“未来可用值的占位符”。它们不一定意味着并发。

Dart 有一个并发隔离的概念。您可以生成一个隔离以在并行线程或进程中运行一些代码。

dart2js 可以将隔离编译成 Web Workers。Web Worker 可以在单独的线程中运行。

尝试这样的事情：

```
import 'dart:isolate';

expensiveOperation(SendPort replyTo) {
  var result = doExpensiveThing(msg);
  replyTo.send(result);
}

main() async {
  var receive = new ReceivePort();
  var isolate = await Isolate.spawn(expensiveOperation, receive.sendPort);
  var result = await receive.first;
  print(result);
} 
```

（我还没有测试过以上，但类似的东西应该可以工作。）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-20T07:37:50.650

# 事件循环和事件队列

您应该注意 Futures 不是线程。它们不会同时运行，事实上，Dart 是单线程的。所有 Dart 代码都在事件循环中运行。

**事件循环**是一个循环，只要当前的 Dart 隔离还活着，它就会运行。当你调用`main()`启动一个 Dart 应用程序时，isolate 被创建，并且在 main 方法完成并且事件队列上的所有项目也完成后它不再活动。

**事件队列**是仍然需要完成执行的所有函数的集合。因为 Dart 是单线程的，所以所有这些函数都需要一次运行一个。因此，当事件队列中的一项完成时，另一项开始。事件队列的确切时间和调度比我自己解释的要复杂得多。

因此，异步处理对于防止单个线程被一些长时间运行的执行阻塞很重要。在 UI 中，较长的过程可能会导致视觉[混乱](http://jankfree.org/)并阻碍您的应用程序。

# 期货

Futures 表示将在 Future 的某个时间可用的值，因此得名。创建 Future 后，它会立即返回，并继续执行。

与该 Future 关联的回调（在您的情况下为`expensiveFunction`）是通过添加到事件队列来“启动”的。当您从当前隔离返回时，回调会运行，并且会尽快运行`then`.

# 流

因为您的 Future 定义为异步的，并且您不知道它们何时返回，所以您希望将回调排队，以便它们保持有序。

**Stream**是一个对象，它发出可以订阅的事件。当你写作时，`canvasElement.onClick.listen(...)`你要求的是`onClick`Stream `MouseEvents`，然后你订阅它`listen`。

您可以使用 Streams 将事件排队并在这些事件上注册回调以运行您想要的代码。

# 写什么

```
main() {
  // Used to add events to a stream.
  var controller = new StreamController<Future>();

  // Pause when we get an event so that we take one value at a time.
  var subscription = controller.stream.listen(
      (_) => subscription.pause());

  var canvas = new CanvasElement();
  canvas.onClick.listen((MouseEvent e) {
    print("entering event handler");
    var future = new Future<int>(expensiveFunction);

    // Resume subscription after our callback is called.
    controller.add(future.then(redrawCanvas).then(subscription.resume()));
    print("done event handler");
  });
}

expensiveFunction() {
  for(int i = 0; i < 1000000000; i++){
    //do something insane here
  }
}

redrawCanvas(int value) {
  //do stuff here
  print("redrawing canvas");
} 
```

在这里，我们通过在每次鼠标单击后暂停来排队`redrawCanvas`回调，然后在`redrawCanvas`调用后恢复。

# 更多信息

另请参阅[this great answer](https://stackoverflow.com/a/13509753/1724321) to a similar question。

开始阅读 Dart 的异步的好地方是[这篇关于 dart:io 库的文章](http://www.dartlang.org/articles/io/)的第一部分和[这篇关于 dart:async 库的文章](http://blog.sethladd.com/2013/02/exploring-darts-async-library.html)。

有关期货的更多信息，请参阅[这篇关于期货](http://www.dartlang.org/articles/using-future-based-apis/)的文章。

有关 Streams 的信息，请参阅[有关添加到 Streams](http://blog.dartwatch.com/2013/03/filling-stream-with-data.html)的文章和[有关创建 Streams](http://www.dartlang.org/articles/creating-streams/)的文章。

# html - 切角 jquery mobile 可折叠套装

> ID：16115299
> 
> 赞同：0
> 
> 时间：2013-04-20T00:32:11.837
> 
> 标签：html, css, jquery-mobile

我想在一个可折叠的集合中切断一个 jquery 移动标题的左上角。

这是我的 HTML：

```
<div data-role="content" id="one" class="ui-content" role="main">
    <div data-role="collapsible-set" data-corners="false">
        <div data-role="collapsible" data-collapsed="false" data-theme="f" data-content-theme="f" class="cornered ui-collapsible-heading">
            <h3>Witness</h3>
            <p>Content for witness tab. Content for witness tab. Content for witness tab. Content for witness tab. Content for witness tab. Content for witness tab. </p>
        </div>
        <div data-role="collapsible" data-theme="e" data-content-theme="e">
            <h3>Victim</h3>
            <p>Content for Victim tab. Content for victim tab. Content for Victim tab. Content for victim tab. Content for Victim tab. Content for victim tab. </p>
        </div>
        <div data-role="collapsible" data-theme="d" data-content-theme="d">
            <h3>Information</h3>
            <p>25% of Chinese women have experienced domestic violence.</p>
        </div>
    </div>
</div> 
```

还有我的 CSS：

```
.cornered {
    width: 176px;
    height: 0px;
    border-bottom: 40px solid #30C2DF;
    border-left: 40px solid transparent;
} 
```

添加一点自定义 CSS 后，我可以制作一个切角，但我无法在 jquery.mobile.css 中找到进行更改的位置，因为如果我将 class=cornered 添加到我的 div 它只会添加切角标题的左侧，并且不影响标题本身。

这种方法还改变了我的可折叠集合中标题的宽度，并在展开时使内容落在其他标题后面（例如，参见照片）。

[![在此处输入图像描述](https://i.stack.imgur.com/q1hCm.png)](https://i.stack.imgur.com/q1hCm.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-25T14:44:12.350

我想出了一个接近我最初拥有的解决方案。

我补充说：

```
.cornered1 {}

.cornered1 .ui-collapsible-heading
{
    height:0px;
    border-bottom: 40px solid #30C2DF;
    border-left: 40px solid transparent;
} 
```

然后，我交替使用左边框的颜色，以使选项卡彼此堆叠：

```
.cornered2 {}

.cornered2 .ui-collapsible-heading
{
    height:0px;
    border-bottom: 40px solid #de1f26;
    border-left: 40px solid #30C2DF;;
} 
```

结果截图：

![在此处输入图像描述](https://i.stack.imgur.com/G7a6W.png)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-20T06:18:47.623

jQuery Mobile 使用这些`.ui-corner-*`类来添加圆角。您拥有的一种选择是删除 doc ready 上的类。一个例子是`$("[data-role='collapsible-set']").removeClass("ui-corner-all");`让我知道这是否有效，或者如果您有任何问题:)

# c# - 多线程网络爬虫？

> ID：16115303
> 
> 赞同：4
> 
> 时间：2013-04-20T00:32:24.637
> 
> 标签：c#, multithreading, web-scraping, .net-4.0

我一直在考虑让我的网络抓取工具成为多线程的，不像普通线程（egThread scrape = new Thread(Function);），而是像线程池那样可以有大量线程的线程池。

我的刮板通过使用`for`循环来刮页面来工作。

```
for (int i = (int)pagesMin.Value; i <= (int)pagesMax.Value; i++) 
```

那么我怎么能用线程池之类的东西对函数（包含循环）进行多线程处理呢？我以前从未使用过线程池，而且我看到的示例对我来说非常混乱或晦涩难懂。

* * *

我已将循环修改为：

```
int min = (int)pagesMin.Value;
int max = (int)pagesMax.Value;
ParallelOptions pOptions = new ParallelOptions();
pOptions.MaxDegreeOfParallelism = Properties.Settings.Default.Threads;
Parallel.For(min, max, pOptions, i =>{
    //Scraping
}); 
```

那会起作用还是我有什么问题？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-20T01:12:49.383

使用池线程的问题在于它们大部分时间都在等待来自 Web 站点的响应。使用的问题`Parallel.ForEach`是它限制了你的并行性。

通过使用异步 Web 请求，我获得了最佳性能。我用 a`Semaphore`来限制并发请求的数量，回调函数做了抓取。

主线程创建`Semaphore`，如下所示：

```
Semaphore _requestsSemaphore = new Semaphore(20, 20); 
```

`20`是通过反复试验得出的。事实证明，限制因素是 DNS 解析，平均而言，它需要大约 50 毫秒。至少，在我的环境中确实如此。20 个并发请求是绝对最大值。15可能更合理。

主线程本质上是循环的，如下所示：

```
while (true)
{
    _requestsSemaphore.WaitOne();
    string urlToCrawl = DequeueUrl();  // however you do that
    var request = (HttpWebRequest)WebRequest.Create(urlToCrawl);
    // set request properties as appropriate
    // and then do an asynchronous request
    request.BeginGetResponse(ResponseCallback, request);
} 
```

该`ResponseCallback`方法将在池线程上调用，执行处理，处理响应，然后释放信号量以便可以发出另一个请求。

```
void ResponseCallback(IAsyncResult ir)
{
    try
    {
        var request = (HttpWebRequest)ir.AsyncState;
        // you'll want exception handling here
        using (var response = (HttpWebResponse)request.EndGetResponse(ir))
        {
            // process the response here.
        }
    }
    finally
    {
        // release the semaphore so that another request can be made
        _requestSemaphore.Release();
    }
} 
```

正如我所说，限制因素是 DNS 解析。事实证明，DNS 解析是在调用线程（本例中为主线程）上完成的。请参阅[这真的是异步的吗？](http://blog.mischel.com/2008/06/10/is-this-really-asynchronous/)了解更多信息。

这很容易实现并且效果很好。有可能获得超过 20 个并发请求，但根据我的经验，这样做需要相当多的努力。我不得不做很多 DNS 缓存，而且……嗯，这很困难。

您可能可以通过使用`Task`C# 5.0 (.NET 4.5) 中的新异步内容来简化上述内容。不过，我对那些说的不太熟悉。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-20T00:49:51.147

最好使用 TPL，即[Parallel.ForEach](http://msdn.microsoft.com/en-us/library/dd782934.aspx)使用带有[Partitioner](http://msdn.microsoft.com/en-us/library/system.collections.concurrent.partitioner.aspx)的重载。它自动管理工作量。

供参考。你应该明白更多的线程并不意味着更快。我建议您进行一些测试以比较未参数化`Parallel.ForEach`和用户定义。

**更新**

```
 public void ParallelScraper(int fromInclusive, int toExclusive,
                                Action<int> scrape, int desiredThreadsCount)
    {
        int chunkSize = (toExclusive - fromInclusive +
            desiredThreadsCount - 1) / desiredThreadsCount;
        ParallelOptions pOptions = new ParallelOptions
        {
            MaxDegreeOfParallelism = desiredThreadsCount
        };

        Parallel.ForEach(Partitioner.Create(fromInclusive, toExclusive, chunkSize),
            rng =>
            {
                for (int i = rng.Item1; i < rng.Item2; i++)
                    scrape(i);
            });
    } 
```

**注意**您的情况可能会更好`async`。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-04-20T00:53:32.157

如果你认为你的网络爬虫喜欢使用 for 循环，你可以看看类似于 foreach 循环的**Parallel.ForEach() ；**但是，它会迭代**可枚举**的数据。**Parallel.ForEach**使用多个线程来调用循环体。

有关更多详细信息，请参阅[并行循环](http://msdn.microsoft.com/en-us/library/ff963552.aspx)

更新：

**Parallel.For()与****Parallel.ForEach** ()非常相似，它取决于您使用 for 或 foreach 循环的上下文。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-08-30T19:57:32.250

在对我们的“ [Crawler-Lib 框架](http://www.crawler-lib.net)”进行测试期间，我发现并行、TPL 或线程尝试不会让您获得想要的吞吐量。您在本地计算机上每秒处理 300-500 个请求。如果要并行执行数千个请求，则必须以异步模式执行它们并并行处理结果。我们的 Crawler-Lib 引擎（支持工作流的请求处理器）在本地机器上以大约 10.000 - 20.000 个请求/秒的速度执行此操作。如果你想拥有一个快速的刮刀，不要尝试使用 TPL。而是使用异步模式（开始...结束...）并在一个线程中启动所有请求。

如果您的许多请求往往会在 30 秒后超时，那么情况会更糟。在这种情况下，基于 TPL 的解决方案将获得 5 的丑陋糟糕的吞吐量？1？每秒请求数。异步模式每秒至少为您提供 100-300 个请求。Crawler-Lib 引擎可以很好地处理这个问题并获得尽可能多的请求。假设您的 TCP/IP 策略配置为具有 60000 个出站连接（最大值为 65535，因为每个连接都需要一个出站端口），那么您将获得 60000 个连接/30 秒超时 = 2000 个请求/秒的吞吐量。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-04-20T02:57:54.673

这是 TPL Dataflow 的[ActionBlock](http://msdn.microsoft.com/en-us/library/hh194684.aspx)的完美场景。您可以轻松地对其进行配置以限制并发。以下是文档中的示例之一：

```
var downloader = new ActionBlock<string>(async url =>
{
    byte [] imageData = await DownloadAsync(url);
    Process(imageData);
}, new DataflowBlockOptions { MaxDegreeOfParallelism = 5 }); 

downloader.Post("http://msdn.com/concurrency ");
downloader.Post("http://blogs.msdn.com/pfxteam"); 
```

[您可以通过下载Introduction to TPL Dataflow 来](http://www.microsoft.com/en-us/download/details.aspx?id=14782)了解 ActionBlock（包括引用的示例）。

# css - 2 列 - 单击其中的缩略图会显示另一列中的文本

> ID：16115308
> 
> 赞同：0
> 
> 时间：2013-04-20T00:33:25.297
> 
> 标签：css

我正在尝试创建一个页面，单击左栏中的缩略图会显示右栏中的文本。然后会有一些缩略图，每个缩略图都有自己的文本，单击时会出现在右栏中的相同位置。我想知道是否有任何 CSS 或 jquery 项目可以做这种事情？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-20T01:24:06.157

我认为这就是你想要的，我用它做了一个**[jsFiddle](http://jsfiddle.net/PwqEX/ "jsFiddle")**。

HTML：

```
<div id="wrapper">
<div id="left">
    <p><a href="javascript:void()" class="one">THUMBNAIL #1</a>
    </p>
    <p><a href="javascript:void()" class="two">THUMBNAIL #2</a>
    </p>
    <p><a href="javascript:void()" class="three">THUMBNAIL #3</a>
    </p>
</div>
<div id="right">
    <!-- Each div here will contain the text to be show on the right -->
    <div id="textOne" class="text" style="display:block;">
         <h1>one</h1>

        <p>Zzril amet nisl consequat claritas litterarum. In aliquam dolore qui diam veniam. Ut exerci ullamcorper ut sit dolor.</p>
    </div>
    <div id="textTwo" class="text">
         <h1>two</h1>

        <p>Qui nobis nulla eu in lectores. Legunt possim diam me nisl nostrud. Legere claritatem duis anteposuerit aliquip et.</p>
    </div>
        <div id="textThree" class="text">
             <h1>three</h1>

            <p>Qui nobis nulla eu in lectores. Legunt possim diam me nisl nostrud. Legere claritatem duis anteposuerit aliquip et.</p>
        </div>
    </div>
</div> 
```

CSS：

```
a {
text-decoration:none;

}
#wrapper {
    width:600px;
}
#left {
    margin-top:100px;
    overflow:hidden;
    float:left;
    width:20%;
}
#right {
    overflow:hidden;
    float:left;
    width:80%;
} 
```

Javascript (jQuery 1.9.1)

```
$(".text").hide();

$("#left a.one").click(function () {
    $(".text").hide();
    $("#textOne").fadeIn();
    return false;
});

$("#left a.two").click(function () {
    $(".text").hide();
    $("#textTwo").fadeIn();
    return false;
});

$("#left a.three").click(function () {
    $(".text").hide();
    $("#textThree").fadeIn();
    return false;
}); 
```

# java - 如何将排序字母制作为字母

> ID：16115311
> 
> 赞同：-1
> 
> 时间：2013-04-20T00:33:36.737
> 
> 标签：java, android, sorting, logcat, android-logcat

我是android新手，我想知道当我点击button1时如何制作，然后button2文本视图将显示1 2，，但是如果我点击button2然后button1它将显示2 1

这是我的代码，但现在当我点击 button1 然后 button2，或者如果我点击 button2 然后 button1 它显示相同，请帮助我thanx。

现在我使用 getText 和 setText 完成了它，它可以按我的意愿工作，但是如果它的正确与否条件不起作用请帮助！它有什么问题，我的方法正确吗？

```
protected void onCreate(Bundle savedInstanceState) {
    // TODO Auto-generated method stub
    super.onCreate(savedInstanceState);
    setRequestedOrientation (ActivityInfo.SCREEN_ORIENTATION_PORTRAIT);
    // Full screen
    requestWindowFeature(Window.FEATURE_NO_TITLE);
        getWindow().setFlags(WindowManager.LayoutParams.FLAG_FULLSCREEN, 
                             WindowManager.LayoutParams.FLAG_FULLSCREEN);

    setContentView(R.layout.wordgame2);

    bu1 = (Button) findViewById(R.id.bu1);
    bu2 = (Button) findViewById(R.id.bu2);
    bu3 = (Button) findViewById(R.id.bu3);
    bu4 = (Button) findViewById(R.id.bu4);
    bu5 = (Button) findViewById(R.id.bu5);

    t1 = (TextView) findViewById(R.id.t1);

    i1 = (ImageView) findViewById(R.id.i1);
    i2 = (ImageView) findViewById(R.id.i2);

    bu1.setOnClickListener(new View.OnClickListener() {

        public void onClick(View v) {
            // TODO Auto-generated method stub

            t1.setText(t1.getText()+" "+bu1.getText()); 

        }

    });

    bu2.setOnClickListener(new View.OnClickListener() {

                public void onClick(View v) {
                    // TODO Auto-generated method stub

                    t1.setText(t1.getText()+" "+bu2.getText()); 

                }

            });

    bu3.setOnClickListener(new View.OnClickListener() {

        public void onClick(View v) {
            // TODO Auto-generated method stub

            t1.setText(t1.getText()+" "+bu3.getText()); 

        }

    });

    bu4.setOnClickListener(new View.OnClickListener() {

        public void onClick(View v) {
            // TODO Auto-generated method stub

            t1.setText(t1.getText()+" "+bu4.getText()); 
        }

    });

    bu5.setOnClickListener(new View.OnClickListener() {

        public void onClick(View v) {
            // TODO Auto-generated method stub

        if(t1.getText().toString().equals("a b c d")) //this is not working
            {

                i1.setVisibility(View.VISIBLE);
                i2.setVisibility(View.INVISIBLE);
            }       

            else {
                i2.setVisibility(View.VISIBLE);
                i1.setVisibility(View.INVISIBLE);
            }
        }

    });

} 
```

> 04-21 07:00:48.690: E/AndroidRuntime(23874): 致命异常: main 04-21 07:00:48.690: E/AndroidRuntime(23874): java.lang.RuntimeException: 无法启动活动 ComponentInfo{com. arabicalphabets.reham/com.arabicalphabets.reham.Wordgame2}：java.lang.NullPointerException 04-21 07:00:48.690：E/AndroidRuntime(23874)：在 android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1970) 04 -21 07:00:48.690: E/AndroidRuntime(23874): 在 android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:1995) 04-21 07:00:48.690: E/AndroidRuntime(23874): 在 android.app .ActivityThread.access$600(ActivityThread.java:127) 04-21 07:00:48.690: E/AndroidRuntime(23874): 在 android.app.ActivityThread$H.handleMessage(ActivityThread.java:1161) 04-21 07: 00:48.690: E/AndroidRuntime(23874): 在 android.os.Handler。dispatchMessage(Handler.java:99) 04-21 07:00:48.690: E/AndroidRuntime(23874): at android.os.Looper.loop(Looper.java:137) 04-21 07:00:48.690: E/ AndroidRuntime(23874): 在 android.app.ActivityThread.main(ActivityThread.java:4512) 04-21 07:00:48.690: E/AndroidRuntime(23874): 在 java.lang.reflect.Method.invokeNative(Native Method) 04-21 07:00:48.690: E/AndroidRuntime(23874): 在 java.lang.reflect.Method.invoke(Method.java:511) 04-21 07:00:48.690: E/AndroidRuntime(23874): 在com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:982) 04-21 07:00:48.690: E/AndroidRuntime(23874): at com.android.internal.os.ZygoteInit.main(ZygoteInit .java:749) 04-21 07:00:48.690: E/AndroidRuntime(23874): at dalvik.system.NativeStart.main(Native Method) 04-21 07:00:48.690: E/AndroidRuntime(23874): Caused作者：java.lang。NullPointerException 04-21 07:00:48.690: E/AndroidRuntime(23874): at com.arabicalphabets.reham.Wordgame2.onCreate(Wordgame2.java:36) 04-21 07:00:48.690: E/AndroidRuntime(23874):在 android.app.Activity.performCreate(Activity.java:4465) 04-21 07:00:48.690: E/AndroidRuntime(23874): 在 android.app.Instrumentation.callActivityOnCreate(Instrumentation.java:1052) 04-21 07 :00:48.690: E/AndroidRuntime(23874): 在 android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1934) 04-21 07:00:48.690: E/AndroidRuntime(23874): ... 还有 11 个在 android.app.Instrumentation.callActivityOnCreate(Instrumentation.java:1052) 04-21 07:00:48.690: E/AndroidRuntime(23874): 在 android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1934) 04-21 07 :00:48.690: E/AndroidRuntime(23874): ... 11 更多在 android.app.Instrumentation.callActivityOnCreate(Instrumentation.java:1052) 04-21 07:00:48.690: E/AndroidRuntime(23874): 在 android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1934) 04-21 07 :00:48.690: E/AndroidRuntime(23874): ... 11 更多

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-20T06:43:22.133

首先不是单独声明每个按钮，而是使用循环来声明它们......

```
Button[] buttons; 
for(int i=0; i<5; i++) {  //for your 5 buttons
{
 String buttonID = "bu" + (i+1);
 int resID = getResources().getIdentifier(buttonID, "id", getPackageName());
 buttons[i] = ((Button) findViewById(resID));
} 
```

- 使用 switch() 找到点击的按钮...

- 并作为案例实施`onclick()`如下

```
public void onClick(View v) {
        t1.setText(t1.getText().toString()+" "+buttons[i].getText().toString()); 
} 
```

希望它有效

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-20T16:37:30.443

我看不出它有什么问题，为什么它会崩溃，为什么该`if else`语句不起作用......？？

```
public class Wordgame2 extends Activity implements OnClickListener {

Button[] buttons; 
TextView t1;
ImageView i1, i2;
int i;
@Override
protected void onCreate(Bundle savedInstanceState) {
    // TODO Auto-generated method stub
    super.onCreate(savedInstanceState);
    setRequestedOrientation (ActivityInfo.SCREEN_ORIENTATION_PORTRAIT);
    // Full screen
    requestWindowFeature(Window.FEATURE_NO_TITLE);
        getWindow().setFlags(WindowManager.LayoutParams.FLAG_FULLSCREEN, 
                             WindowManager.LayoutParams.FLAG_FULLSCREEN);

    setContentView(R.layout.wordgame2);

    for(int i=0; i<5; i++) {  
        {
         String buttonID = "bu" + (i+1);
         int resID = getResources().getIdentifier(buttonID, "id", getPackageName());
         buttons[i] = ((Button) findViewById(resID));
         buttons[i].setOnClickListener(this);
        }
        }
    t1 = (TextView) findViewById(R.id.t1);

    i1 = (ImageView) findViewById(R.id.i1);
    i2 = (ImageView) findViewById(R.id.i2);

}
public void onClick(View v) {
    // TODO Auto-generated method stub

    switch (v.getId()){

    case R.id.bu1:
        t1.setText(t1.getText().toString()+" "+buttons[i].getText().toString());
        break;

    case R.id.bu2:
        t1.setText(t1.getText().toString()+" "+buttons[i].getText().toString());
        break;

    case R.id.bu3:
        t1.setText(t1.getText().toString()+" "+buttons[i].getText().toString());
        break;

    case R.id.bu4:
        t1.setText(t1.getText().toString()+" "+buttons[i].getText().toString());
        break; 
```

//当他们点击bu5时，如果t1正确为“abc d”，它将显示图片

```
 case R.id.bu5:

        if(t1.getText().toString().equals("a b c d")) //this is not working
        {

            i1.setVisibility(View.VISIBLE);
            i2.setVisibility(View.INVISIBLE);
        }       

        else {
            i2.setVisibility(View.VISIBLE);
            i1.setVisibility(View.INVISIBLE);
        }

        break;

    }
} 
```

}

# kinect - 更换 kinect 虚拟化模型

> ID：16115317
> 
> 赞同：0
> 
> 时间：2013-04-20T00:34:30.427
> 
> 标签：kinect, 3dsmax

我正在尝试更改 kinect avateering 中的花花公子模型 我尝试了很多方法没有人会出错，除非我替换 TGA 文件我使用 3D max 打开 dude.fbx 并尝试导入和重新导出它出错了，我有错误在构建中，我尝试用另一个 fbx 人体模型文件替换 whoke dude.fbx 文件，并且总是得到相同的错误“没有找到更具体的输入骨架我正在使用 3D 模型制作虚拟更衣室以使其更稳定比使用视频处理，所以我需要使用编程语言创建一个 3d 人体建模，所以我只使用了花花公子模型，请在这方面提供任何帮助

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-10T09:21:55.687

我也在做一个虚拟更衣室项目，我也和那个该死的家伙挣扎。有一个教程与您尝试的主题相同。

[http://mopred.blogspot.com/2012/11/changeing-avateering-avatar-in-kinect.html](http://mopred.blogspot.com/2012/11/changing-avateering-avatar-in-kinect.html)

但我认为创建自己的模型并转动、旋转和平移它们的最佳方法很容易。为骨骼模型制作动画会非常困难。

# c - wait() 系统调用 - 孩子会忽略这个吗？

> ID：16115321
> 
> 赞同：0
> 
> 时间：2013-04-20T00:35:28.980
> 
> 标签：c, concurrency, wait, system-calls

所以我在修订过程中看到了以下代码。我知道 wait() 会导致父母等待孩子停下来，但我对此有一些疑问。

首先，当孩子被创建时，我的假设是否得到纠正，即父母继续，改变 x 值，然后在 if 语句之后等待？

其次，当孩子继续执行并开始等待（）时，会发生什么？这是否被忽略了，因为它没有什么可等待的？

```
 #include <sys/types.h>
       #include <stdio.h>
       #include <unistd.h>
       int main() {
         int x = 1;
          pid_t pid = fork();
         if (pid == 0) {
             x = x * 2;
         } else if (pid > 0) {
             x = 3;
         }
         wait();
         // Print the value of x to the console
         printf("%d\n",x);
       } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-20T00:52:15.707

您可以在子执行开始时尝试调用 wait()。一旦在这个过程中没有孩子，调用就会被简单地忽略。

# objective-c - 具有静态类型检查的单态数组

> ID：16115324
> 
> 赞同：0
> 
> 时间：2013-04-20T00:35:45.103
> 
> 标签：objective-c

```
id<UIView> views = @[one, two, three];  
NSInteger object = [views lastObject]; // Compiler will warn me that `views` stores only UIViews 
```

我必须执行多远？有人有扩展clang以支持类似功能的经验吗？

[类似：nsmutablearray-force-the-array-to-hold-specific-object-type-only](https://stackoverflow.com/questions/5197446/nsmutablearray-force-the-array-to-hold-specific-object-type-only)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-20T00:48:06.977

我也考虑过这一点，尽管最后我问它真的会让我更有效率。在我看来，Objective-C 是一种非常实用的语言，它的特性在现实世界中很有用，块之类的东西非常有用，但在我的经验中，命名空间和类型化数组之类的特性并没有那么多。我在我的代码中添加了很多 NSAssert 来检查类似的东西。通常我的可变集合包含在其他类中，所以我对可以添加到它们的内容有很多控制，但也许这是我采用的一种模式，因为我没有类型化的集合？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-20T02:36:57.537

好吧，从技术上讲，您已经可以...

```
UIView *views[] = {one, two, three};  
NSInteger object = views[2]; 
```

或者，更有用的是，您可以使用 Objective-C++。

# c++ - 返回模板的嵌套类时出现语法错误

> ID：16115325
> 
> 赞同：0
> 
> 时间：2013-04-20T00:35:56.853
> 
> 标签：c++, templates, c++11, g++, syntax-error

我有以下类声明：

```
template <typename Key_T, typename Mapped_T, size_t MaxLevel = 5>
class SkipList
{

public:

  class Iterator
  {
    typedef std::pair<Key_T, Mapped_T> ValueType;
    template <typename Key1, typename Obj1, size_t MaxLevel1> friend class SkipList;
    public:
      //Iterator functions

    private:
      //Iterator Data
  };

  SkipList();
  ~SkipList();
  SkipList(const SkipList &);
  SkipList &operator=(const SkipList &);

  std::pair<Iterator, bool> insert(const ValueType &);
  template <typename IT_T>
  void insert(IT_T range_beg, IT_T range_end);

  void erase(Iterator pos);

private:
  //data
}; 
```

当我`SkipList` `insert`在类定义之外声明函数时

```
template <typename Key_T, typename Mapped_T, size_t MaxLevel>
typename std::pair<SkipList<Key_T,Mapped_T,MaxLevel>::Iterator, bool>  SkipList<Key_T,Mapped_T,MaxLevel>::insert(const ValueType &input) 
```

出现以下错误：

```
SkipList.cpp:349:69: error: type/value mismatch at argument 1 in template parameter list for ‘template<class _T1, class _T2> struct std::pair’
SkipList.cpp:349:69: error:   expected a type, got ‘SkipList<Key_T, Mapped_T, MaxLevel>::Iterator’
SkipList.cpp:349:72: error: ‘SkipList’ in namespace ‘std’ does not name a type
SkipList.cpp:349:80: error: expected unqualified-id before ‘&lt;’ token 
```

我的代码有什么问题？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-20T00:38:37.320

你需要`typename`关键字：

```
typename std::pair<typename SkipList<Key_T,Mapped_T,MaxLevel>::Iterator, bool>  SkipList<Key_T,Mapped_T,MaxLevel>::insert(const ValueType &input) 
```

否则编译器认为`Iterator`是类成员。

# c# - 多次卡住调用oracle程序

> ID：16115326
> 
> 赞同：0
> 
> 时间：2013-04-20T00:36:00.123
> 
> 标签：c#, oracle, plsql

任何方式我都可以加快速度。我每次都必须调用存储过程才能从 oracle 获取其最新值并进行更新。这是我的最后一个瓶颈，因为它可以被调用数千次。我将其他插入转换为数组绑定批量插入。

c#调用oracle

```
for (int i = 0; i < r.receiptkey.Count(); i++)
{       
  ld.receiptlinenumber.Add(AsnGetNextAvailableReceiptLineNumber(r.receiptkey[i]));
} 
```

时间：2019-04-10 标签：c#oracle

```
 public string AsnGetNextAvailableReceiptLineNumber(string myReceiptKey)
    {
        using (OracleCommand cmd = new OracleCommand())
        {
            OracleConnection conn;
            conn = new OracleConnection(ConnectionStringOracle);
            cmd.CommandText = "bpPack.GetNextReceiptLineNumber";
            cmd.CommandType = CommandType.StoredProcedure;
            cmd.Connection = conn;

            cmd.Parameters.Add(new OracleParameter("iReceiptKey", OracleDbType.Varchar2, 10));
            cmd.Parameters.Add(new OracleParameter("oRetValue", OracleDbType.Varchar2, 5)).Direction = ParameterDirection.Output;
            cmd.Parameters["iReceiptKey"].Value = myReceiptKey;
            conn.Open();
            try
            {
                cmd.ExecuteNonQuery();
            }
            catch (Exception e9)
            {
                return "Error" + e9.Message;
            }
            return cmd.Parameters["oRetValue"].Value.ToString();
        }
    } 
```

plsql

```
 PROCEDURE GetNextReceiptLineNumber(
   iReceiptKey IN VARCHAR2,
   oRetValue OUT VARCHAR2)
  IS
    xreceiptlinenumber VARCHAR2 (5);
    xreceiptlinecount  NUMBER (10);
  BEGIN
     xreceiptlinenumber :='';
     xreceiptlinecount  := 0;
     SELECT MAX (receiptlinenumber)
    INTO xreceiptlinenumber
     FROM receiptdetail
    WHERE receiptkey        = iReceiptKey;
   IF (xreceiptlinenumber IS NULL) THEN
    xreceiptlinecount    := 0;
  ELSE
    xreceiptlinecount := TO_NUMBER (LTRIM (xreceiptlinenumber, '0'));
  END IF;
  xreceiptlinecount := xreceiptlinecount + 1;
  oRetValue         := LPAD (xreceiptlinecount, 5, '0');
  END GetNextReceiptLineNumber; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-20T05:58:21.213

不要在每个过程调用上连接 - 单独的连接代码和您的过程调用代码。

* * *

您的过程可能会出现重复的情况（想象一下如果两个会话同时使用相同的键调用它会发生什么 - 如果可能，使用序列而不是最大值。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-20T11:50:51.027

您可能可以在 C# 代码中详细说明通过以下查询检索到的结果。

```
SELECT receiptkey, LPAD (nvl((to_number(MAX(receiptlinenumber))+1),'0'), 5, '0') as NextReceiptLineNumber
FROM receiptdetail
group by receiptkey 
```

# regex - 正则表达式太贪心；几乎吃了我所有的行

> ID：16115327
> 
> 赞同：1
> 
> 时间：2013-04-20T00:36:00.870
> 
> 标签：regex, cocoa, nsregularexpression

来自一些 XML 数据：

```
<Row A1:Height="17" ss:StyleID="s139">
    <Cell ss:StyleID="s69"><Data ss:Type="String">Title1</Data><NamedCell
      ss:Name="Print_Titles"/><NamedCell ss:Name="_FilterDatabase"/><NamedCell
      ss:Name="Print_Area"/></Cell>
    <Cell ss:StyleID="s70"><Data ss:Type="String">Title2</Data><NamedCell
      ss:Name="Print_Titles"/><NamedCell ss:Name="_FilterDatabase"/><NamedCell
      ss:Name="Print_Area"/></Cell>
</Row>

<Row A2:Height="17" ss:StyleID="s139">
    <Cell ss:StyleID="s69"><Data ss:Type="String">Title1</Data><NamedCell
      ss:Name="Print_Titles"/><NamedCell ss:Name="_FilterDatabase"/><NamedCell
      ss:Name="Print_Area"/></Cell>
    <Cell ss:StyleID="s70"><Data ss:Type="String">Title2</Data><NamedCell
      ss:Name="Print_Titles"/><NamedCell ss:Name="_FilterDatabase"/><NamedCell
      ss:Name="Print_Area"/></Cell>
</Row>
.... 
```

使用正则表达式，我试图只找到包含“Title1”和“Title2”单元格的第一行。

```
-(NSString *)extractDataFromXMLString:(NSString *)xmlString{

NSString *headerPattern =
@" *<Row[^>]*>\n"
@" *<Cell[^>]*>.*Title1.*</Cell>\n"
@" *<Cell[^>]*>.*Title2.*</Cell>\n"
@" *</Row>";

NSError *error = NULL;
NSRegularExpression *headerExpression = [NSRegularExpression 
    regularExpressionWithPattern:headerPattern                                                                      
options:NSRegularExpressionCaseInsensitive|NSRegularExpressionDotMatchesLineSeparators                                                                                  error:&error];

NSRange rangeOfFirstMatch = [headerExpression rangeOfFirstMatchInString:xmlString options:0 range:NSMakeRange(0, [xmlString length])]

return [xmlString substringWithRange:rangeOfFirstMatch]
} 
```

但是我返回了整个字符串有人可以帮助我吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-20T02:24:53.427

在您的模式中替换`.*`为`.*?`应该可以解决问题，尽管您应该认真考虑使用实际的 xml 解析器而不是正则表达式。

# jquery - 淡化输入文本jquery

> ID：16115329
> 
> 赞同：1
> 
> 时间：2013-04-20T00:36:36.323
> 
> 标签：jquery, css, input, jquery-animate, opacity

我正在尝试在我的网站上创建一个优雅的重置功能，这样当用户按下重置按钮时，输入框会淡出用户输入的文本，然后淡入占位符文本，准备好重新输入文本。

```
$.each($('input.search-box'), function () {

    var $input = $(this);

    // fade out text - this currently fades the whole element.. which I don't want
    $input.animate({ opacity: 0 }, 1000, function () {

        // reset to default value
        $input.val("");

        // fade text back in
        $input.animate({ opacity: 1 }, 1000)   
    });

}); 
```

以上显示了我想要实现的目标。但是这会使整个输入淡出然后进入。有人可以告诉我如何仅在文本上实现这种效果吗？

非常感谢，

凸轮。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-20T00:43:21.270

我正在考虑将值文本颜色设置为背景输入颜色，但 jQuery 不支持颜色动画，因此您需要[颜色](http://plugins.jquery.com/project/color)插件或[jQuery UI](http://jqueryui.com/)。两者都允许您使用用于背景颜色和颜色等属性的语法。

就像在[这里看到的](https://stackoverflow.com/questions/1354277/jquery-animate-text-color-for-input-field)

# css - 将规则添加到 Notepad++ 的 SourceCookifier 插件

> ID：16115333
> 
> 赞同：1
> 
> 时间：2013-04-20T00:37:43.013
> 
> 标签：css, regex, notepad++

我正在尝试在 SourceCookifier 中为 CSS 语言添加规则。

目前它显示的树列表

*   班级
*   选择器
*   身份

但我想添加自己的规则，

我将添加一些评论，例如：

```
/* Start Reset */
-- css rules here
/* End Reset */

/* Start Sidebar */
-- css rules here
/* End Sidebar */ 
```

现在我想展示我自己的函数树，叫做`section`

谢谢帮忙

![源代码](https://i.stack.imgur.com/hxfUA.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-06-18T01:46:42.033

我不确定我是否理解您的问题，但这是我相信您正在寻找的内容。

调出 CSS 的语言设置并添加新的标签类型。将描述设置为“部分”（或您喜欢的任何内容）。

对于输入，使用：/* Start (\w+)

对于输出，使用：\1

如果您将此规则应用于包含您提供的示例代码的文件，这将创建名为“重置”和“侧边栏”的部分。这就是你想要达到的效果吗？

# file - Shell脚本剪切文件的开头和结尾

> ID：16115335
> 
> 赞同：1
> 
> 时间：2013-04-20T00:37:52.890
> 
> 标签：file, shell, sed, cut

所以我有一个文件，我想剪掉它的前 33 行和最后 6 行。我想做的是在 cat 命令（cat 文件）中获取整个文件，然后使用“head”和“tail”命令删除这些部分，但我不知道该怎么做。例如（这只是想法）

```
cat file - head -n 33 file - tail -n 6 file 
```

我该怎么做？是否可以使用“sed”（如何）来做到这一点？提前致谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-20T09:07:59.663

这可能是你想要的：

```
$ tail -n +34 file | head -n -6 
```

见`tail`

> -n, --lines=K 输出最后K行，而不是最后10行；或使用 -n +K 输出以第 K 个开头的行

和`head`

> -n, --lines=[-]K 打印前 K 行而不是前 10 行；使用前导“-”，打印每个文件的最后 K 行以外的所有行

手册页。

例子：

```
$ cat file
one
two
three
four
five
six
seven
eight

$ tail -n +4 file | head -n -2
four
five
six 
```

请注意，您不需要`cat`（请参阅[UUOC](http://partmaps.org/era/unix/award.html)）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-20T00:52:45.130

首先计算总行数，然后打印中间部分：（**读取文件两次）**

```
l=$(wc -l file)
awk -v l="$l" 'NR>33&&NR<l-6' file 
```

或将文件加载到数组中，然后打印您需要的行：（**读取文件一次）**

```
awk '{a[NR]=$0}END{for(i=34;i<NR-6;i++)print a[i]}' file 
```

或者带头的awk，不要这么想：（**两次读取文件）**：

```
awk 'NR>33' file|head -n-6 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-20T19:16:51.773

这可能对您有用（GNU sed）：

```
sed '1,33d;:a;$d;N;s/\n/&/6;Ta;P;D' file 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-04-20T10:25:37.583

```
 sed -n '1,33b; 34{N;N;N;N;N};N;P;D' file 
```

这将工作 +

# ios - 更改 UITextView.inputView 时不调用 textViewDidChange？

> ID：16115344
> 
> 赞同：5
> 
> 时间：2013-04-20T00:39:58.383
> 
> 标签：ios, objective-c, uitextview, uitextviewdelegate

我拖动一个`UITextView`并将委托与`File's Owner`.
仅使用`textViewDidChange`默认键盘调用，但从我的键盘输入文本时没有任何反应。

如何`UITextView`在将其设置`inputView`为自定义键盘时启用委托？

这是我的代码

视图控制器.m

```
-(void)viewDidLoad{
    self.myKeyboard = [[[NSBundle mainBundle] loadNibNamed:@"MyKeyboard" owner:nil options:nil] objectAtIndex:0];
    [self.myKeyboard setTextView:self.textView];
}

#pragma mark TestViewDelegate
    - (void)textViewDidChange:(UITextView *)textView{
        NSLog(@"TextDidChange: %@",textView.text);
    } 
```

我的键盘.h

```
@interface MyKeyboard : UIView
@property (weak,nonatomic) id<UITextInput> textView;
-(void)setTextView:(id<UITextInput>)textView;
@end 
```

我的键盘.m

```
 -(void)setTextView:(id<UITextInput>)textView{
        _textView = textView;
        if ([textView isKindOfClass:[UITextView class]])
            [(UITextView *)textView setInputView:self];
        else if ([textView isKindOfClass:[UITextField class]])
            [(UITextField *)textView setInputView:self];
    } 
```

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2014-03-24T15:06:42.053

在您的自定义键盘中，您可能会`textView`使用 method更改内部文本`setText:`，但在此方法中所做的更改不会调用`textViewDidChanged`回调。[在文档](https://developer.apple.com/library/ios/documentation/uikit/reference/UITextViewDelegate_Protocol/Reference/UITextViewDelegate.html#jumpTo_7)
中阅读更多内容。

> **textViewDidChange：**
> 讨论
> 
> 文本视图调用此方法以响应用户对文本的更改。**不会调用此方法以响应以编程方式启动的更改。**

因此，您应该从键盘手动调用此方法。

# asp.net-mvc - 如何根据在 MVC4 中使用 jQuery AJAX 从服务调用中获得的结果显示/隐藏部分视图？

> ID：16115348
> 
> 赞同：1
> 
> 时间：2013-04-20T00:40:32.620
> 
> 标签：asp.net-mvc, razor, asp.net-mvc-4

我想要一个可以输入贷款号码的页面，然后我将调用 WCF 获取服务来查看贷款号码是否有效。如果贷款# 有效，我想在同一页面上显示贷款相关数据（部分视图）。

这是我的主要观点：

```
@model LoanStatus.Web.Models.Validate    
@{
    ViewBag.Title = "Validate";
}    
@section Scripts {
    @Scripts.Render("~/bundles/jquery")
    @Scripts.Render("~/bundles/jqueryval") 
    @Scripts.Render("~/bundles/jqueryui")
}    

<script type="text/javascript">

    jQuery(function ($) {
        $("#txtssn").mask("9999");
    });

    function validateRequest() {

        var $form = $('form');
        if ($form.valid()) {
            $.support.cors = true;

            var lnkey = $('#txtlnkey').val();                

            $.ajax({
                type: "GET",
                url: "http://localhost:54662/Service1/ValidateRequest/" + encodeURIComponent(lnkey),                    
                contentType: "application/json; charset=utf-8",
                dataType: "json",  //jsonp?
                success: function (response) {
                    $('#Result').html('Loading....');

                    if (response.ValidateRequestResult.toString().toUpperCase() == 'TRUE') {
                        alert('validated');

                    } else {
                        alert('cannot validated' + response.ValidateRequestResult.toString().toUpperCase());
                        //$("#Result").hide();
                    }

                    $('#Result').html(response.ValidateRequestResult);
                    //alert(response.ValidateRequestResult.toString());
                },
                error: function (errormsg) {
                    alert("ERROR! \n" + JSON.stringify(errormsg));                        
                }
            });
            //
        } else {
            $('#Result').html('Input Validation failed');
        }
    }
</script>   

@using (Html.BeginForm()) {

        <fieldset>
            <legend>Log in Form</legend>
            <ol>
                <li>
                    @Html.LabelFor(m => m.LoanKey, new{}) 
                    @Html.TextBoxFor(m => m.LoanKey, new { @id = "txtlnkey" })
                    @Html.ValidationMessageFor(m => m.LoanKey)
                </li>                    
            </ol>
            <input type="button" value="Get Status" onclick="javascript:validateRequest();" />
        </fieldset>
    }

<div id="Result">    
    @if (ViewBag.Validated)
    {
        @Html.Action("GetLoanInfo");
    }
</div> 
```

下面是我的控制器：

```
namespace LoanStatus.Web.Controllers
{
    public class ValidateController : Controller
    {
        //
        // GET: /Validate/
        [HttpGet]
        public ActionResult Index()
        {
            var model = new Validate() {LoanKey = "", Last4Ssn = ""};    
            ViewBag.Validated = false;                
            return View(model);
        }

        [HttpPost]
        public ActionResult Index(Validate model, bool validated)
        {
            // do login stuff
            ViewBag.Loankey = model.LoanKey;
            ViewBag.Validated = true;    
            return View(model);
        }

        public ActionResult GetLoanInfo() // SHOWs Search REsult
        {
           return PartialView("_LoanInfoPartial", ViewBag.Loankey);
        }

    }
} 
```

我希望`@Html.Action("GetLoanInfo");`只有在 jQuery AJAX 服务调用返回 TRUE 时才呈现“”（我有。我不知道该怎么做。如果我可以将值设置为in `alert('validated')`，我的问题可以解决。但根据我读到的内容，它不能在 jQuery 中设置。`ViewBag.Validated``success:function()`

我试过了`$("#Result").hide();`，`$("#Result").show();`但没有用。请帮忙。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-20T04:44:05.353

你可以试试这个：

在您的函数 validateRequest() ajax 成功中，在您显示 alert('validated'); 的地方 使用它并尝试：

```
$('#Result').load('@Url.Action("GetLoanInfo", "Validate")'); 
```

在您看来，使 Result div 为空

```
<div id="Result"> </div> 
```

告诉我它是否有帮助。

# java - JDBC 中的批量插入 - 单个事务会慢多少？

> ID：16115349
> 
> 赞同：0
> 
> 时间：2013-04-20T00:41:01.697
> 
> 标签：java, postgresql, jdbc

我刚刚发现 JDBC 的 addBatch 操作，如果给定 "INSERT INTO mytable (id, name) VALUES (?, ?)" 将创建如下内容：

```
BEGIN TRANSACTION
INSERT INTO mytable (id, name) VALUES (1, "a"); 
INSERT INTO mytable (id, name) VALUES (2, "b");
...
END TRANSACTION 
```

与这样的陈述相比：`"INSERT INTO mytable (id, name) VALUES (1, "a"), (2, "b"), .. "`，大规模交易会慢多少？I/O 的差异是否重要？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-20T05:19:18.717

PgJDBC 批处理一般不如 multi-valued 快`INSERT`，但*更*方便。

到目前为止，最有效的选择是`COPY`通过[PgJDBC 对`COPY`](http://jdbc.postgresql.org/documentation/publicapi/org/postgresql/copy/CopyManager.html).

第二种选择是打开一个事务，进行批量多值插入（比如说）每个插入 10 行，然后是一组单行插入以弥补差异，然后提交。

PgJDBC 批处理不应该比打开事务、准备语句、使用准备好的语句循环发送每一行的数据、然后执行显式提交快得多。我不*认为*它目前在批处理中一次有多个语句，但我不确定这一点，如果这样做的话，当网络延迟是一个因素时，这会使批处理显着加快。

我建议对其进行测试并了解其影响的实际想法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-20T05:04:49.633

批处理通常比其他方式更快。

下面是几个案例给你一个想法，假设这是相同的连接：

1.  自动提交已开启。DB 写入 TX 日志。批处理速度更快。
2.  自动提交已开启。DB 不写入 TX 日志。同样的速度，网络问题可能会导致批处理速度更快。
3.  自动提交已关闭。DB 写入 TX 日志。与 (2) 相同
4.  自动提交已关闭。DB 不写日志。与（2）相同。

由于查询通常在 TX 中执行，带有日志记录并且网络是瓶颈，因此批处理通常更快。出于同样的原因，ORM 框架提供了一种以批处理模式执行查询的工具。

# asp.net-mvc - 插入数据的 CRUD 操作

> ID：16115351
> 
> 赞同：0
> 
> 时间：2013-04-20T00:41:26.390
> 
> 标签：asp.net-mvc, asp.net-mvc-4, view

我的程序编译没有错误，但不幸的是它没有将数据插入数据库。数据库表被称为“客户”任何帮助都会很棒这是我在我的模型中的代码：

```
public ActionResult Apply()
    {
        return View();
    }

    //
    // POST: /Default1/Create

    [HttpPost]
    public ActionResult Apply(CUSTOMER customer)
    {
        if (ModelState.IsValid)
            return View();
        try
        {
            db.CUSTOMERs.Add(customer);
            db.SaveChanges();
            return RedirectToAction("Apply");
        }
        catch
        {
            return View();
        }
    } 
```

然后在我的mvc我有：

```
<%@ Page Title="" Language="C#" MasterPageFile="~/Views/Shared/Site.Master" Inherits="System.Web.Mvc.ViewPage<GreenEnergyGr.Models.CUSTOMER>" %> 
```

申请

```
<form id="form1" runat="server"> 
```

## 申请

```
<fieldset>
    <legend>CUSTOMER</legend>

    <div class="editor-label">
        <%: Html.LabelFor(model => model.CustomerName) %>
    </div>
    <div class="editor-field">
        <%: Html.EditorFor(model => model.CustomerName) %>
        <%: Html.ValidationMessageFor(model => model.CustomerName) %>
    </div>

    <div class="editor-label">
        <%: Html.LabelFor(model => model.CustomerSurname) %>
    </div>
    <div class="editor-field">
        <%: Html.EditorFor(model => model.CustomerSurname) %>
        <%: Html.ValidationMessageFor(model => model.CustomerSurname) %>
    </div>

    <div class="editor-label">
        <%: Html.LabelFor(model => model.CustomerAddress) %>
    </div>
    <div class="editor-field">
        <%: Html.EditorFor(model => model.CustomerAddress) %>
        <%: Html.ValidationMessageFor(model => model.CustomerAddress) %>
    </div>

    <div class="editor-label">
        <%: Html.LabelFor(model => model.CustomerLocation) %>
    </div>
    <div class="editor-field">
        <%: Html.EditorFor(model => model.CustomerLocation) %>
        <%: Html.ValidationMessageFor(model => model.CustomerLocation) %>
    </div>

    <div class="editor-label">
        <%: Html.LabelFor(model => model.CustomerTelephone) %>
    </div>
    <div class="editor-field">
        <%: Html.EditorFor(model => model.CustomerTelephone) %>
        <%: Html.ValidationMessageFor(model => model.CustomerTelephone) %>
    </div>

    <div class="editor-label">
        <%: Html.LabelFor(model => model.CustomerEmail) %>
    </div>
    <div class="editor-field">
        <%: Html.EditorFor(model => model.CustomerEmail) %>
        <%: Html.ValidationMessageFor(model => model.CustomerEmail) %>
    </div>

    <div class="editor-label">
        <%: Html.LabelFor(model => model.CustomerPostCode) %>
    </div>
    <div class="editor-field">
        <%: Html.EditorFor(model => model.CustomerPostCode) %>
        <%: Html.ValidationMessageFor(model => model.CustomerPostCode) %>
    </div>

    <p>
        <input type="submit" value="Send" />
    </p>
</fieldset> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-20T02:34:10.467

如果您的视图是有效的，那么您已经配置了您可能确实将数据保存到了您正在查看的数据库中。如果你没有在正确的地方正确地指定名称，实体框架会提取一个名称。查看服务器上的其他数据库，看看是否有流氓。

# ruby - 如何在 Sinatra 中创建类似 Rails 的前置过滤器？

> ID：16115358
> 
> 赞同：2
> 
> 时间：2013-04-20T00:42:41.140
> 
> 标签：ruby, sinatra

```
class Foo
  def do_before
    ...
  end

  def do_something
    ... 
```

有没有办法`do_before`在类中的其他方法之前运行方法`Foo`（如`do_something`）？

似乎 Sinatra`before`块在每个 HTTP 请求之前运行，这与该类无关。

编辑：正如迈克尔在评论中指出的那样，Rails 提供的唯一类似功能是在控制器中。但是，Rails 和 Sinatra 都提供了与此功能类似的功能。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-20T07:19:25.157

正如[iain](https://stackoverflow.com/users/335847/iain)在评论中指出的那样，您指定的示例并非特定于 Rails/Sinatra。我假设你想要像 Rails 中的过滤器一样，这就是 Sinatra 提供的：

Sinatra 的模块化应用程序：

```
class Foo < Sinatra::Base

  before do
    "Do something"
  end

  get '/' do
    "Hello World"
  end
end

class Bar < Sinatra::Base

  before do
    "Do something else"
  end

  get '/' do
    "Hello World"
  end
end 
```

在你的`config.rb`档案中，

```
require 'foo.rb'
require 'bar.rb'

map '/foo' do
  run Foo
end

map '/bar' do
  run Bar
end 
```

这是最接近 Sinatra 中 Rails 控制器的类比。创建更多这样的类，您将拥有类似的功能（类似，但可能与您在 Rails 世界中所期望的不同）。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-21T17:58:44.897

您还可以使用一些元编程来创建一个前置过滤器。例如：

```
class Foo
  def method_1; p "Method 1"; end
  def method_2; p "Method 2"; end
  def preprocess_method; p "Pre-Processing method"; end

  def self.before_filter m
    current_methods = instance_methods(false) - [m]
    self.new.instance_eval do
      current_methods.each do |meth|
        inst_method =  public_method(meth)
        self.class.send :define_method,inst_method.name do
          public_send m
          inst_method.call
        end
      end
    end
  end
  before_filter :preprocess_method
end

o = Foo.new
o.method_1
#output: 
"Pre-Processing method"
"Method 1"

o.method_2
#outputs
"Pre-Processing method"
"Method 2" 
```

在这种情况下，`preprocess_method`将在每次调用 Foo 类中定义的任何实例方法之前调用（即您的示例中的 do_before）。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-04-21T18:45:12.867

不知道你在做什么让你很难知道如何回答，但要增加网络上的信息；）我将提供@fmendez 答案的替代方案：

```
module Filterable
  def self.included(base)
    base.extend ClassMethods
  end
  module ClassMethods
    def do_before( name, &block )
      before_filters[name.to_sym] = block
    end
    def before_filters
      @before_filters ||= {}
    end
    def method_added( name )
      return if name.to_s.start_with?("unfiltered_")
      return if before_filters.has_key? name
      before_filters[name.to_sym] ||= nil
      alias_method "unfiltered_#{name}", name
      define_method name do |*args,&block|
        self.class.before_filters[name.to_sym].call if self.class.before_filters[name.to_sym]
        send "unfiltered_#{name}", *args, &block
      end
    end
  end
end

class Foo
  include Filterable

  def something( x )
    x * 3
  end

  do_before :something do
    puts "Before…"
  end
end

Foo.new.something 4 
```

输出：

> 之前…<br> # => 12

# text - 如何为您的网络服务器从手机接收文本，并使用文本的内容

> ID：16115362
> 
> 赞同：0
> 
> 时间：2013-04-20T00:43:29.927
> 
> 标签：text, message

今天我试图找出如何获取它，所以当一个人发短信时（我想为我的网站获取一个号码）但是当他们发短信时，文本的内容会进入我的数据库。但我的问题是，我在哪里可以看到能够接收短信？我知道这是可能的，因为 facebook 做到了。有任何想法吗？我知道这可能不属于这里，但我很困惑。

感谢您提前提供的所有帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-20T01:23:24.723

A simple way would be to get a [Twilio](https://www.twilio.com/) number and use their [API](https://www.twilio.com/sms/api) to receive SMS.

# c# - 我可以访问 ListViewItem.Tag 的属性而不仅仅是“ToString”方法吗？

> ID：16115364
> 
> 赞同：0
> 
> 时间：2013-04-20T00:43:40.150
> 
> 标签：c#, winforms, listview, inheritance

耐心点，不知道如何最好地问这个......

1.  我在 Windows 窗体上有一个 listView 控件，我向其中添加了作为特定目录中文本文件名称的项目。
2.  这些文件中的每一个都作为对象“ResultFile”加载，并根据其中的文本分配了许多属性 - “string Type”、“int NumberOfLines”、“bool IsGeneric”等。
3.  用户可以自由选择/取消选择，但我想根据他们已经选择的文本文件类型做出决定。作为一个粗略的想法，如果他们已经选择了一个 "Type=="x1" 我不希望他们能够选择另一个。如果他们选择了 2 个或更多 IsGeneric==true，我想给他们是一个警告......

我首先用这个扩展 ListViewItem

```
public class MyListViewItem : ListViewItem
{
    public string Type { get; set; }
    public int NumberOfLines { get; set; }
    public bool IsGeneric { get; set; }

    public MyListViewItem(string s)
        : base(s)
    { }
} 
```

我对此很满意，因为这是我第一次扩展控件（是的，我是新手）...这使我可以添加自己的“ListViewItems”类型，并且可以访问要制作的属性决定，但我找到了“标签”属性，并认为我可以将我的对象绑定到它并直接访问它们的项目。我查看了[MSDN](http://msdn.microsoft.com/en-us/library/system.windows.forms.listviewitem.tag.aspx)，它说我可以附加“任何”对象，但我不知道如何使用它。

除了访问默认对象方法外，我似乎无能为力。

```
 myListView.Item[1].Tag.ToString(); 
```

似乎是我能做的最多的了……

我是否缺少有关 ListViewItem.Tag 属性的内容？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-20T00:51:39.710

该`Tag`属性接受任何类型的对象`object`，因此从 object 继承的任何类都可以存储在其中。因此，如果您有这样的对象：

```
public class MyItem
{
    public string Type { get; set; }
    public int NumberOfLines { get; set; }
    public bool IsGeneric { get; set; }
} 
```

您可以将对象分配给标签字段，如下所示：

```
var myobj = new MyItem();
myobj.Type = "Type 1";
myListView.Items[1].Tag = myobj; 
```

并像这样检索对象：

```
var myobj = (MyItem)myListView.Items[1].Tag;
var type = myobj.Type; 
```

只有在您转换为之后，您`MyItem`才能访问您的自定义属性。否则你只会得到`object`属性和方法，其中之一是`.ToString()`.

# java - Java 和 Myro 突围游戏程序提前关闭

> ID：16115365
> 
> 赞同：0
> 
> 时间：2013-04-20T00:43:49.520
> 
> 标签：java, myro

我正在使用 java 和 myro 开发经典的突围游戏。程序加载球和桨，然后立即关闭程序。

我想要的是让 Myrobricks 的集合出现在窗口的顶部，然后球在随机方向移动并从桨上弹起。当它击中其中一个砖块时，砖块消失，球反弹。

这是代码：

```
import Myro.*;
import java.util.*;
import java.awt.*;

public class BreakOut
{
// declare the Scribbler object
private Scribbler robot;

private boolean intersects( MyroShape s1, MyroShape s2 )
{
    if( s1.getTop() >= s2.getBottom() || s1.getBottom() <= s2.getTop() || s1.getLeft() >= s2.getRight() || s1.getRight() <= s2.getLeft() )
        return false;
    else
        return true;
}

public void main()
{   //set a canvas that has 500 width, 500 height
    final int WIDTH = 500;
    final int HEIGHT = 500;
    MyroCanvas myCanvas = new MyroCanvas( "Breakout",WIDTH, HEIGHT );

    int brickX = 0;
    int brickY = 60;

    //creating the collection of bricks
    Collection<MyroRectangle> bricks = new ArrayList<MyroRectangle>();

    //create a rectangle(the paddle)
    MyroRectangle paddle = new MyroRectangle( myCanvas, 205, 475, 90, 25 );
    //make it visible
    paddle.makeFilled();
    paddle.setFillColor( Color.green );
    paddle.visible();
    //create a ball
    MyroCircle ball = new MyroCircle( myCanvas, 250, 465, 10 );
    ball.makeFilled();
    ball.setFillColor( Color.blue );
    ball.visible();
    //choose a random Delta X(negative) & Y(not 0)
    int deltaX = MyroUtils.randomInt( -4,-1 );
    int deltaY = MyroUtils.randomInt(-4, 4);
    //if it chooses zero, do another one

    myCanvas.setAutoRepaint( false );

    for ( int c = 0; c<9; c++ )
    {
        brickX = 0;
        for (int r = 0; c<4; c++)
        { 
            MyroRectangle rectangles = new MyroRectangle( myCanvas, brickX, brickY, 50, 20 );

            int red = MyroUtils.randomInt (0, 255);
            int green = MyroUtils.randomInt (0, 255);
            int blue = MyroUtils.randomInt (0, 255);

            rectangles.setFillColor( new Color (red, green, blue ));
            rectangles.makeFilled();
            rectangles.visible();
            bricks.add( rectangles );
            brickX = brickX + 50;
        }
        brickY = brickY + 20;
    }
    while (deltaY == 0)
    {
        deltaY = MyroUtils.randomInt(-4, 4);
    }
    boolean finished = false;
    while (!finished)
    {
        ball.move( deltaX, deltaY );
        MyroUtils.sleep( 0.01);
        int bricksCount = 40;
        //implementing the paddle that is controlled by the A and D keys
        if( MyroListener.isKeyPressed() )
        {
            if( MyroListener.whichKey() == 'q' )
            {
                // quit
                finished = true;
            }
            else if( MyroListener.whichKey() == 'a' )
            {
                paddle.move( -4,0 );
                if( paddle.getLeft() < 0 )
                {
                    paddle.move( 0, 0 );
                }
            }
            else if( MyroListener.whichKey() == 'd' )
            {
                paddle.move( 4,0 );
                if( paddle.getRight() > 500 )
                {
                    paddle.move( 0, 0 );
                }
            }
        }

        if ( ball.getBottom() == 500 )
            finished = true;

        if ( ball.getBottom()==0 )
            ball.move(deltaX,-deltaY);

        if ( ball.getLeft()==0 || ball.getRight()==500 )
            ball.move(-deltaX, deltaY);

        if( intersects( ball, paddle ))
            ball.move(deltaX,-deltaY);

        myCanvas.repaint();

        for (MyroRectangle rectangles : bricks)
        {
            if(rectangles.isVisible() && intersects( ball, rectangles ))
            {
                rectangles.invisible();
                deltaY = -deltaY;
                bricksCount--;
            }
        }
        if( bricksCount == 0 )
        {
            finished = true;
            MyroGUI.tellUser( "Congratulation!" );
        }
        myCanvas.setVisible( false );
    }
}
} 
```

关于这段代码有什么问题的任何想法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-20T00:59:43.543

我认为问题是：

```
myCanvas.setVisible（假）；
```

在该声明之前，您的画布可见，将其更改为：

```
myCanvas.setVisible(true);
```

看看有什么不同。即使这不是解决方案，您也不应该将该语句保留在那里，`JPanel.setVisible()`如果设置为 true，则该方法用于将面板设置为对用户可见，并且您正在将面板设置为在它显示后不久不可见。如果这是您的意图，那不会关闭正在运行的程序。

# java - 将 jruby 脚本打包为带有注释的 .jar

> ID：16115366
> 
> 赞同：2
> 
> 时间：2013-04-20T00:43:54.023
> 
> 标签：java, jar, jruby

有没有办法将 jruby 脚本打包为支持注释的 .jar 文件？我不认为[莺](https://github.com/jruby/warbler)会这样做。[jruby2java](https://kenai.com/projects/ruby2java)看起来它支持注释，但它已经四年没有更新了。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-20T08:53:19.553

[JRuby 编译器](https://github.com/jruby/jruby/wiki/JRubyCompiler)是 JRuby 核心功能的一部分，它具有允许您在 JRuby 代码中定义注释的方法`java_annotation`。

这是一个带有 Spring MVC 注释的示例，其中在类`GreetingController`和`print`方法上添加了注释：

```
java_import 'org.springframework.stereotype.Controller'
java_import 'org.springframework.web.bind.annotation.RequestMapping'
java_import 'org.springframework.web.bind.annotation.RequestMethod'
java_import 'org.springframework.ui.ModelMap'

java_package 'com.weblogism.myapp'
java_annotation 'Controller'
java_annotation 'RequestMapping("/welcome")'
class GreetingController

  java_annotation 'RequestMapping'
  java_signature 'String print(ModelMap model)'
  def print(model)
    model.add_attribute('greeting', 'Hello, World!')
    "index"
  end
end 
```

（完整示例可以在[github](https://github.com/tychobrailleur/jruby-springmvc)上找到；JRuby 编译器由 调用`jruby-maven-plugin`）

# python - 用于多个窗口的 Tkinter 示例代码，为什么按钮无法正确加载？

> ID：16115378
> 
> 赞同：41
> 
> 时间：2013-04-20T00:46:32.473
> 
> 标签：python, class, tkinter, destroy

我正在编写一个程序，它应该：

1.  按下按钮打开一个窗口。
2.  按下另一个按钮关闭新打开的窗口。

我正在使用类，因此我可以稍后将代码插入到更大的程序中。但是，我无法让我的按钮正确加载。

```
import tkinter as tk

class Demo1(tk.Frame):
    def __init__(self):
        tk.Frame.__init__(self)
        self.pack()
        self.master.title("Demo 1")
        self.button1 = tk.Button(self, text = "Button 1", width = 25,
                               command = self.new_window)
        self.button1.grid(row = 0, column = 1, columnspan = 2, sticky = tk.W+tk.E+tk.N+tk.S)

    def new_window(self):
        self.newWindow = Demo2()

class Demo2(tk.Frame):
    def __init__(self):
        new = tk.Frame.__init__(self)
        new = tk.Toplevel(self)
        new.title("Demo 2")
        new.button = tk.Button(text = "Button 2", width = 25,
                               command = self.close_window)
        new.button.pack()

    def close_window(self):
        self.destroy()

def main():
    Demo1().mainloop()

if __name__ == '__main__':
    main() 
```

* * *

## 回答 #1

> 赞同：63
> 
> 时间：2013-04-20T01:33:35.567

我以更有条理、更实用的方式重写了您的代码：

```
import tkinter as tk

class Demo1:
    def __init__(self, master):
        self.master = master
        self.frame = tk.Frame(self.master)
        self.button1 = tk.Button(self.frame, text = 'New Window', width = 25, command = self.new_window)
        self.button1.pack()
        self.frame.pack()

    def new_window(self):
        self.newWindow = tk.Toplevel(self.master)
        self.app = Demo2(self.newWindow)

class Demo2:
    def __init__(self, master):
        self.master = master
        self.frame = tk.Frame(self.master)
        self.quitButton = tk.Button(self.frame, text = 'Quit', width = 25, command = self.close_windows)
        self.quitButton.pack()
        self.frame.pack()

    def close_windows(self):
        self.master.destroy()

def main(): 
    root = tk.Tk()
    app = Demo1(root)
    root.mainloop()

if __name__ == '__main__':
    main() 
```

结果：

[![演示1窗口](https://i.stack.imgur.com/dL5KA.png)](https://i.stack.imgur.com/dL5KA.png) [![Demo2 窗口](https://i.stack.imgur.com/9FbGu.png)](https://i.stack.imgur.com/9FbGu.png)

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2013-04-20T01:28:02.817

您需要为第二个按钮指定主控。否则它将被打包到第一个窗口中。这不仅需要 . `Button`，还需要其他小部件和非 gui 对象，例如`StringVar`.

**快速修复：**将框架添加为in`new`的第一个参数。`Button``Demo2`

**可能更好：**目前你已经`Demo2`继承了，但我认为如果你变成这样的东西，`tk.Frame`这更有意义，`Demo2`

```
class Demo2(tk.Toplevel):     
    def __init__(self):
        tk.Toplevel.__init__(self)
        self.title("Demo 2")
        self.button = tk.Button(self, text="Button 2", # specified self as master
                                width=25, command=self.close_window)
        self.button.pack()

    def close_window(self):
        self.destroy() 
```

正如一个建议，您应该只导入`tkinter`一次。选择前两个导入语句之一。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2014-08-04T14:57:20.267

```
#!/usr/bin/env python
import Tkinter as tk

from Tkinter import *

class windowclass():

        def __init__(self,master):
                self.master = master
                self.frame = tk.Frame(master)
                self.lbl = Label(master , text = "Label")
                self.lbl.pack()
                self.btn = Button(master , text = "Button" , command = self.command )
                self.btn.pack()
                self.frame.pack()

        def command(self):
                print 'Button is pressed!'

                self.newWindow = tk.Toplevel(self.master)
                self.app = windowclass1(self.newWindow)

class windowclass1():

        def __init__(self , master):
                self.master = master
                self.frame = tk.Frame(master)
                master.title("a")
                self.quitButton = tk.Button(self.frame, text = 'Quit', width = 25 , command = self.close_window)
                self.quitButton.pack()
                self.frame.pack()

        def close_window(self):
                self.master.destroy()

root = Tk()

root.title("window")

root.geometry("350x50")

cls = windowclass(root)

root.mainloop() 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2019-08-06T05:12:10.980

我尝试使用上面的 Rushy Panchal 示例使用两个以上的窗口。目的是改变调用更多带有不同小部件的窗口。butnew 函数创建不同的按钮来打开不同的窗口。您将包含窗口的类的名称作为参数传递（第二个参数不是必需的，我把它放在那里只是为了测试可能的用途。从另一个窗口继承共同的小部件可能会很有趣。

```
import tkinter as tk

class Demo1:
    def __init__(self, master):
        self.master = master
        self.master.geometry("400x400")
        self.frame = tk.Frame(self.master)
        self.butnew("Window 1", "ONE", Demo2)
        self.butnew("Window 2", "TWO", Demo3)
        self.frame.pack()

    def butnew(self, text, number, _class):
        tk.Button(self.frame, text = text, width = 25, command = lambda: self.new_window(number, _class)).pack()

    def new_window(self, number, _class):
        self.newWindow = tk.Toplevel(self.master)
        _class(self.newWindow, number)

class Demo2:
    def __init__(self, master, number):
        self.master = master
        self.master.geometry("400x400+400+400")
        self.frame = tk.Frame(self.master)
        self.quitButton = tk.Button(self.frame, text = 'Quit', width = 25, command = self.close_windows)
        self.label = tk.Label(master, text=f"this is window number {number}")
        self.label.pack()
        self.quitButton.pack()
        self.frame.pack()

    def close_windows(self):
        self.master.destroy()

class Demo3:
    def __init__(self, master, number):
        self.master = master
        self.master.geometry("400x400+400+400")
        self.frame = tk.Frame(self.master)
        self.quitButton = tk.Button(self.frame, text = 'Quit', width = 25, command = self.close_windows)
        self.label = tk.Label(master, text=f"this is window number {number}")
        self.label.pack()
        self.label2 = tk.Label(master, text="THIS IS HERE TO DIFFERENTIATE THIS WINDOW")
        self.label2.pack()
        self.quitButton.pack()
        self.frame.pack()

    def close_windows(self):
        self.master.destroy()

def main(): 
    root = tk.Tk()
    app = Demo1(root)
    root.mainloop()

if __name__ == '__main__':
    main() 
```

### 新窗口只打开一次

为了避免有机会多次按下具有多个窗口的按钮......这是同一个窗口，我制作了这个脚本（也看看[这个页面](https://pythonprogramming.altervista.org/tkinter-open-a-new-window-and-just-one/)）

```
import tkinter as tk

def new_window1():
    global win1
    try:
        if win1.state() == "normal": win1.focus()
    except:
        win1 = tk.Toplevel()
        win1.geometry("300x300+500+200")
        win1["bg"] = "navy"
        lb = tk.Label(win1, text="Hello")
        lb.pack()

win = tk.Tk()
win.geometry("200x200+200+100")
button = tk.Button(win, text="Open new Window")
button['command'] = new_window1
button.pack()
win.mainloop() 
```

* * *

## 回答 #5

> 赞同：-2
> 
> 时间：2018-05-01T08:32:12.477

您可以做的是将代码复制`tkinter.py`到一个名为 的文件`mytkinter.py`中，然后执行以下代码：

```
import tkinter, mytkinter
root = tkinter.Tk()
window = mytkinter.Tk()
button = mytkinter.Button(window, text="Search", width = 7,
                               command=cmd)
button2 = tkinter.Button(root, text="Search", width = 7,
                               command=cmdtwo) 
```

而且您有两个不会碰撞的窗口！

# javascript - 确定元素的 offsetTop 并将其设置在其他元素上

> ID：16115380
> 
> 赞同：0
> 
> 时间：2013-04-20T00:47:40.350
> 
> 标签：javascript, angularjs

有一个项目列表。如果单击一个项目，则该项目旁边会显示另一个视图。我希望这个视图与项目具有相同的 offsetTop。我知道如何在 jQuery 中做到这一点，但是在纯 angularjs 中找不到解决方案。这是我到目前为止尝试过的

```
top = angular.element('#user'+user.id).prop('offsetTop');
angular.element('#feed-details').css('margin-top', top); 
```

这没有效果。任何想法如何在 angularjs 中实现这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-20T01:12:29.367

长度必须有一个单位。`offsetTop`是一个无单位数。所以只需添加`"px"`它。

也就是说，你可以在[Vanilla JavaScript](http://vanilla-js.com/)中做到这一点：

```
document.getElementById('feed-details').style.marginTop =
            document.getElementById('user'+user.id).offsetTop+"px"; 
```

# javascript - 如何在 jQuery 中模拟单选按钮功能？

> ID：16115381
> 
> 赞同：0
> 
> 时间：2013-04-20T00:47:44.930
> 
> 标签：javascript, jquery, twitter-bootstrap, toggleclass

我有 3 个按钮，每个按钮都有一个复选框：

```
<div id="btn_group">
    <button class="btn"><i class="icon-check-empty"></i> One</button>
    <button class="btn"><i class="icon-check-empty"></i> Two</button>
    <button class="btn"><i class="icon-check-empty"></i> Three</button>
</div> 
```

我当前的 jQuery 看起来像这样：

```
$('.btn').on('click',function() {
    $('#btn_group > .btn > i').removeClass('icon-check').addClass('icon-check-empty');
    $(this).children('i').toggleClass('icon-check-empty icon-check');
}); 
```

这是需要发生的事情：

1）单击按钮1：按钮1选中，所有其他未选中

2) 再次单击按钮 1：按钮 1 未选中，所有其他按钮仍未选中

3）点击按钮1：（见#1）

4) 单击按钮 2：按钮 2 已选中，其他所有未选中（如单选按钮）

基本上我需要一组单选按钮，允许您取消选中当前选择，但不允许选择多个。全部通过 JS 和 jQuery 模拟。你能帮我吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-20T00:52:08.980

你可以用一个班级来做到这一点。

```
$('.btn').on('click',function() {
    $(this).toggleClass('icon-check').siblings().removeClass('icon-check');
} 
```

# sql-server - 使用 SSPI，如何使我的 webapp 不连接到本地 SQL Express？

> ID：16115382
> 
> 赞同：1
> 
> 时间：2013-04-20T00:47:55.857
> 
> 标签：sql-server, iis-7

是的 - 你没看错！我想让我的网络应用程序**不连接**到本地 SQL Server Express (2008R) 数据库！

我为我的 Web 应用程序创建了一个域用户帐户，并将该用户添加到域 (AD) 组中。

在我的本地 SQL Server 实例中，我[为该 AD 组创建了一个登录名](https://stackoverflow.com/questions/5029014/how-to-add-active-directory-user-group-as-login-in-sql-server)。在 sql 数据库中绝对没有提到用户帐户。

然后在我的本地 IIS 中，我更改了该站点的应用程序池以使用我刚刚创建的帐户。

当我在浏览器中浏览本地站点时，瞧！它连接到数据库。

好的，所以我进入 AD 并从 AD 组中删除该用户帐户。我做一个iisreset。现在我在浏览器中浏览我的本地站点，瞧！？它连接到数据库。

嗯？它是如何连接的？通过使用`[Integrated Security=SSPI][2]`，应该通过应用程序池正在使用的帐户进行身份验证。那么，既然它不属于有权访问sql数据库的组，那么它不应该失败吗？

我怎样才能让它失败？也许它正在通过其他一些 Windows 身份验证进行连接？好的，只有我的服务器实例的登录名是：

*   mydomaingroup（没有我的应用程序池的用户帐户）
*   我的域管理员帐户
*   萨
*   NT AUTHORITY\NETWORK SERVICE（一切都需要，[甚至是 sql 日志查看器](https://dba.stackexchange.com/questions/40489/accidentally-deleted-sql-server-log-reader-service-account/40490#40490)）

并且 - 我可以确认这些登录中没有一个是用户映射到我的数据库允许的用户，但特殊域组除外。

啊，更糟了。如果连接字符串使用`SSPI`，那么它应该接受并使用用户名和密码（如果存在）。因此，如果我指定了我现在离开 AD 组的帐户的用户名和密码，那么应用程序池不应该尝试使用错误的凭据登录吗？——你会这么想，但是，再一次，瞧！它连接！

因此，这两个连接字符串都连接到在 sql server 实例中似乎没有凭据的域用户帐户：

```
 <add name="development" connectionString="server=mycomputer\sqlexpress;database=shoppe;Persist Security Info=False;Integrated Security=SSPI; user id=myuser; password=mypassword; Pooling=True" providerName="System.Data.SqlClient"/>

    <add name="development" connectionString="server=mycomputer\sqlexpress;database=shoppe;Persist Security Info=False;Integrated Security=SSPI; Pooling=True" providerName="System.Data.SqlClient"/> 
```

我什至尝试添加`Trusted_Connection=False;`，它仍然连接！

那么，它从哪里获得连接权限？有没有办法告诉正在使用哪个帐户进行连接？

另一方面，如果我`Integrated Security=SSPI;`从连接字符串中删除，那么我根本无法使用 Windows 身份验证进行连接。我不知道这是否是一个线索。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-25T03:42:12.067

系统存储过程 xp_logininfo [http://msdn.microsoft.com/en-us/library/ms190369.aspx](http://msdn.microsoft.com/en-us/library/ms190369.aspx)可以告诉您帐户连接到 sql server 时正在使用哪个访问路径。例如，它被授予访问权限的组以及该登录的有效权限是什么。

# android - 离线使用谷歌地图

> ID：16115391
> 
> 赞同：1
> 
> 时间：2013-04-20T00:49:23.140
> 
> 标签：android, google-maps

我想在我的android应用程序中使用google maps API。（*该应用程序不需要互联网连接*）是否可以下载某个城市的地图文件，然后使其可供离线使用？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-20T12:20:55.423

使用 Google 地图图块是不可能的，但您可以尝试将 Android API v2 与 OpenStreetMap 或其他图块集成。

# html - 创建一个 JQuery Mobile 样式列表视图（没有 JQM）

> ID：16115393
> 
> 赞同：0
> 
> 时间：2013-04-20T00:49:38.450
> 
> 标签：html, css, html-lists

我正在尝试制作一个类似于下面链接中的列表的列表视图（但不使用 JQM）。 [http://view.jquerymobile.com/1.3.1/dist/demos/widgets/listviews/#list-formatted](http://view.jquerymobile.com/1.3.1/dist/demos/widgets/listviews/#list-formatted)

在过去几天尝试了各种方法之后（包括复制 JQM 属性的错误尝试），这就是我目前拥有的：

[http://jsfiddle.net/GNnN2/](http://jsfiddle.net/GNnN2/)

但是仍然存在一些问题：

*   li border-bottom 出现在顶部而不是底部
*   在小宽度处，点与文本重叠而不是显示椭圆
*   点（箭头）未正确垂直居中

这是HTML：

```
<ul>
  <li>
    <a href="#">
      <div>
        <span class="label">Richard F. Godwin</span><br/>
        <span class="subtext">Direct Research Representative</span><br/>
        <span class="subtext">Ann Arbor, MI</span>
      </div>
      <img class="icon"></img>
    </a>
  </li>
</ul> 
```

和CSS：

```
body {
    margin: 0;
    padding: 0;
}
ul {
    list-style-type: none;
    margin: 0px;
    padding: 0px;
    width: 100%;
    float: left;
    overflow: hidden;
}
ul li {
    clear: both;
    margin: 0px;
    padding: 0px;
    background-color: #ffffff;
    border-bottom: 1px solid #bbb;  /* appears at the top instead of bottom */
}
ul li a {
    padding: 15px 20px;
    margin: 0px;
    width: 100%;
    float: left;
}
ul li a div {
    margin: 0;
    padding: 0px;
    width: 80%;
    float: left;
    display: block;
}
ul li a div span.label {
    font-size: 15px;
    font-weight: normal;
    white-space: nowrap;
    text-overflow: ellipsis;
}
ul li a div span.subtext {
    margin-left: 10px;
    color: #067ab4;
    font-size: 14px;
    font-weight: normal;
    white-space: nowrap;
    text-overflow: ellipsis;    /* always overlaps instead of showing ellipses on short widths */
}
ul li a img {
    height: 18px;
    width: 18px;
    background-color: rgba(0, 0, 0, .4);
    -webkit_border-radius: 9px;
    border-radius: 9px;
    display: block;
    background-repeat: no-repeat;
    float: right;
    position: relative;
    margin-top: 11px;        /* not centered correctly when li has a different height */
    right: 35px;
    display: block;
    vertical-align: middle;
} 
```

CSS定位和样式对我来说大多是新的。任何帮助是极大的赞赏。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-20T07:02:23.323

好吧，我想我已经做了很多他们在 jquery 所做的事情。为了使图像居中，我基本上只是将其作为背景。为了修复我添加的边框 ，差不多`overflow:hidden;`就是这样。

**这是一个小提琴：http:** [//jsfiddle.net/GNnN2/4/](http://jsfiddle.net/GNnN2/4/)

# c# - WindowStyle=None 的 CustomChrome 问题，正在恢复窗口

> ID：16115406
> 
> 赞同：0
> 
> 时间：2013-04-20T00:51:31.110
> 
> 标签：c#, wpf

这是我的问题的一些背景：

我下载了[CustomChromeLibrary](http://www.codeproject.com/Articles/131515/WPF-Custom-Chrome-Library)，并将 Shell Reference 从 Microsoft.Windows.Shell 更改为 System.Windows.Shell，这与框架 4.5 中的相同。

从 CustomChromeSample 工作，我可以显示一个 CustomChrome 窗口，但是如果我在 MainWindow.xaml 中更改以下属性：

1.  窗口样式=无
2.  AllowTransparency=True
3.  背景=透明

（请注意 WindowStyle=None 单独导致问题）

然后，如果我按以下顺序更改 WindowState：

1.  正常（初始化状态）
2.  最大化（单击按钮最大化）
3.  最小化（点击按钮最小化）
4.  正常（单击任务栏中的程序图标）

然后程序图标从任务栏中消失，我不知道为什么。

那么，有人有想法吗？另外，有什么地方可以上传代码给你看吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-21T05:44:48.663

好吧，不管了。我使用 MahApps.MetroWindow 并复制粘贴了他们的主题，这样我就可以按照自己的意愿更改它，同时保留普通窗口的所有功能。他们的代码真的很棒。

# php - 为什么仅在 Chrome 中重定向后没有保存会话变量？

> ID：16115409
> 
> 赞同：2
> 
> 时间：2013-04-20T00:51:48.240
> 
> 标签：php, google-chrome, session, redirect

在 Firefox 中，会话变量在重定向后被保存并可检索，但在 Chrome 中，重定向后，它说它不存在。

重定向代码：

```
session_start();
$_SESSION[ "test" ] = "exists";
session_write_close();
header( "HTTP/1.1 301 Moved Permanently" ); //Removing this 301 line doesn't help
header( "Location: http://" . $_SERVER[ "HTTP_HOST" ] . "/" );
exit(); 
```

检索会话：

```
session_start();
if ( isset( $_SESSION[ "test" ] ) )
{
    echo $_SESSION[ "test" ];
    unset( $_SESSION[ "test" ] );
} 
```

为什么这在 chrome 中不起作用？

**编辑：我想我找到了答案，但这没有意义。** 如果我删除该行`unset( $_SESSION[ "test" ] )`，那么它会在重定向后保存会话！但为什么会出现这种情况？会话应该是服务器端的。我在“回声”声明之后取消了它！它怎么不会因为我在那**之后**取消设置变量而回显该值？！

有谁知道发生了什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-20T02:59:52.687

处理重定向的方式可能存在问题。您现在通过在标头中指定位置来告诉浏览器重定向异地（即使我们并没有真正离开异地）`http://`。

```
header( "Location: http://" . $_SERVER[ "HTTP_HOST" ] . "/" ); 
```

如果你用它替换它，它可能会帮助浏览器保持`SESSION`活动状态，因为它认为它在同一个站点上：

```
header("Location: /"); 
```

此外，如果您执行以下操作会发生什么情况：

```
if (!empty( $_SESSION[ "test" ] ) ){
$test = $_SESSION[ "test" ];
unset( $_SESSION[ "test" ] );

echo $test;
} 
```

如果我没记错的话，PHP 将首先执行所有服务器端功能，然后将代码从 print 和 echo 语句返回给用户。

如果我是对的，那么如果确实是 unset 命令导致代码不起作用，那么这段代码将适用于两个浏览器（因为我们将 var 保存到可以在`SESSION`被销毁后回显的东西.

如果它不起作用，那么它很可能是由于重定向导致的浏览器会话处理的差异。

**更新**

另请注意，可以缓存 301 重定向。您正在一个已经告诉您的浏览器永久移动的页面上执行这些功能。`SESSION`如果它在后续尝试中依赖缓存，它甚至可能根本看不到设置 的页面。

**更新 4/22**

检查标题后。在我正在运行的 Chrome 版本中（`Version 26.0.1410.64 m`在 Windows 和`Version 26.0.1410.65`Mac OS 上）我没有遇到这个特定问题。无论是否存在`unset()`命令，本地 URL 与非现场 URL 是否存在。

您可以在*Chrome*中打开*开发人员工具*（工具 > 开发人员工具或 Windows 上的 Ctrl-Shift-i 或 Mac 上的 Command-Shift-i）并查看“*网络*”选项卡下的标题输出。您的域重定向可能会导致 a被丢弃。**`SESSION`**

 **它可能特定于您本地计算机上的设置或您为特定操作系统构建的 Chrome（如果它与我自己的不同）。此外，它可能是 PHP 中的配置设置以及您实际传递`SESSION`s. 我只是将您的代码直接从问题粘贴到一个新页面中，并创建了一个页面以将其重定向到。经过测试，我机器上的所有浏览器（Chrome、Firefox、IE (7,8,9)、Opera、Safari 和 Mozilla）都说“存在”。

这是我的测试机器的`SESSION`设置（来自`phpinfo()`）： ![PHP 会话截图](https://i.stack.imgur.com/xIYFb.png)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-20T06:34:17.873

问题是由于 Chrome 对同一页面的多次请求。没有其他浏览器以相同的方式执行此操作，因此该问题仅出现在 Google Chrome 中。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-12-24T09:40:50.703

我不确定您的情况是否与我的情况相似。但对我来说，原因是 URL 的形成。

使用 chrome，在将 URL 键入为“ [http://www.domainname.com](http://www.domainname.com) ”并在那里设置会话变量时。

**并在没有WWW的情况下使用“** [http://domainname.com](http://domainname.com) ”重定向。sessionid 没有被重用。

 **这解决了我的问题希望这对某人有帮助。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2013-11-27T12:43:35.400

我们可以通过两种方式解决这个问题

一世 。在 Firefox 浏览器设置中将字符编码更改为“UTF-8”

二、通过PHP代码在页面添加“header('Content-Type: text/html; charset=utf-8');” 你要发布的

谢谢， 苏雷什·拉马克里希南****

# java - 获取 ArrayList 以保留每个帐户的余额和编号

> ID：16115416
> 
> 赞同：0
> 
> 时间：2013-04-20T00:52:34.153
> 
> 标签：java, multidimensional-array

我已经完成了我的程序，并且一直在获取每个帐户余额

例如

如果我输入第一个储蓄账户余额，它会正常工作但是当我打开另一个储蓄账户时，第一个账户的账户余额将显示我输入的最后一个账户余额我想知道我必须做什么来纠正这个错误帮助会做谢谢

```
package Object_1_Programs;
import  java.util.Date;
/**
 *
 * 
 */
public abstract class Account {

    //instance variables decleared
    private String c_name;
    private String acc_num;
    private double acc_balance;
   java.util.ArrayList transactions=new java.util.ArrayList();

   //default constructor 
    public Account(){

    }
    //Constructor

    public Account(String c_name,String acc_num,double  acc_balance){
        this.c_name=c_name;
        this.acc_num=acc_num;
        this.acc_balance=acc_balance;
    }

    //getters and setter method
    public String setName(){
        return this.c_name;
    }    

    public String getCname(){
        return this.c_name;
    }

    public String SetAccnum(String acc_number){
        return this.acc_num;
    }

    public String GetAccNum(){
        return this.acc_num;
    }

    public double setBalance(double balance){
        return this.acc_balance=balance;
    }

    public double getBalance(){
        return this.acc_balance;
    }
//end of getters an setters method

    //toString method decleared
    @Override
    public String toString(){
        return "Customer Name"+this.c_name   +"Account Number:"+this.acc_num; 
    }

    //beginning of withdrawal method
    public void  withdraw(double total){
        if(acc_balance<total){
            System.out.print("Not enough funds sorry your current balance is "+acc_balance);
        }
        else{
        this.acc_balance -= total;
        System.out.print("\n"+"Your Balance is"+ this.acc_balance);}

        Transaction t1 = new Transaction(new Date(), 'W', this.acc_balance, "Withdrawal Made");
        transactions.add(t1);

    }
    //end of withdrawal method

    //beginning of deposit method
   public void deposit(double total){
       this.acc_balance += total;
       System.out.printf("\n"+total+"Your Balance is"+ this.acc_balance);
        Transaction t1 = new Transaction(new Date(), 'D', this.acc_balance, "Deposit Made");
        transactions.add(t1);

   }
   //end of deposit method

}

This is the transaction class

package Object_1_Programs;

//Date decleared
import java.util.Date;

/**
 *
 * @
 */
public class Transaction {

    //instance variables decleared
    private Date date;
    private char type;
    private double amount;
    private double acc_balance;
    private String description;

    //Constructor
    public Transaction(Date date, char type, double acc_balance, String description) {
        this.acc_balance = acc_balance;
        this.date = new Date();
        this.type = type;

        this.description = description;
    }

//getters and setters method decleared
    public Date getDate() {
        return date;
    }

    public Date setDate() {
        return date;
    }

    public char getType() {
        return type;
    }

    public char setType() {
        return type;
    }

    public double getBalance() {
        return acc_balance;
    }

    public double setBalance() {
        return acc_balance;
    }

    public double getAmount() {
        return amount;
    }

    public double setAmount() {
        return amount;
    }

    public String getDescription() {
        return description;
    }

    public String setDescription() {
        return description;
    }
    //Tostring method 
    @Override
    public String toString() {  
        return "\n"+new Date()      + "Type : " + type     +      "Account Balance " + acc_balance + "Description " + description;
    }
}

This is the Saving Account Class

import java.util.Date;

/**
 *
 * @
 */
public class SavingsAccount extends Account {
// instance variables decleared
    private double int_rate;

    //default constrictor
    public SavingsAccount(){
      int_rate=0;  
    }
//main construtor
    public SavingsAccount(String c_name, String acc_num, double acc_balance, double int_rate) {
        super(c_name,acc_num, acc_balance);
        this.int_rate = int_rate;
    }
//getters and setters method decleared
    public double setRate(double rate) {
        return int_rate=rate/100;
    }

    public double getRate() {
        return int_rate;
    }

//payInterest method decleared
    public void payInterest() {
        double acc_amount=getBalance();
        double balance=0;
        balance = (acc_amount + (acc_amount *getRate()));
        setBalance(balance);

        System.out.printf("Account Balance With Interest is %.2f", setBalance(balance));
        Transaction t1 = new Transaction(new Date(),    'I'     ,        setBalance(balance), "Interest Paid");
        transactions.add(t1);

    }
//Withdrawal method override
    @Override
    public void withdraw(double total) {
        double acc_amount = getBalance();
        double balance = 0;

        if (acc_amount < total) {
            System.out.printf("Not enough funds your main account balance is :$%.2f", acc_amount);
        } else {

                    balance=acc_amount -= total;
                   setBalance(balance);
            System.out.printf("Your withdrawal of :$" + total + " was successful your new  account balance is :$%.2f",setBalance(balance));
        }
        Transaction t1 = new Transaction(new Date()     ,    'W'     ,       setBalance(balance), "Withdrawal Made");
        transactions.add(t1);

    }
//Deposit method override
    @Override
    public void deposit(double total) {
        double balance;
        double acc_amount = getBalance();
        balance= acc_amount+=total;
        setBalance(balance);
        System.out.printf("Your deposit of :$" + total + " was successful your new account balance is :$%.2f",setBalance(balance));
        Transaction t1 = new Transaction(new Date()     ,     'D'    , setBalance(balance),  "Deposit Made");
        transactions.add(t1);

    }

    @Override
    public String toString() {
        return this.toString() + "Interest Rate: " + int_rate;
    }

}

This is the Chequing Class

package Object_1_Programs;

import java.util.Date;

/**
 *
 * 
 */
public class ChequingAccount extends Account {
// instance variable decleared
    private double over_draft;
// default constructor
    public ChequingAccount() {
        this.over_draft = 500;
    }
    //end of default constructor

//Main Constructor begins
    public ChequingAccount(String c_name, String acc_num, double acc_balance) {
        super(c_name, acc_num, acc_balance);

    }
    //End of Main Method

// Getters and Setters method
    public double setOverDraft() {
        return over_draft = 500;

    }

//To string override
    @Override
    public String toString() {
        return this.toString() + "Over Draft Limit :" + over_draft;
    }

    //Withdrawal method override
    @Override
    public void withdraw(double amount) {
        double acc_amount = getBalance();
        double balance = 0;
        if (amount >balance &&  amount>  over_draft) {
            System.out.println("Sorry I cannot give you that amount choose a lower amount or tell d girl yuh cah remember yuh pin");
        } 
        else {
              balance= acc_amount-= amount;
              setBalance(balance);

        }
        System.out.printf(amount+ "Your new balance is %.2f", setBalance(balance));
        Transaction t1 = new Transaction(new Date()     , 'W',       setBalance(balance), "Withdrawal Made:");
        transactions.add(t1);

    }

    //Deposit Method override
    @Override
    public void deposit(double amount) {
        double acc_amount = getBalance();
        double balance=0;
        balance=acc_amount += amount;
        setBalance(balance);
        System.out.printf("Your deposit of :$" + amount + " was successful your new account balance is :$%.2f",setBalance(balance));
        Transaction t1 = new Transaction(new Date()     , 'D'    ,       setBalance(balance),      "Deposit Made:");
        transactions.add(t1);

    }

}

This is my test program

public class Account_Records_Test {

    public static void main(String[] args) {
        Scanner input = new Scanner(System.in);

        ArrayList Savings =new ArrayList();
        ArrayList Chequing=new ArrayList();

        String name;
        char type;
        char selection;
        double balance;
        double rate;
        String acc_num;       
        double total;

        SavingsAccount s1 = new SavingsAccount();
        ChequingAccount c1 = new ChequingAccount();

        System.out.println("\n" + "Please select one of the following options");
        System.out.println("|  o-To Open Account       |");
        System.out.println("|  d-To Make A Deposit     |");
        System.out.println("|  w-To Make A Withdraw    |");
        System.out.println("|  i-To Pay Interest       |");
        System.out.println("|  t-To View Transactions  |");
        System.out.println("|  q-To Quit               |");
        type = input.next().trim().toUpperCase().toLowerCase().charAt(0);

        while (type != 'q') {

            if (type == 'o') {
                System.out.print("Please select the type of account you will like to open s-Saving or c-Checking :");
                selection = input.next().trim().toUpperCase().toLowerCase().charAt(0);
                if (selection == 's') {
                    System.out.print("Please enter Account Holder Name");
                    name=input.next();

                    System.out.print("Please enter a Savings Account Number : ");
                    acc_num = input.next();
                    Savings.add(acc_num);

                    System.out.print("Please enter starting balance :$");
                    balance = input.nextDouble();
                    s1.setBalance(balance);

                    System.out.print("Please enter the courrent interest rate :");
                    rate = input.nextDouble();
                    s1.setRate(rate); 
                    Savings.add(acc_num);

                } else if (selection == 'c') {
                    System.out.print("Please enter a Chequing Account Number :");
                    acc_num = input.next();
                    Chequing.add(acc_num);
                    System.out.print("Please enter starting balance :$");
                    balance = input.nextDouble();
                    c1.setBalance(balance);
                }

            } else if (type == 'd') {
                System.out.print("Please enter the account number you wish to make a deposit to :");
                acc_num= input.next();

                if (Savings.contains(acc_num)) {
                    System.out.print("Please enter how much you will like to deposit to your Savings Account :$");
                    total = input.nextDouble();
                    s1.deposit(total);
                } else if (Chequing.contains(acc_num)) {
                    System.out.print("Please enter how much you will likt to deposit to your Chequing Account :$");
                    total = input.nextDouble();
                    c1.deposit(total);
                }

            } else if (type == 'w') {
                System.out.print("Please enter an account number  :");
                acc_num = input.next();
                if (Savings.contains(acc_num)) {
                    System.out.print("please enter the amount you wish to withdraw from your Saving Account");
                    total = input.nextDouble();
                    s1.withdraw(total);
                } else if (Chequing.contains(acc_num)) {
                    System.out.print("Please enter the amount you wish to withdraw from your Chequing Account");
                    total = input.nextDouble();
                    c1.withdraw(total);
                }
            } else if (type == 'i') {
                System.out.print("Please enter your account");
                acc_num = input.next();
                if (Savings.contains(acc_num)) {
                    s1.payInterest();
                } else {
                    System.out.print("Sorry This account isnt a Savings Account");
                }
            } else if (type == 't') {
                System.out.print("Please enter a account number");
                acc_num = input.next();
                if (Savings.contains(acc_num)) {
                    System.out.printf("\n" + "Transaction History for Account :%s", acc_num);
                    System.out.println(s1.transactions.toString());

                }
                else if(Chequing.contains(acc_num)) {
                    System.out.printf("\n" + "Transaction History for Account :%s", acc_num);
                    System.out.println(c1.transactions.toString());

                }

            }
            else if(type=='q'){
                break;
            }

            System.out.println("\n" + "Please select one of the following options");
            System.out.println("|  o-To Open Account       |");
            System.out.println("|  d-To Make A Deposit     |");
            System.out.println("|  w-To Make A Withdraw    |");
            System.out.println("|  i-To Pay Interest       |");
            System.out.println("|  t-To View Transactions  |");
            System.out.println("|  q-To Quit               |");
            type = input.next().trim().toUpperCase().toLowerCase().charAt(0);
        }

    }
}

Any help will do thanks 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-20T01:15:12.670

Your problem is that you only created one SavingsAccount object (s1). Everytime you "open an account" you are overwriting the one SavingsAccount that you made. I suggest making an ArrayList of SavingsAccounts like so: ArrayList accounts = new ArrayList();. Everytime you open an account, add the SavingsAccount object you create to "accounts."

It is also worth knowing that the "ArrayList name = new ArrayList();" syntax is deprecated. You should now put an identifier in the ArrayList declaration. The identifier, denoted as specifies the type of object that the ArrayList holds.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-20T01:28:33.350

还有许多其他问题。例如，在`deposit()`：

```
balance=acc_amount += amount; 
```

... 应该：

```
balance = acc_amount + amount; 
```

...并在：

```
System.out.printf("Your deposit of :$" + amount + " was successful your new account balance is :$%.2f",setBalance(balance)); 
```

...以及在`withdraw()`，`setBalance()`应该是`getBalance()`。后一个问题也出现在`withdraw()`.

虽然`setBalance()`可以在这些情况下使用，因为它被设计为返回余额以及设置余额，但在尝试打印余额时存在错误地将余额设置为其他内容的风险。

还有很多可以[重构](https://en.wikipedia.org/wiki/Code_refactoring)的重复代码，明智的做法是认真考虑一个比必要的更复杂的设计，因为它将报告余额与行动交易紧密结合在一起。

# c++ - 未定义的错误引用为我的函数 GTKMM C++ 显示了一个额外的参数

> ID：16115428
> 
> 赞同：2
> 
> 时间：2013-04-20T00:54:49.220
> 
> 标签：c++, compiler-errors, gtkmm, allocator

我正在编写一个蛇和梯子游戏，我定义了一个名为 draw_snake 的函数，如下所示：

```
void draw_snake(const Cairo::RefPtr<Cairo::Context>& cr, 
                std::pair<int,int> snake, 
                std::vector< std::pair<int,int> > boardcoords); 
```

当我调用这个函数时，我会这样做：

```
pair<int, int> snake = make_pair(100,1);
draw_snake(cr, snake, boardcoords); 
```

`boardcoords`是 的向量`pair<int,int>`。错误消息是说我在调用函数时有第四个参数。错误信息是这样的：

```
myarea.cc:(.text+0x7db): undefined reference to `MyArea::draw_snake(Cairo::RefPtr<Cairo::Context> const&, std::pair<int, int>, std::vector<std::pair<int, int>, std::allocator<std::pair<int, int> > >)' 
```

它从哪里得到这个分配器？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-20T01:02:19.727

你误读了错误。该函数具有三个参数。

```
undefined reference to `MyArea::draw_snake(
         Cairo::RefPtr<Cairo::Context> const&,
         std::pair<int, int>,
         std::vector<std::pair<int, int>, std::allocator<std::pair<int, int> > >
//                  ^ The vector's parameters are contained in these brackets  ^
         ) 
```

[`std::vector`有一个默认的“分配器”参数](http://en.cppreference.com/w/cpp/container/vector)。即使您没有指定它，它也存在。

所以你得到的错误是你声明的确切函数没有定义。

# mysql - MySQL 中 MATCH ('...' IN NATURAL LANGUAGE MODE) 的最大可能值范围是多少？

> ID：16115429
> 
> 赞同：13
> 
> 时间：2013-04-20T00:54:57.257
> 
> 标签：mysql, full-text-search, relevance, match-against

MySQL 提供`FULLTEXT`索引，可以使用[`MATCH (col1,col2,...) AGAINST (expr [search_modifier])`](http://dev.mysql.com/doc/refman/5.1/en/fulltext-search.html#function_match)构造检索。有多种[全文搜索](http://dev.mysql.com/doc/refman/5.1/en//fulltext-search.html)变体，其中之一（也是默认的）是[Natural Language Full-Text Search](http://dev.mysql.com/doc/refman/5.1/en//fulltext-natural-language.html)。

那么 MATCH 的最大可能值是多少（自然语言模式中的'...'）？

* * *

例子：

这个查询

```
SELECT
    courses.id,
    courses.title,
    MATCH (coursedata.title) AGAINST ('Basketball') AS relevance
FROM
    courses
JOIN
    coursedata ON coursedata.id = courses.coursedata_id
WHERE
    MATCH (coursedata.title) AGAINST ('Basketball') > 0 
```

返回一个带有列的结果表`relevance`，我们在其中存储`coursedata.title`行的相关值`'Basketball'`。还是行的相关性`'Basketball'`值`coursedata.title`？无论如何，我们将`MATCH(...)`函数的输出存储在那里。就我而言，我从`0`to 获取值`3.695953130722046`。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2017-02-21T12:15:47.180

查询输出的可能性实际上并没有很小的限制。因此，您将冻结您的 MySQL / 您的网络，而不是达到那个巨大的限制。

# android - 拉伸适合表格行宽的图像视图

> ID：16115432
> 
> 赞同：3
> 
> 时间：2013-04-20T00:55:40.193
> 
> 标签：android, android-layout

我有这个布局 XML，如果可能的话，我希望第二行中的 ImageView 拉伸以适应行视图，并且第一行中的 textview 卡在屏幕的左侧，我需要它在中心。ImageView 正在填充从相机拍摄的图像，任何帮助表示赞赏。

```
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
xmlns:tools="http://schemas.android.com/tools"
android:layout_width="match_parent"
android:layout_height="match_parent"
android:orientation="vertical"
android:paddingBottom="@dimen/activity_vertical_margin"
android:paddingLeft="@dimen/activity_horizontal_margin"
android:paddingRight="@dimen/activity_horizontal_margin"
android:paddingTop="@dimen/activity_vertical_margin"
>

<TableLayout
    android:layout_width="match_parent"
    android:layout_height="0dp"
    android:layout_gravity="center"
    android:layout_weight="1"
    android:stretchColumns="*" >

    <TableRow android:id="@+id/tableRow1" >

        <LinearLayout
            android:layout_width="0dp"
            android:layout_height="wrap_content"
            android:layout_weight="1" >

            <TextView
                android:id="@+id/textView1"
                android:layout_width="match_parent"
                android:layout_height="wrap_content"
                android:layout_weight="1"
                android:layout_gravity="center"
                android:text="Set Your Personal Information Here"
                android:textAppearance="?android:attr/textAppearanceMedium" />
        </LinearLayout>
    </TableRow>

    <TableRow android:id="@+id/tableRow2" >

        <LinearLayout
            android:layout_width="0dp"
            android:layout_height="wrap_content"
            android:layout_weight="1" >

            <ImageView
                android:id="@+id/imageView1"
                android:layout_width="match_parent"
                android:layout_height="match_parent" />
        </LinearLayout>
    </TableRow>

    <TableRow android:id="@+id/tableRow3" >

        <LinearLayout
            android:layout_width="0dp"
            android:layout_height="wrap_content"
            android:layout_weight="1"
            android:orientation="horizontal" >

            <QuickContactBadge
                android:id="@+id/quickContactBadge1"
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                android:layout_gravity="left" />

            <LinearLayout
                android:layout_width="wrap_content"
                android:layout_height="match_parent"
                android:orientation="vertical" >

                <TextView
                    android:id="@+id/textView2"
                    android:layout_width="wrap_content"
                    android:layout_height="wrap_content"
                    android:text="Name"
                    android:textAppearance="?android:attr/textAppearanceMedium" />

                <TextView
                    android:id="@+id/textView3"
                    android:layout_width="wrap_content"
                    android:layout_height="wrap_content"
                    android:text="Gender"
                    android:textAppearance="?android:attr/textAppearanceMedium" />

                <TextView
                    android:id="@+id/textView4"
                    android:layout_width="wrap_content"
                    android:layout_height="wrap_content"
                    android:text="Credits"
                    android:textAppearance="?android:attr/textAppearanceMedium" />
            </LinearLayout>
        </LinearLayout>
    </TableRow>
</TableLayout> 
```

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2013-04-20T03:44:17.837

正如@Brosa 在评论中所说，使用`android:scaleType="fitXY"`属性。

尽管您已经找到了解决方案，但我写这个答案是为了写一个关于不同选项的简短描述，`android:scaleType`以供将来帮助。

这个属性有几个选项。他们是

1.  矩阵
2.  适合XY
3.  适合开始
4.  健身中心
5.  适合结束
6.  中央
7.  中心作物
8.  中心内

这是[文档中的一些小描述](http://developer.android.com/reference/android/widget/ImageView.ScaleType.html)

**1.矩阵**
绘制时使用图像矩阵进行缩放。

**2\. fitXY 分别**
在X和Y方向缩放图像，使src与dst完全匹配。这可能会改变 src 的纵横比。

**3\. fitStart**
通过计算一个比例来缩放图像，该比例将保持原始 src 纵横比，但也将确保 src 完全适合 dst。至少一个轴（X 或 Y）将完全适合。START 将结果与 dst 的左边缘和上边缘对齐。

**4\. fitCenter**
通过计算一个比例来缩放图像，该比例将保持原始 src 纵横比，但也将确保 src 完全适合 dst。至少一个轴（X 或 Y）将完全适合。结果以 dst 为中心。

**5\. fitEnd**
通过计算一个比例来缩放图像，该比例将保持原始 src 纵横比，但也将确保 src 完全适合 dst。至少一个轴（X 或 Y）将完全适合。END 将结果与 dst 的右边缘和下边缘对齐。

**6\. center**
在视图中居中图像，但不执行缩放。

**7\. centerCrop 统一**
缩放图像（保持图像的纵横比），使图像的两个尺寸（宽度和高度）都等于或大于视图的相应尺寸（减去填充）。

**8\. centerInside 统一**
缩放图像（保持图像的纵横比），使图像的两个尺寸（宽度和高度）都等于或小于视图的相应尺寸（减去填充）。

# windows - WDF 中的 MSI-X 中断

> ID：16115434
> 
> 赞同：1
> 
> 时间：2013-04-20T00:55:54.397
> 
> 标签：windows, driver, interrupt, kmdf, wdf

我在我们用 WDF / KMDF 编写的 Windows 总线驱动程序中实现 MSI-X 中断时遇到了很多麻烦。我已经阅读了[MSDN 文档](http://msdn.microsoft.com/en-us/library/windows/hardware/ff565424(v=vs.85).aspx)，那里并没有很多有用的信息。我的理解是它应该真的只是“工作”。

我已经更改了我们驱动程序的 INF 文件以添加适当的注册表项，并确认它们在安装时已正确设置。我正在正确查询 PCI 配置空间并确定是否支持 MSI-X 中断。

问题是，一旦我有了这些信息，我就不知道如何更改我的代码来专门将中断设置为 MSI-X。我执行标准调用来配置 WDF_INTERRUPT_CONFIG_INIT 结构并调用 WdfInterruptCreate，但是创建的中断不是消息信号的，我不知道需要做什么才能真正实现这一点。

是否有 WDF 版本的步骤，或者我应该只是在[此处](http://msdn.microsoft.com/en-ca/library/windows/hardware/ff547345(v=vs.85).aspx)[执行](http://msdn.microsoft.com/en-us/library/windows/hardware/ff548079(v=vs.85).aspx)标准的 WDFINTERRUPT 创建步骤？

有没有人有这样做的经验？任何人都可以提供一个源示例吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-06-24T21:09:52.590

上周我一直在为类似的事情苦苦挣扎。我的应用程序略有不同，因为我试图让普通的 MSI 中断而不是 MSI-X 中断工作。但我以几乎相同的方式使用 WDF 框架。

我知道您在 2013 年 4 月左右发布了原始问题，但没有更新。你解决了你原来的问题吗？如果是这样，我想看看你自己的解决方案。

在我的 WDF 驱动程序中，我正在映射传入的硬件资源列表并使用 WdfCmResourceListGetDescriptor() 函数对其进行解析，以检查 WDFCMRESLIST 列表中的每个 PCM_PARTIAL_RESOURCE_DESCRIPTOR 项。我能够获得单个 CmResourceTypeInterrupt 描述符，但它始终用于旧式中断而不是 MSI 中断。我的设备确实支持 MSI。即使按照您的描述在我的 .inf 文件中设置了额外的注册表项，我也不明白为什么 MSI 描述符不在资源列表中。

原来我的 .inf 文件中有错字。我忘记在我的设备安装部分添加“.HW”后缀。添加此后缀允许总线管理器修改设备中的 pcie 配置地址并创建相应的 MSI 中断资源描述符，该描述符必须由驱动程序挂钩。

```
[Standard.NT$ARCH$]
%tdvr.DeviceDesc%=tdvr_Device, PCI\VEN_104C&DEV_B800 

[tdvr_Device.NT]
CopyFiles=Drivers_Dir

[tdvr_Device.NT.HW]
AddReg=MSI_Interrupts

[Drivers_Dir]
tdvr.sys

;http://msdn.microsoft.com/en-us/library/windows/hardware/ff544246(v=vs.85).aspx
;To receive message-signaled interrupts (MSIs), a driver's INF file must enable MSIs in the 
;registry during installation. Use the Interrupt Management\MessageSignaledInterruptProperties 
;subkey of the device's hardware key to enable MSI support.

[MSI_Interrupts]
HKR,Interrupt Management,,0x00000010
HKR,Interrupt Management\MessageSignaledInterruptProperties,,0x00000010
HKR,Interrupt Management\MessageSignaledInterruptProperties,MSISupported,0x00010001,1 
```

当在资源列表中找到 MSI 中断资源描述符时（例如在 evtMapHWResources 回调中），该描述符将用作 WdfInterruptCreate() 函数的输入。此处的“tdvr”前缀用于我自己的驱动程序命名约定。

```
NTSTATUS
tdvrConfigureInterrupts(
    _Inout_ PDEVICE_CONTEXT deviceContext,
    _In_ PCM_PARTIAL_RESOURCE_DESCRIPTOR interruptDescRaw,
    _In_ PCM_PARTIAL_RESOURCE_DESCRIPTOR interruptDescTranslated
    )
{
    NTSTATUS status;
    PAGED_CODE();
    FuncEntry();

    // What kind of interrupt has been provided?
    if (CM_RESOURCE_INTERRUPT_MESSAGE & interruptDescTranslated->Flags)
    {
        TraceInterrupt(TRACE_LEVEL_INFORMATION, 
            "Message Interrupt level 0x%0x, Vector 0x%0x, MessageCount %u\n"
            ,interruptDescTranslated->u.MessageInterrupt.Translated.Level
            ,interruptDescTranslated->u.MessageInterrupt.Translated.Vector
            ,interruptDescTranslated->u.MessageInterrupt.Raw.MessageCount
            );
    }
    else
    {
        TraceInterrupt(TRACE_LEVEL_INFORMATION,
            "Legacy Interrupt level: 0x%0x, Vector: 0x%0x\n"
            ,interruptDescTranslated->u.Interrupt.Level
            ,interruptDescTranslated->u.Interrupt.Vector
            );
    }

    //
    // Create WDFINTERRUPT object.
    //
    WDF_INTERRUPT_CONFIG interruptConfig;
    WDF_INTERRUPT_CONFIG_INIT(
        &interruptConfig,
        tdvrEvtInterruptIsr,
        tdvrEvtInterruptDpc
        );

    // Each interrupt has some context data
    WDF_OBJECT_ATTRIBUTES interruptAttributes;
    WDF_OBJECT_ATTRIBUTES_INIT_CONTEXT_TYPE(
        &interruptAttributes,
        INTERRUPT_CONTEXT
        );

    //
    // These first two callbacks will be called at DIRQL.  Their job is to
    // enable and disable interrupts.
    //
    interruptConfig.EvtInterruptEnable  = tdvrEvtInterruptEnable;
    interruptConfig.EvtInterruptDisable = tdvrEvtInterruptDisable;

    // If the driver calls WdfInterruptCreate from EvtDriverDeviceAdd, the InterruptRaw and
    // InterruptTranslated members of the WDF_INTERRUPT_CONFIG structure must be NULL. 
    // the driver calls WdfInterruptCreate from EvtDevicePrepareHardware, these members must both be valid.
    interruptConfig.InterruptTranslated = interruptDescTranslated;
    interruptConfig.InterruptRaw = interruptDescRaw;

    // Our driver must call WdfInterruptCreate once for each interrupt vector that its device requires. 
    // If the device supports message-signaled interrupts (MSI), the driver must create an interrupt object 
    // for each message that the device can support.
    status = WdfInterruptCreate(
        deviceContext->WdfDevice,
        &interruptConfig,
        &interruptAttributes,
        &deviceContext->WdfInterrupt
        );

    if (!NT_SUCCESS(status))
    {
        TraceInterrupt(TRACE_LEVEL_ERROR, "WdfInterruptCreate FAILED: %!STATUS!\n", status);
    }
    else
    {
        PINTERRUPT_CONTEXT interruptContext = InterruptGetContext(deviceContext->WdfInterrupt);
        // do whatever with context info
    }

    FuncExit();
    return status;
} 
```

就像我说的希望现在你已经弄清楚了，但我想我还是会发布一些东西来贡献。

# vaadin - 在 Vaadin 7.0 中，如何刷新支持 Table 的 JavaBean 数据？更换容器？换豆子？

> ID：16115437
> 
> 赞同：5
> 
> 时间：2013-04-20T00:56:11.127
> 
> 标签：vaadin

在[Vaadin](http://en.wikipedia.org/wiki/Vaadin) 7.0 中，当使用[BeanContainer在](https://vaadin.com/api/com/vaadin/data/util/BeanContainer.html)[Table中显示](https://vaadin.com/api/com/vaadin/ui/Table.html)[JavaBean](http://en.wikipedia.org/wiki/JavaBeans)数据时，用新数据刷新 Table 的正确方法是什么？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-04-22T07:21:27.357

该表通过侦听器监视表项的属性。如果您通过表的 Item 实例更改项目的属性，则表将被通知和更新：例如

`container.getItem(beanInstance).getItemProperty("propertyName").setValue("newValue");`

但是，如果 bean在项目实例*之外*发生了更改，您需要告诉表刷新。最简单的方法（使用股票 BeanContainer）是简单地删除然后添加项目。

或者 - 我建议，最好 - 您可以创建 BeanItemContainer 的扩展来触发 ItemSetChange 事件，这将导致表刷新。

```
public class RefreshableBeanItemContainer<BEANTYPE> extends BeanItemContainer<BEANTYPE> {
  public RefreshableBeanItemContainer(Collection<? extends BEANTYPE> collection) throws IllegalArgumentException {
    super(collection);
  }

  public RefreshableBeanItemContainer(Class<? super BEANTYPE> type) throws IllegalArgumentException {
    super(type);
  }

  public RefreshableBeanItemContainer(Class<? super BEANTYPE> type, Collection<? extends BEANTYPE> collection) throws IllegalArgumentException {
    super(type, collection);
  }

  public void refreshItems(){
    fireItemSetChange();
  }
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-20T00:56:11.127

似乎刷新 JavaBean 数据的一种方法是将表的容器替换为另一个容器。我注意到的一个副作用是某些表格的设置可能会被重置，例如折叠的列不再被折叠。

另一种方法似乎是在替换包含的 Bean 时保留容器。

我不确定这两种方法是否都被认为是正确的。而且我不确定这两种方法的权衡可能是什么。

这是一个带有一对表格和一个按钮的示例应用程序。当用户单击按钮时，两个表都会获得新数据。一个 Table 获得一个新的 BeanContainer。另一个表保留它的 BeanContainer，但会加载新的 bean。

![Vaadin 7.0.4 应用程序的屏幕截图，其中包含一对表格和一个按钮。](https://i.stack.imgur.com/HgcHL.png)

这个应用程序中只有两个类：

*   主应用程序类。
*   用于存储数据的 JavaBean 类。

```
package com.example.replacebeansorcontainer;

import java.util.ArrayList;
import java.util.List;
import java.util.UUID;

import com.vaadin.data.util.BeanContainer;
import com.vaadin.server.VaadinRequest;
import com.vaadin.ui.Button;
import com.vaadin.ui.Button.ClickEvent;
import com.vaadin.ui.HorizontalLayout;
import com.vaadin.ui.Table;
import com.vaadin.ui.UI;

/**
 * Main UI class.
 * 
 * ReplaceBeansOrContainerUI.java
 * 
 * @author Basil Bourque
 * 
 *         Copyright © 2013 Basil Bourque. This source code may be used freely forever by anyone taking full responsibility for doing so.
 * 
 */
@SuppressWarnings( "serial" )
public class ReplaceBeansOrContainerUI extends UI {
    Table tableThatGetsFreshContainer;
    Table tableThatGetsFreshBeans;

    @Override
    protected void init( VaadinRequest request ) {
        // Create widgets: table on the left, button, table on the right.

        this.tableThatGetsFreshContainer = new Table( "Table That Gets Fresh Container", this.makeBeanContainer() );
        this.tweakTable( this.tableThatGetsFreshContainer );

        this.tableThatGetsFreshBeans = new Table( "Table That Gets Fresh Beans", this.makeBeanContainer() );
        this.tweakTable( this.tableThatGetsFreshBeans );

        Button reloadButton = new Button( "Reload Data" );
        reloadButton.addClickListener( new Button.ClickListener() {
            @Override
            public void buttonClick( ClickEvent event ) {
                // Reload data in both tables when user clicks this button.
                System.out.println( "User clicked 'Reload Data' button. Replacing container (left) & beans (right)." + new java.util.Date() );
                // One table gets a new Container.
                ReplaceBeansOrContainerUI.this.tableThatGetsFreshContainer.setContainerDataSource( ReplaceBeansOrContainerUI.this.makeBeanContainer() );
                // The other table keeps its Container, but the Container's beans are replaced.
                ReplaceBeansOrContainerUI.this.tableThatGetsFreshBeans.getContainerDataSource().removeAllItems();
                // Cast the Container to BeanContainer to utilize the 'addAll' method.
                @SuppressWarnings( "unchecked" )
                BeanContainer<UUID, MomentBean> beanContainer = (BeanContainer<UUID, MomentBean>)ReplaceBeansOrContainerUI.this.tableThatGetsFreshBeans.getContainerDataSource();
                beanContainer.addAll( ReplaceBeansOrContainerUI.this.makeListOfBeans() );
            }
        } );

        // Compose Layout.
        final HorizontalLayout layout = new HorizontalLayout();
        layout.setMargin( true );
        layout.setSpacing( true );
        layout.addComponent( this.tableThatGetsFreshContainer ); // Table on the left.
        layout.addComponent( reloadButton );
        layout.addComponent( this.tableThatGetsFreshBeans ); // Table on the right.

        // Compose UI.
        this.setContent( layout );
    }

    private void tweakTable( Table table ) {
        table.setSelectable( true );
    }

    private List<MomentBean> makeListOfBeans() {
        List<MomentBean> beans = new ArrayList<MomentBean>();
        for ( int i = 0; i < 20; i++ ) {
            beans.add( new MomentBean() );
        }
        return beans;
    }

    private BeanContainer<UUID, MomentBean> makeBeanContainer() {
        // Instantiate empty container, with columns defined by my class’ JavaBean fields.
        BeanContainer<UUID, MomentBean> container = new BeanContainer<UUID, MomentBean>( MomentBean.class );
        try {
            // Indicate which field in Bean serves as the unique identifier.
            container.setBeanIdProperty( MomentBean.class.getDeclaredField( "uuid" ).getName() );
            container.addAll( this.makeListOfBeans() ); // Add entire Collection of beans to container.
        } catch ( NoSuchFieldException e ) {
            // TODO Auto-generated catch block
            e.printStackTrace();
        } catch ( SecurityException e ) {
            // TODO Auto-generated catch block
            e.printStackTrace();
        }
        return container;
    }
} 
```

JavaBean 类...</p>

```
/**
 * 
 */
package com.example.replacebeansorcontainer;

import java.text.SimpleDateFormat;
import java.util.UUID;

/**
 * MomentBean.java
 * 
 * @author Basil Bourque
 * 
 *         Copyright © 2013 Basil Bourque. This source code may be used freely forever by anyone taking full responsibility for doing so.
 * 
 */
public class MomentBean {
    // Bean fields.
    private final String clockTime;
    private final long nanoTime;
    private final UUID uuid;

    // Other member fields.
    private final SimpleDateFormat timeOnlyFormat = new SimpleDateFormat( "HH:mm:ss" );

    /**
     * 
     */
    public MomentBean() {
        this.clockTime = this.timeOnlyFormat.format( new java.util.Date() );
        this.nanoTime = System.nanoTime();
        this.uuid = UUID.randomUUID();
    }

    /**
     * @return the clockTime
     */
    public String getClockTime() {
        return this.clockTime;
    }

    /**
     * @return the nanoTime
     */
    public long getNanoTime() {
        return this.nanoTime;
    }

    /**
     * @return the uuid
     */
    public UUID getUuid() {
        return this.uuid;
    }

} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2014-08-28T13:22:03.800

似乎解决方案就像打电话一样简单`refreshRowCache()`——至少对我来说是这样！

# css - 将自定义 CSS 添加到使用 Compass 生成的精灵中

> ID：16115439
> 
> 赞同：4
> 
> 时间：2013-04-20T00:56:30.860
> 
> 标签：css, sass, compass-sass, css-sprites

我在`my_images.scss`文件中有这段代码：

```
$icon-layout:smart;
$icon-sprite-dimensions: true;
@import "icon/*.png";
@include all-icon-sprites; 
```

输出是这样的：

```
.icon-sprite, .icon-asterisk, .icon-camera, .icon-clock, ... {
  background: url('/../../media/img/icon-s00227a988a.png') no-repeat;
}

.icon-asterisk {
  background-position: -108px -18px;
  height: 18px;
  width: 18px;
}

.icon-camera {
  background-position: -54px -18px;
  height: 18px;
  width: 18px;
} 
```

如何更改代码以在输出中包含自定义 CSS。我想生成这个：

```
.icon-sprite, .icon-asterisk, .icon-camera, .icon-clock, ... 
{
    background: url('/../../media/img/icon-s00227a988a.png') no-repeat;

    /* My custom CSS here */
    display: inline-block;
} 
```

**重要的**

我对此有一个不太好的解决方案：由于这些是使用构建的，因此`@extend`您只需添加一个名为`.icon-sprite`并包含自定义样式的选择器。像这样：

```
.icon-sprite {
  display: inline-block;
}

$icon-layout:smart;
$icon-sprite-dimensions: true;
@import "icon/*.png";
@include all-icon-sprites; 
```

编译为：

```
.icon-sprite, .icon-asterisk, .icon-camera, .icon-clock, ... {
  display: inline-block;
}

.icon-sprite, .icon-asterisk, .icon-camera, .icon-clock, ... {
  background: url('/../../media/img/icon-s00227a988a.png') no-repeat;
}
... 
```

但是复制 CSS 代码是完全多余的。我想生成：

```
.icon-sprite, .icon-asterisk, .icon-camera, .icon-clock, ... {
  background: url('/../../media/img/icon-s00227a988a.png') no-repeat;
  display: inline-block;
} 
```

是否可以使用指南针？提前致谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-21T09:23:00.130

您的解决方案已经足够好了，我也会这样做。您的 CSS 将被压缩，因此大小差异将像 10 个字节。

重要的是 SASS 的可读性，而不是 CSS 的大小。

但是，如果您真的希望您的 CSS 出于完美主义而紧凑，那么 Compass 是可能的！你需要一些猴子补丁。

1）在您的项目文件夹中，创建一个`lib/`子文件夹（如果您还没有）。

2）将erb模板文件下载到该文件夹​​：[https ://github.com/chriseppstein/compass/blob/stable/lib/compass/sprite_importer/content.erb#L45](https://github.com/chriseppstein/compass/blob/stable/lib/compass/sprite_importer/content.erb#L45)

3) 在`display: inline-block;`该文件的第 45 行之后添加该行（如果您点击链接，则会突出显示）。

4) 现在您必须让 Compass 使用该模板。`sprite_importer.rb`在它旁边 创建一个并添加以下代码：

```
require 'erb'
require 'compass/sprite_importer/binding'
module Compass
  class SpriteImporter < Sass::Importers::Base

    # Generates the Sass for this sprite file
    def self.content_for_images(uri, name, skip_overrides = false)
      template_folder = File.expand_path('../', __FILE__)
      content_template_file = File.join(template_folder, 'content.erb')
      content_template = ERB.new(File.read(content_template_file))
      binder = Compass::Sprites::Binding.new(:name => name, :uri => uri, :skip_overrides => skip_overrides, :sprite_names => sprite_names(uri), :files => files(uri))
      content_template.result(binder.get_binding)
    end
  end
end 
```

这是[sprite_importer.rb](https://github.com/chriseppstein/compass/blob/stable/lib/compass/sprite_importer.rb)的副本，修改为使用自定义模板并减少到只有必要的部分。它也被修改为不引发关于重复常量的 Ruby 警告。

5) 现在从以下位置导入该文件`config.rb`：

```
require './lib/sprite_importer' 
```

6) 运行`compass clean`并重新编译您的项目。

您将`display: inline: block;`像您想要的那样添加到所有精灵中：

```
.sexy-sprite, .sexy-accept, .sexy-add, .sexy-anchor, .sexy-application, .sexy-application_add, .sexy-application_cascade, .sexy-application_delete, .sexy-application_double, .sexy-application_edit, .sexy-application_error, .sexy-application_form, .sexy-application_form_add, .sexy-application_form_delete, .sexy-application_form_edit, .sexy-application_form_magnify, .sexy-application_get, .sexy-application_go, .sexy-application_home, .sexy-application_keyasdf, .sexy-application_lightning, .sexy-application_link, .sexy-application_osx, .sexy-application_osx_terminal, .sexy-application_put, .sexy-application_side_boxes, .sexy-application_side_contract, .sexy-application_side_expand, .sexy-application_side_list, .sexy-application_side_tree, .sexy-application_split, .sexy-application_tile_horizontal, .sexy-application_tile_vertical, .sexy-application_view_columns, .sexy-application_view_detail, .sexy-application_view_gallery, .sexy-application_view_icons, .sexy-application_view_list, .sexy-application_view_tile, .sexy-application_xp, .sexy-application_xp_terminal, .sexy-arrow_branch, .sexy-arrow_divide, .sexy-arrow_down, .sexy-arrow_in, .sexy-arrow_inout, .sexy-arrow_join, .sexy-arrow_left, .sexy-arrow_merge, .sexy-arrow_out, .sexy-arrow_redo, .sexy-arrow_refresh, .sexy-arrow_refresh_small, .sexy-arrow_right, .sexy-arrow_rotate_anticlockwise, .sexy-arrow_rotate_clockwise, .sexy-arrow_switch, .sexy-arrow_turn_left, .sexy-arrow_turn_right, .sexy-arrow_undo, .sexy-arrow_up, .sexy-asterisk_orange, .sexy-asterisk_yellow, .sexy-attach {
  background: url('/images/sexy-sce786a2ec5.png') no-repeat;
  display: inline-block;
} 
```

您还可以向 erb 模板添加一些逻辑，以便`inline-block;`仅在必要时添加。

# performance - 有没有更好的方法从 numpy 数组中获取具有 x,y 坐标的元素？

> ID：16115440
> 
> 赞同：2
> 
> 时间：2013-04-20T00:56:33.933
> 
> 标签：performance, numpy, indexing

可以使用一个序列元组来索引一个 numpy 数组，例如一个*x*坐标序列和`tpl[0]`一个y*坐标*序列。只需要用元组索引数组，因此： .*`tple[1]`*`other_array[tpl]`**

 **我目前将坐标存储在二维数组中，以便向量`ar[0]`对应于我的*x*值并`ar[1]`对应于我的*y*值。

现在，我正在`other_array`通过创建一个元组进行索引： `other_array((ar[0], ar[1]))`。不幸的是，这个操作是在一个紧密的循环中运行的，所以我可以挤出的任何性能都是非常有益的。如果执行 10^8 次，创建元组会增加一些开销！有没有一种更快的、numpythonic 的索引方式来使用这样的*xy*坐标矩阵？

非常感谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-20T02:02:22.630

您可以使用另一个数组索引 numpy 数组，因此您不必创建元组。例如：

```
In [199]: other_array
Out[199]: 
array([[ 0,  1,  2,  3,  4],
       [ 5,  6,  7,  8,  9],
       [10, 11, 12, 13, 14]])

In [200]: ar
Out[200]: 
array([[0, 2, 1],
       [1, 3, 0]])

In [201]: other_array[ar[0], ar[1]]
Out[201]: array([ 1, 13,  5]) 
```

如果这不能回答您的问题，您能否在问题中包含一个简单的工作示例来显示您当前正在做什么？**

# prolog - 检查头部中的所有内容是否小于尾部

> ID：16115443
> 
> 赞同：0
> 
> 时间：2013-04-20T00:57:01.293
> 
> 标签：prolog

给定一个包含子列表 [[1].[2],[3]] 的列表，我将如何检查列表中第一个子列表的 HEAD 是否小于其他子列表的其余 HEADS？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-20T03:36:38.090

[*ISO-Prolog中术语标准顺序的*](http://www.swi-prolog.org/pldoc/doc_for?object=section%283,%274.7.1%27,swi%28%27/doc/Manual/compare.html%27%29%29)[比较](http://www.swi-prolog.org/pldoc/doc_for?object=section%283,%274.7.1%27,swi%28%27/doc/Manual/compare.html%27%29%29)可以递归地应用于任意复杂结构。

然后你的问题可以用类似的东西来解决

```
first_head_is_less([H|R]) :- maplist(@<(H), R). 
```

测试：

```
?- first_head_is_less([[1],[2],[3]]).
true.

?- first_head_is_less([[10],[2],[3]]).
false. 
```

*编辑*上面的代码必须细化，因为它（例如）失败了：

```
?- first_head_is_less([[1,2],[1,3],[3]]).
true. 
```

这是不正确的。这里有一个更严格的测试：

```
first_head_is_less([H|R]) :-
    maplist(head_is_less(H), R).
head_is_less([F|_], [E|_]) :- F @< E. 
```

# c++ - 为什么消息循环不会阻止 Windows 应用程序中的 GUI，但在 Qt 中会阻止？

> ID：16115444
> 
> 赞同：4
> 
> 时间：2013-04-20T00:57:16.437
> 
> 标签：c++, multithreading, qt, winapi, loops

我正在使用 Qt 开发一个程序，我的一些代码基于 Windows 示例。我遇到的问题，我不太明白的是，相同的代码将如何阻止我的 Qt GUI，而它在 Windows 应用程序中完全可以正常工作。

这是一个例子。我有一个程序，它从相机获取一些数据，对其进行一些处理，然后将其显示在屏幕上。在 Windows 示例中有这样的东西：

```
// Create an event with these self-explanatory parameters
// This event signals when the next frame is ready to process
HANDLE frameEvent  = CreateEvent(nullptr, TRUE, FALSE, nullptr)

// Now run a while loop which magically doesn't block
HANDLE hEvents[1];

while (WM_QUIT != msg.message)
{
  hEvents[0] = frameEvent;

  DWORD dwEvent = MsgWaitForMultipleObjects(1, hEvents, FALSE, INFINITE, QS_ALLINPUT);

  // If we have our event run some processing
  if (WAIT_OBJECT_0 == dwEvent)
  {
    update();
  }
  // Else handle input or whatever
} 
```

更新函数看起来像这样：

```
if (WAIT_OBJECT_0 = WaitForSingleObject(frameEvent, 0)
{
  getTheFrame();
  processTheFrame();
  drawTheFrame();
} 
```

如果我尝试在 Qt 中以相同的方式实现它，一切都会冻结，while 循环将永远运行。我得到的解决方案是在单独的线程（QThread）中运行循环并在新帧准备好时发出信号，如下所示：

```
void Worker::run()
{
    running_ = true;

    while (running_)
    {
        if (WaitForSingleObject(frameEvent, 0) == WAIT_OBJECT_0)
        {
            emit signalFrame();
        }

        // This is necessary or it will still freeze!
        usleep(15);
    }
} 
```

然后将信号连接到一个插槽，该插槽与`Update()`windows 示例中的方法执行类似的工作。

现在，这可以正常工作，但只要在下一帧可用之前可以处理单个帧即可。

随着我的处理变得更复杂并且比相机帧速率更慢，程序停止响应。Windows 示例中完全相同的代码仍然可以正常工作，帧率只是下降，但所有内容都已绘制并且 GUI 保持响应。

有人可以解释发生了什么，可能的解决方案是什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-20T06:35:10.380

Win32 版本调用[`MsgWaitForMultipleObjects`](http://msdn.microsoft.com/en-us/library/windows/desktop/ms684242.aspx). 正如它的名字所暗示的那样，它等待指定的对象发出信号*或*等待窗口消息（并且因为它是用 调用的`QS_ALLINPUT`，*所以任何*窗口消息）。大概代码之后还会发送窗口消息。

您的版本调用[`WaitForSingleObject`](http://msdn.microsoft.com/en-us/library/windows/desktop/ms687032.aspx). 顾名思义，它只等待*指定*的对象。它不会在窗口消息上解锁自己。

# opengl - 在 3D 表面上放置多个图像

> ID：16115445
> 
> 赞同：3
> 
> 时间：2013-04-20T00:57:30.053
> 
> 标签：opengl, graphics, opengl-es, 3d, opengl-es-2.0

如果我要在 3D 对象（例如立方体）的表面上放置纹理，我可以使用该立方体的顶点来描述此纹理的放置。

但是，如果我想在同一个平面上放置多个单独的图像怎么办？或者假设它只是一个图像，但我不希望它出现在顶点所在的曲面边缘，而是出现在曲面中间的某个小地方。我希望在运行时动态选择和放置实际图像，否则我可以将它们离线压缩为单个纹理。

**我有一种方法，但我想就是否有更好的方法寻求建议，或者这是否完全可以接受**：

我的猜测是创建多个单独的 2D 四边形（深度为 0），每个四边形都有与之关联的纹理并放置在它们上面（它们当然可以是具有不同纹理坐标的纹理图集）。

然后，我变换这些四边形，使它们看起来位于 3D 对象（例如立方体）的表面上。当然，我必须维护一个矩阵层次结构，以便在变换立方体时适当地变换这些四边形，以便它们看起来附加到立方体上。

虽然这不一定很难，但我是纹理的新手，想知道这是否是这样的正常做法。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-20T01:23:25.210

您可以尝试渲染场景并将其保存为纹理，然后在表面上使用该纹理。

查看[glCopyTexImage2D()](http://www.khronos.org/opengles/sdk/1.1/docs/man/glCopyTexImage2D.xml)或[glCopyTexSubImage2D()](http://www.khronos.org/opengles/sdk/1.1/docs/man/glCopyTexSubImage2D.xml)。

或者也许尝试使用帧缓冲区对象。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-20T10:42:40.343

> 但是，如果我想在同一个平面上放置多个单独的图像怎么办？

使用多个纹理，也许每个纹理都有自己的一组纹理坐标。您的 OpenGL 实现将为您提供许多纹理单元。它们中的每一个都可以提供不同的纹理。

```
glActiveTexture(GL_TEXTURE_0 + i);
glBindTexture(…);
glUniform1i(texturesampler[i], i); // texturesampler[i] contains the sampler uniform location of the bound program. 
```

> 或者假设它只是一个图像，但我不希望它出现在顶点所在的曲面边缘，而是出现在曲面中间的某个小地方。

这就是 GL_CLAMP... 纹理环绕模式得到使用的地方。

```
glTexParameteri(GL_TEXTURE_WRAP_{S,T,R}, GL_CLAMP[_TO_{EDGE,BORDER}]); 
```

对于那些您指定顶点处的纹理坐标在 [0, 1] 间隔之外的那些，但不是重复图像，而是仅显示一次，仅重复边缘像素。如果使边缘像素透明，就好像那里没有图像一样。

# css - 将多个css文件合并为一个

> ID：16115447
> 
> 赞同：2
> 
> 时间：2013-04-20T00:58:03.297
> 
> 标签：css, joomla, joomla2.5

我有这个 Joomla！我已经设置了一个 yoo 主题模板，但我的网站非常慢，因为该模板有 30 个外部 CSS 文件和大约 20 个脚本文件。

我已经设法将所有 JavaScript 文件与 component 合并为一个`ScriptMerge`，但对于 CSS，该组件无法正常工作，因为当我将所有 CSS 文件合并为一个时，它会弄乱我的网站。

我也尝试过其他组件`jch optimizer`，`jbetolo`但没有成功！

有谁知道可以为我完成这项工作的组件或插件？或者其他可能的东西，我也尝试了一些用于组合的脚本`.htaccess`，但也没有成功。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2017-02-23T07:59:41.347

我知道这个 Q 是很久以前发布的，但由于我曾经遇到过这种问题，我想我可以分享一个链接到我在为 Joomla 创建模板时经常使用的这两个任务管理器，即：

*   [咕噜声](http://gruntjs.com/)
*   [吞咽](http://gulpjs.com/)

一个简单的 grunt 任务可以在瞬间组合你的 CSS *（见下面的例子）*

```
...
cssmin: {
    target: {
        files: {
            'css/output.css': [
                'style1.css',
                'style2.css'
            ]
        }
    }
}
...
```

干杯!

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-20T01:00:22.260

您可以使用`@import url'file'`将每个 css 文件包含在一个文件中，然后将一个文件包含在您的主页中。

例如在我的网站

```
@import url("nav.css");
@import url("popup.css");
@import url("latestPosts.css");
@import url("home.css"); 
```

此代码放置在顶部，`common.css`然后`common.css`仅包含在`index.php`

可能想看看这里： [http ://www.w3.org/TR/CSS21/cascade.html#at-import](http://www.w3.org/TR/CSS21/cascade.html#at-import)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-20T10:24:21.973

这是允许加载各种扩展的模板驱动 CMS 的常见问题。

Joomla [！extensions 目录](http://extensions.joomla.org/)有一个用于增强“[站点性能](http://extensions.joomla.org/extensions/core-enhancements/performance/site-performance)”的完整部分，有一系列用于组合 CSS 和 Javascript 文件的流行扩展。

[RokBooster](http://extensions.joomla.org/extensions/core-enhancements/performance/site-performance/21233)相当受欢迎。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-04-20T01:08:23.280

也许[Factor CSS](http://zamez.org/factorcss)可以帮助你？通过它运行您的组合文件，看看是否有区别。但是不要忽视免责声明，它指出当样式表依赖于规则的顺序时它可能无法正常工作。这就是**级联样式表**的本质。

[About.com](http://webdesign.about.com/od/beginningcss/a/aa021607.htm)对样式表的引用

> 样式表旨在通过一系列样式级联，例如瀑布上的河流。河流中的水会撞击瀑布中的所有岩石，但只有底部的岩石会影响水流的确切位置。

当您说组合样式表时它会弄乱您的网站。考虑一下添加文件的顺序。自动样式表组合脚本永远不会知道您希望最终结果如何，它所能做的就是根据预先定义的一组指令将您拥有的内容组合起来，而不是根据最终看起来有多好. 因此，请确保输入正确并且文件以正确的顺序组合。

[这是一个关于样式表中的级联顺序和继承](http://monc.se/kitchen/38/cascading-order-and-inheritance-in-css)的有趣链接，可能会有所帮助。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2015-09-10T14:13:58.310

如果您喜欢编码......这里有一个解决方案。

您可以通过使用以下内容创建一个 php 文件，将您的 css 文件动态地捆绑为一个：

```
<?php
# File combcss.php
readfile("stylesheet1.css");
readfile("stylesheet2.css");
?> 
```

然后你可以这样调用你的样式表：

```
<link rel="stylesheet" type="text/css" href="/combcss.php" /> 
```

# java - Javamail 无法将套接字转换为 TLS GMail

> ID：16115453
> 
> 赞同：69
> 
> 时间：2013-04-20T01:00:30.367
> 
> 标签：java, email, gmail, jakarta-mail

我正在尝试通过 gmails SMTP 服务器使用 JavaMail 发送电子邮件。但是这个代码。

```
final String username = "mygmail@gmail.com";
    final String password = "mygmailpassword";

    Properties props = new Properties();
    props.put("mail.smtp.auth", true);
    props.put("mail.smtp.starttls.enable", true);
    props.put("mail.smtp.host", "smtp.gmail.com");
    props.put("mail.smtp.port", "587");

    Session session = Session.getInstance(props,
            new javax.mail.Authenticator() {
                protected PasswordAuthentication getPasswordAuthentication() {
                    return new PasswordAuthentication(username, password);
                }
            });

    try {

        Message message = new MimeMessage(session);
        message.setFrom(new InternetAddress("no-reply@gmail.com"));
        message.setRecipients(Message.RecipientType.TO,
                InternetAddress.parse("test@gmail.com"));
        message.setSubject("Testing Subject");
        message.setText("Dear Mail Crawler,"
                + "\n\n No spam to my email, please!");

        Transport.send(message);

        System.out.println("Done");

    } catch (MessagingException e) {
        throw new RuntimeException(e);
    } 
```

返回此错误

```
Could not convert socket to TLS; 
```

完整的堆栈跟踪

```
Exception in thread "main" java.lang.RuntimeException: javax.mail.MessagingException: Could not convert socket to TLS;
  nested exception is:
    javax.net.ssl.SSLHandshakeException: sun.security.validator.ValidatorException: PKIX path building failed: sun.security.provider.certpath.SunCertPathBuilderException: unable to find valid certification path to requested target
    at Test.main(Test.java:43)
Caused by: javax.mail.MessagingException: Could not convert socket to TLS;
  nested exception is:
    javax.net.ssl.SSLHandshakeException: sun.security.validator.ValidatorException: PKIX path building failed: sun.security.provider.certpath.SunCertPathBuilderException: unable to find valid certification path to requested target
    at com.sun.mail.smtp.SMTPTransport.startTLS(SMTPTransport.java:1907)
    at com.sun.mail.smtp.SMTPTransport.protocolConnect(SMTPTransport.java:666)
    at javax.mail.Service.connect(Service.java:317)
    at javax.mail.Service.connect(Service.java:176)
    at javax.mail.Service.connect(Service.java:125)
    at javax.mail.Transport.send0(Transport.java:194)
    at javax.mail.Transport.send(Transport.java:124)
    at Test.main(Test.java:38)
Caused by: javax.net.ssl.SSLHandshakeException: sun.security.validator.ValidatorException: PKIX path building failed: sun.security.provider.certpath.SunCertPathBuilderException: unable to find valid certification path to requested target
    at com.sun.net.ssl.internal.ssl.Alerts.getSSLException(Alerts.java:174)
    at com.sun.net.ssl.internal.ssl.SSLSocketImpl.fatal(SSLSocketImpl.java:1649)
    at com.sun.net.ssl.internal.ssl.Handshaker.fatalSE(Handshaker.java:241)
    at com.sun.net.ssl.internal.ssl.Handshaker.fatalSE(Handshaker.java:235)
    at com.sun.net.ssl.internal.ssl.ClientHandshaker.serverCertificate(ClientHandshaker.java:1206)
    at com.sun.net.ssl.internal.ssl.ClientHandshaker.processMessage(ClientHandshaker.java:136)
    at com.sun.net.ssl.internal.ssl.Handshaker.processLoop(Handshaker.java:593)
    at com.sun.net.ssl.internal.ssl.Handshaker.process_record(Handshaker.java:529)
    at com.sun.net.ssl.internal.ssl.SSLSocketImpl.readRecord(SSLSocketImpl.java:893)
    at com.sun.net.ssl.internal.ssl.SSLSocketImpl.performInitialHandshake(SSLSocketImpl.java:1138)
    at com.sun.net.ssl.internal.ssl.SSLSocketImpl.startHandshake(SSLSocketImpl.java:1165)
    at com.sun.net.ssl.internal.ssl.SSLSocketImpl.startHandshake(SSLSocketImpl.java:1149)
    at com.sun.mail.util.SocketFetcher.configureSSLSocket(SocketFetcher.java:549)
    at com.sun.mail.util.SocketFetcher.startTLS(SocketFetcher.java:486)
    at com.sun.mail.smtp.SMTPTransport.startTLS(SMTPTransport.java:1902)
    ... 7 more
Caused by: sun.security.validator.ValidatorException: PKIX path building failed: sun.security.provider.certpath.SunCertPathBuilderException: unable to find valid certification path to requested target
    at sun.security.validator.PKIXValidator.doBuild(PKIXValidator.java:323)
    at sun.security.validator.PKIXValidator.engineValidate(PKIXValidator.java:217)
    at sun.security.validator.Validator.validate(Validator.java:218)
    at com.sun.net.ssl.internal.ssl.X509TrustManagerImpl.validate(X509TrustManagerImpl.java:126)
    at com.sun.net.ssl.internal.ssl.X509TrustManagerImpl.checkServerTrusted(X509TrustManagerImpl.java:209)
    at com.sun.net.ssl.internal.ssl.X509TrustManagerImpl.checkServerTrusted(X509TrustManagerImpl.java:249)
    at com.sun.net.ssl.internal.ssl.ClientHandshaker.serverCertificate(ClientHandshaker.java:1185)
    ... 17 more
Caused by: sun.security.provider.certpath.SunCertPathBuilderException: unable to find valid certification path to requested target
    at sun.security.provider.certpath.SunCertPathBuilder.engineBuild(SunCertPathBuilder.java:174)
    at java.security.cert.CertPathBuilder.build(CertPathBuilder.java:238)
    at sun.security.validator.PKIXValidator.doBuild(PKIXValidator.java:318)
    ... 23 more 
```

* * *

## 回答 #1

> 赞同：149
> 
> 时间：2013-07-23T00:34:05.287

```
props.put("mail.smtp.ssl.trust", "smtp.gmail.com"); 
```

* * *

## 回答 #2

> 赞同：35
> 
> 时间：2015-06-24T05:03:00.007

我禁用了 avast 防病毒软件 10 分钟并使其正常工作。

* * *

## 回答 #3

> 赞同：33
> 
> 时间：2013-12-25T13:02:25.607

确保您的防病毒程序没有干扰，并确保将排除项添加到您的防火墙中。

* * *

## 回答 #4

> 赞同：23
> 
> 时间：2021-01-07T15:46:08.470

当用于发送电子邮件的默认 SSL 协议设置为 TLSv1 并且 smtp 服务器不再支持此协议时，我遇到了类似的问题。诀窍是使用更新的协议：

mail.smtp.ssl.protocols=TLSv1.2

* * *

## 回答 #5

> 赞同：11
> 
> 时间：2018-01-04T13:43:49.113

**@carlos**的第一个答案对我有用：

```
session.getProperties().put("mail.smtp.ssl.trust", "smtp.gmail.com"); 
```

我已经测试了下面的属性并且对我来说也很完美：

```
session.getProperties().put("mail.smtp.starttls.enable", "true"); 
```

这两个属性单独解决了这类问题，但我保证我同时使用了这两个属性。

* * *

## 回答 #6

> 赞同：8
> 
> 时间：2019-08-14T11:41:08.103

在我的情况下，问题是通过**删除**该行来解决的

```
prop.put("mail.smtp.starttls.enable", "true"); 
```

这可能是因为电子邮件服务器上的一些 ssl 配置错误，我不确定。电子邮件服务器管理员从不承认这一点，总是责怪托管服务提供商 :)

* * *

## 回答 #7

> 赞同：8
> 
> 时间：2020-01-22T15:39:50.270

经过一整天的搜索，我禁用了 Avast 10 分钟和 Windows 防火墙（重要），一切都开始工作了！

这是我的错误：

```
Mail server connection failed; nested exception is javax.mail.MessagingException: Could not convert socket to TLS; nested exception is: javax.net.ssl.SSLHandshakeException: sun.security.validator.ValidatorException: PKIX path building failed: sun.security.provider.certpath.SunCertPathBuilderException: unable to find valid certification path to requested target. Failed messages: javax.mail.MessagingException: Could not convert socket to TLS; nested exception is: javax.net.ssl.SSLHandshakeException: sun.security.validator.ValidatorException: PKIX path building failed: sun.security.provider.certpath.SunCertPathBuilderException: unable to find valid certification path to requested target 
```

**以下是如何通过向 SMTP 端口 587（或您的应用程序使用的任何端口）添加排除**项来解决 Avast 19.8.2393 中的问题：****

 **1.  打开 Avast

2.  点击“设置”

3.  单击“疑难解答”，然后单击“打开旧设置”

[![在此处输入图像描述](https://i.stack.imgur.com/XZww0.png)](https://i.stack.imgur.com/XZww0.png)

4.  再次单击“疑难解答”，向下滚动到“重定向设置”并删除您的应用使用的端口。

[![在此处输入图像描述](https://i.stack.imgur.com/oWxtD.png)](https://i.stack.imgur.com/oWxtD.png)

就我而言，我刚刚从 SMTP 端口中删除了 587。

现在我可以使用 Avast 并打开我的 Windows 防火墙（无需为防火墙添加额外的排除项）。

这是我的**application.properties**电子邮件属性：

```
###### I am using a Google App Password which I generated in my Gmail Security settings ######
spring.mail.host = smtp.gmail.com
spring.mail.port = 587
spring.mail.protocol = smtp
spring.mail.username = gmail account
spring.mail.password = password
spring.mail.properties.mail.smtp.auth=true
spring.mail.properties.mail.smtp.starttls.enable=true
spring.mail.properties.mail.smtp.connectiontimeout=5000
spring.mail.properties.mail.smtp.timeout=5000
spring.mail.properties.mail.smtp.writetimeout=5000 
```

* * *

## 回答 #8

> 赞同：5
> 
> 时间：2020-07-17T20:16:16.330

上面的 application.properties 对我来说很棒：

```
spring.mail.properties.mail.smtp.starttls.enable=true
spring.mail.properties.mail.smtp.starttls.required=true
spring.mail.properties.mail.smtp.auth=true
spring.mail.properties.mail.smtp.ssl.trust=smtp.gmail.com 
```

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2019-08-22T14:04:00.057

如果应用程序不支持SMTP 主机正在使用的*TLS 版本，也可能出现这种情况。*

例如，当您的应用程序（或使用较旧的 javax.mail JAR 的 java 程序）仅支持 TLSv1.1 时，尝试配置使用 TLSv1.2 而没有回退的 SMTP 服务器。

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2019-07-11T18:26:01.693

尝试将端口更改为 465

```
mail.smtp.socketFactory.port=465
mail.smtp.port=465 
```

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2015-08-12T04:28:53.657

如果您的上下文是 android 应用程序，请确保您的 android 设备时间设置为当前日期和时间。潜在的例外是“SSL 证书未通过身份验证”。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2021-01-06T04:44:20.970

是的，它适用于本地主机：

```
props.put("mail.smtp.ssl.trust", "smtp.gmail.com"); 
```

该错误仅在本地主机上引发，因此您也应该在远程服务器上尝试。通常，上面提到的代码片段在没有`ssl.trust`属性的情况下运行良好

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2021-08-17T11:10:32.407

下面的一组属性`application.properties`对我有用：

```
spring.mail.host=smtp.gmail.com
spring.mail.port=587
spring.mail.username=<gmail_id>
spring.mail.password=<gmail_password>
spring.mail.properties.mail.smtp.ssl.trust=smtp.gmail.com
spring.mail.properties.mail.smtp.auth=true
spring.mail.properties.mail.smtp.starttls.enable=true
spring.mail.properties.mail.smtp.starttls.required=true 
```

请注意，如果您为您的 Gmail 帐户启用了两步验证，那么`gmail_password`上述配置中的密码不应是普通密码，而是为您的 Google 帐户生成的 16 个字符的应用程序密码。按照此[链接](https://support.google.com/accounts/answer/185833)查看详细信息并生成您的 Google 应用密码。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2021-10-12T07:01:41.570

就我而言，我使用的是**OpenJDK**，当我**切换**到**OracleJDK**时，问题得到了解决。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2020-12-07T13:59:10.820

检查 JavaMail 库的版本（mail.jar 或 javax.mail.jar）。也许你需要一个更新的。从这里下载最新版本：[https ://javaee.github.io/javamail/](https://javaee.github.io/javamail/)

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2015-11-17T14:40:10.850

这是工作解决方案兄弟。有保证

1）首先打开您要从中发送邮件的gmail帐户，例如“xyz@gmail.com”

2) 打开以下链接[https://support.google.com/accounts/answer/6010255?hl=en](https://support.google.com/accounts/answer/6010255?hl=en)

3) 单击“我的帐户”中的“转到“安全性较低的应用程序”部分。” 选项

4）然后打开它

5）就是这样（：

这是我的代码

```
import javax.mail.*;
import javax.mail.internet.*;
import java.util.*;

public class SendEmail {

   final String senderEmailID = "Sender Email id";
final String senderPassword = "Sender Pass word";
final String emailSMTPserver = "smtp.gmail.com";
final String emailServerPort = "465";
String receiverEmailID = null;
static String emailSubject = "Test Mail";
static String emailBody = ":)";
public SendEmail(String receiverEmailID, String emailSubject, String emailBody)
{
this.receiverEmailID=receiverEmailID;
this.emailSubject=emailSubject;
this.emailBody=emailBody;
Properties props = new Properties();
props.put("mail.smtp.user",senderEmailID);
props.put("mail.smtp.host", emailSMTPserver);
props.put("mail.smtp.port", emailServerPort);
props.put("mail.smtp.starttls.enable", "true");
props.put("mail.smtp.auth", "true");
props.put("mail.smtp.socketFactory.port", emailServerPort);
props.put("mail.smtp.socketFactory.class","javax.net.ssl.SSLSocketFactory");
props.put("mail.smtp.socketFactory.fallback", "false");
SecurityManager security = System.getSecurityManager();
try
{
Authenticator auth = new SMTPAuthenticator();
Session session = Session.getInstance(props, auth);
MimeMessage msg = new MimeMessage(session);
msg.setText(emailBody);
msg.setSubject(emailSubject);
msg.setFrom(new InternetAddress(senderEmailID));
msg.addRecipient(Message.RecipientType.TO,
new InternetAddress(receiverEmailID));
Transport.send(msg);
System.out.println("Message send Successfully:)");
}
catch (Exception mex)
{
mex.printStackTrace();
}
}
public class SMTPAuthenticator extends javax.mail.Authenticator
{
public PasswordAuthentication getPasswordAuthentication()
{
return new PasswordAuthentication(senderEmailID, senderPassword);
}
}
    public static void main(String[] args) {
       SendEmail mailSender;
        mailSender = new SendEmail("Receiver Email id","Testing Code 2 example","Testing Code Body yess");
    }

} 
```

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2021-12-13T01:58:34.030

这取决于“嵌套异常”。如果嵌套异常是“没有适当的协议”，则在系统属性中指定协议：

```
-Dmail.smtp.ssl.protocols=TLSv1.2 
```

我看到有些人建议在创建 STMP 会话的代码中设置它，但是如果您想在将来更新该值，则需要进行修补和部署。使用系统属性允许您在不更改代码的情况下对其进行更新。

* * *

## 回答 #18

> 赞同：-1
> 
> 时间：2013-04-20T23:16:22.853

尝试使用 JavaMail 附带的 smtpsend 程序，如此处[所述](http://www.oracle.com/technetwork/java/javamail/faq/index.html#gmail)。如果以同样的方式失败，则说明您的 JDK 配置或网络配置有问题。

* * *

## 回答 #19

> 赞同：-1
> 
> 时间：2017-06-11T19:07:09.373

是什么帮助我解决了这个问题，并且在此之前我已经尝试了所有方法，就是将我安装的 jre 配置为 JRE 1.8。

Eclipse 中的步骤：Windows>preferences>java>installed JRE>jre1.8.0

如果设置为 jdk，则切换到 jre（这是最新 Java 版本默认设置的）。**

# javascript - Rails 表单选择验证

> ID：16115455
> 
> 赞同：2
> 
> 时间：2013-04-20T01:01:17.167
> 
> 标签：javascript, jquery, html, ruby-on-rails

我不想接受`<option value="">Select one</option>`我的 Rails 表单中的 a 。

这是我的代码：

```
<div class="field">
    <p><%= f.label :category, "Category:" %></p>
    <%= f.select(:category, [["-- Select One --", "false"],'Analytics','Commerce','Content Management','Gaming','Green','Media','Social Media','Technology - Software','Technology - Hardware', 'Web']) %>
</div> 
```

使用 JQuery 验证插件：

```
$(document).ready(function(){
  $("input[name='commit']").click(function(){
    $("#new_startup").validate({
      rules: { startup[category]: { valueNotEquals: "false" } },
      messages: { startup[category]: { valueNotEquals: "Please select one" } } 
    });
    if ($("#new_startup").valid())
      location.href = "#";
      $("#tag").css("display","none");
      $("#thank-you").css("display","block");
  });
}); 
```

但是这不起作用...有更好的方法吗？

设置`["-- Select One --", ""]`也没有用。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-20T02:25:06.283

我相信您想要 a`prompt`或 an`include_blank`在您的选择中。

`<%= f.select(:category, ['Analytics','Commerce','Content Management','Gaming','Green','Media','Social Media','Technology - Software','Technology - Hardware', 'Web'], :include_blank => '-- Select One --') %>`

有关更多信息，请参阅[文档](http://api.rubyonrails.org/classes/ActionView/Helpers/FormOptionsHelper.html)。

# c# - 这个睡眠线程有什么意义

> ID：16115456
> 
> 赞同：-2
> 
> 时间：2013-04-20T01:01:18.893
> 
> 标签：c#, multithreading, thread-sleep

我现在正在浏览一些不是我的代码。在代码中有一个带有以下代码的线程：

```
while (true)
{
     Thread.sleep(int.MaxValue);
} 
```

它还捕获 InterruptedException 并立即返回循环，因此循环甚至不能被中断。

有谁知道为什么这个线程会存在，目的是什么？

编辑：完整的代码，更多的上下文：

```
using IKVM.Attributes;
using java.lang;
using System;
using System.Runtime.CompilerServices;
namespace applicationNamespace
{
internal sealed class DedicatedServerSleepThread : Thread
{
    internal DedicatedServer theDecitatedServer;

    [MethodImpl(MethodImplOptions.NoInlining)]
    internal DedicatedServerSleepThread(DedicatedServer dedicatedServer)
    {
        this.theDecitatedServer = dedicatedServer;
        base.setDaemon(true);
        this.start();
    }
    [MethodImpl(MethodImplOptions.NoInlining)]
    public override void run()
    {
        while (true)
        {
            try
            {
                while (true)
                {
                    System.Threading.Thread.Sleep(int.MaxValue);
                }
            }
            catch (System.Threading.ThreadInterruptedException)
            {
            }
        }
    }
    static DedicatedServerSleepThread()
    {
    }
}
} 
```

请注意，前面的代码使用了一些非标准库，因此小写的 sleep 是有效的。具体来说，它使用的是 ikvm 库（基于 java 标准库，用于将 java 程序交叉编译到 .net）

这是一个 java 服务器程序，我将其交叉编译为 .net 字节码，然后进行反编译。我不确定是否有人看到过出于任何原因专门用于睡觉的线程，如果有的话，原因是什么。ta.speot.is 给出了一个非常好的答案。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-20T01:46:45.177

让我们忽略您发布的代码，因为它不会编译，而只关注永远休眠的线程是否有任何用途。

对于一个工作是睡眠的线程，我可以想到三个原因，但没有一个是特别合理的。

**什么都不做**

该线程可能永远存在以做任何有意义的事情。如果有人让你创建一个不应该做任何有意义的事情的线程，你可能会想出那个代码。

**保持 CLR/进程活跃**

如果它是前台线程，即使主线程完成，该线程也会使进程和 CLR 保持活动状态。[来自 MSDN](http://msdn.microsoft.com/en-us/library/h339syd0.aspx)：

> 托管线程要么是后台线程，要么是前台线程。后台线程与前台线程相同，但有一个例外：后台线程不会使托管执行环境保持运行。一旦托管进程中的所有前台线程都已停止（其中 .exe 文件是托管程序集），系统将停止所有后台线程并关闭。

**冷静下来**

有可能通过将线程与睡眠捆绑在一起，其他可以做有意义工作的线程不会被频繁启动（例如，如果它们被安排在线程池或其他环境中）。[来自每日 WTF](http://thedailywtf.com/Articles/Too-Much-Sleep.aspx)：

> 由于一堆数据处理加速，cpu 不再有机会减速。服务器中积聚的热量，风扇控制器油炸，cpu煮熟。作为购买冗余冷却的替代方案，他们让我通过策略性地放置睡眠将应用程序降低到以前的性能水平。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-20T01:05:43.060

编写的代码（`Sleep`大写除外）仅用于创建一个什么都不做的线程，并使用一些额外的内存（用于线程的堆栈数据）。

线程可能打算执行一些其他功能，但它可能应该以另一种方式处理。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-20T01:04:07.173

从您向我们展示的内容来看，它只是创建了一个线程并使其永远休眠。没有更多上下文，我们无法告诉您其他任何信息

# mongodb - 在mongo中搜索范围

> ID：16115464
> 
> 赞同：2
> 
> 时间：2013-04-20T01:02:57.910
> 
> 标签：mongodb, optimization, database

当输入数据是单个值并且集合数据包含最小/最大范围时，在 Mongo 中查找数据的最有效方法是什么？例如：

```
record = { min: number, max: number, payload } 
```

需要为记录的最小/最大范围内的数字查找记录。范围从不相交。范围的大小无法预测。

该集合中有大约 600 万条记录。如果我解压缩范围（范围内的每个值都有记录），我会查看大约 4B 条记录。

我创建了 的复合索引`{min:1,max:1}`，但尝试使用以下方法进行搜索：

```
db.block.find({min:{$lte:value},max:{$gte:value}) 
```

... 需要几秒到几十秒的时间。下面是 和 的`explain()`输出`getIndexes()`。有什么技巧可以让搜索执行得更快吗？

```
NJmongo:PRIMARY> db.block.getIndexes()
[
    {
            "v" : 1,
            "key" : {
                    "_id" : 1
            },
            "ns" : "mispot.block",
            "name" : "_id_"
    },
    {
            "v" : 1,
            "key" : {
                    "min" : 1,
                    "max" : 1
            },
            "ns" : "mispot.block",
            "name" : "min_1_max_1"
    }
] 

NJmongo:PRIMARY> db.block.find({max:{$gte:1135194602},min:{$lte:1135194602}}).explain()
{
    "cursor" : "BtreeCursor min_1_max_1",
    "isMultiKey" : false,
    "n" : 1,
    "nscannedObjects" : 1,
    "nscanned" : 1199049,
    "nscannedObjectsAllPlans" : 1199050,
    "nscannedAllPlans" : 2398098,
    "scanAndOrder" : false,
    "indexOnly" : false,
    "nYields" : 7534,
    "nChunkSkips" : 0,
    "millis" : 5060,
    "indexBounds" : {
            "min" : [
                    [
                            -1.7976931348623157e+308,
                            1135194602
                    ]
            ],
            "max" : [
                    [
                            1135194602,
                            1.7976931348623157e+308
                    ]
            ]
    },
    "server" : "ccc:27017"
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-20T05:33:19.770

If the ranges of your `block` records never overlap, then you can accomplish this much faster with:

```
db.block.find({min:{$lte:value}}).sort({min:-1}).limit(1) 
```

This query will return almost instantly since it can find the record with a simple lookup in the index.

The query you are running is slow because the two clauses each match on millions of records that must be merged. In fact, I think your query would run faster (maybe much faster) with separate indexes on `min` and `max` since the `max` part of your compound index can only be used for a given `min` -- not to search for documents with a specific `max`.

# string - 无需在 Clojure 中转义引号即可轻松处理文本的方法？

> ID：16115465
> 
> 赞同：5
> 
> 时间：2013-04-20T01:03:04.207
> 
> 标签：string, clojure, escaping, read-eval-print-loop

我在 REPL 中进行文本解析，有时想将一堆数据转储到一个字符串中，无论是 bibtex 条目还是一些 EBNF 符号等。通常字符串中可能有引号，而且非常繁琐且容易出错，必须手动转义它们..

是否有另一种方法可以做到这一点，例如 Ruby 的`%Q|I`可以使用`"Quotation Marks"|`等`heredocs`？或者是否可以编写一个宏或修改阅读器来启用它？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-26T05:20:17.150

已经有[一些](http://dev.clojure.org/display/design/Alternate+string+quote+syntaxes)关于更健壮的引用语法的讨论，但似乎没有任何更改来支持这一点。

同时，要专门处理您提到的 REPL 交互，您可能会发现这很有用。请注意，它可能不适用于那里的每个 REPL——它们并不是都支持`read-line`得非常好：

```
（定义读取行 []
  (->> (反复读行)
       (take-while #(not= % "."))
       (mapcat #(list % "\n"))
       （应用str）））

```

通过`(read-lines)`在 REPL 上运行，粘贴您的内容，然后单独添加一行来使用`.`它：

```
用户=>（阅读行）
  #_=> 这个“有效”
  #_=> 有时...
  #_=> 。
"这\"有效\"\n有时...\n"
用户=>（打印 *1）
这个“有效”
有时...
零

```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2016-02-02T10:09:12.830

如何简单地使用一个临时文件，将文本转储到其中，然后使用`slup`. 这样一来，每当您调用它时，一切都会自动转义？

```
(slurp "tempfile.txt") 
```

或者

```
(def data (slurp "tempfile.txt")) 
```

或者

```
(defn rd [] (def data (slurp "tempfile.txt"))) 
```

# javascript - 星域不会出现，会不会是我显卡的原因

> ID：16115467
> 
> 赞同：0
> 
> 时间：2013-04-20T01:04:05.703
> 
> 标签：javascript, html, webgl, graphic, vga

我正在一个使用 THREE.js 的 WebGL 项目中工作，在这个项目中我必须制作一个太阳能系统。

但是只有一个问题，星域不会出现在屏幕上......我尝试了很多我可以在互联网上找到的代码，我完成了教程的步骤，但仍然没有工作。我也下载了星空的代码，但是星空还是没有出现！！

我想问你，问题是我的VGA（显卡）吗？？以下是我的显卡规格：

芯片类型：Mobile Intel(R) 4 Series Express Chipset Family DAC 类型：内部适配器串：Mobile Intel(R) GMA 4500MHD Bios 信息：Intel Video BIOS

总可用图形内存：797 MB 专用视频内存：64 MB 系统视频内存：0MB 共享系统内存：733 MB

与星域有关的一切都不会出现在屏幕上，所有其他的东西，如球体、立方体、圆环、纹理映射等，都可以正常工作，只有星域没有！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-20T18:09:39.637

您没有展示图片，但如果经过强烈过滤，星空通常会消失或变黑。尝试为星空使用不同的、无意义的图片，看看它是否出现。

原因：纹理按比例缩小。因此，如果您在一个 16x16 像素的区域中有一颗 1 像素明亮的 0xFF 星，当这些像素被过滤掉时，结果亮度将仅为 0x01

解决方法：使用较小的纹理或未过滤的纹理

# joomla - 使用 PHP 在主模板中 Echo Joomla K2 项目标题

> ID：16115469
> 
> 赞同：0
> 
> 时间：2013-04-20T01:04:16.230
> 
> 标签：joomla, title, joomla-k2

我试图简单地回显我正在查看的当前 k2 项目的标题，但回显不会出现在 K2 模板中，它应该显示在我的 MAIN 站点模板中。

我试过这个：

```
<?php echo $this->title; ?> 
```

但这会显示完整的站点标题，包括我的公司名称，因为我在主 Joomla 配置中设置了这种方式。

我不想要为网站头部的“标题”标签生成的完整网站标题；我只想生成我当前正在查看的特定项目的名称。这可能很容易，但我的 PHP 知识有限。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-01-10T17:13:45.527

我意识到这已经很老了。但是，如果您仍在寻找解决方案。这不是很优雅，但会做你想做的事。

首先，以防万一您不知道，您可以通过执行以下操作从任何地方获取文章 ID，`JRequest:getVar('id')`这将使用 GET 请求从 URL 获取 ID。

```
$id = JRequest::getVar('id'); 
$id = explode(':',$id);
echo $id[0]; 
```

我爆炸它的原因是因为在我的网站中我使用了别名，如果你是并且你在没有你的情况下回显 $id ，你会在表单中看到它`id:alias`。

使用此方法，您可以查询数据库以获取`name`与表中该 id 关联的信息`k2_items`。您可以创建一个函数来执行模板文件夹中其他位置的操作，然后将其分配给您在模板中回显的变量。这样可以使您的模板保持干净，但可以为您提供所需的东西。

就像我说的那样，这不是一个快速优雅的解决方案，但会起作用。

# scala - 在 Scala 中正确编码这种存在类型？

> ID：16115472
> 
> 赞同：4
> 
> 时间：2013-04-20T01:05:17.967
> 
> 标签：scala, types, stream, scalaz, existential-type

我有兴趣从 Coutts 等人的 Stream Fusion 论文中对这种 Stream 类型进行编码。我正在探索 Scala 中的流融合，尝试使用宏代替 GHC 的重写规则。

```
data Stream a = ∃s. Stream (s → Step a s) s
data Step a s = Done
              | Yield a s 
              | Skip s 
```

我尝试了几种不同的方法，但我不确定如何在 Scala 中编码 Stream 的类型，以便 S 的两个出现都引用相同的类型。我已经轻松地编写了 Step 类型。

```
sealed abstract class Step[+A, +S]
case object Done extends Step[Nothing, Nothing]
case class Yield[A, S](a: A, s: S) extends Step[A, S]
case class Skip[S](s: S) extends Step[Nothing, S] 
```

到目前为止，这种类型似乎是正确的。我使用了协方差，因此即使我们收到 Yield 并返回 Done 或 Step，A => A 类型的函数也可以工作。就像在 Haskell 中一样。

我的症结是 Stream 的签名。我一直试图将它定义为一个案例类。到目前为止唯一有效的签名是使用 Exists 类型运算符和 Tuple 来保持两个组件中类型 S 的相等性，如下所示。

```
type Exists[P[_]] = P[T] forSome { type T }

case class Stream[A](t: Exists[({ type L[S] = (S => Step[A, S], S)})#L]) 
```

有没有办法对其进行编码以使不需要元组？更接近Haskell（假设存在运算符）的东西：

```
case class Stream(∃ S. f: S => Step[A, S], s: S) 
```

其中每个成员都可以是单独的字段。

我还想到，我可以像这样以 SML 模块/函子风格对其进行编码：

```
trait Stream[A] {
  type S <: AnyRef
  val f: S => Step[A, S]
  val s: S
}

object Stream {
  def apply[A, S1 <: AnyRef](next: S1 => Step[A, S1], st: S1): Stream[A] = new Stream[A] {
    type S = S1
    val f = next
    val s = st
  }

  def unapply[A](s: Stream[A]): Option[(s.f.type, s.s.type)] = Some(s.f, s.s)
} 
```

但这有点复杂。我希望有一个更清晰的方法，我不知道。此外，当我尝试探索这条路径时，我必须做一些事情来满足编译器的要求，例如添加 AnyRef 绑定，而 unapply 方法不起作用。使用来自 scalac 的此错误消息：

```
scala> res2 match { case Stream(next, s) => (next, s) }
<console>:12: error: error during expansion of this match (this is a scalac bug).
The underlying error was: type mismatch;
 found   : Option[(<unapply-selector>.f.type, <unapply-selector>.s.type)]
 required: Option[(s.f.type, s.s.type)]
               res2 match { case Stream(next, s) => (next, s) }
                    ^ 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-20T04:18:29.137

首先，`Step`对我来说看起来很完美。至于`Stream`，我认为你在抽象类型的正确轨道上。这是我想出的（包括 Coutts 论文第 2.1 节中剩余方法的实现）：

```
abstract class Stream[A] {
  protected type S
  def next: S => Step[A, S]
  def state: S

  def map[B](f: A => B): Stream[B] = {
    val next: S => Step[B, S] = this.next(_) match {
      case Done        => Done
      case Skip(s)     => Skip(s)
      case Yield(a, s) => Yield(f(a), s)
    }
    Stream(next, state)
  }

  def unstream: List[A] = {
    def unfold(s: S): List[A] = next(s) match {
      case Done        => List.empty
      case Skip(s)     => unfold(s)
      case Yield(a, s) => a :: unfold(s)
    }
    unfold(state)
  }
}

object Stream {
  def apply[A, S0](n: S0 => Step[A, S0], s: S0) = new Stream[A] {
    type S = S0
    val next = n
    val state = s
  }

  def apply[A](as: List[A]): Stream[A] = {
    val next: List[A] => Step[A, List[A]] = {
      case a :: as => Yield(a, as)
      case Nil     => Done
    }
    Stream(next, as)
  }

  def unapply[A](s: Stream[A]): Option[(s.S => Step[A, s.S], s.S)] =
    Some((s.next, s.state))
} 
```

有几点需要注意：

*   My`unapply`有一个依赖方法类型：它依赖于`s.S`. 我想这可能是你的绊脚石。
*   中的`unfold`方法`unstream`不是尾递归的。

我自己还不太清楚的是，为什么`S`存在/隐藏/随便什么很重要。如果不是，你可以写：

```
case class Stream[A, S](next: S => Step[A, S], state: S) 
```

...但我认为这是有原因的。话虽如此，我也不确定这种方法是否真的隐藏`S`了你想要的方式。但这是我的故事，我会坚持下去。

# java - 无法在 Eclipse 调试器的静态方法中检查实例变量值

> ID：16115476
> 
> 赞同：0
> 
> 时间：2013-04-20T01:05:44.997
> 
> 标签：java, debugging, static-methods

我想跟踪一个实例变量的值，我的断点从一个静态方法开始。我无法检查实例变量值。有没有办法做到这一点？我搜索了谷歌，但没有找到任何线索。

是因为无法在静态方法中访问实例吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-20T01:43:08.737

静态方法不能访问实例变量的值，根据定义，在创建对象实例之前，该变量是未定义的。

```
public class A {

  private int b;

  public static void foo() {
    b = 1;
  }
} 
```

由于这个原因，不会编译。A 解决它以使 b 本身静态。当然，你应该明白将 b 设为静态是什么意思。这意味着无论给定 JVM 中存在多少类实例，都只有一个 b 实例。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-20T01:42:51.070

您可以将要跟踪的变量传递给方法。尽管您每次执行此操作时只需做一个注释，以便在完成测试后将其删除。

但老实说，如果您无法从方法中访问变量，那么在您退出方法时它可能不会改变，除非您有多个线程。因此，您可以在调用方法之后/之前设置断点。

# php - CakePHP：在主控制器中使用插件控制器中的功能

> ID：16115479
> 
> 赞同：0
> 
> 时间：2013-04-20T01:06:00.983
> 
> 标签：php, cakephp, cakephp-2.3

这应该很简单，但我花了一个多小时试图弄清楚，所以感谢您的帮助。

我有一个 CakePHP 插件，`Usermgmt`控制器位于此处：

```
./app/Plugin/Usermgmt/Controller/UsersController.php 
```

我正在尝试`userIdFromUsernameAndPassword()`从我的一个主控制器中调用该控制器中的函数 , 使用类似的东西：

```
$userID = $this->UsersController->userIdFromUsernameAndPassword( 'user@host.com','pass' ); 
```

我需要导入/包含/初始化什么才能使其正常工作？

我已经尝试了各种导入语句，例如`App::uses('UsersController', 'Usermgmt.Controller');`在我的文件顶部，但没有得到任何地方。

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-20T01:32:48.693

简短回答：使用 OOP 并扩展另一个控制器。还要了解 MVC。你不应该在另一个控制器中使用一个控制器的方法，在 CakePHP 中这应该作为一个组件来完成。它们可以在控制器之间共享。[检查 CakePHP 书](http://book.cakephp.org/2.0/en/)。

插件的名称和方法名称也表明这是一个坏插件。这听起来好像有人不知道 CakePHP 的 Auth 组件。再次，检查 AuthComponent 的书。[您需要一个自定义身份验证适配器](http://book.cakephp.org/2.0/en/core-libraries/components/authentication.html#creating-custom-authentication-objects)。

如果用户已登录，您可以通过调用 $this->Auth->user('id') 来获取其 id。阅读关于 Auth 的章节。如果您想要一个正确完成的用户插件，请查看：[CakeDC 用户](http://github.com/cakedc/users)

# java - toString()的问题，如何在不调用对象的情况下使用

> ID：16115483
> 
> 赞同：-1
> 
> 时间：2013-04-20T01:06:51.403
> 
> 标签：java, string, class

对不起，如果这个问题没有意义。另外，我在这里限制了代码，您是否也可以尝试为分配做同样的事情，并且抄袭检查器很烦人：/

因此，对于 java 中的分配，我必须定义一个方法，在该方法中它迭代直到简单的游戏是一个，在每一步之间打印出 toString() 表示。但是，我一直无法让它工作，因为没有创建该类的对象......

我尝试在没有对象的情况下调用 toString() 方法，但是它不打印。我也试过 this.toString() 。下面的代码几乎是我的方法/类的基本模型（不是他们实际做的）

```
public randClass
{

randClass()
{
Box box = new Box();
Square square = new Square();
Duck duck = new Duck();
}

public void doSomething()
{
toSring(); // also tried this.toString();
do
{
box.postion ++;
square.position = 100 - box.position;
this.toString();
}
while(duck.quack() != true);|
}

public String toString()
{
return box.toString() + " " + square.toString() + ";";
}

} 
```

我意识到我可以只调用 box.toString() 等来代替使用 toString() 方法调用，但是，该分配专门要求定义 randClass 对象 toString() 方法。

toString 之前也可以使用，但这是使用自动标记创建 randClass 对象然后调用该方法。

提前感谢您抽出宝贵时间阅读本文，很抱歉让您感到困惑:(

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-20T01:11:54.767

`toString()`它本身不打印任何内容，它只是返回它所属的 Object 的 String 表示形式。

您必须将此字符串传递给某种流，才能将其打印到屏幕或文件中。比如说，对于 an 的 println 方法`OutputStream`，可能类似于 System 中包含的静态方法，例如，可能命名为“out”。

# facebook - 如何使用 OAuth2 自动化 Facebook 的登录过程？

> ID：16115487
> 
> 赞同：-1
> 
> 时间：2013-04-20T01:07:26.013
> 
> 标签：facebook, oauth-2.0

使用 Facebook 处理使用 OAuth 登录的方式，是否甚至可以自动化登录过程？

我尝试了各种方法都没有成功，我的 Facebook 帐户一度被暂时封锁！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-22T13:46:40.897

Facebook 的 OAuth 流程无法自动化，因为它旨在进行人机交互。用户需要单击“允许”按钮来授予对您的应用程序的访问权限。您无法绕过该步骤。

# emacs - Emacs：如何在目录模式下重命名目录？

> ID：16115493
> 
> 赞同：13
> 
> 时间：2013-04-20T01:10:12.987
> 
> 标签：emacs, rename, dired

在 Emacs 中，如何在 dired 模式下重命名目录？

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2013-04-20T01:41:43.733

实际上，如果您选择一个文件并键入“R”，您将在模式行下得到一个提示，该提示将指导您重命名文件。这通常适用于文件，包括目录。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2013-04-22T22:01:45.113

通常，您可以使用探索 dired-mode`C-h m`并将获得有用的摘要，例如：

*   键入 u 以取消标记插入的子目录的文件或所有文件。
*   键入 DEL 以备份一行并取消标记或取消标记。
*   键入 x 以删除（执行）标记为“D”的文件。
*   键入 RET 以查找当前行的文件（如果是目录，则将其放在另一个缓冲区中）。
*   键入 o 在“其他”窗口中查找文件或目录。
*   键入 i 在此缓冲区中插入子目录。
*   **键入 R 以重命名文件或将标记的文件移动到另一个目录。**
*   键入 C 以复制文件。
*   键入 s 以切换按名称/日期排序或更改“ls”开关。
*   键入 g 以读取所有当前扩展的目录 aGain。这将保留所有标记并再次隐藏之前隐藏的子目录。使用`SPC' and`DEL' 按行向下和向上移动。

# php - 为什么有些网站的文件扩展名末尾没有显示 .php？

> ID：16115494
> 
> 赞同：2
> 
> 时间：2013-04-20T01:10:14.867
> 
> 标签：php, html, url

有时当我查看网站 URL 时，它会说这样的话

www.website.com/index.php

其他时候看起来像这样

www.website.com/index/

为什么第二个 URL 没有 .php 或 .html 扩展名？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-20T01:33:27.040

在正常配置的 Web 服务器中，

```
www.website.com/index.php 
```

告诉它从 webroot 目录加载 index.php 文件。这

```
www.website.com/index/ 
```

告诉它在**/index/目录中查找与服务器的****httpd.conf**文件或网站的 webroot 目录中的**.htaccess文件中的****DirectoryIndex**配置指令中列出的文件匹配的文件（参见[http://httpd.apache .org/docs/2.2/mod/mod_dir.html#directoryindex](http://httpd.apache.org/docs/2.2/mod/mod_dir.html#directoryindex)了解详细信息）。

 ****示例配置指令如下所示：

```
DirectoryIndex index.php index.html default.html default.htm 
```

这将告诉 web 服务器，当没有给出文件名时，在当前目录中查找**index.php**文件，如果没有找到**index.html**文件，如果没有找到**default.html**文件等等对于在线上的所有其他内容。

如果您希望能够运行 PHP 文件而不必在其末尾添加**.php**，您可以在配置文件（httpd.conf 或 .htaccess）中设置默认处理程序，例如：

```
ForceType application/x-httpd-php 
```

这将告诉 Apache 将所有文件作为 PHP 处理，无论它们是否具有**.php**扩展名。（见[http://httpd.apache.org/docs/2.2/mod/core.html#forcetype](http://httpd.apache.org/docs/2.2/mod/core.html#forcetype)）

如果您愿意，也可以使用 ModRewrite 重新映射 URL，但 ModRewrite 指令可能会令人困惑且难以排除故障。****

# hadoop - 猪分组和平均功能

> ID：16115495
> 
> 赞同：0
> 
> 时间：2013-04-20T01:10:15.523
> 
> 标签：hadoop, amazon-web-services, apache-pig, elastic-map-reduce

我有看起来像这样的数据

```
STN--- WBAN   YEARMODA    TEMP       DEWP      SLP        STP       VISIB      WDSP     MXSPD   GUST    MAX     MIN   PRCP   SNDP   FRSHTT
030050 99999  19291029    46.7  4    42.0  4   990.9  4  9999.9  0   10.9  4   13.0  4   13.0  999.9    46.9*   44.1  99.99  999.9  010000
030050 99999  19291030    43.5  4    33.5  4  1015.4  4  9999.9  0   12.4  4   14.3  4   18.1  999.9    46.9    42.1   0.00I 999.9  000000
030050 99999  19291031    43.7  4    37.3  4  1026.8  4  9999.9  0   12.4  4    4.5  4    8.9  999.9    46.9*   37.9   0.00I 999.9  000000
030050 99999  19291101    49.2  4    45.5  4  1019.9  4  9999.9  0    6.2  4    8.2  4   13.0  999.9    51.1*   46.0  99.99  999.9  010000
030050 99999  19291102    47.0  4    44.5  4  1013.6  4  9999.9  0    7.8  4    6.2  4    8.9  999.9    51.1    44.1   0.00I 999.9  000000
030050 99999  19291103    44.0  4    36.0  4  1009.2  4  9999.9  0   10.9  4    8.0  4    8.9  999.9    50.0    42.1   0.00I 999.9  000000 
```

我想得到每个月的平均值，在这种情况下：10 和 11。

首先，我使用以下方法加载数据：

```
RAW_LOGS = LOAD 'data' as (line:chararray); 
```

然后我使用正则表达式将数据分成不同的变量：

```
LOGS_BASE = FOREACH RAW_LOGS GENERATE 
    FLATTEN( 
       REGEX_EXTRACT_ALL(line, '^(\\d+)\\s+(\\d+)\\s+(\\d{4})(\\d{2})(\\d{2})\\s+(\\d+\\.\\d).*$')  
    ) 
    as (
      STN: int, 
      WBAN: int, 
      YEAR: int, 
      MONTH: int,
      DAY: int,
      TEMP: float
  ); 
```

接下来，我摆脱了以前包含标题数据的顶部元组：

```
no_nulls = FILTER LOGS_BASE BY STN is not null; 
```

然后我按 STN、WBAN、YEAR 和 MONTH 对数据进行分组：

```
grouped = group no_nulls by STN..MONTH; 
```

最后我尝试生成平均值并遇到错误：

```
C = FOREACH grouped GENERATE AVG(LOGS_BASE.TEMP);

ERROR org.apache.pig.tools.grunt.Grunt - ERROR 1045:
<line 17, column 29> Could not infer the matching function for org.apache.pig.builtin.AVG as    multiple or none of them fit. Please use an explicit cast. 
```

我认为错误可能与我的正则表达式有关，因为它将 TEMP 作为字符串返回，即使我告诉它是双精度的，但我可能是错的。

编辑：我将 C 更改为：

```
C = FOREACH grouped GENERATE AVG(no_nulls.TEMP); 
```

现在我得到这个错误：

```
HadoopVersion   PigVersion      UserId  StartedAt       FinishedAt      Features
1.0.3   0.9.2-amzn      hadoop  2013-04-20 19:55:25     2013-04-20 19:57:21     GROUP_BY,FILTER

Failed!

Failed Jobs:
JobId   Alias   Feature Message Outputs
job_201304201942_0001   C,LOGS_BASE,RAW_LOGS,grouped,no_nulls   GROUP_BY,COMBINER       Message: Job failed! Error - # of failed Map Tasks exceeded allowed limit. FailedCount: 1\. LastFailedTask: task_201304201942_0001_m_000000 hdfs://10.254.106.85:9000/tmp/temp413183623/tmp1677272203, 
```

日志有更多信息：

```
org.apache.pig.backend.executionengine.ExecException: ERROR 2106: Error while computing average in Initial
    at org.apache.pig.builtin.FloatAvg$Initial.exec(FloatAvg.java:99)
    at org.apache.pig.builtin.FloatAvg$Initial.exec(FloatAvg.java:75)
    at org.apache.pig.backend.hadoop.executionengine.physicalLayer.expressionOperators.POUserFunc.getNext(POUserFunc.java:216)
    at org.apache.pig.backend.hadoop.executionengine.physicalLayer.expressionOperators.POUserFunc.getNext(POUserFunc.java:253)
    at org.apache.pig.backend.hadoop.executionengine.physicalLayer.PhysicalOperator.getNext(PhysicalOperator.java:334)
    at org.apache.pig.backend.hadoop.executionengine.physicalLayer.relationalOperators.POForEach.processPlan(POForEach.java:332)
    at org.apache.pig.backend.hadoop.executionengine.physicalLayer.relationalOperators.POForEach.getNext(POForEach.java:284)
    at org.apache.pig.backend.hadoop.executionengine.physicalLayer.PhysicalOperator.processInput(PhysicalOperator.java:290)
    at org.apache.pig.backend.hadoop.executionengine.physicalLayer.relationalOperators.POLocalRearrange.getNext(POLocalRearrange.java:256)
    at org.apache.pig.backend.hadoop.executionengine.mapReduceLayer.PigGenericMapBase.runPipeline(PigGenericMapBase.java:267)
    at org.apache.pig.backend.hadoop.executionengine.mapReduceLayer.PigGenericMapBase.map(PigGenericMapBase.java:262)
    at org.apache.pig.backend.hadoop.executionengine.mapReduceLayer.PigGenericMapBase.map(PigGenericMapBase.java:64)
    at org.apache.hadoop.mapreduce.Mapper.run(Mapper.java:144)
    at org.apache.hadoop.mapred.MapTask.runNewMapper(MapTask.java:771)
    at org.apache.hadoop.mapred.MapTask.run(MapTask.java:375)
    at org.apache.hadoop.mapred.Child$4.run(Child.java:255)
    at java.security.AccessController.doPrivileged(Native Method)
    at javax.security.auth.Subject.doAs(Subject.java:396)
    at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1132)
    at org.apache.hadoop.mapred.Child.main(Child.java:249)
Caused by: java.lang.ClassCastException: java.lang.String cannot be cast to java.lang.Float
    at org.apache.pig.builtin.FloatAvg$Initial.exec(FloatAvg.java:86)
    ... 19 more

Pig Stack Trace
---------------
ERROR 2997: Unable to recreate exception from backed error: org.apache.pig.backend.executionengine.ExecException: ERROR 2106: Error while computing average in Initial

org.apache.pig.impl.logicalLayer.FrontendException: ERROR 1066: Unable to open iterator for alias C. Backend error : Unable to recreate exception from backed error: org.apache.pig.backend.executionengine.ExecException: ERROR 2106: Error while computing average in Initial
    at org.apache.pig.PigServer.openIterator(PigServer.java:890)
    at org.apache.pig.tools.grunt.GruntParser.processDump(GruntParser.java:679)
    at org.apache.pig.tools.pigscript.parser.PigScriptParser.parse(PigScriptParser.java:303)
    at org.apache.pig.tools.grunt.GruntParser.parseStopOnError(GruntParser.java:189)
    at org.apache.pig.tools.grunt.GruntParser.parseStopOnError(GruntParser.java:165)
    at org.apache.pig.tools.grunt.Grunt.run(Grunt.java:69)
    at org.apache.pig.Main.run(Main.java:500)
    at org.apache.pig.Main.main(Main.java:114)
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
    at java.lang.reflect.Method.invoke(Method.java:597)
    at org.apache.hadoop.util.RunJar.main(RunJar.java:187)
Caused by: org.apache.pig.backend.executionengine.ExecException: ERROR 2997: Unable to recreate exception from backed error: org.apache.pig.backend.executionengine.ExecException: ERROR 2106: Error while computing average in Initial
    at org.apache.pig.backend.hadoop.executionengine.mapReduceLayer.Launcher.getErrorMessages(Launcher.java:221)
    at org.apache.pig.backend.hadoop.executionengine.mapReduceLayer.Launcher.getStats(Launcher.java:151)
    at org.apache.pig.backend.hadoop.executionengine.mapReduceLayer.MapReduceLauncher.launchPig(MapReduceLauncher.java:354)
    at org.apache.pig.PigServer.launchPlan(PigServer.java:1313)
    at org.apache.pig.PigServer.executeCompiledLogicalPlan(PigServer.java:1298)
    at org.apache.pig.PigServer.storeEx(PigServer.java:995)
    at org.apache.pig.PigServer.store(PigServer.java:962)
    at org.apache.pig.PigServer.openIterator(PigServer.java:875) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-20T16:27:35.000

我的猜测是因为分组不包含 LOGS_BASE，它包含 no_nulls。尝试制作

```
C = FOREACH grouped GENERATE AVG(no_nulls.TEMP); 
```

看看是否可以解决它。

如果这不起作用，请尝试`dump RAW_LOGS`在第一行之后添加并将其他所有内容注释掉，确保看起来不错，然后取消注释第二行并进行转储`dump LOGS_BASE`，重复其余行。对猪脚本的每一部分进行全面检查总是好的。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2015-12-30T04:25:50.743

事实证明，temp 被视为字符串而不是浮点数。我应用了[这里](https://stackoverflow.com/a/8840832/2301021)使用的代码并让它工作。即使我告诉 Pig 将 TEMP 列视为浮点数，它仍将其作为 chararray 读取。`(tuple(int,int,int,int,int,float))`通过将其放在我的`REGEX_EXTRACT_ALL`功能之前，这最终成为了单行修复。这是该代码的样子：

```
LOGS_BASE = FOREACH RAW_LOGS GENERATE 
    FLATTEN( 
        (tuple(int,int,int,int,int,float))
       REGEX_EXTRACT_ALL(line, '^(\\d+)\\s+(\\d+)\\s+(\\d{4})(\\d{2})(\\d{2})\\s+(-?\\d+\\.\\d).*$')  
    ) 
    as (
      STN: int, 
      WBAN: int, 
      YEAR: int, 
      MONTH: int,
      DAY: int,
      TEMP: float
  ); 
```

# java - 如何从现有的 JAva 代码制作 Android 应用程序？

> ID：16115496
> 
> 赞同：-2
> 
> 时间：2013-04-20T01:10:42.767
> 
> 标签：java, android, eclipse

我有一个多人国际象棋程序，我想知道是否有一种简单的方法可以为它制作一个应用程序。如果我值得在 Eclipse 上使用 Android SDK，我是否必须重新编写整个代码，或者我可以只使用 Java 代码来制作应用程序？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-20T01:21:31.653

It depends on what libraries you're using in your game and their support in Android.

If you use Java for the existing implementation, you'll hopefully, have to write the UI bits, and the erst of the logic should simply work.

If this is a desktop app you're trying to port, you may have performance issues (given you're running on a mobile device now), so there would be some changes necessary.

If you're using any graphics libraries, check their support on Android. Some libraries have a reputation of having issues on Android.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-05-18T06:33:55.573

我自己解决了。您只需要插入您的 JS 文件，或者您可以使用您上传的应用程序的 Url。

# git - 在仅存在于初始分支中的路径中检出 git 分支

> ID：16115497
> 
> 赞同：2
> 
> 时间：2013-04-20T01:10:46.523
> 
> 标签：git

谁能帮我理解我在 git 中发现的这个怪癖？

以下是如何重现此怪癖：

```
$ mkdir git-test && cd git-test
$ git init
Initialized empty Git repository in /tmp/git-test/.git/
$ echo hello > world
$ git add world
$ git commit -m'first commit'
[master (root-commit) 5f68103] first commit
 1 file changed, 1 insertion(+)
 create mode 100644 world 
```

酷，到目前为止还好；现在让我们分支：

```
$ git checkout -b a_branch
$ mkdir a_dir
$ echo foo > a_dir/bar
$ git add a_dir/bar
$ git commit -m message
[a_branch (root-commit) 2fbef71] message
 1 file changed, 1 insertion(+)
 create mode 100644 a_dir/bar 
```

好的，怪癖来了！

```
$ cd a_dir
$ pwd
/tmp/git-test/a_dir
$ git checkout master
Switched to branch 'master'
$ pwd
/tmp/git-test/a_dir 
```

哇！？此分支中不存在此路径！

```
$ ls
total 0 
```

甚至`ls`似乎工作...

```
$ cd ..
$ ls
world 
```

目录“a_dir”现在神奇地消失了！

这怎么可能？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-20T01:13:49.110

If I understand correctly, this has not much to do with git.

Your current working directory is being removed by some process (in this case the git branch switch). The same thing would happen if you `rmdir` the current working directory.

```
$ cd /tmp
$ mkdir test
$ cd test
$ rmdir ../test/
$ pwd
/tmp/test
$ ls /tmp/test
ls: /tmp/test: No such file or directory 
```

You can see similar effect when deleting files that are open: They will disappear from the file system, but the program that opened them can still access them, and disk space will only be reclaimed after the program closes them. Note that this behaviour is completely different between UNIXy systems and Windows. Windows would not be let you delete them in the first place.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-20T01:14:00.840

Seems like the directory is locked because you are cd'd into it... So the change to branch master cannot remove the dir while it is in use...

# php - Drupal-寻找代码以将推文打印到 node-type.tpl.php

> ID：16115498
> 
> 赞同：1
> 
> 时间：2013-04-20T01:11:04.717
> 
> 标签：php, drupal-7, drupal-modules

我在 Drupal 7 中使用 Tweet 模块。我需要用于打印 node-type.tpl.php 中的 tweet 字段的代码。不幸的是，我无法找到正确的代码来使链接出现在我的节点中。使用考虑我发现了以下代码；

```
<?php echo $content['tweet']; ?>
<?php echo $content['field_tweet']; ?>
<?php echo render($content['tweet']); ?>
<?php echo render($content['field_tweet']); ?>
<?php print $node->content['body']['#object']->content['links']['tweet']['#theme'] ?>
<?php print $node->content['body']['#object']->content['links']['tweet']['#attributes']['class'][1]?>
<?php print $node->content['body']['#object']->content['links']['tweet']['#attributes']['class'][0]?>
<?php print $node->content['body']['#object']->content['links']['tweet']['#links']['tweet_Twitter']['html']?>
<?php print $node->content['body']['#object']->content['links']['tweet']['#links']['tweet_Twitter']['href']?>
<?php print $node->content['body']['#object']->content['links']['tweet']['#links']['tweet_Twitter']['title']?>
<?php print $node->content['body']['#object']->content['links']['tweet']['#links']['tweet_Twitter']['title']?> 
```

但它们都不起作用。有人有想法么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-26T03:44:25.603

Tweet 模块文档声明它将在节点的链接部分呈现。将此添加到 node--content-type-name.tpl.php 中，您希望在其中呈现推文链接：

```
<?php print render($content['links']); ?> 
```

并清除缓存。

# autocompletetextview - HoloEverywhere AutoCompleteTextView java.lang.ClassCastException

> ID：16115499
> 
> 赞同：0
> 
> 时间：2013-04-20T01:11:15.450
> 
> 标签：autocompletetextview, android-holo-everywhere

我正在尝试让 HoloEverywhere 类 AutoCompleteTextView 与我的应用程序一起使用。这样做的主要原因是我希望 Holo 主题在 3.0 之前的设备（特别是 API 级别 8-10）上工作这是我的主要活动代码：

```
package com.example.testautocomp;

import org.holoeverywhere.widget.AutoCompleteTextView;

import android.app.Activity;
import android.os.Bundle;
import android.widget.ArrayAdapter;

public class MainActivity extends Activity {

    private AutoCompleteTextView m_edit;

    private static final String[] items = { "lorem", "ipsum", "dolor", "sit",
        "amet", "consectetuer", "adipiscing", "elit", "morbi", "vel",
        "augue", "purus", "sitter", "sitting", "sither", "sithar" };

@Override
protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_main);

    m_edit = (AutoCompleteTextView)findViewById(R.id.edit2);

    m_edit.setAdapter(new ArrayAdapter<String>(this,
            android.R.layout.simple_dropdown_item_1line, items));
    }
} 
```

还有我的 activity_main.xml 代码：

```
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
xmlns:tools="http://schemas.android.com/tools"
android:layout_width="match_parent"
android:layout_height="match_parent"
android:orientation="vertical" >

<AutoCompleteTextView
    android:id="@+id/edit2"
    android:layout_width="match_parent"
    android:layout_height="wrap_content"
    android:completionThreshold="1"
    android:hint="Testing" />
</LinearLayout> 
```

当我运行我的应用程序时，它会进入 eclipse 的调试器，在按 resume（或 F8）继续线程后，我的应用程序崩溃/强制关闭，并且我的 LogCat 中出现以下错误：

```
04-19 17:52:56.342: W/dalvikvm(675): threadid=1: thread exiting with uncaught exception (group=0x409c01f8)
04-19 17:52:56.422: E/AndroidRuntime(675): FATAL EXCEPTION: main
04-19 17:52:56.422: E/AndroidRuntime(675): java.lang.RuntimeException: Unable to start activity ComponentInfo{com.example.testautocomp/com.example.testautocomp.MainActivity}: java.lang.ClassCastException: android.widget.AutoCompleteTextView cannot be cast to org.holoeverywhere.widget.AutoCompleteTextView
04-19 17:52:56.422: E/AndroidRuntime(675):  at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1956)
04-19 17:52:56.422: E/AndroidRuntime(675):  at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:1981)
04-19 17:52:56.422: E/AndroidRuntime(675):  at android.app.ActivityThread.access$600(ActivityThread.java:123)
04-19 17:52:56.422: E/AndroidRuntime(675):  at android.app.ActivityThread$H.handleMessage(ActivityThread.java:1147)
04-19 17:52:56.422: E/AndroidRuntime(675):  at android.os.Handler.dispatchMessage(Handler.java:99)
04-19 17:52:56.422: E/AndroidRuntime(675):  at android.os.Looper.loop(Looper.java:137)
04-19 17:52:56.422: E/AndroidRuntime(675):  at android.app.ActivityThread.main(ActivityThread.java:4424)
04-19 17:52:56.422: E/AndroidRuntime(675):  at java.lang.reflect.Method.invokeNative(Native Method)
04-19 17:52:56.422: E/AndroidRuntime(675):  at java.lang.reflect.Method.invoke(Method.java:511)
04-19 17:52:56.422: E/AndroidRuntime(675):  at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:784)
04-19 17:52:56.422: E/AndroidRuntime(675):  at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:551)
04-19 17:52:56.422: E/AndroidRuntime(675):  at dalvik.system.NativeStart.main(Native Method)
04-19 17:52:56.422: E/AndroidRuntime(675): Caused by: java.lang.ClassCastException: android.widget.AutoCompleteTextView cannot be cast to org.holoeverywhere.widget.AutoCompleteTextView
04-19 17:52:56.422: E/AndroidRuntime(675):  at com.example.testautocomp.MainActivity.onCreate(MainActivity.java:22)
04-19 17:52:56.422: E/AndroidRuntime(675):  at android.app.Activity.performCreate(Activity.java:4465)
04-19 17:52:56.422: E/AndroidRuntime(675):  at android.app.Instrumentation.callActivityOnCreate(Instrumentation.java:1049)
04-19 17:52:56.422: E/AndroidRuntime(675):  at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1920)
04-19 17:52:56.422: E/AndroidRuntime(675):  ... 11 more 
```

我该如何解决这个 CastClassException？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-20T11:55:56.547

不，您的上述操作不正确。您应该更改 org.holoeverywhere.app.Activity 上的活动基类。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-04-20T01:11:15.450

非常类似于这个[问题](https://stackoverflow.com/questions/14369534/holoeverywhere-seekbar-classcastexception)

通过将我的 main_activity.xml 更改为：

```
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
xmlns:tools="http://schemas.android.com/tools"
android:layout_width="match_parent"
android:layout_height="match_parent"
android:orientation="vertical" >

<org.holoeverywhere.widget.AutoCompleteTextView
    android:id="@+id/edit2"
    android:layout_width="match_parent"
    android:layout_height="wrap_content"
    android:completionThreshold="1"
    android:hint="Testing" />
</LinearLayout> 
```

主要部分是**org.holoeverywhere.widget.AutoCompleteTextView**

# java - 没有溢出的两个整数（或长整数）的平均值，向 0 截断

> ID：16115501
> 
> 赞同：8
> 
> 时间：2013-04-20T01:11:18.583
> 
> 标签：java, math, overflow, bit-manipulation

我想要一种`(x + y)/2`在 Java 中计算任意两个整数 x、y 的方法。如果 x+y > Integer.MAX_VALUE 或 < Integer.MIN_VALUE，则幼稚的方法会遇到问题。

Guava`IntMath` [使用](http://docs.guava-libraries.googlecode.com/git/javadoc/src-html/com/google/common/math/IntMath.html#line.574)这种技术：

```
 public static int mean(int x, int y) {
    // Efficient method for computing the arithmetic mean.
    // The alternative (x + y) / 2 fails for large values.
    // The alternative (x + y) >>> 1 fails for negative values.
    return (x & y) + ((x ^ y) >> 1);
  } 
```

...但是这轮到负无穷大，这意味着例程不同意像 {-1, -2} （给出 -2，而不是 -1）这样的值的幼稚方式。

是否有任何相应的例程向 0 截断？

“只需使用`long`”不是我正在寻找的答案，因为我想要一种也适用于长输入的方法。`BigInteger`也不是我正在寻找的答案。我不想要任何分支的解决方案。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-20T16:02:02.007

如果最低位不同，则需要添加`1`到结果中（因此结果不准确，需要四舍五入），并且设置了结果中的符号位（结果为负，因此您要向下舍入进一个回合）。

所以以下应该做（未经测试）：

```
public static int mean(int x, int y) {
    int xor = x ^ y;
    int roundedDown = (x & y) + (xor >> 1);
    return roundedDown + (1 & xor & (roundedDown >>> 31));
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-20T01:21:53.590

Why don't you do something like `(x-y)/2 + y`, which reduces to `x/2 - y/2 + y = x/2 + y/2`? So if `x+y` gives you an overflow or underflow, you do it the `(x-y)/2 + y` way.

# asp.net - 使用内部 asmx Web 服务部署网站

> ID：16115502
> 
> 赞同：0
> 
> 时间：2013-04-20T01:11:23.943
> 
> 标签：asp.net, web-services, iis

我有一个为客户创建的 ASP.NET 网站。它将通过 IIS 在他们的笔记本电脑上运行，用于他们在不同位置的内部网。

为了加快一些数据密集型流程，我在VS2010的网站项目中添加了一个Web Service。它是一个非常简单的 Web 服务，位于与网站本身相同的命名空间内。

每个都在我的本地测试环境中运行良好，但在我部署到用户机器时却不行。我构建了一个部署包，因此所有文件和文件夹都正确放置，但是当网站尝试访问 Web 服务时，我收到 500 错误：找不到 Web 服务。

我是否必须通过 IIS 管理器启动或安装某些东西，还是我的 webconfig 有问题？

# html - CSS 箭头不透明度过渡

> ID：16115507
> 
> 赞同：0
> 
> 时间：2013-04-20T01:12:37.463
> 
> 标签：html, css, css-transitions

当您将鼠标悬停在每个项目上时，如何使用我拥有的 CSS 箭头（见下文）并使它们淡入淡出？

**我的 CSS：**

```
#menu li {
  position:relative;
}

#menu li a:after {
  content: " .";
  display: block;
  text-indent: -99em;
  border-bottom: 0.6em solid #1c525a;
  border-left: 0.6em solid transparent;
  border-right: 0.6em solid transparent;
  border-top: none;
  height: 0px;
  margin-left: -.6em;
  margin-right: auto;
  margin-top: -7px;
  position: absolute;
  left: 50%;
  width: 1px;
} 
```

所有代码都[在 jsFiddle](http://jsfiddle.net/pJ6Kg/)中可用。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-20T01:12:37.463

为此，我添加了以下内容：

```
#menu li a:after {
  -webkit-transition:all 0.3s ease-in-out;
  transition:all 0.3s ease-in-out;
}

#menu li:hover a:after {
  border-bottom: 0.6em solid #1c525a;
  -webkit-transition:all 0.3s ease-in-out;
  transition:all 0.3s ease-in-out;
} 
```

[请参阅 jsFiddle](http://jsfiddle.net/fgPf8/) - 我确信这段代码可以被清理或击败，但我还没有在 Stack Overflow 上找到这个示例/答案，所以我想我会添加这个。

# javascript - 滚动而不调用滚动事件

> ID：16115511
> 
> 赞同：1
> 
> 时间：2013-04-20T01:13:03.243
> 
> 标签：javascript, jquery, html

这个网站有这样的布局：

```
section1

section2

section3

section4

section5 
```

每个部分覆盖整个屏幕高度。我需要在预加载图像时将网络滚动到中间（第 3 部分），为此，我使用：

```
var targetOffset = $('#home-nav-bar').offset().top - 183;
$("html, body").animate({ scrollTop: targetOffset }, 100); 
```

用户看不到此效果，因为我在预加载器加载图像时触发它。

但是这个网络也使用了视差效果，我用`stellar.js`. 我遇到的问题是`.animate`触发页面上的滚动事件，并触发恒星代码，它将我的元素从预加载完成后它们应该在的位置移开。有什么方法可以在不使用 .animate which triggers 的情况下“滚动”到 section3`stellar.js`吗？

# javascript - 理解 Javascript 不可变变量

> ID：16115512
> 
> 赞同：41
> 
> 时间：2013-04-20T01:13:05.147
> 
> 标签：javascript

我试图了解 Javascript 不可变变量的含义。如果我能做到：

```
var x = "astring";
x = "str";
console.log(x); //logs str` , then why it is immutable? 
```

我能想到的唯一答案（从 CI 的一点点知道）是 var x 是指向值为“astring”的内存块的指针，在第二条语句之后，它指向另一个值为“str”的块。是这样吗？

还有一个额外的问题：我对 Javascript 的值类型感到困惑。引擎盖下的所有变量都是对象吗？偶数和字符串？

* * *

## 回答 #1

> 赞同：58
> 
> 时间：2013-04-20T01:20:12.147

**值**是不可变的；**变量**不是；它们持有对其（原始）值的引用。

三种基本类型*string、number 和 boolean*具有对应的类型，其实例是对象：*String、Number、Boolean*。
它们有时被称为*[包装类型](https://developer.mozilla.org/en-US/docs/Glossary/Primitive)*。

以下值是[原始](https://developer.mozilla.org/en-US/docs/Glossary/Primitive)的：

*   字符串：“你好”
*   数字：6、3.14（JavaScript 中的所有数字都是浮点数）
*   布尔值：真、假
*   null：通常显式分配
*   undefined：通常是默认（自动分配的）值

所有其他值都是对象，包括原语的包装器。

所以：

*   对象默认是可变的
*   对象具有唯一的身份并通过引用进行比较
*   变量保存对对象的引用
*   原语是不可变的
*   基元是按值比较的，它们没有个体身份

您可能会发现[The Secret Life of JavaScript Primitives](http://javascriptweblog.wordpress.com/2010/09/27/the-secret-life-of-javascript-primitives/)是一个很好的解释。

此外，在 ES6 中有一个新的[const](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Statements/const)关键字，它创建一个只读的命名常量，它不能通过赋值更改值或在脚本运行时重新声明。

希望这可以帮助！

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2013-07-11T15:21:04.557

首先，在 C 中，“字符串是最后一个 elem = '\0' 的字符数组”。它们是可变的。
如果您在 C 中声明并初始化一个字符串，如下所示：

```
char str[] = "Foo"; 
```

您基本上在做的是保留 4 个字节（可能是 8 位字节，如果它伤害了您，请不要介意）。单词 str 用作指向该数组的第一个元素的指针。所以，如果你这样做：

```
str[0] or *(str) = 'G' 
```

然后它将改变该地址的值，而不是创建新数组。您可以通过打印 str 的地址来验证它。在这两种情况下都是一样的。

现在如果 JavaScript 字符串是原始类型。对字符串的所有操作都是按值而不是按引用完成的。所以，这样做会产生真实的。

```
var str1 = "foo";
var str2 = "foo";
str1 === str2; => true 
```

字符串的初始化要求缓冲区适合“foo”并将名称 str1 绑定到它。使它们不可变的原因是您无法更改该缓冲区。所以，你不能这样做：

```
str1[0] = 'G' 
```

在非严格模式下执行此命令不会产生警告或错误，但不会更改 str1。您可以通过以下方式验证它

```
console.log(str1) => "foo" 
```

但如果你这样做：

```
str1 = "goo" 
```

你实际上在做的是你要求一个新的缓冲区来适应“goo”并将标识符 str1 绑定到它。包含“foo”的旧缓冲区没有变化。

那么，“foo”会发生什么？

Java Script 有一个自动垃圾收集器。当它看到一些内存块不再可以被任何标识符引用或......然后它认为该内存是空闲的。

数字，布尔值也是如此。现在，关于包装对象！每当您尝试像这样访问字符串上的属性时：

```
str1.length; 
```

JavaScript 的作用是使用 String 类创建一个新对象并调用字符串上的方法。一旦函数调用返回，对象就会被销毁。下面的代码进一步解释了它：

```
var str = "nature"; 
str.does = "nurtures"; //defining a new property; 
console.log(str.does) => undefined 
```

因为对象已被销毁。试试这个！

```
var str = new String("Nature");
str.does = "nurtures";
console.log(str) =>  ?? 
```

这个 str 真的是一个对象......

结论：在 C 中，在单个范围内，变量名用作指针。所以，int、float、string 都是可变的。但在 Java Script 中，原始类型变量名用作值而不是引用

参考：C++ 入门加，Java Script The Definitive Guide，C by Stephen Kochan

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2013-04-20T01:20:22.633

你是对的。字符串（和数字）在 java 脚本（和许多其他语言）中是不可变的。变量是对它们的引用。当您“更改变量的值”时，您正在更改变量引用的字符串（或其他），而不是值本身。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2018-01-30T14:15:01.810

我认为许多新程序员认为不变性意味着**原始值不能通过重新分配来改变。**

```
var str = "testing";
var str = "testing,testing";
console.log(str); // testing, testing
```

```
var fruits = ["apple", "banana", "orange"];

fruits[0] = "mango";

console.log(fruits); //["mango", "banana", "orange"]
```

与可变和不可变类型相关的值可以通过重新分配来更改，如上面的字符串和数组示例所示。但是，这些数据类型具有关联的函数（方法），用于操作属于每种数据类型的值。这是可以看到可变性/不变性的地方。由于数组是可变的，因此数组方法的任何操作都会直接影响数组。例如，

```
var fruits = ["mango","banana", "orange"];
fruits.pop(); 
console.log(fruits) //["mango", "banana"]

The array.pop() method deleted "orange" from the original fruits array.
But with strings for example,

var name = "Donald Trump";
name.replace("Donald", "President");
console.log(name)//Donald Trump

the original string remains intact!
```

不变性不允许通过 string 方法对原始字符串进行任何更改。相反，如果将方法操作分配给如下变量，则该方法会生成一个新字符串：

```
var name = "Donald Trump";
var newName = name.replace("Donald", "President");
console.log(newName);//President Trump
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2021-06-14T14:30:08.250

我们先在这里了解一下，

```
let firstString = "Tap";

console.log(firstString);  //Output: Tap 

firstString[0] = "N";

console.log(firstString)   //Output: Tap 
```

这是我们可以看到**不可变效果**的地方！

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2021-11-09T22:52:27.603

这个定义中的不变性是历史性的。它与其他编程语言可以做的事情有关。

我认为这是首先要理解的。对于只使用过 JavaScript 的程序员来说，这个问题可能看起来荒谬或不必要的迂腐。将基元描述为不可变就像将冰淇淋描述为无法跳跃一样。为什么我会认为它可以？只有与其他历史上的编程语言相关，在处理原始类型时才明显缺乏可变性。

# scala - 我可以在 Scala 泛型函数中使用嵌套类型吗？

> ID：16115515
> 
> 赞同：0
> 
> 时间：2013-04-20T01:13:41.647
> 
> 标签：scala

如何在 Scala 泛型函数中使用嵌套类型？我想实现这样的东西

```
implicit def basicDBList2List[List[A]](value : BasicDBList) = value.toList.asInstanceOf[List[A]] 
```

编译器给出以下错误：

```
scala: not found: type A
  implicit def basicDBList2List[List[A]](value : BasicDBList) = value.toList.asInstanceOf[List[A]]
                                                                                               ^ 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-20T02:36:49.357

当你写：

```
implicit def basicDBList2List[List[A]](value: BasicDBList) = ... 
```

......这并不意味着你认为它意味着什么。您正在声明一个名为 的新类型参数`List`，而不是引用`List`库中的现有特征！您还声明您新定义的`List`类型需要一些您已调用的类型参数，`A`但您实际上无法引用它。

你的意思可能是：

```
implicit def basicDBList2List[A](value: BasicDBList): List[A] = ... 
```

...这说明，对于任何类型`A`，您都可以将 a 转换`BasicDBList`为 a `List[A]`。

不过，这是粗略的代码，原因有两个：

1.  `BasicDBList`您的课程实际上包含什么类型？恐怕没有任何可能`A`。你很可能会`ClassCastException`在运行时得到。
2.  为什么要从`BasicDBList`to进行隐式转换`List[A]`？这几乎总是一个坏主意。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-20T02:32:18.673

我认为最好是这样：

```
implicit def basicDBList2List[A](value : BasicDBList) = value.toList.asInstanceOf[List[A]] 
```

# magento - Magento can't save new products anymore

> ID：16115516
> 
> 赞同：0
> 
> 时间：2013-04-20T01:13:45.867
> 
> 标签：magento, magento-1.7

Everything was fine 'til this morning. I've tried clearing cache, re indexing, all tips I could find on the internet. Here is the message I'm getting Fatal error: Call to a member function getId() on a non-object in /home5/rockbott/public_html/app/code/core/Mage/Adminhtml/controllers/Catalog/ProductController.php on line 578

here is line 577 and 578:

```
 if (Mage::app()->isSingleStoreMode()) {
        $product->setWebsiteIds(array(Mage::app()->getStore(true)->getWebsite()->getId())); 
```

A newly created product gives me Fatal Error message. Duplicated product gives me the same, but when I go to manage products it appears, but without SKU# and 0 stock count. When I try to edit that product again - I get Fatal Error. Please help me with my problem.

Thanks in advance.

* * *

Thanks for your response. Someone suggested that I clear log file and I did. I'm sorry I don't have the log file. Compiler is disabled as well. Would you be kind enough to take a look here: [http://www.magentocommerce.com/boards/viewthread/347764/](http://www.magentocommerce.com/boards/viewthread/347764/) I've posted more information there including reports. Thank you Anna

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-09-16T23:36:38.213

我意识到这很旧，但是在安装 Magento 1.9.0.1 时我遇到了同样的问题。我不确定发生了什么，但启用缓存允许它为我工作。诡异的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-06-03T19:15:21.243

在我的情况下，导致它的原因似乎是`Mage.php`我用来跟踪事件的剩余日志记录行。

在第 447 行，我有：

```
Mage::log($name, null, 'events.log'); 
```

删除此日志记录行解决了该问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-20T12:59:57.027

用你的信息很难找到问题所在。您可以粘贴您的 system.log 文件吗？

一个问题：您是否启用了编译器？尝试禁用它。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2015-01-26T08:37:22.437

我有同样的错误。解决方案非常简单：您需要将**getStore(true)**替换为**getStore(1)**。这很奇怪，因为在 PHP 中**与 1****相同**……但在这方面是一个错误。如果您做出“更正确”并写下：

 **```
$product->setWebsiteIds(array(Mage::app()->getStore(Mage::app()->getStore()->getId())->getWebsite()->getId())); 
```

Magento 给你的不是真实的网站。懒得找了，还有程序员 Magento (getStore (true)) :)) 所以我决定离开它**

# python - 调用类函数的不同方式

> ID：16115517
> 
> 赞同：0
> 
> 时间：2013-04-20T01:13:48.807
> 
> 标签：python

说我有这个代码：

```
class ClassStyleA(object):
    def FunctionA(self):
        print "This is Style A."

class ClassStyleB(object):
    def FunctionA(self):
        print "This is Style B."

class InstanceStyleA(ClassStyleA):
    def FunctionB(self):
        print "This is also Style A."

InstanceStyleB = ClassStyleB() 
```

例如，如果我想调用`FunctionA`from `InstanceStyleA`，我需要这样输入：

```
InstanceStyleA().FunctionA() 
```

如果我想从 调用`FunctionA`，`InstanceStyleB`我需要这样输入：

```
InstanceStyleB.FunctionA() 
```

我需要在后面添加一组括号`InstanceStyleA`才能调用它的一个函数，否则我会收到此错误：

```
TypeError: unbound method FunctionA() must be called with InstanceStyleA instance as first argument (got nothing instead) 
```

`InstanceStyleB`同样，如果我在调用其中一个函数后尝试添加括号，我会收到此错误：

```
TypeError: 'ClassStyleB' object is not callable 
```

为什么会这样？如果它们都是类的实例，为什么它们会受到不同的对待？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-20T01:35:21.173

在您的示例代码中，您实际上有三个类和一个对象，它们的名称都令人困惑：

*   `ClassStyleA`是一个*类*，继承自`object`
*   `ClassStyleB`也是一个继承自的*类*`object`
*   `InstanceStyleA`不是*实例***_** _*[，它也是一个*类*，继承自`ClassStyleA`.]*
**   `InstanceStyleB`不是一个*类*，它是**类**的一个*实例***`ClassStyleB`***

 ***要从*类*创建*实例*，请调用该类。所以, , ,都是*实例*。也是如此- 它是一个变量，您将使用创建的实例分配给它。*`ClassStyleA()``ClassStyleB()``InstanceStyleA()`*`InstanceStyleB``ClassStyleB`**

 **由于`InstanceStyleB`(不带括号) 已经是(of ) 的*实例*`ClassStyleB`，而不是*class*，因此您不能调用它。这解释了你的**第二个** `TypeError`.

类似地，您只能在 instance 上调用*方法**（*在类中定义的函数，在您的示例中是`FunctionA`and `FunctionB`）。这解释了你的**第一个**: （同样，没有括号），是一个*class*。 ***`TypeError``InstanceStyleA`***

 ****（撇开迂腐不谈：从技术上讲，以上大部分内容完全是谎言，但为了讨论，假设 Python 在类和实例、函数和方法之间有明确的分离会更简单。）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-20T01:26:18.873

当您使用括号调用 InstanceStyleA 时，您正在创建 InstanceStyleA... 的实例，然后在该实例上调用成员函数。它基本上是以下的简写：

```
obj = InstanceStyleA()
obj.FunctionA() 
```

InstanceStyleB 不是一个类，它被设置为 ClassStyleB 的一个实例，所以当你引用它时，不需要括号（或实例化一个对象）。

就像你写的一样：

```
ClassObject = ClassStyleB()
ClassObject.FunctionA() 
```

**TypeError**是因为对象不可调用。例如：

```
d = {} #d is a dictionary
d()    #d used as a function has no meaning 
```

我希望这可以消除差异。*********

# angularjs - 如何从指令访问子 ngModel？

> ID：16115521
> 
> 赞同：8
> 
> 时间：2013-04-20T01:14:01.460
> 
> 标签：angularjs, angularjs-directive

就像在[这个问题](https://stackoverflow.com/questions/15859011/how-to-set-twitter-bootstrap-class-error-based-on-angularjs-input-class-ng-inval)中一样，我想`.error`在表单字段的父级为真`.control-group`时添加。`scope.$invalid`

但是，像 in 这样对表单名称进行硬编码`ng-class="{ error: formName.fieldModel.$invalid }"`意味着我不能在不同的表单中重用它，而且我不想到处重复这个声明。

我认为看起来像这样的指令可以工作：

```
<div class="control-group" error-on="model1, model2">
  <input ng-model="model1">
  <input ng-model="model2">
</div> 
```

因此，当任何一个`model1`或`model2`无效时，`.control-group`都会被`.error`添加。

[我在这里的尝试](http://jsfiddle.net/thatmarvin/pFV4n/3/)。给定模型名称，是否可以从指令访问模型？

如果有更好的方法，我也很想听听。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-20T07:18:11.047

I don't think that writing a custom directive is necessery for this use-case as the [`ng-form` directive](http://docs.angularjs.org/api/ng.directive%3angForm) was created exactly for situations like those. From the directive's documentation:

> It is useful to nest forms, for example if the validity of a sub-group of controls needs to be determined.

Taking your code as an example one would write:

```
<div class="control-group" ng-class="{ error: myControlGroup1.$invalid }>
  <ng-form name="myControlGroup1">
    <input ng-model="model1">
    <input ng-model="model2">
  </ng-form>
</div> 
```

By using this technique you don't need to repeat expressions used in ng-model and can reuse this fragment inside any form.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-21T02:12:04.187

您还可以更改已接受答案中的标记以不使用嵌套，因为`ng-form`它也是一个类指令：

```
<div class="control-group ng-form" name="controlGroup11" ng-class="{ error: controlGroup1.$invalid }>
  <input ng-model="model1">
  <input ng-model="model2">
</div> 
```

[最终解决方案小提琴](http://jsfiddle.net/thatmarvin/55bJS/1/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-20T02:14:39.247

在您的链接函数中，您可以访问[formController](http://docs.angularjs.org/api/ng.directive%3aform.FormController)。它具有所有控件。因此，以下内容将使您的指令访问`.$valid`：

```
el.controller('form')[attrs.errorOn].$valid 
```

但是，我不知道如何观察变化。我尝试观看`attrs.errorOn`（即观看 ng-model 属性），但除非输入有效值，否则手表不会触发（因为 Angular 表单的工作方式......除非该值有效，否则它不会分配给由 ng-model 设置的范围属性。）

[小提琴](http://jsfiddle.net/mrajcok/4PAQr/)。

也许有人可以更进一步......

# asp.net - ASP.NET Downloading files from an SQL table

> ID：16115522
> 
> 赞同：0
> 
> 时间：2013-04-20T01:14:29.330
> 
> 标签：asp.net, vb.net, gridview, download, sql-server-2012

I'm trying to download a file from an SQL Server table. I am using a GridView. Whenever I try to download a file, I get a corrupted file.

I am using ASP.NET and VB.NET with SQL Server 2012 Express.

Any ideas why ?

```
Protected Sub GridView1_SelectedIndexChanged(sender As Object, e As EventArgs) Handles GridView1.SelectedIndexChanged

    Dim ContentID = Convert.ToInt32(GridView1.SelectedRow.Cells(1).Text)
    Dim ContentName = GridView1.SelectedRow.Cells(2).Text
    Dim ContentType = GridView1.SelectedRow.Cells(3).Text

    lblContentName.Text = "[ " + ContentName + " ]"
    lblContentName.Visible = True

End Sub

Protected Sub GridView1_RowCommand(sender As Object, e As GridViewCommandEventArgs)

    Dim cn As New SqlConnection("Data Source=BRIAN-PC\SQLEXPRESS;Initial Catalog=master_db;Integrated Security=True;")

    If e.CommandName = "Download" Then
        Dim filename As String = String.Empty
        Dim id As Integer = Convert.ToInt32(e.CommandArgument)
        Dim cmd As New SqlCommand("SELECT content_name,content_type,content_data FROM content WHERE content_id = " & id, cn)
        cn.Open()
        Dim dr As SqlDataReader = cmd.ExecuteReader
        Dim bytes As Byte()
        dr = cmd.ExecuteReader()
        If dr.Read() Then
            filename = dr("content_name").ToString()
            Response.ContentType = dr("content_type").ToString()
            Response.AddHeader("Content-Disposition", "attachment;filename=" & filename)
            bytes = DirectCast(dr("content_file"), Byte())
            Response.Cache.SetCacheability(HttpCacheability.NoCache)
            Response.BinaryWrite(bytes)
            Response.Flush()
            Response.[End]()
        End If
    End If
End Sub

Private Sub BindGrid()
    Dim constr As String = ConfigurationManager.ConnectionStrings("ConnStringDb1").ConnectionString
    Using con As New SqlConnection(constr)
        Using cmd As New SqlCommand()
            cmd.CommandText = "SELECT content_id, content_name FROM content"
            cmd.Connection = con
            con.Open()
            GridView1.DataSource = cmd.ExecuteReader()
            GridView1.DataBind()
            con.Close()
        End Using
    End Using

End Sub

 Protected Sub Page_Load(sender As Object, e As EventArgs) Handles Me.Load
        If Not IsPostBack Then
            BindGrid()
        End If
    End Sub 
```

# jquery - 从 MIT jQuery 时钟中删除下拉选择器

> ID：16115524
> 
> 赞同：0
> 
> 时间：2013-04-20T01:15:00.057
> 
> 标签：jquery, clock

我在网上找到了一个 jQuery 时钟（它很棒，你应该抓住它！）但我想显示时间而不必从下拉列表中选择（参见示例：[http](http://www.robertmeans.com/clock) ://www.robertmeans.com/clock ）。我对 jQuery 一无所知。我该如何修改这个时钟，使其只显示时间而无需进行选择？我希望能够放置我想要的任何 UTC 偏移量并在那个时间打印时钟。

```
<html>
  <head>
  <script type="text/javascript" src="http://code.jquery.com/jquery-1.9.1.min.js</script>
  <script type="text/javascript" src="scripts/jclock.js"></script>
  <link rel="stylesheet" href="css/homepage.css" />
  <script type="text/javascript">
    $(document).ready(
    function() {
       $("#zones_Australia").change(function(){
       if ($('#time-cont .time').length>0){ $('#time-cont .time').remove();}
   var offset = $(this).val();    
       if (offset == '') return;       

   $('#time-cont').append('<div class="time"></div>');

       var options = {
        format:'<span class=\"dt\">%a, %d %b %H:%M:%S</span>',
        timeNotation: '12h',
        am_pm: true,
        utc:true,
        utc_offset: offset
      }

      $('#time-cont .time').jclock(options);
   });
 });
</script>

  </head>
  <body>
   <select id="zones_Australia">
    <option value="">--Select--</option>
    <option value="-7">US Pacific</option>
  </select>
  </body>
</html> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-20T01:19:34.643

I think this should work:

```
 $(document).ready(
        function() {

           if ($('#time-cont .time').length>0){ $('#time-cont .time').remove();}
//set the offset here       
var offset = -7;    
           if (offset == '') return;       

       $('#time-cont').append('<div class="time"></div>');

           var options = {
            format:'<span class=\"dt\">%a, %d %b %H:%M:%S</span>',
            timeNotation: '12h',
            am_pm: true,
            utc:true,
            utc_offset: offset
          }

          $('#time-cont .time').jclock(options);
     }); 
```

# google-app-engine - 与 KeyProperty 一对一的 NDB 建模

> ID：16115527
> 
> 赞同：0
> 
> 时间：2013-04-20T01:16:24.850
> 
> 标签：google-app-engine, database-design, app-engine-ndb

我对 ndb 很陌生，但我已经明白我需要重新连接大脑中的某个区域来创建模型。我正在尝试创建一个简单的模型——只是为了理解如何设计一个 ndb 数据库——具有一对一的关系：例如，一个用户和他的信息。经过大量搜索 - 找到了文档，但很难找到不同的示例 - 并进行了一些实验（以几种不同的方式建模和查询），这是我找到的解决方案：

```
from google.appengine.ext import ndb

class Monster(ndb.Model):
    name = ndb.StringProperty()

    @classmethod
    def get_by_name(cls, name):
        return cls.query(cls.name == name).get()

    def get_info(self):
        return Info.query(Info.monster == self.key).get()

class Info(ndb.Model):
    monster = ndb.KeyProperty(kind='Monster')
    address = ndb.StringProperty()

a = Monster(name = "Dracula")
a.put()

b = Info(monster = a.key, address = "Transilvania")
b.put()

print Monster.get_by_name("Dracula").get_info().address 
```

NDB 不接受连接，因此我们想要的“连接”必须使用类方法和属性来模拟。使用上述系统，我可以通过第一个数据库中的唯一属性（在本例中为“名称” - 假设没有两个同名的怪物）轻松访问第二个数据库（信息）中的属性。

但是，如果我想打印一个包含 100 个怪物名称和各自地址的列表，第二个数据库（信息）将被点击 100 次。

问题：有没有更好的方法对此进行建模以提高性能？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-20T11:35:30.827

如果它真的是一对一的关系，为什么要创建 2 个模型。鉴于您的示例，地址实体不能与任何怪物共享，所以为什么不将地址详细信息放入怪物中。

有一些你不这样做的原因。

1.  当您只需要几个时，地址可能会变得很大，因此检索 100 个属性的效率会降低 - 尽管项目查询可能会有所帮助。

2.  您改变主意并希望查看所有生活在特兰西瓦尼亚的怪物——在这种情况下，您将创建地址实体，而怪物将拥有指向该地址的关键属性。当您确定某些怪物可以生活在多个地方时，这显然会失败（狼人 - 伦敦，特兰西瓦尼亚，纽约；-），在这种情况下，您要么在怪物中有重复的 KeyProperty，要么有一个指向怪物的中间实体，并且地址。在您的情况下，我认为怪物总体上没有那么多记录在案的地址；-)

此外，如果您通过名称唯一标识怪物，则应考虑将名称存储为密钥的一部分。执行 Monster.get_by_id("dracula") 比按名称查询要快。

正如我在评论中写的（糟糕）。如果上述 1\. 成立并且这是真正的一对一关系。然后，我会在创建地址时将地址创建为子实体（Monster 是键中的父/祖先）。这使您可以，

1.  允许其他实体指向地址，
2.  如果您创建了一堆子实体，请使用单个祖先查询获取它们）。3 如果你有怪物并且它再次拥有实体，那就是祖先查询。
3.  If you have a bunch of entities that should only exist if Monster instance exists and they are not children, then you have to do querys on all the entity types with KeyProperty's matching the key, and if theses entities are not PolyModels, then you have to perform a query for each entity type (and know you need to perform the query on a given entity, which involves a registry of some type, or hard coding things)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-20T14:51:48.860

我怀疑您可能正在尝试的内容可以通过使用下面链接中描述的元素来实现查看“多个键或实体上的操作”“扩展模型”“模型挂钩”

[https://developers.google.com/appengine/docs/python/ndb/entities](https://developers.google.com/appengine/docs/python/ndb/entities)

（这可能更像是评论而不是答案）

# linq - LINQ ToList() 使所有记录成为协程的最后一条

> ID：16115532
> 
> 赞同：0
> 
> 时间：2013-04-20T01:18:33.127
> 
> 标签：linq, coroutine

我似乎有一个误解，因为如果我不附加 ToList() 命令，以下代码可以正常工作：

```
IEnumerable<ProcessorInfo> query = (
        from n in InfoGet(EMachineInfoDepth.LogicalProcessor)
        select n
    )
    .ToList(); 
```

InfoGet 看起来像这样：

```
internal static IEnumerable<ProcessorInfo> InfoGet(EMachineInfoDepth depth)
{
    ProcessorInfo result = new ProcessorInfo();

    // loop through all workgroups
    foreach (Workgroup wg in workgroups_S)
    {
        result.Workgroup = wg;

        if (depth >= EMachineInfoDepth.NUMANode)
        {
            // loop through all NUMANodes
            foreach (NUMANode node in wg.NUMANodes)
            {
                result.NUMANode = node;

                if (depth >= EMachineInfoDepth.CPU)
                {
                    // loop through all CPUs
                    foreach (CPU cpu in node.CPUs)
                    {
                        result.CPU = cpu;

                        if (depth >= EMachineInfoDepth.Core)
                        {
                            // loop through all Cores
                            foreach (Core core in cpu.Cores)
                            {
                                result.Core = core;

                                if (depth >= EMachineInfoDepth.LogicalProcessor)
                                {
                                    // loop through all LogicalProcessors
                                    foreach (LogicalProcessor lp in core.LogicalProcessors)
                                    {
                                        result.LogicalProc = lp;

                                        yield return result;
                                    }
                                }
                                else
                                {
                                    yield return result;
                                }
                            }
                        }
                        else
                        {
                            yield return result;
                        }
                    }
                }
                else
                {
                    yield return result;
                }
            }
        }
        else
        {
            yield return result;
        }
    }
} 
```

使用 ToList() 我得到了正确的计数，但所有记录都等于序列中的最后一个元素。虽然我知道这可能是我的复杂协程中的变量范围错误，因为在所有迭代中都看到了最终值，但为什么代码在没有 ToList() 的情况下工作？

我的问题是：我误解了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-20T07:16:09.433

Problem is, you're returning reference to the same variable all the time:

```
ProcessorInfo result = new ProcessorInfo(); 
```

That's the only place you're actually creating new `ProcessorInfo` object. You only change it's properties values later, but return still the same object.

You should consider adding [copy constructor](http://msdn.microsoft.com/en-us/library/ms173116%28v=vs.110%29.aspx) into your `ProcessorInfo()` class, and replace every `yield return result;` call with `yield return new ProcessorInfo(result);`. That would be the easiest way to make it work.

***Update***

It could *look* like it works e.g. when you've saved some variable state somewhere during loop:

```
foreach(var item in query)
{
    itemsList.Add(item);
    propertyList.Add(item.IntProperty);
} 
```

After that call `itemsList` will contain *incorrect* data, while `propertyList` will be just fine.

# c - 代码正在覆盖数组

> ID：16115535
> 
> 赞同：-1
> 
> 时间：2013-04-20T01:19:02.013
> 
> 标签：c

这些代码示例有问题吗？每当现场出现 X 时，如果可以获胜，它仍然会覆盖现场的 O。显然 if not 语句不起作用？88 和 79 是 ASCII 中的“X”和“O”。

```
while(i+j<6)
    {
        if (board[i][j]+board[i][j+1] == compXO*2)
        {
            if(board[i][j+2] != (88||79)) 
            {
            board[i][j+2] = compXO;
            won=1;
            break;
            }
        }
        else 
            i++;
    }

if (board[i+1][j+1]+board[i+2][j+2] == compXO*2)
    {   
        if(board[i][j] != (88||79)) 
        {
        board[i][j] = compXO;
        won=1;

        }
    } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-20T01:27:14.550

您不能一次比较两个不同的值，因为表达式`88||79`是逻辑的或，并且计算结果为`1`，适当的方法是：

```
if(!(board[i][j] == 88 || board[i][j] == 79)) 
```

或者

```
if(board[i][j] != 88 && board[i][j] != 79) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-20T01:21:06.730

This `if` statement is not doing what you think it is:

```
if(board[i][j+2] != (88||79)) 
```

It should be:

```
if (board[i][j+2] != 88 && board[i][j+2] != 79) 
```

`88||79` is doing a logical or of the values `79` and `88` which will always be `true` which will be equal to `1`, so you are comparing the board element to `1` each time.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-20T01:27:39.540

`88||79`等价于 1。所以，你`if (board[i][j+2] != (88||79))`真的等价于`if (board[i][j+2] != 1)`。

你可能想要的是：

```
if (board[i][j+2] != 88 && board[i][j+2] != 79)) 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-04-20T01:27:53.220

表达方式

```
if (board[i][j+2] != (88||79)) 
```

与 1比较`board[i][j+2]`，因为`(88 || 79)`计算结果为真，即 1。

也许你追求的是：

```
if (board[i][j+2] != 88 && board[i][j+2] != 79) 
```

如果您为那些原本不明显的数字（或使用过的数字）命名会更好`'X'`-`'O'`使用字符符号绝对不会提高效率（或损失），但在清晰度上有很大的提高。

```
if (board[i][j+2] != 'X' && board[i][j+2] != 'O') 
```

如果您有一个用于表示“既不存在 X 也不存在 O”的字符，它可能是`' '`或其他值（0？），那么您可以将测试简化为：

```
#define EMPTY ' '

if (board[i][j+2] == EMPTY) 
```

这似乎是您正在测试的内容。如果您不确定您的棋盘是否准确，您应该编写一个验证函数来检查每个方格是否具有有效值（`'X'`或`'O'`或`EMPTY`）以及是否有太多`'X'`的 s 或`'O'`s。在您担心它可能已更改或无效的任何时候调用它。

# ruby - 如何在 Ruby 中使用 RSpec 模拟 Pusher？

> ID：16115536
> 
> 赞同：3
> 
> 时间：2013-04-20T01:19:20.340
> 
> 标签：ruby, rspec, mocking, pusher

目前使用 Pusher 和 RSpec。

```
Pusher.should_receive( :trigger ).with( 'message', { :data => '12345' }) 
```

这会起作用，除了电话是`Pusher[ 'channel-id' ].trigger...`

如何用 RSpec 模拟这个？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-04-20T05:03:11.733

Well`[]`是一个函数名，所以它可以被存根。在您看到的 Pusher 源代码`def_delegators :default_client, :webhook, :channel, :[]` 中：所以所有这些方法都被转发到`default_client`. 所以这实际上是一个方法链。

我会像这样做你想做的事。

```
 mock_client = mock('client')
 Pusher.stub(:[]).with('channel-id').and_return(mock_client)
 mock_client.should_receive( :trigger ).with( 'message', { :data => '12345' }) 
```

我现在手头没有 rspec，但看不出它为什么不起作用。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2014-06-15T10:12:03.880

较新版本的 Pusher 支持更容易存根的更浅的 API：

```
expect(Pusher).to receive(:trigger).with("channel-id", "message", { data: "12345" })

Pusher.trigger("channel-id", "message", { data: "12345" }) 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2014-06-15T14:39:48.427

还有一个[pusher-fake](https://github.com/tristandunn/pusher-fake/tree/master/lib/pusher-fake)可以为你的测试启动一个假服务器，所以你不必存根——它让你的应用程序可以通过那个假服务器发送和接收。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-21T22:47:00.813

Michael Papile 的回答基本上是正确的。这是我使用的代码：

```
Pusher.stub_chain( :[] , :trigger )
Pusher[ channel_id ].should_receive( :trigger ).with( 'message',  { :data => '12345' }) 
```

实际上，事实证明这段代码不起作用，因为它不匹配`channel_id`。

# html - 如何使用 CSS 创建交互式循环链接

> ID：16115539
> 
> 赞同：2
> 
> 时间：2013-04-20T01:19:36.363
> 
> 标签：html, css

我希望做类似的事情， [http](http://timheuer.com/blog/archives.aspx) ://timheuer.com/blog/archives.aspx 我需要使用 CSS 创建一个交互式循环链接。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-20T13:15:02.510

有多种方法可以达到这种效果。有问题的页面看起来只是使用 css 样式的图像背景。最简单的例子是；

# 1 图像背景

```
#link1 {
    background-image: url('/images/button1-trans.png')
}

#link2 {
    background-image: url('/images/button2-trans.png')
}

#link1:hover {
    background-image: url('/images/button1.png')
}

#link2:hover {
    background-image: url('/images/button2.png')
} 
```

# 1b 图像精灵

使用多个图像需要多个浏览器请求，因此“图像分割”是当今常用的一种技术，用于将下载优化为单个请求，然后将其缓存，从而产生单个 304 响应。在蒂姆的情况下，他的样子是这样的（虽然原件是透明的）；

[![在此处输入图像描述](https://i.stack.imgur.com/ZspkT.png)](http://timheuer.com/blog/Skins/2012/img/navbarglyphs.png)

然后，您对每个链接使用相同的图像以及剪辑和偏移来定位图像的适当部分；

```
#links a {
    background-image:url('/images/allButtons.png')
    background-position: 0px 0px; /* sets the row for all normal links */
    width: 64px;
    height: 64px; /* bounding box for the image */
}

#links #link1 {
    background-position: 0px 0px; /* first icon on the first row */
}
#links #link2 {
    background-position: -64px 0px; /* slides the image strip left to locate the second icon on the first row */
}
#links #link1:hover {
    background-position: 0px -64px; /* first icon on the second row */
}
#links #link2:hover{
    background-position: -64px -64px; /* second image, second row */
} 
```

注意中的背景图像`#links a`？好吧，在这种情况下这实际上是多余的，但如果你能做到这一点会很好，然后你只需要`background-position-x`在每个图标中使用，你只需要一个`#links a:hover`可以设置公共行的图标，`background-position-y:-64px`但 FireFox 团队使用他们通常的迂腐标准的“计算机说不”方法决定不支持 background-position-x 或 y，即使所有其他浏览器都支持并且它是常用的。让想要以这种方式使用它的每个人都非常懊恼。

但是，请放大您链接到的博客上的这些按钮。看看它们看起来都像素化了吗？

![在此处输入图像描述](https://i.stack.imgur.com/U6sVY.png)

# 2 纯 CSS

您至少可以使用 CSS 的组合来实现圆圈`border-style`，`border-width`并且`border-radius`正如其他人所发布的那样，但您仍然需要中心按钮的图像。

# 3 图标字体

# ☺☻☼☽☾☿

这是最现代的，也是我最喜欢的方法，因为它是完全可扩展的、透明的、非常非常小的和超快的。您当然需要下载字体，但 SVG 的压缩效果非常好。它只是 HTML 中的文本，根本没有图像。也没有疯狂的 CSS 样式。结帐[IcoMoon](http://icomoon.io/app/)！看看你怎么能一直放大这些？

放大上面的图标，这是一个[小提琴](http://jsfiddle.net/YJxNk/3/)

您可以免费使用 icoMoon，但我已经购买了专业包，它的价格公道而且物有所值。这是一个很棒的网站，因为您甚至可以加载自己的 SVG 图标，它会为您生成自己的字体。甚至还有 IE6 支持。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-20T07:36:08.237

**解释**

您向我们展示的页面使用带有所有菜单项图标的图像精灵，带有边框的事件。我的示例展示了如何使用简单的 css 来做到这一点。您也可以使用图像精灵，但只包括图标。

**HTML 代码：**

```
<ul>
    <li><a href="#"><span>Home</span></a></li>
    <li><a href="#"><span>Blog</span></a></li>
    <li><a href="#"><span>Contact</span></a></li>
    <li><a href="#"><span>About</span></a></li>
    <li><a href="#"><span>Projects</span></a></li>
</ul> 
```

**CSS 代码**

```
html, body {
    background: #369BD7;
    font-family: tahoma;
    font-size: 12px;
}

a {
    color: #fff;
}

ul {
    clear:both;
    margin: 0; 
    padding: 0;
}

ul li {
    display:block;
    position: relative;
    float: left;
    height: 80px;
    width: 80px;
    padding: 0;
    margin-left: 10px;
    list-style: none;
    text-align: center;
    white-space: nowrap;
}

ul li:first-child {
    margin: 0;
}

ul li a {
    display:block;
    margin: 10px auto;
    height: 40px;
    width: 40px;
    border-radius: 100%;
   -webkit-border-radius: 100%; 
   -moz-border-radius: 100%;  
    border: 4px solid #fff;
    -webkit-transition: all 0.3s ease-in-out;
    -moz-transition: all 0.3s ease-in-out;
    -o-transition: all 0.3s ease-in-out;
    -ms-transition: all 0.3s ease-in-out;   
    transition: all 0.3s ease-in-out;
    background: transparent url('http://cdn1.iconfinder.com/data/icons/TWG_Retina_Icons/24/home.png') no-repeat 50% 50%;
}

ul li a:hover {
    background-color: #fff;
} 

ul li a span {
    display: block;
    position: absolute;
    bottom: 0;
    left:0;
    width: 100%;
    text-align: center;
    z-index: 1;
} 
```

**边界半径浏览器支持**

[http://caniuse.com/#search=border-radius](http://caniuse.com/#search=border-radius)

**演示**

[http://jsfiddle.net/bartekbielawa/fgPf8/6/](http://jsfiddle.net/bartekbielawa/fgPf8/6/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-20T02:22:14.327

诀窍是拥有and的`border-radius`一半。然后只需使用 gif 或 png 作为 IE 后备。`height``width`

```
.round-button {
  width:100px;
  height:100px;
  border-radius:50px; /* be sure to add all the browser prefix versions */
} 
```

# javascript - 给出元素 id 编号，然后在末尾插入一个

> ID：16115540
> 
> 赞同：3
> 
> 时间：2013-04-20T01:19:44.290
> 
> 标签：javascript, jquery, html

我有一个一直在变化的 div 数量，我需要一个特定的 div 在最后....我想以某种方式使用 javascript 或 jquery 计算 div 的数量，并在最后插入一个特定的 div。 .. 例如

```
<div class="message" id="1">

<div class="message" id="2">....

<div class="message" id="88"> 
```

然后我需要最终的 div 编号并向其添加一个，以便在最后插入

```
<div class="message" id="89"> 
```

这将如何实现？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-20T01:23:36.517

```
var lastID = $('div.message').last().attr('id');
$('div.message').last().parent().append('<div class="message" id="' + lastID + 1 + '">'); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-20T01:31:20.783

```
var newId = parseInt($(".message").last().attr('id')) + 1;
$(".message").last().after($("<div></div>").attr({'id' : newId, 'class' : 'message'})); 
```

使用这些行，您将创建一个新的 div，其 'max id' 递增 1

PS div 插入的位置无关紧要，新消息将在最后一条消息之后每次插入

# asp.net-mvc - MVC Razor 文件中的 InsufficientExecutionStackException

> ID：16115542
> 
> 赞同：2
> 
> 时间：2013-04-20T01:20:08.227
> 
> 标签：asp.net-mvc, razor

所以我正在尝试使用 asp net mvc 4.5，并且我正在我的登录剃刀视图中工作。此页面与其他页面不同，所以我在顶部

```
@model HSServer.Models.LoginModel

@{
    ViewBag.Title = "Log in";
    Layout = null;
} 
```

with`Layout = null;`以便它不使用母版页。

我尝试运行该应用程序，它在线上抛出一个 InsufficentExecutionStackException`Layout = null;`并说

```
Insufficient stack to continue executing the program safely. This can happen from
having too many functions on the call stack or function on the stack using too
much stack space. 
```

谁能告诉我这是怎么回事！

**编辑**

似乎它与`Layout = null`as 删除无关，这没有帮助，只是将错误向上移动了一行。还在挖。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-20T01:27:36.413

知道了。我在不知不觉中复制[了它。](https://stackoverflow.com/questions/9196610/simple-mvc-razor-rendering-view-issue?rq=1)

在我呼唤的身体里，`@Html.Action("Login")`而不是`@Url.Action("Login")`像我本意的那样。该页面递归地调用自己，而不是简单地给我一个网址......哎呀。

# java - Viewpager setCurrentItem() doesn't update onPageSelected()

> ID：16115545
> 
> 赞同：0
> 
> 时间：2013-04-20T01:20:35.803
> 
> 标签：java, android, android-viewpager

When I swipe between questions, it loads current page number correctly

BUT when I use next button, first click doesnt loads pagenumber ( I mean `onPageSelected()` doesnt work.) second and other clicks loads content but it loads 1 page previous.

```
@Override
protected void onCreate(final Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);

    this.setContentView(R.layout.activity_main);

    mPager = (ViewPager)findViewById(R.id.pager);
    QuestionPagerAdapter mAdapter = new QuestionPagerAdapter();

    mPager.setAdapter(mAdapter);

    OnPageChangeListener pageChangeListener = new OnPageChangeListener() {

        @Override
        public void onPageScrollStateChanged(int arg0) { }

        @Override
        public void onPageScrolled(int arg0, float arg1, int arg2) { }

        @Override
        public void onPageSelected(int position) {
            tv.setText( mPager.getCurrentItem()+"");
        }

    };

    mPager.setOnPageChangeListener(pageChangeListener);

    Question.next.setOnClickListener(new OnClickListener() {

        @Override
        public void onClick(View view) {

        mPager.setCurrentItem(getItem(+1));
        }
    }

    private int getItem(int i) {
        int a = mPager.getCurrentItem();
        i += a;
        return i;
    }
}); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-20T02:54:21.470

为什么不在你的听众中这样做：

mPager.setCurrentItem(mPager.getCurrentItem() + 1);

# c# - EntityFramework 6 连接已关闭

> ID：16115554
> 
> 赞同：3
> 
> 时间：2013-04-20T01:22:04.153
> 
> 标签：c#, sql-server, entity-framework, database-connection

我确实升级到了 EF 6，当我执行此查询时显示此错误：

> ExecuteReader 需要一个打开且可用的连接。连接的当前状态为关闭。

代码：

```
var db = new Entity2Entities();
db.Configuration.LazyLoadingEnabled = true;

var ids = db.PersonBase.SqlQuery(Utils.Query(param, "PersonBase"))
                       .Select(x => x.Id);
var result = db.Employee.Where(x => ids.Contains(x.Id)); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-20T10:48:09.500

EF 6 处于 alpha 状态，未来可能会发生变化。我没有尝试过，但也许你必须这样做

```
db.Database.Connection.Open(); 
```

在执行 SqlQuery 方法之前。

# java - convert ByteArrayInputStream image sequence into a video clip

> ID：16115555
> 
> 赞同：2
> 
> 时间：2013-04-20T01:22:04.837
> 
> 标签：java, android, udp

iam using UDP connection ,i have an android application which send video to pc which runs a java application. the java application runs on pc recieve packets send by android application as ByteArrayInputStream(imageData) ,now i need to convert these images to a video clip how can i do that, following is my code java application pc code..

```
import java.io.ByteArrayInputStream;
import java.io.IOException;
import java.lang.Runnable;
import java.lang.Thread;
import java.net.DatagramPacket;
import java.net.DatagramSocket;
import java.net.InetAddress;

public class cam_thread_UDP implements Runnable
{
    int nb = 0;
    CAR_GUI car_state;
    Thread t;

    public static int HEADER_SIZE = 5;
    public static int DATAGRAM_MAX_SIZE = 1450;
    public static int DATA_MAX_SIZE = DATAGRAM_MAX_SIZE - HEADER_SIZE;

    public cam_thread_UDP(CAR_GUI gui) 
    {
        car_state = gui;
        try 
        {
            t = new Thread(this);
            t.start();
        } 
        catch (Exception e){e.printStackTrace();}
    }

    public void run() 
    {
        System.out.println("Cam thread waiting...");

        handleConnection_UDP();
    }

    public void handleConnection_UDP() 
    {
        int current_frame = -1;
        int slicesStored = 0;
        byte[] imageData = null;
        DatagramSocket socket=null;

        try 
        {                   
            InetAddress serverAddr = InetAddress.getLocalHost();
            System.out.println("PC IP address: " + serverAddr.getHostAddress());
            socket = new DatagramSocket(9000, serverAddr);
            byte[] buffer = new byte[DATAGRAM_MAX_SIZE];
            DatagramPacket packet = new DatagramPacket(buffer, buffer.length);

            while (true) 
            {               
                socket.receive(packet);             
                byte[] data = packet.getData();         
                int frame_nb = (int)data[0];
                int nb_packets = (int)data[1];
                int packet_nb = (int)data[2];
                int size_packet = (int) ((data[3] & 0xff) << 8 | (data[4] & 0xff)); 

                if((packet_nb==0) && (current_frame != frame_nb))
                {
                    current_frame = frame_nb;
                    slicesStored = 0;               
                    imageData = new byte[nb_packets * DATA_MAX_SIZE];
                }

                if(frame_nb == current_frame)
                {
                        System.arraycopy(data, HEADER_SIZE, imageData, packet_nb * DATA_MAX_SIZE, size_packet);
                        slicesStored++;             
                }

                /* If image is complete display it */
                if (slicesStored == nb_packets) 
                {                   
                    ByteArrayInputStream bis = new ByteArrayInputStream(imageData);
                    car_state.set_image(bis);
                }
            }
        } catch (IOException e) 
        {
            e.printStackTrace();
            socket.close();
        } 
    }
} 
```

# javascript - 在 MongoDb 中使用 mapReduce 获取文档（行）的计数

> ID：16115557
> 
> 赞同：0
> 
> 时间：2013-04-20T01:22:43.640
> 
> 标签：javascript, mongodb, count, mapreduce, database

我讨厌重新发布这些东西，但我觉得我输入的语法与我查找的大多数问题完全相同。我试图简单地计算价格大于 9000 的行数。有人可以告诉我我做错了什么吗？

```
var map1 = function(){
    if(this.price > 9000) {
        emit(this._id, {count: 1});
    }
};

var red1 = function(keyId, values){
    var count = 0;
    values.forEach(function(v) {
            count +=v['count'];
            });

    return{count: count};
}

db.plots.mapReduce(map1, red1, {out: "query1"}) 
```

我的结果是这样的......

```
> db.query1.find()
{ "_id" : ObjectId("5170609afa9e8646fc906815"), "value" : { "count" : 1 } }
{ "_id" : ObjectId("5170609afa9e8646fc906816"), "value" : { "count" : 1 } }
{ "_id" : ObjectId("5170609afa9e8646fc90681c"), "value" : { "count" : 1 } }
{ "_id" : ObjectId("5170609afa9e8646fc906834"), "value" : { "count" : 1 } }
{ "_id" : ObjectId("5170609afa9e8646fc90683e"), "value" : { "count" : 1 } }
{ "_id" : ObjectId("5170609afa9e8646fc906846"), "value" : { "count" : 1 } }
{ "_id" : ObjectId("5170609afa9e8646fc90684b"), "value" : { "count" : 1 } }
{ "_id" : ObjectId("5170609afa9e8646fc90684e"), "value" : { "count" : 1 } }
{ "_id" : ObjectId("5170609afa9e8646fc906851"), "value" : { "count" : 1 } }
{ "_id" : ObjectId("5170609afa9e8646fc90685a"), "value" : { "count" : 1 } }
{ "_id" : ObjectId("5170609afa9e8646fc906861"), "value" : { "count" : 1 } }
{ "_id" : ObjectId("5170609afa9e8646fc906864"), "value" : { "count" : 1 } }
{ "_id" : ObjectId("5170609afa9e8646fc906879"), "value" : { "count" : 1 } }
{ "_id" : ObjectId("5170609afa9e8646fc906882"), "value" : { "count" : 1 } }
{ "_id" : ObjectId("5170609afa9e8646fc906883"), "value" : { "count" : 1 } }
{ "_id" : ObjectId("5170609afa9e8646fc90688b"), "value" : { "count" : 1 } }
{ "_id" : ObjectId("5170609afa9e8646fc90688c"), "value" : { "count" : 1 } }
{ "_id" : ObjectId("5170609afa9e8646fc906891"), "value" : { "count" : 1 } }
{ "_id" : ObjectId("5170609afa9e8646fc906894"), "value" : { "count" : 1 } }
{ "_id" : ObjectId("5170609afa9e8646fc90689a"), "value" : { "count" : 1 } } 
```

我想要的是只取回一个号码。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-20T03:20:30.890

您做错了几件事-您为每个文档发出一个唯一键：由于 reduce 将所有文档与相同的键组合在一起，您没有得到聚合，因此您还将每个值与 9000 进行比较，而不是使用查询选项来映射/减少。

我不确定您为什么使用 map/reduce - 这对于聚合框架非常简单：

```
db.plots.aggregate([ {$match:{price:{$gt:9000}}}, 
                     {$group:{_id:null,count:{$sum:1}}}
] ); 
```

如果您有某些理由使用 map reduce 执行此操作，我建议您执行以下操作：

```
map = function() { emit(1, 1); }
reduce = function( key, values ) {
    var count = 0;
    values.forEach(function(v) {
            count +=v;
    });

    return count;
}

db.plots.mapReduce(map, reduce, {out: "query1", query:{price:{$gt:9000}}}); 
```

# ruby-on-rails - 我如何在部署之前向用户发送消息？

> ID：16115562
> 
> 赞同：0
> 
> 时间：2013-04-20T01:23:37.193
> 
> 标签：ruby-on-rails, capistrano

使用 capistrano 进行部署，是否可以在部署开始时或之前向用户发送消息，以便他们知道站点会在几分钟内缓慢且无响应？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-20T02:12:48.457

您可以使用 Capistrano 挂钩来执行 Rails 运行程序，它可以挂钩到您的应用程序并全局显示一条消息。

您需要将全局消息逻辑编码到您的应用程序中，然后`rails runner`在 Capistrano 中的适当挂钩点通过命令访问它。

# parsing - 解析 IMAP 消息并提取头信息

> ID：16115564
> 
> 赞同：-2
> 
> 时间：2013-04-20T01:23:44.517
> 
> 标签：parsing, c#-4.0, imap

我正在尝试从电子邮件中提取标题和正文信息，以下代码以原始形式检索标题和正文。我有一个包含字段`from`、`subject`、`date`和的电子邮件对象`body`。我想从电子邮件中提取这些值并将它们分配给电子邮件对象。我该如何解决？我尝试了几种方法，例如获取标题信息并使用 a`streamReader.ReadLine()`来获取一条线，但我得到了`illegal path exceptions`. 我知道我可以使用库，但我需要以这种方式实现它。

我的意思是，IMAP 命令返回标头信息。我想提取`subject`值、`date`值、`sender`e-amil 等并将它们分配给我的电子邮件对象对应的值，例如

```
emailObject.subject = "subjectValue"

public class Imap
{

    static void Main(string[] args)
    {
        try
        {
            path = Environment.CurrentDirectory + "\\emailresponse.txt";

            if (System.IO.File.Exists(path))
                System.IO.File.Delete(path);

            sw = new System.IO.StreamWriter(System.IO.File.Create(path));

            tcpc = new System.Net.Sockets.TcpClient("imap.gmail.com", 993);

            ssl = new System.Net.Security.SslStream(tcpc.GetStream());
            ssl.AuthenticateAsClient("imap.gmail.com");
            receiveResponse("");

            Console.WriteLine("username : ");
            username = Console.ReadLine();

            Console.WriteLine("password : ");
            password = Console.ReadLine();
            receiveResponse("$ LOGIN " + username + " " + password + "  \r\n");
            Console.Clear();

            receiveResponse("$ LIST " + "\"\"" + " \"*\"" + "\r\n");

            receiveResponse("$ SELECT INBOX\r\n");

            receiveResponse("$ STATUS INBOX (MESSAGES)\r\n");

            Console.WriteLine("enter the email number to fetch :");
            int number = int.Parse(Console.ReadLine());

            Console.WriteLine("*************Header************");
            Console.WriteLine("");
           // receiveResponse("$ FETCH " + number + " body[header]\r\n");
           // BODY.PEEK[HEADER.FIELDS (SUBJECT)]

         //   StringBuilder sb = receiveResponse("$ FETCH " + number + " BODY.PEEK[HEADER.FIELDS (From Subject Date)]\r\n");
          StringBuilder sb= receiveResponse("$ FETCH " + number + " body.peek[header]\r\n");

             Console.WriteLine(sb);

            Console.WriteLine("");
            Console.WriteLine("Body");
            sb = new StringBuilder();
            sb=receiveResponse("$ FETCH " + number + " body[text]\r\n");

            System.Text.ASCIIEncoding enc = new System.Text.ASCIIEncoding();
            byte[] serverbuff = new Byte[1024];
            int count = 0;
            string retval = enc.GetString(serverbuff, 0, count);

            Console.WriteLine(sb.ToString());

            receiveResponse("$ LOGOUT\r\n");
        }
        catch (Exception ex)
        {
            Console.WriteLine("error: " + ex.Message);
        }
        finally
        {
            if (sw != null)
            {
                sw.Close();
                sw.Dispose();
            }
            if (ssl != null)
            {
                ssl.Close();
                ssl.Dispose();
            }
            if (tcpc != null)
            {
                tcpc.Close();
            }
        }

        Console.ReadKey();
    }
    static StringBuilder receiveResponse(string command)
    {
        sb = new StringBuilder();
        try
        {
            if (command != "")
            {
                if (tcpc.Connected)
                {
                    dummy = Encoding.ASCII.GetBytes(command);
                    ssl.Write(dummy, 0, dummy.Length);
                }
                else
                {
                    throw new ApplicationException("TCP CONNECTION DISCONNECTED");
                }
            }
            ssl.Flush();

            buffer = new byte[2048];
            bytes = ssl.Read(buffer, 0, 2048);
            sb.Append(Encoding.ASCII.GetString(buffer));

          //  Console.WriteLine(sb.ToString());
            sw.WriteLine(sb.ToString());
           // sb = new StringBuilder();

            return sb;

        }
        catch (Exception ex)
        {
            throw new ApplicationException(ex.Message);
        }
    } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-22T15:39:40.573

您说您不想使用 IMAP 库。这意味着您将必须实现自己的。您应该从阅读[RFC 3501](https://www.rfc-editor.org/rfc/rfc3501)开始，因为如果不仔细阅读文档，您就不可能获得正确的协议。特别是，您正在`STATUS`对当前选定的邮箱发出命令，这是协议规范明确禁止的。其余代码支持您尚未阅读 RFC 的假设。

# scheme - 这个 Scheme 程序的错误在哪里？

> ID：16115567
> 
> 赞同：0
> 
> 时间：2013-04-20T01:23:59.443
> 
> 标签：scheme

我收到“错误：无效的 lambda：(lambda (insert-all))。”

```
(define permutations
 (lambda (L)
  (let
   ((insert-all
    (lambda (e Ls)
     (let
     ((insert-one
      (lambda (L)
       (letrec
        ((helper
         (lambda(L R)
         (if (null? R)
          (list (append L(list e)R))
          (helper (append L (list (car R) ) ) (cdr R) )
          ))))
          (helper '() L)))))
          (apply append(map insert-one Ls)))))))

  (cond ((null? L) '() )
  ((null?(cdr L)) (list L))
  (else (insert-all (car L) (permutations ((cdr L)))))))) 
```

它应该返回给定列表的所有排列。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-20T05:57:13.417

您在无效方案中提供的表格。具体来说，您的最高级别`let`表单没有主体。您可能认为该`cond`子句是主体，但由于您的括号，它不是`let`. 老实说，这是您格式的错误。这是一个“正确”格式的方案表单：

```
(define (permutations L)
  (let ((insert-all
         (lambda (e Ls)
           (let ((insert-one
                  (lambda (L)
                    (let helper ((L '()) (R L))
                      (if (null? R)
                          (list (append L (list e) R))
                          (helper (append L (list (car R)))
                                  (cdr R)))))))
             (apply append (map insert-one Ls))))))

    (cond ((null? L)       '())
          ((null? (cdr L)) (list L))
          (else (insert-all (car L)
                            (permutations (cdr L))))))) 
```

至少它可以编译并运行，尽管它不会产生正确的答案（尽管我不知道它的正确输入是什么）：

```
> (permutations '(a b c))
((c b a))
> (permutations '((a b) (1 2)))
(((1 2) (a b))) 
```

这是一个有效的实现：

```
(define (permutations L)
  (define (insert-all e Ls)
    (apply append 
           (map (lambda (e) 
                  (map (lambda (x) (cons e x)) Ls))
                e)))
  (cond ((null? L)       '())
        ((null? (cdr L)) (map list (car L)))
        (else (insert-all (car L)
                          (permutations (cdr L))))))

> (permutations '((a b) (1 2) (x y)))
((a 1 x) (a 1 y) (a 2 x) (a 2 y) (b 1 x) (b 1 y) (b 2 x) (b 2 y)) 
```

您的代码的基本结构很好；只是你的执行`insert-one`和`helper`缺乏。

# javascript - 资产管道中的需求顺序，重要吗？

> ID：16115573
> 
> 赞同：0
> 
> 时间：2013-04-20T01:24:31.660
> 
> 标签：javascript, ruby-on-rails, ruby-on-rails-3, asset-pipeline

在我的 javascript`application.js`文件中，我有以下内容

```
//= require search
//= require tutorial
//= require_self
//= require_tree .//message 
```

`//= require_tree .//stock`我放后有问题`require_self`吗？看起来一切正常，但我不确定将树放在自己之后的含义。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-20T02:21:49.687

所做的只是更改 application.js 中包含的 javascript（如果有）与其余资产连接的顺序。如果 application.js 中有`search`or中需要的任何代码`tutorial`，则它将无法正常工作。

[您可以在RailsGuides](http://guides.rubyonrails.org/asset_pipeline.html#manifest-files-and-directives)中阅读有关指令的更多信息。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-20T15:03:19.743

是的，顺序很重要，这就是为什么 jquery 总是在最前面的原因，如果你有任何依赖它的 js，它就不会工作

# css - 媒体查询：为 iPhone 屏幕设置 padding-top

> ID：16115576
> 
> 赞同：0
> 
> 时间：2013-04-20T01:25:52.670
> 
> 标签：css, media-queries

**普通 CSS：**

```
.container-step1 {
  text-align: center;
  margin: 0 auto;
  padding-top: 12%;
  width: 50em !important;/*60em*/
  height: 35em;
} 
```

对于手机我想更新`padding-top:25%;`。我试过了：

```
@media only screen and (max-device-width: 480px) {
  .container-step1 {
  text-align: center;
  margin: 0 auto;
  padding-top: 25%;
  width: 50em !important;/*60em*/
  height: 35em;
}
} 
```

它没有用。Safari 仍然指的是普通的 css。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-20T02:19:43.300

`max-device-width`VS `max-width`。`max-width`将在桌面和移动设备上运行，并且`max-device-width`只能在移动设备上运行。

此外，您只需要添加在查询中更新的 css。您可以删除所有多余的 css。

```
.container-step1 {
  text-align: center;
  margin: 0 auto;
  padding-top: 12%;
  width: 50em !important;/*60em*/
  height: 35em;
}

@media only screen and (max-device-width: 480px) {
  .container-step1 {
    padding-top: 25%;
  }
} 
```

# jquery - 使用 jQuery 覆盖 CSS 属性

> ID：16115580
> 
> 赞同：1
> 
> 时间：2013-04-20T01:26:14.153
> 
> 标签：jquery, css

假设我在链接样式表中有以下 CSS：

```
td {background: -moz-linear-gradient(top,  #fbfbfb,  #fafafa);} 
```

这使我所有的表格列都变成绿色。

假设我有下表行：

```
<tr id="myRow"><td>stuff</td><td>more stuff</td></tr> 
```

整行是绿色的，但在用户输入之后，我想要执行以下操作：

```
$("#myRow").children('td').css('backgroundColor', 'red'); 
```

为什么这不会把我的行从绿色变成红色，我怎样才能在不添加`!important`到我的样式表的情况下使它工作？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-20T01:28:07.587

你可以试试：

```
$("#myRow").children('td').css('background-color', 'red'); 
```

或者

```
$("#myRow").children('td').css('background', 'red'); 
```

还有一些奇怪的事情来检查上述是否行不通：

*   你在哪里调用你的 jQuery 代码？（它在某些功能中，`$(document).ready()`..？）
*   你那里有内联`style`属性吗？
*   你有任何由以前的代码引起的错误吗？（请参阅调试器 - FireBug 的内置 Chrome 开发工具）

# java - Java 处理多种可能未知的日期/时间格式

> ID：16115584
> 
> 赞同：0
> 
> 时间：2013-04-20T01:26:50.487
> 
> 标签：java, validation, date, simpledateformat

我正在尝试创建可以检查多种格式的日期/时间的东西，以查看它是否是有效的日期/时间，以便我可以处理它。处理它包括将日期/时间转换为标准化的东西，以便我的软件可以使用。问题是我必须以不同的方式进行检查，以尝试使用 SimpleDateFormat 检测日期，但确实很难获得每个品种。该项目与在日期列中解析具有潜在用户指定日期格式的 CSV 文件有关。有没有更好的办法？这是我现在正在做的事情：

```
public static boolean isDateValid(String dateString)
{
    ArrayList<SimpleDateFormat> dateFormats = new ArrayList<SimpleDateFormat>();

    dateFormats.add(new SimpleDateFormat("M/dd/yyyy"));
    dateFormats.add(new SimpleDateFormat("dd.M.yyyy"));
    dateFormats.add(new SimpleDateFormat("M/dd/yyyy hh:mm:ss"));
    dateFormats.add(new SimpleDateFormat("dd.M.yyyy hh:mm:ss"));
    dateFormats.add(new SimpleDateFormat("dd-M-yyyy hh:mm:ss"));
    dateFormats.add(new SimpleDateFormat("M-dd-yyyy hh:mm:ss"));
    dateFormats.add(new SimpleDateFormat("yyyy-M-dd hh:mm:ss"));
    dateFormats.add(new SimpleDateFormat("dd.MMM.yyyy"));
    dateFormats.add(new SimpleDateFormat("dd-MMM-yyyy"));
    dateFormats.add(new SimpleDateFormat("M/dd"));
    dateFormats.add(new SimpleDateFormat("M dd"));
    dateFormats.add(new SimpleDateFormat("M y"));
    for (SimpleDateFormat format : dateFormats) 
    {
        try 
        {
            format.setLenient(false);
            Date date = format.parse(dateString);
            return true;
        } 
        catch (Exception e) 
        {

        }
    }
    return false;
} 
```

此外，我还尝试使用 apache commons 中的 DateUtils，但似乎我仍然需要循环浏览一堆日期。

```
public static boolean isDate(String dateString)
{
    try
    {
        Date theDate = DateUtils.parseDate(dateString);
    }
    catch (Exception e)
    {
        System.out.println(e);
        return false;
    }
    return true;
} 
```

有什么想法或鼓励的话？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-20T02:22:48.037

好吧，这是我的建议：

1.  您应该缩小支持的日期格式类型。支持每种日期格式是很疯狂的，例如，一九九零年三月一日是中文有效的日期格式。

2.  我们有一种双重检查方法来检测有效日期，如下所示：

    ```
    public boolean isDate(String dateStr, DateFormat format){
        boolean result = false;
        try
        {
            Date date = format.parse(dateStr);
            if (format.format(date).equals(dateStr))
            {
                result = true;
            }
        } catch (Exception e)
        {
            result = false;
        }
        return result;
    } 
    ```

因为 '2013/4/31' 被 SimpleDateFormat 翻译成 '2013/5/1'，所以 4 月的最后一天是 30 日，对吗？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-07-08T03:44:16.073

我在工作中被分配了一个类似的问题，我参与了一个 ETL 过程，将数据从源文件加载到仓库。日期格式因来源提供者而异。我的解决方案与列出的循环示例一起使用。有一个选项可以使用[**parsePosition**](http://docs.oracle.com/javase/7/docs/api/java/text/ParsePosition.html)而不是循环。但是，有一些方法可以使循环代码更好，而不是再次实例化 SimpleDateFormat（已经发布）。相反，只需使用`applyPattern`. 此外，将各种格式保存在一个平面文件 (config) 中可以更好地配置和适应新格式。我已在以下[**链接**](http://allzhere.in/2013/07/07/java-date-validation-against-multiple-formats/)中发布了我的实现。它可能会有所帮助。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-20T01:33:38.357

您当前方法的一个问题是，当您知道您只会使用一个时，您不必要地创建所有这些 SimpleDateFormat 实例。相反，使用正则表达式来检测您收到的日期字符串类型，然后执行以下两项操作之一：1) 仅实例化您需要的格式化程序，或 2) 将字符串操作为您可以解析的标准格式通用格式化程序。

# internet-explorer - Fine Uploader 在 Facebook iframe 中失败

> ID：16115585
> 
> 赞同：0
> 
> 时间：2013-04-20T01:27:08.763
> 
> 标签：internet-explorer, facebook-iframe, fine-uploader

我已经构建了一个需要一些图像上传功能的 Facebook 应用程序，并使用 Fine Uploader 来实现它。

Facebook 应用程序本身是用 WordPress 构建的，一切正常。最终，WordPress 网站（即应用程序）将以 iframe 的形式出现在 Facebook 上，而事情就在这里变得有趣起来。

当我在本地机器上测试应用程序时，它可以工作（所有浏览器）。当我在暂存环境中的 iframe 之外测试应用程序时，它也可以工作（所有浏览器）。但是，当我在 Facebook (iframe) 上的测试页面中测试应用程序时，图像上传失败，仅在 IE 中。

作为参考，我将展示我的服务器和客户端代码：

```
public static function upload_receiver()
{
    $uploader = new qqFileUploader();
    $uploader->allowedExtensions = array("jpg", "jpeg");
    $uploader->sizeLimit = 2024 * 1024;

    $wp_upload_dir = wp_upload_dir();
    $wp_upload_url = $wp_upload_dir['baseurl'];
    $wp_upload_base = $wp_upload_dir['basedir'];

    $upload_dir = $wp_upload_base;
    $upload_filename = md5(mt_rand())/*.'_'.$uploader->getName()*/.".jpg";

    $result = $uploader->handleUpload( $upload_dir, $upload_filename );

    // Create the WordPress image thumbs.
    $img_target = "{$upload_dir}/{$upload_filename}";

    $wp_filetype = wp_check_filetype( $img_target );

    $attachment_data = array(
        'post_mime_type' => $wp_filetype['type'], 
        'guid' => $img_target,
        'post_title' => preg_replace('/\.[^.]+$/', '', $upload_filename ),
        'post_name' => preg_replace('/\.[^.]+$/', '', $upload_filename ),
        'post_content' => '',
        'post_status' => 'inherit',
    );

    $attachment_id = wp_insert_attachment( $attachment_data, $img_target );

    $meta = wp_generate_attachment_metadata($attachment_id, $img_target);

    wp_update_attachment_metadata($attachment_id, $meta);   

    $result['attachmentId'] = $attachment_id;
    $result['imageUrl'] = htmlspecialchars( get_image_url_from_attachment_id($attachment_id, "thumb-small") );

    header("Content-Type: text/plain");
    echo json_encode( $result );

    die();
} 
```

和客户：

```
var el = $('#upload');
var el_img = el.find('span');

el.fineUploader( {
    uploaderType: 'basic',
    button: el,
    multiple: false,
    request: {
        endpoint: '<?php echo site_url("/wp-admin/admin-ajax.php") ?>',
        params: {
            action: 'upload_receiver'           
        }
    },
    validation: {
        allowedExtensions: ['jpeg', 'jpg']
    },
    debug: false
} ).on('upload', function(event, id, fileName, response) {
    $('.loader').show();
    $('.upload_button_container').hide();

} ).on('complete', function(event, id, fileName, response) {

    // ONLY IN IE "RESPONSE.SUCCESS" IS FALSE IN AN FB IFRAME. ALL OTHER
    // TIMES "RESPONSE.SUCCESS" IS TRUE AND ALL PROPERTIES CREATED ON THE
    // SERVER EXIST.

    $('.loader').hide();
    $('.upload_button_container').show();

    if( response.error )
    {
        alert( response.error );
        return;
    }

    // Display image coming in from the result.
    $(".img_upload_container img").attr('src', response.imageUrl).show();

    // Store the WordPress attachment Id for form submission.
    $("form input[name=bc_attachment_id]").val( response.attachmentId );
}); 
```

在过去的几个小时里，我一直在努力解决这个问题，但我已经想不出可能导致这个问题的想法了。

**编辑**：

IE9 控制台输出：

```
LOG: [FineUploader] Processing 1 files or inputs... 
LOG: [FineUploader] Sending upload request for 0 
SEC7111: HTTPS security is compromised by res://ieframe.dll/forbidframing.htm 
SEC7111: HTTPS security is compromised by res://ieframe.dll/ErrorPageTemplate.css 
SEC7111: HTTPS security is compromised by res://ieframe.dll/errorPageStrings.js 
SEC7111: HTTPS security is compromised by res://ieframe.dll/httpErrorPagesScripts.js 
SEC7111: HTTPS security is compromised by res://ieframe.dll/red_x.png 
SEC7111: HTTPS security is compromised by res://ieframe.dll/bullet.png 
SEC7111: HTTPS security is compromised by res://ieframe.dll/background_gradient.jpg 
LOG: [FineUploader] Received response for 0 
[FineUploader] Error when attempting to access iframe during handling of upload response (Error: Access is denied.
) 
LOG: [FineUploader] iframe loaded 
[FineUploader] Error when attempting to parse form upload response (Error: Access is denied.
) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-20T03:43:40.717

正如我所怀疑的，问题在于父窗口的域与包含响应的 iframe 的域不匹配。这是一种安全违规，并且没有简单的方法可以访问此 iframe 的内容，因为它位于不同的域中。浏览器禁止此类访问。解决这个问题有点棘手，但 Fine Uploader 提供了一种方法。

您需要在 Fine Uploader 中启用 CORS 功能。这可能是您最好的选择，这应该可以解决您的问题。Fine Uploader 最近增加了对跨域请求的支持（3.3 版）。这在涉及 iframe 的 IE 中特别有用。本质上，您将配置您的响应以导入一个 javascript 文件，该文件将向包含您的响应的父窗口发布一条消息。这就是 Fine Uploader 克服跨域问题的方式。我写了一篇关于 Fine Uploader 中[的 CORS 支持的详细博客文章](http://blog.fineuploader.com/2013/01/31/cors-support-in-3-3/)，以及如何启用它并正确处理 Fine Uploader 在服务器端代码中发送的跨域请求。

如果您阅读该帖子并按照服务器端说明进行操作，那么您应该没问题。

请注意，在您的情况下，这似乎只是您需要在 IE9 和更早版本中克服的问题。以下是您需要执行的操作的高级摘要：

1.  在 Fine Uploader（客户端）中打开 CORS 支持。
2.  服务器端：通过查看请求上的 X-Requested-With 标头来识别非 XHR 上传请求。
3.  如果请求不是通过 XHR 发送的，则返回内容类型为“text/html”的响应，该响应以`<script>`从已知位置（任何地方）导入“iframe.xss.response.js”文件的标记开头. 在响应中的脚本标记之后，包括响应的正常有效 JSON 部分。

希望这可以帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-04-25T07:22:38.633

只是为了在**iframe 属于同一域的****不同场景**中添加@Ray 的答案，但在 https 环境中仍然收到相同的内容：**`SEC7111: HTTPS security is compromised by res://ieframe.dll`**

 **## 对于 Apache，HTTP 服务器

在 Apache Web Server 的 httpd.conf 文件中添加/更改以下行

```
Header always append X-Frame-Options SAMEORIGIN 
```

确保它没有设置为`DENY`. 重启网络服务器

还要检查响应标头以查看是否反映了上述更改**

# c++ - c ++解决指针和整数之间的比较

> ID：16115591
> 
> 赞同：0
> 
> 时间：2013-04-20T01:27:57.880
> 
> 标签：c++

```
do {
    getline (myfile,temp);
    if (temp[0] != "="){
        MyAlbums[i].tracks.push_back(temp);

    }
    else {
        break;
    }
}while(true); 
```

给我这个错误：

ISO C++ 禁止指针和整数之间的比较 [-fpermissive]

如果该行不以“=”等于字符开头，我正在尝试遍历文本文件中的行和“push_pack”。否则我想跳出循环。

非常感谢任何帮助！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-20T01:29:08.820

```
if (temp[0] != "="){ 
```

应该

```
if (temp[0] != '='){ 
```

原因是它`temp[0]`的类型`char`（假设`temp`是您读入的字符串），您应该将其与 char literal`'='`而不是 string literal进行比较`"="`。我假设您已`temp`成功阅读，因此如果不是这种情况，您可能需要检查一下。

**编辑**（感谢亚当利斯）

`"="`像( ) 类型的字符串文字`const char *`，它们用双引号括起来；单个字符用单引号括起来。因此，您会收到关于将`char`(char 文字是整数) 与`const char *`.

从这里引用：[IBM C++ 文档](http://publib.boulder.ibm.com/infocenter/macxhelp/v6v81/index.jsp?topic=/com.ibm.vacpp6m.doc/language/ref/clrc02ccon.htm)

```
C  A character literal has type int.
C++ A character literal that contains only one character has type char, 
which is an integral type. 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-20T01:30:21.483

首先，确保`getline`成功。在 ean 上下文中对其进行评估`bool`以找出答案：

```
while (getline(myfile, temp)) {
  /* code goes here */
} 
```

代替

```
do {
  getline(myfile, temp);
  /* code goes here */
} while (true); 
```

永远，永远不要在不检查它是否立即失败的情况下进行输入，否则你会得到非常烦人的错误来追踪。

其次，确保`temp`至少有 1 个字符长。 如果这样做是安全的，将`temp.size() >= 1`是。如果曾经给你一个长度为 0 的值，那么对它进行操作将导致未定义的行为。追踪未定义的行为真的很烦人，因为它可以在一种情况下表现得完全无害，然后在一个意想不到的地方咬你。`true``temp[0]``getline``string``temp[0]`

第三，做`temp[0] != '='`而不是`temp[0] != "="`。 `'='`是一个字符，`"="`是 2 个字符的缓冲区，第一个是`'='`第二个是`'\0'`. `"="`当您尝试 do 时，由 表示的两个字符的数组隐式转换为指向第一个字符的指针`!=`，然后生成错误（因为它不知道如何将指向字符的指针与字符进行比较）。

# ruby - 如何杀死 PID 在 PID 文件中的进程？

> ID：16115593
> 
> 赞同：1
> 
> 时间：2013-04-20T01:28:06.223
> 
> 标签：ruby

我有一个变量`pidfile`，它存储进程的 PID。

`pidfile`假设我只知道文件名，而不是其中的实际 PID，如何使用 Ruby 以编程方式杀死 pid 。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-20T01:34:39.657

```
Process.kill(15, File.read('pidfile').to_i) 
```

甚至

```
Process.kill 15, File.read('pidfile').to_i 
```

现在，您还可以执行以下操作：

```
system "kill `cat pidfile`" # or `kill \`cat pidfile\`` 
```

然而，这种方法有更多的开销，容易受到代码注入漏洞的攻击，移植性较差，并且通常只是一个包裹在 Ruby 中的 shell 脚本，而不是实际的 Ruby 代码。

# c - 如何输入结构的指针

> ID：16115595
> 
> 赞同：1
> 
> 时间：2013-04-20T01:28:20.060
> 
> 标签：c, pointers, structure

我正在编写一个程序，用于使用结构和指针查找两个有理数的加法、乘法和除法。我在用指针输入数字时遇到问题。我的代码应该如何更正？谢谢！

```
#include <stdio.h>
struct rational
{
    int nu;
    int de;
}*p1,*p2,*p3;
struct rational add()
{
    p1->nu = p1->nu*p2->de + p1->de*p2->nu;
    p3->de = p1->de * p2->de;
    printf("%d\n--\n%d\n",p3->nu,p3->de);
}
struct rational multiply()
{
    p3->nu = p1->nu * p2->nu;
    p3->de = p1->de * p2->de;
    printf("%d\n--\n%d\n",p3->nu,p3->de);
}
struct rational divide()
{
    p3->nu = p1->nu * p2->de;
    p3->de = p1->de * p2->nu;
    printf("%d\n--\n%d\n",p3->nu,p3->de);
}
int main()
{
    int a,b,choice;
    printf("Enter the first rational number.\n");
    scanf("%d%d",&p1->nu,&p1->de);
    printf("Enter the second rational number.\n");
    scanf("%d%d",&p2->nu,&p2->de);
    scanf("%d",&choice);
    switch (choice)
    {
        case 1: add();
                break;
        case 2: multiply();
                break;
        case 3: divide();
                break;
    }
    return 0;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-20T01:32:33.197

1.  您已声明指向`struct rational`但未将它们分配为实际指向任何此类结构的指针。例如：

    ```
    struct rational rat_a;
    p1 = & rat_a; 
    ```

2.  您将函数声明为返回`struct rational`（即`struct rational add()`），但它们似乎没有返回任何内容。如果一个函数没有返回任何东西，它应该被声明为 void -`void add()`

3.  为什么你使用指向结构的指针而不是结构本身？（如果在您的代码中声明为全局）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-09-04T22:36:56.550

您声明指向结构的指针，而不是结构本身。指向结构的指针可以保存结构的地址，但不会创建一个。您必须具有结构，才能使指针指向它。

```
struct rational
{
    int nu;
    int de;
}*p1,*p2,*p3; 
```

这部分有 3 个指向结构的指针。他们现在什么都没有。现在您必须创建实际的结构，例如

```
struct rational structure1, structure2, structure3; 
```

现在您可以为指针赋值：

```
p1=&structure1;
p2=&structure2;
p3=&structure3; 
```

从现在开始 p1 保存结构 1 的地址，依此类推。而且只有从细点你可以取消引用指针

```
p1->de
p2->nu 
```

我想，埋葬你的是什么，让那些全球指针。当函数什么都不做并且突然做出一些事情时，它看起来真的很丑。如果你通过引用函数来传递你的结构，它看起来会更好更干净。接下来，您的函数似乎正在返回结构，但它们没有。决定您是否通过指针修改它们。此外，当您定义不带参数的函数时，您会这样做

```
int funct(void); 
```

在您的情况下，函数不接受参数并且不返回值，因此它们中的每一个都应该如下所示：

```
void myfunction(void); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-09-04T23:21:48.530

您的代码修改为使用指向结构、结构和整数的指针：

```
#include <stdio.h>
typedef struct 
{
    int nu;
    int de;
}rational;

rational *p1, elements;

int add(rational *p4)
{
    int a;
    a = p4->nu+p4->de;

    return a;
}
int multiply(rational *p4)
{
    int a;
    a = p4->de * p4->nu;

    return a;
}
int divide(rational *p4) //should return a float instead of int to show decimal returns
{
    int a;
    a = p4->nu / p4->de;

    return a;
}
int main()
{
    int a,b,choice;

    p1 = &elements;

    printf("Enter the first rational number.\n");
    scanf("%d",&a);
    printf("Enter the second rational number.\n");
    scanf("%d",&b);
    printf("Enter choice /(1, 2 or 3/).\n");

    scanf("%d",&choice);

    p1->nu = a;
    p1->de = b;
    switch (choice)
    {
        case 1: 
            a = add(p1);
            printf("%d + %d = %d\n",p1->nu, p1->de, a);

                break;
        case 2: 
            a= multiply(p1);
                printf("%d * %d = %d\n",p1->nu, p1->de, a);

                break;
        case 3: 
            a = divide(p1);
            printf("%d / %d = %d\n",p1->nu, p1->de, a);
                break;
    }
    getchar();//eats an additional character?...
    getchar();//stop execution so you can see your answer
    return 0;
} 
```

# .net - Visual C++ 监视键序列

> ID：16115597
> 
> 赞同：1
> 
> 时间：2013-04-20T01:28:48.833
> 
> 标签：.net, c++-cli, keyboard-shortcuts, capture

如果我在 C++ 中有一些表单应用程序，我将如何设置一些东西以便它监视特定的键序列以执行某些操作？例如，观察用户按特定顺序点击箭头键，然后打开另一个表单？

（显然这是.net？我是新手，所以我在这里有点迷路。）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-20T04:35:40.400

只要您可以要求 main`Form`有焦点，一个简单的版本涉及将`KeyPreview`属性设置为`true`并添加处理程序`PreviewKeyDown`：

```
#using <System::Windows::Forms.dll>

// for brevity of example
using namespace System;
using namespace System::Windows::Forms;

public ref class Form1 : Form
{
private:
    // desired key sequence
    static array<Keys>^ contra = { Keys::Up, Keys::Up, Keys::Down, Keys::Down,
                                   Keys::Left, Keys::Right, Keys::Left, Keys::Right,
                                   Keys::B, Keys::A, Keys::LaunchApplication1};

    // how far into the sequence the user currently is
    int keySeqPos;

    // some other data
    int lives;

    void Form1_PreviewKeyDown(Object^ sender, PreviewKeyDownEventArgs^ e)
    {
        if{keySeqPos < 0 || keySeqPos >= contra->Length)
        {
            // reset position if it's invalid
            keySeqPos = 0;
        }

        // use the following test if you don't care about modifiers (CTRL, ALT, SHIFT)
        // otherwise you can test direct equality: e->KeyCode == contra[keySeqPos]
        // caps lock, num lock, and scroll lock are harder to deal with
        if(e->KeyCode & Keys.KeyCode == contra[keySeqPos])
        {
            keySeqPos++
        }
        else
        {
            keySeqPos = 0;
            // alternatively, you could keep a history and check to see if a
            // suffix of it matches a prefix of your code, setting keySeqPos to
            // the length of the match
        }

        if(keySeqPos == contra->Length)
        {
            // key sequence complete, do whatever it is you want to do
            lives += 3;
        }
    }

    void InitializeComponent()
    {
        // other initialization code

        this->KeyPreview = true;
        this->PreviewKeyDown += gcnew PreviewKeyDownEventHandler(this, &Form1::Form1_PreviewKeyDown);
    }

public:

    Form1()
    {
        InitializeComponent();

        keySeqPos = 0;
        lives = 3;
    }
} 
```

# php - PHP：一个工作文件在包含后找不到其他文件？

> ID：16115601
> 
> 赞同：1
> 
> 时间：2013-04-20T01:30:14.907
> 
> 标签：php, include, relative-path, require

*首先：对不起标题。如果你可以弥补它，请这样做，因为我真的不知道如何命名我的问题。也就是说，周围很可能有重复，但我想我需要克服这个问题，只是不知道要搜索什么......*

基地不是我做的。它主要是用 HTML 编写的，但包含用 PHP 完成的，我真的不喜欢它的制作方式。但这与我在这里要问的问题无关。

这里描述的文件包含的内容比这里写的要多，但这里的问题是
**当需要文件 A 需要文件 B 需要许多文件时，文件 B 找不到它正在寻找的文件。**

因此，假设我有一个目录树，例如：

```
| - Project
+--- lower.txt
| -- Stuff
| ---- Case
+------ index.php
+------ upper.php
| -- Gallery
+---- main.php
+---- config.php
+---- miscfunc.php
+---- css.php 
```

**项目\东西\案例\index.php：**

```
<?php include("./upper.php");?> ...
<?php include("../../lower.txt");?> 
```

**项目\东西\案例\upper.php：**

```
<?php require_once("../../Gallery/main.php"); ?> 
```

**项目\画廊\main.php：**

```
<?php namespace Gallery;
...
// I'm just trying to debug something here... :
// -.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.- //

$PathToScan = "./"; // Scan current directory, will point to /Project/Stuff/Case/

function ScanFolder($path) {
    $Array = array();
    if ($dir = @opendir($path)) {
        while (($file = readdir($dir)) !== FALSE) {
            $Array[] = $file;
        }
        printf("Current directory: %s<br/>\n", dirname(__FILE__));
        printf("document_root: %s<br/>\n", $_SERVER["DOCUMENT_ROOT"]);
        printf("Scan directory: %s<br/>\n<br/>\n", $path);
        var_dump($Array);
    }
}
ScanFolder($PathToScan);

// -.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.- //

require_once("./config.php"); // These files are also in Gallery namespace
require_once("./miscfunc.php");
require_once("./css.php"); ...

...
?> 
```

所以......当我执行**Project\Stuff\Case\index.php**我得到：

```
Current directory: C:\xampp\htdocs\Project\Gallery
document_root: C:/xampp/htdocs
Scan directory: ./

array(4) { [0]=> string(1) "." [1]=> string(2) ".." [2]=> string(9) "index.php" [3]=> string(7) "upper.php" }
Warning: require_once(./config.php) [function.require-once]: failed to open stream: No such file or directory in C:\xampp\htdocs\Project\Gallery\main.php on line 44

Fatal error: require_once() [function.require]: Failed opening required './config.php' (include_path='.;C:\xampp\php\PEAR') in C:\xampp\htdocs\Project\Gallery\main.php on line 44 
```

## 现在为什么会发生这种情况，我怎样才能在不移动任何文件并且最好不破坏 main.php 的情况下让它工作？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-21T10:53:29.940

我最终改变了

```
require_once("./filename.php"); 
```

行到

```
require_once(__DIR__ . "/filename.php"); 
```

仍然想知道是否可以这样做......

# java - 如何使用正则表达式将字符串从一种模式转换为另一种模式？

> ID：16115602
> 
> 赞同：0
> 
> 时间：2013-04-20T01:30:15.700
> 
> 标签：java, regex, converter

我有一个要使用正则表达式转换的字符串：

`AA_BB_CC_DD`=>`EE_BB_FF_DD`

尝试使用正则表达式，例如`(AA)(.*)(FF)`. 但这没有用。有人可以帮忙吗？

如果您能给我指出一个好的正则表达式指南，那就太好了。正则表达式的站点太多。不知道该参考哪个。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-20T14:56:52.780

怎么样

```
String before = "AA_BB_CC_DD";
String after = before.replaceFirst("AA(_BB_)CC(_DD)", "EE$1FF$2");

System.out.println(after);
// EE_BB_FF_DD 
```

您还没有描述输入字符串的形式如何变化，因此很难生成合适的正则表达式。

如果您想允许介于`AA`and之间的几乎任何东西，`CC`您可以使用`(.*?)`而不是`(_BB_)`etc。

上面展示了在替换字符串中使用被捕获的内容的原理`()`，即`$1`引用第一个`()`和`$2`第二个中的内容`()`。

链接：
[正则表达式.info](http://www.regular-expressions.info/)。
[Java 教程。课程：正则表达式](http://docs.oracle.com/javase/tutorial/essential/regex/index.html)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-20T16:17:06.240

如果你想要完整的解释，你可以看看这里： [http ://www.regular-expressions.info/tutorialcnt.html](http://www.regular-expressions.info/tutorialcnt.html)

当您了解它的工作原理时，[Pattern API](http://docs.oracle.com/javase/7/docs/api/java/util/regex/Pattern.html)就足够了。

对于您的示例，我假设 AA -> EE, BB -> BB, CC -> FF, DD -> DD 所以您可以尝试以下操作：

```
String before = "AA_BB_CC_DD";
String after = before.replaceAll("AA_(.*)_CC_(.*)", "EE_$1_FF_$2"); 
```

你得到结果。我解释一下正则表达式：
“AA_(.*) *CC* (.*)”
程序尝试匹配 AA_, . 表示任何字符，* 表示重复。因此，AA_ 和*CC*之间的任何字符串都匹配。() 表示被“记忆”的组。

“EE_$1_FF_$2”
AA_ 替换为 EE_。$1 表示打印第一组 ()。
FF 和 2 美元也一样。

# javascript - 奇怪的 jQuery 单选按钮显示/隐藏错误

> ID：16115605
> 
> 赞同：1
> 
> 时间：2013-04-20T01:30:47.877
> 
> 标签：javascript, jquery, html

我希望在选择 op1 和 op2 时显示用户名文本字段，如果选择 op3 则显示两个文本字段。我有一个奇怪的错误，选择的任何单选按钮将始终显示用户名和密码文本字段。为什么会这样？

HTML：

```
<div>Please select operation:<br />
    <input type="radio" id="op1" name="op" value="check_username">Check Username<br />
    <input type="radio" id="op2" name="op" value="find_profile">Find Profile<br />
    <input type="radio" id="op3" name="op" value="check_credentials">Check Credentials
</div><br />

<div id="un">Username:<br /><input type="text" /></div>
<div id="pwd">Password:<br /><input type="text" /></div> 
```

jQuery：

```
$(document).ready(function() {
    $('#un, #pwd').hide();
    $('input[name="op"]').prop('checked', false);
    $("input[type=button]").attr("disabled", "disabled");

    $('input:radio[name=op]').change(function() {
        var op = $('input:radio[name=op]:checked').val();
        alert(op);
        switch(op) {
            case 'check_username':
            $('#un').show();
            $('#pwd').hide();
            case 'find_profile':
            $('#un').show();
            $('#pwd').hide();
            case 'check_credentials':
            $('#un, #pwd').show();
        }
    });
}); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-20T01:35:42.967

您`break`在每个陈述之后都缺少`case`陈述。添加它们后它[工作正常！](http://jsfiddle.net/nma6b/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-20T01:37:49.793

在每种情况下，您都忘记了“休息”：

```
 switch(op) {
        case 'check_username':
        $('#un').show();
        $('#pwd').hide();
        break;
        case 'find_profile':
        $('#un').show();
        $('#pwd').hide();
        break;
        case 'check_credentials':
        $('#un, #pwd').show();
        break;
    } 
```

# ios - iOS：修改按钮颜色的问题

> ID：16115606
> 
> 赞同：1
> 
> 时间：2013-04-20T01:31:03.520
> 
> 标签：ios, cocoa-touch, button

我在 .h 文件中有以下代码：

```
#import <UIKit/UIKit.h>
@interface SCLoginViewController : UIViewController
@property (weak, nonatomic) IBOutlet UIButton *btnLogin;
@end 
```

以及 .m 文件中的以下代码：

```
- (void)viewDidAppear:(BOOL)animated
{

    [super viewDidAppear:animated];

    // Do any additional setup after loading the view from its nib.
    // Add gradient to the buttons

    btnLogin.layer.cornerRadius = 10;

    CAGradientLayer *gradientLayer = [CAGradientLayer layer];
    gradientLayer.frame = btnLogin.layer.bounds;

    gradientLayer.colors = [NSArray arrayWithObjects:
                            (id)[UIColor colorWithWhite:1.0f alpha:0.1f].CGColor,
                            (id)[UIColor colorWithWhite:0.4f alpha:0.5f].CGColor,
                            nil];

    gradientLayer.cornerRadius = btnLogin.layer.cornerRadius;
    [btnLogin.layer addSublayer:gradientLayer];

    // Add shadow
    btnLogin.layer.shadowColor = [UIColor darkGrayColor].CGColor;
    btnLogin.layer.shadowOpacity = 1.0;
    btnLogin.layer.shadowOffset = CGSizeMake(2.0, 2.0);
} 
```

这是按钮在屏幕上的显示方式：

![在此处输入图像描述](https://i.stack.imgur.com/ca2Di.png)

不过，有些事情是非常错误的。我知道我错过了一些简单的东西，但无法弄清楚。我创建了名为 btnLogin 的常规插座，但我尝试对其进行的任何更改都不起作用。该按钮是圆角矩形按钮。我尝试了自定义按钮，但没有帮助。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-20T02:46:07.593

从图像中，我看到您没有从 nib 文件上的 btnLogin 连接到文件的所有者 - .h 文件。因此，下面的这一行与您尝试更改的按钮无关。

```
@property (weak, nonatomic) IBOutlet UIButton *btnLogin; 
```

一旦你建立了正确的连接，它应该会在你提供的图像上显示引用插座的 btnLogin 名称。

# ios - 针对多个 keyPaths 执行 valueForKeyPaths

> ID：16115608
> 
> 赞同：1
> 
> 时间：2013-04-20T01:31:30.737
> 
> 标签：ios, objective-c, nsarray

假设我有一个具有一些属性的对象，并且我将 1000 个这些对象加载到一个数组中。`valueForKeyPaths`接下来，我针对这些属性执行一系列操作：

```
result.property1 = [array valueForKeyPath:@"@sum.property1"];
result.property2 = [array valueForKeyPath:@"@sum.property2"];
result.property3 = [array valueForKeyPath:@"@sum.property3"];
etc... 
```

单独对这些属性求和似乎非常低效。除了快速枚举属性并手动求和之外，还有更好的方法吗？IE

```
for(Foo* foo in array) {
    result.property1 += foo.property1;
    result.property2 += foo.property2;
    result.property3 += foo.property3;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-20T02:52:28.040

KVC 要求键是字符串：

> 键是标识对象的特定属性的字符串。通常，键对应于接收对象中访问器方法或实例变量的名称。密钥必须使用 ASCII 编码，以小写字母开头，并且不得包含空格。

因此，据我所知，不幸的是，您不能这样做，`valueForKeyPath:`您必须手动执行或枚举它。

# javascript - 使用 DOM getElementsByName 更改 CSS

> ID：16115611
> 
> 赞同：2
> 
> 时间：2013-04-20T01:32:45.537
> 
> 标签：javascript, css, dom, getelementsbyname

我正在尝试使用 JS 中的 DOM 更改为 CSS，我已经成功更改了 HTML 属性，但没有更改 CSS 属性。似乎 CSS 不受此特定 DOM 的影响。

代码看起来像这样...

```
<style>
    #circle1{

            width: 50px !important;
            height: 50px !important;
            position: absolute !important;
            top: 200px !important;
            left: 405px !important;
            background: black !important;
            border-bottom-left-radius: 50px !important;
            border-bottom-right-radius: 50px !important;
            border-top-left-radius: 50px !important;
            border-top-right-radius: 50px !important;
            z-index: 10 !important;
            visibility: hidden !important;

    }

    </style>
</head>

<body>
<script type="text/javascript">
function showCircle(){
    document.getElementsByName ("circle").style.visibility="visible";  
}

</script>
<div id="circle1" name="circle"></div>

<input type="button" onclick="showCircle()" value="show circle with display property">
</body> 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-20T01:38:50.500

尝试这个

```
function showCircle(){
    document.getElementsByName("circle")[0].style.visibility="visible";  
} 
```

并`!important`从`css`类中删除可见性属性

[JS 小提琴示例](http://jsfiddle.net/sachinyadav/frjS3/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-20T01:37:22.197

`getElementsByName`返回一个`NodeList`元素。如果您想要第一个元素，请这样说：

```
document.getElementsByName("circle")**[0]**.style.visibility = "visible";
```

但如果你只有一个，为什么不直接使用`id`? `<div>`s 不应该真的有`name`s 反正...

```
document.getElementById('circle').style.visibility = 'visible'; 
```

如果有*很多*，您可以考虑改用类。（并且可见性的类也可能更好！）

`!important`最后，不要无缘无故地制作你所有的风格。几乎没有充分的理由让任何规则变得重要，并且它可能会使一切变得一团糟，`!important`而特异性会使事情变得更好。如果您只是将它们扔进去尝试修复某些东西……那会使情况变得更糟。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-20T01:40:09.380

您已将所有内容设置为`!important`. 这优先于内联样式。最快的解决方案是设置`style.visibility = 'visible!important'`，或者你可以不重要的。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-23T04:23:18.800

感谢大家的建议，最大的问题是 !important 覆盖了大多数 JS。我切换到使用显示并删除了！important。代码如下。我结束了使用另一个函数来隐藏 div 和一个案例来显示它们，因为随机生成器输入了哪个案例是可见的。

```
document.getElementById("circle1").style.display = "block"; 
```

# zend-framework2 - ZfcUser and Zend Framework 2

> ID：16115618
> 
> 赞同：1
> 
> 时间：2013-04-20T01:33:49.700
> 
> 标签：zend-framework2, zfcuser

I love ZfcUser and use it most every project that I develop. It works great, but I am looking to expand my usage of it a bit.

Are there some examples that someone can offer about checking for identity in the controller? I have a function that fires when any action from a given function is accessed... I would like to add authentication to that function, but as I said, it runs in the controller.

Any advice (or documentation?) would be appreciated!

thanks

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-20T02:26:41.967

在任何控制器中检查身份验证身份非常简单。

```
public function thatAction()
{
    $auth = $this->getServiceLocator()->get('zfcuser_auth_service');

    if( $auth->hasIdentity() )
        $user = $auth->getIdentity();
} 
```

很容易吧！您可以在此处找到更多信息： [https ://github.com/ZF-Commons/ZfcUser/wiki/How-to-check-if-the-user-is-logged-in](https://github.com/ZF-Commons/ZfcUser/wiki/How-to-check-if-the-user-is-logged-in)

您返回的用户对象是您的用户实体。如果您想自定义您的用户实体，我在这里有一些小博客文章可能会有所帮助：[http ://circlical.com/blog/2013/4/1/l5wftnf3p7oks5561bohmb9vkpasp6](http://circlical.com/blog/2013/4/1/l5wftnf3p7oks5561bohmb9vkpasp6)

# loops - 减少while循环中的CPU使用率

> ID：16115621
> 
> 赞同：1
> 
> 时间：2013-04-20T01:34:05.953
> 
> 标签：loops, while-loop, cpu-usage

你如何限制while循环的CPU？(cpu 使用率 100%)

在这种情况下，while 循环内的代码：

```
 Sub start()

    listenerThread = New Thread(AddressOf Listen)
    listenerThread.IsBackground = True
    listenerThread.Start()
End Sub

enter code here

 Sub Listen()
    Try
        listener = New TcpListener(New IPEndPoint(IPAddress.Any, port))

        listener.Start()
     a:          While (True)
            Thread.Sleep(600)
            Dim c As New Connection(listener.AcceptTcpClient)
            AddHandler c.GotInfo, AddressOf GotInfo
            AddHandler c.Disconnected, AddressOf Disconnected
        End While
    Catch ex As Exception
        GoTo a
    End Try
  End Sub 
```

# cocos2d-iphone - 在 cocos2d 中同步精灵动画

> ID：16115622
> 
> 赞同：1
> 
> 时间：2013-04-20T01:34:31.953
> 
> 标签：cocos2d-iphone

我时不时地在我的场景中添加一些脉动精灵，如下所示：

```
CCSpriteBatchNode *batch = (CCSpriteBatchNode*) [scene getChildByTag: foo1];

sprite = [CCSprite spriteWithBatchNode:batch rect:CGRectMake(0, 0, 128, 128)];
sprite.position = foo2
CCTintTo *a = [CCTintTo actionWithDuration: .5 red:128 green: 128 blue: 128];
CCTintTo *b = [CCTintTo actionWithDuration: .5 red:255 green: 255 blue: 255];

[sprite runAction:[CCRepeatForever actionWithAction:
                   [CCSequence actionOne: a  two: b]]];

[batch addChild: sprite]; 
```

我想让我所有的精灵同步脉动，我该怎么做？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-20T02:50:30.970

嗯……不容易。我认为这样做的唯一方法是像这样安排一个'flasherRamp'：

在.h

```
NSMutableArray *flashers; 
```

in .m，初始化方法

```
flashers = [[NSMutableArray array] retain]; // choose your own ARC flavor, if you retain 
                                            // dont forget to release in dealloc

[self schedule:@selector(flasherRamp) interval:1.0f]; 
```

在 .m 中，您在其中创建精灵

```
foo2.visible=NO;
[flashers addObject foo2]; 
```

最后

```
-(void) flasherRamp {
    for (CCSprite *flasher in flashers) {
        CCTintTo *a = [CCTintTo actionWithDuration: .5 red:128 green: 128 blue: 128];
        CCTintTo *b = [CCTintTo actionWithDuration: .5 red:255 green: 255 blue: 255];

        [flasher runAction:[CCRepeatForever actionWithAction:
               [CCSequence actionOne: a  two: b]]];
        flasher.visible=YES;
    }
    [flashers removeAllObjects];
} 
```

附言。最终可能会有一些偏差，这取决于这种情况持续了多长时间。

pps。从可用性的角度来看，如果闪烁精灵的出现和某些“异步”游戏事件之间存在因果关系，这可能会导致触发事件和实际出现之间长达 1 秒的延迟，这可能不是一个好主意。闪光器。

同上。：从内存编码，未经测试，但应该接近。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-22T18:24:42.603

在这种情况下，我会避免使用 CCRepeatForever。

创建一个定义当前色调状态（tintGray、tintWhite、tintDone）的枚举，然后创建一个检查状态的预定选择器。

一旦状态完成，重复操作，但对于批处理节点的每个子节点（假设它们是唯一的子节点）。

要安排选择器，请将以下内容放在您的 init 或其他加载方法中：

```
// be sure to schedule the interval at a fast enough rate
[self schedule:@selector(tick:) interval:0.1f]; 
```

然后定义方法如下：

```
-(void)tick:(ccTime)dt
{
    if(tintState == tintDone)
    {
        [self unschedule:@selector(tick:)];
        [self tinter];
    }
} 
```

然后为所有精灵安排着色动作：

```
-(void)tinter
{
    // could init and reuse this somewhere else to save on allocs
    CCSequence *actions = [CCSequence actions:
                       [CCCallBlockN actionWithBlock:^(CCNode* node)
                        {
                            tintState = tintGray;
                        }],
                       [CCTintTo actionWithDuration: .5 red:128 green: 128 blue: 128],
                       [CCCallBlockN actionWithBlock:^(CCNode* node)
                        {
                            tintState = tintWhite;
                        }],
                       [CCTintTo actionWithDuration: .5 red:255 green: 255 blue: 255],
                       [CCCallBlockN actionWithBlock:^(CCNode* node)
                        {
                            tintState = tintDone;
                        }],
                       nil];

    CCSpriteBatchNode *batch = (CCSpriteBatchNode*) [scene getChildByTag: foo1];
    for (CCSprite *flasher in batch.children) 
    {
        [flasher stopAllActions];
        [flasher runAction:actions];
    }

    // reschedule tick checking
    [self schedule:@selector(tick:) interval:0.1f];
} 
```

显然这并不完美，因为标志将由第一个精灵驱动以完成着色，但延迟应该可以忽略不计。如果你想确保它们都完成，只需将标志更改为精灵数量的运行计数，因此只有在 tintState 等于批处理节点中的精灵数量时才会调用“tinter”。

# iphone - Google Analytic 未在 iOS Cordova 2.0.0 应用程序中更新

> ID：16115624
> 
> 赞同：2
> 
> 时间：2013-04-20T01:34:50.620
> 
> 标签：iphone, ios, cordova, google-analytics

我正在使用 Cordova 2.0.0 开发 iOS 应用程序，并且我想使用 Google Analytics，所以我一步一步地遵循这个 github 链接，但不幸的是 GA 没有更新，链接自述文件中的唯一区别是“确保你是运行 Cordova(PhoneGap) 1.5.0" 并且我使用 Cordova 2.0.0 但我看到 repo 已更新为 2.0.0 并且我的应用程序工作正常但 GA 未更新

这是我在 OnDeviceReady 方法中调用的代码，用于启动 GA 并添加事件

```
var googleAnalytics = window.plugins.googleAnalyticsPlugin;
googleAnalytics.startTrackerWithAccountID("XX-XXXXXXXX-X");
googleAnalytics.trackEvent("category", "action", "label goes here", 666); 
```

任何人都可以帮助或面临同样的问题吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-02-21T09:06:52.077

请点击以下链接，它非常有帮助，也对我有用。----> **[https://github.com/jelled/google-analytics-cordova-ios](https://github.com/jelled/google-analytics-cordova-ios)**

# css - 使用没有盒装外观的 firefox-addon SDK 面板模块

> ID：16115625
> 
> 赞同：1
> 
> 时间：2013-04-20T01:35:13.707
> 
> 标签：css, sdk, firefox-addon, panel, mozilla

我想使用面板模块（即不仅附加脚本，还附加 html 和 CSS，并且没有插件 CSS 和 JavaScript 可能与主页交互）但没有盒装外观的限制。看起来这应该相当简单，但我认为这样做的唯一方法是使用低级 API，这些 API 缺乏高级 API 的简单性、安全性和文档。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-12-10T18:51:26.690

使用以下方法之一：

*   [样式表服务](https://developer.mozilla.org/en-US/docs/Using_the_Stylesheet_Service)
*   [UserChrome.css](http://kb.mozillazine.org/index.php?title=UserChrome.css)
*   [UserChrome.js](http://kb.mozillazine.org/index.php?title=UserChrome.js)
    *   [UserChrome.js 扩展](http://userchromejs.mozdev.org/)
*   [资源别名](https://developer.mozilla.org/en-US/docs/Chrome_Registration#resource)

# subquery - 子查询返回超过 1 行 - 带有 Visual Studio 2010 的 Mysql

> ID：16115629
> 
> 赞同：0
> 
> 时间：2013-04-20T01:36:09.290
> 
> 标签：subquery

我在mysql中有下一个代码：

```
("SELECT id_viaje, 
       (SELECT nombre 
        FROM   unidades, 
               viaje 
        WHERE  id_unidad = id_unidades), 
       (SELECT nombre 
        FROM   empleados, 
               viaje 
        WHERE  id_empleado = id_conductor), 
       (SELECT nombre 
        FROM   empleados, 
               viaje 
        WHERE  id_empleado = id_guarda), 
       (SELECT nombre 
        FROM   ciudad, 
               viaje 
        WHERE  id_ciudad = id_salida), 
       (SELECT nombre 
        FROM   ciudad, 
               viaje 
        WHERE  id_ciudad = id_llegada), 
       fecha_salida, 
       fecha_llegada 
FROM   viaje; ") 
```

我在每个结尾都尝试了 LIMIT 1，我用 IN 替换了 =，我不知道为什么会显示这个错误：

```
22:30:30    SELECT ID_Viaje, (select Nombre from unidades, viaje where ID_Unidad IN (ID_Unidades)) , (select Nombre from empleados, viaje where ID_Empleado IN (ID_Conductor)) ,(select Nombre from empleados, viaje where ID_Empleado IN (ID_Guarda)) , (select Nombre from ciudad, viaje where ID_Ciudad IN (ID_Salida)) , (select Nombre from ciudad, viaje where ID_Ciudad IN (ID_Llegada)) , Fecha_Salida, Fecha_Llegada FROM viaje limit 1    

Error Code: 1242 Subquery returns more than 1 row 
```

请我很快需要帮助！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-20T06:06:28.437

当您的子查询应该返回单行时返回多行时，将返回此错误。

您的子查询逻辑完全错误。当您将子查询放在`SELECT`语句中时，您必须确保子查询将始终返回零或一行。

您现在可以做的是`LEFT JOIN`在查询中添加并使用一些别名，如下所示：

```
SELECT id_viaje, 
       u.nombre AS unidade_nombre,
       e_con.nombre AS conductor_nombre, 
       e_grd.nombre AS guarda_nombre, 
       c_salida.nombre AS salida_nombre,
       c_llegada.nombre AS llegada_nombre, 
       fecha_salida, 
       fecha_llegada 
FROM   viaje v
LEFT JOIN unidades u ON v.id_unidad = u.id_unidades
LEFT JOIN empleados e_con ON e.id_empleado = v.id_conductor
LEFT JOIN empleados e_grd ON e.id_empleado = v.id_guarda
LEFT JOIN ciudad c_salida ON e.id_salida = c_salida.id_ciudad
LEFT JOIN ciudad c_llegada ON e.id_llegada = c_llegada.id_ciudad
; 
```

首先尝试在 MySQL Workbench 中运行它，并且只有当它在那里成功运行时，您才应该将它放入您的应用程序代码中。

另请注意，我的代码不应该在第一次尝试时运行。请在运行此代码之前进行任何适用的更正。

阅读有关[MySQL 连接](http://dev.mysql.com/doc/refman/5.0/en/join.html)和[MySQL 子查询的更多信息](http://dev.mysql.com/doc/refman/5.0/en/subqueries.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-20T06:08:32.463

当子查询返回多行时，您需要使用`in`运算符。但是在您的情况下，子查询也是一个问题。请尝试使用 Rachcha 建议的内容

# c# - 使用 WebRequest 或 WebBrowser 控件在 C# 中保持网站会话处于活动状态？

> ID：16115630
> 
> 赞同：0
> 
> 时间：2013-04-20T01:36:31.633
> 
> 标签：c#, session

我正在尝试使用 WebRequest 或 WebBrowser 控件使会话保持活动状态。它可以在某些网站上正常运行，但某个特定网站在 30 分钟后将我注销。

我目前所做的是使用 WebBrowser 控件中的 NavigateTo 功能以随机间隔（1-10 分钟）要求网站页面之一。网站是验证码登录，所以我首先要求用户登录，然后我获取 cookie 并将它们用于我的 WebRequest 请求，然后我重用 WebBrowser 控件来保持网站活动（因此 WebBrowser 和 WebRequest 客户端共享相同的 cookie）。

我正在寻找想法，也许有人可以帮助我。提前致谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-20T03:14:33.950

通常，对于会话超时，您无能为力，因为它们既是客户端又是服务器端，或者只是服务器端。不过，如果你幸运的话，有问题的网站依赖于客户端的 cookie 超时。如果是这种情况，您可以使用[HttpCookie.Expires](http://msdn.microsoft.com/en-us/library/system.web.httpcookie.expires.aspx)。

这可能会阻止它过期：

```
HttpCookie cookie = ...;
cookie.Expires = default(DateTime); 
```

# android - Stop Android Location Service if Location Doesn't Change After a Time

> ID：16115631
> 
> 赞同：0
> 
> 时间：2013-04-20T01:37:11.637
> 
> 标签：android, service, locationlistener

I am trying to code a service that repeatedly checks user location, but shuts off if certain things don't occur within about 3 minutes. I put the shut-the-service-off-logic in onLocationChanged. I just realized that if a user puts a phone on a table and leaves it there onLocationChanged may never be called, and the shutoff logic will never be entered. Is there some other method that could be overridden that gets called every time location is requested? Do I need to manually call onLocationChanged (and is that even a good idea?).

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-20T01:45:42.703

创建一个`CountdownTimer`并将其设置`millisInFuture`为 3 分钟。在`onFinish()`定时器`removeLocationUpdate`中。当您启动此计时器`requestLocationUpdate`并在 onLocationChanged 中取消并再次启动计时器。

# grails - How to use grails.plugin.location?

> ID：16115635
> 
> 赞同：9
> 
> 时间：2013-04-20T01:37:58.343
> 
> 标签：grails, grails-plugin

I have a plugin project which I created as `grails create-plugin myPlugin`. I also created a 'normal' grails project as `grails create-app myPluginDemo`. I'm trying to install `myPlugin` plugin in `myPluginDemo` but don't understand how to use `grails.plugin.location`.

Where do I put `grails.plugin.location` inside `BuildConfig.groovy`? Inside `plugins` section? Inside `repositories` section?

What should I append to `grails.plugin.location`? Should it be `grails.plugin.location.myPlugin`? Or `grails.plugin.location.grails-my-plugin`? Something else?

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2013-04-20T03:09:52.240

`grails.plugin.location`不是依赖解析，所以它在外面`grails.project.dependency.resolution`。

`myPluginDemo`如果两者和`myPlugin`都在同一个目录中，它应该如下所示。此外，这不会将插件安装到应用程序中，但应用程序会引用插件的文件系统，这在开发模式下很方便。为了使用打包的插件，它必须在`plugins`里面被引用`grails.project.dependency.resolution`

```
grails.plugin.location.myPlugin = "../myPlugin"
grails.project.dependency.resolution = {
    repositories {

    }
    dependencies {

    }
    plugins {

    }
} 
```

# qt - Qt torrent 示例卡在搜索中

> ID：16115636
> 
> 赞同：1
> 
> 时间：2013-04-20T01:37:58.840
> 
> 标签：qt, bittorrent

我有个问题。

我正在开发仅下载的 bittorrent 客户端。一切都很顺利，

但我暂停了大约 2 周，而我什么也没改变。现在我的程序卡在搜索中。我还尝试了 qt torrent 示例。两台电脑都有同样的问题。Linux/Windows 7/Windows 8（全部为 64 位）。你知道什么会导致这个问题吗？还尝试打开/关闭防火墙。没变。

我把它作为一个学校项目，我很害怕制作全新的代码，如果我有大约 2 周的时间来完成它。

这是qt-example的链接 [http://qt-project.org/doc/qt-4.8/network-torrent.html](http://qt-project.org/doc/qt-4.8/network-torrent.html)

谢谢马丁的帮助

# php - 在 html 表中的每一行添加编辑按钮，以编辑数据库

> ID：16115637
> 
> 赞同：2
> 
> 时间：2013-04-20T01:38:47.673
> 
> 标签：php, html

我对 php 比较陌生，需要帮助我正在做一个实习程序......在我试图创建的页面上，我查询了 mysql 数据库中的所有记录，并将它们插入到一个 html 表中。我想要做的，也是在表格的每一行的单独列中添加一个编辑按钮，因此可以编辑行..我知道如何在那里获得按钮，但我不知道如何获得将该特定行中的值放入一个 php 变量中，这样我就可以执行更多查询来编辑、删除等...我一直在寻找几天，看起来可能可以使用 javascript，但是我以前从未使用过 javascript，所以我不知道我在看什么...帮助将不胜感激

基本上：

```
<html>
<table border="1">

<th>Suspended</th>
<th>Device Name</th>
<th>IP</th>
<th>Depend</th>
<th>Email</th>

<?php
$sql = "select * from table;"

while($row=mysql_fetch_assoc($sql))
{
echo "<tr><td>".$row[0]."</td><td>".$row[1]."</td><td>".$row[2]."</td><td>".$row[3]."       </td><td>".$row[4]."</td></tr>";
}
?>

</table>
</html> 
```

==我还没有真正尝试过任何编辑/删除按钮..我真的不知道从哪里开始

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-20T01:54:14.687

为每个编辑按钮创建一个带有隐藏字段的表单，该字段存储该行的唯一可识别 ID（主键值）。

```
<form action="editPage.php" method="post/get">
<input type="hidden" name="id" value="<?php echo $row_id; ?>" />
<input type="submit" value="Edit"/>
</form> 
```

然后使用 id 更新数据库中该记录的字段。

是什么`$row_id`？如果我想将 $rowvalue 插入到变量或会话中，如何使用它？

# html - 浏览器是否加载了 display: none 的图像？

> ID：16115641
> 
> 赞同：0
> 
> 时间：2013-04-20T01:39:26.313
> 
> 标签：html, css

这些图像是否由浏览器加载：

```
<div style="display: none">
   <img src="/path/to/image.jpg" alt="">
</div> 
```

或者

```
<img src="/path/to/image.jpg" alt="" style="display: none;"> 
```

“由浏览器加载”我的意思是，这些图像是否由浏览器立即加载，以便当图像不再使用 css 显示为无时它们可以立即使用。当它不再显示为无时，它会从缓存中取出还是重新加载？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-20T02:22:13.090

要回答您的问题，它会在页面（或事件）加载后立即加载。通常在有人要使用 javasript 显示该元素时使用。

# c# - How to disply a combination of text and looped vars in a foreach statement

> ID：16115642
> 
> 赞同：1
> 
> 时间：2013-04-20T01:39:30.957
> 
> 标签：c#, razor, foreach

The following statement is erring in my MVC razor view.

```
 @foreach (var user in Model.Users)
                {
                    <li><a href="#">Add user</a></li>
                    <li><a href="#">@user.FirstName @user.LastName 
                        if(user.FirstName != "")
                        { 
                        @(@user.UserName)
                        }else{ 
                        @user.UserName
                        }
                        </a></li>
                } 
```

I cannot seem to figure out the razor to handle this properly.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-20T01:47:10.020

很可能您正在寻找`@if`而不是`if`因为启动 HTML 标记将上下文从“代码”切换到 HTML，并且您需要将其切换回“代码”。

```
@foreach(...
{
<span>...
  @if(...) 
  {
     <text>@user.UserName</text>
  }
</span>
} 
```

# mysql - 返回的记录集已关闭（通过 VBA 中的 ODBC 访问 mysql DB）

> ID：16115643
> 
> 赞同：20
> 
> 时间：2013-04-20T01:39:41.550
> 
> 标签：mysql, excel, vba

长期观众第一次海报。我正在开发一个带有 Excel 前端的数据库应用程序。因此，我使用 VBA 来访问 MySQL 数据库。我使用的驱动程序是 ODBC 驱动程序 (Windows)，并且我与数据库有有效的连接，因为许多其他查询运行良好。

我要做的是从一系列 SQL 语句中返回结果，而不是试图将它们全部组合成一个庞大的语句（这可能会起作用，但很难维护/理解）。我已将标志添加`FLAG_MULTI_STATEMENTS = 67108864`到抑制驱动程序语法错误的连接字符串。

但是现在当我运行以下命令时：

```
queryDB.Open SQLquery, conn 
```

遗体关闭，`recordset (queryDB)`没有明显错误。sql 语句可以在[这里](http://pastebin.com/rzm7raer)找到。

我可能会生成未返回到 VBA 的错误，因此非常感谢这里的任何帮助。

**注意**： sql 语句可以正常工作，因为我可以将该语句粘贴到`phpMyAdmin`其中并返回正确的（非空）结果。我不知道这些语句是否是具体的问题，但`CREATE TEMPORARY TABLE ...`一般来说可能是使用或使用多个语句。

另外我猜驱动程序可能正在尝试为每个 sql 语句返回一个结果，而 VBA 只得到第一个或其他东西......

**编辑**：供将来参考的 sql 语句。

```
CREATE TEMPORARY TABLE tmpOrders AS
SELECT
o.customerName,
SUM(o.Sales) AS Sales,
SUM(TotalFobCost + TotalLandedCost + TotalLocalCost + TotalCmtCost) AS TotalCost,
YEAR(o.deliveryDate) AS YEAR,
MONTH(o.deliveryDate) AS MONTH
FROM devere_costing.orders_fixed_extras AS o
WHERE o.orderApproved = TRUE
AND o.orderCanceled = FALSE
AND o.deliveryDate BETWEEN '2014-01-01' AND '2014-03-31'
GROUP BY customerName, YEAR, MONTH
ORDER BY YEAR ASC, MONTH ASC, customerName ASC;

CREATE TEMPORARY TABLE tmpProj AS
SELECT p.customerName,
   IF(p.MONTH > 9, p.YEAR, p.YEAR - 1) AS TrueYear,
   1 + ((p.MONTH + 2) MOD 12) AS TrueMonth,
   SUM(p.actualSalesInvoiced) AS salesInvoiced,
   SUM(p.budget) AS budget
FROM devere_costing.sales_projection_data AS p
GROUP BY p.customerName, p.YEAR, p.MONTH
HAVING TrueYear BETWEEN YEAR('2014-01-01') AND YEAR('2014-03-31')
AND TrueMonth BETWEEN MONTH('2014-01-01') AND MONTH('2014-03-31');

CREATE TEMPORARY TABLE tmpLeft AS
SELECT
IF(o.customerName IS NULL, p.customerName, o.customerName) AS customerName,
p.budget AS TotalBudget,
o.Sales AS Sales,
p.salesInvoiced,
0 AS varianceToBudget,
o.TotalCost,
0 AS directMargin,
0 AS directMarginPercent,
IF(o.YEAR IS NULL, p.TrueYear, o.YEAR) AS YEAR,
IF(o.MONTH IS NULL, p.TrueMonth, o.MONTH) AS MONTH
FROM tmpOrders AS o
LEFT JOIN tmpProj AS p
ON (o.customerName = p.customerName
AND o.YEAR = p.TrueYear
AND o.MONTH = p.TrueMonth);

CREATE TEMPORARY TABLE tmpRight AS
SELECT
IF(o.customerName IS NULL, p.customerName, o.customerName) AS customerName,
p.budget AS TotalBudget,
o.Sales AS Sales,
p.salesInvoiced,
0 AS varianceToBudget,
o.TotalCost,
0 AS directMargin,
0 AS directMarginPercent,
IF(o.YEAR IS NULL, p.TrueYear, o.YEAR) AS YEAR,
IF(o.MONTH IS NULL, p.TrueMonth, o.MONTH) AS MONTH
FROM tmpOrders AS o
RIGHT JOIN tmpProj AS p
ON (o.customerName = p.customerName
AND o.YEAR = p.TrueYear
AND o.MONTH = p.TrueMonth);

(SELECT * FROM tmpLeft) UNION DISTINCT (SELECT * FROM tmpRight); 
```

我已经回答了我自己的问题！

秘密就[在这里](http://msdn.microsoft.com/en-us/library/windows/desktop/ms677539%28v=vs.85%29.aspx)：

所以我是对的，返回的记录集不止一个。我只需要遍历它们即可找到我想要的数据。该集合未编入索引，因此您必须搜索每个集合。在我的情况下，每个 sql 语句都不会返回记录集（这就是为什么我的记录集在我尝试打开它时仍然关闭的原因）。唯一的例外是返回记录的最后一条 sql 语句。我的循环看起来像：

```
Dim rs As ADODB.Recordset
Set rs = queryDB(Sql)

' Loop through returned recordsets to find the data
Do
    If Not rs Is Nothing Then
        If rs.State = adStateOpen Then
            ' we have an open recordset.  This means that the final select statement
            ' has returned this data.
            Exit Do
        Else
            ' Otherwise iterate through to the next recordset
            Set rs = rs.NextRecordset
        End If
    Else
        MsgBox "No recordset returned by sql statement"
        GoTo ExitCode
    End If
Loop 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-07-11T12:55:49.410

从问题正文中复制的答案：

我已经回答了我自己的问题！

秘密就[在这里](http://msdn.microsoft.com/en-us/library/windows/desktop/ms677539%28v=vs.85%29.aspx)：

所以我是对的，返回的记录集不止一个。我只需要遍历它们即可找到我想要的数据。该集合未编入索引，因此您必须搜索每个集合。在我的情况下，每个 sql 语句都不会返回记录集（这就是为什么我的记录集在我尝试打开它时仍然关闭的原因）。唯一的例外是返回记录的最后一条 sql 语句。我的循环看起来像：

```
Dim rs As ADODB.Recordset
Set rs = queryDB(Sql)

' Loop through returned recordsets to find the data
Do
    If Not rs Is Nothing Then
        If rs.State = adStateOpen Then
            ' we have an open recordset.  This means that the final select statement
            ' has returned this data.
            Exit Do
        Else
            ' Otherwise iterate through to the next recordset
            Set rs = rs.NextRecordset
        End If
    Else
        MsgBox "No recordset returned by sql statement"
        GoTo ExitCode
    End If
Loop 
```

# ruby-on-rails - Rails: Routes, Controllers, Views, Oh My(exclamation)

> ID：16115644
> 
> 赞同：2
> 
> 时间：2013-04-20T01:39:48.660
> 
> 标签：ruby-on-rails, methods

I'm failing to understand the correlation between routes, controllers, and views (and how they connect to each other).

So, I've got my controller with the `index`,`show`,`new`,`create`,`destroy` methods. And the corresponding

```
GET    /entries(.:format)                     entries#index
POST   /entries(.:format)                     entries#create
GET    /entries/new(.:format)                 entries#new
GET    /entries/:id/edit(.:format)            entries#edit
GET    /entries/:id(.:format)                 entries#show
PUT    /entries/:id(.:format)                 entries#update
DELETE /entries/:id(.:format)                 entries#destroy 
```

How come if I add a new method `vote_up` or `vote_down`, for example, and the views with matching action names, it doesn't work.

1) What is the proper way to add new actions and connect them to views? 2) *Bonus* What is the proper way to make these methods ajax-compatible (render a partial with ajax)? What happens if the user doesn't have js enabled?

*I may expand/evolve this question based on the answers I get.*

I'm tired of googling things like *custom action route rails* and the like to hodge-podge my apps. It's draining and poor form and I'm finally getting to the level to comprehend the lingo--I've been self taught 100%...so please try to be understanding if you can for a young padawan.

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-20T02:49:09.710

从一开始就是这样想的：

**1) 您的应用程序所做的唯一一件事就是响应 HTTP 请求。**

最典型的请求类型是：

*   GET - 用户在浏览器的 URL 栏中输入内容并点击回车。

*   POST - 用户提交表单。

还有其他类型的 HTTP 请求，最重要的是 PUT、PATCH 和 DELETE。Rails 遵循 REST 模式，这意味着它为这些 HTTP 动词分配了特定的含义。

**2）当任何请求进入您的应用程序时，必须将其路由到控制器操作。**

您的`routes.rb`文件是 Rails 路由器 (ActionDispatch) 的一组指令，它告诉路由器将请求发送到哪里。“标准”rails 资源作为快捷方式给出，如下所示：

```
resources :things 
```

这意味着以下内容：

```
GET /things => things#index

GET /things/:id => things#show

GET /things/new => things#new

GET /things/edit/:id => things#edit

POST /things => things#create

PUT /things/:id => things#update

DELETE /things/:id => things#destroy 
```

这些被认为是标准的 RESTful 操作 - 您的`resources :things`声明没有设置其他任何内容。因此，如果您希望控制器执行其他非标准操作，则必须手动添加它们。

如果要对特定记录执行操作，最好的方法是使用：

```
resources :things do
  member do
    get 'vote_up'
  end
end 
```

这告诉路由器，如果有人向它发出 GET 请求`/things/123/vote_up`，它应该触发该`ThingsController` `vote_up`操作。

[所有这些都在Rails 指南](http://guides.rubyonrails.org/routing.html#adding-more-restful-actions)中详细说明，您应该阅读整个内容。

**3）您的控制器的工作是发送对请求的响应。**

通常这意味着从数据库中加载一条记录并呈现该记录的视图。

每个控制器操作都通过将响应发送回传入请求来结束。这个响应可以是一个`render`调用——这意味着以某种格式发回一些数据——或者一个`redirect`调用——它基本上为你提出一个新的请求，因此你得到另一个请求的响应。

在 Rails 中，重定向实际上是将请求发送到不同的控制器操作。

Render 调用发送数据作为对请求的响应。

当您调用 时`render :new`，这是 的快捷方式`render :template => :new`，它加载`app/views/things/new.html.erb`（或其他）模板，将来自控制器（通常是您的实例变量）的数据发送给它，并使用模板语言（erb、haml 等）对其进行评估。这导致一大串 HTML，然后控制器将其传递给浏览器。

想亲眼看看这是什么？尝试用 结束控制器`render :text => 'Hello World'`，甚至：

```
render :inline => '<!DOCTYPE html><head><title>Inline Wow!</title></head><body>Mind blown.</body></html>' 
```

走着瞧吧。

响应（呈现）时，您可以发送“普通”HTML 模板，其中包含整个页面的信息（头部、正文等），或者 Ajax 使用的部分信息。您还可以发送原始数据，例如 JSON 或 XML。它实际上只是文本，并且根据该文本的内容（以及随之而来的 HTTP 标头），浏览器、脚本或客户端应用程序会相应地处理它。

再次，请参阅[Rails 指南](http://guides.rubyonrails.org/layouts_and_rendering.html#using-render)。

**4) 当浏览器发出请求时，您可能想要发回 HTML。如果请求是由 Ajax 发出的，您可能想要发回 JSON。**

对于像您这样的自定义操作，`vote_up`您可能根本不想显示模板，而只是重定向。所以，你可能有这样的事情：

```
ThingsController < ApplicationController

  def vote_up
    @thing = Thing.find(params[:id])
    @thing.vote_up
    redirect_to @thing
  end

end 
```

现在，路由器的好处之一是它会为您提供 URL 助手。如果您已经创建了如前所示的路由和操作，那么在您的“show thing”页面上，您可能会有这样的 URL：

```
link_to 'Vote up this thing!', vote_up_thing_path(@thing) 
```

这将创建一个到 的链接`things/123/vote_up`，如果有人单击它，它将在 上的`vote_up`操作中运行代码`ThingsController`，然后重定向回显示事物视图。

**5) 您的模板使用链接和表单向控制器发送消息。链接发出 GET 请求，表单发出 POST 请求。**

如果你想开始有 AJAX 请求，那很好。在这种情况下，您只需要在 Javascript 中发出请求并处理响应。因此，例如，您可以在模板中添加如下内容：

```
= link_to 'Vote up this thing', vote_up_thing_path(@thing), :id => 'vote-up-button' 
```

然后在 Javascript（使用 jQuery）中，你可以有这样的函数：

```
$(function(){
  $('a#vote-up-button').click( function(event){
    event.preventDefault();
    $.ajax({
      url: this.attr('href'),
      type: 'GET',
      success: function(){...},
      error: function(){...}
    });
  });
}); 
```

在这种情况下，jQuery Ajax 方法只是发出一个 get 请求，然后根据它得到的响应运行一个回调函数。

**6) 你的控制器/路由的结构不会影响你可以发出什么样的请求，只有什么动作会响应什么 URL 上的什么 HTTP 方法。**

您在控制器操作中执行的操作决定了您是否准备好响应 javascript 或 html 请求等。

虽然 rails 确实能够在单个控制器操作中处理多种请求格式，但使用`respond_to`块，出于实用性的考虑，我发现当您选择让路由仅响应一种或另一种格式时，事情会更加顺利。

IE：我会让你的正常页面加载请求（索引、显示、新建、编辑）只是 HTML 请求，然后我会让你想要添加的任何其他 AJAX 操作仅是 Javascript —— 即。他们用 JSON 而不是 HTML 来响应。当然，您不必这样做，但如果这样做，您的生活会更轻松。

我希望这能让您更清楚地了解您的应用程序中发生了什么。欢迎使用 Rails，您正在加入一个很棒的社区！

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-20T02:06:58.260

欢迎来到 ROR 世界。:)

路由、控制器和视图协同工作以将 HTTP 请求转换为某种类型的响应（无论是 HTML、JSON 还是 XML）。每个都攻击不同的问题。

从最后开始，`views`是 rails 世界中的模板，它们通常是[ERB](http://ruby-doc.org/stdlib-2.0/libdoc/erb/rdoc/ERB.html)。ERB 只是一个模板系统，其他的也可以使用，比如[haml](http://haml.info/)。他们的工作是获取控制器提供给他们的一些数据并生成格式化输出，通常是 HTML、JSON 或 XML。

但是你怎么知道为一个特定的请求渲染哪个视图呢？您如何将数据放入您的视图中，以便它可以完成您需要的所有花哨的动态内容？这就是控制器的用武之地。 `Controllers`是 ruby​​ 类，其工作是检查已*解析*的HTTP 请求和任何相关参数，从数据库（或任何地方）获取数据，然后将该数据传递给视图。一个控制器通常会有几个不同的方法，每个方法对应一个不同的任务（例如创建、显示、更新等）。

最后，`Routes`是用于解析 HTTP 请求并将解析的 HTTP 请求分派到特定控制器方法的 DSL。它们是 Rails 用来将 URL 路由到方法的粘合剂，因此得名`routes`.

关于您的具体问题：

1）要创建一个新动作，你必须添加一个路由、一个控制器方法和一个视图。因此，例如，如果您想计算您的条目数，您可以添加如下路线：

```
get '/entries/count' => "entries#count" 
```

这告诉 ROR 在收到该 URL 时调用控制器`count`中的方法。`entries`在这种情况下，您的控制器方法将很简单，例如：

```
def count
   @cnt = Entries.count
end 
```

最后，您将在其中创建一个视图，`app/views/entries/count.html.erb`其中包含以下内容：

```
<p>Count: <%= @cnt %></p> 
```

2) Ajax 兼容代码实际上只是一种询问“如果此请求的请求格式是 JSON 怎么办？”。为此，您需要使用`respond_to`方法。在某种程度上，respond_to 是一种指定*不同视图*来处理请求格式的正式方式。要继续上面的示例，您可以执行以下操作：

```
def count
  @cnt = Entries.count
  respond_to do |fmt|
    fmt.html # This just renders the default template
    fmt.json { render json: { count: @cnt } }
  end
end 
```

Nb - 以上所有代码都是徒手的。:)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-20T02:02:45.027

如果你有 RESTful 控制器：

```
resources :entries do
  collection do
    get :vote_down
    get :vote_up
  end
end 
```

这将生成 2 个额外的路线：

```
GET    /entries/:id/vote_up(.:format)                 entries#vote_up
GET    /entries/:id/vote_down(.:format)               entries#vote_down 
```

您可以轻松地将 HTTP 方法更改为 GET、POST、PUT 和 DELETE。

此外，请检查路线文档中的“[添加更多 RESTful 操作](http://guides.rubyonrails.org/routing.html#adding-more-restful-actions)”。

# kdb - 如何在 kdb 中生成不包括周末的日期范围？

> ID：16115648
> 
> 赞同：5
> 
> 时间：2013-04-20T01:41:03.243
> 
> 标签：kdb

此代码生成一系列日期：

```
firstdate: 2008.06.01
lastdate: 2008.08.31
daterange: firstdate + til (lastdate - firstdate) + 1 
```

是否可以生成不包括周末日期（周六/周日）的相同范围？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-20T03:03:31.307

```
q)daterange where not (daterange mod 7) in 0 1 
2008.06.02 2008.06.03 2008.06.04 2008.06.05 2008.06.06 2008.06.09 2008.06.10 ..
q) 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-04-20T17:44:58.707

更容易做 `daterange where 1<daterange mod 7`

# php - PHP contact form emails to the email address, but 'name' field is empty?

> ID：16115649
> 
> 赞同：0
> 
> 时间：2013-04-20T01:41:04.307
> 
> 标签：php, html, forms

No, I am new to this form!

I have successfully set up a contact form page. It emails me the 'email address' and 'message' from the form fields, but does not send the name filed value, it is just blank.

I cannot see where I have gone wrong. All the field names match up to the PHP file. Any ideas as to what I'm doing wrong?

Here is my code:

```
 <form id="form_28" name="website_query" action="mailform2.php" accept-charset="UTF-8" method="post" target="_self" enctype="multipart/form-data" style="margin:0;position:absolute;left:231px;top:242px;width:343px;height:229px; /*MainDivStyle*/" __AddCode="here">
<!--MainDivStart-->

<!-- HTML Frame - name txt_31 -->

<!--Preamble-->
<div style="position:absolute;left:8px;top:8px;width:51px;height:18px;overflow:hidden; /*BorderDivStyle*/" __AddCode="InsideBorderDiv">
<!--BorderDivContents-->
<p class="Wp-Body-P"><label for="edit_1"><span class="Body-C">name</span></label></p>
</div>
<!--Postamble-->

<!-- Form Edit box edit_1 -->

<!--Preamble-->
<input type="text" id="edit_1" name="name" value="" style="position:absolute; left:103px; top:8px; width:50px; /*Tag Style*/" __AddCode="here">
<!--Postamble-->

<!-- HTML Frame - email txt_32 -->

<!--Preamble-->
<div style="position:absolute;left:8px;top:38px;width:51px;height:18px;overflow:hidden; /*BorderDivStyle*/" __AddCode="InsideBorderDiv">
<!--BorderDivContents-->
<p class="Wp-Body-P"><label for="edit_19"><span class="Body-C">email</span></label></p>
</div>
<!--Postamble-->

<!-- Form Edit box edit_19 -->

<!--Preamble-->
<input type="text" id="edit_19" name="email" value="" style="position:absolute; left:103px; top:38px; width:50px; /*Tag Style*/" __AddCode="here">
<!--Postamble-->

<!-- HTML Frame - message txt_33 -->

<!--Preamble-->
<div style="position:absolute;left:8px;top:68px;width:79px;height:18px;overflow:hidden; /*BorderDivStyle*/" __AddCode="InsideBorderDiv">
<!--BorderDivContents-->
<p class="Wp-Body-P"><label for="text_2"><span class="Body-C">message</span></label></p>
</div>
<!--Postamble-->

<!-- Text Area text_2 -->

<!--Preamble-->
<textarea id="text_2" name="message" rows="2" cols="10" style="position:absolute; left:103px; top:68px; width:100px; height:38px; /*Tag Style*/" __AddCode="here"></textarea>
<!--Postamble-->

<!-- HTML Frame - captcha txt_34 -->

<!--Preamble-->
<div style="position:absolute;left:8px;top:114px;width:69px;height:18px;overflow:hidden; /*BorderDivStyle*/" __AddCode="InsideBorderDiv">
<!--BorderDivContents-->
<p class="Wp-Body-P"><label for="captcha_1"><span class="Body-C">captcha</span></label></p>
</div>
<!--Postamble-->

<!-- Form CAPTCHA captcha_1 -->

<!--Preamble-->
<div style="position:absolute;left:103px;top:114px;width:190px;height:69px; /*MainDivStyle*/" __AddCode="here">
<!--MainDivStart-->
    <img src="http://www.serifwebresources.com/util/img_verify.php?gen_word=1&id=captcha_1"><br><input type="text" id="captcha_1" name="captcha_1" size="20" __AddCode="here">
    <a title="Listen to audio CAPTCHA" href="http://www.serifwebresources.com/util/audio/audio.php"><img alt="Listen to audio CAPTCHA" style="vertical-align: middle" src="http://www.serifwebresources.com/media/icons/audio-desc.png" border="0"></a><!--MainDivEnd-->
</div>
<!--Postamble-->

<!-- Form Button butn_4 -->

<!--Preamble-->
<input type="submit" style="position:absolute; left:8px; top:191px; width:81px; height:22px; /*Tag Style*/" value="Submit" __AddCode="here">
<!--Postamble-->
</form> 
```

code for PHP (mailform2.php):

```
 <?php 
$errors = '';
$myemail = 'myemail';//<-----Put Your email address here.
if(empty($_POST['name'])  || 
   empty($_POST['email']) || 
   empty($_POST['message']))

$name = $_POST['name']; 
$email = $_POST['email']; 
$message = $_POST['message']; 

if( empty($errors))
{
    $to = $myemail; 
    $email_subject = "Website Query: $name";
    $email_body = "You have received a new message. ".
    " Here are the details:\n Name: $name \n Email: $email \n Message \n $message"; 

    $headers = "From: $myemail\n"; 
    $headers .= "Reply-To: $email";

    mail($to,$email_subject,$email_body,$headers);
    //redirect to the 'thank you' page
    header('Location: contact-form-thank-you.html');
} 
?> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-20T01:56:15.273

```
if(empty($_POST['name'])  || 
   empty($_POST['email']) || 
   empty($_POST['message']))

$name = $_POST['name']; 
```

在上面的代码中，如果名称、电子邮件和消息的帖子为空，则设置 name = $_POST['name'];

SO $name 变量未设置。

所以像这样的代码

```
 if(empty($_POST['name'])  || 
           empty($_POST['email']) || 
           empty($_POST['message'])) {
        $errors = 'Please enter all required fields';
    }
    else
    {
     $name = $_POST['name']; 
     $email = $_POST['email']; 
     $message = $_POST['message'];
   } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-20T01:58:22.357

`value=''`如果您提交，请尝试删除

```
<input type="text" id="edit_1" name="name" style="position:absolute; left:103px; top:8px; width:50px; /*Tag Style*/" __AddCode="here"> 
```

看看它是否有效！

## *编辑和添加*

将 sumbit 的`value`名称更改为：`name='submit'`

```
<input type="submit" style="position:absolute; left:8px; top:191px; width:81px; height:22px; /*Tag Style*/" name="submit" __AddCode="here"> 
```

你可能想改变 php 部分看起来像这样：

```
<?php
$errors = '';
$myemail = 'myemail';//<-----Put Your email address here.

$name    = $_POST['name'];
$email   = $_POST['email'];
$message = $_POST['message'];

if(isset($_POST['sumbit']) && (
    empty($_POST['name'])  ||
    empty($_POST['email']) ||
    empty($_POST['message'])))
    {
        echo "Please fill up the fields";
    }
    elseif(isset($_POST['sumbit']) && empty($errors)){
    $to = $myemail;
    $email_subject = "Website Query: $name";
    $email_body = "You have received a new message. ".
    " Here are the details:\n Name: $name \n Email: $email \n Message \n $message";

    $headers = "From: $myemail\n";
    $headers .= "Reply-To: $email";

    mail($to,$email_subject,$email_body,$headers);
    //redirect to the 'thank you' page
    header('Location: contact-form-thank-you.html');
}
?> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-20T02:05:09.133

```
if(!isset($_POST['name'])  && !isset($_POST['email']) && !isset($_POST['message'])) {
   $name = $_POST['name']; 
   $email = $_POST['email']; 
   $message = $_POST['message']; 
}else{
   $errors = ''; //process
} 
```

添加你的花括号。你错过了你的花括号。因此，如果每个 POST 变量都有值，则不会设置名称变量。另外两个是因为没有大括号，if 语句在第一个语句之后结束。

编辑，我认为你的逻辑也是错误的。您可能想说如果所有这些值都不为空，则处理。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-20T02:07:41.970

好的，我在这里调试，这是更正的工作代码。你必须在那里使用 isset 而不是 empty

```
<?php 

$errors = '';
$myemail = 'myemail';//<-----Put Your email address here.
if(isset($_POST['name'])  || 
   isset($_POST['email']) || 
   isset($_POST['message'])) { 

$name = $_POST['name']; 
$email = $_POST['email']; 
$message = $_POST['message']; 

}

if( empty($errors))
{
    $to = $myemail; 
    $email_subject = "Website Query: $name";
    $email_body = "You have received a new message. ".
    " Here are the details:\n Name: $name \n Email: $email \n Message \n $message"; 

    $headers = "From: $myemail\n"; 
    $headers .= "Reply-To: $email";

    //redirect to the 'thank you' page
    header('Location: contact-form-thank-you.html');
} 

?> 
```

我还介绍了 if 循环，您可以将邮件发送代码也放在 if 循环中

希望这可以帮助

# javascript - Javascript需要从数组中的函数中提取值

> ID：16115652
> 
> 赞同：0
> 
> 时间：2013-04-20T01:41:54.270
> 
> 标签：javascript, mootools

这是我的代码：

```
 <script>
window.addEvent('domready', function(){

    new Request.Stocks({
        stocks: ['SXCL'],
        onComplete: function(yahoo){
            var result = '';
            Array.each(Array.from(yahoo.query.results.quote), function(quote){
result += '<div class="company-ticks"></div>
<span class="company">Steel Excel ({Name})</span>
<span class="sub-info"> - OTC Markets<span> </div>  <div><span class="value">
{LastTradePriceOnly}</span><span class="changeup">
<img src="change-up.gif" class="change-img" />{Change} 
({ChangeinPercent})</span></div></div>'.substitute(quote);
            }, this);

            $('stocks').set('html', result);
        },
        onRequest: function(script){
            $('stocks').set('text', 'Loading...');
        }
    }).send();

    // Request.Stocks.element.js

});

</script> 
```

你看我在哪里有变量 {Change]。我需要确定这个变量是正值还是负值。如果是肯定的，那么它应该将类显示为“changeup”，并将图像显示为 change-up.gif。如果值为负，则显示的类应为“changedown”，图像为 change-down.gif

图像是向上的绿色箭头和向下的红色箭头。这些类使颜色在红色和绿色之间交替。

因为这是在使用函数调用的数组中，所以我不知道该怎么做。我想我必须将我的“结果”分成 3 个部分。前面的部分，设置类和图像的部分，然后是结果的其余部分。

任何帮助，将不胜感激。

这使用带有 mooTools 的 Javascript。它正在从雅虎获取股票报价。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-20T06:35:16.190

我假设`Change`变量是`quote`对象的属性。否则，这在下面的代码中很容易解决。

```
Array.each(Array.from(yahoo.query.results.quote), function (quote) {
    quote.changeImage = (quote.Change > 0) ? 'change-up.gif' : 'change-down.gif';

    result += '<div class="company-ticks"></div>
<span class="company">Steel Excel ({Name})</span>
<span class="sub-info"> - OTC Markets<span> </div>  <div><span class="value">
{LastTradePriceOnly}</span><span class="changeup">
<img src="{changeImage}" class="change-img" />{Change} 
({ChangeinPercent})</span></div></div>'.substitute(quote);
}, this); 
```

请注意，在您正在执行的操作中生成 HTML 有点冒险且难以维护。

# .htaccess - Redirection of subdirectory to totally new domain

> ID：16115653
> 
> 赞同：0
> 
> 时间：2013-04-20T01:42:02.250
> 
> 标签：.htaccess, redirect, migration, http-status-code-301

I've got a site merge that's a little confusing.

The old site lived at: oldsite.com/Subdirectory

The new site lives at: newsite.com/

I'm unsure as where to put my .htaccess 301 redirects. Do I put them in the sub-directory of oldsite.com/Subdirectory? Or do I just add them to the root .htaccess for oldsite.com/

I *think* that I could just make this happen in the oldsite.com .htaccess file:

```
RedirectMatch 301 ^/Subdirectory/(.+)$ http://www.newsite.com/$1 
```

I tried that above and it's not working. Thanks for the help!

(Both sites are hosted by Dreamhost, if that matters at all.)

Thanks!

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-20T02:12:45.713

弄清楚了。

起初我保留了子目录并在其中放置了一个 .htaccess 文件说：

```
RewriteEngine On
RewriteRule ^(.*)$ http://newsite.com/$1 [R=301,L] 
```

但是后来在论坛中发现我可以这样做：

```
RedirectMatch 301 /Subdirectory(.*) http://newsite.com$1 
```

希望对其他人有帮助！

# javascript - How to exclude JQuery/Javascript fade in & out function on certain links?

> ID：16115655
> 
> 赞同：1
> 
> 时间：2013-04-20T01:42:40.170
> 
> 标签：javascript, jquery, fadein, fadeout

I'm using this fade in and out JQuery/Javascript effect on my site to have each page fade in and out when a link is clicked. It's working great when the link that is clicked leads to a different page, but it is causing problems when the link leads to a different part of the page (such as my back to top link), when a mailto link is clicked, and when a link that is suppose to open up in a new page or tab is clicked. When these type of links are clicked they just lead to a blank white page because they don't lead to a new page. Here is the script:

```
$(document).ready(function() {

    //Fades body
    $("body").fadeIn(1500);

    //Applies to every link
    $("a").click(function(event){
        event.preventDefault();
        linkLocation = this.href;
        $("body").fadeOut(1000, redirectPage);      
    });

    //Redirects page
    function redirectPage() {
        window.location = linkLocation;
    }
}); 
```

Because of this I'm trying to figure out if there is a way where I can exclude this fade in/out function from certain links (such as the back to top link), but I don't know how to do it. I know that rather than set all the links to fade in/out I can set the fade in/out effect to a specific class that way it doesn't effect every link. However because the site is rather large, it would be extremely tedious and difficult to add that class to every link. So rather than do that I'm wondering if theres a way to define a no-fade class that would exclude this fade in/out function? That way I could apply that class to these few links that are having problems and make those links behave normally.

It seems like a simple thing to do, but because I'm still not very fluent in javascript/jquery I don't know how to do it. Any help would be much appreciated!

*EDIT: Here is the solution incase anybody else has a similar issue. Thanks to David for the missing piece!

```
$(document).ready(function() {

    //Fades body
    $("body").fadeIn(1500);

    //Applies to every link EXCEPT .no-fade class
    $("a").not(".no-fade").click(function(event){
        event.preventDefault();
        linkLocation = this.href;
        $("body").fadeOut(1000, redirectPage);      
    });

    //Redirects page
    function redirectPage() {
        window.location = linkLocation;
    }
}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-20T01:49:39.833

是的，您确实可以定义一个类，该类在应用于锚点时会将其排除在执行淡出和重定向之外。

因此，如果您有一个锚点，您希望应用默认的淡出行为，那么只需将其保持原样。如果您不想要这种行为，那么您可以应用一个类（我们称之为 *no-fade"）到锚点。

**HTML**

```
<a href="http://mysite.com/anotherPage">Another page</a>
<a href="http://mysite.com#backToTop" class="no-fade">Back to top</a> 
```

**jQuery**

```
<script type="text/javascript>

    $(document).ready(function() {

        $("body").fadeIn(1500);

        $("a").not(".no-fade").click(function(event){
            event.preventDefault();
            linkLocation = this.href;
            $("body").fadeOut(1000, redirectPage);      
        });

        // Redirects page
        function redirectPage() {
            window.location = linkLocation;
        }
    });

</script> 
```

我从您的代码中编辑的唯一内容是选择了我更改的锚点：

```
$("a") 
```

至

```
$("a").not(".no-fade") 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-20T01:49:23.747

*不显眼*的方法是查找井号 ( `#`) 或`mailto:`等，以防止这些类型的链接淡出：

[工作小提琴](http://jsfiddle.net/qJrte/7/)

```
$("a").click(function (event) {
    event.preventDefault();
    linkLocation = $(this).attr('href');
    if(linkLocation.indexOf('#') != -1 || linkLocation.indexOf('mailto:') != -1)
    {redirectPage();}
    else if($(this).attr('target') && $(this).attr('target').indexOf('_') != -1) window.open(linkLocation);
    else $("body").fadeOut(1000, redirectPage);
}); 
```

还有，`linkLocation = this.href`应该`linkLocation = $(this).attr('href')`

# c++ - Is this function really tail-recursive?

> ID：16115657
> 
> 赞同：1
> 
> 时间：2013-04-20T01:43:04.143
> 
> 标签：c++, c, tail-recursion

I read about recursion in *Programming Interviews Exposed* (3rd ed.) where they present the following recursive `factorial` function:

```
int factorial(int n){
    if (n > 1) { /* Recursive case */
        return factorial(n-1) * n;
    } else {     /* Base case */
        return 1;
    }
} 
```

On the bottom of the same page (page 108) they talk about tail-recursive functions:

> Note that when the value returned by the recursive call is itself immediately returned, as in the preceding definition for `factorial`, the function is *tail-recursive*.

But is this really the case here? The last call in the function is the `*` call, so won't this stack frame be preserved (if we don't take compiler optimization into account)? Is this really tail-recursive?

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-20T01:51:22.237

您可以将其重写为尾递归：

```
int factorial(int n){
    return factorial2(n, 1);
}
int factorial2(int n, int accum) {
    if (n < 1) {
       return accum;
    } else {
        return factorial2(n - 1, accum * n);
    }
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-04-20T01:45:26.170

不，它不是尾递归的。返回的结果`factorial(n-1)`仍然必须乘以`n`，这需要`factorial(n)`重新获得控制权（因此要求调用`factorial(n-1)`是调用而不是跳转）。

话虽如此，即使它是尾递归的，编译器仍然可能不会对其进行 TCO。取决于编译器和您要求它执行的优化。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-20T01:45:48.357

引用此链接：[tail recursion using factorial as example](http://c2.com/cgi/wiki?TailRecursion)

```
 factorial(n) {
    if (n == 0) return 1;
    return n * factorial(n - 1);
 }//equivalent to your code

 This definition is NOT tail-recursive since the recursive call to 
 factorial is not the last thing in the function 
 (its result has to be multiplied by n) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-20T01:57:11.027

`Tail Recursive`是递归的一种特殊情况，其中函数的最后一个操作是递归调用。在尾递归函数中，从递归调用返回时没有待执行的操作。您提到的函数不是尾递归，因为有一个挂起的操作，即在递归调用返回时要执行乘法。如果你这样做：

```
 int factorial(int n,int result)
    {
        if (n > 1)
        { /* Recursive case */
             return factorial(n-1,n*result);
        }
        else
        {     /* Base case */
            return result;
        }
    } 
```

将是一个尾递归函数。因为它在从递归调用返回时没有挂起的操作。

# java - Eclipse 靛蓝错误

> ID：16115659
> 
> 赞同：0
> 
> 时间：2013-04-20T01:43:17.150
> 
> 标签：java

我已经运行 Eclipse Indigo 几个月了，我遇到了一个我似乎无法找到答案的错误。我正在创建一个类似于马里奥、旧塞尔达等的小型 2d 横向卷轴游戏。

我打算向我父亲展示我在程序中添加的新功能。我父亲没有上楼在我的电脑上查看我的程序，而是决定他可以使用我不确定的 sudo 屏幕查看工具进入它。这个我们以前用过，基本上它只是让你看到家里另一台电脑的屏幕（在同一个IP接口上），你也可以使用这台电脑。

我不想这样给爸爸看我的节目，所以我叫他上楼来。他做到了，从那时起，eclipse 将不会在您的程序中显示您的 JFrame 内的任何图形。它将显示诸如文字（写在屏幕上）之类的东西，但不会显示任何图形。比如你的背景图片，或者你的角色，或者其他任何东西。我很肯定我的编码没有问题，因为在我父亲进行屏幕查看之前，我已经测试并玩了很多次游戏（我们都在 linux mint 12 上，顺便说一句）。

我认为这个错误与屏幕查看有关。

如果我能得到一些帮助，我会很高兴的。任何都会很棒。谢谢。

***-这已解决********

木板

```
package External;

import java.awt.Graphics;
import java.awt.Graphics2D;
import java.awt.Image;
import java.awt.event.ActionEvent;
import java.awt.event.ActionListener;
import java.awt.event.KeyAdapter;
import java.awt.event.KeyEvent;

import javax.swing.*;

public class Board extends JPanel implements ActionListener, Runnable { 
    Dude p; 
    Image img;    
    Timer time;
    int v = 172;
    Thread animator;

    boolean a = false;
    boolean done2 = false;

    public Board() {
        p = new Dude();
        addKeyListener(new AL());
        setFocusable(true);
        ImageIcon i = new ImageIcon ("/home/clark/Desktop/Swindle_test_background.png");
        img = i.getImage(); 
        time = new Timer (3, this);
        time.start();
    }

    public void actionPerformed(ActionEvent e) {
        p.move();
        repaint(); 
    }
    public void paint(Graphics g) {
        if (p.dy == 1 && done2 == false)
        {
            done2 = true;
            animator = new Thread(this);
            animator.start();
        }
        super.paint(g);
            Graphics2D g2d = (Graphics2D) g;
    if ((p.getX() - 590) % 2400 == 0)
        p.nx = 0;    
    if ((p.getX() - 1790) % 2400 == 0)
        p.nx2 = 0;
            g2d.drawImage(img, 985-p.nx2, 0, null);
            if (p.getX() >= 921)
            g2d.drawImage(img, 985-p.nx, 0, null);
            g2d.drawImage(p.getImage(), 75, v, null);

    }

    private class AL extends KeyAdapter {
        public void keyReleased(KeyEvent e) {
            p.keyReleased(e);
        }
        public void keyPressed(KeyEvent e) {
            p.keyPressed(e);
        }

    }
    boolean h = false;
    boolean done = false;

    public void cycle() {
        if (h == false)
                v--;
        if (v == 125)
                h = true;
        if (h == true && v <= 172 ) {
                v++;
        if (v == 172) {
                    done = true;

        }
    }
}

    public void run() {

        long beforeTime, timeDiff, sleep;

        beforeTime = System.currentTimeMillis();

        while (done == false) {

                cycle();

                timeDiff = System.currentTimeMillis() - beforeTime;
                sleep = 10 - timeDiff;

                if (sleep < 0)
                        sleep = 2;
                try {
                        Thread.sleep(sleep);
                } catch (InterruptedException e) {
                        System.out.println("interrupted");
                }

                beforeTime = System.currentTimeMillis();
        }
        done = false;
        h = false;
        done2 = false;
}

} 
```

老兄

```
package External;

import java.awt.Image;
import java.awt.event.KeyEvent;

import javax.swing.ImageIcon;

public class Dude {
    int x, dx, y, nx2, nx, dy;
    Image Swindle_Man_Right;
    ImageIcon r = new ImageIcon("/home/clark/Desktop/Swindle_Man_Right.png");
    ImageIcon l = new ImageIcon("/home/clark/Desktop/Swindle_Man_Left.png");
    ImageIcon j = new ImageIcon("/home/clark/Desktop/Swindle_Man_Jump.png");

    public Dude() {
        Swindle_Man_Right = l.getImage();
        x = 75;
        nx2 = 685;
        nx = 0;
        y = 172;

}

public void move() {
    x = x + dx;
    nx2 = nx2 + dx;
    nx = nx + dx;
}
public int getX() {
    return x;
}
public int getY() {
    return y;
}

public Image getImage() {
    return Swindle_Man_Right;
}

public void keyPressed(KeyEvent e) {
    int key = e.getKeyCode();
    if (key == KeyEvent.VK_LEFT)
    {               dx = -1;
    Swindle_Man_Right = l.getImage();
            }
    if (key == KeyEvent.VK_RIGHT)
            {dx = 1;
    Swindle_Man_Right = r.getImage();  
            }

    if (key == KeyEvent.VK_UP)
            {dy = 1;
            Swindle_Man_Right= j.getImage();
            }                       }

public void keyReleased(KeyEvent e) {
    int key = e.getKeyCode();

    if (key == KeyEvent.VK_LEFT)
            dx = 0;

    if (key == KeyEvent.VK_RIGHT)
            dx = 0;

    if (key == KeyEvent.VK_UP)
            {dy = 0;
            Swindle_Man_Right= r.getImage();}
            }
} 
```

框架

```
package External;

import javax.swing.*;

public class Frame {

    public Frame() {
        JFrame frame = new JFrame("Swindle [version 0.1.9]");  
        frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
        frame.setSize(700,390); 
        frame.setResizable(false);
        frame.setLocationRelativeTo(null);
        frame.setVisible(true);
    }
    public static void main(String[] args) {
        new Frame();
}

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-20T02:27:24.047

据我所知，您没有在框架中添加任何内容。

在我用自己的图形替换图形后，我能够让它运行......

![在此处输入图像描述](https://i.stack.imgur.com/6l1lg.png)

```
public class Frame {

    public static void main(String[] args) {
        new Frame();
    }

    public Frame() {
        EventQueue.invokeLater(new Runnable() {
            @Override
            public void run() {
                try {
                    UIManager.setLookAndFeel(UIManager.getSystemLookAndFeelClassName());
                } catch (ClassNotFoundException | InstantiationException | IllegalAccessException | UnsupportedLookAndFeelException ex) {
                }

                JFrame frame = new JFrame("Swindle [version 0.1.9]");
                frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);

                // This is kind of important...
                frame.add(new Board());

                frame.setSize(700, 390);
                frame.setResizable(false);
                frame.setLocationRelativeTo(null);
                frame.setVisible(true);
            }
        });
    }
} 
```

虽然我只是快速浏览了代码，但我建议您不要使用`ImageIcon`来加载图像，而是使用[`ImageIO`API](http://docs.oracle.com/javase/tutorial/2d/images/loadimage.html)。除了支持更多的图片格式之外，它在无法加载图片时会抛出更多的错误。

我也会避免使用`KeyListener`有利于[键绑定](http://docs.oracle.com/javase/tutorial/uiswing/misc/keybinding.html)。他们不会遇到同样的焦点问题`KeyListener`

# objective-c - 项目中使用的类

> ID：16115660
> 
> 赞同：0
> 
> 时间：2013-04-20T01:43:24.160
> 
> 标签：objective-c, class, enumerate

有没有一种优雅的方法来获取项目中使用的类列表？

我知道`objc_getClassList(...)`哪个会获取 Objective-C 中的所有类，并且我试图避免使用`class_conformsToProtocol`它来过滤掉类。

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-20T01:59:33.587

在 Xcode 中，按`Cmd`+`2`打开符号导航器，然后按`C`左下角的图标按类过滤。

您可以通过按图标旁边的文档图标进行更多过滤`C`。结果将仅包含项目中定义的类。这是一张带有红色标记的按钮的图片：

![Xcode 符号导航器按类和项目过滤的图片](https://i.stack.imgur.com/hKNNM.png)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-20T03:44:07.157

此代码将在您的运行时搜索以您指定的类前缀开头的每个类并返回它们的名称（已键入但未编译，请注意）：

```
NSArray *AllClassNamesInRuntimeWithPrefix(NSString *myClassPrefix) {
    NSMutableArray *retObj = [NSMutableArray array];

    int nClasses = objc_getClassList(NULL, 0);
    if (nClasses > 0) {
        Class allClasses[] = malloc( nClasses * sizeof(Class) );
        nClasses = objc_getClassList(allClasses, nClasses );

        int i;
        for (i = 0; i < nClasses; i++) {
            NSString *thisClassName = NSStringFromClass( allClasses[i] );
            if ([thisClassName hasPrefix:myClassPrefix]) {
                [retObj appendObject:thisClassName];
            }
        }
        free( allClasses );
    }
    return [NSArray retObj];
} 
```

在运行时搜索*项目*中的每个类有点难度，因为运行时没有“项目”的模式，并且类可以存在于可执行文件或框架中，并且可以随时加载。

# vbscript - VBScript onTimeout 然后函数

> ID：16115665
> 
> 赞同：1
> 
> 时间：2013-04-20T01:45:23.900
> 
> 标签：vbscript, timeout

我有一个使用另一个对象的 VBScript。

有时该对象会卡住。我的 VBScript 代码将挂在该行上，直到它“完成”。当它超时时，我想在 VBScript 关闭之前将 .Close 命令发送到对象。

如何判断我的 VBScript 何时超时？

我知道我可以把 WScript.Timeout = 60

也许像..

```
WScript.Timeout = 5
do while true

loop

sub WScript_timeout()
    msgbox("OK")
end sub 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-20T10:40:48.550

通过设置`Timeout`属性，您可以指示解释器在计时器到期时自动终止脚本。这与使用该选项运行解释器相同，`//T:xx`并且无法从脚本中捕获/处理。你想要的需要异步运行代码的能力，而 VBScript 并不真正支持。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2019-04-09T09:51:33.667

真正的答案（对于“我如何判断我的**VBScript**何时超时？”的问题）是您*不能*. 与几乎所有脚本一样，如果 VBScript 停止运行（因为它已超时），正在运行的线程将*停止*运行，因此它无法报告其状态。

但是有一个解决方案。但是，它需要一些狡猾。

如果您改为运行**批处理脚本**，无论您在何处使用该脚本来启动*新*的批处理脚本（例如**，batch_1.bat**包括这一行：**CALL batch_2.bat**），第二个脚本将运行，但第一个脚本将等待。

第一个脚本的处理一直在等待（在 CALL 处），直到脚本 2 停止运行：此时，控制权返回到脚本 1，该脚本继续执行 CALL 之后的任何代码，该代码可能用于报告脚本的事实2已结束——

```
CALL batch_2.bat
ECHO The batch_2.bat script has stopped running && cmd /k 
```

有一些方法可以启动 batch_2.bat*而不会*导致 batch_1.bat 暂停，直到第二个脚本完成，但它们在这里无关紧要。

理论上，批处理脚本不支持并行处理。VBScript 当然也不是。但是上述技术展示了一种方法，通过这种方法，可以通过一种方式在批处理脚本中实现并行处理——这使得它在 vbScript 上成为*一体*！

.

如果脚本挂起，确定 vbScript 将超时的*一种**方法***是**使用WScript函数在您的 .vbs 文件中，并将**Windows 脚本主机**设置设置为（例如）30 秒后超时 -

 *******一个**。打开“Windows 脚本宿主设置”对话框：

1.  转到：开始 > 运行
2.  在“打开”框中，键入：WSCRIPT
3.  单击“确定”。

**乙**。设置超时，在 WSH 运行时发生：

1.  选择选项：“在指定秒数后停止脚本”。

2.  在“秒”框中，键入要应用于所有脚本的时间限制（默认为 10 秒）。

.

这是一个查找并显示当前**WSH/WScript 超时设置**的函数（如果它显示此设置尚未设置，请设置它） -

```
WScript.Echo("WSH timeout: " + WScript.Timeout); 
```

.

该选项`//T:xx`不能使用，因为它是一个**CScript**函数，在 WScript 中不起作用，因此不能在 .vbs vbScript 文件中使用。

.*****

# visual-studio-2010 - SQL Server Compact 4.0 does not work in VS 2010 SP1

> ID：16115672
> 
> 赞同：2
> 
> 时间：2013-04-20T01:46:00.533
> 
> 标签：visual-studio-2010, sql-server-ce-4

I've installed SQL Server compact 4.0 local database and I've added a database. However, if I try to open my database, an unknown errors occurs.

I tried to restart my VS 2010 after install the SQL Server, but it does not help and I cannot open my database.

How to resolve it?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-20T05:15:28.147

看看下面的[博客](http://erikej.blogspot.in/2011/01/sql-server-compact-40-released.html)

在此博客中，您将看到您需要下载一个额外的工具才能使其与 Visual Studio 2010 一起使用。该工具的链接位于同一博客中（搜索下面的文本），或者您可以使用 Web 平台下载它安装程序。

适用于 SQL Server Compact 4.0 的 Visual Studio 2010 SP1 工具

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-22T10:25:34.997

我没有注意错误消息：“事件日志文件已满”。我刚刚在 Windows 中清理了 eventviewer，一切都好了:)。

我发现了这个[话题](https://stackoverflow.com/questions/407402/troubleshooting-vs-c-sql-server-compact-setup-event-log-file-full-message)：

我刚刚清空了事件日志并再次尝试：

*   Windows-R（“运行”）
*   事件vwr

对于每个事件日志（在左侧窗格中），右键单击并选择“清除所有事件”（如果您愿意，请备份现有日志）

# bash - 在排序脚本中寻找匹配时出现意外的 EOF

> ID：16115675
> 
> 赞同：0
> 
> 时间：2013-04-20T01:46:28.797
> 
> 标签：bash, unix

有人可以在这里协助我的脚本吗，有新鲜眼光的人，已经做了一段时间了。所以：在脚本结束时，我试图启用条件，即如果用户输入单个字母作为输入脚本终止/退出并带有“退出”消息：

```
#!/bin/bash
echo 'Enter file names (wild cards OK)'
read files
for input_source in $files ; do
    if test -f "$input_source" ; then 
        sort $input_source | uniq -c | head -10  
    elif "$input_source" = [a-z] ; then 
       exit
       echo 'Exit' 
   fi
done 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-20T01:50:28.530

您有一个未终止的字符串文字：

```
elif "$input_source = [a-z] ; then  # where's the end? 
```

此外，一旦你修复它，它仍然无效。您可能想要使用`test`, `[`, or `[[`，即使那样，`=`也不会这样做。你可能想要这个：

```
elif [[ "$input_source" =~ "^[a-z]$" ]]; then 
```

# java - 具有嵌套参数类的 Jackson Json

> ID：16115677
> 
> 赞同：2
> 
> 时间：2013-04-20T01:47:03.817
> 
> 标签：java, json, jackson

清单：

```
import java.util.List;

public class Listing<T> {
    List<Thing<T>> children;

    public List<Thing<T>> getChildren() {
        return children;
    }

    public void setChildren(List<Thing<T>> children) {
        this.children = children;
    }
} 
```

事物：

```
public class Thing<T> {

    private String type;
    private T data;

    public T getData() {
        return data;
    }

    public void setData(T data) {
        this.data = data;
    }

    public String getType() {
        return type;
    }

    public void setType(String type) {
        this.type = type;
    }
} 
```

关联：

```
public class Link {
    private String author;

    public String getAuthor() {
        return author;
    }

    public void setAuthor(String author) {
        this.author = author;
    }
} 
```

这是一个序列化和反序列化的例子......

```
public static void main(String[] args) throws IOException {
    Link link1 = new Link();
    link1.setAuthor("JohnDoe");

    Link link2 = new Link();
    link2.setAuthor("MaryJane");

    List<Thing<Link>> things = new ArrayList<Thing<Link>>();

    Thing<Link> thing1 = new Thing();
    thing1.setData(link1);
    thing1.setType("t3");

    Thing<Link> thing2 = new Thing();
    thing2.setData(link2);
    thing2.setType("t3");

    things.add(thing1);
    things.add(thing2);

    Listing<Link> listing = new Listing<Link>();
    listing.setChildren(things);

    Thing<Listing> thing = new Thing<Listing>();
    thing.setType("listing");
    thing.setData(listing);

    File jsonFile = new File("src/testMap.txt");
    ObjectMapper mapper = new ObjectMapper();
    mapper.writeValue(jsonFile, thing);

    //String jsonString = "{\"type\":\"listing\",\"data\":{\"children\":[{\"type\":\"t3\",\"data\":{\"author\":\"JohnDoe\"}},{\"type\":\"t3\",\"data\":{\"author\":\"MaryJane\"}}]}}";
    JavaType jsonType = mapper.getTypeFactory().constructParametricType(Thing.class, Listing.class);
    Thing<Listing> readThing = mapper.readValue(jsonFile, jsonType);

} 
```

我遇到的问题是上面示例代码中清单中包含的事物没有使用 Link 参数化，因此它们的数据字段作为对象返回（实际上是 LinkedHashMap）。

我希望能够做这样的事情：

```
List<Thing<Link>> readListingChildren = readThing.getData().getChildren();
String author = readListingChildren.get(0).getData().getAuthor(); 
```

我的问题是，我将如何使用 Jackson json 让它工作？

注意：Things 会包含多种不同类型的对象，一个 Thing 的数据成员的类型由数据对象的“type”字段定义（或应该定义），使用字符串如 t1、t2、t3 等映射到不同的类。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-20T12:25:43.230

实现类似的序列化字符串

```
{
    "data":{
        "type":"listing",
        "children":[
            {
                    "data":{
                    "type":"t3",
                    "author":"JohnDoe"
                }
            },
            {
                "data":{
                    "type":"t3",
                    "author":"MaryJane"
                }
            }
        ]
    }
} 
```

并使用这些`type`信息正确反序列化您可能使用的具体类

```
@JsonTypeName("listing")
public class Listing<T> {
    List<Thing<T>> children;

    public List<Thing<T>> getChildren() {
        return children;
    }

    public void setChildren(final List<Thing<T>> children) {
        this.children = children;
    }
} 
```

* * *

```
public class Thing<T> {
    private T data;

    @JsonTypeInfo(use = JsonTypeInfo.Id.NAME, include = JsonTypeInfo.As.PROPERTY, property = "type")
    @JsonSubTypes({
      @JsonSubTypes.Type(Link.class),
      @JsonSubTypes.Type(Listing.class)
    })
    public T getData() {
        return data;
    }

    public void setData(final T data) {
        this.data = data;
    }
} 
```

* * *

```
@JsonTypeName("t3")
public class Link {
    private String author;

    public String getAuthor() {
        return author;
    }

    public void setAuthor(final String author) {
        this.author = author;
    }
} 
```

# java - 两个整数乘积的模

> ID：16115682
> 
> 赞同：2
> 
> 时间：2013-04-20T01:47:50.193
> 
> 标签：java, c, math, modulus

我必须找到c，

c = (a*b) mod m

a,b,c,m 是 32 位整数。但是 (a*b) 可以超过 32 位。我试图找出一种计算 c 的方法，而不使用 long 或任何 > 32 位的数据类型。

有任何想法吗？

如果 m 是素数，事情可以简化吗？

注意：根据一些评论，

c = ((a mod m) * (b mod m)) mod m，但在我的情况下，即使这个乘法也会溢出

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-20T08:12:59.840

我碰巧有这个 256 x 128 位除法代码和基于随机的测试，我相信你可以将它简单地减少到 128 x 64 位除法，然后减少到 64 x 32：

```
#include <limits.h>
#include <stdio.h>
#include <stdlib.h>
#include <time.h>

typedef unsigned long long uint64;

#define C_ASSERT(expr) extern char CAssertExtern[(expr)?1:-1]
C_ASSERT(sizeof(uint64) * CHAR_BIT == 64);

void mul64full(uint64 prod[2], uint64 a, uint64 b)
{
  uint64 p0, p1, p2, p3;

  p0 = (a & 0xFFFFFFFF) *
       (b & 0xFFFFFFFF);

  p1 = (a & 0xFFFFFFFF) *
       (b >> 32);

  p2 = (b & 0xFFFFFFFF) *
       (a >> 32);

  p3 = (a >> 32) *
       (b >> 32);

  prod[0] = p0;
  prod[1] = p3;

  if ((p1 << 32) > 0xFFFFFFFFFFFFFFFFULL - prod[0])
    prod[1]++;
  prod[0] += p1 << 32;
  prod[1] += p1 >> 32;

  if ((p2 << 32) > 0xFFFFFFFFFFFFFFFFULL - prod[0])
    prod[1]++;
  prod[0] += p2 << 32;
  prod[1] += p2 >> 32;
}

void mul128short(uint64 prod[2], const uint64 a[2], const uint64 b[2])
{
  uint64 p0[2], p1[2], p2[2];

  mul64full(p0, a[0], b[0]);
  mul64full(p1, a[0], b[1]);
  mul64full(p2, a[1], b[0]);

  prod[0] = p0[0];
  prod[1] = p0[1] + p1[0] + p2[0];
}

int lessThan128(const uint64 a[2], const uint64 b[2])
{
  return (a[1] < b[1]) || ((a[1] == b[1]) && (a[0] < b[0]));
}

int div256x128(uint64 qr[4], const uint64 dividend[4], const uint64 divisor[2])
{
  int i;

  if (!lessThan128(dividend + 2, divisor))
    return 0; // overflow

  qr[0] = dividend[0];
  qr[1] = dividend[1];
  qr[2] = dividend[2];
  qr[3] = dividend[3];

  for (i = 0; i < 128; i++)
  {
    if (qr[3] >= 0x8000000000000000ULL)
    {
      qr[3] = (qr[3] << 1) | (qr[2] >> 63);
      qr[2] = (qr[2] << 1) | (qr[1] >> 63);
      qr[1] = (qr[1] << 1) | (qr[0] >> 63);
      qr[0] <<= 1;

      if (qr[2] < divisor[0])
        qr[3]--;
      qr[2] -= divisor[0];
      qr[3] -= divisor[1];

      qr[0] |= 1;
    }
    else
    {
      qr[3] = (qr[3] << 1) | (qr[2] >> 63);
      qr[2] = (qr[2] << 1) | (qr[1] >> 63);
      qr[1] = (qr[1] << 1) | (qr[0] >> 63);
      qr[0] <<= 1;

      if (!lessThan128(qr + 2, divisor))
      {
        if (qr[2] < divisor[0])
          qr[3]--;
        qr[2] -= divisor[0];
        qr[3] -= divisor[1];

        qr[0] |= 1;
      }
    }
  }

  return 1;
}

void randfill(void* p, size_t s)
{
  unsigned char* pc = p;
  while (s--)
    *pc++ = rand();
}

int main(void)
{
  int i;

  srand(time(NULL));

  for (i = 0; i < 10000; i++)
  {
    uint64 qr[4], dividend[4], divisor[2];

    // divisor, 64 bits only
    randfill(&divisor[0], sizeof(divisor[0]));
    divisor[1] = 0;

    if (divisor[0] != 0)
    {
      uint64 dividend2[2];

      // dividend, 128 bits only
      randfill(&dividend[0], sizeof(dividend[0]) * 2);
      dividend[3] = dividend[2] = 0;

      // divide
      div256x128(qr, dividend, divisor);

      // test via multiplication and addition
      mul128short(dividend2, qr, divisor);
      if (dividend2[0] + qr[2] < dividend2[0])
        dividend2[1]++;
      dividend2[0] += qr[2];
      dividend2[1] += qr[3];

      printf("0x%016llX%016llX / 0x%016llX = 0x%016llX%016llX:0x%016llX%016llX\n",
             dividend[1], dividend[0], divisor[0], qr[1], qr[0], qr[3], qr[2]);

      if (dividend[0] != dividend2[0] ||
          dividend[1] != dividend2[1])
      {
        printf("0x%016llX%016llX - restored dividend - ERROR\n",
               dividend2[1], dividend2[0]);
        exit(-1);
      }
    }
  }

  return 0;
} 
```

输出减少到 100 次迭代（[ideone](http://ideone.com/jCqxBd)）：

```
0x72238CB3A1A9F5656A1E0F3567E6CE0E / 0xC7F98F34BBA0FAD9 = 0x0000000000000000921DBA985B7AB177:0x000000000000000060D9C93D34382A2F
0xA05F7D3BF45F2CBFF745F1E97EF75A4A / 0x3CBA50635A5A27A9 = 0x0000000000000002A40EC5297059E69F:0x0000000000000000290F7F44A795E253
0xD48C5015950A24AC8C2C5242F098F28C / 0x3D98659426410873 = 0x0000000000000003736258D9691352D7:0x000000000000000005E859D02FBD03F7
0x985CA6ECCF7A9A8D8A029AFDC4029830 / 0xDC572869B7C9EB7C = 0x0000000000000000B10519E30A95B186:0x0000000000000000454594E80D549948
0x13609B86D699ECD9D5EA40A50EE97DA5 / 0x32B4B9B6DF2D66CA = 0x000000000000000061D4B3346F3C56FA:0x00000000000000000C0857D82EB34061
0x91D63DB80153785C458EDFA05C2BE6A5 / 0x4BB93F8121E3DA35 = 0x0000000000000001ED086E53A490EBA9:0x00000000000000000154DC2121A232A8
0xD5E77579A2E69A028A6F1BE52462A6A3 / 0x40C3C80BAF686F29 = 0x00000000000000034D8356E4FA79EAE5:0x00000000000000002A4ACFAD31FABCF6
0xE7289EE59D2EC9B80A671267274F9F1C / 0xA037AC77A5D63AED = 0x0000000000000001715A12BD82C8D05A:0x00000000000000002762B55566F657CA
0xDB5EB523534D10EC26C14D0A21165EAA / 0x70877083B2890E38 = 0x0000000000000001F30F41B77230648F:0x00000000000000003B161DAC42798D62
0xF22BCF06050EB9FAEDA39C433315D3AF / 0x634AA12A63798C7E = 0x00000000000000027061B6CFBDC47CAC:0x00000000000000002CA1B7EEE6E66707
0x6A5F7E6F71DBD32EA8BE5AF85B105730 / 0xACDEA42E034679E0 = 0x00000000000000009D86B0889208F92C:0x0000000000000000A900572AAF6884B0
0x86F664584EA6FE564BEEFE1B41207713 / 0x1D319A3D3E6F6D38 = 0x00000000000000049F7C4B1AC30CB248:0x00000000000000000BDEBA5D7138CF53
0x93D55D3D896F3E6E2E1EF71A01C680C4 / 0x88115750A7F8D137 = 0x00000000000000011622DE3AEA8D6745:0x00000000000000005F3FEF0A1E3DFBF1
0xAE986E3F6A4F484F4E81CF89F9BE32A9 / 0x173AD8E0B4E17B5B = 0x00000000000000078417C63DC58B3E77:0x0000000000000000141D123D47A4D15C
0x5DB95A0D6BD93EE1DF7FAF3668745E88 / 0xC07C0C65E93707AC = 0x00000000000000007CA699C204812C1C:0x0000000000000000BFFBD2C9E371F7B8
0x91FC43AF1DC400E75C8C89D4CB0CC766 / 0x23905F76E2C708A2 = 0x00000000000000041AD8BD6E95B77C6B:0x00000000000000000167C96223DFB3B0
0xD33CD0ECE044630C7857441234B4B3BD / 0xD2ECB5308FFCD581 = 0x000000000000000100613A50243CC975:0x0000000000000000BF01143AB448D6C8
0xCA7D0ABE05B379F37FC540C2F2540DC2 / 0xC511ED4380F000D0 = 0x00000000000000010709E7B22B442D2E:0x0000000000000000A454F0746FCF5862
0x75418582C2C04200CEEEF30B29E21EE6 / 0x622EE6915AAAC16E = 0x000000000000000131BACD4A53406179:0x0000000000000000527DDDC9966203E8
0x82EE158220268F14FDADF6174BC831B9 / 0x6D87F8FFBD7AF5FF = 0x00000000000000013203A1EE685F58F4:0x0000000000000000619862918C6512AD
0xBABC73A5BFC6AFA87BE777C27AF0CA7A / 0x334F8534DA44AE57 = 0x0000000000000003A3AAEC85949B00F6:0x00000000000000001720D365E24442E0
0xEC80AC4404C4CD424ADD78D0AA294A76 / 0x4F06C8F784DAE202 = 0x0000000000000002FE219872DF7C4B95:0x00000000000000001C7F230AFF95294C
0x74AC5B32627EB992D390475D4141954A / 0xBCBB67BA01AB465B = 0x00000000000000009E420C0580D7DBC7:0x000000000000000050FED88BD9810B8D
0xD0FA893E26F8F7C9B7B6346DF979053F / 0x785AF91D6D797129 = 0x0000000000000001BC813A285AA730EE:0x000000000000000029780222319B2121
0x5DED4A9336945FC99AE5C45B6D6A6250 / 0xFCE9DFD374327842 = 0x00000000000000005F12BA510F26C8DF:0x0000000000000000952062F60FB410D2
0xBD6604F3CC1E2F71B1C50F61C92682F5 / 0xB1507D6F7F83E641 = 0x0000000000000001117252CA7EC0A65F:0x0000000000000000076726C74125EAD6
0x8DEAD81C39130DD74AE755543605D7C7 / 0x8553E144F6F3FA63 = 0x0000000000000001107E30EAE9EE45D4:0x00000000000000002C281D730E73CECB
0xB62F71DEE58A89915484BA8DFF66ACBA / 0x70B8C00DFB590908 = 0x00000000000000019DC1EDE4447FF324:0x00000000000000001ED8A84F8856CF9A
0x1164808010FCC683FD5FD742EF1E82E2 / 0x2329D91B9BEF427F = 0x00000000000000007E9F79392CD015F6:0x000000000000000001894BD59B9031D8
0x1F65989C6839C52549A6A367837A8D68 / 0xDE9E265FE8F6EE0A = 0x0000000000000000241ADBD0FB260F42:0x0000000000000000C9B279DBD86298D4
0x01B09EDC67F8390074BF720CE0D4E681 / 0xEBEF93E1DE2F615E = 0x000000000000000001D569310FE86723:0x000000000000000036910723B0FDC4A7
0x43150143A042D09461FCAEE011BF4D2F / 0xE01ECE82FF69E963 = 0x00000000000000004C9FC0D605116CEE:0x000000000000000076790CFC803F8F25
0xA8BC8C145B90657A7FA62D4FC60E8144 / 0x0F175AAB16AA0D3A = 0x000000000000000B2E5C8870D0E697EA:0x0000000000000000076D41A7BEB53440
0xDBB6986137F134E82B2567E7164F8D6B / 0x39E35EFFA049FE5D = 0x0000000000000003CBA4704C8552B329:0x00000000000000000652776CE2D0C986
0xC95308E127E27A40CC2AB361F1D003F1 / 0x30BAF3D3113646FD = 0x000000000000000421A383F06B1DD66E:0x0000000000000000039BD74B637D053B
0xC3D5AF830984D0A89300A5A2D0EBAFFD / 0xDA78B7DC9D00443C = 0x0000000000000000E57983384327721C:0x0000000000000000C4E3AD916D5D816D
0x72F659CA625824C08839118A5F99D382 / 0xFCD33EC00AEBB829 = 0x00000000000000007467EB48186A84B8:0x0000000000000000C6A5E47AE23E520A
0x3015B4708D7B5E031CC52F99C95C5B09 / 0x52705129AD7C7A29 = 0x00000000000000009551C5B192977B2F:0x00000000000000001D95ED27B0A13A82
0x0E1F7B0B03B5DC69EC7F0EE22D9D9103 / 0xF01589C7A2936ED8 = 0x00000000000000000F0F29462804FE9E:0x0000000000000000D04177AE1344D7B3
0xEC3D468251C6746F99D7DE96E6C90D1F / 0x267AB14E499C9AD9 = 0x000000000000000623AF464370A3B267:0x00000000000000000E79D9A7DCF0DDD0
0x324766C3AE8FE518A91C0B89F691D8A8 / 0x473C0E6E2DEFF322 = 0x0000000000000000B4B0B8770B975D14:0x0000000000000000278C077555718000
0x1EEA010641E4FBB7EE6ADF4622A338B4 / 0x7649C1545D840EDB = 0x000000000000000042E78BDEEFA2D348:0x00000000000000001A6FB41E21AA8A1C
0x26CF636EE1F98F9AD6EB622275186021 / 0xBBDC13E0AACC79E6 = 0x000000000000000034E32521D0410AB4:0x00000000000000002FA92BE28D29AE69
0x7A7BE4E0A4F87E8283652261AA454ECA / 0x9B8251B56467B45E = 0x0000000000000000C9A2458FDD775882:0x0000000000000000311B005509E9670E
0x194D9A97CA3475698A2F1BBF94996EDF / 0x35072BD7E15B7473 = 0x00000000000000007A27854605B3DE17:0x0000000000000000012503425AFD3E8A
0xD63E9B6DB46C52F4D8B986F9847ECEAD / 0x9D72392AF8BE4618 = 0x00000000000000015C59F8C79AC088BA:0x00000000000000005D586814B303213D
0xF42EA2FF56E9795D65FB8FB85E1C7F34 / 0x24C1EE0CA7A07210 = 0x0000000000000006A49EF0579168219C:0x000000000000000017B3212D2322ED74
0x924A5235E557A62DF989AEC565EDD758 / 0x4637E63561A89AF4 = 0x0000000000000002155744F31100089E:0x00000000000000002F3BD6DFA70694C0
0xF5F894C7FE0B1939A62B614DE52A67B0 / 0xC9BF16D5CBE833CC = 0x0000000000000001381E0FEF42EC23E6:0x00000000000000006DFA7B799B66FA68
0xBC54C083AE952260AFF7F9FF2E39E958 / 0x6E0125A26FDA4F3A = 0x0000000000000001B647A71AF0D7D071:0x000000000000000053A8E5E784C7D0BE
0xA5371345881C4C88EE129F95A49D7002 / 0x2E96B3F3A1BB5FD9 = 0x00000000000000038BD711431BFF2BE4:0x0000000000000000163D12E3C47B9FBE
0xED919D64A38AC50EE6289DE3FA073006 / 0x6675A78DB953CC35 = 0x000000000000000251939CAFFFB1C284:0x00000000000000001BC552CAEE6CBAB2
0x1F1FF71139CF7455D56C25CE06AF2779 / 0xF6D3ACC12E75ADE9 = 0x0000000000000000204816C1394B681E:0x00000000000000001D4C796EF1FB1E2B
0xE3FB1B8E26AE6958A8B9312FC35D8302 / 0x2F0E544621C3A9BC = 0x0000000000000004D84A89285F567516:0x00000000000000000E22D0A2A6D200DA
0x410856E95F9CB830D95BADD72B9F83E5 / 0x7EC03BC1A01CCA8F = 0x00000000000000008358CE856D657B0A:0x00000000000000005C76947347C1E54F
0xE9F5F4B91B990C446D6DC188EF014D2E / 0x603063D14D68B6BF = 0x00000000000000026EAB5A279B04DF98:0x000000000000000021D3917341A86AC6
0x3F672EFBF9C03A71D13924A3D9F33F07 / 0xA6D751E7964991AC = 0x0000000000000000614908842CC78070:0x000000000000000030AE8F43843983C7
0xF8C19187F058634D7F6F0E77C93626E1 / 0xA0DD50F4F45B003A = 0x00000000000000018BDEEE39534EDFD1:0x00000000000000009899A7EA260C7187
0x7FD9CC315A5C23E293EDBCB24CDE6258 / 0xEA0758B0C7F182CC = 0x00000000000000008BDA913F184CADE0:0x0000000000000000CA19EEBB2F9813D8
0xCA048AE8719D2CBF504D5DF863569FB3 / 0x8EAE31C2B66F312F = 0x00000000000000016A76D09445883B90:0x00000000000000000C53FDE6587D2043
0xF1A862325714D55FB17FC0FEF112CD2E / 0x5C5EFD2DDF2461AD = 0x00000000000000029DBCDFF6149E9460:0x000000000000000059AC2B766E30284E
0x82370123858263879151B962F55B65C8 / 0x7C4067CF7662458E = 0x00000000000000010C494E7DE774E5A7:0x00000000000000006BF1E0862CB00026
0xAE4AD227B9816E578C12F2C496B15DC7 / 0x3BFB82AD09DA4BD7 = 0x0000000000000002E7DD4BD12E902D85:0x00000000000000001A49F830CE032C14
0x9A58A643CB945107FE9FA93764AEB5B6 / 0xA5DB6BCE5834CC35 = 0x0000000000000000EE3BAA824701F858:0x000000000000000093DBD3146D802B7E
0x3CFF433501A48CCA40DD1589383A1E6A / 0xE1EA9EAC3C53D914 = 0x0000000000000000451E9FB6BE32F4B4:0x00000000000000002A779739A4766C5A
0xE05CE3161C060193CDC77463E58AC539 / 0x4E716039D7089394 = 0x0000000000000002DC36829F6DEA09FE:0x00000000000000002CFDECD854902461
0x8C172FF9496884E683FA2149ACB0E973 / 0xD8E1E044A5E1006F = 0x0000000000000000A55B999B02B5B8B5:0x00000000000000001E4D953B7FD0D2F8
0xDAAC01F32907D2E05A22F6E749150705 / 0x7026050046A81D30 = 0x0000000000000001F328DBBBE708E51C:0x00000000000000001E77E203F315E5C5
0xB32B29D3D107DDE9BEC8E2B858BBB357 / 0x750B3A447F231586 = 0x000000000000000187E150D9948EB8D0:0x0000000000000000580C63326C6DE677
0xDF6E9EF5B0D613F77E584427E339EC9E / 0xBAC98934EFDD32FB = 0x000000000000000132392EB5CDD7AB7A:0x000000000000000085ABCAA502F4F800
0x70E4427966EA353F07FC52694289DF0E / 0x9A02DB9F4FB0757B = 0x0000000000000000BBA681F9A127CD04:0x00000000000000003B17F3B474F78A22
0x587602196F06C706C43D26B6A324DA04 / 0xD52A8E594B20BB56 = 0x00000000000000006A3C831F9C1DBA1A:0x00000000000000004B9CAAC798F75748
0xDDC4B4D70076B04AD38C6FCFB745415E / 0xF920A3A3B0BE6137 = 0x0000000000000000E3E2DACC13655973:0x00000000000000004D3FDAADB24076A9
0xBFB7F075E4640514ACC0D34EC7B3AB23 / 0x03EDC2CC944CCA7B = 0x0000000000000030CC7EFAC33315FE5B:0x000000000000000002DDC91DC26AA76A
0xB7850EA2D84ECF8A871CDE6319F1A14D / 0x5D5583E278BF2EA1 = 0x0000000000000001F75D58F861AAD829:0x0000000000000000104585A47C115184
0x19D30C8F4CF0B1E8D7BF478A62F20780 / 0x7A4852D9899BE914 = 0x0000000000000000361050BBA6A2E574:0x000000000000000038FF75771A258670
0xD67CC4EEA505A61BA2B4142239CCCF60 / 0x4334772F7DF221DB = 0x00000000000000033108E073FA69488D:0x00000000000000002E9320CD011791C1
0x8699D56AF72156D5E789058746D11016 / 0x531EF57805226C75 = 0x00000000000000019E8CF4E75D4C2521:0x000000000000000046269F1EEFF82C01
0x8C7B3EB794B4B10C6EE0FC588DDD6214 / 0xD840A863692B9E7B = 0x0000000000000000A64D52F5F26EDEFF:0x000000000000000093CF8DD99921DB8F
0xDCBFDAD051F9D4F96CF696581E56B0BB / 0xED841C71FE839C94 = 0x0000000000000000EDEDB656CBF05C2E:0x00000000000000002AC3B820EFAB5E23
0xCD3D3DD4D1473D7929E7C96EFA445188 / 0x46CEECB24270748B = 0x0000000000000002E6055D0FB8CCCA0B:0x000000000000000032CCDCD39CB5A18F
0xD09684576D9D8EFFA349AD1A03DF2E51 / 0x9CBEDD11E11E3711 = 0x000000000000000154AB87F3F19CF5EA:0x00000000000000002C5BA1ECC43193C7
0x4EB7FC4F14B3A2FAAFC3CB5E260D8015 / 0x2C62DE1A95A1DDC1 = 0x0000000000000001C603BFD8AC6E84DE:0x0000000000000000074354C5F869AEB7
0x4820304E706D821246759231492F522E / 0x9AB151D8E1BB548A = 0x0000000000000000775C480C24C7798D:0x0000000000000000579F64114AC6882C
0xAFB7699C70F40A3FABDBED7D413B2B68 / 0x5A7014CF215CD3D2 = 0x0000000000000001F165630D7BC529B0:0x0000000000000000279134DF8CE2E908
0xA40B7764609C77E35B3CB7F2E247DE12 / 0x26823F543A1F24EC = 0x0000000000000004428AEC3F73053FC3:0x000000000000000022C3FA3735DCAA4E
0x4B3D5C68E220B1F03E69112C438FECEF / 0x55CDCB691E140081 = 0x0000000000000000E07B315ED33F95DF:0x000000000000000008ABEE64F9196790
0x07145917D5EF05A9AC76BDBC20F0F1B7 / 0xD2DCB75038ABD9D4 = 0x000000000000000008984E14ED4515F5:0x0000000000000000576FBDC4D17715D3
0x79D36ED027F8136BD7237A20519D6900 / 0x65BE279172E9340A = 0x00000000000000013288389B33B93E78:0x00000000000000005686822B60789850
0x10B816A5E0F32BC0A28D56A228987B97 / 0x2691631C8A4FC373 = 0x00000000000000006EF9B0E3683A6778:0x000000000000000002EA49293B8398AF
0xBF6D72FFCAE5A828BC10AD25EA1CC2CE / 0x91730B1EF937B029 = 0x000000000000000150ECA60E96E99786:0x000000000000000085FFE8CA42BD5E58
0xA9B05D80F44DD3CF63B70D95259A8A07 / 0xA0525777429F609D = 0x00000000000000010EF523D97E6167AF:0x000000000000000083B23B3A994B53B4
0xCEBC9EFF59E7F2C4C2583ABAB8E86341 / 0xA5C3E00804739505 = 0x00000000000000013F46555CC330626E:0x00000000000000007B23CE99D042711B
0x9D1340D851E89E9730B634EF10700E08 / 0x6C9B7366F2C20971 = 0x0000000000000001723EA5F3B133DFF1:0x000000000000000043DA931B7F08BBA7
0xCAC50533954FFFA63F8F983623FDC3BC / 0x0B01B39932F6FB33 = 0x00000000000000126C26F2199D49C968:0x000000000000000004C39A7E9BE1AC04
0x0A8D31644EA2CC187FCF54C2C4530F2A / 0x21192FEE7C1CADA3 = 0x0000000000000000519C6B55F4BD6EEB:0x0000000000000000054E1CB7F60CA089
0xE26C37CAED68752AA4221B7A01024A13 / 0x862E65E264A0DD30 = 0x0000000000000001AFFC08C0C0FC6210:0x00000000000000005D17FA9067081713
0x4B6BAD20C68B054C8A0302777DD3129B / 0x6F72BE3F67300E03 = 0x0000000000000000AD3E5477E997550C:0x0000000000000000237CF0BDB4266B77
0x82FCD93671D634FA5860E8BDF176FFB2 / 0x0ECFA40BED38D323 = 0x0000000000000008D80913755D8AD21C:0x00000000000000000A9E9182DA2F31DE
0xF9292AFFD1C91713D8A1142692458287 / 0x584AB435FF4987DF = 0x0000000000000002D26F9202488D82E9:0x000000000000000055D41BE953869A90 
```

如果您要使用 x86 程序集，它会简单得多：

```
#include <stdio.h>

unsigned mulmod(unsigned a, unsigned b, unsigned m)
{
  unsigned result = 0;

  __asm
  {
    mov  eax, a
    mov  ebx, b
    mul  ebx // edx:eax = 64-bit product of a*b
    push eax // store away low 32 bits of dividend

    mov  ecx, m
    mov  eax, edx
    xor  edx, edx
    div  ecx // get high 32 bits of quotient
    xchg eax, [esp] // store them on stack, get low 32 bits of dividend
    div  ecx // get low 32 bits of quotient and the remainder
    mov  result, edx
  }

  return result;
}

int main(void)
{
  unsigned a = 4294967231, b = 4294967279, m = 4294967291;
  printf("Assembly:\n(%u * %u) mod %u = %u\n", a, b, m, mulmod(a, b, m));
  printf("Validation:\n(%u * %u) mod %u = %u\n", a, b, m, (unsigned)((unsigned long long)a * b % m));
  return 0;
} 
```

输出（使用 Open Watcom C/C++ 1.9 编译）：

```
Assembly:
(4294967231 * 4294967279) mod 4294967291 = 720
Validation:
(4294967231 * 4294967279) mod 4294967291 = 720 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-12-19T09:01:00.977

看这里：[模块化算法和 NTT（有限域 DFT）优化](https://stackoverflow.com/q/18577076/2521214)

*   这是我仍未回答的问题
*   查找 modmul 成员函数
*   所有模组功能都经过优化和测试...
*   如果您对 asm 有问题，请将其转换为 co C
*   in rems 是关于哪条线做什么的信息，所以应该很容易
*   即使对于非 asm 用户

以上 modmul 实现使用双精度

*   但仍然所有变量都是单精度的
*   所以如果你因为某种原因不能使用它
*   那么你必须坚持使用缓慢的 modadd 循环
*   或二进制 modmul ...仅将 a 乘以 b 的位 ...快得多
*   这会导致使用一些 modadds 和 bitshift 和 bittest 函数遍历所有位

仅对于单精度，我使用类似这样的“模板”代码：

```
_mod_type modadd(_mod_type a,_mod_type b,_mod_type c)
    {
    _mod_type d,cy;
    a=mod(a,c);
    b=mod(b,c);
    d=a+b;
    cy=(shr(a)+shr(b)+shr((a&1)+(b&1)))&_mod_mask;
    if (cy) d-=c;
    if (_mod_type(d)>=_mod_type(c)) d-=c;
    return d;
    }

_mod_type modmul(_mod_type a,_mod_type b,_mod_type c)
    {   // b is not modded !
    int i;
    _mod_type d;
    a=mod(a,c);
    for (d=0,i=0;i<_mod_bits;i++)
        {
        if (_mod_type(a&1)) d=modadd(d,b,c);
        a=shr(a);
        b=modadd(b,b,c);
        }
    return d;
    } 
```

*   _mod_type 是您的变量类型（例如 32 位无符号整数或 DWORD）
*   _mod_bits 是位数常数 (32)
*   _mod_mask 是 msb 位设置常量 (0x80000000)
*   mod(a,b) 是模 a%b
*   shr(a) 是位移 a>>1
*   modadd(a,b,c) 是 (a+b)%c
*   modmul(a,b,c) 是 (a*b)%c

希望能帮助到你...

# php - Joomla 2.5 views - php vs html suffix

> ID：16115692
> 
> 赞同：0
> 
> 时间：2013-04-20T01:49:41.790
> 
> 标签：php, joomla, joomla2.5

I'm looking at a site under development (at my wife's work). It's being built with Joomla 2.5.x, and it's using a Kunena template for the forum.

Each page on the site uses a single URL with PHP variables, e.g. `www.sitename.com/index?option=com_content&view=article&id=96&Itemid=101`.

However, on the [demo site](http://joomla25.cloudaccess.net/using-joomla/extensions/plugins/editors.html), the suffix is always `.html` even though the content is CMS/database-generated.

What I want to know is:

1.  Why does the site at my wife's work use `.php?...`?
2.  Where in the backend administration portal (to which I have access) are the settings for each `view` (presumably using a MVC framework)? Or are they only available by editing the PHP files directly?

Thanks.

**Addendum**

I found [this documentation](http://docs.joomla.org/Developing_a_Model-View-Controller_Component/1.5/Introduction) which helps explain #1\. Still would like an answer to #2.

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-20T22:44:20.660

首先，您不应该直接编辑 Joomla 文件。如果您无法通过设置执行某些操作，请覆盖该文件。您在核心文件中所做的任何更改，除了可能会破坏之外，都会在更新时被覆盖。

在一般设置方面，每个视图都有一个选项按钮，您可以在那里设置组件的默认设置。然后，通常在项目和菜单项中存在覆盖默认值的单独设置。

Kunena 具有更复杂的配置，因此拥有自己完整的 UI。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-20T02:41:10.747

Joomla 具有使用原始网址（您的网站正在使用）或“搜索引擎友好”（SEF）网址的设置。演示站点不仅使用 SEF url，还在末尾添加了 html 后缀。html 对系统来说真的没有任何意义，它就在那里。您可以将其关闭，并且系统将在没有“.html”的情况下运行相同的操作。（我猜位置看起来像文件夹而不是文件。）

如果您访问您的管理系统（很可能是 www.sitename.com/administrator），您可以转到站点-> 全局配置。确保您位于“站点”选项卡上，您应该会在右侧看到 SEO 设置。这些设置将更改演示版本和您自己的版本之间的 url。

要使用 mod_rewrite 位，您可能必须在服务器上将 htaccess.txt 文件转换为 .htaccess：http: [//docs.joomla.org/How_do_you_convert_an_htaccess.txt_file_into_a_.htaccess_file%3F](http://docs.joomla.org/How_do_you_convert_an_htaccess.txt_file_into_a_.htaccess_file%3F)

再补充一点，演示站点的 url 最终会转换回您在妻子工作站点上看到的 url。系统基于 option、view、id 和 Itemid 变量进行操作。SEO 设置将其转换为搜索引擎友好的短语，我认为这对搜索引擎和人们都有帮助！

# java - Android - Wanting to alternate icon images in a listview using cursorLoader

> ID：16115696
> 
> 赞同：0
> 
> 时间：2013-04-20T01:50:26.393
> 
> 标签：java, android, image, cursor

I have an application that displays a listView of contacts sorted by Last, then first names. Beside each contact is an image (icon). There are 3 kinds of contacts for which I'd like to display 3 different images (customers/suppliers/other) I have a default image now that is set to customer. I'm wondering if there's a way using the cusorLoader shown below to alternate images on the fly, or whether it would just be best to add a method involving a cursor in my onResume. (onResume is called each time I need to display the images). I believe simpleCursorAdapter can only take textViews as args, so if it's possible, maybe a compound textview/image would work. My icons are not stored in the database, just in the drawables.

Thanks in advance for any replies.

```
 @Override
  protected void onResume() {
   super.onResume();
   //Starts a new or restarts an existing Loader in this manager
   getLoaderManager().restartLoader(0, null, this);
  }

  /*
   * The fillData method binds the simpleCursorAadapter to the listView.
   */

  private void fillData() {

    String[] from = new String[] { ContactsDB.COLUMN_LAST_NAME, ContactsDB.COLUMN_FIRST_NAME };

    //The XML views that the data will be bound to:
    int[] to = new int[] {R.id.label2, R.id.label};

    getLoaderManager().initLoader(0, null, this);
    adapter = new SimpleCursorAdapter(this, R.layout.contact_row, null, from,
        to, 0);
    setListAdapter(adapter);
  }
  // Sort the names by last name, then by first name
  String orderBy = ContactsDB.COLUMN_LAST_NAME + " COLLATE NOCASE ASC"
  + "," + ContactsDB.COLUMN_FIRST_NAME + " COLLATE NOCASE ASC" ;

  // Creates a new loader after the initLoader () call
  @Override
  public Loader<Cursor> onCreateLoader(int id, Bundle args) {
    String[] projection = { ContactsDB.ROW_ID, ContactsDB.COLUMN_LAST_NAME, ContactsDB.COLUMN_FIRST_NAME };
    CursorLoader cursorLoader = new CursorLoader(this,
    SomeContentProvider.CONTENT_URI, projection, null, null, orderBy);
    return cursorLoader;
  }

  @Override
  public void onLoadFinished(Loader<Cursor> loader, Cursor data) {
    // Swap the new cursor in.
    // (The framework will take care of closing the old cursor once we return.)
    adapter.swapCursor(data); //Call requires Min API 11
  }

  @Override
  public void onLoaderReset(Loader<Cursor> loader) {
    // This is called when the last Cursor provided to onLoadFinished()
    // above is about to be closed.    
    // Data is no longer available, delete the reference
    adapter.swapCursor(null);
  }

} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-20T03:17:25.760

这是我用来在 ListView 上动态显示可绘制对象的代码，您必须在适配器上使用函数 setViewBinder：

```
mAdapter.setViewBinder(new ViewBinder() {
        public boolean setViewValue(View aView, Cursor aCursor, int aColumnIndex) {

            //Modification of the icon to display in the list
            if (aColumnIndex == aCursor.getColumnIndex(DatabaseHandler.RATE_EMOTION)) {
                int emotionID = aCursor.getInt(aColumnIndex);
                Drawable emotionDrawable = resources.getDrawable(R.drawable.ic_unknown_rate);

                //if emotion is set
                if(emotionID > 0){
                    String emotionDrawablePath = "ic_smi" + emotionID;          
                    int emotionDrawableID = resources.getIdentifier(emotionDrawablePath,"drawable", getPackageName());
                    //if a drawable is found
                    if(emotionDrawableID > 0){
                        emotionDrawable = resources.getDrawable(emotionDrawableID);
                    }
                }

                ImageView emotionImage = (ImageView) aView;                 
                emotionImage.setImageDrawable(emotionDrawable);
                return true;
            }

            return false;
        }
    }); 
```

您可以在此示例中看到，我根据从光标获得的每一行的数据更改了可绘制对象。

# input - 允许输入为 2.dp，如果不提示错误消息

> ID：16115702
> 
> 赞同：1
> 
> 时间：2013-04-20T01:51:39.130
> 
> 标签：input, python-3.x, numbers, decimal, python-3.3

我想确保用户在输入汇率和金额时，只能输入到2.dp，如果输入不是2.dp，那么肯定有错误信息。我怎样才能在不弄乱我的代码的情况下做到这一点？

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2013-04-20T03:21:16.720

检查四舍五入到 2 dp 的数字是否相同：

```
x = float(input(prompt))
if round(x, 2) != x:
    # x has more than 2 dp 
```

此外，对于货币应用程序，请考虑使用[Decimal](http://docs.python.org/3.3/library/decimal.html)模块 - 它的工作方式相同：

```
from decimal import Decimal
x = Decimal(input(prompt))
if round(x, 2) != x:
   # x has more than 2 dp 
```

除了它避免了浮点表示问题，尤其是当您开始对数字进行算术运算时。

# c++ - 渲染 Quake 3 地图时遇到问题

> ID：16115703
> 
> 赞同：0
> 
> 时间：2013-04-20T01:52:02.670
> 
> 标签：c++, opengl, rendering, quake, bsp-tree

我一直在研究 Quake 3 BSP 加载器。但是我无法正确渲染面部。

[![在此处输入图像描述](https://i.stack.imgur.com/TqbJ2.jpg)](https://i.stack.imgur.com/TqbJ2.jpg)

这是地图的顶点。这是我在地图上渲染人脸时发生的情况。

[![在此处输入图像描述](https://i.stack.imgur.com/zcuPO.png)](https://i.stack.imgur.com/zcuPO.png)

这是渲染的代码：

```
void bsp::render() 
{  
 for (    int j = 0; j <= bsp::lumps[13].length/sizeof(bspface); j++)//Read until end of lump
    {
     if ((bsp::faces[j].type == 1)||(bsp::faces[j].type == 3))       // 1=polygon, 2=patch, 3=mesh, 4=billboard    
       {        
        glFrontFace(GL_CW);
        glBegin(GL_TRIANGLE_STRIP);
        for (    int k = 0; k <=  bsp::faces[j].numofverts - 1; k++)//Read until end of lump
           {
            glVertex3f(bsp::vertices[bsp::faces[j].vertexindex+k].position.x, bsp::vertices[bsp::faces[j].vertexindex+k].position.y, bsp::vertices[bsp::faces[j].vertexindex+k].position.z);
           }
        glEnd();    
       }
   }
} 
```

完整源代码：

```
#include <stdio.h>                                   
#include <cstdio>
#include <string>
#include <algorithm>
#include <fstream>
#include <cstdio>
#include <iostream>
#include <stdlib.h>
#include <sstream>
#include <GL/GL.h>                                    
#include <SDL/SDL.h>
#include <assert.h>                                   

using namespace std;

int SCREEN_WIDTH = 640;
int SCREEN_HEIGHT = 480;
int SCREEN_BPP = 24;
bool running = true;
bool lightmaps;
SDL_Event event;

#define MAX_BRUSHES     10000
#define MAX_FACES       10000
#define MAX_VERTS       10000000
#define MAX_TEXTURES    1000
#define MAX_LEAFFACES   65536

struct pos
{
 float x;
 float y;
 float z;
};

struct bspface
{
 int   textureid;        // The index     into the texture array
 int   effect;           // The index for the effects (or -1 = n/a)
 int   type;             // 1=polygon, 2=patch, 3=mesh, 4=billboard
 int   vertexindex;      // The index     into this face's first vertex
 int   numofverts;       // The number of vertices for this face
 int   meshvertindex;    // The index     into the first meshvertex
 int   nummeshverts;     // The number of mesh vertices
 int   lightmapid;       // The texture index for the lightmap
 int   lmapcorner[2];    // The face's lightmap corner in the image
 int   lmapsize[2];      // The size of the lightmap section
 float lmappos[3];     // The 3D origin of lightmap.
 float lmapbitsets[2][3]; // The 3D space for s and t unit vectors.
 float vnormal[3];     // The face normal.
 int   size[2];          // The bezier patch dimensions.
};

struct bspvertex
{
 pos position;      //x y z
 float texturecoord[2];  //u, v texture coordinate
 float lightmapcoord[2]; //u, v lightmap coordinate
 float normal[3];        //x, y, z normalized vector
 char  color[4];         //RGBA color for the vertex
};

struct bsptexture 
{
 char name[64];      // The name of the texture w/o the extension
 int flags;          // The surface flags (unknown)
 int contents;       // The content flags (unknown)
};

struct bspbrush 
{
 int brushSide;           // The starting brush side for the brush
 int numofbrushsides;     // Number of brush sides for the brush
 int textureid;           // The texture index for the brush
};

struct bsplump
{
 int offset;
 int length;
};

class bsp
{
 public:
 ifstream    bspfile;
 bsplump     lumps[16];
 char        entities[10000];
 bspvertex   vertices[MAX_VERTS];
 bspface     faces[MAX_FACES];
 bsptexture  textures[MAX_TEXTURES];
 bspbrush    brushs[MAX_BRUSHES];
 int         faceindex[MAX_LEAFFACES];
 void load(string);
 void render();  
};

void bsp::load(string name)
{
 cout << "Loading BSP \"" << name << "\"" << endl;
 bsp::bspfile.open (name.c_str(), istream::binary);
 if(bsp::bspfile == NULL)
   cout << "ERROR: No file named \""<< name <<"\" found" << endl;
 else
     {
      char magic[64];                 //Number used in Quake 3 BSP header    
      bsp::bspfile.read(magic, 4);    //Read the magic number in the header of the BSP file it should be "IBSP"
      if((magic[0] != 'I')||(magic[1] != 'B')||(magic[2] != 'S')||(magic[3] != 'P'))
       { 
        cout << "ERROR: Not a valid Quake 3 BSP file" << endl;
       }
      else
          {
           int version;
          char vbuffer[4];                
          bsp::bspfile.read(vbuffer, 4);   
          for (    int k = 0; k <= 3; k++)    
             {
              ((char*)&version)[k] = vbuffer[k];
             }

          if(version != 46)//46 = 0x2e in hexidecimal
            cout << "ERROR: Unknown version of Quake 3 BSP" << endl;
          else
              {
               for (    int i = 0; i <= 16; i++)
                  {
                   char lumpoffset[4];
                   char lumplength[4];

                   //Read lumps offset
                   bsp::bspfile.read(lumpoffset, 4);                    
                   for (    int k = 0; k <= 3; k++)    
                      {
                       ((char*)&bsp::lumps[i].offset)[k] = lumpoffset[k];
                      }

                   //Read lumps length   
                   bsp::bspfile.read(lumplength, 4);                    
                   for (    int k = 0; k <= 3; k++)    
                      {
                       ((char*)&bsp::lumps[i].length)[k] = lumplength[k];
                      }

                   cout << "Lump " << i << " offset is " << bsp::lumps[i].offset << endl
                        << "Lump " << i << " length is " << bsp::lumps[i].length << endl << endl;                   
                 }

               //Load entities (LUMP 0)
               bsp::bspfile.seekg (bsp::lumps[0].offset, ios::beg);
               bsp::bspfile.read(bsp::entities, bsp::lumps[0].length);  

               //Load textures    (LUMP 1)            
               bsp::bspfile.seekg (bsp::lumps[1].offset, ios::beg);
               for (    int j = 0; j <= bsp::lumps[1].length/sizeof(bsptexture); j++) //Read until end of lump
                  {               
                   char buffer[72];           
                   bsp::bspfile.read(buffer, 72);  

                   for (    int k = 0; k <= 71; k++)//Read until end of lump
                      {
                       ((char*)&bsp::textures[j])[k] = buffer[k];
                      }
                  }

               //Load Leaffaces (LUMP 5)
               bsp::bspfile.seekg (bsp::lumps[5].offset, ios::beg);
               for (    int j = 0; j <= bsp::lumps[5].length/sizeof(bspvertex); j++) //Read until end of lump
                  {
                   char buffer[4];                 //create buffer for Leaffaces         
                   bsp::bspfile.read(buffer, 4);   //Read
                   for (    int k = 0; k <= 3; k++)    //Read until end of lump
                      {
                       ((char*)&bsp::faceindex[j])[k] = buffer[k];
                     }
                  }

               //Load vertices (LUMP 10)
               bsp::bspfile.seekg (bsp::lumps[10].offset, ios::beg); //Load vertex data from vertex lump (10)
               for (    int j = 0; j <= bsp::lumps[10].length/sizeof(bspvertex); j++)//Read until end of lump
                  {
                   char buffer[44];           //create buffer for verts    
                   bsp::bspfile.read(buffer, 44);   //Read
                   for (    int k = 0; k <= 43; k++)//Read until end of lump
                      {
                       ((char*)&bsp::vertices[j])[k] = buffer[k];
                      }
                  }

               //Load faces (LUMP 13)
               bsp::bspfile.seekg (bsp::lumps[13].offset, ios::beg); //Load face data from face lump (13)
               for (    int j = 0; j <= bsp::lumps[13].length/sizeof(bspface); j++)//Read until end of lump
                  {
                   char buffer[104];                 //create buffer for faces    
                   bsp::bspfile.read(buffer, 104);   //Read
                   for (    int k = 0; k <= 103; k++)    //Read until end of lump
                      {
                       ((char*)&bsp::faces[j])[k] = buffer[k];
                      }
                  }
                }
        }

    }
}
void bsp::render() 
{  
 for (    int j = 0; j <= bsp::lumps[13].length/sizeof(bspface); j++)//Read until end of lump
    {
     if ((bsp::faces[j].type == 1)||(bsp::faces[j].type == 3))       // 1=polygon, 2=patch, 3=mesh, 4=billboard    
       {        
        glFrontFace(GL_CW);
        glBegin(GL_TRIANGLE_STRIP);
        for (    int k = 0; k <=  bsp::faces[j].numofverts - 1; k++)//Read until end of lump
           {
            glVertex3f(bsp::vertices[bsp::faces[j].vertexindex+k].position.x, bsp::vertices[bsp::faces[j].vertexindex+k].position.y, bsp::vertices[bsp::faces[j].vertexindex+k].position.z);
           }
        glEnd();    
       }
   }
}

bsp bspbuffer;

bool initGL()
{
 //Initialize Projection Matrix
 glMatrixMode( GL_PROJECTION );
 glLoadIdentity();
 //Initialize Modelview Matrix
 glMatrixMode( GL_MODELVIEW );
 glLoadIdentity();
 //Initialize clear color
 glClearColor( 0.f, 0.f, 0.f, 1.f );
 //glPolygonMode( GL_FRONT_AND_BACK, GL_LINE );
 return true;
}

float angle; 

void render() 
{
 angle = angle + 1;
 glPushMatrix();
 //Clear color buffer
 glClear( GL_COLOR_BUFFER_BIT );
 //Render quad
 glPointSize(5.0);
 glRotatef(angle,1,1,1);
 glScalef(.002,.002,.002);
 bspbuffer.render();
 //Update screen
 glPopMatrix();
 SDL_GL_SwapBuffers();

 //While there are events to handle
 while( SDL_PollEvent( &event ) )
      {
       if(event.type == SDL_QUIT)
         {
          running = false;
          exit(0);
         }
      }       
 SDL_Delay( 1000 / 30 );
}

bool init()
{
 //Initialize SDL
 if( SDL_Init( SDL_INIT_EVERYTHING ) < 0 )
   {
    return false;
   }
//Create Window
if( SDL_SetVideoMode( SCREEN_WIDTH, SCREEN_HEIGHT, SCREEN_BPP, SDL_OPENGL ) == NULL )
  {
   return false;
  }
//Initialize OpenGL
if( initGL() == false )
  {
   return false;
  }
 //Set caption
 SDL_WM_SetCaption( "OpenGL BSP", NULL );
 return true;
}

#undef main

int main()
{
 init();
 bspbuffer.load("test1.bsp");
 do
   {
    render();
   }while(running);   
 return 0; 
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-11-14T09:54:29.003

您使用的索引从顶点块指向面多边形。如果您只想查看渲染的地图，可以尝试将 GL_TRIANGLE_STRIP 模式替换为 GL_POLYGON。

该多边形的三角形版本存储在 meshverts 块中。因此，为了渲染三角形，您需要存储在 meshverts 中的索引并从面的 vertexindex 偏移。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-02-18T05:44:37.780

对于渲染类型 1 和类型 3 的面，我建议使用 GL_TRIANGLES 和块 11 中的网格顶点。这对于类型 3 面是必需的，但它也适用于类型 1，因此您最好对两者使用相同的代码。在 j 上的循环中，您将需要以下内容：

```
bspface *face = &bsp::faces[j];
int v = face->vertexindex;
int m = face->meshvertindex;
int n = face->nummeshverts;
glBegin(GL_TRIANGLES);
for (int i = 0; i < n; i++) {
    bspvertex *vertex = &bsp::vertices[v + bsp::meshverts[m + i]];
    glVertex3f(vertex->position.x, vertex->position.y, vertex->position.z);
}
glEnd(); 
```

这当然假定您将 meshverts 添加到 bsp 类。

Meshverts 被描述为[q3 map specs](http://www.mralligator.com/q3/)的一部分，我相信你已经看到了。

# javascript - D3 tree layout add 'title' to leaf nodes only

> ID：16115707
> 
> 赞同：1
> 
> 时间：2013-04-20T01:52:17.830
> 
> 标签：javascript, d3.js

I can add a `title` to all the nodes in the tree with

```
node.append("svg:title").text(function(d) { return d.name + " " + d.size }); 
```

How can I add the `title` only to the the leaf nodes?

I tried:

```
node.selectAll('g.leaf.node text').text("title", function(d) { return d.name + " " + d.size }); 
```

but this didn't work.

example with titles on all nodes

[http://jsfiddle.net/chrisloughnane/EcU2c/](http://jsfiddle.net/chrisloughnane/EcU2c/)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-20T10:08:56.367

您可以检查当前节点是否有任何子节点，只有在没有子节点时才添加标题。代码是

```
node.append("svg:title").text(function(d) {
    return d.children ? "" : d.name + " " + d.size;
}); 
```

请注意，您可以类似地设置一个`g.leaf.node`类，以便如果您有几个特定于它们的东西，您可以更轻松地对所有叶子进行操作。

# android - Disable login button till form is filled android sdk

> ID：16115708
> 
> 赞同：0
> 
> 时间：2013-04-20T01:52:46.210
> 
> 标签：android, sdk

Hello all simple question how do you disable the submit button till to edittext are filled is it an if command or something ??

```
 b = (Button)findViewById(R.id.login);  
    et = (EditText)findViewById(R.id.username);
    pass= (EditText)findViewById(R.id.password);

    if (et & pass == '  ') {

    }

    b.setOnClickListener(new OnClickListener() {
        @Override
        public void onClick(View v) {
            dialog = ProgressDialog.show(Login.this, "", 
                    "Validating user...", true);
             new Thread(new Runnable() {
                    public void run() {
                        login();                          
                    }
                  }).start();               
        }
    }); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-20T03:08:47.363

您可能想要做的是使用[TextWatcher](http://developer.android.com/reference/android/text/TextWatcher.html)并`onTextChanged()`检查每个是否为空。但是你想检查文本`View`而不是检查`et`and `pass`，你可能想要`String`在每个中获取。

```
String etString = et.getText().toString();
String passString = pass.getText().toString(); 
```

如果它们不是 emty 和`null`，再加上您想要的任何其他检查，例如长度，那么

```
b.setEnabled(true); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-20T03:40:27.400

为了确保用户名不为空，我们从 中获取文本，并从字符串的开头`EditText`和`trim()`结尾删除换行符、空格和制表符。然后我们检查长度是否大于 0。我们对密码进行相同的检查，然后使用 启用按钮功能`setEnabled(true)`。

```
b = (Button)findViewById(R.id.login);  
et = (EditText)findViewById(R.id.username);
pass= (EditText)findViewById(R.id.password);
b.setEnabled(false); 
if (et.getText().toString().trim().length() > 0 && 
            pass.getText().toString().length() > 0){
    b.setEnabled(true);
}

b.setOnClickListener(new OnClickListener() {
    @Override
    public void onClick(View v) {
        dialog = ProgressDialog.show(Login.this, "", 
                "Validating user...", true);
         new Thread(new Runnable() {
                public void run() {
                    login();                          
                }
              }).start();               
    }
}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-20T02:58:06.957

也许这不是你要找的，但

`b.setEnabled(false);`

将为您禁用该按钮，然后您可以在需要时启用它：

`b.setEnabled(true);`

# python - Python：具有两个变量的 C for 循环

> ID：16115710
> 
> 赞同：3
> 
> 时间：2013-04-20T01:52:54.210
> 
> 标签：python, c

我是 python 新手。有没有类似的方法在 python 中用 2 个变量编写这个 C for 循环？

```
for (i = 0, j = 20; i != j; i++, j--) { ... } 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-04-20T01:58:12.517

Python 2.x

```
from itertools import izip, count
for i, j in izip(count(0, 1), count(20, -1)):
    if i == j: break
    # do stuff 
```

Python 3.x：

```
from itertools import count
for i, j in zip(count(0, 1), count(20, -1)):
    if i == j: break
    # do stuff 
```

这使用`itertools.count()`, 一个从某个起点无限迭代的迭代器：

> `itertools.count(start=0, step=1)`
> 
> 创建一个返回以 . 开头的均匀间隔值的迭代器`n`。通常用作`imap()`生成连续数据点的参数。此外，用于`izip()`添加序列号。

在 Python 2.x 中，您必须使用`izip`，因为 Py2K`zip`尝试创建所有结果的列表，而不是在获得结果`izip`时返回`iterator`结果。不幸的是，我们在这里处理无限迭代器，所以`zip`不会工作......这可能是一个很好的观点，为什么`zip`已经更改为`izip`在 Py3K 中执行角色（`izip`不再存在）。

如果您对*功能*性感到疯狂，您甚至可以这样做（但在我看来它看起来很丑，因为我已经讨厌`lambda`s）：

```
from itertools import takewhile, izip, count
for i, j in takewhile(lambda x: x[0] != x[1], izip(count(0, 1), count(20, -1))):
    # do stuff 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-04-20T01:56:59.140

```
>>> i, j = 0, 10
>>> while i != j:
...     # Your code here:
...     print "i: %d j: %d" % (i, j)
...     i += 1
...     j -= 1
...
...
i: 0 j: 10
i: 1 j: 9
i: 2 j: 8
i: 3 j: 7
i: 4 j: 6 
```

如果您想知道为什么在代码示例中很常见，`>>>`那`...`是因为人们正在使用 python 解释器（如果您愿意，可以使用 shell），或者像[bpython](http://bpython-interpreter.org/)这样的 python 解释器的包装器。我真的建议使用 bpython 来测试这样的代码。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-20T02:26:04.353

您可以使用 zip，但对于手头的问题，循环第二个变量并不是真正必要的，因此需要一种更简单的方法：

```
for i in range(10):
    j = 20 - i
    ⋮ 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-04-20T01:55:32.433

根据情况您可以使用 zip：

```
 lista = [1,2,3]
 listb = [4,5,6]
 for x,y in zip(lista, listb)
      print(x, y) 
```

输出：

```
 1 4
 2 5
 3 6 
```

zip 文档在这里：[http ://docs.python.org/3.3/library/functions.html#zip](http://docs.python.org/3.3/library/functions.html#zip)

另外，为了配合你所说的两个数字，你可以做

```
for x,y in zip(range(0), range(10, 0, -1))
    if x == y:
        break
    # do stuff 
```

这将为您提供增加和减少的值。

# mysql - 使用我的 SQL 进行空间查询

> ID：16115711
> 
> 赞同：7
> 
> 时间：2013-04-20T01:53:03.303
> 
> 标签：mysql, polygon, spatial-query

我正在使用以下语句从名为“纬度”和“经度”的两个 varChar 格式列写入名为“坐标”的点格式列。

```
"UPDATE table_name SET coordinate = PointFromText(CONCAT('POINT(',table_name.longitude,' ',table_name.lattitude,')'))" 
```

我尝试使用以下语句对坐标列进行空间查询。

```
SELECT id , coordinate FROM table_name WHERE MBRContains(GeomFromText('Polygon(-126.728566 49.226434, -123.652395 23.586457,-56.679738 23.908252,-53.076223 55.243002)'), coordinate) 
```

根据这个[工具](http://www.keene.edu/campus/maps/tool/)，我查询中的多边形覆盖了整个美国，我知道我的表中有一些点落在美国，但我仍然没有得到任何结果（注意我得到的是空结果而不是错误）。关于我做错了什么的任何想法？

更新。以下是根据以下建议执行我的查询的更新尝试。

```
SET @g1 = GeomFromText('Polygon((23.586457 -123.652395,23.908252 -56.679738,55.243002 -53.076223,55.243002 -53.076223,23.586457 -123.652395))');

SELECT id , coordinate FROM table_name WHERE MBRContains(@g1, coordinate) 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-23T11:51:40.260

当您处理坐标时，您的 lat lng 坐标已交叉。

我使用下面的坐标创建了一个谷歌地图（颠倒问题中坐标的顺序。

```
new google.maps.LatLng(49.226434,-126.728566),
new google.maps.LatLng(23.586457,-123.652395),
new google.maps.LatLng(23.908252,-56.679738),
new google.maps.LatLng(55.243002,-53.076223) 
```

![多边形](https://i.stack.imgur.com/zm5Wz.jpg)

谷歌地图不需要关闭多边形。

根据 [文档](http://dev.mysql.com/doc/refman/4.1/en/relations-on-geometry-mbr.html)， MBR 要求关闭多边形。

```
mysql> SET @g1 = GeomFromText('Polygon((0 0,0 3,3 3,3 0,0 0))'); 
```

**编辑** 回答评论你有正确的 CHARSET 吗？

典型空间表

```
CREATE TABLE IF NOT EXISTS `table_name` (
  `id` int(10) unsigned NOT NULL auto_increment,
  `coordinate` geometry NOT NULL,
   PRIMARY KEY  (`id`)
) ENGINE=MyISAM  DEFAULT CHARSET=utf8; 
```

确保`CHARSET=utf8;`

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-04-23T21:59:02.370

```
SELECT id , coordinate FROM table_name WHERE MBRContains(GeomFromText('Polygon((-126.728566 49.226434, -123.652395 23.586457,-56.679738 23.908252,-53.076223 55.243002, -126.728566 49.226434))'), coordinate) 
```

这应该有效。问题是多边形坐标应该在双括号中。它与内环（[多边形](http://dev.mysql.com/doc/refman/4.1/en/polygon-property-functions.html)）有关。加上大卫注意到你需要关闭多边形。

PS：我注意到你使用经度作为 X 和纬度作为 Y，而这应该是相反的。X是水平的，Y是垂直的。

# c++ - 使用 openMP 的 C++ 多线程：尽管存在局部变量，但性能不佳（错误共享？）

> ID：16115712
> 
> 赞同：2
> 
> 时间：2013-04-20T01:53:12.357
> 
> 标签：c++, multithreading, openmp, heap-memory, stack-memory

我遇到了一个相当奇怪的 openMP 问题。

任务是获取一个字符串向量并将每个元素拆分为其包含的 k-Mers（所有包含的长度为 k 的子字符串）。这应该沿着向量的元素微不足道地并行化，因为 k-Merification 过程对于每个元素都是独立发生的。我想将结果存储在 map/set STL 数据结构 ( `std::map<long long, std::map<std::string, std::set<unsigned int> > > local_forReturn`) 中，并为此分配了一个线程局部变量。

然而，实现的并行化行为却出人意料地糟糕——Linux 上的 top 显示 CPU 使用率约为 200%，尽管在 40 核机器上运行 40 个线程。（我已经测试过该`#omp critical`部分不是瓶颈）。

我的预感是这可能与错误共享有关，因为我的本地化地图/集 STL 类中包含的实际数据最终会出现在堆上。但是，我既不知道如何测试我的直觉，也不知道如何减少 STL 构造的错误共享（如果这是问题所在）。我将不胜感激任何想法！

完整代码：

```
#include <string>
#include <assert.h>
#include <set>
#include <map>
#include <vector>
#include <omp.h>
#include <iostream>

int threads = 40;
int k = 31;

std::string generateRandomSequence(int length);
char randomNucleotide();
std::vector<std::string> partitionStringIntokMers(std::string str, int k);

int main(int argc, char *argv[])
{
    // generate test data
    std::vector<std::string> requiredSEQ;
    for(unsigned int i = 0; i < 10000; i++)
    {
        std::string seq = generateRandomSequence(20000);
        requiredSEQ.push_back(seq);
    }

    // this variable will contain the final result
    std::map<long long, std::map<std::string, std::map<unsigned int, int> > > forReturn;

    omp_set_num_threads(threads);

    std::cerr << "Data generated, now start parallel processing\n" << std::flush;

    // split workload (ie requiredSEQ) according to number of threads
    long long max_i = requiredSEQ.size() - 1;
    long long chunk_size = max_i / threads;
    #pragma omp parallel
    {
        assert(omp_get_num_threads() == threads);
        long long thisThread = omp_get_thread_num();
        long long firstPair = thisThread * chunk_size;
        long long lastPair = (thisThread+1) * chunk_size - 1;
        if((thisThread == (threads-1)) && (lastPair < max_i))
        {
            lastPair = max_i;
        }

        std::map<long long, std::map<std::string, std::map<unsigned int, int> > > local_forReturn;

        for(long long seqI = firstPair; seqI <= lastPair; seqI++)
        {
            const std::string& SEQ_sequence = requiredSEQ.at(seqI);

            const std::vector<std::string> kMersInSegment = partitionStringIntokMers(SEQ_sequence, k);
            for(unsigned int kMerI = 0; kMerI < kMersInSegment.size(); kMerI++)
            {
                const std::string& kMerSeq = kMersInSegment.at(kMerI);
                local_forReturn[seqI][kMerSeq][kMerI]++;
            }   
        }

        #pragma omp critical
        {
            forReturn.insert(local_forReturn.begin(), local_forReturn.end());
        }
    }

    return 0;   
}

std::string generateRandomSequence(int length)
{
    std::string forReturn;
    forReturn.resize(length);
    for(int i = 0; i < length; i++)
    {
        forReturn.at(i) = randomNucleotide();
    }
    return forReturn;
}

char randomNucleotide()
{
    char nucleotides[4] = {'A', 'C', 'G', 'T'};
    int n = rand() % 4;
    assert((n >= 0) && (n <= 3));
    return nucleotides[n];
}

std::vector<std::string> partitionStringIntokMers(std::string str, int k)
{
    std::vector<std::string> forReturn;
    if((int)str.length() >= k)
    {
        forReturn.resize((str.length() - k)+1); 
        for(int i = 0; i <= (int)(str.length() - k); i++)
        {
            std::string kMer = str.substr(i, k);
            assert((int)kMer.length() == k);
            forReturn.at(i) = kMer;
        }
    }
    return forReturn;
} 
```

# python - How Pony (ORM) does its tricks?

> ID：16115713
> 
> 赞同：118
> 
> 时间：2013-04-20T01:53:15.697
> 
> 标签：python, orm, metaprogramming, dsl, ponyorm

[Pony ORM](https://docs.ponyorm.org/) does the nice trick of converting a generator expression into SQL. Example:

```
>>> select(p for p in Person if p.name.startswith('Paul'))
        .order_by(Person.name)[:2]

SELECT "p"."id", "p"."name", "p"."age"
FROM "Person" "p"
WHERE "p"."name" LIKE "Paul%"
ORDER BY "p"."name"
LIMIT 2

[Person[3], Person[1]]
>>> 
```

I know Python has wonderful introspection and metaprogramming builtin, but how this library is able to translate the generator expression without preprocessing? It looks like magic.

[update]

Blender wrote:

> [Here is the file](https://github.com/ponyorm/pony/blob/orm/pony/orm/decompiling.py#L52) that you're after. It seems to reconstruct the generator using some introspection wizardry. I'm not sure if it supports 100% of Python's syntax, but this is pretty cool. – Blender

I was thinking they were exploring some feature from the generator expression protocol, but looking this file, and seeing the `ast` module involved... No, they are not inspecting the program source on the fly, are they? Mind-blowing...

@BrenBarn: If I try to call the generator outside the `select` function call, the result is:

```
>>> x = (p for p in Person if p.age > 20)
>>> x.next()
Traceback (most recent call last):
  File "<interactive input>", line 1, in <module>
  File "<interactive input>", line 1, in <genexpr>
  File "C:\Python27\lib\site-packages\pony\orm\core.py", line 1822, in next
    % self.entity.__name__)
  File "C:\Python27\lib\site-packages\pony\utils.py", line 92, in throw
    raise exc
TypeError: Use select(...) function or Person.select(...) method for iteration
>>> 
```

Seems like they are doing more arcane incantations like inspecting the `select` function call and processing the Python abstract syntax grammar tree on the fly.

I still would like to see someone explaining it, the source is way beyond my wizardry level.

* * *

## 回答 #1

> 赞同：224
> 
> 时间：2013-04-20T09:32:10.340

Pony ORM 作者在这里。

Pony 通过三个步骤将 Python 生成器转换为 SQL 查询：

1.  生成器字节码的反编译和重建生成器 AST（抽象语法树）
2.  将 Python AST 翻译成“抽象 SQL”——基于列表的通用 SQL 查询表示
3.  将抽象 SQL 表示转换为特定的数据库相关 SQL 方言

最复杂的部分是第二步，Pony 必须理解 Python 表达式的“含义”。看来您对第一步最感兴趣，所以让我解释一下反编译的工作原理。

让我们考虑这个查询：

```
>>> from pony.orm.examples.estore import *
>>> select(c for c in Customer if c.country == 'USA').show() 
```

这将被翻译成以下SQL：

```
SELECT "c"."id", "c"."email", "c"."password", "c"."name", "c"."country", "c"."address"
FROM "Customer" "c"
WHERE "c"."country" = 'USA' 
```

下面是这个查询的结果，它将被打印出来：

```
id|email              |password|name          |country|address  
--+-------------------+--------+--------------+-------+---------
1 |john@example.com   |***     |John Smith    |USA    |address 1
2 |matthew@example.com|***     |Matthew Reed  |USA    |address 2
4 |rebecca@example.com|***     |Rebecca Lawson|USA    |address 4 
```

该`select()`函数接受一个 python 生成器作为参数，然后分析它的字节码。我们可以使用标准 python`dis`模块获取这个生成器的字节码指令：

```
>>> gen = (c for c in Customer if c.country == 'USA')
>>> import dis
>>> dis.dis(gen.gi_frame.f_code)
  1           0 LOAD_FAST                0 (.0)
        >>    3 FOR_ITER                26 (to 32)
              6 STORE_FAST               1 (c)
              9 LOAD_FAST                1 (c)
             12 LOAD_ATTR                0 (country)
             15 LOAD_CONST               0 ('USA')
             18 COMPARE_OP               2 (==)
             21 POP_JUMP_IF_FALSE        3
             24 LOAD_FAST                1 (c)
             27 YIELD_VALUE         
             28 POP_TOP             
             29 JUMP_ABSOLUTE            3
        >>   32 LOAD_CONST               1 (None)
             35 RETURN_VALUE 
```

Pony ORM`decompile()`在模块`pony.orm.decompiling`中具有可以从字节码恢复 AST 的功能：

```
>>> from pony.orm.decompiling import decompile
>>> ast, external_names = decompile(gen) 
```

在这里，我们可以看到 AST 节点的文本表示：

```
>>> ast
GenExpr(GenExprInner(Name('c'), [GenExprFor(AssName('c', 'OP_ASSIGN'), Name('.0'),
[GenExprIf(Compare(Getattr(Name('c'), 'country'), [('==', Const('USA'))]))])])) 
```

现在让我们看看这个`decompile()`函数是如何工作的。

该`decompile()`函数创建一个`Decompiler`对象，该对象实现了访问者模式。反编译器实例一一获取字节码指令。对于每条指令，反编译器对象都会调用它自己的方法。该方法的名称与当前字节码指令的名称相同。

当 Python 计算表达式时，它使用堆栈，堆栈存储计算的中间结果。反编译器对象也有自己的栈，但是这个栈存储的不是表达式计算的结果，而是表达式的AST节点。

当调用下一条字节码指令的反编译器方法时，它从堆栈中取出 AST 节点，将它们组合成一个新的 AST 节点，然后将该节点放在堆栈的顶部。

例如，让我们看看如何`c.country == 'USA'`计算子表达式。对应的字节码片段为：

```
 9 LOAD_FAST                1 (c)
             12 LOAD_ATTR                0 (country)
             15 LOAD_CONST               0 ('USA')
             18 COMPARE_OP               2 (==) 
```

因此，反编译器对象执行以下操作：

1.  来电`decompiler.LOAD_FAST('c')`。此方法将`Name('c')`节点置于反编译器堆栈的顶部。
2.  来电`decompiler.LOAD_ATTR('country')`。此方法`Name('c')`从堆栈中获取节点，创建`Geattr(Name('c'), 'country')`节点并将其放在堆栈顶部。
3.  来电`decompiler.LOAD_CONST('USA')`。此方法将`Const('USA')`节点置于堆栈顶部。
4.  来电`decompiler.COMPARE_OP('==')`。此方法从堆栈中获取两个节点（Getattr 和 Const），然后放入`Compare(Getattr(Name('c'), 'country'), [('==', Const('USA'))])` 堆栈顶部。

在处理完所有字节码指令后，反编译器堆栈包含一个对应于整个生成器表达式的 AST 节点。

由于 Pony ORM 只需要反编译生成器和 lambda，这并不复杂，因为生成器的指令流相对简单——它只是一堆嵌套循环。

目前 Pony ORM 涵盖了整个生成器指令集，除了两件事：

1.  内联 if 表达式：`a if b else c`
2.  复合比较：`a < b < c`

如果 Pony 遇到这样的表达式，它会引发`NotImplementedError`异常。但即使在这种情况下，您也可以通过将生成器表达式作为字符串传递来使其工作。当您将生成器作为字符串传递时，Pony 不使用反编译器模块。相反，它使用标准 Python`compiler.parse`函数获取 AST。

希望这能回答你的问题。

# perl - Why will Storable load some classes, but not others?

> ID：16115714
> 
> 赞同：3
> 
> 时间：2013-04-20T01:53:20.890
> 
> 标签：perl, storable

I'm having a problem with frozen objects in Storable. When Storable thaws an object, it's supposed to load the class. This is usually true, but sometimes it isn't. Here's some sample code...

```
#!/usr/bin/env perl -l

use strict;
use warnings;

use Storable;

if( fork ) {
}
else {
    print "In child.";

    # Load modules in a child process so the parent does not have them loaded
    require Foo;
    print $INC{"Foo.pm"};
    print $Foo::VERSION;
    Storable::store( Foo->new("http://example.com"), "/tmp/tb2.out" );

    require DateTime;
    print $INC{"DateTime.pm"};
    Storable::store( DateTime->new(year => 2009), "/tmp/uri.out" );

    exit;
}

wait;

print "Child is done.";
print "------------------------------";

print "DateTime is not loaded" if !$INC{"DateTime.pm"};
my $datetime = Storable::retrieve("/tmp/uri.out");
print $INC{"DateTime.pm"};
print $datetime->year;

print "Foo is not loaded" if !$INC{"Foo.pm"};
my $obj = Storable::retrieve("/tmp/tb2.out");
print $INC{"Foo.pm"};
print $obj->id; 
```

And the quite simple Foo.pm.

```
$ cat lib/Foo.pm 
package Foo;

use strict;
use vars qw($VERSION);
$VERSION = "1.60";

sub new {
    my $class = shift;

    return bless { foo => 23 }, $class;
}

sub id { 42 }

1; 
```

I get from that program...

```
In child.
lib/Foo.pm
1.60
/Users/schwern/perl5/perlbrew/perls/perl-5.16.2-threads/lib/site_perl/5.16.2/darwin-thread-multi-2level/DateTime.pm
Child is done.
------------------------------
DateTime is not loaded
/Users/schwern/perl5/perlbrew/perls/perl-5.16.2-threads/lib/site_perl/5.16.2/darwin-thread-multi-2level/DateTime.pm
2009
Foo is not loaded
Use of uninitialized value in print at /Users/schwern/tmp/test.plx line 38.

Can't locate object method "id" via package "Foo" at /Users/schwern/tmp/test.plx line 39. 
```

As you can see, it will happily load DateTime but not my Foo module. The object is restored, but Foo.pm is not loaded. I have this problem with Storable 2.34 and perl 5.16.2.

Can people repeat this problem? Is there a solution?

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-20T02:27:01.267

DateTime 定义`STORABLE_freeze`和`STORABLE_thaw`。可以推断 Storable 记录了该类是否使用了一个钩子来冻结自己并寻找相应的钩子来解冻它。模块加载是 Foo 不调用的钩子逻辑的一部分。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-04-20T16:46:31.763

你总是可以做

```
my $class = ref $obj;
eval "require $class"; 
```

不确定您看到的 DateTime 的行为是否是 DateTime 的 Storable-hooks 的结果，但您不需要挂钩来要求模块。

# c - 从输入的电话号码中查找所有可能的单词

> ID：16115715
> 
> 赞同：0
> 
> 时间：2013-04-20T01:53:24.607
> 
> 标签：c

我有一个问题需要一些帮助才能解决。我希望我能得到一些关于更好的方法来处理我正在做的事情的指示。我的主要问题是下面的几行（//这让我感到困惑）并在页面底部进行了描述。

我需要排列电话号码的所有可能结果：（不仅仅是字典单词）

即 222-2222

应该输出一个 3^7 长的列表，其中包含 a、b、c 的所有可能排列

IE

```
AAAAAAA
AAAAAAB
AAAAAAC
AAAAABA   // THIS IS WHATS HANGING ME UP
AAAAABB
AAAAABC
AAAAACA   // HERE TOO AND SO ON 
```

我的代码（专门为测试而缩短）给了我：

```
AAAA
AAAB
AAAC
AABC
AACC
ABCC
ACCC
BCCC
CCCC 
```

我是一个开始编程的学生，所以我的知识可以用于使用 for、while、if 语句以及从数组中获取单个字符。

到目前为止，这是我的代码的样子：（这是函数的一部分。缺少代码）

char alphaFunc(char n[]){

```
int d1=n[0]-48;
int d2=n[1]-48;
int d3=n[2]-48;
int d4=n[3]-48;
int d5=n[4]-48;
int d6=n[5]-48;
int d7=n[6]-48;
int a=0,b=0,c=0,d=0,e=0,f=0,g=0;

int i=0;

char charArray[10][4]={ {'0','0','0'},{'1','1','1'},{'A','B','C'},
        {'D','E','F'},{'G','H','I'},{'J','K','L'},{'M','N','O'},
        {'P','R','S'},{'T','U','V'},{'W','X','Y'}  };

while(i <=14){

    printf("%c%c%c%c\n", charArray[d1][a],
            charArray[d2][b],charArray[d3][c],charArray[d4][d],
            charArray[d5][e],charArray[d6][f],charArray[d7][g]);
    g++;

    if(g==3){
        g=2;
        f++;
    }
    if(f==3){
        f=2;
        e++;
    }
    if(e==3){
        e=2;
        d++;
    } 
```

我并不是要找人来帮我做这件事并将其重置为 [0] 它会将您发送到循环的不同部分。（希望这是有道理的）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-20T03:24:07.697

由于 的值`charArray`是恒定的，我建议将其设为全局变量，而不是在函数中声明它。此外，由于一些数字有 4 个字母，而另一些有 3 个字母，您可能需要考虑使用[锯齿状数组](https://www.google.com/search?q=javgged+array&aq=f&oq=javgged+array&aqs=chrome.0.57j0l3.2034j0&sourceid=chrome&ie=UTF-8)来表示它。

至于打印您可以从电话号码获得的排列，我认为递归将成为您的朋友。假设您可以将电话号码存储在一个 int 数组中，以下应该可以工作：

```
public void printPermutations(int[] phoneNumber)
{
   printPermutations(phoneNumber, 0, String.Empty);
}

private void printPermutations(int[] phoneNumber, int index, string permutation)
{
   if(index >= phoneNumber.Length)
   {
       // If we've reached the end, print the number
       printf(permutation + "\n");
   }
   else
   {
       // Otherwise, generate a permutation for each
       // character this digit can be
       int digit = phoneNumber[index];
       char[] chars = charArray[digit];
       for (int i = 0; i < chars.Length; i++)
       {
           printPermutations(phoneNumber, index+1, permutation + chars[i]);
       }
   }
} 
```

# php - 以垂直行显示 HTML 元素行

> ID：16115719
> 
> 赞同：0
> 
> 时间：2013-04-20T01:54:55.990
> 
> 标签：php, html, sorting

我想在我的 Virtuemart 网上商店中显示一个类别列表，垂直排序方式与本演示中所示的方式相同：http: [//www.inkplant.com/code/mysql-vertical-sort.php](http://www.inkplant.com/code/mysql-vertical-sort.php)

所以我借用了代码：

```
 <?php
$cols = 4; //number of columns, you can set this to any positive integer
$values = array();
$result = mysql_query("SELECT * FROM states ORDER BY name");
$numrows = mysql_num_rows($result);
$rows_per_col = ceil($numrows / $cols);
for ($c=1;$c<=$cols;$c++) { $values['col_'.$c] = array(); }
$c = 1;
$r = 1;
while ($row = mysql_fetch_assoc($result)) {
    $values['col_'.$c][$r] = stripslashes($row['name']);
    if ($r == $rows_per_col) { $c++; $r = 1; } else { $r++; }
}
echo "<table>" ;
for ($r=1;$r<=$rows_per_col;$r++) {
    echo "<tr>" ;
    for ($c=1;$c<=$cols;$c++) { echo "<td>".$values['col_'.$c][$r]."</td>" ; }
    echo "</tr>" ;
}
echo "</table>" ;
unset($values);
?> 
```

然后我尝试在我的 Virtuemart 类别模板文件中修改它，结果如下：

```
<?php
$cols = 3; //number of columns, you can set this to any positive integer
$values = array();

$numrows = $precounterdigit;

$rows_per_col = ceil($numrows / $cols);
for ($c=1;$c<=$cols;$c++) { $values['col_'.$c] = array(); }
$c = 1;
$r = 1;
foreach ( $this->category->children as $category ) {
$catname = $category->category_name;
$caturl = JRoute::_ ( 'index.php?option=com_virtuemart&view=category&virtuemart_category_id=' . $category->virtuemart_category_id );
$values['col_'.$c][$r] = '<div class="category floatleft'.$category_cellwidth.'">
<div class="spacer"><h2>
                            <a href="'.$caturl.'" title="'.$catname.'">
                            '.$catname.'<br /></a></h2>
                                    </div></div>';  

    if ($r == $rows_per_col) { $c++; $r = 1; } else { $r++; }
}
echo '<div class="tablediv">' ;
for ($r=1;$r<=$rows_per_col;$r++) {
    echo '<div class="row">' ;
    for ($c=1;$c<=$cols;$c++) { echo $values['col_'.$c][$r]; }
    echo '</div>' ;
}
echo '</div>' ;
unset($values);
?> 
```

如果类别的数量可被 3 整除或可被 3 -1 整除，它实际上在类别视图中完美显示。这意味着如果页面上有 3、5、6、8、9、11、12 等......类别，它会正确显示。

如果类别的数量等于可被 3 +1 整除的数字，那么它会以一种奇怪的方式显示......

以下是当有 9 个类别时它如何显示的示例：

第一类 | 四类 | 七类
二类 | 超五类 | 八类
三类 | 六类 | Cat9

以下是当有 8 个类别时它如何显示的示例：

第一类 | 四类 | 七类
二类 | 超五类 | 八类
三类 | 六类 |

下面是一个示例，说明当有 7 个类别时它是如何显示的：

Cat1 | 四类 | 七类
二类 | 超五类 | 三类
六类 |

我真的无法弄清楚这一点，所以我希望有人可以在这里帮助我一点..

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-20T02:29:47.753

试试这个，当然你可以改变列和行。

```
<?php //user210424 
$cols = 3;
$rows = 3;
$j = 0;
$array = array("ONE","TWO","THREE","FOUR","FIVE","SIX","SEVEN","EIGHT","NINE");

for($i=1; $i<=$cols; $i++) {
echo "<div class='col' style='float:left;'>";
    for($j; $j<$rows*$i; $j++) {
        echo "<div class='row'>".$array[$j]."</div>";
    }
echo "</div>";
}
?> 
```

# javascript - 从一组 jQuery 元素中选择个体

> ID：16115720
> 
> 赞同：5
> 
> 时间：2013-04-20T01:55:10.743
> 
> 标签：javascript, jquery

如果我使用 jquery 来选择我所有的文本输入：

```
var inputs = $('#form input[type="text"]'); 
```

它们被包裹在 jQuery 中。我可以对他们做任何我想做的事。

```
inputs.css('height', '1000px');
//muhahaha! 
```

作为一个群体，他们遵守。但我似乎错过了一些东西。我知道我可以单独看到每个对象，就好像它是一组对象一样。

```
console.log(inputs[0]);
// <input type="text" /> 
```

但是上面的输出只是html；当我这样做时，它不再是一个 jQuery 对象:(

```
inputs[0].css('font-size', '100px');
// Uncaught TypeError: Object #<HTMLInputElement> has no method 'css' 
```

我如何继续对个人使用 jquery 的方法，而不必再次包装每个元素，或者由于某些奇怪、黑暗、莫名其妙的原因，这是不可能的？

甚至不知道从哪里开始搜索这个，到目前为止，我的 jQuery 之旅还没有让我找到答案。谢谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-20T02:01:53.643

看看这个页面：[jQuery Filtering](http://api.jquery.com/category/traversing/filtering/)

```
inputs.eq(0).css('font-size', '100px'); 
```

在这种情况下应该做的伎俩

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-20T02:01:49.710

在 Jquery-API 中看到这个[函数 .eq()](http://api.jquery.com/eq/)

当通过 Array-Index 访问 JQuery 中的 Dom-Node-Collection 时，您将获得 RAW Dom-Elements，如果您使用上面给定的方法选择索引，您将获得功能增强的 jQuery-Wrapped-Elements。请参阅文档。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-20T02:01:42.417

避免再次包装每个元素的唯一方法（`$(inputs[0]).css('font-size', '100px')`）

将使用纯 JavaScript。例子：`inputs[0].style.fontSize = "100px";`

# java - 如何在java中的类内部方法中使用变量

> ID：16115722
> 
> 赞同：0
> 
> 时间：2013-04-20T01:55:47.197
> 
> 标签：java, arrays, class, variables

所以我必须为一个任务写一个扫雷游戏。如果我为 Board 创建了一个类，其中包含两个 2D 数组，一个用于 board 值，一个用于保存用户是否已点击或未点击。我用两个二维数组的参数编写了方法。我将如何在我的主类中调用这些数组？

```
public class Board {

    int x;
    int y;
    public char[][] board;
    public char[][] reveal;

    Board(int x, int y){
        board = new char[x][y];
        reveal = new boolean[x][y];
}

    }

public class Mine{

    public static void main(String[] args){

        Board gameboard;
        gameboard = new Board(5, 5);

                   ???

        Board.printBoard(board, reveal);

    }
}

public void printBoard(char[][] board, boolean[][] test){

        for(int i=0; i<=board.length; i+=1){
            for(int j=0; j<board[i].length; j+=1){
                if (test[i][j]==true){
                System.out.print(board[i][j]);
                }
                else {
                    System.out.print('?');
                }
            }
            System.out.println();
        }

    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-20T01:58:31.433

> 我将如何在我的主类中调用这些数组？

您不会“调用”数组。你调用方法。如果要访问类的实例变量，则需要提供访问器方法，即“获取”和“设置”实例变量的方法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-20T02:39:35.753

通过使用以下代码，您可以像其他人建议的那样轻松访问方法。

```
System.out.print(gameboard.board[i][j]); 
```

您可以像许多人建议的那样合并封装。

但是，我还建议您更简单地实施它，如果您被允许完成作业，可以在一个班级内进行。

这与更少的代码一样有效，而且 IMO 也很容易理解。

```
public class Board {
    private int x;
    private int y;
    private char[][] board;
    private boolean[][] reveal;

    public static void main(String[] args) {
        Board gameboard = new Board(5, 5);
        gameboard.printBoard();
    }

    public Board(int x, int y) {
        this.x = x;
        this.y = y;
        board = new char[x][y];
        reveal = new boolean[x][y];
    }

    public void printBoard() {
        for (int i = 0; i < board.length; i += 1) {
            for (int j = 0; j < board[i].length; j += 1) {
                if (reveal[i][j] == true) {
                    System.out.print(board[i][j]);
                } else {
                    System.out.print('?');
                }
            }
            System.out.println();
        }
    }

    public class Mine {

    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-20T02:04:01.443

由于您将`board`和`reveal`属性声明为公共，您可以使用`gameboard.board`and访问它们的值`gameboard.reveal`。
然而，这是一个非常非常糟糕的方法。[封装](http://en.wikipedia.org/wiki/Encapsulation_%28object-oriented_programming%29)。
因此，您应该为每个类属性声明 getter 和 setter，`x`并通过以下方式访问其值：`objectName.getX()`

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-20T02:04:27.633

在 main 方法中实例化板类的实例后，您可以按如下方式访问它们（例如）：

```
Board gameboard = new Board(5,5);
for (int i = 0; i < 5; i++) {
  for (int j = 0; j < 5; j++) {
    System.out.print(gameboard.board[i][j]);
  }
} 
```

等等

使用私有成员和访问器方法是一种更好的方法，但肯定不是必需的。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-04-20T02:05:08.177

您只需键入 gameboard.board 即可获取存储在您的 Board 对象中的“board”。

# dart - 自更新以来构建 rsp 页面不起作用

> ID：16115723
> 
> 赞同：0
> 
> 时间：2013-04-20T01:55:50.243
> 
> 标签：dart, rikulo

由于每当我尝试构建任何 rsp 文件时更新到流 0.70+1，我都会收到下面列出的错误。

```
FileSystemEntity._throwIfError (dart:io:1637:7)
FileSystemEntity.identicalSync (dart:io:1627:18)
compileFile (package:stream/src/rspc/build.dart:36:37)
build.<anonymous closure> (package:stream/src/rspc/build.dart:126:20)
_StreamSubscriptionImpl._sendData (dart:async:1586:12)
_StreamImpl._sendData.<anonymous closure> (dart:async:1362:29)
_SingleStreamImpl._forEachSubscriber (dart:async:1446:11)
_StreamImpl._sendData (dart:async:1360:23)
_StreamImpl._add (dart:async:1162:16)
StreamController.add (dart:async:1077:35)
_Directory.list.<anonymous closure> (dart:io:609:40)
_ReceivePortImpl._handleMessage (dart:isolate-patch:81:92) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-20T03:28:38.387

这是一个错误。请关注[第 25 期](https://github.com/rikulo/stream/issues/25)

# javascript - 为什么 document.write() 和 alert() 方法渲染 JavaScript 对象的方式不同？

> ID：16115735
> 
> 赞同：1
> 
> 时间：2013-04-20T01:57:40.113
> 
> 标签：javascript

`document.write()`方法和`window.alert()`打印数组和对象时有什么区别？

此代码示例中显示了不同的行为：

```
var arr = new Array("Maizere","Pathak");

document.write(arr); // output: Maizere,Pathak
alert(arr); // output: maizere,pathak 
```

为什么他们都打印值？不应该`alert()`打印`Object Object`吗？

使用 DOM 对象，它会打印 [object HTML collection]，这里是打印值。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-20T02:07:15.957

JavaScript 中的对象有一个`toString`方法。每当以预期文本的方式使用对象时，都会调用此方法。例如，以下输出`[object Object]`：

```
alert({}); 
```

数组有自己的`toString`方法版本，可以做一些完全不同的事情。它们不是显示它们的类型，而是显示它们的内容，并用逗号连接。如果您愿意，可以替换数组`toString`方法：

```
var names = ['Jonathan', 'Sampson'];

names.toString = function () {
    return this.length;
};

alert(names); // Outputs 2 
```

`toString`如果您愿意，也可以使用其他实现：

```
document.toString.call(names); // [object Array] 
```

有关其他信息，请参阅[`toString`MSDN](http://msdn.microsoft.com/en-us/library/ie/k6xhc6yc%28v=vs.94%29.aspx)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-20T02:11:11.480

两者`alert`和`document.write`都设置为使用该`.toString()`方法。对于 type 的实例`object`，这通常打印出来`[object Object]`。但是，Array 类重载了这个方法来打印数组的内容。尝试做`arr.toString()`以表明情况确实如此。如果您创建一个对象并给它一个 toString 方法，它将被调用以进行警报。例如：

```
var obj = {};
obj.toString = function() { return "I'm an Object!"; }
alert(obj); 
```

将显示带有字符串“我是对象！”的警报。在里面。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-20T02:13:37.337

document.write 和 window.alert 方法都使用字符串，因此 Array.toString 方法将用于从数组中生成字符串值。

toString 方法从不同类型的对象生成的内容可能因浏览器而异，但您将从 document.write 和 window.alert 获得相同的结果，因为它们使用相同的方法生成字符串。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-04-20T02:15:18.253

为了扩展乔纳森桑普森的答案并给一个小小的心灵破碎机......

```
var names = ['Jonathan', 'Sampson'];
names.toString = function () {return 0;};
names.valueOf = function () {return 1;};

console.log(names + ""); // 1 or 0 ? What do you think.
console.log(names.toString()); // 1 or 0 ? What do you think.¨
alert( names ); 
```

[看演示](http://jsbin.com/ojozus/1/embed?javascript,console)

# ios - UITextView 在检测到动作时更改字体

> ID：16115736
> 
> 赞同：4
> 
> 时间：2013-04-20T01:58:04.077
> 
> 标签：ios, objective-c, uiscrollview, uitextview, datadetectortypes

我一直在寻找解决这个问题的方法，似乎没有人遇到过类似的问题。

基本上，我有多个 UITextView，用于从一些 EKEvent.notes 中检测地址、url、电话号码等（可以通过 UIDataDectorTypeAll 检测到的任何内容）。然后我将这些 UITextViews 添加为 UIScrollView 的子视图。

现在，出于某种原因，一旦 UITextView 检测到地址或电话号码并成为可操作的目标，它将随机绘制 2 倍于其指定字体的字体！

如果我点击，我已经设置了测试来重绘我的视图。当 UITextView 最初添加到视图中时，我可以看到正确的黑色文本。然后它进行检测交易并成为可操作的目标。有时它保持正确的大小，有时它以 2x 字体绘制（但仍然在正确的框架中，因此它被剪裁了）。

这非常简单，但这是我的代码。所有变量都是正确的值，框架是正确的，文本是正确的，一切都是正确的，大约 50% 的时间绘制正确。它只是另外 50% 的时间变成（显然）2x 字体！任何帮助是极大的赞赏！

```
UITextView *locationTextView = [[UITextView alloc] init];
locationTextView.dataDetectorTypes = UIDataDetectorTypeAll;
locationTextView.text = location;
locationTextView.font = [UIFont fontWithName:@"AvenirNext-Regular" size:17];
locationTextView.editable = NO;
locationTextView.userInteractionEnabled = YES;
locationTextView.contentInset = UIEdgeInsetsMake(-8,-8,-8,-8);
locationTextView.frame =CGRectMake(kBufferLeft, daySize.height, kBufferDayViewTextWidth, locationSize.height);
[scrollView addSubview:locationTextView]; 
```

正确：http: [//i.imgur.com/3pJ43kj.jpg](http://i.imgur.com/3pJ43kj.jpg)

不正确：http: [//i.imgur.com/DLq4gco.jpg](http://i.imgur.com/DLq4gco.jpg)

（暂时还不能发图，抱歉。）

完全相同的代码产生了两种效果。感谢您的时间。

干杯!

**编辑**：我和 TTTAttributedLabels 一起解决了这个问题。

github.com/mattt/TTTAttributedLabel

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-05-17T15:36:42.873

`<UITextField>`您可以在委托处设置字体。

```
-(BOOL)textView:(UITextView *)textView shouldChangeTextInRange:(NSRange)range replacementText:(NSString *)text 

{ 
  locationTextView.font = [UIFont fontWithName:@"AvenirNext-Regular" size:17];
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-05-27T10:13:27.583

我遇到了同样的问题，因为我使用的是自定义换行符（layoutManager:shouldBreakLineByWordBeforeCharacterAtIndex:)。不得不禁用它。

# c++ - 什么时候应该重新定义非虚拟方法？

> ID：16115743
> 
> 赞同：0
> 
> 时间：2013-04-20T01:59:23.530
> 
> 标签：c++, inheritance, virtual

`virtual`方法是[多态性](http://en.wikipedia.org/wiki/Polymorphism)的 C++ 实现的一部分。除了避免与 RTTI ^(**)和方法查找相关的开销之外，是否有令人信服的理由省略`virtual`？

假设`virtual`可以随时将其添加到基类中，重新定义非`virtual`方法的目的是什么？

*[**它是否可以在现代 CPU 上测量与这个问题无关。]*

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-20T02:06:22.773

好吧，没有什么理由重新定义一个非虚函数。事实上，我建议不要这样做，因为看起来对完全相同的对象的相同函数调用可能会根据所使用的指针/引用的静态类型而表现不同。

*覆盖*虚拟成员函数允许您专门化派生类型的行为。*重载*非虚拟成员函数将提供另一种行为，在这种行为中，对于不经意的读者来说，将执行哪些函数/行为可能并不明显。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-20T02:15:07.500

一种可能的用途是实现一个定义了默认函数版本的 CRTP 框架：

```
#include <iostream>

//This could be any higher-order function.
template<typename T>
class CallFiveTimes {
    protected:
    void docalls() const {
        for(int i(0); i != 5; ++i) static_cast<T const*>(this)->callme();
    }
    //Default implementation. If a lot
    //of different functionality were required of `T`
    //then defaults could make `T` easier to write.
    void callme() const {
        std::cout << "Default implementation.\n";
    }
};

class Client : CallFiveTimes<Client> {
    public:
    void useFramework() {
        docalls();
    }
    private:
    friend struct CallFiveTimes<Client>;
    //This redefinition will be used.
    void callme() const {
       std::cout << "Client implementation.\n";
    }

};

class LazyClient : CallFiveTimes<LazyClient> {
    public:
    void useFramework() {
       docalls();
    }
    friend struct CallFiveTimes<LazyClient>;
};

int main() {
   Client c;
   c.useFramework(); //prints "Client Implementation" five times

   LazyClient lc;
   lc.useFramework(); //prints "Default Implementation" five times
} 
```

我在实践中从未见过这样做，但在某些情况下可能值得考虑。

# r - 在 r 中跨多个数据帧应用一组操作

> ID：16115745
> 
> 赞同：4
> 
> 时间：2013-04-20T01:59:34.187
> 
> 标签：r

我一直在为我的项目学习 R，但无法通过谷歌搜索我当前问题的解决方案。

我有大约 100 个 csv 文件，需要对它们执行一组精确的操作。我已经将它们作为单独的对象读入（我认为这可能是不正确的 r 风格），但我一直无法编写一个可以循环的函数。每个 csv 都是一个包含信息的数据框，其中包括一个带有十进制年份形式的日期的列。我需要创建 2 个包含年份和年份的新列。我已经想出了如何手动完成我想找到一种方法来自动化这个过程。这是我一直在做的事情：

```
#setup
library(lubridate)  #Used to check for leap years
df.00 <- data.frame( site = seq(1:10), date = runif(10,1980,2000 ))

#what I need done

df.00$doy <- NA  # make an empty column which I'm going to place the day of the year
df.00$year <- floor(df.00$date) # grabs the year from the date column
df.00$dday <- df.00$date - df.00$year # get the year fraction. intermediate step.

# multiply the fraction year by 365 or 366 if it's a leap year to give me the day of the year
df.00$doy[which(leap_year(df.00$year))] <- round(df.00$dday[which(leap_year(df.00$year))] * 366)
df.00$doy[which(!leap_year(df.00$year))] <- round(df.00$dday[which(!leap_year(df.00$year))] * 365) 
```

以上，虽然不优雅，但可以满足我的要求。但是，我需要对其他数据帧 df.01 - df.99 执行此操作。到目前为止，我一直无法将它放在函数或 for 循环中。如果我把它放到一个函数中：

```
funtest <- function(x) {
    x$doy <- NA
} 
```

funtest(df.00) 什么都不做。这是我对函数在 r 中如何工作的理解所期望的，但是如果我将它包装在一个 for 循环中：

```
for(i in c(df.00)) { 
    i$doy <- NA } 
```

我多次收到“In i$doy <- NA : Coercing LHS to a list”，这告诉我循环不会将数据帧视为一个单元，而是可能会查看帧中的每一列。
我真的很感激对我应该做什么的一些见解。我觉得我可以使用 bash 和 awk 轻松解决这个问题，但我希望使用 r 不那么无能

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-20T03:09:51.990

最有效和最直接的方法是使用列表。

1.  将所有 CSV 文件放入一个文件夹
2.  获取该文件夹中的文件列表，
    例如： `files <- dir('path/to/folder', full.names=TRUE)`
3.  迭代地将所有这些文件读入`data.frame`s列表，
    例如：`df.list <- lapply(files, read.csv, <additional args>)`
4.  在每个 data.frame 上迭代地应用您的函数，例如：`lapply(df.list, myFunc, <additional args>)`

* * *

由于您的 df 已经加载，并且它们具有方便的名称，因此您可以使用以下命令轻松获取它们：

```
nms     <- c(paste0("df.0", 0:9), paste0("df.", 10:99))
df.list <- lapply(nms, get) 
```

然后将您在该`#what I need done`部分中的所有内容放入一个函数中，例如：

```
myFunc <- function(DF) {

   # what you want done to a single DF
return(DF)
} 
```

然后`lapply`相应地

```
df.list <- lapply(df.list, myFunc) 
```

* * *

### 在单独的注释中，关于功能：

你`funTest`“什么都不做”的原因是你没有让它返回任何东西。也就是说，它*正在*做某事，但是当它做完*之后*，它就“什么都不做”。

您需要`return(.)`在函数中包含一条语句。或者，函数最后一行的输出（如果未分配给对象）将用作返回值——但最后一句话只是大致正确，因此需要谨慎。最干净的选择（在我看来）是使用`return(.)`

* * *

### 关于`for`循环`data.frame`

正如您所观察到的，**using**`for (i in someDataFrame) {...}`迭代.**`data.frame`**

 **您可以使用以下方法迭代行`apply`：

```
apply(myDF, MARGIN=1, function(x) { x$doy <- ...; return(x) } ) # dont forget to return 
```**

# sql - Rails 通过关联加入

> ID：16115747
> 
> 赞同：33
> 
> 时间：2013-04-20T01:59:40.030
> 
> 标签：sql, ruby-on-rails, ruby-on-rails-3, join, ruby-on-rails-3.2

在 Ruby on Rails 中，我想在城市中找到雇主。假设模型是这样设置的：

```
City
has_many :suburbs
has_many :households, :through => suburbs
has_many :people, :through => suburbs

Suburb
has_many :households
has_many people, :through => households
belongs_to :city

Household
has_many :people
belongs_to :suburb

People
belongs_to :household
belongs_to :employer

Employer
has_many :people 
```

我觉得我想要某种雇主加入 some_city.people 但我不知道该怎么做。如果人们直接属于城市，我可以将 Employer 加入到 city_id 是某物的人，但我想在没有直接加入的情况下找到相同的数据，我有点迷茫。

谢谢你。

* * *

## 回答 #1

> 赞同：46
> 
> 时间：2013-04-20T02:40:47.177

使用嵌套连接

```
Employer.joins({:people => {:household => {:suburb => :city}}}) 
```

应该给你你正在寻找的连接表。如果您正在穿越另一个方向，您将使用复数名称

```
City.joins( :suburbs => {:households => {:people => :employers }}) 
```

* * *

## 回答 #2

> 赞同：24
> 
> 时间：2013-04-20T02:53:18.543

您可以像 jvans 所说明的那样进行连接。或者您可以设置您的关系，如下所示：

```
class Employer < ActiveRecord::Base
  has_many :people
  has_many :households, through: :people
  has_many :suburbs, through: :households
  has_many :cities, through: :suburbs
end

class Person < ActiveRecord::Base
  belongs_to :household
  belongs_to :employer
end

class Household < ActiveRecord::Base
  belongs_to :suburb
  has_many :people
end

class Suburb < ActiveRecord::Base
  belongs_to :city
  has_many :households
  has_many :people, through: :households
end

class City < ActiveRecord::Base
  has_many :suburbs
  has_many :households, through: :suburbs
  has_many :people, through: :households
  has_many :employers, through: :people
end 
```

然后您可以直接加入`City`from `Employer`，反之亦然。

例如：

```
Employer.joins(:cities).where("cities.name = ?", "Houston").first

SELECT "employers".* FROM "employers" 
INNER JOIN "people" ON "people"."employer_id" = "employers"."id" 
INNER JOIN "households" ON "households"."id" = "people"."household_id" 
INNER JOIN "suburbs" ON "suburbs"."id" = "households"."suburb_id" 
INNER JOIN "cities" ON "cities"."id" = "suburbs"."city_id" WHERE (cities.name = 'Houston') 
LIMIT 1 
```

# ruby - 如何运行系统命令，并将 PID 传输到 pidfile？

> ID：16115748
> 
> 赞同：0
> 
> 时间：2013-04-20T02:00:11.130
> 
> 标签：ruby, unix

如何运行命令并将生成的 pid 通过管道传输到 pidfile 中？

我正在寻找一个 UNIX 命令，但如果有办法在 Ruby 中完成它，那也很好。

我试过：

```
bundle exec clockwork clock_local.rb echo $! > #{current_path}/tmp/pids/clockwork.pid 
```

它似乎将整个输出传递到 pidfile 而不仅仅是 pid。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-04-20T03:45:58.100

您可以使用 Ruby 的`BEGIN {...}`和`END {...}`来帮助自动创建和删除 PID 文件。将这些添加到 Ruby 脚本中：

```
BEGIN { File.write("#{ $0 }.pid", $$) }
END { File.delete("#{ $0 }.pid") } 
```

您可以测试他们是否使用以下简单脚本创建了一个简单的 PID 文件：

```
BEGIN { File.write("#{ $0 }.pid", $$) }
END { File.delete("#{ $0 }.pid") }
sleep 60 
```

然后运行它，在它运行时检查它所在的目录是否有 pid 文件。一分钟后，当`sleep`PID 文件过期时，应该会自动消失。

如果文件不可写或文件已经存在并被锁定，它们不会进行任何异常处理。如果脚本收到+`END`将触发并自动删除 PID 文件。`CNTRL``C`

您要添加的其他内容是对现有 PID 文件的测试，在创建后锁定文件以使其不能被覆盖，这可以通过使用独占锁保持打开状态来完成（请参阅 参考资料[`flock`](http://ruby-doc.org/core-2.0/File.html#method-i-flock)）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-20T02:25:54.083

如果在后台运行命令，则可以存储 pid：

```
bundle exec clockwork clock_local.rb & echo $! > tmp/pids/clockwork.pid 
```

# java - 从另一个类快捷方式检查天文台时间

> ID：16115749
> 
> 赞同：0
> 
> 时间：2013-04-20T02:00:30.077
> 
> 标签：java, android, class, chronometer

我有一个 Apple 类的天文台表。我想看看香蕉班的天文钟是几点钟的。我不想在 Class Banana 中创建 Chronometer，也不想在 Class Banana 中创建 Apple 对象。这可能吗？

谢谢！

让我知道我是否可以更具体。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-20T02:22:35.127

你的（大概）游戏中是否有不止一个苹果？

如果确实有一个，那么您可以将计时器设为 Apple 的公共静态成员，然后从您的 Banana 实例中读取它。像这样：

```
public class Banana {

 public void foo() {
   System.out.print(Apple.chronometer.printValue()); 
 }
} 
```

如果有多个 Apple 实例，那么您需要 1）将它们放入某个排序容器中；2) 通过对该容器的引用传入、设置或构造您的 Banana 实例；3）访问容器中相应的apple实例，读取chronometer的值，调用它的方法等实例。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-20T02:08:05.937

为 Apple 类中的 Chronometer 制作一个吸气剂，然后从香蕉中制作一个吸气剂，只需调用你的吸气剂

苹果：

`public Chronometer getMeter() { return mChronometer; }`

香蕉

`Chronometer meter = apple.getMeter();`

# groovy - Groovy 相当于 Scala 特征可堆叠修改？

> ID：16115757
> 
> 赞同：3
> 
> 时间：2013-04-20T02:01:46.177
> 
> 标签：groovy, traits

我一直在阅读 Programming Scala 书（Martin Odersky、Lex Spoon、Bill Venners ed1）并遇到了一些特征。我觉得有趣的部分是可堆叠的修改。使用的例子是

```
abstract class IntQueue {
  def get(): Int
  def put(x: Int)
}
trait Incrementing extends IntQueue {
  abstract override def put(x: Int) {super.put(x+1)}
}  
trait Filtering extends IntQueue{
  abstract override def put(x: Int){
    if(x >=0) super.put(x)
  }
} 
```

所以提供的示例有一个具体的类“BasicIntQueue，它扩展了 IntQueue，如下所示

```
import scala.collection.mutable.ArrayBuffer

class BasicIntQueue extends IntQueue{
  private val buf = new ArrayBuffer[Int]
  def get() = buf.remove(0)
  def put(x: Int) {buf +=x}
} 
```

`scala> val queue = (new BasicIntQueue with Incrementing with Filtering)`

`scala> queue.put(-1);queue.put(0);queue.put(1)`

`scala> queue.get() = 1`

因此，该示例显示过滤和递增都是“链接”的，并在元素“放入”队列之前执行。

我只是想知道如何在 Groovy 中实现这一点。由于 Groovy 的元可编程性，可能不需要它。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2014-04-28T18:37:43.173

从[Groovy 2.3](http://glaforge.appspot.com/article/groovy-2-3-0-is-out)开始， Groovy 支持[特征](http://beta.groovy-lang.org/docs/groovy-2.3.0/html/documentation/core-traits.html)和[可堆叠特征](http://beta.groovy-lang.org/docs/groovy-2.3.0/html/documentation/core-traits.html#_chaining_behavior)。因此，实现看起来与 Scala 中的完全一样：

```
interface IntQueue {
    Integer get()
    void put(Integer x)
}

trait Incrementing implements IntQueue {
    void put(Integer x) { super.put(x+1) }
}  
trait Filtering implements IntQueue {
    void put(Integer x) { if(x >= 0) super.put(x) }
}

class BasicIntQueue implements IntQueue {
    private buf = new ArrayList<Integer>()
    Integer get() { buf.remove(0) }
    void put(Integer x) { buf << x}
    String toString() { buf.toString() }
}

def queue = new BasicIntQueue().withTraits Incrementing, Filtering

queue.put(-1)
queue.put(0)
queue.put(1)
assert queue.get() == 1 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-20T04:29:10.777

Groovy 没有一种自然的方式来处理可堆叠的特征。类别提供了一些特征功能，但它们不太适合覆盖方法，并且如果没有太多元类魔法就无法堆叠。

groovy 中更好的方法是将装饰器模式与[`@Delegate`](http://groovy.codehaus.org/gapi/groovy/lang/Delegate.html)注释一起应用。每个“特征”都可以覆盖适当的行为并委托给“超级”类。例子：

```
interface IntQueue {
    def get()
    def put(x)
}

class Incrementing implements IntQueue {
    @Delegate IntQueue self
    def put(x) {
        self.put(x+1)
    }
}

class Filtering implements IntQueue {
    @Delegate IntQueue self
    def put(x) {
        if (x >= 0) {
            self.put(x)
        }
    }
}

class BasicIntQueue implements IntQueue {
  private buf = []
  def get() { buf.pop() }
  def put(x) { buf << x }
} 
```

然后，您可以构造一个具有所需特征的对象，如下所示：

```
def q = new Filtering(self: new Incrementing(self: new BasicIntQueue())) 
```

# ajax - Spring Security 在身份验证后继续触发相同的请求

> ID：16115761
> 
> 赞同：2
> 
> 时间：2013-04-20T02:02:15.777
> 
> 标签：ajax, spring, spring-security

当用户单击一个按钮时，会触发一个 Ajax 发布请求，如果他没有登录，则会打开一个登录对话框，该对话框由 Spring Security 处理。现在，当用户登录时，我想触发相同的 Ajax 发布请求。我如何实现这一目标？在 Ajax 发布请求中，我有标头和请求正文。

提前致谢

# c++ - 块矩阵乘法

> ID：16115770
> 
> 赞同：5
> 
> 时间：2013-04-20T02:04:38.410
> 
> 标签：c++, c, caching

我想执行块矩阵乘法（将矩阵划分为多个 sxs 矩阵并乘以相应的块）。我按照轩尼诗建筑书的示例代码编写了代码：

```
for(int jj=0;jj<=(n/s);jj += s){
            for(int kk=1;kk<=(n/s);kk += s){
                    for(int i=1;i<=(n/s);i++){
                            for(int j = jj; j<=((jj+s-1)>(n/s)?(n/s):(jj+s-1)); j++){
                                    temp = 0;
                                    for(int k = kk; k<=((kk+s-1)>(n/s)?(n/s):(kk+s-1)); k++){
                                            temp += b[i][k]*a[k][j];
                                    }
                                    c[j][i] += temp;
                            }
                    }
            }
    } 
```

这里，nxn 是原始矩阵的大小。a, b 矩阵大小相同。我将 a,b 矩阵划分为大小为 sxs 的块。在我的程序中，我将块大小设置为 4。我将 a、b 的所有元素设置为 5、a 和 n = 1000。但是，我的结果中的值是错误的。我在这里做错了吗？从过去的 2 个小时开始就一直坚持这一点。如果可能的话，你们能帮忙吗？书中的参考代码是这样的：

```
for (jj = 0; jj <= size; jj += N) {
    for (kk = 1; kk <= size; kk += N) {
        for (i = 1; i <= size; i++) {
            for (j = jj; j <= findMin(jj+N-1, size); j++) {
                temp = 0;
                for (k = kk; k <= findMin(kk+N-1, size); k++) {
                    temp += B[i][k] * A[j][k];
                }
                C[j][i] += temp;
            }
        }
     }
} 
```

这里，s=N 和 size = n/s

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-20T18:26:52.237

```
for(int jj=0;jj<N;jj+= s){
        for(int kk=0;kk<N;kk+= s){
                for(int i=0;i<N;i++){
                        for(int j = jj; j<((jj+s)>N?N:(jj+s)); j++){
                                temp = 0;
                                for(int k = kk; k<((kk+s)>N?N:(kk+s)); k++){
                                        temp += a[i][k]*b[k][j];
                                }
                                c[i][j] += temp;
                        }
                }
        }
} 
```

AxB 大小为 N

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-20T03:06:43.280

错误在这一行。你有

```
 temp += b[i][k]*a[k][j]; 
```

你应该有

```
 temp += b[i][k]*a[j][k]; 
```

反而。

如果您可以将这部分放在一个函数中而不是这一行中，那就更好了：

```
((jj+s-1)>(n/s)?(n/s):(jj+s-1)); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-20T02:20:05.580

乍一看，我很惊讶地看到 0 和 1 起始索引和 <= 循环终止测试。带有 fortran 或 matlab 代码的书籍有时会假设基于 1 的索引，而 c/c++ 使用基于 0 的索引。

您还可以分别实现和/或测试内部两个 for 循环，因为它们将用于单块矩阵乘法。

我会将 findMin 函数分开，而不是在循环测试中内联它。

# .net - 带有状态的立面设计模式

> ID：16115777
> 
> 赞同：1
> 
> 时间：2013-04-20T02:05:27.467
> 
> 标签：.net, oop, design-patterns

在实现了一个门面来隐藏一些复杂的子系统之后，我们最终得到了一个客户端类。但问题是这个单一的类仍然有超过 100 个 API。这似乎违反了凝聚力原则。外观类还管理状态，以便可以隐藏子系统之间使用的对象。该系统由子系统（例如项目、策略、用户、权限等）组成，我认为我们可能能够以更模块化的方式设计外观。在这种情况下，任何设计模式都可以很好地与外观配合使用吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-20T02:30:13.520

正如您已经说过的，在一个类中拥有 100 多个 API 并不是一个好主意。它们可以分为不同的外观类。通用功能可以移动到基类。这不是设计模式，而是 OO 的核心。状态仍可维持。我不确定您是否已经在使用会话作为存储来保存状态。如果是这样，您仍然可以继续这样做。

您还可以使用缓存来存储状态或使用数据库。如果您使用的是 EJB，那么 SFSB 会提供此功能。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-20T02:31:49.233

如果我们遵循领域驱动设计的原则，那么您可以将您的系统分为无状态服务和有状态实体。将服务和状态机组合在一个外观中不一定是一个好主意。

顺便说一句，在我看来，使用外观几乎就像将过程编程强制到面向对象的语言上一样。外观只是一组函数，就像非 OOP 语言中的模块一样。因此，通常我在使用 OOP 时尽量避免使用外观，尽管务实是件好事。

# php - MySQL 查询并获取 id 值

> ID：16115778
> 
> 赞同：0
> 
> 时间：2013-04-20T02:05:52.910
> 
> 标签：php, html, mysql

感谢您的光临！

我正在尝试为我的学校项目做一个电子商务网站。目的是用数据库中的内容填充我的网页，并且似乎没有记录 1 个特定条件，以便我能够从数据库中提取数据以呈现在网站上：

在我的主页上，我在侧边栏上有这个代码：它会导致一个 php 页面根据产品类别检索所有产品

```
 <ul class="left_menu">
    <li class="odd"><a href="categories.php?catno=10familia">Familia Originals</a></li>
    <li class="even"><a href="categories.php?catno=20familia">Ready to Cook</a></li>
    <li class="odd"><a href="categories.php?catno=30familia">Siomai and Buns</a></li>
    <li class="even"><a href="categories.php?catno=40familia">Pork Snacks</a></li>
    <li class="odd"><a href="categories.php?catno=50familia">Ready Made Dishes</a></li>
  </ul> 
```

我有这个代码/页面，它将通过使用 (id)catno= 来根据产品类别显示产品，以引用应该显示的类别。

```
// Sanitize the $_GET['catno'] and match with the correct category:
$sanitize = mysqli_real_escape_string($dbc, $_GET['catno']);

//match cases according to the product category
if ($sanitize == '10familia') {
$catid = 1;
} elseif ($sanitize == '20familia') {
$catid = 2;
} elseif ($sanitize == '30familia') {
$catid = 3;
} elseif ($sanitize == '40familia') {
$catid = 4;
} elseif ($sanitize == '50familia') {
$catid = 5;
} else {
$cat_error = '<div class="center"><h2>There are no products in this category. Please try again later.</h2></div>';
}
?>
<div class="center_content">
<div class="center_title_bar">Latest Products</div>
<div class="scroll_box_tall">
    <?
    $query = "SELECT product_id, name, price, thumbnail FROM products WHERE category_id = '$catid' ORDER BY product_id ASC";
    $request = mysqli_query($dbc, $query);

    if (mysqli_affected_rows($dbc) == 1) {
        while ($row = mysqli_fetch_array($request, MYSQLI_NUM)) {
            $item_id = $row[0]; // Assign product_id to $item_id to be passed on the href
            $item_name = $row[1]; // Assign name to var $item_name
            $item_price = $row[2]; // Assign price to var $item_price
            $item_thumb = $row[3]; // Assign thumbnail to $item_thumb
            // echo item name
            $div1 = '<div class="prod_box"><div class="top_prod_box"></div><div class="center_prod_box"><div class="product_title">' . $item_name . '</div>';
            // echo the thumbnail
            $div2 = '<div class="product_img"><a href="show_product.php?idno=' . $item_id . '"><img src="product/thumb/' . $item_thumb . '" alt="' . $item_name . '"/></a></div>';
            // echo the price
            $div3 = '<div class="prod_price"><span class="price">RRP &pound; ' . $item_price . '</span></div></div><div class="bottom_prod_box"></div></div>';
            echo "$div1$div2$div3";
        }
    } else { // Say an error message if there is no products in the category or the query is unsuccessful
        echo '<div class="center"><h2>There are no products in this category. Please try again later.</h2></div>';
    } ?>
</div> 
```

条件 if/else 运行良好，并且在检索产品并将其显示在页面上时完美运行。（categories($catid) 2,3,4,5 - 如果点击了各自的链接，则工作正常）我的主要问题是所有条件 if/else 都记录了除第一个之外的值：

```
if ($sanitize == '10familia') {
$catid = 1;
} 
```

没有为查询记录值 $catid= 1 以从数据库中的类别 1 中提取所有产品。

我不知道为什么这个特定的条件不起作用，但其他四个相同的工作..

注意：我刚开始使用 php，如果有更好的方法来执行 if-else，我深表歉意，我使用的是 if/elseif 方法。

谢谢你们。:)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-20T02:46:55.043

`mysqli_real_escape_string($dbc,$string)`用于清洁输入。你不想在用 PHP 做任何事情之前使用它。它专门用于 MySQL，这就是它需要数据库连接的原因。

```
 $catno = $_GET['catno']; 
```

`switch()`您可以使用以下语句代替 if （仍然可以） ：

```
switch($catno){

  case '10familia':
    $catid = 1;
  break;

  case '20familia':
    $catid = 2;
  break;

  case '30familia':
    $catid = 3;
  break;

  case '40familia':
    $catid = 4;
  break;

  case '50familia':
    $catid = 5;
  break;

  default:
  $cat_error = '<div class="center"><h2>There are no products in this category. Please try again later.</h2></div>';
  $cat_id=-1;
  echo $cat_error;
} 
```

为简洁起见，我将在此处省略代码的 HTML 部分。

由于我们甚至没有`$catno`用于查询数据库，因此没有必要`mysqli_real_escape_string()`对它进行操作，因为我们现在有一个 var ( `$cat_id`)，它可能会插入到我们自己设置的数据库的 SQL 语句中。不过，这通常是您清理任何用户提供的变量以进行插入的地方。

现在我们要看看那个 var 是否是正数。如果前一个 var 没有正确传递，我们预计它是负数。

```
if($cat_id > -1){ 
```

作为一种偏好，我喜欢在尝试让 MySQL 跳过很多环节以查看连接是否会失败之前，先提取一个计数查询来检查简单的事情，例如表的存在。这是一个额外的查询，但它可以在传递了错误语句的大量查询上节省大量开销。如果您不追逐很多交叉表故障，也更容易追捕。

```
$count = mysql_result(mysqli_query($dbc, "select count(*) from products where category_id='$catid'"),0);

if ($count == 1){
$query = "SELECT product_id, name, price, thumbnail FROM products WHERE category_id = '$catid' ORDER BY product_id ASC";
$request = mysqli_query($dbc, $query);
while ($row = mysqli_fetch_array($request)) { 
```

在这些我喜欢实际设置我正在拉的列的名称。一旦您进入更大的表格，这将有所帮助，因此您不必弄清楚第 45 列的作用。此外，它还使可能与您一起工作或继承项目的人更容易。

```
 $item_id = $row['product_id']; // Assign product_id to $item_id to be passed on the href
        $item_name = $row['name']; // Assign name to var $item_name
        $item_price = $row['price']; // Assign price to var $item_price
        $item_thumb = $row['thumbnail']; // Assign thumbnail to $item_thumb
        // echo item name 
```

要养成的习惯是在 div 之类的内容之后创建一个新行，这样您就可以在前端对 HTML 代码进行故障排除。

```
 $nl = "\n";

        $div1 = '<div class="prod_box">'.$nl.'<div class="top_prod_box"></div>'.$nl.'<div class="center_prod_box">'.$nl.'<div class="product_title">'.$item_name.'</div>'.$nl;
        // echo the thumbnail
        $div2 = '<div class="product_img"><a href="show_product.php?idno='.$item_id.'"><img src="product/thumb/'.$item_thumb.'" alt="'.$item_name.'"/></a></div>'.$nl;
        // echo the price
        $div3 = '<div class="prod_price"><span class="price">RRP &pound; ' . $item_price . '</span></div>'.$nl.'</div>'.$nl.'<div class="bottom_prod_box"></div>'.$nl.'</div>'.$nl;
        echo "$div1$div2$div3";
    }

} else { // Say an error message if there is no products in the category or the query is unsuccessful
    echo '<div class="center"><h2>There are no products in this category. Please try again later.</h2></div>';
} ?> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-20T02:19:31.753

只是猜测，因为没有关于您的测试数据的信息，但这看起来很可疑：

```
if (mysqli_affected_rows($dbc) == 1) { 
```

这将检查查询是否只返回了*一行*。您的测试数据是否有可能在类别 2 到 5 中包含一行，而在类别 1 中包含多行？尝试将逻辑更改为：

```
if (mysqli_affected_rows($dbc) > 0) { 
```

# input - 掩码在 PHP 中输 入电话号码

> ID：16115780
> 
> 赞同：0
> 
> 时间：2013-04-20T02:06:37.770
> 
> 标签：input, mask

我是 PHP 新手我想做的就是屏蔽输入电话号码，它不允许使用 Javascript 或 Jquery

```
$_SESSION["oh"]["phone"]=(empty($_SESSION["oh"]["phone"]))?$_COOKIE["phone"]:$_SESSION["oh"]["phone"]; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-20T04:40:52.527

按照某种模式屏蔽手机并对其进行验证

```
$pattern = "/^([1]-)?[0-9]{3}-[0-9]{3}-[0-9]{4}$/i" 
```

[参考](http://plasticbrain.net/resources/php-validate-email-address-and-phone-number/)

AFAIK，我们使用了 jquery 中的 mask() 它有助于验证它

```
$("#phone").mask("(999) 999-9999"); 
```

使用起来很方便

# c++ - 消息队列操作的“无效参数”

> ID：16115781
> 
> 赞同：0
> 
> 时间：2013-04-20T02:06:55.033
> 
> 标签：c++, posix, message-queue, msg

我正在尝试通过父进程与其分叉子进程之间的消息队列发送一个 1KB 的字符串。`msgsnd`不幸的是，我对,等的调用`msgrcv`突然都返回 -1 并导致`EINVAL`错误。

我发现这个错误（`msgsnd`例如在 的情况下）发生在`msqid`无效、消息类型参数设置为 <1 或`msgsz`超出范围时。但据我所知，经过测试，`msgget`它返回了一个完全有效的 ID 号，并且类型设置得很好。我的缓冲区范围肯定有问题，但我认为我设置正确。在代码中，我添加了注释来解释（对不起所有疯狂添加的#includes）：

```
#include <errno.h>  
#include <stdio.h>
#include <iostream> 
#include <stdlib.h>
#include <string.h>
#include <string> 
#include <cstring> 
#include <sys/msg.h>
#include <sys/stat.h>
#include <sys/types.h>
#include <unistd.h>
#include <sys/time.h>
#include <sstream> 

#define PERMS (S_IRUSR | S_IWUSR) 
#define NUMBYTES 1024 //number of chars (bytes) to be sent 

using namespace std; 

//Special structure for messages
typedef struct {
  long mtype; 
  char mtext[NUMBYTES];  
} mymsg_t; 

int main(){

  //Construct a generic test message of the specified size
  char message[NUMBYTES];
  for(int i = 0; i < NUMBYTES; i++)
    message[i] = 'a';  

  //Create the message queue (accessed by both parent
  //and child processes)
  int msqid;
  int len;  
  if(msqid = msgget(IPC_PRIVATE, PERMS) == -1)
    perror("Failed to create new message queue!\n");   

  if(fork() == 0){  //Child process...does the sending

    mymsg_t* mbuf;
    len = sizeof(mymsg_t) + strlen(message); //doesn't work with " + sizeof(message)" either 

    void* space; 
    if((space = malloc(len)) == NULL) //this works fine; no error output 
      perror("Failed to allocate buffer for message queue.\n"); 
    mbuf = (mymsg_t*)space;  

    strcpy(mbuf->mtext, message); 
    mbuf->mtype = 1; //a default   

//Some error checks I tried... 
//cout<<"msqid is " << msqid << endl;
//cout << "mbuf ptr size is " << sizeof(mbuf) << ". And this non-ptr: "<<sizeof(*mbuf)<<". And 
//len: "<<len<<endl; 

    if(msgsnd(msqid, mbuf, len+1, 0) == -1)
      perror("Failed to send message.\n");  //this error occurs every time! 

    free(mbuf);  
  }    

  else{ //Parent process...does the receiving 

    usleep(10000); //Let the message come     

    mymsg_t mymsg; //buffer to hold message
    int size; 
    if((size = msgrcv(msqid, &mymsg, len+1, 0, 0)) == -1) //error every time
      perror("Failed to read message queue.\n");  

    //checking that it made it 
    //cout << "Hopefully printing it now? : " << endl; 
    //if(write(STDOUT_FILENO, mymsg.mtext, size) == -1)
    //  perror("Failed to write to standard output!\n"); 

  }

  ostringstream oss;
  oss << "ipcrm -q " << msqid; 
  string command = oss.str(); 

  if(system(command.c_str()) != 0)  //also errors every time, but not main focus here 
    perror("Failed to clean up message queue!"); 
} 
```

这里发生了什么？我以为我的缓冲程序工作正常并且有足够的空间..

# php - 随机数插入 mySQL 不起作用

> ID：16115785
> 
> 赞同：0
> 
> 时间：2013-04-20T02:07:41.413
> 
> 标签：php, mysql, random, insert, int

嘿，我创建了 2 个随机数，如下所示：

```
 $firstlink = intval(mt_rand(100, 999) . mt_rand(100, 999) . mt_rand(1, 9) . mt_rand(100, 999)); // 10 digit
 $secondLink = intval(mt_rand(1000, 999) . mt_rand(1, 999) . mt_rand(10, 99) . mt_rand(100, 999)); 
```

这是我的插入代码：

```
$result = mysql_query("INSERT INTO userAccount 
                     (Category,Fname,LName,firstlink,secondLink,AccDate) 
                      VALUES (  '" . $cat . "',
                                '" . $fname . "',
                                '" . $lname . "',
                                " . $firstlink . ",
                                " . $secondLink . ",
                                '" . date('Y-m-d g:i:s',time()). "');"); 
```

它没有错误，它将数据放入 mysql 数据库中。但是，无论我将谁添加到数据库中，*firstlink*和**secondLink的** *编号始终相同，我不知道为什么要这样做！*

 **两行的**数据类型**都是**INT(15)**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-20T02:45:36.613

删除 intval 一切都会正常工作。

```
$firstlink = mt_rand(100, 999) . mt_rand(100, 999) . mt_rand(1, 9) . mt_rand(100, 999); // 10 digit 
```

32 位系统的最大有符号整数范围为 -2147483648 到 2147483647。使用 intval 时，您主要得到 2147483647。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-20T03:01:46.260

您可以像这样简化代码并提高代码的随机性：

```
$firstlink = mt_rand(10000,99999) . mt_rand(10000,99999);
$secondLink = mt_rand(10000,99999) . mt_rand(10000,99999);

    echo "INSERT INTO userAccount 
                     (Category,Fname,LName,firstlink,secondLink,AccDate) 
                      VALUES (  '" . $cat . "',
                                '" . $fname . "',
                                '" . $lname . "',
                                " . $firstlink . ",
                                " . $secondLink . ",
                                '" . date('Y-m-d g:i:s',time()). "');" 
```

PHPFiddle：[http ://phpfiddle.org/main/code/6nf-wpk](http://phpfiddle.org/main/code/6nf-wpk)

这将通过制作两个随机的 5 位代码并将它们连接在一起来构建您的随机 10 位代码。Is 更简单，更容易理解，用更少的部分组成。必须使用两个 mt_rand() 来完成，因为可能的最大数字是 2147483647。对于您正在使用的每个 mt_rand() 函数，您要防止 0 成为该数字部分的第一个数字，因为您'在 1 到 9 之间开始第一个数字。

如果您不关心第一个数字只是 1 或 2（而不是 3-9 或 0），您可以简单地使用

```
$firstlink = mt_rand(1000000000,2147483647);  // random 10 digit number
$secondLink = mt_rand(1000000000,2147483647); // random 10 digit number 
```

作为一般编码提示：

*   与您命名变量的方式保持一致。您在“$firstlink”中有一个小写“L”，在“$secondLink”中有一个大写“L”。PHP 区分大小写，您最终会使用错误的名称并在程序的其他地方得到意外的（空白）结果。
*   请注意，切勿将任何用户提供的数据放入 SQL 命令中，以免受到 SQL 注入攻击。通常使用参数化查询。请参阅[如何防止 PHP 中的 SQL 注入？](https://stackoverflow.com/questions/60174/how-to-prevent-sql-injection-in-php)有关更多详细信息和示例。**

# ios - OpenGL ES 2.0 捏合和缩放

> ID：16115787
> 
> 赞同：1
> 
> 时间：2013-04-20T02:07:47.063
> 
> 标签：ios, opengl-es, 3d, glkit

在 iOS 上的 OpenGL ES 1.1 中，我曾经通过使用以下设置视野来实现捏合和缩放：

```
// Handles Touches Events
- (IBAction)handlePinchGesture:(UIGestureRecognizer *)sender 
{
    static float startFOV=0.0;
    CGFloat factor = [(UIPinchGestureRecognizer *)sender scale];
    UIGestureRecognizerState state;

    state=sender.state;

    if(state==UIGestureRecognizerStateBegan)
    {      
        startFOV=[self getFieldOfView];
    }
    else if(state==UIGestureRecognizerStateChanged)
    {
        float minFOV=5.0;
        float maxFOV=12.0;
        float currentFOV;

        currentFOV=startFOV*factor;

        if((currentFOV>=minFOV) && (currentFOV<=maxFOV))
            [self setFieldOfView:currentFOV];
    }     
} 
```

使用捏合手势我会做这样的事情：

```
// Set the fulstrum and our field of view for the window
-(void)setClipping
{
    // Near and far are the front and back walls
    // FOV is in degrees
    float aspectRatio;
    const float zNear = .1;                 
    const float zFar = 2000;                    
    GLfloat size;
    float scale;

    // Get the main screen and define the aspect ratio
    CGRect frame = [[UIScreen mainScreen] bounds];      
    aspectRatio=(float)frame.size.width/(float)frame.size.height;                   
    scale=[[UIScreen mainScreen]scale];

    // Use the 2D projection matrix to project our 3D into 2D
    glMatrixMode(GL_PROJECTION);                
    glLoadIdentity();
    if (m_FieldOfView > 75.0) {
        m_FieldOfView = 75.0;
    }
    size = zNear * tanf(GLKMathDegreesToRadians (m_FieldOfView) / 2.0); 

    // Define the pyramid of Giza (4 sided pyramid with top lopped off on its side)
    // ... this is how were viewing things
    glFrustumf(-size, size, -size/aspectRatio, size/aspectRatio, zNear, zFar);  
    glViewport(0, 0, frame.size.width*scale, frame.size.height*scale);      

    // To be safe go back to tranformational matrix
    glMatrixMode(GL_MODELVIEW);             
} 
```

我制作了一个简单的 OpenGL ES 2.0 应用程序，我的更新方法看起来（部分）如下所示：

```
#pragma mark - GLKView and GLKViewController delegate methods

- (void)update
{

    // Set up the frustrum and projection matrix
    float aspect = fabsf(self.view.bounds.size.width / self.view.bounds.size.height);
    GLKMatrix4 projectionMatrix = GLKMatrix4MakePerspective(GLKMathDegreesToRadians(65.0f), aspect, 0.1f, 100.0f);
    self.effect.transform.projectionMatrix = projectionMatrix; 
```

我一直在网上搜索如何使用 OpenGL ES 2.0 做到这一点......但无济于事。我如何在 2.0 中做到这一点？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-20T17:50:56.210

将 GLKMatrix4MakePerspective的**第一**项乘以一个因子（属性或类变量）并在手势识别器中更改该因子 - 与您在 1.1 方法中所做的没有太大区别。

这是我从 GestureRecogniser 调用的方法。以 _ 开头的变量是类变量。ZOOMTOUCHSENSITIVITY 是一个预处理器定义。

```
-(void)Scale:(UITapGestureRecognizer*)sender
{

    CGFloat scale = _lastScale + (1.0 - [(UIPinchGestureRecognizer*)sender scale])*ZOOMTOUCHSENSITIVITY;

    float newScale = MAX(0.1, MIN(scale, 3));
    _projectionMatrix = GLKMatrix4MakePerspective(newScale*GLKMathDegreesToRadians(45.0f), (float)_screenWidth/(float)_screenHeight, 100.0f, 1000.0f);
    if([(UIPinchGestureRecognizer*)sender state] == UIGestureRecognizerStateEnded) {
        _lastScale = newScale;
        return;
    }
} 
```

请注意我如何保存`scale`手势停止后的最后一个值，以便缩放不会每次都“重置”。

# javascript - 在提交期间传递一个返回 ko.computed 错误值的函数

> ID：16115790
> 
> 赞同：2
> 
> 时间：2013-04-20T02:07:52.340
> 
> 标签：javascript, knockout.js

我在提交带有淘汰赛 js 的表单时遇到问题。

我收到错误“传递返回 ko.computed 值的函数”。

代码如下：

```
 (function(records,$,undefined){
        records.models={
            student:function(data){
                var self=this;
            self.id=ko.observable(data.id);
            self.fname=ko.observable(data.fname);
            self.lname=ko.observable(data.lname);
            if(data.initial==='undefined'||data.initial===null){
                self.initial=ko.observable("");
            }else{
                self.initial=ko.observable(data.initial);
            }
            self.fullname=ko.computed(function(){
                return self.fname()+" "+" "+self.initial()+" "+self.lname();
            });
        },
        students_model:function(){
            var self=this;
            self.selectedStudent=ko.observable();
            self.students=ko.observableArray([]);
            getStudents();              

            self.save=function(){
                var form=$("#student-form");
                $.ajax({
                    type:"POST",
                    url:"/Student/create",
                    data:ko.toJSON(form[0]), //This line here is the exact point of failue
                    success:function(response){
                        records.general.handleSuccess(response);
                        if(response.status){
                            getStudents();
                        }       
                    }

                });
                return false;
            };
            function getStudents(){
                $.getJSON("/Student/data",function(result){
                    var mapped=$.map(result,function(item){
                        return new records.models.student(item);});
                    self.students(mapped);
                });
            }
        }
    };
    return records;
}(window.records=window.records||{},jQuery)); 
```

# HTML

```
@using (Ajax.BeginForm("Create", "Student",
new AjaxOptions
{
    HttpMethod = "Post"
},
new { @class = "student-form", name = "student-form", id = "student-form" }))
{ 
<input type="text" data-bind="value:$root.fname" id="student.fname" name="student.fname" />
<input type="text" data-bind="value:$root.lname" id="student.lname" name="student.lname"/>
<input type="text" data-bind="value:$root.initial" id="student.initial" name="student.initial"/>
<input type="text" data-bind="value:$root.dob" id="dob" name="dob" />
<button data-bind="click:save">Save</button>
}

<script type="text/javascript">
ko.applyBindings(new records.models.students_model());
</script> 
```

我在这里做错了什么？我在这里知道这个问题：[传递一个返回 ko.computed 值的函数](https://stackoverflow.com/questions/12473249/pass-a-function-that-returns-the-value-of-the-ko-computed) 但似乎那个人有不同的问题。以 save 方法启动时，我的代码失败。特别是这一行：

```
data:ko.toJSON(form[0]) 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-05-03T14:46:05.623

`ko.toJSON`期望您将 viewModel 传递给它，但是您将 DOM 中的元素传递给它，因此会出现错误。

您需要将 javascript 对象（视图模型或视图模型的一部分）传递给`ko.toJSON`. 例如，如果你想发送一组学生，你可以这样做：

```
ko.toJSON(self.students); 
```

我看到您的表单有一些输入绑定到`$root.fname`、`$root.lname`、`$root.initial`和`$root.dob`，但我不确定这些输入存在于您的视图模型中的什么位置，所以我无法准确告诉您要传递什么。但我可以给你一个例子，说明一种方法可以解决这个问题。

如果您有一个看起来像这样的视图模型：

```
var data = ...;
var vm = {
  newStudent : {
    fname : ko.observable(data.fname),
    lname: ko.observable(data.lname),
    initial: ko.observable(data.initial ?? ""),
    dob: ko.observable(data.dob)
  }
} 
```

然后你通过调用将它绑定到你的dom

```
ko.applyBindings(vm); 
```

然后你可以这样调用`ko.toJSON` ：

```
...
data:ko.toJSON(vm.newStudent),
... 
```

# javascript - 动态添加的输入未在屏幕上更新

> ID：16115793
> 
> 赞同：0
> 
> 时间：2013-04-20T02:08:13.140
> 
> 标签：javascript, jquery, callback

我是 JavaScript 新手，所以请耐心等待。

我在下面有这段代码来检查文本输入字段的值，如果它匹配，那么我会触发我的自定义对话框对象/函数，它显示一个对话框模式窗口。

现在我的目标是清除触发对话框以在`Cancel`单击按钮时打开的文本输入

我有一个名为 Callback 的函数`cancelCallback`，我可以将其传递给我的 Dialog 函数。

在我的示例中，您可以看到我已经缓存了输入字段选择器`hostnameSelector`，然后将其传递到我的回调中。

在其下方，您可以看到我将对象打印到控制台。控制台显示我的文本字段的新值，但它不会在屏幕上更新。

这可能是因为文本输入字段是动态添加到屏幕/DOM 中的？

关于如何让它工作的任何想法？如果需要帮助，我也可以使用最新的 jQuery

```
// Show Notice if Hostname Matches the Domain Name
$(document).on('change','div.hostName > input',function() {

    // cached Input Selector
    var hostnameSelector = $(this);

    var hostName = $(this).val();
    var domainName = $("#domainName").val();
    var pattern = new RegExp(domainName + "$","g");
    if ( hostName.match(pattern) != null ) {

        var msg = 'Are you sure you want to delete action?';

        zPanel.dialog.confirm({
            heading: 'ATTENTION',
            message: msg,
            width: 300,
            cancelCallback: function (hostname) {
                    hostnameSelector .value = 'hi';
                    console.log(hostnameSelector);
            },
            cancelButton: {text: 'Cancel', show: true, class: 'btn-default'},
            okButton: {text: 'Confirm', show: true, class: 'btn-primary'},
        });

    }
}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-20T02:25:30.190

CancelCallback 应该通过调用来设置新值：

```
hostnameSelector.val("hi") 
```

# python - 将文件保存在新目录中（python）

> ID：16115804
> 
> 赞同：2
> 
> 时间：2013-04-20T02:11:35.627
> 
> 标签：python, directory, save, subdirectory

我正在尝试获取输入文件并将其保存到计算机上的新文件夹中，但我不知道如何正确执行。

这是我尝试过的代码：

```
from os.path import join as pjoin
a = raw_input("File Name: ")
filepath = "C:\Documents and Settings\User\My Documents\'a'"
fout = open(filepath, "w")
path_to_file = pjoin("C:\Documents and Settings User\My Documents\Dropbox",'a')
FILE = open(path_to_file, "w") 
```

当我运行它时，它`\`在每个子目录之间放置两个而不是一个，它告诉我它不是现有文件或目录。

我相信有一种更简单的方法可以做到这一点，请帮忙。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-20T02:33:25.587

为什么你没有逃脱`"'quotes_like_this_inside_quotes'"`？这可能是失败的一个原因。

据我了解，您要保存到的目录是`"C:\Documents and Settings\User\My Documents\'`和`'C:\Documents and Settings\User\My Documents\'`.

每当您弄乱目录/路径时，请始终使用`os.expanduser('~/something/blah')`.

尝试这个：

```
from os.path import expanduser, join

path_to_file1 = join(expanduser('~/Dropbox/'), 'a')
path_to_file2 = join(expanduser('~'), 'a')
fout = open(path_to_file2, "w")
FILE = open(path_to_file1, "w") 
```

双反斜杠没问题，AFAIK。让我知道这是否有效 - 我目前不在 Windows 机器上。

# java - 如何将两个字符串数组成员添加到一个字符串变量中

> ID：16115806
> 
> 赞同：0
> 
> 时间：2013-04-20T02:11:59.957
> 
> 标签：java, arrays, string

我一直在试图弄清楚如何在没有运气的情况下将额外的字符串数组成员添加到字符串变量中。这是代码。

```
 myDirString = myDirString.trim();
    String[] myDirStringParts = myDirString.split(" +");

    MySize = myDirStringParts[0];
    MyNum =  myDirStringParts[1];
    Total =  myDirStringParts[2];
    MyName = myDirStringParts[3]; 
```

基本上我`myDirStringParts[2];`也想加入`MyName`。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-20T02:40:13.303

```
MyName = myDirStringParts[3] + myDirStringParts[2]; 
```

将工作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-20T02:39:15.773

简单地

```
MyName = myDirStringParts[3] + myDirStringParts[2]; 
```

应该做的伎俩。

但是，我注意到有关您的代码的一些事情，我想指出：

1.  声明变量`MyName`, `Total`, `MyNum`, `MySize`。
2.  确保调用`myDirStringParts`后至少包含 3 个元素`split(" +")`。

您可以通过以下代码片段执行此操作：

```
if(myDirStringParts.length >= 4) {  
    MySize = myDirStringParts[0];
    MyNum = myDirStringParts[1];
    Total = myDirStringParts[2];
    MyName = myDirStringParts[3] + myDirStringParts[2];
}  else {  
    // print out an error message.  
    System.err.println("myDirString does not contain all the required data!");  
} 
```

# c++ - 创建动态字符串数组时出现段错误

> ID：16115807
> 
> 赞同：0
> 
> 时间：2013-04-20T02:12:07.817
> 
> 标签：c++, segmentation-fault

我的朋友正在编写一个基于文本的游戏，并要求我查看这个崩溃的代码。我对其进行了调试，并且在创建动态数组时出现了段错误。我不确定为什么，我建议他完全避免使用指针并使用向量，希望这能解决他的问题，但我很好奇这里到底出了什么问题。这是他的代码：

```
#include <iostream>
#include <fstream>
#include <string>
#include <cstdlib>
#include <ctime>

using namespace std;

class nation
{
    public:
    void init();
    string genName();
    string getName();

    private:
    string myName;
    int* myBorderPoints;
};

string nation::getName()
{
    return myName;
}

string nation::genName()
{
    int listLength = 0, listPos = 0, listRand = 0;
    string nameToGen = "";
    string* namePartList;
    ifstream fileName;
    fileName.open("NamePart1.txt");
    listLength = fileName.tellg();
    namePartList = new string[listLength]; // Seg fault here
    while (fileName.good())
    {
        while (!fileName.eof())
        {
            getline(fileName,namePartList[listPos]);
            listPos += 1;
        }
    }
    listRand = rand() % listLength;
    nameToGen += namePartList[listRand];
    fileName.close();
    listLength = 0;
    listPos = 0;
    listRand = 0;
    nameToGen = "";
    fileName.open("NamePart2.txt");
    listLength = fileName.tellg();
    namePartList = new string[listLength];
    while (fileName.good())
    {
        while (!fileName.eof())
        {
            getline(fileName,namePartList[listPos]);
            listPos += 1;
        }
    }
    listRand = rand() % listLength;
    nameToGen += namePartList[listRand];
    fileName.close();
    return nameToGen;
}

void nation::init()
{
    srand(time(NULL));
    myName = genName();
}

int main()
{
    nation testNation;
    testNation.init();
    cout << testNation.getName();
    return 0;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-20T02:23:19.610

你在打电话`tellg`：

```
listLength = fileName.tellg(); 
```

没有读取任何内容，这取决于文件是否成功打开将返回`0`，`-1`因此您将调用它：

```
namePartList = new string[listLength] 
```

可能是一个不受欢迎的值。我很确定它会返回`-1`，因为[分配零大小](https://stackoverflow.com/a/1087066)应该没问题。

这也适用于稍后的代码，`std::vector`可能更有意义。

# html - 以及 video-js youtube 播放列表播放器的字幕/字幕

> ID：16115808
> 
> 赞同：4
> 
> 时间：2013-04-20T02:12:09.220
> 
> 标签：html, video.js

我编辑了一些代码并进行了一些更改以使 video-js youtubeplaylist 播放器正常工作

我想知道如何在播放列表中添加字幕

示例在这里：

[http://bestimage.x10.mx/Playlist_yt/YouTube_PlayList.html](http://bestimage.x10.mx/Playlist_yt/YouTube_PlayList.html)

```
<!DOCTYPE html>
<html>
<head>
     <title>YouTube Playlist Video Player</title>

 <link href="./css/video-js.css" rel="stylesheet">
 <link href="./css/video-js_playlist.css" rel="stylesheet" type="text/css">

 <script src="./js/video-js_youtube.js"></script>
 <script src="./js/video-js_playlist.js"></script>
     <script>_V_.options.flash.swf = "video-js.swf";</script>

</head>

<body>

<div text-align:center>
  <video id="vid1"
     class="video-js vjs-default-skin"
     controls
     preload="auto"
     width="854"
     height="480"
     data-setup='{"techOrder":["html5","flash","youtube"],"ytcontrols":false,
       "playlist":[
        {"thumb_url":"media/gates_th.jpg",
           "poster_url":"",
           "sources":[
             {"src":"http://www.youtube.com/watch?v=fQ-ktGaWYlg",
              "type":"video/youtube",
              "media":"",
              "title":""},
            ]
          },
        {"thumb_url":"media/AndYouAndI_th.jpg",
           "poster_url":"",
           "sources":[
             {"src":"http://www.youtube.com/watch?v=AYmeJlm7Gcg",
              "type":"video/youtube",
              "media":"",
              "title":""},
           ]
          },
        {"thumb_url":"media/CloseToTheEdge_th.jpg",
           "poster_url":"",
           "sources":[
             {"src":"http://www.youtube.com/watch?v=Ne317y_eOYs",
              "type":"video/youtube",
              "media":"",
              "title":""},
           ]
          },
        {"thumb_url":"media/AllGoodPeople_th.jpg",
           "poster_url":"",
           "sources":[
             {"src":"http://www.youtube.com/watch?v=bu1p2raTsbA",
              "type":"video/youtube",
              "media":"",
              "title":""},
           ]
          },
        {"thumb_url":"media/PerpetualChange_th.jpg",
           "poster_url":"",
           "sources":[
             {"src":"http://www.youtube.com/watch?v=1GYl3rVhQMY",
              "type":"video/youtube",
              "media":"",
              "title":""},
           ]
          },
        {"thumb_url":"media/BabaORiley_th.jpg",
           "poster_url":"",
           "sources":[
             {"src":"http://www.youtube.com/watch?v=hKUBTX9kKEo",
              "type":"video/youtube",
              "media":"",
              "title":""},
           ]
          },
        {"thumb_url":"media/WhoAreYou_th.jpg",
           "poster_url":"",
           "sources":[
             {"src":"http://www.youtube.com/watch?v=zufuNr1GBYI",
              "type":"video/youtube",
              "media":"",
              "title":""},
           ]
          },
        {"thumb_url":"media/PinballWizard_th.jpg",
           "poster_url":"",
           "sources":[
             {"src":"http://www.youtube.com/watch?v=aOUqRZkR8dE",
              "type":"video/youtube",
              "media":"",
              "title":""},
           ]
          },
        {"thumb_url":"media/MagicBus_th.jpg",
           "poster_url":"",
           "sources":[
             {"src":"http://www.youtube.com/watch?v=ob9w9F12SZM",
              "type":"video/youtube",
              "media":"",
              "title":""},
           ]
          },
        {"thumb_url":"media/5_15_th.jpg",
           "poster_url":"",
           "sources":[
             {"src":"http://www.youtube.com/watch?v=9Qv6QTrWXN4",
              "type":"video/youtube",
              "media":"",
              "title":""},
           ]
          }
        ]

      }'>
   </video>
  </div>
 </body>
</html> 
```

TIA

# linux - Linux上的虚拟时钟速度限制

> ID：16115812
> 
> 赞同：1
> 
> 时间：2013-04-20T02:13:08.920
> 
> 标签：linux, virtualization, kvm, lxc, system-clock

随意节流特定进程的执行和显示速度，例如游戏、Flash 游戏或 OpenGL 游戏。我希望能够将其减慢到 20% 或 0.5%。这在 linux 的主机空间上根本不可能。

但是 linux 支持两种内核级虚拟化环境：`KVM`和`lxc`.

问题：是否可以为虚拟 lxc 或 KVM 机器提供一个虚假的系统时钟，以使在来宾中运行的 Flash 游戏运行速度不会超过设置运行的速度？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-20T13:55:27.160

一些选择：

1.  [Qemu 刹车片](http://www.miroslavnovak.com/qemu-brake_en.php)（毫无疑问需要工作才能应用。）
2.  [Bochs 有 ips=NNNN](http://bochs.sourceforge.net/doc/docbook/user/bochsrc.html#BOCHSOPT-CPU)来定义 CPU“每秒指令数”。
3.  [`cpulimit`](http://limitcpu.sourceforge.net/)用于限制进程 CPU 使用率的工具（不需要虚拟化。）

更新：你想要这个：[https ://superuser.com/questions/454534/how-can-i-slow-down-the-framerate-of-a-flash-game](https://superuser.com/questions/454534/how-can-i-slow-down-the-framerate-of-a-flash-game)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-21T09:23:24.083

我找到了适用于 linux 的 CheatEngine speed hack 的原型版本。

[http://forum.cheatengine.org/viewtopic.php?t=533437&sid=1a83d81ee08f8479eb8b190939b2e1aa](http://forum.cheatengine.org/viewtopic.php?t=533437&sid=1a83d81ee08f8479eb8b190939b2e1aa)

[http://code.google.com/p/xeat-engine/source/checkout](http://code.google.com/p/xeat-engine/source/checkout)

[http://pastebin.com/ZLryd20D](http://pastebin.com/ZLryd20D)

基本上它`gettimeofday`用一个使用`LD_PRELOAD`魔法的黑客版本代替。它完美地工作！

谢谢利莱泽克！无论你在哪！

# performance - Ackermann 使用 Haskell/GHC 效率很低

> ID：16115815
> 
> 赞同：50
> 
> 时间：2013-04-20T02:13:35.853
> 
> 标签：performance, haskell, optimization, recursion, benchmarking

我尝试计算**`Ackermann(4,1)`**，不同语言/编译器之间的性能差异很大。以下是我的**Core i7 3820QM, 16G, Ubuntu 12.10 64bit**上的结果，

**C：1.6s**，`gcc -O3` *（使用 gcc 4.7.2）*

```
int ack(int m, int n) {
  if (m == 0) return n+1;
  if (n == 0) return ack(m-1, 1);
  return ack(m-1, ack(m, n-1));
}

int main() {
  printf("%d\n", ack(4,1));
  return 0;
} 
```

**OCaml：3.6s**，`ocamlopt` *（使用 ocaml 3.12.1）*

```
let rec ack = function
  | 0,n -> n+1
  | m,0 -> ack (m-1, 1)
  | m,n -> ack (m-1, ack (m, n-1))
in print_int (ack (4, 1)) 
```

**标准 ML：5.1s** `mlton -codegen c -cc-opt -O3` *（带 mlton 20100608）*

```
fun ack 0 n = n+1
  | ack m 0 = ack (m-1) 1
  | ack m n = ack (m-1) (ack m (n-1));
print (Int.toString (ack 4 1)); 
```

**球拍：11.5s** `racket` *（使用球拍 v5.3.3）*

```
(require racket/unsafe/ops)

(define + unsafe-fx+)
(define - unsafe-fx-)
(define (ack m n)
  (cond
    [(zero? m) (+ n 1)]
    [(zero? n) (ack (- m 1) 1)]
    [else (ack (- m 1) (ack m (- n 1)))]))

(time (ack 4 1)) 
```

~~**Haskell：未完成**，22 秒后被系统杀死`ghc -O2` *（使用 ghc 7.4.2）*~~

**Haskell：** `ajhc` *1.8 秒（使用 ajhc 0.8.0.4）*

```
main = print $ ack 4 1
  where ack :: Int -> Int -> Int
        ack 0 n = n+1
        ack m 0 = ack (m-1) 1
        ack m n = ack (m-1) (ack m (n-1)) 
```

Haskell 版本是唯一无法正确终止的版本，因为它占用了太多内存。它会冻结我的机器并在被杀死之前填充交换空间。在不严重修改代码的情况下，我能做些什么来改进它？

**编辑**：我很欣赏一些渐近更智能的解决方案，但它们并不是我所要求的。这更多是关于查看编译器是否以相当有效的方式（堆栈、尾调用、拆箱等）处理某些模式，而不是计算 ackermann 函数。

**编辑 2**：正如一些回复所指出的，这似乎是[GHC 最新版本中的一个错误](http://hackage.haskell.org/trac/ghc/ticket/7850)。[我用AJHC](http://ajhc.metasepi.org/)尝试相同的代码并获得更好的性能。

非常感谢你 ：）

* * *

## 回答 #1

> 赞同：37
> 
> 时间：2013-04-20T03:00:28.107

**注意：**高内存使用问题[是 GHC RTS 中的一个错误](http://hackage.haskell.org/trac/ghc/ticket/7850)，在堆栈溢出和在堆上分配新堆栈时，没有检查垃圾收集是否到期。它已经在 GHC HEAD 中修复。

* * *

我能够通过 CPS-converting 获得更好的性能`ack`：

```
module Main where

data P = P !Int !Int

main :: IO ()
main = print $ ack (P 4 1) id
  where
    ack :: P -> (Int -> Int) -> Int
    ack (P 0 n) k = k (n + 1)
    ack (P m 0) k = ack (P (m-1) 1) k
    ack (P m n) k = ack (P m (n-1)) (\a -> ack (P (m-1) a) k) 
```

您的原始函数消耗了我机器上的所有可用内存，而这个函数在恒定空间中运行。

```
$ time ./Test
65533
./Test  52,47s user 0,50s system 96% cpu 54,797 total 
```

然而，Ocaml 仍然更快：

```
$ time ./test
65533./test  7,97s user 0,05s system 94% cpu 8,475 total 
```

**编辑：**使用[JHC](http://hackage.haskell.org/package/ajhc)编译时，您的原始程序与 Ocaml 版本一样快：

```
$ time ./hs.out 
65533
./hs.out  5,31s user 0,03s system 96% cpu 5,515 total 
```

**编辑 2：**我发现的其他东西：使用更大的堆栈块大小 ( `+RTS -kc1M`) 运行您的原始程序使其在恒定空间中运行。不过，CPS 版本仍然要快一些。

**编辑 3：**通过手动展开主循环，我设法生成了一个运行速度几乎与 Ocaml 一样快的版本。但是，它仅在运行时有效`+RTS -kc1M`（Dan Doel[已提交](http://hackage.haskell.org/trac/ghc/ticket/7850)有关此行为的错误）：

```
{-# LANGUAGE CPP #-}
module Main where

data P = P {-# UNPACK #-} !Int {-# UNPACK #-} !Int

ack0 :: Int -> Int
ack0 n =(n+1)

#define C(a) a
#define CONCAT(a,b) C(a)C(b)

#define AckType(M) CONCAT(ack,M) :: Int -> Int

AckType(1)
AckType(2)
AckType(3)
AckType(4)

#define AckDecl(M,M1) \
CONCAT(ack,M) n = case n of { 0 -> CONCAT(ack,M1) 1 \
; 1 ->  CONCAT(ack,M1) (CONCAT(ack,M1) 1) \
; _ ->  CONCAT(ack,M1) (CONCAT(ack,M) (n-1)) }

AckDecl(1,0)
AckDecl(2,1)
AckDecl(3,2)
AckDecl(4,3)

ack :: P -> (Int -> Int) -> Int
ack (P m n) k = case m of
  0 -> k (ack0 n)
  1 -> k (ack1 n)
  2 -> k (ack2 n)
  3 -> k (ack3 n)
  4 -> k (ack4 n)
  _ -> case n of
    0 -> ack (P (m-1) 1) k
    1 -> ack (P (m-1) 1) (\a -> ack (P (m-1) a) k)
    _ -> ack (P m (n-1)) (\a -> ack (P (m-1) a) k)

main :: IO ()
main = print $ ack (P 4 1) id 
```

测试：

```
$ time ./Test +RTS -kc1M
65533
./Test +RTS -kc1M  6,30s user 0,04s system 97% cpu 6,516 total 
```

**编辑 4**：显然，空间泄漏[已在 GHC HEAD 中修复](http://hackage.haskell.org/trac/ghc/ticket/7850#comment:4)，因此`+RTS -kc1M`将来不再需要。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2013-04-20T16:36:10.450

似乎涉及某种错误。您使用的是什么 GHC 版本？

使用 GHC 7，我得到与您相同的行为。该程序消耗所有可用内存而不产生任何输出。

但是，如果我只用 GHC 6.12.1 编译它`ghc --make -O2 Ack.hs`，它就可以完美运行。它在我的计算机上以**10.8s**计算结果，而纯 C 版本需要**7.8s**。

我建议您[在 GHC 网站上报告此错误](http://hackage.haskell.org/trac/ghc/wiki/ReportABug)。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2013-04-20T10:01:11.357

这个版本使用了 ackermann 函数的一些属性。它不等同于其他版本，但速度很快：

```
ackermann :: Int -> Int -> Int
ackermann 0 n = n + 1
ackermann m 0 = ackermann (m - 1) 1
ackermann 1 n = n + 2
ackermann 2 n = 2 * n + 3
ackermann 3 n = 2 ^ (n + 3) - 3
ackermann m n = ackermann (m - 1) (ackermann m (n - 1)) 
```

编辑：这是一个带有 memoization 的版本，我们看到在 haskell 中 memoize 函数很容易，唯一的变化是在调用站点中：

```
import Data.Function.Memoize

ackermann :: Integer -> Integer -> Integer
ackermann 0 n = n + 1
ackermann m 0 = ackermann (m - 1) 1
ackermann 1 n = n + 2
ackermann 2 n = 2 * n + 3
ackermann 3 n = 2 ^ (n + 3) - 3
ackermann m n = ackermann (m - 1) (ackermann m (n - 1))

main :: IO ()
main = print $ memoize2 ackermann 4 2 
```

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2013-04-20T03:10:43.823

下面是一个惯用的版本，它利用了 Haskell 的惰性和 GHC 对常量顶级表达式的优化。

```
acks :: [[Int]]
acks = [ [ case (m, n) of
                (0, _) -> n + 1
                (_, 0) -> acks !! (m - 1) !! 1
                (_, _) -> acks !! (m - 1) !! (acks !! m !! (n - 1))
         | n <- [0..] ]
       | m <- [0..] ]

main :: IO ()
main = print $ acks !! 4 !! 1 
```

在这里，我们懒惰地为Ackermann 函数的*所有值构建一个矩阵。*因此，后续调用`acks`不会重新计算任何东西（即`acks !! 4 !! 1`再次评估*不会*使运行时间加倍）。

虽然这不是最快的解决方案，但它看起来很像幼稚的实现，它在内存使用方面非常有效，并且将 Haskell 的一个怪异特性（懒惰）重新塑造为一种优势。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2013-04-20T21:04:01.967

我根本不认为这是一个错误，`ghc`只是没有利用它知道 4 和 1 是函数将被调用的唯一参数这一事实——也就是说，坦率地说，它不会作弊。它也不会为你做恒定的数学运算，所以如果你写了`main = print $ ack (2+2) 1`，它不会计算出 2+2 = 4 直到运行时。有`ghc`更重要的事情要考虑。如果你关心它，可以为后一种困难提供帮助[http://hackage.haskell.org/package/const-math-ghc-plugin](http://hackage.haskell.org/package/const-math-ghc-plugin)。

如果你`ghc`做一些数学运算会有所帮助，例如，这至少比你的 C 程序快一百倍，其中 4 和 1 作为参数。但是用 4 和 2 试试：

```
main = print $ ack 4 2 where

    ack :: Int -> Integer -> Integer
    ack 0 n = n + 1
    ack 1 n = n + 2 
    ack 2 n = 2 * n + 3
    ack m 0 = ack (m-1) 1
    ack m n = ack (m-1) (ack m (n-1) ) 
```

这将在不到十分之一秒的时间内给出所有约 20,000 位数字的*正确*答案，而 gcc 和您的算法将永远给出错误答案。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2013-04-23T18:09:41.127

用 Haskell 编写算法的方式看起来与用 C 编写的方式相似，这不是同一种算法，因为递归的语义完全不同。

这是一个使用相同*数学*算法的版本，但我们使用数据类型象征性地表示对 Ackermann 函数的调用。这样，我们可以更精确地控制递归的语义。

使用优化编译时，此版本在恒定内存中运行，但速度很慢 - 在类似于您的环境中大约需要 4.5 分钟。但我确信它可以修改得更快。这只是给出一个想法。

```
data Ack = Ack !Int

ack :: Int -> Int -> Int
ack m n = length . ackR $ Ack m : replicate n (Ack 0)
  where
    ackR n@(Ack 0 : _) = n
    ackR n             = ackR $ ack' n

    ack' [] = []
    ack' (Ack 0 : n) = Ack 0 : ack' n
    ack' [Ack m]     = [Ack (m-1), Ack 0]
    ack' (Ack m : n) = Ack (m-1) : ack' (Ack m : decr n)

    decr (Ack 0 : n) = n
    decr n           = decr $ ack' n 
```

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2013-04-27T03:05:32.410

这个性能问题（显然除了 GHC RTS 错误）似乎在 Apple`XCode`更新到`4.6.2`. 我仍然可以在 Linux 上重现它（虽然我一直在使用 GHC LLVM 后端进行测试），但在 OS X 上就不行了。在我将 XCode 更新到 4.6.2 后，新版本似乎影响了 GHC 后端代码生成Ackermann 实质上（根据我在更新前查看对象转储的记忆）。在 XCode 更新之前，我能够在 Mac 上重现性能问题 - 我没有数字，但它们肯定非常糟糕。因此，XCode 更新似乎改进了 Ackermann 的 GHC 代码生成。

现在，C 和 GHC 版本都非常接近。C代码：

```
int ack(int m,int n){

  if(m==0) return n+1;
  if(n==0) return ack(m-1,1);
  return ack(m-1, ack(m,n-1));

} 
```

执行 ack(4,1) 的时间：

```
GCC 4.8.0: 2.94s
Clang 4.1: 4s 
```

哈斯克尔代码：

```
ack :: Int -> Int -> Int
ack 0 n = n+1
ack m 0 = ack (m-1) 1
ack m n = ack (m-1) (ack m (n-1)) 
```

执行 ack 4 1 的时间（使用 +RTS -kc1M）：

```
GHC 7.6.1 Native: 3.191s
GHC 7.6.1 LLVM: 3.8s 
```

所有都是用标志编译的`-O2`（以及`-rtsopts`用于 RTS 错误解决方法的 GHC 标志）。不过，这真是令人头疼。更新 XCode 似乎对 GHC 中的 Ackermann 优化产生了很大的影响。

# android - 以较短的间隔请求LocationUpdates 更好，还是在较长的时间间隔较长时间请求LocationUpdates 更好？

> ID：16115817
> 
> 赞同：2
> 
> 时间：2013-04-20T02:14:03.630
> 
> 标签：android, performance, geolocation

我有一个 Android 应用程序，它基本上想要跟踪用户全天的动作，并每周向他们报告某些趋势。我最初认为，只要用户启用了定位服务和/或 GPS，那么系统就会一直试图让用户的位置保持最新。然而，在阅读了关于[Location Strategies](http://developer.android.com/guide/topics/location/strategies.html)的文章后，我意识到事实并非如此。

看来，即使用户已选中位置服务或 GPS 框，接收器也只是在应用程序调用 requestLocationUpdates 后才真正尝试确定设备的位置，并且会继续这样做，直到调用 removeUpdates。（如果这不正确，请告诉我）。

由于我的应用程序实际上只需要对设备运动的“粗略”概念，我正在考虑每五分钟左右只记录一次设备的位置。但是，文章中的两个示例都没有描述这种应用程序。这两个示例更多地是关于确定设备在特定时间点的位置，而不是试图“跟随”设备：使用创建位置标记用户创建的内容并定位附近的兴趣点。

我的问题是，让我的应用程序每五分钟“唤醒”一次，然后使用文章中的一种技术来确定设备的当前位置（通过开始聆听、采集多个样本、确定最佳样本）是否更有效？ ，停止收听，然后重新入睡），还是最好开始收听更新并在更新之间留出至少五分钟的时间，并且永远不要停止收听？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-08-02T09:16:58.610

即使您的应用不可见，也可以使用 BroastcastReceiver 定期获取新位置。不要使用服务，它可能会被杀死。

```
PendingIntent pendingIntent = PendingIntent.getBroadcast(this, 0, new Intent(MyLocationBroadcastReceiver.action), 0);
LocationManager locationManager = (LocationManager) getSystemService(Context.LOCATION_SERVICE);
locationManager.requestLocationUpdates(LocationManager.NETWORK_PROVIDER, 5 * 60 * 1000, 100, pendingIntent);
locationManager.requestLocationUpdates(LocationManager.GPS_PROVIDER, 5 * 60 * 1000, 100, pendingIntent);
locationManager.requestLocationUpdates(LocationManager.PASSIVE_PROVIDER, 0, 0, pendingIntent); 
```

不要忘记将操作字符串添加到 manifest.xml，并在那里添加 ACCESS_FINE_LOCATION 权限（用于 GPS）。如果您不需要 GPS，请使用 ACCESS_COARSE_LOCATION。

```
<receiver android:name="MyLocationBroadcastReceiver" android:process=":myLocationBroadcastReceiver" >
    <intent-filter>
        <action android:name="Hello.World.BroadcastReceiver.LOCATION_CHANGED" />
    </intent-filter>
</receiver>
<uses-permission android:name="android.permission.GET_ACCOUNTS" /> 
```

在 BroastcastReceiver.onReceive() 中，您必须整理出您得到的内容。我丢弃与前一个位置的距离小于新精度的新位置。如果“最近”位置的准确性比前一个位置差很多，我也会丢弃它们。精度高于 100m 的 GPS 定位通常毫无价值。您必须将位置存储在文件或首选项中，因为您的 BroastcastReceiver 对象在 onReceive() 调用之间将不存在。

```
public class MyLocationBroadcastReceiver extends BroadcastReceiver
{
    static public final String action = "Hello.World.BroadcastReceiver.LOCATION_CHANGED";

    public void onReceive(Context context, Intent intent)
    {
        Location location = (Location) intent.getExtras().get(LocationManager.KEY_LOCATION_CHANGED);
        if (location == null)
        {
            return;
        }

        // your strategies here
    }
} 
```

# c++ - 如何确定我的程序是否“在公司域上”

> ID：16115818
> 
> 赞同：0
> 
> 时间：2013-04-20T02:14:17.310
> 
> 标签：c++, windows, networking, active-directory

我正在尝试确定我的服务当前是否连接到公司域。

我试过了

```
BOOL bResult = LogonUser(m_userName, m_domainStr, m_password, LOGON32_LOGON_NETWORK, LOGON32_PROVIDER_DEFAULT, &userHandle); 
```

但如果凭据良好，它会返回 true。

我猜 Windows 正在检查缓存的凭据并确定它们是好的。

我想我可以使用 Ping，但防火墙也会阻止它。

是否有一种很好、干净的方法来确定计算机是否在“公司网络”上（例如可以连接到 AD）。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-22T18:46:26.800

检查 DC SYSVOL 共享的可用性。

我会查询 DNS 以获取 DC 列表，然后遍历 DC，直到我可以访问共享。如果可以，我在线。如果我不能，我会离线。

如果在公司局域网上，但 DC 不可用，您可能还处于离线状态...

# java - 在 Solrj 中执行 MLT（更像这样）查询

> ID：16115822
> 
> 赞同：4
> 
> 时间：2013-04-20T02:14:41.163
> 
> 标签：java, solr, solrj

我正在使用最近的 Solr 4.2.1 solrj 库。

我正在尝试从 java 程序执行 MLT 查询。只要我只在 stream.body 中提供小块，它就可以正常工作，但这违背了我的目的。

当我尝试使用 ContentStream 时，我没有得到响应，当我执行 solr.query 时，它会发出另一个请求。

看起来服务器正在让我的 solr.request() 正常。感谢任何指针。

哦，我正在和一个 solr 3.6.1

这是我到目前为止所拥有的：

```
import org.apache.solr.client.solrj.SolrServerException;

import org.apache.solr.client.solrj.response.QueryResponse;
import org.apache.solr.common.SolrDocumentList;
import org.apache.solr.common.params.ModifiableSolrParams;
import org.apache.solr.common.util.ContentStream;
import org.apache.solr.common.util.ContentStreamBase;
import org.apache.solr.common.util.NamedList;

import org.apache.solr.client.solrj.*;
import org.apache.solr.client.solrj.impl.HttpSolrServer;
import org.apache.solr.common.*;

import java.io.DataInputStream;
import java.io.File;
import java.io.FileInputStream;
import java.io.FileNotFoundException;
import java.io.IOException;
import java.net.MalformedURLException;

import org.apache.solr.client.solrj.request.AbstractUpdateRequest;
import org.apache.solr.client.solrj.request.ContentStreamUpdateRequest;
import org.apache.solr.client.solrj.util.ClientUtils;

public class SolrJSearcher {
  public static void main(String[] args) throws MalformedURLException, SolrServerException {
HttpSolrServer solr = new HttpSolrServer("http://localhost:8983/solr");

ModifiableSolrParams params = new ModifiableSolrParams();
String mltv[] = {"Big bunch of text for testing - redacted for brevity"};

String dvalues[] = {"mlt"};
String svalues[] = {"0"};

ContentStreamUpdateRequest up = new ContentStreamUpdateRequest("/mlt");
ContentStream cs = new ContentStreamBase.StringStream(mltv[0]);

up.addContentStream( cs);   

SolrQuery theQuery = new SolrQuery();;

theQuery.set("qt", dvalues);

up.setParam("start", "0");

try {
    solr.request(up);
} catch (IOException e) {
    // TODO Auto-generated catch block
    e.printStackTrace();
}

QueryResponse response = solr.query(theQuery);

SolrDocumentList results = response.getResults();
for (int i = 0; i < results.size(); ++i) {
  System.out.println(results.get(i));
}
}
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-20T07:13:47.593

据我所知，MoreLikeThis 旨在查找与索引中已有文档相似的文档。如果您正在搜索类似于输入字符串的文档，则只需在执行查询之前在索引中插入一个临时项目，然后将其删除。

我一直在成功使用以下内容：

```
/*
 * Build up a MoreLikeThis query to retrieve documents 
 * similar to the one with id originalId
 */
private SolrQuery buildUpMoreLikeThisQuery(String field3, String originalId) {
    SolrQuery query = new SolrQuery();
    query.setQueryType("/" + MoreLikeThisParams.MLT);
    query.set(MoreLikeThisParams.MATCH_INCLUDE, true);
    query.set(MoreLikeThisParams.MIN_DOC_FREQ, 1);
    query.set(MoreLikeThisParams.MIN_TERM_FREQ, 1);
    query.set(MoreLikeThisParams.MIN_WORD_LEN, 7);
    query.set(MoreLikeThisParams.BOOST, false);
    query.set(MoreLikeThisParams.MAX_QUERY_TERMS, 1000);
    query.set(MoreLikeThisParams.SIMILARITY_FIELDS,
            "field1,field2");
    query.setQuery("id:" + originalId);
    query.set("fl", "id,score");
    query.addFilterQuery("field3:" + field3);
    int maxResults = 20;
    query.setRows(maxResults);
    return query;
} 
```

# java - readFile 方法不在控制台显示结果

> ID：16115825
> 
> 赞同：0
> 
> 时间：2013-04-20T02:15:13.217
> 
> 标签：java, file-io

这是我的问题：

```
 a method readLine that reads a line from the file specified in fileName and returns the line a String. 
```

我要做的是使用 eclipse 读取一些信息并将其写入文本文件。这是我的代码：

```
 public class FileController {
private String fileName;

public FileController(){
    String fileName = "student.txt";
}

public FileController(String fileName){
    this.fileName = fileName;
}

public String readLine(){
    String line ="";
    try{
        FileReader fr = new FileReader(fileName);
        Scanner sc = new Scanner(fr);
        while(sc.hasNextLine()){
            Student stud = new Student(sc.nextLine());
            line = stud.toString();
        }
        fr.close();
    }catch(FileNotFoundException exception){
        System.out.println("File " + fileName + " was not found");
    }catch(IOException exception){
        System.out.println(exception);
    }
    return line;
}

public void writeLine(String input){
    try{
        FileWriter fw = new FileWriter(fileName,true);
        BufferedWriter bw = new BufferedWriter(fw);
        PrintWriter outFile = new PrintWriter(bw);

        outFile.println(input);
        outFile.close();
    }catch(IOException exception){
        System.out.println(exception);
    }
}

public static void main (String [] args){
    FileController fc = new FileController("student.txt");
    String input = "1234567H;Gabriel;23/12/1994;56;67;87";
    fc.readLine();
    fc.writeLine(input);
} 
```

通过将记录添加到文本文件中，这可以完美地工作。但是，那里的控制台没有显示结果。所以据我所知，错误在于 readLine()。当我使用 void 时，它工作得很好。但问题要求我返回一个字符串。有人知道如何解决这个问题吗？

*   当我在 while 循环中执行 println 时，其中存储了记录。我猜程序采用了 String file=""; 这一行并返回结果。那么如何在 while 循环中获取 line 的结果并替换为初始化呢？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-20T02:19:02.223

您正在覆盖 while 循环中的行：

```
try{
        FileReader fr = new FileReader(fileName);
        Scanner sc = new Scanner(fr);
        while(sc.hasNextLine()){
            Student stud = new Student(sc.nextLine());
            line = stud.toString();
        } 
```

所以这意味着只有最后一行会被传递给学生 [很可能是空白行]，它可能不会打印任何东西，甚至可能会出现异常。使用 StringBuffer 并附加字符串，然后返回。

编辑：

尝试这个。

```
public String readLine(){
    StringBuffer line =new StringBuffer();
    try{
        FileReader fr = new FileReader(fileName);
        Scanner sc = new Scanner(fr);
        while(sc.hasNextLine()){
            Student stud = new Student(sc.nextLine());
            line.append(stud.toString());
        }
        fr.close();
    }catch(FileNotFoundException exception){
        System.out.println("File " + fileName + " was not found");
    }catch(IOException exception){
        System.out.println(exception);
    }
    return line.toString();
} 
```

编辑：如果上面的代码也返回空白，那么最有可能的问题是 Strudent“toString()”方法。它可能返回空白。

编辑：

```
public String readLine(){
        StringBuffer line =new StringBuffer();
        try{
            FileReader fr = new FileReader(fileName);
            Scanner sc = new Scanner(fr);
            while(sc.hasNextLine()){
                Student stud = new Student(sc.nextLine());
                line.append(stud.toString());
                line.append("\n");
            }
            fr.close();
        }catch(FileNotFoundException exception){
            System.out.println("File " + fileName + " was not found");
        }catch(IOException exception){
            System.out.println(exception);
        }
        return line.toString();
    } 
```

# python - 如何从python中的类返回列表的长度

> ID：16115831
> 
> 赞同：2
> 
> 时间：2013-04-20T02:16:09.987
> 
> 标签：python

因此，当我尝试从班级获取列表的 len() 时出现此错误： TypeError: object of type 'Stuff' has no len() when I try:

```
>>> s = Stuff()
>>> len(s)
error instead of showing 0 like:
>>> l = []
>>> len(l)
0 
```

代码：

```
class Stuff():
    def __init__(self):
        self.lst = [] 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-20T02:18:33.077

像这样定义[`__len__`](http://docs.python.org/2/reference/datamodel.html#object.__len__)特殊方法：

```
class Stuff():
    def __init__(self):
         self.lst = []
    def __len__(self):
         return len(self.lst) 
```

现在你可以这样称呼它：

```
>>> s = Stuff()
>>> len(s)
0 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-20T02:18:37.887

使用`__len__`特殊方法

```
class Stuff(object):
    def __init__(self):
        self.bits = []
    def __len__(self):
        return len(self.bits) 
```

我强烈建议阅读有关特殊方法的文档页面。 [http://docs.python.org/2/reference/datamodel.html#special-method-names](http://docs.python.org/2/reference/datamodel.html#special-method-names)

您可以做很多巧妙的事情，例如定义方法如

`Stuff() += 3`或`Stuff()[4]`行为。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-20T02:19:41.267

参数`len`可以是“序列（字符串、元组或列表）或映射（字典）”：[http ://docs.python.org/2/library/functions.html#len](http://docs.python.org/2/library/functions.html#len)

它**不能**简单地是一个对象，**除非**该对象明确定义了一个`__len__`方法。这是函数隐式调用的`len`方法。

# java - 如何在一个文件中写入多个LinkLists并将LinkedLists读入LinkedList的ArrayList？

> ID：16115834
> 
> 赞同：1
> 
> 时间：2013-04-20T02:16:31.190
> 
> 标签：java, visualization, processing

我正在[处理](http://www.processing.org)一个基于 Java 的项目。我的项目是在给定主题（#标签）上可视化推文的转推。我正在使用 twitter4j 与 Twitter API 进行交互。我总是超过了 Twitter API 速率限制（每小时 15 个查询），这限制了我的可视化数据集。

现在我正在尝试编写一个脚本，该脚本以一定的周期间隔在夜间运行，以从 twitter 收集数据。这样我想我不会越过 Twitter API 的速率限制。

像[这样](http://forum.processing.org/topic/twitter-4j-and-general-geolocation-of-user-in-an-area)的东西。

我的项目在推特上根据查询参数搜索推文，并为它找到的每条推文收集其转发，然后提取推文和转发的用户位置，将其传递给 Google Maps Geocoding API 并获取纬度和经度推文的用户位置和该推文的所有转推的位置。基本上，链表的第一个节点存储推文的纬度和经度，后面的节点存储转发的相同。

```
Tweet -> Retweet 1 -> Retweet2
[22.4655, 34.5678]->[23.2344, 23.4545]->..... 
```

我有`n`一些`linked list`这种类型的存储在`ArrayList`. 简而言之，我有一个`ArrayList`of`LinkedList`和`LinkedList`' 节点是一个`PVector`包含纬度和经度的位置。

现在为了处理速率限制，我想编写一个脚本，它做同样的事情，但将数据写入我的可视化程序可以在 WorldMap 上读取和可视化的文件。为此，我想`LinkedList`为一条推文准备一个包含所有转发位置的推文，然后将该链接列表写入一个文件，然后与文件第二行中的第二条推文相同。

在我的可视化程序中，我想逐行读取链表中的数据并将它们共同存储在数组列表中。我想保持这种结构，因为我的可视化程序就是基于此的。

我认为这对于我正在尝试做的事情来说已经足够了，但是由于我对处理和 Java 的了解有限，我对如何去做感到困惑。

总而言之，我想在一个文件上编写多个链表，以便一行包含一个链表，然后在 n 个链表中逐行读取它们并将它们共同存储在一个数组列表中。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-20T05:59:56.950

您可以做一个简单的技巧来构建一组字符串以写入文件。这太直接了，但是您期望的解决方案。（因为您想逐行读取文件）
但是读取行并拆分它们将是一个太多混乱的代码。如果您尝试序列化（如@pm-77-1 所说），则不必为这些东西烦恼。您可以一次存储整个块，一次读取整个块。
1，编写一个代码来序列化你`ArrayList`使用你已经拥有的输入文件。然后编写一个代码来反序列化它并用它替换你的文件读取段。

# java - 为什么这个套接字为空？

> ID：16115836
> 
> 赞同：1
> 
> 时间：2013-04-20T02:16:39.960
> 
> 标签：java, sockets, null, connection, serversocket

我正在创建一个多客户端聊天服务器，我非常有信心它会工作（如果我错了，请纠正我），我的问题是客户端连接到的套接字上为空，因此无法创建连接因为我使用 if(Socket != null) 所以我不会出错，但我会很快解释我的布局。服务器从一个名为 (LaunchServer) 的启动类开始，它使用类对象 ClientConnector 作为 Minecraft，然后启动方法 runServer()。这是这个类的代码：

```
public class LaunchServer
{
    public static void main(String[] args)
    {
        System.out.println("[Info] Running");
        ClientConnector Minecraft = new ClientConnector();
        Minecraft.runServer();
    }
} 
```

这很简单。这将我们带到了 ClientConnector 类。在这里，我们从方法 runServer() 开始。我们马上就有了一个 try catch 块。在该块中，我们打印一条消息，表明服务器正在尝试连接到端口 1337。然后我们创建一个名为 serversocket 的新 ServerSocket。然后我们向控制台发送一条消息，说我们已经绑定到端口并且我们正在等待连接。如果是真的，我们创建一个新的 Socket 套接字，它等于 ServerSocket.accept(); OMG 去他的。这是代码。你知道它的作用...

```
import java.util.ArrayList;
import java.net.*;
import java.io.*;

public class ClientConnector
{

public static ArrayList<Socket> Connections = new ArrayList<Socket>();

public static void runServer()
{
    try
    {   
        System.out.println("[Info] Attempting to bind to port 1337.");
        @SuppressWarnings("resource")
        ServerSocket serversocket = new ServerSocket(1337);
        System.out.println("[Info] Bound to port 1337.");
        System.out.println("[Info] Waiting for client connections...");
        while(true)
        {
            Socket socket = serversocket.accept();
            new ClientHandler(socket).start();
            Connections.add(socket);
        }

    }
    catch (IOException e)
    {
        e.printStackTrace();
    }
}
} 
```

这将我们带到处理程序类：

```
import java.io.*;
import java.net.*;

public class ClientHandler extends Thread
{
Socket Socket;

public ClientHandler(Socket socket)
{
    socket = Socket;
    System.out.println("[Info] Client connected on port 1337.");
}

public void run()
{
    while(true)
    {
        for(int i = 0; i < ClientConnector.Connections.size(); i++)
        {

            try
            {
                if(Socket != null)//This stays null...
                {
                    ObjectOutputStream Output = new //These can't be created... 
                    ObjectOutputStream(Socket.getOutputStream());
                    ObjectInputStream Input = new ObjectInputStream(Socket.getInputStream());
                    whileChatting(Input, Output);
                }
            }
            catch (IOException e)
            {
                e.printStackTrace();
            }
        }
    }
}

public static void sendMessage(String message, String returnedMessage, ObjectOutputStream out)
{
    try
    {

        if(!message.isEmpty())
        {
            out.writeObject("\247c[Server]\247d " + message);
            out.flush();
            System.out.println("[Chat] Sent: " + message);
        }
        else
        {
            out.writeObject(returnedMessage);
            System.out.println("[Chat] Sent: " + returnedMessage);
        }
        out.flush();
        System.out.println("[Info] Fluching remaining data to stream.");
        System.out.println("\n[Server] " + message);
    }
    catch(IOException ioException)
    {
        System.out.println("[Warning] Error: ioException @ sendMessage line 76.");
    }
 }

public static void whileChatting(ObjectInputStream input, ObjectOutputStream output) throws IOException
{
    String message = "";
    do
     {
         try
         {
             message = (String) input.readObject();
             System.out.println("\n" + message);
             sendMessage("", message, output); 
         }
         catch(ClassNotFoundException classNotFoundException)
         {
             System.out.println("[Warning] Error: ClassNotFoundException @ whileChatting line 1-7.");
             System.out.println("\n idk wtf that user sent!");
         }
     }while(!message.equals("/stop"));
 }

} 
```

阅读运行方法。在那里你会看到空问题

连接会被接受然后传递给hander类吗？如何接受空连接？我的问题是我该如何解决这个问题？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-20T02:22:08.957

问题是由于不推荐的命名约定，您遇到了逻辑错误。您不应该使用关键字命名变量，例如您的`Socket`变量，并且每个变量都应该有一个可区分的名称。例如不是`socket1, socket2`，而是`serverSocket, clientSocket`因为这将使您和其他任何人更容易阅读和修复您的代码。

改变

```
Socket Socket; 
```

到

```
Socket connectedSocket; 
```

在你的构造函数中

```
socket = Socket; 
```

到

```
connectedSocket = socket; 
```

然后最后，在你的`run()`方法改变

```
if(Socket != null) 
```

到

```
if(connectedSocket != null) 
```

# ruby-on-rails - 为什么这不是有效的 YAML？

> ID：16115839
> 
> 赞同：1
> 
> 时间：2013-04-20T02:17:33.320
> 
> 标签：ruby-on-rails, ruby, yaml

我不明白为什么这段代码会绊倒 Rails YAML 解析器。

```
sections:
  [
    {title: "Journal Entry Testing",
     procedures:
       ["Select a sample of journal entries prepared during the year and determine if they were prepared correctly and approved.”]
    }    
  ] 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-20T02:30:48.243

由于不匹配的双引号，放大以突出差异：

# [“选择一个样品……并获得批准。”]

看看结尾引号是如何“聪明”的引号？

修复后，它会通过[http://yamllint.com/](http://yamllint.com/)并变成实际的 YAML。

# html - 背景图像缩放

> ID：16115846
> 
> 赞同：0
> 
> 时间：2013-04-20T02:18:35.173
> 
> 标签：html, css, background-image

我遇到了一个问题，我要做的几乎就是让我的背景图像保持锚定并保持相同的大小和位置，无论用户分辨率有多大。

我现在拥有的：

```
#navigator {
    background-image: url('banner.png');
    background-repeat:no-repeat;
    background-position:top-center; 
```

}

提前致谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-20T02:39:47.073

您将想要了解元视口选项。我一直使用的一个是`target-densitydpi`，这是特定于 Android 的。 `<meta name="viewport" content="target-densitydpi=device-dpi" />`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-20T02:41:13.247

试试这个，它对我有用，

```
html, body, <or your div>
 {
    background-image:url("fdkljg.kdf");
    background-size:100%;
    background-repeat:no-repeat;
    top:0px;
    left:0px;
    right:0px;
} 
```

如果这不起作用，请尝试将“背景位置”属性设置为居中或左侧。完成代码后，尝试放大和缩小网页以模拟屏幕分辨率。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-20T02:20:31.103

你的意思是`background-size`？

```
#navigator {
    background-image: url('banner.png');
    background-repeat:no-repeat;
    background-position:top-center;
    background-size: 200pt 300pt;
} 
```

（来自[http://www.w3schools.com/cssref/css3_pr_background-size.asp](http://www.w3schools.com/cssref/css3_pr_background-size.asp)）

它适用于大多数与 CSS3 兼容的现代浏览器。

# java - 使用 Java 从单个文件中读取图像元数据

> ID：16115851
> 
> 赞同：1
> 
> 时间：2013-04-20T02:19:06.800
> 
> 标签：java, image, metadata

我想从单个文件中读取图像元数据。我尝试了以下代码：

[http://johnbokma.com/java/obtaining-image-metadata.html](http://johnbokma.com/java/obtaining-image-metadata.html)

当我运行它时，我得到`build successful`但没有任何反应。

```
public class Metadata {

    public static void main(String[] args) {
        Metadata meta = new Metadata();
        int length = args.length;
        for ( int i = 0; i < length; i++ )
        meta.readAndDisplayMetadata( args[i] );
    }

    void readAndDisplayMetadata( String fileName ) {
        try {

            File file = new File( fileName );
            ImageInputStream iis = ImageIO.createImageInputStream(file);
            Iterator<ImageReader> readers = ImageIO.getImageReaders(iis);

            if (readers.hasNext()) {

                // pick the first available ImageReader
                ImageReader reader = readers.next();

                // attach source to the reader
                reader.setInput(iis, true);

                // read metadata of first image
                IIOMetadata metadata = reader.getImageMetadata(0);

                String[] names = metadata.getMetadataFormatNames();
                int length = names.length;
                for (int i = 0; i < length; i++) {
                    System.out.println( "Format name: " + names[ i ] );
                    displayMetadata(metadata.getAsTree(names[i]));
                }
            }
        }
        catch (Exception e) {
            e.printStackTrace();
        }
    }

} 
```

请帮忙 ：）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-20T02:29:22.097

您没有正确指定文件的路径。下面的变化应该表明这一点！

```
public static void main(String[] args) {
    Metadata meta = new Metadata();
    int length = args.length;
    for ( int i = 0; i < length; i++ ) {
        if (new File(args[i]).exists()) {
            meta.readAndDisplayMetadata( args[i] );
        } else {
            System.out.println("cannot find file: " + args[i]);
        }
    }
} 
```

**编辑 - 更简单的代码示例**

我们现在静态定义要使用的文件。

```
public static void main(String[] args) {
    Metadata meta = new Metadata();
    String filename = "C:\\Users\\luckheart\\Pictures\\Sample Pictures\\Koala.jpg";
    if (new File(filename).exists()) {
        meta.readAndDisplayMetadata(filename);
    } else {
        System.out.println("cannot find file: " + filename);
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2021-10-25T03:35:57.823

现在使用[apache commons-imaging 库大大简化和简化了读取图像元数据](https://github.com/apache/commons-imaging)

```
/**
 * Reference : https://github.com/apache/commons-imaging/blob/master/src/test/java/org/apache/commons/imaging/examples/MetadataExample.java
 */
public static void readImageMeta(final File imgFile) throws ImageReadException, IOException {
    /** get all metadata stored in EXIF format (ie. from JPEG or TIFF). **/
    final ImageMetadata metadata = Imaging.getMetadata(imgFile);
    System.out.println(metadata);
    System.out.println("--------------------------------------------------------------------------------");

    /** Get specific meta data information by drilling down the meta **/
    if (metadata instanceof JpegImageMetadata) {
        JpegImageMetadata jpegMetadata = (JpegImageMetadata) metadata;
        printTagValue(jpegMetadata, GpsTagConstants.GPS_TAG_GPS_LATITUDE_REF);
        printTagValue(jpegMetadata, GpsTagConstants.GPS_TAG_GPS_LATITUDE);
        printTagValue(jpegMetadata, GpsTagConstants.GPS_TAG_GPS_LONGITUDE_REF);
        printTagValue(jpegMetadata, GpsTagConstants.GPS_TAG_GPS_LONGITUDE);

        // simple interface to GPS data
        final TiffImageMetadata exifMetadata = jpegMetadata.getExif();
        if (null != exifMetadata) {
            final TiffImageMetadata.GPSInfo gpsInfo = exifMetadata.getGPS();
            if (null != gpsInfo) {
                final String gpsDescription = gpsInfo.toString();
                final double longitude = gpsInfo.getLongitudeAsDegreesEast();
                final double latitude = gpsInfo.getLatitudeAsDegreesNorth();

                System.out.println("    " + "GPS Description: " + gpsDescription);
                System.out.println("    " + "GPS Longitude (Degrees East): " + longitude);
                System.out.println("    " + "GPS Latitude (Degrees North): " + latitude);
            }
        }

        // more specific example of how to manually access GPS values
        final TiffField gpsLatitudeRefField = jpegMetadata.findEXIFValueWithExactMatch(GpsTagConstants.GPS_TAG_GPS_LATITUDE_REF);
        final TiffField gpsLatitudeField = jpegMetadata.findEXIFValueWithExactMatch(GpsTagConstants.GPS_TAG_GPS_LATITUDE);
        final TiffField gpsLongitudeRefField = jpegMetadata.findEXIFValueWithExactMatch(GpsTagConstants.GPS_TAG_GPS_LONGITUDE_REF);
        final TiffField gpsLongitudeField = jpegMetadata.findEXIFValueWithExactMatch(GpsTagConstants.GPS_TAG_GPS_LONGITUDE);
        if (gpsLatitudeRefField != null && gpsLatitudeField != null && gpsLongitudeRefField != null && gpsLongitudeField != null) {
            // all of these values are strings.
            final String gpsLatitudeRef = (String) gpsLatitudeRefField.getValue();
            final RationalNumber[] gpsLatitude = (RationalNumber[]) (gpsLatitudeField.getValue());
            final String gpsLongitudeRef = (String) gpsLongitudeRefField.getValue();
            final RationalNumber[] gpsLongitude = (RationalNumber[]) gpsLongitudeField.getValue();

            final RationalNumber gpsLatitudeDegrees = gpsLatitude[0];
            final RationalNumber gpsLatitudeMinutes = gpsLatitude[1];
            final RationalNumber gpsLatitudeSeconds = gpsLatitude[2];

            final RationalNumber gpsLongitudeDegrees = gpsLongitude[0];
            final RationalNumber gpsLongitudeMinutes = gpsLongitude[1];
            final RationalNumber gpsLongitudeSeconds = gpsLongitude[2];

            // This will format the gps info like so:
            //
            // gpsLatitude: 8 degrees, 40 minutes, 42.2 seconds S
            // gpsLongitude: 115 degrees, 26 minutes, 21.8 seconds E

            System.out.println("    " + "GPS Latitude: " + gpsLatitudeDegrees.toDisplayString() + " degrees, " + gpsLatitudeMinutes.toDisplayString() + " minutes, " + gpsLatitudeSeconds.toDisplayString() + " seconds " + gpsLatitudeRef);
            System.out.println("    " + "GPS Longitude: " + gpsLongitudeDegrees.toDisplayString() + " degrees, " + gpsLongitudeMinutes.toDisplayString() + " minutes, " + gpsLongitudeSeconds.toDisplayString() + " seconds " + gpsLongitudeRef);
        }
    }
}

private static void printTagValue(final JpegImageMetadata jpegMetadata, TagInfo tagInfo) {
    final TiffField field = jpegMetadata.findEXIFValueWithExactMatch(tagInfo);
    if (field == null) {
        System.out.println(tagInfo.name + ": " + "Not Found.");
    } else {
        System.out.println(tagInfo.name + ": " + field.getValueDescription());
    }
}

public static void main(String[] args) throws IOException, ImageReadException {
    File sourceFile = new File("/Users/vivek/myimage.jpg");
    readImageMeta(sourceFile);
} 
```

上面的代码将给出这个输出

```
Exif metadata:
    Root: 
        ImageWidth: 3024
        ImageLength: 4032
        BitsPerSample: 8, 8, 8
        PhotometricInterpretation: 2
        Make: 'Apple'
        Model: 'iPhone 6s'
        Orientation: 1
        SamplesPerPixel: 3
        XResolution: 72
        YResolution: 72
        ResolutionUnit: 2
        Software: 'Adobe Photoshop CC 2015 (Macintosh)'
        DateTime: '2016:05:17 16:55:55'
        YCbCrPositioning: 1
        ExifOffset: 300
        GPSInfo: 868

    Exif: 
        ExposureTime: 1/100 (0.01)
        FNumber: 11/5 (2.2)
        ExposureProgram: 2
        PhotographicSensitivity: 40
        ExifVersion: 48, 50, 50, 49
        DateTimeOriginal: '2016:05:08 18:03:57'
        DateTimeDigitized: '2016:05:08 18:03:57'
        ComponentsConfiguration: 1, 2, 3, 0
        ShutterSpeedValue: 35113/5284 (6.645)
        ApertureValue: 7983/3509 (2.275)
        BrightnessValue: 13026/2395 (5.439)
        ExposureCompensation: 0
        MeteringMode: 5
        Flash: 16
        FocalLength: 83/20 (4.15)
        SubjectArea: 618, 1555, 310, 311
        SubSecTimeOriginal: '523'
        SubSecTimeDigitized: '523'
        FlashpixVersion: 48, 49, 48, 48
        ColorSpace: 1
        ExifImageWidth: 3024
        ExifImageLength: 4032
        SensingMethod: 2
        SceneType: 1
        CustomRendered: 4
        ExposureMode: 0
        WhiteBalance: 0
        FocalLengthIn35mmFormat: 29
        SceneCaptureType: 0
        LensSpecification: 83/20 (4.15), 83/20 (4.15), 11/5 (2.2), 11/5 (2.2)
        LensMake: 'Apple'
        LensModel: 'iPhone 6s back camera 4.15mm f/2.2'

    Gps: 
        GPSLatitudeRef: 'N'
        GPSLatitude: 13, 21, 3305/100 (33.05)
        GPSLongitudeRef: 'E'
        GPSLongitude: 75, 33, 2034/100 (20.34)
        GPSAltitudeRef: 0
        GPSAltitude: 83651/95 (880.537)
        GPSTimeStamp: 12, 33, 57
        GPSSpeedRef: 'K'
        GPSSpeed: 21/100 (0.21)
        GPSImgDirectionRef: 'T'
        GPSImgDirection: 1654/31 (53.355)
        GPSDestBearingRef: 'T'
        GPSDestBearing: 1654/31 (53.355)
        GPSDateStamp: '2016:05:08'
        Unknown Tag (0x1f): 5

    Sub:  (jpegImageData)
        Compression: 6
        XResolution: 72
        YResolution: 72
        ResolutionUnit: 2
        JpgFromRawStart: 1274
        JpgFromRawLength: 8211

Photoshop (IPTC) metadata:
        Date Created: 20160508
        Time Created: 180357+0000
--------------------------------------------------------------------------------
GPSLatitudeRef: 'N'
GPSLatitude: 13, 21, 3305/100 (33.05)
GPSLongitudeRef: 'E'
GPSLongitude: 75, 33, 2034/100 (20.34)
    GPS Description: [GPS. Latitude: 13 degrees, 21 minutes, 33.05 seconds N, Longitude: 75 degrees, 33 minutes, 20.34 seconds E]
    GPS Longitude (Degrees East): 75.55565
    GPS Latitude (Degrees North): 13.359180555555556
    GPS Latitude: 13 degrees, 21 minutes, 33.05 seconds N
    GPS Longitude: 75 degrees, 33 minutes, 20.34 seconds E 
```

[Fore More 请参阅此处](https://commons.apache.org/proper/commons-imaging/index.html)的库文档
Maven Repo Link[此处](https://mvnrepository.com/artifact/org.apache.commons/commons-imaging)。
注意：此时它是 alpha 版本，但您可以信任 apache：D。

干杯!

# c++ - c++ cli比较文件中的十六进制字节不起作用

> ID：16115852
> 
> 赞同：0
> 
> 时间：2013-04-20T02:19:18.190
> 
> 标签：c++, windows, file, c++-cli, byte

我有一个名为 ab.exe 的文件，它包含十六进制

0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000BBAAE8CAFDFFFF83C408000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000054AAE8CAFDFFFF83C40800000000000000000000000000000000000000000000000000000000000000000000000000AAE8CAFDFFFF83C4088D000000000000000000000000000000000000000000000000000000000000000000000000000000000000000

我在 C++ 中有这段代码，它假设检测一个十六进制字符串是否在文件中，以及是否将其添加到列表框中。

```
array<Byte>^ target1 = { 0xAA,0xE8,0xCA,0xFD,0xFF,0xFF,0x83,0xC4,0x08,0x8D };
array<Byte>^ target2 = { 0x54,0xAA,0xE8,0xCA,0xFD,0xFF,0xFF,0x83,0xC4,0x08 };
array<Byte>^ target3 = { 0xBB,0xAA,0xE8,0xCA,0xFD,0xFF,0xFF,0x83,0xC4,0x08 };

int matched1 = 0;
int matched2 = 0;
int matched3 = 0;
FileStream^ fs2 = gcnew FileStream(line, FileMode::Open, FileAccess::Read, FileShare::ReadWrite);

int value;
do
{
    value = fs2->ReadByte();
    if (value == target1[matched1]) {
        matched1++;
    }
    else
        matched1 = 0;

    if (value == target2[matched2]) {
        matched2++;
    }
    else
        matched2 = 0;

    if (value == target3[matched3]) {
        matched3++;
    }
    else
        matched3 = 0;

    if(matched1 == target1->Length)
    {
        listBox1->Items->Add(line + "1");

    }

    if(matched2 == target2->Length)
    {
        listBox1->Items->Add(line + "2");

    }

    if(matched3 == target3->Length)
    {
        listBox1->Items->Add(line + "3");

    }
} while (value != -1);

fs2->Close(); 
```

问题是它只将 line + 3 添加到列表框中，而不是 line + 1 或 line + 2 添加到列表框

我不知道为什么这是因为所有 3 个字符串都在文件中，所以它们都应该添加到列表框中。出于某种原因，只添加了最后一个，因为我尝试只添加了 2 个，而添加了第二个。有人可以告诉我为什么它们没有全部添加到列表框中。谢谢

**更新1**

在玩了一些之后，它不是每次添加的最后一个目标，而是出现在文件中的第一个字符串被添加。我使用消息框逐步完成程序，发生的事情是 54AAE8CAFDFFFF83C408 是文件中出现的第一个字符串，然后将添加行 + 2，但由于某种原因，所有 3 的匹配整数停止计数，它们只是 = 0文件的其余部分。有人可以向我解释为什么会这样以及如何解决它。

**更新2**

这是问题的答案。我需要做的只是添加一个matched = 0; 在每个添加到列表框命令之后。

```
listBox1->Items->Add(line + "1");
matched1 = 0;

listBox1->Items->Add(line + "2");
matched2 = 0;

listBox1->Items->Add(line + "3");
matched3 = 0; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-20T11:21:23.770

在我看来，在第一次匹配一个模式（此处为 target3）之后，您读取的内容超出了 target3 的最后一个字节（因为`matched3++`），这可能会导致不良行为。

更新1：

```
if(matched1 == target1->Length)
{
  matched1 = 0; // pattern matched so reset counter
  ...
} 
```

# python - 基本 Python 列表练习

> ID：16115854
> 
> 赞同：1
> 
> 时间：2013-04-20T02:19:35.957
> 
> 标签：python

如何使此图垂直而不是水平打印？请尝试使用我在代码中使用的相同概念（循环、列表），以便我了解更改。谢谢您的帮助！

**这是代码：**

```
SIGN='x'

test_list=[500000,5000000,7000000]
test_calc_list=[]
test_sum=sum(test_list)

test_string_list=['Test1','Test2','Test3']
signs_list=[]

for x in test_list:
    test_calc=round((x/float(test_sum)*10))
    test_calc_list.append(test_calc)

for y in test_calc_list:
    y=int(y)
    signs=y*SIGN
    signs_list.append(signs)

for z in range(len(test_string_list)):
    print "%8s: %-6s %7i"% (test_string_list[z],signs_list[z],test_list[z]) 
```

**这是我得到的输出：**

```
Test1:           500000
Test2: xxxx     5000000
Test3: xxxxxx   7000000 
```

**这是我想要的输出：**

```
 x
           x          x
           x          x
           x          x
           x          x
Test1      Test2      Test3        
500000     5000000    7000000 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-20T07:23:37.607

假设这不是家庭作业（你知道有软件可以检测抄袭吗？）这里有可能的解决方案。

最简单的方法是假设列表是固定大小的：

```
for i in range(len(max(signs_list)), 0, -1):
    print ('{0:<8} {1:<8} {2}').format(
        'x' if len(signs_list[0]) >= i else '', 
        'x' if len(signs_list[1]) >= i else '', 
        'x' if len(signs_list[2]) >= i else '')
print ('{0:<8} {1:<8} {2}').format(test_string_list[0], test_string_list[1], test_string_list[2])
print ('{0:<8} {1:<8} {2}').format(test_list[0], test_list[1], test_list[2]) 
```

Trickier 正在处理任意大小的列表，这需要`eval`

```
for i in range(len(max(signs_list)), 0, -1):
    template_string = ""
    input_string = ""
    for z in range(len(test_string_list)):
        string_part = "{" + str(z) + ":<8} "
        template_string += string_part
        input_part = "'x' if len(signs_list[" \
            + str(z) + "]) >= i else '',"
        input_string += input_part
    statement = "('" + template_string + "')"
    statement += ".format"
    statement += "(" + input_string[:-1] + ")"
    print eval(statement)

template_string = ""
input_string = ""
for z in range(len(test_string_list)):
    string_part = "{" + str(z) + ":<8} "
    template_string += string_part
    input_part = "test_list[" + str(z) + "],"
    input_string += input_part
statement = "('" + template_string + "')"
statement += ".format"
statement += "(" + input_string[:-1] + ")"
print eval(statement)

template_string = ""
input_string = ""
for z in range(len(test_string_list)):
    string_part = "{" + str(z) + ":<8} "
    template_string += string_part
    input_part = "test_string_list[" + str(z) + "],"
    input_string += input_part
statement = "('" + template_string + "')"
statement += ".format"
statement += "(" + input_string[:-1] + ")"
print eval(statement) 
```

可以重构上述怪物以删除语句构造：

```
def statement_constructor(list_type, list_size):
    template_string = ""
    input_string = ""
    for z in range(list_size):
        string_part = "{" + str(z) + ":<8} "
        template_string += string_part
        if list_type == "signs_list":
            input_part = "'x' if len(signs_list[" \
                + str(z) + "]) >= i else '',"
        else:
            input_part = list_type + "[" + str(z) + "],"
        input_string += input_part
    statement = "('" + template_string + "')"
    statement += ".format"
    statement += "(" + input_string[:-1] + ")" 
    return statement

length = len(test_string_list)
for i in range(len(max(signs_list)), 0, -1):
    print eval(statement_constructor('signs_list', length))
print eval(statement_constructor('test_list', length))
print eval(statement_constructor('test_string_list', length)) 
```

所有三个产生相同的输出：

```
 x        
                  x        
         x        x        
         x        x        
         x        x        
         x        x        
500000   5000000  7000000  
Test1    Test2    Test3 
```

虽然使用的解决方案`eval`可以处理 Test4、Test5 等。可能有一个更优雅的解决方案，但这有效。

`eval`编辑：或者在Michael0x2a 的评论中建议的更优雅的解决方案，没有过度杀伤力。

```
def statement_constructor(list_type, list_size):
    template_string = ""
    input_string = ""
    array = []
    for z in range(list_size):
        string_part = "{:<8}"
        template_string += string_part
        if list_type == "signs_list":
            array.append('x' if len(signs_list[z]) >= i else '')
        elif list_type == 'test_list':
            array.append(test_list[z])
        else:
            array.append(test_string_list[z])
    print (template_string).format(*array)

length = len(test_string_list)
for i in range(len(max(signs_list)), 0, -1):
    statement_constructor('signs_list', length)
statement_constructor('test_list', length)
statement_constructor('test_string_list', length) 
```

# android - 印度字体（卡纳达语）在 Android ICS 中未正确呈现

> ID：16115857
> 
> 赞同：0
> 
> 时间：2013-04-20T02:19:48.180
> 
> 标签：android

我正在尝试获得对 Android ICS 的 kannada 字体支持。我将运行 Android ICS 4.0.4 的 Xperia Neo L 手机植根并安装了 Kannada 字体 (Lohit-Kannada.ttf)。我还在框架的 fallback_fonts.xml 中包含 Lohit-Kannada 字体作为家庭设置。之后，我可以在浏览器中看到卡纳达语字体呈现，但不支持复杂的脚本。字形没有以正确的方式呈现，尽管它只是可读的。泰米尔语、印地语、孟加拉语等其他印度语言可以完美呈现，但我的语言无法正确呈现。有人建议我浏览这个博客。[http://androidandsandu.blogspot.in/2011/12/how-to-add-indian-languages-to-android.html](http://androidandsandu.blogspot.in/2011/12/how-to-add-indian-languages-to-android.html) 但我无法找出在哪里进行这些文件更改。我的意思是 lohit-fonts 目录在哪里， android.mk 文件在哪里？我无法在手机中找到这些文件夹或文件。请问有什么帮助吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-20T11:05:36.007

您提供的链接说明了如何更改自定义 Android 图像的源代码以执行您想要的操作：

> 先决条件：ICS (4.0.3) AOSP 源代码...

所以我想如果不构建自己的自定义 ROM 是不可能的。

# verilog - Verilog - 单独的输出数组

> ID：16115863
> 
> 赞同：1
> 
> 时间：2013-04-20T02:20:36.207
> 
> 标签：verilog, declaration

这是我第一次访问 stackoverflow.com，也是 Verilog 编码的新手。我可能会错误地使用某些术语，所以如果我这样做了，请纠正我，以便我在以后的帖子中更清楚。

我正在使用一个 Altera FPGA 板，其中有 7 个 LEDG 灯可以触发和关闭。对于我的项目，我正在制作一个 BCD 加法器，当 BCD 值不是 0 - 9 时，LEDG [7] 打开。但是，我不想声明输出 [6:4]。LEDG[3:0] 显示两个输入之和的二进制等效值。

我以为我可以使用两个单独的声明语句，但它告诉我 LEDG 已经被声明了。然后我尝试使用方括号将它组合起来，但它也抱怨这一点。有什么方法可以简化我的代码。以下是我尝试过的示例。

示例 1：

> ```
> module BCD (..., LEDG, ...);
> output reg [3:0] LEDG;
> output reg [7] LEDG;
> endmodule 
> ```

示例 2：

```
module BCD (..., LEDG, ...);
output reg ({[3:0], [7]} LEDG);
endmodule 
```

任何帮助将不胜感激！提前致谢。:-)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-20T03:01:49.413

您尝试做的事情是不可能的，如果您要输出总线，那么您必须指定一个连续的范围。

如果您需要输出 [7] 和 [3:0]，您应该只声​​明一个输出 reg [7:0]。

您可以不驱动未使用的位，或者如果这会给出综合警告/错误，那么如果您不关心它们的值（`LEDG[6:4] = 3'b0`），则将它们绑定到 0 或 1。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-23T01:31:06.670

```
module(...NBCD_FLAG, LEDG...);
output reg [3:0] LEDG;
output wire NBCD_FLAG; 
```

在您的 .qsf 文件中，将 LEDG 分配给您板上的 LED 3-0，将 NBED_FLAG 分配给 LED 7。这样您就可以将 LED 6-4 用于其他目的。

# android - 无法在我的 Android 应用程序中创建 SQLite 数据库

> ID：16115865
> 
> 赞同：4
> 
> 时间：2013-04-20T02:21:01.947
> 
> 标签：android, sqlite, android-sqlite, oncreate

我正在使用我的应用程序对象（Android 构建块）在我的 oncreate 方法中调用数据库构造函数。但我不知道为什么不能创建它。这就是我的代码的样子：

我的数据库类，将 DbHelper 作为内部类：

```
package com.example.pharmacie;

import android.content.ContentValues;
import android.content.Context;
import android.database.sqlite.SQLiteDatabase;
import android.database.sqlite.SQLiteOpenHelper;
import android.util.Log;

public class PhData {
    private static final String TAG = PhData.class.getSimpleName();

    private static final int VERSION = 1;
    private static final String DATABASE = "ph_info.db";
    private static final String TABLE = "ph_info";

    public static final String C_ID = "_id";
    public static final String C_CREATED_AT = "created_at";
    public static final String C_NAME = "Pharmacie ";
    public static final String C_TELE = " ";
    public static final String C_ADRESS = "Tet";
    public static final String C_HAS_SHIFT = "yes"; // yes if night shift
    public static final String C_SCHEDULE = "YYYY-MM-DD";

    private static final String GET_ALL_ORDER_BY = C_CREATED_AT + " DESC";
    private static final String[] MAX_CREATED_AT_COLUMNS = { "max("
            + PhData.C_CREATED_AT + ")" };    
    Context context;
    private DbHelper dbHelper;

    // Inner class: DbHelper implementations 
    class DbHelper extends SQLiteOpenHelper {

        public DbHelper() {
            super(context, DATABASE, null, VERSION);
            Log.d(TAG, "Constructor called");
        }

        @Override
        public void onCreate(SQLiteDatabase db) {
            Log.d(TAG, "Creating database: " + DATABASE);

            db.execSQL("create table " + TABLE + " (" + C_ID
                    + " int primary key, " + C_CREATED_AT + " int, " + C_NAME
                    + " text, " + C_ADRESS + " text, "
                    + C_HAS_SHIFT + " text, " + C_SCHEDULE
                    + " text, " + C_TELE + " text)");

            Log.d(TAG, "database created");
        }

        @Override
        public void onUpgrade(SQLiteDatabase db, int oldVersion, int newVersion) {
            db.execSQL("drop table " + TABLE);
            this.onCreate(db);
        }
    } // end of dbhelper class

    public PhData(Context context) {
        this.context = context;
        this.dbHelper = new DbHelper();
        Log.d(TAG, "Initialized data");
    }

    public void close() {
        this.dbHelper.close();
    }

    public void insertOrIgnore(ContentValues values) {
        Log.d(TAG, "insertOrIgnore on " + values);
        SQLiteDatabase db = this.dbHelper.getWritableDatabase();
        try {
            db.insertWithOnConflict(TABLE, null, values,
                    SQLiteDatabase.CONFLICT_IGNORE);
        } finally {
            db.close();
        }
    }

    /**
     * Deletes ALL the data
     */
    public void delete() {
        // Open Database
        SQLiteDatabase db = dbHelper.getWritableDatabase();

        // Delete the data
        db.delete(TABLE, null, null);

        // Close Database
        db.close();
    }
} 
```

**这是我的应用程序类，我在其中调用构造函数来创建我的数据库：**

```
package com.example.pharmacie;

import android.app.Application; import android.util.Log;

public class PharmacieApplication extends Application {
          private static final String TAG = PharmacieApplication.class.getSimpleName();       PhData phData;

    @Override   public void onCreate() {        super.onCreate();
        phData = new PhData(this);
        Log.d(TAG, "onCreated");    }

    @Override   public void onTerminate() {         super.onTerminate();
        Log.d(TAG, "onTerminated");     }

} 
```

这就是我在我的 logcat 中得到的：

```
04-20 03:15:05.968: D/PhData(368): Constructor called
04-20 03:15:05.968: D/PhData(368): Initialized data
04-20 03:15:05.968: D/PharmacieApplication(368): onCreated
04-20 03:15:06.568: D/JoursListActivity(368): onCreated 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-20T02:34:30.160

在您要求访问数据库之前，不会实际创建数据库。从[文档](http://developer.android.com/reference/android/database/sqlite/SQLiteOpenHelper.html)中：

> 创建一个帮助对象来创建、打开和/或管理数据库。此方法总是很快返回。在调用 getWritableDatabase() 或 getReadableDatabase() 之一之前，不会实际创建或打开数据库。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-20T04:35:10.533

我正在更改您的代码，输入此代码并尝试。

```
public class PhData {
    private static final String TAG = PhData.class.getSimpleName();

    private static final int VERSION = 1;
    private static final String DATABASE = "ph_info.db";
    private static final String TABLE = "ph_info";

    public static final String C_ID = "_id";
    public static final String C_CREATED_AT = "created_at";
    public static final String C_NAME = "Pharmacie ";
    public static final String C_TELE = " ";
    public static final String C_ADRESS = "Tet";
    public static final String C_HAS_SHIFT = "yes"; // yes if night shift
    public static final String C_SCHEDULE = "YYYY-MM-DD";

    private static final String GET_ALL_ORDER_BY = C_CREATED_AT + " DESC";
    private static final String[] MAX_CREATED_AT_COLUMNS = { "max("
            + PhData.C_CREATED_AT + ")" };    
    Context context;
    private DbHelper dbHelper;
    private SQLiteDatabase db;

    // Inner class: DbHelper implementations 
    class DbHelper extends SQLiteOpenHelper {

        public DbHelper() {
            super(context, DATABASE, null, VERSION);
            Log.d(TAG, "Constructor called");
        }

        @Override
        public void onCreate(SQLiteDatabase db) {
            Log.d(TAG, "Creating database: " + DATABASE);

            db.execSQL("create table " + TABLE + " (" + C_ID+" INTEGER PRIMARY KEY AUTOINCREMENT, " +
                    C_CREATED_AT + " TEXT, " + 
                    C_NAME + " text, " +
                    C_ADRESS + " text, " + 
                    C_HAS_SHIFT + " text, " +
                    C_SCHEDULE + " text, " + 
                    C_TELE + " text)");

            Log.d(TAG, "database created");
        }

        @Override
        public void onUpgrade(SQLiteDatabase db, int oldVersion, int newVersion) {
            db.execSQL("drop table " + TABLE);
            onCreate(db);
        }
    } // end of dbhelper class

    public PhData(Context context) {
        this.context = context;
        this.dbHelper = new DbHelper(context);
        db=this.dbHelper.getWritableDatabase();
        db=this.dbHelper.getReadableDatabase();
        Log.d(TAG, "Initialized data");
    }

    public void close() {
        if (db != null)
            db.close();
    }

    public Database open() throws SQLException{
        this.dbHelper= new ContactsDBHelper(con);
        db=this.dbHelper.getWritableDatabase();
        db=this.dbHelper.getReadableDatabase();
        return this;
    }   

    public void insertOrIgnore(ContentValues values) {
        Log.d(TAG, "insertOrIgnore on " + values);
        SQLiteDatabase db = this.dbHelper.getWritableDatabase();
        try {
            db.insertWithOnConflict(TABLE, null, values,
                    SQLiteDatabase.CONFLICT_IGNORE);
        } finally {
            db.close();
        }
    }

    /**
     * Deletes ALL the data
     */
    public void delete() {
        // Open Database
        SQLiteDatabase db = dbHelper.getWritableDatabase();

        // Delete the data
        db.delete(TABLE, null, null);

        // Close Database
        db.close();
    }
} 
```

可能对你有帮助。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-20T20:34:30.070

实际上，我发现了导致我遇到另一个问题的源问题：我必须将 dbHelper 的上下文传递到构造函数中才能从我的 Application 类中调用它。

产生的另一个错误是：

```
public static final String C_SCHEDULE = "YYYY-MM-DD"; 
```

您不能在创建数据库时使用减号作为分隔符，因为虚拟机将其视为数学符号。所以我的声明必须改为：

```
public static final String C_SCHEDULE = "YYYY_MM_DD"; 
```

# html - CSS：使嵌套的最小高度一致

> ID：16115866
> 
> 赞同：0
> 
> 时间：2013-04-20T02:21:09.070
> 
> 标签：html, nested, css

出于某种原因，在某些浏览器中，嵌套元素`min-height`不会继承祖父母的高度。

```
<html style="height: 100%">
    <body style="min-height: 100%">
        <div style="min-height: 100%; background: #CCC">
            <p>Hello World</p>
        </div>
    </body>
</html> 
```

我没有费心在不同的浏览器版本之间进行太多测试，但在 Chrome 26 和 Opera 12.14 中，它会按我的预期显示，灰色背景覆盖了大部分屏幕，左上角有 Hello World。

但是，在 IE 9 和 Firefox 20 中，灰色背景只是单行文本的高度。
进一步测试，添加：

**`position: relative`**对 div 没有任何改变
**`min-height: inherit`**div 也没有
**`position: absolute`**改变宽度，但在`height`上述所有浏览器中都是 100%，除了 IE 9，其中背景仅覆盖文本。
**`position: fixed`**类似于`position: absolute`，除了 IE 9 恢复到 100% 宽度的原始行为。
**`float: left`**与 类似`position: absolute`，只是 Firefox 20 也缩小了背景以仅覆盖文本。

来自[http://www.w3.org/TR/CSS2/visudet.html#the-height-property](http://www.w3.org/TR/CSS2/visudet.html#the-height-property)：

> 如果包含块的高度没有明确指定（即，它取决于内容高度），并且该元素不是绝对定位的，则该值计算为'auto'

是否`min-height`被认为是明确的？我认为这是浏览器之间的混淆。使用`position: absolute`，它修复了 Firefox，并且只有 IE 9 有意外行为（这并不意外，因为 IE）。

是否有可能在主要浏览器中保持一致？

请不要建议需要 JavaScript 或具有固定高度的正文的答案。我知道这些是可能的解决方法，但这不是我想要实现的。使用`position: absolute`也会破坏我的布局，因为它会将元素拉出流程，并且要定位在动态大小的元素下方，唯一的解决方法是 JavaScript。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-20T03:23:44.983

首先，您的观察：

> 在 Chrome 26 和 Opera 12.14 中，它按我的预期显示，灰色背景覆盖了大部分屏幕，左上角有 Hello World。

似乎确实不正确，在我的 Chrome 版本 26 中，它只显示灰色背景，单行文本的高度。（就像 Firefox 和 IE9 一样）。根据您引用的 w3 规范，我认为这是完全正确的，因为未明确指定`body`包含的高度。`div`

你可以用`display: table`,`display: table-row`和做一些事情`display: table-cell`。那你就完全不需要`min-height`了。我已经在**Chrome 26**、**Safari 5.1.7**、**Firefox 20**、**IE10**、**IE9 模式下**的**IE10、IE8 模式下的 IE10 中测试了这个**[jsFiddle](http://jsfiddle.net/9KV23/2/)，它在所有这些浏览器中的呈现完全相同，**在 IE7 模式下使用 IE10**时它开始中断.

 ********CSS**

```
html {
  display: table;
  height: 100%;
  width: 100%;
}
body {
  display: table-row;
}
div {
  display: table-cell;
  background: #CCC;
} 
```******

# javascript - 未捕获的类型错误：无法将属性“innerHTML”设置为 null

> ID：16115867
> 
> 赞同：1
> 
> 时间：2013-04-20T02:21:10.193
> 
> 标签：javascript, ajax

我在这段代码中遇到了一些麻烦。我已尽最大努力留在这本书上，但这本书似乎是错误的。

以下代码应显示已选择单选按钮的 RSS 提要。您还可以在[http://w3.cnm.edu/~bnoble/cis1210/afds/Travel/TravelDeals.html](http://w3.cnm.edu/~bnoble/cis1210/afds/Travel/TravelDeals.html)上查看该网站。

提前感谢您的帮助！

```
<html>
<head>
    <title>Travel Deals RSS Feed</title>
    <script>
        var rssRequest = false;
        function getRequestObject()
        {
            try
            {
                rssRequest = new XMLHttpRequest();
            }
            catch (requestError)
            {
                try
                {
                rssRequest = new ActiveXObject();
                }
                catch (requestError)
                {
                    try
                    {
                        rssRequest = new 
                        ActiveXObject("Micorsoft.XMLHTTP");
                    }
                    catch (requestError)
                    {
                        window.alert("I am sorry. Your browser does not support AJAX. Please upgrade your broweser and try again.");
                        return false;
                    }
                }
            }
            return rssRequest;
        }
        function rssUpdate()
        {
            if(!rssRequest)rssRequest = getRequestObject();
            for (var i=0; i<6; ++i)
            {
                if (document.forms[0].deals[i].checked == true)
                {
                    var rss = document.forms[0].deals[i].value;
                    break;
                }
            }
            rssRequest.abort();
            rssRequest.open("get","TravelDeals.php?" + "rss" + rss, true);
            rssRequest.send(null)
            rssRequest.onreadystatechange=getRssDeals;
            //clearTimeout(recentDeals);
            //var recentDeals = setTimeout('rssUpdate()', 5000);
        }
        function getRssDeals()
        {
            if(rssRequest.readyState==4 && rssRequest.status == 200)
            {
                var deals = rssRequest.responseXML; 
                document.getElementById("rssFeed").innerHTML = ""
                var dealsInfo=deals.getElementsByTagName("item");
                if (dealsInfo.length > 0)
                {
                    for (var i=0; i<dealsInfo.length; ++i) 
                    {
                        var curHeadline = dealsInfo[i].getElementsByTagName("title")[0].childNodes[0].nodeValue;
                        var curlink = dealsInfo[i].getElementsByTagName("link")[0].childNodes[0].nodeValue;
                        var curPubDate = dealsInfo[i].getElementsByTagName("pubDate")[0].childNodes[0].nodeValue;
                        var curDesc = dealsInfo[i].getElementsByTagName("description")[0].childNodes[0].nodeValue;
                        var curDeal = "<a href='" + curLink + "'>" + curHeadline + "</a><br/>";
                        curDeal +=  curDesc + "<br/>";curDeal += curDesc + "<br/>";
                        document.getElementById("rssFeed").innerHTML += curDeal;
                    }
                }
                else
                    document.getElementById("rssFeed").innerHTML = "The RSS feed appears to be broken or empty.";
            }
        }
    </script>
</head>
<body onload="rssUpdate()">
    <h1>Travel Deals RSS</h1>
    <form method="get" action="">
        <table border="1">
            <colgroup span="1" width="125"/>
            <colgroup span="1" width="350"/>
            <tr>
                <td align="top">
                    <input type="radio" name="deals" value="http://www.orbitz.com/rss/topdeals-vacationpackages.rss.xml" onclick="rssUpdate()"/><Orbitz<br/>
                    <input type="radio" name="deals" value="http://www.travelocity.com/dealservice/globaltrips-shopping-svcs/deals-1.0/services/RssDealsServices?ProductType=Air&rdr=GEN&nm=My~Travelocity~Specials&typ=0&orig=ABQ&dest=PHX,LAS,LAX,NYC,LGB&id=9197I1366355523195" checked="checked" onclick="rssUpdate()"/><Travelocity<br/>
                    <input type="radio" name="deals" value="http://press.hotwire.com/index.php?s=43&pagetemplate=rss" onclick="rssUpdate()"/><Hotwire<br/>
                </td>
                <td id="rssFeed" valign="top></td>
            </tr>
        </table>
    </form>
</body> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-20T02:26:18.827

页面中没有具有 id`rssFeed`的元素。

您可以通过在页面中添加一个`div`带有 id来解决它`rssFeed`

```
<div id="rssFeed"></div> 
```

试试这个完整的代码，因为你的标记中有未封闭的元素

```
<html>
    <head>
        <title>Travel Deals RSS Feed</title>
        <script>
            var rssRequest = false;
            function parseXML(xml){
                var parser, xmlDoc;
                if (window.DOMParser) {
                    parser = new DOMParser();
                    xmlDoc = parser.parseFromString(xml,"text/xml");
                } else  {
                    // Internet Explorer
                    xmlDoc = new ActiveXObject("Microsoft.XMLDOM");
                    xmlDoc.async = false;
                    xmlDoc.loadXML(xml); 
                }
            }
            function getRequestObject()
            {
                try
                {
                    rssRequest = new XMLHttpRequest();
                }
                catch (requestError)
                {
                    try
                    {
                    rssRequest = new ActiveXObject();
                    }
                    catch (requestError)
                    {
                        try
                        {
                            rssRequest = new 
                            ActiveXObject("Micorsoft.XMLHTTP");
                        }
                        catch (requestError)
                        {
                            window.alert("I am sorry. Your browser does not support AJAX. Please upgrade your broweser and try again.");
                            return false;
                        }
                    }
                }
                return rssRequest;
            }
            function rssUpdate()
            {
                if(!rssRequest)rssRequest = getRequestObject();
                for (var i=0; i<6; ++i)
                {
                    if (document.forms[0].deals[i].checked == true)
                    {
                        var rss = document.forms[0].deals[i].value;
                        break;
                    }
                }
                rssRequest.abort();
                rssRequest.open("get","TravelDeals.php?" + "rss" + rss, true);
                rssRequest.send(null)
                rssRequest.onreadystatechange=getRssDeals;
                //clearTimeout(recentDeals);
                //var recentDeals = setTimeout('rssUpdate()', 5000);
            }
            function getRssDeals()
            {
                if(rssRequest.readyState==4 && rssRequest.status == 200)
                {
                    var deals = parseXML(rssRequest.responseXML); document.getElementById("rssFeed").innerHTML = ""
                    var dealsInfo=deals.getElementsByTagName("item");
                    if (dealsInfo.length > 0)
                    {
                        for (var i=0; i<dealsInfo.length; ++i) 
                        {
                            var curHeadline = dealsInfo[i].getElementsByTagName("title")[0].childNodes[0].nodeValue;
                            var curlink = dealsInfo[i].getElementsByTagName("link")[0].childNodes[0].nodeValue;
                            var curPubDate = dealsInfo[i].getElementsByTagName("pubDate")[0].childNodes[0].nodeValue;
                            var curDesc = dealsInfo[i].getElementsByTagName("description")[0].childNodes[0].nodeValue;
                            var curDeal = "<a href='" + curLink + "'>" + curHeadline + "</a><br/>";
                            curDeal +=  curDesc + "<br/>";curDeal += curDesc + "<br/>";
                            document.getElementById("rssFeed").innerHTML += curDeal;
                        }
                    }
                    else
                        document.getElementById("rssFeed").innerHTML = "The RSS feed appears to be broken or empty.";
                }
            }
        </script>
    </head>
    <body onload="rssUpdate()">
        <h1>Travel Deals RSS</h1>
        <form method="get" action="">
            <table border="1">
                <colgroup span="1" width="125"/>
                <colgroup span="1" width="350"/>
                <tr>
                    <td align="top">
                        <input type="radio" name="deals" value="http://www.orbitz.com/rss/topdeals-vacationpackages.rss.xml" onclick="rssUpdate()"/><Orbitz<br/>
                        <input type="radio" name="deals" value="http://www.travelocity.com/dealservice/globaltrips-shopping-svcs/deals-1.0/services/RssDealsServices?ProductType=Air&rdr=GEN&nm=My~Travelocity~Specials&typ=0&orig=ABQ&dest=PHX,LAS,LAX,NYC,LGB&id=9197I1366355523195" checked="checked" onclick="rssUpdate()"/><Travelocity<br/>
                        <input type="radio" name="deals" value="http://press.hotwire.com/index.php?s=43&pagetemplate=rss" onclick="rssUpdate()"/><Hotwire<br/>
                    </td>
                </tr>
            </table>
            <div id="rssFeed"><div>
        </form>
    </body>
</html> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-20T02:35:07.447

这是因为您的`td`元素中缺少结束引号。你有`<td id="rssFeed" valign="top></td>`什么时候你想要什么`<td id="rssFeed" valign="top"></td>`。解决这个问题应该会导致元素出现。

# jsp - 在 servlet 中导入的类在 jsp 中没有解析

> ID：16115868
> 
> 赞同：-1
> 
> 时间：2013-04-20T02:21:23.527
> 
> 标签：jsp, servlets, import

在我的 web 项目中，我有一个 Class A、Class B（这些类在其他项目中，但正在成功导入），它是在 CompServlet.java 中导入的。还有一个 ListComp.jsp ，它正在导入 CompServlet.java。我的问题是 ListComp.jsp 无法看到 A 类和 B 类。它给出错误 A 类型未解析为类型。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-20T07:17:15.637

Imports are not transitive. If class A imports class B, and class C imports class A, class C doesn't automatically import class B.

If you need to use the class B without typing its fully quelified name every time (com.foo.bar.B), then you need to import it. It's as simple as that.

That said, I concur with BalusC. Having Java code in JSPs is ugly, and should be avoided.

# visual-studio - 无法在 Visual Studio 2010 或 2012 中安装 .vsix

> ID：16115870
> 
> 赞同：2
> 
> 时间：2013-04-20T02:21:40.810
> 
> 标签：visual-studio, breeze, visual-studio-templates

我下载了 Breeze / Angular Js 模板作为 R/D 工作的一部分：

[http://www.asp.net/single-page-application/overview/templates/breezeangular-template](http://www.asp.net/single-page-application/overview/templates/breezeangular-template)

双击 .vsix 文件使用 Visual Studio 2012 将其打开，但作为只读二进制文件（如果有人熟悉 HxD 或类似的十六进制编辑器，它看起来有点像）。我尝试使用 Visual Studio 2010 打开它，但得到了相同的结果。

我尝试在 vs 2010 中打开 ExtensionManager，但没有发现有关导入模板的信息。我在 vs 2012 中尝试了扩展和更新（相当于 ExtensionManager ），也找不到任何关于在那里导入模板的信息。

关于我遇到的问题，我在 Google 上一无所获。

是否有不同的默认程序应该处理 .vsix 文件（例如打开方式...某种 Visual Studio 安装程序或其他东西）？

如果有人能解决这个令人沮丧的困境，那就太好了。此外，不幸的是，将电脑扔出窗外对我来说不是一个选择。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-07-18T02:47:49.167

The templates only work on VS 2012 R2.

This is noted (with no fanfare) in several places. Here is a quote from the [MS Angular SPA template page](http://www.asp.net/single-page-application/overview/templates/breezeangular-template):

> The Breeze/Angular SPA template is a variation on the KnockoutJS SPA template included in the ASP.NET and Web Tools 2012.2 Update.

You download the .vsix and double-click it. That either installs it successfully ... or you have an environment problem ... such as not having VS2012.r2.

These SPA tempate VSIXs are ALWAYS SAFE to install and easy to uninstall. They do not change Visual Studio and they do not install/uninstall anything in Visual Studio itself. They are simply xcopied into a well-known directory where VS can find them. They are harmless when they fail.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-07-17T09:12:04.237

我遇到了同样的问题，使用 shai 的 Visual Studio 版本选择器打开方法对我有用。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-05-15T03:12:02.490

它应该安装..未打开。看起来扩展程序没有被识别。2012 的 vsix 将不会在 2010 中安装，因为格式已更改。尝试使用 Visual Studio 版本选择器..vslauncher.exe 打开它。失败我唯一能想到的就是重新安装visual studio 2012

# haskell - 输入“=”时解析错误我的 Haskell 有问题

> ID：16115873
> 
> 赞同：0
> 
> 时间：2013-04-20T02:22:02.153
> 
> 标签：haskell

这是一个简单的功能：

```
len [] = 0    
len (x:xs) = 1 + len xs 
```

我已经将它加载到 GHCi 中`:l`，但我在输入时得到了这个错误解析错误`=`。

我在另一台电脑上运行，然后就可以了。我的电脑是Mac。我的 Haskell 有问题吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-20T02:30:38.830

您需要在函数的两个模式之间换行`len`。然后它工作正常：

```
$ cat len.hs
len [] = 0
len (x:xs) = 1 + len xs
$ ghci
GHCi, version 7.4.1: http://www.haskell.org/ghc/  :? for help
Loading package ghc-prim ... linking ... done.
Loading package integer-gmp ... linking ... done.
Loading package base ... linking ... done.
Prelude> :l len.hs
[1 of 1] Compiling Main             ( len.hs, interpreted )
Ok, modules loaded: Main.
*Main> len []
0
*Main> len [1]
1
*Main> len [1,2,3]
3
*Main> 
```

既然您提到它是 Mac，也许您有换行符约定不兼容。确保您的文本编辑器和 GHCi 就平台上的换行符的构成达成一致。

# perl - 如何更新 OSX 上的 perl 颠覆绑定？

> ID：16115883
> 
> 赞同：2
> 
> 时间：2013-04-20T02:23:45.110
> 
> 标签：perl, git-svn, osx-mountain-lion

我遇到了可能与 perl svn 绑定有关的 git-svn[问题。](https://stackoverflow.com/questions/16091953/what-does-git-svn-died-of-signal-6-mean-during-clone-operation)即使在使用自制软件安装了新版本的 subversion 和 git 之后，git-svn 仍在使用旧版本的 svn：

```
$ git svn --version
git-svn version 1.8.2.1 (svn 1.6.18)

$ svn --version
svn, version 1.7.7 (r1393599) 
```

如何让 git-svn 使用较新版本的 svn？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-20T14:40:21.087

感谢[这个答案](https://stackoverflow.com/a/4342029/980607)，我找到了一个合理的解决方案。我跑了`sudo cpan SVN::Core`，它更新了 git-svn 的 svn 版本：

```
$ git svn --version
git-svn version 1.8.2.1 (svn 1.7.3) 
```

原生 svn 版本没有改变。所以我留下了两个不同版本的svn，但至少它们是相同的主要版本。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-08-19T22:51:59.907

如果使用自制软件，请卸载 git，使用自制软件更新/安装 svn，然后使用以下命令重新安装 git：

```
brew install git --with-brewed-svn 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-08-26T12:31:30.800

将 svn-perl 绑定指向系统上特定 svn 安装的另一种方法是将以下行添加到 bash 配置文件：

```
export PERL5LIB=/usr/local/lib/svn-perl 
```

该路径将根据 svn-perl 绑定的安装目录而有所不同。例如，WanDisco svn 客户端安装通常在`/opt/subversion/lib/svn-perl`.

[我从这里](http://jfcouture.com/2007/12/16/installing-git-on-mac-os-x/)了解到这个技巧。

# regex - 可以更改R中的记录分隔符吗？

> ID：16115887
> 
> 赞同：1
> 
> 时间：2013-04-20T02:25:22.570
> 
> 标签：regex, r, delimiter

从文本文件中读取数据（即read.table）时是否可以操作记录/观察/行分隔符？使用 sep="" 调整字段分隔符很简单，但我还没有找到一种方法来从行尾字符更改记录分隔符。

我正在尝试读取管道分隔的文本文件，其中许多条目是包含回车的长字符串。R 将这些 CR 视为行尾，这会错误地开始新行并搞砸记录数和字段顺序。

我想使用不同的分隔符而不是 CR。事实证明，每一行都以相同的字符串开头，所以如果我可以使用 \nString 之类的东西来识别*真正*的行尾，那么表格将正确导入。以下是其中一个文本文件可能看起来的简化示例。

```
V1,V2,V3,V4
String,A,5,some text
String,B,2,more text and
more text
String,B,7,some different text
String,A,, 
```

应该读入 R 为

```
V1      V2       V3      V4
String  A        5       some text
String  B        2       more text and more text
String  B        7       some different text
String  A        N/A     N/A 
```

我可以在文本编辑器中打开文件并在读入之前使用查找/替换来清理它们，但是 R 中的系统解决方案会很棒。谢谢你的帮助。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-20T03:22:48.187

我们可以将它们读入并在之后折叠它们。g 将具有值 0 用于标题，1 用于下一行（以及后续行，如果有的话，将与它一起使用）等等。 `tapply`根据`g`给出折叠行`L2`，最后我们重新阅读这些行：

```
Lines <- "V1,V2,V3,V4
String,A,5,some text
String,B,2,more text and
more text
String,B,7,some different text
String,A,,"

L <- readLines(textConnection(Lines))

g <- cumsum(grepl("^String", L))
L2 <- tapply(L, g, paste, collapse = " ")

DF <- read.csv(text = L2, as.is = TRUE)
DF$V4[ DF$V4 == "" ] <- NA 
```

这给出了：

```
> DF
      V1 V2 V3                      V4
1 String  A  5               some text
2 String  B  2 more text and more text
3 String  B  7     some different text
4 String  A NA                    <NA> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-20T14:40:01.757

如果您使用的是 Linux/Mac，那么您应该真正使用命令行工具，例如 eg `sed`。以下是两种略有不同的方法：

```
# keep the \n
read.csv(pipe('sed \'N; s/\\([^,]*\\)\\n\\([^,]*$\\)/"\\1\\n\\2"/\' test.txt'))
#      V1 V2 V3                       V4
#1 String  A  5                some text
#2 String  B  2 more text and\nmore text
#3 String  B  7      some different text
#4 String  A NA

# get rid of the \n and replace with a space
read.csv(pipe('sed \'N; s/\\([^,]*\\)\\n\\([^,]*$\\)/\\1 \\2/\' test.txt'))
#      V1 V2 V3                      V4
#1 String  A  5               some text
#2 String  B  2 more text and more text
#3 String  B  7     some different text
#4 String  A NA 
```

# ruby-on-rails - 如何在 Rails 中使用 LEGACY 数据库？

> ID：16115890
> 
> 赞同：1
> 
> 时间：2013-04-20T02:25:53.840
> 
> 标签：ruby-on-rails, legacy-database

我在一个 Rails 网站上工作，该网站介绍股票共同基金和 ETF。我已经有一个单独的 Ruby 脚本，它每晚运行并使用这些共同基金和 ETF 的数据填充 Postgres 数据库。

Rails 教程的第 6 章并不是我想要的。我正在尝试做的与 Rails 教程第 6 章所做的不同之处在于： 1\. 在我的 Rails 站点中，不需要创建数据库，因为它已经被填充。所以我认为我不需要使用“rails generate”或“rake db:migrate”。（或者我错了吗？） 2\. 我的 Rails 站点只读取数据，不添加、删除或编辑数据。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2014-09-30T19:52:24.760

您不必创建迁移。只需创建您的模型。如果数据库表与模型名称不匹配，您可以使用`set_table_name`旧版本的 Rails 或`self.table_name = 'table_name'`新版本。如果你不使用外键和主键的 Rails 标准，你也必须指定它们。

例如：

```
# Assuming newer versions of Rails (3.2+, I believe)

class ETF < ActiveRecord::Base
  self.primary_key = 'legacy_id'
  self.table_name = 'legacy_etfs'
  has_many :closing_prices, foreign_key: 'legacy_etf_id'
end

class ClosingPrice < ActiveRecord::Base
  self.primary_key = 'legacy_id'
  self.table_name = 'legacy_closing_prices'
  belongs_to :etf, foreign_key: 'legacy_etf_id'
end 
```

# mobile - Marmalade SDK 是否支持应用购买？

> ID：16115895
> 
> 赞同：1
> 
> 时间：2013-04-20T02:26:23.797
> 
> 标签：mobile, in-app-purchase, marmalade

我正在搜索 Marmalade SDK 支持的功能，但在应用程序购买中找不到任何信息。有谁知道怎么做并且可以给我一些关于它的资源？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-21T13:30:35.647

Marmalade 支持 Android、iOS、黑莓和 Windows phone 8 的应用内购买。您只需要查看它们拥有的特定平台特定 API。例如，[在此处](http://docs.madewithmarmalade.com/native/platformguides.html)查看他们的平台特定指南。

# visual-studio-2010 - 分析报告中缺少调用树数据

> ID：16115902
> 
> 赞同：6
> 
> 时间：2013-04-20T02:27:25.207
> 
> 标签：visual-studio-2010, windows-7, profiler

我正在尝试使用 Visual Studio Performance Profiler 来分析我正在运行的进程。我正在使用“采样”收集类型，并且在它已经开始之后附加到该过程。当我完成分析并尝试加载报告时，它会在 CPU 使用率图表上方显示消息“没有可用的调用树数据”。

此外，还会产生以下错误：

> DA0002：似乎是在未使用 VSPerfCLREnv.cmd 正确设置环境变量的情况下收集了文件。托管二进制文件的符号可能无法解析。

我能找到的关于此错误的唯一信息是从命令行而不是从 Visual Studio 运行探查器。

我最好的猜测是，这可能是 32 位与 64 位的问题，因为我最近收到了一台装有 64 位 Windows 7 的升级计算机。在我以前的 32 位版本的机器上一切正常的 Windows 7。

# c++ - C union char数组在mac上打印'd'？

> ID：16115904
> 
> 赞同：2
> 
> 时间：2013-04-20T02:27:07.043
> 
> 标签：c++, c

我是 C/C++ 新手，但很想知道我看到的问题。

```
typedef union
{
   int a;
   float c;
   char b[20];
}
Union;

int main()
{
 Union y = {100};
 printf("Union y :%d - %s - %f \n",y.a,y.b,y.c);
} 
```

输出是

```
 Union y :100 - d - 0.000000 
```

我的问题是……为什么要打印“d”？我改变了联合中的顺序仍然是相同的输出。但如果我在联合之外声明一个 char f[20] ，则不会打印任何内容。我有 MacBook lion 图像并使用 xcode。提前致谢

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-04-20T02:30:17.560

的 ASCII 码`'d'`是 100。设置`a`为 100 相当于设置`b`为`{'d', '\0', '\0', '\0', …noise…}`（在 32 位 little-endian 机器上），将其`printf`视为`"d"`.

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-04-20T03:54:31.130

以下程序可以帮助您更好地理解：

```
#include <stdio.h>

typedef union
{
    int a;
    float c;
    char b[20];
}
Union;

void dump(const void* buffer, size_t length)
{
    size_t i;
    for (i = 0; i < length;) {
        printf("%.2x ", reinterpret_cast<const unsigned char*>(buffer)[i]);
        ++i;
        if (i % 16 == 0) {
            putchar('\n');
        } else if (i % 8 == 0) {
            putchar(' ');
        }
    }
    if (i % 16 != 0) {
        putchar('\n');
    }
}

int main()
{
    Union y = {100};
    printf("Union y :%d - %s - %f \n",y.a,y.b,y.c);
    printf("The content of the Union is: \n");
    dump(&y, sizeof y);
} 
```

输出是：

```
联合 y :100 - d - 0.000000
联盟的内容是：
64 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
00 00 00 00

```

*实际上， a*（即 a `int`）的二进制表示是`64 00 00 00`, 100 的 little-endian 十六进制。*b*的二进制表示是`64 00 ...`，0x00 结束字符串，而 0x64 是 'd'。*c*的二进制表示是`64 00 00 00`，在[IEEE 浮点表示](http://en.wikipedia.org/wiki/Single_precision_floating-point_format)中是 0.0，因为非零部分是指数。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-04-20T05:38:03.980

> 我改变了联合中的顺序仍然是相同的输出。

联合中元素的顺序不会改变任何东西，因为联合中的所有元素都使用同一块内存。您的代码打印`100`for`y.a`和`d`for`y.b`因为两个表达式解释相同的字节。因此，例如，如果您添加一行设置`y.b`然后再次打印：

```
Union y = {100};
printf("Union y :%d - %s - %f \n",y.a,y.b,y.c);
y.b = 'f';
printf("Union y :%d - %s - %f \n",y.a,y.b,y.c); 
```

你会看到这一点，`y.a`并`y.c.`在任何时候`y.b`改变，反之亦然。`y.a`应该在第二个中更改为 102 `printf()`，因为那是`'f'`.

# xcode - Xcode 4.5 文件模板 - 插入电子邮件地址/网站？

> ID：16115906
> 
> 赞同：1
> 
> 时间：2013-04-20T02:28:35.800
> 
> 标签：xcode, templates

我一直在尝试编辑 Xcode 4.5（在应用程序包内）中的源代码文件模板，以实现这种对 doxygen 更友好的标题注释格式：

```
/*!
    @file ___FILENAME___

    @package ___PROJECTNAME___

    @brief

    @details

    @author ___FULLUSERNAME___ | ___EMAIL___ | ___WEBSITE___

    @date ___DATE___

    @version

    @copyright ___YEAR___ ___ORGANIZATIONNAME___. All rights reserved.

    @section License
*/ 
```

起初，我使用的是旧的方法来编辑默认值（通过命令行或在 Xcode 的内置 plist 编辑器中编辑 com.apple.Xcode.plist 文件），但更改没有应用 - 即使在重新启动 Xcode 之后。我希望编辑`ORGANIZATIONNAME`并添加我自己的`EMAIL`和`WEBSITE`字段（参见上面的代码）。

我`ORANIZATIONNAME`在每个项目的基础上阅读了现在在 Xcode GUI 上输入的某个地方，所以我得到了那个工作。但我仍然希望从预设默认值或（更好）从我的地址簿中扩展`___EMAIL___`and 。`___WEBSITE___`这可能吗？

# django - 推送到 Heroku 时，“'django_mongodb_engine' 不是可用的数据库后端”

> ID：16115907
> 
> 赞同：2
> 
> 时间：2013-04-20T02:28:51.723
> 
> 标签：django, mongodb, heroku, django-mongodb-engine

我有一个在 Heroku 上成功运行并使用 mongodb 引擎的 Django 应用程序。一下子，我再也推不动了。它似乎不再识别 django_mongodb_engine 模块。我什至将所有更改恢复到上次运行的版本，但它仍然是一样的。我怀疑版本冲突左右，但不知道如何解决它。

这是我得到的错误：

```
Traceback (most recent call last):
  File "manage.py", line 10, in <module>
    execute_from_command_line(sys.argv)
  File "/app/.heroku/python/lib/python2.7/site-packages/django/core/management/__init__.py", line 429, in execute_from_command_line
    utility.execute()
  File "/app/.heroku/python/lib/python2.7/site-packages/django/core/management/__init__.py", line 379, in execute
    self.fetch_command(subcommand).run_from_argv(self.argv)
  File "/app/.heroku/python/lib/python2.7/site-packages/django/core/management/base.py", line 191, in run_from_argv
    self.execute(*args, **options.__dict__)
  File "/app/.heroku/python/lib/python2.7/site-packages/django/core/management/base.py", line 220, in execute
    output = self.handle(*args, **options)
  File "/app/.heroku/python/lib/python2.7/site-packages/django/core/management/base.py", line 351, in handle
    return self.handle_noargs(**options)
  File "/app/.heroku/python/lib/python2.7/site-packages/django/core/management/commands/shell.py", line 46, in handle_noargs
    from django.db.models.loading import get_models
  File "/app/.heroku/python/lib/python2.7/site-packages/django/db/__init__.py", line 78, in <module>
    connection = connections[DEFAULT_DB_ALIAS]
  File "/app/.heroku/python/lib/python2.7/site-packages/django/db/utils.py", line 93, in __getitem__
    backend = load_backend(db['ENGINE'])
  File "/app/.heroku/python/lib/python2.7/site-packages/django/db/utils.py", line 51, in load_backend
    raise ImproperlyConfigured(error_msg)
django.core.exceptions.ImproperlyConfigured: 'django_mongodb_engine' isn't an available database backend. 
Try using django.db.backends.XXX, where XXX is one of:
    'dummy', 'mysql', 'oracle', 'postgresql', 'postgresql_psycopg2', 'sqlite3'
Error was: No module named utils 
```

这些是来自的重要部分`requirements.txt`：

```
hg+https://bitbucket.org/wkornewald/django-nonrel
git+https://github.com/django-nonrel/mongodb-engine
hg+https://bitbucket.org/wkornewald/djangotoolbox

pymongo==2.2.1
pytz==2012d 
```

我特别困惑，因为我还原了所有更改。正是这个具有相同配置的代码运行完美（并且仍然在我的生产服务器上运行），只是推送不起作用。

谢谢西蒙

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-20T03:07:32.420

当然，就在我问的时候，我想出了答案:-)

我不知道为什么，但是定义我想检查的确切版本解决了这个问题。

所以`requirements.txt`现在看起来像这样：

```
-e hg+http://bitbucket.org/wkornewald/django-nonrel@be48c152abc6b15e45155e2bbcfd69c665ccb536#egg=Django-dev
-e git+https://github.com/django-nonrel/mongodb-engine@52257b5d90dcfaa564e708264a9cfe591d301fe6#egg=django_mongodb_engine-dev
-e hg+https://bitbucket.org/wkornewald/djangotoolbox@a8cdf61ba9c0cdc7cbbbd37d693e9a222d9a8e5f#egg=djangotoolbox-dev

pymongo==2.2.1
pytz==2012d 
```

# javascript - 如何调动所有与 http://www.google.com/gwt/x?u= 的链接？

> ID：16115908
> 
> 赞同：1
> 
> 时间：2013-04-20T02:28:52.197
> 
> 标签：javascript, redirect, mobile, prefix

我正在尝试使用 Google Mobilizer 这个伟大的服务“动员”我的一些页面上的链接：[http ://www.google.com/gwt/x?u=](http://www.google.com/gwt/x?u=)

有没有办法为 div 或元素中的所有链接添加前缀，所以链接不是 site.com/link，而是[http://www.google.com/gwt/x?u=site.com/link](http://www.google.com/gwt/x?u=site.com/link) ?

我认为这样的事情可能会起作用：

```
if (window.location == $LINK)
    window.location = "http://www.google.com/gwt/x?u=" + $LINK; 
```

我只是不确定如何编码。如果您知道它是如何完成的，我将非常感谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-09-13T20:06:27.783

我认为这可能对你有用：

1.  [`Mobile_Detect.php`](https://github.com/serbanghita/Mobile-Detect)在 GitHub下载文件
2.  把它放在你服务器的根目录
3.  将此代码放在您要重定向的每个页面的开头

    ```
    <?php
    include('Mobile_Detect.php');
    $detect = new Mobile_Detect();
    if ($detect->isMobile()) {header('Location: http://www.google.com/gwt/x?u=http://' . $_SERVER["HTTP_HOST"] . $_SERVER["REQUEST_URI"],PHP_URL_PATH . '');}
    ?> 
    ```

我在[这个网站上](http://www.onlinecasinoselite.com/)对其进行了测试并且工作正常

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-10-07T07:45:49.567

我写了这个[Google Mobilizer 小书签，因为我很想抓挠](http://mvark.blogspot.in/2012/04/google-mobilizer-bookmarklet-view-just.html)。

您可以调整代码以满足您的要求。

# javascript - 如何在 jQuery 中获取某个类的所有表行的总和？

> ID：16115910
> 
> 赞同：0
> 
> 时间：2013-04-20T02:29:06.717
> 
> 标签：javascript, jquery

如何将仅表行的值与`countMe`jQuery 中的类相加？

HTML：

```
<div id="sum">$0</div>
<table>
    <tr>
        <th>id</th> <th>value</th>
    </tr>
    <tr class="countMe">
        <td>1</td> <td class="v">$10</td>
    </tr>
    <tr>
        <td>2</td> <td class="v">$20</td>
    </tr>
    <tr class="countMe">
        <td>3</td> <td class="v">$10</td>
    </tr>
    <tr>
        <td>4</td> <td class="v">$30</td>
    </tr>
</table> 
```

我需要`#sum`说`$20`。我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-20T02:32:40.557

你可以这样做：

```
var sum = 0;

$('tr.countMe td.v').each(function() {
    sum += parseFloat($(this).text().slice(1));
});

$('#sum').text(sum); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-20T02:39:15.957

尝试

```
$(function() {
 var countme = $('.countMe .v'), total=0;
    countme.each(function(key,val) {
        total += parseFloat($(this).text().slice(1));
    });
    $('#sum').html('$'+total);
}); 
```

# c++ - 为什么模板功能不明确？

> ID：16115913
> 
> 赞同：0
> 
> 时间：2013-04-20T02:29:43.220
> 
> 标签：c++, templates

当我编译这段代码时，我收到一条错误消息

> 重载的调用`swap(int&, int&)`不明确

但我在这里只写了一个交换函数。

你能告诉我为什么这个函数是模棱两可的，我需要做哪些改变才能正确运行程序？

```
using namespace std;

template <class T>
void swap(T& x, T& y)
{
    T temp;
    temp = x;
    x = y;
    y = temp;
}

int main()
{
    int a, b;

    cout << "Enter two elements: ";

    cin >> a;
    cin >> b;

    swap(a, b);
    cout << "a is "<<a << '\t'<<"b is " << b << std::endl;

    return 0;
} 
```

为什么即使只有交换功能，交换功能也会重载？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-20T02:32:06.980

你应该使用

```
 ::swap(a,b); //use one in global namespace, which is the one you defined 
```

如果你想调用你定义的那个。由于`std`还定义了一个函数模板，如果你不使用`swap`，编译器会搜索。`std namespace``::`

更具体地说，参数`a`和是 中定义`b`的类型，当编译器搜索 时，它会找到两个版本：一个在 中，另一个是您在 中定义。您需要告诉编译器它应该明确使用哪一个，否则会导致歧义。`int``std namespace``swap``std namespace``global namespace`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-20T02:39:26.757

因为你有“使用命名空间 std;”，并且大概你正在包括“算法”，所以你可以看到 std::swap。这会给您带来编译器警告您的歧义。

解决方案是不添加“using namespace std;”，或者在未命名的命名空间中显式调用您自己的函数，将其称为“::swap(a, b)”

# android - Android NDK：使用其他 C++ 库

> ID：16115918
> 
> 赞同：1
> 
> 时间：2013-04-20T02:30:22.667
> 
> 标签：android, c++, eclipse

我正在尝试在 Android 应用程序中运行一些现有的 C++ 代码。我已经设置了 NDK，并将源文件复制到`jni`我的 Eclipse 项目的文件夹中。

我的 C++ 文件包含来自其他地方的包含和命名空间使用，我不确定如何正确地将它们导入（安装？）到我的 Android 项目中。

C++ 文件中的代码：

```
#include <gvars3/instances.h>
#include <TooN/SVD.h>
#include <fstream>
#include <stdlib.h>

using namespace CVD;
using namespace std;
using namespace GVars3; 
```

所有这些库都是“未解决的包含”。如何将这些库放入我的项目中？

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-20T04:08:50.063

它与通常的方式没有什么不同。您可以执行以下操作之一：

*   将所有源代码放在一起并构建一个 .so
*   将其他库构建为单独的 .so 文件，并在您的 Android 项目中将它们加载到您自己的 .so*之前（顺序很重要）*

# java - 如何使用 .equals() 方法比较两个密码（创建密码和确认密码）？

> ID：16115922
> 
> 赞同：2
> 
> 时间：2013-04-20T02:31:12.733
> 
> 标签：java, swing, serialization, passwords

我正在构建一个与我的 LogInScreen 类集成的简单的创建帐户用户 GUI。它创建一个简单的用户，将其序列化，然后让我在我的登录程序中使用该访问权限。问题是，当我输入密码时，它们永远不会正确。我总是遇到一个问题，我的程序告诉我我的密码不一样。我不确定如何解决这个问题，我想知道如何解决。我将在下面发布我的代码（整个事情，以及我的序列化类，因为问题可能在这里）。

用户等级：

```
package passwordProgram;

import java.util.ArrayList;

import java.awt.BorderLayout;
import java.awt.Color;
import java.awt.GridBagConstraints;
import java.awt.GridBagLayout;
import java.awt.event.ActionEvent;
import java.awt.event.ActionListener;

import java.io.Serializable;

import javax.swing.JButton;
import javax.swing.JFrame;
import javax.swing.JLabel;
import javax.swing.JPanel;
import javax.swing.JPasswordField;
import javax.swing.JTextField;
import javax.swing.UIManager;

public class User implements Serializable, ActionListener {

    public static ArrayList<String> allUsernames = new ArrayList<String>();

    String username;
    String password;

    public static void main(String[] args) {
        try {
            UIManager.setLookAndFeel(UIManager.getSystemLookAndFeelClassName());
        } catch (Exception e) {
            e.printStackTrace();
        }
        User user = new User();
        user.mainGUI();
    }

    JFrame frame;
    JPanel panel;
    JTextField createUsername;
    JPasswordField createPassword;
    JPasswordField confirmPassword;
    JButton createAccount;
    JLabel noValid;

    public void mainGUI() {
        noValid = new JLabel();
        frame = new JFrame("Create a new account!");
        panel = new JPanel();
        panel.setBackground(Color.ORANGE);
        createPassword = new JPasswordField(10);
        confirmPassword = new JPasswordField(10);
        createUsername = new JTextField(10);
        JLabel userTxt = new JLabel("New Username: ");
        JLabel userPass = new JLabel("New Password: ");
        JLabel confirmPass = new JLabel("Confirm Password: ");
        createAccount = new JButton("Create your account!");

        panel.setLayout(new GridBagLayout());
        GridBagConstraints left = new GridBagConstraints();
        left.anchor = GridBagConstraints.WEST;
        GridBagConstraints right = new GridBagConstraints();
        right.anchor = GridBagConstraints.EAST;
        right.weightx = 2.0;
        right.fill = GridBagConstraints.HORIZONTAL;
        right.gridwidth = GridBagConstraints.REMAINDER;

        frame.getContentPane().add(BorderLayout.NORTH, noValid);
        frame.getContentPane().add(BorderLayout.CENTER, panel);
        panel.add(userTxt, left);
        panel.add(createUsername, right);
        panel.add(userPass, left);
        panel.add(createPassword, right);
        panel.add(confirmPass, left);
        panel.add(confirmPassword, right);

        frame.getContentPane().add(BorderLayout.SOUTH, createAccount);
        frame.setVisible(true);
        frame.setSize(500, 300);

        createAccount.addActionListener(this);
    }

    public void actionPerformed(ActionEvent event) {
        if (createUsername.getText().length() <= 0 ) {
            noValid.setText("That is not a valid username. Please try again.");
            frame.getContentPane().add(BorderLayout.NORTH, noValid);
        }

        else if (allUsernames.contains(createUsername.getText())) {
            noValid.setText("That username is already taken. Please try again.");
            frame.getContentPane().add(BorderLayout.NORTH, noValid);
        }

            //THIS IS THE PART I'M CONFUSED ABOUT
        else if (!(createPassword.getPassword().equals(confirmPassword.getPassword()))) {
            noValid.setText("Your passwords do not match!");
            frame.getContentPane().add(BorderLayout.NORTH, noValid);
        } else {    
            SaveUser sUser = new SaveUser();
            sUser.createAccount(this);
            noValid.setText("Account created successfully");
            frame.getContentPane().add(BorderLayout.NORTH, noValid);
        }
    }
} 
```

和序列化类：

```
package passwordProgram;

import java.io.FileOutputStream;
import java.io.ObjectOutputStream;

public class SaveUser {
    public void createAccount(User u) {
        try {
            FileOutputStream fileOS = new FileOutputStream("userInfo.txt");
            ObjectOutputStream objectOS = new ObjectOutputStream(fileOS);
            objectOS.writeObject(u);
            objectOS.close();
        } catch (Exception e) {
            e.printStackTrace();
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-04-20T02:37:55.733

`getPassword()`回报`char[]`，不是`String`。利用

```
!(Arrays.equals(createPassword.getPassword(), confirmPassword.getPassword())) 
```

反而

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-04-20T02:38:34.007

除非这是一个玩具项目，否则不应以明文形式存储密码。相反，存储密码的哈希值；当用户登录时，对密码进行哈希处理并将其与存储的哈希值进行比较。 [这个问题的接受答案有一些示例哈希代码](https://stackoverflow.com/questions/2860943/suggestions-for-library-to-hash-passwords-in-java)。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-04-20T02:36:05.130

您正在比较`char`数组`Objects`（由[getPassword()](http://docs.oracle.com/javase/7/docs/api/javax/swing/JPasswordField.html#getPassword%28%29)返回）而不是数组本身的内容。比较这两个数组的最安全方法是使用`Arrays#equals`：

```
else if (!(Arrays.equals(createPassword.getPassword(), 
                            confirmPassword.getPassword()))) { 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2013-04-20T02:37:35.140

`JPasswordField.getPassword()`返回一个`char[]`。用两个 char 数组调用`array1.equals(array2)`（就像你正在做的那样）将检查它们是否是相同的对象引用，而不是它们是否具有相同的内容。您想使用[`Array.equals(char[] array1, char[] array2)](http://docs.oracle.com/javase/6/docs/api/java/util/Arrays.html)，如下所示：

```
else if (!Array.equals(createPassword.getPassword(), confirmPassword.getPassword())) 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2013-04-20T02:34:46.460

`getPassword()`返回一个`char[]`。所以改为尝试：

```
if (!(new String(createPassword.getPassword()).equals(new String(confirmPassword.getPassword())) 
```

# facebook - TouchXML 和 Facebook SDK iOS

> ID：16115924
> 
> 赞同：1
> 
> 时间：2013-04-20T02:32:00.397
> 
> 标签：facebook, touchxml

我一直收到此错误，并且在尝试解决它时迷失了方向：

```
ld: warning: directory not found for option '-F/Users/user/Desktop/IntegratingFacebookTutorial-master/../../../Documents/FacebookSDK'
Undefined symbols for architecture i386:
  "_FBTokenInformationExpirationDateKey", referenced from:
      -[PFFacebookTokenCachingStrategy cacheTokenInformation:] in Parse(PFFacebookTokenCachingStrategy.o)
      -[PFFacebookTokenCachingStrategy expirationDate] in Parse(PFFacebookTokenCachingStrategy.o)
      -[PFFacebookTokenCachingStrategy setExpirationDate:] in Parse(PFFacebookTokenCachingStrategy.o)
  "_FBTokenInformationTokenKey", referenced from:
      -[PFFacebookTokenCachingStrategy accessToken] in Parse(PFFacebookTokenCachingStrategy.o)
      -[PFFacebookTokenCachingStrategy setAccessToken:] in Parse(PFFacebookTokenCachingStrategy.o)
  "_FBTokenInformationUserFBIDKey", referenced from:
      -[PFFacebookTokenCachingStrategy facebookId] in Parse(PFFacebookTokenCachingStrategy.o)
      -[PFFacebookTokenCachingStrategy setFacebookId:] in Parse(PFFacebookTokenCachingStrategy.o)
  "_OBJC_CLASS_$_FBRequest", referenced from:
      objc-class-ref in UserDetailsViewController.o
      objc-class-ref in Parse(PFFacebookAuthenticationProvider.o)
  "_OBJC_CLASS_$_FBSession", referenced from:
      objc-class-ref in AppDelegate.o
      objc-class-ref in Parse(PFFacebookAuthenticationProvider.o)
  "_OBJC_CLASS_$_FBSessionTokenCachingStrategy", referenced from:
      _OBJC_CLASS_$_PFFacebookTokenCachingStrategy in Parse(PFFacebookTokenCachingStrategy.o)
  "_OBJC_METACLASS_$_FBSessionTokenCachingStrategy", referenced from:
      _OBJC_METACLASS_$_PFFacebookTokenCachingStrategy in Parse(PFFacebookTokenCachingStrategy.o)
  "_htmlParseDoc", referenced from:
      -[CXHTMLDocument initWithXHTMLString:options:error:] in CXHTMLDocument.o
  "_htmlReadMemory", referenced from:
      -[CXHTMLDocument initWithXHTMLData:encoding:options:error:] in CXHTMLDocument.o
  "_xmlAddChild", referenced from:
      -[CXMLDocument(CXMLDocument_CreationExtensions) addChild:] in CXMLDocument_CreationExtensions.o
      -[CXMLElement(CXMLElement_CreationExtensions) addChild:] in CXMLElement_CreationExtensions.o
      -[CXMLElement(CXMLElement_CreationExtensions) setStringValue:] in CXMLElement_CreationExtensions.o
  "_xmlAddPrevSibling", referenced from:
      -[CXMLDocument(CXMLDocument_CreationExtensions) insertChild:atIndex:] in CXMLDocument_CreationExtensions.o
  "_xmlCopyNode", referenced from:
      -[CXMLNode copyWithZone:] in CXMLNode.o
  "_xmlDocDumpFormatMemory", referenced from:
      -[CXMLDocument description] in CXMLDocument.o
  "_xmlDocDumpMemory", referenced from:
      -[CXMLDocument XMLDataWithOptions:] in CXMLDocument.o
  "_xmlDocGetRootElement", referenced from:
      -[CXMLDocument initWithData:encoding:options:error:] in CXMLDocument.o
      -[CXMLDocument rootElement] in CXMLDocument.o
  "_xmlDocSetRootElement", referenced from:
      +[CXMLNode(CXMLNode_CreationExtensions) documentWithRootElement:] in CXMLNode_CreationExtensions.o
      -[CXHTMLDocument initWithXHTMLString:options:error:] in CXHTMLDocument.o
  "_xmlFree", referenced from:
      -[CXMLDocument XMLDataWithOptions:] in CXMLDocument.o
      -[CXMLDocument description] in CXMLDocument.o
  "_xmlFreeDoc", referenced from:
      -[CXMLDocument dealloc] in CXMLDocument.o
  "_xmlFreeNode", referenced from:
      -[CXMLNode(CXMLNode_PrivateExtensions) invalidate] in CXMLNode_PrivateExtensions.o
  "_xmlGetCharEncodingName", referenced from:
      -[CXHTMLDocument initWithXHTMLString:options:error:] in CXHTMLDocument.o
  "_xmlGetLastError", referenced from:
      -[CXHTMLDocument initWithXHTMLString:options:error:] in CXHTMLDocument.o
      -[CXMLDocument initWithXMLString:options:error:] in CXMLDocument.o
      -[CXMLDocument initWithData:encoding:options:error:] in CXMLDocument.o
  "_xmlNewDoc", referenced from:
      +[CXMLNode(CXMLNode_CreationExtensions) document] in CXMLNode_CreationExtensions.o
      +[CXMLNode(CXMLNode_CreationExtensions) documentWithRootElement:] in CXMLNode_CreationExtensions.o
  "_xmlNewNode", referenced from:
      +[CXMLNode(CXMLNode_CreationExtensions) elementWithName:] in CXMLNode_CreationExtensions.o
      +[CXMLNode(CXMLNode_CreationExtensions) elementWithName:URI:] in CXMLNode_CreationExtensions.o
      +[CXMLNode(CXMLNode_CreationExtensions) elementWithName:stringValue:] in CXMLNode_CreationExtensions.o
  "_xmlNewNs", referenced from:
      +[CXMLNode(CXMLNode_CreationExtensions) elementWithName:URI:] in CXMLNode_CreationExtensions.o
  "_xmlNewPI", referenced from:
      +[CXMLNode(CXMLNode_CreationExtensions) processingInstructionWithName:stringValue:] in CXMLNode_CreationExtensions.o
  "_xmlNewText", referenced from:
      -[CXMLElement(CXMLElement_CreationExtensions) setStringValue:] in CXMLElement_CreationExtensions.o
  "_xmlNodeDumpOutput", referenced from:
      -[CXMLNode XMLStringWithOptions:] in CXMLNode.o
  "_xmlNodeSetContent", referenced from:
      -[CXMLNode(CXMLNode_CreationExtensions) setStringValue:] in CXMLNode_CreationExtensions.o
  "_xmlOutputBufferClose", referenced from:
      -[CXMLNode XMLStringWithOptions:] in CXMLNode.o
  "_xmlOutputBufferCreateIO", referenced from:
      -[CXMLNode XMLStringWithOptions:] in CXMLNode.o
  "_xmlOutputBufferFlush", referenced from:
      -[CXMLNode XMLStringWithOptions:] in CXMLNode.o
  "_xmlParseDoc", referenced from:
      -[CXMLDocument initWithXMLString:options:error:] in CXMLDocument.o
  "_xmlReadMemory", referenced from:
      -[CXMLDocument initWithData:encoding:options:error:] in CXMLDocument.o
  "_xmlResetLastError", referenced from:
      -[CXHTMLDocument initWithXHTMLString:options:error:] in CXHTMLDocument.o
      -[CXMLDocument initWithXMLString:options:error:] in CXMLDocument.o
      -[CXMLDocument initWithData:encoding:options:error:] in CXMLDocument.o
  "_xmlSetNs", referenced from:
      -[CXMLElement(CXMLElement_CreationExtensions) addNamespace:] in CXMLElement_CreationExtensions.o
  "_xmlStrcmp", referenced from:
      -[CXMLElement elementsForName:] in CXMLElement.o
      -[CXMLElement elementsForLocalName:URI:] in CXMLElement.o
      -[CXMLElement attributeForName:] in CXMLElement.o
      -[CXMLElement attributeForLocalName:URI:] in CXMLElement.o
      -[CXMLElement namespaceForPrefix:] in CXMLElement.o
      -[CXMLElement resolvePrefixForNamespaceURI:] in CXMLElement.o
  "_xmlUnlinkNode", referenced from:
      -[CXMLDocument dealloc] in CXMLDocument.o
      -[CXMLNode(CXMLNode_PrivateExtensions) invalidate] in CXMLNode_PrivateExtensions.o
  "_xmlXPathEvalExpression", referenced from:
      -[CXHTMLDocument initWithXHTMLString:options:error:] in CXHTMLDocument.o
      -[CXMLNode nodesForXPath:error:] in CXMLNode.o
      -[CXMLNode(CXMLNode_NamespaceExtensions) nodesForXPath:namespaceMappings:error:] in CXMLNode_XPathExtensions.o
  "_xmlXPathFreeContext", referenced from:
      -[CXHTMLDocument initWithXHTMLString:options:error:] in CXHTMLDocument.o
      -[CXMLNode nodesForXPath:error:] in CXMLNode.o
      -[CXMLNode(CXMLNode_NamespaceExtensions) nodesForXPath:namespaceMappings:error:] in CXMLNode_XPathExtensions.o
  "_xmlXPathFreeObject", referenced from:
      -[CXHTMLDocument initWithXHTMLString:options:error:] in CXHTMLDocument.o
      -[CXMLNode nodesForXPath:error:] in CXMLNode.o
      -[CXMLNode(CXMLNode_NamespaceExtensions) nodesForXPath:namespaceMappings:error:] in CXMLNode_XPathExtensions.o
  "_xmlXPathNewContext", referenced from:
      -[CXHTMLDocument initWithXHTMLString:options:error:] in CXHTMLDocument.o
      -[CXMLNode nodesForXPath:error:] in CXMLNode.o
      -[CXMLNode(CXMLNode_NamespaceExtensions) nodesForXPath:namespaceMappings:error:] in CXMLNode_XPathExtensions.o
  "_xmlXPathRegisterNs", referenced from:
      -[CXMLNode(CXMLNode_NamespaceExtensions) nodesForXPath:namespaceMappings:error:] in CXMLNode_XPathExtensions.o
ld: symbol(s) not found for architecture i386
clang: error: linker command failed with exit code 1 (use -v to see invocation) 
```

# javascript - JavaScript 将坐标从一个函数传递到另一个函数

> ID：16115927
> 
> 赞同：0
> 
> 时间：2013-04-20T02:32:29.397
> 
> 标签：javascript, function, variables

我在将两个坐标从一个函数传递到另一个函数时遇到问题。我真的不知道 JavaScript，但它似乎有点正确。你能告诉我我的错误在哪里吗？

```
 <head>
      <script>
       var zoom = 12; // 18 for mobile phones because the geolocation is more accurate 

       function init() {
         // Don't bother if the web browser doesn't support cross-document messaging
         if (window.postMessage) {
           if (navigator && navigator.geolocation) {
             try {
               navigator.geolocation.getCurrentPosition(function(pPos) {
               send(pPos.coords.latitude, pPos.coords.longitude);
             }, function() {});
             } catch (e) {}
           } else if (google && google.gears) {
             // Relevant if targeting mobile phones (some of which may have Google Gears)
             try {
               var geoloc = google.gears.factory.create("beta.geolocation");
               geoloc.getCurrentPosition(function(pPos) {
               send(pPos.latitude, pPos.longitude);
             }, function() {});
             } catch (e) {}
           }
         }
       }

       function send(pLat, pLng) {
         var myiframe = document.getElementById("myiframe").contentWindow;
         // The third parameter, zoom, is optional
         myiframe.postMessage(pLat + "," + pLng + "," + zoom, "http://www.qib.la");
       }

       window.onload=init;
      </script>
     </head>

     <body>
      <iframe id="myiframe" src="http://www.qib.la/embed/" width="400" height="400">
        Check the prayer direction towards the Ka'ba in Makkah at
        <a href="http://www.qib.la/">Qibla Direction</a>.
      </iframe>

<script type="text/javascript" src="http://praytimes.org/code/v2/js/PrayTimes.js"></script>

<br>
<p align="center">Waterloo, ON, Canada<p>
<div align="center" id="table"></div>

<script type="text/javascript">

    var date = new Date(); // today
    var times = prayTimes.getTimes(date, pLat + "," + pLng, -5);
    var list = ['Fajr', 'Sunrise', 'Dhuhr', 'Asr', 'Maghrib', 'Isha', 'Midnight'];

    var html = '<table id="timetable">';
    html += '<tr><th colspan="2">'+ date.toLocaleDateString()+ '</th></tr>';
    for(var i in list)  {
        html += '<tr><td>'+ list[i]+ '</td>';
        html += '<td>'+ times[list[i].toLowerCase()]+ '</td></tr>';
    }
    html += '</table>';
    document.getElementById('table').innerHTML = html;

</script>

     </body> 
```

是否可以从异步函数返回值？我如何在这里使用回调？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-20T04:49:44.460

此代码中有语法错误：

```
var times = prayTimes.getTimes(date, + b + ',' + c + , -5); 
```

你有一个“+”，然后是一个逗号。我不确定您对代码的意图是什么，但这就是导致它无法运行的原因。

也许您打算遵循将逗号附加为字符串的模式？

```
var times = prayTimes.getTimes(date + ',' + b + ',' + c + ',' + -5); 
```

或者也许 -5 是一个单独的论点？

```
var times = prayTimes.getTimes(date, b + ',' + c, -5); 
```

# c++ - 在 Linux 中读取文件时出错

> ID：16115928
> 
> 赞同：0
> 
> 时间：2013-04-20T02:32:35.250
> 
> 标签：c++, parsing

在我的程序中，我使用以下代码从命令行参数中获取两个文件名：

```
ifstream routesFile (arv[1]);
ifstream citiesFile (arv[2]); 
```

然后我继续阅读文件并获取数据。这两个文件都是 CSV：

```
while(citiesFile.good()){
        string city;
        string country;
        string xString;
        string yString;
        getline(citiesFile, country, ',');
        getline(citiesFile, city, ',');
        getline(citiesFile, xString, ',');
        getline(citiesFile, yString);
...
} 
```

当我在 Visual Studio 中使用硬编码的文件名执行此操作时，它工作正常。当我在使用 g++ 后在 linux 中使用命令行参数时，它可以正确打开文件，但之后会出现很多错误。为了测试文件读取，我打印了一些导致的读取值

```
terminate called after throwing an instance of 'std::out_of_range'
  what():  map::at
hereELF
Òœc½Å¹jn!ýô (EÕL˜C 
```

的出现`here`是由于实际上是在程序中打印出来的。它不是由错误引起的，我手动打印它来测试代码。

似乎无法正确读取数据。在城市文件的文件中，每行总是有 4 个值，每个值由单个命令分隔，没有空格，并且文件中的行分隔符是换行符。正如我上面所说，它在 Visual Studio 中运行良好，所以我认为实际数据没有问题，只是阅读它。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-20T02:56:56.310

Linux 和 window 有不同的换行符。Linux '\n'，Windows '\r\n'。如果您只是将文件复制到 linux 中，则需要在程序中处理这些文件。你可以看看在[Linux 和 Windows 下混合 cin 和 getline](https://stackoverflow.com/questions/13003521/mixing-cin-and-getline-under-linux-and-windows)作为参考。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-20T02:58:57.177

如果您只是将 Windows 文件移动到 Linux，请查看工具**dos2unix**来转换文件并修复行尾。输出中的“EOL”表示结尾可能有问题。

[http://www.linuxcommand.org/man_pages/dos2unix1.html](http://www.linuxcommand.org/man_pages/dos2unix1.html)

# php - 在php中上传文件后找不到我的文件

> ID：16115931
> 
> 赞同：0
> 
> 时间：2013-04-20T02:32:54.607
> 
> 标签：php, html, windows

我正在使用以下 php 脚本上传文件：

```
<?php
$dest_dir="C:\Users\Maria\Documents\IT-learning";
foreach ($_FILES as $file_name => $file_array) {  
    echo "path: ".$file_array['tmp_name']."<br/>\n"; //output is "C:\Windows\Temp\phpB4C9.tmp" instead
    echo "name: ".$file_array['name']."<br/>\n";
    echo "type: ".$file_array['type']."<br/>\n";
    echo "size: ".$file_array['size']."<br/>\n";

    if (is_uploaded_file($file_array['tmp_name'])) {
        move_uploaded_file($file_array['tmp_name'], $dest_dir.$file_array['name'])
        or die ("file exists but can't be moved");
        echo "File uploaded successfully.";
    } else {
        echo "File does not exist.";
    }
} //single file is fine.  opened single file is  
?> 
```

输出是这样的：

```
path: C:\Windows\Temp\phpB4C9.tmp
name: test2.xml
type: text/xml
size: 4523
File uploaded successfully. 
```

`test2.xml`我的问题是除了在原始目录中之外，我在计算机上看不到该文件。据我了解，我应该看到它移动到`C:\Users\Maria\Documents\IT-learning`. `C:\Users\Maria\Documents\IT-learning`但我在 in或 in都没有看到它`C:\Windows\Temp\phpB4C9.tmp`。

我错过了什么吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-20T02:42:06.330

首先，您需要小心字符串文字中的反斜杠：

```
$dest_dir="C:\\Users\\Maria\\Documents\\IT-learning"; 
```

您应该将它们加倍以防止意外的特殊转义序列。

其次，您缺少尾部斜杠：

```
$dest_dir="C:\\Users\\Maria\\Documents\\IT-learning\\"; 
```

由于您缺少最后一个反斜杠，我相信您会找到一个名为：

```
C:\Users\Maria\Documents\IT-learningtest2.xml 
```

此外，按原样信任用户输入（例如，文件名）也不是很安全。

# php - php文件需要很长时间加载然后返回空白页mysqli

> ID：16115935
> 
> 赞同：0
> 
> 时间：2013-04-20T02:34:02.323
> 
> 标签：php, mysqli

我正在尝试以用户编辑的形式显示事件的元素。我希望输入或选择当前值，但我希望它以某种方式不必验证各种信息。我有一个日历选择器，想使用下拉菜单来显示时间。此代码挂起几分钟，然后返回一个完全空白的页面。我只是用所有查询使服务器超载还是我的代码有问题？

```
 $id = $_POST['id'];

        /* Edit Event Form */
        echo '<form action="edit-event-process.php" method="post">';
        echo '<center><table style="text-align:center">';

        /* Set up queries individually to allow for dropdowns for hour, minute, am/pm, category */
        /************* Query for Name *******************/  
        $queryName = mysqli_query($link, "SELECT Name FROM events WHERE id = " . $id);
        while($rowName = mysqli_fetch_assoc($queryName)){
            foreach($rowName as $keyName => $valName){
                echo '<tr><td>Name: </td><td><input type="text" id="Name" name="Name" value="' . $valName . '"></td></tr>';
            }
        }
        /************* Query for Description **************/
        $queryDesc = mysqli_query($link, "SELECT Description FROM events WHERE id = " . $id);
        while($rowDesc = mysqli_fetch_assoc($queryDesc)){
            foreach($rowDesc as $keyDesc => $valDesc){
                echo '<tr><td>Description: </td><td><input type="text" id="Description" name="Description" value="' . $valDesc . '"></td></tr>';
            }
        }
        /************* Query for Start Date ***************/
        $queryStDt = mysqli_query($link, "SELECT StartDate FROM events WHERE id = " . $id);
        while($rowStDt = mysqli_fetch_assoc($queryStDt)){
            foreach($rowStDt as $keyStDt => $valStDt){
                echo '<tr><td>Start Date: </td><td><input type="text" id="StartDate" name="StartDate" value="' . $valStDt . '"></td></tr>';
            }
        }
        /************* Query for All Day **************/
        $queryAllDay = mysqli_query($link, "SELECT AllDay FROM events WHERE id = " . $id);
        while($rowAllDay = mysqli_fetch_assoc($queryAllDay)){
            foreach($rowAllDay as $keyAllDay => $valAllDay){
                if ($valAllDay == '1'){
                    echo '<tr><td>All Day? </td><td><input type="checkbox" id="AllDay" name="AllDay" checked="checked"></td></tr>';
                }
                else {
                    echo '<tr><td>All Day? </td><td><input type="checkbox" id="AllDay" name="AllDay"></td></tr>';
                }
            }
        }

/************/
echo '<div id="dates">';
/************/
        /************* Query for Start Hour ****************/
        echo '<tr><td>Start Hour</td><td><select name="StartHour" id="StartHour">';
        $queryStHr = mysqli_query($link, "SELECT TIME_FORMAT(StartTime, '%h') AS StartHour WHERE id = " . $id);
        while ($rowStHr = mysqli_fetch_assoc($resultStHr)){
            foreach($rowStHr as $keyStHr => $valStHr){
                $selectedStHr = $valStHr;
            }
        }
        if ($valStHr == "" || $valStHr == "null"){
            echo '<option value="null">--</option>';
        }
        else {
            echo '<option value="'.$valStHr.'">' . $valStHr . '</option>';
            echo '<option value="null">--</option>';
        }
        $sthr = 0;
        while($sthr < 13){
            echo '<option value="'.$sthr.'">' . $sthr . '</option>';
            $sthr = $sthr++;
        }
        echo '</select></td></tr>';

        /************* Query for Start Min *****************/
        echo '<tr><td>Start Minute</td><td><select name="StartMin" id="StartMin">';
        $queryStMin = mysqli_query($link, "SELECT TIME_FORMAT(StartTime, '%m') AS StartMin WHERE id = " . $id);
        while ($rowStMin = mysqli_fetch_assoc($resultStMin)){
            foreach($rowStMin as $keyStMin => $valStMin){
                $selectedStMin = $valStMin;
            }
        }
        if ($valStMin == "" || $valStMin == "null"){
            echo '<option value="null">--</option>';
        }
        else{
            if ($valStMin < 10){
                echo '<option value="0'.$valStMin.'">0' . $valStMin . '</option>';
                echo '<option value="null">--</option>';
            }
            else {
                echo '<option value="'.$valStMin.'">' . $valStMin . '</option>';
                echo '<option value="null">--</option>';
            }
        }
        $stmin = 0;
        while($stmin < 60){
            if ($stmin < 10){
                echo '<option value="0'.$stmin.'">0' . $stmin . '</option>';
            }
            else {
                echo '<option value="'.$stmin.'">' . $stmin . '</option>';
            }
            $stmin = $stmin +5;
        }
        echo '</select></td></tr>';

        /************* Query for Start AMPM ****************/
        echo '<tr><td>Start AM/PM</td><td><select name="StAP" id="StAP">';
        $queryStAP = mysqli_query($link, "SELECT TIME_FORMAT(StartTime, '%p') AS StAP WHERE id = " . $id);
        while ($rowStAP = mysqli_fetch_assoc($resultStAP)){
            foreach($rowStAP as $keyStAP => $valStAP){
                $selected = $valStAP;
            }
        }
        if ($valStAP != ""){
            echo '<option selected name="StAP" value="' . $valStAP . '">' . $valStAP . '</option>';
        }
        echo '<option value="--">--</option>';
        echo '<option value="am">am</option>';
        echo '<option value="pm">pm</option>';
        echo '</select></td></tr>';

        /************* Query for End Date *****************/
        $queryEndDt = mysqli_query($link, "SELECT EndDate FROM events WHERE id = " . $id);
        while($rowEndDt = mysqli_fetch_assoc($queryEndDt)){
            foreach($rowEndDt as $keyDesc => $valEndDt){
                echo '<tr><td>Start Date: </td><td><input type="text" id="StartDate" name="StartDate" value="' . $valEndDt . '"></td></tr>';
            }
        }       
        /************* Query for End Hour *****************/
        echo '<tr><td>End Hour</td><td><select name="EndHour" id="EndHour">';
        $queryEndHr = mysqli_query($link, "SELECT TIME_FORMAT(EndTime, '%h') AS EndHour WHERE id = " . $id);
        while ($rowEndHr = mysqli_fetch_assoc($resultEndHr)){
            foreach($rowEndHr as $keyEndHr => $valEndHr){
                $selectedEndHr = $valSEndHr;
            }
        }
        if ($valEndHr == "" || $valEndHr == "null"){
            echo '<option value="null">--</option>';
        }
        else {
            echo '<option value="'.$valEndHr.'">' . $valEndHr . '</option>';
            echo '<option value="null">--</option>';
        }
        $endmin = 0;
        while($endmin < 13){
            echo '<option value="'.$endmin.'">' . $endmin . '</option>';
            $endmin = $endmin++;
        }
        echo '</select></td></tr>';

        /************* Query for End Min ******************/
        echo '<tr><td>Start Minute</td><td><select name="EndMin" id="EndMin">';
        $queryEndMin = mysqli_query($link, "SELECT TIME_FORMAT(EndTime, '%m') AS EndMin WHERE id = " . $id);
        while ($rowEndMin = mysqli_fetch_assoc($resultEndMin)){
            foreach($rowEndMin as $keyEndMin => $valEndMin){
                $selectedEndMin = $valEndMin;
            }
        }
        if ($valEndMin == "" || $valEndMin == "null"){
            echo '<option value="null">--</option>';
        }
        else{
            if ($valEndMin < 10){
                echo '<option value="0'.$valEndMin.'">0' . $valEndMin . '</option>';
                echo '<option value="null">--</option>';
            }
            else {
                echo '<option value="'.$valEndMin.'">' . $valEndMin . '</option>';
                echo '<option value="null">--</option>';
            }
        }
        $endmin = 0;
        while($endmin < 60){
            if ($endmin < 10){
                echo '<option value="0'.$endmin.'">0' . $endmin . '</option>';
            }
            else {
                echo '<option value="'.$endmin.'">' . $endmin . '</option>';
            }
            $endmin = $endmin +5;
        }
        echo '</select></td></tr>';

        /************* Query for End AMPM *****************/
        echo '<tr><td>End AM/PM</td><td><select name="EndAP" id="EndAP">';
        $queryStAP = mysqli_query($link, "SELECT TIME_FORMAT(StartTime, '%p') AS EndAP WHERE id = " . $id);
        while ($rowEndAP = mysqli_fetch_assoc($resultEndAP)){
            foreach($rowEndAP as $keyEndAP => $valEndAP){
                $selected = $valEndAP;
            }
        }
        if ($valEndAP != ""){
            echo '<option selected name="StAP" value="' . $valEndAP . '">' . $valEndAP . '</option>';
        }
        echo '<option name="EndAP" value="--">--</option>';
        echo '<option name="EndAP" value="am">am</option>';
        echo '<option name="EndAP" value="pm">pm</option>';
        echo '</select></td></tr>';
/*************/
echo '</div>';
/************/
        /************* Query for Place ********************/
        $queryPlace = mysqli_query($link, "SELECT Place FROM events WHERE id = " . $id);
        while($rowPlace = mysqli_fetch_assoc($queryPlace)){
            foreach($rowPlace as $keyPlace => $valPlace){
                echo '<tr><td>Place: </td><td><input type="text" id="Place" name="Place" value="' . $valPlace . '"></td></tr>';
            }
        }
        /************** Query for Category *****************/           
        echo '<tr><td>Category</td><td><select name="category" id="category">';
        $query2 = "SELECT Category FROM events WHERE id = " . $id;
        $result2 = mysqli_query($link, $query2);
        while ($row2 = mysqli_fetch_assoc($result2)){
            foreach($row2 as $key2 => $val2){
                $selected = $val2;
            }
        }
        echo '<option name="none" value="">none</option>';
        $queryCategory = "SELECT name FROM categories";
        $result = mysqli_query($link, $queryCategory);
        while($row1 = mysqli_fetch_assoc($result)){
            foreach($row1 as $key1 => $val1){
                if ($val1 != ""){
                    if ($val1 == $val2){
                        echo '<option selected name="' . $key . '" value="' . $val1 . '">' . $val1 . '</option>';
                    }
                    else {
                        echo '<option name="' . $key . '" value="' . $val1 . '">' . $val1 . '</option>';
                    }
                }
            }
        }
        echo '</select></td></tr>';

        echo '<input type="hidden" name="id" value="' . $id . '" />';
        echo '<tr><td><input type="submit" value="Save Changes" /></td></tr>';
        echo "</table>";
        echo "</form>"; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-20T03:00:56.723

这不是一个完整的答案，但我建议你看看这个并修改你的代码。您正在运行不必要的查询，并且也存在安全错误。

```
//This needs to be casted here (assuming it is an int)
$id = (int) $_POST['id'];

/* Edit Event Form */
echo '<form action="edit-event-process.php" method="post">';
echo '<center><table style="text-align:center">';

/* Don't do queries individually */
$queryEvent = mysqli_query($link, "SELECT Name,Description,StartDate,AllDay FROM events WHERE id = " . $id);
if($row = mysqli_fetch_assoc($queryEvent)){
?>
    <tr>
        <td>Name: </td>
        <td><input type="text" id="Name" name="Name" value="<?php echo $row['Name']; ?>"></td>
    </tr>
    <tr>
        <td>Description: </td>
        <td><input type="text" id="Description" name="Description" value="<?php echo $row['Description']; ?>"></td>
    </tr>
    <tr>
        <td>Start Date: </td>
        <td><input type="text" id="StartDate" name="StartDate" value="<?php echo $row['StartDate']; ?>"></td>
    </tr>
    <tr>
        <td>All Day? </td>
        <td><input type="checkbox" id="AllDay" name="AllDay"<?php if($row['AllDay'] == '1') echo 'checked="checked"'; ?>></td></tr>';
    </tr>
<?php
} 
```

# java - 找到所有的哈密顿循环

> ID：16115942
> 
> 赞同：3
> 
> 时间：2013-04-20T02:35:20.343
> 
> 标签：java, recursion, hamiltonian-cycle

我正在尝试实现一种使用递归将所有可能的哈密顿循环添加到列表的方法。到目前为止，我的停止条件还不够，我在将顶点添加到列表的行中得到“OutOfMemoryError: Java heap space”：

```
private boolean getHamiltonianCycles(int first, int v, int[] parent,
        boolean[] isVisited, List<List<Integer>> cycles) {
    isVisited[v] = true;
    if (allVisited(isVisited) && neighbors.get(v).contains(new Integer(first))) {
        ArrayList<Integer> cycle = new ArrayList<>();
        int vertex = v;
        while (vertex != -1) {
            cycle.add(vertex);
            vertex = parent[vertex];
        }
        cycles.add(cycle);
        return true;
    } else if (allVisited(isVisited)) {
        isVisited[v] = false;
        return false;
    }
    boolean cycleExists = false;
    for (int i = 0; i < neighbors.get(v).size(); i++) {
        int u = neighbors.get(v).get(i);
        parent[u] = v;
        if (!isVisited[u]
                && getHamiltonianCycles(first, u, parent, isVisited, cycles)) {
            cycleExists = true;
        }
    }
    //if (!cycleExists) {
        isVisited[v] = false; // Backtrack
    //}
    return cycleExists;
} 
```

有人可以建议我做错了什么还是我的方法完全不正确？

编辑：正如评论中所建议的，罪魁祸首是父数组，导致无限循环。我无法更正它，我更改了数组以存储子元素。现在一切似乎都奏效了：

```
private boolean getHamiltonianCycles(int first, int v, int[] next,
        boolean[] isVisited, List<List<Integer>> cycles) {
    isVisited[v] = true;
    if (allVisited(isVisited) && neighbors.get(v).contains(first)) {
        ArrayList<Integer> cycle = new ArrayList<>();
        int vertex = first;
        while (vertex != -1) {
            cycle.add(vertex);
            vertex = next[vertex];
        }
        cycles.add(cycle);
        isVisited[v] = false;
        return true;
    }
    boolean cycleExists = false;
    for (int u : neighbors.get(v)) {
        next[v] = u;
        if (!isVisited[u]
                && getHamiltonianCycles(first, u, next, isVisited, cycles)) {
            cycleExists = true;
        }
    }

    next[v] = -1;
    isVisited[v] = false; // Backtrack
    return cycleExists;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-06-08T18:39:31.143

如果您正在寻找不相交的哈密顿循环[，这里](https://github.com/rayronvictor/DisjointHamiltonianCycles)有一个使用回溯的实现。

# xml - 使用 XmlSerializer 和使用 RPC Literal 的 Soap 在 WCF 上展开响应

> ID：16115943
> 
> 赞同：0
> 
> 时间：2013-04-20T02:35:32.620
> 
> 标签：xml, wcf, soap, wsdl, svcutil.exe

我正在尝试使用 WCF 使用 Soap 1.1 Web 服务。在从 wsdl 定义中使用 svcutil 生成代理后，我发现所有响应都为空。

该服务似乎使用 RPC 文字，因此 WCF 回退到使用`XmlSerializer`. 这是 wsdl 的定义：

```
<wsdl:definitions xmlns:typens="http://www.myservice.es/Schemas" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:soap="http://schemas.xmlsoap.org/wsdl/soap/" xmlns:soapenc="http://schemas.xmlsoap.org/soap/encoding/" xmlns:wsdl="http://schemas.xmlsoap.org/wsdl/" xmlns="http://schemas.xmlsoap.org/wsdl/" targetNamespace="http://www.myservice.es/Schemas">

<wsdl:types>
    <xsd:schema xmlns="http://www.w3.org/2001/XMLSchema" targetNamespace="http://www.myservice.es/Schemas">
        <xsd:include schemaLocation="../xsd/myservicetypes.xsd"/>           
    </xsd:schema>
</wsdl:types>
<message name="serviceRequest"/>
<message name="serviceResponse">
    <part name="serviceReturn" type="typens:DateTimeResponse"/>
</message>
<portType name="QueryServiceDateTimePort">
    <operation name="QueryServiceDateTime">
        <input message="typens:serviceRequest"/>
        <output message="typens:serviceResponse"/>
    </operation>
</portType>
<binding name="QueryServiceDateTimeBinding" type="typens:QueryServiceDateTimePort">
    <soap:binding style="rpc" transport="http://schemas.xmlsoap.org/soap/http"/>
    <operation name="QueryServiceDateTime">
        <soap:operation soapAction="urn:QueryServiceDateTime"/>
        <input>
            <soap:body use="literal" encodingStyle="http://schemas.xmlsoap.org/soap/encoding/" namespace="http://www.myservice.es/Schemas"/>
        </input>
        <output>
            <soap:body use="literal" encodingStyle="http://schemas.xmlsoap.org/soap/encoding/" namespace="http://www.myservice.es/Schemas"/>
        </output>
    </operation>
</binding>
<service name="QueryServiceDateTimeService">
    <port name="QueryServiceDateTimePort" binding="typens:QueryServiceDateTimeBinding">
        <soap:address location="https://www.tests.com"/>
    </port>
</service> 
```

但是，服务返回此响应：

```
<SOAP-ENV:Envelope xmlns:SOAP-ENV="http://schemas.xmlsoap.org/soap/envelope/">
   <SOAP-ENV:Header/>
   <SOAP-ENV:Body>
      <serviceResponse>
         <serviceReturn>
            <DateTime v="2013-04-20T01:13:22.001" xmlns="http://www.myservice.es/Schemas"/>
         </serviceReturn>
      </serviceResponse>
   </SOAP-ENV:Body>
</SOAP-ENV:Envelope> 
```

WCF 和 SoapUI 都期望元素名为`QueryServiceDateTimeResponse`instead 或 before `serviceResponse`，因此它们无法反序列化或验证响应。

我怎样才能让 WCF 协调这个响应并反序列化它？我可以标记代理以打开该元素吗？

我应该注意，我不能在这种情况下使用 MessageContract，因为它与 RPC - Literal 不兼容。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-20T03:20:36.987

正如我在这篇文章 ( [http://msdn.microsoft.com/en-us/library/ms996466.aspx](http://msdn.microsoft.com/en-us/library/ms996466.aspx) ) 中发现的，您可能可以切换到文档 - 文字。

# sql - sql 在 libreoffice base 中工作，但在 libre basic 中不工作

> ID：16115955
> 
> 赞同：2
> 
> 时间：2013-04-20T02:38:00.450
> 
> 标签：sql, libreoffice, libreoffice-basic, libreoffice-base

我有一个关于从表中获取最新记录的经典问题。这是声明：

```
SELECT t1.Item, t1.Price, t1.ODate
FROM Order AS t1
JOIN ( (SELECT Item, Price, Max(ODate) As MaxDate
        FROM Order
        GROUP BY Item ) As t2 )
ON t1.Item = t2.Item and t1.Odate = MaxDate
ORDER BY t1.Item ASC 
```

此语句适用于 phpMyAdmin 和 LibreOffice base，但 LibreOffice basic 给我一条消息：SQL 表达式中的语法错误。

有什么帮助吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-20T03:15:16.747

也许您应该从 t2 的选择中删除“价格”。加入似乎是无稽之谈，并且会在 MSSMS 2008 中导致错误消息，就我而言。

> 选择列表中的“Order.Price”列无效，因为它既不包含在聚合函数中，也不包含在 GROUP BY 子句中。

尝试

```
SELECT t1.Item, t1.Price, t1.ODate
FROM Order AS t1
JOIN  (SELECT Item, Max(ODate) As MaxDate
        FROM Order
        GROUP BY Item ) As t2 
ON t1.Item = t2.Item and t1.Odate = MaxDate
ORDER BY t1.Item ASC 
```

# asp.net - 如何将 html 电子邮件参数传递给 asp.net 页面

> ID：16115957
> 
> 赞同：-2
> 
> 时间：2013-04-20T02:38:09.407
> 
> 标签：asp.net, html, email, service, web

我需要将 html 电子邮件参数 var1 和 var2 传递到 asp.net 页面并从 asp.net 页面运行 asp.net Web 服务，该服务将使用从 html 电子邮件中获取的 var1 和 var2。我将感谢您对此的任何帮助，并在此先感谢您。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-20T02:57:22.620

您的电子邮件可能有一个链接，例如

```
<a href="yoursite/default.aspx?var1=value1&amp;var2=value2">text</a> 
```

然后您可以在您的`default.aspx`页面上获取此信息

```
protected void Page_Load(object sender, EventArgs e)
{
    var var1 = Request.QueryString["var1"];
    var var2 = Request.QueryString["var2"];
} 
```

# javascript - 为 HTML 中的无效字段自定义文本

> ID：16115958
> 
> 赞同：0
> 
> 时间：2013-04-20T02:38:09.687
> 
> 标签：javascript, html, css, dom-events

当输入的文本与模式不匹配时，我正在尝试显示自定义消息。以下是我使用的代码。

```
<input pattern="[a-zA-Z0-9]" name="firstName" id="firstname" required="" type="text" /> 
```

当我输入像“akshay”这样的有效文本时；它向我显示无效消息：

> '请匹配请求的格式'

另外，我想将此消息更改为自定义消息。我尝试使用上面给出的代码，但它不起作用。以下是我在下面使用的代码：

```
<script>
document.getElementById("firstname").addEventListener("invalid", function (e) {
var elem = e.target;

if (elem.value != "") {
    e.target.setCustomValidity('Cannot contain special characters');
}
});
</script> 
```

请帮我处理这段代码。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-20T02:58:58.250

尝试在输入标签中使用 oninvalid 方法

```
<input pattern="[a-zA-Z0-9]*" name="firstName" id="firstname" required="required"
type="text" oninvalid="oninvalid="this.setCustomValidity(this.willValidate?'':'Cannot contain special characters')" /> 
```

# kendo-ui - 如何在绑定字段时使用自定义页脚寺庙？它说 Id 未定义，但 id 是我的表属性

> ID：16115960
> 
> 赞同：1
> 
> 时间：2013-04-20T02:38:34.877
> 
> 标签：kendo-ui, kendo-grid, kendo-asp.net-mvc

绑定到字段时如何使用自定义页脚模板？它说

> 学生 ID 未定义

但是`studentId`是我的餐桌财产。

我的代码是这样的：

```
columns.Bound(p => p.studentId);
columns.Bound(p => p.Point)
.ClientGroupFooterTemplate("<div>average: #=kendo.toString(getPointby(studentId),'n0')  #</div><div>max: #= max #</div><div>min: #= min #</div>"); 
```

# c++ - 如何通过用户输入在堆上分配内存？

> ID：16115967
> 
> 赞同：1
> 
> 时间：2013-04-20T02:39:32.610
> 
> 标签：c++, visual-c++, heap-memory

有没有办法创建一个函数，可以将一块内存分配到堆上，调用者可以传递他们想要分配的大小并返回一个有效地址供调用者使用？我知道如何分配特定的大小，但有没有办法让调用者传递所需的数量？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-20T02:43:34.087

绝对：即使在C `malloc`//`calloc`中`realloc`都以大小为参数，他们并不关心这个大小是从哪里来的；也一样`new`。

例如，如果您想分配用户指定数量的`double`s，您可以这样做：

```
cout << "Enter the number of double elements that you want to allocate" << endl;
int count;
cin >> count;
// You can do this for C-style allocation...
double *chunkMalloc = malloc(sizeof(double)*count);
// ...or this for C++ style:
double *chunkNew = new double[count];
// Don't forget to free allocated chunks:
free(chunkMalloc);
delete[] chunkNew; 
```

# java - 为什么会出现 java.lang.OutOfMemory 错误？

> ID：16115971
> 
> 赞同：-9
> 
> 时间：2013-04-20T02:40:16.883
> 
> 标签：java, garbage-collection, jvm

我有一个服务器通过套接字处理请求并产生一个线程来处理每个请求。

为什么我会得到一个`java.lang.OutOfMemoryError`，我能做些什么来解决它？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-20T02:40:16.883

**类型 I：堆空间不足。**

这是最常见的错误。它可能很难追踪，因为它涉及了解哪些对象是“正常的”以及应该释放哪些对象。

创建无限数量的引用对象。创建特定于线程但被另一个全局对象引用的对象。

如果您可以重现该问题，请运行`jmap -dump:format=b,file=output.bin`

然后用`jhat`.

**类型 II：进程外内存**

如果您已经实现了 JNI 调用，或者有由创建 JNI 对象的 JVM 代表您创建的对象，您可能会用完进程内存，对于 32 位进程来说，这是 4 gig。

正在运行的 java 进程的进程空间包括：

*   jvm内存
*   加载的库
*   本机创建的对象

其中`-Xmx`只控制JVM内存的大小。

**类型 III：垃圾收集器不运行**

我在任何网络搜索中都没有找到任何关于这种情况的参考。我想我已经阅读了每个帖子以解决问题`java.lang.OutOfMemoryErrors`。

如果您有一个 Java 程序对本机代码进行 JNI 调用，那么当任何线程处于 JNI 调用中时，垃圾收集器不会运行。给定一个足够繁忙的系统，在一个 JNI 调用中有两个或更多线程，垃圾收集器可能永远不会运行。

第一个实例是一个长时间运行的 JNI 调用，它对 java 代码进行回调以释放当前对象并获取新对象。在每次迭代中，使用的内存量都会增加，并且未使用的对象不会被垃圾收集。

第二个实例是一个测试，其中每个生成的线程都会导致 JNI 调用。代码会运行很长时间，大约一个小时左右，但会以`java.lang.OutOfMemoryError`. 该`-Xloggc`选项显示前 4000 秒的定期垃圾收集，直到运行的并发线程数增加。

```
4055.330: [GC 4055.330: [ParNew: 147424K->12220K(147456K), 0.0073372 secs] 769563K->637289K(1294336K) icms_dc=0 , 0.0073809 secs] [Times: user=0.00 sys=0.00, real=0.01 secs]  
18668.710: [GC 18668.710: [ParNew: 143289K->16384K(147456K), 0.0297121 secs] 768358K->651851K(1294336K) icms_dc=0 , 0.0297604 secs] 
```

[2014 年 6 月 7 日更新] 在一个实例中，我发现了这个答案[Memory leak when calling java code from C using JNI fix](https://stackoverflow.com/questions/1340938/memory-leak-when-calling-java-code-from-c-using-jni)了这个问题。本地 java 内存分配给 C 堆栈，即使它是在 java 中分配的，因为它是从 JNI 调用内部创建的。具体来说，我使用 PushLocalFrame()/PopLocalFrame() 包装了对 java 的回调用以解决此问题。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-20T02:42:41.413

发生内存不足时强制进行堆转储。请参阅[我可以强制生成 JVM 崩溃日志文件吗？](https://stackoverflow.com/questions/337793/can-i-force-generation-of-a-jvm-crash-log-file). 然后使用那里列出的工具来缩小内存泄漏： [分析大型 Java 堆转储的工具](https://stackoverflow.com/questions/7254017/tool-for-analyzing-large-java-heap-dumps)

# c - C：计算字数（需要帮助修复）

> ID：16115974
> 
> 赞同：0
> 
> 时间：2013-04-20T02:40:34.043
> 
> 标签：c, string

我是 C 编程的新手，正在尝试编写用于计算字符串中单词数的代码。这是我用于计算代码数量的代码。

```
 #include<stdio.h> 
    #include<string.h>
    void main() 
    { 
        int count=0,i,len; 
        char str[100]; 
        printf("enter the sentence"); 
        gets(str); 
        len=strlen(str); 
        for(i=0;i<=len;i++) 
        {  
           if(str[i]==' ') 
              count++; 
        } 
        printf("the number of words are :\t%d",count+1); 
    } 
```

当我的输入是：`Here is four words`它工作正常。它给出了输出 `the number of words are : 4`

我的问题是如何处理单词之间的**“两个连续空格”**，输入的“**开头的空格”和输入****的“最后**的空格” 。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-20T03:54:45.133

不计算空格，而是计算每个单词的第一个非空格字符。

```
#include<stdio.h> 

int main() 
{ 
    int count=0; 
    char str[100]; 
    printf("enter the sentence"); 
    gets(str);

    char *cur= str;

    for (;;)
    {
        while (*cur == ' ')
        {
            cur++;
        }

        if (*cur == 0)
        {
            break;
        }

        count++;

        while (*cur != 0 && *cur != ' ')
        {
            cur++;
        }
    }

    printf("the number of words are :\t%d",count); 

    return 0;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-20T03:53:41.740

一种快速的方法是使用 strtok 并根据谓词破坏所有内容。此功能满足您的所有要求。

```
#include<stdio.h>
#include<string.h>
int countSpace(char* str){
int counter = 0;
char * newString;
newString= strtok (str, " "); // now the newString has the str except first word
while (newString != NULL){
    counter++; // Put counter here to ignore the newString == NULL 
                // Or just -1 from the counter on main()
    newString= strtok (NULL, " "); //Break the str in to words seperated by spaces

}
return counter;
}
void main(){
    int count=0,i,len;
    char str[100];
    printf("Enter the sentence:\n");
    fgets (str , 100 , stdin);
    count = countSpace(str);
    printf("The number of words are :\t%d\n",count);
    return 0;
} 
```

谢谢

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-20T02:56:24.890

只需忽略开头的空格和其他空格之后的空格，如果最后没有空格，则 +1。

```
#include <stdio.h> 
#include <string.h>
// #include <stdlib.h>
int main() // void main is a bad practice
{ 
    int count = 0, i, len, ignoreSpace; 
    char str[100];
    printf("enter the sentence\n"); 
    gets(str); 
    len = strlen(str); 
    ignoreSpace = 1; // handle space at the beginning
    for(i = 0; i < len; i++) // not i<=len
    { 
        if(str[i] == ' '){
            if(!ignoreSpace){
                count++;
                ignoreSpace = 1; // handle two or more consecutive spaces
            }
        }else{
            ignoreSpace = 0;
        }
    }
    if( !ignoreSpace ) // handle space at the last
        count++;
    printf("the number of words are :\t%d\n", count); // +1 is moved to previous line
    // system("pause");
    return 0;
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-20T02:48:42.673

您可以使用：

```
 while(str[i]==' '&&str[i]!=EOF) 
{
    count++;
    i++;
} 
```

而不是你的 if 部分。您还需要在 for 循环之前添加这些代码以读取开头的空格。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-04-20T02:48:55.873

我认为当前形式的循环可能无法正常工作，

应该如下，

```
 for(i=0;i<len;i++) 
    { 
          if(i!=0)
          {
             if(str[i]==' ') 
               count++; 
          }
    } 
```

要检查其他条件，请按如下方式更改代码，

```
 for(i=0;i<len;i++) 
    { 
             if(str[i]==' ') 
             {  
                if(i!=0)
                {  
                   if(str[i+1]!=' ')
                   {
                      count++;
                   } 
               }   
    } 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-04-20T03:08:48.753

您应该计算从空格到非空格字符的转换 + 开头本身可能的非空格字符。

```
#include<stdio.h> 
#include<string.h>
int main() 
{ 
    int count=0,i,len, cur_is_spc; 
    char str[100]; 
    printf("enter the sentence"); 
    gets(str); 
    len=strlen(str);

    cur_is_spc = 0;           // 0, if current character is not space. 1, if it is.

    for(i=0; str[i]!='\0'; i++) 
    { 
       if(str[i] != ' ')
       {
           switch(cur_is_spc) // currently holding value for previous character
           {
           case 0: count++; break;    //count the spc->non-spc transitions
           case 1:          break;
           default: cout << "Erroneous value"; exit(1);
           }
           cur_is_spc = 1;    //updated for current character.
       }
       else
       {
           cur_is_spc = 0;    //updated for current character.
       }
    } 

    printf("the number of words are :\t%d",count+1); 
    return 0;
} 
```

在这里，我只检查空格。但是可能会有换行符、制表符等字符。您的代码将如何处理它们？提示：使用 isspace() 函数。

/此外，如果您决定单词仅由字母组成，则可以从非字母字符转换为字母字符。这种方法本质上是灵活的，可以满足您的需求。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-04-20T03:12:09.060

为什么不使用[strtok](http://www.cplusplus.com/reference/cstring/strtok/)并完全绕过它：

```
int main()
{
    int num_words = 0;
    char    str_one[] = "This string has a trailing space ";
    char    str_two[] = " This string has a preceeding space";
    char    str_three[] = "This string contains  two spaces consecutively  twice!";
    char    delim[] = " ";
    char    *ret;

    /* fgets() for user input as desired... */

    if (( ret = strtok(str_one, delim)) != NULL )
    {
        while ( ret )
        {
            num_words++;
            ret = strtok(NULL, delim);
        }
    }
    else
    {
        /* no spaces, but might contain a word if the string isn't empty */
        if ( str_one[0] != '\0' )
            num_words = 1;
    }

    printf("str_one contains %i words\n", num_words);
    num_words = 0;

    ...

    return 0;
} 
```

顺便说一句：main 应该***总是***返回！！！

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2013-04-20T03:19:28.237

使用 strtok 和第一次调用 strtok 使用 strtok(string," ") 其余调用使用 strtok(NULL, " \n")

# javascript - 如何从中选择特定的文本值 我想从 HTML 和 javascript 中的选择选项选定文本（不是选项值）中获取值？一旦我能够获得该值，我就想像下面的那样获得特定的字符串。值为 2.500，文本选项值为 250 奖金。我想得到 250 并分配它自己的输入隐藏值。谢谢

> ID：16115979
> 
> 赞同：-7
> 
> 时间：2013-04-20T02:41:46.993
> 
> 标签：javascript, html

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-20T02:46:05.600

好的，根据您给出的内容，我可以猜测您需要获取选项的文本。

```
function getSelectedText(elementId) {
    var elt = document.getElementById(elementId);

    if (elt.selectedIndex == -1)
        return null;

    return elt.options[elt.selectedIndex].text;
} 
```

使用这种方式：

```
var text = getSelectedText('selectID'); 
```

* * *

或者正如[Derek](https://stackoverflow.com/users/283863/derek)建议的那样，您也可以将它放在一行中：

```
var text = elementId.querySelector("option:checked").innerText 
```

**注意：**这仅适用于现代浏览器。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-20T02:56:34.620

```
<form action="#">
<input type="hidden" name="bonus_hidden" value="" />
<select name="b" onchange="document.forms[0].elements['bonus_hidden'].value=document.forms[0].elements['b'].options[document.forms[0].elements['b'].selectedIndex].text">
<option value="1.000">100 bonus</option>
<option value="1.500">150 bonus</option>
<option value="2.000">200 bonus</option>
<option value="2.500">250 bonus</option>
</select>
</form> 
```

# c# - 表单在后台工作人员中不显示为对话框？

> ID：16115980
> 
> 赞同：1
> 
> 时间：2013-04-20T02:41:48.660
> 
> 标签：c#, winforms, dialog, backgroundworker

表单没有在后台工作人员中显示为对话框？

这是我的代码：

```
//From Form1
        private void backgroundWorkerResult_DoWork(object sender, DoWorkEventArgs e)
    {
        //do something here

        backgroundWorkerResult.ReportProgress(100);

        frmMessageBox frmMsgBox = new frmMessageBox();
        frmMsgBox.ShowDialog();
    } 
```

即使我已经`frmMsgBox`将对话框显示为我仍然可以单击`Form1`不应该的对话框？如何解决这个问题？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-20T05:02:05.657

我创建了一个简单的代码示例，您可以使用它来了解后台工作人员的工作方式。将代码复制到测试表单并添加以下控件

1.  标签控件 - 将其命名为“lblStatus”
2.  Progressbar Control - 它应该被命名为progressBar1。
3.  添加 2 个名为“btnStartAsyncOperation”和“btnCancel”的按钮并*链接它们的点击事件*。

基本上你应该在**RunWorkerCompleted**事件中显示结果

```
 public partial class Form1 : Form
    {
        BackgroundWorker backgroundWorker;

        public Form1()
        {
            InitializeComponent();
            backgroundWorker = new BackgroundWorker {WorkerReportsProgress = true, WorkerSupportsCancellation = true};

            backgroundWorker.DoWork += new DoWorkEventHandler(BackgroundWorker_DoWork);
            backgroundWorker.ProgressChanged += new ProgressChangedEventHandler(BackgroundWorker_ProgressChanged);
            backgroundWorker.RunWorkerCompleted += new RunWorkerCompletedEventHandler(BackgroundWorker_RunWorkerCompleted);

        }

        void BackgroundWorker_RunWorkerCompleted(object sender, RunWorkerCompletedEventArgs e)
        {
            if (e.Cancelled)
                lblStatus.Text = "Task Cancelled.";
            else if (e.Error != null)
                lblStatus.Text = "Error - " + e.Error.Message;
            else
                lblStatus.Text = "Task Completed...";

            btnStartAsyncOperation.Enabled = true;
            btnCancel.Enabled = false;
        }

        void BackgroundWorker_ProgressChanged(object sender, ProgressChangedEventArgs e)
        {
            progressBar1.Value = e.ProgressPercentage;
            lblStatus.Text = "Processing......" + progressBar1.Value.ToString() + "%";
        }

        void BackgroundWorker_DoWork(object sender, DoWorkEventArgs e)
        {
            for (int i = 0; i < 100; i++)
            {
                System.Threading.Thread.Sleep(100);
                backgroundWorker.ReportProgress(i);
                if (backgroundWorker.CancellationPending)
                {
                    e.Cancel = true;
                    backgroundWorker.ReportProgress(0);
                    return;
                }
            }
            backgroundWorker.ReportProgress(100);
        }

        private void btnStartAsyncOperation_Click(object sender, EventArgs e)
        {
            btnStartAsyncOperation.Enabled = false;
            btnCancel.Enabled = true;
            backgroundWorker.RunWorkerAsync();
        }

        private void btnCancel_Click(object sender, EventArgs e)
        {
            if (backgroundWorker.IsBusy)
            {
                backgroundWorker.CancelAsync();
            }
        }
    } 
```

**根据OP的评论编辑**

在 DoWork 事件中，将您的字符串设置如下

```
 e.Result = "Your String"; 
```

并在 RunWorkerCompleted 事件中

```
string muResult = Convert.ToString(e.Result); 
```

**注意：** e.Result 是一个对象，因此您甚至可以在其中设置具有多个属性的自定义类。

# php - 正则表达式，在“<”和“>”之间替换，php

> ID：16115981
> 
> 赞同：0
> 
> 时间：2013-04-20T02:41:53.237
> 
> 标签：php, regex, preg-replace, expression

我的正则表达式很弱。

我只需要用新内容替换`<`和`>` （以及介于两者之间的*任何*内容）。

这就是我所拥有的：

```
$key = preg_replace('/<.*>/', '', $key); 
```

`My little string <5>`应该只是`My little string`。
`My little string <96>`应该只是`My little string`。

我做错了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-20T02:51:38.360

如果您提供字符串而不是`$key`：

```
preg_replace('/<.*>/', '', 'My little string <96>'); 
```

的价值是`$key`多少？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-20T02:53:16.777

`$key`需要等于您要替换的字符串。您的正则表达式没有问题。

# c# - 如何用mysql填充gridview？

> ID：16115985
> 
> 赞同：7
> 
> 时间：2013-04-20T02:42:23.343
> 
> 标签：c#, asp.net, mysql, gridview

我只知道如何填充 gridview`asp:SqlDataSource`
但是我的 中有一个列，当`TemplateField`我`gridview`需要修改我的 SQL 以更改网格内容时，我丢失了我的`TemplateField`，所以我想学习`gridview`用 C#填充我的
有人可以教我或给我一些教程吗？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-04-20T05:24:27.753

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Web;
using System.Web.UI;
using System.Web.UI.WebControls;
using MySql.Data.Common;
using MySql.Data.MySqlClient;
using System.Data.SqlClient;
using System.Windows.Forms;
using System.Data;

public partial class viewAdmin : System.Web.UI.Page
{
    String MyConString = "SERVER=localhost;" +
                "DATABASE=databasename;" +
                "UID=root;" +
                "PASSWORD=;";
protected void Page_Load(object sender, EventArgs e)
{

        MySqlConnection conn = new MySqlConnection(MyConString);
        MySqlCommand cmd = new MySqlCommand("SELECT * FROM tablename;", conn);
        conn.Open();
        DataTable dataTable = new DataTable();
        MySqlDataAdapter da = new MySqlDataAdapter(cmd);

        da.Fill(dataTable);

        GridVIew.DataSource = dataTable;
        GridVIew.DataBind();
}

} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-04-20T08:15:41.637

我刚刚创建了一个带有 SqlDataSource 的基本页面，它可以完成您想做的所有事情。

这就是我所做的。将 SqlDataSource 从工具箱拖到设计视图中的页面上。单击智能标记并配置数据源。单击新建连接。如果您正在使用本地安装的 MySql，那么服务器名称很可能是 localhost，用户名是 root，密码是您在计算机上安装和配置 MySql 服务器时指定的任何内容。选择您的数据库。单击此处的测试连接按钮以确保其正常工作总是一个好主意。现在，浏览向导的其余部分（下一步，下一步）。当您进入“配置选择语句”页面时，在指定要查询的表和字段后，请确保单击右侧的高级按钮，然后单击生成插入、更新和删除语句。

此时，您需要转到源视图。对我来说，生成的语句不是正确的 MySql 语法，所以你必须修复它们。最简单的方法是在源视图中进行查找/替换并将所有“[”和“]”替换为“`”。请记住，这不是撇号。它是键盘顶部数字行中 1 左侧的另一个外观相似的字符（我不知道你怎么称呼它）。您还需要在插入、更新和删除语句中的“？”之后添加实际字段名称，以使参数正常工作。

好的，现在回到您的设计视图，将 GridView 控件拖到您的页面上，在 GridView 的智能标记中，选择选择数据源并选择您刚刚创建的页面上的数据源（可能称为 SqlDataSource1，除非您更改了创建时的名称）。点击刷新架构。如果它正常工作，它可能会给您一些确认框，但之后，它应该刷新您的 GridView 并显示数据源中的列。再次单击 GridView 中的智能标记，然后单击启用分页、排序、编辑、删除旁边的复选框（无论您想要什么）。现在保存页面并运行它。您应该看到一个 GridView 能够执行所有这些操作。

对于插入，您需要不同的控件。DetailsView 控件可能是您最好的选择。这些步骤几乎与您对 GridView 所做的相同。

这是我做完所有这些后的源代码：

```
<%@ Page Language="C#" %>

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<script runat="server">
</script>

<html xmlns="http://www.w3.org/1999/xhtml">
<head runat="server">
<title>Untitled Page</title>
</head>
<body>
<form id="form1" runat="server">
<div>
<asp:SqlDataSource ID="SqlDataSource1" runat="server" 
    ConnectionString="<%$ ConnectionStrings:testConnectionString2 %>" 
    DeleteCommand="DELETE FROM `test` WHERE `TestID` = ?TestID" 
    InsertCommand="INSERT INTO `test` (`TestID`, `FirstName`, `LastName`) VALUES (?TestID, ?FirstName, ?LastName)" 
    ProviderName="<%$ ConnectionStrings:testConnectionString2.ProviderName %>" 
    SelectCommand="SELECT * FROM `test`" 
    UpdateCommand="UPDATE `test` SET `FirstName` = ?FirstName, `LastName` = ?LastName WHERE `TestID` = ?TestID">
<DeleteParameters>
    <asp:Parameter Name="TestID" Type="Int32" />
</DeleteParameters>
<UpdateParameters>
    <asp:Parameter Name="FirstName" Type="String" />
    <asp:Parameter Name="LastName" Type="String" />
    <asp:Parameter Name="TestID" Type="Int32" /> 
</UpdateParameters>
<InsertParameters>
    <asp:Parameter Name="TestID" Type="Int32" />
    <asp:Parameter Name="FirstName" Type="String" />
    <asp:Parameter Name="LastName" Type="String" />
</InsertParameters>
</asp:SqlDataSource>
</div>
    <asp:GridView ID="GridView1" runat="server" AllowPaging="True" 
        AllowSorting="True" AutoGenerateColumns="False" 
        DataKeyNames="TestID" DataSourceID="SqlDataSource1">
    <Columns>
        <asp:CommandField ShowDeleteButton="True" ShowEditButton="True" />
        <asp:BoundField DataField="TestID" HeaderText="TestID" ReadOnly="True" SortExpression="TestID" />
        <asp:BoundField DataField="FirstName" HeaderText="FirstName" SortExpression="FirstName" />
        <asp:BoundField DataField="LastName" HeaderText="LastName" SortExpression="LastName" />
    </Columns>
    </asp:GridView>

    <asp:DetailsView ID="DetailsView1" runat="server" AutoGenerateRows="False" DataKeyNames="TestID" 
        DataSourceID="SqlDataSource1" Height="50px" Width="125px">
    <Fields>
        <asp:BoundField DataField="FirstName" HeaderText="FirstName" SortExpression="FirstName" />
        <asp:BoundField DataField="LastName" HeaderText="LastName" SortExpression="LastName" />
        <asp:CommandField ShowDeleteButton="True" ShowEditButton="True" ShowInsertButton="True" />
     </Fields>
    </asp:DetailsView>

</form>
</body>
</html> 
```

所有这一切都假设您按照上述步骤在您的 web.config 文件中为您创建一个连接字符串。因此，您将无法逐字复制此代码并使其正常工作。无论如何，您的 web.config 中都没有连接字符串。

你可以做的还有很多。这个网站上有很多关于使用不同数据控件的精彩文章和视频。部署到生产环境时还需要考虑一些事项。如果有帮助，我使用 GoDaddy 并在上个月写了一篇关于使用 MySql 设置 ASP.NET 成员资格并在 GoDaddy 上托管的文章。我认为那篇文章的第一部分可能会给你一些额外的有用提示，具体取决于你最终想要做什么。

那篇文章在这里：

[http://www.marvinpalmer.com/MarvinPalmer/post/Implement-NET-Membership-and-Roles-using-MySql-Connector-523-on-GoDaddy.aspx](http://www.marvinpalmer.com/MarvinPalmer/post/Implement-NET-Membership-and-Roles-using-MySql-Connector-523-on-GoDaddy.aspx)

检查dis链接你可以肯定地解决问题............

[http://aspnet.4guysfromrolla.com/articles/021203-1.aspx](http://aspnet.4guysfromrolla.com/articles/021203-1.aspx) [无分页]

[http://www.aspnetdatagrid.com/Ex/RowInUpDl.aspx](http://www.aspnetdatagrid.com/Ex/RowInUpDl.aspx) [带分页]

希望这可以帮助。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-20T05:01:56.743

`template field`in是一个`gridview`字段，其中包含您从数据源中的数据库中选择的值之一。

```
<asp:TemplateField HeaderText="FirstName" SortExpression="FirstName">
     <EditItemTemplate>
         <asp:TextBox ID="TextBox1" runat="server" Text='<%# Bind("FirstName") %>'>
         </asp:TextBox>
     </EditItemTemplate>
     <ItemTemplate>
        <asp:Label ID="Label1" runat="server" Text='<%# Bind("FirstName") %>'>
        </asp:Label>
        <asp:Label ID="Label2" runat="server" Text='<%# Bind("LastName") %>'>
        </asp:Label>
    </ItemTemplate>
</asp:TemplateField> 
```

有项目的模板以及编辑项目。
当 gridview 不处于编辑模式时显示项目模板。
编辑项目模板在编辑模式下显示。

更多详细信息：- [http://msdn.microsoft.com/en-us/library/bb288031.aspx](http://msdn.microsoft.com/en-us/library/bb288031.aspx)

# jquery - 使用 jqueryui 对话框，我试图专注于 textarea 但光标从未出现

> ID：16115987
> 
> 赞同：1
> 
> 时间：2013-04-20T02:42:42.963
> 
> 标签：jquery, jquery-ui, focus, textarea, blur

我在用着

*   jQuery：1.9.1
*   jqueryui：1.10.2
*   所有浏览器都显示相同的行为 -

因此，每当有人右键单击 textarea 元素时，我都会启动一个 jquery 对话框。我注意到文本区域在右键单击时会通过活动光标获得焦点，因此我在元素上调用 blur() 以摆脱光标。

工作，没问题。

然后在对话框中，如果用户单击“编辑”，我想将光标重新放在文本区域上。我调用了 show() 和 focus() [参见下面的代码]，但它并没有让焦点恢复。没有错误，除了我想要的对话框关闭之外什么也没有发生（对话框关闭，textarea 应该有一个活动光标但没有）。

下面是代码，非常感谢任何帮助，我已经尝试了几个小时。我确定了我希望工作的代码，但没有“这是问题”

# HTML

这是一个 jqueryui 对话框的元素。当用户右键单击目标元素时，这将显示为对话框的内容

```
<div id="popupDialog">
    <input type="button" id="editRowButton" class="contextmenuButton"
           value="edit">
</div> 
```

在整个页面中，我都有这些文本区域，当右键单击时，将显示 jqueryui 对话框。

```
<textarea id="targetThatWasRightClicked" >some content in the textarea</textarea> 
```

# javascript

```
<!-- This handler is used to clear the dialog if anyone clicks outside the dialog.-->
<!-- Is working fine. -->
$(document).bind('click',function(){
    // if the dialog is open, close it
    if( $("#popupDialog").dialog("isOpen" ) ) {
        closeDialog();
    }
});

function closeDialog() {
    mydialog.target = null;
    $("#popupDialog").dialog("close" ); <!-- invokes the jquery close method. --> 
                                        <!-- This is working fine -->
};

<!-- is used to initialize the jqueryui dialog, also holds a reference to the -->
<!-- object that gets right-clicked as "target". -->
var mydialog = { 
    target : null,

    init : function() {
        $('#popupDialog').dialog({
            modal: true,
            dialogClass: "no-close",
            width:'auto',
            height:'auto',
            resizable: false,
            autoOpen: false
        });
}

<!-- general setup stuff when the $(document).ready(..) function is called. -->
function initSideMenu() {

    $("#editRowButton" ).button();

    $('#editRowButton').click( function() {

        <!-- THIS IS THE PROBLEM: I expect the textarea (the target) to have -->
        <!-- a blinking cursor in it after these next two commands, but it  -->
        <!-- remains unselected. -->
        mydialog.target.show();
        mydialog.target.focus();

        closeDialog();
    });

    mydialog.init();

    $("#targetThatWasRightClicked").on("contextmenu", function(e){

        var target = $(e.target);

        <!-- the right-click focussed on the textarea, so un-focus it so the -->
        <!-- cursor isn't blinking in the textarea. -->
        target.blur();

        <!-- set "target" = the right-clicked element and open a dialog box -->
        mydialog.target = target;
        $('#popupDialog').dialog('open');

        e.preventDefault();  <!-- So the browser's contextmenu doesn't appear. -->
        e.stopPropagation(); <!-- So the document click handler doesn't get called -->
                             <!-- and close the dialog. -->
    });

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-20T03:13:30.770

尝试在焦点之前关闭对话框：

```
 mydialog.target.show();
    closeDialog(); 
    mydialog.target.focus(); 
```

# scala - 生产者-消费者：我应该同步读访问吗

> ID：16115991
> 
> 赞同：0
> 
> 时间：2013-04-20T02:43:57.290
> 
> 标签：scala, synchronization

考虑一个生产者和多个消费者的生产者-消费者问题。消费者等到他们被告知已经产生了价值。生产者写入一个值并通知所有消费者，然后消费者读取该值。最后：消费者和生产者的终止使用屏障同步。该过程重复。

问题：我是否应该提供独占访问（例如同步）以读取消费者的值（或写入生产者？）。我知道显而易见的答案是：“严重吗？不！” 但我只是想确保我没有遗漏任何奇怪的细节。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-20T14:16:07.927

如果您正在构建并发应用程序，我建议您研究 Akka。它提供了很多东西，而且学习起来并不简单，但就并发性和分布而言，它非常全面。

对于您的特定情况，它的数据流变量可能适合您的需求（并使您免于公开同步！）

# java - 没有自动装配的弹簧组件扫描？

> ID：16115994
> 
> 赞同：-1
> 
> 时间：2013-04-20T02:44:27.117
> 
> 标签：java, spring, spring-mvc, autowired

使用组件扫描而不在弹簧上使用自动装配是否有意义？

我喜欢在控制器的 MVC 环境中进行组件扫描的想法，我什至喜欢避免在 xml 上声明所有 DAO、服务……。

但是我不是自动装配的忠实拥护者，所以，是否仍然可以使用 xml 配置文件手动注入所需的 bean，或者这只是无意义的？

更新：使用 @Autowired 而不是通过 XML 显式声明的优势是什么（请不要提供“较少的 xml 配置”作为优势）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-20T03:21:16.450

我会

*   添加`@Component`到实现类，以便为每个实现类创建一个 bean
*   不关联`@Autowired`/`@Resource`与其他类中与这些实现相对应的成员声明，​​以便Spring不能`autowire`它们。
*   定义需要这些组件 bean 的 bean，在 XML 中使用`<bean>`节点和`<property>`元素通过 setter`<constructor-arg>`注入它们或通过构造函数注入它们。

例子：

界面：

```
package com.krovi.compscan;

public interface MyInterface
{
    void method();
} 
```

实现声明为 Spring DI 框架的组件，以为此创建一个 bean：

```
package com.krovi.compscan;

import org.springframework.stereotype.Component;

@Component
public class MyImpl implements MyInterface
{
    public void method()
    {
        System.out.println("Method definition in the implementation");
    }
} 
```

一个典型的客户端，他将使用基于组件的 bean，但通过配置文件，通过构造函数显式注入。

```
package com.krovi.compscan;

import org.springframework.context.support.ClassPathXmlApplicationContext;

public class MyClient
{
    private MyInterface myInterface;

    public MyClient(MyInterface i)
    {
        this.myInterface = i;
    }

    public void clientMethod()
    {
        myInterface.method();
    }

    // Main method to test.    
    public static void main(
        String[] args)
    {
        ClassPathXmlApplicationContext context =
            new ClassPathXmlApplicationContext("classpath:META-INF/compscan.xml");
        MyClient client =
            context.getBean(MyClient.class);
        client.clientMethod();
    }
} 
```

另一个使用基于组件的bean但使用setter通过配置文件显式注入的典型客户端：

```
package com.krovi.compscan;

import org.springframework.context.support.ClassPathXmlApplicationContext;

public class MyAnotherClient
{
    private MyInterface impl;

    protected MyAnotherClient()
    {

    }

    public MyInterface getImpl()
    {
        return impl;
    }

    public void setImpl(
        MyInterface impl)
    {
        this.impl = impl;
    }

    public void clientMethod()
    {
        impl.method();
    }

    public static void main(
        String[] args)
    {
        ClassPathXmlApplicationContext context =
            new ClassPathXmlApplicationContext("classpath:META-INF/compscan.xml");
        MyAnotherClient client =
            context.getBean(MyAnotherClient.class);
        client.clientMethod();
    }
} 
```

豆配置文件：

```
<?xml version="1.0" encoding="UTF-8"?>
<beans 
    xmlns="http://www.springframework.org/schema/beans" 
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xmlns:context="http://www.springframework.org/schema/context"
    xsi:schemaLocation="
        http://www.springframework.org/schema/beans 
        http://www.springframework.org/schema/beans/spring-beans.xsd 
        http://www.springframework.org/schema/context 
        http://www.springframework.org/schema/context/spring-context-3.0.xsd">

    <!-- Component scan to create beans for @Component classes -->
    <context:component-scan base-package="com.krovi.compscan" />

    <!-- Explicit bean declaration for clients to get the 
         @Component classes injected 
    -->
    <bean id="myClient" class="com.krovi.compscan.MyClient">
        <constructor-arg ref="myImpl" />
    </bean>
    <bean id="anotherClient" class="com.krovi.compscan.MyAnotherClient">
        <property name="impl" ref="myImpl" />
    </bean>
</beans> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-20T02:48:37.757

xml 声明优先于注释，因此您不能同时使用两者。

但是，如果您不想使用 DI，为什么还要通过注解来声明组件呢？这是没有意义的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-20T09:29:16.660

它是可修复的，并且取决于您更喜欢声明组件“Spring bean”：

1.  使用组件扫描

2.  使用 XML 编写它

您还可以定义组件之间的关系：

1.  使用@Autowired

2.  在 xml 中使用或

2个动作是不同的，就像在另一个bean的属性中初始化bean和设置bean的引用一样，使用“组件扫描”和“@Autowired”的唯一一点是@Autowired正在使用类型和“组件扫描”不强制生成 bean 的 id 或名称，因此最好将两者一起使用，但如果您想在不自动装配的情况下使用扫描，则必须注意不要使用具有相同类名的 2 个组件，还要注意任何错字编写参考名称。

# data-structures - 列表的向量。我应该使用指针还是值？

> ID：16115995
> 
> 赞同：1
> 
> 时间：2013-04-20T02:44:33.920
> 
> 标签：data-structures, c++11, stl, hashtable

我正在实现使用链解决冲突的数据结构**哈希表。**

因此，作为**基础数据**结构，我需要**列表向量**。
我从 2 个变体中进行选择：

*   `std::vector<std::list<entry> >`
*   `std::vector<std::list<entry>* >`

其中 entry 是包含数据和哈希值的结构体；

**问题：**如果我使用第一个变体（在大输入数据上考虑问题），效率会大大降低吗？

先感谢您！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-20T03:11:38.800

使用指针确实没有任何优势，而且它增加了在销毁向量时需要删除的复杂性。继续使用`vector<list<entry> >`. `list`无论如何都会为元素分配内存，但它对你来说是不可见的。

如果必须调整向量的大小，可能会有性能损失，但 C++11 编译器应该使用移动而不是副本来最小化它。对于学习项目，性能不应该是你首先关心的问题。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-04-20T02:53:40.720

唯一真正的区别是，第一种方法的存储桶/链中的条目将存储在堆栈中，而第二种方法的条目将存储在堆中。对于大型结构，我发现在堆上存储通常更好，但这值得商榷。真的，只要在将条目添加到列表时记得更新条目，就可以了。