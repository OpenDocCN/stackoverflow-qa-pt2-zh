# StackOverflow 问答 14225000-14225999

# ssrs-2008 - 在 ssrs 2008 中合并两个表达式

> ID：14225005
> 
> 赞同：1
> 
> 时间：2013-01-08T22:18:44.440
> 
> 标签：ssrs-2008, reporting-services

合并或组合2表达式的正确方法是什么

`=iif(Fields!XXX.Value="Department",56,0)or iif(Fields!YYY.Value="Company",56,0)`...

尝试了很多方法，但在我得到这个之前出现错误，有没有其他方法可以写这个

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-08T22:24:50.637

尝试

```
=iif(Fields!XXX.Value="Department" or Fields!YYY.Value="Company", 56, 0) 
```

# java - GLSL 结构统一位置返回 -1

> ID：14225006
> 
> 赞同：1
> 
> 时间：2013-01-08T22:18:47.573
> 
> 标签：java, opengl, glsl, lwjgl

我正在尝试创建某种基本的照明系统。我设置了这个结构：

```
struct Light
{
  vec3 position;
  vec4 diffuse;
  vec4 ambient;
  bool enabled;
}; 
```

然后我定义了 4 个禁用的灯：

```
uniform Light light0 = Light(vec3(0.0, 0.0, 0.0), vec4(0.0, 0.0, 0.0, 0.0), vec4(0.0, 0.0, 0.0, 0.0), false);
uniform Light light1 = Light(vec3(0.0, 0.0, 0.0), vec4(0.0, 0.0, 0.0, 0.0), vec4(0.0, 0.0, 0.0, 0.0), false);
uniform Light light2 = Light(vec3(0.0, 0.0, 0.0), vec4(0.0, 0.0, 0.0, 0.0), vec4(0.0, 0.0, 0.0, 0.0), false);
uniform Light light3 = Light(vec3(0.0, 0.0, 0.0), vec4(0.0, 0.0, 0.0, 0.0), vec4(0.0, 0.0, 0.0, 0.0), false); 
```

在我的程序中，我试图获得统一的位置，这样我就可以改变灯光，所以我使用了这段代码。

```
int[][] lightLocs = new int[MAX_LIGHTS][4]; //Position, Diffuse, Ambient, Enabled
for(int i = 0; i < MAX_LIGHTS; i++) { //MAX_LIGHTS is set to 4
    lightLocs[i][0] = GL20.glGetUniformLocation(shaderProgram, "light"+i+".position");
    lightLocs[i][1] = GL20.glGetUniformLocation(shaderProgram, "light"+i+".diffuse");
    lightLocs[i][2] = GL20.glGetUniformLocation(shaderProgram, "light"+i+".ambient");
    lightLocs[i][3] = GL20.glGetUniformLocation(shaderProgram, "light"+i+".enabled");
    //Print locations just for bug testing
    for(int j = 0; j < 4; j++) {
        System.out.print(lightLocs[i][j] + ", ");
    }
    System.out.println();
} 
```

但我得到了一些奇怪的结果。前 3 个灯 (0-2) 的所有 4 个位置都返回 -1。light3 上的位置位置也返回 -1，但最后 3 个值返回 4、5 和 6。4、5 和 6 有意义，因为我在顶点着色器中的灯光之前定义了 4 个制服，但为什么我要其他位置得到-1？我也试过这个：

```
uniform Light light0;
uniform Light light1;
uniform Light light2;
uniform Light light3; 
```

看看它是否会起作用，但是灯光的其余统一位置返回为 -1。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-08T22:27:40.617

着色器代码中未使用的制服通常会被优化掉。这些制服不被认为是“活跃的”，因此位置为 -1。

# ruby-on-rails - 将 Backburner 用于 beanstalk 时，我如何在开发过程中启动工作人员？

> ID：14225009
> 
> 赞同：0
> 
> 时间：2013-01-08T22:18:52.497
> 
> 标签：ruby-on-rails, beanstalkd

我已经阅读了[Backburner 教程](https://github.com/nesquena/backburner/wiki/Backburner-Tutorial)，但它掩盖了工人的确切含义，似乎上帝被用于生产环境，但所有其他示例只是显示正在使用 Backburner.work，它不会异步处理. 因此，当我在开发模式下使用 WEBrick 时，我不知道如何处理队列中的作业。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-09T02:37:21.980

我将更新教程，但处理任务的最简单方法是使用 rake 任务：

```
rake backburner:work 
```

这将在任务进入您的控制台时对其进行处理。如果您有动态队列或只想处理一个队列，您可以在此处指定队列：

```
QUEUES=newsletter-sender,push-message rake backburner:work 
```

这应该在开发中起作用。

# c++ - 在 Linux 上的进程之间传递消息的最快技术？

> ID：14225010
> 
> 赞同：44
> 
> 时间：2013-01-08T22:19:01.307
> 
> 标签：c++, linux, performance, ipc, latency

在 Linux 上，在 C++ 应用程序进程之间发送消息的最快技术是什么？我隐约意识到，桌面上有以下技术：

*   TCP
*   UDP
*   插座
*   管道
*   命名管道
*   内存映射文件

还有更多方法吗？最快的是什么？

* * *

## 回答 #1

> 赞同：49
> 
> 时间：2013-01-08T23:25:03.130

虽然上述所有答案都非常好，但我认为我们必须讨论什么是“最快”[它必须是“最快”还是“足够快”？]

对于 LARGE 消息，毫无疑问，共享内存是一种非常好的技术，并且在很多方面都非常有用。

但是，如果消息很小，则必须提出自己的消息传递协议和通知其他进程有消息的方法是有缺点的。

在这种情况下，管道和命名管道更容易使用 - 它们的行为非常像文件，您只需在发送端写入数据，然后在接收端读取数据。如果发送方写了一些东西，接收方会自动唤醒。如果管道已满，则发送端被阻塞。如果发送方没有更多数据，接收方将自动被阻止。这意味着这可以用相当少的代码行来实现，并且可以很好地保证它每次都可以正常工作。

另一方面，共享内存依赖于其他一些机制来通知另一个线程“你有一个数据包要处理”。是的，如果您要复制大量数据包，它会非常快 - 但如果管道存在巨大差异，我会感到惊讶，真的。主要好处是对方不必将数据从共享内存中复制出来——但它也依赖于有足够的内存来保存所有“正在运行”的消息，或者发送者有能力保留东西.

我不是说“不要使用共享内存”，我只是说没有“一种解决所有问题的‘最好’的解决方案”这样的东西。

澄清一下：我将首先使用管道或命名管道[取决于哪个适合目的]实现一个简单的方法，然后测量它的性能。如果实际复制数据花费大量时间，那么我会考虑使用其他方法。

当然，另一个考虑应该是“我们是否会使用两台独立的机器[或同一系统上的两台虚拟机]来解决这个问题。在这种情况下，网络解决方案是更好的选择——即使它不是最快的, 我在工作的机器上运行了一个本地 TCP 堆栈以进行基准测试，并获得了一些 20-30Gbit/s (2-3GB/s) 的持续流量。同一进程中的原始 memcpy 大约为 50-100GBit/s （5-10GB/s）（除非块大小非常小并且适合 L1 缓存）。我没有测量标准管道，但我希望这大致在这两个数字的中间。[这是数字这对于许多不同的中型相当现代的 PC 来说是正确的 - 显然，在 ARM、MIPS 或其他嵌入式控制器上，所有这些方法的数量都较低]

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2013-01-08T22:24:34.827

我建议也看看这个：[How to use shared memory with Linux in C](https://stackoverflow.com/q/5656530/1175253)。

基本上，在单台机器上进行 IPC 时，我会放弃 TCP 和 UDP 等网络协议。这些具有分组开销并且绑定到更多资源（例如端口、环回接口）。

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2015-11-06T14:37:12.623

英国剑桥大学的 NetOS 系统研究小组已经完成了一些（开源）IPC 基准测试。

源代码位于[https://github.com/avsm/ipc-bench](https://github.com/avsm/ipc-bench)。

项目页面：[http](http://www.cl.cam.ac.uk/research/srg/netos/projects/ipc-bench/) ://www.cl.cam.ac.uk/research/srg/netos/projects/ipc-bench/ 。

结果：[http ://www.cl.cam.ac.uk/research/srg/netos/projects/ipc-bench/results.html](http://www.cl.cam.ac.uk/research/srg/netos/projects/ipc-bench/results.html)

本研究已使用上述结果发表：http: [//anil.recoil.org/papers/drafts/2012-usenix-ipc-draft1.pdf](http://anil.recoil.org/papers/drafts/2012-usenix-ipc-draft1.pdf)

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2013-01-08T22:24:32.253

检查 CMA 和 kdbus： [https ://lwn.net/Articles/466304/](https://lwn.net/Articles/466304/)

我认为这些天最快的东西是基于 AIO。 [http://www.kegel.com/c10k.html](http://www.kegel.com/c10k.html)

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2013-01-09T08:35:16.253

当你用 C++ 标记这个问题时，我推荐[Boost.Interprocess](http://www.boost.org/libs/interprocess/)：

> 共享内存是最快的进程间通信机制。操作系统将一个内存段映射到多个进程的地址空间中，这样多个进程就可以在该内存段中读写，而无需调用操作系统函数。但是，我们需要在读取和写入共享内存的进程之间进行某种同步。
> 
> [来源](http://www.boost.org/doc/libs/1_52_0/doc/html/interprocess/sharedmemorybetweenprocesses.html#interprocess.sharedmemorybetweenprocesses.sharedmemory.shared_memory_what_is)

我发现的一个警告是[同步原语的可移植性限制](http://article.gmane.org/gmane.comp.lib.boost.devel/237676)。例如，OS X 和 Windows 都没有进程间条件变量的本机实现，因此它使用自旋锁来模拟它们。

现在，如果您使用支持 POSIX 进程共享原语的 *nix，则不会有任何问题。

当涉及大量数据时，具有同步的共享内存是一种很好的方法。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2013-01-08T22:24:10.960

[好吧，您可以使用linux shared memory](http://www.cs.cf.ac.uk/Dave/C/node27.html) aka在您的进程之间简单地拥有一个共享内存段`SHM`。

它非常易于使用，请查看链接以获取一些示例。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-07-28T12:51:17.087

[posix 消息队列](http://lxr.linux.no/#linux+v2.6.37/ipc/mqueue.c)非常快，但它们有一些限制

# applescript - 使用applescript在Excel中选择多个列

> ID：14225012
> 
> 赞同：0
> 
> 时间：2013-01-08T22:19:02.557
> 
> 标签：applescript

我正在尝试自学 AppleScript 一些我真正需要 AppleScript 的东西。

（我知道重复的东西必须有捷径，但我找不到关于如何做到这一点的好教程，所以我做了很长的路要走。）

我被困在如何一次选择多个列（或行）上。我想选择填充的列并对它们进行排序，但我不能，因为我不知道如何选择多个列。任何指导将不胜感激。

我希望脚本做的是：

*   打开一个 Excel 文件
*   删除第 1-32 行
*   删除第 4-7 列
*   删除新列 7
*   选择第 1-5 列
*   对第 1-5 列进行排序，首先按任务，其次按样本
*   删除包含ENDO的行
*   保存存档

这是我到目前为止所拥有的：

```
tell application "Microsoft Excel"
activate
open (choose file)
end tell

tell application "Microsoft Excel"
    delete row 1
    delete row 1
    delete row 1
    delete row 1
    delete row 1
    delete row 1
    delete row 1
    delete row 1
    delete row 1
    delete row 1
    delete row 1
    delete row 1
    delete row 1
    delete row 1
    delete row 1
    delete row 1
    delete row 1
    delete row 1
    delete row 1
    delete row 1
    delete row 1
    delete row 1
    delete row 1
    delete row 1
    delete row 1
    delete row 1
    delete row 1
    delete row 1
    delete row 1
    delete row 1
    delete row 1
    delete row 1
    delete column 4
    delete column 4
    delete column 4
    delete column 4
    delete column 7
    select row 1
    select row 2
end tell 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-08T23:06:20.957

这应该可以帮助您入门：[Excel 2004 AppleScript 参考](http://download.microsoft.com/download/3/A/7/3A70FB4B-0C6A-43E3-AAB7-AC9166B25632/Excel2004AppleScriptRef.pdf)

```
tell application "Microsoft Excel"
    tell active sheet of active workbook
        set myRows to range "1:27"
        delete myRows
        set myColumn to range "D:G"
        delete myColumn
    end tell
end tell 
```

# c# - C# Winforms 和命令行批处理文件

> ID：14225020
> 
> 赞同：4
> 
> 时间：2013-01-08T22:19:45.247
> 
> 标签：c#, winforms, batch-file

我从我的 c#winforms 应用程序运行这个：

```
string ExecutableFilePath = @"Scripts.bat";
string Arguments = @"";

if (File.Exists(ExecutableFilePath )) {
    System.Diagnostics.Process.Start(ExecutableFilePath , Arguments);
} 
```

当它运行时，我会看到 cmd 窗口，直到它完成。

有没有办法让它运行而不向用户显示？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-01-08T22:24:42.650

您应该使用[ProcessStartInfo](http://msdn.microsoft.com/en-us/library/vstudio/system.diagnostics.processstartinfo%28v=vs.100%29.aspx)类并设置以下属性

```
 string ExecutableFilePath = @"Scripts.bat";
  string Arguments = @"";

  if (File.Exists(ExecutableFilePath ))
  {
       ProcessStartInfo psi = new ProcessStartInfo(ExecutableFilePath , Arguments);
       psi.UseShellExecute = false;
       psi.CreateNoWindow = true;
       Process.Start(psi);
  } 
```

# jquery-mobile - changePage “跳”回旧页面

> ID：14225021
> 
> 赞同：20
> 
> 时间：2013-01-08T22:19:46.777
> 
> 标签：jquery-mobile, webkit, css-transitions, android-browser

我对 jQuery Mobile 应用程序有一个大问题：我正在使用自定义函数（它们由 onClick 触发）用 currentPage 切换页面。

它仅发生在使用集成浏览器更改（由于 ajax 请求）的站点上的 Android 设备上。iOS 和 Chrome 运行良好。

单击元素后，动画开始，但在结束之前，它切换回旧页面。半秒后，它切换回新的。

我在这里制作了一个关于这个错误的电影：[http ://www.youtube.com/watch?v=sXxvVUxniNg](http://www.youtube.com/watch?v=sXxvVUxniNg)

非常感谢

代码（CoffeeScript）：

```
class Guide

    @categoriesLoaded = false

    @loadSearch: ->

        $.mobile.changePage $("#guide"),
            transition: 'slide'
            changeHash: false

        if !@categoriesLoaded

            @categoriesLoaded = true

            GuideApi.getCategories (data) ->
                output = Mustache.render $("#tmpl-guide-categories-select").html(), 
                    categories: data

                $("#guide-search-category").append output

                $("#guide-search-category").val($("#guide-search-category option:first").val());

window.WgSwitchGuide = ->
        Guide.loadSearch 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-07-10T03:57:27.863

我遇到了同样的问题。我尝试了一切，最终以解决方案结束。我发现错误主要在浏览器中。所以我将pushStateEnabled的配置设置为false。我通过执行以下操作来添加此脚本。

```
<script type="text/javascript">
$(document).bind("mobileinit", function(){
$.mobile.pushStateEnabled = false;
});
</script> 
```

它应该在调用 jquery-mobile 脚本之前添加，有关更多信息，您可以在[JQuery 描述中看到它](http://jquerymobile.com/demos/1.1.1/docs/pages/page-navmodel.html)

它解决了不再跳回的问题。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-02-24T16:45:04.677

您会尝试在第一页的点击事件中添加事件 stopPropagation 和 preventDefault 方法吗？这样就不会触发点击事件的默认动作。此外，stopPropagation 防止事件在 DOM 树中冒泡，防止任何父处理程序收到事件通知。

*   `event.stopPropagation();`
*   `event.preventDefault();`

例子：

```
$("p").click(function(event){
    event.stopPropagation();
    event.preventDefault();
    // change page
}); 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2013-01-09T07:17:45.340

我在android和ios上都遇到了完全相同的问题。对我来说，它发生在*繁重的*页面上，即具有复杂元素的页面等。看起来你正在使用“幻灯片”过渡，这也是我正在使用的。取出这些页面的页面转换（即 $.mobile.changePage("page.html", { transition: "none" })）为我解决了这个问题。希望这可以帮助。

如果要保留过渡，可以尝试在显示前一页时先使用 $.mobile.loadPage 预加载页面，然后显示过渡。我自己也在探索这条路线，但它可能值得一试。

编辑：好的 - 我探索了最后一个建议，这似乎不起作用。将坚持第一个选项。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-11-25T22:26:37.290

在尝试了数周来寻找解决方案之后，我最终修改了 JQM 库以一个接一个地禁用页面转换。这不是一个好的解决方案，但这是我唯一可以开始工作的事情。

我让页面在 $.mobile.changePage 和锚链接上跳回。我使用了幻灯片过渡，但删除它并没有解决问题。将 pushStateEnabled 设置为 false 也不起作用。所有设备和浏览器都发生了跳跃（无论如何我测试过）。

所以这就是我对 JQM 库 (v1.3.2) 所做的。

在定义 $.mobile.changePage 函数之前，我添加了：

```
var justChangedPage = false; 
```

然后在函数中有一行：

```
if ( pbcEvent.isDefaultPrevented()) {
    return;
} 
```

我改为：

```
if ( pbcEvent.isDefaultPrevented() || justChangedPage) {
    return;
} 
```

然后在 $.mobile.changePage 函数的这一部分之后：

```
if ( toPage[ 0 ] === $.mobile.firstPage[ 0 ] && !settings.dataUrl ) {
    settings.dataUrl = documentUrl.hrefNoHash;
} 
```

我补充说：

```
justChangedPage = true;
setTimeout(function() {
    justChangedPage = false;
}, 500); 
```

（把它放在函数的前面是行不通的——所有这些东西在一个页面转换中执行了不止一次。半秒似乎是阻止页面跳转的最小超时。）

我希望这对某人有帮助，即使它是一个黑客......

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-02-27T09:10:19.577

你的 JQM 和 Android 版本是多少？

我不确定我是否理解正确。我认为过渡闪烁可能来自以下假设。

1.  繁重的页面 DOM 过渡。
2.  在 css 文件的某处使用“translate3d”。
3.  不使用“硬件加速”功能。通过将此行添加到您的**AndroidManifest.xml**中启用`<application>`

> 安卓：硬件加速=“真”

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2015-07-28T04:29:48.737

我遇到了完全相同的行为，似乎很少有人遇到同样的问题。起初我以为是 jQuery 移动库引起的。后来，我设法找到问题出在哪里，这是我自己的代码中的一个错误。我做了一个演示来解释这个问题。

[http://jsfiddle.net/pengyanb/6zvpgd4p/10/](http://jsfiddle.net/pengyanb/6zvpgd4p/10/)

希望这可以为遇到同样问题的人提供提示。

```
$(document).on('pagebeforeshow', '#page2', function(){
    console.log('Page2 before show');
    var htmlGeneratedOnTheFly = '<ul data-role="listview" data-inset="true">';
    for(var i=0; i<4; i++)
    {
        htmlGeneratedOnTheFly += '<li><a>Random html element</a></li><li data-role="list-divider"></li>';
    }
    htmlGeneratedOnTheFly += '</div>';
    $('#page2UiContent').empty();
    $('#page2UiContent').append(htmlGeneratedOnTheFly);
    $('#page2UiContent').trigger('create');

    //////////////////////////////////////////////////
    //The following section is where the bug is generated. 
    //Each on "page2 before show event" will add a OK Button click handler. 
    //The handlers never get cleared.
    //More and more handler is added to the Page2 OK button as pages going back and forth.
    //Open the browser's console window to see multiple "Page 2 OK Button clicked!!!" lines on one button click. 
    //To fix the bug, move the following section out of the $(document).on('pagebeforeshow', '#page2', function(){});
    //////////////////////////////////////////////////
    $('#page2OkButton').click(function(){
        console.log("Page 2 OK Button clicked!!!");
        $.mobile.changePage('#page1', {transition:"flip"});
    });
    //////////////////////////////////////////////
    //////////////////////////////////////////////
});
```

```
<link href="http://code.jquery.com/mobile/1.4.5/jquery.mobile-1.4.5.css" rel="stylesheet"/>
<script src="http://code.jquery.com/mobile/1.4.5/jquery.mobile-1.4.5.js"></script>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
<div data-role="page" id="page1" data-theme="a">
    <div data-role="header" data-position="fixed">
        <h5>Demo Page 1</h5>
    </div>
    <div data-role="main" class="ui-content">
        <h2>jQuery mobile changepage jumps back to old page demo</h2>
        <p>Click "Go To Page 2" button to go to page2</p>
        <p>On Page2 click Ok Button to come back to page1</p>
        <p>Keeping going back forth between two pages for few times.</p>
        <p>Eventually, you will find that clicked on "Go To Page2" button to flip to Page2 but it soon jumps back to page1 automatically. </p>
        <h2>Please read the comments in the javascript for explaination</h2>
        <a href="#page2" data-transition="flip" class="ui-btn ui-icon-carat-r ui-btn-icon-right">Go To Page 2</a>
    </div>
</div>

<div data-role="page" id="page2" data-theme="a">
    <div data-role="header" data-position="fixed">
        <h5>Demo Page 2</h5>
    </div>
    <div id="page2UiContent" data-role="main" class="ui-content">
    </div>
    <div data-role="footer" data-position="fixed" style="text-align:center;">
        <div data-role="navbar">
            <ul>
                <li><a id="page2OkButton" class="ui-btn ui-icon-check ui-btn-icon-left">OK</a></li>
            </ul>
        </div>
    </div>
</div>
```

# ios - 打开 Google 地图应用 iOS 6（网络应用）

> ID：14225022
> 
> 赞同：1
> 
> 时间：2013-01-08T22:19:48.180
> 
> 标签：ios, html, google-maps, protocols

是否有任何协议可用于在（现在可下载的）谷歌地图中打开地址？这不是本机应用程序，只是 Safari 的网络应用程序/网站（网络剪辑）。Google 是否提供任何此类协议以在非本地应用程序上使用？我知道如何为 Apple 地图应用程序（使用 maps://）完成此操作，但是 Google 是否为他们的 Google 地图应用程序提供了任何方法来执行此操作？

提前非常感谢！！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-08T22:22:11.957

我相信是这样，URL 将是 (comgooglemaps://...)

有关更多信息，请参阅本文 - [https://developers.google.com/maps/documentation/ios/urlscheme](https://developers.google.com/maps/documentation/ios/urlscheme)

# mysql - 合并 MySQL 数据表是最佳实践吗？

> ID：14225023
> 
> 赞同：0
> 
> 时间：2013-01-08T22:19:49.147
> 
> 标签：mysql, database, database-design

我正在考虑更改数据库方案以减少表的数量。我有几个表包含不同但相似的数据，我想知道这样保留它是否是最佳实践，或者将它们组合起来是否会有并发症。

例如，假设我有以下两个表：

```
Table `status`

`status_id` | `status_text`
---------------------------
1           | Open
2           | Closed
3           | On Hold

Table `type`

`type_id`   | `type_text`
---------------------------
1           | Regular Work
2           | Advanced Work
3           | Warranty Work 
```

将这些组合成一个表格是否有利，如下所示？

```
Table `text`

`id`        | `type`        | `text`
-------------------------------------------
1           | 1             | Open
2           | 1             | Closed
3           | 1             | On Hold
1           | 2             | Regular Work
2           | 2             | Advanced Work
3           | 2             | Warranty Work 
```

该`type`列将与表示数据集类型的 PHP 常量相关联。

我目前可能有 6 个表格，其中包含此确切方案中的数据。只是让我觉得它们是如此相似，而且每个只有 2-5 行。我真的很想像上面那样将它们结合起来，但不确定在此过程中是否会出现并发症，或者它是否违反了最佳实践。

我确实意识到该`id`列会发生冲突并且不会成为主键的候选者，但它将是一个唯一键以及`type`防止冲突。我不担心 auto_increment，因为这些表是手动管理的。

还要记住的另一件事是这些表涉及多个 JOINS。除了在 ON 子句中再添加一个条件之外，我认为它不会使 JOIN 变得更加复杂。

如果这是一个重复的问题，我深表歉意，这似乎是一个很难查找的主题，因为我提出的不是关于选择数据的常见问题，而是方案。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-08T22:28:07.107

不，这不行。您将在正确的数据库设计/规范化方面倒退，并不必要地混淆您的数据。

当然你*可以*做到这一点，但你会在将来的某个时候后悔这样做。你真的想被问到这样的问题：“嘿 Demonslay335，这个工作类型在文本类型表中是什么文本类型？你能帮我打出来吗？Typey-type type type。”

说一个词足够多次会将其变成胡言乱语，就像对您的数据进行元类型化一样。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-08T23:13:15.667

如果你有不同的约束，你应该使用单独的表，即使数据“看起来”相似。

例如，如果查找表是分开的，您可以非常自然地为不同的引用表定义 FOREIGN KEY。

如果你把所有东西都放在同一张桌子上，同样的事情会更难做到。纯粹的声明方式是`type`沿 FK 迁移，然后在引用表中进行 CHECK 以确保正确的类型。不幸的是，MySQL 不强制执行 CHECK，因此您需要通过触发器或（上帝保佑）应用程序逻辑强制执行正确的类型。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-08T22:28:30.880

有利有弊，通常归结为个人喜好。我个人更喜欢多个不同的查找表（因为每个查找表对应于我的域中的不同实体定义，尽管它们由巧合相似的原始类型组成）。由于您陈述的原因，其他人有时更喜欢单个“超级查找”表。

我经常看到的一种方法是有这样的东西：

```
LookUp
----------
ID
LookUpTypeID
Value
DisplayText
etc.

LookUpType
----------
ID
Name 
```

这提供了一种将查找值组织到单个结构中的相当简单的方法。而且，如果您发现自己想要分离类型以“模仿”不同的表（例如，如果像我这样的开发人员加入您的团队并制造了很多噪音），您始终可以根据类型创建视图并使用查询中的那些。

多个小桌子本质上并没有错。如果它们包含的数据真正*意味着*不同的东西，那么我认为应该将其分开。域中实体的概念意义*远比*组成它们的数据类型重要得多。

多个小表对数据库引擎影响不大。它非常优化，您不会通过组合表格来做任何事情。事实上，您可能会发现您的查询随着时间的推移变得更加迟钝。从数据库中查询的数据的含义开始被表中的实现细节所掩盖。您可以通过添加视图以再次在逻辑上分离数据来*缓解*这种情况，但是如果您发现自己需要这样做，那么为什么首先将其组合起来呢？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-08T23:53:24.903

我看不出有任何理由将这些表合并为一张表。

我会考虑的一件事是使用[枚举](http://dev.mysql.com/doc/refman/5.5/en/enum.html)列。如果您有作为外键引用的列，`status`则将它们设为枚举。然后，您可以完全省去桌子。这导致更简单的模式。然而，它有一些弱点（有些人甚至称它为[邪恶](http://komlenic.com/244/8-reasons-why-mysqls-enum-data-type-is-evil/)）；例如，如果您在多个地方使用相同的枚举，则无法保证所有定义都相同，并且随着数据库的发展，它们存在不同步的风险。尽管如此，我们还是在我们的模式中大量使用它们，并没有真正感受到任何痛苦。

# javascript - 如何获得这种网页效果

> ID：14225026
> 
> 赞同：0
> 
> 时间：2013-01-08T22:19:52.813
> 
> 标签：javascript, html, css

![在此处输入图像描述](../Images/d8e8de60c543844a879fbe7b52c1d26e.png)

1.  小弹出窗口出现在原始页面的中间。

2.  如果没有弹出窗口，原始页面将被灰色阴影覆盖。

3.  下面的原始页面仍然可以上下滚动。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-08T22:25:54.123

按着这些次序：

1) 创建这个 CSS 规则：

```
.overlay {
  width: 100%;
  height: 100%;
  position: fixed;
  top: 0;
  left: 0;
  opacity: 0.5;
  background: #666;
  filter: alpha(opacity=50); /* opacity for IE browsers */ 
} 
```

2）将此代码添加到您的jQuery：

```
$("body").prepend("<div class='overlay'></div>"); 
```

3）完成后，像这样删除它：

```
$(".overlay").remove(); 
```

没有对此进行测试，但它应该可以工作（可能进行非常小的修改）。这是一种方法，如果您更喜欢自己做的话。但是，您可以使用现有的解决方案，例如 Twitter 的 Bootstrap 库，这很酷，我推荐它。

[http://twitter.github.com/bootstrap/](http://twitter.github.com/bootstrap/ "引导程序")

问候。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-08T22:21:57.473

您可以使用 JQueryUI 对话框小部件[http://jqueryui.com/dialog/#modal](http://jqueryui.com/dialog/#modal)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-01-08T22:32:29.413

这很容易通过一些简单的 CSS 来实现......

叠加层（灰色背景）固定到位并覆盖以下所有内容：

```
#overlay {
    display: none;
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background-color: #000;
    opacity: 0;
    filter: alpha(opacity=0);
    z-index: 2; // above content
} 
```

“对话框”本身的风格相似，但更小：

```
#dialog {
    display: none;
    position: fixed;
    width: 500px;
    height: 250px;
    background-color: #fff;
    z-index: 3; // above 'overlay'
} 
```

和属性可以用简单的 JavaScript 计算`top`，`left`这样对话框就可以定位在浏览器的中心：

```
positionDialog = function() {
    if (typeof window.innerHeight != 'undefined') {
        dialog.top = parseInt(window.innerHeight / 2) - dialog.height;
        dialog.left = parseInt(window.innerWidth / 2) - dialog.height;
    }
} 
```

并且在窗口调整大小时：

```
$(window).resize(function() {
    positionDialog();
} 
```

注意 CSS 如何将这些`DIV`s 设置为`display: none`. 它们在被调用之前是隐藏的，这是通过将它们设置为 来完成的`display: block`。

这些天来，我发现依靠 jQuery UI 出色的[对话框小部件](http://jqueryui.com/dialog/)要简单得多，也更加健壮。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-01-08T22:21:32.713

它被称为灯箱。有一种方法可以只使用 CSS：

[http://www.emanueleferonato.com/2007/08/22/create-a-lightbox-effect-only-with-css-no-javascript-needed/](http://www.emanueleferonato.com/2007/08/22/create-a-lightbox-effect-only-with-css-no-javascript-needed/)

使背景变暗的关键是`opacity`您覆盖背景的框的 CSS 属性，您可以设置黑色背景并使用此 CSS 实现透明度：

```
-moz-opacity: 0.8;
opacity:.80; 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-01-08T22:24:01.163

您可以查看 Twitter Bootstrap 中包含的模式：http: [//twitter.github.com/bootstrap/javascript.html#modals](http://twitter.github.com/bootstrap/javascript.html#modals)

# c# - 是否有等效的 DependencyObjectCollection 对于 WPF .NET4.0？

> ID：14225028
> 
> 赞同：6
> 
> 时间：2013-01-08T22:19:55.413
> 
> 标签：c#, wpf, silverlight, xaml

该类允许将数据上下文从集合传播到其成员。但这仅适用于 SilverLight。

更多信息`DepedencyObjectCollection`可以从这篇[文章](https://stackoverflow.com/questions/2797717/binding-to-a-collection-of-dependencyobjects-in-silverlight-4)中找到。

如果不存在等价物，创建一个所需的必要步骤是什么？

我观察了`RowDefinitionCollection`课堂上的欲望行为。但我无法弄清楚它的实现。

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-09T14:20:39.920

最简洁的答案是不。

但我不再认为它是正确的实现方式。我最终使用了一个 FrameworkElement 集合并将它们添加到自定义控件的 LogicalChildren 中。通过这样做，DataContext 自然地传递给 FrameworkElement，一切都按预期工作。

似乎这就是在 .NET 4.0 中实现 RowDefinition 类的方式。但是，RowDefinition 的 Silverlight 版本是直接从 DependencyObject 派生的。MSDN 文档默认显示 Silverlight 文档，并误导我使用较旧且不正确的方法。

# c++ - 如果类具有基于模板参数的成员，我可以自定义吗？

> ID：14225032
> 
> 赞同：2
> 
> 时间：2013-01-08T22:20:06.990
> 
> 标签：c++, templates

我可以有一个有或没有基于模板的成员的类吗？虚构代码：

```
template <typename HasBazMember=true>
class Foo {
  int bar;

  ConditionallyHaveMember<int, HasBazMember> baz;
}; 
```

所以在上面我希望 Foo 有成员“baz”而 Foo 没有。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-08T22:27:51.643

C++11 中的解决方案，无需专业：

```
class empty {};

template <typename T>
struct wrap { T wrapped_member; };

template <bool HasBazMember=true>
class Foo : private std::conditional<HasBazMember, wrap<int>, empty>::type {
public:
  int bar;

  int& baz() {
    static_assert(HasBazMember, "try using baz without HasBaz");
    return static_cast<wrap<int>&>(*this).wrapped_member;
  }
};

int main()
{
  Foo<true> t;
  t.baz() = 5;

  Foo<false> f;
  f.baz() = 5; // ERROR
} 
```

请注意，感谢 EBO，如果`HasBazMember=false`.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-08T22:22:27.803

是的，你可以，但你必须专攻整个班级。例子：

```
template< bool HasBazMember = true >
class Foo {
  int bar;
  int baz;
};

template<>
class Foo< false > {
  int bar;
}; 
```

如果您可以分离逻辑，您可以将这些成员放在一个基类中，这样您就不需要为整个类复制代码。例如，

```
template< bool HasBazMember >
class FooBase
{
protected:
   int baz;
};

template<>
class FooBase< false >
{
    // empty class
    // the Empty Base Optimization will make this take no space when used as a base class
};

template< bool HasBazMember = true >
class Foo : FooBase< HasBazMember >
{
    int bar;
}; 
```

或使用[*Boost.CompressedPair*](http://www.boost.org/doc/libs/1_52_0/libs/utility/compressed_pair.htm)：

```
struct empty {};

template< bool HasBazMember = true >
class Foo
{
    boost::compressed_pair<
        int
      , typename std::conditional< HasBazMember, int, empty >::type
    > bar_and_maybe_baz_too;
}; 
```

# qml - QML：按下鼠标区域并悬停

> ID：14225033
> 
> 赞同：5
> 
> 时间：2013-01-08T22:20:43.027
> 
> 标签：qml

对于我正在开发的应用程序，我绝对需要一件小事：我必须能够将一个对象拖到另一个对象上，并且至少其中一个应该注意到它们是相交的。所以，我的问题是其中一项必须接受 onEntered 信号，即使鼠标在外面按下。

例如：

```
import QtQuick 1.0

Rectangle{
    id: base
    width: 500
    height: 500
    MouseArea{ //Even without this mousearea I don't get what i want.
        anchors.fill: parent
        //onPressed:{console.log("big")}
    }

    Rectangle{
       id: t
       width: 100
       height: 100
       color: "red"
       MouseArea{
          anchors.fill: parent
          hoverEnabled: true
          onPressed:{console.log("little-press")}
          onEntered:{console.log("little-enter")}
          drag.target: t
       }
     }
} 
```

我想要的是在红色方块外按下鼠标按钮，然后在不释放按钮的情况下移动它。当鼠标经过红色矩形时，我希望发出 onEntered 信号。我不明白为什么不发出它，因为 onEntered 应该只关心鼠标区域内的鼠标，而不是按钮。

知道怎么做吗？

非常感谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-09T17:40:41.083

您的代码不起作用，因为此时一个鼠标区域将位于另一个鼠标区域之上，鼠标事件将仅由位于顶部的鼠标区域进行（直到您修改了窃取属性等）。因此，您的底部矩形的属性（如悬停等）将不起作用，因为所有这些事件都将被顶部矩形捕获。

而是试试这个：

```
import QtQuick 1.0

Rectangle
{
    id: topParent
    width: 500
    height: 500
    color: "grey"

    Rectangle
    {
        id: redRectangle
        color: "red"
        width:  80
        height: 80

        onXChanged:
        {
            if(   redRectangle.x  > greenRectangle.x - redRectangle.width
                  && redRectangle.x  < greenRectangle.x + greenRectangle.width
                  && redRectangle.y  > greenRectangle.y - redRectangle.height
                  && redRectangle.y  < greenRectangle.y + greenRectangle.height

               )

            {
                console.log ( "Red Over Green" )
            }
        }

        MouseArea
        {
          anchors.fill: parent
          drag.target: redRectangle
          drag.axis: Drag.XandYAxis
          drag.minimumX: 0
          drag.maximumX: topParent.width
          drag.minimumY: 0
          drag.maximumY: topParent.height
          onPressed: redRectangle.z = greenRectangle.z + 1
        }
    }

    Rectangle
    {
        id: greenRectangle
        color: "green"
        width: 180
        height: 180

        onXChanged:
        {
            if(   greenRectangle.x  > redRectangle.x - greenRectangle.width
                  && greenRectangle.x  < redRectangle.x + redRectangle.width
                  && greenRectangle.y  > redRectangle.y - greenRectangle.height
                  && greenRectangle.y  < redRectangle.y + redRectangle.height

               )

            {
                console.log ( "Green Over Red" )
            }
        }

        MouseArea
        {
          anchors.fill: parent
          drag.target: greenRectangle
          drag.axis: Drag.XandYAxis
          drag.minimumX: 0
          drag.maximumX: topParent.width
          drag.minimumY: 0
          drag.maximumY: topParent.height
          onPressed: greenRectangle.z = redRectangle.z + 1
        }
    }
} 
```

在我打印消息的地方，您也可以发出信号。

# ruby-on-rails - Postgresql 适配器（pg）：无法连接到服务器

> ID：14225038
> 
> 赞同：66
> 
> 时间：2013-01-08T22:20:57.757
> 
> 标签：ruby-on-rails, postgresql, rails-postgresql, pg

每次运行我的 Rails 应用程序时都会出现此错误（它**无法连接到我的本地 Postgresql**）

```
/Users/leonardo/.rvm/gems/ruby-1.9.3-p362/gems/activerecord-3.2.11/lib/
active_record/connection_adapters/postgresql_adapter.rb:1208:in `initialize': 
could not connect to server: No such file or directory (PG::Error)
   Is the server running locally and accepting
connections on Unix domain socket "/var/pgsql_socket/.s.PGSQL.5432"? 
```

我正在使用[**Postgres.app**](http://postgresapp.com/)它运行正常。

如果我跑

```
$ psql 
```

我可以正确登录到 Postgresql 控制台。

```
$ which psql
 /Applications/Postgres.app/Contents/MacOS/bin/psql 
```

***宝石文件***

```
source 'https://rubygems.org'
ruby "1.9.3"

gem 'rails', '3.2.11'
gem "pg" 
```

**数据库.yml**

```
development:
  adapter: postgresql
  encoding: unicode
  username: leonardo
  password: 
  database: zapping
  port: 5432 
```

**Postgresql**（控制台）

```
$ psql
leonardo=# \l 
```

![在此处输入图像描述](../Images/1e4da973a6923be2f7057ca407ce45ff.png)

* * *

## 回答 #1

> 赞同：137
> 
> 时间：2013-01-08T22:40:02.487

尝试添加`host: localhost`到您的 database.yml。（基于：[https](https://stackoverflow.com/a/10793186/919641) ://stackoverflow.com/a/10793186/919641 ）

* * *

## 回答 #2

> 赞同：26
> 
> 时间：2013-01-09T03:12:13.030

您的`Pg`gem 是针对 Mac OS X 中预安装的 PostgreSQL libpq 编译的，并且您正在使用`psql`您在较新版本中安装的那个，反之亦然。

这可以通过指定 TCP/IP 连接来解决，通过添加`localhost`to `database.yml`，但最好针对您实际运行的服务器编译`Pg`gem 。`libpq`为此，您应该能够在编译之前将`PATH`环境变量设置为正确的文件夹。`pg_config`在您的情况下，这将在`Postgres.app`.

* * *

## 回答 #3

> 赞同：25
> 
> 时间：2017-06-25T00:06:08.673

如果添加后仍然无效`host: localhost`，请删除`postmaster.pid`

`rm /usr/local/var/postgres/postmaster.pid`

* * *

## 回答 #4

> 赞同：11
> 
> 时间：2013-01-08T22:35:56.083

你应该添加`host: localhost`到你的数据库配置...

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2013-07-19T12:19:52.700

我在 Mac 上遇到了同样的问题。原来我在我的路径上的 psql 工作不正常。尝试通过键入以下命令启动 psql：

```
~/projects/some_project/project-rails$ psql
  psql: could not connect to server: No such file or directory
Is the server running locally and accepting
connections on Unix domain socket "/var/pgsql_socket/.s.PGSQL.5432"? 
```

如果您看到这一点，则表明您路径上的 psql 二进制文件正在尝试使用套接字连接并且无法这样做（无论出于何种原因）。由于我已经下载了[pgadmin](http://www.pgadmin.org)并且连接正常，我知道这不是服务器的问题。

*通过将正确版本的 pgsql 添加到我的 PATH 来*修复它：**

 *```
export PATH=/Applications/Postgres.app/Contents/MacOS/bin:$PATH 
```

现在 psql（和 rails）很高兴！

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2017-11-20T16:03:40.927

我有这个问题。这里的一条评论帮助我解决了这个问题。

> 谢谢，这个答案帮助我解决了它。我采取的步骤很简单：1）gem卸载pg，2）捆绑安装，完成。– haslo 2013 年 12 月 3 日 20:27

```
gem uninstall pg
bundle install 
```

* * *

## 回答 #7

> 赞同：6
> 
> 时间：2018-06-12T14:03:34.047

由于这是出现在我的搜索结果中的第一篇文章，因此我决定为此发布更新的修复程序。由于上述建议都不适合我。

```
brew postgresql-upgrade-database 
```

它升级了 postgresql 数据并移动了我的旧版本。我在 9.6 而不是 10.4

[在这里](https://dba.stackexchange.com/questions/75214/postgresql-not-running-on-mac)找到了解决方案

* * *

## 回答 #8

> 赞同：6
> 
> 时间：2016-11-02T15:06:18.243

我有同样的问题。你必须实际运行/启动 postgres。Postgres 最近一定已经停止在我的计算机上运行，​​所以我必须通过启动 postgres 服务器来确保它正在运行

```
postgres -D /usr/local/var/postgres 
```

然后以下命令（导致我遇到与您相同的错误）都起作用了：

```
bundle exec rake db:create db:migrate
bundle exec rspec 
```

* * *

## 回答 #9

> 赞同：5
> 
> 时间：2014-01-13T08:25:43.133

查找 / -name 'postgresql.conf'

网络统计-an | grep 5432 **# => /tmp/.s.PGSQL.5432**

vi /Users/admin/Library/Application\ Support/Postgres93/var/postgresql.conf

**来自：** unix_socket_directories = '/tmp'

**TO：** unix_socket_directories = '/var/pgsql_socket'

sudo mkdir /var/pgsql_socket

sudo chmod 777 /var/pgsql_socket

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2015-07-14T20:22:03.653

对于heroku，这就是你所需要的。

```
heroku addons:create heroku-postgresql

production:
 adapter: postgresql
 encoding: unicode
 host: localhost
 # For details on connection pooling, see rails configuration guide
 # http://guides.rubyonrails.org/configuring.html#database-pooling
 pool: 5 
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2020-09-23T02:48:21.413

我有一个类似的问题 - 当我`psql`在终端运行命令时，我仍然遇到同样的错误，所以这告诉我这不是 pg gem 的问题，我应该检查 postgres 设置本身。所以我检查了 postgres 日志——在我的例子中，它们位于，`/usr/local/var/log/postgres.log`我看到了以下错误：

```
dyld: Library not loaded: /usr/local/opt/icu4c/lib/libicui18n.66.dylib
  Referenced from: /usr/local/opt/postgresql/bin/postgres 
```

所以知道确切的错误帮助我解决了这个问题，在我的情况下，我运行了[这个答案](https://stackoverflow.com/a/54180353/5725619)

```
brew switch icu4c 66.1 
```

重新启动postgres后解决了这个问题：

```
brew services restart postgresql 
```

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2018-10-04T15:59:17.013

我的问题是`/etc/hosts`文件已更改并且没有这个关键条目：`127.0.0.1 localhost`

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2018-06-02T17:57:47.953

我在 OS High sierra 10.13 上遇到了同样的问题我按照这个网站的说明下载了 10.4 版参考：[https ://postgresapp.com/](https://postgresapp.com/)

然后我将此添加到 bash 配置文件中：export PATH=$PATH:/Library/PostgreSQL/10.4/bin:$PATH

重新启动终端。

打开新窗口终端然后输入：psql -U postgres

之后，您将看到以下消息： psql (10.4) 键入“help”寻求帮助。

postgres=#

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2018-03-30T16:56:46.803

在 Mac 上，我有不同版本的 postgresql。当我尝试时这个问题已经解决`brew switch postgresql 9.5.5`（我认为版本号在这一点上并不重要）

```
$ brew switch postgresql 9.5.5
Cleaning /usr/local/Cellar/postgresql/9.6.1
Cleaning /usr/local/Cellar/postgresql/9.6.5
Cleaning /usr/local/Cellar/postgresql/10.2
Cleaning /usr/local/Cellar/postgresql/10.3
Cleaning /usr/local/Cellar/postgresql/9.5.5
Cleaning /usr/local/Cellar/postgresql/9.5.4 
```

顺便说一句，所有数据都将消失。我想有一个 brew 命令可以在不切换版本的情况下执行此操作，但我找不到。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2017-12-21T10:32:08.693

我只是遇到了postgres应用程序没有在我的mac上运行的问题......*

# ios - 是否可以通过编程方式阻止特定 iOS 应用程序在未越狱的 ipad / iphone 上运行？

> ID：14225040
> 
> 赞同：3
> 
> 时间：2013-01-08T22:21:11.263
> 
> 标签：ios

是否有可能编写一个 iOS 应用程序来阻止其他应用程序在未越狱的 iphone / ipad 上运行？

这将是出于合法目的，例如我打开应用程序，将我的 iPad 交给我的孩子，我不必担心他们会删除我的照片或浏览网页。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-08T22:27:42.817

不，不是以编程方式。除非 iPhone 越狱，否则您无法从您的应用程序控制另一个应用程序。但是，您可以获得[本文](https://stackoverflow.com/a/4312705/1730272)中提到的 iOS 中的进程列表。如果您不打算将此应用程序发布到应用商店，您可以尝试发送 SIGKILL 来终止它们（**不推荐**）。

> 例如，我打开应用程序，将我的 iPad 交给我的孩子，我不必担心他们会删除我的照片或浏览网页。

关于上述几点，可能最简单的解决方案是为此目的检查[引导访问。](http://support.apple.com/kb/HT5509)

使用引导访问：

*   暂时将您的 iOS 设备限制为特定应用
*   禁用与任务无关的屏幕区域，或意外手势可能导致分心的区域
*   禁用硬件按钮

您可以点按设置 > 通用 > 辅助功能 > 引导式访问来设置引导式访问。从那里您可以：

*   打开或关闭引导式访问
*   设置控制引导访问的使用并防止某人离开活动会话的密码
*   设置设备是否可以在会话期间进入睡眠状态

**启动引导式访问会话**

*   打开您要运行的应用程序。
*   三击主页按钮。
*   调整会话的设置，然后单击开始。

**禁用应用程序控件和应用程序屏幕区域**

*   圈出您要禁用的屏幕的任何部分。
*   使用手柄调整区域。

**忽略所有屏幕触摸**

*   关闭触控。

**防止 iPhone、iPad 或 iPod touch 从纵向切换到横向或响应任何其他动作**

*   关闭运动。

**结束引导式访问会话**

*   三击主页按钮。
*   输入引导访问密码。

所有这些细节都来自上面的链接。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-08T22:23:11.187

这是 iOS 中称为限制 ( `Settings`-> `General`-> `Restrictions`) 的设置，**不能**以编程方式完成。

# css - IE 中的 CSS 中断

> ID：14225048
> 
> 赞同：0
> 
> 时间：2013-01-08T22:21:36.777
> 
> 标签：css, html, internet-explorer, internet-explorer-8

我有一个页眉和页脚，我正在测试一个我将要开发的网站。页眉和页脚在除 IE 之外的所有浏览器中看起来都很棒。我正在使用支持 IE 的骨架（[http://www.getskeleton.com/](http://www.getskeleton.com/)）网格进行响应，但我找不到问题所在。这是我创建的测试页面的链接：http: [//kennyalvarez.com/bs/](http://kennyalvarez.com/bs/)

```
 <!DOCTYPE html>
<!--[if lt IE 7 ]><html class="ie ie6" lang="en"> <![endif]-->
<!--[if IE 7 ]><html class="ie ie7" lang="en"> <![endif]-->
<!--[if IE 8 ]><html class="ie ie8" lang="en"> <![endif]-->
<!--[if (gte IE 9)|!(IE)]><!--><html lang="en"> <!--<![endif]-->
<head>
<link rel="stylesheet" href="stylesheets/base.css" />
<link rel="stylesheet" href="stylesheets/skeleton.css" />
<link rel="stylesheet" href="stylesheets/layout.css" />

</head>
<body>
<!-- Primary Page Layout================================================== -->
<div id="head" class="row">
    <header class="container-twelve">
        <p id="" class="six columns alpha"><a href="#">My Site</a></p>
            <ul class="six columns omega">
                <li>
                <button id="searchbtn" name="search">Search</button>
                </li>
                <li>
                <form action="#search" method="post">
                    <input id="search" placeholder="search" type="text" name="search">
                </form>
                </li>
                <li><a href="contact.html">Contact</a></li>
                <li>
                    <a id=login href="#">Login</a>
                    <form id=loginform action="" method="post">
                        <input class="required" id="username" placeholder="Username" type="text" name="username">
                        <input class="required" id="password" placeholder="Password" type="text" name="password">
                        <div id=captcha>
                            <img src="http://placehold.it/100x30" alt="title">
                        </div>
                        <input class="required" id="captchainput" placeholder="Captcha" type="text" name="captchainput">
                        <a href="#">Forgot Login?</a> <a href="#">Register</a>
                        <button id="loginbtn" type="button" name="login">Login</button>
                    </form>
                </li>
                <li><a href="#">Glossary</a></li>
            </ul>
    </header>
</div><!--head-->
<div id=fullpage>
        <nav>
    <div class="container-twelve">

            <a href="#">PAGE</a>
            <a href="#">PAGE</a>
            <a href="#">PAGE</a>
            <a href="#">PAGE</a>
            <a href="#">PAGE & PAGE</a>
            <a href="#">PAGE</a>
            <a href="#">PAGE & PAGE</a>
    </div>
  </nav>

        <ul id="subnav">
        <div class="container-twelve">

            <li><a href="#"> PAGE</a>
                <ul>
                    <li><a href="#">PAGE</a></li>
                    <li><a href="#">PAGE</a></li>
                    <li><a href="#">PAGE</a></li>

                </ul>
          </li>
            <li><a href="#"> PAGE</a>
                <ul>
                    <li><a href="#">PAGE</a></li>
                    <li><a href="#">PAGE</a></li>
                    <li><a href="#">PAGE</a></li>
                    <li><a href="#">PAGE</a></li>
                </ul>
          </li>
            <li><a href="#"> PAGE</a>

                <ul>
                    <li><a href="#">PAGE</a></li>
                    <li><a href="#">PAGE</a></li>
                </ul>
          </li>
            <li><a href="#"> PAGE</a>
                <ul>
                    <li><a href="#">PAGE</a></li>
                </ul>
          </li>
            <li><a href="#"> PAGE</a>
                <ul>
                    <li><a href="#">PAGE</a></li>
                    <li><a href="#">PAGE</a></li>
                </ul>
            </li>
            <li><a href="#"> PAGE</a>

                <ul>
                    <li><a href="#">PAGE</a></li>
                    <li><a href="#">PAGE</a></li>
                    <li><a href="#">PAGE</a></li>
                </ul>
          </li>
            <li><a href="#"> PAGE</a>

                <ul>
                    <li><a href="#">PAGE</a></li>
                </ul>
            </li>
        </div>
</ul>
        <div id="content">
            <h1>TEST</h1>

        </div><!--content-->
</div><!--fullpage-->
<div id="foot">
        <footer class="container-twelve">
            <div class="twelve columns">

                <div id="fnav" class="six columns alpha omega">
                    <a href="#">Terms of Use</a>
                    <a href="#">Sitemap</a>
                    <a href="#">Glossary</a>
                    <a href="#">Login</a>
                    <a href="#">Contact Us</a>
                </div>
                <div class="four columns alpha omega">
                    <p><a href="index.html">MY SITE</a></p>
                    <p class="copy">Copyright 2012 &copy; All rights reserved.</p>
                </div>
            </div><!--fourteen-columns-->
        </footer>
    </div><!--foot-->

</body>
</html> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-08T22:32:17.103

Internet Explorer 8 不支持 HTML5 元素，例如`header`和`footer`。您将需要用 div 替换这些元素，或者使用这样的 javascript polyfill：http: [//www.paulund.co.uk/turn-on-html5-in-ie8-or-lower](http://www.paulund.co.uk/turn-on-html5-in-ie8-or-lower)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-06-18T05:46:15.617

或使用垫片

```
<!-- HTML5 shim -->
<!--[if lt IE 9]>
    <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
<![endif]--> 
```

# jquery - 从table2到table1的可排序数据

> ID：14225056
> 
> 赞同：0
> 
> 时间：2013-01-08T22:22:13.007
> 
> 标签：jquery, jquery-ui-sortable

我只希望用户可以选择将项目从下表（#sortable2）移动到上表（#sortable1）。

我认为这与`{'connectWith':'.connectedSortable',`

我试过了：`{'connectWith':'#sortable1, .connectedSortable',`但它不起作用..

```
$(document).ready(function(){
 jQuery('#sortable1, #sortable2')
 .sortable(
 {'connectWith':'.connectedSortable',
 'dropOnEmpty':true,
 'scroll':true,
  items: "li:not(.emptyMessage)",
  receive: function(event, ui) {
         //hide empty message on receiver
         $('li.emptyMessage', this).hide();

         //show empty message on sender if applicable
         if($('li:not(.emptyMessage)', ui.sender).length == 0){
             $('li.emptyMessage', ui.sender).show();
         } else {
             $('li.emptyMessage', ui.sender).hide();
         }            
     }

  });
}); 
```

这是我的`index.html.erb`：

```
<html>
  <body>

   <ul id="sortable1" class="connectedSortable"> 

    <% @tasks_worker_todo.each do |task| %>
          <li class="ui-state-default">
            <%= best_in_place task, :done, :classes => 'highlight_on_success', type: :checkbox, collection: %w[No Yes] %> | 
            <%= task.admin_mail %> | 
            <%= task.task %>
          </li>
    <% end %>
  </ul>

  <br><br>

  <ul id="sortable2" class="connectedSortable">
    <% @tasks_worker_done.each do |task| %>
          <li class="ui-state-highlight">
             <%= best_in_place task, :done,:classes => 'highlight_on_success', type: :checkbox, collection: %w[No Yes] %> | 
             <%= task.admin_mail %> | 
             <%= task.task %>
          </li>
    <% end %>
  </ul>

</body>
</html> 
```

请帮忙。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-08T23:57:22.253

根据文档`connectWith`是一种单向关系。

试试这个：

```
'connectWith':'#sortable1' 
```

演示：http: [//jsfiddle.net/8TCxY/41/](http://jsfiddle.net/8TCxY/41/)

# python - 什么是通过短期运行流程管道传输内容并获得输出的最轻松的方式？

> ID：14225060
> 
> 赞同：2
> 
> 时间：2013-01-08T22:22:28.830
> 
> 标签：python, io, piping

我想在我通过lessc读取/处理过的一些东西上运行lessc，并且不想弄乱文件。subprocess.check_output 和 Popen.communicate 都被证明是为了快速调整而带来的麻烦。他们都没有输出任何东西/永远等待。是否有某种无忧的便利功能来管理缓冲区等等？

示例来源：

```
from subprocess import Popen
from sys import stderr

s = """
@a: 10px
foo {
    width: @a;
}
"""
print("making")
p = Popen("lessc -", shell=True, stdout=-1, stdin=-1, stderr=stderr)
print("writing")
p.stdin.write(bytes(s, "utf-8"))
print("Waiting")
p.wait()
print("readng")
out = p.stdout.read()
print(out) 
```

输出：

```
making
writing
Waiting 
```

（注释掉等待部分只会使它阻塞阅读）

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-08T22:46:05.117

我猜这个问题只是你的lessc不是短命的。它从它的标准输入读取，你永远不会关闭它。

如果你让 lessc 从标准输入读取它，在终端上输入一些输入，然后只是等待（从不发出输入结束信号），它会在终端中表现如何？这就是你的程序正在做的事情。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-08T22:53:18.587

以下代码对您有用吗？

```
import subprocess
import sys

s = """
@a: 10px
foo {
    width: @a;
}
"""

p = subprocess.Popen(['lessc', '-'],
    stdin = subprocess.PIPE,
    stdout = subprocess.PIPE,
    stderr = sys.stderr)

out = p.communicate(s)[0]
print out 
```

# javascript - 基于用户输入显示数据的 HTML 下拉列表

> ID：14225061
> 
> 赞同：0
> 
> 时间：2013-01-08T22:22:31.087
> 
> 标签：javascript, jquery, html, drop-down-menu

我需要创建一个下拉列表，在用户输入他们的选择时根据用户输入的数据向您显示数据。

下拉列表太长了，我不希望我的用户必须滚动浏览它。

此功能的一个很好的参考是 Expedia。当您开始输入城市名称时，它会为您提供一个列表，其中包含可供选择的选项。

以前从未这样做过，因此任何类型的参考甚至此类菜单的名称都会有很大帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-08T22:25:35.957

使用 jQuery + jQuery UI 自动完成来做到这一点：http: [//jqueryui.com/autocomplete/](http://jqueryui.com/autocomplete/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-11T06:04:34.467

我肯定会推荐使用这个。Jquery 选择的插件，它有一个内置的搜索`<select>....</select>`和易于使用

[选择的插件](http://harvesthq.github.com/chosen/)

# iphone - 使用 touchesbegan 和 touchesmoved 来区分轻弹和拖动

> ID：14225064
> 
> 赞同：1
> 
> 时间：2013-01-08T22:22:42.903
> 
> 标签：iphone, ios

我用这两个函数来检测用户在uiview上慢慢拖拽

-(void) touchesBegan:(NSSet *)touches withEvent:(UIEvent *)event

-(void) touchesMoved:(NSSet*)touches withEvent:(UIEvent*)event

但是，我如何使用这两种方法来检测用户实际轻弹（快速翻转）uiview？

我如何区分轻弹和拖动？

非常感谢你的帮助！

正义便士

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-09T03:56:35.543

你可以试试这样的使用`-(void) touchesBegan:(NSSet *)touches withEvent:(UIEvent *)event`方法来标记beginPoint和beginTime；ues 方法来标记endPoint`-(void) touchesEnded:(NSSet*)touches withEvent:(UIEvent*)event`和 endTime 。然后计算速度，你可以比较速度和你的阈值。（速度可能只计算水平或垂直）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-08T22:59:35.990

我认为你应该检查手势识别器——它们需要大量的工作来区分不同的用户触摸。您所描述的是平移和滑动手势。有特定的手势识别器类来处理其中的每一个。UIGestureRecognizer 是父类，你应该先看看它。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-09T00:46:01.857

Drag 和 Flick 通常以速度来区分 - 一种解决方案是创建基于距离公式的算法。

一个粗略的例子：

```
CGPoint pointOld = CGPointMake(0, 0); // Not sure if this is valid
CGPoint pointNew = CGPointMate(0, 0); // Just making holders for the
                                      // location of the current and previous touches

float timeInterval = 0.2f;
// However long you think it will take to have enough of a difference in
// distance to distinguish a flick from a drag

float minFlickDist = 100.0f;
// Minimum distance traveled in timeInterval to be considered a flick

- (void)callMeEveryTimeInterval
{
    // Distance formula
    float distBtwnPoints = sqrt( (pointNew.x - pointOld.x) * (pointNew.x - pointOld.x) - (pointNew.y - pointOld.y) * (pointNew.y - pointOld.y) );
    if (distBtwnPoints >= minFlickDist)
    {
        // Flick
    } else {
        // Drag
    }
} 
```

我认为可能有用的东西的粗略草图 - 希望有帮助。

# php - 计算 Excel 文件中的行数

> ID：14225066
> 
> 赞同：0
> 
> 时间：2013-01-08T22:22:47.880
> 
> 标签：php, wordpress, excel, count

> **可能重复：**
> [有效地计算文本文件的行数。(200mb+)](https://stackoverflow.com/questions/2162497/efficiently-counting-the-number-of-lines-of-a-text-file-200mb)
> [如何在块循环中使用 PHPExcel 库确定文件的结尾？](https://stackoverflow.com/questions/9972404/how-do-i-determine-the-end-of-the-file-using-phpexcel-library-in-chunk-loop)

我似乎无法让它在 PHP 中工作

我正在尝试计算上传的 EXcel 文件中的行数

这是我所拥有的，但它总是将它乘以 2，我想删除第一行，因为它只是标题，请帮助：

```
$countthelines= count(file($file)) -1; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-08T22:25:39.117

将您的 Excel 文件转换为 CSV 文件并尝试如下操作：

```
$countthelines = count(file($file, FILE_SKIP_EMPTY_LINES)) - 1; 
```

# c# - 使用 ODP.NET 更新 Oracle 表的参数化 OracleCommand/ 绑定变量？

> ID：14225075
> 
> 赞同：2
> 
> 时间：2013-01-08T22:23:28.350
> 
> 标签：c#, oracle, plsql, odp.net

我有一个包含以下列名称和类型的 Oracle 11g 表：

```
ID VARCHAR2(32 BYTE)
VERSION VARCHAR2(12 BYTE) 
```

我试图让绑定变量在 Oracle 参数化命令中使用 ODP.NET 和 C# 在此表上更新语句，但我没有运气。这是我正在使用的代码：

```
string constr = gconstr + "; Data Source=" + db;
OracleConnection con = new OracleConnection(constr);
con.Open();
ddiId = "WS_5043";
ddiVer = "1.0.3";

string UPDATE_CLOB_QUERY = "UPDATE :ddiTable SET version=:ddiVer WHERE id=:ddiId";

Oracle.DataAccess.Types.OracleXmlType ret;
OracleCommand oracleCommand2 = new OracleCommand(UPDATE_CLOB_QUERY, con);
oracleCommand2.Parameters.Clear();
oracleCommand2.Parameters.Add("ddiId", OracleDbType.Varchar2, ParameterDirection.Input).Value = ddiId;
oracleCommand2.Parameters.Add("ddiTable", OracleDbType.Varchar2, ParameterDirection.Input).Value = ddiTable;
oracleCommand2.Parameters.Add("ddiVer", OracleDbType.Varchar2, ParameterDirection.Input).Value = ddiVer;
oracleCommand2.ExecuteNonQuery();
oracleCommand2.Dispose(); 
```

当我在 VS2010 中运行上述代码时，我得到以下 Oracle 错误：

```
ORA-01036: illegal variable name/number 
```

但是，当我删除 SQL 中的绑定变量声明时，上述工作即

```
string UPDATE_CLOB_QUERY = "UPDATE wstable SET version='1.0.2' WHERE id='WS_5043'"; 
```

我究竟做错了什么？

我需要知道如何获取绑定变量和参数化 Oracle 命令与 SQL 更新命令（例如上面的命令）一起使用，因为我最终将开始更新其他表中的大型 clob（当然，在 SQL 中将 clob 连接为字符串）导致大小限制错误）。所以让它发挥作用将是第一个胜利。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-08T22:48:12.600

在这一行；

```
oracleCommand2.Parameters.Add("ddiTable", OracleDbType.Varchar2, ParameterDirection.Input).Value = ddiTable; 
```

您实际上尝试将您的表名 ( ) 作为参数添加`ddiTable`。你不能那样做。并且没有必要将您的查询表名称添加为参数。如果你想使用[`Parameters.Add()`](http://msdn.microsoft.com/en-us/library/txzce1aw.aspx)带有 3 个参数的方法，你必须使用 as 参数，例如；

```
public OracleParameter Add(
    string parameterName,
    OracleType dataType,
    int size
) 
```

这是唯一适合的重载方法。[`ParameterDirection.Input`](http://msdn.microsoft.com/en-us/library/system.data.parameterdirection.aspx)采用方法的第三个参数类型没有重载[`Parameters.Add()`](http://msdn.microsoft.com/en-us/library/txzce1aw.aspx)。

> 我需要知道如何获取绑定变量和参数化 Oracle 命令与 SQL 更新命令（如上述命令）一起使用。

我可以建议你阅读这些吗？

*   来自 MSDN 的[OracleCommand类。](http://msdn.microsoft.com/en-us/library/y051k82s.aspx)
*   [Oracle 更新语句](http://psoug.org/reference/update.html)
*   [Oracle 更新 SQL 提示](http://www.dba-oracle.com/t_update_statement_syntax.htm)
*   [Sql 命令更新](http://docs.oracle.com/html/A95915_01/sqcmd.htm#i1009516)

# c# - 如何使用 web 和 winform 项目构建解决方案

> ID：14225076
> 
> 赞同：1
> 
> 时间：2013-01-08T22:23:34.273
> 
> 标签：c#, asp.net, winforms, visual-studio

我希望学习的是如何在 Visual Studio 中将 Web 应用程序和桌面应用程序从同一个工作中结合起来的最佳实践。

例如，我有一个任务，其中包括一个 ASP.NET MVC 前端，客户端在该前端输入 SQL Server 数据库。winform 从数据库中读取输入并对其执行操作。具体的来龙去脉并不那么重要。

ASP.NET MVC 显然是一个 Visual Studio 项目，有一个支持它的 VS 单元测试项目。

桌面应用程序是一个 C# 项目，它引用/捆绑了其他两个 winform 项目。

最好将 web 和 winform 项目放在一起，还是放在单独的解决方案中？在这种情况下，我的团队采取了一些大杂烩的方法，一种或另一种方式，但我想感觉自己做得“正确”。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-08T22:38:25.587

您没有提到代码的哪些部分在应用程序之间共享，但通常有一些共同点。在这种情况下，您将使用共享代码创建一个库 (DLL) 项目，并仅将所需的 API 公开为“公共”。您甚至可以考虑使用WebForm 和 WebApp 项目都引用（作为项目引用）的[可移植类库。](https://stackoverflow.com/questions/5238955/what-is-a-portable-class-library)

一般来说，我发现将项目保存在一个解决方案中很方便，直到如果/当加载和构建它时由于大小而变得很麻烦，所以我认为你已经足够接近“正确”来感受它。

# php - Codeigniter 锚不工作

> ID：14225078
> 
> 赞同：0
> 
> 时间：2013-01-08T22:23:48.807
> 
> 标签：php, codeigniter-2

我正在使用 Windows 7 进行开发。

我在 codeigniter 中的锚点有问题。我得到一个错误。

```
The requested URL /mysite/contact was not found on this server. 
```

如果我将 index.php 添加到我的锚，它就可以工作。

```
<?php echo anchor('index.php/contact', 'Contact Us', 'title="Contact"');?> 
```

如果我删除该`index.php`部分，那么我会收到上述错误。

我正在使用 WAMP 启用了重写模块。在我的配置中，我有以下内容。

```
$config['base_url'] = 'http://localhost/mysite'; 
```

和

```
$config['index_page'] = ''; 
```

最后这是我正在使用的 .haccess

```
RewriteEngine on
RewriteCond $1 !^(index\.php|images|captcha|css|js|robots\.txt)
RewriteRule ^(.*)$ /index.php/$1 [L] 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-10T01:43:49.843

我想到了。我的应用程序文件夹中有 .htaccess 文件，而不是站点的根目录。

# c++ - 与 MinGW 4.7.1 上的 -static-libstdc++ 标志链接

> ID：14225083
> 
> 赞同：12
> 
> 时间：2013-01-08T22:24:12.663
> 
> 标签：c++, mingw, codeblocks, mingw32, allegro

我尝试使用 编译器标志在 MinGW 4.7.1 上编译（Allegro 5）
（在 Win 7 上使用 Code::Blocks 12.11） （将它们写入项目 :: 链接器设置 :: 其他链接器设置）：

> -static-libgcc
> -static-libstdc++

结果：

> 无法识别的命令行选项“-static-libstdc++”

如何解决？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-01-08T23:10:51.150

说什么`g++ --version`？我不知道它推出时的确切版本，但它是`-static-libstdc++`最近添加的。之前，您必须执行类似`-static -lstdc++ -dynamic`. （如果编译器版本是4.7.1，这应该没有问题，但我不知道MinGW版本如何映射到实际的编译器版本。）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-08T22:31:40.200

我没有测试，但尝试分开`-static -libstdc++`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-08T22:46:42.997

以下链接可以帮助您。它解释了如何在 C++ 中链接静态库 [http://www.trilithium.com/johan/2005/06/static-libstdc/](http://www.trilithium.com/johan/2005/06/static-libstdc/)

# java - AsyncTask 和内存泄漏

> ID：14225096
> 
> 赞同：0
> 
> 时间：2013-01-08T22:24:44.830
> 
> 标签：java, android, android-asynctask

我正在编写一个简单的地图应用程序，从服务器下载 osm 切片，为每个切片生成一个新的 AsyncTask。一些 AsyncTask 运行完成，一些在它们有机会运行之前被取消（以防我平移屏幕）。可能是那时，当它们似乎泄漏时。我首先通过检查我的平铺位图的生命周期发现了这一点，然后发现它们泄漏了。在取消 AsyncTask 中对位图的（间接）引用后，位图停止泄漏，但它让我思考为什么所说的引用很重要，并发现尽管尽一切努力关闭对它们的引用，AsycTask 的数量仍在持续增长。我运行了 MAT 分析，这时我需要帮助。谁能帮我解释一下[图片](https://www.dropbox.com/s/d7k47s681q0rjkd/AsncTaskMemoryLeak.PNG)（对不起，我没有足够的stackoverflow browny点来直接附加图片）。

显示的树条目显示了许多泄露的 AsyncTask（类型为 FileCacheTask）之一，其子项表示对它的所有传入引用。我知道“参照物”是垃圾收集器。另外两个，表示为 android.os.AsyncTask 类型的 this$0（暗示与外部类的亲和性）（这与 FileCacheTask 的外部类没有任何关系，不可否认，FileCacheTask 是 tile 工厂内的非静态内部类） ，似乎通过 mWorker 成员持有对我泄露对象的引用，这是我无法解释且显然无法摆脱的。我尝试按照路径查找对 android.os.AsyncTask 对象的传入引用，但看到了一些调度内部结构，但与我的代码无关）。有什么想法可能是被称为 this$0 的 android.os.AsyncTask 对象吗？

**编辑**。按照建议，我（有点）将问题提炼成一个易于理解的代码片段。我说的有点，因为它看起来确实表现出相同的行为，但我不能确定它是否真的遇到了同样的问题。它的行为仍然很神秘。这是代码：

```
public class TaskLeak {
static public int DDeletedTasks; //these are all for debug/tracing purposes
static public int DCreatedTasks;
static public int DCancelled;

private class PrivateTask extends AsyncTask<Void, Void, Void>
{
    private int mTaskId;
    private boolean mFinished;
    private Bitmap mBitmap;
    public PrivateTask()
    {
        mTaskId = ++DCreatedTasks;
                //allocating a bitmap to give this object a meaningful weight for GC to consider.
        mBitmap = Bitmap.createBitmap(256, 256, Bitmap.Config.ARGB_8888);
        //Log.d("Tasks", "(constructor) Task count:"+ mTaskId+" tasks in existence:"+(DCreatedTasks-DDeletedTasks));
        execute();
    }

    @Override
    protected Void doInBackground(Void... params) {
        try {
            int sleepForMs = mRandomGenerator.nextInt(100);
            //emulating blocking download action for a random few milliseconds.
            Thread.sleep(sleepForMs);
            //Log.d("Tasks", "Waking up from sleep, task:" + mTaskId);
        } catch (InterruptedException e) {
            //Log.d("Tasks", "Can't sleep, task:" + mTaskId);
        }
        return null;
    }

    @Override
    protected void onPostExecute(Void result) 
    {
        mFinished = true;
        maintain();
    }

    @Override
    protected void onCancelled()
    {
        DCancelled++;
        onPostExecute(null);
    }

    @Override
    protected void finalize()
    {
        ++DDeletedTasks;
        Log.d("Tasks", "(destructor) Task count:"+ mTaskId+" tasks in existence:"+(DCreatedTasks-DDeletedTasks));
    }       

    public boolean finished()
    {
        return mFinished;
    }       
}

private final static int KMaxTasks = 100;
private Random mRandomGenerator;
private final int mMaxCycles;
private int mCycles;
private final Vector<PrivateTask> mTasks;
public TaskLeak(int maxCycles)
{
    mMaxCycles = maxCycles;
    mRandomGenerator = new Random();
    mTasks = new Vector<PrivateTask>();
    for (int i = 0; i < KMaxTasks; i++)
    {
        mTasks.add(new PrivateTask());
    }
}

public void maintain()
{
    Log.d("Tasks", "***maintain(), tasks held:"+mTasks.size()+" there are "+ (mMaxCycles - ++mCycles)+" cycles left to go");
    for (int i = 0; i < mTasks.size();)
    {
        if (mTasks.get(i).finished())
        {
            mTasks.remove(i);
            if (mCycles < mMaxCycles)
            {
                mTasks.add(new PrivateTask());
            }
        }
        else
        {
            i++;
        }
    }

    if ((mCycles % 10) == 0 )
    {
        DCancelled++;
        mTasks.get(5).cancel(true);
    }

    if (mTasks.size() == 0)
    {
        new TestMemoryGrabber(200).test();
        Log.d("Tasks", "maintain() has finished!");
        Log.d("Tasks", "maintain(). There have been "+DCreatedTasks+" tasks created.");
        Log.d("Tasks", "maintain(). There have been "+DDeletedTasks+" tasks deleted.");
        Log.d("Tasks", "maintain(). There have been "+(DCreatedTasks-DDeletedTasks)+" tasks remaining.");   
        Log.d("Tasks", "maintain(). There have been "+DCancelled+" tasks cancelled.");
    }
} 
```

当它执行 1000 个周期时，它会因内存不足异常而在中途（在周期 #570 上）失败，尽管我始终保持不超过 100 个对 PrivateTask 对象的引用。这本身就有点令人费解，因为 GC 应该不断地为新条目腾出空间。为什么不呢？

这是关于何时发生 oom 异常的 LogCat：

```
01-12 16:37:50.902: D/Tasks(3235): (destructor) Task count:568 tasks in existence:156
01-12 16:37:50.993: D/Tasks(3235): ***maintain(), tasks held:100 there are 430 cycles left to go
01-12 16:37:51.062: I/dalvikvm-heap(3235): Clamp target GC heap from 49.251MB to 48.000MB
01-12 16:37:51.062: D/dalvikvm(3235): GC_FOR_ALLOC freed 257K, 2% free 48337K/48903K, paused 70ms, total 71ms
01-12 16:37:51.062: D/Tasks(3235): (destructor) Task count:569 tasks in existence:156
01-12 16:37:51.092: D/Tasks(3235): ***maintain(), tasks held:100 there are 429 cycles left to go
01-12 16:37:51.222: I/dalvikvm-heap(3235): Clamp target GC heap from 49.251MB to 48.000MB
01-12 16:37:51.232: D/dalvikvm(3235): GC_FOR_ALLOC freed 257K, 2% free 48337K/48903K, paused 139ms, total 139ms
01-12 16:37:51.242: D/Tasks(3235): ***maintain(), tasks held:100 there are 428 cycles left to go
01-12 16:37:51.312: I/dalvikvm-heap(3235): Clamp target GC heap from 49.502MB to 48.000MB
01-12 16:37:51.322: D/dalvikvm(3235): GC_FOR_ALLOC freed <1K, 1% free 48593K/48903K, paused 70ms, total 72ms
01-12 16:37:51.322: I/dalvikvm-heap(3235): Forcing collection of SoftReferences for 262160-byte allocation
01-12 16:37:51.412: I/dalvikvm-heap(3235): Clamp target GC heap from 49.494MB to 48.000MB
01-12 16:37:51.412: D/dalvikvm(3235): GC_BEFORE_OOM freed 9K, 1% free 48584K/48903K, paused 86ms, total 86ms
01-12 16:37:51.412: E/dalvikvm-heap(3235): Out of memory on a 262160-byte allocation.
01-12 16:37:51.412: I/dalvikvm(3235): "main" prio=5 tid=1 RUNNABLE
01-12 16:37:51.412: I/dalvikvm(3235):   | group="main" sCount=0 dsCount=0 obj=0x40a14568 self=0x2a00b9e0
01-12 16:37:51.412: I/dalvikvm(3235):   | sysTid=3235 nice=0 sched=0/0 cgrp=apps handle=1073870640
01-12 16:37:51.412: I/dalvikvm(3235):   | schedstat=( 21236163363 7517071458 4002 ) utm=1940 stm=183 core=0
01-12 16:37:51.412: I/dalvikvm(3235):   at android.graphics.Bitmap.nativeCreate(Native Method)
01-12 16:37:51.412: I/dalvikvm(3235):   at android.graphics.Bitmap.createBitmap(Bitmap.java:640)
01-12 16:37:51.412: I/dalvikvm(3235):   at android.graphics.Bitmap.createBitmap(Bitmap.java:620) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-16T20:13:13.080

在查看了您的代码、日志和解释之后，我猜想这个 OutOfMemoryError 是由于内存中存储了太多位图而引起的。

当您创建每个 PrivateTask 时，甚至在它开始运行之前，您正在初始化一个要保存在内存中的位图。存在超过 100 项任务，你正在突破你的记忆极限。如下所示的 Logcat 行表明了这一点：

```
01-12 16:37:51.412: D/dalvikvm(3235): GC_BEFORE_OOM freed 9K, 1% free 48584K/48903K, paused 86ms, total 86ms 
```

至于缓解问题，我可以推荐的第 1 个解决方案是确保一旦取消每个任务，您明确调用`recycle()`在您的位图对象上。我怀疑即使 PrivateTasks 被取消，对它们的一些引用也会被维护，这会导致在发生 GC 时只有非常少量（1% 左右）的内存被释放，因为系统只是不是摧毁它们，或者反过来，你的位图。或者，GC 可以完全正确地处理这个问题，但是在您的活动 PrivateTasks 中有足够的位图将您推到内存限制，这也将导致没有任何东西被垃圾收集，因为系统找不到任何要收集的东西！如果您经常需要从服务器下载如此多的位图，您可能需要考虑将它们存储在磁盘上，并且只在需要时才将它们检索到内存中，尽管这可能会严重影响性能。

以下是有关位图管理的一些链接和其他 SO 问题：

[从 Android 开发站点高效显示位图](http://developer.android.com/training/displaying-bitmaps/index.html)（请参阅缓存位图部分）

[有类似问题的人的解决方案](https://stackoverflow.com/questions/8950658/android-bitmap-memory-use)

[下载完成后，您可以尝试压缩位图，具体取决于质量。压缩后记得回收对原版的引用！](https://stackoverflow.com/questions/8296217/need-help-in-handling-images-in-android)

[有关为位图分配内存时幕后情况的更多信息。](https://stackoverflow.com/questions/1945142/bitmaps-in-android)

作为旁注，我很好奇您正在测试什么类型的设备/模拟器，尤其是 SDK 版本。为 Android 应用程序提供的内存量随着硬件的更新而增加，因此您可能会在不同的手机上看到不同的测试结果。此外，我仍然认为许多设备（越来越多，因为 Gingerbread 失去市场份额和 ICS/Jellybean 增益）可能会连续执行这些操作，这也会改变你得到的结果，虽然似乎不是这个特定问题的根源，并且将更多地关注您的应用程序的未来兼容性。

希望这可以帮助！

# web-services - 减少 https 请求的总大小

> ID：14225103
> 
> 赞同：0
> 
> 时间：2013-01-08T22:25:09.460
> 
> 标签：web-services, http, optimization, https, request

假设您有一个 iPhone 应用程序，它通过发送下面的 JSON 字符串不断更新您的坐标；

```
{"id":"abcd","lat":12.2312,"lon":23.0212} 
```

我确实发送了这样的回复；

```
{"r":"OK"} 
```

现在复杂的部分是（我使用**Heroku**作为我的部署服务）当我发出这样的请求时，它大约需要**400 个字节**并被数据计划使用。一个挑战是，在我的应用程序中，我每 2 秒发出一次此请求，并且我计划将其放入的数据计划**每月不超过 250 MB**。然而，简单的计算表明；

**总计：** 400 * 30 * 60 * 24 * 30 = 1 036 800 000 = **~1 GB**，这**非常离谱**。那么可以做些什么来减少正在发送**的整体数据呢？****Gzip/deflate，减少标头中发送的元素（甚至可能删除请求类型），缩短标签**？为了使它尽可能小，我能做些什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-08T22:54:59.260

好吧，每个纬度和经度都代表大约 68 英里（约 111 公里）的测量值，因此即使在汽车中，发送的大量读数也将在同一度数内。

发送上次和当前读数的增量可以帮助使其更小。

您还可以使用您在服务器端解析的单个分隔符将您的 lon/lat（或 delta）数据连接成一个值。

```
So once a minute:  {"id":"abcd","m":"12.2312|23.0212"} 
Then 29 times:     {"id":"abcd","d":"-25|+68"} etc. 
```

您需要弄清楚服务器端，但这只是一个开始。

# css - CSS：条纹菱形

> ID：14225104
> 
> 赞同：8
> 
> 时间：2013-01-08T22:25:13.833
> 
> 标签：css, shape, css-shapes

我可以做钻石，我可以用 CSS 做条纹。我在将两者合并以获得条纹钻石时遇到问题。请看[我的小提琴](http://jsfiddle.net/r3PNs/)（适用于 Chrome）。

如何制作条纹钻石？

```
#diamond {
  width: 0;
  height: 0;
  border: 80px solid transparent;
  border-bottom: 40px solid red;
  position: relative;
  top: -80px
}
#diamond:after {
  content:'';
  position: absolute;
  left: -80px;
  top: 40px;
  width: 0;
  height: 0;
  border: 80px solid transparent;
  border-top: 40px solid red;
}

.stripes {
  height: 80px;
  width: 160px;
  background-size: 4px;
  background-color: red;
  background-image: -webkit-gradient(linear, 0 0, 100% 0, color-stop(.5, rgba(255, 255, 255, 1)), color-stop(.5, transparent), to(transparent));
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-22T00:05:00.153

你实际上可以用 1 个元素和更少的 CSS 来做到这一点：

# [***演示***](http://dabblet.com/gist/4590716)

HTML**很**简单`<div class='diamond'></div>`

相关**CSS**：

```
.diamond {
    overflow: hidden;
    position: relative;
    padding: 20%;
    width: 0;
    transform: rotate(-30deg) skewX(30deg) scaleY(.866);
}
.diamond:before {
    position: absolute;
    top: 0%; right:  -37.5%; bottom:  0; left:  -37.5%;
    transform: scaleY(1.155) skewX(-30deg) rotate(30deg);
    background: linear-gradient(90deg, crimson 50%, transparent 50%);
    background-size: 6px;
    content: ''
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-01-08T23:15:06.590

使用您提供的代码的 CSS 条纹菱形：http: [//jsfiddle.net/r3PNs/5/](http://jsfiddle.net/r3PNs/5/)

HTML：

```
<div id="diamond"></div>
<div class="stripes" style=""></div> 
```

CSS：

```
#diamond {
  width: 0;
  height: 0;
  border: 80px solid transparent;
  border-bottom: 40px solid red;
  position: relative;
  top: -80px;
}
#diamond:after {
  content:'';
  position: absolute;
  left: -80px;
  top: 40px;
  width: 0;
  height: 0;
  border: 80px solid transparent;
  border-top: 40px solid red;
}

.stripes {
  height: 80px;
  width: 160px;
  background-size: 4px;
  background-color: transparent;
  background-image: -webkit-gradient(linear, 0 0, 100% 0, color-stop(.5, rgba(255, 255, 255, 1)), color-stop(.5, transparent), to(transparent));
  position:absolute;
  top:0;
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-08T22:49:40.913

您使用边框来创建菱形和背景来创建条纹。这些不会一起工作。您可以改为旋转条纹框以获取钻石：

```
.stripes {
    height: 80px;
    width: 80px;
    background-size: 4px;
    background-color: red;
    background-image: -webkit-gradient(linear, 0 0, 100% 0, color-stop(.5, rgba(255, 255, 255, 1)), color-stop(.5, transparent), to(transparent));
    transform: rotate(45deg);
    -webkit-transform: rotate(45deg);
    -moz-transform: rotate(45deg);
    -ms-transform: rotate(45deg);
    -o-transform: rotate(45deg);
} 
```

# xcode - Mac OS X 自定义应用程序视图

> ID：14225111
> 
> 赞同：0
> 
> 时间：2013-01-08T22:25:45.097
> 
> 标签：xcode, macos, cocoa, interface-builder, nsview

过去几天我一直在搜索 Google 和 SO，但我不太确定要问的问题是否正确。

在 OS X 编程方面，我是 100% 的菜鸟。以为我会尝试一个简单的实用程序应用程序。无论如何都没有什么大不了的。事情的编程方面实际上已经完成，但事实证明，剥皮比我想象的要困难。

我想要完成的事情是这样的： ![自定义布局](../Images/891544b36ab69518c941ad790d1683d0.png)

但我似乎能弄清楚该怎么做：

![在此处输入图像描述](../Images/2d1cc271981f27cfa64fc9032211a4ba.png)

正如你所看到的，我有一个按钮，有点偏到一边，在角落里（我故意禁用了标题栏按钮）。我正在使用 Xcode 4.5.2 在 Interface Builder 中构建我的所有视图。

再说一次，对不起什么可能是最基本的问题......但我什至开始寻找什么？我找到的所有东西，我都是空白的。没有教程，没有示例，什么都没有。我假设它与某种自定义视图或窗口有关......你们中有人遇到过一些示例代码或有用的教程吗？

提前非常感谢您！:-) - 德鲁

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-08T23:53:20.680

快速谷歌搜索“可可自定义窗口”出现了[这个](http://www.cocoawithlove.com/2008/12/drawing-custom-window-on-mac-os-x.html)。祝你好运。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-10T14:34:06.210

我想我的菜鸟真的表现出来了，因为我不理解窗口和视图之间的区别。呵呵……

使用来自该站点的提示组合：http: [//cocoadev.com/wiki/BorderlessWindow](http://cocoadev.com/wiki/BorderlessWindow)。

在更大程度上，我猜想是把这个来自 Apple 的 Round Window 示例项目混为一谈：

[http://developer.apple.com/samplecode/RoundTransparentWindow/index.html](http://developer.apple.com/samplecode/RoundTransparentWindow/index.html)

我能够以正确的方式查看示例，并将必要的部分迁移到我自己的项目中。

砰！看起来完全像我希望的那样...... :-)

# asp.net - ASP.NET MVC 静态变量有多安全

> ID：14225113
> 
> 赞同：14
> 
> 时间：2013-01-08T22:25:45.207
> 
> 标签：asp.net, asp.net-mvc, thread-safety

我想确保我的网站将来能够托管在云上，并且它可以处理大量请求。

静态变量有多安全？

它们是否不安全，因为不同用户的不同请求实际上共享这些静态变量？或者是因为如果您将站点分布在线程/分片或类似上，（以处理高负载）线程正在共享静态变量？

主要是我有帮助类，具有静态属性，我应该改变这个架构，以便我创建每个类的实例并访问实例吗？

EG 这是我正在做的一个示例：

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Web;
using Mvc.Mailer;

namespace MVCWebsite.Helpers
{
        public class AppSettings
        {
                public static void OnAppInit()
                {
                        //General
                        AppName = "MyApp";
                        DesktopBaseURLs = new Dictionary<string, string>();
                        DesktopBaseURLs.Add("dev", "localhost:50560");
                        DesktopBaseURLs.Add("test", "www.test.whatever.com");
                        DesktopBaseURLs.Add("live", "www.whatever.com");
                        MobileBaseURLs = new Dictionary<string, string>();
                        MobileBaseURLs.Add("dev", "m.local.whatever.com");
                        MobileBaseURLs.Add("test", "m.test.whatever.com");
                        MobileBaseURLs.Add("live", "m.whatever.com");

                        //Emails
                        EmailHostName = AppName + ".com"; //For the moment atleast
                        NoReplyEmailAddress = "no-reply@" + EmailHostName.ToLower();
                        SupportEmailAddress = "support@" + EmailHostName.ToLower();
                        ErrorEmailAddress = "errors@" + EmailHostName.ToLower();

                        //Resources
                        TempFileURL = "/content/temp/";
                        UserDataURL = "/content/user-content/";
                        ProfilePicturesURL = UserDataURL + "profile-pictures/";

                        var a = GlobalHelper.GetURLAsServerPath(ProfilePicturesURL);
                        var b = a;

                }

                //General
                public static string AppName { get; set; }
                public static Dictionary<string, string> DesktopBaseURLs;
                public static Dictionary<string, string> MobileBaseURLs;

                //Emails
                public static string EmailHostName { get; set; }
                public static string NoReplyEmailAddress { get; set; }
                public static string SupportEmailAddress { get; set; }
                public static string ErrorEmailAddress { get; set; }

                //Resources
                public static string UserDataURL { get; set; }
                public static string TempFileURL { get; set; }
                public static string ProfilePicturesURL { get; set; }

                //Methods
                public static void SetAppURL()
                {

                }
        }
} 
```

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2013-01-08T22:29:46.743

您的代码不是线程安全的。您正在多个请求之间共享静态变量，这些请求可能由多个线程执行。请记住，您用作底层存储的类不是线程安全的类，这意味着如果您尝试从多个线程同时`Dictionary<TKey, TValue>`调用该方法，您的代码可能会严重崩溃。`OnAppInit`另一方面，如果您`OnAppInit`在 Application_Start 事件中仅调用此静态方法一次（保证仅从单个线程运行一次），那么您可以在那里使用它非常安全。

有人说静态变量和方法在应用程序中通常是一个坏主意，这是不正确的。如果您不知道如何正确使用它们，或者如果您不知道如何同步对它们的访问（如果您需要从并发线程完成此操作），那么它们是一个坏主意。编写线程安全代码是一个非常困难的主题，如果您担心会出错（在编写多线程应用程序如 ASP.NET 应用程序时谁不会出错？），请不要像这样共享状态。在 ASP.NET 应用程序中为此使用完善的位置：

*   后端（例如可以是关系数据库）
*   应用状态
*   缓存
*   Http 上下文状态
*   会话状态
*   客户端 cookie

Those places are specifically designed for storing state in an ASP.NET application (except the first one of course which could be used in any type of application).

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-08T22:28:55.743

静态变量将在请求之间共享。此外，它们将在应用程序启动时被初始化，因此如果 AppDomain，即应用程序重新启动，它们的值将被重新初始化。

# javascript - Adobe Acrobat Javascript 中带有速记字符类的正则表达式错误

> ID：14225116
> 
> 赞同：2
> 
> 时间：2013-01-08T22:25:59.883
> 
> 标签：javascript, regex, acrobat

考虑以下代码段：

```
var regex = /^\d+$/; // equivalent to new RegExp('^\\d+$');

console.println(regex.test('000'));  
console.println(regex.test('abc0')); 
console.println(regex.test('ddd')); 
```

人们会期望输出是：

```
true
false
false 
```

但是，当我在运行 JavaScript 1.8 的 Adob​​e Acrobat X 上运行它时，它会输出：

```
false
false
true 
```

这里发生了什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-08T22:33:32.240

这可能是在通往 Javascript 解释器的途中进行字符串处理的结果，导致您`\d`被解释为`d`. 一个额外的反斜杠（显然）可以解决问题。

```
/^\\d+$/ 
```

# uiviewcontroller - UICollectionView 单元格自动旋转

> ID：14225123
> 
> 赞同：1
> 
> 时间：2013-01-08T22:26:49.807
> 
> 标签：uiviewcontroller, ios6, uicollectionview, uicollectionviewlayout

我有一个 UICollectionView，它具有水平滚动的默认 Flow 布局。当我旋转设备时，单元格相互重叠。

当我旋转回初始启动方向时，布局会自行修复。

我试过在 didRotate~ 方法中调用 invalidateLayout 和 reloadData ，都没有影响。

有任何想法吗？

干杯!

# python - py2exe 与 scipy.sparse.sparsetools.csr

> ID：14225124
> 
> 赞同：1
> 
> 时间：2013-01-08T22:26:51.787
> 
> 标签：python, python-2.7, scipy, py2exe

我使用 python v2.7.3 和 scipy v0.11.0 和 py2exe v0.6.9 收到以下错误消息：

ImportError：没有名为 _csr 的模块

我的 setup.py：

```
from distutils.core import setup
import py2exe

setup(console=['demo.py'],
  options = {
             "py2exe": {"includes":["scipy.sparse", "scipy.sparse.sparsetools.csr",
                                    "scipy.sparse.sparsetools._csr"]}
             }) 
```

[py2exe 的 scipy](https://stackoverflow.com/questions/14215303/scipy-with-py2exe)问题 无法帮助我。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-15T07:40:18.560

我可以想到为什么您可能会收到此错误的原因有两个。

1.  `_csr.pyd`平时应该住在`\Python2.7\Lib\site-packages\scipy\sparse\sparsetools`。可能由于某种原因它不存在 - 一个简单的修复可能是重新安装`Scipy`。
2.  在调用 期间`setup`，会生成一个`scipy.sparse.sparsetools._csr.py`文件。此文件调用`imp.load_dynamic`，尝试加载 PYD 文件。此函数可能会抛出`ImportError`，这可能是文件丢失的症状。

如果这不能解决问题，如果您可以发布输出（即打印到 DOS 提示符的内容），那就太好了`python setup.py py2exe`- 这应该有助于缩小范围。

# text - 将 nav-pill 与文本对齐

> ID：14225126
> 
> 赞同：1
> 
> 时间：2013-01-08T22:27:30.710
> 
> 标签：text, twitter-bootstrap, alignment, nav

我要做的是将导航药丸与常规文本对齐，以便两者中的文本在同一行。

目前，它看起来像这样：http: [//i.imgur.com/87fta.png](http://i.imgur.com/87fta.png)

这是代码（HTML）：

```
<ul class='nav nav-pills'>
    <li class='pull-left'>
        Hello <a>World</a>
    </li>
</ul> 
```

CSS：

```
.pull-left {
    float:left;
}
.nav-pills>li>a {
    padding-top:8px;
    padding-bottom:8px;
    margin-top:2px;
    margin-bottom:2px;
    -webkit-border-radius:5px;
    -moz-border-radius:5px;
    border-radius:5px;
} 
```

我如何使两者中的文本在同一行？

谢谢！

# javascript - 节点：并排提供 CoffeeScript 和 JavaScript 文件

> ID：14225138
> 
> 赞同：0
> 
> 时间：2013-01-08T22:28:01.687
> 
> 标签：javascript, node.js, coffeescript, express

我有一个使用 Node 和 Express 运行的简单 Web 应用程序。我开始用 js 编写应用程序，但想过渡到咖啡。我想在我`file1.js`的`file2.coffee`应用程序中并排坐下（两者都用作 js），这样我就可以毫不费力地放入第三方客户端脚本。

我找到了连接资产，但它似乎与我的框架 Express 发生了某种冲突。Express 不想在`./assets`目录中提供文件。我可以放弃 Express，但我需要有充分的理由。

我可以将哪些资产管道放入 Express（或其他框架，如果需要），让我并排保存 .js 和 .coffee 文件？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-08T22:32:15.030

[Connect-assets](https://github.com/TrevorBurnham/connect-assets)应该能够做到这一点。

将此添加到您的`app.js`或`server.js`您称之为主`.js`文件的任何内容的顶部：

```
require('coffee-script'); 
```

这将导致节点为您编译咖啡脚本。它还允许您在应用程序的任何位置混入咖啡脚本和 javascript 文件，而不必担心再次编译。

确保执行以下操作：

*   `npm install coffee-script`在命令行

*   `!= js('script1')`在您的 layout.jade 中使用。

*   `app.use(require('connect-assets')());`在 app.configure 调用后的 app.js 中。

Connect-assets 默认在`/assets/js`. 此外，资产在被视图调用之前不可用，因此对已编译资产执行 curl 将得到 404，除非它作为视图的一部分被调用。

# batch-file - 使用命令行我想看看是否存在文件列表

> ID：14225139
> 
> 赞同：2
> 
> 时间：2013-01-08T22:28:03.407
> 
> 标签：batch-file, dos

我有一个带有文件名列表的文本文件&我想搜索“如果不存在”&如果命令没有找到 listimagescopy.txt 文件中提到的任何文件，它应该创建一个新的文件 notfound.txt，它将列出所有未找到的文件

我开始试图弄清楚，但我不太好 w cmd- 对此影响的一些东西 - 粘贴到 .cmd 文件中

```
@echo off

FOR /F "tokens=*" %%a IN (listimagescopy.txt) DO (
 IF NOT EXIST "%%a" echo %%a Not found >notfound.txt
) 
```

我不确定如何和在哪里指定它应该在哪个文件夹中搜索 - 还需要它在子文件夹中查找也许我需要使用嵌套 FORs w FOR /R ...我不确定

（我发现了一个类似的问题，但没有一个答案能满足我的需要——[如何测试文件列表是否存在？](https://stackoverflow.com/q/150762/1943698)）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-08T23:46:58.033

您实际上做对了一切，但缺少细节。这是一个有效的脚本，它可能有一些包含空格的路径的错误尚未测试）：

```
@echo off

SETLOCAL

SET fileList=%1
SET notFoundFile=%2

REM clear the not found file

type NUL > %notFoundFile%

FOR /R %%d IN (.) DO (
   FOR /F "tokens=*" %%a IN (%fileList%) DO (

      ECHO processing "%%~fd\%%a"
      IF NOT EXIST "%%~fd\%%a" ECHO %%~fd\%%a Not found >> %notFoundFile%
   )
) 
```

**用法**

该命令从当前目录递归搜索文件。它接受两个参数：第一个是包含要搜索的文件列表的文件的完整路径，第二个是记录未找到文件的文件的完整路径。

例如，假设：

1.  上面的批处理存储在c:\batchdir目录下的文件findmissing.cmd中（即批处理文件的完整路径是c:\batchdir\findmissing.cmd）
2.  要查找的文件列表在文件中列出：c:\batchdir\listimagescopy.txt
3.  包含“未找到”文件列表的结果文件将是：c:\batchdir\notfound.txt

然后为了搜索目录 c:\searchdir 及其所有子目录中的文件，您需要 CD 到该目录并运行：

```
c:\searchdir> \batchdir\findmissing.cmd \batchdir\listimagescopy.txt \batchdir\notfound.txt 
```

**这是怎么回事**

批处理文件将第一个参数（示例中的 \batchdir\listimagescopy.txt）存储在参数变量 %1 中，第二个参数（示例中的 \batchdir\notfound.txt）存储在 %2 中（如果存在其他参数，则存储 %3 %4 等）

```
SET fileList=%1
SET notFoundFile=%2 
```

将命令行参数存储在本地（由于上面的 SETLOCAL）环境变量中。这只是为了方便使用更好的变量名。使用例如 %fileList% 在批处理中扩展（访问）环境变量。

```
type NUL > %notFoundFile% 
```

清除“未找到”文件的内容或创建一个新的零长度文件（如果不存在）。这很重要，因为我们将附加到这个文件并且不希望不同运行的结果存在。

```
FOR /R %%d IN (.) DO ( 
```

从当前目录开始，并通过与 (.) 匹配来递归列出所有目录。目录名称放在 for 循环变量 %%d

```
 FOR /F "tokens=*" %%a IN (%fileList%) DO ( 
```

执行您在问题中描述的内容，它将 fileList 中的每一行存储在 for 变量 %%a 中

现在有趣的部分 %%d 包含循环中的当前目录，包括结尾的“。” 例如：

```
%%d = "c:\searchdir\." 
```

使用 ~f 选项访问变量会删除尾随的 '.'

%%~fd = "c:\searchdir"

%%a 包含您正在搜索的文件之一的名称：

```
%%a = "image001.jpg" 
```

然后：

```
%%~fd\%%a = "c:\searchdir\image001.jpg" 
```

这些行现在应该很明显：

```
 ECHO processing "%%~fd\%%a"
      IF NOT EXIST "%%~fd\%%a" ECHO %%~fd\%%a Not found >> %notFoundFile% 
```

但无论如何我都会解释它们；第一个只是告诉你批次在做什么。它可以被删除以加快速度（相当大。）第二个测试文件 %%~fd\%%a 是否存在，如果不存在，则附加（即 >>，使用 > 覆盖）字符串 "%%~fd\ %%a Not found" 到文件 %notFoundFile%，在展开变量后，您会得到文件中未找到的文件的实际名称。

您可以通过将 %%~fd\%%a 的内容放在变量中而不是重复模式来使内部循环更好，但是您需要延迟扩展，请参见[此处](http://www.robvanderwoude.com/variableexpansion.php)和[此处](https://stackoverflow.com/questions/5615206/windows-batch-files-setting-variable-in-for-loop)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-09T09:40:54.370

这会将列表中未在任何子文件夹中找到的所有文件输出到文件中`notfound.txt`

```
setlocal enabledelayedexpansion
pushd "N:\opasdata\d110001\medias\images"
set found=false
for /f "tokens=* delims=" %%a in (listimagescopy.txt) do (
for /r %%x in (%%a) do (
if exist "%%a" set found=true
)
if "!found!"=="false" echo %%a >>"V:\Current Library\notfound.txt"
set found=false
) 
```

# vb.net - Dim Blah 作为新 GeckoWebBrowser

> ID：14225142
> 
> 赞同：0
> 
> 时间：2013-01-08T22:28:14.103
> 
> 标签：vb.net, visual-studio-2010, browser

我将壁虎网络浏览器元素添加到`VBExpress`. 当我手动将它放入设计器时，该组件工作得很好，但是当使用`Dim Browser`As时`New GeckoWebBrowser`，它表示该类`GeckoWebBrowser`未声明。我该如何解决这个问题才能真正起作用？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-09T14:38:04.830

仅仅因为它在您的工具箱中并不意味着它实际上在您的应用程序中可用。

确保您在项目的参考中包含了所需的组件。见这里： http: [//msdn.microsoft.com/en-us/library/wkze6zky (v=vs.100).aspx](http://msdn.microsoft.com/en-us/library/wkze6zky(v=vs.100).aspx)

此外，请确保在代码中导入所需的程序集：

```
Imports Skybound.Gecko 
```

这是一个非常简单的小方法：[http ://bpforums.info/viewtopic.php?f=8&t=284](http://bpforums.info/viewtopic.php?f=8&t=284)

# ios - 使用 insertRowAtIndexPath 调整 UITableViewCell 高度

> ID：14225144
> 
> 赞同：0
> 
> 时间：2013-01-08T22:28:20.877
> 
> 标签：ios, xcode, cocoa-touch, uitableview

我有一个表格，其中，当用户点击一个单元格时，一个详细单元格会在其正下方下降。我已经想出了如何使用`insertRowAtIndexPath`来实现这一点，但是细节单元格的行高高于正常单元格的行高。我已经尝试过`heightForRowAtIndexPath`，但这似乎只在初始加载视图（或使用`reloadData`）时被调用。但是，我不希望将详细信息单元格添加到表格视图的数据中，这消除`reloadData`了一种可能性，因此`heightForRowAtIndexPath`. 我确实有一个自定义`UITableViewCell`子类为`ItemDetailCell`. 我认为这可能会从情节提要中的关联单元格加载指定的行高，但这似乎不起作用。这就是我尝试的方式`cellForRowAtIndexPath`：

```
if (indexPath.row == _detailCellIndexPath.row && _detailCellIndexPath) {
    NSLog(@"detailCell");

    ItemDetailCell *detailCell = [tableView dequeueReusableCellWithIdentifier:DetailCellIdentifier forIndexPath:_detailCellIndexPath];

    //customize cell

    return detailCell;
}
else {
    CustomCell *cell = [tableView dequeueReusableCellWithIdentifier:CellIdentifier forIndexPath:indexPath];

    //customize cell

    return cell;
} 
```

我确实`NSLog(@"detailCell")`在控制台中得到了返回，所以我知道它被调用了，但它仍然没有调整单元格的高度。

任何帮助是极大的赞赏！提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-08T23:50:34.357

`heightForRowAtIndexPath`也被称为

```
[self.tableView beginUpdates];
[self.tableView endUpdates]; 
```

您是否有任何理由不想将单元格添加到您的支持集合中？最简单的解决方案是将特定项目添加到您的表视图支持数组，然后在块`insertRowAtIndexPath`内部进行调用。`beginUpdates` `endUpdates`这将触发标准委托/数据源表视图方法（`heightForRowAtIndexPath`包括），因此您可以根据具体的 UITableViewCell 类（`ItemDetailCell`或`CustomCell`）返回不同的大小。

# git - 如何知道 git 工作区中更改的所有文件的列表

> ID：14225145
> 
> 赞同：0
> 
> 时间：2013-01-08T22:28:23.363
> 
> 标签：git, gerrit

以下是我`git`计划自动化的工作流程

1.  克隆到外部项目
2.  Cherry-pick 一个 gerrits 列表，一旦 cherypicked 如果cherrypick 成功，这些将自动提交
3.  现在对于步骤2中更改的文件列表，我需要打开它们并运行脚本来修改每个文件的内容

我需要有关如何知道已更改文件列表以及如何打开它们的想法，请提供您的输入。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-09T04:09:50.730

创建创建分支的步骤 1a - `git branch temp`。

对于第 3 步，要获取已修改文件的列表，请运行`git diff --name-only temp`以查看自创建 temp 以来已更改的所有内容的文件名。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-06-27T06:33:54.753

我是 gerrit 系统的新手，但我认为 - git diff - 也可以做同样的事情。此外，它还说明了两个文件内容的差异。

不幸的是，到目前为止，gerrit 还没有可用的 eclipse 插件。

-- git status 您运行 git status 以查看自上次提交以来是否有任何内容被修改和/或暂存，因此您可以决定是否要提交新快照以及将在其中记录的内容。

这将显示所有修改过的文件。

参考[http://www.mediawiki.org/wiki/Gerrit/Tutorial](http://www.mediawiki.org/wiki/Gerrit/Tutorial)

# php - Symfony2 捆绑重用和路由

> ID：14225151
> 
> 赞同：0
> 
> 时间：2013-01-08T22:28:50.027
> 
> 标签：php, symfony

几天前我开始用 SF2 写个人博客。我正在编写后端代码，并注意可重用性。

此刻，我有 2 个捆绑包：`AdminBundle`和`ArticleBundle`. 我写了一些方法到`ArticleBundle`like `addAction`,,`listAction`等等中。这个模块也有自己定义的路由（article/add,article/edit）在他的`routing.yml`

当我在我的 AdminBundle 的一部分（例如：admin/article/add）中时，我会这样做`AdminController`：

```
public function addAction() {
    return $this->render('AdminBundle:Admin:add_article.html.twig');
} 
```

在我的`add_article.html.twig`：

```
{% block admin_content %}        // Inheritance of admin view
{% render url('article_add') %}  // article_add = article/add = route in ArticleBundle
{% endblock %} 
```

这部分工作得很好，但是在渲染后一切都由管理`ArticleBundle`并且我的路由变坏了（例如：在我的表单提交路由是'article/add'而不是'admin/article/add'之后）。

所以我不知道如何将这两个捆绑在一起，记住`ArticleBundle`必须是可重用的。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-09T09:27:38.637

您可以在 ArticleBundle 中将您的操作设置为服务，然后使用（例如）从您的管理员或其他 Bundle 中引用这些服务

```
$form = $this->get('kero_zen.article_bundle.add_action.form');
$formHandler = $this->get('kero_zen.article_bundle.add_action.handler'); 
```

类似于 FOSUserBundle 中的控制器。

# javascript - Jquery slideDown/slideUp 代码仅在 CTRL+F5 后有效？

> ID：14225152
> 
> 赞同：0
> 
> 时间：2013-01-08T22:28:50.960
> 
> 标签：javascript, jquery, dom, internet-explorer-9

这个问题已经困扰了我好几个小时，我希望有人能帮助我。

我有以下代码，它打开和关闭递归 UL 菜单。它适用于任何地方，除了 IE9。但是，它仅在我使用 CTRL+F5 刷新页面时才有效。如果我不使用 CTRL+F5 刷新，我会收到一堆错误，如下所示：

*   SCRIPT5022：DOM 异常：SYNTAX_ERR (12)；（参考 if (currentLink)）
*   SCRIPT5022：DOM 异常：SYNTAX_ERR (12)；（参考 currentLink.parent().find）

有人知道这里发生了什么吗？

```
 $('.groups').find('li:has(ul)').find('.uitklapTrigger').click(function(){
    var currentLink = $(this);
    if (currentLink.parent().find('ul').first().is(":hidden")){
        currentLink.children('.plmin').html('-');
        currentLink.parent().find('ul').first().slideDown('slow');
    } else {
        currentLink.parent().find('ul').first().slideUp("slow", function(){
            currentLink.children('.plmin').html('+');
        });
    }

    return false;
}); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-21T15:07:10.083

答案很明确。它与某些 IE9 设置有关。奇迹般地，我测试过的电脑都有一些奇怪的（宏碁出厂默认）浏览器设置。我已重置浏览器设置，问题已解决...谢谢大家。

# ruby-on-rails - 如何找到具有多个“has_one”关联的正确记录？

> ID：14225153
> 
> 赞同：0
> 
> 时间：2013-01-08T22:28:51.990
> 
> 标签：ruby-on-rails, ruby

我是一个相当新的 Rails 开发人员，我有一个现有的应用程序，我正在尝试向（Ability）添加一个新模型，该模型与现有模型（Champion）有关联。按照我理解“has_one”和“belongs_to”机制的方式，我将它设置为对我来说在逻辑上有意义的方式，但是对于每个冠军中的每个 has_one 关系，我只能获得相同的一个记录。

这是设置：

现有模型称为 Champion，我正在创建一个新的 Ability 模型，它是 Champion 模型的一部分。我想组织 Champion 模型，使其具有 5 个能力，分别名为“q”、“w”、“e”、“r”和“passive”。每种能力只属于一个英雄。

`champion_id`这是我的迁移，它为 belongs_to 关联添加了一个新的 Ability 对象：

```
class CreateAbilities < ActiveRecord::Migration
  def change
    create_table :abilities do |t|
      t.integer :champion_id
      t.timestamps
    end
  end
end 
```

以下是将能力引用添加到 Champion 模型的迁移：

```
class AddAbilitiesToChampions < ActiveRecord::Migration
  def change
    add_column :champions, :q, :integer
    add_column :champions, :w, :integer
    add_column :champions, :e, :integer
    add_column :champions, :r, :integer
    add_column :champions, :passive, :integer
  end
end 
```

能力.rb模型：

```
class Ability < ActiveRecord::Base
  attr_accessible :ability_description,
                  :cost,
                  :effect,
                  :cooldown,
                  :range,
                  :name,
                  :icon,
                  :champion_id

  belongs_to :champion
end 
```

Champion.rb 模型：

```
class Champion < ActiveRecord::Base
  attr_accessible :champion_id,
                  :q,
                  :w,
                  :e,
                  :r,
                  :passive

  has_one :q, :class_name => "Ability"
  has_one :w, :class_name => "Ability"
  has_one :e, :class_name => "Ability"
  has_one :r, :class_name => "Ability"
  has_one :passive, :class_name => "Ability"
end 
```

现在，我有一个*似乎*可以正确创建关系的模型，但是当我在服务器上查看输出时，它为每个能力关联执行相同的选择语句，并且每次都选择相同的记录。

```
Started GET "/champions.json" for 127.0.0.1 at 2013-01-08 15:13:30 -0700
Processing by ChampionsController#index as JSON
  Champion Load (0.5ms)  SELECT "champions".* FROM "champions" 
  Item Load (0.4ms)  SELECT "items".* FROM "items" 
  Spell Load (0.3ms)  SELECT "spells".* FROM "spells" 
  Mastery Load (0.3ms)  SELECT "masteries".* FROM "masteries" 
  CACHE (0.0ms)  SELECT "champions".* FROM "champions" 
  Ability Load (0.6ms)  SELECT "abilities".* FROM "abilities" WHERE "abilities"."champion_id" = 1 LIMIT 1
  CACHE (0.0ms)  SELECT "abilities".* FROM "abilities" WHERE "abilities"."champion_id" = 1 LIMIT 1
  CACHE (0.0ms)  SELECT "abilities".* FROM "abilities" WHERE "abilities"."champion_id" = 1 LIMIT 1
  CACHE (0.0ms)  SELECT "abilities".* FROM "abilities" WHERE "abilities"."champion_id" = 1 LIMIT 1
  CACHE (0.0ms)  SELECT "abilities".* FROM "abilities" WHERE "abilities"."champion_id" = 1 LIMIT 1
  Ability Load (0.2ms)  SELECT "abilities".* FROM "abilities" WHERE "abilities"."champion_id" = 2 LIMIT 1
  CACHE (0.0ms)  SELECT "abilities".* FROM "abilities" WHERE "abilities"."champion_id" = 2 LIMIT 1
  CACHE (0.0ms)  SELECT "abilities".* FROM "abilities" WHERE "abilities"."champion_id" = 2 LIMIT 1
  CACHE (0.0ms)  SELECT "abilities".* FROM "abilities" WHERE "abilities"."champion_id" = 2 LIMIT 1
  CACHE (0.0ms)  SELECT "abilities".* FROM "abilities" WHERE "abilities"."champion_id" = 2 LIMIT 1
Completed 200 OK in 111ms (Views: 47.4ms | ActiveRecord: 12.8ms) 
```

如何修改我的设置，以便 select 语句为这些属性中的每一个选择正确的能力？我已经尝试过反转关系但没有取得多大成功。任何帮助表示赞赏！

编辑：这是我的 Champions_controller.rb 中的代码，它为模型提供 JSON：

```
class ChampionsController < ApplicationController
  before_filter :find_champions

  def find_champions
    @champions = Champion.all
  end

  def index
    respond_to do |format|
      format.json { render :json => { "champions" => @champions }}
    end
  end
end 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-08T22:54:06.427

在 Champion 模型中尝试一下。使用belongs_to，foreign_key 将在您定义关系的模型上，has_one 将在您关联的模型中查找。

```
belongs_to :q, :class_name => "Ability", :foreign_key => "q" 
belongs_to :w, :class_name => "Ability", :foreign_key => "w"
belongs_to :e, :class_name => "Ability", :foreign_key => "e" 
belongs_to :r, :class_name => "Ability", :foreign_key => "r" 
```

[更多信息](http://guides.rubyonrails.org/association_basics.html#the-belongs_to-association)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-08T22:31:42.660

您应该将 foreign_key 选项添加到您的冠军模型中：

```
has_one :q, :class_name => "Ability", :foreign_key => "q" 
has_one :w, :class_name => "Ability", :foreign_key => "w"
has_one :e, :class_name => "Ability", :foreign_key => "e" 
has_one :r, :class_name => "Ability", :foreign_key => "r" 
```

# zend-framework - Godaddy服务器上的Zend错误

> ID：14225157
> 
> 赞同：0
> 
> 时间：2013-01-08T22:29:13.403
> 
> 标签：zend-framework

我不习惯 Zend 框架，我正在将我的服务器更改为 godaddy 托管，我也更改了域名。上传文件后，我在 www.abc.com 上收到此错误，而在其他主机上它工作正常。

我的根目录如下所示：

```
application
htdocs
library
-Zend 
```

请帮我解决这个错误：

```
Warning: require_once(Zend/Application.php) [function.require-once]: failed to open stream: No such file or directory in /home/content/37/10289737/html/index.php on line 17
Fatal error: require_once() [function.require]: Failed opening required 'Zend/Application.php' (include_path=':.:/usr/local/php5_3/lib/php') in /home/content/37/10289737/html/index.php on line 17 
```

我的 index.php 文件看起来像这样

```
<?php
// Define path to application directory
defined('APPLICATION_PATH')
|| define('APPLICATION_PATH', realpath(dirname(__FILE__) . '/../application'));

// Define application environment
defined('APPLICATION_ENV')
  || define('APPLICATION_ENV', (getenv('APPLICATION_ENV') ?              getenv('APPLICATION_ENV') : 'production'));

  // Ensure library/ is on include_path
set_include_path(implode(PATH_SEPARATOR, array(
realpath(APPLICATION_PATH . '/../library'),
get_include_path(),
 )));

/** Zend_Application */
require_once 'Zend/Application.php';

// Create application, bootstrap, and run
 $application = new Zend_Application(
APPLICATION_ENV,
   APPLICATION_PATH . '/configs/application.ini'
   );

     $options = $application->getOptions();
       $db = Zend_Db::factory($options['resources']['db']['adapter'], array(
'host' => $options['resources']['db']['params']['host'],
 'username' => $options['resources']['db']['params']['username'],
 'password' => $options['resources']['db']['params']['password'],
   'dbname' => $options['resources']['db']['params']['dbname']
     ));

//$db=Zend_Db_Table::getDefaultAdapter();

$db->beginTransaction();
   $sql = file_get_contents(APPLICATION_PATH . '/data/data.sql');
 $db->query($sql);
 $db->commit();

 $application->bootstrap()
   ->run(); 
```

而且我无法找到该`php.ini`文件。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-09T12:19:06.997

您正在尝试将路径添加到您的 include_path：

```
set_include_path(implode(PATH_SEPARATOR, array(
    realpath(APPLICATION_PATH . '/../library'),
    get_include_path(),
))); 
```

看，这是来自您的错误信息：

```
include_path=':.:/usr/local/php5_3/lib/php' 
```

所以下面的代码不起作用

```
realpath(APPLICATION_PATH . '/../library') 
```

你的 index.php 文件在哪里？在 htdocs 目录中？也许godaddy不授予php脚本访问htdocs下文件的权限？

# php - 尝试克隆 Magento 1.4.x 站点进行开发，如何调试死机白屏？

> ID：14225158
> 
> 赞同：1
> 
> 时间：2013-01-08T22:29:15.283
> 
> 标签：php, magento-1.4

我有完整的 shell 访问权限和 phpMyAdmin，我需要让这个站点在开发域/新路径上工作（远程服务器，也托管生产站点）。值得注意的是，我*没有*服务器错误日志。

值得指出的是，我很幸运能够让它在我的本地服务器上运行，我了解更新表中不安全和安全的 basurl `core_config_data`，但我似乎无法让该站点在我们的远程开发服务器上运行，我只是得到白屏。（可以肯定的是，我已经尝试在 index.php 中提高我的 error_reporting 和 error_level ，没有改变任何东西......这就是我可以从网上收集到的所有信息，除了在管理员中启用它，这不是一个选项目前）。

好的，提前谢谢，任何建议表示赞赏。

编辑：到目前为止我所做的事情：

*   错误报告在 index.php 的顶部设置为`error_reporting(E_ALL); ini_set('display_errors', 'On');`
*   检查数据库中是否启用了日志记录（已经启用）
*   我能够死/回显输出（使用类似的东西`die('arf');`）直到 index.php 脚本的最后一行，它执行的地方`Mage::run($mageRunCode, $mageRunType);`我没有深入到那个过程，我确定它只是直接进入核心 &我的问题可能在其他地方。
*   启用`Mage::setIsDeveloperMode(true);`
*   没有新文件被写入 var/report

* * *

编辑#2：djot 下面的回答让我朝着正确的方向前进，并给了我一些输出。实际上有 7800 行，所以这是它结束前的最后几行，稍后我会在有时间进一步了解它之后更新它：

```
File: /var/www/vhosts/somesite.com/subdomains/dev/httpdocs/shop/errors/processor.php[472]<br>
<script type="text/javascript">File: /var/www/vhosts/somesite.com/subdomains/dev/httpdocs/shop/errors/processor.php[475]<br>
window.location.href = 'http://dev.somesite.com/shop/errors/report.php?id=498275850056&skin=default';File: /var/www/vhosts/somesite.com/subdomains/dev/httpdocs/shop/errors/processor.php[476]<br>
</script>File: /var/www/vhosts/somesite.com/subdomains/dev/httpdocs/shop/errors/processor.php[477]<br> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-08T22:42:41.773

使用特殊行、断点处的打印或回声可以调试死机白屏。不幸的是，如果你有很多代码，这很烦人。因此，一种解决方案是“勾选”每一行，直到 php 崩溃。

```
declare(ticks=1);
register_tick_function('TickLine', TRUE);

function TickLine() {
  $backtrace = debug_backtrace();
  echo 'File: ' . $backtrace[0]['file'] . '[' . $backtrace[0]['line'] . ']<br>';
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-08T22:38:20.180

以下是您可以采取的一些步骤：

*   确保启用 PHP 错误报告。[PHP 生产服务器 - 打开错误消息](https://stackoverflow.com/questions/1824282/php-production-server-turn-on-error-messages)
*   [查看如何在 Magento 数据库中启用 exception.log 和 system.log 中的](https://stackoverflow.com/questions/12043291/how-to-enable-exception-log-and-system-log-in-magento-database)Magento 错误日志？`var/logs`
*   试试`var_dump("Something, Please!")`index.php 的第一行
*   如果您仍然什么也看不到，那么问题可能出在 PHP 配置 / apache 上

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-08T22:59:39.113

在 index.php 文件中查找以下行：

```
if (isset($_SERVER['MAGE_IS_DEVELOPER_MODE'])) {
    Mage::setIsDeveloperMode(true);
} 
```

做了：

```
if (isset($_SERVER['MAGE_IS_DEVELOPER_MODE']) || true) {
    Mage::setIsDeveloperMode(true);
} 
```

另外，清除 var/report （至少在 1.6 中是这样），然后刷新，应该会出现一个新错误。

如果您需要更多想法，请告诉我。

# c++ - 内存分配和 Try-Catch 块

> ID：14225160
> 
> 赞同：0
> 
> 时间：2013-01-08T22:29:23.517
> 
> 标签：c++, memory-management

我有一个函数来分配一个二维数组，以便不消耗比我需要的更多的内存：

_>

```
template <class Xvar> Xvar** New2 (unsigned int rows,unsigned int cols)
{
    Xvar**  mem;
    unsigned int size, i;

    size = rows * cols;
    mem = new Xvar* [rows];
    mem [0] = new Xvar [size];
    for (i=1;i<rows;i++)
        mem [i] = &mem [0][i*cols];
    return mem;
} 
```

现在，我需要检查该内存是否已分配。（处理内存分配错误），而不会降低函数的性能。

我应该为每个内存分配使用一个 try-catch 块，还是只为函数使用一个唯一的 try-catch 块。

```
template <class Xvar> Xvar** New2 (unsigned int rows,unsigned int cols)
{
    Xvar**  mem;
    unsigned int size, i;

    size = rows * cols;
    try {
    mem = new Xvar* [rows];
    }
    catch (...) { assert (...) } 
    try {
    mem [0] = new Xvar [size];
    } catch (...) { assert (...) }
    for (i=1;i<rows;i++)
        mem [i] = &mem [0][i*cols];
    return mem;
} 
```

或类似的东西：

```
template <class Xvar> Xvar** New2 (unsigned int rows,unsigned int cols)
{
    try { 
    Xvar**  mem;
    unsigned int size, i;

    size = rows * cols;
    mem = new Xvar* [rows];
    mem [0] = new Xvar [size];
    for (i=1;i<rows;i++)
        mem [i] = &mem [0][i*cols];
    return mem;
     }catch  (...) { assert (...) }
} 
```

我认为，不推荐第二种方式，因为如果第一个 new 失败，mem 为 NULL，所以如果我们执行 mem [0] ，我们正在访问未分配的内存，因此应用程序此时失败，并且无法捕获错误。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-08T22:33:19.803

在第二种方式中，如果第一种方式`new`失败，那么评估会立即跳转到 catch 块，甚至不会尝试访问`mem[0]`.

在任何情况下，如果您想允许分配失败并轻松检测到这一点，您可能应该使用变体，如果分配失败`nothrow`，它只会返回。`NULL`所以像

```
mem = new (nothrow) Xvar*[rows];
if (!mem) {
    // allocation failed, do whatever you want
}
mem[0] = new (nothrow) Xvar[size];
if (!mem[0]) {
    // allocation failed, do whatever you want
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-08T22:55:48.463

根本不要捕获异常，只需在函数展开时使用 RAII 清理内存：

```
template <class Xvar> Xvar** New2 (unsigned int rows,unsigned int cols)
{
    unsigned int size = rows * cols;
    std::unique_ptr<Xvar*[]> mem(new Xvar* [rows]);
    mem[0] = new Xvar [size];
    for (i=1; i<rows; i++)
        mem[i] = &mem[0][i*cols];
    return mem.release();
} 
```

*   如果第一个`new`失败，你的函数没有做任何事情并且没有泄漏任何内存：`std::bad_alloc`被抛出，就是这样
*   如果第二个失败，`unique_ptr`析构函数会处理该内存，所以你又可以了。
*   接下来的三行不能抛出，所以没有什么可以导致第二个分配泄漏

* * *

正如 GmanNickG 所指出的，*这仍然是糟糕的代码*。这是您要求的糟糕代码，但我不想给人留下我认可原始设计的印象。我不。它是可怕的。

一旦调用者成功获取了他们的`Xvar**`，唯一的处理方法是：

```
int **ii = New2<int>(x, y);
...
delete [] ii[0];
delete [] ii; 
```

这是脆弱和不愉快的。两个更好的设计是：

1.  使用一个真正的矩阵/二维数组模板类来管理存储，并且可以按值返回。然后，当这个值对象超出范围时，内存将被回收

2.  使用带有自定义删除器的智能指针

    ```
    template <typename T> struct 2dDelete
    {
        void operator() (T **rows) {
            delete [] rows[0];
            delete [] rows;
        }
    };

    template <typename T>
    std::unique_ptr<T*[], 2dDelete<T>> 2dNew (unsigned rows, unsigned cols)
    {
        unsigned size = rows * cols;
        std::unique_ptr<Xvar*[]> tmp(new Xvar* [rows]);
        tmp[0] = new Xvar [size];
        for (i=1; i<rows; i++)
            tmp[i] = &tmp[0][i*cols];
        // hand-over from the intermediate pointer (which only owned the
        // top-level row allocation) to the caller's pointer (which will
        // own, and clean up, the whole thing).
        return std::unique_ptr<T*[], 2dDelete<T>> arr(mem.release());
    } 
    ```

# subquery - 查询错误“子查询返回超过 1 个值...”“IN”不应该解决这个问题吗？

> ID：14225164
> 
> 赞同：0
> 
> 时间：2013-01-08T22:29:41.770
> 
> 标签：subquery

我以前在这里得到了很大的帮助，所以我希望有人可以帮助我解决这个问题。谁能告诉我为什么查询 #1 会导致错误“子查询返回超过 1 个值...”但查询 #2 工作正常吗？由于我使用“IN”而不是“=”来限定结果，我认为多个值是可以接受的。

关于我如何做到这一点的任何建议？

```
--Query #1
SELECT _Column1_ from _View1_
WHERE
_Column2_ IN( CASE
WHEN ISNUMERIC(1000110) = 1 AND LEN(1000110) > 3
THEN (
SELECT  _Column2_
FROM    _Table1_
WHERE   _Column2_ = CONVERT(Int, LEFT(1000110, 4))
OR      _Column3_ = CONVERT(Int, LEFT(1000110, 4))
)
WHEN ISNUMERIC(1000110) = 1 AND LEN(1000110) <= 3
THEN 0
ELSE (SELECT _Column2_ from _Table1_)
END) 
```

注意：在最终查询中，1000110 实际上是一个用户名变量，可以返回一个数字用户名或字母数字

```
--Query #2
WHEN ISNUMERIC(1000110) = 1 AND LEN(1000110) > 3
THEN CONVERT(Int, LEFT(1000110, 4))
WHEN ISNUMERIC(1000110) = 1 AND LEN(1000110) <= 3
THEN 0
ELSE (SELECT _Column2_ from _Table1_)
END) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-08T22:32:59.960

`SELECT _Column2_ from _Table1_`最有可能返回多个结果。在这种情况下，只允许一个值。

作为测试尝试`SELECT TOP(1) _Column2_ from _Table1_`

# nvd3.js - 使用 NVD3.js 图表库向下钻取

> ID：14225167
> 
> 赞同：3
> 
> 时间：2013-01-08T22:29:49.947
> 
> 标签：nvd3.js

我有一个常规的柱形图，我希望能够单击一个列并向下钻取一组相关信息。此行为类似于 highcharts[演示](http://www.highcharts.com/demo/column-drilldown)如何进行向下钻取。有没有人能够在 nvd3.js 中实现这一点？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-17T18:10:28.370

您引用的 Highcharts 演示是浏览器市场份额的垂直条形图。当您单击其中一个浏览器时，将显示第二个垂直条形图，显示该浏览器每个版本的市场份额。单击版本将返回到上一个图表。

nvd3 模型使用 d3 的调度程序支持单击和悬停侦听器，您可以在此处阅读 d3 的 github wiki [1] 上的更多信息。

如果您浏览历史条形图的 nvd3 源，您可以看到调度程序的设置位置 [2]。

因此，您将编写一个在“elementClick”事件触发时调用的函数，该函数接受被单击的系列作为参数。现在您知道点击的系列，您可以切换数据并重新绘制图表。

我希望这会有所帮助，我花了一段时间来追踪 nvd3 如何使用单击和悬停侦听器。

这是一个在 nvd3 的首页上使用的调度程序的示例：

```
chart.stacked.dispatch.on('areaClick.updateExamples', function(e) {
        setTimeout(function() {
          mainExample.update();
          exampleOne.update();
          //exampleTwo.update();
          exampleThree.update();
        }, 100);
      }) 
```

[1] [https://github.com/mbostock/d3/wiki/Internals#events](https://github.com/mbostock/d3/wiki/Internals#events)

[2] [https://github.com/novus/nvd3/blob/master/src/models/historicalBar.js#L23](https://github.com/novus/nvd3/blob/master/src/models/historicalBar.js#L23)

# android - Android：确定通知是否被用户关闭

> ID：14225171
> 
> 赞同：12
> 
> 时间：2013-01-08T22:29:56.657
> 
> 标签：android, android-intent, notifications

我`NotificationManager.notify()`在倒数计时器应用程序中使用通知（

它工作得非常好，除非用户关闭通知（来自 JellyBeans+ 中的快速设置）。

如果通知选项已关闭，我想签入代码，因此我可以选择不同的警报方法。

令人惊讶的是，我没有找到有关该主题的信息，并且深入研究了 Android 代码，我在 中没有看到这样的选项`NotificationManager`，并且它默默地失败了。

有没有办法做到这一点？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2017-01-09T21:24:02.870

我的帖子很旧，但终于！在 API 19+ 的支持库中，现在有一个 API

> [NotificationManagerCompat.areNotificationsEnabled()](https://developer.android.com/reference/androidx/core/app/NotificationManagerCompat#areNotificationsEnabled())

# scheme - 这个方案错误告诉我什么？

> ID：14225173
> 
> 赞同：2
> 
> 时间：2013-01-08T22:29:59.893
> 
> 标签：scheme, guile, meep

存在一个称为 meep 的电磁模拟器，它以狡猾的解释器形式提供前端。模拟器由一堆方案宏组成。

我试图弄清楚以下错误的含义。代码取自教程。当我将教程包装在一个过程中时，我得到一个运行时错误，我不确定解释器（诡计）告诉我什么。

**不工作的代码**

```
(define diffthick
  (lambda (n) ; n doesn nothing
    (
     (set! geometry-lattice (make lattice (size 16 8 no-size)))
     (set! geometry (list
                      (make block (center 0 0) (size infinity 1 infinity)
                            (material (make dielectric (epsilon 12))))))
     (set! sources (list
                     (make source
                           (src (make continuous-src (frequency 0.15)))
                           (component Ez)
                           (center -7 0))))
     (set! pml-layers (list (make pml (thickness 1.0))))
     (set! resolution 10)
     (run-until 200
                (at-beginning output-epsilon)
                (at-end output-efield-z))
     )
    )
  )
(diffthick 3) 
```

**工作代码（无程序）**

```
(set! geometry-lattice (make lattice (size 16 8 no-size)))
(set! geometry (list
                (make block (center 0 0) (size infinity 1 infinity)
                      (material (make dielectric (epsilon 12))))))
(set! sources (list
               (make source
                 (src (make continuous-src (frequency 0.15)))
                 (component Ez)
                 (center -7 0))))

(set! pml-layers (list (make pml (thickness 1.0))))
(set! resolution 10)
(run-until 200
           (at-beginning output-epsilon)
           (at-end output-efield-z)) 
```

**错误**

```
creating output file "./eps-000000.00.h5"...
creating output file "./ez-000200.00.h5"...
run 0 finished at t = 200.0 (4000 timesteps)

Backtrace:
In standard input:
  21: 0* [diffthick 3]
   3: 1  [#<unspecified> #<unspecified> #<unspecified> ...]

standard input:3:5: In expression ((set! geometry-lattice #) (set! geometry #) (set! sources #) ...):
standard input:3:5: Wrong type to apply: #<unspecified>
ABORT: (misc-error) 
```

**在职的**

```
-----------
creating output file "./eps-000000.00.h5"...
creating output file "./ez-000200.00.h5"...
run 0 finished at t = 200.0 (4000 timesteps) 
```

在一天结束的时候，我觉得某事被评估了两次。但我不确定那是什么东西。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-08T23:00:33.610

该错误表示代码正在尝试应用结果，`(set! geometry-lattice #)`就好像它是一个函数一样，但`set!`结果却`#<unspecified>`相反。发生这种情况是因为`set!`s 系列被包裹在括号中。

您可能正在寻找

```
(begin
  (set! geometry-lattice ...)
  ...
  (run-until ...)) 
```

或者干脆去掉那对额外的括号，因为 lambda 主体隐含地包裹在`begin`.

# actionscript-3 - 将动作脚本从时间线移动到外部 .as 文件

> ID：14225176
> 
> 赞同：-1
> 
> 时间：2013-01-08T22:30:04.817
> 
> 标签：actionscript-3, actionscript

我遇到了一个严重的问题，因为我对 as3 不太了解。

我在时间轴第一帧的项目中有一个动作脚本代码，代码是：

```
stop();

    import flash.display.BitmapData;
    import flash.display.SimpleButton
    import flash.display.Bitmap;
    import flash.display.Loader;
    import flash.display.MovieClip;
    import flash.errors.IOError;
    import flash.events.ProgressEvent;
    import flash.net.FileFilter;
    import flash.net.FileReference;
    import flash.net.URLVariables;
    import flash.text.TextField;
    import flash.text.TextFieldType;
    import flash.utils.ByteArray;

    import flash.events.MouseEvent;
    import flash.events.Event;
    import flash.display.StageAlign;
    import flash.display.StageScaleMode;

    import flash.net.URLLoader;
    import flash.net.URLRequest;
    import flash.net.URLRequestMethod;
    import flash.net.URLLoaderDataFormat;
    import flash.net.URLRequestHeader;
    import flash.geom.ColorTransform;

    import flash.geom.Matrix;
    import flash.display.LoaderInfo;
    import flash.events.IOErrorEvent;
    import flash.events.SecurityErrorEvent;

import com.drooza.*;
import caurina.transitions.Tweener;

const thumbWidth:int = 90;
const numThumbsShown:int = 5;

var thumb_array:Array = [];
var thumbContainer:Sprite = new Sprite(), 
    pictureContainer:Sprite = new Sprite();

var leftMostThumb:int = 0; //for sliding thumbs
var currentThumb:int = 0;
var thumbsXML:XMLReader = new XMLReader("gallery.xml");

var thumbcurrentThumbList:XMLList;
var pictureLoader:Loader;

//var _browseBtn: SimpleButton;

thumbsXML.init();
thumbsXML.addEventListener(Event.COMPLETE, thumbCompleteHandler);

pictureContainer.addEventListener(MouseEvent.CLICK, gotoLargePicture);
pictureContainer.buttonMode = true;
pictureContainer.mouseChildren = false;
pictureContainer.x = 10;
pictureContainer.y = 10;

addChild(pictureContainer);
addChildAt(thumbContainer, getChildIndex(mask_mc) - 1);

with(thumbContainer)
{
    mask = mask_mc;
    x = mask_mc.x;
    y = mask_mc.y;
}

thumbsXML.parseXML = function() {
    clearContainer(thumbContainer);

    try {
//  <gallery albumDir="albums/">
//  <album galleryDir="album-1/" thumbDir="thumbs/" sizedDir="sized/" largeDir="large/">
//      <image url="2009-Lotus-Evora-Front-1280x960.jpg"><![CDATA[Caption for the image 1]]></image>
        trace(thumbsXML.xmlData..album.length() + " albums found.");

        for each(var album:XML in thumbsXML.xmlData..album)
        {
            trace("ALBUM: \n" + album);
            for each(var image:XML in album.image)
            {
                trace("THUMB\n" + image);
                //create client thumbs and add them to container
                var thumb:Thumb = new Thumb();
                thumb.imageLoader = new ImageLoader(thumb);
                thumb.x = (thumbContainer.numChildren * (thumbWidth + 10));

                thumb.imageLoader.loadImage(thumbsXML.xmlData.@albumDir + album.@dir + album.@galleryDir + album.@thumbDir + image.@url);
                thumb.addEventListener(MouseEvent.CLICK, thumbClickHandler);
                thumbContainer.addChild(thumb);
                thumb_array[thumb_array.length] = thumb;

                thumb.item = new Item({
                      image:thumbsXML.xmlData.@albumDir + album.@dir + album.@galleryDir + album.@largeDir + image.@url,
                      sized:thumbsXML.xmlData.@albumDir + album.@dir + album.@galleryDir + album.@sizedDir + image.@url,
                      thumb:thumbsXML.xmlData.@albumDir + album.@dir + album.@galleryDir + album.@thumbDir + image.@url, 
                      description:image.text()
                      });

            }
        }

        leftArrow.addEventListener(MouseEvent.CLICK, moveLeft);
        rightArrow.addEventListener(MouseEvent.CLICK, moveRight);

        showThumbContents();
    }
    catch(e:Error)
    { 
        trace(":: Error parsing XML.");
        trace("Caught: " + e.getStackTrace());
    }
}

function thumbClickHandler(e:MouseEvent):void {
    var thumb:Thumb = e.target as Thumb;
    currentThumb = thumbContainer.getChildIndex(thumb);
    showThumbContents();
}

function showThumbContents():void {
    var thumb:Thumb = thumbContainer.getChildAt(currentThumb) as Thumb;
    clearContainer(pictureContainer);
    try
    {
        pictureLoader = new Loader();

        pictureLoader.load(new URLRequest(thumb.item.sized));
        pictureLoader.contentLoaderInfo.addEventListener(IOErrorEvent.IO_ERROR, IOErrorHandler);
        pictureLoader.contentLoaderInfo.addEventListener(ProgressEvent.PROGRESS, onProgressHandler);
        pictureLoader.contentLoaderInfo.addEventListener(Event.COMPLETE, pictureCompleteHandler);

        pictureContainer.addChild(pictureLoader);
    }
    catch(e:TypeError){
        trace("Error showing thumb contents.\n\t" + e.getStackTrace());
    }
}

function gotoLargePicture(e:MouseEvent = null):void {
    trace("GOTO LARGE PICTURE");
    var thumb:Thumb = thumbContainer.getChildAt(currentThumb) as Thumb; 
    navigateToURL(new URLRequest(thumb.item.image), "_blank");
}

function IOErrorHandler(e:IOErrorEvent):void {
    trace("IOErrorEvent!:" + e);
}

function onProgressHandler(e:ProgressEvent):void {
    trace("ProgressEvent: " + e);
    loading_mc.visible = true;
}

function pictureCompleteHandler(e:Event):void {
    //trace("Complete! " + e);
    //pictureContainer.x = 275 - (pictureContainer.width / 2)
    loading_mc.visible = false; 
}

function adjustThumbs():void {
    var temp:int = 0;
    while(temp <= currentThumb - numThumbsShown)
        temp += numThumbsShown;
    leftMostThumb = temp;

    slideThumbs();
}

function moveLeft(e:MouseEvent):void {
    if(leftMostThumb > 0)
        leftMostThumb -= numThumbsShown;
    slideThumbs();
}

function moveRight(e:MouseEvent):void {
    if(leftMostThumb < int(thumbContainer.numChildren - numThumbsShown))
        leftMostThumb += numThumbsShown;
    slideThumbs();
}

function slideToThumb(thumbNum:int):void {
    leftMostThumb = thumbNum;
    slideThumbs();
}

function slideThumbs():void {
    var slide:Object = {x:mask_mc.x - leftMostThumb * (thumbWidth + 10), time:.5, transition:"easeOut"};
    Tweener.addTween(thumbContainer, slide);
    //Tweener.addTween(clientTitleContainer, slide);
}

function prevThumb(e:MouseEvent):void {
    currentThumb--;
    if(currentThumb <= 0)
        currentThumb = thumbContainer.numChildren - 1;
    //showDescription();
    showThumbContents();
}

function nextThumb(e:MouseEvent):void {
    currentThumb++;
    if(currentThumb >= thumbContainer.numChildren)
        currentThumb = 0;
    //showDescription();
    showThumbContents();
}

function clearContainer(container:DisplayObjectContainer):void {
    while(container.numChildren > 0)
        container.removeChildAt(0);
}

function thumbCompleteHandler(e:Event){ 
    trace("thumbsXML loaded. ");
    thumbsXML.removeEventListener(Event.COMPLETE, thumbCompleteHandler);
}

//_browseBtn = browseBT;// new SimpleButton ( ) ;
//_browseBtn.useHandCursor = true;
browseBT.addEventListener ( MouseEvent.CLICK, _handleMouseEvent ) ;
//_fileFilter = new FileFilter ( "Image", "*.jpg;*.gif;*.png;" ) ;      

        function _handleMouseEvent ( evt : MouseEvent ) : void
        {

            //_fileRef = new FileReference ( ) ;
            //_fileRef.browse ( [_fileFilter] ) ;
            //_fileRef.addEventListener ( Event.SELECT, _onImageSelect ) ;

            blackmask.blackmastin.gotoAndPlay(2);

        } 
```

现在我有另一个项目，我想放置此代码，但该项目从外部 .as 文件加载 actionscript 代码。

该代码是：

```
package 
{
    import flash.display.Sprite;
    import fl.motion.AdjustColor;
    import flash.filters.ColorMatrixFilter;
    import fl.events.SliderEvent;
    import com.flashcube.Transformer;
    import flash.events.MouseEvent;

    public class Main extends Sprite
    {
        private var color:AdjustColor = new AdjustColor();
        private var filter:ColorMatrixFilter;
        private var faceTransform:Transformer;

        public function Main():void
        {
            /* Required to create initial Matrix */

            color.brightness = 0;
            color.contrast = 0;
            color.hue = 0;
            color.saturation = 0;

             var newZIndex = 10;

            /* Add Listeners function */

            addListeners();
            addListeners2();
            addListeners22();

        }

        private final function addListeners():void
        {
            faceTransform                       = new Transformer(image2);
            faceTransform.color                 = 0x000FFF;
            faceTransform.showCenterCircle      = true;
            faceTransform.selectedColor         = 0x000000;
            faceTransform.selectedAlpha         = 0.5;
            faceTransform.allowScaleProportion  = true;
            faceTransform.allowRotateProportion = false;

            colorPanel.brightSL.addEventListener(SliderEvent.CHANGE, adjustBrightness);
            colorPanel.contSL.addEventListener(SliderEvent.CHANGE, adjustContrast);
            colorPanel.hueSL.addEventListener(SliderEvent.CHANGE, adjustHue);
            colorPanel.satSL.addEventListener(SliderEvent.CHANGE, adjustSaturation);

        }

        private final function adjustBrightness(e:SliderEvent):void
        {
            color.brightness = e.target.value;
            update();
        }

        private final function adjustContrast(e:SliderEvent):void
        {
            color.contrast = e.target.value;
            update();
        }

        private final function adjustHue(e:SliderEvent):void
        {
            color.hue = e.target.value;
            update();
        }

        private final function adjustSaturation(e:SliderEvent):void
        {
            color.saturation = e.target.value;
            update();
        }

        private final function update():void
        {
            filter = new ColorMatrixFilter(color.CalculateFinalFlatArray());
            image.filters = [filter];
        }

        private final function addListeners2():void
        {
            colorPanel2.brightSL.addEventListener(SliderEvent.CHANGE, adjustBrightness2);
            colorPanel2.contSL.addEventListener(SliderEvent.CHANGE, adjustContrast2);
            colorPanel2.hueSL.addEventListener(SliderEvent.CHANGE, adjustHue2);
            colorPanel2.satSL.addEventListener(SliderEvent.CHANGE, adjustSaturation2);
        }

        private final function adjustBrightness2(e:SliderEvent):void
        {
            color.brightness = e.target.value;
            update2();
        }

        private final function adjustContrast2(e:SliderEvent):void
        {
            color.contrast = e.target.value;
            update2();
        }

        private final function adjustHue2(e:SliderEvent):void
        {
            color.hue = e.target.value;
            update2();
        }

        private final function adjustSaturation2(e:SliderEvent):void
        {
            color.saturation = e.target.value;
            update2();
        }

        private final function update2():void
        {
            filter = new ColorMatrixFilter(color.CalculateFinalFlatArray());
            image2.filters = [filter];
        }

    //-------------------------------------------------

private final function addListeners22():void
        {
image.addEventListener(MouseEvent.CLICK, friendMaker);
        }

private final function friendMaker(evt:MouseEvent):void {
 //setChildIndex(image2,stage.numChildren-1);
   setChildIndex(image,numChildren+1);
}

    }

} 
```

请问有人可以帮我混合第一个代码 int 第二个 .as 文件吗？

我附上了一个包含所有源文件的下载链接。

在框架中的文件 AdgustColor 中，有我想要转换到 Main.as 文件的操作脚本代码。

在文件scroller.fla 中有原始的Scroller。

当然，在我从时间轴帧 1 中删除 actionscript 代码之前，AdgustColor.fla 不起作用。

**下载：** [我的文件](http://www.goldencoupon.gr/test.zip)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-08T22:46:22.643

我要在这里对你说实话。在尝试这样的事情之前，您应该从小处着手并阅读一些关于类如何工作的教程。尽管迁移非常简单，但当需要以任何方式修改代码时，您都会遇到问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-08T23:15:49.267

如果您不知道自己在做什么，“混合”代码尤其是来自类文件的代码并不是一个好主意。我认为这里的任何人都无法按照您希望的方式回答这个问题，这似乎是“为我做”。也许如果您提供最终结果，那么有人可能会为您做这件事。但是那里有很多代码，所以我仍然怀疑你会得到一个完美的答案。我认为您将获得的最佳答案是深入研究代码并了解其功能。最后，您将获得更好的结果，因为您将了解有关代码的所有内容，并且您将从中学到一些可以应用于其他问题的东西。希望有帮助！

# javascript - 简单的 JavaScript 查询选择器不起作用？

> ID：14225177
> 
> 赞同：0
> 
> 时间：2013-01-08T22:30:21.600
> 
> 标签：javascript, html

我编写这个脚本是为了有一个名为“call”的方法，它充当`document.querySelectorAll()`. 例子：

```
var obj = {
    call: function( s ) { return document.querySelectorAll( s ); }
};

obj.call(".test").innerHTML == "Changed"; 
```

* * *

```
<p class="test">Original</p> 
```

因此，显然，（我认为）这会将 innerHTML 值从“原始”更改为“已更改”，但不起作用。

我已经尝试过其他测试，`.style.background = "red";`但也没有奏效。

我在 Chrome 的错误控制台中没有看到任何错误，所以我无法弄清楚为什么这不起作用。当谈到 javascript 时，我是一个完整的菜鸟，所以任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-08T22:39:42.843

QSA 返回一个 NodeList （基本上看起来和行为就像一个数组），文档在这里：[https ://developer.mozilla.org/en-US/docs/DOM/Document.querySelectorAll](https://developer.mozilla.org/en-US/docs/DOM/Document.querySelectorAll)

因此，您需要比较：

`var isFoo = obj.call('.test')[0].innerHTML == 'foo';`

其他几点：

1) call 是 JS 中的保留字，最好选择别的

2）您是要比较结果（您当前正在做什么）还是要设置innerHTML？如果是后者，则代码应为：

`obj.call('.test')[0].innerHTML = 'foo';`

因为 == 是比较运算符，而不是赋值。

# php - 正则表达式查找以大写字母开头且没有“<”符号的字符串

> ID：14225178
> 
> 赞同：0
> 
> 时间：2013-01-08T22:30:24.613
> 
> 标签：php, regex, html-parsing

我正在尝试解析以下代码：

```
<td class='postac'>Actelsar </td>
<td class='postac'>tabl. 80 mg 28 tabl.</td> 
```

输入应该是“ `<td class='postac'> </td>`”标签之间的文本（不带“<”符号），并且以大写字母开头。

正则表达式：`/<td class=\'postac\'>^[A-Z]+([^<]*)$<\/td>/s`

上面的代码不起作用。谢谢你的帮助。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-08T22:32:43.617

> 上面的代码不起作用

这不是因为由于某种原因你在正则表达式的中间放了一个`$`和符号（这意味着相应的字符串/行的结尾和开头）`^`

这应该做你想要的：

```
/<td class=\'postac\'>([A-Z][^<]*)<\/td>/s 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-08T22:33:21.723

**使用 HTML 解析器来解析 HTML 而不是正则表达式**。它可以通过 DOMDocument 和 DOMXPath 轻松完成。

```
$doc = new DOMDocument();
$doc->loadHTML($str);
$xpath = new DOMXPath($doc);
$nodes = $xpath->query('//td[@class="postac"]');
$result = array();
for($i=0;$i<$nodes->length; $i++){
    $text = $nodes->item($i)->textContent;
    if(isset($text[0])&&ctype_upper($text[0])) $result[]= $text;
} 
```

请参阅实际[**代码**](http://3v4l.org/qGSNZ)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-08T22:36:26.717

`/<td class=\'postac\'>([A-Z]+.*)<\/td>/`将匹配`Actelsar`，但不匹配。80 毫克片剂。

# ruby-on-rails - Rails 安全补丁：SQL 注入漏洞

> ID：14225179
> 
> 赞同：2
> 
> 时间：2013-01-08T22:30:26.123
> 
> 标签：ruby-on-rails, ruby-on-rails-3, security, ruby-on-rails-3.2, sql-injection

我需要从新发现的 SQL 注入漏洞中应用最新的 Rails 安全补丁。

我正在使用 Rails 3.2.3 并找到了这个补丁文件（[https://rubyonrails-security.googlegroups.com/attach/23daa048baf28b64/3-2-dynamic_finder_injection.patch?pli=1&view=1&part=5](https://rubyonrails-security.googlegroups.com/attach/23daa048baf28b64/3-2-dynamic_finder_injection.patch?pli=1&view=1&part=5)）但我不确定我如何使用这个文件来修补我的 Rails 代码。

如何访问 git 更改集中提到的文件？有没有一种简单的方法来实现这个补丁？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-08T22:41:00.893

键入`git help am`以获取有关如何应用这些类型的补丁程序的详细信息。应该像下载文件一样简单，cd 到 activerecord 目录并输入`git am < filename`.

但如果你能……更新宝石……现在更多 PITA，但以后会更好……

# html - 并排显示两个带有 figcaptions 的数字 html5

> ID：14225181
> 
> 赞同：1
> 
> 时间：2013-01-08T22:30:37.417
> 
> 标签：html

我在制作带有无花果标题的 2x2 图片库时遇到问题。

我想要这样的东西：

```
-----   -----
|   |   |   |
-----   -----
Text    Text
-----   -----
|   |   |   |
-----   -----
Text    Text 
```

但我得到的是：

```
-----
|   | 
-----
Text

-----
|   | 
-----
Text
etc... 
```

附加 figcomment 标记时，将数字显示为块似乎没有帮助。

另一个问题是，我希望它仍然能够像原始标签那样在较小的屏幕上堆叠到 1x4。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-22T13:10:18.603

将您的图像放入容器中`<div>`并使用@media 查询来设置容器的宽度。将图像`<div>`宽度设置为与图像相同的宽度。您将需要调整宽度设置以适合您的特定图像。

请参阅[jsfiddle](http://jsfiddle.net/jim31415/GHjqk/)的示例。

```
<style>
    .container{width:600px;}
    .photo{width:80px; font-size:80%; text-align:center; vertical-align:top; display:inline-block;}

    @media screen and (min-width: 160px) {
    .container{width:160px;}
    }
    @media screen and (min-width: 240px) {
    .container{width:240px;}
    }
    @media screen and (min-width: 640px) {
    .container{width:400px;}
    }
</style>

<div class="container">
    <div class="photo">
        <img src="image.jpg" />
        This is the caption
    </div>
.
.
.
</div> 
```

# xml - 带有异常 org.xml.sax.SAXParseException 的捆绑：prolog 中不允许内容

> ID：14225182
> 
> 赞同：0
> 
> 时间：2013-01-08T22:30:43.727
> 
> 标签：xml, apache-camel, jbossfuse, apache-servicemix, fuseesb

我在 FuseESB 中部署了一个包，它将记录传入的肥皂请求。我使用 Java DSL 作为

```
from("cxf:bean:comprovaWS?dataFormat=MESSAGE").setHeader("SOAPAction", new ConstantExpression("http://www.about.com")).streamCaching()
            .choice()
            .when(xPathBuilder).log("Request is:"+getParsedXPath(simple("${body}").getText().trim(),"//item[2]/stringValue/text()", false))
            .to("callService")
            .otherwise().log("Error"); 
```

当我在这里使用方法 getParsedXPath 时，Fuse ESB 将异常显示为 `org.xml.sax.SAXParseException: Content is not allowed in prolog.`

我正在使用上述方法来获取 CDATA 信息。方法os如下：

```
 public String getParsedXPath(String xmlStringToParse, String xPathExpression, boolean isNamespaceAware) {

    String parsedXMLPath="";
    try {
        DocumentBuilderFactory xmlFact =
                DocumentBuilderFactory.newInstance();

        DocumentBuilder builder = xmlFact.newDocumentBuilder();
        Document doc = builder.parse(new java.io.ByteArrayInputStream(xmlStringToParse.getBytes()));

        XPath xpath = XPathFactory.newInstance().newXPath();

        xmlFact.setNamespaceAware(isNamespaceAware);

        if(isNamespaceAware){

        xpath.setNamespaceContext(new NamespaceContext() {
    public String getNamespaceURI(String prefix) {
    // we know there's only one namespace uri, just return it!
    return "http://www.about.com";
    }

    // this is not used by XPath
    public String getPrefix(String namespaceURI) {
    System.out.println("getPrefix: " + namespaceURI);
    return null;
    }

    // this is not used by XPath
    public Iterator getPrefixes(String namespaceURI) {
    System.out.println("getPrefixes: " + namespaceURI);
    return null;
    }
});
        }

        NodeList nodes = (NodeList) xpath.evaluate(xPathExpression, doc, XPathConstants.NODESET);
    if (nodes.getLength() == 0) {
    parsedXMLPath="<error>Wrong xPath value: "+xPathExpression+"</error>";
    }
    else {

            parsedXMLPath = nodes.item(0).getNodeValue();
    }

    } catch (Exception e) {
        e.printStackTrace();
    }
    return parsedXMLPath;
} 
```

如果我在代码本身中使用一些演示 XML，这相当于真正的肥皂请求，Fuse 会毫无例外地安装包。

Fuse 如何在接受 SOAP 请求之前抛出异常？谁能告诉我解决方案？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-08T22:39:58.363

异常表示序言中有内容。这意味着您的 DSL 可能会在 xml 文档之前写入一些字节。验证流的顶部没有任何内容。

还要检查：[Prolog SAXParserException 中不允许内容](https://stackoverflow.com/questions/4569123/content-is-not-allowed-in-prolog-saxparserexception)

# linux - 这两个字符串有何不同？

> ID：14225183
> 
> 赞同：-1
> 
> 时间：2013-01-08T22:30:43.460
> 
> 标签：linux, string, hash, diff

有人请阻止我发疯。

我有两个看起来相同的字符串，但被 Linux“diff”标记为不同。它们也有不同的 md5 和 sha1 哈希值。

有没有办法可以找出它们的不同之处？我尝试转换为 ASCII、Unicode 等，但两个字符串的结果是相同的。我唯一能想到的是字符串末尾的一些东西，比如换行符，但我一直无法弄清楚。无论有什么区别，它似乎都与复制和粘贴一致。

这是两个字符串：

per favoure impostami un promemoria per andare in banca

per favoure impostami un promemoria per andare in banca

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-08T22:37:31.050

几种方式：

如果内容在文件“file”中：

```
cat -v file
cat file | od 
```

如果内容在 $string 变量中：

```
echo "$string" | cat -v
echo "$string" | od 
```

甚至您可以添加额外的“边界”来查看尾随空格等：

```
cat -v file | sed -e 's/^/___START___/' -e 's/$/___END___/' 
```

*   od 接受许多 optino 以将内容显示为十六进制、八进制等：有时您会看到更多带有此或那个选项的信息。
*   cat -v 将特殊字符显示为“^x”，^@=\000 ^A=\001 ^B=\002 等有助于查看例如尾随的“^M”。
*   附加的 sed 有助于显示可能在相似文本之前/之后的选项卡或空格。

# excel - 批量删除重复的列

> ID：14225184
> 
> 赞同：0
> 
> 时间：2013-01-08T22:30:46.880
> 
> 标签：excel, duplicates, excel-2007

我知道如何使用“数据”选项卡上的“删除重复项”从单个列中删除重复项。但是，我有 830 列，手动过程（依次选择每一列并单击删除重复项）将非常乏味。

请问有没有更好的方法来做到这一点？

# ravendb - 使用 Raven 2.0 加入文档 - 找不到索引？

> ID：14225185
> 
> 赞同：0
> 
> 时间：2013-01-08T22:30:47.893
> 
> 标签：ravendb

我是 RavenDB 的新手，我有一个关于使用 Raven 2.0 加入两个文档的问题

我发现这个页面[http://daniellang.net/joining-documents-in-ravenb-2-0/](http://daniellang.net/joining-documents-in-ravendb-2-0/)帮助我找到了加入两个文档的解决方案。

请先看我的代码（它编译）

```
internal class Program
{
    private static void Main(string[] args)
    {
        using (var store = new EmbeddableDocumentStore {DataDirectory = @"C:\temp\ravendata"}.Initialize())
        {
            using (var session = store.OpenSession())
            {
                var products = session.Query<Product, UserProducts>()
                                      .AsProjection<UserProductProjection>()
                                      .ToList();
            }
        }
    }
}

public class Product
{
    public string Id { get; set; }
    public string Name { get; set; }
    public string UserId { get; set; }
}

public class User
{
    public string Id { get; set; }
    public string Name { get; set; }
}

public class UserProductProjection
{
    public string Id { get; set; }
    public string UserName { get; set; }
    public string ProductName { get; set; }
    public string ProductId { get; set; }
}

internal class UserProducts : AbstractIndexCreationTask<Product, UserProductProjection>
{
    public UserProducts()
    {
        Map = products => from product in products
                          select new
                                 {
                                     UserName = LoadDocument<User>(product.UserId).Name,
                                     ProductName = product.Name,
                                     ProductId = product.Id
                                 };

        Index(projection => projection.ProductId, FieldIndexing.Analyzed);
        Index(projection => projection.ProductName, FieldIndexing.Analyzed);
        Store(projection => projection.UserName, FieldStorage.Yes);
    }
} 
```

不幸的是它不起作用:(

```
Raven.Database.Exceptions.IndexDoesNotExistsException was unhandled
  HResult=-2146233088
  Message=Could not find index named: UserProducts
  Source=Raven.Database
  StackTrace:
       at Raven.Database.DocumentDatabase.<>c__DisplayClass9a.<Query>b__90(IStorageActionsAccessor actions) in c:\Builds\RavenDB-Stable\Raven.Database\DocumentDatabase.cs:line 1100
  .... 
```

我真的一点头绪都没有！！谷歌在这个问题上也没有帮助我，因为我发现它仍然很新。

如果有人有提示或解决方案，我将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-08T22:44:56.050

虽然您已经定义了索引，但您还没有在 ravendb 中创建它。

请参阅[定义静态索引](http://ravendb.net/docs/client-api/querying/static-indexes/defining-static-index?version=2.0)，但基本上您需要....

```
IndexCreation.CreateIndexes(typeof(UserProducts).Assembly, documentStore); 
```

# linker - 未定义的参考错误 CUDA、GPUJPEG 库

> ID：14225189
> 
> 赞同：0
> 
> 时间：2013-01-08T22:30:58.673
> 
> 标签：linker, cuda, shared-libraries

我已经成功安装了这个库。我的代码编译没有问题，但我收到了这个错误，我相信这是在链接期间：

```
suvamsh@vai:~/gpujpeg-lib/src$ nvcc test.cu
/tmp/tmpxft_00002869_00000000-13_test.o: In function 'encoder()':
tmpxft_00002869_00000000-1_test.cudafe1.cpp:(.text+0x23d): undefined reference to `gpujpeg_set_default_parameters(gpujpeg_parameters*)'
collect2: ld returned 1 exit status 
```

我什至将 $LD_LIBRARY_PATH 设置为库 .so 文件的位置。任何帮助将不胜感激！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-08T23:15:32.970

正如@talonmies 所指出的，

> 如果它位于“非标准”位置，则必须向编译器显式指定库并提供安装它的路径。

试试下面的命令

```
$ nvcc test.cu -o test -L"path/to/GPUJPEGLibrary" -l"name_of_GPUJPEGLibrary" 
```

请注意，如果 .so 文件的名称为 libxyz.so，则“name_of_GPUJPEGLibrary”应为“xyz”。

例如，如果您的 .so 文件是 /usr/local/lib/libgpujpeg.so，则 cmdline 应该是

```
$ nvcc test.cu -o test -L"/usr/local/lib" -l"gpujpeg" 
```

# javascript - FileReader 读取文件未定义结果

> ID：14225190
> 
> 赞同：4
> 
> 时间：2013-01-08T22:31:01.263
> 
> 标签：javascript, filereader

我希望将上传文件的内容读入 Javascript 变量。

该程序曾经使用 file.getAsBinary 工作，但现在已弃用，需要更新以使用 FileReader()

表单具有文件上传选择，onsubmit 在 javascript 中运行函数 uploadDB()。

变量 dbname 可以正常传递，上传选择中的文件名也是如此，我可以通过警报或 console.log 看到它。

接收文件文本的最终 bfile 变量未定义。我已经尝试过 readAsText 和 ReadAsBinary 但 bfile 未定义。var 声明在函数 uploadDB() 中，并且对于内部函数应该是全局的。如果范围在某种程度上是一个问题，我如何在 bfile 变量中获得结果。

它可能很简单，但我无法让它工作。有人可以建议一些东西吗？html部分是；

```
<form onsubmit="uploadDB()"; method="post">
Database <input type=text name="dbName" id="dbName" size=20>
<input type=file id="metaDescFile" size=50 >
<input type=submit value="Submit">
</form> 
```

js脚本类似于（多余的东西被删掉了）；

```
<script language="javascript" type="text/javascript">
<!--
    var uploadDB = function() {
        var input = document.getElementById('metaDescFile');
        var fname = document.getElementById('metaDescFile').value;
        var file=input.files[0];
        var bfile;

        reader = new FileReader();

        reader.onload = function(e) {  bfile = e.target.result }
        reader.readAsText(file);
        alert(bfile);   // this shows bfile as undefined

        // other stuff
    } 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-09T00:02:15.737

当 bfile 在回调中设置时，`onload`您将无法在该回调之外访问，因为在触发回调之前对代码进行了评估。

尝试这个：

```
reader = new FileReader();
reader.onload = function(e) {  
  bfile = e.target.result 
  alert(bfile);   // this shows bfile
}
reader.readAsText(file); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2021-11-29T14:57:07.920

这是获得实际最终字节数组的一个答案，只需使用`FileReader`and `ArrayBuffer`：

```
 const test_function = async () => {

      ... ... ...

      const get_file_array = (file) => {
          return new Promise((acc, err) => {
              const reader = new FileReader();
              reader.onload = (event) => { acc(event.target.result) };
              reader.onerror = (err)  => { err(err) };
              reader.readAsArrayBuffer(file);
          });
       }
       const temp = await get_file_array(files[0])
       console.log('here we finally ve the file as a ArrayBuffer : ',temp);
       const fileb = new Uint8Array(fileb)

       ... ... ...

  } 
```

你想读取`file`的对象在哪里，注意这是一个函数……`File``async`

# c# - C# 中 antlr 语法/解析器的无效转换问题

> ID：14225200
> 
> 赞同：4
> 
> 时间：2013-01-08T22:31:46.763
> 
> 标签：c#, antlr, grammar, antlr3, context-free-grammar

我正在使用 Anlr 3.5 从以下包含的语法生成解析器和词法分析器。该语法用于读取字符串，以便将它们转换为对象图以供以后评估。但是，当我尝试使用*unaryExpression*子句时遇到问题，这样做会引发类转换异常报告：

> 无法将“operandExpression_return”类型的对象转换为“unaryExpression_return”类型。

导致这种情况的一个示例输入是

```
([p1 eq \"p1Value\"]) and [p2 eq \"p2Value\"] or [p3 > \"p3\"\"Val\"\"ue\"] 
```

它似乎是显式触发异常的括号（unaryExpression）。运行相同的语句减去括号似乎可以正确解析，括号内的子表达式也是如此。

我可以通过异常清楚地看到使用了错误的类型。我只是不理解为什么解析器会选择它，也不知道语法需要什么更正来避免这个错误。

值得注意的是，表达式子句的两个分支确实与每个 binaryOperator 分支都有多个匹配的替代方案，但据我了解，这应该没问题，只会导致效率较低的贪婪解析器，而不会导致我看到的错误。

使用的语法：

```
grammar QueryExpressionGrammar;

options {
    language=CSharp3;
    TokenLabelType=CommonToken;
    output=AST;
    ASTLabelType=CommonTree;
}

@lexer::namespace{namespace}
@parser::namespace{namespace}

@parser::members {
public static string CleanQuotedString(string input)
{
    return input == null
        ? null
        : input.Substring(1, input.Length - 2).Replace("\"\"", "\"");
}
}

/*------------------------------------------------------------------
 * PARSER RULES
 *------------------------------------------------------------------*/

public parse returns [IQueryExpression value]
    : exp=expression EOF {$value = $exp.value;}
    ;

expression returns [IQueryExpression value]
    : lhs=operandExpression { $value = $lhs.value; } ( op=binaryOperator rhs=expression {$value = new BinaryOperationQueryExpression($lhs.value, $op.value, $rhs.value);} )*
    | lhs=unaryExpression { $value = $lhs.value; } ( op=binaryOperator rhs=expression {$value = new BinaryOperationQueryExpression($lhs.value, $op.value, $rhs.value);} )*
    ;

binaryOperator returns [BinaryOperator value]
    : BinaryOperatorAnd {$value = BinaryOperator.And;}
    | BinaryOperatorOr {$value = BinaryOperator.Or;}
    ;

unaryExpression  returns [IQueryExpression value]
    : UnaryOperatorNot sub=expression {$value = new UnaryOperationQueryExpression(UnaryOperator.Not, $sub.value);}
    | OPEN_PAREN sub=expression CLOSE_PAREN {$value = new UnaryOperationQueryExpression(UnaryOperator.Paren, $sub.value);}
    ;

operandExpression returns [IQueryExpression value]
    : OPEN_BRACKET p=PROPERTY OperandQueryExpressionOperatorEq v=QUOTED_STRING CLOSE_BRACKET {$value = new OperandQueryExpression($p.text, OperandQueryExpressionOperator.Eq, CleanQuotedString($v.text));}
    | OPEN_BRACKET p=PROPERTY OperandQueryExpressionOperatorLt v=QUOTED_STRING CLOSE_BRACKET {$value = new OperandQueryExpression($p.text, OperandQueryExpressionOperator.Lt, CleanQuotedString($v.text));}
    | OPEN_BRACKET p=PROPERTY OperandQueryExpressionOperatorLe v=QUOTED_STRING CLOSE_BRACKET {$value = new OperandQueryExpression($p.text, OperandQueryExpressionOperator.Le, CleanQuotedString($v.text));}
    | OPEN_BRACKET p=PROPERTY OperandQueryExpressionOperatorGt v=QUOTED_STRING CLOSE_BRACKET {$value = new OperandQueryExpression($p.text, OperandQueryExpressionOperator.Gt, CleanQuotedString($v.text));}
    | OPEN_BRACKET p=PROPERTY OperandQueryExpressionOperatorGe v=QUOTED_STRING CLOSE_BRACKET {$value = new OperandQueryExpression($p.text, OperandQueryExpressionOperator.Ge, CleanQuotedString($v.text));}
    | OPEN_BRACKET p=PROPERTY OperandQueryExpressionOperatorLike v=QUOTED_STRING CLOSE_BRACKET {$value = new OperandQueryExpression($p.text, OperandQueryExpressionOperator.Like, CleanQuotedString($v.text));}
    | OPEN_BRACKET p=PROPERTY OperandQueryExpressionOperatorIlike v=QUOTED_STRING CLOSE_BRACKET {$value = new OperandQueryExpression($p.text, OperandQueryExpressionOperator.Ilike, CleanQuotedString($v.text));}
    | OPEN_BRACKET p=PROPERTY NonValueBasedOperandQueryExpressionOperatorIsNull CLOSE_BRACKET {$value = new OperandQueryExpression($p.text, OperandQueryExpressionOperator.IsNull, null);}
    | OPEN_BRACKET p=PROPERTY NonValueBasedOperandQueryExpressionOperatorNotNull CLOSE_BRACKET {$value = new OperandQueryExpression($p.text, OperandQueryExpressionOperator.NotNull, null);}
    ;

/*------------------------------------------------------------------
 * LEXER RULES
 *------------------------------------------------------------------*/

UnaryOperatorNot
    : 'not'
    | '!'
    ;

BinaryOperatorAnd
    : 'and'
    | '&&'
    | '&'
    ;

BinaryOperatorOr
    : 'or'
    | '||'
    | '|'
    ;

// OperandQueryExpressionOperator that uses a comparison value
OperandQueryExpressionOperatorEq
    : 'eq'
    | '=='
    | '='
    ;

OperandQueryExpressionOperatorLt
    : 'lt'
    | '<'
    ;

OperandQueryExpressionOperatorLe
    : 'le'
    | '<='
    ;

OperandQueryExpressionOperatorGt
    : 'gt'
    | '>'
    ;

OperandQueryExpressionOperatorGe
    : 'ge'
    | '>='
    ;

OperandQueryExpressionOperatorLike
    : 'like'
    ;

OperandQueryExpressionOperatorIlike
    : 'ilike'
    ;

// OperandQueryExpressionOperator that does not use a comparison value
NonValueBasedOperandQueryExpressionOperatorIsNull
    : 'null'
    | 'isnull'
    ;

NonValueBasedOperandQueryExpressionOperatorNotNull
    : 'notnull'
    ;

OPEN_BRACKET: '[';
CLOSE_BRACKET:  ']';
OPEN_PAREN: '(';
CLOSE_PAREN: ')';
PROPERTY: LETTER (ALPHA_NUMERIC | SPECIAL)*; // property definition is in line with the definition of a property definition for c#
QUOTED_STRING: QUOTE (~QUOTE | (QUOTE QUOTE))* QUOTE; // values are characters, or if they contain quotes they are escaped by double quoting and surrounding value in quotes

fragment DIGIT: ('0'..'9');
fragment LETTER: (('a'..'z')|('A'..'Z'));   
fragment ALPHA_NUMERIC: (LETTER|DIGIT);
fragment SPECIAL: ('_'|'-');    
fragment QUOTE: '\u0022';

WHITESPACE: (' ' | '\t' | '\n' | '\r'){ Skip(); }; // valid whitespace characters 
```

私有 QueryExpressionGrammarParser.expression_return expression() 方法中解析器内的异常抛出代码片段

```
...
switch (alt3)
{
case 1:
    DebugEnterAlt(1);
    // QueryExpressionGrammar.g:37:4: lhs= operandExpression (op= binaryOperator rhs= expression )*
    {
    root_0 = (CommonTree)adaptor.Nil();

    DebugLocation(37, 7);
    PushFollow(Follow._operandExpression_in_expression111);
    lhs=operandExpression();
    PopFollow();

    adaptor.AddChild(root_0, lhs.Tree);
    DebugLocation(37, 26);

    /// v v v Exception throwing on line below v v v
     retval.value = (lhs!=null?((QueryExpressionGrammarParser.unaryExpression_return)lhs).value:default(IQueryExpression)); 

    DebugLocation(37, 51);
    // QueryExpressionGrammar.g:37:51: (op= binaryOperator rhs= expression )*
    try { DebugEnterSubRule(1);
... 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-08T23:44:07.700

所以这是我们在评论中找到的解决方案。改变这个：

```
expression returns [IQueryExpression value]
    : lhs=operandExpression { $value = $lhs.value; } ( op=binaryOperator rhs=expression {$value = new BinaryOperationQueryExpression($lhs.value, $op.value, $rhs.value);} )*
    | ulhs=unaryExpression { $value = $ulhs.value; } ( op=binaryOperator rhs=expression {$value = new BinaryOperationQueryExpression($ulhs.value, $op.value, $rhs.value);} )*
    ; 
```

# java - job.setOutputKeyClass 和 job.setOutputReduceClass 指的是哪里？

> ID：14225205
> 
> 赞同：17
> 
> 时间：2013-01-08T22:32:18.510
> 
> 标签：java, hadoop, mapreduce

我以为他们指的是减速器，但在我的程序中我有

`public static class MyMapper extends Mapper< LongWritable, Text, Text, Text >`

和

`public static class MyReducer extends Reducer< Text, Text, NullWritable, Text >`

所以如果我有

`job.setOutputKeyClass( NullWritable.class );`

`job.setOutputValueClass( Text.class );`

我得到以下异常

`Type mismatch in key from map: expected org.apache.hadoop.io.NullWritable, recieved org.apache.hadoop.io.Text`

但如果我有

`job.setOutputKeyClass( Text.class );`

没有问题。

我的代码有问题还是因为 NullWritable 或其他原因而发生这种情况？

我还必须使用`job.setInputFormatClass`and`job.setOutputFormatClass`吗？因为我的程序没有它们也能正常运行。

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2013-01-08T22:41:16.413

调用`job.setOutputKeyClass( NullWritable.class );`会将预期的类型设置为 map 和 reduce 阶段的输出。

如果您的 Mapper 发出的类型与 Reducer 不同，您可以使用`JobConf`'s`setMapOutputKeyClass()`和`setMapOutputValueClass()`方法设置映射器发出的类型。这些隐式设置了 Reducer 期望的输入类型。

（来源：[雅虎开发者教程](http://developer.yahoo.com/hadoop/tutorial/module5.html)）

关于你的第二个问题，默认`InputFormat`是`TextInputFormat`. 这将每个输入文件的每一行视为单独的记录，并且不执行解析。如果您需要以不同的格式处理您的输入，您可以调用这些方法，以下是一些示例：

```
InputFormat             | Description                                      | Key                                      | Value
--------------------------------------------------------------------------------------------------------------------------------------------------------
TextInputFormat         | Default format; reads lines of text files        | The byte offset of the line              | The line contents
KeyValueInputFormat     | Parses lines into key, val pairs                 | Everything up to the first tab character | The remainder of the line
SequenceFileInputFormat | A Hadoop-specific high-performance binary format | user-defined                             | user-defined 
```

`OutputFormat`is的默认实例`TextOutputFormat`，它在文本文件的各个行上写入 (key, value) 对。下面的一些例子：

```
OutputFormat             | Description
---------------------------------------------------------------------------------------------------------
TextOutputFormat         | Default; writes lines in "key \t value" form
SequenceFileOutputFormat | Writes binary files suitable for reading into subsequent MapReduce jobs
NullOutputFormat         | Disregards its inputs 
```

（来源：[其他雅虎开发者教程](http://developer.yahoo.com/hadoop/tutorial/module4.html)）

# c# - 使用 PushSharp 推送通知 - 基础知识

> ID：14225206
> 
> 赞同：14
> 
> 时间：2013-01-08T22:32:21.363
> 
> 标签：c#, .net, push-notification, apple-push-notifications, pushsharp

我需要将通知推送到我的应用安装的数以万计的 iOS 设备。我正在尝试使用 PushSharp 来实现，但这里缺少一些基本概念。起初我试图在 Windows 服务中实际运行它，但无法让它工作 - 来自 _push.QueueNotification() 调用的空引用错误。然后我完全按照文档中的示例代码做了什么，并且它起作用了：

```
 PushService _push = new PushService();

    _push.Events.OnNotificationSendFailure += new ChannelEvents.NotificationSendFailureDelegate(Events_OnNotificationSendFailure);
    _push.Events.OnNotificationSent += new ChannelEvents.NotificationSentDelegate(Events_OnNotificationSent);

    var cert = File.ReadAllBytes(HttpContext.Current.Server.MapPath("..pathtokeyfile.p12"));

    _push.StartApplePushService(new ApplePushChannelSettings(false, cert, "certpwd"));

    AppleNotification notification = NotificationFactory.Apple()
                                                        .ForDeviceToken(deviceToken)
                                                        .WithAlert(message)
                                                        .WithSound("default")
                                                        .WithBadge(badge);
    _push.QueueNotification(notification);

    _push.StopAllServices(true); 
```

**问题 #1**：这非常有效，我看到通知在 iPhone 上弹出。但是，由于它被称为推送服务，我认为它的行为类似于服务 - 意思是，我实例化它并可能在 Windows 服务中调用 _push.StartApplePushService()。而且我想实际上将我的通知排队，我可以在前端（例如管理应用程序）执行此操作：

```
 PushService push = new PushService();

        AppleNotification notification = NotificationFactory.Apple()
                                                            .ForDeviceToken(deviceToken)
                                                            .WithAlert(message)
                                                            .WithSound("default")
                                                            .WithBadge(badge);
        push.QueueNotification(notification); 
```

显然（就像我已经说过的那样），它不起作用 - 最后一行不断抛出空引用异常。

我很难找到任何其他类型的文档来展示如何以服务/客户端方式进行设置（而不仅仅是一次调用所有内容）。有可能还是我错过了应该如何使用 PushSharp 的要点？

**问题#2**：此外，我似乎无法找到一种方法来一次定位多个设备令牌，而不是遍历它们并一次将通知排队。这是唯一的方法还是我在这里也错过了什么？

提前致谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2014-11-25T14:02:21.250

[@baramuse解释了这一切，如果您希望看到服务“处理器”，您可以在](https://stackoverflow.com/users/1129997/baramuse)[**https://github.com/vmandic/DevUG-PushSharp**](https://github.com/vmandic/DevUG-PushSharp)上浏览我的解决方案，我已经实现了您寻求的工作流程，即胜利服务、win 处理器甚至是使用相同核心处理器的 web api ad hoc 处理器。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-05T05:21:33.403

从我所阅读的内容以及我的使用方式来看，“服务”关键字可能会误导您……

它是一种*服务*，您只需配置一次并启动它。从这一点开始，它会等待你在它的队列系统中推送新的通知，一旦有事情发生（交付报告、交付错误......），它就会引发事件。它是异步的，您可以推送 (=queue) 10000 个通知，然后使用事件处理程序等待结果稍后返回。

但它仍然是一个常规对象实例，您必须像常规对象一样创建和访问。它不会公开任何“外部侦听器”（例如 http/tcp/ipc 连接），您必须构建它。

在我的项目中，我创建了一个小型自托管 Web 服务（依赖于 ServiceStack），它负责配置和实例生命周期，同时只公开 SendNotification 函数。

关于**问题 #2**，确实没有任何“批处理队列”，但由于队列函数立即返回（入队并稍后推送），这只是循环到您的设备令牌列表的问题......

```
public void QueueNotification(Notification notification)
{
    if (this.cancelTokenSource.IsCancellationRequested)
    {
        Events.RaiseChannelException(new ObjectDisposedException("Service", "Service has already been signaled to stop"), this.Platform, notification);
        return;
    }

    notification.EnqueuedTimestamp = DateTime.UtcNow;

    queuedNotifications.Enqueue(notification);
} 
```

# hibernate - 休眠标准

> ID：14225207
> 
> 赞同：1
> 
> 时间：2013-01-08T22:32:27.747
> 
> 标签：hibernate

```
Criteria criteria = getSession().createCriteria(clazz); 
Criterion rest1= Restrictions.and(Restrictions.eq("A", "X"), 
       Restrictions.in("B", Arrays.asList("X","Y")));
Criterion rest2= Restrictions.and(Restrictions.eq("A", "Y"), 
       Restrictions.eq("B", "Z"));
criteria.add(Restrictions.or(rest1, rest2)); 
```

如果有奇数个 AND 参数，如何创建标准，例如。5?

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-08T22:38:42.030

您可以使用 DetachedCriteria，它看起来像：
`Disjunction disjunction = Restrictions.disjunction();`
`disjunction.add(rest1);`
`disjunction.add(rest2);`
`disjunction.add(rest3);`
`...`
`dc.add(disjunction);`

对于 AND，您可以使用`Conjunction`而不是`Disjunction`.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-08T22:38:55.010

只需将先前调用的结果`Restrictions.and()`作为 Restrictions.and() 的参数之一

例如：

```
Criterion cr = Restrictions.and(Restrictions.and(Restrictions.eq("A", "X"), 
       Restrictions.in("B", Arrays.asList("X","Y"))), Restrictions.eq("C", "Z)); 
```

# asp.net - JQuery UI 选项卡显示不正确

> ID：14225216
> 
> 赞同：0
> 
> 时间：2013-01-08T22:33:08.750
> 
> 标签：asp.net, jquery-ui

我有一个用于显示服务器库存信息的 ASP.net 页面，并使用 JQuery UI 将信息分成选项卡，如下所示：

```
<div id="tabs" style="z-index: auto; width: 100%;">
     <ul>
         <li><a href="#tabs-1">Summary</a></li>
         <li><a href="#tabs-11">Audit</a></li>
         <li><a href="#tabs-3">Sessions/Security</a></li>
         <li><a href="#tabs-4">Programs/Services</a></li>
         <li><a href="#tabs-5">Processor</a></li>
         <li><a href="#tabs-6">Memory</a></li>
         <li><a href="#tabs-7">Storage</a></li>
         <li><a href="#tabs-9">Roles/Tasks</a></li>
         <li><a href="#tabs-13">Ascertain</a></li>
         <li><a href="#tabs-10">Charts</a></li>
     </ul>
 <div id="tabs-1" style="height: 100%; background-color: #F8FAFA;">
 .......
 .......
 ...other code for stuff in tabs...... 
```

这工作得相当好，并产生一个选项卡式窗格，当窗口出现时会展开：

[![图片1](../Images/6f0092a5f83f526d61db69daa3e58a9c.png)](https://i.stack.imgur.com/RpFOj.png)

我遇到的问题是当用户选择第一行中的选项卡时，最右边（上图中的角色/任务）我将得到以下结果：

[![图片2](../Images/76369fe48766beba44f8933683e25025.png)](https://i.stack.imgur.com/foXau.png)

我似乎无法弄清楚为什么标签会以这种方式倾斜。我已经在 Chrome 和 IE 9 中对此进行了测试，结果相同。无论窗口大小以及哪个选项卡最右侧，都会发生这种情况：

[![图3](../Images/cc1992240fec79a393610a734ba9e51e.png)](https://i.stack.imgur.com/dvaat.png)

编辑：我没有发布完整的代码，包括关闭 DIV，因为标记是几千行，我不想全部筛选。实际代码是完整的。

编辑 2：这是用于选项卡的 CSS。我使用 JQUERY UI 自定义主题页面生成的内容。

```
.ui-tabs { position: relative; padding: .2em; zoom: 1; } /* position: relative prevents IE scroll bug (element with position: relative inside container with overflow: auto appear as "fixed") */
.ui-tabs .ui-tabs-nav { margin: 0; padding: .2em .2em 0; }
.ui-tabs .ui-tabs-nav li { list-style: none; float: left; position: relative; top: 1px; margin: 0 .2em 1px 0; border-bottom: 0 !important; padding: 0; white-space: nowrap; }
.ui-tabs .ui-tabs-nav li a { float: left; padding: .5em 1em; text-decoration: none; }
.ui-tabs .ui-tabs-nav li.ui-tabs-selected { margin-bottom: 0; padding-bottom: 1px; }
.ui-tabs .ui-tabs-nav li.ui-tabs-selected a, .ui-tabs .ui-tabs-nav li.ui-state-disabled a,     .ui-tabs .ui-tabs-nav li.ui-state-processing a { cursor: text; }
.ui-tabs .ui-tabs-nav li a, .ui-tabs.ui-tabs-collapsible .ui-tabs-nav li.ui-tabs-selected a { cursor: pointer; } /* first selector in group seems obsolete, but required to overcome bug in Opera applying cursor: text overall if defined elsewhere... */
.ui-tabs .ui-tabs-panel { display: block; border-width: 0; padding: 1em 1.4em; background: none; }
.ui-tabs .ui-tabs-hide { display: none !important; } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-18T20:25:44.210

我能够通过将我的 JQUERY 库从版本 1.8.162 更新到 1.10.0 来解决这个问题。这一定是他们在升级中处理的事情。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-01-08T22:35:17.017

只是在黑暗中刺伤，但看起来你在某处有一个未封闭的 DIV。

# python - 使用 python 2.7 从 .txt 文件中删除文本

> ID：14225217
> 
> 赞同：-4
> 
> 时间：2013-01-08T22:33:09.257
> 
> 标签：python

我有一个需要附加的文本文件才能导入到我的数据库中。文本文件中有大约 4800 行。数据在下。有人可以帮助我使用 python 脚本，它将：

1.  读取文件
2.  删除除带有 NDC,xxxx-xxxx-xx 的行之外的所有内容
3.  用数据 NDC,XXXXX-XXXX-XX 写入一个新文件

请注意，NDC 有时是 XXXX-XXXX-XX 格式，有时是 XXXXX-XXXX-XX 格式。

这是一些数据：

```
NDC,0065-0795-50

5.25667
48320,2
NDC,0517-2650-25

0.0411

NDC,51079-190-20

0.1582

NDC,0603-5450-21

0.7924 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-08T22:36:20.903

```
with open(inpath, 'r') as infile, open(outpath, 'w') as outfile:
    for line in infile:
        if 'NDC,' in line:
            outfile.write(line) 
```

这做了一些假设：

*   `'NDC,'`除了您的值之外，其中从来没有任何随机文本。如果不是这样，您可能想要编写更智能的测试，可能使用[正则表达式](http://docs.python.org/2/library/re.html)。
*   如果有 ，您想写整行`'NDC,'`，而不仅仅是该行的那一部分。如果这不是真的，那么它应该很容易调整——尤其是如果你已经完成了上述操作（因为那样你只会写，例如，`re`匹配而不是行）。
*   等等……</li>

由于您的问题如此模糊，因此别无选择，只能做出这样的猜测，并且可能至少其中一个是错误的。

但这向您展示了程序的结构是什么样的，您应该能够自己填补空白。尝试一下，如果遇到困难，请回来寻求帮助。

# jquery - 如何使用jquery连接html字符串

> ID：14225219
> 
> 赞同：1
> 
> 时间：2013-01-08T22:33:19.983
> 
> 标签：jquery

如何在不使用“+”号的情况下使用 jQuery 执行以下操作？

```
var appendToResult = "<h4>Whoops, we noticed something.</h4><ul>";

    appendToResult = appendToResult+"<li><p>Please enter your Current Password.</p></li><li><p>Please enter a New Password.</p></li>"; 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-08T22:37:42.443

如果您只是在寻找一种不使用加号来连接字符串的方法，这里有一种方法，不需要 jQuery：

```
var arr = ['text thing 1', 'other text', 'more text', 'etc'];
var str = arr.join(' '); 
```

如果您有一个 jQuery 对象，您正在尝试向其附加文本，您可以这样做：

```
var myObj = $('.myclass');
myObj.append('my appended text here'); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-08T22:41:32.953

或者...

```
var appendToResult = "<h4>Whoops, we noticed something.</h4><ul>";
appendToResult = appendToResult.concat("<li><p>Please enter your Current Password.</p></li><li><p>Please enter a New Password.</p></li>"); 
```

您对从未伤害过任何人的温和加号感到不满的确切原因是什么？

# javascript - jquery 更改日期模式

> ID：14225222
> 
> 赞同：-5
> 
> 时间：2013-01-08T22:33:20.957
> 
> 标签：javascript, jquery

我真的被困在这里了。基本上我需要更改日期模式；

YYYY-MM-DD

至

DD-MM-YYYY

有任何 jquery-guru 可以提供帮助吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-08T22:36:06.293

```
var date1 = "YYYY-MM-DD";
var n = date1.split("-");
date1 = n[2] + "-" + n[1] + "-" + n[0]; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-08T22:36:10.847

```
var split = $(date).split('-');
var newDate = split[2] + '-' + split[1] + '-' +split[0]; 
```

`date`可能在哪里： *2013-01-09*。

# node.js - 从 node.js 在前台执行 shell 命令

> ID：14225225
> 
> 赞同：2
> 
> 时间：2013-01-08T22:33:55.797
> 
> 标签：node.js, command-line-interface

我正在开发一个 Node.js CLI 脚本，作为其职责的一部分，有时需要从用户那里获取大量输入文本。现在，我只是使用非常基本的`readline.prompt()`. 我想要一些更好的编辑功能。而不是重新发明轮子，我想我可以做`crontab -e`或`visudo`做，让脚本启动一个文本编辑器，将数据写入临时文件，并在该文件退出后从该文件中读取。我从 child_process 库中尝试了一些东西，但它们都在后台启动应用程序，并且不让它们控制标准输入或光标。就我而言，我需要一个像 vim 或 nano 这样的应用程序来在运行时占用整个控制台。有没有办法做到这一点，还是我不走运？

注意：这是针对将在单台机器上运行的内部项目，其来源可能永远不会出现。假设没有现有的软件包可以满足我的需求，欢迎使用骇客的变通方法。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-13T00:55:42.443

您是否将 child_process.spawn 的 stdio 选项设置为继承？

这样，子进程将使用与顶级节点进程相同的标准输入和标准输出。

此代码适用于我（节点 v4.3.2）：

```
'use strict';

var fs = require('fs');
var child_process = require('child_process');
var file = '/tmp/node-editor-test';

fs.writeFile(file, "Node Editor", function () {
  var child = child_process.spawn('vim', [file], {stdio: 'inherit'});

  child.on('close', function () {
    fs.readFile(file, 'utf8', function (err, text) {
      console.log('File content is now', text);
    });
  });
}); 
```

# php - 将布尔值的单行 CSV 转录为多行、多列的 HTML 表

> ID：14225226
> 
> 赞同：1
> 
> 时间：2013-01-08T22:34:01.130
> 
> 标签：php, csv

我要处理这个荒谬的数据集，它只是一个大而长的 1 和 0 字符串，它代表每 24 个项目对应于星期几的列。这就是我真正遇到的问题：OFF,OFF,OFF,OFF,OFF,OFF,OFF,OFF,OFF,OFF,OFF,OFF,OFF,OFF,OFF,OFF,OFF,OFF,OFF,OFF,OFF ,关,关,关,关,开,开,开,开,开,开,开,开,开,开,开,开,开,开,开,开,开,开,开,开,开,开,开,关,开,开,开,开,开,开,开,开,开,开,开,开,开,开,开,开,开,开,开,开,开,开,开,关,开,开,开,开,开,开,开,开,开,开,开,开,开,开,开,开,开,开,开,开,开,开,开,关,开,开,开,开,开,开,开,开,开,开,开,开,开,开,开,开,开,开,开,开,开,开,开,关,开,开,开,开,开,开,开,开,开,开,开,开,开,开,开,开,开,开,开,开,开,开,开,关,开，开，开，开，开，开，开，开，开，开，开，开，开，开，开，开，开，开，开，开，开，开，开

并举一个例子（同样，只有一个大长字符串）逗号分隔值，每 24 项添加换行符以使其更清晰：

```
（相对于我已经格式化以使其清楚的东西）
（星期一）0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0 ,
(星期二) 0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1 ,
(周三) 0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1 ,
(星期四) 0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1 ,
(周五) 0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1 ,
(星期六) 0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1 ,
(太阳) 0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1

```

我需要将此数据集放入一个 HTML 表中，其中的内容看起来更像我在这里粘贴到 pastebin 的内容：

```
<table>
<tbody>
<tr>
<th>
<th>Monday</th>
<th>Tuesday</th>
<th>Wednesday</th>
<th>Thursday</th>
<th>Friday</th>
<th>Saturday</th>
<th>Sunday</th>
</tr>
<tr>
<td class="hourHeader">0:00</td>
<td id="1-0" class="highlightOn highlightOff">OFF</td>
<td id="2-0" class="highlightOn highlightOff">OFF</td>
<td id="3-0" class="highlightOn highlightOff">OFF</td>
<td id="4-0" class="highlightOn highlightOff">OFF</td>
<td id="5-0" class="highlightOn highlightOff">OFF</td>
<td id="6-0" class="highlightOn highlightOff">OFF</td>
<td id="7-0" class="highlightOn highlightOff">OFF</td>
</tr>
<tr>
<td class="hourHeader">1:00</td>
<td id="1-1" class="highlightOn highlightOff">OFF</td>
<td id="2-1" class="highlightOn">ON</td>
<td id="3-1" class="highlightOn">ON</td>
<td id="4-1" class="highlightOn">ON</td>
<td id="5-1" class="highlightOn">ON</td>
<td id="6-1" class="highlightOn">ON</td>
<td id="7-1" class="highlightOn">ON</td>
</tr>
<tr>
<td class="hourHeader">2:00</td>
<td id="1-2" class="highlightOn highlightOff">OFF</td>
<td id="2-2" class="highlightOn">ON</td>
<td id="3-2" class="highlightOn">ON</td>
<td id="4-2" class="highlightOn">ON</td>
<td id="5-2" class="highlightOn">ON</td>
<td id="6-2" class="highlightOn">ON</td>
<td id="7-2" class="highlightOn">ON</td>
</tr>
<tr>
<td class="hourHeader">3:00</td>
<td id="1-3" class="highlightOn highlightOff">OFF</td>
<td id="2-3" class="highlightOn">ON</td>
<td id="3-3" class="highlightOn">ON</td>
<td id="4-3" class="highlightOn">ON</td>
<td id="5-3" class="highlightOn">ON</td>
<td id="6-3" class="highlightOn">ON</td>
<td id="7-3" class="highlightOn">ON</td>
</tr>
<tr>
<td class="hourHeader">4:00</td>
<td id="1-4" class="highlightOn highlightOff">OFF</td>
<td id="2-4" class="highlightOn">ON</td>
<td id="3-4" class="highlightOn">ON</td>
<td id="4-4" class="highlightOn">ON</td>
<td id="5-4" class="highlightOn">ON</td>
<td id="6-4" class="highlightOn">ON</td>
<td id="7-4" class="highlightOn">ON</td>
</tr>
<tr>
<td class="hourHeader">5:00</td>
<td id="1-5" class="highlightOn highlightOff">OFF</td>
<td id="2-5" class="highlightOn">ON</td>
<td id="3-5" class="highlightOn">ON</td>
<td id="4-5" class="highlightOn">ON</td>
<td id="5-5" class="highlightOn">ON</td>
<td id="6-5" class="highlightOn">ON</td>
<td id="7-5" class="highlightOn">ON</td>
</tr>
<tr>
<td class="hourHeader">6:00</td>
<td id="1-6" class="highlightOn highlightOff">OFF</td>
<td id="2-6" class="highlightOn">ON</td>
<td id="3-6" class="highlightOn">ON</td>
<td id="4-6" class="highlightOn">ON</td>
<td id="5-6" class="highlightOn">ON</td>
<td id="6-6" class="highlightOn">ON</td>
<td id="7-6" class="highlightOn">ON</td>
</tr>
<tr>
<td class="hourHeader">7:00</td>
<td id="1-7" class="highlightOn highlightOff">OFF</td>
<td id="2-7" class="highlightOn">ON</td>
<td id="3-7" class="highlightOn">ON</td>
<td id="4-7" class="highlightOn">ON</td>
<td id="5-7" class="highlightOn">ON</td>
<td id="6-7" class="highlightOn">ON</td>
<td id="7-7" class="highlightOn">ON</td>
</tr>
<tr>
<td class="hourHeader">8:00</td>
<td id="1-8" class="highlightOn highlightOff">OFF</td>
<td id="2-8" class="highlightOn">ON</td>
<td id="3-8" class="highlightOn">ON</td>
<td id="4-8" class="highlightOn">ON</td>
<td id="5-8" class="highlightOn">ON</td>
<td id="6-8" class="highlightOn">ON</td>
<td id="7-8" class="highlightOn">ON</td>
</tr>
<tr>
<td class="hourHeader">9:00</td>
<td id="1-9" class="highlightOn highlightOff">OFF</td>
<td id="2-9" class="highlightOn">ON</td>
<td id="3-9" class="highlightOn">ON</td>
<td id="4-9" class="highlightOn">ON</td>
<td id="5-9" class="highlightOn">ON</td>
<td id="6-9" class="highlightOn">ON</td>
<td id="7-9" class="highlightOn">ON</td>
</tr>
<tr>
<td class="hourHeader">10:00</td>
<td id="1-10" class="highlightOn highlightOff">OFF</td>
<td id="2-10" class="highlightOn">ON</td>
<td id="3-10" class="highlightOn">ON</td>
<td id="4-10" class="highlightOn">ON</td>
<td id="5-10" class="highlightOn">ON</td>
<td id="6-10" class="highlightOn">ON</td>
<td id="7-10" class="highlightOn">ON</td>
</tr>
<tr>
<td class="hourHeader">11:00</td>
<td id="1-11" class="highlightOn highlightOff">OFF</td>
<td id="2-11" class="highlightOn">ON</td>
<td id="3-11" class="highlightOn">ON</td>
<td id="4-11" class="highlightOn">ON</td>
<td id="5-11" class="highlightOn">ON</td>
<td id="6-11" class="highlightOn">ON</td>
<td id="7-11" class="highlightOn">ON</td>
</tr>
<tr>
<td class="hourHeader">12:00</td>
<td id="1-12" class="highlightOn highlightOff">OFF</td>
<td id="2-12" class="highlightOn">ON</td>
<td id="3-12" class="highlightOn">ON</td>
<td id="4-12" class="highlightOn">ON</td>
<td id="5-12" class="highlightOn">ON</td>
<td id="6-12" class="highlightOn">ON</td>
<td id="7-12" class="highlightOn">ON</td>
</tr>
<tr>
<td class="hourHeader">13:00</td>
<td id="1-13" class="highlightOn highlightOff">OFF</td>
<td id="2-13" class="highlightOn">ON</td>
<td id="3-13" class="highlightOn">ON</td>
<td id="4-13" class="highlightOn">ON</td>
<td id="5-13" class="highlightOn">ON</td>
<td id="6-13" class="highlightOn">ON</td>
<td id="7-13" class="highlightOn">ON</td>
</tr>
<tr>
<td class="hourHeader">14:00</td>
<td id="1-14" class="highlightOn highlightOff">OFF</td>
<td id="2-14" class="highlightOn">ON</td>
<td id="3-14" class="highlightOn">ON</td>
<td id="4-14" class="highlightOn">ON</td>
<td id="5-14" class="highlightOn">ON</td>
<td id="6-14" class="highlightOn">ON</td>
<td id="7-14" class="highlightOn">ON</td>
</tr>
<tr>
<td class="hourHeader">15:00</td>
<td id="1-15" class="highlightOn highlightOff">OFF</td>
<td id="2-15" class="highlightOn">ON</td>
<td id="3-15" class="highlightOn">ON</td>
<td id="4-15" class="highlightOn">ON</td>
<td id="5-15" class="highlightOn">ON</td>
<td id="6-15" class="highlightOn">ON</td>
<td id="7-15" class="highlightOn">ON</td>
</tr>
<tr>
<td class="hourHeader">16:00</td>
<td id="1-16" class="highlightOn highlightOff">OFF</td>
<td id="2-16" class="highlightOn">ON</td>
<td id="3-16" class="highlightOn">ON</td>
<td id="4-16" class="highlightOn">ON</td>
<td id="5-16" class="highlightOn">ON</td>
<td id="6-16" class="highlightOn">ON</td>
<td id="7-16" class="highlightOn">ON</td>
</tr>
<tr>
<td class="hourHeader">17:00</td>
<td id="1-17" class="highlightOn highlightOff">OFF</td>
<td id="2-17" class="highlightOn">ON</td>
<td id="3-17" class="highlightOn">ON</td>
<td id="4-17" class="highlightOn">ON</td>
<td id="5-17" class="highlightOn">ON</td>
<td id="6-17" class="highlightOn">ON</td>
<td id="7-17" class="highlightOn">ON</td>
</tr>
<tr>
<td class="hourHeader">18:00</td>
<td id="1-18" class="highlightOn highlightOff">OFF</td>
<td id="2-18" class="highlightOn">ON</td>
<td id="3-18" class="highlightOn">ON</td>
<td id="4-18" class="highlightOn">ON</td>
<td id="5-18" class="highlightOn">ON</td>
<td id="6-18" class="highlightOn">ON</td>
<td id="7-18" class="highlightOn">ON</td>
</tr>
<tr>
<td class="hourHeader">19:00</td>
<td id="1-19" class="highlightOn highlightOff">OFF</td>
<td id="2-19" class="highlightOn">ON</td>
<td id="3-19" class="highlightOn">ON</td>
<td id="4-19" class="highlightOn">ON</td>
<td id="5-19" class="highlightOn">ON</td>
<td id="6-19" class="highlightOn">ON</td>
<td id="7-19" class="highlightOn">ON</td>
</tr>
<tr>
<td class="hourHeader">20:00</td>
<td id="1-20" class="highlightOn highlightOff">OFF</td>
<td id="2-20" class="highlightOn">ON</td>
<td id="3-20" class="highlightOn">ON</td>
<td id="4-20" class="highlightOn">ON</td>
<td id="5-20" class="highlightOn">ON</td>
<td id="6-20" class="highlightOn">ON</td>
<td id="7-20" class="highlightOn">ON</td>
</tr>
<tr>
<td class="hourHeader">21:00</td>
<td id="1-21" class="highlightOn highlightOff">OFF</td>
<td id="2-21" class="highlightOn">ON</td>
<td id="3-21" class="highlightOn">ON</td>
<td id="4-21" class="highlightOn">ON</td>
<td id="5-21" class="highlightOn">ON</td>
<td id="6-21" class="highlightOn">ON</td>
<td id="7-21" class="highlightOn">ON</td>
</tr>
<tr>
<td class="hourHeader">22:00</td>
<td id="1-22" class="highlightOn highlightOff">OFF</td>
<td id="2-22" class="highlightOn">ON</td>
<td id="3-22" class="highlightOn">ON</td>
<td id="4-22" class="highlightOn">ON</td>
<td id="5-22" class="highlightOn">ON</td>
<td id="6-22" class="highlightOn">ON</td>
<td id="7-22" class="highlightOn">ON</td>
</tr>
<tr>
<td class="hourHeader">23:00</td>
<td id="1-23" class="highlightOn highlightOff">OFF</td>
<td id="2-23" class="highlightOn">ON</td>
<td id="3-23" class="highlightOn">ON</td>
<td id="4-23" class="highlightOn">ON</td>
<td id="5-23" class="highlightOn">ON</td>
<td id="6-23" class="highlightOn">ON</td>
<td id="7-23" class="highlightOn">ON</td>
</tr>
</tbody>
</table> 
```

并在此处以预格式化文本表示：

```
小时|m|t|w|t|f|s|s
0:00|0|0|0|0|0|0|0
1:00|0|1|1|1|1|1|1
2:00|0|1|1|1|1|1|1
3:00|0|1|1|1|1|1|1
4:00|0|1|1|1|1|1|1
5:00|0|1|1|1|1|1|1
6:00|0|1|1|1|1|1|1
7:00|0|1|1|1|1|1|1
8:00|0|1|1|1|1|1|1
9:00|0|1|1|1|1|1|1
10:00|0|1|1|1|1|1|1
11:00|0|1|1|1|1|1|1
12:00|0|1|1|1|1|1|1
13:00|0|1|1|1|1|1|1
14:00|0|1|1|1|1|1|1
15:00|0|1|1|1|1|1|1
16:00|0|1|1|1|1|1|1
17:00|0|1|1|1|1|1|1
18:00|0|1|1|1|1|1|1
19:00|0|1|1|1|1|1|1
20:00|0|1|1|1|1|1|1
21:00|0|1|1|1|1|1|1
22:00|0|1|1|1|1|1|1
23:00|0|1|1|1|1|1|1

```

我已经尝试以多种不同的方式迭代这些数据，但到目前为止，没有一种方法能成功。当我在这棵树上运行我的代码猴头时，有没有人有任何建议，希望有一个椰子滴？他们已经把我的手砍掉了，所以我不能只是去爬这棵坚果树的源头来获得一个包含真实列和行的正确 CSV，这是我在得知它不是之前想到的解决方案一个彼得的主要理由或另一个选择。一杯年轻的椰子水，我可以提前感谢任何人的建议。它有电解质！

**编辑：这是答案：**

```
$days_hours = array_chunk($input, 24);

array_unshift($days_hours, NULL); // reindexes
unset($days_hours[0]); // removes dummy "0" index

$hours_days = call_user_func_array('array_map', array(NULL)+$days_hours);

foreach($hours_days as $hourKey => $hour) {    

    echo '<tr><td id="hourHeader">' . $hourKey . ':00</td>';

    foreach($hour as $dayKey => $day) {

        $dayId = $dayKey + 1;
        $id = $dayId . '-' . $hourKey;

        if ($day === "1") {
            $text = "ON";
            $class = "highlightOn";
        } else {
            $text = "OFF";
            $class = "highlightOff";
        }

        if ($dayKey !== 6) {
            echo '<td class="' . $class . '" id="'. $id . '">' . $text . '</td>';
        } else {
            echo '<td class="' . $class . '" id="'. $id . '">' . $text . '</td></tr>';
        } 
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-08T23:07:53.000

这个怎么样：

```
$values = explode(',', $inputData);
$days = array_chunk($values, 24); 
```

[http://php.net/manual/en/function.array-chunk.php](http://php.net/manual/en/function.array-chunk.php)

语义上与@Madbreak 的解决方案相同：您会得到一个数组，其中包含每天的小时值数组。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-08T23:09:08.457

这不是很难，我想？

```
$input = "OFF,OFF,OFF,OFF,OFF,OFF,OFF,OFF,OFF,OFF,OFF,OFF,OFF,OFF,OFF,OFF,OFF,OFF,OFF,OFF,OFF,OFF,OFF,OFF,OFF,ON,ON,ON,ON,ON,ON,ON,ON,ON,ON,ON,ON,ON,ON,ON,ON,ON,ON,ON,ON,ON,ON,ON,OFF,ON,ON,ON,ON,ON,ON,ON,ON,ON,ON,ON,ON,ON,ON,ON,ON,ON,ON,ON,ON,ON,ON,ON,OFF,ON,ON,ON,ON,ON,ON,ON,ON,ON,ON,ON,ON,ON,ON,ON,ON,ON,ON,ON,ON,ON,ON,ON,OFF,ON,ON,ON,ON,ON,ON,ON,ON,ON,ON,ON,ON,ON,ON,ON,ON,ON,ON,ON,ON,ON,ON,ON,OFF,ON,ON,ON,ON,ON,ON,ON,ON,ON,ON,ON,ON,ON,ON,ON,ON,ON,ON,ON,ON,ON,ON,ON,OFF,ON,ON,ON,ON,ON,ON,ON,ON,ON,ON,ON,ON,ON,ON,ON,ON,ON,ON,ON,ON,ON,ON,ON";

function on_off_to_bool($v) {
    static $map = array('OFF'=>false,'ON'=>true);
    return $map[strtoupper($v)];
}

$input_array = explode(',', $input);
$input_bools = array_map('on_off_to_bool', $input_array);

$days_hours = array_chunk($input_bools, 24);

// $days_hours is now an array of days of the week, 0-indexed,
// each containing an array of BOOLs by hour, 0-indexed.

// If you want 1-indexed days, do this:
array_unshift($days_hours, NULL); // reindexes
unset($days_hours[0]); // removes dummy "0" index

var_export($days_hours); 
```

从中生成所需的 HTML`$days_hours`应该是微不足道的。

**更新**

实际上，在我看来，这不是微不足道的，因为你希望你的表是面向小时而不是面向天的。不管：

```
$hours_days = call_user_func_array('array_map', array(NULL)+$days_hours); 
```

现在生成 HTML：

```
$headers = array('hour', 'Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday', 'Sunday');
?>
<table>
  <thead>
    <tr>
<?php foreach($headers as $header):?>
        <th><?=$header?></th>
<?php endforeach?>
    </tr>
  </thead>
  <tbody>
<?php foreach($hours_days as $hour => $week):?>
     <tr>
        <th class="hourHeader"><?=$hour?>:00</th>
<?php   foreach($week as $dow => $value):
            $id = 'schedule-'.($dow+1).'-'.$hour;
            $class = ($value) ? 'highlightOn' : 'highlightOff';
            $text = ($value) ? "ON" : "OFF";
?>
        <td id="<?=$id?>" class="<?=$class?>"><?=$text?></td>
<?php   endforeach?>
     </tr>
<?php endforeach?>
  </tbody>
</table> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-08T22:47:41.010

开始吧，呃，怎么样：

```
$bits = explode(',', $bigLongString);
$days = array();
$hours = 24;

for($day=0; $day < 7; $day++){
    for($i=0; $i<$hours; $i++){
        $days[$day][] = $bits[$i + $hours * $day];
    }
} 
```

那会让你得到类似的东西：

```
array (
    // day 0
    0 => array(
        OFF,OFF,OFF, ... OFF   // 24 entries
    )
    // ... to index (day) 6
) 
```

我想这应该足以让你开始吧？我应该提一下，是的，这还没有经过测试。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-08T22:47:55.563

快速，肮脏且未经测试，但这应该会花费数小时。每个条目将包含一个工作日数组（周一 -0、周二 - 1 等）及其值。

```
$values = str_getcsv($csvString);
$hourMap = array();

$hour = 0;
$weekday = 0;
foreach($values as $value){
    if(!array_key_exists($hour,$hourMap)){
        $hourMap[$hour] = array();
    }
    $hourMap[$hour][$weekday] = $value;
    $hour = ($hour + 1)%24;
    if($hour == 0){
        $weekday = ($weekday + 1)%7;
    }
} 
```

# jquery - jQuery自定义切换功能问题

> ID：14225229
> 
> 赞同：1
> 
> 时间：2013-01-08T22:34:07.263
> 
> 标签：jquery, toggle

[**请参考小提琴示例**](http://jsfiddle.net/qtqA2/)我在使用 jquery 函数切换来自定义我的需求时遇到问题。我的切换只是通过运行时间扩展 div 的高度。我有一个这样的JS代码：

```
 $(function () {
       $(".enlarge").click(function(){
         var btn = $(this),
             text = btn.siblings('.text'),
             collapsed = text.hasClass('collapsed'),
             height = collapsed ? text[0].scrollHeight : $('<div>', {'class': 'text collapsed'}).css('height');

             var $container = $('#container');

             var currentLargeDetailBox = btn.closest('.large-detail-box');
             var currentBigBox = btn.closest('.big-box');

             var newHeightForExpand = height - 260 + currentLargeDetailBox.height();

             text.animate({'height': height}, 400, function() {

                text.toggleClass('collapsed'); 
                text.css('height', ''); 
                btn.text(collapsed ? 'Show Less' : '...(Show More)');

             });

         btn.toggle(function () {           
            currentLargeDetailBox.height(newHeightForExpand);
            currentBigBox.height(newHeightForExpand);
            $container.isotope('reLayout');
         }, function () {
            currentLargeDetailBox.css('height', '');
            currentBigBox.css('height', '');
            $container.isotope('reLayout');
        });

  });   
}); 
```

有人可以看到我的代码的问题并告诉我吗？奇怪的是，如果我使用“文本”而不​​是“btn”，自定义切换功能就会起作用。像这样：

```
 text.toggle(function () {           
            currentLargeDetailBox.height(newHeightForExpand);
            currentBigBox.height(newHeightForExpand);
            $container.isotope('reLayout');
         }, function () {
            currentLargeDetailBox.css('height', '');
            currentBigBox.css('height', '');
            $container.isotope('reLayout');
        }); 
```

感谢并欢迎任何评论。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-09T22:47:36.960

您的问题似乎是您在点击处理程序中添加了**事件**`btn.toggle`处理程序 - 这不仅意味着它在第一次点击时不可用，而且您在每次后续点击时添加**另一个**事件处理程序。 ****`.toggle`****

 ****尝试使用`if (collapsed)`您已有的布尔测试：

```
$(".enlarge").click(function () {
  var btn = $(this),
    text = btn.siblings('.text'),
    collapsed = text.hasClass('collapsed'),
    height = collapsed ? text[0].scrollHeight : $('<div>', {
      'class': 'text collapsed'
    }).css('height');

  var currentLargeDetailBox = btn.closest('.large-detail-box');
  var newHeightForExpand = height - 260 + currentLargeDetailBox.height();

  text.animate({
    'height': height
  }, 400, function () {
    text.toggleClass('collapsed');
    text.css('height', '');
    btn.text(collapsed ? 'Show Less' : '...(Show More)');
  });

  if (collapsed) {
    alert("1");
    currentLargeDetailBox.height(newHeightForExpand);
  } else {
    alert("2");
    currentLargeDetailBox.css('height', '');
  }
}); 
```

[http://jsfiddle.net/mblase75/pkjpt/](http://jsfiddle.net/mblase75/pkjpt/)****

# nginx - 在 Nginx 中随机返回一个备用页面进行 A/B 测试

> ID：14225230
> 
> 赞同：3
> 
> 时间：2013-01-08T22:34:18.947
> 
> 标签：nginx

有没有办法在 Nginx 中为给定的 URL 和 User-Agent 标头（用于 A/B 测试）返回 20% 的不同页面？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-09T15:11:13.653

您应该检查以下模块：

[http://nginx.org/en/docs/http/ngx_http_split_clients_module.html](http://nginx.org/en/docs/http/ngx_http_split_clients_module.html)

它是专为 A/B 测试而创建的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-09T02:03:17.507

具有负载均衡功能，

```
http {
 upstream myproject {
  server 127.0.0.1:8000 weight=4;
  server 127.0.0.1:8001;
 }

 server {
  listen 80;
  server_name www.domain.com;
  location / {
    proxy_pass http://myproject;
  }
 }

 server {
  listen 8000;
  location / {
   root /var/www/A;
  }
 }

 server {
  listen 8001;
  location / {
   root /var/www/B;
  }
 }
} 
```

不是很漂亮，但也许可行:)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2020-11-02T12:19:56.503

它可以与配置一起使用**split_clients**模块

```
http {
  upstream myproject1 {
    server 127.0.0.1:8000;
  }

  upstream myproject2 {
    server 127.0.0.1:8001;
  }

  split_clients $remote_addr $upstream {
      25% myproject2;
      * myproject1;
  }

  server {
    listen 80;
    server_name www.domain.com;
    location / {
      proxy_pass http://$upstream;
    }
  }

} 
```

# ruby-on-rails-3 - Ruby on Rails 关联导致错误

> ID：14225231
> 
> 赞同：0
> 
> 时间：2013-01-08T22:34:19.073
> 
> 标签：ruby-on-rails-3, associations

关联我的结果时遇到问题。让我带你走：

我有 2 张桌子。仪表板、图表。

图表表有一个dashboard_id 字段，因为仪表板有许多图表。

所以我想要在仪表板控制器中获取仪表板和所有相关图表。这是我到目前为止所拥有的：

**楷模**

```
class Dashboards < ActiveRecord::Base
     has_many :charts
     ....
end

class Charts < ActiveRecord::Base
     has_one :dashboard
     ....
end 
```

**控制器**

```
class DashboardsController < ApplicationController
     def show 
         #an ID is passed but for testing...
         @dashboard = Dashboards.includes(:charts)
     end
end 
```

**看法**

/dashboards/show.html.erb

```
<%=@dashboard.inspect%> 
```

**结果**

```
uninitialized constant Dashboards::Chart 
```

有人可以告诉我我做错了什么吗？它对我来说看起来很干净，我花了几个小时研究这个。我忽略了什么吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-08T22:38:53.637

首先，模型类名称应该使用单数（例如`Dashboard`，`Chart`等）。`Chart`还将仪表板关联更改为：

```
class Chart < ActiveRecord::Base
  belongs_to :dashboard
  ....
end 
```

现在在您的控制器中（通常使用复数），这应该可以工作：

```
class DashboardsController < ApplicationController
  def show 
    #an ID is passed but for testing...
    @dashboard = Dashboard.includes(:charts)
  end
end 
```

# oracle - 如何声明具有不同条件的游标

> ID：14225246
> 
> 赞同：1
> 
> 时间：2013-01-08T22:35:59.920
> 
> 标签：oracle, oracle10g, cursor

我有一个程序`EMPHIRESEPCHAN`，用于获取根据特定时间范围被雇用、分离和更改头衔的员工列表。程序如下：

```
PROCEDURE EMPHIRESEPCHAN  ( p_Start in VarChar2, p_End in VarChar2,                                                           
                  p_Hire IN VarChar2, p_Sep IN VarChar2, p_Changed IN VarChar2, p_Condition1 IN VarChar2, p_Condition2 IN VarChar2) 
IS                                  

CURSOR c_emplst ( p_listtype varchar2 ) IS                                                                           
            select e.emp_id, e.name, e.Rank                                                      
            from person.emp e                                                                                                  
            where emp_id in (select distinct(emp_id) from person.promo                                                               
                    where pdate between p_startDate and p_endDate 
                    and dcode in                                                                                               
                        (select adj from support.descr where typ = 'PROMO' and smeaning = p_listtype) ); 

CURSOR c_promolst ( p_emp_id varchar2 ) IS                                                                              
       select pdate                                               
       from person.promo                                                                                                  
       where emp_id = p_emp_id                                                                                                
       order by 2 desc; 

  Begin

  for EmpRec in c_emplst ('HIRE') 
   LOOP                                                                                 
       for PromoRec in c_PromoLst ( EmpRec.emp ) 
        LOOP                                                                   
           if PromoRec.Dcode in ('TEMPORARY','RETURN','APPOINTED' )                

             -- Do all the operation                                                                  
           end if;                                                                                                      
       end loop;                                                                                                        
   end loop; 

end EMPHIRESEPCHAN; 
```

我必须修改程序以根据`p_Condition1`和`p_Condition2`参数检索员工列表。

*   如果`p_Condition1 is not null and p_Condition2 is null`，我必须检索拥有的员工`Rank = 'Developer'`

*   如果`p_Condition1 is null and p_Condition2 is not null`我必须检索拥有`Rank = 'Tester'`

*   如果`p_Condition1 and p_Condition2 is not null`我必须检索同时具有“开发人员”和“测试人员”等级的员工。

我在各个网站上阅读了很多帖子，并找到了我无法理解的答案。

根据帖子，我对光标进行了如下修改

```
CURSOR c_emplst ( p_listtype varchar2 ) IS
        select e.emp_id, e.name, e.Rank                                                      
        from person.emp e              
        where ( p_Condition1 = null and p_Condition2 = null = and emp_id in (select distinct(emp_id) from person.promo
                where pdate between p_startDate and p_endDate
                and dcode in (select adj from support.descr where typ = 'PROMO' and smeaning = p_listtype) )
    or ( p_Condition1 > null and p_Condition2 = null = and emp_id in (select distinct(emp_id) from person.promo
                where pdate between p_startDate and p_endDate
        and Rank ='Developer'
                and dcode in (select adj from support.descr where typ = 'PROMO' and smeaning = p_listtype) )
    or ( p_Condition1 = null and p_Condition2 > null = and emp_id in (select distinct(emp_id) from person.promo
                where pdate between p_startDate and p_endDate
        and Rank = 'Tester'
                and dcode in (select adj from support.descr where typ = 'PROMO' and smeaning = p_listtype) ); 
```

但是它不起作用。

感谢您的时间和考虑。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-09T00:00:22.750

我怀疑这些条件是你的问题：

```
p_Condition1 = null 
```

没有任何东西等于 NULL。NULL 甚至不等于 NULL。相反，使用：

```
p_Condition1 IS NULL 
```

# c - 如果声明一个大变量，为什么 C 程序会崩溃？

> ID：14225251
> 
> 赞同：2
> 
> 时间：2013-01-08T22:36:22.660
> 
> 标签：c, windows, msvcrt

我在 Microsoft Visual Studio Express 2012 中编译了以下 C 程序：

```
int main() {
   int a[300000];
   return 0;
} 
```

这会因 msvcr110d.dll!__crtFlsGetValue() 中的堆栈溢出而崩溃。

如果我将数组大小从 300,000 更改为 200,000，它可以正常工作（因为这个简单的程序可以说是“工作”，因为它什么都不做）。

我在 Windows 7 上运行，并且还在 Cygwin 下使用 gcc 进行了尝试，它产生了相同的行为（在这种情况下是 seg 错误）。

有没有搞错？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-08T22:37:49.267

C 中自动对象使用的空间大小（“堆栈大小”）存在特定于平台的限制。大于该大小的对象（在嵌入式平台上可能是几千字节，在台式机上可能是几兆字节）不能声明为自动对象。将它们设为静态或动态。

同样，函数调用的深度也有限制，尤其是递归。

检查您的编译器和/或平台文档以获取有关实际大小以及如何更改它的详细信息。（例如在 Linux 上签出`ulimit`。）

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-08T22:38:10.670

因为它被分配在堆栈上并且堆栈的大小有限，显然不足以容纳 300000 个整数。

使用堆分配 a la `malloc`：

```
int* a = malloc(sizeof(int) * 300000);
// ...
free(a); 
```

堆可以容纳比堆栈更多的东西。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-01-08T23:10:07.400

线程堆栈的大小传统上受到操作系统的限制，因为每个进程可用的虚拟地址空间量是有限的。

由于分配给线程堆栈的虚拟地址空间一旦分配就无法更改，因此除了为每个线程分配一个相当大但有限的块之外没有其他策略 - 即使大多数线程将使用它的很少.

同样，允许进程产生的线程数也有有限的限制。

猜测一下，这里的限制是 1MB，然后 Windows 将线程数限制为 - 比如说 - 256，这意味着 32 位进程可用的 3GB 虚拟地址空间中的 256MB 被分配给线程堆栈 - 或者把另一个方式，1/12。

在 64 位系统上，显然有更多的虚拟空间可供使用，但为了快速检测并终止无限递归，限制仍然是明智的。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-01-08T22:38:40.867

局部变量从堆栈中声明空间。所以，如果你分配了足够大的东西，堆栈将不可避免地溢出。

# backup - 最近的文件列表存储在哪里？

> ID：14225256
> 
> 赞同：0
> 
> 时间：2013-01-08T22:37:11.053
> 
> 标签：backup, sync, sublimetext2

我想在多台计算机之间同步某些 Sublime Tex2 设置。我不想同步的一件事是最近的文件列表。Sublime Text 2 在本地文件系统的哪个位置存储最近打开的文件列表？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-08T22:40:52.390

在 Linux 上，它存储在 file`~/.config/sublime-text-2/Settings/Session.sublime_session`中，因此请在用户目录的 Settings 文件夹中查找这样的文件。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-08T22:39:44.537

在 Mac OS X 上，这个列表存储在一个名为`Session.sublime_session`under的文件中`~/Library/Application Support/Sublime Text 2/Settings`，所以我希望它在其他操作系统的 Sublime 的 Settings 文件夹中的同一个文件中。

# api - Windows Phone 8 - 私有 API？

> ID：14225259
> 
> 赞同：12
> 
> 时间：2013-01-08T22:37:34.407
> 
> 标签：api, windows-phone-8, private

是否可以在类似于 iOS 开发的 Windows Phone 8 开发中使用私有 API？

当然，这与发布的应用程序无关（AppStore/Marketplace）。但是有很多非公共项目的用例，开发人员想要调用内部系统函数。

安装 Windows Phone 8 SDK 后，可以安装位于`C:\Program Files (x86)\Microsoft SDKs\Windows Phone\v8.0\Emulation\Images`. 在 Windows Phone 操作系统的主分区中，可以导航到 Windows\System32 并使用 Dependency Walker 或 IDA Pro 等工具检查系统 DLL 文件。

有很多功能听起来很有趣，但它们不是公开可用的，因此没有记录。问题是：是否可以通过应用程序或其他方式以某种方式调用它们？

只是一些有趣的函数的例子（还有更多）：

*   ShellChrome.dll: InvokeStartMenu, InvokeScreenCapture, InvokeVolumeUp, LockDevice, ...
*   InputInjection.dll：ApiInjectInitialize，ApiInjectTouchEvent，...
*   ...

我试图让 LoadLibrary（特别是 LoadLibraryExA）在本机 Windows Phone 应用程序项目中以某种方式工作，并加载和调用这些函数（库的加载工作）。长话短说，我在尝试调用函数时遇到了访问冲突错误或类似错误（可能是因为沙盒执行环境）。另一个问题是，我只能猜测函数的签名（参数）。我无法用我使用的工具找到它们。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-11-22T08:16:53.833

I think they only provide some private apis to only partners with an NDA.

[http://social.msdn.microsoft.com/forums/wpapps/en-US/4af0e87a-ab4b-4652-891a-f198a32758cf/windows-phone-8-access-to-private-apis](http://social.msdn.microsoft.com/forums/wpapps/en-US/4af0e87a-ab4b-4652-891a-f198a32758cf/windows-phone-8-access-to-private-apis)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-07-30T11:50:29.127

您不能，应用程序沙箱将强制使用 API。这意味着每次您尝试调用需要您没有权限的 api 时都会收到 UnauthorizedAccessException。这与您用于解锁手机以进行开发的开发者帐户密切相关。

编辑：在 c++ 本机方面也是如此。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-05-24T12:43:22.123

私有api？我们可以在windows phone中使用dll文件。我在 windows phone 中使用了私有 sdk。我不认为 Windows 将允许我们像 Android 那样自定义操作系统，所以调用音量增加..etc 的东西不会通过私有 api 工作。

# xcode - 如何编写 mac os x 状态栏应用程序以发送 cURL 命令

> ID：14225262
> 
> 赞同：2
> 
> 时间：2013-01-08T22:37:52.880
> 
> 标签：xcode, macos, curl, cloudflare

### 简要地

我想编写一个状态栏应用程序，它将使用 PHP / cURL 通过 https 连接发送命令。

### 我所拥有和知道的

1.  运行 Mountain Lion 的 Mac OS X（使用 X 代码）
2.  Objective-C 中的初学者编码技能
3.  API 的文档，其中包含有关通过 PHP/cURL 发送哪些文本的说明
4.  YouTube 教程：[Xcode 4.1 教程 - 创建菜单栏应用程序（NSStatusItem / StatusBar 应用程序）+ 下载](http://www.youtube.com/watch?v=HRPMFNDcfLY)
5.  有兴趣从简单开始，但逐渐变得复杂

### 我没有或不知道的

1.  如何将 POST/GET 命令编码到应用程序中，以便在点击时触发。

### 具体用例

我想创建一个非常基本的状态栏应用程序，它执行与 Cloudflare CDN / 代理应用程序相关的两件事。[CloudFlare 的 API](http://www.cloudflare.com/docs/client-api.html)允许使用 PHP / CURL 命令通过 https 向用户帐户发送命令。

我想构建一个状态栏应用程序，其中包含通过单击可执行的硬连线命令。单击将执行网站的模式更改（如进入开发模式）或网站的缓存清除。这些是可以在 CloudFlare 网站的前端执行的任务，API 文档为如何构建 GET/POST 请求提供了一些非常明确的方向（因此在这方面不需要任何帮助）。

### 感恩

我非常感谢任何可以为我提供一些建议、资源或其他需要考虑的事情的人。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-09T15:58:42.043

好吧，我不会回答有关设置状态栏和添加状态栏项目并将它们连接到控制器中的操作的部分，但我会指出 NSURLConnection 和 NSMutableURLRequest 的方向，而不是 curl。

例子：

```
NSMutableURLRequest * req = [NSMutableURLRequest requestWithURL:[NSURL URLWithString:@"www.example.com"]];
[req setAllHTTPHeaderFields:@{@"header1":@"value1"}];
[req setHTTPBody:[NSData data]];//not really doing anything
[req setHTTPMethod:@"GET"];

NSURLResponse * respMeta = nil; //will contain returned headers, etc
NSError * err = nil; // on failure will contain error object
NSData * response = [NSURLConnection sendSynchronousRequest:req returningResponse:&respMeta error:&err]; 
```

# ant - 使用 AntBuilder 在 Groovy 中压缩文件/目录

> ID：14225264
> 
> 赞同：2
> 
> 时间：2013-01-08T22:38:10.920
> 
> 标签：ant, groovy, antbuilder

我正在尝试使用 AntBuilder 在 Groovy 中压缩文件和目录。我有以下代码：

```
def ant = new AntBuilder()
ant.zip(basedir: "./Testing", destfile:"${file}.zip",includes:file.name) 
```

这会压缩文件“blah.txt”，但不会压缩文件“New Text Document.txt”。我认为问题是空间。我尝试了以下方法：

```
ant.zip(basedir: "./Testing", destfile:"${file}.zip",includes:"${file.name}")
ant.zip(basedir: "./Testing", destfile:"${file}.zip",includes:"\"${file.name}\"") 
```

以上都没有解决问题。我使用 Ant 是因为它会压缩目录，而且我在工作中无权访问 org.apache.commons.io.compression。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-09T10:00:59.930

如果您查看[ant zip task 的文档](http://ant.apache.org/manual/Tasks/zip.html)，包含参数描述为：

> 必须包含的文件模式的逗号或空格分隔列表

所以你是对的，它是打破它的空间分隔符......

您需要使用更长的路线才能使其正常工作：

```
new AntBuilder().zip( destFile: "${file}.zip" ) {
  fileset( dir: './Testing' ) {
    include( name:file.name )
  }
} 
```

# ruby - 用rspec为元素类匹配数组的更整洁的方法？

> ID：14225272
> 
> 赞同：0
> 
> 时间：2013-01-08T22:38:46.607
> 
> 标签：ruby, rspec

我想断言数组包含的元素类，我尝试了以下方法：

这不起作用，但它看起来不错且可读：

```
["String", :symbol, Object.new].should =~ [an_instance_of(String), an_instance_of(Symbol), an_instance_of(Object)] 
```

但给了我以下错误：

```
Failure/Error: ["String", :symbol, Object.new].should =~ [an_instance_of(String), an_instance_of(Symbol), an_instance_of(Object)]
   expected collection contained:  [#<RSpec::Mocks::ArgumentMatchers::InstanceOf:0x007f9e6a33dbe0 @klass=String>, #<RSpec::Mocks::ArgumentMatchers::InstanceOf:0x007f9e6a33dbb8 @klass=Symbol>, #<RSpec::Mocks::ArgumentMatchers::InstanceOf:0x007f9e6a33db68 @klass=Object>]
   actual collection contained:    ["String", :symbol, #<Object:0x007f9e6a33dca8>]
   the extra elements were:        ["String", :symbol, #<Object:0x007f9e6a33dca8>] 
```

请注意，没有缺少元素。

这可行，但看起来很老套：

```
["String", :symbol, Object.new].collect{|x| x.class}.should =~ [String, Symbol,Object] 
```

1.  有没有更好的方法来断言同样的事情？
2.  为什么第一种方式没有缺失元素？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-08T23:21:45.510

您可以使用`&:class`而不是块，

```
["String",:symbol,Object.new].map(&:class).should =~ [String,Symbol,Object] 
```

产生相同但更具可读性。

另外，我使用`map`了该`collect`方法的简短别名。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-09T18:49:33.003

第二部分的答案取决于您的断言“请注意，没有遗漏的元素”。缺少*元素*。

这个：

```
expected collection contained:  [#<RSpec::Mocks::ArgumentMatchers::InstanceOf:0x007f9e6a33dbe0 @klass=String>, #<RSpec::Mocks::ArgumentMatchers::InstanceOf:0x007f9e6a33dbb8 @klass=Symbol>, #<RSpec::Mocks::ArgumentMatchers::InstanceOf:0x007f9e6a33db68 @klass=Object>] 
```

与此不同：

```
the extra elements were:        ["String", :symbol, #<Object:0x007f9e6a33dca8>] 
```

第一个包含类实例的模拟对象，第二个包含类的实例。不应该以这种`instance_of`方式使用匹配器，您会这样做吗？

```
["String", :symbol, Object.new].should =~ [respond_to(:gsub), respond_to(:intern), respond_to(:object_id)] 
```

这是没有意义的，因为您应该测试*数组* **或者**数组的内容*每个都具有某种属性*。您所做的是将两个测试混合在一起，这样做会导致两者都出现问题。

```
subject { instance }
["String", :symbol, Object.new].each do |thing|
  let(:instance) { thing.class }
    if instance.class == String
      it{ should respond_to(:gsub) }
    else #... 
```

更像这样的东西，但我认为这是一种代码/设计气味——为什么你会在同一个数组中有这么不同的东西？很难规范、测试和处理。

# security - 是否有软件可以监控所有打开的端口以及哪些程序正在使用它们？

> ID：14225276
> 
> 赞同：0
> 
> 时间：2013-01-08T22:38:52.890
> 
> 标签：security, ports, packets

此外，我们是否可以具体知道哪个正在运行的程序正在使用某些端口以及它们正在发送什么样的信息以及具体在哪里？这将适用于许多人来防止 MIM 攻击、木马、键盘记录器连接等。我知道我可以通过 cmd 上的 netstat 命令部分地做到这一点。但我需要知道的是，是否有软件可以一次性完成所有这些操作？（不包括常见的 AV，如 Norton、McAfee、Webroot 等）

提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-08T22:45:36.273

除了简单的 `netstat -an`调用之外，您还可以找到有关打开的端口、使用的文件的附加有用信息，包括：

*   unix (linux, macOSX, solaris, many) : [lsof (daniel miessler 的精彩介绍)](http://danielmiessler.com/study/lsof/)

    然后是数据包的内容：[tcpdump（相同的演示者，不错的介绍）](http://danielmiessler.com/study/tcpdump/)

*   windows : sysinternal 的 [TCPView](http://technet.microsoft.com/en-us/sysinternals/bb897437.aspx)

    然后是数据包的内容（+统计、解码等）：[wireshark](http://www.wireshark.org/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-09T07:09:44.647

我会推荐你​​ nmap，它有很多功能。[http://nmap.org/](http://nmap.org/)

# asp.net-mvc - 我的 Godaddy 主机上的 MVC 4 ConnectionString 错误 166

> ID：14225277
> 
> 赞同：2
> 
> 时间：2013-01-08T22:39:19.817
> 
> 标签：asp.net-mvc, asp.net-mvc-4, connection-string

我正在测试一个网站，mvc 4 网站；我实际上正在学习MVC。

我已经将网站发布到我的个人主机上，在我的电脑上运行良好，但是一旦在我的主机上出现错误，这里首先是连接字符串：（我正在使用北风练习）

```
 <add name="NorthwindEntities" connectionString="metadata=res://*/Models.NorthWindModel.csdl|res://*/Models.NorthWindModel.ssdl|res://*/Models.NorthWindModel.msl;
     provider=System.Data.SqlClient;
     provider connection string=&quot;
     data source=**************.db.********.hostedresource.com;;
     initial catalog=**********;
     User ID=******;         
     MultipleActiveResultSets=True;
     App=EntityFramework&quot;
     Password='********';
     integrated security=True;"
     providerName="System.Data.EntityClient" /> 
```

这是错误：

初始化字符串的格式不符合从索引 166 开始的规范。 说明：在执行当前 Web 请求期间发生未处理的异常。请查看堆栈跟踪以获取有关错误及其源自代码的位置的更多信息。

异常详细信息：System.ArgumentException：初始化字符串的格式不符合从索引 166 开始的规范。

源错误：

在执行当前 Web 请求期间生成了未处理的异常。可以使用下面的异常堆栈跟踪来识别有关异常起源和位置的信息。

堆栈跟踪：

[ArgumentException：初始化字符串的格式不符合从索引 166 开始的规范。] System.Data.Common.DbConnectionOptions.GetKeyValuePair(String connectionString, Int32 currentPosition, StringBuilder buffer, Boolean useOdbcRules, String& keyname, String& keyvalue) +5078242 System .Data.Common.DbConnectionOptions.ParseInternal(Hashtable parsetable, String connectionString, Boolean buildChain, Hashtable synonyms, Boolean firstKey) +132 System.Data.Common.DbConnectionOptions..ctor(String connectionString, Hashtable synonyms, Boolean useOdbcRules) +98 System. Data.EntityClient.EntityConnection.ChangeConnectionString(String newConnectionString) +118 System.Data.EntityClient.EntityConnection..ctor(String connectionString) +81 System.Data.Entity.Internal.LazyInternalConnection。InitializeFromConnectionStringSetting（ConnectionStringSettings appConfigConnection）+78 System.Data.Entity.Internal.LazyInternalConnection.TryInitializeFromAppConfig（字符串名称，AppConfig 配置）+32 System.Data.Entity.Internal.LazyInternalConnection.Initialize（）+131 System.Data.Entity.Internal。 LazyInternalConnection.CreateObjectContextFromConnectionModel() +13 System.Data.Entity.Internal.LazyInternalContext.InitializeContext() +281 System.Data.Entity.Internal.InternalContext.GetEntitySetAndBaseTypeForType(Type entityType) +18 System.Data.Entity.Internal.Linq.InternalSetData.Entity.Internal.LazyInternalConnection.CreateObjectContextFromConnectionModel() +13 System.Data.Entity.Internal.LazyInternalContext.InitializeContext() +281 System.Data.Entity.Internal.InternalContext.GetEntitySetAndBaseTypeForType(Type entityType) +18 System.Data.Entity .Internal.Linq.InternalSetData.Entity.Internal.LazyInternalConnection.CreateObjectContextFromConnectionModel() +13 System.Data.Entity.Internal.LazyInternalContext.InitializeContext() +281 System.Data.Entity.Internal.InternalContext.GetEntitySetAndBaseTypeForType(Type entityType) +18 System.Data.Entity .Internal.Linq.InternalSet`1.Initialize() +56 System.Data.Entity.Internal.Linq.InternalSet`1.GetEnumerator() +15 System.Data.Entity.Infrastructure.DbQuery `1.System.Collections.Generic.IEnumerable<TResult>.GetEnumerator() +40 System.Collections.Generic.List`1..ctor(IEnumerable `1 collection) +315 System.Linq.Enumerable.ToList(IEnumerable`1 源) +58 MvcApplication1.Controllers.HomeController.Index() +21 lambda_method(Closure , ControllerBase , Object[] ) +62 System.Web.Mvc.ActionMethodDispatcher.Execute(ControllerBase 控制器, Object[] 参数) +17 System.Web.Mvc.ReflectedActionDescriptor.Execute(ControllerContext controllerContext, IDictionary `2 parameters) +188 System.Web.Mvc.ControllerActionInvoker.InvokeActionMethod(ControllerContext controllerContext, ActionDescriptor actionDescriptor, IDictionary`2 参数) +27 System.Web.Mvc.Async.<>c_ *DisplayClass42.b* _41() +28 System.Web.Mvc.Async.<>c_ *DisplayClass8 `1.<BeginSynchronous>b__7(IAsyncResult _) +12 System.Web.Mvc.Async.WrappedAsyncResult`1.End() +50 System.Web.Mvc.Async.AsyncControllerActionInvoker.EndInvokeActionMethod(IAsyncResult asyncResult) +29 System.Web.Mvc。异步。<>c* _DisplayClass39.b_ *33() +59 System.Web.Mvc.Async.<>C*_DisplayClass4f.b_ *49() +240 System.Web.Mvc.Async.<>c* _DisplayClass37.b_ *36(IAsyncResult asyncResult) +12 System.Web.Mvc.Async.WrappedAsyncResult `1.End() +50 System.Web.Mvc.Async.AsyncControllerActionInvoker.EndInvokeActionMethodWithFilters(IAsyncResult asyncResult) +31 System.Web.Mvc.Async.<>c__DisplayClass2a.<BeginInvokeAction>b__20() +23 System.Web.Mvc.Async.<>c__DisplayClass25.<BeginInvokeAction>b__22(IAsyncResult asyncResult) +128 System.Web.Mvc.Async.WrappedAsyncResult`1.End() +50 System.Web.Mvc .Async.AsyncControllerActionInvoker.EndInvokeAction(IAsyncResult asyncResult) +26 System.Web.Mvc.<>c* _DisplayClass1d.b_ *18(IAsyncResult asyncResult) +14 System.Web.Mvc.Async.<>c* _DisplayClass4.b_ *3(IAsyncResult ar) +25 System.Web.Mvc.Async.WrappedAsyncResult `1.End() +55 System.Web.Mvc.Controller.EndExecuteCore(IAsyncResult asyncResult) +41 System.Web.Mvc.Async.<>c__DisplayClass4.<MakeVoidDelegate>b__3(IAsyncResult ar) +25 System.Web.Mvc.Async.WrappedAsyncResult`1.End() +55 System.Web.Mvc.Controller.EndExecute(IAsyncResult asyncResult) +28 System.Web.Mvc.Controller.System.Web.Mvc.Async.IAsyncController .EndExecute(IAsyncResult asyncResult) +10 System.Web.Mvc.<>c* _DisplayClass8.b_*3(IAsyncResult asyncResult) +28 System.Web.Mvc.Async.<>c* _DisplayClass4.b__3(IAsyncResult ar) +25 System.Web.Mvc.Async.WrappedAsyncResult`1.End() +55 System.Web.Mvc。 MvcHandler.EndProcessRequest(IAsyncResult asyncResult) +30 System.Web.Mvc.MvcHandler.System.Web.IHttpAsyncHandler.EndProcessRequest(IAsyncResult 结果) +9 System.Web.CallHandlerExecutionStep.System.Web.HttpApplication.IExecutionStep.Execute() +8970061 系统.Web.HttpApplication.ExecuteStep(IExecutionStep step, Boolean& completedSynchronously) +184

那么，世界到底发生了什么？我尝试了许多不同的连接字符串，但都没有成功。

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-08T23:49:11.880

两个相邻的;; 在第 166 位。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-08T23:37:08.353

尝试遵循这些 GoDaddy 文章中的信息：

[定位您的数据库连接字符串](http://support.godaddy.com/help/article/3323/locating-your-database-connection-strings)

[使用 ASP.NET 3.5 连接到 SQL Server 数据库](http://support.godaddy.com/help/article/689/connecting-to-a-sql-server-database-using-aspnet-35)（我知道您使用的是 asp.net mvc 4，但也许这会有所帮助）

如果您需要更多帮助，您应该联系 GoDaddy，因为这对于 StackOverflow 问题来说过于具体/本地化

# perl - 来自函数的哈希返回的 Perl 哈希切片

> ID：14225279
> 
> 赞同：5
> 
> 时间：2013-01-08T22:39:31.470
> 
> 标签：perl

纯粹的学术问题，我在这里没有看到禁止它们的说明（*尽管我找不到类似“学术”的标签*）。

如果我有一个像下面这样的现有哈希，我可以取它的一个切片（？），如图所示：

```
my %hash = (one=>1, two=>2, three=>3, four=>4);
my ($two, $four) = @hash{'two','four'}; 
```

如果哈希是从这样的示例函数返回的，有没有办法做到这一点？

```
sub get_number_text
{
    my %hash = (one=>1, two=>2, three=>3, four=>4);
    return %hash;
} 
```

一种有效的方法是：

```
my ($two, $four) = @{ { get_number_text() } }{'two', 'four'}; 
```

据我了解，函数返回一个哈希键/值列表，内部 {} 创建一个匿名哈希/引用，并且 @{} 使用引用将其“转换”为一个列表，即哈希切片，因为 Perl 知道引用是一个哈希。（我有点惊讶最后一点起作用了，但是 Perl 的功能更强大，等等）

但这是用一种表达方式来写出这种公认的奇怪访问方式的最清晰的方式吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-08T22:48:11.510

一般来说，避免`return %foo`从子程序返回一个扁平化的哈希（）；如果不将其复制到另一个哈希中，它就很难使用。最好返回一个哈希引用 ( `return \%foo`)。

但是，是的，这是最清晰的方法。尽管通常使用 qw 给出硬编码键的列表：

```
my ($two, $four) = @{ { returnit() } }{ qw/two four/ }; 
```

# javascript - JavaScript 不工作？随机码

> ID：14225280
> 
> 赞同：1
> 
> 时间：2013-01-08T22:39:32.843
> 
> 标签：javascript, html, css

我有一个代码可以在页面加载时随机化 div 元素中的背景图像，但它似乎不起作用。

JS 部分：

```
function Randomize() {
    var images = new Array("<?php echo SITE_URL?>/lib/skins/flyeuro/images/banners/ban.ner1.jpg","<?php echo SITE_URL?>/lib/skins/flyeuro/images/banners/banner2.jpg");
    var imageNum = Math.floor(Math.random() * images.length);
    document.getElementById("banner").style.backgroundImage = "url('" + images[imageNum] + "') repeat scroll center center rgb(0, 0, 0)";
}

window.onload = Randomize; 
```

HTML：

```
<div id="banner"></div> 
```

CSS：

```
div#banner {
    background: url("../images/banners/banner1.jpg");
    width: 100%;
    height: 270px;
    z-index: 1;
    margin-bottom: 25px; 
    -webkit-box-shadow:  0px 2px 15px 2px ;
    box-shadow: 0px 2px 15px 2px ;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-08T22:42:29.520

您正在为该属性设置多个背景属性`backgroundImage`。相反，只需设置一个`url()`.

如果您想始终拥有这些其他值，我会在 CSS 中设置它们。

[js小提琴](http://jsfiddle.net/8KsWg/)。

# .htaccess - 如何从 slim 框架 URL 中删除 index.php

> ID：14225283
> 
> 赞同：5
> 
> 时间：2013-01-08T22:39:43.003
> 
> 标签：.htaccess, centos, rewrite, slim

我正在尝试从 URL 中删除 index.php：

这行得通

```
http://server/bw/index.php/test 
```

这不起作用

```
http://server/bw/test 
```

我尝试更改 .htaccess 并在网上观看，我发现它应该是这样的：

```
RewriteEngine On
RewriteBase /bw/

RewriteCond %{REQUEST_FILENAME} !-f
RewriteRule ^ index.php [QSA,L] 
```

我尝试以这种方式编辑它：

```
RewriteEngine On
RewriteCond %{REQUEST_FILENAME} !-f
RewriteRule ^ index.php [QSA,L] 
```

或以这种方式：

```
RewriteEngine On

RewriteCond %{REQUEST_FILENAME} !-f
RewriteRule ^ /bw/index.php [QSA,L] 
```

或以这种方式：

```
RewriteEngine On
RewriteCond %{REQUEST_FILENAME} !-f
RewriteRule ^(.*)$ index.php [QSA,L]
RewriteCond %{REQUEST_FILENAME} !-d 
```

但是当我尝试访问`http://server/bw/test`它时，我说：

```
Not Found

The requested URL /bw/test was not found on this server.

Apache/2.2.15 (CentOS) Server at server Port 80 
```

我检查了我的内部`httpd.conf` `LoadModule rewrite_module modules/mod_rewrite.so`是否启用..我现在不知道该怎么办..

我该如何解决？请帮我！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-08T22:48:26.740

试试这个，例如在 WordPress 中使用的

```
RewriteRule . index.php [L] 
```

或 this，例如 Lavavel PHP Framework 使用的

```
RewriteRule ^(.*)$ index.php/$1 [L] 
```

您也可以考虑添加

```
RewriteCond %{REQUEST_FILENAME} !-d 
```

在 RewriteRule 之前还要排除现有目录，而不仅仅是现有文件。但这取决于你。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-07-14T09:18:49.963

在我的情况下，我更新了`AllowOverride All`，然后运行`sudo a2enmod rewrite`以避免内部 500 错误，然后重新启动 Apache`service apache2 restart`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-08-04T20:30:14.500

对我来说，我使用 Dehalion 的回答中的这条线来工作：

```
RewriteRule . index.php [L] 
```

所以在请求 url 中看不到 index.php（或任何 xyz.php）文件

```
http://localhost/demo1/mycompany/hello/Jim 
```

有以下注意事项：

1.  您已定义此路线：

    $app->get('/mycompany/hello/:name', doHello );

2.  根元素（对于路由 /mycompany/..）***也是***文件的名称。
    也就是说，路由存在于一个名为“mycompany.php”的文件中

是的，这有点骇人听闻......但因为我发现 apache 配置令人困惑/令人生畏:)......我认为这个解决方案足够稳定，可以满足要求。

# c# - 多线程、竞争条件和 C# 事件 - 为什么不直接尝试/捕获？

> ID：14225286
> 
> 赞同：0
> 
> 时间：2013-01-08T22:39:57.723
> 
> 标签：c#, multithreading, events

我从 2009 年开始研究这些问题： [C# Events and Thread Safety](https://stackoverflow.com/questions/786383/c-sharp-events-and-thread-safety)

我还查看了 Eric Lippert 关于同一主题的博客文章：http: [//blogs.msdn.com/ericlippert/archive/2009/04/29/events-and-races.aspx](http://blogs.msdn.com/ericlippert/archive/2009/04/29/events-and-races.aspx)

问题似乎归结为，在多线程环境中，您偶尔会遇到不同线程取消注册线程（线程 A）“if”语句和“调用委托”语句之间的委托的情况。

当我阅读时，我想到了这个问题：如果替代品似乎是在竞争条件或抛出异常之间进行选择，那么为什么不将它包装在 try/catch 块中而不用担心呢？如果您捕获了 nullReferenceException，只需在 catch 块中忽略它（只是为了抑制异常）并继续前进。

现在，我了解 Eric Lippert 和 John Skeet 对 C#、多线程和委托有一点了解，所以有人可以花点时间解释一下我在这里缺少什么吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-08T22:49:47.853

这种异常吞咽的主要问题是您不能确定`NullReferenceException`是由事件委托引起的`null`。它可能是从委托本身内部抛出的。

只是为了确定-您要说的是，而不是这样做：

```
Action temp = Foo;
if (temp != null)
      temp(); 
```

去做这个：

```
try {
    Foo();
}
catch (NullReferenceException e)
{
    // magically ignore it
} 
```

同样，由于许多原因，该`Foo()`调用可能会导致类似的异常，并且您将屏蔽不相关的异常。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-08T22:51:28.063

一般来说，当抛出异常时，意味着发生了错误。

捕捉和异常不会使错误消失。您的操作仍然失败。它所做的只是让你有机会对正在发生的错误做出反应。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-01-08T23:00:03.813

> 如果备选方案似乎是竞争条件或抛出异常之间的选择

我认为这不是这篇文章的重点。

正如 Eric 指出的，有两个问题：

1.  委托可能为空
2.  处理程序本身可能容易受到竞争条件的影响；仅仅因为取消注册的代码类似于`event -= handler; DisposeRequiredResources();`，并不意味着处理程序代码在调用 dispose 后将永远不会运行。

问题 1 通常使用临时变量来解决。（它是必需的，`if (Foo != null) Foo();`由于竞争条件而不起作用）。其他解决方法包括使用空委托进行初始化。在这里使用 try/catch 不仅需要更多的输入，它还有在事件处理程序中吞下真正的 NullReferenceExceptions 的危险。

问题 2 通过使处理程序变得健壮来解决。将整个调用放在 try/catch 块中并不能缓解问题。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-01-08T22:53:28.720

也许我理解错了，但你不能只用 try-catch 来捕捉每一个比赛条件。请参阅下面的代码

```
int count = 0;
for (int i = 0; i < 1000; i++) 
            Task.Factory.StartNew(()=>count++,TaskCreationOptions.LongRunning);
Console.WriteLine(count); 
```

多次运行时，这可能会打印 1000 以外的内容。

# javascript - 除非运行不安全的 Chrome 版本，否则服务器返回 303

> ID：14225290
> 
> 赞同：0
> 
> 时间：2013-01-08T22:40:03.000
> 
> 标签：javascript, google-chrome, web-applications, playframework

我们正在使用 Heroku 上托管的 Play 框架编写一个 Web 应用程序。我们编写了一个 rest API 并正在从 Chrome 访问它。当我们使用不安全的 Chrome 版本时，我们不会收到任何错误，但是当我们尝试使用带有安全设置的 Chrome 时，我们会从服务器获得 303，并且 Chrome 中的控制台为空白。服务器日志说 cookie 没有随请求一起发送。我们的标题被设置为：

```
{
   response().setHeader("access-control-allow-origin", "*");<br>
   response().setHeader("access-control-allow-methods", "GET,POST,PUT,DELETE");<br>
   response().setHeader("access-control-allow-headers", "AUTHORIZATION");   <br>
 } 
```

我认为我们有一些跨域问题，但我不知道如何解决它。有任何想法吗 ？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-10T14:21:13.443

弄清楚了。在来自应用程序的 AJAX 调用中，我们需要添加：

xhrFields: {withCredentials: true}

我们需要删除：

response().setHeader("access-control-allow-origin", "*");

来自服务器响应，并且只专门允许我们允许的域（本地主机）。

# java - 寻找在网页上显示 Java 的好方法

> ID：14225291
> 
> 赞同：2
> 
> 时间：2013-01-08T22:40:06.860
> 
> 标签：java, html

任何人都有很好的（必须是免费的！）在浏览器中以漂亮的格式显示 Java 代码的方法吗？我在各种网站上看过很多例子，但没有使用任何经验。你最喜欢什么？易于使用是一个优点！

想要的功能：

*   自由的
*   易于与标签一起使用（非必需）
*   颜色编码语法

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-08T22:44:19.147

[要点](https://gist.github.com/)是我的最爱。
如果您想托管自己的代码，请查看[SyntaxHighlighter](http://alexgorbatchev.com/SyntaxHighlighter/)
如果您想要服务器端的代码，[Java2Html](http://www.java2html.de/)可能是一种选择（不要认为它支持 html 强硬），或者我做了一个很久以前称为[jrainbow](http://code.google.com/p/jrainbow/)（放弃开发） .

Gist 很简单：您将代码粘贴到 gist 网站上，然后获取 html 代码以嵌入您的网站。

SyntaxHighlighter 也很简单：只需在您的网站中包含一些 javascript，然后将您的代码放入`<pre class="brush:java"> your code here </pre>`其中并在后面指定语言`brush:`，支持的有很多。你也可以有行号和其他东西。

对于 jrainbow，通过 svn 签出代码，然后`mvn jetty:run`打开浏览器`http://localhost:8081/jrainbow/`尝试一下。我打算制作一些 JSP 标签来简化使用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-08T22:42:04.580

是的，Oracle 就是这样做的[——语法高亮](http://alexgorbatchev.com/SyntaxHighlighter/)。这是它的外观：

![在此处输入图像描述](../Images/1e71924e21ec218d5954a7ea99a9da74.png)

# common-lisp - 在磁盘上定位 ASDF 系统

> ID：14225292
> 
> 赞同：2
> 
> 时间：2013-01-08T22:40:09.663
> 
> 标签：common-lisp, asdf

当试图为 common lisp 使用 mpd 接口时，相应的 asdf 系统被简单地命名为“mpd”，我遇到了一个特殊的问题。当我加载系统时，它似乎成功了，但是当我尝试使用这些函数时，它会声称它们是未定义的。在实验中，我尝试将系统重命名为“cl-mpd”，然后加载它，结果发现它有效。因此，我得出结论，ASDF 正在加载一个不同的系统，也称为“mpd”。一般为了避免重命名系统等黑客行为，我在quicklisp的安装目录中寻找有问题的系统，但无济于事。我在我的主文件夹中搜索它，但没有成功。

所以现在我问你：有没有办法在磁盘上获取 ASDF 系统的位置？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-15T04:20:32.967

这是你要找的吗？

(asdf:system-relative-pathname :foo "foo/bar/baz.lisp")

(asdf:component-pathname (asdf:find-component :foo '("bar" "baz")))

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-09T00:52:01.337

1.  find the system
2.  get the components
3.  look at one of them

Example:

```
(describe (first (asdf:module-components (asdf:find-system "mpd")))) 
```

# facebook - Facebook：获取成员的姓名

> ID：14225294
> 
> 赞同：0
> 
> 时间：2013-01-08T22:40:28.660
> 
> 标签：facebook, facebook-graph-api

我正在尝试命名密友列表的成员：

```
FB.api("/me/friendlists/close_friends?fields=members.fields(name)") 
```

但它不工作。

FB.api("/me/friendlists/close_friends?fields=members")

给了我具有以下结构的完整成员对象

```
Object {data: Array[1], paging: Object}
data: Array[1]
0: Object
id: "10150338266588525"
members: Object
data: Array[1]
0: Object
id: "812290716"
name: "My Friend" 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-09T05:57:07.243

要读取 FriendList，请使用 read_friendlists 权限向 /FRIENDLIST_ID 发出 HTTP GET 请求。

```
FB.api("/FRIENDLIST_ID?fields=name,members.fields(name)") 
```

您也可以这样调用，这将返回名称和 id（默认），如果您不想要，只需忽略用户 ID。

```
FB.api("friendlists/close_friends?fields=members.fields(name)") 
```

尝试 FB [Graph API Explorer](https://developers.facebook.com/tools/explorer)，希望这会有所帮助。

# database - 数据库中等深度直方图的例子？

> ID：14225295
> 
> 赞同：3
> 
> 时间：2013-01-08T22:40:43.370
> 
> 标签：database

我无法理解等深度直方图在查询优化中的作用。有人可以给我一些好的资源的指点，或者任何人都可以解释一下。我已经阅读了一些研究论文，但我仍然无法说服我需要和使用等深直方图。那么，有人可以用一个例子来解释等深度直方图吗？

我们还可以合并直方图的桶，使直方图变得足够小并适合磁盘上的 1 页吗？

还有什么是等深度直方图中的桶边界？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-11T18:14:44.587

警告：我不是数据库内部的专家，所以这是一个笼统的答案，而不是一个具体的答案。

查询编译器将查询（通常在 SQL 中给出）转换为获取结果的计划。计划由对数据库引擎的低级“指令”组成：扫描表 T 以查找列 C 中的值 V；使用表 T 上的索引 X 来定位值 V；等等

查询优化是关于编译器决定一组（可能巨大的）替代查询计划中的哪一个具有最低成本。成本包括挂钟时间、IO 带宽、中间结果存储空间、CPU 时间等。从概念上讲，优化器正在搜索替代计划空间，评估每个计划空间的成本以指导搜索，最终选择它可以找到的最便宜的。

上面提到的成本取决于对将读取和/或写入多少记录、是否可以通过索引定位记录、将使用这些记录的哪些列以及数据大小和/或磁盘页数的估计他们占据。

这些数量又通常取决于存储在表中的确切数据值。例如考虑索引列`select * from data where pay > 100`在哪里。`pay`如果 pay 列没有超过 100 的值，则查询非常便宜。对索引的一次探测就可以回答它。相反，结果集可能包含整个表。

这就是直方图有帮助的地方。（等深直方图只是维护直方图的一种方法。）在前面的查询中，直方图将在 O(1) 时间内提供对查询将生成的行的分数的估计，而无需确切知道这些行将包含什么.

实际上，优化器正在对数据的抽象“执行”查询。直方图就是那个抽象。（其他可能。）直方图可用于估计查询计划操作的成本和结果大小：例如，在大量插入和删除期间连接结果大小和页面命中（这可能导致生成临时索引）。

对于一个简单的内连接示例，假设我们知道两个表的整数值连接列是如何分布的：

```
Bins (25% each)
Table A                    Table B
0-100                      151-300 
101-150                    301-500  
151-175                    601-700
176-300                    1001-1100 
```

不难看出，表 A 的 50% 和表 B 的 25% 反映了可能的参与。如果这些是唯一值列，那么一个有用的连接大小估计是 max(.5 * |A|, .25 * |B|)。这是一个非常简单的例子。在许多（大多数？）情况下，分析需要更复杂的数学。对于连接，通常通过“连接”操作数的直方图来计算结果的估计直方图。这就是使文学如此多样化、复杂和有趣的原因。

博士论文通常以简洁的形式涵盖大量技术文献的调查，阅读起来并不难。（毕竟，候选人试图说服委员会他/她知道如何进行文献检索。） [这](http://cs.txstate.edu/~hn12/all.pdf)是一个这样的例子。

# c++ - char * 分段错误

> ID：14225300
> 
> 赞同：-5
> 
> 时间：2013-01-08T22:40:56.137
> 
> 标签：c++, c, segmentation-fault

我正在尝试将数据从我知道其长度的缓冲区复制到从给定索引开始的 char[]，问题是数据包含 null，因此程序因分段错误错误而崩溃。

这是我的代码示例：

```
char *tmp = list->at(0); //list->at(0) return a pointer to the data
char *pEnd = tmp;
for (i = 0; i<size;i++)
{
     buffer[i] = *pEnd ; //<<<-----here I got the segmentation fault
     pEnd++;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-08T22:45:07.583

如果您说`list->at(0)`返回`NULL`，那么指针`pEnd`将是`NULL`.

因此，这样做`*pEnd`是取消引用一个 NULL 指针，这显然会出现段错误。

如果您想对此进行检查，可以在取消引用之前检查指针。例如：

```
if(pEnd == NULL)
    //Do nothing or throw error or something
else
    //Go ahead and do your stuff 
```

# java - 想要列表中不重复的元素

> ID：14225302
> 
> 赞同：6
> 
> 时间：2013-01-08T22:41:11.033
> 
> 标签：java, list, arraylist, duplicates

从下面的列表中，我只需要“哇”和“退出”。

```
List<String> list = new ArrayList();                
list.add("test");       
list.add("test");                   
list.add("wow");    
list.add("quit");
list.add("tree");
list.add("tree"); 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-08T22:44:23.297

您可以检查 Collection 中某个元素的频率，并排除频率高于 1 的元素。

```
 List<String> list = new ArrayList<String>();
    list.add("test");       
    list.add("test");                   
    list.add("wow");    
    list.add("quit");
    list.add("tree");
    list.add("tree");
    for(String s: list){
        if(Collections.frequency(list, s) == 1){
            System.out.println(s);
        } 
```

输出：

```
wow
quit 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-01-08T22:44:37.990

此代码段应为您留下一个集合 ( `output`)，其中仅包含列表的非重复元素。

```
HashSet<String> temp = new HashSet<String>();
HashSet<String> output = new HashSet<String>();

for (String element : list)
{
    if (temp.contains(element)) output.remove(element);
    else
    {
        temp.insert(element);
        output.insert(element);
    }
} 
```

在 O(n*log(n)) 时间内运行：对列表中的 n 个元素中的每一个元素进行一组对数运算（设置查找、插入等）。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-01-08T22:52:56.260

您可以使用 HashMap impl 来计算出现次数并仅选择出现一次的次数。

例如

```
void check(List<String> list)
{
  Map<String,Integer> checker = new HashMap<String,Integer>();
  List<String> result = new ArrayList<String>();
  for(String value: list)
  {
    Integer count = checker.get(value); 
    if (count==null)
    {
      count = 0;
    }
    checker.put(value, ++count);
  }
  // now select only values with count == 1
  for(String value: checker.keySet())
  {
    if (checker.get(value) == 1)
    {
      result.add(value);
    }
  }
  System.out.println(result); 
} 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-01-08T22:46:01.733

第三种方式

```
List result = new ArrayList();
for(Object o : list){
   if(list.indexOf(o) == list.lastIndexOf(o))
   result.add(o);
} 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2018-03-22T21:40:30.403

这是一种没有流的 Java 8 方式：

```
Map<String, Long> counts = new HashMap<>();
list.forEach(word -> counts.merge(word, 1L, Long::sum));

counts.values().removeIf(count -> count > 1); 
```

这首先迭代列表并将每个单词的频率存储在`counts`地图中。为此，我使用的[`Map.merge`](https://docs.oracle.com/javase/8/docs/api/java/util/Map.html#merge-K-V-java.util.function.BiFunction-)方法是将提供的值（`1L`在本例中）与给定的键（`word`此处）相关联，或者使用提供的合并函数（`Long::sum`）将现有值与给定的值组合。

然后，通过该方法`1`从地图中删除频率大于 的单词。[`Collection.removeIf`](https://docs.oracle.com/javase/8/docs/api/java/util/Collection.html#removeIf-java.util.function.Predicate-)

整个过程具有`O(n)`时间复杂度。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2020-09-24T16:40:11.073

List aList = Arrays.asList("test", "test", "wow", "wow", "wow");

设置 hashSet = new HashSet(aList);

hashSet.addAll(aList);

现在您可以打印 HashSet 删除的所有重复值

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2018-03-22T21:02:17.960

@ROMANIA_Engineer 的解决方案应该可以正常工作，但它确实隐藏了 O(n ² ) 复杂性，因为它`Collections.frequency`是 O(n) 操作。

仍然可以压缩到单个语句中的更有效的解决方案可能是计算每个项目出现的次数并仅过滤出现一次的项目：

```
list.stream()
    .collect(Collectors.groupingBy(Function.identity(), Collectors.counting()))
    .entrySet()
    .stream()
    .filter(e -> e.getValue() == 1L)
    .map(Map.Entry::getKey)
    .forEach(System.out::println); 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2019-10-28T05:48:52.687

如果您愿意使用第三方库，则以下内容可以与[Eclipse Collections](https://github.com/eclipse/eclipse-collections)一起使用：

```
List<String> list = Arrays.asList("test", "test", "wow", "quit", "tree", "tree");

Set<String> set = Bags.mutable.withAll(list).selectUnique();

System.out.println(set); 
```

输出：

```
[wow, quit] 
```

您也可以`Bag`直接构造 a 而不是创建 a `List`，如下所示：

```
MutableBag<String> bag = 
    Bags.mutable.with("test", "test", "wow", "quit", "tree", "tree");

MutableSet<String> set = bag.selectUnique(); 
```

注意：我是 Eclipse Collections 的提交者

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2016-11-12T16:44:38.687

**Java 8+**

```
list.stream()                                              // Stream
    .filter(i -> Collections.frequency(list, i) == 1)      // Stream
    .collect(Collectors.toList())                          // List
    .forEach(System.out::println);                         // void 
```

它打印该列表中仅出现一次的每个元素。

细节：

*   [lambda 表达式](https://docs.oracle.com/javase/tutorial/java/javaOO/lambdaexpressions.html)
*   [流](https://docs.oracle.com/javase/8/docs/api/java/util/stream/Stream.html)接口
*   [收藏](https://docs.oracle.com/javase/8/docs/api/java/util/Collections.html)类

# wpf - Surface SDK 可以在 Visual Studio 2012 上运行吗？

> ID：14225303
> 
> 赞同：7
> 
> 时间：2013-01-08T22:41:15.697
> 
> 标签：wpf, visual-studio-2010, visual-studio-2012, pixelsense

我需要使用 Surface SDK 创建一个 WPF 应用程序。我正在使用 Visual Studio 2012，根据[这个](https://stackoverflow.com/questions/11624895/how-can-i-use-microsoft-surface-sdk-with-visual-studio-2012)SO post，VS2012 不允许这样做。但是，由于这是在正式发布之前发布的，因此我想确保我没有遗漏任何东西。

我只需要它附带的一些触摸/滑动控件。VS2012有不同的选择吗？另一个开发人员使用的是 2010，因此它需要能够在他的机器上仍然运行。这是一个非常简单的应用程序，我只需要敲定，所以我正在寻找最快、最简单的方法。我们和最终应用程序都将在 Windows 7 上运行。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-11T19:39:50.203

我找到了一个简单的解决方案，它似乎可以工作。它确实希望您安装 Visual Studio 2010。按照以下步骤，我设法使用 .NET 4.5 在 Visual Studio 2012 中进行编译。`TouchDown`活动工作。我在一些小项目上进行了尝试，它们似乎工作得很好。

1.  使用 Visual Studio 2010 设置 Surface 项目。
2.  安全并关闭 Visual Studio 2010。
3.  使用 Visual Studio 2012 打开解决方案。
4.  将项目设置下的目标框架更改为 .NET 4.5。
5.  另存为新的解决方案文件。
6.  编译，...一切正常！

此方法使您不必自己设置所有配置文件/引用。唯一的缺点是您没有将任何 Surface 工具集成到 IDE 中。例如工具箱、项目模板……这当然不会阻止您自己编写普通的 XAML。

如果由于某种原因从长远来看这不起作用，我将更新这篇文章。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-21T05:13:29.213

不幸的是，最简单的方法是运行 VS2010。

目前 VS2012 不支持 SDK，原因有几个。值得注意的是，触摸在 Win8 中的工作方式比以前的 Windows 版本要好得多。不幸的是，这意味着要重写 Surface SDK 使用的触控层。新控件被编写为根据鼠标/触摸输入动态适应，使得 Surface SDK 控件有点多余。

微软将来可能会为 VS2012 提供 SDK，但这有点值得商榷。

如果您仍然一心想尝试一下，请下载一个名为 Orca 的应用程序 (http://msdn.microsoft.com/en-us/library/windows/desktop/aa370557(v=vs.85).aspx) 并编辑 SDK 安装程序文件，删除对 VS2010 的依赖。

这就是我如何让 Surface 1 SDK 与 VS2010 一起使用，因为它针对的是 VS2008（请注意，它仍未更新为与 VS2010 一起使用）

让我知道你怎么去。

# c++ - 寻找计算 IP 地址的算法/类（直方图）

> ID：14225306
> 
> 赞同：4
> 
> 时间：2013-01-08T22:41:22.817
> 
> 标签：c++, algorithm, data-structures, ip-address, histogram

我需要一个简单的类来计算来自网络监控系统的 IP 地址的分布（直方图）。可能有 1 到 10 ^(10 个)数据包，具有 1 到 2 ^(32 个)地址（或者更多，如果我们有 IPv6 接口）。我理想中寻找的是一个 C++ 类，它将自动创建直方图，然后，当达到限制时，开始通过某种前缀路由组合不太受欢迎的节点。

有没有人知道这样的事情，或者我需要写吗？

谢谢！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-08T23:05:54.907

您所描述的听起来像是**[Count-Min 草图](http://en.wikipedia.org/wiki/Count-Min_sketch)**数据结构的完美用例。这种数据结构用于近似数据流中各种元素的频率，并且可以调整为精确地使用一定量的内存。此外，给定一个固定的内存限制，您可以调整它的准确度以及与您想要的确切答案的接近程度。我的理解是，谷歌使用这种数据结构来识别频繁的搜索，而不必使用大量的磁盘空间。

作为一个额外的好处，数据结构永远不会低估给定值的真实频率。也就是说，如果您想查询您查看给定 IP 地址的频率，Count-Min 草图将始终为您提供一个不小于真实数字的值。

Count-Min 草图非常容易实现——你只需要一堆不同的哈希函数和一个二维数组。**[您还可以在 Google 的数据结构页面上](https://sites.google.com/site/countminsketch/code)**找到 Count-Min 草图的各种不同实现。

希望这可以帮助！

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-08T23:33:53.083

+1 到@templatetypedef，以获得近似解决方案。

为了完整起见，如果需要存储确切的计数，则无法存储确切的数字。但是，根据您的要求，您可能能够显着减少所需的空间*（例如，10.*.*.* 和 192.68.*.* ips 永远不能公开路由；还有许多其他的，例如 25.* .*.*，目前未公开路由）*。您也可以*（再次取决于您的要求）*能够将大量不太重要的 ips 一起计算。

如果您可以将空间需求降低到足够低，您可以使用`bitset`. 如果没有简单的方法将 ip-address 映射到 bitset-address，则需要使用类似[简洁的 trie](http://stevehanov.ca/blog/index.php?id=120)之类的东西来映射它们。一个简洁的 trie 将需要每个 ip-group 一个字节（不规则化）。

而且，如果您不能将其降低到足够低，您可能需要使用数据库并接受性能损失。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-11T21:04:57.853

我开发了一种算法来解决这个问题。该算法将 IP 地址计数存储在基数树/前缀树中。每个节点记录地址的下一位，如果它是终端节点，则记录一个计数。如果节点太多，则从树的范围开始组合节点；首先合并具有最低计数的叶子的节点。

它非常优雅且非常快速。如果有兴趣，我可以发布 C++ 代码。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-08T22:47:46.013

您可以查看边界网关协议 (BGP) 或 GRiDA 算法。

# html - 为什么嵌入的 YouTube 视频在 Safari 中具有 3 个边？

> ID：14225308
> 
> 赞同：2
> 
> 时间：2013-01-08T22:41:42.907
> 
> 标签：html, css, youtube, dreamweaver

我在我设计的网站上有一个嵌入的 YouTube 视频。它在除 Safari 之外的所有浏览器中看起来都很好？我制作了带有弯曲白色边框的视频，并渲染到电影本身中，这样一旦嵌入它就可以匹配容器的曲线，并且在播放时看起来无缝。看一下：

[http://www.glovesanddoves.com/fighters.htm](http://www.glovesanddoves.com/fighters.htm)

在 Safari 中，视频的底部和两侧都有黑色边框。代码设置为零边界：

```
<iframe width="384" height="216" style="border:none;" src="http://www.youtube.com/embed/GLXrAoNcvXk?HD=1;rel=0;showinfo=0;controls=0" frameborder="0" allowfullscreen></iframe> 
```

如果有人能找出为什么会发生这种情况并解决这个问题，我将不胜感激。

杰克

# xcode - 动态 UITableViewCells 高度变化

> ID：14225312
> 
> 赞同：0
> 
> 时间：2013-01-08T22:42:09.493
> 
> 标签：xcode, uitableview, uilabel

我正在尝试动态更改高度，但不知何故它不起作用。“detailText”标签与列表的其他字段重叠。整个单元格的默认高度为 150，包括用户、文本、日期。用户和日期各占一行，其余的为文本。我正要完成应用程序，但这确实扰乱了整个过程，我还检查了其他技术，但不知何故，它们都不起作用。可能是我错过的一件小事。:(

```
 - (CGFloat)tableView:(UITableView *)tableView heightForRowAtIndexPath:(NSIndexPath *)indexPath{

    NSString *user=[[discussionArray objectAtIndex:indexPath.row] objectForKey:@"user"];
    NSString *text=[[discussionArray objectAtIndex:indexPath.row] objectForKey:@"text"];
    NSString *time=[[discussionArray objectAtIndex:indexPath.row] objectForKey:@"date"];
    CGSize usersize = [user sizeWithFont:[UIFont systemFontOfSize:15] constrainedToSize:CGSizeMake(250, MAXFLOAT) lineBreakMode:UILineBreakModeWordWrap];
    CGSize textsize = [text sizeWithFont:[UIFont systemFontOfSize:13] constrainedToSize:CGSizeMake(250, MAXFLOAT) lineBreakMode:UILineBreakModeWordWrap];
    CGSize timesize = [time sizeWithFont:[UIFont systemFontOfSize:12] constrainedToSize:CGSizeMake(250, MAXFLOAT) lineBreakMode:UILineBreakModeWordWrap];

    return usersize.height+textsize.height+timesize.height;
} 
```

和连接器

```
 - (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath{
    static NSString *CellIdentifier = @"Cell";
    discussionCustomCell *cell = (discussionCustomCell*)[tableView dequeueReusableCellWithIdentifier:CellIdentifier];
    if (cell == nil) {
        NSArray *nib = [[NSBundle mainBundle] loadNibNamed:@"discussionCustomCell" owner:self options:nil];
        cell = [nib objectAtIndex:0];
    }

    NSLog(@"%i",[discussionArray count]);
    NSDictionary *dict=[discussionArray objectAtIndex:indexPath.row];
    cell.imageViewIst.image = [profileImagesArray_ objectAtIndex:indexPath.row];
    NSString *new=[dict objectForKey:@"new"];
    if ([new isEqualToString:@"0"])
    {
    cell.imageViewSecond.backgroundColor=[UIColor redColor];
    }
    else
    {
    cell.imageViewSecond.backgroundColor=[UIColor greenColor];
    }
    cell.nameLabel.text=[dict objectForKey:@"user"];
    cell.nameLabel.font = [UIFont boldSystemFontOfSize:15];
    cell.nameLabel.numberOfLines = ceilf([[dict objectForKey:@"user"] sizeWithFont:[UIFont systemFontOfSize:15] constrainedToSize:CGSizeMake(250, MAXFLOAT) lineBreakMode:UILineBreakModeWordWrap].height/20.0);
    cell.detailText.text=[dict objectForKey:@"text"];
    cell.detailText.font = [UIFont boldSystemFontOfSize:15];
    cell.detailText.numberOfLines = ceilf([[dict objectForKey:@"text"] sizeWithFont:[UIFont systemFontOfSize:13] constrainedToSize:CGSizeMake(250, MAXFLOAT) lineBreakMode:UILineBreakModeWordWrap].height/20.0);
    cell.timeLabel.text=[dict objectForKey:@"date"];
    cell.timeLabel.font = [UIFont boldSystemFontOfSize:15];
    cell.timeLabel.numberOfLines = ceilf([[dict objectForKey:@"date"] sizeWithFont:[UIFont systemFontOfSize:12] constrainedToSize:CGSizeMake(250, MAXFLOAT) lineBreakMode:UILineBreakModeWordWrap].height/20.0);
    return cell;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-09T07:04:15.183

正如 demosten 建议的那样，确保标签在您的`discussionCustomCell`. 另请注意，当您返回单元格的高度时，只需将标签的高度和每个标签之间的偏移差相加即可。否则，您的标签可能会出现在单元格之外。IE。如果用户标签的高度为 40，而时间标签的高度为 40。那么总单元格高度应为 80+。希望你明白了。

# python - 使用带有正则表达式的 minidom 解析 XML

> ID：14225315
> 
> 赞同：-1
> 
> 时间：2013-01-08T22:42:32.847
> 
> 标签：python, xml, regex, unicode

我正在尝试解析一些 XML，寻找标签名称为“ip”的元素最终我需要一个包含 IP 地址的字符串列表。这是我尝试过的：

```
def parseHosts(xmldoc):
  hostsNode = xmldoc.firstChild
  xmlList = hostsNode.getElementsByTagName("ip")

  ipList = []
  for ip in xmlList:
    ipList.append(ip.childNodes[0].nodeValue)

  print ipList
>>>[u'172.16.60.92', u'172.16.60.89', u'\n              ', u'172.16.60.90', u'172.16.60.91', u'172.16.60.93'] 
```

没关系。但我需要一个 IP 地址字符串列表...我不希望节点为空。只是一个很好的地址列表，如下所示：

```
['172.16.60.1', '172.16.60.5', 172.16.60.100'] 
```

我尝试了一些带有列表理解的正则表达式

```
 regex = re.compile(r'172\.16\.[0-9]*\.[0-9]*')
  [m.group(0) for l in ipList for m in [regex.search(1)] if m] 
```

但我收到以下错误

```
File "myParser.py", line 47, in parseHosts
[m.group(0) for l in ipList for m in [regex.search(1)] if m]
TypeError: expected string or buffer 
```

并尝试我可能无法找到 ipList 正在使用的类型，`type(ipList)`也无法弄清楚如何使这些东西成为字符串。

另外......摆脱那些Unicode的东西会很好。

很明显，我已经走到了某个地方的深处，但我不知道该去哪里找。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-08T22:48:20.107

让我们回到您的原始代码。它最终在`ipList`：

```
[u'172.16.60.92', u'172.16.60.89', u'\n              ', u'172.16.60.90', u'172.16.60.91', u'172.16.60.93'] 
```

这里唯一的问题是它包含充满空格的字符串，以及带有 IP 地址的字符串，对吧？

所以，让我们在事后过滤它：

```
In [51]: ipList = [u'172.16.60.92', u'172.16.60.89', u'\n              ', u'172.16.60.90', u'172.16.60.91', u'172.16.60.93']

In [52]: ipList = [ip for ip in ipList if ip.strip()]

In [53]: ipList
Out[53]: 
['172.16.60.92',
 '172.16.60.89',
 '172.16.60.90',
 '172.16.60.91',
 '172.16.60.93'] 
```

你完成了！

为什么这行得通？好吧，`ip.strip()`将从左侧和右侧删除所有空格。将结果粘贴到`if`语句中，如果有任何剩余，则为真，如果没有任何剩余，则为假。

但显然，您可以将相同的条件移回原始循环，将其放在`append`调用之前，效果完全相同：

```
def parseHosts(xmldoc):
  hostsNode = xmldoc.firstChild
  xmlList = hostsNode.getElementsByTagName("ip")

  ipList = []
  for ip in xmlList:
    ipstr = ip.childNodes[0].nodeValue
    if ipstr.strip():
      ipList.append(ipstr) 
```

但是整个`ipList`部分显然只是列表理解的冗长版本，所以：

```
def parseHosts(xmldoc):
  hostsNode = xmldoc.firstChild
  xmlList = hostsNode.getElementsByTagName("ip")
  ipList = [ip.childNodes[0].nodeValue for ip in xmlList
            if ip.childNodes[0].nodeValue.strip()] 
```

至于您尝试解决此问题：

```
[m.group(0) for l in ipList for m in [regex.search(1)] if m] 
```

每当嵌套列表推导的作用不是很明显时，将其分成两个推导。

但是让我们将其重写为显式循环。这不仅使它更容易理解，而且使调试更容易：

```
result = []
for l in ipList:
    for m in [regex.search(1)]:
        if m:
            result.append(m.group(0)) 
```

当你运行它时，你会在第三行得到一个异常，原因应该很明显。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-08T22:56:54.313

你可以使用`filter(regex.match,ipList)`：

```
import re
ipList=[u'172.16.60.92', u'172.16.60.89', u'\n              ', u'172.16.60.90', u'172.16.60.91', u'172.16.60.93']
regex = re.compile(r'172\.16\.[0-9]*\.[0-9]*')
filter(regex.match,ipList)

out:

[u'172.16.60.92',
 u'172.16.60.89',
 u'172.16.60.90',
 u'172.16.60.91',
 u'172.16.60.93'] 
```

# ajax - primefaces p:selectBooleanButton 侦听器未在嵌套 ui:repeat 中触发

> ID：14225322
> 
> 赞同：5
> 
> 时间：2013-01-08T22:43:23.743
> 
> 标签：ajax, primefaces, listener, repeat

为父 ui:repeat 中的 p:selectBooleanButton 触发侦听器，但不会为内部/子 ui:repeat 触发 p:selectBooleanButton 的侦听器。

我们不能使用嵌套形式。有什么建议么。

```
<h:form prependId="false">
 <ui:repeat value="#{xBean.sectionsList}" var="sectionItem">
  <p:fieldset>
   <p:selectBooleanButton onLabel="ON" offLabel="OFF" value="#{sectionItem.checked}">
    <p:ajax listener="#{xBean.selectSection}"/>
   </p:selectBooleanButton> :
   <ui:repeat value="#{sectionItem.sectionOptionsList}" var="sectionOptionItem">            
    <p:selectBooleanButton onLabel="ON" offLabel="OFF" value="#{sectionOptionItem.checked}">
     <p:ajax listener="#{xBean.selectSectionOption}"/>
    </p:selectBooleanButton>
    </ui:repeat>
   </p:fieldset>
 </ui:repeat>
</h:form> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-24T12:11:04.300

这`<ui:repeat>`是一个视图渲染时间标签。因此，它实际存在于 JSF 组件树中，并根据需要迭代该值多次生成其 HTML 输出。

换句话说，they(p:selectBooleanButton) 需要在视图构建期间而不是视图渲染期间进行准备。

JSTL`<c:forEach>`是一个视图构建时间标记。它将在物理上生成多个组件到 JSF 组件树中。

# file - 使用 VBA (excel) 将特殊的 ascii 字符插入文件

> ID：14225325
> 
> 赞同：2
> 
> 时间：2013-01-08T22:43:31.457
> 
> 标签：file, vba, text, escaping, ascii

我对 VBA 相当陌生，但对一般的编码并不陌生。我有一个 Excel 工作表，我需要将其中的一部分导出到文本文件中。但是，为了确保转义字符不会与工作表中写入的任何内容发生冲突，并与我们公司其他（Java 和 C）应用程序中处理转义字符的方式相匹配，我想使用 ascii 字符“[刺](http://www.theasciicode.com.ar/extended-ascii-code/lowercase-letter-thorn-ascii-code-231.html "点击这里看看刺是什么")”。

我知道的一些语言，比如 perl，只会让你输入转义字符和符号的 ascii 数字。例如，我可以输入“\231”以获得“[刺](http://www.theasciicode.com.ar/extended-ascii-code/lowercase-letter-thorn-ascii-code-231.html "点击这里看看刺是什么")”。这似乎在 VBA 中不受支持。或者如果是，我不确定如何。

最后，下面是我想如何实现代码的简短片段，仅包含关键语句。如果您有更好的建议，或者知道为什么这不是最好的方法，请告诉我。

```
Open sFullPath For Output As #1 
```

（...一些代码来捕获要写入文件下一行的值...）

```
sLine = Join(sValues, <the thorn character>)
Print #1, sLine 
```

上面的代码将放置在一个循环中，该循环将重新生成“sValues”，即下一行中要打印到文本文件的相关单元格集。

非常感谢！
问候，
迈克

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-09T01:27:12.190

要使用代码编号打印 ASCII 字符，请使用`chr()`函数

扩展 ASCII 并不是所有平台的标准。无论出于何种原因，所需的数字都是 222。

所以你需要

```
sLine = Join(sValues, chr(222))
Print #1, sLine 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-09T01:33:15.600

尝试替换`<the thorn character>`为`Chr(254)`. 让我知道情况如何。

# sql - 连接来自 2 个表的信息

> ID：14225327
> 
> 赞同：0
> 
> 时间：2013-01-08T22:43:39.163
> 
> 标签：sql, sql-server, join

我目前有 2 个表，其中包含有关项目的信息。第一个表显示给定项目编号的各种名称：

```
Item No   Name
1         Name1
1         Name2
1         Name3 
```

第二个表显示给定项目编号的不同位置：

```
Item No  Location
1        Location1
1        Location2 
```

我目前正在使用以下语句来加入这两个表

```
Select * 
from FirstTable a
Left Join 
(
   Select * 
   from SecondTable
) b 
   on a.itemno = b.itemno 
```

我最终得到了这些数据：

```
Item No    Name       Location
1          Name1      Location1
1          Name1      Location2
1          Name2      Location1
1          Name2      Location2
1          Name3      Location1
1          Name3      Location2 
```

我想结束的是：

```
Item No    Name       Location
1          Name1      Location1
1          Name2      Location2
1          Name3      NULL 
```

我怎样才能达到我想要的结果？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-08T22:47:23.110

如何使用这样的东西。这将泛型分配`row_number()`给表中的每个值，然后您加入该行号值：

```
select i.[item no],
  i.name,
  l.location
from
(
  select [item no], name,
    row_number() over(partition by [item no] order by name) rn
  from item
) i
full outer join
(
  select [item no], location,
    row_number() over(partition by [item no] order by location) rn
  from locations
) l
  on i.rn = l.rn 
```

请参阅[带有演示的 SQL Fiddle](http://sqlfiddle.com/#!3/4f29b/1)

您的样本数据的结果是：

```
| ITEM NO |  NAME |  LOCATION |
-------------------------------
|       1 | Name1 | Location1 |
|       1 | Name2 | Location2 |
|       1 | Name3 |    (null) | 
```

# iphone - 识别 NSString 中的几个整数

> ID：14225328
> 
> 赞同：0
> 
> 时间：2013-01-08T22:43:47.883
> 
> 标签：iphone, objective-c, ios, substring

我正在以这种格式从服务器接收字符串：

> 0_1_2_3

我的任务是从这个字符串中选择数字来填充四个标签。第一个想法是：

```
NSString *res1 = [result substringWithRange:NSMakeRange(0, 1)];
[firstLabel setText:res1]; 
```

用适当的标签四次。但是操作会重复很多次，每次我都会收到一个数字值增加的字符串。因此，当每个数字都是小数时，此代码将不起作用。那么我怎样才能以适当的方式独立于它们的长度跟踪每个数字呢？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-08T22:48:58.627

`NSString`附带一个方便的方法，称为[`-componentsSeparatedByString:`](https://developer.apple.com/library/mac/documentation/Cocoa/Reference/Foundation/Classes/NSString_Class/Reference/NSString.html#//apple_ref/doc/uid/20000154-componentsSeparatedByString_)

```
NSString *myString = @"0_1_2_3";
NSArray *myDigitStrings = [myString componentsSeparatedByString:@"_"];

/* access digit strings from myDigitStrings array by index or fast enumeration... */
for (NSString *myDigitString in myDigitStrings)
    NSLog(@"digit string: %@", myDigitString); 
```

# ios - Phonegap iOS InAppBrowser 缩放

> ID：14225331
> 
> 赞同：23
> 
> 时间：2013-01-08T22:44:10.933
> 
> 标签：ios, cordova

我最近升级到 Cordova 2.3.0 并将 InAppBrowser 添加到我的应用程序（代替 ChildBrowser 插件）。我希望 InAppBrowser 支持捏缩放，但我无法让它工作。有谁知道当前是否支持此功能，如果支持，我该如何启用它？

* * *

## 回答 #1

> 赞同：51
> 
> 时间：2013-01-16T14:25:11.917

此功能目前在 Phonegap/Cordova 2.3 中不可用。它应在 Phonegap/Cordova 2.4 中添加（除其他外）：

[https://issues.apache.org/jira/browse/CB-2071](https://issues.apache.org/jira/browse/CB-2071)

编辑：

我可以确认这已经在 2.4.0 中实现了。可以按如下方式启用捏合缩放：

```
window.open(url, '_blank', 'EnableViewPortScale=yes'); 
```

# datagrid - .NET 4.0 DataGridCombobox SelectionChanged 问题

> ID：14225339
> 
> 赞同：0
> 
> 时间：2013-01-08T22:44:32.167
> 
> 标签：datagrid, datagridcomboboxcolumn, selectionchanged

我的程序中有一个要求，即一旦在组合框中选择了一个项目，组合框中的对象绑定（来自 ViewModel）就会更新。目前，对象仅在通过按 Enter 或离开单元格提交编辑后更新。用户不想要额外的步骤。

我的想法是让在组合框中选择一个项目的行为触发 CommitEdit() 方法，然后触发 CancelEdit()。但是，我似乎无法找到一种方法来挂钩 DataGridComboBoxColumn 的 SelectionChanged 事件，因为它不可用。

其他建议是在视图模型中侦听属性更改事件，但在单元格编辑完成之前不会更改属性。

谁能想到一种方法来导致在 DataGridCombobox 中选择新项目（索引）以关闭单元格的编辑，就像用户按下 Enter 或离开单元格一样？

注意：由于客户限制，我不能使用 .NET 4.5。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-24T20:10:14.967

我遇到了类似的问题，但我刚刚找到了使用附加属性的解决方案，这可能无法完全解决您的问题，但它有助于解决数据网格选择更改问题。

下面是附加的属性和处理程序方法

```
public static readonly DependencyProperty ComboBoxSelectionChangedProperty = DependencyProperty.RegisterAttached("ComboBoxSelectionChangedCommand",
                                                                                                              typeof(ICommand),
                                                                                                              typeof(SpDataGrid),
                                                                                                              new PropertyMetadata(new PropertyChangedCallback(AttachOrRemoveDataGridEvent)));

public static void AttachOrRemoveDataGridEvent(DependencyObject obj, DependencyPropertyChangedEventArgs args)
{
  DataGrid dataGrid = obj as DataGrid;
  if (dataGrid != null)
  {   
      if (args.Property == ComboBoxSelectionChangedProperty)
      {
        dataGrid.SelectionChanged += OnComboBoxSelectionChanged;
      }
    }
    else if (args.OldValue != null && args.NewValue == null)
    { if (args.Property == ComboBoxSelectionChangedProperty)
      {
        dataGrid.SelectionChanged -= OnComboBoxSelectionChanged;
      }
}
}

private static void OnComboBoxSelectionChanged(object sender, SelectionChangedEventArgs args)
{
  DependencyObject obj = sender as DependencyObject;
  ICommand cmd = (ICommand)obj.GetValue(ComboBoxSelectionChangedProperty);
  DataGrid grid = sender as DataGrid;

  if (args.OriginalSource is ComboBox)
  {
    if (grid.CurrentCell.Item != DependencyProperty.UnsetValue)
    {
      //grid.CommitEdit(DataGridEditingUnit.Row, true);
      ExecuteCommand(cmd, grid.CurrentCell.Item);
    }
  }
} 
```

SpDataGrid 是我从数据网格继承的自定义控件。

我在 generic.xaml 中添加了以下样式，因为我使用资源字典作为样式（您当然可以在数据网格中添加）。

```
<Style TargetType="{x:Type Custom:SpDataGrid}">
     <Setter Property="Custom:SpDataGrid.ComboBoxSelectionChangedCommand" Value="{Binding ComboBoxSelectionChanged}"/>
 </Style> 
```

ComboBoxSelectionChanged 是我的视图模型中的命令。OnComboBoxSelectionChanged 我评论了 commitedit，因为在我的情况下，值已经更新。

如果有任何不清楚或有任何问题，请告诉我。希望这可以帮助。

# sharepoint - 在 Chrome 中禁用 Sharepoint 滚动条

> ID：14225344
> 
> 赞同：0
> 
> 时间：2013-01-08T22:44:56.473
> 
> 标签：sharepoint, google-chrome

在页面 [https://connect.wels.net/AOM/schools/Pages/default.aspx](https://connect.wels.net/AOM/schools/Pages/default.aspx)

滚动条在 Chrome 中不起作用（已禁用）。它们在其他浏览器中很好。我很想解决这个问题。有时它适用于 Chrome。有时放大和缩小可以修复它。其他时候，它没有帮助。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-26T22:44:57.520

这是在这个网站上回答的：

[http://withinsharepoint.com/archives/256](http://withinsharepoint.com/archives/256)

> 原因实际上是围绕执行特定位非常重要的 onload JavaScript 的时间问题。
> 
> 未执行的位（并导致系统性问题，它导致的问题之一是滚动怪异）是：

```
body onload="if(typeof(_spBodyOnLoadWrapper) != 'undefined'; _spBodyOnLoadWrapper();" 
```

> 这条线的意思基本上是页面是否从 init.js 加载了 onloadwrapper 函数。这个 onloadwrapper 做了很多事情，比如加载 ECMAScript 以支持 SP.JS，为任何 onload 事件执行页面 JavaScript，以及任何客户端交互。因此，基本上，当它几乎不执行时，SharePoint 中的任何客户端代码都无法或将起作用，或者您拥有的任何依赖于它的任何脚本。滚动只是冰山一角。现在好消息是，它很容易修复（我与微软有一个案例，希望在未来的累积更新中包含修复）。

这是对我有用的修复程序。将其放在母版页的顶部。这将修复 Chrome 和 Safari 并帮助您的 _spBodyOnLoadFunctionNames 函数工作。

[https://gist.github.com/alirobe/4224245](https://gist.github.com/alirobe/4224245) 通过[http://withinsharepoint.com/archives/256](http://withinsharepoint.com/archives/256)

```
if (jQuery.browser.webkit) {
jQuery(document).ready(function () {
    var interval;
    function loopCheck() {
        if (typeof (_spBodyOnLoadWrapper) !== "undefined" && _spBodyOnLoadCalled == false) 
            _spBodyOnLoadWrapper();
         else 
            window.clearInterval(interval);
    }
    // Give SP a chance..
    setTimeout(function () { interval = window.setInterval(loopCheck, 30); }, 120);
});
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-09T07:03:51.267

这是 Sharepoint 中 Chrome 浏览器的常见问题，因为 Sharepoint 支持 Chrome 浏览器的有限功能。

Sharepoint 页面中的 Javascript 加载顺序也会发生这种情况。

到目前为止，我找不到任何解决方案

请参考：[https ://answers.uchicago.edu/page.php?id=24860](https://answers.uchicago.edu/page.php?id=24860)

# vba - 如果另一个单元格匹配时单元格为空，如何在行之间复制excel中的单元格数据

> ID：14225345
> 
> 赞同：1
> 
> 时间：2013-01-08T22:44:57.157
> 
> 标签：vba, excel

我知道标题真的很啰嗦，我会尽力解释

我正在尝试将 Magento 产品放入 Zen Cart（仅限背景 - 不应该相关）。

我有一个 excel 2010 xls 电子表格，其中有大量产品数据：skus、价格、类别等……你明白了。我列出了每个产品及其数据一次，每个产品都有一个唯一的 SKU 字段。

但是......其中一些产品属于多个类别，而我导入的方式，每个产品都需要多次列出，每个类别一次。

所以，我做了一个包含两列的 sql 转储；sku 和类别。我已将这些值作为新行粘贴到 excel 中，所以现在我遇到了这样的情况（有更多条目）：

![在此处输入图像描述](../Images/795698412a909ada317ab7770460c176.png)

正如您所看到的，对于每个 sku（左突出显示），除了类别（右突出显示）之外，还有一个包含所有数据的条目，然后它所属的每个类别都有一个附加条目，其中仅包含类别和 sku，但没有其他数据。

所以，我需要做的是如何在具有相同 sku 的所有单元格中复制所有数据（除了类别列）。有谁知道如何在不按 Ctrl+V 数百次的情况下实现这一点。我意识到 VBA 可能很容易处理这个问题，但我在这方面没有任何线索。

非常感谢任何帮助

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-08T23:16:45.843

我希望您愿意使用第二张表，并参考数据而不是实际复制。

在 Sheet2 上，设置`A1`为`=IF(Sheet1!A1="", "", Sheet1!A1)`。将其向下拖动（扩展/填充）`A500`（与 Sheet1 上的数据一样多，或者进一步，以允许增长）。也拖动`A1`到`AA1`，然后将其向下拖动到`AA500`。

然后设置`B2`为`=IF($AA2="", Sheet1!B2, B1)`，将其拖动到`Z2`，然后`B2:Z2`向下拖动到`B500:Z500`。

PS 如果您的任何数据（列）是日期，您可能需要将它们明确格式化为 Sheet2 上的日期。对于以任何非默认方式格式化的任何其他值（例如，货币或百分比）也是如此。可能只需要对其中包含值的单元格（而不是空白单元格）执行此*操作*。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-09T00:09:59.597

您不需要 VBA，除非您需要多次执行此操作。
假设调用了包含您的数据的工作`Source`表并调用了具有结果的工作表`Dest`，您可以按照工作表上的以下步骤获得所需的内容`Dest`：

*   A1型`=Source!A1`
*   A2型`=IF(ISBLANK(Source!A2),A1,Source!A2)`
*   选择范围 A1:XX1（其中 XX 是工作表 Source 的最后一列）
*   按 Ctrl+R（将第一个单元格复制到右侧）
*   选择范围 A2:XX##（其中 ## 是工作表 Source 的最后一行）
*   按 Ctrl+R 和 Ctrl+D（向右和向下复制）

下面是对发生的事情的解释：
第一行是从 Source 中复制的。
仅当该单元格为空时，才从 Source 复制第二行的每个单元格，否则复制上面的单元格。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-09T07:41:18.683

这是快速而肮脏的解决方案：

1.  选择需要填写的栏目
2.  按转到`Ctrl-G`
3.  特殊的“Alt-S”
4.  空格 ( `Alt-K`, `Enter`)
5.  这应该选择所有空白单元格。现在键入 `=B2`（假设您在 B3 中，即使用活动单元格上方的单元格） 重要提示：按`Ctrl-Enter`而不是 Enter 输入公式。

完毕！

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-09T00:48:10.420

在新的工作表上，通过在单元格 A1 中键​​入 1，在单元格 A2 中键入 2，然后选择这两个单元格并通过 Z 填充，在第 1 行的顶部获得数字 1-26。

现在在 A2 中键入以下公式`=VLOOKUP(Sheet1!$A1,Sheet1!$A:$AA,VALUE(A$1),FALSE)` 在范围 A2:Z## 中填充此公式（其中 ## 表示您的最后一行数据）。然后将 Sheet1 中的 Row1 复制到 Sheet2 上的 Row1。

这个公式会将数据行直接复制到它们下面的空行中（假设 sku 仅在有一行新信息的地方发生变化。

这将是所有活动公式，因此我建议在 Sheet2 上选择所有并在单元格 A1 中单击鼠标右键，然后按值粘贴特殊值。

# import - 为什么 Orca 的“导入文本文件”选项显示为灰色？

> ID：14225346
> 
> 赞同：0
> 
> 时间：2013-01-08T22:45:00.473
> 
> 标签：import, windows-installer, orca

我正在尝试将文本文件导入 MSI 单元，但 Orca 的选项被禁用。

![在此处输入图像描述](../Images/e34990d2da7e9bbe32b9389c37826b10.png)

我的文件不是只读的或正在使用中。如何启用该选项？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-08T23:00:44.600

只有无界字符串列 ( `String[0]`) 与插入文本文件选项兼容。其他列类型 - 甚至`String[255]`- 不接受（并且不会截断）任意长度的文本。

# arrays - 在Visual Basic中循环遍历数据集并将数据存储在数组中

> ID：14225349
> 
> 赞同：0
> 
> 时间：2013-01-08T22:45:10.333
> 
> 标签：arrays, vb.net, loops, dataset

我正在尝试将所有组加载到`Array`然后循环遍历这些组，并查看每个代理有多少资产，如果资产不仅仅是代理而不是将它们移动到我们的虚拟组 0。但我对此并不陌生，`DataSet`并且`TableAdapator`.

基本上是集团--代理--资产

```
0--0--10
1--3--3
2--3--5
3--10--15 
```

所以第 2 组有 2 个额外资产我想将它们移动到我们的空组 0

请指导

```
Dim rs, lines
rs = cn.Execute("select grp from tskmsgrp where listid = 0;")

Dim da As New System.Data.OleDb.OleDbDataAdapter()
Dim da_line As New System.Data.OleDb.OleDbDataAdapter()
Dim ds As New DataSet()
da.Fill(ds, rs, "grp")

MsgBox("There are  total products." & ds.Tables(0).Rows.Count.ToString)
For Each a As DataRow In ds.Tables(0).Rows
    lines = cn.Execute("select count(*) from tsklines where grp ='" & a(0) & "';")
    Dim ds_lines As New DataSet()
    da_line.Fill(ds_lines, lines, "lines")
    MsgBox("Lines for group." & a(0) & " -- " & ds_lines.Tables(0).Rows.Count.ToString)
Next 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-09T03:26:39.973

几点——你可以弄清楚细节。

1.  您不需要循环内的 select 语句，因为您可以访问 a 行中的数据。
2.  您不需要再次填充数据集，只需更新 ds. 循环完成后，您可以一次全部更新。

# c++ - Qt Creator + Qt 5 + Mac OS 无法在调试窗口中显示 QString

> ID：14225353
> 
> 赞同：3
> 
> 时间：2013-01-08T22:45:20.230
> 
> 标签：c++, macos, qt, qt5

我在 Mac OS X 10.8.2 上。获得了全新的 qt5 和 qt creator 二进制文件。

调试时看不到 QString 值。只是某种“@45644681fd3sd”

我已经构建了调试器助手，尝试将“dumper.cpp”添加到我的项目中，链接到 libdumper.1.0.0.dylib 并没有真正帮助我。

调试器是标准 Apple 的 GNU gdb 6.3.50。你有什么想法？提前致谢！

# python - 如何在 SQLAlchemy 中创建两个相互依赖的对象？

> ID：14225356
> 
> 赞同：2
> 
> 时间：2013-01-08T22:45:38.233
> 
> 标签：python, session, transactions, sqlalchemy, flask-sqlalchemy

我有两个 Python 类`Note`并`Link`映射到 Postgresql 表。 `Note`具有对 , 的外键引用`Link`，同时`Link`通过一段 JSON 文本指向节点。链接指向除`Note`s 之外的其他东西，但这在这里无关紧要。

```
 Note
+------+------------------+---------+
|  ID  |       NAME       | NOTE_ID |
+------+------------------+---------+
|   1  |  Alice           |     5   |
|   2  |  Bob             |    20   |
|   3  |  Carla           |     6   |
+------+------------------+---------+

          Link
+------+--------------+
|  ID  |  CONTENT     |
+------+--------------+
| ...  |    ...       |
|   5  |  {"t":1}     |
|   6  |  {"t":3}     |
| ...  |    ...       |
|  20  |  {"t":2}     |
+------+--------------+ 
```

现在我想要的是每当我创建一个新的`Note`

```
note = Note('Danielle') 
```

它会自动进入该行

```
(4, 'Danielle', 21) 
```

进入`Note`, 并进入

```
(21, '{"t":4}') 
```

进入`Link`. 到目前为止，这是我尝试过的：我创建了`Note`对象，然后尝试`Link`在`@events.after_insert`事件中创建：

```
class Note(Entity):
    name = Field(Unicode)
    link = ManyToOne('Link')

    . . .

    @events.after_insert
    def create_link(self):
        """
        Create and persist the short link for this note.  Must be done
        in this after_insert event because the link table has a foreign
        key that points back to the note.  We need the note to be 
        already inserted so we can use its id.
        """
        self.link = Link.build_link_for_note(self)
        elixir.session.flush()
        print("NOTE %s GOT LINK %s" % (self, self.link)) 
```

在我有的链接课程中

```
class Link(Entity):
    . . . 
    @classmethod
    def build_link_for_note(cls, note):
        return Link(content='{"id": %d}' % note.id) 
```

两个表都有自动递增的主键，所以不用担心。我使用此代码得到的错误是：

```
File ".../sqlalchemy/orm/session.py", line 1469, in flush
    raise sa_exc.InvalidRequestError("Session is already flushing")
    InvalidRequestError: Session is already flushing 
```

我会买那个。在 Note 存储到数据库*之后*，该`@after_insert`事件被调用（我认为） ，这发生在当前会话刷新期间。当然，如果我删除呼叫，那么它当然会打印*`elixir.session.flush()`*

 *```
NOTE <Note id:4 name:Danielle> GOT LINK <id:None content:{"t": 4}> 
```

这又是有道理的，因为我无法保留链接！

所以我的问题是，我怎样才能在一个请求中同时创建一个注释和一个链接，以便相互依赖的 id 可用并正确记录？

PS我知道这里的模式有点不寻常，我可以通过（1）产生一个异步创建链接的任务或（2）让`Link.content`方法懒惰地创建链接来解决这个问题。这些解决方案需要一些并发注意，所以我真的希望一个简单、直接的 SQLAlchemy 解决方案与一个会话可以工作。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-01-09T16:40:48.790

我建议不要使用 Elixir 的方法，例如误用 SQLAlchemy 的 API 的“save()”。这是使用标准 SQLAlchemy 事件的上述方法。一切都在一次冲洗中实现。

```
from sqlalchemy import *
from sqlalchemy.orm import *
from sqlalchemy.ext.declarative import declarative_base
from sqlalchemy import event
import json

Base = declarative_base()

class Note(Base):
    __tablename__ = "note"

    id = Column(Integer, primary_key=True)
    name = Column(String)
    note_id = Column(Integer, ForeignKey('link.id'))

    link = relationship("Link")

    # if using __init__ here is distasteful to you,
    # feel free to use the "init" event illustrated
    # below instead
    def __init__(self, name):
        self.name = name
        self.link = Link()

class Link(Base):
    __tablename__ = "link"

    id = Column(Integer, primary_key=True)
    content = Column(String)

# using an event instead of Note.__init__
#@event.listens_for(Note, "init")
#def init(target, args, kwargs):
#    target.link = Link()

@event.listens_for(Note, "after_insert")
def after_insert(mapper, connection, target):
    connection.execute(
        Link.__table__.update().\
            values(content=json.dumps({"t": target.id}))
    )

e = create_engine("sqlite://", echo=True)

Base.metadata.create_all(e)

s = Session(e)

note = Note('Danielle')

s.add(note)
s.commit()

note = s.query(Note).first()
assert s.query(Link.content).scalar() == ('{"t": %d}' % note.id) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-08T23:04:34.857

由于两个对象都有来自数据库的自动生成的 ID，*并且*想要存储彼此的 ID，因此您需要先保存两个对象，然后再次保存其中一个对象，并使用另一个对象的更新 ID。

所以我会删除`flush`调用，并可能`save`为所涉及的每个对象显式调用。*

# php - 如何使用 PHPUnit 测试工厂/策略实现

> ID：14225357
> 
> 赞同：0
> 
> 时间：2013-01-08T22:45:52.160
> 
> 标签：php, mocking, phpunit, factory, strategy-pattern

我有一个工厂类，它根据给定文件的扩展名返回编写器策略：

```
public static function getWriterForFile($file)
{
    // create file info object
    $fileInfo = new \SplFileInfo($file);
    // check that an extension is present
    if ('' === $extension = $fileInfo->getExtension()) {
        throw new \RuntimeException(
            'No extension found in target file: ' . $file
        );
    }
    // build a class name using the file extension
    $className = 'MyNamespace\Writer\Strategy\\'
        . ucfirst(strtolower($extension))
        . 'Writer';
    // attempt to get an instance of the class
    if (!in_array($className, get_declared_classes())) {
        throw new \RuntimeException(
            'No writer could be found for the extension: ' . $extension
        );
    }
    $instance = new $className();
    $instance->setTargetFile($file);
    return $instance;
} 
```

我所有的策略都实现了相同的接口，例如：

```
class CsvWriter implements WriterStrategyInterface
{
    public function setTargetFile($file)
    {
        ...
    }

    public function writeLine(array $data)
    {
        ...
    }

    public function flush()
    {
        ...
    }
} 
```

我希望能够使用虚拟扩展来测试此方法，以便我的测试不依赖于任何现有的特定策略。我尝试使用设置的类名为接口创建一个模拟，但这似乎没有声明模拟类名：

```
public function testExpectedWriterStrategyReturned()
{
    $mockWriter = $this->getMock(
        'MyNamespace\Writer\Strategy\WriterStrategyInterface',
        array(),
        array(),
        'SssWriter'
    );

    $file = 'extension.sss';

    $writer = MyNamespace\Writer\WriterFactory::getWriterForFile($file);

    $this->assertInstanceOf('MyNamespace\Writer\Strategy\WriterStrategyInterface', $writer);;
} 
```

有什么办法让我为工厂加载一个模拟编写器策略，或者我应该重构工厂方法以使其更具可测试性？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-09T02:15:21.040

该工厂的主要目的和职责是创建对象。

恕我直言，您应该使用

```
$this->assertInstanceOf('class', $factory->getWriterForFile($file)); 
```

### 为什么不进一步抽象呢？

您可以以某种方式实现，以便工厂将对象创建分派给另一个类。

拥有一个“对象创建者”：

```
$class = new ReflectionClass($class);
$instance = $class->newInstanceArgs($args); 
```

或类似的东西，但除了“测试看起来更像是一个单元测试”之外，你的收获是什么？你并没有真正改进你的代码库，只是为了测试能力而改变对我来说总是有点好笑。

我会将工厂测试视为集成/接线测试，以确保您的所有工厂实际工作并产生所需的对象。

* * *

对于您当前的代码示例，我建议的唯一更改是更改两件事：

### a) 使工厂方法非静态

如果你没有一个很好的理由，你不会从静态工厂获得任何东西，除非你不能注入它并使其成为静态使其可以从全局范围访问，因此将依赖项放入工厂将需要更多的全局变量和很快。如果你对工厂进行 DI，通常使它们成为合适的对象也有助于避免未来的问题

### b) 不要在工厂里做diskIo。使用：getWriterForFile(\SplFileInfo $file)

工厂不应该关心文件系统。如果它需要一个现有文件，它应该需要一个并将如何处理错误的详细信息留给消费者。

这给您带来的好处是您还可以通过 a`SplTempFileObject`这将使测试更容易，并使您的工厂即使出于生产目的也可以独立于文件系统。

# python - 在 Ubuntu 上支持 littlecms 的 Python PIL

> ID：14225361
> 
> 赞同：2
> 
> 时间：2013-01-08T22:46:06.923
> 
> 标签：python, ubuntu, python-imaging-library

我在设置带有 littlecms 支持的 python PIL 时遇到问题。我没有从我的谷歌搜索中看到任何好的教程。

以下是我的主要问题：

*   littlecms 需要安装的 Ubuntu 软件包的名称是什么？
*   如有必要，我`LCMS_ROOT`应该在 PIL 的 setup.py 中将变量设置为哪个目录？

这是我刚刚运行的结果`pip install PIL`

```
--------------------------------------------------------------------
*** TKINTER support not available
--- JPEG support available
--- ZLIB (PNG/ZIP) support available
--- FREETYPE2 support available
*** LITTLECMS support not available
-------------------------------------------------------------------- 
```

使用 Ubuntu 12.04 32 位

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-08T22:57:10.563

在 Ubuntu 中安装 LittleCMS：

```
sudo apt-get install liblcms liblcms-dev liblcms-utils 
```

然后，在安装 PIL 时，最好从源代码安装，**但前提** `pip install PIL` **是没有**将 LittleCMS 支持列为可用（如您最初的问题中所述）。如果确实需要从源安装：

您将需要`LCMS_ROOT = [path]`在 PIL 中查找/添加一行`setup.py`（此行应该靠近`JPEG_ROOT`and`ZLIB_ROOT`行，如果没有，请添加它），这是您指定 LittleCMS 路径的地方。

的默认安装位置`liblcms`是`/usr/lib64`64 位 Ubuntu。

`LCMS_ROOT = None`如果您已安装到默认位置，您可能会逃脱。

完成此操作后，尝试运行`python setup.py build_ext -i`并在输出中，您应该希望看到类似

`--- LITTLECMS support available`

然后做`python setup.py install`，你应该好好去！

# jquery - 同位素和 jquery.cookie

> ID：14225363
> 
> 赞同：0
> 
> 时间：2013-01-08T22:46:12.743
> 
> 标签：jquery, jquery-isotope, jquery-cookie

我有一个用复选框过滤的 jquery 同位素。复选框的值是使用 jquery cookie 检索的，我想使用复选框的值设置初始过滤器。我做了一个jsfiddle：http: [//jsfiddle.net/qdzcP/10/](http://jsfiddle.net/qdzcP/10/)

我正在创建一个新变量

```
var initfilter = [];
$checkboxes.filter(':checked').each(function(){
  initfilter.push( this.value );
});
initfilter = initfilter.join(', '); 
```

然后在我加载同位素时将变量加载为过滤器

```
$container.isotope({
    itemSelector: '.item',
    filter: 'initfilter'
}); 
```

但是，初始化的过滤器似乎不正确。有人能指出我正确的方向吗？

非常感谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-08T22:50:44.773

您正在为过滤器分配一个字符串值`initfilter`。删除引号以使用变量

```
filter: initfilter 
```

**[小提琴](http://jsfiddle.net/wirey00/RNB8T/)**

# magento - 如何在 Magento 中以编程方式获取为项目订单选择的自定义选项的 SKU

> ID：14225368
> 
> 赞同：4
> 
> 时间：2013-01-08T22:46:28.320
> 
> 标签：magento, magento-1.7

我有一个产品有多个客户可以选择的自定义选项。举些例子：

产品： 10 朵花的花篮 (SKU 100) 定制选项：

*   红玫瑰数量：从 0 到 10 下拉（每个 SKU 200）

*   紫玫瑰数量：从 0 到 10 下拉（每个 SKU 300）

*   粉色郁金香数量：从 0 到 10 下拉（每个 SKU 400）

这样客户可以建立自己的篮子。但是，现在我必须为仓库系统导出我的订单，并且我需要列出带有值（数量）的自定义选项的 SKU。虽然我可以从 Order Item 中获取标签和值。没有 SKU。

我得到我的物品是这样的：

```
$orders = Mage::getModel('sales/order')->getCollection()
              ->addAttributeToFilter('status', array('eq' => 'processing'));
foreach ($orders as $order) {

  foreach ($order->getAllItems() as $order_item) {

      $optionsArr = $order_item->getProductOptions();

       if (count($optionsArr['options']) > 0) {
            foreach ($optionsArr['options'] as $option) {
                $optionTitle = $option['label'];
                $optionId = $option['option_id'];
                $optionValue = $option['value'];
                // no SKU ?!?! 
            }
        }

  }

} 
```

任何想法如何为每个选择的自定义选项获取 SKU？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-01T16:22:43.223

尝试加载产品并获取选项集合。

```
foreach($order->getAllItems() as $item) {
    $product = Mage::getModel('catalog/product')->load($item->getProductId());
    $options = $product->getProductOptionsCollection();
    foreach($options as $option) {
        echo $option->getSku();
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-01-15T07:22:21.823

你能不能试试这种方法。

```
foreach($order->getAllItems() as $_item) {
$customOptions = $_item->getProductOptions();

        foreach ($customOptions['options'] as $_eachOption) {
            $objModel = Mage::getModel('catalog/product_option_value')->load($_eachOption['option_value']);
            print_r($objModel->getData());
        }
} 
```

# javascript - 防止手动订阅在初始加载时触发

> ID：14225378
> 
> 赞同：2
> 
> 时间：2013-01-08T22:47:44.117
> 
> 标签：javascript, knockout.js

我有一个模型，我用来自服务器的数据填充。问题是，当最初填充该数据时，我的订阅正在触发，这是我不想要的。我只希望在用户与 UI 交互时触发订阅。

```
function ViewModel() {
    var self = this;

    //Populate the object.
    self.request = new Request(data);
    //Subscribe to one of the "properties" so that I can do stuff when the value changes.
    self.request.selectedId.subscribe(function(newValue) {
        //This is firing before the user interacts with the UI.
    });
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-08T22:54:44.367

通常你不需要手动订阅，但如果你想保留它们，因为你只需要做一次，你总是可以使用触发一次的标志。

```
self.initialLoad = true;
self.request.selectedId.subscribe(function(newValue) {
    if(self.initialLoad) self.initialLoad = false
    else {
    //This is firing before the user interacts with the UI.
    }
}); 
```

# ios - TestFlight - 构建权限列表中没有用户

> ID：14225381
> 
> 赞同：3
> 
> 时间：2013-01-08T22:47:47.243
> 
> 标签：ios, testing, testflight

我正在尝试通过 TestFlight 部署我的应用程序进行测试。我已经邀请了另外 2 个人加入我创建的团队并将他们添加到分发列表中，但该应用程序没有显示以供他们下载，它对我有用。

当我进入网站上的构建权限屏幕时，我看到的是：

![在此处输入图像描述](../Images/26a8eef3c5c56248cc05fab153d72322.png)

即使两个分发列表中都有 3 个人，也只有我出现在权限列表中。知道这里发生了什么吗？

**编辑：**这是在人员选项卡中看到的：

![在此处输入图像描述](../Images/67bbede36c82e9054e85f10a9a554676.png)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-08T22:59:18.700

您是否已将他们的 UDID 添加到配置文件、重建应用程序并上传包含其 UDID 的版本？来自[TestFlight 常见问题解答](http://help.testflightapp.com/customer/portal/articles/402851-testflight-faq)：

> 对于开发人员注册 TestFlight 并创建您的团队。邀请并收集团队成员的 UDID，并将它们添加到您的 Apple Developer Portal 和应用程序的配置文件中。构建 iPhone 应用程序 (.IPA) 并上传到 TestFlight。将构建分发给团队成员，让奇迹发生。接收反馈、监控测试人员的活动并在您舒适的椅子上执行完整的 beta 测试。团队中的开发人员还可以上传多个应用程序进行测试/内部分发。

这是验证他们的 UDID 是否在 IPA 中的明确方法：

*   解压.ipa
*   查看 Payload/ *appname* / embedded.mobileprovision
*   查看“ProvisionedDevices”数组

如果他们的 UDID 不存在，您需要检查您的配置文件并重建您的 app/ipa。TestFlight 在 IPA 中查找以确定为任何特定构建配置的人员。

# java - JList突变

> ID：14225387
> 
> 赞同：0
> 
> 时间：2013-01-08T22:47:59.647
> 
> 标签：java, swing, jlist, gridbaglayout

在下图中，底部`JComponent`是 a 中的`JList`（列表）`JScrollPane`。默认情况下，可见行数是 8 或 10，我不知道。但是突然间，当我对项目进行更多更改时，它变成了这个，现在我一次只能看到一个项目（fsgisfg）。如何更改一次显示的行数？

`list.setVisibleRowCount(8)`不起作用。

使用`list`扩展`AbstractListModel`作为模型。

主菜单`JFrame`使用`GridBagLayout`.

我不知道是什么可能导致这种情况发生，因为我什至尝试撤消项目中所做的所有更改，结果仍然相同。

```
private JList<String> list;
[...]

list = new JList<String>(); 
list.setVisibleRowCount(8); //doesn't change anything
[...]

JScrollPane scroll2 = new JScrollPane(list);
[...]

list.setModel(new BookListModel(library));
list.repaint(); //the model gets the data for the list, and refresh is needed

[...]

GridBagConstraints c = new GridBagConstraints();
c.gridx = 0;
c.gridy = 4;
c.gridwidth = 2;
frame.add(scroll2, c); 
```

[图片 http://dl.dropbox.com/u/71389667/problem.jpg](http://dl.dropbox.com/u/71389667/problem.jpg)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-09T04:52:14.403

嗯...现在很难找出导致问题的原因，所以首先我建议您在继续查找错误之前阅读[本教程...](http://docs.oracle.com/javase/tutorial/uiswing/components/list.html)

至于这一刻，我可能只是假设问题实际上可能来自布局管理器或这个方向的东西......尝试围绕 JList 包含面板（或您使用的组件......）布局管理器。似乎现在您正在使用某种**绝对**的，因此例如将其更改为 FlowLayout。

作为另一个提示，检查 ListModel 是否添加了空元素？

有关更多建议，很高兴看到更多代码......

* * *

报告是否有帮助

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-09T10:23:54.037

我想我已经找到了问题，但我不知道是什么原因造成的：首先，我的书以 xml 文件保存在磁盘上的一个文件夹（称为 Library）中；现在如果我删除这个文件夹，以便启用按钮创建库，JList 似乎是正常大小（显示 8 行）。即使我添加书籍，JList 保持不变，这很好。当我尝试实际更改已创建的 xml 文件时出现问题，因为默认情况下该文件看起来像这样

```
<?xml version="1.0" encoding="UTF-8"?>
<book name="name" author="author" isbn="isbn" />` 
```

如果我做到这一点

```
<?xml version="1.0" encoding="UTF-8"?>
<book name="name" author="" author="" >
<chapter title="chapter1">
    <paragraph>
        <sentence>sentence1</sentence>
        <sentence>sentence1</sentence>
        <sentence>sentence1</sentence>
        <sentence>sentence1</sentence>
    </paragraph>

</chapter>
</book> 
```

JList 显示搞砸了。

如果我这样做：

```
<?xml version="1.0" encoding="UTF-8"?>
<book name="fadsf" author="" isbn="" >
    <chapter title="chapter1">
         <paragraph>
            <sentence>sentence1</sentence>
            <sentence>sentence1</sentence>
            <sentence>sentence1</sentence>
    </paragraph>
    </chapter>
</book> 
```

它工作正常。如果我添加第四句标签，事情就会变得丑陋。

# c# - 方法参数是线程安全的吗？

> ID：14225396
> 
> 赞同：1
> 
> 时间：2013-01-08T22:48:29.160
> 
> 标签：c#

```
public void Remove(T item)
{
    locker.EnterWriteLock();        
    try
    {
        list.Remove(item);
    }
} 
```

以上是实例类的方法。说实例是`myObject`. 关于上面的片段，我的问题是：

线程一调用`myObject.Remove(A)`。
线程一执行`locker.EnterWriteLock()`。

线程两个调用`myObject.Remove(B)`。

线程一进入 try 块并执行`list.Remove()`。

此时的价值是`item`多少？ie`list.Remove()`会以 A 或 B 作为参数调用吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-08T22:56:00.620

每个线程都有自己的调用堆栈，方法参数存储在该堆栈中。堆栈不在线程之间共享。

在线程一个的堆栈中，有一行指示`Remove`正在被调用，并且包含“A”或对“A”的引用（取决于它是值还是引用类型）。

当线程二进入该方法时，它有自己的调用堆栈（线程 1 的堆栈在线程二运行时未使用），其中有一行指示`Remove`项目“B”的开始。然后该线程被挂起，它的调用堆栈未被使用，我们回到线程 1，其中项目“A”是调用堆栈上的内容。

在将来的某个时候，线程二将被重新激活，并且在它的调用堆栈上将有项目“B”。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-08T22:55:42.940

方法参数分配在调用该方法的线程的堆栈上。因此，每个线程都有自己的论点，它们不会相互影响。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-08T22:52:31.140

我怀疑你应该在这里锁定的是`list`变量。您正在调用它的`Remove`方法，并且如果此`list`变量是某种不是线程安全的类型，`List<T>`例如，如果从同一实例上的多个线程同时调用此方法`myObject`（这是您的`list`字段所在的位置） ，您可能会遇到麻烦. 就方法的论点而言，很难在方法的上下文中谈论它们的任何线程安全性。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-08T22:55:05.850

.Net 不提供对参数的任何继承锁定。但是，`list.Remove(item)`不修改`item`（假设它是标准`System.Collections`或实现）并且使用不同的参数两次调用相同的方法会创建（每个方法调用中`System.Collections.Generic`的一个）的两个副本，而不是一个。`item`

相反，我会锁定列表，因为大多数类的实例方法不能保证是线程安全的。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-01-08T22:55:17.507

线程 2 将等待`locker.EnterWriteLock();`线程 1 执行`locker.ExitWriteLock();`

`list`所以线程 2在线程 1 调用之前无法访问`locker.ExitWriteLock();`

如果您担心参数`item`，请确保它通过堆栈传递，并且每个线程都有自己的，所以`item`真的不能被另一个线程“替换”......

所以答案是：如果线程 1`locker.EnterWriteLock();`在线程 2 之前调用，`A`将在`B`.

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-01-08T22:56:11.753

的值`item`将是`A`参数的值。

只有在该行`locker.ExitWriteLock`执行后，该块才可用于线程一。

# sql - PostgreSQL - 插入包含数组的复合类型数组

> ID：14225397
> 
> 赞同：5
> 
> 时间：2013-01-08T22:48:35.893
> 
> 标签：sql, perl, postgresql, postgresql-9.1, dbi

我有一个包含 TEXT 数组的复合类型等。我在主表中使用它来创建一个复合类型数组。
如何生成 INSERT 命令（不使用复合类型的默认字段名称）？我可以使用复合数组创建一个 TEMPORARY TABLE，然后将其插入到主表中吗？

例如：

```
DROP TABLE collection;
DROP TABLE book_set;
DROP TYPE book;

CREATE TYPE book AS ( title TEXT, authors TEXT[], extra_spare TEXT );
CREATE TEMPORARY TABLE book_set ( books book[] );
CREATE TABLE shelf_collection ( shelf INT, position INT, books book[] );

-- Prefer to specify the fields I want, and NOT extra_spare as shown here!
-- AND it doesn't yet work... needs more casting?
INSERT INTO book_set( books ) VALUES (
      ( 'book1', array[ ( 'author1', 'author2' ) ], '' ),
      ( 'book2', array[ ( 'author3' )            ], '' ) ); 

-- And this obviously does not work yet!
INSERT INTO shelf_collection( shelf, position, books ) VALUES ( 1, 2, book_set ); 
```

第一个 INSERT 失败并显示以下消息：

> 错误：INSERT 的表达式多于目标列。

有或没有 array[] 构造都失败。

我的实际使用要复杂得多，复合材料包含其他复合材料和许多领域。

出于性能原因（不需要连接来检索），我在这里没有使用多个表，并且内部组合和数组从不独立引用。

我正在使用`perl(5.14.2)`和。`DBI(1.616)``psql(9.1.7)`

* * *

**更多信息：**

以下工作，但我如何更改它，以便我不需要指定书籍的所有字段：

```
DROP TABLE shelf_collection;
DROP TYPE book;

CREATE TYPE  book AS          ( title TEXT, authors TEXT[], extra_spare TEXT );
CREATE TABLE shelf_collection ( shelf INT, position INT, books book[] );

INSERT INTO shelf_collection VALUES ( 12, 23, array[ROW( 'book title 1', array[ 'author1', 'author2' ], '' )::book] );

SELECT * FROM shelf_collection; 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-09T06:39:20.547

PostgreSQL 数组是有用的抽象（非标准，我应该补充），它很容易被滥用——我认为这正是你想要做的。

您试图使用数组作为不规范化数据库模式的借口和捷径。它可能适用于一些kludges，但从长远来看这是不值得的。

如果您继续使用数组，您将无法利用许多真正使 SQL 有用的构造。例如，您无法有效地在`book_set`表中搜索任何给定的作者。

正确的设计是规范化 -`book_set`不应包含作者数组。相反，创建单独的表`authors`和单独的链接表`book_author`。

当然，使用规范化方法插入数据更尴尬，查询数据也更尴尬 - 您将需要执行连接。

但是，它可以创建几乎任何可以想象的查询。此外，通过适当的索引，即使您的数据集非常大，它也可以非常快速地工作。

# macos - 在 Mac OSX 上使用 NASM 和 ld

> ID：14225398
> 
> 赞同：2
> 
> 时间：2013-01-08T22:48:36.830
> 
> 标签：macos, assembly, x86, nasm, ld

我是汇编的初学者（事实上这是我第一次尝试），我想知道如何使用 NASM 和 ld 链接器让这个 x86 汇编代码在我的 Mac 上运行。

```
SECTION .data           ; Section containing initialised data

    EatMsg: db "Eat at Joe's!",10
    EatLen: equ $-EatMsg    

SECTION .bss            ; Section containing uninitialized data 

SECTION .text           ; Section containing code

global  _start          ; Linker needs this to find the entry point!

_start:
    nop         ; This no-op keeps gdb happy...
    mov eax,4       ; Specify sys_write call
    mov ebx,1       ; Specify File Descriptor 1: Standard Output
    mov ecx,EatMsg      ; Pass offset of the message
    mov edx,EatLen      ; Pass the length of the message
    int 80H         ; Make kernel call

    MOV eax,1       ; Code for Exit Syscall
    mov ebx,0       ; Return a code of zero 
    int 80H         ; Make kernel call 
```

这个汇编代码来自一本为 linux 编写的书，但是由于 linux 和 mac 都是基于 unix 的操作系统，我认为汇编代码通常是相同的。我现在意识到我可能无法通过 nasm 和 ld 将它转换为 mac 可执行文件，但如果可以，我该怎么做？如果没有，我将如何更改此汇编代码以使其正常工作，但通常做同样的事情？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-08T22:58:46.817

以下示例代码在使用 nasm 组装并使用 gcc 链接时应该可以工作（需要与标准 c 库链接！）

```
SECTION .data           ; Section containing initialised data

    EatMsg: db "Eat at Joe's!",10
    EatLen: equ $-EatMsg

SECTION .bss            ; Section containing uninitialized data

SECTION .text           ; Section containing code

global main
extern write

main:
    sub esp, 12                 ; allocate space for locals/arguments
    mov dword [esp], 1          ; stdout
    mov dword [esp+4], EatMsg   ; Pass offset of the message
    mov dword [esp+8], EatLen   ; Pass the length of the message
    call write                  ; Make library call

    mov eax,0                   ; Return a code of zero
    add esp, 12                 ; restore stack
    ret 
```

请注意，“Hello world”是一个特别糟糕的第一个 asm 程序，通常不建议从 asm 进行 I/O 和其他高级操作。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-08T22:53:54.423

`int 80H`在 OS X 上已弃用，无论如何它使用与 Linux 不同的选择器。您可能应该改用`syscall`或调用标准 C 库。

~~请参阅：[thexploit.com/secdev/mac-os-x-64-bit-assembly-system-calls](http://thexploit.com/secdev/mac-os-x-64-bit-assembly-system-calls)以获取在 Mac OS X 上使用 nasm 的有用“Hello World”教程。~~

另请参阅：[daveeveritt.tumblr.com/post/67819832/webstraction-2-from-unix-history-and-assembly-language](http://daveeveritt.tumblr.com/post/67819832/webstraction-2-from-unix-history-and-assembly-language)，了解有关使用 nasm 构建 OS X 可执行文件的更多信息。

# php - 从控制器传递数据以查看 Codeigniter

> ID：14225399
> 
> 赞同：0
> 
> 时间：2013-01-08T22:48:44.283
> 
> 标签：php, codeigniter, templates, variable-assignment

我正在尝试将数据传递给查看，但它给了我错误：未定义的变量：数据

控制器：

```
public function article($page=1)
{           
    $info = array(
        "module_name" => $this->module_name,
        "view_name" => "cms/cms_view", // your view path
        "error_msg" => "",  
        "error_type" => "", 
        "data" => array(
        'content'=>$this->cms_model->get_cms($page),
        'test'=>'Hello world'

        ), //data which will be sent to view
    );
    $this->loadview->view($info);
} 
```

模型：

```
 public function get_cms($page)
    {
        $query = $this->db->get_where('article', array('art_id' => $page),1);
        return $query->row();
    } 
```

看法：

```
<?php
        echo $data->content;
        ?> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-08T22:51:44.040

注意最后一行。

控制器：

```
public function article($page=1) {

    $info = array(
        "module_name" => $this->module_name,
        "view_name" => "cms/cms_view", // your view path
        "error_msg" => "",  
        "error_type" => "", 
        "data" => array(
            'content'=>$this->cms_model->get_cms($page),
            'test'=>'Hello world'

        ), //data which will be sent to view
    );
    $this->load->view('view_name', $info);
} 
```

有关如何在[此处](http://ellislab.com/codeigniter/user-guide/general/views.html)加载视图的更多信息。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-08T23:24:34.800

我认为问题可能出在您的视野中。$data 变量在控制器中设置为数组，但您将其视为对象。尝试使用

```
<?php
     echo $data["content"];
?> 
```

而是在视图中，看看是否可以解决您的问题。

# html - htaccess 中的 301 未重定向

> ID：14225404
> 
> 赞同：0
> 
> 时间：2013-01-08T22:49:16.930
> 
> 标签：html, apache, .htaccess

我在 WordPress 网站 (http://www.raynauds.org) 的根目录中有 htacess 文件。我需要将所有呼叫重定向到：

[http://www.raynauds.org/?p=2366](http://www.raynauds.org/?p=2366)

至：

[http://www.raynauds.org/2012/08/11/dr-maureen-mayes-joins-raynauds-association-medical-advisory-board/](http://www.raynauds.org/2012/08/11/dr-maureen-mayes-joins-raynauds-association-medical-advisory-board/)

我在 Linxus 服务器上运行 Apache。下面的代码似乎没有做任何重定向请求。我究竟做错了什么？

```
# BEGIN WordPress
RewriteEngine On
RewriteBase /
RewriteRule ^index\.php$ - [L]
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule . /index.php [L]
# END WordPress
Redirect 301 /?p=2366 http://www.raynauds.org/2012/08/11/dr-maureen-mayes-joins-raynauds-association-medical-advisory-board/ 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-08T22:56:54.023

在查找要执行的文件之前，重写和重定向都应用于 URL。

您的 RewriteRules 都具有 [L] 标志，表明这将是修改 URL 的最后一个规则，因此重定向不会用于匹配 RewriteRules 之一的 URL。

由于第二个 RewriteRule 将捕获所有请求，因此您的重定向将不起作用。您还可以使用 RewriteRule 重定向

```
RewriteCond %{QUERY_STRING}  p=2366
RewriteRule . http://www.example.com [R=301,L] 
```

另请查看[手册中的可用标志](http://httpd.apache.org/docs/current/mod/mod_rewrite.html#rewriterule)

当然，这条规则应该在 Wordpress 本身的 RewriteCond/RewriteRule 行之前生效。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-08T22:58:07.987

将您的规则移至语句`Redirect 301`下方的行。`RewriteBase`

# sql - 如何处理 SQL 合并复制冲突

> ID：14225406
> 
> 赞同：2
> 
> 时间：2013-01-08T22:49:25.593
> 
> 标签：sql, replication, conflict, merge-replication

我有一种情况，我正在寻找一些指导。

我有 4 个 SQL 2008 数据库，它们使用合并复制在 Internet 上同步。1 个发布者和 3 个订阅者。

通常，在数据库中输入的记录也只能从同一个数据库中更新，并且一切正常。但是，有时在发布者处对在订阅者处创建的记录进行更新，如果自上次同步（通常为 60 秒）在订阅者上更新同一记录，则可能会导致冲突。

我使用了 SSMS 中内置的冲突解决程序，这对我来说很好（我了解架构和基础数据）。但是，我正在寻找一种解决方案，在这种解决方案中，最终用户（管理人员）可以在冲突发生时收到警报，并在没有我任何干预的情况下以他们可以理解的方式解决冲突？

当不得不处理复制冲突时，其他人做了什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-08T23:35:24.097

从[高级合并复制冲突检测和解决](http://technet.microsoft.com/en-us/library/ms151257.aspx)

使用默认冲突解决程序和*客户端类型*订阅时，写入发布服务器的第一个更改将赢得冲突。当使用默认的冲突解决程序和*服务器类型*订阅时，优先级值被分配给各个订阅者，并且在具有最高优先级的节点上所做的更改将赢得冲突。

默认情况下会发生此行为，即使发生冲突并出现在冲突查看器中，也不需要手动干预。冲突查看器仅提供一种查看保留期内发生的冲突并手动更改结果的方法。

如果您需要默认解决机制未提供的冲突解决行为，您可以选择：

*   [Microsoft 提供了基于 COM 的解析器](http://technet.microsoft.com/en-us/library/ms152573.aspx)
*   [业务逻辑处理程序](http://technet.microsoft.com/en-us/library/ms152495.aspx)
*   [基于 COM 的自定义解析器](http://technet.microsoft.com/en-us/library/ms151764.aspx)
*   [自定义存储过程冲突解决程序](http://msdn.microsoft.com/en-us/library/aa256306%28v=sql.80%29.aspx)（对 Web Sync 订阅者不是很有用）

业务逻辑处理程序或自定义冲突解决程序将提供一种在发生冲突时发出警报并根据业务需求自动解决冲突的方法。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-06-06T06:24:10.503

我们首先像您一样实现了内置的冲突解决程序，但我们经常需要手动解决多个复制冲突。然后，我们决定通过以下方式改进我们的系统：

*   在每个表中添加“最后更新日期”字段
*   将“Microsoft SQL Server DATETIME (Later Wins) Conflict Resolver”设置为我们复制模式中的默认冲突解决程序

冲突随后下降到每月只有几个，并且可以通过冲突查看器界面训练用户处理它们，具有三个基本规则：

*   如果有两条记录被修改，选择较新的（我仍然不知道为什么这些没有被自动处理，但是有一些）。
*   如果没有较旧的（同时修改），则选择任何（很常见的“假”冲突情况）
*   如果一条记录被删除而另一条记录被修改，则选择删除

就是这样。

# c++ - 在 Linux 上通过 TCP 发送/接收数据

> ID：14225409
> 
> 赞同：1
> 
> 时间：2013-01-08T22:49:40.937
> 
> 标签：c++, linux, linux-device-driver

我是 Linux 新手，正在努力学习，所以我的问题很笼统。我正在尝试有一个在 Linux 上运行的应用程序，从输入（可能是 USB 端口）接收数据，然后创建一个字符串并将其发送到网络服务器，网络服务器将处理该字符串（我可以网络服务器部分）。关键是它必须连续完成，没有用户交互。

我从哪里开始？我应该使用 C++ 吗？而且我对PHP真的很满意，可以通过它来完成吗？我想花时间开发一些非常可靠的东西。

最后，您能否就从哪里开始精通 Linux 提出一些建议，我在 Windows 中开发过，但我想转向 Linux 并掌握它。

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-08T22:54:11.240

如果您正在寻找使用套接字进行网络编程的入门书，这里有经典的 Beej 指南 - [http://beej.us/guide/bgnet/](http://beej.us/guide/bgnet/)

非常适合初学者和恕我直言，这是关于套接字编程的最佳书面入门/教程之一。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-08T22:54:16.717

如果您习惯使用 Windows 和 .NET，您可以在 Linux 上编译和运行您的程序，感谢 Mono [http://www.mono-project.com/](http://www.mono-project.com/)。如果您对通过 HTTP 发送和接收内容感兴趣，可以查看[http://webserver.codeplex.com/](http://webserver.codeplex.com/)。我两个都用。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-08T22:54:35.757

我将从 PHP 或 Java 中的套接字开始。当一切都变得有意义时，然后从那里继续前进。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-01-08T23:05:40.383

如果你真的想学习 *nix 系统，并且想解决这个问题，你应该学习从命令行使用[管道。](http://www.linfo.org/pipes.html)

对于您的 USB 到 Web 示例，我将编写两个程序：

*   一种从 USB 设备读取数据并将其打印到标准输出（控制台）的设备
*   从标准输入读取数据并将其发布到网络的一种（您可以将这一秒写为使用“curl”实用程序的 bash 脚本）

从那里您只需将一个应用程序的输出通过管道传输到另一个应用程序的输入：

```
$ usb_program | web_program 
```

这就是最初设计 Unix/Linux 系统的用途，而您的问题是管道应该解决的问题的完美示例。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-03-19T19:00:19.060

你的问题有点含糊。

*   哪个设备正在创建数据？
*   数据生成设备有哪些接口能力（串口、USB、以太网、Wifi）？

Linux 机器上最简单的解决方案可能是一个 shell 脚本轮询串行端口（甚至可以是用作串行端口的 USB 端口）并将文本逐行写入纯文本文件，PHP 可以从该文件中读取它。

例子：`cat < /dev/ttyS0 >> ./input.txt`

（顺便说一句，这个命令行甚至可以从 PHP 程序内部启动）

根据您的 Linux 机器和数据生成设备中可用的通信协议，解决方案架构可能变得更加复杂和强大。

许多事情可以从 Unix 的 shell（= 命令提示符）中完成，并且不一定需要开发 C 程序。

# c# - 在不同时区使用应用程序时存储和比较从 SQL Server 到 .NET 的日期和时间

> ID：14225410
> 
> 赞同：1
> 
> 时间：2013-01-08T22:49:45.967
> 
> 标签：c#, .net, sql, sql-server, datetime

毫无疑问，这个问题已经被涵盖了，但我不知道要搜索什么才能找到答案。

我有一个在不同国家和时区使用的 .NET MVC 网站，目前我将 .NET`DateTime.UtcNow`作为表单的最后修改日期，并在`[datetime]`插入/更新记录时将其存储在 SQL Server 2008 数据库的字段中.

我希望能够记录用户最初打开“编辑”表单的时间，然后将其与数据库中的最后修改日期进行比较，以便用户可以了解在更改时发生的任何进一步更改表格。

我不知道这些是否是要使用的相关类型。

处理上述行为的推荐方法是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-08T22:52:49.037

听起来您正在寻找主动[乐观并发](http://en.wikipedia.org/wiki/Optimistic_concurrency_control)检查。假设粒度级别“足够好”，您当然可以为此使用日期时间字段。如果您不确定，我建议您使用整数而不是随着每次更新而递增 - 那里没有粒度问题。

# spring-mvc - Spring Portlet MVC中@RequestMapping("VIEW")注解有什么用

> ID：14225414
> 
> 赞同：4
> 
> 时间：2013-01-08T22:50:04.720
> 
> 标签：spring-mvc, portlet

在我的 Spring portlet 控制器类中，我在类级别有这个：

```
@Controller
@RequestMapping("VIEW")
public class myContoller extends AbstractController 
```

现在`@RequestMapping`应该将请求 url 映射到动作处理程序（控制器）。但是说什么有什么用`@RequestMapping("VIEW").`

在 中`portlet.xml`，我已经`<portlet-mode>VIEW</portlet-mode>`为这个特定的 portlet 控制器定义了。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-08T22:59:27.517

Portlet 可以支持不同的模式（默认是`VIEW`，如果我没记错的话）`EDIT`。`HELP`

`<portlet-mode>VIEW</portlet-mode>`in`portlet.xml`表示portlet 支持`VIEW`模式。

```
@Controller
@RequestMapping("VIEW") 
public class myContoller extends AbstractController 
```

简单地将由`@RequestMapping`该控制器的注释方法处理的请求限制为以`VIEW`模式发送的请求。

# android - 如何缩放 Android MonkeyRunner 的触摸事件坐标以支持具有相同脚本的多个设备？

> ID：14225417
> 
> 赞同：0
> 
> 时间：2013-01-08T22:50:15.133
> 
> 标签：android, touch, automated-tests, monkeyrunner, androidviewclient

我正在尝试编写一个monkeyrunner 脚本，它将为企业用户自动安装mdm 软件。该脚本将使用多个设备执行，因此具有多种屏幕尺寸和密度。

有没有办法从设备 A 获取参考坐标并对其进行缩放，以便将其应用于其他设备？我开始从参考设备获取初始触摸坐标，在本例中是三星 Galaxy S2，显示屏为 480 x 800，屏幕密度为 1.5，并在运行时根据设备计算缩放坐标。但是，屏幕显示为 720 x 1184（为软键移除了一些高度）和屏幕密度为 2 的 RAZR Maxx HD 不适用于此方法。

有没有人对打包算法有更深入的了解，以便一个设备的坐标可以用于任何设备？

我确实考虑过使用 AndroidViewClient 直接访问视图的按钮，但由于该脚本是为企业最终用户设计的，因此由于设备安全而无法使用。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-16T06:44:32.263

不幸的 Windows 行为。您可以在（在第 952 行附近）修改这些行来*短路测试：*`viewclient.py`

```
@staticmethod
def __obtainAdbPath():
    '''
    Obtains the ADB path attempting know locations for different OSs
    '''

    osName = java.lang.System.getProperty('os.name')
    ... 
```

经过

```
@staticmethod
def __obtainAdbPath():
    '''
    Obtains the ADB path attempting know locations for different OSs
    '''

    return """C:\Android\android-sdk\platform-tools\adb.exe"""
    osName = java.lang.System.getProperty('os.name')
    ... 
```

虽然临时解决方法可以解决您的问题（直到修复 Windows :-)。

# jquery - jQuery 选择器（全选而不是 .parents）

> ID：14225425
> 
> 赞同：-2
> 
> 时间：2013-01-08T22:51:26.897
> 
> 标签：jquery, selector

我在使用 jQuery 选择器时遇到了一个小问题，在尝试了一段时间后，我决定需要一些帮助。

```
$('.submenu').on('click','.groen',function() {
    $(this).parents('#content_vragen').find('.container_vragen').fadeOut(400, function() {
        $(this).parents('#content_vragen').find('.container_vragen').css('overflow', 'hidden');
        $(this).parents('#content_vragen').find('.container_vragen').appendTo("#geregeld");
        $(this).parents('#geregeld').find('.container_vragen').css('color', 'green');
        $(this).parents('#geregeld').find('.container_vragen').fadeIn(400);
    });
}); 
```

我有一个名为 .submenu 的类，其中 .submenu 是一个带有“groen”类的 <p> 元素。.submenu 元素位于类“container_vragen”的 div 中。这是一个名为“#content_vragen”的容器 id。

```
<div id="content_vragen">

    <div class="container_vragen">
        <div class="submenu">
            <p class="groen">groen</p> 
        </div>
    </div>

    <div class="container_vragen">
        <div class="submenu">
            <p class="groen">groen</p> 
        </div>
    </div>

    <div class="container_vragen">
        <div class="submenu">
            <p class="groen">groen</p> 
        </div>
    </div>

</div> 
```

所以我相当简单的问题是：我怎样才能只对单击 .groen 类的 .container_vragen 类执行操作。我以为我必须选择它的父级（.groen 按钮）并将其返回到 .container_vragen，但这样它会选择所有 .container_vragen 元素。只是为了让事情更容易这里是整个项目的 jsFiddle：http: [//jsfiddle.net/86Hcc/](http://jsfiddle.net/86Hcc/)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-08T22:54:03.103

只需使用`.closest`-- 这将使用给定的选择器获得最近的父级：

```
$(this).closest('.container_vragen'); 
```

# ios - UICollectionView 的每个部分的独立滚动？

> ID：14225429
> 
> 赞同：28
> 
> 时间：2013-01-08T22:51:37.010
> 
> 标签：ios, ios6, uicollectionview, uicollectionviewlayout

是否可以`UICollectionView`用来构建每个**部分**都可以独立滚动的布局？例如，假设有 20 行图像，其中每一行可以独立水平滚动以在屏幕外显示更多图像（在此过程中无需滚动其他行）；并且整个视图可以垂直滚动以显示更多行。

我相信这样的事情可以通过 UIScrollView 中的几个 UICollectionView 实例来实现；但是，利用 UICollectionView 插入/移动部分会很棒。

我怀疑这不切实际，因为 UICollectionView 是 UIScrollView 的子类；但也许这可以通过自定义 UICollectionViewLayout 来完成？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-01-11T18:05:31.577

您可以在表格单元格中放置多个 UICollectionView。表格垂直滚动。集合视图可以配置为水平滚动。我在一个复杂的布局上做这个并且效果很好。要考虑的一个约束是，制作需要从一个表格单元格移动到另一个表格单元格的动画要困难得多，而且您不能使用集合视图布局的单一更改来为表格视图中的所有项目设置动画。但如果这些限制不是问题，那么这是一个相对简单的解决方案。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2018-07-24T09:17:01.623

这是一个非常常见的问题，我需要多次解决，我创建了一个`UICollectionViewLayout`以干净的方式解决这个问题而无需创建多个集合视图，这意味着它支持在部分之间移动项目等。

[https://github.com/joelekstrom/JEKScrollableSectionCollectionViewLayout](https://github.com/joelekstrom/JEKScrollableSectionCollectionViewLayout)

# ios - 如何让 iOS 网络应用从中断的地方开始

> ID：14225430
> 
> 赞同：1
> 
> 时间：2013-01-08T22:51:36.507
> 
> 标签：ios, safari, web-clips

我正在编写一个 Web 剪辑应用程序，您可以通过 Safari 将其添加到主屏幕，每次打开它时，它都会重新加载到保存 Web 剪辑的页面。如何使 Web 应用程序在上次打开的位置打开离开了？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-10T23:06:21.767

它必须重新加载页面，除非浏览器或应用程序任务没有被杀死。为了使应用程序从上次停止的地方重新启动，您需要保持页面状态并使用 javascript 和 html5 加载它。这是一个示例，您单击页面的选项卡/菜单，它将重新打开[http://dotaprj.me/](http://dotaprj.me/)重新启动（关闭页面然后重新打开它）

此外，通过网络剪辑，如果您指的是 HTML5 视频，那么您可以保存用户在时间范围内的位置并使用 javascript 将其加载回来。

# ios - Apple Mach-O 链接器错误*对我来说很乱*

> ID：14225433
> 
> 赞同：1
> 
> 时间：2013-01-08T22:51:44.780
> 
> 标签：ios, xcode, linker-errors

所以我只是在查看一些选项，然后按下了一些“产品”选项。我不确定是哪一个让我得到了这个，但我认为是“分析”。

无论如何，错误是 ![在此处输入图像描述](../Images/e43596287b494939d5f1e58bd8bf5be4.png)

正如您在底部看到的那样，它说缺少一些文件。我去了那个目录，![在此处输入图像描述](../Images/5f8ed72231c4d1d43c7e894d833ac962.png) 它就在这里。除了我无法访问它。我尝试将项目发送给朋友，他编译并运行了项目而没有收到错误。我对此几乎一无所知，有人可以告诉我出了什么问题以及如何解决吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-08T22:58:34.017

你说它在那里，但你的屏幕截图显示它不在那里。它正在寻找在该文件夹中命名`LNG Converter.app`的`Debug-iphonesimulator`文件夹，但您的屏幕截图显示没有在该文件夹中命名的文件夹`LNG Converter.app`。

尝试清理构建文件夹。按住 option 键，然后选择 Product > Clean Build Folder。

# iis - 使用 CF/AJP 1.3/IIS 7.5 达到 4KB 限制的 Axis 2 SOAP 调用

> ID：14225434
> 
> 赞同：5
> 
> 时间：2013-01-08T22:52:13.743
> 
> 标签：iis, soap, coldfusion, axis2

我正在使用 Coldfusion 10 构建 SOAP Web 服务，我在 IIS 7.5 上运行，Coldfusion 通过 AJP 1.3 连接器连接到独立的 Java Tomcat 服务器。

我的服务器将接受的 SOAP 请求的大小似乎达到了 4-8KB 的限制，如果超过该限制，则连接被重置 - 没有显示错误。

但在我的 CF 日志中，我得到：

```
The fault returned when invoking the web service operation is:<br> <pre>org.apache.axis2.AxisFault: Connection reset    at org.apache.axis2.AxisFault.makeFault(AxisFault.java:430)     at org.apache.axis2.transport.http.HTTPSender.sendViaPost(HTTPSender.java:197)      at org.apache.axis2.transport.http.HTTPSender.send(HTTPSender.java:75)      at org.apache.axis2.transport.http.CommonsHTTPTransportSender.writeMessageWithCommons(CommonsHTTPTransportSender.java:402)      at org.apache.axis2.transport.http.CommonsHTTPTransportSender.invoke(CommonsHTTPTransportSender.java:231)   at org.apache.axis2.engine.AxisEngine.send(AxisEngine.java:443)     at org.apache.axis2.description.OutInAxisOperationClient.send(OutInAxisOperation.java:406)      at org.apache.axis2.description.OutInAxisOperationClient.executeImpl(OutInAxisOperation.java:229)   at org.apache.axis2.client.OperationClient.execute(OperationClient.java:165)    at reverserisk_ncm.Reverserisk_ncmStub.dumpHeader(Reverserisk_ncmStub... The specific sequence of files included or processed is: C:\rr1.5\Clarence\webservice\test_ncm.cfm, line: 36 
```

我已经尝试了一些东西，首先我确保它是一个大小限制，添加 30 秒的睡眠会产生相同的结果，所以我尝试了：

1.  Coldfusion Max POST size 数据集设置为高值
2.  IIS 服务器配置 - system.web/httpRuntime.maxRequestLength -> maxInt 和 security.requestFilter.maxAllowedContentLength
3.  Apache Tomcat：conf/server.xml - AJP 1.3 连接器 maxPostSize/maxSavePostSize 值 -> 2MB
4.  将 Axis2.xml 从 HTTP/1.1 更改为 HTTP/1.0 以强制禁用“分块”传输编码 - 我读到这可能是针对 DDOS 攻击的安全功能

如果有人遇到过类似的问题，那就太好了，我知道这也可能是一个 ServerFault 问题——但希望在 CF 上做 SOAP 的人也看到过类似的东西，谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-15T06:44:35.870

您可以尝试带附件的 SOAP (saaj) 吗？

如果您的 SOAP 信封可以将数据作为附件，您可以像这样拆分您的肥皂消息

1.元数据（在SOAP Envolope中）

2.数据（内容）作为SOAP附件

我不知道 CF 中的可能性，但是使用支持 SOAP 1.2 的工具应该可以做到这一点。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-14T18:46:19.167

只是想知道，你需要轴 2 吗？你能试试 Axis 1 看看会发生什么吗？CF 10 将允许您在管理界面中更改该设置。

我推荐的另一件事是跟踪 CF 的日志并观察在发生这种情况时是否有任何消息报告给控制台。

这里还有一些其他需要测试的东西：

1) 如果您不拥有要连接的 Web 服务，请尝试下载 WSDL 并将其与您自己的 CFC 相关联。CFC 不必有任何实现，我们只是想看看在不调用其他服务时是否会出现不同的错误。

2）你能缩小问题的大小吗？例如，如果您调整 WSDL 的大小以使其足够小以使其工作，然后慢慢调整它的大小越来越大，您能否找到总是导致问题的 WSDL 大小？

3) 您是否尝试过删除 CF 创建的 Web 服务代理？我想它们在 {coldfusion10}/cfusion/wwwroot/WEB-INF/cfclasses 下。

基本上，我认为您需要找到一种方法，将无声的失败转变为提供更多信息的方法。

# apache-pig - 如何从包中置换？

> ID：14225438
> 
> 赞同：0
> 
> 时间：2013-01-08T22:52:47.047
> 
> 标签：apache-pig

我有一个名为 stuff 的关系，其架构如下：

```
grunt> describe stuff;
stuff: {child_id: long,parent_id: long} 
```

我想通过 parent_id 对 child_ids 进行分组，然后生成一个输出作为不同 child_ids 之间的有序对列表。例如，如果 parent_id 为 100 下有 child_id 1,2,4 和 5，我想要的输出是这样的：

```
1,2
1,4
1,5
2,1
2,4
2,5
4,1
4,2
4,5
5,1
5,2
5,4 
```

我必须编写一个 eval 函数吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-09T10:14:15.337

您需要 CROSS 运算符。这是一个例子：

**输入**

```
1,2
1,1
1,3
1,4
2,5
2,3
2,6 
```

**代码**

```
inpt = load 'parent_child.csv' using PigStorage(',') as (parent_id: long, child_id: long);
tmp = foreach inpt generate parent_id, child_id as b1, child_id as b2; -- needed to use CROSS in the nested FOREACH
parentGroup = group tmp by parent_id;

perms = foreach parentGroup { 
    bro_1 = tmp.b1;
    bro_2 = tmp.b2;
    brothers = cross bro_1, bro_2;
    brothers = filter brothers by b1 != b2; -- remove relationship to itself
    generate group as parent_id, brothers;
} 
```

**输出**

架构-烫发：{parent_id：long，兄弟：{（bro_1 :: b2：long，bro_2 :: b2：long）}}

```
(1,{(1,2),(3,2),(4,2),(2,1),(3,1),(4,1),(2,3),(1,3),(4,3),(2,4),(1,4),(3,4)})
(2,{(3,5),(6,5),(5,3),(6,3),(5,6),(3,6)}) 
```

# php - 将数组从 html 发布到 php

> ID：14225447
> 
> 赞同：2
> 
> 时间：2013-01-08T22:53:19.260
> 
> 标签：php, html, arrays, post

我对 php 编程很陌生，但我试图将值从 multislect 对象 im html 传递给 PHP 中的一些代码，然后这些代码将通过电子邮件发送给列出的人

然而，通过帖子传递的变量似乎只是最后一个选择的项目

你如何将某些东西作为数组传递？

html代码：

```
<li id="li_6" >
            <label class="description" for="Names[]">Employees who should be added to this charge code: (Hold CTRL to Multi Select)</label>
            Malav, Nancy, Filiz, CJ are added by default and not on the list
            <div>
                <select name="Names" multiple>  
                    <option value="gbiy@afsafd.com">Bi,Gilbert</option>
                    <option value="jbster@asdfasds.com">Bor,Jeff</option>
                    <option value="ibett@adfasdfions.com">Bt,Ivan</option>
                    <option value="scelos@agasdgasdns.com">Caos,Sheryl</option>
                    <option value="rcarsfsfdgy@madfasdfs.com">Car,Raymond</option>
                    <option value="dcaraahers@asdfasdftions.com">Cs,Dale</option>
                    <option value="Cclesfdgsdents@mabukhyns.com">Cles,Cathy</option>
                    <option value="lcugh@madsfadsfasds.com">Cl,Lori</option>
                    <option value="rcolns@madsfasdfons.com">Cons,Renee</option>
                    <option value="ccrine@maasdfkoadsfasd.com">ine,Cassandra</option>
                    <option value="pcrett@maadsfasdfons.com">Ctt,Pamela</option>
</select>
            </div> 
        </li> 
```

php代码：

```
<?php
// Read POST request params into global vars
    $from = "BP@fgsdfgsons.com";
    $title = $_POST[Title] ;
    $mname = $_POST[ManagerName];
    $memail = $_POST[ManagerEmail];
    **$names= $_POST['Names']; <<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<**
    $other = $_POST[element_4];

    print $email;
    $to = "sfgsdfg@sdfgsdfgssbd.com" + $memail;
    $message ="Title: $title \r\nManager: $mname\r\nManager email: $memail\r\n" ;
    $headers = "From: $from";
    $today = date("m/d/Y");
    $ok = @mail($to, $subject, $message, $headers);

    echo "Your email has been sent! Please confirm with Malav if you do not receive a confrimation email in 2 hours";
?> 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-01-08T22:55:58.197

要将其作为值数组传递，请将方括号添加到 select 元素的 name 属性中。

```
<select name="names[]" multiple="multiple"> 
```

然后你可以遍历 php.ini 中的值。

```
foreach ( $_POST['names'] as $selectedOption ) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-08T22:57:44.573

```
foreach ($_POST['Names'] as $selectedOption)
    echo $selectedOption."\n"; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-03-26T13:48:35.490

当我使用这个时：

foreach ( $_POST['names'] as $selectedOption )

我在数据库中插入“$selectedOption”，出现在数据库中：

上

# ruby-on-rails - rails : rake db:create 没有创建新表

> ID：14225448
> 
> 赞同：2
> 
> 时间：2013-01-08T22:53:22.170
> 
> 标签：ruby-on-rails, ruby-on-rails-3.2, rails-migrations, dbmigrate

我正在处理一个现有的 rails 项目，我必须在其中添加一个新选项卡。好吧，我已经编写了所有相应的模型、视图和控制器，然后更改了 schema.rb 文件以创建新表。

```
 create_table "ryan_indices", :force => true do |t|
    t.string   "name"
  end

create_table "benchmark_indices", :force => true do |t|
        t.string   "name"
      end 
```

这是我的部分 schema.rb 文件。第一张桌子以前在那里。我只是想添加一个类似的新表，我为它创建了模型、视图和控制器，并且还在 schema.rb 文件中添加了这些 create_table 语句。但是，当我运行`rake db:migrate`它时，它不会创建新表。我的`schema.rb file goes back to previous state`意思是我的更改在我运行`rake db:migrate`命令后消失了，它在命令行屏幕上什么也没有显示。

我不知道我错过了什么。有人可以帮忙吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-08T22:58:30.440

编辑[schema.rb 被认为是不好的做法](http://guides.rubyonrails.org/migrations.html#schema-dumping-and-you)：

> ...不是为编辑而设计的，它们只是代表数据库的当前状态。

要创建一个新模型（因此是一个新的数据库表），请调用 rails 模型生成器

```
rails generate model Product name:string 
```

或者：对于现有模型的新字段，请[生成迁移](http://guides.rubyonrails.org/migrations.html#creating-a-migration)...

```
rails generate migration AddNameToProducts 
```

...编辑它，然后用“ `rake db:migrate`”运行它

[这些任务在官方RailsGuides > Migrations](http://guides.rubyonrails.org/)中有很好的描述

# c++ - 在 Python 中公开 C++ 全局变量

> ID：14225450
> 
> 赞同：1
> 
> 时间：2013-01-08T22:53:28.260
> 
> 标签：c++, python, arrays, python-3.x, cython

我正在尝试使用 Cython 在我的 Python 代码中访问 C++ 全局变量。

假设我的 C++ 代码中有以下数组：

```
// Project.cpp
int myArr[2] = { 0, 1 }; 
```

因此，在 Cython 中定义一个指向*myArr*的指针：

```
cdef extern int * myArr_ptr 
```

myArr_ptr真的**指向**C++ 数组吗？还是只是一个随机值？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-09T19:41:57.893

好的，问题是：

`Project.cpp`有一个全局`int *myArr;`的，它没有在 中列出`Project.h`，并且您想从 Cython 访问它而不导入`Project.cpp`.

在评论中，你说：

> 我无法包含 Project.cpp，因为该文件将尝试包含已包含的其他文件，并将尝试重新定义许多变量。

按照您描述的方式，这里可能存在一个基本错误。你可能知道这些基本的东西，所以请不要因为我提出它们而受到侮辱，但我只想彻底：

首先，如果你的头文件没有防止多重包含，修复它，然后你就不用担心“我不能包含`Project.cpp`，因为这个文件会尝试包含已经包含的其他文件，并且会尝试重新定义许多变量。” （如果您没有头文件，并且您只是在 .cpp 文件中使用显式`extern`语句执行所有操作，请不要这样做 - 在 C 和 C++ 中这是一个坏主意，在您开始之前Cythonizing。）

其次，如果您的模块旨在与作为其`Project.cpp`一部分的 .so/.dll/.dylib 接口，则您不应针对该库的源代码进行构建，而应针对已安装的接口进行构建。另一方面，如果您的模块打算直接包含 C++ 代码，那么您*必须*包含`Project.cpp`. 如果你使用`extern`声明来引用你不打算链接的东西，你只会得到一个链接器错误——或者，如果你不走运，一切都会构建，但在运行时会失败。

第三，如果它实际上不是全局的，则不能从外部访问`Project.cpp`——由于范围、生命周期或链接的原因，在单独的实现文件中没有其他类型的变量可用。

同样，我假设您知道所有这些基本知识，而我只是误读了您的评论。有*一个*真正的问题案例，您需要使用设计不佳的 API 来包装某些东西，这需要您进入内部，这有时会很棘手，您可能确实遇到过这样的事情，而我只是没有弄清楚到底是怎么回事。

有三个基本的解决方案。

首先，显然，如果您可以构建适当的原生 API，那么在 Cython 中包装该 API 是微不足道的。同时，由于其他原因，这很有用。有时，这会花费太多时间和精力——例如，如果本机库不是为外部驱动而设计的，并且需要 10 年的遗留维护，这是您必须打包的唯一原因它是当前的 Cython 项目，您可能不想清理它。或者，如果它是一个快速变化的库，您需要跟上它的更新并且没有源代码控制，那么分叉它并尝试保持同步可能是一场噩梦。等等。但是，如果您的情况没有这样的原因，那么这是正确的答案。如果可以`cdef extern from "project.h"`，一切都很容易。

您可以通过在本机级别创建“shim API”来实现更简单的版本，`.h`为您需要从内部使用的各种函数和类型创建具有适当的外部、函数和类型声明的单独文件。然后，您可以`cdef extern from "project_extras.h"`.

最后，您始终可以`cdef extern`为任何内容编写显式语句，而无需告诉 Cython 任何内容的来源。Cython 会在生成的代码中将其转换为适当的本机 extern，如果一切正确，它将起作用。这里有一些缺点-<a href="http://docs.cython.org/src/userguide/external_C_code.html#referencing-c-header-files" rel="nofollow">文档解释了所有优点`cdef extern from`你会放弃的。简短的版本是，您的 Cython 声明必须与本机声明完全匹配；否则，您不会在 Cython 阶段自动修复或引发一个不错的错误，而是会从 C 编译器收到一条难以理解的错误消息，指的是不可读的 Cython 生成的 C 代码，而不是您的实际代码——或者更糟糕的是，代码编译但做错了。

对于简单`int *`或`int []`值的情况，所有这些都无关紧要，因为不需要任何解释；一个平原`cdef extern`应该就好了。

# salesforce - 需要帮助将我的 Apex 代码覆盖率提高到 75%

> ID：14225452
> 
> 赞同：0
> 
> 时间：2013-01-08T22:53:27.977
> 
> 标签：salesforce

我目前获得了 58% 的代码覆盖率，我需要它达到 75% 才能部署到生产环境。

下面是我的 Apex 测试课程，最底部是我的 Apex 课程。

```
@isTest(SeeAllData=true)
public class VaultVFTEST {

/*This is a test class for the class VaultVF which is a Visusalforce controller for
the page vault */

static testMethod void VaultVFTEST() {

    //Create opp, hardcode the Deal_Registration_Id__c field with 'x111111111' and insert opp
    //Opportunity opp = new Opportunity(Name='test opp', StageName='stage', Probability = 95, CloseDate=system.today());
    //insert opp;

    //Create a vault record that will be submitted
    Vault__c vlt = new Vault__c(
        Scenario__c = 'BIG-IP front ending Firewalls',
        isValidDealReg__c = true,
        Status__c = 'Application Received',
        Load_Balancer_is_a_Firewall__c = 'Yes',
        Providing_DDos_Connection__c = 'Firewalls',
        Providing_DDos_protection_except_ASM__c = 'Yes',
        No_Traffic_Traverse__c = 'Yes',
        Firewall_Vendor_Name__c = 'Firewall Vendor Company',
        First_Name__c = 'Test First Name',
        Last_Name__c = 'Test Last Name',
        Company_Name__c = 'Test Company Name',
        Phone__c = '(206) 946-3126',
        //Email__c = 'test@email.com',
        Country__c = 'United States',
        Additional_Info__c = 'Test Additional Info'
        //Related_Opp__c = opp.Id        
    );

    //Setup page for standard controller
    ApexPages.StandardController sc = new ApexPages.StandardController(vlt);

    Test.startTest();  
    VaultVF controller = new VaultVF(sc);
    Test.stopTest();

    //Assert has errors method returns true
    system.assert(controller.getHasErrors() == false);

    //Build the captcha value
    controller.getChar1();
    controller.getChar2();
    controller.getChar3();
    controller.getChar4();
    controller.getChar5();
    controller.getChar6();

    //Set captcha input value
    controller.captchaInput = '';

    //Attempted to submit form
    controller.save();

    //Assert terms checkbox was not selected
    system.assert(controller.errorMsgs[0].startsWith('You must'));

    //Assert verification code was incorrect
    system.assert(controller.errorMsgs[1].startsWith('Verification code'));

    //'Check' the box, set captcha value and then save
    controller.scenario1 = true;
    controller.captchaInput = controller.correctAnswer();
    controller.save();

}
} 
```

下面是我的 Apex 课程

```
public with sharing class VaultVF {

public Vault__c vault {get; set;}
public List<String> errorMsgs {get; set;}
public String saveResult {get; set;}
public String dealReg {get; set;}
public String oppId {get; set;}
public String email {get; set;}
public Boolean scenario1{get; set;}
public Boolean scenario2{get; set;}
public Boolean scenario3{get; set;}

// Generates country dropdown from country settings 

public List<SelectOption> getCountriesSelectList() {
    List<SelectOption> options = new List<SelectOption>();
    options.add(new SelectOption('', '-- Select One --'));        

    // Find all the countries in the custom setting 

    Map<String, Country__c> countries = Country__c.getAll();

    // Sort them by name 

    List<String> countryNames = new List<String>();
    countryNames.addAll(countries.keySet());
    countryNames.sort();

    // Create the Select Options. 

    for (String countryName : countryNames) {
        Country__c country = countries.get(countryName);
        options.add(new SelectOption(country.Two_Letter_Code__c, country.Name));
    }
    return options;
}

//Constructor, set defaults
public VaultVF(ApexPages.StandardController controller) {

    vault = (vault__c)controller.getRecord();

    //Populate list of random characters for CAPTCHA verification
    characters = new List<String>{'a','b','c','d','e','f','g','h',
        'i','j','k','m','n','p','q','r','s','t','u','v','w',
        'x','y','z','1','2','3','4','5','6','7','8','9'
    };

    errorMsgs = new List<String>();

}

//Determine if page has error so errors message can be displayed
public boolean getHasErrors(){
    if(ApexPages.hasMessages() == true){
        if(errorMsgs == null){
            errorMsgs = new List<String>();             
        }

        //Loop through errors and add to a list
        for(ApexPages.Message m : ApexPages.getMessages()){
            if(m.getSummary().startsWith('Uh oh.')){
                errorMsgs.add(String.valueOf(m.getSummary()));
            }
        }
    }
    return ApexPages.hasMessages();     
}

public void save(){
    errorMsgs = new List<String>();

    //Make sure captcha was correct
    if(validateCAPTCHA() == false){
        errorMsgs.add('Verification code was incorrect.');
        captchaInput = '';
    }

    //Make sure the Scenario is selected        
    if(scenario1 == true){
        vault.Scenario__c = 'BIG-IP as a Firewall';
    }else if(scenario2 == true){
        vault.Scenario__c = 'BIG-IP providing firewall service in conjunction with other vendors';
    }else if(scenario3 == true){
        vault.Scenario__c = 'BIG-IP front ending Firewalls';
        if(vault.Load_Balancer_is_a_Firewall__c == null){
           errorMsgs.add('Please specify if the load balancer is a firewall.');
        }
        if(vault.Providing_DDos_Connection__c == null){
           errorMsgs.add('Please specify if this is providing DDos connection level protection for firewalls or both.');
        }
        if(vault.Providing_DDos_protection_except_ASM__c == null){
           errorMsgs.add('Please specify if we are providing DDos protection (except ASM).');
        }
        if(vault.No_Traffic_Traverse__c == null){
           errorMsgs.add('Please specify if there is Traffic that does not traverse the Firewalls.');
        }
        if(vault.Firewall_Vendor_Name__c == null){
           errorMsgs.add('Please specify a Firewall Vendor.');
        }
    } else {
        errorMsgs.add('Please select one of three Scenarios that is similar to your setup');
    }     

    //-----Need to make sure deal registration number on opportuntiy is valid.-----

    //Set some sort of is valid deal reg flag to false. We will assume the deal reg Id entered is invalid until we determine it is valid
    vault.isValidDealReg__c = false;

    //Query Account Id, and Deal_Registration_Id__c from the opportunity object where the deal registration Id equals the value entered in the form
    List<Opportunity> opps = [select Id, Deal_Registration_ID__c from Opportunity where Deal_Registration_ID__c = :vault.Deal_Registration__c];

    //check to see if  registration id on the opp match the entered value    
    if(opps.size() > 0 && opps[0].Deal_Registration_ID__c == vault.Deal_Registration__c){

    //If they do match set the valid deal reg Id flat to true
        vault.isValidDealReg__c = true;
        vault.Related_Opp__c = opps[0].Id;

    //If they don't match then query all contacts on the account related to the opportunity
    }

    //If is valid deal reg flag is false add a message to the errorMSgs list indicated the entered
    //deal registration is not valid with details on who they should contact
    if(errorMsgs.size()>0){
        //stop here
    } else if(vault.isValidDealReg__c == false){
        errorMsgs.add('Deal Registration # was incorrect. Please contact your representative.');
    } else {
        try{
            vault.Status__c = 'Application Received';
            insert vault;
            saveResult = 'success';

        }catch(exception e){
            ApexPages.addMessage(new ApexPages.Message(ApexPages.Severity.FATAL, 'Uh oh. Something didn\'t work quite right. Please contact partners@f5.com for assistance. \n\n' + e.getMessage()));                
            saveResult = 'fail';
        }
    }

}

//------------------------Code for CAPTCHA verification----------------------------
public String captchaInput {get; set;}
List<String> characters;
String char1; 
String char3; 
String char5;

//This methods simply returns a random number between 0 and the size of the character list
public Integer randomNumber(){
    Integer random = Math.Round(Math.Random() * characters.Size());
    if(random == characters.size()){
        random--;
    }
    return random;
}

/*Here we have 6 get methods that return 6 random characters to the page.
For chars 1,3, and 5 (the black characters) we are saving the the values so 
that we can compare them with the user's input */
public String getChar1(){
    char1 = characters[randomNumber()];
    return char1;
}
public String getChar2(){
    return characters[randomNumber()];
}
public String getChar3(){
    char3 = characters[randomNumber()];
    return char3;
}
public String getChar4(){
    return characters[randomNumber()];
}
public String getChar5(){
    char5 = characters[randomNumber()];
    return char5;
}
public String getChar6(){
    return characters[randomNumber()];
}

public String correctAnswer(){
    return char1 + char3 + char5;   
}

public Boolean validateCAPTCHA(){
    if(captchaInput.length() == 3 && captchaInput.subString(0,1) == char1 && captchaInput.subString(1,2) == char3 && captchaInput.subString(2,3) == char5){
        return true;
    }else{
        return false;
    }
}
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-09T00:00:12.763

运行您的 apex 测试类后，请查看代码覆盖率结果。这将显示哪些行没有被执行。

一种方法是：

*你的名字*> 设置 > 应用程序设置 > 开发 > Apex 类 > 找到你的类，然后单击代码覆盖率列中的链接。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-09T19:32:03.767

我达到了 70% :)

以下是我更新的 Apex 测试课程

```
@isTest
private class VaultVFTEST {

/*This is a test class for the class VaultVF which is a Visusalforce controller for
the page vault */

static testMethod void VaultVFTEST() {

    //Create a vault record that will be submitted
    Vault__c vlt = new Vault__c(
        Scenario__c = 'BIG-IP front ending Firewalls',
        isValidDealReg__c = false,
        Status__c = 'Application Received',
        First_Name__c = 'Test First Name',
        Last_Name__c = 'Test Last Name',
        Company_Name__c = 'Test Company Name',
        Phone__c = '(206) 946-3126',
        Email__c = 'test@email.com',
        Country__c = 'United States',
        Additional_Info__c = 'Test Additional Info'       
    );

    //Setup page for standard controller
    ApexPages.StandardController sc = new ApexPages.StandardController(vlt);

    Test.startTest();  
    VaultVF controller = new VaultVF(sc);
    Test.stopTest();

    //Assert has errors method returns true
    system.assert(controller.getHasErrors() == false);

    //Build the captcha value
    controller.getChar1();
    controller.getChar2();
    controller.getChar3();
    controller.getChar4();
    controller.getChar5();
    controller.getChar6();

    //Set captcha input value
    controller.captchaInput = '';

    //Attempted to submit form
    controller.save();

    //Assert verification code was incorrect
    system.assert(controller.errorMsgs[0].startsWith('Verification code'));

    //'Check' the box, set captcha value and then save
    controller.scenario3 = true;
    controller.captchaInput = controller.correctAnswer();
    controller.save();

    Test.startTest();  
    insert vlt;
    Test.stopTest();

}
} 
```

# javascript - 单击时使用 InAppBrowser？

> ID：14225455
> 
> 赞同：0
> 
> 时间：2013-01-08T22:53:37.963
> 
> 标签：javascript, ios, cordova

我一直在尝试为此寻找教程，但我似乎遇到的所有教程都是用于在加载时加载网页。我想在 Cordova 的 InAppBrowser 中激活时加载一个 url。如果你们能指出我正确的方向来实现这一点，我将不胜感激！这是加载代码。

```
<script type="text/javascript" charset="utf-8">

        document.addEventListener("deviceready", onDeviceReady, false);

        function onDeviceReady() {
            var ref = window.open('http://AcademyMusicGroup.com', '_blank', 'location=yes');
            ref.addEventListener('loadstart', function() { alert('start: ' + event.url); });
            ref.addEventListener('loadstop', function() { alert('stop: ' + event.url); });
            ref.addEventListener('exit', function() { alert(event.type); });
        }

        </script> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-13T16:05:13.303

将 window.open 放在 onDeviceReady() 函数之外

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-13T18:14:17.300

我不知道这是不是你想要的......

但是如果你想让浏览器在点击时弹出

html:

```
 <button onclick="PopUpBrowser();">PopUp</button> 
```

Javascript：

```
<script type="text/javascript" charset="utf-8">

        document.addEventListener("deviceready", onDeviceReady, false);

        function PopUpBrowser() {
            var ref = window.open('http://AcademyMusicGroup.com', '_blank', 'location=yes');
            /*ref.addEventListener('loadstart', function() { alert('start: ' + event.url); });
            ref.addEventListener('loadstop', function() { alert('stop: ' + event.url); });
            ref.addEventListener('exit', function() { alert(event.type); });*/ Depends on whether you need them or not ... 
        }

        </script> 
```

# html - 一个元素的多种颜色

> ID：14225456
> 
> 赞同：1
> 
> 时间：2013-01-08T22:53:39.573
> 
> 标签：html, css, colors, webfonts

我正在写一个网站，其中徽标将是一个单词，其中中间字符与外部字符颜色不同；例如

```
<style type="text/css" media="screen>
    .logoG { color:blue; }
    .logoGo { color:red; }
    .logoGoo { color:yellow; }
    .logoGoog { color:blue; }
    .logoGoogl { color:green; }
    .logoGoogle { color:red; }
</style>
<span class="logoG">G</span><span class="logoGo">o</span><span class="logoGoo">o</span><span class="logoGoog">g</span><span class="logoGoogl">l</span><span class="logoGoogle">e</span> 
```

我想将文本保留为文本；不要使用图像替换技巧来隐藏文本并将其替换为徽标背景图像。即我希望 HTML 看起来像这样：

```
<span class="logo">Google</span> 
```

...并让 CSS 通过以下方式来完成艰苦的工作：

```
logo {visibility: none;}
logo:after {visibility: visible; content: "G"; color:blue;}
logo:after:after {content: "o"; color:red;}
logo:after:after:after {content: "o"; color:yellow;}
logo:after:after:after:after {content: "g"; color:blue;}
logo:after:after:after:after:after {content: "l"; color:green;}
logo:after:after:after:after:after:after {content: "e"; color:red;} 
```

...或者更好：

```
logo:first-letter  {color:blue;}
logo:nth-letter[2] {color:red;}
logo:nth-letter[3] {color:yellow;}
logo:nth-letter[4] {color:blue;}
logo:nth-letter[5] {color:green;}
logo:nth-letter[6] {color:red;} 
```

到目前为止，我发现的最接近的技巧是彩虹文本的这个技巧：[http ://rainbowcoding.com/how-to-create-rainbow-text-in-html-css-javascript/](http://rainbowcoding.com/how-to-create-rainbow-text-in-html-css-javascript/)

如果可能的话，我也很喜欢这个解决方案来避免使用 javascript；太多了？

**更新**

这是一些基于破解彩虹的示例代码 - 但是在您调整文本大小的那一刻（例如 ctrl ++）它很快就会中断。

```
<!DOCTYPE html>
<html>
<head>
  <meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
  <title>Google Demo</title>
  <style type="text/css" media="screen">
    h1 {
        background-image:-webkit-gradient( 
        linear, left top, right top
        , color-stop(0, blue)
        , color-stop(0.018, blue)
        , color-stop(0.018, red)
        , color-stop(0.030, red)
        , color-stop(0.030, yellow)
        , color-stop(0.040, yellow)
        , color-stop(0.040, blue)
        , color-stop(0.054, blue)
        , color-stop(0.054, green)
        , color-stop(0.058, green)
        , color-stop(0.059, red)
        , color-stop(0.108, red)
        );
        color:transparent;
        -webkit-background-clip: text;      
    }
  </style>
</head>
<body lang="en-US">
<h1>Google</h1>
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-08T23:09:35.073

您可以在 css 中尝试 nth-child() 。查看此链接：[http ://css-tricks.com/useful-nth-child-recipies/](http://css-tricks.com/useful-nth-child-recipies/)

小心 css 中的 n-th-child 我认为 IE 支持是 ie9+

span:nth-last-child(2) { 颜色：绿色；}

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-08T23:20:40.617

我认为如果不将每个字母包装在某种标签中，您就无法做到这一点，这样您就可以使用 CSS 或 JavaScript 来定位它。有趣的问题虽然...

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-08T23:42:22.860

附言。这是适用于有类似问题但没有 js 问题的任何人的 javascript 版本。这使用了 Jesse 的第 n 个孩子的技巧以及一些代码来发挥相关标签。

```
<!DOCTYPE html>
<html>
<head>
  <meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
  <title>Google Demo</title>
  <style type="text/css" media="screen">
    h1 .x:nth-child(1) { color: blue; }
    h1 .x:nth-child(2) { color: red; }
    h1 .x:nth-child(3) { color: yellow; }
    h1 .x:nth-child(4) { color: blue; }
    h1 .x:nth-child(5) { color: green; }
    h1 .x:nth-child(6) { color: red; }
  </style>
  <script type="text/javascript" charset="utf-8">
    function fancy() {
        var h1s = document.getElementsByTagName('h1');
        for(var i = 0; i < h1s.length; i++) {
            var h1Text = h1s[i].innerText;
            var h1InnerHTML = '';
            for(var j = 0; j < h1Text.length; j++) {
                h1InnerHTML += '<span class="x">' + h1Text[j] + '</span>'; //nb: innerHTML is a dodgy hack, but fine for demos / works in Chrome
            }
            h1s[i].innerHTML = h1InnerHTML;
        }
    }
  </script>
</head>
<body lang="en-US" onload="fancy();">
    <h1>Google</h1>
</body>
</html> 
```

# facebook - Facebook 的客户端身份验证是否足够安全？

> ID：14225465
> 
> 赞同：0
> 
> 时间：2013-01-08T22:54:20.623
> 
> 标签：facebook, facebook-javascript-sdk

我正在考虑为我的网站登录 Facebook。基于基于 facebook 的身份验证，用户将登录到该站点。并且将继续使用它，直到他/她从网站注销，无论 Facebook 登录状态如何。像大多数其他网站一样。

在查看 FB 的客户端登录方法时，我注意到它基于从 fbsr_{app_id} cookie 接收到的 signed_request 数据。FB 希望在它发出后 10 分钟内将其交换为有效的短期 access_token，以验证身份验证请求。（这 10 分钟似乎是 FB 为尽量减少安全漏洞所做的最大努力。）

但是，在这 10 分钟内，其他人可以复制 cookie 并且没有太大困难，可以成功尝试以受害者身份登录。这是我关心的问题，想问以下问题：

1.  我是否在这里遗漏了有关 FB 客户端身份验证的安全方面的内容，或者它确实有这个弱点？

2.  在我的实现中我可以做些什么来填补空白，还是转向 FB 的服务器端身份验证是唯一的答案？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-11T05:32:01.807

无论您使用服务器端流程还是客户端流程 - 如果使用正确，它们都是完全安全的。正如您所提到的，在基于非 SSL 的网站上使用 cookie 选项确实是一个漏洞，但这是不受 Facebook 控制的漏洞。

如果您想完全避免这种攻击向量，请不要使用 cookie 选项，而是使用您选择的机制（例如 XHR over SSL）将签名请求从前端传递到后端。为此，只需订阅相关事件 - 然后将使用签名请求作为响应的一部分调用您的处理程序。

应始终在服务器上验证签名请求，以避免任何篡改或虚假使用。signed_request 还包含issued_at 时间，应在最后10 分钟内进行验证。（对于 FB 的用户 id，使用它提供的 user_id）。

# ruby-on-rails - 您可以在 Ruby on Rails 中从另一个 before_filter 调用 before_filter 吗？

> ID：14225469
> 
> 赞同：1
> 
> 时间：2013-01-08T22:54:36.827
> 
> 标签：ruby-on-rails, before-filter

是否可以从另一个调用 before_filter ？我问的原因是因为我有两个相似的 before_filters，但一个有一个额外的条件仍然可以让它为真。因此，如果第一个 before_filter 为真，则第二个也为真，但如果第一个为假，则检查另一个条件，然后确定它是真还是假。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-10-11T20:21:05.760

过滤器只是方法是正确的，所以回答你的问题：

是的，可以从其他过滤器调用过滤器。

但请注意，您不应渲染或重定向两次，否则您将收到一个`AbstractController::DoubleRenderError`. 因此，如果其中一个过滤器正在渲染，则不应调用另一个过滤器。

使用布尔返回值来管理它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-09T00:48:27.233

你可以。before_filter 只是一个调用常规方法的触发器。该方法可以调用任何其他方法，甚至是其他 before_filters 调用的方法。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-01-08T23:00:52.123

如果你不想结合我的方法，你可以做这样的事情。

```
before_filter :filter_method

def filter_method
 if method_one == true
  method_two
 end
end

def method_one
 # stuff here
end

def method_two
 # stuff here
end 
```

# c++ - 比 Cuda 更好的 C++ 时序

> ID：14225471
> 
> 赞同：1
> 
> 时间：2013-01-08T22:54:41.067
> 
> 标签：c++, cuda

我在 CUDA 中编写程序时遇到问题。我正在做的程序是一个加密，它执行一个矩阵乘以一个向量，并根据我引入的向量给我一个结果。问题是我在 C++ 和 CUDA 上都花时间，并且在 C++ 上给了我比 CUDA 更好的结果。我做的是做一个循环，因为我需要几个密钥来加密，代码如下：

```
t1 = clock();
do {

    HANDLE_ERROR ( cudaMemcpy(MAT_dev, MAT, nBytes, cudaMemcpyHostToDevice) );
    HANDLE_ERROR ( cudaMemcpy(VEC_dev, VEC, nBytes, cudaMemcpyHostToDevice) );

    mult<<< 1, b >>>(MAT_dev, VEC_dev, SOL_dev, b);

    HANDLE_ERROR ( cudaMemcpy(SOL, SOL_dev, nBytes, cudaMemcpyDeviceToHost) );

    for (i = 0; i < b; i++) {
        cout << SOL[i] << " ";
    }
    cout << endl;

    for (i = 0; i < b; i++) {
        VEC[i] = SOL[i];
    }

    cont = cont + 1;

} while (cont < w);
t2 = clock(); 
```

我的结果：

## C++：11.474 分钟

## CUDA：40.464 分钟

密钥的数量为 1,000,000。矩阵 7 x 7 和向量 7。

不知道它是否可以，或者我错过了一些让它更快的东西。

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-08T23:43:28.607

Possible problems of your code:

1.  spending most of the time on `cudaMemcpy()` and `cout<<`
2.  speed may be limited by the grid/block size. Generally speaking, # blocks in a grid should be >= # stream processes to fully utilize the GPU hardware; # threads in a block should be at least 64 and always be multipe of warp size.
3.  matrix/vector size too small to achieve good scalability

Possible solutions:

1.  Instead of doing 1,000,000 m_{7x7} * v_{7}, try to do 1 m_{7,000,000x7} * v_{7};
2.  try to merge 1,000,000 cudaMemcpy() into 1;
3.  Use cudaMallocPitch() to alloc memory for small matrices, which relax the aligment problem;
4.  try to use cublas_gemv() provided in cublas library if the element type of your matrix/vector is double/float

You may wish to read the CUDA C programming guide & C best practices guide before writing your own kernels

# ios - SLRequest 处理 Facebook Token 过期等

> ID：14225473
> 
> 赞同：0
> 
> 时间：2013-01-08T22:54:47.630
> 
> 标签：ios, facebook

在我的应用程序中，我有一个 UISegmentControl 设置为 Yes 或 No 的 Settings 视图，以允许使用 SLRequest 和 Accounts Framework 将查看的页面自动发布到 Facebook。它的流程是这样的：

它会自动设置为 No。当用户单击 Yes 时，它会运行以下代码：

```
-(void)facebookpost {
    ACAccountStore *accountStore = [[ACAccountStore alloc] init];

    ACAccountType *facebookAccountType = [accountStore accountTypeWithAccountTypeIdentifier:ACAccountTypeIdentifierFacebook];

    // We will pass this dictionary in the next method. It should contain your Facebook App ID key,
    // permissions and (optionally) the ACFacebookAudienceKey
    NSDictionary *options = @{ACFacebookAppIdKey : @"APPID",
    ACFacebookPermissionsKey : @[@"email", @"publish_stream"],
ACFacebookAudienceKey:ACFacebookAudienceFriends};

    // Request access to the Facebook account.
    // The user will see an alert view when you perform this method.
    [accountStore requestAccessToAccountsWithType:facebookAccountType
                                          options:options
                                       completion:^(BOOL granted, NSError *error) {
                                           if (granted)
                                           {
                                               // At this point we can assume that we have access to the Facebook account
                                               NSArray *accounts = [accountStore accountsWithAccountType:facebookAccountType];

                                               // Optionally save the account
                                               [accountStore saveAccount:[accounts lastObject] withCompletionHandler:nil];
                                           }
                                           else
                                           {
                                               [[NSUserDefaults standardUserDefaults] setBool:NO forKey:@"facebook"];
                                               [[NSUserDefaults standardUserDefaults] synchronize];
                                               NSLog(@"Failed to grant access\n%@", error);
                                           }
                                       }];

} 
```

它还将 NSUserDefault 键的 Bool 值设置为 YES，用于 facebookposting。

然后，在稍后的代码中，当查看页面时，如果 facebookposting 的值为 YES，则运行此代码。如果否，它根本不会运行此代码：

```
-(void)writetowall {
    ACAccountStore *accountStore = [[ACAccountStore alloc] init];

    ACAccountType *accountType = [accountStore accountTypeWithAccountTypeIdentifier:ACAccountTypeIdentifierFacebook];
    NSArray *accounts = [accountStore accountsWithAccountType:accountType];

    // If we don't have access to users Facebook account, the account store will return an empty array.
    if (accounts.count == 0)
        return;

    // Since there's only one Facebook account, grab the last object
    ACAccount *account = [accounts lastObject];

    // Create the parameters dictionary and the URL (!use HTTPS!)
    NSDictionary *parameters = @{@"message" : @"MY MESSAGE", @"link": _entry.articleUrl};
    NSURL *URL = [NSURL URLWithString:@"https://graph.facebook.com/me/feed"];

    // Create request
    SLRequest *request = [SLRequest requestForServiceType:SLServiceTypeFacebook
                                            requestMethod:SLRequestMethodPOST
                                                      URL:URL
                                               parameters:parameters];

    // Since we are performing a method that requires authorization we can simply
    // add the ACAccount to the SLRequest
    [request setAccount:account];

    // Perform request
    [request performRequestWithHandler:^(NSData *respData, NSHTTPURLResponse *urlResp, NSError *error) {
        NSDictionary *responseDictionary = [NSJSONSerialization JSONObjectWithData:respData
                                                                           options:kNilOptions
                                                                             error:&error];

        // Check for errors in the responseDictionary
    }];
} 
```

我想知道的是如何以及在何处处理诸如从 Facebook 中删除权限或更改密码等事情。是否需要在获得权限的第一组代码中处理？因为，基本上这组代码只运行一次，其余时间它只运行代码以发布到墙上。

# java - 关于 Java Web Start 的问题

> ID：14225480
> 
> 赞同：2
> 
> 时间：2013-01-08T22:55:41.023
> 
> 标签：java, jar, executable-jar, java-web-start

我正在研究将在 Windows 和 Mac 上运行的桌面 Java 应用程序的部署选项。我目前正在研究 Web Start，但我有几个问题。

1.  如果我可以创建一个可执行的 jar 文件并且用户可以双击它来启动应用程序，为什么我什至需要使用 Web Start？为什么不直接将 jar 文件粘贴到 Web 服务器上并让用户下载呢？我从使用 Web Start 中得到了什么？

2.  我的理解是安装 JRE 时会出现 Web Start。但是如果用户没有在他们的机器上安装 Java 会发生什么？它会引导他们完成安装过程，还是必须自己下载并安装 JRE？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-08T23:08:15.260

Java Web Start 使您的用户能够通过从 Web 上单击来启动应用程序（前提是他们安装了 JRE）。让您的用户下载可执行 jar 的主要优点有两个：

1.  为您的用户减少麻烦（一键与下载和执行）
2.  Java Web Start 确保您的用户始终使用最新版本的应用程序。鉴于您的其他解决方案，您的用户将自己跟踪更新他的本地应用程序，或者您需要提供更新机制。

自 1.4.2 版起，Java Web Start 包含在所有 JRE 中。您的用户需要在他的机器上安装它才能运行您的 Web Start 应用程序（他也需要它来生成可执行的 jar）。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-01-09T03:59:22.847

请参阅 SO 的[Java Web Start Wiki](https://stackoverflow.com/tags/java-web-start/info)页面了解您的大部分答案。

> 1) 我从使用 Web Start 中得到了什么？

从第 2 段开始：

> JWS 提供了许多吸引人的功能，包括但不限于
> 
> *   闪屏
> *   桌面集成
> *   文件关联
> *   自动更新（包括延迟下载和更新的编程控制）
> *   按平台、架构或 Java 版本划分本地和其他资源下载
> *   运行时环境的配置（最低 J2SE 版本、运行时选项、RAM 等）
> *   使用扩展轻松管理公共资源..

* * *

> 2) 如果用户没有在他们的机器上安装 Java，会发生什么？

这就是它的`deployJava.js`用途。

> [Java 富 Internet 应用程序部署建议](http://download.oracle.com/javase/7/docs/technotes/guides/jweb/deployment_advice.html)。描述`deployJava.js` 旨在确保在提供 JWS 应用程序链接之前安装合适的最低 Java 版本的脚本。或启动小程序。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-01-08T23:08:37.380

1.  Java Web Start 允许用户启动应用程序而无需先下载 JAR；该应用程序可以简单地在网页中一键启动。此外，它可以确保下载最新版本的应用程序及其所有依赖项，并且可以确保 JRE 是最新的，并且
2.  如果没有安装在 Internet Explorer 上，它可以自动安装 JRE，并提供其他平台的下载链接。请参阅[Oracle 在 Java Web Start 上的文档](http://docs.oracle.com/javase/7/docs/technotes/guides/javaws/developersguide/launch.html#intro)。

此外，[维基百科的文章](http://en.wikipedia.org/wiki/Java_Web_Start)也提供了一些有用的信息。

尽管如此，甚至 Oracle 似乎也放弃了 Web Start（上面的文档链接，从 Java 7 开始，已经严重过时了 VBScript 和有关 Netscape 的示例），并且越来越少的用户在他们的浏览器中启用了 Java 插件，主要是因为在过去的几年中存在许多安全漏洞。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-01-08T23:04:15.847

Webstart 有一些很酷的内置版本控制。当您发布新版本时，它将下载它。

您可以签署您的 webstart 应用程序

某些机器无法正确配置以允许“双击”启动 jar

没有 Java 的用户需要安装它。可能没有简单的方法解决这个问题。Java站点使它变得非常容易

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-01-08T23:04:48.870

不确定数字 2，但这是我对数字 1 的 2 美分：

对我来说，JWS 最重要的特性是它可以处理您的依赖关系。如果您在项目中使用任何库，JWS 将负责为用户安装它们。

对此的替代方法是让您构建一个包含您的依赖项的“胖罐”，这可能不适用于所有类型的依赖项。

# python - 在不同的机器上安装带有数据库服务器的 openerp 7

> ID：14225492
> 
> 赞同：3
> 
> 时间：2013-01-08T22:56:23.273
> 
> 标签：python, postgresql, openerp

我正在尝试在 lxc 容器内的 ubuntu 12.04 上安装 openerp 7。数据库服务器位于主机上。一切正常，但是当我第一次尝试访问 webclient 时，我在浏览器中（也在终端中）出现错误，即 openerp 无法连接到数据库服务器。这是我的 openerp-server.conf 文件：

```
[options]
; This is the password that allows database operations:
; admin_passwd = admin
debug_mode = True
db_host = '10.0.3.1'
db_port = 5432
db_user = openerp
db_password = openerp
db_name = openerp
logfile = /var/log/openerp/openerp-server.log 
```

我也试过

```
db_host = 10.0.3.1 
```

当我启动服务器时，我收到了以下信息消息：

```
2013-01-08 22:46:39,688 654 INFO ? openerp: OpenERP version 7.0-20130106-001538
2013-01-08 22:46:39,688 654 INFO ? openerp: addons paths: /opt/openerp/server/openerp/addons
2013-01-08 22:46:39,688 654 INFO ? openerp: database hostname: localhost
2013-01-08 22:46:39,688 654 INFO ? openerp: database port: 5432
2013-01-08 22:46:39,688 654 INFO ? openerp: database user: openerp
2013-01-08 22:46:40,106 654 INFO ? openerp.service.wsgi_server: HTTP service (werkzeug) running on 0.0.0.0:8069
2013-01-08 22:46:40,106 654 INFO ? openerp: OpenERP server is running, waiting for connections... 
```

日志文件有 777 权限，为空。当我尝试从浏览器访问 openerp 时，这是错误的一部分：

```
ERROR postgres openerp.sql_db: Connection to the database failed
Traceback (most recent call last):
  File "/opt/openerp/server/openerp/sql_db.py", line 433, in borrow
    result = psycopg2.connect(dsn=dsn, connection_factory=PsycoConnection)
  File "/usr/lib/python2.7/dist-packages/psycopg2/__init__.py", line 179, in connect
    connection_factory=connection_factory, async=async)
OperationalError: could not connect to server: No such file or directory
    Is the server running locally and accepting
    connections on Unix domain socket "/var/run/postgresql/.s.PGSQL.5432"?

2013-01-08 22:48:21,553 654 ERROR postgres openerp.netsvc: could not connect to server: No such file or directory
    Is the server running locally and accepting
    connections on Unix domain socket "/var/run/postgresql/.s.PGSQL.5432"?
Traceback (most recent call last):
  File "/opt/openerp/server/openerp/netsvc.py", line 289, in dispatch_rpc
    result = ExportService.getService(service_name).dispatch(method, params)
  File "/opt/openerp/server/openerp/service/web_services.py", line 122, in dispatch
    return fn(*params) 
```

db 服务器正在接受来自 lxc 容器的连接，我创建了一个小的 python 脚本来测试它并且它有效。

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-08T23:57:33.557

您输出的第三行表明 OpenERP 正在寻找数据库服务器`localhost`。我猜 OE 没有看到你的配置文件。作为一项快速测试，您可以手动运行 OE，例如：

```
/usr/local/bin/openerp-server --conf /path/to/config_file 
```

看看这是否有效。如果是这样，请找到适当的启动脚本并使用您的配置文件和日志文件参数对其进行调整。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-09T06:05:21.077

我最近安装了 OpenERP v7.0，这个博客对我帮助很大。请参阅**[在 Ubuntu 上安装 OpenERP 7.0](http://jayvora.blogspot.com/2012/12/how-to-install-openerp-7-on-ubuntu-1204.html)。**

希望这会帮助你。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-11T10:36:17.803

我通过修改这个文件解决了同样的问题：

```
/usr/lib/python2.6/site-packages/openerp-7.0_20130211_002141-py2.6.egg/openerp/tools/config.py 
```

里面有一段：

```
 if self.options['db_password']:
        if sys.platform == 'win32' and not self.options['db_host']:
            self.options['db_host'] = 'localhost'
        #if self.options['db_host']:
        #    self._generate_pgpassfile()

    if opt.save:
        self.save() 
```

在“if op.save:”之前添加：

```
 self.options['db_host'] = '<address_of_db_host>' 
```

# javascript - jquery slidetoggle 不会保持打开状态

> ID：14225500
> 
> 赞同：0
> 
> 时间：2013-01-08T22:57:13.447
> 
> 标签：javascript, jquery, html, css, jquery-ui-accordion

我正在尝试在无序列表上创建 jquery 幻灯片切换效果。它会打开，但随后会立即向上滑动。我无法弄清楚它是我的 CSS 还是我的 jquery。顺便说一句，由于某种原因，我无法与我的 jsfiddle 一起使用，所以 jsfiddle 只是我的 css、html 和 jquery 的视图。这是我正在使用的 jquery：

```
function accordionLoad() {

    $(".accordion-header").removeClass("expanded");
    $(".accordion-content").hide();

    $(".accordion-header").bind("click", function(){
        $(this).toggleClass("expanded");
        $(this).next(".accordion-content").slideToggle();
    })

    $(".expand-all").bind("click",function(){
        $(this).siblings(".accordion").find(".accordion-content").slideDown();
        $(this).siblings(".accordion").find(".accordion-header").addClass("expanded");
    })

    $(".collapse-all").bind("click",function(){
        $(this).siblings(".accordion").find(".accordion-content").slideUp();
        $(this).siblings(".accordion").find(".accordion-header").removeClass("expanded");
    })
}

$(document).ready(function(){
    accordionLoad();
}); 
```

和 ..

```
 <!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">

<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Untitled 1</title>
<meta name="Microsoft Theme" content="HDRDefault 1011, default" />

</head>
<body> 
<div class="container">
  <div class="expand-all">Expand All</div><div class="collapse-all">Collapse All</div>
  <UL class="accordion">
    <LI class="accordion-item">
      <DIV class="accordion-header">Question2</DIV>
      <DIV class="accordion-content">
        <DIV class="Externa">Answer2..Answer2..Answer2..Answer2..Answer2..Answer2..Answer2..</DIV>      
      </DIV>
    </LI>

    <LI class="accordion-item">
      <DIV class="accordion-header">Question12</DIV>
      <DIV class="accordion-content">
        <DIV class="Externa">Answer12..Answer12..Answer12..Answer12..Answer12..Answer12..Answer12..</DIV>      
      </DIV>
    </LI>  
  </UL>
  </div>  
</body>
</html> 
```

这是jsfiddle：http: [//jsfiddle.net/9CNeX/8/](http://jsfiddle.net/9CNeX/8/)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-09T12:58:29.757

看这个例子...

[jsfiddle](http://jsfiddle.net/9CNeX/21/)

```
$('.accordion-header').on('click', function(e){
  $(this).next().slideToggle();
}); 
```

问候。

# html - 服务器端的服务器发送事件成本

> ID：14225501
> 
> 赞同：21
> 
> 时间：2013-01-08T22:57:13.977
> 
> 标签：html, http, server-sent-events

如果我正确理解了服务器发送事件的原则，那么每次客户端注册到 EventSource 时，它​​实际上都会打开一个新的 HTTP 连接到管理事件的资源。与其他 HTTP 请求相反，连接保持活动状态，因此专用于该客户端的服务器进程/线程继续运行，直到客户端断开连接。

如果我们有 1000 个客户端使用 SSE 连接到应用程序怎么办？我们是否会同时运行 1000 个进程/线程（做同样的事情）来处理 SSE？我想我错了，但如果我不是，它真的比通常的 AJAX 轮询方法更有效吗？至少服务器不需要同时运行那么多进程/线程？

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2013-01-09T00:36:46.950

是的，每个客户端都尽可能保持连接打开。如果有 1000 个并发用户，您将打开 1000 个 TCP/IP 连接。

但是，每个连接是否使用线程取决于服务器。

Apache 通常为每个连接保持一个线程运行，因此它非常昂贵。对于 Apache，最好禁用 KeepAlive 并使用轮询。

OTOH 使用像 node.js 这样的基于事件的服务器，您可以只使用一个进程来管理所有连接，因此每个连接的成本要低得多，并且您应该能够轻松地保持数千个连接打开。

SSE 最酷的地方在于，您也可以使用它进行轮询。它具有`retry:`指定客户端在再次重新连接（轮询）之前应该等待多长时间的指令。只需发送它并在您想要轮询时关闭连接。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2013-01-09T00:38:14.450

这取决于服务器的线程模型。 [Apache](http://httpd.apache.org/docs/2.2/mod/worker.html)默认每个连接一个线程（或进程），因此，即使线程没有做很多事情（正如 SSE 连接所期望的那样），它们也会坐在那里耗尽资源。

像[Nginx](http://wiki.nginx.org/Main)这样的服务器有一个稍微不同的模型，每个线程异步处理多个请求。所以像 SSE 和 WebSockets 这样的东西效率更高。

可以使 Apache[执行得更像 Nginx](http://httpd.apache.org/docs/2.4/mod/event.html)和类似的服务器。

# php - iOS imageview jpeg错误，来自php服务器的回显损坏

> ID：14225507
> 
> 赞同：3
> 
> 时间：2013-01-08T22:57:43.627
> 
> 标签：php, ios, nsurlconnection, jpeg

我有一个 base64 编码的 imageview 发送到 php，当我回显它时，当我尝试将它转回 imageview 时它已损坏。我的解码器可以工作，因为当我在本地解码它时它工作正常..所以一旦我将它发送到 php，它就必须被破坏。这是日志错误消息：

```
 Jan  8 14:21:33 Vessel.local Topic[11039] <Error>: ImageIO: JPEG Corrupt JPEG data:214          extraneous bytes before marker 0x68  Jan  8 14:21:33 Vessel.local Topic[11039] <Error>: ImageIO: JPEG Unsupported marker type 0x68 
```

有人可以告诉我这意味着什么，以及一旦我将字符串发送到服务器后，我如何无法防止字符串被损坏。我使用普通的 iOS 发布代理并且没有错误，唯一的错误是一旦我将其转换为 imageview。

这是将图像编码为 base64 的代码：

```
 NSData *imageData = UIImageJPEGRepresentation(crop, 1.0);
    NSString *baseString = [imageData base64EncodedString];
    int original =[baseString length];
    NSLog(@"orignal String=%@",baseString);
    [self register:username.text withPass:password.text withEmail:email.text withQuote:quote.text withPic:baseString]; 
```

这是我用来将图像发送到我的 php 服务器的代码：

```
NSString *urlString = [NSString stringWithFormat:@"http://localhost/Topic/Mobile/auth/registration.php"];
NSURL *url = [NSURL URLWithString:urlString];
NSMutableURLRequest *request = [NSMutableURLRequest requestWithURL:url cachePolicy:NSURLRequestUseProtocolCachePolicy timeoutInterval:30.0];
[request setHTTPMethod:@"POST"];
NSString *param = [NSString stringWithFormat:@"username=%@&password=%@&email=%@&quote=%@&pic=%@",user,password,email,quote,pic];
[request setHTTPBody:[param dataUsingEncoding:NSUTF8StringEncoding]]; 
```

NSURLConnection *connection = [[NSURLConnection alloc]initWithRequest:request delegate:self startImmediately:YES];

这是我用来将 base64 字符串转换回图像的代码：

```
 -(void)connectionDidFinishLoading:(NSURLConnection *)connection{

homeData = [NSJSONSerialization JSONObjectWithData:responseData options:nil error:nil];

NSString *decodeString = [[homeData objectAtIndex:0]objectForKey:@"profile_pic" ];
//int returnNUM = [decodeString length];
NSLog(@"RETURN STRING=%@",decodeString);
NSData *data = [NSData dataFromBase64String:decodeString];
profilepic = [[UIImageView alloc]initWithFrame:CGRectMake(5, 4, 120, 120)];
profilepic.image = [UIImage imageWithData:data];
UIGraphicsBeginImageContextWithOptions(profilepic.bounds.size, NO, 1.0);
[[UIBezierPath bezierPathWithRoundedRect:profilepic.bounds cornerRadius:80.0] addClip];
[profilepic.image drawInRect:profilepic.bounds];
profilepic.image = UIGraphicsGetImageFromCurrentImageContext();
UIGraphicsEndImageContext();
[self.view addSubview:profilepic]; 
```

}

编码器和解码器工作正常......当我将字符串发布到网络时，它是如何搞砸的。我尝试将其发送到 php 后立即将其回显，但它仍然损坏..所以当它离开手机的那一刻，内容发生了变化。请帮助或请上传如何在一个帖子中一起发布图像和 NSSTRING 参数的示例

# mysql - 更新查询有时不会更新 mySQL 数据库中的字段

> ID：14225509
> 
> 赞同：9
> 
> 时间：2013-01-08T22:57:47.007
> 
> 标签：mysql, innodb

我有一个 mySQL 更新查询，有时会更新所有字段，有时会更新除一个以外的所有字段。

它在大约 10% 的调用中失败。

我的桌子是：

```
CREATE TABLE IF NOT EXISTS `grades` (   
`id` int(11) NOT NULL AUTO_INCREMENT,   
`state` int(1) NOT NULL,   
`result` varchar(255) NOT NULL,   
`date_synced` datetime NOT NULL,
`updated_at` datetime NOT NULL,
PRIMARY KEY (`id`) ) 
ENGINE=InnoDB  DEFAULT CHARSET=utf8 AUTO_INCREMENT=4395 ; 
```

我的查询是：

```
$sqlstr = "UPDATE grades SET result = '$result', state = 2, date_synced = '$date', updated_at = '$date' WHERE id = $id"; 
```

当失败时，result、date_synced 和 updated_at 会更新，但状态保持不变。

还有另一个查询只更新状态字段，并且也间歇性地失败。

我一直无法在我们的测试环境中重现问题。生产 mySQL 数据库是否有问题或某种锁定冲突？

* * *

我有更多信息。我正在使用 mysqli。另一个只更新状态的查询是使用 mysql。这会导致问题吗？

我以为 InnoDB 按行锁定。它不允许部分行更新，是吗？

* * *

另一个更新来解决评论。

我的代码流非常线性。

```
The row is created with state=0.
<flash stuff here> and the row is updated with state=1
A cron job pulls all state=1 and sends an api call
if api call is successful, the row is updated with state=2, result, date_synced, and updated_at
if api call is error, the row is updated with state=3, result, and updated_at 
```

state 字段永远不会设置回 0（在 flash 之后）或 1（在 api 调用之后）。由于 date _synced 和 result 正在设置，但（有时）状态仍为 1，这就像对 state 字段的更新正在被删除。

我将添加更新触发器，看看是否能提供更多信息。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-08T23:21:15.937

它是否说明“{n} 行受影响？”

此外，它是否可重复？你可以对完全相同的数据运行相同的查询，它会做不同的事情吗？

如果是这样，您可能有损坏的安装或损坏的数据库。

您是否尝试过对桌子进行修复和优化？那会有所帮助。

很抱歉的回答很抱歉：P

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-15T23:50:08.137

尝试将字段名称从“state”更改为其他名称，例如“state_num”。虽然它没有被列为 MySQL 的保留字，但它的名称可能会导致问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-13T01:17:45.953

将 MySQL 中的“严格性”重新调整为 TRADITIONAL：

```
SET sql_mode = 'TRADITIONAL'; 
```

并尝试在没有 PHP 的情况下从控制台插入。然后检查可以解释它的错误。

通过以下方式将严格性重置为“宽容”：

```
SET sql_mode = ''; 
```

或者，如果您使用 PDO 对象连接到数据库，则通过 PHP 得到一个错误，如下所示：

```
try {
  $sqlstr = "UPDATE grades SET result = '$result', state = 2, date_synced = '$date',updated_at = '$date' WHERE id = $id";
$s = $pdo->exec($sqlstr);
}
catch (PDOException $e) {
  $error = $e->getMessage();
  echo $error;
} 
```

基本上，尽一切可能获取正在发生的错误消息。很可能 SQL 正在发送错误，但 PHP 未设置为在您的脚本中显示它。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-10-26T23:05:04.827

您设置“状态”和其他字段的查询会运行两次，有时您的一项任务比另一项完成得更快。它会更新所有字段，并且调用该任务的脚本还会运行更新“状态”字段的 MySQL 查询。

例如，您有一个 PHP 脚本，它通过 exec() 在后台运行 shell 命令“tar”，并在完成后在 DB 中设置“状态”。您的 PHP 代码的下一个字符串会更新您数据库中的“状态”。但有时，您调用的 bash 命令的运行速度比 PHP 脚本调用 MySQL 更新的速度快（如果此 bash 命令在后台模式下运行）。

第一步：从 PHP 运行 bash 脚本，在完成后设置“state”=3（等待进一步处理），用日期等更新其他字段。

下一步：在 exec() 之后的 PHP 中设置“state” = 2（正在进行中）。在这种情况下，如果您在后台的 bash 脚本比 PHP 运行 MySQL 更新查询更快地完成这项工作，您将获得更新的日期值以及“状态”= 2（但它在一秒钟前的值 = 3）。

我有这个问题。

# python - 约束 Mayavi 鼠标拖动以围绕其轴旋转地球

> ID：14225512
> 
> 赞同：5
> 
> 时间：2013-01-08T22:57:54.417
> 
> 标签：python, scipy, visualization, mayavi, mayavi.mlab

使用 iPython Notebook，我已经能够使用如下代码创建一个地球仪：

```
from mayavi import mlab
from mayavi.sources.builtin_surface import BuiltinSurface

ocean_blue = (0.4, 0.5, 1.0)
r = 6371 # km

sphere = mlab.points3d(0, 0, 0, name='Globe',
  scale_mode='none', scale_factor=r * 2.0,
  color=ocean_blue, resolution=50)

sphere.actor.property.specular = 0.20
sphere.actor.property.specular_power = 10

continents_src = BuiltinSurface(source='earth', name='Continents')
continents_src.data_source.on_ratio = 1  # detail level
continents_src.data_source.radius = r
continents = mlab.pipeline.surface(continents_src, color=(0, 0, 0)) 
```

但是当我使用鼠标与生成的 3D 窗口进行交互时，很难将其保持为正面朝上，因为 UI 将鼠标向左或向右拖动解释为尝试旋转场景（或相机？）围绕窗口的当前垂直轴，而不是通过地球本身的轴。

是否有任何方法可以约束用户交互代码，以便鼠标左键或右键围绕其轴旋转地球，无论轴是否指向垂直向上和向下，或者通过设置一些 Mayavi 参数，还是通过将一些 Python 代码注册为用于鼠标拖动的 UI 事件处理程序？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-09-13T18:43:31.023

九个月后，我终于找到了一条线索，让我找到了解决办法！另一个 Stack Overflow 问答，[是否可以在 Mayavi 中禁止使用鼠标旋转轴？](https://stackoverflow.com/questions/15116508/is-it-possible-to-prohibit-axes-rotation-with-the-mouse-in-mayavi)，让我想到了设置一个非默认的“交互器”来控制鼠标点击和拖动的含义。

不管用户做什么，确实有一个交互器可以让 Z 轴“向上”：

[http://www.vtk.org/doc/nightly/html/classvtkInteractorStyleTerrain.html](http://www.vtk.org/doc/nightly/html/classvtkInteractorStyleTerrain.html)

要在 Mayavi 主窗口中激活此交互器，只需将以下三行添加到您的代码中（例如，您可以将它们添加到问题中我的地球构建代码中），地球将始终保持直立！

```
from tvtk.api import tvtk
fig = mlab.gcf()
fig.scene.interactor.interactor_style = tvtk.InteractorStyleTerrain() 
```

# python - 将 python/web2py 应用程序合并到 wordpress 站点中

> ID：14225513
> 
> 赞同：1
> 
> 时间：2013-01-08T22:58:03.970
> 
> 标签：python, wordpress, web2py

我被要求在现有网站中实施一种日志系统。该网站不是我开发的，它是一个朋友拥有的小公司，我免费提供帮助。它是用 Wordpress 制作的，并托管在他自己的服务器上。

我没有丰富的 PHP 经验，但我使用 Python/web2py 创建了一个相当不错的 Web 应用程序，理想情况下我想再次使用它。

这是否可以将其构建到现有站点中，或者构建一个独立的应用程序并将其托管在同一台服务器上会更好吗？我在这个级别上没有真正的经验，如果这是一个愚蠢的问题，我很抱歉

# java - 我知道抽象/覆盖的静态方法在 Java 中是不可能的，但我的代码似乎需要它们

> ID：14225515
> 
> 赞同：0
> 
> 时间：2013-01-08T22:58:10.623
> 
> 标签：java

我确定我会以错误的方式解决这个问题，但是我想实现一个通用模式，其中某个类的实例表示集合的元素，而该类的静态方法将集合的属性指定为整个。我从一个类开始，因此只有一个集合，但我想将它扩展到类似的集合，并拥有适用于所有这些集合的通用方法。我正在考虑创建更多类并让它们都扩展相同的接口，但这将涉及指定静态方法的接口和覆盖它们的实现类。

我认为这个问题可能最好用群论来解释。对于那些不知道的人，组是一个数学对象，它包含一组元素，以及一个组合两个元素并返回第三个元素的组运算（用 * 表示）。在其他条件中，必须有一个单位元素 e，使得所有 e 的 a * e = a，并且每个元素 a 必须有一个逆 ai，使得 a * ai = e。最简单的例子是整数，其中加法是群运算，单位元素为零，元素的逆是它的否定。如果我有一个操作组元素的通用类，那么在某些情况下我需要知道组的标识元素是什么。

所以我的群组示例界面可能类似于

```
public interface GroupElement {

    public GroupElement operate(GroupElement element);

    public static GroupElement identity();

} 
```

整数实现是这样的（忽略与先前存在的 Integer 类的明显冲突）：

```
public class Integer implements GroupElement {

    private int i;

    public Integer(int i) {
        this.i = i;
    }

    public Integer operate(Integer other) {
        return new Integer(i + other.i);
    }

    public static Integer identity() {
        return new Integer(0);
    }
} 
```

然后是一个通用对象，用于检查一个元素是否与另一个元素相反：

```
public class InverseChecker <E implements GroupElement> {

    public boolean isInverse(e element1, e element2) {
        return element1.operate(element2).equals(E.identity());
    }
} 
```

显然上面的代码有很多错误。第一个问题是我无法在接口中声明静态方法，即使我使用抽象父类，子类也无法覆盖静态方法。我可以使 identity() 方法成为非静态方法，但是我需要它的一个实例，而我并不总是拥有它。我也不能从泛型类型 E 调用静态方法。我想我可以制作两个接口，一个用于组，一个用于组的元素，但是看起来它确实会使 InverseChecker 对象之类的代码变得复杂（所有内容都需要两个类型参数，我将不得不重新编写我的很多代码，我不确定如何指定两个接口之间的关系）。此外，我刚刚意识到，在输入这​​个界面时，您必须允许在来自不同组的两个元素之间进行组操作，这没有任何意义。那么，实现这种结构的正确方法是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-08T23:14:14.687

考虑第一句中的子句：“某个类的实例表示集合的元素”。其中包含两个与问题相关的名词，“元素”和“集合”。我最初的想法可能会随着我对这个问题的更多了解而改变，应该有两个类，Element 和 Set。我可能会重命名“Set”以避免与 java.util.Set 混淆——如果这是 Group Theory，“Group”将是一个不错的选择。

如果这样做，则可以将元素相关的方法放在 Element 中，将与集合相关的方法放在 Set 中。两者都可以被子类化，并具有正常的覆盖。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-08T23:08:01.783

这里的解决方案——例如它——是从不同的方向看待事物。组应该是与其元素分开的对象，并且组*对象*应该有一个`T operate(T, T)`和一个`T identity()`方法。

换句话说，停止尝试拥有`GroupElement`接口并拥有`Group`接口。

此外，泛型可能会简化问题：`Group<T>`带有 type 的元素`T`。

# c++ - 在 C++ builder 中从 UnicodeString 传输的 AnsiString 和 AnsiString 的区别

> ID：14225516
> 
> 赞同：0
> 
> 时间：2013-01-08T22:58:11.593
> 
> 标签：c++, c++builder, unicode-string, c++builder-xe2, ansistring

我正在使用 C++ Builder XE3，但我遇到了 AnsiString 的一个奇怪问题。

看看下面的代码

```
//Code 1: first time
AnsiString temp1 = "test" ;
funcA(temp1,temp1);

//Code 2: second time    
String uTemp2 = "test";
AnsiString temp2 = uTemp2;
funcA(temp2,temp2); 
```

出乎我的意料，它第一次运行良好，但第二次抛出“格式错误”异常。即使我只是用代码 2 调用了一次 funcA，问题仍然存在。

因为当我在 temp1 或 temp2 中 ShowMessage 时没有区别。我完全不明白为什么两次通话给了我不同的结果。

funcA 来自第三个库，代码有点复杂。所以在我追踪这个库的代码之前，我想我应该知道 Code1 和 Code2 有什么区别。

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-08T23:56:43.040

就`funcA()`目前而言，将 a`char*`或 a`UnicodeString`分配给`AnsiString`. 在这两种情况下，数据的内存表示`AnsiString`是相同的。因此`funcA()`，无论您如何准备`AnsiString`. 但是，如果不知道`funcA()`实际做了什么以及它期望什么输入，就无法诊断这个问题。您将不得不跟踪`funcA()`.

你说`funcA()`来自第三方库。究竟是什么样的图书馆？它是静态链接的 LIB，还是外部 DLL/BPL？它有很大的不同。如果它是外部 DLL/BPL，那么您不能安全地通过`AnsiString`DLL 边界传递非 POD 数据，除非 DLL/BPL 已使用 EXACT SAME 编译器、RTL 和内存管理器作为您的 EXE（在对于 BPL，这也意味着在 BPL 和 EXE 项目中启用运行时包）。如果不是这种情况，那么很可能 DLL/BPL 正在使用不同的 RTL/MM，它对内存中`AnsiString`数据的解释与您的 EXE 不同。内存中的数据`AnsiString`在 CB2009 中更改为包含新字段（即代码页和元素大小），因此如果 DLL/BPL 是在较早的编译器版本中编译的，则当它尝试使用`AnsiString`较新编译器中的）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-08T23:25:19.960

我首先想到的是 String 构造函数中没有 AnsiString，因此无法将 String 类型分配给 AnsiString。您没有提到编译器错误，因此听起来编译器正在为您做一些错误的事情。

这篇文章[如何将字符串转换为 AnsiString](http://forums.codeguru.com/showthread.php?375155-How-to-convert-String-to-AnsiString)提供了一种安全的方法。

基本上，您需要在赋值中引用字符串变量 char buffer，以便编译器做正确的事情。

这是一个[较旧的 Builder AnsiString 参考资料 (1997)](http://bcbjournal.org/articles/vol1/9708/An_AnsiString_class_reference.htm)，它提供了有关一些可能的构造函数和转换的信息。

# java - Java 中的着色图像改进

> ID：14225518
> 
> 赞同：4
> 
> 时间：2013-01-08T22:58:23.497
> 
> 标签：java, image, tint

我寻找一种在 Java 中为图像着色的简单方法，但没有找到适合我需要的东西。我去了以下解决方案：

首先创建一个新图像，作为我要着色的图像的副本，然后创建第二个图像，它是我要着色的图像的透明蒙版，然后在我的副本上绘制着色 - 蒙版并返回副本：

```
public static BufferedImage tintImage(Image original, int r, int g, int b){
    int width = original.getWidth(null);
    int height = original.getHeight(null);
    BufferedImage tinted = new BufferedImage(width, height, BufferedImage.TRANSLUCENT);
    Graphics2D graphics = (Graphics2D) tinted.getGraphics();
    graphics.drawImage(original, 0, 0, width, height, null);
    Color c = new Color(r,g,b,128);
    Color n = new Color(0,0,0,0);
    BufferedImage tint = new BufferedImage(width, height, BufferedImage.TRANSLUCENT);
    for(int i = 0 ; i < width ; i++){
        for(int j = 0 ; j < height ; j++){
            if(tinted.getRGB(i, j) != n.getRGB()){
                tint.setRGB(i, j, c.getRGB());
            }
        }
    }
    graphics.drawImage(tint, 0, 0, null);
    graphics.dispose();
    return tinted;
} 
```

对于没有透明像素的图像（例如，没有使用 alpha 通道）的解决方案是在整个图像上简单地使用 fillRect() ，但这不适用于具有透明像素的图像，因为那些图像具有选择颜色而不是仍然不可见。

有谁知道一种更有效地做到这一点的方法，因为我在这里找到的方法相当不令人满意，我计划在运行时对许多图像进行这种着色（大多数具有灰色调，因此它们很容易着色）大约 50每秒次。

Pre - 在启动时生成所有需要的图像和/或缓存生成的图像可能是一种解决方案，但在某种程度上对我来说感觉很尴尬，尽管如果什么都做不了，那么什么也做不了。

有人链接了这个：[http ://www.javalobby.org/articles/ultimate-image/](http://www.javalobby.org/articles/ultimate-image/)

这很有帮助，但不包括着色。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-08T23:29:24.363

本质上，你需要使用一点黑魔法，手头有一两个牺牲不会有什么坏处……

![在此处输入图像描述](../Images/852b24ff6d8ba80e1ab8b3e797bc3f85.png)

```
public class TestTint {

    public static void main(String[] args) {
        new TestTint();
    }

    public TestTint() {
        EventQueue.invokeLater(new Runnable() {
            @Override
            public void run() {
                try {
                    UIManager.setLookAndFeel(UIManager.getSystemLookAndFeelClassName());
                } catch (Exception ex) {
                }

                JFrame frame = new JFrame("Testing");
                frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
                frame.setLayout(new BorderLayout());
                frame.add(new TestPane());
                frame.pack();
                frame.setLocationRelativeTo(null);
                frame.setVisible(true);
            }
        });
    }

    public static GraphicsConfiguration getGraphicsConfiguration() {
        return GraphicsEnvironment.getLocalGraphicsEnvironment().getDefaultScreenDevice().getDefaultConfiguration();
    }

    public static BufferedImage createCompatibleImage(int width, int height, int transparency) {
        BufferedImage image = getGraphicsConfiguration().createCompatibleImage(width, height, transparency);
        image.coerceData(true);
        return image;
    }

    public static void applyQualityRenderingHints(Graphics2D g2d) {
        g2d.setRenderingHint(RenderingHints.KEY_ALPHA_INTERPOLATION, RenderingHints.VALUE_ALPHA_INTERPOLATION_QUALITY);
        g2d.setRenderingHint(RenderingHints.KEY_ANTIALIASING, RenderingHints.VALUE_ANTIALIAS_ON);
        g2d.setRenderingHint(RenderingHints.KEY_COLOR_RENDERING, RenderingHints.VALUE_COLOR_RENDER_QUALITY);
        g2d.setRenderingHint(RenderingHints.KEY_DITHERING, RenderingHints.VALUE_DITHER_ENABLE);
        g2d.setRenderingHint(RenderingHints.KEY_FRACTIONALMETRICS, RenderingHints.VALUE_FRACTIONALMETRICS_ON);
        g2d.setRenderingHint(RenderingHints.KEY_INTERPOLATION, RenderingHints.VALUE_INTERPOLATION_BILINEAR);
        g2d.setRenderingHint(RenderingHints.KEY_RENDERING, RenderingHints.VALUE_RENDER_QUALITY);
        g2d.setRenderingHint(RenderingHints.KEY_STROKE_CONTROL, RenderingHints.VALUE_STROKE_PURE);
    }

    public static BufferedImage generateMask(BufferedImage imgSource, Color color, float alpha) {
        int imgWidth = imgSource.getWidth();
        int imgHeight = imgSource.getHeight();

        BufferedImage imgMask = createCompatibleImage(imgWidth, imgHeight, Transparency.TRANSLUCENT);
        Graphics2D g2 = imgMask.createGraphics();
        applyQualityRenderingHints(g2);

        g2.drawImage(imgSource, 0, 0, null);
        g2.setComposite(AlphaComposite.getInstance(AlphaComposite.SRC_IN, alpha));
        g2.setColor(color);

        g2.fillRect(0, 0, imgSource.getWidth(), imgSource.getHeight());
        g2.dispose();

        return imgMask;
    }

    public BufferedImage tint(BufferedImage master, BufferedImage tint) {
        int imgWidth = master.getWidth();
        int imgHeight = master.getHeight();

        BufferedImage tinted = createCompatibleImage(imgWidth, imgHeight, Transparency.TRANSLUCENT);
        Graphics2D g2 = tinted.createGraphics();
        applyQualityRenderingHints(g2);
        g2.drawImage(master, 0, 0, null);
        g2.drawImage(tint, 0, 0, null);
        g2.dispose();

        return tinted;
    }

    public class TestPane extends JPanel {

        private BufferedImage master;
        private BufferedImage mask;
        private BufferedImage tinted;

        public TestPane() {
            try {
                master = ImageIO.read(new File("C:/Users/swhitehead/Documents/My Dropbox/MegaTokyo/Miho_Small.png"));
                mask = generateMask(master, Color.RED, 0.5f);
                tinted = tint(master, mask);
            } catch (IOException exp) {
                exp.printStackTrace();
            }
        }

        @Override
        public Dimension getPreferredSize() {
            Dimension size = super.getPreferredSize();
            if (master != null && mask != null) {
                size = new Dimension(master.getWidth() + mask.getWidth() + tinted.getWidth(), Math.max(Math.max(master.getHeight(), mask.getHeight()), tinted.getHeight()));
            }
            return size;
        }

        @Override
        protected void paintComponent(Graphics g) {
            super.paintComponent(g);
            int x = (getWidth() - (master.getWidth() + mask.getWidth() + tinted.getWidth())) / 2;
            int y = (getHeight() - master.getHeight()) / 2;
            g.drawImage(master, x, y, this);

            x += mask.getWidth();
            y = (getHeight() - mask.getHeight()) / 2;
            g.drawImage(mask, x, y, this);

            x += tinted.getWidth();
            y = (getHeight() - tinted.getHeight()) / 2;
            g.drawImage(tinted, x, y, this);
        }

    }

} 
```

这种技术背后的总体思想是生成图像的“蒙版”，我不相信这个想法，我从网上偷了它，如果我能找到哪里，我会发布一个链接。

一旦你有了面具，你就可以一起渲染这两个图像。因为我已经对蒙版应用了 Alpha 级别，所以完成后我不需要重新应用 Alpha 合成。

PS - 我为这个例子创建了一个兼容的图像。我这样做只是因为它会在图形设备上渲染得更快，这不是必需的，它只是我手头的代码；）

# php - 拉取消息线程如何从数据库中列出数据？

> ID：14225521
> 
> 赞同：1
> 
> 时间：2013-01-08T22:58:32.230
> 
> 标签：php, mysql, database

这是我的 MySQL 数据库结构：

`Recipents (id, converstation_id, user_id)`

`Conversations (id, user_start)`

`Messages (id, user_id, message, conversation_id, time)`

我要做的是提取由特定用户发起的所有对话 ID，**或者**他是其中一个对话的接收者。并按最后一条消息排序。

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-09T01:17:53.367

以下查询将起作用。您必须用`REQUESTED_USER_ID`有效的用户 ID 替换。注意连接两个子查询结果的 SQL 中的 UNION 语句。然后将来自 UNION 的结果包装在另一个 SELECT 中以实现按开始时间排序。

```
SELECT
  conversation_id
FROM (
  SELECT 
    c.id AS conversation_id,
    m.time AS start
  FROM Conversations c
  JOIN Messages m ON m.conversation_id = c.id
  WHERE c.user_start = REQUESTED_USER_ID
  UNION
  SELECT
    c.id AS conversation_id,
    m.time AS start
  FROM Conversations c
  JOIN Recipents r ON c.id = r.user_id
  JOIN Messages m ON m.conversation_id = c.id
  WHERE r.user_id = REQUESTED_USER_ID
) result

ORDER BY start DESC; 
```

# c# - 如何控制我的 xml 序列化中的属性顺序？

> ID：14225529
> 
> 赞同：5
> 
> 时间：2013-01-08T22:59:00.660
> 
> 标签：c#, xml, serialization

有没有办法让 System.Xml.Serialization 按特定顺序序列化属性？我正在创建新的 xml 导出，并且属性当前的顺序不同。我知道属性顺序无关紧要，但我必须将此 xml 发送到可能没有这种开明想法的服务器。

# java - 数据结构设计设计

> ID：14225537
> 
> 赞同：1
> 
> 时间：2013-01-08T22:59:41.863
> 
> 标签：java, algorithm, data-structures, frequency

以下是我做过几次的场景..

计算段落中单词的频率。

我创建了一个地图并存储了计数。所以我的地图包含

```
 <Today, 10>
  <the, 123>
  <hello,1>
  <dont, 20> 
```

现在出现了另一种情况，识别计数为 100 或 30 的单词。

我创建列表或地图的地图

```
<10, [today,...]>
   <123,[the,...]> 
```

或 <10, 2> <123,1> 基本上我有两张地图来处理所有的工作.. 这工作正常，任何更新一个，另一个必须更新。

检索和插入时间几乎是 O(1)。但这并不是那么有效的内存。

可以使用哪些其他方法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-08T23:04:20.200

一旦你有了你的（词，频率）对，你可以创建一个数组，按频率排序，然后进行二分搜索。这将减慢对 O(log n) 的访问速度，但如果这是限制的话，您可以使用大约一半的内存。

除此之外，我没有看到比你已经在做的更好的了。

# css - Div id 标签不适用于 tumblr 主题

> ID：14225539
> 
> 赞同：-2
> 
> 时间：2013-01-08T22:59:48.460
> 
> 标签：css, html, tags, tumblr

抱歉，这可能是一个“菜鸟”问题，但它就在这里......我正在将标题修改为我的 tumblr 主题的侧边栏。我创建了一个新类，但意识到我可以创建一个 id，因为我只会将它用于那个实例。我创建了一个新 ID：

```
#bigborder {font-size: 13px; height: 25px; padding: 2px; letter-spacing: 2px; text-transform: uppercase; color: #999; background-color: #222;} 
```

我把它放在旧 div 类标签的位置：

```
<div id="left"><div class="border"><center><a href="/">Page Title</a></center></div> 
```

至

```
<div id="left"><div id="bigborder"><center><a href="/">Untitled</a></center></div> 
```

并且单词恢复为正文的默认值。

以下是页面中的整个 CSS 以供参考：

```
 <style type="text/css">

    iframe#ask_form {height: 150px!important;}

    img, img a {border: none;}

    body {font-family: offside; font-size: 7pt !important; color: #e4e4e4; background-color: #222; background-image:url(''); background-attachment: relative; margin-top:15px;}

    a {color: #fff; text-decoration: none !important; -webkit-transition-duration: .3s; text-transform: uppercase; letter-spacing: 2px;}

    #center {width:500px; background-color: transparent; padding:10px; margin: auto; font-size: 10px; margin-bottom: 20px;}

    #right {top: 30px; left:50%; margin-left:268px; position:fixed; width: 150px; text-transform: lowercase; padding: 5px; background-color: ; -webkit-border-radius:5px;-moz-border-radius:5px 5px 5px 5px; }

    #left {top: 30px; right:50%; margin-right:268px; position:fixed; width: 150px; text-transform: lowercase; padding: 5px; background-color: ; -webkit-border-radius:5px;-moz-border-radius:5px 5px 5px 5px;}

    .desc {padding: 9px; margin-bottom: 7px; font-size: 10px; width: auto;}

    .drop {margin-top: 5px; font-size: 10px;}

    #qtm {margin: 5px; display: inline-block; font-size: 40px; float: left;}

    #qt {margin: 5px; display: inline-block; font-size: 18px; width: 400px;}

    #src {font-size: 10px;}

    .entry {padding: 5px; background-color: #333; margin-top: 0px; margin-bottom: 20px; -webkit-transition-duration: .1s; -webkit-border-radius:5px;-moz-border-radius:5px 5px 5px 5px; overflow: hidden;}

    .entry:hover #perma {display: block;}

    .entry a {-webkit-transition-duration: .3s; color: #999;}

    .entry a:hover {color: #fff; texxt-transform: uppercase !important;}

    blockquote {border-left-width: 1px; border-left-style: dashed; border-opacity:.5; border-left-color: #666; padding:0px; padding-left: 5px; margin: 5px;}

    .search {width: 140px; background-color: #dcdcdc; font-size: 10px; border: none; text-align: center; padding: 5px;}

    .header {color: #fff; padding-bottom: 5px; border-bottom: 1px solid #444; margin-bottom: 5px; font-size: 25px; font-family: offside; -webkit-transition-duration: .3s; letter-spacing: 0px; text-transform: uppercase; text-align: center; }

    h2 {color: #fff; margin-bottom: 5px; font-size:20px;font-family: offside; -webkit-transition-duration: .3s; letter-spacing: 0px; text-transform: none; }

    .title {
    font-family: offside;
    font-size: 40px;
    font-style: normal;
    text-transform:none;
    letter-spacing: 0px;
    -webkit-transition-duration: .3s; 
    }

    #perma {display: none; margin-top: 5px;}

    .perma {text-align: center; background-color:; padding: 1px; font-size: 10px;}

    .perma_info {margin-left: 5px; margin-right: 5px;}

    .caption {margin-top: 5px; padding: 2px; background-color: font-size: 9pt; color: #e4e4e4;}

    .nav1 {font-size: 20px; margin-top: 5px; padding: 5px;}

    .nav2 {font-size: 20px; text-align: right; padding: 5px; margin-top: -34px;}

    .ask {padding: 5px; z-index: 1000000000; font-size: 30px; font-family: offside;}

    .q {background-color: #444; color: #fff; font-size: 12px;}

    .tri {font-size: 12px; margin-top: -5px; margin-bottom: 3px; color: ; z-index: -1000; margin-left: 15px;}

    .audio {width: 490px; text-align: center; background-color: #e4e4e4;}

    .label {font-weight: bold; margin-right: 15px;}

    blockquote p, ul{ margin:0px; padding:0px; }

    ul, ol, li{list-style:none; margin:0px; padding:0px;}

    .pages {margin: 5px 0 5px 0; text-align: center; line-height: 20px;}

    .pages a {padding: 2px 4px 2px 4px; background-color: #444; -webkit-transition-duration: .3s; color: #fff;}

    .pages a:hover {background-color: #222; color: #fff;}

    .touch {text-transform: uppercase; margin-bottom: 5px; padding: 3px; background-color: #0e49ab; text-align: right; -webkit-transition-duration: .3s; color: #fff; font-size: 8px; letter-spacing: 2px;}

    .touch:hover {background-color: #222; color: #fff;}

    .navi {margin-bottom: 5px; padding: 3px; background-color: #ffffff; -webkit-transition-duration: .3s; color: #777777;}

    .navi:hover {background-color: {color:Link Background Hover}; color: {color:Link Font Hover};}

    .border {font-size: 13px; height: 15px; padding: 2px; letter-spacing: 2px; text-transform: uppercase; color: #999; background-color: #222; margin-bottom: 13px; border: #333 1px solid; -webkit-border-top-left-radius:5px;-webkit-border-top-right-radius:5px;-moz-border-radius:5px 5px 0px 0px;}

    .border a {color: #999; -webkit-transition-duration: .3s; width: 500px; }
    .border a:hover (color: #fff;)

    #bigborder {font-size: 13px; height: 25px; padding: 2px; letter-spacing: 2px; text-transform: uppercase; color: #999; background-color: #222;}

    </style> 
```

所以我的问题是，我将如何更改边框大小，因为它不适用于我创建的 div id。引用的任何错误？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-08T23:02:06.183

在这一行上似乎只有一个结束`<div>`标签。

```
<div id="left">
  <div id="bigborder">
    <center><a href="/">Untitled</a></center>
  </div> 
```

应该有一个结束`</div>`标签`<div id="left">`吗？

**编辑**

我注意到您的原始课程`.border`设置了边框样式，但您的新 ID`#bigborder`没有设置？

# php - 将 CGI 命令行参数传递给 PHP 文件

> ID：14225543
> 
> 赞同：2
> 
> 时间：2013-01-08T23:00:14.040
> 
> 标签：php, parameters, cgi

一家公司正在向我的网站发送信息，他们希望将其发送到 CGI 文件，如下所示：

`mysite.com/cgi-bin/process.cgi?custid=ab123&amount=12345`

我必须将参数数据写入 MySql 数据库，我宁愿使用 PHP（因为我不知道 cgi）。如何将 url 参数传递给我的 php 脚本？另外，如果我重定向到一个 php 文件，发件人会知道我正在这样做吗？我不能只从 cgi 脚本“调用”php 文件吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-08T23:29:03.263

要将 PHP 脚本作为 CGI 运行，您需要了解这些

1.  由于 CGI PHP 不会作为 apache 处理程序运行，而是作为进程运行。
2.  PHP 不会填充`$_GET`或`$_POST`,
3.  你的 php 文件应该是可执行的`chmod +x`
4.  shebang 线应该是`#!/usr/bin/env php`或`#!/usr/bin/php`
5.  GET 数据应该从 QUERY_STRING 和 POST 中读取，PUT 应该从 STDIN 中读取。
6.  HTTP 标头应**手动**发送。

所以你的`process.cgi`会看起来像这样，

```
#!/usr/bin/env php-cli
<?php
// populating $_GET
$_GET=parse_str(getenv('QUERY_STRING'));
$custid=$_GET['custid'];
$amount = $_GET['amount'];
// do work

echo "Content-type: text/html\r\n";
echo "Connection: Close\r\n\r\n";
// start output here.
?> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2017-04-30T17:05:00.687

[在 PHP 7.2.0 ( http://php.net/manual/en/function.parse-str.php](http://php.net/manual/en/function.parse-str.php) )中不推荐使用`parse_str`不带第二个参数来存储解析结果。该函数现在不返回值。您可以从 中提取查询字符串，因此调用变为，如下所示：`$_SERVER['QUERY_STRING']``parse_str``parse_str($_SERVER['QUERY_STRING'], $destination)`

```
<?php
$DEBUG = true;
if ($DEBUG) echo "<p>PHP: good to go</p>";
if ($DEBUG) echo $_SERVER['QUERY_STRING'];
parse_str($_SERVER['QUERY_STRING'], $_GET);
if (empty($_GET)) {
    if ($DEBUG) echo "<p>Not picking up the GET.</p>";
    exit;
}
if ($DEBUG) echo "<p>Got a GET.</p>";
if ($DEBUG) print_r($_GET);
?> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-08T23:18:37.803

您可以编写一个普通的 PHP 脚本来处理它们传递的数据（使用`$_GET`变量），并设置一个 .htaccess 重定向来掩盖它不是由实际的 CGI 脚本处理的事实。

只需将其放在站点根目录中的 .htaccess 文件中，以及 PHP 脚本（在本例中称为“process.php”）。

```
RewriteRule ^cgi-bin/process.cgi$ process.php [L] 
```

您可以通过 CGI 脚本运行 PHP 脚本，但这只会增加复杂性。把事情简单化。

# c++ - 什么决定了列出文件的顺序？

> ID：14225544
> 
> 赞同：0
> 
> 时间：2013-01-08T23:00:18.113
> 
> 标签：c++, file-io

以下代码示例允许您了解目录中的所有文件。

```
DIR *pDIR;
struct dirent *entry;

if( (pDIR = opendir(path)) != NULL )
{
    while( (entry = readdir(pDIR)) != NULL )
    {
    if( strcmp(entry->d_name, ".") != 0 && strcmp(entry->d_name, "..") != 0 )
    {
            string path_to_file(path);
            path_to_file.append("/");
            path_to_file.append(entry->d_name);

            cout << path_to_file << endl;
        }
    }
} 
```

这些文件没有按字母顺序列出：是什么决定了它们的列出顺序？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-08T23:11:24.233

正如詹姆斯所说，没有指定顺序。完全取决于文件系统以它喜欢的任何顺序对文件进行排序。在 Windows NTFS（和 OS/2 的 HPFS）中，文件确实按字母顺序排序（以二叉树的形式，便于按名称搜索文件）。在“DOS”FAT 文件系统中，文件按照它们创建的顺序排列，如果一个文件被删除，该“槽”将用于下一个创建的文件。在 Linux 操作系统中 ext{2,3,4} 是最常用的，我相信它与 FAT 类似，但确切的结构并不相同。

还有几十个其他文件系统（对于 Linux，至少有六个，几乎每个我没有提到名字的操作系统都有自己的变体），它们都有自己的做事方式。如果您想可靠地以任何特定顺序对文件进行排序，则必须对它们进行排序。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-08T23:04:16.260

真的没什么。它们按照在目录中的顺序列出。未指定；在实践中，它取决于目录中发生的事情的整个历史。

# c++ - 使用 {0} 的数组初始化失败，某些编译器中的第一个元素除外

> ID：14225545
> 
> 赞同：4
> 
> 时间：2013-01-08T23:00:26.403
> 
> 标签：c++, c

> **可能重复：**
> [C 和 C++：自动结构的部分初始化](https://stackoverflow.com/questions/10828294/c-and-c-partial-initialization-of-automatic-structure)

很长一段时间我一直在使用

```
char array[100] = {0}; 
```

将数组的所有元素初始化为 0。但是，我最近偶然发现了一个编译器（德州仪器公司的 Code Composer Studio），它不起作用。该语句具有仅将第一个元素初始化为 0 的效果。

这种行为可能是 C 与 C++ 的差异、编译器的差异，还是实现中的错误？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-01-08T23:01:16.687

这只是一个错误。在 C 和 C++ 中，`array`都应该用零填充。

* * *

由于这是一个小答案，所以不妨过分：

C++11 §8.5.1/7：

> 如果列表中的初始化子句少于聚合中的成员，则每个未显式初始化的成员都应从空的初始化器列表（8.5.4）中初始化。[示例：用、用和用 形式的表达式的值进行
> `struct S { int a; const char* b; int c; };`
> `S ss = { 1, "asdf" };`
> 初始化，即. —结束示例]`ss.a``1``ss.b``"asdf"``ss.c``int()``0`

C99 §6.7.8/21（对不起，没有 C11 副手）：

> 如果大括号括起来的列表中的初始值设定项少于聚合的元素或成员，或者用于初始化已知大小数组的字符串文字中的字符少于数组中的元素，则聚合的其余部分应隐式初始化与具有静态存储持续时间的对象相同。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-01-08T23:04:18.067

在 C 中，没有部分初始化（参见[C11 标准](http://www.open-std.org/JTC1/sc22/wg14/www/docs/n1570.pdf)中的 6.7.9/19 ）。一个对象要么完全初始化（它的所有字节），要么完全未初始化。

您的编译器不符合 C 标准。

> 初始化应按初始化程序列表顺序进行，为特定子对象提供的每个初始化程序都覆盖同一子对象的任何先前列出的初始化程序；所有未显式初始化的子对象都应隐式初始化，与具有静态存储持续时间的对象相同。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2013-01-08T23:04:24.860

检查您的编译器文档。需要一个符合标准的 C 或 C++ 编译器来初始化所有元素，`0`但一些编译器，特别是在嵌入式世界中，具有非 ISO 选项（有时默认设置！）出于性能原因调整实现。

专门为您的编译器检查您是否处于*COFF ABI 模式*：

> **6.13 COFF ABI 模式下初始化静态变量和全局变量**
> 
> ANSI/ISO C 标准规定，没有显式初始化的全局（外部）和静态变量必须在程序开始运行之前初始化为 0。此任务通常在加载程序时完成。因为加载过程在很大程度上依赖于目标应用系统的特定环境，所以在 COFF ABI 模式下，编译器本身没有规定在运行时初始化为 0 否则未初始化的静态存储类变量。满足此要求取决于您的应用程序。
> 
> 初始化全局对象
> 
> 注意：您应该显式初始化您期望编译器默认设置为零的所有全局对象。在 C6000 EABI 模式下，未初始化的变量自动初始化为零

来自《TMS320C6000 优化编译器 v7.4 用户指南》

[http://www.ti.com/lit/ug/spru187u/spru187u.pdf](http://www.ti.com/lit/ug/spru187u/spru187u.pdf)

# git - Git 存储库名称是否区分大小写？

> ID：14225547
> 
> 赞同：10
> 
> 时间：2013-01-08T23:00:39.230
> 
> 标签：git, github

我意识到更改 Git 存储库的名称并非易事，并且我阅读了[这个问题](https://stackoverflow.com/questions/5751585/change-repo-name-in-github)的答案，其中描述了在一般情况下如何更改存储库名称（我也在使用 GitHub）。

但是，我只会更改存储库名称的*大小写*，例如`Abc`更改为`abc`. 因此，我可以简单地在 GitHub 上我的存储库的设置页面中更改名称并进行设置吗？还是我仍然需要按照上一个链接中概述的步骤进行操作？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-08T23:38:57.893

After experimenting a bit, I found that you *cannot* simply change the repository name in the settings page. The steps from the link in the body of the question must still be followed. Although in my case it was as simple as:

```
git remote set-url origin https://github.com/username/newreponame.git 
```

# algorithm - 拆分点集，算法

> ID：14225553
> 
> 赞同：5
> 
> 时间：2013-01-08T23:00:57.377
> 
> 标签：algorithm

我正在为考试而学习，但我无法解决这个问题：

> 我们得到一组**n < 1000 个**点和一个整数**d**。任务是创建两组不相交的点**A_1**和**A_2**（给定**n**个点的集合），使得每对点与**A_i**（对于 i = 1 或 2）之间的距离（欧几里得）小于或等于**d**。如果不可能，请打印**-1**。
> 
> 例如，输入：
> 
> d = 3，并且点：
> 
> (5,3), (1,1), (4,2), (1,3), (5,2), (2,3), (5,1)
> 
> 我们可以创建：
> 
> A_1 = { (2,3), (1,3), (1,1) }
> 
> A_2 = { (5,3), (4,2), (5,2), (5,1) }
> 
> 因为来自 A_i 的每一对点（对于 i = 1 或 2）都足够接近。

我真的很想知道如何解决它，但不知道。由于n很小，算法甚至可以是O(n^2 log n)，但我不知道如何开始。我在想可能从计算每对点之间的距离开始，然后取两个最大距离的点并将它们放入不同的集合中（如果它们的距离大于 d）。然后对其余的对重复此步骤，但问题是如何决定我可以合法地将下一个点放在哪里。任何人都可以帮助这个算法吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-09T00:28:02.640

让我们考虑一个具有**n 个**节点（对应于**n**个点）的简单图。如果两个对应点之间的距离大于**d** ，则连接两个节点。

如果可以创建两个不相交的集合，我们必须有一个二分图（如果一些节点不连接到其他节点，它们可以放在任何集合中）。

因此，我们只需要测试图的二分性，这很简单：

[http://en.wikipedia.org/wiki/Bipartite_graph#Testing_bipartiteness](http://en.wikipedia.org/wiki/Bipartite_graph#Testing_bipartiteness)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-08T23:36:36.100

从距离矩阵开始似乎是个好主意。然后在这个距离矩阵中选择每个大于 d 的条目。此条目意味着相应的点必须位于不同的集合中。

从两个空集开始并迭代所有相关条目（> d）。

如果集合为空，则将两个点放入其中。否则有三种选择：

1.  如果清楚点属于哪个集合，则将它们放入其中（即插入点保留最大距离标准，可以从距离矩阵中获得）。
2.  如果这些点无法插入其中一组，则问题无法解决。
3.  如果两个点都可能有两个集合，那么我们就有问题了。我建议开始一对新的点集并将点放入其中。然后，如果随后的点对再次不清楚，请检查第二组对。如果还不清楚，请检查第三组对，依此类推。如果点对插入到先前的集合中，请检查以下集合，如果点现在已清除。最后，您有一个点对列表，可以根据需要合并。

* * *

我刚刚想到了第二种方法，这种方法类似，但应该更快一些。

我们也从距离矩阵开始。

除了这两组之外，我们还维护一个堆栈、队列或任何新添加的条目。

因此，如果我们从距离矩阵中选择第一个相关条目，则这些点将添加到两个队列中。只要其中一个队列中有条目，请执行以下操作：

从队列中删除该点并将其插入到集合中。如果插入违反了最大距离标准，则问题无法解决。检查该点的距离矩阵中的行或列，并提取该行/列中的每个相关条目。将伙伴点添加到另一组的队列中（因为这必须在不同的组中）。

如果两个队列都是空的，则将下一个尚未访问的相关条目添加到队列中并重新开始。

该算法的优点是这些点按照它们可以相互影响的顺序进行处理。因此，不需要多于一对的集合。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-08T23:41:27.003

想象一个数组，所有点都在顶部，所有点都在侧面。

如果定义单元格的两个点（左侧和顶部）相距大于 d，则在任何单元格中用零填充数组，如果两个点相距小于 d，则填充一个零。

```
 (5,3), (1,1), (4,2), (1,3), (5,2), (2,3), (5,1)
(5,3),          0      1      0      1      1      1
(1,1),   0             0      1      0      1      0
(4,2),   1      0             0      1      1      1
(1,3),   0      1      0             0      1      0
(5,2),   1      0      1      0             0      1
(2,3),   1      1      1      1      0             0
(5,1)    1      0      1      0      1      0 
```

（注意：您必须用翻转的相同 0 和 1 填充每个三角形。）

忽略对角线。注意右上角的三角形部分。

跳过第 0 列。

从第一列开始，如果顶行没有 1，则将其与右侧的另一列交换，该列在顶行有 1。然后也交换相同的行以保持对角线空白。（如果没有，则没有解决方案。） [示例：交换第 2 列和第 3 列以及第 2 和第 3 行] 请注意，该行的选择可能会成为优化因素。

移动到下一列，如果顶行没有 1，则与右侧的列交换并交换相应的行。如果没有，请尝试将其与下面的行交换，该行在该列中有 1 并执行相应的列。如果低于对角线，则应忽略其下方的行。

我们在三角形的左上角收集点，其中包含 1。这些点都可以放在其中一个集合中。

这就是我在脑海中迷失的地方，但是您必须从三角形的右下角开始执行类似的过程，并收集将在另一个集合中的点。交换行和对应的列以在三角形的右下角收集 1。

一旦你交换了足够多的行，你就可以在右上角形成一个矩形——一个没有左下角切掉的真正矩形——并且那个矩形包含所有的 0，你就有了一个解决方案。如果你不能这样做，就没有解决办法。

将三角形中的最低行与 1 进行比较，将三角形中最右侧的列与 1 进行比较，以及它们相遇的单元格。该单元格必须在三角形中才能存在解决方案。

（我给你留下了一个很大的“待办事项”来找到如何交错行和列的交换以清除三角形左上角和右下角的 0。也许这里的讨论可以解决如何制作它工作。或者发现它不起作用。）

# android - android & 使用 Robotium 进行测试，如何在片段中选择 listView 的元素？

> ID：14225555
> 
> 赞同：0
> 
> 时间：2013-01-08T23:00:57.863
> 
> 标签：android, listview, testing, fragment, robotium

在使用 Robotium 进行测试时，如何在片段中选择 listView 的元素？我在布局中有 2 个片段容器：

```
>     <LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
>      ... 
>         <FrameLayout
>             xmlns:android="http://schemas.android.com/apk/res/android"
>             android:id="@+id/fragment_container_left"
>         ... />
>         <FrameLayout
>             xmlns:android="http://schemas.android.com/apk/res/android"
>             android:id="@+id/fragment_container_rigth"
>          .../>
>     /> 
```

并且每个片段都使用以下代码加载：

```
> <ListView
>     android:id="@+id/listView1" 
>  ... /> 
```

我的测试如下：

```
@Override
protected void setUp() throws Exception {
    super.setUp();
    mActivity = getActivity();
    mIns = this.getInstrumentation();
    solo = new Solo(mIns, mActivity);
}
public void testBackButton() {

      // click in listView
      solo.clickInList(0);
      solo.clickInList(0);               
 ... } 
```

问题是solo.clickInList(0)，总是点击属于右边的片段的Lis​​tView元素。如何“solo.clickInList()”单击[此处图像](http://i.stack.imgur.com/LMOPn.png)左侧的列表？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-08T23:49:09.160

有一个`solo.clickInList(0, integer);`可以让您指定要单击的列表。你试过吗？您也可以单击特定文本。

# java - 从 Java 应用程序实例化 PApplet

> ID：14225559
> 
> 赞同：1
> 
> 时间：2013-01-08T23:01:35.863
> 
> 标签：java, applet, processing, japplet

我正在编写一个 java 应用程序，我想通过包含处理库来嵌入处理草图。我已经编写了处理草图，但现在我想让它成为我更大程序的一部分。有没有一种方法可以通过“常规”java 应用程序`public static void main`来实例化 PApplet 并让其从应用程序访问数据。

当程序实例化 JApplet 时，会显示窗口（在`setup`方法中设置了正确的大小，但我想使用展开库绘制的地图不会呈现）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-08T23:21:03.293

我假设它是：

```
PApplet embed = new Embedded();
// important to call this whenever embedding a PApplet.
// It ensures that the animation thread is started and
// that other internal variables are properly set.
embed.init(); 
```

# .net - linq to sql 底层：为什么我不能使用 linq to sql 查询小于 48 小时的日期/时间范围？

> ID：14225560
> 
> 赞同：0
> 
> 时间：2013-01-08T23:01:40.467
> 
> 标签：.net, vb.net, linq

我不明白 linq-to-sql 错误似乎涉及 linq to sql 如何“在后台”工作。

我有一个 linq to sql 查询来查找日期范围内的值。查询的所有字段在基础数据库中都没有空值。如果开始日期和结束日期相隔不到 48 小时，则查询返回错误，可为*空的对象必须有一个值*。

```
Dim startDate As Date = New Date(2013, 1, 5, 0, 0, 1)
Dim endDate As Date = New Date(2013, 1, 6, 23, 59, 59) //date interval less than 48 hours
Dim count As Integer = (From l In myDB.myTable Where l.LabName = labToCheck And l.SuccessfulImport = True And l.DateProcessed > startDate And l.DateProcessed < endDate Select l.Epi).Sum //Nullable object must have a value. 
```

另一方面，当日期相隔超过 48 小时时（在下面的示例中，第二行不同），它不会抛出错误：

```
Dim startDate As Date = New Date(2013, 1, 5, 0, 0, 1)
Dim endDate As Date = New Date(2013, 1, 7, 23, 59, 59) //date interval more than 48 hours
Dim count As Integer = (From l In myDB.myTable Where l.LabName = labToCheck And l.SuccessfulImport = True And l.DateProcessed > startDate And l.DateProcessed < endDate Select l.Epi).Sum 
```

这是怎么回事？LINQ to SQL 是否忽略时间值？无论关联的时间值如何，2013 年 1 月 5 日数据库中的所有日期时间是否均等？这是我对这个错误的解释，因为如果 linq to sql 忽略时间值，则不会有大于 1/5/13 和小于 1/6/13 的可能值，因此生成消息：可为空的对象必须有错误.

这是怎么回事？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-09T18:00:50.930

问题是，如果你没有整数值，那么这个总和就不起作用。sum 可以毫无问题地用于整数数组，或者如果您传入一个匿名函数来解析应该是整数的属性。

此外，对结果求和是没有意义的。

.sum 用于对数组中的所有整数求和，而 count 仅计算数组中的所有项目。

# android - 获得正确的布局权重

> ID：14225562
> 
> 赞同：0
> 
> 时间：2013-01-08T23:02:00.010
> 
> 标签：android

需要有关布局 xml 的帮助。当我在我的代码中测试以下 xml 布局的以下尺寸时，文本视图的高度（通过使用 textview.getHeight）与屏幕高度（通过 DisplayMetrics.getMetrics()），它为 78.9%，这意味着文本视图的高度是屏幕高度的 78.9%。我期望这应该是 90%，因为我已经为我的两个相对布局分配了权重 1 和 9，它们分别具有 textview 和其他组件（按钮）。任何人都可以请帮忙。我的目标是让 textview 占屏幕高度的 10%。

```
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
xmlns:tools="http://schemas.android.com/tools"
android:layout_width="match_parent"
android:layout_height="match_parent"
android:orientation="vertical"
tools:context=".Story1Activity" >

<RelativeLayout
    android:layout_weight="1"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent">
    <TextView
        android:id="@+id/textViewStory1"
        android:layout_width="fill_parent"
        android:layout_height="fill_parent"
        android:lineSpacingMultiplier="1.2" />
</RelativeLayout>

<RelativeLayout
    android:layout_weight="9"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent">

    <Button
        android:id="@+id/buttonPrevious"
        style="?android:attr/buttonStyleSmall"
        android:layout_width="wrap_content"
        android:layout_height="fill_parent"
        android:layout_alignParentLeft="true"
        android:background="@android:drawable/btn_default"
        android:text="@string/stringButtonPrevious"
        android:onClick="loadPrevious" />

    <Button
        android:id="@+id/buttonNext"
        style="?android:attr/buttonStyleSmall"
        android:layout_width="wrap_content"
        android:layout_height="fill_parent"
        android:layout_alignParentRight="true"
        android:background="@android:drawable/btn_default"
        android:text="@string/stringButtonNext" 
        android:onClick="loadNext"/> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-08T23:07:33.233

将每个的高度设置`RelativeLayout`为零，“备用”空间（全部为 100%）将根据权重分配。如果您从非零尺寸开始，则权重仅用于在为其分配正常尺寸后调整小部件尺寸。

# r - 从数据框中写入 gzip 文件

> ID：14225566
> 
> 赞同：13
> 
> 时间：2013-01-08T23:02:05.203
> 
> 标签：r, zip, compression, gzip, vowpalwabbit

我正在尝试将数据框写入 gzip 文件但遇到问题。

这是我的代码示例：

```
df1 <- data.frame(id = seq(1,10,1), var1 = runif(10), var2 = runif(10))

gz1 <- gzfile("df1.gz","w" )
writeLines(df1) 
```

> 错误`writeLines(df1)`：无效的“文本”参数

有什么建议么？

编辑：我正在尝试编写的字符向量的示例行是：

```
0 | var1:1.5 var2:.55 var7:1250 
```

类标签 / y 变量由“|”与 x-var 分隔，变量名称与值由“:”和变量之间的空格分隔。

EDIT2：我为问题的措辞/格式道歉，但结果如下：旧方法：

```
system.time(write(out1, file="out1.txt"))
#    user  system elapsed 
#   9.772  17.205  86.860 
```

新方法：

```
writeGzFile <- function(){
  gz1 = gzfile("df1.gz","w");
  write(out1, gz1);
  close(gz1) 
}

system.time( writeGzFile())
#    user  system elapsed 
#   2.312   0.000   2.478 
```

非常感谢大家帮我解决这个问题。

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2013-01-08T23:09:46.950

`writeLines`需要一个字符串列表。将其写入 gzip 文件的最简单方法是

```
df1 <- data.frame(id = seq(1,10,1), var1 = runif(10), var2 = runif(10))
gz1 <- gzfile("df1.gz", "w")
write.csv(df1, gz1)
close(gz1) 
```

这会将其写为压缩的 csv。另请参阅`write.table`和`write.csv2`了解写出文件的替代方法。

编辑：基于对所需格式的帖子的更新，我制作了以下助手（快速组合在一起，可能承认大量简化）：

```
function(df) {
    rowCount <- nrow(df)
    dfNames <- names(df)
    dfNamesIndex <- length(dfNames)
    sapply(1:rowCount, function(rowIndex) {
        paste(rowIndex, '|', 
            paste(sapply(1:dfNamesIndex, function(element) {
                c(dfNames[element], ':', df[rowIndex, element])
            }), collapse=' ')
        )
    })
} 
```

所以输出看起来像

```
a <- data.frame(x=1:10,y=rnorm(10))
writeLines(myser(a))
# 1 | x : 1 y : -0.231340933021948
# 2 | x : 2 y : 0.896777389870928
# 3 | x : 3 y : -0.434875004781075
# 4 | x : 4 y : -0.0269824962632977
# 5 | x : 5 y : 0.67654540494899
# 6 | x : 6 y : -1.96965253674725
# 7 | x : 7 y : 0.0863177759402661
# 8 | x : 8 y : -0.130116466571162
# 9 | x : 9 y : 0.418337557610229
# 10 | x : 10 y : -1.22890714891874 
```

所需要做的就是将 gzfile 传递给 writeLines 以获得所需的输出。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-01-08T23:10:40.793

要将某些内容写入 gzip 文件，您需要将其“序列化”为文本。对于 R 对象，您可以使用以下方法进行尝试`dput`：

```
gz1 = gzfile("df1.gz","w")
dput(df1, gz1)
close(gz1) 
```

但是，您刚刚将数据框的文本表示形式写入文件。这很可能比使用`save(df1,file="df1.RData")`将其保存到本机 R 数据文件效率低。问问自己：我为什么要将它保存为 .gz 文件？

在使用一些随机数的快速测试中，gz 文件为 54k，.RData 文件为 34k

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2017-01-03T16:59:04.220

Another very simple way to do it is:

```
# We create the .csv file
write.csv(df1, "df1.csv")

# We compress it deleting the .csv
system("gzip df1.csv") 
```

Got the idea from: [http://blog.revolutionanalytics.com/2009/12/r-tip-save-time-and-space-by-compressing-data-files.html](http://blog.revolutionanalytics.com/2009/12/r-tip-save-time-and-space-by-compressing-data-files.html)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2018-05-23T02:31:25.087

您可以在 R.utils 中使用 gzip 函数：

```
library(R.utils)
library(data.table)

#Write gzip file
df <- data.table(var1='Compress me',var2=', please!')
fwrite(df,'filename.csv',sep=',')
gzip('filename.csv',destname='filename.csv.gz')`

#Read gzip file
fread('gzip -dc filename.csv.gz')
          var1      var2
1: Compress me , please! 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2020-09-22T14:08:43.337

对于 tidyverse 方法，将压缩扩展名添加到文件名将执行压缩。来自 [https://readr.tidyverse.org/reference/write_delim.html](https://readr.tidyverse.org/reference/write_delim.html)

> 如果给出了适当的扩展名，write_*() 函数将自动压缩输出。目前支持三个扩展名，.gz 用于 gzip 压缩，.bz2 用于 bzip2 压缩和 .xz 用于 lzma 压缩。

```
library(tidyverse)
df <- data.table(var1='Compress me',var2=', please!')
write_csv(df, "filename.csv.gz") 
```

# c# - 使用代理的 XML 反序列化

> ID：14225568
> 
> 赞同：0
> 
> 时间：2013-01-08T23:02:39.850
> 
> 标签：c#, xml, nhibernate, deserialization, ilist

我有一个关于XML 类的**反序列化的问题。**我需要为 IList 使用代理，因为 XML 不会在接口上序列化/反序列化。我需要使用这个代理，因为 NHibernate 不接受列表，只接受接口。我的问题仅在反序列化时。**序列化工作正常。**

```
public class EmailCategory
    {
        [XmlAttribute("Id")]
        public virtual long Id { get; set; }
        [XmlAttribute("Name")]
        public virtual string Name { get; set; }
        protected internal virtual IList<EmailBranch> EmailBranches { get; set; }

        [XmlArray("EmailBranches")]
        [XmlArrayItem("EmailBranch", typeof(EmailBranch)]
        public List<EmailBranch> EmailBranchesProxy {
            get { return EmailBranches != null ? EmailBranches .ToList() : null; }
            set { EmailBranches = value; }
        }
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-09T00:15:26.507

A DTO object is probably the cleanest. There's a whole range of issues that could crop up when you try to serialize database objects. However, if you still intend to serialize the object, here's a possible solution:

public class EmailCategory { [XmlAttribute("Id")] public virtual long Id { get; set; } [XmlAttribute("Name")] public virtual string Name { get; set; } protected internal virtual IList EmailBranches { get; set; } //private List _test = new List();

```
//[XmlArray("EmailBranches")]
//[XmlArrayItem("EmailBranch", typeof(EmailBranch))]
//public virtual List<EmailBranch> EmailBranchesProxy {
//    get { return EmailBranches != null ? EmailBranches.ToList() : null; }
//    set { EmailBranches = value; }
//}

[XmlArray("EmailBranches")]
[XmlArrayItem("EmailBranch", typeof(EmailBranch))]
public virtual List<EmailBranch> EmailBranchesProxy
{
    get 
    {
        var proxy = EmailBranches as List<EmailBranch>;
        if (proxy == null && EmailBranches != null)
        {
            proxy = EmailBranches.ToList();
        }

        return proxy;
    }
    set { EmailBranches = value; }
}

public EmailCategory()
{
    EmailBranches = new List<EmailBranch>();
} 
```

}

The problem you're having is in this line: `get { return EmailBranches != null ? EmailBranches .ToList() : null; }`. The deserialization process uses the `get` method and then adds items to the collection. Since you're returning null or a new List object, this does not represent the original `EmailBranches` collection, hence the serializer correctly deserializes a new `EmailBranch` object, but addes it to the wrong collection.

The fix, as above, is to initialize the `EmailBranches` collection inside the constructor (hence it won't be null ... which is probably a good idea anyway) and then type checking in the proxy property appropriately.

# javascript - JQuery如果下一个元素是最后一个元素隐藏另一个元素

> ID：14225569
> 
> 赞同：2
> 
> 时间：2013-01-08T23:02:43.410
> 
> 标签：javascript, jquery

继续点击此处的向下按钮：http: [//thomasgrist.tumblr.com/](http://thomasgrist.tumblr.com/)直到到达终点。向下箭头应尽快消失。有什么想法可以通过以下代码实现吗？

我是一个菜鸟，但我*认为*我需要在我的 else 语句中纠正一个条件并说 if index = something do this 但我不知道索引应该是什么或如何写这个。

```
$('#next').click(function (event) {
  event.preventDefault();
  var $current = $('#listOfWork > .current');
  if ($current.index() != $('#listOfWork > div').length - 1) {
    $("#next").css("display", "inline");
    $("#prev").css("display", "inline");
    $current.removeClass('current').next().addClass('current');
    scrollTo($current.next());

  } else {
    $("#next").css("display", "none");
  }

});

$('#prev').click(function (event) {
  event.preventDefault();
  var $current = $('#listOfWork > .current');
  if (!$current.index() == 0) {
    $("#next").css("display", "inline");
    $("#prev").css("display", "inline");
    $current.removeClass('current').prev().addClass('current');
    scrollTo($current.prev());
  } else {
    $("#prev").css("display", "none");
  }
}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-08T23:06:25.150

我认为您需要将其添加到条件中：

```
if($current.next().is(':last')) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-12T23:06:17.100

我想出了如何做到这一点。这是代码。如果下一个 div 索引值*等于*div的数量减 2，则不显示下一个按钮。为了在没有更多以前的 div 时隐藏上一个按钮，我们编写了当前索引等于 1 的条件。

```
(function() {
var scrollTo = function(element) {
$('html, body').animate({
scrollTop: element.offset().top - headerHeight + 40}, 500);}

$('#next').click(function(event) {
event.preventDefault();
var $current = $('#listOfWork > .current');
if  ($current.index() == $('#listOfWork > div').length - 2) {
//alert('Current index is ' + !$current.index() + '.');
$("#next").css("display", "none");
$("#prev").css("display", "inline");
$current.removeClass('current').next().addClass('current');
scrollTo($current.next());

} else if ($current.index() != $('#listOfWork > div').length - 1) {
//alert('Current index is ' + !$current.index() + '.');
$("#next").css("display", "inline");
$("#prev").css("display", "inline");
$current.removeClass('current').next().addClass('current');
scrollTo($current.next());
}    

});

$('#prev').click(function(event) {
event.preventDefault();
var $current = $('#listOfWork > .current');
if ($current.index() == 1) {
$("#prev").css("display", "none");
$("#next").css("display", "inline");
$current.removeClass('current').prev().addClass('current');
scrollTo($current.prev());

} else {
//alert('Current index is ' + !$current.index() + '.');
$("#next").css("display", "inline");
$("#prev").css("display", "inline");
$current.removeClass('current').prev().addClass('current');
scrollTo($current.prev());
}    
});
})
(); 
```

# ruby-on-rails - rails (2.3.11) 服务器问题（生产端）

> ID：14225574
> 
> 赞同：1
> 
> 时间：2013-01-08T23:03:10.230
> 
> 标签：ruby-on-rails, ajax, xmlhttprequest

我遇到了一个非常不寻常的问题。我正在尝试从服务器调用 Web 服务请求（实际上是来自客户端的 ajax 2 步请求），为此我得到了一个 xml 格式的响应，我正在使用树视图对其进行解析。问题是..它在本地服务器上的开发模式下运行良好，但在使用相同代码的生产中显示错误。当我发起一个请求时，我得到一个字符串格式的第一步响应，但显示错误“加载 xmlDoc：xmlDoc 未定义”对于第二个请求，该请求应该在第一个响应之后直接启动。

代码可在此处获得： [https ://github.com/domthu/microaquadt/blob/master/app/views/oligo_sequences/edit.html.erb](https://github.com/domthu/microaquadt/blob/master/app/views/oligo_sequences/edit.html.erb)

错误是从第 195 行开始的函数的某处。

任何帮助或建议将不胜感激......！！！！

# mongodb - 无法使用 shell 连接到 heroku 的 mongohq

> ID：14225576
> 
> 赞同：2
> 
> 时间：2013-01-08T23:03:23.380
> 
> 标签：mongodb, heroku, mongohq

我安装`mongohq:sandbox`在 Heroku。当我想连接到 mongo 时，会出现错误：

```
mongo linus.mongohq.com:10123/app10575123 -u my_user -p pwd123
MongoDB shell version: 2.2.2
connecting to: linus.mongohq.com:10123/app10575123
> show dbs
Wed Jan  9 06:00:50 uncaught exception: listDatabases failed:{ "errmsg" : "need to login", "ok" : 0 } 
```

登录名和密码正确。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-08T23:12:09.010

您已连接到数据库，但对于 MongoHQ 的共享数据库计划（尤其是沙盒计划），出于安全原因，它们不包括对 Mongo 实例的管理员级访问权限......仅访问您的实际数据库。

“show dbs”是一个管理员级别的命令，在这种情况下，将显示该沙盒 MongoDB 进程上的其他数据库。

相反，您将需要使用以下命令：

*   显示收藏
*   db.[collection_name].findOne()
*   db.stats()
*   db.[collection_name].stats()
*   db.[collection_name].ensureIndex({foo:1, bar:1}, {background:true})

... 等等。

我希望这有帮助！

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-08T23:12:31.740

您应该可以`show collections`，但`show dbs`需要管理员权限。

# arm - 0x12345678 的特定大端小端表示？

> ID：14225578
> 
> 赞同：-2
> 
> 时间：2013-01-08T23:03:40.893
> 
> 标签：arm

**mem32[&100]=&12345678 如果使用大端寻址，那么 mem8[&101] 是什么？**

我得到的答案是 56，这是我的推理；

据我了解；在大端系统中，最高有效字节首先存储在内存中，即：

```
0x100 0x101 0x102 0x103
78    56    34    12 
```

但“正确”的答案是 34。

有人可以解释为什么吗？/告诉我答案是错误的吗？

编辑：我意识到我的错误。有一瞬间我忘记了左端的数字是最重要的！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-08T23:07:30.623

对于 32 位值`0x12345678`,`12`是最高有效字节，在大端系统中首先出现，然后是`34`, `56`, `78`。

大端：

```
0x100 12
0x101 34
0x102 56
0x103 78 
```

小端：

```
0x100 78
0x101 56
0x102 34
0x103 12 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-08T23:07:38.677

你搞错了：

```
0x100 0x101 0x102 0x103
78    56    34    12 
```

这是 BIG endian 中的 0x78563412，或 LITTLE endian 中的 0x12345678。

BIG endian 中的 32 位值 0x12345678 是`12 34 56 78`.

# scala - 通过类型成员而不是类型参数进行 F 有界量化？

> ID：14225582
> 
> 赞同：3
> 
> 时间：2013-01-08T23:04:15.047
> 
> 标签：scala, types, type-projection, bounded-quantification

我想将类型参数移动到类型成员。

这是有效的起点：

```
trait Sys[S <: Sys[S]] {
  type Tx
  type Id <: Identifier[S#Tx]
}

trait Identifier[Tx] {
  def dispose()(implicit tx: Tx): Unit
}

trait Test[S <: Sys[S]] {
  def id: S#Id
  def dispose()(implicit tx: S#Tx) {
    id.dispose()
  }
} 
```

让我烦恼的是，我在`[S <: Sys[S]]`整个库中都携带了一个类型参数。所以我的想法是这样的：

```
trait Sys {
  type S = this.type  // ?
  type Tx
  type Id <: Identifier[S#Tx]
}

trait Identifier[Tx] {
  def dispose()(implicit tx: Tx): Unit
}

trait Test[S <: Sys] {
  def id: S#Id
  def dispose()(implicit tx: S#Tx) {
    id.dispose()
  }
} 
```

哪个失败了......`S#Tx`并且`S#Id`变得不知何故分离：

```
error: could not find implicit value for parameter tx: _9.Tx
               id.dispose()
                         ^ 
```

任何使它起作用的技巧或改变？

* * *

**编辑**：为了澄清，我主要希望修复类型`S`以`Sys`使其工作。在我的案例中，使用路径相关类型存在许多问题。仅举一个反映 pedrofuria 和 Owen 答案的例子：

```
trait Foo[S <: Sys] {
  val s: S
  def id: s.Id
  def dispose()(implicit tx: s.Tx) {
    id.dispose()
  }
}

trait Bar[S <: Sys] {
  val s: S
  def id: s.Id
  def foo: Foo[S]
  def dispose()(implicit tx: s.Tx) {
    foo.dispose()
    id.dispose()
  }
}

<console>:27: error: could not find implicit value for parameter tx: _106.s.Tx
               foo.dispose()
                          ^ 
```

试着`def foo: Foo[s.type]`让你知道这无济于事。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-09T00:10:41.483

这与其说是一个答案，不如说是对 pedrofurla 答案的评论；我认为这是正确的。让我解释一下为什么。

Scala 有一个有趣的地方，当你编写一个类的类型成员时，它实际上创建了两个不同的名称，一个属于该类，另一个属于该类的对象。它们之间有一些联系，即对象成员类型必须是类成员类型的子类型，但根据我的经验，您很少想要使用这种联系；大多数时候，您应该将它们视为完全独立的事物。

您在这里真正想要做的是打包两种类型，以便您可以为它们对命名。所以我会这样写`Sys`：

```
trait Sys {
    type Tx
    type Id <: Identifier[Tx]
} 
```

因为这准确地说明了您想要做什么，没有魔法或绒毛：创建一种对象，每个对象存储两个东西，这些东西是类型（并且它们之间有一些约束）。

然后您可以编写`Test`pedrofurla 建议的方式：

```
trait Test {
    val s: Sys
    def id: s.Id
    def dispose()(implicit tx: s.Tx) {
        id.dispose()(tx)
    }
} 
```

同样，只有您需要的，没有额外的：要创建 的实例`Test`，您必须提供一个`Sys`，并且该*实例*将`Sys`包含`Test`需要使用的类型。

换句话说，有时只是将类型视为要打包和传递的常规旧值。

* * *

**编辑**：

如果您再次坚持您所需要的，可扩展性（至少在您的示例中，可能还有其他我没有想到的）应该不是问题。在您的`Foo`/`Bar`示例中，

```
// This is normal; nothing unexpected.
trait Foo {
    val s: Sys
    def id: s.Id
    def dispose()(implicit tx: s.Tx) {
        id.dispose()
    }
}

trait Bar { self =>
    val s: Sys
    def id: s.Id
    // Now here's the key!
    val foo: Foo { val s: Sys { type Tx = self.s.Tx } }
    def dispose()(implicit tx: s.Tx) {
        foo.dispose()
        id.dispose()
    }
} 
```

在这里，我们真正希望 our与*our*相同，因为我们想要做的是互换使用它们`foo`。所以，我们只需要它，它编译没有问题。`s.Tx` *`s.Tx`*

 ** * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-08T23:57:30.063

这是`Test`编译的版本：

```
trait Test[S <: Sys] {
  val s : S
  def id: s.Id
  def dispose()(implicit tx: s.Tx) {
    id.dispose()
  }
} 
```

你说“S#Tx 和 S#Id 不知何故分离”是绝对正确的。据我了解，您不能保证在两个 S 中它们实际上是同一类型。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-09T01:55:37.800

虽然这不能回答您的问题（确保对现有代码的最小修改），但这里有一个想法：

type不是`Tx`的成员`Sys`并被用于`Identifier`，而是作为起点，将其设为 的参数`Sys`，并确保它以相同的方式被`Id <: Identifier`and使用`S <: Sys`，如下所示：

```
 trait Sys[Tx] {
        type S <: Sys[Tx]
        type Id <: Identifier[Tx]
    }

    trait Identifier[Tx] {
        def dispose()(implicit tx: Tx): Unit
    }

    trait Test[Tx, S <: Sys[Tx]] {
        def id: S#Id
        def dispose()(implicit tx: Tx) = id.dispose()
    } 
```

* * *

就您的动机而言，这几乎不是什么改进（`Sys`仍然有一个类型参数），但我的下一步是转换`Tx`为类型成员。但是，在不使用任何`val s: S`技巧（以及基于它的类型）的情况下，我可以使它工作的唯一方法是：

*   分为`Sys`两个特征，作为类型和其他一切`OuterSys`的持有者（以及作为内在特征）引入，并保留它为你做的任何其他事情`Tx``Sys``Identifier``Sys`
*   有`Test`特质属于`OuterSys`

这是代码：

```
 trait OuterSys {
        type Tx
        type S <: Sys
        type Id <: Identifier

        trait Sys {
        }

        trait Identifier {
            def dispose()(implicit tx: Tx): Unit
        }

        trait Test {
            def id: Id
            def dispose()(implicit tx: Tx) = id.dispose()
        }
    } 
```

因此，尽管没有真正回答您的问题或解决您的问题，但我希望它至少可以让你们知道如何解决这个问题。我尝试过的所有其他东西都返回给我，编译器为某个实例大喊大叫，`S`并期待一个基于它的类型。

* * *

**编辑**：不需要拆分`Sys`：

```
 trait Sys {
        type Tx
        type Id <: Identifier

        trait Identifier {
            def dispose()(implicit tx: Tx): Unit
        }

        trait Test {
            def id: Id
            def dispose()(implicit tx: Tx) = id.dispose()
        }
    } 
```

也忽略了提到明显的 - 类型取决于`Sys`实例，我认为这是有道理的（系统之间不共享标识符？事务可能？）。

也不需要从`Sys`实例内部“测试”，也不再需要`type S <: Sys`（`type S = this.type`在 MySystem 中）：

```
 object MySystem extends Sys {
        type Tx = MyTransaction
        type Id = MyIdentifier

        class MyTransaction (...)
        class MyIdentifier (...) extends Identifier {
            def dispose()(implicit tx: MySystem.Tx) {}
        }
    }

    object MyOuterTest {
    {
        def id: MySystem.Id = new MySystem.MyIdentifier(...)

        def dispose()(implicit tx: MySystem.Tx) {
            id.dispose()
        }
    } 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-01-09T09:33:45.397

我有 2 个可以编译的版本，但是我不完全确定这两个版本是您在库中寻找的。（**编辑**：这个版本本质上是有缺陷的，见评论）。这里我们将类型参数 S 完全从 Sys 中移除，并继续使用类型投影（相对于路径依赖类型）。

```
trait Sys {
  type Tx
  type Id <: Identifier[Sys#Tx]
}

trait Identifier[Tx] {
  def dispose()(implicit tx: Tx)
}

trait Test[S <: Sys] {
  def id: S#Id
  def dispose()(implicit tx: S#Tx) {
    id.dispose()(tx)
  }
} 
```

在这个版本中，我们将类型参数转换为类型成员（我不完全确定这是正确的翻译），然后使用类型细化和类型投影的组合来确保 Test 中的类型正确。

```
trait Sys {
  type S <: Sys
  type Tx
  type Id <: Identifier[S#Tx]
}

trait Identifier[Tx] {
  def dispose()(implicit tx: Tx)
}

trait Test[A <: Sys {type S = A}] {
  def id: A#Id
  def dispose()(implicit tx: A#S#Tx) {
    id.dispose()
  }
} 
```

另请注意，我们必须`A#S#Tx`将隐式参数用作我们的类型投影，这有望阐明原因`S#Id`并`S#Tx`变得“分离”。实际上，它们并没有分离，声明`type S = this.type`会创建`S`一个单例类型，然后再创建`S#T`一个路径依赖类型。

更清楚地说， given`val a: A {type B}`是`a.A`的简写`a.type#A`。即`S#T`真的`this.type#T`，这也是为什么简单地声明`def dispose()(implicit tx: S#S#T)`不起作用的原因，因为`S#S#T`它是类型投影，而不是所需的路径依赖类型，如上面需要 a`val s: S`编译的答案所示。

**编辑**：您可以删除 Test 上的参数，如下所示：

```
trait Test {
  type A <: Sys {type S = A}
  def id: A#Id
  def dispose()(implicit tx: A#S#Tx) {
    id.dispose()
  }
} 
```

然而，这可能需要大量的源代码修改。

无论您是使用类型参数还是类型成员，指定类型都不会在不修改类型在库中的工作方式的情况下消失。即，类型参数和抽象类型成员是等价的，因此您似乎无法`S <: Sys[S]`完全摆脱类型。

**EDIT2**：不使用依赖路径的类型或 Duduk 的回答中的某些东西，这似乎是不可能的。这是对我已经给出的避免传递的轻微修改`val s: S`，但是它可能无法在您的库中使用，因为它需要更改`Identifier[Tx]`为类型成员和`def id: S#Id`a`val`以公开路径相关类型：

```
trait Sys {self =>
  type Tx
  type Id <: Identifier {type Tx = self.Tx}
}

trait Identifier {
  type Tx
  def dispose()(implicit tx: Tx)
}

trait Test[S <: Sys] {
  val id: S#Id
  def dispose()(implicit tx: id.Tx) {
    id.dispose()(tx)
  }
} 
```*

# java - Random() 不生成随机数

> ID：14225594
> 
> 赞同：0
> 
> 时间：2013-01-08T23:04:57.587
> 
> 标签：java, random

我正在尝试做 roshambo（或 Rock-Paper-Scissors）并让计算机输出 Rock、Paper 或 Scissors 来代替从 0 到 2 的随机值。但是，我没有得到随机值。当程序运行时，它会经过一个while循环，并且每次经过循环时，值都保持不变。但是，如果我停止，然后重新运行应用程序，值会发生变化，并在循环期间保持相同的值。我是否正确编码此方法？

```
public class Player2 extends Player{

    private Random rand;

    public Player2(){
        rand = new Random();
    }

    public Roshambo generateRoshambo() {
        int min = 0;
        int max = 2;
        int randomNum = rand.nextInt(max - min + 1) + min;

        if(randomNum == 0){
            return Roshambo.ROCK;
        } else if (randomNum == 1) {
            return Roshambo.PAPER;
        } else {
            return Roshambo.SCISSORS;
        }
    }
} 
```

这是循环：

```
Roshambo value = p2.generateRoshambo(); 
String cont = "Yes";

do{

        System.out.print("\nRock, Paper, or Scissors: ");
        String choice = sc.nextLine();

        System.out.println("\n" + name + ": " + choice);
        System.out.println("Computer: " + value);

        if (value == ...)
        {
            System.out.println("\n" + name + " Wins!\n");
        } 

        else if (value == ...)
        {
            System.out.println("\nYou Tied!\n");
        }

        else 
        {
            System.out.println("\nThe Computer Wins!\n");
        }

        System.out.print("Play again? (Yes/No): ");
        cont = sc.nextLine();
    } while (cont.equalsIgnoreCase("Yes")); 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-08T23:18:47.493

我才意识到自己的错误。我在我的 do-while 循环之外调用了 p2.generateRoshambo() 。通过将以下内容放入我的循环中，我能够解决问题：

```
Roshambo value = p2.generateRoshambo() 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-08T23:07:46.510

该症状最可能的原因是每次都创建一个新的 Random 实例。默认种子基于可能没有在紧密循环中滴答作响的时钟。尽可能少地创建 Random 实例很重要，通常只在程序中创建一个，然后继续从中获取值。

# python - Django 表单查询数据库（模型）

> ID：14225601
> 
> 赞同：6
> 
> 时间：2013-01-08T23:05:33.917
> 
> 标签：python, django, forms, postgresql

所以我想创建一个带有单个输入字段的超级基本表单，用于查询我的数据库。

我的模型（`models.py`）如下：

```
from django.db import models

class Book(models.Model):
    uid = models.IntegerField(primary_key=True)
    title = models.CharField(max_length=30)
    class Meta:
        db_table = u'books' 
```

`forms.py`：

```
from django import forms
from myapp.models import Book

class EnterIDForm(forms.form):
book_id = forms.CharField()
# add a custom clean function to validate that the user input
#  is a valid book ID
def clean_book_id(self):
    try:
        book_id = int(self.cleaned_data["book_id"])
    except:
        book_id = None

    if book_id and Book.objects.filter(uid=book_id).count():
        return book_id
    else:
        raise forms.ValidationError("Please enter a valid book ID number.") 
```

`views.py`：

```
from django.shortcuts import render_to_response
from myapp.models import Book

def form_view(request):
    if request.method == "POST":
        # the user has submitted the form, see if we have a book
        book_id_form = EnterIDForm(request.POST) # instantiate our form class with the user data
        if book_id_form.is_valid():
            # if our form is valid, then we have a book_id that works:
            the_book = Book.objects.get(uid=book_id_form.cleaned_data["book_id"])
                return render_to_response("book_template.html", { "the_book": the_book }, context_instance=RequestContext(request))
        # if the form wasn't valid, it will fall through to the other return statement.
    else:
        # If the user didn't submit a form, instantiate a blank one.
        book_id_form = EnterIDForm()
    return render_to_response("form_template.html", { "book_id_form": book_id_form }, context_instance=RequestContext(request)) 
```

我希望输入字段从用户那里收集“uid”并显示来自 Book 模型实例的所有数据，其中 uid 是数据库中的某本书。

我了解表单如何与视图以及后来的模板相关联，但我似乎无法让它工作。

我无休止地搜索了 Django 站点和许多其他资源，以寻找可以从中学习的示例，但一无所获。

有人介意帮我吗？

谢谢。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-01-09T04:27:02.840

你可以在这里做一个简单的搜索。您不需要任何 POST 调用或表单创建。但是，如果您想创建一个表单，这仍应为您指明正确的方向。

尝试这样的事情：

搜索.html：

```
<form method="get" action="/search/">
  Search Notecards:<input type="text" name="q" id="id_q" value="{{ query }}"/>
  <input type="submit" value="Search" />
</form> 
```

视图.py：

```
from myapp.models import Book
from django.template import RequestContext
from django.shortcuts import render_to_response

def search(request):
    query = request.GET.get('q')
    try:
        query = int(query)
    except ValueError:
        query = None
        results = None
    if query:
        results = Book.objects.get(uid=query)
    context = RequestContext(request)
    return render_to_response('results.html', {"results": results,}, context_instance=context) 
```

结果.html：

```
{% if results %}
  {% for result in results %}
    {{ result.uid }}
    {{ result.xxxx }}
    {{ result.xxxx }}
  {% endfor %}
{% else %}
    <h3 class='error'>Please enter a valid UID</h3>
    <form method="get" action="/search/">
      Search Notecards:<input type="text" name="q" id="id_q" value="{{ query }}"/>
      <input type="submit" value="Search" />
    </form>
{% endif %} 
```

# jquery - 幻灯片中的电影继续在当前幻灯片后面播放

> ID：14225605
> 
> 赞同：0
> 
> 时间：2013-01-08T23:05:53.447
> 
> 标签：jquery, vimeo, movies

我从 vimeo 创建了电影幻灯片：

[http://www.180dev.com/background2](http://www.180dev.com/background2)

当我从一部电影跳到另一部电影时，我仍然可以听到原始电影。如何让当前的电影停止？

我基于此构建了幻灯片：http: [//slidesjs.com/examples/linking/](http://slidesjs.com/examples/linking/)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-08T23:23:03.990

您需要使用 vimeo API 使其停止。例如，当您单击滑动另一个视频时，您使用 vimeo API 使上一个视频停止。

# java - 将更新和插入与 hypersql 结合使用

> ID：14225606
> 
> 赞同：1
> 
> 时间：2013-01-08T23:05:54.373
> 
> 标签：java, hsqldb, upsert

我正在根据这篇很棒的帖子实施 upsert：[Insert, on duplicate update in PostgreSQL?](https://stackoverflow.com/questions/1109061/insert-on-duplicate-update-postgresql) 这对 psql 非常有效。但是，我无法将相同的查询触发到我用于测试的 hsqldb 中。我的 sql 看起来像这样：

```
UPDATE account set name = ?, email = ?, type = ?, regts = ?, dao_updated = ? WHERE id = ?; 
INSERT INTO account (id, name, email, type, regts, dao_created,dao_updated) SELECT ?,?,?,?,?,?,? WHERE NOT EXISTS (SELECT 1 FROM account WHERE id = ? ); 
```

我收到错误消息：

```
Caused by: java.sql.SQLSyntaxErrorException: unexpected token: INSERT
at org.hsqldb.jdbc.Util.sqlException(Unknown Source)
at org.hsqldb.jdbc.Util.sqlException(Unknown Source)
at org.hsqldb.jdbc.JDBCPreparedStatement.<init>(Unknown Source)
at org.hsqldb.jdbc.JDBCConnection.prepareStatement(Unknown Source) 
```

这是 hsqldb 的限制还是我做错了什么？

提前感谢莱昂

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-08T23:25:17.833

您显然不能在单个`executeUpdate()`调用中使用多个语句。请，第一次打两次`UPDATE`，下次打`INSERT`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-08T23:32:03.537

HSQLDB 为此支持 MERGE 语句：

[http://hsqldb.org/doc/2.0/guide/dataaccess-chapt.html#dac_merge_statement](http://hsqldb.org/doc/2.0/guide/dataaccess-chapt.html#dac_merge_statement)

合并语句通常比 UPSERT 和非标准替代方案更强大。

或者，您可以使用 CREATE PROCEDURE 并定义类似于链接答案中给出的 PostgreSQL 示例的过程。

[http://hsqldb.org/doc/2.0/guide/sqlroutines-chapt.html#src_psm_conditional](http://hsqldb.org/doc/2.0/guide/sqlroutines-chapt.html#src_psm_conditional)

您可以使用 GET DIAGNOSTICS 语句来确定更新是否成功。

[http://hsqldb.org/doc/2.0/guide/dataaccess-chapt.html#dac_diagnostics_state](http://hsqldb.org/doc/2.0/guide/dataaccess-chapt.html#dac_diagnostics_state)

# python - Python：如何在 if 语句中使用 RegEx？

> ID：14225608
> 
> 赞同：68
> 
> 时间：2013-01-08T23:06:11.927
> 
> 标签：python, regex

我有以下代码查看一个目录中的文件并将包含某个字符串的文件复制到另一个目录中，但我正在尝试使用正则表达式，因为字符串可能是大写和小写或两者的混合。

这是有效的代码，在我尝试使用 RegEx 之前

```
import os
import re
import shutil

def test():
    os.chdir("C:/Users/David/Desktop/Test/MyFiles")
    files = os.listdir(".")
    os.mkdir("C:/Users/David/Desktop/Test/MyFiles2")
    for x in (files):
        inputFile = open((x), "r")
        content = inputFile.read()
        inputFile.close()
        if ("Hello World" in content)
            shutil.copy(x, "C:/Users/David/Desktop/Test/MyFiles2") 
```

这是我尝试使用 RegEx 时的代码

```
import os
import re
import shutil

def test2():
    os.chdir("C:/Users/David/Desktop/Test/MyFiles")
    files = os.listdir(".")
    os.mkdir("C:/Users/David/Desktop/Test/MyFiles2")
    regex_txt = "facebook.com"
    for x in (files):
        inputFile = open((x), "r")
        content = inputFile.read()
        inputFile.close()
        regex = re.compile(regex_txt, re.IGNORECASE) 
```

我猜我需要一行代码，就像

```
if regex = re.compile(regex_txt, re.IGNORECASE) == True 
```

但我似乎无法得到任何工作，如果有人能指出我正确的方向，将不胜感激。

* * *

## 回答 #1

> 赞同：131
> 
> 时间：2013-01-08T23:11:31.743

```
if re.match(regex, content):
  blah.. 
```

您也可以`re.search`根据您希望它的匹配方式使用。

* * *

## 回答 #2

> 赞同：39
> 
> 时间：2017-07-13T19:48:23.460

# `if re.search(r'pattern', string):`

简单的 if 正则表达式示例：

```
if re.search(r'ing\b', "seeking a great perhaps"):     # any words end with ing?
    print("yes") 
```

复杂的 if-regex 示例（模式检查，提取子字符串，不区分大小写）：

```
match_object = re.search(r'^OUGHT (.*) BE$', "ought to be", flags=re.IGNORECASE)
if match_object:
    assert "to" == match_object.group(1)     # what's between ought and be? 
```

笔记：

*   使用`re.search()`不重新匹配。匹配[限制在](https://stackoverflow.com/a/8687988/673991)字符串的开头，如果你问我，这是一个[令人困惑的约定。](https://stackoverflow.com/a/37363575/673991)如果您确实想要字符串开头的匹配，请使用插入符号，或者`\A`，`re.search(r'^...', ...)`

*   对第一个参数使用[原始字符串](https://stackoverflow.com/a/9576583/673991)语法`r'pattern'`。否则你需要加倍反斜杠，如`re.search('ing\\b', ...)`

*   在这些示例中，`'\\b'`or`r'\b'`是用于正则表达式目的的[特殊序列](https://docs.python.org/library/re.html#regular-expression-syntax)，表示[词边界](https://stackoverflow.com/a/44002041/673991)。`'\b'`不要与退格或退格混淆`'\x08'`。

*   `re.search()``None`如果它没有找到任何东西，则返回，这总是[falsy](https://stackoverflow.com/a/39984051/673991)。

*   `re.search()`如果找到任何东西，则返回一个[Match 对象](https://docs.python.org/library/re.html#match-objects)，这始终是真实的。

*   一组是括号内匹配的内容

*   组编号从 1 开始

*   [眼镜](https://docs.python.org/library/re.html)

*   [教程](https://docs.python.org/howto/regex.html)

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2013-01-08T23:09:23.417

REPL 使学习 API 变得容易。只需运行`python`，创建一个对象，然后要求`help`：

```
$ python
>>> import re
>>> help(re.compile(r'')) 
```

在命令行显示，除其他外：

> # `search(...)`
> 
> `search(string[, pos[, endpos]])`--> 匹配对象或`None`. 扫描字符串以查找匹配项，并返回相应的 `MatchObject`实例。`None`如果字符串中没有位置匹配，则返回。

所以你可以做

```
regex = re.compile(regex_txt, re.IGNORECASE)

match = regex.search(content)  # From your file reading code.
if match is not None:
  # use match 
```

顺便，

```
regex_txt = "facebook.com" 
```

有一个`.`匹配任何字符的，所以`re.compile("facebook.com").search("facebookkcom") is not None`是真的，因为`.`匹配任何字符。也许

```
regex_txt = r"(?i)facebook\.com" 
```

`\.`匹配文字`"."`字符，而不是视为`.`特殊的正则表达式运算符。

该`r"..."`位意味着正则表达式编译器获取转义`\.`而不是 python 解析器解释它。

这`(?i)`使得正则表达式不区分大小写，`re.IGNORECASE`但自包含。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-01-08T23:08:16.100

首先编译正则表达式，然后必须将它与`match`,`find`或其他一些方法一起使用，以针对某些输入实际运行它。

```
import os
import re
import shutil

def test():
    os.chdir("C:/Users/David/Desktop/Test/MyFiles")
    files = os.listdir(".")
    os.mkdir("C:/Users/David/Desktop/Test/MyFiles2")
    pattern = re.compile(regex_txt, re.IGNORECASE)
    for x in (files):
        with open((x), 'r') as input_file:
            for line in input_file:
                if pattern.search(line):
                    shutil.copy(x, "C:/Users/David/Desktop/Test/MyFiles2")
                    break 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-01-08T23:19:28.730

正则表达式不应该真正以这种方式使用——除非你想要比你想要做的更复杂的事情——例如，你可以将你的内容字符串和比较字符串标准化为：

```
if 'facebook.com' in content.lower():
    shutil.copy(x, "C:/Users/David/Desktop/Test/MyFiles2") 
```

# javascript - 将音频同步到图片轮播

> ID：14225614
> 
> 赞同：0
> 
> 时间：2013-01-08T23:06:56.997
> 
> 标签：javascript, html

是否可以在不使用画布的情况下将音频同步到图片轮播？我目前正在使用 setInterval 来实现轮播。我不想使用闪光灯，如果可能并且不太难实现，我想在没有画布的情况下做到这一点。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-08T23:11:05.230

~~你试过画布吗？~~

假设您正在使用一个`<audio>`元素，您可以获得它的`currentTime`属性。这将告诉您播放头在哪里。您可以使用此信息在音频经过某个位置时更改轮播，也可以将其设置为在轮播更改时更改音频位置。无论哪种方式更适合您正在做的事情。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-09T00:42:58.863

实现轮播是什么意思？

当您希望显示图像时，我会设置一个特定的时间戳。因此，您要在 12 秒时显示图像。

您可能还想确保音频已加载。您可以使用`canPlayThrough`检查并查看是否加载了足够的内容来播放，或者您可以使用`audio.buffered.end(0)`检查音频文件的长度并确保整个内容已加载。

这是一篇关于此的更多内容的好文章：http: [//html5doctor.com/html5-audio-the-state-of-play/](http://html5doctor.com/html5-audio-the-state-of-play/)

加载音频时，您调用一个函数并传入时间戳并将其设置为 setInterval 时间。因此，`timestamp * 1000`该函数将触发并显示在该时间戳传递的图像。

您也可以尝试使用`audio.currentTime`然后开火，更多内容请参见上面的文章。如果您有更具体的问题，请告诉我。

# vb.net - vb.net 检测是否在 Webbrowser 控件中单击了链接

> ID：14225616
> 
> 赞同：1
> 
> 时间：2013-01-08T23:07:07.340
> 
> 标签：vb.net

我在 VB.NET 2005 的标准 Windows 窗体上有一个 Webbrowser 控件。我只想检测何时有人单击 Webbrowser 控件内的链接，它只是告诉我他们单击了什么，或者它试图去哪里，然后取消该过程.

我试着放..

```
MsgBox(e.Url)
e.Cancel = True 
```

在 WebBrowser1_Navigating EVENT 内部，但什么也没做。任何人都可以帮忙吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-09T10:54:09.837

您可以尝试为每个链接添加处理程序：

```
For Each htmlEle As HtmlElement In Webbrowser1.document.Links
    addhandler htmlElec.click, addressof YourSub
Next

private sub YourSub()
    'do what you want here
end sub 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-09T17:29:34.830

这就是问题所在：

MsgBox(e.Url)

试试这个：

MsgBox(e.Url.ToString())

```
Private Sub WebBrowser1_Navigating(ByVal sender As Object, ByVal e As System.Windows.Forms.WebBrowserNavigatingEventArgs) Handles WebBrowser1.Navigating
    If MsgBox("You are trying to go to:" & vbCr & e.Url.ToString() & vbCr & "Cancel Navigate?", MsgBoxStyle.YesNo) = MsgBoxResult.Yes Then
        e.Cancel = True
    End If
End Sub 
```

# javascript - 我有两个响应式菜单——如何编辑 javascript 以在另一个打开时关闭一个？

> ID：14225625
> 
> 赞同：0
> 
> 时间：2013-01-08T23:07:40.670
> 
> 标签：javascript, jquery, css, responsive-design

我在类似于下面的 jsfiddle 的页面上有两个响应式菜单。当您最小化窗口以查看响应式“菜单”文本链接时，当前打开一个并单击另一个时，它们都保持打开状态。我将如何编辑 javascript，以便当一个打开时，另一个关闭？非常感谢您的帮助。

[http://jsfiddle.net/Jq6sZ/](http://jsfiddle.net/Jq6sZ/)

```
$(document).ready(function() {
  $('body').addClass('js');
      var $menu = $('#menu'),
          $menulink = $('.menu-link'),
          $menuTrigger = $('.has-subnav > a');

    $menulink.click(function(e) {
        e.preventDefault();
        $menulink.toggleClass('active');
        $menu.toggleClass('active');
    });

    $menuTrigger.click(function(e) {
        e.preventDefault();
        var $this = $(this);
        $this.toggleClass('active').next('ul').toggleClass('active');
    });

    });$(document).ready(function() {
  $('body').addClass('js');
      var $menu = $('#menu2'),
          $menulink = $('.menu-link2'),
          $menuTrigger = $('.has-subnav > a');

    $menulink.click(function(e) {
        e.preventDefault();
        $menulink.toggleClass('active');
        $menu.toggleClass('active');
    });

    $menuTrigger.click(function(e) {
        e.preventDefault();
        var $this = $(this);
        $this.toggleClass('active').next('ul').toggleClass('active');
    });

    }); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-08T23:13:07.710

```
selector.removeClass('active');
$(this).toggleClass('active'); 
```

这意味着删除任何选择器上的活动类，但将其赋予活动类。

# jquery - jQuery 事件，通过上下文更改传递参数

> ID：14225635
> 
> 赞同：0
> 
> 时间：2013-01-08T23:08:44.597
> 
> 标签：jquery

我有这个基本代码：

```
app.Modules.myModule = {
    init: function(){
        this.bindEvents();
    },

    bindEvents: function(){
        app.Events.on('user:added', this.userAdded.call(this));
        this.username = $('#username');
    },

    userAdded: function(event, params){
        console.log(params);
        this.username.text(params.username);
    }
}; 
```

现在我遇到的问题是，如果我按原样调用 this.userAdded，则 params 不会传递给 userAdded 函数。如果我不使用“调用”而只是在 userAdded 函数中执行 this.userAdded，那么“this”的上下文是 jQuery 事件，而不是像我需要的那样的“app.Modules.myModule”。

所以我的问题是，如何将 userAdded 函数中的“this”上下文保留到对象本身（myModule）并能够将其传递给 params 参数？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-08T23:14:49.017

如果将模块定义为函数，则可以在实例化时将上下文设置为变量。例如：

```
app.Modules.myModule = function(){

    var context = this;
    context.init = function(){
        context.bindEvents();
    };

    context.bindEvents = function(){
        app.Events.on('user:added', context.userAdded);
        context.username = $('#username');
    };

    context.userAdded = function(event, params){
        console.log(params);
        context.username.text(params.username);
    } ;       
};

var module = new app.Modules.myModule(); 
```

上下文变量现在将引用对象的上下文，并且可以在函数中使用。确保在初始化对象时使用“new”关键字。

# google-chrome - 边界图像一开始是否在做它的工作？

> ID：14225640
> 
> 赞同：3
> 
> 时间：2013-01-08T23:09:31.170
> 
> 标签：google-chrome, css

我正要在铬问题跟踪器上创建一个错误，但后来我想我会先在这里尝试一下。

尝试看看这个网站： [http ://www.norabrowndesign.com/css-experiments/border-image-frame.html](http://www.norabrowndesign.com/css-experiments/border-image-frame.html)

但是，现在看来，chrome 确实支持border-image-outset，或者我想。

它响应命令，但不符合我的预期。将图像向外移动，从而在内容周围创建更多而不是更少的空白。阅读规范我不确定 chrome 在做它的时候是否有问题，但看起来链接网站的作者肯定会期待别的东西。

此外，如果目前的行为是正确的，那么我看不出它的目的是什么。而大边框图像的问题，根本没有解决办法。

那是什么，我应该提交错误还是？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-25T09:15:35.897

我相信 Chrome 的行为应该如此。`border-image-outset`应该将边框图像区域扩展到边框框之外。它似乎在 Chrome 中这样做。删除内容周围的空白将需要相反的情况，这可以在`border-image-width`.

`border-image-width`划分边界图像区域，基本上是对应的`border-image-slice`（划分边界图像）。它的初始值为`1`（相应计算的倍数`border-width`）。因此，如果不分配`border-image-width`每个切片，则会将其大小调整为`border-width`.

请参阅w3.org 上[的边框图像宽度](http://www.w3.org/TR/css3-background/#border-image-width)

要删除内容周围的空白，同时保持边框图像的大小，您必须减小`border-width`并设置`border-image-width`为适当的值。

在您的问题的示例中尝试以下更改：

```
#one {
  border-width: 74px;
  border-image-width: auto;
} 
```

# php - Mysql不会更新行

> ID：14225642
> 
> 赞同：-4
> 
> 时间：2013-01-08T23:09:41.717
> 
> 标签：php, mysql

> **可能重复：**
> [这个查询mysql有什么问题？](https://stackoverflow.com/questions/8200174/whats-wrong-with-this-query-mysql)

我正在使用 mysql 和 php 来更新记录。这是我的代码：

```
$n=mysql_query("UPDATE chondas SET model='$model1', yearstart=$yearstart1,
                yearstop=$yearstop1, desc='$desc1', hp='$hp1', 
                engine='$engine1',trim='$trim1', weight='$weight1' WHERE id=$id1"); 
```

在下面的代码中，如果我取出`desc='$desc1'`一切正常。什么会导致这个错误？

当我在 phpmyadmin 中测试以下代码时，出现此错误：

> #1064 - 您的 SQL 语法有错误；检查与您的 MySQL 服务器版本相对应的手册，以获取正确的语法，以便在第 1 行的 'desc='text of the textarea' 附近使用。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-08T23:12:38.703

`DESC`是[mysql 中的保留字，](http://dev.mysql.com/doc/refman/5.5/en/reserved-words.html)因此您需要使用反引号：

```
UPDATE chondas SET model='$model1', yearstart=$yearstart1, yearstop=$yearstop1, `desc`='$desc1', hp='$hp1', engine='$engine1',trim='$trim1', weight='$weight1' WHERE id=$id1 
```

您还应该切换到 PDO（或 mysqli）并使用绑定变量准备语句以避免潜在的 sql 注入。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-08T23:12:30.283

`DESC`是 MySQL 中的保留字。

用反引号逃脱它

```
 `desc` = '$desc1' 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-08T23:16:57.150

如果您在 phpMyAdmin 中包含变量名称，您的查询将不会运行，例如：

```
UPDATE chondas SET model='$model1', yearstart=$yearstart1,
yearstop=$yearstop1, **desc='$desc1'**, hp='$hp1', 
engine='$engine1',trim='$trim1', weight='$weight1' WHERE id=$id1 
```

此外，如果您混合使用 "" 和 ''，PHP 将无法运行，例如：`"UPDATE chondas SET model='$model1'...`

# ruby-on-rails - 为什么“rails 生成迁移”调用“调用 activerecord”

> ID：14225652
> 
> 赞同：2
> 
> 时间：2013-01-08T23:10:18.853
> 
> 标签：ruby-on-rails, ruby, migration, invoke

运行时：

```
 rails generate migration <someaction> field:type 
```

我可以看到它正在执行两个操作：

1.  调用调用 active_record
2.  创建迁移文件。

我完全理解它为什么会生成迁移文件，但为什么会调用 ActiveRecord？这让我很困扰，因为如果我想手动创建迁移文件怎么办？我将如何模仿这种调用（如果有必要的话..）？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-09T00:40:23.287

生成器`MigrationGenerator`：

1) 加载您的 ORM（在 Rails 中默认为 Active Record），使其扩展正确的 'ORM'::Migration 类（同样默认为 ActiveRecord::Migration）

2) 它本身是`NamedBase`生成器的扩展，它查看您是否正在运行 Active Record 来决定是否应该将表名复数。如果你跑就是这样

```
rails generate migration AddPartNumberToProducts part_number:string 
```

或者

```
rails generate migration AddPartNumberToProduct part_number:string 
```

您在文件中得到相同的结果。

所以简短的回答是，您不需要调用 active_record 来手动创建迁移，但如果您这样做并且您正在使用 Active Record，请确保您的表名在迁移文件中是复数形式的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-09T00:34:47.127

[调用activerecord gem](http://rubygems.org/gems/activerecord)来生成迁移文件。

如果仔细观察，迁移文件的超类是[ActiveRecord::Migration](http://api.rubyonrails.org/classes/ActiveRecord/Migration.html)类。

# ios - 向 iOS 设备分发证书和私钥

> ID：14225653
> 
> 赞同：1
> 
> 时间：2013-01-08T23:10:24.840
> 
> 标签：ios, certificate, distribution, private, mdm

我有一个 iOS 应用程序，它使用证书进行消息签名，遵循数字签名算法 (DSA)。为了执行此签名，应用程序需要证书以及与证书关联的私钥。而且，我无法在应用程序中嵌入证书，因为我的客户需要能够生成和分发他们自己的证书，以便应用程序在需要时使用。（而且，嵌入证书无论如何都会构成安全风险。）

有人对我如何分发证书和私钥有任何想法吗？

PS。我们在 BlackBerry 上做同样的事情，在那里，我们使用 BlackBerry Enterprise Server 和 BlackBerry 设备上的 API 将证书推送到组织中的设备。我希望有一个适用于 iOS 的 MDM 解决方案，但还没有找到任何东西。

非常感谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-09T15:54:30.233

在 iOS 上，没有直接的方式来分发证书，它是应用程序的私钥。Apple 建议使用 PKCS12 并在本文档中提供了一些指导：[技术问答 QA1745: Making Certificates and Keys Available To Your App](https://developer.apple.com/library/ios/#qa/qa1745/_index.html#//apple_ref/doc/uid/DTS40011636)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-08T23:17:33.407

你问：

> 有人对我如何分发证书和私钥有任何想法吗？

很抱歉，我对您的具体情况了解得不够多，无法准确地告诉您如何满足您的要求，但我可以看出这不是通常的做法。相反，通常在设备上生成公钥/私钥对，然后（仅）将公钥与其他数据（例如，在证书签名请求中，CSR 中）一起提交给服务器（认证机构，CA），该服务器生成证书并将其返回给请求者（并可能将其发布到目录中）。

这种方法的一个重要安全优势是没有第三方可以访问私钥（CA 需要公钥，不需要私钥）。这是[不可否认性](http://en.wikipedia.org/wiki/Non-repudiation)所必需的（因此设备所有者不能声称某人从中央服务器获得了他的私钥）。

# coldfusion - cfloop 中未指定索引时 currentrow 的 ColdFusion 初始值

> ID：14225655
> 
> 赞同：6
> 
> 时间：2013-01-08T23:10:41.970
> 
> 标签：coldfusion, coldfusion-9, cfquery

我正在将 ColdFusion 应用程序转换为 C#（我是 CF n00b）。

我有一个脚本，它执行 cfquery，然后 cfloop 遍历结果，它似乎试图将当前行与其下一行进行比较。它似乎试图确保它不会尝试读取数组的末尾。

```
<cfquery name="qTripLegs" datasource="#sdb#">
   SELECT ...
</cfquery>

<cfloop query="qTripLegs">
    <cfif (customs_stop[currentrow] NEQ "" OR fuel_stop[currentrow] NEQ "") AND recordcount GT currentrow AND departure[currentrow] NEQ arrival[currentrow+1]> 
```

感觉 currentrow 是从 1 开始的（当它第一次进入 cfloop 时，currentrow 的值为 1）。我对么？我查看了coldfusion文档，但对此一无所知。

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2013-01-09T00:30:59.723

是的，CF 中的查询和数组是从 1 开始的。

CurrentRow 和 RecordCount 变量是查询的属性（在查询循环内，它们自动限定范围）。

`<cfloop query="QueryName">...</cfloop>`将遍历整个查询*，从 1 到`QueryName.RecordCount`，并且`QueryName.CurrentRow`索引会自动适当地填充/递增。不使用查询循环之前的值。

^(**（除非使用 cfbreak/etc）*)

还要指出，通常不需要阻止读取结束（如上所述，查询循环会处理它），只是因为使用了 CurrentRow+1 才需要避免错误。

# mysql - 从自动增量字段mysql java中知道下一个值

> ID：14225656
> 
> 赞同：3
> 
> 时间：2013-01-08T23:10:45.687
> 
> 标签：mysql, field, auto-increment, next

我想知道我想测试的自动增量字段的下一个值：

```
select max(contactid) from contact 
```

我加了 1，但我意识到如果我插入一条记录并删除它，它可能会给我一个错误，所以如果我在字段之后插入，则会增加 2

我怎样才能做到这一点？谢谢你

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-09T01:31:12.397

这个问题有多种解决方案：

**1.（首选）停止尝试预测自增值**

这是比较典型的情况，基本上是按照设计使用自增。这假设您在插入*之前实际上并不需要自动增量值。*你可以做的是：

```
DROP TABLE IF EXISTS t;
CREATE TABLE t (id INT UNSIGNED NOT NULL auto_increment, x INT NOT NULL, PRIMARY KEY(id));
INSERT INTO t (x) VALUES (100);
SELECT LAST_INSERT_ID(); 
```

调用`SELECT LAST_INSERT_ID()`将返回刚刚为您的`INSERT`.

**2、专门设置ID生成表来生成ID**

您可以创建一个仅包含自动增量列的表，如下所示：

```
DROP TABLE IF EXISTS id_generator;
CREATE TABLE id_generator (id INT UNSIGNED NOT NULL auto_increment, PRIMARY KEY(id)); 
```

然后，您可以使用以下命令生成一个新的唯一 ID：

```
INSERT INTO id_generator (id) VALUES (NULL);
SELECT LAST_INSERT_ID(); 
```

并使用该 ID 插入您实际使用的表中。只要所有生成的 ID 都来自这个 ID 生成表，就不会有冲突。然而，生成这些 ID 是有成本的，而且自动递增在这方面效率不高。

**3.使用外部ID生成方案**

这或多或少类似于解决方案 2，但根本不使用 MySQL 来生成 ID。您可以使用诸如生成字符串的 UUID/GUID 方案之类的东西，或者您可以使用诸如[Snowflake 之](https://github.com/twitter/snowflake)类的东西来生成整数 ID。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-08T23:17:37.820

你应该`LAST_INSERT_ID`这样使用：

```
SELECT LAST_INSERT_ID() 
```

它将返回`AUTO_INCREMENT`ID 字段的最后一个值。

更多细节在这里：http: [//goo.gl/RkmR5](http://goo.gl/RkmR5)

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-01-08T23:20:00.913

这将为您提供*将*插入的*下一个*id 值：

 *```
SELECT LAST_INSERT_ID() + 1; 
```*

# .net - 是否有系统的方法（通过 iText 或其他方式）来替换 ReportViewer 生成的 PDF 报告中的占位符项目？

> ID：14225659
> 
> 赞同：0
> 
> 时间：2013-01-08T23:10:52.297
> 
> 标签：.net, itextsharp, itext, reportviewer, rdlc

我发现其中一个 Microsoft 报告控件（图表）不足以满足我的需要。由于这些控件不可扩展，因此我扩展了 WPF 控件的功能并将控件保存为图形。不幸的是，ReportViewer 的图像控件也不支持矢量图形。因此，我的目标是从带有某些“占位符”（例如矩形项）的 ReportViewer 生成 PDF，然后使用 iTextSharp 并将矢量图形添加到这些占位符之上。由于报告长度基于输入数据流动，因此在获取这些占位符之前我无法知道它们的坐标。

我想不出一种在 RDLC 中包含 PDF 字段的方法，因为 iText 具有 GetFieldPosition() 方法，这会很好。此外，我知道有 iText 的 PDFWriter.GetVerticalPosition() 方法，但这仅在您将光标移动到 PDFWriter 中的该位置时才真正有用。事实是，我仍在尝试了解 iText 和 PDF。它是*广阔的*。

所以我的两个问题相互引用：

1.  我应该在 RDLC 设计器中使用什么样的占位符，之后可以系统地识别并查询其位置？
2.  我将如何获得这个职位？

提前致谢！

-布兰登

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-11T22:32:25.627

我不完美但可行的解决方案是使用与背景匹配的文本项占位符来标记 .RDLC 报告中的位置。生成 PDF 后，这些是通过继承 iTextSharp 的 LocationTextExtractionStrategy 来识别的（根据[greenhat 的这个条目](https://stackoverflow.com/questions/4577789/extract-text-and-text-rectangle-coordinates-from-a-pdf-file-using-itextsharp/8825884#8825884)）。在我当前的测试环境中，以上内容是逐字复制粘贴的，仅在 RenderText() 覆盖中有所不同，除非`info.GetText()`是适当的占位符字符串，否则不会将 TextChunk 添加到列表中。

占位符提取的片段：

```
PdfReader reader = new PdfReader(fileName);
LocationTextExtractionStrategyEx strat = new LocationTextExtractionStrategyEx();
for (int i = 1; i <= reader.NumberOfPages; i++)
   PdfTextExtractor.GetTextFromPage(reader, i, strat); 
```

本机矢量图像类型是 WMF，可以插入到占位符文本的绝对位置。要对列表中的第一个占位符执行此操作，则：

```
using (FileStream fs = new FileStream("output.pdf", FileMode.Create, FileAccess.Write, FileShare.None))
{
   using (PdfStamper stamper = new PdfStamper(reader, fs))
   {
      using (Stream wmfStream = new FileStream(@"C:\Paint.wmf", FileMode.Open, FileAccess.Read, FileShare.Read))
      {
         Image replacementVectorImage = Image.GetInstance(wmfStream);
         replacementVectorImage.SetAbsolutePosition(strat.TextLocationInfo[0].TopLeft[0],     strat.TextLocationInfo[0].BottomRight[1]);
         PdfContentByte cb = stamper.GetOverContent(1);
         cb.AddImage(replacementVectorImage);
      }
   }
} 
```

感谢 mkl 和 VahidN 的宝贵意见！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-09T06:12:12.733

*   添加默认图像作为占位符。
*   将您的 xaml 文件导出为图像。
*   现在可以用新图像替换这些默认图像。更多信息在这里：[https ://stackoverflow.com/a/8751517/298573](https://stackoverflow.com/a/8751517/298573)

# c# - 在 C# 中隐藏另一个应用程序的系统托盘

> ID：14225660
> 
> 赞同：2
> 
> 时间：2013-01-08T23:11:02.517
> 
> 标签：c#

好的最后一次尝试，我正在尝试解决 URL 下面详述的问题。我查看了 URL 中详细介绍的文章，但仍然无法隐藏相关图标。有人有什么想法吗？

[http://www.codeproject.com/Articles/10807/Shell-Tray-Info-Arrange-your-system-tray-icons](http://www.codeproject.com/Articles/10807/Shell-Tray-Info-Arrange-your-system-tray-icons)

[http://social.msdn.microsoft.com/Forums/da/vbgeneral/thread/a11faa45-a3ea-4060-8de4-a6bc22e1516d](http://social.msdn.microsoft.com/Forums/da/vbgeneral/thread/a11faa45-a3ea-4060-8de4-a6bc22e1516d)

> > > > 我希望能够隐藏由 Windows 语音识别加载的系统托盘图标（作为 Windows 7、Windows 8 和 Windows Vista 的一部分）。我需要在 C# 中执行此操作，并且过去几天一直在尝试 Google 解决方案，但无济于事。似乎最好的方法是使用以下代码：

//上面定义的NotifyIconData结构

```
private void button1_Click(object sender, EventArgs e)
{
    NOTIFYICONDATA pnid = new NOTIFYICONDATA();
    pnid.uCallbackMessage = 0x800;
    pnid.uFlags = 1;
    pnid.hwnd = ???;
    pnid.uID = 1;
    pnid.szTip = null;
    pnid.uFlags |= 2;
    pnid.hIcon = ???;
    pnid.uFlags |= 4;
    pnid.szTip = "Speech Recognition is listening";

    bool b = Shell_NotifyIcon(2, ref pnid); 
```

Shell_NotifyIcon API 函数（2）的第一个参数是删除。问题是我不知道如何找到带有问号的参数，包括图标句柄。我尝试使用 ExtractIcon 使用窗口语音识别快捷方式指示的可执行文件和任务管理器文件位置 (%windir%\Speech\Common\sapisvr.exe -SpeechUX) 中指示的文件位置，但它告诉我可执行文件有没有关联的图标。我还使用我下载的免费应用程序验证了它，以检查具有该可执行文件的图标，它说的是同样的事情。

我可以使用以下方法获取图标托盘的窗口句柄：

```
 IntPtr hWnd = Win32API.FindWindow("Shell_TrayWnd", null);
    if(hWnd.ToInt32() > 0)
        {
            hWnd = Win32API.FindWindowEx(hWnd, IntPtr.Zero, "TrayNotifyWnd", null);
            if (hWnd.ToInt32() > 0)
            {
                hWnd = Win32API.FindWindowEx(hWnd,IntPtr.Zero, "SysPager", null);
                if (hWnd.ToInt32() > 0)
               {
                    hWnd = Win32API.FindWindowEx(hWnd, IntPtr.Zero, "ToolbarWindow32", null);
                }                    
               // count = Win32API.SendMessage(hWnd, 1048 , 0, 0);
            }
        } 
```

但是，即使有了句柄和图标的计数，我也不知道如何枚举图标句柄。

如果有人可以在 C# 中给我一个可行的解决方案，我很乐意支付咨询费用，就像我说你可以通过加载 Windows 7 和 Windows 8 免费提供的 Windows 语音识别来轻松尝试它，你会看到我的意思的图标。我可以使用 C++ 解决方案，但它必须完全使用托管 C++ (.NET)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-08T23:45:04.430

```
[DllImport("user32.dll", SetLastError = true)]
static extern IntPtr FindWindowEx(IntPtr hWndParent, IntPtr hWndChildAfter, string lpClassName, string lpWindowName);

[DllImport("user32.dll", SetLastError = true)]
static extern IntPtr FindWindow(string lpClassName, string lpWindowName);

static IntPtr GetSystemTrayHandle()
{           
    IntPtr hWndTray = FindWindow("Shell_TrayWnd", null);
    if (hWndTray != IntPtr.Zero)
    {
        hWndTray = FindWindowEx(hWndTray, IntPtr.Zero, "TrayNotifyWnd", null);
        if (hWndTray != IntPtr.Zero)
        {
            hWndTray = FindWindowEx(hWndTray, IntPtr.Zero, "SysPager", null);
            if (hWndTray != IntPtr.Zero)
            {
                hWndTray = FindWindowEx(hWndTray, IntPtr.Zero, "ToolbarWindow32", null);
                return hWndTray;
            }
        }
    }

    return IntPtr.Zero;
} 
```

After you have the window handle, you can choose to iterate through the processes to find the ones that are in the system tray and do whatever work you need with them:

```
using System.Diagnostics;
Process [] processes = System.Diagnostics.Process.GetProcesses();

foreach (System.Diagnostics.Process process in processes)
{
    if (process.MainWindowHandle == hWndTray)
    {
        // ...
    }
} 
```

# dynamic - 结构的动态分配问题

> ID：14225665
> 
> 赞同：0
> 
> 时间：2013-01-08T23:11:34.790
> 
> 标签：dynamic, struct, dynamic-allocation

我正在使用具有`IMAGE_T`自己的 alloc 函数的结构（如下所示，请原谅法语）。

```
typedef struct {
    int nbl;        /* nombre de ligne de l'image */
    int nbc;        /* nombre de colonnes de lâ€™image */
    unsigned char **data;   /* tableau bidim des pixels de lâ€™image */
} IMAGE_T;

IMAGE_T *alloc_image(int nbl, int nbc){
    int taille = nbl*nbc+100;
    IMAGE_T * image;
    image = (IMAGE_T *) calloc(taille, sizeof(unsigned char)); 
    return image;
} 
```

当通过调试器时，它错误地指出：“未处理的异常：0xc0000005：访问冲突读取位置0x00000000。” ..我很确定这与 alloc_image 无法正常运行有关。有什么建议么？

（有关更多信息，在声明一个`IMAGE_T`I 之后，然后使用另一个返回`IMAGE_T *`的函数，该函数本身包含其中的函数`alloc_image`，以分配内存。这有什么问题吗？）

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-08T23:21:39.437

我怀疑您遇到访问冲突的原因是因为您正在尝试使用 calloc() 在分配内存时会将其设为 null 的“数据”成员。

也就是说，我想了解为什么 IMAGE_T 中的“数据”成员是无符号字符 **？为什么不简单地使用 unsigned char *？（然后，alloc_image 必须为 IMAGE_T 分配内存，然后在该分配的结构中为“数据”分配空间。）

# r - R：绘制一个函数，但“较长的对象长度不是较短对象长度的倍数”

> ID：14225666
> 
> 赞同：0
> 
> 时间：2013-01-08T23:11:33.967
> 
> 标签：r, function, plot

我已经在 R 中编写了这个简单的函数

```
> w=c(0.005,0.005,0.006,0.01,0.88,0.03,0.01,0.01,0.005,0.34,0.05)  
> trial<- function(a) {sum(a-w)}  
> trial(0.1)  
[1] 0.996 
```

如您所见，如果我为 a 输入一个值，则此函数可以正常工作，但是我想绘制它，并且与不涉及 sum 的函数不同，以下内容不起作用：

```
> plot(trial) 
```

给我错误：

```
> Error in xy.coords(x, y, xlabel, ylabel, log) :  
  'x' and 'y' lengths differ  
In addition: Warning message:  
In a - w : longer object length is not a multiple of shorter object length 
```

我知道 R 要求一个长度为 11 的向量，但是有没有办法绘制这个函数？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-09T00:22:45.430

我认为问题在于您的功能以及您期望它为您提供什么以及您编码的内容。

`sum(a-w)`将返回一个数字。

因此，当您传递一个向量时（正如`plot.function` 方法和底层`curve`函数所做的那样，它会创建一个序列`seq(0,1,n=101)`（默认情况下）。

现在您的函数`a-w`在对其求和之前创建。因此，只有单个值或长度相同的向量才有意义`w`

```
trial(seq(0,1,length.out = 101))
[1] 38.331
Warning message:
In x - w : longer object length is not a multiple of shorter object length 
```

它给出了答案，但警告你试图做一些可能很愚蠢的事情。

错误来自这样一个事实，即当 R 创建它正在创建的图时

```
plot(seq(0,1,length.out = 101), trial(seq(0,1,length.out = 101)) 
```

这会给你错误。

```
 Error in xy.coords(x, y, xlabel, ylabel, log) : 
 'x' and 'y' lengths differ 
```

所以，问题是你希望你的函数在给定向量时返回什么`a`

应该是`a- sum(w)`吗？在这种情况下，您应该真正重新定义您的功能以反映您想要的

```
trial2 <- function(a) {a - sum(w)} 
```

接着

```
plot(trial2) 
```

会给你一个很好的（如果有点无趣）直线

![在此处输入图像描述](../Images/8ed3bf10c9a73950033c5de394d2d33b.png)

直到你重新定义`w`

```
w <- 'something else'

plot(trial2)
Error in sum(w) : invalid 'type' (character) of argument 
```

这是在函数中依赖全局变量的问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-09T00:28:09.077

我想知道这是否是你想要的：

```
trial<- function(x) {cumsum(x)}
plot(seq_along(w),  trial(w), type="l") 
```

![在此处输入图像描述](../Images/4cef2361b5ad6fee92c225cf14980eaa.png) 虽然只是猜测。如果这是正确的（即使它不是您想要的），那么有两个教训。1）用自然语言充分描述问题；2) 使用返回向量的函数。我认为`cumsum`and`cumprod`函数可能不会在介绍性文本中得到突出显示。并且在这种情况下，当新用户在最大和最小方面的努力失败时`pmin`，`pmax`通常也需要使用它们。

这也可能是您所期望的：

```
trial<- function(x) {cumsum(x-w)}
  plot(seq_along(w),  trial(0.1), type="l") 
```

一个更加参差不齐的情节结果。如果需要平滑度，请搜索`smooth.spline`。

# javascript - d3 操作 html 的最佳方式是什么？

> ID：14225669
> 
> 赞同：14
> 
> 时间：2013-01-08T23:11:43.490
> 
> 标签：javascript, dom, d3.js

我正在使用[**mbostock 很棒的 d3**](http://d3js.org/)进行**简单的 html 渲染**，这是我能想到的最简单的方法，选择一个空的 div 并用 HTML 填充它。

```
d3.select($('#thediv')[0])
  .selectAll('p')
  .data(l).enter()
  .append('p')
  .html(function(d){return 'd3 ' + d;}); 
```

在**Win7 Chrome 中，**我注意到，对于大型数据集，这似乎**很慢。**（20000 个项目为 3.5 秒）

这个例子呈现了一个非常简单（虽然很长）的列表：http: [//jsfiddle.net/truher/NQaVM/](http://jsfiddle.net/truher/NQaVM/)

我尝试了两种解决方案，**可见性切换：**

```
$('#thediv').toggle() 
```

并**写入一个分离的元素：**

```
var p = $('<div>')
d3.select(p[0])...
$('#theparent').append(p) 
```

结果是这样的：

**Firefox：**速度一致（600-700 毫秒）

**Chrome：**切换或分离很快（800 毫秒），否则非常慢（3.5 秒）

**Internet Explorer：**分离速度更快但仍然很慢（1.8 秒），否则非常慢（3.2 秒）

我的问题是：**有更好的解决方案吗？**

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-27T11:50:43.297

通常，在进行 DOM 操作时最终会变慢的两件事是对 DOM 树的修改和浏览器重绘。

使用可见性切换可以避免浏览器在任何现代优化的 DOM 引擎中重绘。不过，您仍然需要为在线修改 DOM 树付出代价。

编辑一个分离的元素会给你带来没有重绘的好处，也不需要为 DOM 的更新付费。

在所有情况下，第二个选项，即外流 DOM 操作，将更快，或者最坏的情况也一样快。浏览器之间速度的相对差异很可能是由于它们的 DOM 和 Javascript 引擎的差异。有一些[基准](https://wiki.mozilla.org/Dromaeo#Viewing_the_Results)可以让您更深入地了解这一点。

除了 DOM 操作本身的速度之外，您还可以开始研究[循环展开](http://www.fatagnus.com/unrolling-your-loop-for-better-performance-in-javascript/)和[其他优化](http://home.earthlink.net/~kendrasg/info/js_opt/)（由 Jeff Greenberg 编写），以尽量减少实际脚本所做的工作。除此之外，您已经做对了。

如果您有兴趣了解有关浏览器内部的更多详细信息，您应该看看[html5rock 上](http://www.html5rocks.com/en/tutorials/internals/howbrowserswork/)关于浏览器内部的长篇文章。[Google 开发人员](https://developers.google.com/speed/articles/javascript-dom)也有一篇不错的文章，关于如何加速网页中的 JavaScript。

# performance - 汇编和硬件级内存获取、处理、分段、偏移、内存寻址范围等的混淆

> ID：14225670
> 
> 赞同：0
> 
> 时间：2013-01-08T23:11:44.933
> 
> 标签：performance

我很困惑学习了一段时间的汇编，并回顾了许多关于它的优秀教程。

除了记住一些指令来做一些你不完全理解的事情之外，我必须说要完全理解它的整个用处是非常困难的。

我想成为一名操作系统开发人员和设计人员，所以我必须了解低级硬件数据处理、内存管理、处理器获取、解码和内存分段、内存使用、位和字节使用、调用堆栈和硬件堆栈，以及硬件本身的机器级程序的机制。

以下是我感到困惑的主要问题：

处理器从 RAM 中获取字节。在编写引导加载程序时，您在编写指令之前“跳转”到一个地址。跳转到内存中的地址后执行的第一条指令，例如移动/数据复制`MOV AL, MOV BL`类型的指令，在 CPU 的流水线上检索不直接在内存中使用的数据。但是，如果指令是从内存中加载/获取的，处理器如何在其管道上生成代码数据段呢？还是我在这里都错了？微处理器在引导加载程序中执行的基本步骤是什么，如果指令全部从内存中获取，CPU如何在不使用内存的情况下从流水线生成代码数据（例如，汇编中的代码段，但数据段和文本段都是指令对于处理器）？

此外，对于比我更有经验的人来说，我的下一个主要问题可能很容易回答：

为什么 x86 和其他架构上的内存/RAM 存储为带有偏移的“段”？对我来说，这比它需要的要复杂得多。为什么所有内存都不能是线性的、寻址的、获取的、存储的和计算的，以及以更直接的方式移入和移出寄存器到存储单元？与让大量寄存器处理基于内存的数据存储和访问的二维分段相比，这不会使架构的说明和理解更容易理解和更直接吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-08T23:15:42.847

它不仅仅是“汇编”与“高级语言”。

真正的问题是“真实”与“受保护”（虚拟内存）模式。

不幸的是，大多数 x86 汇编示例恰好是*DOS*示例。恕我直言，这与当代 32/64 位虚拟内存架构（包括但不限于 x86）几乎没有相关性。

优秀的底漆：

[从头开始编程](http://savannah.nongnu.org/projects/pgubook/)

PS：在大多数现代操作系统（包括 Windows、Linux 和 Mac OS）上，地址空间实际上*是*线性的，x86 事件。x86 段寄存器在很大程度上是 DOS 时代的不合时宜的东西。

如果您有兴趣，这里是 Linux 启动过程的一个很好的概述：

*   [http://www.ibm.com/developerworks/library/l-linuxboot/index.html](http://www.ibm.com/developerworks/library/l-linuxboot/index.html)

# xml - 未解析文本的正则表达式

> ID：14225672
> 
> 赞同：0
> 
> 时间：2013-01-08T23:11:50.963
> 
> 标签：xml, regex, xslt, xml-parsing, xslt-2.0

我有一个 nav.inc 文件，其中包含以下内容：

```
<a href="/index.html" rel="external" ><img src="/images/ns.png" alt="Sample Page"/><span class="title" >Demo</span></a>
<a href="/demo.html" rel="external" ><img src="/images/missions.png" alt="Sample Page"/><span class="title" >Demo2</span></a>
<a href="/mobile.html" rel="external" ><img src="/images/ons.png" alt="Sample Page"/><span class="title" >Demo3</span></a>
.
.
. 
```

等等

我想通过 XSL 为每个列表元素获取节点和 @href 的值，并构建一个类似的结构

```
<li><a href="/index.html" rel="external">Demo</a></li>
.
. 
```

我知道这可以这样做：

```
<xsl:variable name="vText" select="unparsed-text('nav.inc')"/> 
```

和类似的东西：

```
<xsl:variable name="vExtracted" as="xs:token*">
  <xsl:analyze-string select="$vText" regex="" flags="m">
    <xsl:matching-substring>
      <xsl:value-of select="regex-group(1)"/>
    </xsl:matching-substring>
  </xsl:analyze-string>
</xsl:variable> 
```

然后像

```
<xsl:for-each select="$vExtracted">
  <li><xsl:value-of select="."/></li>
</xsl:for-each > 
```

我不擅长正则表达式。高度赞赏解决此问题的任何帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-09T09:02:07.687

如果您的输入如您所建议的那样有规律，那么您就不需要自己解析它的麻烦，您可以使用 XML 解析器更轻松地完成它。（如果它不像你建议的那样有规律，那么你就不想麻烦了......）。唯一的小障碍是缺少一个封闭的最外层元素，这可以很容易地解决，只需将提供的文本连接到 中`<o>...</o>`，或者将其作为外部解析实体包含到包装 XML 文档中。

然后，转换变得与单线一样接近：

```
<xsl:template match="a">
  <li><a href="{@href}" rel="{@rel}"><xsl:value-of select="."/></a></li>
</xsl:template> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-08T23:22:42.807

我相信可以公平地说，[这个问题](https://stackoverflow.com/questions/1732348/regex-match-open-tags-except-xhtml-self-contained-tags)对你来说是最好的答案。使用 XML 解析器。

如果您的案例**非常**简单，可以通过以下方式解决：

```
<a href="(.*?)" rel="external" ><img src=".*?" alt="Sample Page"/><span class="title" >(.*?)</span></a> 
```

其中，在您的样本上运行搜索和替换，替换`$1,$2`为我：

```
/index.html,Demo
/demo.html,Demo2
/mobile.html,Demo3 
```

也许在这种情况下，但是如果要考虑的复杂性比您的示例所表明的要复杂得多，那么正则表达式就无法解析 HTML。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-09T04:38:07.257

根据您的 XSLT 2.0 处理器，您可以使用扩展函数来解析`unparsed-text`（包装在一个元素中以使其格式正确）并且根本不使用正则表达式......

**导航公司**

```
<a href="/index.html" rel="external" ><img src="/images/ns.png" alt="Sample Page"/><span class="title" >Demo</span></a>
<a href="/demo.html" rel="external" ><img src="/images/missions.png" alt="Sample Page"/><span class="title" >Demo2</span></a>
<a href="/mobile.html" rel="external" ><img src="/images/ons.png" alt="Sample Page"/><span class="title" >Demo3</span></a> 
```

**XSLT 2.0**（使用 Saxon-EE 9.4 测试并使用自身作为输入）

```
<xsl:stylesheet version="2.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform" 
    xmlns:saxon="http://saxon.sf.net/" extension-element-prefixes="saxon">
    <xsl:output indent="yes"/>
    <xsl:strip-space elements="*"/>

    <xsl:variable name="nav.inc">
        <xsl:text>&lt;doc></xsl:text>
        <xsl:value-of select="unparsed-text('file:///C:/so_test/nav.inc')"/>
        <xsl:text>&lt;/doc></xsl:text>
    </xsl:variable>

    <xsl:template match="/">
        <results>
            <xsl:for-each select="saxon:parse($nav.inc)/*/a">
                <li>
                    <xsl:copy>
                        <xsl:copy-of select="@*"/>
                        <xsl:value-of select="."/>
                    </xsl:copy>
                </li>
            </xsl:for-each>
        </results>
    </xsl:template>

</xsl:stylesheet> 
```

**XML 输出**

```
<results>
   <li>
      <a href="/index.html" rel="external">Demo</a>
   </li>
   <li>
      <a href="/demo.html" rel="external">Demo2</a>
   </li>
   <li>
      <a href="/mobile.html" rel="external">Demo3</a>
   </li>
</results> 
```

如果您想进行更复杂的转换，它也可以用作带有单独模板的`xsl:apply-templates`( )。`<xsl:apply-templates select="saxon:parse($nav.inc)/*"/>``a`

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-09T01:27:47.047

```
 <xsl:variable name="vText" select="unparsed-text($source1,$encoding)"/>
          <xsl:variable name="vExtracted" as="element(group)*">
            <xsl:analyze-string select="$vText" regex="&#34;([^&lt;]*)&quot; rel(.*)&gt;([^&lt;]*)&lt;/span&gt;" flags="m">
              <xsl:matching-substring>
                 <group>
                     <x><xsl:value-of select="regex-group(1)"/></x>
                     <y><xsl:value-of select="regex-group(3)"/></y>
                  </group>
              </xsl:matching-substring>
            </xsl:analyze-string>
          </xsl:variable>

          <xsl:for-each select="$vExtracted">
          &lt;li&gt;&lt;a href="<xsl:value-of select="x"/>".*&gt;<xsl:value-of select="y"/>&lt;/a&gt;&lt;/li&gt;
          </xsl:for-each > 
```

# python - 将 DataFrame 列表保存到多表 Excel 电子表格

> ID：14225676
> 
> 赞同：113
> 
> 时间：2013-01-08T23:12:25.383
> 
> 标签：python, pandas, openpyxl

如何将 DataFrame 列表导出到一个 Excel 电子表格中？
状态的文档[`to_excel`](http://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.to_excel.html)：

> 备注
> 如果传递现有的 ExcelWriter 对象，则工作表将添加到现有工作簿中。这可用于将不同的 DataFrames 保存到一个工作簿
> 
> `writer = ExcelWriter('output.xlsx')`
> `df1.to_excel(writer, 'sheet1')`
> `df2.to_excel(writer, 'sheet2')`
> `writer.save()`

在此之后，我想我可以编写一个函数，将 DataFrames 列表保存到一个电子表格中，如下所示：

```
from openpyxl.writer.excel import ExcelWriter
def save_xls(list_dfs, xls_path):
    writer = ExcelWriter(xls_path)
    for n, df in enumerate(list_dfs):
        df.to_excel(writer,'sheet%s' % n)
    writer.save() 
```

但是（有两个小 DataFrames 的列表，每个 DataFrames 都可以`to_excel`单独保存），引发了一个异常*（编辑：删除了追溯）*：

```
AttributeError: 'str' object has no attribute 'worksheets' 
```

大概我没有[`ExcelWriter`](http://www.nullege.com/codes/search?cq=openpyxl.writer.excel.ExcelWriter)正确调用，我应该怎么做才能做到这一点？

* * *

## 回答 #1

> 赞同：165
> 
> 时间：2013-01-08T23:27:40.787

你应该使用 pandas 自己的`ExcelWriter`类：

```
from pandas import ExcelWriter
# from pandas.io.parsers import ExcelWriter 
```

然后该`save_xls`功能按预期工作：

```
def save_xls(list_dfs, xls_path):
    with ExcelWriter(xls_path) as writer:
        for n, df in enumerate(list_dfs):
            df.to_excel(writer,'sheet%s' % n)
        writer.save() 
```

* * *

## 回答 #2

> 赞同：36
> 
> 时间：2018-06-29T17:13:46.440

如果有人需要使用数据框字典的示例：

```
from pandas import ExcelWriter

def save_xls(dict_df, path):
"""
Save a dictionary of dataframes to an excel file, with each dataframe as a separate page
"""

    writer = ExcelWriter(path)
    for key in dict_df:
        dict_df[key].to_excel(writer, key)

    writer.save() 
```

例子： `save_xls(dict_df = my_dict, path = '~/my_path.xls')`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2020-12-10T11:10:36.927

如果数据框中有一些不支持的字符类型，有时可能会出现问题（编写包含 unicode 的 excel 文件）。为了克服它，我们可以使用“ **xlsxwriter** ”包，如下所示：

对于以下代码：

```
from pandas import ExcelWriter
import xlsxwriter
writer = ExcelWriter('notes.xlsx')
for key in dict_df:
        data[key].to_excel(writer, key,index=False)
writer.save() 
```

我收到错误为“IllegalCharacterError”

有效的代码：

```
%pip install xlsxwriter
from pandas import ExcelWriter
import xlsxwriter
writer = ExcelWriter('notes.xlsx')
for key in dict_df:
        data[key].to_excel(writer, key,index=False,engine='xlsxwriter')
writer.save() 
```

# sql - 结合 UNION 和 NOT EXISTS 的 SQL Server 查询

> ID：14225685
> 
> 赞同：0
> 
> 时间：2013-01-08T23:13:26.200
> 
> 标签：sql, sql-server

我想查找`UNION`两个 select 语句中不存在但存在于 table 中的记录`t1`。我就是这样做的。有没有更好的方法来做到这一点？

```
UPDATE t1
SET    t1.col1 = 0
WHERE  NOT EXISTS (
    SELECT tab2.col2
    FROM   tab2,
           tab3
    WHERE  NOT EXISTS (SELECT *
                       FROM   tab4,
                              tab5
                       WHERE  tab2.col3 = tab4.col3
                              AND tab4.col4 = tab5.col4
                              AND tab5.col5 IN ( 'TT', 'YY' ))
           AND tab3.col2 = tab2.col2
           AND tab2.col2 NOT IN(SELECT DISTINCT col2
                                FROM   tab2_uk WITH (nolock))
           AND t1.col2 = tab3.col2
           AND tab3.date IS NULL
           AND ( Isnull(tab2.pos, 0) > 0
                  OR Isnull(tab2.op, 0) > 0
                  OR Isnull(tab2.co, '-1') <> '-1' )
    UNION
    SELECT tab6.col2
    FROM   dbo.tab6 WITH (nolock),
           dbo.tab3 WITH (nolock)
    WHERE  NOT EXISTS (SELECT *
                       FROM   tab4,
                              tab5
                       WHERE  tab6.col3 = tab4.col3
                              AND tab4.col4 = tab5.col4
                              AND tab5.col5 IN ( 'TT', 'YY' ))
           AND t1.col2 = tab3.col2
           AND tab3.col2 = tab6.col2
           AND tab6.po > 0
           AND tab3.date IS NULL) 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-08T23:49:19.930

> 我想查找两个 select 语句的 UNION 中不存在的记录

由于`UNION`唯一删除了两个子查询中的*完整重复项*`NOT EXISTS`，因此您可以跳过此（可能很昂贵）步骤，只需检查每个单独的子查询。`(NOT) EXISTS`无论如何，这往往是检查存在的最快方法。

我还将您的 s 重写`JOIN`为现代 ANSI 语法。否则我保持不变：

```
UPDATE t1
SET    t1.col1 = 0
WHERE  NOT EXISTS (
     SELECT tab2.col2
     FROM   tab2
     JOIN   tab3 ON tab3.col2 = tab2.col2
     WHERE  NOT EXISTS (
        SELECT *
        FROM   tab4
        JOIN   tab5 ON tab5.col4 = tab4.col4
        WHERE  tab2.col3 = tab4.col3
        AND    tab5.col5 IN ('TT', 'YY')
        )
     AND tab2.col2 NOT IN(SELECT DISTINCT col2
                          FROM   tab2_uk WITH (nolock))
     AND tab3.col2 = t1.col2
     AND tab3.date IS NULL
     AND ( Isnull(tab2.pos, 0) > 0
        OR Isnull(tab2.op, 0) > 0
        OR Isnull(tab2.co, '-1') <> '-1' )
     )
AND  NOT EXISTS (
        SELECT tab6.col2
        FROM   dbo.tab6 WITH (nolock)
        JOIN   dbo.tab3 WITH (nolock) ON tab3.col2 = tab6.col2
        WHERE  NOT EXISTS (
           SELECT *
           FROM   tab4
           JOIN   tab5 ON tab5.col4 = tab4.col4
           WHERE  tab4.col3 = tab3.col3
           AND    tab5.col5 IN ('TT', 'YY')
           )
        AND tab6.po > 0
        AND tab3.col2 = t1.col2
        AND tab3.date IS NULL
        ) 
```

# html - 下拉菜单引导代码

> ID：14225691
> 
> 赞同：0
> 
> 时间：2013-01-08T23:13:48.370
> 
> 标签：html, jquery-ui, css, twitter-bootstrap

我正在使用此示例开发我的网站 [http://twitter.github.com/bootstrap/examples/hero.html](http://twitter.github.com/bootstrap/examples/hero.html)在 twitter bootstrap 网站上工作， 但问题是当我减小浏览器大小时，我看到了菜单图标，但是当我单击它我没有看到下拉菜单如何修复它在下面提供我的代码

[http://jsfiddle.net/LCJ2V/](http://jsfiddle.net/LCJ2V/)

```
<a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </a> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-09T05:39:47.490

一个问题是，根据您的 jsfiddle 中的代码，您没有正确加载外部资源。

对于 boostrap .js 文件，试试这个：

```
<script src="http://twitter.github.com/bootstrap/assets/js/bootstrap-alert.js"></script>
<script src="http://twitter.github.com/bootstrap/assets/js/bootstrap-modal.js"></script>
<script src="http://twitter.github.com/bootstrap/assets/js/bootstrap-dropdown.js"></script>
<script src="http://twitter.github.com/bootstrap/assets/js/bootstrap-scrollspy.js"></script>
<script src="http://twitter.github.com/bootstrap/assets/js/bootstrap-tab.js"></script>
<script src="http://twitter.github.com/bootstrap/assets/js/bootstrap-tooltip.js"></script>
<script src="http://twitter.github.com/bootstrap/assets/js/bootstrap-popover.js"></script>
<script src="http://twitter.github.com/bootstrap/assets/js/bootstrap-button.js"></script>
<script src="http://twitter.github.com/bootstrap/assets/js/bootstrap-collapse.js"></script>
<script src="http://twitter.github.com/bootstrap/assets/js/bootstrap-carousel.js"></script>
<script src="http://twitter.github.com/bootstrap/assets/js/bootstrap-typeahead.js"></script> 
```

另一个问题是 jsfiddle 的`.window_label`元素覆盖了导航栏的右上角。使用谷歌浏览器摆脱它的一种方法是使用 html 检查器并删除`.window_label`节点以获得导航栏按钮的无阻碍视图。

# jquery - 如何使用 jQuery Mobile 和 PhoneGap 将 HTML 文件加载到 data-role=page 中？

> ID：14225695
> 
> 赞同：1
> 
> 时间：2013-01-08T23:14:11.293
> 
> 标签：jquery, cordova, jquery-mobile

我想要这个：使用 jquery mobile 和 phonegap 将 html 文件加载到 data-role=page 中：我的项目有很多带有独立页面的小 HTML 文件。

我用：

索引.html：

```
<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <title>
            Inicio :: Autenticacion
        </title>
        <meta name="viewport" content="width=device-width,height=device-height, initial-scale=1">
        <link rel="stylesheet" href="jsmobile/jquery.mobile-1.2.0.min.css" type="text/css">
        <script src="jsmobile/jquery.js" type="text/javascript"></script>
        <script src="jsmobile/jquery.mobile-1.2.0.min.js" type="text/javascript"></script>
        <script language="javascript" type="text/javascript">

$(document).ready(function() {
  $('#boton').bind('click', function(event) {
    $.mobile.loadPage("Fichero/index.html",{pageContainer:$("#container1")});

  });
});

        </script>
    </head>
    <body>
        <div data-role="page" id="container0">
            <div data-role="content">
         <a  id="boton" >Change Page</a>
            </div>
        </div>

        <div  id="container1">
        </div>

    </body>
</html> 
```

文件：Fichero/index.html

```
<div date-role="page" id="micro">
    <div data-role="header" >
        <h1>Test Heas</h1>
    </div><!-- /header -->
    <div data-role="content"  > 
     Test here..
    </div><!-- /content -->
    </div> 
```

当用户单击更改页面链接时，我想从容器 1 中的 Fichero/index.html 加载 html 内容，但它不起作用。

它将内容加载到 DIV id="container1" 和 DOM 中，但不显示/刷新（就像隐藏一样）。

做一个简单的 html 文件外部加载和刷新 DOM 并显示 HTML 代码加载的方法是什么？

提前致谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-09T00:01:56.647

您的 html 与 jquery mobile 所需的结构不匹配，因此您什么也看不到。

任何应该可见的 html 都需要在 data-role="content" div 中，在 data-role="page" div 中

如果您只想加载外部 html，只需进行 ajax 调用（但我认为正确的 jQuery 移动方式在转换方面更好。例如：

```
<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title> Inicio :: Autenticacion </title>
    <meta name="viewport" content="width=device-width,height=device-height, initial-scale=1">
    <link rel="stylesheet" href="http://code.jquery.com/mobile/1.2.0/jquery.mobile-1.2.0.min.css" />
    <script src="http://code.jquery.com/jquery-1.8.2.min.js"></script>
    <script src="http://code.jquery.com/mobile/1.2.0/jquery.mobile-1.2.0.min.js"></script>
    <script>
        $(document).ready(function() {
            $('#boton').bind('click', function(event) {
                $.get('Fichero/index.html').success(function(html) {
                    $('#container1').html(html);
                });

            });
        });

    </script>
</head>
<body>
    <div data-role="page" id="container0">
        <div data-role="content">
            <a  id="boton" >Change Page</a>

            <!--
            Place the Container here because
            jQuery Mobile data-role="page" defines a browser fullscreen page 
            (the dataroles are rules for formating a page and there can be only one visible page)
            -->
            <div  id="container1"></div>
        </div>
    </div>

</body> 
```

# eclipse - PyDev 单元测试集运行目录

> ID：14225697
> 
> 赞同：3
> 
> 时间：2013-01-08T23:14:22.003
> 
> 标签：eclipse, pydev

我有一个位于路径中的 PyDev 单元测试模块：

```
$(PYDEV_PROJECT_ROOT)/tests/my_unit_test.py 
```

我正在尝试使用 Eclipse PyDev 的单元测试工具。我的单元测试必须像这样读取配置文件：

```
(foo,bar,baz) = myModule.readOptimizationConfig("tests/optimization_config_file.cfg") 
```

但是，这不起作用，因为 PyDev 在运行之前进入了“tests”目录，因此在给 readOptimizationConfig 的路径中指定“tests/”会使其尝试加载

```
$(PYDEV_PROJECT_ROOT)/tests/tests/optimization_config_file.cfg 
```

但是，我还需要使用命令行中的 nosetests 运行这些测试。这是因为，为了为我的项目运行所有测试，而不是在默认提供的特定文件中运行它们的选项，最简单的解决方案是只使用“nosetests”命令，而不是弄乱 Eclipse启动配置。但是，nosetests 需要从 $(PYDEV_PROJECT_ROOT) 根目录运行，因此需要在路径中指定“tests/”。

有没有办法强制 eclipse 从项目根目录运行单元测试，以便我传递给 readOptimizationConfig 的路径适用于这两种方法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-12T13:24:57.273

可以在 PyDev 中执行此操作，但您必须针对每个启动配置执行此操作，因此有点无聊。

无论如何，您首先尝试作为包含单元测试的脚本运行（就像您通常那样 - 例如绿色“运行”箭头按钮旁边的下拉菜单，然后运行为... - Python单元测试）。由于您缺少`cfg`文件，此启动将失败。现在转到运行配置（运行下拉菜单 - 运行配置），打开参数选项卡并在工作目录下的底部输入您想要的路径（或使用工作区...按钮浏览它）。例如，如果您想从项目根目录运行并且您的项目名为`awesome-project`，您可以编写：

```
${workspace_loc:awesome-project} 
```

现在您应该有一个有效的启动配置，您可以从 Run 和 Debug 菜单中使用它。我有时将这些配置重命名为立即引人注目的名称，例如“awesome-project TEST”。

# c++ - 消息框操作系统。独立的

> ID：14225698
> 
> 赞同：-1
> 
> 时间：2013-01-08T23:14:26.767
> 
> 标签：c++, platform-independent

我想创建一个 Assert 函数，它在不打开控制台的情况下在新窗口中显示一条消息。该函数需要独立于操作系统，并且尽可能不使用 c++ 外部库。

```
#include <string>
#include <sstream>
#ifdef WIN32
#include <windows.h>    // include windows header, for Windows Based Sistems.
#else
// ...
#endif

void Assert (bool cond,const char* file,int line,const char* desc)
{
      if (cond) return;  // No Assertion.
#ifdef WIN32
      // Use MessageBox function to display the information.
      // For Example ...
      std::stringstream st; 
      st << "There Was An Error At Runtime ! \n";
      st << "File: " << file << "\n";
      st << "Line: " << line << "\n";
      st << "Description: " << desc << "\n";
      st << "Do You Want To Continue Running the Application?\n";
      if (MessageBox (NULL,"Unexpected Error", str.str ().c_str (), MB_YESNO) == IDNO)
          exit (-1);
#else
      // Do Something, but in Unix Base Systems.
#endif
}
#define assert(condition,description)  \
            __assert__ (condition,__FILE__,__LINE__,description) 
```

需要 C++ 代码在其他操作系统中输出 MessageBox

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-08T23:17:46.030

C++ 标准不包括 GUI 操作。您*将*需要使用为您想要的平台提供 GUI 服务的外部库。

所以你所要求的是不可能的。对不起。

# javascript - javascript：将函数分配为回调和变量范围

> ID：14225699
> 
> 赞同：3
> 
> 时间：2013-01-08T23:14:42.223
> 
> 标签：javascript

所以，这就是交易。我正在使用 onclick 事件来触发一个函数，因此每次单击时，您都将在 div 原始 innerHTML 和另一个变量之间切换。当我将 testfunction 分配为回调时，它可以工作。这是代码：

```
var c = '';

function testfunction()
{
    var a = this.innerHTML;

    var b = 'blah';

    if (a !== b)
    {
        c = a;
        return this.innerHTML = b;
    }
    else
    {
        return this.innerHTML = c;
    }

    window.onload = function()
    {
         document.getElementById('rightcontent').onclick = testfunction;
    } 
```

我知道 c 保留了它的价值，因为它是全球范围的。但是我不明白为什么当我将函数放入匿名回调时 c 会返回 undefined ：

```
 windows.onload = function()
    {
    document.getElementById('rightcontent').onclick = function()
    {
         this.innerHTML = testfunction();
    }
    } 
```

这没有任何意义，我只是在胡闹......但我想知道引擎盖下发生了什么。

抱歉，如果这在其他地方有所涉及，我已经查看了一些帖子以找到我的答案，但我找不到它。

提前致谢 ：-）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-08T23:26:02.687

> 我知道 c 保留了它的价值，因为它是全球范围的。但是我不明白为什么当我将函数放入匿名回调时 c 会返回 undefined ：

在您的第二个片段中，`this`不等于`#rightcontent`，它等于`window`。`window.innerHTML`是未定义的，所以第一个分支在你的`if/else`块中。

`c`被分配`undefined`，并被`undefined`返回。

[`call`](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Function/call)您可以调用方法并使用or指定特定上下文[`apply`](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Function/apply)：

```
document.getElementById('rightcontent').onclick = function () {
    this.innerHTML = testfunction.call(this);
} 
```

**示例：http:** [//jsfiddle.net/dySA5/](http://jsfiddle.net/dySA5/)

您的第一个代码段没有表现出这种行为的原因是因为在`this`调用该方法时浏览器设置为被点击的元素。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-08T23:48:49.763

[http://jsfiddle.net/2aDJS/4/](http://jsfiddle.net/2aDJS/4/)

我清理并 jQuerified 您的示例，使其更易于阅读：

```
var c = '';

function testfunction() {
  console.log(this)
  var a = this.innerHTML;

  var b = 'blah';

  if (a !== b) {
    c = a;
    this.innerHTML = b;
  } else {
    this.innerHTML = c;
  }
}

$(document).ready(function () {
  $('#rightcontent').click(function () {
    testfunction.call(this);
    //testfunction();
  });

  //$('#rightcontent').click(testfunction);
}) 
```

您看到包含在函数中的函数调用失败的原因是，当您这样做时范围会发生变化。`this`被解释为事件处理程序上的事件诱导元素。如果您在事件处理程序中调用一个函数并希望它引用它，`this`它将保持不变，除非您使用`function.call(scope)`.

# jquery - jQuery：在列表中显示新字段

> ID：14225702
> 
> 赞同：0
> 
> 时间：2013-01-08T23:14:55.720
> 
> 标签：jquery

每次按下按钮时，我都尝试显示最多 10 个新字段。

我目前只有：

```
$('.add_field').live('click', function(){
    $(this).next('.field1').fadeIn();
    return false;
}); 
```

HTML：

```
 <fieldset>
     <label>Label Name</label>
     <input id="field1" name="field1" type="text">
</fieldset>
<fieldset>
     <label>Label Name</label>
     <input id="field2" name="field2" type="text">
</fieldset>
...
<a class="add_field" href="#">Add Field</a> 
```

我不需要动态添加只显示它们的字段，它们都在刚刚隐藏的 HTML 中。我不确定如何在每次按下按钮时仅显示列表中的下一个字段。这些字段中的每一个都有唯一的数字，但我不确定如何在每次按下按钮时增加计数以显示它们。

提前致谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-08T23:23:05.750

使用已发布的 HTML - [**DEMO**](http://jsfiddle.net/pPbv2/)

```
$('.add_field').on('click', function(e){
    e.preventDefault();
    $('fieldset:hidden').eq(0).fadeIn();
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-08T23:18:59.573

## 更新

这是我的代码的更新版本，适合您最近发布的 HTML 布局。这个想法保持不变：点击找到第一个隐藏元素并显示它。

```
$('.add_field').click(function(evt){
  $("fieldset:hidden:eq(0)").fadeIn();
  evt.preventDefault();
}); 
```

* * *

## 以前的

您可以使用[`:hidden`](http://api.jquery.com/hidden-selector/)选择器和[`.nextAll()`](http://api.jquery.com/nextAll/).

```
$('.add_field').click(function(evt){
  $(this).nextAll(':hidden').eq(0).fadeIn();
  evt.preventDefault();
}); 
```

只要存在这种隐藏的下一个兄弟姐妹。

# graphics - 如何在unity3d中创建向下的椭圆圆路径？

> ID：14225708
> 
> 赞同：0
> 
> 时间：2013-01-08T23:15:16.857
> 
> 标签：graphics, 3d, unity3d

我是unity3d的新手，我想为动画对象制作一条路径。路径必须是#椭圆形路径#或者#弹簧形状路径#我认为有一种方法可以根据数学方程来绘制这条路径是真的吗？或者我应该使用 3dmax 绘制它。这个问题的任何帮助或相关教程？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-09T01:35:54.363

这是在游戏中用鼠标绘制路径的[有用链接](http://answers.unity3d.com/questions/228138/draw-path-to-follow.html)。

如果您想以编程方式绘制弹簧，可以使用 Catmullrom 或 Bezier 样条：

```
double bezier(double t, double p0,double p1,double p2,double p3){
    double t2 = t*t;
    double t3 = t2 * t;
    return (0.16667 *(  t3  *   (-p0 +  3 * p1 + -3 * p2 + p3) +    \
                    t2  *   (3 * p0 + -6 * p1 + 3 * p2) +       \
                    t   *   (-3*p0 + 3*p2) +                    \
                    1   *   (p0 + 4*p1 + p2)));
}
double catmullrom(double t, double p0,double p1,double p2,double p3){
    double t2 = t*t;
    double t3 = t2 * t;
    return (0.5 *(      (2 * p1) + (-p0 + p2) * t +(2*p0 - 5*p1 + 4*p2 - p3) * t2 +(-p0 + 3*p1- 3*p2 + p3) * t3));
} 
```

输入 p0,p1,p2,p3 是特定段的 4 个控制点。要查看螺旋构建示例，[可以在我的 Github 页面上找到此代码](https://github.com/Jerdak/SplineDemo/blob/master/Splines/Splines.cpp)的其余部分。特别查看**BuildPath()**以了解如何使用这些函数来构建连续路径。我不喜欢链接到外部帐户，但我的使用示例对于 SO 答案来说有点太大了。

如果你想画一个椭圆，我能想到的最简单的方法是求解基本方程并建立一个点环：

```
List<Vector3> pts = new List<Vector3>();
for(float x=-2.0f; x<2.0f;x+=0.1){
    y = sqrt( (1-x^2/a^2) * b^2 );//from eq. x^2/a^2 + y^2/b^2=1; 
    pts.Add(new Vector3(x,y,0));
} 
```

该代码假设您有一个[水平主轴](http://www.mathwarehouse.com/ellipse/equation-of-ellipse.php)，其中“a”是水平主轴的半径，“b”是垂直短轴的半径。首先沿 X/Y 轴构建椭圆，然后应用您希望定位椭圆的任何变换。

或者，我没有这方面的代码，您可以使用[一般参数方程](http://en.wikipedia.org/wiki/Ellipse#General_parametric_form)来生成一个已经偏离原点的旋转椭圆。

# java - 对话框关闭后 JFileChooser 挂起

> ID：14225711
> 
> 赞同：0
> 
> 时间：2013-01-08T23:15:41.540
> 
> 标签：java, eclipse, swing, io

我想首先说我是摇摆新手。因此，如果使用 JFileChooser 选择目录，我要做的所有事情。我可以打开、导航和选择一个目录。当我按下任何关闭对话框的按钮时，问题就出现了。当我这样做时，我的应用程序就会冻结。当它冻结时，只有对话框返回的面板变成白色。当我使用调试器时，在对话框关闭并且未到达 if 语句之后立即发生挂起。如果这有所不同，我也在 E​​clipse 插件中执行此操作。特别是它托管在视图内部。下面的代码：

```
public class TexturePacker extends ViewPart {
    public void createPartControl(Composite parent) {
        Composite composite = new Composite(parent, SWT.EMBEDDED | SWT.NO_BACKGROUND);
        frame = SWT_AWT.new_Frame(composite);
        frame.add(new TexturePackerPanel(frame));
    }
}

public class TexturePackerPanel extends JPanel {
    //This is called from initialize(), which is called in the constructor
    private void initializeConfigPanel() {
        JPanel configPanel = new JPanel();
        JTextBoxk outputDirectory = new JTextField();
        configPanel.add(inputDirectory);
        JButton fileButton = new JButton("Folder");
        fileButton.addMouseListener(new MouseListener(){
            @Override
            public void mouseClicked(MouseEvent arg0) {
                JFileChooser file = new JFileChooser(outputDirectory.getText());
                file.setDialogTitle("Select Output Directory");
                file.setDialogType(JFileChooser.OPEN_DIALOG);
                file.setFileSelectionMode(JFileChooser.DIRECTORIES_ONLY);
                int returnVal = file.showDialog(frame, "Choose");
                if(returnVal == JFileChooser.APPROVE_OPTION) {
                    outputDirectory.setText(file.getSelectedFile().getAbsolutePath());
                }
            }
            //Other blank MouseListener methods//       
        });
        configPanel.add(fileButton);
    }
} 
```

系统信息：
Windows 8 64bit
Java 7
Eclipse 4.2 SR1 EE Edition

我很确定这个问题是由于 Swing 在 Eclipse 中不能很好地运行造成的。我已经使用 SWT 目录对话框成功地让它工作了。所以我打算将整个 JPanel 转换为 SWT。感谢大家的帮助，我现在对 Swing 的工作原理有了更多的了解。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-09T14:58:10.023

为此，您确实应该使用 ActionListener 而不是 MouseListener。

除此之外，我认为这是一个线程问题。[您应该在swing](http://docs.oracle.com/javase/tutorial/uiswing/concurrency/initial.html)中阅读有关并发的文档。

用`JFileChooser`_

```
SwingUtilities.invokeLater(new Runnable() {
public void run() {
    \\Your JFileChooser bit
} 
```

**编辑1：**

我已经运行了以下稍微编辑过的代码，但无法重现您的问题

```
public static void main(final String[] args){

    SwingUtilities.invokeLater(new Runnable() {
        @Override
        public void run() {

            final JPanel configPanel = new JPanel();
            final JButton fileButton = new JButton("Folder");
            final JFrame frame = new JFrame();
            frame.setVisible(true);
            frame.add(configPanel);
            //      JButton outputDirectory = new JButton("XX");
            fileButton.addActionListener(new ActionListener() {

                @Override
                public void actionPerformed(final ActionEvent arg0) {
                    final JFileChooser file = new JFileChooser();
                    file.setDialogTitle("Select Output Directory");
                    file.setDialogType(JFileChooser.OPEN_DIALOG);
                    file.setFileSelectionMode(JFileChooser.DIRECTORIES_ONLY);

                    final int returnVal = file.showDialog(frame, "Choose");
                    if(returnVal == JFileChooser.APPROVE_OPTION) {
                        // outputDirectory.setText(file.getSelectedFile().getAbsolutePath());
                        System.out.println(returnVal);
                    }

                }
            });
            configPanel.add(fileButton);
        }
    });
} 
```

# python - Python 中 AST 的抽象语法：“FunctionDef”和“参数”的问题

> ID：14225715
> 
> 赞同：4
> 
> 时间：2013-01-08T23:15:49.380
> 
> 标签：python, grammar, abstract-syntax-tree

我正在尝试使用 Python 3 中的[ast 模块](http://docs.python.org/3.2/library/ast.html)来解析一些 Python 代码。现在我只编写一个简单的节点访问者来输出原始代码。

我很难将 AST 的某些节点转换为实际代码。

[关于http://docs.python.org/3.2/library/ast.html#abstract-grammar](http://docs.python.org/3.2/library/ast.html#abstract-grammar)的语法，我不明白**`expr? returns`**应该是什么

```
FunctionDef(identifier name, arguments args,
            stmt* body, expr* decorator_list, expr? returns) 
```

查看完整的 Python 语法 ( [http://docs.python.org/3.2/reference/grammar.html](http://docs.python.org/3.2/reference/grammar.html) ) 并没有帮助我理解可选元素可能是什么。

同样对于函数（或 lambda 函数）声明的参数：

```
arguments = (arg* args, identifier? vararg, expr? varargannotation,
                     arg* kwonlyargs, identifier? kwarg,
                     expr? kwargannotation, expr* defaults,
                     expr* kw_defaults) 
```

我可以识别：

*   `arg* args`和`expr* defaults`：“基本”参数及其默认值
*   `identifier? vararg`and `expr? varargannotation`: 用于捕获可变数量的参数（+注解），例如`def f(first, *others : 'annotation'):`
*   `identifier? kwarg`和`expr? kwargannotation`: 命名参数也是一样的

但我不知道是什么**`arg* kwonlyargs`**和**`expr* kw_defaults`**

我正在寻找一些将使用这三个功能的示例代码，以便我可以理解它们的含义/用途。

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2018-11-07T13:33:44.790

老问题，但仍然开放。所以：

*   **`expr? returns`**用于函数的返回类型提示。例如

    ```
    def greeting(name) -> str:
        return 'Hello ' + name 
    ```

    在对象的字段中生成一个`ast.Name`实例。有关类型提示的更多信息，请参阅[文档](https://docs.python.org/3/library/typing.html)和[PEP 484](https://www.python.org/dev/peps/pep-0484)。`id = 'str'``result``FunctionDef`

*   正如评论中提到的，**`arg* kwonlyargs`**是[关键字参数](https://www.python.org/dev/peps/pep-3102/)，即出现在可变参数之后的关键字参数。（这背后的原因是，您可能希望定义一个同时接受可变数量参数和可选关键字参数的函数。出现在可变参数之前的 Kwarg 不能是可选的，因为您必须在在附加可变参数之前调用站点。）
*   **`expr* kw_defaults`**是每个 kwonlyarg 的默认值列表。如果 kwonlyarg 没有默认值，则它`None`在列表中由 表示。

# qt - 如何设置双击“esc”快捷键？

> ID：14225722
> 
> 赞同：0
> 
> 时间：2013-01-08T23:16:46.863
> 
> 标签：qt

我正在使用qt，我想知道是否可以设置双击`Esc`快捷方式？我想要一个效果，当我按`Esc`两次时，一个函数被调用。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-09T02:37:40.807

在每次按下 ESC 时

```
PRESSED+=1; 
```

如果在任何下一次按下

```
 if (PRESSED >=2) {
        //fire event here
        ...
        // Dont forget to reset PRESSED for next usage
       PRESSED=0;
      } 
```

如果在 1-3 秒后`PRESSED`不等于`"2"`（如果用户按下一次），则将其重置`0;`为单次按下并触发事件。

对于您不想触发 SinglePressEvent 的情况，以防双按只需将单按事件延迟 1-2 秒以等待第二次按下。如果第二次按下未出现触发单次按下事件。

# ruby-on-rails - 与 Rails 资源的主干同步

> ID：14225727
> 
> 赞同：0
> 
> 时间：2013-01-08T23:17:00.357
> 
> 标签：ruby-on-rails, backbone.js

这是一个关于通过 Backbone 在 Rails 应用程序中创建数据库条目的长问题。我对如何处理 Rails 控制器中的数据以及如何在骨干网中设置 url 有疑问。

我在 Rails 中创建了一个包含标题、文本和关键字列的 Docs 表，让 Rails 自动创建 id 列。我尝试在控制台中创建两个文档，d7 和 d8。

在 d7 中，我尝试手动设置 id 和标题。当我尝试“保存”它时，它给了我一个 500 错误。

在 d8 中，我制作了一个只有标题的文档。当我尝试保存它时，它给了我一个 404 错误。

使用手动设置的 id 和标题创建文档 (d7)

```
d7 = new Doc({ id: '007', title: 'Document 7'})
Doc Constructor french2.js:24
child 
```

尝试保存 d7 会产生 500 错误

```
d7.save({}, { success : function(rec) {console.log('saved : ', rec); } })

    PUT http://localhost:3000/docs/007 500 (Internal Server Error) jquery.js:8215
    XHR finished loading: "http://localhost:3000/docs/007". jquery.js:8215
    Object {readyState: 4, responseText: "<!DOCTYPE html>↵&lt;html lang="en">↵&lt;head>↵  <meta ch…ders</b>: <pre>None</pre></p>↵↵↵↵</body>↵&lt;/html>↵", status: 500, statusText: "Internal Server Error"} 
```

它还在 DocsController#update 未定义方法 'stringify_keys' 中添加了“NoMethodError”

创建一个只有标题，没有 id 的文档（d8）（Rails 手动设置 id）

```
d8 = new Doc({title: 'Document 8'})
Doc Constructor french2.js:24
child 
```

尝试在没有手动设置 id 的情况下保存文档会产生 404 错误

```
Object
POST http://localhost:3000/docs/undefined 404 (Not Found) jquery.js:8215
XHR finished loading: "http://localhost:3000/docs/undefined". jquery.js:8215
Object {readyState: 4, responseText: "<!DOCTYPE html>↵&lt;html lang="en">↵&lt;head>↵  <meta ch…ation on available routes.↵&lt;/p>↵↵</body>↵&lt;/html>↵", status: 404, statusText: "Not Found"} 
```

**4个问题：**

1) 是否在 Backbone Doc 模型中正确设置了 url，以便使用 Rails 资源。 `this.url = "docs/" + this.id` 有关完整代码，请参阅下面的文档模型。

2) 我应该调用 save `d7.save()`来创建文档吗？我注意到它触发了 Rails 文档控制器中的更新操作？

3) 如何在不出现字符串化键错误的情况下保存字符串？

4) Rails 控制器：我的 docs 表有 3 个字段（标题、关键字、文本）以及 rails 添加的任何内容。我是否必须通过参数中的列名明确识别每个字段（即 params[:title][:keywords]）还是下面的代码（我从其他人那里复制）是否正确，其中仅指定了符号 :doc ? 参数的名称是任意的吗？

```
 def create
        respond_with Doc.create(params[:doc])
     end 
     def update
       respond_with Doc.create(params[:id], params[:doc])
     end 
```

**代码**

部分模型代码的 url 设置为`this.url = "docs/" + this.id`

```
 window.Doc = Backbone.Model.extend({

        initialize : function Doc() {

          this.url = "docs/" + this.id   #not sure if this is correct

            this.bind("error", function(model, error){
                console.log( error );
            });

        }, 
```

url 设置为“docs”的集合

```
window.Docs = Backbone.Collection.extend({
            model : Doc,

            url: "docs",

            initialize : function() {
                console.log('Docs collection Constructor');
            }
        }); 
```

Rails 文档控制器

```
class DocsController < ApplicationController

  respond_to :json

    def index
        respond_with Doc.all
    end 

    def show
        respond_with Doc.find(params[:id])

    end 

    def create
        respond_with Doc.create(params[:doc])
    end 

    def update
        respond_with Doc.create(params[:id], params[:doc])
    end 

    def destroy
        respond_with Doc
    end    

end 
```

文档表

```
class CreateDocs < ActiveRecord::Migration
  def change
    create_table :docs do |t|
      t.string :title
      t.string :text
      t.string :keywords

      t.timestamps
    end
  end
end 
```

创建了一些种子数据，但只设置了标题。Rails 自动设置 id，但我可以手动设置吗？

```
Doc.create!(title: "doc 1")
Doc.create!(title: "doc 2") 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-09T01:02:19.803

至于模型上的 url 属性，为了直接保存在模型上（而不是通过 Collection.create），您必须检查它是新条目还是更新。此代码对 url 属性执行此操作，它允许您调用 obj.save() 进行创建和更新。

```
 url : function() {
  var base = 'documents';
  if (this.isNew()) return base;
  return base + (base.charAt(base.length - 1) == '/' ? '' : '/') + this.id;
} 
```

对于 Rails 控制器，只需执行此操作就足够了

```
def create
    respond_with Document.create(params[:doc])
end 
```

# c++ - 如何删除 STL 指针列表？

> ID：14225728
> 
> 赞同：1
> 
> 时间：2013-01-08T23:17:17.473
> 
> 标签：c++, list, memory-leaks, stl, iterator

我有一个配对列表。遍历列表并删除第一个和第二个元素是个好主意吗？其中的对象是用new分配的。

```
list<pair<string,GraphObject*>>* table;
for(i=0; i< length; i++){
    it = table[i].begin();
    while(it != table[i].end()){
        delete (*it).second;
        delete &(*it).first;
    }
} 
```

编辑：字符串没有分配新的，我现在知道我不必删除它。以这种方式删除第二个可以吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-08T23:20:46.880

看起来您的实际需要是`std::map`使用智能指针

```
std::map<std::string, std::shared_ptr<GraphObject>> table; 
```

要清除表，您只需编写：

```
table.clear(); 
```

如果你必须使用 std::list，仍然使用智能指针，你仍然只需要调用`table.clear();`来清除整个表。

```
std::list<std::pair<std::string, std::shared_ptr<GraphObject>>> table; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-08T23:21:08.310

`string`没有分配给*，*它是的`new`数据成员`pair`。你的第二个`delete`是一个错误。

`string`也许它是用分配的对象的副本`new`，但如果是这样，那么您可能很久以前就泄露了原始对象。

`new`对于第一次删除 -当且仅当您不再需要它们时，删除分配给 的对象是个好主意。你没有说你是否仍然需要这些对象（即你是否还有其他指向它们的指针）。但是，使用智能指针来帮助管理内存是一个更好的主意。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-08T23:22:14.357

您不能删除该对的第一部分，因为它不是指针；你的代码甚至不应该编译。您*可以*做的是在完成后删除整个表。

```
list<pair<string,GraphObject*>>* table;
for(i=0; i< length; i++){
    it = table[i].begin();
    while(it != table[i].end()){
        delete (*it).second;
    }
}
delete table; 
```

至于是否应该删除该`GraphObject*`对的第二个成员，这将取决于是否有其他指针副本将在其他地方删除。大概没有，所以您的原始代码是正确的。正如另一个答案中指出的那样，使用智能指针会更容易，因此您不必担心。

# android - 我想在 Android SQLite 上使用 SQL 进行所有查询

> ID：14225731
> 
> 赞同：-1
> 
> 时间：2013-01-08T23:17:38.187
> 
> 标签：android, sql, sqlite

我不想使用一些额外的代码来插入、选择、更新或删除我在 Android 上的数据库。我想对所有这些都使用 SQL。可能吗？另外，你能给我一些简单的例子吗？因为，我是 Android 开发的新手。谢谢...

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-08T23:23:59.840

你有更多关于你想做什么的信息吗？您的意思是您宁愿将所有查询作为原始查询执行？如果是这样，您可以这样做：

```
Cursor cursor = getReadableDatabase().rawQuery("SELECT * FROM table WHERE _id = ?", new String[] { id }); 
```

# django - 如何为初学者调试一个 django 网站

> ID：14225733
> 
> 赞同：2
> 
> 时间：2013-01-08T23:17:54.093
> 
> 标签：django, django-views

我最近开始学习 Django，发现它非常有用。但是有一个问题：我不知道如何正确调试网站！

例如，我下载了一些示例并尝试设置它们。但是当我访问该站点时，我得到了这个回溯。这根本没有帮助——我知道 Python 抱怨“str object is not callable”。但它是如何触发的？我做了什么导致该函数调用？

有没有一种简单的方法来调试 Django 网站？

```
Environment:

Request Method: GET
Request URL: http://127.0.0.1:8000/

Django Version: 1.4.3
Python Version: 2.7.3
Installed Applications:
('django.contrib.auth',
 'django.contrib.contenttypes',
 'django.contrib.humanize',
 'django.contrib.sessions',
 'django.contrib.sites',
 'django.contrib.messages',
 'django.contrib.staticfiles',
 'django.contrib.admin',
 'forum',
 'registration')
Installed Middleware:
('django.middleware.common.CommonMiddleware',
 'django.contrib.sessions.middleware.SessionMiddleware',
 'django.middleware.csrf.CsrfViewMiddleware',
 'django.contrib.auth.middleware.AuthenticationMiddleware',
 'django.contrib.messages.middleware.MessageMiddleware')

Traceback:
File "/usr/local/lib/python2.7/dist-packages/django/core/handlers/base.py" in get_response
  111\.                         response = callback(request, *callback_args, **callback_kwargs)

Exception Type: TypeError at /
Exception Value: 'str' object is not callable 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-09T00:50:31.750

您向我们展示的堆栈跟踪不是整个堆栈跟踪，它只是生成错误的位置。django 默认调试页面允许您以交互方式展开跟踪中的节点，以查看错误最初源自何处。上几层，找到最有可能的嫌疑人——你自己代码中的行号——然后从那里调查。

后来，[django-debug-toolbar](http://pypi.python.org/pypi/django-debug-toolbar)是一个非常有用的应用程序，可以查看大量信息以帮助调试。

# opengl - GL_COMPRESSED_RGBA 提供加扰输出

> ID：14225734
> 
> 赞同：0
> 
> 时间：2013-01-08T23:18:00.627
> 
> 标签：opengl, lwjgl

我将 fbo 渲染到纹理，纹理完美显示。但是，当我使用 GL_COMPRESSED_RGBA 通过以下函数运行纹理时，函数返回的纹理结果会被打乱。我正在使用最新版本的 LWJGL。

```
public static int burnToTexture(int textureId) {
    // Create fbo for texture

    fboId = glGenFramebuffersEXT();     
    fboTextureId = glGenTextures();                                         

    glBindTexture(GL_TEXTURE_2D, 0);
    glBindFramebufferEXT(GL_FRAMEBUFFER_EXT, fboId);                    

    glBindTexture(GL_TEXTURE_2D, fboTextureId);                             
    glTexParameterf(GL_TEXTURE_2D, GL_TEXTURE_MIN_FILTER, GL_LINEAR);                   
    glTexParameterf(GL_TEXTURE_2D, GL_TEXTURE_MAG_FILTER, GL_LINEAR);               
    glTexImage2D(GL_TEXTURE_2D, 0,  GL_COMPRESSED_RGBA, SAVE_WIDTH, SAVE_HEIGHT, 0,GL_RGBA, GL_INT, (java.nio.ByteBuffer) null);
    glFramebufferTexture2DEXT(GL_FRAMEBUFFER_EXT,GL_COLOR_ATTACHMENT0_EXT,GL_TEXTURE_2D, fboTextureId, 0); 

    glBindFramebufferEXT(GL_FRAMEBUFFER_EXT, 0);
    // Render texture to fbo
    glPushAttrib(GL_ALL_ATTRIB_BITS);

    glBindTexture(GL_TEXTURE_2D, 0);
    glBindFramebufferEXT(GL_FRAMEBUFFER_EXT, fboId);    

    glMatrixMode (GL_MODELVIEW);
    glLoadIdentity ();
    glViewport(0,0,SAVE_WIDTH,SAVE_HEIGHT);
    glMatrixMode(GL_PROJECTION);
    gluOrtho2D(0, SAVE_WIDTH, 0, SAVE_HEIGHT);
    glLoadIdentity();
    glDisable(GL_DEPTH_TEST);
    glClearColor(1.0f, 1.0f, 0.0f, 0.0f);
    glClear (GL_COLOR_BUFFER_BIT);
    glEnable(GL_TEXTURE_2D);
    glActiveTextureARB(GL_TEXTURE0_ARB);

    glBindTexture(GL_TEXTURE_2D, textureId);
    glBegin (GL_QUADS);
    glTexCoord2f(0.0f, 0.0f);
    glVertex2i (-1, -1);
    glTexCoord2f(1.0f, 0.0f);
    glVertex2i (1, -1);
    glTexCoord2f(1.0f, 1.0f);
    glVertex2i (1, 1);
    glTexCoord2f(0.0f, 1.0f);
    glVertex2i (-1, 1);
    glEnd();        

    glDisable(GL_TEXTURE_2D);

    glBindFramebufferEXT(GL_FRAMEBUFFER_EXT, 0);

    glPopAttrib();

    // Destroy fbo
    glDeleteFramebuffersEXT(fboId);

    return fboTextureId;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-08T23:26:31.817

[压缩的图像格式](http://www.opengl.org/wiki/Image_Formats#Compressed_formats)不能进行[颜色渲染](http://www.opengl.org/wiki/Framebuffer_Object#Framebuffer_Object_Structure)。而且，顾名思义，您不能渲染到使用非颜色渲染格式的纹理。

# c# - C# 正则表达式删除'[]'

> ID：14225735
> 
> 赞同：0
> 
> 时间：2013-01-08T23:18:06.040
> 
> 标签：c#, regex

我有这个简单的代码：

```
Regex remove2 = new Regex("[(\"{}\r)]");
str = remove2.Replace(str, ""); 
```

我需要删除：`[`和`]`字符，怎么做？

当我只是在它`[]`之间添加`""`它不起作用。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-09T00:11:08.427

这个简单的代码将删除方括号：

```
 string str1 = "test=[[]]][[]";
     string res = Regex.Replace(str1, "[][]",""); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-08T23:45:01.357

If you're adding brackets — specifically a `]` — to the set matched in the RE, you've got to be careful about where you put it; it must be the *first* character in the set (which works because you're not allowed to make an empty set). So…</p>

```
Regex remove2 = new Regex("[][(\"{}\r)]") 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-08T23:21:49.987

您需要转义 [ 和 ] 字符 - 尝试

```
Regex remove2 = new Regex("\[(.*)\]");
str = remove2.Replace(str, "$1"); 
```

通过将部分模式包装在括号内，您实际上是将其保存以供以后使用。可以通过替换命令中的构造 $1 访问它。如果您在括号内捕获了第二个字符串，它将通过 $2 等访问。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-08T23:22:22.923

没有正则表达式，但也删除了括号：

```
str = new string(str.Where(c => !"[]".Contains(c)).ToArray()); 
```

# ruby - module_eval 和命名空间范围

> ID：14225743
> 
> 赞同：1
> 
> 时间：2013-01-08T23:19:22.800
> 
> 标签：ruby

我正在尝试构建一个在不同上下文中使用不同版本的类的 api。为什么下面的代码返回一个未初始化的常量 Project 错误，而不是在模块中查找正确的常量？

```
module A
  module B
    class Project
    end
  end
end

A::B.module_eval do
  puts Project
end 
```

结尾

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-09T07:22:55.160

当您在 中使用块时`module_eval`，[它不会改变在块中查找常量的方式](http://www.ruby-forum.com/topic/131801)。它只会更改对方法、实例和类变量的查找。这是由于块是封闭的必要效果，并保留了一些它自己的周围环境。

这可以通过使用字符串版本`module_eval`或通过 const_get 手动查找常量来解决：

```
module A
  module B
    class Project
    end
  end
end

A::B.module_eval{ const_get(:Project) }
  #=> A::B::Project 
```

# node.js - 从另一个进程干预 nodejs 进程 - 这可能吗

> ID：14225744
> 
> 赞同：1
> 
> 时间：2013-01-08T23:19:26.593
> 
> 标签：node.js

我目前正在运行一个 nodejs 进程，它每分钟向一个包含多个 URL 的数组发送一个请求。

它使用 setTimeout 休眠并每分钟发送请求。

是否可以从另一个 nodejs 进程中删除数组中的任何项目？

PS 我只是有一个管理界面，我可以在其中删除这些 URL，当一个 URL 被删除时，我只想将它从数组中删除。

我可以通过每次在发送请求之前检查数据库来做到这一点，如果 URL 被删除，则从数组中删除该项目，但尝试在每次不检查每个 URL 的情况下执行此操作。

非常感谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-09T05:48:21.080

如果您正在运行两个完全独立的进程，它们可以相互发送信号：

*   [http://nodejs.org/api/process.html#process_process_kill_pid_signal](http://nodejs.org/api/process.html#process_process_kill_pid_signal)

（signal.kill 听起来很吓人，但它只是向另一个进程发送信号）

你也可以在本地使用 redis 作为一种非常简单的数据共享机制。当然，您也可以只使用一个文件——如果您每分钟访问七个 URL，那么一个文件就可以了。查看 node-dirty 以获得一个不错的界面：

*   [https://github.com/felixge/node-dirty](https://github.com/felixge/node-dirty)

# mysql - 如果刷新页面，mySql 连接不会被关闭

> ID：14225746
> 
> 赞同：2
> 
> 时间：2013-01-08T23:19:30.483
> 
> 标签：mysql, web

如果我的网页在完成加载之前反复刷新，那么 MySQL 连接不会关闭，最终当它超过 150 个进程时会抛出“连接过多错误”。

我没有使用持久连接，并且我`mysql_close()`在脚本末尾有一个，即使我意识到我不需要一个，因为它会关闭。

我怎样才能阻止这种情况发生？我以前从未在我使用过的任何服务器上经历过这种情况。

为了稳定我的网站，我创建了一个 PHP 脚本，每分钟都会杀死超过 120 秒的旧进程。这很有帮助，但当我向我的网站发送更多流量时就没有用了。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-09T00:09:27.600

这看起来像数据库根本无法及时处理所有请求。

当用户访问您的网站时，您的脚本会建立与数据库服务器的连接，**执行查询**，获取、显示结果，关闭与数据库服务器的连接。

如果进入的查询太多或查询的执行时间过长，则队列会不断增长，直到服务器爆炸。

你说你杀死了旧的进程——那些不是旧的，它们只是还没有完成，请求的网络服务器进程可能已经超时了

你可以做的事情：

*   优化您的数据库结构
*   优化您的查询
*   扩展您的硬件（向上扩展或最好向外扩展）
*   使用缓存
*   优化您的服务器设置

最简单且耗时较少但非常有效的改进可能是输出缓存。

您只需保护热门站点的 html 输出并直接传递它，直到缓存过期并刷新缓存。

Nginx 可以为您做到这一点。

[http://dangerousprototypes.com/docs/NGINX_reverse_proxy_in_front_of_Apache:_hardened,_high_performance_dedicated_server_setup](http://dangerousprototypes.com/docs/NGINX_reverse_proxy_in_front_of_Apache:_hardened,_high_performance_dedicated_server_setup)

如果您提供有关您的网站架构/和您正在使用的软件堆栈的更多信息，我可以为您提供更详细的帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-08T23:23:49.107

获取数据后应关闭连接。任何网页都是无状态的，因此它不需要与数据库的持续连接，只需在发生自动回发时打开连接并再次关闭它。将数据存储在数据表容器中，然后对其进行处理。你用什么语言开发网页？

# unix - 随机访问压缩文件？

> ID：14225751
> 
> 赞同：29
> 
> 时间：2013-01-08T23:20:14.153
> 
> 标签：unix, concurrency, streaming, gzip

我在磁盘上有一个用 gzip 压缩的非常大的文件。生产环境是基于“云”的，所以存储性能很差，但是CPU很好。以前，我们的数据处理管道开始于`gzip -dc`从磁盘流式传输数据。

现在，为了使工作并行化，我想运行多个管道，每个管道采用一对字节偏移量 - 开始和结束 - 并获取文件的那个块。使用纯文件可以使用`head`and来实现`tail`，但我不确定如何使用压缩文件有效地做到这一点；如果 I`gzip -dc`和 pipe into `head`，则文件末尾的偏移对将涉及在整个文件缓慢解压缩时浪费性地寻找。

所以我的问题实际上是关于 gzip 算法的——理论上是否可以在底层文件中寻找一个字节偏移量或获取它的任意块，而没有将整个文件解压缩到那时的全部含义？如果不是，我还能如何有效地分区文件以供多个进程“随机”访问，同时最小化 I/O 吞吐量开销？

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2013-01-09T17:09:13.390

是的，您可以通过顺序读取整个内容并构建索引来随机访问 gzip 文件。请参阅[zlib](http://zlib.net/)发行版中的[示例/zran.c](https://github.com/madler/zlib/blob/master/examples/zran.c)。

如果您可以控制创建 gzip 文件，那么您可以为此目的优化文件，方法是构建随机访问入口点并在压缩时构建索引。

您还可以通过在 zlib 中使用`Z_SYNC_FLUSH`后跟插入两个标记并使下一个块独立于先前的数据来创建带有标记的 gzip 文件。这将减少压缩，但如果您不经常这样做，则不会减少太多。例如，每兆字节一次应该几乎没有影响。然后您可以搜索一个 9 字节标记（误报的可能性比 bzip2 的 6 字节标记小得多）：`Z_FULL_FLUSH``deflate()``00 00 ff ff 00 00 00 ff ff`

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2013-01-08T23:30:18.190

你不能用 gzip 做到这一点，但你可以用 bzip2 做到这一点，它是块而不是基于流的——这就是 Hadoop DFS 如何在其 MapReduce 算法中使用不同的映射器拆分和并行读取大文件的方式。也许将文件重新压缩为 bz2 是有意义的，这样您就可以利用这一点；它比一些特殊的方式来分块文件更容易。

我在这里找到了在 Hadoop 中实现此功能的补丁：[https ://issues.apache.org/jira/browse/HADOOP-4012](https://issues.apache.org/jira/browse/HADOOP-4012)

这是关于该主题的另一篇文章：[在 Hadoop 中读取的 BZip2 文件](https://stackoverflow.com/questions/14035736/bzip2-file-read-in-hadoop)

也许浏览 Hadoop 源代码会让您了解如何按块读取 bzip2 文件。

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2013-01-08T23:33:10.057

`gzip`实际上确实希望能够从一开始就流式传输文件。你不能从中间开始。

您可以做的是将文件分解为分段压缩`gzip`然后连接在一起的块。您可以为每件选择您喜欢的任何尺寸，例如 10MB 或 100MB。然后，您从包含所需字节偏移量的片段的开头开始解压缩。由于一个鲜为人知的特性`gzip`（即解压缩一个由几个较小的 gzip 文件连接的文件会产生与解压缩每个较小的文件并将结果连接在一起的相同的输出），分段压缩的大文件也适用于标准`gzip -d`/`gunzip`如果你下载整个东西。

棘手的部分：您必须维护一个索引，其中包含大文件中每个压缩片段的开始字节偏移量。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2019-07-24T21:23:20.927

FWIW：我在 zlib 的*zran.c*上开发了一个命令行工具，它**为 gzip 文件创建索引，允许在其中进行非常快速的随机访问**： [https ://github.com/circulosmeos/gztool](https://github.com/circulosmeos/gztool)

**它甚至可以为仍在增长的 gzip 文件**（例如由 rsyslog 直接以 gzip 格式创建的日志）创建索引，从而在实践中将创建索引的时间减少到零。请参阅 -S（监督）选项。

# php - Memcached 不监听过期时间

> ID：14225755
> 
> 赞同：3
> 
> 时间：2013-01-08T23:20:39.200
> 
> 标签：php, mysql, codeigniter, memcached

我将 Memcached 与我用 CodeIgniter 编写的 PHP Web 应用程序结合使用。我利用这个 Memcached 库[https://github.com/tomschlick/memcached-library](https://github.com/tomschlick/memcached-library)当我缓存数据时，我给它一个 7200 或 2 小时的过期时间。

模型查询的片段：

```
$result = $this->memcached_library->get(md5($sql));
if (!$result) {
     $cursor = $this->db->query($sql);
     $result = $cursor->row();
     $this->memcached_library->set(md5($sql), $result, 7200);
}
return $result; 
```

很酷，这适用于将数据设置到 Memcached 中。我可以看到结果，一切正常。问题在于将这些数据放入 Memcached 后 2 小时。

据我了解，在执行 get 函数时，Memcached 应该认识到缓存数据已超过其过期日期，因此将其标记为无效（但不一定将其从内存中删除）。当 PHP 调用获取数据时，它应该返回 false，这反过来会导致我的 if 语句被评估为 true 并重新获取数据并再次在 Memcached 中设置数据。

但是，似乎 Memcached 从未说过数据无效，并且在 2 小时到期限制之前，相同的旧数据就在那里。如果我在 Memcached 上手动调用 flush（使缓存中的所有数据无效），数据将再次正确设置到 Memcached 中，但我们再次遇到相同的 2 小时过期限制问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-09T11:48:35.553

From memcached manual:

> EXPIRATION TIME: If it's non-zero (either Unix time or offset in seconds from current time), it is guaranteed that clients will not be able to retrieve this item after the expiration time arrives (measured by server time).

So this should be NULL after expiration time. If it happens otherwise you have found a bug in Memcached or this library. Are you sure you are using "Memcached" and not "Memcache". From sources of the lib you linked:

```
$this->client_type = class_exists('Memcache') ? "Memcache" : (class_exists('Memcached') ? "Memcached" : FALSE);
// ...
log_message('debug', "Memcached Library: $this->client_type Class Loaded"); 
```

Also i see this library is using local cache that is ignoring the expiry date:

```
if(isset($this->local_cache[$this->key_name($key)]))
{
    return $this->local_cache[$this->key_name($key)];
} 
```

So if your php script is running as daemon for a long period of time no actual Memcached request will be sent.

# c++ - 重载 [][] 运算符 c++

> ID：14225761
> 
> 赞同：1
> 
> 时间：2013-01-08T23:20:55.177
> 
> 标签：c++, vector, operator-overloading

> **可能重复：**
> [C++ 重载：重载 [][] 运算符](https://stackoverflow.com/questions/7076282/c-overloading-overloading-the-operator)

我有一个类矩阵，它的数据存储在`vector<vector<double> > _data` 我想重载`[][]`运算符以返回`_data[row][cols]`

我环顾四周，但不太明白如何`vector`使用`vector`

我知道我需要重载`[]`运算符，但它只接收一个参数。

正在考虑创建一个内部助手类，但我无法完全理解这个。

有任何想法吗？

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-08T23:25:38.817

你至少有两个选择：

1.  创建一个`MatrixRow`存储单行矩阵的自定义类。此类可以重载`operator[]()`以返回行中的元素。然后你的矩阵类重载它自己`operator[]()`的返回一个`MatrixRow`.

2.  在矩阵类中重载`operator[]()`以返回`vector<double>`. 然后你免费获得第二个`operator[]()`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-08T23:30:19.557

怎么样：

```
double& operator()(size_t row, size_t col) {
    return _data[row][col];
}

// ...
m(2,4) = 10.3; 
```

它不完全相同，但在语法上几乎一样方便，并且它抽象了底层实现（因此，如果您决定只使用一个向量 (1D) 并计算正确的索引以使其显示为 2D，这将很容易做）。

顺便说一句：使用嵌套向量会产生额外的内存（和查找）开销，这是您可能不想要的。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-01-08T23:26:25.717

据我所知，您正在尝试创建二维向量。所以，这里是你可以做到的方式：

```
vector <vector<double>> _data;

vector <double> vec_d; // temporary helpful vector
double d=NULL;

for(int i=0;i<column_size;i++){
            _data.push_back(vec_d);

            for(int j=0;row_size<l;j++)
                _data[i].push_back(d);
    } 
```

完成此操作后，您可以通过以下方式访问您的数据：

```
_data[1][0] = 1.5; 
```

# opencv - 直方图值的平均值 OpenCV

> ID：14225772
> 
> 赞同：2
> 
> 时间：2013-01-08T23:21:49.607
> 
> 标签：opencv, histogram

我对 Open CV 有点陌生。我`CalcHist()`用来计算图像灰度图像的直方图。我现在想计算直方图值的平均值。您能告诉我如何实现这一目标吗？

我正在使用 c++，由 Gcc 在 ubuntu 中编译，opencv 2.4.3。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-09T12:23:08.490

CalcHist 第 5 个属性是保存直方图值的 Mat。访问它的 .data[]。

# php - 显示与帖子 ID-Wordpress 相关的自定义字段

> ID：14225775
> 
> 赞同：0
> 
> 时间：2013-01-08T23:22:01.590
> 
> 标签：php, loops, wordpress

我现在有这个代码/循环来获取一个类别的所有帖子：

```
// this needs to be modified
<?php
global $post;
$args = array('category' => 37, 'post_type' => 'post' ); 
$postslist = get_posts( $args ); 
foreach ($postslist as $post) : setup_postdata($post); 
?> 
// end this needs to be modified

<?php if( get_post_meta($post->ID, "Title", true) ): ?>
<?php echo get_post_meta($post->ID, "Title", true); ?></p>
<?php endif; ?> 
```

我用它在侧边栏中显示带有永久链接的标题。

当用户点击这个帖子时，他可以看到自定义字段，我可以在帖子区域自由显示。但问题是，我无法复制它们。

我想要什么：我想通过 INCLUDE 调用和简码在帖子上显示一些数据（问题不在于实现，这是 100% 正确的）。

我想修改上面选择的代码（带有评论）以仅获取帖子 ID 的数据，而不是整个类别的数据。

希望我说清楚了，谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-08-07T01:25:07.003

我不明白你在问什么。但是，为什么不使用 WP_Query？WordPress 在循环中的 $id = get_the_id() 将获得 ID 并且 $title = get_the_title($ID) 将获得标题......我错过了什么吗？在 WordPress 中，您通常会赋予功能它自己的循环。所以一个用于您的侧边栏插件情况，另一个用于输出到页面内容区域。

```
// this needs to be modified
    <?php
    global $post;
    $args = array('category' => 37, 'post_type' => 'post' ); 
    $postslist = get_posts( $args ); 
    foreach ($postslist as $post) : setup_postdata($post); 
    ?> 
    // end this needs to be modified
    <?php echo get_the_ID(); ?> 
    <?php if( get_post_meta($post->ID, "Title", true) ): ?>
    <?php echo get_post_meta($post->ID, "Title", true); ?></p>
    <?php endif; ?> 
```

# couchdb - 如何在动态映射期间将所有标量类型（数字/布尔值/字符串等）设置为“字符串”类型（使用河流插件）

> ID：14225780
> 
> 赞同：1
> 
> 时间：2013-01-08T23:22:25.817
> 
> 标签：couchdb, elasticsearch

这可能是我正在尝试做的非常特别的事情。我正在运行一条“河流”来动态索引我的 couchdb 中的所有数据。
当多个用户向系统输入数据时，有时会出现映射冲突 ( `MapperParser Error`)。例如：

*   **userA**添加以下数据`{"tweet" : {"fooval" : "1"}}` ——elasticSearch 为这个`tweet.fooval`变量创建一个映射为**Number**（因为它解释为一个数字）

*   **userB**添加以下数据 - `{"tweet" : {"fooval" : "false"}}` elasticSearch 尝试将此`tweet.fooval`变量的映射创建为**布尔值**（因为它将其解释为布尔值），**因此会出现 MapperParser Error**。

我想你看到了问题。此外，我只想在标量类型的级别上执行此操作，因为我不希望将数组/对象视为字符串。我希望在创建映射时将所有标量类型都视为字符串。

我在文档页面或论坛上找不到任何东西，所以思想会在这里询问方向/指针。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-09T01:17:40.963

首先，默认情况下，elasticsearch 是不解析字符串的。因此，如果您将以下 JSON 传递给 elasticsearch：`{"tweet": {"fooval": "1"}}`它将被`tweet.fooval`视为字符串。如果 elaticsearch 正在解析字符串，请确保在[映射](http://www.elasticsearch.org/guide/reference/mapping/root-object-type.html)`numeric_detection`中将and`date_detection`设置为 false 。

另一方面，如果elasticsearch接收到一个像这样的JSON数字的值：`{"tweet": {"fooval": 1}}`，elasticsearch确实会将这样的字段映射为long或double。您可以使用 dynamic_templates 覆盖此行为。这是一个例子：

```
curl -XPUT localhost:9200/test-idx -d '{
    "settings": {
        "index.number_of_replicas": 0,
        "index.number_of_shards": 1
    },
    "mappings": {
        "doc": {
            "dynamic_templates" : [
                {
                    "template_obj" : {
                        "match" : "*",
                        "match_mapping_type" : "object",
                        "mapping" : {
                            "type" : "object"
                        }
                    }
                },
                {
                    "template_str" : {
                        "match" : "*",
                        "mapping" : {
                            "type" : "string"
                        }
                    }
                }            
            ]
        }
    }
}'
curl -XPUT localhost:9200/test-idx/doc/1 -d '{
    "count": 123,
    "sold": false,
    "date": "2009-11-15T14:12:12",
    "price": 12.3,
    "description": {
        "weight":  42.3,
        "size": {
            "lenght": 30,
            "width": 20,
            "hight": 10
        }
    }
}'
echo
curl "localhost:9200/test-idx/doc/_mapping?pretty=true" 
```

# python - 以编程方式登录 Python 网络爬虫

> ID：14225781
> 
> 赞同：1
> 
> 时间：2013-01-08T23:22:27.803
> 
> 标签：python, login, web-crawler, beautifulsoup

我正在尝试制作一个网络爬虫，它将使用我的凭据登录学校网站，然后爬取该网站的某些部分。我正在使用此处找到的 Beautiful Soup Python 库：

```
http://www.crummy.com/software/BeautifulSoup/bs4/doc/ 
```

我可以获得用户名和密码字段的正确源代码，但我不知道如何提供它们。另外，我在提交它们时也遇到了同样的问题。我已经抓取了“提交”按钮的源代码，但我不知道如何请求登录。

谢谢，

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-08T23:29:22.217

您可以使用[Mechanize](http://pypi.python.org/pypi/mechanize/)，一个模拟浏览器的库，也可以手动发送 POST/GET 请求。

[Mechanize 的主页](http://wwwsearch.sourceforge.net/mechanize/#examples)上有一个完整的示例，您可以尝试一下。

如果你想手动请求，我通常只打开 Chrome 的 JS 控制台，序列化表单并查看发送了哪些参数：

```
> $('form#search').serialize()
"q=" 
```

`POST`然后，您只需使用这些参数向该 URL发送请求：

```
import requests  # Install `requests` if you want to use my example code

session = requests.session()  # So your cookies persist across requests
response = session.post('your_url', data={
    'q': 'search string'
}).text 
```

# html - 强制 div 不调整其他元素的位置

> ID：14225782
> 
> 赞同：1
> 
> 时间：2013-01-08T23:22:32.477
> 
> 标签：html, css

这是一个很难用语言表达的问题，所以我认为需要进行实际演示。

我有一组 html 元素：

```
<div class="outer-div">                  // Container
  <div class="content-div"></div>        // Text goes into this element
  <span class="clear-button"></span>     // BG image for this is a 16x16 icon
  <span class="select-button"></span>    // BG image for this is a 16x16 icon
</div> 
```

哪个使用这个css：

```
div.select-div {
  background-color: white;
  border: 1px solid #CCC;
  vertical-align: middle;
  margin-bottom: 10px;
  -webkit-border-radius: 4px;
  -moz-border-radius: 4px;
  border-radius: 4px;
  height: 20px;
  padding: 4px 6px;
}

div.content-div {
  float: left;
  overflow: hidden;
  background-color: white;
  vertical-align: middle;
  font-size: 14px;
  color: #555;
  height: 20px;
  width: auto;
}

span.select-button {
  cursor: pointer;
  display: inline-block;
  float: right;
  width: 16px;
  height: 16px;
  margin-top: 2px;
  position: relative;
  background-color: red; // for testing simplicity, this would be a bg image
}

span.clear-button {
  cursor: pointer;
  display: inline-block;
  float: right;
  width: 16px;
  height: 16px;
  margin-top: 2px;
  position: relative;
  background-color: black; // for testing simplicity, this would be a bg image
} 
```

文本被添加到内容 div 中，并且适用于少量文本，例如：

![在此处输入图像描述](../Images/462f77b03525f5f60bd05d46f5c11e1c.png)

但是，如果您添加更多文本，则会发生这种情况：

![在此处输入图像描述](../Images/618bed8b0897a3ede3292e2268c8e7cc.png)

我一直在努力寻找一种方法来阻止这些图标从它们的位置移动，但我无法解决。理想情况下，我希望 div 垂直扩展，但是隐藏溢出文本也可以。外部 div 宽度可能会有所不同。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-08T23:29:56.973

您可以限制内容 div 的宽度，然后对图标使用绝对定位。这是一种方法，但为了解释您的情况，您没有为内容 div 定义特定宽度或清除容器内的浮动。这就是为什么事情正在破裂。你可以尝试这样的事情：

```
div.select-div {
  background-color: white;
  border: 1px solid #CCC;
  vertical-align: middle;
  margin-bottom: 10px;
  -webkit-border-radius: 4px;
  -moz-border-radius: 4px;
  border-radius: 4px;
  height: 20px;
  width:200px;
  padding: 4px 6px;
  position:relative;
}

div.content-div {
  background-color: white;
  vertical-align: middle;
  font-size: 14px;
  color: #555;
  height: 20px;
  width: 160px;
}

span.select-button {
  cursor: pointer;
  display: inline-block;
  position:absolute;
  top:2px;
  right:38px;
  width: 16px;
  height: 16px;
  background-color: red; // for testing simplicity, this would be a bg image
}

span.clear-button {
  cursor: pointer;
  display: inline-block;
  width: 16px;
  height: 16px;
  position:absolute;
  top:2px;
  right:18px;
  background-color: black; // for testing simplicity, this would be a bg image
} 
```

这应该会导致您的容器垂直扩展以适应内容。如果不需要，您可以限制内部内容的高度并隐藏溢出。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-08T23:41:57.610

如果你使用

```
position:relative 
```

对于您的外部 div 和

```
position:absolute ; 
top:0; 
right:0;
display: block; 
```

对于两个跨度元素？

或内联：

```
<div class="outer-div" style="position: relative; background: #000000; height: 400px;">
    <div class="content-div" position: absolute; top: 0; left: 0; display: block; width: 200px; height: 30px;">
    <span class="clear-button" style="position: absolute; top: 0; right: 0; display: block; background: yourimage.png; width: 30px; height: 30px;"></span>
    <span class="select-button" style="position: absolute; top: 0; right: 0; display: block; background: yourimage.png; width: 30px; height: 30px;"></span>
</div> 
```

使用溢出：隐藏；以避免文本溢出。

# c++ - double 的有效小数位数？

> ID：14225786
> 
> 赞同：12
> 
> 时间：2013-01-08T23:22:49.927
> 
> 标签：c++, c, floating-point, language-lawyer

C/C++ 标准对 a 的最小有效十进制数字有什么保证`double`？

C++ 标准实际上在 § 18.3.2.4/10 的脚注中说这等同`DBL_DIG`于 C 标准中的定义。但是我在 C 标准中找不到任何关于最小值的信息。

那么，以下其中一项的最小值是多少？

*   `std::numeric_limits<double>::digits10`
*   `DBL_MANT_DIG`编辑：不，`DBL_DIG`

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-01-08T23:32:38.220

你不会在 C++ 标准中找到它，因为 C++ 在这个标准上遵循 C 标准。对于十进制数字，最小值为：

```
FLT_DIG   6
DBL_DIG  10
LDBL_DIG 10 
```

所以，6 位代表`float`， 10 位代表`double`和`long double`。（这是保证从文本到类型的转换并返回将产生相同值的位数。）

请注意，它`DBL_MANT_DIG`对应于基数中的位数，因此通常是二进制位数，而不是十进制位数。

# .net - 使用 SyndicationItem 根据帖子 ID 检索 Blogger 帖子的链接

> ID：14225787
> 
> 赞同：0
> 
> 时间：2013-01-08T23:22:58.593
> 
> 标签：.net, blogger, atom-feed, syndication, syndication-feed

我正在尝试使用 Windows.Web.Syndication 和 Blogger ATOM 提要检索帖子的链接。我从另一个提要阅读器（虽然没有使用 Blogger）看到的示例使用 SyndicationItem id 来查找博客文章链接。

但是，使用这种方法，我得到了这种格式的 Id：

`/tag:blogger.com,1999:blog-5388280093621795916.post-2321273013867491101`

如何使用此访问原始 BlogPost URL？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-11T20:35:36.800

我还没有找到确切的解决方案，但找到了解决方法。

我发现可以通过以下方式访问 URL：（项目是 SyndicationItem）

```
item.Links[4].Uri.AbsoluteUri; 
```

就我而言，它始终位于 Links 数组的第 4 位。

# java - 避免 JTextField setText 在程序周围重复

> ID：14225791
> 
> 赞同：0
> 
> 时间：2013-01-08T23:23:23.113
> 
> 标签：java, mysql, sql, database, swing

这是一种将工作从表格显示`SQlite`到表格并进行`labelText`适当设置的方法。

```
private void setLabelText() {
    try {

    String table_click0 = (table_job.getModel().getValueAt(row, 0).toString());        
    String sqlSt = "SELECT Employer.name, * FROM Job INNER JOIN Employer ON Job.employerID = Employer.employerID WHERE jobID='"+table_click0+"' ";
    conn = JavaConnect.ConnectDB();
    pst = conn.prepareStatement(sqlSt);
    rs = pst.executeQuery();

    if(rs.next()) {
        descriptionArea.setText(rs.getString(5));
        empTitLabel.setText(rs.getString(1)+" - "+rs.getString(4));
        idLabel.setText("Job Reference: " + rs.getString(2));
        typeLabel.setText("Job Type: " + rs.getString(6));
        salaryLabel.setText("Salary: " + rs.getString(7));
         benefitsLabel.setText("Benefits : " + rs.getString(8));
        vacLabel.setText("Vacancies : " + rs.getString(9));
        closeLabel.setText("Closing Date: " + rs.getString(10));
        reqLabel.setText("Requirement : " + rs.getString(11));
       placeLabel.setText("Placement : " + rs.getString(12));
       applyToLabel.setText("Apply To: " + rs.getString(13));
        statusLabel.setText("Job Status: "+rs.getString(14));
        locLabel.setText("Location: "+rs.getString(16));
         postedLabel.setText("Posted: "+rs.getString(15));        
    }
 } 
```

我希望现在能够允许用户选择作业（单击表上的行）以允许编辑以更新数据。因此，我提供了一个表单来执行此操作，而不是重复诸如`descriptionArea.setText(rs.getString(5));`表单文本字段之类的行，是否有更短的方法来执行此操作。还是每个`JTextfield`都必须使用 textfieldName.setText(....) 方式单独操作，是否有任何技巧可以缩短它？任何不错的简单技术，也许可以重用上述代码以尽量减少重复。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-09T09:55:09.187

您可能想查看 Apache Commons [`DbUtils`](http://commons.apache.org/dbutils/)，它使用[*类文字作为运行时类型标记*](http://docs.oracle.com/javase/tutorial/extra/generics/literals.html)并[`ResultSetMetaData`](http://docs.oracle.com/javase/6/docs/api/java/sql/ResultSetMetaData.html)简化 JDBC 的一些更繁琐的部分。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-08T23:34:42.097

尽管 JTextField 用于编辑，但您可以使用它来显示您的结果。您可以在单击时更改为可编辑。

# ssrs-2008 - 在 ssrs 中显示 10 行的最大值

> ID：14225792
> 
> 赞同：4
> 
> 时间：2013-01-08T23:23:24.953
> 
> 标签：ssrs-2008

我有一份报告，我想在其中显示 10 名具有最高薪水的员工数据。我想通过SSRS做到这一点，请帮助我。请通过 SSRS 而不是 SSMS 进行。

提前致谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-09T10:52:33.500

我假设你有一个数据集，每个员工一行，按薪水降序排列。

您可以`TOP N`对表格应用过滤器并将其设置为 10；这应该只返回前十行：

[http://msdn.microsoft.com/en-us/library/ms156270(v=sql.100).aspx](http://msdn.microsoft.com/en-us/library/ms156270(v=sql.100).aspx)

您还可以`Hidden`根据使用 RowNumber() 函数的表达式为表中的详细信息行设置属性，例如

`=IIf(RowNumber(Nothing) <= 10, False, True)`这也应该有效。

[http://msdn.microsoft.com/en-us/library/ms159225(v=sql.100).aspx](http://msdn.microsoft.com/en-us/library/ms159225(v=sql.100).aspx)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2018-07-05T09:42:44.877

只需在此处添加我的 5 美分（和一张图片）：我遇到了一个问题，即过滤器应仅适用于整数。所以我应用了如下所示的值转换。 [![前n个过滤器的配置](../Images/f916bff686d16ecbb8496413ffeafc66.png)](https://i.stack.imgur.com/8bO68.png)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2016-09-23T20:20:06.783

对于数据集中的前 10 条记录。

1：转到行组属性并为 TOP N 添加过滤器。

```
Expression =Sum(Fields!ActualCost.Value) 
```

2\. 按降序对`"=Sum(Fields!ActualCost.Value)"`字段名称进行排序。

# grails - 我可以使用 grails 以某种方式通过匿名 javascript 函数发出数据吗

> ID：14225793
> 
> 赞同：0
> 
> 时间：2013-01-08T23:23:48.017
> 
> 标签：grails, extjs

我想让一个控制器发出一个 JSON 响应，如下所示：

```
{
    sidebar: {
        xtype: "container",
        flex: 1,
        bodyCls: "my-sidebar",
        itemId: "my-sidebar-container",
        items: [
        {
            xtype: "panel",
            animCollapse: false,
            collapseFirst: false,
            collapsed: false,
            collapsible: true,
            flex: 1,
            bodyCls: "my-sidebar-message-section",
            itemId: "my-sidebar-message-section-container",
            html: "<h1>Messages (2)</h1><p>Bank will be closed on September 4th, 2013 for Labor Day</p><p>Lorem ipsum dolor sit amet, <a href="http://google.com">consectetur</a> adipisicing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat.</p>",
            listeners: {
                 boxready: function(p) {
                      alert('Hi');
                 }
            }
        }
        ]
    }
} 
```

在我的 Grails 控制器中，我这样定义它：

```
package com.fourgablesguy.myapp

import grails.converters.JSON

class SidebarController {

def generateSideBar() {
    def sidebarItems = [
            [
                xtype: 'panel',
                animCollapse: false,
                collapseFirst: false,
                collapsed: false,
                collapsible: true,
                flex: 1,
                bodyCls: 'my-sidebar-message-section',
                itemId: 'my-sidebar-message-section-container',
                html: messageSectionHtml,
                listeners: [
                    boxready: "function(p) { alert('Hi');}"
                ]
            ]
        ]
    [
     xtype: 'container',
     flex: 1,
     bodyCls: 'my-sidebar',
     itemId: 'my-sidebar-container',
     items: sidebarItems
    ]
} 
```

但是 grails.converters.JSON 将我的 function() 定义转换为字符串，因此控制器操作发出的实际 JSON 具有 function() 的字符串：

```
{
    sidebar: {
        xtype: "container",
        flex: 1,
        bodyCls: "my-sidebar",
        itemId: "my-sidebar-container",
        items: [
        {
            xtype: "panel",
            animCollapse: false,
            collapseFirst: false,
            collapsed: false,
            collapsible: true,
            flex: 1,
            bodyCls: "my-sidebar-message-section",
            itemId: "my-sidebar-message-section-container",
            html: "<h1>Messages (2)</h1><p>Bank will be closed on September 4th, 2013 for Labor Day</p><p>Lorem ipsum dolor sit amet, <a href="http://google.com">consectetur</a> adipisicing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat.</p>",
            listeners: {
                 boxready: "function(p) {alert('Hi');}"
                 }
            }
        }
        ]
    }
} 
```

具体问题是这一行： **boxready：“function（p）{alert（'Hi'）;}”** 我想知道一种方法来代替上面的返回： **boxready：function（p）{alert（'Hi' );}**

这不是我试图以 JSON 格式返回的真正“对象数据”，如果这不可能，我可以理解。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-09T00:09:25.957

如果您仔细查看[json.org](http://www.json.org/)，您会发现 JSON 是一种数据交换格式，并且 JSON 中允许的类型不包括`Function`函数声明。如果有一个`function`，那不再是 JSON，那是 javascript。你永远不会有一个允许在其中传递函数的 JSON 转换器（如果你不破解它来这样做）

如果您想将函数传输到控制器，为什么不传递要调用的函数的名称和参数，它们将在单独的 javascript 文件中定义。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-09T01:03:46.160

同意 Alexander Tokarev 在这里的回答，但想建议，如果您绝对需要从服务器返回视图类，请让它们变得愚蠢。仅配置。将所有功能和侦听器移动到客户端控制器。

# deployment - 在什么情况下，staging / beta 和 production / stable 环境应该共享一个数据库？

> ID：14225796
> 
> 赞同：5
> 
> 时间：2013-01-08T23:23:56.883
> 
> 标签：deployment, production-environment, staging

在我过去和现在的 Web 开发职位中，Staging / Beta 和 Production / Stable 环境共享一个数据库。

这是我对正在发生的事情的理解：

*   Staging / Beta 与 Production / Stable 的服务器基本相同，只是一般公众无法访问 Staging / Beta

*   一旦 QA 的测试在其自己的生产/稳定数据的净化子集副本上通过即将进行的代码迭代，开发的下一步是确保即将进行的代码迭代将与完整的生产/稳定数据集一起使用，而不是打破现有的 Production / Stable 网站 - 这就是 Staging / Beta 的目的。此外，公司可以让 beta 测试人员使用全世界都可以看到的相同数据来测试代码。然后，当 beta 测试人员竖起大拇指时，它应该是从旧迭代到新代码迭代的简单切换。

我的一位直接下属称这是一种“气味”。他建议 Staging / Beta 应该拥有 Production / Stable 数据库的完整副本——因此，如果 Staging / Beta 代码确实存在问题，而在 QA 期间没有发现，它不会影响 Production / Stable 体验。这就是这两个链接的答案：

*   [暂存环境设置](https://stackoverflow.com/a/4572709/1276572)
*   [暂存数据库困境](https://stackoverflow.com/questions/451519/staging-database-predicament)

所以这是我的问题：在什么情况下，Staging / Beta 和 Production / Stable 应该共享一个数据库服务器？还是我现在和以前的公司做错了/便宜/等等？

预先感谢您的想法。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-08T23:33:37.220

仅当您没有足够的资源时才应共享资源:)

我不得不同意你的直接报告。您可能会遇到一些问题，而且它们并不少见：

1.  测试过程从生产中窃取资源。
2.  新代码被破坏并消耗太多资源（＃1的变化）
3.  新代码需要一个不能与生产模式轻松并行的新模式。
4.  在安装测试版更改的过程中，您会中断生产。

我真的不明白你怎么能原谅不单独托管分期/测试版。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2016-10-27T16:27:40.160

目标似乎是：

1.  允许部分用户使用新版本（非常适合敏捷工作流程）
2.  避免数据丢失或唯一密钥丢失/重复，因为两个版本同时运行

我处于类似的环境中，我似乎无法找到允许上述情况的记录开发生命周期。我想说这是**A/B 测试**和“[**金丝雀发布策略**](http://martinfowler.com/bliki/CanaryRelease.html)”之间的交叉。

我们通过第四个环境解决了这个问题，介于测试和生产之间（我们称它为 beta，尽管它实际上是生产环境）：

1.  **alpha**开发人员测试。这是开发人员推送分支和合并代码的地方。
2.  **QA/分期**用户测试。一旦新版本发布，这将与生产相同。）
3.  **为部分用户提供**测试版。**（我们正试图想出一个更好的名字，因为“测试版”的生产数据会让审计员感到紧张。我不确定“金丝雀”是否会飞……没有双关语的意思。**
***   **www**（通用生产）**

 **Show stoppers 永远不应该进入 beta 版（在这种情况下），因为它*是*生产环境，与 staging/QA 是分开的。

如果您喜欢这个答案，也许您可​​以以我的名字命名发布周期或部署策略:)**

# objective-c - Objective C 在字符串数组中创建字符串搜索

> ID：14225800
> 
> 赞同：2
> 
> 时间：2013-01-08T23:24:07.967
> 
> 标签：objective-c, ios, search, nsmutablearray, nsarray

> **可能重复：**
> [NSMutableArray addObject 不影响计数？](https://stackoverflow.com/questions/3683761/nsmutablearray-addobject-not-affecting-count)

我正在创建一个搜索函数，用于搜索 NSArray`catalogArray`中定义的特定字符串的任何实例`searchMe.text`。发现匹配项后，我想将对象添加到 mutable array `searchResultMA`，但到目前为止我得到空结果。

这是我的搜索方法：

```
-(IBAction)searchFor{
    int i=0;
    for (int j=0; j<[catalogMA count]/170; j++) {
        NSRange rangeArray = NSMakeRange(j*170, 170);
        catalogArray = [catalogMA subarrayWithRange:rangeArray];
        if([catalogArray containsObject:searchMe.text]) {
            NSLog(@"catalogArray count=%d", [catalogArray count]);
            [searchResultMA addObjectsFromArray:catalogArray];
            NSLog(@"%d, %@", i, [searchResultMA objectAtIndex:9+i*170]);
            i++;
        }
    }
} 
```

并且，当我搜索我知道在数组中有两个实例的字符串时，这是我的控制台输出：

```
2013-01-08 18:07:05.300 Catalog[3229:c07] catalogArray count=170
2013-01-08 18:07:05.301 Catalog[3229:c07] 0, (null)
2013-01-08 18:07:05.301 Catalog[3229:c07] catalogArray count=170
2013-01-08 18:07:05.302 Catalog[3229:c07] 1, (null) 
```

为什么我会得到一个`(null)`结果`searchResultsMA`？

当我在`NSLog(@"%d, %d", i, [searchResultMA count]);`条件中添加行时，我得到`0,0`and `1,0`，这告诉我`searchResultMA`可变数组中没有任何内容。它应该是`0,170`and `1,340`。想法？提示？建议？欢迎大家...

# coldfusion - Zingchart 通过冷融合获取图像数据

> ID：14225801
> 
> 赞同：4
> 
> 时间：2013-01-08T23:24:14.473
> 
> 标签：coldfusion, cfchart, zingchart

我正在尝试提取通过 CFCHART 生成的 zingchart 的 SVG 内容并将其传递给我的服务器以将 SVG 转换为 PNG

```
$('#downloadGraph').click(function() {
    zingchart.EXPORTURL = 'imageexport.cfm'; 
    zingchart.AJAXEXPORT = true;
    zingchart.exec('myChart', 'getimagedata', {
        format : 'png',
        callback : function(sImageData) {
            console.log(sImageData);

        }
    });
}); 
```

但是我收到以下错误

```
Uncaught TypeError: Cannot call method 'zcExec' of null 
cfchart-lite.js:1
zingchart.exec_flash cfchart-lite.js:1
zingchart.exec cfchart-html.js:165 
```

我知道该功能有效，因为如果您右键单击图表并选择“导出到 PNG”它可以工作，但我想在我的页面上放置一个按钮来执行相同的操作。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-09T22:42:28.417

我解决了这个问题。除非[`getImageData`](http://www.zingchart.com/learn/api/api.php)渲染模式为`canvas`. 当我使用'SVG'时，它返回-1。但是，我认为 cfchart-lite.js 没有正确处理这个返回值。

解决的方法是`saveasimage`改用

```
zingchart.EXPORTURL = 'imageexport.cfm'; 
zingchart.AJAXEXPORT = true;

zingchart.exec('datasetChart', 'saveasimage', {
        format : 'png',
        callback : function(sImageData) {
            console.log(sImageData);

    }
}); 
```

# mysql - 如何对mysql行求和

> ID：14225811
> 
> 赞同：0
> 
> 时间：2013-01-08T23:25:12.873
> 
> 标签：mysql, sum

```
SELECT `contract_fine` AS TotalFine FROM `contract` 
NATURAL JOIN `rented_vehicle` WHERE `contractID` = 3; 
```

这会返回多行数字，我将如何将它们加在一起，我似乎做不到。

![在此处输入图像描述](../Images/c18015a55776087e50f3319aac097cac.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-08T23:26:02.390

```
SELECT SUM(`contract_fine`) AS TotalFine FROM `contract` 
NATURAL JOIN `rented_vehicle` WHERE `contractID` = 3; 
```

就这么容易。

# php - php用fopen下载facebook图片

> ID：14225815
> 
> 赞同：0
> 
> 时间：2013-01-08T23:25:35.730
> 
> 标签：php, facebook

我正在尝试在我的 VPS 上运行此代码

```
 <?php 
    function curl_get_contents($url, array $opts = array()) {
    $defaults = array(
        CURLOPT_FOLLOWLOCATION => true,
        CURLOPT_RETURNTRANSFER => true,
        CURLOPT_USERAGENT => 'Mozilla Firefox 20.0',
        CURLOPT_VERBOSE => true
    );
    $opts = $opts + $defaults;
    $ch = curl_init($url);
    curl_setopt_array($ch, $opts);

    return curl_exec($ch);
}

header('Content-type: image/jpeg');
echo curl_get_contents('http://sphotos-b.ak.fbcdn.net/hphotos-ak-prn1/58678_10151328142003680_1939974573_n.jpg');

?> 
```

当我运行它时，有一个无限循环，我不明白为什么。该功能适用​​于每个图像网址，但不适用于 facebook。有什么建议吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-08T23:51:14.373

以下对我有用：

```
<?php
function curl_get_contents($url, array $opts = array()) {
    $defaults = array(
        CURLOPT_FOLLOWLOCATION => true,
        CURLOPT_RETURNTRANSFER => true,
        CURLOPT_USERAGENT => 'Mozilla Firefox 20.0'
    );
    $opts = $opts + $defaults;
    $ch = curl_init($url);
    curl_setopt_array($ch, $opts);

    return curl_exec($ch);
}

header('Content-type: image/jpeg');
echo curl_get_contents('link to facebook image');
?> 
```

# ios4 - iPhone SDK 通过裁剪 UIView 创建自定义形状的 UIView

> ID：14225817
> 
> 赞同：0
> 
> 时间：2013-01-08T23:25:38.627
> 
> 标签：ios4, uiview, ios5, cgrectmake

我正在尝试为 UIView 创建一个名为“CoverView”的自定义形状。

目前我将框架设置为...

```
 [CoverView setFrame:CGRectMake(0, 0, 1808, 303)]; 
```

我想为 UIView 创建一个自定义形状，以便从 UIView 的顶部中间切出 200x200。基本上，剪切的帧将是 (804, 0, 200, 200)。

任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-09T03:36:48.593

我能够为 CoverView 创建一个遮罩，它在视觉上创建了我正在寻找的内容，但是由于 CoverView 仍在它们上方，因此无法按下视图遮罩下可以看到的任何按钮。代码如下。有什么建议可以使用视图孔中的按钮吗？

```
CGMutablePathRef maskPath = CGPathCreateMutable();
        CGPathMoveToPoint(maskPath, NULL, 0, 0);
        CGPathAddLineToPoint(maskPath, NULL, 804, 0);
        CGPathAddLineToPoint(maskPath, NULL, 804, 200);
        CGPathAddLineToPoint(maskPath, NULL, 1004, 200);
        CGPathAddLineToPoint(maskPath, NULL, 1004, 0);
        CGPathAddLineToPoint(maskPath, NULL, 1808, 0);
        CGPathAddLineToPoint(maskPath, NULL, 1808, 303);
        CGPathAddLineToPoint(maskPath, NULL, 0, 303);
        CGPathAddLineToPoint(maskPath, NULL, 0, 0);
        CGPathCloseSubpath(maskPath);

        CAShapeLayer *maskLayer = [CAShapeLayer layer];
        maskLayer.frame = CoverView.bounds;
        maskLayer.path = maskPath;
        CoverView.layer.mask = maskLayer; 
```

# json - 从 Perl-JSON-module-encoded 输出中省略未定义的键

> ID：14225821
> 
> 赞同：0
> 
> 时间：2013-01-08T23:26:21.580
> 
> 标签：json, perl, encoding, null, decoding

我正在使用[Perl JSON](http://search.cpan.org/~makamaka/JSON-2.53/lib/JSON.pm)模块将一些嵌套的 Perl 对象和数组引用（通过解码 JSON 输入获得）编码为打印精美的 JSON 输出。

到目前为止，一切都很好。但是，我有一个要从参考输入中删除的键：

```
if (defined $originalJSON->{'myObsoleteKey'}) {
    undef $originalJSON->{'myObsoleteKey'};
} 
```

看起来这`null`在我的输出中呈现为 JSON 元素：

```
{
    ...
    "myObsoleteKey" : null, 
    ...
} 
```

我宁愿完全过滤掉它。我想我可以编写一个`awk`脚本或类似的东西来手动执行此操作，但我希望在 Perl JSON 模块中有一种更简洁的方法来执行此操作。这是可行的吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-08T23:32:04.583

而不是将哈希元素设置为`undef`您应该完全删除它。

利用

```
delete $originalJSON->{myObsoleteKey} 
```

不需要先检查它是否存在：如果没有这样的元素，那么什么都不会发生。

# javascript - 在某些情况下隐藏在 DIV 后面的 CSS 文本

> ID：14225822
> 
> 赞同：2
> 
> 时间：2013-01-08T23:26:24.610
> 
> 标签：javascript, html, css

看看[http://jsfiddle.net/hg25u/](http://jsfiddle.net/hg25u/)

我已将右侧的 HTML 文本设置为可编辑，因此如果您在`Result`块内单击（右下角），您实际上可以通过键入来更改它。现在，如果您将打字光标放在文本上方：

`Bonorum has. His ut cibo quas tantas,`

然后敲击`Enter`你的键盘，你会看到文本隐藏在它正下方的灰色 DIV 标签后面，它不应该那样做，我认为这是一个 CSS 问题，但我无法让它工作。它应该出现在灰色 DIV 标签下方，而不是像它那样隐藏在它后面。如果你乱来，你会在很多情况下看到它在你按 Enter 键时会这样做，有时它会正常运行，有时却不会。

它不应该在任何给定时刻隐藏那些灰色 DIV 条后面的文本。当您按 Enter 时，它应该继续灰色 DIV 标记下方的文本行。

任何帮助，将不胜感激

另外请看一下这张图片以更好地理解它[http://bayimg.com/eaIImAaef](http://bayimg.com/eaIImAaef)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-09T02:17:27.810

line-height 需要与 the 大小相同，`.gate`并且`.fencepost`height 需要是每个块中所需的文本行数乘以 line-height。

```
body{ 
  font-size: 12px; 
  line-height: 20px; /* set base line-height */
}

.fencepost {
  float: left; 
  width: 1px; 
  height: 100px; /* 20px (line-height) multiplied by 5 lines of text */
}

.gate {
  float: left; 
  clear: left; 
  width: 100%; 
  height: 20px; /* same as line-height */
  background-color: #eee; 
  opacity: 0.9;
}

.newsletterContent {
  width:600px;
} 
```

见：http: [//jsfiddle.net/cg6yC/](http://jsfiddle.net/cg6yC/)

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-01-08T23:28:04.370

查看是否可以使用 z-index 属性来强制将 div 置于文本后面。

# python - uWSGI 和优雅地杀死一个多线程 Flask 应用程序

> ID：14225827
> 
> 赞同：7
> 
> 时间：2013-01-08T23:26:40.403
> 
> 标签：python, flask, uwsgi

我正在实现一个使用 APScheduler（它使用线程池）来获取一些资源的系统。

我正在尝试找出一种检测“应用程序重启”的方法，以便能够关闭 APScheduler 线程池。我通过向 uWSGI 主进程发送 SIGHUP 重新启动。

有没有人尝试过其中之一？如果是这样，检测应用重启事件的正确方法是什么？

*   `uwsgidecorators`有`postfork`装饰师，
*   `uwsgi`模块有`signal_wait`和`signal_received`功能

`signal_wait`功能块，所以我的线程运行但 uWSGI 不服务请求。我也尝试过设置`scheduler.daemonic`为 False 和 True - 这两种方式都无济于事。uWSGI 进程仍然会记录如下内容：

`worker 1 (pid: 20082) is taking too much time to die...NO MERCY !!!`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2017-03-08T18:33:12.120

> 我正在尝试找出一种检测“应用程序重启”的方法，以便能够关闭 APScheduler 线程池。

我认为没有简单的方法可以肯定地检测*应用程序重启*，但是 uwsgi 可以在重新加载或关闭后执行代码，方式如下：

1) 代码将在单独的进程中执行：将**hook-as-user-atexit**添加到您的 uwsgi 配置中：

```
[uwsgi]
 ...
 hook-as-user-atexit = exec:python finalization.py 
```

2) 将在其中一名工作人员中调用：

```
import uwsgi

def will_invoked_after_reload_or_shutdown():
    print("I was invoked")

uwsgi.atexit = will_invoked_after_reload_or_shutdown 
```

3）在这种情况下，您应该重新加载 thru `touch uwsgi.pid`。仅在重新加载后才会在其中一名工作人员中调用：

```
[uwsgi]
 ...
 pidfile = ./uwsgi.pid
 touch-reload = ./uwsgi.pid 
```

Python代码：

```
import uwsgi

def will_executed_after_reload(*args):
    print("I was invoked")

uwsgi.register_signal(17, "worker", will_executed_after_reload)
uwsgi.add_file_monitor(17, "./uwsgi.pid") 
```

# mysql - 如果可能，需要将两个 mySQL 查询连接在一起

> ID：14225828
> 
> 赞同：0
> 
> 时间：2013-01-08T23:26:44.293
> 
> 标签：mysql, sql

是否可以将这两个查询组合成一个查询？

第一个查询：

```
SELECT products_options_values, options_values_price, orders_id
FROM orders_products_attributes oa
WHERE (products_options_id = 5 OR products_options_id = 1 OR products_options_id = 2)
AND oa.orders_id
IN (
SELECT DISTINCT o.orders_id
FROM orders o
WHERE o.ExportedToTradebox =  0
AND o.orders_id >  22000) 
```

第二个查询：

```
SELECT * FROM orders_products
WHERE orders_id 
IN(
SELECT DISTINCT orders_id 
FROM orders 
WHERE ExportedToTradebox='0' 
and orders_id >'22000') 
```

我已经尝试了几次，我只是得到了 phpMyAdmin 报告的 SQL 错误 对不起，如果它很简单，我的 sql 知识非常不完整。

组合起来，以便在运行时将所有必需的信息放入一个数组中。我试图从它生成的两个单独的数组中使用它，但是程序中的 php 代码设计不佳，带有多个 while 循环和 else-if 语句。尝试引入另一个 while-MoveNext 循环只会使一切崩溃。我想如果所有数据都可以收集到原始数组中，那么回显新字段就足够简单了。

相关数据库表结构如下：

订单表：

```
CREATE TABLE IF NOT EXISTS `orders` (
`orders_id` int(11) NOT NULL AUTO_INCREMENT,
`customers_id` int(11) NOT NULL DEFAULT '0',
`customers_name` varchar(64) NOT NULL DEFAULT '',
`customers_company` varchar(64) DEFAULT NULL,
`customers_street_address` varchar(64) NOT NULL DEFAULT '',
`customers_suburb` varchar(32) DEFAULT NULL,
`customers_city` varchar(32) NOT NULL DEFAULT '',
`customers_postcode` varchar(10) NOT NULL DEFAULT '',
`customers_state` varchar(32) DEFAULT NULL,
`customers_country` varchar(32) NOT NULL DEFAULT '',
`customers_telephone` varchar(32) NOT NULL DEFAULT '',
`customers_email_address` varchar(96) NOT NULL DEFAULT '',
`customers_address_format_id` int(5) NOT NULL DEFAULT '0',
`delivery_name` varchar(64) NOT NULL DEFAULT '',
`delivery_company` varchar(64) DEFAULT NULL,
`delivery_street_address` varchar(64) NOT NULL DEFAULT '',
`delivery_suburb` varchar(32) DEFAULT NULL,
`delivery_city` varchar(32) NOT NULL DEFAULT '',
`delivery_postcode` varchar(10) NOT NULL DEFAULT '',
`delivery_state` varchar(32) DEFAULT NULL,
`delivery_country` varchar(32) NOT NULL DEFAULT '',
`delivery_address_format_id` int(5) NOT NULL DEFAULT '0',
`billing_name` varchar(64) NOT NULL DEFAULT '',
`billing_company` varchar(64) DEFAULT NULL,
`billing_street_address` varchar(64) NOT NULL DEFAULT '',
`billing_suburb` varchar(32) DEFAULT NULL,
`billing_city` varchar(32) NOT NULL DEFAULT '',
`billing_postcode` varchar(10) NOT NULL DEFAULT '',
`billing_state` varchar(32) DEFAULT NULL,
`billing_country` varchar(32) NOT NULL DEFAULT '',
`billing_address_format_id` int(5) NOT NULL DEFAULT '0',
`payment_method` varchar(128) NOT NULL DEFAULT '',
`payment_module_code` varchar(32) NOT NULL DEFAULT '',
`shipping_method` varchar(128) NOT NULL DEFAULT '',
`shipping_module_code` varchar(32) NOT NULL DEFAULT '',
`coupon_code` varchar(32) NOT NULL DEFAULT '',
`cc_type` varchar(20) DEFAULT NULL,
`cc_owner` varchar(64) DEFAULT NULL,
`cc_number` varchar(32) DEFAULT NULL,
`cc_expires` varchar(4) DEFAULT NULL,
`cc_cvv` blob,
`last_modified` datetime DEFAULT NULL,
`date_purchased` datetime DEFAULT NULL,
`orders_status` int(5) NOT NULL DEFAULT '0',
`orders_date_finished` datetime DEFAULT NULL,
`currency` char(3) DEFAULT NULL,
`currency_value` decimal(14,6) DEFAULT NULL,
`order_total` decimal(14,2) DEFAULT NULL,
`order_tax` decimal(14,2) DEFAULT NULL,
`paypal_ipn_id` int(11) NOT NULL DEFAULT '0',
`ip_address` varchar(96) NOT NULL DEFAULT '',
`ExportedToTradebox` int(1) NOT NULL DEFAULT '0',
PRIMARY KEY (`orders_id`),
KEY `idx_status_orders_cust_zen` (`orders_status`,`orders_id`,`customers_id`),
KEY `idx_date_purchased_zen` (`date_purchased`),
KEY `idx_cust_id_orders_id_zen` (`customers_id`,`orders_id`)
) ENGINE=MyISAM  DEFAULT CHARSET=latin1 AUTO_INCREMENT=23075 ; 
```

订单属性：

```
CREATE TABLE IF NOT EXISTS `orders_products_attributes` (
`orders_products_attributes_id` int(11) NOT NULL AUTO_INCREMENT,
`orders_id` int(11) NOT NULL DEFAULT '0',
`orders_products_id` int(11) NOT NULL DEFAULT '0',
`products_options` varchar(32) NOT NULL DEFAULT '',
`products_options_values` text NOT NULL,
`options_values_price` decimal(15,4) NOT NULL DEFAULT '0.0000',
`price_prefix` char(1) NOT NULL DEFAULT '',
`product_attribute_is_free` tinyint(1) NOT NULL DEFAULT '0',
`products_attributes_weight` float NOT NULL DEFAULT '0',
`products_attributes_weight_prefix` char(1) NOT NULL DEFAULT '',
`attributes_discounted` tinyint(1) NOT NULL DEFAULT '1',
`attributes_price_base_included` tinyint(1) NOT NULL DEFAULT '1',
`attributes_price_onetime` decimal(15,4) NOT NULL DEFAULT '0.0000',
`attributes_price_factor` decimal(15,4) NOT NULL DEFAULT '0.0000',
`attributes_price_factor_offset` decimal(15,4) NOT NULL DEFAULT '0.0000',
`attributes_price_factor_onetime` decimal(15,4) NOT NULL DEFAULT '0.0000',
`attributes_price_factor_onetime_offset` decimal(15,4) NOT NULL DEFAULT '0.0000',
`attributes_qty_prices` text,
`attributes_qty_prices_onetime` text,
`attributes_price_words` decimal(15,4) NOT NULL DEFAULT '0.0000',
`attributes_price_words_free` int(4) NOT NULL DEFAULT '0',
`attributes_price_letters` decimal(15,4) NOT NULL DEFAULT '0.0000',
`attributes_price_letters_free` int(4) NOT NULL DEFAULT '0',
`products_options_id` int(11) NOT NULL DEFAULT '0',
`products_options_values_id` int(11) NOT NULL DEFAULT '0',
`products_prid` tinytext NOT NULL,
`tradebox_attributes_list` text NOT NULL,
PRIMARY KEY (`orders_products_attributes_id`),
KEY `idx_orders_id_prod_id_zen` (`orders_id`,`orders_products_id`)
) ENGINE=MyISAM  DEFAULT CHARSET=latin1 AUTO_INCREMENT=77065 ; 
```

订购产品：

```
CREATE TABLE IF NOT EXISTS `orders_products` (
`orders_products_id` int(11) NOT NULL AUTO_INCREMENT,
`orders_id` int(11) NOT NULL DEFAULT '0',
`products_id` int(11) NOT NULL DEFAULT '0',
`products_model` varchar(32) DEFAULT NULL,
`products_name` varchar(64) NOT NULL DEFAULT '',
`products_price` decimal(15,4) NOT NULL DEFAULT '0.0000',
`final_price` decimal(15,4) NOT NULL DEFAULT '0.0000',
`products_tax` decimal(7,4) NOT NULL DEFAULT '0.0000',
`products_quantity` float NOT NULL DEFAULT '0',
`onetime_charges` decimal(15,4) NOT NULL DEFAULT '0.0000',
`products_priced_by_attribute` tinyint(1) NOT NULL DEFAULT '0',
`product_is_free` tinyint(1) NOT NULL DEFAULT '0',
`products_discount_type` tinyint(1) NOT NULL DEFAULT '0',
`products_discount_type_from` tinyint(1) NOT NULL DEFAULT '0',
`products_prid` tinytext NOT NULL,
PRIMARY KEY (`orders_products_id`),
KEY `idx_orders_id_prod_id_zen` (`orders_id`,`products_id`),
KEY `idx_prod_id_orders_id_zen` (`products_id`,`orders_id`)
) ENGINE=MyISAM  DEFAULT CHARSET=latin1 AUTO_INCREMENT=34938 ; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-08T23:53:42.463

```
SELECT *
FROM orders_products op
LEFT JOIN orders_products_attributes oa
ON op.orders_id = oa.orders_id
WHERE (oa.products_options_id = 5 OR oa.products_options_id = 1 OR oa.products_options_id = 2)
AND oa.orders_id
IN (
SELECT DISTINCT o.orders_id
FROM orders o
WHERE o.ExportedToTradebox =  0
AND o.orders_id >  22000) 
```

这将在一个结果集中为您提供这两个表中的所有列。我使用了左连接，因此如果 orders_products 记录没有属性，那么它仍然会被返回。

您可能面临的一个问题是，如果每个订单 ID 有多个，`orders_product_attribute`那么您将复制 orders_products 记录。您可能需要查看某种转置函数（我不确定如何在 MySQL 中执行此操作，或者是否可能）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-09T00:01:19.517

```
SELECT *  --You can select your own columns later
    FROM orders_products_attributes oa
         RIGHT OUTER JOIN orders_products op
             ON oa.orders_products_id = op.orders_products_id
                 AND products_options_id IN (5, 1, 2)
    WHERE op.orders_id IN (
            SELECT DISTINCT o.orders_id
                FROM orders o
                WHERE o.ExportedToTradebox =  0
                    AND o.orders_id >  22000
        ) 
```

假设您的 order_products_ids 引用相同的信息，这将使您在一个表中获得所有内容。每个属性都有一行，其中 Order_Products 数据重复。如果您想将信息串联在一起，您可以随时尝试 GROUP_CONCAT：

```
SELECT op.orders_products_id
        , GROUP_CONCAT(
          oa.products_options_id 
          ORDER BY CASE oa.products_options_id
              WHEN 5 THEN 1
              WHEN 1 THEN 2
              WHEN 2 THEN 3
              ELSE 4
          END ASC
          SEPARATOR '::'
        ) AS Options
    FROM orders_products_attributes oa
        RIGHT OUTER JOIN orders_products op
            ON oa.orders_products_id = op.orders_products_id
                AND oa.products_options_id IN (5, 1, 2)
    WHERE op.orders_id IN (
            SELECT DISTINCT o.orders_id
                FROM orders o
                WHERE o.ExportedToTradebox =  0
                    AND o.orders_id >  22000
        )
    GROUP BY op.orders_products_id 
```

;

这会给你一个逗号分隔的列表。只是有点取决于你需要什么。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-08T23:29:13.720

我认为您正在寻找的是 UNION ALL：

```
SELECT products_options_values, options_values_price, orders_id 
FROM orders_products_attributes oa 
WHERE (products_options_id = 5 OR products_options_id = 1 OR products_options_id = 2) AND oa.orders_id IN ( SELECT DISTINCT o.orders_id FROM orders o WHERE o.ExportedToTradebox = 0 AND o.orders_id > 22000)
UNION ALL
SELECT products_options_values, options_values_price, order_number as orders_id 
FROM orders_products WHERE orders_id IN( SELECT DISTINCT orders_id FROM orders 
WHERE ExportedToTradebox='0' and orders_id >'22000') 
```

请注意，我在第二个查询中命名了字段，以便与第一个查询中的名称完全匹配。

# git - 如何恢复使用策略=我们的合并？

> ID：14225829
> 
> 赞同：11
> 
> 时间：2013-01-08T23:26:54.317
> 
> 标签：git, git-merge, git-revert

我正在使用几周前执行合并的存储库，我们刚刚发现使用了该`--strategy=ours`标志（它应该使用 --strategy-option=ours 标志），因此没有对 HEAD 应用任何更改。但是，我们需要应用更改。Git 已经将分支识别为已合并，并且分支历史记录中的提交。

这种合并无法使用`git revert -m ...`

恢复和/或重新应用合并以更改文件的正确方法是什么？

```
master  A - B - E - F - G ---> L - M - N
             \     /
topic         C - D 
```

在这种情况下，合并提交`(F)`将是罪魁祸首。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-01-09T06:10:41.890

我已经找到了解决这个问题的方法。Linus 写的关于恢复错误合并的信中的全部内容：[如何恢复错误合并](http://www.kernel.org/pub/software/scm/git/docs/howto/revert-a-faulty-merge.txt)。在`git merge --strategy=ours topic`我们的情况下不是故意的。即使它是一个错误的合并，它也不能被恢复，并且已经被推送了很长时间，具有恢复合并提交但无法恢复恢复提交的相同效果。

解决方案是检查主题分支，`rebase --no-ff`从第一次提交运行，然后将该分支合并回主分支。

```
git checkout topic
git rebase -i --no-ff <C>
git checkout master
git merge topic 
```

这产生了以下效果：

```
fixed–topic   C'–––D'––––––––––––––––––––-
             /                            \
master  A–––B–––E–––F–––G –––&gt; L–––M–––N–––F2
             \     /
topic         C–––D 
```

要真正深入了解这一点，请阅读如何使用rebase 选项重新创建分支[来恢复错误合并这封信的最后一部分。](http://www.kernel.org/pub/software/scm/git/docs/howto/revert-a-faulty-merge.txt)`--no-ff`

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2016-05-13T20:50:17.207

@Highway of Life 有一个很好的答案。一件事是重新定位的提交现在看起来像新的不同提交，这在许多情况下可能是不可取的。我想再次合并相同的提交，但`git-merge`阻止了这一点。但是，我一次又一次地发现，总是可以让 git 做你想做的事。

1.  遵循生命之路的指示，但不要直接合并到主人：

    ```
    git checkout -b fixed-topic <D>
    git rebase -i --no-ff <B>
    git checkout -b re-merged master
    git merge fixed-topic 
    ```

    这导致：

    ```
    re-merged               ––––––––––––––––––––------R
                           /                         /
    fixed–topic      C'–––D'                        /
                    /                              /
    master     A–––B–––E–––F–––G –––&gt; L–––M–––N–––F2
                    \     /
    topic            C–––D 
    ```

2.  现在，树已完全按照您的需要设置——所有文件都准确显示了您想要的内容。一个问题是您的合并提交的父母是原始提交的重新基础副本，而不是实际上是原始提交本身。很容易解决这个问题[`git-reparent`](https://github.com/MarkLodato/git-reparent)：

    ```
    git reparent -p master -p <D> 
    ```

    这最终得到：

    ```
    master     A–––B–––E–––F–––G –––&gt; L–––M–––N–––F2
                    \     /                        \
    topic            C–––D                          \
                          \                          \
    re-merged              ---------------------------R 
    ```

    需要注意的重要一点是，自上一步以来，R 的内容没有改变——只有父母。

3.  将 master 快进到新的合并提交：

    ```
    git checkout master
    git merge re-merged 
    ```

4.  最后你可以清理

    ```
    git branch -d fixed-topic re-master 
    ```

完毕！现在你的历史看起来像这样，一个分支合并了两次：

```
master  A–––B–––E–––F–––G –––&gt; L–––M–––N–––F2---R
             \     /                           /
topic         C–––D---------------------------- 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-09T03:45:09.430

从本质上说“无论你要合并什么，都保留你所拥有的”的合并策略是不可逆转的。在新分支中签出合并的第一个父级，然后再次进行合并。Rebase --onto 您在原始合并之上的其余提交。

更新：

在您的情况下，如果您不关心过去，您可以将 GN 重新定位到 E 上，然后将 D 合并到这个新的 master 上。rebase 将是微不足道的，因为 F 是 --ours 合并。

# linux - 为每个用户创建文件夹会带来压力或降低服务器速度吗？

> ID：14225831
> 
> 赞同：2
> 
> 时间：2013-01-08T23:27:12.610
> 
> 标签：linux, apache

我正在创建一个用户可以上传和共享文件的站点。我正在考虑为每个用户创建一个文件夹来上传他们的文件。这会减慢网站速度或导致服务器出现问题吗？

我预计不会有 100 万用户，而是大约 100,00 - 200,000。似乎每个用户都有很多文件夹。

我还有另一种解决方案，即在上传时重命名文件，但我想保持文件名完整，以便用户仍然知道哪个文件是哪个文件。

编辑：如果它有助于我计划使用 Linux 服务器。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-08T23:33:50.057

如果您创建 10,000 个文件夹，则分解树，以便所有文件夹都不在同一个目录中。

如果您有用户“doug”并想给他一个文件夹，请将其放入`/d/o/doug`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-08T23:40:41.167

It depends on the file system you are using. `ext2` uses linked list. So its slow for large number of files. `ext3` uses *hashed Binary trees*. Its much faster. Most server has directory indexing turned on. So accessing 20k folders will not be that slow.

Problem is your users will grow. So its better you use a nested directory structure than a single flat directory.

# android - android:layout_weight="33"gone->visible visible->gone 对此有何影响？

> ID：14225833
> 
> 赞同：9
> 
> 时间：2013-01-08T23:27:16.260
> 
> 标签：android, android-layout

android 布局使用 layout_weight。我的目标是所有组件的 1/3，但有时页脚实际上设置为消失，然后可见。当设置从消失到可见时，重量计算如何工作？我没有看到重量为 1/3 的线性布局中的内容？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-03-11T20:37:30.743

在更改视图的权重后，似乎有必要在视图上调用 refreshDrawableState() 才能呈现更改：

```
((LinearLayout.LayoutParams) btnFav.getLayoutParams()).weight = 3f;
btnFav.refreshDrawableState(); 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-01-08T23:40:04.107

make sure you set height to 0dp and then set the weight on all of the views to 1

ie

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout
    xmlns:android="http://schemas.android.com/apk/res/android"
    android:orientation="vertical"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    >

    <TextView
        android:layout_width="match_parent"
        android:layout_height="0dp"
        android:layout_weight="1"
        android:text="Hello World, MyActivity"
        android:background="#f00"
        />

    <TextView
        android:layout_width="match_parent"
        android:layout_height="0dp"
        android:layout_weight="1"
        android:text="Hello World, MyActivity"
        android:background="#00f"
        />
    <TextView
        android:layout_width="match_parent"
        android:layout_height="0dp"
        android:layout_weight="1"
        android:text="Hello World, MyActivity"
        android:background="#0f0"
        />
</LinearLayout> 
```

when a view is set to gone the remaining views will fill up their ratio of the screen. Ie if you set the third view to gone the first 2 views will take up 50% each of the available space in the layout

Furthermore, if you want the remaining views to only take up 1/3 of space each (ie 2/3 used and leave 1/3 empty) set your hidden view to invisible not gone

# maps - Windows Phone 8 打开地图到当前位置

> ID：14225834
> 
> 赞同：0
> 
> 时间：2013-01-08T23:27:24.653
> 
> 标签：maps, windows-phone-8

在 Windows Phone 8 中，我想将本地地图应用程序打开到用户当前位置。

我最接近这个的是[MapsTask](http://msdn.microsoft.com/en-us/library/windowsphone/develop/microsoft.phone.tasks.mapstask%28v=vs.105%29.aspx)。描述让我相信它是完美的：

> 允许应用程序以 Center 属性指定的位置或**用户的当前位置**为中心启动 Maps 应用程序。如果设置了 SearchTerm，则在地图上标记与搜索词匹配的位置。

如果您不提供中心，它将使用用户当前位置。完美的！但是，如果您不提供中心，也不提供 SearchTerm，则会引发异常（按设计）。

所以我必须提供一个 SearchTerm。但是，如果我输入的内容不是用户本地的，我会弹出一个弹出窗口，上面写着“没有结果：我们找不到任何匹配您的搜索。尝试不同的拼写或搜索词”。

现在我可以自己获取用户的位置并使用该位置启动地图，但考虑到地图应用程序已经为您完成了，这感觉不对。有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-08T23:36:36.133

可以自己获取地理位置并将其发送到地图任务。使用 GeoLocator 一次性地理定位获取来做到这一点。

```
private async void MainPage_Loaded(object sender, RoutedEventArgs e)
{
    var geoLocator = new Geolocator();
    var geoloc = await geoLocator.GetGeopositionAsync();
    new MapsTask()
    {
        Center = new GeoCoordinate(geoloc.Coordinate.Latitude, geoloc.Coordinate.Longitude),
        ZoomLevel = 10
    }.Show();
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-11-17T04:42:42.310

我写了一篇关于获取当前位置的教程，它可以让你获得一个可以用来绘制地图的一次性位置。

```
private async void GetCurrentLocation()
￼{
    ￼Geolocator locationFinder = new Geolocator
￼    {
￼        DesiredAccuracyInMeters = 50,
￼        DesiredAccuracy = PositionAccuracy.Default
    ￼};
    try
    {
        Geoposition currentLocation = await  locationFinder.GetGeopositionAsync(
            maximumAge: TimeSpan.FromSeconds(120),
            timeout: TimeSpan.FromSeconds(10));
            String longitude = currentLocation.Coordinate.Longitude.ToString("0.00");
            String latitude = currentLocation.Coordinate.Latitude.ToString("0.00");
            ￼MyTextBlock.Text = "Long: " + longitude + "Lat: " + latitude;
￼    }
￼    catch (UnauthorizedAccessException)
￼    {
￼       MessageBox.Show("And Exception Occured");
￼    }
} 
```

有关演示文件的完整内容，请参见下面的链接 [http://mobile.tutsplus.com/tutorials/windows/windows-phone-8-sdk-geolocation-services/](http://mobile.tutsplus.com/tutorials/windows/windows-phone-8-sdk-geolocation-services/)

# jquery - webapi mvc4 所需的注释对于整数属性失败，但适用于字符串

> ID：14225835
> 
> 赞同：5
> 
> 时间：2013-01-08T23:27:27.617
> 
> 标签：jquery, asp.net-mvc-4, annotations, asp.net-web-api

当我进行 ajax 调用时，它失败并出现 500 Internal server error

```
Value-typed properties marked as [Required] must also be marked with [DataMember(IsRequired=true)] 
```

问题在于 CallerID 属性。

```
[Required]
public string AccountTypeID { get; set; }

[Required]
public int CallerID { get; set; } 
```

如果我将 CallerID 标记为字符串，则一切正常。
任何想法为什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-09T00:34:41.700

这是 Web API 中的一个已知问题，您可以在此处查看整个历史记录：http: [//aspnetwebstack.codeplex.com/workitem/270](http://aspnetwebstack.codeplex.com/workitem/270)

基本上，如果将 [Required] 应用于值类型（例如 bool 或 int，string 不是值类型）就会导致此错误。

你也需要考虑一下——你正在创建`int`一个必需的属性——但作为一个值类型，它总是有值，value=0，即使它不是由用户传递的。也许你在想`int?`呢？

您可以`InvalidModelValidatorProvider`完全删除（虽然这可能是不可接受的）：

```
config.Services.RemoveAll(
typeof(System.Web.Http.Validation.ModelValidatorProvider), 
v => v is InvalidModelValidatorProvider); 
```

或者只是将 DataContract 应用于您的课程：

```
[DataContract]
public class MyClass {

[DataMember(isRequired=true)]
public string AccountTypeID { get; set; }

[DataMember(isRequired=true)]
public int CallerID { get; set; }
} 
```

另一种解决方法，将 int 标记为可为空：

```
[Required]
public int? CallerID { get; set; } 
```

# iphone - 如何呈现视频并仅旋转它？

> ID：14225836
> 
> 赞同：0
> 
> 时间：2013-01-08T23:27:35.603
> 
> 标签：iphone, ios, ipad, video, mpmovieplayercontroller

我想做的很简单。

我有一个`UIViewController`（仅限纵向！）并且在它的视图内我想显示一个视频（在视图的一部分中）。然后我想添加一个`UIButton`使用户能够全屏显示视频。当视频全屏时，我希望视频跟随设备的方向，而不是`UIViewController`呈现视频，这样如果用户处于横向并退出全屏模式，则`UIViewController`应该是纵向的！我还想在视频全屏时添加自定义控件。

你知道我应该怎么做吗？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-09T02:14:50.280

我以前做过。只是`setTransform:CGAffineTransformMakeRotation(M_PI/2)`

```
- (void)rotateVideoToLandscape {

    int64_t delayInSeconds = 0.5;
    dispatch_time_t popTime = dispatch_time(DISPATCH_TIME_NOW, delayInSeconds * NSEC_PER_SEC);
    dispatch_after(popTime, dispatch_get_main_queue(), ^(void){
        [[UIApplication sharedApplication] setStatusBarOrientation:UIInterfaceOrientationLandscapeRight];
    });

    // Before rotate the video, exchange the width & height for a better user-experience.
    [self.view setBounds:CGRectMake(0, 0, self.view.height, self.view.width)];
    [self.view setCenter:CGPointMake(self.view.width/2, self.view.height/2)];
    [self.view setTransform:CGAffineTransformMakeRotation(M_PI/2)];

    CGRect playerRect = self.view.bounds;
    // Do something needed.
    self.moviePlayerController.view.frame = playerRect;
} 
```

# html - HTML Agility 中的 XPath 使用

> ID：14225837
> 
> 赞同：0
> 
> 时间：2013-01-08T23:27:35.823
> 
> 标签：html, html-agility-pack

我在使用 Chrome 提供给我的一些 XPath 时遇到问题。我现在尝试使用的示例位于[http://magic.tcgplayer.com/db/magic_single_card.asp?cn=Jace,%20Memory%20Adept](http://magic.tcgplayer.com/db/magic_single_card.asp?cn=Jace,%20Memory%20Adept)

我试图用页面顶部的蓝色背景来隔离价格。Chrome说xpath是

```
//*[="inputForm"]/table[1]/tbody/tr[1]/td/div/table/tbody/tr/td[5]/center/b 
```

并基于此，我试图通过这样做来创建一个带有价格金额的字符串：

```
var baseNode = document.DocumentNode.SelectSingleNode("//*[=\"inputForm\"]//table[1]//tbody//tr[1]//td//div//table//tbody//tr//td[5]//center//b");
String price = baseNode.InnerText; 
```

哪个与消息一起崩溃

> 你调用的对象是空的。

我不确定在这里做什么，我可以使用一些帮助。谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-13T17:18:32.153

大多数情况下，您**无法**获取浏览器调试工具（Chrome、FF 等）提供的 XPATH 并在 Html Agility Pack 等工具中使用它。

原因是浏览器为您提供了内存中元素的 XPATH，而 Html Agility Pack 将从源 HTML 流中看到 XPATH。

两个 XPATH 表达式之间最常见的差异是浏览器添加的元素；例如 TBODY。TBODY 很少在 HTML 文件中定义，但总是由浏览器添加。所以你可以试试这个：

```
//*[="inputForm"]/table[1]/tr[1]/td/div/table/tr/td[5]/center/b 
```

但我当然不保证它会起作用。最好的办法是让人类查看源 HTML，并提出一个很好的判别（和未来容忍）XPATH 表达式，例如：

```
//myElement[@class='someclass'] 
```

意思是“获取所有具有‘class’属性的‘myElement’标签，其值为‘someclass’。

我们可以在 HTML 源代码和您想要获取的元素方面提供更多帮助。

**编辑**：要在您提供的 url 中以蓝色显示价格，如果您快速查看它，您会看到判别式正是颜色，因此您可以想象这样的 XPATH：

```
//td[@bgcolor='#D1DFFC']//b 
```

威奇的意思：

1.  从根 (/)
2.  递归获取文档中的任何 TD 元素（double / 表示递归），其 BGCOLOR 属性的值等于“#D1DFFC”
3.  从该 TD 中递归查找并搜索 B 元素。

所以像这样的 C# 代码：

```
 HtmlDocument doc = new HtmlDocument();
        doc.Load(yourHtmlFile);

        foreach (HtmlNode node in doc.DocumentNode.SelectNodes("//td[@bgcolor='#D1DFFC']//b"))
        {
            Console.WriteLine(node.InnerHtml);
        } 
```

将显示

```
$17.91 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-13T23:45:02.763

检查[xpathify](https://metacpan.org/module/xpathify) / [untemplate](https://metacpan.org/module/SYP/HTML-Untemplate-0.015/bin/untemplate)工具。两者都生成非常兼容（和人类可读）的 XPath 查询：

![射击](../Images/ef3deef176bb8ff19b87221b6b1025ce.png)

# c# - 请求和处理用户授权之间的会话更改

> ID：14225840
> 
> 赞同：1
> 
> 时间：2013-01-08T23:27:50.253
> 
> 标签：c#, oauth-2.0, dotnetopenauth

我正在尝试实现一个简单的登录页面，将用户重定向到 OAuth2.0 登录服务器，然后在他们成功登录后返回回调 URL。

但是我不断收到错误消息的异常：

> 收到与预期值不匹配的回调和客户端状态的意外 OAuth 授权响应。

通过调试，我注意到在调用“RequestUserAuthorization()”之前和之后的会话 id 是不同的。

我从一些 SO 答案中读到我需要以某种方式防止会话更改，但不确定如何在这种情况下实现这一点。

任何帮助将不胜感激，谢谢！

我的提炼实现如下：

```
private readonly WebServerClientCustomImpl _oauthClient = new WebServerClientCustomImpl();

public ActionResult Login()
        {    
            IAuthorizationState auth = null;

            auth = _oauthClient.ProcessUserAuthorization();

            if (auth == null)
            {
                _oauthClient.RequestUserAuthorization(returnTo: _redirectUrl);
            }
            else
            {
                // Save authentication information into cookie.
                HttpContext.Response.Cookies.Add(auth.CreateAuthCookie());

                return RedirectToAction("Index", "Home");
            }

            ViewBag.Message = "Future login page...";
            return View();
        } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-09T00:31:31.500

如果您在大多数情况下更改 SessionId 有问题，则意味着该用户的 Session 对象中没有任何内容。只需向 session 添加任何内容，SessionId 对用户应该保持不变：

```
Session["UserIsHere"] = true; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-01-13T18:14:32.387

我有同样的信息，但不同的问题。

我在 google oauth 面板中注册的 url（来源和重定向）以 www 开头。

有些用户在没有 www 的情况下上网，并收到错误消息。

即Google cpanel conf：http://www.somesite.com，重定向到http://www.somesite.com/oauth2

一些用户访问 http://somesite.com。

解决方案：限制用户只能使用www版本或者将裸域重定向到www，所以认证请求总是来自Oauth面板中注册的域。

希望能帮助到你！

# javascript - 与 location.hash 结合使用时与 jQuery.animate() 的并发症

> ID：14225842
> 
> 赞同：2
> 
> 时间：2013-01-08T23:27:56.867
> 
> 标签：javascript, jquery, firefox, slider

我写了一个基于 jQuery 的小滑动脚本。要记住哪个幻灯片当前处于活动状态并在重新加载时恢复此幻灯片，将`location.hash`更新。在 Chrome 中，这工作得很好。在 Opera 和 Firefox 中，动画显示了一些奇怪的行为。尽管 CSS 属性已更新为正确的值，但在两张幻灯片之间滑动结束。此行为仅在`location.hash`更新属性时出现。

结合这两种机制时是否存在已知的并发症？我真的无法想象它们是如何相互影响的。

相关的 JavaScript 代码：

```
var currentPage = 0;
var lock = false;
var transitionTime = 500;

function changePage( direction ) {
    if( lock )
        return;

    var currIndex = currentPage;
    var nextIndex = currentPage + direction;

    var cPage = $( '#page' + currIndex );
    var nPage = $( '#page' + nextIndex );

    if( cPage.length == 0 || nPage.length == 0 )
        return;

    // Set lock
    lock = true;

    // Animate scrolling container
    var newPosition = -800 * nextIndex;
    $( '#scroller' ).animate( {
        left: newPosition
    }, transitionTime, function() {
        // Remove lock
        lock = false;
    } );

    currentPage = nextIndex;
    location.hash = 'page' + nextIndex;
} 
```

[**jsFiddle**](http://jsfiddle.net/sXGX3/show/)从地址栏中 删除`/show/`以访问 jsFiddle 编辑页面。导航是通过箭头键完成的。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-08T23:57:30.437

`div`经过测试，当滚动条向左移动时，包装器似乎向左移动了一点`div`。将包装器的位置更改为`div`，`fixed`它将解决您的问题。

```
div#wrapper {
    height: 220px;
    left: 50%;
    margin-left: -375px;
    margin-top: -150px;
    position: fixed;
    top: 50%;
    width: 680px;
} 
```

快乐编码！这是示例[小提琴](http://jsfiddle.net/bplumb/y56x7/2/show/)。

# ios - iOS - 点对点 (p2p) 视频聊天，如何通过互联网连接设备

> ID：14225843
> 
> 赞同：2
> 
> 时间：2013-01-08T23:28:02.660
> 
> 标签：ios, p2p, data-transfer, videochat

我正在构建一个想要包含视频/语音聊天功能的应用程序。我已经知道如何将视频帧捕获为图像、音频等，然后可以传输，但我很好奇如何直接将 2 个设备相互连接以获得最佳性能。

我不是在寻找第 3 方库（是的，我知道 OpenTok、iDoubs 等）。我只是好奇如何使用 P2P 功能从头开始完成这项任务。

有哪些框架或 API 可以帮助直接通过互联网（不是本地 wi-fi 或蓝牙）将设备相互连接？

# c# - 发布图片

> ID：14225845
> 
> 赞同：0
> 
> 时间：2013-01-08T23:28:08.603
> 
> 标签：c#, asp.net, asp.net-mvc, asp.net-mvc-3

嗨，我正在尝试发布图像，但我必须遗漏一些东西，因为我得到的只是一个字符串作为回报。这是我的代码：

```
 @using( Html.BeginForm("Create", "ProductManager", FormMethod.Post,new{enctype="multipart/form-data"})){
        <input type="file" class="text-box single-line" id="ProductImagePath" name="ProductAvatar" />           
     }

    [HttpPost]
    public ActionResult Create(  FormCollection collection)
    {
        var imagePosted = collection["ProductAvatar"]; 
    } 
```

imagePosted 只返回 null。我做错了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-09T00:46:41.717

您是否尝试过查看要发布到控制器的内容？打开开发者工具/FireBug 并预览。在 Chrome 中，您可能会看到类似于以下内容的内容：

```
------WebKitFormBoundaryWKyJnLI9EtN9Hqca
Content-Disposition: form-data; name="ProductAvatar"; filename="default.jpg"
Content-Type: image/jpeg 
```

确保文件输入的名称参数与 HttpPostedFileBase 输入参数的名称相同。确保您没有其他同名输入。

最后，在 Debug 中运行您的项目。在您的操作上设置断点。转到立即窗口。闲逛。看看

```
 Request.Files 
```

有什么对你有好处的；）

祝你好运 ：）

# c++ - 在 VC++ 11 中使用别名声明

> ID：14225846
> 
> 赞同：7
> 
> 时间：2013-01-08T23:28:13.637
> 
> 标签：c++, visual-c++, c++11

以下代码示例使用 C++11 中的新别名声明无法使用 VC++ 11 编译，在 VS2012 中更新 1 并发出包含的错误。它在 Windows 7 上的 MinGW 下使用 GCC 4.7.2 使用`g++ -std=c++11 -Wall in.cpp`.

我没有发现任何不支持此功能的迹象。此外，IntelliSense 不会发现任何错误，并会显示`cdptr`类型为`typedef const double *cdptr`. 我的项目设置为使用 v110 平台工具集并编译为 C++ 代码。

我怎么冤枉了微软？

```
#include <iostream>

int main()
{
    using cdptr = const double*;

    const double pi = 3.14159;
    cdptr cdp = &pi;

    std::cout << "cdp: " << (*cdp) << std::endl;

    return 0;
} 
```

构建输出：

```
1>------ Build started: Project: AliasDeclTest, Configuration: Debug Win32 ------
1>  AliasDeclTest.cpp
1>f:\aliasdecltest\aliasdecltest.cpp(9): error C2143: syntax error : missing ';' before '='
1>f:\aliasdecltest\aliasdecltest.cpp(9): error C2873: 'cdptr' : symbol cannot be used in a using-declaration
1>f:\aliasdecltest\aliasdecltest.cpp(12): error C2065: 'cdptr' : undeclared identifier
1>f:\aliasdecltest\aliasdecltest.cpp(12): error C2146: syntax error : missing ';' before identifier 'cdp'
1>f:\aliasdecltest\aliasdecltest.cpp(12): error C2065: 'cdp' : undeclared identifier
1>f:\aliasdecltest\aliasdecltest.cpp(14): error C2065: 'cdp' : undeclared identifier
========== Build: 0 succeeded, 1 failed, 0 up-to-date, 0 skipped ========== 
```

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-01-08T23:29:41.350

*MSVC11*，即使是*11 月 CTP*，也**没有**实现使用别名声明。

您可以[在此处找到](http://wiki.apache.org/stdcxx/C++0xCompilerSupport)*C++11*支持表。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-01-08T23:32:09.107

基于[此](http://msdn.microsoft.com/en-us/library/vstudio/hh567368.aspx)，Visual Studio 2012 似乎还不支持类型别名。

# objective-c - 一个线程中对 MOC 属性的更改未传播到主线程

> ID：14225847
> 
> 赞同：0
> 
> 时间：2013-01-08T23:28:30.017
> 
> 标签：objective-c, macos, core-data

我在执行获取请求并更新 4 个属性的线程中有第二个 MOC。在主线程中，我注册了 NSManagedObjectDidSaveNotification 处理程序，该处理程序合并了我的第二个 MOC 的更改。如果我在这个方法中设置一个断点并检查更新的对象，那么我确实会看到新的属性。但是，如果我在数组中添加对象 ID 并在合并 + 保存后借助它们的 ID 访问相同的对象，那么我会得到旧属性。

令人惊讶的是，我观察到在 2 个属性中，一个属性具有新价值，而另一个没有。这令人难以置信，经过几个小时的调试，我无法理解这背后的原因。如果天才们对这个问题有所了解，那将会很有帮助。

**更新**

*在我的主线程中：*

```
[[NSNotificationCenter defaultCenter] addObserver:self
                                        selector:@selector(contextDidSave:)
                                                 name:NSManagedObjectContextDidSaveNotification
                                               object:nil];

- (NSManagedObjectContext *)mainThreadObjectContext 
{

    if (myMainThreadObjectContext == nil) {
       NSPersistentStoreCoordinator *coordinator = [self persistentStoreCoordinator];
    if (coordinator != nil) {
        myMainThreadObjectContext = [[NSManagedObjectContext alloc] init];
        [myStateManagedObjectContext setPersistentStoreCoordinator:coordinator];
        [myStateManagedObjectContext setMergePolicy:NSMergeByPropertyStoreTrumpMergePolicy];
        [myStateManagedObjectContext setRetainsRegisteredObjects:NO];
        [myStateManagedObjectContext setUndoManager:nil];
    }
}
return myMainThreadObjectContext; 
```

}

**我在这个方法中合并了在线程 MOC 中所做的更改**

```
- (void) contextDidSave:(NSNotification *)notification
  {
if (![NSThread isMainThread])
{
    [self performSelectorOnMainThread:@selector(contextDidSave:) withObject:notification waitUntilDone:NO];
    return;
}
NSManagedObjectContext *moc = [notification object];
NSMutableSet *updatedObjects = [NSMutableSet set];

if (![moc isEqual:self.mainThreadManagedObjectContext] && [[moc persistentStoreCoordinator] isEqual:self.persistentStoreCoordinator])
{
    @synchronized(self)
    {

            NSDictionary *userinfoDict = [notification userInfo];
            NSSet *insertedObjectSet = [userinfoDict valueForKeyPath:@"inserted.objectID"];
            NSSet *updatedObjectSet =  [userinfoDict valueForKeyPath:@"updated.objectID"];
            [updatedObjects addObjectsFromArray:insertedObjectSet.allObjects];
            [updatedObjects addObjectsFromArray:updatedObjectSet.allObjects];

        @try {
            [self.mainThreadManagedObjectContext mergeChangesFromContextDidSaveNotification:notification];
        }
        @catch (NSException * e) {
            NSLog(@"Exception %@ when mergning contexts in -[%@ %@]", e, NSStringFromClass(self.class), NSStringFromSelector(_cmd));
        }

        if(updatedObjects.count>0)
        {
            [self performSelector:@selector(updatedStatus:) withObject:updatedObjects afterDelay:0.5];
        }

        NSError *saveError = nil;
        if (![self.mainThreadManagedObjectContext save:&saveError])
        {
            NSLog(@"Could not save objects in -[%@ %@]. Error = %@", NSStringFromClass([self class]), NSStringFromSelector(_cmd), saveError);
        }

       }

  }
  } 
```

**在主线程中，我有从 MOC 获取现有对象并更新从服务器接收到的属性的方法。但是，在我的辅助线程中，我有插入新托管对象和稍后更新属性的方法，这些属性需要很长时间才能在主线程中处理**

*在第二个线程中，我有以下代码*

```
-(void) startTaskThread
{
    thread_ = [[NSThread alloc] initWithTarget:self selector:@selector(executeTask)     
    object:nil];
    [thread_ start];
}

-(void) executeTask
{
  @synchronized(self)
  {
    [self saveContext];

     NSLog(@"\n\nStarting Task thread [%@]!!!!\n\n", self);

    for(;;)
    {
        if([[NSThread currentThread] isCancelled])
            break;

        @autoreleasepool
        {
            [condition_ lock];

            if(taskArray_.count==0)
            {
                [condition_ wait];
            }

            [condition_ unlock];

            @try {
                if(taskArray_.count>0)
                {
                    NSInvocation *invocation = [self.taskArray objectAtIndex:0];

                    if([[NSThread currentThread] isCancelled])
                        break;
                    else if(!([[NSThread currentThread] isCancelled]) && [self     
                 respondsToSelector:invocation.selector ])
                    {

                        [invocation invokeWithTarget:self];
                        [self.taskArray removeObjectAtIndex:0];
                    }

                }
            }
            @catch (NSException *exception) {
                NSLog(@"Exception %@", exception.debugDescription);
            }
            @finally {

            }
        }
    }

  }
    // Save Moc.
    if([[[self managedObjectContext] insertedObjects] count]>0 || ([[[self 
             managedObjectContext] updatedObjects] count]>0) )
    {

        NSError *error = nil;
        if(![[self managedObjectContext] save:&error])
        {
            NSLog(@"Moc Save Error %@", [error localizedDescription]);
        }

    }

     [self.managedObjectContext reset];

} 
```

**我的辅助线程中的 saveContext 方法如下：**

```
-(void) saveContext
{

if(!thread_ || [thread_ isCancelled])
{
    // Clean up cache here  //
    return;
}

_/* --- Here i have code that iterates through the properties that were received from the network and stored in a cache of NSDictionary data type */_ 

// Now i save the threaded MOC.

if([[[self managedObjectContext] insertedObjects] count]>0 || ([[[self managedObjectContext] updatedObjects] count]>0) )
{

    NSError *error = nil;
    NSLog(@"We are merging the changes now.. [%d], [%d]", [[[self managedObjectContext] insertedObjects] count], [[[self managedObjectContext] updatedObjects] count]);
    if(![[self managedObjectContext] save:&error])
    {
        NSLog(@"Moc Save Error %@", [error localizedDescription]);
    }

}

    _// I create a dispatch queue here to repeteadly call this method. This serves as a hear-beat dispatch queue that checks for updated/inserted objects every 5 seconds._

    dispatch_time_t popTime = dispatch_time(DISPATCH_TIME_NOW, delayInSeconds * NSEC_PER_SEC);
    dispatch_queue_t queue = dispatch_queue_create("com.myCompany.mocSaveQ", 0);
    dispatch_after(popTime, queue, ^(void)
    {
                       // Save Moc.
                       NSInvocation *invocation = [NSInvocation invocationWithMethodSignature:[self methodSignatureForSelector:@selector(saveContext)]];
                       invocation.selector = @selector(saveContext);
                       invocation.target = self;

                       [self addTask:invocation];

    });

    dispatch_release(queue);

} 
```

现在，在调试器中，我尝试在线程/第二个 MOC 上调用 [NSManagedObjectContext save] 之前在线程中打印更新的对象，并且我确实看到了应用于该托管对象的相应属性的更改。但是，当我尝试在我的主线程中为 contextDidSave: 方法中的更新对象打印通知对象的 userInfo 字典时，尽管它列出了相同的对象，但只有一个在线程中更新的属性没有新值。这让我很困惑。

**更新 2**

这里有更多代码可以帮助更好地理解它。

**在我的主线程中**

*数据字典是一个包含属性和子字典的 NSDictionary*

```
-(void) processData:(NSDictionary*) data
 {
      for(NSString *key in data)
      {
        NSFetchRequest *fetchRequest = [[NSFetchRequest alloc] init];
        fetchRequest.entity = [NSEntityDescription entityForName:@"MyEntity" inManagedObjectContext:self.managedObjectContext];
    fetchRequest.predicate = [NSPredicate predicateWithFormat:@"lookupKey = %@", key];
    NSArray *fetchResults = nil;
    NSError *error = nil;

    @synchronized(@"fetch_request_for_lookupKey")
    {
        @try
        {
            fetchResults = [moc executeFetchRequest:fetchRequest error:&error];
        }
        @catch (NSException *exception)
        {
            NSLog(@"Exception %@ when executing fetch %@", exception, NSStringFromSelector(_cmd));
        }
        @finally
        {
            [fetchRequest release];
        }
    }

            NSManagedObject* myManagedObject = fetchResults.lastObject;
            // We get the dictionary here
            NSDictionary *dictionary = [taskDictionary objectForKey:lookUpKey];

            for(NSString *subKey in dictionary)
            {

                 if([key isEqualToString:@"name"])
                 {
                        myManagedObject.name = [dictionary objectForKey:subKey];
                 }
                 else if([key isEqualToString:@"phone"]
                 {   //....Update the value...//      }

            }
      }
 } 
```

**现在在我的辅助线程类中，我在辅助线程的 saveContext 方法中有上面列出的数据处理逻辑。如果您在上面看到，那么我会保存我的主线程 MOC，然后才在我的线程中执行 NSFetchRequest。我还确保在执行保存之后和在我的辅助线程中执行 NSFetchRequest 之前，主 MOC 中没有更新的对象。**

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-09T01:11:27.537

这就是我在文档中找到的：

> **并发**
> 
> Core Data 使用线程（或序列化队列）限制来保护托管对象和托管对象上下文（请参阅“Core Data 的并发性”）。这样做的结果是上下文假定默认所有者是分配它的线程或队列——这由调用其 init 方法的线程确定。因此，您不应该在一个线程上初始化上下文，然后将其传递给另一个线程。相反，您应该将引用传递给持久存储协调器，并让接收线程/队列创建一个从中派生的新上下文。如果使用 NSOperation，则必须在 main（对于串行队列）或 start（对于并发队列）中创建上下文。
> 
> 在 OS X v10.7 及更高版本和 iOS v5.0 及更高版本中，当您创建上下文时，您可以指定将使用它的并发模式（请参阅 initWithConcurrencyType:)。

因此，正如它所说，我建议使用这种方法来获取 MOC 对象：

```
- (id)initWithConcurrencyType:(NSManagedObjectContextConcurrencyType)ct; 
```

# javascript - 如何使用 ng-checked 在 angularJs 中预选复选框

> ID：14225855
> 
> 赞同：11
> 
> 时间：2013-01-08T23:29:18.307
> 
> 标签：javascript, ruby, sinatra, angularjs, haml

我似乎无法让它发挥作用。所以我有一堆类型的电影，我希望检查它们是否是用户数据库中的类型。这是我的代码

```
 %section(ng-controller="UserCtrl" ng-init="user_genres=#{preferred_genres}")
    %ul
         %li(ng:repeat="genre in preferred_genres")
            %input(type = "checkbox" ng:model="preferred_genres[genre]" id="genre-{{$index + 1}}" ng-checked="user_genres['{{genre}}']")
            %label{:for => "genre-{{$index + 1}}"} {{genre}} 

```

这是`#{preferred_genres}`来自haml

```
 {"Action & Adventure":true,"Animation":true,"Art House & International":true,"Classics":true,"Comedy":true,"Documentary":true,"Drama":true,"Horror":true,"Kids & Family":true,"Musical & Performing Arts":true,"Mystery & Suspense":true,"Romance":true,"Science Fiction & Fantasy":true,"Special Interest":true,"Sports & Fitness":true,"Television":true,"Western":true} 

```

所以这意味着应该检查每个复选框。但是当我加载页面时没有选中复选框。但是，如果我硬编码`ng-checked`成这样的东西，它就可以工作。

```
 ng-checked="user_genres['Western']" 

```

这真的很奇怪。请帮忙。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2013-01-08T23:47:57.893

的值`ng-checked`需要是一个表达式。摆脱 {{}}。所以，像这样：

```
 %input(type = "checkbox" ng-model="preferred_genres[genre]" id="genre-{{$index + 1}}" ng-checked="user_genres[genre]") 
```

此外，您甚至不需要该`ng-checked`指令。如果您的模型的值为真，那么它将为您检查。

# image-processing - ArrayFire 在 NVIDIA Fermi 上做卷积时内存不足？

> ID：14225861
> 
> 赞同：0
> 
> 时间：2013-01-08T23:29:56.087
> 
> 标签：image-processing, cuda, computer-vision, gpu, arrayfire

我正在尝试使用 ArrayFire 对[9000x9000 像素 3 通道图像](http://dl.dropbox.com/u/35993/9k_x_9k.png)执行卷积，大约为 75MB。我的 GPU 是具有 1536MB RAM 的 NVIDIA GTX480。我希望 ArrayFire 使用 75MB 的输入图像和大约 75MB 的输出图像。但是，ArrayFire 运行了一段时间，最终说它内存不足：

```
Memory Usage: 1325 MB free (1536 MB total) //printed before calling convolutionTest()
warning: device memory is low //printed in convolutionTest()
src/gena/gi_mem.cpp:349: error: tried to allocate 309mb (45mb free / 1536mb total) //exception 
```

**在具有 1536MB 内存的 GPU 上对 75mb 图像执行卷积时，ArrayFire 会耗尽内存。为什么会发生这种情况，我该怎么办？**

* * *

代码：

```
#include <stdio.h>
#include <arrayfire.h>
using namespace af;

static const float h_sobel[] = {-2.0, -1.0,  0.0,
                                -1.0,  0.0,  1.0,
                                0.0,  1.0,  2.0}; // 3x3 sobel weights

static void convolutionTest() {
    array sobel_k = array(3, 3, h_sobel);
    array img_gray = loadimage("9k_x_9k.png", false); // 'false' makes it a 1 channel grayscale [0-255]
    array img_convolved = convolve(img_gray, sobel_k); // should I preallocate the output space?
}

int main(int argc, char** argv) {
    try {
        info();
        convolutionTest();
    } catch (af::exception& e) {
        fprintf(stderr, "%s\n", e.what()); //prints src/gena/gi_mem.cpp:349: error: tried to allocate 309mb (45mb free / 1536mb total)
    }
    return 0;
} 
```

* * *

系统配置及注意事项：

*   阵列火 1.9
*   Ubuntu 10.04
*   CUDA 5.0
*   NVIDIA GTX480 (Fermi) GPU，拥有 1536MB 内存
*   `helloworld`和其他 ArrayFire 示例正常工作
*   ArrayFire 的卷积对较小的图像（例如 512x512 像素）没有问题

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-09T00:08:49.397

这是 loadImage 函数中的一个错误。它正在所有三个通道中加载，导致它占用了不必要的内存。AccelerEyes 将在下一个晚上之前修复它，并尽快报告。

# python - 芹菜 3.0.12 倒计时不起作用

> ID：14225865
> 
> 赞同：0
> 
> 时间：2013-01-08T23:30:07.360
> 
> 标签：python, celery

当我运行我的任务时：`my_task.apply_async([283], countdown=5)`当它应该在 5 秒后运行时，它会立即运行，正如 ETA 所说

[2013-01-08 15:15:21,600: INFO/MainProcess] 从代理获得任务：web.my_task[4635f997-6232-4722-9a99-d1b42ccd5ab6] eta:[2013-01-08 15:20:51.580994] [ 2013-01-08 15:15:22,095：INFO/MainProcess] 任务 web.my_task[4635f997-6232-4722-9a99-d1b42ccd5ab6] 在 0.494245052338 秒内成功：无

这是我的安装：

软件 -> celery:3.0.12 (Chiastic Slide) kombu:2.5.4 py:2.7.3 billiard:2.7.3.19 py-amqp: N/A platform -> system:Darwin arch:64bit imp:CPython loader -> djcelery .loaders.DjangoLoader 设置-> 传输：amqp 结果：mongodb

这是芹菜虫吗？或者我错过了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-09T21:25:39.560

这是 celery 3.0.12 中的一个错误，恢复到 celery 3.0.11 完成了这项工作。

希望这可以帮助某人

# linux - 在 ARM Embedded Linux 设备上实现服务器推送

> ID：14225873
> 
> 赞同：0
> 
> 时间：2013-01-08T23:30:39.767
> 
> 标签：linux, webserver, arm, comet, ape

我花了一些时间研究将数据从运行在嵌入式 linux arm 平台上的 Web 服务器推送到多个客户端的各种方法。我看过[APE](http://www.ape-project.org/)、[Commet](http://en.wikipedia.org/wiki/Comet_%28programming%29)等，但找不到任何适合嵌入式 arm linux 世界的东西。

有没有一种简单的方法可以将实时数据从运行在嵌入式 ARM-Linux 平台上的服务器推送到 Web 浏览器？（可能多达 20 个同时客户端连接，每个连接大约有 100 个动态数据点）

# java - 空格的转义序列是什么或帮助我的哈希函数？

> ID：14225874
> 
> 赞同：1
> 
> 时间：2013-01-08T23:30:47.227
> 
> 标签：java, function, hash, space

我到处寻找，似乎找不到空间的转义序列。我目前正在使用“”作为空间，但它不起作用。我的散列函数需要它，当它散列包含空格字符的密码时，它无法正确计算。

例如，当我在我的程序中输入“aaa aaa”时，它会输出“>&q”。我的函数应该根据密码输出一个七个字符的哈希值，但它停在空格处，只留下一个三个字符的输出。但是，在给定特定输入的情况下，该函数仍然可以输出空格。

```
import java.util.*;

public class Hasher {

    private static Scanner scan;

    /*
     * This function will generate a hash based off a password entered by the
     * user
     */
    public static void main(String[] args) {

        scan = new Scanner(System.in);

        System.out.println("What is your password?");

        String password = scan.next();

        String characters = "qwertyuiopasdfghjklzxcvbnm";
        characters = characters + characters.toUpperCase();
        characters = characters + "1234567890";
        characters = characters + " ";
        characters = characters + "!@#$%^&*()_+-=`~\b[]?-{};',./:\"<>?\\";

        char[] array = new char[2 * characters.length()];

        for (int y = 0; y < array.length; y++) {

            Random rand = new Random(y);
            array[y] = characters.charAt(rand.nextInt(characters.length()));
        }

        String newPass = "";

        for (int y = 0; y < password.length(); y++) {

            char x = password.charAt(y);

            for (int z = 0; z < characters.length(); z++) {

                if (x == characters.charAt(z)) {

                    Random rand = new Random(y);
                    x = array[z + rand.nextInt(array.length - z)];
                    newPass = newPass + x;
                    break;
                }
            }
        }

        System.out.println("Your hash is: " + newPass);

    }

} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-08T23:35:30.227

当你构造你的 Scanner 对象时，传入分隔符，`"\\n"`以便它扫描整行。

就像是： `new Scanner(System.in).useDelimiter("\\n");`

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-08T23:38:35.073

只是改变

```
String password = scan.next(); 
```

到

```
String password = scan.nextLine(); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-08T23:35:37.667

这

```
 String password = scan.next(); 
```

只读取第一个单词。[http://docs.oracle.com/javase/6/docs/api/java/util/Scanner.html#useDelimiter(java.lang.String](http://docs.oracle.com/javase/6/docs/api/java/util/Scanner.html#useDelimiter(java.lang.String) )

将分隔符设置为换行符`\n`。

# cordova - 如何从 phonegap 函数中调用 Sencha Touch 代码？

> ID：14225877
> 
> 赞同：0
> 
> 时间：2013-01-08T23:31:14.020
> 
> 标签：cordova, extjs, touch

我正在使用 Phonegap 2.2 和 Sencha Touch 2.0。

我想从 Phonegap 暂停事件中调用 Sencha Touch 特定功能，代码如下：

```
document.addEventListener("pause", onPause, false);
function onPause() {
    //sencha function here, get Ext.Viewport.getItems()
} 
```

这目前不起作用，因为它认为 Ext 是未定义的。如何获得对我的 Ext 应用程序的引用，以便我可以通过 Phonegap 操作我的 Sencha 代码？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-09T00:27:52.190

在调用设备就绪函数之前，您可能还没有初始化 Sencha Touch。只要 Sencha Touch 已经初始化，Ext.Viewport 就可以工作。

# jquery - jQuery 选择器 .parent

> ID：14225880
> 
> 赞同：1
> 
> 时间：2013-01-08T23:31:51.803
> 
> 标签：jquery, selector

> **可能重复：**
> [jquery 遍历查找父级的父级](https://stackoverflow.com/questions/8612663/jquery-traversing-to-find-a-parents-parent)

我在使用 jQuery 选择器时遇到了一个小问题，在尝试了一段时间后，我决定需要一些帮助。

我有一个名为 .submenu 的类，其中 .submenu 是一个带有“groen”类的 <p> 元素。.submenu 元素位于类“container_vragen”的 div 中。这是一个名为“#content_vragen”的容器 id。

```
<div id="content_vragen">

    <div class="container_vragen">
        <div class="submenu">
            <p class="groen">groen</p> 
        </div>
    </div>

    <div class="container_vragen">
        <div class="submenu">
            <p class="groen">groen</p> 
        </div>
    </div>

    <div class="container_vragen">
        <div class="submenu">
            <p class="groen">groen</p> 
        </div>
    </div>

</div>

$('.submenu').on('click','.groen',function() {
    $(this).parents('#content_vragen').find('.container_vragen').fadeOut(400, function() {
        $(this).parents('#content_vragen').find('.container_vragen').css('overflow', 'hidden');
        $(this).parents('#content_vragen').find('.container_vragen').appendTo("#geregeld");
        $(this).parents('#geregeld').find('.container_vragen').css('color', 'green');
        $(this).parents('#geregeld').find('.container_vragen').fadeIn(400);
    });
}); 
```

所以我相当简单的问题是：我怎样才能只对单击 .groen 类的 .container_vragen 类执行操作。我以为我必须选择它的父级（.groen 按钮）并将其返回到 .container_vragen，但这样它会选择所有 .container_vragen 元素。只是为了让事情更容易这里是整个项目的 jsFiddle：http: [//jsfiddle.net/86Hcc/](http://jsfiddle.net/86Hcc/)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-08T23:36:28.573

您可以使用最近的班级[`closest()`](http://api.jquery.com/closest/)

```
$('.submenu').on('click','.groen',function() {
    $closestDiv = $(this).closest('.container_vragen');
    $closestDiv.fadeOut(400, function() {
        $closestDiv.css('overflow', 'hidden');
        $closestDiv.appendTo("#geregeld");
        $(this).parents('#geregeld').find('.container_vragen').css('color', 'green');
       $(this).parents('#geregeld').find('.container_vragen').fadeIn(400);
   });
}); 
```

# python - 多标签 OneVsRestClassifier 的 GridSearch？

> ID：14225882
> 
> 赞同：6
> 
> 时间：2013-01-08T23:32:02.903
> 
> 标签：python, scikit-learn

我正在对多标签数据进行网格搜索，如下所示：

```
#imports
from sklearn.svm import SVC as classifier
from sklearn.pipeline import Pipeline
from sklearn.decomposition import RandomizedPCA
from sklearn.cross_validation import StratifiedKFold
from sklearn.grid_search import GridSearchCV

#classifier pipeline
clf_pipeline = clf_pipeline = OneVsRestClassifier(
                Pipeline([('reduce_dim', RandomizedPCA()),
                          ('clf', classifier())
                          ]
                         ))

C_range = 10.0 ** np.arange(-2, 9)
gamma_range = 10.0 ** np.arange(-5, 4)
n_components_range = (10, 100, 200)
degree_range = (1, 2, 3, 4)

param_grid = dict(estimator__clf__gamma=gamma_range,
                  estimator__clf__c=c_range,
                  estimator__clf__degree=degree_range,
                  estimator__reduce_dim__n_components=n_components_range)

grid = GridSearchCV(clf_pipeline, param_grid,
                                cv=StratifiedKFold(y=Y, n_folds=3), n_jobs=1,
                                verbose=2)
grid.fit(X, Y) 
```

我看到以下回溯：

```
/Users/andrewwinterman/Documents/sparks-honey/classifier/lib/python2.7/site-packages/sklearn/grid_search.pyc in fit_grid_point(X, y, base_clf, clf_params, train, test, loss_func, score_func, verbose, **fit_params)
    107 
    108     if y is not None:
--> 109         y_test = y[safe_mask(y, test)]
    110         y_train = y[safe_mask(y, train)]
    111         clf.fit(X_train, y_train, **fit_params)

TypeError: only integer arrays with one element can be converted to an index 
```

看起来像多个标签的 GridSearchCV 对象。我应该如何解决这个问题？我是否需要使用 label_binarizer 显式迭代唯一类，在每个子估计器上运行网格搜索？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-05T13:08:58.113

我认为 grid_search.py​​ 中有一个错误

您是否尝试过提供`y`numpy 数组？

```
import numpy as np
Y = np.asarray(Y) 
```

# javascript - 如何向我的函数添加更多参数？

> ID：14225886
> 
> 赞同：1
> 
> 时间：2013-01-08T23:32:07.973
> 
> 标签：javascript, node.js, express, connect, passport.js

我正在使用 NodeJS、快递和护照。但是我认为这个问题只是关于javascript。在我的路线文件中，我有

```
app.get(  '/users', login_req, user.index); 
```

所以当服务器在/users收到get请求时，会`req, res, next`通过login_req函数，如果用户被授权，login_req会调用user.index函数。我想知道是否以及如何向 login_req 添加更多参数？我的目标是能够传递其他参数，例如`login_req(['admin'],['user1', 'user2'])`能够选择哪些用户可以访问 user.index。

这是我的 login_req 代码：

```
exports.login_req = function(req, res, next) {
  if (req.isAuthenticated()) { return next(); }
  res.redirect('/login')
} 
```

我想，总的来说，我想知道如何将更多参数附加到回调中。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-08T23:59:42.333

上面的答案应该有效，但是我正在寻找一个更有条理的解决方案。使用我从上述答案中学到的知识，我想出了以下内容。

我从[jQuery](https://stackoverflow.com/questions/939032/jquery-pass-more-parameters-into-callback)中了解到如何将更多参数添加到回调中。这是我的代码：

```
exports.login_req = function(groups, users) {
  return function(req, res, next) {
    console.log(groups, users)
    if (req.isAuthenticated()) { return next(); }
    res.redirect('/login')
  };
} 
```

和

```
app.get(  '/users', login_req("group1"), user.index); 
```

login_req 的回调传递 groups = "group1" 和 users = undefined。`req, res, next`login_req 返回带有 args和的匿名函数`groups, users`，可通过闭包获得。我已经打印出组和用户以进行概念验证，它似乎有效。

我更喜欢这种方法，因为现在我可以像这样组织我的 routes.js 文件：

```
app.get(  '/users',          login_req("admins"),     user.index);
app.get(  '/users/new',                               user.new);
app.post( '/users',                                   user.create);
app.get(  '/users/:id',                               user.show);
app.get(  '/users/:id/edit', login_req("admins", "user1"), user.edit);
app.put(  '/users/:id',      login_req("admins", "user1"), user.update);
app.del(  '/users/:id',      login_req("admins", "user1"), user.destroy); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-08T23:34:59.490

传递一个匿名函数`get`并从中调用`login_req`：

```
app.get('/users', function (req, res, next) {
    login_req(req, res, next, something, somethingElse);
}, user.index); 
```

# javascript - 查找所有元素具有除某些指定属性之外的任何属性

> ID：14225887
> 
> 赞同：1
> 
> 时间：2013-01-08T23:32:21.033
> 
> 标签：javascript, attributes

我怎样才能找到所有元素都具有除某些指定属性之外的任何属性？例如：除 (href + title + id) 之外的任何其他属性。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-08T23:41:25.477

```
var attrs = ["href", "title", "id"],
    els = document.getElementsByTagName("*"),
    result = Array.prototype.slice.call(els).filter(function(el) {
        if (el.attributes.length === 0)
            return false;

        for (var i = 0, l = attrs.length; i < l; i++) {
            if (el.hasAttribute(attrs[i]))
                return false;
        }
        return true;
    });

console.log(result); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-08T23:39:02.310

The only way to do this is to loop through ALL elements in the page and filter out the ones you don't want.

In this implementation, you pass an array of the attributes that you want to ignore (and optionally a tag type) and it returns an array of elements that have some attribute other than one of those you passed in:

```
function getElemsWithOtherAttribute(attArray, tags) {
    tags = tags || "*";
    // put all passed in attributes in an object for fast lookup
    // add leading underscore to avoid any built-in property conflicts
    var attLookup = {}, i, j, len, results = [], atts;
    for (i = 0, len = attArray.length; i < len; i++) {
        attLookup["_" + attArray[i].toLowerCase()] = true;
    }
    // get all elements and loop through them all
    var elems = document.getElementsByTagName(tags);
    for (i = 0, len = elems.length; i < len; i++) {
        // get all attributes on this element and loop through them all
        // until we find one that isn't in our attLookup object
        atts = elems[i].attributes;
        for (j = 0; j < atts.length; j++) {
            // if we have an attribute name that is not in our passed in list, then
            // add this element to the results array
            if (attLookup["_" + atts[j].name.toLowerCase()] !== true) {
                results.push(elems[i]);
                break;
            }
        }
    }
    return(results);
}

// example usage
var regAttributes = ["href", "title", "id"];
var items = getElemsWithOtherAttribute(regAttributes, "img"); 
```

This uses the `.attributes` collection to get a list of all attributes specified in the HTML for a given element and then looks at the `.name` property on the attribute node to see what the name of that given attribute is.

# c# - 出现错误：合同需要 Duplex，但绑定“BasicHttpBinding”不支持它或未正确配置以支持它

> ID：14225888
> 
> 赞同：11
> 
> 时间：2013-01-08T23:32:27.277
> 
> 标签：c#, wcf, silverlight, wcf-binding, duplex

我有一个 WCF 服务和一个 Silverlight 5 客户端。我定义了以下接口：

```
[ServiceContract(Namespace = "Silverlight", CallbackContract = typeof(IDuplexClient))]
public interface IDuplexService
{
    [OperationContract]
    void Subscribe(string userId);

    [OperationContract]
    void Unsubscribe(string userId);
}

[ServiceContract]
public interface IDuplexClient
{
    [OperationContract(IsOneWay = true)]
    void PushNotification(string msg);
} 
```

这是我的 Web.config 文件：

```
<configuration>
  <system.serviceModel>
    <behaviors>
      <serviceBehaviors>
        <behavior name="">
          <serviceMetadata httpGetEnabled="true" />
          <serviceDebug includeExceptionDetailInFaults="false" />
        </behavior>
      </serviceBehaviors>
    </behaviors>
    <serviceHostingEnvironment multipleSiteBindingsEnabled="true" />
  </system.serviceModel>
</configuration> 
```

当我尝试运行该服务时，我得到：

> 由于编译期间出现异常，无法激活服务“/ServerService.svc”。异常消息是：Contract 需要 Duplex，但 Binding 'BasicHttpBinding' 不支持它或未正确配置以支持它。

我知道我需要向 Web.config 添加一些属性，但是无论我在哪里（以及无论我尝试过什么），我都无法让它工作。

我是 WCF 的新手，我希望您能在该主题上提供帮助。我所有的谷歌搜索都让我无处可去，在这里问同样问题的人得到的答案对我不起作用。

所以我决定放弃搜索，只是问问。

**更新：**我使用此链接创建界面 - [http://msdn.microsoft.com/en-us/library/cc645027%28v=vs.95%29.aspx](http://msdn.microsoft.com/en-us/library/cc645027%28v=vs.95%29.aspx)

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2013-01-08T23:51:10.240

如果这是 WCF 的 web.config 配置的范围，那么您缺少定义您的合同的部分：

```
<services>
  <service name="WebApplication1.Service1">
    <endpoint address="" binding="wsDualHttpBinding" contract="WebApplication1.IService1" />
    <endpoint address="mex" binding="mexHttpBinding" contract="IMetadataExchange" />
  </service>
</services> 
```

如果您确实指定了此部分，则另一个可能的原因是合同名称不完全限定；它必须包括完整的命名空间，而不仅仅是合同的名称。

这是完整的 System.ServiceModel 配置：

```
 <system.serviceModel>
    <behaviors>
      <serviceBehaviors>
        <behavior name="">
          <serviceMetadata httpGetEnabled="true" />
          <serviceDebug includeExceptionDetailInFaults="false" />
        </behavior>
      </serviceBehaviors>
    </behaviors>
    <serviceHostingEnvironment multipleSiteBindingsEnabled="true" />
    <services>
      <service name="WebApplication1.Service1">
        <endpoint address="" binding="wsHttpBinding" contract="WebApplication1.IService1" />
        <endpoint address="mex" binding="mexHttpBinding" contract="IMetadataExchange" />
      </service>
    </services>
  </system.serviceModel> 
```

在这种情况下，应用程序命名空间是WebApplication1，服务的类名是Service1（即Service1.svc），Service1实现的接口是IService1。

# wcf - 我必须向 WCF 端点发送什么样的参数才能将条目插入到与另一个表有关系的表中？

> ID：14225899
> 
> 赞同：2
> 
> 时间：2013-01-08T23:33:57.387
> 
> 标签：wcf, web-services, entity-framework, visual-studio-2012, ef-model-first

我正在使用 Visual Studio 2012 并在 C# 上进行开发。我刚开始使用 WCF Web 服务，我通过 Model First 方法创建了数据库，到目前为止，我已经能够在简单的表中插入、更新、删除和获取条目，但是我遇到了一个问题：我不知道如何为与另一个表有关系的表发送参数。

为了更好地解释我的疑问，这里有一个例子：我有一个 Regions 表，然后我有另一个名为 Clusters 的表，一个区域有许多集群，一个集群属于一个区域。

EF 创建的结果类如下所示：

```
public partial class Regions
{
    public Regions()
    {
        this.Clusters = new HashSet<Clusters>();
    }

    public int RegionId { get; set; }
    public string Name { get; set; }
    public string Point { get; set; }
    public System.DateTime CreatedDateTime { get; set; }
    public System.DateTime UpdatedDateTime { get; set; }

    public virtual ICollection<Clusters> Clusters { get; set; }
}

public partial class Clusters
{

    public int ClusterId { get; set; }
    public System.DateTime CreatedDateTime { get; set; }
    public System.DateTime UpdatedDateTime { get; set; }

    public virtual Regions Region { get; set; }
} 
```

有了这种关系，我怎么能添加一个新的Cluster呢？我添加新集群的端点接收到一个字符串，它是一个 JSON 字符串，我将它反序列化为一个集群对象。我这样反序列化：

```
 Clusters cluster = new JavaScriptSerializer().Deserialize<Clusters>(data); //data is the JSON string 
```

在这种情况下，我将发送到 JSON 字符串的唯一信息将是集群所属的区域（创建对象时的 DateTime 正在服务器端添加），但是我如何发送将区域信息转换为 JSON 以便可以将其添加到集群中？

我的意思是，我必须发送一个看起来像这样的 JSON 字符串吗？

```
{"RegionId":2} 
```

因为如果我这样做，就没有条目，我还需要别的吗？

我对使用 EF 和 WCF Web 服务真的很陌生，任何帮助都将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-09T08:44:16.433

据我所知，您有两种保存集群的方法。第一个是作为储蓄或地区的副产品。如果您有基本的 CRUD WCF 端点，您可以简单地在客户端中构建您的区域实体，添加集群，然后调用 save.

```
var reg = new Region();
//set region properties
//build clusters set
for (int i = 0; i<5; i++)
    reg.Clusters.add (new Cluster {CreatedDateTime= DateTime.Now, 
                                   UpdatedDateTime = DateTime.Now});

wcfClient.SaveRegion(reg); //<-- if the back-end works with EF, this should be able 
                           //to insert one new region with five new clusters 
```

您的另一个选择是通过旨在保存集群本身的 WCF 端点来保存集群。在执行此操作之前，我建议您修改集群实体以明确具有 RegionId 字段。

```
public partial class Clusters
{

    public int ClusterId { get; set; }
    public System.DateTime CreatedDateTime { get; set; }
    public System.DateTime UpdatedDateTime { get; set; }

    public int RegionsId {get; set;}
    public virtual Regions Region { get; set; }
} 
```

实体框架应该能够自动识别 RegionsId 对应于 Regions 实体的主键。在此之后，只需确保您创建的每个集群都具有正确的 RegionsId 属性。当您调用“wcfClient.SaveCluster(cluster)”方法时，EF 会自动将该集群链接到正确的区域。

# javascript - mozRequestFullScreen(); 不工作。为什么？

> ID：14225900
> 
> 赞同：1
> 
> 时间：2013-01-08T23:34:04.927
> 
> 标签：javascript

我有：

```
function doit()
{
    document.getElementById('id1').mozRequestFullScreen();
} 
```

但它不起作用。虽然它适用于[这个网站](http://www.longtailvideo.com/blog/26517/using-the-browsers-new-html5-fullscreen-capabilities/)：

jsFiddle[在这里](http://jsfiddle.net/ispiro/LXtPA/)。

为什么？（我正在使用 FireFox。）

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-08T23:37:32.890

JSFiddle 结果显示在 iframe 中。除非此框架通过添加 mozallowfullscreen 属性明确允许全屏，否则它将静默失败：

[https://developer.mozilla.org/en-US/docs/HTML/Element/iframe#attr-mozallowfullscreen](https://developer.mozilla.org/en-US/docs/HTML/Element/iframe#attr-mozallowfullscreen)

# java - Java显示无效字符？

> ID：14225902
> 
> 赞同：1
> 
> 时间：2013-01-08T23:34:17.360
> 
> 标签：java, encryption, text, utf-8, aes

我编写了一个执行标准 AES S-Box 加密的程序。我的问题是，当我加密消息时，它应该将文本写入 JTextArea，但它只显示一堆小方框，当我尝试将它保存到文本文档时，它只会在其中添加一堆问号文本文件。我怎样才能让它显示加密的文本？或者我什至可以让它自动将其写入文本文档而不创建一堆问号？

我认为我必须使用 utf-8 文本编码，但我不知道该怎么做。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-08T23:42:54.430

您的文本被加密为二进制数据。加密后，它不在任何字符集中，也不能呈现为文本。如果您想要查看它的方法，您可以对加密数据进行 Base64 编码。

见：[http ://en.wikipedia.org/wiki/Base64](http://en.wikipedia.org/wiki/Base64)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-08T23:42:54.043

在一般情况下，算法的输出不是有效的文本。

如果您需要将其作为文本进行操作，您可以使用仅使用有效 ASCII 字符的**base-64对其进行加密。**

# opengl - 每次 OpenGL/GLUT 循环迭代的新 StdGen

> ID：14225904
> 
> 赞同：2
> 
> 时间：2013-01-08T23:34:39.133
> 
> 标签：opengl, haskell, random, state

我有一个使用 Haskell、OpenGL 和 GLUT 显示一堆随机三角形的程序。但是，我希望每次单击时都会更改随机三角形，或者具有类似性质的东西（当它们更改时并不重要）。

目前我的工作代码如下所示：

```
main :: IO ()
main = do
    (pname, _) <- getArgsAndInitialize
    createWindow $ "Haskellisa"
    -- TODO set based on command line args
    windowSize $= (Size 640 480)
    blend $= Enabled
    blendFunc $= (SrcAlpha, OneMinusSrcAlpha)
    displayCallback $= display
    keyboardMouseCallback $= Just (keyboardMouse)
    mainLoop

display :: IO ()
display = do
    clear [ ColorBuffer ]
    gen0 <- getStdGen
    let (tris,gen1) = randomTris 10 gen0
    let (cols,gen2) = randomColor4s 10 gen1
    let triColPairs = zip tris cols
    mapM_ (\(tri, col) -> drawTri tri col) triColPairs
    flush 
```

然而，每次调用 getStdGen 时显示都采用相同的 StdGen。我想要的是`let (cols,gen2)...`下一次将线路中的 gen2 用作生成器，但显然这需要某种可变状态或类似性质的东西。

做我所问的最好方法是什么，这样每次显示运行时我都会得到不同的随机性？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-08T23:44:04.183

由于您`IO`无论如何都在，您可以`gen2`通过以下方式存储[`setStdGen`](http://hackage.haskell.org/packages/archive/random/1.0.1.1/doc/html/System-Random.html#v%3asetStdGen)：

```
setStdGen gen2 
```

所以你的下一轮在你之前停止的地方起飞。

另一种选择是`split`使用而不是`StdGen`使用其中一个结果。[`newStdGen`](http://hackage.haskell.org/packages/archive/random/1.0.1.1/doc/html/System-Random.html#v%3anewStdGen)`getStdGen`

# c# - 时间：2019-04-01 标签：c#constructor and streamwriter

> ID：14225914
> 
> 赞同：0
> 
> 时间：2013-01-08T23:35:09.370
> 
> 标签：c#, class, constructor

我想创建一个通用的记录器类。这抱怨“值不能为空。参数名称：路径”。初始化对象后，我得到 logname 值但没有 log。我哪里做错了？

```
class Logger
{

    public static string log;

    public Logger(string logname)
    {
        log = logname;

    }
    StreamWriter writer = new StreamWriter(log);
} 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-01-08T23:37:39.797

试试这个：

```
...
    public Logger(string logname)
    {
         log = logname;
         writer = new StreamWriter(log);
    }
    StreamWriter writer = null;
... 
```

您有此错误，因为 first 执行以下行：

```
StreamWriter writer = new StreamWriter(log); 
```

在那一刻，字段日志为空，因为构造函数是在字段初始化之后执行的。

# python - 在python中将字符串转换为8位有符号整数

> ID：14225915
> 
> 赞同：0
> 
> 时间：2013-01-08T23:35:10.430
> 
> 标签：python, ctypes, signed, unsigned-integer

我正在尝试使用 python 和 ctypes 将电机控制系统拼凑在一起，我需要做的一件事是获取文本输入并将其转换为 8 位有符号整数。

下面是我试图调用的函数的文档。应该输入到程序中的文本是“EPOS2”

![在此处输入图像描述](../Images/9667c282c06055cc774c537795454140.png)

数据类型定义如下图（注意'char*'相当于一个8位有符号整数）

![在此处输入图像描述](../Images/2ac0bbc43de91a5d04dfb78952e13712.png)

那么如何将“EPOS2”转换为 -128 到 127 之间的值？

最终我想做的是这样的：

```
import ctypes #import the module

lib=ctypes.WinDLL(example.dll) #load the dll

VCS_OpenDevice=lib['VCS_OpenDevice'] #pull out the function

#per the parameters below, each input is expecting (as i understand it) 
#an 8-bit signed integer (or pointer to an array of 8 bit signed integers, 
#not sure how to implement that)
VCS_OpenDevice.argtypes=[ctypes.c_int8, ctypes.c_int8, ctypes.c_int8, ctypes.c_int8]

#create parameters for my inputs
DeviceName ='EPOS2'
ProtocolStackName = 'MAXON SERIAL V2'
InterfaceName = 'USB'
PortName = 'USB0'

#convert strings to signed 8-bit integers (or pointers to an array of signed 8-bit integers)
#code goes here
#code goes here
#code goes here

#print the function with my new converted input parameters

print VCS_OpenDevice(DeviceName,ProtocolStackName,InterfaceName,PortName) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-11T02:31:24.417

您的界面采用`char*`C 字符串。等效`ctypes`类型是`c_char_p`. 利用：

```
import ctypes
lib = ctypes.WinDLL('example.dll')
VCS_OpenDevice = lib.VCS_OpenDevice
VCS_OpenDevice.argtypes = [ctypes.c_char_p,ctypes.c_char_p,ctypes.c_char_p,ctypes.c_char_p]

DeviceName ='EPOS2'
ProtocolStackName = 'MAXON SERIAL V2'
InterfaceName = 'USB'
PortName = 'USB0'

print VCS_OpenDevice(DeviceName,ProtocolStackName,InterfaceName,PortName) 
```

此外，`WinDLL`通常只需要 Windows 系统 DLL。如果你的接口是`__stdcall`在 C 头文件中声明的，`WinDLL`是正确的；否则，使用`CDLL`.

此外，您的返回码被记录为`DWORD*`，这有点奇怪。为什么不`DWORD`呢？如果`DWORD*`正确，要访问返回值所指向的 DWORD 的值，可以使用：

```
VCS_OpenDevice.restype = POINTER(c_uint32)
retval = VCS_OpenDevice(DeviceName,ProtocolStackName,InterfaceName,PortName)
print retval.contents.value 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-08T23:40:42.787

You could use `ctypes`:

```
>>> from ctypes import cast, pointer, POINTER, c_char, c_int
>>> 
>>> def convert(c):
...     return cast(pointer(c_char(c)), POINTER(c_int)).contents.value
... 
>>> map(convert, 'test string')
[116, 101, 115, 116, 32, 115, 116, 114, 105, 110, 103] 
```

Which (as I just found out) matches the output of `ord`:

```
>>> map(ord, 'test string')
[116, 101, 115, 116, 32, 115, 116, 114, 105, 110, 103] 
```

Although your data type definitions list it as a `char`, not a `char*`, so I'm not sure how you'd handle that.

# eclipse - Eclipse JBoss 热代码替换

> ID：14225918
> 
> 赞同：0
> 
> 时间：2013-01-08T23:35:31.647
> 
> 标签：eclipse

我正在使用 Eclipse 4.2 和 JBoss 7。

我已经在 Eclipse 中自动检查了 Build。

即使这样，我也必须构建 EAR 文件并将其重新部署到 JBOSS 以测试我在 Eclipse 调试模式下所做的任何代码更改。

我在这里错过了什么吗？

谢谢，

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-09T09:40:52.050

eclipse中“自动构建”选项的作用是，当你修改一个类的源代码时，这个会被自动编译，这并不意味着包含该类的整个项目（即war，jar，ear ...) 在服务器中重新部署。但当然它有助于加快部署速度，因为您一直在修改的类在您手动构建或部署项目时已经编译好了。

另一方面，为避免重新部署出现问题，您最好设置 JBoss 以在取消部署/重新部署应用程序时删除工作目录中保留的与应用程序相关的文件。查看[此 stackoverflow 线程以获取更多信息](https://stackoverflow.com/questions/13370879/jboss-redeploy-changes-on-exploded-deployment-directory/13375281#13375281)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-01-13T19:33:59.377

关于“自动构建”选项：

为了让 JBoss 中的 Deployment Scanner 工作，您必须在 JBoss 中打开它。

此外，您需要在 Servers 窗口中将您的项目添加到 JBoss 服务器。寻找“添加或删除...”选项。

添加项目后，您对代码所做的任何更改都会被检测到，并且您的模块将在后台自动重新部署。如果做不到这一点并假设您的项目没有障碍，您可以使用 mvn install & mvn jboss-as:deploy 手动更新您的模块。

请注意，有时 mvn 不会获取最新的 java 代码。这似乎是一个项目配置问题。重新创建项目似乎可以解决问题。

此外，请留意重复的 persistence.xml 文件。

你只需要一个。

# django - Django：无法正确显示主页 TemplateDoesNotExist at /

> ID：14225920
> 
> 赞同：1
> 
> 时间：2013-01-08T23:35:50.210
> 
> 标签：django, django-templates, django-views

好吧，我正在开发一个新的 Django 项目，并且很难让 index.html 页面正确显示。关于如何更改以使其正确显示的任何建议？

我收到错误

```
TemplateDoesNotExist at /

index.html 
```

我对每个文件的设置如下。

我的项目名称/我的项目名称/settings.py

```
import os
PROJECT_ROOT = os.path.dirname(os.path.abspath(__file__))
STATIC_ROOT = os.path.join(PROJECT_ROOT, 'templates/static')
TEMPLATE_DIRS = (
    PROJECT_ROOT + '../templates'
) 
```

我的项目名称/我的项目名称/urls.py

```
from django.conf.urls import patterns, include, url

# Uncomment the next two lines to enable the admin:
from django.contrib import admin
admin.autodiscover()

urlpatterns = patterns('',
    url(r'^', 'apps.views.index'),
    url(r'^admin/', include(admin.site.urls)),
) 
```

myprojectname/apps/views.py from django.shortcuts import render_to_response

```
def index(request):
    return render_to_response('index.html', locals()) 
```

我也是 Django 的新手，所以不要讨厌！:) 我很乐意承认我是菜鸟...

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-09T00:46:45.617

设置您的模板目录：

```
PROJECT_DIR = os.path.dirname(__file__)
TEMPLATE_DIRS = (
    os.path.join(PROJECT_DIR, 'templates'),
) 
```

您的文件夹结构应类似于：

```
project_name/
    project_name/
        settings.py
        templates/
            index.html 
```

文件夹结构尤为重要！

如果你还没有定义你的模板加载器：

```
TEMPLATE_LOADERS = (
    ('django.template.loaders.cached.Loader', (
        'django.template.loaders.filesystem.Loader',
        'django.template.loaders.app_directories.Loader',
    )),
) 
```

我已经用 包装了标准加载`cached.Loader`器，有趣的是它只是缓存了预编译的模板。

另外，当我在这里时，请修复您的根 URL：

```
urlpatterns = patterns('',
    url(r'^$', 'apps.views.index'), 
```

请注意正则表达式末尾的额外`$`终止，否则第一个 URL 将匹配每个 URL，并且其他 URL 都没有机会匹配。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-08T23:52:10.553

尝试这个..

```
TEMPLATE_DIRS = (
    PROJECT_ROOT + '../templates/'/
) 
```

# vbscript - 如何将文件系统用作信号量

> ID：14225922
> 
> 赞同：3
> 
> 时间：2013-01-08T23:36:05.983
> 
> 标签：vbscript, clipboard

我有几个脚本试图访问剪贴板。一次只有一个脚本可以访问剪贴板。我的解决方案不起作用。这是我实施的解决方案

*   检查 clipboardLock.txt 是否存在。
*   - 如果它不存在则创建它
*   --do 进程
*   - 如果确实存在，则等待 3 秒到 10 秒并检查它是否存在

这没有很好地工作，因为两个脚本试图创建文件并出错。有没有一种技术可以保证只有一个脚本可以访问剪贴板？另外，我无权访问数据库。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-09T07:20:52.097

不要让脚本创建文件，而是让它们以独占模式打开现有文件（即，其他人无法打开它）。如果文件打开处理可以继续，否则脚本必须等待。

为了以独占方式打开文件，您可以使用[OpenTextFile](http://msdn.microsoft.com/en-us/library/314cz14s%28v=vs.84%29.aspx)打开它进行写入：

```
Const ForReading = 1, ForWriting = 2, ForAppending = 8
Set MyFile = fso.OpenTextFile(FileName, ForWriting) 
```

处理完成后，关闭文件，以便其他脚本可以尝试打开文件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-03-18T18:37:40.623

使用您的方法，vbscript 不会阻止 ForWriting 并等待文件关闭。启动以下脚本两次...首先将 msgbox“文件打开...”保持打开状态...然后再次启动。您将收到“Permission Denied”，第二个脚本将中断。On Error Resume Next 将破坏等待文件可用后再继续的目标。

```
Const ForReading = 1, ForWriting = 2, ForAppending = 8 
Set filesys = CreateObject("Scripting.FileSystemObject") 
Set filetxt = filesys.OpenTextFile("c:\somefile.txt", ForWriting, True) 
wscript.echo "File Open..."
filetxt.Close
wscript.echo "Done..." 
```

所以我看到有 4 个赞成票……这可能是如何工作的？

这是一个工作例程 - 只需坐在 while 循环中，直到文件可用：

```
lockFile

sub lockFile ()
    Dim fso, LockFile, LockFileName, done
    Const ForWriting = 2

    LockFileName = "C:\somefile.lck"
    Set filesys = CreateObject("Scripting.FileSystemObject") 
    done = false
    on error resume next 'need to evaluate error 

    while (not(done))
        err.clear
        Set filetxt = filesys.OpenTextFile(LockFileName, ForWriting, True) 
        if (err.number = 0) then 
            done = true
        else
            done = false
        end if
        wscript.echo "Error [0=file open, 70=file in use] : " & err.number
        wscript.sleep(1000) 'wait one second instead of chewing up CPU
    wend

    wscript.echo "File Open..."
    filetxt.Close
    wscript.echo "Done..."

    on error goto 0 'reset error level

end sub 
```

# c# - 如何删除自动生成的图片框中的图像？

> ID：14225924
> 
> 赞同：-2
> 
> 时间：2013-01-08T23:36:08.520
> 
> 标签：c#, .net, winforms

我想删除选中鼠标单击的图片框内的图像（其自动生成），所以我可以使用删除键或上下文菜单删除它...

这里的代码：

```
private void button1_Click(object sender, EventArgs e)
    {
 string theimage = AppDomain.CurrentDomain.BaseDirectory + @"allimages";
 string[] images = Directory.GetFiles(theimage, "*.png");
                int aa;
                for (aa = 1; aa < images.Count(); aa++)
                {
                    PictureBox myPicBox = new PictureBox();
                    myPicBox.Location = new Point(7, 240);
                    myPicBox.Width = 100;
                    myPicBox.Height = 77;
                    myPicBox.SizeMode = System.Windows.Forms.PictureBoxSizeMode.Zoom;
                    myPicBox.Margin = new Padding(3, 3, 3, 3);
                    myPicBox.Visible = true;
                    myPicBox.Image = new Bitmap(images[aa]);
                    this.flowLayoutPanel1.Controls.Add(myPicBox);
                    //myPicBox.Click += new EventHandler(curPb_Click);
                    //myPicBox.MouseUp += new MouseEventHandler(myPicBox_MouseUp);
                    myPicBox.MouseDown += new MouseEventHandler(myPicBox_MouseDown);
                    myPicBox.MouseLeave += new EventHandler(mmm_Leave);
                }

        }
        //private PictureBox senderAsPictureBox = null;
        private void mmm_Leave(object sender, EventArgs e)
        {
            PictureBox senderAsPictureBox = sender as PictureBox;
            senderAsPictureBox.BackColor = Color.Empty;
        }
        private void myPicBox_MouseDown(object sender, MouseEventArgs e)
        {
            PictureBox senderAsPictureBox = sender as PictureBox;
            MessageBox.Show(senderAsPictureBox.ToString());
            senderAsPictureBox.BackColor = Color.AliceBlue;
        } 
```

这是我想做的

![在此处输入图像描述](../Images/81de1135dc076e8f5a62cc72b22ee724.png)

逻辑：

> 用户在图片框内选择图像拇指 -> 当用户按下 [delete] 键时 -> 删除所选图像

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-09T08:13:54.830

我不明白你的问题。如果你想清除它使用这个：

```
senderAsPictureBox.Image = null;
senderAsPictureBox.Invalidate(); 
```

编辑：设置图像后，将控件的名称设置为图像路径：

```
 myPicBox.Name = images[aa].ToString(); 
```

还要创建一个新的事件处理程序来处理您的 KeyDownEvent

```
 myPicBox.PreviewKeyDown += new reviewKeyDownEventHandler(myPicBox_PreviewKeyDown); 
```

使用这种方法：

```
void myPicBox_PreviewKeyDown(object sender, PreviewKeyDownEventArgs e)
{
    PictureBox senderAsPictureBox = sender as PictureBox;
    File.Delete(senderAsPictureBox.Name);
} 
```

在您的 MouseDownHandlerMethod 中，将您的控制集中在： senderAsPictureBox.Focus();

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-10T18:45:39.350

从这里找到解决方案[Get Picturebox Path](http://social.msdn.microsoft.com/Forums/en/vbgeneral/thread/cc490738-6626-4065-bdec-ebadfc0d5a90) and SubNatural answers

所以，我会把代码留在这里供可能需要的人使用

```
 private void button1_Click(object sender, EventArgs e)
    {
 string theimage = AppDomain.CurrentDomain.BaseDirectory + @"allimages";
 string[] images = Directory.GetFiles(theimage, "*.png");
                int aa;
                  for (aa = 1; aa < images.Count(); aa++)
            {
                PictureBox myPicBox = new PictureBox();
                myPicBox.Location = new Point(7, 240);
                myPicBox.Width = 100;
                myPicBox.Height = 77;
                myPicBox.SizeMode = System.Windows.Forms.PictureBoxSizeMode.Zoom;
                myPicBox.Margin = new Padding(3, 3, 3, 3);
                myPicBox.Visible = true;
                FileStream fs = new FileStream(images[aa], FileMode.Open, FileAccess.Read);
                myPicBox.Image = Image.FromStream(fs);
                myPicBox.Name = images[aa];
                fs.Close();
                this.flowLayoutPanel1.Controls.Add(myPicBox);
                //myPicBox.Click += new EventHandler(curPb_Click);
                //myPicBox.MouseUp += new MouseEventHandler(myPicBox_MouseUp);
                myPicBox.MouseDown += new MouseEventHandler(myPicBox_MouseDown);
                myPicBox.MouseLeave += new EventHandler(mmm_Leave);
                myPicBox.PreviewKeyDown += new PreviewKeyDownEventHandler(myPicBox_PreviewKeyDown);

            }

        }
        private void myPicBox_MouseDown(object sender, MouseEventArgs e)
    {
        PictureBox senderAsPictureBox = sender as PictureBox;
        senderAsPictureBox.Focus(); // binding for clicking
        senderAsPictureBox.BackColor = Color.AliceBlue;
    }
    void myPicBox_PreviewKeyDown(object sender, PreviewKeyDownEventArgs e)
    {
        PictureBox senderAsPictureBox = sender as PictureBox;
        if (e.KeyCode == Keys.Delete)
            senderAsPictureBox.Image = null;
            senderAsPictureBox.Invalidate();
            senderAsPictureBox.Dispose();
            File.Delete(senderAsPictureBox.Name);
    } 
```

感谢大家帮助我... :) 特别是@SubNatural

# jquery - 根据幻灯片内容更改幻灯片缩略图图标

> ID：14225925
> 
> 赞同：2
> 
> 时间：2013-01-08T23:36:16.093
> 
> 标签：jquery, anythingslider

我正在使用[Wordpress 的任何滑块](http://wordpress.org/extend/plugins/anythingslider-for-wordpress/)来创建包含图像和视频的幻灯片，例如[http://www.storybox.co.nz/2011/lynx/](http://www.storybox.co.nz/2011/lynx/)

我想要链接到视频幻灯片的缩略图图标以使用不同的图标。我想这样做是为了明确一些幻灯片是视频而不是静止图像。

有没有人有提示为每张包含 iframe 的幻灯片添加一个类到相应的缩略图图标？

不幸的是，幻灯片和缩略图不使用相同的类，所以我最初选择 iframe 父 li 然后以这种方式对应的缩略图的想法是行不通的。但也许使用面板编号有什么用？

提前感谢您的帮助！

基本代码（请注意，第一张和最后一张幻灯片是克隆）：

```
<div class="anythingSlider anythingSlider-default activeSlider">
<div class="anythingWindow">
  <ul class="anythingSlider anythingBase" id="slider-342">
    <li class="cloned panel vertical">
      <div><span>
        <iframe></iframe>
        </span></div>
    </li>
    <li class="panel vertical">
      <div><img></div>
    </li>
    <li class="panel vertical">
      <div><img></div>
    </li>
    <li class="panel vertical">
      <div><img></div>
    </li>
    <li class="panel vertical activePage">
      <div>
        <iframe></iframe>
      </div>
    </li>
    <li class="cloned panel vertical">
      <div><img></div>
    </li>
  </ul>
</div>
<div class="anythingControls">
  <ul class="thumbNav">
    <li class="tooltip first"><a href="#" class="panel1"><span>1</span></a></li>
    <li class="tooltip"><a href="#" class="panel2"><span>2</span></a></li>
    <li class="tooltip"><a href="#" class="panel3"><span>3</span></a></li>
    <li class="tooltip last"><a href="#" class="panel4 cur"><span>4</span></a></li>
  </ul>
</div> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-08T23:56:30.133

假设您无法更改 HTML，请在编写 JS 函数时按元素顺序执行此操作，以根据显示的“内容”（li.控制板）。下面的例子：

```
var nth = 1;
$("li.panel").eq(nth); //get the second graphic
$("a.panel" + (nth + 1)).eq(0); //get the second link a.panel2 
```

有你的模式。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-09T18:27:01.600

我发现这很有趣，我正在努力改进我的 jquery，所以我添加了一种可能精炼/略有不同的方法，即使对任何滑块进行最合理的更改，它也应该可靠地工作（另外，我大部分时间都是昨天写的，但忘记了发布它，如果它可能对任何人有帮助，不希望它浪费）：

```
$('.anythingWindow li.panel:not(.cloned) iframe').each(function() {
  $('.anythingControls li.tooltip').eq($(this).index('.anythingWindow li.panel:not(.cloned)')).addClass('video');
}); 
```

[工作jsfiddle](http://jsfiddle.net/AakyC/1/)

您在对 sajawikio 的回答的评论中给出的解决方案差异的解释：

*   主选择器首先定位`.anythingWindow`，然后缩小到包含正确 iframe 的未克隆列表项。如果页面上还有其他 iframe，就性能而言，这应该保持相当优化，但我怀疑无论哪种方式都不会引起注意。如果嵌套结构有轻微的变化，它应该继续工作，只要使用相同的基本元素和类（你可以将一个 iframe 嵌套在 div 中，这仍然可以工作，而依赖于 2 个父母的东西up 会中断）。*   使用`.eq()`正确的值可以避免必须进行字符串连接（不确定是否有任何真正的性能变化......任何收益都可能被索引中使用的选择类消除）*   `.eq()`使用参数作为每个相对于选择类的索引（不是克隆的列表项）调用`iframe`确保如果有超过 2 个克隆它可以正常工作（加上它在语义上是正确的）。（解释一下，您的解决方案之所以有效，是因为`.index()`不带参数调用会返回相对于所有兄弟元素的位置，其中包括第一个克隆的元素`li`......如果在拥有之前`li`克隆了多个，它将​​中断，对于如果克隆不存在——也许这完全不是问题，永远不会发生，但我个人不喜欢依赖插件的明显 shim[?] 不会被更改或删除）。 `li``iframe``li`*   在我写它的时候，我假设你想将类附加到包含`li`s 的 s 上`.anythingControl`，然后使用`a`基于此的选择器访问 s ：显然两者都可以，只要合适就可以了。

# android - 在 Activity 中插入 ListView

> ID：14225931
> 
> 赞同：0
> 
> 时间：2013-01-08T23:36:47.557
> 
> 标签：android, listview, exception

我在将 ListView 插入 Activity 时遇到问题。我刚刚插入了一个从 ListActivity 扩展的列表。这很好用。我也知道如何通过选择一行来转发到另一个活动。但这一次它不起作用。我只是尝试逐行调试所有内容，并始终检查来自 LogCat 的错误消息。我也拉。但现在我不知道该做什么。一切似乎都在正确的地方。

通过记录数据库中的元素（在第二个块中），我发现最后一个元素是空的。因此，我将 for 循环减少了一个。所以整个方法“initVars()”工作，直到它结束，再次返回到“onCreate”块并停止工作。我只是复制错误消息，也许有人知道这意味着什么。

```
public class ActivityDetail extends Activity {

    TextView tvDefinition, tvDurationSingle, tvDurationMultiplied, tvSubunits;
    ListView lvExecution;
    String executions[];
    ArrayList<Execution> allExecutionsFromDatabase;
    ArrayAdapter<String> adapter;
    UserInformation userInfo = UserInformation.getInstance();
    MyFramework myFramework;

    // Extras from intent
    String definition;
    int activityId, durationSingle, durationMultiplied, subunits;

@Override
protected void onCreate(Bundle savedInstanceState) {
    // TODO Auto-generated method stub
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activitydetail);

    initVars();

}

private void initVars() {

    myFramework = new MyFramework();

    // load extras into variables
    definition = myFramework.getExtrasString("activitiyDefinition",
            getIntent().getExtras());
    activityId = myFramework.getExtrasInt("activityId", getIntent()
            .getExtras());
    durationSingle = myFramework.getExtrasInt("activityDuration",
            getIntent().getExtras());
    subunits = myFramework.getExtrasInt("activitySubunits", getIntent()
            .getExtras());
    durationMultiplied = durationSingle * subunits;

    // init ui elements
    tvDefinition = (TextView) findViewById(R.id.tvActDetailDefinition);
    tvDurationSingle = (TextView) findViewById(R.id.tvActDetailDurationSingle);
    tvDurationMultiplied = (TextView) findViewById(R.id.tvActDetailDurationMultiplied);
    tvSubunits = (TextView) findViewById(R.id.tvActDetailSubunits);
    lvExecution = (ListView) findViewById(R.id.lvActDetail);

    // get executions from db
    ActivityDB entries = new ActivityDB(this);
    entries.open();
    allExecutionsFromDatabase = entries.getSpecificExecutions(
            userInfo.getUserId(), activityId);
    entries.close(); 
```

* * *

```
 // set list array to same size as allExecutionsFromDatabase
    executions = new String[allExecutionsFromDatabase.size()];

    // insert definition of each execution in executions for listview
    for (int i = 0; i < allExecutionsFromDatabase.size() - 1; i++) {
        Execution e = new Execution();
        e = allExecutionsFromDatabase.get(i);
        executions[i] = e.getTimestamp();
        Log.e("DEFINITION", "" + e.getTimestamp());
    } 
```

* * *

```
 // init array adapter
    adapter = new ArrayAdapter<String>(ActivityDetail.this,
            android.R.layout.simple_list_item_1, executions);

    // add adapter and onClickListener to listview
    lvExecution.setAdapter(adapter);

    lvExecution.setOnItemClickListener(new OnItemClickListener() {
        @Override
        public void onItemClick(AdapterView<?> parent, View view,
                int position, long id) {

            Toast.makeText(getApplicationContext(),
                    ((TextView) view).getText(), Toast.LENGTH_SHORT).show();
            String a = ((TextView) view).getText().toString();
            if (a == "Foo")
                Toast.makeText(getApplicationContext(), "Foobar! xD",
                        Toast.LENGTH_SHORT).show();
        }
    });

} 
```

洛卡特

```
01-08 23:55:25.361: E/AndroidRuntime(23627): FATAL EXCEPTION: main
01-08 23:55:25.361: E/AndroidRuntime(23627): java.lang.NullPointerException
01-08 23:55:25.361: E/AndroidRuntime(23627):    at android.widget.ArrayAdapter.createViewFromResource(ArrayAdapter.java:355)
01-08 23:55:25.361: E/AndroidRuntime(23627):    at  android.widget.ArrayAdapter.getView(ArrayAdapter.java:323)
01-08 23:55:25.361: E/AndroidRuntime(23627):    at android.widget.AbsListView.obtainView(AbsListView.java:1430)
01-08 23:55:25.361: E/AndroidRuntime(23627):    at android.widget.ListView.makeAndAddView(ListView.java:1745)
01-08 23:55:25.361: E/AndroidRuntime(23627):    at android.widget.ListView.fillDown(ListView.java:670)
01-08 23:55:25.361: E/AndroidRuntime(23627):    at android.widget.ListView.fillFromTop(ListView.java:727)
01-08 23:55:25.361: E/AndroidRuntime(23627):    at android.widget.ListView.layoutChildren(ListView.java:1598)
01-08 23:55:25.361: E/AndroidRuntime(23627):    at android.widget.AbsListView.onLayout(AbsListView.java:1260)
01-08 23:55:25.361: E/AndroidRuntime(23627):    at android.view.View.layout(View.java:7175)
01-08 23:55:25.361: E/AndroidRuntime(23627):    at android.widget.LinearLayout.setChildFrame(LinearLayout.java:1254)
01-08 23:55:25.361: E/AndroidRuntime(23627):    at android.widget.LinearLayout.layoutVertical(LinearLayout.java:1130)
01-08 23:55:25.361: E/AndroidRuntime(23627):    at android.widget.LinearLayout.onLayout(LinearLayout.java:1047)
01-08 23:55:25.361: E/AndroidRuntime(23627):    at android.view.View.layout(View.java:7175)
01-08 23:55:25.361: E/AndroidRuntime(23627):    at android.widget.FrameLayout.onLayout(FrameLayout.java:338)
01-08 23:55:25.361: E/AndroidRuntime(23627):    at android.view.View.layout(View.java:7175)
01-08 23:55:25.361: E/AndroidRuntime(23627):    at android.widget.LinearLayout.setChildFrame(LinearLayout.java:1254)
01-08 23:55:25.361: E/AndroidRuntime(23627):    at android.widget.LinearLayout.layoutVertical(LinearLayout.java:1130)
01-08 23:55:25.361: E/AndroidRuntime(23627):    at android.widget.LinearLayout.onLayout(LinearLayout.java:1047)
01-08 23:55:25.361: E/AndroidRuntime(23627):    at android.view.View.layout(View.java:7175)
01-08 23:55:25.361: E/AndroidRuntime(23627):    at android.widget.FrameLayout.onLayout(FrameLayout.java:338)
01-08 23:55:25.361: E/AndroidRuntime(23627):    at android.view.View.layout(View.java:7175)
01-08 23:55:25.361: E/AndroidRuntime(23627):    at android.view.ViewRoot.performTraversals(ViewRoot.java:1140)
01-08 23:55:25.361: E/AndroidRuntime(23627):    at android.view.ViewRoot.handleMessage(ViewRoot.java:1859)
01-08 23:55:25.361: E/AndroidRuntime(23627):    at android.os.Handler.dispatchMessage(Handler.java:99)
01-08 23:55:25.361: E/AndroidRuntime(23627):    at android.os.Looper.loop(Looper.java:123)
01-08 23:55:25.361: E/AndroidRuntime(23627):    at android.app.ActivityThread.main(ActivityThread.java:3683)
01-08 23:55:25.361: E/AndroidRuntime(23627):    at java.lang.reflect.Method.invokeNative(Native Method)
01-08 23:55:25.361: E/AndroidRuntime(23627):    at java.lang.reflect.Method.invoke(Method.java:507)
01-08 23:55:25.361: E/AndroidRuntime(23627):    at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:839)
01-08 23:55:25.361: E/AndroidRuntime(23627):    at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:597)
01-08 23:55:25.361: E/AndroidRuntime(23627):    at dalvik.system.NativeStart.main(Native Method)
01-09 00:00:25.431: I/Process(23627): Sending signal. PID: 23627 SIG: 9 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-09T00:23:05.633

您不填充整个`executions`数组：

```
executions = new String[allExecutionsFromDatabase.size()]; 
```

当你迭代直到

```
for (int i = 0; i < allExecutionsFromDatabase.size() - 1; i++) { 
```

中的最后一个索引条目`executions`仍然为空。

这是第一次看到 - 不确定这是否是空指针 exc 的原因，也是唯一的原因:)。

# c++ - 通过成员数据在向量中搜索结构项

> ID：14225932
> 
> 赞同：16
> 
> 时间：2013-01-08T23:36:53.997
> 
> 标签：c++, algorithm, std

我对 c++ 很陌生，我正在尝试找到一种方法来搜索结构向量以查找具有特定成员数据的结构。

我知道这适用于向量中的简单类型

```
std::find(vector.begin(), vector.end(), item) != vector.end() 
```

但是可以说我有一个这样的结构：

```
struct Friend
{
  string name;
  string number;
  string ID;
}; 
```

和这样的向量：

```
vector<Friend> friends; 
```

然后向量充满了朋友。

假设我想搜索具有某个 ID 的朋友，并找出详细信息。或者从向量中删除某个结构。有没有一种简单的方法可以做到这一点？

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2013-01-08T23:39:19.047

This can be done with [`std::find_if`](http://en.cppreference.com/w/cpp/algorithm/find) and a search predicate, which can be expressed as a lambda function if you have C++11 (or C++0x) available:

```
auto pred = [](const Friend & item) {
    return item.ID == 42;
};
std::find_if(std::begin(friends), std::end(friends), pred) != std::end(friends); 
```

To use an ID given as a variable, you have to *capture* it in the lambda expression (within the `[...]`):

```
auto pred = [id](const Friend & item) {
    return item.ID == id;
};
std::find_if(std::begin(friends), std::end(friends), pred) != std::end(friends); 
```

If you don't have C++11 available, you have to define the predicate as a functor (function object). [Remy Lebeau's answer](https://stackoverflow.com/a/14226007/592323) uses this approach.

To remove elements matching the criteria as defined by the predicate, use `remove_if` instead of `find_if` (the rest of the syntax is the same).

For more algorithms, see [the STL `<algorithm>` reference](http://en.cppreference.com/w/cpp/algorithm).

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2013-01-08T23:43:37.257

Use [`std::find_if()`](http://en.cppreference.com/w/cpp/algorithm/find). @leemes and @AndyProwl showed you how to use it in a C++11 compiler. But if you are not using a C++11 compiler, then you can use it like this instead, which defines a functor comparing the ID of a given item with a previously specified ID in its constructor:

```
class MatchesID
{
    std::string _ID;

public:
    MatchesID(const std::string &ID) : _ID(ID) {}

    bool operator()(const Friend &item) const
    {
        return item.ID == _ID;
    }
};

std::find_if(vector.begin(), vector.end(), MatchesID("TheIDHere")) != vector.end(); 
```

If you have other classes in your project which use IDs, you can make this functor templated:

```
template<typename IDType>
class MatchesID
{
    IDType _ID;

public:
    MatchesID(const IDType &ID) : _ID(ID) {}

    template<class ItemType>
    bool operator()(const ItemType &item) const
    {
        return item.ID == _ID;
    }
};

std::find_if(vector.begin(), vector.end(), MatchesID<std::string>("TheIDHere")) != vector.end(); 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2013-01-08T23:40:59.820

You can use `std::find_if` in combination with functors (if you are working with C++98) or lambdas (if you are using C++11, which I will assume):

```
using namespace std;
int ID = 3; // Let's say...
auto it = find_if(begin(vector), end(vector), [=] (Friend const& f) { 
    return (f.ID == ID); 
    });
bool found = (it != end(vector)); 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-01-08T23:45:46.507

If you want to find an element in STL container, use [std::find](http://en.cppreference.com/w/cpp/algorithm/find) or [std::find_if](http://en.cppreference.com/w/cpp/algorithm/find) algorithms With C++03, you need to overload operator== for std::find

```
bool operator==(const Friend& lhs, const Friend& rhs)
{
  return lhs.ID == rhs.ID;
}

if (std::find(friends.begin(), friends.end(), item) != friends.end())
{
   // find your friend
} 
```

OR C++11 with lambda:

```
std::find_if(friends.begin(), friends.end(),  [](Friend& f){ return f.ID == "1"; } ); 
```

If you want to remove a certain element, use [std::remove_if](http://en.cppreference.com/w/cpp/algorithm/remove)

```
std::remove_if(friends.begin(), friends.end(), 
      [](Friend& f){ return f.ID == "1"; }); 
```

# javascript - 函数参数及其工作原理

> ID：14225935
> 
> 赞同：1
> 
> 时间：2013-01-08T23:37:14.557
> 
> 标签：javascript, function

我只是想更好地理解/确认函数参数在这里看到的函数中：

```
function newFunction(data, status){ 
```

该函数会专门应用于数据和状态变量吗？

我不太明白这些论点是如何运作的。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-08T23:46:00.360

**基本场景**

定义函数时，该`()`区域用于输入。这些输入映射到发送的数据。

```
function newFunction(data, status){
}
newFunction(1,2); 
```

在这种情况下，`data`将被赋予 的值`1`，并且`status`将被赋予 的值以`2`用于 的范围`newFunction`。

**不匹配的输入**

但是，它并不总是直接映射。如果发送的参数较少，则未分配的输入变量变为`undefined`.

```
function newFunction(data, status){
}
newFunction(1); 
```

在这种情况下，`data`将被赋予 的值`1`，并且`status`将被赋予 的值以`undefined`用于 的范围`newFunction`。

**参数对象**

在 的范围内`newFunction`，还可以访问名为 的对象之类的数组**[`arguments`](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Functions_and_function_scope/arguments)**。

```
function newFunction(data, status)
{
 var args = arguments;
}
newFunction(1); 
```

在这种情况下，变量`args`将保存`arguments`对象。在那里您可以检查是否`args.length`只发送了 1 个参数。在这种情况下`args[0]`，将为您提供该参数值。`1`

**函数对象**

一个函数可以用`new`关键字变成一个对象。通过`new`在函数上使用关键字，可以创建一个 Function 对象。一旦创建了 Function 对象，`this`就可以用来引用当前的 Function 对象而不是全局窗口。

```
function newFunction(data,status){
 if( this instanceof newFunction ){
  //use as a Function object
  this.data = data;
 }else{
  //use as a normal function
 }
}
var myNewFunction = new newFunction(1); 
```

在这种情况下，`myNewFunction`now 持有对 Function 对象的引用，并且可以通过点表示法或索引作为对象访问。`myNewFunction["data"]`现在`myNewFunction.data`两者的值都为 1。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-08T23:38:47.583

This means that the function **accepts** both `data` and `status` parameters. The programmer calling the funciton (you) is required for providing the parameters when calling the function (also known as **arguments**.)

Let's look at a simplified example:

```
function add(x, y) {
  return x + y;
} 
```

The function here takes two numbers, adds them together, and returns the result. Now, as a programmer, you have the benefit of adding two numbers whenever you want without having to duplicate the functionality or copy/paste whenever you need your application to perform the same functionality.

Best of all, another programmer you work with can add two numbers together without worrying about how to do it, they can just call your function.

**EDIT:** Calling the function works as follows

```
var num1 = 10;
var num2 = 15;
var z = add(num1, num2); //z = 25 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-08T23:57:59.273

```
function newFunction(data, status){ ... function code ... } 
```

这是一个名为 newFunction 的函数的 Javascript 定义。您可以将参数传递给函数。这些是变量，可以是数字或字符串，函数应该用它们来做某事。当然，函数的行为/输出取决于你给它的参数。

[http://www.quirksmode.org/js/function.html](http://www.quirksmode.org/js/function.html)

# java - 如何将英尺转换为米？

> ID：14225943
> 
> 赞同：-2
> 
> 时间：2013-01-08T23:38:28.377
> 
> 标签：java

```
import java.util.Scanner;

public class feetToMeters {
    public static void main (String [] args) {
        final double feetToMeters = 0.305;
        Scanner input = new Scanner (System.in);

        System.out.println ("Enter a value for feet: ");
        double value = input.nextDouble();

        System.out.println (value + " feet is " + " meters " + meters);
    }
} 
```

我还需要添加什么才能将英尺转换为米？谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-08T23:41:21.010

您就在那里获得了转化价值，`0.305`. 这个数字表示多少*米*等于 1*英尺*，所以要计算多少米等于`value`英尺数，我们只需乘以：

```
double meters = value * feetToMeters; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-08T23:41:02.290

With your variable names, you would need:

`double meters = value * feetToMeters;`

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-08T23:44:23.417

```
import java.util.Scanner;

public class feetToMeters {

  public static void main (String [] args) {   
  Scanner input = new Scanner (System.in);

  System.out.println ("Enter a value for feet: ");
  double value = input.nextDouble();
  double meters = value/3.2808;
  System.out.println (value + " feet is " + meters + " meters ");

    }
} 
```

# unix - 有没有更快的方法来截断 Unix 中的列

> ID：14225947
> 
> 赞同：1
> 
> 时间：2013-01-08T23:38:44.443
> 
> 标签：unix

我想在 Unix 中将 TSV 文件的第 4 列截断为给定长度。文件有几百万条记录，大小为 8GB。

我正在尝试这个，但它似乎有点慢。

```
awk -F"\t" '{s=substr($4,0,256); print $1"\t"$2"\t"$3"\t"s"\t"$5"\t"$6"\t"$7}' file > newFile 
```

有没有更快的替代品？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-09T00:08:42.953

我假设您的文件在字段之间只有一个空格字符，并且在行首没有空格。如果这是错误的，则可以对其进行增强。否则，这应该工作：

```
sed 's/^\([^ ]* [^ ]* [^ ]* [^ ]\{1,256\}\)[^ ]* /\1 /' 
```

我实际上没有用 256 个字符长的数据测试它（我用它测试过，但`\{1,2\}`我不知道它的速度与`awk`.并使用`{1,256}`.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-08T23:54:50.557

您的命令可以写得更好一些（假设您正在重新构建记录），这可能会提高一些性能：

```
awk 'BEGIN { FS=OFS="\t" } { $4 = substr($4,0,256) }' file > newFile 
```

如果您可以访问多核机器（您可能会这样做），则可以使用[GNU 并行](http://www.gnu.org/software/parallel/)。您可能想要改变您使用的核心数量（我在这里设置了 4 个）和馈入的块大小`awk`（我已经将其设置为 2 兆字节）......

```
< file parallel -j 4 --pipe --block 2M -q awk 'BEGIN { FS=OFS="\t" } { $4 = substr($4,0,2) }' > newFile 
```

* * *

* * *

这是我在我的系统上使用具有 1 亿行和 2M 块大小的 2.7G 文件进行的一些测试：

```
time awk 'BEGIN { FS=OFS="\t" } { $4 = substr($4,0,2) }' file >/dev/null 
```

结果：

```
real    1m59.313s
user    1m57.120s
sys     0m2.190s 
```

一个核心：

```
time < file parallel -j 1 --pipe --block 2M -q awk 'BEGIN { FS=OFS="\t" } { $4 = substr($4,0,2) }' >/dev/null 
```

结果：

```
real    2m28.270s
user    4m3.070s
sys     0m41.560s 
```

有四个核心：

```
time < file parallel -j 4 --pipe --block 2M -q awk 'BEGIN { FS=OFS="\t" } { $4 = substr($4,0,2) }' >/dev/null 
```

结果：

```
real    0m54.329s
user    2m41.550s
sys     0m31.460s 
```

有十二个核心：

```
time < file parallel -j 12 --pipe --block 2M -q awk 'BEGIN { FS=OFS="\t" } { $4 = substr($4,0,2) }' >/dev/null 
```

结果：

```
real    0m36.581s
user    2m24.370s
sys     0m32.230s 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-01-09T00:32:33.637

如果 Scott 或 Steve 的解决方案仍然太慢，可能是时候打破 C. Run as `./a.out < file > newFile`. 首先测试一个带有一些长字段的小文件；我不是 100% 确定我的数学是正确的。

```
#include <stdio.h>
int
main(void)
{
    int field = 1;
    int character = 0;
    int c;
    while ((c = getchar()) != EOF)
    {
        switch (c)
        {
        case '\n':
            field = 1;
            character = 0;
            break;
        case '\t':
            character = 0;
            field++;
            break;
        default:
            character++;
            break;
        }
        if (field != 4 || character < 256)
            putchar(c);
    }
    if (ferror(stdout) || fflush(stdout) || fclose(stdout))
    {
        perror("write");
        return 1;
    }
    return 0;
} 
```

# emacs - Emacs `message` function doesn't update *Messages* automatically when called from an SMIE rules-function

> ID：14225950
> 
> 赞同：1
> 
> 时间：2013-01-08T23:38:46.213
> 
> 标签：emacs, elisp, smie

I have two buffers open in Emacs, each in their own window, and one of those buffers is the `*Messages*` buffer (for the sake of example, let's say the other buffer is `*scratch*`). Most things printed to the echo area are immediately visible in the `*Messages*` buffer. In other words, if I'm in `*scratch*` and press `C-g` then "Quit" is printed to the `*Messages*` buffer right away. If I enter `(message "hi")` into the `*scratch*` buffer and `eval` it, the `*Messages*` buffer is also updated right away.

However, when I try to call the `message` function from an [SMIE](http://www.gnu.org/software/emacs/manual/html_node/elisp/SMIE.html#SMIE) `rules-function`, the `*Messages*` buffer is not updated right away, and I have to switch to it (`C-x o`) in order to see it updated, or scroll it from the other buffer (`C-M-v`).

This is obviously trivial to work around, but printing stuff with `messages` is damn useful when debugging an SMIE indentation rules function, which is what I'm doing. When I hit `tab` in a particular place in my source code, sometimes this function is called more than once, with different parameters (`:before` and `:after` for the same token, for instance), resulting in more than one line printed to `*Messages*`.

Maybe I'm barking up the wrong tree, and in actual fact the SMIE rules function should never be called more than once?? In that case I guess this would be a bug in the lexical spec for this SMIE mode? I'm fiddling with `sml-mode.el` and it's called twice when the point is on a line after a "definitional equals" for instance:

```
val x =
| 
```

where the point is `|`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-09T19:11:33.297

规则函数被调用两次是正常的。不知道为什么这些消息没有以同样的方式出现在 *Messages* 中，但这并不是因为 SMIE 做了一些特别的事情。调试 smie 规则，我个人使用 Edebug（`C-u C-M-x`在需要调试的 smie-rules 函数中命中）。

# javascript - 为什么我在循环中创建的数组不包含我在循环完成后添加的所有值？

> ID：14225956
> 
> 赞同：-1
> 
> 时间：2013-01-08T23:39:42.087
> 
> 标签：javascript, arrays

我在 Java Script 中有一个数组，我试图在循环中使用测试将其拆分为两个数组。控制台正在记录两个对象正在被存储，但在循环完成后，`inhaledArray`数组只包含一个对象。

```
for (var i=0; i<results.length; i++) 
         {
            var inhaledArray = new Array();
            var otherArray = new Array();

            if(results[i].get('MedicationType') == "inhaled")
            {
                //inhaledArray is dumping results
                console.log(results[i]);
                inhaledArray.push(results[i]);
            }
            if(results[i].get('MedicationType') == "other")
            {
                otherArray.push(results[i]);
            }
         } 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-08T23:41:05.393

您在每次迭代时*重置*输出（通过将变量指向新数组）。

将数组设置代码移出循环。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-08T23:53:37.533

亚历克斯已经回答了你的问题，但这里有一个建议。如果您有一堆存储基本相同数据的数组，请考虑使用对象：

```
var categories = {};

for (var i = 0; i < results.length; i++) {
    var name = results[i].get('MedicationType');

    if (name in categories) {
        categories[name].push(results[i]);
    } else {
        categories[name] = [results[i]];
    }
}

console.log(categories.inhaled);
console.log(categories.other); 
```

这样，您无需对任何内容进行硬编码即可说明所有类别类型。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-08T23:43:59.217

这是因为您在 forloop 中初始化数组，只需将数组初始化移动到 for 循环之前，如下所示

```
var inhaledArray = new Array();
var otherArray = new Array();

for (var i = 0; i < results.length; i++) {
    if (results[i].get('MedicationType') == "inhaled") {
        //inhaledArray is dumping results
        console.log(results[i]);
        inhaledArray.push(results[i]);
    }
    if (results[i].get('MedicationType') == "other") {
        otherArray.push(results[i]);
    }
} 
```

# java - Socket vs SocketChannel

> ID：14225957
> 
> 赞同：74
> 
> 时间：2013-01-08T23:39:58.397
> 
> 标签：java, sockets, socketchannel

I am trying to understand [SocketChannels](http://docs.oracle.com/javase/1.5.0/docs/api/java/nio/channels/SocketChannel.html), and [NIO](http://docs.oracle.com/javase/1.4.2/docs/api/java/nio/package-summary.html) in general. I know how to work with regular sockets and how to make a simple thread-per-client server (using the regular blocking sockets).

So my questions:

*   What is a SocketChannel?
*   What is the extra I get when working with a SocketChannel instead of a Socket.
*   What is the relationship between a channel and a buffer?
*   What is a selector?
*   The first sentance in the [documentation](http://docs.oracle.com/javase/1.4.2/docs/api/java/nio/channels/SocketChannel.html) is `A selectable channel for stream-oriented connecting sockets.`. What does that mean?

I have read the also [this documentation](http://docs.oracle.com/javase/1.4.2/docs/api/java/nio/package-summary.html), but somehow I am not getting it...

* * *

## 回答 #1

> 赞同：59
> 
> 时间：2013-01-09T00:31:15.990

A`Socket`是阻塞输入/输出设备。`Thread`如果底层缓冲区已满，它会使用它来阻止读取并可能阻止写入。因此，如果你的服务器有一堆 open ，你必须创建一堆不同的线程`Socket`。

A`SocketChannel`是一种从套接字读取的非阻塞方式，因此您可以让一个线程同时与一堆打开的连接进行通信。这通过将一堆`SocketChannel`s 添加到 a `Selector`，然后循环选择器的`select()`方法来工作，该方法可以通知您套接字是否已被接受、接收数据或关闭。这使您可以在一个线程中与多个客户端进行通信，而不会产生多线程和同步的开销。

`Buffer`s 是 NIO 的另一个特性，它允许您通过读取和写入访问底层数据，以避免将数据复制到新数组中的开销。

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2013-01-09T20:13:51.100

现在`NIO`太老了，很少有人记得 Java 在 1.4 之前是什么样的，这是你需要知道的，才能理解`NIO`.

简而言之，直到 Java 1.3，所有 I/O 都是阻塞类型的。更糟糕的是，没有`select()`对多路 I/O 进行系统调用的模拟。因此，用 Java 实现的服务器别无选择，只能采用“每个连接一个线程”的服务策略。

Java 1.4 中引入的 NIO 的基本点是使传统 UNIX 风格的多路复用非阻塞 I/O 的功能在 Java 中可用。如果您了解如何使用一组文件描述符（通常是套接字）进行编程`select()`或检测 I/O 准备情况，那么您将在以下位置找到所需的服务：您将s 用于非阻塞 I/O 端点, 和s 用于 fdsets 或 pollfd 数组。具有线程池的服务器，或具有每个处理多个连接的线程，现在成为可能。这就是“额外”。`poll()``NIO``SocketChannel``Selector`

A`Buffer`是非阻塞套接字 I/O 所需的字节数组，尤其是在输出/写入端。如果只能立即写入缓冲区的一部分，那么通过阻塞 I/O，您的线程将简单地阻塞，直到可以写入整个缓冲区。使用非阻塞 I/O，你的线程会得到一个写了多少的返回值，留给你来处理下一轮的剩余部分。A`Buffer`通过显式实现填充和排出的生产者/消费者模式来处理这些机械细节，可以理解您的线程和 JVM 的内核将*不*同步。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2014-06-03T09:14:01.023

即使你在使用`SocketChannels`，也需要使用线程池来处理`channels`。

考虑一下场景，您只使用一个线程负责轮询`select()`和处理`SocketChannels`选定的 from `Selectors`，如果一个通道需要 1 秒的处理时间，并且队列中有 10 个通道，这意味着您必须等待 10 秒才能进行下一次轮询是无法忍受的。所以应该有一个用于通道处理的线程池。

从这个意义上说，我没有看到每个客户端线程阻塞套接字模式的巨大差异。主要区别在于`NIO`模式，任务更小，它更像是每个任务的线程，并且任务可以被读取，写入，业务流程等。有关更多详细信息，您可以查看**Netty**的实现`NioServerSocketChannelFactory`，其中正在使用一个 Boss 线程接受连接，并将任务分派到 Worker 线程池进行处理

如果您真的喜欢一个线程，那么底线是至少您应该拥有池化 I/O 线程，因为 I/O 操作通常比指令处理周期慢几个数量级，您不会想要宝贵的一个线程被 I/O 阻塞，这正是**NodeJS**所做的，使用一个线程接受连接，并且所有 I/O 都是异步的，并由后端 I/O 线程池并行处理

**旧式线程每个客户端死了吗？** 我不这么认为，NIO 编程很复杂，多线程自然不是邪恶的，请记住，现代操作系统和 CPU 在多任务处理方面变得越来越好，因此多线程的开销随着时间的推移变得越来越小。

# mysql - 多列索引和 ORDER BY

> ID：14225963
> 
> 赞同：0
> 
> 时间：2013-01-08T23:40:25.800
> 
> 标签：mysql, indexing

我有一个 mysql 数据库，在 aws rds 微型实例上托管了 700 万行。

我正在做这种查询：

```
SELECT
  `id`, `address`, `property_type`, `rooms`,
  `published`, `size`, `net_rent`, `gross_rent`,
  `purchase_price`, `original_id`
FROM (`properties`)
WHERE
  `postcode` IN ('1000', '1001', '1002', '1003',
                 '1004', '1005', '1006', '1007',
                 '1010', '1011', '1012', '1014',
                 '1015', '1017', '1018', '1019')
  AND `published` < '2013-01-09'
  AND `property_type` IN ('Apartment', 'Apartment with terrace',
                          'Attic', 'Attic flat / penthouse',
                          'Loft', 'Maisonette', 'Studio')
  AND `sale_or_rent` = 'rent'
LIMIT 50 
```

因此我创建了一个这样的索引：

```
| properties |          1 | listing       |            1 | postcode      | A         |       25091 |     NULL | NULL   | YES  | BTREE      |         |               |
| properties |          1 | listing       |            2 | published     | A         |     2333545 |     NULL | NULL   | YES  | BTREE      |         |               |
| properties |          1 | listing       |            3 | property_type | A         |     3500318 |     NULL | NULL   | YES  | BTREE      |         |               |
| properties |          1 | listing       |            4 | sale_or_rent  | A         |     3500318 |     NULL | NULL   | YES  | BTREE      |         |               | 
```

到目前为止一切都很好。当我尝试添加 ORDER BY 已发布的 DESC（一个查询为 30"+）时，问题就出现了。

反正有一个有效的 ORDER BY 已发布 DESC 知道我还需要发布在 WHERE 子句中吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-08T23:50:23.137

我会尝试将“已发布”放在索引中

# ssrs-2008 - 在 SSR 中合并行组值

> ID：14225965
> 
> 赞同：0
> 
> 时间：2013-01-08T23:40:33.727
> 
> 标签：ssrs-2008, reporting-services

有没有办法合并行组值。假设部门行组显示 3 个值 Accounts、IT 和 Finance，Finance 和 Account 具有相同的常量值。我在运行报告时遇到的问题都分为不同的行单元格但具有相同values.want 都合并成 1 行，所以矩阵表只能有 2 行

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-09T10:41:18.683

而不是按部门分组，即

`=Fields!Department.Value`,

对一个表达式进行分组，该表达式将为 Finance 和 Account 返回相同的值，例如

`=IIf(Fields!Department.Value = "Accounts" or Fields!Department.Value = "Finance", "Accounts-Finance", Fields!Department.Value)`.

在上面的示例中，这将给出两个组，**即 Accounts-Finance**和**IT**，而不是三个原始组。

同样，您可以将此表达式作为计算字段添加到正在使用的数据集中，然后对计算字段进行分组。这是相同的方法，但会将逻辑移出矩阵，以便可以在报告的其他地方使用。

# c - 在 C 中检查正确的内存释放

> ID：14225970
> 
> 赞同：0
> 
> 时间：2013-01-08T23:40:51.630
> 
> 标签：c, function, memory, malloc, free

大家好！

我正在尝试用 C 制作一个 ascii 俄罗斯方块。

但是我对指针的经验还不是很丰富，所以我想问一下我是否正确创建了这些函数，分配和释放内存（这意味着它们不会留下内存泄漏）。

这是我用来创建俄罗斯方块板的函数：

```
char** InitTetris( int size_x , int size_y )
{
   /* 
      InitTetris allocates memory for the tetris array.
      This function should be called only once at the beginning of the game.
   */  

   //Variables
   int i;
   char** tetris = NULL;

   //Allocate memory
   tetris = ( char** ) malloc ( size_x * sizeof ( char* ) );

   for ( i = 0 ; i < size_x ; i++ )
   {
      tetris[i] = ( char* ) malloc ( size_y * sizeof ( char ) );
   }

   return tetris;

}//End of InitTetris 
```

这是释放内存的功能：

```
void ExitTetris ( char** tetris , int size_y )
{
   /*
      This function is called once at the end of the game to
      free the memory allocated for the tetris array.
   */

   //Variables
   int i;

   //Free memory
   for ( i = 0 ; i < size_y ; i++ )
   {
      free( tetris[i] );
   }

   free( tetris );

 }//End of ExitTetris 
```

从另一个函数处理的所有内容

```
void NewGame()
{
   //Variables

   char** tetris;          /* Array that contains the game board       */
   int size_x , size_y;    /* Size of tetris array                     */

   //Initialize tetris array
   tetris = InitTetris( size_x , size_y );

   //Do stuff.....

   //Free tetris array
   ExitTetris( tetris , size_y );

}//End of NewGame 
```

程序上一切正常，我只是想确保我不会乱扔人们的内存……你能检查我的方法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-08T23:50:28.260

您最好的内存泄漏朋友是 C 编程的好指南。有很多可用的。之后考虑一些工具，如 valgrind 或 efence (linux)，

[http://valgrind.org/](http://valgrind.org/)

efence 带有一些 linux 发行版。

Windows 也有堆分析工具，例如在 XP 上：

[http://support.microsoft.com/kb/268343](http://support.microsoft.com/kb/268343)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-08T23:44:33.080

好像没问题。`NULL`最好在创建内存时检查 malloc 是否没有返回。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-08T23:59:33.030

我觉得你没事。正如@Hassan Matar 所说，这是值得的。不过，还有一件事。我在这里了解到，在 stackoverflow 中，不投射 malloc 是投射它们的更好选择。

告诉编译器您（可能）知道您正在使用的数据类型可能会出现的错误数量不值得冒险。

检查此[问题](https://stackoverflow.com/questions/605845/do-i-cast-the-result-of-malloc)以获取更多详细信息。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-09T00:04:49.160

检查是否有任何内存无法分配，因为如果从未分配内存，释放可能会导致崩溃：

```
//In InitTetris:
tetris = ( char** ) malloc ( size_x * sizeof ( char* ) );

//if tetris == NULL, then exit from the function with a failure code
//and don't continue the rest of the program.
// 
```

有关 malloc 失败可能性的更多信息，请参阅此 URL：

[如何检测malloc失败？](https://stackoverflow.com/questions/6325940/how-detect-malloc-failure)

# math - 标量在大 O 表示法中重要吗？

> ID：14225976
> 
> 赞同：1
> 
> 时间：2013-01-08T23:41:08.203
> 
> 标签：math, big-o

标量是否包含在大 O 表示法中，或者 O(2n) 实际上与 O(n) 相同，因为没有考虑标量？如果是这样，这是为什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-08T23:45:28.680

Big-O 符号由于其定义而忽略了常数因子（标量）：

> f(n) = O(g(n)) 当且仅当存在一个自然数 n [0]和实数 c 使得对于任何自然数 n > n [0]，|f(n)| ≤ |cg(n)|

所以现在假设 f(n) = O(k × g(n))。这意味着有一些自然数 n [0]和实数 c 使得对于任何 n > n [0]，我们有 |f(n)| ≤ |c × k × g(n)|。

我们将使用它来证明 f(n) = O(g(n))。为此，请选择 n [0]作为自然数，选择 c × k 作为实数。然后对于任何 n > n [0]，我们有 |f(n)| ≤ |(c × k) × g(n)|，所以 f(n) = O(g(n))。

希望这可以帮助！

# android - 如何在 Android 上模拟 DFP 广告管理系统中的智能横幅？

> ID：14225977
> 
> 赞同：0
> 
> 时间：2013-01-08T23:41:13.193
> 
> 标签：android

我想从 DFP 将广告缩放到设备的宽度，类似于 AdMob 声称缩放智能横幅的方式。（智能横幅目前在 DFP 中不可用。）查看 Hierarchy Viewer，我看到 DFP 广告是一个 WebView，隐藏在几层 FrameLayout 和一个 RelativeLayout 中。有没有办法找到一个没有ID的子WebView（我有一个父RelativeLayout的ID），调整WebView的大小，使其大小与广告单元具有相同的比例，但延伸到设备的宽度，最后缩放/缩放 WebView 内的内容以填充 WebView？

对于纵向模式，我知道广告始终为 320x50（减去设备密度）。我还没有决定要为景观做什么。

我要求不高，是吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-09T04:09:56.830

虽然我不知道您想要的内容是否可行，但修改此类内容可能（并且可能）违反了 DFP 的服务条款。任何使用 WebView 的广告 SDK 都会根据广告的配置方式和应用程序中的广告视图大小做出假设，以适当地缩放广告内容。虽然对您来说“强制”调整大小似乎是无害的，但它可能会破坏任何特定的触摸目标（例如单击此处查看“巧克力”与单击此处查看“香草”），这些目标是根据广告商的规范要求的广告。

在任何情况下，您都应该联系 DFP 或您的广告提供商，看看可以做什么。最坏的情况是将广告放在中性色背景上以填充任何空白空间。

# tfs - VS2012：如何浏览 TFS 存储库？

> ID：14225982
> 
> 赞同：4
> 
> 时间：2013-01-08T23:41:26.783
> 
> 标签：tfs, visual-studio-2012

如何在 VS2012 中浏览 TFS 存储库？

我已经浏览了所有 Team Explorer 窗口选项，但找不到打开窗口以浏览 TFS 存储库中所有文件夹/项目的选项。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-09T02:40:44.233

(1) 要浏览版本控制文件夹，请依次选择 Menu **View**、**Other Windows**和 Source Control Explorer。

(2) 要浏览连接的团队项目集合中的所有团队项目和团队，请在团队资源管理器中选择**项目和我的团队**。

(3) 要使用 Source Control Explorer 包括已删除的文件夹和文件以进行版本控制，请选择**Tools**、**Source Control**，并确保在**Visual Studio Team Foundation Server**节点下选中**Show deleted items in Source Control Explorer**复选框。

 *** * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-08T23:41:26.783

从团队资源管理器中，选择工具栏中的“主页”按钮（或从上下文菜单中选择“主页”），然后选择“源代码管理资源管理器”。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-08T23:52:17.107

我知道它在哪里，但我不记得确切的菜单选项。:(

但是您连接到 TFS 框，然后选择您感兴趣的项目（TFS 项目而不是代码项目）。如果您有访问权限，它们将在团队资源管理器窗口中显示为顶级项目。

我认为它是连接/从源代码管理打开？文件菜单中源代码管理下的选项。**

# android - Android：使用 Jsoup 解析页面

> ID：14225985
> 
> 赞同：0
> 
> 时间：2013-01-08T23:41:32.227
> 
> 标签：android, json, html-parsing, android-webview, jsoup

为什么我的应用在模拟器上显示后一直崩溃？我刚开始学习 Jsoup 解析并遵循不同的 tuts，但我找不到此错误的解决方案。

```
package com.example.testingjson;

import java.io.IOException;

import org.jsoup.Jsoup;
import org.jsoup.nodes.Document;
import android.os.Bundle;
import android.app.Activity;
import android.view.Menu;

public class MainActivity extends Activity {

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_main);
         // process

         Document doc;
            try {
                doc = Jsoup.connect("http://google.com/").get();
                String title = doc.title();
             System.out.print(title);
            } catch (IOException e) {
                // TODO Auto-generated catch block
                e.printStackTrace();
            }
            }

    @Override
    public boolean onCreateOptionsMenu(Menu menu) {
        // Inflate the menu; this adds items to the action bar if it is present.
        getMenuInflater().inflate(R.menu.activity_main, menu);
        return true;

    }

} 
```

这是错误消息

```
12-26 19:30:42.043: E/AndroidRuntime(4260): FATAL EXCEPTION: main
12-26 19:30:42.043: E/AndroidRuntime(4260): java.lang.NoClassDefFoundError: org.jsoup.Jsoup
12-26 19:30:42.043: E/AndroidRuntime(4260):     at com.example.testingjson.MainActivity.onCreate(MainActivity.java:22)
12-26 19:30:42.043: E/AndroidRuntime(4260):     at android.app.Activity.performCreate(Activity.java:5104)
12-26 19:30:42.043: E/AndroidRuntime(4260):     at android.app.Instrumentation.callActivityOnCreate(Instrumentation.java:1080)
12-26 19:30:42.043: E/AndroidRuntime(4260):     at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2144)
12-26 19:30:42.043: E/AndroidRuntime(4260):     at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:2230)
12-26 19:30:42.043: E/AndroidRuntime(4260):     at android.app.ActivityThread.access$600(ActivityThread.java:141)
12-26 19:30:42.043: E/AndroidRuntime(4260):     at android.app.ActivityThread$H.handleMessage(ActivityThread.java:1234)
12-26 19:30:42.043: E/AndroidRuntime(4260):     at android.os.Handler.dispatchMessage(Handler.java:99)
12-26 19:30:42.043: E/AndroidRuntime(4260):     at android.os.Looper.loop(Looper.java:137)
12-26 19:30:42.043: E/AndroidRuntime(4260):     at android.app.ActivityThread.main(ActivityThread.java:5039)
12-26 19:30:42.043: E/AndroidRuntime(4260):     at java.lang.reflect.Method.invokeNative(Native Method)
12-26 19:30:42.043: E/AndroidRuntime(4260):     at java.lang.reflect.Method.invoke(Method.java:511)
12-26 19:30:42.043: E/AndroidRuntime(4260):     at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:793)
12-26 19:30:42.043: E/AndroidRuntime(4260):     at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:560)
12-26 19:30:42.043: E/AndroidRuntime(4260):     at dalvik.system.NativeStart.main(Native Method) 
```

编辑：这是一张显示导入的 JSOUP jar 文件的图片，但我仍然收到错误消息。 ![在此处输入图像描述](../Images/34ee4c3a6d318ed9671429294647a871.png)

APK 文件用 Winrar 打开。

![在此处输入图像描述](../Images/6c317690dd401ab30ef1e1f1bc1aea76.png)

订单和出口设置

![在此处输入图像描述](../Images/a84cdbdb49e3975924dff51dd54cb848.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-09T00:32:20.293

您能否打开您的 apk 并检查 apk 的 libs 文件夹中是否存在 jsoup lib？如果不是，则意味着它尚未添加到构建中。下一步是进行清理，确保删除先前构建的 apk，将 jsoup 复制到 libs 文件夹并重建 apk。检查 jsoup 是否已复制到新创建的 apk。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-09T00:01:18.900

您需要将 JSOUP jar 文件导入到您的项目中。如果您在 Eclipse 上，最简单的方法是将它放在 libs 文件夹中，并且它应该在构建时自动添加，或者您可以右键单击项目，构建路径 -> 添加外部档案。有时我在将某些 jar 导入项目时也遇到了问题，但通过构建 proj 几次或重新启动 eclipse 都解决了。

# java - Listview 致命异常：从 doInBackground 内部调用时 AsyncTask #1

> ID：14225986
> 
> 赞同：-1
> 
> 时间：2013-01-08T23:41:34.253
> 
> 标签：java, android, android-widget, android-listview, android-asynctask

我通过客户端/服务器进行简单的聊天，当我将消息发送到服务器时，它完美地显示了 ListView Bubble。但是当我从服务器发送一个并且客户端收到它时，它会尝试执行 addItems() 并关闭。我什么都试过了。我知道这是因为我无法从 Asynctask 更改 UI，但我是 Android/Java 新手，我不知道该怎么做！帮助，请！！！！

```
***MY LOG CAT** 01-08 18:32:41.023: E/AndroidRuntime(1242): FATAL EXCEPTION: AsyncTask #1
01-08 18:32:41.023: E/AndroidRuntime(1242): java.lang.RuntimeException: An error occured while executing doInBackground()
01-08 18:32:41.023: E/AndroidRuntime(1242):     at android.os.AsyncTask$3.done(AsyncTask.java:299)
01-08 18:32:41.023: E/AndroidRuntime(1242):     at java.util.concurrent.FutureTask$Sync.innerSetException(FutureTask.java:273)
01-08 18:32:41.023: E/AndroidRuntime(1242):     at java.util.concurrent.FutureTask.setException(FutureTask.java:124)
01-08 18:32:41.023: E/AndroidRuntime(1242):     at java.util.concurrent.FutureTask$Sync.innerRun(FutureTask.java:307)
01-08 18:32:41.023: E/AndroidRuntime(1242):     at java.util.concurrent.FutureTask.run(FutureTask.java:137)
01-08 18:32:41.023: E/AndroidRuntime(1242):     at android.os.AsyncTask$SerialExecutor$1.run(AsyncTask.java:230)
01-08 18:32:41.023: E/AndroidRuntime(1242):     at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1076)
01-08 18:32:41.023: E/AndroidRuntime(1242):     at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:569)
01-08 18:32:41.023: E/AndroidRuntime(1242):     at java.lang.Thread.run(Thread.java:856)
01-08 18:32:41.023: E/AndroidRuntime(1242): Caused by: android.view.ViewRootImpl$CalledFromWrongThreadException: Only the original thread that created a view hierarchy can touch its views.
01-08 18:32:41.023: E/AndroidRuntime(1242):     at android.view.ViewRootImpl.checkThread(ViewRootImpl.java:4609)
01-08 18:32:41.023: E/AndroidRuntime(1242):     at android.view.ViewRootImpl.requestLayout(ViewRootImpl.java:835)
01-08 18:32:41.023: E/AndroidRuntime(1242):     at android.view.View.requestLayout(View.java:15129)
01-08 18:32:41.023: E/AndroidRuntime(1242):     at android.view.View.requestLayout(View.java:15129)
01-08 18:32:41.023: E/AndroidRuntime(1242):     at android.view.View.requestLayout(View.java:15129)
01-08 18:32:41.023: E/AndroidRuntime(1242):     at android.view.View.requestLayout(View.java:15129)
01-08 18:32:41.023: E/AndroidRuntime(1242):     at android.widget.RelativeLayout.requestLayout(RelativeLayout.java:292)
01-08 18:32:41.023: E/AndroidRuntime(1242):     at android.view.View.requestLayout(View.java:15129)
01-08 18:32:41.023: E/AndroidRuntime(1242):     at android.widget.AbsListView.requestLayout(AbsListView.java:1932)
01-08 18:32:41.023: E/AndroidRuntime(1242):     at android.widget.AdapterView$AdapterDataSetObserver.onChanged(AdapterView.java:813)
01-08 18:32:41.023: E/AndroidRuntime(1242):     at android.widget.AbsListView$AdapterDataSetObserver.onChanged(AbsListView.java:6051)
01-08 18:32:41.023: E/AndroidRuntime(1242):     at android.database.DataSetObservable.notifyChanged(DataSetObservable.java:37)
01-08 18:32:41.023: E/AndroidRuntime(1242):     at android.widget.BaseAdapter.notifyDataSetChanged(BaseAdapter.java:50)
01-08 18:32:41.023: E/AndroidRuntime(1242):     at android.widget.ArrayAdapter.notifyDataSetChanged(ArrayAdapter.java:286)
01-08 18:32:41.023: E/AndroidRuntime(1242):     at android.widget.ArrayAdapter.add(ArrayAdapter.java:182)
01-08 18:32:41.023: E/AndroidRuntime(1242):     at com.i911.emergency.response.DiscussArrayAdapter.add(DiscussArrayAdapter.java:26)
01-08 18:32:41.023: E/AndroidRuntime(1242):     at com.i911.emergency.response.HelloBubblesActivity.addItems(HelloBubblesActivity.java:148)
01-08 18:32:41.023: E/AndroidRuntime(1242):     at com.i911.emergency.response.HelloBubblesActivity.access$0(HelloBubblesActivity.java:147)
01-08 18:32:41.023: E/AndroidRuntime(1242):     at com.i911.emergency.response.HelloBubblesActivity$TcpClientTask.doInBackground(HelloBubblesActivity.java:116)
01-08 18:32:41.023: E/AndroidRuntime(1242):     at com.i911.emergency.response.HelloBubblesActivity$TcpClientTask.doInBackground(HelloBubblesActivity.java:1)
01-08 18:32:41.023: E/AndroidRuntime(1242):     at android.os.AsyncTask$2.call(AsyncTask.java:287)
01-08 18:32:41.023: E/AndroidRuntime(1242):     at java.util.concurrent.FutureTask$Sync.innerRun(FutureTask.java:305)
01-08 18:32:41.023: E/AndroidRuntime(1242):     ... 5 more 
```

这是我的代码：

```
 package com.ChatWithMe;

  import java.io.BufferedReader;
  import java.io.BufferedWriter;
  import java.io.IOException;
  import java.io.InputStreamReader;
  import java.io.OutputStreamWriter;
        import java.net.Socket;
  import java.net.UnknownHostException;
  import com.ChatWithMe.OneComment;
  import android.app.Activity;
  import android.os.AsyncTask;
  import android.os.Bundle;
  import android.util.Log;
  import android.view.KeyEvent;
  import android.view.View;
  import android.view.View.OnKeyListener;
  import android.widget.EditText;
  import android.widget.ListView;
  import android.widget.TextView;

  public class HelloBubblesActivity extends Activity {
private com.ChatWithMe.DiscussArrayAdapter adapter;
private ListView lv;
private EditText editText1;
public Socket s;
public BufferedWriter out;
public BufferedReader in;
public TextView i911Log;
public EditText DataToSend;

@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_discuss);
    lv = (ListView) findViewById(R.id.listView1);
    adapter = new DiscussArrayAdapter(getApplicationContext(), R.layout.listitem_discuss);
    lv.setAdapter(adapter);
    new TcpClientTask().execute();

    editText1 = (EditText) findViewById(R.id.editText1);
    editText1.setOnKeyListener(new OnKeyListener() {
        public boolean onKey(View v, int keyCode, KeyEvent event) {
            // If the event is a key-down event on the "enter" button
            if ((event.getAction() == KeyEvent.ACTION_DOWN) && (keyCode == KeyEvent.KEYCODE_ENTER)) {
                // Perform action on key press
                adapter.add(new OneComment(false, "User: " + editText1.getText().toString()));
                adapter.add(new OneComment(true, "User: " + editText1.getText().toString()));
                try {
                out.write("TXT:" + editText1.getText().toString());
                out.flush();
                } catch (UnknownHostException e) {
                     e.printStackTrace();
                     adapter.add(new OneComment(false, "Error Sending: " + editText1.getText().toString()));
                } catch (IOException e) {
                    // TODO Auto-generated catch block
                    e.printStackTrace();
                    adapter.add(new OneComment(false, "Error Sending: " + editText1.getText().toString()));
                    Log.i("TcpClient", "Button Clicked, but IOException Occured");
                }

                editText1.setText("");
                return true;
            }
            return false;
        }
    });

}

class TcpClientTask extends AsyncTask<Void, Void, Void> {
    private static final int TCP_SERVER_PORT = 1234;
    private boolean error = false;
    Boolean SocketStarted = false;
    private BufferedReader in;
    protected Void doInBackground(Void... arg0) {
        try {
            Socket s = new Socket("10.0.2.2", TCP_SERVER_PORT);
            //10.0.2.2
                in = new BufferedReader(new InputStreamReader(s.getInputStream()));
                out = new BufferedWriter(new OutputStreamWriter(s.getOutputStream()));

            //send output msg
            String outMsg = "VER:Android,ID:1038263,SND:1,VDO:1,GPS:1,";
            out.write(outMsg);
            out.flush();
            String outMsg2 = com.ChatWithMe.MainActivity.GPSTracker.toString();
            out.write(outMsg2);
            out.flush();
            Log.i("TcpClient", "sent: " + outMsg);

            String WhatsIN = in.readLine();
            while(WhatsIN!=null){
            String inMsg = in.readLine() + System.getProperty("line.separator");
            Log.i("TcpClient", "received: " + inMsg);

            String inMsg3 = inMsg.substring(1,inMsg.length() - 1);
            Log.i("Info", "info: " + inMsg3);

            if (inMsg3.equals("GPSX")) {
                String GPSTracking = com.ChatWithMe.MainActivity.GPSTracker.toString();
                Log.i("GPSX", "Sent:" + GPSTracking.toString());
                out.write(GPSTracking);
                out.flush();
            }

            // Check Commands
            String CmdCheck = inMsg3.substring(0,4);
            if (CmdCheck.equals("TXT:")) {
           String SpitItOut = inMsg3.substring(4, inMsg3.length() - 1); 
           Log.i("SpitItOut", "Msg:" + SpitItOut.toString());

          //ERROR IS HERE
           addItems();
          //ERROR IS HERE   
            }

            } 

        } catch (UnknownHostException e) {
            error = true;
            e.printStackTrace();
        } catch (IOException e) {
            error = true;
            e.printStackTrace();
        } 

        return null;
    }

    protected void onPostExecute() {
        if(error) {
            // Something bad happened

        }
        else {
            // Success

        }
    }

}

private void addItems() {
    adapter.add(new OneComment(true, "Hello bubbles!"));
} 
```

}

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-08T23:43:10.080

Move `addItems()` to `onPostExecute()`. You can't modify anything UI related in the background thread.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-08T23:51:11.003

[在此处](http://developer.android.com/reference/android/os/AsyncTask.html)阅读有关异步任务的信息。基本上你有`onPostExecute()`在 UI 线程上运行的方法，你应该将结果传递`doInBackground()`给它并修改 UI 或你在主线程中必须做的任何事情。`addItems()`因此，由于您试图从后台线程更改适配器，因此您的方法会产生错误。将其移入，`onPostExecute()`它应该可以解决您的问题。

# python - 检查一个字符串是否包含一组字符串的任何项目？

> ID：14225988
> 
> 赞同：1
> 
> 时间：2013-01-08T23:41:48.087
> 
> 标签：python

我有一个文本文件，每行都有一个句子。我有一个单词表。我只想从列表中获取至少包含一个单词的句子。有没有一种pythonic方法可以做到这一点？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-08T23:44:55.983

```
sentences = [line for line in f if any(word in line for word in word_list)] 
```

Here `f` would be your file object, for example you could replace it with `open('file.txt')` if `file.txt` was the name of your file and it was located in the same directory as the script.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-08T23:54:49.490

使用`set.intersection`：

```
with open('file') as f:
    [line for line in f if set(line.lower().split()).itersection(word_set)] 
```

或与`filter`：

```
filter(lambda x:word_set.intersection(set(x.lower().split())),f) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-08T23:44:41.970

this will give you a start:

```
words = ['a', 'and', 'foo']
infile = open('myfile.txt', 'r')
match_sentences = []

for line in infile.readlines():
    # check for words in this line
    # if match, append to match_sentences list 
```

# wordpress - 在网页上居中并缩放在 Google 地球中创建的 KML 文件

> ID：14225989
> 
> 赞同：0
> 
> 时间：2013-01-08T23:41:49.373
> 
> 标签：wordpress, google-maps, coordinates, kml

我在 Google 地球中创建了一个使用多边形定义多个区域的 KML 文件。我的计划是在我的 wordpress 网站上使用这个文件，以及用于 wordpress 的“综合谷歌地图插件”。然而，事实证明，虽然它可以工作，但对于开发人员来说，我无法设置中心或缩放。我想放大到 10，并以特定坐标为中心。我用谷歌搜索和研究过，我一直想出一些脚本，但我什至会用它们做什么让我有点困惑。这是我第一次涉足 KML。有什么我可以添加到由谷歌地球生成的 KML 文件中，这将允许我完成这个吗？任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-09T03:15:43.370

正如所评论的，当您使用 WP 插件时，您无能为力。

但是，当您在没有插件的情况下构建地图时，请使用地图的选项`center`和`zoom`设置缩放和中心。

要防止地图平移到 KML 图层的内容，请将 KML 图层的选项设置`preserveViewport`为 true。

例子：

```
map = new google.maps.Map(document.getElementById('map'), {
  mapTypeId: google.maps.MapTypeId.ROADMAP,
  center: new google.maps.LatLng(52.519,13.406),
  zoom: 12
});
new google.maps.KmlLayer('http://example.com/example.xml',
                         {preserveViewport: true, map:map}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-09T03:33:39.993

请尝试使用[WP 灵活地图](http://wordpress.org/extend/plugins/wp-flexible-map/)。它允许您在 KML 地图上指定缩放，还允许您访问地图对象，以便您可以在加载后设置中心。

加载 KML 文件的简码示例；注意：根据[FAQ](http://wordpress.org/extend/plugins/wp-flexible-map/faq/)，我设置了一个 id，稍后会从中派生 JavaScript 全局变量名。[编辑：我是个白痴，我复制了错误的例子！固定的]

```
[flexiblemap id="exmap" zoom="14" width="500" height="400"
    src="http://snippets.webaware.com.au/maps/example-toronto.kml"] 
```

现在，将此代码添加到插件（或您的主题的functions.php，如果您愿意）：

```
add_filter('flexmap_shortcode_html', 'filterFlxmapShortcodeHtml', 10, 2);

/**
* append our script to the end of the map shortcode's HTML
* @param string $html
* @param array $attrs the shortcode's array of attributes/parameters
* @return string
*/
function filterFlxmapShortcodeHtml($html, $attrs) {
    $html .= <<<HTML
<script>
jQuery(window).load(function() {
    flxmap_exmap.setCenter(new google.maps.LatLng("12.345", "32.109"));
});
</script>

HTML;

    return $html;
} 
```

# .net - UniObjects .Net not returning any XML

> ID：14225995
> 
> 赞同：0
> 
> 时间：2013-01-08T23:42:50.760
> 
> 标签：.net, xml, unidata, uniobjects

Just looking for some pointers really as I am totally new to UniData...

I am after pulling a table (if that is the right terminology??) from a UniData DB. The easiest way it seems is to do this using XML, which seems to be built in to the UniObjects API and UniData.

However, when using the API no XML is returned, just an empty XML error and when using UniCommand.command nothing at all is returned, just command status 0.

There seems to be some conflicting info here - some developers guides suggest the XML gets written to a file and not returned to the client?

Any pointers?

Cheers,

Kai.

UPDATE - Some code...

```
U2Connection con = new U2Connection();
U2ConnectionStringBuilder conn_str = new U2ConnectionStringBuilder();

try
{
    conn_str.UserID = "BLAH-BLAH";
    conn_str.Password = "BLAH-BLAH";
    conn_str.Server = "BLAH-BLAH";
    conn_str.AccessMode = "Native";   // FOR UO
    conn_str.RpcServiceType = "udcs"; // FOR UO
    conn_str.Database = "BLAH-BLAH";
    conn_str.ServerType = "UNIDATA";
    conn_str.Pooling = false;
    con.ConnectionString = conn_str.ToString();
}
catch (Exception ex)
{

}

con.Open();
UniSession us = con.UniSession;
UniCommand unicmd = us.CreateUniCommand();

unicmd.Command = "LIST ASSET_REPORT";
unicmd.Execute();

Console.Write(unicmd.CommandStatus + Environment.NewLine);
Console.Write(unicmd.Response);
Console.Write(Environment.NewLine + "Done...");
Console.ReadKey();

con.Close(); 
```

Just to confirm, with the above code I can execute commands and retrieve their output. However, if I change the command to something like "LIST ASSET_REPORT TOXML" (as per all the guides I have found) I get nothing back. Equally, if I use the UniXML functions:

```
UniXML xml = us1.CreateUniXML();

xml.GenerateXML("LIST DICT ASSET");

DataSet ds = xml.GetDataSet(); 
```

All I get are empty dataset exceptions?

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-09T14:00:24.373

原则上，您的代码没有任何问题。我已经针对我的 UniData 服务器测试了您的代码（当然更改了文件名等），但没有收到任何错误。我还可以毫无问题地使用 TOXML 和 UniXML 方法 GenerateXML()。返回的 XML 数据完全符合我的预期。

请与我们分享以下信息：

*   所有发生的错误消息的详细信息。
*   您正在使用的 UniData 版本和 UniData 所基于的操作系统。
*   调用 Execute() 方法后 unicmd.Response 的值是多少？您是否引用了一个空文件并只是获取根标签？

确实一定是您尚未与我们分享的东西导致了问题。

格伦

# python - 正整数的烧瓶 sqlalchemy 列约束

> ID：14225998
> 
> 赞同：14
> 
> 时间：2013-01-08T23:42:53.870
> 
> 标签：python, sqlalchemy, flask-sqlalchemy

如何使用flask sqlalchemy将列定义为正整数？

我希望答案看起来像这样：

```
class City(db.Model):
    id = db.Column(db.Integer, primary_key=True)
    population = db.Column(db.Integer, positive=True)
    def __init__(self,population):
        self.population = population 
```

但是，此类定义将引发错误 b/c sqlalchemy 不知道“肯定”参数。

如果对象被实例化为人口的负值，我可能会引发异常。但我不知道如何确保更新后人口保持积极状态。

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2013-01-09T00:19:11.293

不幸的是，在 python 方面，sqlalchemy 尽最大努力不碍事；没有“特殊的 sqlalchemy”方式来表示实例属性必须满足某些约束：

```
>>> class Foo(Base):
...     __tablename__ = 'foo'
...     id = Column(Integer, primary_key=True)
...     bar = Column(Integer)
...
>>> f = Foo()
>>> f.bar = "not a number!"
>>> f.bar
'not a number!' 
```

如果您尝试提交此对象，sqlalchey*会*抱怨，因为它不知道如何将提供的 python 值呈现为列 type 的 SQL `Integer`。

如果这不是您想要的，您只是想确保不良数据不会到达数据库，那么您需要一个`Check`约束。

```
class Foo(Base):
    __tablename__ = 'foo'
    id = Column(Integer, primary_key=True)
    bar = Column(Integer)
    __table_args__ = (
        CheckConstraint(bar >= 0, name='check_bar_positive'),
        {}) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2018-01-09T19:36:29.870

我知道这很旧，但就其价值而言，我的方法是使用[棉花糖](http://marshmallow-sqlalchemy.readthedocs.io/en/latest/index.html)（反序列化和数据验证库）来验证输入数据。

为您的模型创建架构，如下所示：

```
from marshmallow import validate, fields, Schema

... 

class CitySchema(Schema):
    population = fields.Integer(validate=validate.Range(min=0, max=<your max value>)) 
```

然后在适当的时候使用你的模式来序列化/反序列化数据：

```
... 
city_data = {...} # your city's data (dict)
city_schema = CitySchema()
deserialized_city, validation_errors = city_schema.load(city_data) # validation done at deserialization
... 
```

使用反序列化库的优点是您可以在一个地方强制执行所有数据完整性规则