# StackOverflow 问答 14286000-14286999

# java - 为什么我的 Java 应用程序找不到我的属性文件

> ID：14286000
> 
> 赞同：7
> 
> 时间：2013-01-11T20:18:57.550
> 
> 标签：java, properties, jar

我有一个简单的应用程序，可以读取和写入属性文件。它是在 NetBeans 中开发的，在 Netbeans 中运行时运行良好。但是，现在我已经构建并部署了它，找不到属性文件。

项目结构

```
com/company/projectname/controller/controllerclass.java <- this is where the code using the properties file exists

conf/runController.properties <- the properties file, this exists here 
```

在代码中我有以下访问属性文件：

```
private final String PROPERTIESFILELOCATION = "conf/runController.properties";

public void runController(){
this.runController = new Properties();
this.propertiesLocation = this.getClass().getClassLoader().getResource(this.PROPERTIESFILELOCATION);
FileInputStream propsInput = new FileInputStream(this.propertiesLocation.getFile());
this.runController.load(propsInput);
} 
```

（为简洁起见总结）

当我从命令行调用 jar 文件时，我发出：

```
java -classpath /usr/java/projectdirectory/project.jar com.company.projectname.controller.controllerclass arg1 
```

所以，我之前就以这种方式在其他项目上实现了这一点，但由于某种原因，这不起作用。

我已经检查了 jar 文件中的结构，并且所有内容都符合预期。

谁能指出我的错误并帮助我启动并运行它？

编辑-更改名称以匹配。它们在我的代码中总是一致的

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-11T20:35:31.907

你的问题谈到

> conf/controller.properties

你的代码谈论`conf/runController.properties`

编辑：我假设 conf/*.properties 在你的 jar 文件中。如果是这种情况，那么如果文件命名正确，您的代码应该可以工作。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-11T21:41:59.507

也许 FileInputStream 无法遵守 jar 文件中的属性“文件”。改变你的：

```
this.runController = new Properties();
this.propertiesLocation = this.getClass().getClassLoader().getResource(this.PROPERTIESFILELOCATION);
FileInputStream propsInput = new FileInputStream(this.propertiesLocation.getFile());
this.runController.load(propsInput); 
```

到：

```
this.runController = new Properties();
this.runController.load(this.getClass().getClassLoader().getResourceAsStream(this.PROPERTIESFILELOCATION)); 
```

编辑：我创建了一个测试类，它显示当从文件系统或 JAR 文件运行时，“props/main.properties”有效，但“/props/main.properties”无效：

```
[rtb@rtblinux props]$ cat org/dashrb/test/main.java 
package org.dashrb.test;
import java.util.Properties;
import java.io.IOException;

public class main
{
    public static void main(String args[])
    {
        main myMain = new main();
        myMain.testProps("props/main.properties");
        myMain.testProps("/props/main.properties");
    }

    public main()
    {
    }

    public void testProps(String p)
    {
        try
        {
            System.out.println("===============================");
            Properties props = new Properties();
            System.out.println("Trying to load properties as " + p);
            props.load(getClass().getClassLoader().getResourceAsStream(p));
            System.out.println("Loaded properties as " + p);
            System.out.println("Property x is: " + props.getProperty("x"));
        }
        catch (IOException ioe)
        {
            ioe.printStackTrace();
        }
        System.out.println("===============================");
    }
}

[rtb@rtblinux props]$ cat props/main.properties 
x = This is the property value of x

[rtb@rtblinux props]$ java -cp . org.dashrb.test.main
===============================
Trying to load properties as props/main.properties
Loaded properties as props/main.properties
Property x is: This is the property value of x
===============================
===============================
Trying to load properties as /props/main.properties
Exception in thread "main" java.lang.NullPointerException
    at java.util.Properties$LineReader.readLine(Properties.java:434)
    at java.util.Properties.load0(Properties.java:353)
    at java.util.Properties.load(Properties.java:341)
    at org.dashrb.test.main.testProps(main.java:25)
    at org.dashrb.test.main.main(main.java:11)

[rtb@rtblinux props]$ jar cvf main.jar org props
added manifest
adding: org/(in = 0) (out= 0)(stored 0%)
adding: org/dashrb/(in = 0) (out= 0)(stored 0%)
adding: org/dashrb/test/(in = 0) (out= 0)(stored 0%)
adding: org/dashrb/test/main.class(in = 1218) (out= 679)(deflated 44%)
adding: org/dashrb/test/main.java(in = 594) (out= 287)(deflated 51%)
adding: props/(in = 0) (out= 0)(stored 0%)
adding: props/main.properties(in = 36) (out= 36)(deflated 0%)

[rtb@rtblinux props]$ jar tvf main.jar 
     0 Fri Jan 11 17:29:40 EST 2013 META-INF/
    68 Fri Jan 11 17:29:40 EST 2013 META-INF/MANIFEST.MF
     0 Fri Jan 11 17:26:00 EST 2013 org/
     0 Fri Jan 11 17:26:00 EST 2013 org/dashrb/
     0 Fri Jan 11 17:29:24 EST 2013 org/dashrb/test/
  1218 Fri Jan 11 17:28:52 EST 2013 org/dashrb/test/main.class
   594 Fri Jan 11 17:29:24 EST 2013 org/dashrb/test/main.java
     0 Fri Jan 11 17:26:40 EST 2013 props/
    36 Fri Jan 11 17:26:40 EST 2013 props/main.properties

[rtb@rtblinux props]$ cd /
[rtb@rtblinux /]$ java -cp ~/misc/src/java/props/main.jar org.dashrb.test.main
===============================
Trying to load properties as props/main.properties
Loaded properties as props/main.properties
Property x is: This is the property value of x
===============================
===============================
Trying to load properties as /props/main.properties
Exception in thread "main" java.lang.NullPointerException
    at java.util.Properties$LineReader.readLine(Properties.java:434)
    at java.util.Properties.load0(Properties.java:353)
    at java.util.Properties.load(Properties.java:341)
    at org.dashrb.test.main.testProps(main.java:25)
    at org.dashrb.test.main.main(main.java:11) 
```

你的情况一定有一些不同的东西阻碍了你的成功。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-01-11T20:29:52.517

如果使用`getResource`打开属性文件，则假定该文件在类路径中，因此您需要将属性文件放在类路径中。替代方法是将 conf 目录添加到类路径中，或移动属性文件以使其位于现有的类路径中。

可能有帮助的一件事是使用起始斜杠来引用文件位置，因此毫无疑问，您希望从类路径的根目录开始搜索文件。否则，搜索路径与您的代码从中调用的类相关（不知道这是否正确；这就是它与 Class.getResource 的工作方式，但 Classloader.getResource 可能会有所不同）。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-01-14T19:56:38.257

感谢大家的帮助，尤其是 dashrb，为您的代码加 1。

在你的帮助下，我设法让它工作。这个问题的最终解决方案是稍微改变一下粘性。

由于我需要读取和写入文件（在我的 OP 中可能不清楚），我切换到使用 Apache.commons.configuration。

也就是说，该线程中的指针确实确保了我的其他属性文件可以顺利运行。

再次感谢

# xamarin.ios - MonoTouch 相当于 Titanium 的 backgroundLeftCap、backgroundTopCap 用于 Buttons、Views？

> ID：14286001
> 
> 赞同：1
> 
> 时间：2013-01-11T20:19:02.347
> 
> 标签：xamarin.ios, titanium

在 Appcelerator 的 Titanium 中，如果您使用 Ti.UI.Button（或任何视图）创建按钮对象，则具有这两个属性

*   背景左帽
*   背景顶盖

它允许您将图像外边缘的像素数设置为保持静态，而图像内部的其余部分被“拉伸”以填充按钮/视图的背景。

在 Xamarin 的 MonoTouch 中是否有等效的方法来做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-12T17:07:31.577

iOS 的 UIImage 支持调整大小。

加载您的图像：

```
 var image = UIImage.FromFile ("foo.png"); 
```

拉伸它：

```
 var resizableImage = image.CreateResizableImage (new UIEdgeInsets (top, left, bottom, right)); 
```

您可以在任何需要 UIImage 的地方使用生成的图像，并且由 top/left/bottom/right 描述的区域将被调整大小，而所描述的角将保持原样，而侧面将被拉伸。

在某些版本的 iOS 中，上述内容会因某些参数而崩溃（请参阅[http://openradar.appspot.com/11411000](http://openradar.appspot.com/11411000)），因此您可以改用：

```
 var resizableImage = image.StretchableImage (leftCap, topCap); 
```

它们的优点在于，为调整大小而创建的图像实际上是由 GPU 调整大小的，因此它们的成本很低。

# android - Android中最后一行GridView的布局问题

> ID：14286009
> 
> 赞同：4
> 
> 时间：2013-01-11T20:19:47.700
> 
> 标签：android, android-layout, gridview, android-gridview

这是我的网格视图。我每行有 3 个项目。

![在此处输入图像描述](../Images/27a361f414ea959d8961050122d2ba8a.png)

如图所示，视图中的最后一行仅包含一项。如果最后一行包含 3 个项目，则网格视图会正确滚动到最后。如果最后一行的项目少于 3 个，则视图的滚动量不会超过图片中显示的内容。GridView 忽略未完全填充的行。这可能是什么原因？

注意：如果我在最后添加不可见的虚拟项目来填充行，它工作正常。

这是我的 GridView 布局。

```
 <GridView
            android:id="@+id/grid_view_featuredtab"
            android:layout_width="fill_parent"
            android:layout_height="fill_parent"
            android:layout_gravity="center"
            android:columnWidth="190dp"
            android:drawSelectorOnTop="true"
            android:horizontalSpacing="3dp"
            android:listSelector="@color/gridviewlistselector"
            android:numColumns="auto_fit"
            android:paddingRight="4dp"
            android:stretchMode="spacingWidthUniform"
            android:verticalSpacing="3dp" > 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-13T12:06:31.790

截至目前，通过在最后添加虚拟隐藏的项目行来解决它。

# php - 某些字符使 php 字符串混乱

> ID：14286011
> 
> 赞同：-1
> 
> 时间：2013-01-11T20:19:49.877
> 
> 标签：php, html, xhtml

我有一个 foreach 循环，可以吐出用户收件箱中的所有“已读邮件”：

```
 foreach ($tmpArray as $array) {
            if ($array['message_parent_id'] == 0) {
                $convo = $this->model->getConvoArray($array['message_id']);
                $array['message_datetime'] = $convo[sizeof($convo) - 1]['message_datetime'];
                $lastMessage = $this->model->getLastReply($array['message_id']);
                if ($_SESSION['username'] == $lastMessage['message_sender']) {
                    $messageBody = "<b>&lArr;</b> " . $lastMessage['message_body'];
                } else {
                    $messageBody = $lastMessage['message_body'];
                }
                $array['message_body'] = $messageBody;
            }
            array_push($readMail, $array);
            //echo PrettyDate::convert($array['message_datetime']);
            //echo "<br />";
        } 
```

然而，当 $lastMessage['message_body'] == "<(^_^<) Kirby!" 我得到 $array['message_body'] == "by!"。但是当 $lastMessage['message_body'] == "<(^_ Kirby!" 它被正确地存储到 $array['message_body'] 为 "<(^_ Kirby!"。不完全确定发生了什么。所有其他我试过的情况很好。

当我拿出它的工作原理**&lArr. 我猜这与它有关。**

 *** * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-11T20:22:06.687

将 $lastMessage['message_body'] 包装在 htmlentities() 中，它应该可以解决您的问题。

```
$lastMessage['message_body'] = htmlentities($lastMessage['message_body']); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-11T20:24:32.143

由于该字符串中包含 >，因此浏览器可能会将其视为 HTML 元素。要修复此`$lastMessage['message_body']`通过[`htmlentities()`](http://php.net/htmlentities)：

```
htmlentities($lastMessage['message_body']); 
```**

# javascript - Phonegap 编码图像 base64

> ID：14286014
> 
> 赞同：5
> 
> 时间：2013-01-11T20:19:54.923
> 
> 标签：javascript, image, cordova, base64

我正在尝试将图像编码为 base64 并将其发送到服务器。当我检索图像时，它显示的所有内容都是空白的。

我用来编码的代码是这样的：

```
encodeImageUri = function(imageUri) {
        var c = document.createElement('canvas');
        var ctx = c.getContext("2d");
        var img = new Image();
        img.onload = function() {
            c.width = this.width;
            c.height = this.height;
            ctx.drawImage(img, 0, 0);
        };
        img.src = imageUri;
        var dataURL = c.toDataURL("image/jpeg");

        return dataURL.slice(22, dataURL.length);
    } 
```

取自：[Using PhoneGap, How to get base64 image data of the photo library selected from photo library in iPhone](https://stackoverflow.com/questions/11188599/using-phonegap-how-to-get-base64-image-data-of-the-photo-chosen-from-photo-libr)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-11T22:42:11.253

我使用以下代码将图像转换为 Base64：

```
var Base64 = {
    /**
     * This implementation relies on Cordova 1.5 or above implementations.
     */
    getBase64ImageFromInput : function (input, callback) {
        var imageReader = new FileReader();
        imageReader.onloadend = function (evt) {
            if (callback)
                callback(evt.target.result);
        };
        //Start the asynchronous data read.
        imageReader.readAsDataURL(input);
    },
    formatImageSrcString : function (base64) {
        return (base64.match(/(base64)/))? base64 : "data:image/jpeg;base64," + base64;
    } 
}; 
```

下面是一个使用此对象将图像从文件输入转换为 base64 编码的示例：

```
var fileInput = document.createElement('input');
fileInput.type = 'file';
fileInput.onchange = function () {
    var input = this.files[0];
    if (input) {
        Base64.getBase64ImageFromInput(input, function (imageData) {
            //Process the image string. 
            console.log(imageData);
        });
    } else {
       alert("Please select an image.");
    }
}; 
```

希望这可以帮助。如果您有任何问题，请告诉我。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-11T21:38:44.160

使用[FileReader的](http://docs.phonegap.com/en/2.3.0/cordova_file_file.md.html#FileReader)[readAsDataURL](http://docs.phonegap.com/en/2.3.0/cordova_file_file.md.html#FileReader_read_as_data_url)方法。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-01-11T20:30:42.470

图像正在*异步*加载，这意味着您在图像加载到画布*之前*`return dataURL...`发生。

 *与其让这个函数返回一个值，不如让它调用一个回调函数。

```
encodeImageUri = function(imageUri, callback) {
    var c = document.createElement('canvas');
    var ctx = c.getContext("2d");
    var img = new Image();
    img.onload = function() {
        c.width = this.width;
        c.height = this.height;
        ctx.drawImage(img, 0, 0);

        if(typeof callback === 'function'){
            var dataURL = c.toDataURL("image/jpeg");
            callback(dataURL.slice(22, dataURL.length));
        }
    };
    img.src = imageUri;
} 
```

你现在这样称呼它：

```
encodeImageUri('/path/to/image.png', function(base64){
    // Do something with the b64'd image
}); 
```

注意：为此，图像需要与您的页面位于同一域中。*

# jquery - 使用jquery将数据保存到文件中

> ID：14286015
> 
> 赞同：0
> 
> 时间：2013-01-11T20:19:54.147
> 
> 标签：jquery, ajax, file, save

我正在使用 jquery 开发一个网页，它可以让我轻松地操作图像。

我设置了一些按钮，客户端（通过浏览器）可以在其中输入一些信息（例如“0”或“1”）。我的主要问题是我需要将该信息保存到服务器中的文件中，但我还没有找到一种简单的方法来做到这一点。

有什么建议吗？我已经读过使用 ajax 可以完成，但我对使用它感到非常困惑。

提前感谢您的帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-11T20:24:38.820

您将无法使用 jQuery 将文件直接写入服务器。您将需要使用 php、ruby、python、java、node.js 等服务器端语言来执行此操作。您将使用 AJAX 向用我之前提到的语言编写的服务器端应用程序发出请求.

# quartz-scheduler - Quartz jobs.xml 绝对路径

> ID：14286017
> 
> 赞同：0
> 
> 时间：2013-01-11T20:20:04.060
> 
> 标签：quartz-scheduler, jobs

在quartz.properties 中使用绝对路径时，我正在努力调试确切的问题。罐子：Quartz-all-2.1.1.jar 服务器：weblogic

石英属性：

```
org.quartz.scheduler.instanceName = QuartzScheduler
org.quartz.scheduler.instanceId = AUTO
org.quartz.threadPool.class = org.quartz.simpl.SimpleThreadPool
org.quartz.threadPool.threadCount = 8
org.quartz.threadPool.threadPriority = 8
org.quartz.jobStore.misfireThreshold = 60000
org.quartz.jobStore.class = org.quartz.simpl.RAMJobStore
org.quartz.plugin.jobInitializer.class = org.quartz.plugins.xml.XMLSchedulingDataProcessorPlugin
org.quartz.plugin.jobInitializer.fileNames =e:\\jobs.xml
org.quartz.plugin.jobInitializer.failOnFileNotFound = true
org.quartz.plugin.jobInitializer.scanInterval = 10
org.quartz.plugin.jobInitializer.wrapInUserTransaction = false 
```

我也尝试过使用

```
1) file://e:/jobs.xml
2) e:/jobs.xml
3) e:\jobs.xml 
```

没有任何效果，总是低于异常

```
java.net.MalformedURLException: unknown protocol: e
    at java.net.URL.<init>(URL.java:574)
    at java.net.URL.<init>(URL.java:464)
    at java.net.URL.<init>(URL.java:413)
    at oracle.xml.parser.v2.XMLReader.pushXMLReader(XMLReader.java:252)
    at oracle.xml.parser.v2.XMLParser.parse(XMLParser.java:222)
    at oracle.xml.jaxp.JXDocumentBuilder.parse(JXDocumentBuilder.java:155)
    at weblogic.xml.jaxp.RegistryDocumentBuilder.parse(RegistryDocumentBuilder.java:163)
    at org.quartz.xml.XMLSchedulingDataProcessor.process(XMLSchedulingDataProcessor.java:550)
    at org.quartz.xml.XMLSchedulingDataProcessor.processFile(XMLSchedulingDataProcessor.java:514)
    at org.quartz.xml.XMLSchedulingDataProcessor.processFileAndScheduleJobs(XMLSchedulingDataProcessor.java:896)
    at org.quartz.plugins.xml.XMLSchedulingDataProcessorPlugin.processFile(XMLSchedulingDataProcessorPlugin.java:329)
    at org.quartz.plugins.xml.XMLSchedulingDataProcessorPlugin.start(XMLSchedulingDataProcessorPlugin.java:256)
    at org.quartz.plugins.SchedulerPluginWithUserTransactionSupport.start(SchedulerPluginWithUserTransactionSupport.java:144)
    at org.quartz.core.QuartzScheduler.startPlugins(QuartzScheduler.java:2342)
    at org.quartz.core.QuartzScheduler.start(QuartzScheduler.java:527)
    at org.quartz.impl.StdScheduler.start(StdScheduler.java:143) 
```

问候普里亚

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-15T11:36:09.523

试一试`file:/e:/jobs.xml`。

至少，这是一个有效的 URL。

HIH

# java - 有没有办法使用 Hibernate 有条件地插入？

> ID：14286024
> 
> 赞同：2
> 
> 时间：2013-01-11T20:20:24.090
> 
> 标签：java, oracle, hibernate, not-exists

我们有一个表，其中每个更新值都有新行。主键由 ID 和时间戳组成。还有一个状态栏。对于特定的 ID，我们将有一行表示每次更新该值，我们使用具有最新时间戳的行来表示“当前”值。

我们有一个基于用户输入更新状态的过程。因此，当用户单击 UI 中的按钮时，将使用新状态和新用户 ID 创建一个新行。

如果两个用户同时单击该按钮，我们只是插入了两条新记录，其中一个将获胜（具有最新时间戳的那个）。我们希望避免让两个用户同时单击此按钮，而一个用户可能会在不知道他们踩到其他人的状态更改的情况下创建一个新行。在 Oracle 中，我们只需执行类似的操作并检查是否插入了一行（其中 PREVIOUS_KNOWN_MAX_TS 是用户查看页面时“当前”记录的 TS）：

```
INSERT INTO SOME_TABLE
   (ID, REVISION_TS, USER_ID, STATUS, ...)
SELECT 1, 'SOME_TIMESTAMP', 'user123', 'NEW_STATUS', ...
FROM DUAL
WHERE NOT EXISTS
   (SELECT *
   FROM SOME_TABLE
   WHERE USER_ID = 1
      AND REVISION_TS >= 'PREVIOUS_KNOWN_MAX_TS')); 
```

如果在用户查看页面和插入用户更新信息的时间之间有插入，则插入不会发生，我们会通过知道插入了零行来检测到这一点。

有没有办法在 Hibernate 中做到这一点，或者我们应该尝试做某种 SELECT FOR UPDATE 吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-08-14T19:10:58.327

如果你注释你的实体类，`org.hibernate.annotations.SQLInsert`你可以覆盖 Hibernate 生成的插入。不过这有点棘手，因为您必须以与 Hibernate 通常插入使用它们的方式完全相同的方式使用绑定参数。

# xcode - 从 MainMenu.xib 初始化 NSObjects

> ID：14286025
> 
> 赞同：0
> 
> 时间：2013-01-11T20:20:31.760
> 
> 标签：xcode, macos, cocoa

在 MainMenu.xib 我可以删除 NSObjects 来创建类实例。这些对象被丢弃的垂直顺序是它们将被分配的顺序吗？我可以依靠吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-11T20:42:46.210

不，您不能将列出对象的顺序依赖于实例化它们的顺序。您*可以*依赖这样一个事实，即一旦`awakeFromNib`在您的 nib 中的对象上调用，所有对象都已被实例化并且对象之间的所有连接都已创建。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-11T20:38:01.117

你想做什么？

如果您正在谈论使用 GUI 拖入 .h 文件以创建属性和方法。那么它们的顺序无关紧要。

如果元素是相关的，需要按一定的顺序分配。然后，您可以进入 .m 文件并手动更改分配它们的顺序或隐藏某些元素直到需要它们。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-11T20:47:08.847

您可以对此进行测试并依赖一段时间。Nib 编辑器 (Xcode) 以未描述的方式将对象描述保存到 nib 文件。Nib 取消归档 (init...) 顺序也没有明确定义。不能明确保证 AwakeFromNib 的顺序（这在手册中有说明）。下一个 Xcode 或可可版本可能会改变一切。

判决：没有。

# java - Android ImageView 设置图片来源

> ID：14286026
> 
> 赞同：0
> 
> 时间：2013-01-11T20:20:34.523
> 
> 标签：java, android, android-imageview

我正在尝试设置图像的来源，但出现错误。

```
String test1 = pref.getString("test", "ERROR");
String drawable1 = "R.drawable."+test1;
myImage.setImageResource(drawable1); 
```

我试过设置`int drawable1 = "R.drawable."+test1;`，但还是不行。我知道这是类型不匹配，但我似乎无法找到完成它的方法。

看来您可以进一步分解问题并说出您是如何完成这项工作的？

```
String drawable1 = "R.drawable.myImage";
myImage.setImageResource(drawable1); 
```

有任何想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-11T20:22:58.397

> 我试过设置`int drawable1 = "R.drawable."+test1;`，但还是不行。

您需要使用[`getIdentifier()`](http://developer.android.com/reference/android/content/res/Resources.html#getIdentifier%28java.lang.String,%20java.lang.String,%20java.lang.String%29)从字符串正确构建资源 ID：

```
int drawable1 = getResources().getIdentifier(test1, "drawable", getPackageName()); 
```

（现在还有另外两个答案暗示了同样的事情......我错过了什么还是他们只是想重复已经说过的内容？）

* * *

请注意，如果您的图像很大或在加载文档时导致明显的延迟，则[`setImageResources()`](http://developer.android.com/reference/android/widget/ImageView.html#setImageResource%28int%29)有其他建议：

> 这会在 UI 线程上进行位图读取和解码，这可能会导致延迟打嗝。如果这是一个问题，请考虑使用`setImageDrawable(android.graphics.drawable.Drawable)`or`setImageBitmap(android.graphics.Bitmap)`和`BitmapFactory`代替。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-11T20:25:40.103

假设您有一个`context`（`this`如果代码在活动中，则使用）

```
int resId = context.getResources().getIdentifier(test1 , "drawable", cw.getPackageName());
myImage.setImageResource(resId); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-11T20:30:36.400

利用

```
 int drawable1 =  getResources().getIdentifier(test1, "drawable", getPackageName(); 
```

要了解更多如何按名称获取资源，请参阅此[链接](http://www.anddev.org/tinytut_-_get_resources_by_name__getidentifier_-t460.html)

# c++ - C ++：从容器中提取N个最高元素

> ID：14286028
> 
> 赞同：1
> 
> 时间：2013-01-11T20:20:35.630
> 
> 标签：c++, algorithm, stl

我经常需要从未排序的 STL 容器中提取 N (> 1) 个最高元素。天真的方法是使用`<queue>`.

有没有更快、更少样板的方法？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-11T20:23:53.157

要获得`n`最小的元素，请使用[`nth_element`](http://en.cppreference.com/w/cpp/algorithm/nth_element)：

```
std::vector<int> v = { 2, 6, 1, 13, 51, 5, 0, -1 };

std::nth_element(v.begin(), v.begin() + 3, v.end());

// now v[0], v[1], v[2] are the smallest, not otherwise sorted 
```

确保`#include <algorithm>`. 可以提供一个可选的谓词来定制排序顺序（例如`std::greater<int>`）。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-11T20:23:09.103

`std::partial_sort`如果您按顺序需要它们，否则`std::nth_element`，`greater`在任何一种情况下都将其用作谓词。

我不知道提取是否意味着您要删除，但如果您这样做，那么另一个选择是使用您的容器堆积`make_heap`，然后将`N`元素从其中拉出。

# android - Unity 和 2d 应用程序

> ID：14286030
> 
> 赞同：0
> 
> 时间：2013-01-11T20:20:41.077
> 
> 标签：android, ios, 2d, unity3d

我想变成 Unity 以进行未来的开发，但就目前而言，我对那个引擎有一点了解。因此，我想问您，Unity 是开发 2d 应用程序的好选择还是仅适用于游戏？它是否提供与 Android 相同的功能，例如触摸屏或 iOS 多点触控？

使用 Unity 开发专用于 Android 和 iOS 的应用程序是明智之举，还是坚持使用 Android 和 iOS 的这两种不同的开发路径更好？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-12T04:18:57.790

在 Unity 中创建出色的 2D 游戏是非常有可能的。事实上，跟随你的评论：

> 更清楚地说，我的意思是 2d 拖放游戏。Unity不能用于非游戏应用程序是否有特定原因？

即使在 2D 中，Unity 也可以创建非游戏应用程序。Unity 的好处是您可以轻松创建实用程序/软件/非游戏应用程序。Unity 为多个平台打造了一个出色的软件平台。在大多数情况下，Unity 在逻辑和功能方面具有 C# Mono 的强大功能。

使用 Unity 的陷阱之一是 GUI。为了获得良好的 GUI，您可能需要查看一些替代的第三方 Unity 插件。

换句话说，Unity 非常适合全方位的多平台开发。:)

# java - 警报对话框中的 SeekBar

> ID：14286034
> 
> 赞同：4
> 
> 时间：2013-01-11T20:20:50.623
> 
> 标签：java, android

我正在尝试将 a`SeekBar`放在`AlertDialog`. 我有这个代码：

```
AlertDialog.Builder builder = new AlertDialog.Builder(GameScreen.this);
        LayoutInflater inflater = GameScreen.this.getLayoutInflater();
        builder.setView(inflater.inflate(R.layout.betvalue, null))
               .setPositiveButton  ... 
               .setNegativeButton ...
               .setTitle("Enter bet amount");
        SeekBar sbBetVal = (SeekBar)findViewById(R.id.sbBetVal);
        tvBetVal = (TextView) findViewById(R.id.tvBetVal);
        sbBetVal.setMax(playerList[0].getChipCount());
        sbBetVal.setProgress(0);
        sbBetVal.setOnSeekBarChangeListener(new OnSeekBarChangeListener() {

            @Override
            public void onStopTrackingTouch(SeekBar seekBar) {
                // TODO Auto-generated method stub

            }

            @Override
            public void onStartTrackingTouch(SeekBar seekBar) {
                // TODO Auto-generated method stub

            }

            @Override
            public void onProgressChanged(SeekBar seekBar, int progress,
                    boolean fromUser) {
                // TODO Auto-generated method stub
                tvBetVal.setText(String.valueOf(progress));
            }
        });

        builder.create();
        builder.show(); 
```

但是，这给了我一个`NullPointerException`. 为什么会这样，我该如何解决？

这是日志猫：

```
01-11 18:16:52.898: E/AndroidRuntime(27668): FATAL EXCEPTION: main
01-11 18:16:52.898: E/AndroidRuntime(27668): java.lang.NullPointerException
01-11 18:16:52.898: E/AndroidRuntime(27668):    at com.rhiokai.chipcounter.GameScreen.onClick(GameScreen.java:214)
01-11 18:16:52.898: E/AndroidRuntime(27668):    at android.view.View.performClick(View.java:4202)
01-11 18:16:52.898: E/AndroidRuntime(27668):    at android.view.View$PerformClick.run(View.java:17340)
01-11 18:16:52.898: E/AndroidRuntime(27668):    at android.os.Handler.handleCallback(Handler.java:725)
01-11 18:16:52.898: E/AndroidRuntime(27668):    at android.os.Handler.dispatchMessage(Handler.java:92)
01-11 18:16:52.898: E/AndroidRuntime(27668):    at android.os.Looper.loop(Looper.java:137)
01-11 18:16:52.898: E/AndroidRuntime(27668):    at android.app.ActivityThread.main(ActivityThread.java:5039)
01-11 18:16:52.898: E/AndroidRuntime(27668):    at java.lang.reflect.Method.invokeNative(Native Method)
01-11 18:16:52.898: E/AndroidRuntime(27668):    at java.lang.reflect.Method.invoke(Method.java:511)
01-11 18:16:52.898: E/AndroidRuntime(27668):    at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:793)
01-11 18:16:52.898: E/AndroidRuntime(27668):    at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:560)
01-11 18:16:52.898: E/AndroidRuntime(27668):    at dalvik.system.NativeStart.main(Native Method) 
```

这是xml：

```
<?xml version="1.0" encoding="utf-8"?>
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
android:id="@+id/betvalue"
android:layout_width="fill_parent"
android:layout_height="wrap_content"
android:padding="10dp" >

<TextView
    android:id="@+id/tvBetVal"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_alignParentTop="true"
    android:layout_centerHorizontal="true"
    android:text="@string/chips_fill"
    android:textAppearance="?android:attr/textAppearanceLarge" />

<SeekBar
    android:id="@+id/sbBetVal"
    android:layout_width="fill_parent"
    android:layout_height="wrap_content"
    android:layout_below="@+id/tvBetVal"
    android:layout_centerHorizontal="true" />

</RelativeLayout> 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-11T20:51:14.977

试试这个方法。。

必须使用膨胀视图来制作`seekbar`和参考 id 。`textview`

```
 AlertDialog.Builder builder = new AlertDialog.Builder(GameScreen.this);
    LayoutInflater inflater = GameScreen.this.getLayoutInflater();
    View v = inflater.inflate(R.layout.betvalue, null);
    builder.setView(v)
           .setPositiveButton  ... 
           .setNegativeButton ...
           .setTitle("Enter bet amount");
    SeekBar sbBetVal = (SeekBar)v.findViewById(R.id.sbBetVal);
    tvBetVal = (TextView)v. findViewById(R.id.tvBetVal);
    sbBetVal.setMax(100);
    sbBetVal.setProgress(0);
    sbBetVal.setOnSeekBarChangeListener(new OnSeekBarChangeListener() {

        @Override
        public void onStopTrackingTouch(SeekBar seekBar) {
            // TODO Auto-generated method stub

        }

        @Override
        public void onStartTrackingTouch(SeekBar seekBar) {
            // TODO Auto-generated method stub

        }

        @Override
        public void onProgressChanged(SeekBar seekBar, int progress,
                boolean fromUser) {
            // TODO Auto-generated method stub
            tvBetVal.setText(String.valueOf(progress));
        }
    });

    builder.create();
    builder.show(); 
```

快乐编码:)

# javascript - 使用 jquery / js 将 html 元素显示为带有暂停的序列

> ID：14286043
> 
> 赞同：1
> 
> 时间：2013-01-11T20:21:24.520
> 
> 标签：javascript, jquery, asp.net, html, jquery-animate

我已经搜索了很长一段时间，在每个人都打我 setTimeout() 函数之前，请听我说完。

我有大约 20 个不可见的 HTML 元素。我希望它们一次可以看到一个，中间有一个暂停。我还想在让它们可见时使用一些 jQueries 很棒的动画功能。

所以基本上我想使用 JavaScript/jQuery“播放一系列帧/事件/状态”。

**我在看什么？**

**设置超时（）：**

我一直在研究 JS 的 setTimeout 函数，据我所知，当你有 1-3 个 setTimeout() 函数时，它的效果很好。

如果你想要更多，它开始变得非常混乱。它们是嵌入的，您必须通过将数字相加来计算所有时间，而且很难获得整体情况。

**jQuery.delay()**

此外，jQuery.delay() 函数缺乏实际暂停代码的功能。我有 20 多个元素，没有一个我想制作动画。

**更新面板垃圾邮件**

我现在考虑的另一种选择（请杀了我）是使用更新面板。它每秒钟都使用计时器进行回发，并使用会话，它确切地知道它是在什么“帧”。然后它可以根据帧数设置可见/不可见，还可以触发 jQuery 动画。

现在，当我今天早上醒来时，我没想到会用这样的更新面板向我的网络服务器发送垃圾邮件......所以：

有什么好的方法可以做到这一点吗？我非常愿意接受建议。

非常感谢！:-)

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-01-11T20:33:43.750

如果将相同的类应用于所有元素（`sequential_expose`在我的示例中），则可以选择这些元素并调用`each()`选择。要错开元素的淡入，您可以将提供的项的索引`each()`倍增，并将其乘以您想要的淡入之间延迟的时间，并将该值作为参数传递给`delay()`. 给定 500 毫秒的间隔（您可以随意设置），选择中的第一项将具有`0`延迟、第二项`500`、第三项`1000`等。然后您只需在调用后链接您喜欢的动画（`fadeIn(200)`在我的示例中）`delay()`.

```
$(function () {
    $('.sequential_expose').each(function(i) {
        $(this).delay(i*500).fadeIn(200);
    });
}); 
```

请注意，该示例将其显示为文档就绪功能，您显然可以根据需要更改它。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-11T20:27:20.383

这是我将如何使用`setTimeout`它：

```
// Assume your target elements are all divs 
var elements = $('div');

function showOne() {
    // Fade-in the first element
    elements.first().fadeIn(200);

    // Remove first element from our jQuery object
    elements.splice(0,1);

    // If there are further elements, start a new timer
    if(elements.length) {
        setTimeout(showOne, 500);
    }
}

// Start first timeout
setTimeout(showOne, 500); 
```

[http://jsfiddle.net/uRwFK/](http://jsfiddle.net/uRwFK/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-11T21:02:10.493

[jQuery animate()](http://api.jquery.com/animate/)包含一个**完整**的回调，允许您链接动画。

假设您有一个包含 20 个 DOM 元素的数组，这是一个粗略的片段：

```
var elArray=[el1,el2,...el20];

function animateFunction(i) {
    $(elArray[i]).animate(
       ...
       // on complete move to the next element
       complete: function(){if (i<elArray.length-1) animateFunction(i+1);}
    });
}

animateFunction(0); 
```

# javascript - 如何使用 JavaScript 验证此 HTML 表单？

> ID：14286044
> 
> 赞同：1
> 
> 时间：2013-01-11T20:21:24.267
> 
> 标签：javascript, html, forms, validation

我正在使用这个 HTML 表单，并且正在尝试验证这些字段。我想使用 JavaScript 检查每个字段是否为空。如果该字段为空，我希望显示隐藏的关联 div。

当前问题：如果两个字段都留空，则 proName 仅显示第一个 div，第二个不显示。我怎样才能让它们都出现？

```
 <html>
 <body>
 <form action="" method="post" class="form" name="form" onsubmit="return validateForm();">
      <p><label for="proName">Processors Name: </label>
           <input type="text" name="proName" id="proName"></p>
                <div id="alertProName" style="display:none;">
                     <p>Please fill in this field</p>
                </div>

      <p><label for="compName">Company Ordered Through: </label>
           <input type="text" name="compName" id="compName"></p>
                <div id="alertCompName" style="display:none;">
                     <p>Please fill in this field</p>
                </div>
 </form>

 <script type="text/javascript">
 function validateForm() {
      var x=document.forms["form"]["proName"].value;                    

      if (x==null || x=="") {
      var s = document.getElementById("alertProName").style.display="block";
      return false;
      }
 };

 function validateForm() {
      var z=document.forms["form"]["compName"].value;                   

      if (z==null || z=="") {
      var a = document.getElementById("alertCompName").style.display="block";
      return false;
      }
 };
 </script>
 </body>
 </html> 
```

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-11T20:29:52.843

```
function validateForm(){
  var valid = true;
  var x=document.forms["form"]["proName"].value;                    
  if (x==null || x=="") {
    document.getElementById("alertProName").style.display="block"; //show the error message
    valid = false;
  }else{
    document.getElementById("alertProName").style.display="none"; // hide the error message
  }
  var z=document.forms["form"]["compName"].value;                   

  if (z==null || z=="") {
    document.getElementById("alertCompName").style.display="block";//show the error message
    valid = false;
  }else{
    document.getElementById("alertCompName").style.display="none"// hide the error message
  }
  return valid; // only if both are valid will we submit
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-11T20:36:40.783

验证表单客户端不是一个好主意，因为客户端总是可以绕过它。

但是，如果您真的想在客户端验证表单，可以使用 HTML5 表单验证：

```
<input type="text" name="somefield" required /> 
```

required 属性告诉浏览器该字段是必需的。

确保使用 HTML5 DOCTYPE ( `<DOCTYPE HTML>`)。

示例：http: [//jsbin.com/ubuqan/1/edit](http://jsbin.com/ubuqan/1/edit)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-11T20:30:13.430

看看有什么`validateForm()`作用会很有帮助......
我认为它需要成为两种验证方法的包装器，并在一次调用中确定要显示哪个 div。就目前而言，如果`validateProName`返回 false 则不需要执行`validateCompName`

我会让它执行以下操作，将 validateProName 和 validateCompName 的值分配给局部变量，然后在值为 false 时显示它们的 div。然后，您将简化现有方法...

```
<script type="text/javascript">
function validateForm() {
  var pro= validateProName();
  var comp = validateCompName();
  if (!pro) {
      var s = document.getElementById("alertProName").style.display="block";
  }
  if (!comp) {
      var a = document.getElementById("alertCompName").style.display="block";
  }
}
</script> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-11T20:31:04.137

为什么不将它们组合成一个功能。

```
 <script type="text/javascript">
 function validateForm() {
      var x=document.forms["form"]["proName"].value;                    

      if (x==null || x=="") {
      var s = document.getElementById("alertProName").style.display="block";
      return false;

      var z=document.forms["form"]["compName"].value;                   

      if (z==null || z=="") {
      var a = document.getElementById("alertCompName").style.display="block";
      return false;
      }
 }; 
```

这能达到你想要的吗？

安德鲁

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2013-01-11T20:33:07.927

将您的表单更改为：

```
<form action="" method="post" class="form" name="form" onsubmit="return validateForm(this);"> 
```

然后你只需要一个函数来显示 div：

```
<script type="text/javascript">
function validateForm(form) {
    for (e in form.elements) {
        var element = form.elements[e];

        if (element.type == "text") {
            console.log(element.name);
            var elementName = element.name;
            elementName = "alert" + elementName.charAt(0).toUpperCase() + elementName.slice(1);
            var alertElement = document.getElementById(elementName);
            if (alertElement)
                alertElement.style.display = "block";
        }
    }

    return false;
}
</script> 
```

这假设任何时候你有一个文本字段，它也会有一个带有相同名称的伴随 DIV，前面带有“alert”。

# xamarin.ios - MonoTouch --keeptemp 输出

> ID：14286050
> 
> 赞同：1
> 
> 时间：2013-01-11T20:22:21.027
> 
> 标签：xamarin.ios, monodevelop

当我使用附加的 mtouch 参数编译我的项目时，我试图弄清楚如何从 MonoTouch 获取 main.m 模板和其他代码`-v -v -v --keeptemp`。这是在较早的帖子[MonoTouch 中建议的：从 Obj-C 到 MonoTouch](https://stackoverflow.com/questions/5472993/monotouch-talking-from-obj-c-to-monotouch/5481074#5481074) 但我看不到任何输出（.m 或 .s 文件）

我使用 MonoDevelop 3.0.6 和 MonoTouch 6.0.8 版（无评估版）

我不使用命令行工具。在 MonoDevelop 中，我将我的参数添加到“Iphone Build/Additional mtouch arguments:”项目选项中。

我尝试从 MonoTouch 示例中编译 AVCaptureFrames。Release 配置中已经有这个附加参数`-v -v -v -keeptemp`（只有一个`-`！）

我用`-keeptemp`and with尝试过，`--keeptemp`但没有生成额外的 .m 或 .s 文件。（或者不知道他们在哪里）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-11T20:32:31.517

使用`-keeptemp`意味着`mtouch`（命令行）工具不会删除它创建的临时文件。但是，它不会改变这些文件的创建位置，即它们仍然是在临时目录中创建的。

现在要找到使用的临时目录，您需要检查构建日志（在 MonoDevelop 的错误垫列表中）并查看正在使用的文件。

例如`main.m`，在日志中查找，您将看到（创建然后）使用它的目录。您可以从该位置打开文件（如果`-keeptemp`已使用，否则将被删除）。

# java - 使用 Twiteer4J 使用其他帐户发布推文

> ID：14286054
> 
> 赞同：1
> 
> 时间：2013-01-11T20:22:40.133
> 
> 标签：java, android, twitter4j

我第二天在我的应用程序中使用 Twitter API 我有一个活动，它使用身份验证显示来自我的帐户 user_timeline 的推文，我正在使用[Twitter4J](http://twitter4j.org/en/index.html)库，一切正常，但我想给用户选项能够推特我的帐户，这些推文出现在我的`user_timeline`...

基本上用户阅读了我的推文，也可以发推文......我不知道是否清楚。

我该如何进行？

使用下面的这段代码，我发布了一条推文，但是它是与经过身份验证的我的用户一起发布的。我想要的是做同样的事情，但与另一个用户..（任何用户使用该应用程序）

```
private void publish(){
           String message="Tweet example";
           try {
               Twitter twitter = ((TwitterApplication)getApplication()).getTwitter();

               Status status = twitter.updateStatus(message);
               logger.info("Successfully updated the status to [" + status.getText() + "].");
           } catch (TwitterException te) {
               te.printStackTrace();
               logger.severe("Failed to get timeline: " + te.getMessage());
           } 

     } 
```

# c++ - 如何在 C++ 中使用继承序列化类

> ID：14286055
> 
> 赞同：3
> 
> 时间：2013-01-11T20:22:40.897
> 
> 标签：c++, linux, serialization

我想序列化一个作为继承一部分的类。我正在使用 C++98 并且没有第 3 方库。这是我的班级结构：

```
class Base{
public:
    virtual RunMe()=0;
};

class Derived: public Base{
    virtual RunMe(){
        std::cout << "I am running << std::endl;
    }
}; 
```

我能够通过朋友技术使用 ofstream 和 fstream 序列化一个基本类。但是如果我的基类具有纯虚函数，我无法弄清楚如何实现序列化。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-11T20:32:26.393

将序列化支持方法添加到您的基类。
您的子类将首先调用基类支持方法，然后是它们自己的。

```
class Base
{
  public:
    virtual void binary_write(ostream& out) // Serialization support function.
    {
        out.write(&m_base_variable, sizeof(m_base_variable));
    }
  private:
    unsigned int m_base_variable;
};

class Derived
: public Base
{
  public:
    virtual void binary_write(ostream& out) // Serialization support function
    {
        Base::binary_write(out); // Call Base's method first;
        out.write(m_derived_variable, sizeof(m_derived_variable));
    }
  private:
    double m_derived_variable;
}; 
```

# emacs - 如何静默禁用的命令？

> ID：14286058
> 
> 赞同：1
> 
> 时间：2013-01-11T20:22:50.980
> 
> 标签：emacs, dot-emacs

我想在 Emacs中**静默禁用的命令。**可能完全解开它们。

当我滑入禁用命令绑定（例如`a`in `Dired`）时——我不允许这样做，因为我不想使用它——我希望它静默失败，而不是让我取消我不打算做的事情做。在每个命令的基础上会很好，但我不介意将它们全部删除。

我知道[永久启用所有禁用的命令](https://stackoverflow.com/questions/10026221/enable-all-disabled-commands-permanently)，但我在永久*禁用*它们之后。我想我可以一一解开它们，但这意味着[采购它们在其中定义的地图](https://superuser.com/questions/506381/how-to-source-key-translations-in-emacs)，这是我无法做到的（除了麻烦之外）。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-11T20:35:33.687

最简单的方法是

```
(setq disabled-command-function 'ignore) 
```

然后禁用的键被忽略，当你点击时没有任何反应，例如，`C-x n n`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-11T20:35:19.923

因为有几次`C-x C-c`被误击而恼火，所以做了一个函数：

```
(defun not-anymore ()
"For overwriting wrong keybindings"
  (interactive)
  (message "not anymore")
)

(global-set-key (kbd "C-x C-c") 'not-anymore) 
```

当然，您可以省略消息行。

这允许您根据选择排除命令。

# ios - 从 iPad 应用程序发送电子邮件后，sqlite 数据库没有数据

> ID：14286066
> 
> 赞同：1
> 
> 时间：2013-01-11T20:23:18.613
> 
> 标签：ios, ipad, sqlite

我有一个 iPad 应用程序供我的客户使用，现在我需要在应用程序中添加一个功能，他们可以单击一个按钮来打开电子邮件程序并将应用程序使用的 sqlite 数据库发送给我以进行问题诊断。我遵循了苹果的示例应用程序，它运行良好。我收到了附有数据库文件的电子邮件。从电子邮件下载文件并在 SQLite Manager(Firefox) 中打开它后，所有表模式都是正确的，但是没有数据。有谁知道问题是什么？我下载的 db 文件与从设备下载的文件大小完全相同。谢谢。

```
Class mailClass = (NSClassFromString(@"MFMailComposeViewController"));

if (mailClass != nil)
{

   // check whether the current device is configured for sending emails

   if ([mailClass canSendMail])
  {
        MFMailComposeViewController *picker = [[MFMailComposeViewController alloc] init];
        picker.mailComposeDelegate = self;

        [picker setSubject:@"database file from ios app"];

        // Set up recipients
        NSArray *toRecipients = [NSArray arrayWithObject:@"someEmailAddress@gmail.com"];

        [picker setToRecipients:toRecipients];

        // Attach db file to the email
        NSString *path = [[NSBundle mainBundle] pathForResource:@"MyDB" ofType:@"sqlite"];
        NSData *myData = [NSData dataWithContentsOfFile:path];
        [picker addAttachmentData:myData mimeType:@"application/x-sqlite3" fileName:@"MyDB.sqlite"];

        // Fill out the email body text
        NSString *emailBody = @"test email with db";

        [picker setMessageBody:emailBody isHTML:NO];
        picker.modalPresentationStyle = UIModalPresentationFormSheet;
        [self presentModalViewController:picker animated:YES];

        [picker release];
    }
    else // email not configured
    {
        // Alert email is not configured
    }
}
else // older iOS
{
      // Alert OS is too old
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-12T01:56:29.867

您发布的代码是从应用程序的资源包中读取数据库文件。这是最初随应用程序提供的只读文件。

您需要获取具有实际数据的可写数据库文件。也许您在 Documents 目录（或其他一些可写的沙箱目录）中有这个。

顺便说一句 - 你为什么要检查`MFMailComposeViewController`课程？它从 iOS 3.0 开始就存在。我怀疑您的应用需要支持 iOS 2.x（甚至 3.x）。

# validation - 如何验证一个 XSD 架构是另一个 XSD 架构的子集？

> ID：14286071
> 
> 赞同：8
> 
> 时间：2013-01-11T20:23:43.537
> 
> 标签：validation, xsd, schema, subset

如何验证一个 XSD 架构是另一个 XSD 架构的子集？

我们正在使用一组“蓝图”XSD 模式（定义子组件可用的所有可能输入或输出）来创建一个系统系统应用程序。正在实现许多子组件，这些子组件使用 XML 文件在它们之间传递数据。每个子组件创建相关蓝图 XSD 模式的子集（以指示它选择实现的可能输入或输出）。针对子集 XSD 架构验证的任何 XML 数据文件也必须针对蓝图 XSD 架构进行验证，但反之则不正确（因为子集 XSD 架构可能不包含来自蓝图 XSD 架构的所有“可选”或“选择”XML 元素，并且它可以选择进一步限制现有 XML 标记上允许的数据值）。

在测试期间，我们打算验证每个子组件的子集 XSD 模式确实是关联蓝图 XSD 模式的子集，但我们没有自动执行此验证的方法。这些 XSD 架构相当大且丑陋，需要手动进行此测试。如果有一种“针对 XSD 文件 2 验证 XSD 文件 1”命令会很不错，类似于 Java 如何针对 XSD 模式执行 XML 文件的验证。我们想要确认每个子组件的子集 XSD 架构将不允许任何违反蓝图 XSD 架构的 XML 输入/输出组合。有了这种模式到模式的能力，

有用信息：此应用程序是作为 OSGi 包实现并使用 Maven 2.2.1 编译/执行的 Java 6 应用程序的集合。没有使用任何特定开发 IDE 的要求。该系统正在 Microsoft Windows XP 环境中进行测试，但也计划在其他环境中执行该系统（因此首选跨平台解决方案）。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-16T03:00:08.620

确保所需关系的最简单方法是通过限制蓝图模式的类型来派生子模式的类型。不过，听起来那艘船已经航行了。

像这里的其他人一样，我不知道有任何开箱即用的工具（尽管如果 Petru Gardea 说 QT Assistant 可以，那么值得跟进）。

一个复杂的问题是，有两种不同的方法可以查看您要验证的子集/超集关系：（1）模式 1 接受为有效的每个文档（或元素）也被模式 2 接受为有效（不参考类型分配），或（2）针对模式 1 和 2 的验证（在规范中称为后模式验证信息集）生成的类型化文档彼此之间存在适当的关系：如果元素或属性在树 1，在树 2 中有效；树 1 中分配给它的类型是树 2 中分配给它的类型的限制；等等。如果模式 1 和 2 是独立开发的，那么它们的类型通过推导相关联的可能性很小，所以我想你已经想到了第一种方法来解决这个问题。

但是，无论哪种形式，这个问题都绝对是可以确定的。对于任何模式（我正在仔细使用该术语），根据定义，都声明了有限数量的类型和有限数量的元素名称；因此，元素名称/类型对的数量有限（可能很大）。

该算法可以是这样的。

1.  从预期的根元素开始。（如果有多个可能的根元素，那么在一般情况下，您需要对它们中的每一个都运行此检查。）如果预期的根元素是 E，在模式 1 中的类型为 T1，在模式 2 中的类型为 T2，那么将任务“比较类型 T1 和 T2”放在打开任务的队列中。已完成的任务列表将为空。

2.  比较两种复杂类型 T1 和 T2：

    *   检查为 T1 和 T2 声明的属性集，以了解它们名称之间的子集/超集关系。确保预期超集中所需的属性在预期子集中不存在或可选。

    *   为 T1 和 T2 声明的每个属性 A 都将被分配一个类型（称为 ST1 和 ST2）。如果 ST1 = ST2，什么也不做；否则，将任务“比较简单类型 ST1 和 ST2”添加到打开任务的队列中，除非它在已经完成的比较列表中。

    *   现在检查 T1 和 T2 中可能的子序列 - 正如 13ren 在评论中所建议的那样，这是易于处理的，因为内容模型本质上是使用元素名称集作为其字母表的正则表达式；因此，它们定义的语言是常规语言，并且子集/超集关系对于常规语言是可确定的。

    *   每个可能的子元素 C 都由父类型 T1 和 T2 分配一个元素声明和一个类型定义。让我们称它们为 ED1、ED2、CT1 和 CT2。每个同名的子元素都将具有相同的类型，但不同的子元素可能匹配不同的元素声明。因此，对于任何可能的名称，只有一对类型 CT1 和 CT2，但可能有多对 ED1 和 ED2（分析需要小心以确保它们正确匹配；这可能很难自动化）。

    *   如果 CT1 = CT2，则什么都不做，否则将“比较类型 CT1 和 CT2”放到打开的任务队列中，除非已经执行了比较。

    *   如果 ED1 和 ED2 在结构上相同，则什么也不做；否则将比较它们的任务放入任务队列（除非它已经完成）。

3.  要比较两个简单类型 ST1 和 ST2，请比较它们的词汇空间（如果您想要模式上子集/超集关系的第一个定义）或它们的值空间（如果您想要第二个）。如果 ST1 和 ST2 都是相同原始类型的限制，您可以轻松地比较一组有效的基于方面的限制。模式方面可能会使事情复杂化，但是因为它定义了一组正则表达式，所以子集/超集关系是可以确定的。

4.  要比较两个元素声明，您需要比较元素声明的每个属性并检查所需的子集/超集关系。

正如您所看到的，它足够复杂和乏味，以至于您真的想要自动执行此分析，而且它也足够复杂，很容易看出为什么它没有作为开箱即用的功能广泛提供。但是编码肯定会很有趣。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-01-20T21:11:20.487

由于目前没有针对另一个模式验证/检查模式的可用解决方案，看起来我们必须使用变通方法。下面是我的尝试。

**重述问题：**

确定子模式中定义的所有数据类型是否存在并且是否在“蓝图”模式中定义的（不太严格的）范围内。

**一个可能的解决方案：**

1.  第一条（显而易见的）信息是 Schema 允许我们创建 XML 实例（这甚至意味着什么？！参见 2.）。
2.  我们拥有的另一条（不太明显）信息是 XML 模式本身可以是一个“子集实例”——我的意思是：如果您要从 XML 实例对模式进行逆向工程，那么您就有一个子集模式（如果您*没有*“列表”或选择元素或其他“限制”，则此陈述并不总是正确的，那么反向工程子集模式将精确映射到“蓝图”模式）。

因此，利用这些知识，我们可以构建一个解决方案：

创建子模式的所有可能的 XML 实例（以编程方式执行此步骤可能是一个挑战），并根据“蓝图”模式验证这些 XML 实例。

但是你怎么知道子集模式是“蓝图”模式的*子集？*好吧，由于您创建了子模式的所有可能的 XML 实例，它涵盖了子模式中的所有数据类型。并且根据“蓝图”模式验证这些 XML 实例，本质上是检查数据类型是否存在，以及所有数据类型是否都在“蓝图”模式中定义的范围内。因此，确定您的子集架构确实是“蓝图”架构的子集。

我知道这不是一个理想的解决方案，但希望这会有所帮助，因为没有简单的方法可以满足您的要求。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-18T15:55:54.627

谢谢@13ren，谢谢你的“哔”声：）

这是一个很长的评论，而不是一个答案。我将从我之前与 13ren 的交流开始，`more precise, it provides to a user all that is needed to define such an analysis model.`我的意思是在 QTAssistant（[这个](http://www.paschidev.com)）中我们有一个 XSD 比较功能；作为 XSD 感知，它已经做了很多文本或 XML 感知 diff 工具不能做的事情（例如，它不关心有多少 XSD 文件，它们的版本之间的布局变化等）对于提供的 UI， diff 引擎针对源模型工作，而不是 PSVI 模型。我们可以自定义它以使用 PSVI，因为后者更接近您的实际需要。我们还可以包括让自定义规则集增强“base”和“revision”之间的比较的能力，换句话说，允许用户覆盖我们当前使用的“=”运算符。

我认识到我们没有任何开箱即用的东西允许覆盖 xsd:pattern facets 的比较；也不是人类容易识别的东西，例如`xsd:positiveInteger`vs. `xsd:integer + xsd:minInclusive=1`。或者比较 an`xsd:all`到 a `xsd:choice`or `xsd:sequence`; 同样，我们不会解析出 XSD 约束的选择器和字段，这些约束很像正则表达式，不容易处理。

假设目标是找到尽可能多的“差异”而不是完全排除它们，QTAssistant 还有三个有用的功能：

*   对于给定的根元素，它会创建简单 XPath 的完整列表。它可以用作发现“流氓”数据的快速方法。开箱即用的这种比较方法不考虑结构模式，即如果 XPath1 和 XPath2 表示实例 XML 中的两个兄弟，那么 XPath1 必须在 XPath2 之前）等。
*   它带有一个内置的[查询 XSD 分析器](http://www.paschidev.com/whitepapers/query-xsd-getting-started.aspx)。SQL 可用于查询集合的 XSD 元模型以“发现”一些事物，这些事物指出了比较工具可能被设计为忽略的事物（出于可行性考虑），因此需要向人类报告以做出决定。
    *   XSD 重构 (XSR)。它是业内（至少我知道的）唯一一个从头开始构建并考虑 XSD 重构和分析的引擎。我认为，如果您可以排除 xsi:type 以及理想情况下也可以使用替换组（在这个问题上我仍然需要考虑），我们可以提供我们所谓的“规范化转换”——一个花哨的词通过依赖 PSVI 模型将模式集转换为俄罗斯娃娃设计风格。这里有很多事情可以发挥作用：id 属性的使用、多余序列的折叠、单个选项 xsd:choices 的替换等 - 这就是我们在开发中但尚未发布的原因。

我们在比较中必须提供的另一件事（您可能需要考虑）不仅与 XSD/XML 的等价性有关，而且与从 XSD 生成的工件（例如通过 JAXB 的 Java 类）的等价性有关。最重要的是，可扩展性模式，那些使用通配符（xsd:any 和 anyAttribute）的模式。

我们（QTAssistant）目前有兴趣通过一些更具体的要求与您合作（我们需要从交换代表性 XSD、我假设的 NDA 等开始），看看我们是否真的可以做到工作。如果您想继续，请随时通过与我的 SO 个人资料相关联的网站的支持地址与我联系。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-01-21T00:32:50.917

针对模式验证 XML 的工具已经知道如何执行此操作，因为在 的情况下`<xs:complexContent><xs:restriction>`，新定义的类型必须是受​​限制类型的子集。

如果您想利用此功能，您可以让子架构定义限制蓝图架构中类型的复杂类型。

但是，如果创建子模式时没有考虑到这一点，则仍然可以通过修改子模式以匹配下面的模式来完成，然后将它们发送到模式处理器进行验证。

蓝图架构示例 blueprintschema.xsd：

```
<xs:schema xmlns:xs="http://www.w3.org/2001/XMLSchema">
  <xs:element name="root" type="rootType"/>
  <xs:complexType name="rootType">
    <xs:sequence>
      <xs:element name="child1" minOccurs="0"/>
      <xs:element name="child2" minOccurs="0"/>
      <xs:element name="child3" minOccurs="0"/>
    </xs:sequence>
  </xs:complexType>
</xs:schema> 
```

作为蓝图架构子集的示例子架构：

```
<xs:schema xmlns:xs="http://www.w3.org/2001/XMLSchema">
  <xs:element name="root" type="rootType"/>
  <xs:complexType name="rootType">
    <xs:sequence>
      <xs:element name="child2"/>
    </xs:sequence>
  </xs:complexType>
</xs:schema> 
```

转换为重新定义构造后的示例子架构：

```
<xs:schema xmlns:xs="http://www.w3.org/2001/XMLSchema">
  <xs:redefine schemaLocation="blueprintschema.xsd">
    <xs:complexType name="rootType">
      <xs:complexContent>
        <xs:restriction base="rootType">
          <xs:sequence>
            <xs:element name="child2"/>
          </xs:sequence>
        </xs:restriction>
      </xs:complexContent>
    </xs:complexType>
  </xs:redefine>
  <xs:element name="root" type="rootType"/>
</xs:schema> 
```

然后，模式处理器将告诉您重新定义的“rootType”是否实际上是原始蓝图“rootType”的子集

由于模式只是 XML，因此可以使用普通的 XML 处理工具来完成转换。

# android - android xml，布局中自定义视图的崩溃

> ID：14286075
> 
> 赞同：1
> 
> 时间：2013-01-11T20:24:01.240
> 
> 标签：android, xml, layout, view

我设计了一个简单的指南针应用程序，第一步，我用一个单一的视图（指南针视图）编写了这个应用程序，它工作得很好。我创建了一个自定义指南针视图的新实例，并使用了 setcontent(mView)。

现在我正在尝试使用布局，但我无法让它工作！每次我尝试时，应用程序都会崩溃。

这是代码：

## 自定义视图：

```
public class CustomDrawableView extends View {
public float azimut;
Paint paint = new Paint();
public CustomDrawableView(Context context) {
    super(context);
    paint.setStyle(Style.STROKE);
    paint.setStrokeWidth(2);
    paint.setColor(Color.WHITE);
    paint.setAntiAlias(true);
    azimut=0;
  };
public CustomDrawableView(Context context, float Azimut) {
  super(context);
  paint.setStyle(Style.STROKE);
  paint.setStrokeWidth(2);
  paint.setColor(Color.WHITE);
  paint.setAntiAlias(true);
  azimut=Azimut;
};
protected void onDraw(Canvas canvas) {
    Bitmap bMap = BitmapFactory.decodeResource(getResources(),R.drawable.compassarrowbitmap);
    int width = getWidth();
    int height = getHeight();
    int centerx = width/2;
    int centery = height/2;
    int imHeight=200;
    int imWidth=200;
    Bitmap arrow = Bitmap.createScaledBitmap(bMap,imHeight , imWidth, false);
    canvas.save(Canvas.MATRIX_SAVE_FLAG); //Saving the canvas and later restoring it so only this image will be rotated.
    canvas.rotate(-azimut*360/(2*3.14159f), centerx, centery);
    canvas.drawBitmap(arrow, centerx-imWidth/2, centery-imHeight/2, null);
    canvas.restore();           
  }
} 
```

## xml文件：

```
<?xml version="1.0" encoding="UTF-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
android:orientation="vertical"
android:layout_width="fill_parent"
android:layout_height="fill_parent"
>
<FrameLayout 
android:layout_width="fill_parent"
android:layout_height="fill_parent">

<org.example.compassTest.CustomDrawableView
    android:id="@+id/compassview"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent" />
</FrameLayout>
</LinearLayout> 
```

## 主要活动：

```
public class MainActivity extends Activity implements SensorEventListener {
Float azimut=(float) 0;  // View to draw a compass
CustomDrawableView mCompassView;    
private SensorManager mSensorManager;
Sensor accelerometer;
Sensor magnetometer;

protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_main);
    this.mCompassView = (CustomDrawableView) findViewById(R.id.compassview);
    mSensorManager = (SensorManager)getSystemService(SENSOR_SERVICE);
    accelerometer = mSensorManager.getDefaultSensor(Sensor.TYPE_ACCELEROMETER);
    magnetometer = mSensorManager.getDefaultSensor(Sensor.TYPE_MAGNETIC_FIELD);
}
protected void onResume() {
    super.onResume();
    mSensorManager.registerListener(this, accelerometer, SensorManager.SENSOR_DELAY_UI);
    mSensorManager.registerListener(this, magnetometer, SensorManager.SENSOR_DELAY_UI);
}
protected void onPause() {
    super.onPause();
    mSensorManager.unregisterListener(this);
}

public void onAccuracyChanged(Sensor sensor, int accuracy) {  }

float[] mGravity;
float[] mGeomagnetic;
public void onSensorChanged(SensorEvent event) {
    if (event.sensor.getType() == Sensor.TYPE_ACCELEROMETER)
        mGravity = event.values;
    if (event.sensor.getType() == Sensor.TYPE_MAGNETIC_FIELD)
            mGeomagnetic = event.values;
    if (mGravity != null && mGeomagnetic != null) {
        float R[] = new float[9];
        float I[] = new float[9];
        boolean success = SensorManager.getRotationMatrix(R, I, mGravity, mGeomagnetic);
        if (success) {
            float orientation[] = new float[3];
            SensorManager.getOrientation(R, orientation);
            azimut = orientation[0]; // orientation contains: azimut, pitch and roll
        }
    }
    this.mCompassView.azimut=azimut;
    this.mCompassView.invalidate();
}
} 
```

* ***日志：

```
 01-07 04:40:54.957: W/dalvikvm(18101): threadid=1: thread exiting with uncaught exception (group=0x40c431f8)
01-07 04:40:54.957: E/AndroidRuntime(18101): FATAL EXCEPTION: main
**01-07 04:40:54.957: E/AndroidRuntime(18101): java.lang.RuntimeException: Unable to start activity ComponentInfo{org.example.compasstest/org.example.compasstest.MainActivity}: android.view.InflateException: Binary XML file line #11: Error inflating class org.example.compassTest.CustomDrawableView****
01-07 04:40:54.957: E/AndroidRuntime(18101):    at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1968)
01-07 04:40:54.957: E/AndroidRuntime(18101):    at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:1993)
01-07 04:40:54.957: E/AndroidRuntime(18101):    at android.app.ActivityThread.access$600(ActivityThread.java:127)
01-07 04:40:54.957: E/AndroidRuntime(18101):    at android.app.ActivityThread$H.handleMessage(ActivityThread.java:1159)
01-07 04:40:54.957: E/AndroidRuntime(18101):    at android.os.Handler.dispatchMessage(Handler.java:99)
01-07 04:40:54.957: E/AndroidRuntime(18101):    at android.os.Looper.loop(Looper.java:137)
01-07 04:40:54.957: E/AndroidRuntime(18101):    at android.app.ActivityThread.main(ActivityThread.java:4507)
01-07 04:40:54.957: E/AndroidRuntime(18101):    at java.lang.reflect.Method.invokeNative(Native Method)
01-07 04:40:54.957: E/AndroidRuntime(18101):    at java.lang.reflect.Method.invoke(Method.java:511)
01-07 04:40:54.957: E/AndroidRuntime(18101):    at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:790)
01-07 04:40:54.957: E/AndroidRuntime(18101):    at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:557)
01-07 04:40:54.957: E/AndroidRuntime(18101):    at dalvik.system.NativeStart.main(Native Method)
01-07 04:40:54.957: E/AndroidRuntime(18101): Caused by: android.view.InflateException: Binary XML file line #11: Error inflating class org.example.compassTest.CustomDrawableView
01-07 04:40:54.957: E/AndroidRuntime(18101):    at android.view.LayoutInflater.createViewFromTag(LayoutInflater.java:691)
01-07 04:40:54.957: E/AndroidRuntime(18101):    at android.view.LayoutInflater.rInflate(LayoutInflater.java:739)
01-07 04:40:54.957: E/AndroidRuntime(18101):    at android.view.LayoutInflater.rInflate(LayoutInflater.java:742)
01-07 04:40:54.957: E/AndroidRuntime(18101):    at android.view.LayoutInflater.inflate(LayoutInflater.java:489)
01-07 04:40:54.957: E/AndroidRuntime(18101):    at android.view.LayoutInflater.inflate(LayoutInflater.java:396)
01-07 04:40:54.957: E/AndroidRuntime(18101):    at android.view.LayoutInflater.inflate(LayoutInflater.java:352)
01-07 04:40:54.957: E/AndroidRuntime(18101):    at com.android.internal.policy.impl.PhoneWindow.setContentView(PhoneWindow.java:271)
01-07 04:40:54.957: E/AndroidRuntime(18101):    at android.app.Activity.setContentView(Activity.java:1835)
01-07 04:40:54.957: E/AndroidRuntime(18101):    at org.example.compasstest.MainActivity.onCreate(MainActivity.java:28)
01-07 04:40:54.957: E/AndroidRuntime(18101):    at android.app.Activity.performCreate(Activity.java:4465)
01-07 04:40:54.957: E/AndroidRuntime(18101):    at android.app.Instrumentation.callActivityOnCreate(Instrumentation.java:1052)
01-07 04:40:54.957: E/AndroidRuntime(18101):    at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1932)
01-07 04:40:54.957: E/AndroidRuntime(18101):    ... 11 more
01-07 04:40:54.957: E/AndroidRuntime(18101): Caused by: java.lang.ClassNotFoundException: org.example.compassTest.CustomDrawableView
01-07 04:40:54.957: E/AndroidRuntime(18101):    at dalvik.system.BaseDexClassLoader.findClass(BaseDexClassLoader.java:61)
01-07 04:40:54.957: E/AndroidRuntime(18101):    at java.lang.ClassLoader.loadClass(ClassLoader.java:501)
01-07 04:40:54.957: E/AndroidRuntime(18101):    at java.lang.ClassLoader.loadClass(ClassLoader.java:461)
01-07 04:40:54.957: E/AndroidRuntime(18101):    at android.view.LayoutInflater.createView(LayoutInflater.java:552)
01-07 04:40:54.957: E/AndroidRuntime(18101):    at android.view.LayoutInflater.createViewFromTag(LayoutInflater.java:680)
01-07 04:40:54.957: E/AndroidRuntime(18101):    ... 22 more 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-11T21:22:18.467

我认为您缺少此构造函数：

```
public CustomDrawableView(Context context, AttributeSet attrs) {
        super(context, attrs);
        // TODO Auto-generated constructor stub
    } 
```

您正在尝试从布局 xml 传递参数构建视图，但您没有任何可以接收它们的构造函数。

# excel - powershell 不能向 Excel 图表添加多个图例条目（系列）

> ID：14286078
> 
> 赞同：3
> 
> 时间：2013-01-11T20:24:33.527
> 
> 标签：excel, powershell, charts, legend, series

我在通过powershell向excels图表对象中的seriescollection添加多个系列时遇到问题这是我的代码：

```
[threading.thread]::CurrentThread.CurrentCulture = 'en-US'

$excel = New-Object -comobject Excel.Application

$workbook = $excel.workbooks.add()

$datasheet  = $workbook.Worksheets.Item(2)
$chartsheet = $workbook.Worksheets.Item(1)

[datetime] $startDate  = "2012-11-29 00:00:00" 
[datetime] $finishDate = "2012-12-07 00:00:00"
[datetime] $dayCounter = $startDate

$startRow = 2
$startColumn = 2

$columnCounter = 2
$rowCounter = 2
while ($dayCounter -le $finishDate)
{
  $datasheet.Cells.Item($rowCounter, $columnCounter) = $dayCounter.ToShortDateString()
  $datasheet.Cells.Item($rowCounter+1, $columnCounter) = $columnCounter
  $datasheet.Cells.Item($rowCounter+2, $columnCounter) = 2 * $columnCounter
  $columnCounter++
  $dayCounter = $dayCounter.AddDays(1)
}

$datasheet.Range($rowCounter.ToString() + ":" + $rowCounter.ToString()).NumberFormat = "m/d/yyyy"

$excel.application.DisplayAlerts=$False
$chart = $chartsheet.Shapes.addChart().chart
$chart.hasTitle = $true
$chart.chartTitle.text = "Ramp Example"
$chartType = [Microsoft.Office.Interop.Excel.XlChartType]::xlLine
$chart.chartType = $chartType

$startCell = $datasheet.Cells.Item(3,2).Address($false,$false)
$endCell   = $datasheet.Cells.Item(3,10).Address($false,$false)

$startCell + ", " + $endCell

$datarange = $datasheet.Range($startCell, $endCell)
$chart.SetSourceData($datarange)
$chart.SeriesCollection(1).Name    = "First"
$chart.SeriesCollection(1).XValues = $datasheet.Range("B2", "J2")

$newSeries = $chart.SeriesCollection().NewSeries
$chart.SeriesCollection(2).Values  = $datasheet.Range("B4", "J4")
$chart.SeriesCollection(2).Name    = "Second"
$chart.SeriesCollection(2).XValues = $datasheet.Range("B2", "J2")

$excel.Visible = $True 
```

错误：

使用“1”参数调用“SeriesCollection”的异常：“无效参数”在 C:\localwork\tfs\OpenExcel.ps1:49 char:24 + $chart.SeriesCollection <<<< (2).Values = $ datasheet.Range("B4", "J4") + CategoryInfo : NotSpecified: (:) [], MethodInvocationException + FullyQualifiedErrorId : ComMethodTargetInvocation

使用“1”参数调用“SeriesCollection”的异常：“无效参数”在 C:\localwork\tfs\OpenExcel.ps1:50 char:24 + $chart.SeriesCollection <<<< (2).Name = "第二” + CategoryInfo : NotSpecified: (:) [], MethodInvocationException + FullyQualifiedErrorId : ComMethodTargetInvocation

使用“1”参数调用“SeriesCollection”的异常：“无效参数”在 C:\localwork\tfs\OpenExcel.ps1:51 char:24 + $chart.SeriesCollection <<<< (2).XValues = $ datasheet.Range("B2", "J2") + CategoryInfo : NotSpecified: (:) [], MethodInvocationException + FullyQualifiedErrorId : ComMethodTargetInvocation

问题是; **如何使用 powershell 代码获得额外的 SeriesCollection 条目？**

任何帮助将不胜感激

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-13T21:54:17.853

问题解决了，必须在 newSeries 上调用 Invoke() - 所以：

```
$chart.SeriesCollection().NewSeries.Invoke() 
```

就是这样，我想这与我在 Excel 中创建的宏中调用 VBA 来开始这个开发有一些不同：

```
ActiveSheet.Shapes.AddChart.Select
ActiveChart.ChartType = xlLine
ActiveChart.SetSourceData Source:=Sheets("Sheet2").Range("B3:P3")
ActiveChart.SeriesCollection(1).Name = "=""First"""
ActiveChart.SeriesCollection.NewSeries
ActiveChart.SeriesCollection(2).Values = "=Sheet2!$B$4:$P$4"
ActiveChart.SeriesCollection(2).Name = "=""Second"""
ActiveChart.SeriesCollection(2).XValues = "=Sheet2!$B$2:$P$2" 
```

要在 powershell 中调用它，我还没有找到一个很好的例子来动态地将系列添加到 WEB 上的 Excel 图表中！

# vmware - 用于登录来宾 VM 的 VMWare PowerCLI API

> ID：14286086
> 
> 赞同：1
> 
> 时间：2013-01-11T20:24:59.257
> 
> 标签：vmware, virtual-machine, provisioning, powercli

我想使用 CI 服务器（如 Team City）自动创建和配置 VM。我发现有一个可用的 PowerCLI API 可以让您管理虚拟机，但我的问题是......

创建 VM 定义后（虚拟硬件定义 - 尚未安装操作系统）。是否可以安装操作系统并在目标来宾 VM 上创建用户，或者最好使用至少一个超级用户手动创建映像，然后使用 Chef 或 Puppet 控制一切？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-13T19:43:38.720

您可以创建称为[自定义规范](http://pubs.vmware.com/vsphere-50/index.jsp?topic=%2Fcom.vmware.vsphere.vm_admin.doc_50%2FGUID-7523239A-9BB8-4FAD-88F6-C8701933CA64.html)的东西，允许您创建、克隆或部署虚拟机。使用自定义规范，您可以定义用户凭据等并通过**VMware vSphere PowerCLI**进行部署，如下所示：

```
Get-VM VM | New-VM -VMHost Host -Datastore Storage1 -OSCustomizationSpec ClientSpec -Name VM1 
```

有关详细信息，请参阅[VMware vSphere Power CLI 用户指南](http://www.vmware.com/support/developer/PowerCLI/PowerCLI501/doc/vsph_powercli_usg501.pdf)。

# java - 发布 XML org.apache.http.ProtocolException 时出现 Java 错误：不是有效的协议版本：

> ID：14286087
> 
> 赞同：1
> 
> 时间：2013-01-11T20:25:03.107
> 
> 标签：java, xml, post

`org.apache.http.ProtocolException: Not a valid protocol version: <html>`当我尝试按照[示例](http://hc.apache.org/httpcomponents-core-ga/httpcore/examples/org/apache/http/examples/ElementalHttpPost.java)将 XML 发布到服务器时，出现错误“ ”

```
 HttpParams params = new SyncBasicHttpParams();
    HttpProtocolParams.setVersion(params, HttpVersion.HTTP_1_1);
    HttpProtocolParams.setContentCharset(params, "UTF-8");
    HttpProtocolParams.setUserAgent(params, "Apache-HttpClient/4.0.1 (java 1.5)");
    HttpProtocolParams.setUseExpectContinue(params, true);

    HttpProcessor httpproc = new ImmutableHttpProcessor(new HttpRequestInterceptor[] {
            // Required protocol interceptors
            new RequestContent(),
            new RequestTargetHost(),
            // Recommended protocol interceptors
            new RequestConnControl(),
            new RequestUserAgent(),
            new RequestExpectContinue()});

    HttpRequestExecutor httpexecutor = new HttpRequestExecutor();

    HttpContext context = new BasicHttpContext(null);

    // Host to post
    HttpHost host = new HttpHost(hostUrl, hostPort);

    DefaultHttpClientConnection conn = new DefaultHttpClientConnection();

    context.setAttribute(ExecutionContext.HTTP_CONNECTION, conn);
    context.setAttribute(ExecutionContext.HTTP_TARGET_HOST, host);

        try {
            SocketAddress sockaddr = new InetSocketAddress(host.getHostName(), host.getPort());
            Socket socket = new Socket();
            socket.connect(sockaddr);
            conn.bind(socket, params);
            BasicHttpEntityEnclosingRequest request = new BasicHttpEntityEnclosingRequest("POST","");

            HttpEntity requestBody = new StringEntity(xmlToPost, "UTF-8");
            request.setEntity(requestBody);

          request.setParams(params);
          httpexecutor.preProcess(request, httpproc, context);

          // FAILS HERE WITH THE MESSAGE "org.apache.http.ProtocolException: Not a valid protocol version: <html>"
          HttpResponse response = httpexecutor.execute(request, conn, context);
          response.setParams(params);
          httpexecutor.postProcess(response, httpproc, context);

    } catch (Exception e) {            

    } 
```

我确定它不是服务器，因为当我在 Firefox 中使用“海报”插件时它可以正常工作。我正在尝试发布 xml，但不确定是否或如何将其添加到此代码中。

# c# - SQL插入导致空字段

> ID：14286094
> 
> 赞同：2
> 
> 时间：2013-01-11T20:25:41.203
> 
> 标签：c#, asp.net, sql

我正在尝试将文本框中的数据输入到 SQL 数据库中，当我这样做时，它只是插入空字段。

这是我的代码：

```
 sqlCommand = new SqlCommand("INSERT INTO Department (Description, Comments, Permissions, Active, Production) VALUES (@description, @comments, @permissions, @active, @production)", sqlConnection);

 sqlCommand.Parameters.Add("@description", SqlDbType.NVarChar, 50);
 sqlCommand.Parameters.Add("@comments", SqlDbType.NVarChar, 50);
 sqlCommand.Parameters.Add("@permissions", SqlDbType.NVarChar, 50);
 sqlCommand.Parameters.Add("@active", SqlDbType.Int);
 sqlCommand.Parameters.Add("@production", SqlDbType.Int);

 sqlCommand.Parameters.AddWithValue("@description", txtDescription.Text);
 sqlCommand.Parameters.AddWithValue("@comments", txtComments.Text);
 sqlCommand.Parameters.AddWithValue("@permissions", txtPermissions.Text);
 sqlCommand.Parameters.AddWithValue("@active", Convert.ToString(Convert.ToUInt32(chkActif.Checked)));
 sqlCommand.Parameters.AddWithValue("@production", Convert.ToString(Convert.ToUInt32(chkProduction.Checked)));
 sqlCommand.ExecuteNonQuery(); 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-11T20:26:57.313

您正在添加参数两次！将您的代码更改为。

```
sqlCommand = new SqlCommand("INSERT INTO Department (Description, Comments, Permissions, Active, Production) VALUES (@description, @comments, @permissions, @active, @production)", sqlConnection);

                sqlCommand.Parameters.AddWithValue("@description", txtDescription.Text);
                sqlCommand.Parameters.AddWithValue("@comments", txtComments.Text);
                sqlCommand.Parameters.AddWithValue("@permissions", txtPermissions.Text);
                sqlCommand.Parameters.AddWithValue("@active", Convert.ToString(Convert.ToUInt32(chkActif.Checked)));
                sqlCommand.Parameters.AddWithValue("@production", Convert.ToString(Convert.ToUInt32(chkProduction.Checked)));
                sqlCommand.ExecuteNonQuery(); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-11T21:43:02.000

尝试将一些静态值传递给您的查询。

第二件事尝试转换你的`textbox.Text` `toString()`. 确保您`runat="server"`在文本框标签中有并检查您没有在代码中的任何位置将值设置为“”。

# php - 带条件的递归选择

> ID：14286095
> 
> 赞同：0
> 
> 时间：2013-01-11T20:25:42.717
> 
> 标签：php, sql, database, postgresql

我的问题如下：

1.  我需要检查一个选择的值（**平均值**）是否为空
2.  如果是，请运行选择以查找不同时期（日期）中的第一个非空值。
3.  在此之后，执行一个操作来检查（日期 - 范围）是什么时间段，这是
4.  之后做平均

### 人类语言

我想得到**所有产品的平均成本**，*按期间分组*。

如果在特定期间，产品没有发票，我需要获取上一期间的平均值（如果有平均成本）。

期间**不是几个月**，它们由客户定义，可以重叠 2 个月，例如：

```
2012-01-01 - 2012-01-29
2012-01-30 - 2012-02-27 
```

我怎样才能**在一个查询中**做到这一点？
查询或多或少如下（`average`是我要比较值的列）：

```
select
    p.id
    ,(select 
        avg(cost)
    from 
        invoices i 
    where 
        i.product_id = p.id 
        and i.add_date between $start_date
        and $end_date
    ) as average
from
    products p; 
```

### 表/数据/查询

看到这个要点（它不是原始数据库，我现在做这个测试）： [https ://gist.github.com/4520123](https://gist.github.com/4520123)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-11T22:50:20.570

解决问题的另一种方法是：

1.  查找具有可用数据的最新月份。
2.  从第一步获取当月的 avg()。

查询：

```
SELECT i.product_id, 
       max(date_trunc('month',i.add_date)) as last_month
FROM invoices i 
GROUP BY i.product_id 
```

将为您提供上个月每个产品的可用数据。

然后：

```
SELECT p.id,
       avg(inv.cost)
FROM products p
JOIN invoices inv 
  ON inv.product_id = p.id
JOIN (SELECT i.product_id, 
             max(date_trunc('month',i.add_date)) as last_month
      FROM invoices i 
      GROUP BY i.product_id) last_inv 
  ON last_inv.product_id = inv.product_id
  AND last_inv.last_month = date_trunc('month',inv.add_date) 
```

得到`avg`上个月的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-11T20:34:10.673

我想我明白了。您想连续检查不同时期的平均值。以下是三个时期的示例：

```
select p.id,
       coalesce(cost_period1, cost_period2, cost_period3) as average
from products p left outer join
     (select i.product_id, 
             avg(case when i.add_date between $start_date1 and $end_date1 then cost
                 end) as cost_period1,
             avg(case when i.add_date between $start_date2 and $end_date2 then cost
                 end) as cost_period2,
             avg(case when i.add_date between $start_date3 and $end_date3 then cost
                 end) as cost_period3
      from invoices i
      group by i.product_id
     ) ip
     on p.id = ip.product_id 
```

这是一个未经测试的查询。它计算子查询中每个周期的平均值，然后选择第一个非 NULL 值。

根据您的评论，您只需将其转换为每个月的单独行。这里是一个典型的方式。. . 按年和月分组，然后选择最近可用的。

```
select p.id, avgcost
from products p left outer join
     (select ip.*, row_number() over (partition by product_id order by yearmon desc) as seqnum
      from (select i.product_id, year(add_date)*12+month(add_date) as yearmon,
                   avg(cost) as avgcost
            from invoices i
            group by i.product_id, year(add_date)*12+month(add_date)
           ) ip
      where seqnum = 1
     ) ip
     on p.id = ip.product_id 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-12T13:24:21.200

我在同事朋友的帮助下使用此查询解决了这个问题。

我所做的是，我拿了**最后一次购买（发票）**，具体产品（饮料）并计算平均值。

```
 select (sum(aux.price * aux.quantity) / sum(aux.quantity))
    from (select    inp.price, inp.quantity, prd.product, drk.drink_num, inv.add_date
                        from    invoices                                inv
            inner join invoice_products inp on inp.invoice = inv.invoice
            inner join products                 prd on prd.product = inp.product
            inner join drinks                       drk on drk.product = prd.product) aux,
    date_period dtp
    where 
            aux.add_date between dtp.starting_date and dtp.ending_date
            and aux.drink_num = 1836 -- example id
            and dtp.year <= 2012 -- current year search
    group by
            dtp.year,
            dtp.period
    order by 
            dtp.year desc,
            dtp.period desc
    limit 1 
```

无论如何，谢谢各位！

# php - 包含在包含的文件中不适用于相对路径

> ID：14286103
> 
> 赞同：1
> 
> 时间：2013-01-11T20:26:29.277
> 
> 标签：php, path, include

这个bug在过去的64分钟里耗尽了我的理性思考能力，我真的不知道我该怎么办。

当我在包含的文件中使用以下 3 行时：

```
var_dump(file_exists('G:/xampp/htdocs/myproject/public_html/includes/htmlPurifierAndMarkdown.php')); //retuurns true
var_dump(__FILE__);
include '../htmlPurifierAndMarkdown.php'; //gives error 
```

我得到以下输出：

```
boolean true

string 'G:\xampp\htdocs\myproject\public_html\includes\classes\genral.class.php' (length=71)

( ! ) Warning: include(../htmlPurifierAndMarkdown.php) [function.include]: failed to open stream: No such file or directory in G:\xampp\htdocs\myproject\public_html\includes\classes\genral.class.php on line 4
Call Stack
#   Time    Memory  Function    Location
1   0.0005  345328  {main}( )   ..\add.php:0
2   0.0036  382408  include( 'G:\xampp\htdocs\myproject\public_html\includes\classes\events.class.php' )    ..\add.php:28
3   0.0041  398024  include( 'G:\xampp\htdocs\myproject\public_html\includes\classes\standardpost.class.php' )  ..\events.class.php:2
4   0.0047  413928  include( 'G:\xampp\htdocs\myproject\public_html\includes\classes\genral.class.php' )    ..\standardpost.class.php:2 
```

简而言之：

1.  第一行告诉我该文件不是我想象的一部分，它确实存在。
2.  第二行告诉我调用脚本的位置，仔细检查路径后，您会注意到我试图包含的文件位于父目录中
3.  包含函数说文件不存在

所以我只是在想象一些东西还是这是一些严重的 php 错误？

## 更新

当我`genral.class.php`手动访问时，不会产生错误。从包含的文件中包含时是否适用特殊规则？

**更新 2**

当我将包含路径设置为 '../includes/htmlPurifierAndMarkdown.php' 时，这是相对于主调用脚本的路径，而主调用脚本又包含一个包含`genral.class.php`它的脚本，但由于这个新包含仅相对于一个在许多调用脚本中，它会为其他脚本分解。从包含的文件中包含文件时是否适用特殊规则？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-11T20:38:11.193

该`__FILE__`常量返回包含该行的文件的完整路径和文件名。**此文件可能位于当前工作目录以外的目录**中。在您的特定示例中，您可以使用它：

```
include dirname(dirname(__FILE__)) . DIRECTORY_SEPARATOR . 'htmlPurifierAndMarkdown.php'; 
```

* * *

可能发生的事情的一个例子如下：

1.  正在执行的文件是`/example.com/public_html/index.php`
2.  当前工作目录是`/example.com/public_html/`
3.  索引文件包括`/example.com/public_html/includes/classes/genral.class.php`
4.  上述文件试图包括`../htmlPurifierAndMarkdown.php`
5.  相对于当前工作目录而`..`不是相对于包含的文件进行翻译。因此，您最终会收到`/example.com/htmlPurifierAndMarkdown.php`一条令人讨厌的错误消息。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-11T21:11:50.163

`../`是一个相对路径——相对于当前工作目录。当前工作目录是外部脚本（浏览器请求的那个）所在的目录。在上面的示例中，PHP 将解析相对于`add.php`.

用于`dirname(__FILE__)`获取当前文件的绝对路径（无论是请求的还是包含的）。您可以使用它来计算使用相对路径的已知文件的绝对路径。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-11T20:43:15.340

尝试包含这样的文件：

```
include(realpath(dirname(__FILE__) . '/../') . 'htmlPurifierAndMarkdown.php'); 
```

以其他方式你有这些文件::

```
/index.php  
/includes/classes/genral.class.php  
/includes/htmlPurifierAndMarkdown.php 
```

**索引.php**：

```
include('/includes/classes/genral.class.php'); 
```

**genral.class.php**：

```
include('/includes/htmlPurifierAndMarkdown.php'); 
```

如果您从 index.php 开始，这将可以正常工作...

# php - 使用 PHP 访问 Google 日历 API

> ID：14286106
> 
> 赞同：0
> 
> 时间：2013-01-11T20:26:47.920
> 
> 标签：php, javascript, json

我对谷歌 API 有点困惑，尤其是谷歌日历 API。似乎我发现的每个示例都希望用户通过返回 URL 连接并返回。我想做的就是在后台使用 google calendars api 获取信息，显示数据，甚至创建数据。我愿意使用 Javascript/JSON 或最好通过 PHP 来做到这一点。

这是我找到的示例：

```
<?php
session_start();
require_once dirname(__FILE__).'/GoogleClientApi/Google_Client.php';
require_once dirname(__FILE__).'/GoogleClientApi/contrib/Google_AnalyticsService.php';

$scriptUri = "http://".$_SERVER["HTTP_HOST"].$_SERVER['PHP_SELF'];

$client = new Google_Client();
$client->setAccessType('online'); // default: offline
$client->setApplicationName('My Application name');
$client->setClientId('INSERT HERE');
$client->setClientSecret('INSERT HERE');
$client->setRedirectUri($scriptUri);
$client->setDeveloperKey('INSERT HERE'); // API key

// $service implements the client interface, has to be set before auth call
$service = new Google_AnalyticsService($client);

if (isset($_GET['logout'])) { // logout: destroy token
    unset($_SESSION['token']);
    die('Logged out.');
}

if (isset($_GET['code'])) { // we received the positive auth callback, get the token and store it in session
    $client->authenticate();
    $_SESSION['token'] = $client->getAccessToken();
}

if (isset($_SESSION['token'])) { // extract token from session and configure client
    $token = $_SESSION['token'];
    $client->setAccessToken($token);
}

if (!$client->getAccessToken()) { // auth call to google
    $authUrl = $client->createAuthUrl();
    header("Location: ".$authUrl);
    die;
}
echo 'Hello, world.'; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-12T14:13:24.360

我想通了。如果有人对您使用的任何 google API 的工作原理感到好奇，您首先需要允许通过浏览器进行访问，除非您已经拥有访问令牌。在此之后，您可以从他们的库中提取您需要的任何信息。

# css - Chrome CSS 绝对位置故障

> ID：14286107
> 
> 赞同：0
> 
> 时间：2013-01-11T20:26:50.260
> 
> 标签：css, google-chrome, html-table, position, absolute

我想制作一个由 php 生成的画廊，其中每个图像都是灰度的，并且只有当鼠标经过它时才会变成彩色。由于各种原因，我不想使用 CSS 图像背景，所以我使用了绝对定位图像。当光标悬停在表格的 td 元素上时，绝对定位的图像会弹出灰色图像。由于没有定义坐标长度或宽度，因此 rgb 图像应位于灰色图像的正上方。在 Firefox 中，这正是发生的情况，但在 Chrome 中，每行中的第一张和第二张图像都向左移动。最后第三张图片效果很好。

```
#main #album {
    width:100%; /* 600px */
}
#main #album  td{
    padding-bottom:20px;
    text-align:center;
}
#main #album  td img:first-child{   
    position:absolute;
    display:none;
}
#main #album  td:hover img:first-child{
    display:inline;
}
<table id="album">
<tr>
<td><img src="/img/mini/dezsma01.jpg" /><img src="/img/mini/gray/dezsma01.jpg" /><br />A
<td><img src="/img/mini/dezsma01.jpg" /><img src="/img/mini/gray/dezsma01.jpg" /><br />B
<td><img src="/img/mini/dezsma01.jpg" /><img src="/img/mini/gray/dezsma01.jpg" /><br />C
</table> 
```

**更新**

diggersworld 建议的 CSS 重置解决了这个问题，但我也尝试过使用列表，这也很有效。这是代码：

```
#main #albumlist {
    width:100%; 
    list-style-type:none;
}
#main #albumlist a {
    float:left;
    display:block;
    width:180px;
    height:auto;
    padding-left:20px;  
    padding-bottom:20px;
    text-align:center;
}
#main #albumlist li a:first-child{
    padding-left:0;
}
#main #albumlist a img:first-child {
    position:absolute;
    display:none;
}
#main #albumlist a:hover img:first-child {  
    display:inline;
}

<ul id="albumlist"><li>
        <a href="/img/big/dezsma01.jpg"><img src="/img/mini/dezsma01.jpg" /><img src="/img/mini/gray/dezsma01.jpg" /><br />A</a>
        <a href="/img/big/dezsma01.jpg"><img src="/img/mini/dezsma01.jpg" /><img src="/img/mini/gray/dezsma01.jpg" /><br />B</a>
        <a href="/img/big/dezsma01.jpg"><img src="/img/mini/dezsma01.jpg" /><img src="/img/mini/gray/dezsma01.jpg" /><br />C</a>
</li></ul> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-11T21:37:35.140

行为上的差异可能归结为许多事情。通常主要问题是浏览器默认样式之间的差异，因为它们都有一组已定义的预设。使用重置样式表可以轻松覆盖这些预设。这基本上将所有 CSS 属性重置为一个基本起点，并为所有浏览器提供了一个级别基础。

[http://meyerweb.com/eric/tools/css/reset/](http://meyerweb.com/eric/tools/css/reset/)

我在评论中提到使用表格不是理想的解决方案。表格在 90 年代通常用于布局。然而，从那时起，CSS 变得更加有用，并且允许开发人员用更少的 HTML 实现更多功能。

您绝对应该掌握使用列表的艺术。它们往往是我在开发网站时使用最多的元素之一。当你从语义上分解它们时，你会惊讶于实际上有多少东西是列表。它们也比表格灵活得多，如果您深入研究响应式网页设计，您将看到巨大的好处。

# .net - 为什么我在将列表分配给 Expandoobject 时不能使用 linq 或扩展

> ID：14286111
> 
> 赞同：1
> 
> 时间：2013-01-11T20:27:10.327
> 
> 标签：.net

我可以找到一个项目是否存在于正常列表中，如下所示：

```
Dim x as new list(of string)
dim result = x.any(function (y) y.length > 4) 
```

根据是否有超过 4 个字符的项目返回 true 或 false。

但是，如果我这样做：

```
dim e as object = new expandoobject
dim x as new list(of string)
e.items = x

dim result = e.items.any(function (y) y.length > 4) 
```

产生一条错误消息，说明 any 不是 List 的扩展方法。

谁能告诉我为什么会发生这种情况以及我是否可以将列表分配给 expandoobject 然后使用扩展方法。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-11T20:51:25.143

因为扩展方法只是语法糖。实际上，当你说

> 暗淡的结果 = items.any(Function(y) y.length > 4)

您实际上是在`System.Linq.Enumerable`类上调用静态方法，如下所示：

> 暗淡结果 = Enumerable.Any(e.items, Function(y) y.length > 4)

这是由编译器自动为您翻译的。不幸的是，因为您使用的是动态对象，编译器无法推断您正在尝试调用扩展方法，因为它不知道`length`属性的类型。因此，它被解释`Any()`为一个实例方法，这会导致它在运行时失败，因为这种方法实际上并不存在。

即使您将其更改为使用上面的显式语法，它也不会正确编译，因为它仍然不知道 e.items 的类型。因此，您需要对其进行投射。

`Dim result = Enumerable.Any((CType(e.items, List(Of String))), Function(y) y.Length > 4)`

更好的主意是尽可能避免使用 ExandoObject。Linq 旨在对静态类型的对象执行查询。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-11T20:53:18.377

你可以这样做，但你必须转换`e.items`为正确的类型：

```
dim result = DirectCast(e.items, List(of String)).any(function (y) y.length > 4) 
```

# javascript - onMouseOut 事件发生在错误的元素中？

> ID：14286115
> 
> 赞同：1
> 
> 时间：2013-01-11T20:27:22.553
> 
> 标签：javascript, javascript-events

在我们所有的页面上，顶部都会显示一条重要消息。页面加载时，消息看起来像浅灰色背景（与页面其余部分相同）的纯红色文本。如果用户想要更新它，他们可以点击它并调用editMsg函数，这使它看起来像一个常规的文本输入，并且右侧会出现一个“保存”按钮。

如果用户将鼠标移到封闭的 div 之外，我的任务是取消更新，方法是将所有内容恢复为原始外观。我试过 onBlur 但我似乎无法让它做任何事情！

看起来很简单，但是如果我将鼠标移到文本输入之外但仍在 div 中，它会调用 cancelMsgChg 函数。我尝试了 cancelBubble (IE) 和 stopPropagation (FF) 的几种变体，但没有成功。事实上，如果它们在不同的元素中，我不明白为什么我需要这些。

我整个早上都在追赶我的尾巴，在这里阅读了一些帖子，但每小时都迷失了方向！

HTML 是：

```
<div id="update_message" onMouseOut="cancelMsgChg('onMouseOut');" >
<br />

    <input id="message" onclick="editMsg();" 
     type="text" value="My message"
     style="background:#DDDDDD; color:#DD0000; font-weight:bold; border:0;" />

    <button id="save_message" style="display:none;" 
     class="btn" onclick="return saveHeaderMsg('Save Header Message',  
     document.getElementById('message').value);">Save Message</button>

<br /><br />
</div> 
```

更新：

我从 div 标签中删除了 onMouseOut 事件，并添加了一个事件侦听器，用于在 div 外部单击鼠标时：

```
if (document.addEventListener) {
  document.addEventListener("click", cancelMsgChg('click'), false);
} else if (document.attachEvent) {
  // IE
  document.attachEvent("onclick", cancelMsgChg('onclick'), false); 
}

function cancelMsgChg(e) {

  console.log ("in cancelMsgChg");

  // In Internet Explorer you should use the global variable `event`  
  e = e || event; 

  // In Internet Explorer you need `srcElement`
  var target = e.target || e.srcElement;

  var id = target.id;

  console.log ("id = " + id);

  if ( id != "update_message" ) {
    //reset everything
  }
} 
```

但我收到“目标未定义”错误。所以......'e'根本没有定义？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-11T20:42:33.070

由于您没有使用任何表单元素（输入、选择、文本区域），因此模糊对您没有任何帮助。

即使鼠标移动到 div 内的元素之一，也会触发 mouseOut 事件。您可以在触发 mouseOut 事件时检查鼠标的方向，以查看它是否正在进入这些封闭的 div 之一。有关更多信息，请参见[http://www.quirksmode.org/js/events_mouse.html](http://www.quirksmode.org/js/events_mouse.html)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-11T21:07:22.180

你的问题是双重的。一个是鼠标悬停在内部元素上会触发父级的鼠标移出，第二个是离开内部元素会触发该元素上的鼠标移出，该元素会冒泡到父级。

为了解决这个问题，您需要检查事件的目标并查看鼠标的去向，并且仅在 mouseout 来自父元素并且指向父元素之外的内容时才运行您的代码。这是一个简单的[小提琴来演示](http://jsfiddle.net/HcFtm/1/)：

```
<div class="outer" onmouseout="mouseout(event)">
    <div class="inner"></div>
</div>

function mouseout(event) {
  console.log(event.target);
  console.log(event.relatedTarget);
  console.log("mouseout!");
} 
```

在小提琴中，我有一个带有内联定义的 onmouseout 处理程序的外部 div。如果您观察控制台，您会看到如果您将鼠标移入外部 div 然后退出，则将触发 mouseout 事件。但是，如果您将鼠标移到外层 div 中，然后再移到内层 div 中，您也会得到一个 mouseout 事件。最后，如果您移出内部 div（但仍然在外部 div 中），您将获得另一个 mouseout 事件！

# ruby-on-rails - 多张图片上传到 rails - 更新多个模型

> ID：14286121
> 
> 赞同：0
> 
> 时间：2013-01-11T20:27:58.203
> 
> 标签：ruby-on-rails, carrierwave, jquery-file-upload

我正在尝试使用“jquery-fileupload-rails”和“carrierwave”gem 在我的 Rails 应用程序中实现多个文件上传功能。

该应用程序基本上具有具有多个步骤的项目，并且每个步骤可以有多个图像。

我正在尝试以更新特定步骤的形式上传图像。当我尝试上传图片时，似乎什么都没有发生。如果您能帮助阐明一些问题，我将永远感激不尽！提前致谢。

**路线.rb：**

```
Build::Application.routes.draw do

  ActiveAdmin.routes(self)

  devise_for :admin_users, ActiveAdmin::Devise.config

  resources :projects do
    resources :steps
    match "steps/:id" => "steps#number", :as => :number
  end

  resources :images

  root :to => 'projects#index'

end 
```

**步骤.rb：**

```
class Step < ActiveRecord::Base
    extend FriendlyId
    friendly_id :number

    attr_accessible :description, :name, :number, :project_id, :images_attributes
    belongs_to :project
    has_many :images
    accepts_nested_attributes_for :images, :allow_destroy => :true

end 
```

**图像.rb：**

```
class Image < ActiveRecord::Base
  attr_accessible :project_id, :step_id, :file, :caption, :crop_x, :crop_y, :crop_w, :crop_h
  attr_accessor :crop_x, :crop_y, :crop_w, :crop_h

  belongs_to :step
  belongs_to :project

  mount_uploader :file, FileUploader

end 
```

**文件上传器.rb：**

```
class FileUploader < CarrierWave::Uploader::Base

  # Choose what kind of storage to use for this uploader:
  storage :file

  # Override the directory where uploaded files will be stored.
  # This is a sensible default for uploaders that are meant to be mounted:
  def store_dir
     "/assets/"
     # "#{model.class.to_s.underscore}/#{mounted_as}/#{model.id}"
  end

  # Add a white list of extensions which are allowed to be uploaded.
  # For images you might use something like this:
  def extension_white_list
    %w(jpg jpeg gif png)
  end

  version :thumb do
    process resize_to_fill: [420,315]
  end

end 
```

**意见/步骤/edit.html.erb：**

```
<div class="row span12">
  <div class="row">

<%= render 'step_form' %>

</div>
</div> 
```

**views/steps/_step_form.html.erb（这通过部分处理更新图像模型，如下所示）：**

```
<%= semantic_form_for [@project, @step], :html => {:multipart => true} do |f| %>
<%= f.inputs do%>

....
      <div class = "imageGalleryButtons">

          <span class="btn btn-mini fileinput-button">
            <i class = "icon-plus"></i>
            Add Photo
            <%= render :partial => 'images/upload_form', :locals => {:form => f} %>
          </span>
          <%= link_to 'Reorder Photos', '#', :class=> "btn btn-mini" %>
          <!--<button class="btn btn-large">Reorder Photos</button>-->
    </div>

  <div class = "clear"></div> 

</div>

<% end %>
<% end %> 
```

**视图/图像/_upload_form.html.erb**

```
<%= form.fields_for :images, :html => {:multipart => true} do |image_form| %>   
   <%= image_form.file_field :file, :multiple=>true%>
<% end %> 
```

**应用程序.js：**

```
// This is a manifest file that'll be compiled into application.js, which will include all the files
// listed below.
//
// Any JavaScript/Coffee file within this directory, lib/assets/javascripts, vendor/assets/javascripts,
// or vendor/assets/javascripts of plugins, if any, can be referenced here using a relative path.
//
// It's not advisable to add code directly here, but if you do, it'll appear at the bottom of the
// the compiled file.
//
// WARNING: THE FIRST BLANK LINE MARKS THE END OF WHAT'S TO BE PROCESSED, ANY BLANK LINE SHOULD
// GO AFTER THE REQUIRES BELOW.
//
//= require jquery
//= require jquery_ujs
//= require jquery-fileupload/basic
//= require twitter/bootstrap
//= require_tree 
//= require js-routes 
```

# ruby-on-rails - Rails - 用户登录到应用程序呈现不同的布局，但当登出栏显示错误时

> ID：14286124
> 
> 赞同：0
> 
> 时间：2013-01-11T20:28:04.240
> 
> 标签：ruby-on-rails, login

当用户登录我的应用程序时，我会呈现不同的布局，例如在我使用登录之前`application.html.erb`和用户登录时，我将布局更改为`layout2.html.erb`in the `UsersController`I call `layout 'layout2'`，此布局有许多其他脚本和样式表，但是当用户注销，应用程序显示错误消息：

```
Routing Error 

No route matches [GET] "/signout" 
```

但是...我检查并`/signout`存在一条路线，当我不更改布局时，这表现正常，用户登录和注销正常。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-11T20:34:27.487

问题可能在于呈现指向您的 sign_out 路径的链接，似乎此链接在您的布局中是正确的，`application.html.erb`但在`layout2.html.erb`您错误地呈现链接时。

我的猜测是您的 sign_out 操作在使用 get 方法渲染它时使用了`destroy`or`post`方法，因此它会给您错误。

# c# - Farseer Physics 对象并没有完全接触

> ID：14286125
> 
> 赞同：3
> 
> 时间：2013-01-11T20:28:05.983
> 
> 标签：c#, winforms, xna, farseer

我刚刚开始使用*Farseer Physics*，并且创建了一个快速/粗略的基础对象，可以用来轻松创建对象。

所以我设置了一个快速模拟，它看起来像这样：![盒子不碰撞的更远的例子](../Images/20c7530a9e968a96f412abaf890f8058.png)

在 DebugView 中，它看起来像这样：![Farseer 调试模式下的盒子示例](../Images/ba5e65f71a8ed4d053bbe1bb1b985877.png)

经过仔细检查，在启用这两种模式的情况下，我可以看到橙色框缺少一行和一列像素：![纹理上缺少像素](../Images/b68eebce182de2cd586d9b2a40a4c958.png)

有谁知道为什么会这样？

```
class BasePhys
{
    public float unitToPixel;
    public float pixelToUnit;
    public Vector2 size;
    public Body body;
    public Texture2D texture;

    public BasePhys(World world, int x, int y)
    {
        this.unitToPixel = 100.0f;
        this.pixelToUnit = 1 / unitToPixel;
        TextureManager.GetTextureByName("base", ref this.texture);
        this.size = new Vector2(this.texture.Width, this.texture.Height);
        this.body = BodyFactory.CreateRectangle(world, this.size.X * this.pixelToUnit, this.size.Y * this.pixelToUnit, 1);
        this.body.BodyType = BodyType.Dynamic;
        this.body.Position = new Vector2(x * this.pixelToUnit, y * this.pixelToUnit);
    }
    public void Draw(SpriteBatch spriteBatch)
    {
        Vector2 scale = new Vector2(this.size.X / (float)this.texture.Width, this.size.Y / (float)this.texture.Height);
        Vector2 position = this.body.Position * unitToPixel;
        spriteBatch.Draw(this.texture, position, null, Color.White, this.body.Rotation, new Vector2(this.texture.Width / 2.0f, this.texture.Height / 2.0f), scale, SpriteEffects.None, 0);
    }
} 
```

有谁知道为什么会这样？在所有的 Farseer 演示中都没有这样做。我检查了纹理，它没有不可见`pixels`的橙色`pixels`填充整个文件。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-12T12:28:38.987

**Farseer 中的多边形周围有一层薄薄的“皮肤”。它们不会精确地相互接触 - 但会被这种皮肤抵消。这是设计使然。**

有关详细信息，请参阅`Settings.PolygonRadius`。它基本上是为了帮助改进碰撞检测。

默认情况下，多边形半径是`0.01`物理单位。您会注意到，在您的 比例下`1 unit = 100 pixels`，多边形半径正好等于一个像素 - 因此您的对象之间存在一个像素间隙。

可能最简单的解决方法是使您的矩形尺寸在每个方向上缩小两倍的多边形半径。或者，您可以将纹理稍微放大以考虑半径。

（不要关闭半径本身 - 你会得到物理故障。）

* * *

不要忘记 Farseer 可以处理大小和重量从 0.1 到 10 个单位的物体。传统上，您会使用米和公斤来表示这些秤（尽管您不必这样做）。

就我个人而言，我发现像素到单位的转换有点难看，因为您最终会得到分散在整个项目中的容易出错的缩放代码。对于一些实质性的东西，我建议在物理空间中编码所有内容，然后使用相机矩阵（您可以传递给`SpriteBatch.Begin`）在渲染时缩放所有内容。

# php - 在带有喜欢和评论的新闻提要中使用 php 进行多次长轮询

> ID：14286127
> 
> 赞同：1
> 
> 时间：2013-01-11T20:28:08.637
> 
> 标签：php, long-polling

我正在开发一个网站，其中有使用长轮询 php 方法实时显示的新闻项目。每条新闻都有点赞和评论按钮，点赞数显示在它们下方。因此，我设法应用了长轮询技术，并且新闻正在实时生成，并具有喜欢的数量。问题是，我也希望实时增加喜欢的次数。我正在考虑使用多个长轮询，但我猜它使用了太多服务器资源。做这个的最好方式是什么？？

# php - Smarty 模板组织

> ID：14286129
> 
> 赞同：1
> 
> 时间：2013-01-11T20:28:31.400
> 
> 标签：php, smarty

我已经设置了 Smarty，我的基本结构是这样的：

www.domain.com/html -- 这是所有 .php 文件所在的位置。www.domain.com/smarty/templates -- 这是所有 .tpl 文件所在的位置。

现在，一切都适用于 Web 根目录 (html) 中的文件，但我不确定当我将 .php 文件放在根目录下的单独文件夹中时该怎么做，例如 www.domain.com/html/folder/。我想这样做是为了在该新文件夹下组织一堆相关页面。我仍然将所有 .tpl 文件放在 www.domain.com/smarty/templates 文件夹下。当我尝试在该新文件夹下显示页面时，例如 ww.domain.com/html/folder/，页面的资源（CSS、图像等）丢失，即未获取。为这种情况组织文件的正确方法是什么？

谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-11T22:00:39.733

确保您的 template_dir、compile_dir、cache_dir 和 config_dir 的配置使用完整的绝对路径（例如 /home/httpd/vhosts/[yourdomain.com].... 或带有尾随 / 的任何内容）。

确保使用根目录中的绝对路径引用您的 CSS/图像。因此，如果您的 css 位于 [ROOT]/css 文件夹中，您的 HTML 将像这样调用 CSS：`<link rel="stylesheet" href="/css/main.css" type="text/css">`

模板在哪里以及您的 PHP 文件在哪里都没有关系。当它们被加载到 PHP 中时，模板就是这样，一个模板，所有的路径都是从 PHP 文件的角度发生的。

# javascript - 在 Javascript 中访问 app.config 值

> ID：14286130
> 
> 赞同：0
> 
> 时间：2013-01-11T20:28:37.437
> 
> 标签：javascript, app-config

我需要用 app.config 中的值填充变量。有没有办法在 Javascript 中做到这一点？这就是我现在所拥有的，但是我不相信它在任何方面都是正确的..

```
var notConfident = ConfigurationManager.AppSettings["GoogleValue"]; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-11T20:34:39.597

不，javascript 在客户端浏览器中运行，应用程序配置是服务器中的文件。

您可以通过将其发送到客户端来获取该值，例如：

.aspx 文件：

```
<input type="hidden" id="ikey" runat="server" /> 
```

.cs文件，页面加载方式：

```
ikey.InnerText = ConfigurationManager.AppSettings["GoogleValue"]; 
```

.js 文件，onload 方法：

```
var something = document.getElementById("ikey").value; 
```

# c# - 带有嵌套模型类的 Razor 视图

> ID：14286132
> 
> 赞同：6
> 
> 时间：2013-01-11T20:28:39.377
> 
> 标签：c#, asp.net-mvc, razor

我有一个嵌套类，例如：

```
public class Jar
{
    public IEnumerable<NailClippings> Nails { set; get; }
    public IEnumerable<People> Donors { set; get; }
} 
```

我的控制器将单个传递`Jar`给我的视图，字符串类型为

```
@model Test.ViewModels.Jar 
```

`Nails`我可以通过类似这样的东西`Donors`轻松地遍历内容

```
@foreach(var item in Model.Nails) 
```

我的问题是使用 HTML 助手为我生成显示名称

```
@Html.DisplayNameFor(model => model.Nails.Length) 
```

我想出了一个解决方案，将内部嵌套类的类型更改为，在查询末尾`List`追加并将行更改为`.ToList()`

```
@Html.DisplayNameFor(model => model.Nails[0].Length) 
```

被迫使用`List`并有一个索引`[0]`来显示一个名字对我来说是愚蠢的。是否有引用内部嵌套类属性的替代方法？

**编辑**：查看

```
<table>
    <tr>
        <th>@Html.DisplayNameFor(model => model.Nails[0].Length)</th>
        .
        .
    </tr>
    @foreach(var item in Model.Nails){
    <tr>
        <td>@Html.DisplayFor(modelItem => item.Length</td>
        .
        .
    </tr>
    }
</table> 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-01-11T21:50:04.777

您不需要在视图中编写任何循环。这让他们如此丑陋。

只需为集合类型定义相应的显示模板。因此，例如，您将创建`~/Views/Shared/DisplayTemplates/NailClippings.cshtml`部分视图，该视图将被强类型化为集合的单个元素：

```
@model NailClippings
<tr>
    <td>
        @Html.DisplayFor(x => x.Length)
    </td>
    .
    .
</tr> 
```

现在在您的主视图中，它很简单：

```
@model Jar
<table>
    <thead>
        <tr>
            <th>Length</th>
            .
            .
        </tr>
    </thead>
    <tbody>
        @Html.DisplayFor(x => x.Nails)
    </tbody>
</table> 
```

显示/编辑器模板按惯例工作。因此，当您在主视图中使用`@Html.DisplayFor(x => x.Nails)`时，ASP.NET MVC 将分析`Nails`属性的类型并看到它是一个`IEnumerable<NailClippings>`集合。所以它会先在里面开始寻找对应的显示模板`~/Views/CurrentController/DisplayTemplates/NailClippings.cshtml`，然后在里面`~/Views/Shared/DisplayTemplates/NailClippings.cshtml`，最后回退到[`default display template`](http://bradwilson.typepad.com/blog/2009/10/aspnet-mvc-2-templates-part-3-default-templates.html). 选择模板后，ASP.NET MVC 将自动为您执行该模板，用于集合属性的每个元素，这样您就不必担心在视图中编写一些循环、担心索引、...

这也适用于编辑器模板：`@Html.EditorFor(x => x.Nails)`将查找`~/Views/Shared/EditorTemplates/NailClippings.cshtml`. 您在这里获得的好处是生成的输入字段将具有正确的名称，并且当您提交表单时，默认模型绑定器将自动重新水化 HttpPost 操作作为请求参数的视图模型。

基本上，如果您尊重框架遵循的约定，您的生活就会变得更加轻松。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-01-11T20:45:27.700

代替

```
model.Nails[0].Length 
```

你可以使用

```
model.Nails.First().Length 
```

无需转换为`List`.

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-01-11T20:31:11.677

我认为你可以只使用`item`循环变量

```
@Html.DisplayNameFor(model => item.Length) 
```

为您更新另一个选项是为 Nails 显示创建部分视图。它将被强类型化，`IEnumerable<NailClippings>`并且所有属性都将可用：

```
@Html.Partial("_Nails", Model.Nails) 
```

指甲局部视图：

```
@model IEnumerable<NailClippings>

<table>
    <tr>
        <th>@Html.DisplayNameFor(model => model.Length)</th>
        .
        .
    </tr>
    @foreach(var item in Model){
    <tr>
        <td>@Html.DisplayFor(modelItem => item.Length)</td>
        .
        .
    </tr>
    }
</table> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-11T21:38:10.317

我认为这个示例代码对嵌套模型类很有用

```
@model ViewModels.MyViewModels.Theme

@Html.LabelFor(Model.Theme.name)
@foreach (var category in Model.Theme)
{
   @Html.LabelFor(category.name)
   @foreach(var product in theme.Products)
   {
      @Html.LabelFor(product.name)
      @foreach(var order in product.Orders)
      {
          @Html.TextBoxFor(order.Quantity)
          @Html.TextAreaFor(order.Note)
          @Html.EditorFor(order.DateRequestedDeliveryFor)
      }
   }
} 
```

# api - Magento API SOAP v1 和 VB.NET

> ID：14286133
> 
> 赞同：0
> 
> 时间：2013-01-11T20:28:41.487
> 
> 标签：api, magento, soap

我正在使用 VB.NET 通过 API SOAP v1 与 Magento 进行通信。在接到一个需要关联数组的电话之前，我让它工作得很好。我尝试过字典、哈希表、自定义类型等。我确实读过哈希表，但字典不可序列化。所以我尝试了自定义类型/对象/类。以下是我收到的错误：

```
The type XXXX was not expected. Use the Xmlinclude or SoapInclude attribute to specify types that are not known statically. 
```

所以我已经阅读了很多关于上述错误的帖子，但我什么也做不了。该错误似乎至少表明如果我做对了，我正在尝试的事情是可能的，但也许情况并非如此。我对 SOAP 了解不多，但我可以看到这永远不会起作用，因为 Web 服务可能不知道如何处理该对象。

所以我的问题是是否可以将自定义对象发送到 Magento API。或者更广泛地说，是否有可能让 SOAP v1 与 VB.NET 一起工作。我知道 v2 是一种选择，但我对 v1 非常熟悉，并且已经在 VB.NET 中使用它，而不是这种情况。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-11T21:33:56.653

回答一个您没有提出的问题——但是您是否考虑过为 V1 API 使用 XML-RPC 适配器？它公开了与 SOAP API 相同的确切方法，但由于 XML-RPC 没有 SOAP 所具有的强大类型概念，因此您可能能够通过 from 获取通用对象`.NET`（如果不熟悉`.NET`SOAP 或 XML -RPC 库）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-15T22:59:13.500

这需要大量的挖掘，但我已经完成了所有工作。首先，我使用了 PHP SoapClient，并注意到它是如何在soap 请求中形成关联数组的。您可以跟踪请求和响应，非常方便。从那里我使用 WebRequest 对象在 VB.NET 中编写了我自己的肥皂客户端。在这样做时，我可以完全控制发送到 API 的 xml。

再次，我走这条路的原因是最终 V2 不适合我。由于某种原因，并非所有参数都进入 API。这和我对 V1 也很满意的事实。我已经编写了几个自定义 API。

我为简短而道歉，但其中有很多内容。可能我的大部分时间都在遇到多个死胡同。如果有人想要详细信息，请随时给我发电子邮件。

**编辑：**

这是我用来查看如何格式化请求的 php 代码：

```
$client = new SoapClient('http://www.site.com/index.php/api/soap/?wsdl',array('trace' => TRUE));
$session = $client->login('user','api-key');

echo $client->__getLastRequest() ."\n\n";
echo $client->__getLastRequestHeaders() ."\n\n";
echo $client->__getLastResponse() ."\n\n";
echo $client->__getLastResponseHeaders() ."\n\n";

$result = $client->call($session, 'cataloginventory_stock_item.list','393');

echo $client->__getLastRequest() ."\n\n";
echo $client->__getLastRequestHeaders() ."\n\n";

var_dump($result);
$client->endSession($session); 
```

下面是如何使用 VB.NET 发送请求。您将需要使用上面的 php 作为指导来构建 XML/SOAP 主体。我为每个 API 调用创建了一个类，它输出所需的 XML。您将需要 System.Net、System.Xml 和 System.IO。我使用 getSoapHeader() 是因为请求中有一些常见的 XML。有关详细信息，请参阅下一个代码部分：

```
 Private Function makeSoapRequest(ByVal soapBody As String) As String

    Dim req As WebRequest = WebRequest.Create(_soap_url)
    Dim xml As String

    xml = getSoapHeader() & soapBody

    Dim buffer() As Byte = System.Text.Encoding.UTF8.GetBytes(xml)
    req.ContentType = "text/xml; charset=utf-8"
    req.Method = "POST"

    req.Headers.Add("SOAPAction", "urn:Mage_Api_Model_Server_HandlerAction")
    req.ContentLength = buffer.Length

    Dim st As System.IO.Stream = req.GetRequestStream

    st.Write(buffer, 0, buffer.Length)
    st.Close()

    Dim response As WebResponse

    Try
        response = req.GetResponse
    Catch ex As WebException
        response = ex.Response
    End Try

    st = response.GetResponseStream()

    Dim reader As New StreamReader(st)

    Dim responseFromServer As String = reader.ReadToEnd()

    makeSoapRequest = responseFromServer

    response.Close()
    st.Close()

End Function 
```

下面是 getSoapHeader() 函数。如前所述，仅当您使用 type="ns2:Map" 时才需要 ns2 部分，这是关联数组所需要的：

```
 Private Function getSoapHeader() As String
    'ns2 is not always needed
    getSoapHeader = "<?xml version=""1.0"" encoding=""UTF-8""?><SOAP-ENV:Envelope xmlns:SOAP-ENV=""http://schemas.xmlsoap.org/soap/envelope/"" xmlns:ns1=""urn:Magento"" xmlns:xsd=""http://www.w3.org/2001/XMLSchema"" xmlns:xsi=""http://www.w3.org/2001/XMLSchema-instance"" xmlns:SOAP-ENC=""http://schemas.xmlsoap.org/soap/encoding/"" xmlns:ns2=""http://xml.apache.org/xml-soap"" SOAP-ENV:encodingStyle=""http://schemas.xmlsoap.org/soap/encoding/""> " & vbCrLf

End Function 
```

# c++ - 未声明的复制构造函数会自动内联吗？

> ID：14286135
> 
> 赞同：4
> 
> 时间：2013-01-11T20:28:47.513
> 
> 标签：c++, inline, copy-constructor, c++03, default-copy-constructor

未声明的（自动生成的）复制构造函数是否自动标记为`inline`？

如果是这样，并且如果我不希望它们被标记为`inline`，这是否意味着我必须手动定义一个并手动复制我需要的每个成员（假设我没有使用 C++11，所以没有`= default`从中获利）？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-01-11T20:32:28.130

它们被视为已声明`inline`（这并不一定意味着它们将被内联）。是的，在 C++11 之前，防止它们被内联的唯一方法是手动声明和定义它们，在初始化列表中显式复制每个成员和每个基类。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-01-11T20:31:17.043

是的。从 C++11、12.8/11 开始：

> 隐式声明的复制/移动构造函数是`inline public`其类的成员。

如果您想更熟悉复制和移动构造函数，我强烈建议您阅读 12.8 的全部内容。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-11T20:30:44.070

他们是，我相信。但是，对于这样一个编译器定义的函数，和 not 之间的区别`inline`是不可观察的。是的，你必须定义你自己的，它是非的`inline`，尽管你为什么想要这样的东西超出了我的范围。它对语义没有影响，也不会影响编译器的内联。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-01-11T20:32:09.300

隐式定义的特殊成员函数是`inline`并且它们必须是，因为它们可以在多个翻译单元中隐式生成。的意思`inline`是它可以在多个翻译单元中定义而不违反ODR，而不是代码实际上会被内联（这取决于类型和编译器）。

为什么不希望复制构造函数成为`inline`？

# iis - WebSphere 出站 FTP 适配器在 IIS 上不起作用

> ID：14286137
> 
> 赞同：1
> 
> 时间：2013-01-11T20:29:19.030
> 
> 标签：iis, ftp, websphere, adapter, subdirectory

从标题可以清楚地看出，我们正在使用 FTP 适配器在 WebSphere ESB 7.5 上开发一些应用程序。当我们尝试在 ftp 目录上创建新文件时，我们收到以下错误

> J2CMethodBindingImpl.invoke() javax.resource.spi.InvalidPropertyException 中抛出 ResourceException: Adapter failed to check permission on the specified directory.要么 DirectoryPath 没有出站操作所需的权限，要么 FTP 服务器提供的长列表与标准格式。

通过使用相同的用户名/密码对，我可以在这些文件夹下查看/编辑/删除和创建文件。奇怪的是，当我将配置更新为：

> 主机：10.10.0.78，目录：

没有问题。但是当我这样做时

> 主机：10.10.0.78，目录：/test

我得到了例外。有什么建议吗？

细节：

> FTP 服务器是 Windows / IIS 7
> WebSphere Application Server 7.0
> ESB 7.5.1.1
> FTP 适配器 7.5.1
> Integration Designer 7.5

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-30T10:07:06.033

我解决了我的问题：

• 编写一个扩展org.apache.commons.net.ftp.parser.NTFTPEntryParser 的新customParserClass。
• 将此添加到 FTP 适配器的构建路径。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-13T18:03:31.167

在我将列表类型从 MS-DOS 更改为 IIS 的 UNIX 之后，它起作用了。但是技术文档说通过将自定义解析器类名称更改为“com.ibm.j2ca.ftp.util.FTPLongListEntryParser”是另一种解决方案。我试过那个，但仍然没有进展。

我有一些 classNotFoundException 但我仍在工作，我让你知道更新......

# solr - 使用太阳黑子检索所有文档给出布尔范围

> ID：14286141
> 
> 赞同：0
> 
> 时间：2013-01-11T20:29:42.103
> 
> 标签：solr, scope, boolean, sunspot

这应该很简单，但我无法让它工作。

我想检索所有已发布的产品。

以下代码正在运行，并且仅返回已发布的产品：

```
@products = Product.search do
  with(:published, true)
  with(:facet_tag).all_of(facets) unless facets.nil?
  fulltext q do
  end
  facet :facet_tag
  paginate :page => 1, :per_page => 8
end 
```

当我删除全文部分时，它根本不会返回任何结果。

我希望以下代码返回所有已发布的产品，但该代码根本不返回任何结果。@products.results 变为 nil。

```
@products = Product.search do
  with(:published, true)
  with(:facet_tag).all_of(facets) unless facets.nil?
  facet :facet_tag
  paginate :page => 1, :per_page => 8
end 
```

我应该如何从 sunspot 获取所有已发布的产品？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-15T22:40:56.673

问题中提供的代码正在运行。问题源于我对 solrconfig 文件所做的更改。我添加了一个名为 edismax 的 requestHandler。我假设 sunspot 正在使用它，因为它被设置为默认请求处理程序并且全文搜索正在工作。

相反，Sunspot 期待一个名为 dismax 的请求处理程序，并且因为没有配置这样的请求处理程序，所以它无法检索所有文档，因为 Solr 不理解*:*搜索查询。

实际上这根本不应该是一个问题，因为 Sunspot 旨在成为 Solr 的完整抽象，并且不需要更改 solr 配置文件。当谈到 Solr 的更高级使用时，Sunspot 还没有出现，因此经常需要进行更改。幸运的是，可以使用 adjust_solr_params 函数更改 solr 参数。

我通过将代码更改为：

```
@products = Product.search do   
  with(:published, true)
  with(:facet_tag).all_of(facets) unless facets.nil?
  fulltext q do
  end
  adjust_solr_params do |p|       
    p[:'defType'] = 'edismax'     
  end
  facet :facet_tag
  paginate :page => 1, :per_page => 8
end 
```

这样，我要求 solr 使用 edsimax 查询解析器而不是 dismax 查询解析器。

# ms-office - 从二维数组VB.net写入excel文件

> ID：14286147
> 
> 赞同：0
> 
> 时间：2013-01-11T20:30:11.367
> 
> 标签：ms-office, openxml, export-to-excel, openxml-sdk

我有一个通过迭代数据读取器形成的二维数组。早些时候，我使用自动化写入 excel 并使用范围，我能够一次将二维数组的内容写入 excel。这大大提高了性能，因为只有一次与 excel 的交互。但是遇到了一个问题，我的服务器没有安装office，所以我尝试使用openxml（因为在这种情况下我只需要安装一个dll）。

在网上我看到了几个使用openxml的例子，但我不确定是否有办法将二维数组的内容直接传输到工作表中。我不想迭代数据读取器并逐个单元格更新每个单元格，因为我有 65 列和近 90000 行。

那么 SDK 是否提供任何内置命令来执行此操作？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-12T03:41:53.240

你不应该害怕迭代，因为不再有“与 excel 交互”的 dcom 惩罚。打开的 xml 只是写入一个流，您可以缓冲该流以保存刷新到磁盘。

仅供参考，我个人使用封闭式 xml (nuget @ [http://nuget.org/packages/ClosedXML](http://nuget.org/packages/ClosedXML) ) 创建 Excel 文件，发现它比使用原始 Open XML 标准要好得多。

最后，即使您在服务器上有 excel，您也不应该在没有 UI 的环境中使用 excel 作为 dcom 服务器。

# algorithm - 使用动态规划的矩阵乘法

> ID：14286150
> 
> 赞同：3
> 
> 时间：2013-01-11T20:30:15.350
> 
> 标签：algorithm, language-agnostic, dynamic-programming

我试图了解以下使用动态编程进行矩阵乘法的算法。

如果`mi, j`是评估产品的最低成本，`Mi × ... × Mj`则：

*   mi，j = 0，如果 i = j，并且
*   mi, j = MIN, i ≤ k < j { mi,k + mk+1,j + ri-1rkrj }，如果 i < j。

算法：

```
for i := 1 to n do
   mi,i := 0
for length := 1 to n-1 do
   for i := 1 to n-length do
      j := i + length
      mi,j = MINi≤k<j{mi,k + mk+1,j + ri-1rkrj} 
```

关于它如何实际工作的任何线索，或者是否有人可以为我指出一个很好的参考。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-11T22:42:36.937

该算法找到乘以矩阵链的最低成本。

给定一个`A`具有`p`行和`q`列的矩阵`B`以及具有`q`行和`r`列的矩阵，标准矩阵乘法`A·B`进行`p*q*r`乘法 - 对于乘积的每个`p×r`条目，`q`对应行的元素`A`和对应的列的元素之间的乘法`B`。

现在，矩阵乘法是关联的，所以你可以用括号括起来

```
M_1 · M_2 · … · M_n 
```

如您所愿，它总是会产生相同的结果。

现在，让`r_0`的行数`M_1`和`r_i`列数`M_i`（也必须是`M_(i+1)`要定义的产品的行数）。

那么`M_i · … · M_k`是一个`r_(i-1)×r_k`矩阵，`M_(k+1) · … · M_j`是一个`r_k×r_j`矩阵。因此，如果`M_i · … · M_j`通过首先计算乘积`M_i · … · M_k`然后`M_(k+1) · … · M_j`将两个结果矩阵相乘来计算乘积，则乘法的总成本为

```
c_{i,k} + c_{k+1,j} + r_(i-1)×r_k×r_j 
```

其中`c_{i,k}`是所选计算方式的成本`M_i · … · M_k`（与 类似`c_{k+1,j}`）。

现在，如果以最小的成本评估两个子产品，那么显然可以实现`M_i · … · M_j`通过后拆分评估的最小成本。`M_k`

`M_i · … · M_j`并且通过计算所有可能拆分的最小成本来找到评估的最小成本，所以

```
m_{i,j} = min { m_{i,k} + m_{k+1,j} + r_(i-1)×r_k×r_j : i <= k < j } 
```

为`i < j`.

然后计算完整产品的最小成本，首先计算仅涉及两个矩阵的子产品的最小成本[其中只有一个可能的拆分]，然后计算使用三个矩阵的子产品的最小成本，为此我们需要最小成本只有两个矩阵的子乘积——这就是括号起作用的地方，通常会产生影响——然后是四个等，直到找到总计算的最小成本。

要找到产生最低成本的括号，您可以搜索最小成本数组以找到产生它的拆分[然后是两个子产品等]，但最好存储在哪里的信息以最低成本与`m`阵列中的最低成本分开。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-12T09:27:08.217

我不喜欢复制和粘贴，我会保持简短并用我自己的话给出：

这个问题的关键是：计算A*B*C只有两种可能的方式：A*(B*C)或(A*B)*C。同样，计算 A*B*C*D 只有三种方式：A*(B*C*D)、(A*B)*(C*D)、(A*B*C)*D。（注：（B*C*D）和（A*B*C）这里是子问题，之前已经计算过了）

因此，计算 M1*M2*... *Mn 有 n-1 种可能性： M1* (M2*M3*...*Mn), (M! *M2)* (M3*...*Mn), ... , ( M1*M2*...*Mn-1)*Mn

这就是您给定的伪代码中的内容:)

# ruby-on-rails - 从 3.0.10 迁移到 3.1.19 后尝试运行 rails 服务器时出错

> ID：14286153
> 
> 赞同：0
> 
> 时间：2013-01-11T20:30:22.603
> 
> 标签：ruby-on-rails, ruby-on-rails-3.1, sass, activeadmin

我尝试按照这个[railscast](http://railscasts.com/episodes/282-upgrading-to-rails-3-1?view=comments)将我的 3.0.10 rails 应用程序迁移到 3.1.10，但对我来说事情并没有像 Ryan 那样顺利。在解决了一些 gemset 依赖问题之后，我现在在尝试启动开发服务器时遇到了以下错误：

```
[nw0.0.1master (migrate_to_31)]$ rails s
=> Booting WEBrick
=> Rails 3.1.10 application starting in development on http://0.0.0.0:3000
=> Call with -d to detach
=> Ctrl-C to shutdown server
Exiting
/Users/charlesweinberger/.rvm/gems/ruby-1.9.2-p290@global/gems/rake-0.8.7/lib/rake.rb:2503:in `const_missing': uninitialized constant Sass::Plugin (NameError)
    from /Users/charlesweinberger/.rvm/gems/ruby-1.9.2-p290@rails31/gems/aws-s3-0.6.3/lib/aws/s3/extensions.rb:212:in `const_missing_from_s3_library'
    from /Users/charlesweinberger/rails_projects/nw0.0.1master/config/initializers/active_admin.rb:2:in `<top (required)>'
    from /Users/charlesweinberger/.rvm/gems/ruby-1.9.2-p290@rails31/gems/railties-3.1.10/lib/rails/engine.rb:556:in `block (2 levels) in <class:Engine>'
    from /Users/charlesweinberger/.rvm/gems/ruby-1.9.2-p290@rails31/gems/railties-3.1.10/lib/rails/engine.rb:555:in `each'
    from /Users/charlesweinberger/.rvm/gems/ruby-1.9.2-p290@rails31/gems/railties-3.1.10/lib/rails/engine.rb:555:in `block in <class:Engine>'
    from /Users/charlesweinberger/.rvm/gems/ruby-1.9.2-p290@rails31/gems/railties-3.1.10/lib/rails/initializable.rb:30:in `instance_exec'
    from /Users/charlesweinberger/.rvm/gems/ruby-1.9.2-p290@rails31/gems/railties-3.1.10/lib/rails/initializable.rb:30:in `run'
    from /Users/charlesweinberger/.rvm/gems/ruby-1.9.2-p290@rails31/gems/railties-3.1.10/lib/rails/initializable.rb:55:in `block in run_initializers'
    from /Users/charlesweinberger/.rvm/gems/ruby-1.9.2-p290@rails31/gems/railties-3.1.10/lib/rails/initializable.rb:54:in `each'
    from /Users/charlesweinberger/.rvm/gems/ruby-1.9.2-p290@rails31/gems/railties-3.1.10/lib/rails/initializable.rb:54:in `run_initializers'
    from /Users/charlesweinberger/.rvm/gems/ruby-1.9.2-p290@rails31/gems/railties-3.1.10/lib/rails/application.rb:96:in `initialize!'
    from /Users/charlesweinberger/.rvm/gems/ruby-1.9.2-p290@rails31/gems/railties-3.1.10/lib/rails/railtie/configurable.rb:30:in `method_missing'
    from /Users/charlesweinberger/rails_projects/nw0.0.1master/config/environment.rb:7:in `<top (required)>'
    from /Users/charlesweinberger/rails_projects/nw0.0.1master/config.ru:3:in `block in <main>'
    from /Users/charlesweinberger/.rvm/gems/ruby-1.9.2-p290@rails31/gems/rack-1.3.8/lib/rack/builder.rb:51:in `instance_eval'
    from /Users/charlesweinberger/.rvm/gems/ruby-1.9.2-p290@rails31/gems/rack-1.3.8/lib/rack/builder.rb:51:in `initialize'
    from /Users/charlesweinberger/rails_projects/nw0.0.1master/config.ru:in `new'
    from /Users/charlesweinberger/rails_projects/nw0.0.1master/config.ru:in `<main>'
    from /Users/charlesweinberger/.rvm/gems/ruby-1.9.2-p290@rails31/gems/rack-1.3.8/lib/rack/builder.rb:40:in `eval'
    from /Users/charlesweinberger/.rvm/gems/ruby-1.9.2-p290@rails31/gems/rack-1.3.8/lib/rack/builder.rb:40:in `parse_file'
    from /Users/charlesweinberger/.rvm/gems/ruby-1.9.2-p290@rails31/gems/rack-1.3.8/lib/rack/server.rb:200:in `app'
    from /Users/charlesweinberger/.rvm/gems/ruby-1.9.2-p290@rails31/gems/railties-3.1.10/lib/rails/commands/server.rb:46:in `app'
    from /Users/charlesweinberger/.rvm/gems/ruby-1.9.2-p290@rails31/gems/rack-1.3.8/lib/rack/server.rb:304:in `wrapped_app'
    from /Users/charlesweinberger/.rvm/gems/ruby-1.9.2-p290@rails31/gems/rack-1.3.8/lib/rack/server.rb:254:in `start'
    from /Users/charlesweinberger/.rvm/gems/ruby-1.9.2-p290@rails31/gems/railties-3.1.10/lib/rails/commands/server.rb:70:in `start'
    from /Users/charlesweinberger/.rvm/gems/ruby-1.9.2-p290@rails31/gems/railties-3.1.10/lib/rails/commands.rb:54:in `block in <top (required)>'
    from /Users/charlesweinberger/.rvm/gems/ruby-1.9.2-p290@rails31/gems/railties-3.1.10/lib/rails/commands.rb:49:in `tap'
    from /Users/charlesweinberger/.rvm/gems/ruby-1.9.2-p290@rails31/gems/railties-3.1.10/lib/rails/commands.rb:49:in `<top (required)>'
    from script/rails:37:in `require'
    from script/rails:37:in `<main>' 
```

这是我当前的 Gemfile：

```
gem "pg"
gem 'pg_search'
gem 'rails', '3.1.10'
gem 'nokogiri', '1.5.5'
gem 'geocoder', '1.0.2'
gem 'devise', '1.5.3'
gem 'acts_as_api', '0.3.8'
gem 'paperclip', '~>2.4.1'
gem 'rake', '0.8.7'
gem 'omniauth', :git => 'https://github.com/intridea/omniauth.git'
gem 'fb_graph', '1.9.5'
gem 'twitter', :git => 'https://github.com/sferik/twitter.git'
gem 'jquery-rails', '>= 1.0.12'
gem 'aws-s3'
gem 'remotipart', '~> 1.0'
gem 'activeadmin'
gem 'formtastic', '~> 2.1.0'
gem "browser"
gem "httparty"
gem "thin"

# Gems used only for assets and not required
# in production environments by default.
group :assets do
  gem 'sass-rails', "  ~> 3.1.0"
  gem 'coffee-rails', "~> 3.1.0"
  gem 'uglifier'
end

group :production, :staging do
end

group :development do
    gem 'rspec-rails'
    gem 'annotate', '2.4.0'
    gem 'faker', '0.3.1'
    gem 'ruby-debug19', '0.11.6'
    gem 'nifty-generators', '0.4.6'
    gem 'silent-postgres'
end

group :test do
  gem 'rspec'
  gem 'webrat', '0.7.1'
  gem 'factory_girl_rails'
    gem "mocha", '0.9.12'
    gem 'silent-postgres'
end 
```

而且，我在 application.rb 中启用了资产管道。这是application.rb：

```
require File.expand_path('../boot', __FILE__)

require 'rails/all'

# If you precompile assets before deploying to production, use this line
Bundler.require *Rails.groups(:assets => %w(development test))
# If you want your assets lazily compiled in production, use this line
# Bundler.require(:default, :assets, Rails.env)

module Nw001
  class Application < Rails::Application

    # Enable the asset pipeline
    config.assets.enabled = true

    # Version of your assets, change this if you want to expire all your assets
    config.assets.version = '1.0'

    # Settings in config/environments/* take precedence over those specified here.
    # Application configuration should go into files in config/initializers
    # -- all .rb files in that directory are automatically loaded.

    # Custom directories with classes and modules you want to be autoloadable.
    # config.autoload_paths += %W(#{config.root}/extras)

    # Only load the plugins named here, in the order given (default is alphabetical).
    # :all can be used as a placeholder for all plugins not explicitly named.
    # config.plugins = [ :exception_notification, :ssl_requirement, :all ]

    # Activate observers that should always be running.
    # config.active_record.observers = :cacher, :garbage_collector, :forum_observer

    # Set Time.zone default to the specified zone and make Active Record auto-convert to this zone.
    # Run "rake -D time" for a list of tasks for finding time zone names. Default is UTC.
    # config.time_zone = 'Central Time (US & Canada)'

    # The default locale is :en and all translations from config/locales/*.rb,yml are auto loaded.
    # config.i18n.load_path += Dir[Rails.root.join('my', 'locales', '*.{rb,yml}').to_s]
    # config.i18n.default_locale = :de

    # JavaScript files you want as :defaults (application.js is always included).
    # config.action_view.javascript_expansions[:defaults] = %w(jquery rails)

    # Configure the default encoding used in templates for Ruby 1.9.
    config.encoding = "utf-8"

    # Configure sensitive parameters which will be filtered from the log file.
    config.filter_parameters += [:password]

    # Use SQL instead of Active Record's schema dumper when creating the database.
    # This is necessary if your schema can't be completely dumped by the schema dumper,
    # like if you have constraints or database-specific column types
    # Note, the migration that I use to install the unaccented module for pgs requires SQL
    # config.active_record.schema_format = :sql

 #uncomment to force ssl on localhost   
#   config.middleware.insert_before ActionDispatch::Static, "Rack::SSL"
  end
end 
```

并且，对我的配置/环境文件进行了建议的添加。

知道如何通过未初始化的常量 Sass::Plugin (NameError) 吗？？？

我也尝试过使用 rails 3.1.0，它会抛出同样的错误。我也跑去`rails generate active_admin:assets`更新 active_admin 资产，但没有爱。

### 更新

在@andrew 的建议下，我创建了一个新的示例 rails3.1.10 应用程序。实际上，我所做的只是删除了我之前的 3.1 gemset；使用 rvm 创建一个新的 gemset；将 rails 3.1.10 安装到新的 gemset 中；开始使用新的 3.1 gemset；然后创建了一个新的 rails 3.1.10 应用程序。该应用程序按预期运行。

然后，我更进一步，将新应用程序 gemfile 替换为我尝试迁移到 3.1.10 的应用程序中的 gemfile。在解决了几个依赖问题并将 sqlite3 gem 重新插入 gemfile 之后，新的测试应用程序再次按预期运行。

然后，我将测试应用程序的 gemfile 复制回我尝试迁移的应用程序中，并且仍然使用新的 3.1 gemset，尝试加载开发服务器。我仍然得到一个错误，它与上面列出的错误相似，但有些不同。看看这个：

```
[nw0.0.1master (master)]$ rails s
=> Booting WEBrick
=> Rails 3.1.10 application starting in development on http://0.0.0.0:3000
=> Call with -d to detach
=> Ctrl-C to shutdown server
Exiting
/Users/charlesweinberger/.rvm/gems/ruby-1.9.2-p290@rails31/gems/aws-s3-0.6.3/lib/aws/s3/extensions.rb:212:in `const_missing_from_s3_library': uninitialized constant Sass::Plugin (NameError)
    from /Users/charlesweinberger/rails_projects/nw0.0.1master/config/initializers/active_admin.rb:2:in `<top (required)>'
    from /Users/charlesweinberger/.rvm/gems/ruby-1.9.2-p290@rails31/gems/railties-3.1.10/lib/rails/engine.rb:556:in `block (2 levels) in <class:Engine>'
    from /Users/charlesweinberger/.rvm/gems/ruby-1.9.2-p290@rails31/gems/railties-3.1.10/lib/rails/engine.rb:555:in `each'
    from /Users/charlesweinberger/.rvm/gems/ruby-1.9.2-p290@rails31/gems/railties-3.1.10/lib/rails/engine.rb:555:in `block in <class:Engine>'
    from /Users/charlesweinberger/.rvm/gems/ruby-1.9.2-p290@rails31/gems/railties-3.1.10/lib/rails/initializable.rb:30:in `instance_exec'
    from /Users/charlesweinberger/.rvm/gems/ruby-1.9.2-p290@rails31/gems/railties-3.1.10/lib/rails/initializable.rb:30:in `run'
    from /Users/charlesweinberger/.rvm/gems/ruby-1.9.2-p290@rails31/gems/railties-3.1.10/lib/rails/initializable.rb:55:in `block in run_initializers'
    from /Users/charlesweinberger/.rvm/gems/ruby-1.9.2-p290@rails31/gems/railties-3.1.10/lib/rails/initializable.rb:54:in `each'
    from /Users/charlesweinberger/.rvm/gems/ruby-1.9.2-p290@rails31/gems/railties-3.1.10/lib/rails/initializable.rb:54:in `run_initializers'
    from /Users/charlesweinberger/.rvm/gems/ruby-1.9.2-p290@rails31/gems/railties-3.1.10/lib/rails/application.rb:96:in `initialize!'
    from /Users/charlesweinberger/.rvm/gems/ruby-1.9.2-p290@rails31/gems/railties-3.1.10/lib/rails/railtie/configurable.rb:30:in `method_missing'
    from /Users/charlesweinberger/rails_projects/nw0.0.1master/config/environment.rb:7:in `<top (required)>'
    from /Users/charlesweinberger/rails_projects/nw0.0.1master/config.ru:3:in `block in <main>'
    from /Users/charlesweinberger/.rvm/gems/ruby-1.9.2-p290@rails31/gems/rack-1.3.8/lib/rack/builder.rb:51:in `instance_eval'
    from /Users/charlesweinberger/.rvm/gems/ruby-1.9.2-p290@rails31/gems/rack-1.3.8/lib/rack/builder.rb:51:in `initialize'
    from /Users/charlesweinberger/rails_projects/nw0.0.1master/config.ru:in `new'
    from /Users/charlesweinberger/rails_projects/nw0.0.1master/config.ru:in `<main>'
    from /Users/charlesweinberger/.rvm/gems/ruby-1.9.2-p290@rails31/gems/rack-1.3.8/lib/rack/builder.rb:40:in `eval'
    from /Users/charlesweinberger/.rvm/gems/ruby-1.9.2-p290@rails31/gems/rack-1.3.8/lib/rack/builder.rb:40:in `parse_file'
    from /Users/charlesweinberger/.rvm/gems/ruby-1.9.2-p290@rails31/gems/rack-1.3.8/lib/rack/server.rb:200:in `app'
    from /Users/charlesweinberger/.rvm/gems/ruby-1.9.2-p290@rails31/gems/railties-3.1.10/lib/rails/commands/server.rb:46:in `app'
    from /Users/charlesweinberger/.rvm/gems/ruby-1.9.2-p290@rails31/gems/rack-1.3.8/lib/rack/server.rb:304:in `wrapped_app'
    from /Users/charlesweinberger/.rvm/gems/ruby-1.9.2-p290@rails31/gems/rack-1.3.8/lib/rack/server.rb:254:in `start'
    from /Users/charlesweinberger/.rvm/gems/ruby-1.9.2-p290@rails31/gems/railties-3.1.10/lib/rails/commands/server.rb:70:in `start'
    from /Users/charlesweinberger/.rvm/gems/ruby-1.9.2-p290@rails31/gems/railties-3.1.10/lib/rails/commands.rb:54:in `block in <top (required)>'
    from /Users/charlesweinberger/.rvm/gems/ruby-1.9.2-p290@rails31/gems/railties-3.1.10/lib/rails/commands.rb:49:in `tap'
    from /Users/charlesweinberger/.rvm/gems/ruby-1.9.2-p290@rails31/gems/railties-3.1.10/lib/rails/commands.rb:49:in `<top (required)>'
    from script/rails:37:in `require'
    from script/rails:37:in `<main>' 
```

这个新信息会触发任何想法吗？？？谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-16T18:47:11.340

问题是由我`gem 'rake', "0.8.7"`在 gemfile 中指定引起的。改成`gem 'rake'`, 问题就解决了。请注意，您甚至可能不需要包含`rake`在 gemfile 中，因为它将作为依赖项包含在内。

# java - 将 ID 传递给意图

> ID：14286155
> 
> 赞同：1
> 
> 时间：2013-01-11T20:30:38.433
> 
> 标签：java, android

我正在尝试将单击的数据的 ID 从我的列表视图传递给第二个类中的新活动，即我单击 . 上的项目。`listview`该`onListItemClick`方法被调用并开始一个新的意图。id 与 中的对象一起传递`i.getExtra`。然后将 id 存储到第二个类的新变量中以供以后使用。

我已经弄清楚如何传递 id，但我似乎无法弄清楚如何将其存储在第二类的新变量中。

这是我的代码：

```
public void onListItemClick(ListView list, View v, int list_posistion, long item_id)
{

    long id = item_id;
    Intent i = new Intent("com.example.sqliteexample.SQLView");
    i.putExtra(null, id);
    startActivity(i);
} 
```

谁能告诉我如何在第二堂课中引用它？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-11T20:32:37.083

您需要从 Intent 获取 Bundle ，然后执行 get... 以获取特定元素。

```
Bundle extras = getIntent().getExtras(); 
String id;

if (extras != null) {
    id= extras.getString("key");  //key should be what ever used in invoker.
} 
```

令人惊讶的一件事是为什么您使用`null`as key？我会避免使用保留词，而是使用专有名称`userID`等，

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-11T20:33:34.350

```
Intent intent = new Intent("com.example.sqliteexample.SQLView");
                    Bundle bundle = new Bundle();
                    bundle.putString("position", v.getTag().toString());
                    intent.putExtras(bundle);
                    context.startActivity(intent); 
```

在二等

```
 Bundle intent= getIntent().getExtras(); 

       if (intent.getExtras() == null) {
    id= intent.getString("position");
    } 
```

希望这可以帮助

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-11T20:37:11.270

这很简单。
只是改变 ：

```
i.putExtra(null, id); 
```

和 ：

```
i.putExtra("myId", id); 
```

在第二个活动中只需使用：

```
Bundle extras = getIntent().getExtras();
if (extras != null) {
    String value = extras.getInt("myId");
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-11T20:38:12.373

第一个参数`Intent.putExtra()`是用于标识您的 Extra 的字符串键。而不是`i.putExtra(null, id)`尝试`i.putExtra("SomeString", id)`。

然后，在您的第二个活动（或其中的任何位置）的 onCreate 中，您可以从意图中获取您的 id，如下所示：

```
Intent intent = getIntent();
long id = intent.getLongExtra("SomeString"); 
```

还有一些方法可以获取字符串、字符、布尔值、整数和更复杂的数据结构。在此处查看：http: [//developer.android.com/reference/android/content/Intent.html](http://developer.android.com/reference/android/content/Intent.html)以获取有关 Intent 类方法的更多信息。

# c# - 难倒 SelfHosting WebApi 服务

> ID：14286167
> 
> 赞同：3
> 
> 时间：2013-01-11T20:31:15.100
> 
> 标签：c#, asp.net, .net, asp.net-mvc-4, asp.net-web-api

请帮忙，我正在尝试自托管一个 web api。

当同一个控制器托管在 Web 项目上，并通过 F5 在 dev 上运行时，一切正常。

但是现在我尝试自行托管相同的内容，我得到 411 和 404。411，当我使用 Fiddler 连接时，404 当我尝试通过另一个库连接时。

这是应该托管服务的控制台应用程序：

```
class Program
{        
    static int portNumber;

    static void Main(string[] args)
    {
        portNumber = 8089;

        var config = new HttpSelfHostConfiguration(
            string.Format("http://localhost:{0}", portNumber));

        config.Routes.MapHttpRoute(
                "API Default", "api/{controller}/{id}",
                new { id = RouteParameter.Optional });

        using (var server = new HttpSelfHostServer(config))
        {

            var test = new RetrieveGuidService().Execute(Unit.Instance);

            server.OpenAsync().Wait();

            Console.ReadLine();
        }
    }
} 
```

这就是我的控制器的样子，它什么都不做，只是一个测试。

```
public class RetrieveGuidServiceController : ApiController
{
    public virtual Guid PostExecute(Unit request)
    {
        IQueryService<Unit,Guid> queryService = new RetrieveGuidService();
        return queryService.Execute(request);
    }
} 
```

这就是我尝试通过提琴手访问它的方式：

![我的提琴手图片](../Images/bcc578e013e9c1b0f31d3a3c6ecd6aba.png)

当服务托管在 Web 项目上时，同样适用。我几乎完全按照本教程进行操作：[asp.net WebApi 自托管教程](http://www.asp.net/web-api/overview/hosting-aspnet-web-api/self-host-a-web-api)，其中包括运行 nugget 脚本、添加依赖项等。

我还缺少什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-12T03:10:51.430

411 是因为您没有放置 Content-Length 标头。即使您不发送内容，您也需要包含 Content-Length: 0。

关于将控制器放入正确的程序集中，我的行为不一致。在某些项目中，它似乎在其他项目中不起作用。不知道我做错了什么。我在[这里](https://bitbucket.org/darrelmiller/devteach312)有一个项目，它使用不同程序集中的所有控制器同时执行 Web Host 和 Self-Host，它工作得很好。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-11T23:07:31.507

似乎在默认情况下，服务不会在程序集中查找包含服务的控制器之外的控制器。

我认为这是一个遗漏，除非我正在阅读 wropng 的规格。

# vb.net - 垂直滚动条不使用 EnableScrollBar api 重新绘制

> ID：14286172
> 
> 赞同：0
> 
> 时间：2013-01-11T20:31:37.427
> 
> 标签：vb.net, winforms, winapi, interop

我正在尝试使用 EnableScrollBar api 禁用 VScrollBar 控件。当我调用 api 时，它返回好像没有问题，但 VScrollBar 没有重新绘制。

要重现此问题，请创建一个 Vb.Net windows 窗体项目，将一个 VScrollBar 控件和一个按钮拖放到窗体并粘贴以下代码：

```
<DllImport("user32.dll", CharSet:=CharSet.Auto, SetLastError:=True, ExactSpelling:=True)>
Public Shared Function EnableScrollBar(ByVal hWnd As IntPtr, ByVal nBar As Integer, ByVal value As Integer) As Boolean
End Function

Private Sub Button1_Click(sender As Object, e As EventArgs) Handles Button1.Click
    Dim wSBflags As UInteger = 3UI 'SB_VERT
    Dim wArrows As UInteger = 3UI 'ESB_DISABLE_BOTH
    Dim result As Boolean = EnableScrollBar(Me.VScrollBar1.Handle, wSBflags, wArrows)

End Sub 
```

我尝试使用 SendMessage 发送重绘（WM_REDRAW）和绘画（WM_PAINT），但无法让它工作。有什么想法吗？

Ps：如果您删除多行文本框并使用相同的代码，它可以工作......

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-11T20:45:43.827

`SB_VERT`用于垂直滚动条，作为窗口非客户区的一部分。对于滚动条控件，使用`SB_CTL`常量。

# c# - 如何从另一个页面导航到指定的全景项目

> ID：14286174
> 
> 赞同：1
> 
> 时间：2013-01-11T20:31:57.900
> 
> 标签：c#, windows-phone-7, navigation, panorama-control

我有`MainPage.xaml`和`PanoramaPage1.xaml`。

如何从`MainPage`to`Item1`或`Item2`in导航`PanoramaPage`？

例如： `Button1->Item1`和`Button2->Item2`

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-11T20:38:41.887

您可以使用标准导航：

```
this.NavigationService.Navigate(new Uri("PanoramaPage1.xaml?buttonid=button1",UriKind.Relative)); 
```

在对象变量中传递您的目标，然后在全景页面中处理：

```
protected override void OnNavigatedTo(NavigationEventArgs e)
{
  if ( this.NavigationContext.QueryString.ContainsKey( "buttonid" ) 
  {
      string buttonid = this.NavigationContext.QueryString[ "buttonid" ];
  }
} 
```

# .net - 如何通过 ASPxComboBox 通过 SelectedIndexChange 或 SelectedItemChange 等顺利保存更新的数据

> ID：14286175
> 
> 赞同：1
> 
> 时间：2013-01-11T20:31:58.087
> 
> 标签：.net, combobox, devexpress, selectedindexchanged

目前，我有一个需要改进的遗留项目，其中一个特别的部分给我带来了问题。我是 DevExpress 的新手（使用 11.2.10 版本），并且对当前的 .NET 开发相当陌生。

在查看 Stack 和 DexExpress 支持论坛和文档时，我发现了很多似乎与我正在尝试做的事情很接近的事情（主要涉及 selectedindexchanged 等），但没有任何东西完全适合这个......

这是发生了什么：

该站点的一个页面（“按钮”）允许编辑大量信息，其中大部分都整齐地组合在一起 ASPxRoundPanels 中的数据字段等。

其中一个圆形面板有一个组合框，显示按钮可以执行的所有“操作”列表。

此 (SQL_SelectAllButtonActions) 的选择语句正常工作，从数据库的 Action 表中提取所有可能的操作。

组合框 (buttonAction) 在从该列表中预先选择存储为 Button 表上的 Action_Id 的特定值时可以正常工作。

（到目前为止，一切都很好。）

目标：

客户非常希望在用户选择组合框值时自动更新页面（和数据库）。无需回发，只需更改下拉（组合）框中的值。

因此，假设 Button_Id 1 有一些值，其中 Action_Id 8。如果用户要通过 buttonAction 组合框选择不同的值，那么我们应该更新 Button_Id 1 的记录以反映新的 Action_Id 值（即，不是 8 ）。

我有一个更新命令作为 SqlDataSource (SQL_UpdateButtonAction) 的一部分，在数据库端手动测试时该命令有效。

下面是我的代码，它不会引发错误。但它也不会保存/更新通过组合框编辑的按钮的 Action_Id。

我错过了什么？欢迎大家提供帮助和建议，非常感谢！

```
<PanelCollection><dx:PanelContent ID="PanelContent1" runat="server"
 SupportsDisabledAttribute="True">
<div class="headerDiv"> 
<div class="buttonDiv">
 <dx:ASPxButton ID="ASPxButton1" runat="server" Text="Save Changes"
 AutoPostBack="False"> 
</dx:ASPxButton>
 </div>

<div style="float: left; width: 390px;"> 
<dx:ASPxRoundPanel ID="ASPxRoundPanel1" runat="server" Width="400px"
 HeaderText="Details"> 
<PanelCollection>
<dx:PanelContent ID="PanelContent3" runat="server">
 <div class="labelDiv"> Action </div>
 <div class="fieldDiv"> 
<dx:ASPxComboBox ID="buttonAction" runat="server" Width="240px"
 DataSourceID="ButtonActionsDataSource" TextField="name"
 ValueField="action_id" ValueType="System.Int32"> 
</dx:ASPxComboBox> 
/div>

 <asp:SqlDataSource ID="ButtonActionsDataSource" runat="server" 
ConnectionString="<%$ ConnectionStrings:<snip> %>"
 SelectCommand="SQL_SelectAllButtonActions" SelectCommandType="StoredProcedure"
 UpdateCommand="SQL_UpdateButtonAction" UpdateCommandType="StoredProcedure">
<UpdateParameters> 
<asp:Parameter Name="button_id" Type="Int32" />
<asp:Parameter Name="action_id" Type="Int32" />
</UpdateParameters>
</asp:SqlDataSource> 
```

这是我的 DataClasses 文件中的样子：

```
<Function Name="dbo.Sql_UpdateButtonAction" Method="Sql_UpdateButtonAction">
<Parameter Name="button_id" Type="System.Int32" DbType="Int" />
<Parameter Name="action_id" Type="System.Int32" DbType="Int" />
<Return Type="System.Int32" />
</Function>

<Function Name="dbo.Sql_UpdateButtonItem" Method="Sql_UpdateButtonItem">
<Parameter Name="button_id" Type="System.Int32" DbType="Int" />
<Parameter Name="item_id" Type="System.Int32" DbType="Int" />
<Return Type="System.Int32" />
</Function>

[global::System.Data.Linq.Mapping.FunctionAttribute(Name = "dbo.Sql_UpdateButtonAction")]
public int Sql_UpdateButtonAction([global::System.Data.Linq.Mapping.ParameterAttribute(DbType = "Int")] System.Nullable<int> button_id, [global::System.Data.Linq.Mapping.ParameterAttribute(DbType = "Int")] System.Nullable<int> action_id)
{
    IExecuteResult result = this.ExecuteMethodCall(this, ((MethodInfo)(MethodInfo.GetCurrentMethod())), button_id, action_id);
    return ((int)(result.ReturnValue));
}

[global::System.Data.Linq.Mapping.FunctionAttribute(Name = "dbo.Sql_UpdateButtonItem")]
public int Sql_UpdateButtonItem([global::System.Data.Linq.Mapping.ParameterAttribute(DbType = "Int")] System.Nullable<int> button_id, [global::System.Data.Linq.Mapping.ParameterAttribute(DbType = "Int")] System.Nullable<int> item_id)
{
    IExecuteResult result = this.ExecuteMethodCall(this, ((MethodInfo)(MethodInfo.GetCurrentMethod())), button_id, item_id);
    return ((int)(result.ReturnValue));
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-18T14:09:45.780

根据 DevExpress 给出的答案：

由于处理了两个组合框的客户端 SelectedIndexChanged 事件，因此向 ASPxCallback 控件发送了一个回调，并通过 GetValue 方法将当前值作为参数传递。

此外，在 ASPxCallback1_Callback 方法中，应将两个额外的情况添加到 switch 块中。在这些情况下，将调用 SQL Update 命令以根据当前选定按钮的选定值更新数据。

# iphone - 在 iphone 应用程序中嵌入 HTML 页面的最佳框架？

> ID：14286176
> 
> 赞同：2
> 
> 时间：2013-01-11T20:32:02.390
> 
> 标签：iphone, html, frameworks

我正在开发一个应用程序，其中有一个重要的“参考”部分。该信息非常适用于创建为一组 HTML 页面，并相互链​​接。

我想知道是否有人知道一个很好的框架，可以在 iphone 应用程序中嵌入 HTML 页面，以便能够通过键和任何其他细节打开特定页面。到目前为止，我见过的最好的是 github 上的 CMHTMLView。

我知道我可以将 HTML 页面直接加载到 UIWebView 中，我正在寻找是否有一个框架可以为我做一些样板文件（例如检查文件的存在，能够通过关键字缓存页面，任何其他细节，例如能够索引和搜索页面）。谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-14T11:50:21.333

为了在移动设备中显示易于导航的 HTML，我使用[http://jquerymobile.com](http://jquerymobile.com)

# ruby-on-rails-3 - Rails - 如何测试 ActionMailer 发送了特定附件？

> ID：14286179
> 
> 赞同：32
> 
> 时间：2013-01-11T20:32:07.710
> 
> 标签：ruby-on-rails-3, unit-testing, ruby-on-rails-3.2, actionmailer

在我的 ActionMailer::TestCase 测试中，我期待：

```
@expected.to      = BuyadsproMailer.group_to(campaign.agency.users)
@expected.subject = "You submitted #{offer_log.total} worth of offers for #{offer_log.campaign.name} "
@expected.from    = "BuyAds Pro <feedback@buyads.com>"
@expected.body    = read_fixture('deliver_to_agency')

@expected.content_type = "multipart/mixed;\r\n boundary=\"something\""
@expected.attachments["#{offer_log.aws_key}.pdf"] = {
  :mime_type => 'application/pdf',
  :content => fake_pdf.body
} 
```

并存根我的邮件以获取 fake_pdf 而不是通常从 S3 获取的真实 PDF，以便我确定 PDF 的正文匹配。

但是，我收到这个很长的错误，告诉我应该收到一封电子邮件，但收到的电子邮件略有不同：

```
<...Mime-Version: 1.0\r\nContent-Type: multipart/mixed\r\nContent-Transfer-Encoding: 7bit...> expected but was
<...Mime-Version: 1.0\r\nContent-Type: multipart/mixed;\r\n boundary=\"--==_mimepart_50f06fa9c06e1_118dd3fd552035ae03352b\";\r\n charset=UTF-8\r\nContent-Transfer-Encoding: 7bit...> 
```

我不匹配生成的电子邮件的字符集或部分边界。

如何定义或存根预期电子邮件的这一方面？

* * *

## 回答 #1

> 赞同：54
> 
> 时间：2013-02-13T23:38:12.730

这是我从特定附件的 rspec 测试中复制的示例，希望对您有所帮助（可以通过调用您的 mailer 方法或在调用 .deliver 后查看交付数组来创建邮件）：

```
 mail.attachments.should have(1).attachment
  attachment = mail.attachments[0]
  attachment.should be_a_kind_of(Mail::Part)
  attachment.content_type.should be_start_with('application/ics;')
  attachment.filename.should == 'event.ics' 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2020-06-17T18:42:41.097

我有类似的东西，我想检查附加的 csv 内容。我需要这样的东西，因为它看起来像是`\r`插入换行符：

```
expect(mail.attachments.first.body.encoded.gsub(/\r/, '')).to(
  eq(
    <<~CSV
      "Foo","Bar"
      "1","2"
    CSV
  )
) 
```

# macos - AppleScript（或其他代码？）根据磁盘的存在来更改 iTunes 库

> ID：14286190
> 
> 赞同：0
> 
> 时间：2013-01-11T20:32:47.133
> 
> 标签：macos, itunes, external, drive

我的外部驱动器上有大型音乐库，内部驱动器上有一个更便携的音乐库。我真正想要的是一个应用程序，它可以检查我的外部驱动器是否存在，然后继续使用正确的库启动 iTunes。

我知道[这里的问题，](https://stackoverflow.com/questions/1693780/applescript-to-launch-itunes-with-a-specific-library)虽然这可能非常接近我想要做的，但我不知道足够的 Applescript 来实现它。[还有这个整洁的脚本](http://hints.macworld.com/article.php?story=20050123205848370)，但它给了我这个错误：“Finder 出现错误：ln: /Users/Matt/Music/: Permission denied”，我不知道如何更改权限以使其正常工作。另外，我不需要它对每个用户都起作用，尽管这没什么大不了的。

[还有一个人](http://www.stalecoffee.com/2012/12/managing-and-switching-itunes-libraries-from-alac-to-match/)用 ControPlane 解决了他的问题，我目前将其用于其他目的。只有当我启动 iTunes 并且仍然让它在我工作或在家时切换我的网络首选项时，我才想出一种明智的方式来运行脚本。更改其中一个 Applescript 效果最好吗？如果是这样，我怎样才能使它工作？或者我们可以让 ControlPlane 运行一个脚本来更改 iTunes 将打开哪个库，这取决于我的驱动器是否连接？（虽然仍然保持我正确的网络设置）...

任何建议将不胜感激。多谢你们！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-18T13:39:07.233

您可能会尝试的另一个解决方案是使用[Keyboard Maestro](http://www.macupdate.com/app/mac/6265/keyboard-maestro)。您将能够为 iTunes 构建触发器，以便启动应用程序将运行脚本，并且该脚本可以根据外部驱动器的存在选择适当的库。

# arrays - 无法在 Perl 的数组中找到空值的来源

> ID：14286191
> 
> 赞同：0
> 
> 时间：2013-01-11T20:32:52.410
> 
> 标签：arrays, perl

我已经以多种方式将我的代码简化为最基本的内容，试图找出为什么我的数组中的第一个值是空白的，我很困惑。我有一系列目录和文件。如果它是名称包含某个字符串（如“conf”）的目录或文件，我不感兴趣。如果是其他内容，我将其写入屏幕并将其推送到数组对象。

然后，我遍历数组并将每个条目写入屏幕。这就是我想要做的。当我查看第一部分中打印到屏幕上的内容时，信息与我预期的一样。当我打印出数组中的条目时，输出总是有一个空字符串，或者在数组的第一个索引中没有任何内容。

这是我的代码：

```
sub scrubFiles { # Parse through interesting directories for interestingly named files
    my $wanted = sub {
            if (-d $_) {
                    print "Directory and will not be inserted into the files array: $_\n"
                    return;
            };
            if ($_ =~ /\.(?:yaml|bak|conf|cfg)\z/i) {
                    print "Not desirable and will not be inserted into the files array: $_\n";
                    return;
            };
            print ("Adding $_ to \@filelist\n");
            push @filelist, $File::Find::name;
    };
    find( {wanted => $wanted, no_chdir=>1}, @_ );  # WILL NOT work properly without no_chdir
    return @filelist;
}

&scrubFiles("/tmp/mydirectory/");
for (@filelist) { print "File name: $_|END\n"; } 
```

推送到数组时，我得到以下输出。“<...>”是我刚刚删除的输出，因为它无关紧要。“添加”部分正是我所期望的。在第一个“添加”打印到屏幕之前没有任何内容。当它到达“文件名”部分时，它与我所期望的完全一样，除了打印到屏幕上的数组中的第一个条目是空白的，如您在此处看到的：

```
Adding /tmp/mydirectory/ifconfig.txt to @filelist
Adding /tmp/mydirectory/history_comp.txt to @filelist
Adding /tmp/mydirectory/myctl.txt to @filelist
Adding /tmp/mydirectory/ls-l.txt to @filelist
<...>
Adding /tmp/mydirectory/opt/comp/VERSION to @filelist
File name: |END
File name: /tmp/mydirectory/ifconfig.txt|END
File name: /tmp/mydirectory/history_comp.txt|END
File name: /tmp/mydirectory/myctl.txt|END
File name: /tmp/mydirectory/ls-l.txt|END
<...>
File name: /tmp/mydirectory/opt/comp/VERSION|END 
```

我尝试使用“ref()”来找出位置 0 中的实际内容，但它不会为数组中的每个条目返回任何内容。

有什么想法可以让我得到这个空白条目吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-11T20:50:12.567

您之前的代码具有适当范围的变量。你打破了那个。通过回到使用全局变量，我们必须查看程序中的每一行才能知道发生了什么。那将是愚蠢的。

Start by going back to the code you were given to undo the two bugs you introduced. Declare `@filelist` in the sub, and actually use the list returned by the sub.

# java - 如何捆绑自定义 hadoop-streaming.jar

> ID：14286193
> 
> 赞同：1
> 
> 时间：2013-01-11T20:33:24.750
> 
> 标签：java, hadoop, streaming, mrjob

我正在尝试`CombineFileInputFormat`使用 Yelp 的 MrJob 用于 EMR 工具的课程。作业流是使用 hadoop 流创建的，MrJob 的文档表明`CombineFileInputFormat`该类必须捆绑在自定义的`hadoop-streaming.jar`.

有关上下文，请遵循此[问题](https://stackoverflow.com/questions/14270317/implementation-for-combinefileinputformat-hadoop-0-20-205)。

具体来说，我的问题是：具体类应该在哪里`CombinedInputFormat.class`捆绑或引用`hadoop-streaming.jar`？

我尝试`CombinedInputFormat.class`通过将其添加到目录`org/apache/hadoop/streaming`并执行来捆绑：

```
jar uvf my-hadoop-streaming.jar org/apache/hadoop/streaming 
```

如果我这样做，则流式作业流程将启动，并选择`-inputformat CombinedInputFormat`Job 开始第一步并中断，并出现错误：

```
Exception in thread "main" java.lang.NoClassDefFoundError: org/apache/hadoop/streaming/CombinedInputFormat (wrong name: CombinedInputFormat)
        at java.lang.ClassLoader.defineClass1(Native Method)
        at java.lang.ClassLoader.defineClassCond(ClassLoader.java:631)
        at java.lang.ClassLoader.defineClass(ClassLoader.java:615)
        ... 
```

如果我只是尝试将其设置在根路径中：

```
jar uvf my-hadoop-streaming.jar CombinedInputFormat.class 
```

我得到的错误是：

```
-inputformat : class not found : CombinedInputFormat
Streaming Job Failed! 
```

我应该如何捆绑 CombinedInputFormat.class 以便正确获取并解决`NoClassDefFoundError`错误？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-11T20:49:42.013

[这里](https://stackoverflow.com/questions/14270317/implementation-for-combinefileinputformat-hadoop-0-20-205)`CombinedInputFormat`解释的类扩展并且不与 hadoop 一起移植。因此，您需要做的是，在您拥有映射器/减速器作业类的同一个包中，您必须创建一个类并拥有上一期中所述的代码。然后创建jar，它应该可以正常运行。`CombineFileInputFormat`

所以基本上，你需要编写你自己的实现`CombineFileInputFormat`（我为你做了），你可以随意命名它，`ABCClass`而不是`CombinedInputFormat`像我命名的那样。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-05-20T02:29:35.603

这是我发现在 hadoop 本地或 EMR [http://www.applams.com/2014/05/using-custom-streaming-jar-using-custom.html中构建和运行自定义 jar 的另一种简单方法](http://www.applams.com/2014/05/using-custom-streaming-jar-using-custom.html)

# php - 这如何不将 PHP 值传递给 JS，反之亦然？

> ID：14286194
> 
> 赞同：-5
> 
> 时间：2013-01-11T20:33:24.600
> 
> 标签：php, javascript, variables

我认为将 JavaScript 变量传递给 PHP 是不可能的，反之亦然，因为 PHP 是服务器端，而 JavaScript 是客户端。

然后我看到一个网站说这是可能的，我试了一下。事实证明这是可能的，*显然*......请参阅下面的代码示例：

如果我不能传递变量，为什么它会起作用？我做错了什么？

**代码示例**

```
<?php
$var1 = 300;
echo $var1.'echo_via_php...<br />'; //so far so good

?>
<script type="text/javascript">

document.write('PHP to JS -> <br />') ;
var x = '<?php echo $var1; ?>';
document.write('doc_write_java_X: <br />') ;
document.write(x) ;
document.write(' ( if = 300 its okay...i guess )<br />') ;

var php_y = '50'      ;

</script> 

</div>
<div>

<?php
echo '<br /><br />now js to PHP...';
/////////////////also works java to php...
$var2 = "<script>document.write(php_y)</script>";  
echo 'VAR2 is equal php_y: '.$var2;

?> 
```

您可以[在我的服务器上查看实时测试](http://kathtak.com.br/TesteJava.php)。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-13T17:51:29.813

**tl;dr**：PHP 可以生成 Javascript，但两者不能相互或同步对话。

以下是执行“涉及” php 和 javascript 的请求时发生的情况链的简化视图：

1.  一个请求被发送到服务器（即用户在他的浏览器中输入你的脚本的 url）
2.  服务器完全处理您的 php 脚本并输出浏览器输出：html 可能还有 javascript。
3.  用户浏览器（客户端）获取 html，将其呈现在用户屏幕中，并运行页面的 javascript（如果有）。

每一步都只有在前一步完成之后才会发生，这意味着当 javascript 执行时 PHP 已经消失了；javascript 无法调用在 PHP 中声明的函数。

然而，这里要意识到的重要一点是，第 3 步取决于第 2 步，也就是说，就像最终的 html 取决于 PHP 决定输出的内容一样，javascript 也是如此。换句话说，PHP 可以动态生成 javascript，而这正是问题代码中发生的情况。

但是让我们从更实际的角度来看它。让我们来看看这个请求：

**步骤1**

请求被发送到服务器。检索以下代码以供执行：

```
<?php
$var1 = 300;
echo $var1.'echo_via_php...<br />'; //so far so good

?>
<script type="text/javascript">

document.write('PHP to JS -> <br />') ;
var x = '<?php echo $var1; ?>';
document.write('doc_write_java_X: <br />') ;
document.write(x) ;
document.write(' ( if = 300 its okay...i guess )<br />') ;

var php_y = '50'      ;

</script> 

</div>
<div>

<?php
echo '<br /><br />now js to PHP...';
/////////////////also works java to php...
$var2 = "<script>document.write(php_y)</script>";  
echo 'VAR2 is equal php_y: '.$var2;

?> 
```

**第2步**

处理 PHP 并生成以下输出并将其发送到客户端。

```
300echo_via_php...<br />
<script type="text/javascript">

document.write('PHP to JS -> <br />') ;
var x = '300';
document.write('doc_write_java_X: <br />') ;
document.write(x) ;
document.write(' ( if = 300 its okay...i guess )<br />') ;

var php_y = '50'      ;

</script> 

</div>
<div>

<br /><br />now js to PHP...
<script>document.write(php_y)</script>
VAR2 is equal php_y: <script>document.write(php_y)</script> 
```

**第 3 步**

用户浏览器收集服务器输出并运行 javascript，产生：

```
300echo_via_php...<br />
<script type="text/javascript">

document.write('PHP to JS -> <br />') ;
var x = '300';
document.write('doc_write_java_X: <br />') ;
document.write(x) ;
document.write(' ( if = 300 its okay...i guess )<br />') ;

var php_y = '50'      ;

</script> 
PHP to JS -> <br />
doc_write_java_X: <br />
300
 ( if = 300 its okay...i guess )<br />

</div>
<div>

<br /><br />now js to PHP...
<script>document.write(php_y)</script>
50
VAR2 is equal php_y: <script>document.write(php_y)</script>
50 
```

诚然，这个例子不是最容易理解的，因为我使用了原始问题中的代码，但它希望能说明这一点：PHP 只是生成稍后将由客户端读取的输出。一种语言生成另一种语言的代码可能会令人困惑，但当您将 javascript 视为文本时，它是有道理的，就像 html 一样。

# google-chrome-extension - 在 chrome 扩展中读取和写入文件

> ID：14286197
> 
> 赞同：5
> 
> 时间：2013-01-11T20:33:40.483
> 
> 标签：google-chrome-extension

我正在尝试编写一个 chrome 扩展，从配置文件中初始化一些参数。我想允许扩展更改这些参数并将它们保存到文件中，以便下次加载扩展时使用新配置。

我一直在阅读 chrome.filesystem api，但它需要用户的交互来选择文件。但是在这种情况下，该过程必须自动完成，无需用户进行任何操作。

由于此配置文件只能由扩展程序访问，因此它可以被沙盒化，但即使 chrome 关闭，它也必须是持久的。

我设法使用 XMLHttpRequest 读取文件，但找不到修改文件的方法。

是否可以通过 chrome 扩展来做到这一点？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2014-01-28T19:40:27.243

This is an old question but unfortunately the only response it got was wrong.

It's definitely possible to read and write files using HTML5 in Chrome, without the vague "security" issues mentioned. The HTML5 Filesystem creates a protected sandbox in which you write and read virtual files: you can think of it as files being written in file based database managed by Chrome and not accessible by either other Chrome apps & extensions or other OS based applications. The user won't be able to copy or move these files using his OS file explorer since they reside inside the web browser's file DB.

You can't read (or write) arbitrary files from (to) disk based on any given file path. If you need a file from disk you can only let the user select it himself by using chrome.fileSystem.chooseEntry()

You can however read (and write) your own files from (to) the HTML5 Filesystem.

So to answer your question: no you don't need user interaction to write your config file to the browser's file system. An alternative to files could be chrome storage, localstorage or even indexedDB to store your (persisted) config key-value pairs.

Here are a couple of useful links to start reading about it:

[Toying with the HTML5 filesystem](http://net.tutsplus.com/tutorials/html-css-techniques/toying-with-the-html5-filesystem-api/)

[HTML5 Rocks](http://www.html5rocks.com/en/tutorials/file/filesystem/)

[HTML5 demos](http://html5-demos.appspot.com/static/gdd11-modern-web-apps/index.html#19)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-13T13:57:14.730

我想在用户不知道的情况下允许 chrome 扩展写入配置文件可能是一个安全问题。您可能遇到了安全功能。一个潜在的解决方法是构建一个始终打开的桌面应用程序，并且您的 chrome 应用程序与之通信。哎呀，您可能可以使用自动热键之类的东西来做您需要做的事情（不知道所有细节）。

# python - 将 gevent 与金字塔一起使用

> ID：14286200
> 
> 赞同：1
> 
> 时间：2013-01-11T20:34:04.273
> 
> 标签：python, pyramid, gevent, urlopen

我正在使用金字塔建立一个网站，我想从其他网站获取一些数据。因为可能有 50+ 的调用`urlopen`，所以我想使用 gevent 来加快速度。

这是我到目前为止使用 gevent 得到的结果：

```
import urllib2    
from gevent import monkey; monkey.patch_all()
from gevent import pool

gpool = gevent.pool.Pool()

def load_page(url):
    response = urllib2.urlopen(url)
    html = response.read()
    response.close()
    return html

def load_pages(urls):
    return gpool.map(load_page, urls) 
```

运行`pserve development.ini --reload`给出：

`NotImplementedError: gevent is only usable from a single thread`.

我已经读到我需要先修补猴子补丁，但我不确定合适的地方在哪里。另外，这是特定于 pserve 的问题吗？[当我搬到mod_wsgi](http://docs.pylonsproject.org/projects/pyramid/en/latest/tutorials/modwsgi/index.html)时，我需要重新解决这个问题吗？或者有没有办法在没有 gevent 的情况下处理这个用例（只是 urlopen）？我已经看到了有关[请求](http://docs.python-requests.org/en/latest/)的建议，但我在文档中找不到获取多个页面的示例。

### 更新1：

我还尝试了[这个 SO question](https://stackoverflow.com/a/2361129/312364)中的 eventlet （几乎直接从这个 eventlet[示例](http://eventlet.net/doc/design_patterns.html#client-pattern)中复制）：

```
import eventlet
from eventlet.green import urllib2

def fetch(url):
    return urllib2.urlopen(url).read()

def fetch_multiple(urls):
    pool = eventlet.GreenPool()
    return pool.imap(fetch, urls) 
```

但是，当我打电话时`fetch_multiple`，我得到了`TypeError: request() got an unexpected keyword argument 'return_response'`

### 更新 2：

之前的`TypeError`更新可能是因为之前尝试使用 gevent 进行monkeypatch 并且没有正确重新启动 pserve。一旦我重新启动一切，它就可以正常工作。学过的知识。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-11T20:46:44.060

有多种方法可以做你想做的事：

*   创建一个专用`gevent`线程，并将所有打开 URL 的作业显式分派到该线程，然后该线程将执行 gevented`urlopen`请求。
*   使用线程而不是greenlets。运行 50 个线程不会对任何现代操作系统造成负担。
*   使用线程池和队列。同时进行 50 次下载而不是一次下载 8 次（就像您的浏览器可能那样）通常没有太大优势。
*   使用不同的异步框架`gevent`，而不是通过神奇地绿化你的代码来工作。
*   使用具有自己的非魔法异步支持的库，例如`pycurl`.
*   与其混合和匹配不兼容的框架，还不如围绕它构建服务器`gevent`，或者找到一些其他框架同时满足您的 Web 服务和 Web 客户端的需求。

您可以通过首先加载来模拟最后一个而不更改框架`gevent`，然后让它对您的线程进行猴子补丁，强制您现有的线程服务器框架成为`gevent`服务器。但这可能不起作用，或者大部分工作但偶尔会失败，或者工作但速度要慢得多......真的，使用设计为 -`gevent`友好（或至少对 greenlet 友好）的框架是一个更好的主意，如果这是你想要的方式去。

你提到其他人推荐过`requests`。您找不到文档的原因是内置的异步代码`requests`已被删除。请参阅[旧版本](http://docs.python-requests.org/en/v0.10.6/user/advanced/#asynchronous-requests)，了解它的使用方式。它现在作为一个单独的库提供，[`grequests`](https://github.com/kennethreitz/grequests). 但是，它通过隐式包装`requests`with来工作`gevent`，因此它与您自己这样做会有完全相同的问题。

（还有其他原因可以`requests`代替`urllib2`，如果您愿意，`gevent`使用它`grequests`比自己做更容易。）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-11T22:32:36.363

在尝试部署 Web 应用程序时，我遇到了与 gevent 类似的问题。您可以做的最省事的事情是使用在 gevent 上运行的 WSGI 部署；示例包括 gUnicorn、uWSGI 或 gevent 的内置 WSGI 服务器之一。Pyramid 应该有一种使用备用部署的方法。如果你的大部分代码依赖于 gevent，那么只使用在 gevent 上运行的服务器会更容易。

因此，基本上是上述答案的最后一个项目符号。

# php - Yahoo Mail POP3 设置在 PHP 或 Yahoo Interface 中都不起作用

> ID：14286201
> 
> 赞同：1
> 
> 时间：2013-01-11T20:34:07.427
> 
> 标签：php, yahoo, pop3, yahoo-mail

我首先尝试使用 PHP 以编程方式获取 Yahoo 邮件，使用标准：pop.mail.yahoo.com，使用 SSL，在端口 995 上。没有。

然后，我尝试了他们的网络界面。转到邮件选项，在雅虎，邮件帐户 - 在我当前的帐户下，我链接了另一个现有的，也是雅虎。请记住，已链接，而不是创建新的虚拟用户/邮件名称。

我点击了加号，输入上述 POP 信息，检查 SSL，将默认端口覆盖为 995，提取到收件箱，在 POP 服务器上保留一份副本，只提取新邮件。当您希望此帐户从链接的帐户中获取新邮件时，通常会这样做，对吗？就像转发一样，只有这个帐户会自动将新邮件从那个收件箱提取到这个收件箱。正确的？

如果在雅虎上有用的话，我会被诅咒的。所以，请赐教。具体来说，我对最后一个选项比对 PHP 更感兴趣。如果我得到这个，我会知道如何解决。

非常感谢。

PS：我的意思是为什么他们甚至会在菜单中提供该选项，如果它不起作用的话。他们为什么不像在转发和 POP'ed 邮件或其他任何事情上那样用 Yahoo Plus 阻止它。

# iphone - 为 UISlider 使用字符串数组

> ID：14286206
> 
> 赞同：3
> 
> 时间：2013-01-11T20:34:31.640
> 
> 标签：iphone, ios, cocoa-touch

我想用基于数组的字符串更改 UILabel。这是我到目前为止所拥有的：

```
- (IBAction) sliderValueChanged:(UISlider *)sender {
   scanLabel.text = [NSString stringWithFormat:@" %.f", [sender value]];
    NSString *wholeText = @"Very Bad";
    self.scanLabel.text = wholeText;

} 
```

而不仅仅是“非常糟糕”，我想要不同的值来显示“非常糟糕、糟糕、好的、好、非常好”。

我在哪里声明 NSMutableArray，如何使用滑块实现它？

更新：谢谢大家的帮助！（我喜欢stackoverflow）

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-11T20:40:03.497

这不是编译器检查...但您可能会有所了解。

```
NSArray *texts=[NSArray arrayWithObjects:@"very Bad", @"Bad", @"Okay", @"Good", @"Very Good",nil];
NSInteger sliderValue=[sender value]; //make the slider value in given range integer one.
self.scanLabel.text=[texts objectAtIndex:sliderValue]; 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-11T20:40:16.667

您在与上述方法相同的类中声明它。

假设它被称为`wholeTexts`.

代码将如下所示：

```
- (IBAction) sliderValueChanged:(UISlider *)sender {
    scanLabel.text = [NSString stringWithFormat:@" %.f", [sender value]];
    NSString *wholeText = [wholeTexts objectAtIndex:(wholeTexts.count - 1) * (int)(sender.value - sender.minimumValue)/(sender.maximumValue - sender.minimumValue)];
    self.scanLabel.text = wholeText;
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-11T20:40:53.013

你可以在任何你想要的地方实现数组，只要它是在你需要使用滑块之前创建的。在 iOS 中，滑块的值只能介于 0 和 1 之间，因此您需要将该值乘以某个值以获得与数组中项目数一样高的数字（减 1），并且您需要将它们转换为整数，因此您可以将该值用作数组的索引。像这样的东西：

```
- (IBAction) sliderValueChanged:(UISlider *)sender {
   scanLabel.text = [myArray objectAtIndex:(int)(sender.value * 10)];

} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-01-11T20:43:41.443

将您的文本值放入数组中

```
NSArray* array =  @[@"very Bad", @"Bad", @"Okay", @"Good", @"Very Good"]; 
```

*   将滑块设置为最小值为 0，最大值为 4
*   把你的`[sender value]`变成一个`int`，例如`floor([sender value])`

使用您的 int 从数组中选择一个项目，例如

```
NSString* result = [array objectAtIndex:myInt]; 
```

# pg-search - 如何去除查询结果的排名

> ID：14286207
> 
> 赞同：10
> 
> 时间：2013-01-11T20:34:36.227
> 
> 标签：pg-search

我的 stories.rb 模型上有以下 pg_search 范围：

```
 pg_search_scope   :with_text, 
                    :against => :title, 
                    :using => { :tsearch => { :dictionary => "english" }},
                    :associated_against => { :posts => :contents } 
```

我希望查询返回忽略任何排名的结果（我只关心故事最后更新顺序 DESC 的日期）。我知道对于大多数查看它的人来说这是一个简单的问题，但是我如何关闭 pg_search 中的排名顺序？

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2013-01-14T03:24:03.127

我是 pg_search 的作者。

你可以做这样的事情，它使用[ActiveRecord::QueryMethods#reorder](http://api.rubyonrails.org/classes/ActiveRecord/QueryMethods.html#method-i-reorder)

```
MyModel.with_text("foo").reorder("updated_at DESC") 
```

# java - 使用 Executors 服务在 Java 中创建固定大小线程池的最佳方式

> ID：14286209
> 
> 赞同：8
> 
> 时间：2013-01-11T20:34:43.027
> 
> 标签：java, multithreading, threadpool, executorservice

我正在使用`Executors`Java 中的框架为多线程应用程序创建线程池，并且我有一个与性能相关的问题。

我有一个可以在实时或非实时模式下工作的应用程序。如果它是实时的，我只是使用以下内容：

```
THREAD_POOL = Executors.newCachedThreadPool(); 
```

但如果它不是实时的，我希望能够控制我的线程池的大小。为此，我正在考虑 2 个选项，但我并不真正了解其中的区别，以及哪一个会表现得更好。

选项1是使用简单的方法：

```
THREAD_POOL = Executors.newFixedThreadPool(threadPoolSize); 
```

选项 2 是像这样创建我自己的`ThreadPoolExecutor`：

```
RejectedExecutionHandler rejectHandler = new RejectedExecutionHandler() {
@Override
public void rejectedExecution(Runnable r, ThreadPoolExecutor executor) {
    try {
        executor.getQueue().put(r);
    } catch (Exception e) {}
}
};          
THREAD_POOL = new ThreadPoolExecutor(threadPoolSize, threadPoolSize, 0, TimeUnit.SECONDS, new LinkedBlockingQueue<Runnable>(10000), rejectHandler); 
```

我想了解使用更复杂的选项 2 的优势是什么，以及我是否应该使用其他数据结构而不是`LinkedBlockingQueue`？任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2013-01-11T20:53:37.710

查看源代码你会意识到：

```
Executors.newFixedThreadPool(threadPoolSize); 
```

相当于：**_**

```
return new ThreadPoolExecutor(threadPoolSize, threadPoolSize, 0L, MILLISECONDS,
                              new LinkedBlockingQueue<Runnable>()); 
```

由于它不提供显式`RejectedExecutionHandler`，因此使用默认值`AbortPolicy`。`RejectedExecutionException`一旦队列已满，它基本上就会抛出。但是队列是无限的，所以它永远不会被填满。因此，这个执行器接受无限^个任务。

您的声明要复杂得多，而且完全不同：

*   `new LinkedBlockingQueue<Runnable>(10000)`如果等待的任务超过 10000，将导致线程池丢弃任务。

*   我不明白你`RejectedExecutionHandler`在做什么。如果池发现它不能再将任何可运行对象放入队列，它会调用您的处理程序。在此处理程序中，您...尝试再次将其`Runnable`放入队列中（这将~~99% 的案例都失败了~~堵塞）。最后你吞下了异常。似乎`ThreadPoolExecutor.DiscardPolicy`是你所追求的。

    如果任务队列太大，查看您下面的评论似乎您正试图阻止或以某种方式限制客户端。我不认为封锁内部`RejectedExecutionHandler`是一个好主意。而是考虑`CallerRunsPolicy`拒绝政策。不完全一样，但足够接近。

总结一下：如果你想限制待处理任务的数量，你的方法几乎是好的。如果要限制并发线程数，第一个线程就足够了。

^(1 - 假设 2^31 是无穷大)

# visual-studio-2012 - 基于功能的过滤规则

> ID：14286210
> 
> 赞同：1
> 
> 时间：2013-01-11T20:34:43.823
> 
> 标签：visual-studio-2012, code-analysis, fxcop, suppress-warnings, suppressmessage

我很确定我要问的是不可能的，但我希望代码分析专家能够提出解决方法。

我正在尝试找到一种`GlobalSuppressions.cs`基于功能排除代码分析警告的方法。例如，我想禁用

```
"Microsoft.Globalization", "CA1305:SpecifyIFormatProvider" 
```

在 ****all**** 我的日志记录语句中（我使用 CommonLogging 外观），因此签名将类似于：

```
Common.Logging.ILog.Trace(System.Action<Common.Logging.FormatMessageHandler>) 
```

无论类型、命名空间或方法名称如何，我都希望在整个项目中的任何地方都这样做......

看看[其他](https://stackoverflow.com/a/3260745) [答案](https://stackoverflow.com/a/2668340)，现在这似乎是不可能的......或者是吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-11T23:03:51.277

这确实是不可能的。当您调用的方法同时具有接受的重载`string`和接受的重载时，`string, IFormatProvider`将触发此规则。它可能应该，因为我希望您想要文化敏感或文化不敏感的日志文件。在这种情况下，代码分析会迫使您做出选择。

您可以做的是编写自己的规则并禁用此规则。或者您可以修复违规行为并将它们排除在外。快速的正则表达式搜索+替换可能会在几秒钟内为您解决这些问题。

或者，您可以编写一个类，充当您的代码和 Common.Logging 代码之间的代理/外观，并且只接受`string`变体。然后，您可以重构代码以使用您的方法。这样，您只需修复一个违规行为，该违规行为将保留在新创建的外观中。

# javascript - 取消 Chrome 中的“另存为”对话框

> ID：14286215
> 
> 赞同：2
> 
> 时间：2013-01-11T20:34:59.173
> 
> 标签：javascript, google-chrome, google-chrome-extension, content-disposition

如果我正在制作 Chrome 扩展程序，如果服务器强制“另存为...”对话框，我如何在新选项卡中打开图像？正如我所看到的，它与`Content-Disposition`header 属性有关。
有几十个关于如何强制浏览器打开该对话框的服务器端 Q/A，但我什么也找不到，作为最终用户如何与之抗争，谁不想要那个对话框窗口。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-12T14:00:31.090

在[[RFC 822]](http://www.ietf.org/rfc/rfc1806.txt)的扩展 BNF 表示法中，Content-Disposition 头字段定义如下：

```
 disposition := "Content-Disposition" ":"
                   disposition-type
                   *(";" disposition-parm)

    disposition-type := "inline"
                      / "attachment"
                      / extension-token
                      ; values are not case-sensitive

    disposition-parm := filename-parm / parameter

    filename-parm := "filename" "=" value; 
```

如果忽略处置参数，它只会执行以下操作。

`"content-disposition","attachment; filename=fname.jpeg"` 每次提供时下载 jpeg 文件。

`"content-disposition","inline; filename=fname.jpeg"` 显示 jpeg 文件，而不是在提供时下载 jpeg 文件。

此行为取决于浏览器和您尝试提供的文件。

例如，如果您有一个 JPEG 文件，则内联`disposition-type`将在浏览器中打开图像，而附件将强制下载。

如果您使用的是 .ZIP 文件，浏览器将无法内联显示它，因此对于内联和附件`disposition-type`，文件将被下载。

你必须使用`WebRequest API`, 来修改你的标题

### 示例代码

```
chrome.webRequest.onBeforeSendHeaders.addListener(

function (details) {//Modify Headers
    details.requestHeaders.push({
        "name": "content-disposition",
        "value": "inline; filename=`_some_filename.some_extension`"
    });
    return {//Update Headers
        requestHeaders: details.requestHeaders
    };
}, {
    urls: ["<all_urls>"]
}, ["blocking", "requestHeaders"]);//Block the requests 
```

确保您声明

```
"permissions": [
    "webRequest",
    "webRequestBlocking"
  ] 
```

在您的**清单**文件中

# 参考

*   [网络请求 API](https://developer.chrome.com/extensions/webRequest.html)

# 编辑 1

添加此代码的 URL 并检查它是否仍会引发`save as`对话框。

```
chrome.webRequest.onHeadersReceived.addListener(

function (details) {

    var _content_to_append = {
        "name": "content-disposition",
        "value": "inline"
    };
    details.responseHeaders.push(_content_to_append);
    return {
        responseHeaders: details.responseHeaders
    };
}, {
    urls: ["<all_urls>"]
}, ["blocking", "responseHeaders"]); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-09T05:29:12.973

@Sudarshan 给出了正确的方向。

但它出现在另一个网站上，这`Content-Disposition`还不够。
所以我目前的工作代码是：

```
chrome.webRequest.onHeadersReceived.addListener(
    function (details) {
        for (var i in details.responseHeaders) {
            if (details.responseHeaders[i].name == "Content-Disposition")
                details.responseHeaders[i].value = "inline; filename=\"\"";
            if (details.responseHeaders[i].name == "Content-Type")
                details.responseHeaders[i].value = "image/jpeg";
        };
        return { responseHeaders: details.responseHeaders };
    }, {
        urls: [
            "http://qwe.rty.net/*",
            "http://*.qwerty.com/*",
        ]
    }, ["blocking", "responseHeaders"]
); 
```

# java - 验证是否调用了受保护的超级方法

> ID：14286216
> 
> 赞同：7
> 
> 时间：2013-01-11T20:35:04.013
> 
> 标签：java, junit, verification, jmockit

我有以下结构：

```
class Bar{
  ....
  protected void restore(){
    ....
  }

  ....
} 
```

此类扩展`Foo`如下：

```
class Foo extends Bar{
    ....

    @Override
    public void restore(){  //valid override
        super.restore();

        ....
    }
} 
```

在我的 jUnit 测试中，我想测试何时`foo.restore()`调用，`super.restore()`随后调用。因此，下面是我的 jUnit 测试方法：

```
class FooTest{
  @Tested
  Foo _foo;

  @Test
  void testRestore(final Bar bar){

    new Expectations(){{
      bar.restore(); times = 1; // Error! bar.restore() not visible
    }};

    Deencapsulation.invoke(_foo,"restore");
  }
} 
```

不幸的是，我的测试无法编译。原因是 1)`restore()`父级是`protected`和 2)`FooTest`并`Foo`一起存在于一个单独的项目（因此是文件夹）与`Bar`.

反正有没有达到预期的测试？我已经检查了[jMockit 教程](http://jmockit.googlecode.com/svn/trunk/www/tutorial/BehaviorBasedTesting.html)（在过去几个月中多次）并且没有看到类似的测试（在 Google 上搜索也是如此）。

* * *

**更新**

在回复的帮助下，我了解到强制调用子类`super`不是最佳实践，但这不是我的实现，我*仍然*需要对其进行测试。我仍在寻找一种方法来强制执行我的 jUnit 测试以检查对父级的调用是否正在发生。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-11T20:50:59.407

所以基本上你是在尝试执行调用超级的合同并尝试允许子类化？我认为这并不容易，因为动态调度会隐藏 Java 中的行为。我不认为 Mocking 会抓住这一点。

确保调用 super 的一种方法是将 super 和扩展分解为 2 种方法，例如

```
class Foo {
  public final void restore() {
    //parent code...
    doRestore();
  }

  protected void doRestore() {
    //empty base implementation
  }
}

class Bar extends Foo {
    protected void doRestore() {
      //do my subclass specific restore stuff here
    } 
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-15T15:03:45.777

以下测试应该有效：

```
public class FooTest
{
    @Tested Foo _foo;

    @Test
    void restoreInFooCallsSuper(@Mocked final Bar bar)
    {
        new Expectations() {{
            invoke(bar, "restore");
        }};

        _foo.restore();
    }
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-11T20:47:13.403

`super.restore()`应该做一些有用的事情不是吗？一些具体的逻辑。在您的测试中，只需测试调用`super.restore()`发生的结果。

另一种研究方法如下。在执行任何操作之前，在子类中实现一个`assert`以**确保**超级正确地完成其工作。**[这是一个更强大的检查，并且作为 Meyer 的合同设计](http://en.wikipedia.org/wiki/Design_by_contract)**范式的一部分而广为人知。`super.restore()`在这种情况下，子类只是在执行之前检查实现的后置条件是否成立，并且通过使用`assert`您知道它将在单元测试期间以及在应用程序的测试集成运行期间失败，例如

```
class Foo extends Bar{
    ....

    @Override
    public void restore(){  //valid override
        super.restore();
        assert super_restore_worked_ok_condition : "restore post-condition failed";

        ....
    }
} 
```

# ruby - 如果我的 XML 文档指令指定了 UTF-8 编码，我还需要转义字符吗？

> ID：14286217
> 
> 赞同：2
> 
> 时间：2013-01-11T20:35:04.207
> 
> 标签：ruby, xml, encoding, xml-parsing, nokogiri

我知道在所有情况下我都需要逃避这些：

```
quot  "
amp   &
apos  '
lt    <
gt    > 
```

但是有口音的国际字符，或者俄罗斯字符来命名一对呢？当我的编码指令设置为 UTF-8 时，是否需要转义这种类型的字符？

如果我将编码指令设置为 ASCII 怎么办？我还需要转义所有这些角色吗？

这是我尝试使用 Nokogiri(lib2xml) 重现的 XML 示例（来自遗留系统）：

```
<?xml version="1.0" encoding="UTF-8"?>
  <DESCRIPTION lang="rus">
    <SHORT_DESCRIPTION>&#1052;&#1054;&#1044;&#1059;&#1051;&#1068;- ELECTRONIC  OUTPUT 120 V DC 5 mA</SHORT_DESCRIPTION>
    <LONG_DESCRIPTION>&#1052;&#1054;&#1044;&#1059;&#1051;&#1068;- &#1058;&#1048;&#1055; ELECTRONIC  OUTPUT &#1042;&#1061;&#1054;&#1044; 120 V DC &#1042;&#1067;&#1061;&#1054;&#1044; 5 mA &#1048;&#1057;&#1058;&#1054;&#1063;&#1053;&#1048;&#1050; &#1055;&#1048;&#1058;&#1040;&#1053;&#1048;&#1071; 120 V DC &#1044;&#1054;&#1055;&#1054;&#1051;&#1053;&#1048;&#1058;&#1045;&#1051;&#1068;&#1053;&#1040;&#1071; &#1044;&#1045;&#1058;&#1040;&#1051;&#1068; 1 ANALOG SM322-8S TOR</LONG_DESCRIPTION>
 </DESCRIPTION> 
```

您可以看到示例中的指令说 UTF-8，但它们已经转义了很多字符，Nokogiri 只有在我指定 ASCII 编码指令时才会转义的字符。这让我感到困惑。

编辑 2：如果我不向 Nokogiri 传递编码指令，则生成的 XML 会将所有俄语字符留在其本机西里尔字母中，但这与我需要复制的 XML 不一致。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-11T20:38:21.707

您只需要在以下任一情况下使用字符引用来表示字符：

*   它在当前上下文中具有特殊含义（因此您列出的五个字符有时只需要编码）
*   它在文件编码的字符编码中不存在

ASCII 中没有很多字符，因此如果您将 XML 编码为 ASCII，您将不得不对许多字符使用字符引用。

不要用 ASCII 编码你的 XML。XML 的默认编码是 UTF-8，它得到了很好的支持。

# iphone - 使用 PhoneGap 创建的 iPhone 应用程序的分辨率

> ID：14286222
> 
> 赞同：0
> 
> 时间：2013-01-11T20:35:25.050
> 
> 标签：iphone, cordova, resolution

使用 PhoneGap 将图像放入我的 iPhone 应用程序时，我遇到了一些问题。根据[这个](http://www.idev101.com/code/User_Interface/sizes.html)网站，任何 iPhone 屏幕的宽度都是 320pts。

在我的 CSS 中，我有以下代码：

```
#someId {
    position:absolute;
    top:0px; 
    left:0; 

    max-width:640px;
    max-height: auto;
} 
```

在我的 HTML 文件中，有以下代码片段：

```
<img src="image.png" id="someId" alt=""> 
```

但是，如果我这样离开，图像总是会比实际屏幕大。我正在使用 iPhone 6.0 模拟器。将值更改`max-width`为 320pt 不会改变任何内容。

这个事情谁有经验？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-11T21:30:21.263

由于许多网站的设计都假定了典型的桌面大小的浏览器窗口，因此 Mobile Safari 以 980 像素的默认宽度呈现页面。要覆盖此默认值，使其仅在屏幕宽度处呈现网站，请使用以下`<meta>`元素：

```
<meta name="viewport" content="width=device-width"> 
```

# .net - DevExpress XtraGrid LayoutView - 设置卡片大小

> ID：14286223
> 
> 赞同：1
> 
> 时间：2013-01-11T20:35:30.950
> 
> 标签：.net, winforms, devexpress, xtragrid

如何在布局视图中设置卡片大小？我用谷歌搜索了很多，但没有发现任何有用的东西。

请看下图。我想增加图片的大小（pictureedit控件的大小模式设置为squeeze）

![在此处输入图像描述](../Images/5bd210c664518e462fab910ef0a392b7.png)

还有一个问题：如何隐藏单元格中的上下按钮？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-14T05:52:35.373

[LayoutView.CardMinSize](http://help.devexpress.com/#WindowsForms/DevExpressXtraGridViewsLayoutLayoutView_CardMinSizetopic)属性指定卡片的最小尺寸。如果单个字段大小不固定，则卡片可以具有更大的大小，因此大小可变，具体取决于其内容。
相关示例：[如何在代码中创建和自定义 LayoutView](http://help.devexpress.com/#WindowsForms/CustomDocument3518)

您可以使用列的[OptionsColumn.AllowSort](http://help.devexpress.com/#WindowsForms/DevExpressXtraGridColumnsOptionsColumn_AllowSorttopic)选项 隐藏上下（[字段排序按钮）。](http://help.devexpress.com/#WindowsForms/CustomDocument3448)

**PS 我相信获得任何 DevExpress 控件的保证帮助**的最佳方式是直接联系[DevExpress 支持](http://www.devexpress.com/Support/Center)。请注意，在评估期间（30 天），完全支持是免费的。

# sql - 如果存在还是存在？

> ID：14286230
> 
> 赞同：9
> 
> 时间：2013-01-11T20:36:00.190
> 
> 标签：sql, sql-server, conditional, exists

`EXISTS`是否可以在单个`IF`SQL 语句中测试两个条件？我试过以下。

```
IF EXIST (SELECT * FROM tblOne WHERE field1 = @parm1 AND field2 = @parm2) 
   OR 
   EXIST (SELECT * FROM tblTwo WHERE field1 = @parm5 AND field2 = @parm3) 
```

我试过`IF`在那里添加额外的和括号，但无济于事。

你能帮我用正确的语法吗？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2013-01-11T20:42:13.450

如果 SQL 服务器

```
IF EXISTS (SELECT *
           FROM   tblOne
           WHERE  field1 = @parm1
                  AND field2 = @parm2)
    OR EXISTS (SELECT *
               FROM   tblTwo
               WHERE  field1 = @parm5
                      AND field2 = @parm3)
  PRINT 'YES' 
```

很好，注意唯一改变的是`EXISTS`not `EXIST`。如果第一个测试是真的，那么这个计划可能会`UNION ALL`短路。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-01-11T20:43:59.450

你错过了 EXIST 结尾的 S

存在，不**存在**

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2014-03-11T23:56:21.357

你也可以写一个 IN 语句

```
IF EXISTS (SELECT * FROM tblOne WHERE field1 = @parm1 AND field2 IN (@parm2,@parm3) 
```

# asp.net - 多视图中的 ReportViewer 在回发后不刷新

> ID：14286237
> 
> 赞同：1
> 
> 时间：2013-01-11T20:37:07.073
> 
> 标签：asp.net, reporting-services, multiview

我有一个多视图内的报告。第一个视图是标准，第二个是报告。这曾经工作得很好。我最近将项目升级到 VS2010 而没有触及报告，它继续工作。今天我将报告更新为 2010 rdlc，但它不再起作用了。

如果我将报告移出多视图并将其放在页面上的某个位置，它就可以正常工作。如何使报告在回发时加载？我在后面的代码中向我的对象数据源添加了一个参数，因此我可以看到当报告在多视图之外时，会触发选择事件；但是当报告在多视图中时它不会被触发。

当报告变得可见时，我该怎么做才能使报告在回发时加载？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-14T20:51:06.650

终于找到了有答案的地方。如果您好奇，请阅读此博客：http: [//blogs.msdn.com/b/brianhartman/archive/2010/11/16/the-invisible-reportviewer.aspx](http://blogs.msdn.com/b/brianhartman/archive/2010/11/16/the-invisible-reportviewer.aspx)

# javascript - JQuery 如果条件不能正常工作

> ID：14286240
> 
> 赞同：0
> 
> 时间：2013-01-11T20:37:11.580
> 
> 标签：javascript, jquery, css

在我的网页中，我使用 Jquery 程序为用户显示指定字段的工具提示。但我需要在其他位置显示某些字段的提示。为此，我使用了 if 条件来更改控件。但它没有按我的需要工作。我不明白其中有什么问题。编码 ：

```
 $(window).load(function(){

 /*
 Display Tooltips on hovering over the input fields if an
 alt tag is present
  */
if($('#frmail'))
    {
  $('input').hover(function()
 {
   var thisItem = $(this);
  var msgTip = thisItem.attr('alt');

   if(msgTip.length)
   {

     $('body').append('<div id="menuTooltip">\
        <p>'+  msgTip +'</p>\</div>');

    var pos = thisItem.offset();  
    var width = thisItem.width(); 
```

问题代码：

```
 if($('#frmail'))
    {
    $("#menuTooltip").css( { "left": (pos.left + 95) + "px", "top":pos.top - 110 + "px" } );
    $("#menuTooltip").fadeIn('slow');
    }
    else
        {
        $("#menuTooltip").css( { "left": (pos.left + 115) + "px", "top":pos.top - 90 + "px" } );
        $("#menuTooltip").fadeIn('slow');
        }
      }

     }, function()
    {

     $('div#menuTooltip').remove();

    });
    }
else
    {}
}); 
```

html问题代码是

```
 <!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
    <html xmlns="http://www.w3.org/1999/xhtml">
     <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
     <title>Welcome</title>
      <meta http-equiv="content-type" content="text/html; charset=UTF-8" />
      <script type='text/javascript' src='js/jquery-1.8.3.js'></script>
   <body>
  <div id="topnav" class="topnav">            
 <a href="#" class="fr"><span>Forgot Password</span></a>        
</div>  
 <div id="fr_menu">      
          <form id="fr">
                <label for="username">Username Or Email-ID</label>
                <input type="text" name="username"  id="frmail" alt="Please check your username is correct before clicking Resend." />
         <input type="submit" id="send" value=""/>
         </form>
            </div>
        <p></p>

        </div>

  </div> <!-- end .header -->

   <div class="container">
     <div class="note"></div>
   <div class="features"></div>
   <div class="reg">
  <h2>Didn't have an Account ?Create now.<center>It's Free !!</center></h2>

        <form action="login" method="post">
        <input type="text" name="fname" class="rtext" id="name" placeholder="First Nmae" alt="Enter your first name<br>Ex:<br> James P.J.<br>Enter (James)."/>

        <input type="button" value="" id="next"/>
        </form>
      </div>
     </body></html> 
```

CSS代码：

```
 #topnav a.menu-open {
background:url("img/bg.png") repeat-x #222222;
color:#666!important;
outline:none;
  }

 #fr_menu {
-moz-border-radius:5px;
-webkit-border-radius:5px;
-webkit-box-shadow: 0px 3px 4px #fff;
 -moz-box-shadow: 0px 3px 4px ;
 box-shadow: 0px 3px 4px ; display:none;
background:url("img/bg.png") repeat-x #222222;
position:absolute;
width:210px;
z-index:100;
border:1px transparent;
text-align:left;
padding:10px;
margin-left:-8px;
*margin-left:-15px;
margin-top:35px;
color:#789;
font-size:11px;
   }

    #fr_menu input[type=text]{
display:block;
-moz-border-radius:10px;
-webkit-border-radius:10px;
border-radius:10px;
border:1px solid #ACE;
  -moz-box-shadow: 0px 1px 0px #777;
  -webkit-box-shadow: 0px 1px 0px #777;
  background: #ddd url('img/inputSprite.png') no-repeat 4px 5px;
  background: url('img/inputSprite.png') no-repeat 4px 5px, -moz-linear-gradient(
       center bottom,
       rgb(225,225,225) 0%,
       rgb(215,215,215) 54%,
       rgb(173,173,173) 100%
       );
  background:  url('img/inputSprite.png') no-repeat 4px 5px, -webkit-gradient(
      linear,
      left bottom,
      left top,
      color-stop(0, rgb(225,225,225)),
      color-stop(0.54, rgb(215,215,215)),
      color-stop(1, rgb(173,173,173))
      );
  color:#333;
  text-shadow:0px 1px 0px #FFF;
font-size:13px;
margin:10px 0 5px;
padding: 7px 14px 7px 30px;
width:80%;
 }
 #menuTooltip{
  width: 160px;
  min-height:90px;
  position: absolute; display: none;
 text-align:center;
 font-family:Arial;
 font-size:12px;
 background-image:url('../images/tooltip_ao.png');
 background-repeat:no-repeat;
}

 #menuTooltip p {
 width:145px;
 margin:5px;
 height:60px;
 margin-top:10px;
   } 
```

if 条件始终执行为真。请帮我解决这个问题......

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-11T20:38:52.840

`$('#frmail')`不能是虚假的，即使没有具有该 id 的元素。

代替

```
if ($('#frmail')) 
```

和

```
if ($('#frmail').length) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-11T20:39:33.743

```
if ($('#frmail').length > 0) 
```

# android - 以编程方式创建视图

> ID：14286241
> 
> 赞同：-1
> 
> 时间：2013-01-11T20:37:19.870
> 
> 标签：android, android-view, textview

我正在以编程方式创建视图。每次我运行程序时，调试都指向我

OperationView operationView = (OperationView) getChildAt(i);

这是我的代码：

```
protected void onLayout(boolean changed, int l, int t, int r, int b) {
    int size = getWidth();
    int oneTenth = size / 10;

    int count = getChildCount();

        for (int i = 0; i < count; i++) {
            if (i%2==1){
                Log.d(null,"tile");
                TileView tileView = (TileView) getChildAt(i);
                int tleft = oneTenth * tileView.getCol();
                int ttop = oneTenth * tileView.getRow();
                int tright = oneTenth * tileView.getCol() + oneTenth;
                int tbottom = oneTenth * tileView.getRow() + oneTenth;
                tileView.layout(tleft, ttop, tright, tbottom);
                tileView.setGravity(Gravity.CENTER);
            }

            else {
                Log.d(null,"operation");
                OperationView operationView = (OperationView) getChildAt(i);
                int oleft = oneTenth * operationView.getCol();
                int otop = oneTenth * operationView.getRow();
                int oright = oneTenth * operationView.getCol() + oneTenth;
                int obottom = oneTenth * operationView.getRow() + oneTenth;
                operationView.layout(oleft, otop, oright, obottom);
                operationView.setGravity(Gravity.CENTER);
            }           
         }                      
}

@SuppressLint("NewApi")
protected class TileView extends TextView{
    private int tileType;
    private int col;
    private int row;

    protected TileView(Context context, int row, int col, int tileType) {
        super(context);
        this.col = col;
        this.row = row;
        this.tileType = tileType;

        String result = Integer.toString(RandomNumber(1,20));

        Drawable image = getResources().getDrawable(tileType);
        setBackgroundDrawable(image);
        setClickable(true);
        setText(result);
        setOnClickListener(GameView.this);          
    }

    public int getTileType(){
        return tileType;
    }

    public int RandomNumber(int min, int max){
        int Result;
        Result = (int) (Math.floor(Math.random() * (max - min + 1)) + min);
        return Result;
    }

    public void setRandomType() {
        tileType = random.nextInt(3);
        //tileType = PickRandomByChance(tileType);
        Drawable image = getResources().getDrawable(tileType);
        setBackgroundDrawable(image);
    }

    public int getCol() {
        return col;
    }

    public int getRow() {
        return row;
    }

    public void setCol(int col) {
        this.col = col;
    }

    public void setRow(int row) {
        this.row = row;
    }           
}

@SuppressLint("NewApi")
protected class OperationView extends TextView{
    private int col;
    private int row;

    @SuppressWarnings("deprecation")
    protected OperationView(Context context, int row, int col) {
        super(context);
        this.col = col;
        this.row = row;

        String result = Character.toString(randomOper());
        //String result = Integer.toString(RandomNumber(1,20));

        Drawable image = getResources().getDrawable(R.drawable.normal);
        setBackgroundDrawable(image);
        setClickable(true);
        setText(result);
        setOnClickListener(GameView.this);          
    }       

    public char randomOper() {    
          oper[0] = '+';
          oper[1] = '-';
          oper[2] = 'x';
          oper[3] = '/';

          if (rounds==3){
              weight1[0] = 60;
              weight1[1] = 20;
              weight1[2] = 20;
              weight1[3] = 0;
          }           
          else{
              weight1[0] = 50;
              weight1[1] = 30;
              weight1[2] = 10;
              weight1[3] = 10;
          }

          weightSum[0] = weight1[0];

          for (z = 1; z < 4; z++) {
              weightSum[z] = weightSum[z-1] + weight1[z];
          }

          for (j = 0; j < 1; j++) {
              k = rand.nextInt(weightSum[3]);
              for (z = 0; k > weightSum[z]; z++);
              //Log.d(null, "operation: " + oper[z]);                             
          } 
          return oper[z];
      }

    public int getCol() {
        return col;
    }

    public int getRow() {
        return row;
    }

    public void setCol(int col) {
        this.col = col;
    }

    public void setRow(int row) {
        this.row = row;
    }           
} 
```

我究竟做错了什么？我应该怎么做？

编辑：这是日志猫

01-12 04:55:05.339: E/AndroidRuntime(29253): FATAL EXCEPTION: main 01-12 04:55:05.339: E/AndroidRuntime(29253): java.lang.ClassCastException: com.jrs.math.GameView$OperationView 01-12 04:55:05.339: E/AndroidRuntime(29253): at com.jrs.math.GameView.onLayout(GameView.java:238) 01-12 04:55:05.339: E/AndroidRuntime(29253): at android.view.View.layout(View.java:7175) 01-12 04:55:05.339: E/AndroidRuntime(29253): at android.widget.LinearLayout.setChildFrame(LinearLayout.java:1254) 01-12 04:55:05.339: E/AndroidRuntime(29253): at android.widget.LinearLayout.layoutHorizontal(LinearLayout.java:1243) 01-12 04:55:05.339: E/AndroidRuntime(29253): at android.widget.LinearLayout.onLayout(LinearLayout.java:1049) 01-12 04:55:05.339: E/AndroidRuntime(29253): at android.view.View.layout(View.java:7175) 01-12 04:55:05.339: E/AndroidRuntime(29253): at android.widget.LinearLayout.setChildFrame(LinearLayout.java:1254) 01-12 04:55:05.339: E/AndroidRuntime(29253): at android.widget.LinearLayout.layoutVertical(LinearLayout.java:1130) 01-12 04:55:05.339: E/AndroidRuntime(29253): at android.widget.LinearLayout.onLayout(LinearLayout.java:1047) 01-12 04:55:05.339: E/AndroidRuntime(29253): at android.view.View.layout(View.java:7175) 01-12 04:55:05.339: E/AndroidRuntime(29253): at android.widget.FrameLayout.onLayout(FrameLayout.java:338) 01-12 04:55:05.339: E/AndroidRuntime(29253): at android.view.View.layout(View.java:7175) 01-12 04:55:05.339: E/AndroidRuntime(29253): at android.widget.FrameLayout.onLayout(FrameLayout.java:338) 01-12 04:55:05.339: E/AndroidRuntime(29253): at android.view.View.layout(View.java:7175) 01-12 04:55:05.339: E/AndroidRuntime(29253): at android.view.ViewRoot.performTraversals(ViewRoot.java:1142) 01-12 04:55:05.339: E/AndroidRuntime(29253): at android.view.ViewRoot.handleMessage(ViewRoot.java:1861) 01-12 04:55:05.339: E/AndroidRuntime(29253): at android.os.Handler.dispatchMessage(Handler.java:99) 01-12 04:55:05.339: E/AndroidRuntime(29253): at android.os.Looper.loop(Looper.java:123) 01-12 04:55:05.339: E/AndroidRuntime(29253): at android.app.ActivityThread.main(ActivityThread.java:3729) 01-12 04:55:05.339: E/AndroidRuntime(29253): at java.lang.reflect.Method.invokeNative(Native Method) 01-12 04:55:05.339: E/AndroidRuntime(29253): at java.lang.reflect.Method.invoke(Method.java:507) 01-12 04:55:05.339: E/AndroidRuntime(29253): at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:874) 01-12 04:55:05.339: E/AndroidRuntime(29253): at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:632) 01-12 04:55:05.339: E/AndroidRuntime(29253): at dalvik.system.NativeStart.main(Native Method)

EDIT: this is how i put the views

```
for (int r = 0; r < 10; r++) {
            for (int c = 0; c < 10; c++) {
                if ((r % 2) == (c % 2)) {
                    TileView tileView = new TileView(getContext(), c, r,
                            PickRandomByChance());
                    addView(tileView);
                }
                else {
                    OperationView operationView = new OperationView(getContext(), c, r);
                    addView(operationView);
                }
            }
        } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-11T20:53:39.240

as your logcat says:

```
java.lang.ArrayIndexOutOfBoundsException 
```

You are accessing a index that is not in the array.

Are you sure you have initialised your arrays. and to the right size.

```
oper = new char[4];
weight1 = new int[4];
weightSum = new int[4]; 
```

Make sure your for loops are logical, in that they dont cause a read from the wrong index.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-11T21:20:56.087

```
OperationView operationView = (OperationView) getChildAt(i);
// etc 
```

If the ViewGroup's children can either be an OperationView or TitleView, you can use `instanceof` to test which class it is and repeat the same code but cast the child to the appropriate type:

```
View view = getChildAt(i);
if(view instanceof OperationView) {
    OperationView operationView = (OperationView) view;
    // etc using operationView
}
else {
    TitleView titleView = (TitleView) view;
    // etc using titleView
} 
```

But a more robust solution is to declare an interface that has the methods `getCol()` and `getRow()` then have OperationView and TitleView implement this interface. Now your code looks like:

```
MyInterface view = (MyInterface) getChildAt(i);
// etc using view 
```

(But please use a better name than "MyInterface".)

# java - 哪个 Java IDE 创建了该项目？

> ID：14286245
> 
> 赞同：1
> 
> 时间：2013-01-11T20:37:48.783
> 
> 标签：java, ide

通过查看文件和文件夹如何知道是哪个 Java IDE 创建了 Java 项目？大多数 IDE 是否创建相同的项目文件，以便任何 IDE（Eclipse、Intellij IDEA、NetBeans 等）无需修改即可打开和执行？

我有一个我继承的项目，只是想弄清楚它是用哪个工具创建的。而已。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-11T20:41:24.823

如果您想独立于 IDE 工作，请使用[Maven](http://maven.apache.org/)。大多数 IDE 允许您导入 Maven 项目（在安装必要的插件之后），这将为该 IDE 生成正确的项目文件。大多数此类文件不应添加到源代码管理中，因此请对它们使用 svn/git ignore。

如果它有一个 .settings 文件夹，它就是 eclipse，如果它有一个 .idea 文件夹，它就是 InteiJ Idea。但这没关系，因为你不需要它们。只需在您最喜欢的 IDE 中创建一个空的 java 项目（或如上使用 Maven）并将源代码放入其中

# ios - 使用 Storyboards 时，为什么 viewWillAppear 不绘制我的子视图而 viewDidLayoutSubviews 不绘制

> ID：14286248
> 
> 赞同：2
> 
> 时间：2013-01-11T20:38:02.293
> 
> 标签：ios, objective-c

使用情节提要时，为什么不**`viewWillAppear`**绘制我的子视图，**`viewDidLayoutSubviews`**并且更重要的是要访问**`frame.size`**我必须在其中调用的子视图的子视图中**`[self.scroller layoutIfNeeded]`**的值**`viewDidLayoutSubviews`**？我有兴趣了解视图控制器的页面生命周期以及从 xibs 到故事板的变化。

![视图层次结构的屏幕截图](../Images/46c1c8aa42ef1bbf56243eee8c146274.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-11T20:44:01.760

故事板实际上是作为 xib 文件的集合实现的，其中包含有关它们之间的转换（segues）的附加信息。因此，如果我们只是在谈论单个视图控制器，那么视图控制器的生命周期应该不会有根本的不同。

如果不了解您的视图控制器及其视图层次结构是如何设置的，就很难回答您的具体问题。听起来您在滚动视图中有一个视图，并且您想知道何时可以访问其`frame`属性。

UIKit 遵循以下步骤（大致）：

1.  它加载 storyboard/xib 文件中描述的所有视图，并根据需要连接所有动作​​和出口。`viewDidLoad`在这一步之后调用。
2.  它调用`viewWillAppear:`以指示它即将显示视图。
3.  它将视图添加到窗口，调整大小以适合。尺寸调整会沿视图层次结构传播，因此每个视图都会布置其子视图（如果将其配置为自动调整子视图大小）。这些更改发生在动画块内，因此一旦设置好所有内容，用户就会看到新视图动画到位。
4.  一旦动画完成，`viewDidAppear:`就会被调用。

如果视图`autoresizesSubviews`设置为`NO`;你可能会看到一些奇怪的东西 这可能就是你必须打电话`layoutIfNeeded`的原因`self.scroller`。请注意，文档`layoutIfNeeded`说：

> 收到此消息后，将遍历该层的超层，直到找到不需要布局的祖先层。然后在该祖先下的整个层树上执行布局。

所以它可能会触发其他不相关视图的布局。

# php - 从控制器 JSON 传递一个值以在 CodeIgniter 中查看 Ajax

> ID：14286253
> 
> 赞同：1
> 
> 时间：2013-01-11T20:38:21.717
> 
> 标签：php, jquery, ajax, json, codeigniter

问题是我得到了 false 对话框，但查询运行良好并且值已成功添加到数据库中。它应该打印正确，但它给了我一个错误。我通过[Firebug](http://en.wikipedia.org/wiki/Firebug_%28software%29)也检查了 res = 1 的值，但我不知道它有什么问题。

我的观点：

```
$.ajax({
    url: "<?php echo site_url('itemsController/additems'); ?>",
    type: 'POST',
    data: form_data,
    success: function(msg) {
        if(msg.res == 1)
        {
            alert(true);
        }
        else
        {
            alert(false);
        }
    }
}); 
```

控制器：

```
 $result = array();
        $this->load->model('itemsModel');
        $query = $this->itemsModel->addItemstoDB($data);

        if ($query){  //&& any other condition
            $result['res'] = 1;
        }
        else
        {
            $result['res'] = 0;
        }
        echo json_encode($result); //At the end of the function.
    }
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-11T20:52:10.573

尝试将您设置`dataType`为，`json`以便从服务器发回的数据被解析为[JSON](http://en.wikipedia.org/wiki/JSON)。

```
$.ajax({
    url: "<?php echo site_url('itemsController/additems'); ?>",
    type: 'POST',
    data: form_data,
    dataType: 'json',
    success: function(msg) {
        if(msg.res == 1) {
            alert(true);
        }
        else
        {
            alert(false);
        }
    }
}); 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-01-11T20:44:32.883

通知退货。

```
 if ($query){
        $result['res'] = 1;
    }
    else 
    {
        $result['res'] = 0;
    }
    return json_encode($result);//at the end of the function.
} 
```

# javascript - 形状的 KineticJS 周边碰撞检测

> ID：14286254
> 
> 赞同：2
> 
> 时间：2013-01-11T20:38:23.933
> 
> 标签：javascript, kineticjs

我有两个形状，都是圆形，它们在舞台上移动。当他们到达舞台时，他们只是从舞台的边界反弹。他们从不做的是碰撞，这是我想添加一些逻辑的东西。据我所知，

```
shape1.intersects(shape2.getPosition()); 
```

但这并没有真正接近我想要实现的目标，即周边碰撞检测，而不仅仅是一个点处于另一种形状。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-29T17:02:28.510

尝试简单的边界框碰撞检测：

```
function doObjectsCollide(a, b) { // a and b are your objects
   return !(
    ((a.getY() + a.getHeight()) < (b.getY())) ||
    (a.getY() > (b.y + b.getHeight())) ||
    ((a.getX() + a.getWidth()) < b.getX()) ||
    (a.getX() > (b.getX() + b.getWidth()))
   );
} 
```

# php - 尝试访问 Laravel 4 中的关系数据时出错

> ID：14286255
> 
> 赞同：0
> 
> 时间：2013-01-11T20:38:29.167
> 
> 标签：php, laravel, eloquent, blade

我已经使用 Laravel 4 几天了，我偶然发现了一些我似乎无法修复的东西。

使用 Eloquent，我设置了 2 个模型，其中`Appointment`与`belongsTo`. `Room`像这样检索它之后（使用急切加载）：

```
$appointments = Appointment::with('room')->get(); 
```

我在我看来打印它：http: [//paste.laravel.com/fnL](http://paste.laravel.com/fnL)

我遍历它并检索 Appointment 的值：

```
@foreach($appointments as $appointment)
    <tr>
        <td>{{ $appointment->begins_at }}</td>
        <td>
            <a href="/admin/appointments/delete/{{ $appointment->id }}" class="btn btn-mini btn-danger">Verwijderen</a>
        </td>
    </tr>
@endforeach 
```

这很好用，但是当我添加以下行时：

```
<td>{{ $appointment->room->name }}</td> 
```

它抛出以下错误：

```
ErrorException: Notice: Trying to get property of non-object 
```

我可能只是忽略了一些东西，但我已经看了很长一段时间了，但我只是没有看到它......

提前感谢您的帮助！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-11T20:44:19.200

集合中的第二个约会没有房间，因此，`$appointment->room`是`null`，所以你基本上在做`null->name`

![在此处输入图像描述](../Images/d04bc0dac9cc8177b83bb1ce46dc96e2.png)

解决方法是检查房间是否设置好了。

```
@if($appointment->room)
    {{ $appointment->room->name }}
@endif 
```

希望有帮助

# hadoop - 从 MapReduce 作业向 Hive 添加分区

> ID：14286256
> 
> 赞同：3
> 
> 时间：2013-01-11T20:38:30.350
> 
> 标签：hadoop, mapreduce, hive, partitioning

我是 Hive 和 MapReduce 的新手，非常感谢您的回答并提供正确的方法。

我`logs`在配置单元中定义了一个外部表，该表在日期和源服务器上分区，外部位置在 hdfs 上`/data/logs/`。我有一个 MapReduce 作业，它获取这些日志文件并将它们拆分并存储在上述文件夹下。喜欢

```
"/data/logs/dt=2012-10-01/server01/"
"/data/logs/dt=2012-10-01/server02/"
...
... 
```

从 MapReduce 作业中，我想将分区添加到 Hive 中的表日志中。我知道这两种方法

1.  alter table 命令 -- 太多的 alter table 命令
2.  添加动态分区

对于方法二，我只看到`INSERT OVERWRITE`不适合我的示例。有没有办法在作业结束后将这些新分区添加到表中？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-11T22:24:07.893

要在 Map/Reduce 作业中执行此操作，我建议使用 Apache HCatalog，这是一个在 Hadoop 下标记的新项目。

HCatalog 确实是 HDFS 之上的抽象层，因此您可以以标准化的方式编写输出，无论是来自 Hive、Pig 还是 M/R。对您来说，这就是您可以使用输出格式从 Map/Reduce 作业直接加载 Hive 中的数据的地方`HCatOutputFormat`。下面是一个取自[官网](http://incubator.apache.org/hcatalog)的例子。

为 (a=1,b=1) 写出特定分区的当前代码示例将如下所示：

```
Map<String, String> partitionValues = new HashMap<String, String>();
partitionValues.put("a", "1");
partitionValues.put("b", "1");
HCatTableInfo info = HCatTableInfo.getOutputTableInfo(dbName, tblName, partitionValues);
HCatOutputFormat.setOutput(job, info); 
```

并且要写入多个分区，必须使用上述每个分区启动单独的作业。

您还可以将动态分区与 HCatalog 一起使用，在这种情况下，您可以在同一个作业中加载任意数量的分区！

我建议在上面提供的网站上进一步阅读 H​​Catalog，如果需要，它会为您提供更多详细信息。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2014-04-22T00:06:12.110

实际上，事情比这要复杂一些，这很不幸，因为它在官方来源中没有记录（截至目前），而且需要几天的挫折才能弄清楚。

我发现我需要执行以下操作才能让 HCatalog Mapreduce 作业与写入动态分区一起工作：

在我工作的记录写入阶段（通常是 reducer），我必须手动将我的动态分区（HCatFieldSchema）添加到我的 HCatSchema 对象中。

问题是 HCatOutputFormat.getTableSchema(config) 实际上并没有返回分区字段。它们需要手动添加

```
HCatFieldSchema hfs1 = new HCatFieldSchema("date", Type.STRING, null);
HCatFieldSchema hfs2 = new HCatFieldSchema("some_partition", Type.STRING, null);
schema.append(hfs1);
schema.append(hfs2); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-10-30T14:13:02.017

这是使用 HCatalog 在一项作业中写入具有动态分区的多个表的代码，该代码已在 Hadoop 2.5.0、Hive 0.13.1 上进行了测试：

```
// ... Job setup, InputFormatClass, etc ...
String dbName = null;
String[] tables = {"table0", "table1"};

job.setOutputFormatClass(MultiOutputFormat.class);
MultiOutputFormat.JobConfigurer configurer = MultiOutputFormat.createConfigurer(job);

List<String> partitions = new ArrayList<String>();
partitions.add(0, "partition0");
partitions.add(1, "partition1");

HCatFieldSchema partition0 = new HCatFieldSchema("partition0", TypeInfoFactory.stringTypeInfo, null);
HCatFieldSchema partition1 = new HCatFieldSchema("partition1", TypeInfoFactory.stringTypeInfo, null);

for (String table : tables) {
    configurer.addOutputFormat(table, HCatOutputFormat.class, BytesWritable.class, CatRecord.class);

    OutputJobInfo outputJobInfo = OutputJobInfo.create(dbName, table, null);
    outputJobInfo.setDynamicPartitioningKeys(partitions);

    HCatOutputFormat.setOutput(
        configurer.getJob(table), outputJobInfo
    );

    HCatSchema schema = HCatOutputFormat.getTableSchema(configurer.getJob(table).getConfiguration());
    schema.append(partition0);
    schema.append(partition1);

    HCatOutputFormat.setSchema(
        configurer.getJob(table),
        schema
    );
}
configurer.configure();

return job.waitForCompletion(true) ? 0 : 1; 
```

映射器：

```
public static class MyMapper extends Mapper<LongWritable, Text, BytesWritable, HCatRecord> {
    @Override
    protected void map(LongWritable key, Text value, Context context) throws IOException, InterruptedException {
        HCatRecord record = new DefaultHCatRecord(3); // Including partitions
        record.set(0, value.toString());

        // partitions must be set after non-partition fields
        record.set(1, "0"); // partition0=0
        record.set(2, "1"); // partition1=1

        MultiOutputFormat.write("table0", null, record, context);
        MultiOutputFormat.write("table1", null, record, context);
    }
} 
```

# javascript - Arbor.js 查询

> ID：14286257
> 
> 赞同：2
> 
> 时间：2013-01-11T20:38:38.923
> 
> 标签：javascript, jquery, json, arbor.js

我一直在使用 arbor.js，需要帮助解决几个问题。我能够创建一个基于数据库的图表，一个基本图表。现在，我需要做的是，单击节点并获取节点数据并将其显示在侧面。也有一个有向边。所以，问题是

1.  我的 mousedown 功能不起作用。要么它完全不起作用，要么如果它起作用，当我单击一个节点时它会自动拖动，即它被连接到鼠标上并且我无法释放它。我想要做的是当我单击节点时，我需要在侧面显示节点详细信息。节点详细信息在另一个页面上，可以作为 json 检索。我的鼠标处理代码如下

    ```
    initMouseHandling:function(){
    // no-nonsense drag and drop (thanks springy.js)
    var dragged = null;

    // set up a handler object that will initially listen for mousedowns then
    // for moves and mouseups while dragging
    var handler = {
      clicked:function(e){
        var pos = $(canvas).offset();
        _mouseP = arbor.Point(e.pageX-pos.left, e.pageY-pos.top)
        dragged = particleSystem.nearest(_mouseP);

        var d = document.getElementById("infoDiv");

        if (dragged && dragged.node !== null){
          // while we're dragging, don't let physics move the node
          dragged.node.fixed = true
        }
        ///document.getElementById('detailBox').innerHTML=selected.node.name;

        $(canvas).bind('mousemove', handler.dragged)
        $(window).bind('mouseup', handler.dropped)
        $(canvas).bind('mousedown', handler.clicked)    

        return false
      },
      dragged:function(e){
        var pos = $(canvas).offset();
        var s = arbor.Point(e.pageX-pos.left, e.pageY-pos.top)

        if (dragged && dragged.node !== null){
          var p = particleSystem.fromScreen(s)
          dragged.node.p = p
        }

        return false
      },

      dropped:function(e){
        if (dragged===null || dragged.node===undefined) return
        if (dragged.node !== null) dragged.node.fixed = false
        dragged.node.tempMass = 1000
        dragged = null
        $(canvas).unbind('mousemove', handler.dragged)
        $(window).unbind('mouseup', handler.dropped)
        _mouseP = null
        return false
      }

      clicked:function(e){
        var pos = $(this).offset();
        var p = {x:e.pageX-pos.left, y:e.pageY-pos.top}
        selected = nearest = dragged = particleSystem.nearest(p);
        var nodeAddress = "http://localhost:7474/db/data/node/" + selected.node.name;

        if (selected.node !== null){
        // dragged.node.tempMass = 10000
            dragged.node.fixed = false;
            //$(canvas).unbind('mousemove', handler.dragged)        
        }
        //document.getElementById('detailBox').innerHTML=selected.node.name;
        getData(nodeAddress);
        //alert(nodeData.self);
        return false;

      }
    }

    //My click function
    //$(canvas).mousedown(function(e){

    //}); 
    ```

    },

    }

上面的代码根本不起作用，我也是 jQuery 新手，因此我无法弄清楚错误，最后一个函数点击，试图做的是在点击一个节点时，从另一个页面并显示它。这里的功能完全失败。在我这样尝试之前，

```
 //My click function
    $(canvas).mousedown(function(e){
        var pos = $(this).offset();
        var p = {x:e.pageX-pos.left, y:e.pageY-pos.top}
        selected = nearest = dragged = particleSystem.nearest(p);
        var nodeAddress = "http://localhost:7474/db/data/node/" + selected.node.name;

        if (selected.node !== null){
        // dragged.node.tempMass = 10000
            dragged.node.fixed = false;
            //$(canvas).unbind('mousemove', handler.dragged)        
        }
        //document.getElementById('detailBox').innerHTML=selected.node.name;
        getData(nodeAddress);
        //alert(nodeData.self);
        return false;
    });

    // start listening
    $(canvas).mousedown(handler.clicked); 
```

这出现在处理程序变量之外，因此 javascript 工作正常，并在侧面显示节点号。但我无法查询并获取 json。图表也被固定在了尖端。

这是尝试的方法吗？否则我怎么能完成它。很抱歉这个大问题和无意的错误格式，这是我在这里的第一篇文章。

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-13T19:16:03.833

我的处理程序的以下代码适用于我。YMMV。

`clicked`我没有函数，而是将 a `down`which 映射到 a`dropped`和`dragged`。
我还包含了一个`move`变量，该变量在`dropped`函数中用于指示节点是实际被单击还是只是被拖动。

希望这会有所帮助！

```
initMouseHandling:function(){
// no-nonsense drag and drop (thanks springy.js)
selected = null;
nearest = null;
var dragged = null;
var move = false;

// set up a handler object that will initially listen for mousedowns then
// for moves and mouseups while dragging
var handler = {
  moved:function(e){
    var pos = $(canvas).offset();
    _mouseP = arbor.Point(e.pageX-pos.left, e.pageY-pos.top);
    nearest = particleSystem.nearest(_mouseP);

    if(!nearest.node){
        return false;
    }

    selected = (nearest.distance < nearest.node.data.radius) ? nearest : null

    // code for node that mouse is hovered on ('selected')

  },
  down:function(e){
    var pos = $(canvas).offset();
    _mouseP = arbor.Point(e.pageX-pos.left, e.pageY-pos.top)
    nearest = dragged = particleSystem.nearest(_mouseP);
    move = false;

    if (dragged && dragged.node !== null){
        dragged.node.fixed = true
    }

    $(canvas).bind('mousemove', handler.dragged)
    $(window).bind('mouseup', handler.dropped)

    return false
  },
  dragged:function(e){
    var old_nearest = nearest && nearest.node._id
    var pos = $(canvas).offset();
    var s = arbor.Point(e.pageX-pos.left, e.pageY-pos.top)
    move = true;

    if (!nearest) return
    if (dragged !== null && dragged.node !== null){
      var p = particleSystem.fromScreen(s)
      dragged.node.p = p
    }

    return false
  },

  dropped:function(e){
    var edit = $("#edit").prop('checked')
    if (dragged===null || dragged.node===undefined) return
    if (dragged.node !== null) {
        if(move===false) {

            // code for clicked node (dragged.node)

        }
        dragged.node.fixed = false
    }
    dragged.node.tempMass = 1000
    dragged = null
    selected = null
    $(canvas).unbind('mousemove', handler.dragged)
    $(window).unbind('mouseup', handler.dropped)
    _mouseP = null
    return false
  }
}

$(canvas).mousedown(handler.down);
$(canvas).mousemove(handler.moved);
} 
```

# sublimetext2 - 使用键盘滚动？

> ID：14286259
> 
> 赞同：17
> 
> 时间：2013-01-11T20:38:43.253
> 
> 标签：sublimetext2

如何使用键盘上下滚动文件？我尝试了箭头键和不同的修饰符。

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2013-01-11T20:48:33.577

如果您查看程序的默认键绑定（在 Mac 版本上，这是在菜单“Sublime Text 2/Preferences/Key Bindings - Default”中），您可以看到所有键盘快捷键是什么。

我找到了“滚动”并找到了这些行：

```
{ "keys": ["ctrl+alt+up"], "command": "scroll_lines", "args": {"amount": 1.0} },
{ "keys": ["ctrl+alt+down"], "command": "scroll_lines", "args": {"amount": -1.0} }, 
```

因此，`ctrl+alt+up`并且`ctrl+alt+down`一次将视图向上和向下滚动 1 行。如果要更改此设置，请将这些行复制到“Key Bindings - User”文件中并更改该行的相应部分。

# c++ - GetCheck() 适用于检查按钮但不适用于单选按钮？

> ID：14286264
> 
> 赞同：0
> 
> 时间：2013-01-11T20:38:54.460
> 
> 标签：c++, visual-studio-2010, mfc

我只是在学习如何在 Visual Studio 2010 中使用 MFC 制作对话框。

从我[在 msdn 网站上看到的](http://msdn.microsoft.com/en-us/library/8tba1y6f%28v=vs.80%29.aspx)内容来看，GetCheck() 函数对于复选框和单选按钮的工作方式应该相同。

基本上我在两个滑块旁边有两个单选按钮。如果一个单选按钮打开，则该滑块被禁用，如果另一个单选按钮打开，则另一个滑块被禁用。

当我为复选框切换单选按钮时，这是我使用的代码：

```
void Cstring_copyierDlg::OnBnClickedSld1chk()
{

    UINT nCheck = m_slide1check.GetCheck();

    if(nCheck == BST_CHECKED){
        m_slider.EnableWindow(FALSE);
    }
    else{
        m_slider.EnableWindow(TRUE);
    } 
```

}

```
void Cstring_copyierDlg::OnBnClickedSld2chk()
{
    UINT nCheck = m_slide2check.GetCheck();

    if(nCheck == BST_CHECKED){
        m_slider2.EnableWindow(FALSE);
    }
    else{
        m_slider2.EnableWindow(TRUE);
    } 
```

}

这段代码运行良好。但是当我关闭单选按钮的复选框时，这是我使用的代码：

```
void Cstring_copyierDlg::OnBnClickedRad1()
{

    UINT nCheck = m_radio1.GetCheck();

    if(nCheck == BST_CHECKED){
        m_slider.EnableWindow(FALSE);
    }
    else{
        m_slider.EnableWindow(TRUE);
    } 
```

}

```
void Cstring_copyierDlg::OnBnClickedRad2()
{
    UINT nCheck = m_radio2.GetCheck();

    if(nCheck == BST_CHECKED){
        m_slider2.EnableWindow(FALSE);
    }
    else{
        m_slider2.EnableWindow(TRUE);
    } 
```

}

但是，第二段代码在编译时返回以下错误：

```
error C2228: left of '.GetCheck' must have class/struct/union 
```

是什么赋予了？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-11T20:43:55.547

您在添加变量向导中为 DDX 选择了错误的变量类型。您应该在那里选择控件类型。

要手动更改变量类型，请将 m_radio1 的类型替换为 CButton，并将 DoDataExchange 中的 DDX_Radio 替换为 DDX_Control。

# openssl - 如何将 SSL_CERT_FILE 用于 OpenSSL Windows (OpenSSL 1.0.1c)

> ID：14286265
> 
> 赞同：5
> 
> 时间：2013-01-11T20:39:00.673
> 
> 标签：openssl, windows-applications

如何（如果有的话）使用 SSL_CERT_FILE 环境变量在 Windows（Win-7、OpenSSL 1.0.1c）上为 OpenSSL 定义一个受信任的证书文件？

各种研究使我下载了 PEM 格式的 Mozilla 受信任证书的 12 月版本，从这里：[http](http://curl.haxx.se/docs/caextract.html) ://curl.haxx.se/docs/caextract.html 这包含所有的证书和各种相关信息连接在一起一个文件。

对于依赖 OpenSSL 的其他产品，我发现了各种关于环境变量 SSL_CERT_DIR 和 SSL_CERT_FILE 使用的参考。例如， http: [//lynx.isc.org/current/README.sslcerts](http://lynx.isc.org/current/README.sslcerts)表示可以同时设置这两个，并且底层的 OpenSSL 库将使用它们。但是，这并不是我对 OpenSSL 工具本身的体验。

我能够成功使用 SSL_CERT_DIR，但非常痛苦，如下所示。我从 www.wellsfargo.com（随机选择）导出（从 IE 8）证书，以及其信任链中的两个证书，均来自 Verisign。我将两个 Verisign 证书中的每一个都放在目录 C:\ca_stuff 中，并为每个证书生成一个哈希值

openssl x509 -hash -noout -in "Verisign Intl Server.cer"

它输出了a302054c，并由此创建了一个链接

mklink a302054c.0 "Verisign Intl Server.cer"

同样适用于其他 Verisign 证书。然后我把富国银行的证书。在不同的目录中，并且能够使用成功验证它

设置 SSL_CERT_DIR=C:\ca_stuff openssl 验证“富国银行 web.cer”

但是，在定义 SSL_CERT_FILE 后，指向从 cURL 站点下载的 cacert.pem，相同的命令失败。无论是否定义了 SSL_CERT_DIR，它都是这样做的。我验证了捆绑包中是否包含必要的 CA 证书，并确认它们的序列号与我从 IE 中手动提取的序列号匹配。

手动提取每个证书并将其放入自己的文件中并带有指向它的哈希链接似乎是一个艰巨的过程。如果这是 Unix，我可以自动化它，但是在 Windows 上......我显然误解了如何让一个大型 CA 证书文件与 OpenSSL 一起使用。

提前感谢您的任何建议、见解和帮助。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-10-02T19:24:41.677

> 如何（如果有的话）为 OpenSSL 定义一个受信任的证书文件

CAFile 只是您信任并想要使用的自签名证书的串联。如果您只想信任一个，那么 CA 文件中应该只有一个。

我更喜欢 PEM 编码，因为它更易于使用文本编辑器（`-----BEGIN CERTIFICATE-----`和`-----END CERTIFICATE-----`）进行检查。例如，这是来自 Startcom ( [http://www.startssl.com/certs/](http://www.startssl.com/certs/) ) 的 ca-bundle.pem：

![Startcom 的 ca-bundle.pem 文件的图像](../Images/20cc152f99c5903ab6bb1b41ea954206.png)

因此，要创建一个，只需使用`cat`和重定向（或复制和粘贴）：

```
# Empty my-ca-file.pem
echo "" > my-ca-file.pem
# Add Startcom certs
cat startcom-ca-bundle.pem >> my-ca-file.pem
# Add others as desired
... 
```

* * *

> 各种研究使我下载了 PEM 格式的 Mozilla 受信任证书的 12 月 '12 版本...

嗯，这是您可以使用的列表之一。当您使用 Mozilla 的列表时，您是在说“我相信 Mozilla 会做正确的事”。请记住，当 Trustwave 被发现拦截 SSL/TLS 流量时，Mozilla 奖励了 Trustwave 的不良行为。尽管 Trustwave 至少违反了两项包含政策，但 Mozilla 仍继续将其包含在内，因为 Trustwave 承诺不再这样做。有关详细信息，请参阅[从受信任的根证书](https://bugzilla.mozilla.org/show_bug.cgi?id=724929)中删除 Trustwave 证书。

如果您不相信 Mozilla 的判断，那么您可以使用 OpenSSL 的内置列表`/usr/lib/ssl/certs/ca-certificates.crt`，使用另一个列表（大多数主要供应商都有），或者构建您自己的列表。

使用不同的供应商名单通常相当于用你认识的魔鬼换你不认识的魔鬼。例如，Apple 有一个您可以在[iOS 上检查的列表：可用的受信任根证书列表 (iOS 7)](http://support.apple.com/kb/HT5012)。但是苹果的列表有很多问题：[http](http://seclists.org/fulldisclosure/2013/Sep/186) ://seclists.org/fulldisclosure/2013/Sep/186和[http://seclists.org/fulldisclosure/2013/Sep/184](http://seclists.org/fulldisclosure/2013/Sep/184)。

我建议建立自己的列表或固定证书。固定证书或公钥更好，因为它消除了 SSL/TLS 中允许 Trustwave 做他们所做的事情的系统性问题。有关详细信息，请参阅 OWASP 的[证书和公钥固定](https://www.owasp.org/index.php/Certificate_and_Public_Key_Pinning)。

* * *

> ...在 Windows（Win-7，OpenSSL 1.0.1c）上使用`SSL_CERT_FILE`环境变量？

我不知道如何通过环境变量来做到这一点，因为我不使用它们。但是 Linux/Unix/OSX/Windows 之间应该没有区别（可能除了对长文件名和空格的处理）。

查看 OpenSSL 源代码，您有以下内容`cryptlib.h`：

```
#define X509_CERT_FILE_EVP       "SSL_CERT_FILE" 
```

`x509_def.c`用途`X509_CERT_FILE_EVP`：

```
const char *X509_get_default_cert_file_env(void)
    { return(X509_CERT_FILE_EVP); } 
```

`X509_get_default_cert_file_env`用于：`by_file.c`_`by_file_ctrl`

```
...
switch (cmd)
{
    case X509_L_FILE_LOAD:
        if (argl == X509_FILETYPE_DEFAULT)
        {
            file = (char *)getenv(X509_get_default_cert_file_env());
            if (file)
                ok = (X509_load_cert_crl_file(ctx,file,
                                              X509_FILETYPE_PEM) != 0);

            else
                ok = (X509_load_cert_crl_file(ctx,X509_get_default_cert_file(),
                                              X509_FILETYPE_PEM) != 0);

            if (!ok)
            {
                X509err(X509_F_BY_FILE_CTRL,X509_R_LOADING_DEFAULTS);
            }
        }
        else
        {
            if(argl == X509_FILETYPE_PEM)
                ok = (X509_load_cert_crl_file(ctx,argp,
                                              X509_FILETYPE_PEM) != 0);
            else
                ok = (X509_load_cert_file(ctx,argp,(int)argl) != 0);
        }
        break;
}
return(ok); 
```

因此，在使用`SSL_CERT_FILE`.

最后，确保`SSL_CERT_FILE`没有被配置文件设置覆盖。有关详细信息，请参阅[OpenSSL 配置 (5)](http://www.openssl.org/docs/apps/config.html)。

* * *

> 手动提取每个证书并将其放入自己的文件中并带有指向它的哈希链接似乎是一个艰巨的过程。

我认为您在使用 , 或 时不需要`SSL_CERT_FILE`重新`-CAfile`散列`SSL_CTX_load_verify_locations`。

`-CAfile`使用or时我从来没有重复过`SSL_CTX_load_verify_locations`，一切都很好。当事情破裂时，通常是因为（1）根证书不存在或不可信；(2) 没有中间证书。

对于上面的第 (2) 项，您需要服务器发送所有必需的证书来构建链。否则，客户将不知道到哪里寻找丢失的中间证书。是 PKI 中一个众所周知的问题，称为“哪个目录”问题（客户端不知道要在哪个 X500 目录中搜索丢失的证书）。

* * *

相关的，这里是如何在 OpenSSL 的`s_client`. `-CAfile`这实际上有效，因为 pagepeeker.com 使用 StartCom，如果您省略该选项，它将失败：

```
$ echo "GET / HTTP\1.1" | openssl s_client -connect api.pagepeeker.com:443 -CAfile startcom-ca-bundle.pem
CONNECTED(00000003)
depth=2 C = IL, O = StartCom Ltd., OU = Secure Digital Certificate Signing, CN = StartCom Certification Authority
verify error:num=19:self signed certificate in certificate chain
verify return:0
---
Certificate chain
 0 s:/description=8CTO6gSuxeRRsIXl/C=RO/CN=api.pagepeeker.com/emailAddress=alexandru.florescu@gmail.com
   i:/C=IL/O=StartCom Ltd./OU=Secure Digital Certificate Signing/CN=StartCom Class 1 Primary Intermediate Server CA
 1 s:/C=IL/O=StartCom Ltd./OU=Secure Digital Certificate Signing/CN=StartCom Class 1 Primary Intermediate Server CA
   i:/C=IL/O=StartCom Ltd./OU=Secure Digital Certificate Signing/CN=StartCom Certification Authority
 2 s:/C=IL/O=StartCom Ltd./OU=Secure Digital Certificate Signing/CN=StartCom Certification Authority
   i:/C=IL/O=StartCom Ltd./OU=Secure Digital Certificate Signing/CN=StartCom Certification Authority
---
Server certificate
-----BEGIN CERTIFICATE-----
MIIGZTCCBU2gAwIBAgIDCJkoMA0GCSqGSIb3DQEBBQUAMIGMMQswCQYDVQQGEwJJ
TDEWMBQGA1UEChMNU3RhcnRDb20gTHRkLjErMCkGA1UECxMiU2VjdXJlIERpZ2l0
... 
```

* * *

以及做C编程时的相关代码。这是我用来设置 SSL/TLS 连接的代码的一部分（除了公钥固定）：

```
int ret = 0;
unsigned long ssl_err = 0;
SSL_CTX* ctx = NULL;

do
{
    ret = SSL_library_init();
    ssl_err = ERR_get_error();
    if(!(1 == ret))
    {
        display_error("SSL_library_init", ssl_err);
        break; /* failed */
    }

    /* SSLv23_method() is 'everything' */
    const SSL_METHOD* method = SSLv23_method();
    ssl_err = ERR_get_error();
    if(!(NULL != method))
    {
        display_error("SSLv23_method", ssl_err);
        break; /* failed */
    }

    /* http://www.openssl.org/docs/ssl/ctx_new.html */
    ctx = SSL_CTX_new(method);
    ssl_err = ERR_get_error();
    if(!(ctx != NULL))
    {
        display_error("SSL_CTX_new", ssl_err);
        break; /* failed */
    }

    /* Enable standard certificate validation and our callback */
    /* https://www.openssl.org/docs/ssl/ctx_set_verify.html */
    SSL_CTX_set_verify(ctx, SSL_VERIFY_PEER, my_verify_cb);
    /* Cannot fail ??? */

    /* Remove most egregious */
    const long flags = SSL_OP_ALL | SSL_OP_NO_SSLv2 | SSL_OP_NO_SSLv3 | SSL_OP_NO_COMPRESSION;
    long old_opts = SSL_CTX_set_options(ctx, flags);
    UNUSED(old_opts);

    /* http://www.openssl.org/docs/ssl/SSL_CTX_load_verify_locations.html */
    ret = SSL_CTX_load_verify_locations(ctx, "startcom-ca-bundle.pem", NULL);
    ssl_err = ERR_get_error();
    if(!(1 == ret))
        display_warning("SSL_CTX_load_verify_locations", ssl_err);

} while(0);

// Use context
return ctx; 
```

`SSL_CTX_load_verify_locations`如果失败了也没关系。这意味着你不会信任任何东西，所以你失败了关闭或关闭。

# deployment - 从 git repo 的子目录在 Heroku 上部署 Play 应用

> ID：14286266
> 
> 赞同：5
> 
> 时间：2013-01-11T20:39:24.130
> 
> 标签：deployment, heroku, playframework-2.0

我想在 Heroku 上部署一个 Play 2.0.4 应用程序，`git push heroku master`但我已将 play 根文件夹移动到我的 git repo 的子文件夹中。有没有办法从那里部署？

目前它错误地将我的项目识别为 1.2.4 Play 应用程序，然后编译和部署失败。

```
-----> Play! app detected
-----> WARNING: Play! version not specified in dependencies.yml. Default version: 1.2.4 being used....
-----> Installing Play! 1.2.4.....
-----> done
-----> Installing ivysettings.xml..... done
-----> Building Play! application... 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-11T22:03:06.967

安装这个 git 插件。

[https://github.com/apenwarr/git-subtree](https://github.com/apenwarr/git-subtree)

运行“git subtree push --prefix **subfolder with app”heroku master”

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-11T22:01:06.277

您可以将您想要的 Play 版本添加到`conf/dependencies.yml`您的 repo 文件中。

依赖项.yml：

```
# Application dependencies

require:
    - play 2.0.4 
```

然后它将加载正确的 Play 版本。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-06-24T11:52:41.517

我有同样的问题，令人惊讶的是没有找到通用的解决方案。所以我自己写了一个buildpack。希望它有帮助 [https://github.com/timanovsky/subdir-heroku-buildpack](https://github.com/timanovsky/subdir-heroku-buildpack)

# django - 将客户端计算字段添加到 django admin

> ID：14286269
> 
> 赞同：4
> 
> 时间：2013-01-11T20:39:41.443
> 
> 标签：django, django-admin

假设我有这样的模型：

```
class Spam(models.Model):
    a = models.IntegerField()
    b = models.IntegerField() 
```

在管理员创建/编辑表单上。我想添加一个不可编辑的字段“c”，它将包含在 a 和 b 中输入的内容的总和。

我对如何实现这一点有很多想法，但没有一个听起来很好。

谁能指出我正确的方向？

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2013-01-11T21:51:33.667

你可以这样做[`ModelAdmin.readonly_fields`](https://docs.djangoproject.com/en/1.4/ref/contrib/admin/#django.contrib.admin.ModelAdmin.readonly_fields)

```
class SpamAdmin(admin.ModelAdmin):
    readonly_fields = ('get_c',)
    fields = ('a', 'b', 'get_c')

    def get_c(self, obj):
        return obj.a + obj.b 
```

# javascript - 使用 JavaScript 画布向 fillRect 添加边距

> ID：14286273
> 
> 赞同：1
> 
> 时间：2013-01-11T20:39:53.657
> 
> 标签：javascript, canvas

我正在制作一个有趣的蛇游戏，以练习 JavaScript/canvas，到目前为止，我所拥有的是一个 while 循环，它表示`while i is < 100, then add a square`并通过使用`fillRect(10, 10, xCoord, yCoord)`和在我拥有的 while 循环中添加了正方形`xCoord = xCoord + 11;`，因此它将正方形向右移动中间有一个空格...这是一个链接：

[http://brycemckenney.com/snake_canvas](http://brycemckenney.com/snake_canvas)

以及相关代码：

```
while(i < 100) {
    // fillRect(x, y, width, height)... x is horizontal and y is vertical...
    context.fillRect(xCoord, yCoord, sW, sH);

    // We want each squere to have one pixel in between them, so we increment by 11, not 10.
    xCoord = xCoord + 11;

    // When i (0) gets to numOfSquares (3), then make the rest white so that you can't see them...
    if (i >= numOfSquares) {
        context.fillStyle = "#FFFFFF";
    }

    //Increment by 1 every loop, so that the squares keep going
    i++;

} 
```

我试图让蛇动画，我尝试了许多不同的选择。现在我正在尝试在 4 个正方形上添加一个边距，所以看起来它正在移动……是否可以为这些正方形添加边距？这是我所拥有的快照：

![在此处输入图像描述](../Images/e9731804fcbd97e523377e6a0a28a44c.png)

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-12T05:30:53.370

好吧，既然你正在制作蛇游戏，我们知道你想做什么，我认为如果我们试图让你走上正确的轨道而不是修改你现有的代码会更有用。

假设我们的逻辑游戏网格是 60x60。所以蛇片可以在这个网格中的任何地方，X 和 Y 值在 0 到 59 之间。这意味着：

*   左上角的一条蛇在`[0, 0]`

*   右上角的一条蛇在`[59, 0]`

让我们进一步假设一条蛇由许多段组成。开始4段怎么样。这意味着我们需要保留 4 个位置的数组：

`[position1, position2, position3, position4]`

我们必须选择一个前端，所以可以说数组的末端是蛇的“前端”。如果我们选择左上 4 个位置，蛇将是：

`var mySnake = [[0, 0], [1,0], [2,0], [3,0]]`

板上的内容如下所示：

```
++++OOOOOOOO
OOOOOOOOOOOO
OOOOOOOOOOOO 
```

这意味着它的 4 条蛇从左到右，就像你到目前为止一样。问题是，通过保存这些位置，我们已经为我们的程序添加了一些持久*状态。*

现在蛇是一个有趣的游戏，因为“移动”蛇实际上意味着两件事：

1.  拿走最后一块（尾巴）
2.  为蛇添加一个新片段

所以我们应该做一个移动蛇的函数来完成这两个任务。我们将根据方向制作一个：

```
// modifies a snake's array
function moveSnake(snake, direction) {
  // First we must remove a piece of the snake's tail, which is at the start of the array
  // There's a built in command in JavaScript for this called shift()
  snake.shift();

  // Now we must add the new piece!

  // To tell where we need to go we must look at the last location:
  var lastLoc = snake[snake.length - 1];
  // Just to be a little more clear:
  var lastX = lastLoc[0];
  var lastY = lastLoc[1];
  switch (direction) {
    case 'up':
      snake.push([lastX, lastY-1]);
      break;
    case 'down':
      snake.push([lastX, lastY+1]);
      break;
    case 'left':
      snake.push([lastX-1, lastY]);
      break;
    case 'right':
      snake.push([lastX+1, lastY]);
      break;
  }
  // redraw after every move!
  drawSnake(ctx, mySnake);
} 
```

使用这种方法，我们可以做到：

```
var mySnake = [[0, 0], [1,0], [2,0], [3,0]];
moveSnake(mySnake, 'down');
// mySnake is now [[1,0], [2,0], [3,0], [3,1]]; 
```

这条蛇现在看起来像这样：

```
O+++OOOOOOOO
OOO+OOOOOOOO
OOOOOOOOOOOO 
```

现在这个方法很笨，在真正的蛇游戏中我们需要添加一些条件。通常：

1.  如果新的蛇在食物上，尾巴不会被移除，而是蛇长+1格
2.  如果新棋子超出 60x60 网格，则用户输掉游戏
3.  如果新棋子位于任何其他蛇棋子已经存在的位置，则用户输掉游戏

唉，这些还没有在这里完成

* * *

我们仍然需要把它全部画出来，但是因为我们要跟踪蛇的位置，所以很容易。我们可以为每条蛇画一个正方形：

```
function drawSnake(context, snake) {
  // Remember to clear the board!
  ctx.clearRect(0, 0, 600, 600);

  var length = snake.length;
  for (var i = 0; i < length; i++) {
    context.fillStyle = 'teal';
    // position is its own array and looks like: [x, y]
    var position = snake[i];
    // our logical snake board is 60x60, but the real canvas is 600x600,
    // so we multiply x and y by 10.
    // We also use "9" for the width and height so theres a tiny gap
    context.fillRect(position[0]*10, position[1]*10, 9, 9);
  }
} 
```

**在此处查看已完成的演示。**

[http://jsfiddle.net/FsqXE/](http://jsfiddle.net/FsqXE/)

请注意，它允许箭头键控制蛇以炫耀 moveSnake 方法，但常规蛇游戏的移动由计时器控制，用户通常只能更改下一个可能的方向。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-16T11:00:50.533

canvas 元素是一个 2D 绘图表面，因此它不支持（更高级别）诸如 CSS 边距之类的东西。

要制作动画，您需要不断清除画布并重新绘制场景，每次都稍微调整移动对象的位置（使它们看起来在移动）。在您的情况下，这意味着重新绘制正方形，每次的起始位置距离您上次重新绘制框架时 4 个像素。

您可能想查看MDN上的[基本动画页面（他们的画布教程的一部分）。](https://developer.mozilla.org/en-US/docs/HTML/Canvas/Tutorial/Basic_animations)

# oracle - 在 iReport 中使用 SELECT TABLE.COLUMN、CURSOR(SELECT OTHER_STUFF)

> ID：14286274
> 
> 赞同：1
> 
> 时间：2013-01-11T20:39:55.000
> 
> 标签：oracle, plsql, cursor, jasper-reports, ireport

我的任务是通过制作一些基本的 JasperReports 将一些现有的 PL/SQL 查询移动到 Jasper 服务器中。到目前为止，这一直很简单，但是我遇到了一个具有以下结构的查询，并且不知道如何使用 iReport`$P{ORACLE_REF_CURSOR}`参数来访问结果数据集：

`SELECT part.part_name, cursor(SELECT other_stuff...) FROM tbl_part part`

当我将其复制+粘贴到字段阅读器中时，它会“正确”识别我的字段，如下所示：

1.  `java.lang.String`零件名称
2.  `OracleResultSet`光标（...）

我想知道如何在`cursor()`for each中获取好东西`part_name`。

# vb.net - 如何将 ADO.NET 数据服务 MaxProtocolVersion 设置为使用 V2？

> ID：14286275
> 
> 赞同：0
> 
> 时间：2013-01-11T20:39:57.227
> 
> 标签：vb.net, .net-3.5, wcf-data-services, visual-studio-2008-sp1

我对 ADO.NET/WCF 数据服务完全陌生。在我第一次设置和测试 ADO.NET 数据服务时，我遇到了这个令人费解的错误：

> 响应要求使用协议的版本 2，但数据服务的 MaxProtocolVersion 设置为 DataServiceProtocolVersion.V1。

网上的参考资料表明我需要设置：

```
config.DataServiceBehavior.MaxProtocolVersion = Common.DataServiceProtocolVersion.V2 
```

但是，此属性在 IntelliSense 中不可用，并且在我手动编码时会产生构建错误。

我正在使用 Visual Studio 2008 SP1、.NET 3.5 SP1 和 VB.NET。如何启用协议的第 2 版？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-11T20:39:57.227

经过大约一天半的搜索（并重新应用 VS2008 SP1），这篇博客文章终于把事情弄清楚了：

[Astoria V.Next 适用于 .NET 3.5 SP1 -> 版本控制问题](http://www.stephenforte.net/Astoria+VNext+Ships+For+NET+35+SP1+Versioning+Issue.aspx)

事实证明，我的安装一切正常，但我忽略了 InitilizeService() 方法的签名发生了如此微妙的变化这一事实。正如斯蒂芬福特在他的博客中指出的那样：

```
 1:  //change the IDataServiceConfiguration to DataServiceConfiguration
 2:  public static void InitializeService(DataServiceConfiguration config)
 3:  {
 4:      config.SetEntitySetAccessRule("*", EntitySetRights.All);
 5:      //take advantage of the "2.0" features
 6:      config.DataServiceBehavior.MaxProtocolVersion =
 7:          System.Data.Services.Common.DataServiceProtocolVersion.V2;
 8:  } 
```

> 您需要更改的第一件事是在第 2 行，将接口**IDataServiceConfiguration**更改为只是**DataServiceConfiguration**（我确信有更好的方法可以做到这一点，我还没有想出来。）。接下来，将 DataServiceBehavior 的 MaxProtocolVersion 属性设置为 V2。之后，您可以利用所有新功能！

强调我的。一个简单的“我”所带来的不同是惊人的。为了回答斯蒂芬的担忧，这也得到了 MSDN 的支持，但他们目前没有指出引用接口与实现对象的区别：

[配置数据服务（ADO.NET 数据服务）](http://msdn.microsoft.com/en-us/library/vstudio/ee358710%28v=vs.90%29.aspx)

这是VB中的代码：

```
'change the IDataServiceConfiguration to DataServiceConfiguration
Public Shared Sub InitializeService(ByVal config As DataServiceConfiguration)
    config.SetEntitySetAccessRule("*", EntitySetRights.All)
    'take advantage of the "2.0" features
    config.DataServiceBehavior.MaxProtocolVersion = System.Data.Services.Common.DataServiceProtocolVersion.V2
End Sub 
```

编译，测试，通过。我刚刚迈出了迈向更大世界的第一步……

# c# - 将变量添加到 HTML.BeginForm 模型中

> ID：14286279
> 
> 赞同：3
> 
> 时间：2013-01-11T20:40:04.157
> 
> 标签：c#, html, razor, asp.net-mvc-4

我在 GET 控制器和视图之间保留 passwordToken 时遇到问题。我看到令牌已在 GET 控制器中正确传递并添加到模型中，但是一旦 HTML.BeginForm 在视图中启动，模型就会有一个新实例，并且带有 passwordToken 的先前模型就会丢失。我需要保留密码令牌才能使用 WebSecurity.ResetPassword。关于如何做到这一点的任何建议？

我的 GET 控制器：

```
 [AllowAnonymous]
    public ActionResult PasswordReset(string passwordToken)
    {
        // Token Validation
        var usrID = WebSecurity.GetUserIdFromPasswordResetToken(passwordToken);
        var usr = _dbManager.GetUserInformation(usrID);

        if (usr == null)
        {
            //The link you are using is not valid anymore
            return RedirectToAction("Error", "Account");
        }
        else
        {
            var model = new PasswordReset();
            model.PasswordResetToken = passwordToken;
            return View(model);
        }
    } 
```

我的观点：

```
@model Project.Models.PasswordReset
@{
ViewBag.Title = "Password Reset";
}

<h2>Password Reset</h2>

<div class="form passwordreset-form">

@using (Html.BeginForm())
{
    @Html.AntiForgeryToken()
    @Html.ValidationSummary()

    <div class="input-form">

        <div class="inputbox-label">
            @Html.LabelFor(m => m.Password)
        </div>
        <div class="inputbox">
            @Html.PasswordFor(m => m.Password)
        </div>

        <div class="inputbox-label">
            @Html.LabelFor(m => m.ConfirmPassword)
        </div>
        <div class="inputbox">
            @Html.PasswordFor(m => m.ConfirmPassword)
        </div>

    </div>
    <div style="float:right;">
        <input type="submit" value="Change Password" />
    </div>

}

</div> 
```

我的 POST 控制器：

```
 [HttpPost]
    [AllowAnonymous]
    [ValidateAntiForgeryToken]
    public ActionResult PasswordReset(PasswordReset model)
    {
        //Attemp to change password
        var passwordChangeConfirmation = WebSecurity.ResetPassword(model.PasswordResetToken, model.Password); 

            //Password has been changed
        if(passwordChangeConfirmation == true)
        {
            return RedirectToAction("Index", "Home");
        }
            //Password change has failed
        else
        {
            return RedirectToAction("Error", "Account");
        }
    } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-11T21:30:56.347

我最终调整了 POST 类以使其工作。

```
 [HttpPost]
    [AllowAnonymous]
    [ValidateAntiForgeryToken]
    public ActionResult PasswordReset(PasswordReset model, string passwordToken)
    {
        //Attemp to change password
        model.PasswordResetToken = passwordToken;
        var passwordChangeConfirmation = WebSecurity.ResetPassword(model.PasswordResetToken, model.Password);

        //Password has been changed
        if (passwordChangeConfirmation == true)
        {
            return RedirectToAction("Index", "Home");
        }
        //Password change has failed
        else
        {
            return RedirectToAction("Error", "Account");
        }
    } 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-11T20:49:57.723

将其添加到您的表单中：

```
@Html.HiddenFor(m => m.PasswordResetToken); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-11T21:44:45.137

您可以在表单上为您传递的字段（来自您的模型）使用隐藏的输入。

```
@Html.HiddenFor(m => m.PasswordResetToken); 
```

在输出

```
<input type="hidden" name="PasswordResetToken"></input> 
```

# c# - 如何轻松更换 Microsoft Fakes 程序集？

> ID：14286285
> 
> 赞同：14
> 
> 时间：2013-01-11T20:40:24.670
> 
> 标签：c#, unit-testing, visual-studio-2012, microsoft-fakes

将 Microsoft Fakes 程序集添加到测试项目很容易：只需右键单击引用部分中的父程序集并选择“添加 Fakes 程序集”。但是，当父程序集公共接口发生变化（新接口、新方法）时，Fakes 程序集就会过时。

当我再次右键单击父程序集时，我很想看到“替换假货程序集”或“更新假货程序集”，但我看到的只是“添加假货程序集”。

在已添加 Fakes 程序集时选择“Add Fakes Assembly”会导致错误：

> 已经引用了假程序集。一个 Fakes 程序集已经在参考列表中。删除 .Fakes 引用并重试。

按照说明操作，然后选择“添加假货程序集”后，会出现同样的错误。

我可以通过删除 Fakes 目录 (.fakes) 中的相应 xml 文件来解决此问题。

因此，我必须手动删除两项（假货程序集和假货 xml 文件），然后才能成功更新假货程序集。

**有没有更简单或更直接的方法来做到这一点？**

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2013-01-11T21:27:41.403

Fakes 代码生成器会自动检测目标程序集的可见 API 的变化，并在必要时重新生成 fakes 程序集。当目标程序集更改时，只需构建包含其 .Fakes 文件的测试项目。

# windows-8 - 将文件写入 Sharepoint Online WinRT

> ID：14286289
> 
> 赞同：0
> 
> 时间：2013-01-11T20:40:56.570
> 
> 标签：windows-8, windows-runtime

我最近一直在开发一个允许某人在表单上输入信息的 winRT 应用程序。我正在尝试将该表单作为 Office 365 套件的一部分在线上传到 SharePoint。我一直找不到有关如何执行此操作的任何示例或真实文档。有没有人在网上找到与此相似的东西？任何帮助将非常感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-11T22:58:28.893

您应该能够从您的 WinRT 应用程序到您的 SharePoint 在线 Web 服务执行 HTTP 放置。这是[Web 服务](http://msdn.microsoft.com/en-us/library/gg454740%28v=office.14%29.aspx)和[接口](http://msdn.microsoft.com/en-us/library/ff521587%28v=office.14%29.aspx)的列表。下面是如何从 Windows 应用商店风格的应用程序调用 RESTful Web 服务的[示例。](http://code.msdn.microsoft.com/windowsapps/Metro-client-for-Web-API-664848c5)

# .net - 简单的浏览器应用程序开始开发

> ID：14286290
> 
> 赞同：0
> 
> 时间：2013-01-11T20:40:57.590
> 
> 标签：.net, visual-studio, visual-c++, qtwebkit, layout-engine

我想创建一个简单的浏览器，但想使用 Visual Studio 来简化开发过程，因为我更喜欢它。

我试图为 NET 找到一个稳定的 webkit 浏览器布局引擎库，但其他项目要么不稳定，要么很旧（我想使用 .NET 4.0）。
其中一些是[Webkit.net](http://webkitdotnet.sourceforge.net/)，[Webkit2.net](http://sourceforge.net/projects/webkit2net/)
我想避免壁虎，因为它仍然没有完全支持 html5，除非它是最好的选择。
提出一些实施方案。

如果在这种情况下更好，我准备迁移到其他语言。例如，我看到 QT 有一些 webkit 浏览器应用程序。

所以我的问题是：

1.  更喜欢哪种语言（建议使用 IDE 或编译器）
2.  应该使用哪个布局引擎
3.  图形界面应该使用哪个库或框架
4.  如果考虑平台依赖性，Windows、Linux 或 mac 的选项是什么。

# django - 在 Django 中按名称引用带有 id 的 url

> ID：14286292
> 
> 赞同：1
> 
> 时间：2013-01-11T20:41:15.627
> 
> 标签：django, django-templates, django-urls

我想在模板中使用其名称引用动态 url，但不确定如何合并对象 ID。换句话说，我想在我的模板中引用“/products/98”，而不必对其进行硬编码（因为我的 url 模式可能会改变）。

在我的 urls.py 中，我有：

```
url(r'^products/(\d+)/$', 'products.views.show_product', name='product'), 
```

如何命名我的模式以便我可以调用 {% url ??? %} 在模板中获取具有指定 id 的正确项目。例如

```
{% for product in product_list %}
    <a href="{% url ??? %}">Product #{% product.id %}</a>
{% endfor %} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-11T20:43:17.080

使用`{% url product product.id %}`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-11T20:46:23.697

网址.py：

```
url(r'^products/(?P<product_id>\d+)/$', 'products.views.show_product', name='product'), 
```

模板：

```
{% load url from future %}

{% for product in product_list %}

<a href="{% url "product" product_id=product.id %}">Product #{{ product.id }}</a>
{% endfor %} 
```

确保您的 products.views.show_product 视图函数将 product_id 作为参数。

# jquery - 为什么这个javascript不执行？

> ID：14286294
> 
> 赞同：1
> 
> 时间：2013-01-11T20:41:19.527
> 
> 标签：jquery, jinja2

我正在尝试让一些 jquery 在 jinja2 模板中工作。预期的行为是选中 SelectAll 框将选中其余的框。我在 .change 事件中添加了一个警报以开始调试，但我发现它没有运行。所以脚本从未被实际调用过。

我究竟做错了什么？

```
{% extends "layout.html" %}
{% block head %}<head>
{% block title %}Home{% endblock %}
<script src="//ajax.googleapis.com/ajax/libs/jquery/1.7.0/jquery.min.js" type="text/javascript"></script>
<script type="text/javascript">
$(':checkbox[name=selectAll]').change (function () {
    $(':checkbox[name=instances]').prop('checked', this.checked);
    alert("FOO");
});
</script>
</head>
{% endblock %}
{% block body %}

<form target="" method="GET" id="testform">
<div>
Select All: <input type="checkbox" name="selectAll" id="selectAllInstances" /> <br />
    {% for k in tests %}
    <input type="checkbox" name="instances" value="{{ k[1].mongo_id }}">{{ k[0] }} <br />
    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Description: {{ k[1].__doc__ }} <br />
    {% endfor %}
</div>
    <br />
    <br />
    <input type="submit">
</form>
{% endblock %} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-11T20:43:01.873

模板是一条红鲱鱼。在将事件处理程序绑定到它们的脚本运行时，您的复选框不存在。

你有几个选择。

*   将脚本元素移动到 HTML 中复选框之后的某个点
*   将脚本包装在一个函数中并延迟调用它直到稍后（例如使用 document.ready 事件）。
*   使用[事件委托](http://api.jquery.com/delegate/)而不是直接绑定。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-11T20:45:05.300

您需要将 jquery 包装在 document.ready 中，即

```
$(function(){
   $(':checkbox[name=selectAll]').change (function () {
    $(':checkbox[name=instances]').prop('checked', this.checked);
    alert("FOO");
   });
}); 
```

没有它，脚本会在 DOM 元素准备好被遍历之前运行

笔记：

```
$(function(){...code here ...}); 
```

是简写

```
$(document).ready(function(){
//your code
}); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-11T20:47:14.367

到此行执行时：

```
$(':checkbox[name=selectAll]').change(...); 
```

没有名为 selectAll 的复选框——它在脚本下方定义。将您的代码包装在 .ready 事件中：

```
$(document).ready(function(){
}); 
```

该事件在 DOM 层次结构完全构建时触发（简单来说，当浏览器看到 时`</html>`）。

# shadow - 请问如何使用 php Imagick 在文本中创建内部阴影？

> ID：14286300
> 
> 赞同：0
> 
> 时间：2013-01-11T20:41:46.197
> 
> 标签：shadow, imagick

我正处于 ImageMagick 学习曲线的开始阶段。我已经成功地在带有外部光阴影的图案背景上创建了一些文本，以提供剪切文本的漂亮外观。为了完成效果，我需要给文本和内部暗阴影。有没有 ImageMagick 专家可以帮助解决 php 问题？到目前为止，这是我很满意的代码。

```
<?php
header('Content-type: image/jpeg');
$background_layer = new Imagick('test_background.jpg'); # background image
$d = $background_layer->getImageGeometry();
$w = $d['width'];
$h = $d['height']; 
$text_layer = new Imagick();
$text_layer->newImage($w, $h, new ImagickPixel('none'));
$text_layer->setImageFormat('png');
$ImagickDraw = new ImagickDraw();
$ImagickDraw->setFillColor('#484848');
$ImagickDraw->setFont('Helvetica-Bold');
$ImagickDraw->setFontSize( 40 );
$ImagickDraw->setTextAlignment(2); // centre

$text_layer->annotateImage( $ImagickDraw, $w / 2, 50, 0, "Stuart's\niPhone" );

// create white drop shadow on it's own layer 
$shadow_layer_white = $text_layer->clone(); 
$shadow_layer_white->setImageBackgroundColor( new ImagickPixel( 'white' ) ); 
$shadow_layer_white->shadowImage( 70, .3, 1, 1 ); 

// composite original text_layer onto shadow_layer 
$shadow_layer_white->compositeImage( $text_layer, Imagick::COMPOSITE_OVER, 0, 0 ); 
// composite shadow_layer (which now has text AND the shadow) onto image_layer 
$background_layer->compositeImage( $shadow_layer_white, Imagick::COMPOSITE_OVER, 0, 0 ); 
echo($background_layer);
?> 
```

我太新了，无法发布图片，所以你可以看到我到目前为止的内容

[http://www.avforums.com/images/temptest.php](http://www.avforums.com/images/temptest.php)

您可以提供任何帮助以在文本中添加内部深色阴影，我们将不胜感激。谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-12T19:49:05.363

You are using Imagick not Imagemagick directly and may want to add that tag as well.

I do not use Imagick but [shadeimage](http://php.net/manual/en/imagick.shadeimage.php) should do what you want in one go?

# github - 是否可以设置用户的 GitHub 默认组织？

> ID：14286301
> 
> 赞同：13
> 
> 时间：2013-01-11T20:41:55.900
> 
> 标签：github, github-enterprise

我在 Github 中属于多个组织（实际上是 github 企业安装）。每当我访问 Github 时，默认组织是我的个人用户帐户。

![在此处输入图像描述](../Images/11ecefe426881c935abbde52beeff4e8.png)

但是，我使用的所有存储库都在另一个组织中。访问 Github 时可以设置默认组织吗？

# forms - mod_rewrite 查询字符串在本地不起作用

> ID：14286307
> 
> 赞同：0
> 
> 时间：2013-01-11T20:42:37.260
> 
> 标签：forms, codeigniter, mod-rewrite, get, url-parameters

我需要使用 mod_rewrite 进行翻译：

`http://example.com/sitengoFrontEnd3/lista/tipo-todo/?terminos=abcd`

进入：

`http://example.com/sitengoFrontEnd3/lista/tipo-todo/abcd`

我正在使用 codeigniter 框架。

我的 .htaccess 是：

```
RewriteEngine On
RewriteBase /sitengoFrontEnd3

# Esto es para el formulario de busqueda
RewriteCond %{QUERY_STRING} terminos=(.*)
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule ^(.*)$ index.php/$1%1? [L]

# Esto para el codeigniter
RewriteCond %{REQUEST_URI} ^sitengoFrontEnd3.*
RewriteRule ^(.*)$ /index.php/$1 [L]
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule ^(.*)$ index.php/$1 [L] 
```

在这种情况下：

浏览至：

`http://example.com/sitengoFrontEnd3/lista/tipo-todo/?terminos=abcd`

结果（相同）：

`http://example.com/sitengoFrontEnd3/lista/tipo-todo/?terminos=abcd`

我粘贴 LogRewrite 级别 9：

```
(3) [perdir /Applications/XAMPP/xamppfiles/htdocs/sitengoFrontEnd3/] add path info postfix: /Applications/XAMPP/xamppfiles/htdocs/sitengoFrontEnd3/lista -> /Applications/XAMPP/xamppfiles/htdocs/sitengoFrontEnd3/lista/tipo-todo/
(3) [perdir /Applications/XAMPP/xamppfiles/htdocs/sitengoFrontEnd3/] strip per-dir prefix: /Applications/XAMPP/xamppfiles/htdocs/sitengoFrontEnd3/lista/tipo-todo/ -> lista/tipo-todo/
(3) [perdir /Applications/XAMPP/xamppfiles/htdocs/sitengoFrontEnd3/] applying pattern '^(.*)$' to uri 'lista/tipo-todo/'
(4) [perdir /Applications/XAMPP/xamppfiles/htdocs/sitengoFrontEnd3/] RewriteCond: input='terminos=abcd' pattern='terminos=(.*)'  > matched
(4) [perdir /Applications/XAMPP/xamppfiles/htdocs/sitengoFrontEnd3/] RewriteCond: input='/Applications/XAMPP/xamppfiles/htdocs/sitengoFrontEnd3/lista' pattern='!-f' => matched
(4) [perdir /Applications/XAMPP/xamppfiles/htdocs/sitengoFrontEnd3/] RewriteCond: input='/Applications/XAMPP/xamppfiles/htdocs/sitengoFrontEnd3/lista' pattern='!-d' => matched
(2) [perdir /Applications/XAMPP/xamppfiles/htdocs/sitengoFrontEnd3/] rewrite 'lista/tipo-todo/' -> 'index.php/lista/tipo-todo/abcd?'
(3) split uri=index.php/lista/tipo-todo/abcd? -> uri=index.php/lista/tipo-todo/abcd, args=<none>
(3) [perdir /Applications/XAMPP/xamppfiles/htdocs/sitengoFrontEnd3/] add per-dir prefix: index.php/lista/tipo-todo/abcd -> /Applications/XAMPP/xamppfiles/htdocs/sitengoFrontEnd3/index.php/lista/tipo-todo/abcd
(2) [perdir /Applications/XAMPP/xamppfiles/htdocs/sitengoFrontEnd3/] trying to replace prefix /Applications/XAMPP/xamppfiles/htdocs/sitengoFrontEnd3/ with /sitengoFrontEnd3
(5) strip matching prefix: /Applications/XAMPP/xamppfiles/htdocs/sitengoFrontEnd3/index.php/lista/tipo-todo/abcd -> index.php/lista/tipo-todo/abcd
(4) add subst prefix: index.php/lista/tipo-todo/abcd -> /sitengoFrontEnd3/index.php/lista/tipo-todo/abcd
(1) [perdir /Applications/XAMPP/xamppfiles/htdocs/sitengoFrontEnd3/] internal redirect with /sitengoFrontEnd3/index.php/lista/tipo-todo/abcd [INTERNAL REDIRECT]
(3) [perdir /Applications/XAMPP/xamppfiles/htdocs/sitengoFrontEnd3/] add path info postfix: /Applications/XAMPP/xamppfiles/htdocs/sitengoFrontEnd3/index.php -> /Applications/XAMPP/xamppfiles/htdocs/sitengoFrontEnd3/index.php/lista/tipo-todo/abcd
(3) [perdir /Applications/XAMPP/xamppfiles/htdocs/sitengoFrontEnd3/] strip per-dir prefix: /Applications/XAMPP/xamppfiles/htdocs/sitengoFrontEnd3/index.php/lista/tipo-todo/abcd -> index.php/lista/tipo-todo/abcd
(3) [perdir /Applications/XAMPP/xamppfiles/htdocs/sitengoFrontEnd3/] applying pattern '^(.*)$' to uri 'index.php/lista/tipo-todo/abcd'
(4) [perdir /Applications/XAMPP/xamppfiles/htdocs/sitengoFrontEnd3/] RewriteCond: input='' pattern='terminos=(.*)' => not-matched
(3) [perdir /Applications/XAMPP/xamppfiles/htdocs/sitengoFrontEnd3/] add path info postfix: /Applications/XAMPP/xamppfiles/htdocs/sitengoFrontEnd3/index.php -> /Applications/XAMPP/xamppfiles/htdocs/sitengoFrontEnd3/index.php/lista/tipo-todo/abcd
(3) [perdir /Applications/XAMPP/xamppfiles/htdocs/sitengoFrontEnd3/] strip per-dir prefix: /Applications/XAMPP/xamppfiles/htdocs/sitengoFrontEnd3/index.php/lista/tipo-todo/abcd -> index.php/lista/tipo-todo/abcd
(3) [perdir /Applications/XAMPP/xamppfiles/htdocs/sitengoFrontEnd3/] applying pattern '^(.*)$' to uri 'index.php/lista/tipo-todo/abcd'
(4) [perdir /Applications/XAMPP/xamppfiles/htdocs/sitengoFrontEnd3/] RewriteCond: input='/sitengoFrontEnd3/index.php/lista/tipo-todo/abcd' pattern='^sitengoFrontEnd3.*' => not-matched
(3) [perdir /Applications/XAMPP/xamppfiles/htdocs/sitengoFrontEnd3/] add path info postfix: /Applications/XAMPP/xamppfiles/htdocs/sitengoFrontEnd3/index.php -> /Applications/XAMPP/xamppfiles/htdocs/sitengoFrontEnd3/index.php/lista/tipo-todo/abcd
(3) [perdir /Applications/XAMPP/xamppfiles/htdocs/sitengoFrontEnd3/] strip per-dir prefix: /Applications/XAMPP/xamppfiles/htdocs/sitengoFrontEnd3/index.php/lista/tipo-todo/abcd -> index.php/lista/tipo-todo/abcd
(3) [perdir /Applications/XAMPP/xamppfiles/htdocs/sitengoFrontEnd3/] applying pattern '^(.*)$' to uri 'index.php/lista/tipo-todo/abcd'
(4) [perdir /Applications/XAMPP/xamppfiles/htdocs/sitengoFrontEnd3/] RewriteCond: input='/Applications/XAMPP/xamppfiles/htdocs/sitengoFrontEnd3/index.php' pattern='!-f' => not-matched
(1) [perdir /Applications/XAMPP/xamppfiles/htdocs/sitengoFrontEnd3/] pass through /Applications/XAMPP/xamppfiles/htdocs/sitengoFrontEnd3/index.php 
```

如果我更改 .htaccess 的这一行：

```
RewriteRule ^(.*)$ index.php/$1%1? [L] 
```

对于另一个外部的：

```
RewriteRule ^(.*)$ http://example2.com/$1%1? [L] 
```

然后，当我浏览到：

`http://example.com/sitengoFrontEnd3/lista/tipo-todo/?terminos=abcd`

结果是：

`http://example2.com/lista/tipo-todo/abcd`

那么，为什么它适用于外部和绝对而不是内部和相对？我花了一天的时间试图解决这个问题，但没有成功，所以欢迎任何帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-12T14:39:03.733

行。谢谢您的意见。最后我用以下.htaccess解决了它：

```
 RewriteEngine On
    RewriteBase /sitengoFrontEnd3

    # Esto es para el formulario de busqueda
    #RewriteCond %{REQUEST_URI} ^sitengoFrontEnd3.*
    RewriteCond %{QUERY_STRING} terminos=(.*)
    #RewriteCond %{REQUEST_FILENAME} !-f
    #RewriteCond %{REQUEST_FILENAME} !-d
    RewriteRule ^(.*)$ %{REQUEST_URI}%1? [R=301,L]

    # Esto para el codeigniter
    RewriteCond %{REQUEST_URI} ^sitengoFrontEnd3.*
    RewriteRule ^(.*)$ /index.php/$1 [L]
    RewriteCond %{REQUEST_FILENAME} !-f
    RewriteCond %{REQUEST_FILENAME} !-d
    RewriteRule ^(.*)$ index.php/$1 [L] 
```

# f# - 如何获得 Mono 3 的 fsharpc 来创建与 OSX 兼容的二进制文件？

> ID：14286308
> 
> 赞同：2
> 
> 时间：2013-01-11T20:42:37.803
> 
> 标签：f#, mono

决定第一次在我的 Mac（OSX 10.8，XCode 4.4）上试用 F#。我下载了 Mono 3.0.3 并尝试编译一个简单的“Hello World”程序。它并不顺利：

```
$ cat Hello.fs 
printfn "Hello, World!"
$ /Library/Frameworks/Mono.framework/Versions/3.0.3/bin/fsharpc Hello.fs 
F# Compiler for F# 3.0 (Open Source Edition)
Freely distributed under the Apache 2.0 Open Source License
$ ./Hello.exe 
zsh: exec format error: ./Hello.exe
$ file Hello.exe 
Hello.exe: PE32 executable for MS Windows (console) Intel 80386 32-bit Mono/.Net assembly 
```

我查看了 的输出，`fsharpc --help`看看是否有一个明显的标志可以生成正确类型的二进制文件，但似乎没有什么特别有用的。我假设我需要做一些非常明显的事情来启用它，但我似乎无法弄清楚。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-01-11T20:51:26.130

我才意识到我应该这样做`mono Hello.exe`。如果其他人在尝试编译一些代码之前没有阅读 Mono 文档，我会留下这个；）

# asp.net-mvc - MVC DevExpress - 返回到控制器的模型是空的

> ID：14286314
> 
> 赞同：2
> 
> 时间：2013-01-11T20:43:02.293
> 
> 标签：asp.net-mvc, asp.net-mvc-4, devexpress

我有一个非常简单的页面。它有几个 devexpress 文本框和一个 devexpress 按钮。

这些文本框绑定到我的模型中的特定字段。

单击按钮后，它会跳转到我的操作，在查看我操作中的模型时，我的字段为空。我最初与@Html.TextBoxFors 完美配合。添加 Devexpress 文本框和 textboxfors 后，没有任何效果。

我已经查看了stackoverflow并没有找到解决方案，虽然我发现了一个类似的问题，基本上相同，但如果我需要开始赏金，我宁愿在我自己的问题上做，就代码而言，我的非常相似下面的那个。：

[MVC 3 DevExpress - 返回到控制器的模型是空的](https://stackoverflow.com/questions/11319969/mvc-3-devexpress-model-returned-to-controller-is-empty)

我还查看了 devexpress 的网站并找到了这个。：

[http://www.devexpress.com/Support/Center/Example/Details/E2886](http://www.devexpress.com/Support/Center/Example/Details/E2886)

以上基本上是如何正确执行此操作的演示。我的项目和其他 stackoverflow 用户的代码与此几乎完全相同。

我假设其他人有这个问题。我已经尝试让这个工作好几个星期了，但仍然没有运气。任何想法都非常感谢。

**代码**

看法

```
@inherits System.Web.Mvc.WebViewPage<MyModel>
@using DevExpress.Web.ASPxEditors;

@using (Html.BeginForm("MyModelSave", "Home", FormMethod.Post))
{
    <div>
        @Html.DevExpress().TextBox(settings =>
                   {
                       settings.Name = "txtId";
                       settings.Width = System.Web.UI.WebControls.Unit.Percentage(100);
                   }).Bind(Model.Id).GetHtml()
    </div>
    <div>
        @Html.DevExpress().TextBox(settings =>
                   {
                       settings.Name = "txtName";
                       settings.Width = System.Web.UI.WebControls.Unit.Percentage(100);
                   }).Bind(Model.Name).GetHtml()
    </div>
    <div>
        @Html.DevExpress().Button(s =>
                     {
                        s.Name = "btnSave";
                        s.Images.Image.Url = "~/Images/save.png";
                        s.Text = string.Empty;
                        s.ToolTip = "Save";
                            s.UseSubmitBehavior = true;
                        }).GetHtml()
    </div>
} 
```

行动

```
[HttpPost]
        public ActionResult MyModelSave([ModelBinder(typeof(DevExpressEditorsBinder))]MyModel modelTest)
        {
            if (!ModelState.IsValid)
            {
                return View();
            }
            else
            {
                //Work with model
                return View();
            }
        } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-11T21:22:11.843

对于模型绑定，您的 html 输入（文本框）名称和模型属性名称应该匹配。

因此，您`DevExpress().TextBox`的 s 需要与`settings.Name`您的模型属性具有相同的 s ：

```
<div>
    @Html.DevExpress().TextBox(settings =>
           {
               settings.Name = "Id";
               settings.Width = System.Web.UI.WebControls.Unit.Percentage(100);
           }).Bind(Model.Id).GetHtml()
</div>
<div>
    @Html.DevExpress().TextBox(settings =>
           {
               settings.Name = "Name";
               settings.Width = System.Web.UI.WebControls.Unit.Percentage(100);
           }).Bind(Model.Name).GetHtml()
</div> 
```

# terminal - 如何在终端内获得 Stack Overflow 答案？

> ID：14286316
> 
> 赞同：6
> 
> 时间：2013-01-11T20:43:10.497
> 
> 标签：terminal, automation

有没有办法直接从命令行查询 Stack Overflow 并取回对该查询出现的第一个问题的最受好评的答案？

我真的不喜欢每当我想复习编写 RegExes 以匹配 XHTML 标记的知识时就必须打开浏览器。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-01-11T20:43:10.497

对的，这是可能的！试试 Benjamin Gleitzman 的优秀工具[howdoi](https://github.com/gleitz/howdoi)。

它是这样工作的：

```
$ howdoi get stackoverflow answers inside a terminal 
```

并且程序将在 StackOverflow 中查询关键字“在终端内获取 stackoverflow 答案”，找到与这些术语最匹配的问题，并从该问题的最佳答案中返回代码。

您还可以添加`-a`选项以获取完整答案，而不仅仅是代码。因此，要获得示例查询的答案，您可以：

```
$ howdoi -a RegEx match XHTML tags 
```

## 安装

如果你安装了 Python 和 pip，你可以从 Cheese shop 得到它。

```
$ pip install howdoi 
```

## 更多帮助

输入`howdoi -h`完整的使用说明。

# css - div：在 Opera 浏览器中处于活动状态

> ID：14286320
> 
> 赞同：2
> 
> 时间：2013-01-11T20:43:19.477
> 
> 标签：css, opera

看看这个[小提琴](http://jsfiddle.net/NzsTU/)。我希望当我单击父 div 时，锚点会改变其背景颜色。仅当我单击锚点旁边时才有效。但是，如果我将光标移到锚上然后单击，则什么也不会发生。它只能在 Firefox 和 chrome 中正常工作。

```
<div class="test">
  <a href="#">link me</a>
</div>

.test
{
  background:Gray;
}
.test:active a
{
  background:Red;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-11T20:48:45.313

为了所有浏览器的一致性，我会将活动伪放在锚标记上。

```
.test a {
  background:Gray;
  display:block;
}
.test a:active {
  background:Red;
} 
```

见[小提琴](http://jsfiddle.net/NzsTU/3/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-06-06T07:01:56.123

**Opera**不支持的某些类和伪类尝试以这种方式尝试，可以解决您的问题。

```
.test
{
  background:Gray;
}
.test:active a
{
  background:Red;
}
.test a:active 
{
  background:Red;
} 
```

# windows-7 - Visual Studio 2012 会在 Windows 7 启动器上运行吗？

> ID：14286322
> 
> 赞同：2
> 
> 时间：2013-01-11T20:43:27.093
> 
> 标签：windows-7, visual-studio-2012

我找不到任何地方，它明确说明它会或不会。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-11T21:17:52.530

是的，当然——Visual Studio 不关心 Windows 版本。但是我已经在超薄上网本（处理器品牌 Intel Atom，2Gb RAM）上安装了 VS 2012，因为它太慢了，所以无法使用。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-02-18T11:00:10.257

**不**，因为 VS 2012 用于制作 Metro 应用程序（适用于 Windows 8 的应用程序）。您不能在任何版本的 Windows 7 上使用它。您可以下载*Visual Studio(VS) 2010*。

# .net - 以最少的工作量跨多个版本维护 .NET WebServices API

> ID：14286331
> 
> 赞同：2
> 
> 时间：2013-01-11T20:44:06.197
> 
> 标签：.net, web-services, service, web, versioning

我一直在阅读 .NET Web 服务上的版本控制解决方案，即

```
http(s)://example.com/API/WebServices/v1.0.0/Customer.asmx
http(s)://example.com/API/WebServices/v1.1.0/Customer.asmx
http(s)://example.com/API/WebServices/v1.2.0/Customer.asmx 
```

等等; 并且似乎还没有（在任何 Microsoft 框架中）是一个完美的答案。有很多意见认为 URL 更改是要走的路；在 REST 环境中说的其他人使用 HTTP 标头/内容标头/接受标头等来定义版本和您将接受的输出。

在 .NET 世界中，从 WSDL 生成您的引用并获得智能感知为我做这件事。它抽象了很多“提升”，让我调用我的方法。

然而，在维护和发布附加版本、更新 API、扩展 Web 服务的世界中，它变得越来越困难。

我还没有看到建议的下面描述的解决方案。它似乎在测试台中运行良好；但是没有人建议它，因为它是一个愚蠢的想法，或者只是一个混合想法，它会抓住当前的痒处？

我们可能每月发布一次主要 Web 应用程序的新版本、错误修复、新功能和功能扩展，因此我正在寻找易于维护的东西，但 Web 服务的消费者在他们需要之前不必担心升级（在合理范围内） ) 而不是为每个版本/URL 创建预先存在的 Web 服务的完整副本。

基本上建议是：

**客户服务** 出现在版本 1.0 中，并具有 URL /API/WebServices/V1.0/Customer.asmx

该应用程序的 1.1 版发布，对 Customer Web 服务没有任何更改，因此将 /API/WebServices/V1.1/Customer.asmx 上的 URL 重写为 /API/WebServices/V1.0/Customer.asmx

该应用程序的 1.2 版发布，对 Customer Web 服务没有任何更改，因此将 /API/WebServices/V1.2/Customer.asmx 上的 URL 重写为 /API/WebServices/V1.0/Customer.asmx

等等....

**然后**

在 1.3 版中，我们想要添加另一种方法 - 很好（因为添加另一种方法并且不更改任何“当前”方法不会破坏任何在 v1.0 上运行的远程应用程序）只需添加其他方法（测试我们自己以确保我们没有犯任何愚蠢的错误）并在 /API/WebServices/V1.3/Customer.asmx 发布。这次是一个“新”的网络服务，基本上*我不喜欢这个——有更好的主意吗？*只是 1.0 中添加了新方法的 webservice 文件的副本。Web 服务文件本身尽可能地包含所有逻辑以及其他类/核心文件中的所有可能内容，因此它没有真正的逻辑（它实际上是一个端点接口）。

**on we go** V1.4、V1.5 V1.6 全部重写到 V1.3 服务。

**打破向后兼容性** 现在我们需要改变一些东西/改变它的工作方式，所以我们为 V1.7 创建一个新的 web 服务 - 复制 V1.3 代码并开始修改，直到我们完成。

我认为这个想法允许远程消费应用程序在需要时升级，我们的任务是确保旧服务继续工作，直到我们正式停止支持旧版本，让早期采用者获得最新功能，让我们不断发布新版本每个月，每当有人说“客户服务的 URL 是什么？” 我们可以简单地回答：

```
http(s)://example.com/API/WebServices/**versionNumber**/Customer.asmx 
```

它总是有效的。（除非我们删除它太旧了）。

这是一个愚蠢的想法吗？一个合理的想法还是我一直在使用错误的关键字进行谷歌搜索，而这已经被破解了？

# sql-server - 带有没有 PK 的数据库的 EF - 好主意/坏主意/Fuhgeddaboudit

> ID：14286338
> 
> 赞同：0
> 
> 时间：2013-01-11T20:44:39.153
> 
> 标签：sql-server, database, entity-framework, orm

网上有很多关于此的相互矛盾和令人困惑的建议。我想为自己和将来寻找此类信息的任何人解决这个问题。

问题是 — 实体框架是否适用于具有没有主键的表的数据库。

详细信息：我有一个数据库，它有很多没有指定 PK 的表。称其为糟糕的设计或其他什么，但我现在无法更改架构。我必须处理它。我们喜欢使用 EF，因为我们喜欢 MS，而且我们一直使用 MS 工具。知道 MS 将继续更新和支持这个 EF，我们会更容易入睡，并在未来得到充分的关注。好的，现在是我在本网站和其他网站上过度研究的迫切问题。“我可以在我的项目中使用 EF，完全知道我的数据库有一些永远不会有 PK 的表吗？”。部分问题是我们真的想使用 EF 以方便使用，而且我们是 MSphiles。

我听到了很多建议，包括：

1.  它不会工作。
2.  它可以工作。
3.  根本不是什么大事...

这就是它真正生病的地方。请指教。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-11T21:34:09.043

好吧，这在很大程度上取决于您打算如何使用它。没有主键，您就不能具有参照完整性。因此，实际上您不能自动查找子表等。

您可以手动连接表，这应该可以工作..但这严重限制了 EF 的功能。

但事情是这样的，我们说什么都不能说服你。能说服你的是自己做。构建一个测试数据库和一个测试应用程序。设置您的 EF 数据库。看看它是否适合你。

# backbone.js - 如何将 urlRoot 传递给 Backbone 中的模型

> ID：14286344
> 
> 赞同：2
> 
> 时间：2013-01-11T20:44:55.893
> 
> 标签：backbone.js

我需要`urlRoot`在运行时将 a 传递给模型，因为模型的几个不同类使用不同`urlRoot`的 s。

这是我的模型：

```
App.Models.Table = Backbone.Model.extend({ }); 
```

这是我要使用它的地方：

```
var m = new App.Models.Table();
var t = new App.Collections.Tables(m, { url: this.url });
var tables = new App.Views.Tables({ collection: t, template: this.template }); 
```

`this.url`根据调用它的事件返回正确的值。我是否将我的模型错误地传递到集合中？这是我的收藏：

```
App.Collections.Tables = Backbone.Collection.extend({
    url: this.url,
    model: App.Models.Table,
    initialize: function(models, options) {
        if (options && options.url) {
            this.url = options.url;
        }
        this.fetch({
              success: function(data, options) {

            }
        });
    }
}); 
```

如何传递`this.url`给我的模型？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-11T21:01:06.717

假设`this.url`您的示例中的 url 是正确的，然后执行以下操作：

```
table = new App.Models.Table({
    id: id
});
table.urlRoot = this.url; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-11T21:00:13.057

URL 应该是字符串常量或返回字符串的函数。在您的收藏中，您需要执行以下操作：

```
App.Collections.Tables = Backbone.Collection.extend({
    url: function() { return "http://my.url/" },
    // or, url: "http://my.url"
}); 
```

使用匿名函数使您能够在发出请求之前处理一些数据（即可能修改字符串）。

我是否正确理解您的问题？

# visual-studio-2008 - 使用 VS2008 Boost ASIO 和 OpenSSL 链接未解决的错误

> ID：14286346
> 
> 赞同：1
> 
> 时间：2013-01-11T20:44:58.730
> 
> 标签：visual-studio-2008, visual-c++, openssl, boost-asio

我已经从[BoostPro](http://www.boostpro.com/download/)下载了 Boost 1.51 版。安装程序似乎有点不稳定，但我想我设法下载了大部分 1.51 文件。对于丢失的文件，我找到了另一个[链接](https://sourceforge.net/projects/boost/files/boost-binaries/1.51.0/)并设法下载了其余的文件。我还下载了 OpenSSL 版本 j 64 位版本。我正在尝试从此[示例客户端代码构建代码](http://www.boost.org/doc/libs/1_41_0/doc/html/boost_asio/example/ssl/client.cpp)。链接器生成 51 个未解决的外部错误。以下是前 20 个，看起来至少与其他人抱怨的错误有些相似：

```
1>TestBoostASIO.obj : error LNK2019: unresolved external symbol _ERR_reason_error_string referenced in function "public: virtual class std::basic_string<char,struct std::char_traits<char>,class std::allocator<char> > __thiscall boost::asio::error::detail::ssl_category::message(int)const " (?message@ssl_category@detail@error@asio@boost@@UBE?AV?$basic_string@DU?$char_traits@D@std@@V?$allocator@D@2@@std@@H@Z)
1>TestBoostASIO.obj : error LNK2019: unresolved external symbol _ERR_get_error referenced in function "public: __thiscall boost::asio::ssl::context::context(enum boost::asio::ssl::context_base::method)" (??0context@ssl@asio@boost@@QAE@W4method@context_base@123@@Z)
1>TestBoostASIO.obj : error LNK2019: unresolved external symbol _SSLv23_server_method referenced in function "public: __thiscall boost::asio::ssl::context::context(enum boost::asio::ssl::context_base::method)" (??0context@ssl@asio@boost@@QAE@W4method@context_base@123@@Z)
1>TestBoostASIO.obj : error LNK2019: unresolved external symbol _SSLv23_client_method referenced in function "public: __thiscall boost::asio::ssl::context::context(enum boost::asio::ssl::context_base::method)" (??0context@ssl@asio@boost@@QAE@W4method@context_base@123@@Z)
1>TestBoostASIO.obj : error LNK2019: unresolved external symbol _SSLv23_method referenced in function "public: __thiscall boost::asio::ssl::context::context(enum boost::asio::ssl::context_base::method)" (??0context@ssl@asio@boost@@QAE@W4method@context_base@123@@Z)
1>TestBoostASIO.obj : error LNK2019: unresolved external symbol _TLSv1_server_method referenced in function "public: __thiscall boost::asio::ssl::context::context(enum boost::asio::ssl::context_base::method)" (??0context@ssl@asio@boost@@QAE@W4method@context_base@123@@Z)
1>TestBoostASIO.obj : error LNK2019: unresolved external symbol _TLSv1_client_method referenced in function "public: __thiscall boost::asio::ssl::context::context(enum boost::asio::ssl::context_base::method)" (??0context@ssl@asio@boost@@QAE@W4method@context_base@123@@Z)
1>TestBoostASIO.obj : error LNK2019: unresolved external symbol _TLSv1_method referenced in function "public: __thiscall boost::asio::ssl::context::context(enum boost::asio::ssl::context_base::method)" (??0context@ssl@asio@boost@@QAE@W4method@context_base@123@@Z)
1>TestBoostASIO.obj : error LNK2019: unresolved external symbol _SSLv3_server_method referenced in function "public: __thiscall boost::asio::ssl::context::context(enum boost::asio::ssl::context_base::method)" (??0context@ssl@asio@boost@@QAE@W4method@context_base@123@@Z)
1>TestBoostASIO.obj : error LNK2019: unresolved external symbol _SSLv3_client_method referenced in function "public: __thiscall boost::asio::ssl::context::context(enum boost::asio::ssl::context_base::method)" (??0context@ssl@asio@boost@@QAE@W4method@context_base@123@@Z)
1>TestBoostASIO.obj : error LNK2019: unresolved external symbol _SSLv3_method referenced in function "public: __thiscall boost::asio::ssl::context::context(enum boost::asio::ssl::context_base::method)" (??0context@ssl@asio@boost@@QAE@W4method@context_base@123@@Z)
1>TestBoostASIO.obj : error LNK2019: unresolved external symbol _SSLv2_server_method referenced in function "public: __thiscall boost::asio::ssl::context::context(enum boost::asio::ssl::context_base::method)" (??0context@ssl@asio@boost@@QAE@W4method@context_base@123@@Z)
1>TestBoostASIO.obj : error LNK2019: unresolved external symbol _SSLv2_client_method referenced in function "public: __thiscall boost::asio::ssl::context::context(enum boost::asio::ssl::context_base::method)" (??0context@ssl@asio@boost@@QAE@W4method@context_base@123@@Z)
1>TestBoostASIO.obj : error LNK2019: unresolved external symbol _SSL_CTX_new referenced in function "public: __thiscall boost::asio::ssl::context::context(enum boost::asio::ssl::context_base::method)" (??0context@ssl@asio@boost@@QAE@W4method@context_base@123@@Z)
1>TestBoostASIO.obj : error LNK2019: unresolved external symbol _SSLv2_method referenced in function "public: __thiscall boost::asio::ssl::context::context(enum boost::asio::ssl::context_base::method)" (??0context@ssl@asio@boost@@QAE@W4method@context_base@123@@Z)
1>TestBoostASIO.obj : error LNK2019: unresolved external symbol _SSL_CTX_free referenced in function "public: __thiscall boost::asio::ssl::context::~context(void)" (??1context@ssl@asio@boost@@QAE@XZ)
1>TestBoostASIO.obj : error LNK2019: unresolved external symbol _SSL_CTX_set_ex_data referenced in function "public: __thiscall boost::asio::ssl::context::~context(void)" (??1context@ssl@asio@boost@@QAE@XZ)
1>TestBoostASIO.obj : error LNK2019: unresolved external symbol _SSL_CTX_get_ex_data referenced in function "public: __thiscall boost::asio::ssl::context::~context(void)" (??1context@ssl@asio@boost@@QAE@XZ)
1>TestBoostASIO.obj : error LNK2019: unresolved external symbol _SSL_CTX_set_verify referenced in function "public: class boost::system::error_code __thiscall boost::asio::ssl::context::set_verify_mode(int,class boost::system::error_code &)" (?set_verify_mode@context@ssl@asio@boost@@QAE?AVerror_code@system@4@HAAV564@@Z)
1>TestBoostASIO.obj : error LNK2019: unresolved external symbol _SSL_CTX_get_verify_callback referenced in function "public: class boost::system::error_code __thiscall boost::asio::ssl::context::set_verify_mode(int,class boost::system::error_code &)" (?set_verify_mode@context@ssl@asio@boost@@QAE?AVerror_code@system@4@HAAV564@@Z) 
```

我在这里阅读了有关将 Boost 与 OpenSSL 链接的问题的其他问题，并尝试了解决问题的建议步骤。这包括：

1.  将路径 C:\OpenSSL-Win64\include 添加到附加包含目录。
2.  将 C:\OpenSSL-Win64\lib\VC\static 添加到附加库目录。也尝试过指定 C:\OpenSSL-Win64\lib\VC\ 路径，结果相同。
3.  将 libeay32MDd.lib 和 ssleay32MDd.lib 添加到 Additional Dependencies 以用于链接器附加依赖项。

即使在完成上述操作后，我仍然会收到这些链接错误。我还尝试使用 __stdcall 而不是默认的 __cdecl 构建我的项目 - 这会在调用信号时出现编译错误，该信号需要 __cdecl; 所以我不认为是这样。我已经尝试了我能想到的一切。有没有人知道我做错了什么或者我可以尝试什么来解决问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-14T23:15:48.517

我终于设法通过构建 Boost ASIO 和 OpenSSL 库的 32 位版本来构建解决方案。我现在怀疑这是 Windows 64 位版本的 Boost::ASIO 中的一个错误，并已提交[错误报告](https://svn.boost.org/trac/boost/ticket/7893)。

为了消除未解决的链接错误，还需要下载32 位版本的 VS2008 可[再发行组件，以及 32 位版本的 OpenSSL 并针对 32 位版本的 Boost 构建。](http://slproweb.com/products/Win32OpenSSL.html)

# tsql - 将列名分配给不带#tempopary 表的选择语句结果

> ID：14286348
> 
> 赞同：0
> 
> 时间：2013-01-11T20:45:10.493
> 
> 标签：tsql, select, alias

看看这段代码：

```
DECLARE @bufferOrder INT = 1, @capacityOrder INT = 2, @priceOrder INT = 3, @angleSpeedOrder INT = 4

    SELECT 'buffer', @bufferOrder
UNION  
    SELECT 'capacity', @capacityOrder
UNION  
    SELECT 'price', @priceOrder
UNION  
    SELECT 'angle_speed', @angleSpeedOrder 
```

我可以在不使用临时表的情况下分配两个列名吗？

```
 [INSERT INTO @#tempTabel (columnName1,columnName2) + above code] 
```

像这样（伪代码）：

```
 above code +
     AS columnName1,columnName2 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-11T20:49:39.380

只需在您的第一个 select 语句中分配列名。例如：

```
declare @int int = 1, @int2 int = 2, @int3 int = 3, @int4 int = 4;

select 'thing 1' as thing, @int as integer
union
select 'thing 2', @int2
union
select 'thing 3', @int3 
```

我可以很容易地添加更多的东西和更多的东西。列名在第一个 select 语句中定义并保持不变，除非它们被更改别名。

# java - 使用 If 中断 Java 语句并向后显示输入

> ID：14286350
> 
> 赞同：0
> 
> 时间：2013-01-11T20:45:22.353
> 
> 标签：java

当用户输入字母 Q 时，我需要合并一个 IF 语句来中断脚本。

我还需要将他们的输入反向显示给他们——我不确定我将如何做到这一点，这是我的代码。

```
import java.io.File;
import java.io.FileNotFoundException;
import java.util.ArrayList;
import java.util.Scanner;

public class ArrayListOfNames {

    public static void main(String[] args) throws FileNotFoundException {

        ArrayList<String> list = new ArrayList<String>();
        Scanner Scan = new Scanner (System.in);

        String name;

        System.out.println("Please enter some words (You may press Q to finish):  ");

        while (Scan.hasNext())
        {
            name = Scan.nextLine();
            list.add(name);
        }

        Scan.close();

    }

} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-11T20:48:59.347

要检查 Q：

```
while(Scan.hasNext())
{
    name = Scan.nextLine();
    if(name.equals("Q") || name.equals("q"))
    {
        break;
    }
    list.add(name);
} 
```

要以相反的顺序显示列表：

```
for(int i = list.size() - 1; i >= 0; i--)
{
    System.out.println(list[i]);
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-11T20:47:52.713

这个怎么样。

```
import java.io.File;
import java.io.FileNotFoundException;
import java.util.ArrayList;
import java.util.Scanner;

public class ArrayListOfNames {

  public static void main(String[] args) throws FileNotFoundException {

    ArrayList<String> list = new ArrayList<String>();
    Scanner Scan = new Scanner (System.in);

    String name;

    System.out.println("Please enter some words (You may press Q to finish):  ");

    while (Scan.hasNext())
    {
        name = Scan.nextLine();
        if( name.equals("Q") ) {
           break;
        }
        list.add(name);
    }

    Scan.close();

  }

} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-11T20:47:58.863

要向后显示输入，请将此代码放在扫描输入的循环之后。

```
for(int i = list.size()-1; i>=0; i--)
    System.out.println(list.get(i)); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-11T20:48:08.990

```
while (Scan.hasNext())
    {
        name = Scan.nextLine(); 
         //Input is stored to name, so you need to compare input with Q
         if("Q".equals(name)
          {
            //You need to exit the loop
             break;
          }
       list.add(name);
    }
//You have what ever user entered in list. So use iterator (or) for-each to print them out again. 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-01-11T22:31:06.820

从软件工程的角度来看，我们尽量避免`break;`在循环中使用语句。相反，建议使用终结器

```
final String TERMINATOR = "Q";
boolean terminated = false;

while (scanner.hasNext() && !terminated)
{
    String line = scanner.next();

    if (!line.equals(TERMINATOR))
    {
       list.add(line);
    }
    else
    {
       terminated = true;
    }
} 
```

还要注意我们如何做`!line.equals(TERMINATOR)`而不是`line.equals(TERMINATOR)`做普通的列表追加。这是因为列表附加是名义上的情况，因此我们希望做最少的检查并跳转到它。

至于反向打印你的列表，你可以做一个简单的向后迭代for循环

```
for (int i = list.size()-1; i >= 0; i--)
{
    System.out.print(list.get(i) + " ");
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-01-11T20:51:25.680

因为我怀疑这是家庭作业，所以使用 Stack 类可能会有额外的分数。

获取循环中的数据并将其推送到堆栈中。然后，当您需要打印它时，从堆栈中弹出结果。

# php - 分页元素未显示在 WordPress 循环中

> ID：14286352
> 
> 赞同：1
> 
> 时间：2013-01-11T20:45:27.310
> 
> 标签：php, wordpress, pagination, wordpress-theming

我有以下代码：

```
$attr = array(
        'align' => 'left',
        'class' => 'thumbnail imageRight',
        'width' => 350,
        'height' => 350
);

$post_query =  array ( 'post_type' => 'post' );
$posts = new WP_Query ( $post_query );

if($posts->have_posts()){
    while($posts->have_posts()){
        $posts->the_post();
        ?>
        <div class="post">
            <?php the_post_thumbnail('medium', $attr); ?>
            <h1><a href="<?php the_permalink(); ?>"><?php the_title(); ?></a></h1>
            <p><?php the_excerpt(); ?></p>
        </div>
        <?php
    }

    next_posts_link('&laquo; Older Entries');
    previous_posts_link('Newer Entries &raquo;');
} 
```

可以在[这里](http://adambalan.com/WordPressDev/sample-page)看到实际操作。此页面当前显示数据库中 21 个帖子中的 3 个。怎么没有分页。

有人能告诉我为什么吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-12-25T17:00:25.533

```
<?php
global $wp_query;
$paged = ( get_query_var('paged') ) ? get_query_var('paged') : 1;
$args = array(  
            'post_type' => 'post', //Post type
            'posts_per_page' => 3, //How many post u want to display per page
            'paged' => $paged                      
            );
$the_query = new WP_Query( $args );
if ( $the_query->have_posts() ) {
    while ( $the_query->have_posts() ) {
    $the_query->the_post();

    $url = wp_get_attachment_url( get_post_thumbnail_id($post->ID) );
?>
    <img src="<?=$url?>" width="350" height="350" class="thumbnail imageRight"/>
    <h1><a href="<?php the_permalink(); ?>"><?php the_title(); ?></a></h1>
    <p><?php the_excerpt(); ?></p>

<?php } } ?>
<div class="pagination">
<?php             
    global $wp_query;

    $big = 999999999; // need an unlikely integer

    echo paginate_links( array(
        'base' => str_replace( $big, '%#%', esc_url( get_pagenum_link( $big ) ) ),
        'format' => '?paged=%#%',
        'current' => max( 1, get_query_var('paged') ),
        'total' => $wp_query->max_num_pages
    ) );
?>
</div> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-11T23:53:04.633

两者[`next_posts_link`](http://codex.wordpress.org/Template_Tags/next_post_link)和[`previous_posts_link`](http://codex.wordpress.org/Template_Tags/previous_posts_link)使用全局`$wp_query`和`$paged`。[您必须在源代码](http://core.trac.wordpress.org/browser/tags/3.5/wp-includes/link-template.php)周围跟踪函数调用才能看到这一点（但使用 非常明显`next_post_links`）。它们不适用于自定义查询，但我相信您可以作弊。

```
$old_wpq = $wp_query;
$wp_query = new WP_Query ( $post_query );
// your loop
$wp_query = $old_wpq; 
```

试试看。

有一个相关的线程 wordpress.stackexchange.com。

[https://wordpress.stackexchange.com/questions/77661/next-posts-link-works-only-with-original-wp-query/77666#77666](https://wordpress.stackexchange.com/questions/77661/next-posts-link-works-only-with-original-wp-query/77666#77666)

# shell - 分隔文件中的更改数据捕获

> ID：14286353
> 
> 赞同：0
> 
> 时间：2013-01-11T20:45:30.837
> 
> 标签：shell

有两个制表符分隔的文件（file1、file2），它们的记录数量和结构相同，但列的值不同。

每天我们都会得到另一个文件（新文件），它的记录数量和结构相同，但列值有一些变化。

将此文件 (newfile) 与两个文件 (file1, file2) 进行比较，并用更改的记录更新其中的记录，保持未更改的记录不变。

在应用更改之前：

```
file1 

11 aaaa 
22 bbbb 
33 cccc 

file2 
11 bbbb 
22 aaaa 
33 cccc 

newfile 
11 aaaa 
22 eeee 
33 ffff 
```

应用更改后：

```
file1 
11 aaaa 
22 eeee 
33 ffff 

file2 
11 aaaa 
22 eeee 
33 ffff 
```

什么是最简单和最有效的解决方案？Unix shell 脚本？这些文件很大，包含数百万条记录，在这种情况下，shell 脚本可以成为有效的解决方案吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-11T22:44:11.533

> 每天我们都会得到另一个文件（新文件），它的记录数量和结构相同，但列值有一些变化。

在我看来，这听起来像是[**git**](http://git-scm.com)的完美案例。使用 git，您可以按原样提交当前文件。

然后，当您获得文件的新“版本”时，您可以简单地用新版本替换旧版本，然后再次提交。最好的部分是每次提交时，git 都会记录文件之间的更改，让您可以访问文件的整个历史记录。

# android - viewpager 中的 3 个 android 片段，如何让它们全部存活？

> ID：14286358
> 
> 赞同：31
> 
> 时间：2013-01-11T20:45:49.707
> 
> 标签：android, android-fragments, android-viewpager, android-fragmentactivity

我有一个至少有 3 个片段的浏览器。如果用户将数据输入到 A，然后是 B，然后是 C，然后返回到 A，则数据从 A 中丢失。

我想我在某处读到这与内存管理有关，因为片段只连接或存储相邻的片段，当我离得太远时它会杀死 A。但是，即使我拥有>3，我也希望保留每个片段的生命。

除非明确指示，否则我如何告诉 viewpager 永远不要杀死片段？

* * *

## 回答 #1

> 赞同：83
> 
> 时间：2013-01-11T20:49:13.403

采用

```
setOffscreenPageLimit(int limit) 
```

在 ViewPager 对象上。“它设置了在空闲状态下应该保留到视图层次结构中当前页面任一侧的页面数。”

# json - mongoDB 和 JSON 参考。或指针

> ID：14286364
> 
> 赞同：0
> 
> 时间：2013-01-11T20:46:11.090
> 
> 标签：json, mongodb

我有一个关于支持 JSON 的 mongoDB 的问题，是的，我知道你通过 JSON JSON 指针引用一种外键关系可能会发展。

还是我在这里错了？CouchDB 确实支持这个 JSON 引用

也许我可以作为实现面向文档的数据库的背景限制之一提供帮助。

# c# - 仅将 FolderName 获取到数据表中

> ID：14286371
> 
> 赞同：2
> 
> 时间：2013-01-11T20:46:51.600
> 
> 标签：c#, datatable

我试图将子文件夹名而不是 FULLNAME 放入我的数据表中的单独列中。请帮忙。

```
protected void Page_Load(object sender, EventArgs e) {
    DataTable ReportsDT = new DataTable("ReportsDT");
    ReportsDT.Columns.Add("Name");
    ReportsDT.Columns.Add("FolderName");
    DirectoryInfo DirInfo = new DirectoryInfo(Server.MapPath("Reports"));
    DataRow ReportDTRow = ReportsDT.NewRow();
        foreach (FileInfo fi in DirInfo.GetFiles("*.*", SearchOption.AllDirectories)) {
            ReportDTRow = ReportsDT.NewRow();
            ReportDTRow["Name"] = fi.Name;
            ReportDTRow["FolderName"] = fi.FullName;
            ReportsDT.Rows.Add(ReportDTRow);  
        }
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-11T20:52:31.853

您可以使用它`DirectoryInfo`来获取有关给定目录的信息。您在以下`FileInfo`实例中提供了一份副本`fi.Directory`：

```
foreach (FileInfo fi in DirInfo.GetFiles("*", SearchOption.AllDirectories)) {
    ReportDTRow = ReportsDT.NewRow();  
    ReportDTRow["Name"] = fi.Name;  
    ReportDTRow["FolderName"] = fi.Directory.Name;                   
    ReportsDT.Rows.Add(ReportDTRow);  
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-11T20:53:49.493

请参阅下面的示例代码：

```
string[] folders = fi.FullName.Split('\\');
string subFolderName = folders[folders.Length - 2]; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-11T20:57:22.947

我相信你正在寻找

```
ReportDTRow["FolderName"] = fi.Directory.Name; 
```

您也可以只拆分路径分隔符上的字符串并自己解析出来，但是假设我理解您想要的内容，上述内容应该可以很好地工作。

# android - 从 apk Google Play 恢复文件

> ID：14286372
> 
> 赞同：-1
> 
> 时间：2013-01-11T20:47:03.310
> 
> 标签：android, apk, recovery

前段时间我上传到谷歌为我的家庭餐厅播放了一个应用程序，它类似于显示菜单、时间表、价格......所有这些东西。它仍在谷歌游戏中，谷歌开发人员可以访问它，但问题是我丢失了所有代码。

有什么方法可以恢复数据以添加一些新信息然后更新我的应用程序？

十分感谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-11T20:59:51.513

为此，您需要一个有根设备：

将应用程序安装到您的设备上，然后使用以下命令从设备上取下 apk：

1.  通过随附的 USB 数据线将您的“Rooted”Android 设备插入您的计算机。
2.  从您的 adb 命令行（通常`C:\android-sdk-windows\tools\`）键入`adb shell`并按 enter
3.  切换到root用户，输入`su`并回车
4.  输入“cd data/app”并按回车
5.  列出所有安装的apk文件，输入`ls`并回车（找到你要解压的那个）
6.  在另一个命令窗口中，通过键入以下命令将其中一个文件拉到您的计算机上： `adb pull /data/app/application.apk name.apk`然后按 Enter

获得 apk 后，将其重命名`whatever.zip`为 zip 文件并将其解压缩。您现在将看到一堆文件夹。现在可以立即恢复资产文件夹中的任何内容。对于 java 代码，必须使用[dex2jar](http://code.google.com/p/dex2jar/)转换`classes.dex`为`.jar`文件。之后，您可以使用[JD-GUI](http://java.decompiler.free.fr/?q=jdgui)从 .jar 文件中读取代码。

要提取 AndroidManifest.xml 和 res 文件夹中的所有内容（布局 xml 文件、图像等），您必须使用[APKTool](http://code.google.com/p/android-apktool/) 运行以下命令：

```
apktool.bat d sampleApp.apk 
```

它还会提取所有 .class 文件的 .smali 文件，但这些文件很难阅读，您应该使用 dex2jar 中的代码。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-11T21:05:23.667

如果您在生成 APK 文件时使用 progaurd 混淆您的代码，那么这是不可能的。

如果没有，您可以在一定程度上对类进行反编译并对反编译的类进行一些更改，然后您就可以使其正常工作...反编译 APJK 文件的工具很少

谢谢，

# java - JMAP 转储大小为 4.5 GB。Eclipse MAT 显示总堆为 415 MB，我如何分析剩余的转储？

> ID：14286374
> 
> 赞同：4
> 
> 时间：2013-01-11T20:47:10.560
> 
> 标签：java, eclipse, jmap, mat

我正在使用 Tomcat 6 运行 Web 应用程序。我们使用的是开放式 JDK 6。我们的是 AMD 64 位 Ubuntu 11.04 服务器。

此命令进行内存转储

```
jmap -dump:format=b,file=/home/demon/Desktop/mymemorydump.hprof 2762 
```

内存转储为 4.5 GB。当我们使用 eclipse MAT 分析它时，强可达对象为 80 MB，不可达对象为 335 MB..如何分析转储的其余部分..

此过程在我的服务器上占用的内存也是 4.5 GB。现在这个内存永远不会下降到 1 GB 的正常水平。然后这个内存慢慢增加到8-9 GB，然后我们的tomcat停止响应（实际上没有内存不足的错误）。

我的tomcat配置是

```
/usr/lib/jvm/java-6-openjdk/bin/java -Djava.util.logging.config.file=/var/lib/tomcat6/conf/logging.properties -Djava.awt.headless=true -Xms1024m -Xmx6144m -XX:+UseConcMarkSweepGC -Djava.util.logging.manager=org.apache.juli.ClassLoaderLogManager -Djava.endorsed.dirs=/usr/share/tomcat6/endorsed -classpath /usr/share/tomcat6/bin/bootstrap.jar -Dcatalina.base=/var/lib/tomcat6 -Dcatalina.home=/usr/share/tomcat6 -Djava.io.tmpdir=/tmp/tomcat6-tmp org.apache.catalina.startup.Bootstrap start 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-11T21:27:44.683

您可能有线程泄漏，创建了过多的线程，这些线程永远不会终止。每个线程分配堆栈空间，上面没有显示。按 Ctrl-\ (unix)（或 Windows 中的 Ctrl-Break）将转储每个线程的堆栈跟踪（您可能需要重定向 tomcat 的 STDERR 以避免它从终端滚动）。如果你没有从终端启动tomcat，那么使用“kill -QUIT YourPID”而不是Ctrl-。

此外，jconsole（在 jdk bin 目录中）可以在它停止响应之前附加到您的可执行文件。它可能会在事情失控之前向您显示线程（或堆）泄漏。

# video - html5画布上的多个视频？

> ID：14286378
> 
> 赞同：1
> 
> 时间：2013-01-11T20:47:18.723
> 
> 标签：video, canvas, html5-canvas

我正在制作这个媒体项目，但遇到了一个大问题。我基本上想要一个由 16 个视频组成的 4x4 网格，但我当然遇到了滞后问题。我想知道是否有更好的方法可以用画布做到这一点。我可以合成多个视频，与拥有 16 个独立的视频元素相比，这会加快速度吗？如果您点击此链接： http: [//graysonearle.com/bluemen/](http://graysonearle.com/bluemen/) 并点击左侧的 PLAY ALL（然后是 TEST），您可以明白我的意思。它实际上大部分时间都有效，但有时无效。我还将添加更长的视频。任何建议表示赞赏。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2016-02-05T12:19:46.017

很晚的答案，但这里有：

您当然可以使用 JS 在一个画布元素上渲染多个视频元素。视频基本上被视为图像，因此您可以为每个 RAF 帧渲染视频。

```
ctx.drawImage(YourVidID, 0, 0, 100, 100);
ctx.drawImage(YourVidID2, 100, 100, 200, 200);
etc... 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-14T07:06:06.617

是否有一些要求让您不能只创建一个包含所有 16 个视频的视频，而不是单独渲染它们？

# hadoop - hadoop 从哪里获取 JAVA_HOME 变量值？

> ID：14286381
> 
> 赞同：11
> 
> 时间：2013-01-11T20:47:50.893
> 
> 标签：hadoop

我设置`JAVA_HOME`正确，当我设置正确时`echo`，我看到了正确的值：

```
$ echo $JAVA_HOME
/usr/lib/jvm/java-6-openjdk-amd64/ 
```

我也把`JAVA_HOME`值放到了**hadoop-env.sh**。

```
$ grep JAVA_HOME conf/hadoop-env.sh 
# The only required environment variable is JAVA_HOME.  All others are
# set JAVA_HOME in this file, so that it is correctly defined on
export JAVA_HOME="/usr/lib/jvm/java-6-openjdk-amd64/" 
```

尽管如此，hadoop 仍然显示出`JAVA_HOME`完全不同的变量。我不知道它从哪里得到这个值。有什么建议么？

```
$ hadoop noname -format
Warning: $HADOOP_HOME is deprecated.

/usr/bin/hadoop: line 320: /usr/lib/jvm/java-6-sun/bin/java: No such file or directory
/usr/bin/hadoop: line 390: /usr/lib/jvm/java-6-sun/bin/java: No such file or directory 
```

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2013-04-16T14:19:17.157

我的 Hadoop 安装也遇到了同样的问题。我在`/etc/hadoop/hadoop-env.sh`JAVA_HOME 中发现被硬编码为`/usr/lib/jvm/java-6-sun`. 我继续将其更改为`${JAVA_HOME}`，这似乎可以解决问题。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-06-16T09:38:47.267

如果有人遇到同样的问题，请查看是否创建了 /etc/hadoop 目录。如果是，则将`$JAVA_HOME`变量`/etc/hadoop/hadoop-env.sh`指向适当的 jvm 路径。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2016-08-04T17:19:27.570

我遇到“错误**/usr/bin/java** /bin/java 不存在”

在 ~/.bashrc 我将 JAVA_HOME 设置为`/usr/bin/java`. 我看到`hadoop/etc/hadoop-config.sh`它正在使用`$JAVA_HOME/bin/java`；这解释了该错误。只是，它没有修复它以删除 /bin/java。为了找到我的答案，我通过调查

```
cd /usr/bin/java
ls -al 
```

我看到了

```
lrwxrwxrwx 1 root root 46 Jul 22 16:01 /usr/bin/java -> /etc/alternatives/java 
```

在我的 bash 提示符中，我最注意到的是箭头的左侧是 Teal，而箭头的右侧是 Green。我认为这可能是一个符号链接。这次我再次这样做了`ls -al`（**-al**非常重要）符号链接位置（见下文），并注意到看起来像另一个符号链接。

```
root@groovy:~# ls /etc/alternatives/java -al
lrwxrwxrwx 1 root root 46 Jul 22 16:01 /etc/alternatives/java -> /usr/lib/jvm/java-7-openjdk-amd64/jre/bin/java 
```

我在箭头右侧取了***那个值，并将其放入 ~/.bashrc***

* * *

## *最终配置*

**~/.bashrc**

```
export JAVA_HOME=/usr/lib/jvm/java-7-openjdk-amd64/jre
export PATH=$PATH:$JAVA_HOME 
```

**hadoop/etc/hadoop/hadoop-env.sh**

```
export JAVA_HOME=${JAVA_HOME} 
```

**hadoop/libexec/hadoop-config.sh**

```
EXPORT JAVA_HOME=$JAVA_HOME/bin 
```

请注意，我安装的 JDK 是从 via 开始的`sudo apt-get install default-jdk`

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2014-03-15T22:34:46.223

有两个`hadoop-env.sh`文件：一个在`conf`您`hadoop`目录下的子目录中，一个在`/etc/hadoop`. 你需要改变`$JAVA_HOME`两者。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2016-06-28T23:05:13.277

在 $HADOOP_HOME/etc/hadoop/hadoop-env.sh 中设置

```
export JAVA_HOME=/usr/bin 
```

在 $HADOOP_HOME/libexec/hadoop-config.sh 中查找并修改`JAVA=$JAVA_HOME/bin/java`为

```
JAVA=$JAVA_HOME/java 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-03-11T19:30:10.207

我很确定这不是理想的解决方案。但这就是我所做的：

我在整个过程中都放置了 echo 语句，`/usr/local/hadoop/bin/hadoop`以查看何时`JAVA_HOME`设置为静态（无论如何似乎是静态）定义的`/usr/lib/jvm/java-6-sun`.

我可以说这几乎是马上发生的。我不知道为什么会这样。我在我的路径和所有内容中安装了 java`/usr/local/jdk1.7.0_17`并正确设置了 JAVA_HOME。有趣的是，我什至没有安装 java 6！

所以这是骇人听闻的部分。我去了它期望找到java-6-sun的地方，并为我的java安装设置了一个符号链接

```
cd /usr/lib/jvm
sudo ln -s /usr/local/jdk1.7.0_17/ java-6-sun 
```

然后一切正常。我知道非常hacky，但也许这篇文章可以帮助其他人。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-09-27T07:16:45.877

我有同样的问题，但对我来说这是不同的问题。hadoop 脚本期望 /opt/hadoop/jdk1.0.7.40 作为我的 Java 主页。但我将其设置为/opt/hadoop/jdk1.0.7_40。下划线有所不同。现在它正在工作。可能这对某人有帮助，丹

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2014-03-21T07:09:34.643

我找到了一个有趣的解决方案：<br> 如果你`echo $JAVA_HOME`，你可能会得到`/usr/bin/java`
`echo export $JAVA_HOME=/usr/ >> conf/hadoop-env.sh`

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2017-09-03T22:05:58.397

让你们的东西复杂化....我有 /usr/lib/java-1.8.0-openjdk_BLABLA 而 hadoop 想要 /usr/lib/java-1.8.0-openjdk_YADIYADA

然后我去： cp -ar /usr/lib/java-1.8.0-openjdk_BLABLA /usr/lib/java-1.8.0-openjdk_YADIYADA

很开心！没有办法搞砸所有这些无意义的confs ...

# python - Tastypie Dehydrate 反向关系计数

> ID：14286397
> 
> 赞同：1
> 
> 时间：2013-01-11T20:49:29.133
> 
> 标签：python, django, tastypie

我有一个简单的模型，其中包括一个产品和类别表。Product 模型有一个外键 Category。

当我进行一个返回类别列表 /api/vi/categories/ 的美味派 API 调用时，我想添加一个字段来确定“产品计数”/具有给定类别的产品数量。结果将是这样的：

```
category_objects[
{ 
   id: 53
   name: Laptops
   product_count: 7
}, 
...
 ] 
```

以下代码正在运行，但对我的数据库的影响很大

```
 def dehydrate(self, bundle):
        category = Category.objects.get(pk=bundle.obj.id)
        products = Product.objects.filter(category=category)
        bundle.data['product_count'] = products.count()
        return bundle 
```

有没有更有效的方法来构建这个查询？也许用注释？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-12T08:05:11.120

您可以使用[prefetch_related](https://docs.djangoproject.com/en/dev/ref/models/querysets/#prefetch-related)方法`QuerSet`来反转 select_related。

Asper 文档，

> ### prefetch_related(*查找)
> 
> 返回一个 QuerySet，它将在单个批次中自动检索每个指定查找的相关对象。
> 
> 这与 select_related 具有相似的目的，因为两者都旨在阻止由访问相关对象引起的大量数据库查询，但策略完全不同。

如果您将脱水功能更改为以下功能，则数据库将被单次命中。

```
def dehydrate(self, bundle):
    category = Category.objects.prefetch_related("product_set").get(pk=bundle.obj.id)
    bundle.data['product_count'] = category.product_set.count()
    return bundle 
```

## 更新 1

您不应该在脱水函数中初始化查询集。查询集应始终`Meta`仅在类中设置。请查看`django-tastypie`文档中的以下示例。

```
class MyResource(ModelResource):
    class Meta:
        queryset = User.objects.all()
        excludes = ['email', 'password', 'is_staff', 'is_superuser']

    def dehydrate(self, bundle):
        # If they're requesting their own record, add in their email address.
        if bundle.request.user.pk == bundle.obj.pk:
            # Note that there isn't an ``email`` field on the ``Resource``.
            # By this time, it doesn't matter, as the built data will no
            # longer be checked against the fields on the ``Resource``.
            bundle.data['email'] = bundle.obj.email

        return bundle 
```

根据有关功能的官方`django-tastypie` [文档，](http://django-tastypie.readthedocs.org/en/latest/resources.html#dehydrate)`dehydrate()`

> **脱水**
> 
> dehydrate 方法采用现在已完全填充的 bundle.data 并对它进行任何最后的更改。当一条数据可能依赖多个字段时，如果您想插入不值得拥有自己的字段的额外数据，或者如果您想从要返回的数据中动态删除内容，这很有用。

`dehydrate()`仅用于对 bundle.data 进行任何最后更改。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-12T08:09:30.230

您的代码对每个类别进行额外的计数查询。您对`annotate`此类问题的帮助是正确的。

Django 将在`GROUP BY`语句中包含所有查询集的字段。注意`.values()`并将`.group_by()`服务限制字段设置为必填字段。

```
cat_to_prod_count = dict(Product.objects
                                .values('category_id')
                                .order_by()
                                .annotate(product_count=Count('id'))
                                .values_list('category_id', 'product_count')) 
```

上面的`dict`对象是一个地图 [category_id -> product_count]。

它可以在`dehydrate`方法中使用：

```
 bundle.data['product_count'] = cat_to_prod_count[bundle.obj.id] 
```

如果这没有帮助，请尝试在类别记录上保留类似的计数器并使用信号使其保持最新。

注意类别通常是树状的存在，您可能还想计算所有子类别。

在这种情况下，请查看包[django-mptt](https://github.com/django-mptt/django-mptt/)。

# python - 2小时后Google Drive Python API可恢复上传错误401

> ID：14286402
> 
> 赞同：5
> 
> 时间：2013-01-11T20:49:45.480
> 
> 标签：python, google-drive-api, http-status-code-401, google-api-python-client, resume-upload

首先，如果这是一个太愚蠢的问题，我很抱歉......这是我第一次尝试使用该脚本中涉及的任何技术（Python、驱动器 api、oauth 2.0 等）。我发誓在发布问题之前我已经搜索并尝试了大约一周。呵呵呵呵

我正在尝试使用 google-api-python-client 上传一个仅在 Linux Debian 终端上的大文件（3.5GiB）。我在上传小文件方面取得了一些成功，但是当我尝试上传大文件时，上传会在 HTTP 401 错误（未经授权）开始后大约 1~2 小时停止。我一直在寻找如何获得新的访问令牌，但收效甚微。

到目前为止，这是我的（**更新的）代码：**

```
#!/usr/bin/python

import httplib2
import pprint
import time

from apiclient.discovery import build
from apiclient.http import MediaFileUpload
from apiclient import errors
from oauth2client.client import OAuth2WebServerFlow

# Copy your credentials from the APIs Console
CLIENT_ID = 'myclientid'
CLIENT_SECRET = 'myclientsecret'

# Check https://developers.google.com/drive/scopes for all available scopes
OAUTH_SCOPE = 'https://www.googleapis.com/auth/drive'

# Redirect URI for installed apps
REDIRECT_URI = 'urn:ietf:wg:oauth:2.0:oob'

# Run through the OAuth flow and retrieve credentials
flow = OAuth2WebServerFlow(CLIENT_ID, CLIENT_SECRET, OAUTH_SCOPE, REDIRECT_URI)
authorize_url = flow.step1_get_authorize_url()
print 'Go to the following link in your browser: ' + authorize_url
code = raw_input('Enter verification code: ').strip()
credentials = flow.step2_exchange(code)

# Create an httplib2.Http object and authorize it with our credentials
http = httplib2.Http()
http = credentials.authorize(http)

drive_service = build('drive', 'v2', http=http)

# Insert a file
media_body = MediaFileUpload('bigfile.zip', mimetype='application/octet-stream', chunksize=1024*256, resumable=True)
body = {
    'title': 'bigfile.zip',
    'description': 'Big File',
    'mimeType': 'application/octet-stream'
}

retries = 0
request = drive_service.files().insert(body=body, media_body=media_body)
response = None
while response is None:
    try:
            print http.request.credentials.access_token
            status, response = request.next_chunk()
            if status:
                    print "Uploaded %.2f%%" % (status.progress() * 100)
                    retries = 0
    except errors.HttpError, e:
            if e.resp.status == 404:
                    print "Error 404! Aborting."
                    exit()
            else:   
                    if retries > 10:
                            print "Retries limit exceeded! Aborting."
                            exit()
                    else:   
                            retries += 1
                            time.sleep(2**retries)
                            print "Error (%d)... retrying." % e.resp.status
                            continue
print "Upload Complete!" 
```

经过一番挖掘，我发现授权的http对象在收到401后会自动刷新访问令牌。虽然它确实改变了访问令牌，但仍然没有按预期继续上传......见下面的输出：

```
ya29.AHES6ZTo_-0oDqwn3JnU2uCR2bRjpRGP0CSQSMHGr6KvgEE
Uploaded 2.28%
ya29.AHES6ZTo_-0oDqwn3JnU2uCR2bRjpRGP0CSQSMHGr6KvgEE
Uploaded 2.29%
ya29.AHES6ZTo_-0oDqwn3JnU2uCR2bRjpRGP0CSQSMHGr6KvgEE
Uploaded 2.29%
ya29.AHES6ZTo_-0oDqwn3JnU2uCR2bRjpRGP0CSQSMHGr6KvgEE
Uploaded 2.30%
ya29.AHES6ZTo_-0oDqwn3JnU2uCR2bRjpRGP0CSQSMHGr6KvgEE
Error (401)... retrying.
ya29.AHES6ZQqp3_qbWsTk4yVDdHnlwc_7GvPZiFIReDnhIIiHao
Error (401)... retrying.
ya29.AHES6ZSqx90ZOUKqDEP4AAfWCVgXZYT2vJAiLwKDRu87JOs
Error (401)... retrying.
ya29.AHES6ZTp0RZ6U5K5UdDom0gq3XHnyVS-2sVU9hILOrG4o3Y
Error (401)... retrying.
ya29.AHES6ZSR-IOiwJ_p_Dm-OnCanVIVhCZLs7H_pYLMGIap8W0
Error (401)... retrying.
ya29.AHES6ZRnmM-YIZj4S8gvYBgC1M8oYy4Hv5VlcwRqgnZCOCE
Error (401)... retrying.
ya29.AHES6ZSF7Q7C3WQYuPAWrxvqbTRsipaVKhv_TfrD_gef1DE
Error (401)... retrying.
ya29.AHES6ZTsGzwIIprpPhCrqmoS3UkPsRzst5YHqL-zXJmz6Ak
Error (401)... retrying.
ya29.AHES6ZSS_1ZBiQJvZG_7t5uW3alsy1piGe4-u2YDnwycVrI
Error (401)... retrying.
ya29.AHES6ZTLFbBS8mSFWQ9zK8cgbX8RPeLghPxkfiKY54hBB-0
Error (401)... retrying.
ya29.AHES6ZQBeMWY50z6fWXvaCcd5_AJr_AYOuL2aiNKpK-mmyU
Error (401)... retrying.
ya29.AHES6ZTs2mYYSEyOqI_Ms4itKDx36t39Oc5RNZHkV4Dq49c
Retries limit exceeded! Aborting. 
```

我正在使用安装了 Python 2.5.2 的 debian lenny，大约一周前通过 pip install 安装了 ssl 和 google-api-python-client。

提前感谢您的帮助。

**编辑：**显然，问题不在于 api。我尝试了上面相同的代码，但是有两个小文件，它们之间有 1h (system.sleep())。输出是：

```
ya29.AHES6ZRUssiLfuhqCP9Cu7C7LuhRV2rYzPldU27wiMJZWb8
Uploaded 66.89%
ya29.AHES6ZRUssiLfuhqCP9Cu7C7LuhRV2rYzPldU27wiMJZWb8
Upload 1 Complete!
ya29.AHES6ZRUssiLfuhqCP9Cu7C7LuhRV2rYzPldU27wiMJZWb8
Uploaded 57.62%
ya29.AHES6ZQd3o1ciwXpNFImH3CK0-dJAtQba_oeIO9DDbIq154
Upload 2 Complete! 
```

对于第二次上传，成功使用了新的访问令牌。那么，也许可恢复会话会在一段时间后到期，或者仅对该特定访问令牌有效？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-14T15:02:02.260

我[在 google-api-python-client 项目上提出了一个问题，根据 google 的](http://code.google.com/p/google-api-python-client/issues/detail?id=231)Joe Gregorio 的说法，问题出在后端：

“这是后端的问题，而不是 API 或您的代码的问题。正如您推断的那样，如果上传时间过长，access_token 将过期，此时无法继续可恢复的上传。有工作正在进行中立即修复此问题，一旦问题在服务器端得到修复，我将更新此错误。”

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-11T21:08:31.393

我认为问题是在 1-2 小时限制后，您对远程数据库的访问令牌过期；切断与远程服务器的连接。我认为您可以做的是查看您的主机 API 手册...他们应该在其中包含有关“刷新令牌”的内容（他们为您提供了另一个访问令牌，请注意，某些主机仅允许您在每个会话中使用一个刷新令牌），如果他们被允许无限量，您可以使用计时器和 AJAX 的组合来继续要求更多的访问令牌。

如果没有，那么您将对另一个授权令牌发出 AJAX 请求，并每小时将其交换为另一个访问令牌。这听起来像是一个非常严格的过程，但我认为这是你的令牌不断过期的唯一方法。

另外，您是否尝试过其他上传方法？如果你说上面的脚本运行了 1-2 个小时，它只上传了 1.44% 的文件，完全上传可能需要 100 多个小时（对于只有 3 Gig 来说太长了）。

# css - 如何在默认情况下或通过 CSS 将详细信息元素设置为 OPEN

> ID：14286406
> 
> 赞同：26
> 
> 时间：2013-01-11T20:49:55.337
> 
> 标签：css, html

HTML5 添加了两个用于标记文章目录的新元素：***details***和***summary***。

details 元素默认为关闭（隐藏除摘要元素之外的所有内容），单击时，它会展开以显示其内容。当它这样做时，它会向 details 元素添加一个“open”属性。

我希望元素默认打开，而不必将 open 属性添加到标记中。是否可以通过 CSS 做到这一点，或者脚本必须发挥作用？

例子：

```
<details>
<summary>Table of Contents</summary>
    <ul>
        <li><a href="#" class="active">Introduction</a></li>
        <li><a href="/2/">Body</a></li>
        <li><a href="/3/">Conclusion</a></li>
    </ul>
</details> 
```

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2014-11-27T10:27:13.190

您可以将 open 属性添加到 details 标签中，如下所示：

```
<details open>
    <summary>Table of Contents</summary>
    <ul>
        <li><a href="#" class="active">Introduction</a></li>
        <li><a href="/2/">Body</a></li>
        <li><a href="/3/">Conclusion</a></li>
    </ul>
</details>
```

该属性将默认展开

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2021-09-22T18:06:53.860

如果你想要一个 JS 解决方案，你可以给 details 元素一个 ID：

```
<details id="target-me">
 <summary>Table of Contents</summary>
  <ul>
    <li><a href="#" class="active">Introduction</a></li>
    <li><a href="/2/">Body</a></li>
    <li><a href="/3/">Conclusion</a></li>
  </ul>
</details> 
```

然后使用以下JS：

```
document.getElementById("target-me").open = true; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2020-12-05T08:22:57.120

您也可以使用下面的替代方法，它仍然可以打开和关闭，但最初它已打开，您可以对其进行测试（我提供了计算机的输出）：

```
<div>
    <h3>Open</h3>
    <details open>
        <summary>Always open</summary>
        Pellentesque habitant morbi tristique senectus et netus et malesuada fames ac turpis egestas.
    </details>
</div> 
```

检查下面的输出照片： ![](../Images/4c94932cfbfae54737a0e9af016bfb35.png)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2021-10-10T20:38:05.097

如果你想用 JavaScript 来做

```
const details = document.querySelector("details");
details.setAttribute("open", ""); 
```

相关[html5详细信息标签打开一一javascript函数工作奇怪](https://stackoverflow.com/questions/20023608/html5-details-tag-open-one-by-one-javascript-function-working-strange)

# python - scikits audiolab安装错误

> ID：14286409
> 
> 赞同：0
> 
> 时间：2013-01-11T20:50:08.283
> 
> 标签：python, linux, alsa, scikits

我正在使用 mint Linux Mint 13 maya (linux 3.2.0-23-generic x86-64)
我正在尝试安装 scikits.audiolab 来执行一些音频信号处理。我已经下载了所有先决条件，即（python-dev python-numpy python-setuptools libsndfile-dev）。我已将 site.cfg 设为

```
[sndfile]
include_dirs = /usr/include/
library_dirs = /usr/lib/x86_64-linux-gnu/ 
```

我收到以下错误

```
SndfileInfo:
    FOUND:
libraries = ['sndfile']
library_dirs = ['/usr/lib/x86_64-linux-gnu/']
include_dirs = ['/usr/include/']

    AlsaInfo:
libraries asound not found in /usr/local/lib
libraries asound not found in /usr/lib
scikits/audiolab/soundio/setup.py:21: UserWarning: Alsa not found - alsa backend not build
warnings.warn("Alsa not found - alsa backend not build")
CoreAudioInfo:
scikits/audiolab/soundio/setup.py:31: UserWarning: CoreAudio not found - CoreAudio backend not build
warnings.warn("CoreAudio not found - CoreAudio backend not build") 
```

当我做'$定位声音'时，我得到

```
/usr/include/alsa/asoundef.h
/usr/include/alsa/asoundlib.h
/usr/include/alsa/sound/asound_fm.h
/usr/include/linux/ultrasound.h
/usr/include/sound/asound.h
/usr/include/sound/asound_fm.h
/usr/include/sys/asoundlib.h
/usr/include/sys/ultrasound.h
/usr/include/x86_64-linux-gnu/sys/ultrasound.h
/usr/lib/i386-linux-gnu/libasound.so.2
/usr/lib/i386-linux-gnu/libasound.so.2.0.0
/usr/lib/i386-linux-gnu/alsa-lib/libasound_module_conf_pulse.so
/usr/lib/i386-linux-gnu/alsa-lib/libasound_module_ctl_arcam_av.so
/usr/lib/i386-linux-gnu/alsa-lib/libasound_module_ctl_bluetooth.so
/usr/lib/i386-linux-gnu/alsa-lib/libasound_module_ctl_oss.so
/usr/lib/i386-linux-gnu/alsa-lib/libasound_module_ctl_pulse.so
/usr/lib/i386-linux-gnu/alsa-lib/libasound_module_pcm_bluetooth.so
/usr/lib/i386-linux-gnu/alsa-lib/libasound_module_pcm_jack.so
/usr/lib/i386-linux-gnu/alsa-lib/libasound_module_pcm_oss.so
/usr/lib/i386-linux-gnu/alsa-lib/libasound_module_pcm_pulse.so
/usr/lib/i386-linux-gnu/alsa-lib/libasound_module_pcm_speex.so
/usr/lib/i386-linux-gnu/alsa-lib/libasound_module_pcm_upmix.so
/usr/lib/i386-linux-gnu/alsa-lib/libasound_module_pcm_usb_stream.so
/usr/lib/i386-linux-gnu/alsa-lib/libasound_module_pcm_vdownmix.so
/usr/lib/i386-linux-gnu/alsa-lib/libasound_module_rate_samplerate.so
/usr/lib/i386-linux-gnu/alsa-lib/libasound_module_rate_samplerate_best.so
/usr/lib/i386-linux-gnu/alsa-lib/libasound_module_rate_samplerate_linear.so
/usr/lib/i386-linux-gnu/alsa-lib/libasound_module_rate_samplerate_medium.so
/usr/lib/i386-linux-gnu/alsa-lib/libasound_module_rate_samplerate_order.so
/usr/lib/i386-linux-gnu/alsa-lib/libasound_module_rate_speexrate.so
/usr/lib/i386-linux-gnu/alsa-lib/libasound_module_rate_speexrate_best.so
/usr/lib/i386-linux-gnu/alsa-lib/libasound_module_rate_speexrate_medium.so
/usr/lib/x86_64-linux-gnu/libasound.so
/usr/lib/x86_64-linux-gnu/libasound.so.2
/usr/lib/x86_64-linux-gnu/libasound.so.2.0.0
/usr/lib/x86_64-linux-gnu/alsa-lib/libasound_module_conf_pulse.so
/usr/lib/x86_64-linux-gnu/alsa-lib/libasound_module_ctl_arcam_av.so
/usr/lib/x86_64-linux-gnu/alsa-lib/libasound_module_ctl_bluetooth.so
/usr/lib/x86_64-linux-gnu/alsa-lib/libasound_module_ctl_oss.so
/usr/lib/x86_64-linux-gnu/alsa-lib/libasound_module_ctl_pulse.so
/usr/lib/x86_64-linux-gnu/alsa-lib/libasound_module_pcm_bluetooth.so
/usr/lib/x86_64-linux-gnu/alsa-lib/libasound_module_pcm_jack.so
/usr/lib/x86_64-linux-gnu/alsa-lib/libasound_module_pcm_oss.so
/usr/lib/x86_64-linux-gnu/alsa-lib/libasound_module_pcm_pulse.so
/usr/lib/x86_64-linux-gnu/alsa-lib/libasound_module_pcm_speex.so
/usr/lib/x86_64-linux-gnu/alsa-lib/libasound_module_pcm_upmix.so
/usr/lib/x86_64-linux-gnu/alsa-lib/libasound_module_pcm_usb_stream.so
/usr/lib/x86_64-linux-gnu/alsa-lib/libasound_module_pcm_vdownmix.so
/usr/lib/x86_64-linux-gnu/alsa-lib/libasound_module_rate_samplerate.so
/usr/lib/x86_64-linux-gnu/alsa-lib/libasound_module_rate_samplerate_best.so
/usr/lib/x86_64-linux-gnu/alsa-lib/libasound_module_rate_samplerate_linear.so
/usr/lib/x86_64-linux-gnu/alsa-lib/libasound_module_rate_samplerate_medium.so
/usr/lib/x86_64-linux-gnu/alsa-lib/libasound_module_rate_samplerate_order.so
/usr/lib/x86_64-linux-gnu/alsa-lib/libasound_module_rate_speexrate.so
/usr/lib/x86_64-linux-gnu/alsa-lib/libasound_module_rate_speexrate_best.so
/usr/lib/x86_64-linux-gnu/alsa-lib/libasound_module_rate_speexrate_medium.so
/usr/share/doc/libasound2
/usr/share/doc/libasound2-dev
/usr/share/doc/libasound2-plugins
/usr/share/doc/libasound2/NEWS.Debian.gz
/usr/share/doc/libasound2/changelog.Debian.gz
/usr/share/doc/libasound2/copyright
/usr/share/doc/libasound2/examples
/usr/share/doc/libasound2/examples/asoundrc.txt.gz
/usr/share/doc/libasound2-plugins/README-arcam-av
/usr/share/doc/libasound2-plugins/README-jack
/usr/share/doc/libasound2-plugins/README-maemo.gz
/usr/share/doc/libasound2-plugins/README-pcm-oss
/usr/share/doc/libasound2-plugins/README-pulse
/usr/share/doc/libasound2-plugins/a52.txt
/usr/share/doc/libasound2-plugins/changelog.Debian.gz
/usr/share/doc/libasound2-plugins/copyright
/usr/share/doc/libasound2-plugins/examples
/usr/share/doc/libasound2-plugins/lavcrate.txt
/usr/share/doc/libasound2-plugins/samplerate.txt
/usr/share/doc/libasound2-plugins/speexdsp.txt
/usr/share/doc/libasound2-plugins/speexrate.txt
/usr/share/doc/libasound2-plugins/upmix.txt
/usr/share/doc/libasound2-plugins/vdownmix.txt
/usr/share/doc/libasound2-plugins/examples/a52.conf_pulse
/usr/share/doc/libasound2-plugins/examples/asound.conf_jack
/usr/share/doc/libasound2-plugins/examples/asound.conf_oss
/usr/share/local-repository/binary/lib32asound2_1.0.25-1ubuntu10_amd64.deb
/usr/src/linux-headers-3.2.0-23/include/linux/ultrasound.h
/usr/src/linux-headers-3.2.0-23/include/sound/asound.h
/usr/src/linux-headers-3.2.0-23/include/sound/asound_fm.h
/usr/src/linux-headers-3.2.0-23/include/sound/asoundef.h
/usr/src/linux-headers-3.2.0-23/sound/oss/dmasound
/usr/src/linux-headers-3.2.0-23/sound/oss/dmasound/Kconfig
/usr/src/linux-headers-3.2.0-23/sound/oss/dmasound/Makefile
/usr/src/linux-headers-3.2.0-23-generic/include/linux/ultrasound.h
/var/cache/apt/archives/libasound2-dev_1.0.25-1ubuntu10.1_amd64.deb
/var/lib/alsa/asound.state
/var/lib/dpkg/info/libasound2-dev.list
/var/lib/dpkg/info/libasound2-dev.md5sums
/var/lib/dpkg/info/libasound2-dev.postinst
/var/lib/dpkg/info/libasound2-plugins:amd64.list
/var/lib/dpkg/info/libasound2-plugins:amd64.md5sums
/var/lib/dpkg/info/libasound2-plugins:i386.list
/var/lib/dpkg/info/libasound2-plugins:i386.md5sums
/var/lib/dpkg/info/libasound2:amd64.list
/var/lib/dpkg/info/libasound2:amd64.md5sums
/var/lib/dpkg/info/libasound2:amd64.postinst
/var/lib/dpkg/info/libasound2:amd64.postrm
/var/lib/dpkg/info/libasound2:amd64.preinst
/var/lib/dpkg/info/libasound2:amd64.shlibs
/var/lib/dpkg/info/libasound2:amd64.symbols
/var/lib/dpkg/info/libasound2:i386.list
/var/lib/dpkg/info/libasound2:i386.md5sums
/var/lib/dpkg/info/libasound2:i386.postinst
/var/lib/dpkg/info/libasound2:i386.postrm
/var/lib/dpkg/info/libasound2:i386.preinst
/var/lib/dpkg/info/libasound2:i386.shlibs
/var/lib/dpkg/info/libasound2:i386.symbols 
```

如何让 setup.py 找到库。有什么我想念的吗？我在 Ubuntu Oneiric 上看到了[http://forum.ubuntu-fr.org/viewtopic.php?pid=3748397](http://forum.ubuntu-fr.org/viewtopic.php?pid=3748397)和[scikits.audiolab - ImportError: No module named _sndfile](https://stackoverflow.com/questions/8461055/scikits-audiolab-on-ubuntu-oneiric-importerror-no-module-named-sndfile)

这造成了如此多的挫败感

更新

在我的一台 PC 中，完全卸载 scikits-audiolab 和 alsa 并在重新安装 alsa 和 scikits-audiolab 之前更新 apt-get 后，此错误已被删除。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-08-04T14:25:21.487

以下使 alsa 音频后端在 Ubuntu 上为我工作。

按照[http://cournape.github.io/audiolab/installing.html#installation-from-sources](http://cournape.github.io/audiolab/installing.html#installation-from-sources)中的指示，安装 alsa 标头：

```
$ sudo apt-get install libasound2-dev 
```

在源目录中，

/path-to/scikits.audiolab-0.11.0/

或者，如果使用 pip（源默认下载到 /tmp）

/tmp/pip-build/scikits.audiolab

创建一个 site.cfg 文件，除了 [sndfile] 部分之外，还创建一个 [alsa] 部分：

```
[sndfile]
include_dirs = /usr/include
library_dirs = /usr/lib/x86_64-linux-gnu/
[alsa]
include_dirs = /usr/include/alsa
library_dirs = /usr/lib/x86_64-linux-gnu 
```

使用 locate 或 apt-file list 来查找 asoundlib.h (include_dirs) 和 libasound.so (library_dirs) 在系统中的位置。

好吧，在完成所有这些并尝试重新安装之后，它仍然无法正常工作。我不断收到同样令人沮丧的消息：

```
SndfileInfo:
  FOUND:
    libraries = ['sndfile']
    library_dirs = ['/usr/lib/x86_64-linux-gnu']
    include_dirs = ['/usr/include']

AlsaInfo:
  alsa not found
scikits/audiolab/soundio/setup.py:21: UserWarning: Alsa not found - alsa backend not build
  warnings.warn("Alsa not found - alsa backend not build") 
```

所以，我不得不使用这个黑客。打开文件 /path-to/scikits.audiolab-0.11.0/scikits/audiolab/soundio/setup.py 并替换

```
14 alsa_info = info_factory('alsa', ['asound'], ['alsa/asoundlib.h'],
15                          classname='AlsaInfo')() 
```

和

```
alsa_info = info_factory('alsa', ['asound'], ['asoundlib.h'],
                         classname='AlsaInfo')() 
```

如果这适用于更多人，我们可以请[David Cournapeau](https://stackoverflow.com/users/11465/david-cournapeau)（scikits.audiolab 作者）制作这个补丁。

# html - 为什么 img 标签会超出其宽度？

> ID：14286412
> 
> 赞同：2
> 
> 时间：2013-01-11T20:50:32.610
> 
> 标签：html, css

我正在尝试制作一个简单的页面：两个**居中**的缩略图图像。每个链接到其原始图像。这是代码（为了清楚起见，我删除了一些部分）：

```
 <!DOCTYPE html>
<html>
  <head>
    <style>
      .column1, .column2 {
      width:50%;
      float:left;
      }

      div img {
      display:block;
      margin:20px auto;
      width:300px;
      }
    </style>
  </head>
  <body>
    <div class="column1">
      <a href="#">
        <img src="maelstrom_mini.jpg" />
      </a>
    </div>
    <div class="column2">
      <a href="#">
        <img src="maelstrom_mini.jpg" />
      </a>
    </div>
  </body>
</html> 

```

问题非常微妙：每个图像只有 300 像素宽，但锚框比它应该包含的图像更宽。它使图像在其表面上方“可点击”。我不知道如何告诉锚不要扩散到它的所有列。

当我删除`display:block`样式表中的属性时，它解决了这个问题，但我的图片不再以包含列为中心。

拥有正确演示的正确解决方案是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-11T21:33:44.660

我已经解决了你的问题，

我在 a 和 img 标签周围添加了一个包装 div，将该宽度设置为 300px，然后将图像宽度设置为 100%，如下所示，

```
<!DOCTYPE html>
<html>
  <head>
    <style>
      .column1, .column2 {
      width:49%;
      float:left;
      border: 1px solid red;
      }

      div img {
      width:100%;
      }

      #img-wrap{

      width:300px;
       margin:20px auto;
      display: block;
      }

    </style>
  </head>
  <body>
    <div class="column1">
      <div id="img-wrap">
      <a href="#">
        <img src="" />
      </a>
      </div>
    </div>
    <div class="column2">
      <div id="img-wrap">
      <a href="#">
        <img src="" />
      </a>
        </div>
    </div>
  </body>
</html> 
```

可以在这里找到工作> [http://jsfiddle.net/3se2V/3/](http://jsfiddle.net/3se2V/3/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-11T20:52:33.440

我相信问题出`margin:20px auto;`在img上：

改变这个：

```
div img {
    display:block;
    margin:20px auto;
    width:300px;
} 
```

对此：

```
div { margin: 20px 0; }

div img {
    display:block;
    margin:0 auto;
    width:300px;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-11T21:27:46.947

我唯一可以复制这个问题的时间是我添加`display:block`到所有`a`元素。因此，我建议将其添加到您的 css 中：

```
div a {
  display:inline;
} 
```

这可能会解决您的问题。

# html - 从 div 和 css 构建的对话框布局不正确

> ID：14286413
> 
> 赞同：0
> 
> 时间：2013-01-11T20:50:37.550
> 
> 标签：html, css

我有一个无法正确显示的对话框，但我不知道为什么。该对话框由几个 div 组成。

该对话框由一个父 div 组成，其中包含标题、正文和页脚的三个子 div。每个子 div 进一步分为左、中、右 3 个子子 div。我无法弄清楚为什么我的左页脚 sub sub div 出现在右侧 body sub sub div 的右侧。

我已经简化了下面的 html，因此结构清晰。

```
<div class="dialog">
  <div class="titlebar">
    <div class="titlebarleft">
    </div>
    <div class="titlebarcenter">
    </div>
    <div class="titlebarright">
    </div>
  </div>
  <div class="con">
    <div class="conleft">
    </div>
    <div class="concenter">
    </div>
    <div class="conright">
    </div>
  </div>
  <div class="footer">
    <div class="footerleft">
    </div>
    <div class="footercenter">
    </div>
    <div class="footerright">
    </div>
  </div>
</div> 
```

大多数 CSS 与 3 个主要部分（标题栏、正文、页脚）中的每一个都相同

标题：

```
.titlebar {
    height: 38px;
    width: 100%;
} 
```

内容：

```
.con {
    background: url("../images/dialog/vertical.png") repeat-y scroll 0 0 #FFFFFF;
    font-family: Tahoma,"Lucida Grande",Verdana,Arial,Helvetica,sans-serif;
    font-size: 11px;
    width: 100%;
} 
```

页脚：

```
.footer {
    font-family: Tahoma,"Lucida Grande",Verdana,Arial,Helvetica,sans-serif;
    font-size: 11px;
    height: 37px;
    width: 100%;
} 
```

这是左页脚CSS：

```
.footerleft {
    background: url("../images/dialog/static.png") no-repeat scroll 0 -83px transparent;
    float: left;
    height: 100%;
    width: 9px;
} 
```

这是问题的图片： http: [//s9.postimage.org/ebj6w7ynj/Dialog_Corner.jpg](http://s9.postimage.org/ebj6w7ynj/Dialog_Corner.jpg)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-11T21:06:20.207

所有 div 元素都是 display:inline 。所以如果你在一个 div 元素之后写一个 div ，父元素的宽度会将 div 换成新行（如果两个 div 宽度大于父宽度）。现在您可以将 clear:both (floats) 设置为 .footer 类以在此元素之前换行。

```
.footer {
    font-family: Tahoma,"Lucida Grande",Verdana,Arial,Helvetica,sans-serif;
    font-size: 11px;
    height: 37px;
    width: 100%;
    clear:both;
} 
```

但我不确定这适用于所有浏览器。

# python - /23 处的 ImportError“没有名为 Python 的模块”

> ID：14286414
> 
> 赞同：1
> 
> 时间：2013-01-11T20:50:38.670
> 
> 标签：python, django, importerror

我正在向我的 Django 应用程序发出请求，并看到此问题标题中列出的错误。我理解导入错误的概念，但不明白为什么我会得到这个。

### 这是完整的追溯

```
Traceback:
File "/home/chaz/dev/envs/payments_bss_com/local/lib/python2.7/site-packages/django/core/handlers/base.py" in   
get_response
  89\.                     response = middleware_method(request)
File "/home/chaz/dev/envs/payments_bss_com/local/lib/python2.7/site-packages/django/middleware/common.py" in   
process_request
  67\.             if (not urlresolvers.is_valid_path(request.path_info, urlconf) and
File "/home/chaz/dev/envs/payments_bss_com/local/lib/python2.7/site-packages/django/core/urlresolvers.py" in is_valid_path
  531\.         resolve(path, urlconf)
File "/home/chaz/dev/envs/payments_bss_com/local/lib/python2.7/site-packages/django/core/urlresolvers.py" in resolve
  420\.     return get_resolver(urlconf).resolve(path)
File "/home/chaz/dev/envs/payments_bss_com/local/lib/python2.7/site-packages/django/core/urlresolvers.py" in resolve
  298\.             for pattern in self.url_patterns:
File "/home/chaz/dev/envs/payments_bss_com/local/lib/python2.7/site-packages/django/core/urlresolvers.py" in url_patterns
  328\.         patterns = getattr(self.urlconf_module, "urlpatterns", self.urlconf_module)
File "/home/chaz/dev/envs/payments_bss_com/local/lib/python2.7/site-packages/django/core/urlresolvers.py" in 
urlconf_module
  323\.             self._urlconf_module = import_module(self.urlconf_name)
File "/home/chaz/dev/envs/payments_bss_com/local/lib/python2.7/site-packages/django/utils/importlib.py" in import_module
  35\.     __import__(name)

Exception Type: ImportError at /23
Exception Value: No module named Python 
```

### 我的 URLConf

```
from django.conf.urls import patterns, include, url
from django.contrib.staticfiles.urls import staticfiles_urlpatterns

# Uncomment the next two lines to enable the admin:
from django.contrib import admin
admin.autodiscover()

urlpatterns = patterns('',
    url(r'^(?P<payment_id>\w+)/$', 'main.views.process_payment'),
    url(r'^admin/doc/', include('django.contrib.admindocs.urls')),
    url(r'^admin/', include(admin.site.urls),
)

urlpatterns += staticfiles_urlpatterns() 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-11T21:32:41.903

我的 ROOT_URL 被意外更改为`<app_name>.Python`. 上面第一条评论中链接的问题有一个类似（但不同）的问题。

# mysql - MySQL JOIN - 为左表中的重复结果返回 NULL

> ID：14286417
> 
> 赞同：1
> 
> 时间：2013-01-11T20:50:49.613
> 
> 标签：mysql, sql

我相信这是一件非常简单的事情，我发誓我以前做过，但我不记得怎么做了。

所以假设我有一个一对多的关系。我想加入这两个表，但不允许左表重复。

**[SQLFIDDLE](http://sqlfiddle.com/#!2/9ee5e/2)**

所以基于上面的 SQLFiddle，我的结果是：

```
categories.title  |  items.NAME  |  items.category_id
-----------------------------------------------------
red               | apple        | 1
red               | car          | 1
red               | paper        | 1
yellow            | lego         | 2
yellow            | banana       | 2
blue              | pen          | 3 
```

我希望它是：

```
categories.title  |  items.NAME  |  items.category_id
-----------------------------------------------------
red               | apple        | 1
NULL              | car          | 1
NULL              | paper        | 1
yellow            | lego         | 2
NULL              | banana       | 2
blue              | pen          | 3 
```

我的理由是，通过这种方式，我可以轻松地循环遍历结果，而无需使用 PHP 进行任何进一步的处理。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-11T20:55:28.020

您可以将这些值替换为以下内容：

```
select 
  case when rownum = 1 then title else null end title,
  name,
  category_id
from
(
  SELECT c.title, 
    i.name, 
    i.category_id,
    @row:=(case when @prev=title and @precat=category_id 
           then @row else 0 end) + 1 as rownum,
    @prev:=title ptitle,
    @precat:=category_id pcat
  FROM items AS i
  INNER JOIN categories AS c 
    ON c.id = i.category_id
   order by i.category_id, c.title
) src
order by category_id, rownum 
```

请参阅[带有演示的 SQL Fiddle](http://sqlfiddle.com/#!2/9ee5e/27)

结果是：

```
|  TITLE |   NAME | CATEGORY_ID |
---------------------------------
|    red |  apple |           1 |
| (null) |    car |           1 |
| (null) |  paper |           1 |
| yellow |   lego |           2 |
| (null) | banana |           2 |
|   blue |    pen |           3 | 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2021-01-19T04:14:12.380

这可能是很久以前的帖子了。但我会将我的答案发布给未来的读者。还有另一个过程轻松且易于理解。

您可以充分利用变量。不需要子查询。

```
SET @previous:="";

SELECT
  IF(C.title=@previous, "", @previous:=C.title) AS Titles,
  I.name, I.category_id
FROM items I
INNER JOIN categories AS C ON C.id = I.category_id
ORDER BY I.id, I.name 
```

`@previous`是正在使用的变量。

[**SQL 小提琴演示**](http://sqlfiddle.com/#!9/4fdbf/92)

# python - 有没有办法使用 python 子进程创建一个新的 P4 更改列表？

> ID：14286418
> 
> 赞同：0
> 
> 时间：2013-01-11T20:50:53.233
> 
> 标签：python, subprocess, perforce

多年前的这个问题满足了我的需要：

[如何在 python 中从 perforce 中签出文件？](https://stackoverflow.com/questions/184187/how-do-i-check-out-a-file-from-perforce-in-python)

但是有没有办法使用 subprocess 模块来做到这一点？（我理解这是首选方式）

我查看了 stackoverflow、python 文档以及许多谷歌搜索，试图找到一种方法来使用标准输入将所需的输入发送到 p4 进程，但我没有成功。我已经能够在捕获子进程命令的输出方面找到很多东西，但无法理解输入命令。

一般来说，我对 python 很陌生，所以我可能会遗漏一些明显的东西，但我不知道在这种情况下我不知道什么。

这是我到目前为止提出的代码：

```
descr = "this is a test description"
tempIn = tempfile.TemporaryFile()
tempOut = tempfile.TemporaryFile()
p = subprocess.Popen(["p4","change","-i"],stdout=tempOut, stdin=tempIn)
tempIn.write("change: New\n")
tempIn.write("description: " + descr)
tempIn.close()

(out, err) = p.communicate()
print out 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-11T21:39:30.370

正如我在评论中提到的，[使用 Perforce Python API](https://stackoverflow.com/a/184344/99377)。

关于您的代码：

`tempfile.TemporaryFile()`通常不适合创建文件然后将内容传递给其他东西。[临时文件一关闭就会自动删除。](http://docs.python.org/2/library/tempfile.html#tempfile.TemporaryFile)通常，您需要先关闭文件进行写入，然后才能重新打开文件进行读取，这会造成 catch-22 情况。（您可以使用 来解决这个问题`tempfile.NamedTemporaryFile(delete=False)`，但对于这种情况来说，这仍然过于迂回。）

要使用`communicate()`，[您需要传递 subprocess.PIPE](http://docs.python.org/2/library/subprocess.html#subprocess.Popen.communicate)：

```
descr = "this is a test description"
changespec = "change: New\ndescription: " + descr

p = subprocess.Popen(["p4","change","-i"], stdin=subprocess.PIPE, stdout=subprocess.PIPE, stderr=subprocess.PIPE)

(out, err) = p.communicate(changespec)
print out 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-11T22:16:03.207

如果`stdout`不是无限的，则使用[@Jon-Eric 的答案](https://stackoverflow.com/a/14287078/4279)，否则替换`p.communicate()`为`rc = p.wait(); tempOut.seek(0); chunk = tempOut.read(chunk_size) ...`.

# c# - C# 对象大小开销

> ID：14286421
> 
> 赞同：10
> 
> 时间：2013-01-11T20:51:05.123
> 
> 标签：c#, c#-4.0

我正在优化内存消耗应用程序。对此，我对 C# 引用类型大小开销有疑问。

C# 对象消耗与其字段一样多的字节，加上一些**额外的管理开销**。我认为不同 .NET 版本和实现的管理开销可能不同。

您知道C# 对象（C# 4.0 和 Windows 7 和 8 环境）的**管理开销的大小（或最大大小，如果开销是可变的）？**

32 位或 64 位 .NET 运行时的管理开销是否不同？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2013-01-11T20:58:04.283

通常，GC 分配的每个对象有 8 或 12 字节的开销。在 32 位运行时，syncblk 有 4 个字节，类型句柄有 4 个字节，在 64 位运行时有 8 个字节。有关详细信息，请参阅MSDN 杂志上[深入了解 .NET 框架内部以了解 CLR 如何创建运行时对象](http://msdn.microsoft.com/en-us/magazine/cc163791.aspx#S7)的“ObjectInstance”部分。

请注意，实际引用在 32 位或 64 位 .NET 运行时也会发生变化。

此外，可能存在填充类型以适应地址边界，但这在很大程度上取决于所讨论的类型。这也可能导致对象之间的“空白空间”，但取决于运行时（大多数情况下，尽管您可以使用[StructLayoutAttribute](http://msdn.microsoft.com/en-us/library/system.runtime.interopservices.structlayoutattribute.pack.aspx)影响它）来确定何时以及如何对齐数据。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2013-01-11T21:40:32.000

网上有一篇标题为“.NET 对象的真相和在 AppDomains 之间共享它们”的文章，其中显示了一些转子源代码和一些实验对象并通过普通指针在应用程序域之间共享它们的结果。

[http://geekswithblogs.net/akraus1/archive/2012/07/25/150301.aspx](http://geekswithblogs.net/akraus1/archive/2012/07/25/150301.aspx)

*   所有 32 位版本的 CLR 为 12 个字节
*   所有 64 位版本的 CLR 为 24 字节

通过将数百万个对象 (N) 添加到数组中，您可以很容易地对此进行测试。由于指针大小是已知的，您可以通过将该值除以 N 来计算对象大小。

```
var initial = GC.GetTotalMemory(true);
const int N = 10 * 1000 * 1000;
var arr = new object[N];
for (int i = 0; i < N; i++)
{
    arr[i] = new object();
}

var ObjSize = (initial - GC.GetTotalMemory(false) - N * IntPtr.Size) / N; 
```

在您的 .NET 平台上获得一个近似值。

对象大小实际上被定义为允许 GC 对最小对象大小做出假设。

```
\sscli20\clr\src\vm\object.h

//
// The generational GC requires that every object be at least 12 bytes
// in size.   
#define MIN_OBJECT_SIZE     (2*sizeof(BYTE*) + sizeof(ObjHeader)) 
```

例如 32 位，这意味着最小对象大小为 12 个字节，这会留下一个 4 字节的漏洞。对于空对象，这个洞是空的，但是如果你将例如 int 添加到你的空类中，那么它就会被填充并且对象大小保持在 12 个字节。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2013-01-11T20:58:54.887

对象有两种类型的开销：

*   用于处理对象的内部数据。
*   数据成员之间的填充。

内部数据是两个指针，因此在 32 位应用程序中为 8 字节，在 64 位应用程序中为 16 字节。

数据成员被填充，以便它们从偶数地址边界开始。例如，如果您在类中有 a`byte`和 an ，则可能会用三个未使用的字节填充，以便从下一个机器字边界开始。`int``byte``int`

类的布局由 JIT 编译器确定，具体取决于系统的体系结构（并且可能因框架版本而异），因此 C# 编译器不知道。

# php - 创建 HTML 页眉和页脚以在 wordpress 中包装第三方内容

> ID：14286422
> 
> 赞同：1
> 
> 时间：2013-01-11T20:51:06.807
> 
> 标签：php, wordpress

我需要从我的 WordPress php 创建一个 HTML 页眉和页脚文件。我需要为为我构建页面的第三方提供这些文件。基本布局是：

header.html 他们的内容 footer.html

如何动态创建 header.html 和 footer.html？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-11T21:14:26.850

如果您认为您不会很快更改主题，只需保存其中一页的源代码，然后剪切并粘贴即可。

或者，您可以浏览到模板存储页眉的任何包含文件，然后将视图源保存为 header.html 和页脚。

用户 JQuery 将 inc 文件加载到 html 页面的正文中

```
<html>
   <script src="path/to/jquery">...
    ...
   <body>
         loading include
   </body>
   <script>
      $(document).ready(function($) {
        $('body').load('path/to/include.php', function() {
          /// do nothing
        });
      });
  </script>
</html> 
```

或者更好的是，我认为他们会给你一个页面，上面有你的页眉，他们的废话，你的页脚。如果那是真的

头...

```
<html>
 ...
 <body>
    <div id="their-crap"> 
```

页脚...

```
 </div>
 </body>
</html> 
```

然后你想把这些数据放在哪里，做

```
<script>
      $(document).ready(function($) {
        $('selector-you-want').load('path/to/renderedpage#their-crap', function() {
          /// do nothing
        });
      });
</script> 
```

# c# - 将 C# 库移植到 Windows Phone 8？

> ID：14286423
> 
> 赞同：5
> 
> 时间：2013-01-11T20:51:11.323
> 
> 标签：c#, winforms, windows-phone-8

我在 Visual C# 上为 winforms 应用程序的项目使用 Math.NET Neodym 库。

这是项目的链接：[Math.NET Neodym](http://www.mathdotnet.com/Neodym.aspx) 现在，我想将它移植到 Windows Phone 8，当在 WP8 SDK 中添加对库的引用时，我收到如下错误：

> 无法添加对更高版本或不兼容程序集的引用

现在，我以前问过这个问题，并且我被告知我可以通过重新编译将库移植到 WP8。我不知道该怎么做？我是否只是将库中的每个文件复制粘贴到一个新的 WP8 库项目中并编译？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-11T20:54:19.443

最简单的方法是将项目转换为[Portable Class Library](http://msdn.microsoft.com/en-us/library/gg597391.aspx)。这将允许 Windows Phone 以及桌面应用程序使用它。

您应该能够只打开解决方案，并更改相应的项目属性来执行此操作。但是，如果目标框架不支持任何类型，则需要重新处理或删除库的这些部分。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-12T18:15:13.143

Please see the answer to this question at a [previous post](https://stackoverflow.com/a/13698737/81687). This might not be an issue with "higher version", just VS2012 having an irrelevant error message.

# javascript - 比较日期和时间 Javascript

> ID：14286425
> 
> 赞同：2
> 
> 时间：2013-01-11T20:51:16.817
> 
> 标签：javascript

好的，我无法理解这一点，我看了很多关于 SF 的帖子，但无法弄清楚。

我需要比较两个日期和时间，开始和结束。如果 end 很好，那么 alert();

适用于 Chrome 但不适用于 IE(9)（格式为：2013 年 1 月 1 日 10:00）

```
var stDate = new Date(date +" "+ start);
var enDate = new Date(dateEnd + " "+ end);

        if ( Date.parse ( enDate ) > Date.parse ( stDate ) ) {
            alert('on no');
        } 
```

请帮忙，我卡住了...

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-11T22:10:39.510

只需制作一个自定义解析器，它比试图弄清楚不同的浏览器如何处理各种时间字符串格式更快：

```
function parse(datestring){
    var months = {"Jan":0,"Feb":1,"Mar":2,"Apr":3,"May":4,"Jun":5,"Jul":6,"Aug":7,"Sep":8,"Oct":9,"Nov":10,"Dec":11}
    var timearray = datestring.split(/[\-\ \:]/g)
    return Date.UTC(timearray[2],months[timearray[1]],timearray[0],timearray[3],timearray[4])
} 
```

这将返回以毫秒为单位的 Unix 时间，并且它使用 UTC，从而避免因缺少夏令时时间而引起的并发症。它适用于您指定的格式，但不验证输入。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-11T20:52:40.580

```
if ( enDate.getTime() > stDate.getTime() ) {
    alert('oh no');
} 
```

推送到数字（`+enDate`）与使用`.getTime()`方法相同：

```
if ( +enDate > +stDate ) {
    alert('oh no');
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-11T20:57:59.247

```
var stDate = new Date(date +" "+ start);
var enDate = new Date(dateEnd + " "+ end);

        if ( enDate.getTime() > stDate.getTime() ) {
            alert('on no');
        } 
```

* * *

创建日期对象：

```
var d = new Date();
var d = new Date(milliseconds);
var d = new Date(dateString);
var d = new Date(year, month, day, hours, minutes, seconds, milliseconds); 
```

getTime() 返回自 1970/01/01 以来的毫秒数

# java - java - 如何使用java查找网络接口是否是移动的

> ID：14286431
> 
> 赞同：0
> 
> 时间：2013-01-11T20:51:28.577
> 
> 标签：java, networking

我需要确定使用 Windows 7 的活动网络接口是 USB 调制解调器还是典型的以太网接口。

有没有办法使用Java做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-11T21:11:27.630

您可以列出[网络接口](http://docs.oracle.com/javase/tutorial/networking/nifs/listing.html)，也可以使用[isPointToPoint或](http://docs.oracle.com/javase/tutorial/networking/nifs/parameters.html)[NetworkInterface](http://docs.oracle.com/javase/6/docs/api/java/net/NetworkInterface.html)类中的其他东西来检测调制解调器连接。

# c# - 为什么我不能在 HTTP 响应标头中设置“允许”？

> ID：14286436
> 
> 赞同：10
> 
> 时间：2013-01-11T20:51:49.553
> 
> 标签：c#, asp.net-mvc, asp.net-web-api

我使用 ASP.NET Web Api 编写了一个 RESTful API。现在我试图让它返回控制器允许的动词。我正在尝试使用以下代码来做到这一点：

```
[AcceptVerbs("OPTIONS")]
public HttpResponseMessage Options()
{
    var response = new HttpResponseMessage(HttpStatusCode.OK);
    response.Headers.Add("Access-Control-Allow-Origin", "*");
    response.Headers.Add("Access-Control-Allow-Methods", "POST");
    response.Headers.Add("Allow", "POST");

    return response;
} 
```

但是，我没有在我的回复中获得允许标头，而是获得了`500 Internal Server Error`. 在调试时，我收到以下错误：

```
{"Misused header name. Make sure request headers are used with HttpRequestMessage, response headers with HttpResponseMessage, and content headers with HttpContent objects."} 
```

可以设置该标题吗？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2013-01-11T21:04:31.813

正如错误消息所说，您必须将内容标头与`HttpContent`对象一起使用。

```
response.Content.Headers.Add("Allow", "POST"); 
```

必须承认这是一个奇怪的 API ......

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-11T21:10:01.083

Allow 是一个内容标头。

```
 response.Content.Headers.Allow.Add("POST"); 
```

# d3.js - d3到底选择了什么？

> ID：14286443
> 
> 赞同：0
> 
> 时间：2013-01-11T20:52:39.043
> 
> 标签：d3.js

这是一些代码。它的变量名称很差，而且是错误的。原始示例只有圆圈，这就是为什么选择圆圈但现在它有组的原因。但是，此代码目前可以正常工作。它像我期望的那样绘制正方形和圆形。

使用控制台我看到“圆圈”`Array[3]`但我无法弄清楚元素是什么或它们的类型。自启动以来，由于没有创建 svg 元素，怎么可能有 3 个？

无论如何，我想知道真正应该叫什么圈子？在“g”上进行全选似乎给了我同样的效果。我猜 selectAll 正在尝试进行选择并且有 0 个元素但继续以某种方式工作，或者 selectAll 实际上返回 svg 但在这种情况下我为什么要创建一个新变量。我也不确定为什么这些例子和我正在做这方面的数据。circle 实际上是否返回了我现在设置数据的内部 d3 对象？它与svg或dom有什么关系吗？我只是很困惑为什么我是 selectAll 并在选择时调用数据。

```
<!DOCTYPE html>
<meta charset="utf-8">
<body>
<style>
</style>

<script src="http://d3js.org/d3.v3.js"></script>
<script>

(function() {

var svg = d3.select('body').append('svg').attr('width', 900);

var circle = svg.selectAll("circle")
    .data([32, 57, 293]);

circle.enter()
.append("g")
.call(function(gs) {
    gs.append("rect").attr("width", 20).attr("height", 20).attr("x", String);
    gs.append("circle").attr("cy", 90).attr("cx", String).attr("r", Math.sqrt);
})
.attr('class', 'test');
circle.exit().remove()

})();

</script>
</body> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-11T21:39:43.467

`circle`当前包含三个 SVGGElement 或`"g"`s，每个都包含一个圆形和一个矩形，它们在您的示例中是*.append* -ed。

来自 MDN：

> g 元素是用于对对象进行分组的容器。应用于 g 元素的转换在其所有子元素上执行。应用的属性由子元素继承。此外，它还可用于定义稍后可以用元素引用的复杂对象。

`selectAll("some-container")`将返回与该名称匹配的元素，或者将创建一个新元素并返回它。请参阅[https://github.com/mbostock/d3/wiki/Selections#wiki-d3_selectAll](https://github.com/mbostock/d3/wiki/Selections#wiki-d3_selectAll)

尝试在第 27 行添加这些以查看您的圈子的 x 值：

```
alert("x1: " + d3.select(circle.selectAll("circle")[0][0]).attr("cx"));
alert("x2: " + d3.select(circle.selectAll("circle")[1][0]).attr("cx"));
alert("x3: " + d3.select(circle.selectAll("circle")[2][0]).attr("cx")); 
```

# pyrocms - 从博客页面 pyrocms 更改名称 url

> ID：14286445
> 
> 赞同：-1
> 
> 时间：2013-01-11T20:52:48.137
> 
> 标签：pyrocms

我想更改博客模块上的页面名称..

我需要它像“新闻”一样显示

例子：

/blog/post-title -> /news/post-title

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-15T18:22:29.677

有两种方法可以做到这一点。

首先是将博客模块复制为新闻。请参阅以下 Gist 脚本：[https ://gist.github.com/3949038](https://gist.github.com/3949038)

第二个是创建一个重定向`blogs`到的路由`news`。请参阅： [更改模块的 uri 而无需重命名 PyroCMS 中的类](https://stackoverflow.com/questions/10899376/change-the-uri-of-a-module-without-renaming-the-class-in-pyrocms)

# javascript - JS 设置的 dropDownList 一个然后处理 indexChanged 事件

> ID：14286446
> 
> 赞同：0
> 
> 时间：2013-01-11T20:52:48.583
> 
> 标签：javascript, drop-down-menu, asp-classic

我的 DropDownList 控件有问题。我有三个值“select”、“test1”、“test2”。首先我手动选择“test2”值然后我必须通过 JS 设置“select”值

```
 var ddlTestData = document.getElementById("<%= testDataDDL.ClientID %>");
  ddlTestData.selectedIndex = 0; 
```

它工作正常，但是当我选择“test2”值时，我的`TestData_IndexChanged`事件没有开始。

在此先感谢您的帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-12T03:28:34.757

从您的问题来看，您似乎真的在寻找 ASP.Net 的答案——经典的 ASP 没有`ClientId`属性。

有了这个假设，您的 IndexChanged 事件是否连接到您的 testDataDDL 下拉列表控件（您需要在代码中设置它）——是`"OnSelectedIndexChanged"`吗？此外，您可能需要设置`AutoPostBack="True"`.

# ruby-on-rails - 在 link_to Rails 上截断助手

> ID：14286455
> 
> 赞同：4
> 
> 时间：2013-01-11T20:53:49.260
> 
> 标签：ruby-on-rails, ruby-on-rails-3, truncate

是否可以使用 truncate helper 截断 rails 中的 link_to 当然，我的应用程序中有这个 link_to

```
<%= link_to b.bookname, b %> 
```

这是在 a .each 中，所以我正在通过 b 例如

搞砸了一些变化，但目前无法开始工作，

以前有人做过吗？

谢谢

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-11T20:58:18.587

使用[截断](http://apidock.com/rails/ActionView/Helpers/TextHelper/truncate)助手

```
<%= link_to truncate(b.bookname, :length => 5), b %> 
```

# windows - 在 Windows 命令行中使用批处理文件中的参数

> ID：14286457
> 
> 赞同：175
> 
> 时间：2013-01-11T20:53:56.683
> 
> 标签：windows, batch-file, cmd, parameters, arguments

在 Windows 中，如何访问批处理文件运行时传递的参数？

例如，假设我有一个名为`hello.bat`. 当我`hello -a`在 Windows 命令行中输入时，如何让我的程序知道`-a`作为参数传入的？

* * *

## 回答 #1

> 赞同：311
> 
> 时间：2013-01-12T22:46:27.300

正如其他人已经说过的那样，通过命令行传递的参数可以在批处理文件中使用符号`%1`to访问`%9`。您还可以使用另外两个令牌：

*   `%0`是**命令行中指定的可执行文件（批处理文件）名称**。
*   `%*`是**命令行中指定的所有参数**——如果你想将参数转发给另一个程序，这非常有用。

除了简单地如何访问参数之外，还有许多重要的技术需要注意。

### 检查是否传递了参数

这是通过类似的结构来完成的`IF "%~1"==""`，当且仅当根本没有传递任何参数时才成立。请注意波浪字符，它会导致从`%1`; 的值中删除任何周围的引号。如果该值包含双引号，则如果没有波浪号，您将得到意外的结果，包括语法错误的可能性。

### 处理超过 9 个参数（或者只是让生活更轻松）

如果您需要访问超过 9 个参数，则必须使用命令`SHIFT`。此命令将所有参数的值移动一个位置，以便`%0`获取 的值`%1`，`%1`获取 的值`%2`等。`%9`获取第十个参数的值（如果存在），在调用之前无法通过任何变量获得`SHIFT`（输入命令`SHIFT /?`以获得更多选项）。

`SHIFT`当您想要轻松处理参数而不要求它们以特定顺序显示时，它也很有用。例如，脚本可以以任何顺序识别`-a`标志`-b`。在这种情况下解析命令行的一个好方法是

```
:parse
IF "%~1"=="" GOTO endparse
IF "%~1"=="-a" REM do something
IF "%~1"=="-b" REM do something else
SHIFT
GOTO parse
:endparse
REM ready for action! 
```

该方案允许您解析非常复杂的命令行而不会发疯。

### 批量参数替换

对于表示文件名的参数，shell 提供了许多与处理无法以任何其他方式访问的文件相关的功能。使用以 开头的构造访问此功能`%~`。

例如，要获取作为参数传入的文件的大小，请使用

```
ECHO %~z1 
```

要获取启动批处理文件的目录的路径（非常有用！），您可以使用

```
ECHO %~dp0 
```

`CALL /?`您可以通过在命令提示符中键入来查看这些功能的全部范围。

* * *

## 回答 #2

> 赞同：59
> 
> 时间：2013-01-11T21:03:06.737

**在批处理文件中使用参数: %0 和 %9**

批处理文件可以使用标记引用作为参数传入的单词：`%0`to `%9`。

```
%0 is the program name as it was called.
%1 is the first command line parameter
%2 is the second command line parameter
and so on till %9. 
```

在命令行中传入的参数必须是字母数字字符并以空格分隔。由于`%0`是程序名，`%0`如果在引导时启动，则在 DOS 中 AUTOEXEC.BAT 将为空。

**例子：**

将以下命令放入名为的批处理文件中`mybatch.bat`：

```
@echo off
@echo hello %1 %2
pause 
```

像这样调用批处理文件：`mybatch john billy`将输出：

```
hello john billy 
```

**为一个批处理文件获取超过 9 个参数，使用：%***

百分比星标记`%*`表示“其余参数”。您可以使用 for 循环来抓取它们，如此处所定义：

[http://www.robvanderwoude.com/parameters.php](http://www.robvanderwoude.com/parameters.php)

**关于批处理参数分隔符的说明**

批处理文件会忽略命令行参数中的某些字符，具体取决于 DOS 版本，是否“转义”，并且通常取决于它们在命令行中的位置：

```
commas (",") are replaced by spaces, unless they are part of a string in 
double quotes

semicolons (";") are replaced by spaces, unless they are part of a string in 
double quotes

"=" characters are sometimes replaced by spaces, not if they are part of a 
string in double quotes

the first forward slash ("/") is replaced by a space only if it immediately 
follows the command, without a leading space

multiple spaces are replaced by a single space, unless they are part of a 
string in double quotes

tabs are replaced by a single space

leading spaces before the first command line argument are ignored 
```

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2018-06-02T02:29:25.687

@Jon 的`:parse`/`:endparse`计划是一个很好的开始，他对最初的通过表示感谢，但如果你认为 Windows 折磨人的批处理系统会让你轻松......好吧，我的朋友，你会感到震惊。我花了一整天的时间在这个恶魔上，经过许多痛苦的研究和实验，我终于设法为现实生活中的实用程序提供了一些可行的东西。

假设我们要实现一个实用程序`foobar`。它需要一个初始命令。它有一个可选参数`--foo`，它带有一个*可选*值（当然不能是另一个参数）；如果缺少该值，则默认为`default`. 它还有一个可选参数`--bar`，它采用*必需*的值。最后，它可以带一个`--baz`不允许值的标志。哦，这些参数可以按任何顺序出现。

换句话说，它看起来像这样：

```
foobar <command> [--foo [<fooval>]] [--bar <barval>] [--baz] 
```

复杂？不，这似乎是现实生活实用程序的典型。（`git`有人吗？）

事不宜迟，这里有一个解决方案：

```
@ECHO OFF
SETLOCAL
REM FooBar parameter demo
REM By Garret Wilson

SET CMD=%~1

IF "%CMD%" == "" (
  GOTO usage
)
SET FOO=
SET DEFAULT_FOO=default
SET BAR=
SET BAZ=

SHIFT
:args
SET PARAM=%~1
SET ARG=%~2
IF "%PARAM%" == "--foo" (
  SHIFT
  IF NOT "%ARG%" == "" (
    IF NOT "%ARG:~0,2%" == "--" (
      SET FOO=%ARG%
      SHIFT
    ) ELSE (
      SET FOO=%DEFAULT_FOO%
    )
  ) ELSE (
    SET FOO=%DEFAULT_FOO%
  )
) ELSE IF "%PARAM%" == "--bar" (
  SHIFT
  IF NOT "%ARG%" == "" (
    SET BAR=%ARG%
    SHIFT
  ) ELSE (
    ECHO Missing bar value. 1>&2
    ECHO:
    GOTO usage
  )
) ELSE IF "%PARAM%" == "--baz" (
  SHIFT
  SET BAZ=true
) ELSE IF "%PARAM%" == "" (
  GOTO endargs
) ELSE (
  ECHO Unrecognized option %1\. 1>&2
  ECHO:
  GOTO usage
)
GOTO args
:endargs

ECHO Command: %CMD%
IF NOT "%FOO%" == "" (
  ECHO Foo: %FOO%
)
IF NOT "%BAR%" == "" (
  ECHO Bar: %BAR%
)
IF "%BAZ%" == "true" (
  ECHO Baz
)

REM TODO do something with FOO, BAR, and/or BAZ
GOTO :eof

:usage
ECHO FooBar
ECHO Usage: foobar ^<command^> [--foo [^<fooval^>]] [--bar ^<barval^>] [--baz]
EXIT /B 1 
```

是的，它真的那么糟糕。[请参阅我在https://stackoverflow.com/a/50653047/421049](https://stackoverflow.com/a/50653047/421049)上的类似帖子，其中我对逻辑中发生的事情以及我使用某些构造的原因进行了更多分析。

可怕。我今天必须学习的大部分内容。而且很痛。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2013-01-11T21:06:24.170

批处理文件会在程序之后自动传递文本，只要它们是分配给它们的变量。它们按发送顺序传递；例如 %1 将是调用程序后发送的第一个字符串，等等。

如果你有 Hello.bat 并且内容是：

```
@echo off
echo.Hello, %1 thanks for running this batch file (%2)
pause 
```

你通过命令调用批处理

> hello.bat APerson241 %date%

您应该收到此消息：

您好，APerson241 感谢您运行此批处理文件 (01/11/2013)

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2013-01-11T21:02:51.577

使用变量，即`.BAT`变量并调用`%0``%9`

# google-apps-script - Browser.inputBox 在 GoogleScript 网络应用程序中不起作用

> ID：14286458
> 
> 赞同：1
> 
> 时间：2013-01-11T20:53:57.403
> 
> 标签：google-apps-script

如果我在电子表格中运行我的应用程序，此代码将起作用

```
var name = Browser.inputBox("Enter your name"); 
```

但是当我将它部署为 Web 应用程序时，它不起作用。在 GoogleScript 网络应用程序中，还有哪些其他替代方法可用于从用户那里获取信息？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-01-09T23:50:32.587

请参阅[UI 服务](https://developers.google.com/apps-script/uiapp)指南和[Html 服务指南，](https://developers.google.com/apps-script/html_service)其中介绍了为 Google Apps WebApps 创建用户界面的两种主要方法。

# php - 将变量分配给行

> ID：14286459
> 
> 赞同：-1
> 
> 时间：2013-01-11T20:54:01.880
> 
> 标签：php, mysql, variables

在下面的示例中，我正在提取六个随机行，并希望将变量之一（a、b、c、d、e、f）分配给每个生成的行。

```
$result = mysql_query("SELECT * FROM cub_posts WHERE active = 'Y' ORDER BY rand() LIMIT 6") or die(mysql_error());
while ($row = mysql_fetch_array($result)) {
    $demo_id = 'a, b, c, d, e, f';

    echo '<div class="span4 span-box">
    <div id="demo5'.$demo_id.'" class="ho-box demo5">'.$row['title'].'</div>
    </div>';
} 
```

所以输出将是：

```
<div class="span4 span-box">
<div id="demo5a" class="ho-box demo5">Title</div>
</div>
<div class="span4 span-box">
<div id="demo5b" class="ho-box demo5">Title</div>
</div>
<div class="span4 span-box">
<div id="demo5c" class="ho-box demo5">Title</div>
</div>
<div class="span4 span-box">
<div id="demo5d" class="ho-box demo5">Title</div>
</div>
<div class="span4 span-box">
<div id="demo5e" class="ho-box demo5">Title</div>
</div>
<div class="span4 span-box">
<div id="demo5f" class="ho-box demo5">Title</div>
</div> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-11T20:57:45.480

将演示移到循环之外

```
$demo_id = array('a', 'b', 'c', 'd', 'e', 'f');  
$counter;
while ($row = mysql_fetch_array($result)) { 
    echo '<div class="span4 span-box">
    <div id="demo5'.$demo_id[$counter].'" class="ho-box demo5">'.$row['title'].'</div>
    </div>';
    $counter++;
} 
```

但是，如果您有超过 6 个结果，它将失败。Demo id 可以包含所有字母：

```
$demo_id = range("a","z"); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-11T20:57:57.663

尽管你不应该使用`mysql_`njk 很好地总结的函数，但不难想出一些处理前 26 行的东西：

```
$demo_id = 'a';
while ($row = mysql_fetch_array($result)) { 
 echo '<div class="span4 span-box">';
 echo '<div id="demo5'.$demo_id.'" class="ho-box demo5">'.$row['title'].'</div>';
 echo '</div>';
 ++$demo_id;
} 
```

但是你需要考虑当超过 26 个时会发生什么。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-11T21:04:21.983

您可以添加一个计数器。

```
$result = mysql_query("SELECT * FROM cub_posts WHERE active = 'Y' ORDER BY rand() LIMIT 6") or die(mysql_error());

$demo_id = array('a', 'b', 'c', 'd', 'e', 'f');  

$i=0;

while ($row = mysql_fetch_array($result)) { 

echo '<div class="span4 span-box">
<div id="demo5'.$demo_id[$i].'" class="ho-box demo5">'.$row['title'].'</div>
</div>';

 $i++;
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-11T21:02:54.437

```
$char = 97
while ($row = mysql_fetch_array($result)) {
    echo '<div class="span4 span-box">';
    echo '<div id="demo5'.chr($char).'" class="ho-box demo5">'.$row['title'].'</div>';
    echo '</div>';
    $char++;
} 
```

# android - 如何使用自定义 ListView 清除 ArrayAdapter

> ID：14286460
> 
> 赞同：3
> 
> 时间：2013-01-11T20:54:01.563
> 
> 标签：android, android-listview, android-arrayadapter

这就是我向 ListView 添加项目的方式：

```
public class ServersAdapter extends ArrayAdapter<String> {

    public ServersAdapter(Context context, int resource, int textViewResourceId, String[] servers) {
        super(context, resource, textViewResourceId, servers);
        Log.d("noc", "ServersAdapterin: ");
        // TODO Auto-generated constructor stub
    }

    @Override
    public View getView(int position, View convertView, ViewGroup parent) {
        Log.d("noc", "getView: ");

        LayoutInflater inflater = (LayoutInflater) getSystemService(Context.LAYOUT_INFLATER_SERVICE);
        View row  = inflater.inflate(R.layout.servers_list, parent, false);

        Log.d("noc", "inflate: ");
        //datasource = new ServersDataSource(getContext());
        datasource.open();
        //servir list
        Log.d("noc", "ServersDataSource: ");
        Server[] servers = datasource.getAllServers();
        ImageView iv = (ImageView) row.findViewById(R.id.imageView1);
        TextView tv = (TextView) row.findViewById(R.id.textView1);

        Log.d("noc", "setText: ");
        if (servers.length > 0) {
            tv.setText(servers[position].getTitle());
            Log.d("noc", "getTitle: ");

            Log.d("noc", "servers[position].getTitle()-==================: "+ servers[position].getTitle());
            if (servers[position].getEnabled() < 1) {
                iv.setImageResource(R.drawable.ic_server_status_red);
            } else {
                iv.setImageResource(R.drawable.ic_server_status_green);
            }
        }
        return row;

    }
} 
```

这是 onCreate：

```
......
try {

        Log.d("noc", "need to delete this: ");
        datasource = new ServersDataSource(this);
        datasource.open();
        //servir list
        Log.d("noc", "servir list: ");
        //String[] servers = new String[10];
        //servir list
        Log.d("noc", "ServersDataSource: ");
        String[] servers = new String[10];

        Log.d("noc", "end need to delete this");
        ArrayAdapter<Server> adapter = new ServersAdapter(this, android.R.layout.simple_list_item_1, R.id.textView1, servers);
        setListAdapter(adapter);
    } catch (Exception e) {
        Log.d("noc", "error (ArrayAdapter): " + e.toString());
    } 
```

我无法从 ListView 的所有内容中清除它（我正在尝试清空它）。我一直在尝试这样做：

```
ArrayAdapter<Server> adapter = (ArrayAdapter<Server>) getListAdapter();
Server server = null;
switch (view.getId()) {
    case R.id.add:
        // Save the new server to the database
        // server_id, "title", "url", "ip", enabled, "services", fetch_interval
        server = datasource.createServer(1, "title of the server", "url of the server", "ip of the server", 1, "services of the server", 1);
        adapter.add(server);
        break;
    case R.id.delete:
        Log.d("noc", "delete ");
        if (getListAdapter().getCount() > 0) {
            datasource.emptyServersTable();
            Log.d("noc", "clear ");
            adapter.clear();
            Log.d("noc", "after clear ");

        }
        break;
    }
    Log.d("noc", "notifyDataSetChanged");
    adapter.notifyDataSetChanged(); 
```

这是单击“删除”时的输出：

```
01-11 23:41:54.210: D/noc(14898): delete 
01-11 23:41:54.210: D/noc(14898): emptyServersTable: 
01-11 23:41:54.230: D/noc(14898): clear 
01-11 23:41:54.230: D/AndroidRuntime(14898): Shutting down VM
01-11 23:41:54.230: W/dalvikvm(14898): threadid=1: thread exiting with uncaught exception (group=0x4140e2a0)
01-11 23:41:54.230: E/AndroidRuntime(14898): FATAL EXCEPTION: main
01-11 23:41:54.230: E/AndroidRuntime(14898): java.lang.IllegalStateException: Could not execute method of the activity
01-11 23:41:54.230: E/AndroidRuntime(14898):    at android.view.View$1.onClick(View.java:3699)
01-11 23:41:54.230: E/AndroidRuntime(14898):    at android.view.View.performClick(View.java:4223)
01-11 23:41:54.230: E/AndroidRuntime(14898):    at android.view.View$PerformClick.run(View.java:17275)
01-11 23:41:54.230: E/AndroidRuntime(14898):    at android.os.Handler.handleCallback(Handler.java:615)
01-11 23:41:54.230: E/AndroidRuntime(14898):    at android.os.Handler.dispatchMessage(Handler.java:92)
01-11 23:41:54.230: E/AndroidRuntime(14898):    at android.os.Looper.loop(Looper.java:137)
01-11 23:41:54.230: E/AndroidRuntime(14898):    at android.app.ActivityThread.main(ActivityThread.java:4898)
01-11 23:41:54.230: E/AndroidRuntime(14898):    at java.lang.reflect.Method.invokeNative(Native Method)
01-11 23:41:54.230: E/AndroidRuntime(14898):    at java.lang.reflect.Method.invoke(Method.java:511)
01-11 23:41:54.230: E/AndroidRuntime(14898):    at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:1008)
01-11 23:41:54.230: E/AndroidRuntime(14898):    at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:775)
01-11 23:41:54.230: E/AndroidRuntime(14898):    at dalvik.system.NativeStart.main(Native Method)
01-11 23:41:54.230: E/AndroidRuntime(14898): Caused by: java.lang.reflect.InvocationTargetException
01-11 23:41:54.230: E/AndroidRuntime(14898):    at java.lang.reflect.Method.invokeNative(Native Method)
01-11 23:41:54.230: E/AndroidRuntime(14898):    at java.lang.reflect.Method.invoke(Method.java:511)
01-11 23:41:54.230: E/AndroidRuntime(14898):    at android.view.View$1.onClick(View.java:3694)
01-11 23:41:54.230: E/AndroidRuntime(14898):    ... 11 more
01-11 23:41:54.230: E/AndroidRuntime(14898): Caused by: java.lang.UnsupportedOperationException
01-11 23:41:54.230: E/AndroidRuntime(14898):    at java.util.AbstractList.remove(AbstractList.java:638)
01-11 23:41:54.230: E/AndroidRuntime(14898):    at java.util.AbstractList$SimpleListIterator.remove(AbstractList.java:75)
01-11 23:41:54.230: E/AndroidRuntime(14898):    at java.util.AbstractList.removeRange(AbstractList.java:658)
01-11 23:41:54.230: E/AndroidRuntime(14898):    at java.util.AbstractList.clear(AbstractList.java:466)
01-11 23:41:54.230: E/AndroidRuntime(14898):    at android.widget.ArrayAdapter.clear(ArrayAdapter.java:258)
01-11 23:41:54.230: E/AndroidRuntime(14898):    at com.wr.noc.ServersStatus.onClick(ServersStatus.java:91)
01-11 23:41:54.230: E/AndroidRuntime(14898):    ... 14 more 
```

那么有什么问题。还有其他方法吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-11T21:17:33.737

您应该尝试覆盖类`clear()`中的方法并添加对您的方法的`ServersAdapter`调用（如果有的话）。如果您的数据从数组加载到视图中，只需清空它。`clear()``ArrayList`

查看您的代码，我认为相关的是**服务器**。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-01-11T21:06:35.603

我猜你向适配器传递了一个列表或一个数组。如果您保留此添加项目的实例，您可以执行以下操作：

```
adapter.clear();
listview.getAdapter().notifyDataSetChanged(); 
```

并非所有适配器都有`clear()`方法。ArrayAdapter 有，但`ListAdapter`或`SimpleAdapter`没有

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-12-04T02:27:34.140

据我所知，无需清除适配器并将 notifyDataSetChanged() 设置为适配器。你已经使用 List,ArrayList 为项目或数组 1 st 清除它并重新初始化它，并将数据传递给服装适配器后清除使用的数组/列表。它会正常工作！

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-11T21:30:13.947

该构造函数（带有数组的构造函数）的实现`Arrays.asList(objects)`会创建一个不可变列表。尝试将带有字符串的显式 ArrayList 传递给此构造函数：

```
 public ArrayAdapter(Context context, int resource, 
                      int textViewResourceId, List<T> objects) 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2016-03-27T09:42:11.267

试试这个，它会从视图中删除所有项目

```
 final int adapterCount = adapter.getCount();

    for (int i = 0; i < adapterCount; i++) {
        View item = adapter.getView(i, null, null);
        myLayout.removeView(item);
    } 
```

# javascript - Django 和 d3.js：CSV 数据

> ID：14286461
> 
> 赞同：1
> 
> 时间：2013-01-11T20:54:01.913
> 
> 标签：javascript, django, d3.js

我正在尝试让 django 从模型中提供 CSV 数据以使用 d3.js 生成图形。当我在服务器上有相同的 CSV 数据并且我将分散的路径传递给 CSV 文件时，此示例有效。

我正在关注此处发布的解决方案[Direct data input from Django for a D3 graph](https://stackoverflow.com/questions/13293174/direct-data-input-from-django-for-a-d3-graph)以提供 CSV 数据。

我在分散函数中收到一个错误，声称传递的数据为空。

## 视图.py

```
def serve_data(request):
    model = get_object_or_404(FileData, pk = 1)
    data = model.get_data()
    return HttpResponse(data, content_type = "text/csv") 
```

## 模板

```
<script type="text/javascript">
    $.get('/site/serve_data/', function(data) 
    {
        $('.result').html(data);
        scatter(data); // Here's the call to the javascript function
    });
</script> 
```

## javascript

```
function scatter(csvData)
{
    // ERROR HERE: csvData is null
    d3.csv(csvData, function(data)
    {
        data.forEach(function(d) 
        {
        // work with data
        });
    });
}); 
```

我在正确的轨道上吗？

### 编辑

当我从浏览器调用 URL 时，该`serve_data`函数确实返回 CSV 数据。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-11T21:22:44.340

您只是在滥用`d3.csv`，它需要一个 URL。见[https://github.com/mbostock/d3/wiki/CSV#wiki-csv](https://github.com/mbostock/d3/wiki/CSV#wiki-csv)

# wpf - 如何将 BitmapDecoder 与不可搜索的流一起使用？

> ID：14286462
> 
> 赞同：2
> 
> 时间：2013-01-11T20:54:02.630
> 
> 标签：wpf

我有一个不可搜索的流，其中包含一个 PNG 文件。我想使用 WPF 的`BitmapDecoder`类对此进行解码。文档没有说明我必须传递一个可搜索的流，如果我这样做，代码也不会抛出，所以我认为它应该可以工作。

但是，我无法让它工作。这是一个显示问题的人为示例：

```
// This is an 8x8 all-red PNG:
var bytes = Convert.FromBase64String("iVBORw0KGgoAAAANSUhEUgAAAAgAAAAICAIAAABLb"
            + "SncAAAAEElEQVQIHWP8z4AdMA4tCQB8/QgBp6L0HwAAAABJRU5ErkJggg==");

BitmapDecoder decoder;
using (var stream = new MemoryStream(bytes))
    decoder = BitmapDecoder.Create(stream, BitmapCreateOptions.None,
                                   BitmapCacheOption.OnLoad);

Console.WriteLine(decoder.Frames[0].PixelWidth); // outputs 8, correctly

using (var stream = new UnseekableStream(new MemoryStream(bytes)))
    decoder = BitmapDecoder.Create(stream, BitmapCreateOptions.None,
                                   BitmapCacheOption.OnLoad);

Console.WriteLine(decoder.Frames[0].PixelWidth); // outputs 1, wrongly 
```

[文档](http://msdn.microsoft.com/en-us/library/ms615982.aspx)指出，如果我传入`OnLoad`标志，我应该能够立即处理流，我这样做了。

当然，我可以把整个事情读成`MemoryStream`第一个，但这听起来不对。我做错了什么，还是`BitmapDecoder`这里有问题？

PS 这是上面示例中使用的“压缩”源`UnseekableStream`：

```
public sealed class UnseekableStream : Stream
{
    private Stream _stream;
    public UnseekableStream(Stream underlyingStream) { _stream = underlyingStream; }

    private bool _disposed = false;
    protected override void Dispose(bool disposing)
    {
        if (_disposed) return;
        _disposed = true; _stream.Dispose(); base.Dispose();
    }
    public override bool CanSeek { get { return false; } }
    public override bool CanWrite { get { return _stream.CanWrite; } }
    public override bool CanRead { get { return _stream.CanRead; } }
    public override void Flush() { _stream.Flush(); }
    public override long Length { get { return _stream.Length; } }
    public override void SetLength(long value) { _stream.SetLength(value); }
    public override long Position { get { return _stream.Position; } set { _stream.Position = value; } }
    public override long Seek(long offset, SeekOrigin origin) { return _stream.Seek(offset, origin); }
    public override int Read(byte[] buffer, int offset, int count) { return _stream.Read(buffer, offset, count); }
    public override void Write(byte[] buffer, int offset, int count) { _stream.Write(buffer, offset, count); }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-11T21:55:56.623

你可以`PngBitmapDecoder`直接使用：

```
using (var stream = new UnseekStream(new MemoryStream(bytes)))
{
    decoder = new PngBitmapDecoder(stream, BitmapCreateOptions.None, BitmapCacheOption.OnLoad);
} 
```

我猜这个流只需要在`BitmapDecoder.Create`合适的解码器实际解码之前就可以找到它包含的图像格式。

# sql - case 语句中的最少检查次数在多列范围内有效

> ID：14286463
> 
> 赞同：0
> 
> 时间：2013-01-11T20:54:11.313
> 
> 标签：sql, oracle, case

给出下表[定义](http://sqlfiddle.com/#!4/f0dcf)

我有一个这样写的查询：

```
select id,  
(  
   case   
      when partial >= 2 and full >=2  
      then sum(partial+full)  
      when partial >=2   
      then partial  
      when full >= 2  
      then full  
      else 0 
   end  
) counts
from Foo 
```

为了确保内部 when 子句，我必须做的最少检查次数是多少：

`partial>=2`并且`full >=2` 不会被调用两次。当/then 语法将所有内容视为 else ifs 而不仅仅是直接 ifs 时，情况是否如此？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-11T20:58:22.183

你可以做

```
select id,  
(  
   case when partial >= 2 then partial else 0 end + 
   case when full >= 2 then full else 0 end  
) counts
from Foo 
```

示例[SQL FIDDLE](http://sqlfiddle.com/#!4/29a9d/1)

# xml - "xsl:apply-templates mode"Copy" 是复制整个节点，还是只复制数据？

> ID：14286467
> 
> 赞同：1
> 
> 时间：2013-01-11T20:54:30.290
> 
> 标签：xml, xslt, xsd

我有以下 XSLT 元素：

```
<xsl:template match="Product">
    <product>
        ...
        <xsl:if test="string-length(PerProductShipping) > 0">
            <xsl:apply-templates select="PerProductShipping" mode="Copy">
                <xsl:with-param name="name">per_product_shipping</xsl:with-param>
            </xsl:apply-templates>
        </xsl:if>
    </product>
</xsl:template>

<xsl:template match="*" mode="Copy">
    <xsl:param name="name" select="name()"/>
        <xsl:element name="{$name}">
            <xsl:value-of select="."/>
    </xsl:element>
</xsl:template> 
```

这是我当前的输出：

```
<per_product_shipping>8.79</per_product_shipping> 
```

这是我想要的输出：

```
<per_product_shipping is_absolute="true">8.79</per_product_shipping> 
```

该`is_absolute="true"`元素将被硬编码，并且始终存在。

如何为此添加属性`xsl:template`？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-11T21:39:39.563

正如聊天中所讨论的，您的 mode="Copy" 模板是一个通用模板，它使用参数中指定的名称创建一个元素，然后为其提供与要匹配的节点相同的文本值。我相信在这种情况下最明智的解决方案是替换它：

```
<xsl:apply-templates select="PerProductShipping" mode="Copy">
    <xsl:with-param name="name">per_product_shipping</xsl:with-param>
</xsl:apply-templates> 
```

有了这个：

```
<per_product_shipping is_absolute="true">
  <xsl:value-of select="PerProductShipping" />
</per_product_shipping> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-11T21:59:33.923

我也会推荐这种方法：

```
<xsl:element name="per_product_shipping"> 
<xsl:attribute name="is_absolute">true</xsl:attribute> 
<xsl:value-of select="..." /> 
</xsl:element> 
```

这样您就可以动态控制生成的 XML。

# symfony - Sonata Admin 编辑表单多对多不起作用 - symfony2.1.6

> ID：14286471
> 
> 赞同：12
> 
> 时间：2013-01-11T20:55:11.193
> 
> 标签：symfony, many-to-many, sonata-admin

我在奏鸣曲管理编辑表单中实现多对多关系时遇到问题，结构如下。

```
purchase (id, total_price, discount, created_at)
purchase_product (purchase_id, product_id, quantity)
product (id, title, desc, price, thumbnail, created_at) 
```

我看过很多线程并尝试了其中列出的解决方案。我努力了

```
->add('products', 'sonata_type_model', array('by_reference' => false)) 
```

我收到以下错误

```
No entity manager defined for class Doctrine\ORM\PersistentCollection 
```

然后当我找不到解决这个问题的方法时，我切换到

```
->add('products', 'sonata_type_collection', array(), array('edit' => 'inline', 'inline' => 'table') 
```

我收到以下错误

```
INVALID MODE type : sonata_type_collection - mapping : 8 
```

我也无法弄清楚如何从 purchase_product 表中获取和显示数量。

非常感谢任何指示和帮助。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2013-01-11T21:19:43.433

您可以尝试添加 'expanded' => true 和 'multiple' => true

```
->add('products', 'sonata_type_model', array('expanded' => true, 'by_reference' => false, 'multiple' => true)) 
```

# asp.net-mvc - 使用多个数据库的 LINQ

> ID：14286474
> 
> 赞同：1
> 
> 时间：2013-01-11T20:55:22.487
> 
> 标签：asp.net-mvc, linq

我是 MVC 和 LINQ 的新手，但我们正在一个新项目中使用它们，我需要一些帮助。我们有一个正在创建的 MVC 4 应用程序，我需要获取特定站点的详细信息，但信息位于 2 个不同的数据库中。DB1 是大部分信息所在的位置，而 DB2 只有 2 个我需要的部分。简而言之，**DB1 具有表 Sites、SiteAddress、Address 和 ProductVersions。** **DB2 作为状态、产品、版本和产品版本。** 在 SQL 中，我可以使用以下内容来获取我需要的内容：

```
SELECT db1_s.SiteName, db1_s.PhoneNumber, db1_a.Address, db1_a.Address2, db1_a.City, db2_st.StateName, db1_a.ZipCode, db2_v.VersionNumber, db1_pv.ProductVersionID
FROM DB1.dbo.Sites db1_s
INNER JOIN DB1.dbo.SiteAddress db1_sa ON db1_s.SiteID = db1_sa.SiteID
INNER JOIN DB1.dbo.Address db1_a ON db1_sa.AddressID = db1_a.AddressID
INNER JOIN DB1.dbo.SiteProductVersions db1_spv ON db1_s.SiteID = db1_spv.SiteID
INNER JOIN DB1.dbo.ProductVersions db1_pv ON db1_spv.ProductVersionID = db1_pv.ProductVersionID
INNER JOIN DB2.dbo.States db2_st ON db1_a.StateID = db2_st.StateID
INNER JOIN DB2.dbo.ProductVersions db2_pv ON db1_spv.ProductVersionID = db2_pv.ProductVersionID
INNER JOIN DB2.dbo.Versions db2_v ON db2_pv.VersionID = db2_v.VersionID
WHERE db1_s.SiteID = 35 
```

我做了一些研究，发现真的没有办法使用 LINQ 来连接不同数据库中的表，而是使用 Lists 并将它们组合起来，这就是我遇到困难的地方。

我为视图创建了一个模型，如下所示：

```
public class SiteDetailsViewModel
{
    public string SiteName { get; set; }
    public string Address { get; set; }
    public string Address2 { get; set; }
    public string City { get; set; }
    public string State { get; set; }
    public string ZipCode { get; set; }

    public string PhoneNumber { get; set; }

    public int ProductVersionId { get; set; }
    public List<Version> Versions { get; set; }
} 
```

该视图仅包含用于显示数据的标签，版本除外。我希望它是可用版本的下拉列表（这就是我创建列表的原因）。

谁能给我一些关于将其转换为 LINQ 并将其用作我的视图的数据模型的最佳方法的指导？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-11T21:54:15.373

您可以在代码项目或[这个](https://stackoverflow.com/questions/352949/linq-across-multiple-databases) 问题中使用[这篇文章。](http://www.codeproject.com/Articles/23303/LinqToSQL-Query-Multiple-Databases-in-One-LINQ-Exp)

# vb.net - 只保留多行文本框的某些部分

> ID：14286475
> 
> 赞同：0
> 
> 时间：2013-01-11T20:55:26.513
> 
> 标签：vb.net

net 2.0 程序，其中我有一个多行文本框。例如，对于我的一项操作，我只需要检索 txt 框的某些部分 ![示例代码](../Images/23447455fbf6976f4aa8df4a91debaa7.png)

我需要检索以下内容

*   01-11-2013 15-18-12 -
*   电脑：740TMP
*   01-11-2013 15-18-13 -
*   电脑：740TMP

文本框可以只有 1 个条目或 30 个条目。我知道我可以截断这些线条，但最终结果中仍然会有额外的线条。有什么想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-11T21:29:53.493

使用 a`List(Of String)`将结果与所需的行一起存储。然后使用循环迭代 TextBox 中的所有行并获取您需要的内容。

例如：

```
Dim desiredLines As New List(Of String)()
Dim allLInes As String() = textBox1.Lines
Dim datePattern As String = "dd-MM-yyyy HH-mm-ss"

For i As Integer = 0 To allLInes.Length - 1
    Dim line As String = allLInes(i).Trim()
    Dim dt As Date 
    If line.Length >= datePattern.Length AndAlso _
        Date.TryParseExact(line.Substring(0, datePattern.Length), datePattern, Nothing, Globalization.DateTimeStyles.None, dt) Then
        desiredLines.Add(dt.ToString(datePattern))
    ElseIf line.StartsWith("Computer:") Then
        desiredLines.Add(line.Split("-"c)(0).TrimEnd())
    End If
Next 
```

# c# - 边界在底部，右侧工作正常，但在左侧，顶部不工作

> ID：14286479
> 
> 赞同：0
> 
> 时间：2013-01-11T20:55:32.473
> 
> 标签：c#, xna

![在此处输入图像描述](../Images/7e9641c96990af09a1a2faf7d5966866.png)

我正在关注：http: [//xbox.create.msdn.com/en-US/education/tutorial/2dgame/animating_the_player](http://xbox.create.msdn.com/en-US/education/tutorial/2dgame/animating_the_player)，这是在实现动画时出现问题。但我不确定为什么：

Game1.cs（我在这里更改的唯一方法是 LoadContent()-method 和 UpdatePlayer()-method。

```
using System;
using System.Collections.Generic;
using System.Linq;
using Microsoft.Xna.Framework;
using Microsoft.Xna.Framework.Audio;
using Microsoft.Xna.Framework.Content;
using Microsoft.Xna.Framework.GamerServices;
using Microsoft.Xna.Framework.Graphics;
using Microsoft.Xna.Framework.Input;
using Microsoft.Xna.Framework.Media;
using Microsoft.Xna.Framework.Input.Touch;

namespace Shooter
{
    /// <summary>
    /// This is the main type for your game
    /// </summary>
    public class Game1 : Microsoft.Xna.Framework.Game
    {
        GraphicsDeviceManager graphics;
        SpriteBatch spriteBatch;
        //Represents the player
        Player player;

        KeyboardState currentKeyboardState;
        KeyboardState previousKeyboardState;

        GamePadState currentGamePadState;
        GamePadState previousGamePadState;

        float playerMoveSpeed;

        public Game1()
        {
            graphics = new GraphicsDeviceManager(this);
            Content.RootDirectory = "Content";
        }

        /// <summary>
        /// Allows the game to perform any initialization it needs to before starting to run.
        /// This is where it can query for any required services and load any non-graphic
        /// related content.  Calling base.Initialize will enumerate through any components
        /// and initialize them as well.
        /// </summary>
        protected override void Initialize()
        {
            // TODO: Add your initialization logic here

            player = new Player();

            playerMoveSpeed = 8.0f;

            TouchPanel.EnabledGestures = GestureType.FreeDrag;

            base.Initialize();
        }

        /// <summary>
        /// LoadContent will be called once per game and is the place to load
        /// all of your content.
        /// </summary>
        protected override void LoadContent()
        {
            // Create a new SpriteBatch, which can be used to draw textures.
            spriteBatch = new SpriteBatch(GraphicsDevice);

            // TODO: use this.Content to load your game content here

            //Load the player resources

            // Load the player resources
            Animation playerAnimation = new Animation();
            Texture2D playerTexture = Content.Load<Texture2D>("shipAnimation");
            playerAnimation.Initialize(playerTexture, Vector2.Zero, 115, 69, 8, 30, Color.White, 1f, true);

            Vector2 playerPosition = new Vector2(GraphicsDevice.Viewport.TitleSafeArea.X, GraphicsDevice.Viewport.TitleSafeArea.Y
            + GraphicsDevice.Viewport.TitleSafeArea.Height / 2);
            player.Initialize(playerAnimation, playerPosition);

        }

        /// <summary>
        /// UnloadContent will be called once per game and is the place to unload
        /// all content.
        /// </summary>
        protected override void UnloadContent()
        {
            // TODO: Unload any non ContentManager content here
        }

        /// <summary>
        /// Allows the game to run logic such as updating the world,
        /// checking for collisions, gathering input, and playing audio.
        /// </summary>
        /// <param name="gameTime">Provides a snapshot of timing values.</param>
        protected override void Update(GameTime gameTime)
        {
            // Allows the game to exit
            if (GamePad.GetState(PlayerIndex.One).Buttons.Back == ButtonState.Pressed)
                this.Exit();

            previousGamePadState = currentGamePadState;
            previousKeyboardState = currentKeyboardState;

            currentKeyboardState = Keyboard.GetState();
            currentGamePadState = GamePad.GetState(PlayerIndex.One);

            UpdatePlayer(gameTime);

            base.Update(gameTime);
        }

        private void UpdatePlayer(GameTime gameTime)
        {
            player.Update(gameTime);

            player.Position.X += currentGamePadState.ThumbSticks.Left.X *playerMoveSpeed;
            player.Position.Y -= currentGamePadState.ThumbSticks.Left.Y *playerMoveSpeed;

            if (currentKeyboardState.IsKeyDown(Keys.Left) || currentGamePadState.DPad.Left == ButtonState.Pressed)
            {
                player.Position.X -= playerMoveSpeed;
            }
            if (currentKeyboardState.IsKeyDown(Keys.Right) || currentGamePadState.DPad.Right == ButtonState.Pressed)
            {
                player.Position.X += playerMoveSpeed;
            }
            if (currentKeyboardState.IsKeyDown(Keys.Up) || currentGamePadState.DPad.Up == ButtonState.Pressed)
            {
                player.Position.Y -= playerMoveSpeed;
            }
            if (currentKeyboardState.IsKeyDown(Keys.Down) || currentGamePadState.DPad.Down == ButtonState.Pressed)
            {
                player.Position.Y += playerMoveSpeed;
            }

            //Make sure the player does not go out of bounds
            player.Position.X = MathHelper.Clamp(player.Position.X, 0, GraphicsDevice.Viewport.Width - player.Width);
            player.Position.Y = MathHelper.Clamp(player.Position.Y, 0, GraphicsDevice.Viewport.Height - player.Height);
        }

        /// <summary>
        /// This is called when the game should draw itself.
        /// </summary>
        /// <param name="gameTime">Provides a snapshot of timing values.</param>
        protected override void Draw(GameTime gameTime)
        {
            GraphicsDevice.Clear(Color.CornflowerBlue);

            // TODO: Add your drawing code here

            spriteBatch.Begin();

            player.Draw(spriteBatch);

            spriteBatch.End();

            base.Draw(gameTime);
        }
    }
} 
```

播放器.cs

```
using System;
using Microsoft.Xna.Framework;
using Microsoft.Xna.Framework.Graphics;

namespace Shooter
{
    class Player
    {
        //Animation representing the player
        public Animation PlayerAnimation;

        //Position of the Player relative to the upper left side of the screen
        public Vector2 Position;

        //State of the player
        public bool Active;

        //Amount of hit points that player has
        public int Health;

        //Get the width of the player ship
        public int Width
        {
            get { return PlayerAnimation.FrameWidth; }
        }

        //Get the height of the player ship
        public int Height
        {
            get { return PlayerAnimation.FrameHeight; }
        }

        public void Initialize(Animation animation, Vector2 position)
        {
            PlayerAnimation = animation;

            //Set the starting position of the player around the middle of the screen and to the back
            Position = position;

            //Set the player to be active
            Active = true;

            //Set the player health
            Health = 100;
        }

        public void Update(GameTime gameTime)
        {
            PlayerAnimation.Position = Position;
            PlayerAnimation.Update(gameTime);
        }

        public void Draw(SpriteBatch spriteBatch)
        {
            PlayerAnimation.Draw(spriteBatch);
        }
    }
} 
```

动画.cs

```
using System;
using Microsoft.Xna.Framework;
using Microsoft.Xna.Framework.Content;
using Microsoft.Xna.Framework.Graphics;

namespace Shooter
{
    class Animation
    {
        // The image representing the collection of images used for animation
        Texture2D spriteStrip;

        // The scale used to display the sprite strip
        float scale;

        // The time since we last updated the frame
        int elapsedTime;

        // The time we display a frame until the next one
        int frameTime;

        // The number of frames that the animation contains
        int frameCount;

        // The index of the current frame we are displaying
        int currentFrame;

        // The color of the frame we will be displaying
        Color color;

        // The area of the image strip we want to display
        Rectangle sourceRect = new Rectangle();

        // The area where we want to display the image strip in the game
        Rectangle destinationRect = new Rectangle();

        // Width of a given frame
        public int FrameWidth;

        // Height of a given frame
        public int FrameHeight;

        // The state of the Animation
        public bool Active;

        // Determines if the animation will keep playing or deactivate after one run
        public bool Looping;

        // Width of a given frame
        public Vector2 Position;

        public void Initialize(Texture2D texture, Vector2 position,
        int frameWidth, int frameHeight, int frameCount,
        int frametime, Color color, float scale, bool looping)
        {
            // Keep a local copy of the values passed in
            this.color = color;
            this.FrameWidth = frameWidth;
            this.FrameHeight = frameHeight;
            this.frameCount = frameCount;
            this.frameTime = frametime;
            this.scale = scale;

            Looping = looping;
            Position = position;
            spriteStrip = texture;

            // Set the time to zero
            elapsedTime = 0;
            currentFrame = 0;

            // Set the Animation to active by default
            Active = true;
        }

        public void Update(GameTime gameTime)
        {
            // Do not update the game if we are not active
            if (Active == false)
                return;

            // Update the elapsed time
            elapsedTime += (int)gameTime.ElapsedGameTime.TotalMilliseconds;

            // If the elapsed time is larger than the frame time
            // we need to switch frames
            if (elapsedTime > frameTime)
            {
                // Move to the next frame
                currentFrame++;

                // If the currentFrame is equal to frameCount reset currentFrame to zero
                if (currentFrame == frameCount)
                {
                    currentFrame = 0;
                    // If we are not looping deactivate the animation
                    if (Looping == false)
                        Active = false;
                }

                // Reset the elapsed time to zero
                elapsedTime = 0;
            }

            // Grab the correct frame in the image strip by multiplying the currentFrame index by the frame width
            sourceRect = new Rectangle(currentFrame * FrameWidth, 0, FrameWidth, FrameHeight);

            // Grab the correct frame in the image strip by multiplying the currentFrame index by the frame width
            destinationRect = new Rectangle((int)Position.X - (int)(FrameWidth * scale) / 2,
            (int)Position.Y - (int)(FrameHeight * scale) / 2,
            (int)(FrameWidth * scale),
            (int)(FrameHeight * scale));
        }

        public void Draw(SpriteBatch spriteBatch)
        {
            if (Active)
            {
                spriteBatch.Draw(spriteStrip, destinationRect, sourceRect, color);
            }
        }
    }
} 
```

在 Game1.cs 中，这是检查边界的内容。但是，这在本教程的这一部分中没有改变，所以我不确定它为什么开始发生，我错过了什么吗？你们有什么可以指出我做错了吗？

```
//Make sure the player does not go out of bounds
            player.Position.X = MathHelper.Clamp(player.Position.X, 0, GraphicsDevice.Viewport.Width - player.Width);
            player.Position.Y = MathHelper.Clamp(player.Position.Y, 0, GraphicsDevice.Viewport.Height - player.Height); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-11T21:05:05.043

查看您的代码后，我最好的猜测是问题出在动画的绘制功能以及如何`destinationRect`定义。

看起来游戏认为动画的中心是动画的左上角。

我想也许你想像这样`destinationRect`在动画的 Update 方法中设置

```
 // Grab the correct frame in the image strip by multiplying the currentFrame index by the frame width
    destinationRect = new Rectangle(
        (int)Position.X,
        (int)Position.Y,
        (int)(FrameWidth * scale),
        (int)(FrameHeight * scale)); 
```

矩形`X`和`Y`坐标是动画的左上角而不是中心。

# python - 从文件中提取特定数据并将其写入另一个文件

> ID：14286480
> 
> 赞同：0
> 
> 时间：2013-01-11T20:55:31.823
> 
> 标签：python, perl, biopython

我在其中标记了 python 和 perl，只是因为这是我迄今为止使用的。如果有人知道更好的方法来解决这个问题，我当然愿意尝试一下。无论如何，我的问题：

我需要为遵循以下格式的基因预测程序创建一个输入文件：

```
seq1 5 15
seq1 20 34

seq2 50 48
seq2 45 36

seq3 17 20 
```

其中 seq# 是geneID，右边的数字是开放阅读框中外显子的位置。现在我有了这些信息，在一个包含很多其他信息的 .gff3 文件中。我可以用 excel 打开它并轻松删除包含不相关数据的列。现在是这样安排的：

```
PITG_00002  .   gene    2   397 .   +   .   ID=g.1;Name=ORF%
PITG_00002  .   mRNA    2   397 .   +   .   ID=m.1;
**PITG_00002**  .   exon    **2 397**   .   +   .   ID=m.1.exon1;
PITG_00002  .   CDS 2   397 .   +   .   ID=cds.m.1;

PITG_00004  .   gene    1   1275    .   +   .   ID=g.3;Name=ORF%20g
PITG_00004  .   mRNA    1   1275    .   +   .   ID=m.3;
**PITG_00004**  .   exon    **1 1275**  .   +   .   ID=m.3.exon1;P
PITG_00004  .   CDS 1   1275    .   +   .   ID=cds.m.3;P

PITG_00004  .   gene    1397    1969    .   +   .   ID=g.4;Name=
PITG_00004  .   mRNA    1397    1969    .   +   .   ID=m.4;
**PITG_00004**  .   exon    **1397  1969**  .   +   .   ID=m.4.exon1;
PITG_00004  .   CDS 1397    1969    .   +   .   ID=cds.m.4; 
```

* * *

所以我只需要粗体的数据。例如，

```
PITG_0002 2 397

PITG_00004 1 1275
PITG_00004 1397 1969 
```

您能提供的任何帮助将不胜感激，谢谢！

编辑：嗯，我搞砸了格式。**之间的任何东西都是我需要的，哈哈。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-11T21:15:04.043

在 Unix 中：

```
grep <file.gff3 " exon " |
    sed "s/^\([^ ]+\) +[.] +exon +\([0-9]+\) \([0-9]+\).*$/\1 \2 \3/" 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-11T21:12:22.120

对于行人：

（这是 Python）

```
with open(data_file) as f:
    for line in f:
        tokens = line.split()
        if len(tokens) > 3 and tokens[2] == 'exon':
            print tokens[0], tokens[3], tokens[4] 
```

哪个打印

```
PITG_00002 2 397
PITG_00004 1 1275
PITG_00004 1397 1969 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-12T00:24:50.753

看起来您的数据是制表符分隔的。

这个 Perl 程序将从第三列中的所有记录中打印出第 1、4 和 5`exon`列。您需要将`open`语句中的文件名更改为您的实际文件名。

```
use strict;
use warnings;

open my $fh, '<', 'genes.gff3' or die $!;

while (<$fh>) {
  chomp;
  my @fields = split /\t/;
  next unless @fields >= 5 and $fields[2] eq 'exon';
  print join("\t", @fields[0,3,4]), "\n";
} 
```

**输出**

```
PITG_00002  2 397
PITG_00004  1 1275
PITG_00004  1397  1969 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-11T21:46:40.027

这是一个 Perl 脚本选项`perl scriptName.pl file.gff3`：

```
use strict;
use warnings;

while (<>) {
    print "@{ [ (split)[ 0, 3, 4 ] ] }\n" if /exon/;
} 
```

输出：

```
PITG_00002 2 397
PITG_00004 1 1275
PITG_00004 1397 1969 
```

或者您可以执行以下操作：

```
perl -n -e 'print "@{ [ (split)[ 0, 3, 4 ] ] }\n" if /exon/' file.gff3 
```

要将数据保存到文件：

```
use strict;
use warnings;

open my $inFH,  '<',  'file.gff3' or die $!;
open my $outFH, '>>', 'data.txt'  or die $!;

while (<$inFH>) {
    print $outFH "@{ [ (split)[ 0, 3, 4 ] ] }\n" if /exon/;
} 
```

# java - 在 JLabel 中的 ImageIcon 上添加标记

> ID：14286484
> 
> 赞同：2
> 
> 时间：2013-01-11T20:55:51.957
> 
> 标签：java, swing, jlabel, imageicon, jlayeredpane

所以我试图找到一种在Java中修改图像的方法。换句话说，如果用户点击图像，则会在用户刚刚点击的位置放置一个标记。我有一个 ImageIcon 放入 JLabel 中。到目前为止，我采用的方法是使用 JLayeredPanel 将另一个 JPanel 放在 JLabel 之上并在这个 JPanel 上绘制：

```
//...
ImageIcon icon = new ImageIcon("foo.jpg");
JLabel lb = new JLabel(icon);
JPanel glass = new JPanel();
lb.setBounds(0, 0, 100, 100);
glass.setBounds(0, 0, 100, 100);
glass.setOpaque(false);
LayeredPane container = new LayeredPane();
container.add(lb, 1);
container.add(glass, 2);

//... 
```

但这种方式似乎行不通。我从来没有看到背景图片（图片以磅为单位）。所以我想知道我是否走在正确的轨道上？还是有更清洁的方法来实现这一目标？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-11T22:09:59.937

对于这样的事情使用 a`JLayeredPane`或 glass pane 并没有什么问题，我个人觉得它很麻烦，因为在大型应用程序中，您倾向于将这些层用于任意数量的事情，因此它很快就会变得非常复杂。

可以这么说，我更喜欢把它放在“家里”……

就个人而言，我会使用自定义组件。这会将工作流程隔离到一个非常特定的位置，并可以更轻松地提供您可能喜欢的定制......

![在此处输入图像描述](../Images/aedd27ff2d3f179dbd95bd7adf8aa7b9.png)

```
public class MarkImage {

    public static void main(String[] args) {
        new MarkImage();
    }

    public MarkImage() {
        EventQueue.invokeLater(new Runnable() {
            @Override
            public void run() {
                try {
                    UIManager.setLookAndFeel(UIManager.getSystemLookAndFeelClassName());
                } catch (ClassNotFoundException | InstantiationException | IllegalAccessException | UnsupportedLookAndFeelException ex) {
                }

                JFrame frame = new JFrame("Test");
                frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
                frame.setLayout(new BorderLayout());
                frame.add(new TestPane());
                frame.pack();
                frame.setLocationRelativeTo(null);
                frame.setVisible(true);
            }

        });
    }

    public class TestPane extends JPanel {

        private BufferedImage background;
        private List<Point> clickPoints;

        public TestPane() {
            clickPoints = new ArrayList<>(25);
            try {
                background = ImageIO.read(getClass().getResource("/Miho_Small.png"));
            } catch (IOException ex) {
                ex.printStackTrace();
            }

            addMouseListener(new MouseAdapter() {
                @Override
                public void mouseClicked(MouseEvent e) {
                    clickPoints.add(e.getPoint());
                    repaint();
                }
            });
        }

        @Override
        public Dimension getPreferredSize() {
            return background == null ? super.getPreferredSize() : new Dimension(background.getWidth(), background.getHeight());
        }

        @Override
        protected void paintComponent(Graphics g) {
            super.paintComponent(g);
            if (background != null) {
                int x = (getWidth() - background.getWidth()) / 2;
                int y = (getHeight() - background.getHeight()) / 2;
                g.drawImage(background, x, y, this);
            }
            g.setColor(Color.RED);
            for (Point p : clickPoints) {
                g.fillOval(p.x - 4, p.y - 4, 8, 8);
            }
        }

    }

} 
```

我也会考虑使用`JXLayer`（Java 7 中的 AKA `JLayer`）。最好将其描述为组件的玻璃板（在类固醇上）。查看如何装饰组件以获取更多详细信息...

## 使用 JLayer 示例更新

这是一个使用 Java 7 的示例`JLayer`。`JLayer`和之间有一些细微差别`JXLayer`，但转换它不需要太多...

（对不起，无法抗拒之前的诱惑）

![在此处输入图像描述](../Images/0f29ed1a5101fe7ff1c0615b5ea4776d.png)

```
public class MarkLayer {

    public static void main(String[] args) {
        new MarkLayer();
    }

    public MarkLayer() {
        EventQueue.invokeLater(new Runnable() {
            @Override
            public void run() {
                try {
                    UIManager.setLookAndFeel(UIManager.getSystemLookAndFeelClassName());
                } catch (ClassNotFoundException | InstantiationException | IllegalAccessException | UnsupportedLookAndFeelException ex) {
                }

                try {
                    JFrame frame = new JFrame("Testing");
                    frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
                    frame.setLayout(new GridBagLayout());

                    JLabel label = new JLabel(new ImageIcon(ImageIO.read(getClass().getResource("/Miho_Small.png"))));
                    LayerUI<JLabel> layerUI = new MarkLayerUI();
                    JLayer<JLabel> layer = new JLayer<>(label, layerUI);

                    frame.add(layer);
                    frame.pack();
                    frame.setLocationRelativeTo(null);
                    frame.setVisible(true);
                } catch (Exception exp) {
                    exp.printStackTrace();
                }
            }
        });
    }

    public class MarkLayerUI extends LayerUI<JLabel> {

        private Map<JLayer, List<Point>> mapPoints;

        public MarkLayerUI() {
            mapPoints = new WeakHashMap<>(25);
        }

        @Override
        public void installUI(JComponent c) {
            System.out.println("install");
            super.installUI(c);
            JLayer layer = (JLayer) c;
            layer.setLayerEventMask(AWTEvent.MOUSE_EVENT_MASK);
        }

        @Override
        public void uninstallUI(JComponent c) {
            super.uninstallUI(c);
            mapPoints.remove((JLayer) c);
        }

        @Override
        protected void processMouseEvent(MouseEvent e, JLayer<? extends JLabel> l) {
            if (e.getID() == MouseEvent.MOUSE_CLICKED) {

                List<Point> points = mapPoints.get(l);
                if (points == null) {
                    points = new ArrayList<>(25);
                    mapPoints.put(l, points);
                }
                Point p = e.getPoint();
                p = SwingUtilities.convertPoint(e.getComponent(), p, l);
                points.add(p);
                l.repaint();

            }
        }

        @Override
        public void paint(Graphics g, JComponent c) {
            Graphics2D g2d = (Graphics2D) g.create();
            super.paint(g2d, c);
            g2d.setColor(Color.BLUE);
            g2d.drawRect(0, 0, c.getWidth() - 1, c.getHeight() - 1);
            List<Point> points = mapPoints.get((JLayer) c);
            if (points != null && points.size() > 0) {
                g2d.setColor(Color.RED);
                for (Point p : points) {
                    g2d.fillOval(p.x - 4, p.y - 4, 8, 8);
                }
            }
            g2d.dispose();
        }
    }
} 
```

蓝色边框是作为图层一部分的渲染器，这为您提供了可以单击的位置的指南 - 我这样做是为了测试和演示

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-11T20:58:52.433

您想要使用另一个窗格，您走在正确的轨道上。在 Java 中，实际上已经有一个专门为此目的而设计的玻璃窗格。通读本教程[http://docs.oracle.com/javase/tutorial/uiswing/components/rootpane.html](http://docs.oracle.com/javase/tutorial/uiswing/components/rootpane.html)，它应该可以帮助您理解。

# ruby-on-rails - 在 Rails 中获取从 Postgresql/Hstore 返回的“builder”、“parent_builder”和“namespace”字段

> ID：14286487
> 
> 赞同：3
> 
> 时间：2013-01-11T20:56:00.877
> 
> 标签：ruby-on-rails, postgresql, hstore

我构建了一个简单的应用程序，我试图用一个表单来更新它，但是发生了一些奇怪的事情。

我有一列'field_items'，它是一个hStore。如果我在我看来对模型调用调试...

```
<%= debug @app.field_items %> 
```

我得到了两个正确的项目返回。在 Rails 控制台中，我也看不到三个附加功能。

我有一个 form_for，我在其中迭代“field_items”

在我的表单中，它返回三个额外字段“builder”、“parent_builder”和“namespace”

有人有想法么？我注意到如果我在模型中注释掉 :field_items 上的序列化行，它不会返回三个额外的属性

* * *

这是我的模型

```
class App < ActiveRecord::Base
  belongs_to :page
  attr_accessible :content, :title, :layouts, :field_items

  serialize :layouts, ActiveRecord::Coders::Hstore
  serialize :field_items, ActiveRecord::Coders::Hstore  
end 
```

这是我的编辑视图中的表单/代码

```
<%= form_for [:admin, @app], :html => { :class => "form app_fields_form" } do |f| -%>
    <div id="app_fields_row_container">
        <%= f.fields_for :field_items, @app.field_items do |fi| %>
            <% @app.field_items.try(:each) do |key, value| %>
                <div class='app_fields_row item_row'>
                    <div class="column col1"><%= text_field_tag key, key, :class => "form_text_field dynamic_attr" %></div>
                    <div class="column col2"><%= fi.select key, options_for_select(APP_FIELD_TYPES, value), {}, {:class => "form_select"} %></div>
                    <div class="column col3"><a href="#" class="adm_button h_red small grey app_fields_delete">x</a></div>
                </div>
            <% end %>
        <%- end -%>
    </div>  
<% end -%> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-06-13T06:18:06.887

我遇到了同样的问题。从 fields_for 中删除 @app.field_items 对我有用

```
<%= f.fields_for :field_items do |fi| %> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-06T13:32:57.877

Remove the following line and it should work fine:

```
<%= f.fields_for :field_items, @app.field_items do |fi| %> 
```

I had the exact same problem, and removing the `fields_for` call solved the issue, as there is no need for it as it isn't a nested resource.

# sql-server - 重新设计缓存 UDF，因为不允许副作用

> ID：14286488
> 
> 赞同：1
> 
> 时间：2013-01-11T20:56:03.337
> 
> 标签：sql-server

尝试复制将按如下方式工作的函数的逻辑：

```
given input params @a,@b,@c:

look up return value @v in table where column a=@a and b=@b and c=@c
if found, return @v
if not found, perform complex calculations to derive @v
insert into lookup table (a, b, c, v) values (@a, @b, @c, @v)
return @v 
```

这个想法是在表中查找值将比复杂的计算快得多。如果您必须对一组值进行复杂的计算，则在表中添加一行，这样下次查找 @v 的值会更快。

当然，由于副作用的原因，您不能在 UDF 中执行 INSERT 语句。

我不是要求允许我在 UDF 中执行 INSERT 的 hack，而是要求我如何重新设计代码以执行相同类型的逻辑的想法？目标是使用 UDF，因为我们需要为数千个输入值集计算 @v 值，这些值都存在于一个表中。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-13T03:59:34.453

由于似乎没有可以计算值和管理缓存的单个函数，因此这里有一个为现有样本数据集提供值的合理有效方法的示例。UDF 将提供缓存或计算的值，但更新缓存仍然是单独的。

```
set nocount on;

-- Create some sample data and a partial cache of calculated values.
create table Samples ( Id Int Identity, A Int, B Int, V Int Null );
insert into Samples ( A, B ) values
  ( 0, 0 ), ( 0, 1 ), ( 1, 0 ), ( 1, 1 ), ( 2, 0 ), ( 0, 2 ), ( 0, 1 ), ( 0, 1 );

create table Cache ( Id Int Identity, A Int, B Int, V Int );
insert into Cache ( A, B, V ) values
  ( 1, 1, 1 ), ( 0, 2, 4 );
go

-- Create the function to perform the expensive calculation.
create function dbo.ExpensiveCalculation( @A Int, @B Int )
  returns Int
  as
  begin
  return @A * @A + @B * @B;
  end;
go

-- And another function that can use cached values.
create function dbo.ExpensiveCalculationWithCaching( @A Int, @B Int )
  returns Int
  as
  begin
  declare @Result as Int
  -- Try to get a cached value.
  select @Result = V
    from Cache
    where A = @A and B = @B;
  -- If we didn't find a cached value then calculate one.
  if @@RowCount = 0
    select @Result = dbo.ExpensiveCalculation( @A, @B );
  return @Result;
  end;
go

-- Apply any previously cached values to the samples.
update S
  set S.V = C.V
  from Samples as S inner join
    Cache as C on C.A = S.A and C.B = S.B;
print Cast( @@RowCount as VarChar(6) ) + ' samples satisfied from initial cache.'

declare @BatchSize as Int = 3; -- Number of rows to process with the function in each iteration.
declare @CacheIds as Table ( Id Int );

-- Update the samples one batch at a time.
while exists ( select 42 from Samples where V is NULL )
  begin

  -- Clear the intermediate data, if any.
  delete from @CacheIds;

  -- Find a batch of unknown values with distinct input values and apply the function.
  --   Add the results to the cache and note the id's of the new rows.
  insert into Cache
    output inserted.Id into @CacheIds
    select top (@BatchSize) A, B, dbo.ExpensiveCalculation( A, B )
      from Samples
      where V is NULL
      group by A, B;
  print Cast( @@RowCount as VarChar(6) ) + ' cache entries added.'

  -- Update any samples that benefit from the newly cached values.
  update S
    set S.V = C.V
    from Samples as S inner join
      Cache as C on C.A = S.A and C.B = S.B inner join
      @CacheIds as CI on CI.Id = C.Id
    where S.V is NULL;
  print Cast( @@RowCount as VarChar(6) ) + ' samples satisfied from cache update.'
  end

-- Display the results.
select Id, A, B, V
  from Samples

select dbo.ExpensiveCalculationWithCaching( 1, 1 ) as Cached,
  dbo.ExpensiveCalculationWithCaching( 4, 4 ) as Calculated

-- Houseclean.
drop function dbo.ExpensiveCalculationWithCaching;
drop function dbo.ExpensiveCalculation;
drop table Samples;
drop table Cache; 
```

注意：如果添加到`Samples`表中的行在执行此代码期间被更新，则它们可能不会被处理。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-12T07:11:25.597

这不是所需的解决方案，但到目前为止，您正在寻找其他解决方案......您可以在 [LookUp] 上创建一个 INSERT TRIGGER，进行所有需要的计算。在准备最终查询时，使用查找而不是 UDF，您可以强制所有需要的值都在查找中，方法是：

```
Insert into [LookUp] (a,b,c)
Select ds.a,ds.b,ds.c from
(
Select Distinct a,b,c from [Source]
) ds
Left Join [LookUp] l on l.a=ds.a and l.b=ds.b and l.c=ds.c
Where l.a IS NULL 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-11T21:18:56.320

编辑：这可能是比下面更好的方法。同样，这是完全未经测试的。它只是作为一个想法的起点。

```
CREATE FUNCTION dbo.MyFN_MKII_1
(
    @a INT,
    @b INT,
    @C INT
)
RETURNS TABLE 
WITH SCHEMABINDING 
AS
    RETURN  SELECT  v 
            FROM MyTable
            WHERE a = @a
            AND b = @b
            AND c = @c
;
GO

CREATE FUNCTION dbo.MyFN_MKII_2
(
    @a INT,
    @b INT,
    @C INT
)
RETURNS INT
WITH SCHEMABINDING 
AS
-- place the body of the function here
BEGIN
     RETURN POWER(@a,@b)*@c
END
GO

---------------------
--  Usage
---------------------

INSERT INTO LookupTable
SELECT   ST.ColA
        ,ST.ColB
        ,ST.ColC
        ,ISNULL(V, dbo.MyFN_MKII_2(ST.COlA, ST.ColB, ST.ColC))
FROM SomeTable  ST
CROSS APPLY dbo.MyFN_MKII_1(ColA, ColB, ColC) 
```

这是完全未经测试的。它只是作为一个想法的起点。周围有一些非常聪明的人可能会为这个概念提供优化。

```
CREATE FUNCTION dbo.MyFN
(
    @a INT,
    @b INT,
    @C INT
)
RETURNS @Result TABLE 
(
    a INT,
    b INT,
    c INT,
    v INT
)
AS
BEGIN

    INSERT INTO @Result (a, b, c, v)
    SELECT @a, @b, @c, v
    FROM MyTable
    WHERE a = @a
    AND b = @b
    AND c = @c

    IF @@ROWCOUNT = 0
    BEGIN
        INSERT INTO @Result (a, b, c, v)
        SELECT @a, @b, @c, POWER(@a,@b) * @c
    END

   RETURN
END
GO

---------------------
--  Usage
---------------------

INSERT INTO LookupTable
SELECT *
FROM SomeTable
CROSS APPLY dbo.MyFN(ColA, ColB, ColC) 
```

我预计这个功能会比较慢。

# ios - 如何将音频从 iOS 流式传输到 IIS Web 服务器

> ID：14286490
> 
> 赞同：1
> 
> 时间：2013-01-11T20:56:11.347
> 
> 标签：ios, audio, iis-7

我想将来自多个 iOS 客户端的音频流式传输到运行 IIS 7 的中央 Windows 服务器以进行进一步处理。IIS 媒体服务似乎是解决从 IIS 分发音频的相反问题的解决方案，是否有用于将音频流式传输到 IIS 的现有库？还是我必须自己写一个 WCF TCP 服务？（我需要将状态消息发送回客户端，因此双工 TCP 似乎是可行的方法。）

# php - 关注/取消关注按钮的问题

> ID：14286491
> 
> 赞同：1
> 
> 时间：2013-01-11T20:56:13.330
> 
> 标签：php, jquery, mysql

我在下面有这个程序，它执行简单的关注/取消关注功能。一切都很好，除了当我刷新页面时，只有该行中的第一个用户保留正确的关注/取消关注按钮。示例我可以关注 user1 user2 和 user3，但是当我刷新时，只有 user1 仍然说 FOllOWING。不确定问题是什么，也许有人可以发现代码中的缺陷。谢谢。

```
<!DOCTYPE html> 
<html> 
    <head> 

        <link rel="stylesheet" href="style.css" type="text/css" media="screen"/> 
        <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js"></script>
        <script type="text/javascript" src="jquery.livequery.js"></script>

        <script type="text/javascript"> 
           $(document).ready(function() { 

                    $('.buttons > a').livequery("click",function(e){

                        var parent  = $(this).parent();
                        var getID   =  parent.attr('id').replace('button_','');

                        $.post("follow.php?id="+getID, {

                        }, function(response){

                            $('#button_'+getID).html($(response).fadeIn('slow'));
                        });
                }); 
            });
        </script>
    </head> 

    <body> 

    <br clear="all" />

        <div id="content"> 

        <br clear="all" />
        <br clear="all" />
        <?php  

        $test = $fgmembersite-> UserID();

            $userip = $_SERVER['REMOTE_ADDR'];

            $result = mysql_query("SELECT fgusers.*, tblimage.* FROM fgusers LEFT JOIN tblimage ON tblimage.userid = fgusers.id_user");

            while ($row = mysql_fetch_array($result))
            {?>
                <div class="digg-panel">

                    <div class="img-username">

                        <img alt="<?php  echo $row['username']?>" src="<?php  echo $row['photo']?>.png" width="40" height="40" class="userImage" alt="" />
                        <div class="user-title">
                            <a href="http://digg.com/<?php  echo $row['username']?>" class="fullname"><?php  echo $row['name']?></a>

                            <a href="http://digg.com/<?php  echo $row['username']?>" class="username"><?php  echo $row['username']?></a>
                        </div>
                    </div>

                    <?php
                    $res = mysql_query("select * from tblfollowers where follower_id = '$test' AND username = ".$row['id']);

                    $check_result = @mysql_num_rows(@$res);

                    if($check_result > 0)
                    {?>
                        <span class="buttons" id="button_<?php echo $row['id_user']?>"><a class="btn-following" href="javascript: void(0)"></a></span>
                        <?php
                    }
                    else
                    {?>
                        <span class="buttons" id="button_<?php echo $row['id_user']?>"><a class="btn-follow" href="javascript:void(0)"></a></span>
                        <?php
                    }?>
                    <br clear="all" />

                    <div class="bio">
                    <?php  echo $row['email']?>
                    </div>

                </div>
            <?php  
            }?>

        </div> 

        <br clear="all" />

    </body> 
</html> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-12T08:16:25.390

如果您可以在下面实现您的`click event`喜欢。也许您的问题会解决。试试吧。

```
$('.buttons > a').expire("click").livequery("click",function(e){

}); 
```

有关更多信息，请查看[**jQuery Live Query 插件文档**](http://brandonaaron.net/code/livequery/docs)

我希望这对你有帮助。

# azure - Azure 来宾操作系统系列从 2008 年升级到 2012 年，部署的应用程序仍然可以工作吗？

> ID：14286500
> 
> 赞同：0
> 
> 时间：2013-01-11T20:57:20.377
> 
> 标签：azure, azure-web-roles

我想将我的 Azure 云服务（Web 角色）的“OS 系列”从“Windows Server 2008 R2”升级到“Windows Server 2012”，这样我就可以使用 .Net 4.5。Azure 门户中有一个下拉菜单可以进行此更改，但我担心这可能会导致什么样的中断……在此更改期间/之后，我部署的网站是否仍然处于活动状态和功能？

这是我能找到的最好的文档，它没有提到我可以期待什么行为：

[http://msdn.microsoft.com/en-us/library/windowsazure/gg456324.aspx](http://msdn.microsoft.com/en-us/library/windowsazure/gg456324.aspx)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2014-06-24T01:31:41.617

因此，可以理解 Web 角色是如何发挥作用的，当您上传带有配置的应用程序时，Azure 会将上传的数据与任何虚拟机分开保存。上传的应用程序的后续部署包括创建您选择的全新虚拟机（例如，小型、中型......）。不同的操作系统有不同的虚拟机。一旦预配了预定义类型的虚拟机，您的应用程序就会加载到预配的虚拟机上，然后启动虚拟机（可能会在启动 VM 后进行部署）。因此，现在，回到您的问题，如果您将设置从 OS 2008 更改为 OS 2012，很明显旧的 VM 将被取消配置，并配置一个具有 OS 2012 的新 VM，部署您的应用程序等。因此，会有停机时间。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-11T21:30:06.817

如果您更改操作系统系列，所有角色和实例都将经历停机时间。这是因为 OSFamily 是服务配置的一部分，它是整个应用程序的设置。如果您的 Azure 应用程序中只有 Web 角色或辅助角色或两者都有，则更改此设置将适用于所有角色和实例。

一旦将配置更改应用于应用程序，整个服务就会更新。这样想，如果你有多个实例到一个角色，你不想用新配置和一半旧配置运行一半实例，因为这可能会产生大问题。因此，更新所需的应用程序配置确实需要停机时间。已经有基于分段和生产槽的部署可用于减少停机时间。

如果您想避免停机时间，您可以执行以下操作：

1.  当您的生产应用程序已经运行时，将 OSFamily=3 (Windows Server 2012) 的新应用程序部署到暂存槽
2.  根据需要测试登台应用程序
3.  一旦您的登台应用程序按预期工作，请在门户中执行“VIP SWAP”。VIP 交换会将您的暂存部署推向生产，并且在不到一秒的时间内，您将拥有运行 Windows Server 2012 的应用程序。

# vb.net - 如何在字符串vb.net中查找子字符串的出现次数

> ID：14286505
> 
> 赞同：12
> 
> 时间：2013-01-11T20:57:51.843
> 
> 标签：vb.net, string, split, substring

我有一个字符串（例如：）`"Hello there. My name is John. I work very hard. Hello there!"`，我正在尝试查找字符串的出现次数`"hello there"`。到目前为止，这是我拥有的代码：

```
Dim input as String = "Hello there. My name is John. I work very hard. Hello there!"
Dim phrase as String = "hello there"
Dim Occurrences As Integer = 0

If input.toLower.Contains(phrase) = True Then
    Occurrences = input.Split(phrase).Length      
    'REM: Do stuff
End If 
```

不幸的是，这行代码似乎做的是每次看到第一个字母时拆分字符串`phrase`，在这种情况下，`h`。因此`Occurrences = 2`，我实际上得到的不是我希望的结果，而是一个更大的数字。我知道计算字符串中的分割数是一种可怕的方法，即使我确实得到了正确的答案，所以有人可以帮助我并提供一些帮助吗？

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2013-01-11T22:59:10.440

还有一个想法：

```
Dim input As String = "Hello there. My name is John. I work very hard. Hello there!"
Dim phrase As String = "Hello there"
Dim Occurrences As Integer = (input.Length - input.Replace(phrase, String.Empty).Length) / phrase.Length 
```

您只需要确保`phrase.Length > 0`.

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2014-03-23T16:04:01.150

最好的方法是：

```
Public Function countString(ByVal inputString As String, ByVal stringToBeSearchedInsideTheInputString as String) As Integer
    Return System.Text.RegularExpressions.Regex.Split(inputString, stringToBeSearchedInsideTheInputString).Length -1

End Function 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2015-10-18T11:08:37.433

```
str="Thisissumlivinginsumgjhvgsum in the sum bcoz sum ot ih sum"
b= LCase(str)
array1=Split(b,"sum")
l=Ubound(array1)
msgbox l 
```

输出给你没有。一个字符串在另一个字符串中出现的次数。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2013-01-11T21:54:33.197

您可以创建一个 Do Until 循环，一旦整数变量等于您正在检查的字符串的长度，该循环就会停止。如果短语存在，则增加出现次数并将短语的长度加上找到它的位置添加到游标变量中。如果找不到该短语，则您已完成搜索（没有更多结果），因此将其设置为目标字符串的长度。要不多次计算相同的出现次数，请仅检查从光标到循环中目标字符串的长度 (strCheckThisString)。

```
 Dim input As String = "hello there. this is a test. hello there hello there!"
    Dim phrase As String = "hello there"
    Dim Occurrences As Integer = 0

    Dim intCursor As Integer = 0
    Do Until intCursor >= input.Length

        Dim strCheckThisString As String = Mid(LCase(input), intCursor + 1, (Len(input) - intCursor))

        Dim intPlaceOfPhrase As Integer = InStr(strCheckThisString, phrase)
        If intPlaceOfPhrase > 0 Then

            Occurrences += 1
            intCursor += (intPlaceOfPhrase + Len(phrase) - 1)

        Else

            intCursor = input.Length

        End If

    Loop 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2013-01-11T21:14:55.903

您只需要将 split 函数的输入更改为字符串数组，然后将`StringSplitOptions`.

试试这行代码：

```
Occurrences = input.Split({phrase}, StringSplitOptions.None).Length 
```

我还没有检查过这个，但我认为你还必须考虑这样一个事实，即出现次数太高，因为你正在使用你的字符串进行拆分而不是实际计算它的次数字符串，所以**我认为** `Occurrences = Occurrences - 1`

希望这可以帮助

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2014-02-20T11:27:06.410

您可以使用 IndexOf 创建递归函数。传递要搜索的字符串和要定位的字符串，每次递归都会增加一个 Counter 并将 StartIndex 设置为最后找到的索引 +1，直到不再找到搜索字符串。函数将需要通过引用传递的可选参数起始位置和计数器：

```
Function InStrCount(ByVal SourceString As String, _
                    ByVal SearchString As String, _
                    Optional ByRef StartPos As Integer = 0, _
                    Optional ByRef Count As Integer = 0) As Integer
    If SourceString.IndexOf(SearchString, StartPos) > -1 Then
        Count += 1
        InStrCount(SourceString, _
                   SearchString, _
                   SourceString.IndexOf(SearchString, StartPos) + 1, _
                   Count)
    End If
    Return Count
End Function 
```

通过将字符串传递给搜索和字符串来定位以及可选的起始位置来调用函数：

```
Dim input As String = "Hello there. My name is John. I work very hard. Hello there!"
Dim phrase As String = "hello there"
Dim Occurrences As Integer

Occurrances = InStrCount(input.ToLower, phrase.ToLower) 
```

请注意 .ToLower 的使用，它用于在比较中忽略大小写。如果您确实希望比较是针对特定情况的，请不要包含此指令。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2016-08-24T09:00:43.943

另一种基于`InStr(i, str, substr)`函数的解决方案（从位置开始搜索`substr`，[有关 InStr() 的更多信息](https://www.w3schools.com/asp/func_instr.asp)）：`str``i`

```
Function findOccurancesCount(baseString, subString)
    occurancesCount = 0
    i = 1
    Do
        foundPosition = InStr(i, baseString, subString) 'searching from i position
        If foundPosition > 0 Then                       'substring is found at foundPosition index
            occurancesCount = occurancesCount + 1       'count this occurance
            i = foundPosition + 1                       'searching from i+1 on the next cycle
        End If
    Loop While foundPosition <> 0
    findOccurancesCount = occurancesCount
End Function 
```

一旦没有找到子字符串（`InStr`返回`0`，而不是在基本字符串中找到子字符串位置），搜索就结束并返回出现次数。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2015-07-13T00:43:59.313

查看您最初的尝试，我发现这应该可以解决问题，因为“拆分”会创建一个数组。出现次数 = input.split(phrase).ubound

这是对 CaSe 敏感的，因此在您的情况下，该短语应等于“Hello there”，因为输入中没有“hello there”

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2018-07-05T17:13:11.533

扩展[Sumit Kumar 的简单解决方案](https://stackoverflow.com/a/33197234/1447509)，这里是一个单行工作函数：

```
Public Function fnStrCnt(ByVal str As String, ByVal substr As String) As Integer
    fnStrCnt = UBound(Split(LCase(str), substr))
End Function 
```

### 演示：

```
Sub testit()
    Dim thePhrase
    thePhrase = "Once upon a midnight dreary while a man was in a house in the usa."
    If fnStrCnt(thePhrase, " a ") > 1 Then
        MsgBox "Found " & fnStrCnt(thePhrase, " a ") & " occurrences."
    End If
End Sub 'testit() 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2013-01-11T23:26:54.310

不知道这个是不是比较明显？从开头开始`longString`检查下一个字符，直到 中的字符数`phrase`，如果`phrase`没有找到，则从第二个字符开始查找，等等。如果找到，则从当前位置开始，加上字符数，`phrase`并增加`occurences`

```
 Module Module1
Sub Main()

    Dim longString As String = "Hello there. My name is John. I work very hard. Hello there! Hello therehello there"

    Dim phrase As String = "hello There"

    Dim occurences As Integer = 0
    Dim n As Integer = 0

    Do Until n >= longString.Length - (phrase.Length - 1)
        If longString.ToLower.Substring(n, phrase.Length).Contains(phrase.ToLower) Then
            occurences += 1
            n = n + (phrase.Length - 1)
        End If
        n += 1
    Loop
    Console.WriteLine(occurences)

End Sub
End Module 
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2015-07-18T12:22:16.210

我在 Vbscript 中使用了它，您也可以将其转换为 VB.net

```
Dim str, strToFind
str = "sdfsdf:sdsdgs::"
strToFind = ":"

MsgBox GetNoOfOccurranceOf( strToFind, str)

Function GetNoOfOccurranceOf(ByVal subStringToFind As String, ByVal strReference As String)
    Dim iTotalLength, newString, iTotalOccCount
    iTotalLength = Len(strReference)
    newString = Replace(strReference, subStringToFind, "")
    iTotalOccCount = iTotalLength - Len(newString)
    GetNoOfOccurranceOf = iTotalOccCount
End Function 
```

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2015-10-08T14:58:36.933

我知道这个线程真的很旧，但我也有另一个解决方案：

```
Function countOccurencesOf(needle As String, s As String)
    Dim count As Integer = 0
    For i As Integer = 0 to s.Length - 1
        If s.Substring(i).Startswith(needle) Then
            count = count + 1
        End If
    Next
    Return count
End Function 
```

# visual-studio-2010 - LNK 2019 ShellExecuteEx 无法解析的外部符号 Qt Creator

> ID：14286513
> 
> 赞同：0
> 
> 时间：2013-01-11T20:58:12.653
> 
> 标签：visual-studio-2010, lnk2019, shell32

我用 c++ 语言在 Windows7 x64 上工作。

当我使用 ShellExecuteEx 函数向我的网络摄像头显示标记时，我创建了一个打开 Firefox 浏览器的项目。我的项目适用于 Visual Studio 2010。

但是，当我尝试使用 Qt Creator 运行我的项目时，我收到了这个错误：

```
main_cam.obj:-1: error: LNK2019: riferimento al simbolo esterno __imp__ShellExecuteExW@4 non risolto nella funzione _main
debug\cam.exe:-1: error: LNK1120: 1 esterni non risolti 
```

代码是：

```
#include <iostream>
#include <stdio.h>
#include <string>   // for strings
#include <iomanip>  // for controlling float print precision
#include <sstream> // string to number conversion
#include <windows.h>
#include <ShellAPI.h>
include [...]
int main () {
[...]
SHELLEXECUTEINFO ShExecInfo = {0};
ShExecInfo.cbSize = sizeof(SHELLEXECUTEINFO);
ShExecInfo.fMask = SEE_MASK_NOCLOSEPROCESS;
ShExecInfo.hwnd = NULL;
ShExecInfo.lpVerb = NULL;
ShExecInfo.lpFile = "firefox.exe";
ShExecInfo.lpDirectory = NULL;
ShExecInfo.nShow = SW_SHOW;
ShExecInfo.hInstApp = NULL;
[...]
if (condition_is_verified) {

ShExecInfo.lpParameters = (LPCWSTR)"www.google.it";
ShellExecuteEx(&ShExecInfo);
WaitForSingleObject(ShExecInfo.hProcess,INFINITE);
}
[...]
}//end main 
```

我认为问题是 shell32.lib 。如果是，我的电脑中没有这个库。我该如何解决？

你能帮助我吗？

提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-09-23T09:07:34.157

这很简单。只需右键单击项目 pro 文件并添加外部库。选择系统库，静态并给出shell32.lib的路径，即

```
C:\Program Files\Microsoft SDKs\Windows\v7.0A\Lib 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-05-23T09:29:18.897

这是我对这个问题的解决方案：

在 .pro 文件中：**INCLUDEPATH += "C:\Program Files\Microsoft SDKs\Windows\v7.0A\Lib"** （文件 shellAPI.lib 的路径）

在我的 mainwindow.h 中：

```
#define NOMINMAX // You have to do this for windows.h to work, else u'll get mistakes with datetime.h           
#include <windows.h> // (without the space)    
#pragma comment(lib, "Shell32.lib")    
#include <ShellAPI.h> // without space also 
```

# php - PCRE 条件子模式：(R) 作为条件

> ID：14286515
> 
> 赞同：2
> 
> 时间：2013-01-11T20:58:13.277
> 
> 标签：php, regex, pcre

这是来自关于 PCRE 条件子模式的 PHP[手册：](http://php.net/manual/en/regexp.reference.conditional.php)

> 条件子模式的两种可能形式是：
> `(?(condition)yes-pattern)`
> `(?(condition)yes-pattern|no-pattern)`

只要条件是数字或断言就可以了。但我不太明白以下内容

> 如果条件是字符串 (R)，则如果对模式或子模式进行了递归调用，则满足条件。在“顶级”，条件为假。(...) 如果条件不是数字序列或 (R)，则它必须是断言。

**如果有人能举例**说明条件子模式中的 (R) 是什么以及如何使用它，我将不胜感激。提前致谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-24T03:50:50.963

作为一个额外且更清晰的答案……</p>

2 天前，我正在编写一个匹配 IPv4 地址的模式，我发现自己使用条件递归，所以我认为我应该分享（因为它比想象的例子更有意义）。

```
~
(?:(?:f|ht)tps?://)?            # possibly a protocol
(
    (?(R)\.)                    # if it\'s a recursion, require a dot
    (?:                         # this part basically looks for 0-255
        2(?:[0-4]\d|5[0-5])
        | 1\d\d
        | \d\d?
    )
)(?1){3}                        # go into recursion 3 times
                                # for clarity I\'m not including the remaining part
~xi 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-13T03:11:23.183

据我了解（从递归作为子模式中的条件），这是一个非常基本的示例。

```
$str = 'ds1aadfg346fgf gd4th9u6eth0';
preg_match_all('~(?(R).(?(?=[^\d])(?R))|\d(?R)?)~'
/*
(?                          # [begin outer cond.subpat.]
    (R)                     # if this is a recursion               ------> IF
    .                       # match the first char
    (?                      # [begin inner cond.subpat.]
        (?=[^\d])           # if the next char is not a digit
            (?R)            # reenter recursion
    )                       # [end inner cond.subpat.]
    |                       # otherwise                             -----> ELSE
    \d(?R)?                 # match a digit and enter recursion (note the ?)
)                           # [end outer cond.subpat.]
*/
,$str,$m);
print_r($m[0]); 
```

和输出：

```
Array
(
    [0] => 1aadfg
    [1] => 34
    [2] => 6fgf gd
    [3] => 4th
    [4] => 9u
    [5] => 6eth
    [6] => 0
) 
```

我知道这是一个愚蠢的例子，但我希望它是有道理的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-11T22:15:47.163

(R) 代表递归。这是使用它的一个很好的例子。

[递归模式](http://php.net/manual/en/regexp.reference.recursive.php#102748)

不确定我曾经见过`(?R)`used 作为**condition**，甚至是可以使用的情况，或者至少在我的理解中没有。但是你每天都会在编程中学习新东西。

它可以很容易地用作**真假**陈述。

按照这个：

```
< (?: (?(R) \d++  | [^<>]*+) | (?R)) * > 
```

`(?R)`在虚假陈述中使用as的地方。匹配尖括号中的文本，允许任意嵌套。嵌套括号中只允许使用数字（即递归时），而外层允许使用任何字符。

我知道这不是你要找的答案……你现在派我去研究这个。

# c - printf 应该打印出一个“长”值吗？

> ID：14286516
> 
> 赞同：2
> 
> 时间：2013-01-11T20:58:16.090
> 
> 标签：c

> **可能重复：**
> [为什么 getchar() 不能在 Windows 控制台中将返回识别为 EOF？](https://stackoverflow.com/questions/1793616/why-doesnt-getchar-recognise-return-as-eof-in-windows-console)

我正在尝试在下一个程序中打印出变量“nc”中的值：

```
int main()

{ 
 long nc;
 nc = 0;

 while (getchar() != EOF)
 ++nc;
 printf("%ld\n", nc); 
} 
```

请告诉我为什么不打印？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-11T21:04:07.047

您的 while 循环中没有括号（这就是为什么不使用括号会导致软件出错）。因此，该值会增加，但不会打印。

尝试：

```
int main(int argc, char** argv)
{ 
    long nc;
    nc = 0;

    while (getchar() != EOF)
    { // ADD THIS
        ++nc;
        printf("%ld\n", nc); 
    } // AND THIS
} 
```

否则，您的代码实际上是在做：

```
int main(int argc, char** argv)
{ 
    long nc;
    nc = 0;

    while (getchar() != EOF)
    {
        ++nc; // ENDLESSLY ADDING
    }
    printf("%ld\n", nc); // NEVER REACHED DUE TO WHILE LOOP.
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-11T21:01:26.150

您的 while 循环将继续循环，直到您在 Unix 上使用 Control-D 或在 Windows 上使用 Control-Z，Return 结束输入。它会在不打印任何内容的情况下执行此操作，因为您没有在 ++nc 和 printf 周围使用大括号。

`#include <stdio.h>`如果您没有在程序的顶部，您可能还会遇到 printf 问题。如果编译器不知道 printf 是一个可变参数函数，那么它在调用它时将无法正确格式化参数列表。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-01-11T21:07:12.663

输入一些输入后

`1` `2` `4` 你必须输入，因为它是等效`ctrl + D`的 EOF 。`ASCII`

否则修改程序并放

> while(getchar()!='\r') （直到你点击`Enter`）

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-01-11T21:01:36.930

你是什​​么意思？有用：

```
./a.out 
asdfsdfasdfasdfasddddddddddddddddddddddd
41

echo "Try to count this" | ./a.out 
18 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-01-11T21:01:40.437

您必须通过停止 getchar 的 while 循环来停止从标准输入读取字符

然后你会看到打印的 nc 值

去做

`EOF`= `CTRL`+ `D`（对于 Linux）

`EOF`= `CTRL`+ `Z`（对于 Windows）

# javascript - 将 Google 地理编码精度与 Javascript 结合使用

> ID：14286520
> 
> 赞同：0
> 
> 时间：2013-01-11T20:58:39.483
> 
> 标签：javascript, google-geocoder

访问 Google Geocoding Accuracy 值的语法是什么？这是我目前所拥有的，但它是在黑暗中完全刺伤：

```
var googleValue = results[0].geomtery.Accuracy; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-12T14:19:40.593

From [the API docs](https://developers.google.com/maps/documentation/geocoding/v2/index#GeocodingAccuracy) comes this example response:

```
http://maps.googleapis.com/maps/geo?q=Toledo&output=json&sensor=false&gl=es
#
# Returns
#
{
  "name": "Toledo",
  "Status": {
    "code": 200,
    "request": "geocode"
  },
  "Placemark": [ {
    "id": "p1",
    "address": "Toledo, Spain",
    "AddressDetails": {
        "Country": {
            "CountryNameCode": "ES",
            "CountryName": "Spain",
            "AdministrativeArea": {
                "AdministrativeAreaName": "CM",
                "SubAdministrativeArea":     {
                    "SubAdministrativeAreaName": "Toledo",
                    "Locality": {"LocalityName": "Toledo"}
                }
            }
        },
        "Accuracy": 4},
    "Point": {
      "coordinates": [ -4.0244759, 39.8567775, 0 ]
    }
  } ]
} 
```

So you would access it as `PlaceMark[0].AddressDetails.Accuracy`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-14T17:36:00.623

正如第一条评论所说 - V3 不再支持此位置功能。相反，您会收到一个“位置类型”值，该值使用一组四层值来描述准确性。可以使用以下语法访问它：

```
var googleValue = results[0].geometry.location_type; 
```

# javascript - Sencha Touch & ExtJS 配置文件在一个 Web 项目/虚拟主机中用于桌面和移动设备？

> ID：14286522
> 
> 赞同：2
> 
> 时间：2013-01-11T20:58:47.277
> 
> 标签：javascript, model-view-controller, web-applications, extjs4, sencha-touch-2

我正在使用 ExtJS 和 Sencha Touch 创建一个具有桌面和移动版本的 Web 应用程序。

ExtJS 4 和 Sencha Touch 2 使用 MVC 方法，而 Sencha Touch 2 为不同的设备（iPhone、平板电脑等）合并了“配置文件”。

然而，ExtJs 4 没有配置文件的概念。让桌面、iPhone 和 iPad 版本的应用程序的依赖项存在于同一个应用程序目录层次结构中的同一个虚拟主机下是否切实可行？

或者，在处理 Sencha 框架时，为桌面 (app.com) 和移动网站 (m.app.com) 使用不同的虚拟主机通常更容易接受吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-25T00:47:53.760

我最近也有同样的情况。我有一个基于用户代理返回桌面或移动 index.html 的 c# 控制器。它全部显示为[http://www.mydomain.tld](http://www.mydomain.tld)并在单个 IIS 站点下运行。由于所有调用都是 AJAX 到 REST，它们共享相同的服务器代码。改变的只是观点。任何其他服务器和语言也可以这样做。

我的结构是：

```
根
 |_桌面
 | |_app
 | |_lib
 | |_资源
 |_手机
 | |_app
 | |_lib
 | |_资源
 |_共享
     |_localization.js（通用 JS 对象）
     |_proto.js（我的通用原型函数）

```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-14T21:49:57.270

现在，不，将所有东西都放在同一个项目中是不现实的。

Ext JS 和 Touch 尽管有相似的 API，但没有*相同*的API。因此，您可能无法在框架之间共享任何代码（当前 Ext JS 4.1.3 和 Touch 2.1.0 是最新版本）。

因此，由于您最终要编写单独的应用程序，我会让它们完全独立的代码库。

至于您的域/虚拟主机问题......您可以通过任何一种方式配置您的服务器，我不知道这在我看来是否如此重要。

# c++ - string::reserve 的使用

> ID：14286526
> 
> 赞同：1
> 
> 时间：2013-01-11T20:58:58.317
> 
> 标签：c++, string

什么时候使用合适`string::reserve`？我意识到它用于为字符串保留一定数量的字符，但这有什么用呢？如果您过去，字符串是否仍会调整大小？它会增加效率吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-11T20:59:58.150

它将“保留”指定的空间以减少重新分配的次数。如果您对字符串的大小有一个很好的了解，那么保留该空间量应该可以防止任何重新分配。

如果你过去，它会调整大小，但想法是减少重新分配的数量。

# javascript - 数据表使用 fnAddData 或类似方法动态添加行并将类添加到特定列

> ID：14286528
> 
> 赞同：1
> 
> 时间：2013-01-11T20:59:00.140
> 
> 标签：javascript, jquery, datatables

好的，我正在尝试使用数据表将新行动态添加到已呈现的表中。到目前为止我所拥有的是

```
oTable.fnAddData(["D:\Exlab", '[<a href="#" class="datasource_row_edit" data-idr="reference">Edit</a>] [<a href="#" class="datasource_row_delete" data-idr="reference">Delete</a>]']); 
```

这适用于添加单行（如果有人知道如何使用类似的函数来添加多行而不运行将是奖励的循环）。但是，在这种情况下，我希望有一个特定的列，第二列有一个特殊的类，有没有办法将一个类添加到动态添加的列中？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-11T21:32:18.153

我认为您可以通过控制列定义并通过 fnRender 分配类来完成此操作。定义列后，向 fnAddData 函数提供一些数据。

这是一个类似的 SO 问题..[单击此处](https://stackoverflow.com/questions/6518989/jquery-datatables-fnrender-with-objects)，我​​认为您会发现它很有用。

在您的情况下，我认为列定义看起来像这样

```
...
    "aoColumns": [
            {   
                "sClass": "datasource_row_edit",
                "fnRender": function( oObj ) {
                    return '<a href="#" data-idr="reference">Edit</a>';
                } 
            },
            {  
              "sClass": "datasource_row_delete",
               "fnRender": function( oObj ) {
                    return '<a href="#" data-idr="reference">Delete</a>';
                } 
            }
        ],
... 
```

通过他们的 api .. [http://www.datatables.net/api](http://www.datatables.net/api) ...您可以通过 json 为表格提供任意数量的行

```
var json = eval("[" + response + "]");
oTable.fnAddData(json); 
```

并让数据表动态呈现任何格式本身

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-11T23:39:01.660

对于您的第一个问题，您可以连接到“fnCreatedRow”回调，[http:](http://www.datatables.net/usage/callbacks) //www.datatables.net/usage/callbacks 。这将允许您侦听行添加事件并根据需要对其进行操作。

“奖励”是您可以将二维数组传递给 fnAddData 以避免循环

# c# - 解密通过 LAN 发送的消息

> ID：14286533
> 
> 赞同：0
> 
> 时间：2013-01-11T20:59:17.050
> 
> 标签：c#, regex, encryption

我正在使用 TCPClient 通过 LAN 发送消息（数组列表），所以我分开了：

*   具有组合的数组元素：`string arr_sep = "[s{p(a)c}e]";`
*   列出具有组合的元素：`string list_sep = "[n|e|w)";`

如何破译以下`string`行以`List<string[]>`使用正则表达式？

```
string tessst = "abra[s{p(a)c}e]kada[s{p(a)c}e]bra[n|e|w)hel[s{p(a)c}e]oww[s{p(a)c}e]een"; 
```

这是我试图做的：

```
 string tessst = "abra[s{p(a)c}e]kada[s{p(a)c}e]bra[n|e|w)hel[s{p(a)c}e]oww[s{p(a)c}e]een";
        List<string[]> splited2 = new List<string[]>();

        if (tessst.Length > 0)
        {
            List<string> splited1 = new List<string>(Regex.Split(tessst, "[^a-zA-Z]+")); //[s{p(a)c}e]

            for (int i = 0; i < splited1.Count; i++)
            {
                splited2.Add(Regex.Split(splited1[i], "[^a-zA-Z]+")); // [n|e|w)
            }
        }
        //splited2  is the result! 
```

不幸的是，正则表达式完全被破坏了——我该如何修复它？也许有更好的方法吗？

**预期结果：**

```
List<string[]> result = new List<string[]>();
result.Add(new string[]{"abra", "kada", "bra"});
result.Add(new string[]{"hel", "oww", "een"}); 
```

**编辑：修复**

当我收到数据时 - 我通常将字节限制为 1024，但这不足以获取所有 50 个条目`List<string[]>`！

我将字节数增加到 10000，现在所有信息都通过 LAN！序列化 50`string[]`个`List<string[]>`. 将来我将在我的列表中使用多达 900 个条目，因此可以安全地假设我将需要：

> (3499/50)*900 = 63000 字节来序列化我的数据！！

问题是 - 一次发送必须数据是否安全/可靠？这是我用来接收的代码：

```
string message = "";
int thisRead = 0;
int max = 10000; // from 1024 to 10000
Byte[] dataByte = new Byte[max];
using (var strm = new MemoryStream())
{
  thisRead = Nw.Read(dataByte, 0, max);
  strm.Write(dataByte, 0, thisRead);
  strm.Seek(0, SeekOrigin.Begin);

  using (StreamReader reader = new StreamReader(strm))
  {
     message = reader.ReadToEnd();
  }

}
List<string[]> result = new JavaScriptSerializer().Deserialize<List<string[]>>(message ); 
```

那就是发送：

```
List<string[]> list= new List<string[]>();
list = browser_ex.GetMusicListSer(); // 50 list elements
string text_message = new JavaScriptSerializer().Serialize(list);
MemoryStream Fs = new MemoryStream(ASCIIEncoding.Default.GetBytes(text_message));
Byte[] buffer = Fs.ToArray();
Nw.Write(buffer, 0, buffer.Length); // 3499 bytes 
```

我可以将最大字节数增加到**10 万**并且一劳永逸地忘记这个问题吗？应该有另一种解决方案......我相信。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-11T21:12:36.310

与其重新发明轮子，不如使用*序列化*

你有很多替代方案*（JavaScriptSerializer、DataContractSerializer、DataContractJsonSerializer、BinaryFormatter、SoapFormatter、XmlSerializer）。*

```
List<string[]> list = new List<string[]>();
list.Add(new string[] { "abra", "kada", "bra" });
list.Add(new string[] { "hel", "oww", "een" });

string stringToSend = new JavaScriptSerializer().Serialize(list);
//Send 
string receivedString = stringToSend;
List<string[]> result = new JavaScriptSerializer()
                            .Deserialize<List<string[]>>(receivedString); 
```

**“编辑”**

假设`Nw`是`NetworkStream`，您的代码可以像这样简单：

```
//Receiver
StreamReader reader = new StreamReader(Nw);
while (true)
{
    List<string[]> result = new JavaScriptSerializer()
                .Deserialize<List<string[]>>(reader.ReadLine());

    //do some work with "result"

}

//Sender
StreamWriter writer = new StreamWriter(Nw);
while (true)
{
    //form your "list" and send
    writer.WriteLine(new JavaScriptSerializer().Serialize(list));
    writer.Flush();
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-11T21:18:30.377

```
string tessst = "abra[s{p(a)c}e]kada[s{p(a)c}e]bra[n|e|w)hel[s{p(a)c}e]oww[s{p(a)c}e]een";
List<string[]> splited2 = new List<string[]>();

if (tessst.Length > 0)
{
    List<string> splited1 = new List<string>(Regex.Split(tessst, @"\[n\|e\|w\)")); 

    for (int i = 0; i < splited1.Count; i++)
    {
        splited2.Add(Regex.Split(splited1[i], @"\[s\{p\(a\)c\}e\]"));
    }
} 
```

这将为您提供您描述的所需输出。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-11T21:10:47.230

如果您确定不想使用任何现有协议或技术，则可以使用[BinaryWriter](http://msdn.microsoft.com/en-us/library/system.io.binarywriter.aspx)和[BinaryReader](http://msdn.microsoft.com/en-us/library/system.io.binaryreader.aspx)类轻松发明自己的协议：

*发件人：*

```
using (var writer = new BinaryWriter(networkStream))
{
    foreach (var array in list)
    {
        writer.Write(array.Length);
        for (int i = -; i < array.Length; i++)
        {
            writer.Write(array[i]);
        }
    }
    writer.Write(0);
    writer.Flush();
} 
```

*接收者：*

```
using (var reader = new BinaryReader(networkStream))
{
    var list = new List<string[]>();
    int length;
    while ((length = reader.ReadInt32()) != 0)
    {
         var array = new string[length];
         for (int i = 0; i < array.Length; i++)
         {
             array[i] = reader.ReadString();
         }
         list.Add(array);
    }
} 
```

# c++ - c++基类包含派生类的实例

> ID：14286534
> 
> 赞同：1
> 
> 时间：2013-01-11T20:59:16.740
> 
> 标签：c++, oop, class, inheritance

我想知道是否有人可以向我解释我如何能够实现类似的东西：

```
namespace advanced_cpp_oop
{
  class A
  {
    B b;
  };

  class B : public A
  {
  };
}

int main()
{
} 
```

基类的实例在哪里可以包含派生类的实例？编译上述代码时，会产生以下错误：

```
g++ advanced_cpp_oop.cpp 
advanced_cpp_oop.cpp:8:5: error: ‘B’ does not name a type 
```

可以编译的（几乎）等效的 Java 代码是：

```
public class AdvancedCppOop
{
  public static void main(String[] args)
  {
    A a;
  }
}

class A
{
  B b;
}

class B extends A
{
} 
```

谢谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-11T21:04:04.660

您需要添加一个指针和一个前向声明：

```
namespace advanced_cpp_oop
{
  class B;

  class A
  {
    B* b;
  };

  class B : public A
  {
  };
} 
```

在您的 C++ 代码中，您正在创建`class B`inside的一个实例`class A`，这是不可能的，因为编译器还不知道`class B`.

使用我的答案中的代码，您需要动态分配一个实例`class B`并将其分配给`b`代码中其他位置的指针。

附带说明一下，从设计的角度来看，这并没有真正的意义，因为父类不应该依赖于子类。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-01-11T21:06:32.107

您必须使用某种类型的指针（例如 unique_ptr）和前向声明来执行此操作：

```
 class B;

  class A
  {
    std::unique_ptr<B> b;
  };

  class B : public A
  {
  }; 
```

不过这很愚蠢，您可能应该重新考虑您的设计。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-01-11T22:21:20.770

C++ 和 Java 之间有一个非常重要的区别。C++ 是一种具有值语义的语言，而 Java 是一种具有引用语义的语言。在 Java 中创建除原始类型以外的任何变量时，您创建的不是该类型的对象，而是对此类对象的引用。相反，在 C++ 中，相同的构造指的是一个实际的对象。

如果您牢记这一点，就很容易理解为什么以下内容不可能起作用：

```
class Base {
   Derived d;
};
class Derived : Base {}; 
```

C++ 中的第一个定义意味着对象 Base 在内部（不是通过引用）包含 Derived 类型的对象。同时，Derived 通过继承包含一个 Base 类型的子对象。

这意味着 Derived 包含一个 Base ，该 Base 包含一个包含 Base 的 Derived ... Base 或 Derived 的大小是多少？

在具有引用语义的语言中，或者在使用指针的 C++ 中，这不是问题。Base 对象包含一个指向Derived的*引用/指针。*Derived 通过继承包含一个 Base 子对象。Base 的大小是众所周知的：所有其他字段加上引用/指针的大小。Derived 的大小是 Base 的大小加上添加的任何额外成员。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-01-11T21:09:18.940

Andreas 在正确答案上击败了我，但我只想补充一点，Java 代码之所以有效，只是因为 Java 对象是由指针隐式持有的（因此这些`B b = new B(...);`语句散布在 Java 代码中），即使它看起来并不像它。您的原始 C++ 代码不起作用（即使添加了 B 类的前向声明），因为编译器不知道 B 对象有多大，因此不知道包含它的 A 对象有多大。另一方面，所有指针都具有相同的大小（无论指向的类型如何），因此当您将 B 对象替换为指向 A 类中 B 对象的指针时，编译器不会出现此类问题。

# javascript - Javascript 从 [object HTMLDivElement] 获取数据

> ID：14286537
> 
> 赞同：-1
> 
> 时间：2013-01-11T20:59:42.057
> 
> 标签：javascript, forms, onsubmit

```
function createChatbox (from) {
console.log(from); //from= Hola
var chatBoxId= from+ 'chatbox';
$('#privateChat').append('<div id="'+ chatBoxId +'" class="chatbox"></div>');
$('#' + chatBoxId).draggable({ handle: '.drag' });
$('#' + chatBoxId).append('<p id="titulo" class="drag">Chat privado con: '+ from +'</p> <div id="'+ from +'textchat" class="textchat"></div><form id="msgPrivate" onsubmit="return formSubmit('+ from +')"><input type="text" id="privateMsg" class="texto" required><input type="submit" class="boton" value="Enviar" class="btnLogIn" id="sendPrivate"> ');
}

function formSubmit (from) {
console.log("entro en formSubmit");
console.log("from es: " +from); //from= [object HTMLDivElement]
sendPrivateMessage(from);
return false;
} 
```

当它转到 formSubmit('+ from +') 时，from 转换为 [object HTMLDivElement] 我如何从该对象获取数据？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-11T23:11:58.563

解决方案是这样的：

```
onsubmit="return formSubmit('+'\''+ from +'\''+')" 
```

谢谢！

# sql - 在每个类别中查找最后一行

> ID：14286539
> 
> 赞同：1
> 
> 时间：2013-01-11T20:59:49.293
> 
> 标签：sql, sybase

我正在使用`Sybase`它不支持人们在这里使用的很多很酷的功能。所以，在帮助我的时候请记住这一点。

我有一个看起来像这样的数据库：

```
类型         RowTime             数量        
第一类 1 10:01:01.000 50          
猫 1 2 10:01.01.001 0          
1 类 3 10:01:01.002 1000          
1 类 4 10:01.01.003 100          
1 类 5 10:01:03.001 100          

```

除了*cat2、cat3、cat4 等*。

我想*根据*. *`ascending order`*所以，对于上面给定的表格，我想提取`row 5`.

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-11T21:15:33.173

在查看 sybase 文档后，您似乎有一个 rank 函数。所以这里是一个刺：

```
declare @table table ( tp varchar(30), rowtime datetime, quantity int) 

insert @table select 'cat1 1', '20120101', 50
insert @table select 'cat2 1', '20130101', 50
insert @table select 'cat3 1', '20110101', 50
insert @table select 'cat4 1', '20100101', 50
insert @table select 'cat5 1', '20090101', 50
select * from (
   select *, RANK() OVER (ORDER BY  RowTime DESC) AS Rank from @table 
) a
where [RANK]=1 
```

从这里获得排名功能：http: //infocenter.sybase.com/help/index.jsp?topic=/com.sybase.infocenter.dc00169.1270/html/iqperf/ [CEGDJFCE.htm](http://infocenter.sybase.com/help/index.jsp?topic=/com.sybase.infocenter.dc00169.1270/html/iqperf/CEGDJFCE.htm)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-11T21:02:32.643

这是一种方式：

```
SELECT A.*
FROM YourTable A
INNER JOIN (SELECT Type, MAX(Time) MaxTime
            FROM YourTable
            GROUP BY Type) B
    ON A.Type = B.Type AND A.Time = B.MaxTime 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-14T12:05:09.490

SELECT * FROM table_name GROUP BY 类型 HAVING RowTime = max(RowTime)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-11T21:44:29.630

几个 Oracle 查询可能会给您一些想法。我不确定这些分析功能是否在 Sybase 中可用。基本上，您需要按类别对查询进行分区，然后获取该类别中的最后一行 - 在您的情况下可能是 MAX(row_time) 。许多分析函数可用于此：ROW_NUMBER()、RANK()、DENSE_RANK()...

```
-- Selects sal within dept with Rank = 2 --
SELECT ename, sal, sal_rank
  FROM ( SELECT ename, sal, DENSE_RANK() OVER (PARTITION BY deptno ORDER BY sal ASC) sal_rank FROM scott.emp ) 
WHERE sal_rank <= 2
/

-- MIN/MAX sal in each dept --
SELECT empno, deptno, sal,
   MIN(sal) KEEP (DENSE_RANK FIRST ORDER BY sal) OVER (PARTITION BY deptno) "Lowest",
   MAX(sal) KEEP (DENSE_RANK LAST ORDER BY sal) OVER (PARTITION BY deptno) "Highest"
 FROM scott.emp
ORDER BY deptno, sal
/ 
```

# php - PHP CURLOPT_PROGRESSFUNCTION 为函数添加额外的自定义参数

> ID：14286541
> 
> 赞同：3
> 
> 时间：2013-01-11T20:59:57.457
> 
> 标签：php, curl

我想知道是否可以在使用时调用的函数中添加自定义参数

```
curl_setopt($ch, CURLOPT_PROGRESSFUNCTION, array($this, 'progressFunction')); 
```

所以函数签名看起来像

```
private function progressFunction($clientp, $dltotal, $dlnow, $ultotal, $ulnow, $myCustomParameter) { } 
```

代替

```
private function progressFunction($clientp, $dltotal, $dlnow, $ultotal, $ulnow) { } 
```

谢谢。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-01-11T21:11:08.007

好的，这严格来说是一个建议，我会将其作为答案，因为我认为它可能会起作用；

PHP 支持匿名函数，所以你可以像这样传递它：

```
curl_setopt($ch, CURLOPT_PROGRESSFUNCTION, function ($clientp, $dltotal, $dlnow, $ultotal, $ulnow) {

}); 
```

现在诀窍是使用以下方法传递您的参数`use`：

```
curl_setopt($ch, CURLOPT_PROGRESSFUNCTION, function (...) use ($myCustomParameter) {
    // Your code
    }); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-06-05T22:11:14.380

在 PHP 类中，您可以将其他参数传递`$statusName`给另一个函数，如下所示：

```
curl_setopt($ch, CURLOPT_PROGRESSFUNCTION, function ($resource, $downloadSize, $downloaded, $uploadSize, $uploaded) use ($statusName) {
    $this->progress($resource, $downloadSize, $downloaded, $uploadSize, $uploaded, $statusName);
}); 
```

然后，您专用的进度功能不会使代码变得更加丑陋：

```
private function progress($resource, $downloadSize, $downloaded, $uploadSize, $uploaded, $statusName="curl_download_status")
{
    // emit the progress    
    Cache::put($statusName, [
        'resource' => $resource,
        'download_size' => $downloadSize,
        'downloaded' => $downloaded,
        'upload_size' => $uploadSize,
        'uploaded' => $uploaded
    ], 10);

} 
```

# c# - 所有 List 值都等于 List 列

> ID：14286543
> 
> 赞同：0
> 
> 时间：2013-01-11T20:59:59.117
> 
> 标签：c#, .net, linq, list

你好，我有一个问题，我不能解决它 3 天。我在这里和谷歌上发了很多帖子，但我找不到解决方案。

在 db 我有列“Gene” - nvarchar(350) 其中包含例如：

```
row 1: 1,4,32,11
row 2: 32,11
row 3: 1
row 4: 4,56,1,23
row 5: 4 
```

从 checkboxlist 我检查这个值： 1,4 添加到

```
List<string> gnr = new List<string>(); 
```

**我想要的结果是第 1 行和第 4 行。**

我制作了（取自stackoverflow）代码，结果是第3行和第4行：

```
 var result = from m in db.Movies
              where gnr.Contains(m.Gener)
              select m; 
```

结果是第 1 行、第 3 行、第 4 行和第 5 行的代码：

```
foreach (string term in gnr)
{
    var trb = db.movies.Where(o => o.Gener.Contains(term));
} 
```

使用 Ole DB 我可以做到，但使用 LINQ 我做不到这里的代码：

```
List<string> Gener = new List<string>();
Gener = Action,Comedy

StringBuilder builder = new StringBuilder();
string lastItem = Gener[Gener.Count - 1];

// Here I made string Which I'll add to cmd string
foreach (string safePrime in Gener)
{
    if (safePrime != lastItem)
    {
        builder.Append("((gener LIKE '%" + safePrime + "%')) AND").Append(" ");
    }
    else
    {
        builder.Append("((gener LIKE '%" + safePrime + "%')) ORDER By ID DESC").Append(" ");
    }
}

string dbSelect = builder.ToString();

//The result from loop
dbSelect = "((GenerLIKE '%Action%')) AND ((GenerLIKE '%Comedy%')) ORDER By ID"
//Add dbSelect to exist cmd
Cmd1.CommandText = "SELECT * FROM movies WHERE " + dbSelect; 
```

这里的结果就是我想要的 LINQ，选择所有动作和喜剧的电影谢谢你花时间，我会非常感谢你的帮助。对不起我的英语我希望它是可读的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-11T21:05:26.590

`String.Split`不适用于实体框架，因此您可以在内存中移动拆分生成列值：

```
var result = from m in db.movies.ToList()
             let movieGnr = m.Gener.Replace(" ", "").Split(',')
             where m.Gener != null && !gnr.Except(movieGnr).Any()
             select m; 
```

返回第 1 行和第 4 行。

更新：如上所述，此解决方案会将所有电影数据加载到内存中。我建议您更改数据库结构 - 创建 MovieGenes 表，其中将包含每部电影的 Geners。并将导航属性添加到将包含 Geners 列表的 Movie。该解决方案将允许将所有查询移动到数据库端。

```
int[] gnr;
var result = from m in db.movies.Include("Geners")                 
             where gnr.All(g => m.Geners.Any(x => x.Id == g))
             select m; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-08-24T18:19:33.923

下面使用的查询将返回第 1 行和第 4 行数据。我们需要使用 where 子句并检查行数据长度。第 1 行和第 4 行的数据长度为 9。此查询可以工作。

```
 var result= db.Movies.Where(mv => mv.Gener.Length > 8).Select(mv => mv.Gener); 
```

# ios - UIScrollView 旋转后将不允许滚动或交互

> ID：14286545
> 
> 赞同：4
> 
> 时间：2013-01-11T21:00:10.070
> 
> 标签：ios, uiscrollview, ios-simulator, uiinterfaceorientation, uitouch

在我的

```
-(void) willRotateToInterfaceOrientation:(UIInterfaceOrientation)toInterfaceOrientation duration:(NSTimeInterval)duration; 
```

方法，我有代码可以在应用程序随设备旋转时重新定位和调整滚动视图的大小。我用下面的代码来做：

```
-(void) willRotateToInterfaceOrientation:(UIInterfaceOrientation)toInterfaceOrientation duration:(NSTimeInterval)duration{

    [super willRotateToInterfaceOrientation:toInterfaceOrientation duration:0.5f];

    if (toInterfaceOrientation == UIInterfaceOrientationLandscapeRight){
         //landscape
    [mT.buttonScroll setFrame:CGRectMake(0, 544, 1024, 160)];

    }else if (toInterfaceOrientation == UIInterfaceOrientationLandscapeLeft){
        //landscape
    [mT.buttonScroll setFrame:CGRectMake(0, 544, 1024, 160)];

    }else if (toInterfaceOrientation == UIInterfaceOrientationPortrait){
       //portrait
    [mT.buttonScroll setFrame:CGRectMake(0, 800, 768, 160)];

    }else if (toInterfaceOrientation == UIInterfaceOrientationPortraitUpsideDown){
      //portrait
    [mT.buttonScroll setFrame:CGRectMake(0, 800, 768, 160)];

    }
} 
```

一切都正确旋转，但是一旦我第二次旋转，滚动视图就变得完全不可触摸。无法滚动或触摸其中的任何按钮。然后，如果我旋转回上一个视图，触摸就会回来，依此类推。有谁知道它为什么这样做？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-21T17:22:38.297

改变`Frame`一切都很好，但是当谈到`UIScrollViews`它时`contentSize`，一切都变得不同了。`contentSize`更改方向时需要设置。您可以通过在更改方向时添加类似的内容来做到这一点。

```
[mT.buttonScroll setContentSize:CGSizeMake(width, height)]; 
```

我认为这`mT.buttonScroll`是某种`UIScrollView`.

这里发生的是您将内容区域的大小重置为您想要的大小。您可以在此处修改宽度和高度。

如果不给我们评论，希望这会有所帮助，我会尽力提供帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-21T14:47:39.087

我认为您应该使用**shouldAutorotateToInterfaceOrientation**并观察您的旋转和 UI 响应能力。

在我的测试中，它适用于我提到的方法。**willRotatetoInterfaceOrientation**在其“应该”对应物之后被调用。否则，它根本不会被调用。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-06-17T03:36:04.773

除了大力水手的回答（这是正确的；）我发现我需要像这样在整个地方设置内容大小以避免这个问题。

```
-(void)viewDidAppear:(BOOL)animated{
[super viewDidAppear:animated];
[scroller setScrollEnabled:YES];
[scroller setContentSize:CGSizeMake (0,100)];
}

-(void)viewWillAppear:(BOOL)animated{
[super viewWillAppear:animated];
[scroller setScrollEnabled:YES];
[scroller setContentSize:CGSizeMake (0,100) ];
}

-(void)viewDidLoad
{
[super viewDidLoad];
[scroller setScrollEnabled:YES];
[scroller setContentSize:CGSizeMake (0,100) ];
}

-(void)didRotateFromInterfaceOrientation:(UIInterfaceOrientation)fromInterfaceOrientation
{
if ([[UIDevice currentDevice] orientation] == UIDeviceOrientationLandscapeLeft || [[UIDevice currentDevice] orientation] == UIDeviceOrientationLandscapeRight)
{
NSLog(@"Lanscapse");
[scroller setScrollEnabled:YES];
[scroller setContentSize:CGSizeMake (0,100];
}
if([[UIDevice currentDevice] orientation] == UIDeviceOrientationPortrait || [[UIDevice currentDevice] orientation] == UIDeviceOrientationPortraitUpsideDown )
{
NSLog(@"Portrait");
[scroller setScrollEnabled:YES];
[scroller setContentSize:CGSizeMake (0,100) ];
}
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-11-15T08:07:59.650

我也面临同样的问题 请按照以下步骤操作： 1\. 给滚动视图提供顶部、底部、前导和底部约束 2\. 滚动视图中的包装视图给出顶部、底部、前导和底部以及与父视图相等的宽度。3.**非常重要的一步**：将所有内部 UI 元素与前导、尾随、顶部、底部和高度链接。特别是最后一个元素记得添加底部以及高度和尾随

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2013-01-21T16:08:24.663

检查滚动视图的框架。旋转后，滚动视图的框架穿过窗口框架，因此滚动视图没有响应触摸。

此外，我假设在计算 rect 时，您会考虑其他视图 rect（如果存在），如导航栏、标签栏、状态栏

# templates - 根据用户的浏览器切换 Joomla 模板

> ID：14286548
> 
> 赞同：0
> 
> 时间：2013-01-11T21:00:16.783
> 
> 标签：templates, joomla

有没有办法根据用户浏览器自动切换 joomla 中使用的默认模板？例如，我目前正在为我的一个网站使用 Gantry 框架，将 IE6、7 和 8 容纳到这个框架中需要大量的工作，我想知道是否有一个脚本可以检测用户浏览器，比如 IE7，如果用户正在使用这个浏览器，Joomla 会自动切换到与该浏览器兼容的模板？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-12T00:35:56.027

是的，有一种方法，叫做“条件注释”。条件注释是一种特殊类型的 HTML 注释，作为条件工作，它们主要用于检查 Internet Explorer 版本（因为 css 兼容性）。

词汇：

*   lte：小于或等于
*   gte：大于等于
*   lt：小于
*   gt：大于
*   ！： 不是

这是条件注释的使用：

```
<!--[if <something from vocabulary> IE <version>]>
code
<![endif]--> 
```

让我们看一些例子

```
<!--[if IE]>
You are certainly running Internet Explorer<br />
<![endif]-->

<!--[if !IE]>
You are certainly NOT running Internet Explorer<br />
<![endif]-->

<!--[if IE 6]>
You are certainly running Internet Explorer version 6<br />
<![endif]-->

<!--[if lte IE 6]>
You are certainly running Internet Explorer and it's version is lower or equal to 6<br />
<![endif]-->

<!--[if gte IE 6]>
You are certainly running Internet Explorer and it's version is greater or equal to 6<br />
<![endif]-->

<!--[if lt IE 6]>
You are certainly running Internet Explorer and it's version is lower than 6<br />
<![endif]-->

<!--[if gt IE 6]>
You are certainly running Internet Explorer and it's version is greater than 6<br />
<![endif]--> 
```

> 将 IE6、7 和 8 纳入此框架将是一项艰巨的工作

其实joomla模板是由一些css文件组成的，命名为template.css、template.ie6.css、template、ie7.css等。

这不是一项繁重的工作，因为 template.css 包含完整的模板 css，而 template.ie#.css 文件只包含那些需要被覆盖才能使用特定版本的 IE 的规则。

然后，在模板索引文件中，有一些Conditional Comments，根据你使用的浏览器切换css

来源：[http ://www.quirksmode.org/css/condcom.html](http://www.quirksmode.org/css/condcom.html)

# ruby-on-rails - solr 和太阳黑子方面的总分

> ID：14286553
> 
> 赞同：1
> 
> 时间：2013-01-11T21:00:40.500
> 
> 标签：ruby-on-rails, solr, sunspot, facet

搜索后，每个构面行都有命中的值和计数。

是否有可能在不触发新搜索的情况下获得构面中所有命中的总分（总和）？

让我们考虑以下场景：

模型

```
class Article < ActiveRecord::Base
  belongs_to :category
  searchable do
    text :title
    integer :category_id, :references => Category
  end
end 
```

控制器的方法

```
def search
  @search = Article.search do
    keywords params[:q]
    with(:category_id, params[:c].to_i) if params[:c].present?
    facet :category_id
    data_accessor_for(Article).include = :category
    paginate(:page => params[:page])
  end
end 
```

哈姆尔视图摘录

```
- search.facet(:category_id).rows.each do |row|
  %li
    = link_to(row.instance.name, params.merge(:c => row.value).except(:page))
    %div.score= row.score 
```

所以我想得到这个方面的总分，它是这个方面命中分数的总和。

# sockets - c++ posix sockets recv 功能

> ID：14286558
> 
> 赞同：3
> 
> 时间：2013-01-11T21:01:24.583
> 
> 标签：sockets, recv

我有一个可能很愚蠢的问题要问，我环顾四周，但没有看到直接的答案，我想我可能会在这里得到一个快速的答案。在使用 bsd 套接字的简单 TCP/IP 客户端-服务器选择循环中，如果客户端发送两条同时到达服务器的消息，服务器上对 recv 的调用是否会返回捆绑在缓冲区中的两条消息，还是 recv 强制每个不同的到达消息要单独阅读？

我问是因为我在一个无法判断客户端如何构建要发送的消息的环境中工作。通常，recv 报告读取了 12 个字节，然后是 915，然后是 12 个字节，然后是 915，依此类推，以这种交替的 12 到 915 模式......但有时它会报告 927（即 915+12）。我在想，要么是客户端在将它的一些信息发送到服务器之前将其捆绑在一起，要么是消息在调用 recv 之前到达，然后 recv 同时提取所有待处理的字节。所以我想确保我正确理解了 recv 的行为。我想我的理解可能在这里遗漏了一些东西，我希望有人能指出它，谢谢！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-11T22:44:56.313

TCP/IP 是基于流的传输，而不是基于数据报的传输。在流中， 和 之间没有一对一的相关`send()`性`recv()`。这仅适用于数据报。因此，您必须准备好处理多种可能性：

1.  单个调用`send()`可能适合单个 TCP 数据包，并通过单个调用完整读取`recv()`.

2.  一次调用`send()`可能跨越多个 TCP 数据包，需要多次调用`recv()`才能读取所有内容。

3.  多个调用`send()`可能适合单个 TCP 数据包，并通过单个调用完整读取`recv()`.

4.  多次调用`send()`可能跨越多个 TCP 数据包，并且需要`recv()`对每个数据包进行多次调用。

为了说明这一点，请考虑正在发送两条消息 -`send("hello", 5)`和`send("world", 5)`. 以下是调用时的几种可能组合`recv()`：

```
"hello" "world"
"hel" "lo" "world"
"helloworld"
"hel" "lo" "worl" "d"
"he" "llow" "or" "ld" 
```

明白了吗？这就是 TCP/IP 的工作原理。每个 TCP/IP 实现都必须考虑这种碎片。

为了正确接收数据，逻辑消息之间必须有明确的分隔，而不是单独调用，因为发送一条消息`send()`可能需要多次调用，而完整接收一条消息可能需要多次调用。因此，考虑到前面的示例，让我们在消息之间添加一个分隔符：`send()``recv()`

```
send("hello\n", 6);

send("world", 5);
send("\n", 1); 
```

在接收端，您将调用`recv()`尽可能多的次数，直到`\n`收到一个字符，然后您将处理您收到的所有内容，直到该字符。如果完成后还有剩余的读取数据，请将其保存以供以后处理并`recv()`再次开始调用，直到下一个`\n`字符，依此类推。

有时，不可能在消息之间放置唯一字符（可能消息正文允许使用所有字符，因此没有可用作分隔符的不同字符）。在这种情况下，您需要在消息前面加上消息的长度，或者作为前面的整数、结构化标头等。然后您只需`recv()`根据需要多次调用，直到收到完整的整数/标头，然后您调用`recv()`读取与长度/标题指定的字节数一样多的字节。完成后，如果需要，保存任何剩余的数据，然后重新开始调用`recv()`以读取下一个消息长度/标题，依此类推。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-11T21:06:59.070

在单个 recv 调用中返回两条消息绝对是有效的（请参阅[Nagle 算法](http://en.wikipedia.org/wiki/Nagle%27s_algorithm)）。TCP/IP 保证顺序（消息中的字节不会混合）。除了在单个调用中一起返回它们之外，单个消息还可能需要对 recv 进行多次调用（尽管对于像描述的那样小的数据包不太可能）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-11T21:06:59.780

您唯一可以依靠的是字节的顺序。您不能指望它们如何划分为 recv 调用。有时事情会在端点或沿途合并。事情也可能在此过程中被打破，因此独立到达。听起来您的发件人正在交替发送 12 和 915，但您不能指望它。

# android - 显示数据库条目的列表视图中不可见的文本颜色而不是白色

> ID：14286564
> 
> 赞同：1
> 
> 时间：2013-01-11T21:01:47.650
> 
> 标签：android, android-listview, android-viewbinder

我试图更改列表视图中的文本颜色，该列表视图显示我从数据库中的条目。问题是它显示不可见的文本（或者根本不显示任何内容。只有在此列表中分隔我的条目的行）但是在单击条目后它会向我显示此条目的详细信息。在不尝试使用 ViewBinder 的情况下显示效果很好。

```
// map each name to a TextView
    String[] from = new String[] { "event" };
    int[] to = new int[] { R.id.countryTextView };
    conAdapter = new SimpleCursorAdapter(Clock.this, R.layout.day_plan, null, from, to);

    SimpleCursorAdapter.ViewBinder binder = new SimpleCursorAdapter.ViewBinder() {

        @Override
        public boolean setViewValue(View view, Cursor cursor, int columnIndex){    
            int getIndex = cursor.getColumnIndex("colour");
            String empname = cursor.getString(getIndex);
           tv = (TextView)findViewById(R.id.countryTextView);

            tv.setTextColor(Color.WHITE);

           if(empname.equals("Green"))
            {                   
                tv.setTextColor(Color.WHITE);
                return true;
            } 
            return false;          
        }

    };
    setListAdapter(conAdapter); // set adapter
    ((SimpleCursorAdapter) conAdapter).setViewBinder(binder); 
```

我怎样才能将其更改为正常工作？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-26T16:34:48.217

您必须将文本添加到 textview：

```
@Override
public boolean setViewValue(View view, Cursor cursor, int columnIndex) 
{
    ((TextView) view).setTextColor(Colors.RED);
    ((TextView) view).setText(cursor.getString(cursor.getColumnIndex("YOUR-COLUMN-NAME")));
    return false;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-10-26T11:37:39.330

换线

```
tv = (TextView)view.findViewById(R.id.countryTextView); // <-- add 'view.' 
```

称呼

`conAdapter.setViewBinder(SimpleCursorAdapter.ViewBinder`)

```
setListAdapter(conAdapter); // set adapter 
```

# django - 减去 models.DateField 以获取天数

> ID：14286565
> 
> 赞同：0
> 
> 时间：2013-01-11T21:02:00.877
> 
> 标签：django, django-models, django-views

我有一个简单的模型来跟踪工作休假请求：

```
class LeaveRequest(models.Model):
    employee = models.ForeignKey(UserProfile)
    supervisor = models.ForeignKey(UserProfile, related_name='+', blank=False, null=False)
    submit_date = models.DateField(("Date"), default=datetime.date.today)
    leave_type = models.CharField(max_length=64, choices=TYPE_CHOICES)
    start_date = models.DateField(("Date"))
    return_date = models.DateField(("Date"))
    total_days = models.IntegerField()
    notes = models.TextField(max_length=1000)

    def __unicode__ (self):
        return u'%s %s' % (self.employee, self.submit_date)

        class Admin: 
                pass

        class Meta:
                ordering = ['-submit_date'] 
```

在视图中，我需要一个函数来计算请求的天数。其次，我需要一种只计算工作日的方法，但现在我有以下内容：

```
def leave_screen(request, id):
    records = LeaveRequest.objects.filter(employee=id)
    total_days = LeaveRequest.return_date - LeaveRequest.start_date
    tpl = 'vacation/leave_request.html'
    return render_to_response(tpl, {'records': records }) 
```

这会产生属性错误

```
type object 'LeaveRequest' has no attribute 'return_date 
```

有什么建议么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-11T21:05:10.097

在 total_days 中，您调用的是模型，而不是`records`您创建的模型的实例。

如果您只想查看一条休假记录，则需要传递`LeaveRequest`

```
def leave_screen(request, id):
    records = LeaveRequest.objects.get(id=id)
    total_days = records.return_date - records.start_date
    tpl = 'vacation/leave_request.html'
    return render_to_response(tpl, {'records': records }) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-11T21:31:31.593

建议将其用作属性的答案将起作用，但我认为我更喜欢将其保留为字段并在插入时仅计算它。

```
class LeaveRequest(models.Model):
    employee = models.ForeignKey(UserProfile)
    supervisor = models.ForeignKey(UserProfile, related_name='+', blank=False, null=False)
    submit_date = models.DateField(("Date"), default=datetime.date.today)
    leave_type = models.CharField(max_length=64, choices=TYPE_CHOICES)
    start_date = models.DateField(("Date"))
    return_date = models.DateField(("Date"))
    total_days = models.IntegerField()
    notes = models.TextField(max_length=1000)

    def __unicode__ (self):
        return u'%s %s' % (self.employee, self.submit_date)

    def save(self, *args, **kwargs):
        self.total_days = (self.return_date - self.start_date).days
        super(LeaveRequest, self).save(*args, **kwargs)

        class Admin: 
                pass

        class Meta:
                ordering = ['-submit_date'] 
```

这样，当您输入排除周末的逻辑时，您可以节省计算以计算每次列出所有休假请求时的天数。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-11T21:17:59.157

我不会将“total_days”作为 LeaveRequest 类中的字段，而是作为属性。

```
class LeaveRequest(models.Model):
    (other fields)

    @property
    def total_days(self):
        oneday = datetime.timedelta(days=1)
        dt = self.start_date
        total_days = 0
        while(dt <= self.return_date):
            if not dt.isoweekday() in (6, 7):
                total_days += 1
            dt += oneday
        return totaldays

# view function
def leave_screen(request, id):
    # get leave request by id
    leavereq = LeaveRequest.objects.get(id=id)
    return render_to_response("vacation/leave_request.html", {"leavereq": leavereq})

# template code
...
<body>
    {{ leavereq.total_days }}
</body> 
```

# macos - mac os /Library 文件夹存储什么？

> ID：14286571
> 
> 赞同：16
> 
> 时间：2013-01-11T21:02:13.527
> 
> 标签：macos

我是mac osx的新手。令我困惑的一件事是文件夹存储什么`/Library`？`/System/Library`顾名思义，我认为应该是类似`/lib`或`/usr/lib`在Linux中的东西。但是，事实并非如此。在其中，它看起来更类似于应用程序包。并且所有命名都是非常特定于应用程序的，例如`/Library/iChat`. 如果它们是特定于应用程序的，那么为什么要调用它们`Library`？通常命名为 时`Library`，是出于代码或资源共享的目的。

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2013-01-12T04:08:11.787

库文件夹存储设置、资源和支持文件。最多有 6 个“级别”：

*   用户库 ~/Library 存储每个用户的设置等。
*   本地库 /Library 存储计算机范围的设置等。顺便说一句，我将其称为“本地”库，因为在 NextStep 中它是 /Local/Library，但您会看到它的各种其他名称，例如根库，计算机库，...
*   网络库 /Network/Library 将存储网络域中所有计算机共享的设置——如果网络域管理员设置了一个，那么没有人再做
*   系统库 /System/Library 存储 OS X 附带的基本设置、资源等。理论上，您不应该在此处更改任何内容。

沙盒应用无权访问用户的大部分主文件夹。它们主要局限于自己的沙盒“容器”（它本身就在用户库中），因此他们得到了自己的“私有”库：

*   每个应用程序的沙箱库，~/Library/Containers/<application-ID>/Data/Library，它通常包含一些真实的文件夹，如 Preferences 和 Saved Application State，以及指向常规用户库版本的符号链接其他文件夹（例如字体）。
*   应用程序组沙箱库，~/Library/Group Containers/<application-group-ID>/Library，用于存储相关应用程序组（来自同一开发人员）之间的共享首选项、应用程序支持文件、缓存等。

现在，关于各种库文件夹中的文件：它们中的大多数是按类型组织的（例如，有一个 Preferences 文件夹、一个 Caches 文件夹、一个 Application Support 文件夹等），每个应用程序（或系统组件或其他任何东西）都有文件/子文件夹）。某些资源类型可用于许多或所有程序（例如字体、钥匙串、服务），因此那里只有一堆文件。然而，一些程序（主要是 Apple 编写的程序）是，嗯，自负到认为他们需要在库中自己的顶级文件夹，所以他们继续创建一个并在其中存储东西。

至于“图书馆”这个名字，我不会过多解读。它基本上是一个存储程序需要获取的东西的地方，但用户（通常）不需要明确知道。基本上，用户永远不需要双击或使用打开/保存对话框来访问的东西。运行 Mail.app 时，不需要告诉它使用 ~/Library/Preferences/com.apple.mail.plist 中的设置，或 ~/Library/Mail 中缓存的邮箱内容，或状态信息在 ~/Library/Saved Application State/com.apple.mail.savedState。

# javascript - 如何在 Javascript 单页应用程序中处理多个活动？

> ID：14286572
> 
> 赞同：1
> 
> 时间：2013-01-11T21:02:18.940
> 
> 标签：javascript, singlepage, single-page-application

例如，我可能有一个菜单屏幕、一个选项屏幕、一个编辑器屏幕等。以前，我已将它们中的每一个包装到一个类中，并为每个类提供并激活和停用函数。激活函数将显示相关的 dom 元素并开始接受输入。deactivate 函数将隐藏相关的 dom 元素并停止接受输入。因此，如果用户在菜单屏幕中，并单击“设置选项”按钮，我会执行以下操作：

```
this.deactivate() // We're currently in the menu, so the menu object is "this"
options.activate() 
```

有处理这种情况的标准方法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-11T21:11:55.203

有许多框架实现了 JavaScript 中的“[发布/订阅](http://msdn.microsoft.com/en-us/magazine/hh201955.aspx)”模式。Backbone.Events 是我经常使用的一种。这是实现它的一种非常简单的方法。这假设您在项目中同时包含了[主干.js](http://backbonejs.org)和[下划线.js](http://underscorejs.org/)。

```
var Foo = {},
    Bar = {};

_.extend(Foo, Backbone.Events);
_.extend(Bar, Backbone.Events);

Foo.prototype.deactivate = function() {
    // Do stuff 
    this.trigger("Foo_Deactivated");
};

Bar.prototype.activate = function() {
    // Do stuff 
    this.trigger("Bar_Activated");
};

myFoo = new Foo();
myBar = new Bar();

myBar.on("Foo_Deactivate", function() { 
    this.activate(); 
    this.trigger("Bar_Activated"); 
}, this); 
```

希望这能回答你的问题！

# javascript - ExtJS 4.0 饼图根据饼图调整图例大小以防止重叠

> ID：14286573
> 
> 赞同：1
> 
> 时间：2013-01-11T21:02:25.447
> 
> 标签：javascript, extjs

如果剩余空间量会强制页面滚动，是否可以拆分 ExtJS 4.0 饼图的图例？我们目前遇到的是在垂直调整大小（用户启用）时，图例保持相同的大小，因此变得不可读。问题是可以重新绘制图例以使其获得多个列以适应其新尺寸吗？我们不想将饼图放在一个中`iframe`并强制它`iframe`是可滚动的。

[例子](http://try.sencha.com/extjs/4.0.7/examples/charts/pie/viewer.html)

# pug - 用for循环迭代#row-#{i}命名一个类不起作用

> ID：14286574
> 
> 赞同：1
> 
> 时间：2013-01-11T21:02:27.163
> 
> 标签：pug

我正在尝试运行一个 for 循环，该循环将创建一个带有枚举类的 div，为什么这不起作用？

```
rows = 3
cols = 6

- for (var i = 0; i < rows; i++) {
    #row-#{i}
- } 
```

我要回来了

```
<div id="row-"></div><0></0><div id="row-"></div><1></1><div id="row-"></div><2></2> 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-01-11T21:29:21.357

模板：

```
rows = 3
cols = 6

- for (var i = 0; i < rows; i++) {
    div(id='row-'+i)
- } 
```

输出：

```
<div id="row-0"></div>
<div id="row-1"></div>
<div id="row-2"></div> 
```

尽管您说的是“枚举*类*”，但也许您实际上想要：

```
- for (var i = 0; i < rows; i++) {
    div(class='row-'+i)
- } 
```

# r - R中的数据集中缺少行

> ID：14286582
> 
> 赞同：5
> 
> 时间：2013-01-11T21:03:13.017
> 
> 标签：r

我昨天下午和今天早上的大部分时间都在试图深入了解我的问题。如果你能指出我任何很棒的资源！

我在 R 中有一个数据框（从 Oracle 表中导入），请参见下面的数据。我称之为 Loss_Data。

```
 Loss_Yr Dev_Lag Claim_Amnt
1   2007    1   300
2   2007    2   10
3   2007    3   250
4   2007    5   5
5   2008    1   450
6   2008    2   80
7   2008    4   3
8   2009    1   175
9   2009    3   20
10  2010    1   95
11  2010    2   40
12  2011    1   130 
```

但是，我需要让它看起来像下面这样。我需要确保每个可能的 Loss_Yr 和 Dev_Lag 组合都有一行。查看添加的行

```
 Loss_Yr Dev_Lag Claim_Amnt
1   2007    1   300
2   2007    2   10
3   2007    3   250
***4    2007    4   0***
5   2007    5   5
6   2008    1   450
7   2008    2   80
***8    2008    3   0***
9   2008    4   3
10  2009    1   175
***11   2009    2   0***
12  2009    3   20
13  2010    1   95
14  2010    2   40
15  2011    1   130 
```

起初我想我会创建一个包含所有可能组合的“虚拟”表，然后与我现有的合并；保留我的初始表 Loss_Data 中的记录。

但是，我正在尝试构建一个流程，这种方法不会很灵活。

关于如何解决这个问题的任何想法？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-11T21:12:17.210

您描述的方法是正确的想法。也许您使实施过于复杂？

```
d <- read.table(text="Loss_Yr Dev_Lag Claim_Amnt
1   2007    1   300
2   2007    2   10
3   2007    3   250
4   2007    5   5
5   2008    1   450
6   2008    2   80
7   2008    4   3
8   2009    1   175
9   2009    3   20
10  2010    1   95
11  2010    2   40
12  2011    1   130", header=TRUE, row.names=1)

filled <- merge(d, 
                with(d, expand.grid(Loss_Yr=unique(Loss_Yr), Dev_Lag=unique(Dev_Lag))), 
                all=TRUE) 
```

# c++ - 动态链接与静态链接效率

> ID：14286588
> 
> 赞同：1
> 
> 时间：2013-01-11T21:03:57.353
> 
> 标签：c++, dll, static-libraries

我与另一位开发人员发生了争执，我想在这里解决动态链接与静态链接的问题。

理论上：

假设你有一个包含 100 个函数的库，每个函数里面都有大量代码：

```
int A()
int B()
int C()
..
..and so on... 
```

而且您的应用程序只调用或依赖于其中之一。

您可以使用两种方法。

1.  将库构建为动态链接库
2.  将库构建为静态链接库

我的同事声称将静态库链接到我们的应用程序，编译器/链接器**不会将 99 个未使用函数的代码添加**到我们的可执行文件中。我声称它会的。我声称在这种情况下唯一的优点是拥有一个可执行文件并且不必与我们的应用程序一起分发库，但如果我们使用动态链接库方法，它不会有显着的大小差异。

谁是正确的？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-11T21:15:41.227

它可能取决于代码的组织方式以及您使用的编译器标志的组合。

遵循经典的简单模型，链接器将链接库中需要满足符号引用的任何目标文件，因此如果您的 A()、B() 和 C() 分别定义在不同的目标文件中，只有包含您实际使用的符号的目标文件才会链接到程序中（除非它反过来依赖于其他一个或多个，在这种情况下，链接器也会找到满足这些引用的目标文件，递归地，直到它满足所有条件，或者找到一个它不能满足的条件（此时您会收到标准的“未解析的外部 XXX”错误消息）。

最近，大多数编译器可以将函数“打包”到单独的“模块”中，而不必将它们放入单独的源文件中以创建单独的目标文件。细节各不相同，但可以减少（或消除）使每个源文件尽可能小的必要性，以便将最终可执行文件中的内容保持在最低限度。

所以，底线：至少在大多数情况下，他是对的，而你是错的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-11T21:15:39.703

这取决于 ：-）

如果您将每个函数放在其自己的源文件中，或使用[/Gy 编译选项](http://msdn.microsoft.com/en-us/library/xsa71f43%28v=vs.100%29.aspx)，则每个函数将被打包在静态库的单独部分中。

然后链接器将能够根据需要选择它们，并且只包含实际调用的函数。

# jquery-ui - 可排序列表触发器是特定对象

> ID：14286591
> 
> 赞同：0
> 
> 时间：2013-01-11T21:04:11.003
> 
> 标签：jquery-ui, draggable, jquery-ui-sortable

所以我有一个普通的 jQueryUI 可排序列表 IE：http: [//jqueryui.com/sortable/#default](http://jqueryui.com/sortable/#default)

但是，我希望仅在用户单击列表项中的特定对象时触发拖动（或排序）事件。为了这个例子，假设我提供的链接中的箭头会触发拖动事件，但点击文本不会。

建议？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-25T10:37:49.457

您可以使用句柄选项

[http://api.jqueryui.com/sortable/#option-handle](http://api.jqueryui.com/sortable/#option-handle)

# hadoop - 在Hadoop中合并两个SortedMapWritable？

> ID：14286595
> 
> 赞同：0
> 
> 时间：2013-01-11T21:04:24.507
> 
> 标签：hadoop, mapreduce, hashmap

我已经定义了一个名为的类`EquivalenceClsAggValue`，它具有数组的数据字段（称为`aggValues`）。

```
class public class EquivalenceClsAggValue extends Configured implements WritableComparable<EquivalenceClsAggValue>{

public ArrayList<SortedMapWritable> aggValues; 
```

它有一个方法，该方法采用另一个类型的对象`EquivalenceClsAggValue`并将其合并`aggValues`到`aggValues`此类中，如下所示：

```
public void addEquivalenceCls(EquivalenceClsAggValue eq){
    //comment: eq contains only one entry as it comes from the mapper

    if (this.aggValues.size()==0){ //new line
        this.aggValues = eq.aggValues;  
                    return;     
    }

    for(int i=0;i<eq.aggValues.size();i++){

        SortedMapWritable cm = aggValues.get(i); //cm: current map
        SortedMapWritable nm = eq.aggValues.get(i); //nm: new map
        Text nk = (Text) nm.firstKey();//nk: new key

        if(cm.containsKey(nk)){//increment the value
            IntWritable ovTmp = (IntWritable) cm.get(nk);
            int ov = ovTmp.get();
            cm.remove(nk);
            cm.put(nk, new IntWritable(ov+1));
        }
        else{//add new entry
            cm.put(nk, new IntWritable(1));
        }

    }
} 
```

但是这个函数并没有合并两个`aggValues`。有人可以帮我弄清楚吗？这就是我调用此方法的方式：

```
public void reduce(IntWritable keyin,Iterator<EquivalenceClsAggValue> valuein,OutputCollector<IntWritable, EquivalenceClsAggValue> output,Reporter arg3) throws IOException {

        EquivalenceClsAggValue comOutput = valuein.next();//initialize the output with the first input

        while(valuein.hasNext()){
            EquivalenceClsAggValue e = valuein.next();
            comOutput.addEquivalenceCls(e);             
        }           
        output.collect(keyin, comOutput);
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-13T21:43:27.157

看起来你正在犯规对象重用。Hadoop 重用相同的对象，因此每次调用`valuein.next()`实际上返回相同的对象引用，但该对象的内容通过 readFields 方法重新初始化。

尝试如下更改（创建一个新实例以聚合到）：

```
 EquivalenceClsAggValue comOutput = new EquivalenceClsAggValue();

 while(valuein.hasNext()){
   EquivalenceClsAggValue e = valuein.next();
   comOutput.addEquivalenceCls(e);             
 }           
 output.collect(keyin, comOutput); 
```

**编辑**：你可能也需要更新你的聚合方法（要警惕对象重用）：

```
public void addEquivalenceCls(EquivalenceClsAggValue eq){
  //comment: eq contains only one entry as it comes from the mapper

  for(int i=0;i<eq.aggValues.size();i++){

    SortedMapWritable cm = aggValues.get(i); //cm: current map
    SortedMapWritable nm = eq.aggValues.get(i); //nm: new map
    Text nk = (Text) nm.firstKey();//nk: new key

    if(cm.containsKey(nk)){//increment the value
        // you don't need to remove and re-add, just update the IntWritable
        IntWritable ovTmp = (IntWritable) cm.get(nk);
        ovTmp.set(ovTmp.get() + 1);
    }
    else{//add new entry
        // be sure to create a copy of nk when you add in to the map
        cm.put(new Text(nk), new IntWritable(1));
    }
  }
} 
```

# c# - 在 asp.net Web 应用程序上使用 WCF 服务应用程序登录

> ID：14286596
> 
> 赞同：2
> 
> 时间：2013-01-11T21:04:27.230
> 
> 标签：c#, asp.net, sql, login, passwords

我目前正在为一个学校项目开发一个约会网站，并且我目前正在尝试为其创建一个登录功能。我们不应该使用自动注册和登录功能。

我们与数据库的任何联系都应通过 WCF 服务应用程序。我知道如何在不使用 WCF 的情况下实现它，但是我现在需要使用它，并且在搜索后在 Google 上找不到它。

```
 public bool login(string UserName, string PassWord, bool isActive = true) {
      try {
           DALDataContext db = new DALDataContext();
           var qry = from m in db.tblUsers
                      where m.userName == UserName && m.password == PassWord && m.isActive == isActive
                      select m;
            if (qry.Count() > 0) {
                return true;
            } else {
                return false;
            }
        }
        catch (Exception) {
            return false;
        }
    } 
```

我就是这样做的，所以如果我像这样在我的 Web 应用程序中实现它，这应该可以工作：

```
ServiceReference1.Service1Client obj = new ServiceReference1.Service1Client();
protected void btnLoginUser_Click1(object sender, EventArgs e) {
     try {
          string UserName = txtUserName.Text;
          string PassWord = txtPassWord.Text;
          obj.login(UserName, PassWord);

           if (true) {
               Session["me"] = UserName;
               Response.Redirect("~/MyProfile.aspx");
               }
      }
      catch (Exception){

       }
   } 
```

我已经用这个工作了几个小时，这个工作的注册部分......所以我在做一些真正错误的事情。我正在使用 Visual Studio 2010 和 SQL Server 2008 R2。

[解决了]

这就是我解决它的方法

```
protected void btnLoginUser_Click1(object sender, EventArgs e)
    {
        try
        {
            string UserName = txtUserName.Text;
            string PassWord = txtPassWord.Text;
            bool isActive = true;

            if (obj.login(UserName, PassWord, isActive))
            {
                Session["me"] = UserName;
                Response.Redirect("~/MyProfile.aspx");
            }
            else
            {
                lblErr.Text = "fail";
            }
            }

        catch (Exception)
        {

        }

    }
} 
```

}

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-11T21:10:33.450

您忽略了登录方法的返回值：

```
obj.login(UserName, PassWord); // <-- returns true/false.

if (true) // <-- Why?
{ 
    ... 
```

你是不是打算做

```
if (obj.login(UserName, PassWord))
{
     Session["me"] = UserName;
     Response.Redirect("~/MyProfile.aspx");
} ... 
```

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2013-01-11T21:26:23.473

建议按名称从 WCF 服务返回用户，例如：

```
public tblUser login(string UserName); 
```

在客户端，您可以按名称检索用户：

```
var user = obj.login(UserName);
if (user != null && user.password == txtPassWord.Text)
  DoLogin();
else
  ShowError(); 
```

# center - CSS替代中心

> ID：14286597
> 
> 赞同：7
> 
> 时间：2013-01-11T21:04:29.650
> 
> 标签：center, css

`center`人们对这个标签皱眉，但对我来说，它*总是**按照我想要的方式*工作。尽管如此，`center`已被弃用，所以我会努力。

现在我看到很多人建议使用神秘的 CSS `margin: 0 auto;`，但我什至无法让它工作（参见 fiddle [here](http://jsfiddle.net/MgcDU/1269/)）。其他人会去修改`position`or `display`，但这总是会破坏其他东西。

如何使`span`使用 css 居中，使其行为与`center`标签完全相同？

```
<div class="container">
  <span class='btn btn-primary'>Click me!</span>
</div> 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-01-11T21:12:57.790

`Span`是一个内联元素，而`margin: 0 auto`for centering 仅适用于宽度小于 100% 的非内联元素。

一种选择是在容器上设置对齐方式，尽管在这种情况下这可能不是您想要的：

```
div.container { text-align: center } 
```

[http://jsfiddle.net/MgcDU/1270/](http://jsfiddle.net/MgcDU/1270/)

另一个选项是更改显示属性`span`：

```
/* needs some extra specificity here to avoid the display being overwritten */
span.btn.btn-primary { 
  display: table;
  margin: 0 auto;
} 
```

使用`display: table`消除了对特定宽度进行硬编码的需要。它会根据其内容缩小或增长。

[http://jsfiddle.net/MgcDU/1271/](http://jsfiddle.net/MgcDU/1271/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-11T21:11:55.883

您可以进行设置`.container { text-align:center; }`，以使里面的所有内容`div.container`都居中。

一般来说，有两种方法可以使事物居中。

1.  要将内联元素（例如文本、跨度和图像）居中在其父级内，`text-align: center;`请在父级上设置。
2.  要使块级元素（例如标题、div 或段落）居中，它必须首先具有指定的宽度（`width: 50%;`例如）。然后将左右边距设置为自动。您的示例`margin: 0 auto;`说顶部和底部边距应该为 0（这对于居中无关紧要）广告左右边距应该是自动的 - 它们应该彼此相等。

该`<center>`元素实际上只是一个带有`text-align:center;`. 如果你发送`border: solid red 1px;`它，你可以看到它是 100% 宽的，并且里面的所有东西都是居中的。如果您更改`text-align`为向左，则其子项不再居中。示例：http: [//jsfiddle.net/KatieK/MgcDU/1275/](http://jsfiddle.net/KatieK/MgcDU/1275/)。也许你应该只考虑你的`<div class="container">`with`text-align:center; }`相当于`<center>`.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-11T21:13:21.390

你使 span 块级别，给它一个宽度，以便 margin:auto 工作

看到这个[小提琴](http://jsfiddle.net/faeLG/)

```
.center {
         display:block;
         margin:auto auto;
         width:150px; //all rules upto here are important the rest are styling
         border:1px solid black;
         padding:5px;
         text-align:center;
} 
```

更新：为了不指定宽度并在跨度上具有元素的自然宽度，您必须在父级上使用 textalign

看到这个[小提琴](http://jsfiddle.net/faeLG/1/)

```
.container{text-align:center}
.center {
  border:1px solid black;
  padding:5px;
} 
```

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2013-01-11T21:06:57.403

`<span>`是一个内联元素。`<div>`是块元素。这就是为什么它没有居中。

```
<div class="container" style='float:left; width:100%; text-align:center;'>
  <span class='btn btn-primary'>Click me!</span>
</div> 
```

只有将 span 的内容转换为块时，才能使用“inline-block”样式将其居中。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2013-01-11T21:18:44.563

您的父元素需要具有更大的宽度才能让子元素定位在其中。之后的技巧`margin: 0 auto;`是让父子容器`position`和`display`值相互兼容。

```
.container {
  border: 2px dashed;
  width: 100%;}

.btn {
  display: block;
  margin: 0 auto;
  width: 25%;
} 
```

[http://jsfiddle.net/rgY4D/2/](http://jsfiddle.net/rgY4D/2/)

# ruby-on-rails - ruby on rails 应用程序中的外键

> ID：14286599
> 
> 赞同：0
> 
> 时间：2013-01-11T21:04:32.707
> 
> 标签：ruby-on-rails, ruby, database, sqlite

我在 Ruby on Rails 应用程序中有三个模型：

1.  杂志
2.  产品
3.  页

我想使用这个查询：

```
Magazine.find(1).products.first.pages 
```

并获得与适当产品关联的页面，但在页面模型中我不想`product_id`成为我的外键，我想`number_id`成为我的外键。number 是产品表中的一个字段。如何更改外键？因为 rails`product_id`用作页表的外键。tnx 为您提供帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-11T21:19:43.877

API 文档有所有答案。请参阅[#has_many 的选项](http://api.rubyonrails.org/classes/ActiveRecord/Associations/ClassMethods.html#method-i-has_many-label-Options)。您可能希望以这种方式指定关系：

```
class Page < ActiveRecord::Base
  belongs_to :product, foreign_key: "number_id"
end

class Product < ActiveRecord::Base
  has_many :pages
end 
```

从您的问题中我并不完全清楚，但是如果您的产品表的主键不是 :id ，那么您还需要指定 primary_key: "number" 或您的主键是什么。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-11T22:23:23.673

我将为您的模型编写适当的代码。

```
class Magazine < ActiveRecord::Base
  has_many :products
  has_many :pages, :through => :products
end

class Product < ActiveRecord::Base
  set_primary_key "number"
  belongs_to :magazine
  has_many :pages, foreign_key: "product_number"

  def my_pages
    self.pages.find_all { |p| p.magazine_id == self.magazine_id}
  end  
end

class Page < ActiveRecord::Base
end 
```

您可以致电 Magazine.first.products.first.my_pages

它会返回正确的结果。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-11T21:17:50.993

您可以指定要使用的外键，请参见[http://guides.rubyonrails.org/association_basics.html#belongs_to-foreign_key](http://guides.rubyonrails.org/association_basics.html#belongs_to-foreign_key)

# java - Java 日历问题设置下午 12 点

> ID：14286600
> 
> 赞同：6
> 
> 时间：2013-01-11T21:04:33.947
> 
> 标签：java, calendar

我正在创建一个`Calendar`实例（当前时间），然后设置小时分钟和上午/下午

```
Calendar now = Calendar.getInstance();

now.set(Calendar.HOUR,12);
now.set(Calendar.MINUTE,0);
now.set(Calendar.AM_PM,1); 
```

然后，如果我尝试从现在的 Calendar 实例中获取 am/pm，它总是错误地设置为 am 和 1 天前。这似乎只发生在第 12 小时，而没有其他小时。这里有什么问题？我设置它们的顺序是否重要，或者在 12 小时的情况下，我应该使用 24 小时格式来设置“现在”实例吗？是的，我应该提到，这是在 Android 上。

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2013-01-11T21:14:49.767

这是因为一天中的每一半都从零时到 11 小时结束。从数学上讲，没有第 12 小时（即使我们在现实生活中一直使用它）。所以你的意思是在 PM 期间设置为零小时，所以：

```
 now.set(Calendar.HOUR, 0);
    now.set(Calendar.MINUTE,0);
    now.set(Calendar.AM_PM, Calendar.PM); 
```

通过将小时设置为 12，您可以告诉日历（正确或错误，您必须询问 Oracle 工程师）将其设置为下午时段的第 12 小时，这最终是上午时段的零小时第二天。

半天只有 12 个小时，而且这个计数是从零开始的，所以从数学上讲，没有第 12 个小时。它是零。这有点违反直觉，因为我们习惯于说它是 12:30，而不是 0:30。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-07-20T14:13:53.597

对我来说更好的答案是 AndroidDev

[如何在日历中将时间设置为 24 小时格式](https://stackoverflow.com/questions/14980899/how-to-set-time-to-24-hour-format-in-calendar) 他说使用 Calendar.HOUR_OF_DAY 所以它应该是 now.set(Calendar.HOUR_OF_DAY, 0);

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-02-26T03:45:33.353

# ruby-on-rails-3 - Resque 和 Resque_mailer 与 Devise

> ID：14286601
> 
> 赞同：0
> 
> 时间：2013-01-11T21:04:45.003
> 
> 标签：ruby-on-rails-3, devise, resque

我正在使用 resque_mailer gem (https://github.com/zapnap/resque_mailer) 使用 Resque 实现后台电子邮件处理。我能够让它适用于我所有的电子邮件，除了由 Devise 发送的电子邮件。

我经历了一堆 SO 问题和博客文章（例如[http://teeparham.posterous.com/send-devise-emails-with-resque](http://teeparham.posterous.com/send-devise-emails-with-resque)），但找不到让它工作的方法。

让 resque_mailer 与 Devise 一起工作的具体步骤是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2015-10-14T00:42:48.040

我在网上浏览了[tee 的答案](https://stackoverflow.com/questions/8125603/sending-devise-emails-through-resque#comment22592328_8172195)和几个资源，但找不到有效的解决方案。

经过几天阅读 resque-mailer 并设计代码后，一个对我有用的解决方案。感谢 tee 的[要点](https://gist.github.com/teeparham/1375726)，它让我朝着正确的方向前进。

假设您的`app/mailers/application_mailer.rb`外观类似于

```
class ApplicationMailer < ActionMailer::Base
  include Resque::Mailer # This will add a `self.perform` class method, which we will overwrite in DeviseResqueMailer
end 
```

在`config/initializers/devise.rb`

```
Devise.parent_mailer = "ApplicationMailer" 

Devise.setup do |config|
  config.mailer = 'DeviseResqueMailer'
end 
```

在使用设计的资源类中，覆盖`send_devise_notification`发送资源类和id而不是对象的方法，以防止编组

```
# app/models/user.rb
protected    
def send_devise_notification(notification, *args)
  # Based on https://github.com/zapnap/resque_mailer/blob/64d2be9687e320de4295c1bd1b645f42bd547743/lib/resque_mailer.rb#L81
  # Mailer may completely skip Resque::Mailer in certain cases - and will fail as we write custom handle in DeviseResqueMailer assuming mails are handled via resque
  # So in those cases, don't retain original devise_mailer so things work properly
  if ActionMailer::Base.perform_deliveries && Resque::Mailer.excluded_environments.exclude?(Rails.env.to_sym)
    # Originally devise_mailer.send(notification, self, *args).deliver
    # Modified to ensure devise mails are safely sent via resque
    resource_id, resource_class = self.id, self.class.name
    devise_mailer.send(notification, {resource_id: resource_id, resource_class: resource_class}, *args).deliver
  else
    super
  end
end 
```

最后，在 中`app/mailers/devise_resque_mailer.rb`，再次从数据库中获取记录并继续

```
class DeviseResqueMailer < Devise::Mailer

  def self.perform(action, *args)
    # Hack to prevent RuntimeError - Could not find a valid mapping for admin.attributes
    record_hash = args.shift
    record = record_hash["resource_class"].constantize.find(record_hash["resource_id"])
    args.unshift(record)
    super # From resque-mailer
  end
end 
```

我觉得这种方法比使用 devise-async 更好，因为所有邮件都通过相同的代码路径。如果需要，它更容易控制和覆盖。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-11T21:40:31.347

我会看看设计异步。看起来它适合您的用例。[设计异步](https://github.com/mhfs/devise-async)

# xml - 如何从 XSD 模式生成测试 XML 数据文件的集合？

> ID：14286602
> 
> 赞同：4
> 
> 时间：2013-01-11T21:04:47.777
> 
> 标签：xml, testing, xsd, schema

> **可能重复：**
> [如何从其 DTD 或 XSD 生成示例 XML 文档？](https://stackoverflow.com/questions/17106/how-to-generate-sample-xml-documents-from-their-dtd-or-xsd)

给定一个 XSD 模式，是否有一种方法可以从此 XSD 模式生成 XML 文件的集合（所有这些文件都成功地针对该 XSD 模式进行了验证）以用于测试目的？

我们正在创建一系列使用 XML 文件传递​​输入/输出的 Java 6 应用程序。所有 XML 文件都应该成功地针对我们的 XSD 模式之一进行验证。XSD 模式非常复杂，因此手动创建 XML 文件进行测试是禁止的。我们想要一组测试 XML 文件，这些文件将锻炼输入数据的限制（因此只有一个 XML 数据文件是不够的）。理想情况下，最好有一个工具允许测试人员为每个 XML 标签选择几个值（最大值、最小值、零值、负值等），然后该工具将生成使用这些测试人员选择的值的组合的 XML 文件。

该系统正在 Microsoft Windows XP 环境中进行测试，但我们当然可以在不同的环境中生成 XML 测试文件（如果特定工具可以帮助自动执行此操作）。我们希望这种从 XSD 生成 XML 的功能用于测试目的，并且我们在应用程序本身中不需要它，因此可以使用独立的 XML 生成工具（如果存在的话）。

相关问题：似乎我发现甚至尝试此任务的唯一现有工具是 jCAM（主项目站点位于[http://sourceforge.net/projects/camprocessor/；jCAM](http://sourceforge.net/projects/camprocessor/)功能列表和教程可在[https:// www.oasis-open.org/committees/download.php/29661/XSD%20and%20jCAM%20tutorial.pdf](https://www.oasis-open.org/committees/download.php/29661/XSD%20and%20jCAM%20tutorial.pdf)）。除了教程之外，我还没有研究过这个工具。有没有人有这个工具的经验？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-11T21:13:38.923

我有一段时间没有使用它了，但我知道 Altova XmlSpy 曾经这样做过。您可以获得免费下载或试用版（试用期为 30 天）并试一试。

[http://www.altova.com/xml-editor/](http://www.altova.com/xml-editor/)

# matlab - 如何在Matlab的for循环中更改开关环境中绘图的线属性

> ID：14286606
> 
> 赞同：0
> 
> 时间：2013-01-11T21:05:00.690
> 
> 标签：matlab, loops, properties, plot, switch-statement

我在一个 .dat 文件中有来自模拟的数据。根据文件一列（此处为#13）中包含的某些标准（'bu'），我想用不同的标记绘制数据，同时定义标记大小和标记面属性。我所拥有的是针对不同情况的切换环境——定义我想要的标记和属性，所有这些都在一个 for 循环中，以遍历所有模拟数据。

我尝试了以下方法：

```
for i=1:s1(1)

bu = data1(i,13);

switch bu

    case 1
        set(h,'kd','MarkerSize',14,'MarkerFaceColor','k');
    case 2
        set(h,'kd','MarkerSize',14);
    case 3
        set(h,'k>','MarkerSize',14,'MarkerFaceColor','k');
    case 4
        set(h,'ks','MarkerSize',14,'MarkerFaceColor','k');
    case 5
        set(h,'ks','MarkerSize',14);
    case 6
        set(h,'ko','markersize',14);
    case 7
        set(findobj(gca,'k^','MarkerSize',14,'MarkerFaceColor','k'));    
end

figure(1);
h=plot(Re1(i),A1(i)); hold on
end 
```

首先我尝试使用句柄'h'，但它说它是未定义的，我猜是因为 h=plot 稍后出现。然后我在最后一种情况下尝试了 findobj （这是第一次模拟的情况，所以这在第一轮中给出了错误），也没有工作（“不完整的属性值对” - 不知道这里的意思） .

我还尝试将所有这些属性放在一个字符串中，例如

```
str=['kd','MarkerSize',14,'MarkerFaceColor','k'] 
```

然后用

```
h=plot(Re1(i),A1(i),str); hold on 
```

但它也不适用于有/没有括号。

现在我没有任何进一步的想法，感谢任何建议！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-11T21:18:08.393

有几种不同的方法可以做到这一点，其中之一 - 事先创建所有绘图对象，然后用数据和格式填充它们：

```
figureHandle = figure;
for i=1:s1(1)
plotHandle(i) = plot(0,0); %just creating valid handle for future here
end; 
```

*   上面的代码在你的for循环之前用bu开关，然后在你的开关中

设置（ph（i），'kd'，'MarkerSize'，14，'MarkerFaceColor'，'k'，'Xdata'，Re（1），'Ydata'，A1（i））；

使用 str 的方法也可以，除非您需要两个单元格数组 - 选项 nad 值如下：

```
firstoption = 'kd';
option = {'MarkerSize','MarkerFaceColor'};
value = {14,'k'};

h=plot(Re1(i),A1(i),firstoption); 
for i=1:length(option)
set(h,option{i},value{i});
end; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-11T21:19:10.493

我认为对您来说最简单的更改是将绘图选项放在 switch 块的单元格数组中。例如：

```
options = {'kd', 'MarkerSize', 14, 'MarkerFaceColor', 'k'}; 
```

稍后，当您绘制时：

```
plot(x, y, options{:}) 
```

我这样做的另一种方法是设置变量并在绘图命令中使用它们：

```
style = 'kd';
markerSize = 14;
markerFaceColor = 'k';
plot(x, y, style, 'MarkerSize', markerSize, 'MarkerFaceColor', markerFaceColor); 
```

# objective-c - Cocoa 的 KQueue 包装器

> ID：14286609
> 
> 赞同：0
> 
> 时间：2013-01-11T21:05:09.503
> 
> 标签：objective-c, cocoa, wrapper, kqueue

所以我想监控一个文件，据我所知，KQueue 是在 Cocoa 中实现它的方法。我有一个部分运行的 FSEvents 代码正在运行，但它监视整个文件夹。

谁能推荐一个好的 Cocoa 包装器，我可以用它来监控文件何时被更改？最好是按照它接收文件路径的方式，然后在检测到更改时运行一段代码。

任何建议，将不胜感激。

我也很惊讶可可没有内置这样的东西？？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-17T03:58:12.150

我最终选择了 VDKQueue，这是 UKKQueue 的更新版本

# jsf-2 - Primefaces组件不刷新

> ID：14286612
> 
> 赞同：0
> 
> 时间：2013-01-11T21:05:15.263
> 
> 标签：jsf-2, primefaces

我一直在看 Primefaces 3.4.2，因为 IceFaces 3.2.0 有太多问题。我有一个包含在面板中的车辆数据网格。我有一个添加按钮，每个车辆面板都包含一个删除按钮。

添加工作正常；它每次都会添加一个新的车辆面板。问题是当我删除车辆时，面板被删除，但值仍然存在。例如，如果我有 3 辆车，年份分别为 2008、2010、2012，然后我删除了第一辆车，你会认为你会看到剩下的 2 个面板，年份分别是 2010 和 2012。相反，我看到的是 2008和 2012 年。支持 bean 做得正确，如果我手动刷新屏幕，我确实看到了正确的值。现在我已经介绍了我的案例，下面是代码：

```
<p:dataGrid id="vehicleGrid" var="currentVehicle" value="#{vehicleInfoBean.getVehicleList()}" columns="#{vehicleInfoBean.getVehicleList().size()}" styleClass="vehicleInfoPanel" rowIndexVar="rowIdx">
    <p:panel header="VEHICLE ##{rowIdx+1}:" style="width:100%" styleClass="textEntryInputTable">
        <h:panelGrid columns="1" style="width:100%" styleClass="vehicleInfoPanel">
                <ui:include src="../components/vehicleinfo/vehiclecomponents.xhtml">
                    <ui:param name="currentVehicle" value="#{currentVehicle}" />
                    <ui:param name="labelOnly" value="false" />
                </ui:include>
            <div class="deleteButton">
                <p:commandButton value="Remove" label="Delete Vehicle" action="#{vehicleInfoBean.deleteVehicle}" update=":vehicleInfoForm:vehicleGrid" process="@this">
                    <f:setPropertyActionListener value="#{currentVehicle}" target="#{vehicleInfoBean.currentVehicle}" />
                </p:commandButton>
            </div>
        </h:panelGrid>
    </p:panel>
 </p:dataGrid> 
```

有任何想法吗？我尝试了各种更新值，包括@form，但都是一样的。我以前没有使用过 dataGrid，但我需要 ice:panelSeries 具有的迭代功能。

更新：这是包含中的代码：

```
<h:panelGrid columns="2">
    <p:inputText id="vinInput" styleClass="stdFieldControl" value="#{currentVehicle.vin}" label=""
                 required="true" requiredMessage="VIN is required" >
        <p:ajax update="@this vinMsg"/>
    </p:inputText>
    <p:message id="vinMsg" for="vinInput" errorClass="ui-state-error-text"/>
    <p:outputLabel value="-----OR-----"/>
</h:panelGrid> 
```

2013 年 1 月 14 日 - 更新代码

```
<p:dataGrid id="vehicleGrid" var="currentVehicle" value="#{vehicleInfoBean.getVehicleList()}" columns="#{vehicleInfoBean.getVehicleList().size()}" styleClass="vehicleInfoPanel" rowIndexVar="rowIdx">
    <p:panel header="VEHICLE ##{rowIdx+1}:" style="width:100%" styleClass="textEntryInputTable">
        <h:panelGrid columns="1" style="width:100%" styleClass="vehicleInfoPanel">
            <p:inputText id="vinInput" styleClass="stdFieldControl" value="#{currentVehicle.vin}" label="" required="#{empty param['vehicleGrid:0:btnDelete'] and empty param['btnAdd']}" requiredMessage="VIN is required" >
            </p:inputText>
            <p:message id="vinMsg" for="vinInput" errorClass="ui-state-error-text"/>
            <p:outputLabel value="-----OR-----"/>
            <h:inputText id="yearInput" styleClass="stdFieldControl" value="#{currentVehicle.year}" label=""
                                             required="#{empty param['vehicleGrid:0:btnDelete']}" requiredMessage="Year is required">
            </h:inputText>
            <p:message id="yearMsg" for="yearInput"
                                           errorClass="ui-state-error-text"/>
            <div class="deleteButton">
                <p:commandButton id="btnDelete" value="Remove" label="Delete Vehicle" action="#{vehicleInfoBean.deleteVehicle}" update="@form">
                    <f:setPropertyActionListener value="#{currentVehicle}" target="#{vehicleInfoBean.currentVehicle}" />
                </p:commandButton>
            </div>
        </h:panelGrid>
    </p:panel>
</p:dataGrid> 
```

添加代码如下所示：

```
<div class="addButton" style="padding-left: 2.17%; float: left; clear: both">
    <p:commandButton id="btnAdd" value="AddVehicle" label="Add Vehicle" actionListener="#{vehicleInfoBean.addVehicle}" update="vehicleGrid"/>
</div> 
```

我决定设置引用按钮的组件的必需属性，而不是检查按钮。如果我对迭代器索引进行硬编码，则此代码有效。例如，required="#{empty param['vehicleGrid:0:btnDelete']}"。此代码指向 panelGrid 中的第一个删除按钮。我需要动态地导出索引 - required="#{empty param['vehicleGrid: **#{rowIdx}** :btnDelete']}"。添加按钮很简单，因为它不驻留在迭代器中。如何以可以动态引用 panelGrid 的 rowId 的方式对参数进行编码？RowId 看起来令人困惑，但它的编码方式是每个车辆面板都显示在前一个面板旁边。在这种情况下，行可以被认为是一列。有人有想法么？

# extjs4 - 动态更改 Tool 对象的 ToolTip

> ID：14286614
> 
> 赞同：1
> 
> 时间：2013-01-11T21:05:17.260
> 
> 标签：extjs4

有没有办法从放置在面板中的工具更改工具提示文本？我查看了 ToolTip 对象和 QuickTip，但都没有像 setTipText() 这样的函数

谢谢，Y_Y

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2014-07-11T01:16:57.780

我无法将 itemId 放在我的工具提示上，因此我能够以这种方式动态更新工具的工具提示：

```
var toolTip = Ext.get(tool.getEl().id + '-toolEl');
toolTip.set({ 
    'data-qtitle': 'New Tooltip Title', //this line is optional
    'data-qtip': 'Updated Tool Tip!' 
}); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-12T10:12:04.650

对于您的问题，我有两个解决方案！

1.  更改 HTML 属性

    ```
    toolTip=Ext.ComponentQuery.query('tooltip[itemId=myToolTip]')[0];
    toolTip.html = "This is the new text!";
    toolTip.setTitle("new Title");
    toolTip.render(); 
    ```

2.  毁掉旧的，造一个新的……

    ```
    tooltip.destroy();
    var config = {
        target: 'bottomCallout',
        anchor: 'top',
        anchorOffset: 85, // center the anchor on the tooltip
        html: "Fancy new ToolTip with a totally different config..."
    };
    Ext.create('Ext.tip.ToolTip', config); 
    ```

# c++ - 促进正则表达式混淆

> ID：14286620
> 
> 赞同：3
> 
> 时间：2013-01-11T21:05:33.523
> 
> 标签：c++, regex, boost

我花了一天的大部分时间学习正则表达式，试图解析我的程序生成的配置文件。目前，配置文件有点像INI文件，但稍后会扩展。它的结构是这样的

```
> ##~SECTIONNAME~##
> #KEY#value/#
> #KEY#value/#
> #KEY#value/#

> ##~ANOTHERSECTION~##
> #KEY#value/#
> #KEY#value/#
> #KEY#value/# 
```

我想要做的是将部分名称作为字符串返回。我的正则表达式是#{2}~(.*)~#{2}，它在在线 perel 正则表达式测试器上运行良好。但是当我通过 c++ 运行它时，我得到了奇怪的结果。

```
 split_regex(sectionList,file,regex("#{2}~(.*)~#{2}")); 
```

sectionList 是一个临时数据持有者，它将保存部分名称的列表。File 是一个字符串，其中包含加载的配置文件中的所有文本。它目前所做的是给我一个空白的第一个索引。第二个索引包含一个字符串，其中包含 LAST 部分下方的所有内容。

我的最终目标是拥有一个成对的向量，一个包含部分列表的文本，另一个包含另一个向量。第二个向量将保存一个类的实例，该类将保存键和值（或者可能只是另一对）。

有什么好的方法来解决这个问题？我现在了解如何编写正则表达式就好了。但即使在查看了 boost 中正则表达式的文档之后，我仍然不太确定如何使用所说的正则表达式。

感谢您阅读我的问题。我真的很感谢你抽出时间来做这件事。任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-11T21:19:42.500

查看Boost -function的[文档。](http://www.boost.org/doc/libs/1_33_1/doc/html/split_regex.html)`split_regex`提供的正则表达式用作分隔符来分割字符串。

您的正则表达式匹配您想要的部分，但如果您真的想使用`split_regex`它应该匹配您的部分名称*之间的所有内容。*

最新版本的 C++ (C++ 11) 提供了有关正则表达式的[新功能。](http://www.cplusplus.com/reference/regex/)[此特定函数](http://www.cplusplus.com/reference/regex/regex_match/)能够确定字符串是否与给定的正则表达式匹配并返回所有匹配项。查看最后一个链接页面上提供的示例。

# sql - 难以在数据库中插入值

> ID：14286624
> 
> 赞同：1
> 
> 时间：2013-01-11T21:06:00.553
> 
> 标签：sql, database, oracle-xe

我创建了如下所示的表（我使用的是 Oracle XE）。出现的问题是，当我尝试将值插入表中时，出现错误，因为一个外键的值尚未作为另一个主键输入。例如，请参见表 DEPARTMENT 和 EMPLOYEE。下面，连同建表代码，也是数据插入部分。如何绕过这个问题？

```
CREATE TABLE DEPARTMENT
(
DNAME       VARCHAR(10),
DEPTID      INTEGER     NOT NULL,
MNG_IDNO    INTEGER     NOT NULL,
PRIMARY KEY (DEPTID)
);

CREATE TABLE EMPLOYEE
(
IDNO        INTEGER         NOT NULL,
FNAME       VARCHAR(10)     NOT NULL,
LNAME       VARCHAR(10)     NOT NULL,
GENDER      VARCHAR(6)      NOT NULL,
CITY        VARCHAR(20),
AREA        VARCHAR(20),
STREET      VARCHAR(50),
HOUSENO     VARCHAR(4),
ZIPCODE     INTEGER,
BIRTHDAY    DATE,
SALARY      INTEGER,
IBAN        VARCHAR(34),
DEPT_ID     INTEGER         NOT NULL,       
PRIMARY KEY (IDNO)
);

CREATE TABLE CUSTOMER
(
IDNO        INTEGER         NOT NULL,
FNAME       VARCHAR(10)     NOT NULL,
LNAME       VARCHAR(10)     NOT NULL,
GENDER      VARCHAR(6)      NOT NULL,
CITY        VARCHAR(20),
AREA        VARCHAR(20),
STREET      VARCHAR(50),
HOUSENO     VARCHAR(4),
ZIPCODE     INTEGER,
BIRTHDAY    DATE,
PRIMARY KEY (IDNO)
);

CREATE TABLE CAR
(
VIN         INTEGER         NOT NULL,
BRAND       VARCHAR(10)     NOT NULL,
MODEL       VARCHAR(10)     NOT NULL,
COLOR       VARCHAR(10)     NOT NULL,
TRANTYPE    VARCHAR(10)     NOT NULL,
FUELTYPE    VARCHAR(10)     NOT NULL,
ENGCC       INTEGER         NOT NULL,
ENTRYDATE   DATE,
PRICE       INTEGER         NOT NULL,
PAYMENTMETHOD       VARCHAR(10)     NOT NULL,
DEPT_ID     INTEGER         NOT NULL,
CUST_IDNO   INTEGER         NOT NULL,
PRIMARY KEY (VIN)
);

CREATE TABLE CAR_PARTS
(
PARTNUM     VARCHAR(25)     NOT NULL,
PARTNAME    VARCHAR(25)     NOT NULL,
COST        INTEGER         NOT NULL,
PRIMARY KEY (PARTNUM)
);

CREATE TABLE USED_CAR
(
CAR_VIN     INTEGER         NOT NULL,
MILEAGE     INTEGER         NOT NULL,
REGDATE     DATE            NOT NULL,
PRIMARY KEY (CAR_VIN)
);

CREATE TABLE SERVICE
(
DUE_DATE        DATE,
ARR_DATE        DATE,
COST            INTEGER         NOT NULL,
SERVICE_NUM     INTEGER         NOT NULL,
CUST_IDNO       INTEGER         NOT NULL,
PAYMENTMETHOD   VARCHAR(10)     NOT NULL,
CAR_VIN         INTEGER         NOT NULL,
PRIMARY KEY (SERVICE_NUM)
);

CREATE TABLE CUST_PHONUMBER
(
PHONE_NUM       INTEGER         NOT NULL,
CUST_IDNO       INTEGER         NOT NULL,
PHONE_TYPE      VARCHAR(10),
PRIMARY KEY (CUST_IDNO, PHONE_NUM)
);

CREATE TABLE CAR_DEFECTS
(
DEFECTS         VARCHAR(100)    NOT NULL,
CAR_VIN         VARCHAR(100)    NOT NULL,
PRIMARY KEY (DEFECTS, CAR_VIN)
);

CREATE TABLE EMPLOYEE_PHONUMBER
(
PHONENUM        INTEGER         NOT NULL,
EMPL_IDNO       INTEGER         NOT NULL,
PRIMARY KEY (PHONENUM, EMPL_IDNO)
);

CREATE TABLE SERVICE_DETAILS
(
SERVICENUM      INTEGER         NOT NULL,
PROBLEMS        VARCHAR(100)    NOT NULL,
SOLUTION        VARCHAR(100),
PRIMARY KEY (PROBLEMS, SERVICENUM)
);

CREATE TABLE HAS
(
PART_NUM        VARCHAR(25)     NOT NULL,
CAR_VIN         INTEGER         NOT NULL,
PRIMARY KEY (PART_NUM, CAR_VIN)
);

CREATE TABLE USES
(
PART_NUM        VARCHAR(25)     NOT NULL,
SERVICE_NUM     INTEGER         NOT NULL,
PRIMARY KEY (PART_NUM, SERVICE_NUM)
);

ALTER TABLE DEPARTMENT          ADD FOREIGN KEY (MNG_IDNO) REFERENCES EMPLOYEE(IDNO);
ALTER TABLE EMPLOYEE            ADD FOREIGN KEY (DEPT_ID) REFERENCES DEPARTMENT(DEPTID);
ALTER TABLE CAR                 ADD FOREIGN KEY (DEPT_ID) REFERENCES DEPARTMENT(DEPTID);
ALTER TABLE CAR                 ADD FOREIGN KEY (CUST_IDNO) REFERENCES CUSTOMER(IDNO);
ALTER TABLE SERVICE             ADD FOREIGN KEY (CUST_IDNO) REFERENCES CUSTOMER(IDNO);
ALTER TABLE SERVICE             ADD FOREIGN KEY (CAR_VIN)   REFERENCES CAR(VIN);
ALTER TABLE USED_CAR            ADD FOREIGN KEY (CAR_VIN) REFERENCES CAR(VIN);
ALTER TABLE HAS                 ADD FOREIGN KEY (PART_NUM) REFERENCES CAR_PARTS(PARTNUM);
ALTER TABLE HAS                 ADD FOREIGN KEY (CAR_VIN) REFERENCES CAR(VIN);
ALTER TABLE USES                ADD FOREIGN KEY (PART_NUM) REFERENCES CAR_PARTS(PARTNUM);
ALTER TABLE USES                ADD FOREIGN KEY (SERVICE_NUM) REFERENCES SERVICE(SERVICE_NUM);
ALTER TABLE CUSTOMER_PHONUMBER  ADD FOREIGN KEY (CUST_IDNO) REFERENCES CUSTOMER(IDNO);
ALTER TABLE EMPLOYEE_PHONUMBER  ADD FOREIGN KEY (EMPL_IDNO) REFERENCES EMPLOYEE(IDNO);
ALTER TABLE SERVICE_DETAILS     ADD FOREIGN KEY (SERVICENUM) REFERENCES SERVICE(SERVICE_NUM); 
```

数据插入：

```
INSERT INTO EMPLOYEE VALUES (1234,'ANTREAS','GEORGIOU','MALE','NICOSIA','STROVOLOS','PANAYIAS','12',2682,TO_DATE('01.01.1989', 'DD.MM.YYYY'),5000,9999999,1);
INSERT INTO EMPLOYEE VALUES (1235,'KOSTAS', 'KOSTA', 'MALE', 'NICOSIA','STROVOLOS','VIZANTIOU','12',2064,TO_DATE('01.02.1980', 'DD.MM.YYYY'),5000,9999998,2);
INSERT INTO EMPLOYEE VALUES (1236,'MARIA', 'ANTREOU', 'FEMALE', 'NICOSIA','EGKOMI','TSAROU','12',2522,TO_DATE('05.05.1988', 'DD.MM.YYYY'),5000,9999995,3);
INSERT INTO EMPLOYEE VALUES (1237,'GEORGIA', 'ANTREOU', 'FEMALE', 'NICOSIA','EGKOMI','TSAROU','13',2522,TO_DATE('05.05.1978', 'DD.MM.YYYY'),5000,9999996,4);

INSERT INTO DEPARTMENT VALUES ('SERVICE',1,1234);
INSERT INTO DEPARTMENT VALUES ('SALES',2,1235);
INSERT INTO DEPARTMENT VALUES ('ACCOUNTING',3,1236);
INSERT INTO DEPARTMENT VALUES ('MANAGEMENT',4,1237);

INSERT INTO CUSTOMER VALUES (4321, 'ANTREAS', 'ANTREOU','MALE','PAFOS','GEROSKIPOU','VIZANTIOU','3',2525,TO_DATE('04.04.1954','DD.MM.YYYY'));
INSERT INTO CUSTOMER VALUES (4322, 'MARIA', 'ANTREOU','FEMALE','PAFOS','GEROSKIPOU','VIZANTIOU','7',2525,TO_DATE('03.03.1953','DD.MM.YYYY'));
INSERT INTO CUSTOMER VALUES (4323, 'KOSTAS', 'ANTREOU','MALE','PAFOS','GEROSKIPOU','VIZANTIOU','3',2525,TO_DATE('04.04.1970','DD.MM.YYYY'));
INSERT INTO CUSTOMER VALUES (4324, 'ELENA', 'ANTREOU','MALE','PAFOS','GEROSKIPOU','VIZANTIOU','3',2252,TO_DATE('04.04.1985','DD.MM.YYYY'));
INSERT INTO CUSTOMER VALUES (4325, 'MARIOS', 'ANTREOU','MALE','PAFOS','GEROSKIPOU','VIZANTIOU','3',2525,TO_DATE('04.04.1987','DD.MM.YYYY'));

INSERT INTO CAR VALUES (1111111111, 'MAZDA', '3', 'BLUE', 'MANUAL', 'PETROL', 1600, TO_DATE('08.01.2013','DD.MM.YYYY'), 5000, 'CASH', 2, 4321);
INSERT INTO CAR VALUES (2222222222, 'TOYOTA', 'COROLLA','BLACK', 'MANUAL','PETROL',1600,TO_DATE('08.01.2013','DD.MM.YYYY'),7000,'FINANCE',2,4322);
INSERT INTO CAR VALUES (3333333333, 'TOYOTA', 'HILUX', 'GRAY', '4X4', 'DIESEL', 2500, TO_DATE('08.01.2013','DD.MM.YYYY'), 10000, 'CASH', 2 , 4325);
INSERT INTO CAR VALUES (4444444444, 'HONDA', 'CIVIC', 'BLACK', 'MANUAL', 'PETROL', 1300, TO_DATE('08.01.2013','DD.MM.YYYY'), 3000,'CASH', 2, 4323);
INSERT INTO CAR VALUES (5555555555, 'HONDA', 'INSIGHT', 'WHITE', 'AUTO', 'PETROL', 1500, TO_DATE('08.01.2013','DD.MM.YYYY'), 20000, 'FINANCE', 2, 4324);

INSERT INTO CAR_PARTS VALUES ('A20005B', 'RIGHT FRONT AXLE', 200);
INSERT INTO CAR_PARTS VALUES ('C15220C', 'AIR FILTER', 50);
INSERT INTO CAR_PARTS VALUES ('V99T', 'ENGINE GASKET', 80);
INSERT INTO CAR_PARTS VALUES ('A20004B', 'LEFT FRONT AXLE', 200);
INSERT INTO CAR_PARTS VALUES ('U9P002', 'INTAKE MANIFOLD', 300);

INSERT INTO USED_CAR VALUES (4444444444, 25000, TO_DATE('02.02.2000','DD.MM.YYYY'));
INSERT INTO USED_CAR VALUES (5555555555, 122000, TO_DATE('05.08.2003','DD.MM.YYYY'));

INSERT INTO SERVICE VALUES (TO_DATE('12.01.2013','DD.MM.YYYY'), TO_DATE('01.01.2013','DD.MM.YYYY'), 300, 0001, 4321, 'CASH', 1111111111);

INSERT INTO CUST_PHONUMBER VALUES (99123456, 4321, 'MOBILE');
INSERT INTO CUST_PHONUMBER VALUES (99849563, 4322, 'MOBILE');
INSERT INTO CUST_PHONUMBER VALUES (22568988, 4323, 'LANDLINE');
INSERT INTO CUST_PHONUMBER VALUES (25698974, 4324, 'LANDLINE');
INSERT INTO CUST_PHONUMBER VALUES (97584692, 4325, 'MOBILE');

INSERT INTO CAR_DEFECTS VALUES ('BROKEN SIDE MIRRORS|OIL LEAKS', 4444444444);
INSERT INTO CAR_DEFECTS VALUES ('RUSTY PAINT|WORN-OUT CLUTCH', 5555555555);

INSERT INTO EMPLOYEE_PHONUMBER VALUES (97989565, 1234);
INSERT INTO EMPLOYEE_PHONUMBER VALUES (97585858, 1235);
INSERT INTO EMPLOYEE_PHONUMBER VALUES (96525263, 1236);
INSERT INTO EMPLOYEE_PHONUMBER VALUES (97484852, 1237);

INSERT INTO SERVICE_DETAILS VALUES (0001, 'BROKEN FRONT RIGHT AXLE', 'REPLACED FRONT RIGHT AXLE');

INSERT INTO HAS VALUES ('A20005B', 1111111111);
INSERT INTO HAS VALUES ('A20004B', 1111111111);

INSERT INTO USES VALUES ('A20005B', 0001); 
```

# excel - 使用 Aspose Cells 在同一个 Excel 工作表上的多组单选按钮

> ID：14286625
> 
> 赞同：1
> 
> 时间：2013-01-11T21:06:01.143
> 
> 标签：excel, aspose-cells

是否可以使用 Aspose Cells for .NET 将一组以上的单选按钮添加到单个 Excel 工作表？

我试过这样做，但他们似乎都共享同一个组。在 es 中添加单选按钮`GroupBox`似乎没有帮助。我究竟做错了什么？

Aspose 网站上的示例代码只为每个工作表添加了一组单选按钮。甚至可以添加多个组吗？（如果您在 Excel 中手动设置它，它就可以工作。）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-11T21:06:01.143

我花了一段时间才弄清楚问题出在哪里。组中的单选按钮必须**完全位于**组框内（它们可以与框共享边框，但不能游离在外面）。任何未完全由组框界定的单选按钮都将分配给默认组。

默认情况下，单选按钮没有边框或背景，因此仅从生成的 Excel 工作表来看，它们是否完全位于其分组框中并不明显。就我而言，单选按钮与分组框的边框重叠。

一旦我减小了单选按钮的大小，使它们完全包含在分组框中，一切都按预期工作：两组独立的单选按钮。

# vb.net - 以编程方式将 M4A 转换为 MP3

> ID：14286627
> 
> 赞同：0
> 
> 时间：2013-01-11T21:06:04.547
> 
> 标签：vb.net, mp3, m4a

我想创建一个工具，您可以在其中输入大量`.m4a`文件，然后将它们转换为标签`.mp3`并按标签排序`id3`。

排序代码已经完成并且运行良好，但我找不到转换`.m4a`为`.mp3`.

任何人都有一些不错的片段/链接/提示我可以使用？

# django - 获取 DatabaseError，sqlite3 没有这样的表

> ID：14286628
> 
> 赞同：1
> 
> 时间：2013-01-11T21:06:04.400
> 
> 标签：django, sqlite

第一次部署项目。导航到在数据库中修改或创建对象的视图时出现 DatabaseError。我得到的错误是：

> ### /uap_app/coach/request/ 处的数据库错误
> 
> 没有这样的表：uap_app_coachrequest

[在此处](http://dpaste.com/872505/)找到 Traceback ：

建议包括确保`settings.py`反映数据库的完整路径，我已经这样做了。此外，我已经检查并确保所有表都已通过在 sqlite env 中查询而正确创建。最初通过`manage.py sql uap_app`和创建的表`syncdb`

在`settings.py`：

```
DATABASES = {
'default': {
    'ENGINE': 'django.db.backends.sqlite3', # Add 'postgresql_psycopg2', 'mysql', 'sqlite3' or 'oracle'.
    'NAME': '/var/www/cscc/uap_prod_db2.sqlite3', 
```

请让我知道是否还有其他需要添加的内容？

设置：Django1.4、Python2.7、Apache2.2、mod_wsgi、sqlite3、CentOS

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-12T17:42:39.973

知道了！我的机器安装了多个 python 版本，所以我需要确保它指向 python2.7 可执行文件，而不是默认的系统范围安装的 python。

将此行添加到`httpd.conf`：

> `WSGIPythonExecutable \usr\local\bin\python2.7`

从 apache 那里得到一个错误说`Invalid command 'WSGIPythonExecutable'`——显然只用于以前版本的 mod_wsgi 1.x（[根据这篇文章](https://stackoverflow.com/questions/6450459/mod-wsgi-and-multiple-installations-of-python)）

所以然后我尝试将此行添加到`httpd.conf`：

> `WSGIPythonExecutable \usr\local`

瞧！有效！

感谢[unsorted](https://stackoverflow.com/users/146478/unsorted)的额外帮助

# c++ - 有没有办法检测显示器是否插入？

> ID：14286631
> 
> 赞同：11
> 
> 时间：2013-01-11T21:06:21.007
> 
> 标签：c++, windows, winapi, windows-shell, shellexecute

我有一个用 C++ 编写的自定义应用程序，它控制连接到嵌入式系统的监视器上的分辨率和其他设置。有时系统会无头启动并通过 VNC 运行，但可以稍后插入监视器（启动后）。如果发生这种情况，在启用监视器之前，他的监视器不会收到任何视频。我发现调用“displayswitch /clone”可以启动显示器，但我需要知道显示器何时连接。我有一个每 5 秒运行一次并查找监视器的计时器，但我需要一些 API 调用来告诉我监视器是否已连接。

这是一些伪代码来描述我所追求的（定时器每 5 秒到期时执行的操作）。

```
if(If monitor connected) 
{
   ShellExecute("displayswitch.exe /clone);
}else
{
   //Do Nothing
} 
```

我试图`GetSystemMetrics(SM_CMONITORS)`返回监视器的数量，但如果监视器已连接，它会返回 1。还有其他想法吗？

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-17T11:15:06.360

试试下面的代码

```
BOOL IsDisplayConnected(int displayIndex = 0)
{
    DISPLAY_DEVICE device;
    device.cb = sizeof(DISPLAY_DEVICE);
    return EnumDisplayDevices(NULL, displayIndex, &device, 0);
} 
```

`true`如果 Windows 识别具有索引（AKA 标识）的显示设备`0`（这是显示控制面板在内部使用的内容），则会返回。否则，它将返回 false `false`。因此，通过检查第一个可能的索引（我将其标记为默认参数），您可以了解是否连接了*任何*显示设备（或至少由 Windows 识别，这基本上就是您要查找的内容）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2020-11-27T18:26:28.490

即使没有连接真正的监视器，似乎也有某种“默认监视器”。下面的功能对我有用（在英特尔 NUC 和 Surface 5 平板电脑上测试）。

这个想法是获取设备ID并检查它是否包含字符串“default_monitor”。

```
bool hasMonitor()
{
    // Check if we have a monitor
    bool has = false;

    // Iterate over all displays and check if we have a valid one.
    //  If the device ID contains the string default_monitor no monitor is attached.
    DISPLAY_DEVICE dd;
    dd.cb = sizeof(dd);
    int deviceIndex = 0;
    while (EnumDisplayDevices(0, deviceIndex, &dd, 0))
    {
        std::wstring deviceName = dd.DeviceName;
        int monitorIndex = 0;
        while (EnumDisplayDevices(deviceName.c_str(), monitorIndex, &dd, 0))
        {   
            size_t len = _tcslen(dd.DeviceID);
            for (size_t i = 0; i < len; ++i)
                dd.DeviceID[i] = _totlower(dd.DeviceID[i]);

            has = has || (len > 10 && _tcsstr(dd.DeviceID, L"default_monitor") == nullptr);

            ++monitorIndex;
        }
        ++deviceIndex;
    }

    return has;
} 
```

# javascript - 网络移动可靠高度

> ID：14286638
> 
> 赞同：1
> 
> 时间：2013-01-11T21:06:40.270
> 
> 标签：javascript, android, ios, dom, height

有人知道如何使用 JavaScript在**移动设备上获得准确的客户端高度吗？**我需要有可见的高度（除了键盘（如果显示）和地址栏（如果可见）之外的所有页面高度）。我尝试使用 window.innerHieght 和 document.documentElement.clientHeight 但返回的值并不总是可靠的。在 iOS 和 Android 上，**随机**加载页面和显示/隐藏键盘时，即使键盘不可见，高度也是没有键盘的高度。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-08-13T06:23:40.730

似乎您可以从这里得到答案：[如何在移动 Safari for web app 中计算可视区域的高度（即窗口高度减去地址和书签栏）？](https://stackoverflow.com/questions/19039628/how-to-calculate-height-of-viewable-area-i-e-window-height-minus-address-bo)

例如在 ios7 Safari 上：

*   **window.innerHieght**为 529px，即视口高度

*   **screen.availHeight**是 548px 这是 window.innerHeight 加上地址高度

*   **screen.height**为 568px，即 screen.availHeight 加上状态栏

# c# - YAML 用于按时间顺序排列的数据

> ID：14286639
> 
> 赞同：-1
> 
> 时间：2013-01-11T21:06:42.380
> 
> 标签：c#, python, yaml, markdown

我正在考虑使用 YAML 按以下方式存储按时间顺序排列的数据：

```
- entrydate: 5:55 AM 1/1/2013
  title: blog post 1
  tags: [yaml, json]
  description: what have i learned today 1
  location: scottsdale
- entrydate: 5:55 AM 1/2/2013
  title: blog post 2
  tags: [general,software-development]
  description: what have i learned today 2
  location: scottsdale 
```

这个 YAML 文档将由一个 C# 应用程序每天更新，该应用程序收集数据，并在周末/月末，一个 Python 程序计算一些关于博客进度的指标。

[这个问题](https://stackoverflow.com/a/15726/539542)的答案[Is this valid YAML?](https://stackoverflow.com/q/15709/539542) 建议 YAML 支持部分文档的概念，如果按上述格式格式化，则每个博客条目都将被视为一个单独的实体。现在我担心两件事。

1.  YAML 解析器是否能够识别每个实体（或博客条目，在这种情况下），`entrydate`因为它位于每个元素的顶部？我问这个是因为在[yamlint](http://yamllint.com)和[在线 yaml 解析器](http://yaml-online-parser.appspot.com/)中，解析的输出都被重新排序，并且`entrydate`与其他项目混为一谈。
2.  YAML 对这项任务来说是不是完全矫枉过正？我觉得这很贴切，因为存储的数据将是人类可读的格式，如果需要，我可以轻松地手动编辑文档。

PS：我为此考虑了 JSON，但我觉得 YAML 太容易看了。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-11T21:24:06.470

> YAML 解析器是否能够通过 entrydate 来识别每个实体（或博客条目，在这种情况下），因为它位于每个元素的顶部？我问这个是因为在 yamlint 和在线 yaml 解析器中，解析的输出被重新排序，并且 entrydate 与其他项目混为一谈。

我不完全清楚你在这里问什么。这是有效的 YAML，它会生成一个字典列表。每个字典都有几个键（描述、条目日期、位置、标签、标题）。使用 YAML 解析器读取数据后，您可以引用任何这些键；哪个出现在输出中的“第一个”通常并不重要。通常，字典实现不保留添加键的顺序。

*列表*的顺序将被保留，因此带有`entrydate`=的条目`5:55 AM 1/1/2013`将始终是列表中的第一个（只要它是文件中的第一个条目）。

> YAML 对这项任务来说是不是完全矫枉过正？我觉得这很贴切，因为存储的数据将是人类可读的格式，如果需要，我可以轻松地手动编辑文档。

您正在尝试以简单易读的格式存储结构化数据。这就是 YAML 的用途。

# javascript - 缩短 Twitter 按钮关注者数量

> ID：14286642
> 
> 赞同：1
> 
> 时间：2013-01-11T21:06:53.787
> 
> 标签：javascript, wordpress, twitter

我在我正在设计的网站上使用 Twitter 按钮，在“关注”按钮旁边，它显示了用户拥有的关注者数量。我的问题是它显示的追随者号码的长度是 5,902，而不是 5.9k。有没有办法用 Twitter API 做到这一点？

提前致谢。

# ruby-on-rails - 了解 Gemfile (Rails)：如果已经包含“gem 'mongo'”，则不需要“require mongo”？

> ID：14286644
> 
> 赞同：0
> 
> 时间：2013-01-11T21:06:57.507
> 
> 标签：ruby-on-rails, ruby-on-rails-3, mongodb, gem, gemfile

这是我们的 Gemfile。

**由于gem 'mongo'**已经包含在内，该行是否**需要 mongo**多余？

 **如果不是，**require mongo**的目的是什么？

我们在 Rails 3 上。

谢谢！

```
source 'http://rubygems.org'

require 'rubygems'
require 'mongo'

gem 'rails', '3.0.6'
gem 'mongo'
gem 'mongo_mapper'
gem 'fastercsv'

# Bundle edge Rails instead:
# gem 'rails', :git => 'git://github.com/rails/rails.git'

#gem 'sqlite3'
gem 'mysql'
gem 'whois' 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-11T21:27:16.020

您不应该`require`在 Gemfile 中添加语句。`require 'rubygems'`对于之前的上线也是如此。

require 所做的就是它一直在做的事情：加载 gem。Gemfile 在您运行时加载`bundle install`。如果您在运行之前尝试加载 gem `bundle install`，则可能尚未安装 gem。

顺便说一下，R​​ails 默认也需要在 Gemfile 中指定的 Gem。**

# java - 尝试使用来自 Java (JNA) 的 DLL。无法加载库异常

> ID：14286647
> 
> 赞同：12
> 
> 时间：2013-01-11T21:07:01.077
> 
> 标签：java, dll, jna

我有[教程](http://blog.mwrobel.eu/how-to-call-dll-methods-from-java/) 中的 NetBeans 项目导致异常：

线程“main” `java.lang.UnsatisfiedLinkError: Unable to load library` “simpleDLL”中的异常：找不到指定的模块。

试图将 simpleDLL.dll 放入项目库中，将文件复制到 system32 文件夹中，但没有成功。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-01-12T00:01:56.747

我在加载 DLL 时遇到了完全相同的问题，我以这种方式解决了它：

*   正如 Christian Kuetbach 所说，检查您使用的 simpleDLL 是否与您的处理器架构兼容，32 位 DLL 无法在 64 位机器上运行，64 位 DLL 也无法在 32-位机。

*   如果 DLL 是兼容的，那么问题可能出在您的 java 库路径中。我将我的 DLL 放入`user.dir`目录中，然后使用以下代码：

    将 Java 库路径设置为`user.dir`或您想要的另一个路径：

    ```
     String myLibraryPath = System.getProperty("user.dir");//or another absolute or relative path

     System.setProperty("java.library.path", myLibraryPath); 
    ```

    加载库：

    ```
     System.loadLibrary("libraryWithoutDLLExtension"); 
    ```

它对我有用，试一试并告诉我它是否对你有用。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-01-11T22:51:00.090

请检查 simpleDLL 是 32 位还是 64 位。然后检查 JVM 是 32 位还是 64 位。它们必须用于同一个平台。

您也可以指定绝对路径，如果您更改`loadLibrary()`为`load()`： http: [//www.chilkatsoft.com/p/p_499.asp](http://www.chilkatsoft.com/p/p_499.asp)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2014-09-25T20:49:48.010

我只能在 32 位 (Xp) 中运行。

将 DLL 放在文件夹“c:\Windows\System32”中

> helloWorldDLL lib = (helloWorldDLL) Native.loadLibrary("helloworldDLL", helloWorldDLL.class);

如果错误 java.lang.UnsatisfiedLinkError: Unable to load library" 仍然存在，请使用 Dependency Walker 查看依赖的 DLL。

[依赖步行者](http://www.dependencywalker.com/)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2018-12-04T01:18:48.973

如果 dll 文件未损坏，则此问题的三个可能原因：

1.  32 位 64 位兼容性。32 位 dll 只能在 32 位 jdk 或 jre 上运行。通过使用 Cygwin 命令`file <filename>`，我们可以判断 dll 是 32 位还是 64 位。

2.  dll 没有放在正确的路径中，因此 java 无法找到它。一般来说，我们可以使用一些绝对路径，而不是`System32`确保路径是正确的。

3.  我们正在加载的 dll 需要其他 dll。

我们如何处理第三种可能性：

1.  `System.loadLibrary()`与 JNA 相比，使用 JNI 的方法可以给我更多的提示。它可能会这样说：这意味着缺少`Exception in thread "main" java.lang.UnsatisfiedLinkError: MyLibrary.dll: Can't find dependent libraries.` 某些库依赖。`MyLibrary.dll`通过使用[依赖遍历器](http://www.dependencywalker.com/) ，我们可以知道需要哪些 dll。

2.  通过在我们要加载的dll之前加载这些dll，我们可以解决这个问题。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2019-04-23T17:41:27.413

有同样的问题，出于某种原因，即使 dll 文件名有大写字母，您也必须使用所有小写字母来加载它，如下所示： `Native.loadLibrary("dlls/library.dll", YourInterface.class)`

**不是**这个：`Native.loadLibrary("dlls/Library.dll", YourInterface.class)`

# bash - 通过 JSP 页面将值作为 bash 文件参数传递

> ID：14286648
> 
> 赞同：1
> 
> 时间：2013-01-11T21:07:06.267
> 
> 标签：bash, jsp, cmd, argument-passing

我正在为从文本输入读取并将变量值作为参数传递给 bash 文件的 JSP 页面编写此代码，但似乎 bash 文件不接受变量，它仅在我传递实际值时才有效的变量。如何将变量传递给这个 bash 文件？这是代码：

```
<%
   String myArgument = ""; 

   if (request.getParameter("submit")==null)
   {
%>
<form method="POST" action="/tomcat/webapps/project/jsp/runCMD.jsp" id=form2>   
         <input type=text id=first value="${first}"  Title="IP adress here" >

      <input type="submit" value="Submit Changes" name="submit"   

      onClick="if(runOnSubmit()){getSomethingWithAjax('ChangeIP.jsp'+
      getAllFormElementsAndMakeIntoURI(true),'',
      'hereIsTheMainHeaderSpan',false,false);}">
 <%
 }//end if
 //else if submitted
 else {
 request.setAttribute("myArgument", myArgument);

       try {
     Process p = Runtime.getRuntime().exec("/root/script.cmd myArgument );
     p.waitFor();
     System.out.println("Waiting for the System to reboot" + p.exitValue());

} catch (Exception e) {
    System.out.println(e.getMessage());
            out.println("There was an error while submitting ");
} 

 }//end else

 %> 
```

请注意，当将值传递给脚本时，它会使用以下代码执行：

```
Process p = Runtime.getRuntime().exec("/root/changeip.cmd 10.0.100.18"); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-12T00:23:37.477

你想要的是：

```
Process p = Runtime.getRuntime().exec("/root/script.cmd " + myArgument ); 
```

**PS实际上，在声明***myArgument*之后
，我看不到您在哪里为它赋值： *`String myArgument = "";`*

 ** * *

**不是**很相关，但你正在做一种 PHP 风格。阅读：[https ://stackoverflow.com/a/3180202/814702](https://stackoverflow.com/a/3180202/814702)*

# php - PHP 连接，字符串长度 = 0

> ID：14286651
> 
> 赞同：0
> 
> 时间：2013-01-11T21:07:21.613
> 
> 标签：php, concatenation

我的 PHP 文件中有以下代码 - 初始化 $uploaded_files 变量，然后调用 getDirectory（也在下面列出）。

现在，如果我执行 vardump($uploaded_files) 我会看到变量的内容，但由于某种原因，当我调用`<?php echo $uploaded_files; ?>`我的 HTML 文件时，我会收到一条消息，指出“未找到文件”——我做错了什么吗？

有人可以帮忙吗？谢谢你。

```
/** LIST UPLOADED FILES **/
$uploaded_files = "";

getDirectory( Settings::$uploadFolder );

// Check if the uploaded_files variable is empty
if(strlen($uploaded_files) == 0)
{
    $uploaded_files = "<li><em>No files found</em></li>";
} 
```

**获取目录功能：**

```
function getDirectory( $path = '.', $level = 0 )
{ 
    // Directories to ignore when listing output. Many hosts 
    // will deny PHP access to the cgi-bin. 
    $ignore = array( 'cgi-bin', '.', '..' ); 

    // Open the directory to the handle $dh 
    $dh = @opendir( $path ); 

    // Loop through the directory 
    while( false !== ( $file = readdir( $dh ) ) ){ 

        // Check that this file is not to be ignored 
        if( !in_array( $file, $ignore ) ){ 

            // Its a directory, so we need to keep reading down... 
            if( is_dir( "$path/$file" ) ){ 

                // We are now inside a directory
                // Re-call this same function but on a new directory. 
                // this is what makes function recursive. 

      getDirectory( "$path/$file", ($level+1) );   
        } 

        else { 
            // Just print out the filename 
            // echo "$file<br />"; 
            $singleSlashPath = str_replace("uploads//", "uploads/", $path);

            if ($path == "uploads/") {
                $filename = "$path$file";
            }
            else $filename = "$singleSlashPath/$file";

            $parts = explode("_", $file);
            $size = formatBytes(filesize($filename));
            $added = date("m/d/Y", $parts[0]);
            $origName = $parts[1];
            $filetype = getFileType(substr($file, strlen($file) - 4));
            $uploaded_files .= "<li class=\"$filetype\"><a href=\"$filename\">$origName</a> $size - $added</li>\n";
            // var_dump($uploaded_files);
        } 
    } 
} 

// Close the directory handle
closedir( $dh ); 
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-11T21:11:02.110

您要么需要添加：

```
global $uploaded_files; 
```

在 getDirectory 函数的顶部，或

```
function getDirectory( &$uploaded_files, $path = '.', $level = 0 ) 
```

通过引用传递它。

您还可以将 $uploaded_files 设为 getDirectory 的返回值。

更多关于全局和安全的阅读：http: [//php.net/manual/en/security.globals.php](http://php.net/manual/en/security.globals.php)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-11T21:13:29.750

PHP 对范围一无所知。

当您从函数体内声明变量时，它将在所述函数的范围之外不可用。

例如：

```
function add(){
    $var = 'test';
}

var_dump($var); // undefined variable $var 
```

这正是您在尝试访问变量时遇到的问题`$uploaded_files`。

# java - 可运行/线程可能的误解

> ID：14286652
> 
> 赞同：0
> 
> 时间：2013-01-11T21:07:25.997
> 
> 标签：java, concurrency

不确定我是否正确理解线程，有人可以告诉我在以下示例中我是对还是错：

```
class Task {
String taskName;
private Thread thread;
boolean isFinished;

public Task(String name){
    taskName = name;
}

public void createTask(final Runnable r) {
    thread = new Thread(r){
        public void run(){
            if(r != null) {
                r.run();
                isFinished = true;
            }
        }
    };
    thread.start();
}
} 
```

我在我的应用程序中实际做的是我将 设置`isFinished`为`true`，并有一个观察者，只要它`isFinished`为真，就会做一些事情。恐怕在我作为参数传递`isFinished`的所有代码实际终止之前设置为true 。`Runnable`

运行方法不是假设将我传递的代码放在单独的线程中并异步运行该代码吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-11T21:16:25.767

关闭，但您的新线程已经被赋予了要执行的可运行对象。你真的想给它一个运行 r.run() 方法然后设置 isFinished 的包装器。

改变：

```
public void createTask(final Runnable r) {
    thread = new Thread(r){
        public void run(){
            if(r != null) {
                r.run();
                isFinished = true;
            }
        }
    };
    thread.start();
} 
```

至

```
public void createTask(final Runnable r) {
    thread = new Thread( new Runnable {
        public void run(){
            if(r != null) {
                r.run();
                isFinished = true;
            }
        }
    });
    thread.start();
} 
```

如果我没有指出 isFinished 的线程不安全性，那我就失职了。如果不添加同步，您将无法保证在线程完成时注意到。我建议您添加：

```
public synchronized boolean getIsFinished()
{
    return isFinished;
}

public synchronized void setIsFinished(boolean finished)
{
    isFinished = finished;
} 
```

并使用这些方法来获取或设置 isFinished 标志。鉴于您在这里缺乏同步，您可能会看到其他线程安全异常，这取决于您的 r.run() 方法和您的其他“观察者”是否也在没有同步的情况下共享数据。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-11T21:17:17.563

您几乎不应该将 a 传递给 a`Runnable`的构造函数`Thread` *并*覆盖 Thread 的`run()`方法。

以下两段代码本质上是相同的：

```
Runnable r = new Runnable( )
{
    public void run( )
    {
        // do stuff...
    }
};

new Thread( r ).start( ); 
```

这是通过覆盖来完成同样事情的另一种方法`run()`：

```
(new Thread( )
{
    public void run( )
    {
        // do stuff...
    }
}).start( ); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-11T21:16:16.880

好吧，您的代码部分正确，部分错误。

您是正确的，`isFinished`只有在您传入参数的可运行对象中的所有内容都完成执行后，才会设置为 true。

但是，由于 java 内存模型的特殊语义（我将在下面详细介绍），当您设置`isFinished`为 true 时，该更改可能仅对已将该变量设置为 true 的线程可见. 如果您希望代码按预期工作，则需要声明`isFinished`为 volatile。这将使您对该变量所做的任何更改立即被其他线程看到。

另一种方法是声明`isFinished`为 AtomicBoolean 而不是布尔值。这个类有很多方法可以让你以原子的方式检查和设置布尔值，帮助你避免许多常见的多线程陷阱。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-11T21:16:44.503

您编写代码的方式在完成`isFinished`之前不会设置为 true `r.run()`。它可能会以其他方式出现，因为由于缺少同步或缺少易失性声明，您可能会遇到一些数据可见性问题。

这有点奇怪，因为您都将 Runnable 传递给构造函数，但是使用方法声明中的引用而不是线程内部的引用来调用它。但它“有效”，那里只是冗余。

顺便说一句，不要忘记`@Override`在您的匿名课程中:)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-01-11T21:15:54.307

不，run 方法只是一个普通函数，您可以在扩展 Thread 类时重写它以实现您自己的行为。

它是 Thread 类的 start 方法，它启动一个新线程并异步运行该代码。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-01-11T21:26:18.827

我建议您使用专门为您的问题设计的同步原语。

这个原语称为[CountDownLatch](http://docs.oracle.com/javase/6/docs/api/java/util/concurrent/CountDownLatch.html)。

这是更新的代码：

```
class Task {

  String taskName;
  private Thread thread;
  CountDownLatch finishedSignal = new CountDownLatch( 1 );

  public Task(String name){
    taskName = name;
  }

  public void createTask(final Runnable r) {
    thread = new Thread(r){
        public void run(){
            if(r != null) {
                r.run();
                finishedSignal.countDown( );
            }
        }
    };
    thread.start();

    finishedSignal.await( );
  }
} 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-01-11T21:30:07.330

您应该使用[FutureTask](http://docs.oracle.com/javase/6/docs/api/java/util/concurrent/FutureTask.html)而不是您自己的 Task 类。它有一个 isDone() 方法，并且很好地与 Executor 框架集成。

最重要的是，[happens-before](http://docs.oracle.com/javase/6/docs/api/java/util/concurrent/package-summary.html#MemoryVisibility)关系按照您的预期维护（实际上在您的代码中，问题不在于 isFinished 设置为 true，在 Runnable 中的所有代码终止之前，而是另一种方式：它可能不会设置为即使 Runnable 被终止，在原始线程中为 true）

例子：

```
Runnable runnable = new Runnable() {
    @Override
    public void run() {
        try {
            Thread.sleep(3000);
        } catch (InterruptedException e) {
            e.printStackTrace();
        }
        System.out.println("work done");
    }
};

FutureTask<Void> task = new FutureTask<Void>(runnable, null);
ExecutorService es = Executors.newSingleThreadExecutor();
es.submit (task);

while (!task.isDone()) {
    System.out.println("waiting...");
    try {
        Thread.sleep(500);
    } catch (InterruptedException e) {
        e.printStackTrace();
    }
} 
```

# javascript - 如何对对象的JS对象进行排序？

> ID：14286654
> 
> 赞同：8
> 
> 时间：2013-01-11T21:07:52.883
> 
> 标签：javascript, json, sorting, jsobject

我在 PHP 中构建了一个对象，使用 JSON_encode 函数并通过 ajax 将其作为 JSON 字符串发送到我的 JS 脚本。然后我将它转换回一个对象。我遇到的问题是我想按照最初创建对象的顺序保留对象。请看这张图片，一旦我将它放入 JS 中，对象的样子：

![在此处输入图像描述](../Images/d6b60d8b299a354948dd575265e95c90.png)

当我创建对象时，它按客户字段的字母顺序排序。以 A 开头的客户名称将排在第一位，B 排在第二位，依此类推。正如您所见，现在，对象的第一个元素为以 S 开头的客户。看起来它以某种方式自动按顶层的键排序对象，它是一个整数，所以我明白为什么会这样。

所以我想做的是重新排序这个对象，以便所有子对象按字母顺序按`customer`字段排序。这可能吗？如果是这样，我该怎么做？

谢谢！

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2015-04-07T12:55:37.767

我已经更改了[Fabricio Matée 的](https://stackoverflow.com/users/1331430/fabr%C3%ADcio-matt%C3%A9)答案以变得更加灵活并返回已排序的对象。

```
function alphabetical_sort_object_of_objects(data, attr) {
    var arr = [];
    for (var prop in data) {
        if (data.hasOwnProperty(prop)) {
            var obj = {};
            obj[prop] = data[prop];
            obj.tempSortName = data[prop][attr].toLowerCase();
            arr.push(obj);
        }
    }

    arr.sort(function(a, b) {
        var at = a.tempSortName,
            bt = b.tempSortName;
        return at > bt ? 1 : ( at < bt ? -1 : 0 );
    });

    var result = [];
    for (var i=0, l=arr.length; i<l; i++) {
        var obj = arr[i];
        delete obj.tempSortName;
        for (var prop in obj) {
            if (obj.hasOwnProperty(prop)) {
                var id = prop;
            }
        }
        var item = obj[id];
        result.push(item);
    }
    return result;
} 
```

然后像这样调用函数

```
your_object = alphabetical_sort_object_of_objects(your_object, 'attribute_to_sort'); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-11T21:21:18.280

这可能是 JavaScript 对象和 JavaScript 数组之间的区别。对象更像哈希表，其中的键不按任何特定顺序排序，而数组是值的线性集合。

在你的后端，确保你编码的是一个数组，而不是一个对象。检查最终编码的 JSON，如果您的对象集合被 {} 而不是 [] 包围，则它被编码为对象而不是数组。

您可能会遇到问题，因为看起来您正在尝试通过 ID 号访问对象，而这是您希望这些对象在最终数组中占据的索引，这会带来另一个问题，因为您可能不希望当您只存储少量值时，一个包含 40,000 个条目的数组。

如果您只想遍历对象，则应确保编码的是数组而不是对象。如果您想通过特定 ID 访问对象，您可能必须在客户端对对象进行排序（即从 JSON 响应中获取对象，然后创建另一个数组并将这些对象排序到其中，这样您就可以拥有已排序的对象，仍然可以通过 id 访问它们）。

您可以通过 Google 轻松找到有效的排序算法（或使用下面来自 ELCas 的算法）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-11T21:33:35.117

`customer`这是一个通用迭代函数，它将所有对象推入一个数组，并以不区分大小写的方式按其属性对它们进行排序，然后遍历排序后的数组：

```
function iterate(data) {
  var arr = [];
  for (var prop in data) {
    if (data.hasOwnProperty(prop)) {
      var obj = {};
      obj[prop] = data[prop];
      obj.tempSortName = data[prop].customer.toLowerCase();
      arr.push(obj);
    }
  }
  arr.sort(function(a, b) {
    var at = a.tempSortName,
        bt = b.tempSortName;
    return at > bt ? 1 : ( at < bt ? -1 : 0 );
  });

  for (var i = 0, l = arr.length; i < l; i++) {
    var obj = arr[i];
    delete obj.tempSortName;
    console.log(obj);
    for (var prop in obj) {
      if (obj.hasOwnProperty(prop)) {
        var id = prop; //gets the obj "index" (id?)
      }
    }
    console.log(id);
    var item = obj[id];
    console.log(item.customer);
    //do stuff with item
  }
} 
```

[**小提琴**](http://jsfiddle.net/fAaBC/1/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2020-04-15T12:57:44.680

```
sortObject(object){
    if(typeof object === 'object'){
        if(object instanceof Date){
            return object;
        }
        if(object instanceof Array){
            return object.map(element => this.sortObject(element));
        } else {
            return Object.keys(object).sort().reduce((result, key) => {
                if(object[key] && object[key] !== null) {
                    result[key] = this.sortObject(object[key]);
                }
                return result;
            }, {});
        }
    }
    return object;
} 
```

* * *

## 回答 #5

> 赞同：-3
> 
> 时间：2013-01-11T21:19:57.490

只需循环浏览您的数据并对其进行排序。我没有使用最有效的分拣机，但想法就在那里。

```
var data = toArray(AJAX_Returned_JSON); // function to convert object to array
var sortedData = null;

for(var i=0; i<data.length - 1; i++){
  var temp = data[i];
  for(var j=i+1; j<data.length; j++){
    if(data[j].customer < temp.customer){
      temp = data[j];
    }
  }

  sortedData.push(temp);
} 
```

# sql - 具有附加列的不同用户/日期的 SQL 查询

> ID：14286656
> 
> 赞同：3
> 
> 时间：2013-01-11T21:08:07.550
> 
> 标签：sql, distinct

我有一个与代理的会话表、会话的开始时间以及他们帮助了多少人。我想查询查看每个代理/日期组合的总数，结合当天的所有会话。例如，我有：

```
Agent 1 - 1/8/13 11:30am - 8
Agent 2 - 1/8/13 11:32am - 9
Agent 1 - 1/8/13 12:45pm - 10
Agent 2 - 1/9/13 10:20am - 8
Agent 3 - 1/9/13 11:45am - 7 
```

我想看到的是：

```
1/8/13 - Agent 1 - 18
1/8/13 - Agent 2 - 9
1/9/13 - Agent 2 - 8
1/9/13 - Agent 3 - 7 
```

我尝试的是：

```
SELECT DISTINCT CONVERT(CHAR(10), StartTime, 101) as 'Day',
       Agent,
       Helped
FROM Sessions 
```

但我现在明白 DISTINCT 将为所有选定的列返回唯一结果，所以我只会看到原始数据，而不是按天组合。对此的任何帮助将不胜感激，谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-11T21:11:12.660

你在这里想要的是按天分组的[聚合`SUM()`](http://msdn.microsoft.com/en-us/library/ms173454.aspx)`Agent`。

```
SELECT CONVERT(CHAR(10), StartTime, 101) as 'Day',
       Agent,
       SUM(Helped) AS Helped
FROM Sessions
GROUP BY CONVERT(CHAR(10), StartTime, 101),
         Agent 
```

我不记得 SQL Server 是否允许您`Day`在`GROUP BY`. 如果是这样，你可以做

```
SELECT CONVERT(CHAR(10), StartTime, 101) as 'Day',
       Agent,
       SUM(Helped) AS Helped
FROM Sessions
GROUP BY Day, Agent, 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-11T21:15:30.267

您需要`GROUP BY`StartTime 和 Agent 以及`SUM`帮助：

```
declare @Sessions table
(
    StartTime datetime,
    Agent varchar(50),
    Helped int
)

insert into @Sessions (Agent, StartTime, Helped)
select 'Agent 1', '1/8/13 11:30am', 8
union select 'Agent 2', '1/8/13 11:32am', 9
union select 'Agent 1', '1/8/13 12:45pm', 10
union select 'Agent 2', '1/9/13 10:20am', 8
union select 'Agent 3', '1/9/13 11:45am', 7

select
    convert(varchar(10), StartTime, 101) as [Day],
    Agent,
    sum(Helped)
from
    @sessions
group by
    convert(varchar(10), StartTime, 101),
    Agent 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-11T21:20:28.430

我想知道它是否太简单了......但似乎是你需要的答案..

*   [SQLFIDDLE 演示](http://sqlfiddle.com/#!3/613af/15)

询问：

```
SELECT date as times,
       id,
       sum(items)
FROM agents
group by id, date
; 
```

结果：

```
|      TIMES |      ID | COLUMN_2 |
-----------------------------------
| 2013-01-08 | Agent 1 |       18 |
| 2013-01-08 | Agent 2 |        9 |
| 2013-01-09 | Agent 2 |        8 |
| 2013-01-09 | Agent 3 |        7 | 
```

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2013-01-11T21:11:40.027

我相信您会想要探索“分组依据”命令 - 如下所示：

```
SELECT CONVERT(CHAR(10), StartTime, 101) as 'Day',
   Agent,
   Helped
FROM Sessions GROUP BY (Agent) order by Agent asc 
```

# excel - 无法在 Access/VBA 应用程序中正确保存和关闭 XLS 文件

> ID：14286658
> 
> 赞同：2
> 
> 时间：2013-01-11T21:08:29.887
> 
> 标签：excel, ms-access, vba

我是 Access 和 VBA 的新手，并试图开发一个简单的代码：将表导出到 xls，打开它，简单的操作（格式化），保存并关闭。

但在此过程中我收到以下消息框：`"A file named RESUME.XLW" already exists in this location. Do you want to replace it?"`

选择“是”将生成 xls 文件。但是当我尝试打开它时，Excel 以只读模式运行，我不明白为什么。

我正在使用以下代码：

```
Sub FormataExcelPadrao(caminhoExcel As String)

Set arquivoExcel = CreateObject("Excel.Application")
arquivoExcel.Workbooks.Open (caminhoExcel)

With arquivoExcel
    For Each pagina In .Worksheets
        With pagina
            .Columns("A:Z").Autofit
            .Cells.Font.Size = "10"
            .Cells.Font.Name = "Calibri"
        End With
    Next pagina
End With

arquivoExcel.Save
arquivoExcel.Close

End Sub 
```

提前致谢！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-11T21:42:23.607

定义您的对象，然后使用它。看这个例子

```
Sub FormataExcelPadrao(caminhoExcel As String)
    Dim arquivoExcel As Object, wb As Object, pagina As Object

    Set arquivoExcel = CreateObject("Excel.Application")
    Set wb = arquivoExcel.Workbooks.Open(caminhoExcel)

    With wb '<~~ Also this has to be the workbook and not excel app
        For Each pagina In .Worksheets
            With pagina
                .Columns("A:Z").AutoFit
                .Cells.Font.Size = "10"
                .Cells.Font.Name = "Calibri"
            End With
        Next pagina
    End With

    wb.Close SaveChanges:=True
    arquivoExcel.Quit

    Set wb = Nothing
    Set arquivoExcel = Nothing
End Sub 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-11T21:19:24.470

替换这个：

```
 arquivoExcel.Save 
```

和：

```
 arquivoExcel.ActiveWorkbook.Save 
```

见：[http ://www.tek-tips.com/viewthread.cfm?qid=1065376](http://www.tek-tips.com/viewthread.cfm?qid=1065376)

# javascript - 带有图书馆位置的 Google Maps API v3 AJAX LOAD

> ID：14286660
> 
> 赞同：3
> 
> 时间：2013-01-11T21:08:43.613
> 
> 标签：javascript, jquery, google-maps, google-maps-api-3

我正在开发一个需要在模式弹出窗口中加载谷歌地图的项目（我使用的是 api 版本 3）。

modal的内容是使用ajax调用加载的，我想要获取的是动态加载google map api。

下面的代码让我获得了我正在寻找的确切结果，但显然它也有一个副作用，我无法弄清楚如何解决（也许我在整个过程中做错了什么，我只是无法弄清楚什么）。每一个帮助都将非常感激，我提前感谢能够澄清我的想法的人。

注意（1）：我使用了 2 个不同版本的代码（一个使用 url 参数加载 api，另一个使用 google 加载功能），结果是一样的。

注意（2）：完整的开发是使用 Ruby on Rails 3 进行的，并试图充分利用资产管道功能。

**代码（解释）**

(1) JQUERY FUNCTION - 用于动态加载外部脚本

```
jQuery.externalScript = function(url, options) {
  // allow user to set any option except for dataType, cache, and url
  options = $.extend(options || {}, {
    dataType: "script",
    cache: true,
    url: url
  });
  // Use $.ajax() since it is more flexible than $.getScript
  // Return the jqXHR object so we can chain callbacks
  return jQuery.ajax(options);
}; 
```

(2) JS FUNCTION - 这对谷歌加载 api 进行动态调用

```
function google_load_api_call() {
  var gmap_src = 'https://www.google.com/jsapi';
  $.externalScript(gmap_src).done(function() {
        load_google_maps_api_via_google_ajax_api_loader();
  });;
} 
```

(3) JS FUNCTION - 使用 google load 动态调用 google maps api

```
function load_google_maps_api_via_google_ajax_api_loader() {
  google.load("maps", "3", {other_params:'libraries=places&sensor=false', callback: function(){
    initialize(); // initialize your map in here
  }});
} 
```

(3) JS FUNCTION - 这会初始化谷歌地图（用作回调）

```
function initialize() {
  var mapOptions = {
    zoom: 0,
    center: new google.maps.LatLng(-34.397, 150.644),
    mapTypeId: google.maps.MapTypeId.ROADMAP
  }
  var map = new google.maps.Map(document.getElementById("map"), mapOptions);
} 
```

(4) RAILS JS.ERB - 这用于加载模式，并加载所有内容（例如地图）

```
$('#section').append('<%= escape_javascript(render(:partial=>'locations/new_page/locations_new')) %>');

$(function() {
   modal_create_new_location(); // This call the modal to show
   google_load_api_call(); // This load the google load api and the map
   create_new_location_data_submit(); // This submit in ajax the form data
}); 
```

**代码（结果和问题）**

代码完美地执行其任务，模态加载，地图加载，库位置加载和工作。一切似乎完全正确（在 chrome 或 safari 中，没问题）。

只有当我在谷歌地图 api 调用中还包含一个库（例如地点或几何图形）时，才造成我巨大的折磨和痛苦的是 Firefox 提出的一个问题（实际上是一个警告） - 请参阅 JS 函数编号（3），存在 [other_params:'libraries=places] 的行。如果我不加载库，firefox 也不会再抱怨了，一切正常。

Firefox 提出的警告如下：

**错误：已删除对 eval(code, scopeObject) 的支持。使用 |with (scopeObject) eval(code);| 反而。**

它被称为：

[https://maps.gstatic.com/cat_js/intl/en_US/mapfiles/api-3/10/19/](https://maps.gstatic.com/cat_js/intl/en_US/mapfiles/api-3/10/19/) {main,places}.js

在第 9 行

有人可以让我理解我在这里做错了什么吗？我不应该使用动态调用来调用库吗？那么我如何使用自动完成地图功能呢？

# document - Microsoft 文档资源管理器显示错误

> ID：14286664
> 
> 赞同：0
> 
> 时间：2013-01-11T21:08:55.767
> 
> 标签：document, explorer

Microsoft 文档资源管理器在多个页面上显示以下错误消息“此网页可能无法正确显示。网页的内容与服务器指定的类型不匹配。”。自从我安装 Visual Studio Express for Web 2012 以来，它一直在这样做。我怎样才能摆脱这个警告？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-11T21:36:01.233

没关系！安装 Visual Studio 2012 的更新解决了这个问题。

# ruby-on-rails - 更改元搜索参数

> ID：14286665
> 
> 赞同：0
> 
> 时间：2013-01-11T21:08:59.760
> 
> 标签：ruby-on-rails, meta-search

索引操作

```
@search = Project.search(params[:search])
@projects = @search.order('created_at desc').paginate(:page => params[:page], :per_page => 100)
@total_projects = Project.count
respond_to do |format|
  format.html 
  format.mobile
  format.json { render :json => @projects }
end 
```

如果`params[:search][:stage_in]`存在并且它等于“time_end”我想像这样更改它`params[:search][:stage_in] == "started"`并且它可以与@search一起使用

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-11T21:30:11.653

为了清洁，我会为您制作一个单独的方法来执行此操作。最后一部分是否也应该是'=='？：

```
@search = Project.search(search_params(params))
@projects = @search.order('created_at desc').paginate(:page => params[:page], :per_page => 100)
@total_projects = Project.count
respond_to do |format|
  format.html 
  format.mobile
  format.json { render :json => @projects }
end  

def search_params(params)
  params[:search][:stage_in] = "started" if params[:search][:stage_in] == "time_end"
  params
end 
```

# mysql - WordPress 数据库的 MySQL 搜索查询

> ID：14286668
> 
> 赞同：0
> 
> 时间：2013-01-11T21:09:07.817
> 
> 标签：mysql, wordpress, search

我目前正在构建一个移动（Android）应用程序，它是一个产品搜索引擎。产品信息，当前存储在 WordPress 电子商务商店 (WooCommerce) 中。我已经在这家商店添加了 5 个样品产品用于测试目的。

我目前在应用程序中使用了搜索功能。用于此搜索的 MySQL 查询如下：

```
SELECT a.*, b.guid AS img_url 
FROM wp_posts AS a 
LEFT JOIN wp_posts AS b ON a.ID = b.post_parent 
WHERE a.post_type='product' 
AND a.post_title LIKE '%$search%' 
```

现在，当我搜索“sample”之类的内容时，我会得到标题中包含“sample”一词的所有产品的搜索结果。

但是，如果其中一种产品附有多个图像。我得到了附加到产品上的尽可能多的图像的结果。（见下面的截图）

截图：[http ://cl.ly/M7Ap](http://cl.ly/M7Ap)

如果有人可以帮助我解决这个问题，那么我就不会得到一个帖子的多个结果。这将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-11T21:17:30.517

如果您不关心哪个结果，而只想每个帖子一个，您可以不只使用 GROUP BY 吗？

# javascript - 比较两个json数组

> ID：14286671
> 
> 赞同：6
> 
> 时间：2013-01-11T21:09:40.117
> 
> 标签：javascript, jquery, json

我有这个间隔，它执行一个 ajax 请求，目前每 5 秒一次。我的`if`声明有问题。我的代码总是输入它，并且两个 json 值完全相同，为什么会看到它们不同？

```
var newActivity = null, oldActivity = null;
setInterval(function(){
    $.ajax({
        type: "get",
        url: "/get/new_activity",
        dataType: "json",
        success: function(data){
            oldActivity = newActivity;
            newActivity = data;
            console.log(JSON.stringify(oldActivity));
            console.log(JSON.stringify(newActivity));
            if(JSON.stringify(oldActivity) != JSON.stringify(newActivity)){
                $("#new-activity").slideDown( "fast" );
            }
        }
    });
}, 5000); 
```

**编辑**
这里是控制台输出（虚线是分隔请求，它不在实际输出中）

```
null
[{"title":"How many planets are in the solar system?","title_url":"How-many-planets-are-in-the-solar-system%3F","id":"2","answers":"1","asked":"2013-01-11 10:03:50","asked_pretty":"Today","activity":"2013-01-11 12:33:53","activity_pretty":"Today"},{"title":"Why is the sky blue?","title_url":"Why-is-the-sky-blue%3F","id":"1","answers":"1","asked":"2013-01-11 09:55:13","asked_pretty":"Today","activity":"2013-01-11 12:03:45","activity_pretty":"Today"}]

---------------------------------------------------

[{"title":"How many planets are in the solar system?","title_url":"How-many-planets-are-in-the-solar-system%3F","id":"2","answers":"1","asked":"2013-01-11 10:03:50","asked_pretty":"Today","activity":"2013-01-11 12:33:53","activity_pretty":"Today"},{"title":"Why is the sky blue?","title_url":"Why-is-the-sky-blue%3F","id":"1","answers":"1","asked":"2013-01-11 09:55:13","asked_pretty":"Today","activity":"2013-01-11 12:03:45","activity_pretty":"Today"}]
[{"title":"How many planets are in the solar system?","title_url":"How-many-planets-are-in-the-solar-system%3F","id":"2","answers":"1","asked":"2013-01-11 10:03:50","asked_pretty":"Today","activity":"2013-01-11 12:33:53","activity_pretty":"Today"},{"title":"Why is the sky blue?","title_url":"Why-is-the-sky-blue%3F","id":"1","answers":"1","asked":"2013-01-11 09:55:13","asked_pretty":"Today","activity":"2013-01-11 12:03:45","activity_pretty":"Today"}]

---------------------------------------------------

[{"title":"How many planets are in the solar system?","title_url":"How-many-planets-are-in-the-solar-system%3F","id":"2","answers":"1","asked":"2013-01-11 10:03:50","asked_pretty":"Today","activity":"2013-01-11 12:33:53","activity_pretty":"Today"},{"title":"Why is the sky blue?","title_url":"Why-is-the-sky-blue%3F","id":"1","answers":"1","asked":"2013-01-11 09:55:13","asked_pretty":"Today","activity":"2013-01-11 12:03:45","activity_pretty":"Today"}]
[{"title":"How many planets are in the solar system?","title_url":"How-many-planets-are-in-the-solar-system%3F","id":"2","answers":"1","asked":"2013-01-11 10:03:50","asked_pretty":"Today","activity":"2013-01-11 12:33:53","activity_pretty":"Today"},{"title":"Why is the sky blue?","title_url":"Why-is-the-sky-blue%3F","id":"1","answers":"1","asked":"2013-01-11 09:55:13","asked_pretty":"Today","activity":"2013-01-11 12:03:45","activity_pretty":"Today"}] 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-01-11T21:23:49.840

JSON对象不保证以相同的方式序列化，属性不保证以相同的顺序，使用`JSON.stringify`不是测试对象相等性的好方法。

一个更好的例子是这样的函数（前段时间在互联网上找到，希望我能感谢原作者）

```
/**
 * Deep compare of two objects.
 *
 * Note that this does not detect cyclical objects as it should.
 * Need to implement that when this is used in a more general case. It's currently only used
 * in a place that guarantees no cyclical structures.
 *
 * @param {*} x
 * @param {*} y
 * @return {Boolean} Whether the two objects are equivalent, that is,
 *         every property in x is equal to every property in y recursively. Primitives
 *         must be strictly equal, that is "1" and 1, null an undefined and similar objects
 *         are considered different
 */
function equals ( x, y ) {
    // If both x and y are null or undefined and exactly the same
    if ( x === y ) {
        return true;
    }

    // If they are not strictly equal, they both need to be Objects
    if ( ! ( x instanceof Object ) || ! ( y instanceof Object ) ) {
        return false;
    }

    // They must have the exact same prototype chain, the closest we can do is
    // test the constructor.
    if ( x.constructor !== y.constructor ) {
        return false;
    }

    for ( var p in x ) {
        // Inherited properties were tested using x.constructor === y.constructor
        if ( x.hasOwnProperty( p ) ) {
            // Allows comparing x[ p ] and y[ p ] when set to undefined
            if ( ! y.hasOwnProperty( p ) ) {
                return false;
            }

            // If they have the same strict value or identity then they are equal
            if ( x[ p ] === y[ p ] ) {
                continue;
            }

            // Numbers, Strings, Functions, Booleans must be strictly equal
            if ( typeof( x[ p ] ) !== "object" ) {
                return false;
            }

            // Objects and Arrays must be tested recursively
            if ( !equals( x[ p ],  y[ p ] ) ) {
                return false;
            }
        }
    }

    for ( p in y ) {
        // allows x[ p ] to be set to undefined
        if ( y.hasOwnProperty( p ) && ! x.hasOwnProperty( p ) ) {
            return false;
        }
    }
    return true;
}, 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-11T21:28:59.820

一种解决方案是将 json 数据作为文本而不是 json 读取，并在成功时检查来自服务器的响应字符串是否与上一个响应字符串不同。然后你可以在字符串上调用 JSON.parse 。但这使比较变得更加容易，并且只需要对您的代码稍作修改。

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2013-01-11T21:17:51.567

我认为您应该尝试比较它们的属性。

```
 `for(var property in JSON.stringify(oldActivity))
    {
      if(JSON.stringify(oldActivity)[property]!=JSON.stringify(newActivity)[property])
                   $("#new-activity").slideDown( "fast" );
    }` 
```

# c++ - 在 C++ 中进行迭代的优雅方式

> ID：14286676
> 
> 赞同：7
> 
> 时间：2013-01-11T21:10:02.643
> 
> 标签：c++, vector, coding-style

假设我有一个多边形向量，其中每个多边形都包含一个点向量。我必须在我的代码中多次迭代所有多边形的所有点，我最终不得不一遍又一遍地编写相同的代码：

```
for(std::vector<Polygon*>::const_iterator polygon = polygons.begin();
                polygon != polygons.end(); polygon++)
{
        for(std::vector<Point>::const_iterator point = (*polygon)->points.begin();
                        point != (*polygon)->points.end(); point++)
        {
                (*point).DoSomething();
        }
} 
```

我真的觉得对于两个简单的迭代来说这是很多代码，并且感觉它阻塞了代码并干扰了可读性。

我认为的一些选择是：

*   使用#defines - 但它会使不可移植（用于代码的其他部分）。此外，#defines 现在被认为是邪恶的。
*   遍历 vector->size() - 这似乎不是最优雅的方式；
*   使用函数指针调用方法 - 但在这种情况下，应该在循环内部的代码将远离循环。

那么，最干净、最优雅的方式是什么？

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2013-01-11T21:14:27.553

在 C++11 中，使用[ranged-base for 循环](http://en.wikipedia.org/wiki/C%2B%2B11#Range-based_for-loop)和[`auto`](http://en.wikipedia.org/wiki/C%2B%2B11#Type_inference)关键字：

```
for(const auto& polygon : polygons) {
    for(const auto& point : polygon->points) {
        point.DoSomething();
    }
} 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2013-01-11T21:18:32.120

如果您不能使用 C++11，boost 有一个[FOREACH](http://www.boost.org/doc/libs/1_52_0/doc/html/foreach.html)宏，它会生成大量代码，但会大大简化您的代码：

```
BOOST_FOREACH(Polygon * polygon, polygons)
{
    BOOST_FOREACH( Point & point, polygon->points )
    {
        point.doSomething();
    }
} 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2013-01-11T21:17:41.427

可以使用如下算法重写内部循环：

```
std::for_each(
    (*polygon)->points.begin(), (*polygon)->points.end(), 
    &Point::DoSomething
); 
```

将它与外循环混合起来有点复杂：

```
std::for_each(
    polygons.begin(), polygons.end(),
    []( Polygon* polygon ) {
        std::for_each(
            polygon->points.begin(), polygon->points.end(), 
            &Point::DoSomething
        );
    }
); 
```

如果我们有某种复合迭代器，我们可以真正表达您的意图，即为*每个*多边形中*的每个*点*做*一些事情。*像Boost.Range*这样的*范围*库将允许您避免将每个容器命名两次，因为您想使用它们的整个*范围*。

 ***我理想的代码版本如下所示：

```
for_each( flatten( polygons ), &Point::DoSomething ); 
```

are`flatten`将返回每个中的每个*视图*，就好像它是一个连续的*范围*一样。请注意，这是可以在普通*C++03*中完成的事情，而我们在*Boost.Range*中缺少的只是一个扁平化的*range*，这在 range 方面应该不难实现。`Point``Polygon`****`join`****

 ***否则，*基于范围的 for 循环*将`auto`帮助您减少迭代抛出范围并忘记复杂类型的样板。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2013-01-11T21:17:48.670

如果你不能使用 C++11，也许 typedef 迭代器类型更短，比如

```
typedef std::vector<Polygon*>::const_iterator PolyCit;
for (PolyCit polygon = polygons.begin(); polygon != polygons.end(); polygon++) 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-01-11T21:28:29.283

没关系，这对你不起作用，因为你在顶层有一个指针向量，但我会坚持下去，因为我认为它很酷。

* * *

我的模板元编程有点生疏，所以可能有更简单的方法可以做到这一点，但是：

```
template<typename C, typename F, size_t depth>
struct nested_for_each_helper
{
    static void do_it(C& c, F& f)
    {
        for (auto& i : c)
            nested_for_each_helper<decltype(i),F,depth-1>::do_it(i,f);
    }
};

template<typename C, typename F>
struct nested_for_each_helper<C,F,0>
{
    static void do_it(C& c, F& f)
    {
        f(c);
    }
};

template<size_t depth, typename C, typename F>
void nested_for_each(C& c, F& f)
{
    nested_for_each_helper<C,F,depth>::do_it(c,f);
}

int main()
{        
    int n[3][3][3][3];
    int i = 0;
    nested_for_each<4>(n,[&i](int& n) { n = i++; });
    nested_for_each<4>(n,[](int n){
        std::cout << n << ' ';
    });
} 
```

对于您的情况，您可以像这样使用它（不，您不能）：

```
nested_for_each<2>(polygons, [](Point const& p) { p.DoSomething(); }); 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2013-01-11T21:28:30.030

你需要一个抽象层。与其处理多边形向量，不如编写一个管理该向量的类。然后该类提供迭代器对来迭代这些点。迭代器中的代码知道并封装了这些细节。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-01-11T21:37:47.160

首先，有一个普通的基于整数的循环。比迭代器短一点。

```
for( int i = 0 ; i < polygons.size() ; i++ )
{
    for( int j = 0 ; j < polygons[i]->points.size(); j++)
    {
        Point* p = polygons[i]->points[j] ;
        p->DoSomething();
    }
} 
```

如果您不喜欢这样，并且没有可用的 C++11，则可以编写接受函子的函数（`std::tr1`我相信这些在 C++0x 中）：

```
void eachPoint( function<void (Point* p)> func )
{
    for( int i = 0 ; i < polygons.size() ; i++ )
    {
        for( int j = 0 ; j < polygons[i]->points.size(); j++)
        {
            Point* p = polygons[i]->points[j] ;
            func(p);
        }
    }
} 
```

或者，一个普通的旧宏：

```
#define EACH_POLYGON( polyCollection ) for( int _polyI = 0 ; _polyI < polyCollection.size() ; _polyI++ ) \
for( int _ptNo = 0, Point* p=polyCollection[_polyI]->points[0] ; j < polyCollection[_polyI]->points.size() && (p=polyCollection[_polyI]->points[_ptNo]); _ptNo++)

EACH_POLYGON( polyCollection )
{
    p->DoSomething();
} 
```******

# html - 如何更改画布图像的生成名称？

> ID：14286677
> 
> 赞同：2
> 
> 时间：2013-01-11T21:10:03.637
> 
> 标签：html, canvas

在FF中，当我右键单击画布并选择“将图像另存为...”时，提供的名称始终是canvas.png。我不能改吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-12T04:48:39.660

我不确定您使用什么来获得该右键单击功能（除非它内置在特定的浏览器中），但无论哪种方式，答案都是“否”，除非您要在服务器上生成一个新文件来放置作为画布上的玻璃板，用于右键单击。

或者更简单一点，您不能在 JavaScript 中定义任何特定文件的名称，它必须由服务器决定或根本不决定。

# visual-studio - 之后我应该安装 Windows SDK

> ID：14286681
> 
> 赞同：1
> 
> 时间：2013-01-11T21:10:14.043
> 
> 标签：visual-studio, visual-studio-2012, winapi

我有带有 Visual Studio 2012 Ultimate 的 Windows 7 x64。我想构建 Win32 应用程序及其 x64 构建。没有 Windows Phone，Windows 商店应用程序都不是我关心的问题。

在这种情况下我应该安装 Windows SDK 吗？如果我想安装 Windows SDK，我必须遵循任何特定的安装顺序吗？（听说VS2010 SPI和Windows SDK v7有特定的安装顺序。）另外，如果我要安装Windows SDK，我应该选择Windows SDK v7.1还是SDK 8。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-12T11:13:01.220

使用 Visual Studio 2012，您无需安装任何额外的东西来执行此操作。确保在安装 Visual Studio 时已安装 64 位编译器二进制文件。

默认情况下，将为`Win32`. 要构建，请从下拉列表`x64`中选择`Build -> Configuration Manager...` Then 从新平台下拉列表中选择。`Active solution platform``<New...>``x64`

在此之后，您可以构建`Win32`或`x64`通过从配置管理器中选择适当的配置，或者您可以通过选择来构建两者`Build -> Batch Build...`

# c# - 单元测试中的 DeploymentItem 和 TestCleanup 冲突？

> ID：14286682
> 
> 赞同：4
> 
> 时间：2013-01-11T21:10:19.687
> 
> 标签：c#, unit-testing

我有一个应用程序，在许多类中有许多单元测试。许多测试具有 DeploymentItem 属性以提供所需的测试数据：

```
[TestMethod]
[DeploymentItem("UnitTesting\testdata1.xml","mytestdata")]
public void Test1(){
    /*test*/
}

[TestMethod]
[DeploymentItem("UnitTesting\testdata2.xml","mytestdata")]
public void Test1(){
    /*test*/
} 
```

当测试单独运行时，它们通过了。当全部同时运行时（例如，当我选择“在当前上下文中运行所有测试”时），一些测试会失败，因为`DeploymentItem`其他测试留下的 s 会导致测试抓取错误的数据。（或者，一个测试错误地使用了用于另一个尚未运行的测试的文件。）

我发现了`[TestCleanup]`and`[ClassCleanup]`属性，这似乎会有所帮助。我添加了这个：

```
[TestCleanup]
public void CleanUp(){
    if(Directory.Exists("mytestdata"))
        Directory.Delete("mytestdata", true);
} 
```

问题是，这在每个测试方法之后运行，并且似乎它会删除尚未运行的测试的 DeploymentItems。`[ClassCleanup]`会阻止这种情况，但不幸的是，它运行的频率不足以阻止最初的问题。

从 MSDN 文档看来，DeploymentItem 似乎只保证文件在测试执行之前就在那里，但并不比这更具体。我想我看到了以下问题：

1.  用于测试的部署项执行
2.  （发生其他事情？）
3.  先前测试执行的测试清理
4.  下一个测试执行
5.  测试失败，因为文件不见了

有谁知道不同测试属性的执行顺序？我一直在寻找，但我没有找到太多。

我曾考虑让每个部署项都使用自己独特的数据文件夹，但这变得很困难，因为要进行数百次测试。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-11T21:30:14.837

[测试属性](http://msdn.microsoft.com/en-us/library/microsoft.visualstudio.testtools.unittesting.testinitializeattribute.aspx)的顺序如下：

1.  用 AssemblyInitializeAttribute 标记的方法。
2.  用 ClassInitializeAttribute 标记的方法。
3.  用 TestInitializeAttribute 标记的方法。
4.  用 TestMethodAttribute 标记的方法。

部分问题是 Visual Studio 以不确定的顺序运行测试（默认情况下[，但可以更改](https://stackoverflow.com/q/4684408/299327)）并且一次运行多个。这意味着您无法在每次测试后删除该文件夹。

* * *

一般来说，如果你能**避免**去磁盘进行单元测试，那就*更好了*。一般来说，除了可以**破坏**测试的代码之外，您不希望有任何东西。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-11-23T09:17:38.777

我有一个类似的问题。在少数测试中，我需要删除已部署的项目 - 所有测试在单独运行时通过，但在播放列表中运行时失败。我的解决方案很丑陋，但很简单：**为每个 test 使用不同的文件夹**。

例如：

```
 [TestMethod]
    [DeploymentItem("Resources\\DSC06247.JPG", "D1")]
    public void TestImageUploadWithRemoval()
    {
        // Arrange
        myDeployedImagePath = Path.Combine(TestContext.DeploymentDirectory, "D1", "DSC06247.JPG");
        // Act ...
    }

    [TestMethod]
    [DeploymentItem("Resources\\DSC06247.JPG", "D2")]
    public void TestImageUploadWithoutRemoval()
    {
        // Arrange
        myDeployedImagePath = Path.Combine(TestContext.DeploymentDirectory, "D2", "DSC06247.JPG");
        // Act...
    } 
```

# javascript - Node.js 中迭代的异步问题

> ID：14286686
> 
> 赞同：2
> 
> 时间：2013-01-11T21:10:47.723
> 
> 标签：javascript, node.js, asynchronous

我发现自己遇到了遍历数组的问题，为每个调用我的回调的项目触发异步操作，而我正在再次迭代的数组......当然，在进入下一个项目之前，你需要等待上一个结束。如果在处理项目时发生错误，您必须停止并退出所有封闭循环。

我为处理这些情况而编写的代码很容易编写，但不容易阅读/维护。为了这个问题的完整性，我目前正在使用我编写的方法，如下所示：

```
iterate(items, item_callback, ended_callback); 
```

item_callback 如下所示：

```
function(item, next_item, stop) {

    //do your stuff with `item` here...

    //return next_item() to go forward
    //return stop() to break
} 
```

我想知道也许我错过了在 node.js 中进行迭代的更好技术。

示例时间：

```
User.find(function(err, users) {
    //iterate through users: how?
    //first attempt: for
    for(var i in users) {
        //simple stuff works here... but if I call something async... what do I do?
        //like iterating through friends
        User.find({friend:users[i]._id}, function(err, friends) {
            if(err) {
                 //handle error: how is best to do this?
            }
            //this might end after the next user is selected... and might break things
        });
    }
}); 
```

TL;DR：如何在 node.js 中进行迭代，以便它同时适用于异步代码和经典同步代码？

PS：我相信有些用户会在使用`async`模块时回答一些问题。我知道。我不喜欢我的代码在使用时的样子。它甚至比我当前的解决方案更难维护。我需要更好的东西。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-11T21:16:53.443

有大量用于处理异步操作的[node.js 流控制库。](https://github.com/joyent/node/wiki/modules#wiki-async-flow)它们都有略微不同的方法和语法糖，但 `async`可能是最受欢迎的。我更喜欢`Step`它的功率重量比。:)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-23T11:20:15.303

如果我理解正确，你的例子是猫鼬的用法。请参阅以下基于 Promise 的解决方案：[Node.js deferred promisify + mongoose](https://stackoverflow.com/questions/11912573/node-js-deferred-promisify-mongoose/11931908#11931908)

# ruby-on-rails - 将渲染中的变量传输到 HTML

> ID：14286697
> 
> 赞同：0
> 
> 时间：2013-01-11T21:11:36.200
> 
> 标签：ruby-on-rails, erb

抱歉标题令人困惑，但我不确定确切的问题是什么，因为我不太了解 Ruby。无论如何，解决问题！

所以我有一个渲染：

```
<div class="form" id="dept_div">
     <span class="label search_label">Department:</span>
          <% query = "<option></option>" %>
             <% Department.all.each do |d| %>
                <% query << "<option>"+d.dept+"</option>" %>
             <% end %>

          <%=select_tag :major, query.html_safe,   class: "search_tag", id: "dept_drop" %>
 </div> 
```

我尝试在这里插入：

```
<span class="su_label">
  <%= f.label :major %>
</span>
<% if !in_mobile_view? %>
  <div class = "su_textfield">
    <div class="checkbox">
    <% else %>
      <div data-role="fieldcontain" class="field_group">
        <fieldset data-role="controlgroup" data-type="horizontal">
        <% end %>
        <!-- check privacy preferences to decide whether box should already be checked -->
        <% if !hasnoprefs && @user.privacy_prefs.include?("nomajor") %>
          <%= check_box_tag "major", 1, true %>
        <% else %>
          <%= check_box_tag "major" %>
        <% end %>
        <%= label_tag 'major', 'Hide' %>
        <% if !in_mobile_view? %>
        </div>
        <%= render 'courses/form_partials/majors' %>
</div>
    <% else %>
      <%= f.text_field :major, class: "settings_inputfield" %>
    </fieldset> 
```

我想要的是变量major（在User类中）成为从渲染中选择的项目（这是一个下拉菜单）。有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-11T21:33:36.257

尝试...

```
<%= f.collection_select :major, query, :id, :major, {:include_blank => 'None' } %> 
```

# unit-testing - 如何更改 VS 2012 中的单元测试目录

> ID：14286704
> 
> 赞同：1
> 
> 时间：2013-01-11T21:11:55.517
> 
> 标签：unit-testing, visual-studio-2012

我的意思是返回的目录

```
 this.TestContext.TestDir 
```

在单元测试中。

只关心**VS2012**。

我尝试了 VS 测试设置，但可以配置的文件夹不会影响 TestDir 值，此外 MS 强烈建议不要再使用 .testsettings 文件。

我们考虑从必须在构建/开发机器上设置的环境变量手动设置此目录，也欢迎更好的解决方法。

# chef-infra - How can I find the disk available in a Chef recipe?

> ID：14286709
> 
> 赞同：5
> 
> 时间：2013-01-11T21:12:21.470
> 
> 标签：chef-infra

While a Chef recipe is executing, I want to determine if there is sufficient free disk space available to perform an operation.

How best to do this?

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-01-11T21:12:21.470

[Ohai](http://docs.opscode.com/ohai.html) detects certain properties of a a node each time it is run. These properties are captured as [automatic attributes](http://docs.opscode.com/ohai_automatic_attributes.html) and are available to you as node attributes.

The attribute node['filesystem'] contains information about each of the devices on your system. To get the space available in kb, for a specific device:

```
node['filesystem']['/dev/xvda1']['kb_available'] 
```

The following is an example of the filesystem attribute JSON from Ohai:

```
 "filesystem": {
  "/dev/xvda1": {
    "kb_size": "521882300",
    "kb_used": "119914572",
    "kb_available": "375474240",
    "percent_used": "25%",
    "mount": "/",
    "fs_type": "ext4",
    "mount_options": [
      "rw"
    ],
    "uuid": "248b8180-f75f-48fc-a8be-e3ff3506c4d6"
  },
  "tmpfs": {
    "kb_size": "1987292",
    "kb_used": "0",
    "kb_available": "1987292",
    "percent_used": "0%",
    "mount": "/dev/shm",
    "fs_type": "tmpfs",
    "mount_options": [
      "rw",
      "rootcontext=\"system_u:object_r:tmpfs_t:s0\""
    ]
  }
} 
```

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2018-11-22T10:55:18.783

```
cron 'cron for checking disk space' do
  minute '00'
  hour  '12'
  command 'disk_space_check.sh'
  user 'smj'
end 
```

# angularjs - 找不到角度 $resource 更新方法

> ID：14286713
> 
> 赞同：4
> 
> 时间：2013-01-11T21:12:40.190
> 
> 标签：angularjs

我正在关注 Angular 主页，并扩展了 $resource 以添加如下更新方法：

```
angular.module('user', ['ngResource']).
factory('User', function($resource) {
  var User= $resource('/user/:id', {
    update: {
      method: 'PUT'
    }
  });

  User.prototype.update = function(cb) {
    return User.update({  // this line throws the error
      id: this.id
    }, angular.extend({}, this, {
      _id: undefined
    }), cb);
  }; 
```

但是运行：

```
$scope.user.update() 
```

抛出**TypeError: Object function h(a){v(a||{},this)} has no method 'update'**

我现在看不到我缺少的东西，任何帮助表示赞赏

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-01-13T18:20:10.923

我发现这个问题实际上我需要为 paramDefaults arg 传递一个空对象：

```
var User= $resource('/user/:id', {}, {
    update: {
      method: 'PUT'
    }

} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-11T21:22:07.803

您正在使用缩小的 angularjs 版本，因此您必须使用 to [array notation](http://docs.angularjs.org/guide/di)。只需在数组中注入所需的服务，然后是函数：

```
angular.module('user', ['ngResource']).
factory('User', ['$resource', function($resource) {
  var User= $resource('/user/:id', {
    update: {
      method: 'PUT'
    }
  });

  User.prototype.update = function(cb) {
    return User.update({
      id: this.id
    }, angular.extend({}, this, {
      _id: undefined
    }), cb);
  });
}]); 
```

**注意：这同样适用于您的指令、控制器、...**

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-12T17:49:35.757

在资源实例中，方法名称以 $ 为前缀。

```
$scope.user.$update({}, cb); 
```

# sql - 列值的 SQL 总和，每个用户每天唯一

> ID：14286714
> 
> 赞同：5
> 
> 时间：2013-01-11T21:12:41.923
> 
> 标签：sql, ruby-on-rails, postgresql

我有一个如下所示的 postgres 表：

```
id | user_id | state | created_at 
```

状态可以是以下任何一种：

```
new, paying, paid, completing, complete, payment_failed, completion_failed 
```

我需要一个返回报告的语句，其中包含以下内容：

1.  按日期计算的所有已付款状态的总和
2.  按日期列出的所有已完成状态的总和
3.  按日期计算的所有新的、付费的、完成状态的总和，每个用户每天只计算一个
4.  按日期计算的所有 payment_failed、completion_failed 的总和，每个用户每天只计算一个

到目前为止，我有这个：

```
SELECT
  DATE(created_at) AS date,
  SUM(CASE WHEN state = 'complete' THEN 1 ELSE 0 END) AS complete,
  SUM(CASE WHEN state = 'paid' THEN 1 ELSE 0 END) AS paid
FROM orders
WHERE created_at BETWEEN ? AND ?
GROUP BY DATE(created_at) 
```

通过将其添加到选择中，进行中和失败状态的总和很容易：

```
SUM(CASE WHEN state IN('new','paying','completing') THEN 1 ELSE 0 END) AS in_progress,
SUM(CASE WHEN state IN('payment_failed','completion_failed') THEN 1 ELSE 0 END) AS failed 
```

但是我无法弄清楚如何每天只为每个 user_id 制作一个 in_progress 和失败的状态来计算。

The reason I need this is to manipulate the failure rate in our stats, as many users who trigger a failure or incomplete order go on to trigger more which inflates our failure rate.

Thanking you in advance.

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-11T21:55:01.810

```
SELECT created_at::date AS the_date
      ,SUM(CASE WHEN state = 'complete' THEN 1 ELSE 0 END) AS complete
      ,SUM(CASE WHEN state = 'paid' THEN 1 ELSE 0 END) AS paid
      ,COUNT(DISTINCT CASE WHEN state IN('new','paying','completing')
                      THEN user_id ELSE NULL END) AS in_progress
      ,COUNT(DISTINCT CASE WHEN state IN('payment_failed','completion_failed')
                      THEN user_id ELSE NULL END) AS failed 
FROM   orders
WHERE  created_at BETWEEN ? AND ?
GROUP  BY created_at::date 
```

I use `the_date` as alias, since it is unwise (while allowed) to use the key word date as identifier.

You could use a similar technique for `complete` and `paid`, one is as good as the other there:

```
COUNT(CASE WHEN state = 'complete' THEN 1 ELSE NULL END) AS complete 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-11T21:53:14.647

Try something like:

```
SELECT
  DATE(created_at) AS date,
  SUM(CASE WHEN state = 'complete' THEN 1 ELSE 0 END) AS complete,
  SUM(CASE WHEN state = 'paid' THEN 1 ELSE 0 END) AS paid,
  COUNT(DISTINCT CASE WHEN state IN('new','paying','completing') THEN user_id ELSE NULL END) AS in_progress,
  COUNT(DISTINCT CASE WHEN state IN('payment_failed','completion_failed') THEN user_id ELSE NULL END) AS failed
FROM orders
WHERE created_at BETWEEN ? AND ?
GROUP BY DATE(created_at); 
```

The main idea - `COUNT (DISTINCT ...)` will count unique `user_id` and wont count `NULL` values.

Details: [aggregate functions](http://www.postgresql.org/docs/current/static/functions-aggregate.html), [4.2.7\. Aggregate Expressions](http://www.postgresql.org/docs/current/static/sql-expressions.html)

The whole query with same style counts and simplified `CASE WHEN ...`:

```
SELECT
  DATE(created_at) AS date,
  COUNT(CASE WHEN state = 'complete' THEN 1 END) AS complete,
  COUNT(CASE WHEN state = 'paid' THEN 1 END) AS paid,
  COUNT(DISTINCT CASE WHEN state IN('new','paying','completing') THEN user_id END) AS in_progress,
  COUNT(DISTINCT CASE WHEN state IN('payment_failed','completion_failed') THEN user_id END) AS failed
FROM orders
WHERE created_at BETWEEN ? AND ?
GROUP BY DATE(created_at); 
```

# sql - Oracle 空值

> ID：14286715
> 
> 赞同：1
> 
> 时间：2013-01-11T21:12:48.427
> 
> 标签：sql, oracle

有人可以解释一下 oracle db 中以下查询的功能，以及为什么它不返回最后一个空行。如果是空值，请不要解释我的功能。

```
Table Store_Information
store_name    Sales  Date
Los Angeles   $1500  Jan-05-1999
San Diego      $250  Jan-07-1999
San Francisco  $300  Jan-08-1999
Boston         $700  Jan-08-1999
(null)         $600  Jan-10-1999

SELECT *
FROM scott.Store_Information
WHERE store_name IN (null)

STORE_NAME           SALES                DATE                      
-------------------- -------------------- ------------------------- 

0 rows selected 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-11T21:15:57.517

```
SELECT *
FROM scott.Store_Information
WHERE store_name IS null; 
```

NULL 不能与其他（实际）值“比较”。因此，您必须使用`IS NULL`or `IS NOT NULL`。

以下是有关此主题的一系列博客文章：http: [//momjian.us/main/blogs/pgblog/2012.html#December_26_2012](http://momjian.us/main/blogs/pgblog/2012.html#December_26_2012)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-11T21:16:13.087

如果您要查找的值为空值，则查询应为：

```
SELECT *
FROM scott.Store_Information
WHERE store_name IS NULL; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-12T22:14:13.450

如果您希望查询选择字段为空值，您可以：解决方案 1：使用 where ... IS NULL ...

解决方案 2：或者如果您想绝对使用 IN，您可以使用 NVL，例如：

SELECT * FROM scott.Store_Information WHERE NVL(store_name, 'NULL_STORE_NAME') IN ('NULL_STORE_NAME')

但在第二种情况下，您假设您不能拥有名为“NULL_STORE_NAME”的商店名称......所以我认为通常最好使用解决方案 1......

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-11T21:19:22.173

Oracle NULLS 很[特殊](http://asktom.oracle.com/pls/asktom/f?p=100:11:0%3a%3a%3a%3aP11_QUESTION_ID:17320984423926)：

> 什么都不等于 null
> 什么都不等于 null

由于[`in`](http://docs.oracle.com/cd/B19306_01/server.102/b14200/conditions013.htm)等效于 a `= any`，因此这也适用于`in`。

因此，您不能在`in`or`not in`子句中使用 NULL 并期望得到正确的结果。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-01-11T21:21:35.643

Null 是一个特殊值，它不遵循字符串或数字比较的常规约定。除非您使用一些特殊的内置函数，否则使用这些常用方法评估 null 将始终评估为 FALSE。

```
Select * from Store_Information
where nvl(store_name,'') in ('')

Select * from store_information
where coalesce(store_name, 'Missing') in ('Missing')

Select * from store_information 
where store_name is null 
```

# vb.net - .Net - 查找所有联网计算机名称及其共享文件夹

> ID：14286720
> 
> 赞同：3
> 
> 时间：2013-01-11T21:13:01.313
> 
> 标签：vb.net, networking, .net

我想找到当前在同一网络上的所有计算机的名称。获得名称后，我想查看是否`Shared\NetworkFiles`存在名为的共享目录。*编辑和添加 - 我可能不知道实际的网络名称本身来扫描特定网络名称下的所有计算机。

例如：一个工作路径是`\\EQIZLOCAL-PC\Shared\NetworkFiles`

我可能在网络上还有其他几台计算机，我不能 100% 确定它们的名称是什么，它们可能具有相同的目录，并且我需要能够返回具有该路径的计算机名称列表可用.

长话短说...我只需要能够

1.  获取网络上所有计算机的名称
2.  在获取名称时检查文件夹路径是否确实存在并将它们添加到列表框或其他东西，我可以处理其余的。

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2018-10-13T15:04:05.637

显然，您可以使用**Imports System.DirectoryServices**

VB.NET上有示例代码[列出网络/工作组中的所有计算机](https://social.msdn.microsoft.com/Forums/vstudio/en-US/87499508-63f3-40ec-a82e-14a6da3f3bed/vbnet-list-all-computers-in-networkworkgroup-)

这至少应该回答你的部分问题。

# python - 在鼻子测试类中使用 __init__(self) 而不是 setup(self) 有缺点吗？

> ID：14286722
> 
> 赞同：7
> 
> 时间：2013-01-11T21:13:20.207
> 
> 标签：python, nose

为`nosetests -s`_

```
class TestTemp():

    def __init__(self):
        print '__init__'
        self.even = 0

    def setup(self):
        print '__setup__'
        self.odd = 1

    def test_even(self):
        print 'test_even'
        even_number = 10
        assert even_number % 2 == self.even

    def test_odd(self):
        print 'test_odd'
        odd_number = 11
        assert odd_number % 2 == self.odd 
```

打印出以下内容。

```
__init__
__init__
__setup__
test_even
.__setup__
test_odd
. 
```

测试实例是在测试运行之前创建的，而安装程序在测试之前运行。

对于一般情况， setup() 完成同样的事情，但是使用setup() 代替 setup()`__init__()`有缺点吗？`__init__()`还是两者都用？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-11T21:19:03.683

是的，您应该为测试创建一个干净的状态，并保持您的各个测试隔离。

似乎测试实例（每个测试一个）是在一批中创建的，而`setup`在每次测试之前都会被调用。如果您的设置需要重置外部状态，您需要在`setup`; 如果您要在`__init__`单个测试中执行此操作，则可能会在其余测试运行中搞砸该外部状态。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-12T12:56:45.663

虽然`__init__`可以作为 . 的替代品`setUp`，但您应该坚持使用，`setUp`因为它是编写测试的程式化协议的一部分。它也有一个对应物 ，`tearDown`它`__init__`没有，以及类和模块级对应物`__init__`没有。

编写测试类与编写普通类不同，所以你应该坚持编写测试类的风格。

# html - 了解错误“在此上下文中不允许元素图例作为元素 div 的子元素。”

> ID：14286730
> 
> 赞同：4
> 
> 时间：2013-01-11T21:13:56.793
> 
> 标签：html, validation

下面是我的 HTML 标记。我使用 Bootstrap，并遵循了他们的许多示例。然而，当使用 W3C HTML 验证器进行验证时，我得到了很多类型的错误：

```
"Element legend not allowed as child of element div in this context." 
```

我不明白这个错误信息。这是什么意思？我应该如何更改我的 HTML？

```
<!doctype html>

<!-- Bootstrap customisations:
    No responsiveness
    @navbarBackground: #568FB6
    @navbarBackgroundHighlight: lighten(#568FB6, 12%)
-->

<head>
    <meta charset='utf-8'>
    <meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
    <title>DeepFlow</title>

    <link href='./img/favicon.ico' rel='icon'>

    <link href='./css/bootstrap.css' rel='stylesheet'>
    <link href='./css/font-awesome.css' rel='stylesheet'>
    <link href='./css/global.css' rel='stylesheet'>
    <link href='./css/login.css' rel='stylesheet'>
    <link href='./css/custom.css' rel='stylesheet'>

    <script src='./RGraph/libraries/RGraph.common.core.js'></script>
    <script src='./RGraph/libraries/RGraph.common.annotate.js'></script>
    <script src='./RGraph/libraries/RGraph.common.effects.js'></script>
    <script src='./RGraph/libraries/RGraph.common.dynamic.js'></script>
    <script src='./RGraph/libraries/RGraph.gauge.js'></script>
    <script src='./RGraph/libraries/RGraph.line.js'></script>

    <script src='./js/jquery.js'></script>
    <script>jQuery.fx.speeds._default = 800;</script>
    <script src='./js/underscore.js'></script>
    <script src='./js/bootstrap.js'></script>

    <script src='./js/ajax.js'></script>
    <script src='./js/navbar.js'></script>
    <script src='./js/login.js'></script>

    <script src='./js/users.js'></script>
    <script src='./js/editUser.js'></script>
    <script src='./js/addUser.js'></script>

    <script src='./js/statistics.js'></script>
    <script src='./js/protocols.js'></script>
    <script src='./js/export.js'></script>
    <script src='./js/tuple.js'></script>
    <script src='./js/network.js'></script>
</head>

<div class='navbar navbar-fixed-top' style='display:none'>
    <div class='navbar-inner'>
        <div class='container'>
            <div class='brand'>DeepFlow</div>
            <div id='navbar-container'>
                <ul class='nav panes-nav'>
                    <li id='statistics-label'><a>Statistics</a></li>
                    <li id='protocols-label'><a>Protocols</a></li>
                    <li id='tuples-label'><a>Tuples</a></li>
                    <li id='exports-label'><a>Exports</a></li>
                    <li id='users-label'><a>Users</a></li>
                    <li id='network-label'><a>Network</a></li>
                </ul>
                <ul class='nav pull-right'>
                    <li id='sign-out'><a>Log out</a></li>
                </ul>
            </div>
        </div>
    </div>
</div>

<div id='wrap'>
    <br>
    <br>
    <br>

    <div class='container'>
        <div class='alert alert-error' style='display:none'>
            <span id='error-message'></span>
            <button type='button' class='close' data-dismiss='alert'>×</button>
        </div>

        <div class='hero-unit' id='login-unit'>
            <h2>Welcome to DeepFlow</h2>
            <p>Please log in</p>
            <center id='login-box' class='pull-right control-group'>
                <div class='clearfix'>
                    <input type='text' placeholder='Username' id='login-username'/>
                </div>
                <div class='clearfix'>
                    <input type='password' placeholder='Password' id='login-password'/>
                </div>
                <button class='btn btn-primary' type='submit' id='login-button'>Log in</button>
            </center>
        </div>

        <div class='row pane' id='statistics-pane' style='display:none'>
            <legend>Network</legend>

            <div class='form-horizontal well'>
                <div class='offset1'>
                    <div class='control-group statistics-group'>
                        <label class='control-label graph-label'>
                            <div>Packets per second</div>
                            <p class='live-statistic' data-ending='' data-precision='0'></p>
                        </label>
                        <div class='controls'>
                            <canvas id='pps_graph' width='500' height='100'>[No canvas support]</canvas>
                        </div>
                    </div>
                    <div class='control-group statistics-group'>
                        <label class='control-label graph-label'>
                            <div>Throughput</div>
                            <p class='live-statistic' data-ending='&nbsp;kB/s' data-precision='0'></p>
                        </label>
                        <div class='controls'>
                            <canvas id='throughput_graph' width='500' height='100'>[No canvas support]</canvas>
                        </div>
                    </div>
                    <div class='statistics-group'>
                        <label class='control-label graph-label'id='packets-dropped-group'>
                            <div>Packets dropped</div>
                            <p class='live-statistic' data-ending='' data-precision='0'></p>
                        </label>
                        <div class='controls'>
                            <canvas id='packets_dropped_graph' width='500' height='100'>[No canvas support]</canvas>
                        </div>
                    </div>
                </div>
            </div>

            <legend>System</legend>
            <div class='form-horizontal well'>
                <div class='offset1'>
                    <div class='control-group statistics-group'>
                        <label class='control-label graph-label'>
                            <div>CPU usage</div>
                            <p class='live-statistic' data-ending='&nbsp;%' data-precision='2'></p>
                        </label>
                        <div class='controls'>
                            <canvas id='cpu_graph' width='500' height='100'>[No canvas support]</canvas>
                        </div>
                    </div>
                    <div class='statistics-group'>
                        <label class='control-label graph-label'>
                            <div>Memory usage</div>
                            <p class='live-statistic' data-ending='&nbsp;k' data-precision='0'></p>
                        </label>
                        <div class='controls'>
                            <canvas id='memory_graph' width='500' height='100'>[No canvas support]</canvas>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class='row pane' id='protocols-pane' style='display:none'>
            <legend>Protocol list</legend>
            <table class='table table-hover table-condensed offset3' id='protocol-table'>
                <thead>
                    <tr>
                        <th>Protocol</th>
                        <th id='protocol-status-column'></th>
                    </tr>
                </thead>
                <tbody id='protocol-rows'>
                </tbody>
            </table>
        </div>

        <div class='row pane' id='tuples-pane' style='display:none'>
            <legend>List of tuples</legend>
            <table class='table table-hover offset3' id='tuple-table'>
                <thead>
                    <tr>
                        <th>Name</th>
                        <th>Total</th>
                        <th id='tuples-status-column'></th>
                    </tr>
                </thead>
                <tbody id='tuples-rows'>
                </tbody>
            </table>
        </div>

        <div class='row pane' id='exports-pane' style='display:none'>
            <legend>Configure export destinations</legend>
            <table class='table table-hover' id='exports-table'>
                <thead>
                    <tr>
                        <th>Name</th>
                        <th>URL</th>
                        <th>IP</th>
                        <th>Port</th>
                        <th>Format</th>
                        <th id='exports-edit-column'></th>
                    </tr>
                </thead>
                <tbody id='exports-rows'>
                </tbody>
            </table>

            <div class='modal hide fade' id='edit-export-modal'>
                <div class='modal-header'>
                    <span type='button' class='close' data-dismiss='modal' aria-hidden='true'>&times;</span>
                    <h3>Edit export <code id='edit-export-old'></code></h3>
                </div>
                <div class='modal-body'>
                    <form class='form-horizontal'>
                        <div class='control-group'>
                            <label class='control-label'>New IP</label>
                            <div class='controls'>
                                <input type='text' id='edit-export-ip' placeholder='IP'/>
                            </div>
                        </div>
                        <div class='control-group'>
                            <label class='control-label'>New port</label>
                            <div class='controls'>
                                <input type='text' id='edit-export-port' placeholder='Port'/>
                            </div>
                        </div>
                        <label class='control-label'>New format</label>
                        <div class='controls'>
                            <input type='text' id='edit-export-format' placeholder='Format'/>
                        </div>
                    </form>
                </div>
                <div class='modal-footer'>
                    <span class='btn' id='edit-export-close'>Close</span>
                    <span class='btn btn-primary' id='edit-export-save'>Save changes</span>
                </div>
            </div>
        </div>

        <div class='row pane' id='users-pane' style='display:none'>
            <div class='span6'>
                <legend>List of users</legend>
                <table class='table table-hover' id='users-table'>
                    <thead>
                        <tr>
                            <th>User</th>
                            <th>Rights</th>
                            <th id='users-edit-column'></th>
                        </tr>
                    </thead>
                    <tbody id='user-rows'>
                    </tbody>
                </table>
            </div>

            <div id='new-user-box' class='span6'>
                <legend>Add a new user</legend>
                <form class='form-horizontal well'>
                    <div class='control-group'>
                        <label class='control-label'>Username</label>
                        <div class='controls'>
                            <input type='text' class='username' id='new-user-username' placeholder='Username'/>
                        </div>
                    </div>
                    <div class='control-group'>
                        <label class='control-label'>Password</label>
                        <div class='controls'>
                            <input type='password' class='password' id='new-user-password' placeholder='Password'/>
                        </div>
                    </div>
                    <div class='control-group'>
                        <label class='control-label'>Rights</label>
                        <div class='controls'>
                            <div class='btn-group' data-toggle='buttons-radio' id='new-user-rights'/>
                                <span class='btn'>Administrator</span>
                                <span class='btn' id='new-user-operator'>Operator</span>
                            </div>
                        </div>
                    </div>
                    <div class='controls'>
                        <span class='btn btn-primary' id='new-user-button'>Add new user</span>
                    </div>
                </form>
            </div>

            <div class='modal hide fade' id='edit-user-modal'>
                <div class='modal-header'>
                    <span class='close' data-dismiss='modal' aria-hidden='true'>&times;</span>
                    <h3>Edit user <code id='edit-user-old-username'></code></h3>
                </div>
                <div class='modal-body'>
                    <form class='form-horizontal'>
                        <div class='control-group'>
                            <label class='control-label'>New username</label>
                            <div class='controls'>
                                <input type='text' class='username' id='edit-user-username' placeholder='(Leave unchanged)'/>
                            </div>
                        </div>
                        <div class='control-group'>
                            <label class='control-label'>New password</label>
                            <div class='controls'>
                                <input type='password' class='password' id='edit-user-password' placeholder='(Leave unchanged)'/>
                            </div>
                        </div>
                        <label class='control-label'>New rights</label>
                        <div class='controls'>
                            <div class='btn-group' data-toggle='buttons-radio' id='edit-user-rights'>
                                <span class='btn'>Administrator</span>
                                <span class='btn'>Operator</span>
                            </div>
                        </div>
                    </form>
                </div>
                <div class='modal-footer'>
                    <span class='btn btn-danger pull-left' data-action='remove'><i class='icon-trash'></i> Remove</span>
                    <span class='btn' data-action='close'>Close</span>
                    <span class='btn btn-primary' data-action='save'>Save changes</span>
                </div>
            </div>
        </div>

        <div class='pane' id='network-pane' style='display:none'>
            <div class='row'>
                <div class='alert alert-info' style='display:none'>
                    Use this pane to configure the server network. Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua.
                </div>
                <form class='span6 form-horizontal'>
                    <legend>Basic configurations</legend>
                    <div class='control-group'>
                        <label class='control-label'>IP address</label>
                        <div class='controls'>
                            <input type='text' id='network-ip' placeholder='IP address'/>
                        </div>
                    </div>
                    <div class='control-group'>
                        <label class='control-label'>Subnet mask</label>
                        <div class='controls'>
                            <input type='text' id='network-mask' placeholder='Subnet mask'/>
                        </div>
                    </div>
                    <div class='control-group'>
                        <label class='control-label'>Default gateway</label>
                        <div class='controls'>
                            <input type='text' id='network-gateway' placeholder='Default gateway'/>
                        </div>
                    </div>
                </form>
                <form class='span6 form-horizontal'>
                    <legend>Optional fields</legend>
                    <div class='control-group'>
                        <label class='control-label'>DNS hostname</label>
                        <div class='controls'>
                            <input type='text' id='network-dns' placeholder='DNS hostname'/>
                        </div>
                    </div>
                    <div class='control-group'>
                        <label class='control-label'>NTP server hostname</label>
                        <div class='controls'>
                            <input type='text' id='network-ntp' placeholder='NTP server hostname'/>
                        </div>
                    </div>
                </form>
            </div>

            <br>
            <br>
            <br>
            <center>
                <span class='btn btn-large btn-primary' id='network-save'>Save and reboot server now</span>
            </center>
        </div>

        <div id='push'></div>
    </div>
</div>

<div id='footer'>
    <div class='container'>
        <span class='muted credit'>&copy; Copyright 2013 Qosmos SA. All rights reserved.</span>
        <img id='logo' src='./img/logo_grey.png' alt='logo'/>
    </div>
</div> 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-11T22:08:12.920

添加的详细信息（ID、名称、标签等）越多，标记就越难以快速阅读，但以下说明了`legend`元素的意图。它旨在识别相互关联的输入组。然后将该组包裹在一个`fieldset`.

```
<form>
    <fieldset>
        <legend>Like Using Fieldsets?</legend>
        <input type="radio">
        <input type="radio">
    </fieldset>

    <fieldset>
        <legend>Your Name</legend>
        <input type="text" name="fname">
        <input type="text" name="lname">
    </fieldset>
</form> 
```

[http://www.w3.org/wiki/HTML/Elements/legend](http://www.w3.org/wiki/HTML/Elements/legend)

（注意：上面的代码只是为了突出图例的使用。）

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-01-11T21:15:50.207

`<legend>`标签直接属于标签下方`<fieldset>`。

见[w3c](http://www.w3.org/wiki/HTML/Elements/legend)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-14T19:12:46.897

那是验证器中的错误，

我有

```
<div>
<fieldset>
    <legend>Something</legend>
.......
</fieldset>
</div> 
```

并得到相同的错误

见 [http://lists.w3.org/Archives/Public/public-html-wg-issue-tracking/2012Jan/0008.html](http://lists.w3.org/Archives/Public/public-html-wg-issue-tracking/2012Jan/0008.html)

# django - 当指定的对象不存在时，如何从 Django DetailView 重定向？

> ID：14286732
> 
> 赞同：12
> 
> 时间：2013-01-11T21:14:07.917
> 
> 标签：django, detailview

所以，现在当我的 DetailView 子类没有使用 PK（取自 URL）找到对象时，我看到了 404.html 模板页面。我宁愿做的只是重定向到另一个 URL。这是我的网址模式：

```
url(r'^(?P<pk>[0-9]+)/$', DeviceDetailView.as_view(
    template_name='devices/detail.html',
    queryset=Device.objects.all(),
    context_object_name="device",
)),
url(r'^$', FullListView.as_view(template_name='devices/devices.html',)), 
```

所以，如果我的 url 看起来像 /devices/8/，它使用 8 作为主键。当数据库中存在 8 时效果很好。但是，当 8 不存在时，它会转到 404 页面。我宁愿它做的是去一个列表 - 事实上，在最后一个 url 时列出的 FullListView （当 url 看起来像 /devices/nonnumericstuff/ 时会发生这种情况。

看起来这应该很容易，不是吗？我不希望所有 404 都去那里，所以我不能使用 handler404。

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2013-01-11T21:57:30.703

如果对象在查询集中不存在，'`DetailView`方法[`get_object`会](https://github.com/django/django/blob/master/django/views/generic/detail.py#L21)引发异常。[您可以在视图的方法](https://github.com/django/django/blob/master/django/views/generic/detail.py#L107)中捕获异常，`Http404`而不是覆盖该方法：`get_object`[`get`](https://github.com/django/django/blob/master/django/views/generic/detail.py#L107)

```
from django.http import Http404
from django.views.generic import DetailView
from django.shortcuts import redirect

class MyDetailView(DetailView):

    def get(self, request, *args, **kwargs):
        try:
            self.object = self.get_object()
        except Http404:
            # redirect here
            return redirect(url)
        context = self.get_context_data(object=self.object)
        return self.render_to_response(context) 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2020-06-16T17:16:58.463

对于常见情况

```
from django.http import Http404
from django.shortcuts import redirect
from django.urls import reverse
from django.views.generic import DetailView

class MyDetailView(DetailView):
    def get(self, request, *args, **kwargs):
        try:
            return super().get(request, *args, **kwargs)
        except Http404:
            return redirect(reverse('my_list_view_name')) 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-01-11T21:23:22.923

您应该重新定义`def get_object(self):`DetailView

[这个问题](https://stackoverflow.com/questions/6008808/how-to-do-a-detailview-in-django-1-3)有类似的东西

# java - 覆盖方法不起作用

> ID：14286735
> 
> 赞同：1
> 
> 时间：2013-01-11T21:14:25.323
> 
> 标签：java, opengl, lwjgl

我正在尝试制作自己的引擎，但我需要一些帮助。

我目前正在做水平系统。关卡类扩展了渲染类，而关卡类覆盖了渲染类的渲染方法。最后从主类调用渲染类，但我不调用关卡类。

**编辑：**

我已经删除了静态，但现在无法调用渲染方法。我知道我很笨，我有点自学。

```
package SimpleEngine.Render; 
```

渲染类（这被称为）

```
import static org.lwjgl.opengl.GL11.GL_COLOR_BUFFER_BIT;
import SimpleEngine.Primitives.*;
import static org.lwjgl.opengl.GL11.glClear;

public class Render {

    public void Render() {

    }

} 
```

Level Class (This is not called) 我希望这个 Render 方法覆盖 Render 类的渲染方法，但它不起作用。

```
package SimpleEngine.Level;

    import static org.lwjgl.opengl.GL11.GL_COLOR_BUFFER_BIT;
    import static org.lwjgl.opengl.GL11.glClear;
    import SimpleEngine.Render.*;
    import SimpleEngine.Primitives.*;

    public class Level extends Render {

        public void Render() {
            glClear(GL_COLOR_BUFFER_BIT);
            Primitives.DrawSquare(200, 200, 50, 50, 1, 0, 0);
        }

    } 
```

我的主要方法（调用渲染但不能再）

```
package SimpleEngine;

import org.lwjgl.LWJGLException;
import SimpleEngine.Level.*;
import SimpleEngine.Logic.*;
import SimpleEngine.Input.*;
import SimpleEngine.Render.*;
import SimpleEngine.Entites.*;
import SimpleEngine.Timer.*;
import org.lwjgl.Sys;
import org.lwjgl.input.Keyboard;
import org.lwjgl.opengl.Display;
import org.lwjgl.opengl.DisplayMode;

import static org.lwjgl.opengl.GL11.*;

public class simpleEngine {

    public static final int WIDTH = 640;
    public static final int HEIGHT = 480;
    private static boolean isRunning = true;

    public static void main(String[] args) {
        setUpDisplay();
        setUpOpenGL();
        Entity.setUpEntities();
        Timer.setUpTimer();
        while (isRunning) {
            Render.Render();
            Logic.logic(Timer.getDelta());
            Input.input();
            Display.update();
            Display.sync(60);
            if (Display.isCloseRequested()) {
                isRunning = false;
            }
        }
        Display.destroy();
        System.exit(0);
    }

    private static void setUpDisplay() {
        try {
            Display.setDisplayMode(new DisplayMode(WIDTH, HEIGHT));
            Display.setTitle("SimpleEngine");
            Display.create();
        } catch (LWJGLException e) {
            e.printStackTrace();
            Display.destroy();
            System.exit(1);
        }
    }

    private static void setUpOpenGL() {
        glMatrixMode(GL_PROJECTION);
        glLoadIdentity();
        glOrtho(0, 640, 480, 0, 1, -1);
        glMatrixMode(GL_MODELVIEW);
    }

} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-11T21:15:52.210

您不能覆盖静态方法。

根据[Oracle 教程](http://docs.oracle.com/javase/tutorial/java/IandI/override.html)

> 如果子类定义了与超类中的类方法具有相同签名的类方法，则子类中的方法会隐藏超类中的方法。

和

> 如果您尝试将超类中的实例方法更改为子类中的类方法，则会收到编译时错误，反之亦然。

`static`从`Render`类方法中删除`render()`并将 Level 类`Render`方法更改为`render()`以引入覆盖行为

编辑：

```
 while (isRunning) {
            new Level().Render(); 
```

注意：Java 命名约定建议方法名应以小写字母开头，名称应为驼峰式。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-11T21:21:44.320

您不能覆盖静态方法。

另外，请注意，因为 Java 是一种区分大小写的语言，因此`Render()`与`render()`不同，并且可能是完全不同的方法。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-12T07:11:09.260

我建议做一些更通用的事情，比如有一个接口，它为你的游戏可能处于的任何状态定义通用方法，实际上看起来就像你前进的方向。这只会结合你的逻辑和渲染类。例如：

```
public Interface IGameState {

    public void update(int delta);

    public void render();
} 
```

然后你可以有一个实现该接口的类，例如：

```
public class InGameState implements IGameState {

    public InGameState() { }

    // This is similar to your Logic class
    public void update(int delta) {
        // Perform any updates necessary such as handling keyboard input
    }

    public void render() {
        // What you included in your example
        glClear(GL_COLOR_BUFFER_BIT);
        Primitives.DrawSquare(200, 200, 50, 50, 1, 0, 0);
    }

} 
```

然后你的主要方法可能看起来像这样：

```
public static final int WIDTH = 640;
public static final int HEIGHT = 480;
private static boolean isRunning = true;
private IGameState currentGameState;

public static void main(String[] args) {
    setUpDisplay();
    setUpOpenGL();
    Entity.setUpEntities();
    Timer.setUpTimer();
    // Create a new game state
    currentGameState = new InGameState();
    while (isRunning) {
        // Change to this type of thing
        // The delta would be the time since last frame so you can stay frame rate                       
        // independent
        currentGameState.update(delta);
        currentGameState.render();
        Display.update();
        Display.sync(60);
        if (Display.isCloseRequested()) {
            isRunning = false;
        }
    }
    Display.destroy();
    System.exit(0);
} 
```

# list - 循环遍历列表 Emacs 中的项目

> ID：14286743
> 
> 赞同：1
> 
> 时间：2013-01-11T21:14:54.027
> 
> 标签：list, function, emacs

假设我们有一个如下列表：

`("These" "Are "Some" "Words")`, 让我们称之为`listy`

如何在列表的每个项目上调用一个函数？

也许调用一个函数，如：

```
(defun messager (somelist) 
 (interactive)
 (message somelist)
) 
```

运行函数：

`(messager listy)`

我希望在缓冲区中看到列表中每个项目的单独行。

但是，不起作用的部分是循环或遍历列表中的项目。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-11T21:18:56.623

利用

```
(mapc 'messager listy) 
```

或者

```
(dolist (item listy)
  (messager item)) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-11T23:05:37.090

现在，我将再次进行自我广告：P 但希望我能在途中传达一些有用的信息：

```
;; Here is what `dolist' expands to:
(dolist (item listy)
  (messager item))

(identity
 (catch (quote --cl-block-nil--)
   (let ((--dolist-tail-- listy) item)
     (while --dolist-tail--
       (setq item (car --dolist-tail--))
       (messager item)
       (setq --dolist-tail-- (cdr --dolist-tail--))))))

;; And here is what `i-iterate' expands to:
(++ (for item in listy)
      (messager item))

(let* ((--0 listy) item)
  (while --0
    (setq item (car --0) --0 (cdr --0))
    (messager item))) 
```

一些评论：无论是否存在条件退出，`dolist`都会创建一个块，而只有在确定了这样的条件退出时才会尝试这样做。通常，在表单中执行代码会慢一些。`(catch ...)``i-iterate``(catch ...)`

此外，`dolist`会将代码包装到一个特殊的“块”中（这基本上只是对`identity`函数的调用。这也是一种杂乱无章的东西，这是默认设置，但并不总是需要。

现在，对于关于 的其他问题`alist`，您可以像这样使用`loop`宏：

```
(loop for (key . value) in '((a . b) (c . d)) do
      (message "key: %s -> value: %s" key value))
;; Which expands to:
(identity
 (catch (quote --cl-block-nil--)
   (let* ((--cl-var-- (quote ((a . b) (c . d)))) (value nil) (key nil))
     (while (consp --cl-var--)
       (setq value (car --cl-var--) 
             key (car (prog1 value (setq value (cdr value)))))
       (message "key: %s -> value: %s" key value)
       (setq --cl-var-- (cdr --cl-var--))) nil)))

;; Compared to i-iterate
(++ (for (key . value) in '((a . b) (c . d)))
  (message "key: %s -> value: %s" key value))
;; Which expands to:
(let* ((--0 (quote ((a . b) (c . d)))) value key)
  (while --0
    (setq key (caar --0) value (cdar --0) --0 (cdr --0))
    (message "key: %s -> value: %s" key value))) 
```

在这种特殊情况下，使用`pop`是不合理的。同样使用`(catch ...)`块（因为没有条件退出）。

哦，还有图书馆的链接：[http](http://code.google.com/p/i-iterate/) ://code.google.com/p/i-iterate/ :)

* * *

用于此目的的优点和缺点`mapc`： 高阶函数与现有函数很好地结合。因此，如果您已经有一个想要应用于每个元素的元素 - 这可能是解决问题的最佳方法。但是，如果您要创建一个函数只是为了将它与高阶函数一起使用 - 那么它很少有回报，因为您将创建一个“冗余”实例，否则您可以避免这种情况。并非总是如此，有时，尤其是与宏一起使用时，这可能是一个强大的工具，但就像您的情况一样，迭代似乎更适合。

# android - JSON 对象传递 WCF 和 Android

> ID：14286746
> 
> 赞同：0
> 
> 时间：2013-01-11T21:15:10.423
> 
> 标签：android, json, wcf, parsing, post

这是客户端 Android ***MainActivity.java***文件：

```
import java.io.BufferedReader;
import java.io.InputStreamReader;
import java.io.UnsupportedEncodingException;

import org.apache.http.HttpResponse;
import org.apache.http.client.methods.HttpPost;
import org.apache.http.entity.StringEntity;
import org.apache.http.impl.client.DefaultHttpClient;
import org.apache.http.message.BasicHeader;
import org.apache.http.protocol.HTTP;
import org.json.JSONException;
import org.json.JSONStringer;
import android.os.Bundle;
import android.app.Activity;
import android.util.Log;
import android.view.Menu;
import android.view.View;
import android.view.View.OnClickListener;
import android.widget.Button;
import android.widget.EditText;

public class MainActivity extends Activity {

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        Log.e("oncreate ", "girdi");
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_main);

        final EditText username = (EditText) findViewById(R.id.usernameEditText);

        final EditText password = (EditText) findViewById(R.id.passwordEditText);
        Button sendBtn = (Button) findViewById(R.id.sendBtn);

        sendBtn.setOnClickListener(new OnClickListener() {

            @Override
            public void onClick(View v) {
            HttpPost request = new HttpPost("http://10.0.2.2:8732/Design_Time_Addresses/MyWCFSolution/Service1/Check");
            request.setHeader("Accept", "application/json");
            request.setHeader("Content-type", "application/json");

            // Build JSON string
            JSONStringer userJson=null;
            try {
                userJson = new JSONStringer()
                    .object()
                       .key("user")
                          .object()
                         .key("Username").value(username.getText().toString())                                                                                                                                                        
                         .key("Password").value(password.getText().toString())                                                     
                         .key("Name").value(password.getText().toString())
                          .endObject()
                       .endObject();
                Log.e("json", "json created");
            } catch (JSONException e) {

                // TODO Auto-generated catch block
                e.printStackTrace();
            }

            StringEntity entity=null;
            try {
                entity = new StringEntity(userJson.toString(),"UTF-8");
            } catch (UnsupportedEncodingException e) {
                // TODO Auto-generated catch block
                e.printStackTrace();
            }                                                
            entity.setContentEncoding(new BasicHeader(HTTP.CONTENT_TYPE, "application/json"));
            entity.setContentType("application/json");

            request.setEntity(entity);

            // Send request to WCF service
            DefaultHttpClient httpClient = new DefaultHttpClient();

            try {
                Log.e("response", "connect");
                HttpResponse response = httpClient.execute(request);

                Log.e("response","response get"+response.toString());
                //System.out.println(response.toString());

                BufferedReader reader = new BufferedReader(new InputStreamReader(response.getEntity().getContent(), "UTF-8"));
                String json = reader.readLine();

                Log.e("json string","test "+json.toString()+" lazım");
                System.out.println(json);
                //JSONTokener tokener = new JSONTokener(json);
                //JSONArray finalResult = new JSONArray(tokener);

            }catch (Exception e){
                e.printStackTrace();
            }
        }

    });

    }
    @Override
    public boolean onCreateOptionsMenu(Menu menu) {
        // Inflate the menu; this adds items to the action bar if it is present.
        getMenuInflater().inflate(R.menu.activity_main, menu);
        return true;
    }

} 
```

***服务器端：***

***应用程序配置：***

```
 <?xml version="1.0"?>
        <configuration>

          <appSettings>
            <add key="aspnet:UseTaskFriendlySynchronizationContext" value="true"/>
          </appSettings>
          <system.web>
            <compilation debug="true"/>
          </system.web>
          <!-- When deploying the service library project, the content of the config file must be added to the host's 
          app.config file. System.Configuration does not support config files for libraries. -->
          <system.serviceModel>
             <services>
                 <service name="MyWCFSolution.Service1">
                     <endpoint address="" binding="wsHttpBinding" contract="MyWCFSolution.IService1">
                          <identity>
                              <dns value="localhost"/>
                          </identity>
                      </endpoint>
                      <endpoint address="mex" binding="mexHttpBinding" contract="IMetadataExchange"/>
                      <host>
                          <baseAddresses>
                              <add baseAddress="http://localhost:8732/Design_Time_Addresses/MyWCFSolution/Service1/"/>
                          </baseAddresses>
                      </host>
                 </service>
             </services>
             <behaviors>
                 <serviceBehaviors>
                      <behavior>
<!-- To avoid disclosing metadata information, 
set the value below to false and remove the metadata endpoint above before deployment -->
                          <serviceMetadata httpGetEnabled="True"/>
<!-- To receive exception details in faults for debugging purposes, 
set the value below to true. Set to false before deployment 
to avoid disclosing exception information -->
                          <serviceDebug includeExceptionDetailInFaults="False"/>
                      </behavior>
                 </serviceBehaviors>
             </behaviors>
        </system.serviceModel>
        <startup><supportedRuntime version="v4.0" sku=".NETFramework,Version=v4.0"/></startup></configuration> 
```

***服务.cs：***

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Runtime.Serialization;
using System.ServiceModel;
using System.Text;
using System.Web;
using System.Web.UI.WebControls;

namespace MyWCFSolution
{
    // NOTE: You can use the "Rename" command on the "Refactor" menu to change the class name "Service1" in both code and config file together.
    public class Service1 : IService1
    {
        public string CheckSQL(string getJSON)
        {
            string jsonConverted;
            System.Web.Script.Serialization.JavaScriptSerializer serialize = new System.Web.Script.Serialization.JavaScriptSerializer();

            User X = new User();
            User Y = new User();
            User Z = new User();
            opUser operate = new opUser();
            X.AutoID = 1;
            X.Name = "abc";
            X.Password = "12345";
            X.Surname = "ab";
            X.Username = "cde";
            jsonConverted = serialize.Serialize(X);
            Y = (User)serialize.Deserialize(jsonConverted, typeof(User));
            Z = operate.GetUser(Y);
            jsonConverted = serialize.Serialize(Z);
            return "asdf";
        }
    }
} 
```

***IService.cs：***

```
 using System;
    using System.Collections.Generic;
    using System.Linq;
    using System.Runtime.Serialization;
    using System.ServiceModel;
    using System.Text;
    using System.ServiceModel.Web;

    namespace MyWCFSolution
    {

        [ServiceContract]
        public interface IService1
        {
            [OperationContract]
            string CheckSQL(User user);

        }
    } 
```

***用户.cs：***

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Collections;

namespace MyWCFSolution
{

    public class User
    {
        private Int64 _AutoID;
        private string _Username;
        private string _Password;
        private string _Name;
        private string _Surname;

        public Int64 AutoID { get { return _AutoID; } set { _AutoID = value; } }
        public string Username { get { return _Username; } set { _Username = value; } }
        public string Password { get { return _Password; } set { _Password = value; } }
        public string Name { get { return _Name; } set { _Name = value; } }
        public string Surname { get { return _Surname; } set { _Surname = value; } }
    }

    public class UserList : CollectionBase
    {
        public User this[int index]
        {
            get { return this.List[index] as User; }
        }
        public void Add(User obj)
        {
            this.List.Add(obj);
        }
        public int IndexOf(User obj)
        {
            return this.List.IndexOf(obj);
        }
    }

} 
```

***opUser.cs：***

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Data.SqlClient;
using System.Data;

namespace MyWCFSolution
{
    public class opUser
    {
        public User GetUser(User UserD)
        {
            UserList Result = new UserList();
            System.Data.SqlClient.SqlConnection conn = Connection.ConnectToSql();
            User temp = new User();
            try
            {
                conn.Open();

                SqlCommand sqlCommSelect = new SqlCommand("dbo.spSelectUserByPassword", conn);
                sqlCommSelect.CommandType = CommandType.StoredProcedure;
                SqlParameter[] sqlParams = new SqlParameter[] { 
                    new SqlParameter("@Username",UserD.Username ),                   
                    new SqlParameter("@Password",UserD.Password )
                };
                sqlCommSelect.Parameters.AddRange(sqlParams);

                SqlDataReader dr = sqlCommSelect.ExecuteReader();

                while (dr.Read())
                {
                    temp.Name = Convert.ToString(dr["Name"]);
                    temp.Surname = Convert.ToString(dr["Surname"]);

                }
                dr.Close();
                conn.Close();

            }
            catch (Exception exx)
            {
                conn.Close();
                Result = null;

            }
            return temp;
        }

    }
} 
```

***这是用于运行 Android 应用程序的 Eclipse 中的 LogCat：***

01-11 22:50:43.344: E/oncreate(457): girdi 01-11 22:50:48.955: W/KeyCharacterMap(457): 没有 id 0 的键盘 01-11 22:50:48.955: W/KeyCharacterMap (457): 使用默认键盘映射: /system/usr/keychars/qwerty.kcm.bin 01-11 22:50:50.935: E/json(457): json created 01-11 22:50:50.944: E/response (457): 连接 01-11 22:50:51.164: E/response(457): response getorg.apache.http.message.BasicHttpResponse@405722d0 01-11 22:50:51.174: W/System.err(457) : java.lang.NullPointerException 01-11 22:50:51.184: W/System.err(457): at com.example.logapp.MainActivity$1.onClick(MainActivity.java:95) 01-11 22:50:51.184 : W/System.err(457): 在 android.view.View.performClick(View.java:2485) 01-11 22:50:51.184: W/System.err(457): 在 android.view.View。 onKeyUp(View.java:4257) 01-11 22:50:51.184: W/System.err(457): 在 android.widget.TextView.onKeyUp(TextView.java:4566) 01-11 22:50:51。184: W/System.err(457): 在 android.view.KeyEvent.dispatch(KeyEvent.java:1280) 01-11 22:50:51.184: W/System.err(457): 在 android.view.View .dispatchKeyEvent(View.java:3855) 01-11 22:50:51.184: W/System.err(457): 在 android.view.ViewGroup.dispatchKeyEvent(ViewGroup.java:789) 01-11 22:50:51.184 : W/System.err(457): 在 android.view.ViewGroup.dispatchKeyEvent(ViewGroup.java:789) 01-11 22:50:51.184: W/System.err(457): 在 android.view.ViewGroup。 dispatchKeyEvent(ViewGroup.java:789) 01-11 22:50:51.194: W/System.err(457): 在 android.view.ViewGroup.dispatchKeyEvent(ViewGroup.java:789) 01-11 22:50:51.194: W/System.err(457): 在 com.android.internal.policy.impl.PhoneWindow$DecorView.superDispatchKeyEvent(PhoneWindow.java:1687) 01-11 22:50:51.194: W/System.err(457):在 com.android.internal.policy.impl.PhoneWindow.superDispatchKeyEvent(PhoneWindow.java:1120) 01-11 22:50:51.194: W/System.err(457): 在 android.app.Activity.dispatchKeyEvent(Activity.java:2073) 01-11 22:50:51.194: W/System.err( 457): 在 com.android.internal.policy.impl.PhoneWindow$DecorView.dispatchKeyEvent(PhoneWindow.java:1663) 01-11 22:50:51.194: W/System.err(457): 在 android.view.ViewRoot .deliverKeyEventToViewHierarchy(ViewRoot.java:2560) 01-11 22:50:51.194: W/System.err(457): 在 android.view.ViewRoot.handleFinishedEvent(ViewRoot.java:2535) 01-11 22:50:51.204 : W/System.err(457): 在 android.view.ViewRoot.handleMessage(ViewRoot.java:1867) 01-11 22:50:51.204: W/System.err(457): 在 android.os.Handler。 dispatchMessage(Handler.java:99) 01-11 22:50:51.204: W/System.err(457): 在 android.os.Looper.loop(Looper.java:123) 01-11 22:50:51.204: W/System.err(457): 在 android.app.ActivityThread.main(ActivityThread.java:3683) 01-11 22:50:51.204:W/System.err(457): 在 java.lang.reflect.Method.invokeNative(Native Method) 01-11 22:50:51.204: W/System.err(457): 在 java.lang.reflect.Method。调用（Method.java:507）01-11 22:50:51.215：W/System.err（457）：在 com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run（ZygoteInit.java:839）01-11 22:50:51.215: W/System.err(457): 在 com.android.internal.os.ZygoteInit.main(ZygoteInit.java:597) 01-11 22:50:51.215: W/System.err(457 ): 在 dalvik.system.NativeStart.main(Native Method)java:597) 01-11 22:50:51.215: W/System.err(457): 在 dalvik.system.NativeStart.main(Native Method)java:597) 01-11 22:50:51.215: W/System.err(457): 在 dalvik.system.NativeStart.main(Native Method)

HTTP 正在执行。我的意思是，响应来自服务器，但我无法获取 JSON 数据。我尝试使用`System.out.print`但没有工作来编写 json 数据。Http 连接正常，但无法获取 JSON。为什么会这样？我在这个异常上工作了几天，但没有找到。有人知道吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-11T21:20:19.520

下面一行的输出是什么，

```
 Log.e("response","response get"+response.toString()); 
```

...只需检查http请求的responseCode，如果reponseCode是200，那么你很好，

```
 HttpResponse response = client.execute(httpGet);
      StatusLine statusLine = response.getStatusLine();
      int statusCode = statusLine.getStatusCode();
      if (statusCode == 200) {
        HttpEntity entity = response.getEntity();
        InputStream content = entity.getContent();
        BufferedReader reader = new BufferedReader(new InputStreamReader(content));
        String line;
        while ((line = reader.readLine()) != null) {
          builder.append(line);
        }
      } else {
        Log.e(ParseJSON.class.toString(), "Failed to download file");
      } 
```

我相信响应代码可能会有所不同，这就是您没有看到 json 响应的原因

# ruby - 如何调整外部图像的大小并即时提供它们？

> ID：14286762
> 
> 赞同：2
> 
> 时间：2013-01-11T21:16:11.923
> 
> 标签：ruby, image, sinatra

我有一个从 API 获取图像 url 的 sinatra 应用程序，我想缩放它们然后提供它们而不将它们存储在服务器上。我见过的大多数 gem 只获取本地图像，然后在队列中处理每个图像。我只需要缩放五个图像并将它们显示在页面上。有没有快速的方法来做到这一点？

更多说明：

我需要一种从外部获取图像的方法（例如 notmysite.com/img.jpg），并让代码在页面上提供缩放图像。我不能用 css 或其他前端方法来做到这一点，因为这个页面将由一个脚本渲染，该脚本会扭曲前端缩放的图像。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-12T00:13:43.140

Dragonfly 使用 imagemagick 来缩放图像。这是我从以前用[MiniMagick](http://rubygems.org/gems/mini_magick)完成的东西中拼凑出来的一些代码，所以它会非常相似。

将自己的文件放入[Tempfile](http://www.ruby-doc.org/stdlib-1.9.3/libdoc/tempfile/rdoc/Tempfile.html)。[我在这里用Faraday](http://rubygems.org/gems/faraday)和[Typheous](http://rubygems.org/gems/typhoeus)做过这个。然后使用魔法对其进行缩放！

```
require 'faraday'
require 'faraday_middleware'
#require 'faraday/adapter/typhoeus' # see https://github.com/typhoeus/typhoeus/issues/226#issuecomment-9919517 if you get a problem with the requiring
require 'typhoeus/adapters/faraday'

configure do
  Faraday.default_connection = Faraday::Connection.new( 
    :headers => { :accept =>  'image/*',
    :user_agent => "Sinatra via Faraday"}
  ) do |conn|
    conn.use Faraday::Adapter::Typhoeus
  end
end

helpers do
  def grab_image_and_scale
    response = Faraday.get url # you'll need to supply this variable somehow, your choice
    filename = "SOMETHING.jpg"
    tempfile = Tempfile.open(filename, 'wb') { |fp| fp.write(response.body) }

    thumb = MiniMagick::Image.open( tempfile.path )
    thumb.thumbnail( "75x75" )
    thumb.write( File.join settings.public, "images", "thumb_#{filename}") 

    scaled = MiniMagick::Image.open( secure_path )
    scaled.resize( "600" )
    scaled.write( File.join settings.public, "images", "scaled_#{filename}")
  end
end 
```

我将留给您解决如何将公共图像文件夹的路径更改为临时文件（如果您分享它是如何完成的，那就太好了：）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-11T21:24:49.883

一种与 Ruby 或 sinatra 无关的方法是向HTML 标记添加`width`和`height`属性。`img`你最终会得到这样的东西：

```
<img src="img.source.from.API.JPG" width="2000px" height="100px" /> 
```

### 编辑

另一种方法是使用 javascript 更改维度，如下所示：[https](https://stackoverflow.com/a/11333825/693597) ://stackoverflow.com/a/11333825/693597 。您可能会考虑编写 JS 文件并将其包含在 HTML 的标头中。

# ruby - scrapi 没有看到整洁的库

> ID：14286765
> 
> 赞同：0
> 
> 时间：2013-01-11T21:16:25.183
> 
> 标签：ruby, windows-7, tidy

我有一个简单的 ruby​​ 文件，可以从沃尔玛的网站上取消价格。我做了一个 gem install scrapi 和一个 gem install tidy。当我在 Windows 7 机器上运行代码时，出现以下错误：

## 错误

```
c:/Ruby193/lib/ruby/gems/1.9.1/gems/scrapi-2.0.0/lib/scraper/reader.rb:216:in `r escue in parse_page': Scraper::Reader::HTMLParseError: didn't find tidy libs on your system. Please install tidy (http://tidy.sourceforge.net/) (Scraper::Reader ::HTMLParseError) 
```

它似乎找不到整洁的库，所以我把它放在我的路径中：

路径=C:\Ruby193\lib\ruby\gems\1.9.1\gems\tidy_ffi-0.1.5\lib;C:\Ruby193\lib\ruby\gems\1.9.1\gems\tidy-1.1.2\库

但它仍然抛出同样的找不到整洁的库错误。

在此先感谢您的帮助。

## 代码

```
require 'rubygems'
require 'scrapi'
require 'tidy'

scraper = Scraper.define do
process "div.firstRow div.priceAvail>div>div.PriceCompare>div.BodyS", :price => :text
result :price
end

url = URI.parse("http://www.walmart.com/search/search-ng.do?search_constraint=0&ic=48_0&search_query=LOST+third+season&Find.x=17&Find.y=1&Find=Find")
puts scraper.scrape(url) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-29T20:43:03.650

我有完全相同的问题，但在 Linux 上。

这与 reader.rb 中的 find_tidy 函数有关 - 不知何故，它无法找到库。我刚刚去评论了那条线，现在它工作正常。

```
 # Make sure the Tidy path is set and always apply the default
      # options (these only control things like errors, output type).
      # find_tidy
      options = (options || {}).update(TIDY_OPTIONS) 
```

如果您确定系统中有整洁的库，请尝试一下。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-07-31T11:03:10.117

我在mac上遇到了同样的问题。

攻击性代码位于 reader.rb 文件的第 204 行。在您喜欢的编辑器中打开它：

`atom /usr/local/lib/ruby/gems/2.2.0/gems/scrapi-2.0.0/lib/scraper/reader.rb`

就像前面的答案说的那样把它注释掉。之后效果很好。

# android - 我的 MenuItem 的 getActionView() 返回 null

> ID：14286768
> 
> 赞同：53
> 
> 时间：2013-01-11T21:16:37.557
> 
> 标签：android, view, null, android-actionbar

我只想通过代码调整 ActionBar MenuItem 的视图。

不幸的是，似乎 getActionView 总是返回 null！

我的代码：

```
@Override
public boolean onCreateOptionsMenu(Menu menu) {
    MenuInflater inflater = this.getSupportMenuInflater();
    inflater.inflate(R.menu.folder, menu);
    return super.onCreateOptionsMenu(menu);

}

public boolean onPrepareOptionsMenu(final Menu menu) {
    MenuItem menuFolder = menu.findItem(R.id.menu_folder);
    Log.i("", "* onPrepareOptionsMenu *" + menuFolder);
    Log.i("", "* getActionView *" + menuFolder.getActionView()); 
```

日志是：

> 01-11 22:13:42.884: I/(7893): * onPrepareOptionsMenu *com.actionbarsherlock.internal.view.menu.MenuItemWrapper@41401ac8
> 
> 01-11 22:13:42.884: I/(7893): * getActionView *null

非常感谢您的帮助

编辑：

```
<?xml version="1.0" encoding="utf-8"?>
<menu xmlns:android="http://schemas.android.com/apk/res/android" >

    <item 
          android:id="@+id/menu_folder"
          android:icon="@drawable/ic_menu_archive"
          android:showAsAction="always"/>
</menu> 
```

* * *

## 回答 #1

> 赞同：84
> 
> 时间：2016-02-20T05:03:16.270

你应该使用

```
app:actionLayout="@layout/menu_actionbar_basket" 
```

如果你使用这就是诀窍

```
android:actionLayout="@layout/menu_actionbar_basket" 
```

你总是会在默认工具栏中得到空异常。

* * *

## 回答 #2

> 赞同：39
> 
> 时间：2013-01-11T21:19:50.190

`getActionView()`仅在有来自的自定义 actionView 时才有效`setActionView`。

* * *

## 回答 #3

> 赞同：33
> 
> 时间：2015-05-02T21:44:42.517

对我来说，有效的解决方案是使用**app**命名空间而不是 android。

`app:actionViewClass="android.support.v7.widget.SearchView"`

不要忘记声明它： `xmlns:app="http://schemas.android.com/apk/res-auto"`

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2020-09-13T16:52:14.217

****第一个解决方案****

这可能是你没有在菜单文件中设置**actionLayout**所以在菜单文件中设置你的**actionLayout**

`app:actionLayout="@layout/your_action_layout"`

****第二个解决方案**** ，第二个解决方案是

****从****

`android:actionLayout="@layout/your_action_layout"`

**到**

`app:actionLayout="@layout/your_action_layout"`

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2017-03-06T08:47:39.107

如果您的调试版本正常工作并且问题仅与发布版本有关，那么这可能是因为 proguard 配置。如果您在应用程序中启用了 proguard，则将以下行添加到 proguard-rules.pro

```
-keep class android.support.v7.widget.SearchView { *; } 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2022-01-10T13:36:39.180

为了获得我使用的 MenuItem 视图：

```
@Override
public boolean onOptionsItemSelected(MenuItem item) {

    switch (item.getItemId()) {
        case R.id.someMenuItem:

            View v = findViewById(R.id.someMenuItem);
            doSomethingWithView(v);

            break;
    }

    return super.onOptionsItemSelected(item);
} 
```

# ios - Storyboard UIView 在滚动时切断对象

> ID：14286778
> 
> 赞同：0
> 
> 时间：2013-01-11T21:17:28.623
> 
> 标签：ios, uiview, storyboard, xcode4.5

使用 Storyboards，我有一个嵌入了 UIView 的滚动视图。在那个 UIView 我有一些文本和一个按钮。对于这个问题，按钮向下一点。

当我在模拟器和设备上滚动时，UIView 在按钮所在的位置被切断。（那里的按钮显示切断）

![在此处输入图像描述](../Images/e30a16ad137db30601afe0a80f53c942.png)

上图是滚动前。

![在此处输入图像描述](../Images/9f1fe885321ab65d970fdec47cca91f4.png)

这张图片显示了滚动 UIView 和嵌入其中的按钮被切断。

我已将 Size Inspector 设置为 1000 高度。

我在 stackoverflow 上搜索过，目前还没有找到答案。

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-12T01:53:47.120

我正在开发的应用程序中遇到了同样的问题。出于某种原因，它也对我不起作用。我建议您尝试以编程方式创建滚动视图和其中的视图，而不是为这个特定的视图控制器创建故事板。它会像魅力一样工作。您还必须找到内部视图的长度，然后将滚动视图的大小设置为嵌入其中的视图的大小。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-11T21:31:07.873

看起来这个特定窗口的层次结构没有正确排序。您需要重新排列层次结构。为此，请转到您的故事板，然后单击左下角的小按钮，该按钮看起来像播放按钮，周围有一个框。从那里，你可以调整。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-12T23:43:00.323

我想到了。不确定这是首选方法还是只是一种解决方法。

![在此处输入图像描述](../Images/0d97afee3818f4ca077abb1151734965.png)

![在此处输入图像描述](../Images/ddb17681fbc2102b7a72c86d574e112f.png)

![在此处输入图像描述](../Images/d17fd9f0a563d2a6688819e440267d6e.png)

主要区别是我连接了最后一个 ScrollView，而不是第一个。不知道为什么，但它有效。

![在此处输入图像描述](../Images/927d192f62303163b2b1e9b2cc9b63b7.png) ![在此处输入图像描述](../Images/c71d0f74d1f501dbd7f96dfe0a082091.png)

之前，（上面的原始帖子中带有切断按钮的图片），它会切断我的 UIView。我仍然想知道“为什么”它会这样做。谢谢你的回复。

# javascript - 如何设置 JavaScript 对象的类

> ID：14286787
> 
> 赞同：1
> 
> 时间：2013-01-11T21:17:52.533
> 
> 标签：javascript

我考虑使用保存对象`JSON.stringify`，然后再次加载它们。“字符串化”当然效果很好，但是我不确定如何设置对象的原型/类。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-11T21:31:34.147

您可以使用`.toJSON`和 reviver 回调来实现此目的。

这是方案：

```
function Person() {
    this.name = "name";
    this.age = "age";
}

Person.prototype.toJSON = function() {
            //Define this for other classes as well
    return {__class__: "Person", name: this.name, age: this.age};
};

function reviver( key, value ) {
        if( typeof value == "object" && value.__class__ ) {
            var ret = new window[value.__class__];
            for( var k in value ) {
                if( k === "__class__" ) continue;
                ret[k] = value[k];
            }
            return ret;
        }
        return value;
}

var a = new Person(),
    b = new Person();

var json = JSON.stringify( [a,b] );

var decoded = JSON.parse( json, reviver);

console.log( decoded ); //[Person, Person] I.E. array of Person instances instead of plain objects 
```

在这个简化的方案中，类必须是全局的。

# python - 将 QLineEdit 文本转换为浮点数 - PySide/pyQt4

> ID：14286791
> 
> 赞同：2
> 
> 时间：2013-01-11T21:18:23.120
> 
> 标签：python, python-2.7, qt4, pyside

如何将 LineEdit 小部件中的数字转换为浮点数？

说我有：

```
textfield = QtGui.QLineEdit(self) 
```

用户在其中输入 12345.2。我希望将其转换为浮点数并存储在变量 X 中。我该怎么做？

我尝试了下面的代码，它不起作用。

```
INPUT = textfield.text
INPUT2 = float(INPUT) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-11T21:35:22.310

[`text`](http://doc.qt.digia.com/qt/qlineedit.html#text-prop)是方法的名称。您应该调用它来获取`QLineEdit`.

```
INPUT = textfield.text()
INPUT2 = float(INPUT) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-11T21:22:05.010

试试： INPUT2 = 浮点数（输入）

你有 INPUT2 你应该有 INPUT

# ios - 如何设置子视图的框架

> ID：14286796
> 
> 赞同：1
> 
> 时间：2013-01-11T21:18:36.593
> 
> 标签：ios, uiview, storyboard

我在 a 下有一个视图层次结构，`UIViewController`它由一个主视图和几个主视图的子视图组成，全部在故事板中定义，并且全部使用 IBOutlet 连接。

我想设置子视图相对于主视图的位置和大小。

我已经尝试将它们设置为`viewDidLoad`and `viewWillAppear`。两者都不起作用，并且在调用时，主视图具有有效的帧值，但子视图都具有 (0,0,0,0) 的帧。

如果我什么都不做，子视图会出现在故事​​板上的确切位置。我需要使下面的代码工作，但我不知道把它放在哪里。

```
CGRect newFrame = CGRectMake(10,10,50,50);
[subView setFrame:newFrame]; 
```

提出这个问题的另一种方式：
故事板子视图的框架在何时何地设置？
或者，我应该只用代码创建所有子视图吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2015-01-23T07:13:08.937

when using autolayout you can set frame of the views (if the frame is calculated from super view's frame) in viewDidLayoutSubviews method or the other way I use is calling this method `[view setTranslatesAutoresizingMaskIntoConstraints:YES];` and then `[view setFrame:...];`. Hope this helps.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-14T04:24:53.097

当 UIViewController 调用 viewDidAppear 时可以设置子视图的位置和大小，但这会导致演示文稿跳转。在 viewDid/WillLayoutSubviews 中设置 UITableView 的位置和大小不起作用。

# object - 添加到画布后随着时间的推移淡化/更改 SVG 形状的颜色？

> ID：14286804
> 
> 赞同：0
> 
> 时间：2013-01-11T21:19:00.493
> 
> 标签：object, svg, shapes

我创建了一个 SVG 地图，可以实时绘制包含特定关键字的推文。我将每条推文以圆圈（或点）的形式绘制到屏幕上，在将 50 条推文添加到地图后，最旧的推文将消失。

![在此处输入图像描述](../Images/5b74cd502eb58e40f745833e11d7e5a9.png)

**我想根据圆圈在地图上的时间长短对圆圈进行某种颜色衰减。**

新的推文会出现在地图上并显示为红色。随着时间的推移，地图上已经绘制的点会慢慢变黑。

这是我将圆圈添加到地图的位置：

```
function mapTweet(tweetData) {
    var tipText; // Ignore this. For tweet dot hovering.
    var coordinates = projection([tweetData.geo.coordinates[1], tweetData.geo.coordinates[0]]);

    addCircle(coordinates, tipText);
}

function addCircle(coordinates, tipText, r) {
    tweetNumber++;

    // too many tweets
    if (tweetNumber == 50) {
        tweetNumber = 0;
    }

    //removes expired circles 
    $('#' + tweetNumber).remove();

    var rad;

    //determine if radius size needs to be bumped
    if (arguments.length == 3) {
        rad = r;
    } else {
        rad = 3;
    }

    // add radar-style ping effect
    map.append('svg:circle')
        .style("stroke", "rgba(255,49,49,.7)")
        .style("stroke-width", 1)
        .style("fill", "rgba(0,0,0,0)")
        .attr('cx', coordinates[0])
        .attr('cy', coordinates[1])
        .attr('r', 3)
        .transition()
        .delay(0)
        .duration(2000)
        .attr("r", 60)
        .style("stroke-width", 2)
        .style("stroke", "rgba(255,49,49,0.0001)").transition().duration(2000).remove();

    // add circles representing tweets
    map.append('svg:circle').attr("class", "tweetCircles")
        .attr("id", tweetNumber)
        .style("stroke", "rgba(255,49,49,.7)")
        .style("stroke-width", 1)
        .style("fill", "rgba(240,49,49,1)")
        .attr('cx', coordinates[0])
        .attr('cy', coordinates[1])
        .attr('r', rad);

    addTipsy(tipText, tweetNumber); // Ignore this. For tweet dot hovering.
} 
```

一旦画了一个圆圈，是否必须重新绘制它才能改变颜色？或者点可以在添加到画布后改变它们的属性吗？

我怎样才能在 20 秒内衰减颜色？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-11T22:32:35.633

附加一个[动画](http://www.w3.org/TR/SVG/animate.html#AnimateElement)元素作为圆的子元素

```
.append('svg:animate')
  .attr('attributeName', 'fill')
  .attr('from', 'red')
  .attr('to', 'blue')
  .attr('dur', '20s'); 
```

这将从红色插入到蓝色或您选择的任何颜色。

# python - 如何加入具有不同索引的两个数据框（熊猫）？

> ID：14286807
> 
> 赞同：2
> 
> 时间：2013-01-11T21:19:06.740
> 
> 标签：python, pandas

我正在研究一种将序列/基因型数据从 csv 格式转换为genepop 格式的方法。

我有两个数据框：`df1`是空的，`df1.index`(rows = samples) 由几乎相同的组成`df2.index`，除了我在几个地方插入了“POP”（以指定不同的人口）。`df2`保存数据，`Loci`作为列。

我想将值插入`df2`到`df1`中，在其中保留空行`df1.index = 'POP'`。

我尝试了`join`、和`combine`，但它们似乎都采用了两个 df 中存在的行。`combine_first``concat`

有没有办法做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-12T03:06:57.643

听起来你想要一个“外部” `join`：

```
df1.join(df2, how='outer') 
```

# android - 如何使用 Ant 构建多个具有相同代码库但资源文件不同的 Android APK？

> ID：14286819
> 
> 赞同：2
> 
> 时间：2013-01-11T21:19:51.017
> 
> 标签：android, ant, build

我正在尝试构建一个品牌的 Android 应用程序，该应用程序将为不同的客户提供不同的资源文件（主要是 drawables）。应用程序中的 Java 代码是相同的，但不同的应用程序会有不同的外观——意味着不同的配色方案和不同的徽标等。有人告诉我，我的研究表明 Ant 是实现这一目标的最佳方式。

我应该在哪里更改 Android 'build.xml' 文件？我应该使用什么样的 Ant 任务来实现这一点？

对于调试，我只想使用 Eclipse 并使用默认资源进行构建。但是对于生产版本，我想在 build.xml 上运行 Ant 以从不同的 /res 文件夹生成多个 APK。我什至不需要任何代码片段（尽管那会很好），甚至需要一些以前做过的人的提示或类似的东西。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-05-15T19:33:33.890

我最终编写了一个 Python 脚本来在每次构建之前重新组织 Android 项目。我建议避免将 Ant 用于此类事情。除了默认的 Android build.xml Ant 脚本之外，我的 100-200 行 Python 相当于增加了大约 1000 多行 Ant。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-11T21:30:26.807

我遇到了类似的问题，我想通过一些更改以及资源文件中的更改来编译相同的代码库。我目前追求的解决方案是为每个不同的 APK 版本创建一个包含共享代码/资源和单独的“常规”项目的库。不幸的是，我还没有一个功能性的最终解决方案，所以我只能给出这些模糊的提示。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-01-11T21:37:53.907

需求设置

**1.**转到网址：

[http://ant.apache.org/bindownload.cgi](http://ant.apache.org/bindownload.cgi)

并下载 apache ant 并将其解压缩到 d:/ant 之类的任何文件夹中。

**2.**我想你已经有了Android SDK路径就像(D:/Android SDK/)

现在转到环境变量并检查路径变量是否存在，将这些添加到路径中，否则创建一个名为路径的新变量并将其放在 vaue 中

**D:/ant/bin;D:/Android SDK/工具**

完毕

转到命令提示符并将其导航到项目的根目录并运行命令

```
android update project -p / 
```

*注意：/ 如果您在项目的根目录中，则需要提供根目录的路径，例如 d:/myworkspace/mysampleproject*

这将在您的项目中生成 build.xml 文件。

现在为此运行命令，它必须位于项目的根目录中

```
ant debug 
```

这将在 bin 文件夹中生成一个使用默认调试密钥签名的 apk 文件。

# sql - Perl 重写 SQL 日期格式

> ID：14286821
> 
> 赞同：1
> 
> 时间：2013-01-11T21:20:01.583
> 
> 标签：sql, perl, date, datetime, datetime-format

当我直接在 SQL 服务器上查询数据源时，会以如下所示的格式返回日期和时间戳列。

```
2011-05-26 16:19:20
2013-01-10 15:20:35
2008-01-10 14:51:01
2013-01-10 17:40:31
2008-03-26 18:23:20
2010-03-04 16:18:14 
```

但是，当我在 perl 脚本中查询相同的数据源并将结果写入 .txt 文件时，日期格式如下所示。

```
Jun 14 2011 10:49AM
Jun 17 2010 04:23PM
Aug 13 2010 08:28AM
Jun 18 2007 08:41AM
Jul 26 2012 07:18PM
Jun 11 2010 11:37AM
Aug 20 2010 09:28AM 
```

SQL查询：

```
SELECT TOP 100 PERCENT UserNM AS [User ID], MAX(EventDT) AS [Last Login Date]
FROM    dbo.WFEventLog
GROUP BY UserNM
ORDER BY UserNM 
```

写入文件的脚本部分：

```
open(FILE, ">cleanup.txt") || die "$!\n";

    while( my $hash_ref = $sth->fetchrow_hashref ){

        my $userid = "$hash_ref->{'UserID'}";
        my $logindt = "$hash_ref->{'Last Login Date'}";

            # dump all registered users into .csv file
            print FILE "$userid \t $logindt\n";

    }

close(FILE); 
```

我正在寻找的是要写入文件的 SQL 结果的确切格式。出于某种原因，在此之前发生了我不想要的重新格式化。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-11T22:34:56.810

如果您使用的是 DBD::Sysbase 然后引用[文档](http://search.cpan.org/~mewp/DBD-Sybase-1.14/Sybase.pm)：

控制 DATETIME 输出格式 ^

默认情况下，DBD::Sybase 将以 1998 年 11 月 15 日上午 11:13 格式返回 DATETIME 和 SMALLDATETIME 列。这可以通过私有 syb_date_fmt() 方法进行更改。

语法是

```
$dbh->syb_date_fmt($fmt); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-11T21:27:19.870

我假设您希望它们具有相同的格式。我会先看看数据库是否会为您格式化，但由于我不知道您正在处理什么数据库，perl 有几个模块可以用于此目的。它们的祖父是[Date::Manip](http://search.cpan.org/~sbeck/Date-Manip-6.38/lib/Date/Manip.pod)。要将日期格式化为数据库输出的格式，您将：

```
UnixDate(ParseDate($in), '%Y-%m-%d %H:%M:%S'; 
```

# javascript - 在 Firefox 中自动评估特定 URI 上的本地脚本

> ID：14286830
> 
> 赞同：0
> 
> 时间：2013-01-11T21:20:48.477
> 
> 标签：javascript, firefox, firefox-addon

我想通过使用我自己的 javascript 来改进现有的网站（我无法访问）。

这意味着我必须在 <head> 中添加一个 <script>。我目前正在通过单击一个书签来执行此操作，该书签的目标是这样的：

```
javascript: if(document.createElement){
    void(head=document.getElementsByTagName('head').item(0));
    void(script=document.createElement('script'));
    void(script.src='http://local/script.js');
    void(script.type='text/javascript');
    void(head.appendChild(script));
} // i added some spacer to make it readable 
```

这很好用，但是由于我有很多不同的脚本，因此组织它们变得很复杂。如果 top.location.href 匹配给定的字符串，我现在正在寻找一种方法来自动插入定义的 script-uri。有没有办法 Firefox 可以做这样的事情 - 也许在附加组件的帮助下？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-11T21:41:04.563

[用户脚本](https://userscripts.org/about/installing)是您正在寻找的。使用[Greasemonkey for Firefox](https://addons.mozilla.org/en-US/firefox/addon/greasemonkey/)在特定站点上运行您自己的脚本。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-13T16:39:42.133

[https://addons.mozilla.org/en-US/developers/docs/sdk/1.12/modules/sdk/page-mod.html](https://addons.mozilla.org/en-US/developers/docs/sdk/1.12/modules/sdk/page-mod.html)使用附加 sdk，并准确提供您正在寻找的内容（即如果脚本与给定域匹配，则将脚本附加到网页的简单方法）。这使您可以选择轻松地使您的插件成为独立插件；此外，如果您要显着扩展其功能，插件 sdk 肯定是要走的路！

# magento - Magento - 过滤具有特定客户组价格集的产品（按组代码，而不是 id）

> ID：14286832
> 
> 赞同：2
> 
> 时间：2013-01-11T21:20:57.593
> 
> 标签：magento

我正在寻找那些`group_price`在产品级别设置并分配给特定客户组的产品来过滤产品列表。

我在想它会是这样的：

```
$products->addFieldToFilter('group_price', array(
        array(
            'cust_group' => 2
        )
    )); 
```

但它似乎`group_price`不是一个属性。此外，`$_product->getGroupPrice()`无论是否在产品上设置了团体价格，始终返回产品的价格。

理想情况下，我更喜欢按客户组代码（即批发、零售等）而不是组 ID 过滤这些（仅适用于有人可能删除客户组并稍后重新创建它并且 ID 更改的情况）。

有什么想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2015-11-29T14:10:34.163

我有类似的要求，但问题是迭代大型产品集合太慢了。

该`catalog_product_index_price`表包含组信息，因此您可以尝试以下操作：

```
$productCollection = Mage::getModel('catalog/product')->getCollection();
...
$productCollection->addFinalPrice();
$productCollection->getSelect()->where(
    'price_index.customer_group_id = ? AND price_index.group_price IS NOT NULL',
    $customer_group_id
); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-12T05:34:06.250

我最终使用了这个：

```
 $products = Mage::getModel('catalog/product')->getResourceCollection();
    $products
        ->addAttributeToSelect('*')
        ->addAttributeToFilter('visibility', array('neq' => 1));

    foreach ($products as $product => $value) {

        //still not sure how to get 'group_price' without running load() =(
        $productModel = Mage::getModel('catalog/product')->load($value->getId());
        $groupPrices = $productModel->getData('group_price');

        // A helper of mine
        // store the customer's groupId to compare against available group prices array below.
        $currentGroupId = Mage::helper('user')->getCustomerGroup()->getId();

        // remove products w/o configured group prices
        if (!count($groupPrices)) {
            $products->removeItemByKey($product);
        }
        foreach ($groupPrices as $key) {
            foreach ($key as $subkey => $value) {
                if ($subkey == "cust_group") {
                    $customerGroup = $subkey;
                    if ($value != $currentGroupId) {
                        $products->removeItemByKey($product);
                    }
                }
            }
        }
    };

    $this->_productCollection = $products;
    return $this->_productCollection; 
```

# c++ - 如何检测给定的 PIDL 是否实际上是 .zip 文件或类似文件？

> ID：14286833
> 
> 赞同：2
> 
> 时间：2013-01-11T21:21:00.530
> 
> 标签：c++, mfc, visual-studio-2012, windows-shell

VS2010 引入了 CMFCShellTreeCtrl，它允许将文件夹浏览器树 ctrl 拖放到我们的 MFC 应用程序中。

但是，这个类似乎严重缺乏过滤能力。即它将构建容器对象列表（IShellFolder）。但似乎没有办法指定 .zip 容器不应显示在文件夹树中。

它确实提供了一个可以*粗略地*用于此目的的虚拟：

> ```
> HRESULT CMFCShellTreeCtrl::EnumObjects(HTREEITEM hParentItem, LPSHELLFOLDER pParentFolder, LPITEMIDLIST pidlParent)
> {
>   ASSERT_VALID(this);
>   ASSERT_VALID(afxShellManager);
> 
>   LPENUMIDLIST pEnum = NULL;
> 
>   HRESULT hr = pParentFolder->EnumObjects(NULL, m_dwFlags, &pEnum);
>   if (FAILED(hr) || pEnum == NULL)
>   {
>       return hr;
>   }
> 
>   LPITEMIDLIST pidlTemp;
>   DWORD dwFetched = 1;
> 
>   // Enumerate the item's PIDLs:
>   while (SUCCEEDED(pEnum->Next(1, &pidlTemp, &dwFetched)) && dwFetched)
>   {
>       TVITEM tvItem;
>       ZeroMemory(&tvItem, sizeof(tvItem));
> 
>       // Fill in the TV_ITEM structure for this item:
>       tvItem.mask = TVIF_PARAM | TVIF_TEXT | TVIF_IMAGE | TVIF_SELECTEDIMAGE | TVIF_CHILDREN;
> 
>       // AddRef the parent folder so it's pointer stays valid:
>       pParentFolder->AddRef();
> 
>       // Put the private information in the lParam:
>       LPAFX_SHELLITEMINFO pItem = (LPAFX_SHELLITEMINFO)GlobalAlloc(GPTR, sizeof(AFX_SHELLITEMINFO));
>       ENSURE(pItem != NULL);
> 
>       pItem->pidlRel = pidlTemp;
>       pItem->pidlFQ = afxShellManager->ConcatenateItem(pidlParent, pidlTemp);
> 
>       pItem->pParentFolder = pParentFolder;
>       tvItem.lParam = (LPARAM)pItem;
> 
>       CString strItem = OnGetItemText(pItem);
>       tvItem.pszText = strItem.GetBuffer(strItem.GetLength());
>       tvItem.iImage = OnGetItemIcon(pItem, FALSE);
>       tvItem.iSelectedImage = OnGetItemIcon(pItem, TRUE);
> 
>       // Determine if the item has children:
>       DWORD dwAttribs = SFGAO_HASSUBFOLDER | SFGAO_FOLDER | SFGAO_DISPLAYATTRMASK | SFGAO_CANRENAME | SFGAO_FILESYSANCESTOR;
> 
>       pParentFolder->GetAttributesOf(1, (LPCITEMIDLIST*) &pidlTemp, &dwAttribs);
>       tvItem.cChildren = (dwAttribs & (SFGAO_HASSUBFOLDER | SFGAO_FILESYSANCESTOR));
> 
>       // Determine if the item is shared:
>       if (dwAttribs & SFGAO_SHARE)
>       {
>           tvItem.mask |= TVIF_STATE;
>           tvItem.stateMask |= TVIS_OVERLAYMASK;
>           tvItem.state |= INDEXTOOVERLAYMASK(1); //1 is the index for the shared overlay image
>       }
> 
>       // Fill in the TV_INSERTSTRUCT structure for this item:
>       TVINSERTSTRUCT tvInsert;
> 
>       tvInsert.item = tvItem;
>       tvInsert.hInsertAfter = TVI_LAST;
>       tvInsert.hParent = hParentItem;
> 
>       InsertItem(&tvInsert);
>       dwFetched = 0;
>   }
> 
>   pEnum->Release();
>   return S_OK;
> } 
> ```

我感到困惑的是缺乏区分正在枚举的对象类型的能力（或者首先控制枚举以过滤掉诸如这些非文件系统对象的更好方法）。

可以查看被枚举项目的文本，如果它以“.zip”结尾，则只需将其排除。但是，这对我来说似乎很不稳定。毕竟，可以将任意文件夹命名为 XYZ.zip（它仍然是一个文件夹，而不是 zip 存档）。类似地，未来可能还支持除 .zip 以外的其他存档类型 - 或者其他容器类型，但它们实际上并不是文件夹。

我不想消除像“网络”和“计算机”这样的有效节点。只是那些有问题的，例如“Downloads\Foobar.zip”

我为这个漫无边际的问题道歉。任何有助于提高我的理解和创造性方法以了解哪些类型的对象是 Microsoft 的 shell 命名空间的一部分，以及如何有效地使用它们，我们将不胜感激！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-12T00:27:56.550

一个 zip 文件/文件夹将具有 SFGAO_STREAM/SFGAO_DROPTARGET 和 SFGAO_FOLDER，因此如果您可以将 shell 项作为流读取，那么它可能不是目录。另一种判断方法是使用 SHGetPathFromIDList+PathIsDirectory，但这仅适用于具有文件系统路径的 pidl。

还有其他类型的可浏览文件，例如保存的搜索（如果您浏览文件，完成枚举项目需要很长时间），因此您可能也想考虑如何处理这些文件。

# spring - 我可以使用 Spring Data JPA 为 MappedSuperClass 的所有子级使用通用存储库吗？

> ID：14286841
> 
> 赞同：13
> 
> 时间：2013-01-11T21:21:34.873
> 
> 标签：spring, hibernate, jpa, spring-data-jpa, mappedsuperclass

给定以下类结构：

```
@MappedSuperclass
@Inheritance(strategy=InheritanceType.TABLE_PER_CLASS)
public abstract class Animal  {}

@Entity
public class Dog {}

@Entity
public class Cat {} 
```

使用**Spring Data JPA**，是否可以使用通用`Animal`存储库在运行时持久`Animal`化而不知道`Animal`它是哪种类型？

我知道我可以使用 Repository-per-entity 并使用`instanceof`如下方式来做到这一点：

```
if (thisAnimal instanceof Dog) 
    dogRepository.save(thisAnimal);
else if (thisAnimal instanceof Cat)
    catRepository.save(thisAnimal);
} 
```

但我不想诉诸使用`instanceof`.

我试过使用这样的通用存储库：

```
public interface AnimalRepository extends JpaRepository<Animal, Long> {} 
```

但这会导致此异常：`Not an managed type: class Animal`。我猜是因为`Animal`不是一个`Entity`，而是一个`MappedSuperclass`。

最好的解决方案是什么？

顺便说一句 -`Animal`与我的课程中的其余部分一起列出`persistence.xml`，所以这不是问题。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-01-11T21:28:47.130

实际上问题在于您的映射。您可以使用`@MappedSuperclass` **或** `@Inheritance`。两者一起没有意义。将您的实体更改为：

```
@Entity
@Inheritance(strategy=InheritanceType.TABLE_PER_CLASS)
public abstract class Animal  {} 
```

不用担心，底层数据库方案是一样的。现在一个，一般`AnimalRepository`会工作。Hibernate 将进行自省并找出用于实际子类型的表。

# bash - ZSH 无法识别我的别名？

> ID：14286844
> 
> 赞同：61
> 
> 时间：2013-01-11T21:21:44.460
> 
> 标签：bash, shell, sh, zsh, zshrc

将 iTerm2 与 zsh 一起使用，它无法识别我的别名。有时我必须在 IDE 中工作，不能轻易地 vim 一些东西，愚蠢的人认为将他们的应用程序命名为 MyReallyLongApplicationName.app 是个好主意，因为 .html 文件默认在浏览器中打开，所以我必须：

```
open -a MyReallyLongApplicationName.app something.html 
```

我的 .zshrc 中有一个别名，例如：

```
alias ide="open -a MyReallyLongApplicationName.app" 
```

但是 zsh 不会识别我的别名。我尝试了另一个，只是想看看是不是我，但我创建的别名都没有被识别。只需获取“zsh：找不到命令：ide”或其他任何内容。

所以我不确定我做错了什么，我整天都在四处寻找，试图修复 zsh 之类的东西。作为说明，我不是 Linux/Unix 系统的专家，所以如果你太技术化和模糊，我可能不会明白你在告诉我什么。

谢谢！

* * *

## 回答 #1

> 赞同：138
> 
> 时间：2013-01-11T21:29:34.437

如果你在 zsh 中做了一个非常简单的别名，它会起作用吗？打开您的 .zshrc 文件，并添加以下行：

```
alias ls='ls -GpF' 
```

添加该行后，在终端中键入此行：

```
source ~/.zshrc 
```

告诉我们会发生什么。此外，仅对于 shiggles，请确保您使用的是单引号与双引号，我已经看到过去在不同版本的 shell/OS/whatnot 上有所不同。

* * *

## 回答 #2

> 赞同：36
> 
> 时间：2016-10-04T16:36:10.213

将“source ~/.bash_profile”添加到您的 ~/.zsh 配置文件中。

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2016-12-18T23:25:24.020

把这一行：

```
/source: 'source ~/.bash_profile' into ~/.zshrc 
```

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2016-02-08T10:09:13.227

在`~/.zshrc`文件中保存更改后，打开一个新的 shell 窗口并执行其中的命令。

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2017-04-23T11:11:57.047

有时我们需要简单的解决方案...将“source ~/.bash_profile”添加到您的 ~/.zshrc 配置文件中

```
echo source ~/.bash_profile >>  ~/.zshrc 
```

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2018-10-14T18:35:03.240

我需要手动将别名添加到我的 zsh 配置文件中，然后在其上运行 source 命令。

```
echo alias this='some command' >> ~/.zshrc
source ~/.zshrc 
```

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2017-07-28T20:30:47.190

确保双引号是实际的双引号，而不是其他看起来像双引号的字符。

我在 OSX - TextEdit 中编辑 ~/.zsh-aliases，当点击双引号键时，它会替换另一个特殊的双引号字符，这不是 ZSH 所期望的。

用 Sublime 编辑别名文件并用实际的双引号替换旧的双引号后，一切运行正常。

希望这可以帮助。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2019-07-19T20:16:30.580

我有我所有的别名，所以我在下一行`~/.bash_profile`的最后一行添加了：它对我有用。`~/.zshrc``. ~/.bash_profile`

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2021-03-27T08:08:23.047

您应该将别名放在文件中`end`。`~/.zshrc`你可以使用下面的命令来做到这一点：

```
echo alias this='some command' >> ~/.zshrc 
```

在那次跑步之后

```
source ~/.zshrc 
```

然后，打开一个新终端并在其中执行命令。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2021-05-15T04:11:13.310

在我的情况下，问题是空格 b/w **aliasName**和**equalTo**。你应该删除那些空间。

**错误的分配**

```
alias keu = 'k exec -it utils bash' 
```

**正确一个**

```
alias keu='k exec -it utils bash' 
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2020-07-11T09:04:52.413

我将 bash 和 zsh 与一个 .bashrc、.bash_aliases 和 .zshrc 文件一起使用。

将其放入 .zshrc 以加载 bash 文件：

```
# shortcut to refresh .zshrc
alias refz="source ~/.zshrc"

# Load bash files to zsh
test -f $HOME/.bashrc && . $HOME/.bashrc
test -f $HOME/.bash_aliases && . $HOME/.bash_aliases 
```

如果您有许多 bash 别名和函数，您可能会收到一些错误消息，例如：

`/proc/self/fd/13:12310: bad option: -t`

由 .bash_aliases 或 .bashrc 文件中的 bash 特定行引起

您可以使用以下方法跳过那些有问题的：

```
if [ -n "$BASH" ] ;then
    lines to ignore by zsh
fi 
```

例如 kubectl 自动补全

```
# To fix error massage .bashrc:16: command not found: shopt
# Check if bash is the current shell, if not, skip it
if [ -n "$BASH" ] ;then
  # kubectl and bash completions
  if [ -x "$(command -v kubectl)" ]; then
      source <(kubectl completion bash)
      complete -F __start_kubectl k
  fi

  if ! shopt -oq posix; then
    if [ -f /etc/profile.d/bash_completion.sh ]; then
      . /etc/profile.d/bash_completion.sh
    fi
  fi
fi

# Instead I need to put this line somewhere in my zshrc 
# to have kubectl autocompletion replacing the skipped bash one:
plugins=(git git-flow brew history node npm kubectl) 
```

```
# To fix error message .bash_aliases:4: parse error: condition expected: =
# Change these to this syntax to be used by zhs

# Not compatible with zsh:
if [ $HOSTNAME = "x1" ]; then

# Compatible with bash and zsh:
if [[ $HOSTNAME == "x1" ]]; then 
```

* * *

## 回答 #12

> 赞同：-1
> 
> 时间：2020-01-22T16:39:24.243

需要为 .zshrc 创建配置文件并将别名注册到其中。（仅当配置文件不可用时）

```
cd ~ 
touch .zshrc && open .zshrc
add all the alias in .zshrc file
source ~/.zshrc 
```

关闭并重新打开终端并运行别名。

# javascript - 鼠标悬停后我可以用jquery恢复一个值吗？

> ID：14286846
> 
> 赞同：1
> 
> 时间：2013-01-11T21:21:57.320
> 
> 标签：javascript, jquery

我创建了这个[**小提琴**](http://jsfiddle.net/thetoolsmith/d4uPX/)来显示我的问题。

我在用户单击评分后设置所选值，但希望在用户再次悬停时删除所选值。

如果它们远离星形区域，我想选择原始值（如果已选择）。

这将允许他们选择另一个评级，但如果他们将鼠标悬停，则会显示先前选择的评级。

这是我对 jquery 的尝试：

```
$('.star').click(function(e) {

e.preventDefault();

var rating = this.firstChild.data;

    if (rating > 0) {

      $('.star.star_'+rating).addClass('hovered');

      // Trying to remove class if hovered but replace selected value when I mouse out

      /*
          $('.star_container').hover(function() {
                $('.star.star_'+rating).removeClass('hovered');
          });
      */

    }   
}); 
```

我有什么办法可以做到这一点？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-11T21:31:19.133

[http://jsfiddle.net/d4uPX/13/](http://jsfiddle.net/d4uPX/13/)

我所做的是当用户单击一个元素时，将评分附加为数据值以供参考。

```
$('.star_container').data('rating', rating); 
```

然后这是您的悬停功能：

```
$('.star').hover(function() {
  $('.star').removeClass('hovered');
}, function(){
  $('.star.star_'+ $('.star_container').data('rating')).addClass('hovered');
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-11T21:41:11.193

我的解决方案，只是使用一个封闭的变量来存储评级......然后检查它是否已设置。应该为您工作（并且您不必每次都重新选择容器来获取数据元素）：

[http://jsfiddle.net/d4uPX/17/](http://jsfiddle.net/d4uPX/17/)

```
var rating;

$('.star').click(function(e) {          
   e.preventDefault();

    rating = this.firstChild.data;

    if (rating > 0) {         
        $('.star.star_'+rating).addClass('hovered');
    }
});

$('.rating_container').hover(
    function() {
        $('.star.star_'+rating).removeClass('hovered');
    },
    function() {
        if(rating){
            $('.star.star_'+rating).addClass('hovered');
        }
    }
); 
```

# sdk - Rally 定制应用程序：如何过滤故事的标准缺陷趋势报告

> ID：14286847
> 
> 赞同：0
> 
> 时间：2013-01-11T21:22:00.970
> 
> 标签：sdk, rally

我们每个版本都有一个故事“自动化测试”我们在这个故事下记录了源自自动化测试的所有缺陷。. 现在想围绕为自动化故事生成的缺陷创建一个自定义报告。
例如，一个仅从该故事中提取缺陷的缺陷趋势应用程序。. 可以在故事级别定制标准报告吗？
我的报告的一般流程将是。

1.  选择发布（在后台，应用程序会自动查看自动化测试故事中的所有缺陷）或从下拉列表中选择故事<> 2.显示报告

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-21T16:31:33.183

您最好的选择是利用 AppSDK2 和 Lookback API (LBAPI)。使用 AppSDK2 将感兴趣的故事或故事抓取到 WsapiDataStore。然后进入 LBAPI 获取这些故事，以获取 SnapshotStore 中每个故事的缺陷历史记录 - 然后您可以使用它来进行分类和绘制图表。我会看看我是否可以工作/吓唬一个例子 - 这是新 Rally API 的理想用例。

# pentaho - Pentaho Kettle Spoon 的日期格式和数据提取

> ID：14286849
> 
> 赞同：2
> 
> 时间：2013-01-11T21:22:04.623
> 
> 标签：pentaho, kettle

我正在使用 Kettle Spoon 进行改造。

1.  如何从“获取系统信息”中给出固定的输入日期？我看到选择昨天、一个月前等的选项。但我想手动选择固定日期，例如：'2012-12-14'

2.  我从转换中得到了一个 csv，“文本文件输出”。输出用于说 A、B、C、D、E。我想过滤并只获取 A、B、D、E。如何从“文本文件输出”中过滤并仅选择所需的列来获取我的数据决赛桌。

先感谢您。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-13T16:13:18.713

1) use a select value step right after the "Get system info". In the Meta-data tab choose the field, use type Date and choose the desired format mask (yyyy-MM-dd).

2) if you need filtering columns, i.e. dropping some columns from output, again use select value step; if you need filtering rows based on the values contained in a field/column, then use filter rows step.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-01T21:48:35.403

我猜您想添加硬编码日期，而不是重新格式化现有日期。如果是这种情况，只需使用 Add Constants 步骤。将列类型设置为日期。如果您需要将其作为源步骤，您可以使用数据网格或生成行步骤。

如果要从文本文件输出中删除列，可以使用 @andtorg 所说的选择值步骤，但您也可以简单地从文本文件输出步骤的字段选项卡中删除列。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-04-16T08:12:13.167

使用修改后的 Javascript 值在 PDI 中添加修改后的 Javascript 值并选择您想要的任何格式。

# iphone - ios6设备识别和分析

> ID：14286852
> 
> 赞同：0
> 
> 时间：2013-01-11T21:22:13.107
> 
> 标签：iphone, ios6, profiling, uniqueidentifier, identification

我制作了一个社交应用程序，因为我不喜欢要求创建个人资料的应用程序......记住密码......等等，我的应用程序无需登录即可运行。

为了识别用户，我使用了 UDID。在 iOS6 中，Apple 不再提供对 UDID 的访问权限，而是强制开发人员使用**identifierForVendor**，问题是如果应用程序被删除并再次安装......或者如果应用程序升级，这个标识符会发生变化。

您对保存用户个人资料有什么建议？还有其他方法可以在没有帐户的情况下进行“登录”吗？

非常感谢。

# c# - 将 WPF 列表框嵌入到我的 WinForms 应用程序

> ID：14286854
> 
> 赞同：0
> 
> 时间：2013-01-11T21:22:22.227
> 
> 标签：c#, .net, wpf, listbox, winforms-interop

如何将 WPF 列表框嵌入到我的 Windows 窗体应用程序中？

理想情况下，WPF 列表框将能够添加列表框项对象、呈现颜色（通过将背景属性设置为某些颜色画笔），并从 Windows 窗体文本框中显示列表框中的内容。

我不想在 WPF 中创建复合控件，只是在我的 Winforms 解决方案中嵌入了一个简单的 WPF 列表框。

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-15T05:24:58.020

在您的新创建`UserControl`中，您可以只公开`ListBox`via 一个属性。然后就可以`ListBox`通过`UserControl`.

在您的 UserControl.xaml.cs 中的某处：

```
public ListBox MyListBox
{
    get
    {
        return {yourListBoxName};
    }
} 
```

然后当你实例化你的 new 时`UserControl`：

```
ElementHost elhost = new ElementHost();
elhost.Size = new Size(110, 60);
elhost.Location = new Point(45,35);

MyWPFControl wpfctl = new MyWPFControl();
elhost.Child = wpfctl;

this.Controls.Add(elhost);

//Access your ListBox via wpfctl.MyListBox 
```

或者，您可以查看[MVVM](http://social.msdn.microsoft.com/Forums/en-US/wpf/thread/62da4a56-4699-494e-a47f-33b89eb9e8dd)并将您的绑定`ListBox.ListBoxItem`到您的`TextBox`;

# unity3d - 如何在 unity3d 中使用 Trail Renderer？

> ID：14286855
> 
> 赞同：0
> 
> 时间：2013-01-11T21:22:42.280
> 
> 标签：unity3d

我是 unity3d 的新手，我有一个要跟踪的可移动对象。根据我的搜索，有一个名为 Trail Renderer 的功能我不知道如何在脚本中使用它，任何人都可以为我提供如何以清晰的方式使用它

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-11T23:39:46.510

它不是一个函数，[它是一个脚本](http://docs.unity3d.com/Documentation/Components/class-TrailRenderer.html)。

真正易于使用，只需选择一个游戏对象并转到**Menu->Component->Effects->Trail Renderer**。只需按照文档页面填写材料属性即可。所有尾迹渲染器属性都暴露给 Unity 编辑器的检查器，因此您可以使用开始和结束宽度、材质道具等，而无需编写额外的代码。

# r - 用颜色绘制 PCA 分数

> ID：14286858
> 
> 赞同：3
> 
> 时间：2013-01-11T21:22:59.363
> 
> 标签：r, pca

我正在做 PCA，我想在 R 中绘制第一个主成分与第二个主成分：

```
pca<-princomp(~.,data=data, na.action=na.omit
plot(pca$scores[,1],pca$scores[,2]) 
```

或者可能是几个主要组成部分：

```
pairs(pca$scores[,1:4]) 
```

但是这些点是黑色的。如何适当地为图表添加颜色？我需要多少种颜色？我正在绘制的每个主成分一个？或者我的数据矩阵中的每一行都有一个？

谢谢

编辑：

我的数据如下所示：

```
> data[1:4,1:4]
                          patient1                     patient2                     patient3                     patient4
2'-PDE                    0.0153750                    0.4669375                   -0.0295625                    0.7919375
7A5                       2.4105000                    0.3635000                    1.8550000                    1.4080000
A1BG                      0.9493333                    0.2798333                    0.7486667                    0.7500000
A2M                       0.2420000                    1.0385000                    1.1605000                    1.6777500 
```

那么这是否合适：

```
plot(pca$scores[,1:4], pch=20, col=rainbow(dim(data)[1])) 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-12-20T02:56:32.100

以下是 PCA 的一些示例图。取自[这里](http://manuals.bioinformatics.ucr.edu/home/R_BioCondManual#TOC-Principal-Component-Analysis-PCA-)。

```
z1 <- rnorm(10000, mean=1, sd=1); z2 <- rnorm(10000, mean=3, sd=3); z3 <- rnorm(10000, mean=5, sd=5); z4 <- rnorm(10000, mean=7, sd=7); z5 <- rnorm(10000, mean=9, sd=9); mydata <- matrix(c(z1, z2, z3, z4, z5), 2500, 20, byrow=T, dimnames=list(paste("R", 1:2500, sep=""), paste("C", 1:20, sep=""))) 

summary(pca) 
summary(pca)$importance[, 1:6] 

x11(height=6, width=12, pointsize=12); par(mfrow=c(1,2)) 

mycolors <- c("red", "green", "blue", "magenta", "black") # Define plotting colors. plot(pca$x, pch=20, col=mycolors[sort(rep(1:5, 500))]) 

plot(pca$x, type="n"); text(pca$x, rownames(pca$x), cex=0.8, col=mycolors[sort(rep(1:5, 500))]) 
```

### 您可以使用对

```
pairs(pca$x[,1:5], col = mycolors) 
```

### 绘制前两个主成分的散点图以及存储在 pca$rotation 中的相应特征向量。

```
library(scatterplot3d) 
scatterplot3d(pca$x[,1:3], pch=20, color=mycolors[sort(rep(1:5, 500))]) 
```

### 与上面相同，但在 3D 散点图中绘制前三个主成分。

```
library(rgl); rgl.open(); offset <- 50; par3d(windowRect=c(offset, offset, 640+offset, 640+offset)); rm(offset); rgl.clear(); rgl.viewpoint(theta=45, phi=30, fov=60, zoom=1); spheres3d(pca$x[,1], pca$x[,2], pca$x[,3], radius=0.3, color=mycolors, alpha=1, shininess=20); aspect3d(1, 1, 1); axes3d(col='black'); title3d("", "", "PC1", "PC2", "PC3", col='black'); bg3d(" 
```

后者使用 Open GL 创建交互式 3D 散点图。为此需要安装 rgl 库。要保存图形的快照，可以使用命令 rgl.snapshot("test.png")。

```
require(GGally)
ggpairs(pca$x[,1:5]) 
```

# c# - Windows 应用商店应用程序 (.NET) 上的 SSDP (UDP)

> ID：14286859
> 
> 赞同：3
> 
> 时间：2013-01-11T21:23:18.213
> 
> 标签：c#, udp, multicast, windows-store, philips-hue

我正在尝试使用*C#为**Windows Store应用程序实现基本的**SSDP* ( *UDP* ) 广播/侦听器。

 **我发现它`Windows.Networking.Sockets`包含`DatagramSocket`我需要用于*UDP*网络的类。

但是，我目前的尝试似乎执行得很好，但通过*Wireshark*没有结果，也没有从网络上的设备得到响应。

这是我目前正在使用的代码（并通过 RT Simulator 运行）：

```
public async static Task<IEnumerable<HueBridge>> DiscoverAsync(TimeSpan timeout)
{
  if (timeout <= TimeSpan.Zero)
    throw new ArgumentException("Timeout value must be greater than zero.", "timeout");

  var discoveredBridges = new List<HueBridge>();

  using (var socket = new DatagramSocket())
  {
    while (true)
    {
      var bridgeWasFound = false;

      socket.MessageReceived += (sender, e) =>
      {
        var bpx = true; // breakpoint here for success
      };

      var multicastIP = new HostName("239.255.255.250");
      await socket.BindServiceNameAsync("1900");
      socket.JoinMulticastGroup(multicastIP);

      using (var writer = new DataWriter(socket.OutputStream))
      {
        var request = new StringBuilder();
        request.AppendLine("M-SEARCH * HTTP/1.1");
        request.AppendLine("HOST: 239.255.255.250:1900");
        request.AppendLine("MAN: ssdp:discover");
        request.AppendLine("MX: 5");
        request.AppendLine("ST: ssdp:all");

        writer.WriteString(request.ToString());
        await writer.FlushAsync();
      }

      if (timeout > TimeSpan.Zero)
        await Task.Delay(timeout);

      if (!bridgeWasFound)
        break; // breakpoint here for failure check
    }
  }

  return discoveredBridges;
} 
```

关于我可能做错了什么的任何想法？我没有遇到异常，并且我在清单中设置了正确的*功能。*我的断点`break`总是被击中，我正在使用 10 秒的超时。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-11T22:32:58.927

似乎我发现了问题。

首先，我应该使用`socket.BindEndpointAsync(null, string.Empty)`而不是`socket.BindServiceNameAsync("1900")`，它将正确监听广播数据包。

其次，`writer.FlushAsync()`不写入套接字；但是，`writer.StoreAsync()`确实如此。

这是最终结果，它确实（几乎）完美地工作：

```
public async static Task<IEnumerable<HueBridge>> DiscoverAsync(TimeSpan timeout)
{
  if (timeout <= TimeSpan.Zero)
    throw new ArgumentException("Timeout value must be greater than zero.", "timeout");

  var discoveredBridges = new List<HueBridge>();
  var multicastIP = new HostName("239.255.255.250");
  var bridgeWasFound = false;

  using (var socket = new DatagramSocket())
  {
    socket.MessageReceived += (sender, e) =>
    {
      var reader = e.GetDataReader();
      var bytesRemaining = reader.UnconsumedBufferLength;
      var receivedString = reader.ReadString(bytesRemaining);

      // TODO: Check for existing bridges, only add new ones to prevent infinite loop.
      // TODO: Create new bridge and add to the list. 

      bridgeWasFound = true;
    };

    await socket.BindEndpointAsync(null, string.Empty);
    socket.JoinMulticastGroup(multicastIP);

    while (true)
    {
      bridgeWasFound = false;

      using (var stream = await socket.GetOutputStreamAsync(multicastIP, "1900"))
      using (var writer = new DataWriter(stream))
      {
        var request = new StringBuilder();
        request.AppendLine("M-SEARCH * HTTP/1.1");
        request.AppendLine("HOST: 239.255.255.250:1900");
        request.AppendLine("MAN: ssdp:discover");
        request.AppendLine("MX: 3");
        request.AppendLine("ST: ssdp:all");

        writer.WriteString(request.ToString());
        await writer.StoreAsync();

        if (timeout > TimeSpan.Zero)
          await Task.Delay(timeout);

        if (!bridgeWasFound)
          break;
      }
    }
  }

  return discoveredBridges;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-15T07:59:34.977

根据规格：

> HTTP 扩展框架需要 MAN。与 NTS 和 ST 字段值不同，MAN 头字段的字段值用双引号括起来；它定义了扩展的范围（命名空间）。必须是“ssdp:discover”。

然后你的代码

```
request.AppendLine("MAN: ssdp:discover"); 
```

一定是

```
request.AppendLine("MAN: \"ssdp:discover\""); 
```

希望这有帮助。**

# regex - 正则表达式和速度的问题

> ID：14286860
> 
> 赞同：0
> 
> 时间：2013-01-11T21:23:21.113
> 
> 标签：regex, velocity, dotcms

我刚开始使用 dotCMS 来修改现有网站。我正在尝试创建一个小部件，该小部件采用名为 urlTitle 的自定义结构字段。它采用事件的标题并使其对 url 友好。[这是一个描述 urlTitle 的教程](http://www.youtube.com/watch?v=EUMC4j-APZU)

我有一个为 javascript 编写的正则表达式。我的问题是当我尝试在速度中使用相同的正则表达式时，我遇到了一些麻烦。

这是教程中的javascript：

```
<script>
    function updateDisplayURLTitle(){

        // get the title entered by the user
        var plainTitle = dojo.byId("title");    

        // make a friendly url
        var urlTitle = plainTitle.value.toLowerCase();
        urlTitle= urlTitle.replace(/^\s+|\s+$/g,"");
        urlTitle = urlTitle.replace(/[^a-zA-Z 0-9]+/g,' '); 
        urlTitle = urlTitle.replace(/\s/g, "-");
        while(urlTitle.indexOf("--") > -1){
            urlTitle = urlTitle.replace("--",'-');  
        }

        // set the values of the display place holder and the custom field
        // the   is to hold the div open
        dojo.byId("displayURLTitle").innerHTML = urlTitle;
        dojo.byId("urlTitle").value=urlTitle;
    }

    // attach this the text1 field onchange
    dojo.connect(dojo.byId("title"), "onchange", null, "updateDisplayURLTitle");

    // populate the field on load
    dojo.addOnLoad(updateDisplayURLTitle);

</script>
<div id="displayURLTitle" style="height:20px"> </div> 
```

然后这是我的小部件的速度代码：

```
#set($nowsers = $date.format('yyyyMMddHHmmss', $date.getDate()))
#set($con = $dotcontent.pull("+structureName:calendarEvent +(conhost:48190c8c-42c4-46af-8d1a-0cd5db894797 conhost:SYSTEM_HOST) +calendarEvent.startDate:[$nowsers TO 21001010101000]",1,"calendarEvent.startDate"))
    <ul>
    #foreach($event in $con)
        <li>
           <a href="events/$event.urlTitle?id=$event.identifier">$event.title</a>
            <p> $event.description</p>
        </li>

#set($temp = $event.title.toLowerCase())
#set($temp = $temp.replaceAll('/^\s+|\s+$/g', ""))
#set($temp = $temp.replaceAll('/[^a-zA-Z 0-9]+/g', " "))
#set($temp = $temp.replaceAll('/\s/g', "-"))
$temp

$temp
#end 
```

我的目标是让 javascript 中的正则表达式与速度一起工作。现在它不起作用，我对正则表达式的熟练程度不高，到目前为止，我的研究没有让我取得任何进展。

我无法弄清楚的另一件事是它的`/g`作用。我在任何正则表达式资源网站中都找不到它。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-11T23:01:37.343

我想到了。事实证明，正则表达式模式前面的转义字符 / 和 /g 导致模式失败，因此速度中使用的方法一定不需要它。

# ruby-on-rails - 分配会话变量而不保存到数据库

> ID：14286863
> 
> 赞同：2
> 
> 时间：2013-01-11T21:23:29.110
> 
> 标签：ruby-on-rails, ruby

我正在尝试设置诸如购物车之类的东西，而我所拥有的是一个表格，可以选择某人可能想要购买的每种尺寸衬衫的数量。我计划有 XXS、XS、S、M、L、XL 和 XXL，他们选择每种数量并将其添加到购物车中。我能想到的最简单的方法是有一个 t.integer "size_??" 对于“tshirt”数据库中的每种尺寸，在用户单击添加到购物车后，该数字将存储在会话中，直到他们的付款被批准，在这种情况下，它会被保存到数据库中。然后有人可以稍后查看数据库以查看下了什么订单。（这将用于制作定制衬衫，因此数据库中不会保存需要查看或列出的“示例”）。

我的第一个问题是这是否正确。我想过使用“衬衫 has_many Sizes”的方法，但我不是最熟悉它，如果我想要实现的只是获得数量，我觉得这可能有点矫枉过正。

我的第二个问题是：如果我有一个表格来选择每个的数量，我如何将值分配给会话变量。我的第一个想法是这样的方法：

```
new_order.html.erb:
<%=  form_for(:shirt, :url => {:action => 'save_to_session'}) do |f| %>
<table summary="New shirt order form">
<tr>    
    <th>Size S:</th>
</tr>
<tr>
    <td><%= f.select(:size_s, 0..99) %> </td>
</table>

  <%= submit_tag("Place order") %>

<% end %> 
```

在控制器端

```
 def new_order
    @temp_order = Shirt.new
    @temp_order.size_s = 0
  end

  def save_to_session
    session[:shirt_size_s] = @temp_order.size_s
    redirect_to(:action => 'show_session')
  end

  def show_session

  end 
```

其中 show_session 只是吐出 session[:shirt_size_s]

我得到的错误是

> nil:NilClass 的未定义方法“size_22”

也许这是禁忌，因为它似乎是一种非常简单的方法，但这不会改变会话值。如果我将以下行添加到 save_to_session 它可以工作，所以我想也许 save_to_session 无权访问@temp_order，但我仍处于学习阶段并且不完全知道这里出了什么问题。

```
session[:shirt_size_s] = 12 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-11T23:05:34.897

您的 @temp 是一个实例变量，通常用于填充页面而不用于检索数据。您想使用 params[:field1] 来表示 field1 是您选择的名称。

# java - 有没有更好的方法来编写这个（集合）助手类

> ID：14286869
> 
> 赞同：4
> 
> 时间：2013-01-11T21:24:07.903
> 
> 标签：java, collections

我想知道是否有更好的方法来编写以下课程

```
public class Helper
{
    public static boolean isMatch(final Collection<ClassA> customList)
    public static boolean containsProperty(final Collection<ClassA> customList, final String property)
} 
```

该方法的调用方式是：

```
Helper.isMatch(customList); 
```

我想做的就是拨打电话：

```
customList.isMatch(); 
```

任何建议都会很棒。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-11T21:32:28.283

如果您使用 Guava，则可以使用[ForwardingList](http://docs.guava-libraries.googlecode.com/git/javadoc/com/google/common/collect/ForwardingList.html)等。

它将所有默认`List`方法转发到嵌入式实例，您可以添加自己的方法。

更多细节[在这里](http://docs.guava-libraries.googlecode.com/git/javadoc/index.html)。

# antlr - 词法分析器中的 ANTLR3 动态引号

> ID：14286870
> 
> 赞同：1
> 
> 时间：2013-01-11T21:24:08.977
> 
> 标签：antlr, antlr3

我需要匹配 Perl 正则表达式匹配器之类的东西

```
m/my regex!*/ 
```

其中引号可以是范围内的任何字符。所以上面是一样的

```
m%my regex!*% 
```

对词法分析器规则的天真猜测是

```
REGEX: 'm' quote=. (~(quote))* quote; 
```

但这不起作用，因为后者`quote`指的不是规则，`quote=`而是一些规则。

我可以用很多自己的代码来做到这一点，比如

```
REGEX: 'm' quote=. { ... implement the loop and final match myself ... } ; 
```

但不知何故，我认为应该有一种规范的方式来做这些事情。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-11T21:58:29.613

> ...但不知何故，我认为应该有一种规范的方式来做这些事情。

那没有。您必须使用自定义代码来执行此操作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-13T11:26:54.300

看看 PL/SQL 解析器（[这里](https://github.com/porcelli/plsql-parser/blob/master/parsers/PLSQLLexer.g)）。Oracle 还支持那些 Perl 风格的引用字符串。

像：

```
q':select * from employees where last_name = 'smith':' 
```

以自定义代码为例。（它包含 C 和 Java 实现）。也许在您的情况下，它甚至可以简化。

伊万

# ruby-on-rails - 理解 Gemfile.lock：删除 Gemfile.lock 然后再次运行 bundle install 可以吗？

> ID：14286872
> 
> 赞同：38
> 
> 时间：2013-01-11T21:24:19.557
> 
> 标签：ruby-on-rails, ruby-on-rails-3, rubygems, gemfile

我们会对此进行测试，但如果不应该发生这种情况，我们不想冒险破坏我们的开发环境。

可以删除 Gemfile.lock 吗？

我们在 Rails 3.0.6 上。

* * *

## 回答 #1

> 赞同：35
> 
> 时间：2013-01-11T21:33:13.673

您可能不会破坏您的开发环境。但是，您最终可能会得到比以前更新的 gems 版本。这取决于您如何在`Gemfile`.

如果您使用以下条目：

`gem "rails"`

然后你会得到最新的`rails`宝石，不管它是什么。

如果您使用以下条目：

`gem "rails", "3.2.11"`

然后您将再次获得 3.2.11。

说了这么多，这就是分支的用途。`git`在,或任何你正在使用的东西中创建一个分支`hg`，吹走`Gemfile.lock`，运行`bundle install`，然后检查你的测试套件。如果它很糟糕，那么您可以在找出问题所在的同时放弃分支。

另一个提示：每当我想这样做时，我发现清除所有已安装的 gem 也很有用。如果您使用`rvm`gemsets 这就像运行一样简单

`rvm gemset empty [gemset_name]`

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2016-10-27T03:28:39.237

删除没关系`Gemfile.lock`，运行

```
bundle install 
```

生成一个新的`Gemfile.lock`. 请注意，如果您没有指定任何版本的 gem `Gemfile`，您将始终获得最新的

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2013-06-24T22:54:36.823

我知道这已经得到了回答，但是对于碰巧在 Google 上看到这篇文章的其他人来说，你应该知道该命令`bundle init`将重新生成 Gemfile。

# url - YouTube m 之间的模式。和普通的网站网址

> ID：14286873
> 
> 赞同：1
> 
> 时间：2013-01-11T21:24:20.973
> 
> 标签：url, youtube-api

当 url 是移动 (m.) 网站时，我的网站无法显示上传的 youtube 视频，但它适用于普通的 youtube 网站。在我看来，移动网址和普通网址在模式上有所不同，如下所示：

[http://www.youtube.com/watch?v=5ILbPFSc4_4](http://www.youtube.com/watch?v=5ILbPFSc4_4)

[http://m.youtube.com/#/watch?v=5ILbPFSc4_4&desktop_uri=%2Fwatch%3Fv%3D5ILbPFSc4_4](http://m.youtube.com/#/watch?v=5ILbPFSc4_4&desktop_uri=%2Fwatch%3Fv%3D5ILbPFSc4_4)

显然，m。添加了 /# 和所有 &desktop_uri... 的东西。

然后再次：

[http://www.youtube.com/watch?v=8To-6VIJZRE](http://www.youtube.com/watch?v=8To-6VIJZRE)

[http://m.youtube.com/#/watch?v=9To-6VIJZRE&desktop_uri=%2Fwatch%3Fv%3D8To-6VIJZRE](http://m.youtube.com/#/watch?v=9To-6VIJZRE&desktop_uri=%2Fwatch%3Fv%3D8To-6VIJZRE)

我们希望做的是检查 url 是否是移动站点，如果是，则对其进行解析，使其显示为正常站点。

有谁知道所有 youtube 网址是否都以这种方式工作 - 如果这种类似的模式适用于移动网站和普通网站上的所有相同视频？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-15T18:50:18.027

通常，每当您尝试手动解析网站的 URL（而不是 Web API）时，都会让自己容易受到破坏。没有“合同”规定将始终使用通用格式用于移动网站或桌面网站上的观看页面 URL。

当您想将 YouTube 观看页面 URL 作为输入并以编程方式获取有关底层视频资源的信息作为输出时，您应该使用[oEmbed 服务。](http://apiblog.youtube.com/2009/10/oembed-support.html)话虽如此，oEmbed 响应不包含指向桌面 YouTube 观看页面的规范链接，因此在这种情况下它不会为您提供您想要的内容。对于许多用例，例如当您想要获取视频的嵌入代码时，它是给定其观看页面 URL 的，这是正确的选择。

如果您手动编写代码，请确保您的代码部署在某个地方，如果监视页面的格式确实发生变化，则可以轻松更新。

# javascript - Firefox 的 document.body.getBoundingClientRect().top 不正确？

> ID：14286876
> 
> 赞同：1
> 
> 时间：2013-01-11T21:24:32.147
> 
> 标签：javascript, html, css, firefox

`document.body.getBoundingClientRect().top;`当我在一个根本没有样式的简单网站上询问 Firefox 版本 17.0.1时，它返回错误的值。我期望`8`，这是浏览器的默认设置，但它给了我`21.4`. 然而，`.left`偏移量是正确的。

在 Chrome 中，偏移量可以正常工作，并为我`8`提供了顶部和左侧。

我附上了一个截图，你可以看到顶部不应该是`22.4.`![情况截图](../Images/6a6466f08dc485278002a0b6b7f03a2e.png)

这是HTML

```
<html><head>
<title>Index</title>
<style type="text/css"></style></head>
<body>
    <div>
        <h1>Index</h1>
        <p>This is the index. The site contains in total 4 sites without
            any Javascript. They are linked using href links.</p>
        <p>The site looks like this:</p>
        <ul>
            <li>Index ->; a</li>
            <li>Index ->; b</li>
            <li>b ->; c</li>
            <li>c ->; b</li>
            <li>c ->; Index</li>
        </ul>
    </div>
    <a href="a.html">Go to A</a>
    <a href="b.html">Go to B</a>
</body></html> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-12T06:22:51.777

尝试给你`<html>`的黄色背景和`<body>`绿色背景，看看渲染的样子。我敢打赌，绿色矩形实际上是距视口顶部 22px 的地方。

发生这种情况的原因是 body 的 8px 上边距与您的 22+px 上边距折叠在一起`<h1>`，因为这些边距是相邻的。见[http://www.w3.org/TR/CSS21/box.html#collapsing-margins](http://www.w3.org/TR/CSS21/box.html#collapsing-margins)

Chrome 在标准模式下具有相同的行为。但是在 quirks 模式下（上面的 HTML 片段所在的模式），它似乎做了一些奇怪的事情，`<h1>`仍然报告 21px 的上边距，但这个边距并没有与`<body>`..`<div>`将其与身体一起坍塌。这就是你的怪癖模式。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-11T21:46:41.403

我刚刚使用带有以下代码的 Firefox 18 进行了尝试，我得到了预期值 8（为了清楚起见，我取出了所有格式，但它给出了相同的 8 值）。

```
<html>
<head>
<title>Index</title>
<script>
    window.onload = function () {
        document.getElementById("getBoundingClientRectTop").innerHTML = document.body.getBoundingClientRect().top;
    }
</script>
</head>
<body>
    <span id="getBoundingClientRectTop">???</span>
</body>
</html> 
```

# sql - 将 2 个月添加到当前时间戳

> ID：14286877
> 
> 赞同：4
> 
> 时间：2013-01-11T21:24:37.740
> 
> 标签：sql, oracle, date, date-arithmetic

如何在 Oracle 中将月份添加到时间戳值？在我的查询中，它被转换为日期值：

```
 SELECT add_months(current_timestamp,2) 
     FROM   dual; 
```

实际输出为：

```
 ADD_MONTH
     11-MAR-13 
```

预期的输出是：

```
 2013-01-01 00:00:00.000000000+00:00 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-11-27T12:34:37.730

对于甲骨文：

```
SELECT
  TIMESTAMP'2014-01-30 08:16:32',                                  -- TS we want to increase by 1 month
--TIMESTAMP'2014-01-30 08:16:32' + NUMTOYMINTERVAL(1, 'MONTH'),    -- raises ORA-01839: date not valid for month specified
--TIMESTAMP'2014-01-30 08:16:32' + INTERVAL '1' MONTH,             -- raises ORA-01839: date not valid for month specified
  ADD_MONTHS(TIMESTAMP'2014-01-30 08:16:32', 1),                   -- works but is a date :(
  CAST(ADD_MONTHS(TIMESTAMP'2014-01-30 08:16:32', 1) AS TIMESTAMP) -- works
FROM DUAL 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-11T23:22:23.943

我认为这会给你你正在寻找的东西：

```
SELECT TO_CHAR(TO_TIMESTAMP(ADD_MONTHS(CURRENT_TIMESTAMP,2))
            + (CURRENT_TIMESTAMP - TRUNC(CURRENT_TIMESTAMP)),
       'YYYY-MM-DD HH:MI:SSxFFTZR') FROM DUAL; 
```

使用间隔方法的问题在于，根据运行查询的日期，您可能会收到意外错误。例如

```
SELECT TO_TIMESTAMP('31-JAN-2012') + NUMTOYMINTERVAL(1,'MONTH') FROM DUAL; 
```

该查询返回：

```
ORA-01839: date not valid for month specified 
```

这是因为它试图返回 2 月 31 日，这不是一个有效的日期。

ADD_MONTHS 是一种“更安全”的日期数学方法，因为间隔查询会引发错误，在上面的示例中，ADD_MONTHS 将返回该月的最后一个日期（2 月 28 日或 29 日，具体取决于年份）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-11T21:26:32.430

这将为您提供日期**和时间**作为`TIMESTAMP`数据类型：

```
select TO_TIMESTAMP(TO_CHAR(ADD_MONTHS(SYSDATE, 2), 'YYYYMMDD HH24:MI'), 
'YYYYMMDD HH24:MI') from dual; 
```

如果您需要比上述更多或更少的精度（EG 舍入），请调整日期格式（两者必须是相同的格式）。例如，这将返回 2 个月到秒级的精度：

```
select TO_TIMESTAMP(TO_CHAR(ADD_MONTHS(SYSTIMESTAMP, 2), 
'YYYYMMDD HH24:MI:SS'), 'YYYYMMDD HH24:MI:SS') from dual; 
```

这是我能得到的最接近（作为一个字符）你需要的格式：

```
select TO_CHAR( 
TO_TIMESTAMP(TO_CHAR(ADD_MONTHS(SYSTIMESTAMP, 2), 
'YYYYMMDD HH24:MI:SS'), 'YYYY-MM-DD HH24:MI:SS'),
'YYYY-MM-DD HH24:MI:SS.FF TZR') from dual; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-11T21:52:30.763

```
SELECT current_timestamp + INTERVAL '2' MONTH from dual; 
```

要以您想要的格式显示它，请使用`TO_CHAR`：

```
SELECT TO_CHAR(current_timestamp + INTERVAL '2' MONTH, 
       'YYYY-MM-DD HH24:MI:SS.FF9TZH:TZM') from dual;
2013-03-11 23:58:14.789501000+01:00 
```

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2013-01-11T21:40:12.427

对于甲骨文：

```
select TO_TIMESTAMP(Sysdate,'DD-Mon-YYYY HH24-MI-SS') + 60
from dual;

select sysdate + interval '2' month from dual;

select TO_TIMESTAMP (Sysdate + interval '2' month,  'DD-Mon-YYYY HH24-MI-SS')
from dual
; 
```

结果1：

```
| TO_TIMESTAMP(SYSDATE,'DD-MON-YYYYHH24-MI-SS')+60 |
----------------------------------------------------
|                     March, 12 0013 00:00:00+0000 | 
```

结果2：

```
|     SYSDATE+INTERVAL'2'MONTH |
--------------------------------
| March, 11 2013 21:41:10+0000 | 
```

结果3：

```
| TO_TIMESTAMP(SYSDATE+INTERVAL'2'MONTH,'DD-MON-YYYYHH24-MI-SS') |
------------------------------------------------------------------
|                                   March, 11 0013 00:00:00+0000 | 
```

*   [sqlffidle 演示](http://sqlfiddle.com/#!4/f152e/5)。

# angularjs - 如何在代码更改后使 angularjs e2e-test 自动重新加载

> ID：14286878
> 
> 赞同：0
> 
> 时间：2013-01-11T21:24:42.177
> 
> 标签：angularjs, angularjs-e2e

当我运行 e2e 测试时，它会完成它的工作，但是当测试成功时会断开连接。有没有办法让它不断测试？

```
./scripts/e2e-test.sh

启动 Testacular 服务器 (http://vojtajina.github.com/testacular)
-------------------------------------------------- -----------------
信息：Testacular 服务器开始于 http://localhost:9876/
info（启动器）：启动浏览器 Chrome
信息（Chrome 24.0）：连接到套接字 id E1l​​oZJU6dCI4eyW9ewyo
Chrome 24.0：执行 3 次，共 3 次成功（1.027 秒 / 0.697 秒）
信息：断开所有浏览器

```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-14T15:08:45.813

在您的 testacular/karma 配置中，更改/添加

```
autoWatch = True 
singleRun = False 
```

你可以通过打开你的 ./scripts/e2e-test.sh 找到配置，它说 testacular start 或 karma start 文件名应该在那里。我假设您使用的是角种子或教程，在这种情况下，文件位于配置文件夹中，通常位于 something.conf.js 下

# ruby - 浮点数相乘产生零

> ID：14286880
> 
> 赞同：0
> 
> 时间：2013-01-11T21:24:57.753
> 
> 标签：ruby

下面的代码输出 0.0。这是因为溢出吗？如何避免？如果不是，为什么？

```
p ((1..100000).map {rand}).reduce :* 
```

我希望加快这段代码的速度：

```
p r.reduce(0) {|m, v| m + (Math.log10 v)} 
```

并改用它：

```
p Math.log10 (r.reduce :*) 
```

但显然这并不总是可能的......

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-11T21:36:01.830

rand 产生的值都在 0.0 到 1.0 之间。这意味着每次乘法时，您的数字都会变小。因此，当您将它们乘以 1000 时，它可能与 0 无法区分。

在某些时候，ruby 会让你的数字变得如此之小以至于它是 0。例如：`2.0e-1000 # => 0`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-11T21:39:21.293

每次乘法都会将您的数字减少约**1/2 ¹**，因此在其中约 50 次之后，您下降了**1/2 ^(50)，**并且在 100000 之后（实际上，在约 700 之后）您已经*[下溢](http://en.wikipedia.org/wiki/Underflow)*了[FP 格式本身，请参见此处。](http://en.wikipedia.org/wiki/Double_precision_floating-point_format)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-11T22:10:10.733

Ruby 提供了[`BigDecimal`](http://www.ruby-doc.org/stdlib-1.9.3/libdoc/bigdecimal/rdoc/BigDecimal.html)实现精确浮点运算的类。

```
require 'bigdecimal'

n = 100

decimals = n.times.map { BigDecimal.new rand.to_s }
result = decimals.reduce :*

result.nonzero?.nil?  # returns nil if zero, self otherwise
# => false

result.precs  # [significant_digits, maximum_significant_digits]
# => [1575, 1764]

Math.log10 result
# => -46.8031931083014 
```

但是，它比本机浮点数慢得多。随着`n = 100_000`，`decimals.reduce :*`通话在我的电脑上持续了几分钟，然后我终于中断了它。

# php - 数组为同一索引返回 2 个不同的值

> ID：14286883
> 
> 赞同：-2
> 
> 时间：2013-01-11T21:25:12.137
> 
> 标签：php, arrays, variables, onclick, echo

我有以下 PHP 代码：

```
$Directory = "somepath/somedirectory/";
$Files = glob($Directory . "*.jpg");
for ($i = 0; $i < count($Files); $i++) {
    echo ('<img src="' . $Files[$i] . '"/>');
} 
```

我得到的：

```
<img src="somepath/somedirectory/00.jpg"/>
<img src="somepath/somedirectory/01.jpg"/>
<img src="somepath/somedirectory/02.jpg"/>
//etc... 
```

这里一切都好。但是我有一个 onclick()，假设使用相同的变量“$Files[$i]”，如下所示：

```
$Directory = "somepath/somedirectory/";
$Files = glob($Directory . "*.jpg");
for ($i = 0; $i < count($Files); $i++) {
    echo ('<img src="' . $Files[$i] . '" onclick="ChangeImage("' . $Files[$i] . '")"/>');
} 
```

我得到：

```
<img 00.jpg")"="" somedirectory="" somepath=""  onclick="ChangeImage(" src="somepath/somedirectory//00.jpg">
<img 01.jpg")"="" somedirectory="" somepath=""  onclick="ChangeImage(" src="somepath/somedirectory//01.jpg">
//etc... 
```

到底是怎么回事？为什么会有这个结果？

我想要的是：

```
<img src="somepath/somedirectory/00.jpg" onclick=("somepath/somedirectory/00.jpg")/>
<img src="somepath/somedirectory/01.jpg" onclick=("somepath/somedirectory/01.jpg")/>
//etc... 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-11T21:27:18.853

引用不好，试试这个

```
echo '<img src="'.$Files[$i].'" onclick="ChangeImage("'.$Files[$i].'")"/>'; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-12T12:23:10.493

好的，我终于找到了解决方案。

首先，我应该一直在寻找的是：

```
onclick="ChangeImage('somepath/somedirectory/00.jpg')" 
```

并不是：

```
onclick="ChangeImage("somepath/somedirectory/00.jpg")" 
```

所以我最终得到了这段代码：

```
echo ('<img src="' . $Files[$i] . '" onclick="ChangeImage(&#39;' . $Files[$i] . '&#39;)"/>'); 
```

现在它可以正常工作了。

# java - Android：按 id 查找按钮

> ID：14286886
> 
> 赞同：10
> 
> 时间：2013-01-11T21:25:19.080
> 
> 标签：java, android

我在查找按钮时遇到问题。我有一个`AlertDialog`选择 5 个选项之一的地方。当我选择一个选项时，我想更改我单击的按钮的颜色。我在里面的 xml 文件中声明了按钮，`<RealativeLayout>`但是当我试图通过 id 找到我的按钮（id 就像“id1”，“id2”......）使用该`findViewById`方法时，有一个错误，它说我不能像我一样使用这种方法：

```
AlertDialog.Builder builder = new AlertDialog.Builder(StartGameActivity.this);

builder.setTitle(R.string.pickColor);
builder.setItems(R.array.colorArray, new DialogInterface.OnClickListener() {
    public void onClick(DialogInterface dialog, int which) {
        Button btn_tmp;
        String theButtonId = "id";
        theButtonId = theButtonId+(String.valueOf(which));
        btn_tmp = (Button) findViewById(theButtonId);
    }
}); 
```

我该如何解决这个问题，或者我应该使用其他方法？

**编辑：**

我想我解决了我的问题。我使用了 Button 的一种方法：getId()，如下所示：

```
final int id = clickedButton.getId();
final ImageButton btn_tmp;
btn_tmp = (ImageButton)findViewById(id); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-11T21:32:31.773

## 背景：ID 本质上是变量

在`XML`文件中，我们为资源提供 ID，然后编译器使用所有这些来生成`gen/R.java`. 所以本质上，这些 ID 是属于 R 类的 int 变量。R.java 的一个示例：

```
// btw this file should never be edited!
public final class R {
  public static final class id {
    public static final int id1=0x7f0100aa;
    public static final int id2=0x7f0100ab;
  }
} 
```

仅仅因为 a`String`存在包含变量的有效名称 ( `R.id.id1`)，它就不能神奇地访问该变量。为此，可以使用[`reflection`](https://stackoverflow.com/questions/5157539/use-string-in-place-of-variable-name). 但是，在这种情况下，我认为这是不必要的并发症，甚至会[更慢](https://stackoverflow.com/q/1392351/776345)。

## `findViewById`需要一个 ID（整数变量）：

您不能`String`为此函数提供 a。您应该使用整数值，特别是与 int 中的 int 变量相对应的值`R.java`。例如：

```
findViewById(R.id.id1) // for your 1st button 
```

## 解决方案：

您可以动态选择整数值：

```
AlertDialog.Builder builder = new AlertDialog.Builder(StartGameActivity.this);

builder.setTitle(R.string.pickColor);
builder.setItems(R.array.colorArray, new DialogInterface.OnClickListener() {
    public void onClick(DialogInterface dialog, int which) {
        Button btn_tmp;
        int chosenID=-1;

        switch (which) {
        case 1:   chosenID=R.id.id1;
                  break;
        case 2:   chosenID=R.id.id2;
                  break;
        }
        btn_tmp = (Button) findViewById(chosenID);
    }
}); 
```

还建议使用更多解释性 ID，例如：`buttonDoThis`, `buttonDoThat`.

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-11T21:32:54.830

```
btn_tmp = (Button)findViewById(R.id.YourButtonId); 
```

您正在传递字符串而不是整数。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-11T21:38:31.520

如果您对对话框使用自己的 layout.xml，则需要先对其进行扩充，然后将视图提供给对话框构建器。

```
LayoutInflater layoutInflater = (LayoutInflater) StartGameActivity.this.getSystemService(
                    Context.LAYOUT_INFLATER_SERVICE);

final RelativeLayout customDialogView= (RelativeLayout) layoutInflater.inflate(R.layout.custom_dialog_view, null);

AlertDialog.Builder builder = new AlertDialog.Builder(StartGameActivity.this);

builder.setTitle(R.string.pickColor);
//give the custom view to your dialog builder.
builder.setView(customDialogView);
builder.setItems(R.array.colorArray, new DialogInterface.OnClickListener() {
public void onClick(DialogInterface dialog, int which) {
    Button btn_tmp;

    switch(which){

    //....cases

    case 1:
         btn_tmp = (Button) customDialogView.findViewById(R.id.button1);
         //set the color of the button selected
         break;

    case 2:
         btn_tmp = (Button) customDialogView.findViewById(R.id.button2);
          //set the color of the button selected
         break;
    }

     //....cases
}
}); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-11T21:37:02.097

您正在尝试将 findViewById() 与包含 ID 变量名称的字符串一起使用。Java 不支持这种动态变量名，因为变量名仅在编译时知道，而不是在运行时知道。你想做什么？您将需要找到另一种方法来解决此问题。请进一步解释，我们可以提供建议。

# node.js - 猫鼬的奇怪行为

> ID：14286887
> 
> 赞同：1
> 
> 时间：2013-01-11T21:25:32.420
> 
> 标签：node.js, mongodb, express, mongoose

首先，这段代码从今天开始完美运行，我不知道为什么，这已经改变了，我没有修改它。这是代码：

```
app.post('/upload', function (req, res){

  var tags = req.body.tags.split(" ");

  usermodel.findOne({ user: req.session.user }, function (err, user){

    console.log(user);

   var img = user.imagen.push({

     title: req.body.title,
     name: req.files.art.name,
     author: user.user,
     description: req.body.description,
     index: user.imagen.length + 1,
     path: './users/' + user.user + '/' + req.files.art.name,
     dowload: req.body.share,
     tags: tags

  });

    user.save(function (err, suser){

     if (err) throw err;

    fs.readFile(req.files.art.path, function(err, data){

       if (err) throw err;

       fs.writeFile(user.path + '/' + req.files.art.name, data, function(err){

             if(err) throw err;

             res.redirect('/home');

      }); 
     });
    });
  }); 
```

当我检查一个用户时，该用户的 imagen 数组看起来像这个'[object Object]'。为什么会发生这种情况？对此有什么解决方案...？

谢谢提前！

编辑：

这是架构：

var usersschema = new mongoose.Schema({

```
 user: String,
  pass: String,
  imagen: [{ 

              title: String,
              name: String,
              views: Number,
              type: String,
              author: String,
              tags: [String],
              description: String,
              index: Number,
              path: String,
              date: { type: Date, default: Date.now },
              dowload: String,
              like: Number,

           }], 
```

});

# mysql - SQL Server 是否有等效于 MySql 的 sql_no_cache 修饰符？

> ID：14286889
> 
> 赞同：3
> 
> 时间：2013-01-11T21:25:47.733
> 
> 标签：mysql, sql, sql-server, database

在 MySql 中测试单个查询的性能，并从图片中取出查询缓存，您可以在 select 语句中使用 sql_no_cache 修饰符：

```
select sql_no_cache * from Foo; 
```

Microsoft SQL Server 中是否有类似的每次查询选项？我看过很多关于使用的帖子：

```
CHECKPOINT
DBCC DROPCLEANBUFFERS
DBCC FREEPROCCACHE 
```

但这似乎有点矫枉过正，并且在尝试将相同的非缓存查询的性能与 MySql 进行比较时，可能会给 SQL Server 带来不利影响。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-11T21:47:40.033

要从缓存中删除特定的查询计划，请获取查询的计划句柄：

```
SELECT
    t.text,
    s.plan_handle,
    s.creation_time,
    s.last_execution_time
FROM sys.dm_exec_query_stats as s
CROSS APPLY sys.dm_exec_sql_text (s.sql_handle) as t
-- optionally filter based on query text
-- WHERE t.text LIKE '%blah%'; 
```

SQL Server 2008+ 允许传递计划句柄以[`DBCC FREEPROCCACHE`](http://msdn.microsoft.com/en-us/library/ms174283.aspx)从缓存中删除特定计划：

```
DBCC FREEPROCCACHE (<plan_handle>); 
```

# c# - await 是否等同于使用 TaskContinuationOptions.AttachedToParent 选项创建延续？

> ID：14286890
> 
> 赞同：1
> 
> 时间：2013-01-11T21:25:56.080
> 
> 标签：c#, .net, async-await

> **可能重复：** [Async await 关键字是否等同于 ContinueWith lambda？](https://stackoverflow.com/questions/8767218/is-async-await-keyword-equivalent-to-a-continuewith-lambda)

编辑：

我看到这个问题已被标记为重复，但它并不完全相同。我特意询问 await 是否等同于 ContinueWith IN CONJUNCTION WITH TaskContinuationOptions.AttachedToParent

这是（在异步方法体内）

```
 await SomeMethodAsync();

    Console.WriteLine("hi"); 
```

相当于

```
 Task.ContinueWith(delegate() {

        Console.WriteLine("hi");

    }, TaskContinuationOptions.AttachedToParent);

} 
```

?

我在谷歌上能找到的唯一答案是这些不相等，但我不相信，因为 -

在第一个示例中，异步方法主体在第一次等待时立即将任务返回给用户，如果任务没有等待子任务（因为 AttachedToParent 选项），那么它已经完成了。

我的理智取决于这种情况。

我在谷歌上找到的答案在这里 [http://social.msdn.microsoft.com/Forums/en-US/async/thread/bec2151a-abfd-43b9-a2e0-ffe34ae481f6/](http://social.msdn.microsoft.com/Forums/en-US/async/thread/bec2151a-abfd-43b9-a2e0-ffe34ae481f6/)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-11T21:56:16.203

所以斯蒂芬图布显然是一个相当权威的人物......

我做了一些测试，现在我明白了为什么 await 不需要使用 AttachedToParent 创建它的延续。

这是因为这个

```
await SomeMethodAsync(); 
```

正在接收继续的结果，然后父任务从中断的地方继续

# coldfusion - CF扩展组件突然停止工作

> ID：14286891
> 
> 赞同：3
> 
> 时间：2013-01-11T21:26:05.770
> 
> 标签：coldfusion, components, coldfusion-10

我们有一组 Coldfusion 应用程序，它们都扩展了应用程序库的各个部分。我将提供一些代码，然后解释我们遇到的问题，看看是否有人可以阐明解决此问题的最佳方法：

在 app.cfc 中的“OnRequestStart”中，我们有以下行来启动用户：

```
if(!structKeyExists(SESSION, 'user'))
SESSION.user = CreateObject("component","cfcs.ds_user"); 
```

然后在 ds_user.cfc 我们这样称呼它：

```
component extends="cas.cas_user" displayname="basic_user"{ 
```

应用程序及其所有部分按应有的方式运行。但是，一段时间后，应用程序会以一种看似随机的方式崩溃，我必须重新启动 ColdFusion 服务才能使其再次运行。我得到的错误是：

```
Could not find the ColdFusion component or interface cas.cas_user. 
```

因此，一段时间后，无论出于何种原因，我的应用程序决定它找不到父组件的路径。该 cfc 的映射位于顶部的 application.cfc 中，如下所示：

```
THIS.mappings["/cas"] = "#ReplaceNoCase(currpath,ListToArray(THIS.name,'_')[1],'cas30')#assets\cfcs\"; 
```

我想肯定地说，该应用程序在随机时间内按设计完美运行​​，然后它找不到父组件，并且在我重新启动服务器上的 ColdFusion 服务之前不会再次找到它。

我认为这在某种程度上是内存泄漏或其他原因，但我不知道从哪里开始寻找解决问题的方法。我们有 6 个左右的其他应用程序以相同的方式扩展并且工作正常且永不崩溃，但这个确实如此。

编辑：为了更清楚地了解映射。我们的应用程序位于：

*   root.com/app1
*   root.com/app2

我们在 app1 中使用上述方法创建了映射以从 app2 中获取 cfcs。虽然我认为这种方法有点奇怪，但该方法确实适用于我们所有的应用程序。

编辑：显示一段时间的正确映射是：

```
/cfcs - D:\www\app1\assets\cfcs
/templates - D:\www\app1\assets\templates
/cas - D:\www\app2\assets\cfcs
/common - D:\www\app3\assets\common_elements 
```

但是，一旦应用程序进入“崩溃模式”，转储就会显示映射如下：

```
/cfcs - D:\www\app1\assets\cfcs
/templates - D:\www\app1\assets\templates
/cas - D:\www\app1\assets\cfcs
/common - D:\www\app1\assets\common_elements 
```

以下是在 Application.cfc 开头定义这些映射的方式：

```
currpath = GetDirectoryFromPath(GetCurrentTemplatePath());
THIS.mappings["/templates"] = "#currpath#assets\templates";
THIS.mappings["/cfcs"] = "#currpath#assets\cfcs";
THIS.mappings["/common"] = "#ReplaceNoCase(currpath,ListToArray(THIS.name,'_')[1],'gum')#assets\common_elements\";
THIS.mappings["/cas"] = "#ReplaceNoCase(currpath,ListToArray(THIS.name,'_')[1],'cas30')#assets\cfcs\"; 
```

THIS.name = digisign_CAAAFACBBFDFFE 或

```
name_var = (arrayLen(meta_array) >= 2) ? meta_array[arrayLen(meta_array) - 1] & '_' : 'root_';
THIS.name = name_var & right(reReplace(hash(getCurrentTemplatePath()), "[^a-zA-Z]","","all"), 64 - len(name_var)); 
```

哪里会失败。似乎替换语句不起作用，因此在设置映射时路径中的 appname 没有从 app1 更改为 app2。这是否可能与我们目前正在解决的这个错误有关：[http](http://forums.adobe.com/message/4657868#4657868) ://forums.adobe.com/message/4657868#4657868 我们尚未在生产中应用更新 4 补丁。然而，我们认为这个问题发生在 CF10 之前。虽然我们有这个问题，但它最近才出现。这个有问题的应用程序已经像这样崩溃了很长时间。

**编辑：** 1\. 我想当我说“崩溃”时，我的意思是应用程序进入一种状态，在我重新启动 Coldfusion 之前它不会正确声明映射。我假设我们代码中的错误会导致崩溃。2.这通常是问题发生的地方，在对 SESSION.user var 进行此检查时。我相信它也发生了，它决定它找不到我们的数据源。这是罕见的。3\. 一开始我以为是的，但实际上没有，没有那么多。在我们的应用程序中，我们有几个常见映射的名称。`cas` `common` `cfcs` `templates`等等。但是`D:\www\cas`是应用程序所在的`domain.com/cas30`位置。但是，该应用程序的旧版本位于`domain.com/cas`. 映射`/cas`应该去`D:\www\cas30\assets\cfcs`和作品。4.我们有一个开发设置，这永远不会发生。（我认为这是一个负载问题，这就是为什么它不会在 dev 上发生）。然而，我们的开发环境是这样构造的：

```
D:\www\deva\app1
D:\www\deva\app2
D:\www\devb\app1
D:\www\devb\app2 
```

5.  我们所做的（我认为这很愚蠢）是我们有一个文件位于与当前应用程序不同的目录中。此文件称为 application_base.cfc。其他应用程序中的所有 application.cfcs 都是从这个 application_base.cfc 扩展而来的。它们不是从其他 Application.cfc 文件扩展而来的。（希望有意义）在 application_base 中有一个 init、onrequeststart 和一个 onerror。我将在下面发布 App.cfc。此外，一些设置是从应用程序库（以确定环境内容）和应用程序级别的 XML 文件中读取的。但是我们认为这可能是导致问题的原因，因此之前的开发人员在应用程序级别删除了 xml 文件。6.是的。我将发布 app.cfc 和 appbase.cfc，以便您查看两者。
6.  通过重新初始化，您的意思是调用 onapplicationstart 或其他东西。从来没听说过。
7.  我们做的一些应用程序：

    currpath = GetDirectoryFromPath(GetCurrentTemplatePath()); app_path = ListToArray(currpath,'\'); THIS.name = app_path[ArrayLen(app_path)];

这个可以：

```
meta_array = ListToArray(GetMetaData(this).name,'.');
name_var = (arrayLen(meta_array) >= 2) ? meta_array[arrayLen(meta_array) - 1] & '_' : 'root_';
THIS.name = name_var & right(reReplace(hash(getCurrentTemplatePath()), "[^a-zA-Z]","","all"), 64 - len(name_var)); 
```

其他一些人也这样做。不确定是不是两个不同的开发人员或其他什么，但就是这样。

一旦应用程序失败，它就会失败，直到我重新启动coldfusion。该应用程序需要从`domain.com/app`页面登录，因此（不是说它不能从请求更改为请求）但请求位置始终与失败的位置相同。

上帝，我希望它没有这么复杂。我最近将我们当前的 CMS 从很多这些疯狂的东西中撤出，但我们有 7 或 8 个应用程序相互交织在一起，旨在在具有不同路径的开发/生产环境中工作，有时很难说出我可以删除什么而我不能。

我以为我尝试从我们的错误处理程序中转储应用程序名称，但我认为除非传入它，否则它不起作用。我通过了映射，所以我可以看到它们，这就是我知道在“崩溃”`digisign`中不会改变为应该的样子`cas30`模式。

我认为所有的动态映射都是为了让原始开发人员可以使用相同的 app.cfc 模板而无需更改任何内容。他喜欢做一些`var a = (b) ? (a-c) ? a-f+b : (a+b) ? d : d; : a; h;`没有评论的废话，所以有时很难仅仅阅读该死的代码，更不用说调试了。

**编辑**

我觉得这个问题可能与[stackoverflow.com/q/14300915/1229594问题有关。](https://stackoverflow.com/q/14300915/1229594)我还在这里发布了更多详细信息：[forums.adobe.com/message/5022377#5022377](http://forums.adobe.com/message/5022377#5022377)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-11T22:02:35.390

首先要做的事情：你为什么要初始化面向会话的东西`onREQUESTStart()`？如果您在 中启动它`onSessionStart()`，您就不需要在每个请求中检查它的存在，这 - 虽然微不足道 - 是不必要的开销，并且只是错误位置的错误代码。

其次......你引用你的错误，但不要说它发生在哪里。它发生在 onRequestStart() 的那一行吗？

如果是这样，请帮我一个忙：在它周围放一个 try/catch，然后在其中将 的值`this.mappings`以及 . 的值写入日志文件`currPath`。顺便说一句，该变量的值是如何得出的？

也就是说，我认为如果您将`session.user`初始化代码放在正确的位置，它将解决您的问题。

注意：几乎可以肯定这个问题*不是*内存泄漏（即：ColdFusion 的错），而是你的代码做了你没有预料到的事情（所以......错误......*你的*错;-）。这将有助于更好地专注于发现问题。我没有对你动手，但是“我的代码哪里错了”是比“它可能是别的东西”更好的方法。而且更有可能是正确的;-)

哦……你用的是什么版本的CF？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-18T22:54:43.247

**一些问题：**

1.  您是假设崩溃是由代码错误引起的，还是由于崩溃而发生代码错误？

2.  会话用户的实例化是您看到这些路径错误的唯一代码行吗？

3.  您的应用程序中是否有与映射名称同名的物理目录？

4.  这是否发生在任何其他环境（开发/测试）中？这是集群环境吗？

5.  是否有多个 Application.cfc 文件扩展同一个 Application.cfc？

6.  是否有任何代码直接调用 Application.cfc 方法？

7.  是否有任何代码导致应用程序重新初始化自身？

8.  是什么确定`meta_array`用于派生应用程序名称的？

**几点观察：**

在我看来，应用程序名称正在更改，或者其他一些应用程序正在用相同的名称覆盖。这似乎并不牵强，因为这里正在进行大量的动态命名。从应用程序名称开始，它取决于当前模板的物理位置，这可能因请求而异，具体取决于应用程序路由请求的方式。如果当前模板发生变化，则应用程序名称将发生变化，并导致其他特定于应用程序的映射发生变化，这将对使用该应用程序名称来确定这些映射的物理位置的所有其他映射产生级联效应。

这就引出了一个问题：为什么所有这些对应用程序名称和映射位置的动态评估甚至是必要的？它可以简化或硬编码吗？您可以改用服务器映射吗？如果不必**如此**复杂，将其简化为最基本的要素将有助于故障排除并可能完全解决问题。

最后，您能否验证正常操作期间的应用程序名称是否与发生错误时引用的应用程序名称相同？

*   如果它们不同，则某些原因导致应用程序在不同的上下文中执行（有关线索，请参阅我上面的初始问题）。应用程序名称的突然更改将使任何现有会话无效并强制会话用户实例化代码重新运行。并且由于用户组件路径部分基于应用程序名称，因此路径可能不再正确。

*   但是，如果应用程序名称在正常操作和崩溃模式之间相同，则很可能该`currpath`变量受到应用程序的某些部分的影响，该应用程序的某些部分在与预期不同的物理路径中执行。由于`currpath`直接用于确定其余映射，这当然可以解释为什么意外路径会导致组件丢失。

*   因为派生这些名称有很多变量，所以在正常操作和崩溃模式期间记录这些变量会很好。你会想看看

    ```
    GetCurrentTemplatePath()
    GetDirectoryFromPath(GetCurrentTemplatePath())
    THIS.name
    meta_array
    THIS.mappings 
    ```

我怀疑在正常运行和发生崩溃/错误时，您会在这些变量中发现一些明显不同的东西，而这种差异应该会让您更接近答案。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-11T22:03:30.897

看看这个，看看它是否与你的问题有关。 [https://github.com/Mach-II/Mach-II-Framework/wiki/Application-Specific-Mapping-Workaround](https://github.com/Mach-II/Mach-II-Framework/wiki/Application-Specific-Mapping-Workaround)

如果不是，那么它可能与相同名称的应用程序特定映射有关，在同一个 CF 服务器上，这些应用程序具有不同的应用程序名称。

# database - 访问 VBA 将表值与常量进行比较并更新它

> ID：14286892
> 
> 赞同：0
> 
> 时间：2013-01-11T21:26:07.810
> 
> 标签：database, vba, compare

好的，所以我正在尝试编写 VBA 代码以尽可能地自动化。我需要它做的是从表中的字段中读取，如果它满足条件，则将其复制到新表中。这是为了旋转的目的。如果`CurrentDate`等于`NextDateOut`该项目的任何值，我想转到某个表，但也想更新当前表中的值。 `NextDateOut`将是`LastDateOut`表中的新值，`NextDateIn`距 NextDateIn 10 天，从那时起`NextDateOut`10 天。我可以编写此数学逻辑，它只是将我的表中的值与我现在的常量进行比较，`CurrentDate`并在条件满足时更新值并将值写入某个表。

这是到目前为止的代码，并且试图弄清楚它也有很多错误。

```
Option Explicit
Sub Run()
    'Declarations for grabbing data from the database for the VBA
    Dim db As DAO.Database
    Dim rst As DAO.Recordset
    Dim strSQL As String

    'Open connection to current Access database
    Set db = CurrentDb()

    'Declarations for variables to deal with dates
    Dim CurrentDate As Date
    Dim NextDateOut As Date
    Dim NextDateIn As Date
    Dim LastDateOut As Date
    Dim LastDateIn As Date

    'Setting a consistant value, technically not a constant value since there's no "const"
    CurrentDate = Date

    'Will take this out eventually
    MsgBox (CurrentDate)

    strSQL = "SELECT Next Date Out FROM Tapes Where Next Date Out = CurrentDate"
    Set rst = db.OpenRecordset(strSQL, dbOpenDynaset)
    With rst
    If .RecorCount > 0 Then
        .MoveFirst
        .Edit
        !Next Date Out = (CurrentDate+20)
      .Update
    End If
    End With
End Sub 
```

提前致谢！！！我正在取得进展，但在路上碰壁了。再次感谢！！！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-11T21:40:39.270

我认为您可以通过查询直接解决此问题。

让我们把这个问题分成几个步骤：

如果`NextDateOut`（表中的字段）等于`currentDate`（代码中的变量），则：

1.  您需要将条件为真的所有记录移动到新表中
2.  对于保留在表中的记录，您需要更新`LastDateOut`to `currentDate`、`nextDateIn`to`currentDate + 10`和`nextDateOut`to`currentDate + 20`

如果这是正确的，你可以试试这个：

```
dim strSQL as String
dim currentDate as Date
...
' Step 1: Copy the records to a new table '
strSQL = "insert into otherTable " & _
         "select * from tapes " & _
         "where [nextDateOut]=" & CDbl(currentDate)
doCmd.runSQL strSQL

' Step 2: Delete the records just copied '
strSQL = "delete from tapes where [nextDateOut]=" & CDbl(currentDate)
doCmd.runSQL strSQL

' Step 3: Update the dates in ALL the records remaining the "tapes" table '
strSQL = "update tapes " & _
         "set [lastDateOut]=" & CDbl(currentDate) & ", " & _
         "set [nextDateIn]=" & CDbl(currentDate + 10) & ", " & _
         "set [nextDateOut]=" & CDbl(currentDate + 20)
doCmd.runSQL strSQL
... 
```

**注意：**我`CDbl(currentDate)`用来避免日期格式的问题（MS Access 将日期存储为双精度值，整数部分表示天数，小数部分表示天数的小数部分）

希望这可以帮助你

# iphone - NSURLConnection 异步请求在发送期间切断正文

> ID：14286893
> 
> 赞同：0
> 
> 时间：2013-01-11T21:26:17.530
> 
> 标签：iphone, cordova, post, nsurlconnection

我有一种方法可以定期将数据发送到服务器并接收响应代码。我为它实现了 NSURLConnection 的 sendAsynchronousRequest，它可以很好地处理小数据。我有机会测试发送 base64 编码的图片，这是该应用程序的一项常见任务，并且发现它在编码图像的几个字符后切断。这是涉及的代码。

```
// Initial setup
NSString *urlStr = @"https://example.com/";
urlRequest = [[NSMutableURLRequest requestWithURL:[NSURL URLWithString:urlStr]] retain];
[urlRequest setHTTPMethod:@"POST"];
[urlRequest setCachePolicy:NSURLRequestReloadIgnoringLocalCacheData];
[urlRequest setValue:@"application/x-www-form-urlencoded" forHTTPHeaderField:@"Content-Type"];

// The actual sending part
- (void)sendRequest:(NSString *)reqStr {

@try {
    if (sendRequestStatus == kRequestState_waiting) {
        sendRequestStatus = kRequestState_processing;
        NSString *dataStr = [NSString stringWithFormat:@"request_data=%@",reqStr];
        NSLog(@"datastr is %@",dataStr);
        NSData *dataForUrl = [dataStr dataUsingEncoding:NSUTF8StringEncoding];
        NSLog(@"nsdata length is: %i",[dataForUrl length]);
        [urlRequest setHTTPBody:dataForUrl];
        NSOperationQueue *queue = [[NSOperationQueue alloc] init];

        [NSURLConnection sendAsynchronousRequest:urlRequest queue:queue completionHandler:^(NSURLResponse *res, NSData *data, NSError *err) {
          // housekeeping
        }];
    }
} 
```

我在日志中没有错误。打印出 dataStr 的日志语句打印出正确的数据。打印数据长度的日志语句打印出183384字节，这似乎适合图片。然而，在服务器上，帖子正文在编码图像数据开始后被截断几个字符。一个例子是`/9j/4`4 是服务器收到的最后一个字符。

我正在 iPhone 3Gs 上进行测试。这是一个phonegap应用程序，在我的Android版本上测试没有问题，所以问题一定出在我发送数据的实现上。我没有从其他使用 iPhone 4 或 4s 的测试人员那里听到任何问题，因此这可能是处理速度的问题。我能做些什么来收紧它并防止柱体被切断？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-19T13:52:28.060

我没有测试它，但也许问题是这样的：

```
[urlRequest setValue:@"application/x-www-form-urlencoded" forHTTPHeaderField:@"Content-Type"]; 
```

我会尝试这个：

```
[urlRequest setValue:@"text/plain" forHTTPHeaderField:@"Content-Type"]; 
```

因为您正在发送一个 base 64 编码的字符串。

# c# - 公开基础库中定义的枚举类型

> ID：14286898
> 
> 赞同：7
> 
> 时间：2013-01-11T21:26:34.653
> 
> 标签：c#, interface, enums

我正在尝试修改我的日志库。这是我卡住的地方。我使用枚举，我们称之为 ActionType，来识别我的操作，如 UserLogin、PurchaseOrder ......数百个。我在我的记录器方法中使用这种类型。但是由于我为了松散耦合而将我的记录器库与我的项目特定代码分开，并且基础库无法访问项目中定义的 ActionType，我该如何实现这一点。为了澄清它，让我解释一下java中的相同情况。Java 允许枚举实现接口。所以我可以写：

在基本记录器库中，我可以定义；

`public interface IActionType {}`

在我的几个项目之一中

`public enum ActionType implements IActionType {UserLogin, PurchaseOrder, .....}`

所以当我调用我的 `logger.log(ActionType.UserLogin, ....)`基础库时会得到底层的操作。这一切就足够了。无论如何，它周围有没有在 c# 中完成这个？顺便说一句，我考虑过使用 IoC 容器，但我想要更优雅的东西。

非常感谢您的帮助...

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-11T21:34:03.057

这是 log4net 用于`Level`类的方法（是的，它是类，而不是枚举）：

```
public class ActionType : IActionType
{
   public static readonly ActionType UserLogin;
   public static readonly ActionType PurchaseOrder;

   static ActionType()
   {
       UserLogin = new ActionType(1, "User Login");
       // ...
   }

   public ActionType(int value, string name)
   {           
       // verify arguments values
       Value = value;
       Name = name;
   }

   public int Value { get; private set; }
   public string Name { get; private set; }
} 
```

和接口

```
public interface IActionType
{
    int Value { get; }
    string Name { get; }
} 
```

用法：

```
logger.Log(ActionType.UserLogin); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-11T22:07:27.270

懒惰打败了我，但无论如何我都会发布我的解决方案

```
public void MyUsage(ITypesafeEnum myEnum)
{
    Console.WriteLine(myEnum.Name);
    Console.WriteLine(myEnum.Val);
}

public interface ITypesafeEnum{
    string Name{get;}
    int Val {get;}
}

public  class TypesafeEnum:ITypesafeEnum{

    public string Name {get;private set;}
    public int Val {get;private set;}
    private TypesafeEnum(){}
    private TypesafeEnum(string name, int val){
        Name = name;
        Val = val;
    }

    public static readonly TypesafeEnum Bedroom = new TypesafeEnum("Bedroom", 1);
    public static readonly TypesafeEnum LivingRoom = new TypesafeEnum("Living Room",2);
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-11T22:04:25.083

这是另一种使用泛型的方法：

```
public void Log<EnumType>(EnumType enumMember)
{
    var name = enumMember.ToString();
    int value = (int)(object)enumMember;
    Console.WriteLine(name + " = " + value);
} 
```

像这样调用上面的方法：

```
Log<ActionType>(ActionType.UserLogin);
Log<ActionType>(ActionType.PurchaseOrder); 
```

结果如下所示：

```
UserLogin = 0
PurchaseOrder = 1 
```

# exit - 是否可以退出 Freemarker 模板？

> ID：14286899
> 
> 赞同：3
> 
> 时间：2013-01-11T21:26:34.877
> 
> 标签：exit, template-engine, freemarker

我希望能够从 <#if> 标记内结束页面的呈现。

我知道 <#stop> 标记，但我不想为了让页面停止呈现而抛出异常。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-12T00:15:05.490

这是一个肮脏的技巧：将模板的全部内容放入宏中，然后立即调用该宏。您可以在宏内部使用`<#return>`.

# android - Vitamio 是否支持内联 HLS 视频流？

> ID：14286905
> 
> 赞同：0
> 
> 时间：2013-01-11T21:27:25.367
> 
> 标签：android, video-streaming, vitamio

我有兴趣将[Vitamio](http://vitamio.org/)用于将使用 HLS 视频并支持旧 2.x 版本的 Android 的 Android 项目。

我正在尝试播放里面的视频和 html5`<video>`标签，但需要它内联播放而不是全屏播放。此外，我希望这适用于直播（即网络摄像头）而不是预先录制的视频。

有谁知道它是否可以做到这一点？或者，我可以使用另一个库来完成这项工作吗？

此外，如果我不能支持回到 2.x，但这可以在 3.x 中工作，我也很想知道这一点。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-26T03:18:13.933

Vitamio 网络协议

音频和视频播放支持以下流协议：

MMS RTSP (RTP, SDP), RTMP HTTP 渐进式流媒体 HLS - HTTP 实时流媒体 (M3U8) 是的，Vitamio 可以处理所有上述协议中的点播和实时视频。

# .net - 监视器输入错误 - 如何抓取执行

> ID：14286906
> 
> 赞同：0
> 
> 时间：2013-01-11T21:27:27.810
> 
> 标签：.net, multithreading

我需要完全实现以下模式

```
R-------   ----     ----    ------
W       ----    -----    ---- 
```

如何使用 Monitor 实现这一点？下面的代码在某处包含错误，但我找不到它，我不熟悉多线程。

我需要像使用 fiber 一样的行为，但我无法更改运行时并且生产代码无法使用 yield return(C# 1.0)。

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Threading.Tasks;
using System.Threading;

namespace ConsoleApplication1
{
    class Program
    {
        static object o = new object();

        static void Main(string[] args)
        {          
            Monitor.Enter(o); // make writer wait at start

            ThreadPool.QueueUserWorkItem(x => {
                WaitForStart();
                Console.WriteLine("Entering");
                Yield();
                Console.WriteLine("yield 1");
                Yield();
                Console.WriteLine("yield 2");
                Yield();
                Console.WriteLine("yield 3");
                Yield();
                Console.WriteLine("Exiting");
            });

            Console.WriteLine("Finishing");
            Start(); // start th writer

            Console.WriteLine("get 1");
            Get();
            Console.WriteLine("get 2");
            Get();
            Console.WriteLine("get 3");
            Get();
            Console.WriteLine("Finishing");

            Console.ReadLine();
        }

        private static void Get()
        {
            Monitor.Enter(o);
            Monitor.Pulse(o);
            Monitor.Exit(o);
        }

        private static void Yield()
        {
            Monitor.Pulse(o);
            Monitor.Exit(o);
            Monitor.Enter(o);
        }

        private static void WaitForStart()
        {
            Monitor.Enter(o);
        }

        private static void Start()
        {
            Monitor.Pulse(o);
            Monitor.Exit(o);
        }

    }
    } 
```

# jquery - 功能是否可以延迟而不是延迟开始？

> ID：14286907
> 
> 赞同：1
> 
> 时间：2013-01-11T21:27:29.783
> 
> 标签：jquery, delay

我有 2 个 jquery 函数：

```
$(document).ready(function(){
        $("#title").click(function(){
            $("#click").delay(2700)
                    .css({opacity: 0.0, visibility: "visible"})
                        .animate({opacity: 0.5
                      });
                 });
             }); 
```

和

```
$(document).ready(function(){
    $("#click").hover(
        function () {
          $("#card12").animate({top:'220px'},100);}, 
        function () {
          $("#card12").animate({top:'330px'},100);
         });
    }); 
```

这就是它的工作原理：
1\. 我单击 (div id = #title)
2\. (div id=#click) 将显示 2700 毫秒延迟
3\. 每当我将光标指向 (div id=#click), (div id=#card12) 将向上滑动

我的问题是：
1\. 我在 2700 毫秒之前不小心将光标指向 (div id =#click) 区域（(div id=#click) 出现的延迟）
2\. 而不是忽略它， (div id=# card12) 在 (div id=#click) 完全加载后立即响应（向上滑动）

例如：我将光标指向 (div id=#click) 区域，然后将光标移出该区域外来回在 2700 毫秒之前 2 次（出现 (div id=#click) 之前的延迟）。

只要 (div id=#click" 已完全加载 (即使我的光标在加载时位于 (div id=#click) ) 区域之外

我的问题是：
是否可以忽略 2700 毫秒之前发生的任何事情（出现之前的 #click 延迟）？

PS：我知道如果我可以使用 codePen/jsFiddle 来执行它会更容易。但我不知道如何使用 codePen/jsFiddle 使用 2 jquery-(ies?)

非常感谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-11T21:36:58.100

您可能需要考虑在 click 函数中添加悬停绑定，如下所示：

```
$(document).ready(function(){
    $("#title").click(function(){
        $("#click").delay(2700)
            .css({opacity: 0.0, visibility: "visible"})
            .animate({opacity: 0.5})
            .hover(
                function () {
                    $("#card12").animate({top:'220px'},100);}, 
                function () {
                    $("#card12").animate({top:'330px'},100);
            });
        });
    });
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-11T21:37:19.383

将悬停 jQuery 放在第一个动画 jQuery 的回调中。

```
$(document).ready(function () {
  $("#title").click(function () {
    $("#click").delay(2700).css({opacity: 0.0,visibility: "visible"}).animate({
      opacity: 0.5}, function () {
      $("#click").hover(function () {
        $("#card12").animate({top: '220px'}, 100);
      },function () {
        $("#card12").animate({top: '330px'}, 100);
      });
    });
  });
}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-11T21:38:37.203

如果我理解正确，您的#click 元素会在延迟后显示，然后您才希望用户能够单击它并显示卡片元素。一个简单的解决方法是使用 display:none 与 visibility:hidden。这可能是也可能不是一个选项。可见性的好处是您的元素可以保持其空间，但有一些方法可以解决这个问题。如果使用 display: none 不是一个选项，我认为您想要实现的目标可以通过执行以下操作来完成。

```
$(document).ready(function(){
    $("#title").click(function(){
        setTimeout(function(){
            $("#click").css({opacity: 0.0, visibility: "visible"}).animate({opacity:0.5});
            $("#click").hover(
                function () {
                    $("#card12").animate({top:'220px'},100);}, 
                function () {
                    $("#card12").animate({top:'330px'},100);
                }
            );
        },2700);
    });
}); 
```

我看不到您的代码，但假设您的 #click 元素是您的 #title 元素的子元素，我将使用上面的代码，但将 #click 更改为 $(this).children() 类型选择器以获得正确的元素. 但是，由于您似乎使用 ids 作为选择器而不是类，我假设页面上的每个元素只有一个，并且使用 ids 作为选择器应该没问题。基本上我的代码在 2700 毫秒后分配悬停事件侦听器，这就是 setTimeout 的用途。

# git - 如何重置我的本地分支以跟踪远程分支

> ID：14286908
> 
> 赞同：0
> 
> 时间：2013-01-11T21:27:36.040
> 
> 标签：git

我正在设置我的本地分支来跟踪远程分支，如下所示：

```
$ git branch --set-upstream foo upstream/foo 
```

但是当我做 git status 时，我得到：

```
$ git status
# On branch foo
# Your branch and 'upstream/foo' have diverged,
# and have 108 and 43 different commits each, respectively. 
```

我可以做些什么来修复我的本地分支，使其不再与远程分支分歧？我的一个想法是删除我的本地分支并重新创建另一个分支来跟踪同一个远程分支。有没有别的办法

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-11T21:36:03.293

你有两条不同的发展路线。你有两个选择：

*   放弃您的一些更改，或
*   合并两组更改

第一个选项很简单。删除本地分支然后签出远程分支的新本地副本将完成此操作。您还可以：

```
git reset --hard upstream/foo 
```

第二个选项可能需要您手动更正合并冲突。理论上，只需运行：

```
git pull 
```

应该执行合并，让您清理任何冲突。

# internet-explorer - 诺基亚 Windows 手机中的 Internet Explorer 10 没有响应

> ID：14286912
> 
> 赞同：4
> 
> 时间：2013-01-11T21:27:52.170
> 
> 标签：internet-explorer, responsive-design, windows-phone-8, nokia

我使用 Twitter 引导程序使我的网站具有响应性。一切都很好，但诺基亚（Lumia 920）windows phone 中的 IE 10。我搜索了很多，每个人都说如果我添加 @media(max-width:480px){@-ms-viewport{width:320px;} ...} 它会解决问题，但问题仍然存在。它不仅适用于我的网站，也适用于所有其他网站。windows phone 中的 IE 10 根本没有响应。任何想法谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-21T15:43:54.417

你看过特伦特沃尔顿的这篇文章吗？其中他谈到了 WP8 中的媒体查询和 IE10 - [http://trentwalton.com/2013/01/16/windows-phone-8-viewport-fix/](http://trentwalton.com/2013/01/16/windows-phone-8-viewport-fix/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-04-30T16:43:42.390

我有同样的问题，我使用这个元标记修复了它：

```
<meta charset="utf-8" />
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" /> 
```

在这里更好地解释：http: [//getbootstrap.com/getting-started/#template](http://getbootstrap.com/getting-started/#template)

干杯。

# ios - 如何检查 NSString isEqualToString 是否有很多值

> ID：14286917
> 
> 赞同：0
> 
> 时间：2013-01-11T21:28:30.983
> 
> 标签：ios, objective-c, cocoa, nsstring

我正在寻找在最短的时间内将 NSString 与大约 200,000 个其他字符串进行匹配的最有效方法。基本上我需要每隔一段时间检查一次输入的单词是否是英语的一部分。

我有什么方法可以做到这一点？我听说过哈希表——这是最好的方法吗？

* * *

## 这是我确定的代码：

**编辑：字典初始化到内存的基准：**

```
NSDate *start = [NSDate date];

NSLog(@"initWords");

//temporary 
NSString *_filePath = [[NSBundle mainBundle] pathForResource:kFILE_NAME_FOR_DICTIONARY ofType:@"txt"];

NSLog(@"%@",_filePath);

NSString *_fileContents = [[NSString alloc] init];
NSData *_binary = [NSData dataWithContentsOfFile:_filePath];  

if (_binary) {  
    _fileContents = [[NSString alloc] initWithData:_binary encoding:NSUTF8StringEncoding];
}  else {

    NSLog(@"file parse error: did you forget to add the file? Please add file to:\n\n\n\n%@\n\n\n\n",[[NSBundle mainBundle] resourcePath]);
}

NSArray *_wordList = [_fileContents componentsSeparatedByString:kNEW_LINE_CHAR];

englishDictionary = [[NSMutableSet alloc] init];
[englishDictionary addObjectsFromArray:_wordList];

NSLog(@"Word count:\t%d",englishDictionary.count);
NSLog(@"Time to init dictionary:\t%f",[start timeIntervalSinceNow]*-1.); 
```

iphone 5：1.089725（秒）

iPad 1：3.082753

iphone 4: 3.582853

**基准（测试单词是否在字典中的时间）：**

```
-(BOOL)checkWord:(NSString *)word{

    NSDate *start = [NSDate date];

    BOOL yesNoMaybeSo = [englishDictionary containsObject:word];

    NSLog(@"Time to check word:\t%f",[start timeIntervalSinceNow]*-1.);
    return yesNoMaybeSo;

} 
```

iphone 5：0.000021（秒）

iPad 1：0.000037

iphone 4: 0.000043

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-11T21:34:14.483

最有效的方法可能是使用 a`NSSet`来存储要与字符串进行比较的所有单词。

然后您只需检查您的单词是否属于如下集合

```
BOOL englishWord = [theEnglishSet containsObject:yourString]; 
```

这将需要固定的时间来执行。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-11T21:34:36.620

有了这样的要求，标准方法/类将不适合您的需求。您应该学习/阅读一些有关算法的书籍以正确实现这一点。看起来您应该使用哈希表，但是，同样，对于 200K 值 NSDictionary（它是哈希表）可能无法足够快地工作。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-14T15:17:44.693

如果您不介意自己滚动，您可以从字典中构建一个[trie](http://en.wikipedia.org/wiki/Trie)（又名前缀树）并使用它来查找单词。我敢打赌，使用 c 字符串和结构的相当好的实现会比 NSDictionary 更快、更节省内存。

# wpf - 形状类型的 WPF DataTemplate 失败

> ID：14286927
> 
> 赞同：5
> 
> 时间：2013-01-11T21:29:32.227
> 
> 标签：wpf, datatemplate

我正在尝试设置将用于`Line`( `System.Windows.Shapes.Line`) 对象的 WPF DataTemplate。

从默认的 .NET 4 WPF 应用程序中，我将 Window xaml 设置为：

```
<Window x:Class="WpfTestDataTemplates.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:system="clr-namespace:System;assembly=mscorlib"
        Title="MainWindow" Height="350" Width="525">
    <Window.Resources>
        <DataTemplate DataType="{x:Type system:String}" >
            <TextBlock>It's a string</TextBlock>
        </DataTemplate>
        <DataTemplate DataType="{x:Type Line}" >
            <TextBlock>It's a line</TextBlock>
        </DataTemplate>    
    </Window.Resources>

    <ListView ItemsSource="{Binding MyItems}" />
</Window> 
```

后面的代码是：

```
using System.Collections.Generic;
using System.Windows;
using System.Windows.Shapes;

namespace WpfTestDataTemplates
{
    public partial class MainWindow : Window
    {
        public List<object> MyItems {get; set; }

        public MainWindow()
        {
            InitializeComponent();
            DataContext = this;

            MyItems = new List<object>();
            MyItems.Add("The first string");
            MyItems.Add(new Line { X1 = 0, Y1 = 0, X2 = 5, Y2 = 5 });
            MyItems.Add("The second string");
            MyItems.Add(new Rectangle { Height = 5, Width = 15 });
            MyItems.Add(42);
        }
    }
} 
```

生成的窗口如下所示： ![结果窗口](../Images/846e82824da7687d72fb492c00de0894.png)

我希望第二个条目是：这是一行，但似乎`Line`找不到该类型的 DataTemplate。对于没有显式 DataTemplate 的类型，我希望默认呈现是对象的 .ToString() 成员，但这也不是正在发生的事情。所以我希望第四个条目是：System.Windows.Shapes.Rectangle

为什么`{x:Type Line}`无法识别类型，以及将什么 DataTemplate 应用于 Shape 对象？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-12T12:39:22.433

A`DataTemplate`是您用来将 UI 放在不是它们自身`UIElements`并且没有在屏幕上呈现它们自己的概念的数据对象上的东西。`Line`然而是 UIElements - 他们知道如何呈现自己，并且`Rectangle`不需要 DataTemplate 来告诉他们如何。

如果你给你的 Line 和 Rectangle 一些颜色，你会发现它们忽略了善意的 DataTemplate 并在列表中显示为一条线和一个矩形：

```
MyItems.Add(new Line { X1 = 0, Y1 = 0, X2 = 5, Y2 = 5,
                       Stroke = Brushes.Lime, StrokeThickness = 2 });
...
MyItems.Add(new Rectangle { Height = 5, Width = 15, Fill = Brushes.Blue }); 
```

![列表视图对象](../Images/eb15643d566aa4b662cd5f236efeaaa6.png)

要更改 UIElements 的外观，您通常会使用`Style`（如果它是 a `FrameworkElement`）和/或`ControlTemplate`（如果它是 a `Control`）。

**编辑：**

如果`Line`您有自己的数据类而不是 a*代表*一条线（我们称之为`LineData`），则可以使用 DataTemplate 以任何您喜欢的方式呈现该类：

```
public class LineData
{
    public LineData(Point start, Point end)
    {
        this.Start = start;
        this.End = end;
    }

    public Point Start { get; private set; }
    public Point End { get; private set; }

    public double XLength
    {
        get { return this.End.X - this.Start.X; }
    }
    public double YLength
    {
        get { return this.End.Y - this.Start.Y; }
    }
}

...

MyItems.Add(new LineData(new Point(10, 10), new Point(60, 30))); 
```

..和数据模板..

```
<DataTemplate DataType="{x:Type vm:LineData}" >
    <StackPanel Orientation="Horizontal" SnapsToDevicePixels="True" >
        <TextBlock>It's a line:</TextBlock>
        <Grid>
            <Rectangle Stroke="Black" StrokeThickness="1" 
                        Width="{Binding Path=XLength}" Height="{Binding Path=YLength}" />
            <Line Stroke="Red" StrokeThickness="2"
                    X1="{Binding Path=Start.X}" Y1="{Binding Path=Start.Y}" 
                    X2="{Binding Path=End.X}" Y2="{Binding Path=End.Y}" />
        </Grid>
    </StackPanel>
</DataTemplate> 
```

..给我们：

![列表视图行](../Images/8775424b96d627ed9f3ff06f180d2aa2.png)

# android - 国际化：设置中的语言列表

> ID：14286933
> 
> 赞同：0
> 
> 时间：2013-01-11T21:29:59.480
> 
> 标签：android, iphone, internationalization

我翻译我的应用程序以实现国际化，所以当我注意到在其他应用程序或只是在手机设置中，语言被翻译成当前语言时，我会添加设置语言选择选项。例如，如果有 2 种语言（英语、法语）的列表，并且当前选择的语言是英语，那么您会看到：英语、法语。如果当前语言是法语，您会看到 anglais, français。

我认为这真的很愚蠢。因为，当有人试图改变语言时，他可以识别用他的语言写的自己的语言，但不一定是当前语言。在我上面的例子中，很容易猜到法语是“français”而英语是“anglais”。但是如果当前语言是中文或希腊文或日文。法语或英语很难设置自己的语言。

通常，语言列表中的语言超过 2 或 3 种。我用谷歌翻译了一份包含 5 种语言的中文列表（英语，法语，日语，中文，希腊文）。因此，如果您不懂中文，请尝试查找英文。

在我看来，无论当前使用哪种语言，语言列表都必须相同。例如，如果有 6 种语言（英语、法语、日语、汉语、希腊语、俄语），我们应该看到任何当前语言（英语、法语、日本人、中国的、ελληνικά、русский）。所以每个人都能认出自己的语言。

我的问题是，有什么理由继续这样做吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-21T11:18:15.403

好的，没有理由继续这样做。

# android - 全屏禁用 Android 通知栏（在 SGIII 中）

> ID：14286938
> 
> 赞同：0
> 
> 时间：2013-01-11T21:30:13.743
> 
> 标签：android, samsung-mobile, android-notification-bar

在三星 Galaxy S3 中，即使我的应用程序设置为全屏，这使得通知栏不可见，如果我从屏幕的最边缘滑动，此操作会使通知栏再次出现，允许用户将其扩展到全屏应用程序。有什么办法可以禁用它，或者取消通知栏的扩展？问题是我有一个覆盖整个屏幕的列表视图，如果我滑动以滚动项目，由于滚动速度更快的本能动作，每次我从最边缘进行滚动时，通知栏就会再次出现。我尝试了一些技巧，例如在边缘创建一个覆盖窗口，但对 SG3 根本不起作用。

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-11T22:19:46.283

如果您还没有尝试过，您可能会尝试使用该`View`标志来隐藏导航`SYSTEM_UI_FLAG_HIDE_NAVIGATION`，记录[在此处](http://developer.android.com/reference/android/view/View.html#SYSTEM_UI_FLAG_HIDE_NAVIGATION)。

然而，在他们的描述底部发现这一点可能很重要：

> 有一个限制：因为导航控件非常重要，所以最少的用户交互会导致它们立即重新出现。发生这种情况时，此标志和 SYSTEM_UI_FLAG_FULLSCREEN 都将自动清除，以便两个元素同时重新出现。

这可能与您所看到的有关。我很难相信有办法解决这个问题......我刚刚尝试过，我在 S3 上拥有的每个全屏应用程序都以完全相同的方式运行。

我怀疑如果有办法解决它（假设上述方法不起作用，我不希望它这样做），它会被 Android 团队认为是一个错误，我建议不要这样做。

# javascript - 为 kendo.ui.upload 设置不同的 url

> ID：14286943
> 
> 赞同：1
> 
> 时间：2013-01-11T21:30:27.677
> 
> 标签：javascript, python, django, html, kendo-ui

我正在使用带有 django 框架的 kendo ui 上传小部件将文本文件上传到我的网络服务器。在一个网页上有两种不同的形式，每一种都使用剑道的上传（在同步模式下使用）。提交文件时，kendo 会自动将“提交”附加到当前 url 并将其用作帖子中的 url。我希望能够根据提交的表单动态设置 url。任何帮助将不胜感激。

我的表单模板：

```
<form method="post" action="submit" class='uploader' style="width:45%">
       {% csrf_token %}
            <div>
                <input name="keywords" id="import-keywords" type="file" />
                <input type="submit" value="Submit" class="k-button" />
            </div>
</form>
...
...
<form method="post">{% csrf_token %}
<div>
    <input name="apps" id="import-apps" type="file" />
    <input type="submit" value="Submit" class="k-button" />
</div> 
```

和我的 javascript：

```
$(document).ready(function(){
    $("#import-keywords").kendoUpload({'multiple':false});
    $("#import-apps").kendoUpload({'multiple':false});
}) 
```

所以在我的 url 文件中，匹配的 url（对于两种形式）是

```
currentpageurl/submit 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-11T23:10:50.327

实际上`submit`来自您的`form`. 当您说`action="submit"`您是在说帖子的 URL 时。由于它不是以它开头的，`/`因此它与您当前的 URL 相关。

如果您将其更改为：

```
<form method="post" action="foo" class='uploader' style="width:45%">
   {% csrf_token %}
        <div>
            <input name="keywords" id="import-keywords" type="file" />
            <input type="submit" value="Submit" class="k-button" />
        </div>
</form>
...
...
<form method="post" action="bar">{% csrf_token %}
<div>
    <input name="apps" id="import-apps" type="file" />
    <input type="submit" value="Submit" class="k-button" />
</div> 
```

然后你将使用`currentpageurl/foo`第一种形式（发送的那个`import-keywords`）和`currentpageurl/bar`第二种形式（发送的那个`import-apps`）。

# windows - 如何使用PowerShell设置文件夹权限

> ID：14286948
> 
> 赞同：1
> 
> 时间：2013-01-11T21:30:58.890
> 
> 标签：windows, powershell, permissions, acl, fileserver

我正在尝试编写一个脚本，为所有文件服务器上的 profile$ 文件夹添加“CreatorOwner”权限；

即，将“CreatorOwner”权限添加到“\FileServer\Profile$”

谁能告诉我它的命令和语法是什么？

如果有任何问题，请务必询问。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-12T00:53:47.663

一种方法是使用 WMI 和 UNC 路径。

```
$AccessRule = New-Object  system.security.accesscontrol.filesystemaccessrule("CREATOR OWNER","FullControl","ContainerInherit, ObjectInherit","InheritOnly","Allow")
$profileshare = Get-WmiObject Win32_Share -ComputerName fileserver -Filter "name = 'profile$'"
$driveletter, $path = $profileshare.path
$path = $path.TrimStart("\")
$ACL = Get-Acl "\\fileserver\$driveletter`$\$path"
$ACL.SetAccessRule($AccessRule)
Set-Acl \\fileserver\$driveletter`$\$path -AclObject $ACL 
```

现在，如果您有一个服务器名称列表，您可以执行以下操作：

```
$servers = @("fileserver1","fileserver2","fileserver3")
$AccessRule = New-Object  system.security.accesscontrol.filesystemaccessrule("CREATOR OWNER","FullControl","ContainerInherit, ObjectInherit","InheritOnly","Allow")
$servers | % {
$profileshare = Get-WmiObject Win32_Share -ComputerName $_ -Filter "name = 'profile$'"
$driveletter, $path = $profileshare.path
$path = $path.TrimStart("\")
$ACL = Get-Acl "\\$_\$driveletter`$\$path"
$ACL.SetAccessRule($AccessRule)
Set-Acl \\$_\$driveletter`$\$path -AclObject $ACL
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-04-26T06:11:40.500

这将做到：

```
#Change the CSV file path

$Permissions = Import-Csv C:\Test.CSV -delimiter '|'
ForEach ($line in $Permissions)
$inherit = [system.security.accesscontrol.InheritanceFlags]"ContainerInherit, 
ObjectInherit"

$propagation = [system.security.accesscontrol.PropagationFlags]"None" 

$acl = Get-Acl $line.Path
$acl.SetAccessRuleProtection($True, $False)
$accessrule = New-Object system.security.AccessControl.FileSystemAccessRule("domain users", "Read", $inherit, $propagation, "Allow")

#Adding the Rule
$acl.AddAccessRule($accessrule)

#Setting the Change
Set-Acl $line.Path $acl 
```

CSV 文件的外观

\SRV01\Folder1\Folder2 等。

# html - mobile html5 启动手机的原生导航应用

> ID：14286951
> 
> 赞同：17
> 
> 时间：2013-01-11T21:31:08.937
> 
> 标签：html, cordova

我正在开发一个 phonegap/cordova 应用程序。有没有办法在浏览器视图中打开手机的本机导航应用程序？或者是否有从 html5 应用程序打开本机地图应用程序的最佳实践？还是它们都是特定于平台的？

我已经阅读了以下适用于某些版本的 Android 的地方

```
<a href="geo:some address here" />Navigate to here</a> 
```

这适用于iOS

```
<a href="http://maps.apple.com/?daddr=San+Francisco,+CA&saddr=cupertino">Directions</a> 
```

我很惊讶Phonegap 没有实现这样的东西。

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2013-06-22T21:44:32.687

您可以使用神奇的“地图：”协议在 iOS 5（谷歌地图）和 iOS 6（苹果地图）上打开本机导航应用程序，例如`window.location = "maps:daddr=50.4,-4.5"`

但要在 Android 上启动原生 Google Navigator 应用程序，您需要使用 phonegap 插件。我写这个是为了我自己的目的。

**更新** 该插件现已针对 Phonegap 3.x 进行了更新，并支持 Android、iOS 和 Windows Phone，包括在 iOS 上首选 Google Maps 的选项。

插件在这里：[https ://github.com/dpa99c/phonegap-launch-navigator](https://github.com/dpa99c/phonegap-launch-navigator)

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2013-11-02T14:10:53.960

插件很棒！感谢分享！我在我的应用程序中尝试过，但不幸的是我有 Phonegap 3.x 版，你的插件只适用于 Phonegap 2.x :(

因此，为了让它在 Phonegap 3.x 上运行，我从你的 github 存储库中获取了插件并进行了一些更改，以便它适用于 3.x

Phonegap 3.x 修改后的 PhoneNavigator 插件可以从我的 github 仓库下载： [https ://github.com/viktor0710/PhoneNavigator-Phonegap-3.x.git](https://github.com/viktor0710/PhoneNavigator-Phonegap-3.x.git)

如何将它集成到您​​的 Phonegap 3.x 项目中：

1.  打开控制台窗口
2.  转到您的 Phonegap 应用程序根目录
3.  然后执行：phonegap local plugin add [https://github.com/viktor0710/PhoneNavigator-Phonegap-3.x.git](https://github.com/viktor0710/PhoneNavigator-Phonegap-3.x.git)
4.  从您的应用程序中的 repo (www/phonenavigator.js) 复制“phonenavigator.js”（例如：yourapp/www）
5.  在您的应用中包含“phonenavigator.js”：
6.  从您的应用程序中的 repo (www/cordova.js) 复制“cordova.js”（例如：yourapp/www）
7.  在您的应用程序中包含“cordova.js”：

如何使用它：

```
//function declaration
function navigateTo (lat, lon, successFn, errorFn) {
    cordova.require('cordova/plugin/phonenavigator').doNavigate(lat, lon, successFn, errorFn);
}

//set lat and lon variables. Most probably read them from the UI
var latitude =  48.137607;
var longitude = 11.568569;

//call function
navigateTo(
    latitude,
    longitude,
    function(){
        console.log("Successfully opened navigator");
    },
    function(){
        console.log("Error opening navigator");
    }
); 
```

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2013-11-04T10:09:03.273

如上所述，以下适用于 Galaxy S4 Android（刚刚测试过），以调出 Google Maps/Navigation 应用程序和 waze：

```
<a href="geo:37.786971,-122.399677;u=35">Wikimedia Headquarters</a> 
```

信用：[http ://en.wikipedia.org/wiki/Geo_URI#Example](http://en.wikipedia.org/wiki/Geo_URI#Example)

另请在此处查看答案：[https ://stackoverflow.com/a/19765368/2728686](https://stackoverflow.com/a/19765368/2728686)

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2015-04-27T14:53:02.140

作为记录，如果有人像我一样通过在 Google 上查找这个线程，它直接对我有用，使用 Ionic 框架，通过做两件事：

*   在应用程序的 myapp.config(...) 中添加

    ```
    $compileProvider.aHrefSanitizationWhitelist(/^\s*(https?|geo):/); 
    ```

    （不要忘记添加 $compileProvider 作为依赖项）

*   在 config.xml 中，添加该行

    ```
    <access origin="geo:*" launch-external="yes"/> 
    ```

就这样。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2014-10-11T17:19:46.793

Cordova 3.6.0 引入了第二个白名单，用于限制允许哪些 URL 启动外部应用程序。在以前的 Cordova 版本中，所有非 http URL，例如 mailto:、geo:、sms: 和 intent，都被隐式允许成为 a 标记的目标。由于应用程序可能泄露信息，如果 XSS 漏洞允许攻击者构建任意链接，则这些 URL 也必须被列入白名单，从 Cordova 3.6.0 开始。

[Cordova 3.6.0 白名单指南](http://cordova.apache.org/docs/en/3.6.0/guide_appdev_whitelist_index.md.html)

所以需要在 config.xml 中显式添加：

```
 <access origin="tel:*" launch-external="yes" />
  <access origin="mailto:*" launch-external="yes" /> 
```

# mysql - MySQL 4.0.16 更新表没有子查询

> ID：14286958
> 
> 赞同：0
> 
> 时间：2013-01-11T21:31:27.563
> 
> 标签：mysql, sql, pivot

我有一个呼叫记录数据库，我想从中提取团队信息。它在旧的 MySQL 4.0.16 服务器上运行，因此我正在努力获取没有子查询/视图的数据，并且正在寻找正确的方向，因为我对 MySQL/PHP 还是很陌生。

源表的形式为：

```
callid | team   | status
---------------------------
15432  | team A | open
15433  | team B | open
15434  | team A | onhold
15435  | team A | closed
15436  | team A | closed 
```

我想输出每个状态每个团队的呼叫次数，所以它应该如下所示：

```
team   | open | onhold | closed
--------------------------------
team A | 1    | 1      | 2
team B | 1    | 0      | 0 
```

这可以在 select 语句中，也可以在使用临时表和多个查询中，因为其中任何一个都允许我使用数据来显示整体团队信息。

我已经创建了临时表，并用团队名称和零来填充等待的数量等，但是我没有提出一个更新语句，该语句将在没有子查询的情况下为每个团队添加每个状态的调用次数。在 MySQL 4.0.16 中解决这个问题的最佳方法是什么？感谢您提供任何帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-11T21:33:37.583

您可以使用带有 case 表达式的聚合函数来获取所需格式的数据：

```
select team,
  sum(case when status = 'open' then 1 else 0 end) Open,
  sum(case when status = 'onhold' then 1 else 0 end) Onhold,
  sum(case when status = 'closed' then 1 else 0 end) Closed
from yourtable
group by team 
```

请参阅[带有演示的 SQL Fiddle](http://sqlfiddle.com/#!2/56d75/2)

结果是：

```
|   TEAM | OPEN | ONHOLD | CLOSED |
-----------------------------------
| team A |    1 |      1 |      2 |
| team B |    1 |      0 |      0 | 
```

# java - FileWriter 在文件末尾写入额外的空值

> ID：14286963
> 
> 赞同：3
> 
> 时间：2013-01-11T21:31:44.667
> 
> 标签：java, string, file-io, filewriter

对于大字符串（60MB 左右），在我的文件末尾`FileWriter`附加额外的 s。`null`对于小字符串，此代码按预期工作。

为清楚起见， dat 和 filePath 是字符串。

```
FileWriter fstream = new FileWriter( filePath );
fstream.write( dat );
fstream.close();

File f = new File( filePath );         
System.out.println("Data: " + dat.length() + ", File: " + f.length()); 
```

总之，在什么情况下，两个打印的值应该不同呢？

这是我的示例输出：

```
Data: 63833144, File: 63833728 
```

`null`出于某种原因，我在文件末尾多了 584个 s。我发现字符串可能被过度分配是合理的，但这些不应该打印到文件中，对吧？更糟糕的是，如果我明确地给它长度：

```
fstream.write(dat, 0, dat.length()); 
```

行为是相同的。巧合的是，如果我说 (dat.length() - 584)，它会做我想要的，但仅限于这种特定情况。

有任何想法吗？

JDK版本：1.7.0_02

编辑：为变量添加文件类型（两个字符串）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-11T21:39:08.950

什么是“达”？如果“dat”是 StringBuffer，则需要小心。如果 StringBuffer 的长度大于其内容，则 null 将附加到末尾。您可以尝试使用 dat.toString()。我相信，空字符将在转换中被修剪。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-11T21:37:20.903

我建议您永远不要使用 FileWriter，因为它使用您平台上的默认编码将字符串转换为字节流。

相反，您应该这样做：

```
Writer writer =
  new OutputStreamWriter( 
    new FileOutputStream( fileName ),
    // Always specify encoding compatible with your string
    "UTF-8"
  );

try
{
  writer.write( dat );
  writer.flush( );
}
finally
{
  writer.close( );
} 
```

此外，字符串长度和生成的字节流长度不必匹配。它们将仅匹配 ASCII 文本字符串。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-12T02:12:22.940

The file length depends on encoding. This test

```
System.out.println(dat.getBytes().length); 
```

will show the length in bytes after encoding, because `String.getBytes` will use the same encoding (default) as `new FileWriter(file)`

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-11T22:52:03.287

因此，使用 63833144 长字符串运行测试，其中只有“A”，输出为：数据：63833144，文件：63833144

所以我确定问题是编码问题。

（我会将此作为评论发布，但因为我没有 50 个代表我无法：/）

# android - Scrollview 变得可见，即使它的父母的可见性设置为 GONE

> ID：14286967
> 
> 赞同：0
> 
> 时间：2013-01-11T21:31:58.173
> 
> 标签：android, scrollview, visibility, android-4.2-jelly-bean

我有一个奇怪的问题，其中一个 ScrollView 属于一个具有可见性设置为 GONE 的 LinearLayout 突然在屏幕上变得可见。该问题仅在 Jellybean 4.1.1 上表现出来，而不在 Android 2.3 上表现出来。它似乎主要发生在将父 LinearLayout 的可见性从 GONE 切换到 VISIBLE 并快速返回 GONE 时（比如 1-2 秒）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-11T21:31:58.173

到目前为止，我提出的唯一解决方案是在 ScrollView 及其父 LinearLayout 上设置可见性 GONE/VISIBLE。这完全解决了我在 Jellybean 4.1.1 上的问题。

# c# - 无法解析符号 ExecuteMethodCall（linq 到 sql）

> ID：14286969
> 
> 赞同：0
> 
> 时间：2013-01-11T21:32:14.287
> 
> 标签：c#, sql, linq

我从博客 scottgu 研究 Linq to sql 并收到错误消息：

> “无法解析符号 ExecuteMethodCall”。

linq to sql支持Method ExecuteMethodCallis，但是为什么会出现这个错误呢？

```
ALTER PROCEDURE dbo.VariableShapeSample
        (
    @shape int 
    )

AS
    if(@shape=1)
    select * from products
    else if (@shape=2)
    select * from orders 
```

* * *

```
public partial class NorthwindDataContext
{
    [Function(Name = "VariableShapeSample")]
    [ResultType(typeof (Product))]
    [ResultType(typeof (Order))]
    public IMultipleResults VariableShapeSample(System.Nullable<int> shape )
    {

        IExecuteResult result = this.ExecuteMethodCall(this
                                                       , ((MethodInfo) (MethodInfo.GetCurrentMethod()))
                                                       , shape);

        return (IMultipleResults) result.ReturnValue;
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-11T21:52:50.420

[DataContext.ExecuteMethodCall](http://msdn.microsoft.com/en-us/library/bb493883.aspx)方法是一个内部方法。你不能叫它。它只能在 System.Data.Linq 程序集中的文件中访问。好吧，如果你真的需要，你可以使用反射来调用它：

```
Type type = typeof(NorthwindDataContext);
var methodInfo = type.GetMethod("ExecuteMethodCall", 
                                 BindingFlags.NonPublic | BindingFlags.Instance);
var currentMethod = ((MethodInfo) (MethodInfo.GetCurrentMethod()));
var result = (IExecuteResult)methodInfo.Invoke(this, 
                                 new object[] { this, currentMethod, shape }); 
```

# css - 如何为 boostrap 网格行添加背景（包括填充！）？

> ID：14286972
> 
> 赞同：1
> 
> 时间：2013-01-11T21:32:25.757
> 
> 标签：css, twitter-bootstrap, background, grid

我对引导程序很陌生，但我开始喜欢网格系统。

我创建了一个测试布局。我现在唯一没有完成的事情是在某行周围放置背景。

我怎样才能在左边和右边有一些填充？

这是我的例子：

```
<!DOCTYPE HTML>
<html>
    <head>
        <meta content="text/html; charset=UTF-8">
        <link href="http://twitter.github.com/bootstrap/assets/css/bootstrap.css" rel="stylesheet">
    </head>
    <body>
        <div class="container" id="container">
            <div id="header" class="row">
                <div class="span12">Hallo123</div>
            </div>
            <div id="main" class="row">
                <div class="span10" id="one">
                    <div class="row">
                        <div class="span2">Hallo1</div>
                        <div class="span2">Hallo2</div>
                        <div class="span2">Hallo3</div>
                        <div class="span2">Hallo4</div>
                        <div class="span2">Hallo5</div>
                    </div>
                </div>
                <div class="span2" id="two">Hallo2</div>
            </div>
        </div>
    </body>
</html> 
```

CSS：

```
#main {
    background-color: white;
    box-shadow: 0px 0px 6px #888;
}

#header .span12 {
    background-color: #DD1144;
}

#container {
    background-color: #DF8505;
}

#one, #two, #three, #four {
    background-color: #0088CC;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-12T14:11:15.897

See if this helps:
[http://jsfiddle.net/panchroma/JAFPq/](http://jsfiddle.net/panchroma/JAFPq/)

In simple cases where you need to extend the background beyound the width of the bootstrap grid, you could certainly do it by setting negative margins. This wouldn't work so well if you want the background to cover the entire width of the screen though, and it starts getting complicated as the grid collapses on narrow screens.

The best general solution I have found is to close the bootstrap container div just before the area where you want the background. Then start a new bootstrap container for the area where you need the background and wrap this in it's own div which are are free to manipulate however you want.

```
<div class="container" id="container">
        <div id="header" class="row">
            <div class="span12">Hallo123</div>
        </div><!-- end header -->
</div><!-- end container -->

<div class="backgroundHere"><!-- start of div where you want the background -->
<div class="container">     
        <div id="main" class="row">
            <div class="span10" id="one">
                <div class="row">
                    <div class="span2">Hallo1</div>
                    <div class="span2">Hallo2</div>
                    <div class="span2">Hallo3</div>
                    <div class="span2">Hallo4</div>
                    <div class="span2">Hallo5</div>
                </div><!-- end nested row -->
            </div><!-- end span 10 -->

            <div class="span2" id="two">Hallo2</div>

        </div><!-- end row -->
 </div><!-- end container -->
 </div><!-- end backgroundHere -->

<!-- you could open another bootstrap container here if you have more content without the background --> 
```

Depending on the specifics of your background, you may need to also use @media requests to specify what happens at wide and narrow screens, for example the box-shaddow padding in your case.

Good luck

# android - 未创建 Android 图像文件

> ID：14286973
> 
> 赞同：0
> 
> 时间：2013-01-11T21:32:26.233
> 
> 标签：android, image, file, android-asynctask, save

我创建了这个 AsyncTask 来下载图像并将其保存到手机中。如果图像已经存在，则应该跳过下载图像的代码，但每次到达 f.exists() 时，即使图像之前已经保存，它也是错误的。为什么会这样？

```
private class fanartDownloader extends AsyncTask<String, Integer, String> {
        //First argument is image url and the second is the show id
        @Override
        protected String doInBackground(String... args) {
            String fanartUrl = args[0];
            fanartUrl = fanartUrl.substring(0, fanartUrl.length() - 4);
            //Add proper end for small image
            fanartUrl += SMALL_FANART_URL_END;
            try {
                String path = getApplicationContext().getFilesDir().toString();
                path = path + "/" + args[1] + "/";
                File f = new File(path, "fanart.jpg");
                if (f.exists()) {

                }
                else {
                    f.mkdir();
                    URL url_value = new URL(fanartUrl);
                    Bitmap fanart = BitmapFactory.decodeStream(url_value.openConnection().getInputStream());
                    FileOutputStream out = new FileOutputStream(path);
                    fanart.compress(Bitmap.CompressFormat.JPEG, 100, out);
                    out.flush();
                    out.close();
                }

            } catch (MalformedURLException e) {
                // TODO Auto-generated catch block
                e.printStackTrace();
            } catch (IOException e) {
                // TODO Auto-generated catch block
                e.printStackTrace();
            }
            return null;
        }

    }
} 
```

现在我用这个略有不同的迭代解决了这个问题：

```
private class fanartDownloader extends AsyncTask<String, Integer, String> {
        //First argument is image url and the second is the show id
        @Override
        protected String doInBackground(String... args) {
            String fanartUrl = args[0];
            fanartUrl = fanartUrl.substring(0, fanartUrl.length() - 4);
            //Add proper end for small image
            fanartUrl += SMALL_FANART_URL_END;
            try {
                String file = args[1] + "_" + "fanart.jpg";
                String path = getApplicationContext().getFilesDir().toString();
                path = path + "/" + file;
                File f = new File(path);
                if (f.exists()) {

                }
                else {
                    URL url_value = new URL(fanartUrl);
                    Bitmap fanart = BitmapFactory.decodeStream(url_value.openConnection().getInputStream());
                    FileOutputStream out = getApplicationContext().openFileOutput(file, MODE_PRIVATE);
                    fanart.compress(Bitmap.CompressFormat.JPEG, 100, out);
                    out.flush();
                    out.close();
                }

            } catch (MalformedURLException e) {
                // TODO Auto-generated catch block
                e.printStackTrace();
            } catch (IOException e) {
                // TODO Auto-generated catch block
                e.printStackTrace();
            }
            return null;
        }

    }
} 
```

有谁知道为什么第一个 AsyncTask 不起作用？

# c# - NInject 和多线程问题

> ID：14286976
> 
> 赞同：1
> 
> 时间：2013-01-11T21:32:35.360
> 
> 标签：c#, multithreading, entity-framework, ninject

我们将 Entity framework 4 用于我们的 Web 应用程序，并将 Ninject 作为我们的 DI 容器。我们有一个日志表来记录我们应用程序中发生的所有事情，而且我们还有后端 WCF 工作流服务，它再次将日志写入日志表。

对于来自网络的所有请求，我们使用

```
StandardScopeCallbacks.Request(ctx); 
```

对于我们使用的后端的所有内容

```
StandardScopeCallbacks.ThreadScope(ctx); 
```

我们的日志记录方法很简单

```
 public void Log(string message, LogLevel level)
        {
             var log = new ApplicationLog()
                    {
                        LogDate = DateTime.Now,
                        Message = message,
                        LogLevel = Enum.GetName(typeof(LogLevel), level)
                    };

                    db.ApplicationLog.Add(log);
                    db.SaveChanges();          
        } 
```

问题：如果我们有更多的线程在运行，那么我们会得到一个异常

> System.Data.SqlClient.SqlException：不允许新事务，因为会话中还有其他线程在运行。在
> 
> System.Data.SqlClient.SqlConnection.OnError（SqlException 异常，布尔 breakConnection）在 System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning() 在 System.Data.SqlClient.TdsParser.Run（RunBehavior runBehavior，SqlCommand cmdHandler，SqlDataReader dataStream，BulkCopySimpleResultSet bulkCopyHandler , TdsParserStateObject stateObj) 在 System.Data.SqlClient.TdsParser.TdsExecuteTransactionManagerRequest(Byte[] 缓冲区, TransactionManagerRequestType 请求, 字符串 transactionName, TransactionManagerIsolationLevel isoLevel, Int32 超时, SqlInternalTransaction 事务, TdsParserStateObject stateObj, Boolean isDelegateControlRequest) 在
> 
> System.Data.SqlClient.SqlInternalConnectionTds.ExecuteTransactionYukon（TransactionRequest transactionRequest，字符串 transactionName，IsolationLevel iso，SqlInternalTransaction internalTransaction，布尔 isDelegateControlRequest）在
> 
> System.Data.SqlClient.SqlInternalConnection.BeginSqlTransaction(IsolationLevel iso, String transactionName) 在 System.Data.SqlClient.SqlInternalConnection.BeginTransaction(IsolationLevel iso) 在 System.Data.SqlClient.SqlConnection.BeginDbTransaction(IsolationLevelisolationLevel) 在 System.Data.EntityClient .EntityConnection.BeginDbTransaction(IsolationLevel 隔离级别)

我知道我可以使用“使用”语句创建新上下文并编写 ti Log 表而不会出现任何问题。但我不想这样做，因为这会使一切变得比在线程作用域中创建上下文更慢。

处理这种情况的最佳方法是什么？我需要执行时间最少的实现。

如果您需要更多信息，请发表评论。先感谢您。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-12T03:16:30.733

You should listen to Daniel's comment. NLog and Log4Net are better options.

I would not recommend locking on db as Jalalx mentioned, because it could end up slowing execution around the locks if you have a lot of logs. If you don't have a ton writing to logs, then sure give it a try.

Two options--

1.  Register your db connection/context as per thread -- then you don't have to worry about cross- thread sharing, it won't happen.
2.  Create a "DbConnectionFactory" that creates db connections/contexts that you can call within the context of each thread/execution.

So basically its either let Ninject manage it, or create an abstraction so that you can manage it yourself.

Btw, isn't ninject the slowest DI framework out there for .NET?

# html5-video - 视频事件在设置时运行 - 我不打算这样做

> ID：14286980
> 
> 赞同：0
> 
> 时间：2013-01-11T21:33:04.237
> 
> 标签：html5-video

我有一个带有事件的视频标签。例如，我有如下代码： myPlayer = document.getElementById("player");

```
 myPlayer.onended=reachedEnd();
       myPlayer.onpause = pauseEvent();
         myPlayer.onplay = resumePlayer(); 
```

问题是，事件函数会立即运行，我怀疑它们应该在它们应该运行的时候运行，但它们肯定会在定义时运行。我究竟做错了什么？（我确实对“myPlayer”做了警告，它是一个视频对象，所以这部分是正确的）。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-15T03:42:44.697

函数名称旁边的括号使函数立即运行。相反，您希望像变量一样引用函数，将对它们的引用传递给事件。相反，'onended' 等被设置为这些函数返回的值，这可能是`undefined`，所以当这些事件最终发生时什么都不会发生。

只要去掉括号，你应该没问题。

# objective-c - 目标 c int 未声明

> ID：14286983
> 
> 赞同：-3
> 
> 时间：2013-01-11T21:33:13.940
> 
> 标签：objective-c, int

我正在创建一个非常简单的计算器。为了保存第一个输入的用户`float`，我将它保存为添加操作中的字符串，以便在他们单击添加按钮时保存它。然后稍后我再次调用它以将其添加到第二个用户输入的`float`. 但是，当我再次调用它时，它会给出错误：使用未定义的标识符`num1`。操作整数也会发生同样的事情。以下是相关代码：

```
- (IBAction)addition {

    NSString *number1 = total.text;
      float  num1 = [number1 floatValue];
    int operation = 1;
    total.text = @"";

}

- (IBAction)equal {

    NSString *number2 = total.text;
    float num2 = [number2 floatValue];

    if (operation == 1) {
        int num3 = num1 + num2;

    NSString *znumber1 = [NSString stringWithFormat:@"%f", num1];
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-11T21:36:59.610

您需要声明`num1`为“实例变量”，以便两个函数都可以访问它（通常在您的`@interface`块中声明）。

您声明它的方式只允许该函数范围内的代码访问它。

我建议在继续之前[阅读变量范围](http://www.techotopia.com/index.php/Objective-C_Variable_Scope_and_Storage_Class)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-11T21:37:43.243

`num1`仅在 的范围内，`(IBAction)addition`因此您不能在`(IBAction)equal`.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-11T21:40:15.130

`num1`范围不正确。它是本地的`addition`。您想将接口放入类的 .m 文件中。这将为您的实现提供一个私有变量。如果您放入 .h 文件，您将暴露给程序的其余部分。

# c# - 从 MainViewModel 获取 Uri

> ID：14286985
> 
> 赞同：0
> 
> 时间：2013-01-11T21:33:25.960
> 
> 标签：c#, windows-phone-7

我正在尝试制作一个应用程序，其中我有很多指向堆栈面板上不同网站的链接，从`MainViewMode`l 获取内容，所以当我点击描述时，它会通过`WebBrowserTask`. 但是，我想`MainViewModel`在 .cs 中使用 Uri 并获取该信息，这会将我带到该站点

我的xml代码是

```
<ListBox Margin="0,0,-12,0" ItemsSource="{Binding Items}">
                <ListBox.ItemTemplate>
                    <DataTemplate>
                        <StackPanel Orientation="Horizontal" Margin="0,0,0,17" Tap=Open_Web>
<Image Height="100" Width="100"   Margin="0,0,0,0" Source="{Binding ImgWeb}" HorizontalAlignment="Left"/>
                            <StackPanel Width="311">
                                <TextBlock Text="{Binding LineOne}" TextWrapping="Wrap" Style="{StaticResource PhoneTextExtraLargeStyle}"/>
                                <TextBlock Text="{Binding LineTwo}" TextWrapping="Wrap" Margin="12,-6,12,0" Style="{StaticResource PhoneTextSubtleStyle}"/>
                            </StackPanel>
                         </StackPanel>
                    </DataTemplate>
                </ListBox.ItemTemplate> 
            </ListBox> 
```

我的 .cs 是

```
private void Open_Web(object sender, RoutedEventArgs e)
    {
        WebBrowserTask webBrowserTask = new WebBrowserTask();
        webBrowserTask.Uri = new Uri("I DONT KNOW");
        webBrowserTask.Show(); 
```

我的 MainViewModel 代码是：

```
this.Items.Add(new ItemViewModel() { LineOne = "Web Name", LineTwo = "Web description", Uri = "http://WebSite.com" }); 
```

如果我不绑定信息，它可以工作，但我不知道如何从`webBrowserTask.Uri = new Uri("I DONT KNOW");`MainViewModel获取 Uri

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-12T09:52:09.737

将以下代码添加到 Open_Web 方法的开头

```
var templateRoot = (FrameworkElement)sender;
var dataItem = (ItemViewModel)templateRoot.DataContext;
var uri = dataItem.Uri; 
```