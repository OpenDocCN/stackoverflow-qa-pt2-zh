# StackOverflow 问答 14759000-14759999

# ios - 上传视频和分享链接 - API？

> ID：14759010
> 
> 赞同：0
> 
> 时间：2013-02-07T19:08:01.307
> 
> 标签：ios, facebook, video, twitter, youtube

我正在开发一个在多个社交网站（Facebook、Twitter、Pinterest 和 SMS 和电子邮件）上共享视频的应用程序。

并非所有这些服务都进行视频上传（如 Twitter），并且在多个网络上共享视频对用户来说非常耗时。

我正在寻找一种允许用户上传视频的服务，然后该服务将提供一个用户可以在社交网站上分享的 url。如果无需创建用户帐户而无需创建一个开发者帐户，那就太好了。

所有视频的长度将少于 3 分钟。

希望这是有道理的。

我一直在考虑创建一个与应用程序关联的 YouTube 帐户，但这可能会导致问题，因为用户可以上传各种内容，这可能会导致帐户被关闭。

希望降低成本，并且不必将所有视频都托管在我自己的服务器（AWS 或类似的服务器）上。

希望你有一些想法。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-07T23:40:07.580

This is not a programming or even a technical question.

viddur.com might do what you want — its a startup and they probably don't have a public api yet, though. Other than that, no one will offer you this service for free. It cost between 0.01-03 cents to encode video (and you have to do it multiple times per video to support varios platforms). Encoding and hosting video is not as cheap as static images. You're basically trying to create a product around a free service that doesn't exist.

TL:DR: Abandon your idea, and only post technical questions to Stackoverflow.

# mysql - 来自数据库错误输出的类别和子类别

> ID：14759011
> 
> 赞同：0
> 
> 时间：2013-02-07T19:08:02.297
> 
> 标签：mysql, categories

我有这个查询

```
SELECT  c1.Id, c1.Name as parent , c2.name as child
              FROM categories c1
                JOIN categories c2 ON c1.id = c2.parentid 
```

请为什么我对父母的输出是这样的：

父母1 父母2 父母3 父母1

这是完整的代码：

```
<div id="categories" class="s_nav">
  <ul>
    <li id="menu_home"> <a href="/">Home</a> </li>
    <?
    $query = "SELECT  c1.Id, c1.Name as parent , c2.name as child
              FROM categories c1
                JOIN categories c2 ON c1.id = c2.parentid";

    $result = mysql_query($query);
    $parent = ''; 
    while ($next = @mysql_fetch_array($result)) {
       if ($next['parent'] != $parent) {
          if (strlen($parent) > 0) {
             echo "  </ul></div></li>";
          }
          echo "  <li><a href='#'>" . $next['parent']."</a>";
          echo "    <div class='s_submenu'><h3>".$next['parent']."</h3>
                      <ul class='s_list_1 clearfix'>";
       }
       echo '    <li> <a href="'. $next['child'].'.htm">' . $next['child'] . '</a></li>';

       $parent = $next['parent'];
    }
    echo "    </ul>";
    echo "  </li>";
    ?>
  </ul>
</div> 
```

并且仅当子类别的第一个字母是字母“A”时才会发生这种情况

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-07T19:13:57.877

a) 是什么`momething`？
b）当您直接在数据库中运行查询时，查询的输出是什么？
c）删除，`@`这样你就可以看到错误
d）正如 njk 提到的，你应该使用 MySQLi 或 PDO，不推荐使用 mysql_* 函数！

# ruby-on-rails - ActiveRecord 回调访问会话数据

> ID：14759013
> 
> 赞同：0
> 
> 时间：2013-02-07T19:08:11.477
> 
> 标签：ruby-on-rails, ruby-on-rails-3, ruby-on-rails-3.2

我正在尝试使用 ActiveRecord 回调添加当前用户信息以进行记录，但我不知道如何做到这一点。我尝试了 Thread.current[:user]，但在结果中我看到线程值是从另一个用户会话访问的。我在生产中使用 Passanger，但同时我正在使用正确获得用户价值的acts_as_audited。最好/最安全的方法是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-07T20:15:06.390

当前用户无法从 ActiveRecord 模型中访问。这是由于 Rails 中的关注点分离——当前用户和会话是属于控制器领域的概念。

您需要获取相关数据并将其传递到模型中，以便您的回调起作用。一种方法是使用访问器方法：

```
# model
attr_accessor :current_user

def my_callback
  # do something with current_user
  self.some_attribute = current_user
end

# controller
@model = MyModel.find(params[:id])
@model.current_user = current_user # assuming you have a controller method that does this
@model.save! 
```

您应该将`current_user`访问器重命名为有意义：例如。如果您正在跟踪博客文章的作者，请调用它`author`或`responsible_user`类似的名称，因为`current_user`一旦保存模型就没有任何意义。

# c# - 使用 HashSet C# 选择项目

> ID：14759019
> 
> 赞同：2
> 
> 时间：2013-02-07T19:08:35.550
> 
> 标签：c#, collections, hashset

我有一个哈希集。是否有一种方法可以利用 IEqualityComparer 来检索您传入的对象，该对象将满足 IEqualityComparer 中定义的 equals 方法？

这可能解释得更清楚一点。

```
 public class Program
{
    public static void Main()
    {
        HashSet<Class1> set = new HashSet<Class1>(new Class1Comparer());
        set.Add( new Class1() { MyProperty1PK = 1, MyProperty2 = 1});
        set.Add( new Class1() { MyProperty1PK = 2, MyProperty2 = 2});

        if (set.Contains(new Class1() { MyProperty1PK = 1 }))
            Console.WriteLine("Contains the object");

        //is there a better way of doing this, using the comparer?  
        //      it clearly needs to use the comparer to determine if it's in the hash set.
        Class1 variable = set.Where(e => e.MyProperty1PK == 1).FirstOrDefault();

        if(variable != null)
            Console.WriteLine("Contains the object");
    }
}

class Class1
{
    public int MyProperty1PK { get; set; }
    public int MyProperty2 { get; set; }
}

class Class1Comparer : IEqualityComparer<Class1>
{
    public bool Equals(Class1 x, Class1 y)
    {
        return x.MyProperty1PK == y.MyProperty1PK;
    }

    public int GetHashCode(Class1 obj)
    {
        return obj.MyProperty1PK;
    }
} 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-07T19:10:49.727

如果要基于单个属性*检索*`Dictionary<T,U>`项目，则可能需要使用 a而不是 hashset。然后，您可以将项目放在字典中，`MyProperty1PK`用作键。

然后您的查询变得简单：

```
Class1 variable;
if (!dictionary.TryGetValue(1, out variable)
{
  // class wasn't in dictionary
} 
```

鉴于您已经使用仅将此值用作唯一性标准的比较器进行存储，因此仅使用该属性作为字典中的键确实没有缺点。

# c++ - Windows 8 AutoRotation registry value

> ID：14759020
> 
> 赞同：0
> 
> 时间：2013-02-07T19:08:41.943
> 
> 标签：c++, windows

We are trying to determine if auto rotation is currently enabled or disabled from our c++ application. The following code always returns a value of 1 even if regedit of the same key shows 0\. It returns the same if the application is run as a standard user or as an administrator.

```
HKEY hkMain;
LONG lRes =  RegOpenKeyEx(HKEY_LOCAL_MACHINE,"SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\AutoRotation",0,KEY_QUERY_VALUE,&hkMain);
if (lRes==ERROR_SUCCESS) {
    DWORD dwRegValue=0,dwSize=0,dwType=0;
    dwSize = sizeof(DWORD);
    lRes = RegQueryValueEx(hkMain,TEXT("Enable"),NULL,&dwType,(LPBYTE)&dwRegValue,&dwSize);

    if (lRes==ERROR_SUCCESS) {
        // dwRegValue value is always 1
    }
    RegCloseKey(hkMain);
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-11T13:46:12.200

Hans Passant 的评论提供了答案“您可能正在使用 Regedit 查找错误的密钥。导航到 SOFTWARE\Wow6432Node\Microsoft... 而不是在 64 位操作系统上。这是 32 位程序读取密钥的所在地。”我们需要在我们的注册表函数调用中包含 KEY_WOW64_64KEY 标志。谢谢

# python - Download Excel Spreadsheet Python

> ID：14759023
> 
> 赞同：1
> 
> 时间：2013-02-07T19:08:59.727
> 
> 标签：python, file

I am still pretty new to Python, so perhaps I am missing something obvious. I am trying to download a simple spreadsheet from Google Docs, save the file, and open it in Excel. When I did a test run with text files instead of excel files, it worked fine. However, using xls and xlsx, when excel opens the newly downloaded file, it says that the data is corrupted. How can I fix this?

```
import urllib2

print "Downloading..."
myfile = urllib2.urlopen("https://docs.google.com/spreadsheet/pub?key=0AoJYUIVnE85odGZxVHkybGxYRXF1TFpuQXdqZlJwNXc&output=xls")
output = open('C:\\Users\\Lucas\\Desktop\\downloaded.xlsx', 'w')
output.write(myfile.read())
output.close()
print "Done"

import subprocess
subprocess.call(['C:\\Program Files (x86)\\Microsoft Office\\Office14\\EXCEL.exe', 'C:\\Users\\Lucas\\Desktop\\downloaded.xlsx']) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-07T19:12:59.353

你想做它`wb`你可以看看[这里的文档](http://docs.python.org/2/tutorial/inputoutput.html#reading-and-writing-files)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-07T19:14:18.050

您正在以纯文本、ascii 模式编写文件。Excel 文档不是纯文本：在这种假设下，您将错误地处理内容。

要按原样使用数据，对其格式的假设为零，请使用二进制模式。这里：

```
output = open('C:\\Users\\Lucas\\Desktop\\downloaded.xlsx', 'wb') 
```

注意末尾的“b”标志。

# c - SDL_SetColorKey doesn't set the background transparent

> ID：14759025
> 
> 赞同：0
> 
> 时间：2013-02-07T19:09:09.947
> 
> 标签：c, image, transparency, sdl

it comes down to this code:

```
SDL_Surface *smiley = SDL_LoadBMP("./images/smileys/normal_up.bmp");
printf("Transparation worked: %i\n", SDL_SetColorKey(smiley, SDL_SRCCOLORKEY, SDL_MapRGB(smiley->format, 255, 0, 255)));
SDL_BlitSurface(smiley, NULL, window, NULL);
SDL_Flip(window); 
```

This is the [image](http://picturepush.com/public/12136938) I used. Using SDL on Arch Linux.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-08T11:28:13.207

在 SDL_SetColorKey() 调用之前的这些行使整个工作正常：

```
smiley->format->Amask = 0xFF000000;
smiley->format->Ashift = 24; 
```

现在我可以使用具有 32 或 24 bpp VideoMode 的 .bmp 或 .jpg 文件，一切正常！不知道为什么，不知道它是如何工作的。

# ajax - contains an unknown id when switching from PrimeFaces to jsf/html

> ID：14759026
> 
> 赞同：1
> 
> 时间：2013-02-07T19:09:11.443
> 
> 标签：ajax, jsf, primefaces, facelets

this is my 1st question here :)

My code is as follows:

```
<?xml version="1.0"?>

<f:view xmlns="http://www.w3.org/1999/xhtml"
    xmlns:ui="http://java.sun.com/jsf/facelets"
    xmlns:f="http://java.sun.com/jsf/core"
    xmlns:h="http://java.sun.com/jsf/html"
    xmlns:p="http://primefaces.org/ui"
    >

    <h:head />

    <h:body>
        <h:form id="filterForm">
            <h:outputStylesheet library="css" name="main.css" />
            <div id="filterPane">
                <h:panelGroup rendered="#{not empty filters.categories}">
                    <div class="filter">
                        <div class="filterCategories" style="width: 100%;">
                            <h4>Kategorien</h4>
                            <p />
                            <h:selectManyCheckbox layout="pageDirection"
                                value="#{filters.selectedCategories}"
                                valueChangeListener="#{filters.categoryValueChanged}">
                                <f:selectItems value="#{filters.categories}" var="category"
                                    itemLabel="#{category.displayName} (#{category.count})"
                                    itemValue="#{category.name}" />
                                <f:ajax render="@form" />
                            </h:selectManyCheckbox>
                        </div>
                    </div>
                </h:panelGroup>
            </div>
        </h:form>
    </h:body>

</f:view> 
```

I get the same error as some others before me here @stackoverflow - but none of the suggested solutions worked for me.:

```
<f:ajax> contains an unknown id 'A5539:filterForm:j_idt9' - cannot locate it in the context of the component j_idt9 
```

Before my switch from `<p:selectManyCheckbox` to `<h:selectManyCheckbox` the code was working fine.

We need to change to `<h:selectedManyCheckbox`, because the PrimeFaces variant is not selectable for a non-JavaScript user. I need the form `<h:form id="filterForm">` to be re-rendered as a consequence of my AJaX request via the `<f:ajax>` element.

Beside the initial `<f:ajax render="@form" />` I unsuccessfully tried to reference the `<h:form id="filterForm">` element with the following variants:

```
<f:ajax render=":filterForm" />
<f:ajax render=":#{component.parent.parent}" /> 
```

I also tried some more stupid ones.

Any hint, anybody!? :)

# c# - Deleted tasks are being retrieved using the query .net Rest API

> ID：14759031
> 
> 赞同：4
> 
> 时间：2013-02-07T19:09:35.377
> 
> 标签：c#, rally

I just deleted a task using the Rally website, but when a search for task using the REST API it doesn't return it. I assumed that it should return with the flag "Recycled".

Can anybody help me?

Regards, Paulo

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-10T18:27:34.093

虽然并不理想，但您可以通过此 REST 端点访问回收站：

`https://rally1.rallydev.com/slm/webservice/1.40/recyclebin.js?workspace=/workspace/12345678910&project=/project/12345678911`

其中长整数是感兴趣的工作区和项目 OID。

回收站条目如下所示：

```
{
    _rallyAPIMajor: "1",
    _rallyAPIMinor: "40",
    _ref: "https://rally1.rallydev.com/slm/webservice/1.40/recyclebinentry/12345678910.js",
    _refObjectName: "Test Case 3: Load in, run Analysis on Integer Grids",
    _type: "RecycleBinEntry"
} 
```

回收站 OID 是唯一的，并且与被删除的工件的 OID 不同，因此没有一个很好的方法可以将回收站条目映射到被删除的工件以创建它。对象名称可以工作，尽管您冒着重复的风险。回收站条目也具有与 UI 中的回收站相同的限制 - 子对象不显示/不可访问。

如果您想从 .NET 访问回收站，这里有一个简单的示例：

```
 namespace RestExample_QueryRecycleBin  {
    class Program
    {
        static void Main(string[] args)
        {

            //Initialize the REST API
            RallyRestApi restApi;

            String userName = "user@company.com";
            String userPassword = "topsecret";

            // Set Rally parameters
            String rallyURL = "https://rally1.rallydev.com";
            String rallyWSAPIVersion = "1.40";

            //Initialize the REST API
            restApi = new RallyRestApi(userName,
                                       userPassword,
                                       rallyURL,
                                       rallyWSAPIVersion);

            // Specify workspace and project
            string myWorkspace = "/workspace/12345678910";
            string myProject = "/project/12345678911";

            //Query for items

            Request request = new Request("recyclebinentry");
            request.Workspace = myWorkspace;
            request.Project = myProject;

            QueryResult queryResult = restApi.Query(request);

            foreach (var result in queryResult.Results)
            {
                //Process item
                string itemName = result["_refObjectName"];
                string itemRef = result["_ref"];
                Console.WriteLine(itemRef + ", " + itemName);
            }

            Console.ReadKey();
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-10T17:40:28.910

这是 WSAPI 中的一个不一致之处。不幸的是，所有查询都是隐式范围的（Recycled = false），因此任何已删除的内容都不会从工件端点返回。也无法通过 WSAPI 访问回收站的内容。

我鼓励您在[https://ideas.rallydev.com/ideas/D2374](https://ideas.rallydev.com/ideas/D2374)为这个功能的想法投票。

# c# - Watin causes high CPU usage

> ID：14759032
> 
> 赞同：1
> 
> 时间：2013-02-07T19:09:37.183
> 
> 标签：c#, watin, cpu-usage

I'm using Watin like so:

```
private IE myie;
private void button1_Click(object sender, EventArgs e)
{
    try
    {
        myie = new IE();
    }
    catch (Exception ex)
    {
        return;
    }

    myie.GoTo("http://www.google.com");
    myie.WaitForComplete();

} 
```

The problem is, however, once browser window is opened - my C# app starts to consume CPU. According to task manager - in IDLE state my program consumes from 7% to 20% CPU power. (I have AMD 2core 5000+)

Once you close the IE instance (window) - CPU usage problem disappears, so the problem lies somewhere within Watin.

Who do I fix it? What causes CPU drain?

Here, proof:

![enter image description here](../Images/509b57f509aaf1f95793abc067c41c5b.png)

**Project:** [download on skydrive](http://sdrv.ms/1232yeS)

Can anybody confirm the bug? Or maybe it's just my PC fails at some point

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-07T20:45:13.293

请记住——我相信你已经知道这一点——WatiN 是开源的，所以其中会有错误。*和你一样，在IE 和 Firefox*中启动表单时，我的 CPU 使用率都会飙升；但在很短的时间内恢复正常。我对您的建议是[联系 WatiN 团队](http://watin.org/team/)。我也在下面发布了我的代码：

```
namespace WindowsFormsApplication1
{
    using System;
    using System.Windows.Forms;
    using WatiN.Core;

    public partial class Form1 : System.Windows.Forms.Form
    {
        public Form1()
        {
            InitializeComponent();
        }

        private void button1_Click(object sender, EventArgs e)
        {
            try
            {
               IE testIE = new IE("http://www.google.com");
               //FireFox testFF = new FireFox("http://www.google.com");
            }

            catch (Exception exc)
            {
               MessageBox.Show(exc.Message);
            }
         }
     }
 } 
```

# javascript - JS不适用于动态生成的HTML

> ID：14759050
> 
> 赞同：1
> 
> 时间：2013-02-07T19:10:43.510
> 
> 标签：javascript, jquery, html, dynamic-html, redips.drag

我正在使用 www.redips.net/ 拖放对象，它与 jquery 相同，但问题是，如果我将所有内容都作为静态 HTML，那么它工作正常。如果我动态生成 HTML（这是必须的），那么 js 库之一redips-drag-min 无法应用 & 拖放不起作用。

在像这样创建所有 HTML 之后，我找到了一种动态添加对该 js 的引用的解决方案

```
 var ssioCss = document.createElement("script");
        ssioCss.setAttribute("type", "text/javascript");
        ssioCss.setAttribute("src", "../redips-drag-min.js");
        document.head.appendChild(ssioCss); 
```

其中一个 css 文件以这种方式工作，它很棒，但为什么没有 JS 文件可以帮助？谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-07T19:16:30.133

当您在标签中指定 JQuery 时，您应该使用

1.  [append](http://api.jquery.com/append/)或[before](http://api.jquery.com/before/)或[after](http://api.jquery.com/after/)方法在页面中创建元素
2.  [getScript](http://api.jquery.com/jQuery.getScript/)加载你的脚本
3.  使用此脚本加载外部 CSS 文件

    ```
    $("<link/>", {
      rel: "stylesheet",
      type: "text/css",
      href: "/styles/yourcss.css"
    }).appendTo("head"); 
    ```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-07T19:16:43.337

您可以`.getScript()`用于动态加载外部 js：

```
$.getScript("../redips-drag-min.js", function(data, textStatus, jqxhr) {
   console.log(data);
}); 
```

# php - array_rand 密码

> ID：14759054
> 
> 赞同：0
> 
> 时间：2013-02-07T19:10:50.747
> 
> 标签：php, arrays, random, passwords, auto-generate

```
<?php
$abc = array('a', 'b', 'c', 'd', 'e', 'f', 'g', 'h', 'i', 'j', 'k', 'l', 'm', 'n', 'o','p', 'q', 'r', 's', 't', 'u', 'v', 'w', 'x', 'y', 'z', 'A', 'B', 'C', 'D', 'E', 'F', 'G', 'H', 'I', 'J', 'K', 'L', 'M', 'N', 'O','P', 'Q', 'R', 'S', 'T', 'U', 'V', 'W', 'X', 'Y', 'Z');

for ($i=0; $i < 6; $i++)
    {   
        $pass = array_rand($abc);
        echo $abc[$pass];
    }

?> 
```

我需要使用生成的通行证发送电子邮件，但我必须生成通行证获取某个变量，但我现在不知道如何。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-07T19:17:21.450

我只是用这个：`$newpass = substr(md5(uniqid()),0,8);`

它不是特别安全，但它可以完成工作，并且用户需要在使用重置密码登录后立即更改密码。关键是它比循环和字符访问更有效。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-07T19:20:41.863

您可以使用 mcrypt 扩展的 iv 函数从系统中获取随机数据。因为它是一个比特流，你需要以某种方式对其进行编码，这样它就不会出现在屏幕上。Base64 编码应该足够了。因为 base64 编码的字符串大约长 33%，所以您需要将字符串缩减到您想要的长度。

这是一个简单的例子：

```
function password($length = 10) {
    $random = mcrypt_create_iv($length, MCRYPT_DEV_URANDOM);
    $base64 = base64_encode($random);
    return substr($base64, 0, $length);
}
var_dump(password(10)); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-07T19:17:01.450

使用我几天前写的这段代码。

```
function genText($length) {
    $out_str = '';
    $p_chars = "AGHACEFHJKRSTVXY124579aghacefhjkrstvxy"; // can be any set of characters
    while (strlen($out_str) < $length) {
        $out_str.= $p_chars{rand() % (strlen($p_chars))};
    }
    return $out_str;
}

$your_variable = genText(8); 
```

# android - 具有相同 ID 的两个视图

> ID：14759056
> 
> 赞同：32
> 
> 时间：2013-02-07T19:11:07.737
> 
> 标签：android

`R.id.id_name`android在膨胀XML后如何使用查找视图？

1.假设我有两个带有一个按钮的 XML，每个按钮都有相同的 id。

2.我将它们膨胀并转换成视图

3.在 R.id 类`int`中，两个按钮都只会创建一个。

android如何使用相同的资源名称（R.id.id_name）区分这些具有相同ID的按钮。

* * *

## 回答 #1

> 赞同：41
> 
> 时间：2013-02-07T19:21:16.270

ID 不是唯一的参考。

但是，在实践中，您可以通过使用父视图来区分。

如果我们认为 'this' 是一个 Activity，设置一个包含您的按钮的布局，那么：

```
Button button = (Button) this.findViewById( R.id.id_name ); 
```

将返回它在布局中找到的第一个（我认为 - 不确定实际行为是否已定义）。

但是，您可能会调用`findViewById`一些仅包含一个具有该 ID 的此类实例的父视图。

```
LinearLayout okParent = (LinearLayout) this.findViewById( R.id.okLayout );
LinearLayout cancelParent = (LinearLayout) this.findViewById( R.id.cancelLayout );

Button okButton = (Button) okParent.findViewById( R.id.id_name );
Button cancelButton = (Button) cancelParent.findViewById( R.id.id_name ); 
```

从概念上讲，这是一种基于路径的查找。你应该小心设计你的布局，这样才有可能。

* * *

## 回答 #2

> 赞同：21
> 
> 时间：2013-02-07T19:23:38.437

Android 走的是简单的道路：**ID 不是应用程序范围的唯一性，而是布局范围的唯一性。**

的值`R.id.foo`在两个不同的布局中是相同的，其中包含一个带有`foo`id 的控件。因为他们不是为了独特性而竞争，所以没关系。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2013-02-07T19:19:53.260

它知道它`View`应该使用哪个，因为它在当前设置为内容视图（或已膨胀）的 XML 文件中查找`View`此特定内容。`id`

# android - “所有”异步任务完成后更新屏幕

> ID：14759059
> 
> 赞同：1
> 
> 时间：2013-02-07T19:11:13.453
> 
> 标签：android

我正在使用 asynctask 执行冗长的操作，例如数据库读取。我想在所有异步任务完成后开始一个新活动并呈现其内容。实现这一目标的最佳方法是什么？

我知道 onPostExecute 用于更新屏幕。但是我不想更新屏幕，除非所有的 ayncTasks 都完成了

请帮忙谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-07T19:18:19.483

不要过度复杂化：只需使用一个在每个`onPostExecute`. 如果任务发现此计数器已达到最大值（等于您生成的任务数），它可以运行更新代码。

请注意，您不需要锁定此计数器，因为`onPostExecute`在 UI 线程中运行。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-07T19:18:41.190

只是一个建议，您可以创建一个大小为 Asynctask 数量的布尔数组。每个 Asynctask 都有一个 ID，它是布尔数组的索引。在 onPostExecute 或其他回调中，您可以检查所有条目是否为真。然后你就知道一切都完成了。另一种方法是，您为每个 Asynctask 分配唯一的 id，并且您还拥有这些 id 的总和，当其中一个完成时，您从总和中减去其 id，当它达到零时，您也知道它们都完成了。不完美，只是一些建议。

# iphone - 在 Xcode 中使用 AutoLayout 会禁用我的代码（动态）工作？

> ID：14759061
> 
> 赞同：0
> 
> 时间：2013-02-07T19:11:17.553
> 
> 标签：iphone, ios, uitableview, frame, autolayout

在我的项目中，我启用了 AutoLayout 以使应用程序在 iPhone 4 和 iPhone 5 中正确缩放。这样做一切正常，但我发现了一个新问题，我不确定如何处理。

在我的项目中，我有一个普通的方法来检查布尔值是或否，如果是，界面应该在界面中添加一个按钮并将我的 tableView 保持在当前状态。但是如果方法返回 no，按钮应该会消失，并使 tableView 的高度更高！按钮的一切工作正常，但由于某种原因，在开始使用 AutoLayout 后，我​​增加 tableView 高度的代码停止工作（以前工作过）。

现在，即使我使用 AutoLayout，我该怎么做才能使我的 tableView 的高度增加？这是我的代码：

```
- (void)viewWillAppear:(BOOL)animated
{
NSString *bookName = [self getCurrentBookName];

if([self isBlank:bookName])
{
    [self.currentBookLabel setText:NSLocalizedString(@"LabelNoBookChosen", nil)];
}
else
{
    [self.currentBookLabel setText:[self getCurrentBookName]];
}

[super viewWillAppear:animated];

  if([self isAppLicensed] != YES)   <------------------THIS IS WHERE I CHECK THE BOOLEAN METHOD!
{
    [actionAppStore setHidden:TRUE];

    CGRect framez =  [tableView frame]; <------------------ THIS CODE IS NOT WORKING ANY LONGER!
    [tableView setFrame:CGRectMake(framez.origin.x, framez.origin.y, framez.size.width, framez.size.height+77)];
}    
else
{
    [actionAppStore setHidden:FALSE];
}
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-07T19:17:18.043

你可以

1.  关闭自动布局并使用自动调整大小的蒙版。非自动布局自动调整大小蒙版让您可以控制增加或减少 3.5 英寸屏幕与 4 英寸屏幕的控件大小。这可能是最简单的解决方案。它还为您提供与 iOS 5 设备的兼容性。

2.  如果要使用自动布局，则应`IBOutlet`为适当的约束创建一个，然后以编程方式对其进行更改。

* * *

在后一个示例中，考虑一个布局，其中我在应用商店的底部有一个表格视图和一个控件（我从您的变量名中推断出这一点）。有两种方法可以隐藏和显示底部控件。一种是隐藏它（或将其`alpha`设置为零或`removeFromSuperview`），删除不必要的约束，并重新创建新的适当约束。

这行得通，但很麻烦。我现在更喜欢将我想要隐藏的高度更改为零，或者，如果它已经在屏幕的边缘，我将它从边缘滑出，这样你就看不到它了。

因此，我可能会在视觉上隐藏应用商店控件，而不是通过玩弄它的`hidden`属性，而是通过将其高度更改为零（或者，为了显示它，更改为 77）。这样，其他约束将自动调整其他控件的大小。因此，我将其隐藏：

```
 self.appStoreHeightConstraint.constant = 0.0;
        [self.view layoutIfNeeded]; 
```

我展示了：

```
 self.appStoreHeightConstraint.constant = 77.0;
        [self.view layoutIfNeeded]; 
```

我使用与底部控件的高度约束相关联的`IBOutlet`调用来做到这一点。`appStoreHeightConstraint`

或者（并且仅当被隐藏的项目位于底部时），我可以将其滑出屏幕底部（这次使用`IBOutlet`底部约束），使用：

```
 self.appStoreBottomConstraint.constant = 77.0;
        [self.view layoutIfNeeded]; 
```

并用

```
 self.appStoreBottomConstraint.constant = 0.0;
        [self.view layoutIfNeeded]; 
```

为了全面披露，我应该提一下，您必须非常小心地设计约束，以便它们同时 (a) 最低限度地描述您的布局；但是 (b) 充分描述您的布局。您想避免可怕的冲突或不令人满意的约束消息。

仅关注垂直维度，这意味着具有以下约束：

*   表视图的顶部约束是超级视图的顶部；
*   表视图的底部约束是应用商店视图的顶部；
*   表视图应该*没有*高度限制（因为这是您想要在其他内容发生变化时更改的内容）；
*   底部的应用商店控件将其顶部约束链接到 tableview；
*   应用商店的底部约束链接到超级视图的底部；和
*   应用商店的高度限制固定为 77.0。

但我发现 IB 总是（真诚地努力确保约束是明确的）正在尝试添加额外的约束（例如 tableview 的高度）。因此，我个人与 IB 搏斗以使约束完全正确（通常我最终会降低 table view 高度的优先级，当我完成其他所有事情时，我可以回去摆脱 table view 高度） .

也许我在编辑约束时太麻烦了，但我提到它是因为如果你没有完全正确地得到它们，通过改变一个约束来影响 UI 更改的努力将不会产生你想要的结果。一旦你掌握了它的窍门，就很容易看到一切都相应地调整（尤其是在复杂的场景中），这是一件很美的事情。但是前几次可能会很麻烦。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-07T19:15:47.533

您可能需要告诉视图使用`layoutIfNeeded`.

看到[我刚刚解决的问题](https://stackoverflow.com/questions/14726810/get-outlet-size-within-awakefromnib/14755702#14755702)，[这个问题也相关](https://stackoverflow.com/questions/12527191/ios-autolayout-get-frame-size-width)。

# google-apps-script - 在对象中找不到函数 getTime()

> ID：14759072
> 
> 赞同：1
> 
> 时间：2013-02-07T19:12:15.250
> 
> 标签：google-apps-script

我正在尝试使用 Apps 脚本比较 Google Docs 中的两个日期。我的日期格式为 m/d/yyyy h:mm:ss。我不断收到一条错误消息，提示“无法在对象 2/1/2013 9:42:46 中找到函数 getTime。” 我的日期格式有问题吗？我之前成功地将它用于格式为 mm/dd/yyyy 的日期，但不确定为什么添加时间戳会有所不同。任何帮助将不胜感激！

```
 for (var i = 0; i < kValues.length; i++) { // repeat loop
   if (kValues[i][0] == "") {var lastupdate = parseInt(new Date("1/1/1980 00:00:00").getTime()/day); } // if a date doesn't exist, throw it back in the past
   if (kValues[i][0] != ""){
   var lastupdate = parseInt(kValues[i][0].getTime()/day);} // if a date does exist, interpret it. Here's where I'm getting my error.
   var statusDateChange = parseInt(statusDate[i][0].getTime()/day); // interpret a date from Sheet 2
   var statusChange = changeStatus[i][0]; //find the new status
   var currentStatus = status[i][0]; //find the old status
   var currentOID = oid[i][0]; // set Order ID
   var changeOID = statusOID[i][0]; // set Order ID in Sheet 2 to compare   
   Logger.log(lastupdate + "<=" + statusDateChange);
   if (lastupdate <= statusDateChange && currentOID == changeOID && statusChange != currentStatus) {sheet.getRange(i + 2, 8, 1, 1).setValues(statusChange); // if the date in Sheet 1 is less than the date in Sheet 2 and the ID matches, change the status

  }
 } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-07T19:56:43.500

字符串末尾真的有一个点还是不是错字？ `2/1/2013 9:42:46.`

这可能是问题所在，您可以像这样测试它：

```
Logger.log(new Date("2/1/2013 9:42:46."))
Logger.log(new Date("2/1/2013 9:42:46")) 
```

返回

```
Wed Dec 31 16:00:00 PST 1969
Fri Feb 01 00:42:46 PST 2013 
```

第一个值等于`Logger.log(new Date(null))`并返回 JS 参考日期。

# scala - 从 Scala 异步使用 twitter4j

> ID：14759077
> 
> 赞同：0
> 
> 时间：2013-02-07T19:12:37.067
> 
> 标签：scala

我想`AsyncTwitter`从我的 Scala 应用程序中使用。有没有办法将它包装在期货中，让它看起来更像是惯用的 Scala？或者期货真的可以将同步的东西转换为异步的（即，对已经异步的函数没有用）？

无论哪种方式，在 Scala 中进行异步 twitter 状态更新的最惯用的方式是什么

1.  将代码包装`AsyncTwitter`在期货中？
2.  将来包装同步代码？
3.  忘记期货，只需在 Scala 中重写下面的代码。

并且（特别是如果＃1 是答案）最终代码会是什么样子？

这是我想知道的代码：http: [//twitter4j.org/en/code-examples.html#asyncAPI](http://twitter4j.org/en/code-examples.html#asyncAPI)

```
TwitterListener listener = new TwitterAdapter() {
    @Override public void updatedStatus(Status status) {
      System.out.println("Successfully updated the status to [" +
               status.getText() + "].");
    }

    @Override public void onException(TwitterException e, int method) {
      if (method == TwitterMethods.UPDATE_STATUS) {
        e.printStackTrace();
      } else {
        throw new AssertionError("Should not happen");
      }
    }
}
// The factory instance is re-useable and thread safe.
AsyncTwitterFactory factory = new AsyncTwitterFactory(listenrer);
AsyncTwitter asyncTwitter = factory.getInstance();
asyncTwitter.updateStatus(args[0]); 
```

我猜#2 不是答案，因为那样你仍然被挂起的同步线程的开销所困扰，对吧？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-07T23:18:09.190

使用 Scala 的 Futures 的实现看起来像这样（示例是 getDirectMessages）：

```
class DirectMessageListener extends TwitterAdapter {

  val promise = Promise[Seq[DirectMessage]]()

  override def gotDirectMessages(messages: ResponseList[DirectMessage]) {
    promise.success(messages)
  }

  override def onException(te: TwitterException, method: TwitterMethod) {
    promise.failure(te)
  }
}

class TwitterClient(twitter: Twitter) {

  val factory = new AsyncTwitterFactory()

  def getDirectMessage(): Future[Seq[DirectMessage]] = {
    val listener = new DirectMessageListener
    val asyncTwitter = factory.getInstance(twitter)
    asyncTwitter.addListener(listener)
    asyncTwitter.getDirectMessages()
    listener.promise.future
  }

} 
```

用法：

```
val client = new TwitterClient(???)  
client.getDirectMessage() onComplete (_.foreach(println)) 
```

# java - 查找不存在的布局

> ID：14759078
> 
> 赞同：0
> 
> 时间：2013-02-07T19:12:38.457
> 
> 标签：java, android, view, listactivity

如何在以下活动中调用 setContentView()？

```
import android.app.ListActivity;
import android.os.Bundle;
import android.widget.ArrayAdapter;

public class MyListActivity extends ListActivity {
    public void onCreate(Bundle icicle) {
        super.onCreate(icicle);
        String[] values = new String[] { 
            "Android", 
            "iPhone", 
            "WindowsMobile",
            "Blackberry", 
            "WebOS", 
            "Ubuntu", 
            "Windows7", 
            "Max OS X",
            "Linux", 
            "OS/2" };
        ArrayAdapter<String> adapter = new ArrayAdapter<String>(this,
            android.R.layout.simple_list_item_1, values);
        setListAdapter(adapter);
    }
} 
```

如您所见，ListActivities 不一定需要布局文件；但我已经习惯了（咧嘴笑）。我有一个 MenuDrawer 需要运行 setContentView()...我对任何选项持开放态度。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-07T19:18:56.493

您可以`setContentView()`像使用任何其他 Activity 一样调用，但 ListActivities 有一个额外要求：布局必须具有具有此属性的 ListView：`android:id="@android:id/list"`。

```
public class MyListActivity extends ListActivity {
    public void onCreate(Bundle icicle) {
        super.onCreate(icicle);
        setContentView(R.layout.activity_myListActivity);
        ... 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-07T19:24:00.167

遵循 MenuDrawer 在此处[ListActivitySample](https://github.com/SimonVT/android-menudrawer/blob/master/samples/src/net/simonvt/menudrawer/samples/ListActivitySample.java)发布的示例。似乎关键是覆盖`setContentView`ListActivity 代表您调用的内容并将其转发到您的菜单抽屉中。

以下似乎是关键：

```
@Override
public void setContentView(int layoutResID) {
    // This override is only needed when using MENU_DRAG_CONTENT.
    mMenuDrawer.setContentView(layoutResID);
    onContentChanged();
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-07T19:37:39.450

我调用了 Activity 的 getListView()：

```
mMenuDrawer.setContentView(getListView()); 
```

为什么我总是在我发布到 StackOverflow 之后弄清楚事情？？？

# ruby-on-rails-3 - Rails FactoryGirl 实例与 ActiceRecord 实例不同？

> ID：14759083
> 
> 赞同：1
> 
> 时间：2013-02-07T19:12:57.123
> 
> 标签：ruby-on-rails-3, rspec, factory-bot

为什么当我使用 FactoryGirl 创建记录并稍后更新该记录时 factorygirl 实例未更新？例如，如果我有以下工厂和 rspec 测试：

```
factory :foo do
  bar false
end 
```

在 rspec 测试内部：

```
foo = FactoryGirl.create(:foo)
Foo.first.update_attribute(:bar, true)
expect(foo.bar).to eq(true) #foo.bar is false and will fail 
```

如果我将`foo.bar`最后一行更改为`Foo.first.bar`通过，为什么会出现差异？FactoryGirl 实例是否没有直接关联到记录？执行测试`expect(foo).to eq(Foo.first)`返回 true 那么它们不是同一个对象吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-07T19:16:08.960

我想你可能需要改变

```
expect(foo.bar).to eq(true) 
```

到

```
expect(foo.reload.bar).to eq(true) 
```

顺便说一句，您可能想了解`be_true`：

```
expect(foo.reload.bar).to be_true 
```

# java - Java如何创建一个包含元素“TIMESTAMP(6)”的枚举

> ID：14759087
> 
> 赞同：0
> 
> 时间：2013-02-07T19:13:06.153
> 
> 标签：java

我正在尝试在基于数据类型构建查询的应用程序中构建高级搜索功能。

我潜在的数据类型是`FLOAT, NUMBER, CHAR, VARCHAR2, DATE, TIMESTAMP(6)`

我正在尝试“从我的外壳中编写代码”，而不是使用 ArrayList 来存储值，而是尝试使用，`enum`因为我只有这 6 个值并且它们永远不会改变。

`TIMESTAMP(6)`由于括号，我很难过。

我如何声明一个枚举值`TIMESTAMP(6)`？

目前，下面的代码片段给了我错误：构造函数 TableBacking.dataTypeOptions(int) 未定义。

```
public enum dataTypeOptions {
    FLOAT, NUMBER, CHAR, VARCHAR2, DATE, TIMESTAMP(6)
}; 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-07T19:14:50.107

枚举常量名称需要是有效的标识符。所以你可以称之为`TIMESTAMP_6`例如。

如果您以后需要返回的字符串表示形式，`TIMESTAMP(6)`您可以在枚举中使用 String 构造函数来定义该值。

它可能看起来像这样：

```
public enum dataTypeOptions {

    FLOAT, NUMBER, CHAR, VARCHAR2, DATE, TIMESTAMP_6("TIMESTAMP(6)");
    private String stringRepresentation;

    dataTypeOptions() { //default behaviour, use the enum constant identifier
        this.stringRepresentation = this.name();
    }

    dataTypeOptions(String s) {
        this.stringRepresentation = s;
    }

    public String getStringRepresentation() {
        return stringRepresentation;
    }

}; 
```

# javascript - 一种使用 require 加载主干堆栈的方法

> ID：14759090
> 
> 赞同：2
> 
> 时间：2013-02-07T19:13:14.320
> 
> 标签：javascript

以下是我如何使用纯 HTML 脚本标签按照这个[关于 CDN 建议的 SO Question 来完成的](https://stackoverflow.com/questions/9357806/backbone-js-underscore-js-cdn-recommendation)。这将是一个串行加载（下划线->jquery->backbone），它支撑了页面的其余部分。

```
 <script src="//cdnjs.cloudflare.com/ajax/libs/underscore.js/1.4.4/underscore-min.js"></script>
 <script src="//cdnjs.cloudflare.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
 <script src="//cdnjs.cloudflare.com/ajax/libs/backbone.js/0.9.10/backbone-min.js"></script> 
```

我将如何使用 require.js 或类似的非阻塞方法加载这些库？

**参考资料（API 链接）**

*   [下划线](http://underscorejs.org/)

*   [jQuery](http://api.jquery.com/category/ajax/)

*   [骨干](http://backbonejs.org/)

*   [要求](http://requirejs.org/docs/api.html)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-07T19:24:31.507

jquery 是 AMD 友好的，所以你可以在你的 require.js 配置中使用它

主干和下划线不再对 AMD 友好，因此您有以下选项：

1.  您可以将它们包含为“外部”，并使用 shim 分配正确的依赖项（请参阅此处[的文档](http://requirejs.org/docs/api.html#config-shim)和[教程](http://gregfranko.com/blog/require-dot-js-2-dot-0-shim-configuration/)）

2.  或者，您可以使用启用 AMD 的两个库的略微更改版本。您可以在[此存储库](https://github.com/amdjs)中找到它们。

3.  使用旧版本的主干和下划线。（不建议）

* * *

注意：如果您选择 shiming 路由，请记住这些库不会异步加载。

* * *

这是一个使用库的更改版本的工作**示例**：

```
require.config({
    enforceDefine: true, //Only libraries AMD Friendly will be loaded
    urlArgs: "bust=" + (new Date()).getTime(), //for development, forces browser to clear the cache
    paths: { // relative paths (to the current file main.js)
        "es5":               'libs/es5-shim/es5-shim',
        "jquery":            'libs/jquery/jquery',
        "jqueryThreeDots":   'libs/jquery/plugins/jquery.ThreeDots',//A jquery plugin
        "underscore":        'libs/underscore/underscore.amd',
        "underscore.string": 'libs/underscore/underscore.string',
        "backbone":          'libs/backbone/backbone.amd',
        "text":              'text',
        "mediator":          'libs/backbone/plugins/backbone.mediator',
        "bootstrap":         'libs/bootstrap/bootstrap.min',
        "rangy":             'libs/rangy/rangy-core.amd',
    },
    shim: {
        "bootstrap": {
            deps: ["jquery"],
            exports: "$.fn.popover"
        }
    }
}); 
```

垫片的一个例子：

```
require.config({
    enforceDefine: true,
    urlArgs: "bust=" + (new Date()).getTime(),
    paths: {
        "jquery": 'http://code.jquery.com/jquery-1.9.1.min.js'
    },
    shim: {
        backbone: {
            deps: ["underscore", "jquery"], // Backbone dependencies
            exports: "Backbone" // variable exported
        },
        underscore: {
            exports: "_"
        }
    }
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-07T19:31:49.977

这就是我们在项目中包含 jQuery、Underscore 和 Backbone 的方式：

```
requirejs.config({
    baseUrl: "js",

    paths: {
        backbone: "backbone-min",
        jquery: "jquery.min",
        underscore: "underscore-min"
    },

    shim: {
        backbone: { deps: ["underscore", "jquery"], exports: "Backbone" },
        jquery: { exports: "jQuery" },
        underscore: { exports: "_" }
    }
});

requirejs(["backbone"], function (Backbone) {
    // Now we can reference not just Backbone but also jQuery and
    // underscore since those two are dependencies for Backbone.
}); 
```

# iphone - NSManagedObject 异常“此类不符合键值编码”并在 ios 6 中使应用程序崩溃，但适用于 ios 5

> ID：14759094
> 
> 赞同：8
> 
> 时间：2013-02-07T19:13:21.310
> 
> 标签：iphone, ios, core-data

我遇到了一个问题，即我的应用程序崩溃并出现以下异常：

## ABC[1936:c07] ***由于未捕获的异常“NSUnknownKeyException”而终止应用程序，原因：“[<_NSObjectID_48_0 0xb63e310> valueForUndefinedKey:]：此类不符合键 ID 的键值编码。”

这个异常的奇怪问题是使用iOS5时不会发生。请参阅下面发生异常的代码：

```
- (void)viewWillAppear:(BOOL)animated
{
    [super viewWillAppear:animated];

if ((self.sectionInfoArray == nil) ||
    ([self.sectionInfoArray count] != [self numberOfSectionsInTableView:self.tableView]))
{
    NSMutableArray *infoArray = [[NSMutableArray alloc] init];

    for (Tour *tour in self.tours)
    {
        SectionInfo *sectionInfo = [[SectionInfo alloc] init];
        sectionInfo.tour = tour;
        sectionInfo.open = NO;

        NSLog(@"Tour Details Count %@", [[tour tourDetails] objectAtIndex:0]);

        NSNumber *defaultRowHeight = [NSNumber numberWithInteger:DEFAULT_ROW_HEIGHT];
        NSInteger countOfQuotations = [[sectionInfo.tour tourDetails] count];

        for (NSInteger i = 0; i < countOfQuotations; i++)
        {
            [sectionInfo insertObject:defaultRowHeight inRowHeightsAtIndex:i];
        }

        [infoArray addObject:sectionInfo];
    }

    self.sectionInfoArray = infoArray;
} 
```

}

是否会因为我在类 Tour 中定义了一个获取的属性而导致这个异常，该类获取了一个 TourDetail 类的数组。请参阅以下两个类的实现代码：

```
 #import "Tour.h"
#import "TourDetail.h"

@implementation Tour

@dynamic background_url;
@dynamic id;
@dynamic summary;
@dynamic title;
@dynamic tour_tourdetail;

@dynamic tourDetails;

@end

#import "TourDetail.h"

#import <Foundation/Foundation.h>
#import <CoreData/CoreData.h>

@class TourDetail;

@interface Tour : NSManagedObject

@property (nonatomic, retain) NSString * background_url;
@property (nonatomic, retain) NSNumber * id;
@property (nonatomic, retain) NSString * summary;
@property (nonatomic, retain) NSString * title;
@property (nonatomic, retain) TourDetail *tour_tourdetail;

@property (nonatomic, retain) NSArray *tourDetails;

#import <Foundation/Foundation.h>
#import <CoreData/CoreData.h>

@interface TourDetail : NSManagedObject

@property (nonatomic, retain) NSString * audiofile;
@property (nonatomic, retain) NSString * detail;
@property (nonatomic, retain) NSNumber * id;
@property (nonatomic, retain) NSNumber * lattitude;
@property (nonatomic, retain) NSNumber * longitude;
@property (nonatomic, retain) NSString * title;
@property (nonatomic, retain) NSNumber * tour_id;
@property (nonatomic, retain) NSManagedObject *tourdetail_tour;

@end

@implementation TourDetail

@dynamic audiofile;
@dynamic detail;
@dynamic id;
@dynamic lattitude;
@dynamic longitude;
@dynamic title;
@dynamic tour_id;
@dynamic tourdetail_tour;

@end 
```

对此问题的任何帮助将不胜感激。因为我不知道如何解决这个问题。

谢谢，迈克尔

更新：

当我删除 Fetched 属性时，iOS6 不会发生异常。请参阅我在下面配置的谓词：

## 获取的属性 tourDetails 谓词 tour_id == $FETCH_SOURCE.id

你能看到我在设置这个谓词时做错了什么吗？我的目标是使用它，以便我可以为每个 tour_id 返回一个 TourDetail 对象数组，该对象对 Tour 表中的 id 列进行数学运算。

更新：

我已经能够诊断出由于谓词而引发了异常，因为当我分别调用两个表时，没有引发异常。你能看出我创建的谓词有什么问题吗？

请参阅下面的代码，显示我如何从 Core Data DB 中检索对象：

```
- (void)viewDidLoad
{
    [super viewDidLoad];

    [DrivingToursContent setupStaticData];

    self.tableView.sectionHeaderHeight = HEADER_HEIGHT;
    _openSectionIndex = NSNotFound;

    self.tableView.backgroundColor = [UIColor colorWithPatternImage:[UIImage imageNamed:@"custombackground.ptoung"]];

    self.managedObjectContext = [[BaseCoreDataController sharedInstance] newManagedObjectContext];

    [self loadRecordsFromCoreData];

    [self loadRecordsFromCoreDataForTourDetail];

    NSLog(@"Tour Detail array count: %d", [self.toursTest count]);

    // Do any additional setup after loading the view.
}

- (void)loadRecordsFromCoreData {
    [self.managedObjectContext performBlockAndWait:^{
        [self.managedObjectContext reset];
        NSError *error = nil;
        NSFetchRequest *request = [[NSFetchRequest alloc] initWithEntityName:NSStringFromClass([Tour class])];
        [request setSortDescriptors:[NSArray arrayWithObject:[NSSortDescriptor sortDescriptorWithKey:@"id" ascending:YES]]];
        self.tours = [self.managedObjectContext executeFetchRequest:request error:&error];
    }];
} 
```

更新：

问题的根源肯定来自我为 Fetched 属性定义的谓词，但您能否建议我应该如何编写谓词以链接两个表。当我编写谓词 tour_id == 0 并直接引用我知道存在的 id 时，获取的属性可以正常工作。但是当我使用 $FETCH_SOURCE.id 时，会引发键值编码异常。您使用什么属性来引用您希望链接到的表？

非常感谢您对此提供的所有帮助。

谢谢，迈克尔

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-08T10:00:45.767

> @property (nonatomic, 保留) NSNumber * id;

Objective-C中不是`id`保留字吗？您是否尝试过将此属性重命名为其他名称，以查看是否会导致任何冲突？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-07T19:30:20.497

在没有看到您的代码的情况下，您正在调用 iOS6 中已弃用的类的方法，因此崩溃。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-07T22:18:21.113

您发布的代码中没有`viewWillAppear`任何内容以任何明显的方式触及核心数据，这使得很难猜测发生了什么。其中一些对象可能是托管对象，但谁知道哪些对象或您是如何创建它们的？

但是，错误消息确实提供了一个巨大的线索：

```
[<_NSObjectID_48_0 0xb63e310> valueForUndefinedKey:]: this class is not key value coding-compliant for the key id. 
```

这提到的事实`_NSObjectID_48_0`表明，在某些时候您正在使用`NSManagedObjectID`实例，而您期望`NSManagedObject`实例。`NSManagedObjectID`没有一个名为 的属性`id`，无论实体是什么样的，所以询问它`id`会产生“不符合键值编码”的错误。

至于为什么会发生这种情况，仍然无法说，因为您还没有发布任何代码来提供有关您如何使用 Core Data 的任何线索。

这**可能**与谓词有关：

```
tour_id == $FETCH_SOURCE.id 
```

如果您构造了一个 fetch ，那么它`$FETCH_SOURCE`就是一个`NSManagedObjectID`，这将是一个问题。也许（我只能猜测）您在请求结果类型时使用它`NSManagedObjectIDResultType`。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-02-08T16:48:48.923

无需深入研究您的代码，NSFetchRequest 可以设置返回的结果类型，例如，NSManagedObject **ID** ResultType 或 NSManagedObjectResultType。

需要 NSManagedObjectResultType，但会返回 NSManagedObjectIDResultType。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2016-09-20T02:26:10.747

我在使用 MagicalRecord 时遇到了同样的问题，但在使用 Xcode 生成 CoreData 源代码时没有问题。

# jquery - 从 JQuery Ui 获取索引值到可用数组中

> ID：14759095
> 
> 赞同：0
> 
> 时间：2013-02-07T19:13:26.143
> 
> 标签：jquery, arrays, user-interface, selectable

您好我正在使用可选择的 JQuery Ui 作为多选网格。我一生都无法弄清楚如何将索引的值放入可用的数组/对象中。我可以让它们显示在带有值的 div 中，但试图让它们离开那里并进入其他东西无济于事。我已经花了几个小时来研究这个问题，并且看到很多人有类似的问题，任何帮助都将不胜感激。

```
<!doctype html>
<html class="" xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en"><head>
<title>Testing</title>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<meta http-equiv="Content-Language" content="en">
<meta name="language" content="en">

<link rel="stylesheet" href="css/phpMM.css">

    <script type="text/javascript" src="js/jquery.js"></script>
    <script type="text/javascript" src="js/jquery_002.js"></script>

<link rel="stylesheet" href="ui/jquery.ui.all.css">
<link rel="stylesheet" href="ui/demos.css"> 

    <script src="../jquery-1.8.3.js"></script>
    <script src="js/jquery.ui.core.js"></script>
    <script src="js/jquery.ui.widget.js"></script>
    <script src="js/jquery.ui.datepicker.js"></script>

    <script src="js/jquery.ui.position.js"></script>
    <script src="js/jquery.ui.menu.js"></script>
    <script src="js/jquery.ui.mouse.js"></script>
    <script src="js/jquery.ui.button.js"></script>

<link rel="stylesheet" href="ui/dropdown.css">  

<link rel="stylesheet" href="ui/multiclicklist.css">
<script src="js/jquery.ui.selectable.js"></script>

  <script src="js/jquery.dropkick-1.0.0.js" type="text/javascript" charset="utf-8"></script>
      <link rel="stylesheet" href="ui/dropkick.css" type="text/css">

<style>
    #Testing { list-style-type: none; margin: 0;  padding: .25em; width: 450px;   height: 185px;}
    #Testing li { margin: 3px;  float: left; width: 100px; height: 80px; font-size: 1.5em; text-align: center;  }
</style>

<script type ="text/javascript">
    var apron = [];

    $(function() {
        $("#Testing").bind("mousedown", function(e) {
            e.metaKey = true;

    }).selectable();
    });

    $(function() {
        $( "#Testing" ).selectable({
            stop: function() {
            var result = $( "#click-result" ).empty();

            $( ".ui-selected", this ).each(function() {
                var Pindex = $( "#Testing li" ).index( this );
                result.append( ", " + ( Pindex + 1 ) );

               });

            }

        }); 
    });

    (function showAlert() {
        var WTF ="why dont it work";
        for (var i = 0; i < apron.length; i++){
            alert(apron[i]);
        };
    });

</script>   

<body>

        <p id="feedback">
            <span>You've selected:</span> <span id="click-result">none</span>.
        </p>

        <strong>&#149; Select Options? </strong> (select all that apply)
            <ol id="Testing" class="multiclicklist">
                <li class="ui-state-default"value="1">Opt 1</li>
                <li class="ui-state-default"value="2">Opt 2</li>
                <li class="ui-state-default"value="3">Opt 3</li>
                <li class="ui-state-default"value="4">Opt 4</li>
                <li class="ui-state-default"value="5">Opt 5</li>
                <li class="ui-state-default"value="6">Opt 6</li>
                <li class="ui-state-default"value="7">Opt 7</li>
                <li class="ui-state-default"value="8">Opt 8</li>
            </ol>

            <input type="button" value="CheckValue" onclick="showAlert();">
</body>

</html> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-07T19:21:45.127

tonyswoodshed.com 上的代码不起作用，但我已经把它放在`jsfiddle`.

这是：http: [//jsfiddle.net/WDd9w/1/](http://jsfiddle.net/WDd9w/1/)您正在寻找的东西吗？

# android - Android：如何将 ViewPager 布局与非 ViewPager 布局混合用于不同的设备方向？

> ID：14759097
> 
> 赞同：5
> 
> 时间：2013-02-07T19:13:36.443
> 
> 标签：android, android-layout

目标是根据屏幕方向（纵向或横向）以不同的布局在屏幕上显示两个片段（片段 A、片段 B）。

当设备处于纵向模式时，一次只显示 Frag A 和 Frag B 中的一个，使用滑动切换 UI。ViewPager 非常适合这个。

当设备处于横向模式时，Frag A 显示在屏幕左侧，Frag B 显示在右侧。一个简单的 LinearLayout 可以完美地解决这个问题。

当试图让两者在同一个应用程序中工作时，就会出现问题。似乎必须在 Java 源代码中引用 ViewPager 类（在 onCreate 方法中）。这意味着在 XML 和源代码中都定义了一个 UI 元素......当设备处于横向模式并且不应该有 ViewPager 对象但在源代码中被引用时，这似乎是一个问题。我正确地接近这个吗？如果一个布局使用 ViewPager，那么其他所有布局都需要 ViewPager 吗？

布局/activity_mymain.xml

```
<android.support.v4.view.ViewPager xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:tools="http://schemas.android.com/tools"
    android:id="@+id/pager"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    tools:context=".MyMainActivity" >

    <!--
    This title strip will display the currently visible page title, as well as the page
    titles for adjacent pages.
    -->

    <android.support.v4.view.PagerTitleStrip
        android:id="@+id/pager_title_strip"
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        android:layout_gravity="top"
        android:background="#33b5e5"
        android:paddingBottom="4dp"
        android:paddingTop="4dp"
        android:textColor="#fff" />

</android.support.v4.view.ViewPager> 
```

布局土地/activity_mymain.xml

```
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:orientation="horizontal"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent">

    <fragment android:name="com.example.ActionFragment"
              android:id="@+id/action_fragment"
              android:layout_weight="1"
              android:layout_width="0dp"
              android:layout_height="match_parent" />

    <fragment android:name="com.example.SummaryFragment"
              android:id="@+id/summary_fragment"
              android:layout_weight="2"
              android:layout_width="0dp"
              android:layout_height="match_parent" />

</LinearLayout> 
```

来自 MyMainActivity.java

```
protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_topmain);

    // Create the adapter that will return a fragment for each of the three
    // primary sections of the app.
    mSectionsPagerAdapter = new SectionsPagerAdapter(getSupportFragmentManager());

    // Set up the ViewPager with the sections adapter.
    mViewPager = (ViewPager) findViewById(R.id.pager);
    mViewPager.setAdapter(mSectionsPagerAdapter);

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-08T14:54:32.393

ViewPager 用于在运行时实例化 View 对象，因此需要在代码中定义。

我试图做的与[Fragments Guide](http://developer.android.com/guide/components/fragments.html)中描述的不同平板电脑/手机布局非常相似，他们建议使用单独的活动。

（如果有人知道一种完全在 XML 中处理滑动的方法，那将是一个更好的解决方案）

# sql-server-2008 - 需要 SQL Server 2008 案例语句来评估表并返回两个值

> ID：14759099
> 
> 赞同：2
> 
> 时间：2013-02-07T19:13:48.237
> 
> 标签：sql-server-2008

我是一个新手 SQL 程序员，整个早上都在为此苦苦挣扎，所以请多多包涵。我的情况是这样的：我有一张 SKU 表，需要发送到我们的电子商务网站。这些 SKU 中的每一个都有一个“数量”、一个“活跃”值和一个“停产”值。当我们一次处理一个 SKU 时，这很容易处理，但现在我必须发送包含一个或多个 SKU 的套件。

例如，如果我的套件 ID 是 000920_001449_001718_999999（四个 SKU 的组合），我需要收集整个 SKU 集的数据，如下所示：

![查询结果](../Images/cd5eac1c539275361e0d9a6d1ab0c65b.png)

这是我需要合并的逻辑：

1.  如果任何 SKU 的 IsActive 值为 null 或 WEBNO，则整个套件必须返回 WEBNO。否则，返回 WEBYES。
2.  如果任何 SKU 的 IsDiscontinued 值为 null 或“1”，则整个套件必须返回 IsDiscontinued =“1”。否则，返回 0。

我的代码有点乱，但这是我到目前为止所管理的：

```
SELECT
CASE WHEN 'WEBNO' in
(
    SELECT IsActive
    FROM #SkusToSend as Sending
    RIGHT JOIN
    ( 
        SELECT * FROM [eCommerce].[dbo].[Split] (
          '000920_001449_001718_999999'
          ,'_') 
    ) as SplitSkus
    on Sending.SKU = SplitSkus.items
) THEN 'WEBNO'
ELSE 'WEBYES'
END 
```

我的问题是：是否可以编写一个语句来解析我的示例表，只返回一行“IsActive”和“IsDiscontinued”？我尝试在这些字段上使用 GROUP BY 和 HAVING 语句，但总是返回多行。

我拥有的代码处理 WEBNO 值，但不是 NULL，甚至还没有开始考虑 IsDiscontinued 字段。有没有一种简洁的方法可以一起解析这个问题，或者有更好的方法来处理这类问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-07T19:43:10.220

我认为`ISNULL`and `MIN`/的组合`MAX`应该可以解决问题：

```
SELECT
    MIN(ISNULL(sending.IsActive, 'WEBNO')) AS IsActive,
    MAX(ISNULL(sending.IsDiscontinuted, 1)) AS IsDiscontinuted
FROM 
( 
    SELECT * FROM [eCommerce].[dbo].[Split] (
      '000920_001449_001718_999999'
      ,'_') 
) AS SplitSkus 
LEFT JOIN #SkusToSend AS Sending
    AS Sending.SKU = SplitSkus.items 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-07T19:26:58.027

如果您在这些表中有一些示例数据的工作示例，我认为这会更容易。从猜测来看，您似乎有一个表函数将字符串分开并给出多行。您有一些正确连接到该临时表的临时表，因此即使临时表中有空值，它也可以使用该函数并基本上返回它获得的所有行。这可能会返回多行，就好像您有一个条件，即您希望在左或右连接上有一个实体，并且有时会有一个空值，您会得到多个。或者，如果您重复了一个值，您将获得倍数。你必须确保你得到一个我相信的结果

```
Case when 'WEBNO' in 
( 
```

虽然返回“WEBNO”答案的逻辑可能是正确的，但它可能会多次重复行结果，因为引擎可能会解释“这发生了”一次、两次、三次。你可以通过潜在地做一个来缓解这种情况

```
'Select Distinct IsActive' 
```

这将使表达式仅返回与该列返回不同的单个结果。

如果我们可以看到这些对象包含哪些数据的示例，这将更容易，但这是我的猜测。

# drupal - Drupal 7 功能来格式化图像 URL？

> ID：14759103
> 
> 赞同：1
> 
> 时间：2013-02-07T19:14:06.590
> 
> 标签：drupal, drupal-7

我正在 Drupal 7 中创建一个模块。如果我想将 UNIX 时间戳格式化为日期，我可以使用 format_date 函数，如下所示：

```
$date = format_date($node->created, 'custom', 'j F Y'); 
```

还有一个我可以参考的函数来格式化图像吗？说我的数据库查询返回

```
picture-4-136576449.png 
```

从表中，我想将其转换为：

```
<img src="/images/picture-4-136576449.png /> 
```

有功能吗？谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-07T19:33:15.747

如果您尝试将 a 转换`URI`为 URL，那么您做错了。

```
$uri = 'public://images/my-photo.png';
$url = file_create_url($uri);
// $url should be publicly accessible URL now. 
```

如果您知道图像相对于 Drupal 根目录的路径，请使用

```
$url = url('path/to/image.png', array('alias' => FALSE)); 
```

您可以使用[`theme('image', $variables)`](http://api.drupal.org/api/drupal/includes!theme.inc/function/theme_image/7).

前任：

```
<?php 
print theme('image', array('path' => 'path/to/image.png', 
                           'title' => t('Some title'), //optional
                           'alt' => t('Some alt text'), //optional
                      )); 
```

您可以在 theme_image() function [doc page](http://api.drupal.org/api/drupal/includes!theme.inc/function/theme_image/7)中查看其他变量。

# highcharts - highstock 艰难的滚动

> ID：14759106
> 
> 赞同：1
> 
> 时间：2013-02-07T19:14:13.587
> 
> 标签：highcharts, highstock

使用触摸设备时，需要用手指滚动页面，它会捕获所有触摸事件以防止滚动。有没有一种技巧可以让它与 highstock 一起使用，就像 highcharts [Highcharts Touch Hack一样](https://gist.github.com/skarface/2994906)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2018-02-08T08:14:29.490

您可以像这样扩展 Pointer 的 pinch 方法：

```
Highcharts.wrap(Highcharts.Pointer.prototype, 'pinch', function pinch(proceed, e) {
if (e.touches.length === 1 && e.type === 'touchmove') {
  this.chart.pan(e, this.chart.options.panning)
} else {
  proceed.call(this, e)
  if (e.type === 'touchstart') {
    this.chart.mouseDownX = this.pinchDown[0].chartX
    this.chart.mouseDownY = this.pinchDown[0].chartY
  }
}
}) 
```

# c# - 使用实体框架对 asp.net mvc4 进行单元测试

> ID：14759113
> 
> 赞同：1
> 
> 时间：2013-02-07T19:14:34.523
> 
> 标签：c#, visual-studio-2010, unit-testing, asp.net-mvc-4, entity-framework-5

Web 请求“Url to Test”成功完成，但未运行测试。

这个错误可以通过不调用asp服务器来传递；注释掉 TestMethod 和 CreateTest 之间的行。但后来我收到以下错误？

System.ArgumentException：在配置中找不到指定的命名连接，不打算与 EntityClient 提供程序一起使用，或者无效。

测试项目中的 App 配置文件没有连接。我尝试插入相关连接字符串，并将主项目中的 web.config 复制到项目中，但我仍然收到此错误？！我研究了一些线程，这些线程表明我有一半使用某种假数据库？这是真的; 如果可以的话，有人可以指点我吗

```
 [TestMethod()]
    [HostType("ASP.NET")]
    [AspNetDevelopmentServerHost("C:\\Users\\Admin\\Documents\\Visual Studio 2010\\Projects\\CA3 EAD\\CA3 EAD", "/")]
    [UrlToTest("http://localhost:2124/")]
    public void CreateTest()
    {
        EmployeeController target = new EmployeeController(); // TODO: Initialize to an appropriate value
        Employee employee = new Employee(); // TODO: Initialize to an appropriate value
        //employee.Name = "test";
        //employee.Surname = "test";
        //employee.Town = "test"; ;
        //employee.County = "test";
        //employee.Country = "test";
        //employee.GradeID = 4;
        //ActionResult expected = target.Create(); // TODO: Initialize to an appropriate value
        //ActionResult actual = null;
        var expected = target.Create();
        var actual = target.Create(employee);
        //Assert.AreEqual(expected, actual);
        //Assert.Inconclusive("Verify the correctness of this test method.");
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-06-24T21:04:22.253

这个问题困扰了我很久，也是一个颇有争议的问题。

[Entity Framework 4.1 的假 DbContext 进行测试](https://stackoverflow.com/questions/6904139/fake-dbcontext-of-entity-framework-4-1-to-test)

请参阅上述答案。

# python - 在元组列表中搜索元组值

> ID：14759114
> 
> 赞同：0
> 
> 时间：2013-02-07T19:14:35.913
> 
> 标签：python

我的数据结构实际上是一个字典，它有一个整数键和一个元组列表的值。我想在该列表中找到一个特定的索引。例如：

```
 d = {}
 d[2] = [(1,-2),(2,4),(3,2)]
 d[1] = [(1,-2),(1,4)] 
```

我想在索引为 2 或 -2 的列表中查找所有元组（它们可以在元组的第一个或第二个成员中）。然后根据某些条件，我想从列表中删除元组元素。例如，我想从列表 d[2] 中删除 (1,-2)。我没有找到执行此步骤的有效方法，因为每当我从 d[2] 中删除它时，我还想从列表 d[1] 中删除 (1,-2)。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-07T19:16:31.573

```
>>> a = [(1,1), (2,2)]
>>> if (1,1) in a:
...     print 'Ok'
... 
Ok
>>> 
```

* * *

要删除东西：

```
>>> b = [(1,-1,(3,1),(5,2)]
>>> filter(lambda a: a != (1,-1), b) 
```

应该给你：

> [(3,1), (5,2)]

**所以..**

```
d = {}
d[2] = [(1,-2),(2,4),(3,2)]
d[1] = [(1,-2),(1,4)]

for k, v in d.items():
    d[k] = filter(lambda a: a != (1,-1), v) 
```

这将从您的字典中完全删除 (1, -1) 。

# validation - 如何跨多个表单共享验证。约束？

> ID：14759115
> 
> 赞同：2
> 
> 时间：2013-02-07T19:14:41.513
> 
> 标签：validation, scala, playframework-2.0, code-reuse, typeclass

我在我的网络表单上使用了约束，我注意到有几个表单有类似的验证，例如我有几种类型的表单，它们都有开始日期和结束日期。在每种情况下，我都想验证开始日期是否早于结束日期。这是我从表单创建的案例类：

```
 case class OrderSearchForm(orderId: Option[Int], startDate:Option[Long], endDate:Option[Long]) 
```

和我的验证（让我们暂时忽略 .get() ）：

```
 def validateSearchDate = Constraint[OrderSearchForm]{ 
    osf: OrderSearchForm => {
      if (!osf.startDate.isEmpty && !osf.endDate.isEmpty && osf.startDate.get.compareTo(osf.endDate.get) > 0 )
        Invalid("Begin Date is after End Date.")
      else
        Valid
    }
  } 
```

现在，由于我有很多带有开始日期和结束日期的表单，我想重新编写我的验证以使用代表这些表单的所有案例类。我想知道 typeclass 模式是否可以帮助我解决这个问题：

```
trait TwoDates[T] { 
  def twoDatesTuple(t: T): (Option[Long], Option[Long]) 
}

trait TwoDatesOSF extends TwoDates[OrderSearchForm] { 
  def twoDatesTuple(t: OrderSearchForm) = (t.startDate, t.endDate) 
}

implicit object TwoDatesOSF extends trait TwoDatesOSF

def validateSearchDate = Constraint[TwoDates[_]] { t: TwoDates[_] => ... (as above)} 
```

但申请不起作用：

```
validateSearchDate(OrderSearchForm(None, None, None)) 
```

产量：

> 错误：类型不匹配；找到：需要 OrderSearchForm：TwoDates[_] betweenDates(osf)

1) 我可以使用类型类编写通用验证吗？如果是这样，我做错了什么？

2）我可以在避免使用超类的同时编写通用验证（即

```
abstract class TwoDates(start: Option[Long], end:Option[Long])

case class OrderSearchForm(orderId: Option[String], startDate:Option[Long], endDate:Option[Long]) extends TwoDates(startDate, endDate) 
```

一旦进行了多个验证，这似乎很尴尬）

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-08T17:26:00.713

我认为您可以使用结构类型：

```
private type TwoDates = { def startDate: Option[Date]; def endDate: Option[Date] }

def validateTwoDates = Constraint[TwoDates] { osf: TwoDates =>
if (!osf.startDate.isEmpty && 
    !osf.endDate.isEmpty && 
    osf.startDate.get.compareTo(osf.endDate.get) > 0) {
        Invalid("Begin Date is after End Date.")
    } else Valid
}

case class Something(
   startDate: Option[Date], 
   endDate: Option[Date], 
   name: String)

private val form = Form(mapping(
   "startDate" -> optional(date),
   "endDate" -> optional(date),
   "name" -> text)
(Something.apply)(Something.unapply).verifying(validateTwoDates)) 
```

# php - 如何在 PHP MySQL 中进行分页

> ID：14759117
> 
> 赞同：-1
> 
> 时间：2013-02-07T19:14:42.350
> 
> 标签：php, mysql

我有一个数据库。当我获取数据时，它有很多行。我想打破这个结果。我阅读了许多有关分页的教程，但不了解如何进行分页。以下是我的代码-

```
<?php
                if(isset($_GET['search_profile'])){
                $gender = $_GET['Gender'];
                $religion = $_GET['selected_religion'];
                $caste = $_GET['selected_caste'];
                $marital_status = $_GET['marital_status'];
                $lage = $_GET['lage'];
                $hage = $_GET['hage'];

                $current_date = date('Y');
                            $hage1 = date('Y') - $hage;
                //echo $hage1;
            //  echo "<br>";
                $lage1 = date('Y') - $lage;
                //echo $lage1;

                $qq = "SELECT * FROM members WHERE yyyy BETWEEN '$hage1' AND '$lage1' AND gender='$gender' 
                AND religion LIKE '%$religion%'
                AND caste LIKE '%$caste%'
                AND marital_status LIKE '%$marital_status%'";

$profile_query_result = mysql_query($qq, $dbc)
or die('Error1'.mysql_error());

                }
                ?> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-07T23:41:35.567

I just finished my first pagination script the other day. It wasn't that hard. Honestly I would be happy to help you understand the logic of it but I am not going to code it for you - I also believe this topic has been covered on these boards and this is a possible duplicate.

How much PHP do you know? The logic behind your pagination script (assuming the data is coming from a database) is something like this:

**You need at least 2 database queries** -Your first query will tell you how many results there are and your second query will actually provide the results.

**There are a few variables you will need** - You will need to know the number of items. You will also need to know the limit - that is, how many items can appear on each page. You find the number of pages by dividing the limit from the number of items (# of items / limit per page )

**The Display HTML** - To create the HTML of the pagination I used a series of if statements. Kind of like the following pseudo code:

```
if ( isset( $_GET['page'] ) ) {
       $page = preg_replace( '/[^0-9]/', '', $_GET['page'] );
}
else {
       $page = 1;
}

/* the following code will not work
   with the identity (===) operator 
   because when coming from get $page
is a string not an int */

if ( $current_page == 1 ) {

     $page2 = $page + 1;
     $page3 = $page + 2;
     $page4 = $page + 3;

     $pagination .= "<div>Pg $page</div>";

    // if theres a second page, display page 2
    if ( $num_of_posts > ( $limit * 1 ) ) {
         $pagination .= "<a>$page2 &gt;</a>";
    }

    // if there is a 3rd page
    if ( $num_of_posts > ( $limit * 2 ) ) {
         $pagination .= "<a>$page3 &gt;</a>";
    }

    // if there is a 4th page
    if ( $num_of_posts > ( $limit * 3 ) ) {
         $pagination .= "<a>$page4 &gt;</a>";
    }

    // if there is more than 4 pages
    if ( ($page4 != $last_page && $page3 != $last_page ) {
         $pagination .= "<a href='" . $last_page . "'>&gt; &gt;</a>";
    }
} 
```

This process will need to be repeated. How much you repeat it is entirely up to you. You can rewrite the if / elseif statements as a switch statement, I personally do not use the switch statement in web programming.

You can take the same approach to ( $page == 2 ), ( $page == $last_page ), ( $page == ( $last_page - 1 ). You can go overboard. This simply ensures that the HTML output will be appropriate if there is only one or two pages of content.

**The Second Query** - The second query will fetch the results from the database. The limit will be ( ( $page - 1 ) * $limit_per_page ), $limit_per_page

ie:

```
 $limit = ( $page - 1) * $limit_per_page
   $sql= "SELECT post, user, id, etc, whatever
         FROM table
         WHERE this = that
         ORDER BY foobarz ASC[/DESC]
         LIMIT ".$limit.",".$limit_per_page; 
```

I hope this explains it enough for you to build it! Good luck! Let me know if you need any more explaining!

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-07T19:16:40.583

您可以使用 LIMIT 关键字告诉 MySQL 要获取多少条记录，并指定起始偏移量

```
 SELECT * 
   FROM members 
   WHERE yyyy BETWEEN '$hage1' AND '$lage1' 
     AND gender='$gender' 
     AND religion LIKE '%$religion%'
     AND caste LIKE '%$caste%'     
     AND marital_status LIKE '%$marital_status%'
  LIMIT 0,100 
```

上面的 SQL 查询会返回前 100 条记录，从第一个开始

如果您想要接下来的 100 条（即从记录 #101 开始的 100 条记录），那么您可以使用`LIMIT 100, 100`; 然后为接下来的 100`LIMIT 200,100`等等..

当然，如果您希望通过 PHP 控制页码，您可以使用参数而不是硬编码值，如下所示：

```
 SELECT * 
   FROM members 
   WHERE yyyy BETWEEN '$hage1' AND '$lage1' 
     AND gender='$gender' 
     AND religion LIKE '%$religion%'
     AND caste LIKE '%$caste%'     
     AND marital_status LIKE '%$marital_status%'
  LIMIT '$offset', '$recordsPerPage' 
```

然后 $offset 应该以 $recordsPerPage 为增量（即 0、100、200、...n*100）和 $recordsPerPage 可以是您希望在每页上显示的任意数量的记录（通常为 10、20 或 100）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-07T19:21:44.727

如果客户端分页不成问题，一个简单的解决方案是使用 Jquery 分页。您可以在以下位置查看示例[http://www.datatables.net/release-datatables/examples/basic_init/alt_pagination.html](http://www.datatables.net/release-datatables/examples/basic_init/alt_pagination.html)

在您的 JavaScript 代码中添加：

```
$(document).ready(function() {
    $('#example').dataTable( {
        "sPaginationType": "full_numbers"
    } );
} ); 
```

如果您的元素，'example' 是 ID。

# git - 从远程 git 存储库获取时未显示合并的 Gerrit 更改

> ID：14759120
> 
> 赞同：1
> 
> 时间：2013-02-07T19:14:46.873
> 
> 标签：git, gerrit

我一直在测试 git/Gerrit 集成并设置了一个镜像远程存储库的测试存储库。当我在 GERRIT_SITE/git 目录中克隆存储库时，我执行了以下命令以确保它镜像了远程存储库：

`git clone --mirror REPO_URL`

我检查了裸存储库中的配置文件：

```
[core]
    repositoryformatversion = 0
    filemode = true
    bare = true
[remote "origin"]
    fetch = +refs/*:refs/*
    mirror = true
    url = ssh://git@myserver/testing.git 
```

我能够在 Gerrit 中合并更改，并且分支显示为“master”。但是，当我尝试从另一个工作站上的远程存储库的主分支中提取最新更改时，它会显示“已经是最新的”。是否必须进行任何其他配置以确保将 Gerrit 中的更改推送到远程存储库？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-07T21:05:29.977

Gerrit does not support working with an upstream master currently. Gerrit *is* the master. It supports replication, so that merged changes can be pushed to other servers for backup or mirroring purposes. However, if other changes are made to the remote repository, replication will fail.

# ios - 在 MKMapView 上动态（交互地）绘制动画

> ID：14759124
> 
> 赞同：2
> 
> 时间：2013-02-07T19:15:05.350
> 
> 标签：ios, mkmapview, quartz-core

我想在 MKMapView 上绘制动画。我希望它像一个指南针箭头，跟随（旋转）用户的点击/滑动。

所以箭头从屏幕中心出发，长度固定。我不需要线是特定于坐标的，但我需要保持地图交互完整（即仍然能够在地图上捏缩放）。

我试图通过 MKPolyline（创建然后销毁一条线）来做到这一点，但这不起作用（而且从我不得不这样做的方式来看，我觉得它不起作用）。我想知道处理这个问题的最佳方法是什么？石英？

我只接受一个解释（哪种视图覆盖什么，使用哪些类），不需要代码（但如果你有一个更好的工作示例））

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-09-27T18:45:26.377

我像地图尺一样绘制视图，而不是 MkMapView 的子视图。我将 kMapView 和我的标尺视图放入容器视图中。这适用于位置固定在屏幕上的视图，例如屏幕中心，并且与地理位置无关。

# mysql - 将 MySQL 结果限制在一周的前几天

> ID：14759126
> 
> 赞同：0
> 
> 时间：2013-02-07T19:15:15.890
> 
> 标签：mysql, sql, database

我有一张这样的桌子：

```
id | gallons_used | date
----------------------
1    2             157263300
2    5             157262000
... 
```

我想获得一个结果集，其中仅包含一周中 X 天（星期一或星期二或星期三等）发生的记录

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-07T19:16:35.687

[`DAYNAME()`](http://dev.mysql.com/doc/refman/5.1/en/date-and-time-functions.html#function_dayname)在您的`WHERE`条款中使用

```
WHERE DAYNAME(FROM_UNIXTIME(`date`)) = 'Monday'  <-- by day of the week
  AND `date` < INTERVAL CURRENT_DATE - 7 DAY     <-- within the last week 
```

您也可以使用[`DAYOFWEEK()`](http://dev.mysql.com/doc/refman/5.1/en/date-and-time-functions.html#function_dayofweek)，但这更具可读性。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-07T19:19:36.743

`date`考虑到您的列是时间戳，以周三检查为例：

```
DAYOFWEEK(date) = 4 
```

参考文档：[http ://dev.mysql.com/doc/refman/5.1/en/date-and-time-functions.html#function_dayofweek](http://dev.mysql.com/doc/refman/5.1/en/date-and-time-functions.html#function_dayofweek)

SQLFiddle：[http ://www.sqlfiddle.com/#!2/12762/3](http://www.sqlfiddle.com/#!2/12762/3)

我也有一个`FROM_UNIXTIME()`关于约会的电话，但我认为这不是必需的（不是 100% 肯定）。[http://dev.mysql.com/doc/refman/5.5/en/date-and-time-functions.html#function_from-unixtime](http://dev.mysql.com/doc/refman/5.5/en/date-and-time-functions.html#function_from-unixtime)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-07T19:45:43.870

由于您使用的是 Unix 时间戳，因此可以使用以下内容：

```
SELECT id, UNIX_TIMESTAMP(`date`)
FROM ...
WHERE DAYNAME(FROM_UNIXTIME(`date`)) = 'Monday'
  AND `date` > UNIX_TIMESTAMP() - 604800 
```

## [查看演示](http://sqlfiddle.com/#!2/7bfc2/3)

# python - 如何在金字塔中创建具有变量名的文件？

> ID：14759130
> 
> 赞同：0
> 
> 时间：2013-02-07T19:15:21.290
> 
> 标签：python, pyramid

```
@view_config(route_name='home_page', renderer='templates/edit.pt')
def home_page(request):
    if 'form.submitted' in request.params:
        name= request.params['name'] 
        body = request.params['body'] 
        renderer_dict = dict(name=name,body=body) 
        new_comment = render('new_page.pt', renderer_dict, request=request) 
        with open('tutorial:templates/{name}.html','w') as file:
            file.write(new_comment)  
        return HTTPFound(location=request.static_url('tutorial:pages/{pagename}.html',pagename=name)) 

    return {} 
```

现在，这是我的金字塔应用程序中的一个可调用视图，用于我的应用程序主页。我担心创建文件的行（打开...）。我希望文件的名称与上面代码中 request.params 定义的名称相同，但我不确定如何传递变量（我怀疑括号是正确的解决方案）。然后，我希望将 .html 添加到该名称以使其成为完整文件名。我不确定要使用什么语法来执行此操作

编辑：我还想就如何在返回 HTTPFound 行上正确执行此操作提出建议。我希望它重定向到那个新文件。现在我有 {pagename}.html 但怀疑这是否足够。我觉得解决方案与 with open 行相同，但如果我错了，请纠正我。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-07T20:25:22.570

首先，我认为你可能不应该做你想做的任何事情。

第二，打开文件...

```
 name = request.params['name'] 
    app_dir = SEE_BELOW
    filename =  "%(app_dir)s/templates/%(name)s" % { 'app_dir':app_dir , 'name':name }
    filename =  "%s/templates/%s" % ( app_dir , name )
    with open(filename,'w') as file:
        file.write(new_comment) 
```

我要注意几点：

1.  app_dir - 我忘记了如何获取实际的金字塔应用程序目录。我通常会被这些东西吓到，所以只使用特定的子目录，比如：

env.ini templates_writable_dir = %(这里)s/app/templates/writable/

然后我可以通过以下方式访问它：request.registry.settings['templates_writable_dir']

请注意，我创建了一个特定的可写子文件夹。我不希望主要内容可写。我将 chmod/grp 那个可写文件夹，以便用户金字塔可以编辑它运行。我不会允许该用户写入任何其他内容。

1.  `"tutorial:templates/{name}.html"`那是使用模板化的语法，它只适用于模板。您的一个金字塔插件将其`renderer_dict`注入模板并为您呈现。您需要使用普通的 python 字符串格式，如我上面使用两个选项所示。

更重要的是...

根据您的问题，您不仅是金字塔新手，也是 python 新手。我建议在进入 Pyramid 或任何其他框架之前先做一些快速的 Python 教程。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-07T20:44:17.643

我不认为标准开放理解教程：模板甚至 {name}

在使用 open 之前使用 request.static_path

# jakarta-mail - 使用 Java 阅读收件箱

> ID：14759132
> 
> 赞同：0
> 
> 时间：2013-02-07T19:15:23.120
> 
> 标签：jakarta-mail

我在一家公司实习，公司里的每个人都使用 Outlook 邮件。我想不出一种从收件箱中阅读电子邮件的方法。

让我谈谈我的项目。我正在为邮件使用 JavaMail API。

我的第一个任务 - 使用我已成功完成的提醒系统从 java 程序发送邮件，使用主机、协议、用户名和无密码。无需输入密码，因为如果我尝试输入密码，它就会停止工作。它只有在没有密码的情况下才能工作。

所以基本上，我可以使用公司中的其他员工使用电子邮件地址作为“发件人”发送电子邮件，因为不需要输入密码，只能从 java 程序中输入。

我的第二个任务 - 阅读邮件主题和发件人详细信息并执行一些任务...

没有密码可以进入，但是

```
Store store = session.getStore("smtp"); 
//I tried with imap, pop3, but everything gives error "No Such Provided"

store.connect("email@domain.co.uk", "PASSWORD"); 
```

store.connect() 不允许我使用没有密码的方法。

该软件将使用一个新的电子邮件地址，该地址与用户 Outlook 中的地址不同，但为了进行测试，我首先使用我的电子邮件地址，因为该软件将被不同的用户/计算机使用。

如果我尝试这种方式

```
session.getStore("imaps");
store.connect("host","username","password");

Error:
DEBUG: getProvider() returning 
javax.mail.Provider[STORE,imaps,com.sun.mail.imap.IMAPSSLStore,Sun Microsystems, Inc]

DEBUG: mail.imap.fetchsize: 16384
DEBUG: mail.imap.statuscachetimeout: 1000
DEBUG: mail.imap.appendbuffersize: -1
 DEBUG: mail.imap.minidletime: 10

DEBUG: trying to connect to host "host", port 993, isSSL true

javax.mail.MessagingException: Connection refused: connect;
 nested exception is:

java.net.ConnectException: Connection refused: connect
at com.sun.mail.imap.IMAPStore.protocolConnect(IMAPStore.java:618)
at javax.mail.Service.connect(Service.java:291)
at javax.mail.Service.connect(Service.java:172)

at TestMail.InboxReader.main(InboxReader.java:52)
    Caused by: java.net.ConnectException: Connection refused: connect
at java.net.PlainSocketImpl.socketConnect(Native Method)
at java.net.PlainSocketImpl.doConnect(PlainSocketImpl.java:351)
at java.net.PlainSocketImpl.connectToAddress(PlainSocketImpl.java:213)
at java.net.PlainSocketImpl.connect(PlainSocketImpl.java:200)
at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:366)
at java.net.Socket.connect(Socket.java:529)
at com.sun.net.ssl.internal.ssl.SSLSocketImpl.connect(SSLSocketImpl.java:570)
at 
    com.sun.net.ssl.internal.ssl.BaseSSLSocketImpl.connect(BaseSSLSocketImpl.java:141)
at com.sun.mail.util.SocketFetcher.createSocket(SocketFetcher.java:284)
at com.sun.mail.util.SocketFetcher.getSocket(SocketFetcher.java:227)
at com.sun.mail.iap.Protocol.<init>(Protocol.java:109)
at com.sun.mail.imap.protocol.IMAPProtocol.<init>(IMAPProtocol.java:104)
at com.sun.mail.imap.IMAPStore.protocolConnect(IMAPStore.java:585)
... 3 more
   Java Result: 2 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-08T19:11:45.157

使用 Exchange Web 服务 (EWS) API 与 Exchange Server 无缝集成。引用 MS 网站

> EWS 提供对通过 Microsoft Office Outlook 提供的大部分相同数据的访问。

EWS 基础 - [http://msdn.microsoft.com/en-us/library/exchange/dd877045(v=exchg.140).aspx](http://msdn.microsoft.com/en-us/library/exchange/dd877045(v=exchg.140).aspx) EWS Java API - [http://archive.msdn.microsoft.com/ewsjavaapi](http://archive.msdn.microsoft.com/ewsjavaapi)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-07T21:16:42.810

需要更多细节...

请参阅[JavaMail FAQ](http://www.oracle.com/technetwork/java/javamail/faq/index.html)并在失败时发布[调试输出。](http://www.oracle.com/technetwork/java/javamail/faq/index.html#debug)此外，您使用的确切代码可能会有所帮助。

您可以使用 JavaMail 附带的代码对其进行测试，这样您就可以确定问题出在您的代码中还是其他问题上。请参阅 JavaMail 下载包中包含的 msgshow.java 演示程序。

# javascript - 找出是什么使元素集中

> ID：14759133
> 
> 赞同：2
> 
> 时间：2013-02-07T19:15:29.743
> 
> 标签：javascript, jquery, html, ajax

有什么方法可以找出是什么使第一个 html 元素（输入、文本区域）获得焦点？

我正在加载一个模态窗口，但似乎找不到将 focus() 强制施加在第一个元素上的 JS 行。

一个解决方案是在加载模态窗口后立即对其进行 blur() ，但我想知道是什么触发了这个焦点。也许一些事件侦听器内嵌在文本区域中？

谢谢你的帮助！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-07T19:16:34.423

可以使用元素上的onFocus事件来分析返回的事件对象

```
//using jquery 1.8 style binding with 'on'
$('#myelement').on('focus', function( e ){
  console.log( e ); // <--- e is passed to the anonymous function
}); 
```

此`e`代码中的 是传递给事件处理程序的事件对象的一个​​实例。

查看[Event Object](http://api.jquery.com/category/events/event-object/)的 jQuery 文档，特别是查看[event.target 文档](http://api.jquery.com/event.target/)。

> 目标属性可以是为事件注册的元素或它的后代。

* * *

**注意：有多种方法可以将焦点设置在不包含任何 javascript 调用的元素上。**

例如在 html 5 中，您可以使用定义文档[的默认焦点](http://davidwalsh.name/autofocus)`autofocus`

[一些浏览器甚至可能将默认焦点设置](http://nemisj.com/focusable/)为文档上的第一个输入元素，或者使用许多其他 HTML 属性。

Javascript 可能不是您幻像焦点的原因。

# java - 为什么这个解组器会抛出 MalformedURLException？

> ID：14759137
> 
> 赞同：1
> 
> 时间：2013-02-07T19:15:48.993
> 
> 标签：java, jaxb, weblogic, spring-ws

*   Weblogic 11g (10.3.5)
*   Spring 框架 3.1.3
*   Spring Web 服务 2.1.1

在 Weblogic 上运行的 Spring-ws Web 服务。相同的 Web 服务在 Tomcat 和 Spring vFabric 中运行良好，但在 Weblogic 下抛出了这些神秘的异常。我的实现代码永远不会在 Weblogic 上到达，而是在解组过程中的某个时候请求处理会中断。我试图通过这个问题进行调试，但有两个因素使问题复杂化。首先，解组器来自 Weblogic，这意味着我没有来源。其次，主要异常来自 java.net.URL，Eclipse 调试器似乎无法检查局部变量值。

这是堆栈跟踪，其中包含跟踪级别的日志。

```
2013-02-07 13:45:24,523 [[ACTIVE] ExecuteThread: '18' for queue: 'weblogic.kernel.Default (self-tuning)' :: 127.0.0.1] TRACE  - Received request [<?xml version="1.0" encoding="UTF-8" standalone="yes"?><soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:ser="http://subdomain.example.com/services/">
   <soapenv:Header/>
   <soapenv:Body>
      <ser:SearchRequest>
         <ser:documentType>Email</ser:documentType>
         <ser:lineOfBusiness>TestLOB</ser:lineOfBusiness>
         <ser:businessKey>
            <ser:keyName>TestCode</ser:keyName>
            <ser:value>00000</ser:value>
         </ser:businessKey>
         <ser:dateCreated>
            <ser:startDate/>
            <ser:length/>
         </ser:dateCreated>
      </ser:SearchRequest>
   </soapenv:Body>
</soapenv:Envelope>]
2013-02-07 13:45:24,538 [[ACTIVE] ExecuteThread: '18' for queue: 'weblogic.kernel.Default (self-tuning)' :: 127.0.0.1] TRACE  - SOAPElement [weblogic.webservice.core.soap.SOAPBodyImpl] implements SAAJ 1.1
2013-02-07 13:45:24,554 [[ACTIVE] ExecuteThread: '18' for queue: 'weblogic.kernel.Default (self-tuning)' :: 127.0.0.1] DEBUG  - Looking up endpoint for [{http://ecm.cinfin.com/services/}SearchRequest]
2013-02-07 13:45:24,554 [[ACTIVE] ExecuteThread: '18' for queue: 'weblogic.kernel.Default (self-tuning)' :: 127.0.0.1] DEBUG  - Endpoint mapping [org.springframework.ws.server.endpoint.mapping.PayloadRootAnnotationMethodEndpointMapping@1587368] maps request to endpoint [public com.example.subdomain.services.model.SearchResponse com.example.subdomain.services.search.endpoint.SearchEndpoint.handleSearch(com.example.subdomain.services.model.SearchRequest)]
2013-02-07 13:45:24,570 [[ACTIVE] ExecuteThread: '18' for queue: 'weblogic.kernel.Default (self-tuning)' :: 127.0.0.1] TRACE  - SOAPElement [weblogic.webservice.core.soap.SOAPHeaderImpl] implements SAAJ 1.1
2013-02-07 13:45:24,570 [[ACTIVE] ExecuteThread: '18' for queue: 'weblogic.kernel.Default (self-tuning)' :: 127.0.0.1] DEBUG  - Testing endpoint adapter [org.springframework.ws.server.endpoint.adapter.DefaultMethodEndpointAdapter@f24611]
2013-02-07 13:45:24,570 [[ACTIVE] ExecuteThread: '18' for queue: 'weblogic.kernel.Default (self-tuning)' :: 127.0.0.1] TRACE  - Testing if argument resolver [org.springframework.ws.server.endpoint.adapter.method.MessageContextMethodArgumentResolver@1d60bb4] supports [class com.example.subdomain.services.model.SearchRequest]
2013-02-07 13:45:24,570 [[ACTIVE] ExecuteThread: '18' for queue: 'weblogic.kernel.Default (self-tuning)' :: 127.0.0.1] TRACE  - Testing if argument resolver [org.springframework.ws.server.endpoint.adapter.method.XPathParamMethodArgumentResolver@19a6ada] supports [class com.example.subdomain.services.model.SearchRequest]
2013-02-07 13:45:24,585 [[ACTIVE] ExecuteThread: '18' for queue: 'weblogic.kernel.Default (self-tuning)' :: 127.0.0.1] TRACE  - Testing if argument resolver [org.springframework.ws.soap.server.endpoint.adapter.method.SoapMethodArgumentResolver@1d06ba9] supports [class com.example.subdomain.services.model.SearchRequest]
2013-02-07 13:45:24,585 [[ACTIVE] ExecuteThread: '18' for queue: 'weblogic.kernel.Default (self-tuning)' :: 127.0.0.1] TRACE  - Testing if argument resolver [org.springframework.ws.server.endpoint.adapter.method.dom.DomPayloadMethodProcessor@4c61b3] supports [class com.example.subdomain.services.model.SearchRequest]
2013-02-07 13:45:24,585 [[ACTIVE] ExecuteThread: '18' for queue: 'weblogic.kernel.Default (self-tuning)' :: 127.0.0.1] TRACE  - Testing if argument resolver [org.springframework.ws.server.endpoint.adapter.method.SourcePayloadMethodProcessor@a2392e] supports [class com.example.subdomain.services.model.SearchRequest]
2013-02-07 13:45:24,585 [[ACTIVE] ExecuteThread: '18' for queue: 'weblogic.kernel.Default (self-tuning)' :: 127.0.0.1] TRACE  - Testing if argument resolver [org.springframework.ws.server.endpoint.adapter.method.jaxb.XmlRootElementPayloadMethodProcessor@580cc5] supports [class com.example.subdomain.services.model.SearchRequest]
2013-02-07 13:45:24,601 [[ACTIVE] ExecuteThread: '18' for queue: 'weblogic.kernel.Default (self-tuning)' :: 127.0.0.1] DEBUG  - Returning cached instance of singleton bean 'searchEndpoint'
2013-02-07 13:45:24,601 [[ACTIVE] ExecuteThread: '18' for queue: 'weblogic.kernel.Default (self-tuning)' :: 127.0.0.1] DEBUG  - Resolving exception from endpoint [public com.example.subdomain.services.model.SearchResponse com.example.subdomain.services.search.endpoint.SearchEndpoint.handleSearch(com.example.subdomain.services.model.SearchRequest)]: javax.xml.bind.UnmarshalException
 - with linked exception:
[java.net.MalformedURLException]
2013-02-07 13:45:24,601 [[ACTIVE] ExecuteThread: '18' for queue: 'weblogic.kernel.Default (self-tuning)' :: 127.0.0.1] DEBUG  - Returning cached instance of singleton bean 'searchEndpoint'
2013-02-07 13:45:24,601 [[ACTIVE] ExecuteThread: '18' for queue: 'weblogic.kernel.Default (self-tuning)' :: 127.0.0.1] DEBUG  - Resolving exception from endpoint [public com.example.subdomain.services.model.SearchResponse com.example.subdomain.services.search.endpoint.SearchEndpoint.handleSearch(com.example.subdomain.services.model.SearchRequest)]: javax.xml.bind.UnmarshalException
 - with linked exception:
[java.net.MalformedURLException]
2013-02-07 13:45:24,616 [[ACTIVE] ExecuteThread: '18' for queue: 'weblogic.kernel.Default (self-tuning)' :: 127.0.0.1] DEBUG  - Endpoint invocation resulted in exception - responding with Fault
javax.xml.bind.UnmarshalException: null
    at com.sun.xml.bind.v2.runtime.unmarshaller.UnmarshallerImpl.unmarshal0(UnmarshallerImpl.java:213) ~[glassfish.jaxb_1.0.0.0_2-1-12.jar:2.1.12]
    at com.sun.xml.bind.v2.runtime.unmarshaller.UnmarshallerImpl.unmarshal(UnmarshallerImpl.java:184) ~[glassfish.jaxb_1.0.0.0_2-1-12.jar:2.1.12]
    at javax.xml.bind.helpers.AbstractUnmarshallerImpl.unmarshal(AbstractUnmarshallerImpl.java:137) ~[na:1.6.0_24]
    at org.springframework.ws.server.endpoint.adapter.method.jaxb.AbstractJaxb2PayloadMethodProcessor$Jaxb2SourceCallback.saxSource(AbstractJaxb2PayloadMethodProcessor.java:239) ~[spring-ws-2.1.1.RELEASE-all.jar:2.1.1.RELEASE]
    at org.springframework.xml.transform.TraxUtils.doWithSource(TraxUtils.java:103) ~[spring-ws-2.1.1.RELEASE-all.jar:2.1.1.RELEASE]
    at org.springframework.ws.server.endpoint.adapter.method.jaxb.AbstractJaxb2PayloadMethodProcessor.unmarshalFromRequestPayload(AbstractJaxb2PayloadMethodProcessor.java:125) ~[spring-ws-2.1.1.RELEASE-all.jar:2.1.1.RELEASE]
    at org.springframework.ws.server.endpoint.adapter.method.jaxb.XmlRootElementPayloadMethodProcessor.resolveArgument(XmlRootElementPayloadMethodProcessor.java:49) ~[spring-ws-2.1.1.RELEASE-all.jar:2.1.1.RELEASE]
    at org.springframework.ws.server.endpoint.adapter.DefaultMethodEndpointAdapter.getMethodArguments(DefaultMethodEndpointAdapter.java:259) ~[spring-ws-2.1.1.RELEASE-all.jar:2.1.1.RELEASE]
    at org.springframework.ws.server.endpoint.adapter.DefaultMethodEndpointAdapter.invokeInternal(DefaultMethodEndpointAdapter.java:220) ~[spring-ws-2.1.1.RELEASE-all.jar:2.1.1.RELEASE]
    at org.springframework.ws.server.endpoint.adapter.AbstractMethodEndpointAdapter.invoke(AbstractMethodEndpointAdapter.java:53) ~[spring-ws-2.1.1.RELEASE-all.jar:2.1.1.RELEASE]
    at org.springframework.ws.server.MessageDispatcher.dispatch(MessageDispatcher.java:233) [spring-ws-2.1.1.RELEASE-all.jar:2.1.1.RELEASE]
    at org.springframework.ws.server.MessageDispatcher.receive(MessageDispatcher.java:173) [spring-ws-2.1.1.RELEASE-all.jar:2.1.1.RELEASE]
    at org.springframework.ws.transport.support.WebServiceMessageReceiverObjectSupport.handleConnection(WebServiceMessageReceiverObjectSupport.java:88) [spring-ws-2.1.1.RELEASE-all.jar:2.1.1.RELEASE]
    at org.springframework.ws.transport.http.WebServiceMessageReceiverHandlerAdapter.handle(WebServiceMessageReceiverHandlerAdapter.java:59) [spring-ws-2.1.1.RELEASE-all.jar:2.1.1.RELEASE]
    at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:923) [spring-webmvc-3.1.3.RELEASE.jar:3.1.3.RELEASE]
    at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:852) [spring-webmvc-3.1.3.RELEASE.jar:3.1.3.RELEASE]
    at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:882) [spring-webmvc-3.1.3.RELEASE.jar:3.1.3.RELEASE]
    at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:789) [spring-webmvc-3.1.3.RELEASE.jar:3.1.3.RELEASE]
    at javax.servlet.http.HttpServlet.service(HttpServlet.java:727) [javax.servlet_1.0.0.0_2-5.jar:2.5]
    at javax.servlet.http.HttpServlet.service(HttpServlet.java:820) [javax.servlet_1.0.0.0_2-5.jar:2.5]
    at weblogic.servlet.internal.StubSecurityHelper$ServletServiceAction.run(StubSecurityHelper.java:227) [weblogic.jar:10.3.5.0]
    at weblogic.servlet.internal.StubSecurityHelper.invokeServlet(StubSecurityHelper.java:125) [weblogic.jar:10.3.5.0]
    at weblogic.servlet.internal.ServletStubImpl.execute(ServletStubImpl.java:300) [weblogic.jar:10.3.5.0]
    at weblogic.servlet.internal.TailFilter.doFilter(TailFilter.java:26) [weblogic.jar:10.3.5.0]
    at weblogic.servlet.internal.FilterChainImpl.doFilter(FilterChainImpl.java:56) [weblogic.jar:10.3.5.0]
    at weblogic.servlet.internal.RequestEventsFilter.doFilter(RequestEventsFilter.java:27) [weblogic.jar:10.3.5.0]
    at weblogic.servlet.internal.FilterChainImpl.doFilter(FilterChainImpl.java:56) [weblogic.jar:10.3.5.0]
    at weblogic.servlet.internal.WebAppServletContext$ServletInvocationAction.wrapRun(WebAppServletContext.java:3715) [weblogic.jar:10.3.5.0]
    at weblogic.servlet.internal.WebAppServletContext$ServletInvocationAction.run(WebAppServletContext.java:3681) [weblogic.jar:10.3.5.0]
    at weblogic.security.acl.internal.AuthenticatedSubject.doAs(AuthenticatedSubject.java:321) [com.bea.core.weblogic.security.identity_1.1.2.1.jar:1.1.2.1]
    at weblogic.security.service.SecurityManager.runAs(SecurityManager.java:120) [com.bea.core.weblogic.security.wls_1.0.0.0_6-1-0-0.jar:6.1.0.0]
    at weblogic.servlet.internal.WebAppServletContext.securedExecute(WebAppServletContext.java:2277) [weblogic.jar:10.3.5.0]
    at weblogic.servlet.internal.WebAppServletContext.execute(WebAppServletContext.java:2183) [weblogic.jar:10.3.5.0]
    at weblogic.servlet.internal.ServletRequestImpl.run(ServletRequestImpl.java:1454) [weblogic.jar:10.3.5.0]
    at weblogic.work.ExecuteThread.execute(ExecuteThread.java:209) [com.bea.core.weblogic.workmanager_1.10.0.0.jar:1.10.0.0]
    at weblogic.work.ExecuteThread.run(ExecuteThread.java:178) [com.bea.core.weblogic.workmanager_1.10.0.0.jar:1.10.0.0]
Caused by: java.net.MalformedURLException: null
    at java.net.URL.<init>(URL.java:601) ~[na:1.6.0_24]
    at java.net.URL.<init>(URL.java:464) ~[na:1.6.0_24]
    at java.net.URL.<init>(URL.java:413) ~[na:1.6.0_24]
    at com.sun.org.apache.xerces.internal.impl.XMLEntityManager.setupCurrentEntity(XMLEntityManager.java:650) ~[na:1.6.0_24]
    at com.sun.org.apache.xerces.internal.impl.XMLVersionDetector.determineDocVersion(XMLVersionDetector.java:186) ~[na:1.6.0_24]
    at com.sun.org.apache.xerces.internal.parsers.XML11Configuration.parse(XML11Configuration.java:772) ~[na:1.6.0_24]
    at com.sun.org.apache.xerces.internal.parsers.XML11Configuration.parse(XML11Configuration.java:737) ~[na:1.6.0_24]
    at com.sun.org.apache.xerces.internal.parsers.XMLParser.parse(XMLParser.java:119) ~[na:1.6.0_24]
    at com.sun.org.apache.xerces.internal.parsers.AbstractSAXParser.parse(AbstractSAXParser.java:1205) ~[na:1.6.0_24]
    at com.sun.org.apache.xerces.internal.jaxp.SAXParserImpl$JAXPSAXParser.parse(SAXParserImpl.java:522) ~[na:1.6.0_24]
    at weblogic.xml.jaxp.WebLogicXMLReader.parse(WebLogicXMLReader.java:133) ~[weblogic.jar:10.3.5.0]
    at weblogic.xml.jaxp.RegistryXMLReader.parse(RegistryXMLReader.java:173) ~[weblogic.jar:10.3.5.0]
    at com.sun.xml.bind.v2.runtime.unmarshaller.UnmarshallerImpl.unmarshal0(UnmarshallerImpl.java:211) ~[glassfish.jaxb_1.0.0.0_2-1-12.jar:2.1.12]
    ... 35 common frames omitted 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-07T20:03:15.773

问题是 WLS 10.3.5 带有自己的 Spring 版本 2.5.6.SEC01。因此默认情况下，WLS 始终使用该版本，因为它是由更高的类加载器加载的。这可能会导致您看到 UnmarshalException。

您的 Spring 库是在 WebLogic 应用程序 APP-INF/lib 中还是您的 Web 应用程序 WEB-INF/lib 中？如果 spring 3.1.3 在应用程序级别，则需要使用以下条目创建 weblogic-application.xml

```
<?xml version="1.0" encoding="UTF-8"?>
<weblogic-application>
    <prefer-application-packages>
        <package-name>org.apache.*</package-name>
        <package-name>org.springframework.*</package-name>
    </prefer-application-packages>
</weblogic-application> 
```

如果是在 Web 应用程序级别，请将以下条目添加到 weblogic.xml

```
<prefer-web-inf-classes>true<prefer-web-inf-classes> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-07T20:03:08.083

显然，这种异常是从 WebLogic 部署中引发的，这些部署在安装目录路径或包含的库路径中都有一个空格。请检查您的路径。解决此问题的方法是在没有空格的路径上重新安装和/或将您的库移动到其中没有空格的路径。

[Oracle 网站上的相关论坛讨论。](https://forums.oracle.com/forums/thread.jspa?threadID=687629)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-18T13:11:18.993

我能够解决这个问题。类加载似乎确实是罪魁祸首，但它与捆绑的 Spring 或安装路径没有任何关系。相反，我为 Spring 的 SaajSoapMessageFactory 定义了一个显式消息工厂。工厂方法 on`javax.xml.soap.MessageFactory`似乎一直在抛出异常，但也被证明是完全没有必要的。我从配置中删除了这个 bean，一切都很好。

# php - 如何从头开始制作 asp.net 登录表单（使用现有的 sql 数据库）？

> ID：14759141
> 
> 赞同：0
> 
> 时间：2013-02-07T19:15:53.573
> 
> 标签：php, asp.net, sql-server, forms, login

我是 asp.net 的新手。我有使用 php 的经验，并且制作一个登录表单将登录数据与预定义数据库中的登录数据进行比较非常简单。问题是，现在我需要使用一个 MSSQL 数据库，其中存储了登录数据。我尝试将 php 与 mssql 一起使用，但结果非常复杂。谁能给我一些关于如何在asp.net中进行这项工作的教程，或者提出另一种解决方案？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-07T19:19:59.377

试试这个[教程](http://www.aspdotnet-suresh.com/2011/12/how-to-create-simple-login-form-using.html)。我希望这会给你一个想法。

# python - 将 urllib getcode 限制在特定时间，以避免冻结

> ID：14759142
> 
> 赞同：0
> 
> 时间：2013-02-07T19:15:55.860
> 
> 标签：python, web, urllib, freeze

我已经编写了一些代码，可以从 rss 提要中获取一些信息，而且效果很好。但是，我正在使用的提要似乎非常不可靠，并且经常出现故障。因此，我添加了一项功能来检查站点是否已启动，如果未启动，请稍等片刻再试一次。

我今天注意到它有冻结的趋势，我必须重新启动程序才能使其再次运行。

我的猜测是，从网站上获取“200”有问题。

在跳过之前，我如何设置尝试获取站点状态的“时间限制”？

我使用python 2.7

这是我的代码：

```
try:
urllib.urlopen(sites).getcode() == 200
# more code here
except:
t = FindSites(sites)
print 'Failed to connect to ' + t 
```

谢谢

编辑：谢谢。尝试代码，它现在应该可以工作了

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-07T19:25:12.280

您可以使用[urllib2.urlopen](http://docs.python.org/2/library/urllib2.html#urllib2.urlopen)，它支持超时：

> urllib2.urlopen(url[, 数据][, 超时])

# javascript - Javascript 解析网址

> ID：14759143
> 
> 赞同：-2
> 
> 时间：2013-02-07T19:15:55.180
> 
> 标签：javascript, jquery, parsing, url

我想用 Javascript/jQuery 解析 #!/ url 片段，比如...

```
http://www.mydomain.com/#!/home 
```

将加载

```
http://www.mydomain.com/home 
```

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-07T19:18:50.417

用空字符串替换您的模式

```
var url = "http://www.mydomain.com/#!/home";
url = url.replace("#!/","");
alert(url) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-07T19:19:49.360

```
if( location.hash.charAt(1) == "!") location.href = location.hash.substr(2); 
```

然而，这是一个重定向，这在某种程度上违背了`#!`最初的目的。

也就是说，替换`location.href`为局部变量，您可以使用它来进行 AJAX 调用，就像您使用该构造时应该做的那样。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-07T19:28:00.243

如果这是您的网址：

```
var url= "http://www.mydomain.com/#!/home" // window.location.href
var newUrl = url.substr(0, url.indexOf('#'))+url.substr(url.lastIndexOf('/')+1);
location.replace(newUrl); 
```

# prolog - 查找具有相同数量的所有谓词

> ID：14759153
> 
> 赞同：2
> 
> 时间：2013-02-07T19:16:31.257
> 
> 标签：prolog, iso-prolog

是否可以提出查询，例如

```
?- X(C). 
```

可以返回所有具有 arity 1 的谓词？一般来说，是否可以通过使用变量来引用谓词名称？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-07T19:38:14.257

`current_predicate(X/1).`显示元数为 1 的谓词。

您可以使用`call`从变量中调用目标。

# python - 用于从python中的html中提取所有常规文本的正则表达式

> ID：14759166
> 
> 赞同：0
> 
> 时间：2013-02-07T19:17:08.150
> 
> 标签：python, regex

如何从部分 html 文本中提取不是 html 标记的所有内容？

也就是说，如果我有以下类型：

```
<div>Hello</div><h3><div>world</div></h3> 
```

我想提取 ['Hello','world']

我想到了正则表达式：

```
>[a-zA-Z0-9]+< 
```

但它不会包含我需要的特殊字符和中文或希伯来文字符

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-07T19:19:04.543

你应该看看像[正则表达式这样的东西来从 HTML 中提取文本](https://stackoverflow.com/questions/181095/regular-expression-to-extract-text-from-html)

从那个帖子：

> 您无法真正使用正则表达式解析 HTML。这太复杂了。RE 不会处理将在浏览器中作为正确的文本工作，但可能会使天真的 RE 感到困惑。
> 
> 使用适当的 HTML 解析器，您会更快乐、更成功。Python 人经常使用 Beautiful Soup 来解析 HTML 并去除标签和脚本。
> 
> 此外，浏览器在设计上允许格式错误的 HTML。因此，您经常会发现自己试图解析显然不正确的 HTML，但在浏览器中却可以正常工作。
> 
> 您可能能够使用 RE 解析错误的 HTML。它所需要的只是耐心和努力工作。但是使用别人的解析器通常更简单。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-07T19:20:39.373

正如 Avi 已经指出的那样，这对于正则表达式来说太复杂了。使用`get_text`from[`BeautifulSoup`](http://www.crummy.com/software/BeautifulSoup/)或`clean_html`from[`nltk`](http://nltk.org/)从您的 html 中提取文本。

```
from bs4 import BeautifulSoup
clean_text = BeautifulSoup(html).get_text() 
```

或者

```
import nltk
clean_text = nltk.clean_html(html) 
```

多亏了 GuillaumeA，另一个选择是使用[pyquery](http://packages.python.org/pyquery/)：

```
from pyquery import PyQuery
clean_text = PyQuery(html) 
```

必须说，如果 html 格式不正确，上述 html 解析器会以不同程度的成功完成这项工作，因此您应该进行试验，看看哪种方法最适合您的输入数据。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-02-07T19:23:52.597

我对 Python 不熟悉，但是下面的正则表达式可以帮助你。

```
<\s*(\w+)[^/>]*> 
```

在哪里，

```
<: starting character

\s*: it may have whitespaces before tag name (ugly but possible).

(\w+): tags can contain letters and numbers (h1). Well, \w also matches '_', but it does not hurt I guess. If curious use ([a-zA-Z0-9]+) instead.

[^/>]*: anything except > and / until closing >

\>: closing > 
```

# excel - 在 Excel 中拆分地址字段

> ID：14759174
> 
> 赞同：1
> 
> 时间：2013-02-07T19:17:33.157
> 
> 标签：excel, excel-2007, excel-formula, vba

我有一个带有地址的单元格的 excel 文件。

3个不同的数据示例：

```
 123 Main Street/n Apartment2 /n New York, NY 10001
 123 Main Street/n New York, NY 10001
 123 Main Street 
```

我想把它分成三个单独的字段。但是，如上述数据所示，有些 /n 出现 0 次，有些出现 2 次。有些会出现3次。

我可以处理一个事件： =LEFT(E6, SEARCH(" /n",E6,1)-2) =RIGHT(Export!E6,LEN(Export!E6)- SEARCH("/n",Export! E6,1)-1)

但是，当 /n 的数量不定时，我的公式开始崩溃

有什么建议么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-07T20:18:43.737

值得回答的解决方案：

将“/n”替换为不在您的数据中的任何单个字符，例如`@#$^~`- 并使用`Text to Columns`.

全部替换可通过按`CTRL`+进行`H`。

如果您不确定该字符是否在您的数据中，请在替换前通过搜索进行检查。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-07T20:20:41.083

这是使用 VBA 的另一种方法

```
Option Explicit

Sub Sample()
    Dim MyArray() As String
    Dim ws As Worksheet
    Dim lRow As Long, i As Long, j As Long, c As Long

    '~~> Change this to the relevant sheet name
    Set ws = ThisWorkbook.Sheets("Sheet1")

    With ws
        lRow = .Range("A" & .Rows.Count).End(xlUp).Row

        For i = 1 To lRow
            If InStr(1, .Range("A" & i).Value, "/n", vbTextCompare) Then
                MyArray = Split(.Range("A" & i).Value, "/n")
                c = 1
                For j = 0 To UBound(MyArray)
                    .Cells(i, c).Value = MyArray(j)
                    c = c + 1
                Next j
            End If
        Next i
    End With
End Sub 
```

**屏幕截图（之前）**

![在此处输入图像描述](../Images/62cd288772124e122404e904014afbdd.png)

**屏幕截图（之后）**

![在此处输入图像描述](../Images/c1ca9cc84200c0e149642bcaddac188a.png)

# python - 为什么嵌套函数比非嵌套版本慢得多？

> ID：14759176
> 
> 赞同：1
> 
> 时间：2013-02-07T19:17:33.827
> 
> 标签：python, performance, testing

我试图在 fibonacci 中包含 memo dict，因为我正在尝试腌制函数。但是，在我的测试中，嵌套函数似乎要慢得多，但仅当我使用 memoized 函数时，我才在其他版本的斐波那契中看不到这一点。

我所有的测试：[https ://gist.github.com/dasickis/4733353](https://gist.github.com/dasickis/4733353)

```
#!/usr/bin/env python

memo = {0: 0, 1: 1}

# Contract: [int > 0] -> [int > 0]
def fibonacci(n):
    """ Return the `x`th number in the fibonacci series. """
    if not n in memo:
        memo[n] = fibonacci(n - 1) + fibonacci(n - 2)
    return memo[n]

#--------------------------#

# Contract: [int > 0] -> [int > 0]
def fibonacci_nested(n):
    memo = {0: 0, 1: 1}

    def fib(n):
        """ Return the `x`th number in the fibonacci series. """
        if not n in memo:
            memo[n] = fib(n - 1) + fib(n - 2)
        return memo[n]

    return fib(n)

#--------------------------#

import timeit
stmt = "assert fib(20) == 6765"

print "fibonacci"
print timeit.timeit(stmt, setup="from __main__ import fibonacci as fib")
print 

print "fibonacci_nested"
print timeit.timeit(stmt, setup="from __main__ import fibonacci_nested as fib") 
```

输出：

```
fibonacci
0.263559103012

fibonacci_nested
11.4014730453 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-02-07T19:20:55.520

您不会`memo`在运行之间清理字典，从而在不嵌套不公平优势的情况下提供版本。第一次`timeit`运行`fib`它将填充`memo`字典，然后后续运行重新使用它。

`memo`嵌套函数每次都设置一个新的、空的。

# css - 线高的 LESS Mixin

> ID：14759177
> 
> 赞同：1
> 
> 时间：2013-02-07T19:17:49.803
> 
> 标签：css, less

我正在使用这个 mixin 来生成具有后备像素大小的 rem 字体大小，但也会生成一个 1.5 倍于字体大小的行高。

```
.font(@size: 16px, @line: @size) {
@remfont: (@size / 10);
@remline: (@size / 10) * 1.5;
font-size: @size * 1px;
font-size: ~"@{remfont}rem";
line-height: @size * 1.5px;
line-height: ~"@{remline}rem";
} 
```

不利的是，这需要我为我的行高输入一个值，尽管一旦编译就不需要它。我使用这个 mixin 的 LESS 是这样的：

```
.font (13, 10); 
```

并导致此输出：

```
font-size: 13px;
font-size: 1.3rem;
line-height: 19.5px;
line-height: 1.9500000000000002rem; 
```

有没有办法重新设计这个mixin，这样它就可以输出一个1.5倍我字体大小的行高，而不需要输入一个值？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-07T20:05:39.847

找到了解决方案。目前看来，使用 @string 值不需要比单数更多的值。混音：

```
.font(@string) {
@remfont: (@string / 10);
@remline: (@string / 10) * 1.5;
font-size: @string * 1px;
font-size: ~"@{remfont}em";
line-height: @string * 1.5px;
line-height: ~"@{remline}em";
} 
```

样式表用法：

```
.font (14); 
```

输出：

```
font-size: 14px;
font-size: 1.4em;
line-height: 21px;
line-height: 2.0999999999999996em; 
```

# android - Android - 如何在活动之间保持 UI 元素静态？

> ID：14759181
> 
> 赞同：0
> 
> 时间：2013-02-07T19:18:01.083
> 
> 标签：android, android-intent

我有一个带有按钮的导航栏，我想在多个活动之间共享：

![在此处输入图像描述](../Images/c6ebd4dbf9f47eddca95e71965a0d2a5.png)

目前，当我开始相同的活动（例如，单击 LOST.DIR）时，整个屏幕都会发生变化，包括导航栏（出现新的文件夹列表）。

我想保持导航栏静态（在相同的活动类型之间保持不变，并且在开始新活动后不改变或重新出现）。

这可能吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-07T19:21:30.223

听起来您想使用一个活动和[片段](http://developer.android.com/guide/components/fragments.html)。

但是，如果你真的必须使用多个活动。另一种方法是使用操作栏（[actionbarsherlock](http://actionbarsherlock.com/)对此非常有用）并在不同活动之间切换菜单。下拉菜单可以是操作栏上的图标列表，也可以是位于操作栏右上角的下拉微调器。此操作栏在您的活动中将是静态的，并且包含相同的类别列表（即您的导航栏的类别）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-07T19:21:05.333

不是马上。活动与您想要的完全相反：它们是独立的界面片段。

您可以使用`Fragments`或将您的活动嵌入到主活动中。`TabHost`例如，这样做。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-07T21:14:21.380

完全控制的一种方法是编写您自己的自定义类，该类将 LinearLayout 作为构造函数参数并处理每个按钮的可见性、单击调度（通过委托）、图像等。

添加方法来完成上述所有操作以及您需要的任何其他功能。

在每个 Activity 布局中创建一个 layout.xml 和它。

在每个 Activity 中实例化您的按钮栏类，并将对您在内容视图上使用 findViewById 获得的布局的引用传递给它。

正如其他人所说，有现有的解决方案，您可能会问“为什么要发明一个新轮子”。我在我的许多项目中都使用了这样一个类，并且做第一个版本需要做很多工作，但现在我有一个可以完全控制、添加、修复和自定义的类。

像这样的东西：

```
bar.setButtonClickHandler(Button.Favourites, favouritesButtonClickHandler);
bar.setButtonVisibility(Button.Edit, View.INVISIBLE); 
```

ETC

我使用了 LinearLayout，但如果我需要使用其他东西，那么重载构造函数以接受（例如，RelativeLayout 参数）是一件简单的事情。

# java - 当 setResizable 为 false (JavaFX) 时，AnchorPane 显示白色边框

> ID：14759182
> 
> 赞同：0
> 
> 时间：2013-02-07T19:18:03.203
> 
> 标签：java, javafx-2, javafx

我的问题是，当我使用 setResizable(false) 时，我的场景中会显示一个白色边框。当我不将其设置为 false 时工作正常，但我需要将其设置为 false。

代码：

```
 Scene scene = new Scene(new StackPane());  

        LoginManager loginManager = new LoginManager(scene);
        loginManager.showLoginScreen();
        primaryStage.setResizable(false);
        primaryStage.setScene(scene);
        primaryStage.show(); 
```

我的 ImageView 在我的 AnchorPane 内

```
<AnchorPane id="AnchorPane" maxHeight="-Infinity" maxWidth="-Infinity" minHeight="-Infinity" minWidth="-Infinity" prefHeight="600.0" prefWidth="900.0" xmlns:fx="http://javafx.com/fxml" fx:controller="br.com.facilit.target.app.desktop.view.MainViewController">
  <children>
    <ImageView id="background" fitHeight="600.0" fitWidth="900.0" pickOnBounds="true">
      <image>
        <Image url="@../images/background.jpg" preserveRatio="true" smooth="true" />
      </image> 
```

![在此处输入图像描述](../Images/c06f64975dff48fc868a2868aa26e8ae.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-25T12:33:49.403

在尝试了太多东西之后，我发现了如何解决它。

我不知道为什么，但是当您将 resible 设置为 false 时，屏幕会自动在下方和右侧获得额外的空间。要修复它，您应该将图像背景设置为大于屏幕宽度和高度，例如，如果您在锚窗格中使用 900x600，则应将图像设置为 920x620。

还有一次，我不知道为什么会这样，但这是我发现使用 css 修复它的唯一方法。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-07-15T10:10:18.390

我有同样的问题，我是这样解决的：

```
primaryStage.setScene(scene);

primaryStage.setWidth(900);
primaryStage.setHeight(600);
primaryStage.setResizable(false);

primaryStage.show(); 
```

您必须在设置 resizable 属性*之前*设置场景并手动设置宽度/高度。这解决了我的问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-11T00:32:48.223

1.  将 maxSize() 和 minSize 设置为图像的大小：

    ```
    Scene scene = new Scene(new StackPane());  

    private final static double IMG_WIDTH = 900d;
    private final static double IMG_HEIGHT = 600d;

    LoginManager loginManager = new LoginManager(scene);
    loginManager.showLoginScreen();

    primaryStage.setResizable(false);
    primaryStage.setMaxWidth(IMG_WIDTH);
    primaryStage.setMaxHeight(IMG_HEIGHT);
    primaryStage.setMinWidth(IMG_WIDTH);
    primaryStage.setMinHeight(IMG_HEIGHT);

    primaryStage.setScene(scene);
    primaryStage.show(); 
    ```

2.  检查图像的大小，如果它真的是 900x600。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2020-11-22T02:01:46.137

使用这个解决方案，但它只适用于 jdk8

```
 Stage.sizeToScene(); 
```

# python - python flask before_request 排除/静态目录

> ID：14759186
> 
> 赞同：15
> 
> 时间：2013-02-07T19:18:11.947
> 
> 标签：python, flask, mod-wsgi

感谢下面的答案，如果用户尚未登录，我有一个`before_request`功能可以将用户重定向到：`/login`

[请求前烧瓶 - 为特定路线添加例外](https://stackoverflow.com/questions/14367991/flask-before-request-add-exception-for-specific-route)

这是我的 before_request 的副本：

```
@app.before_request
def before_request():
    if 'logged_in' not in session and request.endpoint != 'login':
        return redirect(url_for('login')) 
```

但是，除非用户登录，否则不会提供我的静态目录中的文件。

在我的`/login`页面上，我正在从`/static`目录中获取一个 css 文件，但因此无法加载它`before_request`。

我已经使用 apache mod_wsgi 部署了这个应用程序，并且在我的 apache 配置文件中，我什至将该`/static`目录包含为站点的 DocumentRoot。

如何在`/static`没有用户登录的情况下添加一个异常来为我的应用程序文件提供服务，但仍将其`before_request`用于我的烧瓶应用程序定义的路由？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-02-08T01:40:28.517

您需要向您的 Apache 配置文件（或 .htaccess 文件，如果您无权访问这些文件）添加一个[`Alias`](http://httpd.apache.org/docs/2.2/mod/mod_alias.html#alias)或指令，以确保*Apache*为您的静态文件而不是 Flask 提供服务。确保您提供了一个允许[Apache Web 服务器访问您的静态路径](http://httpd.apache.org/docs/2.2/mod/mod_alias.html#alias)。（另外，如果您正在编辑文件，请不要忘记重新启动 Apache，以便您的更改将被拾取）。[`AliasMatch`](http://httpd.apache.org/docs/2.2/mod/mod_alias.html#aliasmatch)`.conf`*[`Directory`](http://httpd.apache.org/docs/2.2/mod/core.html#directory)`.conf`*

 *作为一种临时的权宜之计（或使其易于在开发中使用），您还可以检查以确保字符串`/static/`不在[`request.path`](http://flask.pocoo.org/docs/api/#flask.Request.path)：

```
if 'logged_in' not in session \
    and request.endpoint != 'login' \
    and '/static/' not in request.path: 
```

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2015-02-10T09:33:17.983

我认为有一个比检查更清洁的解决方案`request.path`。

```
if 'logged_in' not in session and request.endpoint not in ('login', 'static'):
    return redirect(url_for('login')) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-07-25T16:39:04.077

我确实同意 Apache 的方法，但为了快速修复，我在 before_request() 函数的开头使用了以下逻辑：

```
if flask.request.script_root == "/static":
  return 
```*

# mysql - SELECT * 比选择特定列有效吗？

> ID：14759188
> 
> 赞同：1
> 
> 时间：2013-02-07T19:18:26.550
> 
> 标签：mysql

我遇到了一种情况，我想选择表格的几乎所有列，除了少数。那么哪个更好用：SELECT * 或选择特定的列？任何人都可以简要介绍一下空间和时间效率。

# mysql - 需要帮助找出 mysql 查询的语法吗？

> ID：14759190
> 
> 赞同：0
> 
> 时间：2013-02-07T19:18:39.987
> 
> 标签：mysql

基本上，我需要一个看起来像这样的查询......

```
SELECT column FROM tablename WHERE column LIKE '%images/uploads%'; 
```

这里唯一的问题是，我只想要一个返回，上传后的任何内容都可以，只要它不是正斜杠`/`

所以，`images/uploads/somethingelse`这不是我要找的

`images/uploadssomethingelse` 是我正在寻找的。

有任何想法吗？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-07T19:21:21.593

这会帮助你

```
SELECT column FROM tablename WHERE column LIKE '%images/uploads%' AND column NOT LIKE '%images/uploads/%';` 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-07T19:21:25.770

```
SELECT column 
FROM tablename 
WHERE 
    column LIKE '%images/uploads%' 
and column not like '%images/uploads%/%'; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-07T19:26:43.027

```
SELECT column FROM tablename WHERE column REGEXP 'images/uploads[^/]*$'; 
```

# c# - 对接口的循环依赖

> ID：14759192
> 
> 赞同：0
> 
> 时间：2013-02-07T19:18:40.723
> 
> 标签：c#, .net, interface

我正在重构和构建 Win8 应用解决方案。我一直在将我的关键组件分离到他们自己的项目中。我有：

*   使用 MVVMLight（以及 SimpleIOC）的主要 Win8 项目
*   一个包含我所有可序列化模型类的模型项目
*   具有用于导航和序列化的各种类的服务项目
*   我所有接口的合同项目
*   包含主应用程序使用的视图模型的视图模型项目。

到目前为止，我已经完成了一些工作，但是有一个案例我无法制定出最佳结构。在我的 ViewModels 项目中，我有一个数据映射器类。基本上它接受一个模型并吐出一个视图模型。我一直在尝试将其移至服务层并为其创建一个接口，但在接口中遇到了一个依赖关系以了解 ViewModel 类，因此目前基本上具有循环依赖关系。

编辑：我应该解释一下 ViewModels 本身需要使用这个映射器。例如，我有一个包含 XAML 页面所需的所有内容的整体 PageViewModel。其中之一是 VehicleViewModels 列表，它是包含一些视图特定属性的车辆列表。因此，PageViewModel 将调用数据服务，获取 Vehicle 模型，然后使用映射器将其转换为 VehicleViewModel。

这里是界面。

```
namespace MyApp.Contracts
{
    public interface IDataMapperService
    {
        VehicleViewModel VehicleToVehicleViewModel(Vehicle v);
        TripViewModel TripToTripViewModel(Trip t);
    }
} 
```

如您所见，我想从这两种方法中返回一个 ViewModel 对象。但是 ViewModel 项目已经引用了这个 Contracts 项目，所以我目前不会构建。

我玩弄了为视图模型创建和接口的想法，但是我需要做很多工作来创建接口，我不确定这是最好的方法。我在这里忽略了一些明显的东西吗？

编辑：这是当前接口的实际实现：

```
 public VehicleViewModel VehicleToVehicleViewModel(Vehicle v)
    {
        var newVehicle = new VehicleViewModel(v.VehicleID, v.Make, v.Model, v.Petrol, v.Registration);

        foreach (Trip t in v.Trips)
        {
            newVehicle.Trips.Add(TripToTripViewModel(t));
        }

        IQueryable<Trip> trips = v.Trips.AsQueryable();

        var now = DateTime.Now.Date;

        var firstofmonth = new DateTime(now.Year, now.Month, 1);

        while (now.DayOfWeek != DayOfWeek.Monday) now = now.AddDays(-1);

        var weektrips = from t in trips
                        where t.Date >= now
                        select t;

        var monthtrips = from t in trips
                         where t.Date >= firstofmonth
                         select t;

        newVehicle.TripsThisWeek = weektrips.Count();
        newVehicle.MilesThisWeek = (int)Math.Round(weektrips.Sum(t => t.Mileage), 0);
        newVehicle.TripsThisMonth = monthtrips.Count();
        newVehicle.MilesThisMonth = (int)Math.Round(monthtrips.Sum(t => t.Mileage), 0);

        return newVehicle;
    }

    public TripViewModel TripToTripViewModel(Trip t)
    {
        var newTrip = new TripViewModel(t.TripID, t.Date, t.Mileage);
        return newTrip;
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-07T19:43:31.703

您可以使用泛型来创建映射器接口。

```
namespace MyApp.Contracts
{
    public interface IDataMapperService<ViewModelT, ModelT>
    {
        ViewModelT ModelToViewModel(ModelT v);
    }
} 
```

然后，您的服务可以返回 an`IDataMapperService<VehicleViewModel, Vehicle>`和 an `IDataMapperService<TripViewModel, Trip>`。您可以为视图模型和模型创建轻量级接口以与通用约束一起使用。

```
namespace MyApp.Contracts
{
    public interface IModel {}
    public interface IViewModel {}

    public interface IDataMapperService<ViewModelT, ModelT>
        where ViewModelT : IViewModel
        where ModelT : IModel
    {
        ViewModelT ModelToViewModel(ModelT v);
    }
} 
```

然后，为了实现您的新接口，您将创建一个映射器类。

```
public class DataMapperService : IDataMapperService<VehicleViewModel, Vehicle>
{
    public VehicleViewModel ModelToViewModel(Vehicle v)
    {
        //implementation goes here
    }
} 
```

显然，您需要在引用您的协定、模型和视图模型项目的项目中实现此类。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-07T19:33:09.790

如果我正确理解了这个问题，那么您正在尝试从一个对象映射到一个视图模型。如果是这种情况，编写自己的映射器工具对您的使用可能不是超级有效。查看[Automapper](http://automapper.codeplex.com/)它将允许您通过调用 Mapper.Map() 方法将一个对象映射到另一种类型。

在我看来，您似乎在思考您真正想要完成的事情。如果您需要 VehicleViewModel，则将车辆映射到 VehicleViewModel 并调用您的映射方法。Automapper 让这一切变得超级简单。但一般来说，您只需要一个中间映射器，它位于可以访问您的视图模型的任何层上，并为不同类型进行映射。

# batch-file - tcshrc 设置路径出错

> ID：14759199
> 
> 赞同：0
> 
> 时间：2013-02-07T19:19:01.410
> 
> 标签：batch-file, csh

我试图设置环境路径以在 ubuntu 下的家中运行这样的 pintos 命令

```
set path = ($path /home/pintos/src/utils) 
```

我输入终端命令尝试编译这个

```
:~$ source .tcshrc 
```

但它似乎得到这样的错误

```
 bash: .tcshrc: line 1: syntax error near unexpected token `('
 bash: .tcshrc: line 1: `set path = ($path /home/pintos/src/utils)' 
```

我不知道语法错误在哪里......

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-07T19:22:55.143

您`source`将您的脚本（对 完全有效`[t]csh`）放入正在运行的 shell 中，而这恰好是`bash`（而*不是* `tcsh`）。

如果您要使用`tcsh`，只需运行它（通过键入`tcsh`）并确保您`~/.tcshrc`具有所需的效果。（然后，也许，用于`chsh`更改您的登录外壳）。

如果您要使用，请使用、 in和/或 in`bash`设置路径。`PATH=$PATH:/home/pintos/src/utils``~/.bashrc``~/.bash_profile`

# oracle - 在 oracle 中连接时对字符串进行排序

> ID：14759211
> 
> 赞同：1
> 
> 时间：2013-02-07T19:19:40.193
> 
> 标签：oracle, oracle10g

我正在使用 collect 函数来连接 sql 查询的字符串。

```
 select id,
    tab_to_string(CAST(COLLECT(a.level||' '||d.Number||':  
    '||to_char(nvl(de.eventDate,SYSDATE - 365 * 100))) AS t_varchar2_tab)) AS MyVar
    from Mytable
    groupby id 
```

此查询的输出如下：

```
 Id    Myvar
    1     level : 27-Jan-09,level : 27-Mar-08, level : 2-Apr-10
    2     level : 7-Jun-06,level : 27-Dec-08, level : 2-Nov-08
    3     level : 27-July-10,level : 27-Mar-06, level : 2-Apr-10 
```

但我希望“Myvar”值按连接字符串中**的日期字段排序**

所以对于Id = 1，输出应该是

```
 level : 27-Mar-08, level : 27-Jan-09, level : 2-Apr-10 
```

下面是 tab_to_string 函数的代码

# 来源：[http ://www.oracle-base.com/articles/misc/string-aggregation-techniques.php#wm_concat](http://www.oracle-base.com/articles/misc/string-aggregation-techniques.php#wm_concat)

```
 CREATE OR REPLACE FUNCTION tab_to_string (p_varchar2_tab  IN  t_varchar2_tab,
                                      p_delimiter     IN  VARCHAR2 DEFAULT ',') 
    RETURN VARCHAR2 IS
    l_string     VARCHAR2(32767);
    BEGIN
    FOR i IN p_varchar2_tab.FIRST .. p_varchar2_tab.LAST LOOP
    IF i != p_varchar2_tab.FIRST THEN
    l_string := l_string || p_delimiter;
    END IF;
    l_string := l_string || p_varchar2_tab(i);
    END LOOP;
    RETURN l_string;
    END tab_to_string; 
```

我正在使用 Oracle 10g。

谢谢垃圾

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-07T23:22:03.760

要获得有序列表，有几种方法。最简单的是：

```
select id, str
  from (select id, 
               wm_concat('level : ' || to_char(nvl(eventDate,SYSDATE - 365 * 100))) 
                 over (partition by id order by eventdate) str,
               row_number() over (partition by id order by eventdate desc) rn
         from Mytable)
 where rn = 1; 
```

或者如果您使用的是“stragg”用户定义的聚合：

```
 select id, str
  from (select id, 
               string_agg('level : ' || to_char(nvl(eventDate,SYSDATE - 365 * 100))) 
                 over (partition by id order by eventdate) str,
               row_number() over (partition by id order by eventdate desc) rn
         from Mytable)
 where rn = 1; 
```

例如

```
SQL> select id, str
  2    from (select id,
  3                 string_agg('level : ' || to_char(nvl(eventDate,SYSDATE - 365 * 100)))
  4                   over (partition by id order by eventdate) str,
  5                 row_number() over (partition by id order by eventdate desc) rn
  6           from Mytable)
  7   where rn = 1;

        ID STR
---------- ----------------------------------------------------------------------
         1 level : 27-MAR-08,level : 27-JAN-09,level : 02-APR-10
         2 level : 07-JUN-06,level : 02-NOV-08,level : 27-DEC-08
         3 level : 27-MAR-06,level : 02-APR-10,level : 27-JUL-10 
```

# javascript - STOMP 上的重复事件 Socket.io 和 Node.js

> ID：14759218
> 
> 赞同：1
> 
> 时间：2013-02-07T19:20:19.013
> 
> 标签：javascript, node.js, websocket, socket.io, stomp

我需要一些关于我的 node.js+socket.io 实现的帮助。

该服务公开了一个通过 STOMP 协议连接到 ActiveMQ 代理的服务器，使用 stomp-js node.js 模块接收事件；然后使用 socket.io 通过 websockets 显示在 web 前端。

所以，在我开始使用 ActiveMQ 的过滤器功能之前，一切都很好，但这不是故障点，因为我和我的团队正在研究，我们找到了确保实现正常的方法，问题出在连接上：所以这里是事情是，我收到要订阅的过滤器，我成功订阅了，但是当我收到一组新的过滤器时，就会出现重复、三次和越来越多的消息，具体取决于我订阅-取消订阅的次数。

所以进行一些调试，我看不出有什么问题，但我几乎可以肯定这是回调或程序流程的一些糟糕的实现，我会附上我的代码来阅读你的评论。

非常感谢！

```
var sys = require('util');
var stomp = require('stomp');
var io = require('socket.io').listen(3000);

var socket = io.sockets.on('connection', function (socket) {

var stomp_args = {
    port: 61616,
    host: 'IP.ADDRESS',
    debug: true,
    };

var headers;
var client = new stomp.Stomp(stomp_args);
var setFilters = false; 

socket.on('filtros', function (message) {

    console.log('DEBUG: Getting filters');

    if(setFilters){
            client.unsubscribe(headers);
        }
    else{
            client.connect();
        }

    var selector = '';
    headers = '';

    for(var attributename in message){
        console.log(attributename+" : " + message[attributename]);
        if(message[attributename] != ''){
            selector += ' ' + attributename + '=\'' + message[attributename] + '\' AND ';
        }
    }

    selector = selector.substring(0, selector.length - 4)
    console.log('DEBUG: Selector String: ' + selector);

    headers = {
        destination: '/topic/virtualtopic',
        ack: 'client',
        selector: selector
    };

    if(setFilters)
        client.subscribe(headers);

    client.on('connected', function() {
        client.subscribe(headers);
        console.log('DEBUG: Client Connected');
        setFilters = true;
    });
});
var bufferMessage;
client.on('message', function(message) {
    console.log("Got message: " + message.headers['message-id']);
    var jsonMessage = JSON.parse(message.body);
    if(bufferMessage === jsonMessage){
        console.log('DEBUG: recibo un mensaje repetido');
        return 0;
        }
    else{
        console.log('DEBUG: Cool');
        socket.emit('eventoCajero', jsonMessage);
        }           
    client.ack(message.headers['message-id']);
    bufferMessage = jsonMessage;
});

socket.on('disconnect', function(){
        console.log('DEBUG: Client disconnected');
        if(setFilters){
            console.log('DEBUG: Consumer disconnected');
            client.disconnect();
            }
        });
client.on('error', function(error_frame) {
    console.log(error_frame.body);
}); 
```

});

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-11T16:50:24.223

查看 Socket.IO 文档，我发现这是一个已知问题（我认为是严重的已知问题），他们还没有修复它。因此，要纠正这个问题，必须重新连接到客户端的套接字以避免重复消息，使用：

```
socket.socket.reconnect(); 
```

明确强制重新连接的功能。

# sql - Oracle PL/SQL，如何使用简单的替换变量和months_between计算出生日期的年龄

> ID：14759219
> 
> 赞同：5
> 
> 时间：2013-02-07T19:20:21.090
> 
> 标签：sql, oracle, plsql

我正在研究一个简单的 PL/SQL 块，询问用户他们的出生日期并计算他们的年龄。我已经使用了months_between 除以12 转换，但是我在日期转换和用户输入的替换变量的日期方面遇到了问题。请忽略 v_birthday_year，因为这是我稍后必须集成的代码的另一部分。

我不确定用户必须输入的格式，即 05-07-1980 或 1978 年 3 月 6 日是否可以接受，以及如何根据输入的内容计算他们的年龄。

**我想要的程序是编写一个 PL/SQL 程序以这种格式 DD-MON-YYYY 接受用户的生日，并用 1 个小数位计算年龄。所以我也需要计算到小数点后一位。**

这是我所拥有的，但我不确定在替换变量输入处输入 DOB 的格式以及带一位小数的实际计算。我只是想看看我哪里出错了以及如何纠正它。

```
SET SERVEROUTPUT ON
DECLARE
  --v_birthday_year         NUMBER(4)    := &v_birthday_year;
  v_dob                   DATE      := &v_dob 
  v_your_age              NUMBER(3, 1);
BEGIN
  v_your_age := TRUNC(MONTHS_BETWEEN(SYSDATE, v_dob))/12;  
  DBMS_OUTPUT.PUT_LINE ('Your age is ' || v_your_age);
END;
/ 
```

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2013-02-07T19:37:03.927

您可以使用其中任何一种（纯 sql）

```
SELECT months_between(sysdate, user_birth_date) /12 FROM dual; 
```

或者

```
SELECT floor(months_between(sysdate, user_birth_date) /12) FROM  dual; 
```

或者

```
SELECT EXTRACT(YEAR FROM sysdate) - EXTRACT(YEAR FROM user_birth_date) FROM dual 
```

或者

```
SELECT (sysdate - user_birth_date) / 365.242199 FROM dual 
```

希望这会有所帮助

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2013-02-07T19:40:23.067

除非您正在学习有关 PL/SQL 的知识，否则我和其他人的所有 SQL 示例可能都更适合使用。这是我想出的：

```
 DECLARE
  v_dob        DATE:= to_date('&v_dob', 'MM/DD/YYYY'); -- copy this line and you'll be fine
  v_your_age   NUMBER(3, 1);
BEGIN
  v_your_age := TRUNC(MONTHS_BETWEEN(SYSDATE, v_dob))/12;  
  DBMS_OUTPUT.PUT_LINE ('Your age is ' || v_your_age);
END;
/

I passed 01/01/2010\. Got this in output: 

 Your age is 3.1 
```

另一个 SQL 示例：

```
SELECT empno, ename, hiredate
    , TRUNC(MONTHS_BETWEEN(sysdate, hiredate)/12) years_of_service  
 FROM scott.emp
/ 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-08-03T15:31:05.413

```
 Create or replace function getAge(birthday date) return number is
  v_your_age   NUMBER(3, 1);``
  BEGIN
  v_your_age := floor(MONTHS_BETWEEN(SYSDATE, birthday))/12;  
  return v_your_age;
  END;
   / 
```

然后你调用函数

```
BEGIN
DBMS_OUTPUT.PUT_LINE ('Your age is ' || getAge(to_date('10/10/2015','DD/MM/YYYY')));
end;
/ 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-11-11T06:29:11.307

```
select dob,sysdate,trunc(months_between(sysdate,dob)/12) as year,
   trunc(mod(months_between(sysdate,dob),12)) as month,
   trunc(sysdate - add_months(dob,((trunc(months_between(sysdate,dob)/12)*12) + trunc(mod(months_between(sysdate,dob),12))))) as day
   from emp; 
```

# sql - sql添加杂项字段

> ID：14759225
> 
> 赞同：1
> 
> 时间：2013-02-07T19:20:27.160
> 
> 标签：sql, sql-server-2008, tsql

我有一个要求，用户输入测试数据我有字段：

例子

```
 Blood   Pulse 
 ----    -----
 12      13 
```

需要添加另一个我们不知道测试内容的字段。我在考虑有一个名为 Misc1Label、Misc1Value 的字段

假设**Misc1Label**是 Oral 并且**Misc1Value**是 88

稍后我可以使用 Pivot 如果我们需要捕获 Misc1Label 的值并使用 Pivot 以便我可以拥有类似的东西

```
 Blood  Pulse  Oral
 -----  ----   ----
   12    13     88 
```

我在想是否有任何其他最佳实践来处理这个问题。

提前致谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-07T19:35:33.340

您真的需要将 Blood 和 Pulse 保留为单独的字段吗？您也可以将血液和脉搏视为不同的属性。听起来像这样的东西会起作用，并且无需使用 PIVOT 命令即可轻松查询。

```
PersonAttribute
    PersonId int (I'm only presuming here)
    AttributeId int

Attribute
    AttributeId int
    AttributeTypeId int
    AttibuteValue varchar(100)

AttributeType
    AttributeTypeId int
    AttributeType varchar(100) 
```

然后，您可以将 Blood、Pulse、Weight 等存储在 AttributeType 表中，并将 PersonAttribute 表用作主表的 1-N 方法。只是一个想法。

```
SELECT Distinct PA.PersonId
FROM PersonAttribute PA
   INNER JOIN Attribute A ON PA.AttributeId = A.AttributeId 
   INNER JOIN AttributeType AT ON A.AttributeTypeId = AT.AttributeTypeId 
WHERE AT.AttributeType = 'Blood' 
```

当然，如果需要，可以应用相同的模型，将 Blood and Pulse 留在主表中。

祝你好运。

# javascript - 搜索多个数据属性

> ID：14759234
> 
> 赞同：0
> 
> 时间：2013-02-07T19:20:51.970
> 
> 标签：javascript, jquery, regex, search, custom-data-attribute

我正在组合一个搜索功能，该功能可以搜索页面上许多 div 上的多个数据属性。下面是我为此工作的代码。我遇到的问题是，**除了**最后一个之外，它似乎只搜索每个数据属性的第一个单词。

```
var filter = $(this).val();
var regExPattern = "gi";
var regEx = new RegExp(filter, regExPattern);   
$(".box").each(function(){
   if (
      $(this).data('attr1').search(regEx) && 
      $(this).data('attr2').search(regEx) &&
      $(this).data('attr3').search(regEx) &&
      $(this).data('attr4').search(regEx) < 0
   )
   {
      //Do Something
   } 
   else 
   {
      //Do Something else
   }         
}); 
```

我整理了一个[在这里复制这个问题的小提琴。](http://jsfiddle.net/xNwbw/)

我尝试了不同的搜索组合......例如将所有数据属性放入一个数组中，然后逐个搜索元素，但这需要时间才能完成。

如果有人可以提供帮助，我将不胜感激？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-07T19:30:31.557

你的情况令人困惑。[`.search()`](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/String/search)返回匹配或的索引`-1`。因此，`0`仅当在字符串的开头找到正则表达式时，它才会产生一个假值 ( )，否则会产生一个真值。所以改成

```
 $(this).data('attr1').search(regEx) < 0 && 
  $(this).data('attr2').search(regEx) < 0 &&
  $(this).data('attr3').search(regEx) < 0 &&
  $(this).data('attr4').search(regEx) < 0 
```

或者，由于您不需要该位置，请切换到[`regEx.test()`](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/RegExp/test)

# javascript - 在一个函数中抑制可疑代码

> ID：14759239
> 
> 赞同：1
> 
> 时间：2013-02-07T19:21:01.300
> 
> 标签：javascript, google-closure-compiler

我在一个函数中收到了一些可疑的代码警告。我想抑制`suspiciousCode`该函数中类型的警告错误 - 而不是整个文件。

[谷歌关闭 wiki](https://code.google.com/p/closure-compiler/wiki/Warnings)告诉我使用 `@suppress {suspiciousCode}`，但这不起作用，并给了我另一个警告：`JSC_PARSE_ERROR: Parse error. unknown @suppress parameter: suspiciousCode`.

重要的代码行：

```
/**
 * This is a function where type checking is disabled.
 * @suppress {suspiciousCode}
 */
(function(a,b){ 
```

这可能与包装功能有关吗？

编辑：

这些是我想禁止的错误代码：

*   `JSC_SUSPICIOUS_SEMICOLON: If this if/for/while really shouldnt have a body, use {}`
*   `JSC_USELESS_CODE: Suspicious code. The result of the 'getprop' operator is not being used.`
*   `JSC_USELESS_CODE: Suspicious code. This code lacks side-effects. Is there a bug?`

我已经检查了警告，它们正是我想要的。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-07T22:21:57.797

我相信可疑代码是不可抑制的，因为它表明语法正确但是许多常见代码错误的根源的情况。例如，这里是关于与 NaN 比较的讨论：[https](https://code.google.com/p/closure-compiler/issues/detail?id=857) ://code.google.com/p/closure-compiler/issues/detail?id=857 。在您的情况下，编译器告诉您，如果您希望有一个带有空主体的 for 循环，请使用一组空`{}`来指示这一点，因为它更清晰且不太可能是无意的。

uselessCode 诊断组将抑制两个“JSC_USELESS_CODE”警告。通常，编译器假定 getprop 调用没有副作用，因此如果您不使用该值，它会发出警告。情况并非总是如此，因此它无法删除代码，而是向您发出有关该问题的警告。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-08T21:10:18.657

这是一个疏忽，它将在下一个版本中修复。您现在可以通过从源代码构建来获取它。以下是将其添加到可用于抑制的诊断组列表中的更改：

[https://code.google.com/p/closure-compiler/source/diff?spec=svn155a2e434bde40d325bbc92cdbe988ece4582e2c&r=155a2e434bde40d325bbc92cdbe988ece4582e2c&format=side&path=/src/com/google/javascript/jscomp/parsing/ParserConfig.proper](https://code.google.com/p/closure-compiler/source/diff?spec=svn155a2e434bde40d325bbc92cdbe988ece4582e2c&r=155a2e434bde40d325bbc92cdbe988ece4582e2c&format=side&path=/src/com/google/javascript/jscomp/parsing/ParserConfig.properties)

# perl - Perl DBI 连接和执行超时

> ID：14759240
> 
> 赞同：5
> 
> 时间：2013-02-07T19:21:03.087
> 
> 标签：perl, oracle11g, dbi

在工作中，我们有一个 DBA，他说他的 RAC 工作得很好，但事实并非如此。像 Toad 或 SQL Developer 这样的 SQL IDE 会随机断开它们的连接（我怀疑是因为 RAC 的网络设置不正确）。我想通过测试来证明我的理论。我猜一个 perl 脚本可以解决问题：

步骤 1\. ping 数据库的 IP

步骤 2\. 如果 IP 已启动，则尝试连接到数据库

步骤 3\. 如果已连接，则从双重连接中选择 sysdate 并关闭连接

步骤 4\. 等待一段时间，然后重新开始

我已经设法使用 DBI 在 Perl 中编写了这个，但我不知道如何使连接和查询执行超时。是否有一些解决方案可以让这些事情超时？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-08T09:34:59.403

`alarm()`您可以使用与 DBI 相关的信号来使用和来实现超时`$SIG{ALRM}`。

从cpan 和[cpan pod上的](http://search.cpan.org/%7Elbaxter/Sys-SigAction/dbd-oracle-timeout.POD)[DBI模块](http://search.cpan.org/dist/DBI/DBI.pm#Signal-Handling-and-Canceling-Operations)

> 暂停
> 
> 实现超时的传统方法是设置 $SIG{ALRM} 来引用将在 ALRM 信号到达时执行的一些代码，然后调用 alarm($seconds) 来安排在 $seconds 中传递 ALRM 信号未来。

> 例如：
> 
> 我的 $dbh = DBI->connect("DBI:SQLRelay:host=$hostname;port=$port;socket=", $user, $password) 或死 DBI->errstr;
> 
> 我的 $sth = $dbh->prepare($query) 或死 $dbh->errstr;
> 
> ```
>  eval {
>     local $SIG{ALRM} = sub { die "TIMEOUT\n" }; # \n is required
>     eval {
>          alarm($seconds);
>          if(! $sth->execute() ) { # execute query
>                 print "Error executing query!\n"
>          }
>     };
>     # outer eval catches alarm that might fire JUST before this alarm(0)
>     alarm(0);  # cancel alarm (if code ran fast)
>     die "$@" if $@;
>   };
>   if ( $@ eq "TIMEOUT\n" ) { ... }
>   elsif ($@) { ... } # some other error 
> ```
> 
> 第一个（外部）评估用于避免“要执行的代码”死掉并且警报在取消之前触发的不太可能但可能的机会。如果没有外部 eval，如果发生这种情况，如果您没有 ALRM 处理程序或将调用非本地警报处理程序，您的程序将死亡。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-07T19:54:56.463

它似乎取决于您连接到哪个数据库后端。例如，[DBD::mysql](https://metacpan.org/module/DBD%3a%3amysql#Class-Methods)确实记录了这样一个超时值：

> mysql_connect_timeout
> 
> ```
> If your DSN contains the option "mysql_connect_timeout=##", the connect request to the server will timeout if it has not been 
> ```
> 
> 在给定的秒数后成功。

但是，我没有看到为 Oracle 记录的相同内容。

[我确实在 DBI 文档](https://metacpan.org/module/DBI)中找到了关于使用信号处理进行此操作的讨论。

# c++ - 是否有用于多线程内存分配器的验证套件？

> ID：14759243
> 
> 赞同：3
> 
> 时间：2013-02-07T19:21:04.653
> 
> 标签：c++, multithreading, testing, memory-management

我将很快发布一个 C++ 并发框架，其中包括具有特殊优势的 64 位多线程内存分配服务。尽管它已经经过多年的测试和使用（Windows7），并且看似完美无瑕，但我真的希望得到独立来源的验证，让我的用户对使用这些服务有同样的信心。如果我真的很幸运和幸运，这样的测试将揭示更多的缺陷（解决）。显然，我们已经可以有效地测试这种材料被子了。但是我在这里要问的是一个公开认可的验证套件。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-07T20:54:56.917

[TCMalloc](http://goog-perftools.sourceforge.net/doc/tcmalloc.html)包含一个单元测试程序 t-test1.c 他们说

> 分叉多个线程并在每个线程中执行一系列分配和释放；除了通过内存分配器中的同步之外，线程不进行通信。

重点似乎是性能测试（每秒随机分配和释放的数量作为并发线程数量的函数）。

我认为`forks a number of threads`措辞不好，也许`creates a number of threads`会更好，否则可能会让人觉得他们正在分叉新进程，而整个目的是让多个线程在同一个虚拟地址空间中共享同一个堆。

# java - 自动显示键盘

> ID：14759253
> 
> 赞同：51
> 
> 时间：2013-02-07T19:21:24.347
> 
> 标签：java, android, keyboard, focus, android-activity

请解释一下有关软键盘的问题。例如，我在我的活动或对话片段或片段活动上有一个 EditText，无论如何。这里是：

```
<EditText
    android:id="@+id/edPswrd"
    android:layout_width="match_parent"
    android:layout_height="wrap_content"
    android:ems="10"
    android:inputType="textPassword" >

    <requestFocus />
</EditText> 
```

当它第一次显示时，我看不到软键盘，必须按 editText 才能获得焦点并出现键盘。另一个活动是不同的，当它出现在屏幕上时，键盘会在没有任何帮助的情况下加载。我以为

> < 请求焦点 />

意味着 EditText 将被聚焦并出现键盘，但我错了。

我应该如何管理哪些组件将获得焦点并且键盘将**自动**出现。

* * *

## 回答 #1

> 赞同：75
> 
> 时间：2013-02-07T19:37:37.193

我认为这是一个错误或一个功能，它试图将整个活动呈现给你，而不是一开始用软键盘遮住它。我已经搜索过一次有关此的信息，但不幸的是没有发现任何来自真正可靠的来源。

无论如何，要显示软键盘，您可以这样做：

```
EditText editText = (EditText)findViewById(R.id.edit_text_id);
InputMethodManager imm = (InputMethodManager)getSystemService(Context.INPUT_METHOD_SERVICE);
imm.showSoftInput(editText, InputMethodManager.SHOW_IMPLICIT); 
```

我还看到了这段代码，它应该在活动开始后强制软键盘变得可见，但从未尝试过：

```
InputMethodManager imm = (InputMethodManager)getSystemService(Context.INPUT_METHOD_SERVICE);
imm.toggleSoftInput(InputMethodManager.SHOW_FORCED, InputMethodManager.HIDE_IMPLICIT_ONLY); 
```

如果你想隐藏软键盘，你可以这样做：

```
InputMethodManager imm = (InputMethodManager)getSystemService(Context.INPUT_METHOD_SERVICE);
imm.hideSoftInputFromWindow(editText.getWindowToken(), 0); 
```

希望有帮助。

**编辑：**

对于`DialogFragment`这应该工作：在`onCreateView()`方法中这样做：

```
@Override
public View onCreateView(LayoutInflater inflater, ViewGroup container,
        Bundle savedInstanceState) {
    View view = inflater.inflate(R.layout.fragment_id, container);
    EditText editText = (EditText)view.findViewById(R.id.edit_text_id);

    // show soft keyboard
    editText.requestFocus();
    getDialog().getWindow().setSoftInputMode(LayoutParams.SOFT_INPUT_STATE_VISIBLE);

    return view;
} 
```

* * *

## 回答 #2

> 赞同：32
> 
> 时间：2013-02-07T19:33:42.500

打开 Android 清单文件。

寻找这样的活动标签

```
<activity  
        android:name="com.example.framework.MainActivity"
        android:label="@string/app_name" 
        android:windowSoftInputMode="stateVisible"       //Add this line    
         >
        <intent-filter>
            <action android:name="android.intent.action.MAIN" />

            <category android:name="android.intent.category.LAUNCHER" />
        </intent-filter>
    </activity> 
```

添加行 android:windowSoftInputMode="stateVisible" 如上所示

* * *

## 回答 #3

> 赞同：18
> 
> 时间：2015-04-28T15:33:31.570

我知道这已经得到了回答，但我找到了一种方法来做接受的答案，`onCreateDialog`而不是仅仅在`onCreateView`. 完成构建器后，在返回之前执行以下操作：

```
AlertDialog.Builder builder = new AlertDialog.Builder(getActivity());  
// blah blah blah do builder stuff here like setTitle, setView, etc

Dialog d = builder.create(); 
```

这是重要的部分：

```
d.getWindow().setSoftInputMode(WindowManager.LayoutParams.SOFT_INPUT_STATE_VISIBLE);
return d; 
```

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2013-02-07T19:32:31.943

添加到 onCreate 或 onStart();

```
myView.requestFocus();
getWindow().setSoftInputMode(WindowManager.LayoutParams.SOFT_INPUT_STATE_VISIBLE); 
```

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2014-05-12T12:53:28.370

试试这个

```
@Override
public void onResume() {
   super.onResume();
   final View v = getDialog().findViewById(R.id.edit_text_id);
   v.post(new Runnable() {
      @Override
      public void run() {
        v.requestFocus();
        InputMethodManager imm = (InputMethodManager) getActivity().getSystemService(Context.INPUT_METHOD_SERVICE);
        if (imm != null) imm.showSoftInput(v, InputMethodManager.SHOW_IMPLICIT);
      }
   });
 } 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2017-11-09T07:21:01.330

对我来说，像这样在清单中添加这一行**android:windowSoftInputMode="stateVisible"**

```
**<activity
            android:name=".mmmmm.zzzzzzz.yyyyyy.xxxxxx"
            android:windowSoftInputMode="stateVisible"
            android:label="@string/title_activity_print_recharge"></activity>** 
```

这就是我解决它的方法

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2016-09-23T10:32:58.487

这对我有用 -

创建您自己的 EditText 类并覆盖以下方法 -

```
public class FocussableEditText extends EditText {

    public FocussableEditText(Context context) {
        super(context);
    }

    public FocussableEditText(Context context, AttributeSet attrs) {
        super(context, attrs);
    }

    public FocussableEditText(Context context, AttributeSet attrs, int defStyle) {
        super(context, attrs, defStyle);
    }

    @Override
    public void onWindowFocusChanged(boolean hasWindowFocus) {
        super.onWindowFocusChanged(hasWindowFocus);
        if (hasWindowFocus) {
            InputMethodManager imm = (InputMethodManager)getContext().getSystemService(Context.INPUT_METHOD_SERVICE);
            imm.showSoftInput(this, InputMethodManager.SHOW_FORCED);
        }
    }
} 
```

[http://debuggingisfun.blogspot.in/2014/08/android-show-soft-keyboard.html](http://debuggingisfun.blogspot.in/2014/08/android-show-soft-keyboard.html)

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2017-01-11T13:23:53.577

我推荐以下链接，我按照链接下面提到的步骤进行操作，效果很好，答案非常好，只需非常简单的步骤即可完成。功劳归于回答者。希望它能帮助那些在对话活动中搞砸键盘弹出的人。

[DialogFragment 和强制显示键盘](https://stackoverflow.com/questions/17237952/dialogfragment-and-force-to-show-keyboard)

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2018-03-08T16:39:05.823

这就是我所做的，它工作得很好......

您可以使用

> 实用程序.showSoftKeyboard(...)

代码中的任何地方

```
public final class Utilities {

  // Shows the soft keyboard. V on which view (typically EditText) to focus the keyboard input
  public static void showSoftKeyboard(Activity activity, EditText editText) 
  {
      InputMethodManager imm = (InputMethodManager) activity.getSystemService(Context.INPUT_METHOD_SERVICE);
      imm.showSoftInput(editText, InputMethodManager.SHOW_FORCED);
  }
}

/**
 * Called when user clicks/touches the search button
 * @param v The clicked/touched view (EditText)
 */
protected void onSearchButtonClick(View v)
{
    EditText seekTopic = (EditText) findViewById(R.id.SeekTopicBox);
    setActivityContent(seekTopic.getText().toString());
} 
```

这

> onSearchButtonClick()

method belongs to the activity, which hold the EditView which I want to edit and therefore I need the soft keyboard..

HTH

# nhibernate - 具有两个自然键的多对多关系

> ID：14759257
> 
> 赞同：2
> 
> 时间：2013-02-07T19:21:32.087
> 
> 标签：nhibernate

我有以下映射

**用户配置文件.hbm.xml**

```
<?xml version="1.0" encoding="utf-8" ?>
<hibernate-mapping xmlns="urn:nhibernate-mapping-2.2"
                   assembly="AngusBook.Domain"
                   namespace="AngusBook.Domain">

  <class name="UserProfile">
    <id name="UserId" type="int">
      <generator class="identity" />
    </id>
    <natural-id mutable="false">
      <property name="UserName" />
    </natural-id>
    <set name="Companies" table="Users_Companies">
      <key column="UserId"/>
      <many-to-many column="CompanyId" class="Company" />
    </set>
  </class>

</hibernate-mapping> 
```

**公司.hbm.xml**

```
<?xml version="1.0" encoding="utf-8" ?>
<hibernate-mapping xmlns="urn:nhibernate-mapping-2.2" assembly="AngusBook.Domain" namespace="AngusBook.Domain" >

  <class name="Company">
    <id name="Id">
      <generator class="hilo" />
    </id>
    <natural-id mutable="false">
      <property name="CompanyName" />
    </natural-id>
    <set name="Users" table="Users_Companies">
      <key column="CompanyId"/>
      <many-to-many column="UserId" class="UserProfile" />
    </set>
  </class>

</hibernate-mapping> 
```

**餐桌设计** ![在此处输入图像描述](../Images/3b998e4bf17a4a66d2f78e126055748b.png)

有了这个映射，我可以在 Users_Companies 表中有两个相同的行（即：具有属于 UserProfile 和 Company 表的相同外键对的两行）。**使用映射，当尝试将一对外键插入表中已经存在的 Users_Companies 时，如何导致 NHibernate 或 SQL 引发错误/异常？**我希望 Users_Companies 中的每一行都是唯一的，并且没有重复的数据。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-07T19:35:34.047

我发现了问题。我没有正确实现 Equals() 和 GetHashCode()。

我最终重构了我的实体以使用以下基实体类并解决了这个问题。将重复的实体添加到集合时不会引发错误，但集合不会添加重复的实体。

**Entity.cs** 公共抽象类 Entity {

```
 public virtual TId Id { get; protected set; }
        protected virtual int Version { get; set; }

        public override bool Equals(object obj)
        {
            return Equals(obj as Entity<TId>);
        }

        private static bool IsTransient(Entity<TId> obj)
        {
            return obj != null &&
                   Equals(obj.Id, default(TId));
        }

        private Type GetUnproxiedType()
        {
            return GetType();
        }

        public virtual bool Equals(Entity<TId> other)
        {
            if (other == null)
                return false;

            if (ReferenceEquals(this, other))
                return true;

            if (!IsTransient(this) &&
                !IsTransient(other) &&
                Equals(Id, other.Id))
            {
                var otherType = other.GetUnproxiedType();
                var thisType = GetUnproxiedType();
                return thisType.IsAssignableFrom(otherType) ||
                       otherType.IsAssignableFrom(thisType);
            }

            return false;
        }

        public override int GetHashCode()
        {
            if (Equals(Id, default(TId)))
                return base.GetHashCode();
            return Id.GetHashCode();
        }

    }

    public abstract class Entity : Entity<Guid>
    {

    } 
```

**用户配置文件.cs**

```
 public class UserProfile : Entity<int>
    {
        public UserProfile()
        {
            Companies = new HashedSet<Company>();
        }

        public virtual string UserName { set; get; }
        public virtual ISet<Company> Companies { set; get; } 
    } 
```

**公司.cs**

```
public class Company : Entity<int>
    {
        public Company()
        {
            Users = new HashedSet<UserProfile>();
        }
        public Company(string name) :this()
        {
            this.CompanyName = name;
        }

        public virtual string CompanyName { set; get; }

        public virtual ISet<UserProfile> Users { set; get; }

      } 
```

# actionscript-3 - Starling onClick 方法

> ID：14759258
> 
> 赞同：1
> 
> 时间：2013-02-07T19:21:33.240
> 
> 标签：actionscript-3, flash, onclick, touch-event, starling-framework

我正在使用 starling 框架，来模拟 onclick 方法，我使用以下代码：

```
if(e.getTouch(this).phase == TouchPhase.ENDED){
            //Some code
} 
```

没关系，但是如果鼠标不再在按钮上方，它也会触发，但是我希望它仅在它结束时才调度。有什么办法可以做到这一点？谢谢

在代码中，“this”是一个 Sprite，这有点无关紧要

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-13T09:01:47.830

简单的方法是使用 starling.display.Button 来做到这一点。他们调度触发事件，这基本上是你想要的。“不太容易”的方法是通过复制 Button 中实际完成的操作来跟踪您的触摸：

```
 private function onTouch(event:TouchEvent):void
    {
        var touch:Touch = event.getTouch(this);
        if (!mEnabled || touch == null) return;

        if (touch.phase == TouchPhase.BEGAN && !mIsDown)
        {
            //equivalent to MOUSE_DOWN
            mIsDown = true;
        }
        else if (touch.phase == TouchPhase.MOVED && mIsDown)
        {
            // reset button when user dragged too far away after pushing
            var buttonRect:Rectangle = getBounds(stage);
            if (touch.globalX < buttonRect.x - MAX_DRAG_DIST ||
                touch.globalY < buttonRect.y - MAX_DRAG_DIST ||
                touch.globalX > buttonRect.x + buttonRect.width + MAX_DRAG_DIST ||
                touch.globalY > buttonRect.y + buttonRect.height + MAX_DRAG_DIST)
            {
                mIsDown = false;
            }
        }
        else if (touch.phase == TouchPhase.ENDED && mIsDown)
        {
            mIsDown = false;
            //this is a click
            dispatchEventWith(Event.TRIGGERED, true);
        }
    } 
```

您必须更改 buttonRect 代码以反映您的精灵的形状，但基本上就在这里。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-07T20:34:30.600

根据[文档，如果](http://doc.starling-framework.org/core/starling/events/TouchEvent.html#interactsWith%28%29)*当前*正在触摸目标，则该类的`interactsWith(target:DisplayObject)`方法应返回 true。我无法测试这个理论，但以下应该有效：`TouchEvent`

 *```
if (e.getTouch(this).phase == TouchPhase.ENDED && e.interactsWith(this)) {
    //The touch ended on the same DisplayObject as it originated at
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-07T20:44:31.923

这个想法怎么样：

```
if ( e.getTouch( this ).phase == TouchPhase.ENDED ) {
    if ( this.hitTestPoint( stage.mouseX, stage.mouseY, true ) ) {
        // Some code
    }
} 
```*

# php - 无法创建动态变量

> ID：14759263
> 
> 赞同：0
> 
> 时间：2013-02-07T19:21:54.760
> 
> 标签：php, session

当我检查我的 cookie 时，我确实看到 PHPSESSID 正在生成。但是当我尝试使用它们时，我收到一条错误消息，指出变量未定义。

这就是我设置会话的方式：

```
$posts = array("auto_year", "auto_brand", "auto_model", "auto_bodywork", "auto_doors", 
"auto_fuel", "auto_gearbox", "auto_type", "auto_uitvoering", "auto_part", "auto_description", "email_address");

//Define POSTS and set into SESSIONS
foreach ($posts as $post) {
   if (isset($_POST[$post])) {
      $_SESSION[$post] = $_POST[$post];
      $$post = $_SESSION[$post];
   }
} 
```

我也手动尝试过，例如：

```
$_SESSION['auto_year'] = '2012'; 
```

但它仍然不起作用。我确实在两者的页面上都调用了 session_start() ，但它一直给我这个错误。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-07T19:46:56.277

使用`${}`您可以创建动态变量。在您的情况下，只需更改为：

`${$post} = $_SESSION[$post];`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-07T19:34:35.920

来自您的表单的 $_POST 数据可能有问题。由于我没有表单信息，我通过设置 $_POST 尝试了这个。

```
session_start();

$_POST['auto_year'] = 1977;

$posts = array("auto_year", "auto_brand", "auto_model", "auto_bodywork", "auto_doors",
    "auto_fuel", "auto_gearbox", "auto_type", "auto_uitvoering", "auto_part", "auto_description", "email_address");

//Define POSTS and set into SESSIONS
foreach ($posts as $post) {
    echo $post."<br>";
    if (isset($_POST[$post])) {
echo "Creating variable for $post<br>";
        $_SESSION[$post] = $_POST[$post];
        $$post = $_SESSION[$post];
        echo '$auto_year: '.$auto_year . "<br>";
    }
}
echo "<br><br>".var_dump($_SESSION); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-07T20:04:28.053

另一种选择是使用 extract() 创建变量，这使您可以一次设置所有变量；

```
extract($_SESSION); 
```

将为会话中的每个键创建一个变量，例如 $auto_year、$auto_brand 等。

[http://php.net/manual/en/function.extract.php](http://php.net/manual/en/function.extract.php)

**注意** 我想知道为什么要将所有数据放在单独的变量中，而单个关联数组可能同样容易处理？

# python - 切片列表字典

> ID：14759277
> 
> 赞同：0
> 
> 时间：2013-02-07T19:22:44.160
> 
> 标签：python, list-comprehension

我有一个列表字典，每个列表大于 50 个项目，为了简化，假设字典键是 ['a','b','c']。我花了很长时间试图找出一个非常 Pythonic 的方法是对这些列表进行排序和切片。到目前为止我所拥有的：

```
dict = dictionary_of_lists under discussion
[dict[k].sort(reverse=True) for k in dict.keys()]
for k, l in dict.items():
    slice = 10 if k in ('a','c') else 20
    dict[k] = l[:slice] 
```

就像我想要的那样，我最终得到了一个经过排序和修剪的列表。但我想要的是一行代码，就像`[dict[k].sort(reverse=True) for k in dict.keys()]`我对排序列表进行切片时一样。如果有人能弄清楚如何将分类和切片放在一起，他们将是我的英雄。

更新：首先，我喜欢能够提出一些复杂的问题，因为它们可以帮助我学习更好的编码技能（因为我是自学的）。所以谢谢楼下的每一个人！我的新代码：

```
for c in list_of_categories:
    list = [getattr(p,c.name) for p in people if hasattr(p,c.name)]
    slice = c.get_slice_value # I added an @property function to a class named `Category`
    c.total = sum(sorted(list, reverse=True)[:slice]) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-07T19:30:46.420

具有副作用的列表推导通常被认为是不好的风格。而是创建一个新的字典：

```
dct = {k: sorted(l, reverse=True)[:10 if k in ('a','c') else 20] 
    for k, l in dct.items()} 
```

切片值目前看起来也是任意的，最好单独配置它们，例如：

```
slices = {
    'a': 10,
    'b': 10,
    'c': 20
}    

dct = {k: sorted(l, reverse=True)[:slices[k]] 
    for k, l in dct.items()} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-07T19:30:59.320

`sort()`工作到位，影响每个列表。你想创建新的：

```
[sorted(d[k], reverse = True)[:10 if k in ('a','c') else 20] for k in d.keys()] 
```

请注意，它的可读性不是很高。

# php - 使用 crypt() 进行更强的密码加密

> ID：14759282
> 
> 赞同：-2
> 
> 时间：2013-02-07T19:22:56.377
> 
> 标签：php, encryption, crypt

所以我对密码加密很感兴趣。我创建了以下脚本并希望获得一些反馈，以查看它是否是验证/保护密码的合法方式，或者它是否根本没有帮助。欢迎任何反馈：

```
$pass = "Test!234";
$salt = crypt($pass);
$enc_pass = crypt($pass . $salt);

if(crypt($pass . $salt, $enc_pass) == $enc_pass){
echo "Success!";
}
else{
echo "Fail!";
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-07T19:32:11.817

阅读[文档](http://php.net/crypt)。

我并不是要驳回您的问题，而是在这里回答问题只是对文档内容的重申。

您还应该使用[搜索功能](https://stackoverflow.com/search?q=%5Bphp%5D%20crypt)（右上角）。这里有很多关于`crypt()`函数的问题。

如果您对函数有更尖锐的问题，`crypt()`请继续。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-07T19:39:26.750

您的机制并未真正遵循使用 crypt 的最佳实践

PHP crypt 有一种特殊的生成盐的方式，也可以将自己置于不同的模式。您必须了解很多有关如何指定算法的细节，以确保您获得真正安全的算法。

更好的使用方法是[password_hash](http://www.php.net/manual/en/function.password-hash.php)，它可以更轻松地指定散列算法。确保使用`PASSWORD_BCRYPT`，高成本因素和随机生成的盐。

此外，无论您使用什么算法，都应该确保为每个用户使用唯一的随机盐。如果您使用密码作为盐，您将失去盐的价值（因为攻击者可以很容易地生成彩虹表或使用该方案非常容易地进行反向查找）。使用随机生成的足够长的盐（大于 128 位），攻击者无法轻易暴力破解您的密码哈希，并且每个密码哈希必须单独暴力破解，即使用户使用相同的密码。

# java - 将行添加到 JTable 和文件

> ID：14759286
> 
> 赞同：1
> 
> 时间：2013-02-07T19:23:13.093
> 
> 标签：java, swing, jtable, abstracttablemodel

我也使用此方法向我的 jtable 和文件添加新行。

但是当我单击添加按钮时，该新记录已添加到 jtable 中，但是当我看到文本文件时，我发现如下内容：

myproject.Library.BookInformation@9899472

我的错误在哪里？

我的代码：

```
public class MainS extends JFrame{

   final AllBooks allBooks=new AllBooks();
   final JTable Btable=new JTable(allBooks);

   public MainS(){
       JButton AddBookButton=new JButton("Add New Book");
       AddBookButton.addActionListener(new ActionListener() {
        @Override
        public void actionPerformed(ActionEvent e) { 

           AddDialogS adddialog=new AddDialogS(MainS.this);
           adddialog.setVisible(true);
           BookInformation B_info=adddialog.getBookInfos();
           if(B_info != null){
               allBooks.AddRow(B_info);
           }
        }
    });

    JPanel Bpanel=new JPanel();
    Bpanel.setLayout(new FlowLayout());
    JScrollPane sp=new JScrollPane(Btable);
    Bpanel.add(sp);
    Bpanel.add(AddBookButton);
    this.add(Bpanel);
    this.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
    this.setBounds(300, 60, 550, 550);
    this.setVisible(true);
   }

   public static void main(String[] args){
       new MainS();
   }
} 
```

添加新记录的第二类：

```
public class AddDialogS extends JDialog{
BookInformation bookinform=new BookInformation();

public AddDialogS(JFrame owner){
    super(owner,"Add New Book!", true);
    JButton OkButton=new JButton("Ok");
   final JTextField nameTF=new JTextField(10);
   JLabel namelbl=new JLabel("bookname");
   final JTextField dateTF=new JTextField(10);
   JLabel datelbl=new JLabel("bookDate");
   final JTextField idTF=new JTextField(10);
   JLabel IDlbl=new JLabel("bookId");

    OkButton.addActionListener(new ActionListener() {
        @Override
        public void actionPerformed(ActionEvent e) {
            bookinform.setBookName(nameTF.getText().trim());
            bookinform.setBookDate(String.valueOf(dateTF.getText().trim()));
            bookinform.setBookID(String.valueOf(idTF.getText().trim()));
            AddDialogS.this.dispose();
        }
    });

    JPanel panel=new JPanel(new FlowLayout());
    panel.add(OkButton);
    panel.add(nameTF);
    panel.add(dateTF);
    panel.add(idTF);
    panel.add(namelbl);
    panel.add(datelbl);
    panel.add(IDlbl);
    this.add(panel);
    this.setBounds(10, 30, 400, 500);
}

public BookInformation getBookInfos(){
    return bookinform;
}
} 
```

我的表模型类：

```
public class AllBooks extends AbstractTableModel{
BookInformation Binfos1=new BookInformation();

String[] Bcol=new String[]{"Name","Date","Id"};
List<BookInformation> Bdata=new ArrayList<BookInformation>();

public AllBooks(){
    try{
        FileReader fr=new FileReader("AllBookRecords.txt");
        BufferedReader br=new BufferedReader(fr);
        String line;

        while( (line=br.readLine()) !=null){
            Bdata.add(initializeBookInfos(line));
        }
        br.close();
    }
    catch(IOException ioe){

    }
}

public static BookInformation initializeBookInfos(String str){
    BookInformation Binit=new BookInformation();
    String[] bookCellArray=str.split("     ");
    Binit.setBookName(bookCellArray[0]);
    Binit.setBookDate(bookCellArray[1]);
    Binit.setBookID(bookCellArray[2]);
    return Binit;
}

public void AddRow(BookInformation bookinfo){
    if(AddToFile(bookinfo)){
        Bdata.add(bookinfo);
        fireTableRowsInserted(Bdata.size()-1, Bdata.size()-1);
    }
    else{
        JOptionPane.showMessageDialog(null, "Unable Add To File"+bookinfo.getBookName());
    }
}

public boolean AddToFile(String bookinfos){
    try{       
        PrintWriter Bpw=new PrintWriter(new FileOutputStream("AllBookRecords.txt",true));
        Bpw.println(bookinfos);
        return true;
    }
    catch(IOException ioe){
        return false;
    } 
}

@Override
public String getColumnName(int col){
    return Bcol[col];
}

@Override
public int getRowCount() {
    if(Bdata !=null){
    return Bdata.size();
    }
    else{
        return 0;
    }
}

@Override
public int getColumnCount() {
    return Bcol.length;
}

@Override
public Object getValueAt(int rowIndex, int columnIndex) {
    BookInformation binfo=Bdata.get(rowIndex);
    Object value;

    switch(columnIndex){

        case 0:
            value=binfo.getBookName();
            break;
        case 1:
            value=binfo.getBookDate();
            break;
        case 2:
            value=binfo.getBookID();
            break;
        default :
            value="...";  
    }
    return value;

}
} 
```

我的 BookInformation 类：

```
public class BookInformation {

private String BookName;
private String BookDate;
private String BookID;

public String getBookName() {
    return BookName;
}

public void setBookName(String book_name) {
    this.BookName = book_name;
}

public String getBookDate() {
    return BookDate;
}

public void setBookDate(String book_date) {
    this.BookDate = book_date;
}

public String getBookID() {
    return BookID;
}

public void setBookID(String Book_id) {
    this.BookID = Book_id;
}
} 
```

感谢帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-07T19:30:39.620

看起来您在文件中获得的内容是对此类对象调用 toString() 方法的结果：myproject.Library.BookInformation。

因此，在您的情况下，最快的解决方法是为 BookInformation 覆盖 toString() 方法以返回您需要的内容。

```
public String toString() {
    return getBookName(); // Or whatever you see fit.
} 
```

即使稍后您将更改代码以不依赖于 toString() 有意义的实现也不会受到伤害。

与另一个答案不同，如果您覆盖 toString()，则不必更改 AddToFile 的代码。但是，如果您不修改 BookingInformation 的代码，那么当您调用 AddToFile 时，您将不得不制作字符串值，类似于建议的内容：

```
AddToFile(bookinfo.getBookName()) // Or whatever you see fit. 
```

另一种更好的方法是修改 AddToFile 方法以接受 BookingInformation 作为参数。

```
public boolean AddToFile(BookingInformation bookinfos){
    try{       
    PrintWriter Bpw=new PrintWriter(new FileOutputStream("AllBookRecords.txt",true));
    Bpw.println(bookinfos.getBookName()); // Or whatever you see fit.
    return true;
    }
    catch(IOException ioe){
    return false;
    } 
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-07T19:30:48.937

在你的`BookInformation`类中添加这样的`toString`方法

```
public String toString(){
    return BookID + "     " + BookDate + "     " + BookName; 
} 
```

然后`AddToFile()`像这样打电话

`AddToFile(bookinfo.toString())`

从`AddRow`方法。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-07T20:29:45.467

您可以尝试任何数量的解决方案。

您可以修改您的`AddToFile`方法以写入以根据需要格式化对象的属性。

这确保了模型写入文件的格式是模型在读回文件时所期望的格式。

```
public boolean AddToFile(BookInformation bookinfos){
    try{       
        PrintWriter Bpw=new PrintWriter(new FileOutputStream("AllBookRecords.txt",true));
        StringBuilder sb = new StringBuilder(64);
        sb.append(bookinfos.getBookID()).append(";");
        sb.append(bookinfos.getBookName()).append(";");
        sb.append(bookinfos.getBookID()).append(";");
        Bpw.println(sb.toString());
        return true;
    }
    catch(IOException ioe){
        return false;
   } 
} 
```

您当然可以定义自己的格式和分隔符。这样做的好处是允许模型控制它自己的格式，并且不会影响程序的任何其他部分，例如使用`toString()`will。

或者，您可以在类中编写一个读/写方法`BookInformation`，传入`PrintWriter`并允许`BookInformation`确定数据应保持的格式。

这样做的好处是允许程序的其他部分以统一的方式保存对象，如果格式发生变化（即添加新字段），它会在一个位置发生变化

# mysql - 使用 RAND() 时如何在 Mysql 查询中排除结果

> ID：14759291
> 
> 赞同：1
> 
> 时间：2013-02-07T19:23:33.757
> 
> 标签：mysql, sql

我有这个查询

```
"SELECT * FROM TABLE ORDER BY RAND() LIMIT 5" 
```

但我不想显示 ID = 3 的数据

从这张表中......这可能与`rand()`功能有关吗？

示例：我在表格中有 10 张图像，`id=1` `id=2`并且`id=3` `id=4` `id=5`.... 现在我想随机显示除图像之外的所有图像`id=3`

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-07T19:25:13.350

当然，只需添加一个`WHERE`语句（并删除`LIMIT`，因为您想要*所有*图像）：

```
SELECT
    *
FROM
    `TABLE`
WHERE
    `ID` != 3
ORDER BY
    RAND() 
```

# fluent-nhibernate-mapping - 如何告诉 FNH 将蛇形数据库列映射到 Pascal 案例属性？

> ID：14759292
> 
> 赞同：0
> 
> 时间：2013-02-07T19:23:34.240
> 
> 标签：fluent-nhibernate-mapping

我们约定在我们的实体中将蛇形数据库列转换为帕斯卡大小写：

```
 Map(x => x.ProjectName).Column("project_name"); 
```

映射总是这样。我们如何让 FNH 完成工作而不是全部输入？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-11T20:31:39.497

实施`IPropertyConvention`和使用

```
// in Apply (maybe filter out some special cases)
instance.Column(ToSnakeCase(instance.Name));

private string ToSnakeCase(string name)
{
    var result = new Stringbuilder(name.Length);
    for (int i = 0; i < name.Length; i++)
    {
        if (i > 0 && char.IsUpper(name[i]))
            result.Append('_').Append(char.ToLower(name[i]));
        else
            result.Append(char.ToLower(name[i]));
    }
    return result.ToString();
} 
```

# php - 如果没有足够的图像，则插入默认图像

> ID：14759296
> 
> 赞同：-1
> 
> 时间：2013-02-07T19:23:52.427
> 
> 标签：php, image, default

我有一个显示 4 张图片的相册页面。如果图像少于 4 个，我想显示默认图像。我的意思是如果有 2 个图像，我想显示默认图像 2 次以考虑样式问题。

我可以像这样计算数据库中的图像：

```
 <?php
 $q2=mysql_query("select * from images where i_id=$id");
 $count =  mysql_num_rows($q); 
```

我可以找到这样的结果：

```
 $result= 4 - $count; 
```

但我不知道如何设置 if 子句。任何帮助表示赞赏。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-07T19:30:36.170

好的，你想要这个：

```
$imagesToShow = 4;

for ($i = $count; $i < $imagesToShow; $i++) {
    // print your default image here
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-07T19:39:46.250

```
<?php
$to_display = 4;
$query = mysql_query("select * from images where i_id=$id");
 while ($row = mysql_fetch_array($query)) {

     echo '<img src="img from db">';
     $displayed_number++;

}

echo str_repeat('<img src="default image">', $to_display-$displayed_number); 
```

# uiscrollview - 控制 UIScrollview 中的动画滚动率 - IOS 开发

> ID：14759300
> 
> 赞同：1
> 
> 时间：2013-02-07T19:24:09.840
> 
> 标签：uiscrollview, scroll, rate

我已经实现了一些运行良好的代码，可以根据触发的计时器自动滚动 UIScrollview。

这里是：

```
....
CGPoint offset;
....
offset = scroller.contentOffset;
....
- (void) scrollWords: (NSTimer *) theTimer
{
offset.y = offset.y+300;
[UIScrollView beginAnimations:@"scrollAnimation" context:nil];
[UIScrollView setAnimationDuration:50.0f];
[scroller  setContentOffset:offset];
[UIScrollView commitAnimations];

} 
```

但是，我注意到滚动发生时，滚动速率会发生变化；中途每秒滚动 2 或 3 行文本，但在开始和结束时速度要慢得多，可能只有每秒 0.5 行。有什么方法可以控制滚动率吗？

提前致谢。

保罗。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-07T19:45:00.250

你正在寻找`setAnimationCurve:`. 具体来说，您所描述的是`UIViewAnimationCurveEaseInOut`. 尝试添加`[UIScrollView setAnimationCurve:UIAnimationCurveLinear];`

此外，您正在使用旧式动画代码。如果您的目标是 iOS 4 或更高版本，请查看这种更友好的新样式（在我看来）：

```
- (void) scrollWords: (NSTimer *) theTimer
{
    offset.y = offset.y+300;
    [UIScrollView animateWithDuration:50.0f delay:0 options:UIViewAnimationOptionCurveLinear animations:^{
        [scroller setContentOffset:offset];
    }];
} 
```

使用延迟参数，您甚至可以摆脱您的 NSTimer。使用此代码，您可以在 5 秒后滚动表格视图。

```
- (void) scrollWordsLater
{
    offset.y = offset.y+300;
    [UIScrollView animateWithDuration:50.0f delay:5.0 options:UIViewAnimationOptionCurveLinear animations:^{
        [scroller setContentOffset:offset];
    }];
} 
```

# html - 保持身体背景图像在不同分辨率下展开并居中

> ID：14759303
> 
> 赞同：0
> 
> 时间：2013-02-07T19:24:28.967
> 
> 标签：html, css

我做了一个网站，但我遇到了垂直居中的问题。我的显示器没问题，但在更高分辨率的情况下，表格仍保留在顶行，并且图像被缩小并且表格的输出。如何把东西放在一起？

[http://marko8883.net84.net/](http://marko8883.net84.net/)

```
.body {
background-position: center center;
height: 100%;
width: 100%;
background-color: #000000;  }

#tabela {
background-attachment: fixed;
background-image:url(images/zid3.gif);
background-repeat: no-repeat;
background-position:center center;
width: 950px;
height: 800px;
cellpadding:5;
cellspacing:0;
margin:0 auto;  } 
```

提前致谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-07T20:43:51.127

我认为您应该`position:absolute;`为所有元素设置，或使用 JavaScript 使页面更小/更大，分辨率或窗口大小发生变化。

# smalltalk - 连接两个 ByteArray 实例的最有效方法是什么？

> ID：14759307
> 
> 赞同：4
> 
> 时间：2013-02-07T19:24:41.803
> 
> 标签：smalltalk, pharo, squeak

我想在 Squeak、Cuis 或 Pharo Smalltalk 中加入两个 ByteArray 实例

```
b := #[10 11 12 13] asOrderedCollection.
b addAll: #[21 22 23 24].
b asByteArray 
```

有没有更有效的方法来做到这一点？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-02-08T11:18:37.773

串联会更好...？

```
#[10 11 12 13],#[21 22 23 24 ] 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-02-07T19:47:50.323

是的。使用 OrderedCollection 将涉及几个不必要的对象分配和冗余复制。您应该创建一个新的字节数组并将源数组的内容复制到其中：

```
a := #[10 11 12 13].
b := #[21 22 23 24].
c := ByteArray new: (a size + b size).
c replaceFrom: 1 to: a size with: a startingAt: 1.
c replaceFrom: a size + 1 to: c size with: b startingAt: 1. 
```

这仅分配新的 ByteArray 并使用原语进行复制，因此速度非常快。它适用于 Squeak、Cuis 和 Pharo，很可能也适用于其他 Smalltalks。

# python - 将 UNC 路径转换为本地路径（以及 Python 中的一般路径处理）

> ID：14759313
> 
> 赞同：0
> 
> 时间：2013-02-07T19:25:07.997
> 
> 标签：python, path, unc

系统：Windows 7 64 位上的 Python 2.6

最近我在 Python 中做了很多路径格式化。由于字符串修改总是很危险，我开始使用“os.path”模块以正确的方式进行修改。

第一个问题是这是否是处理传入路径的正确方法？或者我可以以某种方式优化它吗？

```
sCleanPath = sRawPath.replace('\n', '')
sCleanPath = sCleanPath.replace('\\', '/')
sCleanPythonPath = os.path.normpath(sCleanPath) 
```

为了格式化“sCleanPythonPath”，我现在只使用“os.path”模块中的函数。这很好用，到目前为止我没有任何问题。

只有一个例外。我必须更改路径，以便它们不再指向网络存储，而是指向本地驱动器。开始将 'os.path.splitunc()' 与 'os.path.join()' 结合使用。

```
aUncSplit = os.path.splitunc(sCleanPythonUncPath)
sLocalDrive = os.path.normpath('X:/mount')
sCleanPythonLocalPath = (os.path.join(sLocalDrive, aUncSplit[1])) 
```

不幸的是，由于使用“os.path.join()”处理绝对路径的性质，这不起作用。我在网上找到的所有解决方案都再次使用字符串替换，我想通过使用“os.path”模块来避免这种情况。我有监督什么吗？还有另一种，也许是更好的方法来做到这一点？

非常欢迎所有对此的评论！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-07T21:52:09.977

您可以通过删除调用来稍微优化第一部分，`replace()`因为在 Windows 上将`normpath()`正斜杠转换为反斜杠：

```
sCleanPath = sRawPath.replace('\n', '')
sCleanPythonPath = os.path.normpath(sCleanPath) 
```

这里有一些东西可以让你的问题的第二部分在不进行字符串替换的情况下工作：

```
sSharedFolder = os.path.relpath(os.path.splitunc(sCleanPythonUncPath)[1], os.sep)
sLocalDrive = os.path.normpath('X:/mount')  # why not hardcode the result?
sCleanPythonLocalPath = os.path.join(sLocalDrive, sSharedFolder) 
```

# jquery - 在 jquery mobile 中加载多页文件

> ID：14759317
> 
> 赞同：0
> 
> 时间：2013-02-07T19:25:41.447
> 
> 标签：jquery, html, ios, ajax, jquery-mobile

我有两个单独的 html 文件，它们使用 jquery/jquery 移动框架通过 ajax 加载。但是当我加载第二个文件时，它只加载了第一个 div 页面的作用。有什么办法可以解决这个问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-08T02:23:46.180

这是设计使然。[链接多页文档](http://jquerymobile.com/demos/1.2.0/docs/pages/page-links.html)时，使用[或](http://jquerymobile.com/demos/1.2.0/docs/pages/page-links.html)[`rel="external"``data-ajax="false"`](http://jquerymobile.com/demos/1.2.0/docs/pages/page-links.html)

> 请务必注意，如果您从通过 Ajax 加载的移动页面链接到包含多个内部页面的页面，则需要在链接中添加**rel="external" 或 data-ajax="false"**。这告诉框架重新加载整个页面以清除 URL 中的 Ajax 哈希。这一点很关键，因为 Ajax 页面使用哈希 (#) 来跟踪 Ajax 历史，而多个内部页面使用哈希来指示内部页面，因此这两种模式之间的哈希会发生冲突。

```
<a href="multipage.html" rel="external">Multi-page link</a> 
```

如果以编程方式更改页面使用

```
$.mobile.ajaxEnabled = false;
$.mobile.changePage("multipage.html"); 
```

# javascript - Javascript将数组拆分为多数组

> ID：14759320
> 
> 赞同：1
> 
> 时间：2013-02-07T19:25:48.200
> 
> 标签：javascript, arrays, split

我在使用 javascript 将数组拆分为多数组时遇到了一些麻烦。例如，我有这个数组：

```
[0] => object
   [0] => object
      [0] => The Letter P
      [1] => 5.5
   [1] => object
      [0] => 5
      [1] => 1.1
      [2] => 5
      [3] => 1
      [4] => 1
   [2] => object
      [0] => 5
      [1] => 1.1.1
      [2] => 1.1.1
      [3] => 1.1.1
      [4] => 3 
```

我想做的是拆分周期，并创建一个更深的数组，如下所示：

```
[0] => object
    [0] => object
       [0] => The Letter P
       [1] => object
          [0] => 5
          [1] => 5
    [1] => object
       [0] => 5
       [1] => object
          [0] => 1
          [1] => 1
       [2] => 5
       [3] => 1
       [4] => 1
    [2] => object
       [0] => 5
       [1] => object
          [0] => 1
          [1] => 1
          [2] => 1
       [2] => object
          [0] => 1
          [1] => 1
          [2] => 1
       [3] => object
          [0] => 1
          [1] => 1
          [2] => 1
       [4] => 3 
```

我已经尝试了几乎所有我能想到的东西，但我似乎找不到有效的代码:(请帮助我:(

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-07T19:43:58.363

这应该工作

```
function dotsToArr(arr) {
    for(var x = 0; x < arr.length; x++) {
        if(typeof(arr[x]) != "object") {
            var parts =  (arr[x]+"").split(".");
            if(parts.length > 1) {
                arr[x] = parts;
            }

            continue;
        }

        dotsToArr(arr[x]);
    }
} 
```

JS 小提琴在这里：http: [//jsfiddle.net/gER22/](http://jsfiddle.net/gER22/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-07T19:32:48.553

这不是一个完整的解决方案，但我使用此功能来完成您所描述的事情。

```
function parseStringToArray(inputString){
    var parts = inputString.split(".");
    var arr = [];
    while (parts.length){
        arr.push(parts.shift());
    }
    return arr;
}
function parseArray(inputArray){
    var arrayLength = inputArray.length;
    for (var i = 0; i < arrayLength; i++){
        if (inputArray[i].indexOf('.'){
            inputArray[i] = parseStringToArray(inputArray[i]);
        }
    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-07T19:57:41.727

这会有帮助吗？

```
var toString = Object.prototype.toString;

function parseArray(obj) {
    var i, l;

    if (toString.call(obj) === "[object Number]") {
        obj += "";
    }

    if (toString.call(obj) === "[object String]" && obj.indexOf(".") !== -1) {
        obj = obj.split(".");
    }

    if (toString.call(obj) === "[object Array]") {
        for (i = 0, l = obj.length; i < l; i++) {
            obj[i] = parseArray(obj[i]);
        }
    }

    return obj;
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-07T22:08:17.043

感谢您的所有回复，但我设法自己解决了。当您从编程中休息并放松心情时，会发生什么令人惊讶的事情。无论如何，知道我的数组中要开始三个层，我能够编写以下代码：

```
for(a = 0; a < array.length; a++){
  for(var b = 0; b < array[a].length; b++){
    for(var c = 0; c < array[a][b].length; c++){
      if(array[a][b][c].indexOf(".") > 0){
        array[a][b][c] = array[a][b][c].split(".");
      }
    }
  }
} 
```

起初我尝试使用 while 循环，但这需要更多代码并且更令人困惑。然后我开始使用 for 循环，它对这种类型的系统效果更好。再次感谢您的回复，我希望这可以帮助其他尝试做同样事情的人。

# imageview - 旋转屏幕时如何保存图像 onSaveInstanceState ？

> ID：14759321
> 
> 赞同：3
> 
> 时间：2013-02-07T19:26:01.523
> 
> 标签：imageview, instance

我正在通过 AsyncTask 将图像下载到图像视图，并且我想在旋转手机时保存我的图像，而不是再次下载到图像视图...

```
public void onSaveInstanceState(Bundle toSave) {
    super.onSaveInstanceState(toSave);
    my_image.buildDrawingCache();
    Parcelable bm = my_image.getDrawingCache();
    toSave.putParcelable("savedImage", bm);

} 
```

**我试图了解我是否在onSaveInstanceState**上做错了什么 ，以及如何检索此状态**onRestoreInstanceState**并放置图像而无需再次下载...

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-12-07T07:50:50.380

onSaveInstanceState() 函数必须用于保存小对象，而不是重对象。

**如果您想在手机旋转时保存大量图像，请使用以下任何技术：**

1.  如果要保存大对象，请使用 onRetainNonConfigurationInstance() 函数。
2.  否则我们可以将该图像设为静态，这样该图像将只加载一次。含义：从网络下载图像时，使其由静态变量指向。如果用户旋转手机，由于 android 会杀死该活动并重新创建它，只需放置一个 if 条件检查该静态变量是否不为空，然后再次下载。如您所知，静态变量只会创建一次，不会再次下载。

但最好选择第一种。

参考：[开发者android官方教程](http://developer.android.com/guide/topics/resources/runtime-changes.html#RetainingAnObject)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-19T17:28:39.387

首先`super.onSaveInstanceState(toSave)`应该在 method 中的最后一个位置`onSaveInstanceState(Bundle toSave)`。

在`onCreate(Bundle savedInstanceState)`检查中，如果`savedInstanceState`不为空并得到你想要的：

```
@Override
protected void onCreate(Bundle savedInstanceState) {
...
    if(savedInstanceState != null){
        ...
        ...savedInstanceState.getParcerable(...);
        ...
    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-10-26T15:51:36.653

不要使用静态变量来保存位图。

# json - ExtJS 指定转换的现有日期格式

> ID：14759324
> 
> 赞同：0
> 
> 时间：2013-02-07T19:26:12.200
> 
> 标签：json, extjs, date-conversion

我有很多用 ExtJS 显示的数据，我不知道如何指定数据的格式以便正确转换。我们正在尝试以 m/d/y 格式显示数据。数据以 Ymd 格式输出（20130214，无连字符）。我怎样才能告诉 ExtJS 日期的格式，以便可以对其进行解析？

日期是通过 JSON 从远程服务检索的，所以我能更改的只是列标题 JSON 文件。

任何建议将不胜感激。我尝试在列上设置 submitFormat 和 dateFormat 参数，但没有奏效。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-07T19:47:21.317

在您的模型中，像这样指定字段：

```
...
fields: [
  ...
  {name: 'theDate', type: 'date', dateFormat: 'Ymd'},
  ...
],
... 
```

请注意，通过以下方式检索的数据`myRecord.get('theDate');`是一个 JavaScript`Date`对象，因此您可以通过多种方式对其进行格式化，例如：

```
Ext.Date.format(myRecord.get('theDate'), "m/d/Y"); 
```

# python - 根据另一个字典列表更新字典列表

> ID：14759325
> 
> 赞同：0
> 
> 时间：2013-02-07T19:26:18.117
> 
> 标签：python, python-2.7

我有两个字典列表，一个是项目标识符列表，另一个是已完成项目标识符的列表。我希望根据已完成列表中的存在向项目标识符列表中添加一个键。

**当前代码**

```
>>> projects = [{'id': 1}, {'id': 2}, {'id': 3}]
>>> completes = [{'id': 1}, {'id': 2}]
>>> for complete in completes:
...     for project in projects:
...         if project["id"] == complete["id"]:
...             project["complete"] = 1
...         else:
...             project["complete"] = 0
...
>>> print projects
[{'id': 1, 'complete': 0}, {'id': 2, 'complete': 1}, {'id': 3, 'complete': 0}] 
```

**预期产出**

```
[{'id': 1, 'complete': 1}, {'id': 2, 'complete': 1}, {'id': 3, 'complete': 0}] 
```

项目被标记为完成后，如何跳出嵌套循环？我应该考虑另一种方法而不是使用嵌套循环吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-07T19:29:29.873

### 编辑 - 已修复（感谢@sotapme）

为什么不这样：

```
cids = [c['id'] for c in completes]
for project in projects:
    project["complete"] = project["id"] in cids 
```

这将设置`project["complete"]`为`True`or `False`，我建议这样做更好。如果你真的需要`1`and `0`，那么：

```
 project["complete"] = int(project["id"] in cids) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-07T19:37:39.993

如果将它们存储为由 id 键入的 dicts 而不是 dicts 数组，它会变得容易得多（在我看来）：

```
projects = [{'id': 1}, {'id': 2}, {'id': 3}]
completes = [{'id': 1}, {'id': 2}]

projects_dict = {}
for p in projects:
    projects_dict[p['id']] = p

completes_dict = {}
for c in completes:
    completes_dict[c['id']] = c

for k in projects_dict.keys():
    projects_dict[k]['complete'] = int(k in completes_dict) 
```

当然，不要循环完成，只需在创建“完成”数组的任何地方添加“完成”键。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-07T19:39:23.270

我无法发表评论，但 jimhark 说的是好的，除了我认为你需要说类似的话

```
for project in projects:
    project['complete'] = project['id'] in (complete['id'] for complete in completes) 
```

编辑：他已经改变了他的答案是正确的

# ios - iOS 使用 AFNetworking 停止下载大文件

> ID：14759327
> 
> 赞同：1
> 
> 时间：2013-02-07T19:26:19.470
> 
> 标签：ios, download, afnetworking, nsoutputstream

我正在使用 AFNetworking 下载一个大型视频文件，它似乎停止在 170MB 左右，而没有调用超时或引发任何其他类型的错误。

我已将 AFURLConnectionOperation 子类化以流式传输数据，并使用 NSOutputStream 将数据直接写入文件。

```
NSOutputStream * output = [NSOutputStream outputStreamToFileAtPath:appFile append:NO];
urlConnection = [[RADVideoDownloader alloc]initWithRequest:request andOutputStream:output]; 
```

[url连接开始];

该文件本身约为 370MB。有人有想法么？

提前致谢

# javascript - 具有相同 id 错误的 div

> ID：14759330
> 
> 赞同：0
> 
> 时间：2013-02-07T19:26:25.747
> 
> 标签：javascript, html, css

```
<div id="tagTree1" class="span-6 border"  style='width:280px;height:400px;overflow:auto;float:left;margin:10px; '>
    <a class="tabheader" style="font-size:large">Data Type</a><br />
    <div class="pane">Refine search by Data Type</div>
</div> 
```

上面的 div(tagTree1) 出现在一个部门广告中。

```
<div id="newtagTree1" class="span-6 border"  style='width:200px;height:400px;overflow:auto;float:left'>
    <a class="tabheader"><strong>Geographic Location</strong></a><br />
    <div class="pane"><strong>Refine search by geographic location</strong></div>
</div> 
```

newTagTree1 分区出现在另一个分区搜索中。但是两者都具有相同的功能，可以在其中生成子分区，这是写在 js 文件中的。所有子分区在 js 文件中动态生成。他们都使用相同的函数来生成子 div。当我在同一页面中使用它们时遇到问题。如果一个工作正常，那么另一个就不行。谁能告诉我我在这方面犯的错误？

提前致谢。

```
$.getJSON('/api/TagsApi/Children?id=800002', function (data) {
    //$(tagDiv).empty();

    $.each(data, function (i, item) {
        $("#tagTree1").append(tagTabBuilder(item));
    });

    $("#tagTree1").tabs("#tagTree1 div.pane", { api: true, tabs: 'a', effect: 'slide', onClick: buildChildren, initialIndex: 0 });
});

function tagTabBuilder(tagData) {
    var str = "<input type='checkbox' name='tagchkbox[]' value='" + tagData.ID + "' onClick='startQuery()' /><a class='tabheader '>" + tagData.NAME;

    if (tagData.count == 0) {
        str += " (<span class='el_count' id='t" + tagData.ID + "'>" + tagData.count + "</span>)" + "</a><br/>";
    } else {
        str += " (<span class='el_count' id='t" + tagData.ID + "'><strong>" + tagData.count + "</strong></span>)" + "</a><br/>";
    }
    str += "<div id='tid-" + tagData.ID + "' class='pane tag'><!--Loading subtags. . .<img src='/assets/modules/gaiaModule/shared/images/load-small.gif' />--></div>";
    return str;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-07T19:32:46.763

我的猜测是，当他们生成子 div 时，他们会使用相同的 ID 方案生成它们。因此，它们中的任何一个都可以自己生成子 div，但是当它们都包含时，就会出现 ID 冲突。答案是修改子生成代码，例如，将父 div 的 id 作为子 div 的 id 的第一部分。

或者，如果您不需要它们用于 javascript 的其他部分，请将子 div id 完全排除在外。一般来说，我发现最好避免生成节点中的 id 属性，而使用类等。

# jquery - 具有屏幕查询更新的搜索选项

> ID：14759333
> 
> 赞同：-2
> 
> 时间：2013-02-07T19:26:27.343
> 
> 标签：jquery

我目前正在为我的网站创建一个搜索字段，它有多个选项，我正在努力解决的主要功能是，当用户开始选择数据进行搜索时，它会回显出他们想要执行的搜索查询。

这是我要实现的目标的图像。

[http://i4.minus.com/jbluKDVCTV1HKh.png](http://i4.minus.com/jbluKDVCTV1HKh.png)

因此，当用户开始从列表中选择选项时，它会在右下角更新用户想要搜索的内容。某些类别必须允许多项选择，例如，用户可能希望通过 Make C 搜索 Type D 和 A in Blue in Blue。

到目前为止，我所做的是将搜索查询分为三个部分（数据将在哪里输入），每次用户单击一个选项时，它首先查看是否有一个带有选项值的标签被选中，但它不能很好地扩展。

您将如何解决实施这样的问题？目前我的方式感觉有点笨拙。

欢迎提出任何问题，因为我想找到一个好的方法来做这件事并继续前进！谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-07T20:13:14.050

这`jsfiddle`是我认为您正在尝试实现的工作示例：http: [//jsfiddle.net/b446B/](http://jsfiddle.net/b446B/)

我创建了 3 种不同的情况： - 必需的类，用于需要在最终查询中的字段 - 多个类，用于允许多选的字段 - 没有上述情况，需要单数选择

标签可以与字段不同，这就是我将它们存储在 rel 属性中的原因。

# git - 如何拆分 git 存储库并遵循目录重命名？

> ID：14759345
> 
> 赞同：28
> 
> 时间：2013-02-07T19:27:04.517
> 
> 标签：git, git-filter-branch

我目前有一个很大的 git 存储库，其中包含许多项目，每个项目都在自己的子目录中。我需要将其拆分为单独的存储库，每个项目都在自己的存储库中。

我试过`git filter-branch --prune-empty --subdirectory-filter PROJECT master`

然而，许多项目目录在他们的生活中经历了几次重命名，并且`git filter-branch`没有跟随重命名，所以实际上提取的 repo 在最后一次重命名之前没有任何历史记录。

如何有效地从一个大的 git 存储库中提取子目录，并按照该目录的所有重命名回到过去？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2013-02-08T01:37:52.970

感谢@Chronial，我能够根据我的需要编写一个脚本来按摩我的 git 存储库：

```
git filter-branch --prune-empty --index-filter '
    # Delete files which are NOT needed
    git ls-files -z | egrep -zv  "^(NAME1|NAME2|NAME3)" | 
        xargs -0 -r git rm --cached -q             
    # Move files to root directory
    git ls-files -s | sed -e "s-\t\(NAME1\|NAME2\|NAME3\)/-\t-" |
        GIT_INDEX_FILE=$GIT_INDEX_FILE.new \
        git update-index --index-info &&
        ( test ! -f "$GIT_INDEX_FILE.new" \
            || mv -f "$GIT_INDEX_FILE.new" "$GIT_INDEX_FILE" )
' 
```

基本上这是这样做的：

1.  删除我需要的三个目录 NAME1、NAME2 或 NAME3**之外**的所有文件（一个项目在其生命周期内被重命名为 NAME1 -> NAME2 -> NAME3）。

2.  **将这三个目录中的所有内容**移动到存储库的根目录。

3.  我需要测试“$GIT_INDEX_FILE.new”是否存在，因为将 svn 导入 git 会创建没有任何文件的提交（仅目录提交）。仅当最初使用“git svn clone”创建存储库时才需要。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2017-05-15T17:17:41.790

我有一个非常大的存储库，我需要从中提取一个文件夹；甚至`--index-filter`预计需要8个小时才能完成。这是我所做的：

1.  获取文件夹所有过去名称的列表。在我的情况下，只有两个，`old-name`并且`new-name`.
2.  对于每个名称：

    ```
    $ git checkout master
    $ git checkout -b filter-old-name
    $ git filter-branch --subdirectory-filter old-name 
    ```

    这将为您提供几个断开连接的分支，每个分支都包含其中一个名称的历史记录。

3.  `filter-old-name`分支应该以重命名文件夹的提交*结束*，`filter-new-name`分支应该以相同的提交*开始*。（如果有多个重命名，这同样适用：您最终会得到相同数量的分支，每个分支都有一个与下一个共享的提交。）一个应该删除所有内容，另一个应该重新创建它。确保这两个提交具有相同的内容；如果他们不这样做，则该文件除了被重命名外还被修改了，您将需要合并更改。（就我而言，我没有这个问题，所以我不知道如何解决它。）

    一个简单的检查方法是尝试在两个提交`filter-new-name`之上重新定位`filter-old-name`，然后将两个提交压缩在一起：git 应该抱怨这会产生一个空提交。（请注意，您需要在备用分支上执行此操作，然后将其删除：变基会从提交中删除 Committer 信息，从而丢失一些您想要保留的历史记录。）

4.  下一步是将两个分支嫁接在一起，**跳过重命名文件夹的两个提交。**（否则会出现一个奇怪的跳转，所有内容都被删除并重新创建。）这涉及找到两个提交的完整 SHA（全部 40 个字符！）并将它们放入 git 的信息中，*新*名称分支的提交首先，*旧*的命名分支的第二次提交。

    ```
    $ echo $NEW_NAME_SECOND_COMMIT_SHA1 $OLD_NAME_PENULTIMATE_COMMIT_SHA1 >> .git/info/grafts 
    ```

    如果你做对了，`git log --graph`现在应该显示一条从新历史结束到旧历史开始的线。

5.  这种移植目前是暂时的：它还不是历史的一部分，不会跟随克隆或推动。使其永久化：

    ```
    $ git filter-branch 
    ```

    这将重新过滤分支而不尝试进行任何进一步的更改，从而使嫁接永久化（更改`filter-new-name`分支中的所有提交）。您现在应该能够删除该`.git/info/grafts`文件。

在所有这一切结束时，您现在应该在`filter-new-name`分支上拥有来自文件夹名称的所有历史记录。然后，您可以使用这个单独的存储库，或者将其合并到另一个存储库中，或者您想对这个历史记录做任何事情。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2013-02-07T22:55:36.657

我认为 git 没有内置功能。您将必须构建自己的过滤器。只需使用`git filter-branch --prune-empty --tree-filter YOURSCRIPT`. 然后，您的脚本将必须识别正确的文件夹（可能是其中特定文件的名称，或者您可能拥有该项目过去所有名称的列表），删除其他所有内容并将文件夹内容向上移动.

如果你的 repo 真的很大，而且你没有时间运行这个脚本，你可以更快地达到同样的效果`--index-filter`，但是编写那个脚本会更复杂。您将不得不使用 git 命令来修改索引而不是文件系统修改命令。

# mysql - SQL，如何读出数据并以这种方式排序？

> ID：14759347
> 
> 赞同：1
> 
> 时间：2013-02-07T19:27:17.047
> 
> 标签：mysql, sql, arrays, json, sorting

如果这个问题太菜鸟，我很抱歉。

我有一个存储在列中的 jason 数组，我想知道是否可以读取一个数组并将其排序。

比如说如果这是 , 中的`column A`数据`{'class':'beatiful','name':'wonderful'}`。我要排序`'class' as ASC`。

如何实现sql语句？我可以举个例子吗？

或者什么样的数据存储格式可以做这种要求添加新列的请求？

非常感谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-07T21:34:44.697

JSON不使用**双**引号吗？
尝试一些字符串函数来提取它。例如，您可以找到“类”的位置。然后，寻找下一个开头的双引号，这将是值的开始。然后，寻找另一个，这将是价值的结束。最后，取出子串。

伪代码如下所示：
P1 = 类键的位置 = LOCATE('"class"', COL_A)
P2 = 值的打开报价的位置 = LOCATE('"', COL_A, P1 + 7 )
P3 = 关闭的位置值的报价 = LOCATE('"', COL_A, P2 + 1)
即值的子串 = SUBSTRING(COL_A, P2, P3 - P2)

扩展：
SUBSTRING(COL_A, LOCATE('"', COL_A, LOCATE('"class"', COL_A)+ 7 ), LOCATE('"', COL_A, LOCATE('"', COL_A, P1 + 7 ) + 1) - 定位('"', COL_A, LOCATE('"class"', COL_A) + 7 ))

我没有在 MySql 上运行它来检查，但你明白了。此外，您可能想要更改它，以便您可以处理字符串“class”出现在其他值字段中的情况。

一旦你有了一个提取值的表达式，你就可以对其进行排序。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-07T21:54:09.720

这并不漂亮，但这基本上是[拆分](https://stackoverflow.com/questions/1096679/can-mysql-split-a-column)您的 JSON 字符串并按类排序：

```
select *
  , substring_index(substring_index(
      replace(substr(A, 2, char_length(A) - 2), '\':\'', '\',\'')
      , ','
      , find_in_set('\'class\'', replace(substr(A, 2, char_length(A) - 2), '\':\'', '\',\'')) + 1
    ), ',', -1) as SortItem
from MyTable
order by SortItem; 
```

这是一个[演示 SqlFiddle](http://sqlfiddle.com/#!2/f6ac5/1)。

您可能必须根据 JSON 中的引号或撇号更改分隔符。

此外，正如评论所指出的，这很丑陋，因为您以*非关系*方式使用*关系*数据库。

# algorithm - 循环法 (RR) 和加权 (WRR) 的大 O

> ID：14759348
> 
> 赞同：1
> 
> 时间：2013-02-07T19:27:19.043
> 
> 标签：algorithm, load-balancing, big-o, round-robin

当我正在实施一个简单的负载平衡服务时，我认为 Big-O 是其未来性能和可扩展性的关键因素。但是我找不到关于两种算法（[WRR](http://en.wikipedia.org/wiki/Weighted_round_robin)和[RR](http://en.wikipedia.org/wiki/Round-robin_scheduling)）的大 O 的参考。

我试着计算它们。
~~*（警告我的计算可能是错误的，但我会在得到正确答案后立即编辑帖子）*~~

~~n-> 服务节点的数量（和权重）
z-> 等待/未完成任务的数量
对于 WRR：O(n *n* z)
对于 RR：O(z^2)~~ 

```
For WRR: O(1)
For RR: O(1) 
```

所以真正的问题是，如果我的计算是正确的，但最重要的是，在持续负载平衡（到每个运行节点）每秒数千个提交任务的情况下，哪种算法执行速度最快。

一些有用的参考资料：

*   一个非常好的 RR[实现](http://www.codeproject.com/Articles/17583/Round-Robin-Scheduling)
*   关于 WRR的 stackoverflow[问题](https://stackoverflow.com/questions/8494876/how-to-implement-weighted-round-robin-using-c)

干杯!

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-07T22:07:20.663

那么你到底需要测量什么？由于大 O 是针对算法性能的，因此衡量每个调度决策的时间复杂度似乎是合理的，即需要多少操作才能将一项任务与一个节点匹配。

# 循环赛

就绪节点列表和等待任务列表都可以实现为队列，对队列的操作可以实现恒定摊销时间。因此，除了需要为队列分配新内存所需的时间外，您在 O(1) 中进行操作。

# 加权循环

如果您的权重是固定的且可通约的，那么您也可以在这里实现相同的复杂性：只需将每个节点多次放入循环队列中，与其权重成正比[。](http://en.wikipedia.org/wiki/Commensurability_%28mathematics%29)可以制定一种算法以将它们均匀地分布在队列中。对于大多数实际应用，一些适度的量化将导致权重可以表示为（即缩放到）相当小的整数。

# 其他注意事项

您是否收到任何关于您的节点是忙还是闲的反馈？如果你这样做了，那么 RR 应该足够好，因为你没有说明任何公平要求。如果您没有空闲反馈，那么 WRR 可能有意义。但在这种情况下，`z`您的公式中的数字显得有些混乱，因为如果您不知道节点是否准备好接受它们，任务怎么会等待呢？如果他们正在等待是因为平衡器无法足够快地处理它们，那么这对您的考虑仍然无关紧要，因为您可以像调度算法*之前*一样想象任务队列：该队列的长度对什么没有影响发生在调度程序中。再次假设所有任务对您来说都是相同的，没有优先级、QoS 保证或类似的元信息。

# c# - 创建 IList 的新实例 从现有的并对其进行修改

> ID：14759349
> 
> 赞同：6
> 
> 时间：2013-02-07T19:27:22.950
> 
> 标签：c#, .net, ienumerable, ilist

鉴于以下代码：

```
public class Item
{
    private int _id;
    private int _order;
    private string _name;

    public int Id
    {
        get { return _id; }
        set { _id = value; }
    }

    public int Order
    {
        get { return _order; }
        set { _order = value; }
    }

    public string Name
    {
        get { return _name; }
        set { _name = value; }
    }

    public static IList<Item> InitList1()
    {
        var list = new List<Item>
        {
            new Item { Id = 1, Order = 1, Name = "Alpha" },
            new Item { Id = 2, Order = 2, Name = "Bravo" },
            new Item { Id = 3, Order = 3, Name = "Charlie" },
            new Item { Id = 4, Order = 4, Name = "Delta" }
        };

        return list;
    }
}

class Program
{
    static void Main(string[] args)
    {
        // Initialize the lists
        IList<Item> list1 = Item.InitList1();
        IList<Item> list2 = list1.ToList();
        IList<Item> list3 = new List<Item>(list1);

        // Modify list2
        foreach (Item item in list2)
            item.Order++;

        // Modify list3
        foreach (Item item in list3)
            item.Order++;

        // Output the lists
        Console.WriteLine(string.Format("\nList1\n====================="));
        foreach (Item item in list1)
            Console.WriteLine(string.Format("Item - id: {0} order: {1} name: {2}", item.Id, item.Order, item.Name));

        Console.WriteLine(string.Format("\nList2\n====================="));
        foreach (Item item in list2)
            Console.WriteLine(string.Format("Item - id: {0} order: {1} name: {2}", item.Id, item.Order, item.Name));

        Console.WriteLine(string.Format("\nList3\n====================="));
        foreach (Item item in list3)
            Console.WriteLine(string.Format("Item - id: {0} order: {1} name: {2}", item.Id, item.Order, item.Name));

        Console.Write("\nAny key to exit...");
        Console.ReadKey();
    }
} 
```

输出将是：

```
List1
=====================
Item - id: 1 order: 3 name: Alpha
Item - id: 2 order: 4 name: Bravo
Item - id: 3 order: 5 name: Charlie
Item - id: 4 order: 6 name: Delta

List2
=====================
Item - id: 1 order: 3 name: Alpha
Item - id: 2 order: 4 name: Bravo
Item - id: 3 order: 5 name: Charlie
Item - id: 4 order: 6 name: Delta

List3
=====================
Item - id: 1 order: 3 name: Alpha
Item - id: 2 order: 4 name: Bravo
Item - id: 3 order: 5 name: Charlie
Item - id: 4 order: 6 name: Delta

Any key to exit... 
```

有人可以向我解释一下：

1.  为什么在创建新列表（list2 和 list3）之后，这些列表上的操作会影响 list1（以及随后的另外两个列表）？和

2.  如何在不影响 list1 的情况下创建 list1 的新实例并对其进行修改？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-02-07T19:33:46.967

你实际上得到了一个“浅拷贝”。是的，列表被复制了，但它们仍然指向原始项目。

像这样想。列表实际上并不包含它所*包含*的项目，而是对它有一个引用。因此，当您复制列表时，新列表仅包含对原始项目的引用。你需要的是这样的

```
IList newlist = new List<Item>();
foreach(item anItem in myList)
{
     newList.Add(item.ReturnCopy());
} 
```

返回副本看起来像这样：

```
public Item ReturnCopy()
{
    Item newItem = new Item();

    newItem._id = _id;
    newItem._order = _order;
    newItem._name = _name;
    return newItem

} 
```

这将复制项目中的所有数据，但保持原始数据不变。有很多模式和接口可以提供更好的实现，但我只是想让你了解一下它是如何工作的。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-02-07T19:30:37.210

您有 3 个列表，但它们包含相同的 4 个元素（即对内存中相同的 3 个对象的引用）。因此，当您在 List1 中的某个项目中修改 order 时，它也会在 List2 中的项目中生效 - 因为它是同一个对象。

ToList 和 List 构造函数都不会进行深层复制。

如果您也想复制对象，则还需要复制它们，以创建新引用以添加到新列表中。在 .NET 中，您通常会实现`ICloneable<T>`以提供`Clone`方法。如果您觉得不需要，您可以创建 new`Item`并复制它们的属性。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-07T19:32:00.960

```
static class Extension
{
    public static IList<T> Clone<T>(this IList<T> list) where T: ICloneable
    {
        return list.Select(i => (T)i.Clone()).ToList();
    }
} 
```

现在你可以`IList<T>.Clone()`用来返回对象了。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-02-07T19:32:46.353

您需要克隆列表中的对象。否则，您将创建新列表，它们都指向相同的对象。

```
var listToClone = new List<Item>();

var clonedList = listToClone.Select(item => (Item)item.Clone()).ToList(); 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-02-07T19:33:06.480

您有 3 个不同的列表，因此编辑这些列表（即向列表中添加新项目、删除项目、在给定位置设置新项目）是不会影响其他变量的更改。

但是，每个列表中的项目仅包含对实际`Item`实例的引用，并且所有三个列表都具有相同的三个引用。当您更改该列表引用的项目时，您所做的更改在其他列表中是“可见的”。

为了不看到这种行为，您不仅需要创建一个新列表，还需要确保新列表中的项目是对恰好包含相同值的新对象的全新引用。在一般情况下，这不是一项微不足道的任务，也不是经常需要的。

# google-apps-script - HtmlService.createHtmlOutputFromFile 找不到文件

> ID：14759350
> 
> 赞同：0
> 
> 时间：2013-02-07T19:27:23.097
> 
> 标签：google-apps-script

我正在尝试使用脚本创建一个 Web 应用程序并将其发布到一个网站。我处于希望`doGet`函数执行的第一个实验级别

```
HtmlService.createHtmlOutputFromFile('MyPage') 
```

我得到了`"Not Found"`错误。

MyPage 是一个输出“Hello World”的简单 HTML 文件。如果我将脚本更改为

```
HtmlService.createHtmlOutput('Hello World') 
```

链接 URL 时，代码执行得很好。`doGet`尽管我已经保存并保存了包含它的项目版本，但似乎找不到我为访问和输出函数创建的 HTML 文件。谁能给我一个提示？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-07T19:55:04.723

它不需要扩展。但它确实需要是使用 File > new Html File 创建的 HTML 文件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-07T19:31:00.873

`HtmlService.createHtmlOutputFromFile('MyPage')`需要`.html`扩展。所以`HtmlService.createHtmlOutputFromFile('MyPage.html')`

还是比这更复杂？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-11-26T21:53:15.683

谷歌开发者页面很好地解释了这一点，并给出了一个开始的例子： [https ://developers.google.com/apps-script/guides/html/](https://developers.google.com/apps-script/guides/html/)

简而言之： HtmlService.createHtmlOutput('x')：指示 GAS 在页面上打印“x”。

HtmlService.createHtmlOutputFromFile('0')：指示 GAS 读取 0.html 内的代码并将其打印到页面（*注意使用 '0' 而不是 '0.html'，因为 GAS 知道您指向 HTML文件。）要在 GAS 中创建 html 文件，请单击左上角的“文件”按钮并转到“新建”->“html”。

# .net - 从单个 .csproj 构建（非 PCL）Monotouch 或 .net dll

> ID：14759351
> 
> 赞同：3
> 
> 时间：2013-02-07T19:27:23.990
> 
> 标签：.net, msbuild, xamarin.ios, reusability, mono.cecil

跨 .NET 和 Monotouch 的代码重用已通过多种方式解决，但大多数技术都涉及并行的项目/解决方案集。

我想通过这个问题来澄清是否可以根据所选的平台和配置，使用单个 csproj 文件构建*同一*程序集的 .NET 或 MonoTouch 版本。

假设如下：

1.  构建机器运行 Windows。
2.  Visual Studio 和 MSBuild 可用。
3.  该方法不需要在 MonoDevelop 上工作，因为 MonoDevelop 目前没有为 MonoTouch 打开 XBuild/MSBuild。
4.  来自有效 MonoTouch 安装的 MonoTouch 二进制文件可用。
5.  只需要构建一个库，而不是一个完整的应用程序。这个库：
    1.  不包含任何 .xib 或 plist。
    2.  是否使用平台特定的代码，这些代码将被有条件地编译。
    3.  是否（必须）引用特定于平台的程序集，这些需要由 .csproj 文件处理。

**问题**：鉴于这些假设，图书馆可以

1.  为 Windows .NET 编译或
2.  **在将二进制文件**复制到 Mac后，为 MonoTouch 应用程序解决方案直接引用而编译。

基于当前的 Visual Studio 平台和配置？

**目前的研究**

1.  MonoTouch 解决方案可以使用在 Windows 上编译的可移植库这一事实给了一些希望，即这是可能的。
2.  `<NoStdLib>true</NoStdLib>` 在为 MonoTouch 构建时在 .csproj 中使用，以及`HintPath`System、System.Core、System.Xml 等的不同 s 似乎是必要的。
3.  不确定在为 MonoTouch 构建时如何引用正确版本的 mscorlib。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-12T20:59:52.463

事实证明，这在 MSBuild 中是完全可能的。假设您从一个为 Windows .NET 创建的 C# 项目开始，并且还想为 iOS 编译，那么关键点如下。**注意：这不适用于 MonoDevelop。它仅适用于 Visual Studio。**这是因为 MonoDevelop 目前没有为 MonoTouch 使用成熟的 MSBuild 兼容构建系统。

1.  为 iOS 创建一个新的解决方案和项目平台，命名为 iOS。这用于为 MonoTouch 编译项目。您可以将其命名为任何您想要的名称，但在下文中始终使用该名称。
2.  对于 iOS 平台，将 NoStdLib 设置为 true 以避免自动引用 mscorlib.dll。还将路径设置为包含 MonoTouch dll 的本地副本的目录，从 Mac 上的 MonoTouch 安装中复制：

    ```
    <PropertyGroup Condition="'$(Platform'=='iOS'">
      <NoStdLib>true</NoStdLib>
      <iOSLibs>c:\MonoTouch\</iOSLibs>
    </PropertyGroup>` 
    ```

3.  添加对文件夹中所有引用的 MonoTouch 程序集的本地副本的引用：

    ```
    <ItemGroup Condition="'$(Platform'=='iOS'">
      <Reference Include="mscorlib">
        <HintPath>$(iOSLibs)\mscorlib.dll</HintPath>
      </Reference>    
      <Reference Include="System">
        <HintPath>$(iOSLibs)\System.dll</HintPath>
      </Reference>    
      <Reference Include="System.Core">
        <HintPath>$(iOSLibs)\System.Core.dll</HintPath>
      </Reference>    
      <Reference Include="System.Xml"> 
        <HintPath>$(iOSLibs)\System.Xml.dll</HintPath>
      </Reference>
      <Reference Include="System.Xml.Linq"> 
        <HintPath>$(iOSLibs)\System.Xml.Linq.dll</HintPath>
      </Reference>
      <Reference Include="monotouch">
        <HintPath>$(iOSLibs)\monotouch.dll</HintPath>
      </Reference>    
    </ItemGroup> 
    ```

4.  Visual Studio 自动添加一个引用所有 .NET 程序集的 ItemGroup。由于我们已经指示 Visual Studio/MSBuild 在为 iOS 构建时从 iOSLibs 文件夹中获取这些，我们应该有条件地禁用默认程序集。这可以阻止 VS 抱怨重复的程序集引用。更改 的第一行`ItemGroup`并添加条件，如下所示。（注意：程序集列表将根据您的项目当前引用的内容而有所不同。）

    ```
    <ItemGroup Condition=" '$(Platform)' != 'iOS' ">
      <Reference Include="System" />
      <Reference Include="System.Core" />
      <Reference Include="System.Drawing" />
      <Reference Include="System.Windows.Forms" />
      <Reference Include="System.Xml.Linq" />
      <Reference Include="System.Data.DataSetExtensions" />
      <Reference Include="Microsoft.CSharp" />
      <Reference Include="System.Data" />
      <Reference Include="System.Xml" />
    </ItemGroup> 
    ```

现在你准备好了。为解决方案中的所有项目完成此操作后，您可以从解决方案下拉列表中选择 iOS，并像魔术一样构建 MonoTouch 二进制兼容程序集，*而无需*使用可移植类库！（这并不意味着 PCL 没有用，它们当然有用，但这里显示的技术更普遍适用。）

更详细地了解 MSBuild 及其强大的功能将帮助您进一步简化，例如：

1.  将上述大部分内容移动到一个通用的 MSBuild 文件中，您可以从所有项目文件中引用该文件以消除重复。
2.  使用定义编译器常量`<DefineConstants>...</DefineConstants>`以允许您的代码根据当前的解决方案和配置以不同的方式做事。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-08T08:35:06.187

从技术上讲，应该可以使用[https://github.com/jbevain/cecil](https://github.com/jbevain/cecil)等工具重写生成的程序集以针对不同的平台，但我认为这不值得（巨大的）努力。拆卸和重建是另一种（昂贵的）选择。

如果您的问题是关于重新定位第三方提供的程序集，而这是您唯一的计划，请确保您没有违反任何许可条款。

现在，如果您可以去掉一些假设，并使用不同的构建系统（如 rake 或 make），您还可以在构建文件级别实现代码共享而无需 PCL。

希望能帮助到你。

# r - 从宽到长重塑纵向数据

> ID：14759353
> 
> 赞同：-1
> 
> 时间：2013-02-07T19:27:34.737
> 
> 标签：r, reshape

我有一些纵向数据，除了更多的主题和时间外，如下所示：

```
Date        Sub1  Sub2   Sub3 
8/10/2012   19.0  18.9   20.7 
8/13/2012   19.0  19.1   19.5 
```

我有给每个科目（sub1、sub2 和 sub3）打分的日期。如何使用 reshape 或任何其他 R 包将其更改为长格式？所以它看起来像这样：

```
Subject Score Date
Sub1    19.0  8/10/2012
Sub1    19.0  8/13/2012
Sub2    18.9  8/10/2012
Sub2    19.1  8/13/2012
Sub3    20.7  8/10/2012
Sub3    19.5  8/13/2012 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-08T05:02:17.110

`reshape`如果您知道如何指定输入，Base R 的函数也可以很好地解决这些类型的问题。

```
reshape(dat, direction = "long", 
        idvar = "Date", timevar = "Subject", 
        varying = 2:ncol(dat), sep = "")
#                  Date Subject  Sub
# 8/10/2012.1 8/10/2012       1 19.0
# 8/13/2012.1 8/13/2012       1 19.0
# 8/10/2012.2 8/10/2012       2 18.9
# 8/13/2012.2 8/13/2012       2 19.1
# 8/10/2012.3 8/10/2012       3 20.7
# 8/13/2012.3 8/13/2012       3 19.5 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-07T19:32:06.780

如果您的数据被调用`dat`

```
dat <- read.table(text="Date        Sub1  Sub2   Sub3 
                    8/10/2012   19.0  18.9   20.7 
                    8/13/2012   19.0  19.1   19.5 ",header=TRUE)

  library(reshape2)
  melt(dat)

  # explicitly you would use Date as AN id
  # melt(dat, id = "Date") 
```

# python - 从 SocketServer.ForkingTCPServer python 释放套接字

> ID：14759356
> 
> 赞同：1
> 
> 时间：2013-02-07T19:27:53.083
> 
> 标签：python, sockets, socketserver, simplehttpserver

我正在创建一个 ForkingTCPServer 来充当代理。它处理得很好，但执行后不会释放套接字。我已经尝试过`.shutdown()`，`.server_close()`但它们只会导致程序冻结。如何释放套接字以便再次使用？

```
import SocketServer
import SimpleHTTPServer
import urllib

PORT = 8080

class Proxy(SimpleHTTPServer.SimpleHTTPRequestHandler):
    def do_GET(self):
        self.copyfile(urllib.urlopen("http://"+self.path[1:]), self.wfile)

httpd = SocketServer.ForkingTCPServer(('', PORT), Proxy)
print "serving at port", PORT
httpd.handle_request() 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-07T21:33:44.443

该`handle_request`方法只处理一个请求，因此父进程只响应一个请求。

您可以将调用`handle_request`置于循环中。

否则，如果您的意思是在启动服务器的新副本时收到“正在使用”错误，那是因为您必须等待 TCP 2MSL 计时器超时。要解决此问题，`SO_REUSEADDR`请在侦听套接字上进行设置。（设置`self.allow_reuse_address`，虽然我不太确定在哪里设置它，但还没有这样做。）

# node.js - 验证后显示来自 S3 的缩略图/图片

> ID：14759360
> 
> 赞同：0
> 
> 时间：2013-02-07T19:28:11.313
> 
> 标签：node.js, express, amazon-s3, knox-amazon-s3-client

我是 S3 的新手。我对 s3 的理解是浏览器请求图像，然后服务器必须连接到 s3 获取图像，就好像它是一个文件系统一样，获取流并将输出发送到浏览器。我想知道是否有一种方法可以直接提供 s3 存储桶/图像的 url，但这必须在身份验证之后并且必须有时间限制，以便在一段时间后您应该能够再次访问图像。

上传也是一样。文件名等上传详细信息必须发送到服务器，但图像进入 s3 并且成功/错误在服务器中更新。这可能吗。我打算在服务器上使用 nodejs

我听说过诺克斯，但不确定它适合这个。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-08T00:06:26.743

您对 S3 的理解是不完整的。

下载时：可以（但没有必要）让服务器从 S3 检索图像（或其他文件），“就好像它 [S3] 是一个文件系统”或通过 HTTP，然后将其中继到客户端。这不仅没有必要，而且可以说是对带宽和服务器资源的浪费，而且几乎肯定会增加延迟。

如果不需要保护图像，那么您只需使用指向适当 S3 端点+存储桶+对象的链接（或存储桶+端点+对象 - 大多数情况下，URL 可以以两种不同的方式构建） .

从[文档](http://docs.aws.amazon.com/AmazonS3/latest/dev/Introduction.html)中：

> 存储桶是存储在 Amazon S3 中的对象的容器。每个对象都包含在一个桶中。例如，如果名为*photos/puppy.jpg的***对象**存储在*johnsmith* **bucket**中，则可以使用 URL [http://johnsmith.s3.amazonaws.com/photos/puppy.jpg对其进行寻址](http://johnsmith.s3.amazonaws.com/photos/puppy.jpg)

 ****您也可以使用[https](http://aws.amazon.com/s3/#protecting)。

另一方面，如果您想防止未经授权访问该文件，您可以将存储桶配置为不允许公共访问，并通过在您的 Web 服务器上生成签名 URL 来使用[查询字符串身份验证](http://docs.aws.amazon.com/AmazonS3/latest/dev/RESTAuthentication.html#RESTAuthenticationQueryStringAuth)，从而为用户的浏览器提供过期的临时凭证，看起来像这样：

```
http://johnsmith.s3.amazonaws.com/photos/puppy.jpg?AWSAccessKeyId=AKIAIOSFODNN7EXAMPLE&Expires=1141889120&Signature=vjbyPxybdZaNmGa%2ByT272YEAiv4%3D 
```

过期时间（您选择的值）之后，此 URL 将不再有效。不，更改“到期”值不会使其工作。:)

当然，下次用户访问您的站点时，您的服务器将为同一图像生成一个新的签名 URL，供浏览器在后续会话期间使用。

* * *

[文档](http://docs.aws.amazon.com/AmazonS3/latest/dev/UsingHTTPPOST.html)中还解释了上传过程。在这里，同样，这两种方法都是可能的。

您的网站可以制作包含授权和身份验证详细信息的 HTML 表单，允许浏览器将文件直接发布到 S3，然后在上传完成并指示成功时将浏览器重定向回您的站点（在您指定的 URL）或失败...或者您可以让浏览器像往常一样将文件上传到 Web 服务器，然后 Web 服务器可以代理或以其他方式将其传输到 S3。

* * *

我不熟悉[knox](https://github.com/LearnBoost/knox)，但它似乎是一个库，提供了一种方法来完成部分或全部这些事情。****

# ios - 为拥有 10 名员工的公司打包 iOS iPad 应用程序

> ID：14759361
> 
> 赞同：0
> 
> 时间：2013-02-07T19:28:24.080
> 
> 标签：ios, ipad, software-distribution, iphone-developer-program

我想将我创建的应用程序分发给一家只有 10 名员工且不会超过 20 人的公司。该应用程序将在内部进行，不会在应用商店或其他任何地方出售。

有没有一种方法可以分发应用程序，而无需在开发人员门户的测试配置部分中添加每个人的 UDID，因为据我了解仅用于测试目的。

如果有人能给我一个关于如何轻松分发应用程序的明确指南，以便我可以在 10 台 iPad 设备上安装应用程序。目标是： 1) 能够每隔一周发送一次应用程序更新，并使其易于下载。2) 能够在新员工加入公司时添加新设备。

到目前为止，我一直在使用 testflight 来让我的 beta 测试人员尝试我的应用程序，并且我正准备以类似的方式添加 10 名员工，但我认为这不是正确的方法，尽管使用 testflight 的优势是能够轻松地向用户发送应用程序。

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-07T19:34:22.763

如果您的客户能负担得起每年 300 美元的大笔费用，您可以让他们加入 Apple 的“企业”计划（[此处描述](http://developer.apple.com/programs/ios/enterprise/)），他们有[一些方便的实用程序和技术可供您使用](http://www.apple.com/business/accelerator/deploy/app-distribution.html)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-05T17:38:05.820

我能够以无线方式分发我的 apo。应用程序将通过分析存储在服务器上的 plist 文件来检查当前版本，如果 ipad 的软件版本低于 plist 文件版本密钥，则应用程序将转到新 ios 应用程序的下载页面。它工作得很好。

# php - 表单文件输入（图像）不会上传到目录目的地

> ID：14759363
> 
> 赞同：0
> 
> 时间：2013-02-07T19:28:35.243
> 
> 标签：php, file

当我提交表单时，图像文件不会发送到他的目录。其中的其余数据已成功插入。我看了几个教程，我知道我没有使用最节省的方法，但我仍然希望它能够工作，有人可以看看吗？

```
 function addData($name, $price, $description, $files)
            {

                            if(!empty($name) || !empty($price) || !empty($description))
                            {
                                   if($sql = $this->db->prepare("SELECT * FROM products WHERE name= ? LIMIT 1"))
                                    {
                                        $sql->bind_param('s', $name);
                                        $sql->execute();
                                        $sql->store_result();
                                        $sql->fetch();
                                        $numrows = $sql->num_rows;
                                        print_r($numrows);
                                    }
                                    else
                                    {
                                        echo "something is wrong";
                                    }
                                    if($numrows>0)
                                    {
                                                echo 'duplicate, go to <a href="index.php?res=resources&adm=admin&page=inventory.php">same page</a>';
                                    }
                                    else
                                    {
                                        if($insert = $this->db->prepare("INSERT INTO products (name, price, description) VALUES(?, ?, ?)"))
                                        {

                                                    $insert->bind_param('sds', $name, $price, $description);
                                                    $insert->execute();
                                        }
                                        else
                                        {
                                            echo "failed to prepare";
                                        }

                                        //The uploaden image is sent to temp map
                                        if(is_uploaded_file($files['image']['tmp_name']))
                                        {
                                            $valid_types = array(
                                                "image/gif",
                                                "image/png",
                                                "image/jpeg",
                                                "image/pjpeg",
                                            );

                                                if (in_array($files["file"]["type"], $valid_types))
                                                {
                                                    $uploaddir = "./webshop/public/img/content/";
                                                    if(move_uploaded_file($files['image']['tmp_name'], $uploaddir."/".$files['image']['name']));
                                                }

                                                //Shows where its stored
                                                    echo "Stored in: " . 'C:/xampp/htdocs/webshop/public/img/content/' . $files["file"]["name"];

                                    }
                                    else
                                    {
                                                    echo "didnt inserted the damn thing!";
                                    }

                                }
                                print_r($files);
                    }
                } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-07T19:37:33.483

您似乎`['name']`缺少`move_uploaded_file`

```
move_uploaded_file($files['image']['tmp_name'], $uploaddir."/".$files['image']['name']); 
```

还要注意`."/".`$uploaddir 和 $files 之间的添加

在您的代码`$uploaddir/$files['image']`中，您的目标是添加尾部斜杠，然后是文件名，但是，您没有使用语法来连接字符串。因此，您必须`.`在变量之间添加。您可以在

```
$uploaddir = "./webshop/public/img/content/"; 
```

那么你可以做

```
move_uploaded_file($files['image']['tmp_name'], $uploaddir.$files['image']['name']); 
```

**更新**：

您`If..elseif..`在插入和处理文件时使用。根据您的逻辑，您准备语句，如果失败，您检查文件。它永远不会两者兼得。您需要删除 elseif 并进行两次单独检查。

```
if($insert = ..){}
else{echo "failed to prepare";}
if(is_uploaded_file()){} 
```

您可能希望先检查上传的文件，然后将其移动到数据库中，如果没有其他问题。然后，如果数据库插入失败，您可以取消链接（删除）文件，因为出现问题。

# c# - 我可以使用 Resharper 2.0 检查项目中的代码问题吗？

> ID：14759366
> 
> 赞同：1
> 
> 时间：2013-02-07T19:28:43.400
> 
> 标签：c#, visual-studio, refactoring, resharper, windows-ce

我在我的个人 Windows 8 / VS 2012 项目中使用 Resharper。

我还在工作中使用 Resharper，在 Windows 7 机器（Resharper 2.0）上使用 VS 2010（Resharper 7.1）和 XP 模式下的 VS 2003。

不过，今天早上在去 refactorville 的路上发生了一件有趣的事情：我在 Resharper (2.0) 窗口中徒劳地搜索了我心爱的 Inspect | 当前项目命令中的代码问题 - 不仅无处可见，而且似乎没有任何类似之处。2.0 中是否有我不知何故缺少的类似功能？如果是这样，我该如何调用它？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-07T19:39:27.927

根据官方[**代码质量分析**](http://www.jetbrains.com/resharper/features/code_analysis.html)功能页面，在[**Find Code Issues**](http://www.jetbrains.com/resharper/features/code_analysis.html#Find_Code_Issues)部分（强调我的）下：

> **ReSharper 5 及更高版本**可让您从名为“检查结果”的单个工具窗口查看所有 ReSharper 代码亮点——代码质量问题、冗余、语言使用机会和代码改进建议。这比逐个浏览代码文件以查找和删除问题要容易得多。
> 
> 要显示此工具窗口，请选择 Inspect | 解决方案或检查中的代码问题 | ReSharper 菜单上当前项目中的代码问题。或者，在解决方案资源管理器中选择一个节点，右键单击它，然后选择查找代码问题。

它似乎是仅在 ReSharper 5+ 中可用的新功能。

# soapui - SOAPUI - REST 请求多部分/混合 - 如何添加附件

> ID：14759367
> 
> 赞同：1
> 
> 时间：2013-02-07T19:28:44.150
> 
> 标签：soapui, multipart, mixed

我正在尝试测试 RESTful 服务，该服务配置为使用soapui 工具使用多部分/混合。

```
@POST
@Path("requestXmlAndAttachment")
@Consumes({ "multipart/mixed" })
@Produces({ MediaType.APPLICATION_XML })
public ResponseTO processRequestXmlAndAttachment(final       com.sun.jersey.multipart.MultiPart     multiPartRequest) {
 // application logic 
```

}

在 SOAPUI 中，我设置了 REST 资源并添加了 2 个参数，第一个文件指向请求 xml，第二个文件包含数据（我从下拉列表中选择了 PLAIN 样式）。

```
File1       file:request.xml
File2       file:datafile.xls 
```

在 SOAPUI 请求编辑器窗口中，我选择了 multipart/mixed 作为媒体类型。当我向服务器提交请求时，我没有看到文件被附加到请求中。以下是可以在服务器日志中查看的内容：

```
Feb 7, 2013 1:36:58 PM com.sun.jersey.api.container.filter.LoggingFilter filter
INFO: 56 * Server in-bound request
56> POST http://localhost:7001/myservice/requestXmlAndAttachment
56 > Accept-Encoding: gzip,deflate
56 > Content-Type: multipart/mixed
56 > Content-Length: 0
56 > Host: localhost:7001
56 > Connection: Keep-Alive
56 > User-Agent: Apache-HttpClient/4.1.1 (java 1.5)
56 > 
```

如您所见，Content-Length 为 0。
我已经能够从 java junit 程序测试此服务。这是程序的一部分：

```
BodyPart bp1 = new BodyPart();
bp1.setEntity(requestXMLString);
bp1.setMediaType(MediaType.APPLICATION_XML_TYPE);

BodyPart bp2 = new BodyPart();
bp2.setContentDisposition(ContentDisposition.type("file").fileName("datafaile.xls").build  ());
bp2.setEntity(binaryData1);
bp2.setMediaType(MediaType.APPLICATION_OCTET_STREAM_TYPE);

MultiPart multiPart = new MultiPart().bodyPart(bp1).bodyPart(bp2);

ClientConfig cc = new DefaultClientConfig();
cc.getClasses().add(MultiPartWriter.class);
Client client = Client.create(cc);
WebResource webResource = client.resource ("http://localhost:7001/myservice/requestXmlAndAttachment");
ClientResponse response = webResource.type(new MediaType("multipart", "mixed")).post(ClientResponse.class, multiPart); 
```

我还尝试在 SOAP UI 请求编辑器框中将媒体类型更改为 multipart/formdata（只是为了试验），然后我可以看到 Content-Length = 30654 并且我看到在服务器日志上读取的文件内容。

我还尝试在请求中添加 http 标头（MIME-Version 等），但没有任何区别。

虽然我可以在没有 SOAPUI 的情况下进行单元测试，但我更愿意让这个测试与 SOAPUI 一起工作，因为我已经在 soapui 中设置了许多其他测试，在同一服务中执行不同的方法。

无论如何使用 SOAP UI 来测试多部分/混合附件？
提前感谢您的调查。

# html - 绝对定位和百分比高度

> ID：14759369
> 
> 赞同：0
> 
> 时间：2013-02-07T19:28:48.637
> 
> 标签：html, css, height, css-position

请参考[http://jsfiddle.net/A2Qnx/1/](http://jsfiddle.net/A2Qnx/1/)

```
<div id='w'>
   <div id='p'>
       <div id='c'>
       </div>
   </div>
</div> 
```

当绝对定位打开时，div P 的高度为 60px（50 来自父级 + 10 来自 padding）。

现在，如果您关闭绝对定位，div P 和 div W 将具有相同的 110px 高度（100 来自子级 + 10 来自填充）。

有人可以向我解释这里发生了什么吗？

1）当绝对定位打开时，为什么 P 从父级的最小高度而不是子级的高度取其 100% 的高度？（为什么填充只适用于 P？）

2）当绝对定位关闭时，为什么 P 取其 100% 高度来自子代而不是父代的最小高度？（为什么填充只适用于 P 和 W？）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-07T19:53:53.117

填充仅用于`#p`...

至于高度，绝对定位使元素脱离正常流程。高度 o 100% 使该元素占据任何父级的完整高度，其位置不是静态的（如果没有找到，则为主体）。由于它不在流中，因此该`#w`元素实际上没有任何元素，因此它恢复到其最小高度。

# javascript - 在 asp.net 中的 onfocus__doPostBack 之后保持焦点

> ID：14759370
> 
> 赞同：0
> 
> 时间：2013-02-07T19:28:49.870
> 
> 标签：javascript, asp.net, vb.net, visual-studio-2010

当用户单击文本框时，我必须执行服务器端事件。到目前为止，我可以使用 onfocus 事件来管理调用 javascript 函数，但是如果我尝试删除 onfocus，执行一些代码，将焦点放回控件上，然后它会在无限循环中再次触发 onfocus 事件。下面的示例...

html

```
<asp:TextBox ID="TextBox1" runat="server" AutoPostBack="True" onfocus="CallServer(this);"></asp:TextBox>
<asp:TextBox ID="TextBox2" runat="server" AutoPostBack="True" onfocus="CallServer(this);"></asp:TextBox> 
```

Javascript

```
function CallServer(obj) {
  if (obj != "") {
    var control = document.getElementById(obj.id)
    __doPostBack(obj.id, "onfocus");
  }
} 
```

代码隐藏

```
Protected Sub Page_Load(ByVal sender As Object, ByVal e As System.EventArgs) Handles Me.Load

   If IsPostBack Then
      Dim target As String = Page.Request.Params.Get("__EVENTTARGET")
      Dim eventarg As String = Page.Request.Params.Get("__EVENTARGUMENT")
      Dim PostControl As Control = Nothing

      If target <> "" Then
         PostControl = Page.FindControl(target)
      End If

      If eventarg = "onfocus" Then
         CType(PostControl, TextBox).Attributes("onfocus") = "null"

         ...do some code

         Page.SetFocus(PostControl)

         CType(ctrl, TextBox).Attributes.Add("onfocus", "CallServer(this)")
      End If
   End If

End Sub 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-12-18T13:51:23.093

您可以通过使用 Page_PreRender 中的 ScriptManager.SetFocus 来完成此操作。在这种情况下，ScriptManager 位于 MasterPage 中。

```
Private Sub Page_PreRender(sender As Object, e As System.EventArgs) Handles Me.PreRender

    If HiddenFieldPostBackControl.Value <> "" Then
        Dim PostBackControl As Control = FindControlById(HiddenFieldPostBackControl.Value)
        If PostBackControl IsNot Nothing Then
            Dim sm As ScriptManager = ScriptManager.GetCurrent(Master.Page)
            sm.SetFocus(PostBackControl )
        End If
    End If

End Sub 
```

注意：如果您正在使用动态控件（必须在每次回发时重新创建），则必须在将事件添加到其他控件时删除目标控件的 (OnFocus of OnFocusIn) 事件。这必须在 Page_PreRender 之前完成。

```
function ControlOnFocus(ctrl, request, doc, min, max, docSec) {
        if (ctrl != "") {
            var hf = document.getElementById("MainContent_HiddenFieldPostControl").value = ctrl.id;
            var c = document.getElementById(ctrl.id);
            PostControl = ctrl;

            //ONFOCUS
            if (request.toLowerCase() == 'server') {
                //SERVER Handler
                __doPostBack(ctrl.id, "onfocus");
            } else {
                //CLIENT Handler
                //Your code here...
            }

            ReAssignEvent(ctrl.id);

            var hf = document.getElementById("MainContent_hfValidated");
            hf.innerText = "";
        };
    };
 function ReAssignEvent(ControlID) {
        //loop through an array with (id,onfocus event) for each control
        //this array is only required for the focus event

        for (var i = 0; i < FocusArray.length; i++) {

            var carr = FocusArray[i].split("[1]"); //split the element to get id and event
            var carrId = carr[0]; //get the id
            var c = document.getElementById(carrId); //find control and assign control to var
            var e = carr[1]; //assing event as string to var

            if (c != null) {
                if (ControlID!= carrId) {
                    if (c.type == "text" || c.type == "select-one") {
                        c.setAttribute("onfocus", e);
                    } else {
                        c.setAttribute("onfocusin", e);
                    }
                } else {
                    if (c.type == "text" || c.type == "select-one") {
                        c.removeAttribute("onfocus");
                    } else {
                        c.removeAttribute("onfocusin");
                    }
                }
            }

        }
 } 
```

# c - 数组下标不是整数题

> ID：14759375
> 
> 赞同：0
> 
> 时间：2013-02-07T19:29:40.560
> 
> 标签：c, arrays

嗨，我是 c 新手，以前从未遇到过这个错误，我有点困惑，因为我不相信我已经在我的程序中声明了任何 int，但是在喜欢 13、14、22、23、24、35 时, 和 40 我得到数组下标不是整数我的代码如下。

```
#include <stdio.h>

 int main(int argc, char const *argv[])
{
double mint[8];
double gum[8];
double count = 1.0,num,sum=0.0;

while(count <= 8)
{
    printf("please enter a number");
    scanf("%d",&num);
    mint[count]=num;
    printf("%d\n",mint[count] );
    count++;
}

count = 1;

while(count<=8)
{
    sum += mint[count];
    gum[count] = sum;
    printf("%d\n",gum[count] );
    count++;
}

count = 1.0;
sum = 1.0;

while(count<=8)
{
    while(sum<=8)
    {
        printf("%d",mint[sum] );
        sum++;
        if (sum==8)
            printf("\n");
    }
    printf("%d",gum[count] );
    count++;
}

return 0;
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-07T19:31:05.607

你不能用一个`double`值来索引一个数组。`count`例如，如果是 2.4 怎么办？

因此，您必须使用整数（`int`例如）。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-07T19:30:50.400

```
scanf("%d",&num); 
```

`d`期望指针`int`不是指向 的指针`double`。如果`lf`参数是指向`double`.

同样适用于`printf`：

```
printf("%d\n",mint[count] ); 
```

`d`期望一个`int`不是`double`。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-07T19:32:07.420

你有

```
double count = 1.0 
```

然后

```
mint[count]=num; 
```

您不能将索引放入双精度数组 - 必须是整数

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-07T19:32:18.620

您得到的错误是指您使用`double`type 来访问数组：

```
mint[count] 
```

`count`一个在哪里`double`。

使`count`和`sum`是`int`摆脱警告。

正如其他回答者所指出的 - 您的程序还有其他几个问题。您可能想在某个地方查看初学者教程。

# javascript - javascript - 检查用户名的第一个字符

> ID：14759378
> 
> 赞同：-1
> 
> 时间：2013-02-07T19:29:48.247
> 
> 标签：javascript, html

英语不是我的主要语言，所以我会尽力解释自己......我需要使用javascript检查用户输入用户名的第一个字母，看看它是否在 AZ 或 az 之间。如果不是，它将删除用户输入的字符串。为什么代码不起作用？

```
function UsernameRegisterVaildation()
{
    var username = document.getElementById("usernameRegister");
    var x = false;
    var y = false;
    if (x.CharAt(0) >= 'A' && x.CharAt(0) <= 'Z')
        x = true;

    if (y.CharAt(0) >= 'a' && y.CharAt(0) <= 'z')
        y = true;

    if (!x || !y)
    {
        alert("WRONG USERNAME");
    }
} 
```

这是输入：

```
 Username: <input type="text" id="usernameRegister" name="UserNameRegister" onchange="UsernameRegisterVaildation();"/> 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-07T19:31:31.553

是`charAt`，不是`CharAt`。此外，您还获得了对包含用户名的元素的引用，而不是用户名本身 - 获取`value`属性。

不过，您也可以只使用一个正则表达式：

```
if(!/^[a-z]/i.test(username.value)) {
    ...
} 
```

# optimization - 在 Erlang 中是否优化了别名函数

> ID：14759380
> 
> 赞同：3
> 
> 时间：2013-02-07T19:29:57.130
> 
> 标签：optimization, compiler-construction, erlang

假设我有一个从模块导出的函数，但模块多次使用该函数。

所以我写了一个别名，因为我在编码时很懒惰。

```
-export([get_toolkit/0]).

get_toolkit() -> 
    ... code ... code ... 
    ... code ... code ... 
    ... code ... code ... 
    {ok, Thing}.

tk() -> get_toolkit(). 
```

编译器是否优化别名？

谢谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-07T22:11:59.273

我认为这将花费您一次间接费用。我这样说是因为我拿了这个代码

```
-module(testit).
-export([get_toolkit/0, long/0, short/0]).

get_toolkit() -> 
    _ = lists:seq(1,100),
    {ok, thing}.

tk() -> 
   get_toolkit().

long() ->
    get_toolkit(),
    {ok, thing2}.

short() ->
    tk(),
    {ok, thing3}. 
```

并通过 erlc -S testit.erl 生成了 ASM，这给了我

```
SNIP

{function, tk, 0, 4}.
  {label,3}.
    {line,[{location,"testit.erl",8}]}.
    {func_info,{atom,testit},{atom,tk},0}.
  {label,4}.
    {call_only,0,{f,2}}.

{function, long, 0, 6}.
  {label,5}.
    {line,[{location,"testit.erl",11}]}.
    {func_info,{atom,testit},{atom,long},0}.
  {label,6}.
    {allocate,0,0}.
    {line,[{location,"testit.erl",12}]}.
    {call,0,{f,2}}.
    {move,{literal,{ok,thing2}},{x,0}}.
    {deallocate,0}.
    return.

{function, short, 0, 8}.
  {label,7}.
    {line,[{location,"testit.erl",15}]}.
    {func_info,{atom,testit},{atom,short},0}.
  {label,8}.
    {allocate,0,0}.
    {line,[{location,"testit.erl",16}]}.
    {call,0,{f,4}}.
    {move,{literal,{ok,thing3}},{x,0}}.
    {deallocate,0}.
    return. 
```

*   snip-it 中列出的第一个函数是“速记”函数，tk/0。
*   第二个是调用get_toolkit/0的长函数，
*   第三个是使用 tk/0 简写的简写函数

ASM 显示最后一个函数（使用 tk/0 的函数）调用 tk/0 ({call, 0, {f, 4}})，后者又调用 get_toolkit/0 ({call, 0, {f,2 }}）。使用 get_toolkit/0 的函数直接调用 get_toolkit/0 ({call, 0, {f,2}})。

所以，我认为没有应用优化。

另外，我做了一些时间测试，似乎支持这个假设；）

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-11T21:56:18.503

（无法发表评论，因此必须将其包含在附加答案中...）

作为替代方案，您可以通过添加以下内容来告诉编译器内联函数：

```
-compile({inline,[tk/0]}). 
```

那么这个

```
{function, get_toolkit, 0, 2}.
...
{function, tk, 0, 4}...
    {call_only,0,{f,2}}.
...
{function, short, 0, 8}...
    {call,0,{f,4}}.
... 
```

会变成

```
{function, get_toolkit, 0, 2}.
...
{function, short, 0, 6}...
    {call,0,{f,2}}. 
```

这完全消除了该`tk/0`函数，因为它没有被导出并且内联代码直接调用`get_toolkit`.

这记录在[http://www.erlang.org/doc/man/compile.html的](http://www.erlang.org/doc/man/compile.html)**Inlining**部分。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-07T19:31:22.260

取决于您所说的优化是什么意思。一般来说，编译器会在运行时优化它知道模块和函数名称的调用，特别是如果函数在同一个模块中，所以我倾向于说是。

# android - 找出所需权限的来源

> ID：14759382
> 
> 赞同：0
> 
> 时间：2013-02-07T19:30:02.290
> 
> 标签：android, mono, xamarin.android

我刚刚意识到我的 Mono for Android 应用程序需要 INTERNET 权限，尽管我没有在我的 Mono Develop 项目设置中设置它。我猜它来自我的项目通过 [UsesPermission] 属性（[http://docs.xamarin.com/android/releases/Mono_For_Android_4/Mono_For_Android_4.0.0](http://docs.xamarin.com/android/releases/Mono_For_Android_4/Mono_For_Android_4.0.0)）引用的库之一。

但是，乍一看，我无法通过 Mono Develop 项目浏览器在引用的库中找到任何此类属性。有什么简单的方法可以找出导致需要许可的原因吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-08T10:24:08.073

如果您查看`AssemblyInfo.cs`标准 Mono for Android 模板，则会出现以下几行：

```
// Add some common permissions, these can be removed if not needed
[assembly: UsesPermission(Android.Manifest.Permission.Internet)]
[assembly: UsesPermission(Android.Manifest.Permission.WriteExternalStorage)] 
```

这也可能是为您的项目添加额外权限的罪魁祸首。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-07T19:37:24.083

[我刚刚在https://stackoverflow.com/a/5792869/292233](https://stackoverflow.com/a/5792869/292233)的评论中读到Mono for Android 将 INTERNET 权限添加到所有调试版本以启用调试。在 Release 中，它消失了。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-14T14:32:03.777

添加它们的另一种方法是通过项目文件。右键单击项目，选择属性。然后单击 Android Manifest 选项卡。（如果您的项目还没有`AndroidManifest.xml`文件，您可以单击“添加 AndroidManifest.XML”按钮）。您将看到 Android 中所有可能权限的可滚动列表。单击您的应用程序应该请求的那些。

您可以参考[Xamarin 网站上的此文档以](http://docs.xamarin.com/node/18768)获取整个过程的一些屏幕截图。

# openscenegraph - 来自 ARtoolkit 标记的翻译数据

> ID：14759386
> 
> 赞同：0
> 
> 时间：2013-02-07T19:30:31.777
> 
> 标签：openscenegraph, artoolkit

您将如何使用 ARToolKit 从标记中获取翻译数据？

我知道 ARToolkit 可以为您提供转换矩阵，但我很难获得平移运动。

例如，当我将标记向右移动时，我在屏幕上绘制的对象也会向右移动。但是，我不想在标记上绘制对象，因为它将使用 OpenSceneGraph 在场景中呈现。目的是尝试创建一个虚拟环境，并在不使用太多键盘交互的情况下与之交互。当然，标记数据将通过网络摄像头获得。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-08T01:18:18.257

好吧，如果 ARToolkit 给你一个 osg::Matrix （或可以变成一个），你可以尝试分解它： [http ://www.openscenegraph.org/documentation/OpenSceneGraphReferenceDocs/a00403.html#b4a03cf47d938467121d0560d8284c6e](http://www.openscenegraph.org/documentation/OpenSceneGraphReferenceDocs/a00403.html#b4a03cf47d938467121d0560d8284c6e)

并从中获得您想要的翻译。

# php - PHP中的数组碎片

> ID：14759395
> 
> 赞同：-4
> 
> 时间：2013-02-07T19:30:56.923
> 
> 标签：php, arrays

我有这样的数组：

```
array(8) {
  ["2013-01-02"]  =>  27.62,
  ["2013-01-03"]  =>  27.25,
  ["2013-01-04"]  =>  26.74,
  ["2013-01-07"]  =>  26.69,
  ["2013-01-08"]  =>  26.55,
  ["2013-01-09"]  =>  26.70,
  ["2013-01-10"]  =>  26.46,
  ["2013-01-11"]  =>  26.83
} 
```

我想找到 n 的所有变化。

例如 n=3 的结果：

```
array(6) {  
  array(3) {
    ["2013-01-02"]  =>  27.62,
    ["2013-01-03"]  =>  27.25,
    ["2013-01-04"]  =>  26.74    
  }
  array(3) {
    ["2013-01-03"]  =>  27.25,
    ["2013-01-04"]  =>  26.74,
    ["2013-01-07"]  =>  26.69
  }
  array(3) {
    ["2013-01-04"]  =>  26.74,
    ["2013-01-07"]  =>  26.69,
    ["2013-01-08"]  =>  26.55
  }
  array(3) {
    ["2013-01-07"]  =>  26.69,
    ["2013-01-08"]  =>  26.55,
    ["2013-01-09"]  =>  26.70
  }
  array(3) {
    ["2013-01-08"]  =>  26.55,
    ["2013-01-09"]  =>  26.70,
    ["2013-01-10"]  =>  26.46
  }
  array(3) {
    ["2013-01-09"]  =>  26.70,
    ["2013-01-10"]  =>  26.46,
    ["2013-01-11"]  =>  26.83
  }
} 
```

如何在 PHP 中轻松做到这一点？

就是这样，但没有这个我不能提交：在计算机科学中，关联数组、映射或字典是由（键、值）对的集合组成的抽象数据类型，这样每个可能的键最多出现一次在集合中。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-07T19:33:42.313

使用您的旧数组并通过对 的各种调用构建一个新数组[`array_slice()`](http://php.net/array_slice)，如下所示：

```
$new_array = array();
$n = 3;
$size = count( $old_array) - $n; // Assumes you have at least $n elements, should check for this
for( $i = 0; $i <= $size; $i++) {
    $new_array[] = array_slice( $old_array, $i, $n);
} 
```

一个`print_r( $new_array);`产量：

```
Array
(
    [0] => Array
        (
            [2013-01-02] => 27.62
            [2013-01-03] => 27.25
            [2013-01-04] => 26.74
        )

    [1] => Array
        (
            [2013-01-03] => 27.25
            [2013-01-04] => 26.74
            [2013-01-07] => 26.69
        )

    [2] => Array
        (
            [2013-01-04] => 26.74
            [2013-01-07] => 26.69
            [2013-01-08] => 26.55
        )

    [3] => Array
        (
            [2013-01-07] => 26.69
            [2013-01-08] => 26.55
            [2013-01-09] => 26.7
        )

    [4] => Array
        (
            [2013-01-08] => 26.55
            [2013-01-09] => 26.7
            [2013-01-10] => 26.46
        )

    [5] => Array
        (
            [2013-01-09] => 26.7
            [2013-01-10] => 26.46
            [2013-01-11] => 26.83
        )

) 
```

# php - 解码西里尔文网址

> ID：14759398
> 
> 赞同：1
> 
> 时间：2013-02-07T19:31:02.367
> 
> 标签：php, url, decode

例如，我必须有帖子名称，`%d0%b0%d1%80%d1%85%d0%b8%d0%b2`是否`АРХИВ`可以将此代码解码为普通单词？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-07T19:35:07.317

简单的：

```
echo urldecode('%d0%b0%d1%80%d1%85%d0%b8%d0%b2'); //=архив 
```

# css - CSS：仅当有两个类时才悬停

> ID：14759402
> 
> 赞同：6
> 
> 时间：2013-02-07T19:31:05.963
> 
> 标签：css, hover

我试图仅在将两个不同的类附加到 div 时应用 CSS :hover 选择器。我试过这个，但这摆脱了悬停效果。

```
.accordionButton .cyan:hover{
    color: cyan;    
} 
```

我也不能这样做：

```
.accordionButton:hover, .cyan:hover{
    color: cyan;    
} 
```

因为我还有另外两种颜色，我也在尝试这样做。

基本上，有没有办法让 CSS 只在一个 .accordionButton 和一个 .cyan 的 div 上悬停时才应用？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2013-02-07T19:32:55.590

您可以通过在没有空格的情况下链接它们来组合类选择器。
在下面的示例中，`:hover`声明仅适用于具有*两个*类的元素：

```
.accordionButton.cyan:hover {
  color: cyan;
}
```

```
<div class="accordionButton">Only Button</div>
<div class="cyan">Only Cyan</div>
<div class="accordionButton cyan">Both Classes</div>
```

作为参考，请参阅 MDN：
[如果应用了多个类，则定位一个元素](https://developer.mozilla.org/en-US/docs/Learn/CSS/Building_blocks/Selectors/Type_Class_and_ID_Selectors#Target_an_element_if_it_has_more_than_one_class_applied)。

> 您可以将多个类应用于元素，并且...仅在选择器中的所有类中选择元素。
> 
> 我们可以告诉浏览器我们只想匹配具有所有这些类的元素，方法是将它们链接在一起并且它们之间没有空格。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-07T19:36:49.147

如果您在选择器中的类之间放置空格，就像您所做的那样，那将选择所有具有 class 的元素，这些元素是具有 class`cyan`的元素的后代`accordionButton`。如果要引用相同的元素，请删除空格。

# c - C - 具有不同值的变量

> ID：14759404
> 
> 赞同：-1
> 
> 时间：2013-02-07T19:31:15.140
> 
> 标签：c

我的代码有问题。此代码的目的是计算邻居数并根据选项修改数组。经过多次测试，我观察到请求 : `nbVoisins = nb_voisins_M(tab, i, j, n, m);`(who couting neightbors) 和后面的行`if(nbVoisins = b)`没有相同的值；而且我不明白为什么...

```
int i, j, k, nbVoisins; int b = 0;int s = 0;

for(i=0; i<n; i++)
{
    for(j=0; j<m; j++)
    {
    nbVoisins = nb_voisins_M(tab, i, j, n, m);
        if(tab[i][j]==1)
        {
            for(k=0; k<9; k++)
            {
                if(S[k]==1)
                {
                    s = k+1;
                    //printf("tab[%d][%d] : nbVoisins = %d et s = %d \n",i,j,nbVoisins,s);
                    if(nbVoisins == s)
                    {
                        tab2[i][j]=1;
                        printf("= %d",tab2[i][j]);
                    }
                    else
                    {
                        tab2[i][j]=0;
                    }
                }
            }
        }
        else
        {
            for(k=0; k<9; k++)
            {
                if(B[k]==1)
                {
                    b = k+1;
                }
                if(nbVoisins == b)
                {
                    tab2[i][j]=1;
                }
            }
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-07T19:32:17.557

如果我有一个镍...

```
if(nbVoisins == b) 
```

因为，

```
 if(nbVoisins = b) 
```

将赋值`b`to `nbVoisins`，然后检查是否`nbVoisins`等于 0，它不会**比较** `b`和`nbVoisins`是否相等。

体面的编译器应该为此[发出警告](http://msdn.microsoft.com/en-us/library/7hw7c1he%28v=vs.80%29.aspx)，因此请注意警告 - 它应该被列出。

# android - 覆盖 Android 中的常规粘贴上下文菜单

> ID：14759409
> 
> 赞同：1
> 
> 时间：2013-02-07T19:31:29.363
> 
> 标签：android, contextmenu, clipboard, paste

我认为这是不可能的，但我认为最好问问肯定知道答案的人。

是否可以创建一个影响所有应用程序中的上下文菜单的 android 应用程序，以便当用户长按编辑文本视图时，不仅粘贴选项可见，而且我的自定义粘贴功能也可见？

我想要做的是让用户可以轻松地从我的应用程序中导入文本，而无需离开他们正在使用的应用程序。我想到的一件事是创建一个服务来同时监听音量上下时间并将我的文本字符串复制到剪贴板。用户还必须使用普通粘贴功能。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-07T19:37:16.083

你不能。上下文菜单在每个应用程序中定义，您不能（也不应该）从另一个应用程序更改其他应用程序的行为。

尽管此类功能可能有有效的用例，但总的来说这是一个坏主意。

# jquery - 选择某些元素组

> ID：14759411
> 
> 赞同：1
> 
> 时间：2013-02-07T19:31:31.350
> 
> 标签：jquery, html, css, css-selectors

我的网页中有一些分组`<li>`标签，如下所示。

```
<ul id="dg">
   <!-- group-1 -->
   <li data-group="one">....</li>
   <li data-group="one">....</li>
   <li data-group="one">....</li>
   <li data-group="one">....</li>

   <!-- group-2 -->
   <li data-group="two">....</li>
   <li data-group="two">....</li>

   <!-- group-3 -->
   <li data-group="three">....</li>

   <!-- group-4 -->
   <li data-group="four">....</li>
   <li data-group="four">....</li>
   <li data-group="four">....</li>
</ul> 
```

同样，我有大约 20 个（其动态的）`<li>`标签组，它们使用“数据组”进行分类。每个类别都有不同数量的`<li>`标签。

我想要做的是，我想选择每第 4 个组（数据组）并`<li>`使用 jQuery 向其所有标签添加一个名为“edge”的 CSS 类，或者使用 nth 添加一个 CSS 属性。

请帮我解决这个问题。

谢谢并恭祝安康

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-07T19:34:01.133

**更新**

您不能简单地使用选择器。您必须遍历所有您的`li`并推断它们是否属于您想要的组

```
var currentGroup = ""; //Name of the group currently checked 
var counter = 0; //Number of group found

//Loop through the items
$('#dg li').each(function(){
    //Check if we are checking a new group
    if(currentGroup != $(this).attr('data-group'))
    {
        //If yes, save the name of the new group
        currentGroup = $(this).attr('data-group');
        //And increment the number of group found
        counter++;
    }

    //If the number of the group is a multiple of 4, add the class you want
    if((counter % 4) == 0)
        $(this).addClass('edge');
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-07T19:34:27.553

所以像：

```
$('li[data-group="four"]').each(function(){
    $(this).addClass('edge');
}); 
```

你是这个意思吗？

所以更像：

```
function processItems(items){
    items.each(function(){
        $(this).addClass('edge');
    });
}
processItems($('li[data-group="four"]'));
processItems($('li[data-group="eight"]'));
processItems($('li[data-group="twelve"]')); 
```

`li`我不知道性能提升或做类似的事情，但是根据列表中它们的数量，循环遍历每个项目可能会很糟糕而且很慢。不是说我在这里是最好的方法，但是如果你有数百个 li 项目，你的循环可能会运行得很慢。

# c++ - sockaddr_in 中的 sin_port

> ID：14759415
> 
> 赞同：0
> 
> 时间：2013-02-07T19:31:41.287
> 
> 标签：c++, c, linux, posix

如果我需要获取 IP 的主机名，我应该使用哪个端口？getnameinfo() 从哪里获取主机名？

```
struct sockaddr_in sa;
sa.sin_family    = AF_INET;
sa.sin_port    = htons(?); // which port ?
inet_pton(AF_INET, "x.x.x.x", &(sa.sin_addr));

char host[NI_MAXHOST];
getnameinfo((struct sockaddr *)&sa, sizeof(sa), host, NI_MAXHOST, NULL, 0, NI_NAMEREQD);

puts(host); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-07T19:38:35.457

如果不使用`serv`and`servlen`参数，则端口号无关紧要。否则，它用于通过端口号查找*服务*`"ssh"`，例如端口 22、`"smtp"`端口 25 等（更多信息请参阅`/etc/services`）。

`getnameinfo()`可以从许多地方获取主机名（使用，可以为不同类型的名称解析启用`nsswitch.conf`其他模块）。`libnss`在典型的桌面 linux 发行版上，我希望它首先查看`/etc/hosts`，然后根据`/etc/resolv.conf`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-07T19:53:48.630

来自[http://www.kernel.org/doc/man-pages/online/pages/man3/getnameinfo.3.html](http://www.kernel.org/doc/man-pages/online/pages/man3/getnameinfo.3.html)：

> sa 参数是指向包含输入 IP 地址和端口号的大小为 salen 的通用套接字地址结构（类型为 sockaddr_in 或 sockaddr_in6）的指针。参数 host 和 serv 是指向调用者分配的缓冲区（大小分别为 hostlen 和 servlen）的指针，getnameinfo() 将分别包含主机名和服务名的以 null 结尾的字符串放入其中。
> 
> 调用者可以通过提供 NULL host（或 serv）参数或零 hostlen（或 servlen）参数来指定不需要主机名（或不需要服务名）。但是，必须至少请求主机名或服务名之一。

因此，如果您只对主机名感兴趣，请不要为服务名称提供缓冲区。

关于这个问题的来源，我会听从其他人的意见，但如果你好奇的话，代码就在 glibc 中。

# javascript - 带鼠标移出的 ImageMap

> ID：14759419
> 
> 赞同：0
> 
> 时间：2013-02-07T19:31:55.407
> 
> 标签：javascript, mouseover, mouseout

[嗨](http://projectpano.netii.net/imagemaper.html)，我曾经问过这个问题，但没有得到答案一个 onmouseover onmouseout 事件.. 但我不能做的就是在右边进行显示，即使我像这样的热点鼠标退出例如[http://31pennplaza.com/avail.html#](http://31pennplaza.com/avail.html#)

请参阅我的源页面，请帮助我使用新的脚本！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-07T20:01:33.353

我无法查看您的示例，因此我将做出一些假设。

您的热点可能是定位的 div（或其他一些元素），并且它们每个都应该具有唯一的 DOM ID。

我相信您希望每当您将鼠标悬停在新热点上时右侧的图像都会更新，并且您希望该图像一直保留在那里，直到您将鼠标悬停在另一个热点上。mouseOut 事件不应影响右侧的图像。

假设您的热点声明如下：

```
<div id="hotspot_1" class="hotspot"></div>
<div id="hotspot_2" class="hotspot"></div>
...
<div id="hotspot_5" class="hotspot"></div> 
```

您在右侧更新的图像是：

```
<img id="floor_detail" src="images/floor_detail.jpg" /> 
```

并且当您翻转热点时要显示的图像具有以下路径：

```
images/hotspot_1_detail.jpg
images/hotspot_2_detail.jpg
...
images/hotspot_5_detail.jpg 
```

您可以使用 jQuery 配置行为。您不需要 mouseOut 事件侦听器，因为听起来您希望细节图像保持其状态，直到观察到另一个 mouseOver。

jQuery：

```
<script>
  $(document).ready(function(){
    $(".hotspot").live("mouseover", function() {
      $("#floor_detail").attr("src", "images/" + $(this).attr("id") + "_detail.jpg");
    });    
  });
</script> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-07T21:40:56.037

简单的答案：删除你的 onMouseOut 处理程序。对于您指定的行为，您不需要它们。

# angularjs - AngularJS 在销毁 $scope 时不会删除 $scope.$on

> ID：14759421
> 
> 赞同：0
> 
> 时间：2013-02-07T19:32:03.647
> 
> 标签：angularjs

我有一个用 AngularJS 构建的简单应用程序：

```
var App = angular.module('myApp', [], function($window) {
  // settings..
}).run(function($rootScope){
   $(window).on('resize', function(event) {
        $rootScope.$broadcast('windowResize',{
            height: event.target.innerHeight,
            width: event.target.innerWidth
        });
    });
}); 
```

我有一个`panel`带有以下控制器的指令：

```
function($scope, $element) {    
    var
        $title = $element.find('.panel-title'),
        $content = $element.find('.panel-content'),
        margin = 20
    ;
    $content
        .height($(window).height() - $title.height() - margin);

    $scope.$on('windowResize', function(obj) {
        var height = obj.height - $title.height()  - margin;
        $content.height(height);
    });
} 
```

一切都在第一次完美运行。但是，当控制器更改时，我会遇到类似`TypeError: Cannot read property '$$childHead' of null`的问题，但我会收到错误消息。

问题出在`$scope.$on`. 如何在销毁 $scope 之前删除它（当控制器更改时）？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2014-06-01T15:05:26.507

该`$on`函数返回一个注销函数。因此，您可以将该函数存储在一个变量中，然后在需要注销事件时调用该函数。

```
var deregisterWindowResize = $scope.$on('windowResize', function callback(args){...});

$scope.$on('$destory', deregisterWindowResize); 
```

更多信息[在这里](http://code.angularjs.org/1.2.16/docs/api/ng/type/%24rootScope.Scop)

* * *

如果您需要经常使用它，您可以创建一个功能/服务，如下所示。

```
function weakBind(scope, eventName, callback){
    var deregister = scope.$on(eventName, callback);
    scope.$on('$destroy', deregister);
    return deregister;
}

weakBind($scope, 'windowResize', function(obj) {
    var height = obj.height - $title.height()  - margin;
    $content.height(height);
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-07-18T21:11:16.007

您可以尝试挂钩 $destroy 事件，然后使用 .$off

例如：

```
var onWindowResize = function(obj) {
    var height = obj.height - $title.height()  - margin;
    $content.height(height);
});

$scope.$on('windowResize', onWindowResize);
$scope.$on('$destroy', function(){
    $scope.off('windowResize', onWindowResize);
}); 
```

# php - PDO 连接/准备并在函数中执行

> ID：14759429
> 
> 赞同：0
> 
> 时间：2013-02-07T19:32:13.720
> 
> 标签：php

我想我对下面的内容有点了解，我想做的是有一个 PDO 并在一个函数中调用准备和执行。

我试图在每个函数中使用 PDO 保存重复的代码。

如果有人能指出我正确的方向，那将是非常好的，也有任何建议，我目前正试图从文章中弄清楚这一切。然后下面给我调用一个非对象的成员函数prepare()...

**2个附加问题**

1.  我应该尝试执行和准备的功能吗，这是常见的做法吗？
2.  是否可以将 $db 放在一个函数中并在需要时调用它，以便我可以将模具放回原处？

非常感谢任何帮助。

```
ini_set('error_reporting', E_ALL);
ini_set('display_errors', 1);
ini_set('log_errors', 1);

$config['db'] = array(
    'host' => 'localhost',
    'username' => 'root',
    'password' => 'root',
    'dbname' => 'bhill');
$db = new PDO('mysql:host=' . $config['db']['host'] . ';dbname=' . $config['db']['dbname'],
    $config['db']['username'], $config['db']['password']);
try {
    $db->exec("SET CHARACTER SET utf8");
    //$db = null;
}
catch (PDOException $ex) {
    print "Error!: " . $ex->getMessage() . "<br/>";
    die();
}

function update($db, $fn, $ln, $email, $offers, $vlue, $responce)
{
    $stmt = $db->prepare("insert into kkt (fName_765, lName_765, email_765, signup_765, kkt_resp_765, kkt_respSate_765, stamp_765) values (:fname, :lname, :email, :signup, :kkt_rsp, :kkt_respState, NOW())");
    $stmt->bindParam(':fname', $fn, PDO::PARAM_STR);
    $stmt->bindParam(':lname', $ln, PDO::PARAM_STR);
    $stmt->bindParam(':email', $email, PDO::PARAM_STR);
    $stmt->bindParam(':signup', $offers, PDO::PARAM_STR);
    $stmt->bindParam(':kkt_rsp', $vlue, PDO::PARAM_STR);
    $stmt->bindParam(':kkt_respState', $responce, PDO::PARAM_STR);
    $stmt->execute();
    $stmt = null;
}

$fn = 'test';
$ln = 'test';
$email = 'tesst@test,com';
$offers = '1';
$vlue = 'value';
$responce = 'resp';

update($db, $fn, $ln, $email, $offers, $vlue, $responce); 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-07T19:34:13.780

你正在做：

```
$db = null; 
```

设置编码后。这基本上删除了实例。

# wpf - 自定义类的 Observablecollection 未更新

> ID：14759432
> 
> 赞同：0
> 
> 时间：2013-02-07T19:32:26.167
> 
> 标签：wpf, xaml, observablecollection

我正在使用 WPF 并有一个名为 eg 的自定义类。以这种方式使用的“CustomClass”是observablecollection。我们有一个绑定到这个 OC 的数据网格，它工作得很好，显示数据并且一切都很好，但是当 observablecollection 中的任何项目被更新时，底层网格不会相应地更新。

以前我们一直在直接使用实体数据模型中的类型创建 observablecollections，这很有效（显示/更新等），但在使用自定义类时却不行。

在我们的自定义类中是否有一个接口或我们应该支持的东西来允许更新发生？

谢谢。

詹姆士。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-08T13:10:36.277

`ObservableCollection`跟踪对集合的更改，而不是对集合内对象的更改。

要跟踪单个对象的更改，您需要使它们实现[INotifyPropertyChanged](http://msdn.microsoft.com/en-us/library/system.componentmodel.inotifypropertychanged.aspx)。

如果您想`CollectionChanged`在集合中的项目发生更改时引发事件，您必须自己添加该功能，如下所示：

```
public MyConstructor()
{
    MyObservableCollection = new ObservableCollection<MyItem>();
    MyObservableCollection.CollectionChanged += MyObservableCollection_CollectionChanged;
}

void MyObservableCollection_CollectionChanged(object sender, CollectionChangedEventArgs e)
{
    if (e.NewItems != null)
    {
        foreach(MyItem item in e.NewItems)
        {
            MyItem.PropertyChanged += MyItem_PropertyChanged;
        }
    }

    if (e.OldItems!= null)
    {
        foreach(MyItem item in e.OldItems)
        {
            MyItem.PropertyChanged -= MyItem_PropertyChanged;
        }
    }
}

void MyItem_PropertyChanged(object sender, PropertyChange e)
{
    RaisePropertyChanged("MyObservableCollection");
} 
```

# c - C、从单个scanf中读取多个数字

> ID：14759434
> 
> 赞同：0
> 
> 时间：2013-02-07T19:32:41.273
> 
> 标签：c, arrays, console, scanf

我有一个任务要求我进行一次 scanf 并对几个整数执行一些数学运算。输入中的第一个数字设置要跟随的整数的数量，即：3 45 67 18 应解释为 N var1 var2 var3，4 100 23 76 92 应解释为 N var1 var2 var3 var4。我无法按照我第一次迭代的指示制作程序，但它确实按预期工作。我通过简单地将scanf放在一个运行N次的循环中并将剩余的数字存储在数组n [1000]中来完成存储var1 var2 ... varN。就像我说的那样，该程序可以工作......有点，但它并没有按照任务指示的方式工作。作业提供的样本运行应该是：

```
Please enter n followed by n numbers: 3 6 12 17

Test case #1: 6 is NOT abundant.
Test case #2: 12 is abundant.
Test case #3: 17 is NOT abundant. 
```

我的程序输出是：

```
Please enter n followed by n numbers: 3
6
12
17
Test case #1: 6 is NOT abundant.
Test case #2: 12 is abundant.
Test case #3: 17 is NOT abundant. 
```

这是我的程序的[链接。](https://docs.google.com/file/d/0B7ybGmrBxaHQVmJiVFVPZFBuRE0/edit?usp=sharing)我已经阅读了许多类似的问题，但大多数似乎都忽略了 scanf 的使用，而不是其他从控制台捕获输入的方法。[这篇文章](https://stackoverflow.com/questions/10425953/how-to-read-numbers-separated-by-space-using-scanf)非常接近我正在寻找的答案，除了我需要动态设置的变量数量。我有一种感觉我需要使用 malloc 函数，但我只是不太确定如何使用它并且仍然完成单行 scanf 输入。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-07T19:50:44.867

好的，我对其进行了测试，您确实可以使用`scanf`.

```
#include<stdio.h>

int main(){
    int total = 0;
    int args;
    char newline;
    do{
        int temp; 
        args = scanf( "%d%c", &temp, &newline );
        if( args > 0 )
            total += temp;
        puts( "Internal loop print test");
    } while( newline != '\n' );
    printf( "\n\n%d", total );
    return 0;
} 
```

控制台日志：

```
1 2 3 9
Internal loop print test
Internal loop print test
Internal loop print test
Internal loop print test

15 
```

`scanf`编辑：由于几个已知的漏洞问题，我从不使用该系列，但我什至没有尝试使用`scanf`. 我以为它会读到换行符，但它与`scanf`. Aniket 的评论让我想尝试一下。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-07T21:24:28.370

以下代码对我有用：

```
#include <stdio.h>
#include <stdlib.h>

int main(void)
{
    int n[1000],i,j,sum,size;

    printf("Please enter n followed by n numbers: ");
    scanf("%d",&n[0]);

    for (i=1;i<=n[0];i++)
            scanf("%d",&n[i]);

        /* Debug: Automatically generate numbers from 1 to n[0] */
        //n[i]=i

    for (i=1;i<=n[0];i++)
    {
        /* Debug: See what numbers are being used in sum - Part 1*/
        //printf("\nFactors < %d of %d: ",n[i]/2,n[i]);
        sum=0;
        for (j=1;j<=n[i]/2;j++)
        {

            if (n[i]%j==0)
            {
                /* Debug: See what numbers are being used in sum - Part 2*/
                //printf("%d ",j);
                sum+=j;
            }

        }
        printf("Test case #%d: %d is%sabundant.\n",i,n[i],(sum>n[i])?" ":" NOT ");

        /* Debug: See what numbers are being used in sum - Part 3*/
        //printf("(%d)\n",sum);
    }
    system("PAUSE");    
    return 0;
} 
```

Aslai 您的回答让我感到困惑，因为它看不到您的代码将如何完成与我所做的不同的任何事情。因此，当我调试 scanf 返回的内容时，我注意到 scanf 实际上在每个空格之后返回，而不是像我想的那样在“enter”或“\n”上返回。所以我简化了我的第一个 for 循环，一切正常。那么我是否正确地说，只要有足够的后续对 scanf 的调用，来自一个 scanf 的输入将满足对后续 scanf 的变量分配？换句话说，如果我在单个 scanf 期间输入 3 25 17 ，那么我可以将这些数字中的每一个分配给随后的 scanf 调用的变量，而无需按 Enter 键？

```
scanf("%d",&var1); //(where var1=3)
scanf("%d",&var2); //(where var2=25) 
scanf("%d",&var3); //(where var3=17) 
```

# javascript - 当另一个 div 可见时显示 div

> ID：14759435
> 
> 赞同：0
> 
> 时间：2013-02-07T19:32:42.240
> 
> 标签：javascript, jquery

当计时器上的 div 出现以进行促销时，我正在尝试使隐藏的 div 可见。是可行的吗？如果问题不清楚，请告诉我，我可以尝试改写

这是我到目前为止的一些 Jquery

```
$('.specialSignup').css('display', 'none');
    if ( $('.homePromo').filter(':visible'){
        $('.specialSignup').css('display', 'block');
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-07T19:40:35.720

你用什么来显示第一个div？它是如何显示的？

在不了解所有信息的情况下，很难给出准确的答案，但是是的，这绝对是可能的。我假设 Javascript 正在切换可见性。

由于我假设使用 javascript，因此我敢打赌，触发可见性的任何东西都是从 div 中添加/删除 css 类。为了让 javascript 做到这一点，它需要找到需要切换的 div。它可能正在寻找与 div 关联的某个 id 或类。

尝试使第二个 div 具有相似的 id 或类，看看是否有帮助。

如果没有，我需要更多细节。即什么代码触发了 div 可见性。

编辑：

根据您发布的新代码，您的 if 语句缺少 end ）

应该是这样的：

```
$('.specialSignup').css('display', 'none');
if ( $('.homePromo').filter(':visible')){
    $('.specialSignup').css('display', 'block');
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-07T19:41:50.830

您可以使用以下方法检测显示属性：`$(element).is(":visible");`。应该与`.show()`和一起工作，`.hide()`因为`.toggle()`它们`display`不会影响`visibility`。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-07T19:39:53.847

没有任何附加信息..

当计时器超时时，触发事件或函数调用以显示隐藏层。

# java - Java：如何使用 URL.openConnection() 强制进行新的 SSL 握手？

> ID：14759442
> 
> 赞同：1
> 
> 时间：2013-02-07T19:32:56.123
> 
> 标签：java

客户端使用 aURL.openConnection() 进行多次调用，其中 URL 表示 HTTPS 地址，以将数据发送到服务器。从 Wireshark 捕获来看，似乎只为第一次发送执行了一次 SSL 握手。如何在每次发送时强制进行新的 SSL 握手？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-08T22:31:06.400

我发现最简单的方法是手动设置“连接：关闭”请求标头。

# specflow - 在 SpecFlow 中显式标记测试

> ID：14759443
> 
> 赞同：5
> 
> 时间：2013-02-07T19:32:57.410
> 
> 标签：specflow

有没有办法用“显式”属性标记 Specflow 测试？我知道可以通过使用特殊标签@ignore 将测试标记为“忽略”属性。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-08T14:33:18.343

也许。

如果你查看生成的 xxx.feature.cs，你会看到它被定义为

```
public partial class xxx{... 
```

因此，您可以将另一个文件添加到`xxx.partial.cs`包含部分定义的另一部分的项目中。

*这就是我所知道的结束，现在你也许可以做到。*

理论上，您可以使用部分类定义并对其进行修改，以使其抽象。然后你可以添加一个派生类来覆盖有问题的测试，这必须是`new`我们不能`virtual`在 xxx 中使用的，然后添加你的`[Explicit]`。

我不知道这是否可行。您可能会遇到抽象不采用的各种问题，或者派生类上的测试属性消失等问题。但也许它可能会让您继续前进。

PS我也不确定这是否接近良好的做法。:-)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2018-01-08T08:34:48.077

有一种更简单的方法可以做到这一点。

`Test Scenario`对于文件中的场景，`xxx.feature.cs`有一种方法`TestScenario()`。您可以将其标记为`[Explicit]`.

# python - Pyinstaller 没有拾取树或数据文件

> ID：14759444
> 
> 赞同：6
> 
> 时间：2013-02-07T19:32:58.250
> 
> 标签：python, pyinstaller

我正在尝试使用 pyinstaller构建一个*非常*`print 'hello world!'`基本的 python 脚本：并且我正在尝试使二进制文件可用的数据文件或数据文件目录。

我一遍又一遍地阅读文档，我尝试使用 1.5、2.0 和 2.0 的开发版本构建，我尝试使用 --onefile 和 --onedir 构建，我尝试在 OS X 和Linux，但由于某种原因，我的 .spec 文件中的数据文件/树语句似乎被忽略了。

以下是我尝试过的一些 .spec 文件变体：

```
coll = COLLECT(exe,
               a.binaries
               [('README','/Users/username/my_little_app/foo','DATA')],
               Tree('/Users/username/my_little_app/foo','foo'),
               Tree('/foo','foo'),
               Tree('my_little_app/foo','foo'),
               [('my_xml_file.xml','my_little_app/partner.xml','DATA')],
               a.zipfiles,
               a.datas,
               strip=None,
               upx=True,
               name=os.path.join('dist', 'my_little_app'))

a.datas += [('my_xml_file.xml', '/Users/username/my_little_app/my_xml_file.xml',  'DATA')] 
```

有什么我想念的吗？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2015-11-02T13:33:42.287

这个答案已经很晚了，但是将任意文件添加到 PyInstaller 构建的方法已经很清楚地记录在案：

[https://pyinstaller.readthedocs.io/en/stable/spec-files.html#adding-files-to-the-bundle](https://pyinstaller.readthedocs.io/en/stable/spec-files.html#adding-files-to-the-bundle)

元组中的第一个字符串是文件的路径，第二个字符串是它在构建包下的路径。换句话说，你的最后一行应该是这样的：

```
a.datas += [("/path/to/my_xml_file.xml", "my_xml_file.xml")] 
```

您还可以像这样添加完整目录：

```
a.datas += [("/path/to/dir", "dir")] 
```

我在下面添加了文档的相关部分。

* * *

# [将文件添加到捆绑包](https://pyinstaller.readthedocs.io/en/stable/spec-files.html#adding-files-to-the-bundle)

要将文件添加到包中，您需要创建一个描述文件的列表并将其提供给`Analysis`调用。

## [添加数据文件](https://pyinstaller.readthedocs.io/en/stable/spec-files.html#adding-data-files)

您提供一个将文件描述为 的`datas=`参数值的列表`Analysis`。数据文件列表是元组列表。每个元组有两个值，这两个值都必须是字符串：

*   第一个字符串指定当前系统中的一个或多个文件。
*   第二个指定运行时捆绑应用程序中文件的名称。

例如，要将单个 README 文件添加到单文件夹应用程序，您可以按如下方式修改规范文件：

```
a = Analysis(...
     datas=[ ('src/README.txt', 'README') ],
     hiddenimports=...
     ) 
```

您已将`datas=`参数设为单项列表。该项目是一个元组，其中第一个字符串表示现有文件是`src/README.txt`. 该文件将被复制到具有 name 的包中`README`。

如果您在单独的语句中创建添加的文件列表，则规范文件更具可读性：

```
added_files = [
     ( 'src/README.txt', 'README' )
     ]
a = Analysis(...
     datas= added_files,
     ...
     ) 
```

字符串可以使用`/`或`\`作为路径分隔符。您可以使用“glob”缩写指定输入文件。当输入是多个文件时，输出字符串可能是一个文件夹的名称。例如要包含`.mp3`某个文件夹中的所有文件：

```
added_files = [
         ( '/mygame/sfx/*.mp3', 'sfx' ),
         ( 'src/README.txt', 'README' )
         ] 
```

所有匹配的文件`/mygame/sfx/*.mp3`都将被复制到包中并存储在名为`sfx`.

输入文件或文件夹的路径可以是第一个元组中的绝对路径，也可以是第二个元组中的相对路径。当它是相对的时，它被认为是相对于规范文件的位置。

您还可以包含文件夹的全部内容：

```
added_files = [
         ( '/mygame/data', 'data' ),
         ( '/mygame/sfx/*.mp3', 'sfx' ),
         ( 'src/README.txt', 'README' )
         ] 
```

中的所有文件`/mygame/data`都将递归复制到`data`包中命名的文件夹中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2020-01-13T05:31:54.287

### 简单解释

根据最新的官方文档：[添加数据文件](https://pyinstaller.readthedocs.io/en/stable/spec-files.html#adding-data-files)，你的`spec`文件应该是这样的：

```
a = Analysis(xxx,
             pathex=xxx,
             binaries=[],
             datas=[
                ('README', '.'),
                ("/Users/username/my_little_app/my_xml_file.xml", "."),
                ('DATA', 'DATA'),

                ('/Users/username/my_little_app/foo', 'foo'),
                ("/path/to/dir", "dir"),
            ], 
```

### 详细解释

在另一篇文章中参考我的答案：[Pyinstaller 添加数据文件 - Thinbug](https://stackoverflow.com/questions/41870727/pyinstaller-adding-data-files/59710336#59710336)

# ruby-on-rails - 什么时候可扩展性成为部署在 Heroku 上的 Rails 应用程序的一个问题？

> ID：14759450
> 
> 赞同：11
> 
> 时间：2013-02-07T19:33:12.740
> 
> 标签：ruby-on-rails, heroku, scalability

Ruby on Rails 在很大程度上因缺乏可扩展性选项而受到指责，而替代方法通常是迁移到某种形式的 Java webapp 或类似的东西。但在某种程度上，所有的担忧似乎充其量都是非常武断的。

当某个应用程序需要用不同的语言重写时，是否有具体的数字？Heroku 提供了各种缩放选项以及应用程序可用的测功机数量，但是在什么时候收益递减（如果有的话）会很明显？或者在什么时候拥有这么多测功机的成本会超过编写一个新应用程序的成本？

在 Heroku 的基本免费托管计划中，我可以期望能够支持多少活跃的并发用户而不会遇到性能问题？

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2013-02-07T19:53:12.990

“Rails 无法扩展”的神话根本不会消失……

引用 Twitter 的首席架构师的话：

> 与“更快”语言相关的性能提升会给我们带来 10-20% 的改进，但由于 Ruby 和 Rails 欣然适应的架构变化，Twitter 的速度提高了 10000%。

我不能给你一个固定的数字，但几乎可以绝对保证你在 Ruby 或 Rails 开始成为瓶颈之前很久就遇到了数据库或架构瓶颈。

[Teflon Ted](https://stackoverflow.com/users/4061/teflon-ted)已经创建了一个关于这个主题[的不错的博客文章集合。](http://trak3r.blogspot.de/2008/03/rails-doesnt-scale.html)

# c# - 如何获得符合标准的通用列表元素的平均值？

> ID：14759452
> 
> 赞同：3
> 
> 时间：2013-02-07T19:33:24.247
> 
> 标签：c#, linq

我想重新创建 excel 函数 AVERAGEIF 的通用版本。它定义如下：

> 返回范围内满足给定条件的所有单元格的平均值（算术平均值）

我的问题是我不知道如何定义通用平均函数的类型签名。以下是我拥有的几乎可以工作的代码。

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Threading.Tasks;

namespace ConsTestApp
{
    class Program
    {
        static void Main(string[] args)
        {
            var dl = new List<double>() { 10, 10, 0, 0 };
            var bl = new List<bool>() { true, true, false, false };
            Func<bool, bool> criteria = c => c == true;

            Console.Out.WriteLine(AVERAGEIF<double, bool>(dl, bl, criteria));
            Console.In.Read();
        }

        static T1 AVERAGEIF<T1, T2>(List<T1> average_range, List<T2> criteria_range, Func<T2, bool> applyCriteria)
        {
            var cl1 = new List<Container<T1>>();
            foreach (var cl in average_range)
            {
                cl1.Add(new Container<T1>(cl));
            }
            var cl2 = new List<Container<T2>>();
            foreach (var cl in criteria_range)
            {
                cl2.Add(new Container<T2>(cl));
            }

            List<Container<T1>> result =
                new List<Container<T1>>((from d in cl1
                                         join b in cl2
                                         on d.Id equals b.Id
                                         where applyCriteria(b.Value)
                                         select new Container<T1> { Value = d.Value, }).ToList<Container<T1>>());

            var ret = result.Average<T1>(s => s.Value);
            //
            //  return ret;
            return default(T1);
        }
    }

    class Container<T>
    {
        private static uint count = 0;

        public Container()
            : base()
        {
            count++;
            this.Id = count;
        }

        public Container(T t)
            : this()
        {
            this.Value = t;
        }

        public T Value
        {
            get;
            set;
        }

        public uint Id
        {
            get;
            private set;
        }
    }

    class ContainerList<T> : List<Container<T>>
    {
        List<Container<T>> m_list;

        public ContainerList()
            : base()
        {
            this.m_list = new List<Container<T>>();
        }

        public ContainerList(List<T> l)
            : this()
        {
            foreach (var li in l)
            {
                this.m_list.Add(new Container<T>(li));
            }
        }

        public ContainerList(List<Container<T>> l)
            : this()
        {
            this.m_list = l;
        }

        public T Average(Func<Container<T>, T> selector)
        {
            T ret = default(T);

            if (typeof(T) == typeof(double))
                ret = (T)(object)(double)0.0;
            else if (typeof(T) == typeof(decimal))
                ret = (T)(object)(decimal)0.0;
            else
                ret = default(T);

            return ret;
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2013-02-07T19:35:34.840

> 我想重新创建 excel 函数 AVERAGEIF 的通用版本

为什么不直接使用 LINQ？

```
var average = collection.Where(x => x.Something)
                        .Average(x => x.SomeProperty); 
```

请注意，如果没有匹配的元素，这将引发异常。如果你不想这样，你可以使用：

```
var average = collection.Where(x => x.Something)
                        .DefaultIfEmpty()
                        .Average(x => x.SomeProperty); 
```

目前尚不清楚您为什么要为此创建一个单独的方法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-07T22:12:52.133

以下是对我有用的答案：

```
public double AVERAGEIF<T1,T2>(IEnumerable<T1> average_range, IEnumerable<T2> criteria_range, Func<T2, bool> criteria)
{
    var t1andt2 = average_range.Zip(criteria_range, (l, r) => Tuple.Create<T1, T2>(l, r));      
    return t1andt2.Where(x => criteria(x.Item2)).Average(x => Convert.ToDouble(x.Item1));   
}

void Main()
{   
    var average_range = new List<string>() {"10.1", "10.1", "0", "0"} ; 
    var criteria_range = new List<bool>() {true, true, false, false };  
    Func<bool, bool> criteria = c => c == true;     
    AVERAGEIF(average_range, criteria_range, criteria).Dump();
} 
```

# c# - C# 新手，找不到数据表

> ID：14759461
> 
> 赞同：1
> 
> 时间：2013-02-07T19:33:43.057
> 
> 标签：c#, visual-studio-2012, datatable

我对 C# 比较陌生，我想尝试一些非常简单的程序来练习（不是为了家庭作业，不是为了我以后可能做的事情，只是想变得更好）。[我在这里](http://www.dotnetperls.com/datatable)找到了一个数据表的示例，但在**但我在工具箱**

我是不是走错路了？是否可以只通过代码添加它？或者是什么 ？

我知道它确实[存在](http://msdn.microsoft.com/en-us/library/system.data.datatable.aspx)

**编辑：**

谢谢，我现在知道这不是视觉表示，而是我*实际*寻找的数据网格视图。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-07T19:38:01.517

这`DataTable`是一个类，但不是一个控件。[此处](http://msdn.microsoft.com/en-us/library/bb386451.aspx)显示 ASP.NET 控件。

该工具箱仅显示 ASP.NET 控件。是的，您需要通过代码而不是通过工具箱添加它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-07T19:38:12.353

A`DataTable` 是一个包含数据行的对象 - 您可以将其视为内存数据库表。通常你会在代码中创建这个对象。它不在工具箱中，因为它不是可视组件。

视觉组件是`DataGridView`. 这将在工具箱中，您可以将其拖放到表单上。这就是您正在查看的教程正在使用的内容。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-07T19:38:32.853

查看示例中的代码 - 非常接近顶部，有：

```
using System.Data; 
```

类“`DataTable`生活”在这个命名空间中。

您也需要在代码中包含它。

`DataTable`不是视觉工具——它是一个普通的类，你将无法在工具箱中找到它。

工具箱中的项目用于可视化组件——例如表单、类图等。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-02-07T19:38:41.913

有很多东西不在工具箱中，您可以通过代码直接访问。

（此答案的其余部分假设您使用的是 Winforms 而不是 WPF）

工具箱主要是为了方便访问具有**可视化组件的东西**。如果您想***显示***您的 DataTable，那么您真正需要的是[DataGridView](http://msdn.microsoft.com/en-us/library/system.windows.forms.datagridview.aspx)

![在此处输入图像描述](../Images/2308989850bbf225d3ca9f32fea98cb7.png)

您可以在工具箱中添加更多东西，只需右键单击工具箱并转到`Choose Items...`

* * *

[一个DataSet](http://msdn.microsoft.com/en-us/library/system.data.dataset.aspx)中也可以包含多个 DataTable 。如果你看我上面的截图，它就在 DataGridView 的正下方。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-02-07T19:40:27.497

**DataTable**不是 UI 组件。您可以拖到 Window/Form 上的 UI 组件是**DataGrid**。

DataTable 和 DataGrid 都不是特定于 C#，它们是 .NET 类，可以通过任何 .NET 语言（包括 C#、C++/CLI、F#...）使用。然而，**DataGrid 是****特定于 UI 技术**的，因此如果您使用的是 Winforms、WPF、Windows 8 UI、ASP.NET UI、Silverlight 等，则需要详细说明。

您在工具箱中看到的内容取决于活动文档。如果活动文档是 UI 设计器，您可以看到 UI 组件。如果活动文档是实体框架设计器，您可以看到实体框架设计元素等。

以下是在工具箱中查找 DataGrid 的示例（用于 WPF）： [how to get datagrid control in wpf visual studio 2010](https://stackoverflow.com/questions/7330585/how-to-get-datagrid-control-in-wpf-visual-studio-2010)

# ruby - 如何将数组字符保存在另一个数组中的相同索引处？

> ID：14759465
> 
> 赞同：0
> 
> 时间：2013-02-07T19:33:59.113
> 
> 标签：ruby, arrays, replace

必须有一种简单的方法来替换 Ruby 中的数组元素。我不想使用正则表达式。

```
while @word_array.include? c do
  idx = @word_array.index(c)
  @currently_found[idx] = c
  @word_array.index(idx) = " "
end 
```

我想将 char *c*保存在同一索引但在另一个数组中。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-07T22:25:34.140

不确定你想要它做什么（你真的想改变@word_array 以包含一个空格吗？），但这应该这样做（除了数组末尾的额外 nil，不知道这是否有问题）：

`@currently_found = @word_array.map { |w| w == c ? c : nil }`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-07T19:51:44.177

只需使用[Array#index](http://www.ruby-doc.org/core/Array.html#method-i-index)的返回值。例如：

```
an_array     = %w[a b c]
new_array    = []
chars        = ['b']
chars.each do |char|
  new_array[an_array.index(char)] = char if an_array.include? char
end
new_array
=> [nil, "b"] 
```

# javascript - 如何检查一个类是否不存在？

> ID：14759468
> 
> 赞同：13
> 
> 时间：2013-02-07T19:34:00.803
> 
> 标签：javascript, jquery

我不知道为什么这不起作用，我只是想检查是否`.searchBar`不存在。

```
 var $school = "Washington";

  if(!$('.searchBar')){
     $('#schoolname').text($school); 
  } 
```

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2013-02-07T19:34:47.103

```
if($('.searchBar').length === 0){ 
```

请记住，jquery 总是返回一组匹配的元素。该列表可能为零。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2013-02-07T19:34:57.297

用于`.length`查找是否存在`if(!$('.searchBar').length){`

jQuery`$()`函数总是返回一个 jQuery 对象，即使没有找到任何元素。因此，您需要使用`.length`jQuery 对象的属性来查找该元素是否实际存在。

# fullcalendar - qtip - 在工具提示本身中添加一些链接？

> ID：14759474
> 
> 赞同：1
> 
> 时间：2013-02-07T19:34:15.387
> 
> 标签：fullcalendar, qtip2

我正在使用 fullCalendar 并拥有它，以便在单击事件时生成 qTip（显示有关该元素的一堆详细信息）。我想在 qTip 中有一些基于被点击元素的链接（因此，动态链接）。这些链接将提供一种方法来编辑 fullCalendar 事件所基于的基础数据库记录。我想有一些回调方式来处理这个问题。

以下是我在 fullCalendar 中构建 qTip 的方法：

```
 eventRender: function(event, element) {
        element.qtip({
          content: {
            text: "Loading WO info...",
            ajax: {
              url: "/schedule/get-wo-details/",
              type: 'GET',
              data: { woID: event.woID },
              dataType: 'json',
              success: function(data, status) {
                var content = "<table class='qtip-table'>"
                content += "<table>...add content here...";
                content += "<center>";
                // Here are my links...
                content += "<a href='#'>Unschedule</a> | ";
                content += "<a id='qtip-link' href='#'>Edit Note</a>";
                content += "</center>";
                this.set('content.text', content);
              }
            }
          },
          show: {
            event: 'click',
          },
          hide: {
            fixed: true,
            delay: 1000
          },
          position: {
            viewport: $("#calendar"),
            effect: false,
            at: "left-center",
            my: "right-center"
          }
        }); 
```

我想知道我是否可以做类似的事情：

```
$("#qtip-link").click(function(){
    // Do some ajax magic here...
}); 
```

这个，所以我发现，行不通。我该如何实现这一目标？这似乎是一件简单的事情，但似乎无法组合一个像样的谷歌搜索查询来找到答案。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-08T12:24:42.813

尝试在 eventAfterRender 中添加 click 事件处理程序，或使用 jQuery 的 on 或 live 处理程序将处理程序添加到动态创建的链接

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-08T14:50:42.933

您可以绑定双击呈现的事件：

```
eventRender: function(event, element) {
    element.qtip({
        content: event.description,
    });
    element.bind('dblclick', function() {
        //put there some code for
    });
}, 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-12T17:56:37.113

我相信我想通了。在`eventRender`我创建`qTip`自身的方法中，我有以下代码：

```
var e = event.woID;
content += "<a href='#' onclick=unscheduleEvent('" + e + "')>Unschedule</a> | "; 
```

这只是创建了一个变量，该变量等于我在`event`生成日历时存储的一些数据。这`content`是`HTML`要进入的`qTip`- 所以我使用我的变量添加一个链接以传递给`onClick`事件。

# php - 无法在 jQuery File Upload Demo 上删除图片

> ID：14759483
> 
> 赞同：1
> 
> 时间：2013-02-07T19:34:34.437
> 
> 标签：php, jquery, xampp

您好，我在 XAMPP 中检查了 Windows 7上的[系统 jQuery 文件上传演示](http://blueimp.github.com/jQuery-File-Upload/)

一切正常，我可以上传图片并删除

但是在Linux服务器上我不能删除图片可能是什么问题

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-11-13T00:54:09.663

您的问题可能是您的服务器不支持`DELETE`请求。

转到`UploadHandler.php`，在该行`'delete_type' => 'DELETE'`中，将其更改为`'delete_type' => 'POST'`。

# android - Android 有没有办法在不安装应用程序的情况下创建地理围栏接近警报？

> ID：14759488
> 
> 赞同：1
> 
> 时间：2013-02-07T19:34:45.677
> 
> 标签：android

我正在寻找无需在设备上安装应用程序即可在设备上配置接近警报的方法。

在今天的 Android 上，这是否可能？

我知道使用本机代码添加接近警报，当设备进入由纬度/经度和半径定义的地理围栏时，我可以采取行动或发送通知。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-07T19:43:04.963

不，Android 本身不支持基于位置的任务启动。我也不认为它会在不久的将来成为操作系统的一部分。

目前，您必须使用[Llama](https://play.google.com/store/apps/details?id=com.kebab.Llama&hl=en)等应用程序来执行此操作。

如果您希望将位置感知纳入您的应用程序，请查看[使您的应用程序位置感知](http://developer.android.com/training/basics/location/index.html)指南。

# javascript - express + socket.io + mongoDB 的架构选项有哪些

> ID：14759490
> 
> 赞同：0
> 
> 时间：2013-02-07T19:34:47.133
> 
> 标签：javascript, node.js, express, socket.io

我正在开发一个需要与服务器进行连续套接字连接的 MMO 游戏。

我的架构有一些要求。

1.  通过 socket.io 连接进行用户身份验证。
2.  用户之间的实时交互。
3.  必须处理大量的计算和数据库 CRUD 操作。
4.  我的目标是现代浏览器，并计划使用新技术和旧的已知性能提升技术，如 Web 工作者、Web 套接字、本地存储、链接预取、数据 URI。

问题是：

这种应用程序的推荐方法和模块是什么？

感谢并为我糟糕的语言能力感到抱歉。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-07T21:17:42.010

你应该试试[express.io](http://express-io.org)。

这是一个实时网络框架，可以轻松组合 express 和 socket.io。这意味着您的常规 Web 组件和实时 Web 组件应该可以很好地协同工作。

它具有会话支持和路由功能。此外，还有很多文档和示例代码。

设置一个基本的应用程序，然后分别使用这两个库要简单得多。

```
app = require('express.io')
app.http().io()

// your game code goes here :)

app.listen(7076) 
```

对于 mongo，我最喜欢的是[mongo-skin](https://github.com/kissjs/node-mongoskin)，但是[mongoose](https://github.com/LearnBoost/mongoose)也很受欢迎。

祝你好运！

免责声明：我写的:)

# c++ - C++ 编码人员通常会显式地执行移动还是仅依赖编译器来执行移动？

> ID：14759498
> 
> 赞同：7
> 
> 时间：2013-02-07T19:35:32.327
> 
> 标签：c++, c++11, move-semantics

我们在一些功能中有这个：

```
BigClass big;
// prepare big somehow
OtherClass foo(std::move(big), maybe, other, params);
// know that we won't be using "big" after this. 
```

如今，大多数 C++ 编码人员是否会真正将移动放在那里以保证移动？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-02-07T19:43:56.567

在您的特定代码中，您要么直接移动，要么根本不移动。编译器永远不会移出*左值*（不是*eXpiring*）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-07T19:43:22.247

我会把它放在`std::move`那里以便有一个动作，因为否则不会有。:)

另一种选择是：

```
auto MakeBig = [&]()->BigClass {
  BigClass big;
  //prepare big somehow
  return big; // must be a `move`, if not elided!
};

OtherClass foo(MakeBig(), maybe, other, params); 
```

或者，如果你不是胆小的话：

```
OtherClass foo([&]()->BigClass {
  BigClass big;
  //prepare big somehow
  return big; // must be a `move`, if not elided!
}(), maybe, other, params); 
```

我们将 up 的创建包装`big`到一个 lambda 中，然后推迟创建。请注意，这并不总是有效。

这种模式的一个优点是，如果将其第一个参数按值取值，则可以省略该移动`foo`，并且按值取值现在对于将要复制的有`move`能力的类来说是正确的方法。`OtherClass`如果它不按值获取第一个参数，则为构造创建的临时变量`foo`仍然可以省略，因此只会`foo`发生一次移动（在临时变量和 之间）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-07T19:46:22.713

如果您使用 C++11，有时编译器会为您移动（R 值引用），但如果您想显式移动一个大对象，那么是的，您应该使用显式“移动”它

```
std::move 
```

[更多信息](http://www.cprogramming.com/c++11/rvalue-references-and-move-semantics-in-c++11.html)

# iphone - 类似于原生联系人应用程序的粘性搜索栏和部分标题行为

> ID：14759506
> 
> 赞同：9
> 
> 时间：2013-02-07T19:36:01.330
> 
> 标签：iphone, ios, uitableview, uisearchbar

我想复制 iPhone 联系人应用程序中搜索栏的粘性行为。

![正常阶段](../Images/af3ef65969c288048cb13b5bfcda005c.png)

当用户向下滚动视图时，**搜索栏也会**随着视图一起下降：

![用户向下滚动视图](../Images/39945ab826ff1b9a3780c37f25bbffb3.png)

如果用户向上滚动，表格会相应地滚动，具有以下两种行为：

(1) 搜索栏保持**固定在顶部**，
(2)**后续部分标题适当地停在搜索栏下方**：

![用户向上滚动](../Images/ec2ac9c03a280c5f17cd0bce1c9b4495.png)

当下一个部分标题出现时，前一个标题消失在搜索栏下方：

![用户向上滚动](../Images/0e7264f191210be8deb841427665bee9.png)

注意：部分索引控件（右侧的 az）也出现在**搜索栏的顶部**。因此，摆弄`contentInset`会将部分索引控件随之向下推。

我创建了一个 custom `UIViewController`，添加了一个`UITableView`，将其设置`contentInset`为搜索栏的高度。我创建了一个`UIView`，将搜索栏添加为其子视图，然后`UIView`将`UITableView`. 但是，如上所述，当用户滚动时，部分标题仍停留在 y 位置零处，而不是标题高度。此外，节标题索引控制​​位置也会受到不利影响。

我很感激这个问题的解决方案。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2013-02-10T14:54:43.560

把所有的事情都做对已经做了相当多的工作，但我只需要证明可以重新创建这种行为，至少*几乎是*.
查看我创建的这个 GitHub 项目：[https ://github.com/fabiankr/TableViewSearchBar](https://github.com/fabiankr/TableViewSearchBar)

其实也没那么复杂：
1）直接将搜索栏添加到表格视图中并设置tableView的`contentInset`
2）在`-scrollViewDidScroll:`调整搜索栏的框架

不过，您必须注意一些注意事项：
1) 将表格视图滚动到顶部时，部分标题很快就会出现在搜索栏上方。为了解决这个问题，`zPosition`在滚动到顶部时设置搜索栏
2）您的内容控制器需要是一个子类`UIViewController`而不是`UITableViewController`，因为`UISearchDisplayController`将调光视图添加到控制器的视图中。因为表格视图控制器`view`是表格视图，所以当表格视图滚动时，调光视图将位于错误的位置。

仅使用公共 API 无法实现的一件事是使表格右侧的部分索引控件与搜索栏重叠。这只是一件小事，即使没有它，其行为也与联系人应用程序中的行为非常相似。

为了实现完全相同的行为，您必须使用私有 API。有一种方法`UITableView`需要`_setPinsTableHeaderView:`使用。示例项目包含以下两种实现：1）仅公共 API 和 2）私有 API，以使部分索引控件与搜索栏重叠。
**提醒**：当您计划将应用程序提交到 App Store 时，您不应该使用私有 API！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-07T20:50:58.897

我实现这种行为的方法是将我的浮动单元格从 UITableView 中分离出来，并使其成为 UITableView 的子视图，并在 scrollViewDidScroll 中为浮动单元格设置动画。就这样 UITableView 向下滚动足够远以显示浮动单元格我还在 tableview 中粘贴了一个不可见的单元格，当调用 scrollViewDidScroll 时该单元格被浮动单元格覆盖。

```
- (void)viewDidLoad {
   // add floating cell to tableview
   FloatingCell *cell = [[FloatingCell alloc] init];
   [self.tableView addSubview:cell];
   self.floatingCell = cell; 
}
// overwrite scrollViewDidScroll
- (void)scrollViewDidScroll:(UIScrollView *)scrollView {
    CGRect floatingCellFrame = floatingCell.frame;
    CGFloat floatingCellHeight = floatingCellFrame.size.height;

    // when contentOffset is is more then cellHeight scroll floating cell
    if (scrollView.contentOffset.y > floatingCellHeight) {
       floatingCellFrame.origin.y = -scrollView.contentOffset.y + floatingCellHeight; 

    // when contentOffset is less then cellHeight stick it to the top of UITableView
    else if (scrollView.contentOffset.y < floatingCellHeight)
       floatingCellFrame.origin.y = 0;

   floatingCell.frame = floatingCellFrame;
} 
```

您可能需要在滚动时添加几个极端情况条件，以便浮动单元格不会出现跳跃，但这应该让您开始。祝你好运！

# python - 为什么我的 zipfile 没有添加某些文件

> ID：14759507
> 
> 赞同：0
> 
> 时间：2013-02-07T19:36:06.830
> 
> 标签：python, python-2.7, zip, zipfile

我有以下代码：

```
with ZipFile('deploy.zip', 'w') as deploy:
    if os.path.isfile(artifact.source):
        deploy.write(artifact.source, artifact.target)
    else:
        for base, dirs, files in os.walk(artifact.source):
            for file_ in files:
                source = os.path.join(base, file_)
                target = os.path.join(base[base.index(artifact.target):], file_)
                deploy.write(source, target) 
```

当此代码完成时，只有与文件匹配`artifact.source`的文件才会添加到 deploy.zip。在某些情况下`artifact.source`将是一个目录（我也测试过这个案例）广告`for`部分将被执行。

以下行的结果是有效的，并且每次迭代都存在源：

```
source = os.path.join(base, file_)
target = os.path.join(base[base.index(artifact.target):], file_) 
```

这是我正在工作的完整代码：[https](https://gist.github.com/khaoz/9b04d87b0900fba780f0) ://gist.github.com/khaoz/9b04d87b0900fba780f0 将 config.project_root 设置为“c:\temp”之类的内容并删除导入配置行。OBS：我是 Python 新手，所以请忽略一些你会看到的垃圾代码：P

这里是我的 csv 文件的一个例子：[https ://gist.github.com/khaoz/e9a59390f415f22d46db](https://gist.github.com/khaoz/e9a59390f415f22d46db)

我做错了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-07T20:47:14.773

**仅供参考**

我对你所做的事情的解释，这似乎有效。

```
from zipfile import ZipFile
from collections import namedtuple
import os

Artifact =  namedtuple('Artifact', ['source', 'target'])
artifact =  Artifact(source="Mongodb", target="g")

with ZipFile('deploy.zip', 'w') as deploy:
    if os.path.isfile(artifact.source):
        print "F"
        print "\n", artifact.source
        print "\n", artifact.target
        deploy.write(artifact.source, artifact.target)
    else:
        for base, dirs, files in os.walk(artifact.source):
            for file_ in files:
                print "base", base, file_
                source = os.path.join(base, file_)
                target = os.path.join(base[base.index(artifact.target):], file_)
                print "f"
                print "\t", source
                print "\t", target
                deploy.write(source, target) 
```

`unzip -l deploy.zip | tail`

```
 2591  01-09-13 21:26   godb/Sortif/scratch.py
     2010  01-15-13 20:20   godb/Sortif/sortif_model.py
     2495  01-15-13 20:22   godb/Sortif/sortif_model.pyc
      161  01-15-13 20:45   godb/Sortif/sortif_scratch.py
        0  01-08-13 12:05   godb/Sortif/sortif/__init__.py
        0  01-08-13 12:05   godb/Sortif/sortif/models/__init__.py
     1408  01-21-13 18:05   godb/ZeroMQ/client.py
     3044  01-21-13 17:51   godb/ZeroMQ/controller.py
 --------                   -------
 11137644                   967 files 
```

我不确定您要达到的目的`base[base.index(artifact.target):]`是要更改前缀吗？因为在我的 Mongodb 目录上运行它`target`必须出现在文件的目录中`base`。

我不确定您希望如何驱动代码，因为它似乎`artifact.source`是一个常数。所以第一次它找到一个文件，它永远不会做它正在寻找目录的部分。

难道不应该

```
with ZipFile('deploy.zip', 'w') as deploy:
    for artifact in articats:
        if os.path.isfile(artifact.source):
            ... 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-08T11:51:08.950

我发现了问题。有时，睡眠是解决某些问题的最佳方法

我在做：

```
for artifact in artifacts:
    if not artifact.name in contents:
        contents.append(artifact.name)

    with ZipFile('deploy.zip', 'w') as deploy:
        if os.path.isfile(artifact.source):
            deploy.write(artifact.source, artifact.target)
        else:
            for base, dirs, files in os.walk(artifact.source):
                for file_ in files:
                    source = os.path.join(base, file_)
                    target = os.path.join(base[base.index(artifact.target):], file_)
                    deploy.write(source, target) 
```

但是对于工件中的每次迭代，都会关闭并打开一个新`deploy.zip`文件。

正确的做法是：

```
with ZipFile('deploy.zip', 'w') as deploy:
    for artifact in artifacts:
        if not artifact.name in contents:
            contents.append(artifact.name)

        if os.path.isfile(artifact.source):
            deploy.write(artifact.source, artifact.target)
        else:
            for base, dirs, files in os.walk(artifact.source):
                for file_ in files:
                    source = os.path.join(base, file_)
                    target = os.path.join(base[base.index(artifact.target):], file_)
                    deploy.write(source, target) 
```

一切都按预期工作。

非常感谢所有试图提供帮助的人。下次我将发布完整的源代码，或者最后再发布几行。:)

# vb.net - 更改现有文件的扩展名：Visual Studio 2010

> ID：14759508
> 
> 赞同：1
> 
> 时间：2013-02-07T19:36:11.497
> 
> 标签：vb.net, visual-studio-2010

经过一段时间的搜索，现在不能找到一个简单的答案。所以这是我的问题：

我正在使用 Visual Studio 2010 中的 Visual Basic 编写。
（另一个我需要回答但不相关的问题：这种语言是否称为 VB .NET？；我是这种语言的新手，但对编程不熟悉，因为我是一名网页设计师.)

我在这个目录下有个文件：**C:\users\Debbie**
这个文件的名字和扩展名如下：**backup01.zip**

**我需要知道的是：**如何获取我创建的这个文件并快速更改扩展名，而无需将其移动到另一个目录或制作副本。我只是想让我的程序找到文件 backup01.zip 并快速将其更改为 backup01.nbu

.nbu 将是我的软件能够打开的文件扩展名（*当我到达那里时*）。

谢谢..

（PS）如果有人好奇我为什么已经在写文件，那是因为我正在投入其中并尽力为我母亲创建简单的备份软件，她经常在她的电脑上使用的原始软件没有备份能力。请记住，我是一名有抱负的程序员，熟悉 HTML、CSS、PHP 等语言，我也在尝试自己学习这个。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-07T19:43:27.513

使用`File.Move`方法：

```
System.IO.File.Move("C:\users\Debbie\backup01.zip", "C:\users\Debbie\backup01.nbu") 
```

您可能已经在变量中有文件名，所以`Path.ChangeExtension`会很方便：

```
Dim originalFile As String = "C:\users\Debbie\backup01.zip"
Dim newName As String = Path.ChangeExtension(originalFile, "nbu")
File.Move(originalFile,newName) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-07T19:44:51.760

首先是一个简单的问题 - 是的，它被称为 vb.net（2002 年它成为一种 .NET Framework 语言，在此之前最后一个版本被称为 VB 6.0）

至于重命名问题，代码如下：

```
Dim goodFileName As String = "C:\mydir\myfile.com.extension"        
Dim result As String= Path.ChangeExtension(goodFileName, ".old")
File.Move(goodFileName ,result) 
```

仅返回新的`ChangeExtension`完整路径，但不以任何方式编辑文件本身。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-10-29T14:59:31.613

似乎连我都在使用**Visual Basic 2010**！
我建议你使用这个：

```
My.Computer.FileSystem.RenameFile("C:\users\Debbie\backup01.zip", "C:\users\Debbie\backup01.nbu") 
```

就这样。希望能帮助到你！
干杯，*Sreenikethan*

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2015-04-24T11:29:36.533

我最近刚刚在 Visual Studio 2013 中编写了我的第一个程序，但我没有技术编程技能，所以请耐心等待。您想要在命令行中轻松实现，据我所知，这应该在 Visual Studio 中工作：

```
Process.Start("cmd.exe", "/c ren C:\users\Debbie\backup01.zip backup01.nbu") 
```

它启动命令行 /c 完成后结束它，其余的都是不言自明的。这是一个小“解决方法”，但它会完成工作。

# f# - 数字基元及其后缀

> ID：14759509
> 
> 赞同：8
> 
> 时间：2013-02-07T19:36:14.887
> 
> 标签：f#

我试图弄清楚这些后缀背后的真正含义是什么。换句话说，我正在尝试“翻译”它们。

```
+----+--------------+--------+
|    |     Type     | Suffix |
+----+--------------+--------+
|  1 | byte         | uy     |
|  2 | sbyte        | y      |
|  3 | int16        | s      |
|  4 | uint16       | us     |
|  5 | int, int32   |        |
|  6 | uint, uint32 | u      |
|  7 | int64        | L      |
|  8 | uint64       | UL     |
|  9 | float        |        |
| 10 | float32      | f      | (edited, thanks Thomas)
| 11 | decimal      | M      |
+----+--------------+--------+ 
```

例如，我假设“f”代表 **浮点数**。但是，例如“M”代表什么。为什么“d”不用于**d**小数？“uy”代表什么？等等……

任何人都可以“翻译”这个吗？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-02-07T19:52:00.980

我只能推测，但请注意，由于 af 是有效的十六进制值，它们不能用于整数类型的后缀。这可能是 bYte 和 deciMal 的助记符缩写略少的原因。同样，请注意，对于浮点数使用十六进制表示法有单独的（很少使用）就足够了：`LF`对于浮点数和`lf`对于 float32s。

根据这些规则，以下所有内容都是有效的文字：

```
0xb  // int, in hex
0xby // byte, in hex
0xabcdef // int, in hex
0xabcdeflf // float32, in hex 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2013-02-07T20:22:57.417

我认为@kvb 做了一个很好的推测。这里有两个小的补充：

*   您的表格中有一个小问题，`f`是用于`float32`（也称为`single`对应于`System.Single`）的后缀，而没有后缀的浮点变为 F# `float`（对应于`System.Double`）。浮点数的命名在F#中真的很混乱，所以我认为这没有什么特殊的逻辑（只是需要区分两种浮点数）。

*   您的表也不包括`l`（用于`int`）。这意味着`int16`,`int32`和`int64`有后缀`s`,`l`和`L`（在 C 术语中可能意味着“short”、“long”和“long long”）。

*   我喜欢将小数的后缀读`M`作“钱”，因为小数最常用于表示钱（因为它的精度很高）。我不确定这是否是前缀为 的原因`M`，但很容易记住:-)。

# xamarin.ios - mono delveloper 内存分析器无法启动

> ID：14759513
> 
> 赞同：1
> 
> 时间：2013-02-07T19:36:29.973
> 
> 标签：xamarin.ios, profiling, monodevelop

我有一个非常烦人的问题。我使用了单声道开发者内存分析器，它就像一个魅力。但是后来我重新启动了我的计算机，现在分析器没有启动。

我禁用了选项中的“启用分析”，然后它提示并询问我是否要再次启用它。我试过了，但是它没有启动，我不知道是什么阻止了它。

Mono 开发者的版本是 3.1.1。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-08T07:40:59.333

我按照 Rolf 的建议通过删除 *.userprefs 文件解决了我的问题。我关闭了 Monodeveloper，删除了文件，启动了 monodelveloper 并进行了清理。此后，我像往常一样启动了分析器-它工作正常：P

# sap-ase - Sybase - 在两个日期之间选择数据

> ID：14759515
> 
> 赞同：1
> 
> 时间：2013-02-07T19:36:32.427
> 
> 标签：sap-ase

关于 sybase ASE 15.5，我还有另一个（可能）非常容易回答的问题......不是我的热门话题 :-(

我有一个包含日期列的临时表。

使用转换实时数据的转换将日期插入临时表

从

例如：

```
2013-01-21 10:05:00.0
2013-01-28 08:03:00.0 
```

至

```
21/01/2013
28/01/2013

using (CONVERT(VARCHAR(10), DATEFIELD, 103) 
```

我面临的问题是当我尝试使用日期范围过滤器将 LIVE 表中的数据选择到临时表中时：

```
WHERE (CONVERT(VARCHAR(10), DATEFIELD, 103) BETWEEN '21/01/13' AND '28/01/13') 
```

....当我运行这个 sybase 时，只插入 21/01/2013 日期，而不是 28/01/2013。

.....此外，如果我使用 29/01/2013 作为结束日期，即

```
WHERE (CONVERT(VARCHAR(10), DATEFIELD, 103) BETWEEN '21/01/13' AND '29/01/13') 
```

我都插入了：

```
21/01/2013
28/01/2013 
```

此外 - 如果我只运行 21/01/13 即

```
WHERE (CONVERT(VARCHAR(10), DATEFIELD, 103) BETWEEN '21/01/13' AND '21/01/13') 
```

我什么也没得到。

有任何想法吗？

也许在 sybase 中使用 BETWEEN 并不好。为了清楚起见，这些字段已从 DATETIME 转换为 VARCHAR (10)。

我遇到的另一个问题是，当我进行第一部分修复时，我希望能够在例如

```
WHERE (CONVERT(VARCHAR(10), DATEFIELD, 103) BETWEEN '%' AND '%') 
```

....但目前这个也不起作用。

任何想法都是关于这些问题中的一个/两个。

提前致谢。

加雷斯

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-19T15:13:16.693

那么你不需要转换为varchar。我假设您的字段是日期时间。

```
convert(date, DATEFIELD, 103) 
```

之后你可以：（TST cenario）

```
create table #temp1 (Datatst datetime)
insert into #temp1 values( '2013-01-21 10:05:00.0')
insert into #temp1 values( '2013-01-28 08:03:00.0')

select Datatst from #temp1
where convert(date,Datatst,103) between '21/Jan/13' AND '28/Jan/13' 
```

数据测试

```
2013-01-21 10:05:00.0
2013-01-28 08:03:00.0 
```

（我的字符集是 cp850）

# javascript - 将 jQuery 数据附加为字符串时在 div 上设置

> ID：14759516
> 
> 赞同：2
> 
> 时间：2013-02-07T19:36:36.800
> 
> 标签：javascript, jquery, html, css, performance

我正在创建一个 jQuery 插件，它会生成很多`divs`. 最初我使用`append`如下函数创建所有元素。

```
var myObject= $('<div></div>').addClass('myobjectname');
parentObject.append(myObject); 
```

我有很多这样创建的元素，并且每个元素都有不同的`data`关联，`myObject.data('mykey',ajavascriptobject);` 但是后来，当我开始阅读更多关于 jQuery 优化的内容时，我了解到像这样的 DOM 操作函数`append`在性能方面非常昂贵。

现在，我尝试将整个`div`结构创建为字符串，然后将其作为一个整体附加到父 DOM 对象，这应该会大大提高性能。

```
var i=0;
var myBigString = [];
myBigString[i++] = "<div class=\"myobjectname\">";
myBigString[i++] = "my content";
myBigString[i++] = "</div>";
parentObject.append(myBigString.join('')); 
```

我正在使用该`data()`功能来存储有关每个对象的详细信息，以便以后访问它（单击/鼠标悬停等时）。但是现在，由于我正在创建整个`div`结构的字符串，

**`data`如果我将它们创建为字符串并稍后将其附加到 DOM，如何将它们关联到元素？**

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-07T19:38:02.520

你这样做：

```
<div data-datum-name="your data string"></div> 
```

对于对象：

```
<div data-datum-name=' + JSON.stringify(yourObject) + '></div> 
```

[JSFiddle 示例](http://jsfiddle.net/faceleg/BxdUN/2/)。

# inheritance - 扩展自定义 dijit“链式构造函数”错误

> ID：14759517
> 
> 赞同：1
> 
> 时间：2013-02-07T19:36:37.293
> 
> 标签：inheritance, dojo

尝试扩展小部件时遇到问题，给我错误：

> 声明 ImageBoxAnim：使用继承调用链式构造函数

我没能找到有同样问题的人，所以我认为这是我对`dojo/_base/declare`.

基类“_ImageBoxBase”（极其简化）：

```
define(['dojo/_base/declare', 'dijit/_WidgetBase'], function(declare, _WidgetBase){
    return declare('_ImageBoxBase', [_WidgetBase], {
        constructor : function(){...}
    }
}) 
```

ImageBox（_ImageBoxBase 的子类 1）：

```
define(['dojo/_base/declare', './_ImageBoxBase'], function(declare, _ImageBoxBase){
    return declare("ImageBox", [_ImageBoxBase], {
        constructor : function(){
            this.inherited(arguments)
            // this class works like a charm
        }
    }
}) 
```

ImageBoxAnim（ImageBox 的子类）：

```
define(['dojo/_base/declare', './ImageBox'], function(declare, ImageBox){
    return declare("ImageBoxAnim", [ImageBox], {
        constructor : function(){
            this.inherited(arguments)
            // no worky!
        }
    }
}) 
```

我已经用 declare 语句尝试了很多变体，唯一至少允许脚本不抛出错误的是一个空的“父”类，但它并没有 widgitify。它会按原样呈现 HTML/CSS，但在返回的`declare`对象中不会调用任何方法。

Essentially there's functionality in the `ImageBox` class I'd like `ImageBoxAnim` to inherit, while adding more functionality (animations).

The thing that gets me is when defining the ImageBox class, it's the same syntax and, I thought, the same process to extend `_WidgetBase` as it is to extend something that extends `_WidgetBase`. A lot of online examples give ways to extend built-in dijits, so I don't see where I'm going wrong.

Note: I know these aren't technically "classes", but from an extending/sub/superclass point of view, it's easier to verbalize.

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-07T20:41:19.607

I can't be sure, but I imagine you're seeing problems because constructors are automatically chained (no need to call this.inherited). If you want to chain manually, check out [manual constructor chaining](http://dojotoolkit.org/reference-guide/1.8/dojo/_base/declare.html#manual-constructor-chaining)

# jquery - 在 ASP.NET MVC3 中，当缓慢渲染的元素延迟文档就绪事件时，如何应用 jQuery UI 插件？

> ID：14759518
> 
> 赞同：0
> 
> 时间：2013-02-07T19:36:42.620
> 
> 标签：jquery, ajax, jquery-ui, dom, ready

我有一个页面，其中包含加载其中一个元素（第 3 方网格组件）时长时间运行的 Ajax 请求。这个 Ajax 请求延迟了文档上就绪事件的触发。我使用 jQuery UI 插件（按钮，dilog）。我曾经将它们应用于 $(document).ready 处理程序中的元素，但现在在这种情况下，直到 Ajax 进程完成，我看到了许多纯粹的、未格式化的丑陋元素。该请求最多可能需要 4-5 秒，因此非常烦人。对于这种情况，什么可能是一个好的解决方案？

我可能会隐藏相应的元素，直到请求完成，然后显示它们，但如果有的话，我更喜欢一些更通用的技术。

另外，不幸的是我对这个组件没有太多的控制权，所以我无法控制它何时以及如何加载它的数据。

编辑：延迟就绪事件的请求当然不是Ajax请求，它是组件的MVC局部视图的长时间处理。但问题仍然存在，因为页面的其他部分（“上方”该区域）加载较早。

编辑：我在 ASP.NET MVC3 中工作，可能一些输出缓冲技术会有所帮助，这将防止刷新任何内容，直到整个请求被处理（类似于 PHP 中的 ob_XXX 函数）。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-07T19:40:08.303

在 dom 准备好并创建 UI 之后启动 ajax 请求怎么样？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-07T20:18:52.597

直到我在服务器端找到更合适的技术之前，我为这些元素添加了一个特殊的 CSS 类，其名称为“hidden-until-ready”，它定义了“display: none”。在文档就绪事件中，我在应用插件之前执行了一行 jQuery 来显示它们。感谢您的回复。

# c# - 如何将多个对象序列化到现有的 XmlDocument 中，而不在每个组件上都有命名空间？

> ID：14759520
> 
> 赞同：1
> 
> 时间：2013-02-07T19:36:53.630
> 
> 标签：c#, .net, xml-serialization

如何在 .Net/C# 中将多个对象序列化为现有的 XmlDocument？

我有一个 XmlDocument，它已经包含数据。我有多个对象。现在我想将它们一一序列化并将它们添加到 XmlDocument (AppendChild) 中。

应该是这样的：

```
<?xml version="1.0" encoding="utf-8" standalone="yes"?>
<project>
    <mySettings>...</mySettings>
    <component_1> anydata </component_1>
    ...
    <component_x> anydata </component_x>
</project> 
```

当我使用 XmlSerializer 时，我得到每个组件的这个定义：

```
<component_1 xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema">
    anydata
</component_1> 
```

所以这就是我得到的，当我序列化成一个字符串然后从字符串创建一个 XmlNode 时，我将它附加到我的文档中：

```
<?xml version="1.0" encoding="utf-8" standalone="yes"?>
<project>
    <mySettings>...</mySettings>
    <component_1 xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema"> anydata </component_1>
    ...
    <component_x xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema"> anydata </component_x>
</project> 
```

我可以这样做删除命名空间：

```
XmlSerializerNamespaces ns = new XmlSerializerNamespaces();
ns.Add("", "");
StringWriter xout = new StringWriter();
x.Serialize(xout, data, ns); 
```

但是后来我得到了对象数组中任何对象的命名空间。这个对象：

```
public class component_1
{
    object[] arr;
} 
```

将被序列化为：

```
<component_1>
  <objectArray>
    <anyType xmlns:q1="http://www.w3.org/2001/XMLSchema" d3p1:type="q1:string" xmlns:d3p1="http://www.w3.org/2001/XMLSchema-instance">one</anyType>
    <anyType xmlns:q2="http://www.w3.org/2001/XMLSchema" d3p1:type="q2:string" xmlns:d3p1="http://www.w3.org/2001/XMLSchema-instance">two</anyType>
  </objectArray>
</component_1> 
```

是否可以将所有需要的名称空间等添加到我的文档中，然后将对象序列化为 XmlNodes 并将它们添加到我的文档中，而无需在每个组件上都有名称空间？

更新：函数 test() 将序列化两个对象并将它们附加到文档中。最后一行将反序列化第一个对象。

```
using System;
using System.IO;
using System.Text;
using System.Xml;
using System.Xml.Serialization;
...

public class Component_1
{
    public string Value = "Component_1.Value";
    public object[] objectArray = new object[] { "one", "two" };
}
void test()
{
    object[] components = new object[] { new Component_1(), new Component_1() };

    XmlDocument doc = new XmlDocument();
    XmlNode rootNode = doc.AppendChild(doc.CreateElement("project"));

    foreach (var component in components)
        rootNode.AppendChild(doc.ReadNode(XmlTextReader.Create(new StringReader(serialize(component, true)))));

    Console.WriteLine(doc.OuterXml);
    Console.WriteLine(deserialize<Component_1>(rootNode.ChildNodes[0].OuterXml).Value);
}
string serialize(object obj, bool namespaces)
{
    StringBuilder sb = new StringBuilder();
    XmlWriter writer = XmlWriter.Create(sb, new XmlWriterSettings() { OmitXmlDeclaration = true });
    (new XmlSerializer(obj.GetType())).Serialize(writer, obj, namespaces ? null : new XmlSerializerNamespaces(new XmlQualifiedName[] { new XmlQualifiedName("", "") }));
    return sb.ToString();
}
T deserialize<T>(string xmlString)
{
    return (T)(new XmlSerializer(typeof(T))).Deserialize(new StringReader(xmlString));
} 
```

也许可以将命名空间添加到文档 (rootNode) 中，并且在使用函数 XmlDocument.ReadNode 从字符串创建新的 XmlNode 时，可以通过 XmlDocument 中的命名空间解析字符串中的命名空间。但我不知道怎么做。

更新 2：
感谢 Alex Filipovici，序列化输出正是我想要的。

```
void test2()
{
    object[] components = new object[] { new Component_1(), new Component_1() };

    var doc = new XmlDocument();

    var project = doc.AppendChild(doc.CreateElement("project"));

    doc.DocumentElement.SetAttribute("xmlns:xsi", "http://www.w3.org/2001/XMLSchema-instance");
    doc.DocumentElement.SetAttribute("xmlns:xsd", "http://www.w3.org/2001/XMLSchema");

    var nav = project.CreateNavigator();

    var emptyNamepsaces = new XmlSerializerNamespaces(new[] { XmlQualifiedName.Empty });

    foreach (var component in components)
    {
        using (var writer = nav.AppendChild())
        {
            var serializer = new XmlSerializer(component.GetType());
            writer.WriteWhitespace("");
            serializer.Serialize(writer, component
                , emptyNamepsaces
                );
            writer.Close();
        }
    }

    foreach (XmlNode node in doc.GetElementsByTagName("anyType"))
    {
        string attributeType = "";
        foreach (XmlAttribute xmlAttribute in node.Attributes)
        {
            if (xmlAttribute.LocalName == "type")
            {
                attributeType = xmlAttribute.Value.Split(':')[1];
            }
        }
        node.Attributes.RemoveAll();
        node.CreateNavigator().CreateAttribute("", "type", "", attributeType);
    }
    doc.Save("output.xml");

    Component_1 c = deserialize<Component_1>(project.ChildNodes[0].OuterXml);

    Console.WriteLine(c.objectArray[0].GetType()); // -> System.Xml.XmlNode[] !
} 
```

输出：

```
<project xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema">
  <Component_1>
    <Value>Component_1.Value</Value>
    <objectArray>
      <anyType type="string">one</anyType>
      <anyType type="string">two</anyType>
    </objectArray>
  </Component_1>
  <Component_1>
    <Value>Component_1.Value</Value>
    <objectArray>
      <anyType type="string">one</anyType>
      <anyType type="string">two</anyType>
    </objectArray>
  </Component_1>
</project> 
```

但是现在使用上面的“T desirialize(string xmlString)”函数进行反序列化失败了。对象数组包含 XmlNode。

是否可以告诉 XmlSerializer 使用项目节点中的命名空间，还是我必须再次插入它们？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-09T20:22:12.570

这将序列化对象并将它们附加到 XmlDocument。在反序列化代码时，将解析命名空间。@Alex：感谢 XPathNavigator 的示例。

```
void test2()
{
    XmlDocument doc = new XmlDocument();
    XmlNode root = doc.AppendChild(doc.CreateElement("root"));

    doc.DocumentElement.SetAttribute("xmlns:xsi", "http://www.w3.org/2001/XMLSchema-instance");
    doc.DocumentElement.SetAttribute("xmlns:xsd", "http://www.w3.org/2001/XMLSchema");

    serializeAppend(root, new object[] { 1, "two", 3.0 });  // serialize object and append it to XmlNode
    var obj = deserialize<object[]>(root.ChildNodes[0]);    // deserialize XmlNode to object
}
T deserialize<T>(XmlNode node)
{
    XPathNavigator nav = node.CreateNavigator();
    using (var reader = nav.ReadSubtree())
    {
        var serializer = new XmlSerializer(typeof(T));
        return (T)serializer.Deserialize(reader);
    }
}
void serializeAppend(XmlNode parentNode, object obj)
{
    XPathNavigator nav = parentNode.CreateNavigator();
    using (var writer = nav.AppendChild())
    {
        var serializer = new XmlSerializer(obj.GetType());
        writer.WriteWhitespace("");
        serializer.Serialize(writer, obj);
        writer.Close();
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-08T12:08:41.213

下面的代码将满足 OP 中的要求，即拥有一个*干净*的XML。它将从所有元素中删除所有贡品，但它会`type`为元素添加一个属性`anyType`，因此仍然可以区分每个元素的原始类型。

```
static void Main(string[] args)
{
    object[] components = new object[] { new Component_1(), new Component_1() };

    var doc = new XmlDocument();
    doc.Load("source.xml");
    var project = doc.GetElementsByTagName("project")[0];

    var nav = project.CreateNavigator();

    var emptyNamepsaces = new XmlSerializerNamespaces(new[] { 
        XmlQualifiedName.Empty
    });

    foreach (var component in components)
    {
        using (var writer = nav.AppendChild())
        {
            var serializer = new XmlSerializer(component.GetType());
            writer.WriteWhitespace("");
            serializer.Serialize(writer, component
                , emptyNamepsaces
                );
            writer.Close();
        }
    }

    foreach (XmlNode node in doc.GetElementsByTagName("anyType"))
    {
        string attributeType = "";
        foreach (XmlAttribute xmlAttribute in node.Attributes)
        {
            if (xmlAttribute.LocalName == "type")
            { 
            attributeType=xmlAttribute.Value.Split(':')[1];
            }
        }
        node.Attributes.RemoveAll();
        node.CreateNavigator().CreateAttribute("","type","",attributeType);
    }
    doc.Save("output.xml");

} 
```

如果要反序列化 XML，则必须创建一个字典：

```
static Dictionary<string, Type> _typeCache; 
```

将映射到相应`Type`值的预期 XML 类型添加到它：

```
_typeCache = new Dictionary<string, Type>();
_typeCache.Add("string", typeof(System.String));
_typeCache.Add("int", typeof(System.Int32));
_typeCache.Add("dateTime", typeof(System.DateTime)); 
```

`XmlNode`并通过将其转换为相应的预期类型来替换数组中的每个：

```
Component_1 c = Deserialize<Component_1>(project.ChildNodes[0].OuterXml);

for (int i = 0; i < c.objectArray.Length; i++)
{
    var type = _typeCache[(((System.Xml.XmlNode[])(c.objectArray[i]))[0]).Value];
    var item = Convert.ChangeType((((System.Xml.XmlNode[])(c.objectArray[i]))[1]).Value, type);
    c.objectArray[i] = item;
}

Console.WriteLine(c.objectArray[0].GetType()); // -> System.String 
```

# php - 使用 PHP 将 SOAP 响应转换为 STD 对象

> ID：14759521
> 
> 赞同：1
> 
> 时间：2013-02-07T19:36:54.150
> 
> 标签：php, soap, wsdl, stdclass

我正在为一个项目学习 SOAP，现在我了解了它的基础知识。不敢相信我以前从未尝试过使用它。这很棒。但无论如何，对于我的问题。

我已经成功地将我的请求响应打印到 Web 浏览器，但我似乎无法将此响应转换为 STD 对象。

我一直在学习教程并将其调整为不同的 WDSL 文件，以完全了解我在做什么。

这是我的 PHP 文件。

```
<?

//////////////////////////////////////
//
//  ABOUT:      This file will send a request to the WSDL file and return a result in the browser window
//  AUTHOR:     Brad Bird
//  DATE:       07/02/2013
//
//////////////////////////////////////

// Setup the SOAP Client options
$wsdl = "http://www.mobilefish.com/services/web_service/countries.php?wsdl";
$options = array(
    "trace" => 1,
    "exception" => 0
);

// Creates new instance of the SOAP Client
$client = new SoapClient($wsdl, $options);

// Return a set of information using one function
$countryCode = "af";
$values = $client->countryInfoByIana($countryCode);

// Prints the details of the request and response to the browser
print "<h2>SOAP Details</h2>";
print "<pre>";
print "<h3>Request</h3> " . htmlspecialchars($client->__getLastRequest()) . "<br />";
print "<h3>Response</h3> " . htmlspecialchars($client->__getLastResponse());
print "</pre>";

// Prints the request in XML format
$xml = $values->countryInfoByIanaResponse;

print "<h2>stdClass Object</h2>";
print "<pre>";
print_r($xml);
print "</pre>"; 
```

我试图从中获取请求的这个 WSDL 文件就在这里。 [http://www.mobilefish.com/services/web_service/countries.php?wsdl](http://www.mobilefish.com/services/web_service/countries.php?wsdl)

由于某种原因，STD 对象部分没有显示任何内容。有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-07T21:27:00.470

嗯，$xml 不是 stdClass 的对象，而是`null`. `$values`然而是。`$values->countryInfoByIanaResponse`不存在。您在 $values 中拥有的只是

```
: object(stdClass) = 
  ianacode: string = "af"
  countryname: string = "Afghanistan"
  latitude: double = 33.93911
  longitude: double = 67.709953 
```

不确定您到底要做什么-也许在 $client 上而不是在结果上调用方法？此外，请查看有关 error_reporting 的 PHP 手册，然后您会在 print_r 行中偶然发现此通知：未定义属性：stdClass::$countryInfoByIanaResponse。

# r - 在R中将数据从pdf转换为数字

> ID：14759522
> 
> 赞同：0
> 
> 时间：2013-02-07T19:36:57.690
> 
> 标签：r

我是“R”的新手，还在学习基础知识..

在一种情况下，我从一个网站获得了一些 xls 格式的人口数据。当我试图读取它（使用 gdata 包中的 read.xls ）时，数据来自 R （一个数据框）。但是，一切都是性格，到目前为止还不错。

在对不必要的行和列等进行了一些清理之后，我正在尝试将数字（以字符形式存在）转换为数值，其中我面临着奇怪的行为......

我的数据元素看起来像这样（这里有一些示例）

```
> class(males1)
[1] "factor"

> males1[1]
[1] 6,665,561 
```

males1 应该包含 n 行，每行有一个元素，即每个州的男性人数。当我在值上应用 as.numeric 时，它实际上给了我一个数字总和

```
> as.numeric(males1[1])
[1] 35 
```

当我将males1转换为向量时，我得到了一个不同的错误

```
> vv=as.vector(males1)
> vv[1]
[1] "6,665,561"
> as.numeric(vv[1])
[1] NA
Warning message:
NAs introduced by coercion 
```

我敢肯定，我缺少一些非常基本的东西..

请帮忙...

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-07T19:43:39.287

我假设您的阅读是用`csv`逗号而不是小数或分隔大数字？

因为逗号：

```
> males1[1]
[1] 6,665,561 # is this meant to be 6665561 ? 
```

是一个因素。当你`as.numeric`对一个因子进行操作时，你会得到一个数字，但它只是按级别顺序排列的因子的数量。

```
 x <- c("a","b","c")
   x <- as.factor(x)
   as.numeric(x)
   #[1] 1 2 3 
```

您是否可以在 read.csv 中删除`?gsub`或使用它们？`dec="."`

# javascript - 我可以使用 javascript 收听函数调用吗？

> ID：14759523
> 
> 赞同：10
> 
> 时间：2013-02-07T19:36:59.157
> 
> 标签：javascript, html, web

我如何使用 javascript 监听带有参数的特定函数调用：

示例：当调用 showname(2) 时，我也可以调用另一个函数，showage(2)

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2013-02-07T19:39:41.923

你可以把它包装起来：

```
var native = window.alert;

window.alert = function(){
    console.log('alerting...');
    native.apply(window, arguments);
    console.log('alerted!');
};

alert('test'); 
```

## 更新

您可以使用 getter 和/或 setter 对属性执行类似的操作：

```
var foo = {
     bar = 'baz'
}; 
```

进入

```
var foo = {
    _bar: 'baz',
    get bar(){
        console.log('someone is taking my bar!');
        return this._bar;
    },
    set bar(val){
        console.log('someone pretends to set my bar to "' + val + '"!');
        this._bar = val;
    }
};

alert(foo.bar);

foo.bar = 'taz'; 
```

封装（私有`_bar`）：

```
var foo = function(){
    var _bar = 'baz';

    return {
        get bar(){
            console.log('someone is taking my bar!');
            return _bar;
        },
        set bar(val){
            console.log('someone pretends to set my bar to "' + val + '"!');
            _bar = val;
        }
    };
}(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-08T00:29:07.063

您不能“挂钩”任意函数调用，不。

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2013-02-07T19:47:25.390

一种方法是向函数添加回调，例如定义：

```
function showname(firstname, lastname, callback){
    alert(firstname + lastname);
    if(callback) callback();
}

function showage(){ 
   alert("who's age?");
} 
```

并调用：

```
showname("John", "Doe", showage); 
```

# php - 按大多数匹配选择和排序

> ID：14759532
> 
> 赞同：8
> 
> 时间：2013-02-07T19:37:28.420
> 
> 标签：php, sql, sql-server

假设我分解了在搜索中传递的字符串。示例：~~“如果有一只狗”~~ **“如果有一只狗”**（愚蠢的美国人）。

我们基于“”爆炸所以结果......

```
if
there
were
a
dog 
```

现在我想运行一个`SQL select * from table_name query where column_name like '%something%' or column_name like '%somethingelse%'...`

我正在尝试确定如何搜索表并按包含最多匹配项的行进行排序。（即，如果第**45**行包含上述拆分项目中的*4 个，而第***21**行仅包含*2 个*，则第**45**行应显示在结果的顶部）。

这将是一个原始的“搜索相关性”逻辑。SQL 中是否有这种检索的特定术语？

建议？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-07T19:40:17.967

只需将比较放在`order by`子句中，使用`case`语句将它们转换为 0/1，然后将它们相加：

```
select *
from table_name query
where column_name like '%something%' or column_name like '%somethingelse%'
order by ((case when column_name like '%something%' then 1 else 0 end) +
          (case when column_name like '%somethingelse%' then 1 else 0 end)
          . . .
         ) desc 
```

我倾向于将查询写为：

```
select (Match1+Match2+. . .) as NumMatches, <rest of columns>
from (select t.*,
             (case when column_name like '%something%' then 1 else 0 end) as Match1,
             . . .
      from tablename
     ) t
order by NumMatches desc 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-07T19:51:09.907

这是@Gordon 出色答案的变体：

```
SELECT FieldToSearch, 
  CASE WHEN ' ' + FieldToSearch + ' ' like '% if %' then 1 else 0 end
      + CASE WHEN ' ' + FieldToSearch + ' ' like '% there %' then 1 else 0 end 
      + CASE WHEN ' ' + FieldToSearch + ' ' like '% was %' then 1 else 0 end
      + CASE WHEN ' ' + FieldToSearch + ' ' like '% a %' then 1 else 0 end
      + CASE WHEN ' ' + FieldToSearch + ' ' like '% dog %' then 1 else 0 end matches
FROM YourTable
ORDER BY matches DESC 
```

这是[小提琴](http://sqlfiddle.com/#!3/13b33/10)。

祝你好运！

# excel - 使用名称更改的工作簿记录 excel 宏

> ID：14759534
> 
> 赞同：0
> 
> 时间：2013-02-07T19:37:32.867
> 
> 标签：excel, excel-2007, vba

在 Excel 2010 中，有人单击移动或复制到新工作簿后，我有一个要求，然后在新工作簿上运行以下语句：

```
Sub CSAColorFormattingSSRS2008()
      ActiveWorkbook.Colors = Workbooks("Book4").Colors
End Sub 
```

问题是“Book4”是工作表来自的上一个工作簿，但这个工作簿名称可以更改。有没有办法通过更改您要复制的工作簿名称来做到这一点？我试图创建一个按钮来为每个人运行这个宏，但所有过去的书名总是不同的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-07T20:05:35.140

您可以这样做，按钮为它们执行复制操作，然后设置颜色。

```
Option Explicit

Sub CopySetColor()
Dim strWkb As String, strSheet As String
strWkb = ThisWorkbook.Name
strSheet = ActiveSheet.Name

'get Workbook name to copy to -> ensure that only 2 workbooks are open, this and the one you want to copy to
Dim wkb As Workbook, wkbCopyTo As Workbook

For Each wkb In Workbooks

    If wkb.Name <> strWkb Then

        Set wkbCopyTo = wkb
        Exit For

    End If

Next

Sheets(strSheet).Copy Before:=wkbCopyTo.Sheets(1)

CSAColorFormattingSSRS2008 strWkb

End Sub

Sub CSAColorFormattingSSRS2008(strName As String)

      ActiveWorkbook.Colors = Workbooks(strName).Colors

End Sub 
```

# ios - 替换当前视图控制器时 TSAlertView 崩溃

> ID：14759545
> 
> 赞同：0
> 
> 时间：2013-02-07T19:37:45.277
> 
> 标签：ios, cocoa-touch, uikit, exc-bad-access, uistoryboardsegue

我正在使用优秀的[TSAlertView](https://github.com/TomSwift/TSAlertView)项目为有视觉障碍的人创建带有放大字体的弹出警报。不幸的是，我遇到了一个困扰我几天的问题。

`TSAlertView`当用户即将移动到应用程序中的新页面以确认当前页面的内容时，我正在使用作为验证器弹出窗口。即，用户按下按钮移动到应用程序中的新页面，`TSAlertView`屏幕上的弹出窗口，如果用户按下是按钮，则当前使用自定义segue`UIViewController`替换为不同的页面。`UIViewController`该应用程序随机崩溃，`EXC_BAD_ACCESS`我有根据的猜测是，当在完成其关闭动画`UIViewController`之前释放电流时，它会崩溃。`TSAlertView`

一个明显的解决方法是增加当前动画`UIViewController`和新动画之间的动画持续时间，但这仅仅依赖于良好的时机，这是灾难的根源。有没有一种简单的方法可以防止演示`UIViewController`被解除分配，直到`TSAlertView`被解除分配？主项目使用 ARC，`TSAlertView`而非 ARC。

编辑：橡皮鸭在行动。我在方法中添加了以下两行`-(void) show`：

```
_presentingViewController = [[UIApplication sharedApplication] keyWindow].rootViewController;
[_presentingViewController retain]; 
```

`release`和中的一个对应`-(void) dealloc`。现在一切似乎都正常。我是否正在创建一个循环保留链？有更好的答案吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-12T07:56:17.290

Peter Hosey 是对的 - 你*应该*使用 Zombies 来找出导致崩溃的确切原因。

但是，我的直觉告诉我（在查看 TSAlertView.h 之后），当您显示警报视图时，您将视图控制器设置为委托。您的猜测似乎很可能，您的视图控制器正在被释放，并且警报视图正在尝试与悬空指针对话。

坏消息是，如果您的控制器保留了 AlertView，您的修复*可能会*导致保留循环。即使您没有，更改也极有可能*导致*保留循环，我不会成功。

好消息是，您仍然可以应用 ARC 之前的最佳实践，并取消您的代表。在 ARC 下，dealloc 仍然是在对象被释放时调用的有效方法——你只是不调用 super。这使您有机会在对象达到其生命周期的尽头时进行清理。如果您在显示后保留对警报视图的引用，那么您应该能够执行类似以下的操作来清理悬空指针：

```
- (void)dealloc {
    self.alertView.delegate = nil;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-01-18T09:22:08.857

我也遇到了这个错误**[TSAlertView onKeyboardWillShow:]: message sent to deallocated instance**同时尝试打开 TSAlert。我的解决方案如下：

尝试执行 2 个步骤：

1.  为 TSAlertView 类添加 -fno-objc-arc 标志。有关说明，请访问：[如何为项目中的单个文件禁用 ARC？](https://stackoverflow.com/questions/6646052/how-can-i-disable-arc-for-a-single-file-in-a-project)
2.  添加行 [[NSNotificationCenter defaultCenter] removeObserver:self]; 进入**onKeyboardWillHide：**动画下TSAlertView类的方法**：^**块。

希望它有所帮助，它对我有用。

# php - 在页面加载时加载此 AJAX 调用

> ID：14759547
> 
> 赞同：1
> 
> 时间：2013-02-07T19:37:56.577
> 
> 标签：php, jquery, ajax, jquery-mobile

我希望这个 AJAX 调用在页面加载时加载。现在我需要点击刷新按钮才能加载。

更新代码：

```
$(document).on("pageinit", "#members", function() {
$.ajax({
url: 'data.php',
success: function(data) {    
$("#result").html(data).trigger('create');
$("#result").listview('refresh');
}
});
}); 
```

如果我输入页面 URL，它会正确加载，但当我浏览我的`index.php`文件时不会。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-07T19:53:53.037

第一的，

```
$("document") 
```

应该

```
$(document) 
```

因为没有`<document>`元素，如果有，你就不会调用`.ready()`它们。

接下来，您看到此问题的原因是因为`$(document).ready()`每次整页加载仅触发一次。在 jQuery Mobile 中更改为新页面不会触发整个页面加载，而是使用 ajax 在新页面中加载。为了解决这个问题，jQuery mobile 有一个名为“pageinit”的事件，该事件会在加载的页面上触发。这就是在您的情况下绑定到它的方式：

预 jquery 1.7

```
// yes, i know delegate is better, but the documentation specifically suggested using .live
$("#pageid").live("pageinit",function(){
    $.ajax({
        url: 'data.php',
        success: function(data) {    
            $("#result").html(data).trigger('create');
            $("#result").listview('refresh');
        }
    });
}); 
```

后 jquery 1.7

```
$(document).on("pageinit","#pageid",function(){
    $.ajax({
        url: 'data.php',
        success: function(data) {    
            $("#result").html(data).trigger('create');
            $("#result").listview('refresh');
        }
    });
}); 
```

刷新页面起作用的原因是，当您刷新页面时，`$(document).ready()`事件就会发生。

# permissions - virtualenv python 可执行文件（lubuntu-12.10）的奇怪权限问题

> ID：14759549
> 
> 赞同：13
> 
> 时间：2013-02-07T19:37:58.543
> 
> 标签：permissions, python-2.7, virtualenv, virtualenvwrapper, ubuntu-12.10

简而言之，我的问题是当我尝试使用来自 virtualenvwrapper 的 mkvirtualenv 创建一个 virtualenv 时，我收到以下错误：

```
$ mkvirtualenv test
New python executable in test/bin/python
ERROR: The executable test/bin/python could not be run: [Errno 13] Permission denied 
```

但是，当我查看二进制文件的权限时，据我所知，一切都应该没问题......

```
$ ll ~/.virtualenvs/test/bin
total 2604
drwxr-xr-x 1 (username) staff       5 Feb  7 19:10 ./
drwxr-xr-x 1 (username) staff       5 Feb  7 18:51 ../
-rwxr-xr-x 1 (username) staff 2655776 Feb  7 19:10 python*
lrwxrwxrwx 1 (username) staff       6 Feb  7 19:10 python2 -> python*
lrwxrwxrwx 1 (username) staff       6 Feb  7 19:10 python2.7 -> python* 
```

当我尝试以 root 身份运行时，我遇到了类似的错误：

```
$ sudo .virtualenvs/test/bin/python
sudo: unable to execute .virtualenvs/test/bin/python: Permission denied 
```

我在我的 macbook 上运行 Lubuntu 12.10，与 Mountain Lion 一起，并设置了一个分区以用作两个安装之间的共享主目录，大致遵循此处的说明（[http://mikeclaffey.com/dual-boot- osx-ubuntu/](http://mikeclaffey.com/dual-boot-osx-ubuntu/)）。据我所知，这一切都在 ubuntu 和山狮中正常工作，但我提到它只是因为这意味着我的 lubuntu 安装不是严格标准的。

我已经使用 apt-get 安装了 python-setuptools 和 python-dev，然后用于`sudo easy_install pip`获取 pip-1.2.1，然后使用`sudo pip install virtualenv virtualenvwrapper`, 获取 virtualenv-1.8.4 和 virtualenvwrapper-3.6。

更多细节：我`.virtualenvs`在我的主目录中创建，并添加：

```
export WORKON_HOME=$HOME/.virtualenvs
source /usr/local/bin/virtualenvwrapper.sh
export PIP_VIRTUALENV_BASE=$WORKON_HOME 
```

到我的`.bashrc`.

此外，我尝试使用`sudo apt-get install python-pip`而不是 easy_install（这安装了 pip-1.1，而不是 pip-1.2.1），但得到了相同的权限错误。

任何帮助将不胜感激！

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2013-02-07T21:09:03.213

事实证明，问题与我安装共享分区的方式有关。我已安装（在 /etc/fstab 中）：

```
UUID=....  /home   hfsplus   auto,user,nodev,rw    0    0 
```

但是，“用户”选项自动包含“noexec”——因此，在 virtualenv 将系统 python 二进制文件复制到我的主分区后，由于“noexec”标志，它无法运行。

将我的 fstab 更改为：

```
UUID=....  /home   hfsplus    auto,user,exec,nodev,rw   0   0 
```

解决了这个问题。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-28T07:04:26.703

我曾经也有过一样的问题。我尝试在我的主文件夹中创建一个 virtualenv 并且效果很好，但是当我尝试在不同的分区上创建一个时出现该错误。

所以要解决你的问题，要么尝试不同的位置，要么看看东西是如何安装的。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2016-03-23T11:27:38.520

正如其他答案（谢天谢地）已经说明的那样，这是一个权限问题。我通过使用正确的权限重新安装所需的驱动器来解决它`exec`（如前所述）。但我无法使用@duncanm 的答案，因为我在`/etc/fstab`文件中找不到我的驱动器路径。

我在我的 Ubuntu 14.04 上执行了以下操作，它完成了这项工作。

**卸载**- _

```
$ sudo umount /media/ashish/Work/ 
```

要**以正确的权限重新安装**-

```
$ sudo mkdir /media/ashish/Work
$ sudo mount -o exec /dev/sda6 /media/ashish/Work/
$ cd /media/ashish/Work/ 
```

`/dev/sda6`我通过查看文件管理器中的属性选项卡找出了这个部分。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-03-16T14:42:26.947

正如您所发现的，我认为这主要是 exec 权限的问题。您也可以通过在 /data 或 /sd-ext 的子目录中创建 virtualenv 来解决此问题。我正在研究多用户支持，它将主目录放在 /data/home 下，而不仅仅是一张 sd 卡“主目录”。

# windows-runtime - CreateFile 的 dwShareMode 的 WinRT 模拟是什么？

> ID：14759553
> 
> 赞同：3
> 
> 时间：2013-02-07T19:38:03.763
> 
> 标签：windows-runtime

在 Win32 CreateFile() API 中，我可以在打开文件时指定 dwShareMode，以防止在打开文件时删除或更改该文件。

我正在寻找 WinRT 中的 C# 模拟。假设我打开一个文件：

```
StorageFile sf = await Windows.Storage.ApplicationData.Current.LocalFolder.GetFileAsync("x.txt");
IRandomAccessStreamWithContentType iras = await sf.OpenReadAsync(); 
```

然后从 CMD.EXE 的实例，我可以 CD 到 ...\AppData\Local\Packages\zzz\LocalState 目录并在 WinRT 应用程序打开文件时删除该文件。

我可以在我的 C# 代码中做什么来导致删除失败？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-07T23:47:23.790

不能直接使用。这对于 WinRT 来说很典型，它通过简单地不公开功能来强制应用程序运行良好，而不是在 api 级别占用资源。这也是一个相当严重的可用性问题，当用户离开应用程序时，应用程序可能会暂停很长时间。将文件锁定那么长时间当然是非常有问题的，用户没有很好的方法来诊断问题。

无论如何，当您使用 LocalFolder 时，这不是问题，没有其他人可以做到这一点。好吧，不算有上帝帐户的人。

有一个可用的后门，您可以调用 CreateFile2()。商店应用程序允许使用的 CreateFile() 版本。它有一个 dwShareMode 参数。在 C# 程序中使用它并没有什么乐趣，而且商店验证拒绝的可能性也不为零。

# delphi - 在运行时注册动态数组

> ID：14759559
> 
> 赞同：1
> 
> 时间：2013-02-07T19:38:21.110
> 
> 标签：delphi, runtime, dynamic-arrays

例如，当您声明动态数组时，您会这样做

```
var
  MyArray: array of Byte; 
```

这样编译器就知道当它超出范围时它必须完成该变量（数组）。但我想将动态数组声明为这样的指针

```
var
  MyArray: Pointer; 
```

我知道如何在运行时动态初始化（设置长度）到这样的数组。问题是编译器不知道它需要完成它。我想知道是否有办法告诉编译器在超出范围时将该指针最终确定为数组。我会告诉他当我第一次初始化数组时。

我知道这是一个 hack，我不想听到这不是正确的方法。我有一个非常具体的愿望（问题），我想知道这是否可以实现。我想这不像编译器那样使用编译器魔法。

**编辑**：

我想保持问题简单，但有些人想知道更多，我会告诉更多。我认为这与问题无关，但无论如何，就在这里。

我想为每条记录保留 4 个字节（或 64 位系统上的 8 个字节）。它更像是一个游戏。我的想法是在变量记录 TSimpleData 中插入一个指向动态数组的指针。这类记录不接受需要最终确定的变量。完全清楚为什么。但我想知道以后是否有办法注册完成。我 99% 确定没有办法，但要求 100% 确定没有害处。波纹管是有问题的相关代码。我希望 FComplexData 作为简单指针成为 TSimpleData 的一部分。

```
 TSimpleData = record { do not pack this record; it is compiler-generated }
    case Byte of
      atInteger:   (VInteger: Integer);
      atCardinal:  (VCardinal: Cardinal);
      atBoolean:   (VBoolean: Boolean);
      atObject:    (VObject: TObject);
      atPointer:   (VPointer: Pointer);
      atClass:     (VClass: TClass);
      atWideChar:  (VWideChar: WideChar);
      atChar:      (VChar: AnsiChar);
    {$IFDEF AnyValue_UseLargeNumbers}
      atInt64:     (VInt64: Int64);
      atExtended:  (VExtended: Extended);
    {$ENDIF}   
  end;

  TAnyValue = packed record   private
    FValueType: TValueType;   
  {$IFNDEF AnyValue_NoInterfaces}
    FInterface: IInterface;   
  {$ENDIF}
    FSimpleData: TSimpleData;
    FComplexData: array of Byte;
    ...    
  end; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-07T19:49:23.270

没有办法按照你的要求去做。使编译器自动完成动态数组的唯一方法是声明一个动态数组。如果没有实际声明，您不能将动态数组变量“插入”到您的代码中。

声明后，您可以将该指针分配给它，它会像任何其他动态数组一样被清理。如果需要，您可以将该行为包装到一个函数中：

```
procedure CleanUpArray(P: Pointer);
var
  Arr: array of Byte;
begin
  Pointer(Arr) := P;
end; 
```

如果你调用`CleanUpArray(MyArray)`，存储在`Pointer`变量中的动态数组将被清理——它的引用计数减少 1，并且可能释放它的内存——尽管存储在其中的值`MyArray`将保持不变。

该函数之所以有效，是因为类型转换禁用了动态数组赋值语句中固有的任何引用计数代码，因此它本质上是按位复制。但是，一旦函数返回，编译器插入的变量清理代码就会运行。它注意到该变量是非空的，因此它假定该变量中有一个动态数组引用，并且该数组被清理了。

*用它的真实*类型声明变量要好得多。它使您*和*编译器的生活更轻松。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-14T13:54:58.610

要回答我自己的问题，没有直接的方法可以做到这一点。但由于我不会轻易放弃，所以提出了一个解决方案：

[http://www.cromis.net/blog/2013/02/tanyvalue-an-attempt-to-make-the-best-variable-data-container/](http://www.cromis.net/blog/2013/02/tanyvalue-an-attempt-to-make-the-best-variable-data-container/)

它基本上完成了 Embarcadero 或 Borland 多年前应该做的事情。

# asp.net - 将 SVN 与 Visual Studio 2003 集成

> ID：14759560
> 
> 赞同：5
> 
> 时间：2013-02-07T19:38:29.853
> 
> 标签：asp.net, visual-studio, svn, visualsvn

我正在尝试找到一个不是 VisualSVN 的免费工具（我知道 VisualSVN 与 Visual Studio 2003/2005/2008/2010 集成......）将 Sub Version/TortoiseSVN 与 Visual Studio 2003 集成。还有另一个工具将 Visual Studio 2005/2008/2010 与 SVN 集成，在此处的超链接中给出 -> [http://garrys-brain.blogspot.ca/2007/07/tortoisesvn-and-visual-studio.html](http://garrys-brain.blogspot.ca/2007/07/tortoisesvn-and-visual-studio.html)但不与 Visual Studio 集成2003 年。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-08-16T03:42:47.377

[Agent SVN](http://www.zeusedit.com/agent/)是一个*MS-SCCI* Subversion 插件，因此它应该与 VS 2003 一起使用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-07T19:48:44.373

我们所做的是在 VS 2003 中将各种 TortoiseSVN shell 命令设置为外部工具。效果很好。

# java - 在 NetBeans 中获取“NoSuchElementException：未找到行”，但在 DrJava/命令行中没有？

> ID：14759562
> 
> 赞同：4
> 
> 时间：2013-02-07T19:38:30.830
> 
> 标签：java, netbeans

我是 Java 和 NetBeans 的新手，还没有找到与我当前遇到的问题完全相同的问题。

我有这个基本代码，旨在打印现有文本文件的第一行：

```
14    File test = new File("C:\\Users\\Computer\\Desktop\\testfile.txt");
15    Scanner read = new Scanner(test);
16    
17    String firstline = read.nextLine();
18    System.out.println(firstline);
19  
20    read.close(); 
```

出于某种原因，相同的代码在 Dr Java 和 Windows 命令行中运行良好，但在 NetBeans 中，我不断得到这个：

```
Exception in thread "main" java.util.NoSuchElementException: No line found
at java.util.Scanner.nextLine(Scanner.java:1585)
at testfile.Testfile.main(Testfile.java:18) 
```

为什么？我发现似乎可以解决问题的一件事是用“FileReader”替换“File”，但我不确定为什么会这样。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-07T19:57:06.280

首先，您应该检查您的扫描仪是否有一些数据。这是一个例子：

```
File test = new File("D:\\testfile.txt");
Scanner read = new Scanner(test);

String line;
while (read.hasNextLine()) {
    line = read.nextLine();
    // your logic
    System.out.println(line);
}
read.close(); 
```

其次，当您不检查“read.hasNextLine()”（或 read.hasNext 或其他任何 read.hasXxx 方法）时，您应该从代码中得到 2 种行为：
1- java.util.NoSuchElementException 当您的文件是**空**。
2-您将打印第一行。
-> 我用 Java7u13 测试了 NetBeans 7.3 RC1，它可以正常工作。

在这里您可以找到有关 I/O 和 Scanner 的更多信息：http: [//docs.oracle.com/javase/tutorial/essential/io/scanning.html](http://docs.oracle.com/javase/tutorial/essential/io/scanning.html)

这是使用 try-with-resources 的新 Java 7 方式，它会自动为您创建和关闭 Scanner。（您可以使用所有实现接口 Closeable 的对象来获取此信息）

```
File test = new File("D:\\testfile.txt");
try (Scanner read = new Scanner(test)) {
    String line;
    while (read.hasNextLine()) {
    line = read.nextLine();
    // your logic
    System.out.println(line);
    }
} 
```

# javascript - 如何在Javascript中编写这个数字检测正则表达式？

> ID：14759566
> 
> 赞同：1
> 
> 时间：2013-02-07T19:38:38.543
> 
> 标签：javascript, regex, perl

这是它在 Perl 兼容的正则表达式中的样子（取自[https://stackoverflow.com/a/4824952/377920](https://stackoverflow.com/a/4824952/377920)）：

```
(?:(?<!\d)\d{1,3}(?!\d)) 
```

但是，显然 Javascript 缺少一些正则表达式功能，所以这不起作用。

我正在尝试匹配两端可以有非白色字符的 1-3 个长连接数字。

例如“Road 12A55, 10020”将匹配 12 和 55。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-07T19:41:31.010

你是对的，JavaScript 不支持lookbehinds。

看起来您正在尝试检测不超过 3 位数字的序列。根据周围的上下文，您可以使用它来代替：

```
/(?:^|\D)\d{1,3}(?:\D|$)/ 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-02-07T19:41:49.223

您可以在没有后视的情况下重写表达式 - 只需确保获得第 1 组：

```
/(?:^|\D)(\d{1,3})(?!\d)/ 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-02-07T19:42:48.727

Javascript 不支持`look-behinds`，这就是您的正则表达式不起作用的原因。

你可以试试这个替代方案： -

```
/(?:^|\D)(\d{1,3})(?!\d)/ 
```

并得到`group 1`.

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-02-07T20:50:50.567

这将返回 12 和 55：

```
var output = 'Road 12A55, 10020'.replace(/D+|\d{4,}/g, ' ').match(/\d+/g)

alert(output) 
```

# matlab - 基于重叠区域数量的颜色代码圆形对象

> ID：14759574
> 
> 赞同：-2
> 
> 时间：2013-02-07T19:39:17.763
> 
> 标签：matlab

如何创建一个带有重叠圆圈的图，其中重叠区域根据重叠的圆圈数量进行颜色编码？

```
clear; 
noOfNodes = 200; 

x = rand(1,1000 )*1000; 
y = rand(1,1000 )*1000; 

R = 8; 

netXloc = x; 
netYloc = y; 

grid on
set(gca, 'GridLineStyle', '-');
grid(gca,'minor')

hold on

scatter ( x, y, 'R.'); 
axis square 
hold on

axis ( [ 0.0, 1000.0, 0.0, 1000.0 ] ) 
title ( 'WSN coverage' ); 

hold off

for i = 1:1000 

        ctr = [x(i) y(i)]-R; 
        diameter = 2*R; 
        h = rectangle('Position',[ctr,diameter,diameter],'FaceColor',[0.5 0.5 0.5],'Curvature',[1,1],'LineWidth',.5,'LineStyle','-'); 
     alpha .6;
        end; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-07T21:14:11.083

这是如何做到的：

```
% size of image
sz = [800 800];

% generate coordinates
y = 1:sz(1);
x = 1:sz(2);
[xx yy] = meshgrid(x,y);

% draw circles
ci1 = (xx-300).^2 + (yy-400).^2 <= 200^2;
ci2 = (xx-500).^2 + (yy-400).^2 <= 200^2;
ci3 = (xx-400).^2 + (yy-300).^2 <= 200^2;
ci4 = (xx-400).^2 + (yy-500).^2 <= 200^2;

% draw image containing circles
figure; imagesc(ci1 + ci2 + ci3 + ci4); 
```

结果如下：

![在此处输入图像描述](../Images/1d4ccd452e9bdf2d7c58fd10680ce105.png)

# android - 如何修改和重新发布 AOSP 应用程序？

> ID：14759579
> 
> 赞同：6
> 
> 时间：2013-02-07T19:39:28.810
> 
> 标签：android, package

我对股票 android 电子邮件应用程序中缺少一个简单的功能感到恼火。由于这个应用程序是作为[开源](https://github.com/android/platform_packages_apps_email)发布的，我可以很容易地解决这个问题。

问题：如何以我和其他用户可以安装修改后的电子邮件应用程序（无需 root 访问权限）的方式发布此修改？我尝试了以下方法：

1.  通过大量复制，我能够使用标准的 Eclipse/ant 工具链构建电子邮件应用程序，而无需使用使用 make-scripts 的 ASOP 工具链。
2.  现在安装此应用程序会导致错误，因为该软件包已安装（显然，我没有要更新的唱歌键）
3.  禁用设备上的电子邮件应用程序也无济于事，我仍然无法安装我的新应用程序。

我虽然想在清单中更改应用程序的包名，但这并不是那么简单：您还必须将所有类移动到新包中。此外，正如您在[AndroidManifest](https://github.com/android/platform_packages_apps_email/blob/master/AndroidManifest.xml)中看到的，应用程序定义了新的权限 ( `com.android.email.permission.READ_ATTACHMENT`) 和其他在安装修改后的包时会导致重复错误的内容。这些权限是源中的字符串引用。

手动修改每个文件然后调试每个错误真的是我问题的唯一解决方案吗？由于我已经修改并移动了每个文件，因此这些修改也会使引入新版本的电子邮件应用程序变得非常困难。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-07T19:46:12.067

> 我想在清单中更改应用程序的包名称

这将是必需的。

> 您还必须将所有类移动到新包中

不必要。`R`将生成到清单中声明的​​包中，因此您需要安排导入`R`该类。如果适用，您将需要更新清单本身以使用完全限定的类名而不是裸类名。

> 此外，正如您在 AndroidManifest 中所见，应用程序定义了新权限 (com.android.email.permission.READ_ATTACHMENT) 和其他在安装修改后的包时会导致重复错误的内容。

完全可以定义现有权限。我不知道你在哪里/如何得到“重复错误”。

> 手动修改每个文件然后调试每个错误真的是我问题的唯一解决方案吗？

或多或少。请参阅上面的“不一定”段落。

> 由于我已经修改并移动了每个文件，因此这些修改也会使引入新版本的电子邮件应用程序变得非常困难。

您是决定开始这一任务的人，而不是将您的更改贡献给现有的开源邮件应用程序，例如 K-9 Mail（几年前也分叉了 AOSP 电子邮件应用程序）或 AOSP 电子邮件应用程序本身（通过[AOSP 贡献流程](http://source.android.com/source/submit-patches.html)）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-24T23:36:33.860

这个话题可能已经过时了，但我想我会分享我为后代所做的事情。我能够使用上述信息来修改浏览器源并创建我自己的应用程序版本（可以与股票应用程序并行安装）。我做了什么：

*   在清单中，更改包名称
*   在 res->values->strings 中，更改应用程序标签（这只是为了方便，避免有 2 个应用程序同名）
*   在清单中，删除“原始包”属性（可能不是必需的）
*   在清单中，更改提供者权限（以匹配我的新包名称）
*   确保清单中的所有类名都是完全限定的。

最后一步进行了几次尝试，但这只是构建、安装、启动和检查 LogCat 以查找错误引用的问题。

# winforms - winforms中的应用程序控制器

> ID：14759580
> 
> 赞同：1
> 
> 时间：2013-02-07T19:39:28.870
> 
> 标签：winforms, design-patterns

我必须编写一个多表单应用程序，用于操纵代表体育赛事的对象的状态。

对象可以处于许多不同的状态，根据我需要显示某个表单或启用或禁用表单上的控件的状态，我已经读到应用程序控制器可以用来更好地组织工作流程一个复杂的 Windows 窗体应用程序，有没有人可以指出我的应用程序控制器实现的好例子？还是会有更好的方法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-07T19:45:16.627

看看这个例子，它似乎是一个正确的例子：http: [//lostechies.com/derickbailey/2009/04/18/decoupling-workflow-and-forms-with-an-application-controller/](http://lostechies.com/derickbailey/2009/04/18/decoupling-workflow-and-forms-with-an-application-controller/)

# node.js - 在 nodejs 下部署远程 github 存储库的一部分

> ID：14759581
> 
> 赞同：3
> 
> 时间：2013-02-07T19:39:33.373
> 
> 标签：node.js, github

作为我正在修补的 npm 包使用的构建脚本的一部分（-g 或必需），我需要将远程 github 存储库中目录的内容复制到该`built`目录中。

例如。ACE 编辑器版本 - 远程上的一堆文件。 [https://github.com/ajaxorg/ace-builds/tree/master/src-min-noconflict](https://github.com/ajaxorg/ace-builds/tree/master/src-min-noconflict)

我不希望我的模块在本地拥有 ACE 文件，并且我可以要求和使用它们的构建没有 npm 包。它应该在构建时从最新的遥控器中提取它。

我宁愿不克隆 repo，但也许可以抓住 zipball 并从中做出一些事情。

有谁知道任何包或脚本已经可以在没有访问`git`外壳的情况下执行此操作？我对依赖 git 犹豫不决，因为您可以全局安装软件包并将其用作二进制文件...

我还可以做些什么？节点吉普？沃洛也许？组件.js？任何可以从远程 git 文件系统引用和部署的东西......

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-07T21:37:11.423

这是一个选项吗？滚动你自己的可能很简单（我不知道存在任何东西）

*   利用[Ajax.org的](https://github.com/ajaxorg)[GitHub v3 API](http://developer.github.com/v3/)的 JS 包装器：[node-github](http://ajaxorg.github.com/node-github)。不需要外壳。
*   [repos.getContent](http://ajaxorg.github.com/node-github/#repos.prototype.getContent)返回文件或*文件夹*的内容。
*   [GetContents](http://developer.github.com/v3/repos/contents/#get-contents)返回`Base64`内容路径中每个文件的编码内容
*   解码并做你想做的事..

**警告**：我从未尝试过这个

* * *

**编辑**

这是一些粗略的代码。文件夹级别的内容查询不会返回编码的内容，因此您需要迭代每个文件并发出另一个 API 请求（这可能会破坏未经身份验证的请求的[速率限制）](http://developer.github.com/v3/#rate-limiting)

```
var GitHubApi = require("github")
   ,fs = require("fs");

var github = new GitHubApi({
  version: "3.0.0"
 ,timeout: 5000
});

var msg = {
  user: "visionmedia"
 ,repo: "express"
 ,path: "lib/router"
};

github.repos.getContent(msg, function(err, res) {
  delete res.meta; //appended by wrapper, remove for iteration

  for(file in res) {
    msg.path = res[file].path;      

    github.repos.getContent(msg, function(err, res) {

      fs.writeFile(res.name
                  ,res.content
                  ,res.encoding
                  ,function(err){
                     console.log("Wrote %s to filesystem!", res.name)
                   });    
    }); 
  };
}); 
```

# c# - 数据注释 - DisplayFormat - 格式化数字字符串

> ID：14759582
> 
> 赞同：3
> 
> 时间：2013-02-07T19:39:40.283
> 
> 标签：c#, asp.net-mvc, asp.net-mvc-3, entity-framework, data-annotations

我有以下字符串：`"10222002750400447092095835"`

我希望它像这样显示：`10 2220 0275 0400 4470 9209 5835`

我尝试执行以下操作，但完全没有结果：

```
[DisplayFormat(DataFormatString = "{0:00 0000 0000 0000 0000 0000 0000}", ApplyFormatInEditMode = true)] 
```

或者

```
[DisplayFormat(DataFormatString = "{0:## #### #### #### #### #### ####}", ApplyFormatInEditMode = true)] 
```

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-07T20:09:35.770

我相信您正在寻找的是字符串屏蔽。见下文。

[Stackoverflow - 如何屏蔽字符串](https://stackoverflow.com/questions/9705955/how-to-mask-string) [Stackoverflow - 将屏蔽应用于字符串](https://stackoverflow.com/questions/5509172/apply-mask-to-a-string)

# java - 压缩/序列化/操作大量数据的有效方法

> ID：14759586
> 
> 赞同：4
> 
> 时间：2013-02-07T19:40:01.237
> 
> 标签：java, python, performance

我有一个包含 25,000 个浮点数（`,`分隔）的文件，并且大约有 100K 个这样的行。文件的一行看起来像：

```
1689.97,-9643.39,-82082.1,9776.09,-33974.84,-67247.38,32997.34,72811.53,31642.87,-949.6,9340.68,-85854.48,-17705.36,187.74,-3002.6,-35812.21,37382.32,22770.78,40893.09,45743.99,-6500.92,26243.85,13975.95,0,56669.47,-25865.36,-17066.78,26788.57,0,-36554.86,-3687.19,18933.93 
```

我有一个两部分的问题。

1.  有没有办法（在 Java 或 Python 中）有效地压缩数据而不会影响性能。压缩将每天进行一次，但必须经常读取数据。
2.  是否可以以压缩形式操作数据，例如我想在前 10 行上聚合前 10 列而不进行解压缩。这样我就不必担心频繁读取压缩数据。挑战之一是将 25,000 个字符串转换为浮点数以供添加。

我看过，`gzip`它们`zcat`是不错的选择。但我想找到一些压缩或序列化算法来存储数据`Java/Python`并在不解压缩的情况下执行读取。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-07T20:11:38.590

在 Java 中，您可以`OutputStream`使用[GZIPOutputStream](http://docs.oracle.com/javase/6/docs/api/java/util/zip/GZIPOutputStream.html)和[GZIPInputStream](http://docs.oracle.com/javase/6/docs/api/java/util/zip/GZIPInputStream.html)`InputStream`包装您的数据，以使用 GZIP 算法即时压缩/解压缩您的数据。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-07T21:13:08.547

您可以将其写为字节，而不是将其写为文本。您必须将 premitives 转换为/从 premitives 转换为字节数组，但我认为这不会太难。我知道您可以使用[Float.floatToRawIntBits()](http://docs.oracle.com/javase/1.5.0/docs/api/java/lang/Float.html#floatToRawIntBits%28float%29)转换为 int 并使用[Float.intBytesToFloat()](http://docs.oracle.com/javase/1.5.0/docs/api/java/lang/Float.html#intBitsToFloat%28int%29)从 int 返回。将 int 转换为 byte[] 只是几个位移的问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-07T19:49:23.310

使用`DataOutPutStream`和 writeFloat，你不需要使用逗号分隔符

# android - 使用刷新按钮删除片段并重新加载

> ID：14759587
> 
> 赞同：1
> 
> 时间：2013-02-07T19:40:03.520
> 
> 标签：android, android-listview, android-fragments, refresh

我有三个`Fragments`（`FragmentActivity`带`viewPager`）。我想添加一个刷新按钮，它基本上会删除所有片段并重新加载为新的。每个`Fragment`都有 `ListView`。这是不恰当的黑客攻击还是我应该刷新`ListViews`？（如果是这样，我不确定如何访问`ListViews`from `Fragments`？`FragmentActivity`）

这是我设置片段的方式：

```
ActionBar actionBar = getSupportActionBar();
            actionBar.setNavigationMode(ActionBar.NAVIGATION_MODE_TABS);

            mSectionsPagerAdapter = new SectionsPagerAdapter(
                    getSupportFragmentManager());

            mViewPager = (ViewPager) findViewById(R.id.viewpager);
            mViewPager.setAdapter(mSectionsPagerAdapter);
            mViewPager.setOffscreenPageLimit(3);

            mViewPager
                    .setOnPageChangeListener(new ViewPager.SimpleOnPageChangeListener() {
                        @Override
                        public void onPageSelected(int position) {
                            actionBar.setSelectedNavigationItem(position);

                        }
                    });

            for (int i = 0; i < mSectionsPagerAdapter.getCount(); i++) {
                actionBar.addTab(actionBar.newTab()
                        .setText(mSectionsPagerAdapter.getPageTitle(i))
                        .setTabListener(this));
            } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-07T19:46:46.060

如果我正确阅读了您的问题，您的 FragmentActivity 应该能够正确访问三个 Fragment 中的每一个吗？然后设置一个静态方法来刷新每个片段中的列表（重新附加适配器），并在按下刷新按钮时让 FragmentActivity 中的一个方法调用这三个方法。

# php - 用于检查类别帖子并更改其部分 css 的函数 PHP（无 WORDPRESS）

> ID：14759588
> 
> 赞同：-3
> 
> 时间：2013-02-07T19:40:04.433
> 
> 标签：php, css, function, colors, categories

我正在尝试找到一个检查帖子类别的函数（PHP5 编程），并根据结果（在主页中）更改它的部分样式（背景颜色）。

我不知道从哪里开始。有什么建议吗？

（我没有使用wordpress）

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-07T20:10:24.643

您可以使用 CSS 来完成，只需要根据类别为帖子添加一个适当的类

* * *

无论如何，这里有一个根据类别改变背景颜色的例子。您可以以此为起点

**模拟邮政类**

```
 class Post {
        public $text;
        public $category;
        public $style;

        public function __construct($text, $category) {
            $this->text = $text;
            $this->category = $category;
            $this->changeBg($category);
        }

        public function outputHTML() {
            return "<div class=\"category-{$this->category}\" style=\"{$this->style}\">{$this->text}</div>";
        }

        public function changeBg($category) {
            switch ($category) {
                case 'cat1':
                   $this->style = 'background-color: red';
                   break;
            }
        }

        public function __toSTring() {
            return $this->outputHTML();
        }
    } 
```

**主页**

```
$post = new Post('this is a post blabla', 'cat1');
print $post; 
```

# wordpress - RSS 提要的 WordPress 重写规则

> ID：14759592
> 
> 赞同：0
> 
> 时间：2013-02-07T19:40:23.530
> 
> 标签：wordpress, .htaccess, url, rewrite

我刚刚将一个博客从 Squarespace 移到了自托管的 WordPress，并且正在尝试设置一个重写规则，以便旧的 RSS 链接将继续为现有订阅者工作。

我正在使用的 URL 如下：

Squarespace：[http](http://example.com/blog/atom.xml) ://example.com/blog/atom.xml WordPress：[http ://example.com/feed/](http://example.com/feed/)

我在我的functions.php中添加了以下代码

```
add_action( 'init', 'ss_feed' );
function ss_feed()
{
    global $wp_rewrite;
    $wp_rewrite->add_external_rule( 'blog/atom\.xml$', 'feed/' );
} 
```

这已成功导致我的 .htaccess 文件被更新：

```
# BEGIN WordPress
<IfModule mod_rewrite.c>
RewriteEngine On
RewriteBase /
RewriteRule ^index\.php$ - [L]
RewriteRule ^blog/atom\.xml$ /feed/ [QSA,L]
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule . /index.php [L]
</IfModule>

# END WordPress 
```

但是点击[http://example.com/blog/atom.xml](http://example.com/blog/atom.xml)仍然会导致 WordPress 404。任何人都可以阐明这里可能存在的问题吗？请注意，我启用了 WP Super Cache，并且它在 .htaccess 中也有一个大块，如果人们认为这可能相关，我可以在此处添加。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-25T04:41:16.093

作为故障排除的第一步，在 Wordpress 管理员中刷新您的永久链接。这通常可以解决此类问题。

# http - GWT 和 HTTP：Content-Disposition 内联不起作用

> ID：14759595
> 
> 赞同：0
> 
> 时间：2013-02-07T19:40:36.170
> 
> 标签：http, gwt, smartgwt

我正在尝试在网页中显示 PDF 内联（实际上由 smartGWT 生成）。该页面尝试在内部加载`iframe`。

```
<!-- language: java -->

      response.setContentLength(fileData.length);
      response.setContentType("application/pdf");
      response.setHeader("Content-Disposition", "inline; fileName=" + fileName);

      outputStream = response.getOutputStream();
      outputStream.write(fileData);
      outputStream.flush();
      outputStream.close(); 
```

**生成的 HTML**

```
<!-- language: lang-html -->

<iframe height="100%" width="100%" scrolling="auto" 
        id="isc_GE" frameborder="0" 
        src="http://localhost:8080/pdfOperation.do?requestparams"></iframe> 
```

但是每次`iframe`加载时-我都会收到下载窗口。它仅适用于 Chrome 的嵌入式 PDF 查看器。但不适用于禁用的 chrome 的 PDF viever 和 firefox。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-07T19:43:32.243

那是因为浏览器不是 PDF 查看器。

如果浏览器可以呈现它，您只能将 PDF 内联到视图中。

也许，您可以尝试使用 PDF.js 来创建内联视图。

# objective-c - 检测句子或编号列表是否用于文本解析

> ID：14759596
> 
> 赞同：-2
> 
> 时间：2013-02-07T19:40:42.420
> 
> 标签：objective-c, xcode, cocoa-touch, cocoa, parsing

我在试图解析的文件中有一些文本。

考虑这个文本文件：

```
Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat.

Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do 
eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. 
1\. Line 1
2\. Line 2

+ Line 1
+ Line 2
+ Line 3 
```

文本文件中有三个段落。

首先是几句话。第二个有一个句子**和**一个编号列表。第三是一个简单的项目符号列表。

我的问题是，在 Objective-C 中，我如何确定段落组合是否只是句子，我会将它们作为 NSString 返回，如果它是项目符号列表，我希望它们在 NSArray 中分开，如果段落是句子和编号列表的组合，我会将它们作为 NSString 和 NSArray 的字典返回。

有任何想法吗？我知道我可以使用正则表达式将它们分成数组或字符串，但我不太清楚如何**检测**和验证 para 是否为：

1.  段落（句子）
2.  项目符号列表/编号列表。
3.  List和Para的结合

在阅读了一堆关于正则表达式的教程和 SO 问题后，我已经尝试过了。

此表达式`(?=\d*\s*[\.]?\s*)([a-z\s]+)`确实获取编号列表，但它还获取列表之前的前面文本。那是我完全被困住的地方。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-08T18:51:52.883

在我写这篇文章的时候，你有 2 票可以结束，没有评论或答案，这并不奇怪。人们会问：他尝试了什么？算法在哪里？他做了什么研究？等等等等你问的不属于SO的正常范围。

形式上，您拥有的是一种由*语法定义的**语言*，您需要确定您的数据是否是该语言中的*句子*，如果是，则确定其组成部分，称为*解析*，通常涉及*词法*和*句法分析*。

 ***可能是一个非常大的问题，但并非总是如此。

关于这个主题的文献很多，但作为一个相当随机的起点，请看一下[乔姆斯基层次结构](http://en.wikipedia.org/wiki/Chomsky_hierarchy)，它非常简要地定义了上述一些术语。

现在定义你的语法。例如，什么是*句子*？什么是*编号句*？（可能是一个*数字点*后跟一个*句子*） 什么是*编号列表*？（可能是一个或多个*编号的句子*）等。

你的语法是3型吗？如果是这样，您可以使用正则表达式对其进行解析，并且它们在 Cocoa 中可用。

如果它不是类型 3，那么您将需要编写*解析器*或使用*解析器生成器*。这是一个很大的话题，但我怀疑你的语法会很简单，一个简单的临时或递归下降解析器就足够了。（事实上​​，我猜如果你的定义保持简单，你可以想出一个类型 3 的语法。）

如果您在走得更远时遇到困难，那么您可能可以在该领域提出更多问题，这样可以帮助您。

HTH。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-17T20:32:02.463

使用[Objective-C Markdown 解析器](https://stackoverflow.com/questions/1435288/what-is-the-simplest-implementation-of-markdown-for-a-cocoa-application)怎么样？

语法与您使用的语法非常相似，您不必学习编写自己的解析器。***

# php - 我在 php mysql “调用非对象上的成员函数 setAttribute()”中的 pdo 出现错误

> ID：14759598
> 
> 赞同：1
> 
> 时间：2013-02-07T19:40:50.697
> 
> 标签：php, phpmyadmin, phpunit

您好，我在 PHP MySQL 中遇到 PDO 错误，我不知道该怎么办。有什么配置吗？使用easyphp感激不尽

连接文件.php

```
<?php
abstract class Conexao
{
    const USER = "root";
    const PASS = "";
    const DB   = "pare_aqui_db";
    const HOST = "localhost";
    private static $instancia = null;

    private static function conectar()
    {
        try
        {
            if(self::$instancia == null):
                $sqlPDO = "mysql:host=".self::HOST.";dbname=".self::DB;
                self::$instancia == new PDO( $sqlPDO , self::USER , self::PASS );
                self::$instancia->setAttribute(PDO::ATTR_ERRMODE, PDO::ERRMODE_EXCEPTION);
                self::$instancia->setAttribute(PDO::ATTR_EMULATE_PREPARES, false);
            endif;
        }
        catch(PDOException $erro_conecta){echo "erro".$erro_conecta->getMessage();}
        return self::$instancia;
    }

    protected static function getDB()
    {
        return self::conectar();        
    }
}
 ?> 
```

在 chrome 中测试页面时出错致命错误：在第 17 行的 C:\EasyPHP-12.1\www\pare_aqui_web_service\Dconecta.class.php 中的非对象上调用成员函数 setAttribute()

prepare() 也不起作用

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-07T19:42:06.900

```
self::$instancia == new 
```

没有设置变量。因此`self::$instancia->setAttribute`触发错误，因为您正在`(NULL)->setAttribute`非对象上执行。

这显然是一个错字，但以防万一：`==`是比较器运算符；你真正要找的是`=`哪个是*赋值*运算符；因此正确的代码是：

```
self::$instancia = new PDO( $sqlPDO , self::USER , self::PASS ); 
```

# ios - 为什么发送 CLLocationManagerDelegate 消息时 [CLLocationManager 位置] 没有更新？

> ID：14759599
> 
> 赞同：5
> 
> 时间：2013-02-07T19:40:55.043
> 
> 标签：ios, core-location, cllocationmanager

当`locationManager:didUpdateLocations:`（或其已弃用的等效项`locationManager:didUpdateToLocation:fromLocation:`）消息发送到 时`CLLocationManagerDelegate`，[CLLocationManagerDelegate 协议参考](https://developer.apple.com/library/mac/documentation/CoreLocation/Reference/CLLocationManagerDelegate_Protocol/CLLocationManagerDelegate/CLLocationManagerDelegate.html#//apple_ref/occ/intfm/CLLocationManagerDelegate/locationManager%3adidUpdateToLocation%3afromLocation%3a)声明：

> 当这条消息被传递给您的委托时，新的位置数据也可以直接从 CLLocationManager 对象中获得。newLocation 参数可能包含从先前使用位置服务缓存的数据。您可以使用位置对象的时间戳属性来确定位置数据的新近程度。

但是，在实践中，`CLLocationManager`的`location`属性不会更新。为什么不？

我创建了一个示例项目来演示这一点： [https ://github.com/sibljon/CoreLocationDidUpdateToLocationBug](https://github.com/sibljon/CoreLocationDidUpdateToLocationBug)

相关代码在 中`JSViewController`，其中的一个片段如下：

```
- (void)viewDidLoad
{
    [super viewDidLoad];

    self.locationManager = [[CLLocationManager alloc] init];
    self.locationManager.desiredAccuracy = kCLLocationAccuracyKilometer;
    self.locationManager.distanceFilter = 10000.0; // 10 km
    self.locationManager.delegate = self;
    self.locationManager.purpose = @"To show you nearby hotels.";
    [self.locationManager startUpdatingLocation];

    [self.locationManager startUpdatingLocation];

    [[NSNotificationCenter defaultCenter] addObserver:self
                                             selector:@selector(appWillEnterForeground:)
                                                 name:UIApplicationWillEnterForegroundNotification
                                               object:nil];

    [[NSNotificationCenter defaultCenter] addObserver:self
                                             selector:@selector(appDidEnterBackground:)
                                                 name:UIApplicationDidEnterBackgroundNotification
                                               object:nil];
}

#pragma mark - CLLocationManagerDelegate

- (void)locationManager:(CLLocationManager *)manager didUpdateToLocation:(CLLocation *)newLocation fromLocation:(CLLocation *)oldLocation
{
    NSLog(@"New location: %@", newLocation);
    NSLog(@"Old location: %@", oldLocation);
    NSLog(@"- [CLLocationManager location]: %@", manager.location);
}

//- (void)locationManager:(CLLocationManager *)manager didUpdateLocations:(NSArray *)locations
//{
//    for (CLLocation *location in locations)
//    {
//        NSLog(@"Current location: %@", locations);
//    }
//    NSLog(@"- [CLLocationManager location]: %@", manager.location);
//}

#pragma mark - Notifications

- (void)appWillEnterForeground:(NSNotification *)notification
{
    [self.locationManager startUpdatingLocation];
}

- (void)appDidEnterBackground:(NSNotification *)notification
{
    [self.locationManager stopUpdatingLocation];
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-07T19:40:55.043

我认为这是一个错误，我已经向 Apple 提交了错误报告。可以在 Open Radar 上找到错误报告的镜像：

[http://openradar.appspot.com/radar?id=2682402](http://openradar.appspot.com/radar?id=2682402)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-07T22:53:18.250

正如您在文档中所读到的，locationManagerDelegate 可能会将缓存的数据传递给回调方法。

这实际上经常发生，因此您需要做的是检查相对时间或当前时间的时间戳，`newLocation`以`oldLocation`查看它们是否足够不同（差异有多大取决于您根据应用程序的需求来决定）。

以下是如何针对当前时间进行检查的片段：

```
 if ([newLocation.timestamp timeIntervalSinceNow] < 600) // 10 minutes 
```

# android - 正确的 onDestroy() / 如何避免内存泄漏

> ID：14759601
> 
> 赞同：13
> 
> 时间：2013-02-07T19:41:04.283
> 
> 标签：android, view, memory-leaks, android-activity

我阅读了许多关于如何避免 Android 中的内存泄漏的文章，但我仍然不太确定我是否正确。

1.  我的应用程序由单个`Activity`.
2.  我在那个 Activity 中没有任何私有或静态成员，所有代码都是从`onCreate()`.
3.  有一些自包含的静态类，它们的静态实例有时包含对 a `Context`或`View`s 的引用。在我的`onDestroy()`方法中，我将所有这些实例都设置为空。
4.  我回收了我所有的`Bitmap`s。

**Q1**：够了吗？

让我感到困惑的是您可以在网上找到的经典示例（[http://www.curious-creature.org/2008/12/18/avoid-memory-leaks-on-android/](http://www.curious-creature.org/2008/12/18/avoid-memory-leaks-on-android/)）：

```
@Override
protected void onCreate(Bundle state) {
  super.onCreate(state);

  TextView label = new TextView(this);
  label.setText("Leaks are bad");

  setContentView(label);
} 
```

我认为，一旦`onCreate`完成，`label`就会超出范围并被 GCed。

**Q2**：这怎么会造成内存泄漏？

我的活动基本上是这样的：

```
@Override
public void onCreate(final Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);

    /* Statics */
    AssetUtils.initIndex(this);
    BitmapLoader.startInstance(this);

    /* frame */
    ViewGroup frame = (ViewGroup) getLayoutInflater().inflate(R.layout.frame, null);
    this.setContentView(frame);

    /* create controller */
    Controller controller = new Controller(frame, getLayoutInflater());

    /* START */
    controller.start();
}

@Override
public void onDestroy() {
    super.onStop();

    /* Statics */
    AssetUtils.destroyInstance();
    BitmapLoader.destroyInstance();
} 
```

在里面`Controller`，我偶尔会检索一个`Context`using`View#getContext()`以将其传递给手动创建`View`的 s 等。它永远不会静态存储在某个地方，只会存储在所有返回到`Controller`.

**Q3**：有什么我忽略的吗？

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2013-02-07T19:50:41.103

Q1。你已经断章取义了（没有开玩笑的意思：）

如果您查看原始文章，泄漏实际上发生在引入 Bitmap 字段的下一个代码片段中。Roman 然后清楚地解释了为什么它会泄漏。您显示的代码不会泄漏。

[http://www.curious-creature.org/2008/12/18/avoid-memory-leaks-on-android/](http://www.curious-creature.org/2008/12/18/avoid-memory-leaks-on-android/)

Q2。仅在没有其他选择的情况下使用 Activity 上下文，并且绝不允许在其范围大于其引用的 Activity 范围的范围内对其进行引用。据我所知，您显示的代码没有泄漏，因为没有任何上下文引用的范围大于您的 Activity。你怀疑它有吗？

Q3。使用位图时，无论是否使用静态引用，我都习惯于在 onPause() 中从视图中取消绑定 Bitamps（请记住 onDestroy() 不能保证，但它有点无关紧要，就好像你被销毁了，你的进程被杀死了所以 GC不是问题）。链接的文章还解释了如何执行此操作。我已经将它作为我的任何活动处理位图的模板模式。

[编辑]

对不起，我刚查了。文章没有说明如何解除绑定。这是我使用的模式：

```
@Override
protected void onPause()
{
        super.onPause();

        unbindDrawables(findViewById(R.id.mainLayout));
        System.gc();
}

@Override
protected void onDestroy()
{
        super.onDestroy();

        unbindDrawables(findViewById(R.id.mainLayout));
        System.gc();
}

private void unbindDrawables(View view)
{
        if (view.getBackground() != null)
        {
                view.getBackground().setCallback(null);
        }
        if (view instanceof ViewGroup && !(view instanceof AdapterView))
        {
                for (int i = 0; i < ((ViewGroup) view).getChildCount(); i++)
                {
                        unbindDrawables(((ViewGroup) view).getChildAt(i));
                }
                ((ViewGroup) view).removeAllViews();
        }
} 
```

`mainLayout`是 Activity 布局的根视图。

我包括 onDestroy() 因为我可能会手动完成（）我的活动。

笔记。调用 system.gc() 是一个复杂的主题，您**可能**想省略它。这里有一些很好的讨论，为什么它可能不是一件好事，主要与性能有关。但是，在我看来，当一个活动被销毁时，暗示现在是执行 GC 的好时机并没有什么坏处。不必要地调用它的低效率将丢失在销毁活动的开销中。

# jquery - Jquery 插件中的 Binding 事件究竟是为了什么？

> ID：14759602
> 
> 赞同：-5
> 
> 时间：2013-02-07T19:41:14.020
> 
> 标签：jquery

jquery中的绑定事件到底是为了什么？我真的不明白它的目的。

```
.bind("loaded.jstree", function (event, data) {         
            $("#demo1").css("display", "block");
        }) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-07T19:45:05.420

它正在绑定一个自定义事件，以后可以使用`.trigger`.

```
 //custom event loaded.jstree registered now
   .bind("loaded.jstree", function (event, data) {      
        $("#demo1").css("display", "block");
    }) 
```

您现在可以调用此自定义事件，例如，

```
 .trigger('loaded.jstree', .. 
```

# android - 如何将内容添加到操作栏中的选项卡

> ID：14759604
> 
> 赞同：0
> 
> 时间：2013-02-07T19:41:25.247
> 
> 标签：android, tabs, android-fragments, android-actionbar

我在操作栏中有一些选项卡，如下面的代码所示。但我想向每个选项卡添加一些按钮和 EditText 等内容。我不知道该怎么做。谁能告诉我应该把这个放在哪里。我会很高兴为您提供任何帮助。提前致谢。

```
public class MLkeyboardActivity extends FragmentActivity implements
    ActionBar.TabListener {

/**
 * The serialization (saved instance state) Bundle key representing the
 * current tab position.
 */
private static final String STATE_SELECTED_NAVIGATION_ITEM = "selected_navigation_item";

@Override
protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_mlkeyboard);

    // Set up the action bar to show tabs.
    final ActionBar actionBar = getActionBar();
    actionBar.setNavigationMode(ActionBar.NAVIGATION_MODE_TABS);

    // For each of the sections in the app, add a tab to the action bar.
    actionBar.addTab(actionBar.newTab().setText(R.string.title_section1)
            .setTabListener(this));
    actionBar.addTab(actionBar.newTab().setText(R.string.title_section2)
            .setTabListener(this));
    actionBar.addTab(actionBar.newTab().setText(R.string.title_section3)
            .setTabListener(this));
}

@Override
public void onRestoreInstanceState(Bundle savedInstanceState) {
    // Restore the previously serialized current tab position.
    if (savedInstanceState.containsKey(STATE_SELECTED_NAVIGATION_ITEM)) {
        getActionBar().setSelectedNavigationItem(
                savedInstanceState.getInt(STATE_SELECTED_NAVIGATION_ITEM));
    }
}

@Override
public void onSaveInstanceState(Bundle outState) {
    // Serialize the current tab position.
    outState.putInt(STATE_SELECTED_NAVIGATION_ITEM, getActionBar()
            .getSelectedNavigationIndex());
}

@Override
public boolean onCreateOptionsMenu(Menu menu) {
    // Inflate the menu; this adds items to the action bar if it is present.
    getMenuInflater().inflate(R.menu.activity_mlkeyboard, menu);
    return true;
}

@Override
public void onTabSelected(ActionBar.Tab tab,
        FragmentTransaction fragmentTransaction) {
    // When the given tab is selected, show the tab contents in the
    // container view.

    Fragment fragment = new DummySectionFragment();
    Bundle args = new Bundle();
    args.putInt(DummySectionFragment.ARG_SECTION_NUMBER,
            tab.getPosition() + 1);
    fragment.setArguments(args);
    getSupportFragmentManager().beginTransaction()
            .replace(R.id.container, fragment).commit();
}

@Override
public void onTabUnselected(ActionBar.Tab tab,
        FragmentTransaction fragmentTransaction) {
}

@Override
public void onTabReselected(ActionBar.Tab tab,
        FragmentTransaction fragmentTransaction) {
}

/**
 * A dummy fragment representing a section of the app, but that simply
 * displays dummy text.
 */
public static class DummySectionFragment extends Fragment {
    /**
     * The fragment argument representing the section number for this
     * fragment.
     */
    public static final String ARG_SECTION_NUMBER = "section_number";

    public DummySectionFragment() {
    }

    @Override
    public View onCreateView(LayoutInflater inflater, ViewGroup container,
            Bundle savedInstanceState) {
        // Create a new TextView and set its text to the fragment's section
        // number argument value.
        TextView textView = new TextView(getActivity());
        textView.setGravity(Gravity.CENTER);
        textView.setText(Integer.toString(getArguments().getInt(
                ARG_SECTION_NUMBER)));
        return textView;
    }
} 
```

}

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-07T19:49:07.150

> 但我想向每个选项卡添加一些按钮和 EditText 等内容。我不知道该怎么做。

将它们放入您正在加载的片段中`onTabSelected()`。

或者，修改`onTabSelected()`以执行其他操作，而不是替换片段，以影响您对 UI 的期望更改。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-07T19:44:31.753

你可以参考这个：

[http://developer.android.com/reference/android/app/ActionBar.html](http://developer.android.com/reference/android/app/ActionBar.html)

此外，您可以在此基础上创建一个 OptionCommand 和 setAction。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-08T15:34:52.613

本教程解决了我的问题。我们要做的是创建与每个选项卡相对应的片段（例如 FragmentA、B、C），并使用每个选项卡调用这些片段。代码可在 [http://android-er.blogspot 下面的链接中下载。在/2012/06/create-actionbar-in-tab-navigation-mode.html](http://android-er.blogspot.in/2012/06/create-actionbar-in-tab-navigation-mode.html)

```
public class AndroidNavigationTabsActivity extends Activity {
/** Called when the activity is first created. */
@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);

    final ActionBar actionBar = getActionBar();
    actionBar.setNavigationMode(ActionBar.NAVIGATION_MODE_TABS);

    Tab tabA = actionBar.newTab();
    tabA.setText("Tab A");
    tabA.setTabListener(new TabListener<MyFragmentA>(this, "Tag A", MyFragmentA.class));
    actionBar.addTab(tabA);

    Tab tabB = actionBar.newTab();
    tabB.setText("Tab B");
    tabB.setTabListener(new TabListener<MyFragmentB>(this, "Tag B", MyFragmentB.class));
    actionBar.addTab(tabB);

    Tab tabC = actionBar.newTab();
    tabC.setText("Tab C");
    tabC.setTabListener(new TabListener<MyFragmentC>(this, "Tag C", MyFragmentC.class));
    actionBar.addTab(tabC);

    if (savedInstanceState != null) {
        int savedIndex = savedInstanceState.getInt("SAVED_INDEX");
        getActionBar().setSelectedNavigationItem(savedIndex);
    }

} 
```

# eclipse-plugin - Eclipse 调试插件

> ID：14759607
> 
> 赞同：0
> 
> 时间：2013-02-07T19:41:35.590
> 
> 标签：eclipse-plugin, eclipse-cdt

我想制作一个在硬件板上运行的嵌入式应用程序。

目标是 Eclipse CDT，它使用 GDB 调试任何远程嵌入式应用程序。我完全不知道如何开始这个项目，我能想到的可能选项如下。

1.  尝试从头开始开发调试器
2.  开发一个 GBD sprite 并以某种方式让 eclipse cdt-gdb 识别它并能够调试我们的板。
3.  扩展 CDT 调试器，这样我们可以获得更多的自定义视图。但在这种情况下，我们也需要 GDB sprite。

非常感谢任何有关遵循何种方法的帮助/指导。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-07-09T06:03:08.007

您需要检查 Eclipse 调试器框架。

如果我清楚地了解您，您真正需要的是开发一个能够调试脚本的 Eclipse 插件调试器。如果这是您想要的，那么您肯定不需要从头开始。您**必须**使用 eclipse 本身提供的框架，而不是重新发明轮子。

这篇文章[How to make eclipse debugger plugin](http://www.eclipse.org/articles/Article-Debugger/how-to.html#Interpreter%20Debug%20Interface)是如何开始制作 eclipse 调试器的一个很好的例子。您必须了解 eclipse 框架和示例解释器之间发生的通信（请参阅链接）。

一旦您了解了流程，您将看到所需的大部分工作是将调试大脑添加到您的解释器/编译器中。eclipse 框架很健壮，需要最少的定制（如果有的话）。您将了解应该存在于您的定制调试器中的算法。这不是一件容易的事，但也不是不可能。

# python - Python 通过 TCP 套接字进行多文件传输

> ID：14759610
> 
> 赞同：3
> 
> 时间：2013-02-07T19:41:51.680
> 
> 标签：python, file-transfer, tcpsocket

我正在尝试用python编写一个程序来通过套接字传输文件夹中的多个文件，到目前为止我有以下代码

客户：

```
def uploadFiles(folder,dcip,PORT,filetype):
    os.chdir(folder)
    dirList = os.listdir(folder)
    print dirList
    ms = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
    print PORT
    ms.connect((dcip, int(PORT)))
    for fname in dirList:

        if fname.endswith(str(filetype)):
            cmd = 'get\n%s\n' % (fname)
            ms.sendall(cmd)
            f = open(fname,'rb')
            data = f.read()
            f.close()
            print data
            r = ms.recv(2)
            ms.sendall(data)
            ms.sendall('done\n%s\n' %(fname))
    ms.sendall('end\n\n')   
    ms.close() 
```

服务器：

```
import socket,os
listener_socket = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
listener_socket.bind(('',33234))
filename = ''
while 1:
    listener_socket.listen(100)
    connection,address_client = listener_socket.accept()
    if not os.path.exists(str(address_client[0])):
        os.makedirs(str(address_client[0]))
    currdir = os.getcwd()
    os.chdir('./'+str(address_client[0]))

    while(1):
        data = connection.recv(4096)
        cmd = data[:data.find('\n')]

        if cmd == 'get':
            x,filename,x = data.split('\n',2)
            connection.sendall('ok')
            f = open(filename,'wb')

        if cmd == 'done':
            continue

        f.write(data)

        if cmd == 'end':
            connection.close()
            break
    os.chdir(currdir) 
```

上面的代码进入了一个无限循环，我明白这是因为部分中的 continue 语句`if cmd == 'done'`，我想知道它为什么会这样做？我的意思是它永远不会从客户那里得到完成的消息，任何人都可以帮我修复代码吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-08T02:10:37.080

因为命令和文件名在不同的行中，所以最好按行解析接收到的数据。块数据的最后一部分不必以 a 结尾`\n`，因此它必须与下一个接收到的数据块合并。

这是（未经测试）按行解析接收到的数据的实现：

```
data = '' # contains last line of a read block if it didn't finish with \n
in_get, in_done, reading_file, ended = False, False, False, False
while not ended:
  if len(data) > 100:  # < update
    f.write( data )    # <
    data = ''          # <
  data += connection.recv(4096)
  i = data.find('\n')
  while i >= 0 and not ended:
    line = data[:i]
    data = data[i+1:]
    if in_get:
      filename = line
      reading_file = True
      f = open(filename,'wb')
      in_get = False
    elif in_done:
      if line != filename:  # done inside file content
        f.write( 'done\n' + line + '\n' )
      else:
        f.close()
        reading_file = False
      in_done = False
    else:
      if line == 'get' and not reading_file:
        in_get = True
      elif line == 'done':
        in_done = True
      elif line == 'end' and not reading_file:
        ended = True
        break;
      else:
        f.write( line + '\n' )
    i = data.find('\n') 
```

# ruby-on-rails - Rails：ActionView::Template::Error - 未定义的方法“评论”

> ID：14759611
> 
> 赞同：0
> 
> 时间：2013-02-07T19:41:55.857
> 
> 标签：ruby-on-rails, ruby, heroku

我在为输入数据呈现表单时遇到问题。控制器如下所示：

```
class AdsController < ApplicationController
  def new
    @ad = current_user.ads.build()
    respond_to do |format|
      format.html { render :layout => 'new' }# new.html.erb
      format.json { render json: @ad }
    end
  end
end 
```

在视图中（相关部分）：

```
<%= form_for ([@ad.user, @ad]) do |f| %>
  ...
  <%= f.label 'Description' %></div>
  <%= f.text_area :comment, cols:35, rows:4 %>
  ...
<% end %> 
```

和模型：

```
class Ad < ActiveRecord::Base
  attr_accessible :title, :url, :comment, :category_id, :layout, :user_id
  ...
end 
```

当我呈现表单时，我收到错误：

> ActionView::Template::Error（未定义的方法 `comment' for
> 
> # )

这很奇怪，因为在 localhost 上它可以工作，但是在将应用程序上传到 Heroku 之后，我收到了这个错误。

哪里可能有问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-07T20:05:13.340

检查您的迁移：

```
$ heroku run rake db:migrate:status 
```

确认您已运行所有迁移。当您推送新代码时，Heroku 不会自动运行您的迁移。

运行`$ heroku run rake db:migrate`运行它们。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-06-24T21:08:50.093

重新启动heroku dyno对我有用

```
$ heroku ps:restart 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2019-06-06T21:59:34.627

我的数据库迁移都是最新的，所以重新启动 heroku dyno 为我解决了这个问题。我跑了：

`heroku ps:restart`

# c# - 将已删除的打开 ID 引用恢复回项目

> ID：14759614
> 
> 赞同：0
> 
> 时间：2013-02-07T19:42:22.733
> 
> 标签：c#, asp.net-mvc, asp.net-mvc-4

我错误地从我的`mvc4`项目中删除了一些程序集，那些`membership access`使用 open id 引用的程序集等。

现在我想恢复这些引用，但我不知道在哪里可以找到它们，使用 nuget 已安装（尝试删除它们然后再次安装它们）但我无法删除，因为它具有子依赖项（尝试了所有出现在输入中的内容`DotNetOpenAuth.Core`）。

这听起来微不足道，但我已经花了太多时间寻找工作场所。

谢谢大家

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-07T19:55:16.077

您可以手动执行此操作，您必须从参考目录中删除旧参考，而不是使用此链接 [http://www.dotnetopenauth.net/](http://www.dotnetopenauth.net/)

下载 dll 库并使用浏览选择参考直接引用它们

# regex - 如何正确地将 mysite.com 仅重写为 www.mysite.com 而没有别的？

> ID：14759618
> 
> 赞同：1
> 
> 时间：2013-02-07T19:43:06.663
> 
> 标签：regex, asp.net-mvc, iis, url-rewriting

这是 Web.config 中将裸域重定向到 www 的部分。

```
<system.webServer>
<rewrite>
  <rules>
    <clear/>
    <rule name="WWW Rewrite" enabled="true">
      <match url="(.*)"/>
      <conditions>
        <add input="{HTTP_HOST}" negate="true" pattern="^www\."/>
      </conditions>
      <action type="Redirect" url="http://www.{HTTP_HOST}/{R:0}" appendQueryString="true" redirectType="Permanent"/>
    </rule>
  </rules>
</rewrite>
</system.webServer> 
```

**问题**是它还在任何其他地址前面添加了“www”，例如：

*   本地主机：62083 -> www.localhost：62083
*   static.mysite.com -> www.static.mysite.com
*   mysite.hostcompany.com -> www.mysite.hostcompany.com

我只需要它来重定向 mysite.com 而不是别的。如何修复规则？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-07T19:46:47.560

我觉得你想多了。我无法对其进行测试，但最简单的方法似乎是更改您的条件以匹配*您*想要重写的名称。

```
<add input="{HTTP_HOST}" negate="false" pattern="^mysite.com$"/>`? 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-07T19:46:40.903

尝试更改此行：

```
<add input="{HTTP_HOST}" negate="false" pattern="^mysite.com$"/> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-07T19:46:41.303

如果`pattern`是正则表达式，您可以使用

```
^[^\.]\.[^\.]$ 
```

仅重定向没有子域的请求（仅包含一个点）

*   优点：独立于域名
*   缺点：不适用于 www.mysection.company.com

# html - 如何优雅地对齐复选框

> ID：14759619
> 
> 赞同：0
> 
> 时间：2013-02-07T19:43:08.853
> 
> 标签：html, css

所以，这里是代码片段：http: [//jsfiddle.net/q4ZNc/](http://jsfiddle.net/q4ZNc/)

请花点时间运行该代码片段。

我想做的是下面的绿色框。每个复选框都可以展开，使其能够与上方框的边框对齐...

所以..不是那个文本必须传播......就像：

如果目前是这样

```
 <--------------------------Header above-------------------------------------->
   <---c1----><---c2----><----c3-----><----c4---> 
```

我希望上面是..

```
 <-------c1-------><------c2------><--------c3---------><-------c4------>[Submit] 
```

对不起，我可能弄乱了间距。但基本上等距间距。

我是新手.. 从过去一个小时以来一直在尝试解决这个问题，并决定将其发布在这里。有什么建议么。谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-07T19:56:31.737

我`div.inputContainer`在每个输入周围添加了一个，将其居中对齐并将其设置`width:20%`为有 5 个输入。

[小提琴](http://jsfiddle.net/bfelda/q4ZNc/1/)

要根据复选框的数量使其动态化，您需要编写一些脚本。这是一个使用 JQuery 的示例：

```
var inputContainers = $('.inputContainer');
inputContainerLength = inputContainers.length;
inputContainers.width(100 / inputContainerLength + '%'); 
```

[小提琴](http://jsfiddle.net/bfelda/q4ZNc/4/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-07T20:06:11.287

您可以将输入显示为`table-cell`，将它们全部包装在呈现为 的 div 中`table-row`，并将`display-table`100% 宽度放在容器 ( `.checklist`) 上。

这将迫使浏览器均匀分布单元格

[看这里](http://jsfiddle.net/Uy8Z9/)

# c# - C# 帮助 ExecuteNonquery

> ID：14759622
> 
> 赞同：-1
> 
> 时间：2013-02-07T19:43:18.460
> 
> 标签：c#

我真的不知道为什么我会收到这条消息

> ExecuteNonQuery：CommandText 属性尚未初始化

我的代码完全没有错误，当我查看它时它看起来不错。我一直在网上寻找解决方案，但找不到任何解决方案。这是我的代码。非常感谢任何帮助。

```
SqlConnection conn = new SqlConnection("Data Source=VALONS;Initial Catalog=gym;Integrated Security=True");
    SqlCommand cmd;
    public NewMem()
    {
        InitializeComponent();
    }

    private void label2_Click(object sender, EventArgs e)
    {

    }

    private void NewMem_Load(object sender, EventArgs e)
    {

    }

    private void btnSave_Click(object sender, EventArgs e)
    {
        try
        {
            conn.Open();
            cmd = new SqlCommand("Insert into member(SocialSecurity, Name, City, Street, Zipcode, Email, Phone) values ('" + textSocialSecurity + "','" + textName + "','" + textCity + "','" + textStreet + "','" + textZipCode + "','" + textEmail + "','" + textPhone + "')" + conn);
            cmd.ExecuteNonQuery();
            MessageBox.Show("You have successfully inserted values in Member");
            conn.Close();

        }
        catch (Exception ex)
        {
            MessageBox.Show(ex.Message);

        }
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-07T19:56:06.190

您可能必须这样做：

`cmd.CommandText = @"Insert into member(SocialSecurity, Name, City, Street, Zipcode, Email, Phone) values ('" + textSocialSecurity + "','" + textName + "','" + textCity + "','" + textStreet + "','" + textZipCode + "','" + textEmail + "','" + textPhone + "')";`

但是你有严重的问题。而且您对 sql 注入持开放态度。

参数化查询。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-07T19:53:15.317

The issue might be related to datataype mismatch. Try using parameters instead of directly values becuase of sql injection issue.

```
cmd = new SqlCommand("Insert into member(SocialSecurity, Name, City, Street, Zipcode, Email, Phone) values (:1,:2,:3,:4,:5,:6,:7)", conn);
cmd.parameters.clear();
cmd.parameters.Add("1", textSocialSecurity);
cmd.parameters.Add("2", textName);
...
cmd.parameters.Add("7", textPhone);
cmd.ExecuteNonQuery(); 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-02-07T19:53:53.037

您的命令需要被告知它是什么类型。存储过程，命令文本等。我​​不记得方法，但这就是问题所在。

我建议您分阶段执行此操作 - 打开连接，创建命令对象并设置连接属性，设置它的类型并执行 SQL 文本。我还建议使用带有参数的存储过程，因为它可以解决 SQL 注入问题。

# c# - 将值硬编码到数据表中

> ID：14759629
> 
> 赞同：2
> 
> 时间：2013-02-07T19:43:38.927
> 
> 标签：c#, datatable

我如何将值硬编码到数据表的字段中。这就是我所拥有的。

```
//create Data table to temporary storage

DataTable myTable = new DataTable();
protected void createTable(DataTable myTable)
    {

        myTable.Columns.Add("PilotID");
        myTable.Columns.Add("Start_date");
        myTable.Columns.Add("End_date");
        myTable.Columns.Add("Hours");
    } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-07T19:57:41.767

您可以使用[DataColumn.Expression](http://msdn.microsoft.com/en-us/library/system.data.datacolumn.expression.aspx)将列设置为常量值。

例如：

```
// For a number
myTable.Columns["PilotID"].Expression = "1";
// For a string
myTable.Columns["PilotID"].Expression = "'MyPilot'"; 
```

然后添加到数据表中的每一行在列中都将具有相同的常量值。如果某些代码尝试更改常量值，DataRow 也会引发异常。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-07T19:54:35.013

```
DataTable myTable = new DataTable();

myTable.Columns.Add("PilotID");
myTable.Columns.Add("Start_date");
myTable.Columns.Add("End_date");
myTable.Columns.Add("Hours");

DataRow dr = myTable.NewRow();
dr["PilotID"] = 1;
myTable.Rows.Add(dr);

myTable.Rows[0]["PilotID"] = 1; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-07T19:47:32.160

使用全局设置或类字段分配给表的字段。一旦你有了你的`NewRow()`，那么：

```
myNewRow["ConstantField"] = Settings.SpecialValue; 
```

**更新**

正如@shf301 建议的那样，使用表达式会更好；但是，我建议使用设置来存储您的*硬编码*值。

```
myTable.Columns["PilotID"].Expression = Settings.SpecialValue; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-07T19:52:58.757

U can try it this way!

```
 string[] TABLE_COLUMNS = new string[] { "PilotID", "Start_date", "End_date", "Hours", };
    static void Main()
    {

        var i_need_new_table = HardCodedDataTable();
        var i_need_one_more_new_table = HardCodedDataTable(TABLE_COLUMNS);

    }

    private static DataTable HardCodedDataTable() // default hard-coded table
    {
        DataTable myTable = new DataTable();
        myTable.Columns.Add("PilotID");
        myTable.Columns.Add("Start_date");
        myTable.Columns.Add("End_date");
        myTable.Columns.Add("Hours");
        return myTable;
    }

    private static DataTable HardCodedDataTable(string[] columns) // table with predefined columns in array
    {
        DataTable myTable = new DataTable();
        Array.ForEach(columns, s => myTable.Columns.Add(s));
        return myTable;
    } 
```

# jquery - 为什么 Jquery datepicker 弹出窗口没有出现在 IE 中与之关联的文本框旁边？

> ID：14759631
> 
> 赞同：0
> 
> 时间：2013-02-07T19:43:43.787
> 
> 标签：jquery, asp.net

我有几个用于日历目的的文本框。

```
function SetUpDatePicker() {
   var $allDatepickers = $('.datepicker');
    $.each($allDatepickers, function () {
       $(this).datepicker();
    });
}); 
```

FF 和 Chrome 工作正常，即日历出现在被点击的文本框下。

但是对于 IE，无论文本框位于何处，日历总是出现在第一个文本框的旁边。

知道为什么吗？

# c# - 为每个键查找具有最大值的行

> ID：14759633
> 
> 赞同：5
> 
> 时间：2013-02-07T19:43:46.413
> 
> 标签：c#, sql-server, linq, entity-framework

我有一个存储在 SQL Server 中的表，我希望使用 LINQ 进行查询。表的模糊描述：

```
 ID1  |  ID2  |  SomeData
-----------------------------
   1   |   1   |  'Moo'
   1   |   2   |  'Meow'
   1   |   3   |  'Woof'
   1   |   4   |  'Cheap'
   2   |   1   |  'Quack'
   2   |   2   |  'Grrrrr'
   2   |   3   |  'Wan wan' 
```

我只对每个示例所需结果`ID2`的最大值所在的行感兴趣：`ID1`

```
 1   |   4   |  'Cheap'
   2   |   3   |  'Wan wan' 
```

我想出了这个 SQL 代码：

```
SELECT *
FROM SomeTable a
INNER JOIN
(
    SELECT ID1, MAX(ID2) as SomeName
    FROM SomeTable
    GROUP BY ID1
) as b
ON a.ID1 = b.ID1 and a.ID2 = b.SomeName 
```

在 LINQ 中实现时，是否还需要子查询？也就是说，查询数据库并使用“内部查询”结果加载变量，然后查询同一个表但与“内部查询”中的值进行比较？我知道如果我修修补补一段时间，我最终会得到它，但我觉得在 LINQ 中可能有一些奇特的方法可以很容易地做到这一点。

期望的答案将利用扩展方法语法。

奖励：是否有任何类型的标准 LINQ 语法到扩展方法语法转换器？你们用什么工具来玩 LINQ 语句？对我来说，需要整个 c#（对我来说是 ASP.NET MVC）来处理 LINQ 查询似乎有点麻烦。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-02-07T19:56:56.063

直截了当的方法：

```
var result = db.SomeTable.GroupBy(x => x.ID).Select(g => g.OrderByDescending(x => x.ID2).First()); 
```

不完全确定这转化为 SQL 的效率有多高，所以如果这很重要，请使用您最喜欢的分析器进行检查！

# java - java中，为什么字节类型可以使用&0xff进行无符号右移操作？

> ID：14759634
> 
> 赞同：3
> 
> 时间：2013-02-07T19:43:54.553
> 
> 标签：java, byte

我知道，在 Java 中，字节类型在进行右移操作之前，会先转换为 int 类型。

所以在Java中，对于字节类型的>>>操作我们会得到一个错误的答案。

例如，

```
byte b=(byte)0xf1;
byte c=(byte)(b>>4);
byte d=(byte)(b>>>4);
byte e=(byte)((b&0xff)>>4); 
```

d 的答案等于 c。但是e的分析器是正确的。我想不出原因。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-07T19:57:16.127

如前所述，Java 总是使用`int`s 或更大的值进行计算，所以

考虑`b = 1111 0001`（注意设置了最高位，`b`实际上是-15）

隐式转换为 int：
`(int)b = 1111 .... 1111 0001`

做正确的转变：
`(b>>4) = 1111 1111 .... 1111 1111`
`(b>>>4) = 0000 1111 .... 1111 1111`

显式转换为 bool: `c = d = 1111 1111`。

* * *

考虑`e=(byte)((b&0xff)>>4);`

隐式转换为 int：
`(int)b = 1111 .... .... 1111 0001`

与 0xff：
`x&0xff = 0000 .... 0000 1111 0001`

做正确的转变：
`(b&0xff)>>4 = 0000 .... 0000 1111`

显式转换为字节：
`e = 0000 1111`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-07T19:51:07.863

java中最小的类型是int。部分原因是 CPU 现在可以处理整数或更大的类型。因此，JVM 是基于 int 实现的，并且只是为了方便而添加了其他较小的数据类型，如 byte、char、boolean。

因此，当您进行位操作时，您可以享受您提到的不一致。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-07T19:53:00.810

You answered your question yourself "before doing a right shift operation, will convert into the int type firstly", so

```
byte e=(byte)((b&0xff)>>4); 
```

firstly

```
b -> int => 0xfffffff1 
```

then

```
0xfffffff1 & 0xff => 0xf1 
```

then

```
0xf1 >> 4 => 0xf 
```

# python - Python PIL字节到图像

> ID：14759637
> 
> 赞同：21
> 
> 时间：2013-02-07T19:44:00.393
> 
> 标签：python, image, binary, python-imaging-library, drawtext

```
import PIL
from PIL import Image
from PIL import ImageDraw
from PIL import ImageFont
import urllib.request

with urllib.request.urlopen('http://pastebin.ca/raw/2311595') as in_file:
    hex_data = in_file.read()
print(hex_data)
img = Image.frombuffer('RGB', (320,240), hex_data) #i have tried fromstring
draw = ImageDraw.Draw(img)
font = ImageFont.truetype("arial.ttf",14)
draw.text((0, 220),"This is a test11",(255,255,0),font=font)
draw = ImageDraw.Draw(img)
img.save("a_test.jpg") 
```

我试图将二进制转换为图像，然后绘制文本。但我得到了错误：

```
img = Image.frombuffer('RGB', (320,240), hex_data) 
raise ValueError("not enough image data")
ValueError: not enough image data 
```

我已经在这里[http://pastebin.ca/raw/2311595](http://pastebin.ca/raw/2311595)
上传了字节字符串， 我可以确定图片大小是 320x240

## 额外的

这是我可以确定图片字节字符串来自 320x240，只需运行代码将从字节字符串创建图像

```
import urllib.request
import binascii
import struct

# Download the data.
with urllib.request.urlopen('http://pastebin.ca/raw/2311595') as in_file:
     hex_data = in_file.read()
# Unhexlify the data.
bin_data = binascii.unhexlify(hex_data)
print(bin_data)
# Remove the embedded lengths.
jpeg_data = bin_data
# Write out the JPEG.
with open('out.jpg', 'wb') as out_file:
    out_file.write(jpeg_data) 
```

## 已解决，这是更新的代码

```
from PIL import Image
from PIL import ImageDraw
from PIL import ImageFont
import urllib.request
import io
import binascii

data = urllib.request.urlopen('http://pastebin.ca/raw/2311595').read()
r_data = binascii.unhexlify(data)
#r_data = "".unhexlify(chr(int(b_data[i:i+2],16)) for i in range(0, len(b_data),2))

stream = io.BytesIO(r_data)

img = Image.open(stream)
draw = ImageDraw.Draw(img)
font = ImageFont.truetype("arial.ttf",14)
draw.text((0, 220),"This is a test11",(255,255,0),font=font)
draw = ImageDraw.Draw(img)
img.save("a_test.png") 
```

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2013-02-07T20:10:27.953

该图像不是由原始字节组成的——而是一个编码的 JPEG 文件。此外，您没有将流的 ascii HEX 表示解析为正确的字节：也就是说，该文件中的“ff”序列作为两个 c 字母“f”而不是数字 255 的字节传递给 PIL。

因此，首先，您将字符串解码为正确的字节序列 - 对卷积感到抱歉 - 可能有更好的方法来做到这一点，但我的日子很慢：

```
data = urllib.urlopen("http://pastebin.ca/raw/2311595").read()
r_data = "".join(chr(int(data[i:i+2],16)) for i in range(0, len(data),2)) 
```

啊，CY在hte评论上发表了-这样：

```
>>> import binascii
>>> b_data = binascii.unhexlify(data) 
```

现在，您将其作为 JPEG 图像导入 PIL：

```
>>> from PIL import Image
>>> import cStringIO as StringIO
>>> stream = StringIO.StringIO(b_data)
>>> img = Image.open(stream)
>>> img.size
(320, 240) 
```

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2018-12-23T03:39:45.643

正如其他人所说，Python 3 更好地使用`io.BytesIO`

```
import io
from PIL import Image

imageFileObj = open(imageFilename, "rb")
imageBinaryBytes = imageFileObj.read()
imageStream = io.BytesIO(imageBinaryBytes)
imageFile = Image.open(imageStream)
print("imageFile.size=%s" % imageFile.size) 
```

# scope - Angular.js：使变量在页面重新加载后存活

> ID：14759639
> 
> 赞同：2
> 
> 时间：2013-02-07T19:44:07.083
> 
> 标签：scope, angularjs, reload

哪些方法可以与 Angular.js 一起使用以使 $rootScope.myVar 变量在页面重新加载后仍然存在，除了将其放入 cookie 或使用 $http 请求定期从服务器检索？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-07T19:49:15.113

为什么不使用像[Lawnchair JS](http://brian.io/lawnchair/)这样的本地存储包装器？它有一个适配器模式，因此您可以将它连接到您喜欢的任何东西，但它默认为本地存储。

# java - 使用分布式编程的字符计数

> ID：14759641
> 
> 赞同：3
> 
> 时间：2013-02-07T19:44:07.027
> 
> 标签：java, algorithm, mpi, distributed-computing

我有一个巨大的文件（仅包含 ascii 字符），我需要找到最常出现的字符。

我的方法：

1.  拆分文件并将其分发到多个处理节点。
2.  每个节点将对字符进行计数并生成字符计数数组[256]。
3.  父节点将接收所有节点的所有计数数组并计算出现频率最高的字符。

但我想知道节点是否需要传输整个计数数组来计算最常见的字符？有没有办法减少节点之间传输的处理数据量。

注意：我是分布式编程的新手，因此尝试熟悉基本技术。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-07T19:54:24.660

如果您让每个节点处理例如 1 MiB，那么 1 KiB 的响应（对于 256 乘以 4 个字节`int`）可以忽略不计。

顺便说一句，看看[mapreduce](/questions/tagged/mapreduce "显示标记为“mapreduce”的问题")，尤其是[hadoop](/questions/tagged/hadoop "显示标记为“hadoop”的问题")。map-reduce的“ *hello world* ”是字数统计——几乎正是您所寻找的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-08T06:02:23.303

如果您想知道最常见字符的确切数量，那么是的，每个节点都需要返回所有计数，一个节点可能会计算 100 万个“a”，而另一个节点只计算 1 个实例。要获得确切的总数，您需要所有计数。

另外（不相关），第 1 点说您将“拆分和分发文件”。这是否意味着在一台机器上读取它并通过网络发送它？在这种情况下，您已经将文件的一部分读入内存，因此不妨立即扫描它，而它在缓存中仍然是温暖的。当然，如果您已经预先分发了文件，这无关紧要。

# c++ - 头文件中定义的函数实现是否编译成静态库？

> ID：14759643
> 
> 赞同：1
> 
> 时间：2013-02-07T19:44:10.530
> 
> 标签：c++, linux, windows, static-libraries

假设我们有大量带有类和执行的标题，如下所示：

```
// header.h
#ifndef MYHEADER
#define MYHEADER
class myClass {
public:
    int one()
    {
        return 1;
    }
    int two();
};
#endif // MYHEADER 
```

以及一些带有一些功能实现的 cpp 文件：

```
// header_impl.cpp
#include "header.h"
int myClass::two()
{
    return 2;
} 
```

将进入 .lib (.a) 库包获得实现，`int one()`否则它将保留在标头中并仅在有人使用 lib 时才编译，因此该标头倾向于在代码中使用它（并且将被编译到他的代码中但会更新出现在 .lib (.a) 文件中）？

那么头文件中定义的函数实现是编译成静态库的吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-07T19:52:33.587

Assuming the function is not used by any of the library functions itself, and no library function takes its address [makes a function pointer], then the compiler has no reason to make a "real function" of it. Of course, since inlining is really a question of "compiler decides", it's entirely possible that the compiler decides to NOT use the function inline, and in fact make one in the object file where it is compiled.

But in general, for small functions, no, it will only exist as source code in the header, and then get inlined wherever it is called.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-07T19:52:40.020

Maybe, in that a `cpp` almost definitely includes that header within your static library. Generally just because it's defined in the class doesn't force it to be inline, but it does definitely specify that the function has an ODR exception (which I think I called inline linkage; More on that later). So, depending on the function and it's use from within the static library it may or may not have an actual definition, depending on if the compiler inlined it and if it's being used at all.

If the compiler decided not to inline your function, when you `#include` that header from a `exe` which links with the static library you might think it should then get defined again, and break the one definition rule. But, you'd be wrong. Because the fact that the method is defined within the class body marks the function as having an ODR expection. Ultimately it's up to the compiler which definition it will choose (the one in the static library or the one in the `exe`/whatever). Likely it will choose the first one it sees.

Note: You can achieve the ODR exception by defining the function outside of the class body and using the `inline` keyword.

# php - 如果任何元素为空，则删除数组

> ID：14759647
> 
> 赞同：0
> 
> 时间：2013-02-07T19:44:31.560
> 
> 标签：php, arrays

我的数组具有以下结构。它是通过表单提交的文件数组。我有多个表单输入字段。但是，如果用户将某些字段留空，则数组将如下所示。然后我将它写入我的数据库。我不想写空字段。

我尝试使用`array_filter()`函数，但由于我的数组不是完全空的，所以它不起作用。错误元素设置为`4`。我该怎么做？

```
Array
(
    [0] => Array
        (
            [name] => stock-photo-cup-icons-tea-and-coffee-raster-version-109119257.jpg
            [type] => image/jpeg
            [tmp_name] => /tmp/phpqWWM9X
            [error] => 0
            [size] => 30609
        )

    [1] => Array
        (
            [name] => 
            [type] => 
            [tmp_name] => 
            [error] => 4
            [size] => 0
        )

    [2] => Array
        (
            [name] => 
            [type] => 
            [tmp_name] => 
            [error] => 4
            [size] => 0
        )

    [3] => Array
        (
            [name] => 
            [type] => 
            [tmp_name] => 
            [error] => 4
            [size] => 0
        )

) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-07T19:56:58.590

您可以将（可选）回调传递给[`array_filter()`](http://php.net/manual/en/function.array-filter.php)：

```
$filteredArray = array_filter($source, function($item) {
    return ($item['size'] > 0 && $item['error'] === 0);
});

var_dump($filteredArray); 
```

演示：[http ://codepad.viper-7.com/uocPT6](http://codepad.viper-7.com/uocPT6)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-07T19:48:14.113

这个简单的脚本：

```
foreach ($array as &$a) {
    $todel = false;
    foreach ($a as $k => $v) {
        if (empty($v)) { // condition to consider a variable empty
            $todel = true; break;
        }
    }
    if ($todel) unset($a);
} 
```

应该可以正常工作。我认为该代码几乎可以解释自己。我们正在做的是进入`$array`（主数组）中的 foreach 循环并检查子数组`$a`（通过引用传递）是否有任何空值。如果是这样，我们正在设置`$todel = true`（`break;`为了提高效率）将取消设置当前`$a`子数组。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-07T19:54:18.420

```
for($i=0;$i<count($theArray);$i++)
{
    if($theArray[$i]['error']==4) 
    { 
        unset($theArray[$i]); 
    }
} 
```

我会那样做

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2013-02-07T19:45:44.487

使用简单条件

```
if(error == 0){
    //insert here
}else{
   //do nothing
} 
```

# powershell - 如何使用 PowerShell 打印文件的某一行？

> ID：14759649
> 
> 赞同：36
> 
> 时间：2013-02-07T19:44:36.450
> 
> 标签：powershell

我在这台服务器上没有像样的文本编辑器，但我需要查看导致某个文件第 10 行错误的原因。虽然我确实有 PowerShell...

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2013-02-07T19:52:51.643

就像使用 select 一样简单：

```
Get-Content file.txt | Select -Index (line - 1) 
```

例如获取第 5 行

```
Get-Content file.txt | Select -Index 4 
```

或者您可以使用：

```
(Get-Content file.txt)[4] 
```

* * *

## 回答 #2

> 赞同：22
> 
> 时间：2013-02-07T19:44:36.450

这将显示 myfile.txt 的第 10 行：

`get-content myfile.txt | select -first 1 -skip 9`

两者`-first`和`-skip`都是可选参数， and `-context`, or`-last`可能在类似情况下很有用。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2013-02-07T20:16:54.660

您可以使用[cmdlet](http://technet.microsoft.com/library/hh849787.aspx)`-TotalCount`的参数读取第一行，然后使用仅返回第 th 行：[`Get-Content`](http://technet.microsoft.com/library/hh849787.aspx)`n``Select-Object``n`

```
Get-Content file.txt -TotalCount 9 | Select-Object -Last 1; 
```

根据@CB 的评论，这应该通过仅读取并包含第`n`th 行而不是整个文件来提高性能。请注意，您可以使用别名`-First`或`-Head`代替`-TotalCount`.

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2013-02-08T16:11:58.787

[`System.IO`](http://msdn.microsoft.com/library/29kt2zfk.aspx)这是一个直接使用 .NET 类的函数：

```
function GetLineAt([String] $path, [Int32] $index)
{
    [System.IO.FileMode] $mode = [System.IO.FileMode]::Open;
    [System.IO.FileAccess] $access = [System.IO.FileAccess]::Read;
    [System.IO.FileShare] $share = [System.IO.FileShare]::Read;
    [Int32] $bufferSize = 16 * 1024;
    [System.IO.FileOptions] $options = [System.IO.FileOptions]::SequentialScan;
    [System.Text.Encoding] $defaultEncoding = [System.Text.Encoding]::UTF8;
    # FileStream(String, FileMode, FileAccess, FileShare, Int32, FileOptions) constructor
    # http://msdn.microsoft.com/library/d0y914c5.aspx
    [System.IO.FileStream] $input = New-Object `
        -TypeName 'System.IO.FileStream' `
        -ArgumentList ($path, $mode, $access, $share, $bufferSize, $options);
    # StreamReader(Stream, Encoding, Boolean, Int32) constructor
    # http://msdn.microsoft.com/library/ms143458.aspx
    [System.IO.StreamReader] $reader = New-Object `
        -TypeName 'System.IO.StreamReader' `
        -ArgumentList ($input, $defaultEncoding, $true, $bufferSize);
    [String] $line = $null;
    [Int32] $currentIndex = 0;

    try
    {
        while (($line = $reader.ReadLine()) -ne $null)
        {
            if ($currentIndex++ -eq $index)
            {
                return $line;
            }
        }
    }
    finally
    {
        # Close $reader and $input
        $reader.Close();
    }

    # There are less than ($index + 1) lines in the file
    return $null;
}

GetLineAt 'file.txt' 9; 
```

调整`$bufferSize`变量可能会影响性能。使用默认缓冲区大小且不提供优化提示的更简洁版本可能如下所示：

```
function GetLineAt([String] $path, [Int32] $index)
{
    # StreamReader(String, Boolean) constructor
    # http://msdn.microsoft.com/library/9y86s1a9.aspx
    [System.IO.StreamReader] $reader = New-Object `
        -TypeName 'System.IO.StreamReader' `
        -ArgumentList ($path, $true);
    [String] $line = $null;
    [Int32] $currentIndex = 0;

    try
    {
        while (($line = $reader.ReadLine()) -ne $null)
        {
            if ($currentIndex++ -eq $index)
            {
                return $line;
            }
        }
    }
    finally
    {
        $reader.Close();
    }

    # There are less than ($index + 1) lines in the file
    return $null;
}

GetLineAt 'file.txt' 9; 
```

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2013-02-07T20:28:56.587

只是为了好玩，这里有一些测试：

```
# Added this for @Graimer's request ;) (not same computer, but one with HD little more
# performant...)
> measure-command { Get-Content ita\ita.txt -TotalCount 260000 | Select-Object -Last 1 }

Days              : 0
Hours             : 0
Minutes           : 0
Seconds           : 28
Milliseconds      : 893
Ticks             : 288932649
TotalDays         : 0,000334412788194444
TotalHours        : 0,00802590691666667
TotalMinutes      : 0,481554415
TotalSeconds      : 28,8932649
TotalMilliseconds : 28893,2649

> measure-command { (gc "c:\ps\ita\ita.txt")[260000] }

Days              : 0
Hours             : 0
Minutes           : 0
Seconds           : 9
Milliseconds      : 257
Ticks             : 92572893
TotalDays         : 0,000107144552083333
TotalHours        : 0,00257146925
TotalMinutes      : 0,154288155
TotalSeconds      : 9,2572893
TotalMilliseconds : 9257,2893

> measure-command { ([System.IO.File]::ReadAllLines("c:\ps\ita\ita.txt"))[260000] }

Days              : 0
Hours             : 0
Minutes           : 0
Seconds           : 0
Milliseconds      : 234
Ticks             : 2348059
TotalDays         : 2,71766087962963E-06
TotalHours        : 6,52238611111111E-05
TotalMinutes      : 0,00391343166666667
TotalSeconds      : 0,2348059
TotalMilliseconds : 234,8059

> measure-command {get-content .\ita\ita.txt | select -index 260000}

Days              : 0
Hours             : 0
Minutes           : 0
Seconds           : 36
Milliseconds      : 591
Ticks             : 365912596
TotalDays         : 0,000423509949074074
TotalHours        : 0,0101642387777778
TotalMinutes      : 0,609854326666667
TotalSeconds      : 36,5912596
TotalMilliseconds : 36591,2596 
```

获胜者是：`([System.IO.File]::ReadAllLines( path ))[index]`

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2016-02-05T14:59:20.357

要减少内存消耗并加快搜索速度，您可以使用 Get-Content cmdlet ( [https://technet.microsoft.com/ru-ru/library/hh849787.aspx](https://technet.microsoft.com/ru-ru/library/hh849787.aspx) ) 的 -ReadCount 选项。

当您处理大文件时，这可能会节省数小时。

这是一个例子：

```
$n = 60699010
$src = 'hugefile.csv'
$batch = 100
$timer = [Diagnostics.Stopwatch]::StartNew()

$count = 0
Get-Content $src -ReadCount $batch -TotalCount $n | %  { 
    $count += $_.Length
    if ($count -ge $n ) {
        $_[($n - $count + $_.Length - 1)]
    }
}

$timer.Stop()
$timer.Elapsed 
```

这将打印第 $n 行和经过的时间。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2021-05-20T07:45:28.657

我知道这是一个老问题，但尽管是该主题中观看次数最多的问题之一，但没有一个答案让我完全满意。`Get-Content`易于使用，但它在处理非常大的文本文件（例如 >5 GB）时显示出其局限性。

我想出了一个解决方案，它不需要将整个文件加载到主内存中，并且比`Get-Content`（几乎和`sed`Linux 上一样快，像[这样](https://stackoverflow.com/a/19327690/3328545)）要快得多：

`[Linq.Enumerable]::ElementAt([System.IO.File]::ReadLines("<path_to_file>"), <index>)`

在我的机器上找到大约 4.5 GB 文件中间的一行大约需要 4 秒，而`(Get-Content -Path <path_to_file> -TotalCount <index>)[-1]`大约需要 35 秒。

# android - Android eclipse clean 移除 AndroidManifest.xml 更改

> ID：14759655
> 
> 赞同：1
> 
> 时间：2013-02-07T19:44:50.343
> 
> 标签：android, eclipse, android-manifest

我正在构建一个 Android 应用程序，它利用 WebView 显示来自互联网的网页的一部分。经过一番折腾，我终于发现我应该将以下行添加到我的 AndroidManifest.xml

一切都很好，我很高兴。但是，我在 Eclipse 中进行了“清理”，突然间我的应用程序的 Web 访问再次停止工作。仔细查看所有内容后，我意识到 eclipse“清理”过程重新创建了 AndroidManifest.xml 文件。经过一番思考，这也是有道理的。

问题 - 如何让我的 android 应用程序永久拥有“互联网权限”，这样我就不必每次都经历这个过程？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-07T22:32:34.417

您正在更改错误的清单文件，即 bin 文件夹中的文件（我用图像指出：D）。

您应该更改根目录中的那个。![在此处输入图像描述](../Images/998e3579b436ab6853da137ff3b19dc6.png)

# methods - 如何更新另一个类的方法？

> ID：14759658
> 
> 赞同：0
> 
> 时间：2013-02-07T19:44:55.973
> 
> 标签：methods, constructor, arguments, private

有两个类（Home 类和 Away 类）。Away 类有一个名为 update 的方法，而 update 方法有一些参数（语音、写作、阅读），它们的值在 Home 类中分配。这些值会动态变化'。我从 Home 类调用此更新方法时遇到问题，你能给我举个例子吗？这是我试图做的：

```
public class Away
{ 
    private void method1(String speech)
    {
        //.......definition of the method......
    }

    private void method2(String writing)
    {
        //.....definition of the method......
    }

    private void method3(String reading)
    {
        //......definition of the method......
    }

    public void update(String speech, String writing, String reading)
    {
        Away away_object = new Away(String speech, String writing, String reading);
        away_object.method2(speech);
        away_object.method3(writing);
        away_object.method4(reading);
    }
} 
```

我尝试在下面的 Home 类中调用此更新方法，但我不知道如何更改此更新方法的参数。因为这些参数在 Home 类中具有动态值。我应该创建一个构造函数，还是如何更新这个“更新（）”方法？

```
Away object2 = new Away(); 

object2.update(speech, writing, reading); 
```

我期待着听到您的回复，我迫切需要它...非常感谢您提前...

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-07T20:10:55.793

在 Away 类中的公共更新函数中，您似乎正在实例化 away 类本身的另一个副本。

改变你的功能：

由此：

```
public void update(String speech, String writing, String reading)
{
    Away away_object = new Away(String speech, String writing, String reading);
    away_object.method2(speech);
    away_object.method3(writing);
    away_object.method4(reading);
} 
```

对此：

```
public void update(String speech, String writing, String reading)
{
    method2(speech);
    method3(writing);
    method4(reading);
} 
```

# android - 为 Google Maps Android API v2 指定服务器

> ID：14759665
> 
> 赞同：0
> 
> 时间：2013-02-07T19:45:21.520
> 
> 标签：android, google-maps-android-api-2

有没有办法指定要与 Google Maps Android API v2 连接的服务器？

例如，我想连接到内部 Google 地球服务器。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-07T20:05:40.030

AFAIK，您无法指定 :) Android 使用套接字连接到其服务器，并且所有外部 SDK 接口都针对 GoogleMaps 服务器功能进行了优化。

如果您想使用自己的地图瓦片 - 您可以实现自己的[TileProvider](https://developers.google.com/maps/documentation/android/reference/com/google/android/gms/maps/model/TileProvider)，这样您就可以从任何您想要的服务器提供地图瓦片

[UrlTileProvider](https://developers.google.com/maps/documentation/android/reference/com/google/android/gms/maps/model/UrlTileProvider)是一个非常好的例子。您需要做的是提供正确`url`的地图坐标，Android 将下载地图图块并为您缓存

# c++ - 在 Xwindow 中访问其他窗口的标题

> ID：14759674
> 
> 赞同：0
> 
> 时间：2013-02-07T19:45:54.113
> 
> 标签：c++, xlib, titlebar

我正在用 C++ (Linux,XWindow) 编写一个程序，它应该修改活动窗口的标题。更具体地说，将某些文本附加到它。

是否可以获得活动窗口的窗口句柄（即使它与该程序无关）以在 XFetchName 和 XStoreName 中使用它？或者，也许还有其他方法可以修改某个窗口的标题？

谢谢你。

更新1：

我用了

```
 xprop -root | grep ^_NET_ACTIVE_WINDOW | cut -c41-49 
```

它返回正确的句柄。谢谢你的建议。这是我之前用的

```
xdpyinfo | grep focus: | cut -c16-24 
```

看起来它返回的数字比实际句柄大 1。

现在出现了一个新问题。似乎 XStoreName 修改了 WM_NAME。我有 Unity 桌面，它似乎改为读取 _NET_WM_NAME。我怎样才能修改这个呢？

更新2：找到答案

```
Atom Atom_name = XInternAtom(xdisplay,"_NET_WM_NAME",false);
Atom Atom_utf_type = XInternAtom(xdisplay,"UTF8_STRING",false);

XChangeProperty(xdisplay,window_handle,Atom_name,Atom_utf_type,8,PropModeReplace,(unsigned char*)new_name,strlen(new_name)); 
```

现在似乎工作正常

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-07T19:58:35.587

使用外来的、不相关的窗口没有任何限制，因此`XFetchName`并且`XStoreName`会起作用（即它们将访问`WM_NAME`属性，这可能会产生预期的效果……或不会）。

至于确定*当前*窗口，你可以从这里的代码示例开始： [如何知道哪个窗口有焦点以及如何改变它？](https://stackoverflow.com/questions/1014822/how-to-know-which-window-has-focus-and-how-to-change-it)注意不被接受的答案：根窗口的属性（当 wm 设置它时）是您可以获得的*当前*`_NET_ACTIVE_WINDOW`窗口最合理的值。

 *请注意，有`_NET_WM_NAME`type 的属性，`UTF8_STRING`现代窗口管理器可能会优先使用`WM_NAME`它们，而不是同时设置它们。并非所有应用程序都设置它（在我当前的桌面上，我看到 firefox 可以，xterm 没有）。`_NET_WM_NAME`如果你想修改标题，你也应该准备好修改。

当然，应用程序可以随时决定重置其标题。`XPropertyNotify`如果您想注意到它并更新标题，您可以订阅事件。确保为可能执行相同操作的应用程序提供一些解决方法（即`XPropertyNotify`进行标题更新并将其重置为他们想要的内容）。*

# r - 使用 scale_x_date 指定第一个和最后一个刻度线

> ID：14759676
> 
> 赞同：25
> 
> 时间：2013-02-07T19:46:01.037
> 
> 标签：r, ggplot2

我希望能够指定出现在 ggplot2 生成的图中的第一个和最后一个刻度线，但是遇到了一些问题。这是一些代码。

```
#Produce a vector of days 
dateVec <- seq(from = as.Date("2011-11-21"), to = as.Date("2012-11-23"), by = "days")

#Some random values
myData <- rnorm(length(dateVec))

# Plot it
qplot(dateVec, myData) + 
    scale_x_date(breaks = "4 weeks", limits = c(min(dateVec), max=max(dateVec))) + 
    theme(axis.text.x = element_text(size = 10, angle = 45, colour = "black",
          vjust = 1, hjust = 1)) 
```

请注意，日期向量中的最小日期是 2011-11-21，最大日期是 2012-11-23，并且我已经指定了绘图的限制。然而，情节似乎扩大了一些。

有没有办法强制第一个和最后一个刻度线对应于中指定的实际限制`scale_x_date`？

谢谢！

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2013-02-07T19:59:30.407

为确保不扩展轴，您可以将参数添加`expand = c(0, 0)`到`scale_x_date()`.

```
qplot(dateVec, myData) + 
scale_x_date(breaks = "4 weeks", limits = c(min(dateVec), max = max(dateVec)),
             expand=c(0,0)) +  
theme(axis.text.x  = element_text(size = 10, angle = 45, colour = "black",
      vjust = 1, hjust = 1)) 
```

![在此处输入图像描述](../Images/59566e712010c8fb265e1c29f4802e6f.png)

### 更新

如果您需要以最小和最大日期开始的刻度，那么您可以定义自己的休息时间。为此，我制作了`break.vec`包含最小和最大日期以及它们之间的月份日期的向量。然后使用此向量设置中断`scale_x_date()`。

```
break.vec <- c(as.Date("2011-11-21"),
               seq(from = as.Date("2011-12-01"), to = as.Date("2012-11-01"),
                 by = "month"),
               as.Date("2012-11-23"))

qplot(dateVec, myData) + 
  scale_x_date(breaks = break.vec) +  
  theme(axis.text.x = element_text(size = 10, angle = 45, colour = "black",
                                   vjust = 1, hjust = 1)) 
```

![在此处输入图像描述](../Images/277cfb2e6c2faf61af7175dc5f4d09cc.png)

# jquery - Html5 数字无法使用 jQuery 提取值

> ID：14759677
> 
> 赞同：0
> 
> 时间：2013-02-07T19:46:01.197
> 
> 标签：jquery, html

我有一些 HTML 代码：

```
 <div class="row">
     <label class="span3" for="WidgetWidthProduct">Widget width</label>
     <input type="number" class="span1" min="2" max="12" id="WidgetWidthProduct" value="3" />
    </div> 
```

我试图在有人更改输入后找到值，但我一直得到“0”？？

```
 alert($("#WidgetWidthProduct").val()); 
```

有什么帮助吗？谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-07T19:49:11.770

您是否准备好将文档包装`alert($("#WidgetWidthProduct").val());`在内？

这个[jsfiddle](http://jsfiddle.net/Eonasdan/wN55H/)工作得很好

```
 $(function () {
    alert($("#WidgetWidthProduct").val());
 }); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-07T19:50:55.817

您的代码在加载页面后运行吗？确定重复的元素**ID**

# css - 如何设置元素的高度以填充其父高度的剩余部分？

> ID：14759678
> 
> 赞同：0
> 
> 时间：2013-02-07T19:46:04.550
> 
> 标签：css, layout, height, html, vertical-alignment

到目前为止，我在 div B 内有 div A，并且 A 的高度设置为 100%，因为我希望它覆盖从它的开头到其父 div 的底部的所有内容。

但是，将其高度设置为 100% 并不能按照我希望的方式执行（它只会从起点一直跨越到其父级的底部），而是将其高度设置为与其父级 div 完全匹配. 由于 div A 从 div B 内部向下几百像素开始，这会导致 div A 在 div B 下方溢出额外的几百像素。

下面的例子：

![例子](../Images/21d56bd894718e461fc862cb9672dec3.png)

真正的诀窍是 div B 需要能够根据其内容垂直扩展，而 div A 继续填充从其垂直起点到其父级底部的区域。

有没有其他方法可以考虑？我知道我可以使用 calc 单位，但是，直到 safari 6，calc 才在 safari 上工作，这将排除很多移动设备。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-07T19:49:58.960

我可能会误解您在这里想要实现的目标，但不会

```
overflow:hidden; 
```

在 DIV B 上锻炼？

# ios - 核心数据：如何在保存文档时获得通知？

> ID：14759679
> 
> 赞同：0
> 
> 时间：2013-02-07T19:46:07.767
> 
> 标签：ios, objective-c, core-data

我注意到当我打电话时

```
[context save:nil]; 
```

保存不会立即发生。当我尝试在一两秒内保存并退出应用程序时，我对此进行了测试。仅当我将应用程序保持打开 5 秒左右时它才有效。

我有两个问题：

*   我怎么知道存档何时完成？一个简单的 NSLog() 就足够了，仅用于测试目的。
*   我可以强制保存吗？我是不是该？

**测试 [context save] 是否同步**

我已经测试了很多次，这不是我得到的行为。如果我有这个代码：

```
[context save:nil]
NSLog(@"Saved"); 
```

我看到“已保存”日志，退出应用程序，当我再次启动它并尝试获取数据时 - 那里什么也没有。**如果我在看到“已保存”消息后等待大约 5-10 秒，则不会发生这种情况。**

想法？

**一些代码**

```
- (void)storeSales:(NSArray *)sales {
    NSDateFormatter *formatter = [[NSDateFormatter alloc] init];
    [formatter setDateFormat:@"EE LLLL d HH:mm:ss Z YYYY"];

    for (NSDictionary *saleDictionary in sales) {
        Sale *sale = [NSEntityDescription insertNewObjectForEntityForName:@"Sale" inManagedObjectContext:self.context];
        sale.productName = [saleDictionary objectForKey:@"description"];
        sale.date = [formatter dateFromString:[saleDictionary objectForKey:@"occured_at"]];

        NSLog(@"Stored new sale in database.");
    }

    [self.context save:nil];
} 
```

**我如何设置 UIManagedDocument**

```
@property (nonatomic, strong) UIManagedDocument *document;
@property (nonatomic, strong) NSManagedObjectContext *context;

...

NSURL *url = [[[NSFileManager defaultManager] URLsForDirectory:NSDocumentDirectory inDomains:NSUserDomainMask] lastObject];
url = [url URLByAppendingPathComponent:@"SalesBot Database"];
self.document = [[UIManagedDocument alloc] initWithFileURL:url];

if (![[NSFileManager defaultManager] fileExistsAtPath:[self.document.fileURL path]]) {
    [self.document saveToURL:self.document.fileURL forSaveOperation:UIDocumentSaveForCreating completionHandler:^(BOOL success) {}];
} else if (self.document.documentState == UIDocumentStateClosed) {
    [self.document openWithCompletionHandler:^(BOOL success) {}];
}

self.context = self.document.managedObjectContext; 
```

**更新 1**

我尝试使用 NSNotificationCenter 接收 NSManagedObjectContextDidSaveNotification - 但是 - 我收到了两次！在 [context save:nil] 之后一次，5-10 秒后再次！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-07T20:21:59.880

所以看起来你正在**使用`UIManagedDocument`**上面的核心数据。这解释了一些事情。

首先，用于`-[UIDocument saveToURL:forSaveOperation:completionHandler:]`保存您的文档。来自文档：

> 您通常应该使用标准`UIDocument`方法来保存文档。如果您直接保存子上下文，您**只会将更改提交到父上下文**而不是文档存储。如果您直接保存父上下文，您将回避文档执行的其他重要操作。

`UIManagedDocument`使用***两个***托管对象上下文。一是在主线程上工作，二是在后台线程中保存对文件的更改。这**就是您的更改已保存但重新打开后丢失的原因。**第二个上下文没有完成保存操作。

这也解释了为什么您的通知被触发了两次。每个上下文一个。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-07T19:49:01.253

save 方法**不是**一个异步过程。调用 save 方法后发生的任何事情都将在保存后执行。

```
NSLog(@"About to force a save...");
[context save:nil];
NSLog(@"Now I know the save is complete!"); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-07T19:55:23.423

您可以观察通知`NSManagedObjectContextDidSaveNotification`。

# python - 使用 libreplaygain.so 和 numpy 无法获得合理的结果

> ID：14759680
> 
> 赞同：0
> 
> 时间：2013-02-07T19:46:10.360
> 
> 标签：python, numpy, ctypes

我一直在一遍又一遍地尝试使用`libreplaygain.so`（`ReplayGain`是一种用于计算音频响度的算法。）来自python，从音频文件中传递数据。这是libreplaygain[的头文件](http://sourcecodebrowser.com/libreplaygain/1.0~r412/gain__analysis_8h_source.html)。我一般不太了解`ctypes`或 C，所以我希望这可能是我愚蠢的问题，对其他人来说非常明显！这是我正在使用的脚本：

```
import numpy as np
from scipy.io import wavfile
import ctypes
replaygain = ctypes.CDLL('libreplaygain.so')

def calculate_replaygain(samples, frame_rate=44100):
    """
    inspired from https://github.com/vontrapp/replaygain
    """
    replaygain.gain_init_analysis(frame_rate)
    block_size = 10000
    channel_count = samples.shape[1]
    i = 0
    samples = samples.astype(np.float64)

    while i * block_size < samples.shape[0]:
        channel_left = samples[i*block_size:(i+1)*block_size,0]
        channel_right = samples[i*block_size:(i+1)*block_size,1]

        samples_p_left = channel_left.ctypes.data_as(ctypes.POINTER(ctypes.c_double))
        samples_p_right = channel_right.ctypes.data_as(ctypes.POINTER(ctypes.c_double))

        replaygain.gain_analyze_samples(samples_p_left, samples_p_right, channel_left.shape[0], channel_count)
        i += 1

    return replaygain.gain_get_chapter()

if __name__ == '__main__':
    frame_rate, samples = wavfile.read('directions.wav')
    samples = samples.astype(np.float64) / 2**15
    gain = calculate_replaygain(samples, frame_rate=frame_rate)
    print "Recommended gain: %f dB" % gain
    gain = calculate_replaygain(np.random.random((441000, 2)) * 2 - 1, frame_rate=44100)
    print "Recommended gain: %f dB" % gain 
```

脚本运行，但我无法获得与命令行工具相同的值`replaygain`。事实上我总是得到`80.0`. 要尝试，您可以用任何声音文件替换“directions.wav”...并将结果与​​命令的结果进行比较`replaygain <soundfile.wav>`。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-07T20:25:47.603

`gain_get_chapter()`返回 a `double`，但[ctypes 文档说](http://docs.python.org/2/library/ctypes.html#return-types)“默认情况下假定函数返回 C int 类型。” 你应该做类似的事情

```
replaygain.gain_get_chapter.restype = ctypes.c_double 
```

`gain_init_analysis`您还应该检查and的返回值`gain_analyze_samples`；如果两者都不是 1，则说明其他问题。（那些实际上是整数，所以你不应该在那里做任何其他事情。）

# plsql - 在顶点上执行 pl sql 时出错

> ID：14759690
> 
> 赞同：0
> 
> 时间：2013-02-07T19:46:43.210
> 
> 标签：plsql

我尝试通过 apex online 运行以下代码

```
 DECLARE
    t1 VARCHAR(44);
    t2 VARCHAR(11);
    c VARCHAR(3);
    BEGIN
    t1:='061,065,059,067,064,066,071,111,110,121,077.';
    t2:=NULL;
    FOR I IN LENGTH(t1)/4
     loop
    c:=SUBSTR(t1,((LENGTH(t1)/4),3);
    t2:=t2||CHR(TO_NUMBER(c));

    end loop;
    DBMS_OUTPUT.PUT_LINE(t2);
    END; 
```

但是出现以下错误

```
ORA-06550: line 9, column 2:
PLS-00103: Encountered the symbol "LOOP" when expecting one of the following:

   * & - + / at mod remainder rem .. <an exponent (**)> || 
```

谢谢大家，我解决了第二个错误，实际上

```
c:=SUBSTR(s1,1+((LENGTH(s1)/4)-I)*4,3); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-07T20:46:03.697

```
FOR I IN 1..LENGTH(t1)/4 LOOP

END LOOP; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-08T04:49:11.060

试试这个：

```
DECLARE
    t1 VARCHAR(50);
    t2 VARCHAR(100);
    c VARCHAR(50);
BEGIN
    t1:='061,065,059,607,064,066,071,111,110,121,077.';
    t2:=NULL;
    FOR I IN 1..LENGTH(t1)/4 loop
       c:=SUBSTR(t1,(LENGTH(t1)/4),3);
   --  t2:=t2||CHR(TO_NUMBER(c));
       t2:=t2||(c);
    end loop;
    DBMS_OUTPUT.PUT_LINE(t2);
END; 
```

# mysql - 在 VB.NET 中将用户与登录会话相关联

> ID：14759701
> 
> 赞同：0
> 
> 时间：2013-02-07T19:47:26.983
> 
> 标签：mysql, vb.net

我正在使用 MySQL 后端在 VB.NET 中创建一个项目。用户通过在 VB.NET 中创建的登录系统登录，用户详细信息存储在数据库中。

我只是想知道理论上登录的用户如何在该会话的生命周期内与该特定会话相关联？我需要发生这种情况，以便在用户登录后我可以进行进一步的查询，其中涉及该用户:)

在此先感谢，罗宾

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-07T20:06:13.263

将用户 ID 保存在会话变量中（假设您已从数据库中提取用户 ID，并将其存储在我称为 userid 的变量中）：

```
HttpContext.Current.Session.Add("UserID", userid) 
```

然后，当您想在任何页面上使用它时（假设您的用户 ID 是整数）：

```
Dim userid as Integer = HttpContext.Current.Session["UserID"] 
```

或在查询字符串中：

```
Dim strQuery As String = "SELECT * FROM TABLE WHERE USERID = " _
    + HTTPContext.Current.Session["UserID"].ToString() + ";" 
```

# ruby-on-rails-3 - Rails Bootstrap 导航栏和炼油厂CMS

> ID：14759712
> 
> 赞同：9
> 
> 时间：2013-02-07T19:47:57.650
> 
> 标签：ruby-on-rails-3, refinerycms

有没有人在refineryCMS 中实现过Rails Bootstrap Navbar？

我很难弄清楚如何呈现下拉菜单。

这应该是实现这一目标的正确方法？

_menu.html.erb

```
<%    
  if (roots = local_assigns[:roots] || (collection ||= refinery_menu_pages).roots).present?
    dom_id ||= 'menu'
  css = [(css || 'menu'), 'clearfix'].flatten.join(' ')
    hide_children = Refinery::Core.menu_hide_children if hide_children.nil?
-%>
<div class="navbar">
  <div class="navbar-inner">
    <div class="container">

      <nav id='<%= dom_id %>' class='<%= css %> nav'>
        <ul class="nav">

          <%= render :partial => '/refinery/menu_branch', :collection => roots,
                     :locals => {
                       :hide_children => hide_children,
                       :sibling_count => (roots.length - 1),
                       :menu_levels => local_assigns[:menu_levels],
                       :apply_css => true #if you don't care about class='first' class='last' or class='selected' set apply_css to false for speed.
                     } -%>

        </ul>
        </nav>
    </div>
    </div>
</div>
<% end -%> 
```

_menu_branch.html.erb

```
<%
  if !!local_assigns[:apply_css] and (classes = custom_menu_branch_css(local_assigns)).any?
    css = "class='#{classes.join(' ')}'".html_safe
  end

-%>
<li class="dropdown">
<% if menu_branch.children.present? &&  menu_branch.ancestors.length < 1 %>
<%= link_to(menu_branch.title, refinery.url_for(menu_branch.url), class: "dropdown-togle", data: { toggle: "dropdown" }) -%>
<% else %>
<%= link_to(menu_branch.title, refinery.url_for(menu_branch.url)) -%>
<% end %>
  <% if ( (children = menu_branch.children unless hide_children).present? &&
          (!local_assigns[:menu_levels] || menu_branch.ancestors.length < local_assigns[:menu_levels]) ) -%>

      <ul class="dropdown-menu">
      <%= render :partial => '/refinery/menu_branch', :collection => children,
                 :locals => {
                   :apply_css => local_assigns[:apply_css],
                   :hide_children => !!hide_children,
                   :menu_levels => local_assigns[:menu_levels]
                  } -%>

    </ul>
</li>
<% end -%> 
```

nav_bar 片段

```
<%= nav_bar :fixed => :top, :brand => "Fashionable Clicheizr 2.0", :responsive => true do %>
    <%= menu_group do %>
        <%= menu_item "Home", root_path %>
        <%= menu_divider %>
        <%= drop_down "Products" do %>
            <%= menu_item "Things you can't afford", expensive_products_path %>
            <%= menu_item "Things that won't suit you anyway", harem_pants_path %>
            <%= menu_item "Things you're not even cool enough to buy anyway", hipster_products_path %>
            <% if current_user.lives_in_hackney? %>
                <%= menu_item "Bikes", fixed_wheel_bikes_path %>
            <% end %>
        <% end %>
        <%= menu_item "About Us", about_us_path %>
        <%= menu_item "Contact", contact_path %>
    <% end %>
    <%= menu_group :pull => :right do %>
        <% if current_user %>
            <%= menu_item "Log Out", log_out_path %>
        <% else %>
            <%= form_for @user, :url => session_path(:user), html => {:class=> "navbar-form pull-right"} do |f| -%>
              <p><%= f.text_field :email %></p>
              <p><%= f.password_field :password %></p>
              <p><%= f.submit "Sign in" %></p>
            <% end -%>
        <% end %>
    <% end %>
<% end %> 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-08-23T06:11:28.453

面对同样的问题几个小时。有更漂亮的代码（或者更接近炼油厂标准）的解决方案，我相信，最好覆盖基本炼油厂 menu_presenter 首先看看有点类似的任务[http://refinerycms.com/guides/menu-presenter](http://refinerycms.com/guides/menu-presenter)这个也是：[http ://refinerycms.com/guides/extending-controllers-with-decorators](http://refinerycms.com/guides/extending-controllers-with-decorators "炼油厂指南")

所以。基于那篇文章让我们这样做

**应用程序/装饰器/模型/炼油厂/page_decorator.rb：**

```
Refinery::Page.class_eval do
  def self.menu_pages
    where :show_in_menu => true
  end
end 
```

**app/helpers/application_helper.rb**

```
module ApplicationHelper
  def menu_header
    menu_items = Refinery::Menu.new(Refinery::Page.menu_pages)

    presenter = Refinery::Pages::MenuPresenter.new(menu_items, self)
    presenter.first_css = nil
    presenter.last_css = nil

    presenter
  end
end 
```

在终端运行：

```
cd /path/to/app/
rake refinery:override presenter=refinery/pages/menu_presenter 
```

它将生成**app/presenters/refinery/pages/menu_presenter.rb**将其更改为：

```
require 'active_support/core_ext/string'
require 'active_support/configurable'
require 'action_view/helpers/tag_helper'
require 'action_view/helpers/url_helper'

module Refinery
  module Pages
    class MenuPresenter
      include ActionView::Helpers::TagHelper
      include ActionView::Helpers::UrlHelper
      include ActiveSupport::Configurable

      config_accessor :roots, :menu_tag, :list_tag, :list_item_tag, :css, :dom_id,
                      :max_depth, :selected_css, :first_css, :last_css, :list_first_css,
                      :list_dropdown_css, :list_item_dropdown_css,
                      :list_item__css, :link_dropdown_options, :carret

      self.dom_id = :div
      self.css = ["nav-collapse", "collapse", "navbar-responsive-collapse"]
      self.menu_tag = :nav
      self.list_tag = :ul
      self.list_first_css = :nav
      self.carret = '<b class="caret"></b>'
      self.list_dropdown_css = "dropdown-menu"
      self.link_dropdown_options = {class: "toggle-dropdown", data: {:toggle=>"dropdown"}}
      self.list_item_tag = :li
      self.list_item_dropdown_css = :dropdown
      self.list_item__css = nil
      self.selected_css = :active
      self.first_css = :first
      self.last_css = :last
      def roots
        config.roots.presence || collection.roots
      end

      attr_accessor :context, :collection
      delegate :output_buffer, :output_buffer=, :to => :context

      def initialize(collection, context)
        @collection = collection
        @context = context
      end

      def to_html
        render_menu(roots) if roots.present?
      end

      private
      def render_menu(items)
        content_tag(menu_tag, :id => dom_id, :class => css) do
          render_menu_items(items)
        end
      end

      def render_menu_items(menu_items)
        if menu_items.present?
          content_tag(list_tag, :class => menu_items_css(menu_items)) do
            menu_items.each_with_index.inject(ActiveSupport::SafeBuffer.new) do |buffer, (item, index)|
              buffer << render_menu_item(item, index)
            end
          end
        end
      end

      def render_menu_item(menu_item, index)
        content_tag(list_item_tag, :class => menu_item_css(menu_item, index)) do
          @cont = context.refinery.url_for(menu_item.url)
          buffer = ActiveSupport::SafeBuffer.new
            if check_for_dropdown_item(menu_item)
              buffer << link_to((menu_item.title+carret).html_safe, "#", link_dropdown_options)
            else
              buffer << link_to(menu_item.title, context.refinery.url_for(menu_item.url))
            end
          buffer << render_menu_items(menu_item_children(menu_item))
          buffer
        end
      end

      def check_for_dropdown_item(menu_item)
        (menu_item!=roots.first)&&(menu_item_children(menu_item).count > 0)
      end

      # Determines whether any item underneath the supplied item is the current item according to rails.
      # Just calls selected_item? for each descendant of the supplied item
      # unless it first quickly determines that there are no descendants.
      def descendant_item_selected?(item)
        item.has_children? && item.descendants.any?(&method(:selected_item?))
      end

      def selected_item_or_descendant_item_selected?(item)
        selected_item?(item) || descendant_item_selected?(item)
      end

      # Determine whether the supplied item is the currently open item according to Refinery.
      def selected_item?(item)
        path = context.request.path
        path = path.force_encoding('utf-8') if path.respond_to?(:force_encoding)

        # Ensure we match the path without the locale, if present.
        if %r{^/#{::I18n.locale}/} === path
          path = path.split(%r{^/#{::I18n.locale}}).last.presence || "/"
        end

        # First try to match against a "menu match" value, if available.
        return true if item.try(:menu_match).present? && path =~ Regexp.new(item.menu_match)

        # Find the first url that is a string.
        url = [item.url]
        url << ['', item.url[:path]].compact.flatten.join('/') if item.url.respond_to?(:keys)
        url = url.last.match(%r{^/#{::I18n.locale.to_s}(/.*)}) ? $1 : url.detect{|u| u.is_a?(String)}

        # Now use all possible vectors to try to find a valid match
        [path, URI.decode(path)].include?(url) || path == "/#{item.original_id}"
      end

      def menu_items_css(menu_items)
        css = []

        css << list_first_css if (roots == menu_items)
        css << list_dropdown_css if (roots != menu_items)

        css.reject(&:blank?).presence

      end

      def menu_item_css(menu_item, index)
        css = []

        css << list_item_dropdown_css if (check_for_dropdown_item(menu_item))
        css << selected_css if selected_item_or_descendant_item_selected?(menu_item)
        css << first_css if index == 0
        css << last_css if index == menu_item.shown_siblings.length

        css.reject(&:blank?).presence
      end

      def menu_item_children(menu_item)
        within_max_depth?(menu_item) ? menu_item.children : []
      end

      def within_max_depth?(menu_item)
        !max_depth || menu_item.depth < max_depth
      end

    end
  end
end 
```

快完成了。将**menu_header.to_html**添加到菜单容器内的菜单中，如下所示：

```
 <div class="navbar navbar-fixed-top">
      <div class="navbar-inner">
        <div class="container">
          <a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </a>
          <a class="brand" href="#"><%=Refinery::Core::site_name %></a>
          <%= menu_header.to_html %>
        </div>
      </div>
    </div> 
```

PS：炼油厂CMS 2.1.0

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2014-04-14T20:56:00.310

**带有 Bootstrap 3 的炼油厂 2.1.0**

上述解决方案都不适合我。所以我不得不适应瓦伦丁科诺夫的回答。您可以在下面找到我的所有文件。如果您需要任何帮助，您可以随时给我留言。开始了！

# 1) 检查您的 RefineryCMS 和 Bootstrap 版本

**宝石文件**

```
gem 'bootstrap-sass', '~> 3.1.1'
gem 'refinerycms', '~> 2.1.0' 
```

# 2）节省几行代码

一种。您实际上不需要创建**app/decorators/models/refinery/page_decorator.rb**文件。

湾。您也可以忘记 menu_header 方法。这样，您将拥有：

**app/helpers/application_helper.rb**

```
module ApplicationHelper
end 
```

# 3）现在让我们开始真正的工作

一种。使用以下命令覆盖您的默认标头：

```
$ rake refinery:override view=refinery/_header.html 
```

并将其代码更改为：

**应用程序/视图/炼油厂/_header.html.erb**

```
<nav class="navbar navbar-default" role="navigation">
    <div class="container-fluid">

        <!-- Brand and toggle get grouped for better mobile display -->
        <div class="navbar-header">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="#"><%=Refinery::Core::site_name %></a>
        </div>

        <!-- Collect the nav links, forms, and other content for toggling -->
        <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
            <%= Refinery::Pages::MenuPresenter.new(refinery_menu_pages, self).to_html %>
        </div>
    </div>
</nav> 
```

湾。现在去终端并运行`rake refinery:override presenter=refinery/pages/menu_presenter`。它将生成一个**menu_presenter.rb**文件。将其更改为：

**app/presenters/refinery/pages/menu_presenter.rb**

```
require 'active_support/core_ext/string'
require 'active_support/configurable'
require 'action_view/helpers/tag_helper'
require 'action_view/helpers/url_helper'

module Refinery
    module Pages
        class MenuPresenter
            include ActionView::Helpers::TagHelper
            include ActionView::Helpers::UrlHelper
            include ActiveSupport::Configurable

            config_accessor :roots, :menu_tag, :list_tag, :list_item_tag, :css, :dom_id,
                                            :max_depth, :selected_css, :first_css, :last_css, :list_first_css,
                                            :list_dropdown_css, :list_item_dropdown_css,
                                            :list_item__css, :link_dropdown_options, :carret

            # self.dom_id = nil
            # self.css = "pull-left"
            self.menu_tag = :section
            self.list_tag = :ul
            self.list_first_css = ["nav", "navbar-nav", "navbar-right"]
            self.carret = '<b class="caret"></b>'
            self.list_dropdown_css = "dropdown-menu"
            self.link_dropdown_options = {class: "dropdown-toggle", data: {:toggle=>"dropdown"}}
            self.list_item_tag = :li
            self.list_item_dropdown_css = :dropdown
            self.list_item__css = nil
            self.selected_css = :active
            self.first_css = :first
            self.last_css = :last

            def roots
                config.roots.presence || collection.roots
            end

            attr_accessor :context, :collection
            delegate :output_buffer, :output_buffer=, :to => :context

            def initialize(collection, context)
                @collection = collection
                @context = context
            end

            def to_html
                render_menu(roots) if roots.present?
            end

            private
            def render_menu(items)
                content_tag(menu_tag, :id => dom_id, :class => css) do
                    render_menu_items(items)
                end
            end

            def render_menu_items(menu_items)
                if menu_items.present?
                    content_tag(list_tag, :class => menu_items_css(menu_items)) do
                        menu_items.each_with_index.inject(ActiveSupport::SafeBuffer.new) do |buffer, (item, index)|
                            buffer << render_menu_item(item, index)
                        end
                    end
                end
            end

            def render_menu_item(menu_item, index)
                content_tag(list_item_tag, :class => menu_item_css(menu_item, index)) do
                    @cont = context.refinery.url_for(menu_item.url)
                    buffer = ActiveSupport::SafeBuffer.new
                        if check_for_dropdown_item(menu_item)
                            buffer << link_to((menu_item.title+carret).html_safe, "#", link_dropdown_options)
                        else
                            buffer << link_to(menu_item.title, context.refinery.url_for(menu_item.url))
                        end
                    buffer << render_menu_items(menu_item_children(menu_item))
                    buffer
                end
            end

            def check_for_dropdown_item(menu_item)
                (menu_item!=roots.first)&&(menu_item_children(menu_item).count > 0)
            end

            # Determines whether any item underneath the supplied item is the current item according to rails.
            # Just calls selected_item? for each descendant of the supplied item
            # unless it first quickly determines that there are no descendants.
            def descendant_item_selected?(item)
                item.has_children? && item.descendants.any?(&method(:selected_item?))
            end

            def selected_item_or_descendant_item_selected?(item)
                selected_item?(item) || descendant_item_selected?(item)
            end

            # Determine whether the supplied item is the currently open item according to Refinery.
            def selected_item?(item)
                path = context.request.path
                path = path.force_encoding('utf-8') if path.respond_to?(:force_encoding)

                # Ensure we match the path without the locale, if present.
                if %r{^/#{::I18n.locale}/} === path
                    path = path.split(%r{^/#{::I18n.locale}}).last.presence || "/"
                end

                # First try to match against a "menu match" value, if available.
                return true if item.try(:menu_match).present? && path =~ Regexp.new(item.menu_match)

                # Find the first url that is a string.
                url = [item.url]
                url << ['', item.url[:path]].compact.flatten.join('/') if item.url.respond_to?(:keys)
                url = url.last.match(%r{^/#{::I18n.locale.to_s}(/.*)}) ? $1 : url.detect{|u| u.is_a?(String)}

                # Now use all possible vectors to try to find a valid match
                [path, URI.decode(path)].include?(url) || path == "/#{item.original_id}"
            end

            def menu_items_css(menu_items)
                css = []

                css << list_first_css if (roots == menu_items)
                css << list_dropdown_css if (roots != menu_items)

                css.reject(&:blank?).presence

            end

            def menu_item_css(menu_item, index)
                css = []

                css << list_item_dropdown_css if (check_for_dropdown_item(menu_item))
                css << selected_css if selected_item_or_descendant_item_selected?(menu_item)
                css << first_css if index == 0
                css << last_css if index == menu_item.shown_siblings.length

                css.reject(&:blank?).presence
            end

            def menu_item_children(menu_item)
                within_max_depth?(menu_item) ? menu_item.children : []
            end

            def within_max_depth?(menu_item)
                !max_depth || menu_item.depth < max_depth
            end

        end
    end
end 
```

C。重新启动服务器并查看结果。如果您已经创建了一些页面，您的导航栏应该类似于下面的导航栏：

![在此处输入图像描述](../Images/839b05c4ee5ae535d65672bfbe1102ac.png)

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2013-02-18T10:59:03.867

试试这个 _menu_branch.html.erb

```
<% if ( (children = menu_branch.children unless hide_children).present? &&
        (!local_assigns[:menu_levels] || menu_branch.ancestors.length < local_assigns[:menu_levels]) ) -%>

<%
  if !!local_assigns[:apply_css] and (classes = menu_branch_css(local_assigns)).any?
    css = "class='#{classes.join(' ')} dropdown'".html_safe
  end

-%>
<li<%= ['', css].compact.join(' ').gsub(/\ *$/, '').html_safe %>>
<%= link_to("#{menu_branch.title} <b class='caret'></b>".html_safe, refinery.url_for(menu_branch.url), :class=>"dropdown-toggle", 'data-toggle'=>'dropdown') -%>
    <ul class='dropdown-menu'>
      <%= render :partial => '/refinery/menu_branch', :collection => children,
                 :locals => {
                   :apply_css => local_assigns[:apply_css],
                   :hide_children => !!hide_children,
                   :menu_levels => local_assigns[:menu_levels]
                 } -%>
    </ul>

</li>
<% else -%>
<%
  if !!local_assigns[:apply_css] and (classes = menu_branch_css(local_assigns)).any?
    css = "class='#{classes.join(' ')}'".html_safe
  end

-%>
<li<%= ['', css].compact.join(' ').gsub(/\ *$/, '').html_safe %>>
<%= link_to(menu_branch.title, refinery.url_for(menu_branch.url)) -%>
</li>
<% end -%> 
```

_menu.html.erb

```
<%
  # Collect the root items.
  # ::Refinery::Menu is smart enough to remember all of the items in the original collection.
  if (roots = local_assigns[:roots] || (collection ||= refinery_menu_pages).roots).present?
    dom_id ||= 'menu'
    css = [(css || 'menu clearfix')].flatten.join(' ')
    hide_children = Refinery::Core.menu_hide_children if hide_children.nil?
-%>
<div id="main-menu" class="nav-collapse">
  <nav id='<%= dom_id %>' class='<%= css %>'>
    <ul id="main-menu-left" class="nav">
      <%= render :partial => '/refinery/menu_branch', :collection => roots,
                 :locals => {
                   :hide_children => hide_children,
                   :sibling_count => (roots.length - 1),
                   :menu_levels => local_assigns[:menu_levels],
                   :apply_css => true #if you don't care about class='first' class='last' or class='selected' set apply_css to false for speed.
                 } -%>
    </ul>
  </nav>
</div>
<% end -%> 
```

和 _header.html.erb

```
<div class="container">
    <div class="navbar">
      <div class="navbar-inner">
        <div class="container">
          <a data-target=".nav-collapse" data-toggle="collapse" class="btn btn-navbar">
                 <span class="icon-bar"></span>
                 <span class="icon-bar"></span>
                 <span class="icon-bar"></span>
                </a>
    <%= link_to Refinery::Core.site_name, refinery.root_path, :class => "brand" %>

    <%= render(:partial => "/refinery/menu", :locals => {
                 :dom_id => 'menu',
                 :css => 'menu'
               }) %>
        </div>
      </div>
    </div>  
</div> 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2013-03-04T18:18:45.973

user1852788 概述的方法对我有用。如果您使用带有下拉菜单的菜单，请不要忘记在 application.js 清单文件中加载引导 js：

```
//= require jquery
//= require jquery_ujs
//= require bootstrap
//= require_tree . 
```

然后调用下拉函数（我有一个名为 layout.js.coffee 的文件）：

```
$('.dropdown-toggle').dropdown() 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2015-05-03T18:04:04.047

这个要点对我来说非常适合最新的炼油厂和引导程序[https://gist.github.com/npflood/2d3f5fc44518ef231195](https://gist.github.com/npflood/2d3f5fc44518ef231195)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-04-30T03:59:47.250

有一个 gem 试图解决这个问题。

[https://github.com/ghoppe/refinerycms-bootstrap](https://github.com/ghoppe/refinerycms-bootstrap)

但我个人一直遇到问题。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-12-01T23:06:43.147

我为炼油厂找到了更简单的方法`2-0-stable`

我的解决方案如下：

第一个 _menu.html.erb`css`使用引导类更新变量并添加必要的 html，例如我添加`div`到 wrap`ul`

```
<%
  # Collect the root items.
  # ::Refinery::Menu is smart enough to remember all of the items in the original collection.
  if (roots = local_assigns[:roots] || (collection ||= refinery_menu_pages).roots).present?
    dom_id ||= 'menu'
    css = [(css || 'pull-right')].flatten.join(' ')
    hide_children = Refinery::Core.menu_hide_children if hide_children.nil?
-%>
<nav id='<%= dom_id %>' class='<%= css %>'>
  <div class="collapse navbar-collapse">
    <ul class="nav nav-pills navbar-nav">
      <%= render :partial => '/refinery/menu_branch', :collection => roots,
                 :locals => {
                   :hide_children => hide_children,
                   :sibling_count => (roots.length - 1),
                   :menu_levels => local_assigns[:menu_levels],
                   :apply_css => true #if you don't care about class='first' class='last' or class='selected' set apply_css to false for speed.
                 } -%>
    </ul>
  </div>
</nav>
<% end -%> 
```

第二个带有引导类的 _menu_branch.html.erb 更新类

```
 <%
  if !!local_assigns[:apply_css] and (classes = menu_branch_css(local_assigns)).any?
    css = "class='#{classes.join(' ')}'".html_safe
  end
-%>
<% if ( (children = menu_branch.children unless hide_children).present? &&
        (!local_assigns[:menu_levels] || menu_branch.ancestors.length < local_assigns[:menu_levels]) ) -%>
  <li class="dropdown">
    <a href="<%= refinery.url_for(menu_branch.url) %>" class="dropdown-toggle" data-toggle="dropdown"><%= menu_branch.title %><b class="caret"></b></a>
    <ul class='dropdown-menu'>
      <%= render :partial => '/refinery/menu_branch', :collection => children,
                 :locals => {
                   :apply_css => local_assigns[:apply_css],
                   :hide_children => !!hide_children,
                   :menu_levels => local_assigns[:menu_levels]
                 } -%>
    </ul>
<% else -%>
  <li<%= ['', css].compact.join(' ').gsub(/\ *$/, '').html_safe %>>
  <%= link_to(menu_branch.title, refinery.url_for(menu_branch.url)) -%>
<% end -%>
  </li> 
```

现在你的菜单应该可以正常显示了。要启用`Active`，您只需要`/config/initializers/refinery/core.rb`通过更改以下代码来更新文件：

将选中的更改为`active`

```
 # CSS class selectors for menu helper
  config.menu_css = {:selected=>"active", :first=>"first", :last=>"last"} 
```

# c# - 什么是 std::map 等价于asp.net？

> ID：14759713
> 
> 赞同：0
> 
> 时间：2013-02-07T19:48:01.833
> 
> 标签：c#, asp.net

`std::map<string,bool>`在 asp.net中最接近的东西是什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-07T19:49:56.010

**[字典](http://msdn.microsoft.com/en-us/library/xfhwa508.aspx)**。

```
Dictionary<string, bool> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-07T19:50:02.513

我想你可能会使用：

```
System.Collections.Generic.Dictionary<string,bool> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-07T20:00:03.870

该`Dictionary`集合是一个哈希表。`System.Collections.Generic.Dictionary<string,bool>`是最相似的数据结构`std::map<string,bool>`。

# c++ - OpenGL ES 2.0 纹理加载视觉故障

> ID：14759714
> 
> 赞同：0
> 
> 时间：2013-02-07T19:48:12.503
> 
> 标签：c++, ios, objective-c, opengl-es

我已经成功地通过着色器使用颜色组件渲染图元并翻译它们。但是，在尝试通过着色器加载纹理并为图元渲染时，图元出现故障，它们应该是正方形：

![在此处输入图像描述](../Images/60598e6a561219a28d150dd1c5d86865.png)

如您所见，它成功加载了带有颜色分量的纹理并将其应用到场景中的单个图元。

如果我然后删除颜色分量，我又会有图元，但奇怪的是，它们是通过改变 uvs 来缩放的——这不应该是这种情况，只有 uvs 应该缩放！（它们的原点也是偏移的）

我的着色器初始化代码：

```
 void renderer::initRendererGfx()
 {
shader->compilerShaders();

shader->loadAttribute(@"Position");
shader->loadAttribute(@"SourceColor");
shader->loadAttribute(@"TexCoordIn");

 } 
```

这是我的对象处理程序渲染功能代码：

```
void renderer::drawRender(glm::mat4 &view, glm::mat4 &projection)
   {
  //Loop through all objects of base type OBJECT
for(int i=0;i<SceneObjects.size();i++){
    if(SceneObjects.size()>0){
        shader->bind();//Bind the shader for the rendering of this object
        SceneObjects[i]->mv = view * SceneObjects[i]->model;
        shader->setUniform(@"modelViewMatrix", SceneObjects[i]->mv);//Calculate object model view
        shader->setUniform(@"MVP", projection * SceneObjects[i]->mv);//apply projection transforms to object

        glActiveTexture(GL_TEXTURE0); // unneccc in practice
        glBindTexture(GL_TEXTURE_2D, SceneObjects[i]->_texture);

        shader->setUniform(@"Texture", 0);//Apply the uniform for this instance
        SceneObjects[i]->draw();//Draw this object
        shader->unbind();//Release the shader for the next object
    }
  }
} 
```

这是我的精灵缓冲区初始化和绘制代码：

```
 void spriteObject::draw()
{
glVertexAttribPointer((GLuint)0, 3, GL_FLOAT, GL_FALSE, sizeof(SpriteVertex), NULL);

glVertexAttribPointer((GLuint)1, 4, GL_FLOAT, GL_FALSE, sizeof(SpriteVertex) , (GLvoid*)     (sizeof(GL_FLOAT) * 3));
glVertexAttribPointer((GLuint)2, 2, GL_FLOAT, GL_FALSE, sizeof(SpriteVertex) , (GLvoid*)(sizeof(GL_FLOAT) * 7));

glDrawElements(GL_TRIANGLE_STRIP, sizeof(SpriteIndices)/sizeof(SpriteIndices[0]), GL_UNSIGNED_BYTE, 0);

}
 void spriteObject::initBuffers()
{
glGenBuffers(1, &vertexBufferID);
glBindBuffer(GL_ARRAY_BUFFER, vertexBufferID);
glBufferData(GL_ARRAY_BUFFER, sizeof(SpriteVertices), SpriteVertices, GL_STATIC_DRAW);

glGenBuffers(1, &indexBufferID);
glBindBuffer(GL_ELEMENT_ARRAY_BUFFER, indexBufferID);
glBufferData(GL_ELEMENT_ARRAY_BUFFER, sizeof(SpriteIndices), SpriteIndices, GL_STATIC_DRAW);

  } 
```

这是顶点着色器：

```
 attribute vec3 Position;
 attribute vec4 SourceColor;

 varying vec4 DestinationColor;

 uniform mat4 projectionMatrix;
 uniform mat4 modelViewMatrix;
 uniform mat4 MVP;

 attribute vec2 TexCoordIn;
 varying vec2 TexCoordOut;

 void main(void) {
 DestinationColor = SourceColor;
 gl_Position = MVP * vec4(Position,1.0);
 TexCoordOut = TexCoordIn;
  } 
```

最后是片段着色器：

```
 varying lowp vec4 DestinationColor;

  varying lowp vec2 TexCoordOut;
  uniform sampler2D Texture;

  void main(void) {
  gl_FragColor = DestinationColor * texture2D(Texture, TexCoordOut);
  } 
```

如果您想查看某些元素的更多细节，请询问。

非常感谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-07T21:30:55.537

你确定你的三角形有相同的绕组吗？缠绕是列出三角形点的顺序（顺时针或逆时针）。绕组用于面剔除以确定三角形是面向还是背面。

您可以通过禁用面部剔除轻松检查三角形是否缠绕错误。

```
glDisable( GL_CULL_FACE ); 
```

更多信息在这里（[http://db-in.com/blog/2011/02/all-about-opengl-es-2-x-part-23/#face_culling](http://db-in.com/blog/2011/02/all-about-opengl-es-2-x-part-23/#face_culling)）

# sql - SQL join 与 group by

> ID：14759717
> 
> 赞同：0
> 
> 时间：2013-02-07T19:48:15.457
> 
> 标签：sql, join

我对加入还是很陌生，发现它们有点令人困惑。

我有这个查询，它使用 group by 语句，以便获得唯一 t_id 的列表

```
$list = mysql_query("SELECT t_id FROM table WHERE id='$id'  GROUP BY t_id ORDER BY date DESC "); 
```

我需要做的是从一个单独的表中获取信息，比如基于这个 t_id 的 table_2。在 table_2 中， t_id 只出现一次，这样就更容易了。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-07T19:54:03.687

```
$list = mysql_query("SELECT table.t_id, table2.linked_info FROM table LEFT JOIN table2 on table2.t_id = table.t_id WHERE table.t_id='$id'  GROUP BY t_id ORDER BY date DESC "); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-07T19:54:14.863

像这样写查询

```
SELECT t1.t_id, t1.date, t2.* FROM table t1 INNER JOIN table_2 t2 ON t1.t_id = t2.t_id WHERE id='$id' ORDER BY date DESC 
```

在这我相信`id`并且`t_id`是不同的专栏。如果没有在 where 条件下更正列名。

# sql-server - 如何将 data.txt 和 attributes.txt 和 mapping.sql 获取到关系数据库

> ID：14759725
> 
> 赞同：1
> 
> 时间：2013-02-07T19:49:03.610
> 
> 标签：sql-server, database, ms-access, database-design, mdf

我正在尝试从位于[http://archive.ics.uci.edu/ml/machine-learning-databases/census1990-mld/的一些文件创建一个 MDF（Microsoft SQL Server 数据库）](http://archive.ics.uci.edu/ml/machine-learning-databases/census1990-mld/)

任何人都可以帮助我执行此操作的步骤吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-07T19:53:48.990

我建议将数据导入新数据库。打开 SQL Server Management Studio，创建一个新数据库，然后决定如何导入数据。

可能最简单的方法是右键单击 Management Studio 中的数据库 - 任务 -> 导入数据...在向导中选择您的平面文件，然后选择您的映射。

另一种选择是使用 SSIS 包。它们并不难学，但比以前的选项更难，而且对于可重复的过程更难。 [本文](http://www.mssqltips.com/sqlservertip/1207/different-options-for-importing-data-into-sql-server/) 也有很多替代解决方案。

# string - 使用一些字符串形成给定模式的算法

> ID：14759726
> 
> 赞同：1
> 
> 时间：2013-02-07T19:49:05.410
> 
> 标签：string, algorithm, design-patterns

给定 6 个任意长度的字符串。单词将按如下所示的模式排列。它们可以垂直或水平排列。

```
 --------
      |      |
      |      |
      |      |
      ---------------
             |      |
             |      |
             |      |
             -------- 
```

图案不必是对称的，并且需要有两个空白区域，如图所示。例如：

给定字符串

```
PQF  
DCC  
ACTF  
CKTYCA  
PGYVQP  
DWTP 
```

图案可以是

```
DCC...  
W.K...  
T.T...  
PGYVQP  
..C..Q  
..ACTF 
```

其中点代表空白区域。

另一个例子是

```
RVE  
LAPAHFUIK  
BIRRE  
KZGLPFQR  
LLHU  
UUZZSQHILWB 
```

模式是

```
LLHU....  
A..U....   
P..Z....  
A..Z....  
H..S....  
F..Q....  
U..H....  
I..I....  
KZGLPFQR  
...W...V  
...BIRRE 
```

如果可能有多个模式，则将形成具有字典顺序最小的第一行的模式，然后形成第二行，依此类推。有什么算法可以解决这个问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-07T19:57:45.327

查找适合此约束的字符串：

```
strlen(a) + strlen(b) - 1 = strlen(c)
strlen(d) + strlen(e) - 1 = strlen(f) 
```

之后尝试所有可能的情况，如果它们是有效的。例如;

```
aaa.....
d.f.....
d.f.....
d.f.....
cccccccc
..f....e
..f....e
..bbbbbb 
```

会有`2*2*2 = 8`不同的情况。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-07T20:55:37.363

您可以应用许多启发式方法，但在此之前，让我们回顾一下拼图的一些属性。

```
+aa+
c  f
+ee+eee+
   f   d
   +bbb+ 
```

让我们用与上图中出现的相同字符来调用字符串的长度。我们有：

```
a + b - 1 = e
c + d - 1 = f 
```

我将把中间交叉的 2 根弦称为中间弦。

我们也推断出字符串的长度不能小于2。因此，我们可以推断：

```
e > a, e > b
f > c, f > d 
```

由此，我们知道由于上面的不等式，两个最短的字符串不可能是中间字符串。

最大的 3 个字符串也不可能相等，因为在选择 3 个字符串中的任何一个作为中间字符串后，我们剩下 2 个最大的字符串相等，根据上面的不等式是不可能的。

只有当长度正常时，这个谜题才会变得棘手。当长度不规则时，可以直接从长度映射到位置。

如果我们有 2 个最大的字符串相等，由于上面的不等式，它们是 2 个中间字符串。最坏的情况是“常规”拼图，其中长度 a、b、c、d 相等。

如果两个最大的字符串不相等，则可以立即确定最大字符串的位置（因为它的长度在拼图中是唯一的） - 作为中间字符串之一。在最坏的情况下，另一个中间字符串可能有 3 个候选者 - 只是蛮力并检查所有这些。

算法：

*   尝试将唯一长度字符串映射到该位置。
*   蛮力在中间的 2 个字符串（考虑到我上面提到的），蛮力填充其余的。

即使用愚蠢的蛮力，也只有6个！= 720 例，如果字符串只能从左到右，从上到下（不能反向）。如果允许字符串在任何方向上，将有 46080 个案例 (* 2^6)。

# android - Listview BaseAdapter 类 getview 被多次调用以获得相同的位置

> ID：14759731
> 
> 赞同：0
> 
> 时间：2013-02-07T19:49:22.493
> 
> 标签：android, android-listview

实际上我的问题和这个人的一样。[但](https://stackoverflow.com/questions/11186004/yet-another-getview-called-multiple-times)我不知道如何解决它。这是我的 listview xml 文件。

```
<?xml version="1.0" encoding="utf-8"?>
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
android:layout_width="fill_parent"
android:layout_height="fill_parent"
android:background="#FFFFFF">

<LinearLayout     android:orientation="horizontal"
                  android:layout_width="fill_parent"
                  android:layout_height="wrap_content"
                  android:weightSum="3"
                  android:background="#CCCCCC"
                  android:id="@+id/tabs">

    <Button 
           android:layout_width="fill_parent"
           android:layout_height="wrap_content"
           android:layout_weight="1"
           android:background="#CCCCCC"
           android:textSize="20sp"
           android:textColor="#000000"
           android:text="@string/NewTask"
           android:id="@+id/tab1"
        />

    <Button 
           android:layout_width="fill_parent"
           android:layout_height="wrap_content"
           android:background="#CCCCCC"
           android:layout_weight="1"
           android:textSize="20sp"
           android:textColor="#000000"
           android:text="@string/Friends"
           android:id="@+id/tab2"
        />
    <Button 
           android:layout_width="fill_parent"
           android:background="#CCCCCC"
           android:layout_height="wrap_content"
           android:textColor="#000000"
           android:layout_weight="1"
           android:text="@string/AddPeople"
           android:textSize="20sp"
           android:id="@+id/tab3"
        />
    </LinearLayout>

<ListView
    android:id="@android:id/list"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"
    android:cacheColorHint="#000000"
    android:layout_below="@+id/tabs"
/>

</RelativeLayout> 
```

我正在尝试从`onpostExecute`我的`AsyncTask class`. 这是我的列表活动的功能。

```
public void SetImage(Bitmap bmp,int index)
{
    View v = this.ls.getChildAt(index);
    ImageView img = (ImageView)v.findViewById(R.id.tasks_userimg);
    img.setImageBitmap(bmp);
} 
```

这个 bmp 是`asynctask`类中下载的位图，`ls`是列表视图，是列表视图`index`中项目的索引。当 postexecute 运行时，我使用参数调用此函数以更新列表视图项目图像。

问题与我在链接中提到的完全相同，即当我滚动它时出现错误。但他通过更改列表视图的布局宽度解决了问题，但它在这里不起作用。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-07T20:49:36.337

似乎和许多其他人一样，您对这种特殊观点有一些问题。

我强烈推荐观看讲座“ [listView 的世界](http://www.google.com/events/io/2010/sessions/world-of-listview-android.html)”。

他们谈论了很多与 listView 相关的话题，包括在同一个视图上多次调用 getView 的话题。简而言之，之所以会发生，是因为测量listView项目时也调用了getView。您可以使用（并且应该）使用 convertView 以避免不必要的数据膨胀和获取。

关于问题本身，您不应在 listView 项目上使用 findViewById，因为它们正在被重复使用。例如，为第 0 个位置设置的视图可能会被设置为第 7 个位置，以防用户向下滚动。

如果您希望从 listView 更新单个项目，您可以使用如下内容：

```
// itemIndex is the index of the item to update
final View v=listView.getChildAt(itemIndex-listView.getFirstVisiblePosition());
//now you update your view according to what you wish . 
//you must of course handle the cases that you can't get the view . 
```

当然，一旦你这样做了，你还必须在适配器后面更新你的数据，这样下次用户滚动到这个项目时，它就会显示位图。

您应该做什么取决于您使用的 asyncTask 。

我假设您在列表视图填充其项目时下载多个位图。如果是这种情况，请查看[此示例](http://developer.android.com/training/displaying-bitmaps/index.html)，或使用我的建议：为您拥有的每个 viewHolder 设置一个 asyncTask。每次调用 getView 时，取消旧的并为当前项目创建一个新的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-07T20:59:41.547

1）定义您的自定义适配器

2) 应用支架图案

3）使用一些图片上传器（例如[这个](https://github.com/nostra13/Android-Universal-Image-Loader)）

看一个简单的[例子](https://github.com/gobozov/piterfm/blob/master/src/ru/piter/fm/fragments/RadioFragment.java)

# java - 通过字符串中的名称从组件调用方法

> ID：14759734
> 
> 赞同：1
> 
> 时间：2013-02-07T19:49:24.590
> 
> 标签：java, string, methods

我只想知道是否有任何方法可以通过字符串中的名称从对象上调用方法。

像这样的东西

`setLocation(int,int)`这是一个方法`jLabel1`，我如何
`method(setLocation())`通过在字符串中使用它的名称来调用它？

```
String component = jLabel1.getName();
component.setLocation(x,y); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-07T19:51:27.600

当然，您可以使用[Java 反射 API](http://docs.oracle.com/javase/tutorial/reflect/index.html)

[这个 SO question](https://stackoverflow.com/questions/2621251/java-reflection)可能会对您有所帮助。

# java - RESTeasy、JSON 和空字段

> ID：14759743
> 
> 赞同：4
> 
> 时间：2013-02-07T19:49:51.893
> 
> 标签：java, json, jaxb, annotations, resteasy

当 RESTeasy 将 POJO 编组为 XML 时，默认情况下会跳过空值。

但是，在编组为 JSON 时，会包含 null 属性。有没有办法强制 JSON 输出匹配 XML 输出？

我也试过@XmlElement(required=false, nillable=true)) 但它没有用。我只用过带有注释的 RESTeasy。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-07T20:24:06.947

使用 Jackson 2\. 设置以下提供程序：

```
package com.recruitinghop.swagger;

import javax.ws.rs.Produces;
import javax.ws.rs.core.MediaType;
import javax.ws.rs.ext.Provider;

import com.fasterxml.jackson.annotation.JsonInclude;
import com.fasterxml.jackson.databind.DeserializationFeature;
import com.fasterxml.jackson.databind.ObjectMapper;
import com.fasterxml.jackson.databind.SerializationFeature;
import com.fasterxml.jackson.jaxrs.json.JacksonJaxbJsonProvider;
import com.fasterxml.jackson.module.scala.DefaultScalaModule;

@Provider
@Produces(MediaType.APPLICATION_JSON)
public class JacksonJsonProvider extends JacksonJaxbJsonProvider {

    public JacksonJsonProvider() {
          ObjectMapper mapper = new ObjectMapper();
          mapper.registerModule(new DefaultScalaModule());
          mapper.setSerializationInclusion(JsonInclude.Include.NON_NULL);
          mapper.setSerializationInclusion(JsonInclude.Include.NON_DEFAULT);
          mapper.configure(SerializationFeature.WRITE_DATES_AS_TIMESTAMPS, false);
          mapper.configure(DeserializationFeature.FAIL_ON_UNKNOWN_PROPERTIES, false);
          super.setMapper(mapper);
    }

} 
```

Scala 模块是可选的。

# git - 仅在 git 中暂存分阶段更改 - 有可能吗？

> ID：14759748
> 
> 赞同：574
> 
> 时间：2013-02-07T19:50:04.273
> 
> 标签：git, git-stash

有没有办法只存储我的分阶段更改？我遇到问题的场景是我在给定时间处理了几个错误，并且有几个未分阶段的更改。我希望能够单独暂存这些文件，创建我的 .patch 文件并将它们隐藏起来，直到代码获得批准。这样，当它被批准时，我可以隐藏我的整个（当前）会话，弹出那个错误并推送代码。

我会以错误的方式解决这个问题吗？我是否误解了 git 如何以其他方式简化我的流程？

* * *

## 回答 #1

> 赞同：662
> 
> 时间：2015-10-05T14:42:18.620

是的，可以使用**DOUBLE STASH**

1.  暂存您需要存储的所有文件。
2.  运行`git stash --keep-index`。此命令将创建一个包含**所有**更改（*暂存和未暂存*）的存储，但会将暂存的更改保留在您的工作目录中（仍处于暂存状态）。
3.  跑`git stash push -m "good stash"`
4.  现在您`"good stash"`只有**暂存文件**。

现在，如果您在 stash 之前需要未暂存的文件，只需应用第一个 stash（*使用 创建的那个`--keep-index`*），现在您可以删除您隐藏的文件`"good stash"`。

享受

* * *

## 回答 #2

> 赞同：184
> 
> 时间：2017-06-29T11:55:41.473

使用最新的 git，您可以使用`--patch`选项

```
git stash push --patch   # since 2.14.6

git stash save --patch   # for older git versions 
```

并且 git 会询问您文件中的每个更改是否添加到存储中。
您只需回答`y`或`n`

****DOUBLE STASH的****UPD**
别名：**

 ****```
git config --global alias.stash-staged '!bash -c "git stash --keep-index; git stash push -m "staged" --keep-index; git stash pop stash@{1}"' 
```

现在您可以暂存文件，然后运行`git stash-staged`​​.
结果**，您的暂存文件将保存到 stash**中。

如果您不想保留暂存文件并将它们移动到存储中。然后你可以添加另一个别名并运行`git move-staged`：

```
git config --global alias.move-staged '!bash -c "git stash-staged;git commit -m "temp"; git stash; git reset --hard HEAD^; git stash pop"' 
```

* * *

## 回答 #3

> 赞同：167
> 
> 时间：2020-01-23T09:14:46.837

> **TL;DR**只需`-- $(git diff --staged --name-only)`为您的 git`<pathspec>`参数添加

### 这是一个简单的单行：

```
git stash -- $(git diff --staged --name-only) 
```

并简单地添加一条消息：

```
git stash push -m "My work in progress" -- $(git diff --staged --name-only) 
```

> *在**v2.17.1**和**v2.21.0.windows.1上测试***
> 
> ***限制：***
> 
> *   请注意，如果您没有暂存文件，这将隐藏每一件事。
> *   此外，如果您有一个仅部分暂存的文件（即只有一些更改的行被暂存，而其他一些更改的行没有），那么整个文件将被隐藏（包括未暂存的行）。

* * *

## 回答 #4

> 赞同：56
> 
> 时间：2016-09-22T16:55:22.617

我制作了一个脚本，它只存储当前上演的内容并保留其他所有内容。当我开始进行太多不相关的更改时，这真是太棒了。简单地暂存与所需提交无关的内容并将其隐藏。

（感谢 Bartłomiej 的起点）

```
#!/bin/bash

#Stash everything temporarily.  Keep staged files, discard everything else after stashing.
git stash --keep-index

#Stash everything that remains (only the staged files should remain)  This is the stash we want to keep, so give it a name.
git stash save "$1"

#Apply the original stash to get us back to where we started.
git stash apply stash@{1}

#Create a temporary patch to reverse the originally staged changes and apply it
git stash show -p | git apply -R

#Delete the temporary stash
git stash drop stash@{1} 
```

* * *

## 回答 #5

> 赞同：38
> 
> 时间：2018-10-05T19:55:45.967

为了完成同样的事情......

1.  仅暂存您要处理的文件。
2.  `git commit -m 'temp'`
3.  `git add .`
4.  `git stash`
5.  `git reset HEAD~1`

繁荣。您不想要的文件被隐藏起来。你想要的文件都准备好了。

* * *

## 回答 #6

> 赞同：27
> 
> 时间：2021-12-05T06:23:10.787

在 Git 2.35（2022 年第一季度）中，“ [`git stash`](https://github.com/git/git/blob/44ac8fd1b4ce7598e2e5f4045dfbb6593a3f5b84/Documentation/git-stash.txt)” ^(（[man](https://git-scm.com/docs/git-stash)）)学会了`--staged`隐藏已添加到索引中的内容的选项（仅此而已）。

所以现在正式支持（8 年后）。

请参阅[Sergey Organov ( ) 的提交](https://github.com/sorganov)[a8a6e06](https://github.com/git/git/commit/a8a6e0682d1749b646aabbaad571ee5dc3634026) （ 2021 年 10 月 28 日）和[提交 41a28eb](https://github.com/git/git/commit/41a28eb6c124bd06ca4a4fea9a1da3178a09467b)（2021 年 10 月 18 日[）](https://github.com/sorganov)。^(（由)^([Junio C Hamano 合并](https://github.com/gitster))^([——](https://github.com/gitster))^在^([提交 44ac8fd](https://github.com/git/git/commit/44ac8fd1b4ce7598e2e5f4045dfbb6593a3f5b84))^(中，2021 年 11 月 29 日）)[`sorganov`](https://github.com/sorganov)
^([`gitster`](https://github.com/gitster))

> ## [`stash`](https://github.com/git/git/commit/41a28eb6c124bd06ca4a4fea9a1da3178a09467b): 为 'push' 和 'save' 实现 '--staged' 选项
> 
> ^(签字人：谢尔盖·奥加诺夫)

> 仅存储暂存的更改。
> 
> 此模式允许轻松隐藏以供以后重用与当前正在进行的工作无关的一些更改。
> 
> 与 ' `stash push --patch`' 不同，`--staged`支持使用任何工具来选择要隐藏的更改，包括但不限于 ' [`git add --interactive`](https://github.com/git/git/blob/41a28eb6c124bd06ca4a4fea9a1da3178a09467b/Documentation/git-add.txt#L90)' ^(( [man](https://git-scm.com/docs/git-add#Documentation/git-add.txt---interactive) ))。

`git stash`现在在其[手册页](https://github.com/git/git/blob/41a28eb6c124bd06ca4a4fea9a1da3178a09467b/Documentation/git-stash.txt#L16)中包含：

> `'git stash' [push [-p|--patch] [-S|--staged] [-k|--[no-]keep-index] [-q|--quiet]`

`git stash`现在在其[手册页](https://github.com/git/git/blob/41a28eb6c124bd06ca4a4fea9a1da3178a09467b/Documentation/git-stash.txt#L63)中包含：

> `save [-p|--patch] [-S|--staged] [-k|--[no-]keep-index] [-u|--include-untracked] [-a|--all] [-q|--quiet] [<message>]`

`git stash`现在在其[手册页](https://github.com/git/git/blob/41a28eb6c124bd06ca4a4fea9a1da3178a09467b/Documentation/git-stash.txt#L208-L217)中包含：

> ## `-S`
> 
> ## `--staged`
> 
> 此选项仅对`push`和`save`命令有效。
> 
> 仅存储当前暂存的更改。这类似于基本`git commit`的，除了状态被提交到存储而不是当前分支。
> 
> 该`--patch`选项优先于该选项。

`git stash`现在在其[手册页](https://github.com/git/git/blob/41a28eb6c124bd06ca4a4fea9a1da3178a09467b/Documentation/git-stash.txt#L354-L371)中包含：

> ## `Saving unrelated changes for future use`
> 
> 当您正在进行大规模更改并且发现一些您不想忘记修复的不相关问题时，您可以进行更改，将它们暂存并用于`git stash push --staged`将它们隐藏起来以备将来使用。
> 这类似于提交分阶段的更改，只是提交最终在存储中，而不是在当前分支中。
> 
> ```
> ----------------------------------------------------------------
> # ... hack hack hack ...
> $ git add --patch foo           # add unrelated changes to the index
> $ git stash push --staged       # save these changes to the stash
> # ... hack hack hack, finish curent changes ...
> $ git commit -m 'Massive'       # commit fully tested changes
> $ git switch fixup-branch       # switch to another branch
> $ git stash pop                 # to finish work on the saved changes
> ---------------------------------------------------------------- 
> ```

* * *

## 回答 #7

> 赞同：18
> 
> 时间：2020-03-26T19:49:07.207

**2022 年 1 月更新**：Git 2.35 已发布，`stash`现在支持`--staged`参数。因此，此答案对于 Git 2.35+ 已过时。请参阅 vonc 的回答：[https](https://stackoverflow.com/a/70231955/430128) ://stackoverflow.com/a/70231955/430128 。

老答案：

在 Git 中仅存储索引（分阶段更改）比应有的困难。我发现@Joe 的[答案](https://stackoverflow.com/a/39644782/430128)运行良好，并将它的一个小变体变成了这个别名：

```
stash-index = "!f() { \
  ! git diff --cached --exit-code --quiet && \
  git stash push --quiet --keep-index -m \"temp for stash-index\" && \
  git stash push \"$@\" && \
  git stash pop --quiet stash@{1} && \
  git stash show -p | git apply -R; }; f" 
```

它：

1.  验证是否存在实际分阶段的更改（`git diff --cached --exit-code`如果有则返回非零状态）。HT：@nandilugio

2.  它将分阶段和非分阶段的更改*都推送到临时存储中，而单独保留分阶段的更改。*

3.  然后它将分阶段的更改推送到存储中，这是我们想要保留的存储。传递给别名的参数，例如`--message "whatever"`将添加到此存储命令中。

4.  它弹出临时存储以恢复原始状态并删除临时存储，然后

5.  最后通过反向补丁应用程序从工作目录中“删除”隐藏的更改。

对于仅存储未暂存更改（别名`stash-working`）的相反问题，请参见此[答案](https://stackoverflow.com/a/60875082/430128)。

* * *

## 回答 #8

> 赞同：13
> 
> 时间：2018-06-05T05:52:06.200

在这种情况下，我更喜欢为每个问题创建新的分支。我使用前缀 temp/ 所以我知道以后可以删除这些分支。

```
git checkout -b temp/bug1 
```

暂存修复 bug1 的文件并提交它们。

```
git checkout -b temp/bug2 
```

然后，您可以根据需要从各个分支中挑选提交并提交拉取请求。

* * *

## 回答 #9

> 赞同：7
> 
> 时间：2013-02-07T19:58:40.250

为什么不提交某个错误的更改并从该提交及其前身创建一个补丁？

```
# hackhackhack, fix two unrelated bugs
git add -p                   # add hunks of first bug
git commit -m 'fix bug #123' # create commit #1
git add -p                   # add hunks of second bug
git commit -m 'fix bug #321' # create commit #2 
```

然后，要创建适当的补丁，请使用`git format-patch`：

```
git format-patch HEAD^^ 
```

这将创建两个文件：`0001-fix-bug-123.patch`和`0002-fix-bug-321.patch`

或者，您可以为每个错误创建单独的分支，这样您就可以单独合并或重新调整错误修复，如果它们不起作用，甚至删除它们。

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2019-07-27T20:36:50.290

`git stash --keep-index`是一个很好的解决方案...除了它在已删除的路径上无法正常工作，这已在 Git 2.23（2019 年第三季度）中修复

请参阅[Thomas Gummerer ( ) 的](https://github.com/tgummerer)[提交 b932f6a](https://github.com/git/git/commit/b932f6a5e8cdbb33eff4563fdfb1eae9ebf70a65)（2019 年 7 月 16 日[）](https://github.com/tgummerer)。^(（由)^([Junio C Hamano 合并](https://github.com/gitster))^([——](https://github.com/gitster))^在^([提交 f8aee85](https://github.com/git/git/commit/f8aee8576ac5e01fa993c80b5b888af214c03758))^(中，2019 年 7 月 25 日）)[`tgummerer`](https://github.com/tgummerer)
^([`gitster`](https://github.com/gitster))

> ## `stash`：修复处理删除的文件`--keep-index`
> 
> `git stash push --keep-index`应该将所有已添加到索引中的更改保留在索引和磁盘中。
> 
> 目前，当从索引中删除文件时，这不会正确运行。**--keep-index当前恢复文件
> **，而不是将其保留在磁盘上。****
> 
> `git checkout`通过在无覆盖模式下使用“”来修复该行为，可以忠实地恢复索引和工作树。
> 这也简化了代码。
> 
> 请注意，如果未跟踪的文件与已在索引中删除的文件同名，这将覆盖未跟踪的文件。

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2020-11-29T18:24:28.027

另一种方法是使用您不想隐藏的文件创建一个临时提交，然后隐藏剩余的文件并轻轻删除最后一次提交，保持文件完整：

```
git add *files that you don't want to be stashed*
git commit -m "temp"
git stash --include-untracked
git reset --soft HEAD~1 
```

这样你就只能触摸你想要触摸的文件。

请注意，这里使用“--include-untracked”来存储新文件（这可能是您真正想要的）。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2013-02-07T20:26:30.427

是否绝对有必要同时处理多个错误？“一次”是指“同时为多个错误编辑文件”。因为除非您绝对需要，否则我一次只会在您的环境中处理一个错误。这样你就可以使用本地分支和变基，我发现这比管理复杂的存储/阶段要容易得多。

假设 master 在提交 B。现在处理 bug #1。

```
git checkout -b bug1 
```

现在你在分支 bug1 上。进行一些更改，提交，等待代码审查。这是本地的，因此您不会影响其他任何人，并且从 git diffs 制作补丁应该很容易。

```
A-B < master
   \
    C < bug1 
```

现在你正在处理 bug2。回去掌握。*_* `git checkout master`新建一个分支，`git checkout -b bug2`. 进行更改，提交，等待代码审查。

```
 D < bug2
   /
A-B < master
   \
    C < bug1 
```

让我们假设其他人在您等待审查时在 master 上提交了 E&F。

```
 D < bug2
   /
A-B-E-F < master
   \
    C < bug1 
```

当您的代码获得批准后，您可以通过以下步骤将其重新设置为 master：

```
git checkout bug1
git rebase master
git checkout master
git merge bug1 
```

这将导致以下结果：

```
 D < bug2
   /
A-B-E-F-C' < master, bug1 
```

然后你可以推送，删除你的本地 bug1 分支，然后你就可以走了。在您的工作空间中一次出现一个错误，但通过使用本地分支，您的存储库可以处理多个错误。这避免了复杂的舞台/隐藏舞。

**在评论中回答ctote的问题：**

好吧，您可以为每个错误返回 stash，并且一次只处理一个错误。至少可以为您节省分期问题。但是试过这个，我个人觉得很麻烦。在 git 日志图中，Stash 有点混乱。更重要的是，如果你把事情搞砸了，你就无法恢复。如果你有一个脏的工作目录并且你弹出一个存储，你不能“撤消”那个弹出。搞砸已经存在的提交要困难得多。

所以`git rebase -i`。

当您将一个分支变基到另一个分支时，您可以交互地进行（-i 标志）。执行此操作时，您可以选择要对每个提交执行的操作。Pro Git 是一本很棒的书，它也以 HTML 格式在线，并且有一个关于 rebase 和 squashing 的不错的部分：

[http://git-scm.com/book/ch6-4.html](http://git-scm.com/book/ch6-4.html)

为方便起见，我将逐字窃取他们的示例。假设您有以下提交历史记录，并且您想将 bug1 变基并压缩到 master 上：

```
 F < bug2
   /
A-B-G-H < master
   \
    C-D-E < bug1 
```

这是您在键入时将看到的内容`git rebase -i master bug1`

```
pick f7f3f6d changed my name a bit
pick 310154e updated README formatting and added blame
pick a5f4a0d added cat-file
#
# Commands:
#  p, pick = use commit
#  e, edit = use commit, but stop for amending
#  s, squash = use commit, but meld into previous commit
#
# If you remove a line here THAT COMMIT WILL BE LOST.
# However, if you remove everything, the rebase will be aborted.
# 
```

要将分支的所有提交压缩为单个提交，请将第一个提交保留为“pick”并将所有后续“pick”条目替换为“squash”或简单的“s”。您也将有机会更改提交消息。

```
pick f7f3f6d changed my name a bit
s 310154e updated README formatting and added blame
s a5f4a0d added cat-file
#
# Commands:
#  p, pick = use commit
#  e, edit = use commit, but stop for amending
#  s, squash = use commit, but meld into previous commit 
```

所以，是的，squashing 有点痛苦，但我仍然会推荐它而不是大量使用 stash。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2015-08-26T07:40:06.450

在您对 Mike Monkiewicz 回答的评论中，我建议使用更简单的模型：使用常规开发分支，但使用合并的 squash 选项在您的主分支中获得单个提交：

```
git checkout -b bug1    # create the development branch
* hack hack hack *      # do some work
git commit
* hack hack hack *
git commit
* hack hack hack *
git commit
* hack hack hack *
git commit
git checkout master     # go back to the master branch
git merge --squash bug1 # merge the work back
git commit              # commit the merge (don't forget
                        #    to change the default commit message)
git branch -D bug1      # remove the development branch 
```

此过程的优点是您可以使用正常的 git 工作流程。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2019-08-09T10:16:21.013

要删除意外更改，尤其是删除多个文件，请执行以下操作：

```
git add <stuff to keep> && git stash --keep-index && git stash drop 
```

换句话说，把垃圾藏起来，把它和藏起来的东西一起扔掉。

在 git 版本 2.17.1 中测试

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2020-10-18T14:59:39.217

我还没有看到不需要使用的解决方案`git stash`：

你甚至根本不需要使用`git stash`。您可以使用[此处介绍](https://stackoverflow.com/questions/2569459/git-create-a-branch-from-unstaged-uncommitted-changes-on-master)的专用分支来解决此问题（分支很便宜）。

实际上，您可以使用一些可以捆绑到一个 git 别名中的连续命令来单独隔离未执行和暂存的更改：

创建并切换到一个新分支，您将在其中分别提交暂存和未暂存的更改：[请参阅此处](https://stackoverflow.com/a/64413946/14463527)

在任何时候，您都可以`git cherry-pick -e`从已创建的分支提交一次以将其应用到您想要的位置（`-e`以更改其提交消息）。

当你不再需要它时，你可以删除这个“stash 分支”。您可能必须使用`-D`强制删除选项（而不是`-d`普通选项），因为所述分支未合并，并且 git 可能会认为如果您删除它可能会丢失数据。如果您在删除之前没有精心挑选提交，那就是真的：

```
git branch -D separated-stashes 
```

您还可以为您添加别名`~/.gitconfig`以自动执行此行为：

```
git config --global alias.bratisla '!git switch -c separated-stashes; git commit -m "staged changes"; git add -u; git commit -m "unstaged changes"; git switch -' # why this name ? : youtu.be/LpE1bJp8-4w 
```

[在“藏匿”之前“藏匿”](https://i.stack.imgur.com/Ncl0Q.png)
[之后](https://i.stack.imgur.com/zuoha.png)

* * *

* * *

当然，您也可以使用[两个连续的 stash来达到相同的结果](https://stackoverflow.com/a/32951373/14463527)

`git stash (-k|--keep-index)`如其他答案所述，您有一些方法可以与其他命令结合使用仅存储未暂存或仅暂存的更改。

我个人觉得该`-k`选项非常令人困惑，因为它隐藏了所有内容，但将分阶段更改保持在分阶段状态（这解释了为什么“ `--keep-index`”）。而存储某些东西通常会将其移动到存储条目。`-k`未暂存的更改通常被隐藏，但暂存的更改只是复制到同一个隐藏条目。

* * *

第 0 步：您的 git status 中有两件事：一个包含暂存更改的文件，另一个包含未暂存更改的文件。

第 1 步：存储未分级 + 分级更改，但将分级更改保留在索引中：

```
git stash -k -m "all changes" 
```

该`-m "..."`部分是可选的，`git stash -k`实际上是一个别名`git stash push -k`（它不会远程推送任何东西，顺便说一句，别担心），它接受一个`-m`选项来标记您的存储条目以清楚起见（如提交消息或标签，但用于存储条目）。它是 deprecated 的较新版本`git stash save`。

* * *

步骤 1 之二（可选）：

```
git stash 
```

存储分阶段的更改（仍在索引中）。此步骤对于以下内容不是必需的，但表明您可以根据需要仅将暂存的更改放入存储条目中。如果您使用此行，则必须`git stash (pop|apply) && git add -u`在继续步骤 2 之前。

* * *

第2步 ：

```
git commit -m "staged changes" 
```

提交仅包含步骤 0 中的暂存更改，它包含与步骤 1bis 中的存储条目相同的内容。

* * *

第 3 步：

```
git stash (pop|apply) 
```

从第 1 步恢复存储。请注意，此存储条目包含所有内容，但由于您已经提交了分阶段更改，此存储将仅添加来自第 0 步的未分阶段更改。

注意：这里的“restore”并不意味着“git restore”，这是一个不同的命令。

* * *

第4步 ：

```
git add -u 
```

将弹出的存储内容添加到索引

* * *

第 5 步：

```
git commit -m "unstaged changes" 
```

此处的“未暂存”，如第 2 步和第 3 步的注释中的“暂存”，是指第 0 步。您实际上是在暂存并提交第 0 步中的“暂存更改”。

* * *

完毕 ！您现在有两个单独的提交，其中包含来自步骤 0 的（未）暂存更改。您可能希望修改/重新设置它们以进行其他更改或重命名/删除/压缩它们。根据您对存储堆栈 (`pop`或`apply`) 所做的操作，您可能还想要`git stash (drop|clear)`它。你可以看到你存储条目`git stash (list|show)`

* * *

## 回答 #16

> 赞同：-1
> 
> 时间：2020-05-30T12:39:29.837

> **TL;博士**;`git stash-staged`

创建别名后：

```
git config --global alias.stash-staged '!bash -c "git stash -- \$(git diff --staged --name-only)"' 
```

这里`git diff`返回`--staged`文件列表`--name-only`
然后我们将这个列表传递`pathspec`给`git stash`commad。

来自`man git stash`：

```
git stash [--] [<pathspec>...]

<pathspec>...
   The new stash entry records the modified states only for the files
   that match the pathspec. The index entries and working tree
   files are then rolled back to the state in HEAD only for these
   files, too, leaving files that do not match the pathspec intact. 
```****

# php - 我正在做一个 tut，但我无法理解这种语法

> ID：14759752
> 
> 赞同：-3
> 
> 时间：2013-02-07T19:50:17.133
> 
> 标签：php, procedural-programming

我通常编写 oop 代码，这可能是我从未见过这种编码方式的原因。我不明白下面多维数组中的语法，为什么`[$obj->id]['label']`不只是`$obj['id']['label']]`

```
$sql = "SELECT id, label, link_url, parent_id FROM dyn_menu ORDER BY parent_id, id ASC";
$items = mysql_query($sql);
while ($obj = mysql_fetch_object($items)) {
    if ($obj->parent_id == 0) {
        $parent_menu[$obj->id]['label'] = $obj->label;
        $parent_menu[$obj->id]['link'] = $obj->link_url;
    } else {
        $sub_menu[$obj->id]['parent'] = $obj->parent_id;
        $sub_menu[$obj->id]['label'] = $obj->label;
        $sub_menu[$obj->id]['link'] = $obj->link_url;
        if (!isset($parent_menu[$obj->parent_id]['count'])) {
            $parent_menu[$obj->parent_id]['count'] = 0;
        }
        $parent_menu[$obj->parent_id]['count']++;
    }
}
mysql_free_result($items); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-07T19:52:18.147

这是因为[mysql_fetch_object](http://php.net/manual/en/function.mysql-fetch-object.php)将结果行作为对象获取。其他的，例如[mysql_fetch_array](http://www.php.net/manual/en/function.mysql-fetch-array.php)，将结果行作为关联数组获取。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-07T20:40:43.300

简单的说：

```
$parent_menu[$obj->id]['label'] = $obj->label; 
```

相当于：

```
$myID = $obj->id;
$parent_menu[$myID]['label'] = $obj->label; 
```

操作是检索`$obj`的类属性的值`id`并用作`$parent_menu`数组中的索引。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-07T19:53:54.037

`[$obj->id]['label']`甚至`$obj['id']['label']`不接近同一件事。

`$parent_menu[$obj->id]['label']`从带有键的值中获取带有键`'label'`的值。从数组（不是数组）中带有键的值中获取带有键的值。`$obj->id``$parent_menu``$obj['id']['label']``'label'``'id'``$obj`

数组键和属性在 PHP 中不能像在 JavaScript 中那样互换。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-07T19:53:54.020

有不同的值：

`$obj->id`有一个值，它引用一个值。如果您只写“id”，则您正在引用键“id”（作为字符串）

假设您有一个属性 id 设置为 341 的 obj。

这个数组：

```
$sub_menu = array(
    2 => array(
        'name' => 'Blog',
        'label' => 'My Blog'
    ),
    341 => array(
        'name' => 'Downloads',
        'label' => 'Downloads'
    ),
    'id' => array(
        'name' => 'Tutorials',
        'label' => 'Tutorials Awesome!'
    )
); 
```

所以当你调用数组时：

`$sub_menu[$obj->id]['label']`那么您实际上是在调用： `$sub_menu[341]['label']` 这等于“下载”；

如果您打电话 `$sub_menu['id']['label']`，那么您正在使用键“id”调用子菜单。这等于“教程真棒！”

# javascript - 通过 AJAX 加载 AngularJS 控制器后，它不起作用

> ID：14759753
> 
> 赞同：3
> 
> 时间：2013-02-07T19:50:22.670
> 
> 标签：javascript, jquery, angularjs

如何实例化 Controller 以便其方法可以工作？

我正在通过 AJAX a 加载`SettingsController`，但是一旦加载，它的方法就不可调用。

我需要做什么来实例化这段代码？

我看了看`$compile`，但这似乎不起作用。

**使用 twitter bootstrap 加载部分的标准方法**

```
$("#modal").modal({remote: 'partials/users/settings.html'}) 
```

**加载的部分：**

```
%div{'ng-controller' => 'SettingsController'}
   = form_tag '', 'ng-submit' => 'update_settings($event)', :method => :post do |f| 
```

**在我的 SettingsController 中：**

```
$scope.update_settings = ($event) ->
  alert 'hey' 
```

什么都不做。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-07T20:11:05.063

好的，看起来这里的问题是您想将一些 HTML 动态加载到模式中。我不确定您在模态插件中使用的是什么，但您需要执行以下操作：

```
<div id="myModal" ng-include="source"></div> 
```

source 是 $scope 上的一个属性：

```
$scope.source = 'test.html'; 
```

`$includeContentLoaded`然后，您可以在指令中监听事件，并调用模态函数：

```
scope.$on('$includeContentLoaded', function () {
    $('#myModal').modal();
}); 
```

有角手柄拉下你想要包含的部分......然后用你的模态打开它。

# java - ANT：向构建的 jar 添加版本号的最简单方法是什么？

> ID：14759755
> 
> 赞同：4
> 
> 时间：2013-02-07T19:50:32.560
> 
> 标签：java, ant

```
<?xml version="1.0" encoding="UTF-8"?>
<project name="myPlugin" default="all">
<target name="artifact.myPlugin:jar" depends="init.artifacts, compile.module.myPlugin" description="Build &#39;myPlugin:jar&#39; artifact">
    <mkdir dir="${artifact.output.myplugin:jar}" />
    <jar destfile="${temp.jar.path.myPlugin.jar}" duplicate="preserve" filesetmanifest="mergewithoutmain">
        <zipfileset file="${basedir}/META-INF/MANIFEST.MF" prefix="META-INF" />
        <zipfileset dir="${myPlugin.output.dir}" />
    </jar>

<!--How would I add a version number to this that reflects my projects version -->
    <copy file="${temp.jar.path.myPlugin.jar}" tofile="${artifact.output.myPlugin:jar}/plugin.company.jar" />
</target> 
```

人们这样做的典型方式是什么？

示例（从上面提取）

```
<copy file="${temp.jar.path.myPlugin.jar}" tofile="${artifact.output.myPlugin:jar}/plugin.company{version}.jar" /> 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-02-07T20:17:51.710

最简单的解决方案是使用 ANT [buildnumber](http://ant.apache.org/manual/Tasks/buildnumber.html)任务。

```
<project name="myPlugin" default="all">

    <property name="version" value="1.0"/>

    <target...
        <buildnumber/>

        <jar destfile="/path/to/jar/myjar-${version}.${build.number}.jar" ...
            ...
        </jar>
    </target>

</project> 
```

每个构建都会生成一个唯一的版本号：

*   myjar-1.0.0
*   myjar-1.0.1
*   myjar-1.0.2
*   ..

# c# - 在 C# 中迭代 VBA.Collections

> ID：14759761
> 
> 赞同：0
> 
> 时间：2013-02-07T19:51:02.610
> 
> 标签：c#, vba, collections

我正在处理我的 COOP 中的一些代码，并且我有一个类型为`VBA.Collection`. 我正在尝试查看其中的内容，但找不到迭代它的方法。它拥有的唯一方法是

*   添加
*   数数
*   等于
*   获取枚举器
*   获取哈希码
*   获取类型
*   物品
*   消除
*   字符串

我尝试使用 Item 方法，但它具有`ref Object index`作为参数，也不能用作数组。

对此的任何帮助都会很棒。谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-07T19:52:50.263

的全部目的`GetEnumerator`是允许类型的迭代。如果要迭代它，请使用它。

例如，您可以这样做：

```
foreach(object item in collection)
{
    //use item here
} 
```

# css - 基线上的页脚

> ID：14759762
> 
> 赞同：0
> 
> 时间：2013-02-07T19:51:03.257
> 
> 标签：css, zurb-foundation

我无法弄清楚为什么页脚上的黑条没有出现在窗口的基线上。我不希望它在滚动时“固定”。就在绝对底部

```
html { 
    -webkit-background-size: cover;
    -moz-background-size: cover;
    -o-background-size: cover;
    background-size: cover;
    position: relative;
}

body {
    padding-top: 15px; /* 60px to make the container go all the way to the bottom of the topbar */
    background: #f7f7f7 repeat-x url(<%=image_path('background.png')%>) top left;
    font-family: Helvetica, Arial, sans-serif;
    color: #323232;
}

footer{
    margin: 0px;
    padding: 10px;
    background: black;
    color: white;
    position: absolute;
    left:0;
    right: 0;
    bottom: 0;

} 
```

![在此处输入图像描述](../Images/5efa9adf3bfbdaf17f9bbb26deda2d93.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-07T19:55:17.343

当我希望页脚“粘性”时，我总是使用这个常见问题的[非常可靠的解决方案。](http://ryanfait.com/sticky-footer/)

# osgi - Felix 将 OSGI Bundle 列为活动但 Gogo Shell 命令不可访问（依赖相关）

> ID：14759770
> 
> 赞同：2
> 
> 时间：2013-02-07T19:51:35.377
> 
> 标签：osgi, apache-felix, ipojo

此基本代码成功地使命令 scopeA:test 在 shell 中可访问：

```
package com.A;

import org.apache.felix.ipojo.annotations.Component;
import org.apache.felix.ipojo.annotations.Instantiate;
import org.apache.felix.ipojo.annotations.Provides;
import org.apache.felix.ipojo.annotations.Requires;
import org.apache.felix.ipojo.annotations.ServiceProperty;
import org.apache.felix.service.command.Descriptor;

@Component(immediate = true)
@Instantiate
@Provides(specifications = Commands.class)
public final class Commands {

    @ServiceProperty(name = "osgi.command.scope", value = "scopeA")
    String scope;

    @ServiceProperty(name = "osgi.command.function", value = "{}")
    String[] function = new String[] {
            "test"
    };

    @Descriptor("Example")
    public void test() {
        System.out.println("hello");
    }
} 
```

但是，如果我添加一个依赖于另一个 OSGI 组件的构造函数，则该命令将不再可访问，并且“帮助”不会列出它。然而，捆绑包仍然可以加载到活动状态。

```
package com.A;

import org.apache.felix.ipojo.annotations.Component;
import org.apache.felix.ipojo.annotations.Instantiate;
import org.apache.felix.ipojo.annotations.Provides;
import org.apache.felix.ipojo.annotations.Requires;
import org.apache.felix.ipojo.annotations.ServiceProperty;
import org.apache.felix.service.command.Descriptor;

import com.B;

@Component(immediate = true)
@Instantiate
@Provides(specifications = Commands.class)
public final class Commands {

    public Commands(@Requires B b) {
    }

    @ServiceProperty(name = "osgi.command.scope", value = "scopeA")
    String scope;

    @ServiceProperty(name = "osgi.command.function", value = "{}")
    String[] function = new String[] {
            "test"
    };

    @Descriptor("Example")
    public void test() {
        System.out.println("hello");
    }
} 
```

B的内容很简单：

```
import org.apache.felix.ipojo.annotations.Component;
import org.apache.felix.ipojo.annotations.Instantiate;
import org.apache.felix.ipojo.annotations.Provides;

@Component(immediate = true)
@Instantiate
@Provides
final class B {
} 
```

为什么不再列出该命令的任何想法？查找有关状态的更多信息以便我可以更好地调试的提示？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-08T01:06:24.930

问题是命令需要 @Requires 在字段上而不是在构造函数中。

```
@Requires
B b; 
```

构造函数也必须被删除。

这是因为 gogo 有一种特殊的调用组件的方法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2020-02-03T13:43:06.017

对我来说，这也需要改变

```
@ServiceProperty(name = "osgi.command.function", value = "{}")
String[] function = new String[] {
    "test"
}; 
```

至

```
@ServiceProperty(name = "osgi.command.function", value = "{test}")
String[] function; 
```

# java - 在 LayeredPane 中保存两个 BufferedImage

> ID：14759771
> 
> 赞同：0
> 
> 时间：2013-02-07T19:51:40.080
> 
> 标签：java, image, coordinates, bufferedimage, jlayeredpane

我正在使用一个包含两个图像的 LayeredPane，每层一个。我一直在研究一种获取图像位置的方法（基于图像所在的标签位置），然后保存底部图像（layeredPane 中的下部图像）以及顶部图像（如果它完全覆盖底部）图像（可能只是图像的一部分），但是我遇到了一些麻烦，我有点不确定如何让它正常工作。

我已经为此工作了很长一段时间，所以对我现有代码的任何帮助或关于我应该如何以另一种方式处理这个问题的想法对我来说都是一个很大的帮助。

提前致谢。

```
public void saveImageLayering(BufferedImage topImg,BufferedImage bottomImg, JLabel topLabel, JLabel bottomLabel) {
    int width = bottomImg.getWidth();
    int height = bottomImg.getHeight();
    Point bottomPoint = new Point();
    Point topPoint = new Point();

    bottomPoint = bottomLabel.getLocation();
    topPoint = topLabel.getLocation();  

    System.out.println("image x coordinate " + bottomPoint.x);
    System.out.println("image y coordinate " + bottomPoint.y);  

    //arrays to store the bottom image
    int bottomRedImgArray[][] = new int[width][height];
    int bottomGreenImgArray[][] = new int[width][height];
    int bottomBlueImgArray[][] = new int[width][height];

    //arrays to store the top image
    int topRedImgArray[][] = new int[width][height];
    int topGreenImgArray[][] = new int[width][height];
    int topBlueImgArray[][] = new int[width][height];

    //loop through the bottom image and get all pixels rgb values
    for(int i = bottomPoint.x; i < width; i++){
        for(int j = bottomPoint.y; j < height; j++){
            //set pixel equal to the RGB value of the pixel being looked at
            pixel = new Color(bottomImg.getRGB(i, j));
            //contain the RGB values in the respective RGB arrays
            bottomRedImgArray[i][j] = pixel.getRed();
            bottomGreenImgArray[i][j] = pixel.getGreen();
            bottomBlueImgArray[i][j] = pixel.getBlue();
        }   
    }
    //create new image the same size as old
    BufferedImage newBottomImage = new BufferedImage(width, height, BufferedImage.TYPE_INT_RGB);

    //set values within the 2d array to the new image
    for (int x1 = 0; x1 < width; x1++){
        for (int y1 = 0; y1 < height; y1++){
            //putting values back into buffered image
            int newPixel = (int) bottomRedImgArray[x1][y1];
            newPixel = (newPixel << 8) + (int) bottomGreenImgArray[x1][y1];
            newPixel = (newPixel << 8) + (int) bottomBlueImgArray[x1][y1];
            newBottomImage.setRGB(x1, y1, newPixel);
        }
    }

    //create rectangle around bottom image to check if coordinates of top in inside and save only the ones that are
    Rectangle rec = new Rectangle(bottomPoint.x, bottomPoint.y, bottomImg.getWidth(), bottomImg.getHeight());

    //loop through the top image and get all pixels rgb values 
    for(int i = bottomPoint.x; i < bottomImg.getWidth(); i++){
        for(int j = bottomPoint.y; j < bottomImg.getHeight(); j++){

            //if top image is inside lower image then getRGB values
            if (rec.contains(topPoint)) { //___________________________________________________________doesnt contain any..
                if (firstPointFound  == true) {
                    //set pixel equal to the RGB value of the pixel being looked at
                    pixel = new Color(topImg.getRGB(i, j));
                    //contain the RGB values in the respective RGB arrays
                    topRedImgArray[i][j] = pixel.getRed();
                    topGreenImgArray[i][j] = pixel.getGreen();
                    topBlueImgArray[i][j] = pixel.getBlue();
                } else {
                    firstPoint = new Point(i, j);
                    firstPointFound = true;
                }
            }
        }
    }
    //create new image the same size as old
    BufferedImage newTopImage = new BufferedImage(width, height, BufferedImage.TYPE_INT_RGB);

    //set values within the 2d array to the new image
    for (int x1 = 0; x1 < topImg.getWidth(); x1++){
        for (int y1 = 0; y1 < topImg.getHeight(); y1++){
            //putting values back into buffered image
            int newPixel = (int) topRedImgArray[x1][y1];
            newPixel = (newPixel << 8) + (int) topGreenImgArray[x1][y1];
            newPixel = (newPixel << 8) + (int) topBlueImgArray[x1][y1];
            newTopImage.setRGB(x1, y1, newPixel);
        }
    }

    BufferedImage newImage = new BufferedImage(width, height, BufferedImage.TYPE_INT_ARGB); 

    //uses the Graphics.drawImage() to place them on top of each other
    Graphics g = newImage.getGraphics();
    g.drawImage(newBottomImage, bottomPoint.x, bottomPoint.y, null);
    g.drawImage(newTopImage, firstPoint.x, firstPoint.y, null);

    try {
        //then save as image once all in correct order
        File outputfile = new File("saved_Layered_Image.png");
        ImageIO.write(newImage, "png", outputfile);
        JOptionPane.showMessageDialog(null, "New image saved successfully");
    } catch (IOException e) {
        e.printStackTrace();
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-08T03:29:55.403

我不太确定你为什么要搞乱像素，但是，这个想法相对简单

基本上，您想创建第三个“合并”图像，其大小与`bottomImage`. 从那里，您只需要将0x0绘制`bottomImage`到图像上。`merged`

然后，您需要计算 离 的位置的`topImage`距离`bottomImage`并在该点进行绘制。

```
BufferedImage merged = new BufferedImage(bottomImg.getWidth(), bottomImg.getHeight(), BufferedImage.TYPE_INT_ARGB);
Graphics2D g2d = master.createGraphics();
g2d.drawImage(bottomImg, 0, 0, this);

int x = topPoint .x - bottomPoint .x;
int y = topPoint .y - bottomPoint .y;

g2d.drawImage(topImg, x, y, this);
g2d.dispose(); 
```

使用这个基本想法，我能够制作这些......

![在此处输入图像描述](../Images/a62b68380108d3737db0b729bd798dc5.png)![在此处输入图像描述](../Images/5d28e07534868105b259313a268a56fa.png)

# internationalization - 国际化标题/元标签好还是不好？

> ID：14759774
> 
> 赞同：1
> 
> 时间：2013-02-07T19:51:47.053
> 
> 标签：internationalization, seo

如果我在同一个确切的 url 下有相同标题/元标记的英文和中文版本，会有问题吗？我检测用户为浏览器设置的语言（通过 http 标头“accept-language”字段）并根据语言设置更改标题/元标记。我从中国获得了很大比例的流量，我觉得这对这些用户来说是一种更好的本地化用户体验，但我不知道谷歌会如何看待这一点。我的直觉告诉我，这对 SEO 不利。

百度，一个主要的中文搜索引擎，确实会选择我翻译的标签，但是对于其他美国网站，它不会将他们的英文标题/元标签翻译成中文。我认为中国用户不太可能点击这些。

在这一点上，为其他国家/地区创建子域和/或单独的域不是一种选择。话虽如此，我的标题/元标记是否应该只有一种语言（英语）以避免任何搜索引擎问题？

感谢您提供的任何建议/智慧。真的希望能清楚地了解最佳实践。

谢谢大家！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-07T20:42:01.963

是的，这可能是一个问题。搜索引擎会看到混合语言内容。您不是在描述如何“根据用户浏览器语言检测和更改标题/元标记”，但您可能是在客户端执行此操作*并*使用“浏览器语言”，无论它的详细含义如何（它确实不指定用户的首选语言）。

要获得更有针对性的答案，请使用 URL 提出更真实的问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-12T13:01:38.647

我认为在相同的元标记中使用英文和中文时没有问题。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-10T23:50:57.563

如果你想从搜索引擎中获得英文和中文的搜索流量，你应该有*两个*url 而不是一个。

当 googlebot 抓取页面时，它甚至不发送“Accept-Language”标头。您必须将其发送为您的默认语言。当只有一个 url 时，您无法将您的第二语言编入索引。您不会在多种语言的搜索引擎中排名。

为了获得最佳 SEO，请为不同的语言使用单独的顶级域、子域或文件夹。

* * *

*   [http://example.de/](http://example.de/)
*   [http://example.es/](http://example.es/)
*   [http://example.com/](http://example.com/)

* * *

*   [http://de.example.com/](http://de.example.com/)
*   [http://es.example.com/](http://es.example.com/)
*   [http://www.example.com/](http://www.example.com/)

* * *

*   [http://example.com/de/](http://example.com/de/)
*   [http://example.com/es/](http://example.com/es/)
*   [http://example.com/en/](http://example.com/en/)

# php - 使用 XSLT 和 PHP 转换 XML 结构另一个 XML

> ID：14759775
> 
> 赞同：1
> 
> 时间：2013-02-07T19:51:52.637
> 
> 标签：php, xml, xslt

我将通过从那里获取一些数据来[将此](http://dl.dropbox.com/u/72519118/response.xml)xml 文件的结构转换为另一个（具有新元素名称），即：

1.  所有元素的价值；
2.  all 的值和元素中的元素；

我刚开始玩 XSLT 并且知识薄弱，所以不要严格判断我。我的**transform.xsl**模板是（不打印 xml 元素名称）：

```
<?xml version="1.0" encoding="UTF-8"?>
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
    <xsl:output method="xml" />
    <xsl:template match="/">
        <xsl:apply-templates select="/RESPONSE/MULTIPLE/SINGLE/KEY" />
    </xsl:template>

    <!-- transformation to another xml file -->
    <xsl:template match="/MULTIPLE">
    <course>
    <xsl:for-each select="SINGLE">
        <topic>
            <!-- Updated -->
            <chapter><xsl:value-of select="KEY[@name='name']/VALUE" /></chapter>
            <xsl:for-each select="KEY[@name='modules']/MULTIPLE/SINGLE">
                <title><xsl:value-of select="KEY[@name='name']/VALUE" /></title>
                <content><xsl:value-of select="KEY[@name='description']/VALUE" /></content>
            </xsl:for-each>
            <!-- /Updated -->
        </topic>
    </xsl:for-each>
    </course>
</xsl:template> 
```

预期结构是[更新]：

```
<?xml version="1.0" encoding="UTF-8"?>
<course>
    <topic>
        <chapter>Chapter Name 1</chapter>
        <title>Title Name 1</title>
        <content>Content 1</content>
    </topic>
    <!-- Updated -->
    <topic>
        <chapter>Chapter Name 1</chapter>    <!-- print for each <title> and <content> -->
        <title>Title Name 2</title>
        <content>Content 2</content>
    </topic>
    <topic>
        <chapter>Chapter Name n</chapter>
        <title>Title Name n</title>
        <content>Content n</content>
    </topic>
    <!-- Updated -->
    ...
</course> 
```

和**php**程序：

```
$xml = new DOMDocument;
$xml->load("http://dl.dropbox.com/u/72519118/response.xml");

$xsl = new DOMDocument;
$xsl->load("transform.xsl");

// Configure the transformer
$proc = new XSLTProcessor;
$proc->importStyleSheet($xsl);

echo $proc->transformToXML($xml); 
```

任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-07T20:23:20.797

感谢您提出的问题。你在正确的轨道上，但有几个问题：

由于您想将模板应用于顶级倍数，因此您的第一个`apply-templates`应如下所示：

```
<xsl:apply-templates select="/RESPONSE/MULTIPLE" /> 
```

由于`MULTIPLE`不是根元素，如果匹配元素值以斜杠开头，您的第二个模板将不匹配任何内容。这是你应该使用的：

```
<xsl:template match="MULTIPLE"> 
```

当您想将某些内容（属性、元素等）与字符串值进行比较时，您需要在值周围加上引号：

```
<xsl:value-of select="KEY[@name = 'name']/VALUE" /> 
```

修复这些元素后，您将获得以下 XSLT：

```
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
  <xsl:output method="xml" />
  <xsl:template match="/">
    <xsl:apply-templates select="/RESPONSE/MULTIPLE" />
  </xsl:template>

  <!-- transformation to another xml file -->
  <xsl:template match="MULTIPLE">
    <course>
      <xsl:for-each select="SINGLE">
        <topic>
          <chapter>
            <xsl:value-of select="KEY[@name = 'name']/VALUE" />
          </chapter>
          <title>
            <xsl:value-of 
                select="KEY[@name= 'modules']/MULTIPLE/SINGLE/KEY
                                       [@name = 'name']/VALUE" />
          </title>
          <content>
            <xsl:value-of 
                select="KEY[@name= 'modules']/MULTIPLE/SINGLE/KEY
                                 [@name ='description']/VALUE" />
          </content>
        </topic>
      </xsl:for-each>
    </course>
  </xsl:template>
</xsl:stylesheet> 
```

这是满足您明确要求的更新版本：

```
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
  <xsl:output method="xml" />
  <xsl:template match="/">
    <course>
      <xsl:apply-templates 
         select="/RESPONSE/MULTIPLE/SINGLE/KEY[@name = 'modules']/MULTIPLE/SINGLE" />
    </course>
  </xsl:template>

  <xsl:template match="SINGLE">
    <topic>
      <chapter>
        <xsl:value-of select="../../../KEY[@name = 'name']/VALUE" />
      </chapter>
      <title>
        <xsl:value-of select="KEY[@name = 'name']/VALUE" />
      </title>
      <content>
        <xsl:value-of select="KEY[@name ='description']/VALUE" />
      </content>
    </topic>
  </xsl:template>
</xsl:stylesheet> 
```

请注意，这只是将模板应用于所有二级`<SINGLE>`s。为了获取章节名称，它会向后移动 XML 树以从父节点获取该值。

在源 XML 上运行时的输出是：

```
<course>
  <topic>
    <chapter>General</chapter>
    <title>News forum</title>
    <content></content>
  </topic>
  <topic>
    <chapter>ANATOMIE</chapter>
    <title>1.1 Die Haut</title>
    <content>
      &lt;div class="no-overflow"&gt;&lt;p&gt;&lt;span class="nolink"&gt;&lt;img src="http://localhost/pluginfile.php/22/mod_page/intro/die_haut.png" width="auto" style="border: 1px       [SNIP]
    </content>
  </topic>
  <topic>
    <chapter>ANATOMIE</chapter>
    <title>1.2 Der Schädel Page</title>
    <content>
      &lt;div class="no-overflow"&gt;&lt;h3&gt;1.2 Der Schädel&lt;/h3&gt;
      [SNIP]
    </content>
  </topic>
  <topic>
    <chapter>ANATOMIE</chapter>
    <title>1.6 Die Regelkreise</title>
    <content>
      &lt;div class="no-overflow"&gt;&lt;h3&gt;1.6 Die Regelkreise&lt;/h3&gt;
      [SNIP]
    </content>
  </topic>
  <topic>
    <chapter>ANATOMIE</chapter>
    <title>Media</title>
    <content></content>
  </topic>
  <topic>
    <chapter>NOTFÄLLE</chapter>
    <title>2.1 Neurologische Notfälle</title>
    <content></content>
  </topic>
  <topic>
    <chapter>NOTFÄLLE</chapter>
    <title>2.5 Krampfanfälle</title>
    <content></content>
  </topic>
  <topic>
    <chapter>NOTFÄLLE</chapter>
    <title>2.9 Pulmonale Notfälle</title>
    <content></content>
  </topic>
  <topic>
    <chapter>STÖRUNGEN</chapter>
    <title>3.1 Störungen der Lebensfunktionen bei Erwachsenen (ab der Pubertät)</title>
    <content></content>
  </topic>
  <topic>
    <chapter>STÖRUNGEN</chapter>
    <title>3.16 Störungen der Lebensfunktionen bei Säuglingen (bis ein Jahr) und Kindern (bis zur Pubertät)</title>
    <content></content>
  </topic>
  <topic>
    <chapter>STÖRUNGEN</chapter>
    <title>3.25 Starke Blutung</title>
    <content></content>
  </topic>
</course> 
```

# solr - 使用 Solr 查询 HBase

> ID：14759778
> 
> 赞同：1
> 
> 时间：2013-02-07T19:52:01.230
> 
> 标签：solr, hbase, data-warehouse

我有一个数据仓库问题，需要查询一个大型数据集。为了这个例子，假设一个典型的州会有 3000 万用户，每个用户都有活动统计信息。理想情况下，我可以购买数据仓库工具（Vertica、Infobright 等），但这不在卡片或预算之内。

现在我正在考虑使用 Solr 来查询 HBase。虽然我相信 HBase 可以扩展以满足需求，但我担心 Solr。它作为搜索引擎进行了优化，即结果的第一页在最后一页之前返回，并且不支持诸如数据库游标之类的东西。到目前为止的测试表明，从 Solr 获得大量结果集的速度比我希望的要慢。例如，比较在 Infobright 社区版中检索一半可用用户（最终返回 500 mb 数据）的查询在一分钟内完成，而 Solr 则需要 12 分钟。

除了 Solr 之外，还有什么更适合查询这些数据的吗？是否有任何有助于批量数据输入和输出的优化？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-05-20T18:26:49.640

我知道这有点晚了，但是...

根据您的搜索要求，Solr 可能是一个不错的选择。请记住，您很可能不需要索引HBase 中的*所有内容*。您可以选择某些领域吗？部分文字？如果您已经将这些内容存储在 HBase 中，那么您肯定不需要将这些内容存储在 Solr 中。

Solr 是一个出色的二级索引系统，可以放在 HBase 之上，如果您需要，Solr 还具有一些出色的文本分析功能。

您还应该看看 ElasticSearch，它是 Solr 的主要竞争对手之一。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-02-07T21:35:36.513

看看[SolBase](https://github.com/Photobucket/Solbase)和[Lily——](http://www.lilyproject.org/lily/index.html)两个结合 Solr 和 HBase 后端的实现

# c# - C#如何将带有IList的对象转换为IList? I have an object which implements IList interface, I want to cast it to IList or List, I tried IList a=( 问问题 问问题 2013-02-07T19:52:12.297 15856 次 This question shows research effort; it is useful and clear 4 This question does not show any research effort; it is unclear or not useful Bookmark this question. Show activity on this post. I have an object which implements IList interface, I want to cast it to IList or List, I tried IList a=(IList)b; List a=(IList)b; IList a=(List)b; List a=(List)b; These are not working. Please help, thanks. To clarify: b is an object pass as parameter from outside. It implements IList interface. For example, public class a { string name; List names; } public void func(object item) { object dataLeaves = data.GetType().GetProperty("names").GetValue(dataInput, null); if (dataLeaves != null && dataLeaves.GetType().GetInterfaces().Any(t =>t.IsGenericType && t.GetGenericTypeDefinition() == typeof(IList<>))) { List a=(List) dataLeaves; //Need to convert the dataLeaves to list or IList } } It's because mysql_fetch_object fetches a result row as an object. Others, such as mysql_fetch_array, fetch a result row as an associative array. c# 4 3 回答 3 This answer is useful 16 如果现有对象未实现该接口，则无法将其转换为，但您可以使用 LINQ 轻松IList构建新对象： List List = b.Cast().ToList(); 于 2013-02-07T19:53:38.623 回答 This answer is useful 3 找到了答案： IEnumerable a = dataLeaves as IEnumerable; 于 2013-02-07T20:36:40.803 回答 This answer is useful 0 一个IList根本不是一个IList。对象实际上实现这两个接口的可能性极小，因此强制转换永远不会成功。您需要创建一个新的列表对象来实现IList： IList a= b.OfType.ToList(); 于 2013-02-07T19:54:52.270 回答 Related 1 java - 为什么我在 Java 中收到 EOF 异常？ 1 php - 排序和拆分多维数组 2 verilog - 带分频器的计数器不递增 2 windows-8 - Windows8 像在天气应用程序中一样滚动 2 css - Chrome，从右到左的问题 2 python - Python 使用“numpy.ndarray”创建字典 1 php - javascript在php中不起作用 1 jquery - 使用 MVC3 Razor 在 Jquery 中应用图像扩展验证 1 php - 从动态下拉列表将变量传递给 PHP 1 mysql - INFORMATION_SCHEMA.COLUMNS ：并且必须是主键：Mysql 查询 Reference php × 1429865 c/c++ × 756500 nginx × 49975 mongodb × 159057 mybatis × 3233 anaconda × 13410 pycharm × 14671 python × 1902243 vscode × 56040 docker × 110988 github × 49000 flask × 49129 ffmpeg × 24037 jmeter × 16910 matplotlib × 63493 bootstrap × 54641

> ID：14759783
> 
> 赞同：4
> 
> 时间：
> 
> 标签：c#

I have an object which implements `IList` interface, I want to cast it to `IList<object>` or `List<object>`, I tried

```
IList<object> a=(IList<object>)b;
List<object> a=(IList<object>)b;
IList<object> a=(List<object>)b;
List<object> a=(List<object>)b; 
```

These are not working. Please help, thanks. To clarify:

b is an object pass as parameter from outside. It implements IList interface. For example,

```
public class a
{
  string name;
  List<a> names;
}
public void func(object item)
{
  object dataLeaves = data.GetType().GetProperty("names").GetValue(dataInput, null);
  if (dataLeaves != null && dataLeaves.GetType().GetInterfaces().Any(t =>t.IsGenericType && t.GetGenericTypeDefinition() == typeof(IList<>)))
  {
    List<object> a=(List<object>) dataLeaves; //Need to convert the dataLeaves to list or IList
  }
} 
```

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2013-02-07T19:53:38.623

*如果现有*对象未实现该接口，则无法将其转换为，但您可以使用 LINQ 轻松`IList<object>`构建*新对象：* `List<object>`

```
List<object> = b.Cast<object>().ToList(); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-07T20:36:40.803

找到了答案：

```
IEnumerable<object> a = dataLeaves as IEnumerable<object>; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-07T19:54:52.270

一个`IList`根本*不是*一个`IList<object>`。对象实际上实现这两个接口的可能性极小，因此强制转换永远不会成功。您需要创建一个新的列表对象来实现`IList<object>`：

```
IList<object> a= b.OfType<object>.ToList(); 
```

# javascript - 如何将控制器操作中的操作参数检索到 Knockout VM 中

> ID：14759785
> 
> 赞同：0
> 
> 时间：2013-02-07T19:52:21.643
> 
> 标签：javascript, asp.net-mvc, knockout.js

这是我的控制器动作...

```
 // GET: ex: /Question/Details/5?project=1
    public ActionResult Details(int? project, int? questionId)
    {
      ...
    } 
```

这是我的淘汰赛虚拟机：

```
 // Get some other info about question
    $(document).ready(function () {
            getSomeOtherInfo(<need to pass question id here>, <need to pass project id here>);
    }); 
```

任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-07T20:05:40.553

如果您对详细信息使用强类型 ViewModel，则可以将这两个属性添加到视图模型中，然后在视图中将值提供给 JavaScript：

```
$(document).ready(function () {
    getSomeOtherInfo(@(Model.project), @(Model.questionId));
}); 
```

如果你没有使用强类型的 ViewModel，你可以使用 ViewBag

# unit-testing - 是否可以更改对象的 Rspec 输出？

> ID：14759798
> 
> 赞同：1
> 
> 时间：2013-02-07T19:53:05.397
> 
> 标签：unit-testing, rspec, rspec-rails

鉴于以下规格：

```
describe Person
  describe "scopes and class methods" do
    let!(:sixty_older)     { FactoryGirl.create :person, birthdate: 60.years.ago }

    describe ".senior" do
      subject { Person.senior }
      it { should include(sixty_older) }
    end
  end
end 
```

它在 CLI 中使用格式 --documentation 的输出：

```
Person
  scopes and class methods
    .senior
      should include #<Person person_id: 466, gender: "M", birthdate: "1953-02-07 19:44:22", birthdate_estimated: 0, dead: 0, death_date: nil, cause_of_death: nil, creator: 0, date_created: "0002-11-30 00:00:00", changed_by: nil, date_changed: nil, voided: 0, voided_by: nil, date_voided: nil, void_reason: nil, uuid: "key_4"> 
```

我可以将其更改`#<Person person_id: ....>`为其他内容吗？

比如说，只显示 person_id、birthdate 和 uuid？

此外，如果它可以在每个测试的基础上进行定制，而不是在类级别的变化上。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-07T20:47:36.683

您可以向大多数 rspec 匹配器传递自定义失败消息，如下所示：

```
describe ".senior" do
  subject { Person.senior }
  it { should include(sixty_older), "should include #{person.person_id}:#{person.uuid}" }
end 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-05-16T09:19:06.860

尝试在每个示例或上下文或您喜欢的任何内容之前覆盖模型类的**检查实例方法。**我同样需要使用 Rspec 测试 ActiveRecord 模型并且它有效。

# php - 为什么 PHP 单元不工作，除非我提供一个文件？

> ID：14759799
> 
> 赞同：0
> 
> 时间：2013-02-07T19:53:12.623
> 
> 标签：php, unit-testing, phpunit

我想知道我必须在我的测试目录中做什么才能停止使用 phpunit SetUp.php 并且只执行 phpunit 并让它运行该目录中的所有测试？

我的目录是：

*   测试
    *   设置.php

课程是：

```
class SetUp extends  PHPUnit_Framework_TestCase {

    protected $_wp_query;

    public function setUp(){        
        parent::setUp();

        global $wp_query;

        if($this->_wp_query == null){
            $this->_wp_query = $wp_query;
        }
    }

    public function testIsArray(){
        $this->assertTrue(is_array($this->_wp_query));
    }
} 
```

想法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-07T19:54:24.560

将文件重命名为 SetUpTest.php 并将类重命名为 SetUpTest

PHPUnit 仅自动拾取以单词 Test 结尾的类

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-08T14:56:36.513

将目录提供给 phpunit，i。E.`phpunit .tests/`或者只是`phpunit .`如果您当前的工作目录是 test/

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-08T15:35:47.267

我还使用默认的 XML 文件名，并在其中设置所有参数。我不使用 SetupTest.php 作为名称，而是使用 SetUp.php.test，以便我们可以轻松地剥离它们以进行发布。

默认的 phpunit.xml.dist 将被处理，这可能包含您所有的配置设置，以及目录、文件、输出设置。

# c - 程序未退出

> ID：14759802
> 
> 赞同：-3
> 
> 时间：2013-02-07T19:53:14.600
> 
> 标签：c, exit

当我的程序在 main 中返回 0 时，程序退出，但控制不会返回到命令行。我什至尝试过exit（），但无济于事。有什么建议么

```
int main (int argc, char* argv[])
{

    char name[100];
    char reg[200];
    char replace[200];

    if(argc==3){
        strcpy(reg, ".*");
        strcat(reg, argv[1]);
        strcat(reg, ".*");
    }
    else if(argc==4){

        strcpy(reg, "\\(\\(.*");
        strcat(reg, argv[3]);
        strcat(reg, ".*");
        strcat(reg, argv[1]);
        strcat(reg, ".*\\)\\|\\(.*");
      strcat(reg, argv[1]);
      strcat(reg, ".*");
      strcat(reg, argv[3]);
      strcat(reg, ".*\\)\\)");

        printf("\n%s\n", reg);
//        exit(1);
    }
    printf("\n%s\n", reg);

    strcpy(name, argv[1]);
    strcpy(replace, argv[2]);
    printf("\n%s\n", name);
//  puts(realpath("./b/test2",NULL));
    int reti;
    char msgbuf[100];
    regex_t regex;
   /* Compile regular expression */
   reti = regcomp(&regex, reg, 0);
   if( reti ){ fprintf(stderr, "Could not compile regex\n"); exit(1); }

    list_dir (".", regex, name, replace);

    char line[BUFSIZ];
    FILE *fp2=fopen("source.dat","r");

    if(fp2==NULL)
        printf("Problm opening: source.dat");

    FILE *fp3=fopen("result.dat", "r");
    if(fp3==NULL)
        printf("Problm opening: result.dat");
    char line2[1000];
    int len;

    while( (fgets(line2, BUFSIZ, fp2) != NULL) && (fgets(line, BUFSIZ, fp3) != NULL)) {
        len=strlen(line);
        if( line[len-1] == '\n' )
            line[len-1] = '\0';
        len=strlen(line2);
        if( line2[len-1] == '\n' )
            line2[len-1] = '\0';

        rename(line, line2);
    }

    close(fp2);
    free(fp2);
    close(fp3);
    free(fp3);
    remove("source.dat");
    remove("result.dat");
    regfree(&regex);
   return 0;
} 
```

我的程序按照我的意图执行，但是当它完成 while 循环并释放所有内容时，控制不会在不按 ctr-C 的情况下返回命令行。还是不知道为什么。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-07T20:26:05.267

好吧，没有完整的程序很难说。根据提供的代码，跳出的最明显的错误是文件句柄的使用。API 的工作方式如下：通过调用 fopen() 分配 FILE*，通过调用 fclose() 释放它。相反，您在 FILE* 上调用 close()，然后 (!) 将其传递给 free()。

我不确定您使用的确切语言/版本，但如果您要求进行更多错误检查，您的编译器可能会帮助您找到这个问题。例如，带有 -Wall 的 gcc 会警告它必须对 close()、free() 等使用隐式声明。在添加正确的头文件后（因此它可以看到您正在使用的函数的原型声明） ，然后它会说：

```
 warning: passing arg 1 of `close' makes integer from pointer without a cast 
```

给你一个线索，你正在错误地使用 close()。

# ajax - Posting Image Data From Ajax to WebAPI

> ID：14759804
> 
> 赞同：3
> 
> 时间：2013-02-07T19:53:19.293
> 
> 标签：ajax, asp.net-web-api

I am trying to pass a image dat to a web API method using example code I found on here [http://www.asp.net/web-api/overview/working-with-http/sending-html-form-data,-part-2](http://www.asp.net/web-api/overview/working-with-http/sending-html-form-data,-part-2) and I am finding that MultipartFormDataStreamProvider.FileData is always empty. Why might this be? Also, is this the right approach to be taking? Are there options? I am trying to pass only a single image.

The Call

```
var t = new FormData();
t.append('file-', file.id);
t.append('filename', file.name);
t.append('Size', file.size);

$.ajax({
    url: sf.getServiceRoot('mySite') + "upload/PostFormData",
    type: "POST",
    data: t,
    contentType: false,
    processData: false,
    beforeSend: sf.setModuleHeaders
}).done(function (response, status) {
    alert(response);
}).fail(function (xhr, result, status) {
    alert("error: " + result);
}); 
```

});

```
public async Task<HttpResponseMessage> PostFormData()
    {
        // Check if the request contains multipart/form-data.
        if (!Request.Content.IsMimeMultipartContent())
        {
            throw new HttpResponseException(HttpStatusCode.UnsupportedMediaType);
        }

        string root = HttpContext.Current.Server.MapPath("~/App_Data");
        var provider = new MultipartFormDataStreamProvider(root);

        try
        {
            // Read the form data.
            await Request.Content.ReadAsMultipartAsync(provider);

            // This illustrates how to get the file names.
            foreach (MultipartFileData file in provider.FileData)
            {
                Trace.WriteLine(file.Headers.ContentDisposition.FileName);
                Trace.WriteLine("Server file path: " + file.LocalFileName);
            }
            return Request.CreateResponse(HttpStatusCode.OK);
        }
        catch (System.Exception e)
        {
            return Request.CreateErrorResponse(HttpStatusCode.InternalServerError, e);
        }
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-04-17T08:28:28.700

通过表单发布时，我可以正确获取 fileData，

如示例中的[@WebAPI 上传错误。MIME 多部分流的预期结束。MIME 多部分消息不完整](https://stackoverflow.com/questions/19619100/webapi-upload-error-expected-end-of-mime-multipart-stream-mime-multipart-messa?rq=1)

祝你好运，

# css - 错误的网页水平滚动弄乱了布局

> ID：14759809
> 
> 赞同：0
> 
> 时间：2013-02-07T19:53:25.067
> 
> 标签：css, layout, scroll, width, horizontal-scrolling

对于以下站点：[http://mountainfoodstorage.com](http://mountainfoodstorage.com)，当窗口最大化（大于约 1520 像素）时，页面正确显示。但是如果窗口比大约 1520 像素薄，就会出现一个水平滚动条，如果我向右滚动，我的布局就会出现混乱（应该跨越整个宽度的 div 被切断）。我的网页内容只有大约 1000 像素宽，所以水平滚动条太早了大约 500 像素。我检查了页面的元素，看看是否有任何东西将宽度增加到 1520 像素左右，但我找不到任何这样做的东西。有任何想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-07T20:17:28.703

它是`#main-menu`, width + left = 1250 而不是您的网站宽度。删除`left`样式并添加`float:right`到`ul`

```
#main-menu {
    position:relative;
    left:265px; /* remove this */
    width:985px;
    margin:0 auto 0 auto;
}

#main-menu ul {
    margin-left:0;
    float: right; /* add this */
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-07T20:12:05.280

添加`html, body {overflow-x: hidden;}`?

# iphone - 尝试支持 3.5 和 4 英寸屏幕的 iPhone 时出现的问题

> ID：14759811
> 
> 赞同：2
> 
> 时间：2013-02-07T19:53:30.840
> 
> 标签：iphone, ios, cocoa-touch, interface-builder, iphone-5

我开始在 iPhone 5 上开发一个新应用程序，现在我还必须添加对 3.5 英寸屏幕的支持。如您所知，4 屏幕上的内容空间比 3.5 屏幕上的更多。

当我在 3.5 屏幕上运行该应用程序时，整个布局一团糟。是否可以在 4 英寸屏幕上正常使用布局，但在 3.5 屏幕上运行时将布局放置在滚动视图中？

我的想法是滚动页面而不是完全重新设计它。我怎样才能做到这一点？

（或者也许有可能以某种方式分别为 3.5 屏幕和 4 屏幕设计布局）？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-07T21:27:28.590

完全有可能为 3.5 和 4 英寸的屏幕设计完全不同的布局。你只需要添加这个：

```
#define IS_IPHONE_5 (((double)[[UIScreen mainScreen] bounds].size.height) == ((double)568)) 
```

并构建单独的案例，使用**if (IS_IPHONE_5) {do this...} else {do that...}**

**但**

这只能作为最后的手段，因为它需要大量的手动/额外编码。理想情况下，您应该以这样一种方式创建视图，即它会自动针对两个屏幕进行自我调整。你可以通过两种方式做到这一点：

1）使用**自动布局**，即在每个视图元素上和之间应用约束。（个人不是很喜欢）

2）不使用 AutoLayout，通过在每个视图元素上应用**自动调整大小的掩码。**（并通过切换情节提要中的**外形尺寸按钮进行检查）**

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-10-22T08:42:32.423

为此，您需要添加大小为 640* 1136 且名称为 Default-568h@2x.png 的图像并添加到图像文件夹中，然后将图像添加到 Target-General-AppIcons

它非常简单，对我有用

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-07-28T10:28:19.050

我不建议使用 ScrollView，因为如果您使用该方法，那么 UI ELEments 将会有很多重构

如果您包含的元素很少，那么我建议您使用 AutoLayout 或 AutoResizing Mask，将您的约束设置为根据您的视图高度扩展和收缩，

或者

如果您的视图包含许多约束冲突的 UI 元素，那么只有在您的应用程序中对应于同一类的两个 XIb 文件（将您的 ClassName 设置为身份检查器中的两个 Xins），如果您使用的是故事板，那么只需复制您的当前视图并为 iPhone 5 调整它并为每个设置不同的 StoryBoard 标识符，然后根据设备高度分别加载视图，例如

if([[UIScreen mainSceen]bounds].size.height>480){

//加载 iPhone 5 查看 }else{

//加载 iPhone 4 视图 }

# django - 将列表的输出限制为两项

> ID：14759812
> 
> 赞同：0
> 
> 时间：2013-02-07T19:53:34.380
> 
> 标签：django, django-templates

如何将进入 li 标签的输出限制为最后两项？这是我到目前为止所拥有的：

```
{% regroup backups by dataset as dataset_list %}
{% for dataset in dataset_list %}

<h2>{{ dataset.grouper }}</h2>

<ul>
     {% for item in dataset.list %}
        <li>
            {% if item.state = "FAILED" %}<span class="icon-cross red"> {{ item.snapshot_name }} took {{ item.start_time|timesince:item.stop_time }} to transfer {{ item.transfer_size }} and <span class="red">{{ item.state }}</span>
     {% else %}
     <span class="icon-tick green"> {{ item.snapshot_name }} took {{ item.start_time|timesince:item.stop_time }} to transfer {{ item.transfer_size }}
            {% endif %}
       </li>
    {% endfor %}
    </ul> 
```

这会生成如下所示的输出：

```
pool-test/data

    zfs-auto-snap_weekly-2013-01-06-0647 took 2 hours, 43 minutes to transfer 249GB
    zfs-auto-snap_weekly-2013-01-13-0647 took 0 minutes to transfer 29.6KB
    zfs-auto-snap_weekly-2013-01-20-0647 took 0 minutes to transfer 3.23KB
    zfs-auto-snap_weekly-2013-01-27-0647 took 0 minutes to transfer 312B
    zfs-auto-snap_weekly-2013-02-03-0647 took 0 minutes to transfer 312B

pool-test2/data

    zfs-auto-snap_weekly-2012-12-16-0647 took 13 minutes to transfer 35.9GB
    zfs-auto-snap_weekly-2012-12-23-0647 took 0 minutes to transfer 6.16MB
    zfs-auto-snap_weekly-2013-01-06-0647 took 0 minutes to transfer 22.4MB
    zfs-auto-snap_weekly-2013-01-13-0647 took 0 minutes to transfer 20.7MB
    zfs-auto-snap_weekly-2013-01-20-0647 took 0 minutes to transfer 19.1MB
    zfs-auto-snap_weekly-2013-01-27-0647 took 0 minutes to transfer 17.7MB
    zfs-auto-snap_weekly-2013-02-03-0647 took 0 minutes to transfer 10.2MB 
```

我希望它最终看起来像：

```
 pool-test/data

        zfs-auto-snap_weekly-2013-01-27-0647 took 0 minutes to transfer 312B
        zfs-auto-snap_weekly-2013-02-03-0647 took 0 minutes to transfer 312B

    pool-test2/data

        zfs-auto-snap_weekly-2013-01-27-0647 took 0 minutes to transfer 17.7MB
        zfs-auto-snap_weekly-2013-02-03-0647 took 0 minutes to transfer 10.2MB 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-07T19:55:49.677

使用[切片过滤器](https://docs.djangoproject.com/en/dev/ref/templates/builtins/?from=olddocs#slice)：

`{% for item in dataset.list|slice:"-2:" %}`

# file - 域中文件的完整和详细列表？

> ID：14759813
> 
> 赞同：1
> 
> 时间：2013-02-07T19:53:35.380
> 
> 标签：file, list, dns

我想要创建域（我的）中所有文件/路径的完整列表的东西，包括大小和修改日期。我希望列表从根目录开始——不仅仅是过去/public_html。我想从我的 Win7 64 位 PC 上运行它，并将列表保存在我的 PC 上。

我不想 DL 所有文件！

我可以使用 Win7-64 工具来完成此操作吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-07T20:36:09.880

当您说“在域中”的文件/路径时，通常您会产生误解。域基本上是指向资源的名称，[请参见此处](http://netforbeginners.about.com/od/d/f/domain_name.htm)。

如果这听起来有点模糊，那是因为它是。多台计算机可以托管一个域（即为同一个域提供资源），并且它们提供的资源根本不必是文件。您可以将浏览器指向 http://somesite/somefile.html，并且“somefile.html”可能根本不存在（但该站点仍然可以返回网页）。

您不能（通常）列出“域”中的所有文件/路径，但如果您有权访问，您当然可以为一台或多台计算机执行此操作。某些网站可能会提供一种获取目录列表的方法，但即便如此，它也只能来自网站的“DocumentRoot”（在 Apache 术语中）（而不是来自根目录）。

**编辑：如果您的域托管在单台计算机上，并且您可以通过 ftp 完全访问，则可以**[在此处的答案中](https://stackoverflow.com/questions/1854572/traversing-ftp-listing) 使用类似于python 脚本的内容来获取（这台计算机的）远程目录列表。您可能需要更改这样说的行：

> ftp.login()

对此：

> ftp.login(user='你的用户名', passwd='你的密码')

*虽然看起来是一回事，但您真正需要的是计算机的远程目录列表，而不是域（即使 dns 查找将您的域解析为计算机）。*

# javascript - Highchart y轴最小间隔

> ID：14759815
> 
> 赞同：0
> 
> 时间：2013-02-07T19:53:43.427
> 
> 标签：javascript, highcharts, intervals

我想展示一个具有不同间隔的正负样条图

假设正 0 到 50 并且间隔必须增加 5 负 0 到 1000 间隔必须增加 100

有什么办法可以在 Highcharts 中做到这一点

这是我试图展示的系列

```
 series: [{
            id: 'error1',
            name: 'Errors One',
            color:'red',
            data: [5, 3, 4, 7, 2],
        }, {
            id: 'ErrorsOne',
            color: 'red',
            data: [-222, -234, -123, -189, -289],
            showInLegend: false
        }, {
            id:'error2',
            name: 'Errors Two',
            color:'blue',
            data: [3, 4, 4, 2, 5],
        }, {
            id:'ErrorsTwo',
            color:'blue',
            data: [-300, -245, -122, -245, -166],
            showInLegend: false
        }] 
```

这是[jsfiddle的网址](http://jsfiddle.net/psramkumar/8aEs2/)

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-08T11:37:45.570

您可以使用 tickPostions 或 tickPositioner

[http://api.highcharts.com/highcharts#yAxis.tickPositions](http://api.highcharts.com/highcharts#yAxis.tickPositions) [http://api.highcharts.com/highcharts#yAxis.tickPositioner](http://api.highcharts.com/highcharts#yAxis.tickPositioner)

# c# - 持有异常对象是否安全？

> ID：14759819
> 
> 赞同：3
> 
> 时间：2013-02-07T19:53:50.697
> 
> 标签：c#, .net, exception, logging

我正在创建一个测试记录器，其中将包含有关引发的任何异常的信息，以便它们可以使用 GUI 正确显示。

使用以下构造是否安全：

```
public class TestLogEntry {
    public System.Exception Exception { get; private set; }

    public TestLogEntry(/*...,*/ System.Exception exception = null) {
        //...

        Exception = exception;
    }
} 
```

或者以下会更好吗？

```
public class TestLogEntry {
    public string StackTrace { get; private set; }
    public System.Type ExceptionType { get; private set; }
    public string ExceptionMessage { get; private set; }

    public TestLogEntry(/*...,*/ System.Exception exception = null) {
        //...

        if (exception != null) {
            StackTrace = exception.StackTrace;
            ExceptionType = exception.GetType();
            ExceptionMessage = exception.Message;
        }
    }
} 
```

虽然第一种方法更灵活（因为它可以包含额外的自定义数据），但我担心的是：

*   长时间持有异常对象。
*   如果异常对象阻止大对象被垃圾收集，则使用大量内存。
*   脱离上下文访问时返回错误值的异常。

Q1。上述担忧是否有效？

Q2。异常对象通常会引用很多其他数据吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-07T19:56:46.890

**您的担忧是正确的：**异常对象可能会保留任意其他对象。这在实践中非常罕见。其实我从来没有见过`Exception.Data`使用的财产。但是我已经看到`Exception`派生类使用自定义字段持有一些重要的东西：`WebException`有一个`WebResponse`属性！

因此，您会发现，即使是像非托管资源这样昂贵的东西，您也可能会保持活力。

我实际上会复制信息并丢弃`Exception`. 记得也要复制`InnerException`.

另一个问题可能`Exception`是**可变类型**。你可以随时抛出它来改变它的堆栈跟踪。出于这个原因，我想捕获它的状态。

同样重要的是**内存使用**。异常有一些可能从未使用过的字段。你可以保存它们。此外，将其字段内联到您的日志消息对象中将消除对象标头和对象引用。一个小小的收获，但在频繁出现异常的情况下可能值得一试。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-07T19:56:18.573

坚持例外是好的。

一般来说，它们不会保存太多数据（堆栈跟踪、错误消息和相关数据），但这并不多。

并且一个异常实例不会影响其他实例，即使是相同类型的实例。

所以：

> 长时间持有异常对象。

没问题。

> 如果异常对象阻止大对象被垃圾收集，则使用大量内存。

仅当您向异常添加大量数据时才会出现问题 - 如果您不这样做，这不是问题。

> 脱离上下文访问时返回错误值的异常。

不确定这意味着什么 - 什么背景？例外就是例外。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-07T20:02:28.597

我认为您应该意识到，当您写“延长”或“很多”时，这些是相对而非绝对的术语，因此没有人能够说出这些担忧是否过多。我的 10 核机器上有 2Gb 的 RAM，并且我部署到 Windows 服务器，所以内存影响丝毫不会打扰我。也许您正在使用只有几个字节的备用 RAM 的旧 Windows 手机上运行。谁知道？如果您有疑问，请分析您的内存使用情况，但如果内存是一个问题，我会感到惊讶。

一般来说，对我来说更大的担忧是您可能会想使用异常作为向用户显示状态消息的一种方式，这并不酷。例外是针对*特殊*情况。您甚至可能无法从它们中有意义地恢复，更不用说照常进行了。如果您想保留异常记录，可以将异常记录到数据库（例如使用 log4net），但我认为您最好记录它们而不是保留它们。

# list - Groovy/Grails - 需要检索列表索引值

> ID：14759825
> 
> 赞同：5
> 
> 时间：2013-02-07T19:53:56.033
> 
> 标签：list, grails, groovy, indexing

我需要检索我拥有的列表中每个值的索引位置。我这样做是为了显示一个具有交替行背景颜色的 gsp 表。例如：

```
(list.indexVal % 2) == 1 ? 'odd' : 'even' 
```

如何获取 Groovy 列表中每个项目的索引位置编号？谢谢！

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-02-07T19:56:56.263

[根据文档](http://grails.org/doc/2.2.x/ref/Tags/each.html)，gsp 视图中的 g:each 标记允许 grails 存储迭代索引的“status”变量。示例：

```
<tbody>
  <g:each status="i" in="${itemList}" var="item">
    <!-- Alternate CSS classes for the rows. -->
    <tr class="${ (i % 2) == 0 ? 'a' : 'b'}">
      <td>${item.id?.encodeAsHTML()}</td>
      <td>${item.parentId?.encodeAsHTML()}</td>
      <td>${item.type?.encodeAsHTML()}</td>
      <td>${item.status?.encodeAsHTML()}</td>
    </tr>
  </g:each>
</tbody> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-05-31T07:23:28.953

可以使用 、 或 循环中`g:each`的`eachWithIndex`任何一个。`for`

但是，对于这种特定情况，**不需要索引值**。推荐使用 css 伪类：

```
tr:nth-child(odd)  { background: #f7f7f7; }
tr:nth-child(even) { background: #ffffff; } 
```

如果您仍然需要获取索引，选项是：

```
<g:each status="i" in="${items}" var="item">
    ...
</g:each>

<% items.eachWithIndex { item, i -> %>
    ...
<% } %>

<% for (int i = 0; i < items.size(); i++) { %>
   <% def item = items[i] %>
   ...
<% } %> 
```

# ruby - Jekyll - 在 HTML 文件旁边生成 JSON 文件

> ID：14759827
> 
> 赞同：12
> 
> 时间：2013-02-07T19:54:05.213
> 
> 标签：ruby, json, api, jekyll

我想让 Jekyll 为每个页面和帖子创建一个 HTML 文件和一个 JSON 文件。这是为了提供我的 Jekyll 博客的 JSON API - 例如可以在`/posts/2012/01/01/my-post.html`或`/posts/2012/01/01/my-post.json`

有谁知道是否有 Jekyll 插件，或者我将如何开始编写这样的插件，以并排生成两组文件？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-09-11T09:29:14.443

我也在寻找类似的东西，所以我学习了一点 ruby​​ 并制作了一个脚本，可以生成 Jekyll 博客文章的 JSON 表示。我仍在努力，但大部分都在那里。

我将它与 Gruntjs、Sass、Backbonejs、Requirejs 和 Coffeescript 放在一起。如果你喜欢，你可以看看[我在 Github 上的 jekyll-backbone 项目](https://github.com/jezen/jekyll-backbone)。

```
# encoding: utf-8
#
# Title:
# ======
# Jekyll to JSON Generator
#
# Description:
# ============
# A plugin for generating JSON representations of your
# site content for easy use with JS MVC frameworks like Backbone.
#
# Author:
# ======
# Jezen Thomas
# jezenthomas@gmail.com
# http://jezenthomas.com

module Jekyll
  require 'json'

  class JSONGenerator < Generator
    safe true
    priority :low

    def generate(site)
      # Converter for .md > .html
      converter = site.getConverterImpl(Jekyll::Converters::Markdown)

      # Iterate over all posts
      site.posts.each do |post|

        # Encode the HTML to JSON
        hash = { "content" => converter.convert(post.content)}
        title = post.title.downcase.tr(' ', '-').delete("’!")

        # Start building the path
        path = "_site/dist/"

        # Add categories to path if they exist
        if (post.data['categories'].class == String)
          path << post.data['categories'].tr(' ', '/')
        elsif (post.data['categories'].class == Array)
          path <<  post.data['categories'].join('/')
        end

        # Add the sanitized post title to complete the path
        path << "/#{title}"

        # Create the directories from the path
        FileUtils.mkpath(path) unless File.exists?(path)

        # Create the JSON file and inject the data
        f = File.new("#{path}/raw.json", "w+")
        f.puts JSON.generate(hash)
      end

    end

  end

end 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-03-22T14:00:28.937

看看[JekyllBot](http://ben.balter.com/2012/12/27/introducing-jekyllbot/)和[下面的代码](https://github.com/benbalter/benbalter.github.com/blob/0db7c54b44eaccf146c2b2f520eee3e8175560bb/_plugins/generate-json.rb)。

```
require 'json' 

module Jekyll

  class JSONPostGenerator < Generator
    safe true

    def generate(site)

      site.posts.each do |post|
        render_json(post,site)    
      end

      site.pages.each do |page|
        render_json(page,site)    
      end

    end

    def render_json(post, site)

      #add `json: false` to YAML to prevent JSONification
      if post.data.has_key? "json" and !post.data["json"]
        return
      end

      path = post.destination( site.source )

      #only act on post/pages index in /index.html
      return if /\/index\.html$/.match(path).nil?

      #change file path
      path['/index.html'] = '.json'

      #render post using no template(s)
      post.render( {}, site.site_payload)

      #prepare output for JSON
      post.data["related_posts"] = related_posts(post,site)
      output = post.to_liquid
      output["next"] = output["next"].id unless output["next"].nil?
      output["previous"] = output["previous"].id unless output["previous"].nil?

      #write
      #todo, figure out how to overwrite post.destination 
      #so we can just use post.write
      FileUtils.mkdir_p(File.dirname(path))
      File.open(path, 'w') do |f|
        f.write(output.to_json)
      end

    end

    def related_posts(post, site)

      related = []
      return related unless post.instance_of?(Post)

      post.related_posts(site.posts).each do |post|
        related.push :url => post.url, :id => post.id, :title => post.to_liquid["title"]
      end

      related

    end
  end
end 
```

两者都应该完全按照您的意愿行事。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2013-02-12T00:51:32.283

根据您的需要，有两种方法可以实现此目的。如果您想使用布局来完成任务，那么您需要使用[Generator](http://jekyllrb.com/docs/plugins/#generators)。您将遍历站点的每个页面并生成该页面的新 .json 版本。您可以选择根据 site.config 或页面的 YAML 前端内容中是否存在变量来生成哪些页面。Jekyll 使用[生成器](https://github.com/mojombo/jekyll/blob/master/lib/jekyll/generators/pagination.rb)来处理将博客文章分割成索引，每页具有给定数量的文章。

第二种方法是使用[转换器](http://jekyllrb.com/docs/plugins/#converters)（相同的链接，向下滚动）。该转换器将允许您对内容执行任意代码，以将其转换为不同的格式。有关其工作原理的示例，请查看Jekyll 附带的[降价转换器。](https://github.com/mojombo/jekyll/blob/master/lib/jekyll/converters/markdown.rb)

我认为这是一个很酷的主意！

# javascript - 使用 require.js 加载命名的 TypeScript 模块

> ID：14759829
> 
> 赞同：3
> 
> 时间：2013-02-07T19:54:09.293
> 
> 标签：javascript, requirejs, typescript, amd, bundling-and-minification

**简要问题描述：**我想使用 TypeScript 生成 AMD 风格的*命名*模块，然后我想使用 requires.js 从捆绑和缩小的文件中加载这些模块。

**问题：**

*   那可能吗？
*   还是您建议另一种方法？

我想将捆绑和缩小所有脚本的好处（这样就不需要额外的 HTTP 请求）与加载由 TypeScript 生成的命名 AMD 模块相结合。

* * *

**更新：**我在考虑以下 JavaScript 解决方案：

```
define("greeter", ["require", "exports", "jquery"], function(require, exports, $) {
    function greet() {
        alert("Hello World!");
    }

    exports.greet = greet;
}); 
```

然后，我可以将生成的 JavaScript 模块捆绑并缩小到一个文件中，该文件可以很容易地被浏览器缓存。此外，require.js 不必去那里通过几个 GET 请求来获取模块——它们已经被定义了。另外，我拥有使用 TypeScript 生成这些模块的所有优势。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-08T09:32:45.117

我会通过在 TypeScript 中直接使用 RequireJS 来解决这个问题。

它有一个定义文件，我已经编写了一个[在 TypeScript 中使用原始 RequireJS](http://www.stevefenton.co.uk/Content/Blog/Date/201302/Blog/Using-RequireJS-and-Jquery-In-TypeScript/)（而不是 import 语句）和 jQuery 的示例，您可能能够适应。

这是生成的 TypeScript 代码...

```
///<reference path="require.d.ts" />
///<reference path="jquery.d.ts" />
require(['jquery'], function ($) {
    $(document).ready(() => {
        alert('Your code executes after jQuery has been loaded.');
    });
}); 
```

如果这不能满足您的要求，请告诉我您将如何在 JavaScript 中执行此操作，我会很乐意提供 TypeScript 等价物。

# javascript - JavaScript 渲染

> ID：14759832
> 
> 赞同：0
> 
> 时间：2013-02-07T19:54:20.510
> 
> 标签：javascript

为什么这个 HTML/脚本（来自“JavaScript Ninja 的秘密”）不呈现？

[http://jsfiddle.net/BCL54/](http://jsfiddle.net/BCL54/)

```
<html>
    <head>
        <script>
            function outer(){

  var a = 1;

  function inner(){ /* does nothing */ }

  var b = 2;

  if (a == 1) {
    var c = 3;
  }

}

outer();

assert(true,"some descriptive text");
assert(typeof outer==='function',
      "outer() is in scope");
assert(typeof inner==='function',
      "inner() is in scope");
assert(typeof a==='number',
      "a is in scope");
assert(typeof b==='number',
      "b is in scope");
assert(typeof c==='number',
      "c is in scope");
        </script>
    </head>
    <body>        
    </body>
</html> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-07T19:56:11.067

因为您没有导入包含`assert`函数的 Resig 必要脚本：

```
<script>
function assert(pass, msg){
  var type = pass ? "PASS" : "FAIL";
  jQuery("#results").append("<li class='" + type + "'><b>" + type + "</b> " + msg + "</li>");
}
function error(msg){
  jQuery("#results").append("<li class='ERROR'><b>ERROR</b> " + msg + "</li>");
}
function log(){
  var msg = "";
  for ( var i = 0; i < arguments.length; i++ ) {
    msg += " " + arguments[i];
  }
  jQuery("#results").append("<li class='LOG'><b>LOG</b> " + msg + "</li>");
}
</script> 
```

[您可以在他的站点](http://ejohn.org/apps/learn/)的源代码中找到这些功能。请注意，这些函数还要求写入 jQuery 和一些 DOM 元素。你最好适应你的页面。

除非您精通 javascript 以重写这些函数，否则您最好直接在网站上进行出色的练习。

# javascript - 如何检测“设备模式”（MVC3 + Bootstrap）

> ID：14759833
> 
> 赞同：1
> 
> 时间：2013-02-07T19:54:21.773
> 
> 标签：javascript, css, asp.net-mvc, asp.net-mvc-3, twitter-bootstrap

我正在使用 MVC3 和 Bootstrap Responsive，我想通过 Razor（或 javascript）检测哪种模式处于活动状态（桌面、平板电脑或手机）以在一种或另一种情况下显示正确的局部视图。

例如：

```
@if( mode=='phone')
{
    @html.Partial("_partialPhone")
}
@if( mode=='desktop')
{
    @html.Partial("_partialDesktop")
}
...etc 
```

我不想只使用 ".visible-phone" "visible-tablet" 和 ".visible-desktop" css 类，因为虽然只显示了一个局部视图，但它们都加载到 DOM 中并由 Razor 渲染引擎。这对手机和平板电脑的性能不利。

谁能帮我？

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-07T19:55:46.343

媒体查询发生在*客户端*。
这基本上是不可能的。

您可以让客户端在 cookie 中设置其大小，然后读取服务器上的 cookie。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-07T22:13:38.040

您应该可以使用 MVC4 来做到这一点（我不知道 MVC3 中是否存在此功能，但下面网站上的示例使用 MVC4，所以这就是我的回复所依据的）。

[可切换的移动视图](http://www.hanselman.com/blog/CreateAGreatMobileExperienceForYourWebsiteTodayPlease.aspx)

看来您可以开始制作名为 [ActionName].Mobile.cshtml 的文件，并且 ASP.NET 在检测到来自移动设备的请求时会自动使用这些文件（这似乎是可自定义的，因此您可以为平板电脑或其他设备创建自己的）。他演示了类似于您在 Razor 中询问的内容 - 他根据当前显示模式呈现不同的链接，但我认为这也适用于呈现不同的局部视图：

```
@if (Request.Browser.IsMobileDevice && Request.HttpMethod == "GET")
{
    <div class="view-switcher ui-bar-a">
        @if (ViewContext.HttpContext.GetOverriddenBrowser().IsMobileDevice)
        {
            @: Displaying mobile view
            @Html.ActionLink("Desktop view", "SwitchView", "ViewSwitcher", new { mobile = false, returnUrl = Request.Url.PathAndQuery }, new { rel = "external" })
        }
        else
        {
            @: Displaying desktop view
            @Html.ActionLink("Mobile view", "SwitchView", "ViewSwitcher", new { mobile = true, returnUrl = Request.Url.PathAndQuery }, new { rel = "external" })
        }
    </div>
} 
```

尽管如果您有单独的移动视图和桌面视图，那么我认为您不需要像您询问的那样在两个部分之间手动切换。

[相关信息](http://www.hanselman.com/blog/MakingASwitchableDesktopAndMobileSiteWithASPNETMVC4AndJQueryMobile.aspx)

# visual-studio-2010 - Vs2010 中的 Nuget 抛出“算术运算导致溢出”。打开项目时出现异常

> ID：14759837
> 
> 赞同：1
> 
> 时间：2013-02-07T19:54:30.527
> 
> 标签：visual-studio-2010, nuget

如果我打开 Vs2010，然后打开包管理器控制台主机 V 2.0 和 2.2（都尝试过）

控制台启动正常，

如果我然后打开我的解决方案，此错误会出现在控制台中

算术运算导致溢出。

如果我先打开我的解决方案，然后打开控制台，我会得到同样的错误。

每当我运行命令时，我都会立即收到相同的错误。

如果我加载一个不同的项目，我当前的项目是它的副本，它加载得很好。

错误的解决方案名称

SpamisDataMigration测试工具

好的解决方案名称

SAAS3G

唯一明显的区别是solution名称的长度......坏sln是好的sln的副本，名称已更改，删除了一些文件并添加了一些新的单元/集成测试..

有谁知道可能是什么原因造成的？非常感谢任何帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-15T22:02:17.297

Nuget.Config 在复制和重命名路径“JCDCHelper.project”时更改为“JcdcHelper.project”...这导致算术溢出异常

（Nuget.config 指向一个不存在的路径）

# c# - WPF：嵌套绑定的正确方法是什么

> ID：14759840
> 
> 赞同：1
> 
> 时间：2013-02-07T19:54:53.803
> 
> 标签：c#, wpf, data-binding

我有 3 个模型：机器、零件和组件。在我的用户界面上，我将一个列表框绑定到机器列表，将第二个列表框绑定到所选机器的零件列表。现在，当用户选择一个零件时，我想将一个数据网格绑定到所选零件的组件列表。我尝试将数据网格的 itemssource 设置为：

`ItemsSource="{Binding ElementName=PartSelectList, Path=SelectedItem.Components}"`

我也尝试设置它的 datacontext 和 itemssource

`DataContext={Binding ElementName=PartSelectList, Path=SelectedItem}`

`ItemsSource={Binding Components}`

但是，如果通过以下方法对零件的组件列表进行更改，则数据网格不会自动更新

`part.Bags.Add(new Component(..));`

有人对我应该如何处理这个有建议吗？

更新：我有一个实现 INotifyPropertyChanged 的​​类 MachineCollection。在我的 xaml.cs 代码中，我创建了 MachineCollection 对象并将 MainGrid 绑定到它的 Machines 属性：

Page1.xaml.cs：

```
private MachineCollection machines

public Page1()
{
    machineCollection = new MachineCollection();
    MainGrid.DataContext = machineCollection.Machines 
    actionThread = new Thread(InitLists);
    actionThread.Start();
}

public void InitLists()
{
    machineCollection.Machines.AddRange(dbCon.GetAllMachines());
} 
```

课程：

```
public class MachineCollection : INotifyPropertyChanged
{
    public List<Machine> Machines
    {
        get { return machines; }
        set { machines = value; NotifyPropertyChanged("Machines"); }
    }
}

public class Machine : INotifyPropertyChanged
{
    public List<Part> Parts
    {
        get { return parts; }
        set { parts = value; NotifyPropertyChanged("Parts");
    }
}

public class Part : INotifyPropertyChanged
{
    public List<Component> Components
    {
        get { return components; }
        set { components = value; NotifyPropertyChanged("Components");
    }
}

public class Component : INotifyPropertyChanged
{
    public int Length
    {
        get { return length; }
        set { length = value; NotifyPropertyChanged("Length");
    }
} 
```

XAML：

```
<Page>
<Grid Name="MainGrid">
    <ListBox x:Name="MachineSelectList" HorizontalAlignment="Left" VerticalAlignment="Bottom" 
                 Height="114"  Width="231"
                 Foreground="White" Background="#FF7A7A7A" FontSize="16" BorderBrush="#FFC13131"
                 ItemsSource="{Binding}" IsSynchronizedWithCurrentItem="True">
            <ListBox.ItemTemplate>
                <DataTemplate>
                    <Grid Width="200">
                        <TextBlock Text="{Binding SerialNumber}" TextAlignment="Left" HorizontalAlignment="Left" VerticalAlignment="Center"/>
                        <Button Name="DeleteMachine" Tag="{Binding SerialNumber}" HorizontalAlignment="Right" VerticalAlignment="Center" Height="20"
                                Background="{x:Null}" BorderBrush="{x:Null}" Foreground="{x:Null}" Focusable="False" Click="Btn_Click" >
                            <Image Source="..\Resources\Images\delete.png" Stretch="Uniform"/>
                        </Button>
                    </Grid>
                </DataTemplate>
            </ListBox.ItemTemplate>
        </ListBox>

    <ListBox Name="PartSelectList" HorizontalAlignment="Left" VerticalAlignment="Bottom" 
                 Height="164"  Width="231"
                 Background="#FF7A7A7A" Foreground="White" FontSize="16" BorderBrush="#FFC13131"
                 ItemsSource="{Binding Path=Parts}" IsSynchronizedWithCurrentItem="True">
            <ListBox.ItemTemplate>
                <DataTemplate>
                    <Grid Width="200">
                        <TextBlock Text="{Binding PartNumber}" TextAlignment="Left" HorizontalAlignment="Left" VerticalAlignment="Center"/>
                        <Button Name="DeletePart" Tag="{Binding PartNumber}" HorizontalAlignment="Right" VerticalAlignment="Center" Height="20"
                                Background="{x:Null}" BorderBrush="{x:Null}" Foreground="{x:Null}" Focusable="False" Click="Btn_Click" >
                            <Image Source="..\Resources\Images\delete.png" Stretch="Uniform"/>
                        </Button>
                    </Grid>
                </DataTemplate>
            </ListBox.ItemTemplate>
        </ListBox>

</Grid>
</Page> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-07T20:26:18.477

解决这个问题的一种方法是使用 ObservableCollection，它是为这种情况而设计的。

```
public ObservableCollection<Part> Parts
{
    get { return parts; }
    set { parts = value; NotifyPropertyChanged("Parts");
} 
```

或者您可以手动实现接口 INotifyCollectionChanged

基本上，问题是绑定系统不知道您何时调用 Add。如果您每次都重新分配 Parts 属性，那么系统只会重绘所有内容，因此它也会反映更改，但如果 ObservableCollection 不是问题，那是首选方式

# c - 具有可变参数长度的宏

> ID：14759843
> 
> 赞同：5
> 
> 时间：2013-02-07T19:55:01.520
> 
> 标签：c, gcc

有没有办法`#define`使用可变长度参数的宏？

```
#define CALL(ar1, ar2, ar3)
do something
#endif 
```

在 C 代码中

```
CALL(0);
CALL(0,1);
CALL(0,1,2) 
```

都调用上面的 CALL 宏。如果没有使用 ar2, ar3，预处理器只是忽略带有 ar2 或 ar3 的行。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-07T19:58:56.180

是的，看看这个： http: [//gcc.gnu.org/onlinedocs/cpp/Variadic-Macros.html](http://gcc.gnu.org/onlinedocs/cpp/Variadic-Macros.html)

关键字是`__VA_ARGS__`（可变参数宏）：

可以像函数一样声明宏来接受可变数量的参数。定义宏的语法类似于函数的语法。这是一个例子：

```
 #define eprintf(...) fprintf (stderr, __VA_ARGS__) 
```

# java - 在 JBoss 5.1 中取消部署 WAR 时出现 ZipFileException

> ID：14759844
> 
> 赞同：1
> 
> 时间：2013-02-07T19:55:03.487
> 
> 标签：java, jboss, centos, aspectj

我有一个在 JBoss 5.1 和 Ubuntu linux 12.10 下运行良好的标准 WAR 应用程序。

但是，当我尝试在 CentOS 5.2 上部署相同的应用程序时，在停止（取消部署）操作时遇到以下异常：

> java.lang.Error: 访问 DelegatingHandler@458087116 时出错[path=app.war/WEB-INF/lib/aspectjtools.jar context=file:/jboss/server/deploy/real=file:/jboss/server/deploy/app .war/WEB-INF/lib/aspectjtools.jar 原因：java.util.zip.ZipException：在 java.util.zip.ZipFile.open(Native Method) at java.util.zip.ZipFile 打开 zip 文件时出错.(ZipFile.java:127) at java.util.zip.ZipFile.(ZipFile.java:143) at org.jboss.virtual.plugins.context.zip.ZipFileWrapper.ensureZipFile(ZipFileWrapper.java:175) at org. jboss.virtual.plugins.context.zip.ZipFileWrapper.acquire(ZipFileWrapper.java:245) 在 org.jboss.virtual.plugins.context.zip.ZipEntryContext.initEntries(ZipEntryContext.java:484) 在 org.jboss.virtual。 plugins.context.zip.ZipEntryContext.ensureEntries(ZipEntryContext.java:619) ... 58 更多

加载时编织 AOP 需要 aspectjtools.jar。

*   我正在使用 aspectjtools 1.6.2，但我也尝试使用最新版本 1.7.1，同样的问题。
*   我已经多次检查了那个 JAR 的 ZIP 文件完整性，完整性没问题。
*   我创建了一个使用 java.util.zip 解压缩战争的小应用程序，没有例外。
*   我检查了 unix 文件描述符限制是否足够高，设置了最大限制。
*   启动 JBoss JVM 的用户拥有服务器目录的所有权限。
*   我在aspectjtools.jar 中搜索过不规则物，没什么特别的。

仍然可以找出问题所在，并且由于有 0 个谷歌链接，我想知道我是否没有做错什么！我的想法不多了，所以任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-08T19:43:47.140

发现故障：包含另一个似乎导致问题的`aspectjtools-1.6.2.jar`JAR 。`/ant_tasks/resources-ant.jar`我`/ant_tasks`从 jar 中删除了该文件夹，现在我可以将它包含在我的 war 文件中，在 JBoss 中部署/取消部署，堆栈跟踪消失了。不确定究竟是什么原因造成的，因为它看起来像是 JBoss (VFS)、jar of jar 和 CentOS 的组合。

# java - ScrollView 内部的 RelativeLayout - Android

> ID：14759845
> 
> 赞同：-1
> 
> 时间：2013-02-07T19:55:04.360
> 
> 标签：java, android, android-relativelayout

由于各种原因，我正在将此活动的整个布局从 a`TableLayout`更改为 。`RelativeLayout`我有 10 个“行”我想要在里面，`RelativeLayout`但现在我只是想让一个行工作。在 1 行工作后，我将实施其他 9 行。

每行有 4 列，现在只显示第一列，而不是最后 3 列。下面是代码和屏幕截图。“红色 x”是显示的第一列。

```
<LinearLayout
    xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:tools="http://schemas.android.com/tools"
    android:id="@+id/tableLayout"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"
    android:stretchColumns="1"
    android:shrinkColumns="0"
    android:orientation="vertical"
    android:paddingLeft="16dp"
    android:paddingRight="16dp"
    android:paddingTop="70dp"
    android:paddingBottom="70dp"
    android:background="@drawable/scroll" >    

    <TableLayout
        android:layout_width="match_parent"
        android:layout_height="0dip"
        android:layout_weight="20" >

        <TableRow
            android:id="@+id/header"
            android:layout_width="0dip"
            android:layout_height="wrap_content"
            android:layout_weight="1" >

            <TextView
                android:id="@+id/category"
                android:layout_height="wrap_content"
                android:layout_width="0px"
                android:layout_weight="1"
                android:textStyle="bold"
                android:textSize="15sp"
                android:paddingTop="10dp"
                android:gravity="center_horizontal" />

            <TableLayout
                android:layout_width="0dip"
                android:layout_height="wrap_content"
                android:layout_weight="1" >

                <TableRow
                    android:layout_width="0dip"
                    android:layout_height="wrap_content"
                    android:layout_weight="1" >

                    <TextView
                        android:id="@+id/points"
                        android:layout_width="0dip"
                        android:layout_height="wrap_content"
                        android:layout_weight=".25"
                        android:textSize="9sp"
                        android:gravity="left" 
                        android:textStyle="bold" />
                </TableRow>

                <TableRow
                    android:layout_width="0dip"
                    android:layout_height="wrap_content"
                    android:layout_weight="1" >

                    <TextView
                        android:id="@+id/percentage"
                        android:layout_width="0dip"
                        android:layout_height="wrap_content"
                        android:layout_weight=".3"
                        android:textSize="9sp"
                        android:gravity="left"
                        android:textStyle="bold" />
                </TableRow>

                <TableRow
                    android:layout_width="0dip"
                    android:layout_height="wrap_content"
                    android:layout_weight="1" >

                    <TextView
                        android:id="@+id/total_score"
                        android:layout_width="0dip"
                        android:layout_height="wrap_content"
                        android:layout_weight=".45"
                        android:textSize="9sp"
                        android:gravity="left"
                        android:textStyle="bold" />
                </TableRow>
            </TableLayout>
        </TableRow>

        <View 
            android:layout_width="fill_parent"
            android:layout_height="1dp"       
            android:background="#000001" />

        <TableRow
            android:id="@+id/row3"
            android:layout_width="0dip"
            android:layout_height="wrap_content"
            android:layout_weight="1" >

            <TextView
                android:id="@+id/imageColumn"
                android:layout_width="0dip"
                android:layout_height="wrap_content"
                android:layout_weight="0" />

            <TextView
                android:id="@+id/questionColumn"
                android:layout_width="0dip"
                android:layout_height="wrap_content"
                android:layout_weight=".45"
                android:textSize="10sp"
                android:textStyle="bold|italic"
                android:gravity="center_vertical" />

            <TextView
                android:id="@+id/answerColumn"
                android:layout_width="0dip"
                android:layout_height="wrap_content"
                android:layout_weight=".3"
                android:textSize="10sp"
                android:textStyle="bold|italic"
                android:gravity="center_vertical" />

            <TextView
                android:id="@+id/verseColumn"
                android:layout_width="0dip"
                android:layout_height="wrap_content"
                android:layout_weight=".25"
                android:textSize="10sp"
                android:textStyle="bold|italic"
                android:gravity="center_vertical" />
        </TableRow>
    </TableLayout>

    <ScrollView
        android:layout_width="fill_parent"
        android:layout_height="0dip"
        android:layout_weight="65"
        android:fillViewport="true" >

        <RelativeLayout 
            android:layout_width="fill_parent"   
            android:layout_height="wrap_content"> 

            <ImageView 
                android:id="@+id/q1Image"
                android:layout_width="10dp"
                android:layout_height="10dp"  /> 

            <TextView 
                android:id="@+id/q1Question"
                android:layout_width="0dip"
                android:layout_height="wrap_content" /> 

            <TextView 
                android:id="@+id/q1Answer"
                android:layout_width="0dip"
                android:layout_height="wrap_content"   
                android:layout_toRightOf="@id/q1Question"  /> 

            <TextView 
                android:id="@+id/q1Verse"
                android:layout_width="0dip"
                android:layout_height="wrap_content"   
                android:layout_toRightOf="@id/q1Answer"  /> 
        </RelativeLayout>
    </ScrollView>

    <TableLayout
        android:layout_width="match_parent"
        android:layout_height="0dip"
        android:layout_weight="15" >

        <TableRow
            android:id="@+id/row14"
            android:layout_width="match_parent"
            android:layout_height="wrap_content"
            android:stretchColumns="0,1" >

            <Button 
                android:id="@+id/mainmenuBtn"
                android:layout_width="0dip"
                android:layout_height="wrap_content"
                android:layout_weight="1"
                android:textSize="7sp" />

            <Button 
                android:id="@+id/highscoresBtn"
                android:layout_width="0dip"
                android:layout_height="wrap_content"
                android:layout_weight="1"
                android:textSize="7sp" />
            <Button 
                android:id="@+id/playBtn"
                android:layout_width="0dip"
                android:layout_height="wrap_content"
                android:layout_weight="1"
                android:textSize="7sp" />
        </TableRow>
    </TableLayout>
</LinearLayout> 
```

![在此处输入图像描述](../Images/38f5ccda630b97eaf95273bc6ef9621d.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-07T20:15:54.067

如果我没看错并且您指的是这个 ScrollView：

```
<ScrollView
        android:layout_width="fill_parent"
        android:layout_height="0dip"
        android:layout_weight="65"
        android:fillViewport="true" >

        <RelativeLayout 
            android:layout_width="fill_parent"   
            android:layout_height="wrap_content"> 

            <ImageView 
                android:id="@+id/q1Image"
                android:layout_width="10dp"
                android:layout_height="10dp"  /> 

            <TextView 
                android:id="@+id/q1Question"
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                android:layout_toRightOf="@id/q1Image"   /> 

            <TextView 
                android:id="@+id/q1Answer"
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"   
                android:layout_toRightOf="@id/q1Question"  /> 

            <TextView 
                android:id="@+id/q1Verse"
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"   
                android:layout_toRightOf="@id/q1Answer"  /> 
        </RelativeLayout>
    </ScrollView> 
```

当您需要 wrap_content 或静态宽度时，您的 TextView 的 layout_width 设置为 0dip。您的 TextView q1Question 也未附加到 ImageView q1Image 的右侧。当然，除非您希望它堆叠在 ImageView 之上。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-07T20:01:31.580

看起来您在 imageView 中的视图的宽度为 0dip 且没有重量。你能纠正一下吗？

此外，您可以删除 TableRows 上的权重并将它们设置为 match_parent。

# ruby-on-rails-3.1 - 完全更改网址以进行操作

> ID：14759847
> 
> 赞同：0
> 
> 时间：2013-02-07T19:55:06.843
> 
> 标签：ruby-on-rails-3.1, resources, routes, url-routing, match

我的路线中有以下内容：

```
 resource :login, only: [:new, :create, :destroy]

  resources :users, only: [:new, :create] do
    resources :notes
  end 
```

但我想使用 url 'my-domain/login' 而不是 'my-domain/login/new' 和 'my-domain/register' 而不是 'my-domain/users/new'。

我该怎么办？我尝试了以下方法，但没有奏效：

```
 match 'login' => 'login#new'
  match 'register' => 'users#new'

  resource :login, only: [:create, :destroy]

  resources :users, only: [:create] do
    resources :notes
  end 
```

这给了我错误

```
undefined local variable or method `logins_path' for #<#<Class:0x007fd99c40c608>:0x007fd99c87bdd8> 
```

访问“我的域/登录”时

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-07T19:59:58.090

尝试这个：

```
match '/login',  to: 'login#new'
match '/register',  to: 'users#new'

resource :login, only: [:new, :create, :destroy] 
```

[railstutorial.org](http://ruby.railstutorial.org/)是一个非常好的学习 Ruby on Rails 的教程（我敢说“最好的”）。有一章关于制作[有效的登录和注册页面](http://ruby.railstutorial.org/chapters/sign-in-sign-out#sec-sessions_controller)。

**更新**

如果您不希望用户访问 /users/new 我认为您当前的用户资源有效：

```
resources :users, only: [:create] do
    resources :note
end 
```

因为它只匹配用户/创建的路由。如果用户转到 /users/new，您还可以将用户重定向到 /register。用户控制器中的新操作：

```
def new
  redirect_to register_path
end 
```

# c - 当要解析的文件由程序编写时，使用解析器生成器或手动代码？

> ID：14759851
> 
> 赞同：0
> 
> 时间：2013-02-07T19:55:20.180
> 
> 标签：c, parsing, configuration-files

我知道这个问题非常笼统，因此很难回答。

我需要解析一个内容类似于配置文件的文本文件。它包含可测量信号的描述、如何转换为物理单位、注释、描述等。如果这个文件是由人编写的，我会使用解析器生成器，如 lex/yacc 或 ANTLR。但是由于这个文件是由其他程序编写的，所以它总是被正确格式化等。

无论如何我应该使用解析器生成器，还是文件是由其他程序编写的事实是通过手动编码编写不同类型的解析器的原因？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-07T20:07:56.450

1.  不要解决已经解决的问题

2.  如果您有工具可以为您完成工作，请使用这些工具。因此，如果您可以使用 ANTLR 或 LEX/YACC，那么请继续使用它，而不是手动编写词法分析器和解析器。

工作量会少很多

资料来源：[Unix 编程的艺术 - 作者：Eric S. Raymond](http://www.catb.org/esr/writings/taoup/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-07T20:03:13.097

对我来说听起来很复杂，为自己节省时间和麻烦并使用 lex/yacc，文件是否由程序生成并不重要，这只是意味着您在解析时不必验证它，但您会得到它如果您使用 lex/yacc，无论如何都是免费的。另外，如果您使用生成器，格式的更改将更容易处理。

# powershell - 有没有更好的方法来声明多个参数集？

> ID：14759853
> 
> 赞同：13
> 
> 时间：2013-02-07T19:55:36.103
> 
> 标签：powershell

我正在编写一个负责将记录写入数据库的 cmdlet（在 PowerShell 中）。使用条件命令行，似乎我必须定义四个不同的参数集。

有没有更成功的方法来做到这一点？

*细节*

cmdlet 的参数为：

*   `ComputerName`（要连接的 SQL 服务器）
*   `Path`（数据的位置）
*   `Xml`（原始数据本身）
*   `UserName`
*   `Password`
*   `UseIntegratedSecurity`（而不是用户名/密码，使用当前凭据）

`Path`和`Xml`是互斥的，和`UserName`/`Password`和`UseIntegratedSecurity`是互斥的。

为了正确连接，似乎我必须定义四个不同的参数集，例如：

```
 function Install-WidgetData
{
    [CmdletBinding()]
    PARAM
    (
        [Parameter(ParameterSetName="Xml_AutoConnect", Mandatory=$True)]
        [Parameter(ParameterSetName="Xml_ManualConnect", Mandatory=$True)]
        [Parameter(ParameterSetName="Path_AutoConnect", Mandatory=$True, )]
        [Parameter(ParameterSetName="Path_ManualConnect", Mandatory=$True)]
        [ValidateNotNullOrEmpty()]
        [string[]] $ComputerName,

        [Parameter(ParameterSetName="Path_AutoConnect", Mandatory=$True)]
        [Parameter(ParameterSetName="Path_ManualConnect", Mandatory=$True)]
        [ValidateNotNullOrEmpty()]
        [string] $Path,

        [Parameter(ParameterSetName="Xml_AutoConnect", Mandatory=$True)]
        [Parameter(ParameterSetName="Xml_ManualConnect", Mandatory=$True)]
        [ValidateNotNullOrEmpty()]
        [string[]] $Xml,

        [Parameter(ParameterSetName="Xml_AutoConnect")]
        [Parameter(ParameterSetName="Path_AutoConnect")]
        [switch] $UseIntegratedSecurity,

        [Parameter(ParameterSetName="Xml_ManualConnect")]
        [Parameter(ParameterSetName="Path_ManualConnect")]
        [ValidateNotNullOrEmpty()]
        [string] $UserName,

        [Parameter(ParameterSetName="Xml_ManualConnect")]
        [Parameter(ParameterSetName="Path_ManualConnect")]
        [ValidateNotNullOrEmpty()]
        [string] $Password,
    ) 
```

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2014-11-11T00:43:06.830

如果您想对参数集进行快速健全性检查，您可以使用`Show-Command`

这将显示一个包含多个选项卡的表单，每个选项卡对应一个参数集。例如：

> 显示命令获取子项

将显示这一点：

![在此处输入图像描述](../Images/85c2dfb72df5f9e5a08336370f993e60.png)

或者; 如果你想要一个命令行替代品，你可以使用`Get-Command -Syntax`

> Get-Command Get-ChildItem -语法

将向您展示：

> Get-ChildItem [[-Path] ] [[-Filter] ] [-Include ] [-Exclude ] [-Recurse] [-Depth ] [-Force] [-Name] [-UseTransaction] [-Attributes ] [-Directory ] [-文件] [-隐藏] [-只读] [-系统] []
> 
> Get-ChildItem [[-Filter] ] -LiteralPath [-Include ] [-Exclude ] [-Recurse] [-Depth ] [-Force] [-Name] [-UseTransaction] [-Attributes ] [-Directory] ​​[-File ] [-隐藏] [-ReadOnly] [-系统] []

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2014-11-16T05:37:37.880

可悲的是，这是唯一的方法，根据 about_Functions_Advanced_Parameters

这是一段摘录：

> ```
>  You can specify only one ParameterSetName value in each argument and only
>     one ParameterSetName argument in each Parameter attribute. To indicate that
>     a parameter appears in more than one parameter set, add additional Parameter        
>     attributes.
> 
>     The following example explicitly adds the Summary parameter to the Computer
>     and User parameter sets. The Summary parameter is mandatory in one parameter
>     set and optional in the other.
> 
>     Param
>       (
>         [parameter(Mandatory=$true,
>                   ParameterSetName="Computer")]
>         [String[]]
>         $ComputerName,
> 
>         [parameter(Mandatory=$true,
>                   ParameterSetName="User")]
>         [String[]]
>         $UserName
> 
>         [parameter(Mandatory=$false, ParameterSetName="Computer")]
>         [parameter(Mandatory=$true, ParameterSetName="User")]
>         [Switch]
>         $Summary
>       ) 
> ```

有关参数集的详细信息，请参阅MSDN 库中的[Cmdlet 参数集](https://msdn.microsoft.com/en-us/library/dd878348(v=vs.85).aspx) 。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2017-12-07T23:43:33.143

有一种更好的方法，但它是一种*设计*解决方案，而不是技术解决方案。

问题实际上是你的函数做了太多的事情。有人可能会说它违反了单一责任原则。它执行的每个任务都有两个单独的参数集。任务及其参数集是：

*   建立连接字符串
    *   手册（用户名和密码）
    *   自动（操作系统帐户身份验证）
*   向数据库发送查询
    *   XML 数据
    *   包含数据的 XML 文件的路径

由于每个任务都有自己不同的参数集，因此您的函数最终需要它们的笛卡尔积（Manual & XML、Auto & XML、Manual & path、Auto & path）。

每当您发现自己处于这些“笛卡尔积”参数情况之一时，这几乎总是表明您可以将一项功能移动到一个单独的函数中，并将新函数的结果作为原始函数的参数。在这种情况下，您可以将其拆分为`New-ConnectionString`and `Install-WidgetData`，并且`Install-WidgetData`可以接受完整的连接字符串作为参数。这消除了从 构建连接字符串`Install-WidgetData`、将多个参数压缩为一个并将所需参数集数量减半的逻辑。

```
function New-ConnectionString(
    [Parameter(Mandatory=$True, Position=0)] # Makes it mandatory for all parameter sets
    [ValidateNotNullOrEmpty()]
    [string[]]$ComputerName,

    [Parameter(ParameterSetName="AutoConnect", Mandatory=$True)]
    [switch]$UseIntegratedSecurity,

    [Parameter(ParameterSetName="ManualConnect", Mandatory=$True, Position=1)]
    [ValidateNotNullOrEmpty()]
    [string]$UserName,

    [Parameter(ParameterSetName="ManualConnect", Mandatory=$True, Position=2)]
    [ValidateNotNullOrEmpty()]
    [string]$Password
) {
    # ... Build connection string up
    return $connString
}

function Install-WidgetData(
    [Parameter(Mandatory=$True, Position=0)]
    [ValidateNotNullOrEmpty()]
    [string]$ConnectionString,

    [Parameter(ParameterSetName="Path", Mandatory=$True, Position=1)]
    [ValidateNotNullOrEmpty()]
    [string]$Path,

    [Parameter(ParameterSetName="Xml", Mandatory=$True)]
    [ValidateNotNullOrEmpty()]
    [string[]]$Xml
) {
     # Do installation
} 
```

通过调用命令，您可以看到这完成了您想要`help`的操作：

```
PS C:\> help New-ConnectionString

NAME
    New-ConnectionString

SYNTAX
    New-ConnectionString [-ComputerName] <string[]> -UseIntegratedSecurity  [<CommonParameters>]

    New-ConnectionString [-ComputerName] <string[]> [-UserName] <string> [-Password] <string>  [<CommonParameters>]

...

PS C:\> help Install-WidgetData

NAME
    Install-WidgetData

SYNTAX
    Install-WidgetData [-ConnectionString] <string> [-Path] <string>  [<CommonParameters>]

    Install-WidgetData [-ConnectionString] <string> -Xml <string[]>  [<CommonParameters>]

... 
```

然后你这样称呼他们：

```
Install-WidgetData (New-ConnectionString 'myserver.example.com' -UseIntegratedSecurity) `
    -Path '.\my-widget-data.xml' 
```

`New-ConnectionString`当然，如果需要，您可以将结果存储在变量中。您还可以通过此重构获得一些额外的功能：

*   `New-ConnectionString`的返回值可用于任意数量的需要连接字符串的函数。
*   如果他们愿意，调用者可以从其他来源获取连接字符串
*   `New-ConnectionString`如果呼叫者需要使用您未提供访问权限的功能，他们可以放弃您，转而自己做

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-11-14T22:34:10.227

嗯，这是最简洁的方式。比 switch/case 或 if/then 陷阱更简洁地解释所有可能的参数集！

但是，您的另一个选择是为互斥的参数集编写不同的命令，例如

```
Install-WidgetDataFromPath
Install-WidgetDataFromXml 
```

两者都可以调用`Install-WidgetData`脚本命令行开关，您可以将其隐藏在模块内，或者如果您仅使用脚本文件，则使用范围修饰符将其隐藏在全局范围之外。内部命令行开关可以为两个（或更多）面向用户的包装器实现共享代码。从您的代码来看，我认为您不需要解释如何实现这一点。

# java - 为什么在使用 Generic 类时不需要指定类型参数？

> ID：14759855
> 
> 赞同：1
> 
> 时间：2013-02-07T19:55:38.660
> 
> 标签：java

今天编译这段代码时我很惊讶：

```
class GenericClass<T> {
    public void emptyMethod(T instance) {
        // ..
    }

    public void print(T instance) {
        System.out.println(instance);
    }
}

public class Main {

    public static void main(String[] args) {
        GenericClass first = new GenericClass();
        System.out.println("Wow");
        first.emptyMethod(10);
        first.print(16);
    }

} 
```

编译器发出警告（类型安全：方法 emptyMethod(Object) 属于原始类型 GenericList。应该参数化对泛型类型 GenericList 的引用），但无论如何它不会导致编译器错误并且它运行“正常”（至少提供的打印方法）。据我了解，编译器使用 object 作为类型参数，但我发现它违反直觉。为什么编译器会做这样的事情？为什么不需要我指定类型参数？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-07T19:57:44.877

基本上，您使用的是*原始*类。

回想一下泛型在 Java 中首次引入的时候：有大量代码已经使用过`List`，`ArrayList`等等。为了避免破坏所有代码，但仍然重用现有的类，引入了原始类型——它基本上是使用泛型输入好像它不是一个。

如您所见，您会收到警告-因此值得避免-但这是完全允许它的主要原因。

有关更多信息，请参阅JLS 的[第 4.8 节](http://docs.oracle.com/javase/specs/jls/se7/html/jls-4.html#jls-4.8)，其中包括：

> 原始类型与通配符密切相关。两者都基于存在类型。原始类型可以被认为是通配符，其类型规则故意不合理，以适应与遗留代码的交互。从历史上看，原始类型在通配符之前；它们首先在 GJ 中被介绍，并在 Gilad Bracha、Martin Odersky、David Stoutamire 和 Philip Wadler 的论文让未来安全：为 Java 编程语言添加通用性，在 ACM 对象会议论文集中进行了描述-面向编程、系统、语言和应用程序 (OOPSLA 98)，1998 年 10 月。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-07T19:58:33.510

你必须知道泛型是如何在 Java 中实现的。它们远非完美。您必须记住，在运行时一切都是对象。运行时没有类型。

添加了泛型以在您需要的地方增加安全性，但如果您不想使用它，您可以忽略警告并使用未参数化的实例。

但是，如果您希望 java 编译器帮助您实现类型安全，那么您可以对泛型类实例进行参数化。例如，一旦您创建了 GenericClass，编译器将不允许您将其与整数参数一起使用（first.emptyMethod(10) 将无法编译）。如果您进行显式类型转换，您仍然可以使用整数参数。

因此，将其视为增加安全性的良好做法，仅当您遵守规则时才有效。

# html - Html Data-Icon 与输入边距混淆

> ID：14759859
> 
> 赞同：0
> 
> 时间：2013-02-07T19:55:57.360
> 
> 标签：html, input, margin

我正在尝试将数据图标插入两个输入字段，但它们不断将我的输入字段向右移动，就像他们在其中添加一个边距一样。

我对图标使用 z-index:2 以使它们漂浮在字段上方并且它们确实如此，但添加的边距仍然存在。

这是我的CSS：

```
#loginBox input#username, #loginBox input#password {
    height: 20px;
    width: 120px;
    padding: 5px 5px 5px 32px;
    border: 1px solid rgb(178, 178, 178);
    box-sizing : content-box;
    border-radius: 3px;
    box-shadow: 0px 1px 4px 0px rgba(168, 168, 168, 0.6) inset;
    transition: all 0.2s linear;
}
#loginBox [data-icon]:before {
    content: attr(data-icon);
    font-family: FontomasCustomRegular;
    color: #999;
    position: relative;
    left: 25px;
    z-index: 2;
} 
```

这是一个屏幕截图：

![在此处输入图像描述](../Images/a10c2837d0de4e0d221fe6b1c592ed66.png)

有什么想法吗？

谢谢。

* * *

## 回答 #1

> 赞同：-2
> 
> 时间：2015-05-15T13:28:03.170

Sanjeev 和 Stéphanie Walter 的代码几乎相同

[http://www.infotuts.com/email-verification-php/](http://www.infotuts.com/email-verification-php/)

[http://tympanus.net/codrops/2012/03/27/login-and-registration-form-with-html5-and-css3/](http://tympanus.net/codrops/2012/03/27/login-and-registration-form-with-html5-and-css3/)

```
[data-icon]:after {
    content: attr(data-icon);
    font-family: 'FontomasCustomRegular';
    color: rgb(106, 159, 171);
    position: absolute;
    left: 10px;
    top: 35px;
    width: 30px;
} 
```

**位置：绝对；**

# ruby-on-rails - Rails 控制台未加载？y (Errno::ENOENT)

> ID：14759864
> 
> 赞同：0
> 
> 时间：2013-02-07T19:56:19.743
> 
> 标签：ruby-on-rails, ruby, rails-console

当我尝试加载 rails 控制台时，我突然收到以下错误消息。我最近刚刚将数据库切换到 postgres，这给我带来了很多问题（尽管我必须承认我比 mysql 更喜欢它！），所以我假设这与此有关。有任何想法吗？

```
y (Errno::ENOENT)/ruby/1.9.3-p327/lib/ruby/gems/1.9.1/gems/activesupport-3.2.10/lib/active_support/dependencies.rb:251:in `require': No such file or directory - /usr/local/lib/?
    from /usr/local/Cellar/ruby/1.9.3-p327/lib/ruby/gems/1.9.1/gems/activesupport-3.2.10/lib/active_support/dependencies.rb:251:in `block in require'
    from /usr/local/Cellar/ruby/1.9.3-p327/lib/ruby/gems/1.9.1/gems/activesupport-3.2.10/lib/active_support/dependencies.rb:236:in `load_dependency'
    from /usr/local/Cellar/ruby/1.9.3-p327/lib/ruby/gems/1.9.1/gems/activesupport-3.2.10/lib/active_support/dependencies.rb:251:in `require'
    from /usr/local/Cellar/ruby/1.9.3-p327/lib/ruby/gems/1.9.1/gems/sprockets-2.2.2/lib/sprockets/processing.rb:3:in `<top (required)>'
    from /usr/local/Cellar/ruby/1.9.3-p327/lib/ruby/gems/1.9.1/gems/activesupport-3.2.10/lib/active_support/dependencies.rb:251:in `require'
    from /usr/local/Cellar/ruby/1.9.3-p327/lib/ruby/gems/1.9.1/gems/activesupport-3.2.10/lib/active_support/dependencies.rb:251:in `block in require'
    from /usr/local/Cellar/ruby/1.9.3-p327/lib/ruby/gems/1.9.1/gems/activesupport-3.2.10/lib/active_support/dependencies.rb:236:in `load_dependency'
    from /usr/local/Cellar/ruby/1.9.3-p327/lib/ruby/gems/1.9.1/gems/activesupport-3.2.10/lib/active_support/dependencies.rb:251:in `require'
    from /usr/local/Cellar/ruby/1.9.3-p327/lib/ruby/gems/1.9.1/gems/sprockets-2.2.2/lib/sprockets/base.rb:5:in `<top (required)>'
    from /usr/local/Cellar/ruby/1.9.3-p327/lib/ruby/gems/1.9.1/gems/activesupport-3.2.10/lib/active_support/dependencies.rb:251:in `require'
    from /usr/local/Cellar/ruby/1.9.3-p327/lib/ruby/gems/1.9.1/gems/activesupport-3.2.10/lib/active_support/dependencies.rb:251:in `block in require'
    from /usr/local/Cellar/ruby/1.9.3-p327/lib/ruby/gems/1.9.1/gems/activesupport-3.2.10/lib/active_support/dependencies.rb:236:in `load_dependency'
    from /usr/local/Cellar/ruby/1.9.3-p327/lib/ruby/gems/1.9.1/gems/activesupport-3.2.10/lib/active_support/dependencies.rb:251:in `require'
    from /usr/local/Cellar/ruby/1.9.3-p327/lib/ruby/gems/1.9.1/gems/sprockets-2.2.2/lib/sprockets/environment.rb:1:in `<top (required)>'
    from /usr/local/Cellar/ruby/1.9.3-p327/lib/ruby/gems/1.9.1/gems/actionpack-3.2.10/lib/sprockets/railtie.rb:23:in `block in <class:Railtie>'
    from /usr/local/Cellar/ruby/1.9.3-p327/lib/ruby/gems/1.9.1/gems/railties-3.2.10/lib/rails/initializable.rb:30:in `instance_exec'
    from /usr/local/Cellar/ruby/1.9.3-p327/lib/ruby/gems/1.9.1/gems/railties-3.2.10/lib/rails/initializable.rb:30:in `run'
    from /usr/local/Cellar/ruby/1.9.3-p327/lib/ruby/gems/1.9.1/gems/railties-3.2.10/lib/rails/initializable.rb:55:in `block in run_initializers'
    from /usr/local/Cellar/ruby/1.9.3-p327/lib/ruby/gems/1.9.1/gems/railties-3.2.10/lib/rails/initializable.rb:54:in `each'
    from /usr/local/Cellar/ruby/1.9.3-p327/lib/ruby/gems/1.9.1/gems/railties-3.2.10/lib/rails/initializable.rb:54:in `run_initializers'
    from /usr/local/Cellar/ruby/1.9.3-p327/lib/ruby/gems/1.9.1/gems/railties-3.2.10/lib/rails/application.rb:136:in `initialize!'
    from /usr/local/Cellar/ruby/1.9.3-p327/lib/ruby/gems/1.9.1/gems/railties-3.2.10/lib/rails/railtie/configurable.rb:30:in `method_missing'
    from /Users/benyorke/rubystore/config/environment.rb:6:in `<top (required)>'
    from /usr/local/Cellar/ruby/1.9.3-p327/lib/ruby/gems/1.9.1/gems/railties-3.2.10/lib/rails/application.rb:103:in `require'
    from /usr/local/Cellar/ruby/1.9.3-p327/lib/ruby/gems/1.9.1/gems/railties-3.2.10/lib/rails/application.rb:103:in `require_environment!'
    from /usr/local/Cellar/ruby/1.9.3-p327/lib/ruby/gems/1.9.1/gems/railties-3.2.10/lib/rails/commands.rb:40:in `<top (required)>'
    from script/rails:6:in `require'
    from script/rails:6:in `<main>' 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-09T04:19:24.600

我相信这可能是 Ruby 1.9.3-p327 的一个错误，刚刚由 Ruby 1.9.3-p385 修复。升级到 1.9.3-p385 会为您解决问题吗？

此错误消息中似乎很奇怪，并且与我一直遇到的问题类似，是路径末尾的问号：`No such file or directory - /usr/local/lib/?`. 几周前从 1.9.3-p194 升级到 1.9.3-p327 后，我收到了与 ruby​​ 的 require 和带有问号、符号或其他随机字符的路径相关的类似奇怪错误消息。然而，这些问题非常零星，而且大约在同一时间我们遇到了一些硬件故障，因此很难追踪。

今天这个问题开始在一个特定的上下文中持续发生，所以我能够做一些额外的调试。更新到 1.9.3-p385 似乎已经修复了它，但鉴于我遇到的问题的零星性质，我并不完全 100% 这实际上是修复。我也不完全确定这是否与您遇到的问题相同。路径中的神秘问号只是让它看起来可能是相关的。以下是我们遇到的错误类型的几个示例：

```
No such file or directory - /srv/shared/rails/internal/admin/vendor/bun@

No such file or directory - /srv/shared/rails/internal/admin/vendor? 
```

如果它与我遇到的相同问题完全相关，但 1.9.3-p385 升级没有解决它，还有一些其他注意事项或需要探索的东西：

*   我今天能够在 1.9.3-p327 和 1.9.3-p374 上重现此问题。但是，1.9.3-p194、1.9.3-p286 和 1.9.3-p385 上似乎不存在该问题。
*   您是否在 gem 加载路径中的任何地方使用符号链接？例如，我们使用 Bundler 将 gems 安装到`vendor/bundle`每个应用程序内的本地路径中。但`vendor/bundle`实际上是指向另一个位置的符号链接（这与 Capistrano 部署设置有关）。我相信符号链接可能在起作用。在今天的测试中，如果我没有使用符号链接，那么问题在所有版本的 ruby​​ 上都消失了。
*   你使用[bundler-exec](https://github.com/gma/bundler-exec "捆绑器执行")吗？在另一个偶尔发生此问题的情况下，绕过别名 bundler-exec 似乎也能神奇地解决问题，但今天的问题甚至没有触及 bundler-exec，所以我不太确定。
*   大多数情况下，我们的问题是非常随机的（在尝试运行相同命令几次后它会消失），但在少数情况下，问题会持续一个小时或更长时间才消失。
*   关于我们系统的一些信息：
    *   64 位红帽企业 Linux 6
    *   捆绑器 1.2.3
    *   Rubygems 1.2.5（也发生在 1.2.4 下）
    *   rbenv

但就像我说的，这个问题也恰好与我们端的一些硬件磁盘故障和一般服务器不稳定同时发生，所以我不确定这是 Ruby 问题还是发生了什么。但希望 1.9.3-p385 能够真正修复它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-21T01:04:30.357

Sorry for not updating this thread - I have actually been working on this in the background for a few weeks now. I couldn't find ANY information on this online, so I'm going to post as detailed of a solution as I can.

* * *

# The Issues

The issues I was having was that I could not access rails console, and I had to manually start the postgres server every-time I restarted my machine. My solutions to that, as I have worked with this for a few weeks were

**In regards to the console** I used herokus console. By pushing my app to heroku (which is free) not only could I view it on the web (any machine) but on my machine I could run

```
$ heroku run console 
```

and get access to a console. Now this isn't a perfect solution in anyway as I can't manipulate data on my machine but it saved me many times

**In regards to the server** I ran

```
$ brew info postgres 
```

which gave me the commands to manually restart the server

```
You should reload postgresql:
launchctl unload ~/Library/LaunchAgents/homebrew.mxcl.postgresql.plist
launchctl load ~/Library/LaunchAgents/homebrew.mxcl.postgresql.plist 
```

* * *

# The Solution

To be honest, I have run every command I can find dozens of times, and just today got it working. I don't know if I was making typos, doing it in an ineffective order, mixing up pg/postgres/postgresql or what but what I did below worked

**When using this solution, it will erase all databases. Migrations will be able to rebuild the structure, but any data will be lost**

## 1\. Updated Homebrew

```
$ brew update 
```

*If you don't have home-brew, check out this page for instructions to install (saved my neck with many things, including minimagick imagemagick and postgres!): [http://mxcl.github.com/homebrew/](http://mxcl.github.com/homebrew/)*

## 2\. Removed postgresql

```
$ brew rm postgresql --force 
```

## 3\. Installed postgreql

```
$ brew install postgresql 
```

*This is the first step to reference postgres. When looking online, I ran across commands that used postgresql, postgres, and pg. Postgresql refers to the actually PostgreSQL program. postgres and pg are ruby gems, which we will get to later*

## 4\. Ran suggested commands

After running "$ brew install postgres" there is a lot of information given to you. Make sure to read through it, as it will suggest what commands to run. Use these suggestions to find the commands I reference below. **If you need to access this information later simply run**

```
$ brew info postgresql 
```

To initialize the database

```
$ initdb file/path 
```

Set up the autolauncher

```
$ cp file/path ~ LaunchAgents/file/path 
```

Launch postgresql initially

```
$ launchctl load file/path
$ pg_ctl-D file/oath 
```

## 5\. Download Postgres.app

Although to my knowledge this seems redundant, this is what got it to work on my mac. visit [http://postgresapp.com](http://postgresapp.com) to download

## 6\. Install gems

There are two gems - postgres and pg. I required pg in my gemfile and ran a bundle install command, however it still gave me issues until I installed postgres on my machine - even though it is not required in my gemfile, rails console wont seem to work without it atleast installed

In the gem file

```
gem 'pg' 
```

Run a bundle install command in a terminal window

```
$ bundle install 
```

Sudo install the postgres gem

```
$ sudo gem install postgres 
```

* * *

At this point everything should be working. You should be able to restart the machine and not have any problems!

# php - json_encode 字符问题

> ID：14759868
> 
> 赞同：0
> 
> 时间：2013-02-07T19:56:39.023
> 
> 标签：php, json

我对 json_encode 有一个奇怪的问题。

这样做：

```
echo json_encode(array('action' => 'act')); 
```

返回这个：

```
"\u0000\"action\":\"act\"} 
```

是的，没有起始括号。如何解决这个问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-07T19:58:38.170

我没有这个问题输出是

```
 {"action":"act"} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-18T13:58:30.077

问题是 json_encode 运行了两次。

# vb.net - vb.net mustinherit cast child

> ID：14759870
> 
> 赞同：0
> 
> 时间：2013-02-07T19:56:45.733
> 
> 标签：vb.net, inheritance

我与 mustInherit 类一起工作

我创造了一些看起来像这样的东西

```
Sub OnLoad
    ...
        Dim o As Object = BaseX(Of Object).LoadItem
        dim gv as Gridview = o.AddGridview(myPanel)
    ...
end Sub

MustInherit Class BaseX(Of T1)
    Public Shared Function LoadItem() As Object
        ...
            'Create Item FirstX or SecondX
            'return the new Item
        ...
    End Function

    Public Function GetGridview(ByVal container As Panel) As Gridview
        'return a gridview
    End Function
End Class

Class FirstX Inherits BaseX(of A)
...
End Class

Class SecondX Inherits BaseX(of B)
...
End Class 
```

我在“dim gv as Gridview = o.AddGridview(myPanel)”上出现错误

> 错误 18 后期绑定分辨率；可能会发生运行时错误。
> 
> 错误 19 警告被视为错误：后期绑定解决方案；可能会发生运行时错误。

我试试

```
Dim gv As GridView = DirectCast(o, BaseX(Of Object)).AddGridview(myPanel) 
```

但我遇到了运行时错误

> 无法将对象类型 FirstX 转换为 BaseX 类型

如果你有路要走？我应该改变什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-07T21:36:03.100

您不能将 BaseX(of Object) 转换为 FirstX，因为 FirstX 是从 BaseX(of A) 继承的。即使 A 继承自 Object，BaseX(Of Object) 也不是 BaseX(of A) 的父级。

考虑一下：

```
Class A
    public overrides Sub ToString()
         Console.Writeline("A")
    End Sub
End Class

Class FirstX Inherits BaseX(of A)
    public overrides Sub ToString()
         A.ToString()
    End Sub
End Class 
```

您可以看到 BaseX(Of Object).ToString() 与 BaseX(of A).ToString() 不同，它是两个完全不同的类，它们不从另一个继承。

要解决您的问题，您可以直接转换为 FirstX 或 BaseX(of A)。为了可扩展性，我建议创建一个由 BaseX(of T) 实现的接口 IBaseX。然后你可以随时上传到界面。

```
Interface IBaseX
    Function GetGridview(ByVal container As Panel) As Gridview
End Interface

MustInherit Class BaseX(Of T1)
    Implements IBaseX

    Public Shared Function LoadItem() As Object
        ...
            'Create Item FirstX or SecondX
            'return the new Item
        ...
    End Function

    Public Function GetGridview(ByVal container As Panel) As Gridview
        Implements IBaseX.GetGridView
        'return a gridview

    End Function

End Class 
```

向上转换：

```
Dim gv As GridView = CType(o, IBaseX).AddGridview(myPanel) 
```

注意：这是 VB.NET 代码，它可能不适用于 Excels VB 6.0

# javascript - 如何使用 jQuery 取消缩短 t.co 链接？

> ID：14759874
> 
> 赞同：2
> 
> 时间：2013-02-07T19:56:54.270
> 
> 标签：javascript, jquery, html, twitter

我有一个可以打印**t.co**链接的 twitter 插件。我怎样才能用 jQuery “取消短路”它们？有我可以使用的图书馆吗？

我做了一些搜索，但我找不到任何东西。也许我在寻找错误的东西......

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-07T20:48:38.293

我在这里做了一个小提琴：http: [//jsfiddle.net/duotrigesimal/XB8Uf/](http://jsfiddle.net/duotrigesimal/XB8Uf/)

[它向 LongURL ( http://longurl.org/api#expand-url](http://longurl.org/api#expand-url) )的 api 发出请求以获取扩展的 url。

```
var tests = [
    'http://t.co/NJwI2ugt', 
    'http://www.google.com' //nothing should happen
];

var expander = {
    expand: function (url, callback) {
        $.ajax({
            dataType: 'jsonp',
            url: 'http://api.longurl.org/v2/expand',
            data: {
                url: url,
                format: 'json'
            },
            success: function(response) {
                callback(response);
            }
        });
    }
};

for(i in tests) {

    expander.expand( tests[i], function(response) {
        $('#output').append(response['long-url']+'<br>');
        console.dir(response);
    });

} 
```

# eclipse - Eclipse - Maven 和 Mercurial

> ID：14759879
> 
> 赞同：3
> 
> 时间：2013-02-07T19:57:09.090
> 
> 标签：eclipse, maven, plugins, mercurial

我有一个包含 Maven 项目的远程 Mercurial 存储库。我想将它克隆到我的 Eclipse 工作区进行开发。

我目前通过 Eclipse Marketplace 安装了 Eclipse 的 Maven 集成。我也有 MercurialEclipse。但我无法将代码签出为 Maven 项目。当我正常结帐时，仅完全下载了父项目代码，这是有道理的，因为未识别 Maven 特性。

我已经很好地集成了 svn，并且我有插件“用于 Subclipse 的 Maven SCM 处理程序”，因此我可以轻松地将 svn 中的项目签出为 Maven 项目。Mercurial有类似的东西吗？

我还检查了“File->New->Other->Maven->Checkout Maven Projects from SCM”，我在下拉列表中只看到 svn。

请让我知道 Eclipse 中的 Maven-Mercurial 集成是否可行。

感谢您查看这个。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-08T20:06:10.823

我每天在工作中都这样做，并且有一个小技巧。

尝试按以下顺序进行：

1.  从命令行克隆项目
2.  然后在eclipse中将项目导入为maven项目
3.  然后右键单击项目并选择团队->共享->mercurial
4.  按照对话框，最终您将到达询问您 scm 网址的对话框。

就是这样。对于多模块项目，您可能需要为每个模块重复步骤 3 和 4。

有关信息，我使用的是 maven 插件的 1.2.0 版本，而对于 mercurial，我使用的是新网站中的一个：[https ://bitbucket.org/mercurialeclipse/main/wiki/Home](https://bitbucket.org/mercurialeclipse/main/wiki/Home)

并配置了外部的 Mercurial 客户端。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-07-06T12:13:37.547

您可以使用 Eclipse IDE 中的 MercurialEclipse 和 Maven 插件克隆和配置多模块项目，执行以下步骤。

1.  使用 MercurialEclipse 在 Eclipse IDE 中克隆项目。
2.  在 Project Explorer 中右键单击克隆的项目，选择“Configure”，然后选择“Convert to Maven Project”。
3.  选择 File、Import 和“Existing Maven Project”，然后单击 Next。您将在下一个屏幕上自动选择克隆的项目和模块，因此只需单击“完成”按钮。

最后，您将克隆您的多模块项目并将其配置为 maven 项目。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-05-13T09:21:53.107

我使用[MercurialEclipse](http://javaforge.com/wiki/72561)插件并以其他方式进行 Checkout：

1.  克隆存储库
    1.  文件 -> 新建 -> 项目...
    2.  选择 Mercurial -> 克隆现有的 Mercurial 存储库`Next >`
    3.  键入 URL、身份验证数据和克隆目录名称（可选）`Finish`
2.  为 Eclipse 准备项目
    1.  生成 Eclipse 文件：`mvn eclipse:eclipse`在命令行中执行
    2.  刷新项目（通过上下文菜单或`F5`）
    3.  有时最终您需要选择正确的编码：
        1.  打开项目属性
        2.  将资源 -> 文本文件编码设置为其他

# java - HashMap如何找出“额外”键并删除它们

> ID：14759880
> 
> 赞同：3
> 
> 时间：2013-02-07T19:57:11.523
> 
> 标签：java

假设我有一个 Hashmap 对象 myMap，它包含一组键和值，

```
key1, value1
key2, value2
...
... 
```

假设我总共有 30 个键。

现在我得到一个键列表：`key1, key2....,`假设有 28 个。

检查 myMap 对象并删除不在我的键列表中的键的最佳方法是**什么**？我是否必须遍历 hashmap 键集并比较列表中的每个键集？

谢谢。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-07T20:01:03.527

从地图中获取一组键。该集合由地图支持。然后调用retainAll就可以了。

```
Set<String> keys = myMap.keySet();
keys.retainAll(keyList); 
```

这是有关该方法的[文档。](http://docs.oracle.com/javase/7/docs/api/java/util/HashMap.html#keySet%28%29)`keySet`

这是有关该方法的[文档。](http://docs.oracle.com/javase/7/docs/api/java/util/Set.html#retainAll%28java.util.Collection%29)`retainAll`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-07T19:58:48.730

为您拥有的每个键使用该`containsKey`方法，如果该方法返回`false`，则将其删除。另一种选择是使用`Map#keySet#retainAll`.

# grails - 使用来自 Grails 应用程序的参数执行 Groovy 脚本

> ID：14759881
> 
> 赞同：1
> 
> 时间：2013-02-07T19:57:13.117
> 
> 标签：grails, groovy

关于这里提出的问题

[如何从我的 Grails 应用程序执行 Groovy 脚本？](https://stackoverflow.com/questions/1927426/how-to-execute-a-groovy-script-from-my-grails-app)

除了......我如何传递参数？

```
def cmd = ['groovy.bat', 'C:\\my path\\mysript.groovy'] 
```

对于从命令行运行的脚本，例如

```
groovy myscript.groovy -name params.name -project params.name 
```

使用 CliBuilder 从提交的表单中获取参数和参数

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-07T20:03:19.880

Groovy 提供了一种执行命令行进程的简单方法。哟可以将命令行写成字符串并调用execute()方法。例子：

```
"groovy myscript.groovy -name nancy -project testproj".execute() 
```

[此链接中的更多信息](http://groovy.codehaus.org/Process+Management)。

如果参数带有空格：

```
["groovy", 
 "my script with spaces.groovy", 
 "-name", 
 "nancy", 
 "-project", 
 "testproj"].execute() 
```

# asp.net - MSDeploy 到多台服务器

> ID：14759894
> 
> 赞同：0
> 
> 时间：2013-02-07T19:58:05.607
> 
> 标签：asp.net, web-services, configuration, msdeploy

我正在寻找一种部署到多个不同环境的方法。

即，dev、uat、prod1 和 prod2 服务器

我的印象是 msdeploy 可以为此工作。目前我们有一些使用类似命令部署的东西

```
"C:\Program Files\IIS\Microsoft Web Deploy\msdeploy.exe" -verb:sync -source:contentPath="D:\sourcepath" -dest:contentPath="D:\destpath", computerName=PRODSERVER1

"C:\Program Files\IIS\Microsoft Web Deploy\msdeploy.exe" -verb:sync -source:contentPath="D:\sourcepath" -dest:contentPath="D:\destpath", computerName=PRODSERVER2 
```

这会起作用，但是在我正在开发的需要部署的应用程序中，涉及到数据库连接，需要根据环境进行更改。

```
<connectionStrings>
        <add name="DEVServer" connectionString="Data Source=DEVServer\SQLinstance;Initial Catalog=DBNAME;User ID=sqluser;Password=sqlpassword" providerName="System.Data.SqlClient" />
</connectionStrings> 
```

此外，由于这是一个 WCF 服务，我有一个端点的身份，也需要根据环境进行更改

```
<identity>
            <dns value="DEVServer" />
</identity> 
```

有没有办法对此进行参数化？我应该设置多个 web.config 文件吗？最简单的方法是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-08T17:07:03.293

假设您使用的是 Visual Studio 2010 或 2012，您可以为每个环境设置一个发布配置文件并将数据库连接字符串放入其中，为每个发布配置文件设置一个 Web.config 转换以进行端点更改，然后您可以部署从命令行使用 MSBuild 而不是直接使用 msdeploy。

有关如何设置发布配置文件的详细信息，请参阅[http://msdn.microsoft.com/en-us/library/dd465337.aspx](http://msdn.microsoft.com/en-us/library/dd465337.aspx)

有关 Web.config 转换示例，请参阅[http://www.asp.net/web-forms/tutorials/deployment/deployment-to-a-hosting-provider/deployment-to-a-hosting-provider-web-config-文件转换 3-of-12](http://www.asp.net/web-forms/tutorials/deployment/deployment-to-a-hosting-provider/deployment-to-a-hosting-provider-web-config-file-transformations-3-of-12)

从命令行发布时，发布解决方案的格式如下：

msbuild path\to\solution.sln /p:DeployOnBuild=true /p:PublishProfile=[nameofprofile] /p:Password=[password]

要发布项目而不是解决方案，请指定 .csproj/.vbproj 文件并添加 /p:VisualStudioVersion=11.0 用于 VS 2012（10.0 用于 VS 2010）。

# iphone - shouldAutorotateToInterfaceOrientation 不会尊重我的意愿

> ID：14759895
> 
> 赞同：1
> 
> 时间：2013-02-07T19:58:08.103
> 
> 标签：iphone, ios, xcode, storyboard

（使用故事板）

我试图让我的 ViewController 子类之一支持的不仅仅是纵向视图。

我已经加进去了

```
- (BOOL)shouldAutorotateToInterfaceOrientation:(UIInterfaceOrientation)interfaceOrientation
{
    // Return YES for supported orientations
    return ((interfaceOrientation == UIInterfaceOrientationLandscapeLeft) || (interfaceOrientation == UIInterfaceOrientationPortrait));
} 
```

但它似乎没有做任何事情。我的 plist 支持除倒置之外的所有方向，并添加了 shouldautorotate 以仅允许在我想要的视图控制器中使用纵向。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-07T22:53:32.523

您在 ios6 中寻找的方法是`- (NSUInteger)supportedInterfaceOrientations`

这基本上取代了 shouldAutorotate。与 shouldAutorotate 结合使用。

# c# - 枚举应该包含无吗？

> ID：14759896
> 
> 赞同：3
> 
> 时间：2013-02-07T19:58:09.550
> 
> 标签：c#, coding-style, enums

我有时会看到`enum`这样的：

```
public enum Color {
    None, Black, Red, Blue
} 
```

代码如下：

```
Color color;

...

if (color == Color.None) ... 
```

我更喜欢使用可为空的枚举并将其编码如下：

```
public enum Color {
    Black, Red, Blue
}

...

Color? color;

...

if (color == null) ... 
```

哪种风格更受欢迎？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-02-07T19:59:50.167

一如既往，这取决于。

对于`[Flags]`枚举，`None`值几乎总是一个好主意，因为“这些选项都不是”是一个有用的概念。对于非`[Flags]`枚举，我通常不会包含一个`None`值，除非它在概念上明显有用。

也就是说，作为“开发类库的设计指南”一部分的[枚举指南包括：](http://msdn.microsoft.com/en-us/library/vstudio/ms229058%28v=vs.100%29.aspx)

> 请在简单枚举上提供零值。
> 
> 如果可能，将此值命名为 None。如果 None 不合适，请将值零分配给最常用的值（默认值）。

...虽然示例不包括`None`，并且 .NET 框架中的许多枚举也没有`None`值...

至于是否应该使用可为空的枚举 - 这真的取决于情况。我*会*使用一个`Color?`变量来表示“可能有一个`Color`值，或者可能没有”，因为它`None`真的*不是*一种明智的颜色。IMO ，*没有*`None`意味着`Enum.IsDefined(typeof(Color))`更有用。为什么枚举与任何其他不可为空的值类型不同？您通常不会使用 0 来表示“我们没有任何信息”——`int?`而是使用 an 。我建议以与您对待的方式一致的方式对待枚举`int`。

（说了这么多，我发现我在 Noda Time 中包含`None`了一个值`IsoDayOfWeek`，我觉得很惊讶，现在看着它。）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-08T00:09:13.053

我个人会避免像`None`颜色这样的东西。None 显然不是一种颜色，因此它在语义上是不正确的。每当发生这种情况时，您就会遇到麻烦。

例如，试着想象一种`Set`可能的颜色。`[ White, Black, Red ]`有道理，但显然`[ White, Black, None ]`没有。

`null`会更可取，尽管您也可以尝试解决该问题，例如`isPresent()`方法或类似的东西。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-07T19:59:49.930

这取决于您要赋予的含义是什么`None`。

`null`是未知的，null 可以是任何颜色或没有颜色，但我们不知道颜色。
虽然 None 听起来像已知的颜色：没有颜色。

所以..为您的应用程序选择正确的东西。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-07T20:27:24.820

如果它对您将颜色设置为没有颜色的任何对象都有效，我认为您应该将 None 作为选项，否则将其关闭。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-02-07T20:00:05.203

`None`结束`null`。`None`让猜测变得更加明显。你可以像这样使用它：`colorObject.None`. 但这是主观的，基于品味。

没有`color`所谓的“null”，但可以有一个 no- `color`（透明的？）。

# android - 如何在操作栏溢出菜单中对齐菜单项文本

> ID：14759897
> 
> 赞同：2
> 
> 时间：2013-02-07T19:58:17.157
> 
> 标签：android, android-layout, android-actionbar, actionbarsherlock

我正在使用 ActionBarSherlock 在我的 Android 应用程序中实现操作栏。不适合此操作栏的菜单选项会自动添加到溢出菜单中。我面临的问题是这些菜单选项具有中心对齐：

![在此处输入图像描述](../Images/8dc6f5b20fc9c3bbb917b2d8ecf7bf3a.png)

如何确保溢出菜单中的菜单项右对齐，例如在 Gmail 应用程序中？

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-09T11:56:29.620

没关系，我找到了原因。

事实证明我在我的主题中的某个地方设置了 TextView 的样式

```
<item name="android:gravity">center_horizontal</item> 
```

这也影响了菜单项。

# c# - 从 Windows Phone 向 php 发送数据

> ID：14759898
> 
> 赞同：0
> 
> 时间：2013-02-07T19:58:23.313
> 
> 标签：c#, php, .net, windows-phone-7, mobile

我需要通过 POST 方法将一些数据从 windows phone 7 发送到 php 页面，我在 wp7 端有以下代码

```
 public void SendPost()
    {
        var url = "http://localhost/HelpFello/profile.php";

        // Create the web request object
        HttpWebRequest webRequest = (HttpWebRequest)WebRequest.Create(url);
        webRequest.Method = "POST";
        webRequest.ContentType = "application/x-www-form-urlencoded";

        // Start the request
        webRequest.BeginGetRequestStream(new AsyncCallback(GetRequestStreamCallback), webRequest);
        MessageBox.Show("data sent");
    }

    void GetRequestStreamCallback(IAsyncResult asynchronousResult)
    {
        HttpWebRequest webRequest = (HttpWebRequest)asynchronousResult.AsyncState;
        // End the stream request operation
        Stream postStream = webRequest.EndGetRequestStream(asynchronousResult);

        // Create the post data
        // Demo POST data 
        string postData = "user_id=3&name=danish&email_id=mdsiddiquiufo&password=12345&phone_Number=0213&about_me=IRuel2&rating=5";

        byte[] byteArray = Encoding.UTF8.GetBytes(postData);

        // Add the post data to the web request
        postStream.Write(byteArray, 0, byteArray.Length);
        postStream.Close();

        // Start the web request
        webRequest.BeginGetResponse(new AsyncCallback(GetResponseCallback), webRequest);
    }

    void GetResponseCallback(IAsyncResult asynchronousResult)
    {
        try
        {
            HttpWebRequest webRequest = (HttpWebRequest)asynchronousResult.AsyncState;
            HttpWebResponse response;

            // End the get response operation
            response = (HttpWebResponse)webRequest.EndGetResponse(asynchronousResult);
            Stream streamResponse = response.GetResponseStream();
            StreamReader streamReader = new StreamReader(streamResponse);
            var Response = streamReader.ReadToEnd();
            streamResponse.Close();
            streamReader.Close();
            response.Close();

        }
        catch (WebException e)
        {
            MessageBox.Show(e.ToString());
        }
    } 
```

并跟随我的本地主机，将数据发送到数据库

```
<?php
require_once("constants.php");
$user_id = $_POST['user_id'];
$name = $_POST['name'];
$email_id = $_POST['email_id'];
$password = $_POST['password'];
$phone_number = $_POST['phone_number'];
$about_me = $_POST['about_me'];
$rating = $_POST['rating'];

$query="INSERT INTO profile(User_ID,Name,Email_ID,password,Phone_Number,About_Me,Rating) VALUES ({$user_id},'{$name}','{$email_id}','{$password}',{$phone_number}, '{$about_me}' , {$rating})";
mysql_query($query,$connection);
mysql_close($connection);
?> 
```

当我运行代码时，我没有错误，这意味着代码工作正常，但没有数据插入到数据库中。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-08T10:24:44.943

我认为有比 HttpWebRequest 更好的方法。那就是WebClient。您可以在那里更改方法并像在获取字符串中那样附加数据。key=value&key2=value 然后当您调用该请求并获得响应时，请尝试调试并从 VS 获取输出，或者如果这很困难，只需将他的字符串分配给代码中的文本块。您将了解该页面是否曾经执行过。

示例代码：

```
WebClient wc = new WebClient();
wc.UploadStringCompleted += new UploadStringCompletedEventHandler(wc_UploadStringCompleted);
wc.Headers["Content-Type"] = "application/x-www-form-urlencoded";
wc.Encoding = Encoding.UTF8;

Parameters prms = new Parameters();
prms.AddPair("email", email);
prms.AddPair("password", password);

wc.UploadStringAsync(new Uri(loginUrl), "POST", prms.FormPostData(), null);

private void wc_UploadStringCompleted(object sender, UploadStringCompletedEventArgs e)
{
        // e.Result will contain the page's output
}

// This is my Parameters and Parameter Object classes

public class Parameters
{
public List<ParameterObject> prms;

        public Parameters()
        {
            prms = new List<ParameterObject>();
        }

        public void AddPair(string id, string val)
        {
            prms.Add(new ParameterObject(id, val));
        }

        public String FormPostData()
        {
            StringBuilder buffer = new StringBuilder();

            for (int i = 0; i < prms.Count; i++)
            {
                if (i == 0)
                {
                    buffer.Append(System.Net.HttpUtility.UrlEncode(prms[i].id) + "=" + System.Net.HttpUtility.UrlEncode(prms[i].value));
                }
                else
                {
                    buffer.Append("&" + System.Net.HttpUtility.UrlEncode(prms[i].id) + "=" + System.Net.HttpUtility.UrlEncode(prms[i].value));
                }
            }

            return buffer.ToString();
        }
    }

public class ParameterObject
{
    public string id;
    public string value;

    public ParameterObject(string id, string val)
    {
        this.id = id;
        this.value = val;
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-07T20:00:46.317

第一个错误：假设没有错误信息意味着成功

第二个错误：打开[SQL 注入孔](http://bobby-tables.com)

第一个修复：始终假设查询将失败，并检查该条件：

```
$result = mysql_query($query) or die(mysql_error()); 
```

第二个修复：放弃 mysql_ *() 函数并使用带有占位符的准备好的语句切换到 PDO。繁荣。*没有更多的注入问题，并且在未来的 PHP 版本中删除*mysql_ () 时，您的代码不会停止对您的工作。*

ps..

第三个错误：您的电话号码值没有引号。所以有人提交了 867-5309，你最终插入了 -4442，因为 mysql 认为它是两个数字相减，而不是一个字符串。

# c# - Raspberry Pi 上 Linux 环境中的 Windows 窗体错误

> ID：14759899
> 
> 赞同：2
> 
> 时间：2013-02-07T19:58:27.023
> 
> 标签：c#, linux, winforms, mono, raspberry-pi

我已经用 C# 开发了一个完整的应用程序，它完全可以在 Windows 中运行。我现在已经在 Linux（RPi 上的 Debian）上安装了 mono，并且正在执行该应用程序。

第一个表单（登录表单）加载得很好。在此表单上输入用户详细信息，如果详细信息正确，则应关闭该表单并打开下一个。

以下代码来自登录表单，一旦我按下“登录”就会执行：

```
this.Hide();
Entry_System fm = new Entry_System();
fm.ShowDialog();
this.Show(); 
```

但是，在 Linux 中，表单刚刚关闭，并出现以下错误：

> System.TypeLoadException：发生类型加载异常。在 System.Windows.Forms.Control.OnClick (System.EventArgs e) [0x00000] 在 System.Windows.Forms.Button.OnClick (System.EventArgs e) [0x00000] 在 System.Windows.Forms.Button.OnClick (System.EventArgs e) [0x00000] 在 System.Windows.Forms .ButtonBase.OnMouseUp (System.Windows.Forms.MouseEventArgs 事件) [0x00000] 在 System.Windows.Forms.Button.OnMouseUp (System.Windows.Forms.MouseEventArgs 事件) [0x00000] in :0 在 System.Windows .Forms.Control.WmLButtonUp (System.Windows.Forms.Message& m) [0x00000] 在 System.Windows.Forms.Control.WndProc (System.Windows.Forms.Message& m) [0x00000] 在 System.Windows.Forms.Control.WndProc (System.Windows.Forms.Message& m) [0x00000] 在系统:0 .Windows.Forms.ButtonBase.WndProc (System.Windows.Forms.Message& m) [0x00000] in :0 System.Windows.Forms.Button.WndProc (System.Windows.Forms.Message& m) [0x00000] in :0在系统。

在 Windows 中，下一个表单会按预期打开。通过复选框选择的任何一种形式都是这种情况。

我已经运行了 apt-get update，apt-get mono complete，所以它们是最新版本。该应用程序是在 Windows 上编译的。我知道 mono 一直是一个很好的讨论主题，并且在 Pi 上存在一些问题，但据我了解，像这样的基本功能在 Soft Float Debian 上应该可以正常工作。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-08T21:10:25.797

您可能遇到了[这个错误](https://bugzilla.xamarin.com/show_bug.cgi?id=8903)，该错误在 Mono 3.0.3 中已修复。

我不认为 apt-get 确保你得到这样一个新版本。您可以通过运行命令“mono --version”来确认。

# r - 数据表和并行计算

> ID：14759905
> 
> 赞同：42
> 
> 时间：2013-02-07T19:58:48.417
> 
> 标签：r, parallel-processing, data.table

在这篇文章之后：[multicore and data.table in R](https://stackoverflow.com/questions/14697670/multicore-and-data-table-in-r)，我想知道在使用 data.table 时是否有办法使用所有内核，通常按组进行计算可以并行化。似乎`plyr`允许这样的操作是设计的。

* * *

## 回答 #1

> 赞同：56
> 
> 时间：2013-02-08T00:19:30.660

首先要检查的是`data.table`常见问题 3.1 第 2 点已被纳入：

> 仅对最大的组进行一次内存分配，然后将该内存重新用于其他组。可以收集的垃圾很少。

这就是 data.table 分组很快的原因之一。但是这种方法不适合并行化。并行化意味着将数据复制到其他线程，而不是花费时间。但是，我的理解是`data.table`分组通常比`plyr`on`.parallel`更快。这取决于每组任务的计算时间，以及是否可以轻松减少该计算时间。移动数据通常占主导地位（当对大数据任务的 1 或 3 次运行进行基准测试时）。

更常见的是，到目前为止，实际上是一些问题`j`在`[.data.table`. 例如，最近我们看到`data.table`分组性能不佳，但罪魁祸首是`min(POSIXct)`（[在 R 中聚合超过 80K 唯一 ID](https://stackoverflow.com/questions/14590596/aggregating-in-r-over-80k-unique-ids)）。避免这个问题产生了超过 50 倍的加速。

**所以咒语是： `Rprof`, `Rprof`, `Rprof`.**

此外，同一常见问题解答中的第 1 点可能很重要：

> 只有该列被分组，其他 19 列被忽略，因为 data.table 检查 j 表达式并意识到它不使用其他列。

因此，`data.table`实际上根本不遵循拆分-应用-组合范式。它的工作方式不同。split-apply-combine 适合并行化，但它确实不能扩展到大数据。

另请参阅 data.table intro vignette 中的脚注 3：

> 我们想知道有多少人将并行技术部署到矢量扫描代码中

那是在说“当然，并行速度要快得多，但是使用有效的算法真正需要多长时间？”。

但是，如果您已经分析（使用`Rprof`），并且每个组的任务*确实是*计算密集型的，那么 datatable-help 上的 3 个帖子（包括“多核”一词可能会有所帮助：

[数据表帮助上的多核帖子](http://r.789695.n4.nabble.com/template/NamlServlet.jtp?macro=search_page&node=2315188&query=multicore&n=2315188)

当然，有很多任务在 data.table 中并行化会很好，并且有一种方法可以做到这一点。但它还没有完成，因为通常其他因素会咬人，所以它的优先级很低。如果您可以发布带有基准和 Rprof 结果的可重现虚拟数据，那将有助于提高优先级。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2017-06-28T23:22:57.487

我已经按照@matt dowle 之前的**Rprof、Rprof、Rprof 口头禅做了一些测试。**

我发现并行化的决定取决于上下文。但可能很重要。根据测试操作（例如`foo`下面，可以定制）和使用的核心数量（我尝试 8 和 24），我得到不同的结果。

## 结果如下：

1.  使用 8 个内核，我看到此示例中的并行化**提高了 21%**
2.  使用 24 个核心，我看到**了 14% 的改进**。

我还查看了一些真实世界（不可共享）的数据/操作，这些数据/操作显示了与 24 个内核并行的更大（`33%`或两个不同的测试）改进。**2018 年 5 月编辑**一组新的真实示例案例显示，与 1000 个组的并行操作相比，改进了接近 85%。`25%`

 **```
R> sessionInfo() # 24 core machine:
R version 3.3.2 (2016-10-31)
Platform: x86_64-pc-linux-gnu (64-bit)
Running under: CentOS Linux 7 (Core)

attached base packages:
[1] parallel  stats     graphics  grDevices utils     datasets  methods
[8] base

other attached packages:
[1] microbenchmark_1.4-2.1 stringi_1.1.2          data.table_1.10.4

R> sessionInfo() # 8 core machine:
R version 3.3.2 (2016-10-31)
Platform: x86_64-apple-darwin13.4.0 (64-bit)
Running under: macOS Sierra 10.12.4

attached base packages:
[1] parallel  stats     graphics  grDevices utils     datasets  methods   base     

other attached packages:
[1] microbenchmark_1.4-2.1 stringi_1.1.5          data.table_1.10.4 
```

## 下面的例子：

```
library(data.table)
library(stringi)
library(microbenchmark)

set.seed(7623452L)
my_grps <- stringi::stri_rand_strings(n= 5000, length= 10)

my_mat <- matrix(rnorm(1e5), ncol= 20)
dt <- data.table(grps= rep(my_grps, each= 20), my_mat)

foo <- function(dt) {
  dt2 <- dt ## needed for .SD lock
  nr <- nrow(dt2)

  idx <- sample.int(nr, 1, replace=FALSE)

  dt2[idx,][, `:=` (
    new_var1= V1 / V2,
    new_var2= V4 * V3 / V10,
    new_var3= sum(V12),
    new_var4= ifelse(V10 > 0, V11 / V13, 1),
    new_var5= ifelse(V9 < 0, V8 / V18, 1)
  )]

  return(dt2[idx,])
}

split_df <- function(d, var) {
  base::split(d, get(var, as.environment(d)))
}

foo2 <- function(dt) {
  dt2 <- split_df(dt, "grps")

  require(parallel)
  cl <- parallel::makeCluster(min(nrow(dt), parallel::detectCores()))
  clusterExport(cl, varlist= "foo")
  clusterExport(cl, varlist= "dt2", envir = environment())
  clusterEvalQ(cl, library("data.table"))

  dt2 <- parallel::parLapply(cl, X= dt2, fun= foo)

  parallel::stopCluster(cl)
  return(rbindlist(dt2))
}

print(parallel::detectCores()) # 8

microbenchmark(
  serial= dt[,foo(.SD), by= "grps"],
  parallel= foo2(dt),
  times= 10L
)

Unit: seconds
     expr      min       lq     mean   median       uq      max neval cld
   serial 6.962188 7.312666 8.433159 8.758493 9.287294 9.605387    10   b
 parallel 6.563674 6.648749 6.976669 6.937556 7.102689 7.654257    10  a 

print(parallel::detectCores()) # 24

Unit: seconds
     expr       min        lq     mean   median       uq      max neval cld
   serial  9.014247  9.804112 12.17843 13.17508 13.56914 14.13133    10   a
 parallel 10.732106 10.957608 11.17652 11.06654 11.30386 12.28353    10   a 
```

## 分析：

我们可以使用[这个答案](https://stackoverflow.com/questions/3650862/how-to-efficiently-use-rprof-in-r/32742799#32742799)对@matt dowle 对分析的原始评论提供更直接的回应。

结果，我们确实看到大部分计算时间是由`base`而不是由 处理的`data.table`。`data.table`正如预期的那样，操作本身非常快。虽然有些人可能会争辩说，这证明了内部不需要并行性`data.table`，但我认为这个工作流/操作集并不是非典型的。也就是说，我强烈怀疑大多数大型`data.table`聚合都包含大量非`data.table`代码；并且这与交互式使用与开发/生产使用相关。因此，我得出结论，并行性`data.table`对于大型聚合是有价值的。

```
library(profr)

prof_list <- replicate(100, profr::profr(dt[,foo(.SD), by= "grps"], interval = 0.002),
                       simplify = FALSE)

pkg_timing <- fun_timing <- vector("list", length= 100)
for (i in 1:100) {
  fun_timing[[i]] <- tapply(prof_list[[i]]$time, paste(prof_list[[i]]$source, prof_list[[i]]$f, sep= "::"), sum)
  pkg_timing[[i]] <- tapply(prof_list[[i]]$time, prof_list[[i]]$source, sum)
}

sort(sapply(fun_timing, sum)) #  no large outliers

fun_timing2 <- rbindlist(lapply(fun_timing, function(x) {
  ret <- data.table(fun= names(x), time= x)
  ret[, pct_time := time / sum(time)]
  return(ret)
}))

pkg_timing2 <- rbindlist(lapply(pkg_timing, function(x) {
  ret <- data.table(pkg= names(x), time= x)
  ret[, pct_time := time / sum(time)]
  return(ret)
}))

fun_timing2[, .(total_time= sum(time),
                avg_time= mean(time),
                avg_pct= round(mean(pct_time), 4)), by= "fun"][
  order(avg_time, decreasing = TRUE),][1:10,]

pkg_timing2[, .(total_time= sum(time),
                avg_time= mean(time),
                avg_pct= round(mean(pct_time), 4)), by= "pkg"][
  order(avg_time, decreasing = TRUE),] 
```

**结果：**

```
 fun total_time avg_time avg_pct
 1:               base::[    670.362  6.70362  0.2694
 2:      NA::[.data.table    667.350  6.67350  0.2682
 3:       .GlobalEnv::foo    335.784  3.35784  0.1349
 4:              base::[[    163.044  1.63044  0.0655
 5:   base::[[.data.frame    133.790  1.33790  0.0537
 6:            base::%in%    120.512  1.20512  0.0484
 7:        base::sys.call     86.846  0.86846  0.0348
 8: NA::replace_dot_alias     27.824  0.27824  0.0112
 9:           base::which     23.536  0.23536  0.0095
10:          base::sapply     22.080  0.22080  0.0089

          pkg total_time avg_time avg_pct
1:       base   1397.770 13.97770  0.7938
2: .GlobalEnv    335.784  3.35784  0.1908
3: data.table     27.262  0.27262  0.0155 
```

交叉发布在[github/data.table](https://github.com/Rdatatable/data.table/issues/2223)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2019-03-10T01:44:49.233

**是**的（不过，这可能不值得，正如@Alex W 所指出的那样）。

下面提供了一个简单的模式来做到这一点。为简单起见，我使用了一个不值得的示例（使用`mean`函数），但它显示了模式。

例子：

假设您想按 iris 数据集中的 Species 计算 Petal.Length 的平均值。

您可以直接使用 data.table 来完成它：

```
as.data.table(iris)[by=Species,,.(MPL=mean(Petal.Length))]
      Species   MPL
1:     setosa 1.462
2: versicolor 4.260
3:  virginica 5.552 
```

但是，如果`mean`是一个足够长时间运行且昂贵的计算（可能由分析确定，尽管有时它只是“显而易见的”），您可能喜欢使用`parallel::mclapply`. 由于最小化与 mclapply 生成的所有子进程的通信可以大大减少整体计算，而不是将选择从 data.table 传递到每个子进程，您只想传递选择的索引。此外，通过首先对 data.table 进行排序，您可以只传递这些索引的范围（最大值和最小值）。像这样：

```
> o.dt<-as.data.table(iris)[order(Species)] # note: iris happens already to be ordered
> i.dt<-o.dt[,by=Species,.(irange=.(range(.I)))]
> i.dt
      Species  irange
1:     setosa    1,50
2: versicolor  51,100
3:  virginica 101,150

> result<-mclapply(seq(nrow(i.dt)),function(r) o.dt[do.call(seq,as.list(i.dt[r,irange][[1]])),.(MPL=mean(Petal.Length))])
> result
[[1]]
     MPL
1: 1.462

[[2]]
    MPL
1: 4.26

[[3]]
     MPL
1: 5.552

> result.dt<-cbind(i.dt,rbindlist(result))[,-2]
> result.dt
      Species   MPL
1:     setosa 1.462
2: versicolor 4.260
3:  virginica 5.552 
```

回顾模式：

*   订购输入。
*   计算每个组的索引范围。
*   定义一个匿名`function`来提取包含组成员的行，并执行所需的计算（在本例中为均值）。
*   在索引范围的行索引上使用 mclapply 将该函数应用于每个组。
*   用于`rbindlist`将结果作为 data.table 获取，将其放入`cbind`输入，然后将其删除索引列（除非您出于其他原因需要保留它们）。

笔记：

*   决赛`rbindlist`通常很昂贵，可能会根据您的应用程序跳过）。

去做：

*   让 data.table 团队相信这个模式足够通用和有用，额外的 data.table 索引选项应该调用它。想象一下，传递 mc=TRUE 将调用此模式，并在...中支持其他并行选项

```
iris.dt[by=Species,,.(MPL=mean(Petal.Length)), mc=TRUE, mc.preschedule=FALSE, mc.set.seed=TRUE,...] 
```**

# c# - 添加事件到控件添加动态

> ID：14759908
> 
> 赞同：0
> 
> 时间：2013-02-07T19:58:50.320
> 
> 标签：c#, asp.net

我正在为 webForm 使用 asp.net 和 c#。我正在动态生成一个 dropDownList，但我无法为此控件执行事件。下面是一些代码：

```
DropDownList nuevoCmb = new DropDownList();
nuevoCmb.ID = "ddl" + num;
nuevoCmb.Items.Add("---Seleccione el Plazo---");
nuevoCmb.Items.Add("Corto Plazo");
nuevoCmb.SelectedIndex = 0;
nuevoCmb.AutoPostBack = true;
nuevoCmb.SelectedIndexChanged += new EventHandler(nuevoCmb_OnSelectedIndexChanged);
MainPanel.Controls.Add(nuevoCmb);

protected void nuevoCmb_OnSelectedIndexChanged(object sender, EventArgs e)
{
    string temp = "";
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-07T20:03:45.967

您需要将创建控件的代码添加到每个页面请求，包括回发。如果控件导致回发并且未调用重新创建控件的代码，则您的事件处理程序将不会触发。一旦在页面加载期间添加了具有相同 ID 的控件，.NET 最终将调用您的事件处理程序。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-07T20:04:55.463

`Init`您应该在页面事件中或之前添加动态添加的控件。如果您在页面`Load`事件期间添加，它也可以工作。事件发生后`Load`，您的自定义控件事件会冒泡并触发。因此，如果您要动态添加控件，则必须在每个回帖中添加它们，`Load`最迟在页面事件结束之前加载它们。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-11T12:41:20.800

我在以下页面中找到了答案：[在 ASP.Net 中创建动态下拉列表控件](http://www.aspsnippets.com/articles/creating-dynamic-dropdownlist-controls-in-asp.net.aspx)

此示例功能齐全，但只有一个 asp html 页面，无法使用母版页。任何建议！

# java - 在 Window 7 中调整 JFrame 的大小 - Java

> ID：14759911
> 
> 赞同：2
> 
> 时间：2013-02-07T19:59:01.570
> 
> 标签：java

我对在 Windows 7 中调整 JFrame 的大小有疑问，

在我将框架拖到窗口/监视器顶部并释放鼠标按钮后，有时框架会卡住/冻结，有时则不会。所以我需要拖动框架来解开它

什么问题，如何解决？

黑色是帧被冻结时

![在此处输入图像描述](../Images/64a0af755ab205698fae6eb17a1682f6.png)

```
import javax.swing.JFrame;
import javax.swing.SwingUtilities;

public class JFrameTest extends JFrame
{
    public JFrameTest()
    {
        setTitle("Frame Example");
        setSize(300, 200);
        setDefaultCloseOperation(EXIT_ON_CLOSE);
        setLocationRelativeTo(null);
    }

    public static void main(String[] args)
    {
        SwingUtilities.invokeLater(new Runnable()
        {
            public void run()
            {
                new JFrameTest().setVisible(true);
            }
        });
    }
} 
```

所以我在调整这个程序的大小后得到这个结果... [http://img10.imageshack.us/img10/652/35945338.png](http://img10.imageshack.us/img10/652/35945338.png)

# wpf - WPF 绑定到 CurrentItem

> ID：14759915
> 
> 赞同：1
> 
> 时间：2013-02-07T19:59:12.383
> 
> 标签：wpf, data-binding

我有一个 WPF 模型，它包含一个视图源、一个列表视图和一个按钮，用于在视图模型中为列表视图中选择的项目执行 ICommand。

```
<Window.Resources>
    <CollectionViewSource x:Key="teachingSessionsViewSource" d:DesignSource="{d:DesignInstance {x:Type local:TeachingSessionListItem}, CreateList=True}"/>
</Window.Resources>
...
    <GroupBox Header="All Sessions" 
              DataContext="{Binding Source={StaticResource teachingSessionsViewSource}}">
        <StackPanel>
            <ListView x:Name="TeachingSessionList" 
                      ItemsSource="{Binding}"
                      SelectedItem="{Binding Path=/}">
                <ListView.View>
                    <GridView ColumnHeaderContainerStyle="{StaticResource noHeaderStyle}">
                        <GridViewColumn DisplayMemberBinding="{Binding SessionDate}"/>
                        <GridViewColumn DisplayMemberBinding="{Binding PresenterInitials}" Width="30" />
                    </GridView>
                </ListView.View>
            </ListView>
            <Button Content="Un-Assign" Margin="5,5" Command="{Binding Path=/UnAssignPresentation}" 
        </StackPanel>
    </GroupBox> 
```

问题是 ICommand UnAssignPresentation 总是在列表中的第一个项目上执行，而不管在列表视图中选择了哪个项目。也就是说，CollectionViewSource 的 currentItem 属性似乎没有绑定到 ListView。

我究竟做错了什么？非常感谢你。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-07T20:09:11.217

尝试添加`IsSynchronizedWithCurrentItem="True"`到您的 ListView。

此外，更喜欢将 listview 绑定到视图模型中的集合而不是资源。
然后，您可以将属性添加到所选项目的视图模型，
并将列表视图的所选项目绑定到视图模型中的该属性，
并将按钮的命令绑定到视图模型中作用于当前项目的命令，
或者传递您要通过绑定到所选项目的命令参数来操作的项目。

# php - 检查上个月存在的行（比较两个月之间的数据）其中数字=某个值

> ID：14759917
> 
> 赞同：1
> 
> 时间：2013-02-07T19:59:15.860
> 
> 标签：php, mysql

小木桌

```
number    name         price         month         year
152       cheese       25            10            12
153       yogurt       12            10            12
152       cheese       22            11            12
153       yogurt       15            11            12
154       apples       30            11            12 
```

我目前有以下查询，它正在比较两个月之间的行。

```
select a.price as p1, b.price as p2, a.distributor, a.number, a.name, (a.price - b.price) as pdiff from ogi a, ogi b where a.number = b.number and a.month = '" . $from_date . "' and b.month = '" . $to_date . "' and a.distributor = '" . $distributor . "' 
```

我现在正在尝试检查上个月是否不存在一行，以回应“不存在”或类似的内容。

那么，如何**检查上个月是否不存在编号 154 的行**（*在上表中找到*）并回显“不存在”？

谢谢您的帮助！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-07T20:32:15.253

如果您需要检查每个月与上个月的价格差异，我会这样写您的查询：

```
SELECT
  a.*,
  b.price,
  case when b.number is not null
            then a.price-b.price
            else 'did not exist' end as priceDiff
FROM
  ogi a left join ogi b
  on a.number=b.number
     and b.year  = case when a.month=1
                             then a.year-1
                             else a.year end
     and b.month = case when a.month=1
                             then 12
                             else a.month-1 end
ORDER BY
  a.number, a.month 
```

这会将每个项目的每个价格与上个月的价格进行比较，如果上个月没有行，将返回“不存在”。

请看[这个小提琴](http://sqlfiddle.com/#!2/6ad55/6)。

**编辑：**我更新了我的答案，我想你正在寻找这个：

```
SELECT
  names.number,
  names.name,
  a.price pricea,
  b.price priceb,
  case when a.number is null then 'does not exist'
       when b.number is null then 'did not exist'
       else a.price-b.price end as priceDiff
FROM
  (select distinct number, name
   from ogi
   where (year=12 and month=11) or
         (year=12 and month=10)) names
   left join ogi a on names.number=a.number and a.month=11 and a.year=12
   left join ogi b on names.number=b.number and b.month=10 and b.year=12
ORDER BY
  a.number, a.month 
```

请注意，我不考虑年份，但如果需要，我可以更新查询。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-07T20:26:36.020

使用`LEFT JOIN`：

```
SELECT a.price AS p1, b.price AS p2, a.distributor, a.number, IFNULL(a.name, 'Does not exist') AS name, (a.price - IFNULL(b.price, 0)) AS pdiff
FROM ogi a
LEFT JOIN ogi b ON b.number = a.number
WHERE a.month = '$from_date' AND b.month = '$to_date' AND a.distributor = '$distributor' 
```

我强烈建议您更改表结构以使其标准化。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-07T20:32:18.663

我相信您正在寻找的是内部选择。以下伪查询说明了如何获取当月之前不存在的任何数据

```
SELECT * 
FROM table 
WHERE id NOT IN 
    (
        SELECT id 
        FROM table 
        WHERE created < var_containing_first_of_current_month
    ) 
```

# node.js - 将 Node.JS 应用程序部署到 Heroku - 缓存问题？

> ID：14759923
> 
> 赞同：1
> 
> 时间：2013-02-07T19:59:20.273
> 
> 标签：node.js, heroku, npm

我目前正在尝试将我的应用程序推送到 Heroku。我已经能够部署它几次，但现在我已经在我的 packages.json 文件中将 mongoose 从 ">= 3.5.0" 更新为 ">= 3.6.0rc0" 。但是，3.6 版需要 mpath 和 mpromise。

当 slug 编译开始时，它使用缓存版本的猫鼬或其他东西，当我的应用程序启动时，我得到“错误：找不到模块'mpath'”。

我试图设置一个自定义 buildpack Git 来停止缓存，我只是在 bin/compile 中注释掉了缓存内容，可在此处获得：[https ://github.com/jValdron/heroku-buildpack-nodejs](https://github.com/jValdron/heroku-buildpack-nodejs)

这是推送的输出：http: [//pastebin.com/L3Yqy2NR](http://pastebin.com/L3Yqy2NR)

此外，当我从 package.json 中删除一些依赖项时，如果我使用“heroku run bash”登录，我可以看到那些在 node_modules 中删除的依赖项。我已经尝试删除 node_modules 文件夹并执行另一个“git push”，但也没有用。而那些被移除的 deps 仍然在 node_modules 中。

任何人都知道如何解决这个问题？

编辑：

这是我的 package.json 文件：

```
{
    "name": "souply-api",
    "version": "0.1.0",
    "author": "Jason Valdron <jason.valdron@orangesprocket.com>",
    "description": "Main gears that runs the Soup.ly application",
    "dependencies": {
        "bcrypt": ">= 0.7.3",
        "express": ">= 3.0.5",
        "extend": ">= 1.1.3",
        "imagemagick": ">= 0.1.3",
        "jade": ">= 0.27.7",
        "knox": ">= 0.4.6", 
        "less": ">= 1.3.1",
        "less-middleware": ">= 0.1.9",
        "moment": ">= 1.7.2",
        "mongoose": ">= 3.6.0rc0", 
        "mongoose-types": ">= 1.0.3",
        "node-native-zip": ">= 1.1.0",
        "nodemailer": ">= 0.3.37",
        "oauth2orize": ">= 0.1.0",
        "passport": ">= 0.1.15",
        "passport-local": ">= 0.1.6",
        "passport-google": ">= 0.2.0",
        "passport-facebook": ">= 0.1.4",
        "passport-twitter": ">= 0.1.4",
        "passport-http": ">= 0.2.1",
        "passport-http-bearer": ">= 0.2.0",
        "passport-oauth2-client-password": ">= 0.1.0",
        "poor-form": ">= 1.1.3",
        "request": ">= 2.12.0",
        "socket.io": ">= 0.9.13"
    },
    "engines": {
        "node": "0.8.x",
        "npm": "1.1.x"
    }
} 
```

Mongoose 设置为 3.6.0rc，如前所述。Mpath 是 Mongoose 的 package.json 文件中的一个依赖项。如果我查看我的本地 mongoose package.json 文件，我可以看到：

```
"dependencies": {
    "hooks": "0.2.1"
  , "mongodb": "1.2.11"
  , "ms": "0.1.0"
  , "sliced": "0.0.3"
  , "muri": "0.3.0"
  , "mpromise": "0.2.0"
  , "mpath": "0.1.1"
} 
```

此外，如果我使用 登录`heroku run bash`并导航到`node_modules/mongoose/node_modules`我会看到 mpath 和 mpromise 不存在。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-08T13:49:30.033

node_modules 在 Git 存储库中。通过从 repo 中删除它，它工作正常。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2017-02-21T17:10:50.043

现在 heroku 支持禁用 node_modules 的缓存：[https ://devcenter.heroku.com/articles/nodejs-support#cache-behavior](https://devcenter.heroku.com/articles/nodejs-support#cache-behavior)

> Heroku 维护一个缓存目录，该目录在构建之间持久化。此缓存用于存储 npm、yarn 和 bower 的缓存。如果您愿意，可以禁用 Node.js 应用程序的所有缓存：

`heroku config:set NODE_MODULES_CACHE=false git commit -am 'disable node_modules cache' --allow-empty git push heroku master`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-08T02:44:02.787

您需要将您的 package.json 更新为您正在使用的最新版本的 mongoose

您还需要将 mpath 添加到您的 package.json 中（在 mongoose 条目之前）

你可以发布你的 package.json 文件吗？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-08-28T20:55:22.077

删除 node_modules 的缓存并重新部署它：

```
git rm -r --cached node_modules 
```

进而`git push heroku master`

如果您不想在重新部署时缓存 node_module，也可以禁用缓存：

```
heroku config:set NODEMODULESCACHE=false
git commit -am 'rebuild' --allow-empty
git push heroku master
heroku config:unset NODEMODULESCACHE 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2017-12-16T09:45:58.203

更改 package.json 中的 Node 版本为我做了这件事。

例如：

```
"engines": {
    "node": "9.2.1"
} 
```

# mysql - 如何将 GROUP_CONCAT 与 MATCH 一起使用，但仍显示 GROUP_CONCAT 中的所有项目？

> ID：14759925
> 
> 赞同：3
> 
> 时间：2013-02-07T19:59:37.687
> 
> 标签：mysql

我目前正在处理一个 MySQL 查询，该查询从我的数据库中的三个表中提取信息：`category` `category_industry`和`industry`. 它们基于 ID 相关，例如：

```
category            category_industry        industry
------------------  ------------------       ------------------
ID | Title          c_id | i_id              ID | Title
 1 | Fab Floor         1 |    1               1 | Beef
                       1 |    2               2 | Pork 
```

该`category_industry`表按类别的 ID 和行业列出了一个类别所属的行业。我正在做的是获取每个行业的 ID，并从`industry`表格中提取该行业的名称。我用一个`GROUP_CONCAT`语句把标题放在一起。如果不在查询中进行搜索，结果应该是这样的，并且看起来确实如此：

```
Fabrication Floor
(Beef, Pork) 
```

但是，如果我进行搜索，并且其中一个标题在搜索中匹配，它将只显示该标题，而不是所有标题。如果我正在搜索“牛肉”，这是我的查询：

```
SELECT *,
    GROUP_CONCAT(i.industry_title ORDER BY i.industry_title ASC SEPARATOR ', ') AS industries,
    MATCH (c.category_title, c.category_details) AGAINST ('Beef*' IN BOOLEAN MODE) AS cscore,
    MATCH (i.industry_title) AGAINST ('Beef*' IN BOOLEAN MODE) AS iscore,
    c.category_id AS cat_id
FROM category c
LEFT JOIN category_industry t  ON t.category_id = c.category_id
LEFT JOIN industry i ON i.industry_id = t.industry_id
WHERE
    MATCH (c.category_title, c.category_details) AGAINST ('Beef*' IN BOOLEAN MODE)
    OR MATCH (i.industry_title) AGAINST ('Beef*' IN BOOLEAN MODE)
    GROUP BY c.category_id
    ORDER BY (cscore + iscore) DESC, c.added_date ASC 
```

此查询提供以下结果：

```
Fabrication Floor
(Beef) 
```

它将显示该`Beef`行业中的所有类别，但会从列表中删除所有其他行业。我希望它仍能展示其他行业。

有谁知道我的问题的解决方案？我尝试过很多不同的方式重写我的陈述，但似乎无法让列表保持完整。先感谢您。

# jquery - 从多个滑块设置和获取值

> ID：14759926
> 
> 赞同：0
> 
> 时间：2013-02-07T19:59:42.897
> 
> 标签：jquery, post, slider

我的问题是关于以下小提琴：

```
`http://jsfiddle.net/yijiang/Y5ZLL/4/ 
```

fiddle实际上取400为最大值，四个滑块的总和不超过400。上面fiddle附有两个问题：

1.  如何在表单发布后获取每个 jQuery 滑块值。
2.  如何为每个滑块设置不同的初始值，因为我也将使用同一页面来更新数据库中的值？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-07T20:19:41.123

好吧，如果您使用的是 ajax，那么您可以，如果您使用的是平面旧表单，那么您不能，您必须创建一个与每个滑块关联的隐藏字段，以便将值带到服务器端文件。

# objective-c - 以编程方式将 NSTableColumn 绑定到 NSArrayController

> ID：14759929
> 
> 赞同：0
> 
> 时间：2013-02-07T19:59:45.423
> 
> 标签：objective-c, cocoa, binding, nstableview

如何以编程方式将 NSTableViewColumn 绑定到 NSArrayController？我有一个表，其中有 2 列已经绑定到数组控制器。但我在运行时添加新列，这些需要绑定到arraycontroller 的排列对象。它是一个基于单元的 NSTableview。我只在网上找到了此代码，但无法使其工作..

```
 NSString *akey = @"somekey";
 NSString *keypath = [NSString stringWithFormat:@"arrangedObjects.%@",akey];
 [newColumn bind:@"value" toObject:arrayController withKeyPath:keypath options:nil]; 
```

我不确定“绑定：”部分并且不理解苹果文档，这表示我必须公开绑定..

任何帮助表示赞赏。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-08T18:13:41.547

用 NSValueBinding 替换“值”应该可以

# functional-programming - OCaml 中的简单非最优 unionfind

> ID：14759932
> 
> 赞同：1
> 
> 时间：2013-02-07T19:59:53.410
> 
> 标签：functional-programming, ocaml

`union find`我为算法编写了一个 OCaml 程序。我写的这个算法不是最优的，是最简单的版本。

我把我的 OCaml 代码放在这里是因为我不确定这段代码是否足够好**（尽管有算法本身）**，尽管这段代码可以毫无错误地运行。

这是我开始学习 OCaml 后第一次写一个完整的工作的东西，所以请通过复习帮助我。

**有用的建议将帮助我提高我的 OCaml 技能。谢谢**

* * *

```
type union_find = {id_ary : int array; sz_ary : int array};;

let create_union n = {id_ary = Array.init n (fun i -> i); 
                  sz_ary = Array.init n (fun i -> 1)};;

let union u p q = 
  let rec unionfy id_ary i = 
    let vp = id_ary.(p) in
    let vq = id_ary.(q) in
    if i < Array.length id_ary then begin 
      if i != q && id_ary.(i) = vp then id_ary.(i) <- vq;
      unionfy id_ary (i + 1)
    end 
    else print_string "end of union\n"
  in
  unionfy u.id_ary 0;;

let is_connected u p q = u.id_ary.(p) = u.id_ary.(q);; 
```

* * *

首先，

**我是否正确创建`union`（如`union find`）的数据结构？**

**我应该在里面包含两个数组还是有更好的方法？**

* * *

第二，

我`array`在这段代码中使用，但是这`array`不是`mutable`很好`fp`吗？

**有没有办法避免使用数组？**

* * *

最后，

总的来说，这段代码足够好吗？

**有什么可以改进的吗？**

* * *

PS我还没有使用OCaml的面向对象位，因为我还没有学会那部分。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-08T00:14:45.797

对代码的一些评论：

*   您似乎没有将 sz_ary 用于任何事情。

*   您的代码为每个联合操作遍历整个数组。这对于标准（Tarjan）联合查找是不正确的。对于线性数量的联合操作，您的代码会产生二次解。维基百科有标准算法：[不相交集数据结构](http://en.wikipedia.org/wiki/Disjoint-set_data_structure)。

回答你的第二个问题：据我所知， union-find 是一种算法，没有已知的功能（不可变）解决方案与最佳命令式解决方案具有相同的复杂性。由于数组只是从整数到值的映射，因此您始终可以使用映射将任何基于数组的解决方案转换为不可变的解决方案。据我所知，这将与渐近复杂性中最著名的解决方案相匹配；即，它会增加一个额外的 log n 因子。当然，还有一个常数因素可能大到足以成为问题。

I've implemented union-find a few times in OCaml, and I've always chosen to do it using mutable data. However, I haven't used arrays. I have a record type for my basic objects, and I use a mutable field in each record to point to its parent object. To do path compression, you modify the parent pointer to point to the current root of the tree.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-07T20:07:22.453

几个风格点：

不知道为什么`unionfy`将 id_ary 作为参数，因为它始终保持不变

不要`Array.init`与常量函数一起使用。只需使用`Array.make`.

`print_string "...\n"`相当于`print_endline "..."`

可以使用双关语来清理以下定义 `let union u p q =`to:`let union {id_ary; _} p q`以便没有对`u`.

同样的双关语`let is_connected u p q = u.id_ary.(p) = u.id_ary.(q);;`

这可能是个人选择，但我会摆脱：

```
let vp = id_ary.(p) in
let vq = id_ary.(q) in 
```

或者至少将它们推到递归定义之上，以便清楚它们是恒定的。

编辑：更正版本

```
let union {id_ary;_} p q = 
    let (vp, vq) = (id_ary.(p), id_ary.(q)) in
    let rec unionfy i = 
        if i < Array.length id_ary then begin 
            if i != q && id_ary.(i) = vp then id_ary.(i) <- vq;
            unionfy (i + 1)
        end else print_endline "end of union"
    in unionfy 0;; 
```

# jquery - ajax调用后保留多选列表框项目

> ID：14759937
> 
> 赞同：0
> 
> 时间：2013-02-07T20:00:10.873
> 
> 标签：jquery, asp.net-mvc

我有一个视图模型，它在部分视图中呈现**N个列表框。**每个列表框都有一个唯一的 ID，称为**PartID**。这些列表框允许用户多选列表项。

我正在尝试做的是在发出 ajax 请求之前，查看是否存在任何列表框并存储相应的列表框选定项索引。如果再次渲染相同的 litsbox，则保留其先前选择的项目，并在 ajax 请求的成功功能上进行预选。

这些列表框是通过 AJAX 获取的

```
$.ajax({
                    type: 'POST',
                    url: serviceListPartsUrl,
                    cache: false,
                    datatype: "html",
                    data: { ServiceEntryID: $("#ServiceEntryID").val(), Parts: partTextArea },
                    success: function (result) {
                        $("#inputParts").html(result);
                    }
                }); 
```

**查看模型**

```
using System.Collections.Generic;
using RunLog.Domain.Entities;

namespace RunLog.WebUI.Models
{
    public class ServiceEntryListPartsViewModel
    {
        public IEnumerable<ServiceEntryPartDisplay> Parts { get; set; }
    }
} 
```

**局部视图：**

```
<tr>
    <td>@string.Format("{0:MM/dd/yyyy hh:mm:ss tt}", Model.PartDescription)
        @Html.HiddenFor(model => model.PartDescription)
    </td>
    <td>
        @Html.ListBoxFor(model => model.ServiceTypes, new MultiSelectList(RunLog.Domain.Lists.GlobalList.PartsServiceTypes(), "ID", "Name"), new { style = "width: 200px; height: 80px;", id =  @Model.PartID, name = "listbox" })
    </td>
    <td>@Html.TextAreaFor(model => model.Comment, new { style = "width: 200px; height: 80px;" })
    </td>
</tr> 
```

**控制器动作**

```
 [HttpPost]
            //[OutputCacheAttribute(NoStore=true,Duration=0,VaryByParam="*")]
            public ViewResult ListParts(string ServiceEntryID, string Parts)
            {
                int id = Convert.ToInt32(ServiceEntryID);

                ServiceEntryListPartsViewModel viewModel = new ServiceEntryListPartsViewModel();

                List<ServiceEntryPartDisplay> parts = new List<ServiceEntryPartDisplay>();

                if (Parts.Length > 0)
                {
                    var partsServiceTypeResults = from rec in db.ServiceEntryPart
                                                  join ec in db.Part on rec.PartID equals ec.ID
                                                  where (rec.ServiceEntryID.Equals(id) && ec.Active == true)
                                                  orderby rec.ServiceEntryID
                                                  select new ServiceEntryPartDisplay()
                                                  {
                                                      ServiceEntryID = rec.ServiceEntryID,
                                                      PartID = rec.PartID,
                                                      PartDescription = ec.PartDescription,
                                                      ServiceTypeIDs = rec.ServiceTypeIDs,
                                                      Comment = rec.Comment
                                                  };

                    string[] splitData = Parts.Split(new char[] { '|' }, StringSplitOptions.RemoveEmptyEntries);

                    foreach (string split in splitData)
                    {
                        ServiceEntryPartDisplay part = new ServiceEntryPartDisplay();

                        part.PartDescription = split;

                        part.PartID = Convert.ToInt32(split);
                        part.PartDescription = string.Format("{0} ~ {1}", split, (from pp in db.Part where pp.ID.Equals(part.PartID) select pp.PartDescription).FirstOrDefault());

                        var results = (from pp in partsServiceTypeResults where pp.PartID.Equals(part.PartID) select new { pp.ServiceTypeIDs, pp.Comment }).FirstOrDefault();

                        if (results != null)
                        {
                            part.Comment = results.Comment;
                            part.ServiceTypes = Domain.Lists.GlobalList.GetPartsServiceTypes(results.ServiceTypeIDs);
                        }
                        else
                        {
                            part.Comment = "";
                            part.ServiceTypes = new List<Domain.Lists.PartsServiceType>();
                        }

                        parts.Add(part);
                    }

                }

                viewModel.Parts = parts;

                return View(viewModel);
            } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-07T20:09:50.600

我认为你可以简化你做这件事的方式。`ViewModel`为什么不将包含`ServiceTypeID`当前选定 Parts的自定义集合传递给您的控制器`ID`。这样，您就可以使用**已选择**的正确项目正确生成局部视图。你可以用 javascript 客户端做这个诡计，但我想说利用你拥有的工具。将所有必要的数据发布回服务器，让 MVC 帮助将视图设置为正确的状态。

# entity-framework - 具有实体框架的共享图像表

> ID：14759945
> 
> 赞同：0
> 
> 时间：2013-02-07T20:00:45.823
> 
> 标签：entity-framework, ef-code-first

我想为我的数据库中的图像创建一个表，该表可以被几个不同的模型使用。我正在使用实体框架并已将我的图像类定义如下：

```
public class Images
{
    public int ID { get; set; }
    public String Name {get; set;}
    public byte[] ImageData { get; set; }  
    public string Type { get; set; }
} 
```

然后，我想从需要保存图像的任何其他模型链接到此。例如

```
public class Project
{
    public int ID { get; set; }
    public String Name { get; set; }
    public DateTime StartDate { get; set; }
    public DateTime EndDate { get; set; }
    public virtual ICollection<tImages> Images { get; set; }

} 
```

并且

```
public class User
{
    public int ID { get; set; }
    public String UserName { get; set; }
    public virtual ICollection<tImages> Images { get; set; }
} 
```

问题是实体框架正在将项目和用户的外键添加到图像表中。我猜我有点预料到这一点。

我想要的是定义一个可用于索引到我的图像表的图像键。我只是不确定如何定义类来获得这种影响。例如，我如何定义我的实体类来实现以下结果：

项目表

```
//ID    Name        StartDate   EndDate     Image
//1     Project1    05/02/2013  06/04/2013  PROJ01IMG 
```

用户表

```
//ID    UserName    Image       
//1     Bob         USER01IMG 
```

图像表

```
//ID  Name          Imagekey    ImageData           Type
//1   img1          PROJ01IMG   0xFFF00F1 .. etc    JPEG
//2   teamphoto     PROJ01IMG   0xFEB0011 ..etc     JPEG
//3   outline       PROJ01IMG   0xFFF0AA3 ..etc     PNG
//4   bob           USER01IMG   0xFFF01233 ..etc    JPEG 
```

当然，拥有外键可能是正确的方法，我不应该担心吗？只是我有很多模型，而且它们都需要存储图像，所以我宁愿将它们放在一个表中，而不是多个图像表中，因为我认为这将使所有图像的搜索/画廊等更容易。

我觉得这是一个完整的菜鸟问题，我遗漏了一些明显的东西，如果是的话，我深表歉意。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-07T20:06:42.353

如果您不希望 EF 映射 FK，而是将根据图像键手动填充列表，请像这样定义您的实体。但我认为你最好用你所拥有的，使用FK。

```
public class Project
{
    public int ID { get; set; }
    public String Name { get; set; }
    public DateTime StartDate { get; set; }
    public DateTime EndDate { get; set; }
    public string ImageKey { get; set; }
    [NotMapped]
    public List<Image> Images {get; set;}
}

public class User
{
    public int ID { get; set; }
    public String UserName { get; set; }
    public string ImageKey { get; set; }
    [NotMapped]        
    public List<Image> Images {get; set;}
} 
```

我想你可以尝试像这样定义你的类，看看它是否是你想要的：

```
public class Images
{
    public int ID { get; set; }
    public String Name {get; set;}
    public byte[] ImageData { get; set; }  
    public string Type { get; set; }

    public virtual User User { get; set; }
    public virtual Project Project { get; set; }
}

public class Project
{
    public int ID { get; set; }
    public String Name { get; set; }
    public DateTime StartDate { get; set; }
    public DateTime EndDate { get; set; }

}

public class User
{
    public int ID { get; set; }
    public String UserName { get; set; }
} 
```

这应该将 FK 映射到 Project 和 User 中的图像，这是我认为您真正想要的。

# azure - 短时间内高[数据输出]。Azure 网站

> ID：14759946
> 
> 赞同：3
> 
> 时间：2013-02-07T20:00:48.050
> 
> 标签：azure, web

我是 azurewebsites 服务的新用户，我很高兴为什么我的网站会发送太多数据。服务器在 8 小时内输出 55​​GB 数据。我的网站不包含任何大文件，它只是一个访问卡网站。我如何检查会发生什么？图在这里[http://ipic.su/img/img7/fs/server.1360266996.png](http://ipic.su/img/img7/fs/server.1360266996.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-07T20:50:42.377

您可以在 Windows Azure 网站（配置选项卡）中启用**Web 服务器日志记录。**

![诊断](../Images/0b5c9d2687d1d023997e5913d880a766.png)

启用日志后，您可以通过 FTP 下载它们（日志 FTP 的地址可以在主*仪表板*选项卡上找到。

![Windows Azure Web 服务器日志](../Images/df34112dbb630ddbd6162779061f8449.png)

您将从 Web 服务器日志中找到所有必要的详细信息，例如已下载资源以及发送了多少字节等。

我希望这会有所帮助。

# ruby-on-rails - Rails 通过关系使用 has_many 查找和计算

> ID：14759947
> 
> 赞同：0
> 
> 时间：2013-02-07T20:00:49.373
> 
> 标签：ruby-on-rails, ruby-on-rails-3

我有以下型号：

产品：

```
class Product < ActiveRecord::Base
  has_many :product_recommendations, :dependent => :destroy
  has_many :recommendations, :through => :product_recommendations  
end 
```

产品推荐：

```
class ProductRecommendation < ActiveRecord::Base
  belongs_to :recommendation
  belongs_to :product
end 
```

推荐：

```
class Recommendation < ActiveRecord::Base
  has_many :product_recommendations, :dependent => :destroy
  has_many :products, :through => :product_recommendations

  has_many :recommendation_ratings, :dependent => :destroy
  has_many :ratings, :through => :recommendation_ratings
end 
```

评分：

```
class Rating < ActiveRecord::Base
  has_many :recommendation_ratings, :dependent => :destroy
  has_many :recommendations, :through => :recommendation_ratings
end 
```

推荐评分：

```
class RecommendationRating < ActiveRecord::Base
  belongs_to :recommendation
  belongs_to :rating  
end 
```

我如何能够计算给定推荐的平均评分？我的评级表仅包含 4 条记录（评级 1-4），并且我的推荐控制器中有一个操作，它更新 RecommendationsRatings 连接表以将评级与推荐相关联。谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-07T20:12:56.167

你有没有尝试过：

```
class Product < ActiveRecord::Base
  has_many :product_recommendations, :dependent => :destroy
  has_many :recommendations, :through => :product_recommendations
  has_many :ratings, :through => :recommendations
end 
```

接着

```
p = Product.find 1
p.ratings.average(:rating) 
```

这是假设 Ratings 模型有一个名为 rating 的 int / float 存储等级

# ios - NSURLRequest 或 AFNetworking 中的错误？

> ID：14759948
> 
> 赞同：0
> 
> 时间：2013-02-07T20:00:50.063
> 
> 标签：ios, objective-c, cocoa-touch, afnetworking, nsurlrequest

不确定这是一个错误还是我遗漏了一些东西，很可能是后者。我的 AFHTTPClient 的基本网址是：

```
#define kBaseURL @"http://localhost:4567/api/"
self.client = [[AFHTTPClient alloc] initWithBaseURL:[NSURL URLWithString:kBaseURL]]; 
```

例如，当我发出请求时`'/games'`，它实际上将请求发送到`http://localhost:4567/games`忽略 API 部分。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-07T20:13:44.463

[“ ”](http://engineering.gowalla.com/AFNetworking/Classes/AFHTTPClient.html#//api/name/initWithBaseURL%3a)位的[“baseURL”部分`initWithBaseURL:`](http://engineering.gowalla.com/AFNetworking/Classes/AFHTTPClient.html#//api/name/initWithBaseURL%3a)应该清楚地表明它只适用于方案+主机+端口号部分。

创建客户端后，您可以通过以下技术将参数添加到其 URL 请求中：

```
NSMutableURLRequest *request = 
    [self.client requestWithMethod:@"POST" path:@"/api/games" parameters:parameters]; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-07T20:59:57.507

该`AFHTTPClient.h`文件有大量关于如何使用`/`s 来确保所有内容正确组合的评论。[在 github 上](https://github.com/AFNetworking/AFNetworking/blob/master/AFNetworking/AFHTTPClient.h#L57-L63)查看

# javascript - 如何为 taffyDB 查询动态创建此对象

> ID：14759950
> 
> 赞同：1
> 
> 时间：2013-02-07T20:00:57.583
> 
> 标签：javascript, object, dynamic, taffydb

我有一个填充了 productdata 的 taffyDB，并且想要进行查询以选择范围在 >2 和 <=4 之间的所有产品

```
 allProducts = TAFFY([
    {OrderNo:'prod1',range: 3,Status:'inactive'},
    {OrderNo:'prod2',range: 2,Status:'inactive'},
    {OrderNo:'prod3',range: 2,Status:'inactive'},
    {OrderNo:'prod4',range: 6,Status:'inactive'},
    {OrderNo:'prod5',range: 5,Status:'inactive'}, 
```

我知道用这个查询可以很容易地做到这一点：

```
allProducts({range:{gt:2}},{range:{lte:4}}).get(); 
```

但是如何使用来自两个下拉框的值动态构造此查询？我想不出一种方法来实现它，因为我认为我无法创建一个具有 2 个同名属性的对象：/

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-26T21:52:05.943

您不需要创建具有两个同名属性的对象。只需执行以下操作：

```
//assuming minValue and maxValue are defined
var lowerRange = {range: {gt: minValue}};
var upperRange = {range: {lte: maxValue}};
var results = allProducts(lowerRange, upperRange).get(); 
```

# php - Strtolower 功能在我的页面上不起作用

> ID：14759955
> 
> 赞同：-2
> 
> 时间：2013-02-07T20:01:25.300
> 
> 标签：php, forms

Strtolower 函数不起作用，当我 print_r 得到我输入的内容时。
无法意识到发生了什么。

```
 $ulogus = strtolower($_POST['username']);
 $ulogpa = strtolower($_POST['password']);
 $ulogus = mysql_real_escape_string($_POST['username']);
 $plogpa = mysql_real_escape_string($_POST['password']); 
```

我也尝试过使用 mb_strtolower()

输入：

```
 <label>Username</label>
 <input name="username" type="text" class="textfields" />
 </div>
 <div class="formblock">
 <label>Password</label><input name="password" type="password" class="textfields"/>
 </div> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-07T20:02:33.243

尝试：

```
$ulogus = mysql_real_escape_string(strtolower($_POST['username']));
$plogpa = mysql_real_escape_string(strtolower($_POST['password'])); 
```

你正在覆盖`$ulogus`.

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-07T20:02:59.667

您不断从同一个地方提取相同的数据，替换之前的 tolower()

```
$ulogus = strtolower($_POST['username']);
$ulogus = mysql_real_escape_string($ulogus);
                                   ^^^^^^^ 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-07T20:05:32.347

您正在覆盖变量。你必须像这样更改代码

```
 $_POST['username'] = strtolower($_POST['username']);
 $_POST['password'] = strtolower($_POST['password']);
 $ulogus = mysql_real_escape_string($_POST['username']);
 $plogpa = mysql_real_escape_string($_POST['password']); 
```

# spring-mvc - 如何在模型绑定期间显示导致类型不匹配的无效值？

> ID：14759959
> 
> 赞同：0
> 
> 时间：2013-02-07T20:02:02.290
> 
> 标签：spring-mvc, model-binding

我们在 Spring 3.1 MVC 中使用强类型模型和表单对象，这很好用，并且允许我们以较低的代码开销来管理我们的。然而，我们的用户喜欢在显示无效值时将无效值保留在字段中，特别是这样用户不必重新输入因一个错字而丢失的长金额。这适用于验证错误，但会出现绑定错误的问题，因为该值不适合模型。我知道我可以从 中获取无效值[`FieldError`](http://static.springsource.org/spring/docs/3.1.x/javadoc-api/org/springframework/validation/FieldError.html#getRejectedValue%28%29)，但是我怎样才能将其返回到视图（JSP）？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-09T02:33:50.127

您可以访问 JSP 中的 BindingResult。您可以直接获取字段错误。它看起来像这样：

```
<forEach items="${requestScope['org.springframework.validation.BindingResult.formBean'].getFieldErrors('fieldName')}" var="fieldError">
     <!-- do something with the FieldError -->
</forEach> 
```

在这种情况下，表单bean/模型属性/命令对象称为“formBean”，字段称为“fieldName”。一旦你有了 fieldError，你就可以用它做你想做的事。

# eclipse - 是否有 Eclipse 将 .class 文件复制到其他目标文件夹？

> ID：14759963
> 
> 赞同：0
> 
> 时间：2013-02-07T20:02:09.917
> 
> 标签：eclipse

我有一个日食项目。默认情况下，我的 .class 文件被放在这里：

```
/projectname/build/classes 
```

每次构建项目时，有没有办法让 eclipse 也将这些文件复制到*另一个文件夹目标？*

我可以自己编写一个脚本来执行此操作，但希望 eclipse 中有某种钩子可以执行此操作。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-07T20:34:24.023

您可以为此编写一个 Ant 脚本并将其作为构建器添加到您的项目中。有关示例，请参阅[Eclipse 文档。](http://help.eclipse.org/juno/topic/org.eclipse.platform.doc.user/gettingStarted/qs-92_project_builders.htm)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-07T20:28:47.337

Eclipse 不具备输出到多个位置的本机能力，但您可以通过[将自定义构建器添加到您的项目来](http://bewarethepenguin.blogspot.com/2008/08/customizing-builds-for-your-eclipse.html)自己完成它。

# php - 同一 PHP 脚本的多个实例使用行锁定处理不同的 MySQL 行

> ID：14759964
> 
> 赞同：1
> 
> 时间：2013-02-07T20:02:09.777
> 
> 标签：php, mysql, innodb, rowlocking

我想要做的是**每隔几分钟**使用 cron 执行相同的脚本。

该脚本需要处理从数据库读取的一些数据，所以显然我需要它每次都在不同的行上工作。

我的概念是使用**行锁定**来确保每个实例在不同的行上工作，但它似乎不是那样工作的。甚至可以以这种方式使用行锁吗？还有其他溶液吗？

例子：

```
while($c < $limit) {
   $sql=mysql_query("SELECT * FROM table WHERE ... LIMIT 1 FOR UPDATE");
   $data=mysql_fetch_assoc($sql);

   (process data)

   mysql_query("update table set value=spmething, timestamp=NOW()");
   $c++;
} 
```

基本上我需要的是 SCRIPT1 从表中读取 R1；SCRIPT2 读取 R2（下一个非锁定行匹配条件）

编辑：例如：1）表存储 URL 列表 2）脚本检查 URL 是否响应，并在数据库中更新它的状态（和时间戳）

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-21T01:34:53.860

这基本上应该被视为两个独立的问题：

1.  为每个工人寻找一份工作来处理。理想情况下，这应该非常有效，并在接下来的第 2 步中预先避免失败。
2.  确保每个作业最多处理一次或仅处理一次。无论发生什么情况，同一个作业都不应该由多个工人同时处理。您可能希望确保不会因为有车/撞车的工人而失去工作。

这两个问题都有多种可行的解决方案。我会就我的偏好给出一些建议：

**找工作来处理**

对于低速系统，只需查找最近的未处理作业就足够了。您还不想*接受*这份工作，只需将其确定为候选人即可。这可能是：

```
SELECT id FROM jobs ORDER BY created_at ASC LIMIT 1 
```

（请注意，这将首先处理最旧的作业——先进先出顺序——并且我们假设行在处理后被删除。）

**申请工作**

在这个简单的例子中，这将很简单（注意我正在避免一些可能使事情变得不太清楚的优化）：

```
BEGIN;
SELECT * FROM jobs WHERE id = <id> FOR UPDATE;
DELETE FROM jobs WHERE id = <id>;
COMMIT; 
```

如果`SELECT`查询时返回我们的工作`id`，我们现在已经锁定它。如果另一个工人已经接受了这个工作，则会返回一个空集，我们应该寻找另一个工作。如果两个工人竞争同一个工作，他们会从一开始就互相阻止`SELECT ... FOR UPDATE`，这样前面的陈述就普遍成立了。这将允许您确保每个作业*最多处理一次*。然而...

**只处理一次*作业***

先前设计中的一个风险是工作人员接受了一项工作，但未能处理它，然后崩溃。现在失去了这份工作。因此，大多数作业处理系统在他们声称作业时不会删除作业，而是将其标记为由某个工人声称并实施作业回收系统。

`job`这可以通过使用表中的附加列或单独的表来跟踪索赔本身来实现`claim`。通常会写一些关于工作人员的信息，例如主机名、PID 等，( `claim_description`) 并为声明提供一些到期日期 ( `claim_expires_at`)，例如未来 1 小时。然后，一个额外的过程会处理这些索赔，并以事务方式释放过期的索赔 ( `claim_expires_at < NOW()`)。`claim_expires_at IS NULL`然后，申请工作还需要在选择时和申请时检查工作行是否有申请 ( ) `SELECT ... FOR UPDATE`。

请注意，这个解决方案仍然存在问题：如果一个作业处理成功，但工人在成功将作业标记为已完成之前崩溃了，我们最终可能会释放索赔并重新处理该作业。解决这个问题需要一个更高级的系统，作为练习留给读者。;)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-07T20:19:36.107

如果您要读取该行一次，并且只读取一次，那么我将创建一个`is_processed`列并简单地更新您已处理的行上的该列。然后您可以简单地查询具有`is_processed = 0`

# java - GPU可以用于Android Environmement上的数值计算（复矩阵乘法）吗？

> ID：14759966
> 
> 赞同：2
> 
> 时间：2013-02-07T20:02:24.230
> 
> 标签：java, android, gpu, fpu, kalman-filter

我正在 Android 中实现卡尔曼滤波器算法。该代码有一些复杂的矩阵乘法运算。矩阵元素是浮点类型。我的问题是

1）如何在Android中处理浮点数？

2) GPU 可以用于复杂矩阵（浮点类型的元素）计算或任何类型的数值计算吗？

非常感谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-07T20:05:17.930

android.opengl.Matrix 库为您解决了这个问题

renderscript 似乎是一个用户更可控的解决方案。

# android - Android唤醒移动连接/睡眠后接受数据

> ID：14759970
> 
> 赞同：2
> 
> 时间：2013-02-07T20:02:31.780
> 
> 标签：android, connection, gsm

我在通过 gsm 网络进行数据连接时遇到问题。设备休眠时无法与服务器交互。似乎移动网络关闭。打开显示移动连接时打开并自动再次发送请求。

在 wifi 模式下，我使用 WifiLock 但找不到这样的方法用于移动无线电/移动数据连接。

问候

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-07T22:02:05.687

您可以使用 AlarmManager 来安排您的数据检查。设置 AlarmManager.RTC_WAKEUP 警报类型将导致设备在每次警报响起时唤醒（从而启动您的服务）。这应该可以为您提供所需的数据连接。

```
Intent intent = new Intent(this, MyService.class);
PendingIntent pendingIntent = PendingIntent.getService(this, 0, intent, 0);

AlarmManager alarm = (AlarmManager)getSystemService(Context.ALARM_SERVICE);
// Start every 30 seconds
alarm.setRepeating(AlarmManager.RTC_WAKEUP, Calendar.getInstance().getTimeInMillis(), 30*1000, pendingIntent); 
```

看：

*   [PendingIntent.getService()](http://developer.android.com/reference/android/app/PendingIntent.html#getService%28android.content.Context,%20int,%20android.content.Intent,%20int%29)
*   [AlarmManager.setRepeating()](http://developer.android.com/reference/android/app/AlarmManager.html#setRepeating%28int,%20long,%20long,%20android.app.PendingIntent%29)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-07T21:50:38.953

您可以使用[WakeLock](http://developer.android.com/reference/android/os/PowerManager.WakeLock.html)在屏幕关闭时保持 CPU / 无线电开启。小心使用。

# javascript - RouteUrl/javascript 错误

> ID：14759977
> 
> 赞同：0
> 
> 时间：2013-02-07T20:03:02.463
> 
> 标签：javascript, asp.net-mvc

对于以下代码，我收到错误“名称 fn 在当前上下文中不存在”。该错误发生在页面加载和此代码的最后一行：

```
<script language="javascript" type="text/javascript">
    function RunAdvancedSearchClicked() {
        var fn = $("#FirstName").val();
        var ln = $("#LastName").val();
        var ssn = $("#SSN").val();
        var doi = $("#DateOfInjury").val();

        document.location = '@Url.RouteUrl("ClaimSearch", new { action = "Search", firstName = fn, lastName = ln, dateOfInjury = doi, carrier = ViewBag.Carrier })';
    }
</script> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-07T20:09:56.480

@Url.RouteUrl() 在客户端执行之前（在服务器上）呈现标记时执行。

您可以在服务器上生成部分链接，然后在 javascript 中附加该值：

```
var url = '@Url.RouteUrl("ClaimSearch", new { action = "Search", lastName = ln, dateOfInjury = doi, carrier = ViewBag.Carrier })';
document.location = url + '&firstName=' + fn; 
```

# postgresql - 如何在 PostgreSQL (9.1) 函数中将字符转换为整数？

> ID：14759987
> 
> 赞同：10
> 
> 时间：2013-02-07T20:03:33.530
> 
> 标签：postgresql, types, casting, postgresql-9.1

我有以下代码：

```
BEGIN
   x := split_part(text, ',', 1);
   UPDATE albumphoto SET order = 1 WHERE idtable = 1 AND idx = x;   
END 
```

但是我命名的列表`idx`是数字类型，并且`split_part`将字符类型返回给变量`x`。我试过使用`CAST`，但我不知道如何正确使用它。

有任何想法吗？

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2013-02-07T20:05:57.490

像这样：

```
UPDATE albumphoto SET order = 1 WHERE idtable = 1 AND idx = CAST (x AS INTEGER); 
```

（使用适当的数字类型而不是`INTEGER`）。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2013-02-07T22:33:43.237

或更简单：

```
UPDATE albumphoto
SET    order = 1
WHERE  idtable = 1
AND    idx = split_part(text, ',', 1)::int  -- or whatever type it is
AND    order IS DISTINCT FROM 1; 
```

`expression::type`是简单的（非 SQL 标准的）Postgres 转换方式。手册中的[Type Casts](http://www.postgresql.org/docs/current/interactive/sql-expressions.html#SQL-SYNTAX-TYPE-CASTS)一章中的详细信息。
更多关于[PostgreSQL 中的数据类型](http://www.postgresql.org/docs/current/interactive/datatype.html)。

`order`我添加的最后一个谓词 if could already *be* 很有用`1`，在这种情况下更新不会改变任何东西，但成本仍然相同。而是什么都不做。相关（考虑最后一段）：

*   [我如何（或我可以）在多列上选择 DISTINCT？](https://stackoverflow.com/questions/54418/how-do-i-or-can-i-select-distinct-on-multiple-columns/12632129#12632129)

而且您在这里*不需要*变量。

# php - 如何为表格中的特定单词添加颜色

> ID：14759991
> 
> 赞同：0
> 
> 时间：2013-02-07T20:04:12.103
> 
> 标签：php, html, colors, html-table

我的代码正在检查餐厅是否有标题，如果没有，表格中会出现“无标题”一词。在这里我想用红色标记“No Title”这个词。这怎么可能？

我该行的代码如下所示

```
<td><?= isset($restaurant_result['title']) ? $restaurant_result['title'] : 'No Title'; ?></td> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-07T20:07:38.127

您可以为您的`td`元素添加一个类：

```
<? if (isset($restaurant_result['title'])) { ?>
    <td><?= $restaurant_result['title']; ?></td>
<? } else { ?>
    <td class="no-title">No Title</td>
<? } ?> 
```

然后用 CSS 设置样式：

```
.no-title {
    color: red;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-07T20:05:28.273

简单的：

```
<td><?= isset($restaurant_result['title']) ? $restaurant_result['title'] : '<span style="color:red">No Title</span>'; ?></td> 
```

# windows - 批处理：使用 CRC32 比较文件

> ID：14759992
> 
> 赞同：1
> 
> 时间：2013-02-07T20:04:26.183
> 
> 标签：windows, file, batch-file, compare, crc32

我给自己一个简单的任务，就是编写一个批处理文件，该文件将执行以下操作：

将“第一个”文件夹中每个文件的 CRC32 与“第二个”文件夹中的每个文件进行比较。输出需要是“第一个”文件夹中每个文件的名称，该文件夹在“第二个”文件夹中没有重复项。

注意：“CRC32.exe -nf”在第一行输出 CRC32，在第二行输出文件大小。

这是我尝试这样做的方法：

```
@echo off

for %%i in ("%cd%\first\*.*") do (
    set uniq=0
    for /f %%x in ('crc32 %%i -nf') do (
        set one=%%x
        goto find_two
    )
    :find_two
    for %%j in ("%cd%\second\*.*") do (
        for /f %%x in ('crc32 %%j -nf') do (
            set two=%%x
            goto compare
        )
        :compare
        if one==two (
            goto next
        ) else (
            set uniq=1
        )
    )
    if uniq==1 (
        echo %%i >>result.txt
    )
    :next
) 
```

我认为这段代码中存在几个错误，但我很难找到它们。因此，如果有人有时间，并且认为他可以提供帮助，我将不胜感激。

如果您认为需要不同的方法，请随时展示它。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-07T20:20:09.990

有两个主要问题。

Goto 的内部括号没有按预期工作，它们立即停止循环，因此您的代码将在那里失败。
解决方案是避免`goto`或调用函数并在`goto`那里使用。

第二个问题是比较。
`if one==two (`将始终为假，因为它将 word`one`与 word进行比较`two`，而不是变量的内容。

通常你会使用`if "%one%"=="%two%" echo equal`，但由于它应该在括号内工作，你需要延迟扩展，所以看起来像。

```
if !one!==!two! echo equal 
```

在开始循环之前不要忘记启用延迟扩展

```
setlocal EnableDelayedExpansion 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-07T20:22:49.470

使用类似这样的方法可能更容易捕获 crc32 的输出：

```
for /f %%x in ('crc32 "%filename%" -nf ^| find /v "CRC32"') do stuff with %%x 
```

如果这没有帮助，你能告诉我一个示例 crc32 的完整输出吗？

# mysql - MYSQL 平均函数输出 .0000

> ID：14759994
> 
> 赞同：0
> 
> 时间：2013-02-07T20:04:33.947
> 
> 标签：mysql, average

我有一个名为“价格”的简单列，并希望获得所有行的平均数。我有这个代码：

> $avg = mysql_query("SELECT AVG(price) FROM books WHERE author='$postname'");
> 
> $avgprice = mysql_fetch_assoc($avg);

当我去输出时：

```
<?php echo $avgprice['AVG(price)'] ?> 
```

它给了我 250.0000 而不是 250 这是实际数字。为什么我在输出后得到这 4 个小数？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-07T20:10:24.003

这就是 AVG 函数的工作原理，它返回一个 4 位小数的数字。如果你想四舍五入试试这个：

```
 $avg = mysql_query("SELECT ROUND( AVG(price) ) as avg FROM books WHERE author='$postname'");

    $avgprice = mysql_fetch_assoc($avg);

<?php echo $avgprice['avg'] ?> 
```

# networking - 从 pcap 文件中获取特定信息

> ID：14759995
> 
> 赞同：0
> 
> 时间：2013-02-07T20:04:35.203
> 
> 标签：networking, wireshark, tshark, wifi

我对`.pcap`（`Frame control`字段）中的特定信息感兴趣。我想将其提取到文本文件中，然后使用提取的数据进行图形绘制。我可以使用导出到文本文件，`wireshark`但我正在寻找自动化过程。

到目前为止，我知道它`Tshark`可以用来转换`.pcap`为文本文件，但它会输出整个数据包。相反，我只对一个特定信息感兴趣。

有什么好方法可以做到这一点。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-08T06:45:30.213

> 有什么好方法可以做到这一点。

可能。

如果您要提取的字段有过滤器，您可以使用 tshark 使用`-T`and`-e`开关仅输出该字段；

```
tshark -Tfields -e tcp.port -r .... 
```

详情见`tshark -h`...

要使用wireshark 查看字段名称，请单击详细信息窗格中的字段，然后记下底部状态栏中显示的字段名称。

您具体想要哪些字段？从什么协议？

# sql - 是否可以将这 2 个 select 语句优化为一个？

> ID：14759996
> 
> 赞同：1
> 
> 时间：2013-02-07T20:04:37.290
> 
> 标签：sql, database, web, multiple-select

```
Select 1 
from Friend 
where Friend.UserID = 1 
  and FriendID = (select User.UserID from User where UserName = 'friend_user'); 
```

我要做的是检查用户是否与另一个用户是“朋友”。因此，当用户导航到“foo.com/user/username”时，用户名被传递，这就是我进行检查的时候。我宁愿不使用两个选择，但似乎这是唯一的方法。任何有关完成此类任务的最佳方式的建议将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-07T20:08:24.770

您可以使用 a`JOIN`代替：

```
Select 1 
from Friend f
join User u
    on f.FriendID = u.UserID
    and u.UserName = 'friend_user'
where 
    f.UserID = 1; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-07T20:51:03.123

回答：“这行得通，但是如果我想从 User 表中选择一些东西，比如 Friends UserName 之类的呢？-”

```
Select u.username, count(f.friends)
from Friend f
join User u
    on f.FriendID = u.UserID
    and u.UserName = 'friend_user'
where 
    f.UserID = 1; 
```

# html - 可滚动的图像行

> ID：14759997
> 
> 赞同：0
> 
> 时间：2013-02-07T20:04:37.900
> 
> 标签：html, css, image, scrollbar

我有一个小图像，我需要沿 x 方向重复特定次数。图像的“行”应该是可滚动的，如果可能的话，我想避免使用表格。

这可能与Html + Css有关吗？html 代码将使用 PHP 动态生成。有什么额外的想法吗？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-07T20:18:20.383

我想知道 ajax 是否为您提供了最好看的解决方案，但您并没有很好地解释您的场景，为什么要重复相同的图像并使其可滚动？这听起来不像任何东西的有效功能。您是否要缩放背景图像或其他东西？如果是这样，滚动条是怎么回事？？？

无论如何，你去： [http ://wowslider.com/rq/ajax-image-scroller/](http://wowslider.com/rq/ajax-image-scroller/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-07T20:21:05.990

加里的回答很好。但是，如果您只想要常规滚动条，请使用 div（或画布，可能以相同的方式）包装动态区域（您将在其中加载图像），并为其添加一个类。然后，您可以使用 CSS 定位所有图像并使它们浮动，这将使它们对齐，无论您动态加载多少。（只是不要忘记在容器上放一个宽度。）

它看起来像这样（速记，但你明白了）：

```
div.image-container {
width: 400px;
overflow: scroll;
}

div.image-loader img {
float: left;
}

<div class="image-loader">
  <img/>
  <img/>
</div> 
```