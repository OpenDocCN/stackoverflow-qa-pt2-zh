# StackOverflow 问答 14023000-14023999

# html - 我的粘页脚有问题吗？

> ID：14023002
> 
> 赞同：0
> 
> 时间：2012-12-24T15:16:24.520
> 
> 标签：html, css, sticky-footer

请查看我的代码并帮助我处理页脚。我已经尝试了所有我能想到的方法，但无法让页脚停留在底部。当我让它停留在底部时，它会在调整窗口大小时与上述内容重叠。这里的想法是让页脚保持在页面底部的内容下方，并且在窗口重新调整大小或缩放时不移动。

**HTML**

```
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
    "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<title>Sgembardesign.com</title>

<!-----CSS Library----->
<link href="assets/CSS/style sheet.css" rel="stylesheet">

<!----- Java Script Library ----->
<script src="assets/js/jquery.js"></script>
<script src="assets/js/my_code.js"></script>
<link href="http://ajax.googleapis.com/ajax/libs/jqueryui/1.8/themes/base/jquery-           

ui.css" rel="stylesheet" type="text/css"/>
<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.5/jquery.min.js"></script>
<script src="http://ajax.googleapis.com/ajax/libs/jqueryui/1.8/jquery-ui.min.js">   

</script>
<style type="text/css">
    </style>

</head>
<body>

<div class="wrapper">
<div id="menu_bar">
    <div id="menu_li">
        <ul>
            <li><a href="index.html">home</a></li>
            <li><a href="about.html">about</a></li>
            <li><a href="projects.html">projects</a></li>
            <li><a href="blog.html">blog</a></li>
        </ul>
    </div>
</div>
<hr noshade size="3">

<div id="catalogs">
    <div id="web">
    </div>

    <div id="photo">
    </div>

    <div id="mobile">
    </div>
</div>

<div class="push"></div>
<div class="footer">
    <img class="img" src="assets/img/logo.gif" alt="logo" width="500" height="300"/>
</div>

</div>

</body>
</html>

**The CSS**

*
{
margin: 0;
}
body
{
height: 100%;
background-image: url("../img/dark-metal-grid-5.jpg");
}
html
{
height: 100%;
}
.wrapper
{

width: 950px;
min-width: 950px;
min-height: 100%;
height: auto;
height: 100%;
margin: 0 auto -142px;
border-bottom: 3px solid white;
sbackground:rgb(0,0,0); /* IE6/7/8 */
filter:alpha(opacity=60); /* IE6/7/8 */
background:rgba(0,0,0,0.6); /* Modern Browsers */
}

/*--------------menu items--------------*/

#menu_bar
{
width: 725px;
height: 95px;
float: left;
position: absolute;
padding: 4em;
}

a
{
color: white;
text-decoration: none;
position: relative;
left:95px;

}
ul
{
list-style-type: none;

}
li
{
display: inline;
margin-left: 20px;

}
#menu_li
{
font-size: 45px;
font-family: Impact, Charcoal, sans-serif;
line-height: 32px;

}
#menu_bar a:hover
{
text-decoration: none;
color: #C50F0F;
}

/*---------------hr------------------*/
hr
{
width: 950px;
color: #C50F0F;
background-color: #c50f0f;
position: absolute;
top: 105px;
border-width: 0;
line-height: 0;
height: 2px;
text-align: center;
}
/*---------------Catalogs-----------*/
#catalogs
{
text-align: center;
position: relative;
}

#web
{
width: 250px;
height:225px;
position:absolute;
top:200px;
overflow: hidden;
float: left;
left:40px;
background-color: #C50F0F;
background:rgba(255,0,0,0.4);
border-bottom-right-radius: 25px;
border-top-right-radius: 25px;
border-bottom-left-radius: 25px;
border-top-left-radius: 25px;
border: solid 3px black;

}

#photo
{
width: 250px;
height: 225px;
top: 200px;
position: absolute;
overflow: hidden;
display: inline;
border-bottom-left-radius: 25px;
border-bottom-right-radius: 25px;
border-top-left-radius: 25px;
border-top-right-radius: 25px;
background-color: #C50F0F;
background:rgba(255,0,0,0.4);
left: 37%;
border: solid 3px black;

}

#mobile
{
width: 250px;
height:225px;
position:relative;
top:200px;
overflow: hidden;
float: right;
right:40px;
background-color: #C50F0F;
background:rgba(255,0,0,0.4);
border-bottom-right-radius: 25px;
border-top-right-radius: 25px;
border-bottom-left-radius: 25px;
border-top-left-radius: 25px;
border: solid 3px black;
}

.push
{
height: 142px;
}

.footer
{

width: 950px;
height: 142px;
margin-top: -142px;
clear: both;
bottom: 0px;
sbackground:rgb(0,0,0); /* IE6/7/8 */
filter:alpha(opacity=60); /* IE6/7/8 */
background:rgba(0,0,0,0.6); /* Modern Browsers */
}

.img
{
position: relative;
top: -75px;
left: -75px;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-24T15:21:18.303

[http://jsfiddle.net/Tc4be/](http://jsfiddle.net/Tc4be/)

欢迎来到 SO。这是一个非常可怕的问题。请注意我对那个 jsFiddle 做了什么。我为您的问题创建了一个小的可观察样本。

现在的问题。

```
 <div class="push"></div>
    <div class="footer">
        <img class="img" src="assets/img/logo.gif" alt="logo" width="500" height="300"/>
    </div>

</div> 
```

需要是

```
 <div class="push"></div>
</div>   <!-- Footer Outside the Wrapper div --> 
<div class="footer">
        <img class="img" src="assets/img/logo.gif" alt="logo" width="500" height="300"/>
    </div> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-24T15:18:27.370

您可以定位页脚来修复它：

```
.footer
{
    width: 100%;
    height: 142px;
    position: fixed;
    clear: both;
    bottom: 0;
    left: 0;
    sbackground:rgb(0,0,0); /* IE6/7/8 */
    filter:alpha(opacity=60); /* IE6/7/8 */
    background:rgba(0,0,0,0.6); /* Modern Browsers */
} 
```

它还有助于为正文添加等量的填充，因此您可以一直滚动到内容的末尾：

```
body {
    padding-bottom: 142px;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-24T15:43:30.903

*   根据乔的回答，将页脚放在包装器之外
*   添加`overflow: hidden;`到`footer`班级。

[JSFiddle](http://jsfiddle.net/Taz6W/)

# c++ - 什么是 .NET 用户设置的 QT 模拟，在使用上是否相似？

> ID：14023005
> 
> 赞同：2
> 
> 时间：2012-12-24T15:17:08.750
> 
> 标签：c++, .net, qt

我想知道这个[.NET 功能](http://msdn.microsoft.com/en-us/library/aa730869%28VS.80%29.aspx)的 QT 模拟是什么，例如可以[将一些用户推算值保存到 TextBox](https://stackoverflow.com/questions/2704516/how-to-save-user-imputed-value-in-textbox-wpf-xaml)中？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-12-24T15:21:31.437

如果您正在寻找具有键值格式的简单平面文件，您可以使用[QSettings](http://qt-project.org/doc/qt-5.1/qtcore/qsettings.html)

# objective-c - 解析 JSON 中的特殊字符

> ID：14023006
> 
> 赞同：0
> 
> 时间：2012-12-24T15:17:15.260
> 
> 标签：objective-c, json, nsjsonserialization

我现在正在解析`NSJSONSerialization`

```
NSData *jsonData = [NSData dataWithContentsOfURL:[NSURL URLWithString:@"url"]];
NSError *jsonError = nil;
id jsonObject = [NSJSONSerialization JSONObjectWithData:jsonData options:NSJSONReadingMutableContainers error:&jsonError];

NSDictionary *jsonDictionary = (NSDictionary *)jsonObject;

[self setTableData:jsonDictionary]; 
```

但它不会解析我的 JSON，因为当我从 JSON 中删除**“ ü”时，JSON 中的特殊字符（如字母****“ü”**）可以正常工作。我尝试了上面的代码并且：

 **```
options:utf8... 
```

有谁知道我该如何解决这个问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-24T20:53:03.880

尝试使用可以显式指定编码的 NSString。前任：

```
NSString *string = [NSString stringWithContentsOfURL:webURL encoding:NSUTF8StringEncoding error:&error]; 
```

然后，您可以将 NSString 对象转换为 NSData，然后进行 JSON 序列化。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-24T15:22:43.013

尝试使用**NSJSONReadingMutableLeaves更改****NSJSONReadingMutableContainers**。这解决了我类似的问题。**

# python - Python：将输出重定向到多个控制台？

> ID：14023009
> 
> 赞同：-1
> 
> 时间：2012-12-24T15:17:36.277
> 
> 标签：python, subprocess

我有一个主程序，用户可以在其中多次调用子进程（下载文件）。每次，我使用子进程调用 aria2c，它会将进度打印到标准输入。当然，希望用户可以分别看到每次下载的进度。

所以问题是如何将每个进程的输出重定向到单独的控制台窗口？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-24T17:10:51.620

我有点困惑。使用 subprocess.Popen(...) 应该为每次调用自动生成一个新的命令提示符。什么是aria2c？它也是你用python编写的程序吗？它是写入命令提示符窗口的第 3 方 exe 吗？

我可以帮助您将所有子流程输出重定向到主命令提示符，以便它可以内联显示。

另外，也许您可​​以先详细说明发生了什么，这样我才能更好地理解您的麻烦。

# c# - “跳转”到网格视图中的特定行

> ID：14023011
> 
> 赞同：0
> 
> 时间：2012-12-24T15:17:51.313
> 
> 标签：c#, asp.net

我整天都面临一个非常烦人的问题而没有成功解决它，我需要跳转到gridview中的一行，我想跳转到的行数取自查询字符串。

我搜索了谷歌，这里和其他地方，我试过的答案都没有为我工作。

gridview 列是模板字段。

这是我尝试的最后一件事：

```
 ClientScript.RegisterStartupScript(this.GetType(),
                                "navigate",
                                "window.onload = function() {window.location.hash='#" + anchorId + "';}",
                                 true); 
```

anchorid 放置在模板字段内的模板项中

泰。

编辑：这里是一些 gridview 代码，它太长了，发布它是毫无意义的：

```
 <asp:GridView ID="GV_SeatRent" runat="server" DataSourceID="GridDataSource" EnablePersistedSelection="True"
        AllowPaging="True" AllowSorting="True" CssClass="DDGridView"
        RowStyle-CssClass="td" HeaderStyle-CssClass="th" CellPadding="6" 
        PageSize="100" AutoGenerateColumns="False" ShowHeaderWhenEmpty="True" 
        Width="300px" onprerender="GV_SeatRent_PreRender" 
        onrowupdated="GV_SeatRent_RowUpdated" onrowupdating="GV_SeatRent_RowUpdating">
        <Columns>

           <asp:TemplateField >
                <ItemTemplate>
                    <a title="asd" name='<%# setAnchor()%>'/>
                </ItemTemplate>
            </asp:TemplateField>

             <asp:TemplateField >
                <ItemTemplate>
                    <%# GetCompName()%>
                </ItemTemplate>
            </asp:TemplateField>

            <asp:TemplateField >
                <ItemTemplate>
                    <%# GetTalmidName()%>
                </ItemTemplate>
            </asp:TemplateField> 
```

# iphone - 关于我的 OpenGL 的问题 - 代码

> ID：14023017
> 
> 赞同：4
> 
> 时间：2012-12-24T15:18:23.983
> 
> 标签：iphone, objective-c, ios, buffer, opengl-es-2.0

最近几天我开始深入研究 OpenGL ES 2.0，但我仍然得到非常错误的结果。我不太明白的一件事是我应该如何正确设置缓冲区。

我想创建一个这样的形状：一种帐篷，如果你喜欢，没有左右两侧。

```
3_______________________2
|\                     /|
| \_ _ _ _ _ _ _ _ _ _/ |          
| /4                 5\ |
|/_____________________\|
0                       1 
```

所以让我们从我的纹理/索引/顶点数组开始：

**这就是我设置的：**

```
#define RECT_TOP_R      {1, 1, 0}
#define RECT_TOP_L      {-1, 1, 0}
#define RECT_BOTTOM_R   {1, -1, 0}
#define RECT_BOTTOM_L   {-1, -1, 0}
#define BACK_RIGHT      {1, 0, -1.73}
#define BACK_LEFT       {-1, 0, -1.73}

const GLKVector3 Vertices[] = {
    RECT_BOTTOM_L,  //0
    RECT_BOTTOM_R,  //1
    RECT_TOP_R,     //2
    RECT_TOP_L,     //3
    BACK_LEFT,      //4
    BACK_RIGHT      //5

};

const GLKVector4 Color[] = {
    {1,0,0,1},
    {0,1,0,1},
    {0,0,1,1},
    {0,1,0,1},
    {1,0,0,1},
    {0,1,0,1},
    {0,0,1,1},
    {0,1,0,1}
};

const GLubyte Indices[] = {
    0,1,3,
    2,4,5,
    0,1
};

const GLfloat texCoords[] = {
    0,0,
    1,0,
    0,1,
    1,1,
    1,1,
    0,0,
    0,0,
    1,0
}; 
```

**在这里，我生成/绑定缓冲区。**

```
glGenBuffers(1, &vertexArray);
glBindBuffer(GL_ARRAY_BUFFER, vertexArray);
glEnableVertexAttribArray(GLKVertexAttribPosition);
glVertexAttribPointer(GLKVertexAttribPosition,3,GL_FLOAT,GL_FALSE,sizeof(Vertices),0);
glBufferData(GL_ARRAY_BUFFER, sizeof(Vertices), Vertices, GL_STATIC_DRAW);

glGenBuffers(1, &indexBuffer);
glBindBuffer(GL_ELEMENT_ARRAY_BUFFER, indexBuffer);
glBufferData(GL_ELEMENT_ARRAY_BUFFER, sizeof(Indices), Indices, GL_STATIC_DRAW);

glGenBuffers(1, &colArray);
glEnableVertexAttribArray(GLKVertexAttribColor);
glVertexAttribPointer(GLKVertexAttribColor, 4, GL_FLOAT, GL_FALSE, sizeof(Color), 0);
glBufferData(GL_ARRAY_BUFFER, sizeof(Color), Color, GL_STATIC_DRAW);

glGenBuffers(1, &texArray);
glEnableVertexAttribArray(GLKVertexAttribTexCoord0);
glVertexAttribPointer(GLKVertexAttribTexCoord0, 2, GL_FLOAT, GL_FALSE, sizeof(texCoords),0);
glBufferData(GL_ARRAY_BUFFER, sizeof(texCoords), texCoords, GL_STATIC_DRAW); 
```

所以我有一个关于缓冲区的问题：

*   GL_ARRAY_BUFFER 和 GL_ELEMENT_ARRAY_BUFFER 有什么区别？

**这是 gelegate 方法，它在重绘时调用：**

```
- (void)glkView:(GLKView *)view drawInRect:(CGRect)rect {

    self.contentScaleFactor = 2.0;
    self.opaque = NO;

    glClearColor(1.0f, 1.0f, 1.0f, 0.0f);
    glClear(GL_COLOR_BUFFER_BIT);

    [self.effect prepareToDraw];

    glDrawElements(GL_TRIANGLE_STRIP, sizeof(Indices), GL_UNSIGNED_BYTE, 0);

} 
```

因此，代码显然不能相应地工作。请你帮助我好吗 ？我一直在努力让它发挥作用，但我正在失去神经。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-25T01:47:48.357

好的，所以我肯定在那里做错了什么。我重用了网站上的代码，该网站基本上将所有顶点数据存储在一个结构中。但是，我已经更改了代码，因为我已将各个属性数组（颜色、纹理坐标）分成单独的数组。之前，struct 是自己缓冲的，所以 struct 由 GPU 与纹理数组和颜色数组作为一个整体进行处理。现在 - 在我的更改之后 - 我需要单独生成和绑定这些缓冲区。

我可以部分解决的另一个问题是索引和纹理映射的问题。我不知道我是否理解正确，但是如果我将纹理坐标 (x,y) 分配给某个索引，然后重用该索引 - 目的是在那个确切的位置有另一个纹理坐标 - 那么显然我不会有理由怀疑为什么一切都搞砸了。

我最终所做的并没有完全解决我的问题，但是我离我的既定目标又近了很多，就 openGL 而言，我为我的学习曲线感到非常自豪。此答案适用于可能面临相同问题的其他人，我希望我不会在这里传播任何错误信息。请随时编辑/指出任何错误。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-19T23:24:49.597

作为对您自己的回答的回应，您提到的结构中的顶点数据称为数组结构。苹果推荐你使用这种[布局](http://developer.apple.com/library/ios/#documentation/3DDrawing/Conceptual/OpenGLES_ProgrammingGuide/TechniquesforWorkingwithVertexData/TechniquesforWorkingwithVertexData.html#//apple_ref/doc/uid/TP40008793-CH107-SW10)。

# tsql - 批量插入时计算读取行数

> ID：14023019
> 
> 赞同：1
> 
> 时间：2012-12-24T15:18:26.960
> 
> 标签：tsql, bulkinsert

是否可以计算从导入文件中读取的行数？

```
INSERT INTO table1(col1, col2)  
SELECT col1, col2 
FROM  OPENROWSET(BULK  'F:\test.csv',  FORMATFILE='f:\test.XML',  ERRORFILE='F:\test.csv.log') AS a
WHERE col1%3=0; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-25T13:55:31.153

尝试在您的声明语句之后检查[@@ROWCOUNT 。](http://msdn.microsoft.com/en-us/library/ms187316%28v=sql.100%29.aspx)

# kendo-ui - Kendo UI：TreeView - 如何判断给定节点是否有父节点

> ID：14023020
> 
> 赞同：1
> 
> 时间：2012-12-24T15:18:37.603
> 
> 标签：kendo-ui, kendo-treeview

我正在尝试在 TreeView 上使用 dragend 事件，以便向服务器发送命令以进行适当的更改，但是，为此我需要目标节点和目标节点上的父信息。目前我有以下内容：

```
function dragEndEvent(e) {

    var treeViewData = $(".hierarchy-tree").data('kendoTreeView');

    var quotaSetID = $("#quotaset-id").val();
    var columnID = $("#treeViewColumnID").val();
    var targetNode = treeViewData.dataItem(e.sourceNode);
    var targetParentNode = targetNode.parent();
    var destinationNode = treeViewData.dataItem(e.destinationNode);
    var destinationParentNode = null;
    if(destinationNode!=null )
        destinationParentNode = destinationNode.parent();

    var targetName = targetNode.text;
    var targetID = targetNode.id;
    var targetsParentID = null;
    if (targetParentNode != null && targetParentNode.length == 1)
        targetsParentID = targetParentNode[0].id;

    var destinationName = null;
    var destinationID = null;
    var destinationsParentID = null;
    if (destinationNode != null) {
        destinationName = destinationNode.text;
        destinationID = destinationNode.id;
        if (destinationParentNode != null && destinationParentNode.length == 1)
            destinationsParentID = destinationParentNode[0].id;
    }
    // Followed by ajax query
} 
```

我注意到的是 parent() 调用返回一个列表，在我看来，它似乎没有任何关于实际父级的指示。也许我捕捉到了错误的事件，但是在这里， parent() 函数似乎返回了目标节点的兄弟姐妹。我还希望能够判断节点是否没有父节点（即它位于根级别）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-25T11:51:32.490

使用 parentNode()，因为 parent() 返回包含此 dataItem 的数组，如您所见。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-03-02T15:46:50.363

我也没有看到 parentNode() 方法。要判断一个节点是否是 dragend 事件中的顶级节点，您可以使用 jquery。您也可以使用 jquery 来获取 UID，然后您可以使用它来获取数据节点。

```
var targetNode = e.destinationNode;
if ($(targetNode).parent("ul").parent(".k-treeview").length === 1) {
    //top level node
} else {
    //not top level node
    var htmlNode = $(targetNode).parent("ul").parent(".k-item");  
    //if you need the telerik version of the node
    var treeViewData = $(".hierarchy-tree").data('kendoTreeView');
    var parentUid = $(htmlNode).data("uid");
    var parentNode = treeViewData.findByUid(parentUid);
    var parentDataNode = treeViewData.dataItem(parentNode);
    var parentid = parentDataNode.id;
} 
```

# java - 如何创建自己的jar文件并导入？

> ID：14023022
> 
> 赞同：-2
> 
> 时间：2012-12-24T15:19:01.237
> 
> 标签：java, eclipse, jar

假设我有一个可以在许多项目中使用的 java 类文件。所以，我想创建一个 jar 文件，它可以根据需要在任何其他项目中使用。如何做到这一点？我正在使用 Eclipse IDE。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-24T15:30:50.263

我找到了如下解决方案：

首先根据需要创建您的 java 文件。右键单击您的项目 -> 单击导出 -> 选择选项 jar，按照对话框操作。现在，您已经创建了自己的 java jar 文件。

根据需要创建新项目，在导入其他 jar 文件时导入该 jar 文件。现在，您可以根据需要导入创建的 jar 文件的方法或任何内容...

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-24T15:22:02.730

[您可以在此处](https://help.eclipse.org/2020-09/index.jsp?topic=%2Forg.eclipse.jdt.doc.user%2Ftasks%2Ftasks-32.htm)找到在 Eclipse 中创建 JAR 的所有必要步骤

# git - 颠覆和 GIT 集中化

> ID：14023023
> 
> 赞同：4
> 
> 时间：2012-12-24T15:19:03.123
> 
> 标签：git, svn, version-control

我已经使用 subversion 有一段时间了，我正在考虑学习并切换到 GIT，因为现在它似乎是大多数人的偏好。

尽管如此，GIT 的最大优势之一（及其复杂性的来源）是去中心化的能力，每个人都有自己的存储库并在需要时合并存储库。我对这个功能不感兴趣，实际上我想把所有东西都集中在一个服务器上，无论是对于我独自工作的项目，还是希望多人始终拥有最新源的项目都存储在同一台服务器，没有或只有最少数量的分支/分叉。

考虑到这一点，并且目前大多数开发都是在 Windows 上使用 Visual Studio 完成的，并且还需要使用一些简单的 svn 命令从 Linux 进行一些访问，GIT 仍然是一个不错的选择吗？值得转换吗？GIT 还提供了哪些其他使我们受益的功能？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-24T17:05:31.940

让我说清楚。

*   您正在非常成功地使用 Subversion。
*   您不想使用 Git 中的分布式功能。
*   您正在使用 VisualStudio 开发。

那么，为什么要切换到 Git 呢？

我知道有很多关于 Git“比 Subversion*更好*”的议论，但其中大部分是真正不了解版本控制的人。他们看到许多开源项目使用 Git，并假设如果 Linux 使用 Git，它一定会更好。

我同时使用 Git 和 Subversion，发现它们各有优缺点。

*   当没有中央存储库时，Git 很棒。事实上，这是你唯一的选择。
*   如果您不想了解用户访问的详细信息，Git 非常棒。您授予关键看门人访问权限，并让他们弄清楚允许谁提交代码更改。
*   Git 非常适合纯敏捷商店。也就是说，没有固定的发布时间表或客户承诺的商店。事实上，真正的敏捷流程是在设计时考虑了 Git。
*   当您的所有开发人员都是顶级明星时，Git 也很棒。这些人知道 Git。它们彼此共享存储库访问权限。他们测试，他们整合，他们计划，他们互相合作。他们不需要*项目经理*或*配置经理*，这就是为什么我不经常与这样的明星团队合作的原因。值得庆幸的是，大多数开发团队都不是顶级团队。否则，作为一名CM，我会失业。

当客户要求交付成果和发布截止日期时，Git 的问题就会开始显现。Git 在持续集成环境中不能很好地工作，除非您像母鸡一样对待您的开发人员。发生的情况是在发布周期结束之前，不会将任何更改传递到中央存储库。然后，您在发布的最后几天被困在试图处理不兼容、冲突和其他问题。

使用像 Subversion 这样的集中式存储库，开发人员被迫一起工作。他们在代码中进行更小、更增量的更改。借助良好的持续集成环境，您的 QA 团队可以提取中间版本并进行测试，而无需等待最终版本。

作为奖励，Subversion 通过 AnkhSVN 与 VisualStudio 进行了出色的集成。终于有了VisualStudio 的[Git 源代码提供程序](http://gitscc.codeplex.com/)，但它依赖于 TortioseGit 和 BASH shell。同时，AnkhSVN 是一个完全封装的源代码提供者，其界面类似于您使用 VisualStudio 或 TeamFoundation，因此 VisualStudio 开发人员对它非常熟悉。

所以，除非你**所有**的开发者都想要 Git，或者你打算使用 Git 的分布式特性，否则真的没有理由仅仅为了切换而切换。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-26T08:55:45.283

您可能想要从 SVN 切换到 Git 的主要原因有两个：

*   强大的分支和合并（允许您实现所需的任何分支模式）
*   它比SVN快得多
*   它也已分发，但似乎它不是您要寻找的东西之一

但是，正如您所提到的，Git 需要注意的是它不能集中化：好的，您可以拥有一个中央服务器，但您也需要有一个本地存储库，因此开发人员需要：

*   签入更改
*   然后推送更改

两步。通常这不会成为问题，但在某些情况下，它可能是留在 SVN 上的主要原因。

话虽如此，虽然 Git 是一个很好的选择，但考虑到你基本上是在 Visual Studio 上……你为什么不看看[www.plasticscm.com](http://www.plasticscm.com)（免责声明：我确实为这家公司工作）。我们最近发布了一项功能，允许您直接推送和拉取到 git 服务器……以防万一您需要混合方法：[http ://codicesoftware.blogspot.com/2012/10/direct-pushpull-from -plastic-scm-to-git.html](http://codicesoftware.blogspot.com/2012/10/direct-pushpull-from-plastic-scm-to-git.html)。它可以作为一个选项（SVN 风格）完全集中工作，但也具有所有合并功能、图形和 VStudio 集成。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-12-24T21:39:40.477

目前我在 Windows 上使用带有 Visual Studio 的 Git，我喜欢它。不过，我是在不久前开始在 Linux 上学习 Git 的。最初，我正在为我当时工作的一个项目运行 git-svn。尽管 git-svn 不允许利用所有 Git 功能，但它足以让我找到使用 Git 的方式并说服自己 Git 对我们的开发有用。只有在那之后，我们才决定将该存储库从 SVN 转换为 Git。

我认为 Git 的主要优势在于它足够灵活，可以适应不同的工作流程。因此，您可以选择最适合您的开发团队的内容。集中式与分布式不是两个特定工作流程之间的选择，而是更多可能的工作流程之间的选择。如果您决定继续使用类似于 SVN 的集中式工作流程，那么使用 Git 仍然有一些优势。

首先，在与上游合并之前提交更改。SVN 会在您有机会提交工作之前强制您执行“svn update”。这意味着如果您在此合并过程中犯了错误，您可能会丢失您的工作。在 SVN 中，您不能丢弃当前的合并状态并再次重做。此外，除非此人可以直接访问您计算机上的工作树，否则您不能要求更有经验的人帮助进行重要的合并。

一般来说，提交和合并使您的历史记录更加真实，因为它显示了您进行更改的实际状态以及您如何解决冲突。缺点是历史不再是线性的。使用 Git，您可以通过执行“git pull --rebase”（可以配置为默认设置）来保留线性历史记录，这使您的历史记录像使用 SVN 一样是线性的。

SVN 的第二个问题是，当您将更改提交到中央存储库时，您永远不知道其他人是否同时进行了更改。如果这些更改是针对不同的文件进行的，SVN 将接受您的 ChangeSet。结果，您在 SVN 存储库中有一个没有人测试过的新状态。通常，对不同文件所做的更改不会导致问题，但有时会。例如，一位开发人员更改了 C 标头中的某些函数以及所有使用该函数的位置，但另一位开发人员在新代码中添加了该函数的新用法。因此，即使每个开发人员都测试了他或她的更改，您最终也会在主开发分支上出现损坏的状态。在有人说“svn update”之前，开发人员可能不会立即注意到这种破坏，但此时此人可能有他/她自己的更改，

另一个有用的 Git 特性是它允许你在不提交任何东西到主干的情况下尝试一些想法。然后，如果它不起作用，你可以丢弃它，没有人会注意到。不是我喜欢向别人隐瞒一些东西，而是我不想强迫其他人将他们的工作与我的实验性东西合并，这些东西最终可能会被删除。此外，删除此实验代码会成为问题，因为它与其他更改交织在一起。因此，如果您使用 SVN，您唯一的选择就是在使用此功能时不提交任何内容。然而，它最终导致了一个巨大的补丁炸弹，而不是小的逻辑步骤，即在出现问题时要么进行审查和平分。

顺便说一句， git-bisect 对于对抗代码中棘手的回归非常有用。如果有东西坏了，可能不清楚是什么以及为什么。所以你需要找到引入这个问题的提交，而 git-bisect 是完成这项工作的最佳工具。

最后，您有更多选择来决定如何更好地处理某些情况。例如，您的核心团队成员可以将他们的更改直接推送到“主干”（在 Git 中通常称为“主控”），但您可能不希望新分配的人在没有任何审查的情况下推送他的更改。因此，只需告诉他将他的更改推送到同一中央存储库中的单独分支上，然后给他的导师发送电子邮件，如果这些更改是好的，他将审查并合并这些更改。Git 中的分支真的很便宜，你不应该害怕使用它们。当一个短暂的主题分支被合并到上游时，它的名字通常会被删除，所以它不会使分支命名空间混乱。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-12-27T10:47:26.987

> 考虑到这一点，并且目前大多数开发都是在 Windows 上使用 Visual Studio 完成的，并且还需要使用一些简单的 svn 命令从 Linux 进行一些访问，GIT 仍然是一个不错的选择吗？

是的。Git 将允许您将版本控制用作备份系统（仅在本地提交内容并在您拥有完整功能时发布）和用于探索性工作（在新分支中对新功能进行原型设计，如果它不起作用，则删除分支）。

Git 的分布式特性不会妨碍使用集中式环境，它只是不会强加它。

> 值得转换吗？

在我看来，是的。我使用过很多源代码控制系统，在切换到分布式（当时是 mercurial）之后，对我的工作影响如此之大，以至于下次我不得不使用 SVN 进行项目时，我在本地安装了 mercurial最重要的是，“本地提交”和无痛合并功能。

> GIT 还提供了哪些其他使我们受益的功能？

分支将允许您在不影响整个团队的情况下共享未完成的工作。这意味着您可以将您的工作发送给同事进行审查、反馈、测试或贡献，而完全不会影响主要分支。

本地提交将允许您同时处理多个功能（根据需要在它们之间切换，或保存您当前的工作，切换到其他内容，然后轻松返回）。它们还允许您将版本控制系统用于备份点（因为您可以提交任何内容，无论它是否编译或代码是否干净、经过测试或审查，如果代码未编译，则不会影响其他所有人）。

例如，我有一个代码清理分支，当我没有其他任务（或者很无聊，或者有一点时间）时，我会处理它。我只在清理文件或模块时将其推送到服务器上。

（本地）分支还允许您处理影响整个代码库（或大部分代码库）的更改，而无需让团队的其他成员“在您提交之前什么都不做”，这样他们就不会在您同步时引入合并冲突。

还有另一个方面：使用 SVN，添加不完整的代码会迫使您将其放置在奇怪`#ifdef FEATURE_NAME`的块中，这样即使代码不完整，其他人也可以解决半实现的功能。使用 git，您根本不需要这样做，因为您可以根据需要将不完整的更改保存在分支（本地或集中式）中。这最大限度地减少了代码混乱。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-12-24T17:10:10.023

git 非常灵活。您可以以集中或分散的方式使用它。这真的是关于工作流程。如果您希望所有开发人员都在同一页面上，则每个人都需要定期推送/拉取/获取。github 有很多很棒的通知功能来提醒人们更新（例如电子邮件和 atom 提要）。我们在我的工作中为私人回购付费，而且我经常使用这些提要。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-12-24T15:35:36.743

我现在正在我的企业中实施高度集中的工作流程，是的，Git 在该设置中运行良好。
唯一的问题是添加中央服务器所需的适当身份验证和授权层，以允许或拒绝 git（推/拉/克隆）操作。
有关更多信息，请参阅“[分布式版本控制系统和企业 - 一个好的组合？](https://stackoverflow.com/questions/5683253/distributed-version-control-systems-and-the-enterprise-a-good-mix/5685757#5685757) ”。

# c - strcat() 用于格式化字符串

> ID：14023024
> 
> 赞同：13
> 
> 时间：2012-12-24T15:19:04.617
> 
> 标签：c, string, concatenation, printf

我在我的程序中逐个构建一个字符串，当我在末尾添加一个简单的字符串时，我目前正在使用 strcat() 的混合，但是当我添加格式化的字符串时，我正在使用 sprintf() 例如：

```
int one = 1;
sprintf(instruction + strlen(instruction), " number %d", one); 
```

是否可以使用 strcat() 连接格式化的字符串，或者什么是首选方法？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-12-24T15:25:06.607

您的解决方案将起作用。调用 strlen 有点尴尬（特别是如果字符串变得很长）。sprintf() 将返回您使用的长度 [strcat 不会]，所以您可以做的一件事是这样的：

```
 char str[MAX_SIZE];
 char *target = str;

 target += sprintf(target, "%s", str_value);
 target += sprintf(target, "somestuff %d", number);
 if (something)
 {
    target += sprintf(target, "%s", str_value2);
 }
 else
 {
    target += sprintf(target, "%08x", num2);
 } 
```

我不确定 strcat 在以这种方式使用时是否比 sprintf() 更有效。

编辑：应该写更小的例子......

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2012-12-24T15:23:52.933

不，这是不可能的，但您可以`sprintf()`在那些简单的字符串上使用并避免`strlen()`每次都调用：

```
len = 0;
len += sprintf(buf+len, "%s", str);    
len += sprintf(buf+len, " number %d", one); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-12-24T17:44:04.190

当然，要回答直接问题，*可以*使用`strcat`附加格式化字符串。您只需要先构建格式化的字符串，然后您就可以使用`strcat`它来附加它：

```
#include <stdio.h>
#include <string.h>
int main(void) {
    char s[100];
    char s1[20];
    char s2[30];
    int n = 42;
    double x = 22.0/7.0;

    strcpy(s, "n = ");
    sprintf(s1, "%d", n);
    strcat(s, s1);

    strcat(s, ", x = ");
    sprintf(s2, "%.6f", x);
    strcat(s, s2);

    puts(s);
    return 0;
} 
```

输出：

```
n = 42, x = 3.142857 
```

但这不是一个特别好的方法。

`sprintf`与写入现有字符串的末尾一样有效。有关示例，请参见[Mats 的答案](https://stackoverflow.com/a/14023079/827263)和[mux 的答案](https://stackoverflow.com/a/14023067/827263)。用于保存单个字段的单个数组不是必需的，至少在这种情况下不需要。

并且由于此代码不跟踪字符串的结尾，因此性能可能很差。`strcat(s1, s2)`首先必须扫描`s1`找到终止`'\0'`，*然后*将内容复制`s2`到其中。其他答案通过推进索引或指针来跟踪字符串的结尾而不必重新计算它来避免这种情况。

此外，代码不努力避免缓冲区溢出。`strncat()`可以这样做，但它只是截断字符串；它不会告诉你它被截断了。`snprintf()`是个不错的选择；如果有足够的可用空间，它会返回它*会*写入的字符数。如果这超出了您指定的大小，则字符串被截断。

```
/* other declarations as above */
size_t count;
count = snprintf(s, sizeof s, "n = %d, x = %.6f", n, x);
if (count > sizeof s) {
    /* the string was truncated */
} 
```

并且要附加多个字符串（例如，如果有条件或重复地附加一些字符串），您可以使用其他答案中的方法来跟踪目标字符串的结尾。

所以是的，可以使用`strcat()`. 这不太可能是一个好主意。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-24T16:23:12.017

根据需要编写自己的包装器。

对此的调用如下所示：-

```
result = universal_concatenator(4,result,"numbers are %d %f\n",5,16.045);  
result = universal_concatenator(2,result,"tail_string"); 
```

如果您需要使用 sprintf() 或 strcat()，您可以定义一个函数来解决您的担忧。这就是函数的样子：-

```
/* you should pass the number of arguments
 * make sure the second argument is a pointer to the result always
 * if non formatted concatenation:
 *         call function with number_of_args = 2
 * else
 *         call function with number of args according to format
 *         that is, if five inputs to sprintf(), then 5.
 *
 * NOTE : Here you make an assumption that result has been allocated enough memory to
 *        hold your concatenated string. This assumption holds true for strcat() or
 *        sprintf() of your previous implementation 
 */

char* universal_concaternator(int number_of_args,...)
{
  va_list args_list;
  va_start(args_list,number_of_args);
  int counter = number_of_args;
  char *result = va_arg(args_list, char*);
  char *format;
  if(counter == 2) /* it is a non-formatted concatenation */
  {
      result = strcat(result,va_arg(args_list,char*));
      va_end(args_list);
      return result;
  }
  /* else part - here you perform formatted concatenation using sprintf*/
  format = va_arg(args_list,char*);
  vsprintf(result + strlen(result),format,args_list);
  va_end(args_list);
  return result; 
}

/* dont forget to include the header 
 * <stdarg.h> #FOR-ANSI 
 * or <varargs.h> #FOR-UNIX
 */ 
```

它应该首先确定它应该调用两者中的哪一个（strcat 或 sprintf），然后它应该进行调用，并使您可以轻松地专注于您正在处理的任何事情的实际逻辑！只需上面的 ctrl+c 代码和 ctrl+v 进入您的代码库。

注意：马特的答案是长字符串的好选择。但是对于短字符串长度（<250），应该这样做。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-12-24T15:37:40.230

首选方法是什么，取决于您愿意使用什么。*我*将使用`GString`GLib 或 GLib`g_strdup_print`函数中的数据结构，而不是执行所有这些手动（并且可能是危险的）字符串操作。对于您的问题，`GString`提供[g_string_append_printf](http://developer.gnome.org/glib/2.28/glib-Strings.html#g-string-append-printf)函数。

# c# - android 错误 CopyGeneratedJavaResourceClasses 的单声道

> ID：14023026
> 
> 赞同：2
> 
> 时间：2012-12-24T15:19:09.827
> 
> 标签：c#, android, xamarin.android, fips

我正在我的电脑上安装适用于 android 的单声道

安装程序完成后，我为 Mono for Android 安装了 Xamarin Installer

我打开 MonoDevelop 并创建了新的 android 项目并收到此错误

```
> C:\Program Files
> (x86)\MSBuild\Novell\Novell.MonoDroid.Common.targets(2,2): Error
> MSB4018: The "CopyGeneratedJavaResourceClasses" task failed
> unexpectedly.
> 
> System.InvalidOperationException: This implementation is not part of
> the Windows Platform FIPS validated cryptographic algorithms.
> 
>    at System.Security.Cryptography.SHA1Managed..ctor()
> 
>    at Xamarin.Android.Tasks.MonoAndroidHelper.HashFile(String
> filename)
> 
>    at Xamarin.Android.Tasks.MonoAndroidHelper.HasFileChanged(String
> source, String destination)
> 
>    at Xamarin.Android.Tasks.MonoAndroidHelper.CopyIfChanged(String
> source, String destination)
> 
>    at Xamarin.Android.Tasks.CopyGeneratedJavaResourceClasses.Execute()
> 
>    at
> Microsoft.Build.BackEnd.TaskExecutionHost.Microsoft.Build.BackEnd.ITaskExecutionHost.Execute()
> 
>    at
> Microsoft.Build.BackEnd.TaskBuilder.ExecuteInstantiatedTask(ITaskExecutionHost
> taskExecutionHost, TaskLoggingContext taskLoggingContext, TaskHost
> taskHost, ItemBucket bucket, TaskExecutionMode howToExecuteTask,
> Boolean& taskResult) (MSB4018) (rrr) 
```

当我尝试在 Visual Studio 2010 中创建新的 android 项目时，我也遇到了这个错误，请帮忙！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-27T03:25:00.140

您的计算机上似乎[启用了 FIPS 140 合规性。](http://blogs.msdn.com/b/shawnfa/archive/2005/05/16/417975.aspx)这将不允许执行非 FIPS 认证的算法。

例如，微软`SHA1Managed`没有经过认证，而`SHA1CryptoServiceManager`使用 CryptoAPI 并且*应该*没问题 - 它确实取决于平台和版本。

*简单*的解决方法是[关闭](http://support.microsoft.com/kb/811833)计算机上的 FIPS 合规性（请参阅注册表项的注释）。

# sql - 如何在 Oracle 表中选择一行？

> ID：14023028
> 
> 赞同：0
> 
> 时间：2012-12-24T15:19:10.783
> 
> 标签：sql, oracle, oracle11g

我在 Oracle 中有这个巨大的表：

```
COMPONENTSTATSID    NUMBER(38,0)
COMPONENTTYPEID NUMBER(38,0)
NAME    VARCHAR2(200 BYTE)
SERIALNUMBER    VARCHAR2(150 BYTE)
WEIGHTKG    NUMBER(9,0)
SIZEWEIGHTMILIM NUMBER(6,0)
SIZEWIDTHMILIM  NUMBER(6,0)
ZONECAGE    VARCHAR2(50 BYTE)
SIZELENGHTMILIM NUMBER(6,0)
SIZEDEPTMILIM   NUMBER(6,0)
RAMSLOTS    NUMBER
NETWORKINTERFACE    VARCHAR2(60 BYTE)
RAMSLOTSPEED    VARCHAR2(60 BYTE)
RAMSLOTTYPE VARCHAR2(60 BYTE)
POWERWATT   NUMBER(5,0)
OPERATINGTEMPERATUREMIN NUMBER(4,0)
OPERATINGTEMPERATUREMAX NUMBER(4,0)
STORAGETEMPERATUREMIN   NUMBER(4,0)
STORAGETEMPERATUREMAX   NUMBER(4,0)
DATEFORDECOMISN TIMESTAMP(6)
MANIFACTURECOMPANY  VARCHAR2(100 BYTE)
MANIFACTUREWARRANTY VARCHAR2(100 BYTE)
UFORM   VARCHAR2(30 BYTE)
STATUS  VARCHAR2(30 BYTE)
LOCATION    VARCHAR2(30 BYTE)
HEATEMISIONSBTU NUMBER(10,0)
PRODUCTIONENVIRONMENT   VARCHAR2(30 BYTE)
STANDARTLIFETIME    VARCHAR2(30 BYTE)
OPERATINGHAMIDITYRANGE  VARCHAR2(30 BYTE)
BOUGTHDATE  TIMESTAMP(6)
OPERATINGSYSTEM CLOB
SUPPORTCONTACT  VARCHAR2(100 BYTE)
INTERFACETYPE   VARCHAR2(60 BYTE)
TYPE    VARCHAR2(30 BYTE)
POWERCAPACITYWATT   NUMBER(10,0)
COOLINGCAPACITYBTU  NUMBER(8,0)
DATEADDED   TIMESTAMP(6)
STORAGECONTROLLER   VARCHAR2(60 BYTE)
DATEDEPLOYED    TIMESTAMP(6)
DESCRIPTION CLOB
MAXNUMBERPROCESSORS NUMBER(2,0)
CPUCACHESIZE    VARCHAR2(30 BYTE)
RAMSIZE VARCHAR2(30 BYTE)
USBPORTS    NUMBER(2,0)
CPUCORES    NUMBER
RAIDSUPPORT VARCHAR2(30 BYTE)
EXPANSIONSLOTS  VARCHAR2(60 BYTE)
DISKBAYS    VARCHAR2(60 BYTE)
HOTSWAPCOMPONENTS   VARCHAR2(60 BYTE)
NUMBERPORTS NUMBER(38,0)
PORTSPEED   VARCHAR2(30 BYTE)
MINAMBIENTTEMP  NUMBER(10,4)
MAXAMBIENTTEMP  NUMBER(10,4)
DCALLOWEDWEIGHTKG   NUMBER(10,4)
DCMAXIMUMWEIGHTKG   NUMBER(10,4)
DCALLOWEDPOWERWATT  NUMBER(10,4)
DCMAXPOWERWATT  NUMBER(10,4)
DCALLOWCOOLINGPOWERBTU  NUMBER(10,4)
DCMAXCOOLINGPOWERBTU    NUMBER(10,4)
ISPBGPASNUMBER  VARCHAR2(30 BYTE)
BANDWIDTHUPLOADMB   NUMBER(10,0)
BANDWIDTHDOWNLOADMB NUMBER(10,0)
IPVERSION   VARCHAR2(30 BYTE)
ISPIPRANGE  VARCHAR2(30 BYTE) 
```

我使用这个非常复杂的 sql 查询来选择表中的所有行：

```
 SELECT a.* 
    FROM (SELECT b.*, rownum rn 
    FROM (select y.componentstatsid, y.name, y.status, y.location, y.type, y.powerCapacityWatt, y.coolingCapacityBTU, y.minAmbientTemp, y.maxAmbientTemp, 
    y.operatingHamidityRange, y.dcAllowedWeightKg, y.dcMaximumWeightKg, y.dcAllowedPowerWatt, y.dcMaxPowerWatt, y.dcAllowCoolingPowerBTU, y.dcMaxCoolingPowerBTU, y.datedeployed, y.dateadded, y.description
    FROM component x, componentstats y where x.componentstatsid = y.componentstatsid and y.componenttypeid = 1000 
    ORDER BY %s %s) b 
    WHERE rownum <= ?) a     
    WHERE rn > ? 
```

问题是我如何简化查询以仅选择具有 componentstatsid = 35 的一行？没有`order by`.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-24T15:22:15.207

试试这个，

```
SELECT a.* 
        FROM (SELECT b.*, rownum rn 
        FROM (select y.componentstatsid, y.name, y.status, y.location, y.type, y.powerCapacityWatt, y.coolingCapacityBTU, y.minAmbientTemp, y.maxAmbientTemp, 
        y.operatingHamidityRange, y.dcAllowedWeightKg, y.dcMaximumWeightKg, y.dcAllowedPowerWatt, y.dcMaxPowerWatt, y.dcAllowCoolingPowerBTU, y.dcMaxCoolingPowerBTU, y.datedeployed, y.dateadded, y.description
        FROM component x, componentstats y where x.componentstatsid = y.componentstatsid and y.componenttypeid = 1000 and y.componentstatsid=35
        ORDER BY %s %s) b 
        WHERE rownum <= ?) a     
        WHERE rn > ? 
```

# mvcmailer - MvcMailer 和果园 1.6

> ID：14023029
> 
> 赞同：1
> 
> 时间：2012-12-24T15:19:11.620
> 
> 标签：mvcmailer, orchardcms-1.6

我正在尝试将 MvcMailer 集成到 Orhcard 1.6 中，但出现此错误：

'HttpContext.SetSessionStateBehavior' 只能在引发 'HttpApplication.AcquireRequestState' 事件之前调用。

在文件 Orchard\Mvc\Routes\ShellRoute.cs 第 54 行

我尝试调试，发现错误是从以下位置引发的：

```
private void CreateControllerContext() {
            var routeData = RouteTable.Routes.GetRouteData(CurrentHttpContext);
            ControllerContext = new ControllerContext(CurrentHttpContext, routeData, this);
        } 
```

MvcMailer 的 mailerBase.cs。在普通的 mvc 4 应用程序中一切正常。

有人可以帮助我或已经成功安装的人吗？

谢谢..

这个帖子[http://orchard.codeplex.com/discussions/406407](http://orchard.codeplex.com/discussions/406407)一样的问题..如何解决？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-06T16:54:28.600

我通过执行以下操作为自己解决了这个问题：

1.  将~/src/Orchard/Mvc/Routes（即Orchard.Framework）中1.6版本的ShellRoutes.cs和RoutePublisher.cs替换为1.5版本的ShellRoutes.cs和RoutePublisher.cs。就我而言，我只是去了 CodePlex，选择 1.5 作为版本并将每个文件复制/粘贴到 VS 中。
2.  只编译/构建 Orchard.Framework。
3.  复制您刚刚编译/构建的 Orchard.Framework.dll 并将其放在 Orchard.Web 实例的 ~/bin 文件夹中。

您可以进行比较和/或消除差异，但我只是选择了上述方法，因为它更快。

# c - gcc 内联汇编 - 'add' 的操作数类型不匹配，试图创建无分支代码

> ID：14023032
> 
> 赞同：5
> 
> 时间：2012-12-24T15:19:49.427
> 
> 标签：c, performance, assembly, x86, inline-assembly

我正在尝试做一些代码优化来消除分支，原来的c代码是

```
if( a < b ) 
   k = (k<<1) + 1;
else
   k = (k<<1) 
```

我打算用如下的汇编代码替换它

```
mov a, %rax 
mov b, %rbx
mov k, %rcx
xor %rdx %rdx
shl 1, %rcx
cmp %rax, %rax
setb %rdx
add %rdx,%rcx
mov %rcx, k 
```

所以我像吹一样写c内联汇编代码，

```
#define next(a, b, k)\
 __asm__("shl $0x1, %0; \
         xor %%rbx, %%rbx; \
         cmp %1, %2; \
         setb %%rbx; \
         addl  %%rbx,%0;":"+c"(k) :"g"(a),"g"(b)) 
```

当我编译下面的代码时出现错误：

```
operand type mismatch for `add'
operand type mismatch for `setb' 
```

我该如何解决？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-12-24T17:37:59.727

以下是您的代码中的错误：

1.  *错误：'cmp' 的操作数类型不匹配*-- **CMP**的操作数之一必须是寄存器。您可能正在生成试图比较两个立即数的代码。将第二个操作数的约束从**"g"**更改为**"r"**。（参见[GCC 手册 - 扩展 Asm - 简单约束](http://gcc.gnu.org/onlinedocs/gcc/Simple-Constraints.html#Simple-Constraints)）
2.  *错误：'setb'的*操作数类型不匹配***——SETB**只接受 8 位操作数，即 `setb %bl`有效而`setb %rbx`不能。*
**   C 表达式`T = (A < B)`应转换为`cmp B,A; setb T`AT&T x86 汇编器语法。**CMP**的两个操作数顺序错误。请记住，**CMP**的工作方式与**SUB**类似。*

 *一旦你意识到前两个错误消息是由汇编器产生的，那么调试它们的技巧就是查看 gcc 生成的汇编器代码。尝试`gcc $CFLAGS -S t.c`将有问题的行`t.s`与[x86 操作码参考](http://ref.x86asm.net/coder.html)进行比较。关注每条指令允许的[操作数代码](http://ref.x86asm.net/index.html#Instruction-Operand-Codes)，您将很快发现问题。

在下面发布的固定源代码中，我假设您的操作数是无符号的，因为您使用的是**SETB**而不是**SETL**。我从使用**RBX**切换到**RCX**来保存临时值，因为**RCX**是 ABI 中的一个调用 clobbered 寄存器，并使用`"=&c"`约束将其标记为*earlyclobber*操作数，因为**RCX**在输入之前被清除 `a`并被`b`读取：

```
#include <stdio.h>
#include <stdint.h>
#include <inttypes.h>

static uint64_t next(uint64_t a, uint64_t b, uint64_t k)
{
    uint64_t tmp;
    __asm__("shl $0x1, %[k];"
        "xor %%rcx, %%rcx;"
        "cmp %[b], %[a];"
        "setb %%cl;"
        "addq %%rcx, %[k];"
        : /* outputs */ [k] "+g" (k), [tmp] "=&c" (tmp)
        : /* inputs  */ [a] "r" (a), [b] "g" (b)
        : /* clobbers */ "cc");
    return k;
}

int main()
{
    uint64_t t, t0, k;
    k = next(1, 2, 0);
    printf("%" PRId64 "\n", k);

    scanf("%" SCNd64 "%" SCNd64, &t, &t0);
    k = next(t, t0, k);
    printf("%" PRId64 "\n", k);

    return 0;
} 
```

**main()**转换为：

```
<+0>:   push   %rbx
<+1>:   xor    %ebx,%ebx
<+3>:   mov    $0x4006c0,%edi
<+8>:   mov    $0x1,%bl
<+10>:  xor    %eax,%eax
<+12>:  sub    $0x10,%rsp
<+16>:  shl    %rax
<+19>:  xor    %rcx,%rcx
<+22>:  cmp    $0x2,%rbx
<+26>:  setb   %cl
<+29>:  add    %rcx,%rax
<+32>:  mov    %rax,%rbx
<+35>:  mov    %rax,%rsi
<+38>:  xor    %eax,%eax
<+40>:  callq  0x400470 <printf@plt>
<+45>:  lea    0x8(%rsp),%rdx
<+50>:  mov    %rsp,%rsi
<+53>:  mov    $0x4006c5,%edi
<+58>:  xor    %eax,%eax
<+60>:  callq  0x4004a0 <__isoc99_scanf@plt>
<+65>:  mov    (%rsp),%rax
<+69>:  mov    %rbx,%rsi
<+72>:  mov    $0x4006c0,%edi
<+77>:  shl    %rsi
<+80>:  xor    %rcx,%rcx
<+83>:  cmp    0x8(%rsp),%rax
<+88>:  setb   %cl
<+91>:  add    %rcx,%rsi
<+94>:  xor    %eax,%eax
<+96>:  callq  0x400470 <printf@plt>
<+101>: add    $0x10,%rsp
<+105>: xor    %eax,%eax
<+107>: pop    %rbx
<+108>: retq 
```

您可以在每次调用之前看到`next()`移入**RSI的结果。**`printf()`

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2012-12-24T15:36:38.970

鉴于 gcc（它看起来像 gcc 内联汇编器）产生：

```
leal    (%rdx,%rdx), %eax
xorl    %edx, %edx
cmpl    %esi, %edi
setl    %dl
addl    %edx, %eax
ret 
```

从

```
int f(int a, int b, int k)
{
  if( a < b ) 
    k = (k<<1) + 1;
  else
    k = (k<<1);

  return k;
} 
```

它会认为编写自己的内联汇编程序完全是浪费时间和精力。

与往常一样，在开始编写内联汇编程序之前，请检查编译器的实际作用。如果您的编译器不生成此代码，那么您可能需要将编译器的版本升级到更新的版本（我向 Jan Hubicka [当时 x86-64 的 gcc 维护者] ca 2001 报告了这种事情，并且我敢肯定它在 gcc 中已经存在了一段时间）。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2012-12-24T15:29:38.303

你可以这样做，编译器不会生成分支：

```
k = (k<<1) + (a < b) ; 
```

但是如果你必须，我现在在你的代码中修复了一些东西，它应该可以按预期工作：

```
__asm__(
        "shl  $0x1, %0; \
        xor  %%eax, %%eax; \
        cmpl %3, %2; \
        setb %%al; \
        addl %%eax, %0;"
        :"=r"(k)        /* output */
        :"0"(k), "r"(a),"r"(b)  /* input */
        :"eax", "cc"   /* clobbered register */ 
); 
```

请注意，`setb`需要一个`reg8`or`mem8`并且您应该将其添加`eax`到 clobbered 列表中，因为您更改了它，并且`cc`为了安全起见，至于寄存器约束，我不确定您为什么使用这些，但`=r`工作`r`得很好。您需要添加`k`到输入和输出列表中。[GCC-Inline-Assembly-HOWTO](http://www.ibiblio.org/gferg/ldp/GCC-Inline-Assembly-HOWTO.html)中还有更多内容

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2017-11-29T23:11:32.090

概括：

*   无分支甚至可能不是最佳选择。
*   [内联 asm 打败了其他一些优化，首先尝试其他源代码更改](https://gcc.gnu.org/wiki/DontUseInlineAsm)，例如`? :`经常无分支编译，也使用布尔值作为整数 0/1。
*   *如果*您使用 inline-asm，请确保同时优化约束以使编译器生成的代码*在*您的 asm 块之外有效。
*   **整个事情都可以使用`cmp %[b], %[a]`/ `adc %[k],%[k]`。** 您的手写代码比编译器生成的代码更糟糕，但在常量传播/CSE/内联没有使此代码（部分）优化掉的情况下，它们在小范围内是可以击败的。

* * *

*如果*您的编译器生成分支代码，并且分析显示这是错误的选择（该指令中分支未命中的高计数，例如在 Linux `perf record -ebranch-misses ./my_program`&&上`perf report`），那么是的，您应该做一些事情来获得无分支代码。

（如果它是可预测的，分支可能是一个优势：分支意味着使用的代码的乱序执行`(k<<1) + 1`不必等待`a`和`b`准备好。LLVM 最近合并了一个补丁，[默认情况下](https://bugs.llvm.org/show_bug.cgi?id=33013)[使 x86 代码生成*更加*](https://bugs.llvm.org/show_bug.cgi?id=33013)分支，因为现代 x86 CPU 具有如此强大的分支预测器。Clang/LLVM 夜间构建（带有那个补丁）仍然为此 C 源代码选择无分支，至少在循环外的独立函数中）。

如果这是用于二分搜索，那么无分支可能是一个不错的策略，除非您经常看到相同的搜索。（分支+推测执行意味着你有一个关键路径之外的控制依赖，

**使用配置文件引导优化**进行编译，因此编译器具有关于哪些分支几乎总是单向的运行时信息。它可能仍然不知道一个难以预测的分支与一个整体上采用两条路径但具有简单模式的分支之间的区别。（或者这是基于全局历史可预测的；许多[现代分支预测器设计基于分支历史的索引](https://stackoverflow.com/questions/47052536/indexed-branch-overhead-on-x86-64-bit-mode#comment81079172_47052536)，因此最后几个分支的走向决定了当前分支使用哪个表条目。）

相关：[gcc 优化标志 -O3 使代码变慢然后 -O2](https://stackoverflow.com/questions/28875325/gcc-optimization-flag-o3-makes-code-slower-then-o2)显示排序数组对循环内的条件进行近乎完美的分支预测的情况，以及`gcc -O3`数据依赖的无分支代码（没有配置文件引导优化）瓶颈从使用`cmov`. 但是`-O3 -fprofile-use`会产生分支代码。（另外，一种不同的编写方式使低延迟无分支代码也能更好地自动向量化。）

* * *

**如果您不能[手持编译器制作您想要的 asm](https://stackoverflow.com/questions/40354978/why-is-this-c-code-faster-than-my-hand-written-assembly-for-testing-the-collat)** ，内联 asm 应该是您最后的手段，例如`(k<<1) + (a<b)`按照其他人的建议编写它。

内联汇编破坏了许多优化，最明显的是常量传播（如其他一些答案所示，其中 gcc 将常量移动到内联汇编代码块之外的寄存器中）。 [https://gcc.gnu.org/wiki/DontUseInlineAsm](https://gcc.gnu.org/wiki/DontUseInlineAsm)。

当编译器对某些/所有变量具有常量值时，您可以使用`if(__builtin_constant_p(a))`等来使用纯 C 版本，但这需要更多的工作。（并且不适用于 Clang，`__builtin_constant_p()`在函数内联之前对 where 进行评估。）

即使那样（一旦你将事情限制在输入不是编译时常量的情况下），也不可能为编译器提供全部选项，因为你不能根据哪些约束使用不同的 asm 块匹配的（例如`a`在寄存器和`b`内存中，反之亦然。）如果您想根据情况使用不同的指令，那您就搞砸了，但在这里我们可以使用多种替代约束来展示大部分灵活性的`cmp`。

**让编译器生成接近最优的代码通常比使用内联 asm 更好**。Inline-asm 破坏了编译器重用任何临时结果或分散指令以与其他编译器生成的代码混合的能力。（由于良好的乱序执行，指令调度在 x86 上并不是什么大问题，但仍然如此。）

* * *

那个asm很垃圾。如果你有很多分支未命中，它比分支实现要好，但*更好*的无分支实现是可能的。

你`a<b`是一个无符号比较（你正在使用`setb`，下面的无符号条件）。所以你的比较结果在进位标志中。x86 有一个 add-with-carry 指令。此外，`k<<1`与 是相同的`k+k`。

所以**你想要的 asm**（编译器生成或使用内联 asm）是：

```
# k in %rax,    a in %rdi,  b in %rsi   for this example
cmp     %rsi, %rdi      # CF = (a < b) = the carry-out from edi - esi
adc     %rax, %rax      # eax = (k<<1) + CF  = (k<<1) + (a < b) 
```

编译器足够聪明，可以使用`add`或`lea`左移 1，有些编译器足够聪明，可以使用`adc`而不是`setb`，但它们无法将两者结合起来。

编写带有寄存器参数和返回值的函数通常是了解编译器可能会做什么的好方法，尽管它确实会强制它们在不同的寄存器中产生结果。（另请参阅[此问答](https://stackoverflow.com/questions/38552116/how-to-remove-noise-from-gcc-clang-assembly-output)和 Matt Godbolt 的 CppCon2017 演讲：[“我的编译器最近为我做了什么？解开编译器的盖子”</a>）。](https://youtu.be/bSkpMdDe4g4)

 [```
// I also tried a version where k is a function return value,
// or where k is a global, so it's in the same register.
unsigned funcarg(unsigned a, unsigned b, unsigned k) {
    if( a < b ) 
       k = (k<<1) + 1;
    else
       k = (k<<1);
    return k;
} 
```](https://youtu.be/bSkpMdDe4g4) 

[在 Godbolt 编译器资源管理器上](https://gcc.godbolt.org/#z:OYLghAFBqd5TKALEBjA9gEwKYFFMCWALugE4A0BIEAViAIzkDO6ArqatiAOSsB2TAsD7ZMAaiQBDPpiToANpgj9Bw0WMnkxKoSPEAjLTrXiA1gEoxAUgDsAISsAGAIJi3YgPQfT1gMwARMWwADyIIcytfOzcvMRwAM2xJIiYNTFQxeLIxYFQMkA8nV3cfSMCIU0iAYWr6SysAJmiIDT8qsX0xCKii9zFSbCJ2PjFKnpdbfyKi4z0g0PDIhxdZ9Xj%2BVElSYGUBXXVNbT2TDqNjuYtre173L1KA%2BbDu6M8POOxE5NTJdMzs3PyhRcfQI8RakjaHS61mBfTc93KYxqviqdWsTTE9CWNzc2HkTGwOL6CLEFWqtWeRIGQ1IIzGy2ck2mK3O6iIkgI8k28nku1Uc0OqwMZ356gs2JZovETEkAFtsAMdkKNCL9sKjlLRvVrrC3KDwZDOvVdcS/IjySi0Y1oljxsVcfjCSaSmbSUiKRL7f1BsMxOzOdzeYdDFrPUyJpK1aNgJ7lcB5Oh9JJecrBayDNqGSCwa1qlDjV6SsBXRUYyiKeibZ6%2BniCUSiyXTGXkajKSbqb6m2GbFMI4yXNxzOR5DwAKzcch8HiOCfoHg1JrWsQsdicdG%2BegTojTwdD0wgXwAFgAdAA2RwNUcNACcAA5HI5D45r456KfhzxDxPZSBR75jw0p42L4gHAaBIE2JOO7kHO3ATkwICOOQ27cDOQ5wLAKAYLKAAOnIKpQ1DYXh8gKiABB5PQt7kPEnJEAqCEQPo0H6AQfBbAAnjwm7kNh8p8EQADyfDyFxqETjgsrSPGXDieQhADKgRAEAAbtgCFySE2CoKw9HcRObH0SO3A8UQpAED%2BJmDsOBD6AhkBDugOHKegAg8AAtIJvhiO5ADqybyD58RqaQ%2BjoAS7mSEwso%2BVJHBIGUTCmBx8iSKY2CRSpwSjvQDRBfEUVEO5UlEEg8FsBwXB1B%2B3DjlBcmwcEt6nu5p6HmIFEZFRpL4MQ2SNBuWhVOguH4aQ651FuO7mEOSBJDgpDUEOxlfuQP6Hqex5gUBIE7eB9UzjBPDwYhyHTXuB4ng0t5Xr4jinrevhtQ%2B16HjVvgTlODXHWd4noYgEBYSNJEEVQEDEWNIDADYDQ0XRDHUMxcmsexpBiTxfHYAJwmidBknSaReMEIpylqRph1aTpelWZQAl4vpyHmZZm7LbZ9nhDBzkEK5GnucEGSed5fkBUFIVhRFUUxcVWyoAlARJSlaXYOVq5VctY6fdBjXNa17UAmINgAT1hAkONA2MGIw2jaRZsNCB5hTX9s3zWRHP7iBx6%2BLe9CHr4o53ndgGjreb0rd%2BDAPgds4/QhSEoWh5AYQg8CA2gwNjYR4PpzbaCpXwwAAPpmfwphw/I9GkIxSOHSjnEM5j2MiWJh34/nhNyQp2mk%2Bp0GU7psk8YZ9M02ZFn6azdnwI5XM8x5/M%2BV5Pn%2BTysUy3L/gK6l6Uq5VDDq7VmvfdwTUtW1YioHnxYQMXfCXBAvWmxNQ3Zwq66%2BA7v1oRdvj/j/f//wAmqq0fx/mPBtP84CjynggZBL6h1YInTjtNROAMgbW1BkRF%2Bi0L70GvAXNqZcK5VxYmxOuNMG5CSbnjbAUk26yRbsTLuqke6aWCNpfuDMh7GVMkzceNlJ4OU5i5Ny3BPLBB3pwPeNU6pwOjsfHWZ8ACyABlAAau0XBYgGivhsGIAASgAFV8sbPqttBqWyweuQ8H9467nIHNH4rt97AJABtY8EDoFQI8X%2BKOR04LMFOrYma5B3a/wAeEn%2B71D7wJ%2BkE/eDRolyMdl/cgIVBCuVcUAA%3D%3D%3D)，以及其他几个版本。（我`unsigned`在这个版本中使用过，因为你`addl`在你的 asm 中使用过。使用`unsigned long`将除异或归零之外的所有内容都变为 64 位寄存器。（`xor %eax,%eax`仍然是使 RAX 归零的最佳方法。）

```
 # gcc7.2 -O3  When it can keep the value in the same reg, uses add instead of lea
    leal    (%rdx,%rdx), %eax       #, <retval>
    cmpl    %esi, %edi      # b, a
    adcl    $0, %eax        #, <retval>
    ret 
```

#clang 6.0 快照 -O3 xorl %eax, %eax cmpl %esi, %edi setb %al leal (%rax,%rdx,2), %eax retq

# ICC18，与 gcc 相同，但无法保存 MOV addl %edx, %edx #14.16 cmpl %esi, %edi #17.12 adcl $0, %edx #17.12 movl %edx, %eax #17.12 ret #17.12

MSVC 是唯一一个不用手动就不会生成无分支代码的编译器。(为我们提供了与上面 clang`(k<<1) + ( a < b );`完全相同的`xor`///序列（但使用 Windows x86-64 调用约定）。`cmp``setb``lea`

```
funcarg PROC                         ; x86-64 MSVC CL19 -Ox
    lea      eax, DWORD PTR [r8*2+1]
    cmp      ecx, edx
    jb       SHORT $LN3@funcarg
    lea      eax, DWORD PTR [r8+r8]   ; conditionally jumped over
$LN3@funcarg:
    ret      0 
```

* * *

# 内联汇编

其他答案很好地涵盖了您的实施问题。要调试内联 asm 中的汇编器错误，请[使用`gcc -O3 -S -fverbose-asm`](https://stackoverflow.com/questions/38552116/how-to-remove-noise-from-gcc-clang-assembly-output)填充 asm 模板来查看编译器向汇编器提供的内容。您会看到`addl %rax, %ecx`什么的。

**这种优化的实现**使用[多种替代约束](https://gcc.gnu.org/onlinedocs/gcc/Multi-Alternative.html)，让编译器选择CMP `cmp $imm, r/m`、`cmp r/m, r`或`cmp r, r/m`形式。我使用了两个替代方法，它们不是通过操作码而是通过哪一侧包含可能的内存操作数来分割事物。 `"rme"`类似于`"g"`(rmi) 但仅限于 32 位符号扩展立即数）。

```
unsigned long inlineasm(unsigned long a, unsigned long b, unsigned long k)
{
    __asm__("cmpq %[b], %[a]   \n\t"
            "adc %[k],%[k]"
        : /* outputs */ [k] "+r,r" (k)
        : /* inputs  */ [a] "r,rm" (a), [b] "rme,re" (b)
        : /* clobbers */ "cc");  // "cc" clobber is implicit for x86, but it doesn't hurt
    return k;
} 
```

[我把它放在 Godbolt 上，调用者在不同的上下文中内联它](https://gcc.godbolt.org/#z:OYLghAFBqd5TKALEBjA9gEwKYFFMCWALugE4A0BIEAViAIzkDO6ArqatiAOQD0vAaiTYANgAcmAgLIBlAGoBhAKQAGAIKsAdkwLBN2TAJHpNwIQENNmJOhGYIWnXoNGTZ8%2BQGPd%2Bw8dMCAEae3s5%2BbgIA1gCUAkoA7ABCqmoCaQL8kXEAzAAiAtgAHkQQ0UrZiWn8AjgAZtjmRJLmmKgCtWQCwKhtILwp6VE5%2BRCR5crZCvSxSgBMlRAC5jkKQQJlFQPppNhE7JpR5cnqCbkpKaG%2BrgFFJRvHGto%2BLv5mtVqo5qTADk9h1%2B4Qn8rq8gkCnCCIjE4kktlVeFlyvlbqUjvCath6o1mq12p1ur1%2BupBgRaotluM1jNiYM0oi8gJRuNxtM4vMBPQjnCCiImNhuel6SMxpMWfduTs9qQDiKHqdzupLi8IkRzAQRJ8RCJfhDlQEPF5gXqzMFDbrwgEYlzFUaLWYmOYALbYHY/JV2pbg54e03ugFRGawmlpUnklZUuLBwZCxkiiZTGbszmbKOiPkCunDWPMybTa2pba7fYCVXqzXag2mq0ptTyk4283%2ByLAfN%2B0HAYyBczatsRA29gKBQMPElkpbhwLrSMF2nNrOjFui3OJyrJkfpNP8qOCsxI2OL%2BN5muDSXF5v5uu1hve/0ETQiO8NJiOnU30H923%2B32f0FWk5BmcBAAfSA8xnxAiA5lmVBHTEABHNkAFYlEQxJAhQ3JPDmZDUPMDD0hQhRNEIogoIzWk2VmFo2mwlDEjGRDMNo1CGLOWZZnIgQQAyAAqAQ2CIMRWCaAQeMEOjWMouZEgoUgoNjMpt3SbjeD4u8hJE0TxNw/CoNkx15Igcxoiw1D0MYyjSGdcgdkModOJUvjUE7QIXUkMTKJ6KDxSjU9pUOGtLwuH8InLICAHdiCQIDnRfAczB48wxCIUhhwlIt/LvB99DAl9EuSigBEQ4ris8AAWHza3iM560eRtQTCyKiGikQvmAbAgIIR04pC/U0t8jKDiyx9cqMzwSomybSoECqL2qhU6rfULuxECKoqAwJYtff53y9HaIh4wICv6wD%2BD8ob7xG58IHoWZsk8Q6CvKyqT0GgRhpy66DUelLnrmmqr0B%2BKBEa9bYqAzQTFG4H8pSk7XqlA4kEsaxbHsWHCsQv7Auq7gTJEHhEO4chNB4FRifQHhlHmaSBBYdhODZbJ6GJogybxkzIhAbIyoAOgANhUWZENmABOAAOFQVDKlRRZUeh%2BfIAnuDK4nHRARDsl52Z%2BfibIdb1g39fiEn2fISnuGJpgQBUcg2e4cmTLgWAUAwWD1RdShqDdsQPdIEACB6ehxfIWp1SINzqECM3AjvL4AE8eBZ8g3edTQiAAeXvROHeJnBHUsDsuFz8hCB2VAiAIAA3bBrZLopsFQYTi%2BTu8I%2BV5OUq6pO8aVghAmtyATPQZKCBMOuAFoM%2ByAQJ4AdRW2fahr0hAnQPkJ9y2eC44JAkSYSJ49ayJsCttgOC4aYlcJ4nSZLi3CnF/mJ/5sr3p6DlxcZfBiE6OZmc8AodA7sRAuiZtMVm7NogmWEC0F01B8Y8FVuQdWZV%2Ba80NrrfWWCjam3vjwK2Ns7ZQM5tzdBxtZjxHoNkSWZVZj0DKk/a%2B3Bsi3zNhbSBucnaIGdsgNAwDfagIoFQCAPs/YgGAPEWYodw6RwgNHEusdNAJx7inYBadM7ZzNvnQuoDtEEHLpXGuddybkAbk3COqi26iFUV3dW3AWb437oPUo5tR7jx4BPQobQp4z3novCey8XRrw3lvCeO9UB7zyAfI%2B5gT5nwZpfRB3AiZ4NMQ/J%2BL834EgEPEbW39CAkFIOAwBAi/ZM1mNEThjsYENBwP7VxXMda83oCoRCDD6DxBUNkfWZU%2BnSOVsg9WT8BY9P5vzMZEzsjjPunfdJBDmBEPto7cgvCIAoAEhpL2oiylCJANIgwv9/ZX2VqkuZFMeD/1mAIJqSABCP2fq/LoH88mzGqRzcgsD6kIOYUMhgWtplTJmYCsZIdznmwWdbW2yyPlc2ZrzUWiEyqi2yEi0WctZjIvGcw1haSLmW2IVw1ZPDXa7M9iIsReznKF0QlLGRIgI6kGtvImOcdSA52TqnbA6cs4iBzqYnRpg9ElzLo3IxtczbmOblY9ONiHGs1IN3eVTiB7wGHu47QnjvGz2nrPBeWpt5fEifvQ%2Bx9T7MHPpwBgySznsJ4A8rJINWoBEQrzFQbqClHJKQIIBICwH/2yFUwlNTyBwvoBgzp8QUW3TaZrTWZVflqwYHS8FHDFnQpIcwt5eKIUEphdA8gK8dAmBAGVIAA%3D)。gcc7.2`-O3`完成了我们对独立版本的期望（使用寄存器 args）。

```
inlineasm:
    movq    %rdx, %rax      # k, k
    cmpq %rsi, %rdi         # b, a
    adc %rax,%rax   # k
    ret 
```

我们可以通过内联到其他调用者来查看我们的约束如何工作：

```
unsigned long call_with_mem(unsigned long *aptr) {
    return inlineasm(*aptr, 5, 4);
}
    # gcc
    movl    $4, %eax        #, k
    cmpq $55555, (%rdi)     #, *aptr_3(D)
    adc %rax,%rax   # k
    ret 
```

使用更大的立即数，我们`movabs`进入一个寄存器。（但是如果有`"i"`or`"g"`约束，gcc 会发出不汇编的代码，或者截断常量，试图为 cmpq 使用一个大的立即常量。）

比较我们从纯 C 中得到的：

```
unsigned long call_with_mem_nonasm(unsigned long *aptr) {
    return handhold(*aptr, 5, 4);
}
    # gcc -O3
    xorl    %eax, %eax      # tmp93
    cmpq    $4, (%rdi)      #, *aptr_3(D)
    setbe   %al   #, tmp93
    addq    $8, %rax        #, k
    ret 
```

`adc $8, %rax`without`setc`可能会更好，但是如果没有`__builtin_constant_p()`on ，我们就无法从内联 asm 中得到它`k`。

* * *

如果有 mem 替代品，clang 经常会选择它，所以它会这样做：/facepalm。不要使用内联汇编。

```
inlineasm:   # clang 5.0
    movq    %rsi, -8(%rsp)
    cmpq    -8(%rsp), %rdi
    adcq    %rdx, %rdx
    movq    %rdx, %rax
    retq 
```

* * *

顺便说一句，除非您要优化转换为比较加法，否则您可以而且应该要求编译器`k<<1`作为输入。*

# asp.net - 限制 GridView 列

> ID：14023036
> 
> 赞同：1
> 
> 时间：2012-12-24T15:20:16.383
> 
> 标签：asp.net, html, css, gridview

我有一个显示产品信息（下面的代码）的网格视图，现在我想限制描述字段，以便在有长描述时只显示前几个，并调整图像大小以适合图像列（并使图片，描述栏比其他栏大一点

谢谢

```
<asp:GridView ID="gvProducts" runat="server" AutoGenerateColumns="False" DataKeyNames="ProductId" OnRowDeleting="gvProducts_RowDeleting" OnSelectedIndexChanged="gvProducts_SelectedIndexChanged">
    <Columns>
        <asp:CommandField ShowSelectButton="True" />
        <asp:BoundField DataField="Productname" HeaderText="Name" />
        <asp:BoundField DataField="ProductDescription" HeaderText="Description"  />
        <asp:BoundField DataField="ProductSupplier" HeaderText="Supplier" />
        <asp:BoundField DataField="ProductCategory" HeaderText="Category" />
        <asp:BoundField DataField="ProductSubCategory" HeaderText="SubCategory" />
        <asp:BoundField DataField="ProductVAT" HeaderText="VAT" />
        <asp:BoundField DataField="ProductStock" HeaderText="Stock" />
        <asp:ImageField DataImageUrlField="ProductImage" HeaderText="Image"/>
        <asp:CheckBoxField DataField="ProductActive" HeaderText="Active" />
        <asp:CommandField ButtonType="Button" ShowDeleteButton="True" />
    </Columns>
    <SelectedRowStyle CssClass="selectedrow" />
</asp:GridView> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-24T18:49:12.783

使用**css**我们可以限制要显示的描述文本。像这样....

```
<asp:GridView ID="gvProducts" runat="server" CssClass="GridCSS" AutoGenerateColumns="False" DataKeyNames="ProductId" OnRowDeleting="gvProducts_RowDeleting" OnSelectedIndexChanged="gvProducts_SelectedIndexChanged">
    <Columns>
-----------------------
-----------
---------
<asp:BoundField DataField="ProductDescription" HeaderText="Description" ItemStyle-CssClass="limittext" />
------------------
---------
-------------

</Columns>

</asp:GridView> 
```

CSS 样式：

```
.GridCSS {
        table-layout:fixed; 
        width:100%; 
    }
    .GridCSS .limittext{
        overflow: hidden; 
        text-overflow: ellipsis; 
        white-space: nowrap;        
    } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-24T15:24:48.307

您可以使用 fw 4.5 的掩码或一些外部插件 lika Jquery Mask。或者您可以将它们设为模板项并放置一些代码，例如 <%# Eval("ProductDescription").SubString(0,50) %>

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-06T12:29:51.717

```
<table style="table-layout: fixed">
                    <tr>
                        <td>
                            <telerik:RadGrid ID="radGVEmployee" runat="server" AllowSorting="True" GridLines="None"
                                AutoGenerateColumns="False" CellSpacing="0" OnNeedDataSource="radGVEmployee_NeedDataSource"
                                Visible="True" OnSortCommand="radGVEmployee_SortCommand" AllowPaging="true" OnPageIndexChanged="radGVEmployee_PageIndexChanged"
                                Width="900px" OnItemDataBound="radGVEmployee_ItemDataBound" OnItemCommand="radGVEmployee_ItemCommand"
                                PageSize="5">
                                <FilterMenu EnableTheming="True">
                                    <CollapseAnimation Duration="200" Type="OutQuint" />
                                </FilterMenu>
                                <GroupingSettings CaseSensitive="False" />
                                <MasterTableView DataKeyNames="UsrId" AllowFilteringByColumn="true" TableLayout="Fixed"
                                    Visible="true" AllowMultiColumnSorting="false">
                                    <NoRecordsTemplate>
                                        <div style="width: 700px;" align="center">
                                            There is No Data to display</div>
                                    </NoRecordsTemplate>
                                    <CommandItemSettings ExportToPdfText="Export to PDF" />
                                    <RowIndicatorColumn FilterControlAltText="Filter RowIndicator column" Visible="True">
                                    </RowIndicatorColumn>
                                    <ExpandCollapseColumn FilterControlAltText="Filter ExpandColumn column" Visible="True">
                                    </ExpandCollapseColumn>
                                    <Columns>
                                        <telerik:GridTemplateColumn SortExpression="UserName" DataField="UserName" HeaderText="UserName"
                                            HeaderStyle-Width="60px" FilterControlWidth="75%" HeaderStyle-HorizontalAlign="Center">
                                            <ItemTemplate>
                                                <asp:Label ID="lblItmUserName" runat="server" Text='<%# Eval("UserName") %>'></asp:Label>
                                            </ItemTemplate>
                                            <HeaderStyle HorizontalAlign="Center" Wrap="false"></HeaderStyle>
                                            <ItemStyle HorizontalAlign="Center" />
                                        </telerik:GridTemplateColumn>
                                        <telerik:GridTemplateColumn SortExpression="FullName" DataField="FullName" HeaderText="FullName"
                                            HeaderStyle-Width="60px" FilterControlWidth="75%" HeaderStyle-HorizontalAlign="Center">
                                            <ItemTemplate>
                                                <asp:Label ID="lblItmFullName" runat="server" Text='<%# Eval("FullName") %>'></asp:Label>
                                            </ItemTemplate>
                                            <HeaderStyle HorizontalAlign="Center" Wrap="false"></HeaderStyle>
                                            <ItemStyle HorizontalAlign="Center" />
                                        </telerik:GridTemplateColumn>
                                        <telerik:GridTemplateColumn SortExpression="MobileNo" DataField="MobileNo" HeaderText="MobileNo"
                                            HeaderStyle-Width="40px" FilterControlWidth="75%" HeaderStyle-HorizontalAlign="Center">
                                            <ItemTemplate>
                                                <asp:Label ID="lblItmMobileNo" runat="server" Text='<%# Eval("MobileNo") %>'></asp:Label>
                                            </ItemTemplate>
                                            <HeaderStyle HorizontalAlign="Center" Wrap="false"></HeaderStyle>
                                            <ItemStyle HorizontalAlign="Center" />
                                        </telerik:GridTemplateColumn>
                                        <telerik:GridTemplateColumn SortExpression="CompanyName" DataField="CompanyName"
                                            HeaderText="CompanyName" HeaderStyle-Width="50px" FilterControlWidth="75%" HeaderStyle-HorizontalAlign="Center">
                                            <ItemTemplate>
                                                <asp:Label ID="lblItmCompanyName" runat="server" Text='<%# Eval("CompanyName") %>'></asp:Label>
                                            </ItemTemplate>
                                            <HeaderStyle HorizontalAlign="Center" Wrap="false"></HeaderStyle>
                                            <ItemStyle HorizontalAlign="Center" />
                                        </telerik:GridTemplateColumn>
                                        <telerik:GridTemplateColumn SortExpression="BranchName" DataField="BranchName" HeaderText="BranchName"
                                            HeaderStyle-Width="50px" FilterControlWidth="75%" HeaderStyle-HorizontalAlign="Center">
                                            <ItemTemplate>
                                                <asp:Label ID="lblItmBranchName" runat="server" Text='<%# Eval("BranchName") %>'></asp:Label>
                                            </ItemTemplate>
                                            <HeaderStyle HorizontalAlign="Center" Wrap="false"></HeaderStyle>
                                            <ItemStyle HorizontalAlign="Center" />
                                        </telerik:GridTemplateColumn>
                                        <telerik:GridTemplateColumn SortExpression="Designation" DataField="Designation"
                                            HeaderText="Designation" HeaderStyle-Width="50px" FilterControlWidth="75%" HeaderStyle-HorizontalAlign="Center">
                                            <ItemTemplate>
                                                <asp:Label ID="lblItmDesignation" runat="server" Text='<%# Eval("Designation") %>'></asp:Label>
                                                <asp:Label ID="lblItmLockStatus" runat="server" Text='<%# Eval("LockStatus") %>'
                                                    Visible="false"></asp:Label>
                                                <asp:Label ID="lblItmUserStatus" runat="server" Text='<%# Eval("UserStatus") %>'
                                                    Visible="false"></asp:Label>
                                            </ItemTemplate>
                                            <HeaderStyle HorizontalAlign="Center" Wrap="false"></HeaderStyle>
                                            <ItemStyle HorizontalAlign="Center" />
                                        </telerik:GridTemplateColumn>
                                        <telerik:GridTemplateColumn SortExpression="UserImage" DataField="UserImage" HeaderText="UserImage"
                                            HeaderStyle-Width="50px" FilterControlWidth="75%" HeaderStyle-HorizontalAlign="Center"
                                            AllowFiltering="false">
                                            <ItemTemplate>
                                                <asp:Image ID="lblUserImage" runat="server" ImageUrl='<%#Eval("ImageName")!=DBNull.Value? 
                                                  System.Configuration.ConfigurationManager.AppSettings["AzureImagePath"]+Eval("ImageName"):System.Configuration.ConfigurationManager.AppSettings["UserImagePath"]+"profile-empty-head.gif"%>'
                                                    Height="100px" Width="90px" />
                                            </ItemTemplate>
                                            <HeaderStyle HorizontalAlign="Center" Wrap="false"></HeaderStyle>
                                            <ItemStyle HorizontalAlign="Center" />
                                        </telerik:GridTemplateColumn>
                                        <telerik:GridTemplateColumn AllowFiltering="false" DataField="Actions" HeaderText="Actions"
                                            HeaderStyle-Width="50px" HeaderStyle-HorizontalAlign="Center">
                                            <%--OnClientClick='radconfirm("Are you sure you want to Change this LockStatus?", ClientGridCallback,300,150); return false;' --%>
                                            <ItemTemplate>
                                                <asp:ImageButton runat="server" ID="imgLockStatus" ImageUrl="~/App_Themes/DefaultClient/images/unlock.png"
                                                    CommandName="ChangeLockStatus" CommandArgument='<%# Eval("UsrId") %>' ToolTip="UserLockStatus"
                                                    AlternateText="LockStatus" OnClientClick="return blockConfirm('Are you sure you want to Change Lock Status?', event, 340, 150,'','Change Lock Status')" />
                                                <asp:ImageButton runat="server" ID="imgUserStatus" ImageUrl="~/App_Themes/DefaultClient/images/select.png"
                                                    CommandName="ChangeUserStatus" CommandArgument='<%# Eval("UsrId") %>' ToolTip="UserActivationStatus"
                                                    AlternateText="UserActivationStatus" OnClientClick="return blockConfirm('Are you sure you want to Change Activation Status?', event, 340, 150,'','Change Activation Status')" />
                                                <asp:ImageButton runat="server" ID="imgResetPassword" ImageUrl="~/App_Themes/DefaultClient/images/logoff.png"
                                                    CommandName="ResetPassword" CommandArgument='<%# Eval("UsrId") %>' ToolTip="ResetPassword"
                                                    Width="22px" Height="22px" AlternateText="ResetPassword" OnClientClick="return blockConfirm('Are you sure you want to Reset Password?', event, 340, 150,'','Reset Password')"  />
                                            </ItemTemplate>
                                            <HeaderStyle HorizontalAlign="Center" Wrap="false"></HeaderStyle>
                                            <ItemStyle HorizontalAlign="Center" />
                                        </telerik:GridTemplateColumn>
                                        <%--   <telerik:GridButtonColumn ConfirmText="Are you sure you want to Change LockStatus ?<br /><br /><br />"
                                            ConfirmDialogType="RadWindow" HeaderStyle-Width="15px" ConfirmDialogHeight="150px"
                                            HeaderText="LockStatus" HeaderStyle-HorizontalAlign="Center" CommandName="ChangeLockStatus"
                                            ButtonType="ImageButton" ImageUrl="~/App_Themes/DefaultClient/images/unlock.png"
                                            ItemStyle-HorizontalAlign="Center" ConfirmTitle="Delete Currency" UniqueName="ChangeLockStatus">
                                        </telerik:GridButtonColumn>
                                        <telerik:GridButtonColumn ConfirmText="Are you sure you want to Change ActivationStatus ?<br /><br /><br />"
                                            ConfirmDialogType="RadWindow" HeaderStyle-Width="15px" ConfirmDialogHeight="150px"
                                            HeaderText="ActivationStatus" HeaderStyle-HorizontalAlign="Center" CommandName="ChangeUserStatus"
                                            ButtonType="ImageButton" ImageUrl="~/App_Themes/DefaultClient/images/unlock.png"
                                            ItemStyle-HorizontalAlign="Center" ConfirmTitle="Delete Currency" UniqueName="ChangeUserStatus">
                                        </telerik:GridButtonColumn>--%>
                                    </Columns>
                                    <EditFormSettings>
                                        <EditColumn FilterControlAltText="Filter EditCommandColumn column">
                                        </EditColumn>
                                    </EditFormSettings>
                                </MasterTableView>
                                <GroupingSettings CaseSensitive="False" />
                                <ClientSettings>
                                    <ClientEvents OnGridCreated="GridCreated" />
                                </ClientSettings>
                                <PagerStyle Mode="NextPrevAndNumeric"></PagerStyle>
                            </telerik:RadGrid>
                        </td>
                    </tr>
                </table> 
```

尝试这个 ..........

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-24T15:30:50.580

如果您正在使用 MVC，则可以在将其绑定到 GW 之前更改控制器中的 GridView 数据。如果您不使用 MVC，我唯一能提供的是：在您的 RowDataBound 事件中，检查描述是否超过您定义的最大值。字符，然后截断它。

我知道这不是一个正确的答案，但它可能会给你一些想法。由于我正在工作，现在无法提供代码，但我稍后会检查您的帖子是否没有答案。

进一步阅读：

[http://www.dotnetspider.com/resources/43687-How-show-formatted-html-content-grid-view.aspx](http://www.dotnetspider.com/resources/43687-How-show-formatted-html-content-grid-view.aspx) http://forums.asp.net/t/1391922.aspx/1

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-12-24T16:24:24.583

尝试这个

```
<asp:TemplateField HeaderText="Description">
<ItemTemplate>

<%# Eval("ProductDescription").ToString().Length > 50 ? Eval("ProductDescription").ToString().Substring(0,50)+"..." : Eval("ProductDescription").ToString() %>

</ItemTemplate>
</asp:TemplateField> 
```

如果文本超过 50 个字符，则显示前 50 个字符，否则显示整个文本。

另一种选择是从数据库或产品对象返回一个简短的描述

```
 public string ShortDescription
 {
    get 
    { 
        return ProductDescription.Length > 50 ? ProductDescription.Substring(0,50) : ProductDescription;
    }
 } 
```

# pivot - 用 Pandas 重塑数据框

> ID：14023037
> 
> 赞同：1
> 
> 时间：2012-12-24T15:20:23.780
> 
> 标签：pivot, pandas, reshape

如何用 Pandas 重塑这个数据框

```
id | col1 | col2 | col3     | value  
-----------------------------------
1  | A1   | B1   | before   | 20     
2  | A1   | B1   | after    | 13
3  | A1   | B2   | before   | 11
4  | A1   | B2   | after    | 21
5  | A2   | B1   | before   | 18 
6  | A2   | B1   | after    | 22 
```

...变成以下格式？

```
col1 | col2 | before  | after
-------------------------------
A1   | B1   | 20      | 13
A1   | B2   | 11      | 21
A1   | B1   | 18      | 22 
```

编辑：第二个表的最后一行中的 A1 应该是 A2。

由于数据是配对的（例如“之前”和“之后”），我需要在没有“NAs”的情况下对齐列。

```
df.pivot(index='col1', columns='col3', values='value') 
```

不起作用，因为`col1`不会产生唯一索引。我可以创建一个额外的列，这将导致唯一。这是唯一的出路吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-24T15:44:23.957

正如您的矩阵数据所示， col1 不能是索引，因为正如您所说，它“不会产生唯一索引”。

我认为你最好的最好的是：

```
grouped = df.groupby('col3')
pandas.merge(grouped.first(), grouped.last(), on=['col1','col2']) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-24T19:17:12.363

你希望 col1 和 col2 在你旋转后看起来像什么？您的示例输出显示了最后一行的 A1 和 B1，但这些值都与 18 和 22 无关。我有几个选项：

```
In [234]: tmp = DataFrame(
    {'id':[1,2,3,4,5,6], 
     'col1':['A1','A1','A1','A1','A2','A2'],
     'col2':['B1','B1','B2','B2','B1','B2'],
     'col3':['before','after','before','after','before','after'],
     'value':[20,13,11,21,18,22]},
    columns=['id','col1','col2','col3','value']) 
```

选项1：

```
In [236]: pivoted = pd.pivot_table(tmp, values='value',
                                        rows=['col1','col2'],
                                        cols=['col3'])
In [237]: pivoted
Out[237]:
col3       after  before
col1 col2
A1   B1       13      20
     B2       21      11
A2   B1      NaN      18
     B2       22     NaN 
```

这听起来不像你想要的那种行为。

选项 2：

```
In [238]: pivoted = pivoted.fillna(method='bfill').dropna()
Out[238]:
col3       after  before
col1 col2
A1   B1       13      20
     B2       21      11
A2   B1       22      18

In [245]: pivoted.reset_index()
Out[245]:
col3 col1 col2  after  before
0      A1   B1     13      20
1      A1   B2     21      11
2      A2   B1     22      18 
```

这让你非常接近。同样，我不确定您希望 col1 和 col2 如何表现，但这在前后列中具有正确的值。

# javascript - 从日/月/年的表格中获取正确的日期

> ID：14023038
> 
> 赞同：0
> 
> 时间：2012-12-24T15:20:42.370
> 
> 标签：javascript

使用字符串编写新的日期对象时，可以将其写为：

```
var someDay = new Date("12/01/2012"); 
```

这相当于 2012 年 12 月 1 日。

但是，如果用户必须在格式不是月/日/年而是日/月/年的网站上填写日期怎么办？那么如何创建一个具有正确日期的日期对象呢？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-24T16:34:59.107

如果您从另一个网站以字符串形式获取数据，那么您需要知道该网站为您提供日期的格式。没有办法解决这个问题，因为 DMY 和 MDY 无法区分。如果年份使用两位数格式，即使 YMD 也无法区分。

这根本没有经过测试，但在最坏的情况下，一般的想法应该可以解决你的问题。

```
var pattern = /^(\d+)\b(\d+)\b(\d+)$/;
if (!pattern.test(dateString))
    return null;
var matches = dateString.match(pattern);
if (siteUsesDMY)
    return new Date(matches[2], matches[1]-1, matches[0]);
if (siteUsesMDY)
    return new Date(matches[2], matches[0]-1, matches[1]);
... 
```

模式：此模式支持日期的任何数字表示，假设它在每个单位之间有一个中断字符。如果您需要支持一个没有中断字符的网站，您将需要一个与该网站的确切格式匹配的不同模式（即：网站发送 DDMMYYYY，然后模式将是`/^(\d{2})(\d{2})(\d{4})$/`）。

还修复了日期创建中的月份参数，因为我只记得 JavaScript 使用 0-11 表示月份。

# c# - SqlLocalDb 中的服务代理或 SqlDependency？

> ID：14023039
> 
> 赞同：5
> 
> 时间：2012-12-24T15:20:46.423
> 
> 标签：c#, sql-server-2008, localdb

`SqlDependency`支持`SqlLocalDb`？_ 如果是，如何启用它？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-24T19:31:17.110

在您的主题中回答有关 Service Broker 的问题。

Service Broker 在 LocalDB 中应该可以正常工作，但只有本地队列可用。远程队列在任何一个方向都不起作用（实际上 Service Broker 队列是双向的，因此没有传入/传出队列的区别）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-24T15:58:31.420

我不确切知道，但下面的链接可能对您有用：

[http://msdn.microsoft.com/en-us/library/bb934450.aspx](http://msdn.microsoft.com/en-us/library/bb934450.aspx)

# python - 如何在 Python 中从相机中确定光的振幅频率

> ID：14023041
> 
> 赞同：-2
> 
> 时间：2012-12-24T15:20:57.570
> 
> 标签：python, image, image-processing

有一盏灯以 50Hz 工作，我有一个可以捕捉 60fps 的相机。我很肯定它是 50Hz，因为它已插入 50Hz 电源，我只是想通过图像处理来确认它。我已经用光电二极管（而不是相机）证明了它是 50Hz，因为它提供一维输出，因此使用 numpy 执行 FFT 很容易。但是相机提供了二维数据，它有点棘手，因此涉及到图像处理。

我写了“确定光振幅的频率”，因为我不想让人们混淆频率，就像颜色一样，只是改变振幅。相机传感器朝向灯，我的方法应该是从 60 捕获的 fps 确定光的振幅频率？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-24T16:15:19.707

您可以测量每个样本的强度（以 60Hz 采样），然后您可以获得强度与时间的关系图。问题是您的采样率低于 50Hz 信号的[奈奎斯特率](http://en.wikipedia.org/wiki/Nyquist_rate)。因此，您将有混叠，但如果您假设您接近 50Hz，您将能够将大约 50Hz 的信号拟合到数据中。但是，如果您的光从关闭到打开并再次关闭，您可能会遇到问题，因为您的许多样本可能报告零强度。实际光强度越像正弦波，效果就越好。

# c# - Moq 设置方法没有覆盖之前的设置方法，导致验证不需要的方法

> ID：14023042
> 
> 赞同：0
> 
> 时间：2012-12-24T15:21:00.237
> 
> 标签：c#, unit-testing, moq

在`[TestInitialize]`我写 的

```
dbfc.Setup(_=>_.crt(It.IsAny<string>())).Returns("blhblh"); 
```

那是因为我在许多测试中都需要它。

现在，在`[TestMethod]`我自己写的

```
dbfc.Setup(_=>_.crt("blhblh")).Returns("blhblh").Verify;

dbfc.VerifyAll(); 
```

结果是第一种方法通过了验证，即使我不希望它通过，并且由于第一种方法而出现错误，我希望第二种方法覆盖第一种方法，并且只有第二种方法会通过确认。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-26T22:08:17.013

如果您的模拟是针对您编写的每个测试方法的特定的，那么在您想要的位置实例化并设置模拟

```
dbfc = new Mock<Class/Interface>();

dbfc.Setup(_=>_.crt("blhblh")).Returns("blhblh").Verifiable();

dbfc.VerifyAll(); 
```

# excel - Excel 电子表格崩溃：数千个单元格变为“#NUM！” 同时

> ID：14023044
> 
> 赞同：0
> 
> 时间：2012-12-24T15:21:10.063
> 
> 标签：excel, recursion

我为分析纽约市的交通定价而创建的一个大型 Excel 电子表格（60 个选项卡，每个选项卡范围为 1,000 x 68 个单元格），当我在一个特定单元格中输入超出狭窄范围的值时会崩溃。我所说的“崩溃”是指大量单元格（可能是数万个）返回“#NUM！” 同时。

正如您已经猜到的那样，电子表格是递归的，因为有数百个（数千个？）数据在不同单元格之间来回传递的实例......这在处理旅行选择时必须发生（例如，提高道路通行费会减少汽车出行，但由此带来的交通流量改善吸引了汽车出行，从而使交通流量恶化......）。

有没有一种方法可以让我“减慢”计算速度，以便查看#NUM！结果最先出现？由于缺乏这一点，我花了很多时间试图找出导致初始 #NUM 的公式或算法，但徒劳无功！结果，然后感染所有其他人，使诊断变得不可能。

该电子表格大约 4 MB，可通过以下链接下载：[http](http://www.nnyn.org/kheelplan/BTA_1.1.xls) ://www.nnyn.org/kheelplan/BTA_1.1.xls 。导致折叠值的单元格是“出租车”工作表中的 F444。它的当前（保存的）值是统一的（1.0）。将其提高到 4.0 甚至一些较小的值将使电子表格崩溃……无法重建。

我应该说我是一个数学家，而不是一个程序员。事实上，我更像是一个“数字专家”而不是数学家。

提前致谢。我是这个网站的新手，对它印象深刻。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-24T16:26:10.680

在 Excel 2010 中（但可能在 2007 年之后都具有此功能）在公式选项卡上的公式审核组中有一个评估公式按钮。您选择#NUM！字段，并使用它，您可以进入公式，并评估公式（计算公式的一部分）。此外，您在该组中有一些辅助功能，例如跟踪依赖项/先例。

EDIT1：哦，如果出现以下错误（#NUM！）：

1.  您在某个字段中计算出的数字太大了 ~ 1E+308 或更大
2.  你想做这样的事情：0^0
3.  您会在某个地方（在前一个字段中）出现此错误 #NUM！你想用的

EDIT2：现在，我发现了你的问题（也许），你想在某个地方用迭代计算太大的数字。如果将最大迭代次数设置为 1，则没有 #NUM！错误。（您可以在 Excel 选项 - 公式选项卡中找到它）

# macos - MacOS 上的几何着色器

> ID：14023049
> 
> 赞同：2
> 
> 时间：2012-12-24T15:21:32.103
> 
> 标签：macos, graphics, glsl, shader, geometry-shader

我正在尝试编写一个简单的直通几何着色器，但它不起作用，我真的不明白为什么。这是我的gs：

```
#version 120
#extension GL_EXT_geometry_shader4 : enable

void main(void) {

    for(int i=0; i< gl_VerticesIn; i++) {
        gl_Position = gl_PositionIn[i];    
        EmitVertex();
    }

    EndPrimitive();

} 
```

我正在使用 MacOS 10.8 和 OpenGL Shader Builder 2.2（进行测试）。看起来版本 120 是我可以使用的最新版本。

问题是编译和链接都成功了，但是什么都没有渲染。
我已经设置

```
GL_GEOMETRY_INPUT_TYPE_EXT = GL_TRIANGLES 
GL_GEOMETRY_OUTPUT_TYPE_EXT = GL_TRIANGLES_STRIP
GL_GEOMETRY_VERTICES_OUT_EXT = 3 
```

我错过了什么？

# c# - 通过 C# 运行时无法识别 BCDEDIT

> ID：14023051
> 
> 赞同：7
> 
> 时间：2012-12-24T15:21:54.067
> 
> 标签：c#, windows

当我尝试从我的 C# 应用程序运行 BCDEDIT 时，出现以下错误：

> 'bcdedit' 不是内部或外部命令、可运行程序或批处理文件。

当我通过提升的命令行运行它时，我得到了预期。

我使用了以下代码：

```
 Process p = new Process();
            p.StartInfo.UseShellExecute = false;
            p.StartInfo.RedirectStandardOutput = true;
            p.StartInfo.RedirectStandardError = true;
            p.StartInfo.FileName = @"CMD.EXE";
            p.StartInfo.Arguments = @"/C bcdedit";
            p.Start();
            string output = p.StandardOutput.ReadToEnd();
            String error = p.StandardError.ReadToEnd();
            p.WaitForExit();
            return output; 
```

我也尝试过使用

```
p.StartInfo.FileName = @"BCDEDIT.EXE";
p.StartInfo.Arguments = @""; 
```

我尝试了以下方法：

1.  检查路径变量 - 它们很好。
2.  从提升的命令提示符运行 Visual Studio。
3.  放置完整路径。

我的想法不多了，知道为什么会出现这个错误吗？

如果还有另一种方法也可以，我需要的只是命令的输出。谢谢

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-12-24T16:06:41.253

有一种解释是有道理的：

1.  您正在 64 位机器上执行程序。
2.  您的 C# 程序构建为 x86。
3.  该`bcdedit.exe`文件存在于`C:\Windows\System32`.
4.  虽然`C:\Windows\System32`在您的系统路径上，但在 x86 进程中，您会受到[File System Redirector](http://msdn.microsoft.com/en-gb/library/windows/desktop/aa384187.aspx)的约束。这意味着`C:\Windows\System32`实际上解析为`C:\Windows\SysWOW64`.
5.  没有 32 位版本的`bcdedit.exe`in `C:\Windows\SysWOW64`。

解决方案是将您的 C# 程序更改为 target`AnyCPU`或`x64`.

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2014-11-12T17:01:52.880

如果您在 32it/64 位 Windows 上都被 x86 应用程序卡住，并且需要调用 bcdedit 命令，这里有一种方法：

```
private static int ExecuteBcdEdit(string arguments, out IList<string> output)
{
    var cmdFullFileName = Path.Combine(Environment.GetFolderPath(Environment.SpecialFolder.Windows),
                                       Environment.Is64BitOperatingSystem && !Environment.Is64BitProcess
                                           ? @"Sysnative\cmd.exe"
                                           : @"System32\cmd.exe");

    ProcessStartInfo psi = new ProcessStartInfo(cmdFullFileName, "/c bcdedit " + arguments) { UseShellExecute = false, RedirectStandardOutput = true };
    var process = new Process { StartInfo = psi };

    process.Start();
    StreamReader outputReader = process.StandardOutput;
    process.WaitForExit();
    output = outputReader.ReadToEnd().Split(new[] { Environment.NewLine }, StringSplitOptions.None).ToList();
    return process.ExitCode;
} 
```

用法：

```
var returnCode = ExecuteBcdEdit("/set IgnoreAllFailures", out outputForInvestigation); 
```

灵感来自这个线程，来自[How to start a 64-bit process from a 32-bit process](https://stackoverflow.com/questions/2003573/how-to-start-a-64-bit-process-from-a-32-bit-process)和[http://www.samlogic.net/articles/sysnative-folder-64-bit-windows.htm](http://www.samlogic.net/articles/sysnative-folder-64-bit-windows.htm)

# c# - 有没有办法在不设置 smtp 服务器的情况下使用 c# 发送电子邮件？

> ID：14023059
> 
> 赞同：1
> 
> 时间：2012-12-24T15:22:27.677
> 
> 标签：c#, email, smtp

我希望我的应用程序的用户能够使用所有可能的电子邮件。现在，如果我考虑设置`if`条款来跟踪他们的电子邮件提供商以设置`SmtpServer`并且`SmtpServer.Port`效率低下。有没有更简单的方法来做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-24T15:26:33.097

我不确定您所说的“跟踪他们的电子邮件提供商”是什么意思，但您绝对*需要*设置一个 SMTP 服务器来发送电子邮件 - 否则您不能这样做。

如果您事先不知道他们的 SMTP 服务器是什么（如果它是桌面应用程序，您通常不会知道），最简单的做法是提供一个设置屏幕，用户可以在其中设置自己的 SMTP 信息；端口、SSL/not、用户名、密码等；然后，您将在创建 SMTP 连接时使用这些设置。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-24T15:26:08.427

配置对话框允许他们输入 IP 和端口？

也许需要一些身份验证，我猜也很难追踪

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-24T15:43:57.957

您可以使用计算机上的默认邮件客户端设置来发送电子邮件。需要注意的是，用户需要单击“发送”按钮。他们还可以修改电子邮件内容。这对于反馈场景很有用。

代码可能是这样的：

```
Process.Start("mailto:name@company.com?subject=YOUR SUBJECT&body=YOUR EMAIL BODY"); 
```

# javascript - 在调整浏览器大小之前不会绘制 Highcharts 线

> ID：14023062
> 
> 赞同：2
> 
> 时间：2012-12-24T15:22:54.010
> 
> 标签：javascript, jquery, html, css, highcharts

我在我的一个页面上测试 Highcharts javascript 图表库时遇到了问题。

我看到的问题是，在我稍微调整浏览器大小之前，没有任何数据可见。在调整大小之前，工具提示确实显示了点。

首先，我认为问题是由于 jquery 选项卡造成的，但事实并非如此。我添加了来自 Highcharts 建议的修复程序。[http://www.highcharts.com/studies/jquery-ui-tabs.htm](http://www.highcharts.com/studies/jquery-ui-tabs.htm)

我尝试在初始化后调用图表 setSize() 方法，以查看手动调整大小是否会导致线条可行。

有任何想法吗？

这里我如何初始化图表。

```
$(div).ready(function(){
    var chart = new Highcharts.Chart({
        chart: {renderTo: 'some-div', type: 'line'},
        title: {text: 'Title'},
        xAxis: {type: 'text',title: {text: null}},
        yAxis: {title: {text: 'Usage'}},
        series: [{name:"Series 1", data : [1,2,3,4,5,6,6,7,2,7] }],
        legend: {enabled: true}
    });
}) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-26T14:55:27.420

想通了，好吧，我并没有完全找到问题，但找到了解决方案。

从版本 v2.1.6 升级到最新版本 (v2.3.5) 解决了它。

查看[更改日志](http://www.highcharts.com/documentation/changelog)，有一些关于 Jquery 1.7/1.8 兼容性问题的错误修复的参考可能是原因。

# android - Android GridView 错误

> ID：14023063
> 
> 赞同：1
> 
> 时间：2012-12-24T15:23:06.020
> 
> 标签：android, android-layout, android-gridview, android-gridlayout

我有一个带有 GridView 的应用程序，它包含 60 个元素...这是 ImageAdapter 的代码，它扩展了 BaseAdapter 以显示它们...

```
public class ImageAdapter extends BaseAdapter {
private Context context;
private final String[] mobileValues;

public ImageAdapter(Context context, String[] mobileValues) {
    this.context = context;
    this.mobileValues = mobileValues;
}

public View getView(int position, View convertView, ViewGroup parent) {

    LayoutInflater inflater = (LayoutInflater) context
            .getSystemService(Context.LAYOUT_INFLATER_SERVICE);

    View gridView;

    if (convertView == null) {

        gridView = new View(context);

        // get layout from mobile.xml
        gridView = inflater.inflate(R.layout.mobile, null);

        // set value into textview
        TextView textView = (TextView) gridView
                .findViewById(R.id.grid_item_label);
        textView.setText(mobileValues[position]);

        // set image based on selected text
        ImageView imageView = (ImageView) gridView
                .findViewById(R.id.grid_item_image);

        String mobile = mobileValues[position];

        if (mobile.equals("Alfa Romeo")) {
            imageView.setImageResource(R.drawable.alfa);
        } else if (mobile.equals("Aston Martin")) {
            imageView.setImageResource(R.drawable.aston);
        } else if (mobile.equals("Audi")) {
            imageView.setImageResource(R.drawable.audi);
        } else if (mobile.equals("Bentley")) {
            imageView.setImageResource(R.drawable.bentley);
        } else if (mobile.equals("BMW")) {
            imageView.setImageResource(R.drawable.bmw);
        } else if (mobile.equals("Bugatti")) {
            imageView.setImageResource(R.drawable.bugatti);
        } else if (mobile.equals("Buick")) {
            imageView.setImageResource(R.drawable.buick);
        } else if (mobile.equals("Cadillac")) {
            imageView.setImageResource(R.drawable.cadillac);
        } else if (mobile.equals("Chery")) {
            imageView.setImageResource(R.drawable.chery);
        } else if (mobile.equals("Chevrolet")) {
            imageView.setImageResource(R.drawable.chevrolet);
        } else if (mobile.equals("Chrysler")) {
            imageView.setImageResource(R.drawable.chrysler);
        } else if (mobile.equals("Citroen")) {
            imageView.setImageResource(R.drawable.citroen);
        } else if (mobile.equals("Dacia")) {
            imageView.setImageResource(R.drawable.dacia);
        } else if (mobile.equals("Daewoo")) {
            imageView.setImageResource(R.drawable.daewoo);
        } else if (mobile.equals("Dodge")) {
            imageView.setImageResource(R.drawable.dodge);
        } else if (mobile.equals("Ferrari")) {
            imageView.setImageResource(R.drawable.ferrari);
        } else if (mobile.equals("Fiat")) {
            imageView.setImageResource(R.drawable.fiat);
        } else if (mobile.equals("Ford")) {
            imageView.setImageResource(R.drawable.ford);
        } else if (mobile.equals("Gaz")) {
            imageView.setImageResource(R.drawable.gaz);
        } else if (mobile.equals("Holden")) {
            imageView.setImageResource(R.drawable.holden);
        } else if (mobile.equals("Honda")) {
            imageView.setImageResource(R.drawable.honda);
        } else if (mobile.equals("Hyindai")) {
            imageView.setImageResource(R.drawable.hyundai);
        } else if (mobile.equals("Infinity")) {
            imageView.setImageResource(R.drawable.infiniti);
        } else if (mobile.equals("Jaguar")) {
            imageView.setImageResource(R.drawable.jaguar);
        } else if (mobile.equals("Jeep")) {
            imageView.setImageResource(R.drawable.jeep);
        } else if (mobile.equals("Kia")) {
            imageView.setImageResource(R.drawable.kia);
        } else if (mobile.equals("Lada")) {
            imageView.setImageResource(R.drawable.lada);
        } else if (mobile.equals("Lamborghini")) {
            imageView.setImageResource(R.drawable.lamborghini);
        } else if (mobile.equals("Lancia")) {
            imageView.setImageResource(R.drawable.lancia);
        } else if (mobile.equals("Land Rover")) {
            imageView.setImageResource(R.drawable.land);
        } else if (mobile.equals("Lexus")) {
            imageView.setImageResource(R.drawable.lexus);
        } else if (mobile.equals("Lotus")) {
            imageView.setImageResource(R.drawable.lotus);
        } else if (mobile.equals("Maserati")) {
            imageView.setImageResource(R.drawable.maserati);
        } else if (mobile.equals("Maybach")) {
            imageView.setImageResource(R.drawable.maybach);
        } else if (mobile.equals("Mazda")) {
            imageView.setImageResource(R.drawable.mazda);
        } else if (mobile.equals("Mercedes")) {
            imageView.setImageResource(R.drawable.mercedes);
        } else if (mobile.equals("Mercuri")) {
            imageView.setImageResource(R.drawable.mercury);
        } else if (mobile.equals("Mini")) {
            imageView.setImageResource(R.drawable.mini);
        } else if (mobile.equals("Mitshubishi")) {
            imageView.setImageResource(R.drawable.mitsubishi);
        } else if (mobile.equals("Nissan")) {
            imageView.setImageResource(R.drawable.nissan);
        } else if (mobile.equals("Opel")) {
            imageView.setImageResource(R.drawable.opel);
        } else if (mobile.equals("Pagani")) {
            imageView.setImageResource(R.drawable.pagani);
        } else if (mobile.equals("Peugeot")) {
            imageView.setImageResource(R.drawable.peugeot);
        } else if (mobile.equals("Pontiac")) {
            imageView.setImageResource(R.drawable.pontiac);
        } else if (mobile.equals("Porshe")) {
            imageView.setImageResource(R.drawable.porshe);
        } else if (mobile.equals("Renault")) {
            imageView.setImageResource(R.drawable.renault);
        } else if (mobile.equals("Rolls Royce")) {
            imageView.setImageResource(R.drawable.rolls);
        } else if (mobile.equals("Rover")) {
            imageView.setImageResource(R.drawable.rover);
        } else if (mobile.equals("Saab")) {
            imageView.setImageResource(R.drawable.saab);
        } else if (mobile.equals("Scion")) {
            imageView.setImageResource(R.drawable.scion);
        } else if (mobile.equals("Seat")) {
            imageView.setImageResource(R.drawable.seat);
        } else if (mobile.equals("Skoda")) {
            imageView.setImageResource(R.drawable.skoda);
        } else if (mobile.equals("Sssang Young")) {
            imageView.setImageResource(R.drawable.ssang);
        } else if (mobile.equals("Subaru")) {
            imageView.setImageResource(R.drawable.subaru);
        } else if (mobile.equals("Suzuki")) {
            imageView.setImageResource(R.drawable.suzuki);
        } else if (mobile.equals("Toyota")) {
            imageView.setImageResource(R.drawable.toyota);
        } else if (mobile.equals("Vauxhall")) {
            imageView.setImageResource(R.drawable.vauxhall);
        } else if (mobile.equals("Volkswagen")) {
            imageView.setImageResource(R.drawable.volkswagen);
        } else if (mobile.equals("Volvo")) {
            imageView.setImageResource(R.drawable.volvo);
        } else {
            imageView.setImageResource(R.drawable.acura);
        }

    } else {
        gridView = (View) convertView;
    }

    return gridView;
}

@Override
public int getCount() {
    // TODO Auto-generated method stub
    return mobileValues.length;
}

@Override
public Object getItem(int position) {
    // TODO Auto-generated method stub
    return null;
}

@Override
public long getItemId(int position) {
    // TODO Auto-generated method stub
    return 0;
  }
 } 
```

问题是 - 当我向下滚动网格视图时 - 它从一开始就开始显示元素......我的错误是什么？？？？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-24T15:34:08.153

你没有`convertView`正确使用。适配器中的视图被回收以防止创建额外的视图。如果视图被回收，它会被传入`convertView`。但这里重要的一点是视图以前可能属于不同的项目。如果您不再次填充视图，它将包含不正确的数据 - 属于已回收的某个其他项目的数据。

该`getView`方法应该包含以下内容：

```
public View getView(int position, View convertView, ViewGroup parent) {
    View gridView;

    if (convertView == null) {
        // create new gridView here
    } else {
        // recycle the convertView
        gridView = (View) convertView;
    }

    // fill the gridView here

    return gridView;
} 
```

# java - 无法在内部类中引用非最终变量，然后出现 null 错误

> ID：14023069
> 
> 赞同：1
> 
> 时间：2012-12-24T15:24:10.097
> 
> 标签：java, methods, nullpointerexception

我对 Java 中的内部方法没有什么问题。排队：

`dReservation[i].dispose();`

我有一个错误：

> 不能在不同方法中定义的内部类中引用非最终变量 dReservation

我在论坛中阅读了许多主题，但是该问题有两种无效的解决方案：

[不能引用在不同方法中定义的内部类中的非最终变量](https://stackoverflow.com/questions/1299837/cannot-refer-to-a-non-final-variable-inside-an-inner-class-defined-in-a-differen)

[不能在不同方法中定义的内部类中引用非最终变量 i](https://stackoverflow.com/questions/5997953/cannot-refer-to-a-non-final-variable-i-inside-an-inner-class-defined-in-a-differ)

[为什么非最终“局部”变量不能在内部类中使用，而封闭类的非最终字段可以？](https://stackoverflow.com/questions/5801829/why-a-non-final-local-variable-cannot-be-used-inside-an-inner-class-and-inste)

我试图为我的班级设置`JDialog[] dReservation`字段`global`（`GUIShowReservations`）。然后我的错误消失了，但在内部方法 ( `actionPerformed`) 而不是`dReservation[i]`is `null`。

当我设置`JDialog[] dReservation`为`final`字段时，历史相同。它是`null`。

```
bShowReservations = new JButton("Show Reservations");
bShowReservations.addActionListener(new ActionListener(){
public void actionPerformed(ActionEvent arg0) {
  JDialog[] dReservation = new JDialog[10000];

  for(Object o: reservations)
  {
    rez = (Reservations)o;
    reservation.append(rez.getGroup());

    dReservation[i] = new JDialog();
    dReservation[i].setSize(400, 300);
    dReservation[i].setLocationRelativeTo(null);
    dReservation[i].setVisible(false);
    dReservation[i].setLayout( null );
    dReservation[i].setTitle("Edition");

    bEditAccept = new JButton("Edit");
    bEditAccept.addActionListener(new ActionListener(){
        public void actionPerformed(ActionEvent arg0) {
            rez.setTeacher(cEditTeacher.getSelectedItem().toString());
            dao.update(rez);
            dReservation[i].dispose();
        }
    });
    bEditAccept.setSize(160, 24);
    bEditAccept.setLocation(10, 200);
    dReservation[i].add(bEditAccept);
  }
}
}); 
```

你可以帮帮我吗？我想`JDialog`在我的内部方法中看到适当的而不是`null`.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-24T16:06:48.923

很难回答，因为代码不完整，上面的代码没有多大意义。我将解释它实际上做了什么，因为我认为它不会做你想要它做的事情。

该代码创建了一个标记为“显示预订”的按钮。单击此按钮时，会创建一个包含一万个（！）JDialog 实例的数组（为什么？）。所有这些对话框都是空的。

然后，完成一个循环，对保留进行迭代。对于每个预订，都会创建一个新的 JDialog，其中包含一个名为“Edit”的新按钮，单击该按钮会关闭对话框。最后一个对话框存储在索引 i 处的巨型数组中。所有其他的都是免费创建的，因为它们被下一个替换，在数组中的相同索引处。

因此，在循环结束时，您为每个预订创建了一个对话框，但仅将其中一个存储在一个巨大的数组中。而且由于这个巨大的数组是一个局部变量，所以无论如何都没有人可以使用这个对话框，因为数组及其唯一的对话框超出了范围。所以你的动作监听器相当于下面的一个，但是以一种非常缓慢和低效的方式：

```
bShowReservations.addActionListener(new ActionListener(){
    public void actionPerformed(ActionEvent arg0) {
        for (Object o: reservations) {
            rez = (Reservations) o;
            reservation.append(rez.getGroup());
        }
    }
} 
```

也不是说您的代码充满了不良做法。您没有使用通用集合，您正在设置按钮的大小，您没有使用布局管理器而是设置任意位置......

如果您告诉我们代码*应*该做什么，我们可以帮助您做到这一点。

# c# - 从列表中的对象访问数据

> ID：14023074
> 
> 赞同：0
> 
> 时间：2012-12-24T15:24:20.590
> 
> 标签：c#, linq

您好我正在尝试将 LINQ 查询结果转换为对象列表，但我似乎做错了，因为我无法访问每个对象的属性。这是我的代码：

```
List<Object> productList = new List<Object>();

        var products = (from p in Products
                       join s in SubCategories on p.SubcatId equals s.SubCatId
                       join b in Brands on p.BrandId equals b.BrandId
                       select new
                                  {
                                      Subcategory = s.SubCatName,
                                      Brand = b.BrandName,
                                      p.ProductName,
                                      p.ProductPrice
                                  }).Where(x => x.Subcategory == subcategory);

        foreach (var product in products)
        {
            productList.Add(product);
        }

        foreach (var produs in productList){
            Console.WriteLine(produs.ProductName);
        } 
```

当我尝试这样做时，我收到一条错误消息：

```
Object does not contain a definion for ProductName 
```

其他所有领域也是如此 2

如果我尝试这样做，阿尔多：

```
Console.WriteLine(produs); 
```

我得到包含每个字段数据的表格

我已经在 LINQPAD 上运行了这个测试，它在 Visual Studio 中也不起作用。我做错了什么？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-24T15:26:35.923

这就是问题：

```
List<Object> productList = new List<Object>(); 
```

您将其声明为`List<object>`，这意味着当您稍后编写此代码时：

```
foreach (var produs in productList) 
```

然后`produs`隐式键入为`object`.

最简单的方法是使用`ToList()`而不是自己将结果复制到列表中：

```
var products = (from p in Products
                join s in SubCategories.Where(x => x.SubCatName == subcategory)
                  on p.SubcatId equals s.SubCatId
                join b in Brands on p.BrandId equals b.BrandId
                select new {
                    Subcategory = s.SubCatName,
                    Brand = b.BrandName,
                    p.ProductName,
                    p.ProductPrice
                }).ToList(); 
```

*请注意，我已尽可能早地移动了子类别名称过滤器 - 加入后*无需这样做。最后的`ToList()`调用将意味着结果是您的匿名类型`List<T>`在哪里。`T`

然后你可以使用：

```
foreach (var product in products)
{
    Console.WriteLine(produs.ProductName);
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-24T15:28:08.620

采用

```
List<Product> productList = new List<Product>(); 
```

代替

```
List<Object> productList = new List<Object>(); 
```

其中 Product 是 Products 的单位

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-24T15:27:09.823

A `List`of`Object`意味着您只能获得包含在`object`. 您应该执行以下操作：

```
List<Product> productList = new List<Product>(); 
```

就像注释一样，您还可以执行以下操作：

```
productList = products.ToList<Product>(); 
```

而不是遍历列表并添加每个元素。（Linq 隐含地为您执行此操作）。

注意：这是假设您将查询选择更改为`select new Product { ... }` 这将允许您使用`List<Product>`productList 以便您可以将您的产品列表传递给其他方法等。

# youtube-api - 验证登录 YouTube

> ID：14023076
> 
> 赞同：0
> 
> 时间：2012-12-24T15:24:34.917
> 
> 标签：youtube-api, gdata-api

我有一个应用程序，用户可以在其中将视频上传到 youtube。我让用户输入他们的密码和用户名进行登录，然后他们输入“标题”、“描述”、“标签”、“类别”和“隐私设置”，即公共、私人、未列出。一切正常。但是，我无法验证给定用户名的密码是否有效，或者即使用户名有效。填写密码和用户名并点击“登录”按钮后，它们将作为密码.txt 和用户名.txt 保存到文档目录中。然后这些用于完成该过程，实际上是在后续上传时从文档目录加载，直到用户注销，在这种情况下，文件被删除。我的问题是当用户填写密码和用户名并保存它们以确保它们有效时，我想与 YouTube 核对。有人可以帮我弄这个吗。

这是我用来输入用户名和密码的代码以及 YouTube 的开发人员密钥，以获取允许上传视频的服务。

```
- (GDataServiceGoogleYouTube *)youTubeService {

    static GDataServiceGoogleYouTube* service = nil;

    if (!service) {
        service = [[GDataServiceGoogleYouTube alloc] init];

        [service setShouldCacheResponseData:YES];
        [service setServiceShouldFollowNextLinks:YES];
        [service setIsServiceRetryEnabled:YES];

        /*[service setUserCredentialsWithUsername:accountView.text password:PasswordDisplayField.text];*/
    }

    NSString *username = [accountView.text retain];
    NSCharacterSet *whitespace = [NSCharacterSet whitespaceAndNewlineCharacterSet];
    accountView.text = [username stringByTrimmingCharactersInSet:whitespace];

    /*if ([accountView.text rangeOfString:@"@"].location == NSNotFound)
    { accountView.text = [kYoutubeUsername stringByAppendingString:@"@gmail.com"]; }*/

    if (([accountView.text length] > 0) && ([PasswordDisplayField.text length] > 0))
    { [service setUserCredentialsWithUsername:[accountView.text retain] password:[PasswordDisplayField.text retain]]; }
    else
    { [service setUserCredentialsWithUsername:nil password:nil]; }

    [service setYouTubeDeveloperKey:devKey];

    return service;

} 
```

然后我使用此代码获取上传的 URL

```
NSURL *url = [GDataServiceGoogleYouTube youTubeUploadURLForUserID:kGDataServiceDefaultUser]; 
```

但我不确定如何使用这些来检查用户名和密码是否匹配和兼容，如果它们不匹配，则返回错误消息。如果它们不正确，我也不想保存它们。

如果有人可以提出解决方案、教程、视频或其他内容来帮助我完成此任务，我将不胜感激。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-28T17:15:45.937

我强烈建议使用 Objective-C 客户端库迁移到 OAuth 2：

[http://code.google.com/p/gdata-objectivec-client/](http://code.google.com/p/gdata-objectivec-client/) http://code.google.com/p/gtm-oauth2/

作为您的应用程序的用户，如果知道您以这样的明文形式存储我的 Google 帐户地址和密码，我会感到非常难过。请切换到 OAuth 2。

# java - 为什么 Eclipse 检测不到以 cv 开头的 javacv 函数

> ID：14023080
> 
> 赞同：0
> 
> 时间：2012-12-24T15:25:17.270
> 
> 标签：java, opencv

我正在学习 JavaCV，我在 C++ 中在线找到了一个非常好的示例

[http://aishack.in/tutorials/an-introduction-to-contours/](http://aishack.in/tutorials/an-introduction-to-contours/)

但是，Eclips 无法检测到任何以 cv 开头的函数。像 cvCreateImage()，即使方法是静态的。我不知道在这里做什么。javacv 的其他 Java 教程也使用这些方法。

提前非常感谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-24T15:48:31.190

我发现它为什么不起作用 - 你必须在顶部添加一些静态引用。如果其他人被卡住，这就是我添加的

```
import com.googlecode.javacpp.Loader;
import com.googlecode.javacv.*;
import com.googlecode.javacv.cpp.*;
import static com.googlecode.javacv.cpp.opencv_core.*;
import static com.googlecode.javacv.cpp.opencv_imgproc.*;
import static com.googlecode.javacv.cpp.opencv_calib3d.*;
import static com.googlecode.javacv.cpp.opencv_objdetect.*;
import static com.googlecode.javacv.cpp.opencv_highgui.*; 
```

# c# - 解释 ds.Tables[0].Rows.Count？

> ID：14023085
> 
> 赞同：5
> 
> 时间：2012-12-24T15:25:42.383
> 
> 标签：c#, asp.net, .net

我是初学者，所以不要被我的问题逗乐。我认为 `if (ds.Tables[0].Rows.Count > 0)`用于检查数据集是否为空。但在这种情况下究竟`[0]`意味着什么？你能更详细地解释一下这个说法吗？还有这个。。`ds.Tables[0].Rows.Add(ds.Tables[0].NewRow());`

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-12-24T15:26:33.387

它使您可以访问`DataSet`. A`DataSet`拥有一个 的数组`DataTables`，它可以有 0、1 或许多这样的`DataTables`。您可以像访问任何其他数组一样访问它们——通过对它们进行索引。

如果这里有 2 个`DataTables`，`DataSet`您可以使用 访问第一个，使用 访问`ds.Tables[0]`第二个`ds.Tables[1]`

该`ds.Tables[0].Rows.Add(ds.Tables[0].NewRow());`语句将新行添加`DataTable`到`DataSet`. 通过调用`ds.Tables[0].NewRow()`，您将创建一个`DataTable`与数组中的第一行相关联的新行。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-12-24T15:27:23.100

这`ds`是[DataSet](http://msdn.microsoft.com/en-us/library/system.data.dataset%28v=vs.71%29.aspx)的一个实例。一个 DataSet 可能包含多个[Table](http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.table.aspx)实例。

`ds.Tables[0]` **正在访问**`Tables`集合中的第一个表。并且`ds.Tables[0].Rows.Count`正在计算第一张桌子上的行数。

Rows 访问 DataRow 集合。Add 方法再创建一行；但是，您需要将 DataRow 的实例作为参数传递。此 DataRow 对象**必须具有与表相同的结构（列）**，因此，您使用相同的表来创建新的 DataRoq：`ds.Tables[0].NewRow()`

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-12-24T15:37:57.017

```
ds >>>>>>>>>>> Object of DataSet class from System.Data namespace
Tables[0] >>>> DataTable class object at index 0 inside ds object
Rows >>>>>>>>> RowCollection object which contain all the rows
Count >>>>>>>> Used to count no of rows inside the collection. 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-12-24T15:27:12.557

数据集中可以有多个表，通过使用 ds.Tables[0] 您正在获取第一个表。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-01-01T03:50:56.167

以上所有解释都是正确的。

但这是我的 2 美分

ds.Tables[0].Rows.Count

在使用上述语句之前，最好检查以下条件

```
if (ds !=null && ds.Tables.count>0 ) 
```

# .htaccess - .htaccess 的替代方案

> ID：14023086
> 
> 赞同：0
> 
> 时间：2012-12-24T15:25:46.080
> 
> 标签：.htaccess, yii

我正在尝试使用 yii 构建 mu 第一个 Web 应用程序

据我了解，.htaccess 文件必须在项目文件夹中

在本地主机中，一切正常，但是当我上传整个项目时，我的远程服务器不接受 .htaccess 文件，并且找不到 404（服务器错误不是 yii 错误）

这个问题有替代方案吗？

提前谢谢了

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-24T15:30:32.283

使用 Front Controller 模式时别无选择。只有在 http 服务器上，您才能将所有想要的请求重定向到一个中心点。虽然您不能使用 .htaccess，但这很奇怪。

还有一个问题：您是使用 apache 还是其他东西作为 Web 服务器？因为据我所知 .htaccess 是特定于 apache 的，所以对于其他服务器，您需要在不同的其他地方进行不同的配置。

# c# - 从父母版页访问子母版页中的元素

> ID：14023088
> 
> 赞同：0
> 
> 时间：2012-12-24T15:26:02.030
> 
> 标签：c#, asp.net

我有一个父母版页、子母版页和内容页。

在子母版页的内容部分中，我有：

```
<span runat="server" id="CustomSpan"></span> 
```

我需要在这个元素的 innerHTML 属性中添加一些字符串。

父母版页代码背后：

```
string text = "<span class='SpanRight'>test</span>";
CustomSpan.InnerHtml = text; 
```

问题是它没有找到元素：“名称'CustomSpan'在当前上下文中不存在”。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-24T16:36:23.747

很难理解你的问题。如果您想知道母版页如何访问子页面上的元素，在后面的代码中，我在[这里](http://weblogs.asp.net/stevewellens/archive/2009/03/27/master-page-child-pages-dynamic-communication-flexibility.aspx)发表了一篇关于它的文章。

# javascript - 在 JavaScript 文件中创建一个按钮

> ID：14023089
> 
> 赞同：-3
> 
> 时间：2012-12-24T15:26:05.280
> 
> 标签：javascript, button

当我制作 chrome 扩展时，我制作了一个 JavaScript 文件 (.js) 和 html 文件，并在 html 文件中通过这一行调用了 .js 文件：

```
<script src='history.js'></script> 
```

但我想在 JavaScript 文件中而不是在 html 中创建一个按钮

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-24T15:33:55.590

您可以使用`document`s`createElement`方法执行此操作

像

```
var button = document.createElement("input")
    button.type = "submit"
    button.value = "My Button"

document.body.appendChild(button) 
```

这是一个[JSBin](http://jsbin.com/ajaqoy/1/edit)

但这一切都取决于您对“按钮”的含义

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-24T15:30:28.397

您可以使用

```
message = "Clicked Button";
document.write('<button id="mybutton" onclick="alert(message);">Button</button>'); 
```

例子：

```
<!DOCTYPE html> 
<html> 
<head><script src="jquery.min.js"></script>

<script>
    message = "Clicked Button";
    document.write('<button id="mybutton" onclick="alert(message);">Button</button>');
</script> 
</head>
<body> 

</body> 
</html> 
```

# php - 如何使用 PHP 转义字符串中的所有标点符号？

> ID：14023097
> 
> 赞同：-4
> 
> 时间：2012-12-24T15:27:02.833
> 
> 标签：php

我是使用 PHP 创建网站的新手，最近我从一位朋友那里得到一个提示，如果我逃避了从表单输入的所有数据，那么我的网站将不太容易受到 HTMLi 和 SQLi 攻击。比如说：

```
$_POST['name'] is equal to "<h1>You could have prevented this</h1>" 
```

将会发生的事情是在我的网站上它会显得非常大，这根本不好。我希望它显示为

```
<h1>blabla</h1> 
```

不是

# 废话

有一个简单的功能吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-24T15:30:23.400

这取决于您将数据放在哪里。

如果您要将其回显到 HTML 页面中，请使用类似`htmlentities()`.

如果您将其放入 SQL 字符串中，请使用`mysqli_escape_string()`和/或使用参数化查询（`mysqli`“准备”或 PDO）。

如果您将其回显到页面上的 JavaScript 片段中，请使用类似`json_encode()`.

关键是你需要*为你正在做的事情使用正确的转义函数*。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-24T15:29:29.470

当您将用户输入输出到页面上时使用`htmlentities()`或`htmlspecialchars()`。这可以防止 XSS。

为了防止 SQL 注入，您应该使用[准备好的语句](http://php.net/manual/en/pdo.prepare.php)（例如使用 PDO 或 MySQLi），而不是转义。转义是防止 SQLi 的一种原始方法，它并不总是 100% 安全，不像准备好的语句（如果使用得当）。

SQLi 和 XSS 是不同的问题，应该分开解决。没有一种万能的解决方案来防止所有类型的漏洞。每种类型的漏洞都应单独解决。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-24T15:30:37.383

您的“提示”毫无意义，因为 HTML 和 SQL 攻击是不同的东西。但是，如果您想避免显示问题，请使用`htmlspecialchars()`或`htmlentities()`转义此类数据。如果您想处理 SQLInjection，请使用`mysqli_escape_string()`或等效（PDO 自动转义）

# c# - 具有未定义字符数的字符串格式c#

> ID：14023103
> 
> 赞同：3
> 
> 时间：2012-12-24T15:27:26.257
> 
> 标签：c#, string, string-formatting

所以我正在格式化一个字符串，我需要把它排成一个表，但是这个字符串的字符数不确定。无论如何让字符串在每列的同一位置？到目前为止，我有：

```
ostring +=  "Notes\t\t" 
+ "       :  " 
+ employees[number].Notes 
+ "\t\t" 
+ employees[number].FirstNotes 
+ "\t\t" 
+ employees[number].SecondNotes; 
```

我在其他行上使用了类似的方式，但是它们具有预先确定的位数，但这并没有，所以我不能像我想要的那样使用字符串修饰符。

关于我需要做什么的任何想法？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-24T15:30:43.513

您可以使用[`String.PadRight()`](http://msdn.microsoft.com/en-us/library/system.string.padright.aspx)将字符串强制为特定大小，而不是使用制表符。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-24T15:38:55.483

当您使用[String.Format](http://msdn.microsoft.com/en-us/library/system.string.format.aspx)时，项目格式具有以下语法：

```
{ index[,alignment][ :formatString] } 
```

因此，您可以指定对齐方式，它指示插入参数的字段的总长度以及它是右对齐（正整数）还是左对齐（负整数）。

另外最好使用 StringBuilder 来构建字符串：

```
var builder = new StringBuilder();
var employee = employees[number];
builder.AppendFormat("Notes {0,20} {1,10} {2,15}", 
    employee.Notes, employee.FirstNotes, employee.SecondNotes); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-24T15:40:52.423

您首先必须遍历每个条目以找到最大的条目，以便您知道要制作列的宽度，例如：

```
var notesWidth = employees.Max(Notes.Length);
var firstNotesWidth = employees.Max(FirstNotes.Length);
// etc... 
```

然后您可以将列填充到正确的宽度：

```
var output = new StringBuilder();
foreach(var employee in employees)
{
    output.Append(employee.Notes.PadRight(notesWidth+1));
    output.Append(employee.FirstNotes.PadRight(firstNotesWidth+1));
    // etc...
} 
```

并且*请*不要在循环中做很多字符串“添加”（“1”+“2”+“3”+ ...）。改用 a `StringBuilder`。它效率更高。

# ruby - RSpec - 如何模拟存储过程

> ID：14023105
> 
> 赞同：3
> 
> 时间：2012-12-24T15:27:30.370
> 
> 标签：ruby, postgresql, rspec, mocking

考虑以下内容`stored procedure`：

```
CREATE OR REPLACE FUNCTION get_supported_locales()
RETURNS TABLE(
  code character varying(10)
) AS
... 
```

以及以下调用它的方法：

```
def self.supported_locales
  query = "SELECT code FROM get_supported_locales();"
  res = ActiveRecord::Base.connection.execute(query)
  res.values.flatten
end 
```

我正在尝试为此方法编写测试，但在模拟时遇到了一些问题：

```
it "should list an intersection of locales available on the app and on last fm" do
  res = mock(PG::Result)
  res.should_receive(:values).and_return(['en', 'pt'])
  ActiveRecord::Base.connection.stub(:execute).and_return(res)

  Language.supported_locales.should =~ ['pt', 'en']
end 
```

此测试成功，但在此之后运行的任何测试都会给出以下消息：

```
WARNING:  there is already a transaction in progress 
```

为什么会这样？我在嘲讽吗

数据库是postgres 9.1。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-24T16:26:18.243

您的测试正在使用数据库级事务运行。测试完成后，事务将回滚，因此测试中所做的任何更改都不会实际保存到数据库中。在您的情况下，这种回滚不会发生，因为您已经在 ActiveRecord 连接上删除了 execute 方法。

您可以全局禁用事务并切换到使用[DatabaseCleaner](https://github.com/bmabey/database_cleaner)来启用/禁用各种测试的事务。然后，您可以设置默认通过 DatabaseCleaner 使用事务，这样您现有的测试就不会改变，然后在这个测试中选择禁用事务以支持其他策略（例如 null 策略，因为没有清理要为此测试完成）。

[This other SO post](https://stackoverflow.com/questions/3853098/turn-off-transactional-fixtures-for-one-spec-with-rspec-2)表明您可能能够避免全局禁用事务并在每个测试的基础上关闭它们，但我自己没有尝试过。

# arrays - 重新排序数组，使其按相同的元素分组

> ID：14023106
> 
> 赞同：5
> 
> 时间：2012-12-24T15:27:37.200
> 
> 标签：arrays, algorithm, sorting, grouping

我正在研究处理数组的问题，可以通过排序轻松解决。但是，我的要求实际上比全排序更宽松：我只需要保证，如果数组中有任何相同的元素，它们会在数组中彼此相邻。

是否有一种算法可以重新排序数组以使其符合上述标准，这比简单地进行完整排序更有效？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-24T15:32:21.357

如果订单不是问题，您可以尝试任何散列技术。所有散列技术通常会导致相似项目的分组。对于数组中的每个项目，只需使用一个哈希函数，所有元素都根据您定义的函数进行分组。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-25T01:52:19.457

所以答案是否定的。这些信息并没有真正帮助。它可能会让你好一点，但不是大 O。

对于建议散列以获得线性时间的每个人，您也可以对排序执行相同的操作。这种方法称为基数/哈希排序。它会炸毁您的内存使用量。

当有更多限制时，您甚至可以使用更酷的技巧（即求和、异或等）

但是，对于仅在广义数组上使用比较的算法，通过这种方式减少问题并不会买太多。

为了给出一个简单的直觉，假设每个元素都有 1 个冗余，所以你的数组是 a1,a1,...an,an（总共 2n 个元素，n 个唯一数字）。

解空间的大小为 n! （只要 aj-aj 配对，您就可以按照您的问题陈述中指定的任何方式排列该对）。输入空间的大小为 (2n)!/(2^(n))。

这意味着您的算法需要产生足够的信息来排列 ((2n)!/n!)/(2^n) = (n*(n+1)*...2n)/(2^n) 元素。每次比较都会为您提供 1 位信息。所需的比较迭代次数为 log(n)+log(n+1)...+log(2n)-n，即 big_omega(nlog(n))。这并不比排序好或坏。

这是排序的半严格处理： [http ://www.cs.cmu.edu/~avrim/451f11/lectures/lect0913.pdf](http://www.cs.cmu.edu/~avrim/451f11/lectures/lect0913.pdf)

我可能会被贿赂为当前问题生成类似的证据。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-24T19:26:01.843

如果所有元素都可以分成两组，我们可以用哈希解决这个问题。
复杂度是`time = O(n)`和`additional space = O(1)`。

如果所有元素都可以分成三组，我们可以应用上述方法两次。
复杂度是`time = O(n) * 2 = O(n)`和`additional space = O(1)`。

如果所有元素都可以分成四组，我们可以将第一种方法应用 3 次。
复杂度是`time = O(n) * 3 = O(n)`和`additional space = O(1)`。

如果所有元素都可以划分为 k 个组，我们可以应用第一种方法 (k-1) 次。
复杂度是`time = O(n) * (k-1) = O(k*n)`和`additional space = O(k)`。

**这种方法仅**在时间复杂度上优于排序`O(k) < O(log n)`。

实际上，当所有元素都可以分成三组时，这个问题就变成了[Edsger Dijkstra](http://en.wikipedia.org/wiki/Edsger_Dijkstra)提出的[荷兰国旗问题](http://en.wikipedia.org/wiki/Dutch_national_flag_problem)。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-24T15:57:25.163

您对不同的键有*任何*限制吗？

如果没有，您实际上是在寻找哈希袋而不是任何类型的排序。

由于您没有提供任何编程语言，因此这里是一个 python 示例：

```
from collections import defaultdict

data=[ (1,"a"), (2, "c"), (3, "d"), (2, "b") ]

table = defaultdict(lambda: list())
for key, record in data:
     table[key].append(record)

for key, values in table.iteritems():
    for value in values:
        print key, value 
```

这应该在线性时间内运行，因为哈希表查找被认为是 O(1)。

如果您的数据大于主内存，则经典的外部排序方法可能比严重命中外部哈希表更快。一般来说，**全排序*会*更快，因为算法优化得很好**！基准也是如此！

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-12-24T19:12:34.183

这个想法类似于上面的 Python 代码，但是在 CL 中：

```
(defun partition (array &key (test #'eql))
  (loop with table = (make-hash-table :test test)
     for i across array do
       (setf (gethash i table) (1+ (gethash i table 0)))
     finally
       (return
         (loop with result = (make-array (length array))
            with pointer = -1
            for key being the hash-keys of table
            for value being the hash-values of table do
              (loop while (> value 0) do
                   (setf (aref result (incf pointer)) key
                         value (1- value)))
            finally (return result)))))

(partition #(1 2 3 "2" "2" "3" 'a 'b 'b 3 3 1 1 "3" 'a))
;; #(1 1 1 2 3 3 3 "2" "2" "3" 'A 'B 'B "3" 'A)

(partition #(1 2 3 "2" "2" "3" 'a 'b 'b 3 3 1 1 "3" 'a) :test #'equal)
;; #(1 1 1 2 3 3 3 "2" "2" "3" "3" 'A 'A 'B 'B) 
```

它还说明了平等的概念不是既定的。您可以定义您认为什么是相等的，并且根据该定义，将其与排序速度进行比较可能有意义，也可能没有意义（因为排序意味着可以对序列进行排序）。

# java - 使用 -source 5 或更高版本启用泛型时的异常

> ID：14023110
> 
> 赞同：0
> 
> 时间：2012-12-24T15:27:55.533
> 
> 标签：java, ant, version

当我`ant all rebuild`在 cmd 中编写时，我很少遇到与源 5 或更高版本相关的异常来启用泛型。

我有最新*的 jdk1.7*。我有 apache *ant1.8.4*，我将源和目标修改为 1.6 in`ant.pom`和其他几个文件，但我仍然遇到了同样的异常。我已将文件复制`ant.bat`到编译代码的文件夹中。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-24T16:15:05.243

当您使用目标时`1.5`（您不能使用 5.0 版本并且没有版本“5”），您也必须将 -source 设置`1.5`为。

# java - 有没有办法将 RAM 位置（在 java 中）设置为变量，以便我们可以检索值？

> ID：14023113
> 
> 赞同：0
> 
> 时间：2012-12-24T15:28:36.633
> 
> 标签：java, security, ram

如果我没有假设或学到任何错误，那么我们分配的所有变量都会占据 RAM 的某个位置。例如，在使用 Java 数组时，当我们尝试打印一个数组时，它会打印一个“位置”。

> 字符串 [] a = 新字符串 [2]
> 
> System.out.println(a)
> 
> [Ljava.lang.String;@be6280

现在有没有办法设置那个位置？

我认为使用 C++ 是可能的，是吗？如果有任何语言提供这个东西，那么我应该能够至少彻底地扫描我的 RAM 中的变量或数组位置。我不能吗？有没有人试过这样做？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-24T15:32:14.733

[您可以使用 Unsafe 类，如此处](http://highlyscalable.wordpress.com/2012/02/02/direct-memory-access-in-java/)所示。这是特定于 HotSpot JVM 的，但它可能只是一个开始。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-24T15:32:26.963

不，这在 Java 中是不可能的。对于调试工具和其他特殊工具的开发人员来说，有一个用于直接访问内存的后门，但这并不是您和 99.995% 的其他人想要的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-24T15:37:15.000

Java 中的内存 (RAM) 由 Java 虚拟机 (JVM) 控制，与其他编程环境不同，无法在 Java 堆中手动处理内存分配。您可以使用 JNI 或 NIO 在 Java 之外分配内存。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-24T16:12:59.767

设置位置非常不安全，因为 GC 可以随时执行，损坏的内存结构会使 JVM 崩溃。

你可以得到一个对象的位置，但你不需要这个。您可以使用 Reflections 获取对象的任何字段，但您可以使用 Unsafe 提取或设置字段。

# twitter-bootstrap - Bootstrap 中未显示下拉菜单

> ID：14023115
> 
> 赞同：12
> 
> 时间：2012-12-24T15:29:20.940
> 
> 标签：twitter-bootstrap, twitter-bootstrap-2

我正在尝试在 Bootstrap中获得[一个基本的下拉菜单：](http://twitter.github.com/bootstrap/components.html#dropdowns)

```
<!DOCTYPE html>
<html>
  <head>
    <title>Bootstrap 101 Template</title>
    <!-- Bootstrap -->
    <link href="css/bootstrap.min.css" rel="stylesheet" media="screen">
  </head>
  <body>
    <script src="http://code.jquery.com/jquery-latest.js"></script>
    <script src="js/bootstrap.min.js"></script>

    <div class="dropdown">
      <!-- Link or button to toggle dropdown -->
      <ul class="dropdown-menu" role="menu" aria-labelledby="dLabel">
        <li><a tabindex="-1" href="#">Action</a></li>
        <li><a tabindex="-1" href="#">Another action</a></li>
        <li><a tabindex="-1" href="#">Something else here</a></li>
        <li class="divider"></li>
        <li><a tabindex="-1" href="#">Separated link</a></li>
      </ul>
    </div>

  </body>
</html> 
```

然而，什么也没有出现。我知道本地 CSS 和 JS 文件被正确引用。据我了解，默认的 JS 包含所有插件。

编辑：感谢大家的反馈。我只能添加，以防人们发现自己处于与我相同的情况，在复制和粘贴片段之前在教程中[进一步向下移动。](http://twitter.github.com/bootstrap/components.html#buttonGroups)

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-12-26T13:28:08.897

我认为您的代码基本上很好，但是您缺少触发下拉菜单的链接。见 [jsFiddle](http://jsfiddle.net/panchroma/Xag9Y/)

请注意，我添加了

```
<a id="drop1" href="#" role="button" class="dropdown-toggle" data-toggle="dropdown">Dropdown <b class="caret"></b></a> 
```

这是一个如何将其包含在[完整导航栏中的示例](http://jsfiddle.net/panchroma/2bXmT/)

祝你好运！

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-12-27T18:34:11.660

请特别注意`<-- Link or button to toggle dropdown -->`代码中的注释。您需要放置一个带有 data-toggle="dropdown" 属性的链接或按钮来激活下拉菜单。

试试这个 ：

```
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" />
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js"></script>

<div class="dropdown">
  <!-- Link or button to toggle dropdown -->

  <a class="btn btn-default dropdown-toggle" data-toggle="dropdown" href="#">
    <i class="icon-user"></i> TestDropdown
    <span class="caret"></span>
  </a>
  <a class="btn btn-default dropdown-toggle" data-toggle="dropdown" href="#">
    <i class="icon-user"></i> TestDropdown
    <span class="caret"></span>
  </a>
  <a class="btn btn-default" data-toggle="dropdown"> Dropdown Test </a>
  <ul class="dropdown-menu" role="menu" aria-labelledby="dLabel">
    <li><a tabindex="-1" href="#">Action</a></li>
    <li><a tabindex="-1" href="#">Another action</a></li>
    <li><a tabindex="-1" href="#">Something else here</a></li>
    <li class="divider"></li>
    <li><a tabindex="-1" href="#">Separated link</a></li>
  </ul>
</div>
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-12-24T15:48:03.020

从[文档](http://twitter.github.com/bootstrap/components.html#dropdowns)：

> 只看下拉菜单，这是所需的 HTML。您需要将下拉菜单的触发器和下拉菜单包装在 .dropdown 或另一个声明 position: relative; 的元素中。然后只需创建菜单。

因此，您可能需要为您的`dropdown`班级设置 CSS（至少）`position: relative;`。你也有一个默认情况下`display:none`。`.dropdown-menu`尝试也覆盖它。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-12-26T06:52:22.583

而不是 div，尝试使用父 ul 和 li 来包装您在上面发布的 ul。例如，

```
 <ul class="nav nav-pills span7 pull-right" id="upper_username_hide">
       <li class= "dropdown" data-dropdown="dropdown">
         <a id="" class="dropdown-toggle" data-toggle="dropdown" href="#">
          <b class="caret dropdown-toggle"></b>
         </a>
         <ul class="dropdown-menu" >
          <li><a href="#">Action</a></li>
          <li><a href="#">Another action</a></li>
        </ul>
      </li>
    </ul> 
```

我不认为 tab-index 是必要的，因为 bootstrap css 会处理这个问题。祝你好运！

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2017-07-07T04:02:34.887

就我而言，我发现`.dropdown-menu`引导类已将 top 属性设置为: `top: 100%`，这导致下拉菜单显示在视口之外。我确实用另一个类覆盖了最高值，现在正在工作。

# c# - 监听文件系统

> ID：14023117
> 
> 赞同：2
> 
> 时间：2012-12-24T15:29:24.593
> 
> 标签：c#

我想编写应用程序如何处理文件并听取目录根目录并将仅在过去 2 天内创建的文件添加到我的应用程序中。

1.  `FileSystemWatcher`类可以只听一个目录还是可以用我的根文件夹下的所有子目录来做？

2.  仅查找最近两天创建的文件的最佳选择是什么？（文件信息。创建时间？）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-24T15:32:27.523

根据[MSDN](http://msdn.microsoft.com/en-us/library/system.io.filesystemwatcher.aspx)：

> 使用 FileSystemWatcher 监视指定目录中的更改。您可以监视指定目录的文件和**子目录的变化。**

因此，要回答您的第一个问题，是的，它可以对您的根文件夹的所有子目录执行此操作。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-24T15:39:50.133

对于第二个问题，您可以遍历目录中的文件并检查它们的创建日期。

```
foreach (FileInfo fi in directory.GetFiles())
{
    if (fi.CreationTime.Date <= DateTime.Today.AddDays(-2)) 
    {
        //process file
    }
} 
```

或者，您可以使用 LINQ

```
var recentFiles = directory.GetFiles().Where(x =>
                                x.CreationTime.Date <= DateTime.Today.AddDays(-2))
                                .Select(x => x.Name)
                                .ToList(); 
```

您需要对性能差异进行基准测试，但对于少数文件，我怀疑会有显着差异。

# perforce - p4 协调返回错误

> ID：14023118
> 
> 赞同：2
> 
> 时间：2012-12-24T15:29:25.087
> 
> 标签：perforce

运行“p4 reconcile”命令时。

它返回以下错误：

*客户端没有必要的协调支持。*

这是什么意思？p4v 可以在同一台 PC 上进行协调。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-24T16:20:42.420

P4 reconcile requires at least version 2012.1.

[Taken from the Perforce Blog:](http://www.perforce.com/blog/120126/new-20121-p4reconcile-p4status)

The 2012.1 release of Perforce is just about to be released for beta. It's loaded with great new features. One is the p4 reconcile command, with its fraternal twin, p4 status.

# jsf - JSF f:validateBean 验证组未更新

> ID：14023124
> 
> 赞同：2
> 
> 时间：2012-12-24T15:29:58.190
> 
> 标签：jsf, jsf-2, validationgroup

我正在使用带有 JSF2.0 的 bean 验证。我有一个验证组，我根据几个条件指定它并链接到托管 bean 中的属性。该属性在页面首次加载并正常工作时分配（即，当提交表单时，验证了正确的组）。但是，如果我更改此属性，则不会更新验证组，并且将使用设置的任何原始值。

例如：JSF 片段：

```
<h:selectOneMenu id="unitOfMerchandise" value="#itemManager[targetBean].unitOfMerchandise}">
    <f:selectItem itemLabel="-- select --" itemValue="" />
    <f:selectItems value="#{itemManager.unitsOfMerchandise}" />
    <f:validateBean   validationGroups="#{itemManager.validatorClass}"  />
 </h:selectOneMenu> 
```

方法：

```
@ManagedBean
@ViewScoped
public class ItemManager implements Serializable {
private String validatorClass = "com.rcs.itemmngr.model.validation.RegularItem"
private OpenItemRequest openItemRequest

private void onItemTypeSelected() {

        validatorClass = itemManagerModel.getValidatorItemRequestClass(openItemRequest).getName();

}
///getters setters
} 
```

关于如何让它发挥作用的任何想法？我还寻找了一种在托管 bean 中以编程方式更改验证组的方法，但没有任何乐趣。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-05-27T12:25:52.353

f:validateBean 组被评估一次：在构建组件树时。似乎没有简单的方法来更新它们。

*   您可以为每个组件手动更新它们：

    ```
    //bind you component here
    EditableValueHolder input;    

    //call this to update groups         
    public void setValidationGroups(String validationGroups) {
        for (Validator validator : input.getValidators()) {
            if (!(validator instanceof BeanValidator)) {
                 continue;
            }
            BeanValidator beanValidator = (BeanValidator) validator;
            beanValidator.setValidationGroups(validationGroups);
        }
    } 
    ```

*   或者您可以使用本文中描述的方法： [删除持有不需要状态的组件](http://www.logikdev.com/2011/06/13/delete-the-components-holding-unwanted-state/)

    这个想法是从树中删除带有 f:validateBean 的组件，因此它们将在使用新组呈现时重新初始化：

    ```
    parentComponent.getChildren().clear(); 
    ```

    例如，如果你正在执行和渲染一个部分，你可以在 actionListner 中调用这样的东西：

    ```
    public void resetContactsValidationGroups() {
       FacesContext ctx = FacesContext.getCurrentInstance();
       Iterator<String> ids = ctx.getPartialViewContext().getExecuteIds().iterator();
       while (ids.hasNext()) {
           ctx.getViewRoot().findComponent(ids.next()).getChildren().clear();
       }
    } 
    ```

# php - 正则表达式冗余或额外的安全性？

> ID：14023125
> 
> 赞同：1
> 
> 时间：2012-12-24T15:29:58.240
> 
> 标签：php, regex, security

假设我有一个使用正则表达式清理字符串的函数：

```
function RegExCleaner($var)
{
    return preg_replace('Regular expression', '', $var)
} 
```

函数的外观和工作方式并不重要。只是一个简单的例子。

如果我使用此功能来清理用户输入或某个值一次，然后使用值“服务器端”来清理一次就足够了，还是可以多层进行？因此，如果我在一系列函数中使用变量，我是否在每个函数中都清理它？这实际上提高了安全性还是我只是增加了不必要的工作量？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-24T15:35:34.200

恕我直言，最好有一个地方发生这种情况。在进入系统的过程中清理所有东西，然后你就不用担心了。如果你在很多地方进行消毒，跟踪你在哪里消毒也会让人感到困惑。在每个级别进行清理不会损害您的逻辑，但由于这个原因可能会使维护变得更加困难。

我推荐一个函数库来清理输入，可能包含在一个类中，例如作为静态方法，并通过其中一个函数传递所有内容。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-24T15:56:44.850

基本上有两种处理用户输入的方法：

1.  **消毒：**这会从输入中删除不需要的东西。不需要的东西可能是各种标签、格式无效的字符、某些单词或字母等。这几乎总是你应该做的事情。唯一的例外是如果输入是一个简单的值，例如整数或布尔值，可以通过验证直接处理。

2.  **验证：**这可以确保输入确实是您所期望的。它是数字、布尔值、文本块等吗？这与其说是关于安全性，不如说是关于实际获取正确类型的数据以使您的程序能够运行。

对于这两点，有一个名为[Filter](http://php.net/filter)的 PHP 扩展。它是考虑到这些东西而制作的。

对于清理输入，您可以执行以下操作：

```
$name     = filter_input(INPUT_POST, 'name', FILTER_SANITIZE_STRING);
$age      = filter_input(INPUT_POST, 'age', FILTER_SANITIZE_NUMBER_INT);
$email    = filter_input(INPUT_POST, 'email', FILTER_SANITIZE_EMAIL);
$password = filter_input(INPUT_POST, 'password', FILTER_UNSAFE_RAW); 
```

并用于验证：

```
if (preg_match('/[\w\d]{4,20}/', $name) === 0) {
    die('Invalid name!');
}
if ( ! ctype_digit($age) || ($age < 13)) {
    die('Invalid age or too young!');
}
if ( ! filter_var($email, FILTER_VALIDATE_EMAIL)) {
    die('Invalid email address!');
}
if (strlen($password) < 10) {
    die('Password is too short!');
} 
```

要记住的一件非常重要的事情是没有神奇的药丸。用户输入不能只是在漂白剂进来的时候洗掉，然后说是安全的。您需要知道用户输入应该是什么，然后相应地处理它。如果它不是您所知道的，那么立即踩刹车并将其扔回给用户。

# html - html - 如何在第一页中间加载另一个页面

> ID：14023128
> 
> 赞同：0
> 
> 时间：2012-12-24T15:30:23.283
> 
> 标签：html, css

我对 HTML 的基本知识有一个尴尬的问题

我想在我的第一页中打开/加载第二页

加载第二页的菜单按钮 -

```
<li class="current"><a href="first.html" target = "myContent">About us</a></li> 
```

我的第一页的一部分称为“myContent”，但（打开第二页）不能正常工作（页面在另一个窗口中打开）

```
<div id="myContent" name="myContent" style="background-color:#EEEEEE;height:200px;width:800;float:left;"> </div> 
```

我究竟做错了什么？谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-24T15:32:40.393

你应该用 iframe 替换`div#myContent`你[的](https://developer.mozilla.org/en-US/docs/HTML/Element/iframe)：

```
<iframe id="myContent" name="myContent" style="background-color:#EEEEEE;height:200px;width:800;float:left;"> </iframe> 
```

您可能需要在此处添加一些额外的样式。

或者您可以使用[AJAX](https://developer.mozilla.org/en-US/docs/AJAX)通过 JS 加载内容。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-24T15:33:24.950

使用它而不是 div

```
<iframe id='myContent'></iframe> 
```

# calculated-columns - 在 DynamicData Site 表中显示计算列？

> ID：14023131
> 
> 赞同：0
> 
> 时间：2012-12-24T15:30:36.147
> 
> 标签：calculated-columns, asp.net-dynamic-data

根据我阅读的内容，要在 ASP DynamicData 表中添加一个计算出的 Column，我只需要在表类中添加一个 Readonly 属性，然后设置：[ScaffoldColumn(true)] 并返回值。

这是我根据这些规则所做的，但它不起作用：

```
public struct Rep
{
    public int ID;
    public string Name;
}

[ScaffoldTable(true)]
public partial class RepInfo
{
    private static bool IsGotAllReps = false;

    public static List<Rep> Reps
    {
        get
        {
            IQueryable<int> srID = null;
            IQueryable<Rep> srName = null;

            if (!IsGotAllReps)
            {
                using (MiscDataContext dc = new MiscDataContext())
                {
                    srID = dc.MdmSalesAdjustment.Select(s => s.RepID).Distinct();
                }

                using (DWDataContext dc = new DWDataContext())
                {
                    srName = dc.ReportHierarchy.Select(s => new Rep { ID = s.RepEmployeeID, Name = s.RepFirstName + " " + s.RepLastName }).Distinct();
                }
            }

            IsGotAllReps = true;
            return srID.Join(srName, id => id, name => name.ID, (id, name) => new Rep { ID = name.ID, Name = name.Name }).ToList();
        }
    }

    //THIS IS AN EXISTING COLUMN IN THE TABLE THAT I WILL USE TO GET THE REPNAME - SEEL CALC COL BELOW
    public virtual int RepID
    {
        get;
        set;
    }

    //THIS IS THE CALCULATED COLUMN THAT I WANT TO SHOW.
    [ScaffoldColumn(true)]
    public virtual string RepName
    {
        get
        {
            return Reps.Where(r => r.ID == this.RepID).FirstOrDefault().Name;
        }
    }

} 
```

一切仍然有效，表格按预期显示，只是我没有看到计算列。

谢谢！

# java - 使用休眠和 sql server 进行批量插入

> ID：14023136
> 
> 赞同：1
> 
> 时间：2012-12-24T15:30:50.720
> 
> 标签：java, hibernate, sql-server-2005

我正在使用带有 sql server 2005 的休眠（3.3 vesion）。我必须将 10 万条记录插入数据库。由于我将 IDENTITY 用于主生成策略，因此我无法在休眠中进行批量插入。我尝试了 StatelessSession 并且无法获得任何性能。

任何人都可以提出一种提高性能的方法吗？

请帮忙。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-24T15:46:26.937

使用`HibernateTemplate.saveOrUpdateAll(Collection entities)`将提供更好的性能。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-24T18:16:14.900

您的主要问题是防止 Hibernate 在内存中缓存您要插入的所有记录。如果您只在事务中批量插入记录，则可以使用 StatelessSession。如果你做其他操作，例如记录一些关于批量加载的统计信息，你应该在一定数量的记录之后调用 session.flush()，session.clear()，例如每 10K 条记录。

# xml - RESTeasy 客户端：发送 xml 数据 POST = 意外元素 (uri="", local="paint")

> ID：14023137
> 
> 赞同：0
> 
> 时间：2012-12-24T15:30:51.610
> 
> 标签：xml, inheritance, post, jaxb, resteasy

我想通过 POST 请求将序列化对象发送到服务器。

```
 Paint paint = new Paint();
        paint.setYear(2010);
        paint.setTitle("title");

        JAXBContext jc = JAXBContext.newInstance(Paint.class, Art.class);
        Marshaller marshaller = jc.createMarshaller();
        marshaller.setProperty(Marshaller.JAXB_ENCODING, "UTF-8");
        java.io.StringWriter sw = new StringWriter();
        marshaller.marshal(paint, sw);

        ClientRequest request = new ClientRequest("http://localhost:8080/rest/createArt");

        request.body("application/xml", sw.toString());

        ClientResponse<Response> response = request.post(Response.class); 
```

对于这个简单的服务：

```
@POST
@Path("/createArt")
@Consumes("application/xml")
public Response createArt(Art a){
    artDAO.createArt(a);
    return Response.ok(a).build();
} 
```

但我收到以下错误：

```
DefaultClientConnection:249 - Receiving response: HTTP/1.1 400 javax.xml.bind.UnmarshalException: unexpected element (uri:"", local:"paint"). Expected elements are <{}art>, <{}photo> 
```

为什么要开设这些课程？

Art.java：抽象类

```
@Entity @Inheritance(strategy=InheritanceType.SINGLE_TABLE)
@XmlRootElement(name = "art")
public abstract class Art {

@Id @GeneratedValue(strategy = GenerationType.AUTO) 
private int id;

@OneToMany (mappedBy="art",cascade={CascadeType.PERSIST, CascadeType.REMOVE})
private List<Photo> photo;
...
} 
```

Paint.java ：继承自 Art

```
@Entity
@XmlRootElement(name = "paint")
public class Paint extends Art{
@Enumerated(EnumType.STRING)
private SupportArt support;
@Enumerated(EnumType.STRING) 
private Realisation realisation;
...
} 
```

照片.java

```
@Entity
@XmlRootElement(name = "photo")
public class Photo {

@Id @GeneratedValue(strategy = GenerationType.AUTO) 
private int id;

@ManyToOne 
@JoinColumn (name="art_id")
private Art art;

private String path;
...
} 
```

我不明白我的错误，我认为这是 JAXB 注释的问题。继承也给我带来了一些麻烦。照片和艺术之间存在双向关系，当我删除它时，照片不再在预期的元素中（它持续 <{}art>）。

我在网上搜索并尝试了很多东西，但它并没有解决我的问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-25T17:24:37.903

我发现了我的错误，我只需要使用 XmlSeeAlso ：

Art.java：抽象类

```
@Entity @Inheritance(strategy=InheritanceType.SINGLE_TABLE)
@XmlSeeAlso(Paint.class)
public abstract class Art { 
```

也不得不修改这一行：

```
ClientResponse<String> response = request.post(String.class); 
```

# android - 如何在 Google TV 设备上播放 swf 文件？

> ID：14023138
> 
> 赞同：0
> 
> 时间：2012-12-24T15:30:57.913
> 
> 标签：android, flash, google-tv

我试过这个

```
Intent intent = new Intent();  
        intent.setAction(android.content.Intent.ACTION_VIEW);  
        String pathFlash = getExternalFilesDir(null).getAbsolutePath() + File.separator + "flash/1.swf";
        File file = new File(pathFlash);  
        intent.setDataAndType(Uri.fromFile(file), "flash/*");  
        startActivity(intent); 
```

但它使应用程序崩溃，因为 android 无法找到播放 flash 文件的适当活动。

我还有其他方法可以在 google tv 设备上播放 flash 文件吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-24T23:15:18.047

您可以使用 Chrome 以有限的方式播放 Flash 视频（Flash 10 及更低版本目前可以使用）。尝试将本地 uri 传递给 Flash 文件到 Chrome - 它可能有效 - 我还没有尝试过。您还可以尝试创建一个本地 html 文件，其中嵌入了 flash 对象，加载到 Chrome 中（html 中的本地 flash 文件引用 - 使用意图传递 html 的 uri）

# python-2.7 - python中的POST SOAP请求得到错误响应：403 Forbidden

> ID：14023139
> 
> 赞同：0
> 
> 时间：2012-12-24T15:31:11.277
> 
> 标签：python-2.7

请问有人可以帮忙吗？我正在尝试在 python 中发布一个 SOAP 请求，但我收到错误响应 403：禁止访问。我的代码如下所示：我正在使用 python 导入：

```
import httplib
 import base64
 import string

    #the message
    message = """<soap:Envelope ...rest message </soap:Envelope>"""

    host = "host.test.com"

    url = 'https://server.etc.com' #End point url 
```

我也需要使用基本身份验证，所以我需要 http 标头中的用户名和密码

```
username = 'username'
    password = 'password'

   webSoapAction = 'urn:etc-com:document...'

        #the Authentication in base64 encoding form for Basic Authentication
        auth = 'Basic' + string.strip(base64.encodestring(username +'.'+ password))

        webservice = httplib.HTTP(host) #connect to the server(host) 
```

在这里我尝试构建标题：

```
webservice.putrequest("POST", url)
        webservice.putheader("Host", host)
        webservice.putheader("User-Agent", "Python http auth")

    webservice.putheader("Content-Type:", "text/xml; charset=\"UTF-8\"")
    webservice.putheader("Content-length", "%d" % len(message))
    webservice.putheader("SOAPAction",webSoapAction)

    webservice.putheader('Authorization', auth)

    webservice.endheaders()
    webservice.send(message) 
```

我应该在这里得到回复

```
#get the response
    statuscode, statusmessage, header = webservice.getreply()
    print "Response: ", statuscode, statusmessage
    print "Headers: ",header
    res = webservice.getfile().read()
    print 'Content: ', res 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-26T18:42:08.400

关于您的基本身份验证标头结构的两件事：

*   在“基本”和您的秘密之间放置一个空格
*   使用“：”而不是“。” 在用户名和密码之间

所以它应该看起来像：

```
#the Authentication in base64 encoding form for Basic Authentication
auth = 'Basic ' + string.strip(base64.encodestring(username +':'+ password)) 
```

# jquery - CarouFredsel 分离器

> ID：14023141
> 
> 赞同：1
> 
> 时间：2012-12-24T15:31:21.627
> 
> 标签：jquery, css, scroller, caroufredsel

我正在尝试向 CarouFredsel 滚动条添加分隔符。最简单的方法是为每个项目添加一个右边框，但是您可以看到最后一个项目中有一个错误。关于我该怎么做的任何好主意？问题是插件的计算不允许我通过边距或填充甚至溢出来纠正这个问题。在这里你可以看到**[jsFiddle Demo](http://jsfiddle.net/ignaciocorreia/dcE6T/6/)**

我努力了：

```
#carouFredSel li {
    display: block;
    border-right: solid 1px black;
    float: left;
    height: 100px;
    text-align: center;
    width: 100px;
} 
```

## 这是结果

我必须将 Items 的边框分隔符更改为 Items -> 链接，这是[结果。](http://jsfiddle.net/ignaciocorreia/dcE6T/8/)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-24T16:19:19.937

I think adding width to your first jsfiddle will solve the problem [http://jsfiddle.net/dcE6T/15/](http://jsfiddle.net/dcE6T/15/)

```
var pager = $("#carouFredSel").carouFredSel({

        items: 6,
        width:600,

        auto: false, 
```

# php - 将文件系统权限限制为 apache/php 以进行除日志记录操作之外的任何操作

> ID：14023142
> 
> 赞同：3
> 
> 时间：2012-12-24T15:31:26.010
> 
> 标签：php, apache, unix, permissions

你好，圣诞快乐，

我有一个奇迹。我的需要是允许通过 php 创建自定义日志文件和文件夹，但是我不希望 php 脚本能够在我的 unix 服务器上执行任何取消链接或有害操作。

重要的是要知道用户可能会使用自定义 php 脚本，这就是为什么我必须最大限度地防止有害操作，但是创建日志文件之一。

你知道这是否可以在 centOs6 下使用 Apache 2 完成吗？

谢谢你的支持，S。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-26T02:03:24.760

您可以使用 php 的[open_basedir](http://php.net/manual/en/ini.core.php#ini.open-basedir)设置将它们限制在专用目录中以在其中创建和修改日志文件。此外，您可能希望将 apache 配置为不提供/执行该目录中的任何文件，因为它们可能会写入可执行文件。

您仍然需要担心禁用 exec() 等其他函数以防止它们运行系统命令，因为 open_basedir 是一个纯粹的 php 强制概念，它不会通过文件系统权限系统影响服务器的其余部分。

“我的 Unix 服务器上的或有害的操作”是困难的部分。您可能需要考虑设置一个虚拟机来为他们提供一个强大的监禁环境。

# asp.net-mvc - 在 Asp.net MVC 中，如果我更改视图列，是否需要更新实体？

> ID：14023144
> 
> 赞同：1
> 
> 时间：2012-12-24T15:31:30.940
> 
> 标签：asp.net-mvc, orm, entity

我觉得这个网站很有趣，也很有帮助。我在用 asp.net mvc 编写项目时遇到了这个疑问。我不得不从一个视图中删除几列，这些列用于将数据库中的数据拉回我的表示层。删除这些列后，我构建了我的项目并且没有错误。当我运行它时，我的项目因缺少相关列而出错，因为实体未更改。

但是，我的问题是每次我需要更新我的实体模型时是否有必要？如果我在生产中部署我的项目，然后不得不从视图中删除一列怎么办？如果我不得不更新模型、构建并将其重新部署到生产环境中，这对我来说将是一项艰巨的任务。有一个简单的解决方案吗？感谢您的帮助

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-24T16:41:52.923

每次数据库结构发生变化时都必须更新实体模型，您需要做的是将EF模型与MVC项目解耦，如果您不使用Ioc，更简单的方法应该是放置EF模型在单独的程序集中，当数据库发生变化时，重新构建程序集并将其部署在服务器上，这样您就不需要重新构建整个 MVC。

# sql - 在 SQL Server 中查找最近的日期

> ID：14023145
> 
> 赞同：40
> 
> 时间：2012-12-24T15:31:43.953
> 
> 标签：sql, sql-server, date

`dbo.X`我有一张`DateTime` `column Y`可能有数百条记录的表。

我的存储过程有参数`@CurrentDate`，我想找出`column Y`上表`dbo.X`中小于和最接近的日期`@CurrentDate.`

如何找到它？

* * *

## 回答 #1

> 赞同：80
> 
> 时间：2012-12-24T15:36:35.043

where 子句将匹配日期小于 @CurrentDate 的所有行，并且由于它们是按后代排序的，因此 TOP 1 将是最接近当前日期的日期。

```
SELECT TOP 1 *
FROM x
WHERE x.date < @CurrentDate
ORDER BY x.date DESC 
```

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2012-12-24T15:33:11.093

使用[DateDiff](http://msdn.microsoft.com/en-us/library/ms189794.aspx)并按该日期与输入之间的天数或秒数对结果进行排序

像这样的东西

```
 select top 1 rowId, dateCol, datediff(second, @CurrentDate, dateCol) as SecondsBetweenDates
    from myTable
    where dateCol < @currentDate
    order by datediff(second, @CurrentDate, dateCol) 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2018-01-05T12:36:58.310

我认为我对这个问题有更好的解决方案。

我将展示一些图像来支持和解释最终解决方案。

**背景** 在我的解决方案中，我有一张外汇汇率表。这些代表不同货币的市场汇率。但是，我们的服务提供商在费率馈送方面存在问题，因此某些费率的值为零。我想用与丢失汇率最接近的同一货币的汇率填充丢失的数据。基本上我想获得最接近的非零利率的 RateId，然后我将替换它。（这在我的示例中没有显示。）

**1）首先让我们确定丢失的费率信息：**

[查询显示我的缺失率，即率值为零](https://i.stack.imgur.com/Hrrcp.png)

**2）接下来让我们确定没有丢失的费率。** [查询显示未丢失的费率](https://i.stack.imgur.com/NlWhx.png)

3) 这个查询是魔法发生的地方。我在这里做了一个假设，可以删除但添加以提高查询的效率/性能。第 26 行的假设是，我希望在丢失/零交易的同一天找到替代交易。神奇的是第 23 行：Row_Number 函数添加了一个从 1 开始的自动编号，用于丢失和未丢失事务之间的最短时间差。下一个最近的事务的 rownum 为 2 等。

请注意，在第 25 行中，我必须加入货币，以免与货币类型不匹配。那就是我不想用瑞士法郎值代替澳元货币。我想要最接近的匹配货币。

[将两个数据集与 row_number 组合以识别最近的交易](https://i.stack.imgur.com/TA89X.png)

**4) 最后，让我们获取 RowNum 为 1** [的数据 最终查询](https://i.stack.imgur.com/kEAMg.png)

查询全查询如下；

```
 ; with cte_zero_rates as
(
        Select      * 
        from        fxrates
        where       (spot_exp = 0 or spot_exp = 0) 
),
cte_non_zero_rates as
(
        Select      * 
        from        fxrates
        where       (spot_exp > 0 and spot_exp > 0) 
)
,cte_Nearest_Transaction as
(
        select       z.FXRatesID    as Zero_FXRatesID
                    ,z.importDate   as Zero_importDate
                    ,z.currency     as Zero_Currency
                    ,nz.currency    as NonZero_Currency
                    ,nz.FXRatesID   as NonZero_FXRatesID
                    ,nz.spot_imp
                    ,nz.importDate  as NonZero_importDate
                    ,DATEDIFF(ss, z.importDate, nz.importDate) as TimeDifferece
                    ,ROW_NUMBER() Over(partition by z.FXRatesID order by abs(DATEDIFF(ss, z.importDate, nz.importDate)) asc) as RowNum
        from        cte_zero_rates z 
        left join   cte_non_zero_rates nz on nz.currency = z.currency
                    and cast(nz.importDate as date) = cast(z.importDate as date)
        --order by  z.currency desc, z.importDate desc
)
select           n.Zero_FXRatesID
                ,n.Zero_Currency
                ,n.Zero_importDate
                ,n.NonZero_importDate
                ,DATEDIFF(s, n.NonZero_importDate,n.Zero_importDate) as Delay_In_Seconds
                ,n.NonZero_Currency
                ,n.NonZero_FXRatesID
 from           cte_Nearest_Transaction n
 where          n.RowNum = 1
                and n.NonZero_FXRatesID is not null
 order by       n.Zero_Currency, n.NonZero_importDate 
```

* * *

## 回答 #4

> 赞同：-7
> 
> 时间：2012-12-24T15:54:01.913

```
CREATE PROCEDURE CurrentDate
@CurrentDate DATETIME
AS
BEGIN
    Select * from orders
    where OrderDate < @CurrentDate
END
GO 
```

# java - 创建可运行的 JAR 文件后 ImageIcon 丢失

> ID：14023146
> 
> 赞同：0
> 
> 时间：2012-12-24T15:31:55.650
> 
> 标签：java, eclipse, image, embedded-resource, imageicon

![在此处输入图像描述](../Images/f5bee9cf7e6aafbaa162b78b6dd5d968.png)

当我在 Eclipse 中单击**播放时，项目运行良好，但在创建****可运行的 JAR 文件**后，`ImageIcon`按钮消失了。
图像存储在 src 文件夹中，位于子文件夹 images 下。
我将图像图标创建为

*   图标 playIcon = (Icon) new ImageIcon("src/images/play.png");

## 虽然我使用的是相对路径，但按钮不显示图像，即使在 JAR 文件中，如何获取图像？

* * *

* * *

### 尼古拉库兹涅佐夫回答后更新

我最终为屏幕录像机创建了一个非常非结构化的单片代码，现在实现他所说的有点困难。
我想知道是否有一种方法可以创建一个包含所有这些资源的类或接口。

*   例如：

```
public class embeddedResources {
    public static Icon blackCursor;
    public static Icon whiteCursor;
    ...
    ...
} 
```

然后我所要做的就是在我的主`ScreenRecorder`类中导入这些静态数据，

```
this.blackCursor = embeddedResources.blackCorsor; 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-24T15:41:09.450

我正在使用这种方法将图像读入`BufferedImage`IconManager 是定义它的类的位置。

```
private static BufferedImage readBufferedImage (String imagePath) {
    try {
        InputStream is = IconManager.class.getClassLoader().getResourceAsStream(imagePath);
        BufferedImage bimage = ImageIO.read(is);
        is.close();
        return bimage;
    } catch (Exception e) {
        return null;
    }
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-24T15:37:24.040

我有同样的问题。尝试制作 JAR 文件并将图像添加到外部文件夹。所以你在这个文件夹中有一个文件夹“游戏”是你的图像文件夹，叫做“图像”或者你的 jar 文件。如果您现在将文件夹路径编辑为“../images/play.png”，它应该可以工作。

# windows - 无法保存旧的 netsh http urlacl 预订

> ID：14023147
> 
> 赞同：4
> 
> 时间：2012-12-24T15:31:58.193
> 
> 标签：windows, wcf, sysadmin, basichttpbinding, netsh

我正在试验服务器上的设置，它从 netsh http show urlacl 中提供了以下信息：

```
Reserved URL            : http://+:47001/wsman/
    User: NT SERVICE\WinRM
        Listen: Yes
        Delegate: No
    User: NT SERVICE\Wecsvc
        Listen: Yes
        Delegate: No
        SDDL: D:(A;;GX;;;(redacted)((A;;GX;;;(redacted)) 
```

很明显，两个用户帐户注册了同一个 URL，对吧？但是自从删除了那个保留（我用 NT AUTHORITY\NETWORK SERVICE 替换了它，它在某处被推荐但不再需要，因为我修复了真正的原因），我无法将它恢复为这些设置，因为 netsh 似乎只允许您为每个预订创建一个用户。

有什么特殊的语法吗？另一种设置这个东西的方法？我读过“作为一个小组做”，但这看起来不像最初是一个小组，对吧？其他所有服务器都是这样设置的……所以一定有什么办法。我错过了什么？

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-24T16:47:14.550

对不起，我想通了。

解决方案是您可以使用 SDDL 指定多个组（我不知道它是什么，但它是某些权限设置加上 SID 的简写）。

所以我做了一个`netsh http add urlacl url=http://+:47001/wsman/ sddl="D:(A;;GX;;;[redacted])(A;;GX;;;[redacted])"`

它最终将设置恢复到以前的状态。我应该注意，您必须完全正确地获取上述语法才能接受它。如果需要，还可以使用一些 PowerShell 命令将用户帐户（如上面的帐户）转换为 SID。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2014-07-01T07:49:01.560

因为它可能对其他人有帮助，所以我只想在上面的 netsh 命令中添加它，您只需将 [redacted] 替换为您要添加的用户的 SID。所以对于一个用户：

```
netsh http add urlacl url=http://+:47001/wsman/ sddl="D:(A;;GX;;;<SID>)" 
```

对于两个用户...

```
netsh http add urlacl url=http://+:47001/wsman/ sddl="D:(A;;GX;;;<SID1>)(A;;GX;;;<SID2>)" 
```

ETC...

这些命令将授予对 SID 指定的用户帐户的 GenericExecute 访问权限。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2016-03-18T06:02:44.083

要使用命令添加/删除 URL，**首先以管理员身份运行 cmd**

**添加 URL：netsh http add urlacl url= [http://192.168.1.143:9608/](http://192.168.1.143:9608/) user=everyone** 用你的本地 IP 地址替换 190.168.1.143 并用你的本地端口替换 9608。

**要删除已经存在的 URL：netsh http delete urlacl url= [http://192.168.1.1.143:9608](http://192.168.1.1.143:9608)**

最后一步是**配置 Windows 防火墙以允许端口上的外部流量： netsh advfirewall firewall add rule name="IISExpressXamarin" dir=in protocol=tcp localport=9608 profile=private remoteip=localsubnet action=allow**

# html - IE7宽度：自动问题

> ID：14023155
> 
> 赞同：0
> 
> 时间：2012-12-24T15:32:56.057
> 
> 标签：html, css, internet-explorer, width, internet-explorer-7

CSS

```
 #wrapper .tn{
      width:auto;
      height:20px;
      line-height:20px;
      float:left;
      padding:5px 2px 5px 5px;
      margin:0 5px 10px;
      font-weight:bold;
      background:#f0f0f0;
    } 
```

HTML

```
 <div id="wrapper">
        <div class="tn">Text</div>
        <div class="tn">Text</div>
        <div class="tn">Text</div>
    </div> 
```

以上代码在 FF,Chrome,Safari,Opera,IE9,IE8 中运行流畅。但是IE7有问题。div 不根据文本扩展。它以宽度覆盖包装器 div。我怎样才能解决这个问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-24T15:37:10.053

对我来说似乎很好，使用 IE7 开发人员工具检查，您可以尝试`display: inline-block;`代替`float`

```
#wrapper .tn{
  height:20px;
  line-height:20px;
  padding:5px 2px 5px 5px;
  margin:0 5px 10px;
  font-weight:bold;
  background:#f0f0f0;
  display: inline-block;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-24T15:57:03.027

我假设您正在谈论的 div 是#wrapper？#wrapper 没有扩展，因为您需要清除浮动

查看 HTML5 Boilerplate (https://github.com/h5bp/html5-boilerplate/blob/master/css/main.css) 中的 clearfix 类

```
.clearfix:before,
.clearfix:after {
    content: " "; /* 1 */
    display: table; /* 2 */
}

.clearfix:after {
    clear: both;
}

/*
 * For IE 6/7 only
 * Include this rule to trigger hasLayout and contain floats.
 */

.clearfix {
    *zoom: 1;
} 
```

所以在你的代码中这样做：

```
<div id="wrapper" class="clearfix">
    <div class="tn">Text</div>
    <div class="tn">Text</div>
    <div class="tn">Text</div>
</div> 
```

# php - Twitter 高手截断我的网址

> ID：14023161
> 
> 赞同：0
> 
> 时间：2012-12-24T15:33:53.717
> 
> 标签：php, utf-8, twitter, urlencode, utf8-decode

我想让用户可以在[**演示**](http://cruisear.com/test2.php)中发布他们喜欢的歌曲但是，当 url 包含土耳其字符时，Twitter 会从第一个土耳其字符之后拆分 url，就像图像 ![在此处输入图像描述](../Images/400f8eb26f657279de9d268627da1bf7.png)
上的 Url 必须是一样的`myurl.com/?view=s&artist=demet%20akıalın&track=ışık%20hğzmesi` ，但它在之后被剪切`demet ak`

我使用的代码在这里：

```
<?php
    define('APP_BASE_URL', 'http://www.myurl.com');
    header('Content-type: text/html; charset=UTF-8');
    $a['artistname'] = 'demet akıalın';
    $a['trackname'] = 'ışık hğzmesi';
?> 

<a target="_blank" title="Share on Twitter" href="https://twitter.com/share?hashtags=CruisEar&text=<?php echo $a['artistname']." - ".$a['trackname']; ?>&url=<?php echo urlencode(str_replace(" ","%20",APP_BASE_URL."?view=s&artist=".$a['artistname']."&track=".$a['trackname']));?>" data-url="https://dev.twitter.com" data-via="your_screen_name" data-lang="en"><img src="http://www.olmasigereken.com/demo2/img/twit.gif" alt="share on twitter" /></a> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-24T15:41:38.467

Twitter 做得对。根据 HTTP/1.1 规范，URL 不能包含非 ASCII 值，并且某些 ASCII 值需要进行百分比编码。

`ı`字符是非 ASCII 所以它必须是百分比编码的，就像你的空间必须变成`%20`

```
echo rawurlencode(utf8_encode(APP_BASE_URL.'?view=s&artist='.$a[artistname].'&track='.$a[trackname])); 
```

# java - 如何使用 Struts2 标签和 OGNL 比较两个字符串？

> ID：14023164
> 
> 赞同：6
> 
> 时间：2012-12-24T15:34:01.627
> 
> 标签：java, jsp, struts2, ognl, struts-tags

我正在尝试比较两个值：一个来自会话，另一个来自迭代器

```
<s:iterator value="themes" status="currentRecord"> 
    <s:if test="%{usertheme}) == %{themeName}">
        <td align="center" bgcolor="red">
    </s:if>
    <s:else>
        <td align="center" bgcolor="green">
    </s:else>
</s:iterator> 
```

但我无法比较我的价值观，请你告诉我我在哪里做错了吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-12-24T15:47:27.600

`%{}`应该（如有必要）放在所有语句的周围，而不是放在中间。

对于字符串，您应该使用`.equals`, `.equalsIgnoreCase`,`.contains`等`.indexOf`...不是`==`。

改成这样：

```
<s:iterator value="themes" status="currentRecord"> 
   <s:if test="%{#session.usertheme.equalsIgnoreCase(themeName)}">
      <td align="center" bgcolor="red">
   </s:if>
   <s:else>
      <td align="center" bgcolor="yellow">
   </s:else>
.... 
```

这也有效：

```
 <s:if test="#session.usertheme.equalsIgnoreCase(themeName)"> 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-12-24T20:04:30.447

*（不是答案，而是两个建议，我需要格式化；安德里亚的答案是正确的。）*

为了你自己和后面的人的理智，把这块 JSP 变成一行：

```
 <s:iterator value="themes">
    <tr>
      <s:set var="currTheme" value="%{userTheme == themeName ? 'red' : 'green'}"/>
      <td bgcolor="${currTheme}">Cell content</td>
    </tr>
  </s:iterator> 
```

考虑使用以主题命名的 CSS 而不是内联 CSS，并大致完全避免它：

```
td.theme1 {
  background-color: red;
}

td.theme2 {
  background-color: green;
}

td.theme3 {
  background-color: #daa520;
} 
```

^(*（假设主题名为“theme1”、“theme2”、“theme3”，但这不相关。）*)

```
<table class="themed-table">
  <s:iterator value="themes">
    <tr>
      <td class="${themeName}">Cell content</td>
    </tr>
  </s:iterator>
</table> 
```

将样式信息“向上”移动一个级别会更好，例如`table.theme1 td`，但是您明白了。这样做可以在主题信息的来源等方面提供很大的灵活性。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-07-19T08:58:37.987

```
 <!--name attribute inside select tag must be a variable in action class with getter/setter -->
<!-- test variable sets the value of selected item in action class -->
<select name="test">
    <!-- name attribute could be anything you want but value attribute must be a model class variable-->
    <s:set name="lead_string_LS_ID" value="MasterDataModel.string_LS_ID" />
        <!-- value attribute must be a list to iterate, status (an instanceof IteratorStatus will be pushed into stack upon each iteration)or result  -->
        <!-- var Name used to reference the value pushed into the Value Stack (my list contain leadSource_String_Id)-->
        <s:iterator value="leadSource_list" status="result" var="leadSource_String_Id">
                <!--#lead_string_LS_ID is value taken from <set> tag above. Note # must be in-front of the name
                    leadSource_String_Id is element specified in var of <iterator> tag  
                -->
                <s:if test='(#lead_string_LS_ID.equals(leadSource_String_Id))'>

                    <option value="<s:property value='leadSource_String_Id'/>" selected="selected">
                        <s:property value="leadSource_String_Name" />
                    </option>
                </s:if>
                <s:else>
                    <option
                        value="<s:property value='leadSource_String_Id'/>">
                        <s:property value="leadSource_String_Name" />
                    </option>
                </s:else>
        </s:iterator>
</select> 
```

# algorithm - “翻转”一个简单循环的输出，仅使用 +1/-1 而不使用 if/else

> ID：14023168
> 
> 赞同：1
> 
> 时间：2012-12-24T15:34:18.310
> 
> 标签：algorithm, loops, language-agnostic

假设我有以下输出整数的基本循环：

```
for (var i = 0; i < 6; i++) {
    echo i;
}

/* Output: 0 1 2 3 4 5 */ 
```

是否可以将其输出“翻转”为`5 4 3 2 1 0`使用一个简单的变量`flag`，其值只能是`1`or `-1`，而不使用`if/else`？

主要是在 JavaScript 中寻找答案，但这应该是一个与语言无关的问题。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-12-24T15:46:20.990

您可以将起点计算为`5 * (1 - flag) / 2`。您可以以类似的方式计算一个值以用于结束点的条件，但始终循环相同并从循环变量计算实际值更容易：

```
start = 5 * (1 - flag) / 2;
for (var i = 0; i < 6; i++) {
  echo start + i * flag;
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-24T15:49:38.097

您需要知道范围 N，因为您无法知道如何映射 0 -> 5

```
echo ((flag-1)/2)*(-N+1) + (flag*i) 
```

* * *

## 回答 #3

> 赞同：-4
> 
> 时间：2012-12-24T15:43:22.620

使用三元运算符（使用标志为真或假）：

```
var max_number = 5;
var min_number = 0;
var flag = true;

for(var i = (flag ? min_number : max_number);
    (flag ? i < max_number : i > min_number);
    (flag ? ++i : --i)){

    console.log(i);

} 
```

演示：http: [//jsfiddle.net/maniator/b26T8/](http://jsfiddle.net/maniator/b26T8/)

# image - Windows Phone 8，如何将图像转换为 .png？

> ID：14023169
> 
> 赞同：4
> 
> 时间：2012-12-24T15:34:19.510
> 
> 标签：image, image-manipulation, windows-phone-8

对于 Windows Phone 8（我假设它与 Windows 8 类似），如何将他们获得的任何图像转换为 .png？

例如，我得到一个 .jpeg 或 .gif 并将其转换为 .png。

也有兴趣将 .png 转换为 .jpeg。

在第三方应用程序之前，我更喜欢内置方法。

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-24T23:48:51.607

WP7/WP8 中没有内置功能可以将 JPG 转换为 PNG。

如果您只需要将 WriteableBitmap 保存为 JPEG，那么可以使用的一个很好的第 3 方框架是[ToolStack C# PNG Writer Library](http://toolstack.com/libraries/pngwriter)。

```
var myBitmap = new WriteableBitmap(tempBitmap);

// Create the destitnation stream.
var pngDest = new System.IO.IsolatedStorage.IsolatedStorageFileStream("test.png", FileMode.Create, isoStore);

// use the WriteableBitmap extension to write out the PNG
myBitmap.WritePNG(pngDest); 
```

如果您需要功能更全面的工具集（例如加载 JPG），请查看[WriteableBitmapEx](http://writeablebitmapex.codeplex.com/)和 Rene Schulte 撰写的这篇精彩文章 @Convert [, Encode and Decode Silverlight WriteableBitmap Data](http://kodierer.blogspot.com/2009/11/convert-encode-and-decode-silverlight.html)

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2015-01-29T14:45:10.963

要考虑的一件事是使用应用程序外部的程序来转换图像。

我用油漆或gimp。您可以免费下载 gimp，它是一个很好的程序。

这是一个开始的地方：

[http://www.gimp.org/](http://www.gimp.org/)

# jquery - jQuery Cycle 'destroy' 命令（和所有其他命令）被忽略

> ID：14023170
> 
> 赞同：4
> 
> 时间：2012-12-24T15:34:21.093
> 
> 标签：jquery, jquery-cycle

我遇到了 jQuery 循环的问题，只是忽略了所有命令（destory、stop 等）。这个页面上还有很多其他的事情，这可能是有贡献的，但我不确定有多少示例代码太多了。

简而言之，我有两个在页面加载时初始化的同时幻灯片，当单击“.video-trigger”时，应该销毁循环实例。但是在点击时，循环会继续循环（并掩盖应该替换它的视频）。

我已经尝试了我能想到的所有可能的情况来尝试找到源 - 删除所有其他 javascript（只剩下循环和销毁点击事件），只尝试调用和销毁两个幻灯片之一（而不是两者） ，在单独的包装器中调用它们。我什至删除了这两个循环实例，并在页面的完全不同部分制作了一个超级简单的“测试”循环和点击事件，而且那个也无法被破坏。不知道我错过了什么。

这里使用的另一个 jQuery 插件是 videojs，如果这很重要的话。

这是所有脚本，除了一个不相关的带有视频的花式框。如果包含所有内容会有所帮助，请告诉我，但我想我可能已经包含了太多内容。

```
jQuery(document).ready(function($){

    /// fading background images and video trigger
    $('#background-image-wrapper,#trigger-fade').cycle();

    // handle videos
    $('.video-trigger').click(function() {
        $('#background-image-wrapper,#trigger-fade').cycle('destroy');

        var vidName = $(this).attr('id');           
        var vidID = 'video_' + vidName;

        $('#background-image-wrapper').append('<div id="vid-cont" class="video-container"></div>');
        $('#vid-cont').append('<video id="' + vidID + '" class="video-js vjs-default-skin" preload="auto" data-setup="{}">' +
            '<source src="http://domain.com/wp-content/themes/sapporo/v/sapporo-'+ vidName +'.mp4" type="video/mp4">' +
            '<source src="http://domain.com/wp-content/themes/sapporo/v/sapporo-'+ vidName +'.ogv" type="video/ogg">' +
            '<source src="http://domain.com/wp-content/themes/sapporo/v/sapporo-'+ vidName +'.webm" type="video/webm">' +
            '</video>');

        //alert(vidID);
        _V_(vidID).ready(function(){
          var myPlayer = this;
          var aspectRatio = 9/16;
          function resizeVideoJS(){
              //var width = document.getElementById(myPlayer.id).parentElement.offsetWidth; // Get the parent element's actual width -- this wasn't working with lower versions of FF
              var width = document.getElementById('vid-cont').offsetWidth; // Get the parent element's actual width
              myPlayer.width(width).height( width * aspectRatio ); // Set width to fill parent element, Set height
          }
         resizeVideoJS(); // Initialize the function
         window.onresize = resizeVideoJS; // Call the function on resize

            $('#trigger-fade').fadeOut();
            $('#video-controls').fadeIn();
            $('.video-container').css('left', '0');
            myPlayer.volume(0);
            myPlayer.play(); //start playing the video
            var endedEvent = function(){ 
                $('#video-controls').fadeOut(function(){ $('#trigger-fade').fadeIn(); });
                $('.video-container').css('left', '-9999em'); 
                $('.background-image').fadeIn('slow'); 
            };
            myPlayer.addEvent("ended", endedEvent);

         $('#pause-video').click(function(){
            myPlayer.pause();
            $(this).fadeOut(function(){ $('#play-video').fadeIn(); });
         });
         $('#play-video').click(function(){
            myPlayer.play();
            $(this).fadeOut(function() { $('#pause-video').fadeIn(); });
         });
         $('#mute-video').click(function(){
            myPlayer.volume(0);
            $(this).fadeOut(function(){ $('#unmute-video').fadeIn(); });
         });
         $('#unmute-video').click(function(){
            myPlayer.volume(.7);
            $(this).fadeOut(function() { $('#mute-video').fadeIn(); });
         });
         $('#close-video').click(function(){
            myPlayer.pause();
            $('#video-controls').fadeOut(function(){ $('#trigger-fade').fadeIn(); });
            $('.video-container').css('left', '-9999em'); 
            $('.background-image').fadeIn('slow'); 
         });
       });
    });
   }); 
```

**更新**：我还没有更接近解决问题（无论我使用的是 Cycle 还是 Cycle2，它都会发生）。我已经实施了一个我不满意的解决方法（只是隐藏幻灯片，而在视频播放时它仍在运行）。但是我确实注意到，在自定义循环之后尝试在不同的单击事件上暂停相同的幻灯片放映时，当触发命令时，不遵循该命令，但是我之前为循环设置的所有自定义选项都被覆盖了。

即如果我开始：

```
 $('#background-image-wrapper,#trigger-fade').cycle({{timeout: 4000, speed: 7000}}); 
```

然后，在点击事件上使用它：

```
 $('#background-image-wrapper,#trigger-fade').cycle('destroy'); 
```

或者

```
 $('#background-image-wrapper,#trigger-fade').cycle('pause'); 
```

然后，它基本上只是启动一个新的 Cycle 实例，而不是破坏或暂停，就好像“破坏/暂停”不存在一样。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-06-03T18:35:41.580

我有同样的问题。'destroy' 命令似乎在这里被完全忽略：

[http://brianleatart-art.com/](http://brianleatart-art.com/)

我只希望一次运行一个幻灯片，但由于“销毁”命令不起作用，它会继续运行隐藏的幻灯片。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-09-06T09:03:35.630

我有一个类似的问题，对我来说，解决方案是将循环存储在一个变量中并调用这个变量来销毁它。像这样：

```
var mycycle = $('#background-image-wrapper,#trigger-fade').cycle();
...
mycycle.cycle('destroy'); 
```

不知道你是否还需要这个，但也许有人会。

# java - 我想我无法正确填充数组

> ID：14023171
> 
> 赞同：0
> 
> 时间：2012-12-24T15:34:25.823
> 
> 标签：java

我在格式化我的代码以提供正确的输出时遇到了一些麻烦。我是 Java 的初学者，所以我希望我犯了一些相当愚蠢的错误，但这里是这样。

我输入的文本文件是：

```
John Smith  90
Barack Obama    95
Al Clark    80
Sue Taylor  55
Ann Miller  75
George Bush 58
John Miller 65 
```

* * *

输出文件看起来有点像这样：

```
John Smith  90
Barack Obama    95
Al Clark    80
Sue Taylor  55
Ann Miller  75
George Bush 58
John Miller 65

Students with excellent grades:
John Smith  90
Barack Obama    95

Students with ok grades:
Al Clark    80
Ann Miller  75
John Miller 65

Students with failure grades:
Sue Taylor    55
George Bush  58

Lowest Grade: Sue Taylor 55 
Highest Grade: Barack Obama 95
Average of Grades: 74

Grades in descending order: 
John Smith 55 
Barack Obama    58 
Al Clark    65 
Sue Taylor  75 
Ann Miller  80 
George Bush 90 
John Miller 95 
```

* * *

我正在寻找的输出是这样的：

输出文件看起来有点像这样：

```
John Smith  90
Barack Obama 95
Al Clark 80
Sue Taylor   55
Ann Miller   75
George Bush  58
John Miller  65

Students with excellent grades:
John Smith  90
Barack Obama 95

Students with ok grades:
Al Clark   80
Ann Miller   75
John Miller  65

Students with failure grades:
Sue Taylor    55
George Bush  58

Lowest Grade: Sue Taylor 55
Highest Grade: Barack Obama 95
Average of Grades: 74

Grades in descending order: 
Barack Obama 95
John Smith 90
Al Clark 80
Ann Miller 75
John Miller 65
George Bush 58
Sue Taylor 55 
```

* * *

问题是：

1.  我需要打印姓名（名字和姓氏）以及最低和**最高**等级。

2.  成绩的降序显然是升序，所以需要固定。

3.  我还需要在最后有组织的降序列表中打印每个等级的名称（第一个和最后一个），现在这些名称与等级不匹配。

* * *

这是我的代码：

```
import java.util.Scanner;
import java.io.*;

public class Students
{
public static void main (String[] args) throws IOException
{   
    String first_name, last_name;
    int grade, total=0, count=0;
    int min, max;

    double average;

     int excellentTotal = 0;
     int okTotal = 0;
     int failureTotal = 0;

    Scanner fileInput = new Scanner(new File("students.txt"));
    Student st[] = new Student [100];
    while (fileInput.hasNext())
    {
        first_name = fileInput.next();
        last_name = fileInput.next();
        grade = fileInput.nextInt();    
        st[count] = new Student(first_name, last_name, grade);
        count++;
        total = total + grade; 
    }

    for (int i=0; i<count;i++)
    {
        System.out.println(st[i]);
    }

    System.out.println("\nStudents with excellent grades:");
    for (int i=0; i<count;i++)
    {
        if (st[i].grade > 89)
        {
            System.out.println(st[i]);
            excellentTotal += st[i].grade;
        }
    }

    System.out.println("\nStudents with ok grades:");
    for (int i=0; i<count;i++)
    {
        if (st[i].grade >=60 && st[i].grade <=89)
        {
            System.out.println(st[i]);
            okTotal += st[i].grade;
        }
    }

    System.out.println("\nStudents with failure grades:");
    for (int i=0; i<count;i++)
    {
        if (st[i].grade < 60)
        {
            System.out.println(st[i]);
            failureTotal += st[i].grade;
        }
    }       

    min = st[0].getGrade();
    max = st[0].getGrade();
    for (int i = 0; i < count; i++) 
    {
        if (max.grade < st[i].grade)
        {
            max = st[i];
        }
        if (min.st[i] > st[i].grade)
        {
            min = st[i].grade;
        }
        total = excellentTotal + okTotal + failureTotal;
    }

    System.out.println();
    System.out.println("Lowest Grade: " + min);
    System.out.println("Highest Grade: " + max);
    System.out.println("Average of Grades: " + total/count);

    int t, swap = 0;
    do 
    { 
        swap = 0; 
        for (int i=0; i<count-1; i++) 
        {
            if (st[i].getGrade()>st[i+1].getGrade()) 
            {
                t=st[i].grade; 
                st[i].grade=st[i+1].grade; 
                st[i+1].grade=t; 
                swap++;
            }
        } 
    }
    while (swap>0);

    System.out.println("\nGrades in descending order: ");

    for (int i=0; i<count;i++)
    {
         System.out.print (st[i] + " ");
         System.out.println ();
    }
}
static class Student
{
    private String fname, lname;
    private int grade;

    public Student(String fname, String lname, int grade)
    {
        this.fname = fname;
        this.lname = lname;
        this.grade = grade;
    }

    public int getGrade() 
    {
        return grade;
    }

    public void setGrade(int grade) 
    {
        this.grade = grade;
    }

    public String toString()
    {
        return fname + " " + lname + "\t" + grade;
    }

}
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-24T15:50:16.177

> 问题是：
> 
> 1.  我需要打印姓名（名字和姓氏）以及最低和最高等级。

保留两个`Strings`，每个都包含具有最低和最高等级的人的姓名，就像你对实际的最小值和最大值所做的那样。

> 1.  成绩的降序显然是升序，所以需要固定。

看起来您已经对数组进行了排序，使其按升序排列（顺便说一句，`Arrays.sort()`如果允许的话，请查看），所以不要从前到后打印它，为什么不从最后开始打印它你的阵列？这应该按降序打印。

> 1.  我还需要在最后有组织的降序列表中打印每个等级的名称（第一个和最后一个）。

您的成绩与正确的人不匹配，因为您正在切换数组中每个人的成绩，而不是切换数组中的人。

看这里：

```
t=st[i].grade; 
st[i].grade=st[i+1].grade; 
st[i+1].grade=t; 
```

假设您有两个人 Bob 和 Sam，他们的成绩分别为 50 和 75。

它们在数组中：`[Bob(50)][Sam(75)]`

使用上面的代码交换它们，你最终会得到：`[Bob(75)][Sam(50)]`

解决此问题的更改是微不足道的。我会留给你弄清楚。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-24T16:09:43.213

好吧，我会做一个快速而肮脏的例子：

```
import java.util.ArrayList;
import java.util.Collections;
import java.util.Comparator;
import java.util.List;

public class Students {

List<Student> students = new ArrayList<Student>();

public Students() {
    // create quick list, no reading from file, don't use arrays if you can help it
    students.add(new Student("a", 1));
    students.add(new Student("b", 2));
    students.add(new Student("c", 3));

    // sort list descending
    Collections.sort(students, new Comparator<Student>() {
        @Override
        public int compare(Student student1, Student student2) {
            return -1 * student1.grade.compareTo(student2.grade);
        }
    });
}

public void showDescending() {
    // just so the list that was sorted descending
    System.out.println(students);
}

public void showForRange(Integer minGrade, Integer maxGrade) {
    // show all students with grades between minGrade and maxGrade
    for (Student s : students) {
        if (s.grade >= minGrade && s.grade <= maxGrade) {
            System.out.println(s);
        }
    }
}

public class Student {
    String name;
    Integer grade;

    public Student(String name, Integer grade) {
        this.name = name;
        this.grade = grade;
    }

    // use toString to easily show name with grade for each student in list
    @Override
    public String toString() {
        return name + " " + grade;
    }

}

public static void main(String[] args) {
    Students s = new Students();
    s.showForRange(100, 90);
    s.showForRange(89, 80);
    s.showDescending();

}

} 
```

# android - 不允许使用整数类型（在“showAsAction”处，值为“0x0”）

> ID：14023173
> 
> 赞同：1
> 
> 时间：2012-12-24T15:34:36.593
> 
> 标签：android, eclipse, reverse-engineering

我使用eclipse构建了一个android应用程序。我最近错误地删除了项目。但是我有该项目的apk文件。所以我使用apktool，dex2jar和java调试器来获取我的应用程序的源代码，但是现在当我在eclipse中导入应用程序并尝试运行它，我得到这些错误：

```
[2012-12-24 20:30:54 - loser] W/ResourceType( 2328): Bad XML block: header size 78 or total size 0 is larger than data size 0
[2012-12-24 20:30:54 - loser] C:\Users\itz_n_000\workspace\loser\res\values-v14\styles.xml:1: error: Error parsing XML: no element found
[2012-12-24 20:30:54 - loser] C:\Users\itz_n_000\workspace\loser\res\menu\main.xml:4: error: Error: Integer types not allowed (at 'showAsAction' with value '0x0').
[2012-12-24 20:35:54 - loser] W/ResourceType( 3520): Bad XML block: header size 100 or total size 0 is larger than data size 0
[2012-12-24 20:35:54 - loser] C:\Users\itz_n_000\workspace\loser\res\values-v14\styles.xml:1: error: Error parsing XML: no element found
[2012-12-24 20:35:54 - loser] C:\Users\itz_n_000\workspace\loser\res\menu\main.xml:4: error: Error: Integer types not allowed (at 'showAsAction' with value '0x0').
[2012-12-24 20:43:13 - loser] W/ResourceType( 2376): Bad XML block: header size 100 or total size 0 is larger than data size 0
[2012-12-24 20:43:13 - loser] C:\Users\itz_n_000\workspace\loser\res\values-v14\styles.xml:1: error: Error parsing XML: no element found
[2012-12-24 20:43:13 - loser] C:\Users\itz_n_000\workspace\loser\res\menu\main.xml:4: error: Error: Integer types not allowed (at 'showAsAction' with value '0x0').
[2012-12-24 20:45:55 - loser] W/ResourceType( 3740): Bad XML block: header size 78 or total size 0 is larger than data size 0
[2012-12-24 20:45:55 - loser] C:\Users\itz_n_000\workspace\loser\res\values-v14\styles.xml:1: error: Error parsing XML: no element found
[2012-12-24 20:45:55 - loser] C:\Users\itz_n_000\workspace\loser\res\menu\main.xml:4: error: Error: Integer types not allowed (at 'showAsAction' with value '0x0').
[2012-12-24 20:50:49 - loser] W/ResourceType( 3916): Bad XML block: header size 94 or total size 7002568 is larger than data size 0
[2012-12-24 20:50:49 - loser] C:\Users\itz_n_000\workspace\loser\res\values-v14\styles.xml:1: error: Error parsing XML: no element found
[2012-12-24 20:50:49 - loser] C:\Users\itz_n_000\workspace\loser\res\menu\main.xml:4: error: Error: Integer types not allowed (at 'showAsAction' with value '0x0').
[2012-12-24 20:50:56 - loser] W/ResourceType( 2780): Bad XML block: header size 96 or total size 7129120 is larger than data size 0
[2012-12-24 20:50:56 - loser] C:\Users\itz_n_000\workspace\loser\res\values-v14\styles.xml:1: error: Error parsing XML: no element found
[2012-12-24 20:50:56 - loser] C:\Users\itz_n_000\workspace\loser\res\menu\main.xml:4: error: Error: Integer types not allowed (at 'showAsAction' with value '0x0'). 
```

请帮忙。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-08-23T11:04:48.397

使用以下映射：

```
 <!-- How this item should display in the Action Bar, if present. -->
    <attr name="showAsAction">
        <!-- Never show this item in an action bar, show it in the overflow menu instead.
             Mutually exclusive with "ifRoom" and "always". -->
        <flag name="never" value="0" />
        <!-- Show this item in an action bar if there is room for it as determined
             by the system. Favor this option over "always" where possible.
             Mutually exclusive with "never" and "always". -->
        <flag name="ifRoom" value="1" />
        <!-- Always show this item in an actionbar, even if it would override
             the system's limits of how much stuff to put there. This may make
             your action bar look bad on some screens. In most cases you should
             use "ifRoom" instead. Mutually exclusive with "ifRoom" and "never". -->
        <flag name="always" value="2" />
        <!-- When this item is shown as an action in the action bar, show a text
             label with it even if it has an icon representation. -->
        <flag name="withText" value="4" />
        <!-- This item's action view collapses to a normal menu
             item. When expanded, the action view takes over a
             larger segment of its container. -->
        <flag name="collapseActionView" value="8" />
    </attr> 
```

# increment - 算法，递减和递增 [-100, 100]

> ID：14023175
> 
> 赞同：0
> 
> 时间：2012-12-24T15:34:42.827
> 
> 标签：increment, decrement

我正在尝试创建一个循环并递减，递增一个 int。

```
int val = 0;

while(true){
   if(val < -100) val += 1;
   else val -= 1;

   myFunction(val);
} 
```

这是一个无限循环，我知道，但我需要在 (-100, 100) 之间向 myFunction 发送一个值；

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-24T15:44:02.950

这将解决我认为的伎俩......

```
int val = 0;
int increment = 1;

while(true){
   val += increment;

   if(val < -100){
     increment = 1;
   }
   else if(val > 100){
     increment = -1;
   }

   myFunction(val);
} 
```

它从 0 开始并递增直到达到 100……然后开始递减直到达到 -100……当它再次开始递增时。

如果您需要从 0 开始并递减，只需将增量变量的初始值更改为 -1 而不是 1。初始值相同...在 -100 和 100 之间根据需要设置它。

# c# - 使用 LINQ 进行简单的 XML 解析

> ID：14023176
> 
> 赞同：1
> 
> 时间：2012-12-24T15:34:45.580
> 
> 标签：c#, xml, linq, xml-parsing

我想解析这个 XML：

```
<?xml version="1.0" encoding="Windows-1252" ?>
<TEST>Login inexistant</TEST> 
```

我写了这段代码

```
var result  = from item in XElement.Parse(m_strRetour).Descendants("TEST")
              select item;
return result.First().ToString(); 
```

m_strRetour 是一个包含我的 XML 的字符串。

执行后，结果为空。

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-24T15:40:16.757

`XElement.Parse`将返回`TEST`元素本身 - 它没有任何后代。（此外，在这里使用查询表达式*没有任何*`from x in y select x`好处。无论何时编写，您都应该考虑是否不能只使用`y`...）

您可以将其解析为一个`XDocument`，在这种情况下会有*一个*后代`TEST`......或者您可以只使用它`XElement`本身。

你真正想要达到什么目的？您*真正的*XML 是否只有一个元素？

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-24T15:40:24.777

`TEST`似乎是你的根节点，所以它不能是`Descendant`.

要从中获得价值，您可以试试这个。

```
var xml = "<?xml version='1.0' encoding='Windows-1252' ?><TEST>Login inexistant</TEST>";

var result  = XElement.Parse(xml);
var value = result.Value; 
```

# android - Android ClassNotFoundException 及依赖项目

> ID：14023177
> 
> 赞同：1
> 
> 时间：2012-12-24T15:34:57.957
> 
> 标签：android, classnotfoundexception

我们有工作的 android 应用程序，它于 04.2012 发布在 Google Play 中。我们几个月都没有碰它。

12 月，我们决定进行圣诞节更新。然而，写这个项目的程序员在九月份离开了我们，所以我们不得不从存储库下载他的代码。事实证明，该存储库版本缺少我们的应用程序所依赖的 2 个项目，因此我们必须从 Web 下载它们（它们是开源项目）并添加为 denendent 项目（项目属性 -> android ->“库”部分->添加）。

我们做了几个小改动，一切正常，没有任何问题。

但！在某些时候出了点问题：

当项目的调试版本（使用调试密钥签名）安装到设备（真实设备，而不是模拟器）上时，它可以工作；

当项目的发布版本（使用发布密钥签名）安装到设备上时，它在启动时崩溃。错误：

> java.lang.RuntimeException：无法实例化活动 ComponentInfo{packageName/packageName.MainActivity}：java.lang.ClassNotFoundException：在路径上找不到类“packageName.MainActivity”：/data/app/packageName-1.apk

我们如何解决这个问题：我们改变了将这 2 个开源项目（上面提到的）添加到我们的应用程序的方式。特别是，我们删除了项目依赖并添加了 jar-files 依赖。所以它开始工作了。我无法理解将这些用作图书馆项目有什么问题。为什么它只有在我们添加 jar 文件后才开始工作？可能有人可以帮助理解它。

# c# - EPPlus LoadFromDataTable 错误

> ID：14023178
> 
> 赞同：3
> 
> 时间：2012-12-24T15:35:10.577
> 
> 标签：c#, vb.net, excel, epplus

我从 EPPlus 那里得到了最奇怪的错误，想知道是否有其他人得到了这个/找到了解决方法......

如果我使用以下代码，一切都会很好：

```
wks.Cells(2, 20).LoadFromDataTable(dtFXData, True) 
```

但是当我把它改成这样时：

```
wks.Cells(2, 26).LoadFromDataTable(dtFXData, True) 
```

我得到一个`ArgumentOutOfRangeException** - Specified argument was out of the range of valid values. Parameter name: Start cell Address must be less or equal to End cell address`

我正在使用 EPPlus 版本 3.1.2。

任何想法/帮助？？？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-03-17T20:46:59.657

我有同样的问题，我解决了它支持 EPPLUS 3.0 版... EPPlus 3.0.0.2 2012 年 1 月 31 日，稳定

请参阅本论坛的结尾：[https ://epplus.codeplex.com/discussions/407120](https://epplus.codeplex.com/discussions/407120)

祝你好运！

# html - 如何使用css组合到表单中的文本框？

> ID：14023183
> 
> 赞同：-3
> 
> 时间：2012-12-24T15:35:51.173
> 
> 标签：html, css, forms, input, textinput

[如何使用 tumblr https://www.tumblr.com/login](https://www.tumblr.com/login)上的 css 以表单形式组合到文本框， 如果 css 无法完成，那该怎么做？请在这件事上给予我帮助

我想让登录表单看起来更好，所以我想组合用户名和密码框的输入框，就像这个[链接一样](https://www.tumblr.com/login)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-24T16:33:33.547

右键单击该登录页面，然后单击查看源代码并将其复制到记事本中并另存为 html 文件。他们在单个页面中实现了多项操作，例如注册、密码帮助等。所以你只需要找到登录部分并删除其余部分。只需保留以下样式表。您可以根据需要更改这些文件，

```
<link rel="stylesheet" type="text/css" href="https://secure.assets.tumblr.com/stylesheets/compressed/global.css?cb1e8b42147f30c2e13d62135690991a"><link rel="stylesheet" type="text/css" href="https://secure.assets.tumblr.com/stylesheets/compressed/onboarding.css?1adfaf6588f389f7567dae907f646280"><link rel="stylesheet" type="text/css" href="https://secure.assets.tumblr.com/stylesheets/compressed/dashboard.css?bccedfaa1a01c28c280ee47200935a38"><link rel="stylesheet" type="text/css" href="https://secure.assets.tumblr.com/stylesheets/compressed/hello_tags.css?17d5a86bd54c60a37ef98400e6b86b4c"><link rel="stylesheet" type="text/css" href="https://secure.assets.tumblr.com/stylesheets/compressed/notification_new.css?9003193efe4adc94a3d8c85421fa6403"> 
```

一旦你有了 html 中的登录部分，你就可以拥有与 Tumblr 登录相同的登录页面。

# c# - 创建操纵 head 标签的 Handler

> ID：14023188
> 
> 赞同：2
> 
> 时间：2012-12-24T15:36:47.720
> 
> 标签：c#, asp.net

有没有办法创建一个实时更改头部标签内容的处理程序？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-24T15:49:04.643

您可以`HtmlGenericControl Server Control`用于此目的。

**HtmlGenericControl 服务器控件** 创建一个服务器端控件，该控件映射到不由特定 .NET Framework 类表示的 HTML 元素，例如 `<body> and <div>`.

试试下面的一个。

```
var h1 = new HtmlGenericControl("h1");
h1.InnerHtml = "Your header content"; 
```

有关更多信息，请查看[**HtmlGenericControl 服务器控制声明性语法**](http://msdn.microsoft.com/en-us/library/7512d0d0%28v=vs.100%29.aspx)

我希望这对你有帮助。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-24T16:07:56.493

您可以创建自定义 HTTP 模块：

[http://msdn.microsoft.com/en-us/library/ms227673.aspx](http://msdn.microsoft.com/en-us/library/ms227673.aspx)

下面是一个如何将脚本添加到每个页面头部的示例：

[How2：在 HttpModule 中挂钩什么事件以将 js 链接放入 head 元素](https://stackoverflow.com/questions/792851/how2-what-event-to-hook-in-httpmodule-for-putting-js-links-into-head-element)

# jquery - 如果给定-1 z-index来创建box-shadow，如何使图像可点击？

> ID：14023195
> 
> 赞同：1
> 
> 时间：2012-12-24T15:37:17.243
> 
> 标签：jquery, html, css

我的帖子包含使用 Css3 的带有框阴影的图像。为 img 标签创建 -1 的 box shadow z-index。但问题是图像不可点击。由于图像被赋予了href标签，如何在保持Box-shadow的同时创建可点击的图像？

我的 CSS：

```
.postimage {
width:100%;
height:250px;
margin:10px 0px 20px 0px;
z-index:12; box-shadow: inset 2px 2px 10px rgba(0,0,0,0.9);
}
.postimage img{
position:relative;
z-index:-1;
} 
```

我的HTML：

```
<div class="postimage">
    <a href="http://www.google.com"><img src="images/bg.jpeg" /></a>
</div> 
```

不使用 -1 z-index 图像变得可点击，但 css3 框阴影不起作用。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-24T15:44:03.800

```
$('.postimage').on('click', function() {
    var newURL = $('a', this).prop('href');
    window.location = newURL ;
}); 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-12-24T15:48:06.637

您可以通过设置使元素对鼠标事件透明（因此单击将通过）

```
pointer-events: none; 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-12-24T15:44:06.670

更改`z-index:-1;`为`z-index:1;`

# php - 如何在条件下使用 ARRAY 查询 mysql

> ID：14023204
> 
> 赞同：1
> 
> 时间：2012-12-24T15:37:52.443
> 
> 标签：php, mysql

A 在数组中有行的名称

```
$arr = array(fir, seco, third); 
```

我怎样才能像这样查询mysql：

```
$query = "SELECT * FROM $table where fir=0 and seco=0 and third=0"; 
```

但使用数组。

和

```
$query = "update $table SET fir='$ma', seco='$ma', third='$ma'"; 
```

但使用数组。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-24T15:40:31.320

对于搜索，您可以在以下查询中触发 -

```
$str = implode(",", $arr);
$query = "SELECT * FROM $table where 0 IN ($str)"; 
```

但是对于更新，您必须使用查询您所写的内容。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-24T15:40:49.603

简单的，

```
$arr = array(fir, seco, third);

for(int i = 0;i<arr.lenght;i++)
{
$query = $query + " and "  + arr[i] + "=" + $ma;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-24T15:43:24.157

这就是我会做的...

```
$fir = $arr[0];
$seco = $arr[1];
$third = $arr[2];
$query = "UPDATE $table SET $fir = '$ma', $seco = '$ma', $third = '$ma'"; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-24T15:47:23.017

不确定是否有更优化的答案，但您可以使用 for 循环来创建 SQL 语句：

```
<?php
$arr = array(fir, seco, third);

$query = "SELECT * FROM $table where ";
$count = count($arr);
for($i=0;$i<$count;$i++){
  $query .= ($i==$count-1) ? "$arr[$i]=0" : "$arr[$i]=0 and ";
}

echo $query;
?> 
```

回声`SELECT * FROM $table where fir=0 and seco=0 and third=0`。您可以对`UPDATE`SQL 语句执行相同的操作。

## 更新

此外，您可以像在 Suresh Kamrushi 的回答中一样内爆数组，并使用以下代码：

```
<?php
    $arr = array(fir, seco, third);
    $str = implode(',',$arr);
    $query_one = "SELECT * FROM $table WHERE ($str) = (0,0,0)";
    echo $query_one;
?> 
```

我认为 UPDATE 查询仍然需要一个 for 循环。

# css - 使用 div 定义 CSS 属性

> ID：14023208
> 
> 赞同：0
> 
> 时间：2012-12-24T15:38:02.013
> 
> 标签：css

我正在尝试根据它们所在的 DIV 分隔两个表的 CSS 属性。如果您查看[http://jsfiddle.net/jdb1991/tpXKT/](http://jsfiddle.net/jdb1991/tpXKT/)，您会看到“resultA”中的表正在使用 TD 属性为“结果B”定义。

我知道这是由于属性的“级联”而应用的，但是如果我使用了#resultB 选择器，为什么还要包含它？或者这是无效的？

为了 Stack 的幸福：

```
#resultA table {border-collapse: collapse}
#resultA table th, td {border: 1px solid black}
#resultA table td {background-color: blue}

#resultB table {border-collapse: collapse}
#resultB table th, td {border: 5px solid black}
#resultB table td {background-color: red}

<div id="resultA">
    <table>
        <tr>
            <th>Result</th>
        </tr>
        <tr>
            <td>11.5</td>
        </tr>
    </table>
</div> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-24T15:41:08.170

这是因为你自己定义`td`了两次。也就是说，选择器`#resultB table th`在此处结束，当您使用逗号包含时，`td`您只是将其定义`td`为独立元素。你需要做： `#resultA table th, #resultA table td`并`#resultA table th, #resultA table td`为每一个获得不同的风格。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-24T15:41:21.560

CSS 中的逗号分隔选择器，并且它们之间没有任何关系。因此，自从规则`#resultB table th, td`出现后被`#resultA table th, td`最后`td`一条规则覆盖，因为它出现在最后。您可能想要这样做：

```
#resultB table th, #resultB table td {border: 5px solid black} 
```

通过专门定义规则的路径，您可以确保它不会应用于其他元素。

**[jsFiddle 示例](http://jsfiddle.net/j08691/tpXKT/1/)**

# objective-c - 将上传的视频保存到托管在 Web 服务器上的文件系统

> ID：14023211
> 
> 赞同：1
> 
> 时间：2012-12-24T15:38:49.803
> 
> 标签：objective-c, asp.net-mvc, xcode, file-upload

在 iphone 移动应用程序中，当允许用户上传视频时，应用程序会将视频保存在文件系统中，并将名称保存在数据库中。我的问题是我将/如何在移动应用程序的网站版本上访问该视频。如果可能的话，我想避免使用任何网络服务或 wcf。

在步骤格式中：

```
 1\. On iPhone app, user uploads video from photo library.
  2\. That video is then saved to file system and name is stored in database.
  3\. (?)User can then go online to website version of the app and see his/her videos that   he/she had uploaded from their iPhone.(?) 
```

如何访问文件系统？bc不是'应用程序中的本地文件系统吗？我打算通过 mvc app c# 访问它

# video - 如何在视频中使用引导缩略图？

> ID：14023212
> 
> 赞同：2
> 
> 时间：2012-12-24T15:38:54.150
> 
> 标签：video, twitter-bootstrap, thumbnails

我使用引导缩略图。但我想添加视频元素而不是图像。但我不能

## 我的代码是：

```
<ul class="thumbnails">
          <li class="span4">
            <div class="thumbnail">
              <video data-src="holder.js/300x200" src="http://www.youtube.com/watch?v=jOaOjN-rsIM">
              <div class="caption">
                <h3>Thumbnail label</h3>
                <p>Cras justo odio, dapibus ac facilisis in, egestas eget quam. Donec id elit non mi porta gravida at eget metus. Nullam id dolor id nibh ultricies vehicula ut id elit.</p>
                <hr>
                <p><a href="#" class="btn btn-primary">Action</a> <a href="#" class="btn">Action</a></p>
              </div>
            </div>
          </li></ul> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2014-02-21T20:46:51.367

尝试使用带有 youtube 嵌入代码的 iframe 作为源。我假设您也希望它具有响应性，因此我也添加了带有“flex-video”类的 div。这是一个[Bootply 项目](http://www.bootply.com/115837)的链接，如果你需要，它应该可以帮助你。

HTML：

 ****```
 <ul class="thumbnails">
          <li class="span4">
            <div class="thumbnail">

                <div class="flex-video widescreen ">
                  <iframe class="" src="//www.youtube.com/embed/8wqtwkmsBvc" frameborder="0"></iframe>
                </div>   

              <div class="caption">
                <h3>Thumbnail label</h3>
                <p>Cras justo odio, dapibus ac facilisis in, egestas eget quam. Donec id elit non mi porta gravida at eget metus. Nullam id dolor id nibh ultricies vehicula ut id elit.</p>
                <p><a href="#" class="btn btn-primary">Action</a> <a href="#" class="btn">Action</a></p>
              </div>
            </div>
          </li>

        </ul> 
```**  **CSS（用于响应式视频）：

```
 .flex-video {
          position: relative;
          padding-top: 25px;
          padding-bottom: 67.5%;
          height: 0;
          margin-bottom: 16px;
          overflow: hidden;
           }

          .flex-video.widescreen { padding-bottom: 57.25%; }
          .flex-video.vimeo { padding-top: 0; }

          .flex-video iframe,
          .flex-video object,
          .flex-video embed {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
          }

 @media only screen and (max-device-width: 800px),  
 only screen and (device-width:1024px) and (device-height: 600px), only screen 

 and (width: 1280px) and (orientation: landscape), only screen 

 and (device-width: 800px), only screen and (max-width: 767px) {

 .flex-video { padding-top: 0; }
   } 
```****

# java - 非服务类的 Spring AOP

> ID：14023220
> 
> 赞同：1
> 
> 时间：2012-12-24T15:39:33.747
> 
> 标签：java, spring, cxf, aop, spring-aop

我是 Spring 框架的初学者。我已经实现了 Spring AOP 来记录方法执行时间。使用来自互联网的一些示例，我得到它适用于如下指定的服务接口。**但是，如果我将表达式**更改为非服务类，则相同的代码不起作用。下面给出了CXF配置。

```
<bean id="xbean" class="com........xServiceImpl" />

<jaxrs:server id="xServiceRS" address="/xRSService">
    <jaxrs:serviceBeans>
        <ref bean="xbean" />
    </jaxrs:serviceBeans>
</jaxrs:server>

<bean id="performanceLoggingAdvice" class="com......PerformanceLoggingAdvice" />

<aop:config>
    <aop:pointcut id="performanceLoggingPointcut"
        expression="execution(* com.....xService.*(..))" />
    <aop:advisor advice-ref="performanceLoggingAdvice"
        pointcut-ref="performanceLoggingPointcut" id="performanceLoggingInterceptorAdvisor" />
</aop:config> 
```

我已经在堆栈溢出中搜索了类似的问题，但我没有得到对我的问题有用且具体的答案。知道可能是什么问题吗？如何让它适用于非服务类，例如 Utils.java ？

预先感谢您帮助我..

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-24T17:14:31.693

Spring AOP 建议仅应用于声明为 Spring bean 的类的实例。让你的`Util`类成为一个 Spring bean，使用正确的切入点，它应该可以工作。

在这种情况下，您应该`Util`仅通过 Spring 应用程序上下文（通过调用其中一种`ApplicationContext.getBean`方法）来获取实例，而不是通过使用`new`.

# php - php中的电子邮件表单，无需打开电子邮件客户端

> ID：14023221
> 
> 赞同：0
> 
> 时间：2012-12-24T15:39:42.567
> 
> 标签：php, html

我正在尝试使我的电子邮件表单正常工作，但它没有。我找到了一个现成的`fromtoemail.php`文件，并用我的替换了变量。我尝试了一些我发现的在线代码，但每个人都给了我同样的错误。我收到错误，它跟踪的第一个字段发现它为空，我从我的代码中收到错误消息，而不是在所有循环中移动。我在第一行用 if 得到错误

```
if($author == '') {print "You have not entered an author, please go back and try again";} 
```

这是来自 php 和来自我的 html 的代码。

PHP：

```
<?php 
 $to = $_REQUEST['myemail@gmail.com'] ; 
 $author = $_REQUEST['author'] ; 
 $email = $_REQUEST['email'] ; 
 $subject = $_REQUEST['subject'] ;
 $text = $_REQUEST['text'] ;
 $headers = "From: $from"; 
 $subject = "$subject"; 

 $fields = array(); 
 $fields{"author"} = "author"; 
 $fields{"email"} = "email"; 
 $fields{"subject"} = "subject"; 
 $fields{"text"} = "text"; 

 $body = "We have received the following information:\n\n"; foreach($fields as $a => $b){   $body .= sprintf("%20s: %s\n",$b,$_REQUEST[$a]); } 

 $headers2 = "$email"; 
 $subject2 = "Thank you for contacting us"; 
 $autoreply = "Thank you for contacting us. Somebody will get back to you as soon as possible, usualy within 48 hours. If you have any more questions, please consult our website at www.oursite.com";

 if($author == '') {print "You have not entered an author, please go back and try again";} 
 else { 
 if($email == '') {print "You have not entered a email, please go back and try again";} 
 else { 
 if($subject == '') {print "You have not entered a subject, please go back and try again";} 
 else { 
 $send = mail($to, $subject, $body, $headers); 
 $send2 = mail($email, $subject2, $autoreply, $headers2); 
 if($submit) 
 {header( "Location: http://www.sofisarti.com/index-english.html" );} 
 else 
 {print "We encountered an error sending your mail, please notify webmaster@YourCompany.com"; } 
 }
 }
 }
 ?> 
```

html:

```
 <form action="formtoemail.php" method="post" enctype="text/plain">
                            <p>
                                <label for="author">Name:</label> 
                                <input type="text" id="author" name="author" class="required input_field" />
                            </p>
                            <p>
                                <label for="email">Email:</label> 
                                <input type="text" id="email" name="email" class="validate-email required input_field" />
                            </p>
                            <p class="no_margin_right">
                                <label for="subject">Subject:</label> 
                                <input type="text" name="subject" id="subject" class="input_field" />
                            </p>
                            <div class="cleaner h20"></div>

                            <label for="text">Message:</label> 
                            <textarea id="text" name="text" rows="0" cols="0" class="required"></textarea>
                            <div class="cleaner h20"></div>

                            <input type="submit" value="Send" id="submit" name="submit" class="submit_btn float_l" />
                            <input type="reset" value="Reset" id="reset" name="reset" class="submit_btn float_r" />
                      </form> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-24T16:05:37.023

我推荐这种形式的验证方式。这应该使事情**更清楚**，您将能够**一次显示所有错误消息**。

```
<?php 

$Author = $_POST['author'];
$Message = $_POST['text'];

$Errors = array();

if (strlen($Author) < 3){
    $Errors[] = 'Please enter your full name';
}

if (strlen($Message) < 10){
    $Errors[] = 'Please describe your message in more detail.';
}

// Add if- conditions for email, subject, etc..

if (!empty($Errors)){

    $Errorbody = '<ul>';
    foreach ($Errors as $Error){
        $Errorbody .= '<li>'.$Error.'</li>';    
    }
    $Errorbody .= '</ul>';
} else {
    // the rest of the stuff, sending email, header towards thank-you page.
}
?>

[HTML HEADER ETC]
<?php 
if (isset($Errorbody)){
    echo $Errorbody;
}
?>

[HTML FORM HERE] 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-24T16:11:22.407

这是我的教学示例，展示了表单到电子邮件脚本的基本部分。希望它可以帮助您解决问题。最好的，~雷

```
<?php // RAY_form_to_email.php
error_reporting(E_ALL);

// SEND MAIL FROM A FORM

// REQUIRED VALUES ARE PREPOPULATED - CHANGE THESE FOR YOUR WORK
$from  = "NoReply@Your.org";
$subj  = "Contact Form";

// THIS IS AN ARRAY OF RECIPIENTS - CHANGE THESE FOR YOUR WORK
$to[]  = "You@Your.org";
$to[]  = "Her@Your.org";
$to[]  = "Him@Your.org";

// IF THE DATA HAS BEEN POSTED
if (!empty($_POST['email']))
{
    // CLEAN UP THE POTENTIALLY BAD AND DANGEROUS DATA
    $email      = clean_string($_POST["email"]);
    $name       = clean_string($_POST["name"]);
    $telephone  = clean_string($_POST["telephone"]);

    // CONSTRUCT THE MESSAGE THROUGH STRING CONCATENATION
    $content    = NULL;
    $content   .= "You have a New Query From $name" . PHP_EOL . PHP_EOL;
    $content   .= "Tel No: $telephone" . PHP_EOL;
    $content   .= "Email: $email" . PHP_EOL;

    // SEND MAIL TO EACH RECIPIENT
    foreach ($to as $recipient)
    {
        if (!mail( $recipient, $subj, $content, "From: $from\r\n"))
        {
            echo "MAIL FAILED FOR $recipient";
        }
        else
        {
            echo "MAIL WORKED FOR $recipient";
        }
    }

    // PRODUCE THE THANK-YOU PAGE
    echo '<p>THANK YOU</p>' . PHP_EOL;
}

// A FORM TO TAKE CLIENT INPUT FOR THIS SCRIPT
$form = <<<ENDFORM
<form method="post">
Please enter your contact information
<br/>Email: <input name="email" />
<br/>Phone: <input name="telephone" />
<br/>Name:  <input name="name" />
<br/><input type="submit" />
</form>
ENDFORM;

echo $form;

// A FUNCTION TO CLEAN UP THE DATA - AVOID BECOMING AN OPEN-RELAY FOR SPAM
function clean_string($str)
{
    // IF MAGIC QUOTES IS ON, WE NEED TO REMOVE SLASHES
    $str = stripslashes($str);

    // REMOVE EXCESS WHITESPACE
    $rgx
    = '#'                // REGEX DELIMITER
    . '\s'               // MATCH THE WHITESPACE CHARACTER(S)
    . '\s+'              // MORE THAN ONE CONTIGUOUS INSTANCE OF WHITESPACE
    . '#'                // REGEX DELIMITER
    ;
    $str = preg_replace($rgx, ' ', $str);

    // REMOVE UNWANTED CHARACTERS
    $rgx
    = '#'                // REGEX DELIMITER
    . '['                // START OF A CHARACTER CLASS
    . '^'                // NEGATION - MATCH NONE OF THE CHARACTERS IN THIS CLASS
    . 'A-Z0-9'           // KEEP LETTERS AND NUMBERS
    . '"'                // KEEP DOUBLE QUOTES
    . "'"                // KEEP SINGLE QUOTES
    . '@&+:?_.,/\-'      // KEEP SOME SPECIAL CHARACTERS (ESCAPED HYPHEN)
    . ' '                // KEEP BLANKS
    . ']'                // END OF THE CHARACTER CLASS
    . '#'                // REGEX DELIMITER
    . 'i'                // CASE-INSENSITIVE
    ;
    $str = preg_replace($rgx, NULL, $str);

    return trim($str);
} 
```

# playframework-2.1 - 排序和播放框架 2.1

> ID：14023224
> 
> 赞同：5
> 
> 时间：2012-12-24T15:40:13.000
> 
> 标签：playframework-2.1, sorm

我正在尝试将 Sorm 用于游戏框架项目。我正在使用使用 Scala 2.10 的 2.1 版本。问题是我的课程没有被 Sorm 识别，我得到了一个`ClassNotFoundException`

这是我使用的：

```
package models

case class User(val name: String)

object Db extends Instance (
  entities = Set(Entity[User]()),
  url = "jdbc:h2:mem:test"
) 
```

在我的控制器中：

```
import models.{Db,User}

object Application extends Controller {
  def index = Action {
    Db.save(User("test")) // Error at this line
    Ok("saved")
  }
} 
```

还有一个例外：

```
play.api.Application$$anon$1: Execution exception[[ClassNotFoundException: models.User]]
    at play.api.Application$class.handleError(Application.scala:279) ~[play_2.10.jar:2.1-RC1]
    at play.api.DefaultApplication.handleError(Application.scala:373) [play_2.10.jar:2.1-RC1]
    at play.core.server.netty.PlayDefaultUpstreamHandler$$anonfun$10$$anonfun$apply$27.apply(PlayDefaultUpstreamHandler.scala:296) [play_2.10.jar:2.1-RC1]
    at play.core.server.netty.PlayDefaultUpstreamHandler$$anonfun$10$$anonfun$apply$27.apply(PlayDefaultUpstreamHandler.scala:294) [play_2.10.jar:2.1-RC1]
    at play.api.libs.concurrent.PlayPromise$$anonfun$extend1$1.apply(Promise.scala:110) [play_2.10.jar:2.1-RC1]
    at play.api.libs.concurrent.PlayPromise$$anonfun$extend1$1.apply(Promise.scala:110) [play_2.10.jar:2.1-RC1]
Caused by: java.lang.ClassNotFoundException: models.User
    at java.net.URLClassLoader$1.run(URLClassLoader.java:366) ~[na:1.7.0_09]
    at java.net.URLClassLoader$1.run(URLClassLoader.java:355) ~[na:1.7.0_09]
    at java.security.AccessController.doPrivileged(Native Method) ~[na:1.7.0_09]
    at java.net.URLClassLoader.findClass(URLClassLoader.java:354) ~[na:1.7.0_09]
    at java.lang.ClassLoader.loadClass(ClassLoader.java:423) ~[na:1.7.0_09]
    at java.lang.ClassLoader.loadClass(ClassLoader.java:356) ~[na:1.7.0_09] 
```

知道我怎样才能完成这项工作吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-06T01:28:45.110

这是一个[不兼容问题](https://github.com/sorm/sorm/issues/10)，自发布以来现已修复`0.3.7`。干杯!

# php - JSON数据没有在POST中发送？

> ID：14023225
> 
> 赞同：1
> 
> 时间：2012-12-24T15:40:12.833
> 
> 标签：php, javascript, jquery, ajax, json

我正在构建一个 AJAX 表单，并尝试通过 JSON 发送 3 个字段。

在客户端，表单被序列化并输入 JSON 格式：

```
$('#form-signin').live('submit', function(event) {
    var target = $('#ajax');
    var url = '/ajax/user/authenticateLevel2';

    $.ajax({

        type: "POST",
        url: url,
        data: $.base64.encode($('#form-signin').serialize()),
        dataType: 'json',

        success: function(data, status) {
            $.getJSON(url, function(data) {
                $('#ajax').html($.base64.decode(data.html));
                $('#ajax').modal();
            });
        }
    });
    event.preventDefault();
}); 
```

服务器端，我的路由器拆分 URL 请求，看到第一部分包含“ajax”，然后继续专门将路由请求传递给 AJAX 处理程序。

我的问题是，即使在路由器内部，检查`$_REQUEST`用于获取帖子信息的内容，帖子数据也不存在。也是如此`$_POST`。

即使是请求命中的第一页 (index.php)，`$_REQUEST`也没有数据。

我究竟做错了什么？

服务器端，

请求被发送到包含 Autoloader 和 init 脚本的 index.php。

init 脚本初始化数据库连接，设置错误、异常和会话处理，然后将请求传递到路由器。

路由器，在其构造方法中：将 URL 设置为数组（已分解`$_SERVER['REQUEST_URI']`），然后设置相关的控制器、方法和附加参数。

在这种情况下，因为我们正在执行 ajax 请求，所以在我们发送请求之前会发生特殊处理。

方法参数设置为：

```
 $requestParams = $_REQUEST;
    unset($requestParams['url']); 
```

此请求参数以及附加信息（url、控制器、方法和数据库对象）被传递以进行调度。

在所有情况下，我们主要使用这种方法进行调度：

```
 $dispatchedController = new $this->controller($this->database);
            $method = $this->method;

            return $dispatchedController->$method($this->params); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-24T16:06:35.137

如果我记得很久以前使用插件的时候，方法 $.base64.encode() 返回一个字符串，所以你可能发送到服务器的东西就像一个没有值的单个参数。

我相信你应该做类似的事情

```
data: "foo=" + $.base64.encode($('#form-signin').serialize()), 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-24T15:44:26.710

代码应该可以工作（假设您的 HTML 不是这里的问题，例如，`'#form-signin'`是正确表单的正确选择器）。

您提到您无法在服务器端获取数据。但是，您确定您甚至可以从客户端发送您需要的数据吗？例如，您是否使用 Firebug 等工具分析过请求？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-24T16:12:51.420

您不会将 json 发送到服务器，而只是一个 base64 编码的字符串。您还期望密钥/对值。要发送键/对值，只需将序列化的表单数据传递给 $.ajax 函数。

```
$('#form-signin').live('submit', function(event) {
    var target = $('#ajax');
    var url = '/ajax/user/authenticateLevel2';
    $.ajax({
        type: "POST",
        url: url,
        data: $('#form-signin').serialize(),
        dataType: 'json',
        success: function(data, status) {
            $.getJSON(url, function(data) {
                $('#ajax').html($.base64.decode(data.html));
                $('#ajax').modal();
            });
        }
    });
    event.preventDefault();
}); 
```

# javascript - 条件形式不起作用

> ID：14023228
> 
> 赞同：2
> 
> 时间：2012-12-24T15:40:21.423
> 
> 标签：javascript, html, forms

我是 javascript 新手，我正在尝试向表单添加条件字段。我看过这些帖子：

[如何创建一个不创建换行符或水平空间的隐藏 div？](https://stackoverflow.com/questions/1992114/how-do-you-create-a-hidden-div-that-doesnt-create-a-line-break-or-horizontal-sp)?
[html元素表单的条件显示](https://stackoverflow.com/questions/3961422/conditional-display-of-html-element-forms)

到目前为止，我已经想出了这个小例子，效果很好。

```
<html>
   <head>
       <script language="javascript">

           function cucu(form){
                   if(form.check.checked){
                   document.getElementById("cucu").style.visibility="visible"; 
                   }
                   else{
                          document.getElementById("cucu").style.visibility="hidden";
                  }
          }

              function load()
              {
                      document.getElementById("cucu").style.visibility="hidden";
              }

      </script>
  </head>

  <body onload="load()">
  <form id="form">
      <input type="checkbox" name="check" onclick="cucu(this.form)" >

      <div id="cucu">
      CUCU
      </div>

      </form>
  </body>
<html> 
```

我在更大的方面尝试了相同的方法，唯一的变化是隐藏元素是一个文本字段，但它只是不起作用。

这是表格的一部分：

```
Album:  <INPUT TYPE="checkbox" NAME="checkAlbum" onclick="checkAlbum(this.form)" id="idAlbum">

        <div id="divAlbum" >
        Choisir un album : <input type="text" name="Album" list="Albums">
                <datalist id="Albums">

                    <?php
                        $requete = 'SELECT DISTINCT titreAlbum FROM Album';
                        $resultat = mysqli_query($connexion, $requete);
                            while($row = mysqli_fetch_assoc($resultat)){
                                echo '<option value="'.$row['titreAlbum'].'">';
                        }
                     ?>

                </datalist> <br><br>
        </div> 
```

我的头看起来如下：

```
<!DOCTYPE html>
<head>
    <meta http-equiv="Content-Type" content="text/html ; charset=UTF-8" />
    <title>BLABLA</title>
    <link rel="stylesheet" type="text/css" href="include/styles.css"> 
    <script language="javascript" >

    function hideElements(){
        document.getElementById("divAlbum").style.visibility="hidden";
    }

    function checkAlbum(form){
        if(form.checkAlbum.checked){
            document.getElementById("divAlbum").style.visibility="visible";
        }else{
            document.getElementById("divAlbum").style.visibility="hidden";
        }
    }

    </script>
</head> 
```

我真的不知道问题是什么。我一次又一次地检查了这些功能。对可能的错误有什么建议吗？谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-24T15:52:51.670

您的按钮不起作用的原因是`this`指单击的输入本身。输入上的`form`属性是指`form`属性的值，而不是实际的形式。实际上您不需要该`form`属性，您可以简单地使用`this.checked`来查看当前是否检查了相应的输入。

```
Album:  <INPUT TYPE="checkbox" NAME="checkAlbum" onclick="checkAlbum(this)" id="idAlbum">

function checkAlbum(cb){
    if(cb.checked){
        document.getElementById("divAlbum").style.visibility="visible";
    }else{
        document.getElementById("divAlbum").style.visibility="hidden";
    }
} 
```

除此之外，我建议您考虑不要内联应用您的 JavaScript。将代码与标记分开可以提高可读性并有助于防止错误。您可能会考虑使用 jQuery 框架，因为它会使这类事情变得更容易。

```
$(function(){
    $('#idAlbum').on('change', function() { 
        // use change instead of click in case there's a label involved
        $('#divAlbum').toggle(this.checked);
    });
}); 
```

# xcode - 创建 LiveCode IOS 独立应用程序

> ID：14023231
> 
> 赞同：2
> 
> 时间：2012-12-24T15:40:35.727
> 
> 标签：xcode, ios5, ios6, livecode

我刚开始使用 LiveCode 并尝试创建一个独立的 IOS 应用程序并得到以下错误：

```
"There was an error while saving the standalone application performing 
iOS device builds requires the iOS 5.0 SDK platform to be installed" 
```

我们使用的是 Xcode 4.5.1 版，其中包括 IOS 6 SDK 和 LiveCode 5.5.1 版，并认为在安装 Xcode 时会安装所有需要的 SDK。

我们也不知道从哪里获得 IOS 5.0 SDK 以及如何在 Xcode 中安装它以便 LiveCode 可以使用它。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-07T02:56:23.790

如果您要部署 armv6 或通用应用程序，则只需要 iOS 5 SDK。如果您仅部署 armv7，那么如果您有 iOS 6 或 6.1 SDK，则不会出现此错误。如果你这样做，尽管你的应用程序将不支持 iPhone 3G 的旧 armv6 设备。构建独立版本时，LiveCode 需要构建引擎的 SDK。这就是为什么当一个新的 SDK 出现时 LiveCode 直到下一个版本才支持它。如果您使用 LiveCode，那么养成保留每个 Xcode 版本的习惯是值得的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-24T16:43:25.080

尝试升级到 Xcode 4.5.2，然后查看此链接：[http ://forums.runrev.com/viewtopic.php?f=49&t=9339](http://forums.runrev.com/viewtopic.php?f=49&t=9339)

# blackberry - CodeModuleManager 无法为模块分配空间

> ID：14023236
> 
> 赞同：1
> 
> 时间：2012-12-24T15:40:57.670
> 
> 标签：blackberry, java-me, auto-update

我正在尝试编写一个可以下载和安装`cod`文件的应用程序。

我有这行：

```
CodeModuleManager.createNewModule(codData.length, codData, codData.length); 
```

预计将返回一个模块句柄（它是一个 int）。但是，它返回 0，这意味着无法为要安装的模块分配空间。我搜索了一下，但真的找不到任何有关可能导致此问题的信息。有任何想法吗 ？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-25T12:45:24.790

我找到了解决方案：

1.  我使用了可交付成果/web 目录中的 COD 文件
2.  当 COD 文件超过某个大小时，它会被分割成 2 个（或更多）的 cod 文件。就我而言，有两个 COD 文件。一个命名为 abc.cod，另一个命名为 abc-1.cod。您需要同时拥有两个 cod 文件才能进行安装。（这是真正的问题）
3.  我注意到在可交付成果/标准文件夹中只有 1 个 cod 文件，这可能是它没有分成 2 部分的情况，因此 CodeModuleManager 无法为其整体分配空间（因此分区是必要的毕竟）

但是，即使在此之后，您也可能会遇到问题，例如当您覆盖 cod 文件时（即，当您尝试更新已经存在的应用程序时）您的应用程序图标消失了。

我发现使用该`.jad`文件更方便。只需在您的目录中设置正确的 mime 类型并将`jad`和`cod`文件放在那里。然后使用浏览器打开您的`jad`文件，您的应用程序应该由操作系统本身自动且顺利地安装/更新。

希望这对其他人有帮助

# vb.net - 直接从 VB.NET 打印到点阵打印机

> ID：14023239
> 
> 赞同：1
> 
> 时间：2012-12-24T15:41:13.337
> 
> 标签：vb.net, printing, epson, dot-matrix

我正在完成我正在编写的程序，我必须创建一个到 Epson LQ-300+ 点阵的打印。打印必须在纸张的某些特定部分打印一些文本（金额，名称等）谁能指出我正确的方向或给我一个例子，因为我无法找到一些东西以便直接发送 ASCII 字符到打印机通过 LPT1。谢谢你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-24T17:55:00.987

就定位而言，它主要是反复试验，它还取决于字体以及您是否使用通用/文本驱动程序（*如果是的话，字符间距、行间距和字体是什么打印机已设置为*)。回到 DOS 时代，您可以将单个字符发送到打印机，但在 Windows 中打印是基于页面的，这意味着您需要使用[PrintDocument 类](http://msdn.microsoft.com/en-us/library/system.drawing.printing.printdocument%28v=vs.100%29.aspx)， 使用[PrintPageEventArgs](http://msdn.microsoft.com/en-us/library/system.drawing.printing.printpageeventargs%28v=vs.100%29.aspx)[图形属性的](http://msdn.microsoft.com/en-us/library/system.drawing.printing.printpageeventargs%28v=vs.100%29.aspx)[PrintString 方法](http://msdn.microsoft.com/en-us/library/46c36z9t%28v=vs.100%29.aspx)处理[PrintPage 事件](http://msdn.microsoft.com/en-us/library/system.drawing.printing.printdocument.printpage%28v=vs.100%29.aspx)，以将文本放置在您需要的位置成为。

像这样的东西：

```
Private Sub Button1_Click(sender As System.Object, e As System.EventArgs) Handles Button1.Click
    If PrintDialog1.ShowDialog() = Windows.Forms.DialogResult.OK Then
        PrintDocument1.Print()
    End If
End Sub

Private Sub PrintDocument1_PrintPage(sender As System.Object, e As System.Drawing.Printing.PrintPageEventArgs) Handles PrintDocument1.PrintPage
    e.Graphics.DrawString("Hello World", New Font("Arial", 10), Brushes.Black, New Point(100, 100))
End Sub 
```

# android - Android：动画始终处于中心位置

> ID：14023242
> 
> 赞同：0
> 
> 时间：2012-12-24T15:41:28.313
> 
> 标签：android, animation, android-activity

这是我的幻灯片动画。

```
<translate xmlns:android="http://schemas.android.com/apk/res/android"
    android:duration="@android:integer/config_longAnimTime"
    android:fromYDelta="-100%p"
    android:toYDelta="-30%p" /> 
```

幻灯片很好。但视图总是最终落在屏幕的中心。上面的代码有问题吗？

谢谢，拉胡尔。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-24T15:52:51.323

您必须将属性[fillAfter](http://developer.android.com/reference/android/view/animation/Animation.html#attr_android%3afillAfter)设置为“true”。

**代码：**

```
animation.setFillEnabled(true);
animation.setFillAfter(true); 
```

**XML:**

```
<set
    android:fillEnabled="true"
    android:fillAfter="true"
    xmlns:android="http://schemas.android.com/apk/res/android">

    <translate
    android:duration="@android:integer/config_longAnimTime"
    android:fromYDelta="-100%p"
    android:toYDelta="-30%p" />

</set> 
```

希望有帮助！

# php - persistent connections and wait timeout

> ID：14023244
> 
> 赞同：0
> 
> 时间：2012-12-24T15:41:41.167
> 
> 标签：php, mysql, mysql-pconnect

## Who maintains persistent connections pool?

I've looked a bit [at the source code](http://lxr.php.net/xref/PHP_5_3/ext/mysql/php_mysql.c#818) and I understood that `mysql_pconnect` is a PHP made function and PHP itself is maintaining a pool of connections. It's not mysql's built in functionality and PHP only is responsible for maintaining a pool. Which seems legit.
**Am I right ?**

## Slow queries killer?

I'm experiencing some problems with timed out connections.
My `my.cnf` has a configuration of `wait_timeout=5`. This is theoretically meant to kill queries that take more then 5 seconds to execute.

With this configuration I feel like I'm not achieving neither the 5 seconds limit per query, nor any benefits from persistent connections.

*Could you validate my thoughts and suggest something?*
*php 5.3.3, mysql 5.1 via mysql ext, no mysqlnd*

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-24T17:47:10.077

[wait_timeout](http://dev.mysql.com/doc/refman/5.5/en/server-system-variables.html#sysvar_wait_timeout) should only kill idle connections.

To kill long running queries, you'll have to look into an external script.

The percona toolkit does have a tool that fits with what you want to do: [pt-kill](http://www.percona.com/doc/percona-toolkit/2.1/pt-kill.html)

# xpathnavigator - 如何在 xpath 中比较两个不同的 div id 或类值？

> ID：14023245
> 
> 赞同：1
> 
> 时间：2012-12-24T15:41:40.993
> 
> 标签：xpathnavigator

```
 <div class="productColor">
         <ul id="morecolor" class="morecolors">
  </div>
  <div class="sizeofproduct">
  <div class="prices"> 
```

在这里，我需要比较`div class="productColor"`两者`div class="prices"` 都`div`不同，那么如何使用firepath xpath进行比较呢？

# sql-server - 使用 Session.Flush 然后 ITransaction.Commit 使数据回滚

> ID：14023248
> 
> 赞同：0
> 
> 时间：2012-12-24T15:42:01.787
> 
> 标签：sql-server, nhibernate

我正在尝试使用`Session.Update`然后继续执行另一个 SQL 查询来更新实体。另一个查询没有看到更改的值。当我使用分析器跟踪它时，`Session.Update`什么也没做。

```
public class InvoiceService()
{
    public void Update(Invoice invoice)
    {
        using (var trans = BeginTransaction())
        {
            Session.Update(invoice); //Nhibernate did not update invoice. 

            ExecuteNamedQuery(); //Query executed before invoice updated.

            trans.Commit(); //Invoice updated.
        }
    }
} 
```

然后我在 Session.Update 之后添加 Session.Flush。

```
using (var trans = BeginTransaction())
{
    Session.Update(invoice);
    Session.Flush()

    ExecuteNamedQuery();

    trans.Commit();
} 
```

执行后`Session.Flush`，还会执行更新的 SQL 查询。它完美地工作。执行顺序正确。但后来我执行了另一种方法来获取所有发票。提交事务使 nhibernate 执行更新查询，以便更早地使用旧值更新我更新的发票。（例如：数量 = 20，更新为 10，然后再次更新为 20）

```
public void FindAll()
{
    using (var trans = BeginTransaction())
    {
        var invoices = Session.CreateCriteria<Invoice>().List<Invoice>();

        trans.Commit(); // In here invoice that i updated earlier get updated again, using old values.

        return invoices;
    }
} 
```

**怎么又更新了？**

**这个问题的解决方案是什么？**

提前致谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-24T16:20:14.570

`Update`是该方法的不幸名称；的目的`Update`是将瞬态实例附加到新会话。请参阅[更新文档](http://nhforge.org/doc/nh/en/index.html#manipulatingdata-updating)并确保您了解[实例状态](http://nhforge.org/doc/nh/en/index.html#architecture-states)。

由于 NHibernate 认为发票已更改，因此发票已更新为原始值。此“幻像”更新可能是由意外更改的属性引起的。一个典型的根本原因是一个可以为空的数据库列映射到一个不可为空的属性（反之亦然）。最简单的故障排除方法是`dynamic-update`在会话工厂配置中打开，以便您可以查看 NHibernate 检测为脏的属性。

# c# - 如何在 c# 中按所有者控制类的可见性

> ID：14023249
> 
> 赞同：4
> 
> 时间：2012-12-24T15:42:04.027
> 
> 标签：c#, class, visibility

通常我希望某个类 C1 的某些（或全部）函数只能从另一个类 C2 中访问，因为 C2 是一种代理，它拥有 C1 类型的对象（例如：类“神经元”的方法，如“ connect()”，只能从“Brain”访问）。我认为这在 C# 中是不可能直接实现的，这与继承不同，在继承中我们可以使用诸如“private”或“protected”之类的关键字来指定可见性。

在这种情况下，最佳做法是什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-24T15:46:19.003

为您的类创建一个程序集，并将不应对外界可见的内部类声明为`internal`：

> [内部（C# 参考）](http://msdn.microsoft.com/en-us/library/vstudio/7c5ka91b.aspx)：
> 
> `internal`关键字是类型和类型成员的访问修饰符。内部类型或成员只能在同一程序集中的文件中访问

所以，像这样：

```
namespace YourAssembly.Classes
{
    internal class C1
    {
        public void Foo()
        {

        }
    }

    public class C2
    {
        public void DoFoo()
        {
            new C1().Foo();     
        }
    }
} 
```

这里`C2`可以从其他程序集中访问，而`C1`只能从同一个程序集中访问。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-24T15:43:25.490

如果`C1`除了 之外任何人都无法访问，`C2`则创建`C1`一个`private`.`C2`

```
public class C2
{
    public C2() { }

    private class C1
    {
        public C1() { }
    }
} 
```

但是，如果`C1`可以在 之外访问`C2`，那么您将需要将某种形式传递`key`给`ctor`of`C2`以确保它是**受信任**的代理。

```
public class C1
{
    public C1(string key)
    {
        // verify that it's a valid proxy or user of this class via the key
    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-24T15:50:10.703

一个经常用于测试目的的技巧是使用[InternalsVisibleToAttribute](http://msdn.microsoft.com/en-us/library/system.runtime.compilerservices.internalsvisibletoattribute.aspx)。您将它应用于这样的程序集（exe 或 dll）

```
[assembly: InternalsVisibleTo("NameOfFriendAssembly")] 
```

定义为的类（和其他类型）和成员`internal`将在内部可见，但也对程序集可见`NameOfFriendAssembly`

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-24T16:14:22.700

在我看来，最适合你的是做这样的事情：

```
public interface INeuron 
{
   double GetValue();
   List<INeuron> GetDependents();
   List<double> GetWeights();
}

internal class Neuron : INeuron
{
   // implementation of INeuron
   // ...

   // implementation of methods only known to own classes
   public void Connect(Neuron target, double weight)
   {
      ...
   }
}

public class Brain
{
   private List<Neuron> _allNeurons = new List<Neuron>();       

   public Brain()
   {
      Neuron n1 = new Neuron();
      Neuron n2 = new Neuron();
      n1.Connect(n2,0.5);
      _allNeurons.Add(n1);
      _allNeurons.Add(n2);
   }

   public IEnumerable<INeuron> GetAllNeurons() { return _allNeurons.Cast<INeuron>(); }
} 
```

# c++ - C++模板类无效使用不完整类

> ID：14023250
> 
> 赞同：0
> 
> 时间：2012-12-24T15:42:09.370
> 
> 标签：c++, templates

正在努力学习 C++。我的代码中出现错误，如下所示：

```
class LinkedList : public LinkedList<T> { 
```

错误说：

> 'class LinkedList, std::allocator > >' 的不完整类型'class LinkedList, std::allocator >>'声明的无效使用

谁能指出我做错了什么？这是整个代码。

```
#ifndef LINKEDLIST_HPP
#define LINKEDLIST_HPP

#include <iostream>

using namespace std;

template <class T>
class LinkedList : public LinkedList<T> {

    private:
        // a ListNode consists of the item and a pointer to the next ListNode
        struct ListNode {
            T data;
            ListNode *next;
        };
        int size; //Size of the list
        ListNode *head; //the beginning of the list

    public:
        LinkedList(); // default oonstructor
        ~LinkedList(); // destructor
        virtual bool isEmpty ();
        virtual int  getLength ();
        virtual void insert (int pos, T item);
        virtual T    remove (int pos);
        virtual T    retrieve (int pos);

        //helper methods
        LinkedList(LinkedList &copyList); //copy constructor
        ListNode *find (int pos) const; // internal find function
};

//default constructor
template <class T>
LinkedList<T>::LinkedList() {
    size = 0;
    head = NULL;
}

//destructor
template <class T>
LinkedList<T>::~LinkedList() {
    //loop through each node, and delete it
    ListNode* current = head;
    while (current != NULL) {
        ListNode* next = current->next;
        delete current;
        current = next;
    }
    head = NULL; // set head node to back to null
}

//copy constructor
template <class T>
LinkedList<T>::LinkedList(LinkedList& copyList) {
    size = copyList.size;

    // if copyList is empty
    if (copyList.head == NULL)
        head = NULL;

    else {
        //create a new head
        head = new ListNode;
        head->data = copyList.head->data;

        //create a new list
        ListNode *newPtr = head; // start at the head
        // iterate through rest of list to be copied
        for (ListNode *copyPtr = copyList.head->next; copyPtr != NULL; copyPtr = copyPtr->next) {
            newPtr->next = new ListNode;
            newPtr->data = copyPtr->data;
        }
        //make last ListNode's next point to NULL
        newPtr->next = NULL;
    }
}

template <class T>
bool LinkedList<T>::isEmpty() {
    if (size == 0)
        return true;
    return false;
}

template <class T>
int LinkedList<T>::getLength() {
    return size;
}

// used in other methods to find a given index
template <class T>
LinkedList<T>::ListNode LinkedList<T>::find(int pos) const {

    // check that pos is in bound of LinkedList
    if ((pos < 1) || pos > getLength()) {
        cout << "Find position of out bounds" << endl;
        return NULL;
    } else { //search through ListNodes
        ListNode *temp = head; // start at the head
        for (int i = 1; i < pos; ++i)
            temp = temp->next;
        return temp;
    }
}

template <class T>
T LinkedList<T>::retrieve(int pos) {
    T tempData; // to hold retrieved data
    try {
        if ((pos < 1) || (pos > getLength())) {
            cout << "Retrieve request outside LinkedList's bounds" << endl;
            return NULL;
        }
        else { //traverse list
            ListNode *temp = find(pos);
            tempData = temp->data;
            return tempData;
        }
    } catch (int e) {
        cout << "Could not retrieve position " << pos << endl;
    }
}

template <class T>
void LinkedList<T>::insert(int pos, T item) {

    //check bounds
    if ((pos < 1) || (pos > getLength() +1))
        cout << "Must insert at a position between 1 and getLength() + 1" << endl;

    else {
        try {
            //create new ListNode
            ListNode *temp = new ListNode;
            temp->data = item;

            //if the new item is at the first position
            if (pos == 1) {
                temp->next = head;
                head = temp;
            }
            else {
                ListNode *prev = find(pos - 1);
                temp->next = prev->next;
                prev->next = temp;
            }
            //increment size
            ++size;

        } catch (int e) {
            cout << "Error inserting " << item << " at position " << pos << endl;
        }
    }
}

template <class T>
T LinkedList<T>::remove(int pos) {

    //check bounds
    if ((pos < 1) || (pos > getLength()))
        cout << "Must remove a position between 1 and getLength()" << endl;

    else {
        try {

            ListNode *temp; //to hold shifted node

            //if node to be deleted is first node
            if (pos == 1) {
                temp = head;
                head = head->next;
            }
            //for anything but the head
            //write over the node before the pos'th index
            else {
                ListNode *prev = find(pos - 1);
                temp = prev->next;
                prev->next = temp->next;
            }

            //destroy temp, to free up memory
            temp->next = NULL;
            delete temp;

            //decrement size
            --size;

        } catch (int e) {
            cout << "Error removing item from position " << pos << endl;
        }
    }

}

#endif  /* LINKEDLIST_HPP */ 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-24T15:43:58.573

```
template <class T>
class LinkedList : public LinkedList<T> { 
```

这没有意义。它是这样的：

```
class A : public A 
```

你能理解这个吗？具体如何？

您派生的类不存在，而是在您从它派生时被定义，因此编译器不知道基础应该是什么。编译器需要知道基类的完整定义，然后才能从它派生。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-24T15:49:10.407

纳瓦兹给出了正确的答案。

只是提供一些离题信息：

使您的析构函数成为虚拟的（即使从模板化容器继承并不是非常 C++ 的东西）。

在它所属的地方使用 const ：

```
LinkedList(const LinkedList &copyList); //copy constructor
virtual bool isEmpty () const;
// etc. 
```

显然，在现实生活中你会使用像 std::list 这样的 stl 容器；）

# c++ - 从使用 getline() 的文件中读取第二个整数

> ID：14023251
> 
> 赞同：0
> 
> 时间：2012-12-24T15:42:33.653
> 
> 标签：c++, getline

我有一个文本文件，可以在下面看到。我希望读取文件，然后使用文件中的第二个整数。但是，我目前使用的代码只需要第一个整数和字符串。虽然我希望它采用第二个整数和字符串。

所以我的问题是，这怎么可能？它可以完成`getLine()`吗？

我正在尝试读取的文件和代码如下所示：

文件：

```
10202 CE151 17.5
10105 CE151 99.9
10202 CE151 5.6
10406 CE301 59.8
10103 CE151 75.5
10709 CE204 67.2 
```

代码：

```
string mod;
float mark;

getline(file2, s2);
istringstream line(s2);
line >> mark;
line >> mod;

cout << mod << endl;
cout << mark << endl; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-24T15:46:42.433

```
line >> reg;
line >> mod;
line >> mark;

cout << reg << endl;
cout << mod << endl;
cout << mark << endl; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-24T16:17:51.897

Second integer is on the second line, so you need to [skip a line](https://stackoverflow.com/questions/5878052/does-using-ignorenumeric-limitsstreamsizemax-in-the-iostreams-library-ha)

```
(#include <limits> header for this)
file.ignore(std::numeric_limits<std::streamsize>::max(), '\n') 
```

Then you need to read the integer into a variable

```
int number= 0;
file>> number; 
```

Now you have the second integer in `number`.

# html - 将标题和搜索图标与正文对齐

> ID：14023254
> 
> 赞同：0
> 
> 时间：2012-12-24T15:43:21.103
> 
> 标签：html, css

我在使用 Tumblr 时遇到了一些对齐问题。

我正在尝试对齐标题和搜索图标。

该网站在[这里。](http://wearethejamaicanbobsledteam.tumblr.com/)

下面是我想要实现的模型：

![在此处输入图像描述](../Images/1e50de6197d07825b8d59cb106d9962c.png)

如果您查看我的网站，您会看到标题和搜索栏未按照我上面的图片对齐。

我尝试了不同的利润等，但无济于事。

哦，我希望它响应浏览器，所以它总是对齐的。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-24T17:19:11.053

找到下面的 css 规则并将 css 规则粘贴到那里

css：[http](http://wearethejamaicanbobsledteam.tumblr.com/) ://wearethejamaicanbobsledteam.tumblr.com/ 线路：555

```
 iframe#tumblr_controls {
        position: fixed !important;
        right: -310px !important; // it will move the button to -310px towards right.
        top: 9px !important;
        width: 160px;
        z-index: 5000 !important;
    } 
```

对齐搜索框：

css：[http](http://wearethejamaicanbobsledteam.tumblr.com/) ://wearethejamaicanbobsledteam.tumblr.com/线路：150

```
#search {
    border-left: 0 solid #DDDDDD;
    border-right: 0 solid #DDDDDD;
    padding: 20px 15px 6px;
    position: absolute;
    right: 32px; // change the value here
    top: 0;
} 
```

使镜头图标在搜索框中从左到右

css：[http](http://wearethejamaicanbobsledteam.tumblr.com/) ://wearethejamaicanbobsledteam.tumblr.com/ 线路：161

```
#search input[type="text"] {
    background: url("http://static.tumblr.com/twte3d7/V9ym4qy8v/search-white.png") no-repeat scroll 95% 6px #FCFCFC;
    border: 1px solid #DDDDDD;
    border-radius: 0 0 0 0;
    box-shadow: 0 1px 3px rgba(0, 0, 0, 0.15) inset;
    color: #212121;
    font: 12px 'Karla';
    padding: 6px 15px 7px 35px; **// Update the below rules here**
    transition: all 0.7s ease 0s;
    width: 150px;
} 
```

更新上述css规则中的css

```
padding: 6px 35px 7px 15px; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-24T17:21:00.227

### CSS 修复

```
#search {right: 15px;} 
```

它位于`Line 150`您的主页中。

# c++ - 一个 DWORD 可以容纳多少个标志？

> ID：14023261
> 
> 赞同：2
> 
> 时间：2012-12-24T15:43:35.910
> 
> 标签：c++, windows, winapi

对使用标志有点新，对 C++ 也不是最好的。我只是想知道，一个 DWORD 可以容纳多少个标志？我假设它是 32，因为 32 位？如果没有，它至少可以容纳 16 个标志，因为我至少需要这个。

我可以找到如何使用标志，那里没问题，但是在网络上找不到任何地方说明不同类型的数据类型可以保存的值，我再次假设它只是它们拥有的位数，但我找不到足够的信息来澄清这一点。

谢谢你。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-24T15:53:44.930

问题标记为 C++，因此如果要存储 16 个标志，只需使用 std::bitset<16> 即可。

如果您想确定整数的位大小，请使用 cstdint 和类型 linke uint16_t, uint64_t... 会更清楚。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-24T15:52:32.740

一个 WORD 有 16 位，所以一个 DWORD（双字）有 32 位。

因此，如果您为每个标志使用一个位，则一个 DWORD 可以容纳 32 个标志。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-24T15:53:41.947

整数数据类型可以支持与位一样多的标志。根据[MSDN 文档](http://msdn.microsoft.com/en-gb/library/windows/desktop/aa383751.aspx#DWORD)，`DWORD`是 32 位数据类型。

> **DWORD**一个 32 位无符号整数。范围是 0 到 4294967295（十进制）。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-12-24T15:46:11.970

DWORD 有多少位？一个标志和一个位通常是同一个东西。但有时，当使用位域时，我们可以使用多个位，在这种情况下，您当然不能容纳尽可能多的域。

# android - j的异步ProgressBar冻结

> ID：14023268
> 
> 赞同：1
> 
> 时间：2012-12-24T15:44:14.540
> 
> 标签：android, android-asynctask, android-progressbar

我正在使用 j 的异步库进行发布/获取（我自己尝试过，同样的事情发生了），我一直遇到问题。当我调用 getNews() 方法时，我的 ProgressBar（不确定）一直冻结。我在这里做错了什么？

```
protected static ArrayList<HashMap<String, String>> allNews = new ArrayList<HashMap<String, String>>();

public void getNews() throws JSONException
{

    VestiHTTPClient.get("json.php", null, new JsonHttpResponseHandler()
    {

        @Override
        public void onSuccess(JSONArray news)
        {
            try
            {
                for(int i=0; i<news.length(); i++)
                {
                    JSONObject jo = (JSONObject) news.get(i);
                    HashMap<String, String> map = new HashMap<String, String>();
                    map.put("POST_URL", jo.getString("POST_URL"));
                    map.put("TOPIC_TITLE", jo.getString("TOPIC_TITLE"));
                    map.put("AUTHOR", jo.getString("AUTHOR"));
                    map.put("CATEGORY", jo.getString("CATEGORY"));
                    map.put("POST_TIME", jo.getString("POST_TIME"));
                    map.put("POST_TEXT", jo.getString("POST_TEXT"));
                    map.put("IMAGE", jo.getString("IMAGE"));

                    allNews.add(map);                       
                }
            }
            catch(Exception e)
            {
                e.printStackTrace();
            }
        }

        @Override
         public void onFinish() {
            Intent main = new Intent(SplashScreen.this, MainWindow.class);
            SplashScreen.this.startActivity(main);
            SplashScreen.this.finish();
         }
    });

} 
```

一切都正确触发（onSuccess，onFinish），但我的 ProgressBar 一直冻结（甚至尝试在单独的线程中运行它......）。

有人有什么想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-25T12:37:47.253

终于成功了！我使用[AndroidQuery](http://code.google.com/p/android-query/wiki/ImageLoading)（ListView 示例）进行图像加载和缓存（效果很好）。

首先在活动A中制作静态变量（我的SplashScreen活动）

```
protected static ArrayList<HashMap<String, String>> allNews = new ArrayList<HashMap<String, String>>();
protected static ArrayList<JSONObject> items = new ArrayList<JSONObject>(); 
```

然后使用 AsyncTask 获取您需要的所有 JSON 信息并填充两个 ArrayList，然后 onPostExecute 使您的其他活动（在我的情况下为 MainWindow）。

```
 @Override
    protected Integer doInBackground(String[]... params) {

        try
        {
            String address = "http://your.file.here";

            HttpClient client = new DefaultHttpClient();
            HttpPost post = new HttpPost(address);

            try
            {

                HttpResponse response = client.execute(post);
                Log.w("RESPONSE", response.toString());

                BufferedReader reader = new BufferedReader(new InputStreamReader(
                        response.getEntity().getContent(), "UTF-8"));
                String sResponse;

                while ((sResponse = reader.readLine()) != null) {
                    result = result.append(sResponse);
                }

                reader.close();

                JSONArray news = new JSONArray(result.toString());
                int count = news.length();

                for(int i=0; i<news.length(); i++)
                {
                    JSONObject jo = (JSONObject) news.get(i);
                    joNews.add(jo);
                    HashMap<String, String> map = new HashMap<String, String>();
                    map.put("POST_URL", jo.getString("POST_URL"));
                    map.put("TOPIC_TITLE", jo.getString("TOPIC_TITLE"));
                    map.put("AUTHOR", jo.getString("AUTHOR"));
                    map.put("CATEGORY", jo.getString("CATEGORY"));
                    map.put("POST_TIME", jo.getString("POST_TIME"));
                    map.put("POST_TEXT", jo.getString("POST_TEXT"));
                    map.put("IMAGE", jo.getString("IMAGE"));

                    allNews.add(map);
                }
            }
            catch(Exception e)
            {
                e.printStackTrace();
            }
        }
        catch(Exception e)
        {
            e.printStackTrace();
        }
        return 1;
    }

     protected void onPostExecute(Integer result) {
         Intent main = new Intent(SplashScreen.this, MainWindow.class);
         SplashScreen.this.startActivity(main);
         SplashScreen.this.finish();
     } 
```

最后，只需初始化 Activity B（我的 MainWindow 活动）中的变量，然后使用 AndroidQuery 将它们加载到 ListView 中！

```
private ArrayList<HashMap<String, String>> allNews = new ArrayList<HashMap<String, String>>();
private ArrayList<JSONObject> items = new ArrayList<JSONObject>();

    allNews = SplashScreen.allNews;
    items = SplashScreen.joNews;

    ArrayAdapter<JSONObject> aa = new ArrayAdapter<JSONObject>(this, R.layout.main_news_items, items){

        @Override
        public View getView(int position, View convertView, ViewGroup parent) {

                if(convertView == null){
                        convertView = getLayoutInflater().inflate(R.layout.main_news_items, null);
                }

                JSONObject jo = getItem(position);

                AQuery aq = new AQuery(convertView);
                aq.id(R.id.name).text(jo.optString("TOPIC_TITLE", "No Title"));
                aq.id(R.id.title).text(jo.optString("CATEGORY", ""));

                String tb = jo.optString("IMAGE");
                if(tb.equals(""))
                    tb = "http://default.image.here";
                aq.id(R.id.profile_img).progress(R.id.progress).image(tb, true, true, 0, 0, null, AQuery.FADE_IN_NETWORK, 1.0f);

                return convertView;

        }
    };

    ListView news = (ListView) findViewById(R.id.listView1);
    news.setAdapter(aa);
    news.setTextFilterEnabled(true); 
```

希望这对某人有帮助！

# python - 构建chrome时出错，subprocess.call抛出“没有这样的文件或目录”

> ID：14023273
> 
> 赞同：1
> 
> 时间：2012-12-24T15:44:42.373
> 
> 标签：python, exception, subprocess

```
Traceback (most recent call last):
  File "scripts/rule_bison.py", line 75, in <module>
    return Code = subprocess.call([bisonExe, '-d', '-p', prefix, inputFile, '-o', outputCpp])
  File "/usr/lib/python2.7/subprocess.py", line 493, in call
    return Popen(*popenargs, **kwargs).wait()
  File "/usr/lib/python2.7/subprocess.py", line 679, in __init__
    errread, errwrite)
  File "/usr/lib/python2.7/subprocess.py", line 1249, in _execute_child
    raise child_exception
OSError: [Errno 2] No such file or directory 
```

我正在尝试使用 ninja 构建铬源代码。然后我得到了上面的错误。我不知道怎么弄明白。你能给我一些想法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-24T16:00:36.583

这意味着`bisonExe`找不到由变量命名的任何二进制文件。任何不存在的`Errno 2`二进制文件都会抛出错误：

```
>>> subprocess.call(['spamandeggs', '-V'])
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
  File "/opt/local/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/subprocess.py", line 493, in call
    return Popen(*popenargs, **kwargs).wait()
  File "/opt/local/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/subprocess.py", line 679, in __init__
    errread, errwrite)
  File "/opt/local/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/subprocess.py", line 1249, in _execute_child
    raise child_exception
OSError: [Errno 2] No such file or directory 
```

# java - 订购一组字符串的 ArrayList

> ID：14023277
> 
> 赞同：-5
> 
> 时间：2012-12-24T15:45:01.777
> 
> 标签：java, arraylist, set

我在 Java 中有一个字符串集的 ArrayList

```
List<Set< String >> combinations; 
```

根据 Set 的大小以升序排列 ArrayList 的最佳方法是什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-24T15:52:23.023

编写一个`Comparator<Set<String>>`比较`size()`两个 Set 实例的结果。使用将 Comparator 作为第二个参数的 Collections.sort 方法。

# mysql - 即使条件匹配多条记录，也只加入 1 条记录

> ID：14023279
> 
> 赞同：0
> 
> 时间：2012-12-24T15:45:10.157
> 
> 标签：mysql, sql, join

**示例查询**

```
SELECT count(A.ID) 
FROM `TABLE_A` A LEFT JOIN `TABLE_B` B ON (A.ID=B.ID) 
WHERE ..... 
```

我需要：

即使`A.id` 匹配表 B 中的多条记录，也应将其视为仅一条。

**实际查询**

```
SELECT CampaignName,fsbcorponline.leads360campaigns.CostPerLead, 
count(fsbcorponline.leads360leads.id) leadCount,
count(CASE WHEN fsbcorponline.leads360leads.leadStatus like '%Contact Attempt%' OR                                
leadStatus like '%Call Back/Follow-up%' OR                                 
leadStatus like '%Working%' OR                                 
leadStatus like '%Credit Pulled%' OR                                 
leadStatus like '%Selected other Lender%' OR                                 
leadStatus like '%Pre-Approved%' OR                                 
leadStatus like '%Application Taken/Sent%' OR                                 
leadStatus like '%Application Received%' OR                                 
leadStatus like '%Submitted%' OR                                
leadStatus like '%Funded%' OR                                 
leadStatus like '%Future Opportunity%' OR                                 
leadStatus like '%Manager Review%' THEN 1 END ) leadContacted,         
COUNT(CASE WHEN fsbcorponline.leads360leads.lead_id IS NOT NULL THEN 1 END ) leadsToEncompass ,          
COUNT(CASE WHEN fsbcorponline.leads_to_loan.loan_closeDate IS NOT NULL AND loan_closeDate !='1900-01-01 00:00:00' THEN 1 END ) leadsToEncompassClose,         
COUNT(CASE WHEN fsbcorponline.leads_to_loan.loan_FundedDate IS NOT NULL AND loan_FundedDate !='1900-01-01 00:00:00' THEN 1 END ) leadsToEncompassFunded  
FROM (fsbcorponline.leads360leads LEFT JOIN fsbcorponline.leads360campaigns ON fsbcorponline.leads360leads.CampaignId=fsbcorponline.leads360campaigns.CampaignId)  
LEFT JOIN fsbcorponline.leads_to_loan ON fsbcorponline.leads360leads.id =lead_id  
Where 1=1 AND dateAdded between '11/24/2012 08:59:00' and '12/24/2012 08:59:00'AND CampaignName like '%TFSB.com%' 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-24T15:46:07.513

试试这个`distinct count`就可以了

```
SELECT count(distinct A.ID) 
FROM `TABLE_A` A JOIN `TABLE_B` B ON (A.ID=B.ID) 
WHERE ..... 
```

由于您只关心匹配记录，因此只需`JOIN`要做并且不需要`LEFT JOIN`

```
SELECT CampaignName,fsbcorponline.leads360campaigns.CostPerLead, 
count( distinct fsbcorponline.leads360leads.id) leadCount,
count(
CASE WHEN leadStatus like '%Contact Attempt%' OR                                
leadStatus like '%Call Back/Follow-up%' OR                                 
leadStatus like '%Working%' OR                                 
leadStatus like '%Credit Pulled%' OR                                 
leadStatus like '%Selected other Lender%' OR                                 
leadStatus like '%Pre-Approved%' OR                                 
leadStatus like '%Application Taken/Sent%' OR                                 
leadStatus like '%Application Received%' OR                                 
leadStatus like '%Submitted%' OR                                
leadStatus like '%Funded%' OR                                 
leadStatus like '%Future Opportunity%' OR                                 
leadStatus like '%Manager Review%' THEN 1 END ) leadContacted,         
COUNT
(CASE WHEN lead_id IS NOT NULL THEN 1 END ) leadsToEncompass ,          
COUNT(CASE WHEN loan_closeDate IS NOT NULL AND loan_closeDate !='1900-01-01 00:00:00' THEN 1 END ) leadsToEncompassClose,         
COUNT(CASE WHEN loan_FundedDate IS NOT NULL AND loan_FundedDate !='1900-01-01 00:00:00' THEN 1 END ) leadsToEncompassFunded  
FROM (fsbcorponline.leads360leads LEFT JOIN fsbcorponline.leads360campaigns ON fsbcorponline.leads360leads.CampaignId=fsbcorponline.leads360campaigns.CampaignId)  
LEFT JOIN fsbcorponline.leads_to_loan ON fsbcorponline.leads360leads.id =lead_id  
Where 1=1 AND dateAdded between '11/24/2012 08:59:00' and '12/24/2012 08:59:00'AND CampaignName like '%TFSB.com%' 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-24T15:48:36.500

`GROUP BY`可以为此目的使用子句：

```
SELECT COUNT(A.ID) 
FROM `TABLE_A` A LEFT JOIN `TABLE_B` B ON (A.ID=B.ID) 
WHERE .....
GROUP BY A.ID 
```

# forms - 使用 requestScope 托管 bean 向 ap:datatable 添加行，其中我有表单验证

> ID：14023289
> 
> 赞同：0
> 
> 时间：2012-12-24T15:46:40.800
> 
> 标签：forms, jsf-2, primefaces

我已经阅读了BalusC 的[using-databatables](http://balusc.blogspot.com/2006/06/using-datatables.html)并且我尝试使用请求范围添加一行示例，但我发现一个问题是当我添加

```
<h:inputHidden binding="#{myBean.dataItemId}" /> 
```

我页面的所有按钮都不起作用。起初我以为问题出在转换器上

```
<h:inputHidden binding="#{myBean.dataItemId}" converter="javax.faces.Integer"/> 
```

但也没有转换器我有同样的问题

第二个更有趣的是，我从示例代码中不明白，当向数据表添加新行时，表之前如何获取我添加的行

例如，如果我在添加时添加第一行并将数据放在第二行，我意识到添加函数会创建一个新的`ArrayList`，我认为它将删除第一行

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-26T21:31:41.337

正如那篇文章顶部的“通知”块中所提到的，它是针对 JSF 1.2 的。使用 JSF 2.0 视图范围可以更轻松地添加一行。

根据 JSF 1.2 文章中给出的示例，您只需进行 2 处更改：

1.  将 bean 放在视图范围内。

2.  删除整个`<h:inputHidden>`和`addCount`属性及其上的任何引用。

这是 JSF 2.0 风格的启动示例：

```
@ManagedBean
@ViewScoped
public class Bean {

    private List<Item> items;

    @EJB
    private ItemService service; // Or just DAO. Whatever you want.

    @PostConstruct
    public void init() {
        items = service.list();
    }

    public void add() {
        items.add(new Item());
    }

    public void save() {
        service.save(items);
    }

    public List<Item> getItems() { 
        return items;
    }

} 
```

和观点：

```
<h:dataTable value="#{bean.items}" var="item">
    <h:column>
        <h:outputText value="#{item.id}" rendered="#{item.id != null}" />
        <h:outputText value="new" rendered="#{item.id == null}" />
    </h:column>
    <h:column>
        <h:outputText value="#{item.name}" rendered="#{item.id != null}" />
        <h:inputText value="#{item.name}" rendered="#{item.id == null}" />
    </h:column>
    <h:column>
        <h:outputText value="#{item.value}" rendered="#{item.id != null}" />
        <h:inputText value="#{item.value}" rendered="#{item.id == null}" />
    </h:column>
</h:dataTable>
<h:commandButton value="Add" action="#{bean.add}" />
<h:commandButton value="Save" action="#{bean.save}" /> 
```

# java - 致命信号 11 (SIGSEGV) 位于 0x00000000 (code=1) - PhoneGap

> ID：14023291
> 
> 赞同：47
> 
> 时间：2012-12-24T15:46:45.830
> 
> 标签：java, android, eclipse, cordova

我现在使用 PhoneGap 开发 Android 应用程序。最近，当我尝试在 HTML 页面之间切换时，应用程序关闭，并且在 LogCat 中出现以下错误：

```
12-24 15:43:39.237: A/libc(23631): Fatal signal 11 (SIGSEGV) at 0x00000000 (code=1), thread 23631 (.example.app) 
```

我在谷歌上搜索了一下这个错误，我的理解是它与设备的内存有关。我找到了一些解决方案，但并没有意识到我是如何在 PhoneGap 中实现它们的。

这里有人遇到过这个错误吗？我能做些什么来解决这个问题？

谢谢 ：）

* * *

## 回答 #1

> 赞同：44
> 
> 时间：2012-12-24T16:06:48.320

如果您编写（或正在使用）一个插件，该插件又通过 NDK 使用本机 C/C++ 代码，这可能表明该本机代码中存在错误。

否则，这是您正在测试的设备或模拟器的固件中的错误。

如果您可以在模拟器、具有原始 ROM 的 Nexus 设备或来自不同制造商的各种设备上重现此问题，则可能是 Android 本身的错误。在这种情况下，请创建一个可以重现错误的示例项目，并将其与*整个*堆栈跟踪一起发布到[http:](http://b.android.com) //b.android.com，Android 操作系统问题跟踪器。

如果您只在一台设备或一个第三方 ROM 上遇到此问题，这可能是一个更具体的错误——最好的办法是联系设备制造商或 ROM 发行商并告知您的症状。

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2015-01-06T03:53:44.113

我在 xhdpi Nexus 7 上遇到了类似的错误，但在我的旧手机上一切正常。我的问题是在更新带有许多小按钮的大型 GridView 时发生的。

```
A/libc(7410): Fatal signal 11 (SIGSEGV) at 0xbe8a8000 (code=1), thread 7410 
```

我认为这不是您的问题，因为您的 PC 为 0，而我的 PC 为 0xbe8a8000，但它很容易尝试并且解决了我的问题，所以我将发布它以防其他人来这里寻找 SEGV 解决方案。
在[https://github.com/MasDennis/Rajawali/issues/313](https://github.com/MasDennis/Rajawali/issues/313)上有一个关于类似问题的讨论，有人提到他们有同样的问题，关闭硬件加速为他们解决了这个问题。这很容易尝试，它解决了我的问题。
在 Android 清单应用程序中添加：

```
android:hardwareAccelerated="false" 
```

希望这对其他人有帮助...

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2013-01-15T11:40:30.517

我刚刚在我正在从事的项目中遇到了同样的问题。事实证明，我在尝试实例化 Activity 时加载了大量图像和声音，导致应用程序内存不足。您的程序是否使用大量内存密集型资产？你能完全减小它们的尺寸吗？

在我的例子中，LogCat 在行前有一个绿色的堆栈跟踪（INFO 级日志记录）`Fatal signal 11 (SIGSEGV)`。堆栈跟踪是`OutOfMemoryException`在应用程序为`Activity`我启动时加载资产的时候。所以我拉起我的drawables（我的程序有很多），编辑它们以减小它们的文件大小，然后再试一次。虫子消失了。你可以看看你的 LogCat 输出是否和我的一样，看看你是否有类似的问题：

```
01-15 05:20:40.462: E/dalvikvm-heap(4513): Out of memory on a 3145744-byte allocation.
01-15 05:20:40.462: I/dalvikvm(4513): "main" prio=5 tid=1 RUNNABLE
01-15 05:20:40.462: I/dalvikvm(4513):   | group="main" sCount=0 dsCount=0 obj=0x4158b6a0 self=0x41001a60
01-15 05:20:40.462: I/dalvikvm(4513):   | sysTid=4513 nice=0 sched=0/0 cgrp=apps handle=1074673744
01-15 05:20:40.462: I/dalvikvm(4513):   | schedstat=( 0 0 0 ) utm=41 stm=20 core=1
01-15 05:20:40.462: I/dalvikvm(4513):   at android.graphics.BitmapFactory.nativeDecodeAsset(Native Method)
01-15 05:20:40.462: I/dalvikvm(4513):   at android.graphics.BitmapFactory.decodeStream(BitmapFactory.java:592)
01-15 05:20:40.462: I/dalvikvm(4513):   at android.graphics.BitmapFactory.decodeResourceStream(BitmapFactory.java:445)
01-15 05:20:40.462: I/dalvikvm(4513):   at android.graphics.drawable.Drawable.createFromResourceStream(Drawable.java:781)
01-15 05:20:40.462: I/dalvikvm(4513):   at android.content.res.Resources.loadDrawable(Resources.java:1963)
01-15 05:20:40.462: I/dalvikvm(4513):   at android.content.res.Resources.getDrawable(Resources.java:672)
01-15 05:20:40.462: I/dalvikvm(4513):   at com.kbi.speeddraw.lite.game.drawables.character.ExplodingCharacterDrawable.<init>(ExplodingCharacterDrawable.java:27)
<!-- snip -->
01-15 05:20:40.462: I/dalvikvm(4513):   at com.kbi.gameengine.api.gameactivity.GameActivity.onCreate(GameActivity.java:80)
01-15 05:20:40.472: I/dalvikvm(4513):   at android.app.Activity.performCreate(Activity.java:5048)
01-15 05:20:40.472: I/dalvikvm(4513):   at android.app.Instrumentation.callActivityOnCreate(Instrumentation.java:1094)
01-15 05:20:40.472: I/dalvikvm(4513):   at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2052)
01-15 05:20:40.472: I/dalvikvm(4513):   at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:2113)
01-15 05:20:40.472: I/dalvikvm(4513):   at android.app.ActivityThread.access$700(ActivityThread.java:139)
01-15 05:20:40.472: I/dalvikvm(4513):   at android.app.ActivityThread$H.handleMessage(ActivityThread.java:1224)
01-15 05:20:40.472: I/dalvikvm(4513):   at android.os.Handler.dispatchMessage(Handler.java:99)
01-15 05:20:40.472: I/dalvikvm(4513):   at android.os.Looper.loop(Looper.java:137)
01-15 05:20:40.472: I/dalvikvm(4513):   at android.app.ActivityThread.main(ActivityThread.java:4918)
01-15 05:20:40.472: I/dalvikvm(4513):   at java.lang.reflect.Method.invokeNative(Native Method)
01-15 05:20:40.472: I/dalvikvm(4513):   at java.lang.reflect.Method.invoke(Method.java:511)
01-15 05:20:40.472: I/dalvikvm(4513):   at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:1004)
01-15 05:20:40.472: I/dalvikvm(4513):   at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:771)
01-15 05:20:40.472: I/dalvikvm(4513):   at dalvik.system.NativeStart.main(Native Method)
01-15 05:20:40.472: A/libc(4513): Fatal signal 11 (SIGSEGV) at 0x00000be0 (code=1), thread 4513 (.speeddraw.lite)
01-15 05:20:40.472: A/libc(4513): Fatal signal 11 (SIGSEGV) at 0x00180500 (code=1), thread 4527 (.speeddraw.lite) 
```

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2014-03-26T21:47:48.320

以下 Google Plus 帖子解决了我的问题：

基本上，问题与 9 个补丁文件中的光学界限有关。就我而言，我使用的是从 Holo Theme 复制的较新的 9patches。[如链接](https://plus.google.com/app/basic/stream/z12hvl2qrlfgi32ly230hzyhbxjuhv4bk04?cbp=17db45gjvgibg&sview=27&cid=5&soc-app=115&soc-platform=1&spath=/app/basic/%2bRonaldAmmann/posts&sparm=cbp=1czn5ceohmorm&sview=28&cid=5&soc-app=115&soc-platform=1&spath=/app/basic/s/%252523iOS/related&sparm=cbp%253D10fyyjeg3e8eg%2526sview%253D28%2526sro%253D%252523Android,%252523Apps%2526sri%253D0%2526spath%253D/app/basic/s/%25252523Apple/related%2526sparm%253Dcbp%25253D17y6m56vixlno%252526sview%25253D28%252526sro%25253D%25252523iPhone%252526sri%25253D0%252526spath%25253D/app/basic/s%252526sparm%25253Dcbp%2525253D2sji81wiukb%25252526sview%2525253D28%25252526sq%2525253DiPhone%2525252B5%25252526sc%2525253Dpo)中所述，此新补丁在旧版本的 android 中无效

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2013-10-30T00:39:56.363

在我的情况下检查 OutofMemory 问题我在三星 S3 上收到此错误，并且用于在启动 Activity 上管理大量图像。我在没有解决方案的情况下搜索了很多响应，因为我根本没有 EditText 或输入（实际上，我不知道为什么错误**显示可扩展字符串零长度**......而不是像 OutOfMemory 这样的其他东西等），然后我意识到按分辨率排序的图像位于错误的文件夹中并且尺寸过大，并且在天空中堆积。祝你好运

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2013-04-11T06:55:15.603

确保您拥有资产目录下的所有资源图像。我遇到了这个问题，结果发现我的一张图片丢失了。一旦我将图像放回资产目录下，一切都很好。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2014-06-06T09:38:11.250

使用这个... options.headers = { "Connection":"close" };

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2016-06-13T15:30:23.307

以下内容对我来说可以摆脱 webview 中的错误：

```
webView.freeMemory(); 
```

或者

```
webView.clearCache(true); 
```

第二个选项会减慢您的应用程序。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2019-12-26T05:16:16.723

对我来说，问题出在 chrome webview 中。我禁用 chrome 并启用 Android webview。这对我来说可以。

# iphone - 如何在sqlite IPHONE中获得rowNum之类的列

> ID：14023292
> 
> 赞同：4
> 
> 时间：2012-12-24T15:46:48.057
> 
> 标签：iphone, objective-c, sql, oracle, sqlite

我有一个这样的 Sqlite 数据库表（***没有升序***）

![在此处输入图像描述](../Images/bab26dffa121267a9afa7e69d2b25d33.png)

但是我需要***按名称按升序***检索表，当我将其设置为升序时，rowId 以混乱的顺序更改如下

![在此处输入图像描述](../Images/224db7e9aef07c36487f6a487222a093.png)

但我每次都需要按升序检索一些**有限数量的联系人 5**

像**Aaa - Eeee**然后**Ffff- Jjjjj** ......

但是要设置 0-5 5-10 之类的限制 .... ** 它可以使用 rowid，因为它们的顺序是混乱的

所以**我需要另一列，如（oracle中的rowNum），其顺序为1234567 ...每次如下**

![在此处输入图像描述](../Images/6ceb614ead6c88e587ef400c9f5998f3.png)

如何使用现有列检索该列

**`Note: WE DONTE HAVE ROWNUM LIKE COLUMN IN SQLITE`**

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2013-10-05T15:09:20.950

假的 rownum 解决方案很聪明，但恐怕它不能很好地扩展（对于复杂的查询，你必须在每一行上加入并计算当前行之前的行数）。

我会考虑使用`create table tmp as select /*your query*/`. 因为在创建为选择操作的情况下，插入行时创建的 rowid 正是 rownum（计数器）。它由 SQLite 文档指定。

插入初始查询后，您只需查询 tmp 表：

```
select rowid, /* your columns */ from tmp
order by rowid 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-12-24T16:41:56.593

您可以使用偏移量/限制。

获取第一组、第二组和第三组五行：

```
select rowid, name from contactinfo order by name limit 0, 5
select rowid, name from contactinfo order by name limit 5, 5
select rowid, name from contactinfo order by name limit 10, 5 
```

警告，使用上述语法需要 SQLite 以排序顺序读取所有先前的记录。因此，要获取 SQLite 上面第 3 条语句的第 10 条记录，需要读取前 9 条记录。如果您有大量记录，从性能的角度来看，这可能会出现问题。

有关限制/偏移的更多信息：

[Sqlite 查询优化（使用 Limit 和 Offset）](https://stackoverflow.com/questions/12266025/sqlite-query-optimization-using-limit-and-offset)

[Sqlite LIMIT / OFFSET 查询](https://stackoverflow.com/questions/3325515/sqlite-limit-offset-query-doubt)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-12-24T16:00:46.210

这是一种伪造 RowNum 的方法，希望对您有所帮助：

```
SELECT 
   (SELECT COUNT(*)
    FROM Names AS t2
    WHERE t2.name < t1.name
   ) + (
      SELECT COUNT(*) 
      FROM Names AS t3 
      WHERE t3.name = t1.name AND t3.id < t1.id
   ) AS rowNum,
   id,
   name
FROM Names t1
ORDER BY t1.name ASC 
```

[SQL 小提琴示例](http://sqlfiddle.com/#!7/011cd/1)

# java - 使用来自 Node.js 服务器的 Java 代码

> ID：14023293
> 
> 赞同：-5
> 
> 时间：2012-12-24T15:46:50.750
> 
> 标签：java, node.js

我有一个执行一些计算的繁重 Java 应用程序。我希望我的 Node.js 应用程序使用该应用程序。我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-24T15:50:03.210

您可以将 Java 计算公开为 Web 服务并对它进行 Ajax 调用。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-24T16:01:07.170

我认为你需要 nodejs[插件](http://nodejs.org/api/addons.html)

# struts - 使用 struts 的复选框

> ID：14023295
> 
> 赞同：4
> 
> 时间：2012-12-24T15:46:59.527
> 
> 标签：struts

嗨，我愿意更新从数据库中获取并加载到 JSP 上的复选框的值。我正在创建员工资料。Jsp 具有员工姓名、员工地址、员工技术技能等字段。员工技能具有以下复选框以选择以下值

复选框 1：Java 复选框 2：点网

对于员工 X，在数据库中不具备 Java 和 Dot net 的计算技能。我能够从数据库中获取记录到 JSP。

在动作类中，我从数据库中获取值并将它们设置到具有两个 getter 和 setter 的 EmployeeForm 中。我也在使用 setattribute 在请求中设置这些值。

在 EmployeeUpdate.jsp 我正在执行以下操作

```
String skillsValue1=(String)request.getAttribute("C/C++");
String skillsValue2=(String)request.getAttribute("Java");

 <%if(skillsValue1!=null){ %>
         <html:checkbox property="ComputationalSkill1" value="C/C++"/>                     
           <%}else{ %>
              <html:checkbox property="ComputationalSkill1" value=" "/>  
                 <%}%>
            </td>          

<%if(skillsValue2!=null){ %>
         <html:checkbox property="ComputationalSkill2" value="Java"/>                     
           <%}else{ %>
              <html:checkbox property="ComputationalSkill2" value=" "/>  
                 <%}%>
            </td> 
```

以下代码完美地为具有上述任何技能和没有技能的员工显示了复选框。

我在这里遇到以下问题

1.  当我取消选中之前检查过的任何字段上的值时，该值在 bean 中完美地设置为 null。但是，当我检查之前未检查的任何字段上的值时（更新任何字段），在 bean 中没有为特定属性设置值，也没有 null。

谁能让我知道如何获取复选框的更改值，即当我将状态从取消选中更改为检查状态时，应该在属性中设置该值。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-24T16:49:19.357

如果员工具有 Java 技能，您将显示以下复选框：

```
<html:checkbox property="ComputationalSkill2" value="Java"/> 
```

这意味着在提交时，如果选中该复选框，将发送以下参数：

```
ComputationalSkill2=Java 
```

如果员工没有 Java 技能，您将显示以下复选框：

```
<html:checkbox property="ComputationalSkill2" value=" "/> 
```

这意味着在提交时，如果选中该复选框，将发送以下参数：

```
ComputationalSkill2=<blank space> 
```

您想要的是始终生成相同的复选框（第一个），但如果员工具有 Java 技能，则预选它，如果员工没有 Java 技能，则不要预选它。

这在使用标签时是不可能的`<html:checkbox>`，因为它应该绑定到一个布尔属性。所以你可以在你的表单bean中有一个属性`isJavaSkilled()`/ ，并使用`setJavaSkilled()`

```
<html:checkbox property="javaSkilled"/> 
```

如果表单的 javaSkilled 属性为真，Struts 将预先选中复选框，如果为假，则不选中它。

但是请注意，由于您有一个可以存在或不存在的技能列表，因此您应该拥有type的属性`getSkills()`/并使用标签。`setSkills()``String[]``<html:multibox>`

# jquery - 将一个事件侦听器更改为另一个？

> ID：14023304
> 
> 赞同：0
> 
> 时间：2012-12-24T15:48:23.663
> 
> 标签：jquery

我是 jquery 的新手，我想知道是否可以使用 jquery 将所有点击事件（对于特定 div 中的元素）更改为双击事件？提前谢谢了。

```
function isTouchDevice(){
  return (typeof(window.ontouchstart) != 'undefined') ? true : false;
}
if(isTouchDevice()===true){
     //change click events to doubleclick events
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-24T15:51:58.560

观看这个魔术：

```
$('*').each(function(){
   var click = $(this).data('events').click;
   if(click[0]) { //check if there is a click handler attached 
       $(this).on('dblclick', click[0].handler).off('click');
   }
}); 
```

以上将遍历页面上的**每个**元素并将其单击处理程序移动到其 dblclick 处理程序。

`*`通常不建议使用。我会尝试只选择所有具有点击选择器的元素并通过它们。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-24T15:51:41.087

当然是...

```
function yourClickHandler(event) {
    // here you can check for click or dblclick as so...
    if (event.type == 'dblclick') { /* handle dblclick specific stuff */ }
    else if (event.type == 'click') { /* handle normal click specific stuff */ }
}

$(document).ready(function() {
    if (isTouchDevice()) {
        $('div#SPECIFIC_DIV *').on('dblclick', yourClickHandler);
    }
    else {
        $('div#SPECIFIC_DIV *').on('click', yourClickHandler);
    }
}); 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-12-24T15:53:58.573

试试这个：

```
$('#target').click(function() {
    if(isTouchDevice == true) {
      $('#target').dblclick();
    }
}); 
```

# windows-xp - 嵌入式 xp 的时钟漂移

> ID：14023309
> 
> 赞同：0
> 
> 时间：2012-12-24T15:48:59.417
> 
> 标签：windows-xp, embedded, system-clock, drift

我在我的机器上使用 Windows XP Embedded，它是从备份映像安装的。最近，我在我的机器上检测到系统时钟漂移。这种漂移非常大（每 5 分钟一秒钟）。这种漂移不是永久性的，它在每次启动时随机发生。但是，如果设备启动时出现漂移，它将一直停留到下一次启动。另一个重要的事情是，在启动时，单元每次都以 0 延迟启动，例如：

1.  启动装置。
2.  世界时间为 12:00:00.00，单位时间为 12:00:00.00。
3.  等待 10 分钟。
4.  世界时间为 12:10:00.00，单位时间为 12:09:58.00。
5.  关闭设备
6.  启动装置。
7.  世界时间为 12:15:00.00，单位时间为 12:15:00.00。

时钟无法同步。

我安装了常规 XP（未嵌入）并且没有出现漂移。有人可以帮助我找到问题的根本原因以及如何在 Embedded XP 上解决问题吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-24T19:19:31.180

许多系统会在启动时将操作系统的时钟与系统硬件时钟同步，然后在之后纯粹以软件的形式维护系统时间。看起来正在发生的事情是 Windows Embedded 正在这样做，但软件时钟正在漂移——而 Windows XP 定期将软件时钟与硬件时钟同步。

即使您不能使用与外部时间服务器的时间同步，仍然应该有办法让 Windows Embedded 使用硬件时钟。

# c# - Programming the start time of the execution of the method - 在那个时间开始执行的方法

> ID：14023313
> 
> 赞同：0
> 
> 时间：2012-12-24T15:49:22.960
> 
> 标签：c#, asp.net-mvc

我的程序中有一个方法可以执行很长时间。所以，我希望它在晚上执行，或者在用户不使用应用程序的时候执行。

用户将在文本框中输入时间和日期，我将该值保存在数据库中。

假设用户输入`27th December 2012, midnight.`

我希望该`Example()`方法在那个确切的时间开始执行。

有没有办法对此进行编程？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-24T16:06:30.097

您可能应该查看用于**作业调度**的现有库，例如[Quartz](http://quartznet.sourceforge.net/)。特别是如果您打算进行递归作业。

Quartz 可以嵌入到现有应用程序中，也可以作为独立应用程序单独运行。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-24T15:54:16.880

有多种选择，你发现了什么？

例如，您可以通过 Windows 任务计划程序运行任务，或者运行一项服务，定期检查是否已接近启动特定任务的时间，如果是，则执行此操作。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-24T19:27:24.930

正如@Ulises 提到的，您可以使用作业调度程序，或者如果可以分离该任务的逻辑，则可以使用 Windows 调度程序。但是，如果您需要在程序中执行此操作，那只是编码问题；首先是主管方法：

```
static void Supervisor()
{
    while (true)
    {
        DateTime time = ReadTimeFromFile();

        if (Math.Abs((DateTime.Now - time).TotalMinutes) <= 1)
        {
            DeleteTimeFile(); // to indicate task is done

            RunTask();

            break;
        }

        Thread.Sleep(TimeSpan.FromSeconds(5));
    }
} 
```

然后将目标时间写入文件。在您的程序开始时（或其他适当的地方）：

```
new Task(Supervisor, TaskCreationOptions.LongRunning).Start(); 
```

使用 TaskCreationOptions.LongRunning 选项在 ThreadPool 之外为此初始化一个单独的线程非常重要。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-24T15:54:21.957

创建一个 System.Timers.Timer 对象。计算用户输入的时间减去当前时间（以毫秒为单位）。将该时间传递给计时器的构造函数，并将您的方法作为其 Elapsed 事件处理程序。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-12-24T15:55:10.963

尝试这个：

```
if (DateTime.Now == your time)
{
    // do your process
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-12-24T15:55:49.567

您在这里有几个选项 - 您可以拥有一个轮询数据库以执行工作的服务，以及何时执行 Example 方法。您可以以编程方式创建一个 Windows 计划任务，这样您就不需要轮询。

然而，MVC 中没有任何方法可以提前这么久获得定时回调。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-12-24T15:55:58.767

您可以在延迟一段时间后使用[Threading.Timer](http://msdn.microsoft.com/en-us/library/ah1h85ch.aspx)启动您的方法：

```
DateTime date = // when you need method to run
TimeSpan dueTime = date - DateTime.Now;
Timer timer = new Timer(_ => Example(), null, dueTime, new TimeSpan(0)); 
```

您可以指定`TimeSpan(24, 0, 0)`每天执行方法的时间段。

# java - 在 Ubuntu 中安装 Clojure 时生成错误。

> ID：14023317
> 
> 赞同：1
> 
> 时间：2012-12-24T15:50:02.477
> 
> 标签：java, clojure

```
Unable to find a javac compiler;
com.sun.tools.javac.Main is not on the classpath.
Perhaps JAVA_HOME does not point to the JDK.
It is currently set to "/usr/lib/jvm/java-6-openjdk-i386/jre" 
```

呃..但它指向一个JDK，这里是open-JDK。我在这里错过了什么吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-02T23:08:33.063

忽略所有建议添加/设置 JAVA_HOME 目录的解决方案，它们是错误的。如果您的 .profile 等中有一组，请将其删除。

Ubuntu（和许多其他发行版，尤其是基于 debian 的发行版）使用“替代”机制来提供更高级别的抽象来处理诸如同一软件的多个版本或提供相同功能的多个软件包之类的事情，例如网络浏览器。

Ubuntu 不需要 JAVA_HOME 设置，前提是您让操作系统及其打包系统管理您的环境。如果您手动安装东西，那么您需要自己解决。

我怀疑最初您只安装了 JRE，然后您尝试通过添加 JAVA_HOME 设置来解决您的问题，然后安装了所需的 JDK。如果是这种情况，请删除您的 JAVA_HOME 设置，然后使用 update-alternatives 命令确保已设置正确的 java 环境（有关详细信息，请参阅 update-alternatives 的手册页 - 非常简单）。

使用 lein 的建议是 IMO 现场，我还建议使用脚本而不是打包版本。我还建议使用 2.0 预览版。与旧的 1.x 版本相比，它非常稳定并且是一个更好的起点。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-24T15:55:34.680

删除路径中的 jre 部分。这应该够了吧。

它会变成

```
"/usr/lib/jvm/java-6-openjdk-i386" 
```

正如布赖恩建议的那样尝试

```
sudo apt-get install openjdk-7-jdk 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-24T19:15:10.397

您可以只安装 leiningen（与 Ubuntu 一起打包）。这将为您提供一个很好的项目工具来使用 Clojure。它会在每个包的基础上为您引导和拉取 clojure，这也意味着您拥有多个版本。

# javascript - 如何从 TinyMCE 编辑器中提取 HTML 内容

> ID：14023323
> 
> 赞同：18
> 
> 时间：2012-12-24T15:50:36.177
> 
> 标签：javascript, tinymce

我是 Javascript/TinyMCE 的初学者，我试图了解如何从编辑器中获取 HTML 内容，并使用简单的 alert() 函数显示它。

我的 HTML 页面上有这个极简配置：

```
<div id="tiny">
<script type="text/javascript">
tinyMCE.init({
        // General options
        mode : "specific_textareas",
        editor_selector : "mceEditor"
});
</script>
</div>

<form method="post" action="somepage">
        <textarea id="myarea1" class="mceEditor">This will be an editor.</textarea>
</form> 
```

在[TinyMCE 网站](http://www.tinymce.com/wiki.php/API3:method.tinymce.Editor.getContent)上，他们解释说我必须使用这个：

```
// Get the HTML contents of the currently active editor
console.debug(tinyMCE.activeEditor.getContent()); 
```

这里也是[_](https://stackoverflow.com/questions/11503320/how-to-get-the-html-code-from-tinymce-editor-using-php-javascript)

```
tinymce.activeEditor.getContent() 
```

我不知道为什么它不起作用

有人有想法吗？

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2012-12-24T16:56:18.317

**我不知道为什么它不起作用**

它不起作用，因为

```
console.debug(tinyMCE.activeEditor.getContent());

tinymce.activeEditor.getContent(); 
```

这些语句没有被执行。

尝试跟随这个[FIDDLE](http://fiddle.tinymce.com/e5caab) ....

```
tinyMCE.init({
        // General options
        mode : "specific_textareas",
        editor_selector : "mceEditor"
}); 
```

获取内容的功能......

```
function get_editor_content() {
  // Get the HTML contents of the currently active editor
  console.debug(tinyMCE.activeEditor.getContent());
  //method1 getting the content of the active editor
  alert(tinyMCE.activeEditor.getContent());
  //method2 getting the content by id of a particular textarea
  alert(tinyMCE.get('myarea1').getContent());
} 
```

单击按钮获取编辑器的内容...

```
<button onclick="get_editor_content()">Get content</button> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-24T15:57:11.877

也许是这样？您的变量是，`tinyMCE`但您正在调用`getContent()`。`tinymce`JS 区分大小写 ;)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-08-23T18:43:40.470

我一直在寻找解决方案并尝试了上述一些方法，然后在 tinymce 文档中查找更多内容，发现这很有效。
***使用微型 mce 4***

```
function getHTML()
{
   tinymce.activeEditor.on('GetContent', function(e) {
     console.log(e.content);
   });
} 
```

**只需通过单击调用该函数并查看结果是什么...**
我的来源是： [http ://www.tinymce.com/wiki.php/api4:class.tinymce.ContentEvent](http://www.tinymce.com/wiki.php/api4:class.tinymce.ContentEvent)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2017-11-07T04:05:31.100

TinyMCE 创建一个格式为 '#textareaid'+'_ifr' 的 iframe 所以通过使用 jquery 我们可以查询到你喜欢的文本区域的 HTML 内容

iframe id 将是您的 textarea Id，并附加了“_ifr”。所以你可以从 tinyMce 中提取 HTML 内容

```
$('#textareaId_ifr').contents().find("html").html(); 
```

# regex - 如何在正则表达式中捕获非常规字符？

> ID：14023327
> 
> 赞同：3
> 
> 时间：2012-12-24T15:51:04.360
> 
> 标签：regex

我正在尝试使用正则表达式捕获此文本块：

> ¡¾Ìá¡¿#/¡¾¹©¡¿/¸÷/¡¡/Òµ/¡¾°l¡¿*/¡¾Æ±¡¿¡£ µç»°13534018113ÕÅÉú ¾´Çë±£Áô•½±ãÁªÏµ</ p>

我使用`[^a-zA-Z]+`了我希望应该涵盖换行符和空格的内容。不是这种情况。我不知道为什么。有没有被 az 或 AZ 覆盖的特殊字符？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-24T16:12:15.553

您需要将单行修饰符与您使用的任何语言一起使用。下次加个标签。

这是 PCRE 的工作正则表达式：`/[^a-z]+/gis`

演示+说明：[http ://regex101.com/r/pA4dG2](http://regex101.com/r/pA4dG2)

# javascript - 基于浏览器的带有自动完成功能的 Javascript/CSS 编辑器

> ID：14023328
> 
> 赞同：5
> 
> 时间：2012-12-24T15:51:08.080
> 
> 标签：javascript, css, autocomplete, editor

有人知道基于浏览器的编辑器具有 Javascript 和 CSS 自动完成功能吗？我知道打字稿（http://www.typescriptlang.org/Playground/），但想要更完整的东西。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-24T15:53:34.237

### 查看代码镜像

> **CodeMirror**是一个在浏览器中提供代码编辑器的 JavaScript 组件。当一种模式可用于您编码的语言时，它将为您的代码着色，并可选择帮助缩进。
> 
> 丰富的编程 API 和 CSS 主题系统可用于自定义 CodeMirror 以适应您的应用程序，并使用新功能对其进行扩展。

### 更多信息：[http ://codemirror.net/](http://codemirror.net/)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-24T16:22:17.180

Cloud9 IDE 也很漂亮。[https://c9.io/](https://c9.io/)

# android - 如何在我的列表视图上设置自定义字体？

> ID：14023329
> 
> 赞同：4
> 
> 时间：2012-12-24T15:51:15.190
> 
> 标签：android, listview, sdk, fonts

我无法在列表视图上设置字体，字体仅适用于文本视图。有什么方法可以轻松设置自定义字体？谢谢你。

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-12-24T15:58:11.747

您可以为列表视图创建一个适配器，并在那里的 TextView 上设置字体类型。

这是一个适配器的剪辑（它在 C# 中，但与 Java 没有太大区别）：

```
 class ParcelRecordContactAdapter : ArrayAdapter<ParcelRecordContact>
    {
        List<ParcelRecordContact> contacts;

        public ParcelRecordContactAdapter(Context context, int textViewResourceId, List<ParcelRecordContact> contacts)
            : base(context, textViewResourceId, contacts)
        {
            this.contacts = contacts;
        }

        public override View GetView(int position, View convertView, ViewGroup parent)
        {
            View v = convertView;

            if (v == null)
            {
                LayoutInflater li = (LayoutInflater)this.Context.GetSystemService(Context.LayoutInflaterService);

                v = li.Inflate(Resource.Layout.ListItem_SingleLine, null);
            }

            ParcelRecordContact contact = contacts[position];

            if (contact != null)
            {
                /**********************************************************
                 * change font on tv here
                 **********************************************************/

                TextView tv = (TextView)v.FindViewById(Resource.Id.tv_single_line_list_item_1);

                if (tv != null)
                {                        
                    tv.Text = "android is fu.... n"

                    Typeface tf = Typeface.createFromAsset(getAssets(), "fonts/DroidSansFallback.ttf");

                    tv.setTypeface(tf);
                }
            }

            return v;
        }
    } 
```

# solr - Apache Solr 索引和过滤查询

> ID：14023332
> 
> 赞同：4
> 
> 时间：2012-12-24T15:51:45.657
> 
> 标签：solr, lucene

我需要一些关于 Solr 索引的信息，但我找不到。我想知道是否必须对我只想应用过滤器查询的字段进行索引，或者将它们标记为已存储就足够了。

提前致谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-25T12:29:48.173

您可以参考可以免费下载的 lucidworks solr 参考指南。

字段属性和用例映射表：-

![在此处输入图像描述](../Images/8922f27ab8620a3cf1f067e9d5d6dec6.png)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-25T00:42:54.607

是的，它必须被索引。它不需要存储。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-25T07:36:21.840

存储和索引在 Solr 上是完全不同的概念。如果要对字段进行查询，则应设置**indexed=true**。如果您还想在查询时检索数据，则应设置**stored=true**。

所以，对于你的问题；是的，如果你想进行查询，你应该设置**indexed=true 。**

# python - QCompleter 带有任何数据模型会导致Segmentation fault 吗？

> ID：14023336
> 
> 赞同：0
> 
> 时间：2012-12-24T15:52:03.643
> 
> 标签：python, qt, qt4, pyqt

我创建`QCompleter`s for `QLineEdit`，如果子类中没有动态定义的函数/方法，它工作正常（尝试使用`./bugCompleterFilesysModel.py n`n in运行脚本`[0, 1, 2, 9]`，然后尝试通过删除 LineEdit 框中的一些字符来显示完成者）。`QCompleter`可以与`QStringList`、`QStringListModel`和一起使用`QFileSystemModel`。

`QCompleter`如果我使用of simple在子类中添加一些动态定义的函数/方法`QStringList`，则实例也可以正常工作（尝试使用`./bugCompleterFilesysModel.py n`n in运行脚本`[10, 20, 30]`，然后尝试通过删除 LineEdit 框中的一些字符来显示完成者）。

但是，如果我动态定义任何函数/方法，具有任何类型数据模型的 QCompleter 在关闭 GUI 窗口期间将引发错误：

```
QObject::startTimer: QTimer can only be used with threads started with QThread
Segmentation fault 
```

要重复错误，请尝试使用`./bugCompleterFilesysModel.py mn`m in `[1,2,3]`、 n in运行脚本`[1, 2, 9]`，然后尝试通过删除 LineEdit 框中的一些字符来调出完成程序，然后关闭窗口。

谁能告诉我这是为什么以及如何解决？我已经挠头好几个小时了。提前谢谢！

完整脚本`bugCompleterFilesysModel.py`：

```
#!/usr/bin/env python
# -*- coding: UTF-8 -*-
class MyBaseWidget(QtGui.QWidget):
    dirChanged=QtCore.pyqtSignal(QtCore.QString)
    def __init__(self,parent=None,addfunc0=False,*args,**kwargs):
        super(MyBaseWidget, self).__init__(parent)
        self.addfunc0=addfunc0
        self.func0=None
        self.dummyWgt=1
        self.initUI()

    def initUI(self,*args,**kwargs):
        addfunc0=self.addfunc0
        if addfunc0 == 1:
            self.func0=self.funcFactory0('1')
            _func0str="self.funcFactory0('1')"
        if addfunc0 == 2:
            self.func0=self.funcFactory1('1')
            _func0str="self.funcFactory1('1')"
        if addfunc0 == 3:
            self.func0=self.funcFactory1b()
            _func0str="self.funcFactory1b()"

        if addfunc0 > 0:
            #print self.printWgt
            print 'use %s as func0'%(_func0str)
            print 'self.func0 = %s'%(self.func0)
            self.func0()

        self.show()

    def printWgt(self,wgt0):
        print 'Input obj is:', wgt0.__class__.__name__

    def funcFactory0(self,wgt0):
        def _func():
            self.printWgt(wgt0)
        return _func

    def funcFactory1(self,wgt0):
        import types
        def _func(self):
            self.printWgt(wgt0)
        return types.MethodType(_func,self,mainWidget)

    def funcFactory1b(self):
        import types
        def _func(self):
            self.printWgt(self.dummyWgt)
        return types.MethodType(_func,self,mainWidget)

class StringWidget(MyBaseWidget):
    dirChanged=QtCore.pyqtSignal(QtCore.QString)
    def initUI(self,*args,**kwargs):
        currdir=r'/tmp'
        self.currdir=currdir
        self._tb=[]

        completer=QtGui.QCompleter(QtCore.QStringList(['/tmp/'+i for i in 'abcdefg']), parent=self)
        completer.setMaxVisibleItems(5)
        self.completer=completer

        _tb=QtGui.QLineEdit(currdir)
        _tb.setCompleter(completer)

        theLayout=QtGui.QHBoxLayout(self)
        theLayout.addWidget(_tb)
        self._tb=_tb

        MyBaseWidget.initUI(self,*args,**kwargs)

class StringModelWidget(MyBaseWidget):
    dirChanged=QtCore.pyqtSignal(QtCore.QString)
    def initUI(self,*args,**kwargs):
        currdir=r'/tmp'
        self.currdir=currdir
        self._tb=[]

        fsModel=QtGui.QStringListModel(['/tmp/'+i for i in 'abcdefg'])
        self.fsModel=fsModel
        #self.fsModel.setParent(self)

        completer=QtGui.QCompleter()
        completer.setMaxVisibleItems(5)
        completer.setModel(fsModel)
        self.fsModel.setParent(completer)
        self.completer=completer

        _tb=QtGui.QLineEdit(currdir)
        _tb.setCompleter(completer)

        theLayout=QtGui.QHBoxLayout(self)
        theLayout.addWidget(_tb)
        self._tb=_tb

        MyBaseWidget.initUI(self,*args,**kwargs)

class FileModelWidget(MyBaseWidget):
    dirChanged=QtCore.pyqtSignal(QtCore.QString)

    def initUI(self,*args,**kwargs):
        currdir=r'/tmp'
        self.currdir=currdir
        self._tb=[]

        fsModel=QtGui.QFileSystemModel(parent=self)
        fsModel.setRootPath('')
        fsModel.setFilter(QtCore.QDir.AllDirs|QtCore.QDir.Dirs)
        self.fsModel=fsModel
        #self.fsModel.setParent(self)

        completer=QtGui.QCompleter(parent=self)
        completer.setMaxVisibleItems(5)
        completer.setModel(fsModel)
        self.fsModel.setParent(completer)
        self.completer=completer

        _tb=QtGui.QLineEdit(currdir)
        _tb.setCompleter(completer)

        theLayout=QtGui.QHBoxLayout(self)
        theLayout.addWidget(_tb)
        self._tb=_tb

        MyBaseWidget.initUI(self,*args,**kwargs)

class mainWidget(MyBaseWidget):

    def initUI(self,*args,**kwargs): 

        self.mainLayout=QtGui.QVBoxLayout(self)
        self.wgts=[]

        _wgt0=StringWidget(self)
        self.wgts.append(_wgt0)

        _wgt1=StringModelWidget(self)
        self.wgts.append(_wgt1)

        _wgt2=FileModelWidget()
        self.wgts.append(_wgt2)

        for _w in self.wgts:
            print _w
            self.mainLayout.addWidget(_w)
        MyBaseWidget.initUI(self,*args,**kwargs)

def main():
    app = QtGui.QApplication(sys.argv)
    argv=sys.argv
    mainWgt = None
    if len(argv)>1:
        nwgt = int(sys.argv[1])
        _addfunc0=nwgt/10
        _nwgt=nwgt-_addfunc0*10
        print _nwgt,_addfunc0
        if _nwgt == 0:
            _MainWgt=StringWidget

        if _nwgt == 1:
            _MainWgt=StringModelWidget

        if _nwgt == 2:
            _MainWgt=FileModelWidget

        if _nwgt == 9:
            _MainWgt=mainWidget
        print 'use %s as main widget'%(_MainWgt.__name__)
        mainWgt=_MainWgt(addfunc0=_addfunc0)
    else:
        mainWgt = mainWidget(addfunc0=0)

    if mainWgt:
        sys.exit(app.exec_())

if __name__ == '__main__':
    main() 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-26T11:10:12.093

这可能与删除顺序有关。

尝试将 设置`QLineEdit`为 的父级`QCompleter`，以便它被删除`QLineEdit`而不是在它之前被删除。

# php - html/php 评论框不发送电子邮件

> ID：14023341
> 
> 赞同：1
> 
> 时间：2012-12-24T15:52:39.557
> 
> 标签：php, forms, email

我有一个简单的 html 表单，它向一个 php 文件发送请求，该文件又应该发送一封电子邮件。对 php 文件的请求有效，并显示确认文本，但未发送电子邮件。

我真的被卡住了，无法弄清楚为什么没有发送电子邮件。他们对我的php有任何问题吗？

**HTML**

```
<form name="htmlform" method="post" action="html_form_send.php">
    <table width="450px">
     </tr>
     <tr>
     <td valign="top">
         <label for="first_name">First Name *</label>
     </td>
     <td valign="top">
       <input  type="text" name="first_name" maxlength="50" size="30">
     </td>
        </tr>

       <tr>
       <td valign="top">
           <label for="last_name">Last Name *</label>
       </td>
       <td valign="top">
          <input  type="text" name="last_name" maxlength="50" size="30">
       </td>
       </tr>
        <tr>
        <td valign="top">
             <label for="email">Email Address *</label>
        </td>
        <td valign="top">
              <input  type="text" name="email" maxlength="80" size="30">
        </td>

         </tr>
         <tr>
         <td valign="top">
             <label for="telephone">Estimated Quantity</label>
         </td>
          <td valign="top">
                <input  type="text" name="telephone" maxlength="30" size="30">
          </td>
          </tr>
         <tr>
          <td valign="top">
                <label for="comments">Product wanted for import *</label>
          </td>
          <td valign="top">
               <textarea  name="comments" maxlength="1000" cols="25" rows="6">  
           </textarea>
          </td>

          </tr>
           <tr>
           <td colspan="2" style="text-align:center">
               <input type="submit" value="Submit"> 
           </td>
           </tr>
    </table>
 </form> 
```

**PHP**

```
<?php
if(isset($_POST['email'])) {

    $email_to = "jplustradingltd@gmail.com";

    $email_subject = "J Plus Trading Website Query";

    function died($error) {
        // your error code can go here
        echo "We are very sorry, but there were error(s) found with the form you submitted. ";
        echo "These errors appear below.<br /><br />";
        echo $error."<br /><br />";
        echo "Please go back and fix these errors.<br /><br />";
        die();
    }

    // validation expected data exists
    if(!isset($_POST['first_name']) ||
        !isset($_POST['last_name']) ||
        !isset($_POST['email']) ||
        !isset($_POST['telephone']) ||
        !isset($_POST['comments'])) {
        died('We are sorry, but there appears to be a problem with the form you submitted.');       
    }

    $first_name = $_POST['first_name']; // required
    $last_name = $_POST['last_name']; // required
    $email_from = $_POST['email']; // required
    $telephone = $_POST['telephone']; // not required
    $comments = $_POST['comments']; // required

    $error_message = "";
    $email_exp = '/^[A-Za-z0-9._%-]+@[A-Za-z0-9.-]+\.[A-Za-z]{2,4}$/';
  if(!preg_match($email_exp,$email_from)) {
    $error_message .= 'The Email Address you entered does not appear to be valid.<br />';
  }
    $string_exp = "/^[A-Za-z .'-]+$/";
  if(!preg_match($string_exp,$first_name)) {
    $error_message .= 'The First Name you entered does not appear to be valid.<br />';
  }
  if(!preg_match($string_exp,$last_name)) {
    $error_message .= 'The Last Name you entered does not appear to be valid.<br />';
  }
  if(strlen($comments) < 2) {
    $error_message .= 'The Comments you entered do not appear to be valid.<br />';
  }
  if(strlen($error_message) > 0) {
    died($error_message);
  }
    $email_message = "Form details below.\n\n";

    function clean_string($string) {
      $bad = array("content-type","bcc:","to:","cc:","href");
      return str_replace($bad,"",$string);
    }

    $email_message .= "First Name: ".clean_string($first_name)."\n";
    $email_message .= "Last Name: ".clean_string($last_name)."\n";
    $email_message .= "Email: ".clean_string($email_from)."\n";
    $email_message .= "Telephone: ".clean_string($telephone)."\n";
    $email_message .= "Comments: ".clean_string($comments)."\n";

// create email headers
$headers = 'From: '.$email_from."\r\n".
'Reply-To: '.$email_from."\r\n" .
'X-Mailer: PHP/' . phpversion();
@mail($email_to, $email_subject, $email_message, $headers);  
?>

<!-- place your own success html below -->

Thank you for contacting us. We will be in touch with you very soon.

<?php
}
die();
?> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-30T06:40:16.807

从这里下载上传表单的插件：http: [//phpfileuploader.com/](http://phpfileuploader.com/)

# c - C中的不完整类型“结构”错误

> ID：14023345
> 
> 赞同：2
> 
> 时间：2012-12-24T15:53:01.670
> 
> 标签：c, pointers, struct

我有这个问题，看不到错误在哪里，所以我希望有人可以帮助解决它。我从编译源代码得到的错误是：

```
client.c:15:54: error: invalid application of ‘sizeof’ to incomplete type ‘struct client’ 
```

我在头文件-client.h中有结构定义：

```
#ifndef PW_CLIENT
#define PW_CLIENT

#include <event2/listener.h>
#include <event2/bufferevent.h>
#include <event2/buffer.h>

#include <arpa/inet.h>

#include <stdlib.h>
#include <stdio.h>
#include <errno.h>

struct client {
    int id;
    struct bufferevent *bev;

    struct client *prev;
    struct client *next;
};

struct client *client_head = NULL;

struct client* client_connect(struct bufferevent *bev);
#endif 
```

这是client.c的来源：

```
#include <event2/listener.h>
#include <event2/bufferevent.h>
#include <event2/buffer.h>

#include <arpa/inet.h>

#include <stdlib.h>
#include <stdio.h>
#include <errno.h>

struct client* client_connect(struct bufferevent *bev) {
    // Client info
    struct client *c = (struct client*)malloc(sizeof(struct client));
    if (c == NULL) {
        // error allocating memory
    } else {
    if (client_head == NULL) {
        // initialize list addresses
        c->prev = c->next = NULL;

        // set connection id
        c->id = 0;
    } else {
        // set list addresses
        client_head->next = c;
        c->prev = client_head;
        c->next = NULL;
        client_head = c;

        // set connection id
        c->id = (c->prev->id + 1);
    }

        // initialize user vars
        c->bev = bev;
    }

    return c;
} 
```

谢谢！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-24T15:54:45.977

您忘记了`#include "client.h"`，所以 的定义在 中`struct client`是未知的`client.c`，因此`struct client`表示那里的类型不完整。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-24T15:54:58.690

抱歉，但您需要包含 client.h，编译器只编译他被告知的内容...

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-24T15:59:00.757

我没看到

```
#include "client.h" 
```

在你的 .c 文件中

# javascript - 评估后保留上下文

> ID：14023347
> 
> 赞同：1
> 
> 时间：2012-12-24T15:53:15.130
> 
> 标签：javascript

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-24T16:11:35.117

这与 eval 无关。当你说

```
foo(); 
```

`this`inside foo 将*始终*是全局对象（除非该函数是用`bind`-- 见下文）。你有几个选择：

您可以使用“预设”此值`bind`

```
//won't work on IE8 - will have to shim `bind`
var foo = eval('func.foo.bind(func)'); 
```

[更新的小提琴](http://jsfiddle.net/Neb9E/1/)

`this`或者您可以在调用函数时手动设置值`call`

```
var foo = eval('func.foo');
foo.call(func); 
```

[更新的小提琴](http://jsfiddle.net/Neb9E/2/)

* * *

是的，正如 nbrooks 所说，应该不鼓励使用 eval 。

# android - 如何验证 Web 服务调用的来源

> ID：14023348
> 
> 赞同：17
> 
> 时间：2012-12-24T15:53:20.197
> 
> 标签：android, web-services, security, windows-phone-7, cryptography

假设您有一个使用 SOAP 连接您的后端的移动应用程序（Windows Phone 或 Android）。

为了简单起见，假设我们有一个用 C# 实现的 Web 服务。服务器公开以下方法：

```
[WebMethod]
public string SayHallo() { return "Hallo Client"; } 
```

从服务器的角度来看，您无法判断调用者是您的移动应用程序还是试图调试您的 Web 服务的开发人员，还是试图逆向工程/利用您的后端的黑客。

如何确定 Web 服务调用的来源是应用程序？因为任何拥有 WSDL 的人都可以调用 WS。

我知道我可以对 Web 服务实施一些标准的安全措施，例如：

*   在服务器上实施 HTTPS，以便消息加密传输并降低窃听的危险。
*   使用摘要/散列算法在客户端对请求进行签名，在服务器中验证签名并拒绝未正确签名的消息。
*   在 HTTP 请求中写入自定义标头。无论如何，可以模拟标题。

但是，任何经验丰富的黑客或知道签名算法的开发人员仍然可以生成签名良好、格式化良好的消息。或者一个真正优秀的黑客可以拆解应用程序并获得我的“绝密”通信协议的隐藏知识。

任何想法如何使 SayHallo() 方法只回答从我的移动应用程序发出的请求？

我们在移动应用程序的上下文中运行，通过硬件访问，可以利用硬件功能完成一些事情。

如果有人想知道，我正在考虑如何使移动应用程序对银行等敏感应用程序足够安全。

谢谢你的想法。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-12-24T16:24:56.630

您所描述的是双向身份验证。它只能通过在通信双方存储签名的公钥（证书）来完成。这意味着每个应用程序都需要使用您的服务器公钥对您的服务器进行身份验证，并且服务器需要对您的应用程序的每个实例进行身份验证。应用程序的公钥将需要在部署时与应用程序的每个实例一起生成并存储在服务器上。将此视为 2 路 HTTPS，通常唯一需要完成的身份验证是一个方向，浏览器使用受信任的签名密钥对服务器进行身份验证。在您的情况下，这需要在双方都完成。通常你会有一个像 VeriSign 这样的服务签署一个公钥的每个实例，这对于一个应用程序的多个部署来说可能会变得非常昂贵。在您的情况下，您可以使用诸如 OPENSSL 之类的东西创建一个内部签名应用程序，以便在每次分发您的应用程序时对其进行签名。这并不意味着有人仍然无法破解您的代码并在应用程序端提取签名密钥。一般来说，任何代码都可能被黑客入侵，问题只是在他们放弃之前你能做到多难？如果您要走自定义硬件路线，那么加密芯片和 TMP 之类的东西可以用作密钥，使人们更难访问设备上的私钥。只是一个问题，在他们放弃之前你能做到多难？如果您要走自定义硬件路线，那么加密芯片和 TMP 之类的东西可以用作密钥，使人们更难访问设备上的私钥。只是一个问题，在他们放弃之前你能做到多难？如果您要走自定义硬件路线，那么加密芯片和 TMP 之类的东西可以用作密钥，使人们更难访问设备上的私钥。

一个快速的谷歌搜索出现了以下内容：

[http://www.codeproject.com/Articles/326574/An-Introduction-to-Mutual-SSL-Authentication](http://www.codeproject.com/Articles/326574/An-Introduction-to-Mutual-SSL-Authentication)

如果您正在考虑使用奖励积分，并且真的担心有人从外部游戏系统，那么更好的解决方案是让每个人都创建一个安全存储在服务器上的帐户，并将他们的积分保存并在那里计算。这集中了所有数据，并允许您完全控制它，而不必担心恶意应用程序报告不存在的点。（这就是银行的运作方式）

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-01-02T23:23:30.213

如果您想验证用户既是*移动用户* **又是** *他们所说*的用户，那么最好的方法是利用网络。使用您希望用户通过以下方式使用的散列密钥发送推送通知：

*   适用于 iOS 的 APN

*   类似于windows phone 的[城市飞艇](http://urbanairship.com/)

*   [适用于 Android 的GCM](http://developer.android.com/google/gcm/index.html)。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-12-24T16:49:59.267

一般来说，模型看起来像：

*   服务器使用经过认证的公钥向许多客户端进行身份验证（这是整个公钥基础设施、证书颁发机构等）
*   每个客户端通过其他一些身份验证系统向服务器标识自己（在 99.9% 的情况下，这是一个密码）

因此，如果您想知道在银行应用程序等情况下这种事情是如何工作的，这基本上就是它的分解方式：（1）客户端和服务器使用服务器的公钥建立一个安全通道，例如共享密钥， (2) 客户端使用其他机制通过此安全通道进行身份验证。

但是，您的具体问题似乎更针对应用程序进行身份验证（即，来自您的应用程序的任何请求都是真实的），并认为如果只有您的应用程序可以通过身份验证，并且您的应用程序表现良好，那么一切都应该是安全的. 这有几个含义：

*   这意味着您的应用程序的每个用户都是受信任的。在安全方面，它们是您“[可信计算库](http://en.wikipedia.org/wiki/Trusted_computing_base)”的一部分。
*   试图在不考虑用户/用户的计算平台是可信的情况下实现这种目标本质上是[DRM](http://en.wikipedia.org/wiki/Digital_rights_management)的目标；虽然它足以为音乐出版商省钱，但对于真正敏感的东西来说，它还远远不够好。

一般来说：

*   如果您正在寻找非常强大的安全属性，那么您特别关注的问题很难解决。
*   你可能不需要解决这个问题。
*   如果您给我们更多的背景信息，我们也许可以给您更具体的建议。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-12-30T03:43:36.773

除了已经给出的答案之外，如何使用具有手机唯一 ID 和密码的登录类型方案？让用户在您的“后端”注册，每次必须在后端进行交易时，要求输入密码或选择自动登录。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2013-01-02T18:00:39.963

您可以使用以下方式来保护和跟踪您对服务器的请求。

1.  您可以通过以下方式强制移动或网络客户端在访问您的网络服务时向您发送[`Custom Headers`](http://forums.asp.net/p/979853/1250479.aspx)设备类型`REST methods`

2.  通过强制每个客户端拥有自己的用户名和密码来使用基本的 http 身份验证，这些用户名和密码由您作为授权的 Web 服务提供商提供。

3.  如果您需要更高级的保护，您可以使用它[`OAuth 2.0`](http://oauth.net/2/)来保护您的 Web 服务。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2013-01-03T09:44:24.407

由于您的原始应用程序将是 Android 或 Windows Phone 应用程序，因此对于想要成为黑客的人来说，它们中的任何一个都相对容易调试。在任何情况下，您都将在您无法控制的机器上运行代码，因此没有 ssl 技巧或检查签名将解决您的基本问题。

对抗来自它的威胁的唯一方法是不信任客户。如果您正在制作游戏，请先验证来自客户端的输入是否有效，然后再对其进行操作 - 它是否附有有效的安全令牌等。

本质上构建您的服务，以便用户是否使用非官方客户端无关紧要。

# python - 字符串到固定长度的小字符串的廉价映射

> ID：14023350
> 
> 赞同：3
> 
> 时间：2012-12-24T15:53:38.437
> 
> 标签：python

仅出于*调试*目的，我想将一个大字符串（一个难以可视化的 session_id）映射到一个，比如说，6 个字符的“哈希”。此哈希不需要以任何方式安全，只需计算成本低，并且长度固定且缩短（md5 太长）。输入字符串可以有任意长度。

你将如何在 python 中实现这个“cheap_hash”，以便计算成本不高？它应该生成如下内容：

```
def compute_cheap_hash(txt, length=6):
    # do some computation
    return cheap_hash

print compute_cheap_hash("SDFSGSADSADFSasdfgsadfSDASAFSAGAsaDSFSA2345435adfdasgsaed")
aBxr5u 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-12-24T16:05:47.120

我不记得 MD5 是否是均匀分布的，但它的设计目的是即使输入的最小差异也会发生很大变化。

不要相信我的数学，但我猜 MD5 hexdigest 的前 6 位的碰撞几率是 2^64。

所以你可以`cheap_hash = lambda input: hashlib.md5(input).hexdigest()[:6]`。

之后，您可以`hash = cheap_hash(any_input)`在任何地方使用。

PS：任何算法都可以；MD5 的计算成本略低，但`hashlib.sha256`也是一种流行的选择。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-12-24T16:02:54.127

```
def cheaphash(string,length=6):
    if length<len(hashlib.sha256(string).hexdigest()):
        return hashlib.sha256(string).hexdigest()[:length]
    else:
        raise Exception("Length too long. Length of {y} when hash length is {x}.".format(x=str(len(hashlib.sha256(string).hexdigest())),y=length)) 
```

这应该做你需要做的，它只是使用`hashlib`模块，所以在使用这个函数之前一定要导入它。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-24T16:05:39.113

我发现了这个类似的问题：[https ://stackoverflow.com/a/6048639/647991](https://stackoverflow.com/a/6048639/647991)

所以这里是函数：

```
import hashlib

def compute_cheap_hash(txt, length=6):
    # This is just a hash for debugging purposes.
    #    It does not need to be unique, just fast and short.
    hash = hashlib.sha1()
    hash.update(txt)
    return hash.hexdigest()[:length] 
```

# objective-c - 通过点击 UIScrollView 到它下面的单元格

> ID：14023354
> 
> 赞同：0
> 
> 时间：2012-12-24T15:53:47.813
> 
> 标签：objective-c, ios, uitableview, uiscrollview

我有 TableView，我在每个单元格内放置带有图像的 UIScrollView。我的问题是，当我单击 UIScrollView 时，应该运行的代码`didSelectRowAtIndexPath`没有运行。

我知道为什么，但我不知道如何将点击传递到相关单元格。我尝试使用 TAG so `self.scrollViewer.tag = [indexPath row];`' 并`UITapGestureRecognizer`为每个滚动视图添加，但它不准确......有时它会加载上一个或下一个单元格的数据......

如果上一个或下一个单元格很少显示，则标签会更改..所以我必须完全在当前单元格上才能找到正确的标签。

提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-24T16:10:56.613

我认为你想要的是[pointInside, hitTest:withEvent](http://developer.apple.com/library/iOS/#documentation/UIKit/Reference/UIView_Class/UIView/UIView.html#//apple_ref/occ/instm/UIView/pointInside:withEvent)

这个[线程可能会有所帮助](https://stackoverflow.com/questions/9026097/passing-through-touches-to-uiviews-underneath)。

# ajaxcontroltoolkit - Ajaxcontroltoolkit AutocompleteExtender Timeout 相关

> ID：14023357
> 
> 赞同：1
> 
> 时间：2012-12-24T15:53:55.100
> 
> 标签：ajaxcontroltoolkit, autocompleteextender

我正在尝试使用 AjaxControlToolkit Autocompleteextender（对于具有 ToolkitScriptManager 的 Visual Studio 2008）以及从数据库返回的值来建议。当我返回一个简单的字符串数组时，它工作正常。但是当我试图从数据库中提取数据时，它不起作用。下面是我的网络服务代码和 Autocompleteextender Html。当我在没有断点的情况下运行以下命令时，不会引发错误但不起作用。当我设置断点时，我收到 javascript 错误“Microsoft JScript 运行时错误：Sys.ParameterCountException：参数计数不匹配。”

```
[WebService(Namespace = "http://tempuri.org/")]
[WebServiceBinding(ConformsTo = WsiProfiles.BasicProfile1_1)]
[System.ComponentModel.ToolboxItem(false)]
[ScriptService]
public class AutoComplete : System.Web.Services.WebService
{

    [WebMethod]
    [ScriptMethod]
    public string[] GetAgentCompanyAutoCompleteList(string prefixText, int count, string contextKey)
    {
        //return new string[] { "aaaaaaa", "bbbbbb" };

        string sql = string.Format("select distinct AgentCompany from Realtors where FK_CompanyID = {0} Order By AgentCompany", contextKey);
        string[] items = new string[] { "" };
        string cn = "Data Source=localhost;Initial Catalog=ABCD;Integrated Security=True";
        using (SqlDataAdapter da = new SqlDataAdapter(sql, cn))
        {
            DataTable dt = new DataTable();
            da.Fill(dt);
            if (dt != null && dt.Rows.Count > 0)
                for (int i = 0; i < dt.Rows.Count; i++)
                    items[i] = dt.Rows[i]["AgentCompany"].ToString();
        }
        return items;            
    }
}

<asp:TextBox ID="txtCompany" runat="server" MaxLength="256" Width="150px">/asp:TextBox>                                    
<ajax:AutoCompleteExtender 
     ID="AutoCompleteExtender1" 
     runat="server" 
     EnableCaching="true" 
     MinimumPrefixLength="1" 
     TargetControlID="txtCompany" 
     ServicePath="~/AutoComplete.asmx" 
     ServiceMethod="GetAgentCompanyAutoCompleteList" 
     UseContextKey="true">
</ajax:AutoCompleteExtender> 
```

# html - 使用 IcePDF 或 PDFBox 从 PDF 生成 HTML 页面

> ID：14023362
> 
> 赞同：1
> 
> 时间：2012-12-24T15:54:17.863
> 
> 标签：html, pdf, pdfbox, icepdf

我想使用`IcePDF`或`PDFBox`从 PDF 中提取内容。但是我现在没有办法`HTML`从提取的文本和图像中继续生成网页。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-26T10:30:32.443

您可以使用 PDFBox 将 pdf 转换为 html。试试[这个链接](http://pdfbox.apache.org/1.8/commandline.html#extractText)。

通过在提取文本时添加 -html 作为参数，您将获得 pdf 的 html。但它不会包含任何图像、图形和其他细节。它只会是从 pdf 中提取的 html 格式的文本。

如果您想创建 pdf 的确切外观和感觉，PDFBox 中没有单步方法。据我所知，没有图书馆提供这种工具来创建 pdf 的精确 html。但是使用 PDFBox 您可以提取图像、文本及其详细信息。使用这些细节，您必须创建一个逻辑来生成 html。我们为[azzist.com](http://www.azzist.com)完成了一个将 pdf 转换为 html 的项目。我们已经使用 PDFBox 完成了转换。在 azzist 中，我们将简历转换为 html 格式。（仍然存在一些字体问题）。

Scribd、google、dropbox、zoho 等以更好的方式完成了这种转换。您可以查看这些站点中的任何一个，以检查它们是如何实现这一点的。（你不会明白逻辑。你必须找出它）。

# java - 修改 NumberFormat.getCurrencyInstance() 返回的 NumberFormat

> ID：14023365
> 
> 赞同：1
> 
> 时间：2012-12-24T15:54:39.483
> 
> 标签：java, currency-formatting

在 Java 中格式化货币时遇到问题。我正在尝试格式化要打印为货币的数字，并对齐所有小数点：

```
£  1.23
£ 12.34
£123.45 
```

调用`NumberFormat.getCurrencyInstance().format(n)`返回一个格式化的字符串，但所有的数字都是左对齐的，产生如下输出：

```
£1.23
£12.34
£123.45 
```

丑陋。我已经阅读了[这篇文章](https://stackoverflow.com/questions/4182092/numberformat-problem)，它提出了一个使用 a 的解决方案`DecimalFormat`，作为权宜之计，我正在使用 DecimalFormat 格式化我的数字并在稍后添加货币符号，但我想知道是否有人知道完成同样事情的更简洁的方法？

希望一切都清楚，提前感谢您的帮助！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-24T16:19:58.350

你可以这样做：

```
String currencySymbol = Currency.getInstance(Locale.getDefault()).getSymbol();
System.out.printf("%s%8.2f\n", currencySymbol, 1.23);
System.out.printf("%s%8.2f\n", currencySymbol, 12.34);
System.out.printf("%s%8.2f\n", currencySymbol, 123.45); 
```

注意：这仅适用于其符号出现*在金额之前*的货币。

还要注意[doubles 不适合表示货币](https://stackoverflow.com/questions/3730019/why-not-use-double-or-float-to-represent-currency)的事实。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-24T16:11:37.020

试试这个：

```
 final NumberFormat nf = NumberFormat.getCurrencyInstance();

    nf.setMinimumIntegerDigits(3);

    System.out.println(nf.format(1.23));
    System.out.println(nf.format(12.34));
    System.out.println(nf.format(123.45)); 
```

# asp.net - 使用 sql 创建/更改在 aspx 页面中，我有用户表，我希望经理能够从他想要更改/删除的用户中进行选择。如何将此 sql 查询嵌入到 html 代码中。不用说，在 .cs 中我需要从 public string user = ""; protected void Page_Load(object sender, EventArgs e) { string sql; sql="从'用户'中选择'用户名'"; 用户 = MyAdoHelper.printDataTable("Databas

ID：14023366

赞同：0

时间：2012-12-24T15:54:42.217

标签：asp.net, html, sql

# android - 如果“x”时间已过，则创建一个取消 InputStream.read() 调用的线程

> ID：14023374
> 
> 赞同：12
> 
> 时间：2012-12-24T15:55:14.743
> 
> 标签：android, multithreading, bluetooth, android-asynctask, nio

[我目前有一个来自 Android 的BluetoothChat Example](http://developer.android.com/tools/samples/index.html)的工作 I/O 流，但遇到了问题。我的应用程序通过蓝牙连接到蓝牙模块，蓝牙模块又向模块物理连接的设备发送信号。

我的程序调用`read()`输入流，如果有数据正在发送，程序执行顺利，没有问题。但是，流的实现方式没有针对中断连接的保护。如果模块从设备上被物理移除，或者设备没有发回任何信号，我的代码只是坐下来等待`InputStream.read()`调用。

我的`read()`电话看起来像这样：

```
try {
    Log.i( "1) I/O", "available bits: " + mmInStream.available() );
    bytes = mmInStream.read(buffer, 0, length);
    Log.i( "2) I/O", "available bits: " + mmInStream.available() );
    mHandler.obtainMessage(MainMenu.MESSAGE_READ, bytes, -1, buffer)
                        .sendToTarget();
} catch (Exception e) {
    Log.i(TAG,  "Catch Statement" );
    Message msg = mHandler.obtainMessage(MainMenu.MESSAGE_TOAST);
    Bundle bundle = new Bundle();
    bundle.putString( TOAST, "Device has disconnected from the Bluetooth Module." );
    msg.setData(bundle);
    mHandler.sendMessage(msg);
    Log.e(TAG, "disconnected a", e);
    connectionLost();

    // Start the service over to restart listening mode
    BluetoothService.this.start();
    //break;
} 
```

当我的程序正确运行时，块`Log`中的两个调用都`try`返回`0`for的值`mmInStream.available()`。当输入流被中断时，第`Log`一个调用返回 a `0`，第二个永远不会被调用。`catch`然后，我的程序在每次到达块之前就崩溃了。

我一直在寻找几天来解决这个问题，并找到了许多解决方案，但它们要么不起作用，要么我不理解它们。

1) InputStream 使用扫描仪如下所示。这没有提供任何帮助，并且在阅读时也会超时。

```
Scanner scan = new Scanner(new InputStreamReader(mmInStream));
scan.useDelimiter( "[\\r\\n]+" );
String readIn;

try {
    readIn = scan.next();
    scan = null;
    tempB = readIn.getBytes( Charset.forName( "US-ASCII" ) );
    append = "\r\n".getBytes( Charset.forName( "US-ASCII" ) );
    for( int i = 0; i < length; i++ ) {
        if( i == length - 1 ) {
            buffer[i] = append[1];
        } else if ( i == length - 2 ) {
            buffer[i] = append[0];
        } else {
            buffer[i] = tempB[i];
        }
    }
    mHandler.obtainMessage(MainMenu.MESSAGE_READ, bytes, -1, buffer)
                        .sendToTarget();
} catch (Exception e) {
    Log.i(TAG,  "Catch Statement" );
                Message msg = mHandler.obtainMessage(MainMenu.MESSAGE_TOAST);
                Bundle bundle = new Bundle();
                bundle.putString( TOAST, "Device has disconnected from the Bluetooth Module." );
                msg.setData(bundle);
                mHandler.sendMessage(msg);
                Log.e(TAG, "disconnected a", e);
                connectionLost();

                // Start the service over to restart listening mode
                BluetoothService.this.start();
                //break;
            } 
```

2）我尝试运行一个线程，它会`read`在 X 时间后取消调用，但它不能正常工作：

```
public void run(int length) throws IOException {
    buffer = new byte[1024];
    length1 = length;
    Thread myThread = new Thread(new Runnable() {
        public void run() {
            try {
                bytes = mmInStream.read( buffer, 0, length1 );
            } catch (IOException e) {
                // TODO Auto-generated catch block
                e.printStackTrace();
            }
        }
    });

    synchronized (myThread) {
        myThread.start();
        try {
            myThread.wait(500);
            if(myThread.isAlive()) {
                mmInStream.close();
                Log.i( "InStream", "Timeout exceeded!");
            }
        } catch (InterruptedException e) {
            // TODO Auto-generated catch block
            e.printStackTrace();
        }

    }
   try {
        myThread.run();
        mHandler.obtainMessage(MainMenu.MESSAGE_READ, bytes, -1, buffer)
                    .sendToTarget();
   } catch (IOException e) {
            Message msg = mHandler.obtainMessage(MainMenu.MESSAGE_TOAST);
            Bundle bundle = new Bundle();
            bundle.putString( TOAST, "Device has disconnected from the Bluetooth Module." );
            msg.setData(bundle);
            mHandler.sendMessage(msg);
            connectionLost();
            BluetoothService.this.start();
   } 
```

在这两个选项不起作用之后，我一直在尝试研究`Java NIO`or `AsyncTask`，但是所有这些似乎都需要添加太多东西来识别 I/O 超时。我还看到有些`Sockets`支持使用 的超时功能`.setSoTimeout()`，但是这是一个`BluetoothSocket`并且我发现他们不支持此功能。

由于没有`I/O`类支持`read()`将超时长度作为参数或完全超时的方法，在我看来，添加线程将是最简单的实现。这是错的吗？任何有关我在上述方法中做错了什么或如何合并`Java NIO`/的信息`AsyncTask`将不胜感激。

编辑：

这是我尝试过的新线程代码，我目前正在将其更改为给定答案显示的内容并尝试。如果之后它不起作用，我会发布。

```
Thread myThread = new Thread(new Runnable() {
            public void run() {
                try {
                    bytes = mmInStream.read( buffer, 0, length1 );
                } catch (IOException e) {
                    // TODO Auto-generated catch block
                    e.printStackTrace();
                }
            }
        });

        synchronized (myThread) {
            try {
                myThread.wait(6000);
                Log.i( "InStream", "After wait" );
                if(myThread.isAlive()) {
                    Log.i( "InStream", "Timeout exceeded2!");
                    myThread.interrupt();
                    Log.i( "InStream", "Timeout exceeded!");
                } else {
                    myThread.interrupt();
                }
            } catch (InterruptedException e) {
                // TODO Auto-generated catch block
                Log.i( "InStream", "Exception Caught" );
                e.printStackTrace();
            }

        } 
```

编辑2：

我已经尝试过`Dheerej`下面给出的答案。我得到一个`IllegalMonitorStateException`函数`wait()`调用。我尝试了答案中显示的内容，然后也尝试`myThread.wait()`了代替`Thread.currentThread.wait()`. 我假设正在引发此异常，因为这是`myThread`正在创建对象并在另一个线程中运行。无论如何，下面的代码几乎与`Dheerej's`答案相同。

```
 int length1 = length;
            Thread myThread = new Thread(new Runnable() {
                public void run() {
                    buffer = new byte[1024];
                    try {
                        bytes = mmInStream.read(buffer, 0, length1);
                    } catch (IOException e) {
                        e.printStackTrace();
                    }
                    mHandler.obtainMessage(MainMenu.MESSAGE_READ, bytes, -1, buffer)
                                .sendToTarget();
                }
            });

            myThread.start();
            try {
                //Thread.currentThread().wait(500);
                myThread.wait( 1000 );              // Line 533
            } catch (InterruptedException e) {
                e.printStackTrace();
                //Log.i(TAG,  "Catch Statement" );
                Message msg = mHandler.obtainMessage(MainMenu.MESSAGE_TOAST);
                Bundle bundle = new Bundle();
                bundle.putString( TOAST, "Device has disconnected from the Bluetooth Module." );
                msg.setData(bundle);
                mHandler.sendMessage(msg);
                Log.e(TAG, "disconnected a", e);
                connectionLost();

                // Start the service over to restart listening mode
                BluetoothService.this.start();
            }

            if (myThread.isAlive()) {
                mmInStream.close(); // Alternatively try: myThread.interrupt()
            } 
```

这是生成的 LogCat。错误说它从第 533 行开始，也就是`wait()`上面的调用：

```
12-28 17:44:18.765: D/BLZ20_WRAPPER(3242): blz20_wrp_poll: return 1
12-28 17:44:18.765: D/BLZ20_WRAPPER(3242): blz20_wrp_write: wrote 3 bytes out of 3 on fd 62
12-28 17:44:18.769: W/NATIVE CODE(3242): -4) baud9600=1, goodbaud=1
12-28 17:44:18.769: D/AndroidRuntime(3242): Shutting down VM
12-28 17:44:18.769: W/dalvikvm(3242): threadid=1: thread exiting with uncaught exception (group=0x40015578)
12-28 17:44:18.773: E/AndroidRuntime(3242): FATAL EXCEPTION: main
12-28 17:44:18.773: E/AndroidRuntime(3242): java.lang.IllegalMonitorStateException: object not locked by thread before wait()
12-28 17:44:18.773: E/AndroidRuntime(3242):     at java.lang.Object.wait(Native Method)
12-28 17:44:18.773: E/AndroidRuntime(3242):     at java.lang.Object.wait(Object.java:395)
12-28 17:44:18.773: E/AndroidRuntime(3242):     at my.eti.commander.BluetoothService$ConnectedThread.run(BluetoothService.java:533)
12-28 17:44:18.773: E/AndroidRuntime(3242):     at my.eti.commander.BluetoothService.read(BluetoothService.java:326)
12-28 17:44:18.773: E/AndroidRuntime(3242):     at my.eti.commander.BluetoothService.changeitJava(BluetoothService.java:669)
12-28 17:44:18.773: E/AndroidRuntime(3242):     at my.eti.commander.RelayAPIModel$NativeCalls.changeItJavaWrapper(RelayAPIModel.java:490)
12-28 17:44:18.773: E/AndroidRuntime(3242):     at my.eti.commander.RelayAPIModel$NativeCalls.InitRelayJava(Native Method)
12-28 17:44:18.773: E/AndroidRuntime(3242):     at my.eti.commander.MainMenu$1.handleMessage(MainMenu.java:547)
12-28 17:44:18.773: E/AndroidRuntime(3242):     at android.os.Handler.dispatchMessage(Handler.java:99)
12-28 17:44:18.773: E/AndroidRuntime(3242):     at android.os.Looper.loop(Looper.java:130)
12-28 17:44:18.773: E/AndroidRuntime(3242):     at android.app.ActivityThread.main(ActivityThread.java:3687)
12-28 17:44:18.773: E/AndroidRuntime(3242):     at java.lang.reflect.Method.invokeNative(Native Method)
12-28 17:44:18.773: E/AndroidRuntime(3242):     at java.lang.reflect.Method.invoke(Method.java:507)
12-28 17:44:18.773: E/AndroidRuntime(3242):     at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:842)
12-28 17:44:18.773: E/AndroidRuntime(3242):     at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:600)
12-28 17:44:18.773: E/AndroidRuntime(3242):     at dalvik.system.NativeStart.main(Native Method)
12-28 17:44:18.781: D/BLZ20_ASOCKWRP(3242): asocket_read
12-28 17:44:18.781: I/BLZ20_WRAPPER(3242): blz20_wrp_poll: nfds 2, timeout -1 ms
12-28 17:44:18.890: D/BLZ20_WRAPPER(3242): blz20_wrp_poll: transp poll : (fd 62) returned r_ev [POLLIN ] (0x1)
12-28 17:44:18.890: D/BLZ20_WRAPPER(3242): blz20_wrp_poll: return 1
12-28 17:44:18.890: D/BLZ20_WRAPPER(3242): blz20_wrp_read: read 5 bytes out of 5 on fd 62 
```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-12-29T10:23:58.877

先试试这个：

```
try {
    int available = 0;

    while (true)
    {
        int available = mmInStream.available();
        if (available > 0) { break; }
        Thread.sleep(1);
        // here you can optionally check elapsed time, and time out
    }

    Log.i( "1) I/O", "available bits: " + available );
    bytes = mmInStream.read(buffer, 0, length);
    Log.i( "2) I/O", "available bits: " + mmInStream.available() );
    mHandler.obtainMessage(MainMenu.MESSAGE_READ, bytes, -1, buffer).sendToTarget();
} catch (Exception e) {
    ...
} 
```

在您的原始代码中，您调用`available()`before `read()`，通常没有数据等待读取。然后调用`read()`，它会阻塞并等待数据，然后读取所有数据。然后你`available()`一次又一次地调用没有数据，因为它已经全部被读取了:) 更好：sleep until`available()`返回非零，然后读取。但是，这可能不起作用，因为`available()`始终*允许*返回 0（即使数据实际可用）。

如果上述方法不起作用，请尝试以下问题中的技术：[Is it possible to read from a InputStream with a timeout?](https://stackoverflow.com/questions/804951/is-it-possible-to-read-from-a-inputstream-with-a-timeout)

```
Callable<Integer> readTask = new Callable<Integer>() {
    @Override
    public Integer call() throws Exception {
        return mmInStream.read(buffer, 0, length);
    }
}

try {
    Future<Integer> future = executor.submit(readTask);
    bytes = future.get(100, TimeUnit.MILLISECONDS);
    mHandler.obtainMessage(MainMenu.MESSAGE_READ, bytes, -1, buffer).sendToTarget();
} catch (TimeoutException e) {
    // deal with timeout in the read call
} catch (Exception e) {
    ...
} 
```

最后，`BluetoothSocket`文档说您可以从任何线程关闭套接字并立即生效。所以你可以简单地有一个看门狗线程，如果读取调用没有成功调用`close()`套接字，这将导致阻塞`read()`返回错误。这是 Dheeraj 上面建议的，但您只需要`close()`在另一个线程卡住时调用（由于网络错误/连接丢失/等）：否则只需偶尔检查一下它的进度，但只要您的阅读时间不长。

*很长一段*时间以来，看起来没有超时（以及不可能从外部中断阻塞的 read() ）一直是 Java 的主要痛点。

也可以看看：

[是否可以从超时的 InputStream 中读取？](https://stackoverflow.com/questions/804951/is-it-possible-to-read-from-a-inputstream-with-a-timeout)（使用`Callable`/ `Future`）

[我可以为 InputStream 的 read() 函数设置超时吗？](https://stackoverflow.com/questions/2638283/can-i-set-a-timeout-for-a-inputstreams-read-function)（使用`Socket.setSoTimeout()`）

[如何终止 BufferedInputStream .read() 调用](https://stackoverflow.com/questions/9041490/how-to-kill-a-bufferedinputstream-read-call?lq=1)（使用`InterruptibleChannel`）

[如何停止在 Java 中的阻塞读取操作中等待的线程？](https://stackoverflow.com/questions/4182491/how-to-stop-a-thread-waiting-in-a-blocking-read-operation-in-java?lq=1)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-12-28T12:19:27.600

试试这个扩展我上面评论的代码：

```
public void run(final int length) {
    Thread myThread = new Thread(new Runnable() {
        public void run() {
            buffer = new byte[1024];
            try {
                bytes = mmInStream.read(buffer, 0, length);
            } catch (IOException e) {
                e.printStackTrace();
            }
            mHandler.obtainMessage(MainMenu.MESSAGE_READ, bytes, -1, buffer)
                        .sendToTarget();
        }
    });

    myThread.start();
    try {
        Thread.sleep(500);
    } catch (InterruptedException e) {
        e.printStackTrace();
    }

    if (myThread.isAlive()) {
        mmInStream.close(); // Alternatively try: myThread.interrupt()
    }
} 
```

# iphone - 如何在 iPhone 中访问 EKCalendar 的帐户详细信息

> ID：14023387
> 
> 赞同：0
> 
> 时间：2012-12-24T15:57:00.783
> 
> 标签：iphone, calendar, account

你们能告诉我在 iPhone 中获取日历帐户信息的私有方法是什么吗？我曾尝试使用 accountName，但无法获得任何成功。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-25T09:56:16.143

```
accountName 
```

是私有财产，有一种方法只能解析您将从中获得的描述

```
-[EKCalendar description] 
```

# iphone - NSDate 返回“1604”作为年份值？

> ID：14023390
> 
> 赞同：12
> 
> 时间：2012-12-24T15:57:09.753
> 
> 标签：iphone, objective-c, ios, nsdate, abaddressbook

我正在尝试获取联系人的出生数据，但如果用户没有选择年份或联系人来自 Facebook，而年份或数据本身是隐藏的，那么它会给我该年份的“1604”值，你可以看到我图片中的意思。

![在此处输入图像描述](../Images/326b996503127e878cc503c1d4f542eb.png)

![在此处输入图像描述](../Images/0cec3033aefce8318b120dbb5a6ed28e.png)

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2012-12-24T16:12:41.497

恭喜，你发现了一个实现细节！

首先，Contacts 将日期存储为时间点，没有年份就无法存储时间点，因为每个时间点都有一年。因此，必须决定地址簿如何在日期中存储“未知”年份。出于以下几个原因，决定“1604”将是美好的一年：

1.  当您谈论通讯簿时，您的通讯簿中不太可能有任何 1604 年出生的人。
2.  1604 年是闰年（根据闰年的计算规则），这意味着如果您不知道其出生年份的人出生于 2 月 29 日，那么 1604 也可以处理。
3.  1604 年在儒略历-公历转换之前。

因此，如果您要从通讯簿中提取出生日期，则需要将特殊情况 1604 设置为“年份未知的出生日期”。

注意：据我所知，仅在处理公历时才支持此功能。对于所有其他日历，此行为未定义。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-24T16:07:59.070

您可以在 viewDidLoad 中初始化年份。

或者检查用户是否没有选择年份，显示错误消息。

# java - 有没有办法计算 jar 文件中使用的方法的数量

> ID：14023397
> 
> 赞同：33
> 
> 时间：2012-12-24T15:57:40.147
> 
> 标签：java, android, dex

我可以计算 jar 文件中使用的所有方法的数量吗？我的 APK 使用某些外部 JARS，确切地说，有大约数百个类。

我使用过 dex2jar JAD 等反编译器等等，但它们似乎都只在特定的类文件中显示方法。

有没有办法可以得到总数？

* * *

## 回答 #1

> 赞同：81
> 
> 时间：2012-12-24T22:35:36.217

您可以将 jar 转换为 dex 文件，然后从标头中提取方法引用的数量。它存储为无符号小端整数，偏移量为 88 (0x58)。

```
dx --dex --output=temp.dex orig.jar
cat temp.dex | head -c 92 | tail -c 4 | hexdump -e '1/4 "%d\n"' 
```

请记住，这是引用的唯一方法的数量，而不是方法引用的数量。换句话说，如果某个特定的方法在dex文件中被引用了两次，那么它只会在header中的count中被计入一次。而且当你把这个jar导入你的apk时，两者共有的方法引用会被去重，所以最终合并的apk的总方法引用计数将是<=两者之和。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2015-09-01T09:43:08.013

这个 gradle 插件[https://github.com/KeepSafe/dexcount-gradle-plugin](https://github.com/KeepSafe/dexcount-gradle-plugin)将显示组装后的总方法数，并生成一个包含每个包的方法数的报告。排序后是这样的：

```
30145    com
27704    org
20950    android
17140    org.spongycastle
16605    android.support
9760     com.google
8930     com.fasterxml.jackson
8930     com.fasterxml
8633     android.support.v4
7020     com.fasterxml.jackson.databind
6426     android.support.v7
5311     com.google.protobuf
4705     org.spongycastle.crypto
... 
```

结合 gradle 命令

```
.\gradlew app:dependencies 
```

它打印出依赖关系树，您将很好地了解哪个依赖关系需要多少方法。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-03-06T02:12:20.380

[Cyvis](http://cyvis.sourceforge.net/)可以读取一个`.jar`或`.class`文件，并将显示每个方法的总方法数加上圈复杂度和指令数。GUI 有点......便携......但我已经在 Ubuntu 上运行它，它说它可以在 Windows 上运行。对于有关图书馆给您带来麻烦的可能性的初步信息来源来说，这似乎相当不错。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2016-03-10T12:16:07.027

使用[http://github.com/mihaip/dex-method-counts](http://github.com/mihaip/dex-method-counts)计算来自各处的方法数（JAR、AAR、DEX、APK）

## DEX 或 APK：

`./dex-method-counts <your_file_path>.DEX` 或者 `./dex-method-counts <your_file_path>.APK`

## 罐

只需从 JAR 制作一个 DEX，如上所示：

`<your_path_to_android_buil_tools>/dx --dex --output=temp.dex orig.jar`

进而

`./dex-method-counts temp.dex`

## AAR

首先解压缩它（是的 AAR 它实际上是 ZIP）然后使用 classes.jar 如上面 JAR 部分所示

`unzip mylib.aar -d mylib`

`dx --dex --output=temp.dex mylib/classes.jar`

`dex-method-counts temp.dex`

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2017-07-27T21:20:29.370

对于已经超过 64k 方法限制的情况，另一种方法是使用 dx 的 --multi-dex 选项，然后对 dx 生成的所有 dex 文件使用 baksmali 的“列出方法”功能。接下来，您将合并这些列表，对合并的列表进行排序并删除所有重复项。您剩下的方法数将是总方法数。

```
dx --dex --multi-dex --output=out orig.jar
find out -name classes*.dex -exec baksmali list methods {} \; | sort | uniq | wc -l 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-12-24T17:11:58.657

如果你有源代码（或者可以下载），[Sonar](http://www.sonarsource.org/)会在上面做这样的静态分析。您还可以检查许多其他复杂性指标，这些指标可能对您尝试做的事情有用。（可能很高兴告诉我们您要做什么。；））

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-12-24T17:55:01.610

1.  使用带有 -x 参数的 jar 程序 从 jar 文件中[提取文件。](http://docs.oracle.com/javase/tutorial/deployment/jar/unpack.html)

2.  对每个 .class 文件应用反编译器以获取每个文件中的方法数。

3.  将方法计数相加。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2016-08-16T22:12:34.773

我只是为此编写了一个python脚本来粗略估计

```
import re
import subprocess
import sys

for jarfile in sys.argv[1:]:
    class_output = subprocess.check_output(['jar', 'tf', jarfile])
    classes = [c.replace('/', '.') for c in re.findall(r'(.*)\.class', class_output)]
    methods = []
    if classes:
        def_out = subprocess.check_output(['javap', '-classpath', jarfile] + classes)
        # This is pretty hacky: look for parentheses in the declaration line.
        num_methods = sum(1 for line in def_out if '(' in line)
    else:
        num_methods = 0
    print '{} {} {}'.format(num_methods, len(classes), jarfile) 
```

我刚刚遇到了 Android 64K 方法限制，并且我的依赖项还没有被 methodcount.com 服务索引。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2017-02-14T01:33:45.080

我根据@JesusFreke 对这个问题和另一个问题的回答编写了一个脚本（[https://stackoverflow.com/a/21485222/6643139](https://stackoverflow.com/a/21485222/6643139)）：

```
#!/bin/bash
unzip $1 classes.jar -d aarsize &&
  dx --dex --output=aarsize/temp.dex aarsize/classes.jar &&
  hexdump -s 88 -n 4 -e '1/4 "%d\n"' aarsize/temp.dex &&
  rm -rf aarsize 
```

将其保存为文件名“aarsize”，`chmod +x`对于它，输出`aarsize your_aar_file`：

```
$ aarsize status-bar-compat-release.aar 
Archive:  status-bar-compat-release.aar
  inflating: aarsize/classes.jar     
91 
```

这`91`是您的 aar 文件的方法计数。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2018-01-07T07:48:19.780

要在 gradle 库中查找方法计数，您可以使用它 - [http://www.methodscount.com](http://www.methodscount.com)

它还为 android studio 提供插件。

[http://www.methodscount.com/plugins](http://www.methodscount.com/plugins)

* * *

## 回答 #11

> 赞同：-1
> 
> 时间：2013-05-31T19:53:53.140

使用命令行，在解压缩 JAR 后，应该可以这样：

```
for f in *.class; do javap -c $(basename -s .class $f) | grep invoke | sed 's/.*Method\(.*\)/\1/g'; done | wc -l 
```

* * *

## 回答 #12

> 赞同：-2
> 
> 时间：2016-05-10T10:02:08.670

```
(public|protected|private|static|\s) +[\w\<\>\[\]]+\s+(\w+) *\([^\)]*\) *(\{?|[^;]) 
```

使用在项目中搜索`CTRL+SHIFT+F`。它帮助了我

# uiviewcontroller - 只允许一个 uiviewcontroller 旋转

> ID：14023401
> 
> 赞同：1
> 
> 时间：2012-12-24T15:58:11.653
> 
> 标签：uiviewcontroller, ios6, screen-rotation

我正在使用 IIViewDeck 开发一个应用程序，我只希望一个视图控制器旋转。它是 ios 6，我能够计算出 shouldRotate 级联以获得我需要成功旋转的那个。

我的问题是，如果我在横向然后切换到另一个视图控制器，应用程序仍然在横向。我需要把它强行还给抗议者，但我没有任何成功。我认为最简单的方法是在可旋转视图控制器的 viewWillDisapper 中执行一些“强制肖像”代码，但我只是不知道如何执行。

有什么建议么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-24T18:16:32.357

你的问题也在[这里问](https://stackoverflow.com/questions/13018308/ios-6-uiinterfaceportrait-only-viewcontroller-being-presented-stuck-in-landsca)

在您的所有 VC 中都对旋转说“是”，但使用 NSUInterger 来设置模式，如下所示：

问题的答案如下：

```
 -(BOOL)shouldAutorotate
{
  return YES;
}

//keep the below code in all your VC's that you do not want to have the rotation capability

-(NSUInteger)supportedInterfaceOrientations
{
  return UIInterfaceOrientationPortrait;
} 
```

# c++ - C++：预期的构造函数、析构函数或类型转换

> ID：14023408
> 
> 赞同：0
> 
> 时间：2012-12-24T15:58:42.167
> 
> 标签：c++, templates

正在努力学习 C++。想知道是否有人可以为我指出这个错误的正确方向（双关语）。

该类是一个 LinkedList（在下面完整复制）。错误发生在这一行：

```
LinkedList<T>::ListNode LinkedList::find(int pos) const { 
```

并说：

> 'LinkedList' 之前的预期构造函数、析构函数或类型转换

任何提示将非常感谢。

```
#ifndef LINKEDLIST_HPP
#define LINKEDLIST_HPP

#include <iostream>

using namespace std;

template <class T>
class LinkedList {

    private:
        // a ListNode consists of the item and a pointer to the next ListNode
        struct ListNode {
            T data;
            ListNode *next;
        };
        int size; //Size of the list
        ListNode *head; //the beginning of the list

    public:
        LinkedList(); // default oonstructor
        ~LinkedList(); // destructor
        virtual bool isEmpty ();
        virtual int  getLength ();
        virtual void insert (int pos, T item);
        virtual T    remove (int pos);
        virtual T    retrieve (int pos);

        //helper methods
        LinkedList(LinkedList &copyList); //copy constructor
        ListNode *find (int pos) const; // internal find function
};

//default constructor
template <class T>
LinkedList<T>::LinkedList() {
    size = 0;
    head = NULL;
}

//destructor
template <class T>
LinkedList<T>::~LinkedList() {
    //loop through each node, and delete it
    ListNode* current = head;
    while (current != NULL) {
        ListNode* next = current->next;
        delete current;
        current = next;
    }
    head = NULL; // set head node to back to null
}

//copy constructor
template <class T>
LinkedList<T>::LinkedList(LinkedList& copyList) {
    size = copyList.size;

    // if copyList is empty
    if (copyList.head == NULL)
        head = NULL;

    else {
        //create a new head
        head = new ListNode;
        head->data = copyList.head->data;

        //create a new list
        ListNode *newPtr = head; // start at the head
        // iterate through rest of list to be copied
        for (ListNode *copyPtr = copyList.head->next; copyPtr != NULL; copyPtr = copyPtr->next) {
            newPtr->next = new ListNode;
            newPtr->data = copyPtr->data;
        }
        //make last ListNode's next point to NULL
        newPtr->next = NULL;
    }
}

template <class T>
bool LinkedList<T>::isEmpty() {
    if (size == 0)
        return true;
    return false;
}

template <class T>
int LinkedList<T>::getLength() {
    return size;
}

// used in other methods to find a given index
template <class T>
LinkedList<T>::ListNode LinkedList::find(int pos) const {

    // check that pos is in bound of LinkedList
    if ((pos < 1) || pos > getLength()) {
        cout << "Find position of out bounds" << endl;
        return NULL;
    } else { //search through ListNodes
        ListNode *temp = head; // start at the head
        for (int i = 1; i < pos; ++i)
            temp = temp->next;
        return temp;
    }
}

template <class T>
T LinkedList<T>::retrieve(int pos) {
    T tempData; // to hold retrieved data
    try {
        if ((pos < 1) || (pos > getLength())) {
            cout << "Retrieve request outside LinkedList's bounds" << endl;
            return NULL;
        }
        else { //traverse list
            ListNode *temp = find(pos);
            tempData = temp->data;
            return tempData;
        }
    } catch (int e) {
        cout << "Could not retrieve position " << pos << endl;
    }
}

template <class T>
void LinkedList<T>::insert(int pos, T item) {

    //check bounds
    if ((pos < 1) || (pos > getLength() +1))
        cout << "Must insert at a position between 1 and getLength() + 1" << endl;

    else {
        try {
            //create new ListNode
            ListNode *temp = new ListNode;
            temp->data = item;

            //if the new item is at the first position
            if (pos == 1) {
                temp->next = head;
                head = temp;
            }
            else {
                ListNode *prev = find(pos - 1);
                temp->next = prev->next;
                prev->next = temp;
            }
            //increment size
            ++size;

        } catch (int e) {
            cout << "Error inserting " << item << " at position " << pos << endl;
        }
    }
}

template <class T>
T LinkedList<T>::remove(int pos) {

    //check bounds
    if ((pos < 1) || (pos > getLength()))
        cout << "Must remove a position between 1 and getLength()" << endl;

    else {
        try {

            ListNode *temp; //to hold shifted node

            //if node to be deleted is first node
            if (pos == 1) {
                temp = head;
                head = head->next;
            }
            //for anything but the head
            //write over the node before the pos'th index
            else {
                ListNode *prev = find(pos - 1);
                temp = prev->next;
                prev->next = temp->next;
            }

            //destroy temp, to free up memory
            temp->next = NULL;
            delete temp;

            //decrement size
            --size;

        } catch (int e) {
            cout << "Error removing item from position " << pos << endl;
        }
    }

}

#endif  /* LINKEDLIST_HPP */ 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-24T16:01:47.410

Qualify the dependant type with `typename` and add `<T>` (I'm not sure if this is necessary, might as well do it though):

```
typename LinkedList<T>::ListNode* LinkedList<T>::find(int pos) const { 
```

See: [Where and why do I have to put the "template" and "typename" keywords?](https://stackoverflow.com/questions/610245/where-and-why-do-i-have-to-put-the-template-and-typename-keywords)

Also, your definition doesn't match. In-class it returns a pointer, but outside it returns a value.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-24T16:03:55.920

`ListNode` is a dependant type, so it needs to be qualified with `typename`. Also, your `find` function was declared to return a pointer-to-`ListNode`, but the definition returns a `ListNode` by value. This seems like a simple typo:

```
template <class T>
typename LinkedList<T>::ListNode* LinkedList<T>::find(int pos) const { 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-24T16:03:28.080

Should be

```
LinkedList<T>::ListNode LinkedList<T>::find(int pos) const { 
```

# java - 从字符串数组（Java 或 Groovy）调用函数

> ID：14023409
> 
> 赞同：4
> 
> 时间：2012-12-24T15:58:41.997
> 
> 标签：java, reflection, groovy

在 Java 或 Groovy 中，假设我有一个类似的字符串数组

```
myArray = ["SA1", "SA2", "SA3", "SA4"] 
```

我想根据每个字符串调用不同的函数。

```
class Myclass{
  public static void SA1() {
    //doMyStuff
  }
  public static void SA2() {
    //doMyStuff
  }
  ...etc
} 
```

我希望能够遍历我的数组并调用它们相关的函数，而无需比较字符串或进行 case 语句。例如，有没有一种方法可以执行以下操作，我知道它目前不起作用：

```
Myclass[myArray[0]](); 
```

或者，如果您有其他建议，我可以构建类似的东西。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-24T16:06:41.173

在 groovy 中，您可以执行以下操作：

```
Myclass.(myArray[0])() 
```

在 Java 中，您可以执行以下操作：

```
MyClass.class.getMethod(myArray[0]).invoke(null); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-24T17:15:22.097

在 Groovy 中，您可以使用 GString 进行动态方法调用：

```
myArray.each {
  println Myclass."$it"()
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-12-24T16:01:41.640

You can, for instance, declare an interface such as:

```
public interface Processor
{
    void process(String arg);
} 
```

then implement this interface, for example in singletons.

Then create a `Map<String, Processor>` where keys are your strings, values are implementations and, when invoking:

```
Processor p = theMap.containsKey(theString)
    ? theMap.get(theString)
    : defaultProcessor;

p.process(theString); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-24T16:03:19.703

I suggest you look at Reflection APIs, to call methods at runtime check [Reflection docs](http://docs.oracle.com/javase/tutorial/reflect/member/methodInvocation.html)

```
Class cl = Class.forName("/* your class */");
Object obj = cl.newInstance();

//call each method from the loop
Method method = cl.getDeclaredMethod("/* methodName */", params);
method.invoke(obj, null); 
```

# android - Android中路由播放的方法

> ID：14023420
> 
> 赞同：3
> 
> 时间：2012-12-24T16:00:22.183
> 
> 标签：android, android-layout, android-widget, android-canvas

我正在尝试创建一个 Android 应用程序，该应用程序将能够播放我某天采取的路线。我不想在播放时将其覆盖在地图上。我希望能够在我自己选择的画布上绘制路线（带有与我路线相关的其他事物的标签或图像），并在回放模式下在该路线上移动一个点，以显示我随着时间的推移的位置（标签和图像将随着点的移动而变化，即根据点的上下文）。

在播放过程中，手机不应使用互联网。在录制过程中，手机将使用 GPS 获取纬度/经度。我的位置，每秒说一次（这个分辨率实用吗？）并将其存储在文件/数据库中，并在播放期间使用该文件来构建路线并移动点。标签和图像的数据（来自其他文件）将取决于时间（以秒为单位）或位置（纬度/经度），并将根据当前的纬度/经度出现在画布上和/或消失. 或移动点的时间。

我想知道我应该采取什么方法来解决这个问题，这样我就不会挖掘 SDK 的错误区域。

我想知道存储此类信息的最佳文件/数据库是什么（对于与时间和纬度/经度相关的路线点和标签/文本和图像），以便可以使用路线读取和显示它地图构建以及使用什么样的图形库来实现我的目标。

# r - 当其中一些是因素时，如何预处理特征？

> ID：14023423
> 
> 赞同：14
> 
> 时间：2012-12-23T16:03:38.967
> 
> 标签：r, r-caret

我的问题与使用 Caret 包[时](https://stats.stackexchange.com/questions/44628/do-categorical-variables-have-to-be-dummy-coded-in-svm) 的分类数据（R 术语中的因素）有关。我从链接的帖子中了解到，如果您使用“公式界面”，则某些功能可能是因素，并且培训会正常工作。我的问题是如何使用`preProcess()`函数缩放数据？如果我尝试在以某些列为因素的数据框上执行此操作，则会收到以下错误消息：

```
Error in preProcess.default(etitanic, method = c("center", "scale")) : 
  all columns of x must be numeric 
```

请参阅此处的一些示例代码：

```
library(earth)
data(etitanic)

a <- preProcess(etitanic, method=c("center", "scale"))
b <- predict(etitanic, a) 
```

谢谢你。

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2012-12-26T16:07:40.863

这与您链接到的帖子实际上是相同的问题。`preProcess`仅适用于数字数据，您有：

```
> str(etitanic)
'data.frame':   1046 obs. of  6 variables:
 $ pclass  : Factor w/ 3 levels "1st","2nd","3rd": 1 1 1 1 1 1 1 1 1 1 ...
 $ survived: int  1 1 0 0 0 1 1 0 1 0 ...
 $ sex     : Factor w/ 2 levels "female","male": 1 2 1 2 1 2 1 2 1 2 ...
 $ age     : num  29 0.917 2 30 25 ...
 $ sibsp   : int  0 1 1 1 1 0 1 0 2 0 ...
 $ parch   : int  0 2 2 2 2 0 0 0 0 0 ... 
```

您不能居中和缩放`pclass`或`sex`原样，因此需要将它们转换为虚拟变量。您可以使用`model.matrix`或插入符号`dummyVars`来执行此操作：

```
 > new <- model.matrix(survived ~ . - 1, data = etitanic)
 > colnames(new)
 [1] "pclass1st" "pclass2nd" "pclass3rd" "sexmale"   "age"      
 [6] "sibsp"     "parch" 
```

`-1`摆脱拦截。现在你可以`preProcess`在这个对象上运行了。

顺便说一句，`preProcess`忽略非数字数据在我的“待办事项”列表中，但它可能会导致不注意的人出错。

最大限度

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2013-04-24T14:58:50.777

这是排除因素或您想要考虑的任何因素的快速方法：

```
set.seed(1)
N <- 20
dat <- data.frame( 
    x = factor(sample(LETTERS[1:5],N,replace=TRUE)),
    y = rnorm(N,5,12),
    z = rnorm(N,-5,17) + runif(N,2,12)
)

#' Function which wraps preProcess to exclude factors from the model.matrix
ppWrapper <- function( x, excludeClasses=c("factor"), ... ) {
    whichToExclude <- sapply( x, function(y) any(sapply(excludeClasses, function(excludeClass) is(y,excludeClass) )) )
    processedMat <- predict( preProcess( x[!whichToExclude], ...), newdata=x[!whichToExclude] )
    x[!whichToExclude] <- processedMat
    x
}

> ppWrapper(dat)
   x          y           z
1  C  1.6173595 -0.44054795
2  A -0.2933705 -1.98856921
3  C  1.2177384  0.65420288
4  D -0.8710374  0.62409408
5  D -0.4504202 -0.34048640
6  D -0.6943283  0.24236671
7  E  0.7778192  0.91606677
8  D  0.2184563 -0.44935163
9  C -0.3611408  0.26075970
10 B -0.7066441 -0.23046073
11 D -1.5154339 -0.75549761
12 D  0.4504825  0.38552988
13 B  1.5692675  0.04093040
14 C  0.4127541  0.13161807
15 D  0.5426321  1.09527418
16 B -2.1040322 -0.04544407
17 C  0.6928574  1.12090541
18 B  0.3580960  1.91446230
19 E  0.3619967 -0.89018040
20 A -1.2230522 -2.24567237 
```

你可以传递任何你想要的东西`ppWrapper`，它会被传递给`preProcess`.

# algorithm - 给定矩阵 [i, j] 中的一个位置，找到它所属的块

> ID：14023427
> 
> 赞同：0
> 
> 时间：2012-12-24T16:00:54.207
> 
> 标签：algorithm, language-agnostic, matrix

好吧，我正在处理数独求解算法和生成问题，但仍停留在相当简单的任务上。我已经检查了一个数字是否真的适合按行和按列的位置。但让我抓狂的是块检查，即数字是否真的适合 3x3 块。

它必须足够简单，但我无法真正找到解决方案。简而言之，我想知道矩阵中某个位置所属的 3x3 块。以下是一些断言案例。块号、行号和列号索引从 0 开始。

```
assert("x( 0, 8 ) === 2"); 
assert("x( 8, 8 ) === 8"); 
assert("x( 3, 3 ) === 4"); 
assert("x( 3, 7 ) === 5"); 
assert("x( 7, 1 ) === 6"); 
```

`x( i , j )`返回块号，其中`i`= row 和`j`= col。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-24T16:04:16.337

不就是：

```
block = 3 * (i / 3) + (j / 3) 
```

（假设整数运算）。

我会编写一个支票，像这样（在伪 C++ 中）

```
// row = row to check
// col = column to check
// checkNum = number we are thinking of inserting
bool check(int row, int col, int checkNum)
{
    int blockRow = 3 * (row/3);
    int blockCol = 3 * (col/3);
    for(int i = 0 ; i < 9 ; i++)
    {
        if(grid[row][i] == checkNum) return false; // number exists in the row.
        if(grid[i][col] == checkNum) return false; // number exists in the col.
        if(grid[blockRow + i/3][blockCol + i%3] == checkNum) return false; // number exists in the block.
    }
    return true;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-24T16:10:21.680

这是javascript中的数独求解器。取自我创建的[DSSudokuSolver](https://github.com/dhilipsiva/dssudokusolver/blob/master/static/app.js)。CleanElements 函数的功能与您要求的类似。

```
CleanElements = function(comp_ary, Qsudoku){
    for(i=0; i<9; i++){
        for(j=0; j<9; j++){
            /*if(Qsudoku[i][j] != ""){
                comp_ary[i][j]=[];
            }*/
            for(k=0; k<9; k++){
                i_index = comp_ary[i][k].indexOf(Qsudoku[i][j]);
                if(i_index != -1){
                    comp_ary[i][k].splice(i_index, 1);
                }
                j_index = comp_ary[k][j].indexOf(Qsudoku[i][j]);
                if(j_index != -1){
                    comp_ary[k][j].splice(j_index, 1);
                }
            }
            if(i < 3){
                i_min = 0;
                i_max = 2;
            }
            else if(i < 6){
                i_min = 3;
                i_max = 5;
            }
            else{
                i_min = 6;
                i_max = 8;
            }

            if(j < 3){
                j_min = 0;
                j_max = 2;
            }
            else if(j < 6){
                j_min = 3;
                j_max = 5;
            }
            else{
                j_min = 6;
                j_max = 8;
            }

            for(i_box=i_min; i_box<=i_max; i_box++){
                for(j_box=j_min; j_box<=j_max; j_box++){
                    index = comp_ary[i_box][j_box].indexOf(Qsudoku[i][j]);
                    if(index != -1){
                        comp_ary[i_box][j_box].splice(index, 1);
                    }
                }
            }
        }
    }
    return comp_ary;
}

FindElements = function(comp_ary, Qsudoku){
    for(i=0; i<9; i++){
        for(j=0; j<9; j++){
            if(comp_ary[i][j].length == 1){
                if (Qsudoku[i][j] == ""){
                    Qsudoku[i][j] = comp_ary[i][j][0];
                    comp_ary[i][j] = [];
                }
            }
        }
    }
    return Qsudoku;
}

IsThereNullElement = function(Qsudoku){
    for(i=0; i<9; i++){
        for(j=0; j<9; j++){
            if(Qsudoku[i][j] == ""){
                return false;
            }
        }
    }
    return true;
}

InitEmptyArray = function(){
    empty_ary = Array();
    for(i=0; i<9; i++){
        empty_ary[i] = Array();
        for(j=0; j<9; j++){
            empty_ary[i][j] = Array();
            for(k=0; k<9; k++){
                empty_ary[i][j][k] = (k+1).toString();
            }
        }
    }
    return empty_ary;
}

DSSolve = function(Qsudoku){
    comp_ary = InitEmptyArray(); //Complementary Array
    window.comp_ary_old = comp_ary;
    IterationMax = 5000;

    while(true){
        IterationMax -= 1;
        comp_ary = CleanElements(comp_ary, Qsudoku);
        console.log(comp_ary);

        if(window.comp_ary_old == comp_ary){
            //implement this.
        }
        else{
            window.comp_ary_old = comp_ary;
        }

        Qsudoku = FindElements(comp_ary, Qsudoku);
        //console.log(Qsudoku);

        if(IsThereNullElement(Qsudoku)){
            return Qsudoku;
        }

        if(IterationMax == 0){
            return null;
        }
    }
} 
```

# objective-c - NSRegularExpression 与算术

> ID：14023429
> 
> 赞同：4
> 
> 时间：2012-12-24T16:01:08.393
> 
> 标签：objective-c, regex, nsregularexpression

我想更改 HTML 字符串中的字体大小，我必须**为其大小的一半。**

例如

```
<div style="font-family:'Arial';font-size:43px;color:#ffffff;"> 
```

将会

```
<div style="font-family:'Arial';font-size:21.5px;color:#ffffff;"> 
```

和

```
<div style="font-size:12px;"> 
```

将会

```
<div style="font-size:6px;"> 
```

我该怎么做`NSRegularExpression`？

请注意，12 和 6 以及 43 和 21.5 只是示例。我需要正则表达式，因为它必须是不同字体大小的通用解决方案

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-24T18:17:46.710

使用真正的 HTML 解析器来保持理智。用于此的 XML 解析器非常脆弱。有十几种完全有效的 HTML 语法变体会破坏 NSAddict 的表达方式。

我建议阅读这个问题上投票最多的答案，因为它同样适用于 HTML，也适用于 XHTML 或 XML。

[RegEx 匹配打开的标签，XHTML 自包含标签除外](https://stackoverflow.com/questions/1732348/regex-match-open-tags-except-xhtml-self-contained-tags)

请注意，iOS / OS X 系统框架包含 HTML/XML 解析功能。使用那些。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-24T16:05:16.490

你可以自己做这个`NSString`，实际上很容易。

```
[string stringByReplacingOccurrencesOfString:@"font-size:12px;" withString:@"font-size:6px;"]; 
```

* * *

复制这个函数

```
- (NSString *)setFontSize:(int)fontSize inHTMLString:(NSString *)htmlString {
    NSRegularExpression *regex = [NSRegularExpression regularExpressionWithPattern:@"font-size:[0-9]+px;" options:NSRegularExpressionCaseInsensitive error:nil];
    NSString *newString = [regex stringByReplacingMatchesInString:htmlString options:NSRegularExpressionCaseInsensitive range:NSMakeRange(0, htmlString.length) withTemplate:[NSString stringWithFormat:@"font-size:%dpx;", fontSize]];

    return newString;
} 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-01-01T22:49:59.213

我有点不愿意使用正则表达式给出答案，因为已经反复声明，使用正则表达式解析 HTML 被认为是有害的、不可能的、对你的思想有害的等等。所有这些都是正确的，我无意声称有什么不同。

但即使在所有这些警告之后，OP 也明确要求提供正则表达式解决方案，所以我将分享这段代码。它至少可以用作一个示例，如何通过遍历正则表达式的所有匹配项来修改字符串。

```
NSString *htmlString =
    @"<div style=\"font-family:'Arial';font-size:43px;color:#ffffff;\">\n"
    @"<div style=\"font-size:12px;\">\n";

NSRegularExpression *regex;
regex = [NSRegularExpression regularExpressionWithPattern:@"font-size:([0-9]+)px;"
                                                  options:0
                                                    error:NULL];

NSMutableString *modifiedHtmlString = [htmlString mutableCopy];
__block int offset = 0;
[regex enumerateMatchesInString:htmlString
                        options:0
                          range:NSMakeRange(0, [htmlString length])
                     usingBlock:^(NSTextCheckingResult *result, NSMatchingFlags flags, BOOL *stop) {
                         // range = location of the regex capture group "([0-9]+)" in htmlString:
                         NSRange range = [result rangeAtIndex:1];
                         // Adjust location for modifiedHtmlString:
                         range.location += offset;
                         // Get old point size:
                         NSString *oldPointSize = [modifiedHtmlString substringWithRange:range];
                         // Compute new point size:
                         NSString *newPointSize = [NSString stringWithFormat:@"%.1f", [oldPointSize floatValue]/2];
                         // Replace point size in modifiedHtmlString:
                         [modifiedHtmlString replaceCharactersInRange:range withString:newPointSize];
                         // Update offset:
                         offset += [newPointSize length] - [oldPointSize length];
                     }
 ];

NSLog(@"%@", modifiedHtmlString); 
```

*输出：*

```
<div style="font-family:'Arial';font-size:21.5px;color:#ffffff;">
<div style="font-size:6.0px;"> 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-01-07T06:27:30.530

我会为此使用 DTCoreText。它为您解析这个 HTML 并构造一个属性字符串。然后，您可以根据自己的喜好调整字体。最后，您可以使用 DTCoreText 绘制属性字符串，或者将其转换回 HTML。

如果您坚持使用 HTML，那么我可以提供 DTHTMLParser，它是基于 libxml2 的基于 SAX 的 HTML 解析器。这可以解析任何 HTML。尽管您仍然必须拆分 CSS，这并不像您想象的那么简单，即使使用 RegEx 也是如此。我在 NSString 上有一个类别，它拆分参数，以便您可以使用修改后的值重构样式。

话虽如此，我的第一个建议可能最适合您。

# asp.net-mvc-4 - 遍历 List 的集合 I have what is probably simple problem, but I am stumped. I call a method from another assembly that returns me a List, this data is Excel spreadsheet data queried using LinqToExcel< 问问题 问问题 2012-12-24T16:01:08.533 599 次 This question shows research effort; it is useful and clear 1 This question does not show any research effort; it is unclear or not useful Bookmark this question. Show activity on this post. I have what is probably simple problem, but I am stumped. I call a method from another assembly that returns me a List, this data is Excel spreadsheet data queried using LinqToExcel. Under the scenes, that collection is actually a List<linqtoexcel.cell>. In LinqToExcel, that makes up a LinqToExcel.Row. I want to be able to bind this data to a Telerik ASP.NET MVC grid for viewing. Here's my controller code: TypeOfServiceCodeListingDetailViewModel model = new TypeOfServiceCodeListingDetailViewModel(); model.Excel_Data = new List<linqtoexcel.row>(); using (LinqToExcelReader reader = new LinqToExcelReader(fileName, true)) { previewData = reader.ReadRawDataByPage(5, 0); foreach (LinqToExcel.Row item in previewData) { model.Excel_Data.Add(item); } return View(new GridModel(model.Excel_Data)); } And in my view: @(Html.Telerik().Grid(Model.Excel_Data) .Name("Grid2") .HtmlAttributes(new { style = "width:400px;" }) .DataBinding(dataBinding => dataBinding.Ajax().Select("GetExcelData", "TypeOfService")) .Columns(columns => { columns.AutoGenerate(column => { column.Width = "150px"; }); })) Here's what my grid has headers like the below with no data: Capacity Count Thanks for the help! A partial answer to your questions is that a second menu bar cannot be added. Reference here. Every shell can optionally display a single menu bar using the setMenuBar(Menu menuBar) method of Shell. It's possible to create many menu bars in a shell, but only one can be visible in a shell at a time. Perhaps you can try creating a second shell window that hovers over the location where you want your second (right-aligned) menu. You will need to ensure that this shell always remains attached to that particular corner of the window. You might have problems if the size of the main shell is reduced, which might show one menu overlapping the other. Not a nice solution though. Perhaps use a toolbar instead with a filler (SWT#SEPARATOR_FILL) item? asp.net-mvc-4telerik-grid 4 1 回答 1 This answer is useful 0 这是解决我的问题的代码。我确信有更好的方法。 using (LinqToExcelReader reader = new LinqToExcelReader(modelDetail.FileName, true)) { var previewData = reader.ReadRawDataByPage(5, 0); List<list<string>> masterList = new List<list<string>>(); for (int x = 0; x < previewData.Count; x++) { List <string>list = new List<string>(); foreach (var cell in (LinqToExcel.Row)previewData[x]) { list.Add(cell); } masterList.Add(list); } var listTest = masterList; modelDetail.ExcelData = new List<exceldata>(); foreach (List <string>theList in masterList) { ExcelData xlsData = new ExcelData(); xlsData.Column1 = theList[0]; xlsData.Column2 = theList[1]; xlsData.Column3 = theList[2]; xlsData.Column4 = theList[3]; xlsData.Column5 = theList[4]; xlsData.Column6 = theList[5]; xlsData.Column7 = theList[6]; xlsData.Column8 = theList[7]; xlsData.Column9 = theList[8]; xlsData.Column10 = theList[9]; modelDetail.ExcelData.Add(xlsData); } 于 2012-12-28T21:55:54.123 回答 Related 1 php - 学说架构创建找不到常量 4 java - java for循环金字塔 2 ruby-on-rails - rails 按 created_at 日期分组记录 1 c++ - 为什么此代码会导致访问冲突？ 1 ruby-on-rails - 在 HAML / Rails 中使用嵌套数组时遇到问题 2 map - 我可以像 Java 互操作一样使用 require :吗？ 2 macos - NASM Hello World Mac OS X 中的段错误或总线错误 3 javascript - 提高 Javascript 性能的技巧 2 cuda - 将 Cuda 4.0 项目更新到 Cuda 4.2 1 java - 获取图像周围的像素颜色 Reference php × 1429865 c/c++ × 756500 nginx × 49975 mongodb × 159057 mybatis × 3233 anaconda × 13410 pycharm × 14671 python × 1902243 vscode × 56040 docker × 110988 github × 49000 flask × 49129 ffmpeg × 24037 jmeter × 16910 matplotlib × 63493 bootstrap × 54641

> ID：14023430
> 
> 赞同：1
> 
> 时间：
> 
> 标签：asp.net-mvc-4, telerik-grid

I have what is probably simple problem, but I am stumped. I call a method from another assembly that returns me a `List<object>`, this data is Excel spreadsheet data queried using `LinqToExcel`. Under the scenes, that collection is actually a `List<LinqToExcel.Cell>`. In `LinqToExcel`, that makes up a `LinqToExcel.Row`. I want to be able to bind this data to a Telerik ASP.NET MVC grid for viewing. Here's my controller code:

```
TypeOfServiceCodeListingDetailViewModel model = new TypeOfServiceCodeListingDetailViewModel();
model.Excel_Data = new List<LinqToExcel.Row>();
using (LinqToExcelReader reader = new LinqToExcelReader(fileName, true))
{
  previewData = reader.ReadRawDataByPage(5, 0);

  foreach (LinqToExcel.Row item in previewData)
  {
    model.Excel_Data.Add(item);
  }
  return View(new GridModel(model.Excel_Data));  
} 
```

And in my view:

```
@(Html.Telerik().Grid(Model.Excel_Data)
                .Name("Grid2")
                .HtmlAttributes(new { style = "width:400px;" })
                .DataBinding(dataBinding => dataBinding.Ajax().Select("GetExcelData", "TypeOfService"))
                .Columns(columns =>
                {
                  columns.AutoGenerate(column =>
                  {
                    column.Width = "150px";
                  });
                })) 
```

Here's what my grid has headers like the below with no data:

Capacity Count

Thanks for the help!

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-28T21:55:54.123

这是解决我的问题的代码。我确信有更好的方法。

```
using (LinqToExcelReader reader = new LinqToExcelReader(modelDetail.FileName, true))
{
  var previewData = reader.ReadRawDataByPage(5, 0);

  List<List<string>> masterList = new List<List<string>>();

  for (int x = 0; x < previewData.Count; x++)
  {
    List<string> list = new List<string>();

    foreach (var cell in (LinqToExcel.Row)previewData[x])
    {
      list.Add(cell);
    }

    masterList.Add(list);
  }

  var listTest = masterList;
  modelDetail.ExcelData = new List<ExcelData>();

  foreach (List<string> theList in masterList)
  {
    ExcelData xlsData = new ExcelData();
    xlsData.Column1 = theList[0];
    xlsData.Column2 = theList[1];
    xlsData.Column3 = theList[2];
    xlsData.Column4 = theList[3];
    xlsData.Column5 = theList[4];
    xlsData.Column6 = theList[5];
    xlsData.Column7 = theList[6];
    xlsData.Column8 = theList[7];
    xlsData.Column9 = theList[8];
    xlsData.Column10 = theList[9];

    modelDetail.ExcelData.Add(xlsData);
  } 
```</string></exceldata></string></string></list<string></list<string></linqtoexcel.row></linqtoexcel.cell>

# objective-c - 检查整个枚举的相等性？

> ID：14023436
> 
> 赞同：0
> 
> 时间：2012-12-24T16:01:59.843
> 
> 标签：objective-c, ios, macos, cocoa, enums

我有一个国际象棋益智游戏。

我想在枚举中设置错误的方块。

```
enum 1000H1wrong {11, 13, 15 21, 22}; 
```

我可以检查一下 ENTIRE 枚举 1000H1 中是否有一个数字是错误的。

```
if chesssquare == enum 1000H1wrong {        } 
```

与此相同：

```
if ((chesssquare == 11) || (chesssquare == 13) || (chesssquare == 15)    || (chesssquare == 21) || (chesssquare == 22)) {      } 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-24T16:06:03.087

请改用 NSArray。为了检查它是否包含数字使用：

```
NSArray *1000H1wrong = [NSArray arrayWithObjects: @11, @13, @15 @21, @22, nil];
[1000H1wrong containsObject: @(chesssquare) ]; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-24T20:57:50.060

没有自动方法来检查一系列枚举值中的成员资格。您可以按照 giorasch 的建议将它们放入 NSSet 中。但我的偏好是使用直接的 C 数组：

```
static int squares1001H1wrong[] = {11, 13, 15, 21, 22};

#define ARRAY_SIZE(array) (sizeof(array) / sizeof(array[0]))

static BOOL isInSquares1001H1wrong(int square)
{
    for (int i = 0; i < ARRAY_SIZE(squares1001H1wrong); ++i)
        if (squares1001H1wrong[i] == square)
            return YES;
    return NO;
} 
```

该数组是在编译时构造的，而不是在运行时构造的。不构造任何对象。测试是在没有单个方法调用的情况下进行的。

Objective-C 是 C 语言的超集。学习 C 以获得 Objective-C 的全部功能。有关避免 NSDictionary 元素的 NSArray 的示例，请参阅[Objective-C Is Still C (Not Java!)](https://qualitycoding.org/objective-c-is-c/)

# c# - 在哪里可以找到我的 X509 证书的“targetHost”？

> ID：14023438
> 
> 赞同：1
> 
> 时间：2012-12-24T16:02:29.470
> 
> 标签：c#, .net, ssl, x509certificate

在尝试设置时[`SslStream`](http://msdn.microsoft.com/en-us/library/system.net.security.sslstream.aspx)，该示例在客户端中有一个调用：

```
sslStream.AuthenticateAsClient(targetHost); 
```

因为[`AuthenticateAsClient`](http://msdn.microsoft.com/en-us/library/ms145060.aspx), 文件说 " `The value specified for targetHost must match the name on the server's certificate.`"

如何找到`targetHost`我的 x509 证书？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-24T18:05:38.640

规则因协议而略有不同。[RFC 6125：*在传输层安全性 (TLS) 的上下文中使用 X.509 (PKIX) 证书在 Internet 公钥基础设施中表示和验证基于域的应用程序服务身份*](https://www.rfc-editor.org/rfc/rfc6125)已经做出了跨协议协调工作。

话虽如此，RFC 6125 指南（适用于任何使用 SSL/TLS 的协议）与 HTTPS 的指南大致相同，后者在[RFC 2818（*HTTP over TLS*）第 3.1 节](https://www.rfc-editor.org/rfc/rfc2818#section-3.1)中定义。

简而言之，如果证书具有 DNS 类型的主题备用名称 (SAN) 扩展，则其中之一必须是您尝试连接的目标主机名。当没有此类扩展时，您必须查看证书的主题 DN 并找到通用名称 (CN) RDN：它必须与目标主机名匹配。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-24T16:15:37.903

我不是该领域的专家，但我建议这`targetHost`是服务器的名称，并且您的 X509Certificate 需要是为验证您的服务器而颁发的证书。在这种情况下，它将是证书的[主题属性](http://msdn.microsoft.com/en-us/library/system.security.cryptography.x509certificates.x509certificate.subject.aspx)。

# webstorm - 如何在Webstorm中同时弹出代码完成提示和单词扩展？

> ID：14023442
> 
> 赞同：1
> 
> 时间：2012-12-24T16:03:06.827
> 
> 标签：webstorm

我想显示弹出代码完成提示和单词扩展（在 Vim 中等于 Ctrl + N）。现在我按 Ctrl+E 弹出展开词，按 Ctrl + Shift 弹出代码完成提示...

你知道如何做到这一点吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-24T16:12:59.110

键盘映射鲜为人知但可能很强大的功能之一是您可以将多个操作映射到同一个快捷方式。您可以尝试为您希望同时发生的两件事执行此操作。

在**Settings → Keymap**中，您可以更改由什么快捷方式触发的操作。

您可以通过名称（如果您知道它们在 WebStorm 中的名称）或快捷方式（通过单击操作名称搜索框旁边的“*按快捷方式查找操作”按钮）来查找要查找的操作。*

一旦您决定了要触发这两个操作的键盘快捷键，您就可以将它分配给这两个操作。您可能会收到一个关于可能与其他操作发生冲突的弹出窗口，可以选择**删除**其他快捷方式或**保留**它们。

此时可能很明显，但您希望**保留**另一个快捷方式，以便触发这两个操作。

希望这可以帮助！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-24T16:15:36.493

我认为不可能，请检查相关请求：

*   [IDEABKL-3262](http://youtrack.jetbrains.com/issue/IDEABKL-3262)单词完成
*   [IDEABKL-6021](http://youtrack.jetbrains.com/issue/IDEABKL-6021)引入类似于扩展词的新完成类型

第一个请求很可能是您的用例：

> 当基于上下文语言分析的任何完成失败或不存在时，提供合理的变体来完成

# android - 我无法让 ViewPageIndicator 滑动

> ID：14023447
> 
> 赞同：0
> 
> 时间：2012-12-24T16:03:35.260
> 
> 标签：android, actionbarsherlock, swipe, viewpagerindicator, android-holo-everywhere

我创建了一个新项目并包含了该`HoloEveryWhere`库。然后我决定添加`ViewPageIndicator`. 我从示例中复制了所有代码，`ViewPageIndicator`但它不起作用。我尝试使用`SherlockFragment`，但这也不起作用。所以我`HoloEveryWhere`从我的项目中删除了，但显然这不是问题，因为它仍然没有滑动。

编辑：

这是我的xml：

```
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
xmlns:tools="http://schemas.android.com/tools"
android:layout_width="match_parent"
android:layout_height="match_parent"
tools:context=".MainActivity" >

<com.viewpagerindicator.TabPageIndicator
    android:id="@+id/indicator"
    android:layout_height="wrap_content"
    android:layout_width="fill_parent"
    />
<android.support.v4.view.ViewPager
    android:id="@+id/pager"
    android:layout_width="fill_parent"
    android:layout_height="0dp"
    android:layout_weight="1"
    /> 
```

你看，我只是从样本中复制了两个标签。这是main.java：

```
package com.example.test;

import android.os.Bundle;
import android.support.v4.app.Fragment;
import android.support.v4.app.FragmentActivity;
import android.support.v4.app.FragmentManager;
import android.support.v4.app.FragmentPagerAdapter;
import android.support.v4.view.ViewPager;
import com.viewpagerindicator.TabPageIndicator;

public class MainActivity extends FragmentActivity {
private static final String[] CONTENT = new String[] { "Recent", "Artists", "Albums", "Songs", "Playlists", "Genres" };

@Override
protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_main);

    FragmentPagerAdapter adapter = new GoogleMusicAdapter(getSupportFragmentManager());

    ViewPager pager = (ViewPager)findViewById(R.id.pager);
    pager.setAdapter(adapter);

    TabPageIndicator indicator = (TabPageIndicator)findViewById(R.id.indicator);
    indicator.setViewPager(pager);
}

class GoogleMusicAdapter extends FragmentPagerAdapter {
    public GoogleMusicAdapter(FragmentManager fm) {
        super(fm);
    }

    @Override
    public Fragment getItem(int position) {
        return TestFragment.newInstance(CONTENT[position % CONTENT.length]);
    }

    @Override
    public CharSequence getPageTitle(int position) {
        return CONTENT[position % CONTENT.length];
    }

    @Override
    public int getCount() {
      return CONTENT.length;
    }
}
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-24T16:49:46.007

你的布局是你困难的根源。

如果要使用`RelativeLayout`，则需要指定`RelativeLayout`go 里面的小部件的位置。默认情况下，它们都在左上角，后来的孩子（你的）在 Z 轴上`ViewPager`漂浮在早期的孩子（你的）之上。`TabPageIndicator`因此，使用您当前的布局，用户无法触摸您的`TabPageIndicator`.

切换到 a`vertical` `LinearLayout`或使用适当的属性（例如`android:layout_below`）来组织您的小部件，`RelativeLayout`使它们不会重叠。

层次结构视图是帮助您识别此类问题的有用工具。

# php - are zend engine globals share memory across processes?

> ID：14023451
> 
> 赞同：0
> 
> 时间：2012-12-24T16:03:50.517
> 
> 标签：php, php-internals

I've been going through [PHP's source code and the mysql_pconnect function](http://lxr.php.net/xref/PHP_5_3/ext/mysql/php_mysql.c#818) and noticed it's using some kind of `HashTable persistent_list` which is defined in [zend_globals](http://lxr.php.net/xref/PHP_5_3/Zend/zend_globals.h#222).

The question is, how are this globals and variables are preserved across requests when PHP is set as mod apache/fcgi. If it's a new PHP process spawned for every request those variables should not be preserved.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-26T11:21:50.253

PHP-FPM 重用上下文，允许持久连接在 FCGI 中工作。值得考虑的是 PHP-FPM 最初会创建多个进程，因此您最终仍会获得多个连接，每个进程或上下文一个连接。

需要考虑的是，“持久连接弊大于利”是#php.pecl 中经常提到的一句话。连接的开销很轻，PHP 适合这种处理。在设计为持续运行的语言中，连接的开销可能更大（通常是因为，简单的连接会影响比程序直接操作的对象更多的对象），因此持久连接或池连接是有意义的。PHP 的设计目的是尽可能快地完成所有事情，而且它使用了多少资源来做这件事——一切都必须在大约 250 毫秒内运行——连接到 mysql 不会像在其他框架中那样触发一堆钩子语言，所以开销非常小。此外，

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-12-24T16:09:24.657

> The question is, how are this globals and variables are preserved across requests when PHP is set as mod apache/fcgi.

As apache module, they are shared because apache httpd itself is still running. That running process had spawned PHP and will spawn other PHPs in the future. As the child threads can relate to their parent, it can and is stored in the parents memory space.

As FCGI, this could be technically possible as long as the binary is already running, however this has not been implemented with the FPM. I would also say, it makes no real sense for FCGI, too, because it's per script and also timeouts are involved, so the life-span is much shorter as with the whole webserver.

# python - 在 Python 中为 Random.random() 组装浮点数

> ID：14023453
> 
> 赞同：2
> 
> 时间：2012-12-24T16:03:58.457
> 
> 标签：python, random, floating-point, floating-point-precision

我正在尝试从 python 标准库中实现我自己版本的[Random 类。](http://docs.python.org/2/library/random.html)我可以生成随机位，并实现了 getrandbits(n) 函数。但是超类不使用这个函数来计算从 random() 返回的浮点数。所以我必须自己实现：

```
def random(self):
    exp = 0x3FF0000000000000
    mant = self.getrandbits(52)
    return struct.unpack("d", struct.pack("q", exp^mant))[0]-1.0 
```

我使用符号 0（正）、指数 1023（2^0 = 1）和随机尾数。所以我从 [1.0, 2.0) 中得到一个数字。random() 函数必须在 [0.0, 1.0) 中返回一个数字，所以我在返回之前减去 1.0。由于我不是浮点数方面的专家，因此我不确定这样做是否正确。我不会因为减法而失去精度吗？我可以从随机位构建数字，使其在 [0.0, 1.0) 中不减法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-24T17:32:44.313

您的实现很好：假设它`getrandbits`本身足够随机，您的实现将以相等的概率生成表单的每个数字`n / 2^52`，`0 <= n < 2^52`因此它是 . 上均匀分布的一个很好的近似值`[0, 1)`。您使用的减法不是问题：减法的结果始终可以精确表示，因此减法中不存在舍入或精度损失。

Python 的`random()`实现沿着`return self.getrandbits(53) / 2**53.` 效果相似的路线做了更多的事情，只是输出的分布现在是原来的两倍：您以相等的概率获得表格`n / 2^53`的每个数字。`0 <= n < 2^53`大多数应用程序在实践中不太可能注意到这两种实现之间的差异。如果您关心速度，那么这也可能会更快，尽管您应该像往常一样进行分析以查明是否确实如此。

这些都不是完美的：在`2^62`range 中大约有不同的 IEEE 754 binary64 浮点数`[0.0, 1.0)`，并且您的实现只能生成`2^52`不同的输出，因此上述任何一种实现都不能生成大多数浮点数。更好的实现可以生成范围内的`random()`每个浮点数，其概率等于该轮的子区间的长度到某种形式的最近舍入。然而，这样的实现会更加复杂（尽管实现起来并不特别困难），并且很少有应用程序会从更大的输出集中受益。正如 Python 之禅所说：“实用胜于纯洁。”`x``[0.0, 1.0]``[0.0, 1.0)``x`

* * *

编辑：为了说明上面的最后一段，这里有一些代码。该`uniform`函数用于根据上述描述`getrandbits`生成均匀分布的浮点数。`[0, 1]`

```
"""                                                                                                                                                                                                                                         
High quality uniform random variable on [0, 1].                                                                                                                                                                                             

Simulates round(X) where X is a real random variable uniformly distributed on                                                                                                                                                               
the interval [0, 1] and round is the usual round-to-nearest rounding function                                                                                                                                                               
from real numbers to floating-point.                                                                                                                                                                                                        

"""
from __future__ import division
import random

precision = 53
emin = -1021

def random_significand():
    return (random.getrandbits(precision) + 1) // 2 / (2**precision)

def uniform():
    for i in xrange(1 - emin):
        if random.getrandbits(1):
            return (random_significand() + 0.5) / 2**i
    # Subnormal                                                                                                                                                                                                                             
    return random_significand() / 2**i 
```

# git - IntelliJ and git, how to ignore white space changes from IDEA?

> ID：14023454
> 
> 赞同：9
> 
> 时间：2012-12-24T16:04:00.810
> 
> 标签：git, intellij-idea

Using `git`, we can `git diff --check`, which would

> -- warn if changes introduce trailing whitespace or space/tab indents

**Can I configure `IntelliJ` to only detect change if it does not begin and end with whitespace modifications? (like formatting)**

In other words, when i click this icon, i only want to see changes made to my code, excluding formatting and other white space changes

![enter image description here](../Images/f22dd43207f046f241f763e6061baecb.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2014-11-11T23:06:33.357

如上所述：

> IMO，IDEA-75868 应该涵盖这种情况。如果没有，请提交新请求。

此功能尚不可用，但正在跟踪中。

**参考**

*   [IDEA-75868 提交差异视图：提供忽略空格选项](http://youtrack.jetbrains.com/issue/IDEA-75868)

# opengl - OpenGL三角扇

> ID：14023460
> 
> 赞同：1
> 
> 时间：2012-12-24T16:04:53.390
> 
> 标签：opengl

我有一个顶点缓冲区，这些点将成为每个圆的中心（三角形扇形）。我该如何处理这些，比如说在这个点周围画 10 个三角形，然后移动到下一个点？我找不到任何示例代码。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-24T16:06:21.877

如果您使用的是旧管道，`glEnd()`则必须这样做。`glBegin()`

如果您正在发出绘图调用，您可以使用图元重新启动功能，其中可以指定索引作为新图元的开始。感谢datenwolf指出这一点，我已经清楚地将它从我的记忆中[抹去。](https://stackoverflow.com/users/524368/datenwolf)

但是，就个人而言，我仍然认为您最好只使用索引三角形，然后您可以随时重新使用您想要的任何顶点。它更简单，驱动程序/硬件会感谢您。

（换句话说，不要使用`GL_TRIANGLE_FAN`- 只需使用`GL_TRIANGLES`。无论如何，这都是硬件绘制）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-24T19:45:08.790

您可以使用原始重启索引来执行此操作。您设置一个特殊的索引值（通常是用于索引的类型可表示的最大数字）。然后，每当在索引缓冲区中遇到这个索引时，就会启动一个新的原语，就好像多次调用 glDraw... 一样。

[http://www.opengl.org/sdk/docs/man3/xhtml/glPrimitiveRestartIndex.xml](http://www.opengl.org/sdk/docs/man3/xhtml/glPrimitiveRestartIndex.xml)

# php - 如何像这样将json显示到客户端

> ID：14023461
> 
> 赞同：-4
> 
> 时间：2012-12-24T16:04:57.770
> 
> 标签：php, json

如何像这个链接一样将json显示到客户端

[https://alpha-api.app.net/stream/0/posts/stream/global](https://alpha-api.app.net/stream/0/posts/stream/global)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-24T16:13:33.013

我相信你在谈论缩进，对吧？如果你是，你应该注意到这个 json 输出被一个`<pre>`标签包围，并用空格来分隔数据：

```
{     "data": [         {             "canonical_url": "https://alpha.app.net/marcozehe/post/2172854", 
```

你有没有尝试复制它？您还可以检查另一个问题： [Javascript：如何直接从对象生成格式化的易于阅读的 JSON？](https://stackoverflow.com/questions/3515523/javascript-how-to-generate-formatted-easy-to-read-json-straight-from-an-object)

只是检查：您不是在谈论类似 REST 的 URL，是吗？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-24T16:15:16.437

使用[`JSON_PRETTY_PRINT`](http://php.net/manual/en/function.json-encode.php)选项：

```
$data = Array( 
    "Foo" => "Bar",
    "Fiz" => "Buz"
);

echo json_encode($data, JSON_PRETTY_PRINT); 
```

这需要 PHP 5.4.0 或更高版本。输出如下：

```
{
    "Foo": "Bar",
    "Fiz": "Buz"
} 
```

# python - Python if modifier precedence

> ID：14023463
> 
> 赞同：-1
> 
> 时间：2012-12-24T16:05:12.000
> 
> 标签：python

Sorry, I'm sure it was asked a billion times, but I couln't have found exact answer:

```
var = value if condition else other_value 
```

What is the precedence of `if .. else` relative to assignment? Like in C/Java ternary or not?

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-24T16:08:22.610

if/else 表达式是一个表达式，而赋值是一个语句。所以在Python中，你不需要考虑两者的优先级，if/else会先做。

在 C 中，赋值也是一个表达式，因此您可以以 Python 中无法实现的方式混合和匹配条件和赋值。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-12-24T16:07:47.503

赋值总是具有最低优先级；它不是表达式的一部分。

实际上，赋值是一个*语句*；你永远不能在表达式中使用赋值。

# javascript - Javascript - Prompt for values (and add values to array) until user inputs a specific value

> ID：14023464
> 
> 赞同：1
> 
> 时间：2012-12-24T16:05:11.627
> 
> 标签：javascript, arrays, loops

Ladies and gentlemen,

I'm stuck. I've been pondering this (and obviously have failed since I'm asking for your valuable assistance) in trying to get my code to work.

I need to come up with a simple (...I'm sorry, i'm new to this) code that prompt users to keep entering names using a loop. If the user does not enter 'q'(without quotes) and if the value entered is NOT null, then the value entered should be added to the array (in my case, names).

If the user enters 'q', the loop should stop, 'q' will not be entered in the array and the list of names should be printed (through the second function in my code).

Here's what I have so far... I can make the code work if I tell the loop to run i<5... it runs 5 times and then it stops. But it fails if i do i < names.length..it causes it say that length is null or not an object (on line 10). That's problem one. And for the life of me, I can't figure out how to add the logic that will run the loop until user enters q.

Please help!

Thank you.

```
function getNames(){
var names = new Array();
    for(i=0;i<names.length;i++){ /*if i do i=0;i<5;i++, the code works; it doesn't with this*/
    names[i] = prompt("Enter an item to add to the Name list (enter \'q\' to quit","");
}
printNames(names);
}

function printNames(names) {
for(x=0; x < names.length;x++){
document.write(names[x] + '<br />');
}

}
getNames();
printNames(); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-24T16:08:13.933

我确信在你的课堂/书中某处谈到了[while loops](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Statements/while)。因此，如果您希望他们无限制地继续输入，您想使用 while 循环。

```
while (myCondition===true) {
  //do something
} 
```

现在看看你的 for 循环，找出它失败的原因。

```
for(i=0;i<names.length;i++) 
```

看看它在做什么：

*   我 = 0
*   名称.长度 = 0

是`0 < 0`吗？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-24T16:15:14.013

从问题 1 开始：

您的名称数组以长度属性 0 开头，因此您的第一个 for 循环不会运行，因为 0 不小于 0。

这导致了问题2：

再次，因为您的名称数组中没有输入任何内容，您的第二个 for 循环再次什么也不做，也不执行 document.write，因为您的数组的长度属性仍然为 0。

# url - How to name download file

> ID：14023471
> 
> 赞同：1
> 
> 时间：2012-12-24T16:05:59.240
> 
> 标签：url, download, filenames

I'm calling a web service to download a file, but it always assigns a generic name to the download. Every file I download has the same name.

So I appended "/filename.pdf?a=true" to the end of the URL as follows:

```
 http://localhost/api/node/content/b52b3136-1cf0-48f2-a109-676a16015612/myfilename.pdf?a=true 
```

Now on Firefox, the file downloads with the desired: myfilename.pdf. But this isn't working on IE or Chrome.

What is wrong with this?

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-24T16:13:44.707

You want a header: `Content-Disposition: attachment; filename=my_file_name.pdf`

Will force a download (instead of an inline display) and set the file name. If you do **not** force a file name, but allow inline display (via PDF browser plugin) the filename is meaningless, which is, why it is often ignored by browsers.

# machine-learning - 机器学习的特征选择

> ID：14023474
> 
> 赞同：3
> 
> 时间：2012-12-24T16:06:25.137
> 
> 标签：machine-learning

我正在对网站进行分类。其中一项任务是过滤掉色情内容。我使用的是带有词袋的二进制 SVM 分类器。我有一个关于我应该在 BoW 中包含的词的问题：它应该只是与色情相关的词（色情网站上常见的词）还是还应该包括色情网站上很少发现但在其他网站上经常出现的词好吧（例如，“数学”、“工程”、“吉他”、“出生”等）？

我遇到的问题是医学和家庭相关网站上的误报。如果我只寻找与色情相关的词，那么这些网站的向量最终会非常稀疏。像“性”这样的词经常出现，但在完全无辜的上下文中。

我也应该包括非色情词吗？还是我应该看看其他解决误报的方法？建议是最受欢迎的。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-27T01:18:05.803

主题建模（尝试潜在 Dirichlet 分配[http://en.wikipedia.org/wiki/Latent_Dirichlet_allocation](http://en.wikipedia.org/wiki/Latent_Dirichlet_allocation)）将能够很好地处理这个问题。

将文档主题作为特征提供给分类器将有助于避免您遇到的问题。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-24T18:31:48.290

另一种可能的方法是专门为色情网站制作**语言模型。**我认为，如果您有 n-gram（例如 3-gram），则应该更容易识别特定单词“sex”是否与色情或其他领域有关。

一个理论上的猜测：如果你有这样的语言模型，你甚至不需要分类器。（困惑，n-gram 的可能性应该足以决定......）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-24T16:41:00.273

您应该包含尽可能多的单词；理想情况下是一本完整的字典。分类器能够通过确定网站与您定义的类的相似程度来识别网站。您需要为其提供识别两个类的方法，而不仅仅是其中一个。想想被要求识别图片中的猫，但只是被展示猫来训练。虽然对于任何特定的图片，您可能会说它看起来不像猫（或者更确切地说是您见过的任何猫），但您无法确定是否有足够的猫性来让它成为一只猫。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-01-01T15:09:00.883

包括所有的词，让 SVM 决定哪些是有用的 - 分类器需要能够区分正面和负面，负面也可以用不在目标域（色情）中的词来表征，从而使示例之间的拆分可能更清晰。

最好不仅使用单个单词，还使用 ​​n-gram（例如，高于某个频率的 2 或 3-gram）作为附加特征（这应该有助于解决药物误报的问题）。如果您使用 TF-IDF 加权，N-gram 也将适合您的方法。

# java - 带有 BigDecimal 的 Spring JDBC queryForObject 失败

> ID：14023483
> 
> 赞同：4
> 
> 时间：2012-12-24T16:06:59.140
> 
> 标签：java, exception, spring-jdbc

> Java 1.7/弹簧 3.1

看看下面的代码。

```
BigDecimal value = queryAsObject (BigDecimal.class, 
    "select balance from financial.accounts where account_id = ?", accountId); 
```

其中 queryAsObject 来自一个抽象父类，它基本上执行 CRUD 操作。

```
public <T> T queryAsObject(Class<T> modelClass, String sql, Object... args) {
        return jdbcTemplate.queryForObject(sql, new HawkBeanPropertyRowMapper<T>(modelClass), args);
    } 
```

非常直接的spring jdbc调用。但是，它会导致以下异常：

```
org.springframework.web.util.NestedServletException: Request processing failed; 
nested exception in org.springframework.beans.BeanInstantiationException: 
Could not instantiate bean class [java.math.BigDecimal]: 
Is it an abstract class?; nested exception is 
java.lang.InstantiationException: java.math.BigDecimal 
```

有根本原因：

```
org.springframework.beans.BeanInstantiationException: Could not instantiate bean class [java.math.BigDecimal]: Is it an abstract class?; nested exception is java.lang.InstantiationException: java.math.BigDecimal
    org.springframework.beans.BeanUtils.instantiate(BeanUtils.java:81)
    org.springframework.jdbc.core.BeanPropertyRowMapper.mapRow(BeanPropertyRowMapper.java:233)
    org.springframework.jdbc.core.RowMapperResultSetExtractor.extractData(RowMapperResultSetExtractor.java:92)
    org.springframework.jdbc.core.RowMapperResultSetExtractor.extractData(RowMapperResultSetExtractor.java:1)
    org.springframework.jdbc.core.JdbcTemplate$1.doInPreparedStatement(JdbcTemplate.java:649)
    org.springframework.jdbc.core.JdbcTemplate.execute(JdbcTemplate.java:587)
    org.springframework.jdbc.core.JdbcTemplate.query(JdbcTemplate.java:637)
    org.springframework.jdbc.core.JdbcTemplate.query(JdbcTemplate.java:666)
    org.springframework.jdbc.core.JdbcTemplate.query(JdbcTemplate.java:674)
    org.springframework.jdbc.core.JdbcTemplate.queryForObject(JdbcTemplate.java:734) 
```

这是什么意思？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-24T16:15:49.110

我认为`JdbcTemplate.queryForObject(String sql, RowMapper<T> rowMapper, Object... args)`是为了将 ResultSet 绑定到 Beans/POJO。

你需要另一个重载版本`queryForObject(String sql, Class<T> requiredType, Object... args)`，即

```
public <T> T queryAsScalar(Class<T> scalarClass, String sql, Object... args) {
        return jdbcTemplate.queryForObject(sql, scalarClass, args);
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-24T16:18:52.860

您的代码似乎正在使用`BeanPropertyMapper`. 它将提供的类视为 Java bean，通过调用默认构造函数将其实例化，然后通过调用 setter 设置属性。`java.math.BigDecimal`没有默认构造函数，这就是它失败的地方。

您应该改用`queryForObject(String sql, Class<T> requiredType, Object... args)`方法。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-24T16:55:28.657

这绝对有效

```
JdbcTemplate t = new JdbcTemplate(ds);
BigDecimal id = t.queryForObject("select id from bank where id=1", BigDecimal.class); 
```

# osx-lion - 将目录添加到 .zshrc 中的路径

> ID：14023484
> 
> 赞同：12
> 
> 时间：2012-12-24T16:07:13.470
> 
> 标签：osx-lion, zsh, zshrc

我已经在这个问题上讨论了几天了。我使用`zsh`并且需要设置目录路径，以便识别我使用的命令。到目前为止遵循这些步骤：

```
cd ~

ls -al 
```

`ls -al`向我展示了这些文件：

```
.oh-my-zsh
.profile
.putty
.rediscli_history
.ringo-history
.ssh
.subversion
.viminfo
.zcompdump
.zsh-update
.zsh_history
.zshrc 
```

我假设我需要添加路径`.zshrc`，所以：

```
open -e .zshrc 
```

在文件的末尾，我添加了我将用来设置我的项目的命令的路径（使用 ringojs）：

```
export PATH=Users/repos/ringojs/bin/:$PATH 
```

关闭文件，重新启动终端应用程序，重新启动计算机，但是找不到`ringo-admin`位于上述路径下的命令（ ）（ ）：`/Users/repos/ringojs/bin`

```
ringo-admin create --google-appengine MyAppName
zsh: command not found: ringo-admin 
```

请帮帮我，如果有帮助的话，这是我的`.zshrc`文件内容：

```
# Path to your oh-my-zsh configuration.
ZSH=$HOME/.oh-my-zsh

# Set name of the theme to load.
# Look in ~/.oh-my-zsh/themes/
# Optionally, if you set this to "random", it'll load a random theme each
# time that oh-my-zsh is loaded.
ZSH_THEME="robbyrussell"

# Example aliases
# alias zshconfig="mate ~/.zshrc"
# alias ohmyzsh="mate ~/.oh-my-zsh"

# Set to this to use case-sensitive completion
# CASE_SENSITIVE="true"

# Comment this out to disable bi-weekly auto-update checks
# DISABLE_AUTO_UPDATE="true"

# Uncomment to change how many often would you like to wait before auto-updates occur? (in days)
# export UPDATE_ZSH_DAYS=13

# Uncomment following line if you want to disable colors in ls
# DISABLE_LS_COLORS="true"

# Uncomment following line if you want to disable autosetting terminal title.
# DISABLE_AUTO_TITLE="true"

# Uncomment following line if you want red dots to be displayed while waiting for completion
# COMPLETION_WAITING_DOTS="true"

# Which plugins would you like to load? (plugins can be found in ~/.oh-my-zsh/plugins/*)
# Custom plugins may be added to ~/.oh-my-zsh/custom/plugins/
# Example format: plugins=(rails git textmate ruby lighthouse)
plugins=(git)

source $ZSH/oh-my-zsh.sh

# Customize to your needs...
export PATH=Users/repos/ringojs/bin/ringo-admin:$PATH 
```

请一步一步指导我，因为我是新手`zsh`。谢谢。

**更新：**

echo $PATH 显示我最近添加的目录：

```
/Users/repos/ringojs/bin/ringo-admin:/usr/bin:/bin:/usr/sbin:/sbin:/usr/local/bin:/usr/X11/bin:/usr/local/git/bin 
```

我不明白为什么总是找不到该命令。

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2012-12-24T16:17:35.437

您缺少前导斜杠。尝试：

```
export PATH=/Users/repos/ringojs/bin/:$PATH 
```

# windows - Windows 8 上 Windows.Security.Cryptography 类的更快替代方案

> ID：14023486
> 
> 赞同：0
> 
> 时间：2012-12-24T16:07:23.217
> 
> 标签：windows, windows-8, cryptography

我正在为 Windows 8 编写一个加密大量数据（一次超过 100MB）的程序，并注意到即使使用多线程，Windows 8 上的加密 API 也比以前的加密服务提供程序 (CSP) 慢Windows 版本。我想知道是否有更快的方法在 Windows 8 上使用 AES 加密文件。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-24T20:06:08.117

你可以试试 SecureBlackbox 库，它是商业的（免费试用），但它自己实现了所有的东西。而且，无论如何，任何托管代码都会比本机代码慢。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-02T07:01:47.617

Microsoft CryptoAPI Next Generation (CNG) 是旧 CSP 的继承者，它是完全原生的。它首先在 Windows Vista 中实现，在 W8 中仍然可用。

为什么不使用它们？

# jquery - 如何覆盖由我的 CMS 注入的 JavaScript 代码

> ID：14023488
> 
> 赞同：2
> 
> 时间：2012-12-24T16:07:34.077
> 
> 标签：jquery, drupal, jquery-events

我想覆盖 Drupal 菜单编写的悬停事件。因为我无法修改 Drupal 编写的代码，所以我想知道如何查看它然后覆盖它。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-24T16:16:04.813

您可以通过检查页面中包含的 JavaScript 来查看代码是如何工作的......我想像 Drupal 这样的 CMS，虽然 JavaScript 构建在 jQuery 之上，但试图找到添加此事件的确切位置将类似于寻找针大海捞针。

* * *

虽然`$('selector').off('eventName');`在基本情况下可以工作（即，如果事件处理程序*直接*附加到元素），但在处理程序绑定到祖先的情况下将无法工作。

解决此问题的最简单方法是将您*自己的*事件添加到元素并用于[`stopPropagation()`](http://api.jquery.com/event.stopPropagation/)停止已绑定到祖先的事件处理程序触发。

```
$('selector').off('eventName').on('eventName', function (e) {
    e.stopPropagation();
}); 
```

...对此的简写是通过`false`而不是`function`：

```
$('selector').off('eventName').on('eventName', false); 
```

有关详细信息，请参阅[`on()`](http://api.jquery.com/on)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-24T16:09:15.033

使用`events`对象查看附加到对象的事件：

```
$('selector').data('events') 
```

或者您可以一起删除 jQuery 事件：

```
$('selector').off('eventName'); 
```

# datagrid - 在 rowclick 上的 dojo 数据网格中，如何获取 HTML 中的下一行

> ID：14023495
> 
> 赞同：1
> 
> 时间：2012-12-24T16:08:11.683
> 
> 标签：datagrid, dojo, onclick, row

您好我有一个道场数据网格，它是从 ItemReadStore 构建的。

OnClick 第一列，我必须隐藏或显示接下来的 3 行。

我必须使用此代码到当前选定的行：

 `````
 dojo.connect(pipelineVelocityUI.pipelineGrid, "onRowClick", function (event) {
        var selectedRow = pipelineVelocityUI.pipelineGrid.selection.getSelected();
   }); 
````  `另外，您能告诉我如何将类添加到网格行。

谁能帮帮我吗！！提前致谢！``

# c# - 如何使用 Resumable Upload 获取上传到 YouTube 的视频的 ID

> ID：14023499
> 
> 赞同：1
> 
> 时间：2012-12-24T16:08:26.960
> 
> 标签：c#, .net, youtube-api, youtube.net-api

我正在使用 Async ResumableUpload 将视频上传到 YouTube，但是我无法检索成功上传视频的 VideoID。这对于单个 Sync 上传非常容易，但我一直无法找到 Async 的任何示例。

这是代码：

```
 var mResumableUploader = new ResumableUploader(chunkSize);
        mResumableUploader.AsyncOperationCompleted += MResumableUploaderAsyncOperationCompleted;
        mResumableUploader.AsyncOperationProgress += MResumableUploaderAsyncOperationProgress;

        var youTubeAuthenticator = new ClientLoginAuthenticator(appName, ServiceNames.YouTube, uName, passWord);
        youTubeAuthenticator.DeveloperKey = devKey;

        newVideo = new Video();

        newVideo.Title = "video";
        newVideo.Tags.Add(new MediaCategory("Entertainment", YouTubeNameTable.CategorySchema));
        newVideo.Keywords = "video";
        newVideo.Description = "video";
        newVideo.YouTubeEntry.Private = false;
        newVideo.YouTubeEntry.MediaSource = new MediaFileSource(fileName, fileContType);

        var link = new AtomLink("http://uploads.gdata.youtube.com/resumable/feeds/api/users/default/uploads");
        link.Rel = ResumableUploader.CreateMediaRelation;
        newVideo.YouTubeEntry.Links.Add(link);

        Console.WriteLine("Starting upload: ");
        mResumableUploader.InsertAsync(youTubeAuthenticator, newVideo.YouTubeEntry, "inserter"); 
```

任何帮助都感激不尽。

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-22T20:25:31.090

如谷歌数据提供的示例所示，您可以在上传过程完成后解析视频。问候

```
 ru.AsyncOperationCompleted += new AsyncOperationCompletedEventHandler(ru_AsyncOperationCompleted);

void ru_AsyncOperationCompleted(object sender, AsyncOperationCompletedEventArgs e)
        {

            //upload complete
            YouTubeRequestSettings ytSettings = new YouTubeRequestSettings("myApp", googleDevKey, ytUsername, ytPassword);
            Video v = ytRequest.ParseVideo(e.ResponseStream);
            string videoId = v.VideoId;
            string watchPage = v.WatchPage.ToString();

        } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2017-02-28T16:43:41.427

使用 YouTube API v3，您无需使用 ResumableUploader。您只需向 VideoInsertRequest ResponseReceived 添加一个委托：

```
var video = new Video();
video.Snippet = new VideoSnippet();
video.Snippet.Title = "Default Video Title";
video.Status = new VideoStatus();
video.Status.PrivacyStatus = "unlisted"; // or "private" or "public"
var filePath = @"REPLACE_ME.mp4"; // Replace with path to actual movie file.

using (var fileStream = new FileStream(filePath, FileMode.Open))
{
  var videosInsertRequest = youtubeService.Videos.Insert(video, "snippet,status", fileStream, "video/*");
  videosInsertRequest.ResponseReceived += videosInsertRequest_ResponseReceived;
  await videosInsertRequest.UploadAsync();
}

void videosInsertRequest_ResponseReceived(Video video)
{
  Console.WriteLine("Video id '{0}' was successfully uploaded.", video.Id);
} 
```

完整的代码在这里：[https ://developers.google.com/youtube/v3/code_samples/dotnet#upload_a_video](https://developers.google.com/youtube/v3/code_samples/dotnet#upload_a_video)

# javascript - 无法使用 jQuery-cookie 插件写入/读取 cookie

> ID：14023500
> 
> 赞同：1
> 
> 时间：2012-12-24T16:08:39.447
> 
> 标签：javascript, jquery, jquery-cookie

我需要编写和读取一个 cookie，我想使用[jquery-cookie](https://github.com/carhartl/jquery-cookie)插件。

但是，我无法设法存储 cookie 并将其读回。

这是一个 MWE

```
<html>
<head>
    <title>Test</title>
    <script type="text/javascript" src="jquery.js"></script>
    <script type="text/javascript" src="jquery-cookie/jquery.cookie.js"></script>
    <script type="text/javascript">
    $(function() {
        $.cookie('aCookie','aValue');
        console.log($.cookie('aCookie'));
    });
    </script>
</head>
<body>
</body>
</html> 
```

我希望看到`aValue`在控制台中打印出来，而它打印出来`null`，即未找到 cookie。

我觉得我在这里缺少一些明显的东西。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-24T16:32:44.830

我猜你浏览器中的 url 指向本地文件，所以它是`file:///C:/some/path.html`

Chrome 不允许在本地文件中保存 cookie。Cookie 严格来说是一种 HTTP 机制 (RFC 2109)

您可以使用命令行标志启用它们`--enable-file-cookies`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-24T16:31:42.693

确保您没有从 file:// 运行文件。Cookie 是由服务器设置的，如果在文件系统之外运行，我过去遇到过问题

# php - FuelPHP 石油实用程序错误：“这不是有效的燃料安装，因此石油有点丢失”

> ID：14023501
> 
> 赞同：1
> 
> 时间：2012-12-24T16:08:41.453
> 
> 标签：php, command-line-interface, fuelphp

我使用手动安装方式安装了 FuelPHP（现在很遗憾，应该使用 Oil，但在我开始时不知道更好）。我现在正在尝试使用命令行实用程序 Oil 创建数据模型和迁移，但我收到以下信息：

“这不是一个有效的燃料装置，所以石油有点丢失。”

![错误](../Images/f68ccf46e15566eff8222f03b4f0deea.png)

当我在项目目录的燃料文件夹中使用任何 Oil 命令时 -

```
such as oil g model user userID:int forename:varchar[50] 
```

谁能建议我做错了什么？当我使用命令行创建示例项目时，它似乎工作正常。我在另一个项目中做了大量的工作，所以不想从头开始！

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-24T17:51:44.700

固定的：

这是来自 oil bash 脚本的消息，当当前目录中没有名为 'oil' 的文件时，您会收到此消息。'oil' 脚本位于您安装的根目录中（它是一个没有扩展名的 PHP 文件），您必须在该目录中才能运行 oil。

代表我非常愚蠢！在清理我的代码时，我有点强迫症，一定是用文档删除了它并错误地安装了文件！

感谢FuelPHP论坛上的[Harro Verton 。](http://fuelphp.com/forums/profile/4/Harro%20Verton)

# email - 使用 MS Access 的群组电子邮件

> ID：14023511
> 
> 赞同：0
> 
> 时间：2012-12-24T16:10:06.287
> 
> 标签：email, vba, ms-access

我正在使用 MS 访问查询，我想从查询中提取所有电子邮件，然后用所有电子邮件填充 Outlook 电子邮件，代码将运行，但它不会提取电子邮件地址，我似乎无法弄清楚为什么..这是我到目前为止所拥有的。我的想法是在尝试提取电子邮件时未调用填充表中使用的查询

```
Private Sub Command30_Click()
    On Error GoTo Err_Command30_Click

    Dim stDocName As String

    stDocName = "Department E-Mail"
    DoCmd.OpenQuery stDocName, acNormal, acEdit

    Dim r As Recordset
    Dim Email As String
    Set r = CurrentDb.OpenRecordset("SELECT[tbl dmgrphcs].Email FROM [tbl  dmgrphcs]WHERE(([tbl     dmgrphcs].Email) Is Not Null);")

    Do While Not r.EOF
        Email = Email & r(0) & ";"
        r.MoveNext
    Loop
    r.Close

    DoCmd.SendObject acSendNoObject, Null, Null, "", "", Email, "", "", True, Null

Exit_Command30_Click:
    Exit Sub

Err_Command30_Click:
    MsgBox Err.Description
    Resume Exit_Command30_Click

End Sub 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-24T16:27:15.223

你使用的表名不一致

```
[tbl dmgrphcs]
[tbl  dmgrphcs]
[tbl     dmgrphcs] 
```

空格的数量很重要。如果查询只访问一个表，则不需要在列前加上表名

```
Set r = CurrentDb.OpenRecordset("SELECT Email FROM [tbl dmgrphcs] " & _
                                "WHERE Email Is Not Null") 
```

* * *

提示：在添加事件处理程序之前给你的按钮起有意义的名字。`Command30`不说话。`btnPullEMails`或者`cmdPullEMail`确实。事件处理程序也会有一个更好的名称：

```
Private Sub btnPullEMails_Click() 
```

# jquery - CSS3/JQuery 等待 css 被应用

> ID：14023514
> 
> 赞同：0
> 
> 时间：2012-12-24T16:10:31.450
> 
> 标签：jquery, html, css, css-transitions

我希望能够从页面的任一侧滑入一个 div（这最终会变成一个类似轮播的应用程序）。当用户单击“前进”或“后退”按钮时，我滑出任何活动的 div，创建一个新的 div，添加类“左”或“右”开始，然后添加过渡类“活动”所以它将移动到位，如下所示：

```
$("#forward").click(function(){
    $(".active").removeClass("active left right").addClass("toRight").bind(transitionendstr, function(){
            $(this).remove();
    });

    data = "new data here";

    target = $(slidepartial).clone().addClass("left");
    $("#content").append(target);
    $(target).addClass("active");

}); 
```

CSS在哪里：

```
.active{
left:50% !important;
transition:left 2s;
-moz-transition: left 2s; /* Firefox 4 */
-webkit-transition: left 2s; /* Safari and Chrome */
-o-transition: left 2s; /* Opera */
}

.left{
left:-100%;
}

.right{
left:100%;
}

.toRight{
left:100%;
transition:left 2s;
-moz-transition: left 2s; /* Firefox 4 */
-webkit-transition: left 2s; /* Safari and Chrome */
-o-transition: left 2s; /* Opera */

}

.toLeft{
left:-100%;
transition:left 2s;
-moz-transition: left 2s; /* Firefox 4 */
-webkit-transition: left 2s; /* Safari and Chrome */
-o-transition: left 2s; /* Opera */

} 
```

唯一的问题是，我创建的新 div 永远不会让“左”或“右”css 生效；它立即出现在中心。在活动css之前使左右css应用的正确方法是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-24T16:22:25.617

它不是即插即用的解决方案，但这里有一个应用 CSS 过渡的示例：http `div`: [//jsfiddle.net/VPjX9/193/](http://jsfiddle.net/VPjX9/193/)

你可以激励你解决你的问题。通过单击`div`或 按钮完成转换触发，然后应用该类。查看小提琴中的转换类以获取更多详细信息。

```
$('.page1, .page2, #go').click(function() {
    var page1 = $('.page1');
    var page2 = $('.page2');
    var toHide = page1.is(':visible') ? page1 : page2;
    var toShow = page2.is(':visible') ? page1 : page2;

    toHide.removeClass('flip in').addClass('flip out').hide();
    toShow.removeClass('flip out').addClass('flip in').show();
}); 
```

​</p>

# git - 结帐同时避免 Git 中的分离头状态？

> ID：14023520
> 
> 赞同：1
> 
> 时间：2012-12-24T16:11:04.333
> 
> 标签：git

我只是这样做：

```
git checkout HEAD@{1} 
```

它说我已经变成了分离的头部状态。

我怎样才能做同样的事情而不改变到分离的头部状态？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-24T16:15:10.940

如果您想将当前分支的状态移回`HEAD@{1}`（可能消除提交），那么您应该`git reset --hard HEAD@{1}`使用`git checkout`.

请注意，这`git reset --hard` *是*一种破坏性操作。

如果您想切换分支，那么您应该将分支的名称传递给`git checkout`（或用于`git checkout -`交换到当前分支之前的任何分支）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-24T16:15:22.733

想想你到底想得到什么。如果不签出分行，就只能有一个分离的头。我假设你想将你的分支移回之前的状态——你可以用这个命令来做到这一点：

```
git reset --hard HEAD@{1} 
```

如果您只想查看之前签出的分支，这就是您要查找的内容：

```
git checkout - 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-24T16:15:58.043

你想开一个新的分支吗？做就是了：

```
git checkout -b new-branch-name HEAD@{1} 
```

# c++ - 任意流名称

> ID：14023521
> 
> 赞同：0
> 
> 时间：2012-12-24T16:11:16.323
> 
> 标签：c++, stream

我的问题很简单，但我似乎找不到合适的解决方案。为了在 C++ 中创建或打开流，您使用以下语法：

```
ifstream input_data("data.txt") 
```

我希望括号内的内容是用户选择的变量。（我基本上希望用户选择将存储或加载其数据的文本文件的名称）

提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-24T19:02:31.220

## 从问题移动：

在这种情况下， input_data 是一个接受字符串的构造函数，因此您只需在其中放置一个字符串。解决它的一个好方法是：

```
string a;              // declare the string
cin >> a;              // let the user input the name
a = a + ".txt";        // add the extension
ifstream input_data(a);// run the constructor with the string as an argument. 
```

注意：在 C++03 中，您需要将字符串转换为 C-String。直到 C++11，fstream 才将字符串作为构造函数的输入。

```
ifstream input_data(a.c_str()); // Required for C++03 
```

# php - mod重写-drupal风格

> ID：14023522
> 
> 赞同：0
> 
> 时间：2012-12-24T16:11:18.220
> 
> 标签：php, .htaccess, mod-rewrite

我正在为一个不想使用 Drupal，但希望在他们的网站上使用 Drupal 风格的 mod 重写（友好 url）功能的客户创建一个网站。

以前从未创建过我自己的 mod_rewrite 引擎，您可以给我任何方便的提示或技巧吗？CMS 完全由我创建，如果您能提供此功能，那就太好了，所以如果您能提供帮助，请提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-24T16:18:22.800

将其添加到您的 htaccess

```
RewriteEngine on

RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d

RewriteRule ^(.*)$ index.php/?argv=$1 [L] 
```

并且 index.php/?argv=mypage 将变为 /mypage 然后还有一个 php 片段将 URI 放入一个数组

```
if($_GET['argv']){
  $argc = count($argv);
  $myURI = explode('/',$_GET['argv']);
  $controller = ($argc < 0) ?: $myURI[0];
  $action = (argc > 1) ? $myURI[1] : 'index';
  $params = (argc < 2) ?: array_slice($myURI, 2);
} 
```

这就是我在我的mvc上使用的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-24T16:15:10.477

mod_rewrite 重写规则生成器将获取给它的动态 url，并生成正确的语法以放置在 .htaccess 文件中，以允许以可抓取的格式重写 url。apache 模块“mod_rewrite”（您需要启用该模块）将某种格式的 url 转换为另一种格式，这对于帮助对具有动态内容的站点进行索引非常有用。

```
Syntax: RewriteRule url-pattern url-new [[flag,...]]
Example: RewriteRule ^/foo/(.*)$ /bar/$1 [R,L] 
```

# ipython - 在 IPython 笔记本中循环魔术函数

> ID：14023528
> 
> 赞同：4
> 
> 时间：2012-12-24T16:11:49.640
> 
> 标签：ipython, ipython-notebook, ipython-magic

我想在 IPython 笔记本中完成 R 代码的循环。做这个的最好方式是什么？

```
 l = []
    for i in range(10):
        # execute R script
        %%R -i i -o result   #some arbitrary R code
        # and use the output
        l.append(result) 
```

这可以在笔记本中完成（循环下一个单元格）吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-26T05:58:38.973

你看过 rmagic 和 rpy2 模块吗？

如果你有 R 脚本，那么你可以调用它们并使用 shell 命令符号将它们的输出分配给一个变量：

```
 var=!R_script arguments.... 
```

以上不需要你安装rpy2，因为！shell 命令执行在 ipython 中是基本的。您可以通过在 arg 列表中使用 $var 从 ipython notebook 传递变量值。

# excel - 从范围+减法向不同工作表上的范围添加值

> ID：14023531
> 
> 赞同：0
> 
> 时间：2012-12-24T16:12:05.020
> 
> 标签：excel, excel-2007, vba

我让用户分别在 E12、E13 范围内输入特定名称和值（从 65-90）。我试图获取名称，从 E12 到对应于 E13 中输入的值减去 51 的范围，因此如果用户在 E13 中输入 65，Sheet2 将在 B14 的范围内反映来自 E12 的名称。我假设以下代码就足够了，但似乎还不够。

```
Sub Worksheet_Change(ByVal Target As Range)
    Sheets("Sheet2").Range("B" & Sheets("Sheet1").Range("E13").Value - 51).Value = Sheets("Sheet1").Range("E12").Value
End Sub 
```

此代码段旨在在一张工作表上复制和使用 20 次，可能有 20 个条目，因此 sheet1 的范围将发生变化。

我可能会以完全错误的方式进行处理，因此我们将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-24T16:20:19.217

试试这个，我不确定它是否有效......
定义一个变量

> Sheets("Sheet1").Range("E13").Value

然后使用

> 变量 - 51

在你的代码中。希望它能解决你的问题。

# c# - 如何在通过 COM 交互时“锁定”excel

> ID：14023532
> 
> 赞同：5
> 
> 时间：2012-12-24T16:12:10.187
> 
> 标签：c#, excel, com

我有一个 .NET 应用程序，它使用 COM 接口读取数据库、进行一些分析并更新*Excel电子表格中的统计信息。*我有应用程序到它打开工作簿的地步（或检测到它，如果它已经打开），并找到它需要更新的工作表。

我遇到了一个问题，在我的应用程序运行时，用户仍然可以与*Excel*进行交互（关闭应用程序/工作簿、更改数据等）。我考虑在我的应用程序处理数据时隐藏 Excel，但这是应用程序范围内的，并且会阻止用户与*任何*打开的电子表格进行交互。

有没有办法通过 COM 接口锁定 Excel 以防止更改，但用户仍然可以**查看/读取**它？或者，有没有办法只**隐藏/锁定**一个工作簿？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-05-29T12:13:06.730

```
Application.Interactive=false; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-02-03T19:22:50.357

```
 Application.Interactive=false; 
```

正如 Sid 建议的那样，你最好的选择是我建议也改变：

```
 Application.ScreenUpdating = false; // to avoid screen flicker
    Application.DisplayAlerts = false; // if you wish to suppress most excel messages
    Application.EnableEvents = false; // if there is vba in the workbook you wish to avoid triggering

    Application.Calulation = xlCalculationManual; // if it's a calc intensive automation 
```

一个好主意是在自动化之前收集您的状态，并在您完成自动化后将所有这些属性设置回其原始状态。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-26T22:55:12.247

我能想到的最好方法是打开并立即隐藏整个工作簿。这样您仍然可以通过 Interop 与它进行交互，但用户无法看到它（除非他们专门取消隐藏它，但我认为很多用户不知道如何做到这一点）。

```
xlWorkbook.Windows[1].Visible = false; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-24T16:30:42.983

会`Worksheets("Sheet1").protect( <password> )`and`unprotect(<password>)`做的伎俩吗？

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-12-24T16:33:02.567

...我能想到的唯一真正智能的方法是创建一个 Excel 应用程序的新实例，将其隐藏并在那里进行更改。

然后，如果工作簿已经打开，只需通知用户并要求他们关闭它。

# ajax - yii ajax 验证错误出现

> ID：14023535
> 
> 赞同：5
> 
> 时间：2012-12-24T16:12:40.000
> 
> 标签：ajax, validation, yii

我有以下表格：

```
$form = $this->beginWidget('bootstrap.widgets.TbActiveForm', array(
            'id'=>'new-agenda-entry',
            'enableAjaxValidation'=>true,
            'action'=>'')); ?>
        <div class="four columns">
            <div class="right top5 sufix10">
                <?php echo $form->labelEx($model,'eventTime'); ?>
                <?php $this->widget('zii.widgets.jui.CJuiDatePicker', array(
                'name'=>'UserAgenda[eventTime]',
                'model'=>$model,
                'options'=>array(
                    'dateFormat'=>'yy-mm-dd',
                    'minDate'=>'new Date()',
                ) // jquery plugin options
            ));?>
            <?php echo $form->error($model, 'eventTime'); ?>
            </div>
            <div class="right top5 sufix10">
                <?php echo CHtml::dropdownList('eventTime_hour', false, $this->getHourArray()); ?>
                <?php echo CHtml::dropdownList('eventTime_min', false, array('00'=>'00', '30'=>'30')); ?>
            </div>
        <?php echo $form->labelEx($model,'note'); ?>
        <?php echo $form->textField($model, 'note');?>
        <?php echo $form->error($model, 'note'); ?> 
```

该模型已在服务器上成功验证，因为我可以在 Firebug 中看到响应：

```
{"UserAgenda_eventTime":["Event time cannot be blank."],"UserAgenda_note":["Note cannot be blank."]} 
```

消息看起来不错，html 也是如此，但 yii 生成的隐藏输入仍然隐藏且为空。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-25T19:16:03.760

在操作中可能（创建或更新）你必须`// $this->performAjaxValidation($model);`像这样取消注释你有一个 ajax 验证，如果问题仍然存在我认为将它发布到 yii 论坛中的 yiibootstrap 讨论我更好，我看到你使用 yiibootstrap，尝试使用默认 yii表单小部件。

# c# - 自动完成组合框（搜索列表中的任何位置，而不仅仅是第一个字母）

> ID：14023537
> 
> 赞同：1
> 
> 时间：2012-12-24T16:12:45.070
> 
> 标签：c#

我有一个在表单加载中填充数据表的组合框。

```
Mycombo.DisplayMember = "FullName";
MyCombo.ValueMember = "ID";
MyCombo.DataSource = MyDattable; 
```

并设置`AutoComplateMode`为`SuggestAppend`和`AutoComplateMode`列表项。

当我将文本插入组合框中时，它会填充以我的文本开头的建议。

但我希望它像 mytext 一样充满智慧。

# mysql - Solr 用于索引一张表 VS 常规 MySQL innoDB 表缓冲区

> ID：14023543
> 
> 赞同：0
> 
> 时间：2012-12-24T16:13:20.843
> 
> 标签：mysql, performance, optimization, solr

我打算使用 Solr 搜索一个 mysql 表，这个表应该有数百万条记录。我确实对该表进行了规范化，以便 solr 可以对其进行索引和搜索以获得更多性能结果。

这是正确的还是应该用mysql表搜索它自己，我的意思是正常选择。

请建议哪个更好，因为它只是一个要索引和搜索的表。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-24T16:36:17.423

如果您的要求是使用常规 SQL SELECT 语句仅“搜索”一个 MySQL 表，那么 Apache Solr 似乎有点迂回和矫枉过正。

使用 solr，您需要定期将 MySQL 表中的数据导入 solr 模式，这实质上意味着您将维护数据的两个副本。因此，在 MySQL 表中数据更改的时间与从数据库刷新 solr 模式的时间之间也存在延迟。

除此之外，就性能而言，我希望 solr 搜索其架构的速度几乎与 MySQL 搜索它自己的表一样快。但是您确实需要对此进行测试，以根据您的特定要求做出决定。

* * *

您可能希望使用 solr “delta import”，指定适当的查询来识别 MySQL 表中自上次导入以来已插入和更新的行。

如果这是 MySQL 表的唯一用途，那么就 solr 搜索/导入性能而言，MySQL 表上真正需要的唯一索引将是优化两个“增量导入”性能所需的那些索引"查询。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-25T06:12:39.493

尝试使用像 www.rockitsearch.com 这样的第三方搜索服务。这是一个开箱即用的搜索解决方案。无需担心 solr 集群的维护。

# android - Android，ImageView 上缺少触摸事件

> ID：14023548
> 
> 赞同：-4
> 
> 时间：2012-12-24T16:13:47.660
> 
> 标签：android, touch, android-imageview

我明白这是我的代码的问题。但我无法找出问题所在。我下载了一个“示例项目”来使用 touchListener，它可以工作，但是如果我尝试在我的项目上做同样的事情，突然间我只能得到“按下按钮”事件。

活动：

```
 @Override
  protected void onCreate(Bundle savedInstanceState) {

    super.onCreate(savedInstanceState);

    setContentView(R.layout.navigator_layout);

    b = this.getIntent().getStringArrayExtra("building");

    cv = (MapView) this.findViewById(R.id.map); 

            MapMovement mm = new MapMovement(cv);

            compass = new Compass(this, cv, debug);
} 
```

地图.xml：

```
 <RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:tools="http://schemas.android.com/tools"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"
    android:background="@color/black"
    android:theme="@android:style/Theme.NoTitleBar.Fullscreen" >

    <it.inav.graphics.MapView
        android:id="@+id/map"
        android:layout_width="fill_parent"
        android:layout_height="fill_parent"
        android:layout_centerInParent="true" />

  </RelativeLayout> 
```

我省略了 MapView 的某些部分，我在其中获取图像等，询问您是否认为重要：

```
 public class MapView extends ImageView  {

...

        public MapView(Context context, AttributeSet attrs, int defStyle) {
              super(context, attrs, defStyle);
        }

        public MapView(Context context, AttributeSet attrs) {
              super(context, attrs);
        }

        public MapView(Context context) {
              super(context);
        }

        public void init(List<Floor> floors) {
              this.floors = floors;
              setFocusable(true);
        }

        private void setInitialZoom() {

              if (screen_center == null)
                    return;

              // recupero la dimensione dell'immagine
              int image_width = bmp.getWidth();
              int image_heigth = bmp.getHeight();

              int longest_i = image_width;
              if (longest_i < image_heigth)
                    longest_i = image_heigth;

              float longest_s = screen_center.x * 2;

              if (longest_s < screen_center.y * 2)
                    longest_s = screen_center.y * 2;

              float zoom = (float)longest_s / longest_i;

              this.min_zoom = zoom;
              this.zoom = zoom;

              setImageCenter(null);
        }

        private void setZoom(float zoom) {

              if (zoom < min_zoom)
                    this.zoom = min_zoom;

              else if (zoom > 1)
                    this.zoom = 1;

              else 
                    this.zoom = zoom;

              this.invalidate();
        }

        private void setImageCenter(PointF posizione) {

              if (posizione != null) 
                    image_center = new PointF(posizione.x, posizione.y);
              else 
                    image_center = new PointF(bmp.getWidth(), bmp.getHeight());
        }

        private void prepareImage(Canvas canvas) {

              canvas.rotate((float)(bearing - selected_floor.bearing), screen_center.x, screen_center.y);

              // scalo l'immagine 
              image = new Matrix();
              image.setScale(zoom, zoom);

              Paint drawPaint = new Paint();
              drawPaint.setAntiAlias(true);
              drawPaint.setFilterBitmap(true);

              float centerScaledWidth = image_center.x * zoom / 2;
              float centerScaledHeigth = image_center.y * zoom / 2;

              image.postTranslate(screen_center.x -  centerScaledWidth, 
            screen_center.y - centerScaledHeigth);

              canvas.drawBitmap(bmp, image, drawPaint);

              canvas.save();
              canvas.restore();
        }

        private void drawMarkers(Canvas canvas) {
              Paint drawPaint = new Paint();
              drawPaint.setAntiAlias(true);

              drawPaint.setColor(Color.WHITE);
              canvas.drawCircle(screen_center.x, screen_center.y, MARKER_DIAMETER + 1, drawPaint);

              drawPaint.setColor(Color.RED);
              canvas.drawCircle(screen_center.x, screen_center.y, MARKER_DIAMETER, drawPaint);

              canvas.save();
              canvas.restore();
        }

        private void setScreenCenter() {

              if (screen_center != null)
                    return; 

              // recupero la dimensione dello schermo
              int screen_height = getMeasuredHeight();
              int screen_width = getMeasuredWidth();

              if ((screen_height == 0) || (screen_width == 0))
                    return;

              screen_center = new PointF(screen_width / 2, screen_height / 2);
              setInitialZoom();
        }

        @Override
        public void draw(Canvas canvas) {

              setScreenCenter();

              if (selected_floor != null) {

                    prepareImage(canvas);
                    drawMarkers(canvas);
              }
        }

        @Override
        protected void onMeasure(int widthMeasureSpec, int heightMeasureSpec) {
              int measuredWidth = measure(widthMeasureSpec);
              int measuredHeight = measure(heightMeasureSpec);
              setMeasuredDimension(measuredWidth, measuredHeight);
        }

        private int measure(int measureSpec) {
              int result = 0;

              // Decode the measurement specifications.
              int specMode = MeasureSpec.getMode(measureSpec);
              int specSize = MeasureSpec.getSize(measureSpec);
              if (specMode == MeasureSpec.UNSPECIFIED) {
                    // Return a default size of 200 if no bounds are specified.
                    result = 200;
              } else {
                    // As you want to fill the available space
                    // always return the full available bounds.
                    result = specSize;
              }
              return result;
        }

        public void setBearing(float _bearing) {
              bearing = _bearing;
        }
  } 
```

还有触摸监听器，我把它放在另一个类中。地图运动：

```
 public class MapMovement implements OnTouchListener {

        ...

        // We can be in one of these 3 states
        private static final int NONE = 0;
        private static final int DRAG = 1;
        private static final int ZOOM = 2;
        private int mode = NONE;

        public MapMovement(MapView mapView) {

              this.mapView = mapView;
              mapView.setOnTouchListener(this);
        }

        public void setImageCenter(PointF p) {
              this.image_center = p;
        }

        private void dumpEvent(MotionEvent event) {
              String names[] = { "DOWN" , "UP" , "MOVE" , "CANCEL" , "OUTSIDE" ,
            "POINTER_DOWN" , "POINTER_UP" , "7?" , "8?" , "9?" };
              StringBuilder sb = new StringBuilder();
              int action = event.getAction();
              int actionCode = action & MotionEvent.ACTION_MASK;
              sb.append("event ACTION_" ).append(names[actionCode]);
              if (actionCode == MotionEvent.ACTION_POINTER_DOWN
                          || actionCode == MotionEvent.ACTION_POINTER_UP) {
                    sb.append("(pid " ).append(
                          action >> MotionEvent.ACTION_POINTER_ID_SHIFT);
                    sb.append(")" );
              }
              sb.append("[" );
              for (int i = 0; i < event.getPointerCount(); i++) {
                    sb.append("#" ).append(i);
                    sb.append("(pid " ).append(event.getPointerId(i));
                    sb.append(")=" ).append((int) event.getX(i));
                    sb.append("," ).append((int) event.getY(i));
                    if (i + 1 < event.getPointerCount())
                          sb.append(";" );
              }
              sb.append("]" );
              Log.d("event", sb.toString());
        }

        @Override
        public boolean onTouch(View v, MotionEvent event) {

              // Dump touch event to log
          dumpEvent(event);

              return false;
        }
  } 
```

这是我尝试在 MapView 上执行“DRAG”时的输出日志：

```
 12-24 09:41:58.412: D/event(31342): event ACTION_DOWN[#0(pid 0)=85,248]
  12-24 09:42:01.752: D/event(31342): event ACTION_DOWN[#0(pid 0)=106,126]
  12-24 09:42:02.466: D/event(31342): event ACTION_DOWN[#0(pid 0)=96,286] 
```

日志代码和我下载的测试项目一样，这就是我能得到的所有输出。没有 ACTION_UP，没有 ACTION_MOVEMENT，什么都没有。

我不知道问题出在哪里或在哪里。我想要的只是使用触摸事件在活动中移动图像，但似乎我只能获得一个触摸事件 ACTION_DOWN。

我已经发布了我认为可能是错误的所有代码部分。如果我认为问题肯定出在一个类或布局中，我会发布它，而不是我已经浪费了 15 分钟为您编辑的一堆代码。

真的很感谢你的帮助。如果你不知道哪个是错误不是问题。但是你不能来这里告诉我“更具体”，因为如果我可以“更具体”，我不会在这里问你，因为我会自己解决问题。

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-12-25T17:56:07.340

解决方案很简单，在*MapMovement*中*onTouch*必须返回**true**而不是**false**。

真的很感谢你的帮助。（我自然很讽刺）

# wpf - 如何在 WPF 程序中使用 IDataErrorInfo.Error？

> ID：14023552
> 
> 赞同：26
> 
> 时间：2012-12-24T16:14:49.440
> 
> 标签：wpf, validation, textbox, idataerrorinfo

我有一个这样的对象：

```
public class Person : IDataErrorInfo
{
    public string PersonName{get;set;}
    public int Age{get;set;}

    string IDataErrorInfo.this[string propertyName]
    {
        get
        {
            if(propertyName=="PersonName")
            {
                if(PersonName.Length>30 || PersonName.Length<1)
                {
                    return "Name is required and less than 30 characters.";
                }
            }
            return null;
        }
    }

    string IDataErrorInfo.Error
    {
        get
        {
            if(PersonName=="Tom" && Age!=30)
            {
                return "Tom must be 30.";
            }
            return null;
        }
    }
} 
```

绑定 PersonName 和 Age 属性很简单：

```
<TextBox Text="{Binding PersonName, ValidatesOnDataErrors=True}" />
<TextBox Text="{Binding Age, ValidatesOnDataErrors=True}" /> 
```

但是，如何使用 Error 属性并适当地显示它？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-12-24T16:29:42.667

您应该修改 TextBox 样式，以便它显示该属性的问题。这是一个将错误显示为工具提示的简单示例：

```
<Style TargetType="TextBox">
        <Style.Triggers>
            <Trigger Property="Validation.HasError" Value="true">
                <Setter Property="ToolTip" Value="{Binding RelativeSource={RelativeSource Self},
                        Path=(Validation.Errors).CurrentItem.ErrorContent}" />
            </Trigger>
        </Style.Triggers>
</Style> 
```

只需将它放在 app.xaml 文件中的 Application.Resources 中，它将适用于应用程序的每个文本框：

```
<Application.Resources>
    <Style TargetType="TextBox">
            <Style.Triggers>
                <Trigger Property="Validation.HasError" Value="true">
                    <Setter Property="ToolTip" Value="{Binding RelativeSource={RelativeSource Self},
                            Path=(Validation.Errors).CurrentItem.ErrorContent}" />
                </Trigger>
            </Style.Triggers>
    </Style>
</Application.Resources> 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-12-24T16:29:04.727

[这是一个改编自这个问题](https://stackoverflow.com/questions/8045860/how-to-display-idataerrorinfos-error-in-tooltip-on-datagridtextcolumn)的示例，它显示了如何在 Tooltip 中显示错误：

```
<TextBox>
    <TextBox.Style>
        <Style TargetType="{x:Type TextBox}">
            <Style.Triggers>
                <Trigger Property="Validation.HasError" Value="true">
                    <Setter Property="ToolTip"
                Value="{Binding RelativeSource={RelativeSource Self}, 
                       Path=(Validation.Errors)[0].ErrorContent}"/>
                </Trigger>
            </Style.Triggers>
        </Style>
    </TextBox.Style>
</TextBox> 
```

# visual-studio - 在 Visual Studio Express 2012 for Windows Desktop 中创建项目失败

> ID：14023554
> 
> 赞同：2
> 
> 时间：2012-12-24T16:15:08.553
> 
> 标签：visual-studio, visual-c++, project

我在我的 Windows 7 Ultimate（32 位）PC 上安装了 Microsoft Visual Studio Express 2012 for Windows Desktop。我已经注册了。我的问题是关于它的 Visual C++ 项目。当我尝试创建一个 VC++ 项目时，它说，

```
"Creating project '<project_name>'... project creation failed." 
```

![在此处输入图像描述](../Images/79967cbdfb4e9d88472ca83780710977.png)

但我认为一切都安装正确，我找不到这个软件有什么问题。请帮我看看有什么问题。我多次重新安装该程序并使用管理员运行它，禁用 UAC 但没有任何帮助

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-24T16:28:19.050

这似乎是与 UAC 和管理权限相关的[常见问题。](http://social.msdn.microsoft.com/Forums/en-US/Vsexpressvc/thread/0b7b9506-2ca3-4b42-be26-02796e471d26)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2016-10-06T07:32:05.923

我尝试了上述所有解决方案，但下面提到的步骤最终帮助了我。如果以上解决方案都不适合您，请尝试一下。

1.  转到库\文档文件夹
2.  右键单击文件夹 IISExpress，然后单击属性
3.  转到高级选项
4.  在压缩或加密属性下，请取消选中“加密内容以保护数据”复选框
5.  单击确定并应用。

现在尝试创建一个项目，希望您不会再次遇到错误。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-06-23T02:49:21.647

尝试安装此[更新 KB2781514](http://support.microsoft.com/kb/2781514) 这对我有用

# iphone - 带有布尔值的 AFNetworking JSON 请求

> ID：14023565
> 
> 赞同：14
> 
> 时间：2012-12-24T16:15:40.223
> 
> 标签：iphone, ios, json, afnetworking

我正在尝试使用 AFNetworking 发送 JSON 请求，但在将值转换为 .json 格式时遇到问题`{"value": true}`。相反，我得到：`{"value": 1}`

这基本上是我创建请求的方式：

```
NSMutableURLRequest *request =
    [self.httpClient requestWithMethod:@"POST"
                                  path:url
                            parameters:@{@"value": @YES}];

AFJSONRequestOperation *operation =
    [AFJSONRequestOperation JSONRequestOperationWithRequest:request ...];
    [operation start]; 
```

我在这里错过了一些微不足道的事情吗？:)

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-12-24T18:19:06.633

**简短回答：** 确保您运行的是最新版本的[AFNetworking](https://github.com/AFNetworking/AFNetworking)。根据您提供的代码，这就是我所能看到的问题。

**长答案：我已经尝试使用最新版本的**[AFNetworking](https://github.com/AFNetworking/AFNetworking) 重现您所描述的问题，但我不能。我深入研究了 AFNetworking 以了解 JSON 的编码是如何完成的。[AFHTTPClient.m:442](https://github.com/AFNetworking/AFNetworking/blob/fa0fc535a149a35f4a69b4e082b1a8cccad0d002/AFNetworking/AFHTTPClient.m#L442)使用[NSJSONSerialization](http://developer.apple.com/library/ios/#documentation/Foundation/Reference/NSJSONSerialization_Class/Reference/Reference.html)对 JSON 请求进行编码。我想出了以下代码来测试这个问题：

```
NSError* error = nil;
NSData* jsonData = [NSJSONSerialization dataWithJSONObject:@{@"value" : @YES} options:0 error:&error];
NSLog(@"Resulting JSON:\n\n%@\n", [[NSString alloc] initWithData:jsonData encoding:NSUTF8StringEncoding]); 
```

输出：

```
{"value":true} 
```

所以`@YES`应该这样做。请注意，请务必**不要**在您的代码中使用`@(YES)`，因为它会输出为 a`1`而不是`true`.

```
NSError* error = nil;
NSData* jsonData = [NSJSONSerialization dataWithJSONObject:@{@"value" : @(YES)} options:0 error:&error];
NSLog(@"JSON:%@", [[NSString alloc] initWithData:jsonData encoding:NSUTF8StringEncoding]); 
```

输出：

```
{"value":1} 
```

有了这个，我试图弄清楚如何配置 AFHTTPClient 以将 bool 作为`1`/`0`而不是`true`/发送出去`false`，但找不到任何东西。这是我的网络代码。

```
AFHTTPClient* httpClient = [[AFHTTPClient alloc] initWithBaseURL:[NSURL URLWithString:@"http://<SERVER HERE>"]];
[httpClient setParameterEncoding:AFJSONParameterEncoding];
NSMutableURLRequest *jsonRequest = [httpClient requestWithMethod:@"POST" path:@"/" parameters:@{@"value": @YES}];

AFHTTPRequestOperation *jsonOperation = [AFJSONRequestOperation JSONRequestOperationWithRequest:jsonRequest success:^(NSURLRequest *request, NSHTTPURLResponse *response, id JSON) {
    NSLog(@"Success");
} failure:^(NSURLRequest *request, NSHTTPURLResponse *response, NSError *error, id JSON) {
    NSLog(@"Failure");
}];
[jsonOperation start]; 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-24T18:52:26.120

因为@YES 是一个NSNumber，NSJSONSerialization 把它变成0/1。

我认为除了`@{@"value": (yesOrNo ? @"true" : @"false")}`或使用不同的序列化类之外没有其他方法。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-07-28T00:20:34.310

对于可能遇到此问题的人来说，可能还有另一个原因。

确保将子类的`parameterEncoding`属性设置为，否则会遇到 NSNumber 的初始化值未被正确检测到的问题，并且会看到编码器输出 0 和 1。`AFHTTPClient``AFJSONParameterEncoding`

请参阅[此](https://github.com/AFNetworking/AFNetworking/wiki/AFNetworking-FAQ#how-do-i-send-json-parameters-in-my-request)内容以供参考。

希望这可以帮助。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-02-28T15:08:33.313

在 HTTPClient 的子类中。代替：

```
self.responseSerializer = [AFJSONResponseSerializer serializer]; 
```

尝试：

```
$self.responseSerializer = [AFJSONResponseSerializer serializerWithReadingOptions:NSJSONReadingAllowFragments]; 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2017-01-06T17:23:21.283

我有同样的错误，我正在发送 @YES 但服务给我失败了，所以我创建一个 json 字符串并创建一个 jsonObject ，如下所示：

```
NSString* paramsString = @"{";
NSString* appending = [NSString stringWithFormat:@"\"%@\":%@,", KEY_CHECKED, (checked ? @"true" : @"false")];
paramsString = [paramsString stringByAppendingString: appending];
paramsString = [paramsString stringByAppendingString:@"}"];
id object = [NSJSONSerialization JSONObjectWithData:[paramsString dataUsingEncoding:NSUTF8StringEncoding] options:0 error:nil]; 
```

使用此对象通过 AFNetworking 发送帖子

```
[self postParameters:object]; 
```

对我有用！

# python - 防止 subprocess.Popen 在 python 中显示输出

> ID：14023566
> 
> 赞同：14
> 
> 时间：2012-12-24T16:15:43.560
> 
> 标签：python, subprocess

所以我试图将命令的输出存储到一个变量中。我不希望它在运行命令时显示输出......

我现在的代码如下......

```
def getoutput(*args):
    myargs=args
    listargs=[l.split(' ',1) for l in myargs]
    import subprocess
    output=subprocess.Popen(listargs[0], shell=False ,stdout=subprocess.PIPE)   
    out, error = output.communicate()
    return(out,error)

def main():

    a,b=getoutput("httpd -S")

if __name__ == '__main__':
    main() 
```

如果我把它放在一个文件中并在命令行上执行它。即使代码中没有打印语句，我也会得到以下输出。我怎样才能防止这种情况，同时仍然存储输出？

```
#python ./apache.py 
httpd: Could not reliably determine the server's fully qualified domain name, using xxx.xxx.xxx.xx for ServerName
Syntax OK 
```

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2012-12-24T16:31:23.870

您看到的是标准错误输出，而不是标准输出输出。Stderr 重定向由`stderr`构造函数参数控制。它默认为`None`，这意味着不会发生重定向，这就是您看到此输出的原因。

通常保留stderr 输出是个好主意，因为它有助于调试并且不影响正常重定向（例如`|`，`>`shell 重定向默认不会捕获stderr）。但是，您可以像执行 stdout 一样将其重定向到其他地方：

```
sp = subprocess.Popen(listargs[0], shell=False,
    stdout=subprocess.PIPE, stderr=subprocess.PIPE)
output, error = sp.communicate() 
```

或者你可以删除标准错误：

```
devnull = open(os.devnull, 'wb') #python >= 2.4
sp = subprocess.Popen(listargs[0], shell=False,
    stdout=subprocess.PIPE, stderr=devnull)

#python 3.x:
sp = subprocess.Popen(listargs[0], shell=False
    stdout=subprocess.PIPE, stderr=subprocess.DEVNULL) 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-24T16:25:16.567

您正在捕获标准输出，但您没有捕获标准错误（标准错误），我认为这是该消息的来源。

```
output=subprocess.Popen(listargs[0], shell=False ,stdout=subprocess.PIPE, stderr=STDOUT) 
```

这会将 stderr 中的任何内容放入与 stdout 相同的位置。

# c# - .Net framework 4 适用于 Windows XP 的应用程序

> ID：14023568
> 
> 赞同：1
> 
> 时间：2012-12-24T16:15:51.597
> 
> 标签：c#, windows, .net-4.0, windows-xp, desktop-application

> **可能重复：**
> [.net framework 4 可以在 windows xp 上运行吗？](https://stackoverflow.com/questions/3767651/can-net-framework-4-works-on-top-of-windows-xp)

我们正在考虑各种框架和语言选项来为我们的目标市场开发我们的数据库驱动的桌面应用程序，不幸的是，在他们的系统中大量使用 Windows XP。任何人都可以确认，如果我们在 C#/.NET 框架 4.0 中开发桌面应用程序，该应用程序是否能够在 Windows XP 上运行？我知道要运行 .net 开发的应用程序，我们需要在最终用户的系统中安装 .net 框架，所以我的第二个问题是：我们可以在 Windows XP 上安装 .net 框架（没有安装服务包）吗？等待您的专家解答启发。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-24T16:19:33.310

It's not clear why you think you've got two questions here - they're both basically "does .NET 4 run on Windows XP" which is easily answered by the [system requirements](http://msdn.microsoft.com/en-us/library/8z6watww%28v=vs.100%29.aspx) page.

That shows that .NET 4 works on XP Professional, XP Home Edition and XP Professional x64 edition. It does *not* work (or at least isn't supported) on Media Center, Tablet PC or Starter editions.

I would *expect* it to be an optional install via Windows Update, so you may find that *some* of your customers already have it installed, but plenty of others don't.

# sql-server - 在sql server中重新排序身份主键

> ID：14023574
> 
> 赞同：7
> 
> 时间：2012-12-24T16:16:28.600
> 
> 标签：sql-server, primary-key, identity

是的，我非常清楚后果。但我只想重新排序。从1开始到结束。

如何使用单个查询重新排序键？

它是聚集的主键索引

重新排序

```
First record Id 1 
second record Id 2 
```

主键是 Int

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2015-10-14T23:29:50.530

1.  删除 PK 约束
2.  删除身份列
3.  重新创建身份列
4.  重新创建PK

```
USE Test
go

if(object_id('IdentityTest') Is not null)
drop table IdentityTest

create table IdentityTest
(
Id int identity not null,
Name varchar(5),
constraint pk primary key (Id)
)

set identity_insert dbo.IdentityTest ON
insert into  dbo.IdentityTest (Id,Name) Values(23,'A'),(26,'B'),(34,'C'),(35,'D'),(40,'E')
set identity_insert dbo.IdentityTest OFF

select * from IdentityTest

------------------1\. Drop PK constraint ------------------------------------ 
ALTER TABLE [dbo].[IdentityTest] DROP CONSTRAINT [pk]
GO
------------------2\. Drop Identity column -----------------------------------
ALTER table dbo.IdentityTest
drop column Id
------------------3\. Re-create Identity Column -----------------------------------
ALTER table dbo.IdentityTest
add Id int identity(1,1)
-------------------4\. Re-Create PK-----------------------
ALTER TABLE [dbo].[IdentityTest] ADD  CONSTRAINT [pk] PRIMARY KEY CLUSTERED 
(
[Id] ASC
)

--------------------------------------------------------------
insert into  dbo.IdentityTest (Name) Values('F')
select * from IdentityTest 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-12-24T16:27:11.667

`IDENTITY` columns are not updatable irrespective of `SET IDENTITY_INSERT` options.

You could create a shadow table with the same definition as the original except for the `IDENTITY` property. Switch into that (this is a metadata only change with no movement of rows that just affects the table's definition) then update the rows and switch back though.

A full worked example going from a situation with gaps to no gaps is shown below (error handling and transactions are omitted below for brevity).

### Demo Scenario

```
/*Your original table*/
CREATE TABLE YourTable
(
Id INT IDENTITY PRIMARY KEY,
OtherColumns CHAR(100) NULL
)

/*Some dummy data*/
INSERT INTO YourTable (OtherColumns) VALUES ('A'),('B'),('C')

/*Delete a row leaving a gap*/
DELETE FROM YourTable WHERE Id =2 

/*Verify there is a gap*/
SELECT *
FROM YourTable 
```

### Remove Gaps

```
/*Create table with same definition as original but no `IDENTITY`*/
CREATE TABLE ShadowTable
(
Id INT PRIMARY KEY,
OtherColumns CHAR(100)
)

/*1st metadata switch*/
ALTER TABLE YourTable SWITCH TO ShadowTable;

/*Do the update*/  
WITH CTE AS
(
SELECT *,
       ROW_NUMBER() OVER (ORDER BY Id) AS RN
FROM  ShadowTable     
)
UPDATE CTE SET Id = RN

/*Metadata switch back to restore IDENTITY property*/  
ALTER TABLE ShadowTable SWITCH TO YourTable;

/*Remove unneeded table*/
DROP TABLE ShadowTable;

/*No Gaps*/
SELECT *
FROM YourTable 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-24T16:38:47.747

```
CREATE TABLE Table1_Stg (bla bla bla)

INSERT INTO Table1_Stg (Column2, Column3,...) SELECT Column2, Column3,... FROM Table1 ORDER BY Id 
```

这里 Id 列从 SELECT 列列表中排除。

或者，您可以这样做：

```
SELECT * INTO Table1_Stg FROM Table1 ORDER BY Id

DROP Table1

sp_rename Table1_stg Table1 
```

当我从内存中执行此操作时，请查找 sp_rename 的用法。

希望这可以帮助。

编辑：如果Table1上有任何索引和约束，请保存一个脚本。

EDIT2：添加了创建表和插入表的第二种方法。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2014-12-12T16:33:36.133

```
UPDATE tbl SET id = (SELECT COUNT(*) FROM tbl t WHERE t.id <= tbl.id); 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-12-24T16:29:23.740

我认为没有任何方法可以在单个查询中执行此操作。您最好的选择是将数据复制到新表，删除并重新创建原始表（或删除数据并重新设定身份）并使用先前的身份作为排序以原始顺序重新插入数据（但不重新插入它）。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2022-02-21T15:20:03.813

![在此处输入图像描述](../Images/831b1480fa69666f21f75910885f298b.png)

最后这句话是天才。只需首先从表设计中删除主键，并确保在设计选项下标识规范设置为否。运行查询后，请重新设置这些选项。

![在此处输入图像描述](../Images/7befb2730be8659763c22000d0ec1294.png)

# google-maps-api-3 - Google Maps API 自定义图标未出现

> ID：14023575
> 
> 赞同：0
> 
> 时间：2012-12-24T16:16:30.540
> 
> 标签：google-maps-api-3

我是 ac# 程序员，我的 JS 技能很弱。我一直在尝试所有方式和语法，以根据 Fusion 表中的查询参数显示自定义图标图像。我总是得到一个默认的红点图标。我正在使用 SetOptions 如下：

请注意，其他标记确实有效，只是自定义图像无效。

非常感谢您的帮助。

```
layerl0.setOptions({
    query:
    {
        select: 'col3',
        from: '1RqmLYAIdL9mvV3zAMVdnEjncXiiX0ZXJAwL92PY'
    },
    styles: [
    { where: "'Category' = 'Hotel'", markerOptions: { iconName: "rec_lodging" } },
    { where: "'Category' = 'Restaurant'", markerOptions: { iconName: "dining" } },
    { where: "'Category' = 'Do'", markerOptions: { icon: new google.maps.MarkerImage("http://m.inbocas.com/Content/icons/surfing.png")} },
    { where: "'Category' = 'Shop'", markerOptions: { iconName: "grocery" } },
    { where: "'Category' = 'Party'", markerOptions: { iconName: "bars" } },
    ]
}); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-24T16:26:04.260

你有 MarkerImage 的构造函数吗？

> MarkerImage(url:string, size?:Size, origin?:Point, anchor?:Point, scaledSize?:Size)

# vim - Linux命令用另一个字符串替换HUGE文件中的字符串

> ID：14023577
> 
> 赞同：3
> 
> 时间：2012-12-24T16:17:31.300
> 
> 标签：vim, sed

我有一个大文件（8GB），我想用 UTF-8 替换前 30 行的 String LATIN1 什么是最有效的方法？意味着存在一种可能使用 sed 但在解析前 30 行后退出的方法。

VIM 无法在 3 小时内保存文件。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-24T16:21:28.037

The problem is that in the event of a replacement, all programs will make a *copy* of the file with the substitution in place in order to replace the original file ultimately -- they don't want to risk losing the original for obvious reasons.

With perl, you can do this in a one-liner, but that doesn't make it any shorter (well, it probably does compared to vim, since vim preserves history in yet another file, which perl doesn't):

```
perl -pi -e 's,\bLATIN1\b,UTF-8,g if $. <= 30' thefile 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-24T16:19:50.690

With `sed`, you can quit using `q`:

```
sed -e 's/LATIN1/UTF-8/g' -e 30q 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-25T17:15:41.383

未经测试，但我认为`ed`会在不写入临时文件的情况下就地编辑文件。

```
ed yourBigFile << END
1,30s/LATIN1/UTF-8/g
w
q
END 
```

# android - 使用 RelativeLayout 作为自定义 InfoWindow 时出现 NullPointerException

> ID：14023588
> 
> 赞同：22
> 
> 时间：2012-12-24T16:19:04.413
> 
> 标签：android, google-maps, nullpointerexception, google-maps-android-api-2

我正在尝试将 a`RelativeLayout`用作我的标记的自定义`InfoWindow`，但我`NullPointerException`每次都得到 a`showInfoWindow`被调用（通过点击 a`Marker`或以编程方式）。我正在使用 Google Maps Android API v2。

**例外：**

```
FATAL EXCEPTION: main
java.lang.NullPointerException
    at android.widget.RelativeLayout.onMeasure(RelativeLayout.java:465)
    at android.view.View.measure(View.java:15172)
    at maps.a.y.i(Unknown Source)
    at maps.a.y.a(Unknown Source)
    at maps.a.w.a(Unknown Source)
    at maps.a.bd.a(Unknown Source)
    at maps.y.bw.b(Unknown Source)
    at maps.y.bw.a(Unknown Source)
    at maps.a.dh.a(Unknown Source)
    at maps.a.n.c(Unknown Source)
    at maps.a.dw.a(Unknown Source)
    at maps.a.bd.c(Unknown Source)
    at maps.a.dq.onSingleTapConfirmed(Unknown Source)
    at maps.e.v.onSingleTapConfirmed(Unknown Source)
    at maps.e.j.handleMessage(Unknown Source)
    ... 
```

**我的代码：**

*custom_infowindow.xml*

```
<?xml version="1.0" encoding="utf-8"?>
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:padding="10dip" >

    <ImageView
        android:id="@+id/icon"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_alignParentRight="true"
        android:paddingLeft="10dip"
        android:paddingRight="10dip"
        android:paddingTop="5dip"
        android:src="@drawable/icon" />

    <TextView
        android:id="@+id/title"
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        android:layout_toLeftOf="@id/icon"
        android:ellipsize="end"
        android:paddingLeft="10dip"
        android:paddingRight="10dip"
        android:singleLine="true" />

    <TextView
        android:id="@+id/snippet"
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        android:layout_below="@id/title"
        android:layout_toLeftOf="@id/icon"
        android:ellipsize="end"
        android:paddingBottom="10dip"
        android:paddingLeft="10dip"
        android:paddingRight="10dip"
        android:singleLine="true" />

</RelativeLayout> 
```

*CustomInfoWindowAdapter.java*

```
public class CustomInfoWindowAdapter implements InfoWindowAdapter {

    private View layout;
    private LayoutInflater inflater;

    public CustomInfoWindowAdapter(Context context) {
        inflater = LayoutInflater.from(context);
    }

    @Override
    public View getInfoContents(Marker marker) {
        return null;
    }

    @Override
    public View getInfoWindow(Marker marker) {
        ViewHolder holder;

        if (layout == null) {
            layout = inflater.inflate(R.layout.custom_infowindow, null);

            holder = new ViewHolder();
            holder.title = (TextView) layout.findViewById(R.id.title);
            holder.snippet = (TextView) layout.findViewById(R.id.snippet);

            layout.setTag(holder);
        } else {
            holder = (ViewHolder) layout.getTag();
        }

        holder.title.setText(marker.getTitle());
        holder.snippet.setText(marker.getSnippet());

        return layout;
    }

    static class ViewHolder {
        TextView title;
        TextView snippet;
    }

} 
```

有趣的是，如果我`LinearLayout`改用它，它工作得很好，但如果可能的话，我宁愿只使用一个`ViewGroup`。当然，我想知道`onMeasure`投掷`NullPointerException`.

`RelativeLayout`编辑：另外，将内部包装a`FrameLayout`或 a`LinearLayout`将起作用。当然，将它包裹在另一个里面`RelativeLayout`不会。

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2013-04-01T19:58:12.093

我遇到了这个问题，并且能够通过添加来解决它

```
view.setLayoutParams(new ViewGroup.LayoutParams(desiredWidth,desiredHeight)); 
```

在从 InfoWindowAdapter.getInfoWindow 返回视图之前

* * *

## 回答 #2

> 赞同：24
> 
> 时间：2014-05-20T13:19:36.020

刚刚发现在 android 版本 < 4.4 这会产生一个空指针异常。使用线性布局更改布局将解决问题。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2014-07-15T19:41:07.700

即使我的 xml 中没有 RelativeLayout，我也遇到了这个问题。事实证明，我的类支持从 RelativeLayout 继承的 XML，即使它是一个 LinearLayout。

它不会对几个不同的设备造成错误，但是当我在我的 S3 上尝试时它崩溃了。

无论如何，只需删除或包装 RelativeLayout 或首先设置布局高度/宽度。

# python - BYTE 到 python C-Type 结构的转换问题

> ID：14023590
> 
> 赞同：1
> 
> 时间：2012-12-24T16:19:14.273
> 
> 标签：python, python-2.7, structure, ctypes

我在反序列化从 POSIX 队列接收到的一些字节时遇到了一个小问题。

我们正在尝试开发一个模块，其中 Python 应用程序将 POSIX 队列数据发布到 C 应用程序，C 将数据重新发布到 Python 队列。

所有数据都是基于 Ctype 结构的。

结构定义：

**msgStruct.py**

```
MAX_MSG_SIZE = 5120
class MsgStruct(ctypes.Structure):
    _fields_ = [
                ("msgType", ctypes.c_int),
                ("msgSize",ctypes.c_int),
                ("setState",ctypes.c_int),
                ("msgBuf",ctypes.c_char * MAX_MSG_SIZE)
            ] 
```

**转换.py**

```
class conversions():
    def serialize(ctypesObj):
        """
        FAQ: How do I copy bytes to Python from a ctypes.Structure?
        """
        return buffer(ctypesObj)[:]

    def deserialize(ctypesObj, inputBytes):
        """
        FAQ: How do I copy bytes to a ctypes.Structure from Python?
        """
        fit = min(len(inputBytes), ctypes.sizeof(ctypesObj))
        ctypes.memmove(ctypes.addressof(ctypesObj), inputBytes, fit)
        return ctypesObj 
```

**测试.py**

```
from mapStruct import *
from conversions import conversions
wrapper=conversions()
data="\x01\x00\x00\x00\x70\x01\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x02\x00\x00\x00\x1e\x00\x00\x00\x25\x42\x35\x32\x33\x39\x35\x31\x32\x35\x32\x34\x38\x39\x35\x30\x30\x36\x5e\x56\x45\x4e\x4b\x41\x54\x20\x52\x41\x47\x41\x56\x41\x4e\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x5e\x31\x36\x30\x34\x31\x30\x31\x31\x36\x35\x35\x36\x30\x30\x31\x34\x31\x30\x30\x30\x30\x30\x30\x3f\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x3b\x35\x32\x33\x39\x35\x31\x32\x35\x32\x34\x38\x39\x35\x30\x30\x36\x3d\x31\x36\x30\x34\x31\x30\x31\x31\x34\x31\x30\x3f\x00\x00...\x00"
"""
Data is the Queue data that is recieved by python
"""
baseStruct=MsgStruct()
rxData=wrapper.deserialize(baseStruct,data)
print rxData.setState # Prints as expected
print rxData.msgType # Prints as expected
print rxData.msgSize
print rxData.msgBuf.encode('hex') # here is probles i dont C any data in this buffer 
```

请指导我解决这个问题。我很惊讶缓冲区（rxData.msgSize）总是空的并且想知道为什么。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-24T20:01:25.937

`ctypes`试图`c_char`通过将缓冲区转换为 Python 字符串来帮助缓冲区。转换在第一个空字节处停止。观察当我更改数据缓冲区中的前几个字节数据时会发生什么：

```
0
1
368
b'\x01\x02' 
```

将类型`msgBuf`改为`c_ubyte`改为，这样`ctypes`就不会试图“有帮助”，然后逐个字符地查看数据：

```
>>> print repr(''.join(chr(x) for x in rxData.msgBuf))
'\x00\x00\x00\x00\x02\x00\x00\x00\x1e\x00\x00\x00%B5239512524 ... 
```

但是根本没有理由使用`ctypes`：

```
import struct

data=b"\x01\x00\x00\x00\x70\x01\x00\x00\x00\x00\x00\x00\x01\x02\x00\x00\x02\x00\x00\x00\x1e\x00\x00\x00\x25\x42\x35\x32\x33\x39\x35\x31\x32\x35\x32\x34\x38\x39\x35\x30\x30\x36\x5e\x56\x45\x4e\x4b\x41\x54\x20\x52\x41\x47\x41\x56\x41\x4e\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x5e\x31\x36\x30\x34\x31\x30\x31\x31\x36\x35\x35\x36\x30\x30\x31\x34\x31\x30\x30\x30\x30\x30\x30\x3f\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x3b\x35\x32\x33\x39\x35\x31\x32\x35\x32\x34\x38\x39\x35\x30\x30\x36\x3d\x31\x36\x30\x34\x31\x30\x31\x31\x34\x31\x30\x3f\x00\x00...\x00"

msg_offset = struct.calcsize('iii')
print struct.unpack_from('iii',data)
print repr(data[msg_offset:]) 
```

输出：

```
(1, 368, 0)
'\x01\x02\x00\x00\x02\x00\x00\x00\x1e\x00\x00\x00%B5239512524895006^VENKAT RAGAVAN            ^16041011655600141000000?\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00;5239512524895006=16041011410?\x00\x00...\x00' 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-24T18:39:05.890

您可以使用[`struct`](http://docs.python.org/2/library/struct.html)为您解包数据：

```
import struct
import ctypes

class MsgStruct(ctypes.Structure):
    _fields_ = [
                ("msgType", ctypes.c_int),
                ("msgSize",ctypes.c_int),
                ("setState",ctypes.c_int),
                ("msgBuf",ctypes.c_char * 5120)
            ]

def deserialize(data):
    sz = len(data)-struct.calcsize('iii')
    return MsgStruct(*struct.unpack('iii{}s'.format(sz), data)) 
```

用你的数据测试它：

```
In [18]: data
Out[18]: '\x01\x00\x00\x00p\x01\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x02\x00\x00\x00\x1e\x00\x00\x00%B5239512524895006^VENKAT RAGAVAN            ^16041011655600141000000?\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00;5239512524895006=16041011410?\x00\x00...\x00'

In [19]: s = deserialize(data)

In [20]: s.
s.msgBuf    s.msgSize   s.msgType   s.setState  

In [20]: s.msgType
Out[20]: 1

In [21]: s.msgSize
Out[21]: 368

In [22]: s.setState
Out[22]: 0 
```

*编辑：*`MsgStruct`分配不适用于该领域`msgBuf`。[原因请参阅此问题](https://stackoverflow.com/questions/5082753/how-do-i-build-a-python-string-from-a-ctype-struct)的答案。解压结构工作正常：

```
In [13]: sz=12

In [14]: struct.unpack('iii{}s'.format(len(data)-sz), data)
Out[14]: (1, 368, 0, '\x00\x00\x00\x00\x02\x00\x00\x00\x1e\x00\x00\x00%B5239512524895006^VENKAT RAGAVAN            ^16041011655600141000000?\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00;5239512524895006=16041011410?\x00\x00...\x00') 
```

# php - Facebook Application Permissions Error

> ID：14023597
> 
> 赞同：0
> 
> 时间：2012-12-24T16:20:00.533
> 
> 标签：php, facebook, facebook-graph-api, facebook-php-sdk, facebook-permissions

I have a facebook application that require several permissions (i.e. to read user `comments`, `profile picture`, `cover picture` etc). These are set up from the permissions section of my application. The problem is that when users use this application, the only permission access being asked is:

> THIS APP WILL RECEIVE:
> 
> Your basic info

Ignoring all the other permissions that I originally required. Any ideas why is this?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-24T16:40:39.317

在用户登录时设置权限列表。例如-

```
FB.login(function(response) 
{
   if (response.authResponse) 
   {
       console.log('Welcome!  Fetching your information.... ');
       FB.api('/me', function(response) 
       {
             console.log('Good to see you, ' + response.name + '.');
       });
   } 
   else 
   {
       console.log('User cancelled login or did not fully authorize.');
   }
},{scope: 'email,user_likes'}); 
```

# ruby-on-rails - Uninitialized Constant Admin on Heroku

> ID：14023599
> 
> 赞同：1
> 
> 时间：2012-12-24T16:20:01.590
> 
> 标签：ruby-on-rails, devise

I have a fresh app with only a few gems. Devise being one of them of course. And when I make an Admin model via Devise's Option 1 give [here](https://github.com/plataformatec/devise/wiki/How-To%3a-Add-an-Admin-role)

... and upload to heroku, I am unable to run a db:migrate due to the following error:

> rake aborted! uninitialized constant Admin /app/vendor/bundle/ruby/1.9.1/gems/activesupport-3.2.8/lib/active_support/inflector/methods.rb:230:in `block in constantize' /app/vendor/bundle/ruby/1.9.1/gems/activesupport-3.2.8/lib/active_support/inflector/methods.rb:229:in`each' /app/vendor/bundle/ruby/1.9.1/gems/activesupport-3.2.8/lib/active_support/inflector/methods.rb:229:in `constantize' /app/vendor/bundle/ruby/1.9.1/gems/devise-2.1.2/lib/devise.rb:256:in`get' /app/vendor/bundle/ruby/1.9.1/gems/devise-2.1.2/lib/devise/mapping.rb:77:in `to' /app/vendor/bundle/ruby/1.9.1/gems/devise-2.1.2/lib/devise/mapping.rb:72:in`modules' /app/vendor/bundle/ruby/1.9.1/gems/devise-2.1.2/lib/devise/mapping.rb:89:in `routes' /app/vendor/bundle/ruby/1.9.1/gems/devise-2.1.2/lib/devise/mapping.rb:156:in`default_used_route'

etc...

Does anyone have any suggestions?

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-24T23:18:32.703

创建了另一个新的 Rails 应用程序，现在一切正常。我相信问题可能是我用大写的“A”创建了我的管理模型，并且一些代码正在寻找一个带有小写“a”的管理模型

# algorithm - 发布-订阅系统的设计/代码调度程序

> ID：14023600
> 
> 赞同：6
> 
> 时间：2012-12-24T16:20:01.887
> 
> 标签：algorithm, data-structures

我的一个朋友在一次采访中被问到这个问题。我想在这里讨论这个问题

这个问题的有效实施是什么？

我想到的一个简单的想法是普通的 memqueue ，使用 Memcache 机器来扩展多个请求，并运行一个消费者作业，它将内容从 memcache 写入 DB。稍后对于第二部分，我们可以运行一个 sql 查询来查找匹配订阅者的列表。

问题：-

事件被发布到这个系统。每个事件都可以被认为包含一个固定数量 (N) 的字符串列，称为 C1、C2、... CN。因此，每个事件都可以作为字符串数组传递（C1 是数组中的第 0 个元素，C2 是第一个元素，依此类推）。

有 M 个订阅者 – S1, … SM

每个订阅者注册一个谓词，指定它感兴趣的事件子集。每个谓词可以包含：

```
Equality clause on columns, for example: (C1 == “US”)
Conjunctions of such clauses, example: 
    (C1 == “IN”) && (C2 == “home.php”) 
    (C1 == “IN”) && (C2 == “search.php”) && (C3 == “nytimes.com”) 
```

（在上面的例子中，C1 代表事件的国家代码，C2 代表网站的网页，C3 代表推荐人代码。）

IE。– 每个谓词都是一些相等条件的合取。请注意，谓词不一定对所有列都有相等子句（即，谓词可能不关心某些或所有列的值）。（在上面的示例中：#a 不关心列 C3，... CN）。

我们必须设计和编写一个 Dispatcher，它可以将传入的事件与注册的订阅者相匹配。传入事件的速率为每秒数百万。订阅者数以千计。所以这个调度器必须非常高效。简单来说：

```
When the system boots, all the subscribers register their predicates to the dispatcher
After this events start coming to the dispatcher
For each event, the dispatcher has to emit the id of the matching subscribers. 
```

就接口规范而言，可以大致说明以下内容（用Java）：

```
Class Dispatcher {

    public Dispatcher(int N /* number of columns in each event – fixed up front */);

    public void registerSubscriber( String subscriberId /* assume no conflicts */,
                                    String predicate /* predicate for this subscriberid */);

    public List<String> findMatchingIds(String[] event /* assume each event has N Strings */);

} 
```

即：构造了调度程序，然后进行了一堆 registerSubscriber 调用。之后，我们不断调用 findMatchingIds() 方法，本练习的目标是使该函数尽可能高效。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-26T15:18:46.267

我想到的一个解决方案是：

对于每个 Cn，我们都有一个从值到订阅 Cn 值的订阅者集的映射。此外，对于每个 Cn，我们都有一组不关心 Cn 值（'ANY'）的订阅者。

当接收到一个事件时，我们查找与 Cn 匹配的订阅的所有订阅者，并接收一个包含 0 个或更多订阅者的集合。在这个集合中，我们将来自该 Cn 的“ANY”集合中的订阅者添加到该集合中。

我们对每 n <= N 执行此操作，产生 n 组订阅者。所有n个集合的交集就是匹配这个事件的订阅者集合。

从 Cn 到订阅者的映射可以有效地存储为树，这给出了复杂度 O(k) = log(k) 来查找单个 Cn 的订阅者，假设有 k 个不同值的订阅。

因此，对于 n 个值，我们的复杂度为 O(n,k) = n * log(k)。

相交 n 个集合也可以在 O(n,m) = n * log(m) 中完成，所以我们最终得到一个对数复杂度，这应该不会太糟糕。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-03T15:35:25.610

有趣的。

我最初的想法。我觉得如果订户谓词例如

> (C1 == “IN”) && (C2 == “search.php”) && (C3 == “nytimes.com”)

来到调度员

> 公共无效注册用户

方法需要**展平**，以便比较性能更友好。类似下面的东西（疯狂猜测）

> C1IN|C2search.php|C3nytimes.com

然后需要在内存中维护一个带有事件字符串和订阅者 ID 的映射

在里面

> findMatchingIds

方法 - 事件的字符串数组也需要使用类似的规则进行**展平**，以便可以查找匹配的订阅者 ID

通过这种方式，调度程序可以水平扩展，并行服务许多事件

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-04T05:42:19.057

正如 Hanno Binder 所暗示的，这个问题显然是为了允许对订阅进行预处理以获得有效的查找结构。Hanno 说查找应该是一张地图

```
(N, K) -> set of subscribers who specified K in field N     
(N, "") -> set of subscribers who omitted a predicate for field N 
```

当一个事件到来时，只需查找所有适用的集合并找到它们的交集。查找失败返回空集。我只是重述 Hanno 的好答案，指出哈希表是 O(1) 并且在这个应用程序中可能比树更快。另一方面，相交的树可以更快，O(S + log N)，其中 S 是相交的大小。所以这取决于集合的性质。

**选择**

这是我的替代查找结构，在预处理期间再次创建一次。从编译地图开始

```
(N, K) -> unique token T (small integer) 
```

还有一个`0`代表“不在乎”的杰出标记。

现在，每个谓词都可以被认为是具有 N 个标记的类似于正则表达式的模式，代表特定的事件字符串键或“不关心”。

我们现在可以提前构建决策树。您也可以认为这棵树是用于识别模式的确定性有限自动机 (DFA)。边缘标有标记，包括“不关心”。如果没有其他边缘匹配，则采用无关边缘。接受状态包含相应的订户集。

处理事件从将键转换为令牌模式开始。如果由于缺少映射条目而失败，则没有订阅者。否则将模式提供给 DFA。如果 DFA 在没有崩溃的情况下使用该模式，则最终状态包含订阅者集。退回这个。

例如，我们将有地图：

```
(1, "IN") -> 1
(2, "home.php") -> 2
(2, "search.php") -> 3
(3, "nytimes.com") -> 4 
```

对于 N=4，DFA 如下所示：

```
o --1--> o --2--> o --0--> o --0--> o
          \
            -3--> o --4--> o --0--> o 
```

请注意，由于没有不关心例如 C1 的订阅者，因此起始状态没有不关心转换。C1 中任何没有“IN”的事件都会导致崩溃，并且会正确返回空集。

只有数千个订阅者，这个 DFA 的大小应该是合理的。

这里的处理时间当然是 O(N) 并且在实践中可能非常快。为了真正的速度，预处理可以生成和编译一组 C switch 语句。以这种方式，您实际上可能会在少量处理器的情况下每秒获得数百万个事件。

您甚至可以哄骗像[flex 扫描仪生成器](http://westes.github.io/flex/manual/)这样的标准工具来为您完成大部分工作。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-01-05T09:21:45.067

我认为这更像是一个设计问题——我认为面试官不会一直在寻找工作代码。一般的问题叫做 [基于内容的发布订阅](http://conferences.sigcomm.org/sigcomm/2011/papers/icn/p56.pdf)，如果你搜索同一领域的论文，你会得到很多结果：例如——[这篇论文也](http://www0.cs.ucl.ac.uk/staff/C.Raiciu/files/craiciu-revisiting.pdf)

这是系统需要的一些东西

1) 需要存储的订阅数据存储： a) 存储订阅者列表 b) 存储订阅列表

2) 一种验证订阅请求和节点本身的方法 a) 服务器-订阅者通过 ssl 进行通信。在服务器处理数千个 SSL 连接的情况下 - 这是一项 CPU 密集型任务，特别是如果大量连接是突发设置的。
b) 如果所有订阅者节点都在同一个可信网络中，则不需要有 ssl。

3）我们是否想要一个基于推或拉的模型：

a）服务器可以维护每个节点看到的最新时间戳，每个过滤器匹配。当事件与过滤器匹配时，向订阅者发送通知。然后让客户端发送请求。然后服务器开始发送匹配事件。

b) 服务器一次性匹配并发送过滤器给客户端。

(a) 和 (b) 之间的区别在于，在 (a) 中，您在客户端维护了更多状态。以后更容易扩展特定于订阅者的逻辑。在（b）中，客户是愚蠢的。它没有任何方法可以说明它是否出于某种原因不想接收事件。（比如说，网络阻塞）。

4) 事件在服务器端的内存中是如何维护的？

```
 a)The logical model here is table with columns of strings (C1..CN), and each new row added is a new event.
b)We could have A hash-table per column storing a tupple of  (timestamp, pointer to event structure). And each event is given a unique id. With different data-structures,we can come up with different schemes. 
 c) Events here are considered as infinite stream. If  we have a 32-bit eventId, we have chances of integer-overflow.
 d) If we have a timer function on  the server, matching and dispatching events,what is the actual resolution of the system timer? Does that have any implication? 
     e) Memory allocation is a very expensive operation.  If your filter-matching logic is going to do frequent allocations/ freeing, it will adversely affect performance.  How can we manage the memory-pool for this particular operation? Would we different size-buckets of  page-aligned memory? 
```

5) 如果订阅者节点失去连接或宕机，会发生什么？(a)客户端在此期间丢失事件是否可以接受，或者服务器是否应该缓冲所有内容？(b)如果订阅者宕机，它可以请求匹配事件到过去的历史时间。

6) (Server,Subscriber) 之间的消息传递层的更多细节 (a) 服务器和订阅者之间的通信是同步的还是异步的？
(b) 客户端/服务器之间是否需要二进制协议或基于文本的协议？（两者都有取舍）

7）我们是否需要在服务器端进行任何速率限制逻辑？如果我们在向少数其他客户提供数据的同时让一些客户挨饿，我们应该怎么做？

8) 如何管理订阅变更？如果某个客户端希望更改它的订阅，那么是否应该在更新永久数据存储之前先在内存中更新它？或相反亦然？如果在写入数据存储之前服务器宕机会发生什么？我们如何确保数据存储——订阅/服务器列表的一致性？

9)This was assuming that we have a single server- What if we need a cluster of servers that the subscribers can connect to? (Whole bunch of issues here: ) a)How can network-partitioning be handled? ( example: of say 5 nodes,3 nodes are reachable from each other, and other 2 nodes can only reach other?) b) How are events/workload distributed among the members of the cluster?

10) Is absolute correctness of information sent to the subscriber a requirement,ie, can the client receive additional information,that what it's subscription rules indicate? This can determine choice of data-structure- example using a probabilistic data structure like a Bloom filter on the server side, while doing the filtering

11)How is time-ordering of events maintained on the server side? (Time-order sorted linked list? timestamps?)

12) 订阅的谓词逻辑解析器是否需要 unicode 支持？

总之，基于内容的发布-订阅是一个相当广阔的领域——它是一个分布式系统，涉及数据库、网络、算法、节点行为的交互（系统宕机、磁盘坏、系统内存不足，因为内存泄漏等） - 我们必须查看所有这些方面。最重要的是，我们必须查看实际实施的可用时间，然后确定我们要如何解决这个问题。

# android - Android 样式指定按钮颜色

> ID：14023601
> 
> 赞同：8
> 
> 时间：2012-12-24T16:20:03.320
> 
> 标签：android, xml, button, background

我正在尝试在**styles.xml 中默认应用按钮文本颜色**

```
<resources xmlns:android="http://schemas.android.com/apk/res/android">
<style name="AppTheme">
   <item name="android:windowFullscreen">true</item>
   <item name="android:windowBackground">@color/black</item>
   <item name="android:textColor">@color/green</item>
</style> 
```

如何使样式更改按钮颜色，并应用于整个应用程序？我的主要内容包括：

```
 <application
    android:icon="@drawable/ic_launcher"
    android:label="Hack the World"
    android:theme="@style/AppTheme"> 
```

这会更改所有文本（例如 TextView），但不会更改按钮中的文本。如果我使用上面的 ColorThemes 样式并将其放在按钮的 xml 中，如下所示：

```
 <Button
    android:id="@+id/button3"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_centerHorizontal="true"
    android:layout_centerVertical="true"
    android:onClick="loadSavedgame"
    android:text="Load Saved Game" 
    android:textColor="@color/green" />" 
```

然后它完美地工作。为什么由于风格而不能普遍适用？所有不同版本的**styles.xml**都有相同的代码。

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2012-12-25T19:29:17.610

我最终发现一个按钮实际上是一个 9-patch 图像，位于 @android:drawable/btn_default 为了改变背景你必须修改这个图像。为了更改按钮文本颜色，我必须设置按钮小部件样式并将其导入我的应用程序主题，如下所示：

```
<resources xmlns:android="http://schemas.android.com/apk/res/android">
<style name="AppTheme" parent="android:Theme.Holo.Light.DarkActionBar" >
   <item name="android:windowFullscreen">true</item>
   <item name="android:windowBackground">@color/black</item>
   <item name="android:textColor">@color/green</item>
   <item name="android:buttonStyle">@style/ButtonText</item>
</style> 

    <style name="ButtonText" parent="@android:style/Widget.Button">
   <item name="android:textColor">@color/green</item>
   <item name="android:background">@android:drawable/btn_default</item><!-- only way to change this is to change the src image -->
   <item name="android:layout_width">80.0px</item>
   <item name="android:layout_height">40.0px</item> 
</style> 
</resources> 
```

# r - 阅读时长

> ID：14023604
> 
> 赞同：1
> 
> 时间：2012-12-24T16:20:19.560
> 
> 标签：r, statistics

我有一个 CSV 文件，其中包含铁人三项每个部分的每位参赛者的时间。我无法读取数据，以便 R 可以使用它。这是数据外观的示例（为清楚起见，我删除了一些列）：

```
"Place","Division","Gender","Swim","T1","Bike","T2","Run","Finish"
1, "40-49","M","7:45","0:55","27:07","0:29","18:53","55:07"
2, "UNDER 18","M","5:41","0:28","30:41","0:28","18:38","55:55"
3, "40-49","M","6:27","0:26","29:24","0:40","20:16","57:11"
4, "40-49","M","7:57","0:35","29:19","0:23","19:20","57:32"
5, "40-49","M","6:28","0:32","31:00","0:34","19:19","57:51"
6, "40-49","M","7:42","0:30","30:02","0:37","19:11","58:02"
....
250 ,"18-29","F","13:20","3:23","1:06:40","1:19","38:00","2:02:40"
251 ,"30-39","F","13:01","2:42","1:02:12","1:20","43:45","2:02:58"
252 ,50 ,"F","20:45","1:33","58:09","3:17","40:14","2:03:56"
253 ,"30-39","M","13:14","1:14","DNF","1:11","25:10","DNF bike"
254 ,"40-49","M","10:04","1:41","56:36","2:32",,"D.N.F" 
```

我第一次天真地尝试绘制数据是这样的。

```
> tri <- read.csv(file.choose(), header=TRUE, as.is=TRUE)
> pairs(~ Bike + Run + Swim, data=tri) 
```

时间没有以合理的方式导入，所以图表没有意义。

我找到了该`difftime`类型并尝试使用它来解析数据文件中的时间。

有一些行用 DNF 或类似的代替时间，我很高兴那些时间无法解析以被丢弃的行。时间“%M:%S”和“%H:%M:%S”有两种格式

我想我需要从数据中创建一个新的数据框，但我无法解析时间。这就是我到目前为止所拥有的。

```
> tri <- read.csv(file.choose(), header=TRUE, as.is=TRUE)
> str(tri)
'data.frame':   254 obs. of  12 variables:
 $ Place     : num  1 2 3 4 5 6 7 8 9 10 ...
 $ Race..    : num  237 274 268 226 267 247 264 257 273 272 ...
 $ First.Name: chr  ** removed names ** ...
 $ Last.Name : chr  ** removed names ** ...
 $ Division  : chr  "40-49" "UNDER 18" "40-49" "40-49" ...
 $ Gender    : chr  "M" "M" "M" "M" ...
 $ Swim      : chr  "7:45" "5:41" "6:27" "7:57" ...
 $ T1        : chr  "0:55" "0:28" "0:26" "0:35" ...
 $ Bike      : chr  "27:07" "30:41" "29:24" "29:19" ...
 $ T2        : chr  "0:29" "0:28" "0:40" "0:23" ...
 $ Run       : chr  "18:53" "18:38" "20:16" "19:20" ...
 $ Finish    : chr  "55:07" "55:55" "57:11" "57:32" ...
> as.numeric(as.difftime(tri$Bike, format="%M:%S"), units="secs") 
```

这会转换小于一小时的所有时间，但小时会被解释为一小时以上的任何时间的分钟。将 "%H:%M:%S" 替换为 "%M:%S" 会在一小时内解析时间，但否则会产生 NA。转换这两种时间的最佳方法是什么？

编辑：根据要求添加一个简单的示例。

```
> times <- c("27:07", "1:02:12", "DNF")
> as.numeric(as.difftime(times, format="%M:%S"), units="secs")
[1] 1627   62   NA
> as.numeric(as.difftime(times, format="%H:%M:%S"), units="secs")
[1]   NA 3732   NA 
```

我想要的输出是`1627 3732 NA`

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-24T16:32:28.963

这是解决方案的快速破解，尽管可能有更好的解决方案：

```
cdifftime <- function(x) {
   x2 <- gsub("^([0-9]+:[0-9]+)$","00:\\1",x)  ## prepend 00: to %M:%S elements
   res <- as.difftime(x2,format="%H:%M:%S")  
   units(res) <- "secs"
   as.numeric(res)
}
times <- c("27:07", "1:02:12", "DNF")
cdifftime(times)
## [1] 1627 3732   NA 
```

您可以将此应用于相关列：

```
tri[4:9] <- lapply(tri[4:9],cdifftime) 
```

尝试复制您的示例的一些注意事项：

*   您可能想使用`na.strings="DNF"`将“未完成”值设置为`NA`自动
*   您需要确保*不*将字符串作为因素读入，例如 (1) set `options(stringsAsFactors="FALSE")`；(2)`stringsAsFactors=FALSE`调用时使用`read.csv`；(3) 使用`as.is=TRUE`，同上。

# c++ - Can't call method of derived class - compiler identifies object instance as base class

> ID：14023607
> 
> 赞同：3
> 
> 时间：2012-12-24T16:20:51.860
> 
> 标签：c++, inheritance, methods, compiler-errors, base-class

I am getting a compiler error when calling a method defined in a derived class. The compiler seems to think that the object I am referring to is of a base class type:

```
weapon = dynamic_cast<Weapon*>(WeaponBuilder(KNIFE)
.name("Thief's Dagger")
.description("Knife favored by Thieves")
.attack(7)    // error: class Builder has no member called attack 
.cost(10)     // error: class Builder has no member called cost
.build()); 
```

Indeed, `Builder` doesn't contain either `attack` or `cost`:

```
class Builder
{
protected:

    string m_name;
    string m_description;

public:

    Builder();
    virtual ~Builder();
    virtual GameComponent* build() const = 0;

    Builder& name(string);
    Builder& description(string);
}; 
```

But the derived class `WeaponBuilder` does:

```
enum WeaponType { NONE, KNIFE, SWORD, AXE, WAND };

class WeaponBuilder : public Builder
{
    int m_cost;
    int m_attack;
    int m_magic;

    WeaponType m_type;

public:

    WeaponBuilder();
    WeaponBuilder(WeaponType);
    ~WeaponBuilder();

    GameComponent* build() const;

    // should these be of reference type Builder or WeaponBuilder?
    WeaponBuilder& cost(int); 
    WeaponBuilder& attack(int);
    WeaponBuilder& magic(int);

}; 
```

I am not sure why the compiler cannot find the `attack` or `cost` method in the `WeaponBuilder` class, as it is clearly present. I am also not sure why it recognizes the object as an instance of the base class `Builder`.

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-24T16:23:42.403

它找不到它，因为两者都`name`返回`description`a`Builder&`而不是 a `WeaponBuilder&`，因此那些其他方法不存在。除了到处强制转换之外，您的代码没有明确的解决方案。

*您可以使用CRTP*重写整个事情并解决您的问题，但这是一个重大的变化。包括以下内容：

```
template< typename Derived >
class builder
{
    Derived& name( std::string const& name ){ /*store name*/, return *derived(); }

    Derived* derived(){ return static_cast< Derived* >( this ); }
};

class weapon_builder : builder< weapon_builder >
{
    weapon_builder& attack( int ){ /*store attack*/ return *this; }

    GameComponent* build() const{ return something; }
}; 
```

请注意，使用这种方法，所有`virtual`方法都应该消失，并且您将失去引用普通的能力，`builder`因为它不再是常见的基类型而是类模板。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-24T16:26:07.230

你的意图可能是这样的：

```
weapon = dynamic_cast<Weapon*>(dynamic_cast<WeaponBuilder &>(WeaponBuilder(KNIFE)
.name("Thief's Dagger")
.description("Knife favored by Thieves"))
.attack(7)    
.cost(10)     
.build()); 
```

# mysql - Select duplicate values in one column in a table

> ID：14023608
> 
> 赞同：3
> 
> 时间：2012-12-24T16:20:58.410
> 
> 标签：mysql, sql, sql-server, oracle

I have this table:

```
id int, name nvarchar(max), .............. 
```

Example:

```
 ------------------
| id  | name       |
 ------------------
| 1   | Mohammed   | 
| 2   | Mohammed   |    
| 3   | Sakher     |
| 4   | Sakher     |
| 5   | Ahmad      |
| 6   | Ahmad      |
| 11  | Hasan      |
| 50  | Hasan      |
| 17  | Sameer     |
| 19  | Soso       |
| 110 | Omar       |
| 113 | Omar       |
| 220 | Omar       |
 ------------------ 
```

I am trying to write a query to result this:

```
id1 int , id2 int , name nvarchar(max) 
```

Example:

```
 ------------------------
| id1 | id2 | name       |
 ------------------------
|  1  |  2  | Mohammed   |
|  3  |  4  | Sakher     |
|  5  |  6  | Ahmad      |
| 11  |  50 | Hasan      |
| 110 | 113 | Omar       |
| 110 | 220 | Omar       |
| 113 | 220 | Omar       |
 ------------------------ 
```

Return the duplicates in one of the columns. I prefer SQL Server query or standard ANSI SQL one.

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-12-24T16:27:57.533

此查询返回您要求的内容。比较 n1.id > n2.id 比这样做更好 n1.id != n2.id 因为这样你会得到每对两次（第二次，相反）：

```
SELECT 
    n1.id as Col1, n2.id as Col2, n1.name
FROM 
    Names n1, Names n2
WHERE 
    n1.name = n2.name 
    AND n1.id > n2.id 
```

*   [SQLFIDDLE 演示](http://sqlfiddle.com/#!2/55f27/5)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-12-24T16:27:10.357

```
Select count(*), name
from someTable
group by name
having count(*) > 1 
```

将为您提供所有重复的名称以及重复的数量，并且可能比您请求的名称更有用。为此，您可以执行以下操作：

```
Select a.id, b.id, a.name
from someTable a
 inner join someTable b
on a.id <> b.id and a.name = b.name 
```

# php - $_POST persistency using an AJAX call

> ID：14023612
> 
> 赞同：3
> 
> 时间：2012-12-24T16:21:41.890
> 
> 标签：php, jquery, ajax, post, response

I am trying to set up a comment system, in which when the users sends the comment it is displayed on their screen as if it were already stored on the database. My question is: what would happen if the users send comments and then navigate away (or most specifically close the window immediately) or they lose connection after the ajax post?

On the code side I have `ajax({})`...

Then I have code that takes the user input from the textarea and adds it to a div.

This means that the user gets to see the comment they entered instantaneously. But I would like to be sure if the server will get the post info even if the connection was lost, window was closed or the user navigated away.

* * *

**More info for the question:**

A user sends a post to the server with 1mb of values, then right after one millisecond he/she clicked on the button that made the post the browser window was closed.

Does the server receive and parse the response with `ignore_user_abort(true);` inside the file; was the post info received?

Any difference if it were get instead of post for this case?

Assume `website.com?myget=value`

Trying to connect then closing the window immediately, on a browser window for example, just hitting that on the address bar and then closing very right away, imagine it to be automatically.

step 1 go to `website.com?myget=value` (don't wait at all for any server response, just straight away (a millisecond or whatever it takes the script to do so) close completely the window.

Would `$_GET['myget']` be received server side at index.php of website.com?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-24T17:24:47.780

将添加我的五美分。和`ajax({})`您将要求浏览器开始与您的服务器通信。它需要一些时间来建立连接（ping 时间）并将数据发送到服务器。这两部分都需要一些时间才能完成。为了让 PHP 开始执行，浏览器必须发送它必须发送的所有数据。无论是 POST 还是 GET。如果用户将中断发送过程（浏览器崩溃，标签关闭，计算机关闭）PHP 甚至不会启动。例如，您可以尝试发送一些大文件并使用调试器查看 PHP 脚本何时启动 - 仅在文件完全交付后（您甚至可以在文件上传之前关闭浏览器并查看您的脚本是否已执行） . 仅在将所有数据传递到服务器后才开始执行 PHP 并忽略在数据传递之前断开的连接是有意义的。否则可能会出现数据损坏的问题。没有人想要那样。另外，假设 PHP 是在所有内容交付到服务器之前启动的：您永远无法确定`$_POST["something"]`不可用，因为用户从未输入过它，或者它的数据尚未交付。

如果您使用常规表单提交或 XMLHTTPRequest，则没有区别。在这两种情况下，浏览器都需要一些时间来建立与服务器的连接并将数据传递给它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-24T16:43:51.293

这是一个用户体验问题，而不是技术问题。您要做的是仅在存储新评论后才显示新评论。工作流程应该是这样的：

1.  用户类型消息
2.  用户点击“提交”按钮
3.  系统灰显“提交”按钮并显示一条消息，内容为“正在发布...”
4.  当系统可以确认消息已成功存储时，系统将删除“正在发布...”文本并显示实际的新消息。

这样，用户就知道在请求完成之前不要关闭浏览器或导航离开。

* * *

或者，您可以[`onbeforeunload`](https://developer.mozilla.org/en-US/docs/DOM/window.onbeforeunload)警告您的用户在关闭浏览器或导航之前等待。工作流程类似于：

> **先决条件：**您在某处有一个持久计数器（cookie、本地存储、隐藏字段等）。当页面加载时，它从**0**开始。

1.  用户类型消息
2.  用户点击“提交”按钮
3.  发送 AJAX 请求
4.  计数器增加**1**
5.  请求完成，您得到响应（无论成功与否 - 错误处理是另一个问题），将计数器减**1**

如果在任何时候[`unload`](https://developer.mozilla.org/en/DOM/window.onunload)触发了事件，系统将检查计数器。如果大于**0**，则警告用户他们的请求尚未完成并且他们可能会丢失他们的评论 (a-la-Gmail)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-24T16:36:25.497

在大多数情况下，您对服务器执行的任何操作都将继续执行，直到服务器上运行的 PHP 尝试将结果输出回浏览器。只有在这一点上，PHP 才会检查连接是否仍然存在，并根据用户中止设置做任何应该做的事情。因此，例如，如果您想接收帖子、更新数据库条目，然后回显某种成功消息，那么只要您在查询数据库之前没有进行任何输出，数据库活动就应该继续。

POST 与 GET 在这种行为上没有区别。

# php - Can't make delete button using $_GET method

> ID：14023613
> 
> 赞同：-1
> 
> 时间：2012-12-24T16:21:45.507
> 
> 标签：php, html, html-table, http-get

I got my first study task to make a script. Task is the following: Create a webform for uploading files, after file upload they are displayed on the same page in html table. This is my very first task and my priority is just to make it work. So I created a form and function to scan upload folder for files and then put them in array. Afterwards array is used in a cucle that builds up an html table. Please help me to build correct delete button, as I just can't get it to work. My code is here:

```
<?php
if ($_GET['action']=='delete' && isset($_GET['file'])) {
        unlink($dir.$filelist[$i]);
        echo "File ".$filelist[$i]. " has been removed";
}

//table with files
echo"<table border=1 cellpading=5 cellspasing=0>
<tr><th>#</th><th>Filename</th><th>Path</th><th>File extenstion</th><TH>File Size<th>Remove file?</th></tr>";
for ($i=0; $i <count($fileslist) ; $i++) {
        echo "<tr>";
        echo"<td>$i</td><td>". $fileslist[$i]."</td>";
        echo "<td><a href=".$dir.$fileslist[$i].">".$fileslist[$i]."</a></td>";
        echo "<td>".$ext=pathinfo(($dir.$fileslist[$i]), PATHINFO_EXTENSION)."</td>";
        echo "<td>".$size= filesize_get($dir.$fileslist[$i])."</td>";
        echo "<td> <a href=\"upload.php?action=delete&file=".$filelist[$i].">Delete </a></td>";
        echo "<tr>";
}
echo"</tabe>"; 
```

Get following errors:

> Notice: Undefined index: action in D:\PHP(1)\xampp\htdocs\upload.php on line 32
> 
> Notice: Undefined variable: filelist in D:\PHP(1)\xampp\htdocs\upload.php on line 47

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-24T16:24:46.340

代替

```
echo "<td> <a href=\"upload.php?action=delete&file=".$filelist[$i].">Delete </a></td>"; 
```

经过

```
echo "<td> <a href=\"upload.php?action=delete&file=".$fileslist[$i].">Delete </a></td>"; 
```

您只是缺少文件列表中的 s

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-24T16:26:42.990

我认为您应该从字面上理解该错误消息。`$filelist`您提供的代码示例中未定义您的变量。

`$_GET['action'] == 'deleted'`此外，您的第一个错误也被抛出，因为即使该参数未通过 GET 传递，您也会尝试检查。在使用它之前，您应该始终检查参数是否存在，如下所示：

```
if (isset($_GET['action']) && $_GET['action']=='delete' && isset($_GET['file'])) { 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-24T16:49:31.737

1-当 $i 尚未定义时，您正在删除第 i 个项目

2-如上述答案所述

为防止变量和函数名称出错，您可以使用支持代码完成的文本编辑器。例如，一个可以提供帮助的非常轻量级的工具是[Geany](http://www.geany.org/Main/About)。即使在 linux 和 windows 上的大型项目中，我仍然使用它。它不会使用大量 RAM 和 CPU，也不会花时间打开。

在 AND (&&) 条件块中，条件是从左到右读取的，一旦出现不正确的情况，该块就会中断，因此您更有可能首先测试关键的东西，这样它就不会在堵塞。

# iphone - 从 bundle id 获取应用名称

> ID：14023618
> 
> 赞同：16
> 
> 时间：2012-12-24T16:22:18.897
> 
> 标签：iphone, objective-c, ios

我有来自设备上安装的应用程序的捆绑 ID 的列表，我想获取应用程序名称。解决方案应该适用于未越狱的设备。该应用程序不会进入应用程序商店，因此不会出现应用程序拒绝。

* * *

我找到了这个解决方案，如果它位于应用商店，它将返回应用的详细信息。 [http://itunes.apple.com/lookup?bundleId=com.bundle.id](http://itunes.apple.com/lookup?bundleId=com.bundle.id)

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2012-12-24T16:34:27.953

大多数时候，你可以得到这个......

```
NSString *appName = [[[NSBundle mainBundle] infoDictionary] objectForKey:(id)kCFBundleNameKey]; 
```

编辑：

AS 您想为所有应用程序查找。

```
NSString *appName = [[NSBundle bundleWithIdentifier:@"BundleIdentifier"] objectForInfoDictionaryKey:(id)kCFBundleExecutableKey];
NSLog(@"AppName: %@",appName); 
```

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2012-12-24T16:31:46.667

这应该这样做。

```
NSBundle *bundle = [NSBundle bundleWithIdentifier:@"yourBundleIdentifier"];
NSString *appName = [bundle objectForInfoDictionaryKey:@"CFBundleExecutable"]; 
```

* * *

## 方法

```
- (NSString *)titleOfAppWithBundleIdentifier:(NSString *)bundleIdentifier {
    NSBundle *bundle = [NSBundle bundleWithIdentifier:bundleIdentifier];
    return [bundle objectForInfoDictionaryKey:@"CFBundleExecutable"];
} 
```

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2015-06-11T06:35:01.277

我将捆绑字典设置如下：

```
NSDictionary *bundleInfo = [[NSBundle mainBundle] infoDictionary];

NSString *appName = [bundleInfo objectForKey:@"CFBundleDisplayName"]; 
```

这是`bundleInfo`倾倒的：

```
{
    BuildMachineOSBuild = ...;
    CFBundleDevelopmentRegion = ...;
    CFBundleDisplayName = ...;
    CFBundleExecutable = ...;
    CFBundleIcons = {
        CFBundlePrimaryIcon = {
        CFBundleIconFiles = (
            "AppIcon29x29.png",
            "AppIcon29x29@2x.png",
            "AppIcon40x40@2x.png",
            "AppIcon57x57.png",
            "AppIcon57x57@2x.png",
            "AppIcon60x60@2x.png",
            "AppIcon60x60@3x.png"
        );
        UIPrerenderedIcon = 1;
       };
    };
    CFBundleIdentifier = ...;
    CFBundleInfoDictionaryVersion = ...;
    CFBundleInfoPlistURL = ...;
    CFBundleName = ...;
    CFBundleNumericVersion = 0;
    CFBundlePackageType = APPL;
    CFBundleShortVersionString = ...;
    CFBundleSignature = "????";
    CFBundleSupportedPlatforms =     (
        iPhoneOS
    );
    CFBundleVersion = "1.0.11";
    DTCompiler = ...;
    DTPlatformBuild = ...;
    DTPlatformName = iphoneos;
    DTPlatformVersion = "8.3";
    DTSDKBuild = ...;
    DTSDKName = "iphoneos8.3";
    DTXcode = ...;
    DTXcodeBuild = ...;
    LSRequiresIPhoneOS = 1;
    MinimumOSVersion = "5.1";
    UIBackgroundModes =     (
        ...,
        ...
    );
    UIDeviceFamily =     (
        1
    );
    UILaunchImageFile = LaunchImage;
    UILaunchImages =     (
            {
            UILaunchImageMinimumOSVersion = "7.0";
            UILaunchImageName = ...;
            UILaunchImageOrientation = Portrait;
            UILaunchImageSize = "{320, 568}";
        }
    );
    UIMainStoryboardFile = Main;
    UIRequiredDeviceCapabilities =     (
        armv7
    );
    UISupportedInterfaceOrientations =     (
        UIInterfaceOrientationPortrait
    );
    UIViewControllerBasedStatusBarAppearance = 0;
} 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2014-02-26T10:23:18.880

如果您想获得本地化的包显示名称，请使用`localizedInfoDictionary`：

```
NSString *appName = [[NSBundle mainBundle] localizedInfoDictionary][@"CFBundleDisplayName"]; 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-06-20T11:25:18.547

我相信这应该会给你答案：

```
NSString *appName = [[NSBundle bundleWithIdentifier:@"BundleIdentifier"] objectForInfoDictionaryKey:@"CFBundleExecutable"]; 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2020-07-20T21:29:38.530

迅速：

```
if let bundle = Bundle(identifier: "com.my.bundleId"),
    let name = bundle.object(forInfoDictionaryKey: kCFBundleNameKey as String) {
    print(name)
} 
```

* * *

## 回答 #7

> 赞同：-3
> 
> 时间：2012-12-24T16:24:19.077

```
NSString *appName = [[bundleID componentsSeparatedByString:@"."] lastObject]; 
```

假设 bundleID 是反向 dns 格式..

# css - 如何在 CSS 选择器中添加多个 not？

> ID：14023620
> 
> 赞同：1
> 
> 时间：2012-12-24T16:22:26.587
> 
> 标签：css, css-selectors

我有以下CSS：

```
#content-button-panel ul li a.folder span {
  cursor: default;
}
#content-button-panel ul li a:not(.folder) span {
  cursor: pointer;
} 
```

和以下 HTML：

```
<a class="title-coffee"><span>Overview</span></a> 
```

我怎样才能使 HTML（具有 title-xxxxxxx 类）具有默认光标？请注意，我需要它与 title-coffee 或任何以 title- 开头的类一起使用

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-24T16:46:02.387

你为什么不像这样添加新的 CSS 类：

```
.cursor {
    cursor: default;
}
.pointer {
    cursor: pointer;
} 
```

然后在需要的地方专门使用每个类，例如：

```
<a class="coffee cursor"><span>Overview</span></a>
<a class="folder pointer"><span>Pointer</span></a> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-24T16:33:36.603

您可以使用众多[属性选择器](http://www.w3.org/TR/selectors/#attribute-selectors)之一。这个选择所有类属性以“title-”开头的元素

```
 a[class^="title-"] 
```

在你的情况下，你会像这样使用它：

```
#content-button-panel ul li a.folder span,
#content-button-panel ul li a[class^="title-"] span {
  cursor: pointer;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-24T16:32:54.417

这就是我要做的。我宁愿在每个对象上使用 ID，并根据需要专门针对它们。如果您的目标是一个类，那么指定特定项目变得更加困难，这就是我推荐这种方法的原因。

CSS：

```
.defaultCursor {
   cursor: default;
} 
```

HTML：

```
<a id="ThisItemsID" ><span>Overview</span></a> 
```

JS 代码（根据需要在任何需要应用光标的地方）：

```
$("#ThisItemsID").addClass('defaultCursor'); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-24T18:30:26.480

与 CSS 的否定可以通过~~2 种~~方式完成 1 种方式：

~~input:not(.classA, .classB) /* 就个人而言，我从未见过这个工作 */~~

或者

```
input:not([type="radio"]):not([type="checkbox"]) 
```

通常，我会建议简单地使用第三类而不是使用`:not`. 但是对于`input`某些元素在浏览器的默认样式下看起来更好的元素，编写一个包含选择器来捕获我想要设置样式的每一个类型比为*我不**想要*的类型编写一个否定选择器要长得多，我会选择较短的选择器。

 *`:not`可以像任何其他简单的选择器或伪类一样链接

```
a[class^="title-"]:not(.folder) 
```*

# javascript - Win 8 应用程序（js、html、css、winrt）滚动

> ID：14023621
> 
> 赞同：2
> 
> 时间：2012-12-24T16:23:00.750
> 
> 标签：javascript, windows-8, scroll

我正在尝试将一个简单的 webapp (html js css) 移植到 Windows 8 javascript 应用程序。原始应用程序有一个空的 html 表，我动态地向它添加行。在浏览器中，这很好，因为即使表格变大，滚动也提供导航。在 windows 8 应用程序中，表格已生成，但没有出现 scrow，

如何通过 .js 动态创建的 html 表为应用程序提供导航？

谢谢 ！

# php - 从多个表中检索数据

> ID：14023622
> 
> 赞同：-2
> 
> 时间：2012-12-24T16:23:06.557
> 
> 标签：php, mysql, select, join

我有 3 个表，想写选择结果，但我不知道如何使用 'join' 'inner' 'outer' 等，如果有人帮助我，将不胜感激。

表格：制造商/产品/产品描述

```
$manufacturer_query = "SELECT manufacturers_id from manufacturers WHERE manufacturers_name='" . $m ."'";
$manufacturer = mysql_query($manufacturer_query);
$mresult = mysql_fetch_array($manufacturer);

$products_query = "SELECT p.products_id, pd.products_description FROM products p, products_description pd WHERE p.products_id=pd.products_id AND p.manufacturers_id=" . $mresult['manufacturers_id'];
$products = mysql_query($products_query);
$presult = mysql_fetch_array($products);

$c = 0;                            
while ($presult){
$c++;
echo $c . ' - ' . $prod['p.products_id'] . ' - '.$prod['pd.products_description'].' - ' . $mresult['manufacturers_id'] . '<br>';
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-24T16:46:15.757

用 INNER JOIN 试试这个

```
 $manufacturer_query = "SELECT m.manufacturers_id , p.products_id, pd.products_description FROM manufacturers m 
                        INNER JOIN  products p  ON p.manufacturers_id= m.manufacturers_id 
                        INNER JOIN  products_description pd ON  p.products_id=pd.products_id 
                        WHERE manufacturers_name='" . $m ."'";

 $products = mysql_query($manufacturer_query);
 $presult = mysql_fetch_array($products);

 $c = 0;                            
 while ($presult){
 $c++;
 echo $c . ' - ' . $prod['p.products_id'] . ' - '.$prod['pd.products_description'].' - ' . $mresult['manufacturers_id'] . '<br>';
} 
```

**编辑**

```
 $manufacturer_query = "SELECT m.manufacturers_id mm, p.products_id pp, pd.products_description  ppd FROM manufacturers m INNER JOIN 
                 products p  ON p.manufacturers_id= m.manufacturers_id INNER JOIN 
                 products_description pd ON  p.products_id=pd.products_id  WHERE manufacturers_name='" . $m ."'";

   $products = mysql_query($manufacturer_query);

  $c = 0;                            
  while ($presult = mysql_fetch_array($products)){
 $c++;
  echo $c . ' - ' . $presult['pp'] . ' - '.$presult['ppd'].' - ' . $presult['mm'] . '<br>';
  } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-24T17:01:35.533

对于您的第二个查询 ( `$products_query`)，您已经有一个联接。

两个表名（products 和 products_description）之间的逗号是连接运算符。

这可以重写，用`JOIN`关键字替换逗号连接运算符，并将连接谓词重新定位到 ON 子句中，例如

```
SELECT p.products_id
     , pd.products_description
  FROM products p
  JOIN products_description pd
    ON pd.products_id=p.products_id
   AND p.manufacturers_id = 1 
```

这是一个“内部”连接，`p.manufacturers_id = 1`只有当表中存在（至少一个）行`products`匹配该行，并且如果 products_description 表中至少有一行具有`products_id`匹配的值时，才会返回该行从 products 表返回的一行（或多行）。

`INNER`在关键字之前添加`JOIN`关键字不会改变语句，它没有效果。

鉴于这些表格内容：

```
TABLE: products
manufacturers_id  products_id   
1                 222
1                 333
1                 444

TABLE: products_description
products_id    products_description
222            foo    
444            fee
444            fi
444            fo
444            fum 
```

该查询将返回：

```
p.products_id  pd.products_description  
222            foo    
444            fee
444            fi
444            fo
444            fum 
```

如果在`LEFT`关键字之前添加`JOIN`关键字，则查询将是一个`OUTER`联接，并且查询还将返回如下行：

```
p.products_id  pd.products_description  
333            (NULL) 
```

其中 JOIN 左侧表中的一行在右侧表中找不到匹配行。

如果您希望以特定顺序返回行，请在查询末尾包含 ORDER BY 子句，例如：

```
ORDER BY p.products_id, pd.product_description 
```

如果没有，MySQL 可以自由地以任意顺序返回行。

* * *

关键字`INNER`和`OUTER`完全是可选的。它们对语句的处理方式没有影响，这就是大多数 SQL 开发人员忽略这些关键字的原因。

A`LEFT JOIN`是一个`OUTER`连接。即使在右边的表中没有找到匹配的行，也会从左边的表中返回行。

（对于交叉连接，我们通常会包含`CROSS`关键字，即使它没有效果，只是因为它可以作为文档说明省略 ON 子句是有意的。）

* * *

对 mysql_fetch_array 的调用应该在循环中：

```
$products = mysql_query($products_query);
$c = 0;
while ($prod = mysql_fetch_array($products) ) {
    $c++;
    echo $c . ' - ' . $prod['products_id'] . ' - '.$prod['products_description'].' - ' . $mresult['manufacturers_id'] . '<br>';
} 
```

* * *

mysql_ 接口已弃用。新开发应使用 mysqli_ 或 PDO 接口。

# javascript - 添加、删除或修改子元素 - 仅限 XML、JS、JQ

> ID：14023623
> 
> 赞同：0
> 
> 时间：2012-12-24T16:23:10.707
> 
> 标签：javascript, html, xml

我了解如何使用 HttpXMLRequest 对象检索元素并将它们写入 JS 中的文档，但我似乎找不到任何详细说明如何修改它的资源，我认为问题在于我实际上并不知道该过程是什么被调用所以我无法搜索它。已经提出的很多问题都涉及到 Java、C#、C++、php，我可能可以管理这些问题 - 但我只能使用 JS（当然还有 DOM）、JQuery 以及其他一些像 Xpath 这样的问题，但只有在必要时才能使用. 可能吗？

这是一些示例 XML

```
<people>
  <person>
    <name>Bob</name>
    <age>20</age>
  </person>
  <person>
    <name>Jim</name>
  </person>
<people> 
```

我需要它做的一个例子（这显然是出于理论/学习目的）；
添加`<age>19</age>`到Jim`<person>`所在的元素。 完全删除和所有子节点。用Tom 和22完全 添加一个新的。`<name>`
`<person>``<name>`
`<person>``<name>``<age>`

我不是要求任何人为我提供完整的工作代码，这将是一件很糟糕的事情，因为我基本上没有提供我自己的代码 - 但是有人知道我在哪里可以找到一些可能详细说明它的文档我需要做什么吗？我期待像 w3schools 这样的网站能够访问它，但他们似乎完全跳过它，就像它不存在一样。

我确实对 JS/JQuery 有一些了解，但似乎缺少有关使用 XML 文件的详细信息，或者我只是不知道要查找什么。我将自己限制在 XML/JS/JQ/DOM 的原因主要是为了兼容性。

非常感谢，很抱歉无法提供任何代码:(

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-24T17:05:33.680

查看[DOMParser](https://developer.mozilla.org/en-US/docs/DOM/DOMParser)以构建 xml 文档。然后您可以使用 getElementsByTagname、createElement、createTextNode 和 appendChild。

然后[XMLSerializer](https://developer.mozilla.org/en-US/docs/XMLSerializer)将 xml 作为字符串取回。

# django-models - 在 Pinax 中自定义配置文件模型：添加 OnetoOneField 时管理员中的完整性错误

> ID：14023626
> 
> 赞同：0
> 
> 时间：2012-12-24T16:23:25.037
> 
> 标签：django-models, django-admin, pinax

我是 Pinax 和 Django 的新手。我试图通过从我插入的另一个应用程序（在本例中为 django-swingtime ：[http](http://code.google.com/p/django-swingtime/) ://code.google.com/p/django-swingtime/ ）中提取 OneToOneField 来扩展 Pinax Profile 模型。我的所有模型都显示在 django 管理界面中，但我无法添加新用户（我想在添加新配置文件的过程中这样做）。我收到以下错误：

```
IntegrityError at /admin/auth/user/add/

profiles_profile.event_type_id may not be NULL

Request Method:     POST
Request URL:    http://localhost:8000/admin/auth/user/add/
Django Version:     1.3.1
Exception Type:     IntegrityError
Exception Value:    

profiles_profile.event_type_id may not be NULL 
```

我的 Pinax 版本是 0.9a2。EventType 是 django-swingtime 的一个模型。当我尝试从 Django 管理员中的任何位置添加用户时，我收到此错误。

这是我的 Profiles/models.py （更改的行旁边有注释）

```
from django.db import models
from django.utils.translation import ugettext_lazy as _

from idios.models import ProfileBase

from swingtime.models import EventType #ADDED HERE

class Profile(ProfileBase):
    name = models.CharField(_("name"), max_length=50, null=True, blank=True)
    about = models.TextField(_("about"), null=True, blank=True)
    location = models.CharField(_("location"), max_length=40, null=True, blank=True)
    website = models.URLField(_("website"), null=True, blank=True, verify_exists=False)
    event_type = models.OneToOneField(EventType) #ADDED HERE

    def __unicode__(self):
        return "Name: %s -- %s" % (self.name, self.about) #ADDED HERE 
```

也许有人可以解释帐户、配置文件和用户之间的关系，以及哪些文件可以编辑，哪些文件不宜编辑（例如，我认为我不想更改我的 Pinax 站点包中的任何内容。 ..)，我可以取得一些进展。另外，我假设这个 idios 插件参与了这个过程，但是我找到的文档链接会加载（http://oss.eldarion.com/idios/docs/0.1/）。

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-28T11:57:07.957

I've solved my error, though I'm interested in other answers and additional information since some of this is speculation/still unclear to me. I think the error stems from Pinax accounts automatically creating a "blank" idios profile for every new user created (speculation). Since I had said every profile must have a OneToOne foreign field associated with it and had not allowed for this OneToOne field to be null, there was a problem.

This question describes some of the differences between the idios profile app, Pinax account and the standard django User accounts:

[Difference between pinax.apps.accounts, idios profiles, and django.auth.User](https://stackoverflow.com/questions/11601907/difference-between-pinax-apps-accounts-idios-profiles-and-django-auth-user)

What I did to solve this problem was using the Django's signalling capabilities to make sure that as soon as a Profile is generated, so is an instance of the foreign field. This is described here:

[https://docs.djangoproject.com/en/1.3/topics/signals/](https://docs.djangoproject.com/en/1.3/topics/signals/)

Make sure to read the bit about double signalling, since this has caused trouble for some other people:

[https://docs.djangoproject.com/en/1.3/topics/signals/#preventing-duplicate-signals](https://docs.djangoproject.com/en/1.3/topics/signals/#preventing-duplicate-signals)

The final modification to my code that got rid of the error was this. Note that besides adding signalling I also explicitly said that the OnetoOneField was allowed to be null.

```
from django.db import models
from django.utils.translation import ugettext_lazy as _
from idios.models import ProfileBase
from swingtime.models import EventType

#for signals
from django.db.models.signals import post_save
from django.dispatch import receiver

class Profile(ProfileBase):
    name = models.CharField(_("name"), max_length=50, null=True, blank=True)
    about = models.TextField(_("about"), null=True, blank=True)
    event_type = models.OneToOneField(EventType, null=True)
    def __unicode__(self):
        return "Name: %s -- %s" % (self.name, self.about)

def create_User_EventType(sender, instance, created, **kwargs):
    print "checking creation of profile"
    if created:
        print "User event type is being created"
        event_label = "%s_hours" % (instance.name)
        print "the event label is" + event_label
        EventType.objects.create(abbr=instance.name,label=event_label)

post_save.connect(create_User_EventType,sender=Profile,dispatch_uid="event_post_save_for_profile") 
```

# c# - XNA 中让玩家在屏幕上平滑绘制的最佳方法是什么？

> ID：14023630
> 
> 赞同：6
> 
> 时间：2012-12-24T16:23:34.637
> 
> 标签：c#, windows-phone-7, xna, xna-4.0, farseer

我正在开发一个 wp7 游戏，玩家在程序中画线并且球从它们身上反弹。我正在使用 XNA 和 farseer 物理。用户画一条线，然后程序将其转换为物理对象或至少是 vector2s 列表的最佳方法是什么？我已经尝试创建一个 TouchLocations 列表，但如果用户绘制的速度不是很慢，它最终会变得参差不齐，就像我附上的图片一样。有什么建议么？谢谢 [http://img829.imageshack.us/img829/3985/capturehbn.png](http://img829.imageshack.us/img829/3985/capturehbn.png)

这是一些代码：我正在使用游戏状态管理示例，这是在 HandleInput 方法中

```
foreach (TouchLocation t in input.TouchState) {
  pathManager.Update(gameTime, t.Position);
} 
```

pathManager 类管理路径类的集合，它们是可绘制的物理对象。这是 pathManager.Update

```
public void Update(GameTime gameTime, Vector2 touchPosition) {
  paths.Add(new Path(world,texture, new Vector2(5,5) ,0.1f));
  paths[paths.Count-1].Position = touchPosition;
} 
```

这正是我现在正在做的事情，我愿意为了任何事情把它扔掉。你会认为每个触摸位置都有一个 5x5 的矩形会影响性能，但使用 farseer 我没有看到任何下降，即使大部分是全屏。但是，如果线条绘制得很快，该系统根本不会创建平滑的线条。

我怀疑这有什么帮助，但这里是 Path 构造函数。

```
public Path(World world, Texture2D texture, Vector2 size, float mass) {
  this.Size = size;
  this.texture = texture;
  body = BodyFactory.CreateRectangle(world, size.X * pixelToUnit, size.Y * pixelToUnit, 1);
  body.BodyType = BodyType.Static;
  body.Restitution = 1f;
  body.Friction = 0;
  body.Friction = 10;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-26T13:37:42.427

[如何使用 XNA 画线？](https://stackoverflow.com/questions/270138/how-do-i-draw-lines-using-xna/13337365#13337365)

绘制图元的最佳方法是使用基本效果着色器。这将由硬件加速。如果您愿意，还可以为其添加纹理。

我不确定它在 WP7 上是否相同，但这至少适用于 Windows7。

# java - 如何配置 tomcat，以便我可以在本地主机上运行我的 (java) Web 应用程序

> ID：14023634
> 
> 赞同：0
> 
> 时间：2012-12-24T16:23:49.950
> 
> 标签：java, tomcat

我用 eclipse 制作了一个非常小的网络应用程序，包括

*   HomeServlet.java
*   主页.jsp
*   web.xml

只是呼应你好世界！我已经制作了自己的 build.xml 文件，并且构建成功。所以现在我有了 HomeServer.class 所在的 build 文件夹和 home.jsp 所在的 web 文件夹。

我已经下载了 Tomcat 7（并让它在 localhost:8080 上运行），我如何配置我的 server.xml 以使我可以在以下位置查看我的应用程序： localhost/app/home ？我正在运行 Windows

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-24T16:28:11.480

您不需要在 Tomcat 中配置任何内容。您应该只创建一个如下所示的目录结构，并将此目录放到Tomcat的***webapps文件夹中：***

```
myWebApp
    WEB-INF
        classes
            com
                mypackage 
                    HelloServlet.class
        web.xml (optional if the servlet uses annotations)
    home.jsp 
```

这是标准 Java EE webapp 的结构。它在每个关于 Java EE webapps 的教程和[Tomcat 的文档](http://tomcat.apache.org/tomcat-7.0-doc/appdev/deployment.html)中都有描述。

请注意，依赖 Ant、Gradle 或 Maven 来构建您的应用程序是个好主意，但 Eclipse（在其企业版中）支持 Java EE webapps，并且可以为您创建此结构并直接从 IDE 部署应用程序。

# android - Android 从图库加载图像 - 活动流程

> ID：14023635
> 
> 赞同：1
> 
> 时间：2012-12-24T16:24:11.093
> 
> 标签：android, android-intent

我有两个活动，活动 A 有一个“加载图像”按钮，应该让用户选择一个图像，但我想在另一个活动 B 上处理选择的图像。

我认为这是一个常见的场景，我应该如何处理活动流？

这就是我到目前为止所做的（我不喜欢）

> 活动 A--> 图库 --> 活动 A--> 活动 B

Activity A 的 onActivityResult() 只获取 URI 并启动 Activity B，所以重新创建 Activity 只是为了执行 5 行并被销毁（不是吗？）。我想要更干净或更直接的东西。这只是一个例子，欢迎任何事情：

```
Activity A--> Gallery --> Activity B 
```

**编辑**

那这个呢？

```
 Activity A--> Activity B--> Gallery--> Activity B 
```

这是更好的方法还是一样？我的意思是，我会获得一些东西（性能，清洁度）。

**编辑 2**

正如@Gaurav 所说，一种解决方法是使用 2 个布局而不是 2 个活动，因此无需直接处理我的问题。我必须说这应该对我有用，因为活动 A 非常薄。但是为了知识起见，我欢迎对我的问题进行“直接”回答。

**编辑 3**

最后，在同一个活动中使用两种布局是行不通的（尽管这是一个非常有吸引力的解决方案）。我的活动 B 基于 libgdx (opengl)，当不调用 onDrawFrame 时，我遇到了一些令人讨厌的死锁。因此，为了避免将来出现此类无法追踪的错误，我将分离我的活动。我要使用 Edit-1 解决方案，任何意见将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-24T16:30:26.503

我认为除了在 A 的 onActivityResult 中调用 Activity B 之外别无他法。

# mod-rewrite - 带有特殊字符的 IIRF rewriteRule 不起作用

> ID：14023641
> 
> 赞同：0
> 
> 时间：2012-12-24T16:24:38.150
> 
> 标签：mod-rewrite, iirf

我有以下链接：

[http://www.svensonart.com/index.php/nl/artists/](http://www.svensonart.com/index.php/nl/artists/)

我想用 IIRF 删除 index.php，我使用这个规则没问题：

```
RewriteRule ^/(.*)$ /index.php/$1 [I,L,QSA] 
```

但是当我有一个带有特殊字符 é è ö 的 URI 时，.. rewriterule 不起作用。所以如果我想重写这个网址： [http ://www.svensonart.com/index.php/nl/artists/view/Lindstr%C3%B6m_Bengt](http://www.svensonart.com/index.php/nl/artists/view/Lindstr%C3%B6m_Bengt)

它不工作。

有人知道为什么吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-25T09:25:51.673

没有用于防止正则表达式分组被解码的重写标志，但是有一个称为 IIRF 指令`UrlDecoding`，您可以在 INI 文件中尝试：

```
UrlDecoding Off 
```

# compiler-errors - mingw32-g++.exe：错误：CreateProcess：没有这样的文件或目录

> ID：14023644
> 
> 赞同：4
> 
> 时间：2012-12-24T16:24:49.597
> 
> 标签：compiler-errors, g++, codeblocks, mingw32

我刚刚安装了 Code::Blocks 12.11 并通过向导创建了一个控制台应用程序，默认情况下 hello world 代码就在其中。我试图编译它，但我遇到了这个构建错误：

```
-------------- Build: Release in example (compiler: GNU GCC Compiler)---------------
mingw32-g++.exe -Wall -fexceptions  -O2     -c "E:\Workspace\C++\Code Blocks\example\main.cpp" -o obj\Release\main.o
mingw32-g++.exe: error: CreateProcess: No such file or directory
Process terminated with status 1 (0 minutes, 0 seconds)
1 errors, 0 warnings (0 minutes, 0 seconds) 
```

我应该怎么做才能解决它？

# git - 为什么我的 git 历史看起来像一棵圣诞树？

> ID：14023648
> 
> 赞同：74
> 
> 时间：2012-12-24T16:25:16.590
> 
> 标签：git, git-pull

在`git log --decorate --oneline --graph`圣诞节前不久在我们的一个存储库中进行操作时，我们发现出现了以下结构（旋转以强调脆弱的节日主题）：

![编辑 git log 输出，旋转看起来像一棵圣诞树](../Images/370267012c579f639e1c0af29144a7b0.png)

提交图中的这种模式是如何产生的？

*当然，这有点愚蠢，但这里有一个有趣的点——当你在 git 历史浏览器中看到提交图中的特定模式时，通常很难看到如何解释它们。*

* * *

## 回答 #1

> 赞同：42
> 
> 时间：2012-12-24T16:25:16.590

在这种情况下，情况是`master`在存储库的一个克隆中的分支尖端有一个未推送的提交。然后`git pull`在同一个存储库中运行了很多次，在一段时间内，上游有很多新工作正在完成。（在这种情况下，它是因为一个自动化脚本而发生的，但是如果开发人员只是反复拉入一个分支以使其保持最新，而不是说，变基，也会发生同样的事情。）

当上游有新的提交时，每次拉取都会创建一个新的合并提交，因为总是有一个提交`master`不在`master`上游。

最终，这个存储库中 master 分支的历史被推送到上游，所以其他开发人员在下次从上游存储库中拉取时，会在提交图中看到这个结构突然出现。

如果您有一些具有类似结构的历史记录，并且想找出是哪个提交/开发人员导致了这个问题，您可以查看带有星号的行（基本上遵循每个合并的第一个父级），直到您到达第一个非合并提交。在图片中的情况下，那是`b275805`- 应该更早推送的提交。

这是人们经常喜欢使用的原因之一`git pull --rebase`——它让你的未推送历史保持简单。

*我的同事[马修·萨默维尔（Matthew Somerville](http://dracos.co.uk/)）发现了这一点，并弄清楚了发生了什么。*

# jdbc - CDH 4.1.1。Hive JDBC 连接

> ID：14023651
> 
> 赞同：0
> 
> 时间：2012-12-24T16:25:34.593
> 
> 标签：jdbc, hadoop, hive, cloudera

我有一个很奇怪的问题。我确实有一个免费安装了 Cloudera 管理器的 CDH 4.1.1 集群。Beeswax 工作正常，hive CLI 实用程序工作正常。

并非没有任何东西监听端口 10000（Hive JDBC 连接的默认端口）。我确实有独立的测试 CDH 4.1.1 VMWare 映像（您可以从 Cloudera 站点下载它）。有同样的情况，但是打开了 10000，我可以查询 Hive。

我做错了什么？为什么10000被关闭？我必须做什么才能让它在我的集群上工作？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-25T11:25:30.760

好的，所以 CDH 4.1.1 演示映像确实将 Hive Thrift 服务器作为服务运行。如果我们正在使用受 Cloudera manager free 控制的 CDH 集群，我们必须这样做：

转到**Cloodera 管理器免费 (CMFree)**

*服务”

服务色调1»*

填写字段：**Hive 配置安全阀**

```
<property>
<name>hive.server2.thrift.min.worker.threads</name>
<value>5</value>
</property>

<property>
<name>hive.server2.thrift.max.worker.threads</name>
<value>100</value>
</property>

<property>
<name>hive.server2.thrift.port</name>
<value>10000</value>
</property>

<property>
<name>hive.server2.thrift.bind.host</name>
<value>10.66.48.23</value>
</property>

<property>
<name>hive.server2.authentication</name>
<value>NONE</value>
</property>

<!-- TODO: add concurrency support-->
<property>
<name>hive.support.concurrency</name>
<value>false</value><!-- -should be true -->
</property>

<!-- do it later
<property>
<name>hive.zookeeper.quorum</name>
<description>Zookeeper quorum used by Hive's Table Lock Manager</description>
<value>zk1.yoyodyne.com,zk2.yoyodyne.com,zk3.yoyodyne.com</value>
</property>
--> 
```

重启服务

然后启动 hive thrift 服务器：

```
[devops@cdh-1 ~]$ sudo -u hdfs /usr/bin/hive --service hiveserver 
```

在这里你可以看到它是如何在 CentOS 上被“妖魔化”的

[http://blog.milford.io/2010/06/daemonizing-the-apache-hive-thrift-server-on-centos/](http://blog.milford.io/2010/06/daemonizing-the-apache-hive-thrift-server-on-centos/)

# python - Flask URL Route：将多个 URL 路由到同一个函数

> ID：14023664
> 
> 赞同：56
> 
> 时间：2012-12-24T16:27:03.587
> 
> 标签：python, url-routing, flask

我正在使用 Flask 0.9。

现在我想将三个 url 路由到同一个函数：

```
/item/<int:appitemid>
/item/<int:appitemid>/ 
/item/<int:appitemid>/<anything can be here> 
```

该`<anything can be here>`部分永远不会在函数中使用。

我必须复制相同的函数两次才能实现这个目标：

```
@app.route('/item/<int:appitemid>/')
def show_item(appitemid):

@app.route('/item/<int:appitemid>/<path:anythingcanbehere>')
def show_item(appitemid, anythingcanbehere): 
```

会有更好的解决方案吗？

* * *

## 回答 #1

> 赞同：116
> 
> 时间：2012-12-24T16:32:31.703

为什么不直接使用可能为空的参数，默认值为`None`?

```
@app.route('/item/<int:appitemid>/')
@app.route('/item/<int:appitemid>/<path:anythingcanbehere>')
def show_item(appitemid, anythingcanbehere=None): 
```

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2012-12-24T16:33:17.430

是的 - 您使用以下构造：

```
@app.route('/item/<int:appitemid>/<path:path>')
@app.route('/item/<int:appitemid>', defaults={'path': ''}) 
```

[请参阅http://flask.pocoo.org/snippets/57/](http://flask.pocoo.org/snippets/57/)上的片段

# ios - Google Analytics v2 iOS - session duration always 0.0

> ID：14023668
> 
> 赞同：1
> 
> 时间：2012-12-24T16:27:47.943
> 
> 标签：ios, session, google-analytics

I started using Goole Analytics v2.0beta3 for iOS native app. I start a session with the following code:

```
[GAI sharedInstance].trackUncaughtExceptions = YES;
[GAI sharedInstance].dispatchInterval = 20;
[GAI sharedInstance].debug = YES;
id<GAITracker> tracker = [[GAI sharedInstance] trackerWithTrackingId:@"UA-XXXX-X"];
[GAI sharedInstance].defaultTracker = tracker; 
[tracker setAnonymize:YES];
BOOL res = [tracker trackEventWithCategory:@"cat" withAction:@"act" withLabel:@"label" withValue:[NSNumber numberWithInt:1]];
[[GAI sharedInstance] dispatch]; 
```

However, I don't know how to end the session and the session duration I get is always 0.0

Has anyone encountered this issue ?

Thanks

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-28T22:32:23.993

我会检查您的跟踪器是否设置正确。我的设置代码如下

```
[GAI sharedInstance].debug = YES;
[GAI sharedInstance].dispatchInterval = 20;
[GAI sharedInstance].trackUncaughtExceptions = YES;
self.tracker = [[GAI sharedInstance] trackerWithTrackingId:kTrackingId];
NSLog(@"what is tracker %@ / default tracker %@?", self.tracker, [GAI sharedInstance].defaultTracker); 
```

self.tracker 在哪里`@property (strong, nonatomic) id <GAITracker> tracker;`

我得到了正确的会话跟踪信息。也许尝试提取代码，直到找到导致问题的原因？

此外，解决方法可能是这样的。

```
- (void)applicationDidBecomeActive:(UIApplication *)application
{
    appBecameActive = [NSDate date];
}

- (void)applicationDidEnterBackground:(UIApplication *)application
{
    NSDate *appClosing = [NSDate date];
    NSTimeInterval sessionLength = [appClosing timeIntervalSinceDate:appBecameActive];
    [[GAI sharedInstance].defaultTracker trackTimingWithCategory:@"sessionLength"
                                                   withValue:sessionLength
                                                    withName:@"appWentToBackground"
                                                   withLabel:nil];
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-11-12T08:10:01.407

根据 Google Analytics v3，会话行为发生了变化。如果您在使用最新版本时遇到这些问题，请在此处查看我的修复：

[https://stackoverflow.com/a/26882024/1485701](https://stackoverflow.com/a/26882024/1485701)

# css - Safari中的绝对定位搞砸了

> ID：14023677
> 
> 赞同：2
> 
> 时间：2012-12-24T16:28:56.867
> 
> 标签：css, safari

我试图用 jQuery 做一个鼠标悬停淡入淡出效果。这个想法是让两个图像以这种方式相互叠加。

```
<img class="img-circle webdesign " src="assets/img/webdesign_.png" style="position: absolute;" >
<img class="img-circle" src="assets/img/webdesign_hover.png"> 
```

它适用于 Chrome。截图（[http://cl.ly/image/0f3M0f2q1t2S](http://cl.ly/image/0f3M0f2q1t2S)）

但是，我在使用 Safari 时遇到了这个问题（[http://cl.ly/image/44290O3n1X0b](http://cl.ly/image/44290O3n1X0b)）

即使页面加载时您可以看到这两个图像，灰度图像应该出现在彩色图像的顶部并隐藏后者。

建议？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2017-02-18T23:13:16.827

对于具有绝对定位的元素，我也遇到了一些问题（仅限 Safari）。我通过指定左右属性解决了这个问题：

```
.element{
  position:absolute;
  left:0;
  right:0;
}
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-24T16:35:11.083

HTML

```
<img class="img-circle webdesign " src="assets/img/webdesign_.png">
<img class="img-circle" src="assets/img/webdesign_hover.png" style='display:none;'> 
```

JS

```
$('.img-circle').mouseenter(function() {
    $('.img-circle').toggle();
}); 
```

CSS

```
.img-circle {
    position: absolute;
    top: ???;
    left: ???;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2022-02-11T00:21:32.420

在类似的挑战中，这对我有用：

```
position: absolute;
top: 8px;
margin-left: 14px; 
```

# java - 您会推荐哪种 Java 框架用于 NLP 和决策制定？

> ID：14023685
> 
> 赞同：0
> 
> 时间：2012-12-24T16:30:05.043
> 
> 标签：java, machine-learning, nlp, artificial-intelligence

> **可能重复：**
> [有没有好的自然语言处理库](https://stackoverflow.com/questions/870460/is-there-a-good-natural-language-processing-library)

我正在开始一个爱好项目，其目标是创建一个待办事项应用程序，该应用程序将使用某种形式的人工智能来提供建议并帮助计划时间。

由于我是 AI 领域的初学者，我希望您能指出一些资源或 Java 库（该应用程序将是 Java Web 应用程序）来帮助我入门。

一些可能的情况是

*   寻找具有一些共同性质的任务并提出将它们分组的建议
*   试图分类首先完成哪些“种类”的项目
*   即使没有明确提及，也能识别人员或任务

我知道我需要了解该领域的一些文献，但目前我迷失了搜索此信息的最佳主题（决策制定？NLP？ML？）

非常感谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-24T16:32:26.307

你可以试试这个框架：斯坦福自然语言处理小组的斯坦福 CoreNLP。更多信息[在这里](http://nlp.stanford.edu/software/corenlp.shtml)。它受 GNU 许可，您可以在该链接上找到更多信息

# sql - 连接四个表从左表获取数据

> ID：14023687
> 
> 赞同：0
> 
> 时间：2012-12-24T16:30:41.573
> 
> 标签：sql

我将
`Table1 (profileName,asset status,asset_Name,BaseName)`
`Table 2(TITLE,Role etc)`Title 链接到 table1 并使用配置文件名称
`Table 3(Base_Name,Role_Id)`Base 链接到 table1 并使用 BaseName
`Table 4(Role ID,Rolename)`角色 ID 链接到 table3 并使用 Role_Id)

现在我想从表 1 中获取 Role 的数据库。例如

```
Table 1
Test-POD    AVAILABLE FOR SERVICE   XYLENE          Test-Base
Test-N      AVAILABLE FOR SERVICE   X1              Test-Base
Test-N      AVAILABLE FOR SERVICE   X1              Test-Base
Test-N      AVAILABLE FOR SERVICE   X1              Test-Base
Test-POD    UNAVAILABLE FOR SERVICE XYLENE          Test-Base
Test-POD    UNAVAILABLE FOR SERVICE XYLENE          Test-Base
Test-POD    UNAVAILABLE FOR SERVICE XYLENE          Test-Base 
```

表2（有Test-POD的数据）

```
Test-POD    Role1   
Test-POD    Role2 
```

表 3（具有 Test-N 的角色 ID）

```
Test-Base    95D90BD1-6A31-4CB7-895A-1CDF3FBA428D(Uid)
Test-Base    95D90BD1-6A31-4CB7-895A-1CDF3FBA428D
Test-Base    95D90BD1-6A31-4CB7-895A-1CDF3FBA428D 
```

表4

```
Test-Role           95D90BD1-6A31-4CB7-895A-1CDF3FBA428D
Test-Role-POD1      DCFA3F6B-066E-4C1E-858C-652520B9BABD
Test-Role-POD       EF3E9A85-E709-4CD4-8F04-8570B3CBC2CC 
```

想要根据选择的角色进行过滤。尝试下面的查询

```
 SELECT 
      distinct(COUNT(Exception.asset_status)) AS CountOfasset_status1, 
      Exception.asset_name, Exception.asset_description
    FROM 
      (((dbo.SATV_REP_EXCEPTION Exception 
      Left outer Join dbo.SATV_PROCEDURE_ROLE Proc_Role ON 
       (Exception.profile_name = Proc_Role.TITLE and 
       Proc_Role.ROLE_NAME='Test-Role-POD1'))
     Left Outer Join dbo.SATV_COR_SCHEDULE_OCCURRENCE Sch_Occ on 
       Sch_Occ.BASE_NAME=Exception.BASE_NAME)
     Left outer Join dbo.SATT_ROLES Roles ON 
       (Roles.ROLE_PK=Sch_Occ.ROLE_FK and 
       Roles.ROLE_NAME='Test-Role-POD1'))
    WHERE 
      (Exception.ITEM_DATE > GETDATE() - 90) AND 
      (Exception.asset_status <> 'IN SERVICE') 
      AND Exception.BASE_NAME='Test-Base' 
      --AND (Proc_Role.ROLE_NAME='Test-Role-POD1' or Roles.ROLE_NAME='Test-Role-POD1')
    GROUP BY 
      Exception.asset_name, Exception.asset_description,
      ITEM_DATE 
    HAVING 
      (Exception.asset_name IS NOT NULL) AND 
      (asset_name <> '') 
      AND (COUNT(Exception.asset_status) > 2) 
    ORDER BY 
      CountOfasset_status1 DESC 
```

任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-24T16:52:02.163

不确定您要做什么，但您可能想要：

```
(COUNT(distinct e.asset_status) > 2) 
```

这会给你带来问题：

```
GROUP BY 
    e.asset_name, 
    e.asset_description,
    ITEM_DATE 

SELECT 
    DISTINCT(COUNT(e.asset_status)) AS CountOfasset_status1, 
    e.asset_name, 
    e.asset_description 
```

您需要在您的`select`条款中包含 item_date 或将其从您的`group by`条款中删除

对不起，我给你的表起了别名：

```
FROM 
    (((dbo.SATV_REP_EXCEPTION e 
    LEFT OUTER JOIN dbo.SATV_PROCEDURE_ROLE p ON 
        (e.profile_name = p.TITLE AND 
        p.ROLE_NAME='Test-Role-POD1'))
    LEFT OUTER JOIN dbo.SATV_COR_SCHEDULE_OCCURRENCE o ON 
        o.BASE_NAME=e.BASE_NAME)
    LEFT OUTER JOIN dbo.SATT_ROLES r ON 
        (r.ROLE_PK=Sch_Occ.ROLE_FK AND 
        r.ROLE_NAME='Test-Role-POD1')) 
```

还有，这个东西：

```
HAVING 
    (e.asset_name IS NOT NULL) AND 
    (asset_name <> '')  AND 
```

可以进入您的`where`子句，因为没有执行聚合函数

# xml - Excel office xml - 获取单元格的行和列数字索引？

> ID：14023689
> 
> 赞同：1
> 
> 时间：2012-12-24T16:30:45.740
> 
> 标签：xml, excel, ms-office

例如，在 Excel Office XML 中，Cell 对象具有 CellReference 属性，该属性返回格式为“A5”的字符串。

但是有没有一种好方法可以将 Cell 的行和列作为 NUMERIC 值？在本例中，RowIndex 为 5，ColumnIndex 为 1。

是的，它们可以从 CellReference 中解析出来，但是对于大型文档（40,000 行以上），处理数值会更有效。

# c - 检查并加载内核模块

> ID：14023690
> 
> 赞同：1
> 
> 时间：2012-12-24T16:30:47.430
> 
> 标签：c, linux-kernel, linux-device-driver, kernel-module, kernel

> **可能重复：**
> [modinfo() 等效 INSIDE 内核？](https://stackoverflow.com/questions/4881581/modinfo-equivalent-inside-kernel)

我需要检查是否在 e1000 网络驱动程序中加载了特定模块（ abc.ko ）。如果 abc.ko 未加载，则必须加载。我们如何在驱动程序代码中实现这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-24T16:38:14.177

您可以`lsmod`用于检查加载的模组，以及`modinfo e1000`更多的驱动程序信息。要**加载**模块，请使用`modprobe (module)`和 for **unload** `modprobe -r (module)`

# jquery - 使用 DataTable 单击单个列的头部时对多列进行排序

> ID：14023694
> 
> 赞同：1
> 
> 时间：2012-12-24T16:31:35.300
> 
> 标签：jquery, sorting, datatable, numbers

我正在尝试使用 jQuery 的 DataTable 插件（最新版本）对 2 列进行排序。有了这个，就可以加载了。

```
 $('#example').dataTable( {
     "aaSorting": [ [2,'asc'], [3,'asc'] ],
}); 
```

我在点击时对 2 列进行排序几乎没有困难。例如，当用户单击“专辑”时，该表未对 TrackNo 列进行排序。我的表如下所示：

```
-------------------------------------
| Album             | TrackNo       |
-------------------------------------
| MyAlbum 2010      | 1 out of 12   |
| MyAlbum 2010      | 9 out of 12   |
| MyAlbum 2010      | 10 out of 12  |
| MyAlbum 2010      | 4 out of 12   |
| MyAlbum 2010      | 2 out of 12   |
| MyAlbum 2010      | 12 out of 12  |
------------------------------------- 
```

另一个问题是当我对“专辑”列进行排序时，TrackNo 列按以下顺序排序：1、10、12、2、4、9。

我注意到可以通过以下方式更改 DataTable 对事物进行排序的方式：

```
jQuery.fn.dataTableExt.oSort['numericstring-case-asc']  = function(x,y) {
    return ((x < y) ? -1 : ((x > y) ?  1 : 0));
};

jQuery.fn.dataTableExt.oSort['numericstring-case-desc'] = function(x,y) {
    return ((x < y) ?  1 : ((x > y) ? -1 : 0));
}; 
```

我的问题是：如何对 TrackNo 列进行排序，以便它以良好的顺序显示曲目，而不在每个曲目前面添加零？以及如何在点击时对 2 列进行排序？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-24T16:48:10.917

使用以下代码创建满足您要求的 dataTableExt oSort 方法：

```
jQuery.extend(jQuery.fn.dataTableExt.oSort, {
    "hybrid-asc": function(x, y) {
        if (!isNaN(parseInt(x)) && !isNaN(parseInt(y))) {
            x = parseInt(x);
            y = parseInt(y);
        }
        return ((x < y) ? -1 : ((x > y) ? 1 : 0));
    },
    "hybrid-desc": function(x, y) {
        if (!isNaN(parseInt(x)) && !isNaN(parseInt(y))) {
            x = parseInt(x);
            y = parseInt(y);
        }
        return ((x < y) ? 1 : ((x > y) ? -1 : 0));
    }
}); 
```

要控制一个具有两列的 dataTable 列，请禁用第一列的排序功能并在表头添加一个类

HTML：`<th class="sortAlbum">Album</th>`

运行如下脚本初始化dataTable，设置排序方式，禁用第一列排序，点击第一列标题对第二列排序

JS：

```
$(document).ready(function() {
    var dataTableEx = $('#example').dataTable({
        "aaSorting": [[1, 'asc']],
        "aoColumns": [
            {
            "bSortable": false},
        {
            "bSortable": true,
            "sType": "hybrid"}]
    });

    dataTableEx.fnSortListener($('.sortAlbum'), 1);
});​ 
```

[现场演示](http://jsfiddle.net/YDf4Y/show/)| [来源](http://jsfiddle.net/YDf4Y/)

# c++ - 如何设置 Clang 以使用 MinGW libstdc++

> ID：14023696
> 
> 赞同：8
> 
> 时间：2012-12-24T16:31:44.217
> 
> 标签：c++, clang

我一直在尝试在 Windows 上设置 Clang。到目前为止，我在 Visual Studio 和 CMake 的构建中幸存下来，还有其他一些惊喜。但事实证明，Clang 没有自带 C++ stdlib 实现，所以我决定使用为 MinGW 构建的 GCC 4.7.0 的 libstdc++。

首先，我将搜索路径添加到我的 HeaderSearchOptions。

```
headeropts->AddPath(path, clang::frontend::IncludeDirGroup::CXXSystem, true, false, false); 
```

该路径正是标题所在的位置 - 我从 Windows 资源管理器中复制并粘贴了它（然后将反斜杠加倍以进行转义）。但是 Clang 仍然坚持它找不到`<iostream>`，即使一个名为的文件`iostream`恰好存在于`path`.

为什么 Clang 找不到我的标头，我还需要做什么才能使用 libstdc++？

这是我的代码

```
llvm::LLVMContext c;
llvm::Module m("", c);

clang::CompilerInstance ci;

clang::FileSystemOptions fso;

clang::FileManager fm(fso);

std::string errors;
llvm::raw_string_ostream error_stream(errors);
clang::DiagnosticOptions diagopts;
clang::TextDiagnosticPrinter printer(error_stream, &diagopts);
llvm::IntrusiveRefCntPtr<clang::DiagnosticIDs> diagids(new clang::DiagnosticIDs);
clang::DiagnosticsEngine engine(diagids, &diagopts, &printer, false);

clang::SourceManager sm(engine, fm);

clang::LangOptions langopts;
langopts.CPlusPlus = true;
langopts.CPlusPlus0x = true;

clang::TargetOptions target;
target.Triple = llvm::sys::getDefaultTargetTriple();
auto targetinfo = clang::TargetInfo::CreateTargetInfo(engine, &target);

auto headeropts = llvm::IntrusiveRefCntPtr<clang::HeaderSearchOptions>(new clang::HeaderSearchOptions());
headeropts->AddPath("D:\\Backups\\unsorted\\x86_64-w64-mingw32-gcc-4.7.0-release-win64_rubenvb\\mingw64\\include\\c++\\4.7.0",clang::frontend::IncludeDirGroup::CXXSystem, true, false, false);
headeropts->UseStandardCXXIncludes = true;
headeropts->UseStandardSystemIncludes = true;
clang::HeaderSearch hs(headeropts, fm, engine, langopts, targetinfo);

auto x = llvm::IntrusiveRefCntPtr<clang::PreprocessorOptions>(new clang::PreprocessorOptions());
clang::Preprocessor p(x, engine, langopts, targetinfo, sm, hs, ci);

clang::ASTContext astcon(langopts, sm, targetinfo, p.getIdentifierTable(), p.getSelectorTable(), p.getBuiltinInfo(), 1000);
CodeGenConsumer consumer;
clang::CodeGen::CodeGenModule codegen(astcon, clang::CodeGenOptions(), m, llvm::DataLayout(&m), engine);
consumer.mod = &codegen;
clang::Sema sema(p, astcon, consumer, clang::TranslationUnitKind::TU_Complete);

sm.createMainFileID(fm.getFile("main.cpp"));
engine.getClient()->BeginSourceFile(langopts, &p);
clang::ParseAST(sema); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-27T17:37:46.557

不使用前端时`clang::InitializePreprocessor`需要手动调用。`clang::BuiltinContext::InitializeBuiltins`

此外，三元组必须将“MinGW32”命名为供应商。如果您命名为“MinGW”，那么 Clang 将默默地无法意识到您希望所述兼容性并产生无用的目标文件。

# php - php奇怪的文件扩展名错误

> ID：14023698
> 
> 赞同：-1
> 
> 时间：2012-12-24T16:32:00.753
> 
> 标签：php

不太清楚发生了什么。好的，所以基本上脚本在“if”函数中，并将当前图像扩展名与正在加载到页面中的文件进行比较

```
if ( $row['file_type'] == 'jpg' && 'jpeg' && 'png' && 'gif') {  

    $img = "obj.php?id=".base64_encode($row['file_path'])."&mode;thumb";

} else {

   $img = "assets/filesystem/file_extension_".$row['file_type'].".png";

} 
```

如果我将“&&”替换为“或”，它适用于 JPG、PNG、JPEG 和 GIF，但在 else 语句中失败，并且不适用于所有其他文件类型，因此不会通过 file_extension_docx.png 返回 docx

关于为什么会发生这种情况的任何线索？因为如果我将它保持在“&&”，它运行 $img 并返回所有 JPEG/JPG 文件的缩略图，但不是 PNG 和 GIF，它们从资产返回为 file_extension_png.png 或 file_extension_gif.png，而不是作为图像缩略图返回通过 obj.php 文件

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-24T16:41:10.007

问题是`$row['file_type'] == 'jpg' && 'jpeg' && 'png' && 'gif'`评估为...

```
$row['file_type'] contains 'jpg'
AND 'jpeg' is a non empty string
AND 'png' is a non empty string
AND 'gif' is a non empty string 
```

您实际上并没有针对每个字符串检查变量的值。

如果您想检查是否`$row['file_type']`包含这些值之一......您可以使用该`in_array()`函数，例如：

```
if (in_array($row['file_type'], array('jpeg', 'jpg', 'png', 'gif'))) {
  // ...
} else {
  // ...
} 
```

或者你可以明确地做到这一点

```
if ($row['file_type'] == 'jpg' || $row['file_type'] == 'jpeg' || $row['file_type'] == 'png'  || $row['file_type'] == 'gif') {
  // ...
} else {
  // ...
} 
```

我希望这有帮助。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-24T16:35:29.707

```
if ( $row['file_type'] == 'jpg' && 'jpeg' && 'png' && 'gif') 
```

替换为

```
if ( $row['file_type'] == 'jpg' || $row['file_type'] ==  'jpeg' || $row['file_type'] ==  'png' || $row['file_type'] ==  'gif') 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-12-24T16:37:33.310

只是一个建议，你也可以使用 switch case，更容易。

```
switch($row['file_type']){

case 'jpg':
case 'jpeg':
case 'png':
case 'gif':
// put your if codes here

break;

// put your else code under default
default: 

break;

} 
```

# java - 如何从表中返回“缺失”的行 - 员工缺勤报告

> ID：14023709
> 
> 赞同：-2
> 
> 时间：2012-12-24T16:33:10.813
> 
> 标签：java, mysql, sql

我有两张桌子，像这样：

```
master
---------
empcode    INT PRIMARY KEY
name       VARCHAR
dept       VARCHAR 

emp_tx
----------
empcode    INT        references MASTER(empcode)
s_date     DATETIME 
```

该`emp_tx`表记录了员工“进”和“出”的交易。该列`s_date`存储“in”或“out”事件发生的时间（作为 DATETIME 值）。交易记录从办公区域（通过指纹生物识别系统）。

**emp_tX 表中的示例数据：**

```
 empcode   s_datetime
    -------   ------------------    
    1110      2012-12-12 09:31:42  (employee in  time to the office)
    1110      2012-12-12 13:34:17  (employee out time for lunch)
    1110      2012-12-12 14:00:17  (employee in  time after lunch)
    1110      2012-12-12 18:00:12  (employee out time after working hours)
    1112
    etc. 
```

**注意：**`emp_tx`如果员工在给定日期不在办公室，则不会在该日期的事务表中 插入任何行。员工在给定日期缺勤将由该员工和该日期的“缺失”行指示。

谁能帮我获取一个返回员工缺勤日期的 SQL 查询，以生成员工缺勤报告？

查询的输入将是两个 DATE 值，一个“开始”日期和一个“结束”日期，它指定日期范围。查询应该返回所有出现的“缺席”（或者，当在“从”和“到”日期之间的任何日期在`EMP_TX`表中没有找到任何行时，不出现而不是，非出现。`empcode`

**预期输出：**

如果我们输入“2012-12-12”作为“开始”日期，“2012-12-20”作为“结束”日期，查询应该返回如下行：

```
Empcode  EmpName  Department  AbsentDate  TotalNoofAbsent days
-------  -------  ----------  ----------- --------------------
1110     ABC      Accounts    2012-12-12
1110     ABC      Accounts    2012-12-14                     2   
1112     xyz      Software    2012-12-19
1112     xyz      Software    2012-12-17                     2 
```

我试过这个查询，我确信它没有返回我想要的行：

```
select tx.date from Emp_TX as tx where Date(S_Date) not between '2012-12-23' and '2012-12-30' 
```

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-24T18:12:10.907

如果“缺席”被定义为在特定日期（日期=午夜到午夜 24 小时期间）的`emp_tx`特定表中没有出现一行，并且...`empcode`

如果在该日期的表中没有交易的日期不显示“缺席”是可以接受的`emp_tx`（即排除该日期所有 empcode 都缺席的日期），那么...

您可以使用如下查询获取指定结果集的前四列：（未经测试）

```
SELECT m.empcode     AS `EmpCode` 
     , m.name        AS `EmpName`
     , m.dept        AS `Department`
     , d.dt          AS `AbsentDate`
  FROM ( SELECT DATE(t.s_date) AS dt
           FROM emp_tx t
          WHERE t.s_date >= '2012-12-12' 
            AND t.s_date < DATE_ADD( '2012-12-20' ,INTERVAL 1 DAY)
          GROUP BY DATE(t.s_date)
          ORDER BY DATE(t.s_date)
       ) d
 CROSS
  JOIN master m
  LEFT
  JOIN emp_tx p
    ON p.s_date >= d.dt
   AND p.s_date <  d.dt + INTERVAL 1 DAY
   AND p.empcode = m.empcode
 WHERE p.empcode IS NULL
 ORDER
    BY m.empcode
     , d.dt 
```

* * *

在同一个结果集中返回第五列`TotalNoofAbsent`是可能的，但它会使查询变得非常混乱。在处理返回的结果集时，这个细节可能会在客户端更有效地处理。

* * *

**查询的工作原理**

别名为 as 的内联视图为`d`我们提供了一组我们正在检查的“日期”值。使用`emp_tx`表格作为这些“日期”值的来源是一种方便的方法。不是`DATE()`函数只返回 DATETIME 参数的“日期”部分；我们使用 a`GROUP BY`来获取不同的日期列表（即没有重复值）。（通过这个内联视图查询，我们所追求的是作为参数传入的两个值之间的一组不同的 DATE 值。还有其他更复杂的生成 DATE 值列表的方法。）

只要您将视为“缺席”的每个“日期”值都出现在表中的某处（即，`empcode`每个感兴趣的日期至少有一个交易），并且只要该`emp_tx`表并不过分，则内联视图查询将运行得相当好。

（注意：内联视图中的查询可以单独运行，以验证结果是否正确且符合我们的预期。）

下一步是从内联视图中获取结果并执行`CROSS JOIN`操作（以生成笛卡尔积）以匹配 EVERY`empcode`与`date`从内联视图返回的 EVERY。这个操作的结果代表了每一个可能出现的“出席”。

`LEFT JOIN`查询的最后一步是使用 a和`WHERE IS NULL`谓词执行“反连接”操作。（`LEFT JOIN`外连接）返回每个可能的出勤事件（从左侧），包括那些没有从`emp_tx`表中匹配的行（出勤记录）。

“技巧”是包含一个谓词（在 WHERE 子句中），该谓词丢弃找到匹配出勤记录的所有行，这样我们剩下的就是所有`empcode`和`date`（可能的出勤事件）的组合，其中没有匹配出勤事务。

（注意：我故意在谓词中保留对 s_date (DATETIME) 列的引用，并使用范围谓词。这将允许 MySQL 有效地使用包含该列的适当索引。）

如果我们将列引用包装在函数 eg 的谓词中`DATE(p.s_date)`，那么 MySQL 将无法有效地使用`s_date`列上的索引。

* * *

正如其中一条评论（关于您的问题）指出的那样，我们不会对将员工标记为“进来”或“出去”的交易进行任何区分。我们只是在给定的 24 小时“午夜到午夜”期间寻找该 empcode 的交易的存在。

* * *

还有其他方法可以获得相同的结果集，但“反连接”模式通常会在大集合中提供最佳性能。

为了获得最佳性能，您可能需要覆盖索引：

```
... ON master (empcode, name, dept)

... ON emp_tx (s_date, empcode) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-24T17:03:03.093

不幸的是，您的查询会给您带来大量结果......它总是会返回您提供的范围之外的员工的所有日期。您想检查日期之间是否存在记录。

可以在纯 SQL 中执行此操作...如果不使用游标或特定于 DB 的东西，我想不出一种方法。此 Java 伪代码将为您提供 1 名员工的缺勤：

```
List<Date> findAbsences(int empCode, Date inDate, Date outDate) {

    List<Date> result = new LinkedList<Date>();

    Calendar c = new Calendar();
    c.setTime(new Date(2012,12,12));

    while (!c.getTime().after(outDate)) {
        // run query for EMP_TX records between inDate & outDate
        //SELECT 1 FROM EMP_TX WHERE EmpCode = :empid AND S_Date BETWEEN :in AND :out;

        if (!query.hasNext()) {
            result.add(c.getTime);
        }

        c.add(Calendar.DATE, 1);
    }

} 
```

# scala - Scala，扩展具有通用特征的对象

> ID：14023712
> 
> 赞同：7
> 
> 时间：2012-12-24T16:33:25.113
> 
> 标签：scala, singleton, extend, type-mismatch, traits

我正在使用 Scala，我想扩展一个具有特征的（单例）对象，它提供数据结构和一些方法，如下所示：

```
trait Tray[T] {
  val tray = ListBuffer.empty[T]

  def add[T] (t: T) = tray += t
  def get[T]: List[T] = tray.toList
} 
```

然后我想将特征混合到一个对象中，如下所示：

```
object Test with Tray[Int] 
```

`add`但是和中存在类型不匹配`get`：

```
Test.add(1)
// ... 
```

我怎样才能让它工作？或者我的错误是什么？

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2012-12-24T16:54:28.333

问题是您正在使用 and 方法隐藏 trait 的`T`类型`add`参数`get`。[有关该问题](https://stackoverflow.com/a/13830404/334519)的更多详细信息，请参见我的答案。

这是正确的代码：

```
trait Tray[T] {
  val tray = ListBuffer.empty[T]

  def add (t: T) = tray += t      // add[T] --> add
  def get: List[T] = tray.toList  // get[T] --> add
}

object Test extends Tray[Int] 
```

请注意在对象定义中的使用- 请参阅[规范](http://www.scala-lang.org/docu/files/ScalaReference.pdf)`extends`的第 5.4 节以解释为什么单独在这里不起作用。`with`

# c# - 在调试版本中使用垃圾收集奇怪触发的奇怪错误

> ID：14023721
> 
> 赞同：3
> 
> 时间：2012-12-24T16:35:20.387
> 
> 标签：c#, .net, debugging, garbage-collection

我正在编写垃圾收集测试，并偶然发现了在调试模式下发生的一组奇怪的错误。这是一个提炼的 POC 代码。有 20 个 lambda 的列表和对它们的弱引用列表。我访问第 13 个 lambda（调用 .ToString()），然后清除列表。然后强制垃圾收集并分析哪些元素在清理过程中幸存下来。

```
 public void TestGC_WTF() {
        var handlers = new List<Action>();
        var weakReferences = new List<WeakReference>();

        int testValue = 0;
        for (int i = 0; i < 20; i++) {
            int number = i;
            Action handler = () => testValue += number;
            handlers.Add(handler);
            weakReferences.Add(new WeakReference(handler));
            handler = null;
        }

        handlers[13].ToString();

        handlers.Clear();

        GC.Collect();

        if (false) { } //This is required for the bug to occur.

        var aliveReferences = Enumerable.Range(0, weakReferences.Count).Where(i => weakReferences[i].IsAlive).ToArray();
        Console.WriteLine("Uncollected handlers: {0}", string.Join(",", aliveReferences));
    } 
```

在调试模式下，此代码将打印（“未收集的处理程序：13,19”。我对此结果的问题如下：

1.  未收集第 19 个元素（即使我在每次循环迭代结束时将句柄变量显式设置为 null）
2.  未收集第 13 个元素（即使我从未将其存储在任何地方）
3.  `if (false) { }`（或任何其他循环/条件）对于触发错误至关重要。

是什么导致出现问题？（我知道在调试中，对象被保留到定义它们的块的末尾。仅此一点仍然不能解释我遇到的任何问题。）

我已将错误提交给 Microsoft，但我对问题的原因更感兴趣[https://connect.microsoft.com/VisualStudio/feedback/details/775082/strangely-triggered-strange-bugs-with-garbage -collection-in-debug-builds](https://connect.microsoft.com/VisualStudio/feedback/details/775082/strangely-triggered-strange-bugs-with-garbage-collection-in-debug-builds)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-24T18:58:36.307

这是特定于 x86 抖动的。是的，这看起来像一个错误，抖动将堆栈帧上的临时存储位置标记为有效的对象引用。与 [ebp-74h] 一样，存储处理程序 [13] 引用的插槽和 [ebp-68h] 保留对处理程序 [19] 的引用。这些临时变量在 x86 代码中很常见，因为 cpu 寄存器的数量很少，而且当优化器被禁用时，抖动在寻找对少数寄存器的良好使用方面所花费的精力很少。

您可以在 connect.microsoft.com 提交反馈报告。然而，他们修复它的可能性非常小，当优化器被禁用时，抖动没有义务使其工作。局部变量的生命周期被延长到方法的末尾，以便于调试。对于声明的局部变量以及抖动分配的临时变量为真。当然，这最终无关紧要，您只会将发布版本发布给您的客户。当优化的发布版本也出现垃圾时，请随时提出这个问题，这不利于 GC 的有效性。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-24T16:41:48.543

我不相信`GC.Collect()`一定会收集所有可能的垃圾，只需要付出努力。在调试版本中，优化有利于保持引用活动，因为您更有可能希望使用调试器检查它们。我在这里看不到任何我称之为错误的行为。

# mongodb - MongoDB 按计数排序获取文档

> ID：14023724
> 
> 赞同：5
> 
> 时间：2012-12-24T16:35:40.567
> 
> 标签：mongodb

我有一个带有子文档的文档，它看起来像：

```
{ 
    "name" : "some name1" 
    "like" : [      
            {  "date" : ISODate("2012-11-30T19:00:00Z") },
            {  "date" : ISODate("2012-12-02T19:00:00Z") },     
            {  "date" : ISODate("2012-12-01T19:00:00Z") },
            {  "date" : ISODate("2012-12-03T19:00:00Z") } 
    ]       
} 
```

是否可以获取“最喜欢”的文档（过去 7 天的平均值）并按计数排序？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-12-24T18:31:24.203

有几种不同的方法可以解决这个问题。我将重点介绍的解决方案使用 mongodb 的聚合框架。首先，这是一个可以解决您的问题的聚合管道，接下来将解释/分解命令中发生的事情。

```
db.testagg.aggregate( 
    { $unwind : '$likes' }, 
    { $group : {  _id : '$_id', numlikes : { $sum : 1 }}}, 
    { $sort : { 'numlikes' : 1}}) 
```

该管道有 3 个主要命令：

1) 展开：这会拆分“喜欢”字段，以便每个文档有 1 个“喜欢”元素

2) 组：这使用 _id 字段重新组合文档，为找到的每个文档增加 numLikes 字段。这将导致 numLikes 被填充为等于之前“喜欢”中的元素数量的数字

3）排序：最后，我们根据numLikes对返回值进行升序排序。在测试中，我运行此命令的输出是：

```
{"result" : [
    {
        "_id" : 1,
        "numlikes" : 1
    },
    {
        "_id" : 2,
        "numlikes" : 2
    },
    {
        "_id" : 3,
        "numlikes" : 3
    },
    {
        "_id" : 4,
        "numlikes" : 4
    }.... 
```

这适用于通过以下方式插入的数据：

```
for (var i=0; i < 100; i++) {
    db.testagg.insert({_id : i})
    for (var j=0; j < i; j++) {
        db.testagg.update({_id : i}, {'$push' : {'likes' : j}})
    }
} 
```

请注意，这并不能完全回答您的问题，因为它避免了选择日期范围的问题，但希望它能让您开始并朝着正确的方向前进。

当然，还有其他方法可以解决这个问题。一种解决方案可能是只在客户端进行所有排序和操作。这只是获取所需信息的一种方法。

编辑：如果你觉得这有点乏味，有一张票可以将 $size 运算符添加到聚合框架中，如果你有兴趣，我邀请你观看并可能投票支持它以尝试加速添加这个新的运算符。

[https://jira.mongodb.org/browse/SERVER-4899](https://jira.mongodb.org/browse/SERVER-4899)

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-12-24T18:31:53.090

更好的解决方案是保留一个计数字段来记录该文档的点赞数。虽然您可以使用聚合来执行此操作，但性能可能不是很好。在计数字段上有一个索引将使读取操作快速，并且您可以在插入新的喜欢时使用原子操作来增加计数器。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2016-12-29T16:55:10.977

从 mongodb v3.4 开始，您可以使用以下方法简化上述聚合查询：

```
> db.test.aggregate([
    { $unwind: "$like" },
    { $sortByCount: "$_id" }
 ]).pretty()

{ "_id" : ObjectId("5864edbfa4d3847e80147698"), "count" : 4 } 
```

同样正如@ACE所说，您现在可以在投影中使用 $size ：

```
db.test.aggregate([
    { $project: { count: { $size : "$like" } } }
]);

{ "_id" : ObjectId("5864edbfa4d3847e80147698"), "count" : 4 } 
```

# apache - Comet 服务器和 apache 的端口号

> ID：14023727
> 
> 赞同：0
> 
> 时间：2012-12-24T16:36:02.720
> 
> 标签：apache, port, comet

我渴望为 php / js 设置一个彗星服务器。我将在 Apache 旁边使用 nginx。在这样做时，我相信我需要为 Apache 打开一个端口，为我的彗星服务器打开另一个端口。我听说他们可以通过“反向代理”和“代理通行证”这样的魔法来共享一个端口。这些话让我心生恐惧。我认为最简单的方法是为每个端口设置一个端口。这是明智的吗？

如果我确实有两个端口，显然我会为 Apache 使用 80/443，但是我的评论服务器呢？我选择什么端口有关系吗？8080 和 8888 或 10101 一样好还是坏？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-02T18:49:28.767

只要谨慎选择要使用的端口号（没有冲突的端口等），就不必担心。真正的问题是处理跨域请求。由于端口在技术上位于另一台服务器上，因此我们面临跨域请求的问题。所以使用不同的端口号并不是一个很好的解决方案。

事实证明反向代理并不像我想象的那么可怕，我只是在 htaccess 中添加了以下几行：

```
ProxyRequests Off
ProxyPass /comet http://localhost:8888
ProxyPassReverse /comet  http://localhost:8888 
```

8888 是我使用的端口。然后我向 /comet 而不是端口 8888 发出了所有请求。

# android - 当 xml “膨胀”时，幕后会发生什么？

> ID：14023729
> 
> 赞同：1
> 
> 时间：2012-12-24T16:36:13.140
> 
> 标签：android, android-inflate

例如当我们编写代码时

`View view = inflater.inflate(R.layout.main_activity, null);`

安卓系统是做什么的？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-24T17:42:35.247

查看源代码`LayoutInflater`。它是一个抽象类，其具体实例是通过`getLayoutInflater()`.

本质上，inflater 创建一个根视图对象（被膨胀的 XML 的根视图组），然后通过 XML 树进行两次传递以附加每个子视图。这是递归完成的，以处理“包含”并修复子视图之间的引用，例如 in `RelativeLayout`，并且从上到下完成。

第一遍通过实例化每个子视图来构造树，自上而下递归，并将 XML 属性传递给视图构造函数，告诉视图它应该有多大。然后，它`measure()`使用度量规范对象调用由父级确定的限制（例如，具有 2 个子视图的相对布局，每个子视图都请求 match_parent）并询问视图它想要多大的限制。如果视图本身是一个视图组，它将使用相同的算法来测量它的子视图。

第二个传递是布局传递，当`layout()`每个子级调用以将其自身定位在视图中时。父级使用在测量过程中计算的测量值定位视图。 `onDraw()`被调用并传递一个从`DecorView`支持位图创建的画布。

完成的树然后准备传递给由`setContentView()`或完成的窗口管理器`addContentView()`。

[http://grepcode.com/file/repository.grepcode.com/java/ext/com.google.android/android/4.1.1_r1/android/view/LayoutInflater.java#LayoutInflater](http://grepcode.com/file/repository.grepcode.com/java/ext/com.google.android/android/4.1.1_r1/android/view/LayoutInflater.java#LayoutInflater)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-24T16:48:56.803

用简单的语言扩展 XML 布局意味着您正在转换`XML`in `View`. 然后，您可以使用父视图/膨胀视图获取在 XML 中声明的每个视图。

例如 -

```
View view = inflater.inflate(R.layout.main_activity, null); 
```

现在，这里`view`是 XML 的引用，您可以从中获取所有视图：

```
TextView tv = (TextView)view.findViewById(R.id.tv); 
```

# android - Wi-FI Direct 教程 - PeerListListener 去哪里了？

> ID：14023734
> 
> 赞同：1
> 
> 时间：2012-12-24T16:36:31.160
> 
> 标签：android, broadcastreceiver, wifi-direct, peer

使用本教程：http: [//developer.android.com/training/connect-devices-wireless/wifi-direct.html#fetch](http://developer.android.com/training/connect-devices-wirelessly/wifi-direct.html#fetch)

我已经成功地获得了教程中的这部分代码：

```
 private List peers = new ArrayList();
...

private PeerListListener peerListListener = new PeerListListener() {
    @Override
    public void onPeersAvailable(WifiP2pDeviceList peerList) {

        // Out with the old, in with the new.
        peers.clear();
        peers.addAll(peerList.getDeviceList());

        // If an AdapterView is backed by this data, notify it
        // of the change.  For instance, if you have a ListView of available
        // peers, trigger an update.
        ((WiFiPeerListAdapter) getListAdapter()).notifyDataSetChanged();
        if (peers.size() == 0) {
            Log.d(WiFiDirectActivity.TAG, "No devices found");
            return;
        }
    }
} 
```

我现在不确定将获取对等列表的代码放在哪里。它是在我的广播接收器中，还是在 wifi 活动本身中？在哪里？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-24T16:50:20.400

如果继续该示例，您可以看到在您发布的代码中创建的对象 ( `peerListListener`) 已在`onReceive()`方法中使用。似乎他们搞砸了并将其重命名为`peerListener`那里。

# jquery - jquery中的定时器

> ID：14023735
> 
> 赞同：-2
> 
> 时间：2012-12-24T16:36:45.107
> 
> 标签：jquery, ruby-on-rails

我正在使用 Rails 开发一个测验应用程序。有些测试是定时的。一旦时间用完，我需要能够强制候选人提交测试。你如何做到这一点？刷新页面会重置计时器吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-24T16:40:12.847

### 一些建议

1.  不允许用户刷新网站。
2.  从服务器获取结束时间或从服务器获取持续时间。
3.  使用 jQuery 计时器，请参见[此处](http://code.google.com/p/jquery-timer/)、[此处](http://archive.plugins.jquery.com/project/timers)等，并从服务器端提供。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-24T16:48:05.650

在我们的测试软件中，我们在数据库中为显示的问题保留了“开始时间”。

*   当问题页面刷新时，我们从数据库中提取开始时间并显示`Time.now- start_time`，倒数。所以没有时间浪费。
*   当用户尝试移动到另一个问题时，我们检查开始时间和分配的时间并将用户移回正确的问题。

# c# - 列表的返回类型

> ID：14023739
> 
> 赞同：10
> 
> 时间：2012-12-24T16:37:22.750
> 
> 标签：c#, linq, anonymous-types

嗨，我需要找到一种方法来为方法声明匿名类型。这是我的代码：

```
public List<var> ListOfProducts(string subcategory)
{
    var products = (from p in dataContext.Products
                    join s in dataContext.SubCategories.Where(x => x.SubCatName == subcategory)
                        on p.SubcatId equals s.SubCatId
                    join b in dataContext.Brands on p.BrandId equals b.BrandId
                    select new
                    {
                        Subcategory = s.SubCatName,
                        Brand = b.BrandName,
                        p.ProductName,
                        p.ProductPrice
                    });
    return products;
} 
```

我不知道我应该为方法设置什么类型的列表。在这种情况下我该怎么办？

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2012-12-24T16:39:02.157

你不能`Anonymous Type`从一个方法返回一个。

只需为您的类型创建一个类并返回它。

```
public class Product
{
    string Subcategory { get; set; }
    string Brand { get; set; }
    string ProductName { get; set; }
    decimal ProductPrice { get; set; }
} 
```

然后像这样返回：

```
var products = (from p in dataContext.Products
                    join s in dataContext.SubCategories.Where(x => x.SubCatName == subcategory) on p.SubcatId
                        equals s.SubCatId
                    join b in dataContext.Brands on p.BrandId equals b.BrandId
                    select new Product
                               {
                                   Subcategory = s.SubCatName,
                                   Brand = b.BrandName,
                                   p.ProductName,
                                   p.ProductPrice
                               });

    return products; 
```

`object`编辑：为了澄清我的第一个陈述，正如@JamesMichaelHare 指出的那样，从技术上讲，可以通过返回or从方法返回匿名类型`dynamic`，但这可能比它的价值更麻烦，因为你必须使用`Reflection`或其他方式访问对象的属性。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2012-12-24T16:40:21.040

根据 MSDN，动态类型允许其发生的操作绕过编译时类型检查。相反，这些操作是在运行时解决的。

所以试试这个：

```
public IEnumerable<dynamic> ListOfProducts(string subcategory) 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-12-24T16:42:37.230

我要说的是，您应该为此定义另一个模型，如果您将返回的结果用于表示层，您应该定义 ViewModel，或者如果您用于分发层，您可以定义为 Dto 对象

```
public class ProductDto
{
    public string Subcategory {get; set; }
    public string Brand { get; set; }
    public string ProductName{ get; set; }
    public decimal ProductPrice{ get; set; }
} 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-12-24T18:42:25.797

请注意：匿名类型旨在用于方法（或函数）的范围内，而不是在它之外。

但是有一种方法可以通过一些扩展方法和一些额外的铸件来做到这一点（我不喜欢这样）：

（在您的代码中，您也应该将 .ToList() 添加到您的 LINQ 表达式中。）

扩展方法有：

```
static List<T> InitList<T>(this T o) { return new List<T>(); }
static T CastToThis<T>(this  T target, object o) { return (T)o; } 
```

您可以通过以下方式初始化匿名类型列表：

```
var list = new { Name = "Name", Age = 40 }.InitList(); 
```

现在使用以下方法将方法的返回对象转换为该列表的类型：

```
list = list.CastToThis(returnedValueOfYourMethod); 
```

还有一件事：匿名类型仅在程序集中有效，不能跨程序集边界传递。从[这里](http://blogs.msdn.com/b/ericlippert/archive/2012/01/23/anonymous-types-unify-within-an-assembly.aspx)：

*C# 规范向您保证，当您在一个程序集中的两个位置使用“相同”匿名类型时，这些类型会统一为一种类型。为了“相同”，两个匿名类型必须以完全相同的顺序具有完全相同的成员名称和完全相同的成员类型。*

总而言之，我不明白你为什么需要这样做，因为声明一个新类型要实用得多，如果你真的需要这个，你应该研究 C# 中的动态类型，如果你要做一些更神奇的事情，你应该使用反射。

# asp.net - ASP.NET SQL Server 会话状态极慢

> ID：14023740
> 
> 赞同：4
> 
> 时间：2012-12-24T16:37:24.380
> 
> 标签：asp.net, sql-server, sql-server-express, sql-session-state

我的 ASP.NET 应用程序出现问题，我需要网络农场，但是仅登录到我的应用程序大约需要 15 秒

我做了一个小实验，创建了我的应用程序的非网络农场版本，然后改用 INPROC 会话状态，登录时间是即时的。在这个测试实例中，我在同一台机器上运行 SQL Express。

我知道 SQL Server 上的会话状态较慢，但它不可能这么慢。关于如何追踪问题的任何建议？

这是我的会话状态：

```
<sessionState mode="SQLServer" timeout="60" sqlConnectionString="Data Source=localhost;Integrated Security=SSPI;" sqlCommandTimeout="30" cookieless="false" useHostingIdentity="False" regenerateExpiredSessionId="True" /> 
```

我已经尝试过使用用户名密码以及集成安全性。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-14T15:32:17.187

关系数据库是原子的 (ACID)，因此当每个人都在访问同一张表 (ASPStateTempSessions) 时，性能会很差。

我们遇到了与使用 SessionState 模式相同的问题，我们在负载均衡器上启动了 ASPNet 状态服务并使用了它。更好的吞吐量。

```
<sessionState mode="StateServer" stateConnectionString="tcpip=localhost:42424" cookieless="false" timeout="60" /> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2020-10-17T18:43:51.217

您可以做的最好的事情（如果您的应用程序允许）是完全避免会话存储后端。如果会话数据适合 HTTP 标头本身（通常是这样），您可以对其进行编码并与请求本身作为 cookie 来回移动。

另外，会话状态提供程序的大多数实现都是“阻塞”的，因此您不能对同一会话有并发请求，从而成为一个巨大的瓶颈。

本文指向一个基于 JWT 的插入式会话状态提供程序：

[http://www.drupalonwindows.com/en/content/aspnet-session-state-scaling-and-performance-issues](http://www.drupalonwindows.com/en/content/aspnet-session-state-scaling-and-performance-issues)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-04-04T13:20:26.540

您的问题涉及广泛的领域-

1.  **代码**：您在会话中推送的内容非常重要。如果您要存储大型 blob 等，则每次存储会话数据并从数据库中读取时都会发生序列化/反序列化。你能解析存储的数据并尝试找出平均大小吗？我已经看到业务应用程序在 sql server 上存储 1mb 到 2mb 的数据，连接了数千个用户，但是底层硬件足以支持吞吐量。
2.  **基础设施**：你的机器上有多少内存？您可以尝试在您的 aspstate 数据库上运行 sql trace 以查看有多少连接进入以及执行查询需要多长时间？问题可能不在数据库端，可能是您的应用程序在存储会话信息时尝试做某事。

SQL Server 会话存储并没有这么慢，在我的机器上有 8gig ram 和通过 Visual Studio (IIS Express) 运行的 asp.net 应用程序，连接和启动应用程序只需要一秒钟。

# java - 如何更快地从 URL 读取纯 html 文件？

> ID：14023748
> 
> 赞同：-2
> 
> 时间：2012-12-24T16:38:44.347
> 
> 标签：java, html, performance, file, http

我需要“阅读”很多 URL 略有不同的链接，以便进一步解析。使用此代码：

```
 String charset = "UTF-8";
    System.setProperty("java.net.useSystemProxies", "false");
    //System.out.println(http);
    //System.out.println(html);
    URL pageToRead = new URL(http);

    URLConnection yc = pageToRead.openConnection();
    yc.setRequestProperty("Accept-Charset", charset);
    BufferedReader in = new BufferedReader(new InputStreamReader(
            yc.getInputStream()));

    String inputLine;
    FileWriter fstream = new FileWriter(html);
    BufferedWriter out = new BufferedWriter(fstream);

    while ((inputLine = in.readLine()) != null) {
        out.write(inputLine);
    }

    in.close();
    out.close(); 
```

关于变量的注意事项：`http`是带有完整 URL 的字符串。`html`是带有完整文件名的字符串。

**两个问题：**

1.  如何更改此代码以更快地读取 URL？
2.  也许我错了，问题出在http服务器上。也许它只是不能更快地给我页面。如何检查？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-24T17:40:46.277

您通常在读取 html（代理等）时有较高的延迟。然而，一个体面的网络服务器可以同时处理大量请求。

为了获得更高的吞吐量，您应该**同时**执行多个 http 读取（使用线程池）。

根据使用的服务器，您的吞吐量将增加 10..20 倍（还取决于您的客户端操作系统是否不受连接数限制）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-24T16:42:21.263

您可以通过执行以下操作来计时您的代码并找出每个方法执行所需的时间：

```
long startTime = System.nanoTime();
methodToTime();
long endTime = System.nanoTime();

long duration = endTime - startTime; 
```

然后在某处打印出来。

资料来源：[如何在 Java 中计时方法的执行？](https://stackoverflow.com/questions/180158/how-do-i-time-a-methods-execution-in-java)

# c#-4.0 - C# 从类库中的类访问 WinForms 项目中的类

> ID：14023750
> 
> 赞同：1
> 
> 时间：2012-12-24T16:38:50.370
> 
> 标签：c#-4.0

我在一个解决方案中有两个 c# 项目。

第一个项目是一个`winforms`有多个类的项目，名为`QuantumGUI`. 第二个项目是一个`class library`有多个类的项目，名为`QuantumDAL`.

我的目标是从 QuantumDAL 中的一个类访问和设置 QuantumGUI 类或 Form.cs 中的变量。我尝试在我的 QuantumDAL 项目中添加对 QuantumGUI 的引用，但收到以下错误：`“A Reference to ‘QuantumGUI’ could not be added. Adding the project as a reference would cause a circular dependency”.`
我收到了类似的错误消息，尝试添加项目依赖项。当您考虑它时，错误消息是有道理的。我尝试过其他的，我认为可能的方法，但结果是空的。我相信必须有一个聪明的方法来完成这件事。
如果我以错误的方式处理这个问题，有没有办法让两个项目中的代码都可以访问一个“全局”类？感谢您花时间看这个。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-24T18:00:58.510

There are two problems with what you're trying to do:

First, as the IDE is warning you, you're about to create a circular dependency. This means that the compiler would need to build project A before it can build project B, but it would need to build project B before it can build project A. Neither project can go "first".

The second problem is that your WinForms project is most likely an executable, and you cannot add references to `*.exe` files via the IDE. You can add those references via the command-line, but the fact that Visual Studio is trying to stop you from doing it should be a red flag that it's a really bad idea.

The correct way to do what you want is to refactor the common classes into a third class library that you reference from both other projects. If needed, you can wire up events (in particular, look at the [`INotifyPropertyChanged`](http://msdn.microsoft.com/en-us/library/ms133020.aspx) interface and its event) that notify interested observer objects when things change.

# javascript - 服务的角度动态属性

> ID：14023752
> 
> 赞同：1
> 
> 时间：2012-12-24T16:39:10.677
> 
> 标签：javascript, angularjs

给定以下 angularjs 服务：

```
angular.module('myApp.services', [])
  .factory('EmployeesService', ['$http', function ($http) {
      return {
          name: 'Employees Service',
          getByTerm: function (term, callback) {
              $http.get('Services/GetEmployess?term='+term).success(function (data) {
                  callback(data);
              });
          }
      };
  } ]); 
```

如何将 $http.get URL 设置为动态而不是硬编码？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-24T17:10:06.073

不确定你想要动态的 url 的哪一部分，所以如果你想让 "term=" + term 部分是动态的：

```
angular.module('myApp.services', [])
    .factory('EmployeesService', ['$http', function ($http) {
        return {
        name: 'Employees Service',
        getByTerm: function (params, callback) {
                var terms = [];

                //params example: {param1: "lorem", param2:"ipsum"}
                for(var key in params){
                    if(params.hasOwnProperty(key)){
                        terms.push(key + "=" + params[key]);
                    }
                }
                //terms now looks like this: ["param1=lorem", "param2=ipsum"]

                var url = 'Services/GetEmployess?' + terms.join("&");

                //url will look lik this: 'Services/GetEmployess?param1=lorem&param1=ipsum';

                $http.get(url).success(function (data) {
                    callback(data);
                });
            }
        };
    } ]); 
```

如果您希望您发布的实际网址是动态的，请将其作为另一个参数传递：

```
angular.module('myApp.services', [])
  .factory('EmployeesService', ['$http', function ($http) {
      return {
          name: 'Employees Service',
          getByTerm: function (url, term, callback) {
              $http.get(url+term).success(function (data) {
                  callback(data);
              });
          }
      };
  } ]); 
```

如果这些都不是您要查找的内容...您能否详细说明您想要动态的 url 的哪一部分？

# c++ - 在 AIX 中启动 C++ 可执行文件时出错

> ID：14023754
> 
> 赞同：2
> 
> 时间：2012-12-24T16:39:53.850
> 
> 标签：c++, aix

作为我们从 HP 到 AIX 的应用程序迁移的一部分，我面临着一个独特的问题。以下模拟代码在 HP 和 AIX 中产生不同的结果。

**图书馆.C ********

 **```
 #include <stdio.h>
    #include "mylib.h"

    int libimgclientFNXXX()
    {
       int check = 100;
       check = FileNetDeleteDoc(check);
       return check;
    }

    int libimgclientFN()
    {
       int check = 1;
       printf("In lib ");
       return check;
    } 
```

******* main_func.C *********

 **```
 #include <stdio.h>

    int libimgclientFN();
    int libimgclientFNXXX();

    int main()
    {
       int one = 0;
       if (1 == 1)
       {
            one = libimgclientFN();
       }
       printf("\n The status is %d \n", one);
    } 
```

******* mylib.h ********

 **```
 extern int FileNetDeleteDoc (int); 
```

请注意，函数 libimgclientFNXXX() 永远不会被调用。我的make文件如下：

```
xlC -c -g library.C -o library.o -I./
xlC -G -qmkshrobj  -o  libImgClient.so library.o
xlC -c -g  -qpic=small main_func.C -o main_func.o
xlC -brtl main_func.o -L. -lImgClient -o TST 
```

当我运行 TST 时，我收到以下加载错误

```
$ TST
exec(): 0509-036 Cannot load program TST because of the following errors:
rtld: 0712-001 Symbol FileNetDeleteDoc__Fi was referenced
      from module ./libImgClient.so(), but a runtime definition
      of the symbol was not found. 
```

即使从未调用函数 libimgclientFNXXX()，也存在未解决的错误。

惠普内置的完全相同的代码可以正常工作，没有错误。

任何输入表示赞赏。

谢谢，

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-24T16:46:34.353

是的，“不使用”库函数可能仍然是一个错误，即使您不打算调用代码。它可能会将某些组件的加载推迟到以后，因此它可能不会导致错误。最好不要引用不存在的东西（或者手动加载库并获取地址，如果函数不存在，你会从“查找函数”调用中得到一个错误，你可以做点什么在代码中是明智的）。

加载器（加载二进制可执行文件的代码）不是很聪明，所以它不能确切地知道什么被调用，什么不是。也有可能不同的编译器对“删除死代码”有不同程度的聪明，所以一个编译器完全删除了“从未调用”的函数，但另一个编译器没有删除它[因为它没有 100% 证明的聪明你永远不会调用这个函数——例如，在 gcc 中，如果你创建了`libimgclientFNXXX`一个静态函数，它会知道这一点——因为它知道静态函数不会在这个模块之外被调用，并且这个模块没有使用它。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-24T16:48:56.267

AIX 要求在加载时解析所有符号，因此即使构建正常，因为引用了符号，应用程序也不会运行。

您需要对.so （链接选项）使用[延迟链接](http://pic.dhe.ibm.com/infocenter/aix/v6r1/index.jsp?topic=%2Fcom.ibm.aix.genprogc%2Fdoc%2Fgenprogc%2Flazyload.htm)`-blazy`，这应该会导致丢失的函数仅在首次使用时链接。

但是，您确实不应该在库中留下未定义的符号 - 如果它需要来自另一个库的符号，您应该链接到它们（除非它是一个插件，符号在应用程序本身中公开）。******

# javascript - jQuery AJAX 发送两个请求

> ID：14023755
> 
> 赞同：4
> 
> 时间：2012-12-24T16:40:06.473
> 
> 标签：javascript, jquery, ajax

jQuery AJAX 似乎发送了两个请求。由于我使用的是双因素身份验证方法，因此基于时间，第二个请求失败，因此原始请求“失败”。

第一个是 post 请求，这很好，但是有一个 GET 请求，这不好。

这是我用来生成查询的 javascript。

```
$('#form').live('submit', function(event) {
    var target = $('#ajax');
    var url = '/ajax/user/authenticateLevel3';
    $.ajax({
        type: "POST",
        url: url,
        data: $('#form').serialize(),
        dataType: 'json',
        success: function(data, status) {
            $.getJSON(url, function(data) {

                if (!data.resultCode) {
                $('#ajax').html($.base64.decode(data.html));
                $('#ajax').modal();
                } else {
                    location.reload();
                }

            });
        }
    });
    event.preventDefault();
}); 
```

有什么想法可以解决这个问题吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-24T16:43:49.027

那是因为您正在进行 2 次 ajax 调用（`.ajax`和`.getJSON`）

尝试这样做（使用文档事件委托而不是`.live`）：

```
$(document).on('submit', '#form', function(event) {
    var target = $('#ajax');
    var url = '/ajax/user/authenticateLevel3';
    $.ajax({
        type: "POST",
        url: url,
        data: $('#form').serialize(),
        dataType: 'json',
        success: function(data, status) {
            if (!data.resultCode) {
                $('#ajax').html($.base64.decode(data.html));
                $('#ajax').modal();
            } else {
                location.reload();
            }
        }
    });
    event.preventDefault();
}); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-24T16:50:44.090

您正在发送 2 个请求。一个使用 .ajax，另一个使用 .getJson。

删除 .getJson 请求。如果没有传递给 .ajax 的 dataType 属性，jquery 将尝试猜测响应类型。您还可以将 dataType 指定为 json 以强制转换。成功回调的“数据”参数应转换为这两个选项的 javascript 对象。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-24T16:46:17.483

[`getJSON`](http://api.jquery.com/jQuery.getJSON)是一种用于从服务器检索 JSON 的 AJAX 方法，而不是用于处理由另一个 ajax 方法返回的数据。只需将其删除。

```
$('#form').live('submit', function(event) {
    var target = $('#ajax');
    var url = '/ajax/user/authenticateLevel3';
    $.ajax({
        type: "POST",
        url: url,
        data: $('#form').serialize(),
        dataType: 'json',
        success: function(data, status) {
            if (!data.resultCode) {
            $('#ajax').html($.base64.decode(data.html));
            $('#ajax').modal();
            } else {
                location.reload();
            }
        }
    });
    event.preventDefault();
}); 
```

既然你提到你正在切换到[`.on`](http://api.jquery.com/on)，语法将是这样的：

```
$(parent).on('submit', '#form', function(event) {
    /*
     * ...
     */
}); 
```

其中`parent`是最近的静态父元素`#form`。

# python - 如何在测试时对 Django 模型中的装饰器进行猴子修补？

> ID：14023763
> 
> 赞同：1
> 
> 时间：2012-12-24T16:40:39.887
> 
> 标签：python, django, testing, monkeypatching

我的模型中有一个`@memoize`装饰器，它缓存了模型本身的一些细节，以避免在多次调用时（尤其是在模板中）多次调用数据库。但是，由于我存储对象并在测试中引用它们，这会破坏事情。

例如，如果我`mygroup.subscribers`添加了一个订阅者并重试，它将返回错误的订阅者数量，因为它已被记忆。

我怎样才能在我的tests.py中对那个装饰器进行猴子补丁以不做任何事情？我还没有找到一种干净的方法，因为模型首先被加载。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-24T16:52:44.987

在实施开始时，根据此[答案](https://stackoverflow.com/questions/6957016/detect-django-testing-mode)`memoize`检查它是否处于测试模式：

```
from django.core import mail

# at the beginning of your memoize
if hasattr(mail, 'outbox'):
    # return without memorizing 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-19T07:26:35.590

[您可以在测试](https://docs.djangoproject.com/en/dev/topics/testing/advanced/#topics-testing-test-runner)运行器中禁用您的装饰器，测试环境将在加载模型之前设置。

例如：

```
from django.test.simple import DjangoTestSuiteRunner
from utils import decorators

class PatchTestSuiteRunner(DjangoTestSuiteRunner):
    def setup_test_environment(self, **kwargs):
        super(PatchTestSuiteRunner, self).setup_test_environment(**kwargs)
        self.__orig_memoize = decorators.memoize
        decorators.memoize = lambda x: x

    def teardown_test_environment(self, **kwargs):
        decorators.memoize = self.__orig_memoize
        super(PatchTestSuiteRunner, self).teardown_test_environment(**kwargs) 
```

然后放入你的`settings.py`：

```
TEST_RUNNER = 'test.PatchTestSuiteRunner' 
```

并且测试可以在没有记忆的情况下运行：

```
# myapp/models.py
class TestObject(object):
    def __init__(self, value):
        self.value = value

    @memoize
    def get_value(self):
        return self.value

# myapp/test.py
from django.test import TestCase
from .models import TestObject

class NoMemoizeTestCase(TestCase):
    def test_memoize(self):
        t = TestObject(0)
        self.assertEqual(t.get_value(), 0)
        t.value = 1
        self.assertEqual(t.get_value(), 1) 
```

请注意，尽管我们正在恢复测试运行器中的原始装饰器，但`teardown_test_environment`不会在已装饰的函数上恢复记忆。如果我们使用更复杂的测试装饰器，可以恢复记忆，但这在标准用例中可能不是必需的。

# javascript - 如何在 THREE.js 中获取相机的方向

> ID：14023764
> 
> 赞同：8
> 
> 时间：2012-12-24T16:40:41.517
> 
> 标签：javascript, html, three.js, web-audio-api

我正在使用 THREE.JS 和 Web Audio API 创建一个 3d 游戏。我遇到的问题之一是我想使用网络音频侦听器方向，并将侦听器定义为摄像机，其位置和方向不断更新

我的问题是，是否可以轻松获得三个相机的矢量方向？

我试图通过使用旧相机位置来计算它，并使用速度矢量来计算它面对的方向，但是当相机静止时这将不起作用......

通过使用 camera.rotation.x, camera.rotation.y, camera.rotation.z 创建单位向量是否可行？

还是有更简单的方法？

非常感谢您的宝贵时间！

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-12-24T18:50:16.723

您想知道相机正在寻找的世界空间中的方向。

在*相机空间*中，相机位于*原点*并向下看它的负 z 轴。

在相机空间中选择相机前面的一个点：

```
var pLocal = new THREE.Vector3( 0, 0, -1 ); 
```

现在将该点转换为世界空间：

```
var pWorld = pLocal.applyMatrix4( camera.matrixWorld ); 
```

您现在可以构造所需的方向向量：

```
var dir = pWorld.sub( camera.position ).normalize(); 
```

编辑：更新为three.js r.57

编辑：另请参阅：[three.js 设置和读取相机外观矢量](https://stackoverflow.com/questions/15696963/three-js-set-and-read-camera-look-vector/15697227#15697227)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-12-04T04:16:15.303

在修订版 69 中（不确定它是在哪个修订版中引入的），您可以调用

```
camera.getWorldDirection() 
```

获取相机方向向量。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2015-02-10T10:28:39.950

如果您的相机是玩家对象的子对象，例如在 FPS 游戏中。对玩家（相机的父级）进行相同的计算，并使用它（Bullit 获得正确的方向，在本例中来自 obj）

```
Bullit.prototype.getDirection=function(obj){
this.position.add(obj.position);
var pLocal = new THREE.Vector3( 0, 0, -1 );
var pWorld = pLocal.applyMatrix4( obj.matrixWorld );
var dir = pWorld.sub( obj.position ).normalize();
this.direction=dir; 
```

}

# javascript - 所以 DOM scrollIntoView 上下对齐，但是左/右呢？

> ID：14023765
> 
> 赞同：16
> 
> 时间：2012-12-24T16:40:53.657
> 
> 标签：javascript, html, dom, horizontal-scrolling

我想水平滚动给定的元素。我发现的唯一方法是使用 ScrollIntoView DOM 方法，该方法允许将元素的底部与视图底部或顶部对齐 - 与视图顶部对齐。

但是如果元素相对于 Y 轴没问题，我只想水平滚动它怎么办？如何将其左侧与左侧视图对齐或将其右侧与右侧视图对齐？

**编辑**

这里有更多的上下文。我有一个带有水平滚动条的 YUI 表。我希望以编程方式将其滚动到某个 TD 节点。我认为`window.scrollTo`对我没有任何帮助，因为滚动条位于 div 元素上，而不是整个页面上。

**编辑2**

原来有一个正确答案的重复 SO 问题 -[如何以编程方式滚动带有自己的滚动条的 div？](https://stackoverflow.com/questions/10634898/how-can-i-scroll-programmatically-a-div-with-its-own-scrollbars)

投票关闭我的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2017-08-01T13:40:03.480

我最近遇到了一个表头问题，该表头将输入作为每列的过滤器。通过过滤器切换焦点会移动焦点，但如果其中一个输入不可见或部分可见，它只会将输入显示在视图中，并且我被要求将完整的输入和列显示在视图中。然后我被要求在向左向后移动时也这样做。

这个链接帮助我开始：[http ://www.webdeveloper.com/forum/showthread.php?197612-scrollIntoView-horizo​​ntal](http://www.webdeveloper.com/forum/showthread.php?197612-scrollIntoView-horizontal)

简短的回答是您要使用：

```
document.getElementById('myElement').scrollLeft = 50; 
```

或者：

```
$('#myElement')[0].scrollLeft = 50; 
```

这是我的解决方案（对于这个问题可能有点矫枉过正，但也许会对某人有所帮助）：

```
// I used $.on() because the table was re-created every time the data was refreshed
// #tableWrapper is the div that limits the size of the viewable table
// don't ask me why I had to move the head head AND the body, they were in 2 different tables & divs, I didn't make the page

$('#someParentDiv').on('focus', '#tableWrapper input', function () {
    var tableWidth = $('#tableWrapper')[0].offsetWidth;
    var cellOffset = $(this).parent()[0].offsetLeft;
    var cellWidth = $(this).parent()[0].offsetWidth;
    var cellTotalOffset = cellOffset + cellWidth;

        // if cell is cut off on the right
    if (cellTotalOffset > tableWidth) {
        var difference = cellTotalOffset - tableWidth;
        $('#tableWrapper').find('.dataTables_scrollHead')[0].scrollLeft = difference;
        $('#tableWrapper').find('.dataTables_scrollBody')[0].scrollLeft = difference;
    }
        // if cell is cut off on the left
    else if ($('#tableWrapper').find('.dataTables_scrollHead')[0].scrollLeft > cellOffset) { 
        $('#tableWrapper').find('.dataTables_scrollHead')[0].scrollLeft = cellOffset;
        $('#tableWrapper').find('.dataTables_scrollBody')[0].scrollLeft = cellOffset;
    }
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-24T18:13:02.423

这是我不久前使用的东西。可能有更好，更有效的方法，但这可以完成工作：

```
$(".item").click(function(event){
    event.preventDefault();
    // I broke it down into variable to make it easier to read
    var tgt_full = this.href,
        parts = tgt_full.split("#"),
        tgt_clean = parts[1],
        tgt_offset = $("#"+tgt_clean).offset(),
        tgt_left = tgt_offset.left;

    $('html, body').animate({scrollLeft:tgt_left}, 1000, "easeInOutExpo");          
}) 
```

您只需要确保`item`是一个与目标元素相对应的`a`标签：`href``id`

HTML：

```
<a href="#one">go to section 1</a>
...
<section id="one"> Section 1</section> 
```

希望这可以帮助！

# php - 如何substr数组的值

> ID：14023767
> 
> 赞同：0
> 
> 时间：2012-12-24T16:40:59.273
> 
> 标签：php, arrays, drupal, substr

我需要从以下内容中获取前两个字符：

```
$node->field_email_body['und'][0]['value']; //there are like 200 - 300 characters 
```

我试着去：

```
$bodyemail = substr($node->field_email_body['und'][0]['value'], 0, 2); 
```

它不起作用。
然后我需要做这样的事情：

```
if ($bodyemail == 'ok') {
    drupal_set_message ('done');
}
else {
    drupal_set_message ('not done');
} 
```

我知道它是一个数组......并且`substr`适用于字符串。但我真的不知道如何以另一种方式做到这一点。谷歌没有帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-25T07:21:55.290

谢谢大家的帮助和时间。问题出在我的代码中......在'drupal_set_message'的最后一行我忘了放'）'并认为我的问题是'substr'。现在很好。

```
function driver_mailer_node_presave($node) { 
if ($node->type == 'mailhandler_source'){
drupal_set_message ('mailhandler node: ' .print_r($node->field_email_body['und'][0]['value'], true));
$string = $node->field_email_body['und'][0]['value'];
$bodyemail = substr($string, 0, 10);
drupal_set_message (print_r($bodyemail, true));
}
} 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-12-24T16:45:58.560

你的代码看起来不错。

我建议将数组的位置设置为它自己的变量，然后尝试 substr 。然后您可以回显/记录两者并查看它们的设置。

# node.js - 在 Linux Mint 上运行 TypeScript 编译器时出现“require.paths is removed”错误

> ID：14023770
> 
> 赞同：1
> 
> 时间：2012-12-24T16:41:26.267
> 
> 标签：node.js, installation, npm, typescript

我是 Node.js 的新手。我在 Linux Mint 上运行节点 0.9.5-pre。我使用 npm (1.1.70) 安装 TypeScript，但现在运行 tsc 时出现以下错误：

```
Error: require.paths is removed. Use node_modules folders, or the NODE_PATH environment variable instead.
    at Function.Object.defineProperty.get (module.js:386:11)
    at Object.<anonymous> (/home/rolyp/bin/tsc@0.8.0:4:21)
    at Module._compile (module.js:454:26)
    at Object.Module._extensions..js (module.js:472:10)
    at Module.load (module.js:356:32)
    at Function.Module._load (module.js:312:12)
    at Module.runMain (module.js:497:10)
    at process._tickCallback (node.js:334:13) 
```

我收集到最新版本的 Node.js 不支持 require.paths。似乎有几个相关的现有问题，但我对问题的理解不足以利用答案。

我尝试删除 ~/.node_modules，但这没有帮助。

有人可以解释问题并指出解决方案吗？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-07-28T05:59:41.393

> 我有节点 0.9.5-pre

是 beta 版本中的一个错误，在 0.9 正式版发布时已修复

# java - Java：更改 jLabel 前景色

> ID：14023775
> 
> 赞同：3
> 
> 时间：2012-12-24T16:41:57.157
> 
> 标签：java, swing, user-interface, jlabel, foreground

我正在netbeans中开发应用程序。我有一些我想在鼠标事件（MouseEntered，...）上更改的按钮在 MouseEntered 我有以下代码：

```
private void jButton5MouseEntered(java.awt.event.MouseEvent evt) {
      jButton5.setIcon(new ImageIcon(getClass().getResource("resources/menu2.png")));
       jLabel1.setForeground(Color.RED);
} 
```

我希望它更改该按钮的图标，并且我还想更改我的 jLabel1 的前景色。我对那个 jLabel1 有疑问。它不会改变。为什么？谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-25T01:40:19.617

似乎在这里工作得很好。

![Nimbus 标签颜色](../Images/2c9bc952d0ff7fe392290f754ceb4dce.png)

```
import java.awt.*;
import java.awt.event.*;
import javax.swing.*;

public class NimbusLabelColor {

    public static void main(String[] args) {
        Runnable r = new Runnable() {

            @Override
            public void run() {
                try {
                    for ( UIManager.LookAndFeelInfo info : 
                            UIManager.getInstalledLookAndFeels()) {
                        if ("Nimbus".equals(info.getName())) {
                            System.out.println("Nimbus found!");
                            UIManager.setLookAndFeel(info.getClassName());
                            break;
                        }
                    }
                } catch (Exception e) {
                    e.printStackTrace();
                }
                JPanel gui = new JPanel(new GridLayout(3,1,2,2));

                MouseAdapter adapter = new MouseAdapter() {
                    @Override
                    public void mouseEntered(MouseEvent me) {
                        Object c = me.getSource();
                        // do with extreme caution
                        JLabel l = (JLabel)c;
                        l.setForeground(Color.RED);
                    }

                    @Override
                    public void mouseExited(MouseEvent me) {
                        Object c = me.getSource();
                        // do with extreme caution
                        JLabel l = (JLabel)c;
                        l.setForeground(Color.BLUE);
                    }
                };

                for (int ii=0; ii<3; ii++) {
                    JLabel l = new JLabel("Float Me!");
                    l.addMouseListener(adapter);
                    gui.add(l);
                }

                JOptionPane.showMessageDialog(null, gui);
            }
        };
        // Swing GUIs should be created and updated on the EDT
        SwingUtilities.invokeLater(r);
    }
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-12-24T18:06:38.123

```
import java.awt.BorderLayout;
import java.awt.Color;
import java.awt.Font;
import java.awt.GridLayout;
import java.awt.event.ActionEvent;
import java.awt.event.ActionListener;

import javax.swing.ImageIcon;
import javax.swing.JButton;
import javax.swing.JFrame;
import javax.swing.JLabel;
import javax.swing.JPanel;
import javax.swing.SwingConstants;

public class Main extends JFrame {
JLabel label1;
JLabel label2;
public Main() {
    super("JLabel Demo");
    setSize(600, 100);

    JPanel content = new JPanel(new BorderLayout());

    label1 = new JLabel("Java2s");
    label1.setFont(new Font("Helvetica", Font.BOLD, 18));
    label1.setOpaque(true);
    label1.setBackground(Color.white);
    content.add(label1, BorderLayout.WEST);

    ImageIcon image = new ImageIcon(getClass().getResource("items.gif"));
    label2 = new JLabel("Java2s", image, SwingConstants.RIGHT);
    label2.setVerticalTextPosition(SwingConstants.TOP);
    label2.setOpaque(true);
    label2.setBackground(Color.white);
    content.add(label2, BorderLayout.CENTER);

    JButton btn = new JButton("Change");
    btn.addActionListener(new ActionListener() {

        public void actionPerformed(ActionEvent arg0) {
            label1.setForeground(Color.RED);
            label2.setIcon(new ImageIcon(getClass().getResource("menu_arrow.gif")));
        }

    });
    content.add(btn, BorderLayout.EAST);

    getContentPane().add(content);
    setVisible(true);
}

public static void main(String args[]) {
    new Main();
}
} 
```

请尝试上面的代码，布局不好看，但我认为这可以解决您的问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-10-26T05:50:51.883

好吧，无需编写那么冗长的代码，您就有一个简单且理想的使用鼠标输入事件的选项。如下

```
private void jMenu1MouseEntered(java.awt.event.MouseEvent evt) {                                    

        this.jMenu1.setBackground(Color.red);
        this.jMenu1.setForeground(Color.red);
        System.out.println("Mouse Entered in Manu 1");
    } 
```

这会有所帮助。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-05-10T15:08:22.330

我创建了一个简单的应用程序来展示如何通过鼠标事件更改标签组件。在按钮中，我添加了一个鼠标监听器，它是一个实现 MouseListener 接口的内部类。作为补充，我实现了两种方法：mouseExited 和 mouseEntered。第一种方法，我用来显示标签的初始状态，当鼠标退出按钮区域时又回到原来的状态。第二种方法显示当鼠标在按钮区域时标签发生变化。

我希望它对您或其他人有所帮助。

```
public class MouseChangeLabel {

    private JFrame frame;

    public static void main(String[] args) {
        EventQueue.invokeLater(new Runnable() {
            public void run() {
                try {
                    MouseChangeLabel window = new MouseChangeLabel();
                    window.frame.setVisible(true);
                } catch (Exception e) {
                    e.printStackTrace();
                }
            }
        });
    }

    public MouseChangeLabel() {
        initialize();
    }

    private void initialize() {
        frame = new JFrame();
        frame.setBounds(0, 0, 200, 150);
        frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
        frame.getContentPane().setLayout(null);

        JLabel lblLabel1 = new JLabel("Label 1 without Panel");
        lblLabel1.setHorizontalAlignment(SwingConstants.CENTER);
        lblLabel1.setBounds(30, 10, 150, 30);
        lblLabel1.setForeground(Color.BLACK);
        frame.getContentPane().add(lblLabel1);

        JButton btnButton = new JButton("Button 1");
        btnButton.setBounds(30, 50, 150, 30);
        btnButton.addMouseListener(new MouseListener() {

            @Override
            public void mouseReleased(MouseEvent e) {
                // TODO Auto-generated method stub
            }

            @Override
            public void mousePressed(MouseEvent e) {
                // TODO Auto-generated method stub
            }

            @Override
            public void mouseExited(MouseEvent e) {
                // TODO Auto-generated method stub
                lblLabel1.setForeground(Color.BLACK);
            }

            @Override
            public void mouseEntered(MouseEvent e) {
                // TODO Auto-generated method stub
                lblLabel1.setForeground(Color.RED);     
            }

            @Override
            public void mouseClicked(MouseEvent e) {
                // TODO Auto-generated method stub
            }
        });
        frame.getContentPane().add(btnButton);
    }
} 
```

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2012-12-24T19:46:54.767

我在 netbeans 中开发它，这意味着，当我创建我的 jFrame 表单时，那里已经有一些预先生成的代码。这里是：

```
import java.awt.Color;
import java.awt.Component;
import javax.swing.ImageIcon;
import javax.swing.JLabel;

/*
* To change this template, choose Tools | Templates
* and open the template in the editor.
*/

/**
 *
 * @author Svist
 */
public class OsvetlenieForm extends javax.swing.JFrame {

/**
 * Creates new form OsvetlenieForm
 */
public OsvetlenieForm() {
    initComponents();
}

/**
 * This method is called from within the constructor to initialize the form.
 * WARNING: Do NOT modify this code. The content of this method is always
 * regenerated by the Form Editor.
 */
@SuppressWarnings("unchecked")
// <editor-fold defaultstate="collapsed" desc="Generated Code">
private void initComponents() {

    jLabel5 = new javax.swing.JLabel();
    jLabel4 = new javax.swing.JLabel();
    jLabel3 = new javax.swing.JLabel();
    jLabel2 = new javax.swing.JLabel();
    jButton4 = new javax.swing.JButton();
    jButton3 = new javax.swing.JButton();
    jButton5 = new javax.swing.JButton();
    jButton2 = new javax.swing.JButton();
    jLabel1 = new javax.swing.JLabel();

    setDefaultCloseOperation(javax.swing.WindowConstants.DISPOSE_ON_CLOSE);
    setTitle("Osvetlenie");
    setMinimumSize(new java.awt.Dimension(900, 600));
    setResizable(false);
    getContentPane().setLayout(null);

    jLabel5.setFont(new java.awt.Font("Tunga", 0, 18)); // NOI18N
    jLabel5.setForeground(new java.awt.Color(255, 255, 255));
    jLabel5.setText("Pohodlie");
    getContentPane().add(jLabel5);
    jLabel5.setBounds(10, 320, 60, 20);

    jLabel4.setFont(new java.awt.Font("Tunga", 0, 18)); // NOI18N
    jLabel4.setForeground(new java.awt.Color(255, 255, 255));
    jLabel4.setText("Bezpecnost");
    getContentPane().add(jLabel4);
    jLabel4.setBounds(10, 280, 90, 20);

    jLabel3.setFont(new java.awt.Font("Tunga", 0, 18)); // NOI18N
    jLabel3.setForeground(new java.awt.Color(255, 255, 255));
    jLabel3.setText("Kúrenie");
    getContentPane().add(jLabel3);
    jLabel3.setBounds(10, 240, 70, 20);

    jLabel2.setFont(new java.awt.Font("Tunga", 0, 18)); // NOI18N
    jLabel2.setForeground(new java.awt.Color(55, 117, 121));
    jLabel2.setText("Osvetlenie");
    getContentPane().add(jLabel2);
    jLabel2.setBounds(10, 200, 80, 14);

    jButton4.setIcon(new javax.swing.ImageIcon(getClass().getResource("/resources/nic.png"))); // NOI18N
    jButton4.setBorder(null);
    jButton4.setBorderPainted(false);
    jButton4.setContentAreaFilled(false);
    jButton4.addMouseListener(new java.awt.event.MouseAdapter() {
        public void mouseEntered(java.awt.event.MouseEvent evt) {
            jButton4MouseEntered(evt);
        }
        public void mouseExited(java.awt.event.MouseEvent evt) {
            jButton4MouseExited(evt);
        }
    });
    getContentPane().add(jButton4);
    jButton4.setBounds(0, 310, 180, 40);

    jButton3.setIcon(new javax.swing.ImageIcon(getClass().getResource("/resources/nic.png"))); // NOI18N
    jButton3.setBorder(null);
    jButton3.setBorderPainted(false);
    jButton3.setContentAreaFilled(false);
    jButton3.addMouseListener(new java.awt.event.MouseAdapter() {
        public void mouseEntered(java.awt.event.MouseEvent evt) {
            jButton3MouseEntered(evt);
        }
        public void mouseExited(java.awt.event.MouseEvent evt) {
            jButton3MouseExited(evt);
        }
    });
    getContentPane().add(jButton3);
    jButton3.setBounds(0, 270, 180, 40);

    jButton5.setIcon(new javax.swing.ImageIcon(getClass().getResource("/resources/nic.png"))); // NOI18N
    jButton5.setBorder(null);
    jButton5.setBorderPainted(false);
    jButton5.setContentAreaFilled(false);
    jButton5.addMouseListener(new java.awt.event.MouseAdapter() {
        public void mouseEntered(java.awt.event.MouseEvent evt) {
            jButton5MouseEntered(evt);
        }
        public void mouseExited(java.awt.event.MouseEvent evt) {
            jButton5MouseExited(evt);
        }
    });
    getContentPane().add(jButton5);
    jButton5.setBounds(0, 190, 177, 39);

    jButton2.setIcon(new javax.swing.ImageIcon(getClass().getResource("/resources/nic.png"))); // NOI18N
    jButton2.setBorder(null);
    jButton2.setBorderPainted(false);
    jButton2.setContentAreaFilled(false);
    jButton2.addMouseListener(new java.awt.event.MouseAdapter() {
        public void mouseEntered(java.awt.event.MouseEvent evt) {
            jButton2MouseEntered(evt);
        }
        public void mouseExited(java.awt.event.MouseEvent evt) {
            jButton2MouseExited(evt);
        }
    });
    getContentPane().add(jButton2);
    jButton2.setBounds(0, 230, 177, 39);

    jLabel1.setIcon(new javax.swing.ImageIcon(getClass().getResource("/resources/menu.jpg"))); // NOI18N
    getContentPane().add(jLabel1);
    jLabel1.setBounds(0, 0, 900, 600);

    pack();
    java.awt.Dimension screenSize = java.awt.Toolkit.getDefaultToolkit().getScreenSize();
    java.awt.Dimension dialogSize = getSize();
    setLocation((screenSize.width-dialogSize.width)/2,(screenSize.height-dialogSize.height)/2);
}// </editor-fold>

private void jButton2MouseEntered(java.awt.event.MouseEvent evt) {
   jButton2.setIcon(new ImageIcon(getClass().getResource("resources/menu2.png")));

}

private void jButton2MouseExited(java.awt.event.MouseEvent evt) {
    jButton2.setIcon(new ImageIcon(getClass().getResource("resources/nic.png")));
}

private void jButton3MouseEntered(java.awt.event.MouseEvent evt) {
    jButton3.setIcon(new ImageIcon("src/menu_over.png"));
}

private void jButton3MouseExited(java.awt.event.MouseEvent evt) {
    jButton3.setIcon(new ImageIcon("src/menu2.png"));
}

private void jButton4MouseEntered(java.awt.event.MouseEvent evt) {
    jButton4.setIcon(new ImageIcon("src/menu_over.png"));
}

private void jButton4MouseExited(java.awt.event.MouseEvent evt) {
    jButton4.setIcon(new ImageIcon("src/menu2.png"));
}

private void jButton5MouseEntered(java.awt.event.MouseEvent evt) {
      jButton5.setIcon(new ImageIcon(getClass().getResource("resources/menu2.png")));
       jLabel1.setForeground(Color.RED);
}

private void jButton5MouseExited(java.awt.event.MouseEvent evt) {
     jButton5.setIcon(new ImageIcon(getClass().getResource("resources/nic.png")));
}

/**
 * @param args the command line arguments
 */
public static void main(String args[]) {
    /*
     * Set the Nimbus look and feel
     */
    //<editor-fold defaultstate="collapsed" desc=" Look and feel setting code (optional) ">
    /*
     * If Nimbus (introduced in Java SE 6) is not available, stay with the
     * default look and feel. For details see
     * http://download.oracle.com/javase/tutorial/uiswing/lookandfeel/plaf.html
     */
    try {
        for (javax.swing.UIManager.LookAndFeelInfo info : javax.swing.UIManager.getInstalledLookAndFeels()) {
            if ("Nimbus".equals(info.getName())) {
                javax.swing.UIManager.setLookAndFeel(info.getClassName());
                break;
            }
        }
    } catch (ClassNotFoundException ex) {
        java.util.logging.Logger.getLogger(OsvetlenieForm.class.getName()).log(java.util.logging.Level.SEVERE, null, ex);
    } catch (InstantiationException ex) {
        java.util.logging.Logger.getLogger(OsvetlenieForm.class.getName()).log(java.util.logging.Level.SEVERE, null, ex);
    } catch (IllegalAccessException ex) {
        java.util.logging.Logger.getLogger(OsvetlenieForm.class.getName()).log(java.util.logging.Level.SEVERE, null, ex);
    } catch (javax.swing.UnsupportedLookAndFeelException ex) {
        java.util.logging.Logger.getLogger(OsvetlenieForm.class.getName()).log(java.util.logging.Level.SEVERE, null, ex);
    }
    //</editor-fold>

    /*
     * Create and display the form
     */
    java.awt.EventQueue.invokeLater(new Runnable() {

        public void run() {
            new OsvetlenieForm().setVisible(true);
        }
    });
}
// Variables declaration - do not modify
private javax.swing.JButton jButton2;
private javax.swing.JButton jButton3;
private javax.swing.JButton jButton4;
private javax.swing.JButton jButton5;
private javax.swing.JLabel jLabel1;
private javax.swing.JLabel jLabel2;
private javax.swing.JLabel jLabel3;
private javax.swing.JLabel jLabel4;
private javax.swing.JLabel jLabel5;
// End of variables declaration

private static class ComponentImpl extends Component {

    public ComponentImpl() {
    }
}
} 
```

我的按钮有一张“图标”图片。我希望此代码在“MouseEntered”时更改按钮的“图标”图像（这很好用），同时更改我的“jLabel1”的文本颜色，即“foreground（color）”参数。（这部分不起作用）。

# objective-c - 在 NSDIctionary 中对数字使用最大/最小值时出错

> ID：14023776
> 
> 赞同：1
> 
> 时间：2012-12-24T16:41:57.687
> 
> 标签：objective-c, cocoa, kvc

使用新的文字语法创建字典，因此：

```
NSDictionary *valuesByHour = @{
    @9: @2,
    @10: @2,
    @11: @3,
    @12: @3,
    @1: @2,
    @2: @2
}; 
```

然后，我想找到最大值，如下所示：

```
return [[self.valuesByHour allValues] valueForKeyPath:@"max.intValue"]; 
```

但我收到此错误：

```
[<__NSCFNumber 0x9f6fbe0> valueForUndefinedKey:]: this class is not key value coding-compliant for the key max. 
```

还尝试过以旧方式实际创建 NSNumber，例如 [NSNumber numberWithInt:2]。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-12-24T16:47:14.877

您缺少`@`关键路径开头的 。

```
return [[self.valuesByHour allValues] valueForKeyPath:@"@max.intValue"]; 
```

# javascript - 如何在 Ember 中输出字符串，同时仍让车把解释它？

> ID：14023783
> 
> 赞同：1
> 
> 时间：2012-12-24T16:43:17.580
> 
> 标签：javascript, ember.js, handlebars.js

这是一个简单的例子

```
MyApp.ApplicationController = Ember.Controller.extend({
  content: "some @user",
  parsedContent: function() {
    return this.get("content").replace("@user", "<a {{action gotoUser 'user'}}>user</a>");
  }.property("content")
}); 
```

这将输出

```
some @user
some <a {{action gotoUser 'user'}}>user</a> 
```

而不是将内容解释为 Handlebars 模板。我想我需要手动编译这个，但我不确定如何传递正确的上下文。

[这是一个 JSFiddle](http://jsfiddle.net/darthdeus/6p6XJ/228/)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-25T04:31:44.323

我在[这里](http://jsfiddle.net/bradleypriest/6p6XJ/250/)有一个工作示例。基本上，通过使视图的模板成为计算属性，您可以在将模板传递给 Handlebars 解析器之前对其进行修改。

```
MyApp.LinkedUsersView = Ember.View.extend({
    template: function() {
        template = this.get("content").replace(/@(\w+)/g, '{{view MyApp.UserLinkView username="$1"}}');
        return Ember.Handlebars.compile(template);
    }.property()
});

MyApp.UserLinkView = Ember.View.extend({
    tagName: "span",
    user: function() {
        return MyApp.User.findByUsername(this.get('username'));
    }.property(),
    template: Ember.Handlebars.compile('<a {{action goToUser view.user href=true}}>@{{view.username}}</a>')
}); 

{{view MyApp.LinkedUsersView content="some @user with @another_user"}} 
```

我不确定每次编译 Handlebars 模板的性能。

# python - 无法在 ipython 笔记本中使用/导入 MySQLdb（在 ipython qtconsole 中运行良好）

> ID：14023785
> 
> 赞同：0
> 
> 时间：2012-12-24T16:43:38.030
> 
> 标签：python, ipython, mysql-python, ipython-notebook

在安装 MySQLdb 时遇到了很大的麻烦（由于 32 位和 64 位架构之间的不兼容），我现在遇到了另一个奇怪的问题，我在网上找不到解决方案。

`import MySQLdb`在中工作正常，`ipython qtconsole`但在`ipython notebook`. 在后者中，我收到以下错误：

```
---------------------------------------------------------------------------
ImportError                               Traceback (most recent call last)
<ipython-input-2-dd22983d5391> in <module>()
----> 1 import MySQLdb

/Users/username/anaconda/lib/python2.7/site-packages/MySQL_python-1.2.4b4-py2.7-macosx-10.5-x86_64.egg/MySQLdb/__init__.py in <module>()
     17 from MySQLdb.release import __version__, version_info, __author__
     18 
---> 19 import _mysql
     20 
     21 if version_info != _mysql.version_info:

ImportError: dlopen(/Users/username/anaconda/lib/python2.7/site-packages/MySQL_python-1.2.4b4-py2.7-macosx-10.5-x86_64.egg/_mysql.so, 2): Library not loaded: libmysqlclient.18.dylib
  Referenced from: /Users/username/anaconda/lib/python2.7/site-packages/MySQL_python-1.2.4b4-py2.7-macosx-10.5-x86_64.egg/_mysql.so
  Reason: image not found 
```

`libmysqlclient.18.dylib`位于`$DYLD_LIBRARY_PATH`.

例如：`$echo $DYLD_LIBRARY_PATH`退货

```
:/usr/local/mysql/lib/:/usr/local/mysql/lib/ 
```

有什么想法可以解决这个问题，或者这是否是`ipython notebook`错误。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-09-23T18:04:43.907

这是一个老问题，但以防万一其他人正在努力安装 MySQLdb ......

有一个名为“pymysql”的纯python mysql驱动程序。您通常可以将它用作 MySQLdb 的替代品。它更容易安装，因为它不需要任何二进制文件。

更多细节在这里：[什么是 PyMySQL，它与 MySQLdb 有何不同？它会影响 Django 部署吗？](https://stackoverflow.com/questions/7224807/what-actually-is-pymysql-and-how-it-differs-from-mysqldb-and-how-can-it-affect)

# inno-setup - 如何在卸载开始前执行程序？

> ID：14023790
> 
> 赞同：11
> 
> 时间：2012-12-24T16:44:25.797
> 
> 标签：inno-setup, uninstallation

InnoSetup 可以在卸载开始之前执行程序吗？我的程序创建了一些注册表值。我有一个可以删除这些注册表值的可执行文件，我的问题是，InnoSetup 可以在卸载开始之前运行该可执行文件吗？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-12-24T16:52:08.283

请参阅 上的文档[，](http://www.jrsoftware.org/ishelp/)`Setup Script Sections`尤其是`UninstallRun`树底部的文档：

```
[UninstallRun]
Filename: "{app}\INIT.EXE"; Parameters: "/x" 
```

如果您需要做一些更复杂的事情，您也可以使用 InnoSetup 中的 Pascal 脚本功能在代码中完成。请参阅`UninstallCodeExample1.iss' in the`InnoSetup 5\Examples 文件夹。

# git - git 日期语法规范

> ID：14023794
> 
> 赞同：12
> 
> 时间：2012-12-24T16:45:12.133
> 
> 标签：git

是否有任何关于传递给 git 的日期语法的规范？例如，“git rev-list”的“--before”选项接受哪些日期？

假设没有这样的规范，有没有办法让 git 将日期转换为规范形式，以便可以检查给定的日期字符串是否被解释为预期的那样？（更新：我已经编写了一个脚本来执行此操作，可 [在此处](https://github.com/ruafozy/utils/blob/master/git-time-parse/git-time-parse)获得。）

信息说明：日期解析似乎是在文件 date.c 中实现的，位于 git 存储库的根目录中。“入口点”似乎是一个名为 approxidate_careful 的函数。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-24T20:19:16.393

据我所知，它没有在任何地方明确指出，但它似乎接受它可以输出的所有格式，如`--date`选项文档中所述：

> ### `--date=(relative|local|default|iso|rfc|short|raw)`
> 
> 仅对以人类可读格式显示的日期生效，例如使用 `--pretty`. `log.date`config 变量设置日志命令`--date`选项的默认值。
> 
> `--date=relative`显示相对于当前时间的日期，例如“2 小时前”。
> 
> `--date=local`显示用户本地时区的时间戳。
> 
> `--date=iso`（或`--date=iso8601`）以 ISO 8601 格式显示时间戳。
> 
> `--date=rfc`（或`--date=rfc2822`）以 RFC 2822 格式显示时间戳，通常在电子邮件消息中找到。
> 
> `--date=short``YYYY-MM-DD`以格式仅显示日期而不显示时间。
> 
> `--date=raw`以内部原始 git 格式显示日期`%s %z`。
> 
> `--date=default`显示原始时区中的时间戳（提交者或作者的）。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-12-24T17:25:11.310

正如您已经发现的那样，git 通常使用 approxidate 来解析各种时间。这使您可以编写各种自然到疯狂的方式来指定时间。

这使您可以编写诸如“六分钟前”或“上周二”甚至“下午茶时间”之类的内容，并且通常可以理解您的意思。除了您已经找到的来源之外，我不知道任何明确的文档。

关于该主题的一个不错的博客条目是[http://www.alexpeattie.com/blog/working-with-dates-in-git/](http://www.alexpeattie.com/blog/working-with-dates-in-git/)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-12-26T23:19:18.977

可悲的是，Git 对于它接受的日期和时间格式并不一致。内部规范格式是 Unix 时间戳（即自 1970 年 1 月 1 日午夜以来的秒数）和时区偏移量的组合。

对于指定日期，这有点难以阅读。我会使用 Git 对[ISO 8601](http://en.wikipedia.org/wiki/ISO_8601 "ISO 8601 数据元素和交换格式 - 信息交换 - 日期和时间的表示")的解释来获得一种相对容易阅读且始终明确的格式。根据您使用的命令，您通常可以使用[minitech 所](https://stackoverflow.com/users/707111/minitech)`--date=iso`指出[的](https://stackoverflow.com/a/14025405/220155)来获得它。它看起来像. `2012-12-26 23:17:23 +0000`

（该`--date=rfc`版本同样明确，因为它只会以相同的方式解释，但包括工作日。我个人反对这样做，因为它允许您指定看起来有效但日期不匹配的日期日期，例如`Sun, 26 Dec 2012 01:02:03 +0000`[那是今天，星期三]。）

对于我相信无处不在的格式，运行[`git help commit-tree`](http://www.kernel.org/pub/software/scm/git/docs/git-commit-tree.html)；该手册页包括以下内容（我已经稍微重新格式化）：

> ### 日期格式
> 
> ,环境变量支持以下日期格式`GIT_AUTHOR_DATE`：`GIT_COMMITTER_DATE`
> 
> *   Git 内部格式：它是`<unix timestamp> <timezone offset>`，其中`<unix timestamp>`是自 UNIX emoch 以来的秒数。`<timezone offset>`是与 UTC 的正偏移或负偏移。例如 CET（比 UTC 提前两个小时）是`+0200`.
>     
>     
> *   [RFC 2822：RFC 2822](https://www.rfc-editor.org/rfc/rfc2822 "互联网消息格式")描述的标准电子邮件格式，例如`Thu, 07 Apr 2005 22:13:13 +0200`.
>     
>     
> *   [ISO 8601： ISO 8601](http://en.wikipedia.org/wiki/ISO_8601 "ISO 8601 数据元素和交换格式 - 信息交换 - 日期和时间的表示")标准指定的时间和日期，例如`2005-04-07T22:13:13`. 解析器也接受空格而不是`T`字符。
>     
>     
>     
>     注意：此外，日期部分接受以下格式`YYYY.MM.DD`：`MM/DD/YYYY`和`DD.MM.YYYY`。

[正如michas 所](https://stackoverflow.com/users/1870481/michas) [指出](https://stackoverflow.com/a/14024118/220155)的，有些地方使用“近似”，因此不那么挑剔。如果您想深入研究，代码在 Git 中[`date.c`](https://github.com/git/git/blob/master/date.c)（该链接通过[在 Git 中使用日期](http://www.alexpeattie.com/blog/working-with-dates-in-git/)链接 michas 发布）。例如，以下来自[`git help revisions`](http://www.kernel.org/pub/software/scm/git/docs/gitrevisions.html)：

> ### 指定修订
> 
> …</p>
> 
> *   `<refname>@{<date>}``master@{yesterday}`，例如`HEAD@{5 minutes ago}`: 后缀后缀的 ref`@`带有括在大括号对中的日期规范（例如`{yesterday}`，`{1 month 2 weeks 3 days 1 hour 1 second ago}`或 `{1979-02-26 18:30:00}）指定 ref 在先前时间点的值。…</li>

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-12-24T17:54:59.980

真正的代码位于[https://github.com/git/git/blob/master/date.c#L717](https://github.com/git/git/blob/master/date.c#L717)并枚举了可用的格式，例如 iso8601、rfc2822 和各种短格式、本地格式、原始格式和默认格式。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2014-11-16T20:24:33.103

请注意， " `date=iso`" 格式并不*完全是* [ISO 8601](http://en.wikipedia.org/wiki/ISO_8601)。对于 Git 2.2.0（2014 年 11 月），请参阅[Beat Bolli (](https://github.com/bbolli) [)](https://github.com/bbolli)
中的 提交“ [466fb67](https://github.com/git/git/commit/466fb6742d7fb7d3e6994b2d0d8db83a8786ebcf) ”[`bbolli`](https://github.com/bbolli)

## pretty：提供严格的 ISO 8601 日期格式

> 由于细微的差异，Git 的“ISO”日期格式并不真正符合 ISO 8601 标准，并且它不能被仅限 ISO 8601 的解析器解析，例如 XML 工具链的解析器。
> 
> " " 的输出`--date=iso`以下列方式偏离 ISO 8601：
> 
> *   一个空格而不是`T`日期/时间分隔符
> *   时间和时区之间的空间
> *   时区的小时和分钟之间没有冒号
> 
> 添加严格的 ISO 8601 日期格式以显示提交者和作者日期。
> 使用 ' `%aI`' 和 ' `%cI`' 格式说明符并添加 ' `--date=iso-strict`' 或 ' `--date=iso8601-strict`' 日期格式名称。
> 
> 请参阅[此线程](http://thread.gmane.org/gmane.comp.version-control.git/255879%20and%20http://thread.gmane.org/gmane.comp.version-control.git/52414/focus=52585)进行讨论。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2015-01-31T21:12:48.733

Git 2.2.2（2015 年 1 月）在尝试在`dd/mm/yy`或`mm/dd/yy`.

请参阅[Jeff King](https://github.com/peff)编写的[提交 d372395 (](https://github.com/git/git/commit/d37239536ce960af9292fdf297e7c277303e95be) [)](https://github.com/peff)[`peff`](https://github.com/peff)

> ### approximate: 允许类似 ISO 的日期在很远的将来
> 
> 当我们解析近似字符串时，我们发现三个数字由一个“ `:/-.`”隔开，我们猜测它可能是一个日期。
> 我们将数字提供给，它会检查它作为各种顺序（例如，或等）`match_multi_number`中的日期是否有意义。`dd/mm/yy``mm/dd/yy`
> 
> 我们所做的一项检查是查看它是否是未来 10 天以上的日期。这是在[38035cf 中添加的（日期解析：对我们的欧洲朋友更友好。，2006-04-05，Git 1.3.0）](https://github.com/git/git/commit/38035cf4a51c48cccf6c5e3977130261bc0c03a7)，让我们猜测如果现在是 2014 年 4 月，那么“ `10/03/2014`”可能是 3 月 10 日，而不是10 月 3 日。
> 
> 不过，这有一个缺点。**如果您想对您的“ `--until`”日期规范过于慷慨，我们可能会错误地将“”解析`2014-12-01`为“ `2014-01-12`”**（因为后者是过去的日期）。
> 如果这一年是未来的一年（即，两者都是未来的日期），那就更奇怪了。由于近似值的变幻莫测，当前日期*后*的几个月（无论年份）都会翻转，但之前的日期不会。
> 
> 此补丁删除了对这种形式的日期的“未来”检查，让我们始终将它们视为`yyyy-mm-dd`，即使它们在未来。
> 这不会影响正常`dd/mm/yyyy`与`mm/dd/yyyy`查找，因为此代码路径仅在第一个数字大于 70 时才会启动（即，它必须是一年，不能是日期或月份）。
> 
> 一个可能的伤亡是“ `yyyy-dd-mm`”不太可能被选中而不是“ `yyyy-mm-dd`”。这可能没关系，但因为：
> 
> 1.  仅当日期在未来时才会发生差异。我们已经更喜欢`yyyy-mm-dd`过去的日期。
> 2.  目前还不清楚是否有人`yyyy-dd-mm`经常使用。它没有出现[在 Wikipedia](http://en.wikipedia.org/wiki/Calendar_date)[的常见日期格式列表中](http://en.wikipedia.org/wiki/Date_and_time_representation_by_country) 。
> 3.  即使 (2) 是错误的，最好选择类似 ISO 的日期，因为这与我们在 git 其他地方使用的一致。

# r - big.matrix 文档中不可重现的示例（应用）

> ID：14023795
> 
> 赞同：3
> 
> 时间：2012-12-24T16:45:43.867
> 
> 标签：r, bigdata, r-bigmemory

我是`big.matrix`和相关包的新手，我尝试重现以下示例```

```
Loading required package: stats
> Sys.setenv(LANG = "en")
> library(bigmemory)
Loading required package: bigmemory.sri

bigmemory >= 4.0 is a major revision since 3.1.2; please see package
biganalytics and http://www.bigmemory.org for more information.

> x <- big.matrix(5, 2, type="integer", init=0, dimnames=list(NULL, c("alpha", "beta")))
> x[,] <- round(rnorm(10))
Assignment will down cast from double to integer
Hint: To remove this warning type:  options(bigmemory.typecast.warning=FALSE)
Mensajes de aviso perdidos
In SetAll.bm(x, value) : 
> x
An object of class "big.matrix"
Slot "address":
<pointer: 0x22a1620>

> x[,]
     alpha beta
[1,]    -2    0
[2,]    -1    0
[3,]     0   -1
[4,]     2    1
[5,]     0    0
> apply(x, 1, mean)
Error en as.vector(data) : 
  ningún método para coaccionar a esta clase S4 a un vector 
```

来自文档，但最后一行给了我以下错误：

```
Error en as.vector(data) : 
  ningún método para coaccionar a esta clase S4 a un vector 
```

最后一行说类似`"there is no method for transform this S4 class to a vector"`

你能给我指点一下吗？

我的 R 版本是

```
R.version
               _                            
platform       x86_64-unknown-linux-gnu     
arch           x86_64                       
os             linux-gnu                    
system         x86_64, linux-gnu            
status                                      
major          2                            
minor          15.1                         
year           2012                         
month          06                           
day            22                           
svn rev        59600                        
language       R                            
version.string R version 2.15.1 (2012-06-22)
nickname       Roasted Marshmallows 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-24T17:18:23.817

好吧，由于先前的答案，我发现了错误（#agstudy，我给你一个+1）...该 `apply`方法来自`base`包，如果我加载`biganalytics`包，一切都像魅力一样...

```
> library(biganalytics)
> apply(x, 1, mean)
[1]  0.0  1.5  0.5 -1.0  0.5 
```

再次感谢你！

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-24T17:10:22.030

您尝试调用`apply`一个 bigmemory 对象。后者没有转换为矩阵的隐式方法（apply 需要的参数）

```
apply(x, 1, mean)
Error in as.vector(data) : 
  no method for coercing this S4 class to a vector 
```

强制转换为矩阵，更正问题

```
apply(as.matrix(x), 1, mean)
[1] -1.5 -0.5  1.0 -0.5 -0.5 
```

OP回答后编辑：

**biganalytics**包通过各种分析扩展了 bigmemory 包。函数 bigkmeans 和 binit 也可以与原生 R 对象一起使用。但小心点：

> 申请 big.matrix 对象。请注意，由于与从 big.matrix 对象中提取数据相关的 S4 开销，性能可能会降低（与使用常规 R 矩阵相比）。这种限制是不可避免的，其他“自定义”数据结构也会出现这种情况（甚至更糟）。当然，这仅在您应用过长的行或列时才特别重要。

对于类似 tapply 的功能，**bigtabulate** 包也可能会有所帮助。这个包的想法是分两步完成这项工作。

> 我们发现，当拆分产生的子集大小合理时，bigsplit 后跟 lapply 或 sapply 可能特别有效。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-24T17:17:22.110

这个答案与原始问题略有偏离，不是“为什么不起作用`apply(...)`？”，@agstudy 在上面回答了，而是“我如何获得`bigmemory`对象的行均值？” 我用谷歌搜索`"r bigmemory rowmeans"`并最终来到这里： http: [//www.stat.yale.edu/~jay/HPCwR/examples/bioinfo/bioinfo3.txt](http://www.stat.yale.edu/~jay/HPCwR/examples/bioinfo/bioinfo3.txt)

重现一个有趣的片段：

```
# Get the row means, three different ways.

system.time({
  a <- rep(0, nrow(z))
  for (i in 1:nrow(z)) {
    a[i] <- mean(z[i,])
  }
}) # Will definitely work on both matrix and big.matrix
   # matrix timing: about 30 seconds
   # big.matrix timing: about 270 seconds
   #    The price for using bigmemory with lots of very small
   #    operations is the overhead of S3/S4 dispatch.

system.time({
  a <- apply(z, 1, mean)
}) # Works on a matrix only; interesting that it is slower.
   # matrix timing: 45 seconds 

system.time({
  myfunc <- function(i) return(mean(z[i,]))
  a <- sapply(1:nrow(z), myfunc)
}) # Will definitely work on both matrix and big.matrix
   # matrix timing:     About 40 seconds
   # big.matrix timing: About 306 seconds 
```

该示例继续展示如何使用并行方法（`doMC`等）来计算行均值。

# objective-c - CALayer 和视图消失了

> ID：14023797
> 
> 赞同：3
> 
> 时间：2012-12-24T16:45:54.227
> 
> 标签：objective-c, ios, drawing, catiledlayer

我有一个用 CATiledLayer 管理的大图像（如[Large Image Downsizing iOS sample code](http://developer.apple.com/library/ios/#samplecode/LargeImageDownsizing/Introduction/Intro.html)）。

我有一个绘图视图（UIView 被绘图方法覆盖）但是当我放大很多时，我收到以下消息并且我的视图消失了..

```
-[<CALayer: 0xb253aa0> display]: Ignoring bogus layer size (25504.578125, 15940.361328) 
```

有没有办法避免这种情况？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-24T17:14:16.140

听起来，您设置的 levelsOfDetail 和 levelsOfDetailBias 允许的缩放比平铺层应该允许的更大，因为该层允许的最大层大小。尝试更改这些以减少用户可以缩放的程度。

[这](http://red-glasses.com/index.php/tutorials/catiledlayer-how-to-use-it-how-it-works-what-it-does/)是一篇很棒的文章，解释了 CATiledLayer 的一些未记录的行为。

# c#-4.0 - 使用 Facebook C# SDK 在 facebook 中统计我朋友的朋友

> ID：14023803
> 
> 赞同：2
> 
> 时间：2012-12-24T16:46:15.333
> 
> 标签：c#-4.0, facebook-c#-sdk

有没有办法只看那个朋友有多少朋友？示例：我的朋友 - Sylvain（有 300 个朋友） - Olivier（有 145 个朋友）

谢谢，

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-24T18:01:14.750

[This FQL query](https://developers.facebook.com/tools/explorer?fql=SELECT%20friend_count,%20uid%20FROM%20user%20WHERE%20uid%20IN%28SELECT%20uid2%20FROM%20friend%20WHERE%20uid1%20=%20me%28%29%29%0A) will get the `friend_count` field for all the loggedin user's friends.

```
SELECT friend_count, uid FROM user WHERE uid IN(SELECT uid2 FROM friend WHERE uid1 = me()) 
```

# user-input - 在读取应用程序中播放多个文件 [Asterisk 平台]

> ID：14023808
> 
> 赞同：0
> 
> 时间：2012-12-24T16:46:29.563
> 
> 标签：user-input, asterisk, playback

我可以获得用户输入的方式是`Read`应用程序如下： `Read(variable[,filename[,maxDigits[,option[,attempts[,timeout]]]]])` 但是如果我想播放多个文件而不是一个文件来获取用户输入，它没有任何选择！我可以使用`Playback`或`Background`播放文件然后调用`Read`应用程序，但在声音播放期间用户无法输入。

[星号读取应用程序](http://the-asterisk-book.com/1.6/applikationen-read.html)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-24T17:00:27.840

根据Asterisk 版本 1.4 中的[voip-info](http://www.voip-info.org/wiki/view/Asterisk+cmd+Read)，您不能这样做，但在 1.8 中，您可以通过用“&”符号分隔多个声音文件来指定多个声音文件。（播放和背景也支持这种播放多种声音的方法）

我不确定 1.6 是否支持该功能。

# php - 使用 PHP 创建多个 MySQL 表

> ID：14023810
> 
> 赞同：6
> 
> 时间：2012-12-24T16:46:54.427
> 
> 标签：php, mysql

我正在尝试使用 php 创建一个以上的 MySQL 表，但它给出了错误，我无法弄清楚它有什么问题。

PHP代码：

```
$sql = ' CREATE TABLE IF NOT EXISTS `mod_reminder_entries` 
  ( 
   `id`          INT(10) NOT NULL auto_increment, 
   `user_id`     INT(10) NOT NULL, 
   `entry_name`  VARCHAR(255) NOT NULL, 
   `entry_value` INT(10) NOT NULL, 
   PRIMARY KEY (`id`), 
   FOREIGN KEY (`user_id`) REFERENCES tblclients (`id`) 
 ); 

 CREATE TABLE IF NOT EXISTS `second_table` 
  ( 
   `user_id`     INT(10) NOT NULL, 
   `fieldstotal` INT(10) NOT NULL, 
   FOREIGN KEY (`user_id`) REFERENCES tblclients (`id`) 
  ); ';

  mysql_query($sql); 
```

它给出了错误，除了不要担心mysql连接。我正确连接了数据库并且我已经对其进行了测试，这肯定是语法有问题。

> 您的 SQL 语法有错误；检查与您的 MySQL 服务器版本相对应的手册，以在“CREATE TABLE IF NOT EXISTS `second_table`( `user_id`INT ) 附近使用正确的语法

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-24T16:48:26.663

您不能使用分号分隔的查询[`mysql_query`](http://php.net/manual/en/function.mysql-query.php)，此功能一次只允许一个查询！

您必须单独执行您的语句：

```
mysql_query("
    CREATE TABLE IF NOT EXISTS `mod_reminder_entries` (
        `id` INT(10) NOT NULL AUTO_INCREMENT, 
        `user_id` INT(10) NOT NULL, 
        `entry_name` VARCHAR(255) NOT NULL, 
        `entry_value` INT(10) NOT NULL, 
        PRIMARY KEY (`id`), 
        FOREIGN KEY (`user_id`) REFERENCES tblclients (`id`) 
    )
") or die(mysql_error());

mysql_query("
CREATE TABLE IF NOT EXISTS `second_table` (
    `user_id` INT(10) NOT NULL, 
    `fieldstotal` INT(10) NOT NULL, 
    FOREIGN KEY (`user_id`) REFERENCES tblclients (`id`) 
)
") or die(mysql_error()); 
```

或者更好的是，使用[mysqli_multi_query](http://php.net/manual/en/mysqli.multi-query.php) - 这意味着您必须切换到[mysqli](http://php.net/manual/en/class.mysqli.php)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-24T16:48:42.033

只需按照错误消息中的说明操作即可。

您一次只能执行**一个**查询，`mysql_*`但[**请不要`mysql_*`在新代码中使用函数**](https://stackoverflow.com/q/12859942/)。它们不再被维护[并被正式弃用](https://wiki.php.net/rfc/mysql_deprecation)。看到[**红框**](https://www.php.net/manual/en/function.mysql-connect.php)了吗？改为了解[*准备好的语句*](https://en.wikipedia.org/wiki/Prepared_statement)，并使用[PDO](http://php.net/pdo)或[MySQLi](http://php.net/mysqli) -[本文](https://php.net/manual/en/mysqlinfo.api.choosing.php)将帮助您决定使用哪个。如果您选择 PDO，[这里有一个很好的教程](http://wiki.hashphp.org/PDO_Tutorial_for_MySQL_Developers)。

# c# - 正确处理 WebRequest 和 StreamReader

> ID：14023811
> 
> 赞同：7
> 
> 时间：2012-12-24T16:46:56.733
> 
> 标签：c#, .net, web-services, httpwebrequest

在从客户端方法 getRecords 调用 ReadToEnd 方法期间，我遇到了对象处理异常，该方法使用 StreamReader 与 Web 服务器通信。

对 getRecords 的第一次调用成功，只有在后续调用期间才会发生异常，因此我没有正确关闭和处理 StreamReader 和关联的 WebRequest。

我知道我可以将这两个对象包装在 using 语句中，但是它只是扩展为 try/catch/finally 语句。从下面的代码中可以看出，我正在清理 finally 子句。

因此，**我要么没有做 using 语句所做的事情，要么我的 finally 语句中可能缺少其他一些东西。**如果可能的话，我宁愿不使用 using 语句，因为我喜欢我的代码明确。

这是代码和相关的异常：

```
 public int getRecords(string[] args, string[] vals)
    {
        List<string> urlList = BuildUrlRequestStrings(args, vals); 

        WebRequest request = null;
        WebResponse wresponse = null;
        StreamReader sr = null;           

        foreach (string url in urlList)
        {   
            request = WebRequest.Create(url);

            request.Method = "GET";
            request.ContentType = "application/json";
            //request.Timeout = -1;
            request.Timeout = 300000;
            request.Credentials = CredentialCache.DefaultCredentials;
            //request.ContentType = "application/xml";

            try
            {
                wresponse = request.GetResponse();

                /*using (StreamReader sr = new StreamReader(wresponse.GetResponseStream()))
                {
                    _recieveBuffer = sr.ReadToEnd().ToString();
                }*/
                sr = new StreamReader(wresponse.GetResponseStream());
                _recieveBuffer = sr.ReadToEnd();

                //List<T> temp = JsonConvert.DeserializeObject<List<T>>(_recieveBuffer);
                List<T> temp = JsonConvert.DeserializeObject<List<T>>(
                    _recieveBuffer,
                    new JsonSerializerSettings { TypeNameHandling = TypeNameHandling.All }
                );

                _recieveData.AddRange(temp);                    
            }
            catch (WebException ex)
            {
                if (ex.Response != null)
                {
                    // can use ex.Response.Status, .StatusDescription         
                    if (ex.Response.ContentLength != 0)
                    {
                        using (var stream = ex.Response.GetResponseStream())
                        {
                            using (var reader = new StreamReader(stream))
                            {
                                Log.Info(FIDB.TAG1, "   WSBuffer.getRecords: WEBSERVER MESSAGE: " + reader.ReadToEnd());
                            }
                        }
                    }
                }

                return -1;
            }
            finally
            {
                if (sr != null)
                {
                    sr.Close();
                    sr.Dispose();
                }

                if (wresponse != null)
                {
                    wresponse.Close();
                    wresponse.Dispose();
                }
            }
        }

        return _recieveData.Count;
    } 
```

* * *

> 07-02 11:32:15.076: I/<<< FI >>>(2775): StorageRelayService.RequestQueueThread: EXCEPTION: System.ObjectDisposedException: 对象在处理后被使用。07-02 11:32:15.076: I/<<< FI >>>(2775): 在 System.Net.WebConnection.BeginRead（System.Net.HttpWebRequest 请求，System.Byte[] 缓冲区，Int32 偏移量，Int32 大小, System.AsyncCallback cb, System.Object state) [0x00000] in :0 07-02 11:32:15.076: I/<<< FI >>>(2775): at System.Net.WebConnectionStream.BeginRead (System. Byte[] 缓冲区，Int32 偏移量，Int32 大小，System.AsyncCallback cb，System.Object 状态）[0x00000] in :0 07-02 11:32:15.076: I/<<< FI
> 
> > > > （2775）：在 System.Net.WebConnectionStream.Read（System.Byte[] 缓冲区，Int32 偏移量，Int32 大小）[0x00000] 在：0 07-02 11:32:15.076：I/<<< FI >>> (2775): 在 System.IO.StreamReader.ReadBuffer () [0x00000] in :0 07-02 11:32:15.076: I/<<< FI >>>(2775): 在 System.IO.StreamReader.Read （System.Char[] 缓冲区，Int32 索引，Int32 计数）[0x00000] in :0 07-02 11:32:15.076: I/<<< FI (2775): at System.IO.StreamReader.ReadToEnd () [ 0x00000] in :0 07-02 11:32:15.076: I/<<< FI >>>(2775): 在 FieldInspection.Shared.Buffer.WSBuffer`1[FieldInspection.Shared.Model.AggregateRoot.Parcel].getRecords (System.String[] args, System.String[] vals) [0x00000] in <filename unknown>:0 07-02 11:32:15.076: I/<<< FI >>>(2775): at FieldInspection.Shared.Repository.REST.RepositoryREST`1[FieldInspection.Shared.Model.AggregateRoot.Parcel].Read（IConditions 条件）[0x00000] in :0 07-02 11:32:15.076: I/<<< FI >>>(2775): 在 FieldInspection.Shared .Model.DataAccess.ParcelRepositoryREST.parcelByIdList (System.Collections.Generic.List `1 parcelIdList, Boolean bCurrent, Boolean bHistorical) [0x00000] in <filename unknown>:0 07-02 11:32:15.076: I/<<< FI >>>(2775): at FieldInspection.Droid.StorageRelayService.ProcessRequestGetParcelCache (FieldInspection.Shared.Database.IPC.Request request) [0x00000] in <filename unknown>:0 07-02 11:32:15.076: I/<<< FI >>>(2775): at FieldInspection.Droid.StorageRelayService.ProcessRequestFromForegroundActivity (System.Collections.Generic.List`1 reqList) [0x00000] in :0 07-02 11:32:15.076: I/<<< FI >>>(2775): 在 FieldInspection。 Droid.StorageRelayService.RequestQueueThread () [0x00000] in :0

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-24T17:02:55.700

我强烈建议您使用“使用”语句。一旦你知道你的 WebResponse 和 StreamReader 被正确处理，调试就变得更容易了。

此外，您为循环的每次迭代创建一个 WebRequest 对象。你为什么不尝试异步方法？

这篇文章可能会有所帮助：[如何异步使用 HttpWebRequest (.NET)？](https://stackoverflow.com/questions/202481/how-to-use-httpwebrequest-net-asynchronously)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-24T17:27:46.110

我知道您已经接受了答案，但另一种解决方案是将变量声明*放入*`foreach`循环中。

```
foreach (string url in urlList)
{ 
    WebRequest request = null;
    WebResponse wresponse = null;
    StreamReader sr = null;  
    ...
} 
```

然后每个循环都会得到它自己的实例，并且`.Dispose()`会按你期望的那样工作。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-25T07:42:23.350

如果你的第一次运行没问题，但在下一次运行时遇到问题，那么很可能是因为垃圾收集器没有清理关闭的对象。在块的末尾执行以下`finally`操作。

```
GC.Collect();
GC.WaitForPendingFinalizers(); 
```

* * *

## 回答 #4

> 赞同：-2
> 
> 时间：2012-12-24T16:54:34.150

一旦失去范围，使用`using`它将关闭您的连接。

# mysql - 将两个 Mysql SUM 选择查询合并为一个查询

> ID：14023812
> 
> 赞同：3
> 
> 时间：2012-12-24T16:46:59.437
> 
> 标签：mysql, sum

我有以下两个查询的 SUM 值
**Query1:***

> 从表 1 中选择总和（价格），`acc_id`其中 = '555'

**查询2：**

> 从表 2 中选择总和（价格）`account`，其中 = '555' && active='1'

我尝试将这两个查询结合起来，但给出错误的求和结果，例如如果`query1 sum is: -86500`和`Query2 sum is: 76000`，RESULT 必须是`-10500`，但结果显示为数字`-486000`

我正在尝试这样，但我没有得到预期的结果。

```
SELECT SUM(t1.price + t2.price) AS TotalCredit 
FROM TABLE1 AS t1, TABLE2 AS t2 
WHERE t1.`acc_id` = '555' && t2.`Account`='555' && t2.`Active`='1' 
```

表图像：![在此处输入图像描述](../Images/712e4076c9ab617e4d672e145a80e896.png)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-24T16:57:06.083

由于加入记录的数量会重复，并且您会获得更高的总和值，请尝试此

```
SELECT sum(prc) 
FROM (
    SELECT SUM(price) prc FROM TABLE1 WHERE acc_id = '555'
    union all 
    SELECT SUM(price) prc FROM TABLE2 WHERE account = '555' && active='1'
) a 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-24T16:56:13.840

尝试这个

```
SELECT SUM(C.TOTAL) AS TOTAL_CREDIT FROM (SELECT SUM(A.price) AS TOTAL FROM TABLE1 A WHERE A.acc_id = '555'
UNION ALL
SELECT SUM(B.price) AS TOTAL FROM TABLE2 B WHERE B.account = '555' && B.active='1') C; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-24T16:56:52.310

试试看

```
SELECT (SUM(t1.price) + SUM(t2.price)) AS TotalCredit 
FROM TABLE1 AS t1, TABLE2 AS t2 
WHERE t1.`acc_id` = '555' && t2.`Account`='555' && t2.`Active`='1' 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-24T17:06:34.460

这个怎么样：

```
SELECT SUM(a) 
FROM
  (SELECT SUM(price) AS a
   FROM TABLE1 
   WHERE acc_id = '555'
   UNION ALL
   SELECT SUM(price) AS a
   FROM TABLE2 
   WHERE account = '555' && active='1') 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-12-24T17:09:55.070

`Join`有待改善。:) 如果您可以向我们展示表模式，那就更好了。这是基于一些*假设样本数据*的解决方案。

样本数据：

表格1：

```
ID  PRICE
11  200
55  300
33  200
44  100
55  500 
```

表2：

```
ID  PRICE   ACTIVE
1   200     0
2   300     1
55  200     0
55  100     1
55  400     1 
```

*   [SQLFIDDLE 演示](http://sqlfiddle.com/#!2/c22d97/1)

询问：

```
select sum(t.price) + x.tb2credit
from tb1 as t
inner join
(SELECT id, SUM(price) AS Tb2Credit 
FROM tb2
WHERE id = 55
and `Active`=1) x
on t.id = x.id 
```

结果：

```
SUM(T.PRICE) + X.TB2CREDIT
1300 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-12-24T16:49:31.110

尝试这个

```
 SELECT (t1.price + t2.price) AS TotalCredit 
    FROM TABLE1 AS t1, TABLE2 AS t2 
    WHERE t1.`acc_id` = '555' && t2.`Account`='555' && t2.`Active`='1' 
```

编辑：

我想你在找什么

```
 SELECT (SUM(t1.price)+SUM(t2.price) )/2  AS TotalCredit 
FROM Table1 AS t1, Table2 AS t2 
WHERE t1.`acc_id` = '555' && t2.`account`='555' && t2.`active`='1' 
```

[**演示小提琴在这里**](http://sqlfiddle.com/#!2/02fdd/1)

# c++ - Linux 中 C++ 应用程序的内存稳定性

> ID：14023815
> 
> 赞同：5
> 
> 时间：2012-12-24T16:47:13.933
> 
> 标签：c++, linux, memory, memory-leaks

我想验证我为 Linux 编写和编译的 C++ 应用程序的内存稳定性。它是一个网络应用程序，以每秒 10-20 个连接的速率响应远程客户端的连接。从长远来看，内存上升到 50MB，尽管应用程序正在调用删除......

调查表明，Linux 不会立即释放内存。所以这是我的问题：

如何强制 Linux 释放我实际释放的内存？至少我想这样做一次以验证内存稳定性。否则，是否有任何可靠的内存指示器可以报告我的应用程序实际持有的内存？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-24T19:01:21.153

您所看到的很可能根本不是内存泄漏。如今，操作系统和 malloc/new 堆都对内存进行了非常复杂的计算。总的来说，这是一件*非常好的事情。* 您尝试强制操作系统释放内存的任何尝试都只会损害您的应用程序性能和整体系统性能。

为了显示：

1.  堆保留几个虚拟内存区域供使用。在 malloc 之前，实际上都没有提交（由物理内存支持）。

2.  你分配内存。堆相应地增长。您可以在任务管理器中看到这一点。

3.  您在堆上分配更多内存。它长得更多。

4.  您释放了在第 2 步中分配的内存。但是，堆无法收缩，因为仍然分配了 #3 中的内存，并且堆无法压缩内存（这会使您的指针无效）。

5.  你 malloc/new 更多的东西。这可能会在步骤 #3 中分配内存*后被*添加，因为它无法放入由释放 #2 所打开的区域，或者因为堆管理器在堆中搜索 # 所打开的块的效率低下2\. （取决于堆实现和正在分配/释放的内存块大小）

那么，第 2 步的那段记忆现在对世界来说已经死了吗？不必要。一方面，一旦它变得有效，它最终可能会被重用。在不被重用的情况下，操作系统本身可能能够使用 CPU 的虚拟内存功能 (TLB) 从您的应用程序下“重新映射”未使用的内存，并将其分配给另一个应用程序 - on苍蝇。堆意识到了这一点，并且通常以某种方式管理事物以帮助提高操作系统重新映射页面的能力。

**这些是有价值的内存管理技术，它们具有通过 Process Explorer 渲染细粒度内存泄漏检测的明显副作用，大多数情况下是无用的。** 如果要检测堆中的小内存泄漏，则需要使用运行时堆泄漏检测工具。既然你提到你也可以在 Windows 上构建，我会注意到微软的 CRT 内置了足够的泄漏检查工具。在此处找到使用说明：

[http://msdn.microsoft.com/en-us/library/974tc9t1(v=vs.100).aspx](http://msdn.microsoft.com/en-us/library/974tc9t1(v=vs.100).aspx)

也有用于 GCC/Clang 工具链的 malloc 的开源替代品，尽管我没有直接使用它们的经验。我认为在 Linux 上**Valgrind**无论如何都是首选且更可靠的泄漏检测方法。（根据我的经验，比 MSVCRT Debug 更容易使用）。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-12-24T16:55:21.500

我建议将 valgrind 与 memcheck 工具或任何其他分析工具一起用于内存泄漏

来自 Valgrind 的页面：

> **内存检查**
> 
> 检测内存管理问题，主要针对 C 和 C++ 程序。当一个程序在 Memcheck 的监督下运行时，所有的内存读写都会被检查，并且对 malloc/new/free/delete 的调用会被拦截。因此，Memcheck 可以检测您的程序是否：
> 
> *   访问它不应该访问的内存（尚未分配的区域、已释放的区域、堆块末尾的区域、堆栈的不可访问区域）。
> *   以危险的方式使用未初始化的值。
> *   泄漏内存。
> *   堆块的错误释放（双重释放，不匹配的释放）。
> *   将重叠的源和目标内存块传递给 memcpy() 和相关函数。
> 
> Memcheck 会在这些错误发生时立即报告，并给出发生错误的源代码行号，以及为到达该行而调用的函数的堆栈跟踪。Memcheck 在字节级别跟踪可寻址性，并在位级别跟踪值的初始化。因此，它可以检测单个未初始化位的使用，并且不会报告位域操作的虚假错误。Memcheck 运行程序的速度比正常速度慢 10--30 倍。缓存研磨
> 
> **地块**
> 
> Massif 是一个堆分析器。它通过定期拍摄程序堆的快照来执行详细的堆分析。它会生成一个图表，显示随时间的堆使用情况，包括有关程序的哪些部分负责最多内存分配的信息。该图由文本或 HTML 文件补充，其中包含用于确定分配最多内存的位置的更多信息。Massif 运行程序的速度比正常速度慢 20 倍。

使用 valgrind 就像使用所需的开关运行应用程序并将其作为 valgrind 的输入一样简单：

```
valgrind --tool=memcheck ./myapplication -f foo -b bar 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-12-24T16:56:09.170

我非常怀疑，除了用另一个函数包装`malloc`和`free` [or `new`and `delete`] 之外的任何东西实际上都可以让你得到除了非常粗略的估计之外的任何东西。

问题之一是释放的内存只有在有很长的连续内存块时才能释放。通常发生的情况是整个堆都使用了“少量”内存，并且您找不到可以释放的大块。

您不太可能以任何简单的方式解决此问题。

顺便说一句，当您再次加载更多负载时，您的应用程序可能会需要这 50MB，因此释放它只是浪费精力。

（如果您不使用的内存用于其他用途，它将被换出，并且长时间未触及的页面是主要候选者，因此如果系统在执行某些其他任务时内存不足，它仍然会为该空间重用您机器中的 RAM，因此它不会浪费在那儿 - 只是您不能使用 'ps' 或诸如此类的东西来确定程序使用了多少内存！）

正如评论中所建议的：您还可以编写自己的内存分配器，`mmap()`用于创建一个“块”来分配部分。如果你有一段代码做了很多内存分配，然后所有这些肯定会在以后被释放，从一个单独的内存块中分配所有这些，当它全部被释放时，你可以把 mmap' d 区域回到“空闲`mmap`列表”，当列表足够大时，释放一些`mmap`分配[这是为了避免调用 mmap LOTS 多次，然后`munmap`几毫秒后再次]。但是，如果您曾经让其中一个内存分配“逃逸”出您的围栏区域，您的应用程序可能会崩溃（或者更糟糕的是，不会崩溃，而是使用属于应用程序其他部分的内存，您会得到一个非常某处奇怪的结果，例如一个用户看到了应该为另一个用户提供的网络内容！）

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-12-24T16:52:56.880

`free`当您调用或时，操作系统通常不会释放内存`delete`。此内存返回运行时库中的堆管理器。

如果你想真正释放内存，你可以使用`brk`. 但这会打开一大堆内存管理蠕虫。如果你直接打电话`brk`，你最好不要打电话`malloc`。对于 C++，您可以覆盖直接`new`使用`brk`。

这不是一件容易的事。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-12-24T17:45:39.230

最新的 dlmalloc() 有一个称为 mspace 的概念（其他人称之为区域）。您可以针对 mspace 调用 malloc() 和 free()。或者您可以删除 mspace 以立即释放从 mspace 分配的所有内存。删除 mspace 将从进程中释放内存。

如果您创建一个带有连接的 mspace，从该 mspace 为该连接分配所有内存，并在连接关闭时删除该 mspace，您将不会有进程增长。

如果您在一个 mspace 中有一个指针指向另一个 mspace 中的内存，并且您删除了第二个 mspace，那么正如语言律师所说“结果未定义”。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-12-24T16:51:04.300

使用 valgrind 查找内存泄漏：valgrind ./your_application

它将列出您分配内存的位置并且没有释放它。

我认为这不是 linux 问题，而是在您的应用程序中。如果您使用 «top» 监控内存使用情况，您将无法获得非常精确的使用情况。尝试使用 massif（valgrind 的工具）： valgrind --tool=massif ./your_application 以了解实际内存使用情况。

作为避免 C++ 泄漏的更一般规则：使用智能指针而不是普通指针。同样在许多情况下，您可以使用 RAII (http://en.wikipedia.org/wiki/Resource_Acquisition_Is_Initialization) 而不是使用“new”分配内存。

# c++ - 如何为与其类内联创建的对象提供模板参数？

> ID：14023820
> 
> 赞同：8
> 
> 时间：2012-12-24T16:47:22.357
> 
> 标签：c++, templates, c++11, template-meta-programming

我知道在 C++ 中我们可以这样做：

```
class A {} a; 
```

这将创建一个`A`名为的类型的对象`a`。它相当于：

```
A a; 
```

我想知道如何使用模板来做到这一点。例如：

```
template <typename T> struct N {} <int> n; 
```

这不会编译，但你明白了。如何将模板参数指定给与其类定义内联创建的对象？这甚至可能吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-24T17:42:48.823

根据标准，关闭后的东西`}`称为an `init-declarator-list`。

14.3 明确禁止在模板类声明中使用它们：

> 在模板声明、显式特化或显式实例化中，声明中的 init-declarator-list 最多应包含一个声明符。**当这样的声明用于声明类模板时，不允许使用任何声明符。**

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-24T17:39:09.910

我不认为你能做到这一点。根据我的理解，你提到的结构和类的形式是为了与 c 向后兼容而保留的——你可以在结构和类中做到这一点。
好主意，不过:)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-24T17:42:47.697

即使所有模板参数都有默认值，您也不能从模板定义中声明变量。

这也是一个错误：

```
template <typename T = int> struct N {} n; 
```

*   [http://ideone.com/vFlIEg](http://ideone.com/vFlIEg)

# php - php mongodb '$or' 正则表达式搜索

> ID：14023821
> 
> 赞同：4
> 
> 时间：2012-12-24T16:47:44.007
> 
> 标签：php, regex, mongodb

我正在尝试查询 mongodb“视频”集合以通过“标题”或“标签”字段查找结果......即使我搜索我知道在标题和/或标签中的术语，它也会不断返回 0 个结果......任何帮助，将不胜感激

```
<?php
$user_query = preg_replace("/[[:blank:]]+/"," ", $_GET['q']);
$arr_query = explode(' ', $user_query);

foreach ($arr_query as $q) {
    $title[] = '/'. $q .'/i';
    $tags[] = '/'. $q .'/i';
}
$who=array(
   '$or' => array(
        array('$in' => array('$regex' => $title)),
        array('$in' => array('$regex' => $tags))
            )
    );

$vids=$videos->find($who);
?> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-10-16T06:11:54.577

```
$search_string = preg_replace("/[^A-Za-z0-9]/", " ", $_GET['q']);
$search_string = $search_string;

    //Connecting mongoDB
    $dbhost = 'localhost';
    $dbname = 'yourdbname';
    $port = '27017';

    $m = new MongoClient();
    $db = $m->$dbname;

    if($m){
        // select a collection
        $videos = $db->videos;

        // search for title and tags 
        $searchQuery = array(
            '$or' => array(
                array(
                    'title' => array(
                        '$regex' => $search_string,
                        ),
                    ),
                array(
                    'tags' => array(
                        '$regex' => $search_string,
                        ),
                    ),
                )
            );

        $cursor = $videos->find($searchQuery);

        foreach ($cursor as $doc) {
            var_dump($doc);
            //or what ever you want
            //var_dump($doc['title']);
        }

    else{
       echo "Collection videos cant select :( <br>";die();
    } 
```

认为这会有所帮助。:D

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-24T17:15:20.067

您需要为您指定一些字段`$in`：

```
$who=array('$or' => array(
    array('somefield' => array('$in' => array(new MongoRegex($title)))),
    array('otherotherfield' => array('$in' => array(new MongoRegex($tags))))
)); 
```

所以它的工作原理是：*如果某个字段在某个值的范围内*

[http://docs.mongodb.org/manual/reference/operator/in/](http://docs.mongodb.org/manual/reference/operator/in/)

### 编辑

由于嵌入式`$regex`. 如果是这种情况，那么您可以尝试：

```
$who=array('$or' => array(
    array('somefield' => new MongoRegex($title)),
    array('otherotherfield' => new MongoRegex($tags))
)); 
```

### 编辑

如果这些查询中的任何一个都不起作用，您可以执行以下操作：

```
$who = array('$or' => array());

foreach($arr_query as $q){
    $who['$or'][] = array('title' => new MongoRegex("/^$q/"));
    $who['$or'][] = array('tags' => new MongoRegex("/^$q/"));
} 
```

像这样的东西应该可以工作，它再次未经测试，但如果我的记忆对我有帮助，应该这样做。

### 另一个编辑

这对我来说非常有效：

```
$mongo = new Mongo();
$db = $mongo->tstvid;
$videos = $db->videos;

$videos->insert(array('title' => 'test1', 'tags' => array('h','h')));
$videos->insert(array('title' => 'test2', 'tags' => array('h','h')));
$videos->insert(array('title' => 'test3', 'tags' => array('h','h')));
$videos->insert(array('title' => 'tst3', 'tags' => array('h','test')));

$user_query = preg_replace("/[[:blank:]]+/"," ", "test");
$arr_query = explode(' ', $user_query);

if (count($arr_query) > 1) {

    $who = array(
        '$or' => array()        
    );

    foreach ($arr_query as $q) {
        $who['$or'][] = array('title' => new MongoRegex("/^". $q ."/i"));
        $who['$or'][] = array('title' => new MongoRegex("/^". $q ."/i"));
    }

} else {
    $regex=new MongoRegex("/^". $user_query ."/i");
    $tregex=new MongoRegex("/^". $user_query ."/i");
    $who=array(
                '$or' => array(
                    array('title' => $regex),
                    array('tags' => $tregex)
                    )
            );
}

$vids=$videos->find($who);
$results="";
$i=0;
foreach($vids as $vid){
    $results .= "<li>".$vid['title']."</li>\n";
    $i++;
}
if($i==0){
    $results="<em>No results found</em>";
}

echo $results; 
```

它输出：

```
test1
test2
test3
tst3 
```

所以我不确定出了什么问题，但我建议仔细检查您的脚本是否正确分解了关键字，并且通过在控制台中发出这些查询来正确搜索架构。

应该注意的是，我也尝试过：

```
$user_query = preg_replace("/[[:blank:]]+/"," ", "test h"); 
```

它也很有效。

# google-maps - Windows 窗体应用程序中的 Google Maps API Webservice 使用

> ID：14023824
> 
> 赞同：0
> 
> 时间：2012-12-24T16:48:02.820
> 
> 标签：google-maps

我的要求是这个。我需要使用 Google Maps API 获取给定地址的纬度和经度。我在 Google Developers 站点中发现了以下 Web 服务，它以地址为输入并返回给定站点的大量信息，其中还包括纬度和经度。我通过在浏览器中 执行[此 URL来检查这一点。](http://maps.googleapis.com/maps/api/geocode/xml?address=Hollywood%20International%20Airport%20%28FLL%29,Fort%20Lauderdale,FL,USA,33315&sensor=false)

纬度和经度信息位于几何/位置部分。我想在基于 Windows 的应用程序中使用此 Web 服务，并通过每次循环将不同站点信息传递给此 Web 服务来获取不同站点的纬度和经度。我该怎么做？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-24T16:56:40.740

看起来您将不得不建立一个静态站点列表来遍历它们并相应地修改 url，或者为用户请求的站点组装相同的 url。

此外，您还需要一个 XML 解析器：http: [//msdn.microsoft.com/en-us/library/9d83k261.aspx](http://msdn.microsoft.com/en-us/library/9d83k261.aspx)

# c - 从文件中获取结构的输入并在 C 中打印

> ID：14023827
> 
> 赞同：1
> 
> 时间：2012-12-24T16:48:12.210
> 
> 标签：c, file, structure, printf, scanf

当我尝试打印expectedRuntime 变量时，它会打印expectedRuntime 的地址。但我可以正确打印 timeOfSubmission 变量。谁能帮帮我？

```
struct process
{
int timeOfSubmission;
int remainingRunTime;
int expectedRunTime;
char processName[20];

};

int main()
{
FILE *myInput;
myInput = fopen("input.txt", "r+");
while ( !feof(myInput) )
{

    struct process * newProcess=(struct process *)malloc(sizeof(struct process));

    fscanf(myInput, "%s", newProcess->processName);
    fscanf(myInput, "%d", & (newProcess->expectedRunTime) );
    (newProcess->expectedRunTime)=(newProcess->remainingRunTime);
    fscanf(myInput, "%d", & (newProcess->timeOfSubmission) );
    printf("%s    ",newProcess->processName);
    fflush(stdout);
    printf("%d    ",newProcess->expectedRunTime);
    fflush(stdout);
    printf("%d  \n",newProcess->timeOfSubmission);
    fflush(stdout); 
}
return 0;
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-24T16:51:42.443

阅读后`newProcess->expectedRunTime`，您将使用以下内容覆盖它：

```
fscanf(myInput, "%d", & (newProcess->expectedRunTime) );
(newProcess->expectedRunTime)=(newProcess->remainingRunTime); 
```

其中有垃圾，因为没有写入任何内容`newProcess->remainingRunTime`。

# gnuplot - 在 gnuplot 中解析输入列

> ID：14023829
> 
> 赞同：0
> 
> 时间：2012-12-24T16:48:18.403
> 
> 标签：gnuplot

我是 Gnuplot 新手，我正在尝试从输入的 .dat 文件构建图表。我的 .dat 文件中的第一列是一个类似于“内部版本号”的数字，我试图将这些数字用作其中一列的值。

对于这个 .dat 文件：

```
#Version-Number     Average-Error       Average-Performance 
1                       4.100333            41.76998            
2                       4.100333            41.76998 
```

我得到正确的第 1 列和第 2 列。

但是对于这个 .dat 文件：

```
#Version-Number     Average-Error       Average-Performance 
0.80.0.17598        4.100333            41.76998            
0.80.0.17599        4.100333            41.76998 
```

我得到如下列：0.792 0.794 0.796... 而我正在寻找的值（4.100333）落在 0.8 上。

这是我拥有的 .dat 文件：（称为 CompareResults.dat）

```
#Version-Number    Average-Error       Average-Performance 
0.80.0.17598        4.100333            41.76998            
0.80.0.17599        4.100333            41.76998            
0.80.0.17602        4.100333            41.76998            
0.80.0.17622        4.100333            41.76998 
```

我附上了我的代码。

```
set terminal wxt size 1000,800
set multiplot layout 2, 1 title "Compare Graphs" font ",18"
set tmargin 2
set boxwidth 1 absolute
set style fill   solid 1.00 border lt -1
set grid nopolar
set grid noxtics nomxtics ytics nomytics noztics nomztics \
 nox2tics nomx2tics noy2tics nomy2tics nocbtics nomcbtics
set grid layerdefault   linetype 0 linewidth 1.000,  linetype 0 linewidth 1.000
set pointsize 2
set xtics border in scale 0,0 mirror norotate  offset character 0, 0, 0 autojustify
set xtics   ()
set ytics border in scale 0,0 mirror norotate  offset character 0, 0, 0 autojustify
set ztics border in scale 0,0 nomirror norotate  offset character 0, 0, 0 autojustify
set cbtics border in scale 0,0 mirror norotate  offset character 0, 0, 0 autojustify
set rtics axis in scale 0,0 nomirror norotate  offset character 0, 0, 0 autojustify
set title "Average Error Graph" font ",12"
set xlabel "Build Number" 
set ylabel "Average Error" 
set lmargin 8
set rmargin 4
set tmargin 4
set bmargin 4
plot 'CompareResults.dat' using 1:2 notitle with lines lc rgb "red" lw 3, '' using         1:2:2 with labels offset 1,0.5 notitle

set title "Performance Graph" font ",12"
set xlabel "Build Number" 
set ylabel "Performance" 
plot 'CompareResults.dat' using 1:3:xtic(1) notitle with lines lc rgb "green" lw 3, '' using 1:3:3 with labels offset 1,0.5 notitle
unset multiplot
reset 
```

非常感谢！！！伊丹。

# maven - 现在在将工件部署到archiva maven repo时在jenkins中获得401未经授权

> ID：14023836
> 
> 赞同：5
> 
> 时间：2012-12-24T16:48:43.003
> 
> 标签：maven, jenkins, maven-plugin, archiva

在我将 Jenkins 升级到 1.494 之前，这曾经有效。现在，当使用构建提升插件将战争工件复制到快照存储库时，我在 Jenkins 中收到此错误：

```
 ERROR: Failed to deploy artifacts: Could not transfer artifact com.blah.data:RestWebServices:war:1.0-20121224.163825-2 from/to archiva.apache.snapshots (http://10.31.31.64:8080/archiva/repository/snapshots): Failed to transfer file: http://10.31.31.64:8080/archiva/repository/snapshots/com/blah/data/RestWebServices/1.0-SNAPSHOT/RestWebServices-1.0-20121224.163825-2.war. Return code is: 401, ReasonPhrase:Unauthorized.
org.apache.maven.artifact.deployer.ArtifactDeploymentException: Failed to deploy artifacts: Could not transfer artifact com.blah.data:RestWebServices:war:1.0-20121224.163825-2 from/to archiva.apache.snapshots (http://10.31.31.64:8080/archiva/repository/snapshots): Failed to transfer file: http://10.31.31.64:8080/archiva/repository/snapshots/com/blah/data/RestWebServices/1.0-SNAPSHOT/RestWebServices-1.0-20121224.163825-2.war. Return code is: 401, ReasonPhrase:Unauthorized.
    at org.apache.maven.artifact.deployer.DefaultArtifactDeployer.deploy(DefaultArtifactDeployer.java:141)
    at hudson.maven.reporters.MavenArtifactRecord.deploy(MavenArtifactRecord.java:190)
    at hudson.maven.RedeployPublisher.perform(RedeployPublisher.java:173)
    at hudson.plugins.promoted_builds.Promotion$RunnerImpl.build(Promotion.java:187)
    at hudson.plugins.promoted_builds.Promotion$RunnerImpl.doRun(Promotion.java:141)
    at hudson.model.AbstractBuild$AbstractBuildExecution.run(AbstractBuild.java:586)
    at hudson.model.Run.execute(Run.java:1543)
    at hudson.model.Run.run(Run.java:1489)
    at hudson.plugins.promoted_builds.Promotion.run(Promotion.java:106)
    at hudson.model.ResourceController.execute(ResourceController.java:88)
    at hudson.model.Executor.run(Executor.java:236)
Caused by: org.sonatype.aether.deployment.DeploymentException: Failed to deploy artifacts: Could not transfer artifact com.blah.data:RestWebServices:war:1.0-20121224.163825-2 from/to archiva.apache.snapshots (http://10.31.31.64:8080/archiva/repository/snapshots): Failed to transfer file: http://10.31.31.64:8080/archiva/repository/snapshots/com/blah/data/RestWebServices/1.0-SNAPSHOT/RestWebServices-1.0-20121224.163825-2.war. Return code is: 401, ReasonPhrase:Unauthorized.
    at org.sonatype.aether.impl.internal.DefaultDeployer.deploy(DefaultDeployer.java:280)
    at org.sonatype.aether.impl.internal.DefaultDeployer.deploy(DefaultDeployer.java:211)
    at org.sonatype.aether.impl.internal.DefaultRepositorySystem.deploy(DefaultRepositorySystem.java:443)
    at org.apache.maven.artifact.deployer.DefaultArtifactDeployer.deploy(DefaultArtifactDeployer.java:137)
    ... 10 more
Caused by: org.sonatype.aether.transfer.ArtifactTransferException: Could not transfer artifact com.blah.data:RestWebServices:war:1.0-20121224.163825-2 from/to archiva.apache.snapshots (http://10.31.31.64:8080/archiva/repository/snapshots): Failed to transfer file: http://10.31.31.64:8080/archiva/repository/snapshots/com/blah/data/RestWebServices/1.0-SNAPSHOT/RestWebServices-1.0-20121224.163825-2.war. Return code is: 401, ReasonPhrase:Unauthorized.
    at org.sonatype.aether.connector.wagon.WagonRepositoryConnector$4.wrap(WagonRepositoryConnector.java:951)
    at org.sonatype.aether.connector.wagon.WagonRepositoryConnector$4.wrap(WagonRepositoryConnector.java:941)
    at org.sonatype.aether.connector.wagon.WagonRepositoryConnector$PutTask.run(WagonRepositoryConnector.java:837)
    at org.sonatype.aether.connector.wagon.WagonRepositoryConnector.put(WagonRepositoryConnector.java:467)
    at org.sonatype.aether.impl.internal.DefaultDeployer.deploy(DefaultDeployer.java:274)
    ... 13 more
Caused by: org.apache.maven.wagon.TransferFailedException: Failed to transfer file: http://10.31.31.64:8080/archiva/repository/snapshots/com/blah/data/RestWebServices/1.0-SNAPSHOT/RestWebServices-1.0-20121224.163825-2.war. Return code is: 401, ReasonPhrase:Unauthorized.
    at org.apache.maven.wagon.shared.http4.AbstractHttpClientWagon.put(AbstractHttpClientWagon.java:613)
    at org.apache.maven.wagon.shared.http4.AbstractHttpClientWagon.put(AbstractHttpClientWagon.java:509)
    at org.apache.maven.wagon.shared.http4.AbstractHttpClientWagon.put(AbstractHttpClientWagon.java:490)
    at org.apache.maven.wagon.shared.http4.AbstractHttpClientWagon.put(AbstractHttpClientWagon.java:470)
    at org.sonatype.aether.connector.wagon.WagonRepositoryConnector$PutTask.run(WagonRepositoryConnector.java:811)
    ... 15 more 
```

我在 settings.xml 文件中有信誉：

```
<server>
      <id>snapshots</id>
      <username>deployment</username>
      <password>deployment</password>
    </server> 
```

不知道为什么这突然停止使用 1.494。我逐渐降级到 1.491，但它仍然发生。非常令人沮丧。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-12-26T03:41:57.350

您已经通过降级证明了自己这不是纯粹的 Jenkins 问题。由于密码位于 settings.xml 中，请尝试在 Jenkins 中运行它`mvn help:effective-settings`。这将为您提供运行时的确切设置以及密码是否存在。

还可以尝试检查您的`<id>snapshots</id>`和的拼写`<username>deployment</username>`。我今天刚刚在某个地方遇到了这个错误，一个用户而`releases`不是`release`maven 给出了**禁止**的错误

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-24T18:59:07.273

我建议安装[Config File Provider 插件](https://wiki.jenkins-ci.org/display/JENKINS/Config+File+Provider+Plugin)，它提供了一个很好的 GUI 用于编辑配置文件的内容（例如 Maven 设置文件）

配置构建时，使用“-s”选项告诉 Maven 使用以下配置文件之一：

```
mvn -s $MY_PROJECTS_MAVEN_SETTINGS ??? 
```

这种方法的优点是您可以确定构建正在使用您的设置，而不是一些随机文件，它可能会从文件系统中删除。第二个好处是每个项目现在可以轻松地拥有自己特定的 Maven 设置（例如，每个项目很可能有不同的凭据）。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-01-02T15:14:04.900

我想出了如何解决这个问题，但我仍然不知道它是如何开始的。

我在 Archiva 中创建了第三个用户，并将其设置为用户不必在第一次登录时更改密码。然后我用那个新用户更新了 Jenkins 中的 settings.xml。

现在可以了。

我仍然不知道为什么它停止与原始用户合作。

感谢大家的帮助。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-07-04T12:33:33.530

感谢您跟进解决方案 Oggie。我刚刚遇到了同样的症状，并且已经克服了你的新用户修复。

更多信息：我能够通过删除旧用户并使用完全相同的用户名和密码创建一个新用户来使旧用户名和密码正常工作。（尽管我在此过程中尝试了一个具有相同/不同密码的新用户）。

至于原因……我不太清楚。我们在与 UberSVN 相同的机器上运行 Archiva，我们的 Jenkins 作为插件位于 UberSVN 中。没有对其中任何一个进行升级。然而，对服务器上的各种目录进行了许多所有权更改，尽管我看不出这些是原因，因为解决方案是简单地创建一个新用户。

再次感谢您的帖子。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2017-11-15T09:10:34.320

`RepositoryManager`在重新创建我的 Archiva 存储库后，我错过了为部署用户提供角色。添加角色后，解决了上传神器时的401。

请参阅[Archiva 用户指南](http://archiva.apache.org/docs/1.4-M4/userguide/deploy.html)。

# asp.net-mvc-4 - ASP.net MVC 捆绑不更新

> ID：14023838
> 
> 赞同：0
> 
> 时间：2012-12-24T16:48:55.570
> 
> 标签：asp.net-mvc-4, iis-6, bundle

生产系统是带有通配符映射的 IIS 6，因此 MVC4 正在工作。

我正在捆绑我的应用程序的 js 文件。在我的本地主机和测试服务器上，我在调试（无捆绑）中运行，但在生产中我构建发布以捆绑和缩小。

我对 .js 文件进行了更改，重新构建并重新发布（文件系统发布），对 .js 的更改不会通过捆绑包完成。但是，如果我手动将未捆绑/未压缩的 .js 文件复制到生产 /Scripts 文件夹，它似乎会拾取它们。

BundleConfig.cs：

```
bundles.Add(new ScriptBundle("~/bundles/appJs").Include(
"~/Scripts/Time.js",
"~/Scripts/Expense.js"
)); 
```

.cshtml 文件

```
@Scripts.Render("~/bundles/appJs") 
```

我配置错误还是这是 IIS 6 的问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-21T23:08:38.193

它适用于我的 IIS 6 与 .NET 4.0 aspnet_isapi.dll 通配符映射。确保在设置时未选中验证标志。

这是 64 位还是 32 位服务器？我在 Windows Server 2008 64 位中遇到了类似的问题，但无法访问 2003 64 位服务器以查看那里是否也出现故障。

# wordpress - 如何使用两张不同的图像，一张作为缩略图，一张作为链接图像？

> ID：14023846
> 
> 赞同：0
> 
> 时间：2012-12-24T16:49:47.743
> 
> 标签：wordpress

我想在帖子中创建一个图片库，其中链接的图片（a href）与缩略图的 src 不同。不幸的是，WP 似乎完全无法做到这一点。有没有解决方案或插件？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-24T17:04:11.447

这个插件是你需要的：

[http://wordpress.org/extend/plugins/multiple-featured-images/](http://wordpress.org/extend/plugins/multiple-featured-images/)

# kinect - 将 3D 模型映射到 kinect 视频输出

> ID：14023848
> 
> 赞同：0
> 
> 时间：2012-12-24T16:50:16.453
> 
> 标签：kinect

我正在 Kinect 设备上做一个项目，我想知道如何将 3D 身体部位（如虚拟更衣室）映射到 kinect 输出视频流。这是我们最后一年项目中非常重要的部分。请我需要帮助。我期待着收到您的来信。

提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-24T20:16:25.250

这取决于，您可以使用不同类型的第二部分软件来创建动画头像。因为您需要在此处创建 3D 头像并为其设置动画。没有一个正确的答案。您需要检查如何将其与您的软件结合使用。

一个软件需要一个包含特定格式数据的文件，另一个只需要记录您的动作并创建可以放置皮肤的动画模型。

# c# - C# 编译器/链接器选项：CSC.exe，类似于 gcc 中的 --wrap？

> ID：14023850
> 
> 赞同：1
> 
> 时间：2012-12-24T16:50:32.483
> 
> 标签：c#, gcc

在 gcc 中，当我们指定`-Wl`,时`--wrap=function_name`，它会将所有对“function_name”的调用替换为“__wrap_function_name”，并期望用户提供“__wrap_function_name”的定义。它将原始方法重命名为“__real_function_name”。

这有助于挂钩源代码中的任何函数，当然我们可以根据需要调用真实方法。

C# 编译器/链接器中是否有类似的选项？我正在尝试覆盖托管 dll 中的一些函数。我有那个 dll 的源代码。我不能使用任何可用的模拟框架，因为我的方法是内部的和非虚拟的。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-24T16:55:03.747

不，我一般不知道 C# 或 Microsoft 实现中的任何此类功能。

如果你已经有了源代码，你能不能不适当地改变它？听起来您希望它比实际更具可扩展性 - 所以自己添加可扩展性挂钩。

# parsing - Prolog - 带有文件输入的 DCG 解析器

> ID：14023852
> 
> 赞同：12
> 
> 时间：2012-12-24T16:50:44.247
> 
> 标签：parsing, prolog, swi-prolog, dcg

作为项目的一部分，我需要编写一个解析器，它可以读取文件并解析成我可以在我的程序中使用的事实。

文件结构如下所示：

```
property = { el1 , el2 , ... }. 
```

我最终想要的是：

```
property(el1).
property(el2).
... 
```

我这样读我的文件：

```
main :-
       open('myFile.txt', read, Str),
       read_file(Str,Lines),
       close(Str),
       write(Lines), nl.

read_file(Stream,[]) :-
                       at_end_of_stream(Stream).

read_file(Stream,[X|L]) :-
                          \+ at_end_of_stream(Stream),
                          read(Stream,X),
                          parse(X),            % Here I call upon my parser.
                          read_file(Stream,L). 
```

现在我已经阅读了几本关于 DCG 的书籍和在线内容，但它们都解释了相同的简单示例，您可以在这些示例中生成诸如“猫吃蝙蝠”之类的句子……当我想将它用于上述示例时，我惨遭失败.

我所做的是“解析”下一行：

```
property = el1. 
```

到

```
property(el1). 
```

有了这个：

```
parse(X) :-
           X =.. List,    % Reason I do this is because X is one atom and not a list.
           phrase(sentence(Statement), List),
           asserta(Statement).

sentence(Statement) --> ['=', Gender, Person] , { Statement =.. [Gender, Person] }. 
```

我什至不知道我是否在这里以正确的方式使用了 dcg，因此我们将不胜感激。现在我遇到的问题是，如何处理列表中的多个元素，以及如何处理“{”和“}”。
我真正想要的是一个可以处理这些类型的句子（超过 2 个元素）的 dcg：![句子分成几部分](../Images/d33f2f69e4ca3184278b6dff871aceca.png)

现在我知道这里的很多人在谈到 dcgs 时都会参考 dcg_basics 和 pio 库。但是，我还有一个问题，当我尝试使用该库时，我收到错误：

```
ERROR: (c:/users/ldevriendt/documents/prolog/file3.pl:3):
      Type error: `text' expected, found `http/dcg_basics'
Warning: (c:/users/ldevriendt/documents/prolog/file3.pl:3):
      Goal (directive) failed: user:[library(http/dcg_basics)] 
```

当我这样做时：

```
:- [library(http/dcg_basics)]. 
```

附加信息：

*   我在 Windows 环境中使用程序：[SWI-Prolog-Editor 。](http://lakk.bildung.hessen.de/netzwerk/faecher/informatik/swiprolog/indexe.html)

对此的任何帮助将不胜感激！

**编辑：**这个问题的目的是了解更多关于 DCG 及其在解析器中的使用。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-12-24T18:01:02.800

只要您的文件是纯 Prolog 语法，建议您使用 Prolog 术语 IO。*一次*调用即可读取完全结构化的术语。使用 DCG 的方式更复杂，效率也更低（这里不确定，应该测量，但是 read(Term) 调用了用 C 实现的 Prolog 解析器......）请参阅另一个[问题](https://stackoverflow.com/questions/14014602/read-file-and-construct-facts-in-prolog)，它使用相同的格式（至少，你可以检查一下其他人是否在这里得到了关于你同样任务的答案......）

*评论后编辑*...

你说得对，DCG 是在 Prolog 中处理一般解析的*正确方法。*DCG 产生式中的参数可以看作是语义属性，因此 DCG 编程可以看作是对输入提供*有效*的语义分析（参见[属性语法](http://en.wikipedia.org/wiki/Attribute_grammar)，也是语言工程中的一项重要技术）。

事实上，所提供的示例可以很好地解决，而无需使用术语 IO 所需的技巧。

这里是：

```
:- use_module(library(pio)).  % autoload(ed), added just for easy browsing
:- use_module(library(dcg/basics)).

property(P) -->
    b, "my props", b, "=", b, "{", elS(Es) , b, "}", b,
    { P =.. [property|Es] }.

elS([E|Es]) --> el(E), b, ("," -> elS(Es) ; {Es = []}).
el(N) --> number(N).
el(S) --> csym(S). % after Jeremy Knees comment...
b --> blanks.

%   parse a C symbol
csym(S) -->
    [F], { code_type(F, csymf) },
    csym1(Cs),
    !, { atom_codes(S, [F|Cs]) }.

csym1([C|Cs]) -->
    [C], { code_type(C, csym) },
    csym1(Cs).
csym1([]) --> []. 
```

有了这个，我们有

```
?- phrase(property(P), "my props = {1,2,3}").
P = property(1, 2, 3). 
```

感谢 library( [pureio](https://www.swi-prolog.org/pldoc/man?section=pio) )，我们可以将语义编程应用于 Prolog 流，并获得与短语/2 相同的行为的奖励。

*更多的*

这个[另一个答案](https://stackoverflow.com/a/7828855/874024)显示了一种实现具有运算符解析和惰性求值的表达式计算器的实用方法。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-26T04:45:31.173

嗯，家庭作业问题的目的是学习。用 DCG 来做这件事会教你一个比操纵操作员更普遍有用的技能。

我认为您的问题与 DCG 本身的问题相比，与字符串处理相比要少。

您有很多地方可以使用 univ（=.. 运算符）在列表和字符串之间进行转换。大学可能不是你想要的。Univ 将术语与列表统一起来。

```
foo(bar, baz)  =..  [foo, bar, baz] 
```

您需要了解的是，Prolog 中的字符串可以有几种不同的形式字符串 'hi Flores' 可能是

'嗨弗洛雷斯' - 这是一个原子 - 一个'固体块'的东西。某些字符序列不需要单引号（请参阅您的书），因此 hi_flores 是一个没有单引号的完美原子。

```
[104,105,32,70,108,111,114,101,115] - a list of ASCII codes.  This is likely what you want. These can be written with double quotes, "hi Floris"  in prolog code.

To save your sanity, put

:- portray_text(true). 
```

在您的文件中，因此它在调试中打印出“hi Floris”，而不是一堆数字。

还有一个字符原子列表

[h, i, ' ', 'F', l, o, r, i, s]

但你可能不想要那些。

您可能会发现 SIICSTUS 兼容性 pred read_line 很有用。

现在，在 DCG 中，您有时想要匹配“文字”——字面意思就是那个东西。如果是这样，请将其放入列表中。这是一些模糊的 VBish 语言中 if 语句的 DCG

```
if_statement  --> "if", wh, "(", condition, ")", wh, 
                  "then", wh, body, wh, "else", wh,
                  else_body, wh, "endif".

% whitespace
wh -->  [].
wh -->  " ", wh.
wh --> [10], wh.   % handle newline and cr
wh --> [12], wh. 
```

w 到处都是可选的空格。

现在，对于整体策略，您可以一次读取一行，也可以读取整个文件。对于一行，使用 read_line，它返回代码列表。read_file_to_codes 将获取整个文件。

如果您使用整个文件策略，并且换行符很重要，那么显然您需要将它们从空格的定义中删除。

而且，当然，所有这些都导致了一个问题，为什么关于这个问题的问题充斥着 SO 而不是讲师的盒子。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-04T07:58:20.127

我将字符串解析成一个列表，然后操作该列表。使用 DCG，您可以转换

```
T = (saf>{saf, as13s}>a32s>asf). 
```

到

```
S = [saf-0, saf-1, as13s-1, a32s-2, asf-3] . 
```

注意事项：

```
1\. parseLine(<<Yourpattern>>,Position) --> parseLine(L,Position), parseLine(R,NewPosition)
2\. parseLine(Item,Pos) --> [Item-Pos]. 
```

在这里，您有 2 种模式可以处理，即 (L>R) 和 {L,R}。这不会很复杂，而且很容易阅读。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-28T09:06:52.343

恕我直言，DCG 语法规则在标记化方面非常难看，我真的认为 DCG 甚至不应该被提议用于该任务；与 DCG 的真正交易是解析令牌，因为 prolog 使用符号，所以我可以说，最好的选择是创建一个对 a 的外部调用，比如 C 令牌生成器，它将与普通令牌列表统一，然后让 DCG做它一直以来的事情。这样实现更干净，您不必担心解析 cr，空白......

假设你有一个假设的语言，它的语句如下所示：

```
object:
       object in a yields b,
       object in b yields C. 
```

我什至不想想象在 DCG 中对此进行标记；我懒得学习如何使用不是为此类任务设计的工具来做到这一点。更好的是对谓词进行外部调用，该谓词将为我提供简单的令牌列表。

```
 tokenize(A,ListOfTokens), phrase(yourDGCstartRule(Information), ListOfTokens, _). 
```

我们正在运行的示例的列表如下所示：

```
ListOfTokens = [object,:,object,in,a,yields,b,',',object,in,b,yields,c]. 
```

我认为这要优雅得多，并且您的规则会相应地映射。我的想法可能是错误的，但归根结底这是一个品味问题，对我来说，DCG 不是标记器，除非严格要求，否则我永远不会使用它。诚然，我可以发现一些应用程序也可以将其用作标记器，但我仍然认为任务应该分开。

请注意，我并不是说 prolog 没有很好的功能，您总是可以在 prolog 中进行标记，但您应该将任务分开，让 DCG 只处理符号和其他一些严格需要的字符或字符串（如大写字符串，如专有名称或其他字符）。

最后，在我看来，人们可能已经忘记了标记化和解析是两个独立的任务；更多在 prolog 中，因为令牌是 prolog 擅长的符号，并且解析令牌/符号（而不是字符）DCG 做得更好，因为嵌入语义接口 prolog 这是理想的场景。

# actionscript - Actionscript 3.0 机制：挖掘 ExternalInterface 和 _evalJS

> ID：14023859
> 
> 赞同：1
> 
> 时间：2012-12-24T16:51:31.407
> 
> 标签：actionscript, eval

这是ExternalInterface的反编译源：

[http://pastebin.com/B8c7keWL](http://pastebin.com/B8c7keWL)

_evalJS 为空，可能会在运行时稍后扩展。

这是魔术发生的地方：

`loc5 = _evalJS(loc1);`

_evalJS 保持提供的 eval 函数的上下文。

例如，我在 Actionscript 中调用了这段代码：

```
ExternalInterface.call('MyObject.innerObject.func',params); 
```

它`.func`仍然会知道它的初始上下文。

有人知道它是如何工作的吗？

这里有大师吗？:)

# python - 为什么我的函数只能看到我的一些全局变量？

> ID：14023861
> 
> 赞同：2
> 
> 时间：2012-12-24T16:51:39.603
> 
> 标签：python, scope

好的，我是 C、VisualBasic 和 Fortran 程序员（是的，我们仍然存在）。我错过了 Python 3.2 的一个范例。在下面的代码中，为什么我的函数`start_DAQ`看不到我所有的全局变量？`do_DAQ`该函数似乎为、`data_index`和生成了自己的局部变量`start_time`，但不是`store_button`。我已经阅读了几个类似问题的回复，但仍然不明白。我想我可以使用全局语句，但被告知这是不好的做法。

```
#-----------------------------------------------------------------------
#      define my globals
#-----------------------------------------------------------------------

#make an instance of my DAQ object and global start_time
myDaq = DAQ_object.DAQInput(1000,b"Dev2/ai0")
start_time = time.time()

#build data stuctures and initialize flags
time_data = numpy.zeros((10000,),dtype=numpy.float64)
volt_data = numpy.zeros((10000,),dtype=numpy.float64)
data_queue = queue.Queue()
data_index = 0
do_DAQ = False

#-----------------------------------------------------------------------
#      define the functions associated with the buttons
#-----------------------------------------------------------------------

def start_DAQ():
    do_DAQ = True
    data_index=0
    start_time = time.time()
    store_button.config(state = tk.DISABLED) 
```

下面是一些用于构建 GUI 的代码

```
#make my root for TK
root = tk.Tk()

#make my widgets
fr = tk.Frame()
time_label = tk.Label(root, text="not started")
volt_label = tk.Label(root, text="{:0.4f} volts".format(0))
store_button = tk.Button(root, text="store Data", command=store_DAQ, state = tk.DISABLED)
start_button = tk.Button(root, text="start DAQ", command=start_DAQ)
stop_button = tk.Button(root, text="stop DAQ", command=stop_DAQ)
exit_button = tk.Button(root, text="Exit", command=exit_DAQ) 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-12-24T16:54:26.027

将以下内容添加到您的函数中：

```
def start_DAQ():
    global do_DAQ 
    global data_index
    global start_time

    do_DAQ = True
    data_index=0
    start_time = time.time()
    store_button.config(state = tk.DISABLED) 
```

Python 在写入时实现名称隐藏在本地范围内。当您尝试读取全局（模块作用域变量）时，解释器会在越来越多的非局部作用域中查找变量名称。当您尝试写入时，会在本地范围内创建一个新变量，并隐藏全局。
我们添加的语句告诉解释器在写入时在全局范围内查找名称。还有一条`nonlocal`语句（在 python 3.* 中，不确定 2.7）让解释器在最近的 nolocal 范围内写入变量，而不仅仅是在模块范围内。

# python - Flask URL Route：将所有其他 URL 路由到某个函数

> ID：14023864
> 
> 赞同：15
> 
> 时间：2012-12-24T16:51:44.847
> 
> 标签：python, google-app-engine, url-routing, flask

我正在使用 Flask 0.9。我有使用 Google App Engine 的经验。

1.  在 GAE 中，url 匹配模式按照它们出现的顺序进行评估，先到先得。Flask中的情况是否相同？

2.  在 Flask 中，如何编写一个 url 匹配模式来处理所有其他不匹配的 url。在 GAE 中，你只需要放在`/.*`最后，比如：`('/.*', Not_Found)`. 由于 Flask 不支持 Regex，如何在 Flask 中做同样的事情。

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2012-12-24T17:00:12.063

这适用于您的第二个问题。

```
from flask import Flask

app = Flask(__name__)

@app.route('/')
def index():
    return 'This is the front page'

@app.route('/hello/')
def hello():
    return 'This catches /hello'

@app.route('/')
@app.route('/<first>')
@app.route('/<first>/<path:rest>')
def fallback(first=None, rest=None):
    return 'This one catches everything else' 
```

`path`会抓住一切直到最后。[更多关于变量转换器的信息](https://flask.palletsprojects.com/en/1.1.x/api/#url-route-registrations)。

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2012-12-24T16:57:56.243

1.  我认为这是答案[http://flask.pocoo.org/docs/design/#the-routing-system](http://flask.pocoo.org/docs/design/#the-routing-system)
2.  如果您需要处理服务器上未找到的所有 url — 只需创建 404 处理程序：

    ```
    @app.errorhandler(404)
    def page_not_found(e):
        # your processing here
        return result 
    ```

# c# - Ninject 将多个实现绑定到一个接口

> ID：14023869
> 
> 赞同：1
> 
> 时间：2012-12-24T16:52:24.420
> 
> 标签：c#, dependency-injection, inversion-of-control, ninject

我正在查看本教程，但不太了解如何创建一个可以为我提供接口的单独实现的工厂。

[http://stefanoricciardi.com/2011/01/21/ninject-mini-tutorial-part-1/](http://stefanoricciardi.com/2011/01/21/ninject-mini-tutorial-part-1/)

```
public class IJob {
  ...
}

public class JobImpl1 : IJob {
  ...
}

public class JobImpl2 : IJob {
  ...
}

using (IKernel kernel = new StandardKernel()) {
    kernel.Bind<IJob>().To<JobImpl2>(); 
    var job = kernel.Get<IJob>();
} 
```

我的目标是创建一个包装这个 Ninject Kernel 的工厂类，这样我就可以根据我是在单元测试环境还是实时环境中提供不同的 IJob 接口实现。但是，我还想将 Ninject 隐藏在工厂包装器中，以便其余代码不依赖于 Ninject。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-24T17:28:05.517

有一个单独的扩展[Ninject.Extensions.Factory](https://github.com/ninject/ninject.extensions.factory)允许您基于*接口动态生成**抽象工厂实现*

 *## 内核配置

```
var kernel = new StandardKernel();

// wire concrete implementation to abstraction/interface
kernel.Bind<IJob>().To<JobImpl1>()
    .NamedLikeFactoryMethod<IJob, IJobFactory>(f => f.GetJob());

// configure IJobFactory to be Abstract Factory
// that will include kernel and act according to kernel configuration    
kernel.Bind<IJobFactory>().ToFactory(); 
```

## 使用内核在运行时解析*抽象工厂*

```
// get an instance of Abstract Factory
var abstractFactory = kernel.Get<IJobFactory>();

// resolve dependency using Abstract Factory
var job = abstractFactory.GetJob() 
```

## 抽象工厂接口

```
public interface IJobFactory
{
    IJobFactory GetJob();
} 
```*

# ruby-on-rails - 如何正确定义我的关联？

> ID：14023873
> 
> 赞同：1
> 
> 时间：2012-12-24T16:52:50.507
> 
> 标签：ruby-on-rails, ruby-on-rails-3, associations

为什么这段代码会返回错误？
是因为我的关联来自`Community`还是`CommunityTopics`没有正确设置？

> nil:NilClass 的未定义方法“user_profile”

```
 <% @community.community_topics.each do |topic| %>
    <li>
    <%= link_to topic.user.user_profile.nickname, community_topic_path(@community, topic) %>
    </li>
  <% end %> 
```

我有4个模型，例如

1.  用户
2.  UserProfile（始终与用户一对一设置）
3.  社区
4.  社区话题

    *   用户可以根据需要创建社区。
    *   用户可以根据需要将主题发布到任何社区。

这种情况下的关联应该是怎样的？
我的说法好吗？？

**用户**

```
has_one :user_profile
has_many :communities
has_many :community_topics 
```

**用户资料**

```
belongs_to :user 
```

**社区**

```
belongs_to :user
has_many :community_topics 
```

**社区话题**

```
belongs_to :user
belongs_to :community 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-24T17:17:15.967

您的联想似乎没有问题，`topic.user`至少其中一个主题为零。如果`CommunityTopic`应该总是有一个`user`，您将需要实现一个验证（和 NOT NULL 数据库约束）以确保该类上存在用户关联并清理任何现有数据。否则，您将需要进行防御性编码，例如：

```
<%= link_to topic.user.user_profile.nickname, community_topic_path(@community, topic) if topic.user %> 
```

# linux - 解决从虚拟机启动的 Flask 应用程序

> ID：14023875
> 
> 赞同：0
> 
> 时间：2012-12-24T16:52:58.433
> 
> 标签：linux, localhost, flask, virtualbox

我有以下问题：我有 OS xUbuntu，我用 VirtualBox 运行虚拟机。我的虚拟机上的操作系统是 Debian Wheezy。我有烧瓶应用程序。我想要做的是，当我从 VM（位于 127.0.0.1:5000）启动我的应用程序时，从我的主机（xUbuntu）在浏览器上运行它。

我怎么做？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-24T21:01:51.067

VirtualBox使用[一些策略](http://www.virtualbox.org/manual/ch06.html)来允许“来宾”VM（在您的情况下为 Debian Wheezy VM）访问您的“主机”计算机（在您的情况下为 xUbuntu）的网络。我将尝试为您简要概述每种方法，因为最后有几种方法可以做您想做的事情，并且您使用的策略可能针对您的情况。

# [NAT](http://www.virtualbox.org/manual/ch06.html#network_nat)

默认使用“NAT”（[网络地址转换](https://www.google.com/search?q=network%20address%20translation)），它基本上将您的主机设置为网络交换机，将您的所有访客图像置于“子网”下。虽然这使您的客人可以轻松访问您的网络和互联网，但它无法让您的主机轻松访问您的客人（尽管可以使用[NAT 端口转发](http://www.virtualbox.org/manual/ch06.html#natforward)）。换句话说，您的主机 IP 可能是 192.168.1.9，但您的访客 IP 将是 10.0.2.15。如果不设置端口转发，您将无法从主机连接到 10.0.2.15，只有来自访客的连接中的数据包才能找到返回访客的路径。

# [桥接网络](http://www.virtualbox.org/manual/ch06.html#idp11916480)

这使您的各种来宾虚拟机看起来好像它们是与您的主机位于同一网络上的计算机。换句话说，如果您的主机从您的路由器收到 192.168.1.100 的 IP，那么您的访客可能会获得 192.168.1.101。在这种情况下，两台计算机都可以使用这些 IP 地址相互通信。但是，这意味着如果没有路由器为主机和访客提供 IP 地址（例如，如果您在笔记本电脑上运行并且没有可连接的无线接入点），主机和访客将无法通信。这也意味着您的虚拟机可以接收外部流量，这可能会产生安全隐患。最后，由于您的路由器很可能通过 DHCP 为您设置 IP，因此您的访客 IP 可能会在您启动 VM 时更改，这可能会很烦人。

所以，像这样设置你的系统可能对你有用，只要你同意你的主机必须连接到路由器，数据包将通过路由器。

# [内部网络](http://www.virtualbox.org/manual/ch06.html#network_internal)

这意味着设置为“内部网络”的访客虚拟机除了与主机联系外，还可以在自己的网络上相互交谈。但是，我相信它不允许主机联系虚拟机，所以它可能不是你想要的。请注意，我在这方面没有太多经验。

# [仅主机网络](http://www.virtualbox.org/manual/ch06.html#network_hostonly)

这会在主机计算机上创建一个新接口，可用于在主机和来宾之间发送数据包。这意味着不需要路由器来分配 IP 地址。但是，这也意味着客人无法访问互联网，只能直接连接到主机。

# 选择哪个？

显然，做什么取决于你的情况。正如[Superuser 上的这个问题](https://superuser.com/questions/369213/virtualbox-network-configuration)所示，似乎没有一个好的选择。答案显示了一种解决方法：让访客使用两个单独的适配器以获得多种网络风格的好处。示例是使用一个适配器用于 NAT（它允许您的客人轻松访问互联网）和另一个用于 Host-Only（允许您的主机连接到您的客人）。

如果您在设置此设置时遇到问题，请考虑使用[VirtualBox 社区](https://www.virtualbox.org/wiki/Community)或[超级用户](https://superuser.com/)（对于特定于 VirtualBox 的问题，这比 StackOverflow 更好）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-24T17:21:16.970

如果主机和访客在网络中，那么您可以使用访客的 IP 地址访问应用程序。您可以使用“ifconfig”命令读取客户操作系统的 IP 地址，然后从主机的浏览器中使用 url 作为“abcd:5000”（abcd 将是您客户的 IP 地址）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2017-06-05T07:47:55.990

这个问题很老了，但是谷歌搜索这个问题首先把我带到了这里。

我发现这很完美：

`VBoxManage.exe modifyvm "VMnameInQuotes" --natpf1 "guestFlask,tcp,,5000,,5000"`

取自[http://dnfehren.github.io/blog/2012/07/20/use-python-flask-server-through-nat-virtualbox-guest/](http://dnfehren.github.io/blog/2012/07/20/use-python-flask-server-through-nat-virtualbox-guest/)

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-12-25T08:58:29.767

我解决了这个问题，就像[这里](http://www.callum-macdonald.com/2009/10/28/virtualbox-host-to-guest-networking/)解释的一样非常感谢大家的帮助！

# inversion-of-control - 从源代码构建 Autofac

> ID：14023876
> 
> 赞同：2
> 
> 时间：2012-12-24T16:53:32.970
> 
> 标签：inversion-of-control, autofac

如何从源代码构建 Autofac？我发现只有一个已弃用的 wiki 页面。

我尝试启动 go.cmd (.NET Framework 4.0)，但失败并出现错误：

```
 C:\Autofac\Autofac.csproj" (default target) (4) ->
    (CoreCompile target) ->
    Builder\MetadataConfiguration.cs(28,14): error CS0234: The type or namespace name 'Linq' does not exist in the namespace 'System' (are you missing an assembly reference?)
    [C:\Autofac\Core\Source\Autofac\Autofac.csproj] Features\LazyDependencies\LazyWithMetadataRegistrationSource.cs(28,14): error CS0234: The type or namespace name 'Linq' does not exist in the namespace 'System' (are you missing an assembly reference?) 
```

我做错了什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-25T15:45:34.933

Autofac 3.0 已更新，因此核心 Autofac.dll 是面向多个平台的可移植类库。可移植类库没有对系统程序集的引用，因此缺少的 System.Core 引用是正确的——它不应该存在。您应该能够将 Portable Class Library 与 .NET 4... 或 Windows Store 或 Windows Phone 8 应用程序一起使用。**我强烈建议不要修改 .csproj 的引用**。您会破坏这种兼容性并无意中更改目标配置文件。

从源代码构建的 wiki 页面已被弃用，因为构建说明位于源代码根目录的自述文件中。（在已弃用的 wiki 页面上提到了这一点 - 第一行。）它解释了所需的所有必备工具和命令。如果您按照其中的信息进行操作，则无需修改任何内容即可获取要构建的源代码。

如果您不修改源代码，我不确定您为什么需要重新构建源代码以专门针对 .NET 4。它应该可以工作。如果您发现某些东西无法正常工作，请[在 Autofac 网站上提出相关问题](https://code.google.com/p/autofac/issues/list)。

如果您正在修改源代码，那么其中的自述文件应该可以让您在不弄乱项目引用的情况下进行构建。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-24T22:29:33.353

看起来[Autofac.csproj](https://code.google.com/p/autofac/source/browse/Core/Source/Autofac/Autofac.csproj)不包含对 system.core 的引用。另请参阅[此问题](https://stackoverflow.com/a/3082458/33499)和[此错误报告](http://connect.microsoft.com/VisualStudio/feedback/details/665406/using-system-linq-without-reference-to-system-core-compiles-in-vs-but-not-with-msbuild-exe)。那么您可以尝试将其添加到 Autofac.csproj 文件中：

```
<ItemGroup>
    <Reference Include="System.Core" />
</ItemGroup> 
```

可能您还必须添加其他引用，例如`System`.

# c++ - C++11 随机数和 std::bind 以意想不到的方式交互

> ID：14023880
> 
> 赞同：8
> 
> 时间：2012-12-24T16:54:13.403
> 
> 标签：c++, gcc, random, c++11, stdbind

我正在使用 GCC 4.6.3 并尝试使用以下代码生成随机数：

```
#include <random>
#include <functional>

int main()
{
    std::mt19937 rng_engine;

    printf("With bind\n");
    for(int i = 0; i < 5; ++i) {
        std::uniform_real_distribution<double> dist(0.0, 1.0);
        auto rng = std::bind(dist, rng_engine);
        printf("%g\n", rng());
    }

    printf("Without bind\n");
    for(int i = 0; i < 5; ++i) {
        std::uniform_real_distribution<double> dist(0.0, 1.0);
        printf("%g\n", dist(rng_engine));
    }

    return 0;
} 
```

我希望这两种方法都能生成一个由 5 个随机数组成的序列。相反，这是我实际得到的：

```
With bind
0.135477
0.135477
0.135477
0.135477
0.135477
Without bind
0.135477
0.835009
0.968868
0.221034
0.308167 
```

这是 GCC 错误吗？还是与 std::bind 有关的一些微妙问题？如果是这样，你能理解结果吗？

谢谢。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-12-24T17:00:45.300

绑定时，会生成 rng_engine 的副本。如果你想传递一个参考，这就是你必须做的：

```
auto rng = std::bind(dist, std::ref(rng_engine)); 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-12-24T17:01:03.263

`std::uniform_real_distribution::operator()`需要 a`Generator &`所以你必须使用 std::ref绑定

```
#include <random>
#include <functional>

int main()
{
    std::mt19937 rng_engine;

    printf("With bind\n");
    for(int i = 0; i < 5; ++i) {
        std::uniform_real_distribution<double> dist(0.0, 1.0);
        auto rng = std::bind(dist, std::ref(rng_engine));
        printf("%g\n", rng());
    }

    printf("Without bind\n");
    for(int i = 0; i < 5; ++i) {
        std::uniform_real_distribution<double> dist(0.0, 1.0);
        printf("%g\n", dist(rng_engine));
    }
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2016-01-28T19:43:28.497

`bind()`用于重复使用。

把它放在循环之外......

```
std::mt19937 rng_engine;
std::uniform_real_distribution<double> dist(0.0, 1.0);
auto rng = std::bind(dist, rng_engine);

for(int i = 0; i < 5; ++i) {
    printf("%g\n", rng());
} 
```

...给了我预期的结果：

```
0.135477
0.835009
0.968868
0.221034
0.308167 
```

# asp.net - 在 asp.net-mvc 4 中合并一个 html-css 模板作为母版页

> ID：14023885
> 
> 赞同：0
> 
> 时间：2012-12-24T16:54:35.040
> 
> 标签：asp.net, .net, asp.net-mvc, c#-4.0, asp.net-mvc-4

我正在建立一个网站，并且想使用 MVC 4 来做。我不想使用自定义的 asp.net 模板，并且在线提供的 asp.net 模板不符合我的要求。我设计了一个 html-css 模板，需要将其合并到我的项目中......（如果你知道我的意思，我自己几乎构建了默认模板化 mvc 4 项目的“内容文件夹”）......

如果有人向我指出一个教程或给我一个关于如何做的逐步说明，我将非常感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-24T16:57:56.377

您几乎正在寻找如何将[布局和部分与 Razor](http://weblogs.asp.net/scottgu/archive/2010/12/30/asp-net-mvc-3-layouts-and-sections-with-razor.aspx)一起使用。您可以拥有任意数量的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-24T16:58:07.560

如果我理解正确，您只需要将模板应用于`_Layout.cshtml`. 这与 ASP.NET Web 表单中的 MasterPage 的用途相似。

这是关于布局和部分的[ScottGu 博客。](http://weblogs.asp.net/scottgu/archive/2010/12/30/asp-net-mvc-3-layouts-and-sections-with-razor.aspx)（刚刚注意到这与@ErikPhilips 提供的链接相同）

提供一个简单的解释。`_Layout.cshtml`居住在`Project\Views\Shared\_Layout.cshtml`。默认情况下，它看起来像一个普通的 HTML 文件，带有几行不寻常的行。最重要的是`@RenderBody()`。当`ViewResult`从动作（例如）返回 a 时，您的视图将在布局内部`return View("MyView, myModel)`呈现。`@RenderBody`你可以随心所欲地做你喜欢的事`_Layout.cshtml`，如果你够勇敢，你也可以嵌套布局。

# android - 安卓按钮选择器

> ID：14023886
> 
> 赞同：127
> 
> 时间：2012-12-24T16:54:57.843
> 
> 标签：android, selector

这是一个按钮选择器，正常时显示为红色，按下时显示为灰色。

我想问一下如何进一步直接修改代码，以便在按下时文本大小和颜色也可以改变？非常感谢！

```
<item android:state_pressed="true" >         
    <shape xmlns:android="http://schemas.android.com/apk/res/android"> 
        <stroke android:width="2dp" android:color="@color/black" />
        <solid android:color="@color/grey"/>
        <padding android:left="5dp" android:top="2dp" 
            android:right="5dp" android:bottom="2dp" /> 
        <corners android:radius="5dp" /> 
    </shape>    
</item>

<item>
    <shape xmlns:android="http://schemas.android.com/apk/res/android"> 
        <stroke android:width="2dp" android:color="@color/black" />
        <solid android:color="#FF6699"/>
        <padding android:left="5dp" android:top="2dp" 
            android:right="5dp" android:bottom="2dp" /> 
        <corners android:radius="5dp" /> 
    </shape>
</item> 
```

* * *

## 回答 #1

> 赞同：231
> 
> 时间：2012-12-24T17:11:44.040

你只需要在你`selector`的`button`布局文件中设置。

```
<Button
     android:id="@+id/button1"
     android:background="@drawable/selector_xml_name"
     android:layout_width="200dp"
     android:layout_height="126dp"
     android:text="Hello" /> 
```

并做了。

**编辑**

以下是`button_effect.xml`目录中的`drawable`文件

```
<?xml version="1.0" encoding="utf-8"?>
<selector xmlns:android="http://schemas.android.com/apk/res/android">

    <item android:drawable="@drawable/numpad_button_bg_selected" android:state_selected="true"></item>
    <item android:drawable="@drawable/numpad_button_bg_pressed" android:state_pressed="true"></item>
    <item android:drawable="@drawable/numpad_button_bg_normal"></item>

</selector> 
```

在这里，您可以看到有 3 个可绘制对象，您只需要将这种`button_effect`样式放置到您的`button`. 您只需要替换`selector_xml_name`为`button_effect`.

* * *

## 回答 #2

> 赞同：30
> 
> 时间：2012-12-24T17:47:37.020

您无法使用[状态列表 drawable](https://developer.android.com/guide/topics/resources/drawable-resource.html#StateList)来更改文本大小。要更改文本颜色和文本大小，请执行以下操作：

**文字颜色**

要更改文本颜色，您可以创建[颜色状态列表资源](https://developer.android.com/guide/topics/resources/color-list-resource.html)。它将是位于`res/color/`目录中的单独资源。在布局 xml 中，您必须将其设置为`android:textColor`属性的值。然后颜色选择器将包含如下内容：

```
<?xml version="1.0" encoding="utf-8"?>
<selector xmlns:android="http://schemas.android.com/apk/res/android">
    <item android:state_pressed="true" android:color="@color/text_pressed" />
    <item android:color="@color/text_normal" />
</selector> 
```

**字体大小**

您不能简单地使用资源来更改文本的大小。没有“尺寸选择器”。您必须在代码中执行此操作。并且没有直接的解决方案。

可能最简单的解决方案可能是[`View.onTouchListener()`](https://developer.android.com/reference/android/view/View.OnTouchListener.html)相应地利用和处理 up 和 down 事件。使用这样的东西：

```
view.setOnTouchListener(new OnTouchListener() {

        @Override
        public boolean onTouch(View v, MotionEvent event) {
            switch (event.getAction()) {
            case MotionEvent.ACTION_DOWN:
                // change text size to the "pressed value"
                return true;
            case MotionEvent.ACTION_UP:
                // change text size to the "normal value"
                return true;
            default:
                return false;
            }
        }
}); 
```

一个不同的解决方案可能是扩展视图并覆盖该`setPressed(Boolean)`方法。当按下状态发生变化时，该方法在内部被调用。然后在方法调用中相应地更改文本的大小（不要忘记调用超级）。

* * *

## 回答 #3

> 赞同：18
> 
> 时间：2015-10-14T05:46:18.183

在可绘制文件夹中创建 custom_selector.xml

```
<?xml version="1.0" encoding="utf-8"?>
<selector xmlns:android="http://schemas.android.com/apk/res/android">
   <item android:drawable="@drawable/unselected" android:state_pressed="true" />
   <item android:drawable="@drawable/selected" />
</selector> 
```

在可绘制文件夹中创建 selected.xml 形状

```
<shape xmlns:android="http://schemas.android.com/apk/res/android" android:shape="rectangle" android:padding="90dp">
   <solid android:color="@color/selected"/>
   <padding />
   <stroke android:color="#000" android:width="1dp"/>
   <corners android:bottomRightRadius="15dp" android:bottomLeftRadius="15dp" android:topLeftRadius="15dp" android:topRightRadius="15dp"/>
</shape> 
```

在可绘制文件夹中创建 unselected.xml 形状

```
<shape xmlns:android="http://schemas.android.com/apk/res/android" android:shape="rectangle" android:padding="90dp">
   <solid android:color="@color/unselected"/>
   <padding />
   <stroke android:color="#000" android:width="1dp"/>
   <corners android:bottomRightRadius="15dp" android:bottomLeftRadius="15dp" android:topLeftRadius="15dp" android:topRightRadius="15dp"/>
</shape> 
```

在 values 文件夹的 color.xml 中为选中/未选中状态添加以下颜色

```
<color name="selected">#a8cf45</color>
<color name="unselected">#ff8cae3b</color> 
```

**[你可以从这里](http://blog.nkdroidsolutions.com/android-button-selector-example/)**查看完整的解决方案

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2015-07-09T10:12:35.523

您可以使用以下代码：

```
<Button
    android:id="@+id/img_sublist_carat"
    android:layout_width="70dp"
    android:layout_height="68dp"
    android:layout_centerVertical="true"
    android:layout_marginLeft="625dp"
    android:contentDescription=""
    android:background="@drawable/img_sublist_carat_selector"
    android:visibility="visible" /> 
```

（选择器文件）img_sublist_carat_selector.xml：

```
<?xml version="1.0" encoding="UTF-8"?>
<selector xmlns:android="http://schemas.android.com/apk/res/android">
 <item android:state_focused="true" 
       android:state_pressed="true"        
       android:drawable="@drawable/img_sublist_carat_highlight" />
 <item android:state_pressed="true" 
       android:drawable="@drawable/img_sublist_carat_highlight" />
 <item android:drawable="@drawable/img_sublist_carat_normal" />
</selector> 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2016-03-14T12:54:10.763

实现选择器的最佳方法是使用 xml 而不是使用编程方式，因为它更容易使用 xml 实现。

```
 <?xml version="1.0" encoding="utf-8"?>    
<selector xmlns:android="http://schemas.android.com/apk/res/android">
        <item android:drawable="@drawable/button_bg_selected" android:state_selected="true"></item>
        <item android:drawable="@drawable/button_bg_pressed" android:state_pressed="true"></item>
        <item android:drawable="@drawable/button_bg_normal"></item>

    </selector> 
```

有关我使用此链接 [http://www.blazin.in/2016/03/how-to-use-selectors-for-botton.html实现的更多信息](http://www.blazin.in/2016/03/how-to-use-selectors-for-botton.html)

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2018-01-13T11:33:44.120

**在布局 .xml 文件中**

```
<Button
 android:id="@+id/button1"
 android:background="@drawable/btn_selector"
 android:layout_width="100dp"
 android:layout_height="50dp"
 android:text="press" /> 
```

**btn_selector.xml**

```
<?xml version="1.0" encoding="utf-8"?> 
```

```
 <item android:drawable="@drawable/btn_bg_selected" android:state_selected="true"></item>
<item android:drawable="@drawable/btn_bg_pressed" android:state_pressed="true"></item>
<item android:drawable="@drawable/btn_bg_normal"></item> 
```

# android - 如何将 EditText 添加到 DialogFragment？

> ID：14023904
> 
> 赞同：6
> 
> 时间：2012-12-24T16:57:01.633
> 
> 标签：android, dialog, android-edittext

我创建了一个 DialogFragment 并且我想添加一个 EditText 但是当我尝试像这样添加它时：

```
final EditText input = new EditText(this); 
```

我在“this”上收到错误消息，说“构造函数 EditText(EncryptionDialogFragment) 未定义”。

我的最终目标是让用户以这种方式输入密码。

```
public class EncryptionDialogFragment extends DialogFragment {
    final EditText input = new EditText(this);
    static EncryptionDialogFragment newInstance(String title){
        EncryptionDialogFragment fragment = new EncryptionDialogFragment();
        Bundle args = new Bundle();
        args.putString("title", title);
        fragment.setArguments(args);
        return fragment;
    }
    @Override
    public Dialog onCreateDialog(Bundle savedInstanceState) {
        return new AlertDialog.Builder(getActivity())
        .setIcon(R.drawable.ic_launcher)
        .setTitle("Enter Password:")
        .setView(input)
        .setPositiveButton("OK",
                new DialogInterface.OnClickListener() {
        public void onClick(DialogInterface dialog, 
                int whichButton) {
            ((MainActivity)getActivity()).doPositiveClick();
        }
    })
    .setNegativeButton("Cancel",
            new DialogInterface.OnClickListener() {
        public void onClick(DialogInterface dialog, 
                int whichButton) {
            ((MainActivity)getActivity()).doNegativeClick();
        }
    }).create();
} 
```

}

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-24T16:59:24.433

使用 getActivity()

```
final EditText input = new EditText(getActivity()); 
```

并且不要在字段中使用它，在 getActivity 不会返回 null 的 onCreateView 中对其进行初始化

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-24T16:59:56.703

`this`需要是一个Context，即一个Activity。在片段附加到活动之前，您无法创建 EditText。在`onCreateDialog`你可以做到`new EditText(getActivity())`。

# java - 按钮声音和重置按钮不起作用Android java

> ID：14023906
> 
> 赞同：0
> 
> 时间：2012-12-24T16:57:17.707
> 
> 标签：java

我正在使用 Java 创建一个简单的 Click Counter Android 应用程序。我是 Java 新手。下面是我的代码，gui 具有不同功能的不同按钮，例如计数按钮本身、重置计数按钮和静音按钮。

```
public class wazeefa extends Activity { 

//Count Button 
TextView txtCount; 
ImageView image; 
Button btnCount; 
Button wmute; 
Button wreset; 
public static int count=0; 
SharedPreferences app_preferences; 
MediaPlayer mpButtonClick; 

@Override 
public void onCreate(Bundle savedInstanceState) { 
super.onCreate(savedInstanceState); 
// The activity is being created. 
setContentView(R.layout.wazeefa); 

//SAVE COUNT 
app_preferences = this.getSharedPreferences("myPrefscount", MODE_WORLD_READABLE); 

count = app_preferences.getInt("count", 0); 

txtCount = (TextView)findViewById(R.id.wcount); 
txtCount.setText("This app has been started " + count + " times."); 

txtCount = (TextView)findViewById(R.id.wcount); 
txtCount.setText("This app has been started " + count + " times."); 

//Button SOUND AND COUNT 
mpButtonClick = MediaPlayer.create(this, R.raw.bubble); 
//RESET Button 
wreset = (Button)findViewById(R.id.wreset); 

txtCount = (TextView)findViewById(R.id.wcount); 
txtCount.setText(String.valueOf(count)); 

btnCount = (Button)findViewById(R.id.wclick); 
btnCount.setOnClickListener(new View.OnClickListener() { 
public void onClick(View v) { 
image = (ImageView) findViewById(R.id.imageview); 
count++; 
if (count > 50) count = 0; image.setImageResource(R.drawable.duroodimage); 
if (count > 0) image.setImageResource(R.drawable.duroodimage); 
if (count > 9) image.setImageResource(R.drawable.zikrimage); 
if (count > 39) image.setImageResource(R.drawable.duroodimage); 
txtCount.setText(String.valueOf(count)); 
} 
}); 

wreset.setOnClickListener(new View.OnClickListener() { 
public void onClick(View v) { 
count = 0; 
image.setImageResource(R.drawable.duroodimage);; 
txtCount.setText("0"); 
} 
}); 
} 

@Override 
protected void onPause() { 
super.onPause(); 
// save count value here 

SharedPreferences.Editor editor = app_preferences.edit(); 
editor.putInt("count", count); 
editor.commit(); 
}

//MUTE button
public void onClick(View v) {
// TODO Auto-generated method stub
switch (v.getId()) {
case R.id.wmute:
AudioManager.setMode(AudioManager.MODE_IN_CALL);
AudioManager.setStreamSolo(AudioManager.STREAM_VOICE_CALL, true);
default:
AudioManager.setMode(AudioManager.MODE_NORMAL );
AudioManager.setStreamSolo(AudioManager.STREAM_VOICE_CALL, false);
break;
}

} 
```

我有 1 个问题：

例如，当我返回应用程序并且计数显示为“5”时，重置按钮不再起作用 - 它什么也不做，我在 AVD 上收到一条错误消息，说“不幸的是，‘应用程序’已停止”。但是当我继续计数然后点击重置按钮时，它会再次将计数更改为零

关于上述问题的任何建议，我是否遗漏了任何内容或将代码放置在错误的区域？在我编辑代码之前，按钮声音正在工作，以保存“计数”数据。让我知道我是否含糊不清...

崩溃日志：

```
12-24 18:07:42.661: W/Trace(3633): Unexpected value from nativeGetEnabledTags: 0
12-24 18:07:42.741: D/AndroidRuntime(3633): Shutting down VM
12-24 18:07:42.741: W/dalvikvm(3633): threadid=1: thread exiting with uncaught     exception (group=0x40a70930)
12-24 18:07:42.811: E/AndroidRuntime(3633): FATAL EXCEPTION: main
12-24 18:07:42.811: E/AndroidRuntime(3633): java.lang.NullPointerException
12-24 18:07:42.811: E/AndroidRuntime(3633):     at  com.shaadcorp.wazaifapp.wazeefa$2.onClick(wazeefa.java:81)
12-24 18:07:42.811: E/AndroidRuntime(3633):     at android.view.View.performClick(View.java:4202)
12-24 18:07:42.811: E/AndroidRuntime(3633):     at android.view.View$PerformClick.run(View.java:17340)
12-24 18:07:42.811: E/AndroidRuntime(3633):     at android.os.Handler.handleCallback(Handler.java:725)
12-24 18:07:42.811: E/AndroidRuntime(3633):     at  android.os.Handler.dispatchMessage(Handler.java:92)
12-24 18:07:42.811: E/AndroidRuntime(3633):     at android.os.Looper.loop(Looper.java:137)
12-24 18:07:42.811: E/AndroidRuntime(3633):     at android.app.ActivityThread.main(ActivityThread.java:5039)
12-24 18:07:42.811: E/AndroidRuntime(3633):     at java.lang.reflect.Method.invokeNative(Native Method)
12-24 18:07:42.811: E/AndroidRuntime(3633):     at java.lang.reflect.Method.invoke(Method.java:511)
12-24 18:07:42.811: E/AndroidRuntime(3633):     at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:793)
12-24 18:07:42.811: E/AndroidRuntime(3633):     at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:560)
12-24 18:07:42.811: E/AndroidRuntime(3633):     at dalvik.system.NativeStart.main(Native     Method)
12-24 18:07:48.842: I/Process(3633): Sending signal. PID: 3633 SIG: 9
12-24 18:07:51.572: E/Trace(3808): error opening trace file: No such file or directory     (2) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-24T17:10:23.433

我想我在您的代码中的任何地方都没有看到 mpButtonClick.start() 。这就是为什么没有播放声音的原因。添加 mpButtonClick.start()。到您的 ClickListener。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-24T20:46:21.237

已解决问题，感谢您的帮助 Passionate Androiden。

```
public class wazeefa extends Activity {

//Count Button
TextView txtCount;
ImageView image;
Button btnCount;
Button wmute;
Button wreset;
public static int count=0;
SharedPreferences app_preferences;
MediaPlayer mpButtonClick;
AudioManager audioManager;
public static boolean mutestatus=false;
@Override
public void onCreate(Bundle savedInstanceState) {
super.onCreate(savedInstanceState);
// The activity is being created.
setContentView(R.layout.wazeefa);

audioManager =
(AudioManager)getSystemService(Context.AUDIO_SERVICE);
//SAVE COUNT
app_preferences = this.getSharedPreferences("myPrefscount", MODE_WORLD_READABLE);

count = app_preferences.getInt("count", 0);

txtCount = (TextView)findViewById(R.id.wcount);
txtCount.setText("This app has been started " + count + " times.");

image = (ImageView) findViewById(R.id.imageview);

txtCount = (TextView)findViewById(R.id.wcount);
txtCount.setText("This app has been started " + count + " times.");

//Button SOUND AND COUNT
mpButtonClick = MediaPlayer.create(this, R.raw.bubble);
//RESET Button
wreset = (Button)findViewById(R.id.wreset);

txtCount = (TextView)findViewById(R.id.wcount);
txtCount.setText(String.valueOf(count));

btnCount = (Button)findViewById(R.id.wclick);

wmute=(Button)findViewById(R.id.wmute);

btnCount.setOnClickListener(new View.OnClickListener() {
public void onClick(View v) {

count++;
if (count > 50) count = 0; image.setImageResource(R.drawable.duroodimage);
if (count > 0) image.setImageResource(R.drawable.duroodimage);
if (count > 9) image.setImageResource(R.drawable.zikrimage);
if (count > 39) image.setImageResource(R.drawable.duroodimage);
txtCount.setText(String.valueOf(count));
mpButtonClick.start();
}
});

wreset.setOnClickListener(new View.OnClickListener() {
public void onClick(View v) {
count = 0;
image.setImageResource(R.drawable.duroodimage);;
txtCount.setText("0");
SharedPreferences.Editor editor = app_preferences.edit();
editor.putInt("count", count);
editor.commit();
}
});

wmute.setOnClickListener(new View.OnClickListener() {
public void onClick(View v) {
if(!mutestatus){
mutestatus=true;
audioManager.setMode(AudioManager.MODE_IN_CALL);
audioManager.setStreamSolo(AudioManager.STREAM_VOICE_CALL, true);
Log.v("'test....",""+mutestatus);
}
else{
mutestatus=false;
audioManager.setMode(AudioManager.MODE_NORMAL );
audioManager.setStreamSolo(AudioManager.STREAM_VOICE_CALL, false);
Log.v("'test....",""+mutestatus);
}
}});
}

@Override
protected void onPause() {
super.onPause();
// save count value here

SharedPreferences.Editor editor = app_preferences.edit();
editor.putInt("count", count);
editor.commit();

}

} 
```

# android - 有人可以建议我如何（如果可能的话）在我的应用程序中防止 GC 吗？

> ID：14023913
> 
> 赞同：0
> 
> 时间：2012-12-24T16:58:13.217
> 
> 标签：android, sqlite, memory-leaks

所以我一直在努力使用我的 Android 应用程序。我对 Android 编程相当陌生，并为客户制作了应用程序。那时我为三星的 S2 和 S3 等新设备编写了它。现在我遇到了一个问题：垃圾收集。我已经阅读了一些关于机制以及如何减少 GC 的帖子，但我认为这不会有帮助。我希望有人能提示我如何处理 GC。

我的代码执行以下操作：它从名为 vTiger 的在线 CRM 下载大量数据。这是一个动态系统，因此应用程序获取大量链接数据，而不仅仅是（例如）带有用户名和密码的用户表。现在这进入 JSON 对象，我将它们拆分出来，以便我可以在这样的循环中使用所有数据：对于每个模块，获取所有记录。那么这些记录加起来大约是 5000 条（现在，仍然随着使用而增长）。

很多信息，所以我将所有信息存储到 ArrayList 和 ArrayList 中，它们是我用来保存信息的简单对象。我记得我不只是将对象写入数据库，而是在数据库过载时将它们保存在 ArrayList 中。所以我所做的是将所有这些对象（大约 5000 - 10000）保存在 ArrayLists 中，然后在 SQLite 数据库上使用 Transactions。这种方式效果很好。

但是，在模拟器/旧设备上，我得到了很多 GC_concurrent 日志记录，这意味着我的代码中有内存泄漏。我知道该设备无法将所有这些对象保存在它的内存中，但是您将如何处理呢？由于 GC，旧设备无法通过我的“同步”功能进行处理。例如，我让模拟器运行了几个小时，但它在同步进行到一半时几乎卡住了（非常、非常、非常慢）。

希望有人愿意给我一些建议，如果可能的话。提前致谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-24T17:03:47.420

如果您正在加载大量数据，您将获得 GC 峰值。真的没有办法解决。没有那么大的尖峰的唯一方法是将数据分块——将其分成更小的部分（可能是每个设备），并在加载更多之前对其进行处理。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-24T17:04:36.970

不是一次从服务请求所有数据，而是以块的形式请求数据。这将防止内存被填满并强制进行小型 GC。

# visual-studio-2010 - 错误：项目中不存在目标“GatherAllFilesToPublish”，但在 v10.5 文件夹中

> ID：14023918
> 
> 赞同：4
> 
> 时间：2012-12-24T16:58:46.547
> 
> 标签：visual-studio-2010, msbuild-wpp

我一直在这个问题上四处走动。我有一个内置于 VS2010 SP1 的 ASP.NET MVC 3 Web 应用程序。当我尝试发布到本地文件系统时，出现错误

项目中不存在目标“GatherAllFilesToPublish”。

它失败了。我已按照[为什么会收到错误“目标 GatherAllFilesToPublish 不存在”中描述的答案进行操作？](https://stackoverflow.com/questions/10989051/why-do-i-get-the-error-the-target-gatherallfilestopublish-does-not-exist)但这并不能解决我的问题。

我已经为 VS2010（2012 年 10 月）安装了 Azure SDK 1.8，试图让我的系统恢复工作。通过此安装，我在我的 MSBuild 树中看到以下文件/文件夹。

**Microsoft\VisualStudio\v10.0\Web\Microsoft.Web.Publishing.Targets，日期为 2011 年 1 月 18 日。**

该文件未提及“GatherAllFilesToPublish”

安装 Azure SDK 后，我有另一个文件/文件夹：

**Microsoft\VisualStudio\v10.5\Web\Microsoft.Web.Publishing.Targets，日期为 2012 年 9 月 27 日。**

该文件确实包含“GatherAllFilesToPublish”目标。

显然我在 VS2010 中的发布功能没有使用 v10.5 文件夹的目标。有没有人有任何建议来解决这个问题？

谢谢，

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-24T20:11:16.353

而答案是……

在过去的某个时候，该项目已被编辑为包含 msbuild 文件夹的本地副本，但我忘记了它。我使用 sysinternals 的 procmon 来查找文件访问权限，它仅在我的项目下引用 msbuild。

有了这个，我重命名了文件夹，编辑了 csproj 文件以删除 MSBuildExtensionsPath32 的本地化引用，然后重新加载了项目。

我能够成功发布我的应用程序。

# clojure - 重新加载处理显式加载的源文件的中间件

> ID：14023923
> 
> 赞同：0
> 
> 时间：2012-12-24T16:59:25.543
> 
> 标签：clojure, compojure, ring

Ring 带有中间件“重新加载”（https://github.com/ring-clojure/ring/blob/master/ring-devel/src/ring/middleware/reload.clj）。它基于 ns-tracker (https://github.com/weavejester/ns-tracker)。ns-tracker 在源目录中查找可能以 ns 形式开头的源文件。它根据这些 ns 表单中包含的信息构建依赖关系图。这当然可以完美地工作，但仅适用于 ns 表单中明确包含的依赖项。

Clojure 中有一个习惯用法，命名空间被分成几个文件。有一个定义命名空间的源文件（使用 ns 形式）。该文件可以包含任意数量的顶级表单，但特别是将包括负载，通常在顶级但我认为不一定。加载的文件以 in-ns 形式开始。这并不像您想象的那样晦涩难懂……clojure.core 使用它。

这些加载文件的内容本身并不构成模块，也不一定被强制成为模块（循环依赖等）。

ns-tracker 不扫描源文件以查找负载表达式，也不查找 in-ns 表单。原因很清楚。但这确实打乱了我的工作流程，因为对已加载文件的更改显然不会重新加载命名空间。

有谁知道是否有一个库可以处理显式加载的源文件？如果没有什么我会一起破解一些东西（可能通过在负载周围编写一些丑陋的宏）并使其公开可用。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-28T19:40:49.983

好的，回答我的问题……我已经扩展了 ns-tracker 并提交了一个拉取请求。它没有我预期的那么老套，实际上是合理的。

我的叉子在：[https ://github.com/hutch/ns-tracker](https://github.com/hutch/ns-tracker)

包含对 ns-tracker 的许多更改。具体到我的问题，它支持以 clojure/core 使用的方式使用 load/in-ns。

您可以通过使用 leiningen 'checkouts' 机制在您的项目中使用这个 fork。

# android - 使用 android 录制的视频无法在 Blobstore 上播放

> ID：14023925
> 
> 赞同：1
> 
> 时间：2012-12-24T16:59:35.860
> 
> 标签：android, google-app-engine, video-streaming, blobstore, video-recording

我编写了在 android 上录制视频的代码，我将它上传到 Blobstore，但没有运气让它从 googleappengine 上的播放器播放或在网络应用程序上流式传输，但是，我可以在下载视频时阅读它。任何想法 ？？我想到了我正在使用的编码或视频格式（.mp4）甚至更多，我将字节发送到 blobstore 的方式。谢谢你。

这是录制代码：

```
 mCamera = Camera.open();        
     path= Environment.getExternalStorageDirectory().getAbsolutePath().toString();

     Date date=new Date();
     filename="/rec"+date.toString().replace(" ", "_").replace(":", "_")+".mp4";

     //create empty file it must use
     File file=new File(path,filename);
    mrec = new MediaRecorder(); 
    mCamera.lock();
    mCamera.unlock();
    mrec.setCamera(mCamera);    
    mrec.setVideoSource(MediaRecorder.VideoSource.DEFAULT);
    mrec.setAudioSource(MediaRecorder.AudioSource.CAMCORDER);     
    mrec.setOutputFormat(MediaRecorder.OutputFormat.DEFAULT);
    mrec.setVideoEncoder(MediaRecorder.VideoEncoder.DEFAULT);
    mrec.setAudioEncoder(MediaRecorder.AudioEncoder.AMR_NB);
    mrec.setVideoFrameRate(20);
    mrec.setPreviewDisplay(surfaceHolder.getSurface());
    mrec.setOutputFile(path+filename);
    mrec.prepare();
    mrec.start(); 
```

这是上传代码：

```
HttpClient httpclient = new DefaultHttpClient();
httpclient.getParams().setParameter(CoreProtocolPNames.PROTOCOL_VERSION, HttpVersion.HTTP_1_1);

//HttpPost httppost = new HttpPost(url);
HttpPost httppost = new HttpPost(url);
File file = new File("/sdcard/"+videoName);

MultipartEntity mpEntity = new MultipartEntity();
ContentBody cbFile = new FileBody(file, "video/mp4");
mpEntity.addPart("videoFile", cbFile);

httppost.setEntity(mpEntity);
System.out.println("executing request " + httppost.getRequestLine());
HttpResponse response = httpclient.execute(httppost);
HttpEntity resEntity = response.getEntity(); 
```

“url”参数是从blobstore生成的url，用于上传媒体文件，我猜blobstore用户对它很熟悉。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-24T23:45:00.293

尝试使用`OutputFormat.MPEG_4`和。`VideoEncoder.H264``AudioEncoder.AAC`

# jquery-ui - 滑块不工作

> ID：14023926
> 
> 赞同：-3
> 
> 时间：2012-12-24T16:59:45.893
> 
> 标签：jquery-ui, jquery, jquery-plugins, jquery-selectors

你们能告诉我为什么我的滑块不工作吗？我已经在 js fiddle 中包含了所有资源，然后它也不能工作，提供下面的小提琴链接

[http://jsfiddle.net/YakV7/2/](http://jsfiddle.net/YakV7/2/)

实际演示

[http://tympanus.net/Development/ParallaxContentSlider/](http://tympanus.net/Development/ParallaxContentSlider/)

```
 <script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js"></script>
        <script type="text/javascript" src="js/jquery.cslider.js"></script>
        <script type="text/javascript">
            $(function() {

                $('#da-slider').cslider();

            });
        </script> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-24T17:02:14.327

### 这些行是什么意思？

```
<link rel="stylesheet" type="text/css" href="css/demo.css">
<link rel="stylesheet" type="text/css" href="css/style.css">
<script type="text/javascript" src="js/modernizr.custom.28468.js"></script>
<script type="text/javascript" src="js/jquery.cslider.js"></script> 
```

### 将其更改为实际路径。

```
<link rel="stylesheet" type="text/css" href="http://tympanus.net/Development/ParallaxContentSlider/css/demo.css">
<link rel="stylesheet" type="text/css" href="http://tympanus.net/Development/ParallaxContentSlider/css/style.css">
<script type="text/javascript" src="http://tympanus.net/Development/ParallaxContentSlider/js/modernizr.custom.28468.js"></script>
<script type="text/javascript" src="http://tympanus.net/Development/ParallaxContentSlider/js/jquery.cslider.js"></script> 
```

### 或添加：

```
<base href="http://tympanus.net/Development/ParallaxContentSlider/" /> 
```

### 同样的工作小提琴：http: [//jsfiddle.net/YakV7/7/](http://jsfiddle.net/YakV7/7/)

# java - Java：替代将“this”作为构造函数参数传递以引用创建对象

> ID：14023927
> 
> 赞同：10
> 
> 时间：2012-12-24T16:59:46.837
> 
> 标签：java, constructor, this

我花了一段时间思考不同的解决方案，因为我已经阅读过（我对 Java 还没有真正的经验），使用它作为构造函数参数通常不是一个好习惯。

我要做的是实例化几个 JobGroupMod 类的对象，并且对于每个 JobGroupMod 我必须创建一定数量的 JobMod 对象，这些对象必须能够引用它们从中产生的 JobGroupMod 对象。

为了实现这一点，我将“this”传递给 JobMod 构造函数，但即使工作，它也感觉不像是正确的设计。

```
public class JobGroupMod implements JobGroup {

    public JobGroupMod(Node n,Set<Job> clusterJobs){
        JobMod j=new JobMod(n,this);
    }
} 
```

现在是 JobMod 类：

```
public class JobMod implements Job {
     public JobMod(Node n, JobGroup jg){
         setJobGroup(jg);
     }
} 
```

我的问题是，有没有更好的方法来解决这个问题，或者我的解决方案是建议的方法？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-12-24T17:11:54.917

您应该尝试使用静态工厂方法（[有效的 Java 链接](http://www.informit.com/articles/article.aspx?p=1216151&seqNum=1)）。

这样可以避免传入`this`构造函数调用，至少可以说这是非常不明智的。
示例代码：

```
public class JobGroupMod implements JobGroup {

    public static JobGroupMod createModeMod(Node n, Set<Job> clusterJobs) {
        JobGroup jg = new JobGroupMod();
        JobMod j = new JobMod(n, jg);
        return jg;
    }
} 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-12-24T17:09:05.040

只要它仍然是您在`JobGroupMod`构造函数中所做的唯一事情，只要您了解其后果，就*相当安全。*现实世界中有很多 Java 代码可以做到这一点。这仍然不是您真正想做的事情，尤其是当您开始谈论多线程和并发时。

在对象完全构造之前，危险正在传递`this`给其他事物。如果构造函数在你这样做之后抛出异常并且没有完全构造，你可能会遇到一个讨厌的问题。`this`如果另一个线程要在完全构造之前访问您传递给它的对象，那么您将遇到一个令人讨厌的问题。

您在 Java 中经常会发现人们使用工厂模式来避免这种情况，使用“init”类型方法或依赖注入。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-24T17:07:28.647

一般没有魔法。您可以通过构造函数传递参数，也可以稍后使用 setter/init 方法等对其进行初始化。

如果您的类`JobMod`需要引用`JobGroupMod`并且与它无关，则使用构造函数传递它。如果有时它可以在没有它的情况下创建`init()`可以初始化此引用的方法或设置器。

顺便说一句，有时您必须同时创建参数化构造函数和默认构造函数：首先用于常规编程使用，其次如果您使用 XML、JSON 或其他更容易用于类 bean 类的序列化。在这种情况下，至少创建解释不应直接使用默认构造函数的 javadoc。

# android - 启动应用程序时获取新短信的更快/最快方式 - Android

> ID：14023934
> 
> 赞同：5
> 
> 时间：2012-12-24T17:00:30.663
> 
> 标签：android, sqlite, sms, android-cursor

我有一个包含用户所有短信的 sqlite 数据库，但是当您启动应用程序时，如果用户决定在其间使用不同的短信应用程序，我需要获取我可能没有的所有短信。

我正在寻找将我的数据库与基本 android 内容提供程序同步的最佳方式。

目前我对每条短信进行插入或忽略，如下所示：

```
insert or ignore into sms (smsID, smsCONID, smsMSG, smsNUM, smsREAD, smsTIMESTAMP, smsTYPE, smsSHORTMSG) values (?,?,?,?,?,?,?,?); 
```

我在初始屏幕活动中加载收件箱并在单独的异步任务中发送消息，这大约需要 10 秒左右。

我的 doInBackground ：

```
 @Override
    protected Void doInBackground(Void... arg0) {

        int thread_id = 0;
        int _id = 0;
        int read;
        String number;
        boolean first = true;
        String msg;
        long timestamp;

        /**
         * RECUPERATION DES MESSAGES RECUS
         */

        // PREPARE CURSOR
        cursorInbox.moveToFirst();

        while (cursorInbox.moveToNext()) {
            if(first){
                cursorInbox.moveToFirst();
                first = false;
            }

            // RECUPERE THREAD_ID + ID_SMS + NUMERO DU CONTACT
            thread_id = cursorInbox.getInt(cursorInbox.getColumnIndexOrThrow("thread_id"));
            _id = cursorInbox.getInt(cursorInbox.getColumnIndexOrThrow("_id"));
            number = cursorInbox.getString(cursorInbox.getColumnIndexOrThrow("address"));
            msg = cursorInbox.getString(cursorInbox.getColumnIndexOrThrow("body"));
            read = cursorInbox.getInt(cursorInbox.getColumnIndexOrThrow("read"));
            timestamp = cursorInbox.getLong(cursorInbox.getColumnIndexOrThrow("date"));

            // CREER LE SMS
            dataManip.insert(_id, thread_id, msg, number, read, timestamp, "received",ContactsFactory.getMessageShort(msg));

            i++; 
            publishProgress(i);

        }  

        Log.d(TAG,"LoadActivity - Inbox Loaded");
        return null;
    } 
```

改善的想法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-24T17:09:43.583

如果您的数据库已编入索引，则删除/禁用索引：插入会更快。稍后在新线程/任务中重建索引。

解决方案2：第一步不要只在内存中（在集合中）写入数据库，稍后您将进行写作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-27T18:40:22.230

如何将收件箱中每条短信的时间戳与数据库中的最新时间戳进行比较，然后只插入时间戳较新的短信。

如果您还从收件箱中的最后一条短信开始倒退，那么您可以在收到比最新短信更早的第一条短信时立即跳出循环。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-28T10:56:47.140

在单独的 Service 中[注册一个`ContentObserver`](http://developer.android.com/reference/android/database/Cursor.html#registerContentObserver%28android.database.ContentObserver%29)来监听 Android SMS 提供者的变化怎么样？我不确定它是否会通知观察者发生变化。但如果是这样，您的数据库将始终保持同步。但不要只依赖于此，因为各种原因随时可能终止服务。

对于实际同步，请确保表中的“_id”列是`PRIMARY KEY`. 查询按“_id”排序的内容提供者。查询自己按“_id”排序的表，读取所有id。现在遍历两个排序列表，插入您的列表中缺少的项目并删除缺少内容提供者的项目。您还想*删除*使用其他 SMS 应用程序删除的消息，不是吗？“插入或忽略”语句不会为您删除缺失的行。

# node.js - 用于规范化数据的 Mongoose getter / setter

> ID：14023937
> 
> 赞同：7
> 
> 时间：2012-12-24T17:00:51.540
> 
> 标签：node.js, mongodb, express, mongoose, normalization

我有一个包含字段的`User`架构。`username`我希望此字段区分大小写，以便用户可以注册名称，例如`BobDylan`. 但是，我需要我的架构来验证新条目以检查没有重复的、区分大小写的，例如`bobdylan`.

我的研究告诉我，我应该在模式中创建一个附加字段来存储小写/大写版本，以便我可以轻松检查它是否是唯一的。我的问题是，我将如何使用 Mongoose API 实现这一点？

我尝试过使用一个`set`函数，例如：

```
UserSchema.path('username_lower_case').set(function(username_lower_case) {
  return this.username.toLowerCase()
}); 
```

但是，此功能似乎没有运行。我基本上需要告诉`username_lower_case`它是什么`username`，但要小写。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-12-24T18:05:45.497

一种方法是使用预保存挂钩来执行此操作。

```
UserSchema.pre('save', function (next) {
    this.username_lower_case = this.username && this.username.toLowerCase();
    next();
}); 
```

另一种方法是制作`username`一个虚拟的：

```
UserSchema.virtual('username').set(function (value) {
    this.username_raw = value;
    this.username_lower_case = value && value.toLowerCase();
}).get(function () {
    return this.username_raw;
}); 
```

# tomcat - Tomcat 未启动：无法为对象堆保留足够的空间

> ID：14023940
> 
> 赞同：3
> 
> 时间：2012-12-24T17:01:29.087
> 
> 标签：tomcat, jvm, heap-memory, catalina

启动tomcat时出现错误

> 无法为对象堆保留足够的空间
> 
> 无法创建 Java 虚拟机

我用谷歌搜索了一下，这似乎是一个常见问题，但到处提到的修复方法对我不起作用。

每个提到这个问题的地方都说“设置 CATALINA_HOME 或 JAVA_OPTS”。我为两个变量设置了值，并为 head 和 permsize 保留了足够的空间，但我仍然面临同样的问题。

在较轻的节点上：我已验证有足够的空间可供分配。

我正在使用 32 位堆栈，我正在为 JAVA_OPTS 和 CATALINA_OPTS 设置以下值

-Xms512m -Xmx1024m -XX:PermSize=256m -XX:MaxPermSize=512m

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-12-24T23:41:12.370

32 位 Windows 上的 Java 需要一个连续的内存块 - windows32 不能提供太大的内存块，AFAIK 最大 1.5G（这是从 XP 时代回来的内存），但如果内存还没有太碎片化，那么只有这么多（是的，我知道，现在听起来很奇怪）。

因此，在启动其他应用程序之前，您可能会尝试重新启动计算机并首先启动 java/tomcat。另一种选择是提供更少的内存（尝试需要多少内存与可用内存）。

此外，对于生产设置，我始终建议让 -Xms 和 -Xmx 具有相同的大小：如果出现问题，您将立即获得结果，并且已经分配了连续的内存块。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2016-06-17T07:50:59.153

尝试在“打开启动配置”中更改 Tomcat 参数。

在 Eclipse 的服务器视图中，双击服务器，单击“打开启动配置”链接。在出现的屏幕上，单击“参数”选项卡，您将看到一个类似以下结尾的值：-Dproperties.path=C:/dgoj/properties/local -Xms512m -Xmx1024m -XX:MaxPermSize=512m

您只需修改最后一个值 XX:MaxPermSize 即可将其设置为：

XX:MaxPermSize=256m

Tomcat 现在应该可以正常启动了

# sql - 复杂的sql查询 - 一次查询选择所有房东的属性并减去成本

> ID：14023942
> 
> 赞同：2
> 
> 时间：2012-12-24T17:01:53.973
> 
> 标签：sql, sql-server-2008, tsql

我有一个类似于这样的表数据结构：

**房东桌**

```
Id    Name        Email
```````````````````````
1     J Johnson    ...
2     R Kelly      ... 
```

**属性表**

```
Id    Address    Rent    LandlordId
```````````````````````````````````
1    ....        400    1
2    ....        600    1
3    ....        750    2 
```

**保养表**

```
Id    Details   Cost    MaintenanceDate    PropertyId
`````````````````````````````````````````````````````
1    ....        25     20/12/2012         1
2    ....        120    22/12/2012         2
3    ....        35     24/12/2012         3 
```

本质上，房东有多个房产。每个月，我需要为房东开具发票，其中包括他的所有房产，对他的房产进行的所有维护。为了计算我需要付给房东多少钱，我需要将他所有房产的租金相加，然后减去他当月所有维护费用的总和。

因此，*应支付给房东的金额 L = Sum(L 的房产租金) - Sum(L 在本月内所有房产的维护费用)*

我正在使用 Telerik 报告，我认为我可以通过一些巧妙的分组来实现它，但那是在浪费我的时间，所以我现在将尝试使用 SQL 和子报告来实现它。

我正在尝试的 SQL 查询是这样的：

```
 SELECT l.Name, p.[Address], p.Rent, c.Details, c.Cost,
(select Rent From Property where Id = p.Id) - 
    (select SUM(cost) from CarriedOutJobs where PropertyId = p.Id) 
    as PayableToLandlord
FROM Landlord l JOIN PROPERTY p ON p.LandlordId = l.Id
LEFT OUTER JOIN Maintenance c ON c.PropertyId = p.Id
ORDER BY l.Fullname 
```

这似乎无法正常工作，因为它会产生多个字段

因为我要将报告分解为子报告，所以我想我会先获取房东的详细信息，但即使在这种情况下，我仍然需要计算应支付给房东的金额。所以我将查询重写为：

```
SELECT distinct l.Name,
(SELECT SUM(Rent) FROM PROPERTY WHERE LandlordId = l.Id) - 
    (SELECT COALESCE(SUM(cost), 0)
    FROM CarriedOutJobs WHERE PropertyId = p.Id) AS     PayableToLandlord
FROM Landlord l 
JOIN PROPERTY p ON p.LandlordId = l.Id 
ORDER BY l.Fullname 
```

我认为这行得通，但即使我使用了 distinct，这似乎会产生一个`PayableToLandlord`数量不同的重复行，我似乎无法弄清楚为什么。

请问有没有办法在一个查询中选择所有房东、他们的财产以及应付给他们的金额？

为了简单起见，我在这里删除了 date where 子句。

谢谢。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-24T17:18:56.813

我建议保持简单并使用子查询，因为这些很容易弄清楚发生了什么。希望您可以在报告中或非常简单地作为附加返回列进行减法等。您应该将任何日期参数作为变量传递给子查询（可能）。

```
SELECT Landlord.Id as LandlordId, Landlord.Name, 
       ISNULL(TotalRent,0) AS TotalRent, 
       ISNULL(TotalCost,0) AS TotalCost
FROM Landlord
LEFT JOIN 
    (SELECT SUM(Rent) as TotalRent, LandLordId 
     FROM Property
     GROUP BY LandLordId) Rents
ON Landlord.Id = Rents.LandlordId
LEFT JOIN 
    (SELECT LandLordId,SUM(Cost) AS TotalCost
     FROM Property
     INNER JOIN Maintenance
        ON Property.Id = Maintenance.PropertyId
     GROUP BY LandLordId
     ) MaintenanceCosts
ON Landlord.Id = MaintenanceCosts.LandlordId
ORDER BY Landlord.Name 
```

刚刚注意到你还写道：

> 请问有没有办法在一个查询中选择所有房东、他们的财产以及应付给他们的金额？

您可以进一步加入属性列表，但最终会在每一行上重复总和。只要您不尝试在您的报告包中求和它就可以了。

如果您确实想要房产详细信息，那么我的建议是提取每个房产的租金和成本，然后在报告包中计算总和/净值。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-24T18:23:14.100

这是一个较短的查询：请发表评论。

```
select l.name, x.propid,
sum(x.tot) as finalrent
from landlord l
left join
(select p.landlordid, (p.rent - m.cost) as tot,
p.id as propid 
from property p left join 
maintenance m
on p.id = m.propertyid) as x
on
l.id = x.landlordid
group by l.id, x.propid
;

NAME        PROPID  FINALRENT
J Johnson   1       375
J Johnson   2       480
R Kelly     3       715 
```

25/12/2012

* * *

## 编辑以添加 SQLFIDDLE 以及结果`group by landlord only`

查询显示扣除成本后的总租金。

*   [SQLFIDDLE 演示](http://sqlfiddle.com/#!2/5d75f/2)

询问：

```
-- group by landlord only

select l.id, l.name,
sum(x.tot) as finalrent, 
sum(COALESCE(x.cost,0)) as TotalCost
from landlord l
left join
(select p.landlordid, 
(p.rent - COALESCE(m.cost,0)) as tot,
p.id as propid, m.cost 
from property p left join 
maintenance m
on p.id = m.propertyid) as x
on l.id = x.landlordid
group by l.id
; 
```

结果：

```
ID  NAME        FINALRENT   TOTALCOST
1   R Johnson   880         120
2   R Kelly     715         35 
```

27/12/2012

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-24T18:20:17.897

乔尔的回答非常好。然而，有一种更简单的方式来表达这一点。您可以在*属性*级别的子查询中进行汇总，然后在外部查询中在房东级别进行汇总：

```
SELECT l.Id as LandlordId, l.Name, 
       sum(p.rent) as TotalRent,
       coalesce(sum(p.rent), 0) AS TotalRent, 
       coalesce(sum(m.PropertyCost), 0) AS TotalCost
FROM Landlord l left outer join
     Property p
     on l.LandlordId = p.LandlordId left outer join
     (SELECT PropertyId, SUM(Cost) AS PropertyCost
      FROM Maintenance m
      group by PropertyId
     ) m
     on m.PropertyId = p.PropertyId
group by l.LandLordId, l.LandlordName
ORDER BY Landlord.Name 
```

这会在第二个子查询中保存一个连接。

# c# - Databound Pivot 未加载 Windows Phone 8 中的第一个 PivotItem

> ID：14023948
> 
> 赞同：3
> 
> 时间：2012-12-24T17:02:53.053
> 
> 标签：c#, xaml, windows-phone-8

我正在将我的应用程序从 WP7 迁移到 WP8，并且发生了一件有趣的事情。我有一个在 WP7 中完美运行的数据绑定枢轴。但是，在 WP8 中，完全相同的代码不会加载第一个 PivotItem。我已经尝试了[WP7 问题](https://stackoverflow.com/questions/4114608/databound-pivot-control-is-not-creating-the-first-pivotitem)中的所有解决方案，但没有一个有效（我想要一个解决方案，而不是一个丑陋的解决方法）。我在构造函数中设置了DataContext，集合没问题，一切都应该工作。它仅在我在应用程序中滚动时加载枢轴。任何人有任何解决方案？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-24T23:36:24.233

我无法在 WP8 上使用 Pivot 重现任何数据绑定问题。WP8 上的全景数据绑定存在一个已知问题，但 Pivot 没有。什么对你不起作用？

这是一个基本的 WP8 Pivot 数据绑定代码，对我来说很好用。

C# 代码将 DataContext 设置为可观察的奶牛集合：

```
this.DataContext = new ObservableCollection<Cow>()
                           {
                               new Cow("Foo"),
                               new Cow("Bar"),
                               new Cow("Baz")
                           };

public class Cow
{
    public Cow(string name)
    {
        Name = name;
    }

    public string Name { get; set; }
} 
```

XAML 代码使用该 DataContext 作为 ItemSource 并将 PivotItem.Header 和 PivotItem.Content 绑定到奶牛名称。

```
<phone:Pivot ItemsSource="{Binding}">
    <phone:Pivot.HeaderTemplate>
        <DataTemplate>
            <ContentControl Content="{Binding Name}" />
        </DataTemplate>
    </phone:Pivot.HeaderTemplate>
    <phone:Pivot.ItemTemplate>
        <DataTemplate>
            <ContentControl Content="{Binding Name}" />
        </DataTemplate>
    </phone:Pivot.ItemTemplate>
</phone:Pivot> 
```

工作得很好...

![在 Foo 处于活动状态时旋转](../Images/50f66786dbf3589ff540c9e2635acc74.png) ![活动栏的枢轴](../Images/f3ade2155596750339268cf8a538d07e.png)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-01-18T06:18:14.307

我在这里创建了这个错误的重现：[https ://github.com/michaellperry/PivotIsBroken](https://github.com/michaellperry/PivotIsBroken)

似乎由于未触发内容动画而发生该错误。选定的索引实际上并没有改变。

我采用的丑陋解决方法类似于 DavidN 的建议，但我必须插入一个虚拟页面。将 SelectedIndex 设置为 1 且只有一页会引发异常。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-12-13T20:02:17.570

如果它有帮助我有同样的问题，做了一个丑陋的修复，但它有效..

```
 pivotTest.SelectedIndex = 1;
    pivotTest.SelectedIndex = 0; 
```

# objective-c - 在 App Purchase iOS 访问 AppleId

> ID：14023954
> 
> 赞同：2
> 
> 时间：2012-12-24T17:03:30.323
> 
> 标签：objective-c, ios, in-app-purchase, userid

购买完成后进行应用内购买（电子邮件或其内部 ID）时，有没有办法访问用户在身份验证对话框中输入的 Apple ID？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-24T17:31:31.117

在官方应用程序中，无法访问它，因为它会带来很大的安全漏洞（例如，可以轻松地将垃圾邮件发送到指定的电子邮件地址）。

但是，如果您使用的是越狱设备，则可以从钥匙串中获取必要的信息。相应的钥匙串项的`svce`密钥设置为`com.apple.itunesstored.token`，并且电子邮件地址对应于该`acct`密钥。这些条目的安全等级是`kSecClassGenericPassword`。只需确保您使用适当的权利（您需要`"keychain-access-groups" = "*"`）对您的应用程序进行代码设计。

检索所需信息的实际示例如下所示：

```
#import <CoreFoundation/CoreFoundation.h>
#import <Foundation/Foundation.h>
#import <Security/Security.h>

int main()
{
    NSMutableDictionary *query = [NSMutableDictionary dictionary];
    [query setObject:kSecClassGenericPassword forKey:kSecClass];
    [query setObject:kSecMatchLimitAll forKey:kSecMatchLimit];
    [query setObject:kCFBooleanTrue forKey:kSecReturnAttributes];
    [query setObject:kCFBooleanTrue forKey:kSecReturnRef];
    [query setObject:kCFBooleanTrue forKey:kSecReturnData];
    NSArray *items = nil;
    SecItemCopyMatching(query, &items);

    for (NSDictionary *item in items) {
        if ([[item objectForKey:@"svce"] isEqualToString:@"com.apple.itunesstored.token"]) {
            NSLog(@"Found iTunes Store account: %@", [item objectForKey:@"acct"]);
        }
    }

    return 0;
} 
```

entitlements.xml 文件（使用代码设计`ldid -Sentitlemens.xml binary`）：

```
<plist>
<dict>
    <key>keychain-access-groups</key>
    <array>
        <string>*</string>
    </array>
</dict>
</plist> 
```

# excel - 新的 Excel.Application() 杀死调试器没有错误

> ID：14023961
> 
> 赞同：-1
> 
> 时间：2012-12-24T17:04:42.833
> 
> 标签：excel, visual-studio-2008-sp1

我正在使用 VS 2008 并尝试打开 Excel 2003 模板，输入一些值，然后保存工作簿。我知道我有正确的代码来执行我正在尝试做的事情，但是当我调用 New Excel.Application() 方法时，我遇到了一些奇怪的行为。在此调用中，我的应用程序不会中断，但调试器会退出且没有错误消息。下一行代码没有执行，我一辈子都搞不清楚发生了什么。有任何想法吗？

编辑：这是相关的代码：

```
imports exc = Microsoft.Office.Interop.Excel
.....
sub createCSV(filename)
    dim thisExc as new exc.Application()   <------ Instant Death! 
```

我已经尝试将它包装在 try/catch 中，但这也不起作用......从来没有抓住它，只是在执行那条线时死了。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-24T17:43:36.060

这是一个例子

```
Imports exc = Microsoft.Office.Interop.Excel

Public Class Form1
Public Sub openExcelFile()
    Dim thisExec As exc.Application

    thisExec = New exc.Application

    thisExec.Visible = True

End Sub

Private Sub Form1_Load(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles MyBase.Load
    openExcelFile()
End Sub
End Class 
```

# c# - 两台 Intel 机器上相同的 CPU ID

> ID：14023963
> 
> 赞同：7
> 
> 时间：2012-12-24T17:05:26.657
> 
> 标签：c#

> **可能重复：**
> [WIN32_Processor::Is ProcessorId 对所有计算机都是唯一的](https://stackoverflow.com/questions/1101772/win32-processoris-processorid-unique-for-all-computers)

我正在创建一个具有试用功能的应用程序。为了检测某个用户是否已经使用了试用版，应用程序使用他们的`machineHash`.

`machineHash`函数如下所示：

```
string cpuInfo = string.Empty;
ManagementClass mc = new ManagementClass("win32_processor");
ManagementObjectCollection moc = mc.GetInstances();

foreach (ManagementObject mo in moc)
{
    if (cpuInfo == "")
    {
        //Get only the first CPU's ID
        cpuInfo = mo.Properties["processorID"].Value.ToString();
        break;
    }
}
return cpuInfo; 
```

但是，它确实将我的处理器 ID 报告为`BFEBFBFF000206A7`（在两台不同的英特尔机器上，i5 和赛扬）。谷歌搜索`BFEBFBFF000206A7`也有命中，所以它不是唯一的。

谁能告诉我为什么这不是独一无二的？我不想使用比方说`C:\`驱动器的 VolumeSerial，因为它可以通过简单的命令轻松更改。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-12-24T17:15:02.443

不使用处理器 ID，而是将系统的多个 ID 组合成 1 个字符串，以在程序每次发送检查时进行比较。

使用这样的东西：

```
using System.Management;
ManagementObjectSearcher searcher = new ManagementObjectSearcher(
"select * from " + whatever_id); 
```

您可以在此处找到可以替换whatever_id 的所有值：http: [//www.codeproject.com/Articles/17973/How-To-Get-Hardware-Information-CPU-ID-MainBoard-I](http://www.codeproject.com/Articles/17973/How-To-Get-Hardware-Information-CPU-ID-MainBoard-I)

我会找到一些你想使用的，其中一些可能是唯一的，但即使你不使用唯一的字段，你也可以进行组合，对于大多数意图和目的来说，都是唯一的。

# crystal-reports - 使用 Crystal Reports 子报表获取页眉

> ID：14023967
> 
> 赞同：1
> 
> 时间：2012-12-24T17:05:55.957
> 
> 标签：crystal-reports

也许您可以帮助我解决我在使用 Crystal Reports 时遇到的问题。我有一个子报告，它有自己的设置页眉。这些与主报告的页眉不同。

当我单独运行子报表时，标题会显示，但是当我运行主报表时，子报表的标题部分被抑制，只显示详细信息行。

我无法通过将标题移动到主报告来解决这个问题，因为子报告在我的所有三个报告中都使用了。在其中两份报告中，我有两个不同的详细信息部分。

我还尝试为子报告创建组标题。这些也在主报告中被隐藏。

任何帮助将不胜感激，我已经为这个问题苦苦挣扎了好几天。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-01-22T18:42:59.100

在查看子报表的同时打开 Crystal Reports 中的部分专家

选择报告标题部分

检查“common”选项在隐藏、抑制旁边没有打勾

保存报告并测试

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-24T17:24:17.620

您可以创建其他页眉部分并有条件地抑制它们

# php - 生产环境错误：无法解析为有效的用户 ID

> ID：14023968
> 
> 赞同：1
> 
> 时间：2012-12-24T17:06:12.527
> 
> 标签：php, facebook, facebook-graph-api, environment

我完成了一个工作应用程序，它允许我的用户使用 Facebook 登录，然后在提交时同时发布到他们的博客网站和 Facebook 页面墙。这在我的开发环境（本地主机）中运行良好，但是当我将其推送到生产环境时，尝试发布到页面墙时出现以下错误：

```
1.234523452345234E+14 does not resolve to a valid user ID 
```

显示的数字几乎与我尝试发布到的页面的页面（非用户）ID 相同。我假设因为在页面上执行操作时您必须充当页面，所以页面是用户。任何想法为什么这会在新环境中打破？我确实更新了我的应用程序配置以指向正确的画布 url。

*   用户可以成功登录。
*   我可以访问用户 ID 和页面 ID。

我注意到页面 id 正在重新格式化： `12345234523452340`变为`1.234523452345234E+14`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-24T17:33:00.900

将其转换回整数：

```
number_format(1.234523452345234E+14,0,'','') 
```

# java - 如何避免在 Hibernate 中获取 javassist 惰性实体代理实例

> ID：14023969
> 
> 赞同：5
> 
> 时间：2012-12-24T17:06:14.553
> 
> 标签：java, xml, spring, hibernate

为了避免 Hibernate 给我懒惰的 javassist 实例代理而不是真正的实体，我需要改变什么？

更新：我正在使用 Spring 3.x 和 Hibernate 4.x

我用来加载实体的 API 是`org.hibernate.internal.SessionImpl#load(Person.class, Id)`简单的映射：

```
<?xml version="1.0"?>
<!DOCTYPE hibernate-mapping PUBLIC
    "-//Hibernate/Hibernate Mapping DTD 3.0//EN"
    "http://www.hibernate.org/dtd/hibernate-mapping-3.0.dtd">

<hibernate-mapping package="org.perfectjpattern.example.model">
<class name="Person" table="PERSON_" >
    <id name="id">
        <generator class="native"></generator>
    </id>
    <property name="name" update="false" />
    <property name="age" update="true" />
</class>

<query name="Person.findByName">
    <![CDATA[select p from Person p where p.name = ? ]]>
</query>

<query name="Person.findByAge">
    <![CDATA[select p from Person p where p.age = :Age ]]>
</query>
</hibernate-mapping> 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-24T17:24:00.790

使用[get()](http://docs.jboss.org/hibernate/orm/3.5/api/org/hibernate/Session.html#get%28java.lang.Class,%20java.io.Serializable%29)而不是[load()](http://docs.jboss.org/hibernate/orm/3.5/api/org/hibernate/Session.html#load%28java.lang.Class,%20java.io.Serializable%29)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-25T10:34:46.380

`Hibernate.initialize(obj)`之后可以使用`session.load(id)`。

此方法可以立即初始化您的 obj。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-24T17:26:11.983

实际上通过简单地将映射更改为（参见`default-lazy="false"`）来解决它：

```
<?xml version="1.0"?>
<!DOCTYPE hibernate-mapping PUBLIC
"-//Hibernate/Hibernate Mapping DTD 3.0//EN"
"http://www.hibernate.org/dtd/hibernate-mapping-3.0.dtd">

<hibernate-mapping package="org.perfectjpattern.example.model" default-lazy="false"> 
```

# ruby-on-rails - 在日期之间搜索具有可变间隔 w/rails

> ID：14023974
> 
> 赞同：2
> 
> 时间：2012-12-24T17:06:54.057
> 
> 标签：ruby-on-rails, database, postgresql, datetime

我想知道如何通过数据库查询而不是查找所有站点来处理这个问题。

```
Site.all.select { |x| x.last_ran <= DateTime.now - x.interval.minutes } 
```

基本上我需要找到所有在他们的时间间隔之前 last_ran 的网站。因此，如果我在 12:00 和 12:06 运行我的站点，但间隔为 5 分钟，则此查询将返回它。

我遇到的问题是在数据库级别转换 x.interval.minutes (5.minutes)。

谢谢 - 如果有特定的数据库方法可以做到这一点，我也会使用 postgres！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-24T17:11:54.787

在 postgres 中，这将工作......

```
Site.where(
  "sites.last_ran <= CURRENT_TIMESTAMP - sites.interval * INTERVAL '1 second'"
) 
```

我想你可以使用`NOW()`或者`CURRENT_TIMESTAMP`

# java - 何时使用 mvn clean install 而不是 mvn install？

> ID：14023975
> 
> 赞同：7
> 
> 时间：2012-12-24T17:07:24.807
> 
> 标签：java, maven

我有一个打包为`war`文件（包括几个`jar`文件）的 Web 应用程序。我注意到，当我运行 mvn install 时——编译的唯一项目是那些已更改的项目——然后它会替换文件`jar`中的这些 s `war`。

如果是这样的话——我什么时候应该使用 mvn clean install 而不是简单地使用 mvn install？

我想如果我更改任何资源，我将不得不使用 mvn clean install - 我是对的吗？

如果我是对的，那么每当我只更改课程时， mvn install 是否足够好？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-12-24T17:40:27.133

大多数情况下，进行清理的唯一原因是如果您做了一些会删除或重命名输出目录中的类或资源的操作，例如重命名 .java 文件或更改生成类的内容，以便生成具有不同名称的类。在这些情况下，旧的类或资源文件仍将存在于输出目录中，并可能导致奇怪的行为。

除此之外，只需使用安装，你会没事的。然后 Maven 将只构建需要构建的内容以使输出目录保持最新。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-24T17:13:21.633

如果您想从头开始构建项目，请使用 clean。如果您的构建不需要很多时间，则每次运行构建时都使用 clean。否则由你决定。

如果您不确定所有内容是否确实已更新，请务必这样做。

# android - 从 sqlite onListItemClick NullPointerException

> ID：14023979
> 
> 赞同：2
> 
> 时间：2012-12-24T17:08:45.180
> 
> 标签：android, sqlite

我正在尝试将编辑功能添加到我的数据库中，读写功能完美运行。我想要的第一步是在 show_activity 中显示从我的列表视图单击的记录在另一个布局（我用于添加新记录的相同布局）中我有这段代码

```
show_activity
///ON CREATE    
    @Override
    public void onCreate(Bundle savedInstanceState) {
       super.onCreate(savedInstanceState);
       setContentView(R.layout.main_layout);

       datasource = new DBAdapter(this);
       datasource.open();
       Cursor cursor = datasource.Query(filter); 

       String[] columns = new String[] { "swimm_pos", "swimm_date","swimm_lap", "swimm_stroke", "swimm_time", "swimm_media", "swimm_efficiency", "swimm_note" };
       int[] to = new int[] { R.id.swimm_pos, R.id.swimm_date, R.id.swimm_lap, R.id.swimm_stroke, R.id.swimm_time, R.id.swimm_medialap, R.id.swimm_efficiency, R.id.swimm_note};

       SimpleCursorAdapter adapter = new SimpleCursorAdapter(
            this, 
            R.layout.list_layout,
            cursor, 
            columns, 
            to);  

        this.setListAdapter(adapter);
        datasource.close(); 
```

'''''

```
 protected void onListItemClick(ListView l, View v, int position, long id) {
    Intent intent = new Intent("com.poolper.Edit_Activity");
        Cursor cursor = (Cursor) adapter.getItem(position);
intent.putExtra("idContacto",cursor.getInt(cursor.getColumnIndex("_id")));
        startActivity(intent);      
} 
```

这是我的编辑活动的摘录

```
 public class Edit_Activity extends Activity {

int idContacto;
DBAdapter  datasource;

GetSet details;
EditText edtSwimm_pos;
.....
protected void onCreate(Bundle savedInstanceState) {
    // TODO Auto-generated method stub
    super.onCreate(savedInstanceState);
        setContentView(R.layout.edit_layout);

        edtSwimm_pos = (EditText) findViewById(R.modificacontatto.edswimm_date);
......
            LoadDetails();
...
    private void LoadDetails(){
        idContacto = getIntent().getIntExtra("idContacto", 0);
        datasource = new DBAdapter(this);
        datasource.open();
        details = datasource.getContacto(idContacto);
        datasource.close();
        edtSwimm_pos.setText(contacto.getswimm_pos());

    ..... 
```

从我的 DBAdapter

```
public class DBAdapter {
    private SQLiteDatabase database;
    private DBHelper DBHelper;
    private String[] allColumns = {
            DBHelper.ID,
            DBHelper.SWIMM_POS,
            DBHelper.SWIMM_DATE,
            DBHelper.SWIMM_LAP,
            DBHelper.SWIMM_STROKE,
            DBHelper.SWIMM_TIME,
            DBHelper.SWIMM_MEDIA,
            DBHelper.SWIMM_EFFICIENCY,
            DBHelper.SWIMM_NOTE 
            };
....
private GetSet cursorToContacto(Cursor cursor) {
    GetSet contacto = new GetSet(cursor.getLong(0),cursor.getString(1),cursor.getString(2), cursor.getString(3), cursor.getString(4), cursor.getString(5), cursor.getString(6), cursor.getString(7), cursor.getString(8));
        return contacto;
    }
public GetSet getContacto (int idContacto){
        Cursor cursor = database.query(DBHelper.TABLE_NAME, allColumns, DBHelper.ID + " = " + idContacto, null,null, null, null);
            cursor.moveToFirst();
            return cursorToContacto(cursor);
        } 
```

还有这个 GetSet 类

```
public class GetSet {
    private long _id;
    private String swimm_pos;
    private String swimm_media;
    private String swimm_note;
    private String swimm_date;
    private String swimm_lap;
    private String swimm_stroke;
    private String swimm_time;
    private String swimm_efficiency;

    public GetSet(long id, String swimm_pos, String swimm_date, String swimm_lap,String swimm_stroke, String swimm_time, String swimm_media, String swimm_efficiency, String swimm_note){
        this._id=id;
        this.swimm_pos=swimm_pos;
        this.swimm_date=swimm_date;
        this.swimm_lap=swimm_lap;
        this.swimm_stroke=swimm_stroke;
        this.swimm_media=swimm_media;
        this.swimm_time=swimm_time;
        this.swimm_efficiency=swimm_efficiency;
        this.swimm_note=swimm_note;

    }

    public long getId() {
        return _id;
    }
    public void setId(long id) {
        this._id = id;
    }

    public String getswimm_pos() {
        return swimm_pos;
    }
    public void setswimm_pos(String swimm_pos) {
        this.swimm_pos = swimm_pos;
    } 
```

但是当我点击记录调试时在这一行显示 NullPointException Cursor cursor = (Cursor) adapter.getItem(position)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-24T17:18:34.753

将您的代码更改为：

```
 protected void onListItemClick(ListView l, View v, int position, long id) {

   Cursor cursor = ((SimpleCursorAdapter)l.getAdapter()).getCursor();
   cursor.moveToPosition(position);

   Intent intent = new Intent(Current_Activity.this,Edit_Activity.class);
   intent.putExtra("idContacto",cursor.getInt(cursor.getColumnIndex("_id")));
   startActivity(intent);      
} 
```

# scala - Intellij 12 中的 Play2 项目

> ID：14023980
> 
> 赞同：7
> 
> 时间：2012-12-24T17:08:48.700
> 
> 标签：scala, intellij-idea, playframework-2.0

有人可以解释一下如何在 Intellij 12 上导入您的想法项目以支持 Play2 吗？

我刚刚购买了从版本 10 到 12 的升级。它曾经可以在 Intellij 10 上正常工作（仅支持 scala）。在 Intellij 12 上使用`play idea`和导入项目时，它似乎不起作用，不再突出显示，即使在实际使用版本 10 的 scala 文件中也是如此。

看来我不是唯一一个在 Intellij 12 中遇到 Play2 支持问题的人，所以如果有人可以提供帮助，那就太好了 :)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-24T17:27:52.617

请检查您是否安装[了来自存储库的](http://www.jetbrains.com/idea/webhelp/installing-updating-and-uninstalling-repository-plugins.html)**Scala**和**Play 2.0 Support**插件。

然后检查`.scala`扩展名是否分配`Scala Files`给`Settings`| `File Types`.

另请参阅以下链接：

*   [IntelliJ IDEA 12 中的 Play 2.0 入门](http://blogs.jetbrains.com/idea/2012/12/getting-started-with-play-20-in-intellij-idea-12/)
*   [Play Framework 2.0 教程](http://confluence.jetbrains.com/display/IntelliJIDEA/Play+Framework+2.0)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-21T17:33:10.797

好吧，使用 IntelliJ 导入现有的 Play 2 项目仍然不是很容易，即使使用新的 Play 插件也是如此。

支持这个问题，为您现有的 Play 2 项目获得一个不错的导入实用程序。

[http://youtrack.jetbrains.com/issue/SCL-5209](http://youtrack.jetbrains.com/issue/SCL-5209)

# google-chrome-extension - Chrome 扩展延迟条件

> ID：14023983
> 
> 赞同：1
> 
> 时间：2012-12-24T17:09:08.817
> 
> 标签：google-chrome-extension

我创建了一个 chrome 扩展，它在单击其按钮后执行某些操作。但是我不希望它被滥用，所以我需要在一段时间后执行它的代码。

为了实现这一点，我怎样才能用超时包围这段代码？

谢谢你读我！

```
chrome.tabs.getSelected(null,function(tab) {
var Mp=tab.url.substring(0,23);
if(Mp=='https://www.example.com')
{
onWindowLoad();

chrome.extension.onMessage.addListener(function(request, sender) {
    if (request.action == "getSource")
    {
    ...Working here
    }
});
}
else
{
message.innerHTML='<span style="color: #f00">This is not a valid page</span>';
}
});

function onWindowLoad()
{
var message = document.querySelector('#message');
chrome.tabs.executeScript(null, {file: "getPagesSource.js"});
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-30T03:10:12.817

我不得不做出妥协，所以在 getSelected 之后我添加了以下行：

```
chrome.browserAction.disable(tab.Id); 
```

它禁用了操作按钮，因此在脚本将数据发送到服务器时无法单击它，就像使用此扩展程序一样，我抓取标签 URL 以便将其存储在我的数据库中。在ajax响应并添加以下内容之后

```
if(xhr.readyState==4)
{
message.innerHTML=xhr.responseText;
chrome.browserAction.enable(tab.Id); /////<---THAT LINE
} 
```

该按钮再次准备好被点击。

我找不到在几秒钟内添加特定延迟的方法，这种方法看起来很愚蠢，但它可以工作，因为来自我的服务器的响应延迟足以切换操作按钮的 2 种状态。

然而，有了这个，另一个问题出现了，我将在不同的问题中写出来。

# c# - 为什么处理排序数组比处理未排序数组慢？

> ID：14023988
> 
> 赞同：246
> 
> 时间：2012-12-24T17:09:49.333
> 
> 标签：c#, .net, performance, language-agnostic

我有一个包含 500000 个随机生成的`Tuple<long,long,string>`对象的列表，我正在对这些对象执行简单的“介于”搜索：

```
var data = new List<Tuple<long,long,string>>(500000);
...
var cnt = data.Count(t => t.Item1 <= x && t.Item2 >= x); 
```

当我生成随机数组并搜索 100 个随机生成的值时`x`，搜索在大约四秒内完成。[然而，知道排序对搜索](https://stackoverflow.com/questions/11227809/why-is-processing-a-sorted-array-faster-than-an-unsorted-array)的巨大奇迹，我决定在运行我的 100 次搜索之前对我的数据进行排序 - 首先按`Item1`，然后按`Item2`，最后按。`Item3`由于分支预测，我希望排序后的版本执行得更快一些：我的想法是，一旦我们到达 的点`Item1 == x`，所有进一步的检查`t.Item1 <= x`都会正确地预测分支为“不接受”，从而加快搜索。令我惊讶**的是，排序数组的搜索时间是原来的两倍**！

我尝试切换运行实验的顺序，并为随机数生成器使用不同的种子，但效果是一样的：在未排序数组中的搜索运行速度几乎是在同一数组中搜索的两倍，但是排序！

有人对这种奇怪的效果有很好的解释吗？我的测试源代码如下；我正在使用 .NET 4.0。

* * *

```
private const int TotalCount = 500000;
private const int TotalQueries = 100;
private static long NextLong(Random r) {
    var data = new byte[8];
    r.NextBytes(data);
    return BitConverter.ToInt64(data, 0);
}
private class TupleComparer : IComparer<Tuple<long,long,string>> {
    public int Compare(Tuple<long,long,string> x, Tuple<long,long,string> y) {
        var res = x.Item1.CompareTo(y.Item1);
        if (res != 0) return res;
        res = x.Item2.CompareTo(y.Item2);
        return (res != 0) ? res : String.CompareOrdinal(x.Item3, y.Item3);
    }
}
static void Test(bool doSort) {
    var data = new List<Tuple<long,long,string>>(TotalCount);
    var random = new Random(1000000007);
    var sw = new Stopwatch();
    sw.Start();
    for (var i = 0 ; i != TotalCount ; i++) {
        var a = NextLong(random);
        var b = NextLong(random);
        if (a > b) {
            var tmp = a;
            a = b;
            b = tmp;
        }
        var s = string.Format("{0}-{1}", a, b);
        data.Add(Tuple.Create(a, b, s));
    }
    sw.Stop();
    if (doSort) {
        data.Sort(new TupleComparer());
    }
    Console.WriteLine("Populated in {0}", sw.Elapsed);
    sw.Reset();
    var total = 0L;
    sw.Start();
    for (var i = 0 ; i != TotalQueries ; i++) {
        var x = NextLong(random);
        var cnt = data.Count(t => t.Item1 <= x && t.Item2 >= x);
        total += cnt;
    }
    sw.Stop();
    Console.WriteLine("Found {0} matches in {1} ({2})", total, sw.Elapsed, doSort ? "Sorted" : "Unsorted");
}
static void Main() {
    Test(false);
    Test(true);
    Test(false);
    Test(true);
} 
```

* * *

```
Populated in 00:00:01.3176257
Found 15614281 matches in 00:00:04.2463478 (Unsorted)
Populated in 00:00:01.3345087
Found 15614281 matches in 00:00:08.5393730 (Sorted)
Populated in 00:00:01.3665681
Found 15614281 matches in 00:00:04.1796578 (Unsorted)
Populated in 00:00:01.3326378
Found 15614281 matches in 00:00:08.6027886 (Sorted) 
```

* * *

## 回答 #1

> 赞同：280
> 
> 时间：2012-12-24T17:37:34.120

当您使用未排序列表时，所有元组都按**memory-order**访问。它们已在 RAM 中连续分配。CPU 喜欢顺序访问内存，因为它们可以推测性地请求下一个高速缓存行，因此它总是在需要时出现。

当您对列表进行排序时，您会将其**按随机顺序排列**，因为您的排序键是随机生成的。这意味着对元组成员的内存访问是不可预测的。CPU 无法预取内存，几乎每次访问元组都是缓存未命中。

**这是GC 内存管理**的特定优势的一个很好的例子：一起分配并一起使用的数据结构执行得非常好。它们有很大**的参考意义**。

在这种情况下，缓存未命中的惩罚**超过了保存的分支预测惩罚**。

尝试切换到`struct`-tuple。这将恢复性能，因为在运行时不需要指针取消引用来访问元组成员。

Chris Sinclair 在评论中指出*“对于大约 10,000 或更少的 TotalCount，排序后的版本确实执行得更快*”。这是因为一个小列表**完全适合 CPU 缓存**。内存访问可能无法预测，但目标始终在缓存中。我相信仍然会有一个小的惩罚，因为即使从缓存加载也需要一些周期。但这似乎不是问题，因为**CPU 可以处理多个未完成的负载**，从而提高吞吐量。每当 CPU 遇到内存等待时，它仍然会在指令流中加速以尽可能多地排队内存操作。该技术用于隐藏延迟。

这种行为表明在现代 CPU 上预测性能是多么困难。**从顺序访问到随机访问时，我们只慢了 2 倍**这一事实告诉我，隐藏内存延迟的背后到底发生了多少事情。一次内存访问会使 CPU 停顿 50-200 个周期。鉴于第一个可能期望程序在引入随机内存访问时会变慢 10 倍以上。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-12-25T15:43:35.543

LINQ 不知道您的列表是否已排序。

由于带有谓词参数的 Count 是所有 IEnumerables 的扩展方法，所以我认为它甚至不知道它是否以有效的随机访问在集合上运行。因此，它只检查每个元素，然后*Usr*解释了性能下降的原因。

要利用排序数组的性能优势（例如二进制搜索），您必须进行更多编码。