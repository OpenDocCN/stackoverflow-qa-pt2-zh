# StackOverflow 问答 14035000-14035999

# javascript - Node.js 中的并行函数调用

> ID：14035015
> 
> 赞同：7
> 
> 时间：2012-12-26T00:46:22.887
> 
> 标签：javascript, node.js, function, asynchronous

我需要在 Node.js 中做一些独立的数据库查询。执行完所有查询后，应发送响应。我的第一次尝试是这样的：

```
templateData = {};

model.getA(function(result) {
    templateData.A = result;

    model.getB(function(result) {
        templateData.B = result;

        model.getC(function(result) {
            templateData.C = result;

            response.send('template', templateData);
        })
    })
}); 
```

当然，Node.js 中的这种方法一点都不好，因为所有函数都是按顺序调用的，我失去了异步编程模式的优势。我是 Node.js 的新手，我仍然不清楚如何调用`getA()`，`getB()`并`getC()`在一切完成后并行发送响应。是否有一些非常简单和常见的方法来实现这一目标？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-12-26T00:50:39.150

使用[异步包](https://github.com/caolan/async)：（`npm install async`）

```
async.parallel([
    function(){ ... },
    function(){ ... }
], callback); 
```

[https://github.com/caolan/async#parallel](https://github.com/caolan/async#parallel)

或者，您可以使用[承诺](https://github.com/kriskowal/q)：

```
Q.spread(
    [ model.getA(), model.getB(), model.getC() ],
    function(a, b, c) {
        // set templateData
        return templateData;
    }
).then(...); 
```

（假设`get*()`方法返回承诺）

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-26T00:59:15.720

您可以只使用一个函数来检查所有数据是否存在作为您对查询的回调，如果所有数据都存在，则可以发送响应。所以像

```
function checkData(){
    if (templateData.A && templateData.B && templateData.C){
        //send your response
    }
} 
```

然后不要嵌套你的电话

```
model.getA(function(result){
    templateData.A = result;
    checkData();
}

model.getB(function(result){
    templateData.B = result;
    checkData();
}

model.getC(function(result){
    templateData.C = result;
    checkData();
} 
```

当所有三个都完成后，您的回复将被发送。

# python - python多维排序，组合值

> ID：14035022
> 
> 赞同：0
> 
> 时间：2012-12-26T00:47:55.437
> 
> 标签：python, list, sorting, multidimensional-array

我有一个多维列表，我想对两个数字元素的组合权重进行排序，例如，结果使用：`sorted(results, key=operator.itemgetter(2,3))`

```
[..,1,34]
...
...
[..,10,2]
[..,11,1]
[..,13,3]
[..,13,3]
[..,13,3]
[..,16,1]
[..,29,1] 
```

itemgetter 的问题是首先按元素 2 排序，然后按元素 3 排序，我希望在顶部/底部有 13,3（取决于 asc/desc 排序）。

这是否可能，如果可以，如何。

非常感谢

编辑 1。

对不起，我正在处理 dom 数据，来自搜索页面的结果，可以这么说，它是一个通用的搜索引擎搜索器。

我正在做的是找到 a 和 div 标签，然后我创建一个特定类或 id 出现在 div/a 标签上的项目的计数，这是元素 2，然后我再次重新扫描找到的标签列表，看看是什么标签的其他类/id 与正在处理的当前标签的总数匹配，因此在这种情况下，项目 13,3 有 13 个与该类型标签的类/id 匹配，3 表示还有 3 个其他标签与类/ id 出现的次数相同，因此为什么我希望这样排序，不，它不是字典，它绝对是一个列表。

谢谢你。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-26T00:58:06.027

I'm making a total guess here, given lack of any other explanation, and assuming what you're actually trying to do is sort by the **product** of the last two keys in your list, secondarily sorted by magnitude of the **first element in the product**. That's the only explanation I can come up with offhand for why `(13,3)` would be the top result.

In that case, you'd be looking for something like this:

```
sorted(results, key=lambda x: (x[-2]*x[-1], x[-2]), reverse=True) 
```

That would give you the following sort:

```
[[13, 3], [13, 3], [13, 3], [1, 34], [29, 1], [10, 2], [16, 1], [11, 1]] 
```

**Alternatively,** if what you're actually looking for here is to have the results ordered by the number of times they appear in your list, we can use a `collections.Counter`. Unfortunately, lists aren't hashable, so we'll cheat a bit and convert them to tuples to use as the keys. There are ways around this, but this is the simplest way for me for now to demonstrate what I'm talking about.

```
import collections, json
def sort_results(results):
    c = collections.Counter([tuple(k) for k in results])
    return sorted(c, key=lambda x: c[x], reverse=True) 
```

This gets you:

```
[(13, 3), (1, 34), (16, 1), (29, 1), (11, 1), (10, 2)] 
```

*Thanks **J.F. Sebastian** for pointing out that tuples could be used instead of `str`!*

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-26T00:57:48.030

Yes, you can write whatever function you want as the key function. For example, if you wanted to sort by the sum of the second and third elements:

```
def keyfunc(item):
    return sum(operator.itemgetter(2, 3)(item))

sorted(results, key=keyfunc) 
```

So if you used this function as your `keyfunc`, the item with 13 as the second element 3 as the third element of the list would be sorted as though it were the value 16.

It's not clear how you want to sort these elements, but you can change the body of `keyfunc` to perform whatever operation you'd like.

# javascript - 使用 javascript/jquery 加载 css 背景图像时的测试错误

> ID：14035023
> 
> 赞同：1
> 
> 时间：2012-12-26T00:48:11.303
> 
> 标签：javascript, jquery, css, imageurl

我的问题是，如何测试背景图像是否已正确加载？

本质上我有一些 div， `<div id="photo" style="background-image:url('someURL')">`有些得到拒绝访问错误，或者不存在，我需要知道什么时候可以避免没有背景图像。

我知道它们是否是我可以使用的图像，`$("#image").error(function(){});`但令人沮丧的是我不能在这里使用，并且调用`css.("background-image")`不会产生错误，我认为它可能会产生错误，它只是返回完全无用的 url。

我的另一个想法是使用 URL 生成一个隐藏的图像元素，并测试它是否正确加载，但我将处理很多图像，我宁愿有一个更优雅的解决方案。

如果有人知道我如何测试背景图像或图像 URL 返回图像，我会很高兴。

* * *

更新

我尝试使用以下形式的图像预加载器；

```
$.each($(".photo"), function(){
  var theURL = $(this).css('background-image'),
    theURL = theURL.replace('url(',''),
    theURL = theURL.replace(')',''),
    testImage = new Image(theURL); 
```

但是新的测试图像没有错误方法，而且无论是不是scr的问题，显然都是0宽度，所以我又被难住了。

我也尝试使用[ajax 查询](http://www.ambitionlab.com/how-to-check-if-a-file-exists-using-jquery-2010-01-06)，但这种情况的一个特点是我正在设计一个 tumblr 主题，并且断开的链接返回自动生成的错误页面，ajax 似乎认为意味着目标已加载。

# java - 在 Java Web 应用程序中使用 Mailjet.com 的 API

> ID：14035026
> 
> 赞同：0
> 
> 时间：2012-12-26T00:48:52.317
> 
> 标签：java, mailjet

我想利用 Mailjet 的 API 来获取一些信息并将其发布到 Mailjet。

这是通过 HTTP GET 和 POST 请求完成的。

获取特定电子邮件地址的一些信息的示例如下：

[https://eu.mailjet.com/docs/api/contact/infos](https://eu.mailjet.com/docs/api/contact/infos)

如何从 Java Web 应用程序中调用它并获取 Java 中的信息数组？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-26T03:24:03.670

我找到了解决方案。

我使用了 Apache HttpComponents 库。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-11-27T17:07:22.947

万一这出现在类似的搜索中，我们有一个 Java 包装器可以在这里提供帮助：

[https://github.com/mailjet/mailjet-apiv3-java](https://github.com/mailjet/mailjet-apiv3-java)

一切顺利。

托比。

# javascript - Javascript中的正则表达式解析输入onKeyDown

> ID：14035033
> 
> 赞同：1
> 
> 时间：2012-12-26T00:51:30.873
> 
> 标签：javascript, regex

我正在使用 onKeyDown 和正则表达式来解析键盘输入。我需要它到所有 AZ、退格和问号。问题来自？，我无法接受它。我试过 **/[AZ\x08?]/**
**/[AZ\x08\?]/**
**/[AZ\x08\\?]/**
**/[AZ\x08\x3F]/**

其中没有一个允许 ? 被接受。

```
function kd(evt) {
    var theEvent = evt || window.event;
    var key = theEvent.keyCode || theEvent.which;
    key = String.fromCharCode(key);
    var regex = /[A-Z\x08]/;
    if (!regex.test(key)) {
        theEvent.returnValue = false;
        if (theEvent.preventDefault) theEvent.preventDefault();
    }
} 
```

任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-26T00:52:28.117

问号应该放在[字符类](http://www.regular-expressions.info/charclass.html)中：

```
/[A-Z\x08?]/ 
```

另一个问题是您应该使用`onkeypress`来确定输入了哪个字符。`onkeyup`and事件只告诉您按下和释放了`onkeydown`哪些键，但它们没有说明这些对应的字符。在不同的键盘上，您必须按不同的键才能生成相同的字符。

例如，在我的键盘上，我必须按下`Shift`并`+`获得一个`?`. 在美式键盘上，您通常必须按`Shift`和`/`才能获得`?`. 由于键盘布局的这种差异，使用 onkeyup 和 onkeydown 事件来检测是不可靠的`?`。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-26T01:09:17.140

如果要防止在 reg 匹配时在文本框中打印字符，则应使用 keypress。注册是：`/^[a-zA-Z\x08\?]$/`. 这对我有用。

```
var regex = /^[a-zA-Z\x08\?]$/;
// OR this one if you want uppercase letters:
var regex = /^[A-Z\x08\?]$/;
$("#regtest").keypress(function(event) {
    var _event = event || window.event;
    var key = _event.keyCode || _event.which;
    alert(key);
    key = String.fromCharCode(key);
    alert(key);
    if(regex.test(key)) {
        _event.returnValue = false;
        if (_event.preventDefault)
            _event.preventDefault();
    }
}); 
```

# ios - 导出您的 iOS 应用程序

> ID：14035040
> 
> 赞同：3
> 
> 时间：2012-12-26T00:53:59.613
> 
> 标签：ios, xcode

> **可能重复：**
> [您如何对 iphone 应用程序进行 beta 测试？](https://stackoverflow.com/questions/40154/how-do-you-beta-test-an-iphone-app)

在 Android 中，您可以导出您的应用程序并获取可以安装在任何手机上进行测试的 .apk 文件。这对 Xcode 和 iOS 可行吗？我的意思是，我被分配了一份工作，我想发送我的第一个演示。

我的问题如下：

1）我应该寄什么？.apk 文件有类似的东西吗？
2）我知道发布应用程序的程序。如果我只是想发送测试，我必须创建一个分发配置文件和所有员工吗？问题是最终的应用程序不会从我的开发者帐户发布，而是从员工的帐户发布。那是问题吗？
3）我将发送我的文件的人是否需要 Xcode 来运行应用程序或其他东西？在他付钱给我之前，我不想把我的代码发给他。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-12-26T00:57:13.177

您可以通过将应用程序构建为“ADHOC”版本来发送应用程序的演示文件，但要做到这一点，您需要您想要在其上运行演示应用程序的所有设备的设备标识符 (UUID)（换句话说，这是您要询问的“分发配置文件”；您需要创建一个包含在可分发应用程序包中的配置文件）。[以下是一些可以帮助您入门的说明](http://answers.oreilly.com/topic/1434-how-to-prepare-an-iphone-app-for-ad-hoc-distribution/)。

该人可以通过 iTunes（同步）或通过其设备的 Safari 浏览器直接下载和安装“.ipa”文件来安装您的 ADHOC 应用程序。他们不需要使用 Xcode。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-12-26T00:59:57.793

如果您的客户有 iPhone，请使用 TestFlight - 如果您计划在开发期间发送多个构建，它会使构建临时分发的整个过程更加容易和高效。

您可以在[http://www.testflightapp.com](http://www.testflightapp.com)上查看它们- 他们有很好的入门文档，并且只需几分钟即可开始整个过程​​ - 此外，如果您**不需要**安装他们的 SDK只是将预发布版本发送给 somone。

要更具体地回答您的问题：

1.  为 iOS 开发导出的文件是 .ipa

2.  .ipa 确实必须由临时分发证书签名

3.  如果您使用 TestFlight，您的客户将能够通过电子邮件安装您的应用程序 - 超级简单！

哦，我有没有提到它是完全免费的？:)

编辑：

As *mmc* pointed out, you should check out the basics of Ad-Hoc distribution before using TestFlight, just for your own peace of mind. *mmc* recommended looking at [How do you beta test an iphone app?](https://stackoverflow.com/questions/40154/how-do-you-beta-test-an-iphone-app), and an intro to TestFlight can be found in their tutorial base, [here](http://help.testflightapp.com/customer/portal/articles/829537-how-does-it-work-).

# javascript - execute done callback of jquery $.when() once (in backbone-js app)

> ID：14035042
> 
> 赞同：0
> 
> 时间：2012-12-26T00:54:17.817
> 
> 标签：javascript, jquery, asynchronous, backbone.js, jquery-deferred

I'm looking for a way to "unbind" jQuery's `$.when()` after the `.done()` callback has been executed a single time, analogous to using jQuery's `.one()` instead of `.on()` for a single event. The reason why I am using deferred objects instead of events in this circumstance is because I need to wait for multiple asynchronous processes to complete before the callback can be executed.

To go into more detail, I'm working on a backbone application where I have a model and view for each page. The sequence of displaying a new page looks something like this:

1.  view for the incoming page (call it page A) is told to render
2.  `$.when()` is used by page A to wait for asynchronous processes (3, 4 & 5) to resolve
3.  data for page A is loaded from the server, populating the model
4.  images in page A's model are preloaded
5.  the previous page, page B, finishes closing (animation is complete)
6.  page A is rendered

This works fine in a hypothetical scenario where each page is only visited once by a user. However, pages are obviously subject to repeat visits, which means that when page B is opened and closed again after the user navigates elsewhere on the website, the deferred object related to the completion of it's `.close()` method is resolved once more, executing the code block of the `.done()` callback in page A's `.render()` method, which is not good.

Ideally, the `$.when().done()` code block would be "unbound" as soon as it is executed once, or in the `.close()` method of each page, just as many other event listeners are unbound.

I'm not sure if this is even possible, so maybe there as alternative method to achieve what I'm trying to do here? Maybe their is a path that ditches deferreds and listens for multiple events to fire?

Thanks.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-26T22:38:11.627

在内部，jQuery 在其许多方法中使用“回调”队列来管理多个函数（例如事件处理程序）的添加/删除/触发。

这些队列的构造函数公开为`$.Callbacks(flags)`. 可以利用标志“once”、“memory”、“unique”和“stopOnFalse”来控制队列在触发时的详细行为。[在这里](http://api.jquery.com/jQuery.Callbacks/)阅读更多。

我不确定“访问”和“重复访问”的性质是什么，但假设 javascript 状态持续存在，否则你不会有问题。我认为你需要这样的东西：

```
//First let's assume you have three promises, corresponding to your steps 3,4,5
var promiseA = .....;
var promiseB = .....;
var promiseC = .....;

//Then you need one or more worker functions
function myFunction() {
    //do whatever is necessary when promises A,B,C are all resolved.
}

//Create a Callbacks queue with the 'once' flag
var callbacks = $.Callbacks('once');//'once' ensures the callback list can only be fired once.
callbacks.add(myFunction);
//add further callback functions here if necessary.

//Now the glue that puts it all together.
$.when(promiseA, promiseB, promiseC).done(callbacks.fire);

//Or, if you need to pass any paramters to the callback function:
$.when(promiseA, promiseB, promiseC).done(function() {
    callbacks.fire(...);
}); 
```

# solr - Solr 排序似乎不起作用

> ID：14035043
> 
> 赞同：2
> 
> 时间：2012-12-26T00:54:19.350
> 
> 标签：solr

我一直在搜索这个，但我所做的一切，似乎都不起作用，我试过了，

```
cat: wolf; category desc
cat: wolf; sort category desc
$query->setQuery("cat: wolf")->sort("category desc"); 
```

我无法对结果进行排序，我不知道该怎么做。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-26T03:42:24.857

排序在多值和标记化字段上效果不佳。

[文档](http://wiki.apache.org/solr/CommonQueryParameters#sort)

> 排序可以在文档的“分数”上进行，也可以在任何 multiValued="false" indexed="true" 字段上进行，前提是该字段是未标记的（即：没有分析器）或使用仅生成单个 Term（即：使用 KeywordTokenizer）

使用字符串作为字段类型（或应用了小写过滤器和 ascii 过滤器的 KeywordTokenizer）并将类别字段复制到新字段中。

```
<field name="category_sort" type="string" indexed="true" stored="false"/>

<copyField source="category" dest="category_sort" /> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2020-09-25T08:59:40.350

嗨，我在 solr V 8.6.1 中也面临同样的问题

```
<fieldType name="lowercase2" class="solr.TextField" positionIncrementGap="100">
    <analyzer>
      <tokenizer class="solr.KeywordTokenizerFactory"/>
    </analyzer>
  </fieldType>

  <field name="top_cat_en_US" type="lowercase2" indexed="true" stored="true"/> 
```

# android - 在 Android 应用中存储单个用户的最佳方式是什么？

> ID：14035045
> 
> 赞同：0
> 
> 时间：2012-12-26T00:55:13.360
> 
> 标签：android, sqlite, sharedpreferences

我希望我的应用程序允许单个用户创建每次运行应用程序时都可以访问的配置文件。用户的配置文件包含一个 String 条目和五个 int 条目。我曾考虑过使用 SQLite 数据库来存储会话之间的信息，但这似乎有点矫枉过正，因为我只需要一个表中的一行来存储数据。但是，我不确定是否可以对 String 类型的数据使用 SharedPreferences。

任何人都可以提供一些关于这个问题的见解吗？谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-26T01:02:19.130

是的，您可以使用`SharedPreferences`.

**来写**

```
Editor editor = getSharedPreferences("file_name", MODE_PRIVATE).edit();
editor.clear();
editor.putString("pref_name", myStringValue);
editor.commit(); 
```

**回读**

```
SharedPreferences preferences = getSharedPreferences("file_name", MODE_PRIVATE);
String myStringValue = preferences.getString("pref_name", "default_value"); 
```

问候。

# java - Sending notification to everyone running an application, Android

> ID：14035046
> 
> 赞同：1
> 
> 时间：2012-12-26T00:55:14.513
> 
> 标签：java, android, notifications

Set up: I have a system which has multiple users. Each user will download my app onto their Android phone and use it. What I want is when any user performs a specific action (I have two in my app), I want to pop up a notification in all the other user phones.

A simple break down is like this: Start app --> Navigate to the part where action is performed --> Perform the action --> Store the action the a DB --> Notify ALL USERS --> Pop up the same notification on all phones.

How would I go about this problem? Can anyone suggest ideas or links, cause I don't even have a clue on how to approach this.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-26T05:46:57.433

如果您希望向所有用户发送通知，即使所有用户都没有积极使用该应用程序，那么 Puch Notification 也是一个好方法。

> 推送通知让您的应用程序通知用户新消息或事件，即使用户没有积极使用您的应用程序。在 Android 设备上，当设备收到推送通知时，您的应用程序的图标和一条消息会出现在状态栏中。当用户点击通知时，它们会被发送到您的应用程序。通知可以广播给所有用户，例如营销活动，或仅发送给一部分用户，以提供个性化信息。

看看[Android 谷歌云消息传递](http://www.androidhive.info/2012/10/android-push-notifications-using-google-cloud-messaging-gcm-php-and-mysql/)

我还发现[XMPP是本文所述](http://xmpp.org/)[的](https://stackoverflow.com/a/5695867/1626878)一个很好的解决方案。

你会[在这里](https://stackoverflow.com/questions/1243066/does-android-support-near-real-time-push-notification/)和[这里找到一些好的解决方案](https://stackoverflow.com/questions/1378671/push-notifications-in-android-platform?answertab=votes#tab-top)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-26T01:06:08.420

Well, you will need a database on a server, and then you will need the app to constantly (or at intervals) query the database in the background for changes, and notify the user when it finds one. A system similar to how many apps give notifications is what I am getting at.

# java - How to create this custom component?

> ID：14035051
> 
> 赞同：-1
> 
> 时间：2012-12-26T00:56:23.420
> 
> 标签：java, swing, layout-manager, graphics2d, java-2d

[LEC Cube Software](http://profholzer.files.wordpress.com/2010/03/ledcube_designer.png) as seen below.

![enter image description here](../Images/414e36dd1b00112f8581a6b7f34bb731.png)

Any good idea how to draw the component on the left side in a Java application?

Thought about Java2D. But I think with Java2D you can only draw those lines and no checkboxes. Perhaps any good LayoutManager to solve this?

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-26T01:05:37.650

With [checkboxes](http://docs.oracle.com/javase/6/docs/api/javax/swing/JCheckBox.html) and [lines](http://docs.oracle.com/javase/6/docs/api/java/awt/geom/Line2D.html), using some [model of a cube](https://gist.github.com/4376898) (if it's resizable; see below) and [no layout manager](http://docs.oracle.com/javase/tutorial/uiswing/layout/none.html).

![cube](../Images/5a87a0c1446ead1ef48cd05223c40d7f.png)

# c# - 检测图像非正方形部分的鼠标悬停

> ID：14035052
> 
> 赞同：3
> 
> 时间：2012-12-26T00:56:50.743
> 
> 标签：c#, xna, shapes

所以我正在用 XNA/C# 开发一个风险类型的游戏。我有一张类似于[这张](http://i.imgur.com/5RvKD.png)的地图，我需要能够检测每个区域（数字）上的鼠标悬停。如果这些区域是正方形，那就很容易了，因为它们每个都可以用一个矩形来表示。但是，它们是不同大小的多边形。是否存在类似于正方形的多边形？如果没有，我该怎么做呢？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-26T01:08:40.307

我建议这样做：为每个数字附加颜色，用这些颜色重新创建您的图片：每个形状都将具有其特定的颜色。不要在屏幕上绘制，仅用作参考地图。当用户在您的原始地图上单击或移动鼠标时，您只需将鼠标坐标投影到颜色地图中，检查鼠标下方像素的颜色，因为您将每种颜色与区域数相关联......

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-26T01:17:33.007

这不是 c# 特定的（因为我从来没有用这种语言写过任何东西，所以不知道有什么 api），尽管有两种算法可以用来检测一个点是否在多边形内（可以使用检测鼠标点是否在另一个多边形/地图形状上）。

一种是基于光线投射，您将光线从（鼠标）点沿 1 个方向投射到“无穷远”（在这种情况下为板的边缘），并计算它穿过多边形边缘的次数。如果是奇数，则该点在多边形内，如果是偶数，则该点在多边形外。

它的 wiki 链接：[http ://en.wikipedia.org/wiki/Point_in_polygon#Ray_casting_algorithm](http://en.wikipedia.org/wiki/Point_in_polygon#Ray_casting_algorithm)

想到的另一种算法仅适用于我认为的三角形，但我认为它可以更简单地实现（快速浏览一下您的形状，我认为它们可以很容易地分解为三角形，有些已经是三角形）。这与检查该点是否位于三角形所有边的同一（内部）“边”有关。要找出一个点与边缘的“边”，您需要创建 2 个向量，第一个向量将是边缘本身（由 2 个点组成），另一个向量将是该边缘的第一个点到输入点，然后计算这两个向量的叉积。结果将是负数或正数，可用于确定“方向”。

指向它的链接：http: [//www.blackpawn.com/texts/pointinpoly/default.html](http://www.blackpawn.com/texts/pointinpoly/default.html) （在该页面上是另一种也适用于三角形的算法）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-26T13:27:28.327

实时对多边形进行命中测试并不难。如果地图很大，您可以使用 KD-Tree 进行优化。否则`Contains`，为多边形找到一个简单的方法并使用它。我在另一台电脑上有一个。让我知道你是否愿意。

# jetty - 从外部机器访问 Jetty 服务器

> ID：14035062
> 
> 赞同：1
> 
> 时间：2012-12-26T00:59:25.850
> 
> 标签：jetty, localhost

我在这里使用本教程制作了一个简单的 Jetty 服务器，[http://www.seas.upenn.edu/~cis550/jetty.html](http://www.seas.upenn.edu/~cis550/jetty.html)

现在我已经完成了初始步骤，我可以通过在浏览器中输入 localhost:8080/hello 或 127.0.0.1:8080/hello 成功连接到我的服务器。到目前为止，一切都很好。servlet 工作正常。

我现在有兴趣使用“机器 B”连接到服务器。我想构建一个可以在任何地方通过任何浏览器连接的服务器。

我的 IP 是 XX.173.XXX.216，出于明显的隐私原因隐藏了部分内容。在我的“机器 B”上，我尝试在浏览器 URL 中输入 XX.173.XXX.216:8080/hello。找不到该网站。根据经验，我质疑我的端口映射并打开了我的 8080 端口。

经过几次谷歌搜索和一段时间的阅读，我放弃了。有谁知道我的问题的可能解决方案？在设置 Jetty 服务器以使其可以从外部机器访问时，我还需要执行其他步骤吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-26T01:10:36.887

从防火墙*内部**进出*通常并不难。从外部和内部获取要复杂得多（只需看看 Skype 跳过的箍，以便能够让两台计算机各自在防火墙后面直接相互交谈）。

首先，您需要确保 Jetty 监听正确的网络设备。

确定运行 Jetty 的计算机的 IP 号（不是 127.0.0.1），看看您是否可以从机器本身连接到“http://that-ip-number:8080”。如果这不起作用，请修复您的码头配置。然后将另一台计算机放在同一网络上并连接到“http://that-ip-number:8080”。在你走得更远之前，这必须有效。如果这不起作用，请在运行 Jetty 的计算机上修复防火墙配置。

当上述工作正常时，您可以开始考虑通过路由器公开端口。路由器很可能有一个 Web 界面，您可以在其中进行配置，但最简单的方法是使用 uPNP 工具（如果您的路由器支持），该工具可以将外部端口重定向到内部网络上的特定主机和端口. 我在 OS X 下使用“端口映射”，它有一个非常简单的界面。

祝你好运

# c++ - 代码块 - 使用大地址感知标志编译

> ID：14035065
> 
> 赞同：0
> 
> 时间：2012-12-26T01:00:45.890
> 
> 标签：c++, memory, gcc, mingw, codeblocks

如何`LARGE_ADRESS_AWARE`使用 Codeblocks 在 64 位系统上编译带有标志的 32 位应用程序？我需要使用超过 2GB 的内存。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-26T01:12:11.810

应该是添加`-Wl,--large-address-aware`到链接标志的情况。我不使用 CodeBlocks，因此无法告诉您如何逐步执行此操作，但我确信您的项目设置中有一个“链接选项”组件，您可以将此字符串添加到其中。

链接器选项：http: [//sourceware.org/binutils/docs-2.17/ld/Options.html](http://sourceware.org/binutils/docs-2.17/ld/Options.html)

编辑：当然，如果您的系统上有足够现代的 gcc-mingw，您应该能够将 -m64 用于编译和链接阶段，并获得本机 64 位应用程序，此时您可以用作你喜欢多少内存（好吧，直到你用尽交换空间或 48 位地址范围，以先到者为准 - 可能是交换空间 - 除非你有超过 256TB 的磁盘空间......）

# javascript - JavaScript 按钮相互冲突

> ID：14035066
> 
> 赞同：0
> 
> 时间：2012-12-26T01:00:58.567
> 
> 标签：javascript, css, button, input, background

嗨，我的页面上有 3 个不同的按钮，用于更改页面的背景图像/颜色。我遇到的问题是，一旦使用其他按钮中的一个将图像设置为背景，我的主切换按钮就不会切换背景。

如果我按下运行此功能的按钮...

```
$( "body" ).toggleClass( "bgimg", 1000 ); 
```

然后我可以使用此按钮设置背景图像。

```
$("#SetBG").click(function() { 
```

如果我不按 toggleClass 按钮，则不会设置背景图像。就像必须在页面上设置 .bgimg 类一样，我才能对其进行编辑？

另一个问题是，一旦我设置了背景图像，.toggleClass 按钮就不起作用了！.bgimg 类不会切换。

CSS：

```
body {
margin: 0px;
padding: 0px;
border: 0px;
}

.bgimg {
} 
```

HTML：

```
<input type="text" id="ImageURL"></input>
<button id="SetBG">Set Background</button>
<button id="ReSetBG">Re-Set</button> 
```

JavaScript：

```
$(function() {
    $( "#DialogBackground" ).dialog({
    open: function (event, ui) {$(".ui-widget-overlay").css({opacity: 0, filter: "Alpha(Opacity=00)"});},
    modal:true,
    autoOpen:false,
    height:450,
    width:450,
    resizable: false,
    buttons: [{
        id:"remove",
        text: "Remove/Add Background",
        click: function() {
        $( "body" ).toggleClass( "bgimg", 1000 );
        return false;
        }
    }]
    });

$("#SetBG").click(function() {
    var URL = document.getElementById("ImageURL").value;
    $(".bgimg").css('background-image',"url(" +URL +")");
    return false;
});

$('#ReSetBG').click(function() {
$('.bgimg').css('background-image', "url('http://192.168.0.4/DesktopVersion/Inc/Images/Background/DarkWood.jpg')");
return false;
}); 
```

如果有人可以请告诉我哪些代码是错误的或有冲突的，那就太好了。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-26T20:31:16.323

> 如果我不按 toggleClass 按钮，则不会设置背景图像。就像必须在页面上设置 .bgimg 类一样，我才能对其进行编辑？
> 
> 另一个问题是，一旦我设置了背景图像，.toggleClass 按钮就不起作用了！.bgimg 类不会切换。

您正在混合 2 个不同的 css 概念，内联规则和样式表规则。当您说类似以下内容时，您在做什么：

```
$('.bgimg').css('background-image', "url('http://192.168.0.4/DesktopVersion/Inc/Images/Background/DarkWood.jpg')"); 
```

以类名作为目标元素`bgimg`并应用此内联 css 规则：

```
background-image: url('http://192.168.0.4/DesktopVersion/Inc/Images/Background/DarkWood.jpg')" 
```

因此，如果类中`bgimg`没有元素，则不会发生任何事情。但是，如果它确实存在，则将应用**内联css 规则。**如果您删除该类，则不会发生任何变化，因为 css 不是按类在样式表中定义的，而是在元素本身上定义的。为了让您的东西以您想要的方式工作，您将需要在您的 css 中定义 2 种不同的样式并用于`toggleClass`在两者之间切换或将类`bgimg`始终保留在元素上并用于`$('.bgimg').css('background-image', "")`删除背景图像和现有代码添加/更改。

# git - 如何显示我当前工作目录和我上次提交的差异？

> ID：14035068
> 
> 赞同：5
> 
> 时间：2012-12-26T01:01:23.133
> 
> 标签：git, staging, git-diff, working-directory

我正在使用 git 并且需要包含在差异结果未跟踪文件中。那么我必须执行什么命令才能获得当前工作目录和 HEAD 之间的所有差异，甚至部分差异存在于新文件添加中？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-12-26T01:18:57.733

嗯，`git diff`？毕竟，这就是它的作用。

**更新：** “不在暂存区的文件”并不意味着“未跟踪的文件”。这是两个不同的类别。文件或更改在您执行时变为“暂存” `git add`。未跟踪的文件是 git 目前未跟踪的文件，这些文件似乎是您根据您的评论询问的文件。我知道没有办法让 git 向您显示未跟踪文件的差异。考虑到他们没有被追踪，这真的没有意义。您所要求的只是查看某些文件的内容。Git 确实能够使用 列出未跟踪的文件`ls-files`，因此如果您处于类似 *nix 的环境中，您可以轻松地构建一个命令来执行您正在寻找的事情：

```
git ls-files -o | xargs cat 
```

该`-o`选项告诉它列出所有未跟踪文件的名称。以上内容自然会将所有未跟踪文件的内容打印到标准输出。

# javascript - 在 Javascript 中从 Android 发送二进制数据

> ID：14035077
> 
> 赞同：8
> 
> 时间：2012-12-26T01:04:45.013
> 
> 标签：javascript, android, android-canvas

我正在尝试`canvas.toDataURL()`通过 Android 2.3 浏览器上的 Javascript API 发送到 Facebook，但由于某种原因，它似乎不起作用。我尝试使用发送`XMLHttpRequest.sendAsBinary`但我不断收到

> {\n \"error\": {\n \"message\": \"(#324) 需要上传文件\",\n \"type\": \"OAuthException\",\n \"code\ ": 324\n }\n}

问题是这在 Google Chrome 的桌面浏览器中运行良好。如何在 Android 上通过 Javascript 发送表单二进制数据？

[示例代码在这里](http://pastebin.com/7FCiTTaS)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-07-29T09:26:00.013

粘贴箱已被移除。但是为什么不检查新的 FormData HTML5 功能。它可以让你通过 Ajax 发送一个表单（一个像正常一样的真实表单）：[https ://developer.mozilla.org/en-US/docs/Web/Guide/Using_FormData_Objects](https://developer.mozilla.org/en-US/docs/Web/Guide/Using_FormData_Objects)

您可以像往常一样发送文件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-08-24T14:43:54.550

实际上，

它似乎是特定于设备的，我已经使用了 Ajax 和基于设备的表单提交的解决方法

# javascript - jQuery - 滚动停止上的绑定事件

> ID：14035083
> 
> 赞同：19
> 
> 时间：2012-12-26T01:05:56.807
> 
> 标签：javascript, jquery, scroll

如果我想在页面滚动上绑定一个事件，我可以使用`scroll();`.

但是结束时如何开火`scroll()`？

我想重现这个：

```
 $(window).scroll(function(){
    //do somenthing
    });

    $(window).scrollSTOPPED(function(){  //--> when i'm scrolling then i stop to scrolling (so NOT when page scrollbar is at the end top or bottom :)
    //do somenthing else
    }); 
```

有任何想法吗？

* * *

## 回答 #1

> 赞同：46
> 
> 时间：2012-12-26T01:23:58.773

# 小jquery方式

```
$.fn.scrollStopped = function(callback) {
  var that = this, $this = $(that);
  $this.scroll(function(ev) {
    clearTimeout($this.data('scrollTimeout'));
    $this.data('scrollTimeout', setTimeout(callback.bind(that), 250, ev));
  });
}; 
```

在最后一个滚动事件 250 毫秒后，这将调用“scrollStopped”回调。

[http://jsfiddle.net/wtRrV/256/](http://jsfiddle.net/wtRrV/256/)

### lodash（甚至更小）

```
function onScrollStopped(domElement, callback) {
  domElement.addEventListener('scroll', _.debounce(callback, 250));
} 
```

[http://jsfiddle.net/hotw1o2j/](http://jsfiddle.net/hotw1o2j/)

### 纯 js（技术上最小的）

```
function onScrollStopped(domElement, callback, timeout = 250) {
  domElement.addEventListener('scroll', () => {
    clearTimeout(callback.timeout);
    callback.timeout = setTimeout(callback, timeout);
  });
} 
```

[https://jsfiddle.net/kpsxdcv8/15/](https://jsfiddle.net/kpsxdcv8/15/)

### 奇怪的事实

clearTimeout 和 clearInterval 参数不必定义，甚至可以是错误的类型，甚至可以省略。

[http://jsfiddle.net/2w5zLwvx/](http://jsfiddle.net/2w5zLwvx/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-26T01:20:05.437

事件本身不存在，因为滚动是每次用户滚动一定增量时触发的单个事件。

但是，您可以做的是模拟事件。

这要归功于 James Padolsey，来自他的网页：。在此处阅读以全面了解代码及其实现方式。

[http://james.padolsey.com/javascript/special-scroll-events-for-jquery/](http://james.padolsey.com/javascript/special-scroll-events-for-jquery/)

> （功能（）{
> 
> ```
> var special = jQuery.event.special,
>     uid1 = 'D' + (+new Date()),
>     uid2 = 'D' + (+new Date() + 1);
> 
> special.scrollstart = {
>     setup: function() {
> 
>         var timer,
>             handler =  function(evt) {
> 
>                 var _self = this,
>                     _args = arguments;
> 
>                 if (timer) {
>                     clearTimeout(timer);
>                 } else {
>                     evt.type = 'scrollstart';
>                     jQuery.event.handle.apply(_self, _args);
>                 }
> 
>                 timer = setTimeout( function(){
>                     timer = null;
>                 }, special.scrollstop.latency);
> 
>             };
> 
>         jQuery(this).bind('scroll', handler).data(uid1, handler);
> 
>     },
>     teardown: function(){
>         jQuery(this).unbind( 'scroll', jQuery(this).data(uid1) );
>     }
> };
> 
> special.scrollstop = {
>     latency: 300,
>     setup: function() {
> 
>         var timer,
>                 handler = function(evt) {
> 
>                 var _self = this,
>                     _args = arguments;
> 
>                 if (timer) {
>                     clearTimeout(timer);
>                 }
> 
>                 timer = setTimeout( function(){
> 
>                     timer = null;
>                     evt.type = 'scrollstop';
>                     jQuery.event.handle.apply(_self, _args);
> 
>                 }, special.scrollstop.latency);
> 
>             };
> 
>         jQuery(this).bind('scroll', handler).data(uid2, handler);
> 
>     },
>     teardown: function() {
>         jQuery(this).unbind( 'scroll', jQuery(this).data(uid2) );
>     }
> };   })(); 
> ```

可能值得注意的是，有几个问题与您的问题有关，所以这可能是重复的。例如 [Javascript：在用户完成滚动后执行操作，](https://stackoverflow.com/questions/4289473/javascript-do-an-action-after-user-is-done-scrolling) 并[在使用 javascript 滚动滚动条或鼠标滚轮后触发事件](https://stackoverflow.com/questions/8931605/fire-event-after-scrollling-scrollbars-or-mousewheel-javascript)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-26T01:23:24.280

您可以验证是否`window.scrollY == 0`

```
$(window).scroll(function(){
  if (window.scrollY == 0) {
    //...
  }
}); 
```

但是这个事件会在每次滚动时触发。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-09-10T01:17:45.720

我更喜欢能够收听事件。这就是我所做的：

jquery插件：

```
+function(jQuery){
        var scrollStopEventEmitter = function(element, jQuery) {
            this.scrollTimeOut = false;
            this.element       = element;
            jQuery(element).on('scroll', $.proxy(this.onScroll, this));
        }

        scrollStopEventEmitter.prototype.onScroll = function() 
        {
            if (this.scrollTimeOut != false) {
              clearTimeout(this.scrollTimeOut);
            }

            var context = this;

            this.scrollTimeOut = setTimeout(function(){ context.onScrollStop()}, 250);
        }

        scrollStopEventEmitter.prototype.onScrollStop = function() 
        {
            this.element.trigger('scrollStop');
        }

        jQuery.fn.scrollStopEventEmitter = function(jQuery) {   
            return new scrollStopEventEmitter(this, jQuery);
        };

    }($); 
```

在这种情况下，窗口现在将触发 scrollStop 事件

```
$(window).scrollStopEventEmitter($); 
```

现在我可以在 scrollStop 上收听

```
$(window).on('scrollStop',function(){
        // code 
```

# objective-c - FTDI Communication with USB device - Objective C

> ID：14035084
> 
> 赞同：7
> 
> 时间：2012-12-26T01:06:00.950
> 
> 标签：objective-c, ftdi, dmx512

I'm trying to communicate with the Enttec USB DMX Pro. Mainly receiving DMX.

They released a Visual C++ version [here](http://www.enttec.com/index.php?main_menu=Products&pn=70304&show=downloads), but I'm a little stumped on what to do to convert to Obj-c. Enttec writes, "Talk to the PRO using FTDI library for Mac, and refer to D2XX programming guide to open and talk to the device." Any example apps for Objective-C out there? Is there an easy way to communicate with the Enttec DMX USB Pro?

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2013-01-21T20:42:41.817

我在 Mac 上使用 FTDI 芯片做了大量工作，所以我可以在这里提供一些见解。我使用了他们的 USB 串行转换器的单通道和双通道变体，它们的行为方式都相同。

FTDI 有他们的虚拟 COM 端口驱动程序，它在您的系统上创建一个串行 COM 端口，代表连接到他们的芯片的串行连接，以及他们的 D2XX 直接通信库。您将要使用后者，[可以从他们的网站上为各种平台下载](http://www.ftdichip.com/Drivers/D2XX.htm)。

适用于 Mac 的 D2XX 库采用独立的 .dylib（最新的是 libftd2xx.1.2.2.dylib）或他们最近开始发布的新静态库。该软件包中还包含您需要的相应头文件（ftd2xx.h 和 WinTypes.h）。

在您的 Xcode 项目中，添加 .dylib 作为要链接的框架，并将 ftd2xx.h、WinTypes.h 和 ftd2xx.cfg 文件添加到您的项目中。在 Copy Bundled Frameworks 构建阶段，确保 libftd2xx.1.2.2.dylib 和 ftd2xx.cfg 存在于该阶段。您可能还需要调整此库所需的相对路径，以使其在您的应用程序包中运行，因此您可能需要在命令行中对其运行以下命令：

```
install_name_tool -id @executable_path/../Frameworks/libftd2xx.1.2.2.dylib libftd2xx.1.2.2.dylib 
```

正确配置项目后，您将需要导入 FTDI 标头：

```
#import "ftd2xx.h" 
```

并开始连接到您的串行设备。您在问题中链接到的示例有一个可下载的 C++ 示例，显示了它们如何与设备通信。您可以带入几乎所有使用的 C 代码并将其放置在您的 Objective-C 应用程序中。他们只是看起来使用标准的 FTDI D2XX 命令，可下载[的 D2XX 程序员指南](http://www.ftdichip.com/Support/Documents/ProgramGuides/D2XX_Programmer%27s_Guide%28FT_000071%29.pdf)中详细描述了这些命令。

这是我从我的一个应用程序中提取的一些代码，用于连接到这些设备之一：

```
 DWORD numDevs = 0;
    // Grab the number of attached devices
    ftdiPortStatus = FT_ListDevices(&numDevs, NULL, FT_LIST_NUMBER_ONLY);
    if (ftdiPortStatus != FT_OK)
    {
        NSLog(@"Electronics error: Unable to list devices");
        return;
    }

    // Find the device number of the electronics
    for (int currentDevice = 0; currentDevice < numDevs; currentDevice++)
    {
        char Buffer[64];
        ftdiPortStatus = FT_ListDevices((PVOID)currentDevice,Buffer,FT_LIST_BY_INDEX|FT_OPEN_BY_DESCRIPTION); 
        NSString *portDescription = [NSString stringWithCString:Buffer encoding:NSASCIIStringEncoding];
        if ( ([portDescription isEqualToString:@"FT232R USB UART"]) && (usbRelayPointer != NULL))
        {           
            // Open the communication with the USB device
            ftdiPortStatus = FT_OpenEx("FT232R USB UART",FT_OPEN_BY_DESCRIPTION,usbRelayPointer);
            if (ftdiPortStatus != FT_OK)
            {
                NSLog(@"Electronics error: Can't open USB relay device: %d", (int)ftdiPortStatus);
                return;
            }
            //Turn off bit bang mode
            ftdiPortStatus = FT_SetBitMode(*usbRelayPointer, 0x00,0);
            if (ftdiPortStatus != FT_OK)
            {
                NSLog(@"Electronics error: Can't set bit bang mode");
                return;
            }
            // Reset the device
            ftdiPortStatus = FT_ResetDevice(*usbRelayPointer);
            // Purge transmit and receive buffers
            ftdiPortStatus = FT_Purge(*usbRelayPointer, FT_PURGE_RX | FT_PURGE_TX);
            // Set the baud rate
            ftdiPortStatus = FT_SetBaudRate(*usbRelayPointer, 9600);
            // 1 s timeouts on read / write
            ftdiPortStatus = FT_SetTimeouts(*usbRelayPointer, 1000, 1000);      
            // Set to communicate at 8N1
            ftdiPortStatus = FT_SetDataCharacteristics(*usbRelayPointer, FT_BITS_8, FT_STOP_BITS_1, FT_PARITY_NONE); // 8N1
            // Disable hardware / software flow control
            ftdiPortStatus = FT_SetFlowControl(*usbRelayPointer, FT_FLOW_NONE, 0, 0);
            // Set the latency of the receive buffer way down (2 ms) to facilitate speedy transmission
            ftdiPortStatus = FT_SetLatencyTimer(*usbRelayPointer,2); 
            if (ftdiPortStatus != FT_OK)
            {
                NSLog(@"Electronics error: Can't set latency timer");
                return;
            }                   
        }
    } 
```

断开连接相当简单：

```
 ftdiPortStatus = FT_Close(*electronicsPointer);
        *electronicsPointer = 0;
        if (ftdiPortStatus != FT_OK)
        {
            return;
        } 
```

写入串行设备非常容易：

```
 __block DWORD bytesWrittenOrRead;
    unsigned char * dataBuffer = (unsigned char *)[command bytes];
    //[command getBytes:dataBuffer];
    runOnMainQueueWithoutDeadlocking(^{
        ftdiPortStatus = FT_Write(electronicsCommPort, dataBuffer, (DWORD)[command length], &bytesWrittenOrRead);
    });

    if((bytesWrittenOrRead < [command length]) || (ftdiPortStatus != FT_OK))
    {
        NSLog(@"Bytes written: %d, should be:%d, error: %d", bytesWrittenOrRead, (unsigned int)[command length], ftdiPortStatus);

        return NO;
    } 
```

（`command`是一个 NSData 实例，`runOnMainQueueWithoutDeadlocking()`只是[我用来保证在主队列上执行块的便利功能](https://stackoverflow.com/a/8186206/19679)）。

您可以使用以下内容从串行接口读取原始字节：

```
NSData *response = nil;
DWORD numberOfCharactersToRead = size;
__block DWORD bytesWrittenOrRead;

__block unsigned char *serialCommunicationBuffer = malloc(numberOfCharactersToRead);        

runOnMainQueueWithoutDeadlocking(^{
    ftdiPortStatus = FT_Read(electronicsCommPort, serialCommunicationBuffer, (DWORD)numberOfCharactersToRead, &bytesWrittenOrRead);
});

if ((bytesWrittenOrRead < numberOfCharactersToRead) || (ftdiPortStatus != FT_OK))
{
    free(serialCommunicationBuffer);
    return nil;
}

response = [[NSData alloc] initWithBytes:serialCommunicationBuffer length:numberOfCharactersToRead];
free(serialCommunicationBuffer); 
```

在上面的末尾，`response`将是一个 NSData 实例，其中包含您从端口读取的字节。

此外，我建议您始终从主线程访问 FTDI 设备。尽管他们说他们支持多线程访问，但我发现任何类型的非主线程访问（甚至保证来自单个线程的独占访问）都会导致 Mac 上的间歇性崩溃。

除了我上面描述的情况之外，您可以查阅 D2XX 编程指南以了解 FTDI 在其 C 库中提供的其他功能。同样，您应该只需要从设备制造商提供给您的示例中转移适当的代码。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-02-11T21:17:33.873

我遇到了类似的问题（尝试使用 Objective-C 写入 EntTec Open DMX），但没有成功。在遵循@Brad 的出色回答后，我意识到您每次发送 DMX 数据包时还需要切换 BREAK 状态。

这是我在一些测试代码中的循环示例，该代码在帧之间以 20 毫秒的延迟发送数据包。

```
while (1) {

    FT_SetBreakOn(usbRelayPointer);
    FT_SetBreakOff(usbRelayPointer);

    ftdiPortStatus = FT_Write(usbRelayPointer, startCode, 1, &bytesWrittenOrRead);
    ftdiPortStatus = FT_Write(usbRelayPointer, dataBuffer, (DWORD)[command length], &bytesWrittenOrRead);
    usleep(20000);
} 
```

希望这对其他人有帮助！

# java - GAE：以编程方式访问 blobstore 内容？

> ID：14035089
> 
> 赞同：0
> 
> 时间：2012-12-26T01:07:30.420
> 
> 标签：java, google-app-engine, blobstore

**我的用例：**我不使用 blobstore 上传和下载文件。我使用 blobstore 来存储我的程序正在创建的非常大的字符串。通过持久化存储 blob 的路径，我可以稍后再次加载字符串（请参阅[文档](https://developers.google.com/appengine/docs/java/blobstore/overview#Writing_Files_to_the_Blobstore)）

**我的问题：**是否有更简单的方法来访问 blob 内容而无需存储路径？BlobstoreService 只允许我直接服务于 HttpServletReponse。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-26T02:57:29.317

您只需要存储一个 BlobKey - 永远不需要存储路径（文件与否）。

要访问 blob 的内容：

```
BlobstoreService blobStoreService = BlobstoreServiceFactory.getBlobstoreService();
String myString =
   new String(blobStoreService.fetchData(blobKey, 0, BlobstoreService.MAX_BLOB_FETCH_SIZE-1); 
```

编辑：如果你有一个很长的字符串，你可以使用任何标准的方式通过从循环中的 blob 中获取数据来将字节数组读入字符串。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-26T13:01:24.267

我猜当您说“保留存储 blob 的路径”时，您的意思是[`BlobKey`](https://developers.google.com/appengine/docs/java/javadoc/com/google/appengine/api/blobstore/BlobKey)？

`FileService`允许您直接访问 blob 数据：

```
// Get a file service
FileService fileService = FileServiceFactory.getFileService();

// Get a file backed by blob
AppEngineFile file = fileService.getBlobFile(blobKey)

// get a read channel
FileReadChannel readChannel = fileService.openReadChannel(file, false);

// Since you store a String, I guess you want to read it a such
BufferedReader reader = new BufferedReader(Channels.newReader(readChannel, "UTF8"));
// Do this in loop unitil all data is read
String line = reader.readLine(); 
```

# android - 使用 FragmentPagerAdapter 时如何获取现有片段

> ID：14035090
> 
> 赞同：109
> 
> 时间：2012-12-26T01:07:56.177
> 
> 标签：android, android-fragments, fragmentpageradapter

我在让我的片段通过 相互通信时遇到问题`Activity`，它使用`FragmentPagerAdapter`，作为实现选项卡管理的帮助器类以及`ViewPager`与关联的连接的所有细节`TabHost`。我已经实现`FragmentPagerAdapter`了与 Android 示例项目*Support4Demos*提供的一样的实现。

主要问题是`FragmentManager`当我既没有 ID 也没有标签时，我如何才能获得特定的片段？`FragmentPagerAdapter`正在创建片段并自动生成 Id 和标签。

* * *

## 回答 #1

> 赞同：207
> 
> 时间：2015-03-26T01:23:30.640

## 问题总结

*注意：在这个答案中，我将参考`FragmentPagerAdapter`它的源代码。但一般的解决方案也应该适用于`FragmentStatePagerAdapter`.*

如果您正在阅读本文，您可能已经知道`FragmentPagerAdapter`/`FragmentStatePagerAdapter`是`Fragments`为您创建的`ViewPager`，但是在 Activity 重新创建时（无论是从设备旋转还是系统杀死您的应用程序以重新获得内存）这些`Fragments`都不会再次创建，而是它们的[**从`FragmentManager`**](http://grepcode.com/file/repository.grepcode.com/java/ext/com.google.android/android/5.0.2_r1/android/support/v4/app/FragmentPagerAdapter.java?av=f#90). 现在说你`Activity`需要参考这些`Fragments`来做他们的工作。您没有`id`or`tag`为这些创建`Fragments`，因为`FragmentPagerAdapter` [**在内部设置它们**](http://grepcode.com/file/repository.grepcode.com/java/ext/com.google.android/android/5.0.2_r1/android/support/v4/app/FragmentPagerAdapter.java?av=f#100)。所以问题是如何在没有这些信息的情况下获得对它们的引用......

## 当前解决方案的问题：依赖内部代码

我在这个问题和类似问题上看到的很多解决方案都依赖于`Fragment`通过调用`FragmentManager.findFragmentByTag()`和模仿[**内部创建的标签来获取对现有标签的引用：`"android:switcher:" + viewId + ":" + id`**](http://grepcode.com/file/repository.grepcode.com/java/ext/com.google.android/android/5.0.2_r1/android/support/v4/app/FragmentPagerAdapter.java?av=f#173) . 这样做的问题是您依赖于内部源代码，众所周知，不能保证永远保持不变。Google 的 Android 工程师可以轻松决定更改`tag`结构，这会破坏您的代码，使您无法找到对现有`Fragments`.

## 不依赖内部的替代解决方案`tag`

这是一个简单示例，说明如何获取对不依赖`Fragments`于. 关键是在其中覆盖和保存引用*而不是*在.`FragmentPagerAdapter``tags``Fragments`[**`instantiateItem()`**](http://grepcode.com/file/repository.grepcode.com/java/ext/com.google.android/android/5.0.2_r1/android/support/v4/app/FragmentPagerAdapter.java?av=f#83)*`getItem()`*

 *```
public class SomeActivity extends Activity {
    private FragmentA m1stFragment;
    private FragmentB m2ndFragment;

    // other code in your Activity...

    private class CustomPagerAdapter extends FragmentPagerAdapter {
        // other code in your custom FragmentPagerAdapter...

        public CustomPagerAdapter(FragmentManager fm) {
            super(fm);
        }

        @Override
        public Fragment getItem(int position) {
            // Do NOT try to save references to the Fragments in getItem(),
            // because getItem() is not always called. If the Fragment
            // was already created then it will be retrieved from the FragmentManger
            // and not here (i.e. getItem() won't be called again).
            switch (position) {
                case 0:
                    return new FragmentA();
                case 1:
                    return new FragmentB();
                default:
                    // This should never happen. Always account for each position above
                    return null;
            }
        }

        // Here we can finally safely save a reference to the created
        // Fragment, no matter where it came from (either getItem() or
        // FragmentManger). Simply save the returned Fragment from
        // super.instantiateItem() into an appropriate reference depending
        // on the ViewPager position.
        @Override
        public Object instantiateItem(ViewGroup container, int position) {
            Fragment createdFragment = (Fragment) super.instantiateItem(container, position);
            // save the appropriate reference depending on position
            switch (position) {
                case 0:
                    m1stFragment = (FragmentA) createdFragment;
                    break;
                case 1:
                    m2ndFragment = (FragmentB) createdFragment;
                    break;
            }
            return createdFragment;
        }
    }

    public void someMethod() {
        // do work on the referenced Fragments, but first check if they
        // even exist yet, otherwise you'll get an NPE.

        if (m1stFragment != null) {
            // m1stFragment.doWork();
        }

        if (m2ndFragment != null) {
            // m2ndFragment.doSomeWorkToo();
        }
    }
} 
```

**或者**，如果您更喜欢使用`tags`而不是类成员变量/对 的引用，`Fragments`您也可以以相同的方式获取`tags`集合`FragmentPagerAdapter`：注意：这不适用，`FragmentStatePagerAdapter`因为它`tags`在创建`Fragments`.

```
@Override
public Object instantiateItem(ViewGroup container, int position) {
    Fragment createdFragment = (Fragment) super.instantiateItem(container, position);
    // get the tags set by FragmentPagerAdapter
    switch (position) {
        case 0:
            String firstTag = createdFragment.getTag();
            break;
        case 1:
            String secondTag = createdFragment.getTag();
            break;
    }
    // ... save the tags somewhere so you can reference them later
    return createdFragment;
} 
```

请注意，此方法不依赖于模仿内部`tag`集合`FragmentPagerAdapter`，而是使用适当的 API 来检索它们。这样即使`tag`未来版本的变化`SupportLibrary`你仍然是安全的。

* * *

**不要忘记**，根据您的设计，您`Activity`尝试`Fragments`使用的可能尚不存在，也可能不存在，因此您必须`null`在使用您的参考资料之前进行检查。

**此外，如果**您正在使用`FragmentStatePagerAdapter`，那么您不想保留对您的硬引用，`Fragments`因为您可能有很多硬引用，而硬引用会不必要地将它们保留在内存中。而是将`Fragment`引用保存在`WeakReference`变量而不是标准变量中。像这样：

```
WeakReference<Fragment> m1stFragment = new WeakReference<Fragment>(createdFragment);
// ...and access them like so
Fragment firstFragment = m1stFragment.get();
if (firstFragment != null) {
    // reference hasn't been cleared yet; do work...
} 
```

* * *

## 回答 #2

> 赞同：86
> 
> 时间：2012-12-26T10:40:08.550

我根据以下帖子找到了我的问题的答案：[在片段页面适配器中重用片段](https://stackoverflow.com/questions/6976027/reusing-fragments-in-a-fragmentpageradapter)

**我学到的几件事：**

1.  `getItem(int position)`在`FragmentPagerAdapter`这个方法实际上做了什么是相当误导的名称。它创建新的片段，而不是返回现有的片段。在这个意义上，该方法应该重命名为类似于`createItem(int position)`Android SDK 中的方法。所以这个方法并不能帮助我们获取碎片。
2.  根据帖子[支持 FragmentPagerAdapterholds 对旧片段的引用](https://stackoverflow.com/questions/9727173/support-fragmentpageradapter-holds-reference-to-old-fragments)中的解释，您应该将片段的创建留给 ，`FragmentPagerAdapter`这意味着您没有对片段或其标签的引用。`FragmentManager`如果您有片段标签，您可以通过调用轻松检索对它的引用`findFragmentByTag()`。我们需要一种方法来找出给定页面位置的片段标签。

**解决方案**

在您的类中添加以下辅助方法以检索片段标记并将其发送到该`findFragmentByTag()`方法。

```
private String getFragmentTag(int viewPagerId, int fragmentPosition)
{
     return "android:switcher:" + viewPagerId + ":" + fragmentPosition;
} 
```

笔记！`FragmentPagerAdapter`这与创建新片段时使用的方法相同。请参阅此链接[http://code.google.com/p/openintents/source/browse/trunk/compatibility/AndroidSupportV2/src/android/support/v2/app/FragmentPagerAdapter.java#104](http://code.google.com/p/openintents/source/browse/trunk/compatibility/AndroidSupportV2/src/android/support/v2/app/FragmentPagerAdapter.java#104)

* * *

## 回答 #3

> 赞同：18
> 
> 时间：2016-12-27T12:31:56.780

您不需要通过手动创建片段标签来覆盖`instantiateItem`或依赖与内部方法的兼容性。是一个*公共*方法，因此您可以并且实际上**应该**在您的活动方法中调用它，其中包含对[javadoc](https://developer.android.com/reference/android/support/v4/view/PagerAdapter.html)中描述的调用和方法的调用：`makeFragmentName`
`instantiateItem`***`onCreate``startUpdate``finishUpdate``PagerAdapter`***

 ***> 调用 PagerAdapter 方法 startUpdate(ViewGroup) 指示 ViewPager 的内容即将更改。随后将调用一次或多次实例化Item(ViewGroup, int) 和/或destroyItem(ViewGroup, int, Object)，并通过调用finishUpdate(ViewGroup) 发出更新结束的信号。

然后，您可以通过上述方式，在需要时将片段实例的引用存储在本地变量上。参见示例：

```
public class MyActivity extends AppCompatActivity {

    Fragment0 tab0; Fragment1 tab1;

    @Override protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.myLayout);
        ViewPager viewPager = (ViewPager) findViewById(R.id.myViewPager);
        MyPagerAdapter adapter = new MyPagerAdapter(getSupportFragmentManager());
        viewPager.setAdapter(adapter);
        ((TabLayout) findViewById(R.id.tabs)).setupWithViewPager(viewPager);

        adapter.startUpdate(viewPager);
        tab0 = (Fragment0) adapter.instantiateItem(viewPager, 0);
        tab1 = (Fragment1) adapter.instantiateItem(viewPager, 1);
        adapter.finishUpdate(viewPager);
    }

    class MyPagerAdapter extends FragmentPagerAdapter {

        public MyPagerAdapter(FragmentManager manager) {super(manager);}

        @Override public int getCount() {return 2;}

        @Override public Fragment getItem(int position) {
            if (position == 0) return new Fragment0();
            if (position == 1) return new Fragment1();
            return null;  // or throw some exception
        }

        @Override public CharSequence getPageTitle(int position) {
            if (position == 0) return getString(R.string.tab0);
            if (position == 1) return getString(R.string.tab1);
            return null;  // or throw some exception
        }
    }
} 
```

`instantiateItem`将首先尝试从`FragmentManager`. 仅当它们尚不存在时，它才会使用`getItem`您的适配器中的方法创建新的，并将它们“存储”在其中`FragmentManager`以备将来使用。

重要的是要注意，即使您不需要获取对片段的引用，您仍然应该在您的方法中调用由/`instantiateItem`包围的所有选项卡，如下所示：`startUpdate``finishUpdate``onCreate`

```
 adapter.startUpdate(viewPager);
    // ignoring return values of the below 2 calls, just side effects matter:
    adapter.instantiateItem(viewPager, 0);
    adapter.instantiateItem(viewPager, 1);
    adapter.finishUpdate(viewPager); 
```

如果您不这样做，那么您将面临永远不会*提交*片段实例的风险`FragmentManager`：当您的活动变为前台`instantiateItem`时将自动调用以获取您的片段，但`startUpdate`/`finishUpdate` *可能* *不会*（取决于实现细节）以及它们基本上是什么做的是开始/提交一个`FragmentTransaction`.
这*可能会*导致对已创建片段实例的引用很快丢失（例如，当您旋转屏幕时）并且重新创建的频率比必要的多得多。根据您的片段的“重”程度，它可能会产生不可忽略的性能后果。
此外，在这种情况下，存储在本地变量上的片段实例*可能*变得陈旧：如果 android 平台尝试从`FragmentManager`任何原因获取它们，它将失败，因此将创建和使用新的，而您的 vars 仍将引用旧的。

* * *

## 回答 #4

> 赞同：13
> 
> 时间：2014-05-24T10:10:25.250

我这样做的方式是定义一个 WeakReferences 的哈希表，如下所示：

```
protected Hashtable<Integer, WeakReference<Fragment>> fragmentReferences; 
```

然后我像这样编写了 getItem() 方法：

```
@Override
public Fragment getItem(int position) {

    Fragment fragment;
    switch(position) {
    case 0:
        fragment = new MyFirstFragmentClass();
        break;

    default:
        fragment = new MyOtherFragmentClass();
        break;
    }

    fragmentReferences.put(position, new WeakReference<Fragment>(fragment));

    return fragment;
} 
```

然后你可以写一个方法：

```
public Fragment getFragment(int fragmentId) {
    WeakReference<Fragment> ref = fragmentReferences.get(fragmentId);
    return ref == null ? null : ref.get();
} 
```

这似乎运作良好，我发现它比

```
"android:switcher:" + viewId + ":" + position 
```

技巧，因为它不依赖于 FragmentPagerAdapter 的实现方式。当然如果fragment已经被FragmentPagerAdapter释放或者还没有被创建，getFragment会返回null。

如果有人发现这种方法有问题，我们非常欢迎发表评论。

* * *

## 回答 #5

> 赞同：10
> 
> 时间：2013-03-14T11:31:49.080

我创建了这个方法，它可以让我获得对当前片段的引用。

```
public static Fragment getCurrentFragment(ViewPager pager, FragmentPagerAdapter adapter) {
    try {
        Method m = adapter.getClass().getSuperclass().getDeclaredMethod("makeFragmentName", int.class, long.class);
        Field f = adapter.getClass().getSuperclass().getDeclaredField("mFragmentManager");
        f.setAccessible(true);
        FragmentManager fm = (FragmentManager) f.get(adapter);
        m.setAccessible(true);
        String tag = null;
        tag = (String) m.invoke(null, pager.getId(), (long) pager.getCurrentItem());
        return fm.findFragmentByTag(tag);
    } catch (NoSuchMethodException e) {
        e.printStackTrace();
    } catch (IllegalArgumentException e) {
        e.printStackTrace();
    } catch (IllegalAccessException e) {
        e.printStackTrace();
    } catch (InvocationTargetException e) {
        e.printStackTrace();
    } catch (NoSuchFieldException e) {
        e.printStackTrace();
    } 
    return null;
} 
```

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2021-06-20T16:11:31.860

## ViewPager2*更新的 FragmentStateAdapter*

`FragmentStateAdapter`有`createFragment()`而不是`getItem()`. 并且没有这样的方法`instantiateView()`。

因此，在配置更改后重新创建托管`Activity`/时，不会被调用。这意味着适配器中的片段不会再次创建，而是从. 所以如果你需要对片段做一些工作，你可以简单地从.`Fragment``createFragment()``FragmentManager``FragmentManager`

适配器创建：

```
CustomFragmentAdapter adapter = new CustomFragmentAdapter(getChildFragmentManager(), getLifecycle()); 
```

`FragmentManager`从after `Activity`/ `Fragment`reload中检索片段：

```
 FragmentManager manager = getChildFragmentManager();
    ArrayList<Fragment> fragments = new ArrayList<>(manager.getFragments());

    for (Fragment fr : fragments) {

        // do something
    } 
```

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2014-08-27T08:34:30.670

@personne3000 建议的解决方案很好，但它有一个问题：当活动进入后台并被系统杀死（为了获得一些空闲内存）然后恢复时，`fragmentReferences`将是空的，因为`getItem`不会叫。

下面的类处理这种情况：

```
public abstract class AbstractHolderFragmentPagerAdapter<F extends Fragment> extends FragmentPagerAdapter {

    public static final String FRAGMENT_SAVE_PREFIX = "holder";
    private final FragmentManager fragmentManager; // we need to store fragment manager ourselves, because parent's field is private and has no getters.

    public AbstractHolderFragmentPagerAdapter(FragmentManager fm) {
        super(fm);
        fragmentManager = fm;
    }

    private SparseArray<WeakReference<F>> holder = new SparseArray<WeakReference<F>>();

    protected void holdFragment(F fragment) {
        holdFragment(holder.size(), fragment);
    }

    protected void holdFragment(int position, F fragment) {
        if (fragment != null)
            holder.put(position, new WeakReference<F>(fragment));
    }

    public F getHoldedItem(int position) {
        WeakReference<F> ref = holder.get(position);
        return ref == null ? null : ref.get();
    }

    public int getHolderCount() {
        return holder.size();
    }

    @Override
    public void restoreState(Parcelable state, ClassLoader loader) { // code inspired by Google's FragmentStatePagerAdapter implementation
        super.restoreState(state, loader);
        Bundle bundle = (Bundle) state;
        for (String key : bundle.keySet()) {
            if (key.startsWith(FRAGMENT_SAVE_PREFIX)) {
                int index = Integer.parseInt(key.substring(FRAGMENT_SAVE_PREFIX.length()));
                Fragment f = fragmentManager.getFragment(bundle, key);
                holdFragment(index, (F) f);
            }
        }
    }

    @Override
    public Parcelable saveState() {
        Bundle state = (Bundle) super.saveState();
        if (state == null)
            state = new Bundle();

        for (int i = 0; i < holder.size(); i++) {
            int id = holder.keyAt(i);
            final F f = getHoldedItem(i);
            String key = FRAGMENT_SAVE_PREFIX + id;
            fragmentManager.putFragment(state, key, f);
        }
        return state;
    }
} 
```

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2015-06-22T20:16:21.040

获取片段句柄的主要障碍是您不能依赖 getItem()。方向更改后，对片段的引用将为空，并且不会再次调用 getItem()。

这是一种不依赖 FragmentPagerAdapter 的实现来获取标签的方法。覆盖 instanceiteItem() ，它将返回从 getItem() 创建的或从片段管理器中找到的片段。

```
@Override
public Object instantiateItem(ViewGroup container, int position) {
    Object value =  super.instantiateItem(container, position);

    if (position == 0) {
        someFragment = (SomeFragment) value;
    } else if (position == 1) {
        anotherFragment = (AnotherFragment) value;
    }

    return value;
} 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2013-01-22T20:22:34.110

请参阅[这篇](https://stackoverflow.com/questions/10022179/fragmentpageradapter-with-two-fragments-go-to-the-first-from-the-second-and-upd?answertab=votes#tab-top)关于从 FragmentPagerAdapter 返回片段的帖子。是否依赖于您知道片段的索引 - 但这将在 getItem() 中设置（仅在实例化时）

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2015-10-03T15:01:44.690

我设法通过使用 ids 而不是标签来解决这个问题。（我正在使用我定义的 FragmentStatePagerAdapter ，它使用我的自定义片段，其中我覆盖了 onAttach 方法，您将 id 保存在某处：

```
@Override
public void onAttach(Context context){
    super.onAttach(context);
    MainActivity.fragId = getId();
} 
```

然后您只需在活动中轻松访问片段：

```
Fragment f = getSupportFragmentManager.findFragmentById(fragId); 
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2017-02-17T16:54:37.257

我不知道这是否是最好的方法，但没有其他方法对我有用。包括 getActiveFragment 在内的所有其他选项返回 null 或导致应用程序崩溃。

我注意到在屏幕旋转时，片段被附加，所以我用它将片段发送回活动。

在片段中：

```
@Override
public void onAttach(Activity activity) {
    super.onAttach(activity);
    try {
        mListener = (OnListInteractionListener) activity;
        mListener.setListFrag(this);
    } catch (ClassCastException e) {
        throw new ClassCastException(activity.toString()
                + " must implement OnFragmentInteractionListener");
    }
} 
```

然后在活动中：

```
@Override
public void setListFrag(MyListFragment lf) {
    if (mListFragment == null) {
        mListFragment = lf;
    }
} 
```

最后在活动 onCreate() 中：

```
if (savedInstanceState != null) {
    if (mListFragment != null)
        mListFragment.setListItems(items);
} 
```

这种方法将实际可见片段附加到活动而不创建新片段。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2018-05-21T01:19:29.460

不确定我的方法是否是正确的或最好的方法，因为我是 Java/Android 的相对初学者，但它确实有效（我确信它违反了面向对象的原则，但没有其他解决方案适用于我的用例）。

我有一个使用 ViewPager 和 FragmentStatePagerAdapter 的托管活动。为了获得对 FragmentStatePagerAdapter 创建的片段的引用，我在片段类中创建了一个回调接口：

```
public interface Callbacks {
    public void addFragment (Fragment fragment);
    public void removeFragment (Fragment fragment);
} 
```

在托管活动中，我实现了接口并创建了一个 LinkedHasSet 来跟踪片段：

```
public class HostingActivity extends AppCompatActivity implements ViewPagerFragment.Callbacks {

    private LinkedHashSet<Fragment> mFragments = new LinkedHashSet<>();

    @Override
    public void addFragment (Fragment fragment) {
        mFragments.add(fragment);
    }

    @Override
    public void removeFragment (Fragment fragment) {
        mFragments.remove(fragment);
    }
} 
```

在 ViewPagerFragment 类中，我将片段添加到 onAttach 中的列表中，并在 onDetach 中删除它们：

```
public class ViewPagerFragment extends Fragment {

    private Callbacks mCallbacks;

    public interface Callbacks {
        public void addFragment (Fragment fragment);
        public void removeFragment (Fragment fragment);
    } 

    @Override
    public void onAttach (Context context) {
        super.onAttach(context);
        mCallbacks = (Callbacks) context;
        // Add this fragment to the HashSet in the hosting activity
        mCallbacks.addFragment(this);
    }

    @Override
    public void onDetach() {
        super.onDetach();
        // Remove this fragment from the HashSet in the hosting activity
        mCallbacks.removeFragment(this);
        mCallbacks = null;
    }
} 
```

在托管活动中，您现在可以使用 mFragments 来遍历 FragmentStatePagerAdapter 中当前存在的片段。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2018-08-30T11:58:48.213

这个类不依赖内部标签就可以解决问题。警告：片段应该使用 getFragment 方法而不是 getItem 方法来访问。

```
public class ViewPagerAdapter extends FragmentPagerAdapter {

    private final Map<Integer, Reference<Fragment>> fragments = new HashMap<>();
    private final List<Callable0<Fragment>> initializers = new ArrayList<>();
    private final List<String> titles = new ArrayList<>();

    public ViewPagerAdapter(FragmentManager fm) {
        super(fm);
    }

    void addFragment(Callable0<Fragment> initializer, String title) {
        initializers.add(initializer);
        titles.add(title);
    }

    public Optional<Fragment> getFragment(int position) {
        return Optional.ofNullable(fragments.get(position).get());
    }

    @Override
    public Fragment getItem(int position) {
        Fragment fragment =  initializers.get(position).execute();
        return fragment;
    }

    @Override
    public Object instantiateItem(ViewGroup container, int position) {
        Fragment fragment = (Fragment) super.instantiateItem(container, position);
        fragments.put(position, new WeakReference<>(fragment));
        return fragment;
    }

    @Override
    public int getCount() {
        return initializers.size();
    }

    @Override
    public CharSequence getPageTitle(int position) {
        return titles.get(position);
    }
} 
```

* * *

## 回答 #14

> 赞同：-6
> 
> 时间：2012-12-26T11:03:21.963

继续尝试这段代码，

```
public class MYFragmentPAdp extends FragmentPagerAdapter {

    public MYFragmentPAdp(FragmentManager fm) {
        super(fm);
    }

    @Override
    public int getCount() {
        return 2;
    }

     @Override
     public Fragment getItem(int position) {
         if (position == 0)
             Fragment fragment = new Fragment1();
         else (position == 1)
             Fragment fragment = new Fragment2();
         return fragment;
     }
} 
```****

# lua - 从其他函数中引用早期和后期函数？

> ID：14035095
> 
> 赞同：0
> 
> 时间：2012-12-26T01:09:11.487
> 
> 标签：lua, function-declaration

我有一个 Lua 脚本，它提供了一个交互式文本菜单，用于在实际工作之前配置脚本。有一个`main_menu()`函数，它有用户可以选择的选项，每个选项调用一个不同的`submenu()`函数。这些不同的`submenu()`函数中的每一个都做他们的事情，然后他们*回到*（他们调用）这个`main_menu()`函数。最后，每个函数都有一个参数`settings`传递给它，这是一个设置表。

事情看起来像这样：

```
local function submenu(settings)
    -- Get user input & change a settings{} table key accordingly
    main_menu(settings)
end

local function main_menu(settings)
    -- Present choices & get user input
    submenu(settings)
end

local settings={}
settings["foo"] = "bar"

main_menu(settings) 
```

问题是`attempt to call nil`每当（据我所知）一个函数调用**稍后在脚本中定义的**另一个函数时，我都会遇到错误。所以如果像上面的例子一样，我定义`submenu()`然后*，* 调用没有问题`main_menu()`，但不能调用。`main_menu()``submenu()``submenu()``main_menu()`

FWIW，这是在 Minecraft 的 ComputerCraft mod 中完成的。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-26T01:27:53.423

您可以`local function`像这样使用前向声明：

```
local main_menu

local function submenu(settings)
    -- Get user input & change a settings{} table key accordingly
    main_menu(settings)
end

main_menu = function(settings)
    -- Present choices & get user input
    submenu(settings)
end 
```

或通过删除`local`关键字进行全局函数声明：

```
function submenu(settings)
    -- Get user input & change a settings{} table key accordingly
    main_menu(settings)
end

function main_menu(settings)
    -- Present choices & get user input
    submenu(settings)
end 
```

# c++ - 在 MFC 上单击按钮时显示文本

> ID：14035097
> 
> 赞同：1
> 
> 时间：2012-12-26T01:09:21.430
> 
> 标签：c++, mfc

我对 C++，MFC 完全陌生。目前正在尝试使用按钮制作 GUI，并在按下按钮时显示“hello world”文本。我该怎么做？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-26T01:14:22.373

这是一个关于 MFC 的教程：

*   [http://courses.washington.edu/css450/2008.Fall/web_contents/from_students/450Hints/mfc_tutorial/index.html](http://courses.washington.edu/css450/2008.Fall/web_contents/from_students/450Hints/mfc_tutorial/index.html)

基本上，您需要：

1）创建一个按钮和一个编辑字段或标签（资源编辑器）

2）定义一个“OnClick”事件处理程序（类编辑器）

3) 事件处理程序标签上的“SetWindowText()”

此链接显示了步骤 2 和 3 的示例：

*   [http://www.gidforums.com/t-3645.html](http://www.gidforums.com/t-3645.html)

# php - FQL 从特定月份选择帖子

> ID：14035098
> 
> 赞同：0
> 
> 时间：2012-12-26T01:10:08.590
> 
> 标签：php, facebook, facebook-graph-api, facebook-fql

我正在尝试使用 PHP-SDK 查询 Facebook Graph API。我要做的几乎就是标题中指定的内容：选择今年特定月份的所有帖子。

我已经搜索了一段时间，但找不到正确的语法来从日期范围中选择帖子。

[这是一个使用](https://developers.facebook.com/docs/reference/fql/stream)带有“created_time”字段的条件语句的示例。我试过这样的事情（选择从 2012 年 1 月 1 日到 2012 年 1 月 31 日的帖子）：

```
SELECT post_id, FROM stream WHERE source_id = me() AND created_time < 1325394000 AND created_time > 1327986000 
```

但是这个查询只返回 1 月 31 日的帖子。

在此先感谢您的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-26T03:00:37.233

首先，你的时代被逆转了。

[正确查询](https://developers.facebook.com/tools/explorer?fql=SELECT%20post_id%20FROM%20stream%20WHERE%20source_id%20=%20me%28%29%20AND%20created_time%20%3C%201327986000%20AND%20created_time%20%3E%201325394000)：

```
SELECT post_id FROM stream WHERE source_id = me() AND created_time < 1327986000 AND created_time > 1325394000 
```

并使用该`LIMIT`功能获得更多帖子。上面带有 LIMIT 500 的查询按预期对我有用。

# executable - 通过编辑二进制文件修改窗口样式？

> ID：14035099
> 
> 赞同：2
> 
> 时间：2012-12-26T01:10:10.773
> 
> 标签：executable, binaryfiles, window-style

CyLog 的[WildRename](http://www.cylog.org/utilities/wildrename.jsp)是一个对文件执行批量重命名的好程序。它的问题是，虽然主窗口可以调整大小，但它没有最大化框，这使得它的大小和使用有点令人沮丧。而且，他们已经很长时间没有进行任何更新，因此该程序基本上已停产。

我运行 WildRename 并使用 WinSpy++ 修改其窗口的样式以手动包含`WS_MINIMIZEBOX`样式和 bam!，它现在按预期运行。

现在的问题是如何使其永久化。

我的第一反应是启动 ResHacker，但问题是需要修改的样式是非对话框应用程序的*主窗口的样式，所以 ResHacker 没有办法做到这一点。*

我尝试的下一件事是在十六进制编辑器中打开它，找到与标题栏对应的字符串的地址。然后我在 W32Dasm 中打开该文件并找到引用标题栏字符串地址的代码地址。我这样做是为了找到创建主对话框的位置，以便我可以修改传递给`CreateWindow()`. 不幸的是，我找不到`CreateWindow`对titelbar 字符串引用附近任何地方的调用，`CreateWindowEx`而且我能找到的所有调用似乎（显然）都不是用于创建主窗口的调用。

是否有一种简单/自动化的方式来修改主窗口的样式（假设是非对话框应用程序）？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-26T03:13:58.047

必须调用`CreateWindow/Ex()`，特别是如果它不是来自资源的对话。你只需要更加努力地寻找。我会使用 IDA 而不是 WinDasm。它将程序集反编译成更易于理解的代码，并且它有一个内置的调试器。您可以在标题字符串上放置一个断点，并实时查看哪些代码实际触及它，然后将其返回到访问代码。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-26T03:01:00.697

You could use a debugger like OllyDBG to dump the exe memory after the edit with WinSpy++, then use that exe or compare the files to see where the change is if you want to see what you've missed

# c# - 放入c#代码时出现sql代码错误

> ID：14035100
> 
> 赞同：-1
> 
> 时间：2012-12-26T01:10:26.183
> 
> 标签：c#, sql, sql-server

我的一个朋友有一个问题，她用 c# 做了一个项目，一切看起来都很好，但问题是，当她将 SQL 查询放入代码时，她会出错，但是当我们在 microsoft SQL 中尝试代码时服务器它工作。

这是错误显示的代码示例：

```
DataSet dsDelP = new DataSet();
string sql = "";
sql = "SELECT Grupi_ID, (p.emri + ' ' + p.mbiemri) as Profesori , k.EmriKlases as Klasa, d.emri as Dita, Ora_fillimit as Fillimi, Ora_mbarimit as Mbarimi";
sql += "FROM grupetOraret gro";
sql += "inner join Profesori p on gro.Profesori_ID=p.Profesor_ID";
sql += "inner join Klasa k on gro.Klasa_ID=k.Klasa_ID";
sql += "inner join Dita d on gro.ID_Dita=d.ID_dita";

SqlDataAdapter daDelP = new SqlDataAdapter(sql, con);
daDelP.Fill(dsDelP, "grupetOraret");
dataGridViewKerkoOrarin.DataSource = dsDelP.Tables[0].DefaultView; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-26T01:13:57.457

你没有空格。您应该将它们添加到每一行（在其开头或结尾）。假设查询本身是正确的（只要您已经检查过），它应该是这样的：

```
sql = "SELECT Grupi_ID, (p.emri + ' ' + p.mbiemri) as Profesori , k.EmriKlases as Klasa,  d.emri as Dita, Ora_fillimit as Fillimi, Ora_mbarimit as Mbarimi ";
sql += "FROM grupetOraret gro ";
sql += "inner join Profesori p on gro.Profesori_ID=p.Profesor_ID ";
sql += "inner join Klasa k on gro.Klasa_ID=k.Klasa_ID ";
sql += "inner join Dita d on gro.ID_Dita=d.ID_dita "; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-26T01:13:02.873

连接字符串后，您的 SQL 如下所示：

```
SELECT ... as MbarimiFROM .... on gro.Profesori_ID= p.Profesor_IDinner ...

```

您需要在每行的最后一个单词和下一行的第一个单词之间留一个空格：

```
string sql = "... as Mbarimi";
sql += " FROM ...";
sql += " inner join Profesori p on gro.Profesori_ID=p.Profesor_ID";
sql += " inner join Klasa k on gro.Klasa_ID=k.Klasa_ID";
sql += " inner join Dita d on gro.ID_Dita=d.ID_dita"; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-26T01:15:09.770

附加到 sql 变量不会自动插入换行符，所以`sql`最终看起来像

```
...FROM grupetOraret groinner join Profesori p on gro.Profesori_ID=p.Profesor_ID... 
```

请注意，`grupetOraret gro`它们`inner join`之间没有空格。

尝试使用`@`多行字符串文字，使事情变得更容易和更高效：

```
string sql = @"
    SELECT Grupi_ID, (p.emri + ' ' + p.mbiemri) as Profesori , k.EmriKlases as Klasa, d.emri as Dita, Ora_fillimit as Fillimi, Ora_mbarimit as Mbarimi
    FROM grupetOraret gro
    inner join Profesori p on gro.Profesori_ID=p.Profesor_ID
    inner join Klasa k on gro.Klasa_ID=k.Klasa_ID
    inner join Dita d on gro.ID_Dita=d.ID_dita"; 
```

# javascript - 从指令中观察表达式

> ID：14035105
> 
> 赞同：6
> 
> 时间：2012-12-26T01:11:48.917
> 
> 标签：javascript, angularjs, directive

基本上，我如何才能从指令中听到表达式的变化？

* * *

我正在使用无证`ng-required`有条件地要求某个字段：

```
<input type="checkbox" ng-model="partner" checked />
<input ng-model="partnerName" placeholder="required" ng-required="partner" /> 
```

这很好用（[这里是 Plunkr](http://plnkr.co/edit/ZBDguOh1BUh37DbugCJb?p=preview)）。唯一的问题是它保留了`placeholder`“必需”文本，而不管它是否实际需要。

* * *

所以，我决定创建自己的指令。这是它应该如何工作的：

```
<input ng-placeholder="{ 'required': partner }" /> 
```

这个想法类似于 angular's `ng-class`，但我无法做到这一点。这是我到目前为止所得到的：

```
app.directive('ngPlaceholder', function ($parse) {
    return {
        restrict: 'A',
        link: function (scope, element, attrs) {
            console.log( scope.$eval(attrs.ngPlaceholder) );
        }
    }
}); 
```

它记录了一个很好的对象，我可以用它来确定`placeholder`值：

```
{ required: true } 
```

但是我如何挂钩`$digest`/`$apply`循环以在更改`placeholder`时更新属性`partner`？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-26T05:48:07.823

这是你想要的吗 ？[笨蛋](http://plnkr.co/edit/83wZy086dHDl1r9EDAcS)

您的链接功能的基本思想应该是

```
 link: function (scope, element, attrs) {
        scope.$watch(attrs.xngPlaceholder, function (newVal, oldVal, scope) {
          element.removeAttr('placeholder');
          var att = '';
           angular.forEach(newVal, function (elm, key)
                att += elm ? (key + ' ') : ''; 
            });
            element.attr('placeholder', att);
        }, true);
    } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-26T18:09:17.320

另一种不需要指令的方法：

```
placeholder="{{{true: 'required', false:''}[partner]}}" 
```

上面创建对象`{true: 'required', false:''}`，然后使用 的当前值对对象进行索引`partner`。

# 3d - 将 2D 坐标转换为 3D 坐标空间

> ID：14035106
> 
> 赞同：0
> 
> 时间：2012-12-26T01:11:49.660
> 
> 标签：3d, coordinate-systems, surf, coordinate-transformation

我正在为没有标记的增强现实应用程序引擎工作（又名无市场 AR）它使用从 SURF 算法获得的兴趣点来识别任何图像中的点，并使用这些点作为参考来绘制信息，但我不知道将 2D 信息（检测到的兴趣点）转换为 3D 模型以映射到 3D 坐标空间并将 3D 对象渲染到场景的最佳方法。有什么算法可以做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-28T14:41:51.383

这是一个非常广泛的问题。您应该需要在计算机视觉领域做一些阅读，但简要地说，您将采用以下方法。您需要一个[完全校准的相机](http://en.wikipedia.org/wiki/Camera_matrix)，它描述了相机与世界之间的关系。此模型允许您在图像中的点和世界中的 3D 线之间进行转换 - 请注意，在不知道其深度的情况下您无法获得实际的 3D*点*，因为图像中的单个点可能是世界上许多点的投影.

# php - 如何使用 PDO 获取一行

> ID：14035108
> 
> 赞同：9
> 
> 时间：2012-12-26T01:11:59.260
> 
> 标签：php, pdo

我尽量不要感到沮丧，但我最近了解到`mysql_*`PHP 已弃用它。我决定学习如何使用 PDO。

我今天下午一直在看它，使用它连接到数据库很容易，但后来我想用它获取一行并将该行保存为由列名索引的数组（与函数相同的方式`mysql_fetch_array`做过）。我想不通以挽救我的生命。

我将发布我的代码以澄清，我确信它很简单（所有编程错误总是很简单），但我肯定做错了什么。

```
// Connect to the database
$host    = $_PARAM["DatabaseServer"];
$db        = $_PARAM["MainDatabase"];
$dbuser    = $_PARAM["DatabaseUser"];
$dbpass    = $_PARAM["DatabasePass"];
try
{
    $Database = new PDO("mysql:host=$host;dbname=$db", $dbuser, $dbpass);
}
catch (PDOException $e)
{
    echo "There was an unexpected error. Please try again, or contact us with concerns";
}

$stmt = $Database->prepare("SELECT * FROM users WHERE username=?");
$stmt->execute(array($sUserCook));
$row = $stmt->fetchAll(PDO::FETCH_ASSOC);

echo $row["username"]; 
```

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2012-12-26T01:17:36.673

`fetchAll`做它所说的：它获取查询的所有结果。由于它会获取大量结果，因此您将获得一个索引数组。

`fetch`如果您只想要一行，它会执行您可能正在寻找的事情：它为查询获取一个结果。如果您要将`mysql_*`代码转换为 PDO，最快的方法是使用此方法而不是`mysql_fetch_assoc`.

如果您仍在使用`fetchAll`: 您的代码可能看起来像这样：

```
$rows = $stmt->fetchAll(PDO::FETCH_ASSOC);
foreach ($rows as $row) {
    echo $row['username'];
} 
```

就像我说的那样，如果您只是将遗留代码转换为 PDO 代码，则将所有查询更改为准备好的语句并替换以下内容可能会更容易：

*   `mysql_fetch_assoc($result)`
    ->`$stmt->fetch(PDO::FETCH_ASSOC)`
*   `mysql_num_rows($result)`
    ->`$stmt->rowCount()`
*   `while ($row = mysql_fetch_assoc($result)) {}`
    ->`foreach ($stmt->fetchAll(PDO::FETCH_ASSOC) as $row) {}`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2017-07-09T17:18:58.527

利用

```
$row = $stmt->fetch(PDO::FETCH_ASSOC); 
```

您将获得第一个查询结果。

# wpf - WPF 动画遵循正确的路径，但它在空间中关闭

> ID：14035116
> 
> 赞同：3
> 
> 时间：2012-12-26T01:14:08.707
> 
> 标签：wpf, animation, path, geometry, transformation

这是它的样子： [http ://screencast.com/t/4cd1yQJReXt](http://screencast.com/t/4cd1yQJReXt)

小船图像应该遵循您为其绘制的路径。它确实有效 - 它遵循路径，但它从错误的地方开始。我无法弄清楚我的动画出了什么问题，我现在已经多次查看代码。应用程序的 XAML 非常简单，所有元素都包含在 Canvas Name="Canvas1" Background="Black" 中

这个画布是 Window 的子元素

下面是执行动画的代码。我知道我喂它的线是正确的。只是他们的参考点有点搞砸了。应该是 Canvas1 但不是。

```
 NameScope.SetNameScope(this, new NameScope());

            MatrixTransform buttonMatrixTransform = new MatrixTransform();
            ship1.RenderTransform = buttonMatrixTransform;

            this.RegisterName("ButtonMatrixTransform", buttonMatrixTransform);

            PathGeometry animationPath = new PathGeometry();
            PathFigure pFigure = new PathFigure();
            pFigure.StartPoint = new Point(pathnodes.ElementAt<Line>(0).X1, pathnodes.ElementAt<Line>(0).Y1);

            PolyLineSegment ls = new PolyLineSegment();

            foreach (Line l in pathnodes)
            {
                ls.Points.Add(new Point(l.X1, l.Y1));
                ls.Points.Add(new Point(l.X2, l.Y2));
            }

            pFigure.Segments.Add(ls);      
            animationPath.Figures.Add(pFigure);

            animationPath.Freeze();

            MatrixAnimationUsingPath matrixAnimation =
                new MatrixAnimationUsingPath();

            matrixAnimation.IsOffsetCumulative = false;

            matrixAnimation.PathGeometry = animationPath;
            matrixAnimation.Duration = TimeSpan.FromSeconds(5);
            matrixAnimation.DoesRotateWithTangent = true;

            Storyboard.SetTargetName(matrixAnimation, "ButtonMatrixTransform");
            Storyboard.SetTargetProperty(matrixAnimation,
                new PropertyPath(MatrixTransform.MatrixProperty));

            Storyboard pathAnimationStoryboard = new Storyboard();
            pathAnimationStoryboard.Children.Add(matrixAnimation);

            pathAnimationStoryboard.Begin(this); 
```

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-28T15:19:27.507

我无法观看您的视频 :O( 但是，这可能与未设置 RenderTransformOrigin 有关吗？通常当我进行变换时，我将 RTO 设置为 0.5、0.5，以便原点位于对象的中心.

# ruby-on-rails - 如何将基于炼油厂的站点挂载到子目录

> ID：14035119
> 
> 赞同：1
> 
> 时间：2012-12-26T01:14:28.873
> 
> 标签：ruby-on-rails, apache, passenger, refinerycms, rails-engines

我正在尝试使用 Apache 和 Phusion Passenger 将基于炼油厂的站点部署到域上的子目录中。不知何故，它几乎可以工作，但并不完全。有没有人有这方面的经验，可以指出我缺少什么？

**这是我到目前为止所尝试的：**

起初我只是从 til 站点的 DocumentRoot 到应用程序的公共目录建立了一个符号链接：

```
ln -s /webapps/myapp/public /www/myapp 
```

并将以下内容添加到 apache 虚拟主机部分：

```
<VirtualHost *>
    ...
    RackBaseURI /myapp
    <Directory /www/myapp>
       Options -MultiViews
    <Directory>
</VirtualHost> 
```

正如预期的那样，将浏览器指向服务器上的 /myapp 子目录会为我提供应用程序。但是，后端生成的各种链接（位于 下`/myapp/refinery`）以及前端的菜单条目都指向站点的根目录。也就是说，如果我单击“页面”选项卡，它会尝试将我转发到`/refinery/pages`正确路径为`/myapp/refinery/pages`.

考虑到 Refinery 是作为 Rails 引擎制作的，我想我应该需要将它挂载到`/myapp`-directory，所以我像这样更改了 config/routes.rb：

```
mount Refinery::Core::Engine, :at => Rails.env.production? ? '/myapp' : '/' 
```

但是，这现在将站点移至`/myapp/myapp`。链接现在指向 是有意义的`/myapp/resource`，但是由于资源已经向下移动了另一个级别，我仍然被卡住了。

我已经在同一站点的子目录下运行了 redmine 和另一个自定义 rails 3.0 应用程序，没有问题。不知何故，炼油厂似乎很困惑，我看不出我错过了什么。

查看 Rack 文档，我什至尝试像这样更改我的 config.ru：

```
map '/myapp' do
    require ::File.expand_path('../config/environment',  __FILE__)
    run MyApp::Application
end 
```

但这让系统更加困惑，我得到的只是：

```
Not Found: /refinery 
```

当我尝试获取`/myapp/refinery`页面时。

# android - 在android应用程序中创建了多少个活动

> ID：14035123
> 
> 赞同：1
> 
> 时间：2012-12-26T01:15:23.757
> 
> 标签：android

我有两个带有按钮的 Activity，可以在它之间切换

```
Intent intent1=new Intent(Act1.this,Act2.class);
startActivity(intent1); 
```

和

```
Intent intent1=new Intent(Act2.this,Act1.class);
startActivity(intent1); 
```

如果我通过按钮切换十次，我会有多少 Activites？如果我按下设备按钮，我可以看到十个不同的状态 Act1 或 Act2。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-26T01:27:57.257

这取决于您的活动的启动模式。看看[这个页面](http://developer.android.com/guide/components/tasks-and-back-stack.html#TaskLaunchModes)。

但默认情况下，您将拥有初始活动和 10 个新实例 -> 11 个活动。

# javascript - 表单的多个附件

> ID：14035125
> 
> 赞同：0
> 
> 时间：2012-12-26T01:15:35.910
> 
> 标签：javascript, jquery, forms, file-upload

我有一个表单，我必须在其中添加多个附件。此功能应该是动态的，就像用户可以选择任意数量的文件并取消其中任何一个。

在前端，我创建了一个文件输入元素，并在其“onchange”中添加另一个具有不同 ID 和相同名称的文件输入元素。我使用的名称是“附件 []”，因为我需要将附件作为数组发送。

提交按钮调用 javascript 函数，其中使用 jquery 获取参数并创建表单数据。函数片段是

```
function send()
{
var form = document.getElementById("composeForm");

var formElements = form.elements;
var formdata;
for (x in formElements)
{
  //each element that has type='file' and value is 0 is what we want to delete later
  if(formElements[x].type=='file'&&formElements[x].value.length!=0)
  { 
        console.log(document.getElementById(formElements[x].id).files[0]);
    formdata = new FormData();
    var file = document.getElementById(formElements[x].id).files[0];
    formdata.append("attachment[]", file);
  }
}

if (!formdata)
{
    formdata = new FormData();
}

formdata.append("subject", document.getElementById("subjectInput").value);
if (formdata) {
    $.ajax({
        url: "../ws/attach.php",
        type: "POST",
        data: formdata,
        processData: false,
        contentType: false,
        success: function (res) {
            alert(res);
        }
    });
}

return false;
} 
```

但问题是它总是在参数中发送最后添加的文件。上面包含的 console.log 显示了所有文件，即

```
File {webkitRelativePath: "", lastModifiedDate: Thu Dec 06 2012 03:01:55 GMT+0530 (India Standard Time), name: "backup.txt", type: "text/plain", size: 10584}
File {webkitRelativePath: "", lastModifiedDate: Wed Dec 19 2012 16:24:36 GMT+0530 (India Standard Time), name: "acknowledgement.pdf", type: "application/pdf", size: 163435} 
```

但是 chrome 检查元素显示唯一发送的参数是

```
 ------WebKitFormBoundaryVYMwpCkBb8zK6tg0
Content-Disposition: form-data; name="attachment[]"; filename="acknowledgement.pdf"
Content-Type: application/pdf 
```

有什么遗漏吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-26T10:30:34.903

好吧，这是我犯的一个愚蠢的错误。该错误是由于每次都初始化 FormData :(

```
formdata = new FormData(); 
```

无论如何，感谢他们花时间在上面。

# python - 字典查找时间

> ID：14035126
> 
> 赞同：0
> 
> 时间：2012-12-26T01:15:59.077
> 
> 标签：python, dictionary, indexing

我正在尝试使用字典为我的爬虫索引网页，并且遇到了一些有趣的内存问题。

我正在为索引创建一个字典（格式：关键字：[url1，url2，url3，...]），我将使用它来跟踪哪些页面包含哪些单词。当我收集网页时，我使用函数 add_page_to_index()

```
def add_page_to_index(self, url):
    for keyword in url.get_text().split():
        self.add_to_index(keyword, url)
def add_to_index(self, keyword, url):
    for word in self.index:
        if word == keyword:
            if url not in self.index[word]:
                self.index[word].append(url)
            return
    # not found, add new keyword to index
    self.index[keyword] = [url] 
```

这段代码对我很有帮助（我知道它有性能问题，但效率不是这个项目的本质），但是当我将 add_to_index() 更改为：

```
def add_to_index(self, keyword, url):
    if keyword in self.index:
        self.index[keyword].append(url)
    else: # not found, add new keyword to index
        self.index[keyword] = [url] 
```

突然，python 的内存使用量猛增（我最终得到了 MemoryError）。这是我的代码有问题还是有其他解释？

请注意，我是一名高中生，因此我不一定具有最广泛的编程背景。

谢谢！

编辑：把它改成我原来的。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-26T03:55:47.520

两组代码之间的主要区别在于以下行，它仅出现在内存猪中：

```
if keyword in self.index: 
```

在这种情况下，我的猜测`self.index`是相当大，`self.index`每次调用该方法时都必须检查是什么让你丧命。

您还应该考虑是否需要将收集的所有数据一次存储在解释器内存中。您可能最好将尽可能多的数据存储在某种更永久的结构中，例如 csv、redis 或类似的东西。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-26T04:17:54.123

罪魁祸首可能是第二种情况`for word in self.index`的缺席。`if url not in self.index[keyword]`没有它：

*   内存可能会被重复项消耗`self.index[keyword]`
*   代码更快，因此内存也增长更快，因为处理了更多数据

```
from collections import defaultdict

def __init__(self, ...):
    self.index = defaultdict(set)
    # ...

def add_page_to_index(self, page):
    for keyword in page.get_text().split():
        self.add_to_index(keyword, page)

def add_to_index(self, keyword, page):
    self.index[keyword].add(page) 
```

# android - 将数据库中的数据显示到列表视图中

> ID：14035133
> 
> 赞同：0
> 
> 时间：2012-12-26T01:17:47.723
> 
> 标签：android, database, sqlite

我的数据库已全部设置并运行。但现在我遇到的问题是将它加载到列表视图中。我已经尝试了网站上的其他问题，但没有回答我的问题。从初学者（ish）的角度来看。我该怎么做才能将数据库加载到列表视图中？

这是我在课堂上的：（显示类在底部）

```
public class Inventory extends Activity {

DBAdapter db = new DBAdapter(this);
private Cursor cursor = null;

@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.inventory_screen);

    try {
        String destPath = "/data/data/" + getPackageName()
                + "/databases/InventoryDB";
        File f = new File(destPath);
        if (!f.exists()) {
            CopyDB(getBaseContext().getAssets().open("InventoryDB"),
                    new FileOutputStream(destPath));
        }
    } catch (FileNotFoundException e) {
        e.printStackTrace();
    } catch (IOException e) {
        e.printStackTrace();
    }

    DBAdapter db = new DBAdapter(this);

    try {
        db.open();
        Cursor c = db.getAllRecords();
        if (c.moveToFirst()) {
            do {
                DisplayRecord(c);
            } while (c.moveToNext());
        }
        db.close();
    } catch (Exception e) {
        Log.e("ERROR", "ERROR IN CODE:" + e.toString());
        e.printStackTrace();
    }
}

public void CopyDB(InputStream inputStream, OutputStream outputStream)
        throws IOException {
    // ---copy 1K bytes at a time---
    byte[] buffer = new byte[1024];
    int length;
    while ((length = inputStream.read(buffer)) > 0) {
        outputStream.write(buffer, 0, length);
    }
    inputStream.close();
    outputStream.close();
}

// List View
public void DisplayRecord(Cursor c) {
    ListView InventoryItems = (ListView) findViewById(R.id.listViewInventory);

    String[] Items = new String[] {c.getString(1)};

            ArrayAdapter<String> ItemsAdapter = new ArrayAdapter<String>(
                    this, android.R.layout.simple_list_item_1, Items);

            InventoryItems.setAdapter(ItemsAdapter);

    //Toast msg = Toast.makeText(Inventory.this, "id: " + c.getString(0)
        //  + "\n" + "Item: " + c.getString(1) + "\n", Toast.LENGTH_SHORT);
    //msg.show();
} 
```

我只是设置了一个列表视图来提取数据库中的第一个项目（这就是我所有的知识延伸到）

我如何让它显示所有数据？我听说过 simpleCursorAdapter，但我不知道这是否相关？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-26T05:51:25.650

试试这个：

```
public void display()
     {      
            ListView lv=(ListView)findViewById(R.id.listView1);     

            String from[] = new String[] {db.KEY_DATE,db.KEY_DESC,db.KEY_INCOME,db.KEY_ROWID};
            int  to[] = new int[] {R.id.text1 ,R.id.text3,R.id.text5,R.id.text9};

            SimpleCursorAdapter notes =
                new SimpleCursorAdapter(this, R.layout.columnview, c, from, to)            
      {
            @Override
          public void bindView(View view, Context context, Cursor cursor)
            {   

text1.setText(cursor.getString(cursor.getColumnIndex(db.KEY_DATE)));
                                text5.setText(cursor.getString(cursor.getColumnIndex(db.KEY_INCOME)));                         
                                text9.setText(cursor.getString(cursor.getColumnIndex(db.KEY_ROWID)));  

Set to the textview according to your requirement..

};

     lv.setAdapter(notes); 
     } 
```

# codeigniter - 将 codeigniter 应用程序从 Web 服务器复制到 xampp，链接不起作用

> ID：14035134
> 
> 赞同：0
> 
> 时间：2012-12-26T01:17:53.760
> 
> 标签：codeigniter, xampp

我转移了我制作的用于将代码转移到 Codeigniter Bootstrap [https://github.com/sjlu/CodeIgniter-Bootstrap](https://github.com/sjlu/CodeIgniter-Bootstrap)的 codeigniter 应用程序的副本；

我将 baseurl 更改为“localhost/{dir name}”，更改了链接，默认控制器。第一个页面加载正常，但所有链接都重定向回本地主机，我确信我错过了一些愚蠢的东西，但我不知道它是什么？源，如果我输入 localhost/{controller}/{function} 并带有回声来测试它，它不会加载函数

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-26T06:45:03.683

你忘了写`.htaccess`..

```
#php_value upload_max_filesize 200M
#php_value post_max_size 200M
RewriteEngine on

RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d

RewriteCond $1 !^(index\.php|indexcp\.php?|resources|robots\.txt)
RewriteRule ^([A-Za-z0-9_/.-]+)$ index.php?/welcome/$1 

RewriteRule ^(CSI) index.php?/CSI
AddType text/x-component .htc 
```

我已经在你的仓库中添加了

# jquery - HTML jquery 按钮有时没有反应

> ID：14035139
> 
> 赞同：0
> 
> 时间：2012-12-26T01:18:57.327
> 
> 标签：jquery, html, function, button

嗨，我有几个简单的按钮，有时没有反应。它很少发生，但我仍然不喜欢它。如果您非常快速地单击或非常快速地更改导航，它会发生更多。这是我为他们准备的代码：

```
$(document).ready(function () { 
    $('[id*=txt]').hide();
    $('[id*=hd]').hide();                   
    $('[id*=home]').show();
    $('#btnhome').css('background-color',"#555");
    $('#btnhome').css('opacity',"0.4");

    $('.button').click(function (){
        $('[id*=txt]').hide();
        $('[id*=hd]').hide();
        $('.button').css('background',"transparent");
        $('.button').css('opacity',"1");
        $(this).css('background-color',"#555");
        $(this).css('opacity',"0.4");
   });          

    $('#btnhome').click(function () {   
        $('[id*=home]').show();             
    });     

    $('#btnabout').click(function () {              
        $('[id*=about]').show();        
    });    

    $('#btncontact').click(function () {        
        $('[id*=contact]').show();  
    });
}); 
```

它们仅用于显示和隐藏文本，并且在单击时还会更改颜色不透明度等。当他们没有反应时，什么也没有发生，就好像我没有定义任何点击功能一样。

[演示](http://jsfiddle.net/mMF5r/3/)

^这是我基本上使用的，尝试以随机顺序击打它们并以快速方式切换（如果你做得快，会发生更多）。你会看到有时他们没有反应。它有点难以注意到，因为它很少发生（有时更频繁），所以它一开始可能不会发生，但它肯定会发生。所以多试几次，你就会明白我在说什么了。你做的越快越随机，它就会发生的越多。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-26T01:59:36.177

在玩了你的演示之后，我注意到问题是在单击每个按钮上的某个位置时发生的，而不是通过随机或以特定速度单击它们。最佳位置通常位于填充按钮文本边缘的右侧。

我发现`.button:active{}`从 CSS 中删除伪类可以解决问题，所以我的猜测是 CSS 中按钮位置的移动会干扰点击事件。我的建议是将删除的 CSS 样式合并到单击（或 mousedown）事件本身而不是`:active`伪类中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-26T01:42:31.627

我不知道确切原因，但我认为问题是因为当您使用这样的选择器时：

```
 $('[id*=contact]').myFunction(); 
```

JQuery 它会花费更多时间来找到正确的选择器，并且如果在下次单击之前没有找到它，则不会做出反应。有可能在一个复杂的页面中，充满了 div 和信息，故障可以被强调。

对此的支持，我尝试仅更改 onclick 回调，它似乎效果更好：http: [//jsfiddle.net/mmF5r/7/](http://jsfiddle.net/mMF5r/7/)

# ios - Apple Search API 支持设备密钥

> ID：14035147
> 
> 赞同：2
> 
> 时间：2012-12-26T01:20:18.820
> 
> 标签：ios, json, app-store

对于 iPhone 应用程序，supportedDevices 键是否总是返回“全部”？我只对 iphone 应用程序感兴趣，而不对 ipad 应用程序感兴趣，所以我想知道在 supportedDevices 中寻找什么价值以确保它是一个 iphone 应用程序。

[http://www.apple.com/itunes/affiliates/resources/documentation/itunes-store-web-service-search-api.html](http://www.apple.com/itunes/affiliates/resources/documentation/itunes-store-web-service-search-api.html)

Apple 的 API 文档非常有限。supportedDevices 键的可能值是什么？

有没有应用程序可用于 iphone 但不能用于 ipad 的情况？

编辑：

我刚刚注意到这个例子，[https://itunes.apple.com/lookup?id=492861440](https://itunes.apple.com/lookup?id=492861440)

我将如何确定此应用在 iPhone 上是否有效？我会使用键“种类”、“功能”，还是遍历“supportedDevices”？我需要一种防弹方法来确保它是一个 iPhone 应用程序。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-26T01:27:56.930

[所有 iPhone 应用程序都将在 iPad 上运行](http://appadvice.com/appnn/2010/01/all-iphone-apps-will-work-on-the-ipad)，而 iPad 应用程序将不会在 iPhone 上运行，除非它们具有适当大小的 XIB/故事板/资源。

查看您指向的那个示例，我可以看到“supportedDevices”返回为：

```
"supportedDevices":["iPad2Wifi", "iPadWifi", "iPad23G", "iPad3G"] 
```

（不知道为什么它没有说“iPad4”）

这里重要的是它没有说“全部”或“iPhone”，所以如果您在 JSON 结果中没有看到这两个关键字，那么您应该可以安全地假设它只是 iPad。

# python - 将 netCDF 文件导入 Pandas 数据框

> ID：14035148
> 
> 赞同：29
> 
> 时间：2012-12-26T01:20:26.213
> 
> 标签：python, dataframe, pandas, netcdf

圣诞节快乐！我对 Python 和 Pandas 还是很陌生，因此非常感谢任何帮助。我正在尝试读取 netCDF 文件，我可以这样做，然后将其导入 Pandas Dataframe。netcDF 文件是 2D 的，所以我只想将其“转储”。我已经尝试过 DataFrame 方法，但它无法识别该对象。大概我需要将 netCDF 对象转换为 2D numpy 数组？再次感谢您提供有关执行此操作的最佳方法的任何想法。

* * *

## 回答 #1

> 赞同：47
> 
> 时间：2015-03-13T02:24:08.450

xarray库处理任意维度的 netCDF 数据，并保留元数据[。](http://xarray.pydata.org/)Xarray 提供了一种打开 netCDF 文件并将它们转换为 pandas 数据帧的简单方法：

```
import xarray as xr

ds = xr.open_dataset('/path/to/netcdf')
df = ds.to_dataframe() 
```

这将创建一个具有多索引的数据框，其中包含所有维度。不幸的是，Pandas 不支持任意元数据，因此在转换过程中会丢失，但您可以保留`ds`周围，并使用其中的元数据。

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2013-01-24T01:18:17.793

如果您的 NetCDF 文件（或[`OPeNDAP`](https://www.opendap.org/)数据集）遵循 CF 元数据约定，您可以通过使用它们来利用它们[`NetCDF4-Python package`](http://unidata.github.io/netcdf4-python/)，这使得在 Pandas 中访问它们变得非常容易。（我正在使用包含 Pandas 和 NetCDF4-Python 的 Enthought Python 发行版）。

在下面的示例中，NetCDF 文件通过 OPeNDAP 提供服务，NetCDF4-Python 库允许您打开和使用远程 OPeNDAP 数据集，就像它是本地 NetCDF 文件一样，这非常漂亮。如果您想查看 NetCDF4 文件的属性，请将您的浏览器指向此链接[http://geoport-dev.whoi.edu/thredds/dodsC/HUDSON_SVALLEY/5951adc-a1h.nc.html](http://geoport-dev.whoi.edu/thredds/dodsC/HUDSON_SVALLEY/5951adc-a1h.nc.html)

您应该能够在不进行更改的情况下运行它：

```
from matplotlib import pyplot as plt
import pandas as pd
import netCDF4

url='http://geoport-dev.whoi.edu/thredds/dodsC/HUDSON_SVALLEY/5951adc-a1h.nc'
vname = 'Tx_1211'
station = 0

nc = netCDF4.Dataset(url)
h = nc.variables[vname]
times = nc.variables['time']
jd = netCDF4.num2date(times[:],times.units)
hs = pd.Series(h[:,station],index=jd)

fig = plt.figure(figsize=(12,4))
ax = fig.add_subplot(111)
hs.plot(ax=ax,title='%s at %s' % (h.long_name,nc.id))
ax.set_ylabel(h.units) 
```

结果可以在 Ipython Notebook 中看到：http: [//nbviewer.ipython.org/4615153/](http://nbviewer.ipython.org/4615153/)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-12-26T08:05:10.480

您可以使用 PyNIO 之类的库将文件读入 pe numpy 数组并将它们提供给 pandas。
[PyNIO](http://www.pyngl.ucar.edu/Nio.shtml)允许读取多种文件格式，包括经典的 netCDF3 和 netCDF4。
[netcdf4-python](https://github.com/Unidata/netcdf4-python)也可以读取这些 netCDF 格式并且兼容 py3.3

# ios - 自定义 .xib 中保存的 UIBarButton 的文本样式

> ID：14035152
> 
> 赞同：0
> 
> 时间：2012-12-26T01:21:03.060
> 
> 标签：ios, uikit, interface-builder, uibarbuttonitem

我已经开发应用程序几个小时了。

我正在从模板制作一个主视图详细信息应用程序。AppDelegate.m didFinishLaunchingWithOptions 允许我添加一些自定义 GUI 代码来更改导航栏等内容。所以我继续为主导航栏的背景设置了一个自定义背景，就像这样......

```
//custom navbar
UIImage *navigationBarBackground = [UIImage imageNamed:@"NavigationBarBackground.png"];
[[UINavigationBar appearance] setBackgroundImage:navigationBarBackground forBarMetrics:UIBarMetricsDefault]; 
```

惊人的！现在我的导航栏有自定义 bgs！

现在在主视图区域，我在视图的右上角有一个 + 按钮，当您单击它时，会在其余内容上打开一个窗口，但不是全屏，只是输入一些信息的地方，就像一个表格。我用 .xib 创建了一个新类。我从 IB 设计了新窗口。

但是当新窗口弹出时，导航栏不是我的自定义图片，是默认的...

所以我花了几个小时试图找到一种方法来改变这一点。最后，我想出了向 UIToolbar 添加一个自定义类，方法是创建一个新类，该类将使其应用到的任何 navBar 将某个图像加载到其背景中。伟大的！我的 .m 文件如下所示：

```
#import "customToolbar.h" //for your information the .h for this is a blank { }

@implementation customToolbar

- (void)drawRect:(CGRect)rect
{
    CGContextRef c = UIGraphicsGetCurrentContext();
    UIImage *image = [UIImage imageNamed:@"addBusKid-NavBar.png"];
    CGContextDrawImage(c, rect, image.CGImage);
}

@end 
```

太好了，有了这个类，我可以将任何 bg 图像应用到界面生成器中的导航栏。

...

现在，我的导航栏看起来都不错，我决定是时候更改一些文本了！所以，我开始回到我的 AppDelegate.m

我添加了一些代码来更改所有导航栏文本的默认文本样式...

```
// Customize the title text for *all* UINavigationBars
[[UINavigationBar appearance] setTitleTextAttributes:
 [NSDictionary dictionaryWithObjectsAndKeys:
  [UIColor colorWithRed:255.0/255.0 green:255.0/255.0 blue:255.0/255.0 alpha:1.0],
  UITextAttributeTextColor,
  [UIColor colorWithRed:0.0 green:0.0 blue:0.0 alpha:0.8],
  UITextAttributeTextShadowColor,
  [NSValue valueWithUIOffset:UIOffsetMake(0, -1)],
  UITextAttributeTextShadowOffset,
  [UIFont fontWithName:@"Arial-Bold" size:0.0],
  UITextAttributeFont,
  nil]]; 
```

太好了，这改变了我的导航栏文本样式...但是等等，当我打开我用 .xib 制作的弹出窗口时，就像我在 AppDelegate 中添加导航栏样式时一样，它不会影响它的外观。所以无论我制作什么外观协议，它们都不会影响我的自定义类 xibs 外观......

好吧，我尝试制作一个自定义类，就像我为导航栏所做的那样，我可以应用它来赋予它一些风格。但我无法做到这一点（如果你知道请告诉我）......

然后我花了 3 个多小时在这个 .xib 文件中寻找某种方式来设置文本的样式！我在 AppDelegate 中放的任何东西都没有触及它！

因此，在向您彻底解释了自己。我的问题是：

如何设置在界面生成器中创建的 UIBarButton 文本的样式。

无论您是否知道我可以编写的自定义类，然后我可以将其应用于对象，就像我为此做导航栏一样，或者有一些方法可以添加这个 .xibs UI 元素以根据我在 AppDelegate 中声明的内容进行风格化. 请给我提意见。我已经完成了我的家庭作业。

顺便说一句，这是我的第一篇文章！我已经有宾至如归的感觉了！感谢您的支持，我希望我也能对其他人有所帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-26T02:29:45.280

只需`@property`在.xib（视图控制器）类中创建一个将 UIBarButtonItem 声明为 IBOutlet 的类。将此（通过 IB）链接到您的 .xib 按钮表示，然后设置 UIBarItem（父类）textAttributes 方法的样式。

有关更多信息，请参阅此 SO 问题： [如何更改 UIBarButtonItem 的字体？](https://stackoverflow.com/questions/8849913/how-can-i-change-font-of-uibarbuttonitem)

# php - jquery验证，数据未保存在数据库中

> ID：14035153
> 
> 赞同：0
> 
> 时间：2012-12-26T01:21:08.883
> 
> 标签：php, jquery

我这里有一个在数据库中插入数据的代码，它可以工作并且没有错误，但是当我将我的 jquery 代码用于验证数据时，我用于将数据插入数据库的 php 代码不起作用，可以请检查我的代码。谢谢！

这是我的php代码：`index.php`

```
<form id="FormToValidate" action="insert.php" method="POST">
  <div id="content">
    <p>
      <input type="text" name="csname" id="csname" style="width:250px" margin-bottom="3px"/>
         </p>
        <p>
          <select name="units" style="width:254px">
            <option value="option">option</option>
           </option>
            <option value="option">option</option>
</option>

          </select>
        </p>
        <p>
          <input type="text" name="color" id="color" style="width:250px"/>
        </p>

      <p>
        <input type="text" name="consticker" id="consticker" style="width:250px"/>
      </p>
      <p>
        <select name="mp" style="width:254px">
          <option value="name">name</option>

        </select>
      </p>
        <p>
          <select name="grm" style="width:254px">
            <option value="name">name</option>

          </select>
        </p>
        <p><select name="typeoftransact" style="width:254px">
<option value="type">type</option>

</select></p>
      <p>
        <input name="dp" type="dp" style="width:250px" />
      </p>
      <p>
        <input name="amount" type="amount" style="width:250px" />
      </p>
      <p>
        <input name="dirate" type="dirate" style="width:250px" />
      </p>
      <p align="right">AMNT PAID: </p>
<p>NEXT</p>
</div>

    <div id="secondary">
      <p>VSI No.:</p>
        <p>DATE:</p>
        <p>&nbsp; </p>
      <p>TYPE OF SUBSIDY 1:</p>
        <p>TYPE OF SUBSIDY 2:</p>
        <p>TYPE OF SUBSIDY 3:</p>
        <p>TYPE OF SUBSIDY 4:</p>
        <p>TYPE OF SUBSIDY 5:</p>
        <p>CHATTEL MORTGAGE:</p>
        <p>&nbsp;</p>
        <p>
          <input name="chapaid" type="text" style="width:120px" />
        </p>
</div>
    <div id="third">
      <p>
        <input type="text" name="vsi" id="vsi" style="width:180px"/>
</p>
<p>
  <input type="text" name="date" id="date" style="width:180px"/>
</p>
<p>&nbsp;</p>
<p>
  <select name="type1" style="width:180px">
    <option value="option">option</option>
  </select>
</p>
<p>
  <select name="type2" style="width:180px">
   <option value="option">option</option>
  </select>
</p>
<p>
  <select name="type3" style="width:180px">
    <option value="option">option</option>
  </select>
</p>
<p>
  <select name="type4" style="width:180px">
    <option value="option">option</option>
  </select>
</p>
<p>
  <select name="type5" style="width:180px">
    <option value="option">option</option>
  </select>
</p>
        <p>FREE: 
          <input name="chafree" type="text" style="width:100px" />
        </p>
</div>
<div id="fourth">
        <p>&nbsp;</p>
<p>&nbsp;</p>
    <p>&nbsp;</p>
    <p>Php: 
      <input name="type1amount" type="text" style="width:120px" />
        </p>
        <p>Php:
          <input name="type2amount" type="text" style="width:120px" />
        </p>
        <p>Php:
          <input name="type3amount" type="text" style="width:120px" />
        </p>
        <p>Php:
          <input name="type4amount" type="text" style="width:120px" />
        </p>
        <p>Php:
          <input name="type5amount" type="text" style="width:120px" />
        </p>
    <p>COST: 
      <input name="chacost" type="text" style="width:120px" />
    </p>
        <p>&nbsp;</p>

    <p align="right"><input class="small button blue" name="Save" type="submit" id="Save" value="Save" /></p>

</div>
</div>
</form> 
```

这是我的功能，`insert.php`

```
<?php
include("connection.php");

$vsi = $_POST["vsi"];
$date = $_POST["date"];
$custname = $_POST["csname"];
$unit = $_POST["units"];
$color = $_POST["color"];
$consticker = $_POST["consticker"];

$mp = $_POST["mp"];
$grm = $_POST["grm"];
$typetrans = $_POST["typeoftransact"];
$dp = $_POST["dp"];
$amount = $_POST["amount"];
$dirate = $_POST["dirate"];
$typesub1 = $_POST["type1"];
$typesub2 = $_POST["type2"];
$typesub3 = $_POST["type3"];
$typesub4 = $_POST["type4"];
$typesub5 = $_POST["type5"];
$chacost = $_POST["chacost"];
$chapaid = $_POST["chapaid"];
$chafree = $_POST["chafree"];
$type1amount = $_POST["type1amount"];
$type2amount = $_POST["type2amount"];
$type3amount = $_POST["type3amount"];
$type4amount = $_POST["type4amount"];
$type5amount = $_POST["type5amount"];

if($_POST["Save"]=="Save")
{
$query="INSERT INTO accounts (vsi,date,cname,unit,color,consticker,typetrans,downpayment,amountfinanced,dirate,mp,grm,typesub1,typesub2,typesub3,typesub4,typesub5,chapaid,chacost,chafree,type1amount,type2amount,type3amount,type4amount,type5amount)
VALUES
('".$vsi."','".$date."','".$custname."','".$unit."','".$color."','".$consticker."','".$typetrans."','".$dp."','".$amount."','".$dirate."','".$mp."','".$grm."','".$typesub1."','".$typesub2."','".$typesub3."','".$typesub4."','".$typesub5."','".$chapaid."','".$chacost."','".$chafree."','".$type1amount."','".$type2amount."','".$type3amount."','".$type4amount."','".$type5amount."');";

(mysql_query($query))

or die ("error!".mysql_error() );

}

header('Location: index.php');

?> 
```

如果我把这个 jquery 代码，我的 php 代码不起作用，但如果没有，它工作正常，这是我的`jquery script`：

```
<script src="Scripts/jquery-1.6.1.min.js" type="text/javascript"></script>
    <script src="Scripts/jquery-ui-1.8.13.custom.min.js" type="text/javascript"></script>
    <script src="Scripts/jquery.validate.min.js" type="text/javascript"></script>
    <script src="Scripts/jquery.validate.wrapper.js" type="text/javascript"></script>

<script type="text/javascript" language="javascript">

    $(document).ready(function () {
        // 1\. prepare the validation rules and messages.
        var rules = {
            vsi: {
                required: true,
                minlength: 7
            },
            date: "required",
            csname: "required",
            color: "required"
        };
        var messages = {
            vsi: {
                required: "VSI Number must be Inputted.",
                minlength: "VSI Number should be atleast 7 numbers."
            },
            date: "Date is requried",
            csname: "Customer Name is required",
             color: "Color is required"
        };

        // 2\. Initiate the validator
        var validator
            = new jQueryValidatorWrapper("FormToValidate",
                rules, messages);

        // 3\. Set the click event to do the validation
        $("#Save").click(function ()
                     {
                        if (!validator.validate())
                           {
                             return;
                            }
                        $('#FormToValidate').submit();
                         alert("Data Saved!");
                          return;

                    });
    });

</script> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-12-09T09:36:50.950

```
<script src="Scripts/jquery-ui-1.8.13.custom.min.js" type="text/javascript"></script>
<script src="Scripts/jquery.validate.min.js" type="text/javascript"></script>
<script src="Scripts/jquery.validate.wrapper.js" type="text/javascript"></script> 
```

规则、消息）；// 3\. 设置点击事件进行验证 $("#Save").click(function () { if (!validator.validate()) { return; } $('#FormToValidate').submit() ; alert("数据已保存！"); return; }); }); alert("数据已保存！"); 返回; }); }); alert("数据已保存！"); 返回; }); });

# mysql - 为 3 组中的每组获取一个随机记录

> ID：14035156
> 
> 赞同：4
> 
> 时间：2012-12-26T01:22:21.300
> 
> 标签：mysql

我有一张桌子，上面有三类问题。

我使用以下方法得到一个随机问题：

```
SELECT * FROM tblQuestions ORDER BY RAND() LIMIT 1 
```

但是该表还有一个名为 qCategory 的字段，其中总共有 3 个类别。我想要的是从 3 个类别中的每个类别中获取一个问题的 SQL 查询（总共 3 个随机问题）。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-26T01:25:17.540

您可以使用以下方法组合三个查询的结果`UNION ALL`：

```
(SELECT * FROM tblQuestions WHERE qCategory='A' ORDER BY RAND() LIMIT 1)
UNION ALL
(SELECT * FROM tblQuestions WHERE qCategory='B' ORDER BY RAND() LIMIT 1)
UNION ALL
(SELECT * FROM tblQuestions WHERE qCategory='C' ORDER BY RAND() LIMIT 1) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-26T01:27:00.757

一种方法是使用`GROUP BY`：

```
SELECT * FROM tblQuestions ORDER BY RAND() GROUP BY qCategory 
```

# python - OpenCV 匿名/保证唯一窗口

> ID：14035161
> 
> 赞同：2
> 
> 时间：2012-12-26T01:23:40.907
> 
> 标签：python, opencv

OpenCV 很新，所以请多多包涵：

我需要为用户输入打开一个临时窗口，但我需要确定它不会覆盖以前打开的窗口。

有没有办法打开一个匿名窗口，或者以某种方式创建一个保证唯一的窗口名称？

显然，一个长的随机字符串会非常安全，但这似乎是一个 hack。

PS 我目前正在使用 python 绑定，但如果你想用 c/c++ 编写响应，那很好，我对它们很熟悉。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-27T02:30:22.073

在`modules/highgui/src/window_w32.cpp`（或在其他文件中，如果您不使用 windows - 查看`void cv::namedWindow( const string& winname, int flags )`in `...src/window.cpp`）有一个`static CvWindow* icvFindWindowByName( const char* name )`可能是您需要的功能，但它是内部的，因此 OpenCV 的作者出于某种原因不希望其他人使用它（或不'不知道有人可能需要它）。

我认为最好的选择是使用系统 api 来查找是否存在具有特定名称的窗口。
最终使用几乎不可能成为窗口名称的东西，例如以毫秒为单位的当前时间 + 用户名 + 随机数 + 随机字符串（是的，我知道窗口名称“234564312cyriel123234123dgbdfbddfgb#$%grw$”并不漂亮）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-27T16:08:57.503

我自己想出了一个可能的解决方案：

围绕 imshow 和 namedWindow 的一些简单包装器允许将所有当前窗口名称的列表记录在全局变量中。

```
window_list = []
def new_window(name=None):
    if name == None:
        i=0
        while str(i) in window_list:
            i = i+1
        name = str(i)
    if name not in window_list:
        window_list.append(name)
    cv2.namedWindow(name)        #always create the window, in case it's been manually closed
                                 #does nothing if window is already open
    return name

def img_show(img, name=None):
    name = new_window(name)
    cv2.imshow(name, img)
    return name 
```

对 img_show 的不带名称调用提供了一个递增的默认名称。

这与在 IDL 中获得的行为有点相似。显然这不是最强大的解决方案，并且要求所有代码都使用这些包装器，但它现在可以满足我的需求。

# arrays - 按数字范围获取/排序 - 语法问题

> ID：14035170
> 
> 赞同：0
> 
> 时间：2012-12-26T01:25:46.013
> 
> 标签：arrays, matlab, logic, octave, boolean-logic

我正在使用八度音程，但在整理范围时遇到了麻烦。我可以通过说包括小于或等于 4 的任何内容来完成 delta 部分。但我忘记了如何为 Theta 部分选择一个数字范围。例如从 4 到 8。

PS 我正在使用 Octave/Matlab

```
%   delta 0hz to 4 hz
    array2_deltafreq_sort=sortrows(array2,1); %used only to export txt file
    array2_deltafreq_sort_limit_idx=array2_deltafreq_sort(:,1)<=4 ;% idx to limit array 
```

我累了

```
%theta 4hz to 8hz
    array2_thetafreq_sort=sortrows(array2,1); %used only to export txt file
    array2_thetafreq_sort_limit_idx=array2_thetafreq_sort(:,1)<=4 & array2_thetafreq_sort(:,1)>=8  ;% idx to limit array to
    array2_thetafreq_sort_limit=array2_thetafreq_sort(array2_thetafreq_sort_limit_idx,:); 
```

但是当我查看数组时，我得到`array2_thetafreq_sort_limit = [](0x8)`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-26T03:35:07.207

试试这个：

```
 array2_thetafreq_sort_limit_idx=array2_thetafreq_sort(:,1)<=8 & array2_thetafreq_sort(:,1)>=4  ;% idx to limit array 
```

# r - 拆分数据框

> ID：14035174
> 
> 赞同：3
> 
> 时间：2012-12-26T01:26:51.527
> 
> 标签：r

圣诞节快乐

我想拆分一个长数据框。数据框看起来像这样

```
 x<-c('0:00:00', '0:30:00', '1:00:00', '1:30:00', '2:00:00', '2:30:00', '3:00:00',
    '0:00:00', '0:30:00', '1:00:00', '1:30:00', '2:00:00', '2:30:00', '3:00:00', 
    '3:30:00', '4:00:00','0:00:00', '0:30:00', '1:00:00', '1:30:00', '2:00:00',
     '2:30:00', '3:00:00', '0:00:00', '0:30:00', '1:00:00', '1:30:00', '2:00:00',
     '2:30:00', '3:00:00' , '3:30:00', '4:00:00')

    y=seq(1:32)

    data1=data.frame(x,y) 
```

我想以输出看起来像这样的方式拆分

```
 0:00:00  1  8 17 24  
    0:30:00  2  9 18 25  
    1:00:00  3 10 19 26  
    1:30:00  4 11 20 27  
    2:00:00  5 12 21 28  
    2:30:00  6 13 22 29  
    3:00:00  7 14 23 30  
    3:30:00 NA 15 NA 31  
    4:00:00 NA 16 NA 32 
```

我为此考虑的任何想法或功能？我尝试使用拆分功能，但无法完成。非常感谢您的帮助和时间。

Matthew 的以下解决方案效果最好。但是，如果我增加 x 的周期时间

```
 x<-c('0:00:00', '0:30:00', '1:00:00', '1:30:00', '2:00:00', '2:30:00', '3:00:00', '3:30:00',
    '4:00:00', '4:30:00', '5:00:00', '5:30:00', '6:00:00', '6:30:00', '7:00:00', 
    '7:30:00','8:00:00', '8:30:00', '9:00:00', '9:30:00', '10:00:00', '10:30:00',
     '11:00:00','11:30:00','0:00:00', '0:30:00', '1:00:00', '1:30:00', '2:00:00', '2:30:00', 
    '3:00:00', '3:30:00', '4:00:00', '4:30:00', '5:00:00', '5:30:00', '6:00:00', '6:30:00', 
    '7:00:00', '7:30:00','8:00:00', '8:30:00', '9:00:00', '9:30:00', '10:00:00', '10:30:00', 
    '11:00:00','11:30:00', '12:00:00', '12:30:00', '13:00:00', '13:30:00') 
```

并使用相同的代码，我收到以下错误：

```
 Error in match.names(clabs, names(xi)) : names do not match previous names 
```

干杯，斯瓦加特

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-26T01:54:58.687

这是已编辑问题的数据：

```
x <- c('0:00:00', '0:30:00', '1:00:00', '1:30:00', '2:00:00', '2:30:00', 
      '3:00:00', '3:30:00', '4:00:00', '4:30:00', '5:00:00', '5:30:00',
      '6:00:00', '6:30:00', '7:00:00', '7:30:00','8:00:00', '8:30:00',
      '9:00:00', '9:30:00', '10:00:00', '10:30:00', '11:00:00','11:30:00',
      '0:00:00', '0:30:00', '1:00:00', '1:30:00', '2:00:00', '2:30:00',
      '3:00:00', '3:30:00', '4:00:00', '4:30:00', '5:00:00', '5:30:00',
      '6:00:00', '6:30:00', '7:00:00', '7:30:00','8:00:00', '8:30:00', 
      '9:00:00', '9:30:00', '10:00:00', '10:30:00', '11:00:00','11:30:00', 
      '12:00:00', '12:30:00', '13:00:00', '13:30:00')

y=seq(1:52)

data1=data.frame(x,y) 
```

我们需要创建一个表示天数的分类变量，而我们在这里需要处理的只是时间。如果时间倒退，假设它是新的一天。为此，我们将使用因子按顺序将时间值转换为整数。

这是一个`lev`级别向量 , 和一个包含与 data$x 相同的字符串`c('0:00:00', '0:30:00', '1:00:00', ...)`的因子，但使用此向量作为级别：`fac`

```
lev <- paste(t(outer(0:23, c('00', '30'), paste, sep=':')), '00', sep=':')
fac <- factor(as.character(data1$x), levels=lev, ordered=TRUE) 
```

现在我们通过应用来查看何时回归`diff`：

```
d <- c(0, diff(
  as.numeric(factor(as.character(data1$x), levels=lev, ordered=TRUE)))
       ) 
```

现在（受此问题的其他两个答案的启发）`cumsum(d<0)`是我们需要的分类变量，它可以应用于数据框，并用于重塑：

```
data1$grp <- cumsum(d<0)
res <- reshape(data1, direction="wide", idvar="x", timevar="grp")

> res
          x y.0 y.1
1   0:00:00   1  25
2   0:30:00   2  26
3   1:00:00   3  27
4   1:30:00   4  28
5   2:00:00   5  29
6   2:30:00   6  30
7   3:00:00   7  31
8   3:30:00   8  32
9   4:00:00   9  33
10  4:30:00  10  34
11  5:00:00  11  35
12  5:30:00  12  36
13  6:00:00  13  37
14  6:30:00  14  38
15  7:00:00  15  39
16  7:30:00  16  40
17  8:00:00  17  41
18  8:30:00  18  42
19  9:00:00  19  43
20  9:30:00  20  44
21 10:00:00  21  45
22 10:30:00  22  46
23 11:00:00  23  47
24 11:30:00  24  48
49 12:00:00  NA  49
50 12:30:00  NA  50
51 13:00:00  NA  51
52 13:30:00  NA  52 
```

这与其他答案有何不同：它不假设一天总是包含时间“0:00:00”，并且它不要求 data1$x 是字符变量——即使是，它以正确的顺序获取时间。比较`character`会说 2:00:00 发生在 13:00:00 之后。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-26T05:59:37.873

如果我们可以假设每个新周期开始于`0:00:00`并且每个新周期将始终包含一个`0:00:00`，那么我们可以在使用`reshape()`创建一个“时间”变量后轻松使用`cumsum()`。

```
data1 <- data.frame(
  x = c('0:00:00', '0:30:00', '1:00:00', '1:30:00', '2:00:00', '2:30:00', 
        '3:00:00', '0:00:00', '0:30:00', '1:00:00', '1:30:00', '2:00:00', 
        '2:30:00', '3:00:00', '3:30:00', '4:00:00','0:00:00', '0:30:00', 
        '1:00:00', '1:30:00', '2:00:00', '2:30:00', '3:00:00', '0:00:00', 
        '0:30:00', '1:00:00', '1:30:00', '2:00:00', '2:30:00', '3:00:00' ,
        '3:30:00', '4:00:00'),
  y = seq(1:32))
data1$times <- cumsum(data1$x == "0:00:00")
reshape(data1, direction = "wide", idvar = "x", timevar = "times")
#          x y.1 y.2 y.3 y.4
# 1  0:00:00   1   8  17  24
# 2  0:30:00   2   9  18  25
# 3  1:00:00   3  10  19  26
# 4  1:30:00   4  11  20  27
# 5  2:00:00   5  12  21  28
# 6  2:30:00   6  13  22  29
# 7  3:00:00   7  14  23  30
# 15 3:30:00  NA  15  NA  31
# 16 4:00:00  NA  16  NA  32 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-26T07:34:54.753

（请参阅下面的编辑。）此解决方案基于“x”变量的序列创建一个组变量，但确实要求您使用 stringsAsFactors=FALSE 创建数据框或将因子“x”转换为`as.character()`：

```
> data1=data.frame(x,y, stringsAsFactors=FALSE)
> data1$grp <- with(data1, cumsum( c( 0 , x[-1]  < x[-length(x)] ) ) )
> reshape(data1, direction="wide", idvar="x", timevar="grp")
         x y.0 y.1 y.2 y.3
1  0:00:00   1   8  17  24
2  0:30:00   2   9  18  25
3  1:00:00   3  10  19  26
4  1:30:00   4  11  20  27
5  2:00:00   5  12  21  28
6  2:30:00   6  13  22  29
7  3:00:00   7  14  23  30
15 3:30:00  NA  15  NA  31
16 4:00:00  NA  16  NA  32 
```

根据编辑：如果 x 变量首先转换为数据时间类，则相同的策略应该起作用：

```
x <- as.POSIXct(x, format="%H:%M:%S") 
```

# python - 带有数字比较的简单 Python 头痛

> ID：14035176
> 
> 赞同：1
> 
> 时间：2012-12-26T01:27:09.907
> 
> 标签：python, numbers

为了保持一个干净的问题，问题在代码中被注释了:)

```
theOpenFile = open('text.txt', 'r')
highest = 0
for myCurrentString in theOpenFile.readlines():

                                          ## Simple string manipulation
    stringArray = myCurrentString.split() ## to get value, this seems to
    series = stringArray[0].split('.')[0] ## work perfectly when I
                                          ## "print series" at the end

    if series > highest:                  ## This doesn't work properly,
        highest = series                  ## although no syntantic or
        print "Highest = " + series       ## runtimes errors, just wrong output

    print series
theOpenFile.close() 
```

输出

```
Highest = ï»¿8
ï»¿8
Highest = 6
6
Highest = 6
6
Highest = 8
8
Highest = 8
8
Highest = 7
7
Highest = 4
4 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-26T01:31:04.337

你在比较字符串，而不是数字，所以事情可能会有点奇怪。将您的变量转换为 a`float`或 an`int`它应该可以工作

```
with open('text.txt', 'r') as theOpenFile:
    highest = 0
    for myCurrentString in theOpenFile:
        stringArray = myCurrentString.split()

        try:
            series = float(stringArray[0].split('.')[0])
        except ValueError:
            # The input wasn't a number, so we just skip it and go on
            # to the next one
            continue

        if series > highest:
            highest = series
            print "Highest = " + series

        print series 
```

一种更清洁的方法是这样的：

```
with open('text.txt', 'r') as handle:
    numbers = []

    for line in handle:
        field = line.split()[0]

        try:
            numbers.append(float(field))  # Or `int()`
        except ValueError:
            print field, "isn't a number"
            continue

    highest = max(numbers) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-26T04:32:28.397

假设文件中每个非空白行的空格前都有一个点：

```
with open('text.txt') as file:
  highest = max(int(line.partition('.')[0]) for line in file if line.strip()) 
```

# javascript - jQuery在滚动上加载更多数据

> ID：14035180
> 
> 赞同：165
> 
> 时间：2012-12-26T01:28:04.177
> 
> 标签：javascript, jquery, ajax, scroll

我只是想知道只有在 div.loading 可见的情况下，我如何才能在滚动上实现更多数据。

通常我们会寻找页面高度和滚动高度，看看是否需要加载更多数据。但下面的例子有点复杂。

下图是完美的例子。下拉框中有两个 .loading div。当用户滚动内容时，无论哪个可见，它都应该开始为其加载更多数据。

![在此处输入图像描述](../Images/becf7b9bc8d25b3862cbadeb59b403cf.png)

那么我怎样才能知道 .loading div 是否对用户可见呢？所以我可以开始只为那个 div 加载数据。

* * *

## 回答 #1

> 赞同：317
> 
> 时间：2013-06-13T02:02:26.003

在 jQuery 中，使用滚动功能检查您是否点击了页面底部。一旦你点击它，进行 ajax 调用（你可以在这里显示加载图像直到 ajax 响应）并获取下一组数据，将其附加到 div。当您再次向下滚动页面时，此函数将被执行。

```
$(window).scroll(function() {
    if($(window).scrollTop() == $(document).height() - $(window).height()) {
           // ajax call get data from server and append to the div
    }
}); 
```

* * *

## 回答 #2

> 赞同：88
> 
> 时间：2012-12-26T01:30:47.683

你听说过[**jQuery Waypoint 插件**](http://imakewebthings.com/jquery-waypoints/)吗？

以下是调用航点插件并在滚动到达底部后让页面加载更多内容的简单方法：

```
$(document).ready(function() {
    var $loading = $("<div class='loading'><p>Loading more items&hellip;</p></div>"),
    $footer = $('footer'),
    opts = {
        offset: '100%'
    };

    $footer.waypoint(function(event, direction) {
        $footer.waypoint('remove');
        $('body').append($loading);
        $.get($('.more a').attr('href'), function(data) {
            var $data = $(data);
            $('#container').append($data.find('.article'));
            $loading.detach();
            $('.more').replaceWith($data.find('.more'));
            $footer.waypoint(opts);
        });
    }, opts);
}); 
```

* * *

## 回答 #3

> 赞同：15
> 
> 时间：2018-10-19T11:49:41.607

如果不是所有文档都滚动，例如，当您在文档中滚动时，如果`div`没有调整，上述解决方案将无法工作。以下是如何检查 div 的滚动条是否已到达底部：

```
$('#someScrollingDiv').on('scroll', function() {
    let div = $(this).get(0);
    if(div.scrollTop + div.clientHeight >= div.scrollHeight) {
        // do the lazy loading here
    }
}); 
```

* * *

## 回答 #4

> 赞同：13
> 
> 时间：2018-06-11T06:47:12.217

当窗口放大到大于 100% 的值时，这个问题的公认答案与 chrome 有一些问题。这是 chrome 开发人员推荐的代码，作为我提出的错误的一部分。

```
$(window).scroll(function() {
  if($(window).scrollTop() + $(window).height() >= $(document).height()){
     //Your code here
  }
}); 
```

以供参考：

[相关的SO问题](https://stackoverflow.com/questions/30320512/code-on-scroll-event-is-not-executing-if-window-is-zoomed-in-out-in-chrome)

[铬错误](https://bugs.chromium.org/p/chromium/issues/detail?id=489618)

* * *

## 回答 #5

> 赞同：13
> 
> 时间：2017-08-23T18:13:55.913

这是一个例子：

1.  滚动到底部时，会附加 html 元素。这种附加机制只做了两次，最后附加了一个粉蓝色的按钮。

```
<!DOCTYPE html>
<html>
<head>
    <title>Demo: Lazy Loader</title>
    <script src="https://code.jquery.com/jquery-3.2.1.min.js"></script>
    <style>
        #myScroll {
            border: 1px solid #999;
        }

        p {
            border: 1px solid #ccc;
            padding: 50px;
            text-align: center;
        }

        .loading {
            color: red;
        }
        .dynamic {
            background-color:#ccc;
            color:#000;
        }
    </style>
    <script>
		var counter=0;
        $(window).scroll(function () {
            if ($(window).scrollTop() == $(document).height() - $(window).height() && counter < 2) {
                appendData();
            }
        });
        function appendData() {
            var html = '';
            for (i = 0; i < 10; i++) {
                html += '<p class="dynamic">Dynamic Data :  This is test data.<br />Next line.</p>';
            }
            $('#myScroll').append(html);
			counter++;

			if(counter==2)
			$('#myScroll').append('<button id="uniqueButton" style="margin-left: 50%; background-color: powderblue;">Click</button><br /><br />');
        }
    </script>
</head>
<body>
    <div id="myScroll">
        <p>
            Contents will load here!!!.<br />
        </p>
        <p >This is test data.<br />Next line.</p>
        <p >This is test data.<br />Next line.</p>
        <p >This is test data.<br />Next line.</p>
        <p >This is test data.<br />Next line.</p>
        <p >This is test data.<br />Next line.</p>
        <p >This is test data.<br />Next line.</p>
        <p >This is test data.<br />Next line.</p>
        <p >This is test data.<br />Next line.</p>
        <p >This is test data.<br />Next line.</p>
        <p >This is test data.<br />Next line.</p>
        <p >This is test data.<br />Next line.</p>
        <p >This is test data.<br />Next line.</p>
        <p >This is test data.<br />Next line.</p>
        <p >This is test data.<br />Next line.</p>
        <p >This is test data.<br />Next line.</p>
        <p >This is test data.<br />Next line.</p>
        <p >This is test data.<br />Next line.</p>
        <p >This is test data.<br />Next line.</p>
        <p >This is test data.<br />Next line.</p>
        <p >This is test data.<br />Next line.</p>
        <p >This is test data.<br />Next line.</p>
        <p >This is test data.<br />Next line.</p>
    </div>
</body>
</html>
```

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2020-05-22T12:20:14.327

改进@deepakssn 的答案。在我们实际滚动***到底部******之前***，您可能希望数据加载一点。

 *```
var scrollLoad = true;
$(window).scroll(function(){
 if (scrollLoad && ($(document).height() - $(window).height())-$(window).scrollTop()<=800){
    // fetch data when we are 800px above the document end
    scrollLoad = false;
   }
  }); 
```

[var scrollLoad] 用于阻止调用，直到追加一个新数据。

希望这可以帮助。

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2020-08-07T08:10:10.810

我建议使用更多 Math.ceil 以避免在某些屏幕上出现错误。
因为在几个不同的屏幕上它不是绝对准确的
，所以当我使用 console.log 时我意识到这一点。

```
console.log($(window).scrollTop()); //5659.20123123890 
```

和

```
console.log$(document).height() - $(window).height()); // 5660 
```

所以我认为我们应该将您的代码编辑为

```
$(window).scroll(function() {
    if(Math.ceil($(window).scrollTop()) 
       == Math.ceil(($(document).height() - $(window).height()))) {
           // ajax call get data from server and append to the div
    }
}); 
```

或允许在滚动到底部之前从服务器加载数据。

```
if ($(window).scrollTop() >= ($(document).height() - $(window).height() - 200)) {
 // Load data
} 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2018-11-02T13:15:54.210

我花了一些时间试图找到一个很好的函数来包装解决方案。无论如何，我认为这是在单个页面或跨站点上加载多个内容时更好的解决方案。

**功能：**

```
function ifViewLoadContent(elem, LoadContent)
    {
            var top_of_element = $(elem).offset().top;
            var bottom_of_element = $(elem).offset().top + $(elem).outerHeight();
            var bottom_of_screen = $(window).scrollTop() + window.innerHeight;
            var top_of_screen = $(window).scrollTop();

            if((bottom_of_screen > top_of_element) && (top_of_screen < bottom_of_element)){
            if(!$(elem).hasClass("ImLoaded"))   {
                $(elem).load(LoadContent).addClass("ImLoaded");
            }
            }
            else {
               return false;
            }
        } 
```

然后，您可以使用滚动窗口调用该函数（例如，您也可以像我一样将其绑定到单击等，因此该函数）：

**要使用：**

```
$(window).scroll(function (event) {
        ifViewLoadContent("#AjaxDivOne", "someFile/somecontent.html"); 

        ifViewLoadContent("#AjaxDivTwo", "someFile/somemorecontent.html"); 
    }); 
```

这种方法也应该适用于滚动 div 等。我希望它有所帮助，在上面的问题中，您可以使用这种方法分段加载您的内容，也许附加并因此运球馈送所有图像数据而不是批量馈送。

我使用这种方法来减少[https://www.taxformcalculator.com](https://www.taxformcalculator.com)的开销。它死了，如果你查看网站并检查元素等，你可以看到对 Chrome 中页面加载的影响（例如）。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2019-10-29T07:30:37.560

您的具体问题是关于**在 div 进入 view 时**加载数据，而不是在用户到达页面末尾时加载数据。

这是您问题的最佳答案：[https ://stackoverflow.com/a/33979503/3024226](https://stackoverflow.com/a/33979503/3024226)*

# batch-file - Windows - 启动命令和协议处理程序

> ID：14035186
> 
> 赞同：2
> 
> 时间：2012-12-26T01:28:53.080
> 
> 标签：batch-file, internet-explorer-9, protocols, command-prompt, dos

我正在尝试在我的本地计算机上为 IE9 中的[Sublime Text创建一个 Web 协议。](http://www.sublimetext.com/)我跟着[微软在这里添加协议指南](http://msdn.microsoft.com/en-us/library/aa767914%28v=vs.85%29.aspx)。

不幸的是，我无法将`command`密钥的注册表值直接链接到 sublime，因为协议`sublime:`已附加到地址。因此，如果我键入`sublime:test.txt`，则整个字符串将传递给 sublime，而 sublime 不知道如何处理它。

所以，我制作了一个快速批处理文件来清理字符串，`subl.bat`.

```
@echo off
echo %1%
pause
set str=%1
set str=%str:sublime:=%
start "" CALL "C:\Program Files\Sublime Text 2\sublime_text.exe" "%str%"
echo %str%
pause 
```

暂停仅用于调试，可以忽略。这个批处理文件只是去掉了`sublime:`参数的一部分，然后调用 sublime 传递经过清理的参数。

现在，当我将`command`注册表项更改为：

"C:\subl.bat" "%1"

然后在 Internet Explorer 中尝试，我得到了错误`file path not found`。好吧，如果您尝试使用命令运行带有引号中的名称和引号中的参数的批处理文件`start`，您实际上需要为窗口标题添加一个字符串并在其后插入`CALL`命令，就像在我的批处理文件中一样。我的猜测是 Internet Explorer 正在使用`start`命令或类似命令，并且由于两个参数都在引号中，因此它失败了。我尝试将值更改为：

```
"" CALL "C:\subl.bat" "%1" 
```

和

```
CALL "C:\subl.bat" "%1" 
```

但都没有奏效。但是，如果我删除周围的引号`%1`并且参数没有空格，则协议有效！一旦参数和程序有引号，它就会中断。

我真的很想弄清楚为什么我不能在程序路径和参数中编写一个带有空格的协议处理程序（每个都用引号括起来）。有人有想法么？

如果您想对此进行测试，则无需每次更改注册表项时都重新启动计算机，因此很容易重现。

哦，该协议在 Firefox 中有效，但是`test`如果`2`文件是`test 2.log`. 这是`start`命令表现不正常的另一个实例，因为如果您查看我的批处理文件，我会将`str`变量括在引号中，因此应该保留空格。如果我在与 sublime 相同的目录中打开提示符并使用命令行 arg 运行 sublime，则`c:\test 2.log`sublime 正确打开只是`test 2.log`，不是`test`，`2`所以我知道这是`start`命令的问题。

编辑：我应该补充一点，我也尝试过对路径进行 URL 编码，因为 MSDN 说 URI 不应包含特殊字符，但这也不起作用。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-26T16:10:57.597

从第一次阅读开始，似乎路径被误解了。这让我相信这是一个报价问题。（因为批处理脚本喜欢引用 [讽刺]）我认为你有很多周围的引用。

试试这个：（添加波浪号，第 2 行也不需要尾随`%`。） set 变量周围的引号允许值中的特殊字符。

```
@echo off
echo %1
pause
set "str=%~1"
set "str=%str:sublime:=%"
start "" CALL "C:\Program Files\Sublime Text 2\sublime_text.exe" "%str%"
echo %str%
pause 
```

与：（添加波浪号）

```
CALL "C:\subl.bat" "%~1" 
```

波浪号`~`将从字符串中删除任何周围的引号（如果有）。

# audio - C# 当声音停止播放时改变图像

> ID：14035187
> 
> 赞同：0
> 
> 时间：2012-12-26T01:29:01.800
> 
> 标签：audio, while-loop, state, soundplayer

我正在制作一个 .wav 播放器应用程序，其中有一个按钮可以播放加载的 .wav

因此，如果声音正在播放，则会显示“暂停”按钮，当声音停止时，将显示“播放”按钮。

目前使用这个：

```
 using (SoundPlayer player = new SoundPlayer(label1.Text))
        {
            pictureBox1.Image = Form1.Properties.Resources.play_button;
            try
            {
                player.Play();
            }
            catch (FileNotFoundException)
            {
                MessageBox.Show("File has been moved." + "\n" + "Please relocate it now!");
            }
        } 
```

有没有办法做到？如果是怎么制作呢？如果可能，来源？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-26T01:59:59.347

您可能需要声音播放器以外的东西...我在 msdn 上看不到任何可以让您暂停或捕捉 onpause 事件的东西...尝试使用 mediaplayer 类？

# mongodb - 数据库引擎架构书籍？

> ID：14035188
> 
> 赞同：1
> 
> 时间：2012-12-26T01:29:17.870
> 
> 标签：mongodb, architecture, database

我找不到任何与此类似的问题，我想知道任何与数据库引擎内部工作方式相关的书籍。如果你愿意的话，这是一本关于数据库引擎的“龙书”。

我正在 MongoDB 上观看这个视频，它让我对数据库引擎的内部工作及其架构产生了兴趣。

[**MongoDB，高性能无 SQL 数据库**](http://www.youtube.com/watch?v=tFp9pZ6U0PE)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-26T01:50:13.477

也许这个？ [http://my.safaribooksonline.com/book/databases/mysql/0596009577](http://my.safaribooksonline.com/book/databases/mysql/0596009577) 第十章是关于存储引擎的。它可能主要是关于不同类型的存储引擎，但它应该在那里有价值。

# awk - awk 字段分隔符 \[ \]

> ID：14035189
> 
> 赞同：1
> 
> 时间：2012-12-26T01:29:28.793
> 
> 标签：awk

给定以下命令：

```
cat 11 | awk -F"[\[\]]" '{print $1,$2}'        
cat 11 | awk -F"[\]\[]" '{print $1,$2}' 
```

为什么awk输出不同：

```
zxscgdb@linux:~/tmp> cat 11    
12-05 09:07:53:33 F[zxinit_lib.c] L[485] E[10106] process:zxsc_gdb is ok.    
12-05 09:08:03:35 F[zxinit_lib.c] L[485] E[10106] process:zxsc_gdb is ok.    
12-05 09:08:13:37 F[zxinit_lib.c] L[485] E[10106] process:zxsc_gdb is ok.

zxscgdb@linux:~/tmp> cat 11 | awk -F"[\]\[]" '{print $1,$2}'    
awk: warning: escape sequence `\]' treated as plain `]'    
awk: warning: escape sequence `\[' treated as plain `['    
12-05 09:07:53:33 F zxinit_lib.c    
12-05 09:08:03:35 F zxinit_lib.c    
12-05 09:08:13:37 F zxinit_lib.c    

zxscgdb@linux:~/tmp> cat 11 | awk -F"[\[\]]" '{print $1,$2}'    
awk: warning: escape sequence `\[' treated as plain `['    
awk: warning: escape sequence `\]' treated as plain `]'    
12-05 09:07:53:33 F[zxinit_lib.c] L[485] E[10106] process:zxsc_gdb is ok.     
12-05 09:08:03:35 F[zxinit_lib.c] L[485] E[10106] process:zxsc_gdb is ok.     
12-05 09:08:13:37 F[zxinit_lib.c] L[485] E[10106] process:zxsc_gdb is ok. 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-26T10:39:41.007

我的理解是你想用`[`and`]`作为分隔符。在这种情况下：

```
awk -F '[][]' '{print $1,$2}' 11 
```

`]`紧跟在 a `[`(如) 之后的 char`[]]`被视为自身。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-26T01:58:11.810

您需要使用单引号绕过 shell 解释：

```
awk -F'[\\[\\]]' '{print $2,$4}' 11 
```

或转义第一个退格键：

```
 awk -F"[\\\[\\\]]" '{print $2,$4}' 11 
```

# python - Django：批量操作

> ID：14035198
> 
> 赞同：7
> 
> 时间：2012-12-26T01:31:11.060
> 
> 标签：python, sql, django, orm, bulk

**业务：**
我遇到了一个问题 - 当使用 Django ORM 处理大型数据集时，规范的方式是处理每个元素。但是当然这种方式是非常低效的。所以我决定使用原始 SQL。

**物质：**
我有一个基本代码，它形成 SQL 查询，更新表的行，并提交它：

```
from myapp import Model
from django.db import connection, transaction
COUNT = Model.objects.count()
MYDATA = produce_some_differentiated_data() #Creating individual value for each row
cursor = connection.cursor()
str = []
for i in xrange(1, COUNT):
    str.append("UPDATE database.table\n"
               "SET field_to_modify={}\n"
               "WHERE primary_key_field={};\n".format(MYDATA, i))

str = ''.join(str)
cursor.execute(str)
transaction.commit_unless_managed() #This cause exception 
```

在最后一个陈述中，我得到了这个，即使`SIZE`很小：

```
_mysql_exceptions.ProgrammingError: (2014, "Commands out of sync; you can't run this command now") 
```

也许 Django 不允许一次执行多个 SQL 查询？

ps 在提交之前关闭游标有助于避免异常，但这是正确的吗？

**我的期望：**
我正在为批量操作寻找所有可能的可靠解决方案（最好在 Django 内部）。我不在乎它是 ORM 还是原始 SQL，如果我能避免错误，我会支持上面粘贴的代码。在没有解决方案的情况下，至少出于好奇，知道这个异常的原因是好的。

**除了答案，我还学到了什么：**
在 Django 1.4 中引入[`bulk_create`](https://docs.djangoproject.com/en/dev/ref/models/querysets/#django.db.models.query.QuerySet.bulk_create)了高效的多重`INSERT`操作

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-29T12:50:07.313

Django 1.4+ 在它的 ORM 中对批量操作有相当不错的支持，你应该看看你是否可以使用它——它是最便携的方式，也很好用。

它不仅允许为所有对象中的字段更新相同的值（这很简单），还允许根据其他字段更新字段值以及执行一些有限的计算。我不确定它是否符合您的需要（取决于“produce_some_differentiated_data”的工作方式）-您可以进行一些计算，其中一些可能不适合。一些例子：

```
image_id_list = [1,5,6]
Image.objects.filter(image_id__in=image_id_list).
     update(views_number=F('views_number') + 1) 
```

上面的示例将转换为类似于以下内容的 SQL：

```
UPDATE image SET views_number = views_number + 1 WHERE image_id IN (1,5,6); 
```

这是进行批量更新的最快方法 - 比运行多个查询更快。在单个 SQL 语句中运行多个查询并不能真正提高运行速度。真正改进的是进行像上面这样的单个查询，该查询同时对多行进行操作。您可以在更新语句中构建相当复杂的公式，因此如果您的“produce_some_differentiated_data”方法可以以这种方式表达，则最好。即使不能直接完成，您也可以对模型进行一些修改并添加一些额外的字段来实现这一点。如果经常执行此类批量操作，那可能会有所回报。

来自 Django 的文档：

> Django 支持对 F() 对象使用加法、减法、乘法、除法和模算术，包括常量和其他 F() 对象。

更多信息在这里： [https ://docs.djangoproject.com/en/dev/topics/db/queries/#updating-multiple-objects-at-once](https://docs.djangoproject.com/en/dev/topics/db/queries/#updating-multiple-objects-at-once)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-12-29T16:47:56.793

**`cursor.executemany(query, param_list)`**如果您需要原始 SQL，请使用。

```
param_list = [("something_1", 1), ("something_2", 2),...]
# or everything like [(some_number_1, 1)...]. Apostrophes around the substituted
# "%s" and the complete necessary escaping is added automatically for string
# parameters.

cursor.executemany("""UPDATE database.table
        SET field_to_modify=%s
        WHERE primary_key_field=%s""",
        param_list) 
```

它有很多优点：

*   查询字符串比大查询短得多，可以快速分析/优化，而不会消耗数据库规划器不必要的资源。（如果手动将参数解析为 SQL，则会得到许多不同的 SQL 命令，必须单独分析。）
*   手动将字符串解析为 SQL 是一种不好的做法，因为如果您不正确地从用户输入中转义意外的撇号和反斜杠，这可能是一个安全问题（SQL 注入攻击）。

从 Django-0.96 到当前的 1.5-beta 很长时间以来，这两种方法都是一种未记录的方法`execute(self, sql, params=())`，并且所有本地数据库后端（mysql、postgesql_psycopg2、sqlite3、oracle）都支持游标对象。`executemany(self, sql, param_list)`一个有用的类似答案是[https://stackoverflow.com/a/6101536/448474](https://stackoverflow.com/a/6101536/448474)。

executemany 方法在前几年有两个与异常处理相关的固定问题。因此，请验证您的 Django 版本，如果您故意导致数据库异常、过多`%s`或过少等，您会收到有用的错误消息。然而，几分钟的初始修补/测试比等待数小时的慢速方法要快。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-28T16:51:51.683

您是否尝试过交易。

[https://docs.djangoproject.com/en/dev/topics/db/transactions/](https://docs.djangoproject.com/en/dev/topics/db/transactions/)

你需要这样的东西。

```
@transaction.commit_manually
def viewfunc(request):
    for row in rows:
        row.modify() # wherever you want to change
    transaction.commit() 
```

问题不在于 ORM 开销，而在于数据库连接，避免如此多的调用并执行几行的几次提交。

在上面的示例中，您可以将行分成两半、三分之一或十分之一等。

# c++ - 从另一个类访问指针数组的对象

> ID：14035200
> 
> 赞同：1
> 
> 时间：2012-12-26T01:32:07.677
> 
> 标签：c++, arrays, pointers

这是一个更大项目的一部分。

基本上我有一个类“X”来管理程序，该类有一个指向类“Y”对象的指针数组，还有另一个类“Z”我需要访问类“Y”的对象，例如打印。

我收到错误“未在此范围内声明”

我试图让“Z”类成为“Y”类的朋友，但它不起作用。

我写了代码来演示这个问题：

```
#include <iostream>
using namespace std;

class BaseClass;
class OtherClass;
class Manager;

class BaseClass
{
    friend class OtherClass;

    public:
        BaseClass(){}
        void setNum(int num){_num = num;}
        int getNum(){return _num;}

    private:
        int _num;
};

class OtherClass
{
    public:
        OtherClass(){}
        void print(){
        cout << _bc[0]->getNum() << " " << _bc[1]->getNum() << endl;
        }
};

class Manager
{
    friend class OtherClass;
    public:
        Manager(){}

        void run(){
            _bc = new BaseClass*[10];

            _bc[0]->setNum(20);
            _bc[1]->setNum(30);

           _oc.print();
        }

    private:
        BaseClass ** _bc;
        OtherClass _oc;
};

int main()
{
    Manager m;
    m.run();

    return 0;
} 
```

也许这很简单，但是这里已经很晚了，我很困，我想在睡觉前解决这个问题。

编辑：在我的项目中，我有一个类 Manager 并且该类有指向**clients**和**orders**的指针数组。类**订单**除其他外接收**客户端**，这就是为什么我必须访问该指针数组，以选择要在**订单**中插入的**客户端**。

 *** * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-26T01:51:58.233

在 C++ 中有两个不同的概念 -*可访问性*和*范围*。从您的问题来看，您似乎将这两个概念有些混淆（我不怪您，因为它们彼此非常接近）。

可访问性由`private`、等控制`public`，`protected`并且可以通过“友谊”额外授予。另一方面，作用域由被访问的变量和函数的位置控制。

为了让一个类的成员访问另一个类的成员，其他成员必须在范围内；它也必须是可访问的。看来您正试图`_bc`从声明的类`OtherClass`的 a访问。友谊解决了问题的可访问性部分，但没有解决范围部分。为了访问类的*实例*成员，它必须具有对对象的某种引用。获取引用的方法有很多——例如，您可以在 的构造函数中传递对 的*引用*，将其存储在私有变量中，然后通过它进行访问，如下所示：`friend``_bc``OtherClass``_bc`*`Manager``Manager`*`Manager``OtherClass``_bc`**

 **```
class OtherClass {
    Manager &_m;
public:
    OtherClass(Manager &m) : _m(m) {}
    void print(){
        cout << _m._bc[0]->getNum() << " " << _m._bc[1]->getNum() << endl;
    }
}; 
```

这只是解决范围问题的一种方法；`Manager`其他方法包括作为 的参数传递`OtherClass::print`、制作`_m`指针、制作`_bc`静态等。确切的方法取决于您的要求。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-26T01:39:06.360

首先，您似乎不需要指向指针类型的指针`_bc`。只需在 class 中定义一个数组`OtherClass`（或者 an`std::vector`实际上更好）并制作`Manager`a `friend`of `OtherClass`。当然，您可以从和类中删除`friend`声明：`BaseClass``Manager`

```
class OtherClass
{
  public:
    OtherClass(){}
    void print(){
      cout << _bc[0].getNum() << " " << _bc[1].getNum() << endl;
    }   
  private:
    BaseClass * _bc;
  friend class Manager;
};

class Manager
{
  public:
  Manager(){}

  void run(){
    _oc._bc = new BaseClass[10];
    _oc._bc[0].setNum(20);
    _oc._bc[1].setNum(30);

    _oc.print();
  }

  private:
  OtherClass _oc;
}; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-26T01:36:22.193

您的代码即使编译也不会运行，因为您没有正确分配 BaseClass 实例。此外，您对 raw 的使用`new[]`非常令人担忧。考虑使用`std::vector<BaseClass>`or`std::vector<std::unique_ptr<BaseClass>>`代替。

在您的 OtherClass 中，您将不得不采用 Manager 指针或引用并延迟其 print() 成员的定义。编译器完全正确地告诉您在范围内`OtherClass::print`没有调用任何内容。`_bc`您必须显式传递`Manager`实例。****

# java - Riak Java 客户端编译失败

> ID：14035202
> 
> 赞同：0
> 
> 时间：2012-12-26T01:32:21.423
> 
> 标签：java, riak

我正在与 riak 合作。试图从 Java 访问它。这是代码：

```
package eee.xxx;

import com.basho.riak.client.IRiakClient;
import com.basho.riak.client.RiakException;
import com.basho.riak.client.RiakFactory;
import com.basho.riak.client.bucket.Bucket;

public class Main {

    /**
     * @param args
     * @throws RiakException 
     */
    public static void main(String[] args) throws RiakException {
        IRiakClient myClient = RiakFactory.httpClient("127.0.0.1");
        Bucket myBucket = myClient.fetchBucket("Pacan").execute(); 
    }

} 
```

编译后，它会抛出这样的错误：

```
Exception in thread "main" java.lang.NoClassDefFoundError: org/json/JSONException
    at com.basho.riak.client.raw.http.HTTPClientAdapter.<init>(HTTPClientAdapter.java:85)
    at com.basho.riak.client.RiakFactory.httpClient(RiakFactory.java:144)
    at eee.xxx.Main.main(Main.java:18)
Caused by: java.lang.ClassNotFoundException: org.json.JSONException
    at java.net.URLClassLoader$1.run(URLClassLoader.java:366)
    at java.net.URLClassLoader$1.run(URLClassLoader.java:355)
    at java.security.AccessController.doPrivileged(Native Method)
    at java.net.URLClassLoader.findClass(URLClassLoader.java:354)
    at java.lang.ClassLoader.loadClass(ClassLoader.java:423)
    at sun.misc.Launcher$AppClassLoader.loadClass(Launcher.java:308)
    at java.lang.ClassLoader.loadClass(ClassLoader.java:356)
    ... 3 more 
```

我不知道如何解决这个问题。请帮忙！:-)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-26T01:50:11.957

[Riak](http://docs.basho.com/)有许多 3 ^(rd)方库依赖项，其中之一是您似乎缺少的标准 JSON 库。它需要在编译和运行时在类路径上可用。可以在[这里](http://mirrors.ibiblio.org/pub/mirrors/maven2/org/json/json/20080701/json-20080701.jar)找到。

由于大约有 8 个依赖项，因此通过添加依赖项让[Maven为您管理它会更容易：](http://maven.apache.org/)

```
<dependency>
    <groupId>com.basho.riak</groupId>
    <artifactId>riak-client</artifactId>
    <version>1.0.6</version>
</dependency> 
```

# java - 通过 HTML 表单在 Java 中写入 HTTPRequest 对象 - 无需干预 servlet

> ID：14035203
> 
> 赞同：0
> 
> 时间：2012-12-26T01:33:06.603
> 
> 标签：java, html, jsp, request

我希望将从简单的 HTML 表单收集的请求写入 Java 中的 HTTPRequest 对象；最终，我希望重新加载页面以根据用户从表单中所做的选择打印出不同的数据 - 而不依赖于 servlet。JSP 的 Java 代码部分如下所示：

```
if (request.getAttribute("month") == "January") {
    getSomeData;
}
else {
    getSomeOtherData;
} 
```

实际的 HTML 代码如下所示：

```
<form name="month" method="post">
    <select name="monthField"
        <option value="January">January</option>
        <option value="February">February</option>
    </select>
    <input type="submit" value="Submit">
</form>
SHOWSOMEDATA 
```

我省略了 action 字段，它可以很好地重新加载页面，但它似乎没有写入请求；原始代码（不能发布它 - 它是为了工作）有一个更复杂的 if/show 测试，并且页面每次都加载 ("month"==null) 案例，所以它显然没有正确发布。我该怎么做才能正确执行 POST 选项？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-26T01:40:43.757

如果您要提交页面，请使用`monthField`字段名称，因为这是分配给`select`输入框的名称。您还需要使用`equals`方法将字符串比较为：

```
 if ("January".eqauls(request.getParameter("monthField")) { 
```

如果您想要不区分大小写的比较，请使用`equalsIgnoreCase`以下方法：

```
 if ("January".equalsIgnoreCase(request.getParameter("monthField")) { 
```

如果您**在请求中使用属性设置了值 as`month`**，那么

```
 if ("January".eqauls(request.getAttribute("month")) { 
```

或者

```
 if ("January".equalsIgnoreCase(request.getAttribute("month")) { 
```

**请注意：**`NullPointerException`将字符串文字（例如“January”）作为比较的第一个参数比在为空时避免不需要的参数更可取`request.getAttribute("month")`。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-12-26T01:39:17.160

1.  您不能从客户端设置请求属性，只能设置请求参数。

2.  看起来您的参数`monthField`在 HTML 中被调用。

3.  您不能用于`==`比较字符串。

所以也许你想要

```
if ("January".equals(request.getParameter("monthField")) { 
```

# c# - Delegate.CreateDelegate 无法绑定到静态泛型方法

> ID：14035204
> 
> 赞同：4
> 
> 时间：2012-12-26T01:34:05.623
> 
> 标签：c#, generics, reflection, static, delegates

我正在尝试使用`Delegate.CreateDelegate` [[MSDN link]](http://msdn.microsoft.com/en-us/library/1xw3bk13.aspx)绑定到静态泛型方法，但绑定失败。这是 PoC 代码：

```
public static class CreateDelegateTest {
    public static void Main() {
        Action actionMethod = CreateDelegateTest.GetActionDelegate();
        Action<int> intActionMethod = CreateDelegateTest.GetActionDelegate<int>();
        Func<int> intFunctionMethod = CreateDelegateTest.GetFunctionDelegate<int>();
    }

    public static Action GetActionDelegate() {
        return (Action)Delegate.CreateDelegate(typeof(Action), typeof(CreateDelegateTest), "ActionMethod");
    }

    public static Action<T> GetActionDelegate<T>() {
        return (Action<T>)Delegate.CreateDelegate(typeof(Action<T>), typeof(CreateDelegateTest), "GenericActionMethod");
    }

    public static Func<TResult> GetFunctionDelegate<TResult>() {
        return (Func<TResult>)Delegate.CreateDelegate(typeof(Func<TResult>), typeof(CreateDelegateTest), "GenericFunctionMethod");
    }

    public static void ActionMethod() { }

    public static void GenericActionMethod<T>(T arg) { }

    public static TResult GenericFunctionMethod<TResult>() {
        return default(TResult);
    }
} 
```

被`actionMethod`正确创建，但`intActionMethod`和`intFunctionMethod`创建抛出。

**为什么`CreateDelegate`无法绑定到泛型方法？如何绑定它们？**

我已经在 Microsoft Connect [[链接]](https://connect.microsoft.com/VisualStudio/feedback/details/775129/delegate-createdelegate-is-unable-to-bind-to-a-static-generic-function-method)上提交了错误。如果您认为这是一个错误，请为它投票。

**更新 2：**我错误地认为绑定到非函数泛型方法成功。事实证明，任何泛型方法都无法绑定。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-26T02:19:18.983

试试这个（我也无法让你的版本`GetActionDelegate()`工作）：

```
public class CreateDelegateTest
{
    public static Func<TResult> GetFunctionDelegate<TResult>()
    {
        var methodInfo = typeof(CreateDelegateTest).GetMethod("FunctionMethod")
                                                   .MakeGenericMethod(typeof(TResult));
        return (Func<TResult>)Delegate.CreateDelegate(typeof(Func<TResult>), methodInfo);
    }

    public static Action<T> GetActionDelegate<T>()
    {
        var methodInfo = typeof(CreateDelegateTest).GetMethod("ActionMethod")
                                                   .MakeGenericMethod(typeof(T));
        return (Action<T>)Delegate.CreateDelegate(typeof(Action<T>), methodInfo);
    }
} 
```

我不确定为什么`CreateDelegate(Type, Type, string)`重载无法做到这一点，它只是以这种方式实现的。

**更新：**

仍然可以对任何委托类型使用相同的方法。主要思想是为`MakeGenericMethod()`调用找到正确的参数。如何完成的快速示例：

```
public static Delegate CreateDelegate(Type delegateType, Type objectType, string methodName)
{
    var delegateMethod      = delegateType.GetMethod("Invoke");
    var delegateReturn      = delegateMethod.ReturnType;
    var delegateParameters  = delegateMethod.GetParameters();
    var methods             = objectType.GetMethods();
    MethodInfo method = null;
    ParameterInfo[] methodParameters = null;
    Type methodReturn = null;
    // find correct method by argument count
    foreach(var methodInfo in methods)
    {
        if(methodInfo.Name != methodName)
        {
            continue;
        }
        methodParameters = methodInfo.GetParameters();
        methodReturn = methodInfo.ReturnType;
        if(methodParameters.Length != delegateParameters.Length)
        {
            continue;
        }
        method = methodInfo;
    }
    if(method == null)
    {
        throw new Exception("Method not found");
    }
    if(method.IsGenericMethodDefinition)
    {
        var genericArguments    = method.GetGenericArguments();
        var genericParameters   = new Type[genericArguments.Length];

        int genericArgumentIndex = Array.IndexOf(genericArguments, methodReturn);
        if(genericArgumentIndex != -1)
        {
            genericParameters[genericArgumentIndex] = delegateReturn;
        }

        for(int i = 0; i < methodParameters.Length; ++i)
        {
            var methodParameter = methodParameters[i];
            genericArgumentIndex = Array.IndexOf(genericArguments, methodParameter.ParameterType);
            if(genericArgumentIndex == -1) continue;
            genericParameters[genericArgumentIndex] = delegateParameters[i].ParameterType;
        }

        if(Array.IndexOf(genericParameters, null) != -1)
        {
            throw new Exception("Failed to resolve some generic parameters.");
        }

        var concreteMethod = method.MakeGenericMethod(genericParameters);
        return Delegate.CreateDelegate(delegateType, concreteMethod);
    }
    else
    {
        return Delegate.CreateDelegate(delegateType, method);
    }
} 
```

**注意 1：**在这个例子中，我非常简化了重载方法的解析——它只依赖于参数计数。

**注意 2：**仍然可以编写一个不能以这种方式包装在委托中的方法，例如，`int Method<T>(string arg)`（任何不引用参数列表中的泛型参数或作为返回值的方法，无论如何这都是一种不好的做法）。

# javascript - jQuery：查找下一个不是兄弟的元素

> ID：14035206
> 
> 赞同：38
> 
> 时间：2012-12-26T01:35:04.637
> 
> 标签：javascript, jquery

假设我有以下 HTML：

```
<span>
    <span id="x1" class="x">X1</span>
</span>
<span>
    <span>
        <span id="x2" class="x">X2</span>
    </span>
</span> 
```

并且`$(this)`是`<span id="x1" ...>`.

`.x`查找与 jQuery匹配的下一个元素的最佳方法是什么？
实际文档的结构是不可预测的，因此提供的 HTML 只是一个示例。

我不能使用`nextAll`，因为它只能找到兄弟姐妹。
如果我这样做`$('.x')`，它会找到所有，但我将不得不迭代/比较。
有更好的解决方案吗？

另见：http: [//jsfiddle.net/JZ9VW/1/](http://jsfiddle.net/JZ9VW/1/)。

* * *

## 回答 #1

> 赞同：45
> 
> 时间：2012-12-26T01:37:41.633

选择所有具有 class 的元素`x`，计算当前元素的索引，得到索引+1的元素：

```
var $x = $('.x');
var $next = $x.eq($x.index(this) + 1); 
```

这是有效的，因为元素是按文档顺序选择的。您只需`.x`在页面加载时选择所有元素（如果它们不是动态创建的）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-26T03:19:59.060

您可以使用 xpath：

```
document.evaluate('following::*[@class="x"], elt, null, XPathResult.ANY_TYPE, null); 
```

或者你可以使用助行器：

```
var walker = document.createTreeWalker(elt, NodeFilter.SHOW_ELEMENT, function(node) {
    return node.classList.has('x');
});

while (walker.nextNode) {
    do_something_with(walker.currentNode);
} 
```

# scala - scala => 运算符？

> ID：14035209
> 
> 赞同：0
> 
> 时间：2012-12-26T01:35:51.460
> 
> 标签：scala, syntax, operators, pattern-matching

> **可能重复：**
> [=> 和 () => 在 Scala 中是什么意思](https://stackoverflow.com/questions/6951895/what-does-and-mean-in-scala)

在 Scala 中，=> 运算符有什么作用？例如，在下面的 case 语句中：

```
myVar match
{
  case 1 => print(num1 + num2)
} 
```

“操作符”只是写更冗长的东西的简写方式吗？

# html - 带有多个元素的工具提示位置问题

> ID：14035212
> 
> 赞同：0
> 
> 时间：2012-12-26T01:36:50.710
> 
> 标签：html, css

我尝试在我的网站上为图像创建工具提示，但我遇到了以下问题。图片是用*float:left*设置的，每行有 3 张图片，有好几行。工具提示应该位于图像的右侧，并且工作正常，但仅适用于第一行的图像。将鼠标悬停在第二行或第三行的图像上时，工具提示位于顶部第三个图像的工具提示所在的位置。我究竟做错了什么？

![在此处输入图像描述](../Images/20c3364c8120b12aeaff257cdf73f85d.png)

我的CSS代码：

```
.friend_img { opacity:0.6; margin:0; width:83.333333px; float:left; }
.friend_img:hover { opacity:1.0; }

.friend span {display:none; padding:2px 3px; margin-left:8px; width:130px;}
.friend:hover span{display:inline; position:absolute; background:#ffffff;
border:1px solid #cccccc; color:#6c6c6c;} 
```

HTML代码：

```
<a class="friend" href="profile.php?id=32">
   <img class="friend_img" src="member.png">
   <span>FIRST NAME LAST NAME</span>
</a> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-26T02:26:44.603

这是修改后的css：

```
.friend_img {
    opacity:0.6;
    margin:0;
    width:83.333333px;
    float:left;
}
.friend_img:hover {
    opacity:1.0;
}  
span{
    display:none;
}
.friend:hover span{
    display: inline-block;
    z-index:100;
    width:130px;
    top:20;
    left:80px;
    position: absolute;
    background:#ffffff;
    border:1px solid #cccccc; color:#6c6c6c;
}
a.friend {
    position:relative;
    display:inline-block
} 
```

这是html：

```
<div style="width:300px;border:1px solid black; text-align:center" >
    <div>
        <a class="friend" href="profile.php?id=32">    
            <img class="friend_img" src="icon.png">    
            <span>FIRST NAME LAST NAME</span>
        </a>

        <a class="friend" href="profile.php?id=32">    
            <img class="friend_img" src="icon.png">    
            <span>FIRST NAME LAST NAME</span>
        </a>

        <a class="friend" href="profile.php?id=32">    
            <img class="friend_img" src="icon.png">    
            <span>FIRST NAME LAST NAME</span>
        </a>
    </div>

    <div>

        <a class="friend" href="profile.php?id=32">    
            <img class="friend_img" src="icon.png">    
            <span>FIRST NAME LAST NAME</span>
        </a>

        <a class="friend" href="profile.php?id=32">    
            <img class="friend_img" src="icon.png">    
            <span>FIRST NAME LAST NAME</span>
        </a>

        <a class="friend" href="profile.php?id=32">    
            <img class="friend_img" src="icon.png">    
            <span>FIRST NAME LAST NAME</span>
        </a>
    </div>

</div> 
```

我在这里发布了工作示例：http: [//jsfiddle.net/7jZQa/2/](http://jsfiddle.net/7jZQa/2/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-26T01:42:09.717

首先，您需要设置`a.friend`为`position:relative;`

# asp.net - 显示日期并从日期中获取月份时出错

> ID：14035222
> 
> 赞同：1
> 
> 时间：2012-12-26T01:40:42.557
> 
> 标签：asp.net, mysql, date

通过获取我的服务器的日期，并且当我尝试获取日期的月份部分时，它给出了这个错误。

在此之前我使用的是 Windows 7，它运行良好。升级到 Windows 8 后，它给出了这个错误：

我想我发现我的问题是当我尝试这样做时：

```
fncFmtDate("19-12-2012","%d-%b-%Y") 
```

我得到的输出是：

```
19-12?-2012 
```

它应该显示缩写的月份名称（Dec），但它显示月份的整数和后面的问号（12？）。

真诚需要亲帮助。

# iphone - “为通用开发配置您的 iOS 设备”失败

> ID：14035224
> 
> 赞同：0
> 
> 时间：2012-12-26T01:40:53.407
> 
> 标签：iphone, xcode, organizer

我一直在 iPhone 3GS 上开发一段时间，最近拿到 iPhone 4 做一些测试。连接 iPhone 4 后，我按下 Xcode Organizer 中的[“用于开发”](http://developer.apple.com/library/ios/#recipes/xcode_help-devices_organizer/articles/provision_device_for_development-generic.html#//apple_ref/doc/uid/TP40010392-CH1)按钮，但没有 Internet 连接，“用于开发”步骤失败。现在，连接此手机后，“用于开发”按钮不会出现，即使我将手机从管理器中移除，当我重新连接手机时，我仍然无法再次获得“用于开发”按钮。任何人都知道 Mac OS X 上的物理路径，其中包含与开发相关的 iPhone 设置？（即，我可以正确重置这些设置）。

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-26T01:54:40.147

检查您是否在 iPhone 上安装了证书。（它位于 iPhone 上的设置应用程序中）

如果您这样做并且它们是有效的，那么您应该一切就绪。

您是否将 iPhone 的 UDID 添加到您的 ios 开发者帐户？

# vim - 我在哪里可以找到 vim 对语言（例如 Ruby）的理解的定义？

> ID：14035225
> 
> 赞同：2
> 
> 时间：2012-12-26T01:41:01.277
> 
> 标签：vim, syntax

我有兴趣编写自定义语法定义，并且我有一个基础。Vim 在哪里存放语法定义？

我认为有一个文件包含一些正则表达式语句，这些语句与我在语法着色文件中定义的符号相关联，例如`vimCommentString`, `vimCommand`,`vimCmdSep`

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-26T01:58:42.480

Vim 文档非常好。这是一个帮助您入门的选择。

*   开始实际获得语法高亮以执行您想要的操作的最佳起点可能是 Vim 用户手册章节“您自己的语法高亮”，`:help usr_44.txt`.
*   有关它如何确定文件类型和相关内容的一些信息，请参阅`syntax-loading`帮助。
*   对于您需要了解的几乎所有内容，请阅读`filetype`帮助文件。
*   要创建新的文件类型，`new-filetype`.
*   关于从哪里加载文件，`'runtimepath'`.

请注意，语法定义和突出显示是分开的。但是，您可以在命令的帮助下查看*突出显示的定义位置。*`verbose`Where`:hi vimCommentString`将向您*显示* `vimCommentString`突出显示的内容，`:verbose hi vimCommentString`还将显示突出显示的定义*位置。* `vimCommentString`（如果您有一个行为不端的脚本设置了您不想要的选项，也很`:verbose`方便。）`set`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-26T01:43:46.403

搜索文件夹中命名`ruby.vim`的`$VIMRUNTIME`文件。就我而言，这会导致以下文件：

```
/usr/share/vim/vim73/compiler/ruby.vim
/usr/share/vim/vim73/ftplugin/ruby.vim
/usr/share/vim/vim73/indent/ruby.vim
/usr/share/vim/vim73/syntax/ruby.vim 
```

最后一个很可能是您要查找的内容。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-26T01:55:12.920

将您自己的自定义语法定义基于现有的（希望是相似的）是一个好主意；但是，请注意，您也可能会无意中复制错误和旧包袱。Vim 语法高亮功能强大，因此很复杂，但有很好的文档从`:help usr_44.txt`.

# android - 与服务交互的简单方法？

> ID：14035228
> 
> 赞同：6
> 
> 时间：2012-12-26T01:41:51.130
> 
> 标签：android, android-service, android-contentprovider

是否有一些方法可以与内容提供商一样简单的服务进行交互？

我的意思是，例如，对于我们拥有的内容提供商[`getContentResolver()`](http://developer.android.com/reference/android/content/Context.html#getContentResolver())：如果您拥有[`Context`](http://developer.android.com/reference/android/content/Context.html). 您甚至不必担心跨进程调用的细节（[`ContentProvider`](http://developer.android.com/reference/android/content/ContentProvider.html)）。

使用服务，您必须绑定它们，等待建立连接，然后如果您不想泄漏内存，请确保取消绑定它们。更糟糕的是，您必须为远程服务处理[AIDL](http://developer.android.com/guide/components/aidl.html)。

举个例子：

我有一个文件下载器模块。目前有两种方法：内容提供者或服务。要开始每次新下载，两者都很容易：

*   服务：[`startService()`](http://developer.android.com/reference/android/content/Context.html#startService(android.content.Intent))。你只需要一个上下文。
*   内容提供者：`getContentResolver()`并将新下载插入其队列。您还只需要一个上下文。

但是在下载过程中，我想获取一些信息（平均速度、完成百分比……）。问题就在这里：内容提供者更容易沟通。同样，您只需要一个上下文并查询您想要的信息。如果是服务，则需要绑定、解绑，或者构建自己的 AIDL（如果是远程服务）……</p>

我问这个问题是因为在上面的例子中，服务似乎是内容提供者的正确方法，至少因为它的名字。

谢谢，

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-26T02:19:14.113

我建议这样做的两种方法...

首先是尝试使用[ResultReceiver](http://developer.android.com/reference/android/os/ResultReceiver.html)实现`Parcelable`。

基本上创建您自己的类，该类扩展然后`ResultReceiver`调用您从. 然后可以使用将数据发回。如果它是您的内部类，它将能够与其 UI 交互。`putExtra(String name, Parceable value``Intent``startService(Intent intent)``Activity``Service``send(int resultCode, Bundle resultData)``ResultReceiver``ResultReceiver``Activity`

第二种可能性是使用`Notifications`标志`FLAG_ONGOING_EVENT`。这显然不会出现在其`Activity`本身中，但会出现在`Notification`栏中，但您可以`RemoteView`使用每个更新的通知创建带有进度和更新文本等的自定义。这类似于您在 Google Play 在您的设备上安装或更新应用程序时看到的内容。

# c++ - 将数据馈送到插孔时声音失真 - .wav 二进制数据转换为数字信号？

> ID：14035231
> 
> 赞同：-1
> 
> 时间：2012-12-26T01:42:56.823
> 
> 标签：c++, jack

经过一番故障排除后，我意识到（至少我很确定）我一直在通过 JackAudio 库向声音端口提供错误类型的值。

这是当前正在工作但会产生令人难以置信的失真声音的回调函数。

我怀疑我必须将二进制（然后转换为十进制）数据转换为`float`-1 到 1 之间的信号。

我该怎么做后者？

现在我正在给它输入一个 16 位的波形音乐文件。每个样本的大小为`short`。

```
static int Process( jack_nframes_t nframes, void * arg )
    {

        SamplerClass * SamplerPtr = ( SamplerClass * ) arg;

        jack_default_audio_sample_t * LeftChannel, * RightChannel;

        LeftChannel = ( jack_default_audio_sample_t * ) jack_port_get_buffer( LeftChannelOutputPort, nframes );

        RightChannel = ( jack_default_audio_sample_t * ) jack_port_get_buffer( RightChannelOutputPort, nframes );

        for( unsigned int i = 0; i<nframes; i++)
        {
            LeftChannel[i] = SamplerPtr->SoundFile->getSoundDataRef().at( SamplerPtr->SamplePosition ) ;
            RightChannel[i] = SamplerPtr->SoundFile->getSoundDataRef().at( SamplerPtr->SamplePosition + 1;

            SamplerPtr->SamplePosition = SamplerPtr->SamplePosition + 2;
        }

        return 0;
    } 
```

`getSoundDataRef()`返回 a `vector<short>`，我通过`vector::at`.

我正在通过公共 int 变量跟踪样本位置`SamplePtr->SamplePosition`；

这是 16 位 41000Hz 立体声波样本向量内数据格式的调试输出。因此，分配给通道的数据似乎是正确的。

```
[INFO] [ 18:48:50.492] 288756 vec index RCh >1844
[INFO] [ 18:48:50.492] 288757 vec index LCh >1401
[INFO] [ 18:48:50.492] 288758 vec index RCh >-1251 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-26T12:52:07.297

正如在评论讨论中，解决方案是将正确的数据格式传递给 Jackaudio 库 - 在这种情况下，格式是 -1.0 - 1.0 范围内的浮点数，其中原始数据是`short int`，因此使用公式转换每个样本`x = sample / 32767.0;`会给出想要的结果。

# java - JFrame 内容未完全显示

> ID：14035238
> 
> 赞同：0
> 
> 时间：2012-12-26T01:46:15.460
> 
> 标签：java, swing, jframe, awt, mixing

我正在做一个`JFrame`从我的数据库中动态添加的标签。在这种情况下，有时会显示 3 个数据，有时会显示 5 个数据。

该程序确实显示了内容，但它只显示了适合屏幕的数据。这意味着当我向下滚动时，什么都看不到。有谁知道我哪里错了？

```
public class Trip extends JFrame implements ActionListener {
    ConnectionDB database = new ConnectionDB();

    public Trip() throws SQLException
    {
        super("Trip");
        Container c = getContentPane();
        c.setLayout(new BorderLayout());

        Definition a =new Definition();
        int NoOfAS = a.travelTime(User.UserID);

        Panel p = new Panel(new GridLayout(1,2));
        Panel p1 = new Panel(new GridLayout(NoOfAS,1));

        Label title = new Label("Itinerary");
        title.setFont(new Font("Serif", Font.BOLD, 48));
        c.add(title,"North");

        JScrollPane scroll = new JScrollPane(p);
        c.add(scroll,"Center");

        for(int i=0;i<NoOfAS;i++)
        {

            String ASNAME = database.retrieveASNameItinerary(User.UserID,"AS_Name",i+1);

            Label no = new Label("No:"+ (i+1) +" "+ASNAME);
            no.setFont(new Font("Times New Noman",Font.BOLD,20));
            Label descp = new Label(database.retrieveAS_Des(ASNAME,"AS_Description"));
            Label SugTime = new Label("Suggested Time:"+database.retrieveAS_Des(ASNAME,"AS_Time"));
            Label bus = new Label("Bus:"+database.retrieveAS_Des(ASNAME,"AS_Transport"));
            Label fee = new Label("Fees:"+database.retrieveAS_Des(ASNAME,"AS_Price"));
            Label line = new Label("---------------------------------------------------");
            line.setForeground (Color.red);
            Panel p2 = new Panel(new GridLayout(6,1));

            p2.add(no);
            p2.add(descp);
            p2.add(SugTime);
            p2.add(bus);
            p2.add(fee);
            p2.add(line);

            p1.add(p2);
            p.add(p1);
        }     
        // setSize(900,1700);
         pack();
         show();
    }

      public static void main(String args[]) throws SQLException
      {
    StdPlan app = new StdPlan( );
        app.addWindowListener(new WindowAdapter( ){});

      }

    @Override
    public void actionPerformed(ActionEvent e) {
        throw new UnsupportedOperationException("Not supported yet.");
    }

} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-26T04:06:38.977

我最直接的问题是你混合了重量级和重量级的组件（`Label`&`Panel`到 a 上`JScrollPane`）——这很少是一个好主意。

使用`JLabel`and`JPanel`代替。

在你里面你反复`for-next-loop`添加`p1`，`p`这实际上什么也没做，事实上，`p`可能应该使用 a `BorderLayout`seen 因为它只包含一个组件。

我还建议不要直接从 a 扩展`JFrame`，它会严重限制 UI 组件的可重用性。最好使用 a`JPanel`作为基础并将其添加到 a 的实例`JFrame`（或您可能想要使用的任何其他容器）。

通常不鼓励直接实现侦听器接口，因为它往往会暴露您通常不希望人们调用的公共方法。最好使用内部或匿名类 - 恕我直言

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-26T04:15:14.173

问题是您正在混合 awt（重量级）和 swing（轻量级）组件。尝试使用 only`JLabel`等`JPanel`。

只是为了尝试，您可以检查以下代码，它会正确显示，而您的代码仅显示当前视图中的内容：

```
public class Test extends JFrame implements ActionListener {
//ConnectionDB database = new ConnectionDB();

public Test() throws SQLException
{
    super("Trip");
    Container c = getContentPane();
    c.setLayout(new BorderLayout());

   // Definition a =new Definition();
    int NoOfAS = 15;//a.travelTime(User.UserID);

    JPanel p = new JPanel(/*new GridLayout(1,2)*/);
    JPanel p1 = new JPanel(new GridLayout(NoOfAS,1));

    JLabel title = new JLabel("Itinerary");
    title.setFont(new Font("Serif", Font.BOLD, 48));
    c.add(title,BorderLayout.NORTH);

    JScrollPane scroll = new JScrollPane(p);
    c.add(scroll,BorderLayout.CENTER);

    for(int i=0;i<NoOfAS;i++)
    {

        String ASNAME = i + "";//database.retrieveASNameItinerary(User.UserID,"AS_Name",i+1);

        JLabel no = new JLabel("No:"+ (i+1) +" "+ASNAME);
        no.setFont(new Font("Times New Noman",Font.BOLD,20));
        JLabel descp = new JLabel(ASNAME);
        JLabel SugTime = new JLabel(ASNAME);
        JLabel bus = new JLabel(ASNAME);
        JLabel fee = new JLabel(ASNAME);
        JLabel line = new JLabel("---------------------------------------------------");
        line.setForeground (Color.red);
        JPanel p2 = new JPanel(new GridLayout(6,1));

        p2.add(no);
        p2.add(descp);
        p2.add(SugTime);
        p2.add(bus);
        p2.add(fee);
        p2.add(line);

        p1.add(p2);
        p.add(p1);
    }     
    // setSize(900,1700);
     pack();
     show();
}

  public static void main(String args[]) throws SQLException
  {
Test app = new Test( );
    app.addWindowListener(new WindowAdapter( ){});

  }

@Override
public void actionPerformed(ActionEvent e) {
    throw new UnsupportedOperationException("Not supported yet.");
}

} 
```

# java - (x, y) 半径为 1.0 的圆上的点坐标。我需要帮助找到 x2 和 y2

> ID：14035239
> 
> 赞同：2
> 
> 时间：2012-12-26T01:46:26.683
> 
> 标签：java

我的评估是做这个程序，下面列出了说明。

> 1.  圆的半径应为 1.0。
> 2.  在算术表达式中使用适当的 Math 类方法。
> 3.  在初始测试期间，x 坐标的值应更改 0.1。程序运行后，验证增量也可以是 0.01 或 0.001，只需对代码进行少量更改。
> 4.  在格式整齐的表格中显示信息。（请参阅预期输出。）使用格式化网格来节省开发输出布局的时间。背景：从你的代数课中回想一下，如果你知道圆的半径和 x 或 y 的值，勾股定理可用于确定 x 或 y 坐标。假设您正在处理一个半径为 1 的圆。如果您遍历 x 的连续值，则可以计算 y 的相应值。请务必使用 Math 类的方法来设置算术表达式。

这是圈子：http: [//i.stack.imgur.com/NypKz.png](http://i.stack.imgur.com/NypKz.png)

我做了下面的程序。

```
public class PointsOnACircleV1 {
    public static void main(String[ ] args)
    {
   double[] x1 = { 1.0, 0.90, 0.80, 0.70, 0.60, 0.50, 0.40, 0.30, 0.20,
           0.10, 0.00, -0.10, -0.20, -0.30, -0.40, -0.50, -0.60, -0.70,
           -0.80, -0.90, -1.00 };

double r = 1;

    System.out.println("      Points on a Circle of Radius 1.0");
    System.out.println("       x1        y1        x2        y2");
    System.out.println("---------------------------------------------");

for (int i = 0; i < x1.length; i++) {
    double y1 = Math.sqrt(Math.pow(r, 2) - Math.pow(x1[i], 2));
    double y2 = Math.sqrt(Math.pow(r, 2) - Math.pow(x1[i], 2));
    System.out.printf("%10.2f%10.2f%10.2f%10.2f%n", x1[i], y1, x1[i], y2);
}
    System.out.println("");
}
} 
```

输出应该是这样的：http: [//i.stack.imgur.com/pywwJ.png](http://i.stack.imgur.com/pywwJ.png)

我得到了不同的输出。我的输出是这样的。

```
 Points on a Circle of Radius 1.0
       x1        y1        x2        y2
---------------------------------------------
      1.00      0.00      1.00      0.00
      0.90      0.44      0.90      0.44
      0.80      0.60      0.80      0.60
      0.70      0.71      0.70      0.71
      0.60      0.80      0.60      0.80
      0.50      0.87      0.50      0.87
      0.40      0.92      0.40      0.92
      0.30      0.95      0.30      0.95
      0.20      0.98      0.20      0.98
      0.10      0.99      0.10      0.99
      0.00      1.00      0.00      1.00
     -0.10      0.99     -0.10      0.99
     -0.20      0.98     -0.20      0.98
     -0.30      0.95     -0.30      0.95
     -0.40      0.92     -0.40      0.92
     -0.50      0.87     -0.50      0.87
     -0.60      0.80     -0.60      0.80
     -0.70      0.71     -0.70      0.71
     -0.80      0.60     -0.80      0.60
     -0.90      0.44     -0.90      0.44
     -1.00      0.00     -1.00      0.00 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-26T01:52:45.560

您已经计算出 y1 和 y2 是相同的值，因为代码是相同的：

```
double y1 = Math.sqrt(Math.pow(r, 2) - Math.pow(x1[i], 2));
double y2 = Math.sqrt(Math.pow(r, 2) - Math.pow(x1[i], 2)); 
```

从结果看来，y2 的值​​应该只是 y1 的否定。试试这个：

```
double y1 = Math.sqrt(Math.pow(r, 2) - Math.pow(x1[i], 2));
double y2 = -y1; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-10-14T14:03:53.703

它还应该有一个 if 语句，因为只有另一个答案会给出 -0.00 的输出。

```
 double y1 = Math.sqrt(Math.pow(r, 2) - Math.pow(x1[i], 2));
    double y2 = 0.00;
    if (y1 != 0.00)
    {
        y2 = (-y1);
    } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-05-18T14:45:23.877

避免 -0.00 的更好方法是

```
 double y1 = Math.sqrt(Math.pow(r, 2) - Math.pow(x1[i], 2));
    double y2 = 0 - y1; 
```

这将节省空间并更快地运行

# python - 如何将 xsrf cookie 传递给主机？

> ID：14035242
> 
> 赞同：1
> 
> 时间：2012-12-26T01:47:18.847
> 
> 标签：python, curl, python-2.7, tornado

在 Tornado 应用程序中，我为

settings = dict( cookie_secret="11oETzKXQAGaYdkL5gEmGeJJFuYh7EQnp2XdTP1o/", xsrf_cookies=True, autoescape="xhtml_escape", ) （从网络复制，将更改 cookie_secret），我正在尝试使用 curl 从命令行执行

```
curl -d "name=Paola&last_name=James" --header "X-CSRFToken:11oETzKXQAGaYdkL5gEmGeJJFuYh7EQnp2XdTP1o/" http://127.0.0.1:8000/registration 
```

我得到了错误

```
curl: (6) Couldn't resolve host 'X-CSRFToken:11oETzKXQAGaYdkL5gEmGeJJFuYh7EQnp2XdTP1o'
<html><title>403: Forbidden</title><body>403: Forbidden</body></html> 
```

如何将 xsrf 传递给主机？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-26T06:08:40.607

XSRF 必须在 cookie 标头中传递，[格式为数据 OR `X-CSRFToken`/`X-XSRFToken`](https://github.com/facebook/tornado/blob/master/tornado/web.py#L924)：

```
curl -d "name=Paola&last_name=James&_xsrf=11oETzKXQAGaYdkL5gEmGeJJFuYh7EQnp2XdTP1o/" --cookie "_xsrf=11oETzKXQAGaYdkL5gEmGeJJFuYh7EQnp2XdTP1o/; Path=/" http://127.0.0.1:8000/registration 
```

或者

```
curl -d "name=Paola&last_name=James" --cookie "_xsrf=11oETzKXQAGaYdkL5gEmGeJJFuYh7EQnp2XdTP1o/; Path=/" --header "X-CSRFToken: 11oETzKXQAGaYdkL5gEmGeJJFuYh7EQnp2XdTP1o/" http://127.0.0.1:8000/registration 
```

# c#-4.0 - ConcurrentDictionary 和 IDictionary

> ID：14035243
> 
> 赞同：1
> 
> 时间：2012-12-26T01:48:06.840
> 
> 标签：c#-4.0

我注意到 ConcurrentDictionary 实现了 IDictionary 接口，尽管该接口支持 Add，但 ConcurrentDictionary 没有该功能。这是如何运作的？我认为接口强加了实现类的功能......

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-26T01:50:54.057

它使用显式接口实现。这是一个例子。

```
interface IFoo
{
   void Foo();
}

class FooImplementation : IFoo
{
   void IFoo.Foo()
   {
   }
} 
```

如果您分配或强制`ConcurrentDictionary`转换为`IDictionary`，您可以使用那里定义的所有方法。

# xml - 无法在 Google Map V3 中读取 XML 文件

> ID：14035250
> 
> 赞同：1
> 
> 时间：2012-12-26T01:49:56.230
> 
> 标签：xml, jakarta-ee, google-maps-api-3

我是 Google Map api v3 的新手。我正在尝试在 Java EE 中创建一个动态 Web 项目。为此，我想在谷歌地图中显示一些地方（标记）。为此，Java 脚本必须从 XML 文件中读取。我在这里找到了一些例子。 [http://gmaps-samples-v3.googlecode.com/svn/trunk/xmlparsing/](http://gmaps-samples-v3.googlecode.com/svn/trunk/xmlparsing/)

看起来不错，但是当我在计算机中下载文件（downloadurl.html、data.xml）并使用 chrome/firefox 打开它时，地图可见但标记不可见。在我看来，它未能从 XML 文件中读取。

您能否告诉我问题出在哪里以及如何解决？我的文件在这里：[https ://docs.google.com/open?id=0B64N8GK8re42aGd5OUNXeXpIbWM](https://docs.google.com/open?id=0B64N8GK8re42aGd5OUNXeXpIbWM)

谢谢你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-26T20:29:40.870

您还必须下载 util.js 并在网络服务器上运行 downloadurl.html（util.js 使用 XMLHttpRequest 加载 xml，这在本地文件系统上的 chrome/FF 中不起作用）

# r - 将帮助输出保存到文本文件

> ID：14035254
> 
> 赞同：1
> 
> 时间：2012-12-26T01:51:16.127
> 
> 标签：r

如何将帮助输出文件保存到 txt 文件中？

```
write(help(reshape),file="/home/debian/test") 
```

不起作用。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-26T02:18:18.787

从以下内容中挖掘和改编`utils:::print.help_files_with_topic`：

```
file <- help("reshape")
pkgname <- basename(dirname(dirname(file)))
temp <- tools::Rd2txt(utils:::.getHelpFile(file), out = tempfile("Rtxt"), 
                  package = pkgname)
file.copy(temp,"~/test.txt") 
```

# java - Java中方法的重载

> ID：14035256
> 
> 赞同：4
> 
> 时间：2012-12-26T01:51:23.787
> 
> 标签：java, oop, overloading

在下面的代码片段中，有一个名为 的方法的三个版本`show()`。

```
package overloading;

import java.util.ArrayList;
import java.util.List;

public final class Main
{
    private void show(Object object)
    {
        System.out.println("Object");
    }

    private void show(List<Object> list)  //Unused method
    {
        System.out.println("List");
    }

    private void show(Object[] objects)
    {
        System.out.println("Objects");
    }

    private void addToList()
    {
        List<String>list=new ArrayList<String>();
        list.add("String1");
        list.add("String2");
        list.add("String3");
        show(list); // Invokes the first version

        String []s={"111", "222", "333"};
        show(s);   // Invokes the last version
    }

    public static void main(String[] args)
    {
        new Main().addToList();
    }
} 
```

在这个最简单的 Java 代码中，这个方法调用`show(s);`（方法中的最后一行`addToList()`）调用了重载方法的**最后一个版本**。它提供了一个字符串数组 -`String[]`它被类型的接收参数所接受`Object[]`。

然而，这个函数调用`show(list);`试图调用重载方法的**第一个版本**。它传递一个类型字符串列表——`List<String>`它应该被接收参数类型为类型`List<Object>`的中间版本接受。方法的中间版本完全未使用。如果第一个版本被删除，这是一个编译时错误。

为什么这个调用`show(list);` **不**调用这个版本——`private void show(List<Object> list){}`中间那个？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-12-26T02:03:22.863

简而言之，`List<Object>`不是`List<String>`。

要“修复”您的代码，请使用以下代码

```
private void show(List<? extends Object> list)
{
    System.out.println("List");
} 
```

与数组（在 Java 中是协变的）不同，泛型类型的不同实例彼此不兼容，甚至不明确。

使用该声明`Generic<Supertype> superGeneric; Generic<Subtype> subGeneric;` ，编译器将报告强制转换`(Generic<Subtype>)superGeneric`和`(Generic<Supertype>)subGeneric`.

如果用作实际类型参数，则**通配符**可以软化这种不兼容性：是泛型类型的所有实例化的抽象超类型。`?``Generic<?>`

另[见](http://en.wikipedia.org/wiki/Wildcard_%28Java%29)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-12-26T01:52:39.333

`List<Object>`不是`List<String>`java中的超类。您假设的是 Java 在泛型上具有协变，但它没有。

这意味着 if`A`是 的超类`B`,`List<A>`不是 的超类`List<B>`

[无法将泛型转换为扩展的嵌套类型](https://stackoverflow.com/questions/13969435/cannot-convert-generic-to-expanded-nested-type)中遇到了类似的问题，您可以查看那里的任何解决方法是否适合您。

也许改变

```
private void show(List<Object> list) 
```

到

```
private void show(List<? extends Object> list) 
```

会按您的预期工作吗？

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-12-26T01:59:17.187

我会说这是因为参数不同，`List <Object>`因此`List <String>` 当你调用重载方法时，它会默认为第一个只接受一个对象。

这是一个简短的例子：

```
public class Test
{
  public static void overload (Object o)
  {
    System.out.println ("Object");

  }

   public static void overload (List <Object> o)
  {
    System.out.println ("List Object");
  }

   public static void main (String [] args)
   {
     overload (new ArrayList <Object>()); //"List Object"
     overload (new ArrayList <String>()); //"Object"

   }
} 
```

使用泛型参数化列表，一切都应该工作。

# ruby - 调用 Model.create 时覆盖初始化方法的正确方法是什么？

> ID：14035259
> 
> 赞同：0
> 
> 时间：2012-12-26T01:52:13.813
> 
> 标签：ruby, activerecord

`initialize`调用时覆盖方法的正确方法是什么`Model.create`？我试过了：

```
Model < ActiveRecord::Base
  def initialize params, foo 
```

打算这样称呼它：

```
Model.create foo:'bar' 
```

不使用 Rails，而是使用 ActiveRecord。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-26T02:07:16.447

最好远离那条路！

如果您需要不同的行为来创建模型对象，只需创建不同的方法，例如：

```
class Model < ActiveRecord::Base
  def self.create_with_foo params, foo
    model = self.new params
    # Do whatever you want with foo for example
    model.foo = true if foo == :foo
    model.save
    model # return the created model object
  end
end 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-26T02:07:29.940

`foo: 'bar'`是一个单一的参数：一个哈希。它是 的简写`{foo: 'bar'}`，又是 的简写`{:foo => 'bar'}`。所以如果你想这样使用它，你只需要定义它，让它接受一个参数。

# node.js - Node.js 用户名和密码认证

> ID：14035264
> 
> 赞同：2
> 
> 时间：2012-12-26T01:52:50.753
> 
> 标签：node.js, express

我目前正在使用`Node.js`and构建一个网络应用程序`Express.js`。

我正在寻找一种在我的主`app.js`文件中使用用户名和密码进行简单服务器端身份验证的方法，该文件正在侦听以下`post`请求`http://www.domain.com/login`：

**应用程序.js**

```
app.post('/login', function(req, res) {
  // some server-side code for a username and password
} 
```

在客户端，我有一个带有用户名和密码的简单登录表单。此表单将发布到服务器：

**索引.html**

```
<form method="post" action="/login">
<input type="text" id="user" name="user" />
<input type="password" id="pass" name="pass" />
<button type="submit">Login</button>
</form> 
```

我希望在**不**使用任何`ExpressJS`插件的情况下实现这一目标。

**编辑：**所以我的问题是，如何在 ExpressJS 和 NodeJS 中实现简单的用户名和密码认证？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-12-26T10:17:10.647

通过使用 ExpressJS 会话，您可以持有会话 cookie。您需要 cookieParser 和会话存储。但是，如果您不想扩展此 ExpressJS 功能（这是我从您的消息中了解到的），您应该使用令牌或秘密临时字符串管理您自己的会话。

尽管我强烈建议您使用 ExpressJS 会话，但在没有 ExpressJS cookie 的情况下您应该这样做。

*   每次登录时，创建一个唯一令牌并将其存储以供将来查找。
*   在每个请求上，从客户端发送该令牌并在服务器上检查它。如果令牌无效，则重定向到登录

这是登录代码示例：

```
app.post("/login", function(req, res) {
    if(req.body.username && req.body.password) {
        // check username and password
        if(authenticated) {
            // create a token and store it with the current date (if you want it to expire)
            var token = generateAndStoreRandomString(req.body.username);
            res.redirect("http://your.domain/path?token=" + token);
            return;
        }
        // Do something if username or password wrong
    }
    // Do something if no username or password
}); 
```

现在，对于每个请求：

```
app.get("somePath", function(req, res) {
    if(!req.query.token) {
        res.redirect("http://your.domain/login");
        return;
    }
    // Check token in database, if it exists and it hasn't expired
    if(!authenticated) {
        res.redirect("http://your.domain/login");
        return;
    }
    // The user is authenticated. Do the actions required by "somePath"
}); 
```

尝试让一个进程每隔一段时间清理一次过期的令牌，因为它们最终会加起来。如果你想使用 ExpressJS cookieParser 和 session store，有很多文章和例子。如果您遇到问题，请发布另一个问题。

我再重复一遍，尝试使用 ExpressJS 会话。如果你使用http而不是https，这种方法很容易被劫持。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-12-26T03:09:09.123

这很简单。ExpressJS 是一个超小型框架，它构建在 Node.js 和 connect 中的基本 http 服务器之上，它是一个节点模块。

要创建身份验证系统，您将使用会话。首先，您需要调用此行：

```
app.use(express.cookieSession()); 
```

然后，您将能够使用`req.session`来存储和加载会话。

```
app.post('/login', function(req, res) {
    if (req.session.username & req.session.password != null) {
       // Already logged in.
    } else {
       var q = db.query("SELECT * FROM `users` WHERE `username`='" + req.params.username + "' AND `password`='" + req.params.password + "'");

       if (q) {
          // Set the sessions.
          req.session.username = req.params.username;
          req.session.password = req.params.password;
       }
    }
}); 
```

一个基本的例子。您肯定必须清理输入并保护它，但它应该让您开始。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-12-26T12:39:46.143

`Connect`我使用包含的中间件找到了我正在寻找[的答案](http://www.giantflyingsaucer.com/blog/?p=3530)`ExpressJS`，**而**无需使用 cookie 或添加另一个 Node 模块：

```
var express = require('express');

function authorize(username, password) {
    return 'someone' === username & 'password' === password;
}

var app = express.createServer(
    express.basicAuth(authorize)
);

app.get('/', function(request, response) {
    response.send('Authorized!');
});

console.log('Starting server...')
app.listen(8080); 
```

运行应用程序并导航到 后`http://localhost:8080`，它会提示输入用户名和密码。简单的。

# javascript - emberjs.com 上双向绑定的示例代码不起作用

> ID：14035265
> 
> 赞同：0
> 
> 时间：2012-12-26T01:52:52.080
> 
> 标签：javascript, coffeescript, ember.js

我在 emberjs.com [http://emberjs.com/documentation/的“文档”页面上输入了以下代码](http://emberjs.com/documentation/)

但是，它并没有显示出我期望的结果。这是为什么？

```
App.wife = Ember.Object.create({
    householdIncome: 80000
});

App.husband = Ember.Object.create({
    householdIncomeBinding: 'App.wife.householdIncome'
});

console.log(App.husband.get('householdIncome')); //it shows 80000

App.husband.set('householdIncome', 90000);

**console.log(App.wife.get('householdIncome')); // it shows 80000 not 90000**
console.log(App.husband.get('householdIncome')); // this shows 90000 
```

正如 ember.js 上的示例代码所说，当我输入 console.log(App.wife.get('householdIncome')); 时，我期望得到 90000。

有谁知道出了什么问题？请帮帮我。

谢谢！！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-26T03:06:46.067

From that same documentation:

> Note that bindings don't update immediately. Ember waits until all of your application code has finished running before synchronizing changes, so you can change a bound property as many times as you'd like without worrying about the overhead of syncing bindings when values are transient.

You can wrap your console.log statements with [Ember.Run.next](http://emberjs.com/api/classes/Ember.run.html#method_next) to make sure the binding updates are applied before they run.

```
App.husband.set('householdIncome', 90000);

Ember.run.next(function() {
  console.log("her income: " + App.wife.get('householdIncome')); // it shows 90000
  console.log("his income: " + App.husband.get('householdIncome')); // it also shows 90000
});​ 
```

# java - Java：在 Collat z 序列中找到最大的链

> ID：14035267
> 
> 赞同：3
> 
> 时间：2012-12-26T01:54:18.590
> 
> 标签：java, collatz

我找不到 Project Euler 问题 #14 的问题所在。我的第一步是找到算法，该算法一直有效，直到数字达到 120000 左右。代码中断并意识到我需要使用 BigIntegers。我转换了我的算法以适应这种变化，但现在它不起作用。

我添加了 System.out.print(chain_length) 来帮助我解决我的代码可能会中断的地方。

```
public static void main(String[] args) {
    BigInteger target = new BigInteger("1000000");
    BigInteger n = new BigInteger("0");

    final BigInteger zero = new BigInteger("0");
    final BigInteger one = new BigInteger("1");
    final BigInteger two = new BigInteger("2");
    final BigInteger three = new BigInteger("3");
    final BigInteger ten = new BigInteger("10");

    int greatest_index = 0;
    int greatest_length = 0;
    int chain_length = 0;

    BigInteger i = new BigInteger("2");
    for(i.equals(2) ; i.compareTo(target) == -1 ; i = i.add(one)) {
        n = i;
        chain_length = 1;
        while(n.compareTo(one) == -1) {
            chain_length++;
            if(n.mod(ten).equals(zero) == true){//even
                n = n.divide(two);
            }else{//odd
                n = n.multiply(three);
                n = n.add(one);
            }
            if(n.equals(one) == true && chain_length > greatest_length){
                greatest_length = chain_length;
                greatest_index = i.intValue();
            }
        }
        System.out.println(chain_length);
    }
    System.out.println(greatest_index);        
} 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-12-26T01:59:04.403

要测试一个数字是否为偶数，请使用模 2，而不是 10。更改此行：

```
if(n.mod(ten).equals(zero) == true){//even 
```

对此：

```
if(n.mod(two).equals(zero)) { //even 
```

我还删除了不必要的`== true`.

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-26T05:48:39.087

除了@MarkByers 的回答，

```
while(n.compareTo(one) == -1) 
```

应该

```
while(n.compareTo(one) > 0) 
```

或者，在伪代码中，`while n > 1`.

你也应该采取

```
if(n.equals(one) == true && chain_length > greatest_length){
    greatest_length = chain_length;
    greatest_index = i.intValue();
} 
```

在while循环之外，因为在循环内`n`永远不会相等`one`。（并且由于在 while 循环之后`n`将[始终（？）](http://en.wikipedia.org/wiki/Collatz_conjecture)相等`one`，您可以完全摆脱第一个条件。）

最后，`i.equals(2)`在

```
for(i.equals(2) ; i.compareTo(target) == -1 ; i = i.add(one)) 
```

没有做任何有用的事情 - 它只是为大多数值返回 false。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-02-14T20:52:10.690

正如 Daniel Fischer 所指出的，您应该使用 long。小心不要做类似的事情
`long a = 987654321`。
正确的版本（如果你想要长）`long a = 987654321L`：。
简单版：

```
int maxChain = 0;
    int answer = 0;
    for (int i = 1_000_000; i > 0; i--) {
        int chain = 0;
        long n = i;
        while (n != 1) {
            if ((n & 1) != 1) { //Is even
                n = n / 2;
                chain++;
            } else { //Is odd
                n = 3 * n + 1;
                chain++;
            }
        }
        if (chain > maxChain) {
            maxChain = chain;
            answer = i;
        }
    }
    System.out.println(answer);
    System.out.println(maxChain); 
```

# objective-c - 不兼容的块指针类型将“void (^)(bool)”发送到“void(^)()”类型的参数

> ID：14035271
> 
> 赞同：2
> 
> 时间：2012-12-26T01:55:10.177
> 
> 标签：objective-c, objective-c-blocks

我正在努力解决我正在制作的回调函数的这个问题。这是我定义全局块的方式：

```
#import <Foundation/Foundation.h>
#import "cocos2d.h"

typedef void (^RestartBlock)(bool);
RestartBlock block = ^(bool restart)
{
    if (restart) {
        // restart
    }
    else
    {
        // continue
    }
};

@interface RestartDialogLayer : CCLayer
{
    RestartBlock m_block;
    bool    m_bRestart;
}

-(id) initWithBlock:(RestartBlock)block;
-(void) restartButtonPressed:(id)sender;
-(void) resumeButtonPressed:(id)sender;

@end 
```

RestartDialogLayer的实现：

```
#import "RestartDialogLayer.h"

@implementation RestartDialogLayer

-(id) initWithBlock:(RestartBlock)block
{
    if ((self = [super init]))
    {
        m_bRestart = YES;
        m_block = block;
    }
    return self;
}

-(void) restartButtonPressed:(id)sender
{
    m_bRestart = YES;
    m_block(m_bRestart);
    [self removeFromParentAndCleanup:YES];
}

-(void) resumeButtonPressed:(id)sender
{
    m_bRestart = NO;
    m_block(m_bRestart);
    [self removeFromParentAndCleanup:YES];
}

-(void) dealloc
{
    [super dealloc];
}

@end 
```

我在另一个类的方法中使用该块，如下所示：

```
-(void) singlePlayerSceneSchedule:(ccTime) delta
{
    CCLOG(@"demoSceneSchedule MainMenuScene");
    [self unschedule:_cmd];

    bool gameLeftActive = [Globals sharedGlobals].gameLeftActive;

    if (gameLeftActive)
    {
        RestartDialogLayer* dialog = [[RestartDialogLayer node] initWithBlock:block];
    }
    else
    {
        // Start a new game
    }
} 
```

任何帮助表示赞赏。

谢谢，

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-26T23:24:03.887

最后，我弄清楚了问题所在！

来自 Cocos2D 库的另一个文件中的全局定义与我的类的 initWithBlock 方法发生冲突！

我只是重命名了我的 init 方法并解决了问题，但浪费了我一天的时间:-(

```
/** initialized the action with the specified block, to be used as a callback.
 The block will be "copied".
 */
-(id) initWithBlock:(void(^)())block; 
```

谢谢你的帮助...

# mysql - Mysql 查询从行中删除不需要的字母

> ID：14035277
> 
> 赞同：0
> 
> 时间：2012-12-26T01:56:46.277
> 
> 标签：mysql, sql, phpmyadmin

我有一个 mysql 表，其中一个名为“city”的列如下所示：

```
 id      city

 1       New Jersey(Trenton)

 2       New Jersey(Burlington)

 3       New Jersey(Cherry Hill)

 4       New York(Manhattan)

 5       Philadalphia(BalaCynwd) 
```

那么我可以在 phpmyadmin 中输入什么查询，以便删除括号中的名称？所以我正在寻找一个我只得到城市而不是括号的结果。所以它将是新泽西、纽约和费城。我有 300 万行，所以我不能手动完成。

那么我可以像下面这样吗？：

如果 'city' = '%New Jersey%' 然后设置 'city' = 'New Jersey'; ? 但这即使它有效......我将不得不对所有城市执行大量查询......

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-26T02:05:54.357

尝试这个：

```
UPDATE table SET city=SUBSTRING_INDEX(city, '(', 1) 
```

有关详细信息，请参阅[http://dev.mysql.com/doc/refman/5.0/en/string-functions.html#function_substring-index](http://dev.mysql.com/doc/refman/5.0/en/string-functions.html#function_substring-index)。

# macos - 在 Mac OSX 上的 Qt Creator 中使用 SDL

> ID：14035279
> 
> 赞同：1
> 
> 时间：2012-12-26T01:56:55.980
> 
> 标签：macos, qt, sdl, qt-creator, porting

我和我的朋友正在将我们的软件移植到 Mac OSX。该应用程序大量构建在 SDL 之上，我们很难在 Qt5 中链接和编译 SDL。我们没有在我们的代码中使用 Qt 的任何部分，而是使用 IDE 来简化跨平台。

目前，我里面有 SDL 框架`/Library/Frameworks/`

在 application.pro 里面我有：

```
TEMPLATE = app
CONFIG += console
CONFIG -= app_bundle
CONFIG -= qt

SOURCES += main.cpp

macx {
   INCLUDEPATH += "/Library/Frameworks/SDL.framework/headers/"
} 
```

在`main.cpp`我显然有`#include "SDL.h"`并且如果我 ctrl 单击`SDL.h`它表明它正在链接到框架......

当我去构建/编译我得到这个错误：

```
14:21:24: Running steps for project BDGame...
14:21:24: Configuration unchanged, skipping qmake step.
14:21:24: Starting: "/usr/bin/make" -w
make: Entering directory `/Users/Kite/Dropbox/Wizardry Games/BDGame/BDGame-build-Desktop_Qt_5_0_0_clang_64bit_SDK-Release'
g++ -headerpad_max_install_names -mmacosx-version-min=10.6 -o BDGame main.o    
Undefined symbols for architecture x86_64:
  "_main", referenced from:
      start in crt1.10.6.o
     (maybe you meant: _SDL_main)
ld: symbol(s) not found for architecture x86_64
collect2: ld returned 1 exit status
make: *** [BDGame] Error 1
make: Leaving directory `/Users/Kite/Dropbox/Wizardry Games/BDGame/BDGame-build-Desktop_Qt_5_0_0_clang_64bit_SDK-Release'
14:21:24: The process "/usr/bin/make" exited with code 2.
Error while building/deploying project BDGame (kit: Desktop Qt 5.0.0 clang 64bit (SDK))
When executing step 'Make' 
```

![在此处输入图像描述](../Images/f7433bdcb30588f06952975c60b8ebd3.png)

我做错了什么阻止 Qt 使用 SDL？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-26T22:53:18.240

在您的`main.cpp`文件中，您必须声明`int SDL_main(int, char**)`function 而不是`main()`. 您还需要获取`SDLMain.h`与`SDLMain.m`OS X 的 SDL 捆绑包一起分发的文件。这两个是引导您的 Cocoa 应用程序所必需的，该应用程序将进一步调用该`SDL_main`函数。

我想您使用 Qt 项目 (*.pro) 文件。你应该有这样的东西：

**qtsdl.pro**

```
QT -= 核心 gui

目标 = qtsdl
配置 += 控制台
配置 -= app_bundle

模板 = 应用程序

INCLUDEPATH += /Library/Frameworks/SDL.framework/Headers
LIBS += -framework Cocoa -framework SDL

来源 += \
    主文件

OBJECTIVE_SOURCES += \
    SDLMain.m

标题 += \
    SDLMain.h

```

**主文件**

```
#include <SDL.h>

int SDL_main(int argc, char *argv[])
{
    (void)argc;
    (void)argv;

    SDL_Surface *screen;

    if (SDL_Init(SDL_INIT_VIDEO) < 0)
        return 1;

    screen = SDL_SetVideoMode(640, 480, 32, SDL_OPENGL | SDL_HWSURFACE);
    if (!screen) {
        SDL_Quit();
        return 1;
    }

    SDL_Event event;
    bool running = true;

    while (running) {
        while (SDL_PollEvent(&event)) {
            switch (event.type) {
            case SDL_QUIT:
                running = false;
                break;
            case SDL_KEYDOWN:
                running = false;
                break;
            default:
                break;
            }
        }
    }

    SDL_Quit();
    return 0;
} 
```

**SDLMain.h**和**SDLMain.m**从 SDL 框架分发中获取它们。

# c++ - MS Visual Studio 2008 上的 stdlib.h 的 random()

> ID：14035282
> 
> 赞同：0
> 
> 时间：2012-12-26T01:57:10.270
> 
> 标签：c++, visual-studio, random, gnu

我需要在 GNU 的 c 库中使用 stdlib.h 中的函数 random()，但我在 Windows 上使用 Visual Studio 2008（我没有任何选项。是的，我也讨厌 VS，并且有更好的 RNG在那里）。当 MS 的 stdlib.h 不包含它时，有没有办法使用 GNU random() 函数？

我应该补充一点，我在 MS VS 和 C++ 方面的经验总体上是相当有限的，因为我学习了大部分 Java 编程。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-26T02:08:41.720

[从这里](http://sourceware.org/git/?p=glibc.git)获取源代码，然后分解 stdlib/random_r.c （`random()`调用`random_r()`所以你不需要`random.c`）和相关的头文件（stdlib.h） - 你可能必须从部分制作自己的头文件stdlib，也许还有其他人。

这是一个“补丁”，它可以在没有任何标准库头文件的情况下编译：

```
--- myrandom.c  2012-12-26 12:25:17.439514392 +0000
+++ ../glibc/stdlib/random_r.c  2012-12-26 12:29:16.581770976 +0000
@@ -51,14 +51,10 @@
  * Rewritten to be reentrant by Ulrich Drepper, 1995
  */

-#if 1
-#include "myrandom.h"
-#else
 #include <errno.h>
 #include <limits.h>
 #include <stddef.h>
 #include <stdlib.h>
-#endif

 /* An improved random number generation package.  In addition to the standard
@@ -161,7 +157,10 @@
    information a given number of times to get rid of any initial dependencies
    introduced by the L.C.R.N.G.  Note that the initialization of randtbl[]
    for default usage relies on values produced by this routine.  */
-int srandom_r (unsigned int seed, struct random_data *buf)
+int
+__srandom_r (seed, buf)
+     unsigned int seed;
+     struct random_data *buf;
 {
   int type;
   int32_t *state;
@@ -206,7 +205,7 @@
   while (--kc >= 0)
     {
       int32_t discard;
-      (void) random_r (buf, &discard);
+      (void) __random_r (buf, &discard);
     }

  done:
@@ -216,6 +215,7 @@
   return -1;
 }

+weak_alias (__srandom_r, srandom_r)

 /* Initialize the state information in the given array of N bytes for
    future random number generation.  Based on the number of bytes we
@@ -228,10 +228,12 @@
    Note: The first thing we do is save the current state, if any, just like
    setstate so that it doesn't matter when initstate is called.
    Returns 0 on success, non-zero on failure.  */
-int initstate_r (unsigned int seed, 
-        char *arg_state, 
-        size_t n, 
-        struct random_data *buf)
+int
+__initstate_r (seed, arg_state, n, buf)
+     unsigned int seed;
+     char *arg_state;
+     size_t n;
+     struct random_data *buf;
 {
   if (buf == NULL)
     goto fail;
@@ -271,7 +273,7 @@

   buf->state = state;

-  srandom_r (seed, buf);
+  __srandom_r (seed, buf);

   state[-1] = TYPE_0;
   if (type != TYPE_0)
@@ -284,6 +286,7 @@
   return -1;
 }

+weak_alias (__initstate_r, initstate_r)

 /* Restore the state from the given state array.
    Note: It is important that we also remember the locations of the pointers
@@ -293,7 +296,10 @@
    to the order in which things are done, it is OK to call setstate with the
    same state as the current state
    Returns 0 on success, non-zero on failure.  */
-int setstate_r (char *arg_state, struct random_data *buf)
+int
+__setstate_r (arg_state, buf)
+     char *arg_state;
+     struct random_data *buf;
 {
   int32_t *new_state = 1 + (int32_t *) arg_state;
   int type;
@@ -337,6 +343,7 @@
   return -1;
 }

+weak_alias (__setstate_r, setstate_r)

 /* If we are using the trivial TYPE_0 R.N.G., just do the old linear
    congruential bit.  Otherwise, we do our fancy trinomial stuff, which is the
@@ -349,7 +356,10 @@
    rear pointers can't wrap on the same call by not testing the rear
    pointer if the front one has wrapped.  Returns a 31-bit random number.  */

-int random_r (struct random_data *buf, int32_t *result)
+int
+__random_r (buf, result)
+     struct random_data *buf;
+     int32_t *result;
 {
   int32_t *state;

@@ -397,24 +407,4 @@
   return -1;
 }

-
-// Additional code to show that "it works" ... 
-static struct random_data rbuf;
-char state_array[12345];
-
-void init_myrandom(void)
-{
-    initstate_r(4711, state_array, sizeof(state_array), &rbuf);
-}
-
-int myrandom(void)
-{
-    int rc;
-    int32_t res;
-    if ((rc = random_r (&rbuf, &res)) > 0)
-    {
-   return -errno;
-    }
-    return res;
-}
-
+weak_alias (__random_r, random_r)
[MatsP@linuxhost random]$ diff -u ../glibc/stdlib/random_r.c  myrandom.c 
--- ../glibc/stdlib/random_r.c  2012-12-26 12:29:16.581770976 +0000
+++ myrandom.c  2012-12-26 12:25:17.439514392 +0000
@@ -51,10 +51,14 @@
  * Rewritten to be reentrant by Ulrich Drepper, 1995
  */

+#if 1
+#include "myrandom.h"
+#else
 #include <errno.h>
 #include <limits.h>
 #include <stddef.h>
 #include <stdlib.h>
+#endif

 /* An improved random number generation package.  In addition to the standard
@@ -157,10 +161,7 @@
    information a given number of times to get rid of any initial dependencies
    introduced by the L.C.R.N.G.  Note that the initialization of randtbl[]
    for default usage relies on values produced by this routine.  */
-int
-__srandom_r (seed, buf)
-     unsigned int seed;
-     struct random_data *buf;
+int srandom_r (unsigned int seed, struct random_data *buf)
 {
   int type;
   int32_t *state;
@@ -205,7 +206,7 @@
   while (--kc >= 0)
     {
       int32_t discard;
-      (void) __random_r (buf, &discard);
+      (void) random_r (buf, &discard);
     }

  done:
@@ -215,7 +216,6 @@
   return -1;
 }

-weak_alias (__srandom_r, srandom_r)

 /* Initialize the state information in the given array of N bytes for
    future random number generation.  Based on the number of bytes we
@@ -228,12 +228,10 @@
    Note: The first thing we do is save the current state, if any, just like
    setstate so that it doesn't matter when initstate is called.
    Returns 0 on success, non-zero on failure.  */
-int
-__initstate_r (seed, arg_state, n, buf)
-     unsigned int seed;
-     char *arg_state;
-     size_t n;
-     struct random_data *buf;
+int initstate_r (unsigned int seed, 
+        char *arg_state, 
+        size_t n, 
+        struct random_data *buf)
 {
   if (buf == NULL)
     goto fail;
@@ -273,7 +271,7 @@

   buf->state = state;

-  __srandom_r (seed, buf);
+  srandom_r (seed, buf);

   state[-1] = TYPE_0;
   if (type != TYPE_0)
@@ -286,7 +284,6 @@
   return -1;
 }

-weak_alias (__initstate_r, initstate_r)

 /* Restore the state from the given state array.
    Note: It is important that we also remember the locations of the pointers
@@ -296,10 +293,7 @@
    to the order in which things are done, it is OK to call setstate with the
    same state as the current state
    Returns 0 on success, non-zero on failure.  */
-int
-__setstate_r (arg_state, buf)
-     char *arg_state;
-     struct random_data *buf;
+int setstate_r (char *arg_state, struct random_data *buf)
 {
   int32_t *new_state = 1 + (int32_t *) arg_state;
   int type;
@@ -343,7 +337,6 @@
   return -1;
 }

-weak_alias (__setstate_r, setstate_r)

 /* If we are using the trivial TYPE_0 R.N.G., just do the old linear
    congruential bit.  Otherwise, we do our fancy trinomial stuff, which is the
@@ -356,10 +349,7 @@
    rear pointers can't wrap on the same call by not testing the rear
    pointer if the front one has wrapped.  Returns a 31-bit random number.  */

-int
-__random_r (buf, result)
-     struct random_data *buf;
-     int32_t *result;
+int random_r (struct random_data *buf, int32_t *result)
 {
   int32_t *state;

@@ -407,4 +397,24 @@
   return -1;
 }

-weak_alias (__random_r, random_r)
+
+// Additional code to show that "it works" ... 
+static struct random_data rbuf;
+char state_array[12345];
+
+void init_myrandom(void)
+{
+    initstate_r(4711, state_array, sizeof(state_array), &rbuf);
+}
+
+int myrandom(void)
+{
+    int rc;
+    int32_t res;
+    if ((rc = random_r (&rbuf, &res)) > 0)
+    {
+   return -errno;
+    }
+    return res;
+}
+ 
```

* * *

随机数.h：

```
#ifndef MYRANDOM_H
#define MYRANDOM_H

#define NULL 0

#define EINVAL 23

typedef int int32_t;
typedef unsigned long size_t;

struct random_data
{
    int32_t *fptr;      /* Front pointer.  */
    int32_t *rptr;      /* Rear pointer.  */
    int32_t *state;     /* Array of state values.  */
    int rand_type;      /* Type of random number generator.  */
    int rand_deg;       /* Degree of random number generator.  */
    int rand_sep;       /* Distance between front and rear.  */
    int32_t *end_ptr;       /* Pointer behind state table.  */
};

#define errno my_errno
extern int my_errno;

static inline void __set_errno(int err) { my_errno = err; };

int random_r (struct random_data *buf, int32_t *result);

int myrandom(void);
void init_myrandom();

#endif 
```

* * *

```
#include <stdio.h>
#include "myrandom.h"

int my_errno;

int main()
{
    int i;
    init_myrandom();
    for(i = 0; i < 100; i++)
    {
    printf("%d\n", myrandom());
    }
    return 0;
} 
```

我不保证这将在 Windows 系统上运行，但我会这么认为。除非有一些我没有发现的“gcc-isms”。

我或许还应该指出，标准随机中设置的状态是在[random.c](http://sourceware.org/git/?p=glibc.git;a=blob;f=stdlib/random.c;h=ff6bdd2b5d5a8f7633a914282f4c6ab1991df0cf;hb=2c8bfe7d6f22c4a599894846bf1715d93b295f53)的第 137 行左右完成的——要获得与在 gcc 编译的系统中运行 random() 相同的值，你需要复制它。我没有这样做，而是在“init_myrandom”中组成了我自己的一组变量[可能不是最佳的]。

# php - 使用 htmlentities 时允许使用撇号

> ID：14035287
> 
> 赞同：-1
> 
> 时间：2012-12-26T01:57:55.410
> 
> 标签：php, mysql

我有这个：

```
<?php

if( !empty($_SESSION['descr']) )
{
    $descr = htmlentities($_SESSION['descr'], ENT_QUOTES | ENT_IGNORE,'utf-8' );
    $descr = stripslashes($descr);
    echo "<textarea cols=\"50\" rows=\"10\" name=\"descr\" >".$descr."</textarea>";
}
else
{
    echo "<textarea cols=\"50\" rows=\"10\" name=\"descr\" ></textarea>"; 
}       
?> 
```

使用 ---ENT_IGNORE-- 工作但不安全我读过

问题是，如果用户输入撇号，则会出现错误：

> 您的 SQL 语法有错误；检查与您的 MySQL 服务器版本相对应的手册，以获取在 '" 附近使用的正确语法

它可以使用`mysql_real_escape_string()`，但我想使用`htmlentities()`.

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-26T02:16:41.273

你为什么不使用在提交到 mysql 之前将引用的 html 形式`str_replace();`更改为它的 html 形式？或者使用[PDO](http://wiki.hashphp.org/PDO_Tutorial_for_MySQL_Developers)而不是一起担心它？？？`'``&#39;`

或者，也许您应该在 SE 中查看 [此](https://stackoverflow.com/questions/4114308/htmlentities-with-exceptions)链接，该链接是关于使用 /for 进行例外处理的`htmlentities();`？

# ios - 是否可以只显示 CALayer ios 的一部分？

> ID：14035289
> 
> 赞同：0
> 
> 时间：2012-12-26T01:58:37.957
> 
> 标签：ios, calayer, layer, quartz-2d, avcapturesession

一般来说，

例如，您能否在 iPhone4 中有一个框架为 (0,0,320,460) 的 CALayer。然后决定只显示该层的中间矩形部分 (150,220,20,20)。

这里的想法是获取某个图层，然后隐藏除中间矩形之外的所有内容。我尝试过使用框架和边界，但没有运气。我还查看了 CALayer 方法，看看是否有类似于 UIScrollView contentOffset 的方法。但没有运气。

为了使这更实用，请使用 AVCaptureVideoPreviewLayer，然后不显示整个图层，而只显示一个中间矩形 - 要清楚，这个中间矩形不会显示谁图层，而是该预览图层的特定中间矩形。

嗬嗬嗬，节日快乐。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-26T03:59:05.393

使用 CAShapeLayer 作为要剪辑的图层的蒙版。CAShapeLayer 有一个采用 CGPathRef 的路径属性。

# ruby-on-rails - 在运行测试之前，`rake test` 做了什么，为什么要花这么长时间？

> ID：14035299
> 
> 赞同：2
> 
> 时间：2012-12-26T01:59:57.373
> 
> 标签：ruby-on-rails, unit-testing, testunit

我有一个使用默认 rails test:unit 进行大约 40 次测试的 rails 应用程序。测试本身运行得很快，但有大约 8 秒的延迟，`rake test`似乎在后台做某事，然后运行测试。

我正在使用 linux 运行测试。

`rake test`在调用之后但在测试运行之前的这段时间内发生了什么？有没有办法减少或消除这个等待时间？

这是一个[筛选视频](http://screenr.com/B4C7)来阐明这个问题。有问题的时间是 0:04 - 0:11。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-26T02:43:58.400

我认为它正在加载 rails 环境（运行初始化程序，加载模型和控制器等）。我发现这非常慢，尤其是在 Windows 机器上，尤其是在 jRuby（它也必须启动 JVM）上。

有*一些*方法可以加速 jRuby，在[此处](https://github.com/jruby/jruby/wiki/PerformanceTuning)列出，但与 OSX 或 linux 相比，Windows 上的 ruby​​ 似乎仍然非常慢。

编辑：刚刚看到你的视频。您等待的时间不到 10 秒。与我在 Windows 机器上的 20 多秒相比，这还不错。

# javascript - UnicodeDecodeError: 'ascii' codec ...尝试为 JavaScript 编码结构时

> ID：14035301
> 
> 赞同：1
> 
> 时间：2012-12-26T02:00:18.203
> 
> 标签：javascript, python, python-2.7, python-unicode

我正在尝试从 python 结构中创建一个 unicode 字符串。我不想使用 python 的默认字符串转换方法，因为我希望这个 unicode 字符串具有特定的结构，以便我可以在 javascript 客户端中使用它。我在行得到 UnicodeDecodeError

```
dlist_str += unicode(item[key]) 
```

我试过了

```
# -*- encoding: utf-8 -*- 
```

在文件的顶部。我也试过问题线

```
dlist_str += item[key] 
```

希望 str 类型会自动转换为 unicode。我究竟做错了什么？

这是代码片段：

* * *

```
def convertToString(dlist):
  dlist_str = u'{ '
  for item in dlist:
    dlist_str += item['field_id'] + u': { '
    for key in item:
      dlist_str +=  key + u': '
      dt = str(type(item[key]))
      if dt == "<type 'str'>" or dt == "<type 'unicode'>":
        dlist_str += u"'"
        dlist_str += unicode(item[key])
        dlist_str += u"'"
      elif dt == "<type 'list'>":
        dlist_str += u"["
        for dn in item[key]:
          dlist_str += u"'" + dn + u"',"
        dlist_str += u"]"
      else:
        dlist_str += unicode(item[key])
      dlist_str += u','
    dlist_str += u'},'
  dlist_str += u'}'
  return dlist_str 
```

* * *

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-26T02:13:43.613

看起来您正在尝试同时做两件事：将列表转换为字典，然后对其进行 JSON 编码。

如果将这两个步骤分开，您应该可以使用[Python 标准库中的 JSON 编码器](http://docs.python.org/2/library/json.html)：

```
import json

def convertToString(dlist):
    temp_dict = dict((item['field_id'], item) for item in dlist)
    return json.dumps(temp_dict)
    # or, even shorter, and in Python 2.7/3.2+
    # return json.dumps({item['field_id']: item for item in dlist}) 
```

另外，您在版本中看到错误的原因是您需要明确选择“来自”编码，而不是让 Python 猜测。就像是：

```
dlist_str += item[key].decode('utf-8') 
```

可能会工作。

# iphone - iPhone 4S 与 iPhone 3GS 中的 UILabel

> ID：14035305
> 
> 赞同：0
> 
> 时间：2012-12-26T02:01:57.710
> 
> 标签：iphone, storyboard, uilabel, iphone-4, iphone-3gs

我一直在模拟器和 iPhone 3GS 上测试我的应用程序，并且大部分问题都解决了（我认为！）。我最近在 iPhone 4S 上试用了它，但`UILabel`. 这些是通用`UILabel`的，在所有情况下都使用 System 17 字体。我使用情节提要插入`UILabel`. 我在 iPhone 4 上运行 iOS6，在 iPhone 3 上运行 iOS6.0.1。在 iPhone 4 上，文本被截断，并添加了“...”。有谁知道为什么？以及如何解决这个问题？

这是它在模拟器上的样子（在 iPhone 3 上看起来一样）：（ [来源：][[WhatDidILike.com](http://www.WhatDidILike.com/testing/TextSimulator.jpg)][）] 。[![](../Images/2b74de01008e7bdcd7742846e59e8632.png)](https://i.stack.imgur.com/gVwK7.jpg)

这是它在 iPhone 4 上的样子：（[来源：][[WhatDidILike.com](http://www.WhatDidILike.com/testing/TextiPhone4.png)][）] 。[![](../Images/05d98c2b069aba22cd869942ae406489.png)](https://i.stack.imgur.com/Kgylu.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-26T02:05:36.490

我想知道这是否是与您对抗的新 AutoLayout 功能？

无论如何，让你的 UILabel在你的故事板中*更宽*，和/或为 UILabel 属性检查器中的文本添加一个“最小字体大小”自动收缩属性（看起来像这样）：

![最小字体大小](../Images/555b0d5c7d8406747c5ddd13f4b91c70.png)

似乎是iOS 6的新事物......

# ios - 需要生成的 JSON 文档与在 iOS 中的 NSMutableDictionary 中插入的对象的顺序相同

> ID：14035306
> 
> 赞同：3
> 
> 时间：2012-12-26T02:02:08.723
> 
> 标签：ios, json, nsmutabledictionary, fast-enumeration

我正在从一个 NSMutableDictionary 生成一个 JSON 文档，该文档由指向 NSStrings 的键以及依次指向其他 NSMutableDictionary 的两个键组成。我的问题是，当我输出 JSON 文档时，我注意到 JSON 文档具有我以不同顺序插入到 NSMutableDictionary 中的对象。例如，我目前的输出如下所示：

```
JSON Output: {
  "devicetype" : "iPhone Simulator",
  "os" : "6.0",
  "test_results" : [
    {
      "date" : "2012-12-25T20:38:09",
      "name" : "Test 1",
      "result" : "Fail"
    },
    {
      "date" : "2012-12-25T20:38:11",
      "name" : "Test 2",
      "result" : "Pass"
    },
    {
      "date" : "2012-12-25T20:38:13",
      "name" : "Test 3",
      "result" : "Pass"
    },
    {
      "date" : "2012-12-25T20:38:19",
      "name" : "Test 4",
      "result" : "Fail"
    }
  ],
  "devicename" : "?????",
  "reports" : [

  ],
  "device_id" : "bb88413b178b4ef77830d385b9a4bd6d",
  "platform" : "iPhone OS"
} 
```

但我希望输出看起来像这样：

```
JSON Output: {
  "devicetype" : "iPhone Simulator",
  "os" : "6.0",
  "devicename" : "?????",
  "device_id" : "bb88413b178b4ef77830d385b9a4bd6d",
  "platform" : "iPhone OS"

  "test_results" : [
    {
      "date" : "2012-12-25T20:38:09",
      "name" : "Test 1",
      "result" : "Fail"
    },
    {
      "date" : "2012-12-25T20:38:11",
      "name" : "Test 2",
      "result" : "Pass"
    },
    {
      "date" : "2012-12-25T20:38:13",
      "name" : "Test 3",
      "result" : "Pass"
    },
    {
      "date" : "2012-12-25T20:38:19",
      "name" : "Test 4",
      "result" : "Fail"
    }
  ],

  "reports" : [

  ],
} 
```

我拥有的用于创建 JSON 文档的代码如下所示：

```
NSMutableArray* reports = [NSMutableArray array];    
NSMutableArray* results = [NSMutableArray array];

for (TestResult *testObject in testResultArray) {

        if ([[DataModel sharedInstance] getScore:testObject.score] == @"Not Tested") {

            NSMutableDictionary *naTest = [NSMutableDictionary dictionary];
            [naTest setObject:testObject.testName forKey:@"name"];
            [naTest setObject:testObject.dateStamp forKey:@"date"];

            [reports addObject:naTest];

        }

        else {

            NSMutableDictionary *fullTest = [NSMutableDictionary dictionary];
            NSString *score = [[DataModel sharedInstance] getScore:testObject.score];
            [fullTest setObject:score forKey:@"result"];
            [fullTest setObject:testObject.testName forKey:@"name"];
            [fullTest setObject:testObject.dateStamp forKey:@"date"];

            [results addObject:fullTest];

        }

    }

    NSMutableDictionary *mainDoc = [NSMutableDictionary dictionary];
    [mainDoc setObject:udid forKey:@"device_id"];
    [mainDoc setObject:systemName forKey:@"platform"];
    [mainDoc setObject:systemVersion forKey:@"os"];
    [mainDoc setObject:@"?????" forKey:@"devicename"];
    [mainDoc setObject:deviceType forKey:@"devicetype"];

    [mainDoc setObject:results forKey:@"test_results"];
    [mainDoc setObject:reports forKey:@"reports"];

    NSError *ierror = nil;
    NSData *jsnData = [NSJSONSerialization dataWithJSONObject:mainDoc options:NSJSONWritingPrettyPrinted error:&ierror];
    NSString *jsnString = [[NSString alloc] initWithData:jsnData encoding:NSUTF8StringEncoding];
    NSLog(@"JSON Output: %@", jsnString);

} 
```

我的另一个担心是 test_results 的输出也没有按照我想要的顺序出现。它们按“日期”、“名称”、“结果”的顺序出现，我希望输出为“名称”、“日期”、“结果”。有没有办法我也可以纠正这个订单？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-26T02:23:39.737

NSDictionary 不提供有序的存储容器 - 您或许应该首先调查您如何呈现数据，即直接查询字典键以便对您的 NSDictionary 进行排序，以及将字典对象加载到 NSArray(s) 中。

有大量关于 NSDictionary 固有的缺乏“秩序”的信息。

这个 SO question 提供了许多有用的解决方案，例如使用具有有序字典类的外部库，以及使用 SortDescriptors： [Objective-C 字典是有序容器吗？](https://stackoverflow.com/questions/1648059/is-the-objective-c-dictionary-an-ordered-container)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-26T02:09:13.767

NSDictionary 不保证保持键/值对的顺序（无论如何也不应该，因为 NSDictionary 不是数组，它是一个查找表）。如果您真的希望对其进行排序，最简单的方法是保留另一个数组，其内容是以您想要的顺序存储的字典的键。当你解压 JSON 时，使用数组来查询字典。

# ruby - UTF-8 中的 Ruby 无效字节序列 (ArgumentError)

> ID：14035307
> 
> 赞同：3
> 
> 时间：2012-12-26T02:02:23.147
> 
> 标签：ruby, encoding, web-crawler

> **可能重复：**
> [ruby 1.9：UTF-8 中的无效字节序列](https://stackoverflow.com/questions/2982677/ruby-1-9-invalid-byte-sequence-in-utf-8)

我目前正在构建一个文件系统爬虫并在运行我的脚本时收到以下错误：

```
wordcrawler.rb:8:in `block in <main>': invalid byte sequence in UTF-8 (ArgumentError)
    from /Users/Anconia/.rvm/rubies/ruby-1.9.3-p327/lib/ruby/1.9.1/find.rb:41:in `block in find'
    from /Users/Anconia/.rvm/rubies/ruby-1.9.3-p327/lib/ruby/1.9.1/find.rb:40:in `catch'
    from /Users/Anconia/.rvm/rubies/ruby-1.9.3-p327/lib/ruby/1.9.1/find.rb:40:in `find'
    from wordcrawler.rb:5:in `<main>' 
```

这是我的代码：

```
require 'find'

count = 0

Find.find('/Users/Anconia/') do |file|                   # '/' for root directory on OS X
  if file =~ /\b(\.txt|\.doc|\.docx)\b/                # check if filename ends in desired format
    contents = File.read(file)
      if contents =~ /regex/
      puts file
      count += 1
    end
  end
end

puts "#{count} files were found" 
```

在我的开发环境中，我使用 ruby​​ 1.9.3；但是，当我切换到 ruby​​ 1.8.7 时，脚本运行正常。如果可能的话，我想继续使用 1.9.3。我已经尝试了这篇文章中的所有解决方案（[ruby​​ 1.9: invalid byte sequence in UTF-8](https://stackoverflow.com/questions/2982677/ruby-1-9-invalid-byte-sequence-in-utf-8)），但我的问题仍然存在。有什么建议么？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-26T02:47:34.610

没有正确理解上述帖子的内容。至少可以将其用作[本文的实施示例](https://stackoverflow.com/a/8873922/367611)

```
require 'find'

count = 0

Find.find('/Users/Anconia/') do |file|                                              # '/' for root directory on OS X
  if file =~ /\b(\.txt|\.doc|\.docx)\b/                                           # check if filename ends in desired format
    contents = File.read(file).encode!('UTF-8', 'UTF-8', :invalid => :replace)    # resolves encoding errors - must use 1.9.3 else use iconv
      if contents =~ /regex/
        puts file
        count += 1
    end
  end
end

puts "#{count} files were found" 
```

# html - 滚动条偏移

> ID：14035308
> 
> 赞同：0
> 
> 时间：2012-12-26T02:02:38.293
> 
> 标签：html, css, scrollbar, stylesheet

这是一个非常简单的演示来说明我的意思。

```
<!doctype html>
<html>
  <head>
    <style>
*    { margin:0; padding:0; overflow:hidden; }
html { height: 100%; }
body { height: 100%; }
#top { height: 100px; background-color:#777; }
#doc { height: 100%;  background-color:#888; overflow:scroll; }
    </style>
  </head>

  <body>
    <div id="top"></div>
    <div id="doc">
      <p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Duis magna purus, tincidunt nec dapibus nec, faucibus eu lorem. Integer viverra ultrices diam eget interdum. Nam volutpat dolor a nisi suscipit molestie. Suspendisse molestie mauris at tellus ornare id ultricies lectus varius. Proin nisl diam, egestas in malesuada tincidunt, egestas eu libero. Suspendisse pretium elementum facilisis. Mauris volutpat scelerisque odio, non egestas velit malesuada a. Quisque dictum nibh eget ipsum pretium nec luctus est pulvinar. In hac habitasse platea dictumst. Donec eget purus sit amet diam sodales ultricies. Aliquam erat volutpat. Proin nulla libero, dictum eu fermentum et, egestas ut lacus. Nunc gravida ligula ac velit bibendum vel luctus neque eleifend. Praesent aliquet tempus felis eget commodo.</p>
    </div>
  </body>
</html> 
```

如您所见，滚动条一直延伸到浏览器窗口的底部。`#top`它以与分隔线的高度相同的量来执行此操作。`#top`此外，如果您缩小浏览器窗口，则必须在滚动条出现之前将底线与高度一起传递。

就像滚动条正在偏移浏览器的顶部而不是`#doc`顶部。在 IE9、FireFox 和 Chrome 中的结果相同。

关于如何解决这个问题的任何线索？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-26T02:23:32.257

那是因为

```
#doc { height: 100%; } 
```

采用相同高度的 body & html (100%) 但 #top 减去 100px

示例：http: [//jsfiddle.net/GaVgV/1/](http://jsfiddle.net/GaVgV/1/)

如果您需要保持顶部在 100px，那么您需要使用 jQuery 免费计算高度。

```
$('#doc').height($('body').height() - $('#top').height())​ 
```

示例：http: [//jsfiddle.net/GaVgV/4/](http://jsfiddle.net/GaVgV/4/)

# css - IE7图形问题

> ID：14035312
> 
> 赞同：0
> 
> 时间：2012-12-26T02:03:59.677
> 
> 标签：css, layout, browser, cross-browser, internet-explorer-7

伙计们，我需要你的帮助来解决这里菜单的 IE7 问题：luigisettembrini.gov.it

对于其他浏览器，菜单看起来不错，子菜单在主菜单上方并带有填充物。对于 IE7，它不是“接近”菜单（无法使用）：http: [//img15.imageshack.us/img15/227/senzanomekq .png](http://img15.imageshack.us/img15/227/senzanomekq.png)

不知道为什么会这样。我还尝试使用 Firebug Lite 来查看 IE7，但它一团糟！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-26T06:34:27.220

我无法找到解释 ie7 差异的来源，但这里有一个快速修复：

将嵌套的 ul 更改为绝对位置为 right:0；而不是 200px 的左边距。

或者，您可以为 ie7 提供一个条件样式表，使它们的左边距为零。但由于 uls 已经绝对定位，因此只需删除边距并添加“right:0;”将是一个非常简单的修复。到CSS。

# javascript - 这种对 javascript 闭包的解释正确吗？

> ID：14035317
> 
> 赞同：1
> 
> 时间：2012-12-26T02:04:52.993
> 
> 标签：javascript, closures

对于 tl;dr，当为表中的行创建单击处理程序时，使用闭包使函数指向内存中的同一位置，而不是像下面的代码那样每次都指向不同的位置。

否则：

我正在学习 javascript，我想我理解闭包是什么以及它为什么有用。这是我的推理；这是对的吗？

对于 HTML 表格，下面的代码始终显示被点击的最后一行，即使我点击了第一行或第二行。我的推理是代码创建了 3 个不同的堆栈帧，每个 i 等于 0、1 和 2。由于 2 是最近的堆栈帧，因此 fnPtr 的返回值指向 2。

```
var table = document.getElementById("tableid3");
var rows = table.getElementsByTagName("tr");
for (var i = 0; i < rows.length; i++) {
    var curRow = table.rows[i];
    //get cell data from first col of row
    var cell = curRow.getElementsByTagName("td")[0]; 
    var fnPtr = function() {
        alert("row " + i + " data="+ cell.innerHTML);
    }
curRow.onclick = fnPtr;
} 
```

现在下面的代码（来自一个 SO 问题）使用闭包并只创建一个堆栈帧，即 createfunc() 的帧。但是在这个框架里面是一个局部变量 tmp，它指向匿名函数。当使用 0、1 和 2 调用 createfunc() 时，返回值指向同一个堆栈帧（createfunc() 的堆栈帧内的堆栈帧），这意味着没有创建 3 个堆栈帧。createfunc() 每次返回时，返回值槽中的值都指向内存中的同一个地方，而不是像上面的代码那样每次都指向不同的地方。

```
function createfunc(i) {
    var tmp = function() { console.log("My value: " + i); };
    console.log(tmp);
    return tmp;
}
for (var i = 0; i < 3; i++) {
    funcs[i] = createfunc(i);
}
for (var j = 0; j < 3; j++) {
    funcs[j]();                        // and now let's run each one to see
} 
```

我了解闭包的工作原理吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-26T02:21:56.750

这是关于范围，而不是堆栈。每个函数定义都会在 JavaScript 中创建一个新的作用域，并且函数总是可以访问它们的祖先作用域。

因此，在您的第一个示例中，所有实例都可以从父作用域`fnPtr`访问相同的实例。`i`单击任何行时，`for`循环已经完成，`i`将是 3。

在第二个示例中，每个返回的`tmp`函数都可以访问`i`传递给工厂函数的参数，这在每次迭代/调用时都会有所不同。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-26T02:19:21.620

我不确定考虑 javascript 在堆栈帧方面的工作方式是一个好主意 - javascript 的级别太高了。

在第一个代码片段中，您创建的 fnPtr 函数对象捕获实际变量（但尚未捕获它的值），因此如果该变量稍后发生更改，则在调用该函数时，将`i`使用当前时间的变量值。您的循环可能已经创建了 100 个 fnPtr 函数对象，但每个对象都包含对完全相同`i`变量的引用。

第二个片段利用了这样一个事实，即当您将原始值（例如，数字）作为函数参数传递给函数时，javascript*会创建它的副本*。因此，每次调用 createfunc 时，都会生成一个变量的新副本，并且这个新变量的值设置为调用 createfunc 时参数所具有的任何值。我的重点是这是一个新变量，没有其他函数引用它。因此，当您的 createfunc 返回一个新函数时，该新函数包含对复制的新独占 i 变量的引用。

# sql-server-2008 - 成对比较

> ID：14035324
> 
> 赞同：0
> 
> 时间：2012-12-26T02:06:35.137
> 
> 标签：sql-server-2008

我想根据在调用`@p`存储过程时传递给我的存储过程的参数在 SQL Server 中执行一条语句。

如果`@p`值为 1，`[a]`则不过滤 table 中的数据，如果`@p`值为 0，则根据 table`[a]`上的数据过滤table 中的数据`[b]`。但是必须使用配对比较来比较数据。

如果 SQL Server 支持成对比较，我可以使用这个语法来做到这一点

```
SELECT
    *
FROM
    a
WHERE
    (@p = 1) or ((a.col1, a.col2) in (SELECT col1, col2 FROM b)) 
```

但是，不幸的是 SQL Server 不支持成对比较。

我也可以通过使用 if 语句来做到这一点。

```
if(@p=1)
begin
    SELECT
        *
    FROM
        a
end
else
begin
    SELECT
        *
    FROM
        a join b on a.col1=b.col1 and a.col2=b.col2
end 
```

但是，它使我的存储过程太长了。有另一种解决方法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-26T05:55:51.950

可能最简单的方法是使用 EXISTS 语法：

```
SELECT columnlist
FROM a
WHERE @p=1 OR EXISTS (SELECT * FROM b WHERE a.col1=b.col1 AND a.col2=b.col2) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-26T16:19:38.400

可以使用 EXISTS 像这样重写它：

```
SELECT
*
FROM
a
WHERE
(@p = 1) or EXISTS(SELECT 1 FROM b where b.col1=a.col1 and b.col2=a.col2) 
```

# android - GPS如何实现冷启动、热启动、热启动？

> ID：14035328
> 
> 赞同：0
> 
> 时间：2012-12-26T02:07:36.947
> 
> 标签：android, gps

GPS如何实现冷启动、热启动、热启动？有人对此有任何想法吗？谢谢你的帮助 ！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-26T02:30:49.953

[从2010 年 Google I/O 会议](http://www.google.com/events/io/2010/sessions/beginners-guide-android.html)的 49:43 开始，在大约 5 分钟内描述了一种技术，该技术启动多个位置侦听器，然后随着更准确但延迟时间更长的侦听器变得可用，“退避”不太准确但立即可用的侦听器.

# c - YACC 和 Lex 未定义对“yylex”的引用

> ID：14035334
> 
> 赞同：1
> 
> 时间：2012-12-26T02:10:12.760
> 
> 标签：c, reference, makefile, yacc, lex

我正在尝试使用 flex 和 bison 创建一个简单的计算，但是当我尝试编译时收到错误，我没有使用 YACC 或 FLEX 这是我的第一个程序。

flex 2.5.35、bison (GNU bison) 2.3、gcc (Debian 4.3.2-1.1) 4.3.2、linux 2.6.26-1-686

这是错误：

```
bison -d -y math.yacc -b math
lex -P math math.lex
gcc lex.math.c math.tab.c -g -Wall -lfl -ll -o math.parse.so
math.tab.c: In function ‘yyparse’:
math.tab.c:1244: warning: implicit declaration of function ‘yylex’
/tmp/ccOhwzV0.o: In function `yyparse':
/root/.netbeans/remote/192.168.56.101/silenobrito-nb-Windows-x86_64/D/source/lib-        math/src/model/math.tab.c:1244: undefined reference to `yylex'
collect2: ld returned 1 exit status
make: ** [math.parse.so] Erro 1
athenas:~/.netbeans/remote/192.168.56.101/silenobrito-nb-Windows-x86_64/D/source/lib-math/src/model# 
```

这是我的 Makefile：

```
## -*- Makefile -*-
##
## Usuário: silenobrito
## Hora: 25/12/2012 17:21:13
## Makefile created by Oracle Solaris Studio.
##
## Este arquivo é gerado automaticamente.
##
CC=gcc
CFLAGS=-g -Wall -lfl -ll
LEX=lex
#YACC=yacc -d
#LEX=flex
YACC=bison -d -y

all: lex.math.c math.tab.c math.parse.so 

## Destino: lex.math.c
lex.math.c: math.tab.c
    $(LEX) -P math math.lex 

## Destino: math.tab.c
math.tab.c: math.yacc  math.lex
    $(YACC) math.yacc -b math

## Destino: math.parse.o
math.parse.so: math.tab.c math.tab.h lex.math.c
    $(CC) lex.math.c math.tab.c $(CFLAGS) -o $@

#### Limpar o destino deleta todos os arquivos gerados ####
clean:
    rm -fr math.tab.c math.tab.h lex.math.c 

# Ativar verificação de dependências
.KEEP_STATE:
.KEEP_STATE_FILE:.make.state.GNU-amd64-Linux 
```

这是我的 YACC 文件：

```
%{
#include <stdio.h>
#include <stdlib.h>
#include <math.h>

#define YYSTYPE double

#ifdef  __cplusplus
extern "C" {
#endif
    int yyerror(char *message);
#ifdef  __cplusplus
}
#endif

%}
%start solve
%token END_OF_LINE ADD SUB OPEN_PARENTHESIS CLOSE_PARENTHESIS NUMBER
%left ADD SUB
%%

solve   :   expr END_OF_LINE
        {
            printf("resposta: %lf\n", $1);
            return EXIT_SUCCESS;
        }
expr    :   expr ADD expr
        {
            $$ = $1 + $3;
        }|  expr SUB expr
        {
            $$ = $1 - $3;
        }|  OPEN_PARENTHESIS expr CLOSE_PARENTHESIS
        {
            $$ = $2;
        }|  NUMBER;
%%

int yyerror(char *message) {
    fprintf(stderr, "%s\n", message);
    return EXIT_FAILURE;
}

int main(int argc, char ** argv) {
    return yyparse();
} 
```

这是我的 LEX 文件：

```
%{
#include <stdio.h>
#include <stdlib.h>
#include "math.tab.h"
#define _POSIX_SOURCE 1

int decValue;
%}

%option nounput
%option noinput
%option noyywrap

%%
add                 return ADD;
sub                 return SUB;
[0-9]+              {yylval = atof(yytext); return NUMBER;};
0x[0-9a-fA-F]+      {sscanf(yytext, "%x", &decValue); yylval = decValue; return NUMBER;};
\(                  return OPEN_PARENTHESIS;
\)                  return CLOSE_PARENTHESIS;
\n                  return END_OF_LINE;
.                   ;
%% 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-26T02:41:24.890

问题出在您的 Makefile 上：

```
 $(LEX) -P math math.lex 
```

'-P' 选项定义了一个前缀来代替'yy'，然后'yylex' 被更改为'mathlex'。

改为使用`$(LEX) --outfile=lex.math.c math.lex`。

# perl - 你能有一个没有 .pm 标签的 Perl 类吗？

> ID：14035337
> 
> 赞同：2
> 
> 时间：2012-12-26T02:10:46.913
> 
> 标签：perl, class

> **可能重复：**
> [在 Perl 中，.pm（Perl 模块）和 .pl（Perl 脚本）文件有什么区别？](https://stackoverflow.com/questions/3402821/in-perl-what-is-the-difference-between-a-pm-perl-module-and-pl-perl-script)

我正在尝试在我的主机服务器（iPage）上设置一个 Perl 类。但是他们的配置只能识别带有 .cgi 或 .pl 文件标签的 Perl 文件。是否可以在不使用 .pm 标签的情况下设置 Perl 类？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-12-26T02:22:10.967

你不能使用`use Class::Name;`语法；你将不得不这样做`require 'path/to/filename.pl';`。除此之外，没关系；类名等于`package`语句中的名称，而不是文件名。

但是你是什么意思“他们的配置只识别......”？如果您有任何方法将文件命名`.pm`到服务器上，则不需要他们的配置来“识别”它 - 它只需要您的 Perl 代码（可能在`.cgi`文件中`.pl`）可以找到它。

# 3d - 为什么我的相机不跟随它的目标？(XNA 4.0)

> ID：14035340
> 
> 赞同：0
> 
> 时间：2012-12-26T02:12:28.210
> 
> 标签：3d, xna, camera

这是我的代码，它使对象随鼠标移动，但它不会使屏幕（相机）随之移动。我无法弄清楚它为什么这样做。任何人都可以弄清楚为什么？

```
void UpdateCamera()
    {
        currentmousestate = Mouse.GetState();
        // Calculate the camera's current position.
        Vector3 cameraPosition = avatarPosition;

        Matrix rotationMatrix = Matrix.CreateRotationY(avatarYaw);

        // Create a vector pointing the direction the camera is facing.

        // Compare the original mouse position with the new one,
        // and divide that by a float of -80.

        cameraReference = new Vector3((currentmousestate.X - originalstate.X)/-80f, (currentmousestate.Y - originalstate.Y)/-80f, 1);
        avatarYaw = (float)(currentmousestate.X - originalstate.X)/-160f;

        Vector3 transformedReference = Vector3.Transform(cameraReference, rotationMatrix);

        // Calculate the position the camera is looking at.
        Vector3 cameraLookat = cameraPosition + transformedReference;

        // Set up the view matrix and projection matrix.
        view = Matrix.CreateLookAt(cameraPosition, cameraLookat, new Vector3(0.0f, 1.0f, 0.0f));

        Viewport viewport = graphics.GraphicsDevice.Viewport;
        float aspectRatio = (float)viewport.Width / (float)viewport.Height;

        proj = Matrix.CreatePerspectiveFieldOfView(viewAngle, aspectRatio, nearClip, farClip);
        //originalstate = currentmousestate;

    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-26T08:38:59.593

您应该使用调试器来观察变量所采用的值... avatarPosition 值是否在变化？

我不明白你在用鼠标做什么......你应该在世界坐标系中获取鼠标光线以进行一些有意义的计算......你可以使用 Viewport.UnProject 来获取它。[这是一个方法](https://stackoverflow.com/questions/13042318/ray-intersection-with-3d-quads-in-xna)

我想你想实现一个轨迹球鼠标相机......[在这里我找到了一个样本](http://code.google.com/p/xna-vallerent/source/browse/trunk/TinyGE/TestScene/ArcBallMouseComponent.cs?spec=svn18&r=13)，但如果你寻找“xna arcball”，会有几个样本。

# c++ - 在源文件中定义数组并在其他源文件中使用它

> ID：14035341
> 
> 赞同：0
> 
> 时间：2012-12-26T02:12:28.883
> 
> 标签：c++, arrays, visual-studio-2010, c++11

我正在使用visual C++ 2010。这个问题让我困惑了很长时间。我可以在 *.cpp 中定义一个数组：

```
wstring pairs[][2] =
    {
        {L"\\ben\\b",               L"English"},
        {L"\\bfr\\b",               L"French"},
        {L"\\bit\\b",               L"Italian"},
        {L"\\bde\\b",               L"German"},
        {L"\\bes\\b",               L"Spanish"},
        {L"\\bpl\\b",               L"Polish"},
        {L"\\bru\\b",               L"Russian"},
        {L"\\bzh_cn\\b",            L"ChinesePRC"},
        {L"\\bzh_tw\\b",            L"ChineseTaiwan"},
        {L"\\bja\\b",               L"Japanese"},
        {L"\\bko\\b",               L"Korean"},
        {L"\\bpt\\b",               L"PortugueseStandard"},
        {L"\\btr\\b",               L"Turkish"},
        {L"\\bnl\\b",               L"Dutch"},
        {L"\\blt\\b",               L"Lithuanian"},
        {L"\\blv\\b",               L"Latvian"},
        {L"\\bet\\b",               L"Estonian"}
    }; 
```

并像这样在 *.h 中声明数组：

```
extern wstring pairs[][2]; 
```

现在我可以在其他 *.cpp 中使用该数组，但我无法获得`pairs`使用代码的大小：

```
size_t cnt = _countof(pairs); 
```

我收到错误消息：

```
1>e:\work\vc++\justtest\console\console.cpp(45): error C2893: Failed to specialize function template 'char (*__countof_helper(_CountofType (&)[_SizeOfArray]))[_SizeOfArray]'
1>          With the following template arguments:
1>          'std::wstring [2]' 
```

我很困惑是否可以像这样使用数组？有人可以帮助我吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-26T02:17:25.683

如果要获取`extern`数组的长度，必须在头文件中显式声明数组的长度。否则，编译器根本无法访问该信息；它隐藏在定义的目标文件中，编译器不会读取该文件。

您可以通过其他两种方式来做您想做的事：

1.  您可以为数组的长度创建另一个变量。然后也`extern`为此做一个，您将能够访问另一个文件中的长度。

    **缺点：**长度仍然不会*静态*知道。但是，如果您进行了链接时优化（不太可能）并且没有将该值用于任何花哨的元编程，那可能不是问题。

2.  您可以在标记数组末尾的末尾添加一个标记值。

    **缺点：**使用这种方法也不会静态知道长度。此外，每次您想要数组的长度时，都是 O(n) 操作。如果您只遍历数组，这可能不是问题。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-26T02:17:40.887

您可以使用带有 的数组`extern`，但您要么 (1) 需要显式声明大小，要么 (2) 在字符串中放置一个类似于 null 终止符的终止符条目，以计算运行时的条目数。

解决方案1：

```
extern wstring pairs[17][2]; 
```

通过此更改，`sizeof(pairs)`将正确定义。

解决方案2：

```
wstring pairs[][2] =
{
    {L"\\ben\\b",               L"English"},
    {L"\\bfr\\b",               L"French"},
    ...
    {L"\\blv\\b",               L"Latvian"},
    {L"\\bet\\b",               L"Estonian"}, {0, 0}
}; 
```

现在您可以运行一个快速循环`pairs`以到达`*pairs[i] == 0`，这将指示最后一个条目。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-12-26T02:24:51.190

它看起来像是`_countof`一个模板函数，需要在编译时知道数组大小。而且在编译时，只有你的`extern`声明是可见的，它没有提到数组大小。

一种可能的解决方法是添加另一个变量来保存大小。标题：

```
extern wstring pairs[][2];
extern const size_t pairs_size; 
```

来源：

```
wstring pairs[][2] = { /*...*/ };
const size_t pairs_size = _countof(pairs); 
```

或者，正如其他人建议的那样，使用哨兵在运行时确定数组大小。

或者，如果使用允许，切换到一个`std::vector`或其他容器。（这可能会弄乱静态初始化器的顺序。）

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-12-26T02:18:53.573

将 a 添加`{ NULL, NULL }`到数组的末尾。然后使用类似这样的循环：

```
extern wstring pairs[][2];
...
int do_stuff()
{
    for(int i = 0; pairs[i][0] != NULL; i++)
    {
      ... do things with pairs as you like ... 
    }
} 
```

希望这就是你要找的。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2017-12-18T11:56:48.557

接近但没有奖牌。这是大多数现代编译器都应该使用的东西。在声明数组的源文件中，执行以下操作：

```
const unsigned int amrd_count=sizeof( amrd ) /sizeof( amrd[0] ); 
```

在您的标题中，插入如下内容：

```
extern T amrd[];
extern const unsigned int amrd_count; 
```

对我来说，这适用于 XCode (Apple LLVM 版本 9.0.0 (clang-900.0.39.2)) 和 gcc (GCC) 4.8.5 20150623 (Red Hat 4.8.5-16)

# windows-8 - 是否可以在 Windows RT 上编程

> ID：14035342
> 
> 赞同：7
> 
> 时间：2012-12-26T02:12:49.417
> 
> 标签：windows-8, ide, windows-runtime, windows-rt

有什么方法可以在 WinRT 上安装 C++ 编译器或 Ruby/Python 解释器。（或者除了 JavaScript 和在线编译器和 IDE 之外，还有其他方法可以用一种语言进行编程）

更具体地说：我可以使用我的 WinRT 而非 WinRT 进行编程吗？所以我可以在 WinRT 上打开应用程序或记事本，然后在 WinRT 上编译代码（不是“FOR”而是“使用”）。谢谢。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-12-26T06:27:55.083

您正在寻找可以在 Windows RT（基于 ARM）设备上运行并允许您为其他目标平台编译程序的 IDE（集成开发环境）？虽然此类应用程序没有技术限制，但目前商店中似乎没有任何限制。唯一具有 Ruby 解释器的似乎是[InstantRuby](http://apps.microsoft.com/webpdp/app/64438b0c-b188-4a92-b918-41ba0f86b85e)，尽管看起来您实际上不能用它创建程序。

虽然已经有多个代码编辑器可用（没有特别的顺序，因为我还没有尝试过它们中的任何一个）：

*   [代码编写者](http://apps.microsoft.com/webpdp/app/5149f454-94a7-40bc-90ef-eafd38355079)
*   [记事本RT](http://apps.microsoft.com/webpdp/app/592a5cf2-f685-49a2-9242-8aa7c284c333)
*   [HaxPad](http://apps.microsoft.com/webpdp/app/d6e5c55d-9c4f-47dc-bb36-20bea0df9664)
*   [代码加](http://apps.microsoft.com/webpdp/app/18882cca-c9de-4aff-9680-05e53aef7edb)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-12-27T23:27:28.010

最简单的方法是在 WindowsRT 计算机上使用远程桌面应用程序。在普通 PC 上安装 IDE 或其他开发工具，并使用远程桌面登录。这样，WindowsRT 系统就充当了一个终端（“瘦客户端”），并且可以支持您可以安装在 PC 上的任何 IDE 和编译器链。

如果你真的想*在*WindowsRT 上构建软件：如果这是可能的，它很可能涉及*为*WindowsRT 开发，因为至少如果你想进行本地调试，你的代码也必须在 WindowsRT 上运行。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-02-27T21:04:55.417

是的，但您需要越狱设备。Python 2.7.3 已移植到 WinRT（无法调用本机代码）。Vim 以及其他一些编辑器也已被移植。有关越狱[http://forum.xda-developers.com/showthread.php?t=2092158](http://forum.xda-developers.com/showthread.php?t=2092158)和移植应用程序[http://forum.xda-developers.com/showthread.php?t=的更多信息，请参见此处2092348](http://forum.xda-developers.com/showthread.php?t=2092348)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-12-27T17:23:25.833

到目前为止，我只能使用 / 执行 powershell 脚本和 js/vbs`cscript`脚本`wscript`。

我能够在 Windows RT 上编译 C# 代码，因为它具有 C# 编译器（我必须`csc.rsp`稍微调整文件以删除丢失的 dll），但是无法加载未签名的程序集，因此这在很大程度上是无用的。即使获得开发人员许可证（使用`Show-WindowsDeveloperLicenseRegistration`cmdlet）也不允许执行未签名的“桌面”.NET 应用程序。需要尝试使用“ModernUI”。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-03-18T20:49:16.150

我在这里移植了 SharpDevelop，用于 C# [http://chentiangemalc.wordpress.com/2013/03/18/sharpdevelop-rt-edition-beta-code-windows-forms-directly-on-windows-rt/](http://chentiangemalc.wordpress.com/2013/03/18/sharpdevelop-rt-edition-beta-code-windows-forms-directly-on-windows-rt/)你的设备必须解锁为了允许桌面应用程序，信息在 xda 开发人员上。

# android - 黑莓 10 安卓启动器小部件

> ID：14035352
> 
> 赞同：1
> 
> 时间：2012-12-26T02:15:09.260
> 
> 标签：android, android-widget, blackberry-10

我看到所有关于将“我的 android 应用程序移植到 blackberry 10”的广告，并且我之前已经将一个 android 应用程序移植到模拟器中的 blackberry playbook

但是黑莓 10 是否支持 android 启动器（又名主屏幕）小部件？谢谢

如果是这样，过程或编程差异是什么

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-26T02:17:50.753

不支持主屏幕小部件。BlackBerry Runtime for Android Apps 仅支持没有小部件的 Android 2.3.3 应用程序。

从[文档](http://developer.blackberry.com/android/apisupport/unsupportedapi_blackberry10_app_types.html)中：

> 不支持以下类型的应用程序。这些类型的应用程序将不允许销售或分发：
> 
> ```
> - Widget apps
> [...] 
> ```

# java - Primefaces 一页中的两个数据表导致分页和过滤问题

> ID：14035353
> 
> 赞同：3
> 
> 时间：2012-12-26T02:15:51.660
> 
> 标签：java, spring, jsf-2, primefaces, lazy-loading

我正在使用带有 Weblogic 10.3.6 作为服务器的 Hibernate 4、Spring 3 和 JSF 2.0。

我在一页中有两个数据表，为了填充数据表，我正在使用延迟加载。

我面临的问题是当两个数据表都显示时，分页不起作用。它确实转到第 2 页和第 3 页等等，但数据表中的记录对于两个数据表保持不变。如果我删除其中任何一个，则分页效果很好。

我注意到当我有多个数据表时，即使过滤器也不起作用。两个数据表都采用单一形式，它们都具有两个不同的 ManagedBean，并且都属于视图范围。我尝试过请求范围，但没有解决我的问题。

我该如何解决这个问题？

*JSF 代码*

```
<h:form id="form">
    <!-- Master form -->
        <p:dataTable id="dataTable" var="req" lazy="true" value="#{emp.lazyModel}"
            paginator="true" rows="10" 
                         selection="#{emp.selectedRequest}"
                        selectionMode="single">                             
      <p:ajax event="rowSelect" listener="#{emp.onRowSelect}" />            
            <p:column id="empNo" filterBy="#{req.empNo}"   
                headerText="Request No" footerText="contains"  
                filterMatchMode="endsWith">                 
                <h:outputText value="#{req.empNo}" />
            </p:column>         
            other columns
                    </p:dataTable>              
        <!-- Detail form -->
        <p:dataTable id="dataTableDet" var="reqAct" lazy="true" value="#{dept.lazyModel}"
            paginator="true" rows="1"
            rowsPerPageTemplate="5,10">
            <f:facet name="header">                  
            Emp Details  
        </f:facet>
       <p:column>
                <f:facet name="header">
                    <h:outputText value="SLNo" />
                </f:facet>
                <h:outputText value="#{reqAct.slNo}" />
            </p:column>        
            <p:column id="empNo" filterBy="#{reqAct.empNo}"   
                headerText="Request No" footerText="contains"  
                filterMatchMode="endsWith">                 
                <h:outputText value="#{reqAct.empNo}" />
            </p:column>
        other columns
        </p:dataTable>      
        </h:form> 
```

*Managedbean 第一个数据表*

```
@Named("emp")
@Scope("view")
@PostConstruct
    public LazyDataModel<Employee> getLazyModel() {
        if (lazyModel == null) {
            lazyModel = new LazyRequestDataModel(empList, empService) {

            };          
        }

        return lazyModel;
    } 
```

*Managedbean 第二个数据表*

```
@Named("dept")
@Scope("view")
@PostConstruct
    public LazyDataModel<Department> getLazyModel() {
        if (lazyModel == null) {
            lazyModel = new LazyRequestActivitiesDataModel(deptList,
                    deptService) {

            };
        }

        return lazyModel;
    } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-26T06:41:55.773

不确定它是否会有所帮助，但无论如何这是一个更好的方法

将您的更改`@PostConstruct`为 public void ，就像这样（对两个 Bean 都这样做）

```
@PostConstruct
public void init(){
    initTable();
}

private void initTable(){
    lazyModel = new LazyRequestActivitiesDataModel(deptList,deptService);
}

public LazyDataModel<Department> getLazyModel() {
    return lazyModel; 
```

}

# ios6 - iOS6 中的 MFMailComposeViewController 崩溃

> ID：14035355
> 
> 赞同：0
> 
> 时间：2012-12-26T02:16:05.330
> 
> 标签：ios6, crash, mfmailcomposeviewcontroller

我在我的项目中使用 MFMailComposeViewController，一切正常，但在 iOS6 中运行。有人可以帮帮我吗？

![代码快照](../Images/67c3d53ed5930a589262d1976bc8bac3.png) ![调用栈快照](../Images/1cecf886ba744db5567093159bfb3adb.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-26T03:05:28.633

我发现了为什么会发生这种崩溃，这是我的疏忽。我换了`methodSignatureForSelector:`of `NSObject`，逻辑不正确！

# android - Lua 错误：Android NDK 下的“尝试调用字符串值”？

> ID：14035361
> 
> 赞同：1
> 
> 时间：2012-12-26T02:17:57.473
> 
> 标签：android, android-ndk, lua

我的 Lua 脚本由[LOOP](http://loop.luaforge.net/release/preload.html)编译，编译后的脚本模块在台式机（OSX 10.7.5）中运行良好。但是当我在Android手机（Android 2.3.6）下运行它时，它总是失败并报错`attempt to call a string value`。相同的脚本也可以在同一部手机中以脚本（未编译）方式运行而不会出现问题。

测试使用 Lua 5.1.5 和 Android NDK r8b。

logcat中的错误：

```
12-26 09:40:26.934: E/libb22luapre(8190): Failed to run script: attempt to call a string value 
```

C 代码片段（为简单起见，删除了错误处理代码）：

```
const char script[] = "require \"hello.world\"\n"
            "require \"anothermodule\"\n"
            "hello.world.test2()";
luaL_loadstring(L, script);
lua_pcall(L, 0, LUA_MULTRET, 0); 
```

我转储了预加载的表，这些必需的模块已经存在（加载成功）。

我搜索了网络，仍然找不到解决方案。任何建议将不胜感激。

[更新] 我为 android 编译了 lua 命令并将编译的 lua 脚本嵌入其中。错误与上述相同。

```
$ adb shell
$ cd /data/local
$ ls
tmp
lua
dump_preload.lua
$ ./lua dump_preload.lua
--- print table --- preload
    test    function: 0x376f0
    anothermodule   function: 0x37718
    hello.world function: 0x376b0
--- print table --- loaded
    string  table: 0x33828
    debug   table: 0x37098
    package table: 0x33d30
    _G  table: 0x32528
    io  table: 0x34e80
    os  table: 0x357b8
    table   table: 0x332c0
    math    table: 0x36530
    coroutine   table: 0x33988
--- print table --- loaders
    1   function: 0x33ed8
    2   function: 0x33ef8
    3   function: 0x33f18
    4   function: 0x33f38
$ ./lua
Lua 5.1.5  Copyright (C) 1994-2012 Lua.org, PUC-Rio
> require 'test'
attempt to call a string value
stack traceback:
    [C]: ?
    [C]: in function 'require'
    stdin:1: in main chunk
    [C]: ?
> require 'hello.world'
attempt to call a string value
stack traceback:
    [C]: ?
    [C]: in function 'require'
    stdin:1: in main chunk
    [C]: ?
> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-28T02:34:22.800

问题已解决。事实证明，编译后的 lua 代码不可移植。您必须针对目标机器编译 lua 脚本。

步骤的简短摘要：

1.  为Android编译lua命令
2.  将 lua 命令文件和 LOOP 的 lua 文件以及应用程序的 lua 文件推送到目标手机的文件夹中，例如 /data/local
3.  打开 adb shell 并编译 lua 脚本文件
4.  拉出生成的 .h .c 文件

# vb.net - 将面板添加到更多 TabPages

> ID：14035364
> 
> 赞同：0
> 
> 时间：2012-12-26T02:18:19.237
> 
> 标签：vb.net

我有几个文本框、datagridview 等的面板... - Panel1。
另外，我有带有 3 个 TabPages（可能更多）的 TabControl，我想在上面添加那个 Panel1。
我不知道这是个好主意，因为标签页中会发生事件并从文本框中收集数据。构建一个用户控件而不是面板会更好吗？

但是，好的......
如何将该面板添加到标签页？
我尝试：

```
 Panel1.Location = New Point(50, 50)
    TabControl1.TabPages(0).Controls.Add(Panel1)

    Panel1.Location = New Point(60, 50)
    TabControl1.TabPages(1).Controls.Add(Panel1)

    Panel1.Location = New Point(70, 50)
    TabControl1.TabPages(2).Controls.Add(Panel1) 
```

但这当然行不通。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-26T20:58:18.663

我是面板的忠实粉丝！谁不喜欢标签？我不相信您应该对事件有任何问题，只要它们在面板/控制级别正确设置。

一个基本的处理方式：

```
 'a new panel
        Dim pnlToAdd As New Panel

        'just to see the panel added - add your panel properties here
        pnlToAdd.BackColor = Color.Red

        'add something to panel
        Dim txtToAdd As New TextBox

        'add a control to test panel
        pnlToAdd.Controls.Add(txtToAdd)

        'create a tabpage
        Dim tabPageRef As New TabPage

        'set the tabpage to be your desired tab
        tabPageRef = TabControl1.TabPages(1)

        'add the panel
        tabPageRef.Controls.Add(pnlToAdd) 
```

# matlab - 为什么向量化代码比 MATLAB 中的 for 循环运行得更快？

> ID：14035365
> 
> 赞同：24
> 
> 时间：2012-12-26T02:18:19.333
> 
> 标签：matlab, for-loop, parallel-processing, vectorization

我读过[这篇](https://stackoverflow.com/questions/10543472/parallelizing-vectorized-code-in-matlab-or-octave)文章，但我仍然不明白为什么矢量化代码更快。

在 for 循环中，我可以使用 parfor 来进行并行计算。如果向量化代码更快，是否意味着它会自动并行化？

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2012-12-26T06:27:13.867

不，你混合了两个重要的概念：

*   MATLAB 旨在非常快速地执行向量运算。MATLAB 是一种解释型语言，这就是为什么它的循环如此缓慢的原因。MATLAB 通过提供极快的（通常用 C 语言编写，并针对特定架构进行了优化）和经过良好测试的函数来对向量进行操作，从而回避了这个问题。这里真的没有什么神奇之处，它只是一堆辛勤的工作和多年不断的小改进。

例如，考虑一个简单的情况，例如：

```
s=0;
for i=1:length(v),
    s = s+v(i);
end 
```

和

```
sum(v) 
```

您可能应该使用 tic 和 toc 对这两个函数进行计时，以使自己相信运行时的差异。对向量进行操作的类似常用函数大约有 10 个，例如：`bsxfun`、`repmat`、`length`、`find`。矢量化是有效使用 MATLAB 的标准部分。在您可以有效地矢量化代码之前，您只是 MATLAB 世界中的游客，而不是公民。

*   最新版本的 MATLAB 提供 parfor。parfor 不是灵丹妙药，它是一种可以使用和误用的工具（在上面的 sum 示例中尝试 parfor）。并非所有的 fors 都可以解释。parfor 专为任务并行类型的问题而设计，其中循环的每次迭代都相互独立。这是使用 parfor 循环的关键要求。

虽然在许多情况下 parfor 可以提供很多帮助，但很少发生可以为非常大的收益进行 parfor 的循环类型。

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2013-01-02T20:53:30.947

我同意 carlosdc 的回答。然而，重要的是要记住，自 6.5 版以来，Matlab 已包含一个 JIT 编译器，用于加速 for 循环等。

我用一百万个元素对你的求和示例进行了快速测试，`v`得到了以下结果：

*   `sum(v)`: 4.3 毫秒
*   `for-loop version`: 16 毫秒
*   `for-loop version, no JIT`: 966 毫秒

JIT 可以像这样打开和关闭：

```
feature accel off
feature accel on 
```

通过矢量化代码来改进 4 因素当然仍然是值得的，但不应该害怕 for 循环，因为它们曾经是一个很好的解决方案。通常，一段良好的矢量化代码通常可以更简单、更不容易出错并且同时更快。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-12-26T09:27:22.600

在现代计算机中，寄存器（用于数学的临时存储器，以及其他用途）有很多位，可以一起处理多个数字。例如，如果您的数据是 uint8（8 位），您可以在一个 CPU 时钟中为每个添加一个数字，或者您可以将其中的 8 个放在寄存器中，然后在一个 CPU 时钟中为所有这些添加一个数字. 这样你的工作速度比 for 循环快 8 倍。

这在某种意义上是并行化，但不像 parfor。Parfor 使用 CPU 的多个核心，在上述方法中，一个核心的使用效率更高。如果同时使用它们，则可以实现更高的速度。

# android - If-Else 语句在 Android 应用程序中不起作用

> ID：14035374
> 
> 赞同：0
> 
> 时间：2012-12-26T02:22:05.430
> 
> 标签：android, if-statement, android-edittext, spinner

我的应用程序中有一个简单的**if-else**语句，但它不起作用。如果我在**Spinner中选择“** **day** ” ，则只能编辑那一天。它不起作用，因为仍然可以编辑所有日子。有人能告诉我为什么吗？

 **```
final String[] items={"Day","Date","Time","Location"};

    mSpin2.setOnItemSelectedListener(
        new OnItemSelectedListener() {
            @Override
            public void onItemSelected(
                AdapterView<?> parent2, View view, int pos, long id
            ) {
String strsel=items[pos];
if(strsel.equalsIgnoreCase("Day")) {
    btnChangeDate.setFocusable(false);
    btnChangeDate.setEnabled(false);
    //btnChangeDate.setClickable(false);
    btnChangeTime.setFocusable(false);
    btnChangeTime.setEnabled(false);
    //btnChangeTime.setClickable(false);
    mLatitude.setFocusable(false);
    mLatitude.setEnabled(false);
    mLongitude.setFocusable(false);
    mLongitude.setEnabled(false);
} else {
    mMonday.setFocusable(true);
    mMonday.setEnabled(true);
    mTuesday.setFocusable(true);
    mTuesday.setEnabled(true);
    mWednesday.setFocusable(true);
    mWednesday.setEnabled(true);
    mThursday.setFocusable(true);
    mThursday.setEnabled(true);
    mFriday.setFocusable(true);
    mFriday.setEnabled(true);
    mSaturday.setFocusable(true);
    mSaturday.setEnabled(true);
    mSunday.setFocusable(true);
    mSunday.setEnabled(true);
} 

String strsel2=items[pos];
if(strsel2.equalsIgnoreCase("Date")) {
    mMonday.setFocusable(false);
    mMonday.setEnabled(false);
    mTuesday.setFocusable(false);
    mTuesday.setEnabled(false);
    mWednesday.setFocusable(false);
    mWednesday.setEnabled(false);
    mThursday.setFocusable(false);
    mThursday.setEnabled(false);
    mFriday.setFocusable(false);
    mFriday.setEnabled(false);
    mSaturday.setFocusable(false);
    mSaturday.setEnabled(false);
    mSunday.setFocusable(false);
    mSunday.setEnabled(false);
    btnChangeTime.setFocusable(false);
    btnChangeTime.setEnabled(false);
    //btnChangeTime.setClickable(false);
    mLatitude.setFocusable(false);
    mLatitude.setEnabled(false);
    mLongitude.setFocusable(false);
    mLongitude.setEnabled(false);                           
} else {
    btnChangeDate.setFocusable(true);
    btnChangeDate.setEnabled(true);
}

String strsel3=items[pos];
if(strsel3.equalsIgnoreCase("Time")) {
    mMonday.setFocusable(false);
    mMonday.setEnabled(false);
    mTuesday.setFocusable(false);
    mTuesday.setEnabled(false);
    mWednesday.setFocusable(false);
    mWednesday.setEnabled(false);
    mThursday.setFocusable(false);
    mThursday.setEnabled(false);
    mFriday.setFocusable(false);
    mFriday.setEnabled(false);
    mSaturday.setFocusable(false);
    mSaturday.setEnabled(false);
    mSunday.setFocusable(false);
    mSunday.setEnabled(false);
    btnChangeDate.setFocusable(false);
    btnChangeDate.setEnabled(false);
    //btnChangeDate.setClickable(false);
    mLatitude.setFocusable(false);
    mLatitude.setEnabled(false);
    mLongitude.setFocusable(false);
    mLongitude.setEnabled(false);
} else {
    btnChangeTime.setFocusable(true);
    btnChangeTime.setEnabled(true);
}

String strsel4=items[pos];
if(strsel.equalsIgnoreCase("Location")) {
    mMonday.setFocusable(false);
    mMonday.setEnabled(false);
    mTuesday.setFocusable(false);
    mTuesday.setEnabled(false);
    mWednesday.setFocusable(false);
    mWednesday.setEnabled(false);
    mThursday.setFocusable(false);
    mThursday.setEnabled(false);
    mFriday.setFocusable(false);
    mFriday.setEnabled(false);
    mSaturday.setFocusable(false);
    mSaturday.setEnabled(false);
    mSunday.setFocusable(false);
    mSunday.setEnabled(false);
    btnChangeDate.setFocusable(false);
    btnChangeDate.setEnabled(false);
    //btnChangeDate.setClickable(false);
btnChangeTime.setFocusable(false);
btnChangeTime.setEnabled(false);
//btnChangeTime.setClickable(false);
} else {
    //mLatitude.setFocusable(true);
    mLatitude.setEnabled(true);
    //mLongitude.setFocusable(true);
    mLongitude.setEnabled(true);
} 
}

@Override
public void onNothingSelected(AdapterView<?> arg0) {}
    }
); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-26T23:47:28.783

好的，我再次查看了您的代码。你要么在做一些不明显的事情，要么你没有使用`else`应该使用的案例。无论哪种方式，您都知道您得到的结果是错误的。我建议在下面的模式之后重写监听器。您可能需要根据您的实际需求对其进行微调：

```
static final int dayIndex  = 0;
static final int dateIndex = 1;
static final int timeIndex = 2;
static final int locIndex  = 3;

public void onItemSelected( AdapterView<?> parent2, View view, int pos, long id ) {
    mMonday.setFocusable( pos == dayIndex );
    mMonday.setEnabled( pos == dayIndex );
    mTuesday.setFocusable( pos == dayIndex );
    mTuesday.setEnabled( pos == dayIndex );
    mWednesday.setFocusable( pos == dayIndex );
    mWednesday.setEnabled( pos == dayIndex );
    mThursday.setFocusable( pos == dayIndex );
    mThursday.setEnabled( pos == dayIndex );
    mFriday.setFocusable( pos == dayIndex );
    mFriday.setEnabled( pos == dayIndex );
    mSaturday.setFocusable( pos == dayIndex );
    mSaturday.setEnabled( pos == dayIndex );
    mSunday.setFocusable( pos == dayIndex );
    mSunday.setEnabled( pos == dayIndex );

    btnChangeDate.setFocusable( pos == dateIndex );
    btnChangeDate.setEnabled( pos == dateIndex );

    btnChangeTime.setFocusable( pos == timeIndex );
    btnChangeTime.setEnabled( pos == timeIndex );

    mLatitude.setEnabled( pos == locIndex );
    mLongitude.setEnabled( pos == locIndex );
} 
```

如果您在微调器中选择第一项（日），上面的代码将启用 mMonday..mSunday，否则禁用它们。如果您选择第二项（日期）...等，它将启用 btnChangeDate。请注意，如果我猜对了您的意图，并且此代码有效，那么您对 ​​if/then/else 构造的理解存在很大缺陷，您可能想读一读。**

# c - 递归数字函数返回意外值

> ID：14035375
> 
> 赞同：0
> 
> 时间：2012-12-26T02:22:06.053
> 
> 标签：c, string, recursion, int

在广泛搜索将整数转换为视觉等效字符串的函数但一无所获之后，我决定编写自己的。

函数“ascii”接受三个参数：要转换的整数、保存转换后的整数的字符串和一个保留为 0 的计数器。

```
void ascii(int c, char str[], int k) {
    if (c <= 9) {
        str[k] = c + '0';
    }

    else if (c >= 10) {
        str[k] = c / 10 + '0';
        ascii(c % 10, str, k + 1);
    }
} 
```

用个位数的数字测试这个函数并没有什么意外的结果，但是在更大的数字上，事情开始变得一团糟。76变成“761”，765变成“|51”，7658变成“-81”。数字包含的数字越多，我对结果字符串的理解就越少。是什么赋予了？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-26T02:26:58.973

我相信这是问题所在：

```
else if (c >= 10) {
    str[k] = c % 10 + 48;
    ascii(c / 10, str, k + 1);
} 
```

算术运算被反转。之后必须反转生成的数组（来自不同的函数，该函数将问题中的函数作为助手调用），并且它必须以`'\0'`char 结尾。

或者，您可以以相反的顺序将结果复制到输出数组中，但前提是您事先知道位数。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-26T02:28:13.127

对于这种情况`c = 123`，您实际上是在这样做：

```
 str[k] = 12 + '0';
    ascii(3, str, k + 1); 
```

我不确定你打算发生什么，但这可能不是你的意思。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-26T09:31:42.810

*   首先你交换了模数和除法，这就是你得到那些意想不到的答案的原因。
*   此外，这给出了您所期望的相反答案。所以修改数字然后尝试解决它。

    ```
    void ascii(int c, char str[], int k) {
    /*first let us reverse the string
    because recursive solution will be reverse of our expected solution*/
    int r=0,i;
    for(i=c;i>0;i=i/10)
    r=r*10+i%10;

    if (r <= 9) {
        str[k] = r + '0';

    }
    else if (r >= 10) {
         ascii(r / 10, str, k+1 );
         str[k] = r%10 + '0';
    }
    return;
    } 
    ```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-26T02:42:28.793

其他答案指出了最重要的错误-您交换了模数和除法；尽管如此，即使进行了更正，产生的字符串也会被反转，因为使用模数你很快就会得到最低有效位，它应该向右，但是你把它放在左边，因为一开始是未知的最终长度字符串。

您可以反转此字符串，使用对数查找位数或使用替代递归方法：

```
void ascii(int c, char str[])
{
    if(c<0)
    {
        *(str++)='-';
        c=-c;
    }
    *(ascii_helper(c, str))='\0';
}

char * ascii_helper(int c, char str[])
{
    if (c > 9)
        str=ascii_helper(c/10, str);
    *str = c%10 + '0';
    return str+1;
} 
```

这是通过推迟数字的实际写入直到它们的位置已知来实现的。递归一直持续到找到最高有效数字为止，然后每个调用将下一个字符的位置返回给其调用者，该位置用于正确定位每个数字。请注意，此函数不能像原始函数那样进行尾部优化，因此它的空间效率较低（尽管这几乎无关紧要，因为`int`s 通常不能容纳超过 20 位数字）。

# wpf - 如何更改 WPF 日期选择器的图标？

> ID：14035379
> 
> 赞同：4
> 
> 时间：2012-12-26T02:22:39.263
> 
> 标签：wpf, datepicker

我正在做一个 wpf 应用程序，我的应用程序中有两个日期选择器。我想知道是否有任何快速方法（例如我设置日期选择器背景的方式）来更改 wpf 默认日期选择器的日历图标？

我的日期选择器代码片段：

```
 <DatePicker Name="datefromDP" Width="100" Height="24"Foreground="White" BorderThickness="0"  >
        <DatePicker.Resources>
            <Style TargetType="{x:Type DatePickerTextBox}">
                <Setter Property="Text" Value="Select date" />
                <Setter Property="IsReadOnly" Value="True"/>
                <Setter Property="Background">
                  <Setter.Value>
                    <ImageBrush ImageSource="/BeaconProject;component/B_images/button/loginheader_bg.jpg"/>
                  </Setter.Value>
                </Setter>
            </Style>
        </DatePicker.Resources>
  </DatePicker> 
```

我的日期选择器：

![在此处输入图像描述](../Images/f5c68bd2fb17540134524cad6bc1a221.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-26T04:47:06.717

我认为你应该使用自己的风格。请参阅[DatePicker 样式](https://docs.microsoft.com/en-us/dotnet/articles/framework/wpf/controls/datepicker-syles-and-templates)。

您所指的图标是样式的这一部分：

```
<Path HorizontalAlignment="Center" Margin="4,3,4,3" ...
<Ellipse HorizontalAlignment="Center" ...
<Border Grid.ColumnSpan="4" Grid.Row="0" Grid.RowSpan="4" ... 
```

# html - 输入填充跨浏览器问题？

> ID：14035388
> 
> 赞同：0
> 
> 时间：2012-12-26T02:25:14.810
> 
> 标签：html, css, twitter-bootstrap, cross-browser

我有一个应该如下所示的搜索表单：

![在此处输入图像描述](../Images/5342927f21c24c1e4ca591b445cf7051.png)

这是 HTML：

```
<form method="post" action="#" class="search-form">
    <input type="text" class="nav-search-input input-initial" data-initial='Search' value="Search">
    <input type="submit" class="nav-search-submit" value="&#57384;"><!-- &#57384; is the code for the Glyphicons search icon -->
</form> 
```

我正在使用 Bootstrap 和 Bootstrap 响应样式，以及搜索表单的以下样式：

```
.search-form{
    display: block;
    margin: 0;
}

input.nav-search-input,
input.nav-search-submit{
    color: #eeeeee;
    background-color: #181818;

    border-top: 1px solid #303030;
    border-bottom: 1px solid #303030;
}

input.nav-search-input{
    width: 90px;
    height: 20px;

    -moz-transition:border-color 75ms;
    -o-transition:border-color 75ms;
    -webkit-transition:border-color 75ms;

    outline: 0!important;
    -webkit-appearance:none!important;
    box-shadow: none!important;
    -moz-box-shadow: none!important;
    -webkit-box-shadow: none!important;
    margin-top: 10px;

    padding: 0px 0px 0px 8px;

    line-height: normal;
    font-weight: normal;
    font-size: 14px;

    border-right: none;
    border-left: 1px solid #303030;

    -webkit-border-radius: 0px;
    -moz-border-radius: 0px;
    border-radius: 0px;

    -webkit-border-top-left-radius: 10px;
    -moz-border-radius-topleft: 10px;
    border-top-left-radius: 10px;

    -webkit-border-bottom-left-radius: 10px;
    -moz-border-radius-bottomleft: 10px;
    border-bottom-left-radius: 10px;

}

input.nav-search-submit{
    font-family: Glyphicons;

    box-sizing: content-box;

    padding: 0px 6px 0px 5px;

    color: #aaaaaa;

    -moz-transition:border-color 75ms;
    -o-transition:border-color 75ms;
    -webkit-transition:border-color 75ms;

    border-left: none;
    border-right: 1px solid #303030;

    -webkit-border-top-right-radius: 10px;
    -moz-border-radius-topright: 10px;
    border-top-right-radius: 10px;

    -webkit-border-bottom-right-radius: 10px;
    -moz-border-radius-bottomright: 10px;
    border-bottom-right-radius: 10px;
} 
```

这在 Chrome、Firefox 和 Safari 上运行良好，但 Opera 呈现如下形式：

![在此处输入图像描述](../Images/0522ed9e4c2c820699ff09e0ca45edb9.png)

有问题的 Opera 版本是 12.02。

这似乎是填充的问题。[我已经尝试了这个问题](https://stackoverflow.com/questions/1354470/form-padding-differences-in-firefox-and-opera-chrome-ie)中列出的解决方案，但无济于事。如果我增加顶部和底部填充以使其在 Opera 中看起来正确，它在其他浏览器中看起来不再正确。

这是[该页面的工作版本](https://dl.dropbox.com/u/23262910/test/test.html)。

旁注，我没有在 IE 中测试，因为我在 Mac 上。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-26T05:43:18.057

几个想法：

1.  你依靠一种字体来制作放大镜……那是有风险的。一些设备不支持@face 字体（用 Droid Sans 替换 Glyphicons，你会看到你的一些用户会得到什么 - 填充无关紧要）

2.  您是否只是尝试过使用`<input type="image"...>`

3.  您是否尝试过使用`{ background:url('mag-glass') }`

我有 50 美元说你的问题与歌剧如何渲染该字体或该字体的行高有关。是的 - 为 Opera 修复该问题将提升 FF、Chrome 和 Safari。

另外，我浏览了您的 CSS 文件，但没有看到 CSS 重置。有关详细信息，请参阅 Eric Meyer 的 CSS 重置。当一切都在重置中“均衡”时，可以消除很多小麻烦。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-26T20:39:19.417

输入总是会导致跨浏览器 css 出现问题。

我建议您使用良好的 css 重置和输入容器，例如

```
<div class="input-border">
    <input type="text" name="cokolwiek">
</div> 
```

它打破了几个规则 - “不要混合 html 和样式”，但它有效；]

记住 :focus 大纲。

# java - 提高立方体引擎性能

> ID：14035399
> 
> 赞同：1
> 
> 时间：2012-12-26T02:27:04.980
> 
> 标签：java, opengl

现在我正在使用基本的即时模式来渲染 4096 个立方体并进行面部剔除。无论有没有面部剔除，我的平均速度为 50 fps。为什么启用它时获得与禁用时相同的 fps？我还能做些什么来提高性能？另外，我应该使用索引 VBO 来渲染立方体吗？有谁知道一个好的 VBO 教程（最好是 LWJGL 中的 Java）。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-26T07:48:28.837

对于大量几何图形，即时模式相当慢。我个人从未进行过基准测试，但这是我在不同资源和 OpenGL 专家那里读到的内容。此外，使用可编程管道也很有意义，您不需要推送当您使用缓冲区时，将每个帧上的顶点数据传输到 GPU。所以我建议您首先转向现代 OpenGL，因为它比旧的固定实现既快又强大得多。使用缓冲区和着色器将有很大的灵活性.现在，为了让你开始，我建议你看看[这个](http://www.arcsynthesis.org/gltut/)教程系列。如果你想知道如何编写一个基本的渲染引擎，你可以看看[这个](http://nopper.tv/graphicsengine.html)开源项目，具有非常简单的基于 OpenGL 4.0 的渲染系统。它是 C++ 而不是 Java，但 API 与 LWJGL 相同。据我个人使用 LWJGL 的经验，只有缓冲区创建不同。另外，如果你想要 LWJGL 现代 OpenGL 教程，[这里](https://code.google.com/r/zaphosmatthewnicholls-opengl-superbible-java/)有一个很好的资源，它基于 OpenGL SuperBible 5 书籍代码库。[这个](https://github.com/integeruser/gltut-lwjgl)是上面提到的 Jason L. McKesson 的现代 OpenGL 教程的 LWJGL 端口。希望它有所帮助.

# django - NoReverseMatch Django：关键字参数

> ID：14035404
> 
> 赞同：0
> 
> 时间：2012-12-26T02:28:35.717
> 
> 标签：django, django-urls

为什么会返回`NoReverseMatch`？

html:

```
{% url vote thing.id thing.slug %} 
```

网址.py：

```
url(r'^vote/(?P<object_id>\d+)/(?P<slug>[w\-]+)/$', 'app.views.the_view', name='vote'), 
```

视图.py：

```
def the_view(request, object_id, slug):
    thing_list = Thing.objects.all()
    return render(request, 'vote.html', {'thing_list':thing_list}) 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-26T03:20:22.943

您必须使用以下内容：

```
{% url vote object_id=thing.id slug=thing.slug %} 
```

因为您已经在模式中明确命名了匹配的组。

请注意，从 Django 1.5 开始，您必须执行以下操作：

```
{% url 'vote' .. %} 
```

代替：

```
{% url vote ..%} 
```

在此处的 django 文档中查看它[https://docs.djangoproject.com/en/dev/ref/templates/builtins/?from=olddocs#url](https://docs.djangoproject.com/en/dev/ref/templates/builtins/?from=olddocs#url)

# ember.js - 从模型数组中动态填充/绑定带有列表项的出口？

> ID：14035406
> 
> 赞同：0
> 
> 时间：2012-12-26T02:28:53.497
> 
> 标签：ember.js

我想要一个数组元素并用列表格式填充一个插座。我想知道什么是最好的做法，拜托。我有一个非常简单的应用程序，我在“ColorModel”中声明了一个颜色数组。我想用这个数组中的所有颜色动态填充/绑定“home”（data-template-name）中标记为“homeContent”的出口。我不确定在哪里以及如何动态绑定内容，内容应该绑定到“App.ColorController”吗？我已经进行了在线搜索并得到了一些提琴，但这些方法并不是直截了当的。我感谢您的所有帮助。谢谢。

这是小提琴：http: [//jsfiddle.net/exciter/sqJEh/](http://jsfiddle.net/exciter/sqJEh/)

应用代码：

```
$(function(){

    App = Ember.Application.create({
        ready: function(){
            alert("APP INIT");
        }
    });

    //APP 
    App.ApplicationController = Ember.Controller.extend();
    App.ApplicationView = Ember.View.extend({
        templateName: "application",
        classNames: ['']
    });

    //NAVBAR
    App.HomeController = Ember.Controller.extend();
    App.HomeView = Ember.View.extend({
        templateName: "home",
        classNames: ['']
    });

    //MODELS

    //COLORS
    App.ColorModel = Ember.Object.create({
        //COLOR ARRAY
        var colorArr: Ember.A(["Orange","Blue","Green","Yellow","White","Grey","Purple","Silver","Black","Maroon","Sunburst"]);
    });

    App.ColorController = Ember.Controller.extend();
    App.ColorView = Ember.View.extend({
        templateName: '',
        classNames: ''
    }); 

    App.Router = Ember.Router.extend({
        enableLogging: true,
        location: 'hash',

        root: Ember.Route.extend({
            //EVENTS
            gotoHome: Ember.Route.transitionTo('home');

            home: Ember.Route.extend({
                router: '/',
                connectOutlets: function(router, context){
                    router.get('applicationController').connectOutlet('home');
                }
            }),
        })
    });
    App.initialize();
}); 
```

HTML 代码：

```
<script type="text/x-handlebars" data-template-name="application">

</script>

<script type="text/x-handlebars" data-template-name="home">
    {{outlet homeContent}}
</script> 
```

以下是问题：

在您的小提琴中，您有颜色数组：

```
var colors = ["Orange","Blue","Green",
               "Yellow","White","Grey",
               "Purple","Silver","Black",
               "Maroon","Sunburst"] 
```

我一直在以这种方式声明数组：

```
var color: Ember.A(["Orange","Blue","Green",
               "Yellow","White","Grey",
               "Purple","Silver","Black",
               "Maroon","Sunburst"]) 
```

**问题 1：** Ember 宣扬的最佳实践是什么？

在你的小提琴的 HTML 中

```
<script type="text/x-handlebars" data-template-name="home">
   {{#each color in controller}}
     {{color}}           
   {{/each}}
</script> 
```

我知道“颜色”来自哪里，但是您在哪里有 {{#each color in controller}}，

**问题2：** 那个“颜色”是从哪里来的？它是一个for-in循环吗？

**问题 3：** 据我了解，视图之间的所有交互都是通过控制器完成的，因此，如果我需要声明一个函数，该函数会将“点击事件”绑定到 HTML 中的每种颜色，是否应该在其中声明所有此类函数它的控制器？

**问题 4：** 关于列表项 HTML 表示，如果需要动态生成列表项，应该在哪里声明？

我很抱歉用这些问题轰炸你，我已经通过文档和无尽的线程，但这些信息几乎没有在任何地方讨论过。每个人都想演示他们的排骨，但他们几乎没有触及表面。甚至官方文档也缺乏这样的细节。感谢您的所有帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-26T09:45:36.283

我认为您必须从：[http](http://trek.github.com/) ://trek.github.com/ 开始，它将回答您的大部分问题。在您的示例中，如果您想在应用程序视图中连接插座，则 {{outlet]] 应该在应用程序模板中。

调用时`applicationController.connectOutlet('home')`，Ember.js 将：

*   在与应用程序相关的视图模板中搜索 {{outlet}}（此处为`application`模板）
*   搜索一个名为 HomeController 的控制器，创建一个名为 HomeView 的视图并连接它们。

请参见下面的示例，其中我在 connectOutlet 方法中添加 HomeController 中的内容：

[http://jsfiddle.net/sqJEh/19/](http://jsfiddle.net/sqJEh/19/)

**更新**回答问题：

*   **1**：默认情况下，您不需要将数组包装在 Ember.A() 函数中，因为 Ember.js 通过扩展数组原型来为您完成。`[]`Ember Array 也是如此。

*   **2**：是的，{{#each}} 助手提供了一种 forEach 循环[http://emberjs.com/api/classes/Ember.Handlebars.helpers.html#method_each](http://emberjs.com/api/classes/Ember.Handlebars.helpers.html#method_each)。控制器是一个 ArrayController（基本上代理一个数组）。在此示例中，控制器是`homeController`实例，在 connectOutlet 期间由颜色填充。所以在做的时候`{{#each color in controller}}`，我只是通过控制器循环遍历颜色数组。

*   **3**：这里有点难回答，因为我认为有几种方法可以处理用户交互。这取决于你想做什么。

    *   如果它只处理视图问题（例如通过 jquery 进行 css 或 dom 操作，那么我将为每种颜色创建一个子视图（使用 {{#each}} 帮助器的 itemViewClass）并定义一个`onClick`事件处理程序。
    *   如果您必须与数据交互，那么您可以使用 {{action}} 助手。在基于路由器的应用程序中，动作的目标将是在路由器的当前状态中定义的处理程序。在这里您可以查找其他控制器/模型并做您想做的事情。
    *   如果您想混合使用两者，则`onClick`在视图中定义处理程序，并使用 router.send('yourAction') 将操作重定向到路由器
*   **4**: I don't understand what you mean by `dynamically generated`, so unfortunately I can't give hint here :(.

# javascript - jQuery HTML 元素选择器说明

> ID：14035409
> 
> 赞同：2
> 
> 时间：2012-12-26T02:29:18.660
> 
> 标签：javascript, jquery, html, jquery-selectors

我想知道这两个 jQuery 选择器有什么区别：

*   `$("span")`
*   `$("<span>")`

我知道前者用于选择页面中提供的 HTML 标记类型的*所有*元素（在[jQuery 元素选择器文档](http://api.jquery.com/element-selector/)中指定）。我不确定后一个选择器的作用。

抱歉，如果这个问题是重复的。如果是这样，请张贴重复问题的 URI。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-26T02:33:36.150

```
$("span") //Finds all span
$("<span>") //Create a span element 
```

**[看到这个答案：jQuery document.createElement 等价物？](https://stackoverflow.com/questions/268490/jquery-document-createelement-equivalent)**

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-26T02:30:36.630

第一个出去并找到所有现有`span`元素。第二个创建一个新`span`元素，包装在一个 jQuery 对象中。

```
$("span").css("color", "red"); // Make all current <span> elements red
$("<span>").text("Foo").appendTo("body"); // Create new <span>, add to <body> 
```

### 可选的第二个参数

两者都可以接受第二个参数。在第一个的情况下，第二个参数是上下文：

```
$("span", "#foo"); // Becomes $("#foo").find("span"); 
```

在第二种情况下，第二个参数是一个由属性组成的对象文字：

```
$("<span>", { 
    "html": "This is the HTML", 
    "class": "newSpan"
}).appendTo("body"); 
```

这类似于调用单独的方法来设置 html 和属性：

```
$("<span>")
    .html("This is the HTML")
    .attr("class", "newSpan")
    .appendTo("body"); 
```

# java - 用Java写入文本文件

> ID：14035413
> 
> 赞同：3
> 
> 时间：2012-12-26T02:30:02.340
> 
> 标签：java, android, file, save

我有一个应用程序需要（可能是一目了然）经验丰富的 Java 专业人士。引擎运行良好，但我无法将数据保存到文本文件；此外，每次调试文件操作时，我都必须绑定我的平板电脑，卸载旧应用程序，复制apk并重新安装，因为我无法在模拟器中写入磁盘。

我补充说：

```
<uses-permission android:name="android.permission.WRITE_EXTERNAL_STORAGE"/> 
```

到应用程序标签之外的清单，并尝试了许多写入文件的方法。例外是（取决于当前尝试）eacces 或文件不存在。我也整天在谷歌上寻找解决方案。有人知道吗？

```
// this is a canned method that should presumably work
 private void writeStringToTextFile(String s, String f){
File sdCard = Environment.getExternalStorageDirectory();
File dir = new File (sdCard.getAbsolutePath());
dir.mkdirs();
File file = new File(dir, f);
try{
    FileOutputStream f1 = new FileOutputStream(file,false); //True = Append to file, false = Overwrite
    PrintStream p = new PrintStream(f1);
    p.print(s);
    p.close();
    f1.close();
} catch (FileNotFoundException e) {
} catch (IOException e) {
}   }

// this is the save method
// it has been modified a little less than a million times today
// some lines may be unnecessary because I have tried several approaches
  public void saveSystem(View view){
          String s="";
          String FILENAME = "data/data/TopExpertAndroid/" + fileName;
          FileOutputStream f;
          File file = new File(FILENAME);
          if(!(file.exists())){
             try{
                 file.createNewFile();} 
             catch(Exception e){
                showSplash(e.getMessage() + e.getCause(), "OK");
                return;}}
          try{
              getFile();
              if(fileName.equals("")){}
              else{
                   f = openFileOutput(FILENAME, Context.MODE_PRIVATE);
                   for(int temp=0; temp<50; temp++){
                       for(int loop=0; loop<50; loop++){
                           s += topExpert.nodeBank[temp][loop].activationResponse + "\n";
                           s += topExpert.nodeBank[temp][loop].display + "\n";
                           s += topExpert.nodeBank[temp][loop].falseLink + "\n";
                           s += topExpert.nodeBank[temp][loop].identifier + "\n";
                           if(topExpert.nodeBank[temp][loop].isTop){
                              s += "true";}
                           else{
                                s += "false";}
                           s += "\n" + topExpert.nodeBank[temp][loop].trueLink + "\n";}}
                           writeStringToTextFile(s,FILENAME);
              }}
          catch(Exception e){
                showSplash(e.getMessage() + e.getCause(), "OK");}} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-26T02:38:05.013

该`FILENAME`变量可能`/`在开头缺少 a ：

```
String FILENAME = "/data/data/TopExpertAndroid/" + fileName; 
```

你可能应该使用[getDataDirectory](http://developer.android.com/reference/android/os/Environment.html#getDataDirectory%28%29)或[getExternalStorageDirectory](http://developer.android.com/reference/android/os/Environment.html#getExternalStorageDirectory%28%29)来代替......

但是你所说的无法写入模拟器的磁盘似乎很奇怪......？

# php - 为什么 PHP 在运行脚本时看不到 sqlite 库？

> ID：14035415
> 
> 赞同：1
> 
> 时间：2012-12-26T02:30:09.720
> 
> 标签：php, sqlite

我正在尝试用 PHP 和 sqlite 做一些事情。我已经加载了 sqlite3 和 pdo_sqlite3 库（根据 php -m），php.ini 添加了库，但我仍然得到该函数（无论是 sqlite_open() 还是 sqlite_versioninfo()）的致命错误没找到。phpinfo() 显示两个库都已加载。那么为什么我不能使用它们呢？

关于我的设置的一些信息：

我在 debian 上运行，我正在运行 Apache2 和 PHP 5.4.4-4。我不记得我是如何安装 PHP 的（显然不是通过 apt-get），但它是通过 Apache 启动的。

的输出`php -m`：

> root@ns:~# php -m [PHP Modules] bcmath bz2 calendar Core ctype curl date dba dom ereg exif fileinfo filter ftp gettext hash iconv imagick json libxml mbstring mhash mysql mysqli openssl pcntl pcre PDO pdo_mysql pdo_sqlite Phar posix Reflection session shmop SimpleXML soap套接字 SPL sqlite3 ssh2 标准 sysvmsg sysvsem sysvshm 标记器 wddx xml xmlreader xmlwriter zip zlib
> 
> [Zend 模块]

确切的错误文本是`PHP Fatal error: Call to undefined function sqlite_libversion() in [file] on line 14`，它通过命令行和网络服务器发生。

如果我觉得还有什么要补充的，我会在这里补充。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-26T02:57:03.543

您使用来自[sqlite](http://php.net/manual/en/book.sqlite.php)扩展的函数，但您启用了单独的[sqlite3](http://php.net/manual/en/book.sqlite3.php)扩展。

pdo_sqlite3 仅适用于 pdo。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-26T02:33:05.583

如果你是用 php-fpm 运行 php，并且在 php-fpm 启动后编译了库，你应该重启 php-fpm，新的库才会生效。

# activerecord - 如何使用 ActiveRecord 将 STI 表中的不同类组合成一个结果集？

> ID：14035421
> 
> 赞同：5
> 
> 时间：2012-12-26T02:30:38.920
> 
> 标签：activerecord, ruby-on-rails-3.2, sti, finder-sql

我们正在构建一个创建类似于 Facebook 的群组页面的群组页面的应用程序。有人可以在页面上发帖，并且该帖子可以有回复。由于它们具有非常相似的属性，因此帖子和回复被合并到同一个 STI 表中

```
class Page < ActiveRecord::Base
  has_many :posts
  has_many :replies, through: :posts
end

class BasePost < ActiveRecord::Base
  ...
end

class Post < BasePost
  belongs_to :page
  ...
end

class Reply < BasePost
  belongs_to :post
  ...
end 
```

### 我希望能够得到`page.posts_and_replies`

为了找到页面的“最喜欢的帖子或回复”之类的内容，我们必须将帖子和回复结合起来，以便我们可以获得结果集，例如：

```
top_messages = page.posts_and_replies.order_by('total_likes DESC').limit(10) 
```

### 将帖子和回复放在一起很棘手

`posts_and_replies`尽管我们通常需要基于单个连接查询它们，但要作为单个结果集进行排序：

```
class Page < ActiveRecord::Base
  has_many :posts
  has_many :replies, through: :posts
  has_many :posts_and_replies, class_name: 'BasePost'
end

# ideally we could then do queries such as
most_recent_messages = @page.posts_and_replies.order('created_at DESC').limit(10) 
```

我们不能这样做，因为`page_id`只存在于`posts`. “回复”仅通过他们所属的帖子引用该页面。所以这个加入给了我们帖子而不是回复。

* * *

## 可能的解决方案：

### 对数据进行非规范化...

我们可以将其复制`page_id`到回复和帖子上，但如果可能的话，我真的很想避免这样做，因为非规范化的数据往往会以泪水告终。

### 使用自定义`finder_sql`

我们可以使用自定义查找器 sql 来分别获取帖子和回复，然后将它们组合起来：

```
class Page < ActiveRecord::Base
  has_many :posts
  has_many :replies
  has_many :posts_and_replies, class_name: 'BasePost', finder_sql: Proc.new{ 
    "select base_posts.* from base_posts 
      where page_id = #{self.id}
    UNION
      select 
      base_posts.*
      from base_posts left join base_posts as head_posts
      on base_posts.post_id = head_posts.id
      where head_posts.page_id = #{self.id}"
  }
end 
```

### 自定义 finder_sql 有效，但不适用于关联扩展

上面的 finder_sql 实际上确实有效，但是没有一个关联扩展有效。每当我尝试使用关联扩展（例如`.where`）时，它都会退回到内置的 finder_sql：

***这有效***

```
 Page.find(8).posts_and_replies
 => select base_posts.* from base_posts 
      where page_id = 8
    UNION
      select 
      base_posts.*
      from base_posts left join base_posts as head_posts
      on base_posts.post_id = head_posts.id
      where head_posts.page_id = 8 
```

***然而，这又回到了不正确的 finder_sql***

```
 Page.find(8).posts_and_replies.where('total_likes > 1')
  => select "base_posts".* from "base_posts" where "base_posts"."page_id" = 8 
     and (total_likes > 12) 
```

由于某种原因，关联扩展没有使用正确的`finder_sql`

### 如何让关联扩展尊重声明的 finder_sql？

问题似乎归结为未正确使用 finder_sql 的关联扩展。有什么办法可以强制执行吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-21T22:36:18.583

解决此问题的最简单方法可能是使用一些命名范围，并完全避免关联。这是一种有点笨拙的方法，但可能会给你你正在寻找的东西——我不确定 Rails 关联是否真的会给你你想要的行为。另外，请注意下面我将使用 ActiveRecord 的安全参数插值 - 你**永远**不应该自己将字符串插值到 SQL 语句中 - 它会在你不注意的时候召唤邪恶的灵魂来感染你的数据库。

首先，您将在 BasePost 模型中定义一个命名范围，该范围执行以下操作：

```
class BasePost < ActiveRecord::Base

  scope :popular_posts_for_page, lambda { |page_id|
    where("base_posts.page_id = ? OR parent_posts.page_id = ?", page_id, page_id).
     joins("left outer join base_posts parent_posts on parent_posts.id = base_posts.post_id").
     order("total_likes DESC")
  }

end 
```

这里还有一个好处是你现在还不会得到一个实际的列表，只有一个范围代理。如果你愿意，你现在可以将你的限制或任何你想要的语句链接到它上面。

如果您希望它可以在您的 Page 模型上访问，一种方法是：

```
class Page < ActiveRecord::Base

  def popular_posts_and_replies
    BasePost.popular_posts_for_page(self.id)
  end

end 
```

由于您之前将其定义为命名范围，并且该范围将返回一个范围对象，而不是实际的结果列表 - 它与关联非常接近，以至于差异应该是不可见的。例如：

```
my_page.popular_posts_and_replies.limit(10) 
```

应该完全按照你的预期去做。

对于我的 SQL 中的任何错误，我深表歉意。

# java - Java，Android字体似乎质量很低

> ID：14035424
> 
> 赞同：2
> 
> 时间：2012-12-26T02:30:50.290
> 
> 标签：java, android, fonts

我正在用 java 创建这个 android 游戏，并且已经开始经常使用字体，但它们的质量似乎非常低，当然，尤其是当你把它们变大的时候。我正在使用androids标准字体。有没有办法提高字体质量，如果我下载/创建了自定义字体，它们的质量会一样低吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-26T04:55:02.800

如果您自己绘制文本（而不是使用 TextView），请确保您在 AndroidManifest.xml 中`minSdkVersion`进行了设置。至关重要。如果不设置，你绘制的文本可能会被错误地缩放。`targetSdkVersion``targetSdkVersion``targetSdkVersion`

```
<uses-sdk android:minSdkVersion="8" android:targetSdkVersion="16"/> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-27T13:26:22.073

这就是我画弦的方式：

```
public class ImprovedString 
{
    private String mText;
    private Paint mPaint;
    private float mPosX, mPosY, mOffsetX, mOffsetY;
    private Rect mBounds;

    public ImprovedString(String text,int textSize, int color, Align align, Typeface typeface, float posX, float posY)
    {
        mText = text;
        mPosX = posX;
        mPosY = posY;

        mBounds = new Rect();

        mPaint = new Paint();
        mPaint.setColor(color);
        mPaint.setTextSize(textSize);
        mPaint.setTypeface(typeface);
        mPaint.setTextAlign(align);
        mPaint.getTextBounds(mText, 0, mText.length() - 1, mBounds);
    }

    public void draw(Canvas canvas, int width, int height)
    {
        canvas.drawText(mText, (mPosX + mOffsetX) * width, (mPosY + mOffsetY) * height + mBounds.height() / 2, mPaint);
    }

    public void setText(String t)
    {
        mText = t;
    }

    public void offSet(float x, float y)
    {
        mOffsetX = x;
        mOffsetY = y;
    }

    public Rect getBounds()
    {
        return mBounds;
    }
} 
```

# python - .join() 函数返回 int 而不是 str。什么地方出了错？

> ID：14035425
> 
> 赞同：0
> 
> 时间：2012-12-26T02:31:12.733
> 
> 标签：python, join, typeerror

```
index = 0
manage = {}
filedata = open(custom_path,'r')
for status in filedata:
    manage[index] = status
    print manage[index]
    index += 1 
```

上述 print manage[index] 的输出是正确的，显示：

```
yes

yes

yes

yes

yes 
```

然后，我添加了一个新行：manage = str(u'\n,'.join(manage))

并得到以下错误：

```
TypeError: sequence item 0: expected string, int found 
```

将我的代码更改为：

```
values = ','.join(str(status) for status in manage)

print values 
```

并得到以下输出（这是错误的）：

```
0,1,2,3,4 
```

我期待：是的，是的，是的，是的，是的

知道我哪里出错了吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-26T02:36:40.473

您正在迭代字典中的键而不是值。

尝试更改此行：

```
values = ','.join(str(status) for status in manage) 
```

对此：

```
values = ','.join(val.rstrip("\n") for val in manage.values()) 
```

这也是您收到该错误的原因，因为您尝试使用您的密钥。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-26T02:36:55.047

这是因为manage 是一个字典而不是一个列表，定义在

```
manage = {} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-26T02:37:08.163

`manage`是具有整数键的字典。for 循环遍历字典键。将其更改为：`','.join(line.strip() for line in manage.values())`。

# java - 使用 source/build/target/product/security/ 中的密钥将 apk 签名为系统

> ID：14035426
> 
> 赞同：8
> 
> 时间：2012-12-26T02:31:20.793
> 
> 标签：java, android, apk, keystore, android-keystore

正如标题所述，我正在尝试使用 platform.x509.pem 和 platform.pk8 对我的应用程序进行签名。问题是我在使用 keytool-importkeypairs 添加这些时遇到错误，如下所示：

```
keytool-importkeypair -k ~/.android/debug.keystore -p android -pk8 platform.pk8 -cert platform.x509.pem -alias platform 
```

当我尝试使用 SignApk.jar 直接对 APK 进行签名时，我也会遇到错误，如下所示：

```
java -jar SignApk.jar platform.x509.pem platform.pk8 test-app.apk test-app-signed.apk 
```

Keytool-importkeypairs 错误：

```
Error decrypting key
3074042056:error:0D0680A8:asn1 encoding routines:ASN1_CHECK_TLEN:wrong tag:tasn_dec.c:1319:
3074042056:error:0D07803A:asn1 encoding routines:ASN1_ITEM_EX_D2I:nested asn1 error:tasn_dec.c:381:Type=PKCS8_PRIV_KEY_INFO
unable to load private key
3074091208:error:0906D06C:PEM routines:PEM_read_bio:no start line:pem_lib.c:696:Expecting: ANY PRIVATE KEY
Importing "platform" with unable to load certificate
3073755336:error:0906D06C:PEM routines:PEM_read_bio:no start line:pem_lib.c:696:Expecting: TRUSTED CERTIFICATE
keytool error: java.lang.Exception: Source keystore file exists, but is empty: /tmp/keytool-importkeypair.vDOP/p12 
```

使用的来源：[具有系统权限的 Apk](http://paulononaka.wordpress.com/2011/10/19/apk-with-system-privileges/)，[如何使用系统签名对 Android 应用程序进行签名？(SO)](https://stackoverflow.com/questions/3635101/how-to-sign-android-app-with-system-signature)以及[如何将 android dev phone 2 从 1.6 更新到 2.1](http://groups.google.com/group/Android-DevPhone-Updating/tree/browse_frm/month/2010-04?_done=/group/Android-DevPhone-Updating/browse_frm/month/2010-04?&&pli=1)
如您所见，上面链接中描述的方法现在都不起作用。提前致谢。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-12-26T04:04:38.477

首先检查文件的格式（使用`cat`等），错误表明它们不是预期的格式（ASN.1/PEM）。

更重要的是，使用这些键几乎没有任何意义。这些只是*示例*密钥，任何自尊的自定义 ROM 都将使用自己的*私钥*。*否则，几乎任何人都可以使用 AOSP 中的公钥*签署他们的 APK，并获得他们想要的任何特权。不用说，这是一件*非常糟糕的事情*。如果您需要开发一个使用系统权限的应用程序并希望它在所有（或大多数）root 手机和自定义 ROM 上运行，那么正确的方法是请求 root 访问权限`su`并执行您需要在 root 中执行的任何操作壳。当然，如果用户授予您权限。

编辑：

要调试导入错误，请逐步运行此操作。它确实适用于默认的 AOSP 密钥。

```
$ openssl pkcs8 -inform DER -nocrypt -in platform.pk8 -out platform.pem
$ openssl pkcs12 -export -in platform.x509.pem -inkey platform.pem -out platform.p12 -password pass:android -name platform 
$ keytool -importkeystore -deststorepass android -destkeystore test.keystore -srckeystore platform.p12 -srcstoretype PKCS12 -srcstorepass android 
$ keytool -list -v -keystore test.keystore 
```

它能做什么：

1.  将 PKCS#8 格式的二进制密钥转换为 PEM ( `openssl pkcs8`)
2.  创建包含私钥和证书的 PKCS#12 文件 ( `openssl pkcs12`)
3.  由于 Java`keytool`可以将 PKCS#12 文件作为密钥库读取，因此它会导入您的 PKCS#12 文件以有效地将其转换为本机格式（BKS 或 JKS）（`keytool -importkeystore`）
4.  （奖励）用于`keytool`列出内容以确保一切正常。( `keytool -list`)

# java - GWT DialogBox 生成自身的多个副本

> ID：14035427
> 
> 赞同：0
> 
> 时间：2012-12-26T02:31:29.533
> 
> 标签：java, gwt, dialog

以下是两个内部类，当用户单击相应按钮时，它们会弹出一个简单的 DialogBox。然后，他们更新 List 中的值，该 List 填充接口上的 ListBox。

我注意到，在大多数情况下，对话框似乎会弹出与 ListBox 的当前索引/选定值一样多的自身副本——但并非总是如此。有时只弹出一个对话框。有任何想法吗？如果需要，我可以提供更多代码。

```
 public class EditCustomerHandler implements ClickHandler {
        public EditCustomerHandler() {}
        public void onClick(ClickEvent event) {

            final DialogBox editCustDialog = new DialogBox();
            editCustDialog.setHTML(customer.getName());

            FlexTable content = new FlexTable();
            FlexTable buttonPanel = new FlexTable();
            final TextBox customerNameTextBox = new TextBox();
            content.setText(0, 0, "Name: ");
            content.setWidget(0, 1, customerNameTextBox);

            Button saveButton = new Button("Save");
            saveButton.addClickHandler(new ClickHandler() {
                public void onClick(ClickEvent event) {
                    if (!customer.getName().equals(customerNameTextBox.getText())) {
                        customer.setName(customerNameTextBox.getText());
                        editCustDialog.hide();
                        stationService.saveCustomer(customer, new DefaultAsyncCallback<String>() {
                            public void onSuccess(String errorCode) {
                                if (errorCode != null) {
                                    MessageBox.showMessage("Error", errorCode);
                                    return;
                                }
                                refreshCusts();

                            }
                        });
                    }
                    }               
            });
            Button cancelButton = new Button("Cancel");
            cancelButton.addClickHandler(new ClickHandler() {
                public void onClick(ClickEvent event) {
                    editCustDialog.hide();                  
                }               
            });

            buttonPanel.setWidget(0, 0, saveButton);
            buttonPanel.setWidget(0,1, cancelButton);
            content.getFlexCellFormatter().setColSpan(1, 0, 2);
            content.getCellFormatter().setHorizontalAlignment(1,0, HasHorizontalAlignment.ALIGN_CENTER);
            content.setWidget(1,0, buttonPanel);
            editCustDialog.add(content);
            editCustDialog.center();
            editCustDialog.setGlassEnabled(true);
            editCustDialog.setModal(false);
            editCustDialog.show();

        }
    }

    public class PlusCustomerHandler implements ClickHandler {
        public PlusCustomerHandler() {}
        public void onClick(ClickEvent event) {
            final DialogBox plusCustDialog = new DialogBox();
            plusCustDialog.center();
            plusCustDialog.setModal(false);
            plusCustDialog.setGlassEnabled(true);
            plusCustDialog.setHTML("New Customer");
            final TextBox customerNameTextBox = new TextBox();
            final FlexTable content = new FlexTable();
            final FlexTable buttonPanel = new FlexTable();
            final Button saveButton = new Button("Save");
            saveButton.addClickHandler(new ClickHandler() {
                public void onClick(ClickEvent event) {
                    if (!customerNameTextBox.getText().equals("")) {
                    SMSCustomer newCustomer = new SMSCustomer();
                    newCustomer.setName(customerNameTextBox.getText());
                    stationService.saveCustomer(newCustomer, new DefaultAsyncCallback<String>() {
                        public void onSuccess(String errorMsg) {
                            if (errorMsg == null) {
                                refreshCusts();
                                plusCustDialog.hide();
                            }
                        }

                    });
}
                    else {
                        MessageBox mb = new MessageBox();
                        mb.showMessage("Yo dawg", "Customers must have names!");

                    }
                    }});

            Button cancelButton = new Button("Cancel");
            cancelButton.addClickHandler(new ClickHandler() {
                public void onClick(ClickEvent event) {
                    plusCustDialog.hide();                  
                }               
            });

            content.setText(0, 0, "Name: ");
            content.setWidget(0, 1, customerNameTextBox);
            buttonPanel.setWidget(0, 0, saveButton);
            buttonPanel.setWidget(0,1, cancelButton);
            content.getFlexCellFormatter().setColSpan(1, 0, 2);
            content.getCellFormatter().setHorizontalAlignment(1,0, HasHorizontalAlignment.ALIGN_CENTER);
            content.setWidget(1,0, buttonPanel);
            plusCustDialog.add(content);

            plusCustDialog.show();
            }
        } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-26T03:40:40.753

您在类的方法内创建一个对话框`.onClick()`。请注意，您在对话框中添加了 final，但这并不意味着新的 ClickHandler 不会多次添加到您的 saveButton 和 cancelButton。实际上，每次`.onClick()`触发此方法时，您都会构建此 DialogBox。

更好的方法是这样的：

```
DialogBox editCustDialog;

public void onClick(ClickEvent event) {
    if (editCustDialog == null) {
        buildEditCustDialog();
    }
    editCustDialog.show(); // or, editCustDialog.center();
}

private void buildEditCustDialog() {
    editCustDialog = new DialogBox();
    // etc.
} 
```

# jquery - 将一个空对象传递给 jQuery 函数

> ID：14035428
> 
> 赞同：2
> 
> 时间：2012-12-26T02:31:35.197
> 
> 标签：jquery

在阅读 Ben Alman 的 Pub/Sub 库时，我对他将一个空对象传递给 jQuery 函数的第一行感到困惑。此外，他使用绑定函数对象只是将它应用于那个几乎“空”的对象（我使用 firebug 来检查该对象，它只返回一个包含空对象的 jQuery 对象）。有人可以为我解释这个逻辑吗？非常感谢！P/S：我了解 Pub/Sub 模式在非框架上下文中的用法和想法，只是不了解它在 jQuery 中的实现。

这是我读过的库代码：

```
 (function($){
    var o = $({});
    $.subscribe = function() {
        o.bind.apply( o, arguments );
    };
    $.unsubscribe = function() {
        o.unbind.apply( o, arguments );
    };
    $.publish = function() {
        o.trigger.apply( o, arguments );
    };
 })(jQuery); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-26T02:46:51.317

当您创建元素的 jQuery 对象时...最终对象包括所有 jQuery 方法

过度简化的例子：

```
{ element: 'div'
    jQuery:{
      hide:function(){},
      animate:function(){}
       on:function(){}
    }

} 
```

演示代码中的空对象用于能够做同样的事情。一旦它被包装起来，`$()`它就可以绑定 jQuery 事件处理程序，因为该对象包含许多 jQuery 方法（不是全部）作为属性

你可以写：

```
o.on('myCustomeEvent',doSomething); 
```

在另一部分代码中

```
o.trigger('myCustomeEvent'); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-26T02:40:27.087

它只是一种创建某种空容器来存储事件处理程序的方法。

一些 jQuery 方法也可以用于 DOM 元素以外的对象，如 [`jQuery`文档*^([docs])*](http://api.jquery.com/jQuery/)中所述：

> ### 使用普通对象
> 
> 目前，在 jQuery 中封装的纯 JavaScript 对象上支持的唯一操作是：`.data()`、`.prop()`、`.bind()`、`.unbind()`和. 在普通对象上使用（或任何需要的方法）将导致对象上的新属性称为（例如。）。`.trigger()``.triggerHandler()``.data()``.data()``jQuery{randomNumber}``jQuery123456789`
> 
> ```
> // define a plain object
> var foo = {foo:'bar', hello:'world'};
> 
> // wrap this with jQuery
> var $foo = $(foo);
> 
> // test accessing property values
> var test1 = $foo.prop('foo'); // bar
> 
> // test setting property values
> $foo.prop('foo', 'foobar');
> var test2 = $foo.prop('foo'); // foobar
> 
> // test using .data() as summarized above
> $foo.data('keyName', 'someValue');
> console.log($foo); // will now contain a jQuery{randomNumber} property
> 
> // test binding an event name and triggering
> $foo.bind('eventName', function (){
>     console.log('eventName was called');
> });
> 
> $foo.trigger('eventName'); // logs 'eventName was called' 
> ```
> 
> [...]

和[`.trigger`文档 *^([docs])*](http://api.jquery.com/trigger/)：

> 该`.trigger()`方法可用于包装普通 JavaScript 对象的 jQuery 集合，类似于 pub/sub 机制；触发事件时将调用绑定到对象的任何事件处理程序。

这正是代码中发生的事情：

*   `var o = $({});`从一个空的普通对象创建一个 jQuery 对象。
*   `o.bind.apply( o, arguments );`将事件处理程序绑定到该对象。
*   `o.trigger.apply( o, arguments );`触发绑定到该对象的事件处理程序。

# android - Android Sqlite 删除语句无法传递长参数

> ID：14035433
> 
> 赞同：0
> 
> 时间：2012-12-26T02:33:44.257
> 
> 标签：android, sqlite

> **可能重复：**
> [SQLite rawQuery selectionArgs 和 Integers 字段](https://stackoverflow.com/questions/11320434/sqlite-rawquery-selectionargs-and-integers-fields)

这是我的表架构

```
create table Account (accountId) // accountId is long in practice 
```

我无法使用 delete 的参数版本来删除给定长 id 的行。下面的 getPk() 返回一个长 id。

```
getDb().delete("Account", "accountId = ?", new String[]{ account.getPk().toString()}); 
```

但是，我可以通过在 where 子句中传递参数来解决这个问题。

```
getDb().delete("Account", "accountId = " + account.getPk().toString(), null); 
```

我的猜测是 delete 的参数版本适用于字符串参数，但不适用于整数/长参数。有什么见解吗？

**编辑：** 另一个奇怪的事情是，如果我将表模式更改为下面，删除的两个版本都可以正常工作。

```
create table Account (accountId integer primary key autoincrement) 
```

# sql - 如何防止在 SQL Server 中自动添加空白字符？

> ID：14035436
> 
> 赞同：0
> 
> 时间：2012-12-26T02:34:02.600
> 
> 标签：sql, sql-server

我的 Visual Studio 2012 网站项目中有关于 SQL Server 的问题。例如; 我有一个名为“user”的表，其中包含“name”（varchar(16)）和“surname”（varchar(16)）列。我添加了新数据，例如名称：“john” 姓：“holiday”，但 SQL Server 会自动用空格字符填充变量的其余部分。好像![](../Images/bfa72a82d37723cce231e5351c4cf2b1.png)。我怎样才能阻止这个？我希望我清楚地解释了我的问题。

```
protected void LoginButton_Click(object sender, EventArgs e)
{
    string connectionString = "Data Source=MYPC-PC\\SQLEXPRESS;Initial Catalog=fff;Integrated Security=True";
    SqlConnection connection = new SqlConnection(connectionString);
    try
    {
        connection.Open();
    }
    catch (Exception s)
    {
        FailureText.Text = s.ToString();
    }
    SqlCommand cmd = new SqlCommand("SELECT * FROM [person] WHERE user_name='" + UserName.Text + "' AND user_password='" + Password.Text + "' ", connection);

    SqlDataReader dr = null;
    dr = cmd.ExecuteReader();

    while (dr.Read())
    {
        if (this.CompareStrings(dr["user_name"].ToString(), UserName.Text) &&
            this.CompareStrings(dr["user_password"].ToString(), Password.Text))
        {
            FailureText.Text = "ok";
        }
        else
        {
            FailureText.Text = "no";
        }

    }
    connection.Close();
    dr.Close();
} 
```

例如，当我调试 "dr["user_name"]" 变量时，就像 watch 中的那样：![](../Images/3166dae1260ae4e82215f73f668cdc6d.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-26T02:48:58.010

您必须在创建表时使用了 ANSI_PADDING 设置。如果是这样，您将需要删除并再次创建表。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-26T05:19:35.717

`this.CompareStrings(dr["user_name"].ToString(), UserName.Text)--> dr["user_name"].ToString().Trim()`

如果有一些额外的空格，可能会解决您的问题

# javascript - Nginx 反向代理到 Node.js 并重写

> ID：14035440
> 
> 赞同：14
> 
> 时间：2012-12-26T02:34:50.907
> 
> 标签：javascript, node.js, nginx, express, reverse-proxy

我有几个应用程序在 Nginx 反向代理后面运行，其中一个是带有 Express.js 的节点服务器。我正在代理`domain.com/demo/app/<path>`使用`localhost:7003/<path>`这个 Nginx 配置：

```
http {

    ...

    server {

        listen 80;
        server_name domain.com;

        ...

        location /demo/app {

            proxy_set_header Host $host;
            proxy_set_header X-Real-IP $remote_addr;
            proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
            proxy_set_header X-Scheme $scheme;

            rewrite ^/demo/app/?(.*) /$1 break;
            proxy_pass http://localhost:7003;
        }

        ...
    }
} 
```

这很好用，并且`app`接收请求就好像它植根于`/`. 问题在于`app`处理它自己的静态文件，并且可能会请求路由，例如`css/app.css`或`images/image.jpg`. 但是由于反向代理，这些实际上分别存在于`/demo/app/css/app.css`和`/demo/app/images/image.jpg`。

我通过让 Nginx 向 Node 传递一个自定义标头来解决这个问题，该标头指示根路径，Node 服务器将其添加到所有后续请求的 URL 之前。但是现在我的代码中到处都是这些根路径字符串。例如，我的部分后端模板：

```
link(rel='stylesheet', href="#{basePath}/css/base.css")
link(rel='stylesheet', href="#{basePath}/css/skeleton.css")
link(rel='stylesheet', href="#{basePath}/css/layout.css") 
```

有什么更优雅的方式来处理这个问题？有没有办法让 Nginx 识别来自上游服务器的请求并自动将它们转发到该服务器？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-12-26T14:02:02.987

I have made nginx serve static files without even passing those requests to node by adding location directive to the app's nginx configuration file (which is included in nginx.conf):

```
location ~ /(img|js)/ {
    rewrite ^(.*)$ /public/$1 break;
}

location / {
    proxy_pass http://localhost:3000/;
    ...
} 
```

In case request comes to /img or /js directory nginx serves files from /public/img or /public/js directory respectively. All other requests are proxied to node.

You can add more directories if you need (like /css or /views, if you store templates there that you want to use both in node and in browser) and have any directory structure inside those directories, nginx just prepends /public to them and gets files from there without your node app even knowing about it.

# javascript - 用javascript重新排列一系列生成的div

> ID：14035441
> 
> 赞同：0
> 
> 时间：2012-12-26T02:34:59.687
> 
> 标签：javascript, jquery, html

我有一系列看起来像这样的生成产品

```
<div class="product"><div class="productImage" title="one"></div></div>
<div class="product"><div class="productImage" title="two"></div></div>
<div class="product"><div class="productImage" title="three"></div></div>
<div class="product"><div class="productImage" title="four"></div></div> 
```

有没有办法可以将它们放在一个数组中以使用 javascript 以不同的顺序显示它们？

想不通。有什么建议吗？

```
what I have right now
<div class="product">
    <div class="productImage" title="Elixer Altima">product image goes here with other shopping features</div>
</div>
<div class="product">
    <div class="productImage" title="Bain Oleo Relax">product image goes here with other shopping features</div>
</div>
<div class="product">
    <div class="productImage" title="Satin">product image goes here with other shopping features</div>
</div>
<div class="product">
    <div class="productImage" title="Hair Cream">product image goes here with other shopping features</div>
</div>

New Order to be
<div class="product">
    <div class="productImage" title="Hair Cream">product image goes here with other shopping features</div>
</div>
<div class="product">
    <div class="productImage" title="Satin">product image goes here with other shopping features</div>
</div>
<div class="product">
    <div class="productImage" title="Bain Oleo Relax"></div>
</div>
<div class="product">
    <div class="productImage" title="Elixer Altima">product image goes here with other shopping features</div>
</div> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-26T03:04:29.653

Assume you want titles in alphabetic order .

```
var $items= $('.product').detach();

$('#container').append( $items.sort( sortTitles));

function sortTitles(a,b){
    return a.title > b.title ? 1 :-1;

} 
```

Adjust sort function for other attributes as required

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-26T03:06:09.683

You can sort based on the text, html, attributes and more if you like. For instnace, if you wanted to sort based on the alphabetical order of the titles themselves, the following would work (I've added a `#products` parent element for demonstration purposes):

```
$("#products .product").sort(function(a,b){
    var _a = $(a).text(), _b = $(b).text();
    return _a > _b ? 1 : -1;
})​.appendTo("#products");​​​​ 
```

Fiddle: [http://jsfiddle.net/yxCWd/](http://jsfiddle.net/yxCWd/)

In your case, it appears you just want to reverse the natural order. This could be done any number of ways. One such way would be to use the `.reverse` method on the `Array` prototype to reverse the order of a collection, and then re-append the elements to their parent:

```
var container = $("#products");
container.append(container.find(".product").get().reverse());​ 
```

Calling `.get` converts our collection to an array, thus giving us the ability to call `.reverse`.

Fiddle: [http://jsfiddle.net/yxCWd/2/](http://jsfiddle.net/yxCWd/2/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-26T02:43:47.547

我很幸运这个[http://james.padolsey.com/javascript/sorting-elements-with-jquery/](http://james.padolsey.com/javascript/sorting-elements-with-jquery/)

# python - Python查询游戏服务器

> ID：14035448
> 
> 赞同：1
> 
> 时间：2012-12-26T02:36:07.457
> 
> 标签：python, django, udp, minecraft

我正在尝试使用由 Dinnerbone（游戏开发者之一）编写的 python 类查询 Minecraft 服务器。当我尝试查询它时，我收到错误消息“在数据报套接字上发送的消息大于内部消息缓冲区或其他网络限制，或者用于接收数据报的缓冲区小于数据报本身”。据我了解，这似乎是 UDP 本身的物理限制。

我不完全确定是什么原因造成的，或者我能做些什么。

该课程可以在这里找到：[https ://github.com/Dinnerbone/mcstatus/blob/master/minecraft_query.py](https://github.com/Dinnerbone/mcstatus/blob/master/minecraft_query.py)

感谢任何建议，因为错误不会显示在命令提示符窗口中，但是在通过 Django 运行时会出错。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-26T23:38:03.947

您遇到的问题是脚本试图将数据包读入一个太小而无法容纳它的缓冲区。这似乎发生在脚本的第 42 行：

```
buff = self.socket.recvfrom(1460)[0] 
```

尝试将缓冲区大小从 1460 更改为更大的值。

# jquery - 滚动到特定元素的底部而不破坏页面的其余部分

> ID：14035455
> 
> 赞同：2
> 
> 时间：2012-12-26T02:38:13.793
> 
> 标签：jquery, html, css

```
<div id="test" style="height:200px;overflow:scroll;">
  ...large amount text...
  <div id="bottom"></div>
</div> 
```

在整个会议期间，jQuery 将向`#test`.

问题是，一旦文本超过折叠，如果不手动滚动就看不到它。为了解决这个问题，我让它跳到`#bottom`. 问题是这会破坏页面的其余部分并导致它跳回，`#bottom`而不管用户当时可能在页面上的哪个位置。

如何使滚动保持在底部而不使窗口跳回`#bottom`？还有什么方法可以做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-26T02:48:40.927

我最近不得不做类似的事情。

每次注入更多文本时，您都可以运行它：

```
$("#test").scrollTop($("#test")[0].scrollHeight); 
```

这将滚动到测试 div 的底部。

# windows - 从程序集中调用 Windows API 但没有硬编码地址

> ID：14035456
> 
> 赞同：1
> 
> 时间：2012-12-26T02:38:27.473
> 
> 标签：windows, api, assembly, call, fasm

我在阅读 fasm 源代码时在 windows XP 环境中学习 fasm，我发现调用宏

```
invoke  MessageBox,0,[_strbuf],_msgcap,MB_ICONINFORMATION+MB_OK 
```

并导入宏。

```
import user,\
     MessageBox,'MessageBoxA',\
     wsprintf,'wsprintfA' 
```

但我找不到 MessageBoxA 的任何硬编码地址，也找不到在汇编代码中加载 user32.dll 。只有宏定义标记字符串而不是地址。

我的假设是这样

1.  有代码加载 user32.dll 并返回加载的 dll 的起始地址 => 这里，让我们调用返回的地址到位置 A

2.  有硬编码地址和标签对（例如 MessageBoxA = 0x00000000）

3.  所以指令'call'可以调用MessageBoxA标签（将转换为位置A + MessageBoxA偏移量）

我的假设错了吗？我想知道如何调用 API。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-26T03:42:32.770

[阅读 FASM 文档](http://flatassembler.net/docs.php?article=win32)，它解释了如何`MessageBoxA()`在 user32.dll 中引用。

然后阅读有关 Windows 可执行文件实际工作方式[的 MSDN 文档。](http://msdn.microsoft.com/en-us/magazine/ms809762.aspx)请特别注意有关 PE 文件导入的部分，该部分解释了如何在运行时解析导入的 DLL 函数的地址。

简而言之，`import`FASM 中的语句是在已编译的 EXE 文件中的查找表中设置一个条目。然后，当 EXE 在其代码开始运行之前加载到内存中时，操作系统会填写该查找表。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-26T03:36:18.327

这是免费的 Dependency Walker 工具的屏幕截图。

注意：有一个函数名，Ordinal 和 Entry Point。

所以是的，你推断的差不多。这些函数在运行时而不是在编译时链接。（DLL 动态**链接**库）。

![在此处输入图像描述](../Images/f97e9c71b29a8dde4464bdb03d84a424.png)

# jakarta-ee - 在 Intellij IDEA 12 创建的 Java EE 应用程序中为爆炸的 WAR 设置什么 web-uri？

> ID：14035458
> 
> 赞同：1
> 
> 时间：2012-12-26T02:38:46.273
> 
> 标签：jakarta-ee, intellij-idea, application.xml

如果我在 Intellij IDEA 12 中创建一个新的 Java EE 应用程序：

![新的 JavaEE Web 模块](../Images/11bc6ea6d1ba99bddf1307a6ee191eaf.png)

使用 Web 应用程序 2.5、JSF 2.0、应用程序服务器 Glassfish 3.1.2.2 和 Java EE 6：

![技术栈选择](../Images/97332da6e8d08d9feebffe65d395c7f6.png)

`application.xml`使用此文本作为其内容自动生成：

```
<?xml version="1.0" encoding="UTF-8"?>
<application xmlns="http://java.sun.com/xml/ns/javaee"
             xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
             xsi:schemaLocation="http://java.sun.com/xml/ns/javaee http://java.sun.com/xml/ns/javaee/application_6.xsd"
             version="6">

</application> 
```

此应用程序将无法成功部署，因为以下`<module>`标签缺失`application.xml`：

```
The content of element 'application' is not complete. One of
'{"http://java.sun.com/xml/ns/javaee":application-name,
"http://java.sun.com/xml/ns/javaee":description,
"http://java.sun.com/xml/ns/javaee":display-name,
"http://java.sun.com/xml/ns/javaee":icon,
"http://java.sun.com/xml/ns/javaee":initialize-in-order,
"http://java.sun.com/xml/ns/javaee":module}' is expected. 
```

IDE是否应该`module`自动添加标签？如果是这样，为什么没有呢？如果不是，如果我想使用默认工件，我应该将`web-uri`标签 ( ) 设置为什么？`<module><web><web-uri>``web:war exploded`

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-26T11:00:21.873

这是一个错误。如果您在第一步选择“Java 模块”而不是“JavaEE Web 模块”，然后在第二步选择“Web 应用程序”、“JavaEE 应用程序”和“应用程序服务器”，则应正确生成 application.xml 文件。

# javascript - 这个复杂的 return 语句在 javascript 中做了什么？

> ID：14035461
> 
> 赞同：2
> 
> 时间：2012-12-26T02:40:21.660
> 
> 标签：javascript

今天浏览[d3源码](https://github.com/mbostock/d3/blob/master/d3.js#L1970)看到下面一行：

```
return delay <= elapsed ? start(elapsed) : d3.timer(start, delay, time), 1; 
```

多年来，我每天都在做 javascript，但以前从未见过。什么嘿？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-12-26T02:41:38.003

它只是小于或等于。也许[三元运算符](http://en.wikipedia.org/wiki/?%3a)与[逗号运算](http://en.wikipedia.org/wiki/Comma_operator)符相结合是什么让你失望？

这相当于：

```
if (delay < elapsed) start(elapsed);
else if (delay === elapsed) start(elapsed);
else {
  d3.timer(start, delay, time);
}
return 1; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-26T02:41:40.830

只是意味着“小于或等于”。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-26T02:44:23.473

这意味着在几乎（*如果**不是全部*）语言中，左侧操作数是否*小于* **或** *等于*右侧操作数

 ** * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-26T02:42:54.487

<= 表示小于或等于。

您发布的完整行用简单的英文表示“如果延迟小于经过，则返回开始（经过），否则返回 d3.timer 的值。*

# javascript - 内联事件处理程序中未调用 JavaScript

> ID：14035463
> 
> 赞同：2
> 
> 时间：2012-12-26T02:40:49.173
> 
> 标签：javascript, forms

这是我的 JavaScript：

```
<script>
    //Make sure DOM is ready before mucking around.
    $(document).ready(function()
    {
        console.log('DOM is ready!');
        var socket = io.connect('http://localhost:8080');
        //Each document field will have the following identifiers:
        //classCode, description, professor, file
        function uploadForm()
        {
            console.log('Creating FileReader object...');
            var reader = new FileReader();
            reader.onload = function(evt)
            {
                console.log('Read complete.');
                console.log('Creating JSON object...')
                var documentData = 
                {
                    'classCode':$('#classCode').val(),
                    'professor':$('#professor').val(),
                    'description':$('#description').val(),
                    'file': 
                        {
                            'data': evt.target.result,
                            'metadata': document.getElementById('file').files[0]
                        },
                    'dateUploaded':new Date(),
                    'rating':0 
                };
                console.log(documentData);
                console.log('Adding document.');
                socket.emit('addDocument', documentData);
            };
            console.log('Reading as binary string...');
            reader.readAsDataURL(document.getElementById('file').files[0]);
        };
    });
</script> 
```

我的 HTML 表单：

```
<form onsubmit = 'uploadForm()'>
        <input type = 'text' placeholder = 'Class code' id = 'classCode' required/>
        <input type = 'text' placeholder = 'Document description' id = 'description' required/>
        <input type = 'text' placeholder = 'Professor' id = 'professor' required/>
        <input type = 'file' id = 'file' required/>
        <input type = 'submit' value = 'Upload!'/>
    </form> 
```

`uploadForm()`当我通过元素上的`.click`事件调用之前，此代码正在工作`<input type='submit'>`，但这会忽略`<form>`对元素的必需属性检查`<input>`。所以现在我试图调用`uploadForm()`的提交事件`<form>`，但它运行不正常。`reader.onload`事件应该在`reader.readDataAsURL()`完成后被调用，但事实并非如此。我已经尝试过 jQuery`.submit()`无济于事。

**编辑：**终于用我的手机记录了错误。`Uncaught ReferenceError: uploadForm is not defined`

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-26T02:59:02.250

The `uploadForm` function is not in global scope, hence it cannot be found. Just define the function *outside* of the `document.ready` callback or make it global by assigning it to a property of the `window` object:

```
window.uploadForm = function() {
    // ...
}; 
```

Or a better way, since you are using jQuery, is to bind the event handler with jQuery instead of using inline event handlers:

```
$('#yourFormID').on('submit', function() {
    // ...
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-26T03:20:00.447

DOM 看不到函数“uploadForm”，因为函数“uploadForm”是在另一个函数中定义的。在您的代码中，另一个函数意味着：`$(document).ready(function(){...})`。

在 jQuery 中，您可以像这样绑定事件：

HTML：

```
<form id="myFormID">
    ....
</form> 
```

JS：

```
<script>
    //Make sure DOM is ready before mucking around.
    $(document).ready(function()
    {
        console.log('DOM is ready!');
        var socket = io.connect('http://localhost:8080');
        //Each document field will have the following identifiers:
        //classCode, description, professor, file
        function uploadForm()
        {
            //....
        };

        // ↓↓↓↓↓Bind events here↓↓↓↓↓
        $("#myFormID").submit(uploadForm);
    });
</script> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-26T02:56:52.057

我认为您可以尝试对代码进行一些更改。

您的`uploadForm()`函数必须只有

`reader.readAsDataURL(document.getElementById('file').files[0]);`

所有其他的东西都可以在`document.ready()`;

这样，阅读器对象将准备就绪，当您调用该函数时，`readAsDataURL`它将触发 onLoad 事件。

尝试这个。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-26T02:46:34.667

Onsubmit 应设置为 uploadForm()（即您要评估的表达式），而不仅仅是您要执行的函数的名称。

# ruby-on-rails - 即使安装了 Spree 也找不到 ImageMagick

> ID：14035465
> 
> 赞同：2
> 
> 时间：2012-12-26T02:40:59.127
> 
> 标签：ruby-on-rails, imagemagick, spree

我运行以下命令：

```
[~/rails_projects/mystore] $ spree install
dyld: Library not loaded: /System/Library/Frameworks/OpenCL.framework/Versions/A/Libraries/libclparser.dylib
  Referenced from: /usr/local/bin/identify
  Reason: image not found
sh: line 1: 34594 Trace/BPT trap: 5       identify -version > /dev/null
Image magick must be installed. 
```

并得到不好的回应。我已经安装了 imagemagick，但由于某种原因它没有找到它。有什么帮助吗？

# objective-c - 如何使用 ViewDeck 使用导航栏推送视图

> ID：14035470
> 
> 赞同：1
> 
> 时间：2012-12-26T02:41:46.990
> 
> 标签：objective-c, ios, xcode, viewdeck

Viewdeck 有个小问题。

我想用导航栏推送我的导航视图。我现在正在做（下面的代码），但它在没有导航栏的情况下推动。

```
 [self.viewDeckController closeLeftViewBouncing:^(IIViewDeckController *controller)
     {  
    DataViewController *DataController = [[DataViewController
                                           alloc]  initWithNibName:@"DataViewController" bundle:nil];
    DataController.modalPresentationStyle = UIModalPresentationFormSheet;

    DataController.ID = @"hello";

     self.viewDeckController.centerController = DataController;
}]; 
```

也试过：

```
 UIViewController *viewController = [[DataViewController alloc] init];
        UINavigationController *navigationController = [[UINavigationController alloc] initWithRootViewController:viewController];
        navigationController.modalPresentationStyle = UIModalPresentationFormSheet;

            DataViewController *DataController = [[DataViewController
                                                   alloc]  initWithNibName:@"DataViewController" bundle:nil];
            DataController.modalPresentationStyle = UIModalPresentationFormSheet;

            DataController.ID = @"hello";

             self.viewDeckController.centerController = DataController; 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-26T04:00:20.020

您的第一个代码块朝着正确的方向前进，但是您没有使用实际的 UINavigationController。我将假设您的 UIViewController 类是 DataViewController，因此应该执行以下操作：

```
DataViewController *dataController = [[DataViewController alloc] initWithNibName:@"DataViewController" bundle:nil];
UINavigationController *dataNavigationController = [[UINavigationController alloc] initWithRootViewController:dataController]; 
```

将您想要的任何数据传递给它（我看到您将 ID 属性设置为 @"hello" - 我会忽略它）。然后，在您的 closeLeftViewBouncing 中，只需设置：

```
[controller setCenterController:dataNavigationController]; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-26T03:16:22.290

当您将视图控制器推送到导航控制器时，它总是有一个导航栏。但是您并没有将视图控制器与您的代码一起推送。
在我的 Objective-C 抄写本中，我写了一个小程序来说明如何做到这一点：

1.  创建一个导航控制器并将其设置为窗口的根视图控制器，然后将第一个视图控制器添加到导航控制器；
2.  以您可以更改视图的方式将条形按钮项添加到视图控制器的导航项。该导航项应该具有推动另一个视图控制器的操作。

# java - 加载后 Java 字节码注入

> ID：14035471
> 
> 赞同：4
> 
> 时间：2012-12-26T02:41:48.027
> 
> 标签：java, methods, hook, code-injection, bytecode

我正在尝试在 Java 程序中挂钩其他类的方法，我知道这可以在加载时使用 Java 代理来完成。但是，一旦将 .class 文件加载到 JVM 中，是否有办法做到这一点，类似于在 c++ 中使用 Read/Writeprocessmemory() 挂钩的 dll？谢谢你。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-26T05:45:40.990

如果你的意思是方法拦截，有两种选择

1) java.lang.reflect.Proxy。下面的测试为列表创建代理并拦截其方法调用。请注意，它仅适用于接口。

```
class Handler implements java.lang.reflect.InvocationHandler {
    Object target;

    Handler(Object target) {
        this.target = target;
    }

    @Override
    public Object invoke(Object proxy, Method method, Object[] args) throws Throwable {
        System.out.println("Before " + method.getName());
        Object res = method.invoke(target, args);
        System.out.println("After " + method.getName());
        return res;
    }
}
List list = new ArrayList();
List proxy = (List) Proxy.newProxyInstance(Test.class.getClassLoader(),
        new Class[] { List.class }, new Handler(list));
proxy.add(1); 
```

印刷

```
Before add
After add 
```

2）面向方面的编程。在我看来，开始使用它的最简单方法是 Spring [http://static.springsource.org/spring/docs/3.2.x/spring-framework-reference/html/aop.html](http://static.springsource.org/spring/docs/3.2.x/spring-framework-reference/html/aop.html)

# php - php错误只获取数组中的值？

> ID：14035473
> 
> 赞同：0
> 
> 时间：2012-12-26T02:42:12.603
> 
> 标签：php

我有一个示例代码：

```
$link = array('google.com', 'facebook.com');
$name = array('google', 'facebook');

$data = array();
for($i=0; $i<count($link); $i++) {
   $data['name'] = $name[$i];
   $data['link'] = $link[$i];
}
print_r($data); 
```

=>结果显示`Array ( [name] => facebook [link] => facebook.com )` ，不显示全部，如何适应它？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-26T03:01:49.013

keep it simple, all you're doing is combining two arrays into an associative array, so use the native functionality of php. Using a loop to do this is a performance hit and unnecessary unless you plan on displaying the count.

```
<?php
    $names = array('google', 'facebook');
    $links = array('google.com', 'facebook.com');
    $data = array_combine($names, $links);
    print_r($data);
?> 
```

result: Array ( [google] => google.com [facebook] => facebook.com )

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-26T02:47:26.670

尝试：

```
$data[$i]['name'] = $name[$i];
$data[$i]['link'] = $link[$i]; 
```

出去：

```
Array
(
    [0] => Array
        (
            [name] => google
            [link] => google.com
        )

    [1] => Array
        (
            [name] => facebook
            [link] => facebook.com
        )

) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-26T02:45:25.140

变量`$data`应该是一个多维数组。否则，最新的数据会覆盖之前的数据。
尝试这个。

```
$link = array('google.com', 'facebook.com');
$name = array('google', 'facebook');

$data = array();
for($i=0; $i<count($link); $i++) {
   $data[] = array(
        'name' => $name[$i],
        'link' => $link[$i]
   );
}
print_r($data); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-26T02:46:05.420

```
for($i=0; $i<count($link); $i++) {
   $data[] = array('name' => $name[$i], 'link' => $link[$i]);
} 
```

或者：

```
foreach ($link as $index => $url) {
    $data[] = array('name' => $name[$index], 'link' => $url);
} 
```

另一个好的解决方案是[`array_combine`](http://php.net/manual/en/function.array-combine.php)：

```
array_combine($name,$link); 
```

申请结果`array_combine`：

```
array (
  'google' => 'google.com',
  'facebook' => 'facebook.com',
) 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-12-26T02:44:15.197

改成：

```
 $data[$i]['name'] = $name[$i];
   $data[$i]['link'] = $link[$i]; 
```

# php - 如果单词不存在，PHP 删除 div

> ID：14035477
> 
> 赞同：3
> 
> 时间：2012-12-26T02:43:50.090
> 
> 标签：php, xpath, domdocument

好的，假设我有这个字符串：

```
<div class='box'>i like the world</div><div class='box'>i like my computer</div> 
```

我将如何回应包含“世界”一词的 div？这会涉及某种正则表达式吗？

非常感谢你。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-26T03:03:40.213

使用[DOMDocument](http://php.net/manual/en/class.domdocument.php)和[DOMXPath](http://php.net/manual/en/class.domxpath.php)你可以很容易地做到这一点：

```
<?php

$html = "<div class='box'>i like the world</div><div class='box'>i like my computer</div>";
$doc = new DOMDOcument();
$doc->loadHTML($html);

$xPath = new DOMXPath($doc);
$nodes = $xPath->query("//div[contains(text(),'world')]"); 
```

现在`$nodes`包含所有`div`包含单词的元素`world`。

演示：[http ://codepad.viper-7.com/Dhalvh](http://codepad.viper-7.com/Dhalvh)

*请注意，您不想尝试使用正则表达式解析 HTML，因为它是什么时候的问题，而不是[它是否会中断](https://stackoverflow.com/questions/1732348/regex-match-open-tags-except-xhtml-self-contained-tags)。*

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-26T02:55:21.413

```
<?php 
    $html[0] = "<div class='box'>i like the world</div>";
    $html[1] = "<div class='box'>i like my computer</div>";

    foreach ($html as $div) {
        if (preg_match("/world/i", $div)) {
            echo($div);
        }
    }
?> 
```

是的，我想正则表达式将是一种方便的方法。

# android - Android：无法获取电子邮件的详细信息

> ID：14035485
> 
> 赞同：1
> 
> 时间：2012-12-26T02:44:32.617
> 
> 标签：android, return-value, android-cursoradapter

我创建了一个 ContactManager.java 用于显示电话中的所有联系人详细信息，而 SingleListContact 用于显示单击的联系人之一。到目前为止，我能够获得联系人姓名但无法获得联系人电子邮件，任何大师可以帮助我吗？

我的 ContactManager.java

```
 /*
     * Copyright (C) 2009 The Android Open Source Project
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *      http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */

    package com.example.android.contactmanager;

    import android.app.Activity;
    import android.content.Intent;
    import android.database.Cursor;
    import android.net.Uri;
    import android.os.Bundle;
    import android.provider.ContactsContract;
    import android.util.Log;
    import android.view.View;
    import android.widget.AdapterView;
    import android.widget.AdapterView.OnItemClickListener;
    import android.widget.Button;
    import android.widget.CheckBox;
    import android.widget.CompoundButton;
    import android.widget.CompoundButton.OnCheckedChangeListener;
    import android.widget.ListView;
    import android.widget.SimpleCursorAdapter;

    public final class ContactManager extends Activity implements OnItemClickListener
    {

        public static final String TAG = "ContactManager";

        private Button mAddAccountButton;
        private ListView mContactList;
        private boolean mShowInvisible;
        //public BooleanObservable ShowInvisible = new BooleanObservable(false);
        private CheckBox mShowInvisibleControl;

        /**
         * Called when the activity is first created. Responsible for initializing the UI.
         */

        @Override
        public void onCreate(Bundle savedInstanceState)
        {

            Log.v(TAG, "Activity State: onCreate()");
            super.onCreate(savedInstanceState);
            setContentView(R.layout.contact_manager);

            // Obtain handles to UI objects
            mAddAccountButton = (Button) findViewById(R.id.addContactButton);
            mContactList = (ListView) findViewById(R.id.contactList);
            mShowInvisibleControl = (CheckBox) findViewById(R.id.showInvisible);

            // Initialise class properties
            mShowInvisible = false;
            mShowInvisibleControl.setChecked(mShowInvisible);

            // Register handler for UI elements
            mAddAccountButton.setOnClickListener(new View.OnClickListener() {
                public void onClick(View v) {
                    Log.d(TAG, "mAddAccountButton clicked");
                    launchContactAdder();
                }
            });
            mShowInvisibleControl.setOnCheckedChangeListener(new OnCheckedChangeListener()
            {
                public void onCheckedChanged(CompoundButton buttonView, boolean isChecked) 
                {
                    Log.d(TAG, "mShowInvisibleControl changed: " + isChecked);
                    mShowInvisible = isChecked;
                    populateContactList();
                }
            });

            mContactList = (ListView) findViewById(R.id.contactList);
            mContactList.setOnItemClickListener(this);

            // Populate the contact list
            populateContactList();
        }

        /**
         * Populate the contact list based on account currently selected in the account spinner.
         */
        private void populateContactList() {
            // Build adapter with contact entries
            Cursor cursor = getContacts();
            String[] fields = new String[] {
                    ContactsContract.Data.DISPLAY_NAME,

            };

            SimpleCursorAdapter adapter = new SimpleCursorAdapter(this, R.layout.contact_entry, cursor,
                    fields, new int[] {R.id.contactEntryText});
            mContactList.setAdapter(adapter);
        }

        /**
         * Obtains the contact list for the currently selected account.
         *
         * @return A cursor for for accessing the contact list.
         */
        private Cursor getContacts()
        {
            // Run query
            Uri uri = ContactsContract.Contacts.CONTENT_URI;
            //Log.i("Uri ContactsContract.Contacts.CONTENT_URI" + ContactsContract.Contacts.CONTENT_URI, null, null);

            String[] projection = new String[]
                    {
                    ContactsContract.Contacts._ID,
                    ContactsContract.Contacts.DISPLAY_NAME,
                   ContactsContract.CommonDataKinds.Email.DATA,
    //                ContactsContract.CommonDataKinds.StructuredPostal.DATA1
                    //ContactsContract.CommonDataKinds.Phone.DATA
                    };
            String selection = ContactsContract.Contacts.IN_VISIBLE_GROUP + " = '" + (mShowInvisible ? "0" : "1") + "'";
            //String selection = ContactsContract.Contacts.IN_VISIBLE_GROUP + " = '" + (mShowInvisible.get() ? "0" : "1") + "'";
            String[] selectionArgs = null;
            String sortOrder = ContactsContract.Contacts.DISPLAY_NAME + " COLLATE LOCALIZED ASC";

            return this.managedQuery(uri, projection, selection, selectionArgs, sortOrder);
        }

        /**
         * Launches the ContactAdder activity to add a new contact to the selected account.
         */
        protected void launchContactAdder()
        {
            Intent i = new Intent(this, ContactAdder.class);
            startActivity(i);
        }

        public void onItemClick(AdapterView<?> l, View v, int position, long id) {
            Log.i("TAG", "You clicked item " + id + " at position " + position);
            // Here you start the intent to show the contact details
         // selected item
            //String contactDetails = (String)(mContactList.getItemAtPosition(position));
            //Uri contactDetails = ContactsContract.Contacts.CONTENT_URI;

            Cursor cursor = getContacts();

            cursor.moveToPosition(position);
            String name = cursor.getString(cursor.getColumnIndex(ContactsContract.Contacts.DISPLAY_NAME));
            String email = cursor.getString(cursor.getColumnIndex(ContactsContract.CommonDataKinds.Email.DATA));

    //        Log.i("Address", "Testing" + cursor.getString(cursor.getColumnIndex(ContactsContract.CommonDataKinds.Email.DATA)));
            // Launching new Activity on selecting single List Item
            Intent i = new Intent(getApplicationContext(), SingleListContact.class);
    //        SingleListContact.PutDetails(ContactsContract.Contacts._ID, name, address, position, null, null);
            SingleListContact.PutDetails(ContactsContract.Contacts._ID, name, email);

            Log.i("Show Contact Clicked: ",  name + "Email: " + cursor.getColumnIndex(ContactsContract.CommonDataKinds.Email.DATA));
            // sending data to new activity
            //i.putExtra("Contact Person", contactDetails);
            startActivity(i);

        }

    } 
```

还有 SingleListContact.java

```
package com.example.android.contactmanager;

import android.app.Activity;
import android.content.Intent;
import android.net.Uri;
import android.os.Bundle;
import android.util.Log;
import android.view.View;
import android.widget.EditText;
import android.widget.ImageView;

public class SingleListContact extends Activity {

    static int ContactPhone;
    static String ContactID, ContactName, ContactEmail, ContactAddress;
    //@Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        this.setContentView(R.layout.single_list_contact_view);

        EditText txtContact = (EditText) findViewById(R.id.editText1);
        txtContact.setText(ContactName);
//        txtContact.setText(ContactEmail);

        Log.e("ContactEmail: " , ContactEmail);

//        EditText txtContact2 = (EditText) findViewById(R.id.editText2);
//        txtContact2.setText(ContactPhone);

        EditText txtContact3 = (EditText) findViewById(R.id.editText3);
        txtContact3.setText(ContactEmail);

// 
//     
//        EditText txtContact4 = (EditText) findViewById(R.id.editText4);
//        txtContact4.setText(ContactAddress);

        ImageView myImg= (ImageView) findViewById(R.id.imageView1);
        myImg.setOnClickListener(new View.OnClickListener()
        {
            public void onClick(View view)
            {
             //Launch Intent or whatever you want here
                 Log.e("GeoTag Button", "Clicked!");
//                                                      
                    double latitude = 13.042206;
                    double longitude = 80.17000;

                    Uri uri = Uri.parse("geo:" + latitude  + "," + longitude +"?z=10");
                    Intent intent = new Intent(Intent.ACTION_VIEW, uri);
                    startActivity(intent);                       
            }
         });

    }

    static void PutDetails (String id, String name, String email)
    {
        ContactID = id;
        ContactName = name;
        //ContactPhone = phone;
        ContactEmail = email;
//      ContactAddress = address;   
    }

} 
```

日志猫：

```
12-05 05:00:31.289: E/AndroidRuntime(642): FATAL EXCEPTION: main
12-05 05:00:31.289: E/AndroidRuntime(642): java.lang.NullPointerException
12-05 05:00:31.289: E/AndroidRuntime(642):  at com.example.android.contactmanager.ContactManager.onItemClick(ContactManager.java:148)
12-05 05:00:31.289: E/AndroidRuntime(642):  at android.widget.AdapterView.performItemClick(AdapterView.java:284)
12-05 05:00:31.289: E/AndroidRuntime(642):  at android.widget.ListView.performItemClick(ListView.java:3513)
12-05 05:00:31.289: E/AndroidRuntime(642):  at android.widget.AbsListView$PerformClick.run(AbsListView.java:1812)
12-05 05:00:31.289: E/AndroidRuntime(642):  at android.os.Handler.handleCallback(Handler.java:587)
12-05 05:00:31.289: E/AndroidRuntime(642):  at android.os.Handler.dispatchMessage(Handler.java:92)
12-05 05:00:31.289: E/AndroidRuntime(642):  at android.os.Looper.loop(Looper.java:123)
12-05 05:00:31.289: E/AndroidRuntime(642):  at android.app.ActivityThread.main(ActivityThread.java:3683)
12-05 05:00:31.289: E/AndroidRuntime(642):  at java.lang.reflect.Method.invokeNative(Native Method)
12-05 05:00:31.289: E/AndroidRuntime(642):  at java.lang.reflect.Method.invoke(Method.java:507)
12-05 05:00:31.289: E/AndroidRuntime(642):  at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:839)
12-05 05:00:31.289: E/AndroidRuntime(642):  at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:597)
12-05 05:00:31.289: E/AndroidRuntime(642):  at dalvik.system.NativeStart.main(Native Method) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-26T03:23:56.770

您无法从 Cursor 检索电子邮件 ID，因为目前您没有从 contentprovider 查询电子邮件列，因此将您的代码更改为：

```
private Cursor getContacts()
{
    // Run query
    Uri uri = ContactsContract.Contacts.CONTENT_URI;

    String[] projection = new String[]
            {
            ContactsContract.Contacts._ID,
            ContactsContract.Contacts.DISPLAY_NAME,
            ContactsContract.Contacts.Email.DATA //<< query email data here

            };
    String selection = ContactsContract.Contacts.IN_VISIBLE_GROUP 
                + " = '" + (mShowInvisible ? "0" : "1") + "'";

    String[] selectionArgs = null;
    String sortOrder = ContactsContract.Contacts.DISPLAY_NAME 
                                     + " COLLATE LOCALIZED ASC";

    return this.managedQuery(uri, projection, 
                      selection, selectionArgs, sortOrder);
} 
```

现在您可以在 ListView onItemClick 方法中获取电子邮件 ID

# ios - 调用 CFRelease(ABAddressBookRef ref) 时崩溃

> ID：14035489
> 
> 赞同：2
> 
> 时间：2012-12-26T02:45:26.717
> 
> 标签：ios

这是我的代码，运行最后一行`CFRelease(addressBook)`，程序崩溃！帮帮我~！

```
ABAddressBookRef addressBook = ABAddressBookCreateWithOptions(NULL, NULL);

NSMutableArray *groups = [NSMutableArray arrayWithCapacity:ABAddressBookGetGroupCount(addressBook)];
NSMutableArray *people = [NSMutableArray arrayWithCapacity:ABAddressBookGetGroupCount(addressBook)];

[(NSArray *)CFBridgingRelease(ABAddressBookCopyArrayOfAllGroups(addressBook)) enumerateObjectsUsingBlock:^(id obj_g, NSUInteger idx, BOOL *stop) {
    ABRecordRef g = (__bridge ABRecordRef)obj_g;
    NSString *gname = CFBridgingRelease(ABRecordCopyCompositeName(g));

    NSMutableArray *gp = [[[NSArray alloc] init] mutableCopy];

    [(NSArray *)CFBridgingRelease(ABGroupCopyArrayOfAllMembers(g)) enumerateObjectsUsingBlock:^(id obj_p, NSUInteger idx, BOOL *stop) {
        ABRecordRef p = (__bridge ABRecordRef)obj_p;
        ABMultiValueRef numbers = ABRecordCopyValue(p, kABPersonPhoneProperty);

        NSString *pname = CFBridgingRelease(ABRecordCopyCompositeName(p));

        [(NSArray *) CFBridgingRelease(ABMultiValueCopyArrayOfAllValues(numbers)) enumerateObjectsUsingBlock:^(id obj_n, NSUInteger idx, BOOL *stop) {
            NSString *pnumber = CFBridgingRelease(CFBridgingRetain(obj_n));

            MasMsContact *new_c = [[MasMsContact alloc] init];
            new_c.name = pname;
            new_c.number = pnumber;
            new_c.group = gname;

            [gp addObject:new_c];
        }];

        CFRelease(numbers);
        CFRelease(p);
    }];

    CFRelease(g);

    [people addObject:[gp copy]];
    [groups addObject:gname];
}];

#warning crash when release addressBook, why ???
if (addressBook) CFRelease(addressBook); 
```

[崩溃时的Xcode](http://i.stack.imgur.com/YY65q.png)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-26T03:19:53.460

当您释放它们的桥接引用然后从该枚举块中弹出时，您并不拥有它们`obj_p`，`obj_g`因此它们被过度释放。如果您使用`Create`或访问它们，您只有拥有核心基础对象`Copy`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-26T03:08:24.237

我在谷歌上搜索这个[iPhone SDK：EXC_BAD_ACCESS with CFRelease for ABAddressBookRef](https://stackoverflow.com/questions/1209130/iphone-sdk-exc-bad-access-with-cfrelease-for-abaddressbookref)

我有同样的问题，过度释放`g`和`p`.

# java - 从其他类的 toString 调用 toString 方法。不重复值

> ID：14035490
> 
> 赞同：-2
> 
> 时间：2012-12-26T02:46:03.210
> 
> 标签：java, nullpointerexception, tostring

当我从 Time2 类的 toString 调用 Date 类的 toString 时，为什么会收到以下错误消息？Exerciseschpt8.Time2.toString(Time2.java:111) 处的线程“main”java.lang.NullPointerException 中的异常在 Exerciseschpt8.Time2Test.main(Time2Test.java:18)

```
package Exerciseschpt8;

public class Date{
    private int month; // 1-12
    private int day; // 1-31 based on month
    private int year; // any year

    public Date(){

        this(0,0,0);
    }

    public Date(int theMonth, int theDay, int theYear) {
        month = checkMonth(theMonth); // validate month
        year = theYear; // could validate year
        day = checkDay(theDay); // validate day

        System.out.printf("Date object constructor for date %s\n", this);
    }

    private int checkMonth(int month) {
        if (month > 0 && month <= 12) // validate month
            return month;
        else // month is invalid
        {
            System.out.printf("Invalid month (%d) set to 1.", month);
            return 1; // maintain object in consistent state
        } // end else
    } // end method checkMonth

    // utility method to confirm proper day value based on month and year
    private int checkDay(int day) {
        int[] daysPerMonth = { 0, 31, 28, 31, 30, 31, 30, 28, 31, 30, 31, 30,
                31 };

        // check if day in range for month
        if (day > 0 && day <= daysPerMonth[month])
            return day;

        // check for leap year
        if (month == 2 && day == 29
                && (year % 400 == 0 || (year % 4 == 0 && year % 100 != 0)))
            return day;

        System.out.printf("Invalid day (%d) set to 1.", day);
        return 1; // maintain object in consistent state
    } // end method checkDay

    // return a String of the form month/day/year
    public String toString() {
        return  ""+month+"/"+ day+"/"+year;
    } // end method toString

    public int nextDay() {
        int testDay = day + 1;

        if (checkDay(testDay) == testDay)
            day = testDay;
        else {
            day = 1;
            //nextMonth();
        }
        return day;

    }

    public int nextMonth() {
        if (1 == month)
            month++;
        return month = 1;

    }

    public String toDateString() {
        return month + "/" + day + "*/" + year;
    }

} 

package Exerciseschpt8;

import Exerciseschpt8.Date;

public class Time2 {
    Date dateX;
    private int hour; // 0 - 23
    private int minute; // 0 - 59
    private int second; // 0 - 59

    public Time2() {
        this(0, 0, 0);
    }

    public Time2(int h) {
        this(h, 0, 0);
    }

    public Time2(int h, int m) {
        this(h, m, 0);
    }

    public Time2(int h, int m, int s) {
        setTime(h, m, s);
    }

    public Time2(Time2 time) {

        this(time.getHour(), time.getMinute(), time.getSecond());
    }

    public boolean setTime(int h, int m, int s) {

        boolean hourValid, minuteValid, secondValid;
        hourValid = setHour(h); // set the hour
        minuteValid = setMinute(m); // set the minute
        secondValid = setSecond(s); // set the second

        return (hourValid && minuteValid && secondValid);
    }

    public boolean setHour(int h) {
        // hour = ((h >= 0 && h < 24) ? h : 0);
        if (h >= 0 && h < 24) {
            hour = h;
            return true;
        } else {
            hour = 0;
            return false;
        }
    } // end method setHour

    public boolean setMinute(int m) {
        // minute = ((m >= 0 && m < 60) ? m : 0);
        if (m >= 0 && m < 60) {
            minute = m;
            return true;
        } else {
            minute = 0;
            return false;
        }

    } // end method setMinute

    public boolean setSecond(int s) {
        // second = ((s >= 0 && s < 60) ? s : 0);
        if (s >= 0 && s < 60) {
            second = s;
            return true;
        } else {
            second = 0;
            return false;
        }
    } // end method setSecond

    public int getHour() {
        return hour;
    } // end method getHour

    public int getMinute() {
        return minute;
    } // end method getMinute

    public int getSecond() {
        return second;
    } // end method getSecond

    // Tick the time by one second
    public void tick() {
        setSecond(second + 1);

        if (second == 23)
            incrementMinute();
    }

    public void incrementMinute() {
        setMinute(minute + 1);

        if (minute == 25)
            incrementHour();
    }

    public void incrementHour() {
        setHour(hour + 1);

        if (hour == 0)
            dateX.nextDay();
    }

    public String toString() {
        return + hour + ":" + minute + ":" + second + "\n"+dateX.toString();
    }

package Exerciseschpt8;

public class Time2Test {
    public static void main(String[] args) {
        Time2 t1 = new Time2(2,15,23); // 00:00:00
/
        Date d1 = new Date(10,23,1973);
        //System.out.println(d1.toDateString());

        System.out.println("Constructed with:");
        System.out.println("t1: all arguments defaulted");
        //System.out.printf(" %s\n", t1.toUniversalString());
        System.out.printf(" %s\n", t1.toString()); 
```

} }

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-26T02:49:41.273

您无法在类中初始化`dateX`并在类的方法中使用其上的方法`Time2`（`dateX.toString()`）。这导致了有效的.`toString()``Time2``NullPointerException`

`dateX`要解决此问题，请根据您的程序进行适当的初始化。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-26T02:50:03.793

在`Date dateX;`您声明 dateX 的行中，但您没有对其进行初始化，因此它是一个空指针。要初始化它，请将行更改为`Date dateX = new Date();`

# android - 在android中创建带有颜色的图像

> ID：14035498
> 
> 赞同：4
> 
> 时间：2012-12-26T02:47:43.557
> 
> 标签：android, image, colors

设置背景似乎没有给出任何关于 android 大小的提示。
因此，我正在寻找一种方法来创建具有特定颜色的图像。
（如果可以在xml中完成会更好）

在 iOS 中，这可以通过

```
+ (UIImage*)placeHolderImage
{
    static UIImage* image = nil;
    if(image != nil)
        return image;

    CGRect rect = CGRectMake(0.0f, 0.0f, 1.0f, 1.0f);
    UIGraphicsBeginImageContext(rect.size);
    CGContextRef context = UIGraphicsGetCurrentContext();

    // Seashell color                                                                                                                                                                                                                                                           
    UIColor* color = [UIColor colorWithRed:255/255.0 green:245/255.0 blue:238/255.0 alpha:1.0];
    CGContextSetFillColorWithColor(context, [color CGColor]);
    CGContextFillRect(context, rect);

    image = UIGraphicsGetImageFromCurrentImageContext();
    UIGraphicsEndImageContext();

    return image;
} 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-12-26T03:36:58.660

这是等效的*Android*代码：

```
// CGRect rect = CGRectMake(0.0f, 0.0f, 1.0f, 1.0f);
Rect rect = new Rect(0, 0, 1, 1);

//UIGraphicsBeginImageContext(rect.size);
//CGContextRef context = UIGraphicsGetCurrentContext();
Bitmap image = Bitmap.createBitmap(rect.width(), rect.height(), Config.ARGB_8888);
Canvas canvas = new Canvas(image);

//UIColor* color = [UIColor colorWithRed:255/255.0 green:245/255.0 blue:238/255.0 alpha:1.0];
int color = Color.argb(255, 255, 245, 238);

//CGContextSetFillColorWithColor(context, [color CGColor]);
Paint paint = new Paint();
paint.setColor(color);

//CGContextFillRect(context, rect);
canvas.drawRect(rect, paint);

//image = UIGraphicsGetImageFromCurrentImageContext();
//UIGraphicsEndImageContext();
/** nothing to do here, we already have our image **/
/** and the canvas will be released by the GC     **/ 
```

现在，如果您想在*XML*中执行此操作会容易得多：

```
<shape xmlns:android="http://schemas.android.com/apk/res/android" android:shape="rectangle">
    <size android:width="1px" android:height="1dp"/>
    <solid android:color="#FFFFF5EE/>
</shape> 
```

虽然那不会给你一个`Bitmap`，而是一个`Drawable`。如果你打算把它画在某个地方，那很好。如果您确实需要 a `Bitmap`，那么您将不得不使用上面的代码`Canvas`从 a创建 a`Bitmap`并将您的画`Drawable`入其中。

* * *

## 回答 #2

> 赞同：-3
> 
> 时间：2012-12-26T03:31:49.723

这有助于您创建具有特定颜色的位图图像。首先创建一个名为 sampleBitmap 的位图，如下所示

```
Bitmap.Config conf = Bitmap.Config.ARGB_8888; // see other conf types
Bitmap sampleBitmap = Bitmap.createBitmap(300, 300, conf); // this creates a MUTABLE bitmap 
```

接下来使用以下代码获取创建的位图的每个像素

// int[] 像素 = new int[sampleBitmap.getHeight()*sampleBitmap.getWidth()];

```
for (int i=0; i < sampleBitmap.getWidth(); i++)
{
for (int j=0; j < sampleBitmap.getHeight(); i++)
 {
    sampleBitmap.setPixel(i, j, Color.rgb(someColor1, someColor2, someColor3));
 }
} 
```

使用它，您可以将位图设置为列表视图项，以便列表项不会折叠

# ios - 从 AVPlayer 对象访问 URL？

> ID：14035501
> 
> 赞同：52
> 
> 时间：2012-12-26T02:48:47.800
> 
> 标签：ios, avplayer

有没有办法从已使用 URL 初始化的 AVPlayer 对象访问 URL，如：

```
NSURL *url = [NSURL URLWithString: @"http://www.example.org/audio"];
self.player = [AVPlayer playerWithURL: url]; 
```

* * *

## 回答 #1

> 赞同：94
> 
> 时间：2012-12-26T05:08:36.820

An `AVPlayer` plays an `AVPlayerItem`. `AVPlayerItem`s are backed by objects of the class `AVAsset`. When you use the `playerWithURL:` method of `AVPlayer` it automatically creates the `AVPlayerItem` backed by an asset that is a subclass of `AVAsset` named `AVURLAsset`. `AVURLAsset` has a `URL` property.

So, yes, in the case you provided you can get the `NSURL` of the currently playing item fairly easily. Here's an example function of how to do this:

```
-(NSURL *)urlOfCurrentlyPlayingInPlayer:(AVPlayer *)player{
    // get current asset
    AVAsset *currentPlayerAsset = player.currentItem.asset;
    // make sure the current asset is an AVURLAsset
    if (![currentPlayerAsset isKindOfClass:AVURLAsset.class]) return nil;
    // return the NSURL
    return [(AVURLAsset *)currentPlayerAsset URL];
} 
```

Not a swift expert, but it seems it can be done in swift more briefly.

```
func urlOfCurrentlyPlayingInPlayer(player : AVPlayer) -> URL? {
    return ((player.currentItem?.asset) as? AVURLAsset)?.url
} 
```

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2018-05-19T19:41:07.673

### Oneliner Swift 4.1

```
let url: URL? = (player?.currentItem?.asset as? AVURLAsset)?.url 
```

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2016-12-14T00:18:24.897

Swift 3 的解决方案

```
func getVideoUrl() -> URL? {
    let asset = self.player?.currentItem?.asset
    if asset == nil {
        return nil
    }
    if let urlAsset = asset as? AVURLAsset {
        return urlAsset.url
    }
    return nil
} 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2020-10-07T10:16:24.387

AVPlayerItem 扩展基于[@eonist](https://stackoverflow.com/a/50428861/9048325)答案。

```
扩展 AVPlayerItem {
    变量网址：网址？{
        返回（资产为？AVURLAsset）？.url
    }
}
```

# r - 如何查看 R .Internal 或 .Primitive 函数的源代码？

> ID：14035506
> 
> 赞同：84
> 
> 时间：2012-12-26T02:49:58.510
> 
> 标签：r

这些都没有显示`pnorm`函数的源代码，

```
stats:::pnorm
getAnywhere(pnorm) 
```

我怎样才能看到源代码`pnorm`？

```
sum
 (..., na.rm = FALSE)  .Primitive("sum")
.Primitive("sum")
function (..., na.rm = FALSE)  .Primitive("sum")
methods(sum)
no methods were found 
```

而且，我怎样才能看到`sum`函数的源代码？

* * *

## 回答 #1

> 赞同：102
> 
> 时间：2012-12-26T03:07:33.333

的R源代码`pnorm`是：

```
function (q, mean = 0, sd = 1, lower.tail = TRUE, log.p = FALSE) 
.Call(C_pnorm, q, mean, sd, lower.tail, log.p) 
```

所以，从技术上讲，输入“pnorm”*确实会*显示源代码。然而，更有用的是：intents`pnorm`是用 C 编码的，因此在上一个问题中[查看 R 中的源代码中](https://stackoverflow.com/questions/3485228/view-source-code-in-r)的建议仅在外围有用（其中大部分集中在隐藏在命名空间等中的函数上）。

Uwe Ligges[在 R 新闻中的文章 Accessing the Sources](http://cran.r-project.org/doc/Rnews/Rnews_2006-4.pdf) (p. 43) 是一个很好的通用参考。从该文件中：

> 查看 R 源代码时，有时会显示对以下函数之一的调用：`.C()`、 `.Call()`、`.Fortran()`、`.External()`或`.Internal()` 和`.Primitive()`。这些函数调用编译代码中的入口点，例如共享对象、静态库或动态链接库。因此，如果需要完全理解代码，则有必要查看编译代码的来源。... 第一步是在文件“$R HOME/src/main/names.c”中查找入口点，如果调用 R 函数是`.Primitive()`或 `.Internal()`。**这是在以下示例中为实现“简单”R 函数的代码完成的 `sum()`。**

（之所以强调是因为您询问的 ( `sum`) 的精确函数已在 Ligges 的文章中介绍过。）

根据您对代码挖掘的认真程度，可能值得按照 Ligges 的建议下载和解压缩源代码（例如，您可以使用命令行工具`grep`来搜索源代码）。对于更随意的检查，您可以通过 R [Subversion 服务器](http://svn.r-project.org/R/trunk/src/nmath/pnorm.c)或[Winston Chang 的 github 镜像](http://github.com/wch/r-source/blob/trunk/src/nmath/pnorm.c)在线查看源代码（此处的链接专门指向`src/nmath/pnorm.c`）。（猜测正确的位置`src/nmath/pnorm.c`，需要熟悉 R 源代码的结构。）

`mean`并且`sum`都在[summary.c](https://github.com/wch/r-source/blob/trunk/src/main/summary.c)中实现。

* * *

## 回答 #2

> 赞同：37
> 
> 时间：2015-04-17T10:49:09.257

我知道这篇文章已有 2 年的历史了，但我认为这可能对浏览此问题的某些用户有用。

我基本上只是复制我对[这个其他类似问题](https://stackoverflow.com/questions/13279256/how-to-find-out-which-c-file-contains-the-c-functions-of-r-internals/29696967#29696967)的回答，以便它可能对一些想要探索 C 源文件的 R 用户有用。

1.  首先，使用**pryr** ，您可以使用`show_c_source`在 GitHub 上搜索 C 源文件中相关代码的功能。适用于 .Internal 和 .Primitive 函数。

    ```
    body(match.call)

    # .Internal(match.call(definition, call, expand.dots))

    pryr::show_c_source(.Internal(match.call(definition, call, expand.dots))) 
    ```

    这会将您带到[此页面](https://github.com/search?q=SEXP%20attribute_hidden%20do_matchcall%20repo:wch/r-source&type=Code)，显示`unique.c`包含函数[do_matchcall](https://github.com/wch/r-source/blob/ec8db8be924cf4ffd49438cbca38b876c7931863/src/main/unique.c#L1261)。

2.  我已经把这个[制表符分隔的文件](https://gist.github.com/dcomtois/261ff939d1a1b27525f1)放在一起，建立在`names.c`文件上并使用文件中*查找*来确定源代码的位置。有一些函数具有特定于平台的文件，还有一些函数有多个具有相关源代码的文件。但是对于其余部分，映射已经很好地建立了，至少对于当前版本（3.1.2）。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2012-12-26T03:34:31.337

```
> methods(mean)
[1] mean.data.frame mean.Date       mean.default    mean.difftime   mean.IDate*    
[6] mean.POSIXct    mean.POSIXlt    mean.yearmon*   mean.yearqtr*  

   Non-visible functions are asterisked
> mean.default
function (x, trim = 0, na.rm = FALSE, ...) 
{
    if (!is.numeric(x) && !is.complex(x) && !is.logical(x)) {
        warning("argument is not numeric or logical: returning NA")
        return(NA_real_)
    }
    if (na.rm) 
        x <- x[!is.na(x)]
    if (!is.numeric(trim) || length(trim) != 1L) 
        stop("'trim' must be numeric of length one")
    n <- length(x)
    if (trim > 0 && n) {
        if (is.complex(x)) 
            stop("trimmed means are not defined for complex data")
        if (any(is.na(x))) 
            return(NA_real_)
        if (trim >= 0.5) 
            return(stats::median(x, na.rm = FALSE))
        lo <- floor(n * trim) + 1
        hi <- n + 1 - lo
        x <- sort.int(x, partial = unique(c(lo, hi)))[lo:hi]
    }
    .Internal(mean(x))
}
<bytecode: 0x155ef58>
<environment: namespace:base> 
```

# svn - 如何通过镜像上的 svnsync 恢复更改

> ID：14035509
> 
> 赞同：1
> 
> 时间：2012-12-26T02:50:22.350
> 
> 标签：svn, svnsync

我有一个 Mirror 和 Master，最近由于锁定问题，来自 master 的同步停止了。使用 svn propset --revprop 后，我设法重新启动同步，但经过几次修订同步后，收到一条错误消息，svnsync 无法在镜像中找到文件。真正的问题是在第 20 版，两个存储库的结构不同

“http://Mirror/Sets/Hw/trunk/Emu/token”

“http://Master/Sets/Hw/trunk/token”

但是，所有已同步的修订的评论都是相同的。

目前 master 处于第 100 个修订版，镜像无法从第 20 个修订版移动，因为结构差异和 svnsync 无法复制该修订版。请建议是否有任何规定可以撤消镜像上的 svnsync 并重新启动 svnsync，或者是否有更好的选择？提前致谢

# sql - sql update 语句 - 如果记录不存在则插入数据？

> ID：14035514
> 
> 赞同：0
> 
> 时间：2012-12-26T02:51:40.210
> 
> 标签：sql, oracle-xe

我认为更新语句要求数据已经存在。

我正在支持一个 java 应用程序。以前的一些代码开发人员使用删除语句清除记录，然后使用更新语句将数据插入表中。

update语句可以用来向表中插入或更新数据吗？？？

数据库是 oracle express。这不应该有所作为。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-26T04:41:11.033

您可以尝试使用`MERGE`语句来获得相同的结果。使用`MERGE`语句，您可以将新记录插入表中，或者如果数据已经存在则更新。

请查找`MERGE`语句的语法。

```
MERGE INTO <table_name>
USING <table_view_or_query>
ON (<condition>)
WHEN MATCHED THEN <update_clause>
DELETE <where_clause>
WHEN NOT MATCHED THEN <insert_clause>; 
```

也许您可以提供有关您的问题的更多详细信息。我假设这是你所需要的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-26T07:35:52.820

Query 是 org.hibernate.Query 的一个实例。查看休眠文档进行查询。更新应该引发异常，但事实并非如此。代码没有刷新缓冲区的事实可能是更新没有引发异常的原因吗？？？

```
String deleteQueryString = String.format("delete FROM %s WHERE personId = %s and deptId = %s and active = true", table, person.getId(),dept.getId());

Query deleteQuery = Persistence.reportContext().session().createQuery(deleteQueryString);
int deletedCount = deleteQuery.executeUpdate();
log.debug(String.format("%20s (%4s): %s", "delete query", deletedCount, deleteQueryString));

String updateQueryString = String.format("update %s set activeSet = true WHERE personId = %s and deptId = %s and activeSet = false", table, person.getId(), dept.getId());

Query updateQuery = Persistence.reportContext().session().createQuery(updateQueryString);
int updatedCount = updateQuery.executeUpdate(); 
```

# php - 将Javascript融合图表导出代码应用到PHP、MySql代码

> ID：14035517
> 
> 赞同：0
> 
> 时间：2012-12-26T02:52:27.143
> 
> 标签：php, javascript, mysql, fusioncharts

我将融合图表与我的 PHP 和 MySQL 编码一起使用。我可以用数据库数据绘制图表..现在我想添加一个下载按钮来将图表导出为 PDF、png 和 JPG 格式...我找到了融合图表 Javascript 示例 & 我尝试将该代码应用于我的 php 代码并导出图表..但我做不到....只显示图表...她的帮助 JS 代码，我使用...：

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html>
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />

        <title>My First chart using FusionCharts - Exporting pure JavaScript chart</title>
        <script type="text/javascript" LANGUAGE="Javascript" SRC="../../../Charts/FusionCharts.js"></script>
        <script type="text/javascript" LANGUAGE="Javascript" SRC="../../assets/ui/js/jquery.min.js"></script>
        <script type="text/javascript" LANGUAGE="Javascript" SRC="../../assets/ui/js/lib.js"></script>

        <link href="../../assets/ui/css/style.css" rel="stylesheet" type="text/css" />

        <!--[if IE 6]>
        <script type="text/javascript" src="../assets/ui/js/DD_belatedPNG_0.0.8a-min.js"></script>

<script>
          /* select the element name, css selector, background etc */
          DD_belatedPNG.fix('img');

          /* string argument can be any CSS selector */
        </script>
        <![endif]-->

        <style type="text/css">
            h2.headline {
                font: normal 110%/137.5% "Trebuchet MS", Arial, Helvetica, sans-serif;
                padding: 0;
                margin: 25px 0 25px 0;
                color: #7d7c8b;
                text-align: center;
            }
            p.small {
                font: normal 68.75%/150% Verdana, Geneva, sans-serif;
                color: #919191;
                padding: 0;
                margin: 0 auto;
                width: 664px;
                text-align: center;
            }
        </style>
    </head>
    <body>

        <div id="wrapper">

            <div id="header">

               <div class="logo"><a class="imagelink"  href="http://www.fusioncharts.com/" target="_blank"><img src="../../assets/ui/images/fusionchartsv3.2-logo.png" width="131" height="75" alt="FusionCharts XT logo" /></a></div>
                <h1 class="brand-name">FusionCharts XT</h1>
                <h1 class="logo-text">Exporting pure JavaScript chart</h1>
            </div>

            <div class="content-area">
                <div id="content-area-inner-main">
                    <p class="text" align="center" >Exporting pure JavaScript chart.Click the download button on the top right corner of the chart. </p>
                    <p>&nbsp;</p>

                    <div class="gen-chart-render">
                        <center>
                            <div id="chartContainer">FusionCharts will load here</div>

                            <script type="text/javascript"><!--

                                FusionCharts.setCurrentRenderer('JavaScript');
                                var myChart = new FusionCharts("../../Charts/Column2D.swf", "myChartId", "400", "300", "0", "1");
                                myChart.setXMLData('<chart caption="Weekly Sales Summary" xAxisName="Week" yAxisName="Sales" numberPrefix="$" \n\
                                   exportEnabled="1" >\n\
                                      <set label="Week 1" value="14400" /> \n\
                                      <set label="Week 2" value="19600" /> \n\
                                      <set label="Week 3" value="24000" /> \n\
                                      <set label="Week 4" value="15700" /> \n\
                                </chart>');

                                myChart.render("chartContainer");

                                // -->
                            </script>
                        </center>
                    </div>
                    <div class="clear"></div>
                    <p>&nbsp;</p>
                    <p class="small">    </p>
                    <div class="underline-dull"></div>
                    <div>

                <p class="highlightBlock">The above sample showcases exporting pure JavaScript charts. Click <a href="../../../Contents/index.html?exporting-image/ECPureJS.html" target="_blank">here</a> to know more on how the code of this example works.</p>
            </div>

                </div>
            </div>

            <div id="footer">
                <ul>
                    <li><a href="../index.html"><span>&laquo; Back to list of examples</span></a></li>
                    <li class="pipe">|</li>
                    <li><a href="../../NoChart.html"><span>Unable to see the chart above?</span></a></li>
                </ul>
            </div>
        </div>
    </body>
</html> 
```

要查看此代码的输出，请单击此链接：[输出](http://docs.fusioncharts.com/charts/Code/ExportChartSamples/PureJavaScript/weekly-sales-js-export.html)

这是我的 php,mysql 代码：

```
<?php

include("FusionCharts/FusionCharts.php");
?>
<HTML>
<HEAD>
    <TITLE>
    FusionCharts - Array Example using Single Series Column 3D Chart
    </TITLE>    
    <SCRIPT LANGUAGE="Javascript" SRC="FusionCharts/FusionCharts.js"></SCRIPT>
    <!--<script type="text/javascript" language="JavaScript" src="FusionCharts/FusionChartsExportComponent.js"></script>-->
<script type="text/javascript" LANGUAGE="Javascript" SRC="FusionCharts/jquery.min.js"></script>
<script type="text/javascript" LANGUAGE="Javascript" SRC="FusionCharts/lib.js"></script>
<link href="FusionCharts/style.css" rel="stylesheet" type="text/css" />

    <style type="text/css">
    <!--
    body {
        font-family: Arial, Helvetica, sans-serif;
        font-size: 12px;
    }
    -->
    </style>
</HEAD>
<BODY>

<CENTER>
<h2>FusionCharts Examples</h2>
<h4>Plotting single series chart from data contained in Array.</h4>
<?php
include("db_connect.php");

    $arrData[0][2] = "A";
    //send + char to xml file////
    $arrData[1][3] = str_replace('+', '%2B', 'A+');
    $arrData[2][4] = "A-";
    $arrData[3][5] = "B";
    $arrData[4][6] = str_replace('+', '%2B', 'B+');
    $arrData[5][7] = "B-";
    $arrData[6][8] = "C";
    $arrData[7][9] = str_replace('+', '%2B', 'C+');
    $arrData[8][10] = "C-";
    $arrData[9][11] = "D";
    $arrData[10][12] = str_replace('+', '%2B', 'D+');
    $arrData[11][13] = "E";
    $arrData[12][14] = "AB";
    $arrData[13][15] = "NE";
    $arrData[14][16] = "MC";

    //Store db data
    // Fetch all  records
    $sql = "SELECT grade, COUNT(*) 'No_Of_grades' FROM std_results WHERE course_code ='CSC1113' GROUP BY grade ORDER BY grade ASC";
    $result = mysql_query($sql) or die(mysql_error());
    while($ors = mysql_fetch_array($result)) {
    $grd=$ors['grade'];
    switch ($grd)
{
case "A":
  $arrData[0][17]=$ors['No_Of_grades'];
  break;
case "A+":
  $arrData[1][18]=$ors['No_Of_grades'];
  break;
case "A-":
  $arrData[2][19]=$ors['No_Of_grades'];
  break;
  case "B":
  $arrData[3][20]=$ors['No_Of_grades'];
  break;
  case "B+":
  $arrData[4][21]=$ors['No_Of_grades'];
  break;
  case "B-":
  $arrData[5][22]=$ors['No_Of_grades'];
  break;
 case "C":
  $arrData[6][23]=$ors['No_Of_grades'];
  break;
  case "C+":
  $arrData[7][24]=$ors['No_Of_grades'];
  break;
  case "C-":
  $arrData[8][25]=$ors['No_Of_grades'];
  break;
  case "D":
  $arrData[9][26]=$ors['No_Of_grades'];
  break;
  case "D+":
  $arrData[10][27]=$ors['No_Of_grades'];
  break;
  case "E":
  $arrData[11][28]=$ors['No_Of_grades'];
  break;
  case "AB":
  $arrData[12][29]=$ors['No_Of_grades'];
  break;
  case "NE":
  $arrData[13][30]=$ors['No_Of_grades'];
  break;
default:
  $arrData[14][31]=$ors['No_Of_grades'];
}

    }

    //set vlaue zero for othe grades..
    for($i=0;$i<15;$i++){
        if(!isset($arrData[$i][32])){
            $arrData[$i][33]=0;
            }
        }
    //Now, we need to convert this data into XML. We convert using string concatenation.
    //Initialize <chart> element
    $strXML = "<chart caption='Exam result for CSC113A ' numberPrefix='' formatNumberScale='10' xAxisName='Grades' yAxisName='No Of Students' bgColor='995699,FEEFFF' exportEnabled='1' exportAtClient='0' exportAction='download' exportTargetWindow='_blank'>";
    //Convert data to XML and append
    foreach ($arrData as $arSubData)
        $strXML .= "<set label='" . $arSubData[1] . "' value='" . $arSubData[2] . "' />";

    //Close <chart> element
    $strXML .= "</chart>";

    //Create the chart - Column 3D Chart with data contained in strXML
    echo renderChart("FusionCharts/Column3D.swf", "", $strXML, "Results", 600, 300, false, false);
?>

<BR><BR>

</CENTER>
</BODY>
</HTML> 
```

我的代码输出是：![在此处输入图像描述](../Images/af2b46fedadc47586c20321d1b4f36f7.png)

如何将导出（下载）部分添加到我的 php、mysql 代码并获得以下输出： ![在此处输入图像描述](../Images/1133b8fd8ddd39f4d8691a5c4a78ed57.png)

**我如何将上面的 Javascript 融合图表导出代码应用到我的 PHP、MySql 代码？？？？需要你的大力帮助朋友..thanxx 这么多....**

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-26T10:06:50.510

1.  更新到最新版本的 FusionCharts XT（js、SWF 和 PHP 文件）。这是重要的一步。完成后请清除浏览器缓存。

2.  `FC_SetRenderer( "javascript" );`在你之前添加`echo renderChart("...`

3.  您的 XML 数据应包含`exportEnabled='1'`

# c++ - 选择 C++ 中的构造函数

> ID：14035520
> 
> 赞同：13
> 
> 时间：2012-12-26T02:53:11.217
> 
> 标签：c++, constructor, resolution

我正在通过构建自己的向量版本来练习 C++，名为“向量”。我有两个构造函数，填充构造函数和范围构造函数。他们的声明如下所示：

```
template <typename Type> 
class Vector {
public:
    // fill constructor
    Vector(size_t num, const Type& cont);

    // range constructor
    template<typename InputIterator> Vector(InputIterator first, InputIterator last);

    /* 
    other members
    ......
    */
} 
```

fill 构造函数用 num 的 val 填充容器；并且范围构造函数将范围 [first, last) 中的每个值复制到容器中。它们应该与 STL 向量的两个构造函数相同。

他们的定义如下：

```
//fill constructor 
template <typename Type> 
Vector<Type>::Vector(size_t num, const Type& cont){
    content = new Type[num];
    for (int i = 0; i < num; i ++)
        content[i] = cont;
    contentSize = contentCapacity = num;
}

// range constructor
template <typename Type> 
template<typename InputIterator>
Vector<Type>::Vector(InputIterator first, InputIterator last){
    this->content = new Type[last - first];

    int i = 0;
    for (InputIterator iitr = first; iitr != last; iitr ++, i ++)
    *(content + i) = *iitr;

    this->contentSize = this->contentCapacity = i;
} 
```

但是，当我尝试使用它们时，我很难区分它们。例如：

```
Vector<int> v1(3, 5); 
```

使用这行代码，我打算创建一个包含三个元素的 Vector，每个元素都是 5。但是编译器使用范围构造函数，将“3”和“5”都视为“InputIterator”的实例，毫无疑问，这会导致错误。

当然，如果我将代码更改为：

```
Vector<int> v1(size_t(3), 5); 
```

一切都很好，调用了填充构造函数。但这显然不直观且用户友好。

那么，有没有一种方法可以直观地使用填充构造函数？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-12-26T03:06:40.107

您可以使用`std::enable_if`（或者`boost::enable_if`如果您不使用 C++11）来消除构造函数的歧义。

```
#include <iostream>
#include <type_traits>
#include <vector>
using namespace std;

template <typename Type> 
class Vector {
public:
    // fill constructor
    Vector(size_t num, const Type& cont)
    { 
        cout << "Fill constructor" << endl;
    }

    // range constructor
    template<typename InputIterator> Vector(InputIterator first, InputIterator last,
        typename std::enable_if<!std::is_integral<InputIterator>::value>::type* = 0)
    { 
        cout << "Range constructor" << endl;
    }

};

int main()
{
    Vector<int> v1(3, 5);
    std::vector<int> v2(3, 5);
    Vector<int> v3(v2.begin(), v2.end());
} 
```

上述程序应首先通过检查类型是否为整数类型（因此不是迭代器）来调用填充构造函数。

顺便说一句，在您的范围构造函数的实现中，您应该使用`std::distance(first, last)`而不是`last - first`. 在迭代器上显式使用`-`运算符会将您限制在`RandomAccessIterator`类型上，但您希望支持`InputIterator`哪种是最通用的迭代器类型。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-26T03:12:01.213

甚至`std::vector`似乎有这个问题。

```
std::vector<int> v2(2,3); 
```

选择

```
template<class _Iter>
        vector(_Iter _First, _Iter _Last) 
```

在 Visual C++ 中，即使它应该更接近于非模板化案例..

编辑：上面的函数（正确）将构造委托给下面的函数。我完全迷路了。。

```
template<class _Iter>
        void _Construct(_Iter _Count, _Iter _Val, _Int_iterator_tag) 
```

编辑＃2啊！：

不知何故，下面的这个函数标识了要调用哪个版本的构造函数。

```
template<class _Iter> inline
    typename iterator_traits<_Iter>::iterator_category
        _Iter_cat(const _Iter&)
    {   // return category from iterator argument
    typename iterator_traits<_Iter>::iterator_category _Cat;
    return (_Cat);
    } 
```

上面显示的函数有（至少）2 个版本在第三个变量上重载，第三个变量是上述函数`_Construct`返回的标记。`_Iter_cat`根据该类别的类型，选择正确的重载`_Construct`。

最终编辑： `iterator_traits<_Iter>`是一个似乎为许多不同的常见品种模板化的类，每个品种都返回适当的“类别”类型

**解决方案**：在 MS VC++ 的情况下，第一个参数类型的模板专业化似乎是`std`库如何处理这种混乱情况（原始值类型）。也许您可以研究一下并效仿？

出现问题（我认为）是因为对于原始值类型，`Type`和`size_t`变量是相似的，因此选择了具有两种相同类型的模板版本。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-12-26T03:28:16.237

标准库实现所面临的问题是相同的。有几种方法可以解决它。

*   您可以为所有整数类型精心提供非模板重载构造函数（代替第一个参数）。

*   您可以使用基于 SFINAE 的技术（如`enable_if`）来确保不为整数参数选择范围构造函数。

*   `if`您可以在检测到整数参数（通过使用）后在运行时（通过使用）分支范围构造函数`is_integral`，并将控制重定向到正确的构造代码。分支条件将是一个编译时值，这意味着编译器可能会在编译时减少代码。

*   您可以简单地查看您的标准库实现版本，看​​看他们是如何做到的（尽管从抽象 C++ 语言的角度来看，他们的方法不需要是可移植的和/或有效的）。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-12-26T03:12:33.013

这种模糊性给早期的库实现者带来了问题。这就是所谓的“做正确的事”效应。据我所知，您需要[SFINAE](http://en.wikipedia.org/wiki/SFINAE)来解决它……它可能是该技术的首批应用之一。（一些编译器欺骗并破解了它们的重载解析内部结构，直到在核心语言中找到了解决方案。）

此问题的标准规范是 C++98 和 C++03 之间的主要区别之一。从 C++11，第 23.2.3 节开始：

> 14 对于本条和第 21 条中定义的每个序列容器：
> 
> — 如果构造函数
> 
> ```
>  template <class InputIterator>
>        X(InputIterator first, InputIterator last,
>          const allocator_type& alloc = allocator_type()) 
> ```
> 
> 使用不符合输入迭代器条件的类型 InputIterator 调用，则构造函数不应参与重载决议。
> 
> 15 实现确定类型不能作为输入迭代器的程度未指定，但至少整数类型不应作为输入迭代器。

# java - 使用静态方法比导入整个类便宜吗？

> ID：14035521
> 
> 赞同：1
> 
> 时间：2012-12-26T02:53:14.237
> 
> 标签：java, import, static-libraries, static-methods

我`mymethod`在一个相对较大的（库）类中有一个小的静态方法`com.package.pirulo`。我可以做以下两件事之一：要么我导入`com.package.pirulo`然后我只使用`pirulo.mymethod(...)`，要么我可以直接使用带有`com.package.pirulo.mymethod(...)`.

从资源/速度的角度来看，哪个更便宜？看起来第二个选项更便宜，但是因为`mymethod`可以调用其他方法，`com.package.pirulo`也许整个库总是以某种方式导入......

并且：第一个选项是否与实例化对象一样昂贵（相同的 POV）`pirulo`？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-26T02:56:12.200

导入在运行时完全没有区别，在编译时只有微不足道的（最多）差异。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-26T02:56:01.420

调用静态导入与使用完全限定名称在性能上没有区别。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-12-26T02:56:33.053

两种不同的导入方法之间几乎没有区别。

在极少数情况下，您真的应该非常担心对象的创建。

从极端微观管理的角度来看，最好不要制作一个对象，但它通常并不引人注目。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-12-26T02:56:11.290

从包中导入需要使用的类。

**导入单个方法**的唯一时间是静态导入，不，不会节省您的时间，如果这样做，它可以忽略不计，无论如何您都不应该这样做。

也就是说，有时静态导入会提高可读性。例如，java.lang.String.format。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-12-26T02:59:20.690

The import statements only make code readable and easy to be written. After code has been compiled, all the references are replaced by fully qualified name and unused imports are ignored. `String s;"` will become `java.lang.String s;` automatically so its does not matter.

# python - 编写具有多个使用 pydispatcher 进行消息调度的类的代码时如何组织信号的定义

> ID：14035522
> 
> 赞同：1
> 
> 时间：2012-12-26T02:53:37.980
> 
> 标签：python, events, signals

我一直在考虑创建一个信号模块并在那里声明所有信号定义，但不确定这是否是一种聪明的方法。建议表示赞赏。

# javascript - 如何使用 jquery 获取 html 5 多个文件上传变量的值？

> ID：14035530
> 
> 赞同：6
> 
> 时间：2012-12-26T02:55:50.623
> 
> 标签：javascript, jquery, multifile-uploader

即使我使用下面的 html 选择多个文件。

```
<input type="file" id="multiplefiles" name="uploadedfile[]" multiple> 
```

我只获得选择的第一个文件的值。我正在使用一个简单的：

```
var filelist = $("#multiplefiles").val() || [];
$.each(filelist, function(i, myfile) {
  console.log('found file '+i+' ='+myfile);
}); 
```

请告知我如何获取所有文件的列表...

例如在输入字段中选择的字符串是：C:\Users\Public\Pictures\Sample Pictures\Hydrangeas.jpg, C:\Users\Public\Pictures\Sample Pictures\Chrysanthemum.jpg, C:\Users\Public\Pictures \示例图片\upload-2.txt

从上面的逻辑我只得到：在日志中：

```
found file 0 =Hydrangeas.jpg 
```

泰。拉杰夫

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-12-26T03:21:06.167

这应该可以解决问题：

```
var filelist = document.getElementById("multiplefiles").files || [];
for (var i = 0; i < filelist.length; i++) {
    console.log('found file ' + i + ' = ' + filelist[i].name);
} 
```

一个工作的 jsFiddle 在[这里](http://jsfiddle.net/9KnA7/4/)。

# java - 外部访问 Jar 文件

> ID：14035532
> 
> 赞同：1
> 
> 时间：2012-12-26T02:55:57.380
> 
> 标签：java, methods, jar, external

所以，我有两个 jar 文件。Foo.jar 和 Bar.jar。

Bar.jar 有一个 Main.class 持有

```
public class Main {
    public static String bob(){
       return "bob";
    }
} 
```

然后在 Foo.jar 中，我希望能够访问“bob”方法，而不是将 jar 作为库或资源或类似的东西。它只是一个完全独立的 jar。这甚至可能吗..？

像这样

```
System.out.println(BarAsJarFile.Main.bob()); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-26T03:00:11.683

我不明白为什么在启动 JVM 时不能设置类路径（这样可以轻松包含多个 jar 文件），但是以后可以通过[编程将 jar 文件添加到类路径](https://stackoverflow.com/questions/402330/is-it-possible-to-add-to-classpath-dynamically-in-java)中。

# php - move_uploaded_file() 函数在引用另一个页面时不起作用

> ID：14035536
> 
> 赞同：2
> 
> 时间：2012-12-26T02:56:19.120
> 
> 标签：php

我在将 move_upload_file() 函数引用到另一个页面时遇到问题。它没有任何错误。但问题是所选文件没有被传输到指定目录。

我不知道是什么问题，并感谢任何帮助或建议。

这是代码：

第 1 页（正在输入的地方）：

```
 <form name='NewsForm' method='post' action='conf_news.php' enctype='multipart/form-data' >

 <input type="file" name="file" id="file" value='' >
 <input type='submit' name='AddNews' value='POST' >

 </form> 
```

它将代码带到另一个页面“conf_news.php”，我在其中引用了部分存储文件：第 2 页：

```
 $PicMessage = "";
    $PicName = addslashes( $_FILES["file"]["name"] );
    $PicType = addslashes( $_FILES['file']['type'] );
    $PicSize = addslashes( $_FILES['file']['size'] );
    $PicError = addslashes( $_FILES["file"]["error"] );
    $PicTempName = addslashes( $_FILES["file"]["tmp_name"] );

$allowedExt = array('jpeg', 'jpg', 'gif', 'png');
$a = explode(".", $PicName);
$extension = end($a); unset($a);

if((($PicType == "image/gif") 
|| ($PicType == "image/png") 
|| ($PicType == "image/jpeg")
|| ($PicType == "image/jpg") 
&& ($PicSize > 100)
&& in_array($extentions, $allowedExt))){

   if($PicError > 0){
       $PicMessage = "Error Type: ". $PicError. "<br />";
   }

    else{
       echo "Upload: ". $PicName. "<br />";
       echo "Type: ". $PicType. "<br />";
       echo "Size: ". ($PicSize / 1024). " Kb<br />";
       echo "Stored in: ". $PicTempName;

       if(file_exists("../photos/". $PicName)){
          $PicMessage = "File Already Exists";
       }

       else{
           move_uploaded_file($PicTempName, "../photos/". $PicName);
           $PicMessage = "Stored in: ". "../photos/". $PicName;
       }
      }

}

else{
$PicMessage = "Invalid File Type";
} 
```

图片消息显示文件已传输但 ptohos 文件夹为空。我实在想不通到底出了什么问题。

非常感谢所有愿意花时间帮助我的人。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-26T03:38:56.687

好的。我发现了问题。

in_array( **$** extentions , $allowedExt))){ 将其更改为**$extension** 。这是一个小错误，但足以延迟我们的工作。同时删除 add_slashes() 并尝试。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-26T03:02:53.197

Try to verify that the file is actually uploaded with POST request, because as it says in the manual for this function: `move_uploaded_file() ensures the safety of this operation by allowing only those files uploaded through PHP to be moved.` You can verify whether or not the file was uploaded through PHP with the function `is_uploaded_file()`. This will tell you whether or not the file is even capable of being used with `move_uploaded_file()`.

Replace your `else` statement with:

```
else if(is_uploaded_file($PicName)) {
  move_uploaded_file($PicTempName, "../photos/". $PicName);
  $PicMessage = "Stored in: ". "../photos/". $PicName;
} 
```

# perl - 在 Perl 中根据一项的值对二维数组进行排序，但有例外

> ID：14035544
> 
> 赞同：4
> 
> 时间：2012-12-26T02:57:54.423
> 
> 标签：perl, sorting

目前，我正在使用一个包含足球进球信息的二维数组。第一个数组中的每个项目都是一个数组，其中包含有关目标的不同信息。该数组中的第二项是分钟得分 (1-90)，因为我希望它们按顺序排列，这样我就可以确定它们是什么构成了得分线。我正在使用该“分钟”值进行排序：

```
@allinfogoals = sort { $a->[1] <=> $b->[1] } @allinfogoals; 
```

这很有效，直到我遇到加时赛进球。这些分钟显示为“90+2”或“45+3”。现在，我可以将它们加在一起，但这可能会使顺序不正确。在这种情况下，在半场结束前的进球可以存储为在下半场开始后不久进球后的进球。

所以，我正在寻找具有这种 90+x 格式的分钟并将它们拆分为“+”。我将第一个值存储在数组中定期存储分钟的位置，但我在数组的末尾添加了另一个值（第 12 项），我将第二部分（分钟到额外时间）放在那里。如果是常规目标，则为 0。

如何修改上面的排序以弥补这一点并使其保持正确的顺序？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-26T03:14:39.833

听起来您想先对一个键进行排序，如果该键相同，则您想对第二个键进行排序。

例如，您希望 45+2 在 45 和 46 之间排序。

您可以通过简单地使用来做到这一点：

```
@ls = sort { $a->[0] <=> $b->[0] || $a->[1] <=> $b->[1] } @ls 
```

只有当第一个密钥相同时，才会查询第二个密钥。

这是一个完整的例子：

```
my @allinfogoals=(
                  [ 46, 0 ],
                  [ 45, 2 ],
                  [ 45, 0 ],
                  [ 33, 0 ],
                  [ 91, 0 ],
                  [ 90, 2 ],
                 );

@allinfogoals=sort { $a->[0] <=> $b->[0] || $a->[1] <=> $b->[1] } @allinfogoals;

use Data::Dump; dd \@allinfogoals; 
```

输出是：

```
[[33, 0], [45, 0], [45, 2], [46, 0], [90, 2], [91, 0]] 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-26T03:50:35.470

这是一个“蛮力”解决方案，其中没有太多技巧，但可以完成工作。除非经过调整，否则它不适用于二维数据结构，但另一方面，我不知道您的数据结构是什么样的。

```
use strict;
use warnings;
use feature 'say';

my @data = qw(22 45+3 45 46 90 90+3);

my @sorted = map $_->[2],               # turn back to org string
        sort {
            $a->[0] <=> $b->[0] ||      # default sort by period number
            $a->[1] <=> $b->[1]         # or by minute
        } map mysort($_), @data;        # map all minutes to 3-element array

say for @sorted;

sub mysort {
    my $time = shift;
    if ($time =~ /45\+(\d+)/) {
        return [1, 45+$1, $time];
    } elsif ($time =~ /90\+(\d+)/) {
        return [2, 90+$1, $time];
    } else {
        my $period = ($time <= 45 ? 1 : 2);
        return [$period, $time, $time]
    }
} 
```

这使用[Schwartzian 变换](http://en.wikipedia.org/wiki/Schwartzian_transform)将每个分钟条目转换为一个三元素数组，由周期数、该周期内的分钟和原始字符串组成。这个脚本的输出是：

```
22
45
45+3
46
90
90+3 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-26T03:25:42.187

在这种特殊情况下，正如您所描述的那样，您还可以（正如有人回答但似乎再次删除）将您的加班时间转换为十分之一并按数字排序：

```
my @allinfogoals=qw(46 45+2 45 33 91 90+2);

@allinfogoals=map { s/[.]/+/; $_ } sort { $a <=> $b } map { s/[+]/./; $_ } @allinfogoals;

use Data::Dump; dd \@allinfogoals; 
```

...然后转换回来。输出：

```
[33, 45, "45+2", 46, "90+2", 91] 
```

# android - Android ListView 上下文菜单

> ID：14035550
> 
> 赞同：1
> 
> 时间：2012-12-26T02:59:32.407
> 
> 标签：android, android-listview, android-contextmenu

我正在尝试创建一个`ContextMenu`当用户在我的`ListView`. 但是，当我点击我的项目时，我的代码没有显示任何内容。有人可以检查我的代码。谢谢你。

```
public class MyD extends SherlockListFragment implements
        ActionBar.TabListener {

    private File file;
    private List<String> myList;

    private Fragment mFragment;

    private ListView DLListView;
    private ArrayAdapter<String> listAdapter;

    @Override
    public void onActivityCreated(Bundle savedInstanceState) {
        super.onActivityCreated(savedInstanceState);
        getActivity().setContentView(R.layout.dl_listview);

        View empty = getActivity().findViewById(R.id.empty);
        DLListView = (ListView) getActivity().findViewById(R.id.DLListView);
        DLListView.setEmptyView(empty);

        if (!Environment.getExternalStorageState().equals(
                Environment.MEDIA_MOUNTED)) {
            Toast.makeText(getActivity(),
                    "Error! No SDCARD Found!",
                    Toast.LENGTH_LONG).show();
        } else {
            File directory = new File(Environment.getExternalStorageDirectory()
                    + File.separator + "St");
            directory.mkdirs();
        }
        DLListView = (ListView) getActivity().findViewById(R.id.DLListView);

        myList = new ArrayList<String>();

        File sdCard = Environment.getExternalStorageDirectory();
        file = new File(sdCard.getAbsolutePath() + "/St/");

        File list[] = file.listFiles();

        for (int i = 0; i < list.length; i++) {
            String fileName = list[i].getName();
            fileName = fileName.replace(".txt", "");
            myList.add(fileName);

        }

        listAdapter = new ArrayAdapter<String>(getActivity(),
                R.layout.simplerow, myList);

        DLListView.setAdapter(listAdapter);

        DLListView.setOnItemClickListener(new OnItemClickListener() {
            @Override
            public void onItemClick(AdapterView<?> parent, View view,
                    int position, long id) {
                // TODO Auto-generated method stub
                String textToPass = myList.get(position);
                Intent i = new Intent(getActivity(), ViewActivity.class);
                textToPass = textToPass.replace(textToPass + "", textToPass
                        + ".txt");
                i.putExtra("textToPass", textToPass);
                startActivity(i);
            }
        });

    DLListView.setOnItemLongClickListener(new OnItemLongClickListener() {

    @Override
    public boolean onItemLongClick(AdapterView<?> parent, View view,
            int position, long id) {
        // TODO Auto-generated method stub
        return false;
    }
});

}

    public void onCreateContextMenu(ContextMenu menu, View v,ContextMenuInfo menuInfo)
    {
       super.onCreateContextMenu(menu, v, menuInfo);
       AdapterContextMenuInfo info = (AdapterContextMenuInfo) menuInfo;
       String name = ((TextView) info.targetView).getText().toString();
       menu.setHeaderTitle(name);      
       menu.add(0,v.getId(), 0, "Play");    
       menu.add(0,v.getId(),1,"Delete"); 
    } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-26T03:06:22.650

如果您的意思是 longClick，那么您缺少`OnItemLongClickListener()`.

并且，要调用上下文菜单，请检查：[如何调用上下文菜单](https://stackoverflow.com/questions/1942600/how-to-call-context-menu)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-26T03:38:17.993

试试这个：

```
DLListView.setOnItemLongClickListener(new OnItemLongClickListener() {

    @Override
    public boolean onItemLongClick(AdapterView<?> parent, View view,
            int position, long id) {
        // TODO Auto-generated method stub

          registerForContextMenu( view );
          openContextMenu( view );        

        return false;
    }
}); 
```

即使您`closeContextMenu()`想关闭也可以使用。希望这可以帮助。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2019-04-03T20:02:05.863

您必须注册 ViewGroup (DLListView) 才能识别菜单中的组件。

```
 DLListView = (ListView) getActivity().findViewById(R.id.DLListView);
 registerForContextMenu(DLListView); 
```

有了这些更改，就不必在 ListView 组件中注册每个元素。

# java - I just write a wrapcommand in java but sometimes it do not print the command output. WHY

> ID：14035551
> 
> 赞同：0
> 
> 时间：2012-12-26T02:59:37.917
> 
> 标签：java, shell, process, runtime.exec

I just write a simple commandwrapper in java, this is construction function:

```
Process process;
Thread in;
Thread out; 

public CommandWrapper(Process process) {
    this.process = process;
    final InputStream inputStream = process.getInputStream();
    // final BufferedReader
    //final BufferedReader r = new BufferedReader(new InputStreamReader(inputStream));
    final byte[] buffer = new byte[1024];
    out = new Thread() {
        // String line;
        int lineNumber = 0;

        public void run() {
            try {
                while (true) {
                    int count = inputStream.read(buffer);
                    System.out.println(lineNumber + ":"
                            + new String(buffer, 0, count - 1));
                    // line=r.readLine();
                    // System.out.println(lineNumber+":"+line);
                    lineNumber++;
                }
            } catch (Exception e) {

            }
        }
    };
    final BufferedReader reader = new BufferedReader(new InputStreamReader(
            System.in));
    final OutputStream outputStream = process.getOutputStream();
    in = new Thread() {
        String line;

        public void run() {
            try {
                //while (true) {
                    outputStream.write((reader.readLine() + "/n")
                            .getBytes());
                    outputStream.flush();
                //}
            } catch (Exception e) {

            }
        }
    };
}

public void startIn() {
    in.start();
} 
```

This is when it invoke:

```
public static void main(String[] args) {
    try {
        CommandWrapper command = new CommandWrapper(Runtime.getRuntime()
                .exec("wget www.google.com"));
        //command.startIn();
        command.startOut();
    } catch (Exception e) {
        e.printStackTrace();
    }
} 
```

It works OK when I run simple command like ls -l or other local commander, but when I want to run wget command it is print out nothing as output. I do know why.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-26T03:30:19.860

从您展示的代码和您对如何使用它的描述来看，最好的猜测是*发生了异常，然后您默默地吞下了它*。每当您有一个空`catch`块时，都会发生这种情况，如下所示：

```
catch (Exception e) {
} 
```

你碰巧在你的线程`run()`方法中有一个。`out`

## 默默地吞下异常是非常糟糕的做法。

你***永远***不应该这样做！根据您的应用程序，适当的解决方案会有所不同，但由于您正在编写控制台应用程序，因此您可能希望打印异常的堆栈跟踪。在 Java 中，这是通过以下方式完成的`e.printStackTrace()`：

```
catch (Exception e) {
    e.printStackTrace();
} 
```

另一种选择（在这种特定情况下可能不合适）是*重新抛出*异常，可能在将其*包装*在另一个异常中之后（例如，您专门为您的应用程序编写的异常）：

```
catch (Exception e) {
    throw e;
}
// or
catch (Exception e) {
    throw new MyOwnException(e);
} 
```

执行这两个中的任何一个（打印堆栈跟踪或重新抛出）将确保没有异常被忽视。

### 但是，没有例外的规则；）

在某些情况下，使用空`catch`子句是合适的。如果您知道某些操作可能会引发异常并且您只想在它发生时继续，那么空`catch`子句是一个很好的方法。然而，这被挪用的情况仅限于（至少）以下情况：

1.  **您必须知道异常的具体类型。**您*永远*不想捕获*一般异常*（即`catch (Exception e)`，因为您可能无法预测的任何原因可能会引发该异常。如果您使用空`catch`子句，请*始终捕获特定的异常类型（例如`IOException`）*。

2.  **您必须知道抛出异常的原因。**你应该只吞下你知道起源的异常。如果您吞下任何其他异常，您最终会遇到这种情况，您的代码没有按照您的预期执行并且您无法理解原因。被吞下的异常极难调试，因为它们被吞了，因此被隐藏了。

3.  **您必须知道您不关心异常。**使用空`catch`子句的原因主要是（阅读：*仅*）处理您正在使用的代码将某些东西视为异常的情况，而您却没有。在这种情况下，我们所说的*例外*是指“不应该发生的事情，如果发生了，那就是严重错误的事情”。

**`catch`适合使用空子句的示例**
： 假设您正在使用其他人的代码打开文件进行读取，给定文件的绝对路径。如果文件不存在，大多数此类例程都会抛出异常 - 这是客户端代码（即调用“打开文件例程”的代码）的工作，以确保文件在尝试打开之前存在。例如，如果运行程序的用户没有读取文件的权限，也会引发异常。

现在，您可能并不真正关心*为什么*无法打开文件，但如果无法打开，您只想继续 - 在这种情况下，您会吞下所有与读取文件相关的异常（在 Java 中，可能是`IOException`一些种类）。*请注意，您**不会**吞下所有异常 - 只有与打开文件相关的异常！*

# iphone - 如何实现appflow的欢迎页动画

> ID：14035553
> 
> 赞同：2
> 
> 时间：2012-12-26T03:00:15.660
> 
> 标签：iphone, objective-c, ios, animation

下图来自 AppFlow 欢迎页面动画。

不是启动图像，这只是欢迎页面的一部分，是.... 不是所有欢迎页面的一部分，我无法在此处显示动画，因此我截取了该动画的一些帧并在此处重新排列。

我确信这不是 gif 或任何图像动画，应该由 objc 代码完成。任何人都可以给我一些线程或示例代码会很棒！

谢谢

![AppFlow 欢迎页面动画](../Images/7fbf76c12482ab4d8260dbaf92f2c688.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-26T03:27:28.793

在 iOS 中有很多显示动画的方法。对于您上面描述的动画，我建议每帧制作一个 PNG 图像。然后您可以显示动画，`UIImageView`如下所示：

```
imageView.animationImages = [NSArray arrayWithObjects:[UIImage imageNamed:@"1.png"], [UIImage imageNamed:@"2.png"], nil];
imageView.animationDuration = 1;
imageView.animationRepeatCount = 0;
[imageView startAnimating]; 
```

将`UIImageView`放在欢迎视图控制器上。

# java - 是否有任何将 CAD 转换为 SVG 的库？

> ID：14035557
> 
> 赞同：19
> 
> 时间：2012-12-26T03:00:49.293
> 
> 标签：java, c++, svg, cad

我正在寻找一个可以将 CAD 文件（DWG、DXF）转换为 SVG 格式的库。该库应该能够在 Linux 平台上运行。谁能告诉我哪个图书馆可以做到这一点？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-12-26T03:50:49.780

试试这些工具。

1.  [http://etc.nkadesign.com/Download/Cad2svg](http://etc.nkadesign.com/Download/Cad2svg)

cad2svg 是一个简单的 Linux 命令行实用程序，可自动将 AutoCAD 文件（dwg 和 dxf）转换为 SVG

*此链接不再有效：*

*2) [http://davinder.in/blog/how-install-libredwg-ubuntu](http://davinder.in/blog/how-install-libredwg-ubuntu)*

GNU LibreDWG 是一个免费的 C 库，用于处理 DWG 文件。

3.  [http://kabeja.sourceforge.net/](http://kabeja.sourceforge.net/)

Kabeja 是一个用于解析、处理和转换 Autodesk 的 DXF 格式的 Java 库

4.  [http://sourceforge.net/projects/dxf-svg-convert](http://sourceforge.net/projects/dxf-svg-convert)

一个 dxf 到 svg 的转换器。
可用于创建带有额外信息（如图层）的纯 svg 文件或 Inkscape svg 文件。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2014-08-06T13:17:09.113

OpenDesignAlliance目前提供了此类[事物](https://www.opendesign.com)的唯一有用实现。
您需要[用于 .NET 和 Java 的](https://www.opendesign.com/the_oda_platform/teigha_dot_net)[Theiga](https://www.opendesign.com/the_oda_platform/Teigha)和Theiga 。

> 2013 年，ODA 使用 SWIG 提供的 Java 支持创建了“Teigha for Java”。
> Teigha for Java 包括以下内容：

*   Java 访问 .dwg 和 .dgn 文件的完整 Teigha API。
*   支持 Windows、Linux 和 Mac 平台。API 与 Teigha.NET 非常相似，简化了语言之间的转换。

此外，如果您使用**C#**，[**WoutWare** CadLib](https://www.woutware.com/)将是一个非常好的**完全托管**的商业选项，用于将 DWG/DXF 转换为 SVG（同时保留图层）。它还可以在带有 .NET-Core 的 Linux 和 Mac 上运行（不需要本机二进制文件）。

# vb.net - Code does not work but has no errors

> ID：14035561
> 
> 赞同：0
> 
> 时间：2012-12-26T03:01:44.947
> 
> 标签：vb.net, ms-access, ms-access-2007, vb.net-2010

I'm working on an information system and here's my syntax for update, it shows no errors, but it does not update my table. Anyone can help on this matter? By the way, I'm using VB.Net 2010 and MS Access 2007.

```
Try
        Dim conn As New OleDbConnection(gConnectionString)
        If conn.State = ConnectionState.Closed Then
            conn.Open()
        End If
        Try
            Dim comm As New OleDbCommand( "UPDATE PropertiesPayors SET [PayorName]=@PayorName,[LotNumber]=@LotNumber,[LotArea]=@LotArea,[DateOfAward]=@DateOfAward,[DateDueForFullPayment]=@DateDueForFullPayment,[PurchasePrice]=@PurchasePrice,[ReAppraisedValue]=@ReAppraisedValue,[AmountDue]=@AmountDue,[TotalAmountPaid]=@TotalAmountPaid,[AmountUnpaid]=@AmountUnpaid,[PropertyRemarks]=@PropertyRemarks WHERE [PropertyID]=@PropertyPayorID ", conn)
            With comm
                With .Parameters
                    .AddWithValue("@PropertyPropertyID", Val(propertyPayorSessionID.ToString))
                    .AddWithValue("@PayorName", txtPayorName.Text)
                    .AddWithValue("@LotNumber", txtLotNumber.Text)
                    .AddWithValue("@LotArea", Val(txtLotArea.Text))
                    .AddWithValue("@DateOfAward", txtDateOfAward.Text.ToString)
                    .AddWithValue("@DateDueForFullPayment", txtDateOfFullPayment.Text.ToString)
                    .AddWithValue("@PurchasePrice", Val(txtPurchasePrice.Text))
                    .AddWithValue("@ReAppraisedValue", Val(txtReAppraisedValue.Text))
                    .AddWithValue("@AmountDue", Val(txtAmountDue.Text))
                    .AddWithValue("@TotalAmountPaid", Val(txtTotalAmountPaid.Text))
                    .AddWithValue("@AmountUnpaid", Val(txtAmountUnpaid.Text))
                    .AddWithValue("@PropertyRemarks", txtRemarks.Text)
                End With
                .ExecuteNonQuery()
            End With
            msg = MsgBox("Record Updated.", MsgBoxStyle.Information + MsgBoxStyle.OkOnly, "Update Payor")
        Catch myError As Exception
            MsgBox("Error: " & myError.Message, MsgBoxStyle.Critical + MsgBoxStyle.OkOnly, "Query Error")
        End Try
    Catch myError As Exception
        MsgBox("Error: " & myError.Message, MsgBoxStyle.Critical + MsgBoxStyle.OkOnly, "Connection Error")
    End Try 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-26T03:51:20.780

你只是在你的代码上有一个错字

代替

```
@PropertyPropertyID 
```

和

```
@PropertyPayorID 
```

然后安排与更新语句相同的参数顺序。

试试这个：

```
 Try
            Dim conn As New OleDbConnection(gConnectionString)
            If conn.State = ConnectionState.Closed Then
                conn.Open()
            End If
            Try
                  Dim comm As New OleDbCommand("UPDATE PropertiesPayors SET [PayorName]=@PayorName,[LotNumber]=@LotNumber,[LotArea]=@LotArea,[DateOfAward]=@DateOfAward,[DateDueForFullPayment]=@DateDueForFullPayment,[PurchasePrice]=@PurchasePrice,[ReAppraisedValue]=@ReAppraisedValue,[AmountDue]=@AmountDue,[TotalAmountPaid]=@TotalAmountPaid,[AmountUnpaid]=@AmountUnpaid,[PropertyRemarks]=@PropertyRemarks WHERE [PropertyID]=@PropertyPayorID ", conn)
            With comm
                With .Parameters
                    '.AddWithValue("@PropertyPayorID", Val(propertyPayorSessionID.ToString)) move this to the last part
                    .AddWithValue("@PayorName", txtPayorName.Text)
                    .AddWithValue("@LotNumber", txtLotNumber.Text)
                    .AddWithValue("@LotArea", Val(txtLotArea.Text))
                    .AddWithValue("@DateOfAward", txtDateOfAward.Text.ToString)
                    .AddWithValue("@DateDueForFullPayment", txtDateOfFullPayment.Text.ToString)
                    .AddWithValue("@PurchasePrice", Val(txtPurchasePrice.Text))
                    .AddWithValue("@ReAppraisedValue", Val(txtReAppraisedValue.Text))
                    .AddWithValue("@AmountDue", Val(txtAmountDue.Text))
                    .AddWithValue("@TotalAmountPaid", Val(txtTotalAmountPaid.Text))
                    .AddWithValue("@AmountUnpaid", Val(txtAmountUnpaid.Text))
                    .AddWithValue("@PropertyRemarks", txtRemarks.Text)
                    .AddWithValue("@PropertyPayorID", Val(propertyPayorSessionID.ToString))
                End With
                .ExecuteNonQuery()
            End With
                msg = MsgBox("Record Updated.", MsgBoxStyle.Information + MsgBoxStyle.OkOnly, "Update Payor")
            Catch myError As Exception
                MsgBox("Error: " & myError.Message, MsgBoxStyle.Critical + MsgBoxStyle.OkOnly, "Query Error")
            End Try
        Catch myError As Exception
            MsgBox("Error: " & myError.Message, MsgBoxStyle.Critical + MsgBoxStyle.OkOnly, "Connection Error")
        End Try 
```

这将解决您的问题。

另请参阅：[OleDbCommand 参数顺序和优先级](https://stackoverflow.com/questions/1476770/oledbcommand-parameters-order-and-priority)以供参考。

此致！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-28T15:29:16.507

命令语句 .ExecuteNonQuery 返回受影响的行数。

这意味着如果您使用...

```
intRowsAffected = .ExecuteNonQuery() 
```

并且返回到变量 intRowsAffected 的值是零（0）

那么这意味着您的字段 PROPERTYID 具有相同值的记录（意味着您传递到参数集合的值...... PROPERTYPAYORSESSIONID）不存在！

这就是为什么您没有收到任何错误并且您的数据库也没有被更新的原因。

仔细检查一下...您的代码语句 .EXECUTENONQUERY() 在哪里...

您可以将其替换为以下内容...

```
intRowsAffected = .ExecuteNonQuery()
Messagebox(intRowsAffected & " Data rows were updated.") 
```

如果消息框显示零行已更新（没有行已更新），那么您的下一步将是手动检查数据库并查看该行是否实际存在以及它是否具有您用来识别该行的相同键值 - 其中我假设是财产付款人会话ID。

还要记住，会话 ID 很容易随着每个会话而变化，而不是一直是静态的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-26T05:17:20.813

如果我没记错的话，默认情况下，查询中的占位符名称与参数名称之间没有关系。正如 BizApps 所说，您应该按照查询中定义的顺序放置参数；这意味着`PropertyPayorID`当您将它添加到您的参数集合时，它应该排在最后。参数集合的名称只能在本地使用；比如改变个别参数的一些属性。

另外，我不记得您是否可以在查询字符串中使用命名参数作为占位符，或者是否必须使用 a`?`来代替；就像是`Update PropertiesPayors SET [PayorName]=?, ...`

# ajax - 仅更新 mvc 3 页面中包含的部分视图？

> ID：14035563
> 
> 赞同：4
> 
> 时间：2012-12-26T03:02:08.050
> 
> 标签：ajax, asp.net-mvc, sql-update, partial-views

我有一个**MVC 3**页面，它返回一个用户响应列表，每个响应都有一个名为“备忘录”的部分视图（显示/添加备忘录）。当我向响应添加备忘录时，它应该更新数据库和该响应的备忘录列表。它应该是通过 ajax 进行的部分页面更新，它只影响部分视图“备忘录”。

包含“备忘录”的视图 Response.chtml：

```
@using (Html.BeginForm("Response", "User", FormMethod.Post, new { id = "UserResponse" }))
   {
      .... code removed ....
@foreach (var response in Model)
                {
                <div class="qna"><input type="text" id=@response.responseId value="@response.ResponseText" />  

                 <div>@Html.Partial("_memo", response.responseId)</div>
                }
        ..... 
```

部分页面“_memo.chtml”：

```
<div>add memo</div> 

<ul id="memos">                                          
@foreach (var memo in Model) {                           
    <li>@memo.Text</li>                                       
}                                                           
</ul>                                                       

<form method="post" id="memoForm"                        
      action="@Url.Action("AddMemo")">                   

    @Html.TextArea("Memo", new { rows = 5, cols = 50 })   
    <br />
    <input type="submit" value="Add" />
</form> 
```

用于查看用户/响应的控制器：

```
[HttpGet]
        public ActionResult Response(id)
        {
           .....
            return View(responses); 
```

我刚开始使用上面的代码，需要帮助填补空白。

1.  如果我将响应 ID 传递给部分视图，如何拉取该响应的备忘录列表？会不会涉及ajax？（而不是 .. `Partial("_memo", response.memos)`）

2.  如何通过 ajax 调用更新部分视图。什么是客户端的 ajax 调用（示例代码）以及控制器的外观？ajax 调用成功后，如何更新列表备忘录`div="memos"`以反映新的备忘录？

3.  Response中的表单动作会和部分视图Memo的表单动作冲突吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-28T13:14:16.040

问题的答案：

1.  您不应该将 responseId 传递给部分，您应该从响应对象传递备忘录集合，并使您的部分视图强类型化到该集合。
2.  请参阅下面的完整代码示例。
3.  您不需要部分表单，因为您正在进行简单的 ajax 调用来添加新备忘录。请参阅下面的完整代码示例。

这是我目前正在从事的一个项目的修改示例：

有一些代码要遵循，所以这里是：

这是我的模型。职业规划表上有几个部分，其中一个是选择和更新能力的部分。SelectCompetencies 模型中包含一系列能力。用户将能够添加能力。当他们这样做时，它将被添加到数据库中，并将更新部分中的能力列表。

```
public class CareerPlanningFormViewModel
{
    // code removed ...

    public SelectCompetenciesModel SelectCompetencies { get; set; }

    // code removed ...
}

public class SelectCompetenciesModel
{
    public int CareerPlanningFormID { get; set; }

    public IList<CompetencyModel> Competencies { get; set; }

    public byte MaximumCompetenciesAllowed { get; set; }
}

public class CompetencyModel
{
    public int CompetencyID { get; set; }

    public int? CompetencyOptionID { get; set; }

    public string ActionPlan { get; set; }

    public IDictionary<int, string> CompetencyOptions { get; set; }
} 
```

职业规划表主视图：/Views/CPF/CareerPlanningForm.cshtml

```
@model MyNamespace.Models.CareerPlanningForm.CareerPlanningFormViewModel
<link rel="stylesheet" href="@Url.Content("~/Content/CreateCPF.css")" />
@using (Html.BeginForm())
{
    // other sections loaded here...
    // code removed for brevity...

    @Html.Partial("SelectCompetencies", Model.SelectCompetencies)

    // other sections loaded here...
    // code removed for brevity...
} 
```

SelectCompetencies 部分：/Views/CPF/SelectCompetencies.cshtml 用户将填写新的行动计划文本并单击添加能力按钮。这将通过 ajax 发布到 CPFController/NewCompetencyTemplate

```
@model MyNamespace.Models.CareerPlanningForm.SelectCompetenciesModel
@Html.HiddenFor(m => m.CareerPlanningFormID)
<h3>Select Competencies</h3>
<p class="guidance">
    Select up to @Model.MaximumCompetenciesAllowed competencies to focus on improving.
</p>
<table id="CompetenciesTable">
    <thead>
        <tr>
            <th>Competency</th>
            <th>Action Plan:</th>
        </tr>
    </thead>
    <tbody>
        @for (int i = 0; i < Model.Competencies.Count(); i++)
        {
            @Html.EditorFor(m => m.Competencies[i])
        }
    </tbody>
    <tfoot id="CompetenciesTableFooter" class="@(Model.Competencies.Count() < Model.MaximumCompetenciesAllowed ? "" : "hidden")">
        <tr>
            <td colspan="2">
                @Html.TextArea("NewActionPlanText")
                @Html.Button(ButtonType.Button, "Add Another Competency", "add", new { id = "AddCompetencyButton" })
            </td>
        </tr>
    </tfoot>
</table>
@section script
{
    <script>
        jQuery(document).ready(function ($) {

            var competenciesTableBody = $('#CompetenciesTable tbody'),
                competenciesTableFooter = $('#CompetenciesTableFooter'),
                addCompetencyButton = $('#AddCompetencyButton'),
                newCompetencyTemplateUrl = '@Url.Content("~/CPF/NewCompetencyTemplate")',
                count = competenciesTableBody.find('tr').length,
                newActionPlanText = $('#NewActionPlanText'),
                careerPlanningFormID = $('#CareerPlanningFormID');

            addCompetencyButton.click(function () {
                $.ajax({
                    url: newCompetencyTemplateUrl(),
                    type: 'POST',
                    data: {
                        careerPlanningFormID: careerPlanningFormID,
                        actionPlan: newActionPlanText,
                        itemCount: count
                    },
                    dataType: 'html',
                    success: function (data) {
                        var elements = $(data);

                        // other code removed here...

                        competenciesTableBody.append(elements);

                        // other code removed here...
                    }
                });
            });    

        });
    </script>
} 
```

视图/CPF/EditorTemplates/CompetencyModel.cshtml

```
@model MyNamespace.Models.CareerPlanningForm.CompetencyModel
<tr class="competency">
    <td>
        @Html.DropDownListFor(m => m.CompetencyOptionID, new SelectList(Model.CompetencyOptions, "Key", "Value"), "Select competency...")
    </td>
    <td>
        @Html.TextAreaFor(m => m.ActionPlan, new { @class = "competencyActionPlan" })
        @Html.HiddenFor(m => m.CompetencyID)
    </td>
</tr> 
```

包含添加新能力的操作的控制器：/Controllers/CPFController.cs

这将调用 CareerPlanningFormService 来添加新的能力，并将返回 NewCompetencyTemplate 的部分视图，该视图将呈现新的能力

```
public class CPFController : Controller
{
    private readonly ICareerPlanningFormService careerPlanningFormService;

    public CPFController(ICareerPlanningFormService careerPlanningFormService)
    {
        this.careerPlanningFormService = careerPlanningFormService;
    }

    [HttpPost]
    public PartialViewResult NewCompetencyTemplate(int careerPlanningFormID, int itemCount, string newActionPlanText)
    {
        var count = itemCount + 1;

        // Even though we're only rendering a single item template, we use a list
        // to trick MVC into generating fields with correctly indexed name attributes
        // i.e. Competencies[1].ActionPlan
        var model = new SelectCompetenciesModel
        {
            Competencies = Enumerable.Repeat<CompetencyModel>(null, count).ToList()
        };

        model.Competencies[count - 1] = this.careerPlanningFormService.BuildNewCompetencyModel(careerPlanningFormID, newActionPlanText);

        return this.PartialView(model);
    }
} 
```

我的服务类：CareerPlanningFormService.cs

这处理业务逻辑并调用存储库以将项目添加到数据库并返回新的 CompetencyModel

```
public class CareerPlanningFormService : ICareerPlanningFormService
{
    private readonly IMyRenamedRepository repository;
    private readonly IPrincipal currentUser;

    public CareerPlanningFormService(
        IMyRenamedRepository repository,
        IPrincipal currentUser)
    {
        this.repository = repository;
        this.currentUser = currentUser;
    }

    public CompetencyModel BuildNewCompetencyModel(int careerPlanningFormID, string newActionPlanText)
    {
        var competency = new Competency
        {
            CareerPlanningFormID = careerPlanningFormID,
            CompetencyOptionID = null,
            ActionPlan = newActionPlanText
        };

        this.repository.Add(competency);
        this.repository.Commit();

        return new CompetencyModel
        {
            CompetencyID = competency.CompetencyID,
            CompetencyOptionID = competency.CompetencyOptionID,
            ActionPlan = competency.ActionPlan,
            CompetencyOptions = this.GetCompetencyOptionsForCareerPlanningFormID(careerPlanningFormID)
        };
    }
} 
```

现在，NewCompetencyTemplate 的部分内容：Views/CPF/NewCompetencyTemplate.cshtml

这很简单，它只是呈现与上面相同的编辑器模板，用于集合中的最后一个能力（我们刚刚添加）

```
@model MyNamespace.Models.CareerPlanningForm.SelectCompetenciesViewModel
@Html.EditorFor(m => m.Competencies[Model.Competencies.Count() - 1]) 
```

当 ajax 调用成功时，它会从它调用的控制器操作方法接收到这个部分返回。然后它获取部分并将其附加到能力表主体

```
// snippet from ajax call above
competenciesTableBody.append(elements); 
```

我希望这有帮助。如果您有任何其他问题，请告诉我。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-26T18:26:09.173

虽然您可以通过返回包含更新内容的局部视图来做到这一点是正确的，但您也可以考虑使用 jQuery 的 load 方法。

看[这里](http://api.jquery.com/load/)，特别是“加载页面片段”部分。基本上，您可以再次获取原始页面，jQuery 将“提取”您想要的内容，只要它可以被选择器（例如 div id）作为目标。

请注意，*此解决方案并非在所有情况下都适用，*因为服务器的响应中会有多余的标记，因为您将丢弃页面内容的其余部分并仅使用更新的部分。

# asp.net - SQL SELECT using a variable condition after WHERE

> ID：14035564
> 
> 赞同：-1
> 
> 时间：2012-12-26T03:02:23.857
> 
> 标签：asp.net, mysql, variables, select, where

I am using ASP.NET with the Webpages model and have created a database for users to post to, which is all great, then I created a page so users can edit their posts, however I want it so users can only edit their own posts.

To do this, I tried the following:

I made a variable

```
var EmailMatch = WebSecurity.CurrentUserName; 
```

so if I put @EmailMatch anywhere in the html markup it will display the email address of the user who is currently logged in. Now in order to display only the posts that this user has made, I used this select statement:

```
var selectAllString = "SELECT * FROM SaleData WHERE Email = '@EmailMatch'"; 
```

In theory I am thinking this should work, because when the user makes a post it sends their email address to the database under the field 'Email' and it should display records that are equal to the user currently logged in. However this statement returns 0 results, I have tried all I can think of with no success, this is my last resort, can someone please tell me what I am missing? Thanks in advance..

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-26T03:14:53.617

正确的方法是通过参数化查询。永远不要将您无法控制的字符串连接到查询中。

```
var EmailMatch = WebSecurity.CurrentUserName;
var selectAllString = "SELECT * FROM SaleData WHERE Email = @EmailMatch";
SqlCommand cmd = new SqlCommand(s);
cmd.Parameters.Add("@EmailMatch", EmailMatch);
var resultsTable = cmd.ExecuteReader(); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-26T03:07:12.133

尝试这个：

```
var selectAllString = "SELECT * FROM SaleData WHERE Email = '"+EmailMatch+"'"; 
```

或者为了避免 SQL 注入，你的 SQL 语句是正确的，但你必须在你的代码中添加这个：

```
using (OleDbConnection CON = new OleDbConnection("your connection string")) {
   OleDbCommand Com = CON.CreateCommand();
   Com.CommandText = "SELECT * FROM SaleData WHERE Email = @EmailMatch";
        Com.CommandType = CommandType.Text;
        Com.CommandTimeout = 0;
        Com.Connection.Open();
        Com.Parameters.AddWithValue("EmailMatch",EmailMatch);
   ...
   // continue your code from here... 
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-26T03:07:00.697

```
var selectAllString = "SELECT * FROM SaleData WHERE Email = '" + EmailMatch + "'"; 
```

Note: This could possibly expose you to SQL Injection attacks.

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-12-26T03:22:12.547

```
cmd = new MySqlCommand("SELECT * FROM SaleData WHERE Email = @EmailMatch", MySqlConn.conn);
cmd.Parameters.AddWithValue("@EmailMatch", EmailMatch);
cmd.Prepare();
cmd.ExecuteReader(); 
```

# php - How to validate or constrain direct SQL input from user?

> ID：14035569
> 
> 赞同：6
> 
> 时间：2012-12-26T03:04:06.207
> 
> 标签：php, mysql, api, validation, sql-injection

I am going to provide SQL console like data.stackexchange.com for developers on one of the sites I have. The problem is I can not let them execute all type of SQL. So there will be some constrains. Here are some example constrains

*   No query can contain `COUNT()` function
*   Every query must contain `LIMIT` with maximum value `100`
*   Number of column can not be more than `5`
*   Some tables' data will not be accessible due to privacy region.
*   Only `SELECT` statements will be allowed to be used.

### What I am doing right now?

I using regular expression to filter these. Also planning to invoke EXPLAIN or similar query to determine its impact in db prior to executing.

Is there any better way than regex? How it's done on data.SE? Is there anything else I should be worried about?

## Update 1

These two rules can be applied by restricting user permission in database server.

*   Some tables' data will not be accessible due to privacy region.
*   Only `SELECT` statements will be allowed to be used.

So only problem is to validate the SQL

## Update 2

I know If I write an SQL parser it'll do. It'll be like writing JS interpreter just remove `eval()` as its bad practice. So writing an SQL parser from scratch is really not an option. here.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-26T04:28:36.033

您可以为 yacc 创建包含 SQL 子集的新语法。比你能用这个语法检查输入 SQL。 [SQL lex yacc 语法](https://stackoverflow.com/questions/8656926/sql-lex-yacc-grammar)

# jquery - hide element using jquery mobile

> ID：14035572
> 
> 赞同：0
> 
> 时间：2012-12-26T03:05:16.227
> 
> 标签：jquery, mobile, hide

I have the following element nested among others, how can I get hold of this element either by css class or attribute 'button_uid' and hide this div?

```
<div class="segment_0" button_uid="btn" /> 
```

Thanks,

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-26T03:11:58.623

在 CSS 中，您可以使用

```
.segment_0 {visibility:hidden;} 
```

或者

```
.segment_0 {visibility:none;} 
```

# android - Phone (iPhone & Android) only css

> ID：14035581
> 
> 赞同：0
> 
> 时间：2012-12-26T03:07:04.163
> 
> 标签：android, iphone, css

I am trying to use some CSS that is exclusively for phones. I have tried to do something like this and seen similar suggestions elsewhere.

```
@media only screen and (max-device-width: 1136px) 
```

The problem is newer phones (ie iPhone 5) have a resolution greater than not so old tablets (ie, iPad 2). Is there any better way to handle this? I don't want to include the resolution of every known phone as a check. Is a user agent check better?

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-26T03:22:57.493

对此没有正确答案，但您可以使用一些标准查询。 [http://twitter.github.com/bootstrap/scaffolding.html#responsive](http://twitter.github.com/bootstrap/scaffolding.html#responsive)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-26T03:28:27.493

用户代理也可以做到这一点，你可以使用 PHP 做到这一点

检查一下：[检查是否从 iOS 设备访问 PHP 页面](https://stackoverflow.com/questions/6322112/check-if-php-page-is-accessed-from-an-ios-device)

# ruby - 用于移动的 Ruby 框架

> ID：14035585
> 
> 赞同：0
> 
> 时间：2012-12-26T03:07:25.257
> 
> 标签：ruby, native

我想使用 ruby​​ 构建本机移动应用程序。我试过 Rhodes，发现它有商业许可证，[不是免费](http://www.rhomobile.com/rhodes/simplified-licensing/)的。

是否有另一个用于原生移动应用程序的免费 Ruby 框架？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-26T03:20:26.057

Matz 公开了名为[mruby](https://github.com/mruby/mruby)的官方移动 ruby ​​。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-26T07:00:29.880

还有适用于 iOS 的[RubyMotion](http://www.rubymotion.com/)，它不是免费的，而且肯定很贵……

但它是原生的。

# android - Android：由于添加另一个光标而崩溃

> ID：14035587
> 
> 赞同：2
> 
> 时间：2012-12-26T03:08:07.657
> 
> 标签：android, listview, android-cursor

这是我的 ContactManager.java

```
package com.example.android.contactmanager;

import android.app.Activity;
import android.content.Intent;
import android.database.Cursor;
import android.net.Uri;
import android.os.Bundle;
import android.provider.ContactsContract;
import android.util.Log;
import android.view.View;
import android.widget.AdapterView;
import android.widget.AdapterView.OnItemClickListener;
import android.widget.Button;
import android.widget.CheckBox;
import android.widget.CompoundButton;
import android.widget.CompoundButton.OnCheckedChangeListener;
import android.widget.ListView;
import android.widget.SimpleCursorAdapter;

public final class ContactManager extends Activity implements OnItemClickListener
{

    public static final String TAG = "ContactManager";

    private Button mAddAccountButton;
    private ListView mContactList;
    private boolean mShowInvisible;
    //public BooleanObservable ShowInvisible = new BooleanObservable(false);
    private CheckBox mShowInvisibleControl;

    /**
     * Called when the activity is first created. Responsible for initializing the UI.
     */

    @Override
    public void onCreate(Bundle savedInstanceState)
    {

        Log.v(TAG, "Activity State: onCreate()");
        super.onCreate(savedInstanceState);
        setContentView(R.layout.contact_manager);

        // Obtain handles to UI objects
        mAddAccountButton = (Button) findViewById(R.id.addContactButton);
        mContactList = (ListView) findViewById(R.id.contactList);
        mShowInvisibleControl = (CheckBox) findViewById(R.id.showInvisible);

        // Initialise class properties
        mShowInvisible = false;
        mShowInvisibleControl.setChecked(mShowInvisible);

        // Register handler for UI elements
        mAddAccountButton.setOnClickListener(new View.OnClickListener() {
            public void onClick(View v) {
                Log.d(TAG, "mAddAccountButton clicked");
                launchContactAdder();
            }
        });
        mShowInvisibleControl.setOnCheckedChangeListener(new OnCheckedChangeListener()
        {
            public void onCheckedChanged(CompoundButton buttonView, boolean isChecked) 
            {
                Log.d(TAG, "mShowInvisibleControl changed: " + isChecked);
                mShowInvisible = isChecked;
                populateContactList();
            }
        });

        mContactList = (ListView) findViewById(R.id.contactList);
        mContactList.setOnItemClickListener(this);

        // Populate the contact list
        populateContactList();
    }

    /**
     * Populate the contact list based on account currently selected in the account spinner.
     */
    private void populateContactList() {
        // Build adapter with contact entries
        Cursor cursor = getContacts();

        String[] fields = new String[] {
                ContactsContract.Data.DISPLAY_NAME,

        };

        SimpleCursorAdapter adapter = new SimpleCursorAdapter(this, R.layout.contact_entry, cursor,
                fields, new int[] {R.id.contactEntryText});
        mContactList.setAdapter(adapter);
    }

    /**
     * Obtains the contact list for the currently selected account.
     *
     * @return A cursor for for accessing the contact list.
     */
    private Cursor getContacts()
    {
        // Run query
        Uri uri = ContactsContract.Contacts.CONTENT_URI;
        //Log.i("Uri ContactsContract.Contacts.CONTENT_URI" + ContactsContract.Contacts.CONTENT_URI, null, null);

        String[] projection = new String[]{
                ContactsContract.Contacts._ID,
                ContactsContract.Contacts.DISPLAY_NAME,
               //ContactsContract.CommonDataKinds.Email.DATA1
                };

        String selection = ContactsContract.Contacts.IN_VISIBLE_GROUP + " = '" + (mShowInvisible ? "0" : "1") + "'";
        //String selection = ContactsContract.Contacts.IN_VISIBLE_GROUP + " = '" + (mShowInvisible.get() ? "0" : "1") + "'";
        String[] selectionArgs = null;
        String sortOrder = ContactsContract.Contacts.DISPLAY_NAME + " COLLATE LOCALIZED ASC";

        return this.managedQuery(uri, projection, selection, selectionArgs, sortOrder);
    }

    /**
     * Launches the ContactAdder activity to add a new contact to the selected account.
     */
    protected void launchContactAdder()
    {
        Intent i = new Intent(this, ContactAdder.class);
        startActivity(i);
    }

    public void onItemClick(AdapterView<?> l, View v, int position, long id) {
        Log.i("TAG", "You clicked item " + id + " at position " + position);

        Cursor cursor = getContacts();
        Cursor emailCur = getContactsEmail();
        emailCur.isNull(emailCur.getColumnIndex(ContactsContract.CommonDataKinds.Email.DATA));

        cursor.moveToPosition(position);

        String name = cursor.getString(cursor.getColumnIndex(ContactsContract.Contacts.DISPLAY_NAME));
//        String email = cursor.getString(cursor.getColumnIndex(ContactsContract.CommonDataKinds.Email.DATA));
        //String name = cursor.getString(cursor.getColumnIndex(ContactsContract.CommonDataKinds.Email.DATA));

        //Log.i("Address", "Testing" + cursor.getString(cursor.getColumnIndex(ContactsContract.CommonDataKinds.Email.DATA)));

        // Launching new Activity on selecting single List Item
        Intent i = new Intent(getApplicationContext(), SingleListContact.class);
//        SingleListContact.PutDetails(ContactsContract.Contacts._ID, name, address, position, null, null);
        SingleListContact.PutDetails(ContactsContract.Contacts._ID, name, null);

        Log.i("Show Contact Clicked: ",  name + "Email: " + null);

        startActivity(i);

    }

    private Cursor getContactsEmail()
    {
        // Run query
        Uri uri = ContactsContract.Contacts.CONTENT_URI;
        //Log.i("Uri ContactsContract.Contacts.CONTENT_URI" + ContactsContract.Contacts.CONTENT_URI, null, null);

        String[] projection = new String[]
                {
                ContactsContract.Contacts._ID,
                ContactsContract.CommonDataKinds.Email.DATA,
//                ContactsContract.CommonDataKinds.StructuredPostal.DATA1
                //ContactsContract.CommonDataKinds.Phone.DATA
                };
        String selection = ContactsContract.Contacts.IN_VISIBLE_GROUP + " = '" + (mShowInvisible ? "0" : "1") + "'";
        //String selection = ContactsContract.Contacts.IN_VISIBLE_GROUP + " = '" + (mShowInvisible.get() ? "0" : "1") + "'";
        String[] selectionArgs = null;
        String sortOrder = ContactsContract.CommonDataKinds.Email.DATA + " COLLATE LOCALIZED ASC";
//
        return this.managedQuery(uri, projection, null, selectionArgs, null);
    }

} 
```

在添加 emailCur 之前，一切正常，但在添加代码以获取联系人详细信息后，一切都崩溃了！我可以在这里解决吗？Logcat如下：

```
 12-27 22:20:11.129: E/AndroidRuntime(9792): java.lang.IllegalArgumentException: Invalid column data1
12-27 22:20:11.129: E/AndroidRuntime(9792):     at android.database.DatabaseUtils.readExceptionFromParcel(DatabaseUtils.java:144)
12-27 22:20:11.129: E/AndroidRuntime(9792):     at android.database.DatabaseUtils.readExceptionFromParcel(DatabaseUtils.java:114)
12-27 22:20:11.129: E/AndroidRuntime(9792):     at android.content.ContentProviderProxy.bulkQueryInternal(ContentProviderNative.java:330)
12-27 22:20:11.129: E/AndroidRuntime(9792):     at android.content.ContentProviderProxy.query(ContentProviderNative.java:366)
12-27 22:20:11.129: E/AndroidRuntime(9792):     at android.content.ContentResolver.query(ContentResolver.java:262)
12-27 22:20:11.129: E/AndroidRuntime(9792):     at android.app.Activity.managedQuery(Activity.java:1550)
12-27 22:20:11.129: E/AndroidRuntime(9792):     at com.example.android.contactmanager.ContactManager.getContactsEmail(ContactManager.java:193)
12-27 22:20:11.129: E/AndroidRuntime(9792):     at com.example.android.contactmanager.ContactManager.onItemClick(ContactManager.java:153)
12-27 22:20:11.129: E/AndroidRuntime(9792):     at android.widget.AdapterView.performItemClick(AdapterView.java:284)
12-27 22:20:11.129: E/AndroidRuntime(9792):     at android.widget.ListView.performItemClick(ListView.java:3749)
12-27 22:20:11.129: E/AndroidRuntime(9792):     at android.widget.AbsListView$PerformClick.run(AbsListView.java:1986)
12-27 22:20:11.129: E/AndroidRuntime(9792):     at android.os.Handler.handleCallback(Handler.java:587)
12-27 22:20:11.129: E/AndroidRuntime(9792):     at android.os.Handler.dispatchMessage(Handler.java:92)
12-27 22:20:11.129: E/AndroidRuntime(9792):     at android.os.Looper.loop(Looper.java:130)
12-27 22:20:11.129: E/AndroidRuntime(9792):     at android.app.ActivityThread.main(ActivityThread.java:3687)
12-27 22:20:11.129: E/AndroidRuntime(9792):     at java.lang.reflect.Method.invokeNative(Native Method)
12-27 22:20:11.129: E/AndroidRuntime(9792):     at java.lang.reflect.Method.invoke(Method.java:507)
12-27 22:20:11.129: E/AndroidRuntime(9792):     at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:867)
12-27 22:20:11.129: E/AndroidRuntime(9792):     at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:625)
12-27 22:20:11.129: E/AndroidRuntime(9792):     at dalvik.system.NativeStart.main(Native Method) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-26T10:26:12.303

在从 emailCur 访问值之前添加 null 检查。

# android - 如何在安卓中使用foxpro

> ID：14035589
> 
> 赞同：0
> 
> 时间：2012-12-26T03:08:24.743
> 
> 标签：android, console, foxpro

我在 fox pro 上有一个正在运行的应用程序，它是使用**`DOS`**. 它在计算机系统上工作得很好。但由于用户的要求，现在他们希望它在 android 设备上运行。

**所以**

**1.**你能告诉我市场上是否已经有任何插件或桥接器，或者我应该开发一个吗？我基本上是在寻找可以在Android和fox pro之间进行通信的桥梁。我不知道这是否可能。

**2.**在安卓设备中打开控制台的任何解决方案，我可以像在计算机系统中一样在安卓设备中执行 DOS 命令。

*具体我不想重新开发，但如果没有办法实现那么让我们看看。*

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-28T16:48:45.007

显然，您可以在 Android 下运行 DOSbox：

[http://androiddosbox.appspot.com/](http://androiddosbox.appspot.com/)

我从来没有试过这个，但也许它会提供你正在寻找的东西。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-07-13T19:01:26.003

在 psgsdk 和 Appery.io 的组合以及帮助将屏幕从 SCX 文件转换为 Appery 的软件之间，这现在变得容易多了。我已经这样做了好几次，并且在 Google play 和 IOS 应用商店中都有 FoxPro 应用程序。后端和所有代码是 Visual FoxPro，前端是 Appery。推特上的@abigdreamer 抓住了我——让我知道我是否可以提供帮助——知道这篇文章已有多年历史，但其他人可能需要同样的内容。

# javascript - 解析通过 Ajax 传递的 JSON 对象

> ID：14035594
> 
> 赞同：4
> 
> 时间：2012-12-26T03:08:53.793
> 
> 标签：javascript, jquery, ajax, json, pdo

我正在尝试解析从数据库返回并编码为 JSON 对象的信息。

这是检索信息的代码：

```
 private function retrieve_standards_one(){
    $dbh = $this->connect();
    $stmt = $dbh->prepare("SELECT code, standard_one_id 
                           FROM standard_one 
                           WHERE grade_id = :grade_id 
                           ORDER BY standard_one_id");
    $stnd = array();
    for($x = 0; $x < (count($this->grades)); $x++){                    
    $stmt->bindParam(':grade_id', $this->grades[$x], PDO::PARAM_STR);
    $stmt->execute();
    $stnd[] = $stmt->fetchAll(PDO::FETCH_ASSOC);
    }
    $json = json_encode($stnd);
    return $json;
} 
```

这就是我试图解析信息的方式：

```
 $.ajax({
        type: "POST",
        url: "lib/search/search.standards_one.php",
        async: "false",
        data: {subjects: subjects, grades: grades},
        success: function(response){
                $("#standards_results").html("");
                var obj = $.parseJSON(response);
                $.each(obj, function(){
                    alert(this['code'] + ", " + this['standard_one_id'])
                });
            }
        }); 
```

我尝试了许多不同的方法来做到这一点，但我只得到 [object][object] 作为响应。

这是回应：

[http://i.imgur.com/E5Hux.png](http://i.imgur.com/E5Hux.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-26T03:10:34.467

利用

```
console.log(this['code'] , this['standard_one_id']) 
```

代替

```
alert(this['code'] + ", " + this['standard_one_id']) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-26T03:42:42.907

将 dataType 属性添加到您的 AJAX 调用。

$.ajax ({

```
 type: "POST",
    dataType: "JSON",
    url: "lib/search/search.standards_one.php",
    async: "false",
    data: {subjects: subjects, grades: grades},
    success: function(response){
            $("#standards_results").html("");
            var obj = $.parseJSON(response);
            $.each(obj, function(){
                alert(this['code'] + ", " + this['standard_one_id'])
            });
        }
    }); 
```

# java - 为什么每当我在 Eclipse 中运行我的 Android 应用程序时，我的 logcat 上都会出现这些错误？

> ID：14035595
> 
> 赞同：-5
> 
> 时间：2012-12-26T03:09:05.530
> 
> 标签：java, android, runtime-error

我正在尝试测试我的 android 应用程序是否有效，它由 2 个活动屏幕组成。我的代码中没有错误，但我的应用程序无法运行。它总是在模拟器上给我这个错误“不幸的是'应用程序名称'已停止。”

这是我的活动代码

```
 public class MainActivity extends Activity
{

        @Override
        public void onCreate(Bundle savedInstanceState)
        {
            super.onCreate(savedInstanceState);
            setContentView(R.layout.activity_main);
            View title = getWindow().findViewById(android.R.id.title);
            View titleBar = (View) title.getParent();
            titleBar.setBackgroundColor(Color.RED);
            Button next=(Button)findViewById(R.id.DGButton);
            next.setOnClickListener(new View.OnClickListener() {
                public void onClick(View view) {
                    Intent myIntent=new Intent(view.getContext(), 

    Activity2.class);
                    startActivityForResult(myIntent, 0);
                }});}

        public void calculateClickHandler(View view)
        {
            if (view.getId() == R.id.CalculateButton)
            {
                EditText ageText = (EditText)findViewById

    (R.id.AgeField);
                EditText weightText = (EditText)findViewById

    (R.id.WeightField);
                EditText ftText = (EditText)findViewById

    (R.id.HeightField);
                EditText inText = (EditText)findViewById

    (R.id.HeightField2);
                RadioGroup weightRG = (RadioGroup) findViewById

    (R.id.WeightRG);
                RadioGroup sexRG = (RadioGroup) findViewById

    (R.id.SexRG);

                TextView resultText = (TextView)findViewById

    (R.id.ResultLabel);
                TextView normalBMIText = (TextView)findViewById

    (R.id.NormalBMI);
                TextView idealKgText = (TextView)findViewById

    (R.id.IdealKgLabel);
                TextView idealLbText = (TextView)findViewById

    (R.id.IdealLbLabel);
                int age = Integer.parseInt(ageText.getText

    ().toString());
                double weight = Double.parseDouble

    (weightText.getText().toString());
                double ftheight = Double.parseDouble(ftText.getText

    ().toString());
                double inheight = Double.parseDouble(inText.getText

    ().toString());
                int checkedRadioButton1 = 

    weightRG.getCheckedRadioButtonId();
                int checkedRadioButton2 = 

    sexRG.getCheckedRadioButtonId();

                double bmiValue = calculateBMI(weight, ftheight, 

    inheight, checkedRadioButton1);
                String bmiInterpretation1 = interpretBMI1(bmiValue);
                String bmiInterpretation2 = interpretBMI2(age);
                String bmiInterpretation3 = interpretBMI3(ftheight, 

    inheight, checkedRadioButton2);
                String bmiInterpretation4 = interpretBMI4(ftheight, 

    inheight, checkedRadioButton2);

                resultText.setText(bmiValue + " - " + 

    bmiInterpretation1);
                normalBMIText.setText(""+bmiInterpretation2);
                idealKgText.setText(""+bmiInterpretation3);
                idealLbText.setText(""+bmiInterpretation4);

                Intent intent1 = new Intent(MainActivity.this, 

    Activity2.class);
                Bundle b = new Bundle();
                b.putDouble("key", bmiValue);
                intent1.putExtras(b);
                startActivity(intent1);
    }} 
```

**这是错误日志：**

```
12-26 02:50:45.606: E/AndroidRuntime(1776): FATAL EXCEPTION: main
12-26 02:50:45.606: E/AndroidRuntime(1776): java.lang.RuntimeException: Unable to start activity ComponentInfo{com.example.bmicaldg/com.example.bmicaldg.MainActivity}: java.lang.NullPointerException
12-26 02:50:45.606: E/AndroidRuntime(1776):     at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2180)
12-26 02:50:45.606: E/AndroidRuntime(1776):     at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:2230)
12-26 02:50:45.606: E/AndroidRuntime(1776):     at android.app.ActivityThread.access$600(ActivityThread.java:141)
12-26 02:50:45.606: E/AndroidRuntime(1776):     at android.app.ActivityThread$H.handleMessage(ActivityThread.java:1234)
12-26 02:50:45.606: E/AndroidRuntime(1776):     at android.os.Handler.dispatchMessage(Handler.java:99)
12-26 02:50:45.606: E/AndroidRuntime(1776):     at android.os.Looper.loop(Looper.java:137)
12-26 02:50:45.606: E/AndroidRuntime(1776):     at android.app.ActivityThread.main(ActivityThread.java:5039)
12-26 02:50:45.606: E/AndroidRuntime(1776):     at java.lang.reflect.Method.invokeNative(Native Method)
12-26 02:50:45.606: E/AndroidRuntime(1776):     at java.lang.reflect.Method.invoke(Method.java:511)
12-26 02:50:45.606: E/AndroidRuntime(1776):     at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:793)
12-26 02:50:45.606: E/AndroidRuntime(1776):     at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:560)
12-26 02:50:45.606: E/AndroidRuntime(1776):     at dalvik.system.NativeStart.main(Native Method)
12-26 02:50:45.606: E/AndroidRuntime(1776): Caused by: java.lang.NullPointerException
12-26 02:50:45.606: E/AndroidRuntime(1776):     at com.example.bmicaldg.MainActivity.onCreate(MainActivity.java:25)
12-26 02:50:45.606: E/AndroidRuntime(1776):     at android.app.Activity.performCreate(Activity.java:5104)
12-26 02:50:45.606: E/AndroidRuntime(1776):     at android.app.Instrumentation.callActivityOnCreate(Instrumentation.java:1080)
12-26 02:50:45.606: E/AndroidRuntime(1776):     at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2144)
12-26 02:50:45.606: E/AndroidRuntime(1776):     ... 11 more 
```

**这是调试日志：**

```
 12-26 03:04:06.238: I/Process(1854): Sending signal. PID: 1854 SIG: 9
    12-26 03:04:12.779: W/Trace(1876): Unexpected value from nativeGetEnabledTags: 0
    12-26 03:04:12.837: W/Trace(1876): Unexpected value from nativeGetEnabledTags: 0
    12-26 03:04:14.866: D/dalvikvm(1876): GC_CONCURRENT freed 76K, 7% free 2723K/2916K, paused 32ms+32ms, total 270ms
    12-26 03:04:15.427: D/AndroidRuntime(1876): Shutting down VM
    12-26 03:04:15.456: W/dalvikvm(1876): threadid=1: thread exiting with uncaught exception (group=0x40a70930)
    12-26 03:04:15.546: E/AndroidRuntime(1876): FATAL EXCEPTION: main
    12-26 03:04:15.546: E/AndroidRuntime(1876): java.lang.RuntimeException: Unable to start activity ComponentInfo{com.example.bmicaldg/com.example.bmicaldg.MainActivity}: java.lang.NullPointerException
    12-26 03:04:15.546: E/AndroidRuntime(1876):     at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2180)
    12-26 03:04:15.546: E/AndroidRuntime(1876):     at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:2230)
    12-26 03:04:15.546: E/AndroidRuntime(1876):     at android.app.ActivityThread.access$600(ActivityThread.java:141)
    12-26 03:04:15.546: E/AndroidRuntime(1876):     at android.app.ActivityThread$H.handleMessage(ActivityThread.java:1234)
    12-26 03:04:15.546: E/AndroidRuntime(1876):     at android.os.Handler.dispatchMessage(Handler.java:99)
    12-26 03:04:15.546: E/AndroidRuntime(1876):     at android.os.Looper.loop(Looper.java:137)
    12-26 03:04:15.546: E/AndroidRuntime(1876):     at android.app.ActivityThread.main(ActivityThread.java:5039)
    12-26 03:04:15.546: E/AndroidRuntime(1876):     at java.lang.reflect.Method.invokeNative(Native Method)
    12-26 03:04:15.546: E/AndroidRuntime(1876):     at java.lang.reflect.Method.invoke(Method.java:511)
    12-26 03:04:15.546: E/AndroidRuntime(1876):     at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:793)
    12-26 03:04:15.546: E/AndroidRuntime(1876):     at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:560)
    12-26 03:04:15.546: E/AndroidRuntime(1876):     at dalvik.system.NativeStart.main(Native Method)
    12-26 03:04:15.546: E/AndroidRuntime(1876): Caused by: java.lang.NullPointerException
    12-26 03:04:15.546: E/AndroidRuntime(1876):     at com.example.bmicaldg.MainActivity.onCreate(MainActivity.java:25)
    12-26 03:04:15.546: E/AndroidRuntime(1876):     at android.app.Activity.performCreate(Activity.java:5104)
    12-26 03:04:15.546: E/AndroidRuntime(1876):     at android.app.Instrumentation.callActivityOnCreate(Instrumentation.java:1080)
    12-26 03:04:15.546: E/AndroidRuntime(1876):     at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2144)
    12-26 03:04:15.546: E/AndroidRuntime(1876):     ... 11 more
    12-26 03:04:22.547: I/Process(1876): Sending signal. PID: 1876 SIG: 9 
```

任何帮助表示赞赏

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-26T03:11:48.273

```
 02:50:45.606: E/AndroidRuntime(1776): 
  Caused by: java.lang.NullPointerException 12-26 02:50:45.606: E/AndroidRuntime(1776): at
 com.example.bmicaldg.MainActivity.onCreate(MainActivity.java:25) 12-26 
```

您的问题中没有代码很难说出如何修复，但基于堆栈跟踪， MainActivity.java throwing 中的第 25 行`NullPointerException`。第 25 行的代码是一些如何导致 null 的代码，您正在尝试对`null`导致`NullPointerException`.

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-26T03:11:38.300

这是由**NullPointerException**引起的。您可能正在访问尚未初始化的空对象。你用你的代码编辑你的问题，这样就有机会编辑我的答案。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-12-26T03:13:55.880

```
Caused by: java.lang.NullPointerException 12-26 02:50:45.606: E/AndroidRuntime(1776): at com.example.bmicaldg.MainActivity.onCreate(MainActivity.java:25) 
```

这是你的错误所在，你`MainActivity`班级的第 25 行。无论您引用的是`null`.

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-12-26T03:41:56.953

`MainActivity`将您的onCreate 代码更改为：

```
public class MainActivity extends Activity

{

    @Override
    public void onCreate(Bundle savedInstanceState)
    {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_main);
        View title = getWindow().findViewById(android.R.id.title);

        if (title != null) { 
             ViewParent titleBar = title.getParent(); 
           if (titleBar != null && (titleBar instanceof View)) { 
                View parentView = (View)titleBar; 
                parentView.setBackgroundColor(Color.RED); 
              } 
         } 

        // Your Code here... 
```

# php - DooPHP：如何从控制器动作中输出图像？

> ID：14035598
> 
> 赞同：1
> 
> 时间：2012-12-26T03:09:51.603
> 
> 标签：php, doophp

在其中一项操作中，我需要将图像返回给用户。有没有办法用 DooPHP 实现这一点？

示例操作代码：

```
public function view() {
   $path = $this->params['path']; // contains path to the image

   // $this->render($path); // does not work
} 
```

谢谢，节日快乐！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-26T17:26:50.567

我在 DooPHP 框架中找不到任何东西，只是按照这个答案中描述的 php 方式结束了它：[https ://stackoverflow.com/a/900228/39843](https://stackoverflow.com/a/900228/39843)

# java - do-while 中的 return 语句

> ID：14035604
> 
> 赞同：0
> 
> 时间：2012-12-26T03:11:14.160
> 
> 标签：java, return, do-while

我有一个代码

```
 boolean playerTakesAHit() throws IOException {
  char ch = ' '; boolean hit=false;
  do{
   System.out.print("Hit or Stay: "); 
   System.out.flush();
   String playersDecision = keyboardInput.readLine(); 
   try {ch = playersDecision.charAt(0);
   } catch (StringIndexOutOfBoundsException exception) {
   if(ch == 'H' || ch == 'h') {
           return true;
       }
   if(ch == 'S' || ch == 's') {
           return false;
       }}
  } while(true); 
```

我想要的是这个方法会在用户点击 H/h（返回 true）时重复，并在用户点击 S/s 时立即停止。但是当我使用以下方法调用此方法时：

```
 ...
 while(playerTakesAHit()) {
  System.out.println("Player Hit"); 
 }
 ... 
```

我得到了这样的东西：

> 击中或留下：h
> 
> 击中或留下：h
> 
> 击中或留下：s
> 
> 击中或留下：S
> 
> 击中或留下：

无论用户输入什么，它都会重复询问 Hit 或 Stay。有人知道我的错误在哪里吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-26T03:17:21.560

尝试这个：

```
 char ch = ' '; 
  boolean hit=false;
  do{
      System.out.print("Hit or Stay: "); 
      System.out.flush();
      String playersDecision = keyboardInput.readLine(); 
      try {
          ch = playersDecision.charAt(0);
      } catch (StringIndexOutOfBoundsException exception) {
          ch = ' '; //blank out
      }
      if(ch == 'H' || ch == 'h') {
         hit = true;
      }
    } while(!(ch == 'S' || ch == 's'));
    return hit; 
```

# windows-phone-8 - 如何在 WP8 中处理网络连接

> ID：14035606
> 
> 赞同：-2
> 
> 时间：2012-12-26T03:11:42.543
> 
> 标签：windows-phone-8, network-connection

我知道有一种方法可以调用检查网络，但是，如果网络突然丢失，我是否可以在不手动检查的情况下获得一些通知事件？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-26T08:09:53.810

您可以订阅网络更改事件，这将使您知道这一点。有关详细信息，请参阅[MSDN 上的此主题](http://msdn.microsoft.com/en-us/library/windowsphone/develop/hh487166%28v=vs.105%29.aspx)。

# django - 如何在 Django 中测试未选中的复选框？

> ID：14035607
> 
> 赞同：0
> 
> 时间：2012-12-26T03:11:43.780
> 
> 标签：django, unit-testing, checkbox

因此，我向用户显示了一个复选框，您可以在我的`forms.py`文件中看到：

```
class AddFooToBarForm(forms.Form):
    to_original = forms.BooleanField(initial=True,
                                     error_messages={'required':
                                                         "Oh no! How do I fix?"})
    ... 
```

根据用户是选中还是取消选中该复选框，我会做一些不同的事情，正如您在我的`views.py`文件中看到的那样：

```
def add_foo_to_bar(request, id):
    ...
    try:
        bar = Bar.objects.get(pk=id)

        if request.method == 'POST': # handle submitted data
            form = AddFooToBarForm(bar, request.POST)
            if form.is_valid(): # good, now create Foo and add to bar
                ...
                to_original = form.cleaned_data['to_original']
                print 'to original is {0}'.format(to_original) # for debugging
                if to_original:
                    # do A
                else:
                    # do B

                ... 
```

因此，我想测试我的网站是否确实执行了正确的操作，具体取决于用户是否在我的`tests.py`文件中选中复选框：

```
class FooTest(TestCase):
    ...

    def test_submit_add_to_Bar(self):
        form_data = {
            ...
            'to_original': True,
        }
        response = self.client.post(reverse('add_foo_to_bar', args=(self.bar.id,)),
                                    form_data, follow=True)
        self.assertContains(...) # works

        ...

        form_data['to_original'] = None
        response = self.client.post(reverse('add_foo_to_bar', args=(self.bar.id,)),
                                    form_data, follow=True)
        print response # for debugging purposes
        self.assertContains(...) # doesn't work 
```

我试过了

*   `del form_data['to_original']`- 这给了我“哦，不！我该如何解决？” 错误信息
*   `form_data['to_original'] = None`-- 在我的视图函数中，我得到`True`了，所以完成了 A 而不是 B
*   `form_data['to_original'] = False`- 这给了我“哦，不！我该如何解决？” 再次出现错误信息

那么我应该如何测试用户*不*检查 Django 中的复选框呢？（我使用的是最新版本，1.4.3）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-26T05:33:39.330

未选中复选框时，它不会出现在提交的表单中。此外，当提交的值为`'on'`.

如果您想在定义表单字段时设置`BooleanField`可选的 have 。`required=False`

[文档 BooleanField](https://docs.djangoproject.com/en/dev/ref/forms/fields/#booleanfield)。

# java - 空指针异常数组

> ID：14035615
> 
> 赞同：0
> 
> 时间：2012-12-26T03:13:07.370
> 
> 标签：java, arrays, nullpointerexception

所以，我一直在思考为什么我的代码整晚都没有工作，经过多年无药可救的搜索，我决定在这里发帖。我收到了一条 NPE：

```
this.numbers[a][b] = new Integer(n[a][b]); 
```

这是我的完整代码：

```
private int[][] numbers, temp, temp2;
private int a, b;

public Matrix(int[][] n)
{
System.out.println(n[0].length);
int numbers[][] = new int[n[0].length][n[1].length];
int temp[][] = new int[n[0].length-1][n[1].length-1];
int temp2[][] = new int[n[0].length][n[1].length];
    for(a=0;a<n[0].length;a++)
        for(b=0;b<n[1].length;b++)
        {
            this.numbers[a][b] = new Integer(n[a][b]);
            this.temp2[a][b] = new Integer(n[a][b]);
        }
    this.xLength = n[0].length;
    this.yLength = n[1].length;
} 
```

我不知道为什么会出错；虽然我确信这是一个简单的错误。帮助表示赞赏。（n[][] 是一个完美的数组）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-26T03:15:49.093

numbers is an array that is defined inside your method, not inside the class you have, so this.numbers refers to the array that you have defined inside your class (which admittedly has the value null), not the local numbers array you have defined in your method.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-26T03:24:04.413

我马上就注意到了：在你的构造函数中，你屏蔽了你的三个实例变量`numbers`,`temp`和`temp2`. 你不需要这样做。

从每个变量中删除类型声明和方括号，您的 NPE 不应继续。它主要发生是因为`numbers`is `null`，并且您不能取消引用/索引为 null。

中也没什么意义`new Integer(n[a][b]);`。如果`n[i]`and的类型`numbers[j][k]`是`int[]`（即原语`int`），那么您不需要进行任何自动装箱；只需直接分配值。

您的循环变量 ( `a`, `b`) 必须`int`在它们前面，然后它们才能按照您期望的方式工作 - 否则它们不会被声明。

最后，您正在循环错误的维度。对于在长度不同的二维数组上循环，您希望使用`n.length`外循环和`n[0].length`内循环。所以它看起来像这样：

```
 for (int a = 0; a < n.length; a++) {
    for (int b = 0; b < n[0].length; b++) {
        numbers[a][b] = new Integer(n[a][b]);
        temp2[a][b] = new Integer(n[a][b]);
    }
} 
```

# wordpress - 如何给小部件单独的 ID 或类？

> ID：14035616
> 
> 赞同：2
> 
> 时间：2012-12-26T03:13:12.797
> 
> 标签：wordpress, wordpress-theming

在我的 wordpress 安装中，我为我创建的新页面模板创建了一个新主题。但是，当我创建新的小部件时，每个小部件都会自动获取“textwidget”类。对于需要不同样式的小部件，我有两种不同的样式，所以我不太确定如何为每个单独的小部件赋予不同的类或以不同的方式标记它们？

有人知道怎么做吗？

这是我网站上带有 2 个小部件的页面：[http ://www.simonsayswebsites.com/how-we-get-you-more-customers/](http://www.simonsayswebsites.com/how-we-get-you-more-customers/)

您可以看到每个都在具有相同类名的小部件中。

这是我添加到我的页面 functions.php 以添加小部件的内容：

```
 if ( function_exists('register_sidebar') ){
    register_sidebar(array(
        'name' => 'sidebarpage',
        'before_widget' => '<div id="sidebarpage">',
        'after_widget' => '</div>',
        'before_title' => '',
        'after_title' => '',
));
} 
```

这是页面模板本身的片段，用于显示：

```
<?php /* Widgetized sidebar */
    if ( !function_exists('dynamic_sidebar') || !dynamic_sidebar('sidebarpage') ) : ?><?php endif; ?> 
```

我可以使用不同的小部件区域来制作它，但想了解如何拥有单独的小部件样式。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-26T04:00:15.920

你误会了`name`和`id`。

此外，在 中`before_widget`，您不应该声明固定 ID，在您的站点中，两个小部件都具有相同的 ID，这......不好。

如果您遵循 Codex 中的示例，您的小部件将收到一个唯一 ID 和相关类。

[http://codex.wordpress.org/Function_Reference/register_sidebar](http://codex.wordpress.org/Function_Reference/register_sidebar)

### 默认用法

```
<?php $args = array(
    'name'          => __( 'Sidebar name', 'theme_text_domain' ),
    'id'            => 'unique-sidebar-id',
    'description'   => '',
    'class'         => '',
    'before_widget' => '<li id="%1$s" class="widget %2$s">',
    'after_widget'  => '</li>',
    'before_title'  => '<h2 class="widgettitle">',
    'after_title'   => '</h2>' ); ?> 
```

# c++ - 尝试输出从文件读取的数据时，我的 C++ 程序崩溃

> ID：14035619
> 
> 赞同：1
> 
> 时间：2012-12-26T03:13:57.830
> 
> 标签：c++

我正在尝试制作一个程序来存储员工数据库并将它们存储在外部文件中。从 .dat 文件中读取向量并将其加载到程序中的函数会读取该文件，但每当我尝试显示或修改加载的向量时，程序就会崩溃。

```
//displays vector
void Database:: displayAll() const
{
    for(std::vector<Employee>::const_iterator iter = mEmployees.begin(); iter != mEmployees.end(); ++iter)
    {
        iter -> display();
    }

}

std::vector<Employee> mEmployees;

void Database::readData()
{
    ifstream empIn("employee.dat" , ios::binary);
    empIn.seekg(0,ifstream::end);
    long size2 = empIn.tellg();
    empIn.seekg(0,ifstream::beg);
    mEmployees.resize(size2);
    empIn.read((char*)&mEmployees, size2);
    empIn.close();
    cout << mEmployees.size() << endl; //this tests whether or not it reads.
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-26T03:16:16.413

你没有向我们展示你的声明`mEmployees`，但我认为它是`std::vector`某种形式的。问题是您试图将文件读入`vector`对象，而不是其内容。这将损坏`vector`以及它旁边的任何其他内存，从而导致进一步崩溃。

您可能想要的是：

```
empIn.read((char*)&mEmployees[0], size2); 
```

或在**C++11**中：

```
empIn.read((char*)mEmployees.data(), size2); 
```

真正将文件的*内容**读*入`vector`.

要了解为什么会发生这种情况，您应该知道a的*内容*`vector`不存储在其`vector`自身中*（它们怎么可能？大小是动态的）*。相反，一个常见的实现`vector`有指向存储区域开始和结束的指针，在空闲存储的某个地方，内容实际保存在那里。当您尝试将文件读入内存布局时，`vector`您将覆盖这些指针以及超出`vector`自身的内存，从而破坏向量等。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-26T03:34:47.343

强制转换`(char*)`告诉编译器放弃它通常会进行的类型检查。在这种情况下有必要执行强制转换，因为`ifstream`需要您通过`char*`. 问题是，这`reinterpret_cast`是一个相当生硬的工具，`vector<Employee>*`当您打算从`Employee*`.

请记住，像这样的强制转换是低级操作，其目的是告诉编译器“你知道自己在做什么，即使它看起来是错误的”。使用时应格外小心。

对于您正在做的事情，一个更好且更正的表格是：

```
empIn.read( reinterpret_cast<char*>(&mEmployees[0]), mEmployees.size() ); 
```

# java - 我可以用基本的 GSON 代替基本的 ObjectIn/OutputStreams 吗？

> ID：14035630
> 
> 赞同：1
> 
> 时间：2012-12-26T03:16:49.353
> 
> 标签：java, serialization, gson

如果我只是加入`.toJson`and`.fromJson`而不是使用`.writeObject`and `.readObject`，我会得到相同的结果吗？此外，您可以放入要序列化的类中的和方法
的 GSON 等价物是什么？`readObject``writeObject`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-26T16:51:00.640

Gson 不支持继承或循环引用，不足以替代 Java 序列化。

对于**继承**，使用[RuntimeTypeAdapterFactory](http://code.google.com/p/google-gson/source/browse/trunk/extras/src/main/java/com/google/gson/typeadapters/RuntimeTypeAdapterFactory.java)将类名编码为 JSON 值。

对于**循环引用**，您可以使用[GraphAdapterBuilder](http://code.google.com/p/google-gson/source/browse/trunk/extras/src/main/java/com/google/gson/graph/GraphAdapterBuilder.java)按引用而不是按值对值进行编码。

这些文件都不包含在 Gson 发行版中。如果您想使用它们，您需要将它们复制并粘贴到您的应用程序中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-26T07:04:29.457

Gson AFAIK 没有 readObject 和 writeObject （根据它的[API](http://google-gson.googlecode.com/svn/trunk/gson/docs/javadocs/index.html)）

至于问题的第二部分：GSON 的工作原理是这样的：您可以像[这样](https://sites.google.com/site/gson/gson-user-guide#TOC-Writing-a-Serializer)实现序列化器/反序列化器：

```
private class DateTimeSerializer implements JsonSerializer<DateTime> {
    public JsonElement serialize(DateTime src, Type typeOfSrc, JsonSerializationContext context) {
    return new JsonPrimitive(src.toString());
    }
} 
```

然后注册他们`gson.registerTypeAdapter(DateTime.class, DateTimeSerializer());`

# delphi - 在哪里可以找到用于散列流的 Murmur2 的 Delphi 实现？

> ID：14035632
> 
> 赞同：-1
> 
> 时间：2012-12-26T03:17:02.300
> 
> 标签：delphi, hash, murmurhash

我正在寻找使用 Murmur2 散列文件流的 Delphi 代码。应该支持 32 位和 64 位。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-26T03:38:16.847

关于散列的另一个问题中有[一个实现](https://stackoverflow.com/a/3690631/33732)。它当然支持 32 位代码。我无法评论它转移到 64 位的难易程度。

# ruby-on-rails - 如何保留历史数据而不是参考 mongodb 中的更新数据？

> ID：14035635
> 
> 赞同：0
> 
> 时间：2012-12-26T03:17:22.577
> 
> 标签：ruby-on-rails, mongodb, mongoid, nosql

在很多情况下，我需要在创建后保持数据不变。但我还需要参考更新的信息来创建新记录。例如，我有两个集合；

```
Order{
  has may products
}

Product{
  name: string
  price: float
} 
```

创建订单时，需要参考当前的产品信息，放入订单文档中。但是在我创建订单之后，我不希望在以后更改产品时更改它。我怎样才能在 mongodb 中实现这一点？我应该使用 embeds_many 关系吗？

顺便说一句，我在 rails 应用程序中使用 mongoid。

提前致谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-26T03:55:40.907

您可以将参考产品的“_id”和“价格”存储到您的订单文档中。所以一个典型的订单文件看起来像：

```
{_id: 1, productsOrdered: [{_id: 1, price: 100, number: 2},{_id:3, price:20, number: 10},.....,{_id: 9, price:11, number:1}], .....} 
```

# android - Android 密钥库密码字段

> ID：14035636
> 
> 赞同：2
> 
> 时间：2012-12-26T03:18:10.040
> 
> 标签：android, passwords, keystore

我已经完成了一个 android 应用程序的开发，并决定使用密钥库对其进行签名。我对此过程没有任何问题，但我确实对密钥库的密码有疑问。我正在从 Eclipse 创建密钥库，在`Keystore selection`窗口中，我选择了`create new keystore`. 在我按下下一步后，在`Key Creation`窗口下，我需要输入密钥库的详细信息；别名、有效性、密码等

我想问的是，windows中的密码字段`Key Creation`和`Keystore selection`windows有什么区别吗？我尝试为两者输入相同的密码，这对我来说效果很好。我可以选择输入不同的密码吗？它会影响该特定密钥库的任何内容吗？希望任何人都可以为我提供一个见解。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-12-26T03:20:03.630

密钥库拥有**许多**密钥。**而您的密钥是密钥库中包含**的单个项目。他们*可以*使用相同的密码，但如果您的密钥密码以某种方式泄露，这会危及您的密钥库。我建议让密钥库和密钥密码不同。

所以是的，密码字段是两个独立的东西，因为您正在创建两个独立的项目，并且遵循良好的密码实践，它们每个都应该有两个独立的密码。

# facebook - FQL 得到喜欢的艺术家

> ID：14035638
> 
> 赞同：1
> 
> 时间：2012-12-26T03:19:01.000
> 
> 标签：facebook, facebook-like, facebook-fql

是否有可能使用 FQL 获得用户喜欢的艺术家（音乐）？我检查了权限，但找不到任何与之相关的东西，而且我不是 Facebook 用户，所以我不确定它是否可能。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-26T04:14:36.097

该[`Like`](https://developers.facebook.com/docs/reference/fql/like)表不归还**利益**，但是：

> 一个 FQL 表，它返回喜欢给定对象（视频、笔记、链接、照片或相册）的用户的 ID。

这不是我们需要的。

## 第一种方式 - 快速描述

在[`User`](https://developers.facebook.com/docs/reference/fql/user)表格中，您会找到一个`music`字段，该字段发回包含所有喜欢的艺术家的一行。查询将很简单：

```
SELECT music FROM user WHERE uid = me() 
```

* * *

```
{
  "data": [
    {
      "music": "Macarize, MARCEL DETTMANN, Alan Fitzpatrick"
    }
  ]
} 
```

## 第二种方式 - 详细结果

通过[`Page_fan`](https://developers.facebook.com/docs/reference/fql/page_fan)表格我们一一获取用户的音乐兴趣。

```
SELECT name, type FROM page WHERE page_id IN (
    SELECT page_id FROM page_fan WHERE uid=me() AND profile_section="music") 
```

* * *

```
{
  "data": [
    {
      "name": "Macarize", 
      "type": "RECORD LABEL"
    }, 
    {
      "name": "MARCEL DETTMANN", 
      "type": "PRODUCER"
    }, 
    {
      "name": "Alan Fitzpatrick", 
      "type": "MUSICIAN/BAND"
    }
  ]
} 
```

# sql-server - while循环在sql中将数据插入表中

> ID：14035639
> 
> 赞同：0
> 
> 时间：2012-12-26T03:19:01.517
> 
> 标签：sql-server, tsql, while-loop

```
 declare @temp int,
@temp1 int,
@temp2 int,
@temp3 int,
@temp4 int,
@temp5 int,
@modid int,
@supid int,
@sid varchar(50)
begin tran
select * from StudentSupervisor;

select @temp = count(*) from Students s where s.IsLockedOut = '0' and s.IsGraduated = '0'; 
select @temp1 = count(*)  from staffs st where st.IsLockedOut ='0';

set @temp5 = round(@temp/@temp1,0);

WHILE (select count(*) from students s where s.IsLockedOut ='0' and s.StudentId not in (select ss.StudentId from StudentSupervisor ss where s.StudentId = ss.StudentId and ss.IsApproved = 1)) != 0

BEGIN

select top 1 @sid = s.studentid from students s, StudentSupervisor ss where s.IsLockedOut ='0' and s.StudentId not in (select s.StudentId where s.StudentId = ss.StudentId and ss.IsApproved = 1);

select top 1 @supid = st.Staffid, @modid = st.moderatorid from Staffs st where st.IsLockedOut =0 and Quota <=@temp5;

        insert into StudentSupervisor 
        (StudentId,SupervisorId,ModeratorId,IsApproved)
    values
        (@sid,@supid,@modid,1)
        update Staffs set quota +=1 where staffs.StaffID = @supid;

END

select * from StudentSupervisor;

ROLLBACK  tran 
```

大家好，我非常坚持这个逻辑，我确实在寻找解决方案，但在通宵工作后我什么也没得到，现在让我弄清楚我的情况，首先我想计算不在 studentsupervisor 表或 studentsupervisor 表中的学生但是被批准！= 1，然后我计算配额不超过总学生/总教职员工的人数，之后我想在他们仍然可用的时候将学生和教职员工一起抽到学生主管表中。请让我知道什么我的动态查询有问题，谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-26T03:44:36.133

我无法理解您的问题。我认为你的循环条件应该是：

```
WHILE (SELECT COUNT(*) from students WHERE StudentID NOT IN (SELECT StudentID FROM StudentSupervisor WHERE IsAppoved = 1)) <> 0 
```

根据您在循环中尝试执行的操作，可能会删除循环。如果您可以使用有关循环中发生的事情的更多详细信息和示例更新您的问题，我将尝试提供更完整的答案。

**更新**：

在这种情况下，我还将循环中的第一行更新为：

```
select top 1 @sid = studentid from students WHERE IsLockedOut = 0 and StudentId NOT IN (SELECT StudentID FROM StudentSupervisor WHERE IsAppoved = 1); 
```

**Update2**表变量选项：

```
declare @temp int,
    @temp1 int,
    @temp2 int,
    @temp5 int,
    @PairCount int,                         --The number of students paired with a staff member.
    @modid int,
    @supid int,
    @StaffQuotaNeed int,                    --The number of students the staff needs to be paired with to meet quota.
    @sid varchar(50)
DECLARE @StaffToPair table
    (
        StaffID int NOT NULL,
        ModeratorID int NOT NULL,
        QuotaNeed int NOT NULL          --The number of students the staff needs to be paired with to meet quota.
    );
DECLARE @StudentsToPair table (StudentID int NOT NULL);
DECLARE @StudentsPaired table (StudentID int NOT NULL);

begin tran
select * from StudentSupervisor;

select @temp = count(*) from Students where IsLockedOut = '0' and IsGraduated = '0'; 
select @temp1 = count(*)  from staffs where IsLockedOut ='0';
set @temp5 = round(@temp/@temp1 + .5, 0);                   --Round Up

INSERT INTO @StaffToPair (StaffID, ModeratorID, QuotaNeed)
                    SELECT StaffID, ModeratorID, @temp5 - Quota FROM Staffs WHERE IsLockedOut =0 AND Quota <@temp5;
INSERT INTO @StudentsToPair (StudentID)
                    SELECT StudentID from students WHERE IsLockedOut = 0 AND StudentId NOT IN (SELECT StudentID FROM StudentSupervisor WHERE IsAppoved = 1);

WHILE (SELECT COUNT(*) from @StudentsToPair) > 0 AND (SELECT COUNT(*) from @StaffToPair) > 0
BEGIN
    SELECT TOP 1 @supid = Staffid, @modid = ModeratorID, @StaffQuotaNeed = QuotaNeed FROM @StaffToPair;

    INSERT INTO StudentSupervisor   (StudentID, SupervisorId, ModeratorId, IsApproved)
        OUTPUT INSERTED.StudentID INTO @StudentsPaired(StudentID)
        SELECT TOP (@StaffQuotaNeed) StudentID,     @supid,     @modid,         1 FROM @StudentsToPair;

    DELETE FROM @StudentsToPair WHERE StudentID IN (SELECT StudentID FROM @StudentsPaired); --Delete paired students from table variable.
    DELETE FROM @StaffToPair WHERE StaffID = @supid;                                        --Delete paired staff from table variable.

    SELECT @PairCount = COUNT(*)  FROM @StudentsPaired;
    UPDATE Staffs set Quota += @PairCount where staffs.StaffID = @supid;
END

select * from StudentSupervisor;

ROLLBACK  tran 
```

如果上述方法不起作用，请更新您的问题以包含表架构，以便我可以在我的系统上对其进行测试。

# php - Twitter Bootstrap：获取引导复选框按钮的状态

> ID：14035640
> 
> 赞同：5
> 
> 时间：2012-12-26T03:19:13.893
> 
> 标签：php, button, twitter-bootstrap

如何获取已在引导程序中按下的按钮的“状态”？

即我正在使用此代码，它使按钮像复选框一样“切换”：

```
<div class="btn-group" data-toggle="buttons-checkbox">
  <button type="button" class="btn btn-primary">Left</button>
  <button type="button" class="btn btn-primary">Middle</button>
  <button type="button" class="btn btn-primary">Right</button>
</div> 
```

这是来自[这里的引导手册。](http://getbootstrap.com/2.3.2/javascript.html#buttons)

但是我然后单击提交按钮 - $_POST 中不包含任何数据。我如何知道选择了哪些按钮？

我已经尝试`'value="1" name="1"'`在按钮上添加等 - 但仍然没有。

**编辑：这是完整的解决方案**，我可以使用下面 Felix 的帮助创建它。

```
<form method="post" action="" id="mform" class="form-horizontal">
 <div class="btn-group" data-toggle="buttons-checkbox">
   <button type="button" name="left"   value="1" class="btn btn-primary">Left</button>
   <button type="button" name="middle" value="1" class="btn btn-primary">Middle</button>
   <button type="button" name="right"  value="1" class="btn btn-primary">Right</button>
 </div>
 <button type="submit" class="btn">Submit</button>
</form>

<script>
    $('#mform').submit(function() {
        $('#mform .btn.active').each(function() {
             var input = document.createElement("input");
             input.setAttribute("type", "hidden");
             input.setAttribute("name", this.name);
             input.setAttribute("value", this.value);
             document.getElementById("mform").appendChild(input);
         });
    });
 </script> 
```

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-12-26T03:23:36.873

被“选中”的按钮将`active`附加类。然后，您可以使用 jQuery 仅选择这些按钮。由于`button`s 是表单元素，它们可以具有`name`和`value`属性，最好利用它们。

例子：

```
var data = {};

$('#myButtonGroup .btn.active').each(function() {
    data[this.name] = this.value;
}); 
```

要将数据发送到服务器，您可以使用 Ajax 并手动设置数据/将其与其他表单数据（如果存在）合并。

如果您想使用“传统”表单提交，您还可以尝试在提交时将值镜像到隐藏的表单元素中（请参阅[按下提交按钮后更改表单值](https://stackoverflow.com/questions/4517366/change-form-values-after-submit-button-pressed)）。

# gwt - 我们如何在原生方法中创建 JavaScript 对象？

> ID：14035641
> 
> 赞同：2
> 
> 时间：2012-12-26T03:19:23.067
> 
> 标签：gwt, jsni

我正在使用 google maps api，我想创建一个他们的对象的实例：

```
public static final native void test(double lat, double lng) /*-{
    var obj = new google.maps.LatLng(lat, lng);
}-*/; 
```

但以上不起作用，打印以下错误：

```
com.google.gwt.core.client.JavaScriptException: (ReferenceError)
@com.google.gwt.core.client.impl.Impl::apply
    (Ljava/lang/Object;Ljava/lang/Object;Ljava/lang/Object;)
    ([JavaScript object(4), JavaScript object(3), JavaScript object(6)]): 
    google is not defined 
```

所以我可能不得不向 GWT 解释“google.maps.LatLng”对象是什么——我该怎么做？我认为有一个特定的语法，但似乎无法在文档中找到它，

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-26T03:49:58.193

如果您在主机页面的其他位置定义 google.maps，则必须在 GWT 代码中为其添加 $wnd 前缀：

```
public static final native void test(double lat, double lng) /*-{
    var obj = new $wnd.google.maps.LatLng(lat, lng);
}-*/; 
```

来自 GWT 文档：

> 从 JSNI 访问浏览器的窗口和文档对象时，您必须分别将它们引用为 $wnd 和 $doc。您编译的脚本在嵌套框架中运行，并且 $wnd 和 $doc 会自动初始化以正确引用主机页面的窗口和文档。

# javascript - 使用 xmlhttp 更新 javascript

> ID：14035642
> 
> 赞同：-1
> 
> 时间：2012-12-26T03:19:32.193
> 
> 标签：javascript, ajax, google-visualization, xmlhttprequest

我希望有人能告诉我我做错了什么。我想用 xmlhttp 更新谷歌图表，我的脚本在这里：

```
<!--
You are free to copy and use this sample in accordance with the terms of the
Apache license (http://www.apache.org/licenses/LICENSE-2.0.html)
-->

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8"/>
    <title>
      Google Visualization API Sample
    </title>
    <div id="myDiv">
    <script type="text/javascript">
      function drawVisualization() {
        // Create and populate the data table.
        var data = google.visualization.arrayToDataTable([
          ['Year', 'Austria', 'Belgium', 'Czech Republic', 'Finland', 'France', 'Germany'],
          ['2003',  1336060,   3817614,       974066,       1104797,   6651824,  15727003],
          ['2004',  1538156,   3968305,       928875,       1151983,   5940129,  17356071],
          ['2005',  1576579,   4063225,       1063414,      1156441,   5714009,  16716049],
          ['2006',  1600652,   4604684,       940478,       1167979,   6190532,  18542843],
          ['2007',  1968113,   4013653,       1037079,      1207029,   6420270,  19564053],
          ['2008',  1901067,   6792087,       1037327,      1284795,   6240921,  19830493]
        ]);

        // Create and draw the visualization.
        new google.visualization.ColumnChart(document.getElementById('visualization')).
            draw(data,
                 {title:"Yearly Coffee Consumption by Country",
                  width:600, height:400,
                  hAxis: {title: "Year"}}
            );
      }

    google.setOnLoadCallback(drawVisualization);
    ;
    </script>
    </div>

    <script>
function loadXMLDoc()
{
var xmlhttp;
if (window.XMLHttpRequest)
  {// code for IE7+, Firefox, Chrome, Opera, Safari
  xmlhttp=new XMLHttpRequest();
  }
else
  {// code for IE6, IE5
  xmlhttp=new ActiveXObject("Microsoft.XMLHTTP");
  }
xmlhttp.onreadystatechange=function()
  {
  if (xmlhttp.readyState==4 && xmlhttp.status==200)
    {
    document.getElementById("myDiv").innerHTML=xmlhttp.responseText;
    }
  }
xmlhttp.open("GET","UpdateGraph.php",true);
xmlhttp.send();
}
</script>

  </head>
  <body style="font-family: Arial;border: 0 none;">
    <div id="visualization" style="width: 600px; height: 400px;"></div>

<button type="button" onclick="loadXMLDoc()">Change Content</button>

  </body>
</html> 
```

下面是我想用来更新内容的 php 文件 (UpdateGraph.php)，我的意图是显示第二个图表。它目前的工作方式是它带来了空间来显示另一个图形以及我创建的一个按钮，以防它不会自动“重绘”。当我从 UpdateGraph.php 文件中删除脚本标签时，我希望新图形出现的区域中只显示文本。

```
<script type="text/javascript" src="http://www.google.com/jsapi"></script>
<script type="text/javascript">
  google.load('visualization', '1', {packages: ['corechart']});

</script>
<script type="text/javascript">
      function drawVisualization2() {
        // Create and populate the data table.
        var data = google.visualization.arrayToDataTable([
          ['Year', 'Austria', 'Belgium', 'Czech Republic', 'Finland', 'France', 'Germany'],
          ['2003',  1336060,   3817614,       974066,       1104797,   6651824,  15727003],
          ['2004',  1538156,   3968305,       928875,       1151983,   5940129,  17356071],
          ['2005',  1576579,   4063225,       1063414,      1156441,   5714009,  16716049],
          ['2006',  1600652,   4604684,       940478,       1167979,   6190532,  18542843],
          ['2007',  1968113,   4013653,       1037079,      1207029,   6420270,  19564053],
          ['2008',  1901067,   6792087,       1037327,      1284795,   6240921,  19830493]
        ]);

        // Create and draw the visualization.
        new google.visualization.ColumnChart(document.getElementById('visualization2')).
            draw(data,
                 {title:"Yearly Coffee Consumption by Country",
                  width:600, height:400,
                  hAxis: {title: "Year"}}
            );
      }
      google.setOnLoadCallback(drawVisualization2)
</script>
<button onclick="drawVisualization2()">Redraw 2nd Graph</button>
<div id="visualization2" style="width: 600px; height: 400px;"></div> 
```

我在引入文本时没有问题，但我很困惑为什么我不能引入新的 javascript 或更新 javascript。（顺便说一句，UpdateGraph.php 中的代码在被复制并粘贴到当前包含“div id="myDiv" 的行时工作得很好）

谢谢你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-26T05:40:24.530

在 innerHTML 分配中允许脚本标记将是一个安全威胁。假设您要下载的数据是用户在表单中提供的内容，并且该内容是由另一个用户加载的。用户 Bob 可以在表单中插入一个脚本标签，这将从服务器 X 加载恶意代码。用户 Charlie 加载具有指定内容的页面，并且该恶意代码运行。这是跨站点脚本的一种形式，您的浏览器在使用 innerHTML 赋值时可能会禁用它也就不足为奇了。但是，不能保证每个浏览器都会这样做。

这里有更多信息：[https ://developer.mozilla.org/en-US/docs/DOM/element.innerHTML#Security_consideration](https://developer.mozilla.org/en-US/docs/DOM/element.innerHTML#Security_consideration)

也就是说，有两种更简单的方法可以做你想做的*事情*。我推荐第一个作为最好的方法：

1) 将大部分脚本（而不是更新详细信息）移动到与页面一起加载但不一定运行的函数中。无需通过 xmlhttp 检索整个脚本文本，只需以某种易于解析的格式（例如 JSON）返回数据本身，然后将该数据作为参数传递给对更新函数的调用

2）如果你绝对需要传递函数调用，那么你甚至不需要xmlhttp。只需在 DOM 中动态创建一个脚本标记，并将其源指向生成脚本的 PHP 页面。添加脚本标签后，将立即加载脚本。

# jquery - 如何在不重新加载页面的情况下提交表单时使用 JQuery Ajax 发送请求

> ID：14035647
> 
> 赞同：2
> 
> 时间：2012-12-26T03:20:05.667
> 
> 标签：jquery, ajax, forms, jsp, request

我这里有这个表单，需要用户输入一个值。

```
<form id="result" name="result" action="/HelloStruts2/views/register.action" method="post">
    <label>UserName</label>
    <input type="text" name="userBean.username" value="" id="result_userBean_username"/>
    <input type="submit" id="registerSubmit" value="Submit"/>

</form> 
```

这是我的脚本。

```
$(document).ready(function(){
     $('#registerSubmit').live('click',function(){
         alert("XD");
         $.ajax({
             //this is the php file that processes the data and send mail
             url: "register.action", 
             //GET method is used
             type: "POST",
             //pass the data           
             //Do not cache the page
             cache: false,
             //success
             success: function (html) {              
                 //if process.php returned 1/true (send mail success)
                $('#result').html(html);       
             }       
         });
     })
}) 
```

当我提交表单而不是发送请求时，表单正在成功验证，整个页面正在重新加载或刷新，我该如何防止这种情况发生？

**更新** 我已经用这个更新了我的脚本。

```
$(document).ready(function(){
     $('#result').on('submit',function(e){
         e.preventDefault();
         $.ajax({
             //this is the php file that processes the data and send mail
             url: "register.action", 
             //GET method is used
             type: "POST",     
             //Do not cache the page
             cache: false,
             //success
             success: function (html) {              
                $('#content').html(html);       
             }       
         });
     })
}) 
```

但是当我第二次单击该按钮时，页面正在重新加载而不是发送请求

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-26T03:24:56.817

要阻止它被提交（页面重新加载）使用`preventDefault();`

但是，提交表单的方法不止一种，因此请不要绑定到实际上可能不会用于提交表单的按钮。在您的示例中，如果我在文本字段中按 Enter，则会在表单上触发提交；任何绑定到提交按钮的事件都不会被捕获，重要的脚本也不会被执行。

```
$(document).ready(function(){
     $('#result').live('submit',function(e){ // e is the event
           e.preventDefault(); // stop the event's default action
           alert("XD");
           ... 
```

**在旁边：**

`live()`贬值是有充分理由的。采用`on()`

如果表单已经存在（在执行 JS 时）只需替换`live()`

```
$('#result').on('submit', function... 
```

或者如果它是动态生成的，你必须绑定到已经存在的东西，#result 最终会在其中

```
$(document).on('submit', '#result', function()... 
```

**编辑**

鉴于更新的代码和新问题，我怀疑带有 id 结果的表单存在于任何具有 id 内容的元素中，在这种情况下 on() 需要修复到已经存在的元素，正如我之前提到的。在这种情况下，`#content`是适当的元素。

```
$('#content').on('submit', '#result', function()... 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-26T03:23:07.207

添加一个可以使用“e”的事件变量

```
$('#registerSubmit').live('click',function(e){ 
```

并添加

```
e.preventDefault(); 
```

这将防止页面重新加载。所以你有了：

```
$(document).ready(function(){
     $('#registerSubmit').live('click',function(e){
         e.preventDefault();
         alert("XD");
         $.ajax({
             //this is the php file that processes the data and send mail
             url: "register.action", 
             //GET method is used
             type: "POST",
             //pass the data           
             //Do not cache the page
             cache: false,
             //success
             success: function (html) {              
                 //if process.php returned 1/true (send mail success)
                $('#result').html(html);       
             }       
         });
     })
}) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-26T03:37:26.020

```
 $('#registerSubmit').click(function(e){
        e.preventDefault();
    }); 
```

使用 jQuery .click 函数并放置 event.preventDefault() 以停止进入表单操作页面。

# android - 测试执行后冻结android junit测试

> ID：14035650
> 
> 赞同：0
> 
> 时间：2012-12-26T03:20:58.227
> 
> 标签：android, junit, android-testing

在每次测试执行之后，junit 进入下一个测试。每次测试执行后活动都会自动关闭。

测试功能时可以，但测试视图时不行。我想在 junit 执行下一个测试之前在屏幕上看到执行结果。

所以，我想在测试之间做一些小的延迟。

* * *

我有一种方法可以做到：

```
public void testMyView() throws InterruptedException {
    getActivity().runOnUiThread(new Runnable() {

        @Override
        public void run() {
            // viewOperations...
        }
    });
    Thread.sleep(3000);
} 
```

但我不喜欢这种方式，因为这段代码很脏（尤其是当我有很多这样的测试时）。

* * *

另一种方法似乎要好得多：

```
@UiThreadTest
public void testHandleEmptyAlphabetList() throws InterruptedException {
// view operations
    Thread.sleep(3000);
} 
```

但是：它会阻塞 UI 线程，但不会阻塞测试线程。我需要阻止一个测试线程。

有没有办法`Thread.sleep(3000);`在测试线程中单独运行这段代码？

* * *

那么，在测试之间产生线程延迟的最佳方法是什么？

ps 请不要向我推荐额外的测试框架，我想使用嵌入工具来解决我的问题。谢谢你。

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-12-26T05:02:59.157

I suggest ditching this cumbersome way of unit testing and using [Robolectric](http://pivotal.github.com/robolectric/), so your tests run in the JVM and you don't have to deal with all this nasty setup. You'll be pleasantly surprised on how quickly your View testing runs, and that you don't need to run an emulator!

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2013-01-04T09:57:24.023

尝试使用[Robotium](http://code.google.com/p/robotium/)进行需要真正的 android 运行的测试。

```
solo = new Solo(getInstrumentation(), getActivity());
[...]
if (failure) {
    solo.takeScreenshot();
} 
```

这会将屏幕截图保存到您的 SD 卡（需要 WRITE_EXTERNAL_STORAGE 权限）

或者，如果您不想使用其他测试框架（尽管我建议您看一下它），只需窃取那里用于截屏的代码

# objective-c - 将超过一半的单元格移动到另一个部分时，Tableview 崩溃

> ID：14035652
> 
> 赞同：0
> 
> 时间：2012-12-26T03:21:08.407
> 
> 标签：objective-c, uitableview

基本上，我正在尝试编写一个应用程序，它的 tableview 包含两个部分，一个包含未完成的任务（单元格），另一个包含已完成的任务。每个单元格都有一个复选框 UIButton 子类。问题是当我检查超过一半的项目时，它会因 NSRangeException 而崩溃。我真的很感激关于这个问题的任何建议。

错误：*** 由于未捕获的异常“NSRangeException”而终止应用程序，原因：“*** -[__NSArrayM objectAtIndex:]：索引 9 超出范围 [0 .. 8]”

CheckMarkTapped 方法（调用以切换项目）：

```
-(void)checkMarkTapped:(UIButton *)sender {

    UITableViewCell *cell = ((UITableViewCell *)[sender superview]);
    NSIndexPath *originIndexPath = [self.tableView indexPathForCell:cell];
    NSIndexPath *destinationIndexPath;

    NSLog(@"originIndexPath row: %i, section: %i", originIndexPath.row, originIndexPath.section);

    [self fixAllCheckboxes];

    if (originIndexPath.section == 0) {

        destinationIndexPath = [NSIndexPath indexPathForRow:[completedItems count] inSection:1];
        [sender setSelected:NO];

        NSMutableDictionary *tempDict = [[NSDictionary dictionaryWithDictionary:[uncompletedItems objectAtIndex:originIndexPath.row]]mutableCopy];
        [completedItems addObject:tempDict];
        [self.tableView insertRowsAtIndexPaths:[NSArray arrayWithObjects:destinationIndexPath, nil] withRowAnimation:UITableViewRowAnimationLeft];
        [uncompletedItems removeObjectAtIndex:originIndexPath.row];

    }

    if (originIndexPath.section == 1) { //if the checkbox is in section 1
        [sender setSelected:YES];

        NSMutableDictionary *tempDict = [NSDictionary dictionaryWithDictionary:[[completedItems objectAtIndex:originIndexPath.row]mutableCopy]];

        destinationIndexPath = [NSIndexPath indexPathForRow:[[tempDict objectForKey:@"index"]intValue] inSection:0];
        [uncompletedItems insertObject:tempDict atIndex:[[tempDict objectForKey:@"index"]intValue]];
        [self.tableView insertRowsAtIndexPaths:[NSArray arrayWithObjects:destinationIndexPath, nil] withRowAnimation:UITableViewRowAnimationLeft];
        [completedItems removeObjectAtIndex:[self.tableView indexPathForCell:cell].row];

    }

    [self.tableView deleteRowsAtIndexPaths:[NSArray arrayWithObjects:originIndexPath, nil] withRowAnimation:UITableViewRowAnimationLeft];
} 
```

CELLFORROWATINDEXPATH 方法：

```
- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath {

    static NSString *CellIdentifier = @"Cell";

    if (indexPath.section == 1) {
        CellIdentifier = @"Cell1";
    }

    UITableViewCell *cell = [tableView dequeueReusableCellWithIdentifier:CellIdentifier];

    if (cell == nil) {
        cell = [[UITableViewCell alloc] initWithStyle:UITableViewCellStyleDefault reuseIdentifier:CellIdentifier];
        cell.showsReorderControl = YES;
    }

    for (UIControl *checkbox in [cell subviews]) {
        if (checkbox.tag == 9001) {
            [checkbox removeFromSuperview];
        }
    }

    if (indexPath.section == 0) {
        UIButton *checkbox = [[UIButton alloc]initWithFrame:CGRectMake(5, 5, 40, 40)];
        [checkbox addTarget:self action:@selector(checkMarkTapped:) forControlEvents:UIControlEventTouchUpInside];
        [cell setIndentationWidth:45];
        [cell setIndentationLevel:1];

        [checkbox setTag:9001];
        [checkbox setImage:[UIImage imageNamed:@"unchecked"] forState:UIControlStateNormal];
        [checkbox setImage:[UIImage imageNamed:@"checked"] forState:UIControlStateSelected];

        [cell addSubview:checkbox];

        cell.textLabel.backgroundColor = [UIColor whiteColor];
        cell.textLabel.backgroundColor = [UIColor whiteColor];
        cell.contentView.backgroundColor = [UIColor whiteColor];
        cell.textLabel.font = [UIFont boldSystemFontOfSize:20];

        switch (indexPath.section) {
            case 0:
                cell.textLabel.text = [[uncompletedItems objectAtIndex:indexPath.row]objectForKey:@"Name"];
                break;
            case 1:
                cell.textLabel.text = [[completedItems objectAtIndex:indexPath.row]objectForKey:@"Name"];
                [checkbox setSelected:YES];
                break;
            default:
                break;
        }

        [cell addSubview:checkbox];

    } else if (indexPath.section == 1) {

        UIButton *checkbox = [[UIButton alloc]initWithFrame:CGRectMake(5, 5, 40, 40)];
        [checkbox addTarget:self action:@selector(checkMarkTapped:) forControlEvents:UIControlEventTouchUpInside];
        [cell setIndentationWidth:45];
        [cell setIndentationLevel:1];
        [checkbox setTag:9001];

        cell.textLabel.backgroundColor = [UIColor whiteColor];
        cell.textLabel.backgroundColor = [UIColor whiteColor];
        cell.contentView.backgroundColor = [UIColor whiteColor];
        cell.textLabel.font = [UIFont boldSystemFontOfSize:20];
        cell.textLabel.text = [[uncompletedItems objectAtIndex:indexPath.row]objectForKey:@"Name"];

        [checkbox setImage:[UIImage imageNamed:@"unchecked"] forState:UIControlStateNormal];
        [checkbox setImage:[UIImage imageNamed:@"checked"] forState:UIControlStateSelected];

        [cell addSubview:checkbox];

        switch (indexPath.section) {
            case 0:
                cell.textLabel.text = [[uncompletedItems objectAtIndex:indexPath.row]objectForKey:@"Name"];
                break;
            case 1:
                cell.textLabel.text = [[completedItems objectAtIndex:indexPath.row]objectForKey:@"Name"];
                [checkbox setSelected:YES];
                break;
            default:
                break;
        }

        [cell addSubview:checkbox];
    }
    return cell;
} 
```

这是崩溃的 NSLog。如您所见，当数组具有相等数量的项目时会发生这种情况：

```
2012-12-26 12:54:44.583 Checklist R4[1128:c07] Destination Row: 0, UnCompleted Count: 19, Completed Count: 1
2012-12-26 12:54:45.034 Checklist R4[1128:c07] Destination Row: 1, UnCompleted Count: 18, Completed Count: 2
2012-12-26 12:54:45.454 Checklist R4[1128:c07] Destination Row: 2, UnCompleted Count: 17, Completed Count: 3
2012-12-26 12:54:45.873 Checklist R4[1128:c07] Destination Row: 3, UnCompleted Count: 16, Completed Count: 4
2012-12-26 12:54:46.294 Checklist R4[1128:c07] Destination Row: 4, UnCompleted Count: 15, Completed Count: 5
2012-12-26 12:54:47.072 Checklist R4[1128:c07] Destination Row: 5, UnCompleted Count: 14, Completed Count: 6
2012-12-26 12:54:47.399 Checklist R4[1128:c07] Destination Row: 6, UnCompleted Count: 13, Completed Count: 7
2012-12-26 12:54:48.085 Checklist R4[1128:c07] Destination Row: 7, UnCompleted Count: 12, Completed Count: 8
2012-12-26 12:54:48.621 Checklist R4[1128:c07] Destination Row: 8, UnCompleted Count: 11, Completed Count: 9
2012-12-26 12:54:49.090 Checklist R4[1128:c07] Destination Row: 9, UnCompleted Count: 10, Completed Count: 10
2012-12-26 12:54:50.234 Checklist R4[1128:c07] *** Terminating app due to uncaught exception 'NSRangeException', reason: '*** -[__NSArrayM objectAtIndex:]: index 9 beyond bounds [0 .. 8]' 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-26T03:39:03.243

您的`completedItems`或`uncompletedItems`数组，其中一个只有 8 个项目，但您试图访问的项目不止于此。检查你的`numberOfRowsInSection`方法，给出它们的动态值，比如

```
- (NSInteger)tableView:(UITableView *)tableView numberOfRowsInSection:(NSInteger)section
{
    int rowCount = 0;
    if (section == 0) {
        rowCount = [uncompletedItems count];
    } else {
        rowCount = [completedItems count];
    }
    return rowCount;
} 
```

而且它不需要两者`switch`和。使用`if`任何人来检查你`section`是 0 还是 1。

```
-(UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath {

static NSString *CellIdentifier = @"Cell";

if (indexPath.section == 1) {
    CellIdentifier = @"Cell1";
}

UITableViewCell *cell = [tableView dequeueReusableCellWithIdentifier:CellIdentifier];

if (cell == nil) {
    cell = [[UITableViewCell alloc] initWithStyle:UITableViewCellStyleDefault reuseIdentifier:CellIdentifier];
    cell.showsReorderControl = YES;
}

for (UIControl *checkbox in [cell subviews]) {
    if (checkbox.tag == 9001) {
        [checkbox removeFromSuperview];
    }
}

    UIButton *checkbox = [[UIButton alloc]initWithFrame:CGRectMake(5, 5, 40, 40)];
    [checkbox addTarget:self action:@selector(checkMarkTapped:) forControlEvents:UIControlEventTouchUpInside];
    [cell setIndentationWidth:45];
    [cell setIndentationLevel:1];

    [checkbox setTag:9001];
    [checkbox setImage:[UIImage imageNamed:@"unchecked"] forState:UIControlStateNormal];
    [checkbox setImage:[UIImage imageNamed:@"checked"] forState:UIControlStateSelected];

    [cell addSubview:checkbox];

    cell.textLabel.backgroundColor = [UIColor whiteColor];
    cell.textLabel.backgroundColor = [UIColor whiteColor];
    cell.contentView.backgroundColor = [UIColor whiteColor];
    cell.textLabel.font = [UIFont boldSystemFontOfSize:20];

    switch (indexPath.section) {
        case 0:
            cell.textLabel.text = [[uncompletedItems objectAtIndex:indexPath.row]objectForKey:@"Name"];
            break;
        case 1:
            cell.textLabel.text = [[completedItems objectAtIndex:indexPath.row]objectForKey:@"Name"];
            [checkbox setSelected:YES];
            break;
        default:
            break;
    }

    [cell addSubview:checkbox];

return cell;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-26T04:42:15.913

您的代码中可能存在两个问题

1.  `You are returning numbers of rows to Table View less then your array count.`
2.  `Your array is exceeding from the numbers of rows in Table View.`

您的描述`error`清楚地表明您的数组有`8`索引，但您正在访问`9th`导致错误的索引。

# c# - 具有通用转换为接口的 C# 工厂方法

> ID：14035653
> 
> 赞同：3
> 
> 时间：2012-12-26T03:21:09.777
> 
> 标签：c#, generics, factory-pattern

我有以下课程：

```
// -- model hierarchy
public interface IJob {
}

public abstract class AbstractJob : IJob {
}

public class FullTimeJob : AbstractJob {               
}

// -- dao hierarchy
public interface IJobDao<T> where T : IJob {       
  T findById(long jobId);
  long insert(T job);
}

public interface IFullTimeJobDao : IJobDao<FullTimeJob> {        
}

public abstract class AbstractDao {    
}

public abstract class AbstractJobDaoImpl<T> : AbstractDao, IJobDao<T> where T : IJob {
  public T findById(long jobId) {
    // omitted for brevity
  }

  public long insert(T job) {
    // omitted for brevity
  }
}

public class FullTimeJobDaoImpl : AbstractJobDaoImpl<FullTimeJob>, IFullTimeJobDao {
} 
```

我从工厂方法调用以下代码，这似乎不起作用：

```
public IJobDao<IJob> createJobDao(long jobDaoTypeId)
{
    object jobDao = Activator.CreateInstance(typeof(FullTimeJobDaoImpl));
    return jobDao as IJobDao<IJob>; // <-- this returns null
    return (IJobDao<IJob>) jobDao; // <-- this cast fails
} 
```

这种“上投”是如何正确实现的？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-26T03:31:44.247

使`IJobDao`接口协变：

```
public interface IJobDao<out T> where T : IJob
{
    T findById(long jobId);
} 
```

**更新：**

您不能同时让接口方法返回和接受泛型值并使其成为协变的。

可能的解决方案：

*   创建一个非通用版本`IJobDao<T>`- `IJobDao`（当然，你必须在类中实现这两个接口，实现`IJobDao<T>`）
*   分成`IJobDao<T>`2 个接口（一个协变和一个逆变）
*   考虑一个只有非泛型接口的解决方案`IJobDao`（无论如何，你在这里没有得到任何类型安全，这是泛型的主要目的）

关于实现第一个场景的一些想法：

```
public interface IJobDao
{
    IJob findById(long jobId);

    long insert(IJob job);
}

public interface IJobDao<T> : IJobDao
    where T : IJob
{
    new T findById(long jobId);

    new long insert(T job);
}

public abstract class JobDaoBase<T> : IJobDao<T>, IJobDao
    where T : IJob
{
    public abstract T findById(long jobId);

    public abstract long insert(T job);

    IJob IJobDao.findById(long jobId)
    {
        return findById(jobId);
    }

    long IJobDao.insert(IJob job)
    {
        return insert((T)job);
    }
}

public class FullTimeJobDaoImpl : JobDaoBase<FullTimeJob>
{
    public override FullTimeJob findById(long jobId)
    {
        // implementation
    }

    public override long insert(FullTimeJob job)
    {
        // implementation
    }
}

// we are still unable to return generic interface, but we don't need to.
public static IJobDao createJobDao(/* my params */)
{
    object jobDao = Activator.CreateInstance(typeof(FullTimeJobDaoImpl));
    return jobDao as IJobDao;
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-26T03:29:34.720

为了使这种转换成为可能，您需要将接口类型参数标记为`out`：

```
public interface IJobDao<out T> where T : IJob {...} 
```

然后

```
object jobDao = Activator.CreateInstance(typeof(FullTimeJobDaoImpl));
var r = jobDao as IJobDao<IJob>; //not null 
```

但这给界面带来了一些限制。阅读[（通用修饰符）（C# 参考）](http://msdn.microsoft.com/en-us/library/dd469487.aspx)以获取更多信息。

> 在泛型接口中，如果类型参数满足以下条件，则可以将其声明为协变：
> 
> 1.  类型参数仅用作接口方法的返回类型，不用作方法参数的类型。
> 2.  类型参数不用作接口方法的通用约束。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-26T03:54:04.307

考虑对容器使用控制反转方法。各种实现在容器中注册自己。解析器查询 (x) 的一个实例。将 Unity 视为众多 IOC 容器工具之一。

# powershell - 使用 Powershell 设置 iTunes 曲目属性失败

> ID：14035654
> 
> 赞同：0
> 
> 时间：2012-12-26T03:21:19.040
> 
> 标签：powershell, itunes

我曾经使用 vbscripts 来自动执行诸如添加 mp3、更改流派、在 iTunes 中为曲目添加评论等任务。

我现在正在尝试创建 powershell 脚本来做同样的事情。我可以将 mp3 添加到 iTunes，但我未能更改曲目的属性....我不知道我错过了什么....以下是用于更改流派和错误说属性“流派”不存在。

```
$iTunes = New-Object -com "iTunes.Application"
$library = $iTunes.LibraryPlaylist
$iTrack = $library.addfile("c:\temp\test.mp3")
$iTrack.tracks.Genre = "test" 
```

但是，我可以看到该属性使用`$iTrack.tracks | get-member`

```
Genre              Property   string Genre () {get} {set} 
```

感谢任何可以提供帮助的人..

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-26T07:35:14.400

我找到了两种设置属性的方法（还有更多）。

1.  强制track为数组并设置第一项的属性

    @($iTrack.Tracks)[0].Genre = "测试"

2.  按项目名称设置属性（当您拥有的对象已经是您要设置的对象时会发生这种情况）

    $iTrack.Tracks.ItemByName('歌曲名').Genre = "test"

# jquery - Ajax 可以确定要更新哪个 div

> ID：14035655
> 
> 赞同：0
> 
> 时间：2012-12-26T03:21:20.800
> 
> 标签：jquery, ajax

在执行用户登录时，如果登录成功，我想在某个div中显示一条消息。但是，如果登录失败，则会在另一个 div 中显示另一条消息。是否可以确定 Ajax 的“returnData”的内容并相应地更新适当的 div？例如：

```
$(document).ready(function() {
  $('.submitForm').ajaxForm({
    success: function(returnData) {
      if (returnData == '...') { // (or: len(returnData) == ... whatever)
          $('#someDiv').html(returnData);
      } else {
          $('#otherDiv').html(returnData);
      }
    }
  });
}); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-26T03:23:21.173

当然。当然，返回数据必须支持传回登录请求的成功或失败。在这种假设下，您的代码看起来很正确。你试过了吗？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-26T03:23:27.430

是的，当然可以这样做。您正在使用伪代码：

```
if returnData == '...'
    $('#someDiv').html(returnData);
else
    $('#otherDiv').html(returnData); 
```

但实际上并不遥远：

```
if(returnData == '...')  // note the parentheses
    $('#someDiv').html(returnData);
else
    $('#otherDiv').html(returnData); 
```

# jquery - 带有 Google Drive 的动态 Nivo 滑块

> ID：14035666
> 
> 赞同：0
> 
> 时间：2012-12-26T03:23:25.620
> 
> 标签：jquery, html, slider, blogs, nivo-slider

之前成功使用过 Nivo Slider（尽管是在 PHP 环境——OSCommerce 中），并且非常喜欢 Google Drive，我想知道是否可以设置 Nivo Slider jQuery 以允许它查询 Google 电子表格图片链接或直接访问 Google Drive 中的指定文件夹。

有什么简单的方法可以实现这一点，或者我会更好地依赖 Nivo Slider 和 Flickr 的组合吗？

我的目标是为 Google Blogger 博客提供简单、业余友好的设置。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-26T03:27:49.073

它必须是一个谷歌电子表格，还是一个简单的 txt 文件？您可以从中解析文本文件以获取 PHP 中的链接，并将它们提供给 Nivo Slider 脚本。我错过了什么吗？

# jsp - 如何将变量设置为小数点后 2 位

> ID：14035673
> 
> 赞同：6
> 
> 时间：2012-12-26T03:24:09.397
> 
> 标签：jsp, formatting, jstl, variable-assignment

我正在`JSTL`使用中创建一个变量

```
<c:set var="billableTime" value="${ps.computedAmount}" /> 
```

我的问题`ps.computedAmount`不是 2 位小数，我希望`ps.computedAmount`在分配给`billableTime`. 我知道如何`JSTL`使用

```
<fmt:formatNumber type="number" minFractionDigits="2" maxFractionDigits="2" value="${ps.computedAmount}" /> 
```

但我的问题是为变量分配一个 2 位数的值`JSTL`。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-12-26T06:40:49.567

我认为你可以这样做：

```
<c:set var="billableTime"><fmt:formatNumber type="number" minFractionDigits="2" maxFractionDigits="2" value="${ps.computedAmount}" /></c:set> 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2014-11-25T17:18:51.040

```
<fmt:formatNumber var="formattedBillableTime" type="number" minFractionDigits="2" maxFractionDigits="2" value="${ps.computedAmount}" />

<c:set var="billableTime" value="${**formattedBillableTime**}" /> 
```

# c# - 如何从维基百科获取表格

> ID：14035674
> 
> 赞同：2
> 
> 时间：2012-12-26T03:24:15.727
> 
> 标签：c#, xml, web-scraping, html-agility-pack

我想将 Wikipedia 中的一张表放入 xml 文件中，然后将其解析为 C#。是否可以？如果是，我可以只在 xml 中保存**Title**和**Genre**列吗？

```
HtmlWeb web = new HtmlWeb();
HtmlDocument doc = web.Load("http://en.wikipedia.org/wiki/2012_in_film");

HtmlNode node = doc.DocumentNode.SelectSingleNode("//table[@class='wikitable']"); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-26T05:21:01.343

您可以使用以下代码： 搜索您要搜索的 html 标记并制作正则表达式来解析其余数据。此代码将搜索宽度为 150 的表格并获取所有 url/nav url。

```
HtmlElementCollection links = webBrowser1.Document.GetElementsByTagName("table"); //get collection in link
                {
                    foreach (HtmlElement link_data in links) //parse for each collection
                    {
                        String width = link_data.GetAttribute("width");
                        {
                            if (width != null && width == "150")
                            {
                                Regex linkX = new Regex("<a[^>]*?href=\"(?<href>[\\s\\S]*?)\"[^>]*?>(?<Title>[\\s\\S]*?)</a>", RegexOptions.IgnoreCase);
                                MatchCollection category_urls = linkX.Matches(link_data.OuterHtml);
                                if (category_urls.Count > 0)
                                {
                                    foreach (Match match in category_urls)
                                    {
                                           //rest of the code
                                    }
                                }
                             }
                         }
                     }
                } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-26T05:24:15.893

您可以使用网络浏览器：

```
//First navigate to your address
 webBrowser1.Navigate("http://en.wikipedia.org/wiki/2012_in_film");
        List<string> Genre = new List<string>();
        List<string> Title = new List<string>();
  //When page loaded
  foreach (HtmlElement table in webBrowser1.Document.GetElementsByTagName("table"))
            {
                if (table.GetAttribute("className").Equals("wikitable"))
                {
                    foreach (HtmlElement tr in table.GetElementsByTagName("tr"))
                    {
                        int columncount = 1;
                        foreach (HtmlElement td in tr.GetElementsByTagName("td"))
                        {
                            //Title
                            if (columncount == 4)
                            {
                                Title.Add(td.InnerText);
                            }
                            //Genre
                            if (columncount == 7)
                            {
                                Genre.Add(td.InnerText);
                            }
                            columncount++;
                        }

                    }
                }
            } 
```

现在你有两个列表（流派和标题）。您可以简单地将它们转换为 xml 文件

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-26T12:46:43.440

还可以考虑在维基百科页面的特定部分查看 Wikipedia API 以归零

*   [https://en.wikipedia.org/w/api.php?action=parse&page=2012_in_film&mobileformat=html§ion=1&prop=wikitext](https://en.wikipedia.org/w/api.php?action=parse&page=2012_in_film&mobileformat=html&section=1&prop=wikitext)

API 文档描述了如何格式化搜索结果以供后续解析。

# ruby-on-rails - 我需要在 Ruby on Rails 生成器中指定外键吗？

> ID：14035684
> 
> 赞同：1
> 
> 时间：2012-12-26T03:27:15.520
> 
> 标签：ruby-on-rails, model, foreign-keys, generator

这是我正在构建的非常小的基本测试网站用例：

```
A 'Posting' belongs to a 'User' and a 'User' can have many 'Posting's. 
```

我知道在数据库中必须有一个外键关系。我需要在生成器中指定这个外键吗？

```
rails generate Posting name:string body:text post_date:date User:User??? 
```

谢谢你的建议。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-26T03:34:12.403

只需将其设为带有模型名称下划线 id 的整数

```
rails g Post user_id:integer 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-26T06:20:36.677

```
rails g Posting name:string body:text post_date:date user:references 
```

顺便说一句，如果你的字段类型是字符串，你实际上不需要指定它的类型 - 默认情况下，rails 会将它设置为字符串。

# c# - Java 的 BitSet 的 C# 等价物是什么？

> ID：14035687
> 
> 赞同：3
> 
> 时间：2012-12-26T03:27:58.483
> 
> 标签：c#, java, bitset

我的要求很简单：

1.  能够定义位数组的维度，即：5字节。
2.  布尔获取（位索引：int）
3.  设置（位索引：int）

是否有 ac# 等效项提供与`BitSet`Java 中类似的功能？

这是场景：

1.  初始化 5 个字节，所有位为 0（假）。
2.  将字节 3、位 8 设置为 TRUE。
3.  获取字节 3、位 8 的状态。

**更新**：Michael Bray 的解决方案：

```
static void Main(string[] args) 
{ 
  // Set for 5 bytes 
  BitArray ba = new BitArray(8 * 5); 

  // Set bit #1 on byte #4 
  ba.Set(GetBitNum(4, 1), true); 

  // Get bit #1 on byte #4 
  bool v = ba.Get(GetBitNum(4, 1)); 
} 

static int GetBitNum(int byteNum, int bitNum)   // Assumes index starts at 1 
{ 
  return (byteNum - 1) * 8 + (bitNum - 1); 
} 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-12-26T03:30:07.723

`System.Collections.BitArray`非常接近，但它有点缺乏功能。不久前，我编写了一个帮助类，它实现了 BitArray 可能需要的许多功能，但我必须对其进行挖掘。如果你认为你需要它，请告诉我。

**编辑**：按照下面评论中的要求，我已在[http://pastebin.com/GLyzcUZC](http://pastebin.com/GLyzcUZC)上发布了代码。不过，正如我所讨论的，它相对于库存 BitArray 的好处是微乎其微的，因为我写它是为了满足我的一些特定需求。随心所欲地使用它。

**编辑 2**：正如 Miguel 在评论中指出的那样，有一些实现问题使我的“BitArray”代码不太好......我已经意识到了这些缺陷并重新编写了一个名为 BoolArray 的新版本（以区别于 BitArray ) 不会受到这些问题的影响：

```
namespace Utils
{
    using System;
    using System.Collections;
    using System.Collections.Generic;
    using System.ComponentModel;
    using System.Globalization;
    using System.Linq;
    using System.Threading;

    /// <summary>
    /// A replacement for BitArray
    /// </summary>
    public class BoolArray : IEnumerable, ICollection, ICloneable
    {
        private UInt32[] bits = null;
        private int _length = 0;
        private static UInt32 ONE = (UInt32)1 << 31;
        private object _syncRoot;
        private static Func<byte[], byte[]> EndianFixer = null;

        #region Constructors

        static BoolArray()
        {
            if (BitConverter.IsLittleEndian) EndianFixer = (a) => a.Reverse().ToArray();
            else EndianFixer = (a) => a;
        }

        public BoolArray(BoolArray srcBits)
        {
            this.InitializeFrom(srcBits.ToArray());
        }

        public BoolArray(BitArray srcBits)
        {
            this._length = srcBits.Count;
            this.bits = new UInt32[RequiredSize(this._length)];

            for (int i = 0; i < srcBits.Count; i++) this[i] = srcBits[i];
        }

        public BoolArray(int v)
        {
            ICollection<byte> bytes = EndianFixer(BitConverter.GetBytes(v)).ToList();
            InitializeFrom(bytes);
        }

        public BoolArray(ICollection<bool> srcBits)
        {
            this.InitializeFrom(srcBits.ToArray());
        }

        public BoolArray(ICollection<byte> srcBits)
        {
            InitializeFrom(srcBits);
        }

        public BoolArray(ICollection<short> srcBits)
        {
            ICollection<byte> bytes = srcBits.SelectMany(v => EndianFixer(BitConverter.GetBytes(v))).ToList();
            InitializeFrom(bytes);
        }

        public BoolArray(ICollection<ushort> srcBits)
        {
            ICollection<byte> bytes = srcBits.SelectMany(v => EndianFixer(BitConverter.GetBytes(v))).ToList();
            InitializeFrom(bytes);
        }

        public BoolArray(ICollection<int> srcBits)
        {
            ICollection<byte> bytes = srcBits.SelectMany(v => EndianFixer(BitConverter.GetBytes(v))).ToList();
            InitializeFrom(bytes);
        }

        public BoolArray(ICollection<uint> srcBits)
        {
            ICollection<byte> bytes = srcBits.SelectMany(v => EndianFixer(BitConverter.GetBytes(v))).ToList();
            InitializeFrom(bytes);
        }

        public BoolArray(ICollection<long> srcBits)
        {
            ICollection<byte> bytes = srcBits.SelectMany(v => EndianFixer(BitConverter.GetBytes(v))).ToList();
            InitializeFrom(bytes);
        }

        public BoolArray(ICollection<ulong> srcBits)
        {
            ICollection<byte> bytes = srcBits.SelectMany(v => EndianFixer(BitConverter.GetBytes(v))).ToList();
            InitializeFrom(bytes);
        }

        public BoolArray(int capacity, bool defaultValue = false)
        {
            this.bits = new UInt32[RequiredSize(capacity)];
            this._length = capacity;

            // Only need to do this if true, because default for all bits is false
            if (defaultValue) for (int i = 0; i < this._length; i++) this[i] = true;
        }

        private void InitializeFrom(ICollection<byte> srcBits)
        {
            this._length = srcBits.Count * 8;
            this.bits = new UInt32[RequiredSize(this._length)];
            for (int i = 0; i < srcBits.Count; i++)
            {
                uint bv = srcBits.Skip(i).Take(1).Single();
                for (int b = 0; b < 8; b++)
                {
                    bool bitVal = ((bv << b) & 0x0080) != 0;
                    int bi = 8 * i + b;
                    this[bi] = bitVal;
                }
            }
        }

        private void InitializeFrom(ICollection<bool> srcBits)
        {
            this._length = srcBits.Count;
            this.bits = new UInt32[RequiredSize(this._length)];

            int index = 0;
            foreach (var b in srcBits) this[index++] = b;
        }

        private static int RequiredSize(int bitCapacity)
        {
            return (bitCapacity + 31) >> 5;
        }

        #endregion

        public bool this[int index]
        {
            get
            {
                if (index >= _length) throw new IndexOutOfRangeException();

                int byteIndex = index >> 5;
                int bitIndex = index & 0x1f;
                return ((bits[byteIndex] << bitIndex) & ONE) != 0;
            }
            set
            {
                if (index >= _length) throw new IndexOutOfRangeException();

                int byteIndex = index >> 5;
                int bitIndex = index & 0x1f;
                if (value) bits[byteIndex] |= (ONE >> bitIndex);
                else bits[byteIndex] &= ~(ONE >> bitIndex);
            }
        }

        #region Interfaces implementation
        #region IEnumerable
        public IEnumerator GetEnumerator()
        {
            //for (int i = 0; i < _length; i++) yield return this[i];
            return this.ToArray().GetEnumerator();
        }
        #endregion
        #region ICollection
        public void CopyTo(Array array, int index)
        {
            if (array == null) throw new ArgumentNullException("array");
            if (index < 0) throw new ArgumentOutOfRangeException("index");
            if (array.Rank != 1) throw new ArgumentException("Multidimensional array not supported");
            if (array is UInt32[]) Array.Copy(this.bits, 0, array, index, (this.Count + sizeof(UInt32) - 1) / sizeof(UInt32));
            else if (array is bool[]) Array.Copy(this.ToArray(), 0, array, index, this.Count);
            else throw new ArgumentException("Array type not supported (UInt32[] or bool[] only)");

        }

        public int Count
        {
            get { return this._length; }
            private set
            {
                if (value > this._length) Extend(value - this._length);
                else this._length = Math.Max(0, value);
            }
        }

        public bool IsSynchronized
        {
            get { return false; }
        }

        public object SyncRoot
        {
            get
            {
                if (this._syncRoot == null) Interlocked.CompareExchange<object>(ref this._syncRoot, new object(), null);
                return _syncRoot;
            }
        }
        #endregion
        #region ICloneable
        public object Clone()
        {
            return new BoolArray(this);
        }
        // Not part of ICloneable, but better - returns a strongly-typed result
        public BoolArray Dup()
        {
            return new BoolArray(this);
        }
        #endregion 
        #endregion

        #region String Conversions

        public override string ToString()
        {
            return ToBinaryString();
            //return ToHexString(" ", " ■ ");
        }

        public static BoolArray FromHexString(string hex)
        {
            if (hex == null) throw new ArgumentNullException("hex");

            List<bool> bits = new List<bool>();
            for (int i = 0; i < hex.Length; i++)
            {
                int b = byte.Parse(hex[i].ToString(), NumberStyles.HexNumber);
                bits.Add((b >> 3) == 1);
                bits.Add(((b & 0x7) >> 2) == 1);
                bits.Add(((b & 0x3) >> 1) == 1);
                bits.Add((b & 0x1) == 1);
            }
            BoolArray ba = new BoolArray(bits.ToArray());
            return ba;
        }

        public string ToHexString(string bitSep8 = null, string bitSep128 = null)
        {
            string s = string.Empty;
            int b = 0;
            bool[] bbits = this.ToArray();

            for (int i = 1; i <= bbits.Length; i++)
            {
                b = (b << 1) | (bbits[i - 1] ? 1 : 0);
                if (i % 4 == 0)
                {
                    s = s + string.Format("{0:x}", b);
                    b = 0;
                }

                if (i % (8 * 16) == 0)
                {
                    s = s + bitSep128;
                }
                else if (i % 8 == 0)
                {
                    s = s + bitSep8;
                }
            }
            int ebits = bbits.Length % 4;
            if (ebits != 0)
            {
                b = b << (4 - ebits);
                s = s + string.Format("{0:x}", b);
            }
            return s;
        }

        public static BoolArray FromBinaryString(string bin, char[] trueChars = null)
        {
            if (trueChars == null) trueChars = new char[] { '1', 'Y', 'y', 'T', 't' };
            if (bin == null) throw new ArgumentNullException("bin");
            BoolArray ba = new BoolArray(bin.Length);
            for (int i = 0; i < bin.Length; i++) ba[i] = bin[i].In(trueChars);
            return ba;
        }

        public string ToBinaryString(char setChar = '1', char unsetChar = '0')
        {
            return new string(this.ToArray().Select(v => v ? setChar : unsetChar).ToArray());
        }

        #endregion

        #region Class Methods
        public bool[] ToArray()
        {
            bool[] vbits = new bool[this._length];
            for (int i = 0; i < _length; i++) vbits[i] = this[i];
            return vbits;
        }

        public BoolArray Append(ICollection<bool> addBits)
        {
            int startPos = this._length;
            Extend(addBits.Count);
            bool[] bitArray = addBits.ToArray();
            for (int i = 0; i < bitArray.Length; i++) this[i + startPos] = bitArray[i];
            return this;
        }

        public BoolArray Append(BoolArray addBits)
        {
            return this.Append(addBits.ToArray());
        }

        public static BoolArray Concatenate(params BoolArray[] bArrays)
        {
            return new BoolArray(bArrays.SelectMany(ba => ba.ToArray()).ToArray());
        }

        private void Extend(int numBits)
        {
            numBits += this._length;
            int reqBytes = RequiredSize(numBits);
            if (reqBytes > this.bits.Length)
            {
                UInt32[] newBits = new UInt32[reqBytes];
                this.bits.CopyTo(newBits, 0);
                this.bits = newBits;
            }
            this._length = numBits;
        }

        public bool Get(int index)
        {
            return this[index];
        }

        public BoolArray GetBits(int startBit = 0, int numBits = -1)
        {
            if (numBits == -1) numBits = bits.Length;
            return new BoolArray(this.ToArray().Skip(startBit).Take(numBits).ToArray());
        }

        public BoolArray Repeat(int numReps)
        {
            bool[] oBits = this.ToArray();
            List<bool> nBits = new List<bool>();
            for(int i=0; i<numReps; i++) nBits.AddRange(oBits);
            this.InitializeFrom(nBits);
            return this;
        }

        public BoolArray Reverse()
        {
            int n = this.Count;
            for(int i=0; i<n/2; i++) 
            {
                bool b1 = this[i];
                this[i] = this[n - i - 1];
                this[n - i - 1] = b1;
            }
            return this;
        }

        public BoolArray Set(int index, bool v)
        {
            this[index] = v;
            return this;
        }

        public BoolArray SetAll(bool v)
        {
            for (int i = 0; i < this.Count; i++) this[i] = v;
            return this;
        }

        public BoolArray SetBits(ICollection<bool> setBits, int destStartBit = 0, int srcStartBit = 0, int numBits = -1, bool allowExtend = false)
        {
            if (setBits == null) throw new ArgumentNullException("setBits");
            if ((destStartBit < 0) || (destStartBit >= this.Count)) throw new ArgumentOutOfRangeException("destStartBit");
            if ((srcStartBit < 0) || (srcStartBit >= setBits.Count)) throw new ArgumentOutOfRangeException("srcStartBit");

            bool[] sBits;
            if (setBits is bool[]) sBits = (bool[])setBits;
            else sBits = setBits.ToArray();

            if (numBits == -1) numBits = setBits.Count;
            if (numBits > (setBits.Count - srcStartBit)) numBits = setBits.Count - srcStartBit;

            int diffSize = numBits - (this.Count - destStartBit);
            if (diffSize > 0)
            {
                if (allowExtend) Extend(diffSize);
                else numBits = this.Count - destStartBit;
            }
            for (int i = 0; i < numBits; i++) this[destStartBit + i] = sBits[srcStartBit + i];
            return this;
        }

        public List<BoolArray> SplitEvery(int numBits)
        {
            int i = 0;
            List<BoolArray> bitSplits = new List<BoolArray>();
            while (i < this.Count)
            {
                bitSplits.Add(this.GetBits(i, numBits));
                i += numBits;
            }
            return bitSplits;
        }

        public byte[] ToBytes(int startBit = 0, int numBits = -1)
        {
            if (numBits == -1) numBits = this._length - startBit;
            BoolArray ba = GetBits(startBit, numBits);
            int nb = (numBits + 7) / 8;
            byte[] bb = new byte[nb];
            for (int i = 0; i < ba.Count; i++)
            {
                if (!ba[i]) continue;
                int bp = 7 - (i % 8);
                bb[i / 8] = (byte)((int)bb[i / 8] | (1 << bp));
            }
            return bb;
        }

        #endregion

        #region Logical Bitwise Operations
        public BoolArray BinaryBitwiseOp(Func<bool, bool, bool> op, BoolArray ba, int start = 0)
        {
            for (int i = 0; i < ba.Count; i++)
            {
                if (start + i >= this.Count) break;
                this[start + i] = op(this[start + i], ba[i]);
            }
            return this;
        }

        public BoolArray Xor(BoolArray xor, int start = 0)
        {
            return BinaryBitwiseOp((a, b) => (a ^ b), xor, start);
        }

        public BoolArray And(BoolArray and, int start = 0)
        {
            return BinaryBitwiseOp((a, b) => (a & b), and, start);
        }

        public BoolArray Or(BoolArray or, int start = 0)
        {
            return BinaryBitwiseOp((a, b) => (a | b), or, start);
        }

        public BoolArray Not(int start = 0, int len = -1)
        {
            for (int i = start; i < this.Count; i++)
            {
                if (--len == -1) break;
                this[i] = !this[i];
            }
            return this;
        } 
        #endregion

        #region Class Operators

        public static BoolArray operator +(BoolArray a, BoolArray b)
        {
            return a.Dup().Append(b);
        }

        public static BoolArray operator |(BoolArray a, BoolArray b)
        {
            return a.Dup().Or(b);
        }

        public static BoolArray operator &(BoolArray a, BoolArray b)
        {
            return a.Dup().And(b);
        }

        public static BoolArray operator ^(BoolArray a, BoolArray b)
        {
            return a.Dup().Xor(b);
        }

        public static BoolArray operator ~(BoolArray a)
        {
            return a.Dup().Not();
        }

        public static BoolArray operator <<(BoolArray a, int shift)
        {
            return a.Dup().Append(new bool[shift]);
        }

        public static BoolArray operator >>(BoolArray a, int shift)
        {
            return new BoolArray(a.ToArray().Take(Math.Max(0, a.Count - shift)).ToArray());
        }

        public static bool operator ==(BoolArray a, BoolArray b)
        {
            if (a.Count != b.Count) return false;
            for (int i = 0; i < a.Count; i++) if (a[i] != b[i]) return false;
            return true;
        }
        public override bool Equals(object obj)
        {
            if (!(obj is BoolArray)) return false;
            return (this == (BoolArray)obj);
        }
        public override int GetHashCode()
        {
            return this.ToHexString().GetHashCode();
        }

        public static bool operator !=(BoolArray a, BoolArray b)
        {
            return !(a == b);
        }

        #endregion
    }
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-12-03T05:06:12.463

我有同样的问题，但不仅仅是一种基数方法来转换。所以，我选择移植整个 BitSet 类。幸好它是独立的。

这是[C# 端口的要点](https://gist.github.com/NightOwl888/12abed2c1a68330ac57d)。

我还将它添加到开源[BoboBrowse.Net 项目](https://github.com/NightOwl888/BoboBrowse.Net/blob/master/src/BoboBrowse.Net/BoboBrowse.Net/Support/BitSet.cs)中。

我还从 Apache Harmony（本质上是 JDK 的抄本）移植了该版本，并将其添加到通用库[J2N 中](https://www.nuget.org/packages/J2N)，因此易于使用。

# linux - 如何在我的文件中搜索没有数字/字母字符

> ID：14035691
> 
> 赞同：-4
> 
> 时间：2012-12-26T03:28:26.577
> 
> 标签：linux

我有一个包含大量数据的文本文件，这些数据按行分隔的字符串排列。我在使用此文件的另一个程序中遇到错误。似乎有一个非字母/数字字符。我该如何搜索它？如果找到如何删除它？

编辑：包括空格（即，该行是空白）。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-26T06:57:21.000

试试这个命令：

*   `cat bigfile.txt| od -cx | less`

不可打印的字符将显示为“\xxx”。可打印字符将显示为 ASCII 文本。所有字符 - 可打印或不可打印 - 都将显示为十六进制，您可以看到文件中的偏移量。

一旦您知道 1) 有问题的角色是什么，或 2) 他们所在的位置，您就可以制定消除他们的策略。也许您只需要一个简单的“sed”脚本。

PS：

“vi -b”可能也可以工作，即使对于看起来庞大的文件也是如此。恕我直言...

# jquery - 添加 JQuery 验证代码后，Ajax 表单提交未重置或触发警报

> ID：14035693
> 
> 赞同：0
> 
> 时间：2012-12-26T03:29:48.400
> 
> 标签：jquery, ajax, forms, validation

在添加 JQuery 验证之前，我让这段代码工作得很好。现在，就目前而言，验证工作正常，一旦按下提交按钮，我确实收到了电子邮件，但最后两个语句（表单重置和警报）不再触发。我在这里做错了什么？

```
<script type="text/javascript"> 
// wait for the DOM to be loaded 
        $(document).ready(function() { 
        $('#contact_form').validate({
        rules:{
        namefield:{
        required:true,
        minlength: 10
        },
        emailaddress:{
        required:true,
        minlength: 12,
        email: true
        },
        textmessage:{
        required:true,
        minlength: 12,
        maxlength: 2500
    },                  
},

        errorElement: "div",
        wrapper: "div class=\"validatemessage\""
     }),

        $('#contact_form').ajaxForm(function() {
        $('#contact_form')[0].reset(); 
        alert("Thank you for your email!");

});
});
</script> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-26T09:22:59.577

看来您正在使用[jQuery Form Plugin](http://malsup.com/jquery/form/)。

您可以通过 2 种方式重置表单：

**方法一：使用** `resetForm()` **方法**

```
$('#contact_form').ajaxForm(function() {
    alert("Thank you for your comment!")
    $('#contact_form').resetForm();
}); 
```

**方法 2：** `resetForm` **在表单选项中使用属性**

> **resetForm**
> 布尔标志，表示如果提交成功，是否应重置表单
> 默认值：*null*

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-26T17:04:25.467

将您的`ajaxForm`调用移至`submitHandler`validate 插件的函数中：

```
$(document).ready(function(){
   $("#contact_form").validate({
      rules:{
        namefield:{
        required: "Please enter your name",
        minlength: 10
        },
        emailaddress:{
        required:true,
        minlength: 12,
        email: true
        },
        textmessage:{
        required:"Your message is too short.",
        minlength: 12,
        maxlength: 2500

        }                 
    },

    errorElement: "div",
    wrapper: "div",  
    submitHandler:function(form){
      $(form).ajaxForm(function() {
        alert("Thank you for your comment!")
        form.reset();
      });
    }                    
  });
}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-26T04:26:54.347

```
 $(document).ready(function() { 
        $('#contact_form').validate({
        rules:{
        namefield:{
        required:true,
        minlength: 10
        },
        emailaddress:{
        required:true,
        minlength: 12,
        email: true
        },
        textmessage:{
        required:true,
        minlength: 12,
        maxlength: 2500
    }                 
},

        errorElement: "div",
    wrapper: "div class=\"validatemessage\""
   });  

        $('#contact_form').ajaxForm(function() {
        $('#contact_form')[0].reset();
        alert("Thank you for your email!");

});
}); 
```

# java - 如何使用“%*%”作为分隔符在Java中拆分字符串，包括字符串结果列表中的分隔符？

> ID：14035694
> 
> 赞同：1
> 
> 时间：2012-12-26T03:29:56.027
> 
> 标签：java, regex

我正在寻找标记字符串的最简单方法，例如

```
 INPUT                       OUTPUT
"hello %my% world" -> "hello ", "%my%", " world" 
```

在爪哇。是否可以使用正则表达式来实现这一点？我基本上是在寻找一个 String.split() ，它将“%*%”形式的东西作​​为分隔符，但它不会像通常那样忽略它。

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-26T04:07:34.680

不，您不能按照您解释的方式执行此操作。原因是——模棱两可！

你举个例子：

“你好 %my% 世界”->“你好”、“%my%”、“世界”

应该将 % 附加到字符串之前还是之后？

输出应该是

“你好”、“%my”、“%world”

或者，也许输出应该是

“你好%”、“我的%”、“世界”

在您的示例中，您不遵循这些规则中的任何一个。您想出了 %my% ，它将分隔符在出现*后*首先附加到字符串上，然后在出现*之前*附加到字符串上。

你看到歧义了吗？

因此，您首先需要提出一套明确的规则，说明您希望将分界符附加到何处。一旦你这样做了，一种简单的（虽然不是特别有效，因为字符串是不可变的）实现你想要的方法是：

1.  用于`String.split()`以正常方式拆分字符串
2.  按照您的规则集将分隔符重新添加到它应该在字符串中的位置。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-26T04:14:02.760

一个更简单的解决方案是将字符串拆分为`%`s。这样，每个其他子序列都在`%`s 之间。之后您所要做的就是遍历结果，切换一个标志以了解结果是常规字符串还是`%`s 之间的字符串。

必须特别注意*拆分*实现，它如何处理空子序列。一些实现决定在输入的开始/结束时丢弃空子序列，其他实现丢弃所有空子序列，而其他实现不丢弃它们。

这不会产生您想要的确切输出，因为`%`s 会消失。但是，如果确实需要它们，您可以轻松地将它们添加回来（我认为没有）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-26T04:11:32.227

为什么不按单词之间的空格分开。在这种情况下，您将得到“hello”、“%my%”、“world”。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-26T05:03:45.147

如果可能，请使用更简单的分隔符。而且我可以将陪审团操纵“％”作为您的分隔符，这样您就可以得到`String.split()`而不是正则表达式。但如果这不可能...

[正则表达式](http://www.codinghorror.com/blog/2008/06/regular-expressions-now-you-have-two-problems.html)！您可以使用`Matcher`. 如果您知道每行有一个定界符，则指定一个吃掉整行的模式：

```
 String singleDelimRegexp = "(.*)(%[^%]*%)(.*)";
    Pattern singleDelimPattern = Pattern.compile(singleDelimRegexp);
    Matcher singleDelimMatcher = singleDelimPattern.matcher(input);

    if (singleDelimMatcher.matches()) {
        String before = singleDelimMatcher.group(1);
        String delim = singleDelimMatcher.group(2);
        String after = singleDelimMatcher.group(3);

        System.out.println(before + "//" + delim + "//" + after);
    } 
```

如果输入很长并且您需要一系列结果，则在循环中使用 Matcher：

```
String multiDelimRegexp = "%[^%]*%";
    Pattern multiDelimPattern = Pattern.compile(multiDelimRegexp);
    Matcher multiDelimMatcher = multiDelimPattern.matcher(input);

    int lastEnd = 0;
    while (multiDelimMatcher.find()) {
        String data = input.substring(lastEnd, multiDelimMatcher.start());
        String delim = multiDelimMatcher.group();
        lastEnd = multiDelimMatcher.end();
        System.out.println(data);
        System.out.println(delim);
    }
    String lastData = input.substring(lastEnd);
    System.out.println(lastData); 
```

随时将它们添加到数据结构中，您将构建整个解析后的输入。

在输入上运行：http: [//ideone.com/s8FzeW](http://ideone.com/s8FzeW)

# c# - 如何将数据库字符串值设置为空？

> ID：14035696
> 
> 赞同：-1
> 
> 时间：2012-12-26T03:30:14.963
> 
> 标签：c#, asp.net, sql

我的数据库`branch column`中包含一些值，例如“B01”，
我正在尝试将分支列设置回
我尝试过的空值

1.  字符串.空
2.  字符串.空
3.  “”
4.  无效的
5.  DBNull.value

注意*所有能够将我的值设置回“”但不是我的预期结果的方法，我的预期结果是我的列回到“NULL”而不是“”

```
 if (ddlBranches.SelectedIndex > 0 && ddlLocation.SelectedItem.Text.ToUpper() == "BRANCH")
    {
        drUpdProb["Branch"] = ddlBranches.SelectedValue.ToString();
        drUpdProb["BranchAbbr"] = ddlBranches.SelectedItem.Text;
    }
    else
    {
        drUpdProb["Branch"] = DBNull.value;
        drUpdProb["BranchAbbr"] = DBNull.value;
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-26T03:46:53.207

尝试像下面这样创建一个参数来分配值

```
 cmd.Parameters.AddWithValue("@Branch", drUpdProb["Branch"] ?? (object)DBNull.Value);
 cmd.Parameters.AddWithValue("@BranchAbbr", drUpdProb["BranchAbbr"] ?? (object)DBNull.Value); 
```

# php - 致命错误：调用未定义函数 mb_substr()

> ID：14035698
> 
> 赞同：22
> 
> 时间：2012-12-26T03:30:32.670
> 
> 标签：php, string

我想看看您对我目前遇到的这个问题的意见。事实证明：

```
 <?php
$disc_t=$name; 
  if(strlen($disc_t)<=15)
  {
   $name_now=mb_substr( strip_tags($disc_t), 0, 10 ).'';
  }
  else
  {
   $name_now=mb_substr( strip_tags($disc_t), 0, 10).'...';
  }
?> 
```

以某种方式在网站上给我一个错误，错误显示：

```
Fatal error: Call to undefined function mb_substr() in /home/(website)/public_html/index.php on line 308 
```

我不太明白他们的意思`mb_substr`，这是 PHP 版本错误吗？我目前正在使用 PHP 5.3.19

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2012-12-26T03:34:49.127

[`mb_substr()`](http://php.net/mb-substr)是 的多字节安全版本[`substr()`](http://php.net/substr)，这意味着它适用于*字符*而不是*字节*。这在 UTF-8 中最为明显，其中许多字符由两个或多个字节表示。

根据[安装说明](http://php.net/manual/en/mbstring.installation.php)，`mbstring`不是内置扩展。您必须通过拥有适当的文件并正确配置 PHP 来启用它。一些信息可以在提供的链接中找到，您的虚拟主机应该能够为您提供其他帮助。

查看是否安装了 mbstring： `php -m | grep mbstring`

对于 Linux，安装使用

`sudo apt-get install php-mbstring`

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2012-12-26T03:38:55.810

将其放入终端：

```
php -m | grep mb 
```

如果`mbstring`出现，那么它应该可以工作。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2015-12-16T07:35:51.083

如果您具有 root 访问权限，则可以使用 WHM 面板或使用命令行对其进行配置。我会告诉你如何使用 WHM Panel 来做到这一点。
1\. 使用 Root 用户登录您的 WHM
2\. 转到 Easyapache
3\. 转到以前保存的配置
4\. 单击 Start Customizing based on Profile。
5.不要更改apache和php版本，直接点next即可。
6\. 单击 php 配置底部的详尽选项列表
7\. 选中 MBString 选项附近的复选框
8\. 保存并构建
**9\. 如果需要一段时间，请不要关闭浏览器窗口。耐心点。**
你完成了！！！

* * *

## 回答 #4

> 赞同：-2
> 
> 时间：2012-12-26T03:37:52.757

该错误告诉您您正在尝试使用一个名为 mb_substr 的函数，该函数不存在。

也许您可以使用 substr 函数[http://php.net/manual/en/function.substr.php](http://php.net/manual/en/function.substr.php) 来实现相同的结果。substr(strip_tags($disc_t), 0, 10) 将返回 strip_tags($disc_t) 结果的前十个字符。

# java - 如何抑制丢失“抛出”的错误

> ID：14035705
> 
> 赞同：1
> 
> 时间：2012-12-26T03:32:31.087
> 
> 标签：java, eclipse, exception, throws

`throws`在方法中抛出异常时，有没有办法让 Eclipse 抑制缺少声明的错误？

如果您要在没有明确指定的情况下构建和运行某些东西`throws`，它将展开到该`main`方法并使程序崩溃（这是我在这种特殊情况下想要的）。有某些例外情况，例如`sun.reflect.generics.reflectiveObjects.NotImplementedException`，它允许您在不需要指定的情况下抛出它`throws`。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-26T03:42:52.563

Eclipse 在这里没有做任何特别的事情。问题在于 Java 代码本身。您的两个最佳选择是更改方法的签名以包含`throws`，或捕获异常并将其作为 RuntimeException（或 RuntimeException 的子类）重新抛出。

```
try {
    doWhatever();
} catch (SomeException e) {
    throw new SomeRuntimeException(e);
} 
```

...其中 SomeException 是或扩展了 Exception（但不是 RuntimeException），而 SomeRuntimeException 是或扩展了 RuntimeException。

有关更多信息，请查看 Sun 的 Java 教程中有关已[检查异常](http://docs.oracle.com/javase/tutorial/essential/exceptions/catchOrDeclare.html)的部分。

# wpf - 将 xaml 文件的一部分移动到另一个 xaml 文件

> ID：14035706
> 
> 赞同：2
> 
> 时间：2012-12-26T03:32:39.917
> 
> 标签：wpf, xaml, grid

在我的项目中，我有这样的 XAML 文件：

```
<Grid Margin="50,0,0,0">
   //Huge amount of code goes here
</Grid> 
```

设计时很难遍历所有代码`Grid`。我可以将所有代码移动到单独的 XAML 文件文件中，并在此`Grid`内容中我将调用该 XAML 文件吗？

```
<Grid Margin="50,0,0,0">
    //call xaml file here
</Grid> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-26T04:27:32.747

您应该定义一个 UserControl；假设“大量代码”是这样的：

```
<Border Name="yourBorder">
      //Other Xamls
</Border> 
```

现在您创建一个新的 UserControl 并将此 Border 放入其中

```
<UserControl x:Class="WpfApplication.UserControl1"
         xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
         xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
         xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
         xmlns:d="http://schemas.microsoft.com/expression/blend/2008" 
         mc:Ignorable="d" 
         d:DesignHeight="300" d:DesignWidth="300">
 <Border Name="yourBorder">
      //Other Xamls
</Border>
</UserControl> 
```

您可以`UserControl1`在其他 Xamls 中使用。您应该添加`xmlns:wp="clr-namespace:WpfApplication"`到您的 Xaml。例如，如果您想在 Window 中使用它：

```
<Window x:Class="WpfApplication.Window2"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:wp="clr-namespace:WpfApplicationUpper"     //This is what I mentioned
    Title="Window2" Height="300" Width="300">
<StackPanel>
    <wp:UserControl1 />    // You call it using this format
</SatckPanel> 
```

# node.js - 在 Amazon Ec2 免费层上为套接字 io 启动新端口

> ID：14035708
> 
> 赞同：1
> 
> 时间：2012-12-26T03:32:51.673
> 
> 标签：node.js, sockets, amazon-ec2, socket.io, port

我将 Amazon EC2 服务用于 Web 目的。我有一个托管在 apache 即端口 80 上的 Web 应用程序。现在我在端口 3000 上运行一个节点实例，当我加载我的网站时。

```
 io.connect('http:IP ADDRESS:3000'); 
```

此代码尝试连接到我的端口。在服务器端，我的实例已启动。但是当我加载我的应用程序时，它没有连接到服务器。

我想知道我需要更新我的配置还是需要做任何网络设置？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-26T03:45:03.003

尝试将您的端口添加到您定义的安全组中。

关注[http://docs.amazonwebservices.com/AWSEC2/latest/UserGuide/using-network-security.html#concepts-security](http://docs.amazonwebservices.com/AWSEC2/latest/UserGuide/using-network-security.html#concepts-security)以获取更多参考。

# google-play - Google Play 是否有一些 API 可用于获取应用程序的一些信息？

> ID：14035712
> 
> 赞同：0
> 
> 时间：2012-12-26T03:33:54.640
> 
> 标签：google-play

iTunes 提供了一个 API ，其中包含一些有用的信息，`http://itunes.apple.com/lookup?id=337254112`比如...... Google Play 是否有一些这样的 API？`genre``primaryGenre`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-26T03:46:13.987

您可以查看以下链接：

商业：[https ://droidmeter.com](https://droidmeter.com)

开源：[https ://github.com/chadrem/market_bot](https://github.com/chadrem/market_bot)

[http://code.google.com/p/android-market-api/](http://code.google.com/p/android-market-api/)

[http://github.com/kanzure/android-market-api-py](http://github.com/kanzure/android-market-api-py)

# java - 使用 jython 从 python 访问 java 类

> ID：14035714
> 
> 赞同：3
> 
> 时间：2012-12-26T03:34:15.160
> 
> 标签：java, python, jython

我在 java 中编写了一个类，我想使用 jython 在 python 中执行它。首先是我得到的错误？

```
Traceback (most recent call last):
  File "/Users/wolverine/Desktop/project/jython_scripts/customer.py", line 3, in <module>
    customer = Customer(1234,"wolf")
TypeError: No visible constructors for class (Customer) 
```

我的 Java 类格式：

```
public class Customer {
    public final int customerId;
    public final String name;
    public double balance;

    /*
     *  Constructor
     */
    Customer(int _customerId, String _name){
        customerId = _customerId;
        name = _name;
        balance = 0;
    } 
```

我的 python 2 行脚本

```
import Customer

customer = Customer(1234,"wolf")
print customer.getName() 
```

目录结构就像

```
 folder/customer.py    folder/Customer.java folder/Customer.jar 
```

我去了文件夹并做了

```
 %javac -classpath Customer.jar *.java 
```

然后我的 jython 在 Users/wolverine/jython/jython

要执行我这样做

```
 %/Users/wolverin/jython/jython ~/Desktop/folder/customer.py 
```

错误再次是：

```
 Traceback (most recent call last):
  File "/Users/wolverine/Desktop/project/jython_scripts/customer.py", line 3, in <module>
    customer = Customer(1234,"wolf")
TypeError: No visible constructors for class (Customer) 
```

免责声明。我刚开始使用java :(

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-26T03:55:21.460

Customer 类不在您的包中，并且您的构造函数不是公共的。这就是为什么您会收到您看到的错误 - 您的 python 代码看不到构造函数（有效地位于另一个包中）

更改您的构造函数行

```
Customer(int _customerId, String _name){ 
```

到

```
public Customer(int _customerId, String _name){ 
```

它应该可以正常工作。此外，您可能会发现[这个问题](https://stackoverflow.com/questions/215497/in-java-whats-the-difference-between-public-default-protected-and-private)有助于理解 public/protected/private/default 的工作方式。

# c++ - 将参数传递给线程函数（模板化）

> ID：14035723
> 
> 赞同：4
> 
> 时间：2012-12-26T03:35:18.267
> 
> 标签：c++, multithreading, c++11

这个问题可能与[为什么将对象引用参数传递给线程函数无法编译有关？](https://stackoverflow.com/questions/8299545/passing-arguments-to-thread-function).

我遇到了类似的问题，但是，就我而言，仿函数是一个模板。

```
class A {
public:
  // Non template version works as expected!!.
  // void operator()(std::ostream& out){
  //    out << "hi\n";
  // }

  // template version doesn't. 
    template <class Ostream>
    void operator()(Ostream& out){
        out << "hi\n";
    }

};

int main() {
   A a;
   thread t(a, ref(cout));
   t.join();
} 
```

海湾合作委员会 说：

```
error: no match for 'operator<<' in 'out << "hi\012"' 
```

我怎么解决这个问题？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-26T03:39:15.657

你正在传递一个[`std::reference_wrapper`](http://en.cppreference.com/w/cpp/utility/functional/reference_wrapper). 因此，`class Ostream`将`std::reference_wrapper`解释错误的类型。

```
template <class OstreamRef>
void operator()(OstreamRef& outRef){
    outRef.get()<< "hi\n";
} 
```

这应该解决它。

对于非模板情况，当它需要转换为 时`std::ostream&`，`get()`会隐式调用 。但是，使用模板不需要转换为任何其他类型，因此按`std::reference_wrapper`原样传递，因此需要显式调用`get()`. 谢谢@jogojapan

# php - PDO Ajax 更新 mysql 数据库

> ID：14035724
> 
> 赞同：1
> 
> 时间：2012-12-26T03:35:30.383
> 
> 标签：php, ajax, pdo

我需要在这个 PHP Ajax 使用 PDO 更新 mysql 数据库方面的帮助。如果用户选中复选框，我想更新数据库。下面是我的代码：

JS：

```
$('input[name=product_new]').click(function(){

    var chkbox_id = $(this).attr('alt');
    var chkbox_selected = $(this).is(':checked');

    if(chkbox_selected == true)
    {
        chkbox_selected = "checked";
    }
    else
    {
        chkbox_selected = "uncheck";
    }

    $.post({
            url: "../products_listing.php",
            type: "POST",
            data: {product_id: chkbox_id, product_new: chkbox_selected},
            cache: false,
            success: function(){}

           });

}); 
```

使用 PDO 更新数据库的 PHP 页面：

```
$id = $_POST['product_id'];
$product_new = $_POST['product_new'];
if(isset($_POST['product_new']))
{
    try
    {
        $query = "UPDATE productinfo SET new_arrival=? WHERE id=?";
        $stmt_new_chkbox = $conn->prepare($query);
        $stmt_new_chkbox->bindParam(1, $product_new, PDO::PARAM_STR);
        $stmt_new_chkbox->bindParam(2, $id, PDO::PARAM_INT);
        $stmt_new_chkbox->execute();
    }
    catch(PDOException $e)
    {
        echo 'ERROR: ' . $e->getMessage();
    }
} 
```

当我使用 mysql 时它可以工作，但现在我已经将它更改为使用 PDO，它不再工作了。我找不到哪里出错了。提前谢谢各位。

下面是来自 mysql_ 的旧代码：

```
$id = mysql_real_escape_string($_POST['product_id']);
$product_new = mysql_real_escape_string($_POST['product_new']);
if(isset($_POST['product_new']))
{
    $upt_new=mysql_query("update products_list set new_arrival='$product_new' where id='$id'");
} 
```

* * *

好的！我已经知道出了什么问题。该死的目录路径。我拿出 ../ 它有效！不过有点奇怪。

因为我的 js 文件在 JS 文件夹中，而 products_listing.php 在 js 文件夹之外。它不应该是../products_listing.php 吗？

谁能告诉我为什么它不能正常工作？

提前谢谢各位！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-26T05:44:04.717

只需将您的任务分成两部分：AJAX 部分和 PDO 部分。

首先确保您的 PDO 部件运行良好。制作一个模拟 $_POST 数组，然后开始使用 PDO 直接调用此脚本，无需 AJAX。如果出现问题，请在此处提问。然后，当你让它工作时，以同样的方式移动到 AJAX 部分——首先，没有 PDO，只需将数据发送到服务器并验证它是否正确。

一次解决两个问题会使事情变得更加困难。始终将您的任务分成不同的部分并一一解决。

# google-maps - google maps api：如何禁用商业位置？

> ID：14035725
> 
> 赞同：8
> 
> 时间：2012-12-26T03:35:46.537
> 
> 标签：google-maps, google-maps-api-3

我已经使用 APIv3 创建了一个自定义地图，并且我已经定位了我的标记（酒店和餐馆地址）

但在地图中，默认情况下还有一些酒店、餐馆和任何类型的商业地点的标签。其中一些正在与我的客户竞争......

有没有办法将它们从地图中删除，只在地图视图中留下非商业名称？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-12-26T03:46:57.960

您可以通过 styledmaptype 禁用这些广告。

> 如果您希望您的 Maps API 应用程序不包含这些图标，您可以在下周发布之前将它们移除，方法是在您的地图的 poi.business 的标签元素上设置 visibility:off。

请参阅：http: [//googlegeodevelopers.blogspot.com/2011/08/business-icons-and-styling-across.html](http://googlegeodevelopers.blogspot.com/2011/08/business-icons-and-styling-across.html)

但请记住，当您为 poi.business 指定“visibility:off”时，这些标签也会被隐藏。

否则，如果您与 Google Maps API for Business 许可签约，您可以禁用这些广告。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-04-13T16:57:05.870

如果只是为了截图：

如果您在左侧有菜单，您可以尝试禁用“标签”。

您还可以右键单击大多数元素（不是企业）并检查，然后上下滚动直到看到“场景”并将 z-index 设置为 9999，它将隐藏所有导航按钮。这将使地图覆盖除底部的“google”徽标之外的所有内容。

我不介意将版权信息留在那里，但还没有弄清楚。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2019-04-18T23:53:01.683

是的，您需要切换 poi.business 标签的可见性，如下所示：

```
{
  featureType: 'poi.business',
  elementType: 'labels',
  stylers: [
    { visibility: 'off' }
  ]
} 
```

# c++ - C++ OpenMP for-loop 全局变量问题

> ID：14035729
> 
> 赞同：1
> 
> 时间：2012-12-26T03:36:28.607
> 
> 标签：c++, multithreading, for-loop, openmp

我是 OpenMP 的新手，根据我所阅读的有关 OpenMP 2.0（Microsoft Visual Studio 2010 的标准配置）的信息，全局变量在并行编程中使用时被认为很麻烦且容易出错。我也一直在接受这种感觉，因为我几乎没有发现如何有效地处理全局变量和静态全局变量，或者根本就没有发现。

我有这段代码可以运行，但由于在并行块中创建了局部变量，我没有得到我正在寻找的答案。我得到 8 种不同的打印输出（因为我的 PC 上有多少线程）而不是 1 个答案。我知道这是因为在并行块中创建了局部变量“list”，但是如果我移动“list”变量并使其成为全局变量，这段代码将不会运行。实际上代码确实运行但它从来没有给我一个答案。这是我想修改以使用全局“列表”变量的示例代码：

```
#pragma omp parallel
{
    vector<int> list;
#pragma  omp for
    for(int i = 0; i < 50000; i++) 
    {
        list.push_back(i);
    }
    cout << list.size() << endl;
} 
```

输出：

```
6250
6250
6250
6250
6250
6250
6250
6250 
```

它们加起来是 50000，但我没有得到 50000 的唯一答案，而是被分割了。

解决方案：

```
 vector<int> list;
    #pragma omp parallel
{
    #pragma  omp for
    for(int i = 0; i < 50000; i++) 
    {
        cout << i << endl;
    #pragma omp critical
        {
            list.push_back(i);
        }
    }
}
cout << list.size() << endl; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-26T04:03:49.487

根据[MSDN 文档](http://msdn.microsoft.com/en-us/library/68ah4xc7.aspx)并行子句

> 定义一个并行区域，这是将由多个线程并行执行的代码。

由于列表变量是在本节中声明的，因此每个线程都有自己的列表。

另一方面，[for pragma](http://msdn.microsoft.com/en-us/library/6z19s8e0.aspx)

> 导致在并行区域内的 for 循环中完成的工作在线程之间进行划分。

因此 50000 次迭代将在线程之间拆分，但每个线程都有自己的列表。我认为你想要做的可以通过以下方式实现：

1.  将列表定义置于“并行”部分之外。
2.  用[临界区](http://msdn.microsoft.com/en-us/library/b38674ky.aspx)保护 list.push_back 语句。

试试这个：

```
vector<int> list;
#pragma omp parallel
{
#pragma  omp for
    for(int i = 0; i < 50000; i++) 
    {
#pragma omp critical
        {
            list.push_back(i);
        }
    }
}
cout << list.size() << endl; 
```

在这种情况下，我认为您不应该从 OpenMP 获得任何加速，因为会出现对关键部分的争用。一个更快的解决方案（如果你不关心元素的顺序）是每个线程都有自己的列表，并在循环完成后合并这些列表。在这种情况下，使用 std::list 而不是 std::vector 的实现看起来会更干净（因为您不必复制数组）。

一些应用程序受内存限制而不是计算限制。底线：检查您是否真的从 OpenMP 获得了加速。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-26T03:57:27.177

为什么在这里需要第一个 pragma？（#pragma omp 并行）。我认为这就是问题所在。

# hadoop - 在 Hadoop 中读取的 BZip2 文件

> ID：14035736
> 
> 赞同：2
> 
> 时间：2012-12-26T03:37:47.003
> 
> 标签：hadoop, gzip, mapper, bzip2

我听说我们可以使用多个映射器在 Hadoop 中并行读取一个 bzip2 文件的不同部分，以提高性能。但我搜索后找不到相关样本。感谢是否有人能指出我相关的代码片段。谢谢。

顺便说一句：gzip 是否具有相同的功能（多个映射器并行处理一个 gzip 文件的不同部分）。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-26T12:15:13.770

如果您查看：[http](http://comments.gmane.org/gmane.comp.jakarta.lucene.hadoop.user/30662) ://comments.gmane.org/gmane.comp.jakarta.lucene.hadoop.user/30662 ，您会发现 bzip2 格式确实是可拆分的，并且多个映射器可以在一个文件上工作。补丁提交于：[https](https://issues.apache.org/jira/browse/HADOOP-4012) ://issues.apache.org/jira/browse/HADOOP-4012 。但是，它似乎仅在 HADOOP 0.21.0 以上可用。

从个人经验来看，为了使用这种 bzip2 技术，您无需做任何不同的事情。hadoop 应该根据您的最小拆分大小自动选择它。

bzip2 按块压缩数据，因此可以按块解压缩并将每个块发送到单独的映射器。但是，gzip 没有这种技术，因此不能将其发送到不同的映射器。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-26T07:07:24.300

您可以查看[pbzip2](http://compression.ca/pbzip2/)以获取并行 bz2 压缩和解压缩的示例。

还有一个并行的 gzip，[pigz](http://zlib.net/pigz/)。它进行并行压缩，但不进行并行解压缩。deflate 格式不适合并行解压缩。但是，您可以 a) 准备一个带有历史重置的特殊 gzip 流，或者 b) 您可以在第一遍时将索引构建到 gzip 文件中。无论哪种方式，您都可以并行读取不同的部分，或者进行更有效的随机访问。

# postgresql - pgadmin 给我错误：没有提供密码

> ID：14035742
> 
> 赞同：30
> 
> 时间：2012-12-26T03:38:34.997
> 
> 标签：postgresql, web-applications, pgadmin

我已经在 linux (kubuntu) 和 pgadmin3 的最新版本上安装了 postgresql 9.2，但是当我连接它们时，我有这个错误：

发生错误：连接到服务器时出错：fe_sendauth：未提供密码

我能做些什么？

我还在 java 中为我的 Web 应用程序配置了 tomcat。事实上，在尝试我的应用程序之前，postgresql 就已经开始工作了。

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2020-07-02T15:04:30.270

更改角色 postgres 的密码：

```
sudo -u postgres psql postgres

alter user postgres with password 'postgres'; 
```

尝试使用“postgres”连接用户名和密码。

参考：[如何修改PostgreSQL用户密码](https://stackoverflow.com/questions/12720967/is-possible-to-check-or-change-postgresql-user-password)

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2012-12-26T15:13:11.000

是否需要密码取决于您在[**`pg_hba.conf`**](https://www.postgresql.org/docs/current/auth-pg-hba-conf.html). 您可以通过不同的方式进行连接 - pg_hba.conf 中的不同设置可能适用。

我引用了 pgAdmin 3 附带的帮助，用于连接（“服务器”）设置中的“主机”字段：

> 主机是要联系的机器的 IP 地址，或完全限定的域名。在基于 Unix 的系统上，地址字段可以留空以使用本地机器上的默认 PostgreSQL Unix 域套接字，或者设置为包含 PostgreSQL 套接字的备用路径。如果输入路径，则必须以“/”开头。也可以指定端口号。

如果您通过 Unix 套接字连接，则适用“本地”规则。而通过 TCP/IP 连接时，“主机”（或“hostssl”）规则适用。

如果您的 pg_hba.conf 文件顶部有这样的一行：

```
local    all     all     peer 
```

或者：

```
local    all     all     ident 
```

..如果您的系统用户是“postgres”并且您的数据库用户也是“postgres”，那么您可以在本地连接而无需密码。

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2015-09-22T20:36:10.523

我意识到这是多年前的问题，但我今天遇到了同样的问题，并且有一个`trust`以有限但有用的方式使用的解决方案。

与许多开发商店一样，当开发人员需要 QA postgres 密码时，他们只是大喊大叫、发消息、发电子邮件、写在额头上等等。我想，“这真的很糟糕。我需要弄清楚在这里找到一种使用 PKI 的方法。” 我们还使用 pgAdmin3。

首先，在您的 pg_hba.conf 中添加这样的一行，其中`dev`代表您商店中开发人员的用户：

`host all dev 127.0.0.1/32 trust`

将开发人员的公钥放入`authorized_keys`数据库服务器上的文件夹中。`-L`现在使用类似于以下的命令让他们使用带有标志的 ssh 进入服务器：

`ssh -i ~/.ssh/id_rsa -L5432:127.0.0.1:5432 -vvv 101.102.103.104`

这允许人们像使用 localhost 一样使用 postgres 端口。当然，更换密钥，服务器并确保映射到本地开放端口（如果您有本地 postgres 运行，它可能绑定到 5432）。我使用了一个非常详细的标志，因此我可以轻松解决任何 ssh 问题。

打开另一个终端并发出以下命令：

`psql -h 127.0.0.1 -U dev -p 5432`

您应该可以访问数据库并且永​​远不会被提示输入密码，我认为这很好，因为否则，开发人员将放弃密码而几乎不考虑安全性，就像万圣节糖果一样传递出去。

到现在为止，PgAdmin3 仍然会提示您输入密码，即使——就像白天一样——你不需要它。但其他 postgres GUI 不会。试试 Postico。它处于测试阶段，但效果很好。

我希望这个答案可以帮助像我这样宁愿使用 PKI 进行 postgres 身份验证而不是随意共享密码的人。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2019-02-17T08:01:57.997

最近遇到了这个问题。

如果您在本地机器上使用 PostgreSQL，并且 psql 无需记录即可正常工作，请尝试 pgadmin3 的 menu `File - Add Server - Properties tab`，填写`Name`此连接的字段，将`Host`字段和`Password`字段留空，然后单击`ok`。

来自[pgadmin 文档](https://www.pgadmin.org/docs/pgadmin3/1.22/connect.html)

> 在基于 Unix 的系统上，地址字段可以留空以使用本地机器上的默认 PostgreSQL Unix 域套接字，或者设置为包含 PostgreSQL 套接字的备用路径。如果输入路径，则必须以“/”开头。

从事 Debian 测试（pgadmin3 1.22，PostgreSQL 11），没有接触`pg_hba.conf`.

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2021-01-22T05:30:14.277

对我来说，我运行`pg_ctl -D /usr/local/var/postgres start`，启动服务器，然后一切正常，它会弹出连接主机端口。

# ruby-on-rails - 用于在没有事件的情况下管理状态的 Gem

> ID：14035743
> 
> 赞同：0
> 
> 时间：2012-12-26T03:38:37.123
> 
> 标签：ruby-on-rails, ruby, gem

我想在模型中存储一个状态，并且可以从一种状态更改为任何其他状态。状态列表是在模型中预定义的。

状态机对我来说太过分了，因为我不需要状态之间的事件/转换，也不想编写 N 平方转换（以允许任何状态转移到任何其他状态）。

有没有一个好的 Rails gem 可以做到这一点？我想避免自己编写所有常量/访问器/检查有效性。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-26T04:45:55.623

对于这样的功能来说，宝石太多了。

```
class Model < ActiveRecord::Base

  # validation
  validate :state_is_in_list

  # All the possible states
  STATUS = %w{foo bar zoo loo}

  # method to change to a state. !! Not sure if this is the right syntax
  STATUS.each do |state|
    define_method "#{state}!" do
      write_attribute :state, state
    end

    # Also ? methods are handy for conditions
    define_method "#{state}?" do
      state == read_attribute(:state)
    end
  end
  # So you can do model.bar! and it will change state to 'bar'
  # And model.bar? will return true if it is in 'bar' state

  private
  def child_and_team_code_exists
   errors.add(:state, 'Not a valid state') unless STATUS.include? state
  end

end 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-26T09:28:45.520

我发现要搜索的正确关键字应该是[“活动记录枚举”](https://www.ruby-toolbox.com/categories/Active_Record_Enumerations)

我选择第二个叫做[enumerize](https://github.com/brainspec/enumerize)。它提供了很好的 API 和良好的表单输入生成器。它也有一个简单的范围和访问器。

# c - 演员表是否会在整个系统中保持低位字节一致？

> ID：14035751
> 
> 赞同：1
> 
> 时间：2012-12-26T03:40:34.217
> 
> 标签：c, unicode, casting, endianness

假设我有一个 unicode 字符`wchar_t x;`

当然，转换`x`为 ASCII 的明显方法是使用[wctob](http://www.cplusplus.com/reference/cwchar/wctob/)函数

但我想知道，由于[Unicode 的前 255 个字符与 ASCII 相对应](http://en.wikipedia.org/wiki/List_of_Unicode_characters)，那么演员表`char`是否可以跨平台始终如一地工作？

```
char c = (char) x ; // cast to char, this works on Windows 
```

问题是，演员会`char`保证保留低阶位，还是可能保留高阶位？（我担心这里的小端/大端情况，虽然我意识到如果它适用于我的小端系统，它肯定应该适用于大端系统）。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-26T05:40:38.747

*为了简洁起见，我松散地使用了一些术语。为避免混淆，**强烈建议**至少仔细研究以下术语的[定义](http://www.unicode.org/glossary/)：ASCII、Unicode、UCS、UCS-2、UCS-4、UTF、UTF-8、UTF-16、UTF-32、字符、字符集，编码字符集，曲目，代码单元*。

字符“Q”的代码在 ASCII 和 Unicode 中都是 81。

81 只是一个整数，就像任何其他整数一样。变量可以`char`存储数字 81。`wchar_t`变量可以存储相同的数字 81。在这两种情况下，我们都将 81*解释*为“Q”。

`long`询问数字 81 在从 eg转换为时如何保留没有多大意义`short`。如果它适合，那么你就准备好了。没有字节序或更高位或更低位或任何涉及的这些东西。

当您通过网络转换存储字符或字节流的*文件*时，字节顺序和位和东西开始变得重要，就像存储（二进制表示）任何旧数字的文件一样。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-26T13:19:13.847

如果`x`不适合 a `char`，则该行为是正式的“实现定义的”并允许发出信号。如果`x`确实适合 a `char`，则保留该值（无论字节顺序如何）。

> **6.3.1.3 有符号和无符号整数**
> 
> (1) 当一个整数类型的值转换为除 以外的其他整数类型`_Bool`时，如果该值可以用新的类型表示，则保持不变。
> 
> (2) [此处不适用]
> 
> (3) 否则，新类型是有符号的，值不能在其中表示；结果是实现定义的，或者引发了实现定义的信号。

为了获得最大的可移植性，首先执行范围检查，并且仅当值在范围内时才强制`SCHAR_MIN`转换为`SCHAR_MAX`.

（其他人已经注意到，我想重复一下，ASCII 仅扩展到字符 127。）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-26T05:20:52.580

我的印象是，在这种情况下，系统的字节序无关紧要。

我在这里找到了一个很好的[解释](http://www.codeproject.com/Articles/14225/Endian-ness-problems)。我认为这应该有助于消除你对选角的恐惧。

# objective-c - 运行同一个 XPC 服务的多个实例 (NSXPCConnection)

> ID：14035754
> 
> 赞同：15
> 
> 时间：2012-12-26T03:41:47.373
> 
> 标签：objective-c, cocoa, xpc, nsxpcconnection

是否可以使用 Foundation.framework (`NSXPCConnection`等) 中的 XPC API 运行同一 XPC 服务的多个实例？[文档](http://developer.apple.com/library/mac/#documentation/MacOSX/Conceptual/BPSystemStartup/Chapters/CreatingXPCServices.html)没有提供关于这个问题的太多见解。

**编辑**：做了一个快速测试，似乎只有一个服务实例在运行，即使我创建了两个 XPC 连接。有*没有*办法让它运行另一个实例？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2014-04-14T13:28:17.017

`xpcservice.plist` [有点晚了，但手册页](https://developer.apple.com/library/mac/documentation/Darwin/Reference/Manpages/man5/xpcservice.plist.5.html)中提供了这个问题的明确答案：

> 服务类型（默认：应用程序）
> 
> XPC 服务的类型指定服务的实例化方式。这些值为：
> 
> • 应用程序：每个应用程序都将具有该服务的唯一实例。
> 
> • 用户：为每个用户创建一个服务流程实例。
> 
> • 系统：整个系统有一个服务进程实例。系统 XPC 服务仅限于驻留在系统框架中，并且必须由 root 拥有。

底线：在大多数情况下，XPC 服务只有一个实例，并且只有在不同的应用程序可以连接到同一个服务的情况下（甚至在服务与应用程序捆绑时也不可能），才会有多个实例（一个-每个应用程序的实例）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-26T07:32:05.857

我相信 XPC 服务是为每个多个连接的一个实例设计的。也许，使用一个正在运行的可执行文件来管理命名管道会更方便。因此，最有可能同时创建多个实例是不可能的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-05-06T19:43:11.160

由于 XPC 服务应该没有状态，所以一个或多个实例是否正在运行并不重要：

> XPC 服务由 launchd 管理，它按需启动它们，如果它们崩溃则重新启动它们，并`SIGKILL`在它们空闲时终止它们（通过发送 ）。这对使用该服务的应用程序是透明的，除非服务在处理需要响应的消息时崩溃。在这种情况下，应用程序可以看到它的 XPC 连接已经失效，直到服务被 launchd 重新启动。因为 XPC 服务可以随时突然终止，所以它必须设计为保持最小状态——理想情况下，您的服务应该是完全无状态的，尽管这并不总是可能的。

–– <a href="https://developer.apple.com/library/mac/documentation/MacOSX/Conceptual/BPSystemStartup/Chapters/CreatingXPCServices.html" rel="nofollow">创建 XPC 服务

将所有必要的状态信息放入 xpc 调用并将其返回给客户端（如果必须保持）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-03-28T10:17:32.033

[https://developer.apple.com/library/mac/documentation/Darwin/Reference/ManPages/man5/xpcservice.plist.5.html](https://developer.apple.com/library/mac/documentation/Darwin/Reference/ManPages/man5/xpcservice.plist.5.html)

XPCService 字典中的 ServiceType 键：Application 或 User 或 System

但是这个“ServiceType”是无关紧要的……如果服务嵌入在一个应用程序包中，那么它只会对包含的应用程序可见，并且根据定义，它将是应用程序类型的服务。从应用程序到服务的后续连接请求将导致与现有服务的新连接。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2016-02-26T08:11:38.367

我知道我迟到了，但是虽然你不能用普通的 XPC 做到这一点，但有一个库（OpenEmu 的一个组件）应该能够满足你的要求：[OpenEmuXPCCommunicator](https://github.com/OpenEmu/OpenEmuXPCCommunicator)

# c++ - #define 或 char* 字符串驻留在内存中的什么位置？

> ID：14035759
> 
> 赞同：4
> 
> 时间：2012-12-26T03:42:15.313
> 
> 标签：c++, string

> **可能重复：**
> [C++ 中的字符串文字是在静态内存中创建的吗？](https://stackoverflow.com/questions/349025/is-a-string-literal-in-c-created-in-static-memory)

如果我这样做：
`const char* StringPtr = "string0"`，
那么它肯定在内存中的某个地方，我可以得到`StringPtr`.

但如果我这样做：
`#define STRING0 "string0"`，那么`STRING0`居住在哪里？
或者，`STRING0`由于编译器替换使用`STRING0`by而不存在于内存中`"string0"`？

据我所知，每当您在代码中编写任何字符串时，编译器都必须将其放在内存中的某个位置，但我不知道它的确切行为。
但我对此不太确定。

谁能解释编译器如何操作`#define`-ed 或声明为的字符串？`char*`

还有，哪个更好？到`#define`，`extern const char*`或`extern const std::string`在字符串的**头文件中？**

谢谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-26T03:51:30.537

在几乎所有情况下，编译器都可以将字符串文字放在任何它想要的地方。每次文字出现在源代码中时，可能会有一个副本，或者在实例之间共享一个主副本。

这有时会在 C 中引起麻烦，`const`这并不意味着相同的事情，并且您可以修改内存。在一个平台上，所有相同的字符串都会被更改，而在另一个平台上，更改不会传播。从 C++11 开始，字符串文字不会隐式丢失`const`，而且更难犯错误。

字符串将在程序启动之前全部初始化，因此实际上它们是可执行二进制映像的一部分。这是肯定的。

有什么不同的是：

```
const char StringPtr[] = "string0", 
```

这定义了一个具有唯一地址的专用数组对象。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-26T03:45:02.507

```
#define STRING0 
```

`STRING0`不驻留在内存中。它甚至在编译期间都不存在。在预编译中，所有出现的都被[预处理器](http://en.wikipedia.org/wiki/C_preprocessor)`STRING0`替换为“string0” 。在此阶段之后，以下阶段或已编译的应用程序都不知道名称的任何符号的存在`STRING0`

一旦发生这种情况，并非所有实例中的许多实例最终都会成为`const char*`整个代码中的唯一字符串文字（您的情况）。@Potatoswatter 和@silico 提供的[链接](https://stackoverflow.com/questions/349025/is-a-string-literal-in-c-created-in-static-memory)更好地回答了这些存储在内存中的位置

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-26T03:51:33.580

stringPtr 位于可执行文件的数据部分。如果您在文本编辑器中打开您的 exe，您将能够搜索它。 [数据段](http://en.wikipedia.org/wiki/Data_segment)

宏仅在构建程序的预处理阶段存在。

根据你的编译器，如果你使用宏方法，你可以在你的 exe 中得到几个相同字符串的单独实例，但如果你使用 char* 方法，你可以只使用一个实例。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-26T03:53:16.967

`#define`是一个预处理器宏。它将在编译代码之前的预编译阶段`STRING0`替换为。`"string0"`

`"string0"`驻留在可执行文件的静态只读内存中。

`StringPtr`是一个变量，这就是为什么你可以获取它的地址。它只是指向的内存地址`"string0"`。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2012-12-26T03:45:52.810

当您执行 时`#define`，没有编译器，而是*预处理器**在将预处理源文件中的*文本替换`STRING0`为“string0” ，然后将其传递给适当的编译器。

 *编译器*永远不会*看到 STRING0，而只会在您编写 STRING0 的任何地方看到“string0”。

编辑：

替换您在源文件中编写的 STRING0 的每个“string0”实例本身就是一个字符串文字。如果这些字符串文字被保证（或声明）为不变，那么编译器可能会通过存储此“string0”的单个副本并将其他用途指向该副本来优化内存分配（我在编辑中改写了这一段）。

（编辑：那些相同的文字字符串常量可能会合并到一个单独的副本中，但这取决于编译器。标准不要求或强制执行它：[http ://www.velocityreviews.com/forums/t946521-merging- of-string-literals-guaranteed-by-c-std.html](http://www.velocityreviews.com/forums/t946521-merging-of-string-literals-guaranteed-by-c-std.html) )

至于你的最后一个问题：最便携的是将它们声明为：`const char *`

稍后编辑：到目前为止我发现的关于字符串文字的最佳讨论在这里：[https ://stackoverflow.com/a/2245983/1284631](https://stackoverflow.com/a/2245983/1284631)

此外，请注意字符串文字也可能出现在静态分配的 char 数组的初始化中，当它不能与它的其他副本合并时，因为静态数组的内容可能会被覆盖。请参见下面的示例，其中两个相同的字符串文字“hello”无法合并：

```
#include <stdio.h>
#include <string.h>

int main(){

        char x[50]="hello";

        printf("x=%s, &x[0]=%p\n",x,&x[0]);

        const char *y="hello";

        printf("y=%s, &y[0]=%p\n",y,&y[0]);

        strcpy(&x[0],"zz");

        printf("x=%s, &x[0]=%p\n",x,&x[0]);

        return 0;
} 
```

这段代码的输出是：

```
x=hello, &x[0]=0x7fff8a964370
y=hello, &y[0]=0x400714
x=zz, &x[0]=0x7fff8a964370 
```*

# php - 动态生成压缩包并通过 PHP 发送？

> ID：14035761
> 
> 赞同：0
> 
> 时间：2012-12-26T03:42:27.217
> 
> 标签：php, download, directory, stdout, tar

我有一个我制作的目录列表脚本，我想知道我需要进入哪个方向才能为要下载为 tarball 的特定目录选择一个选项。cronjob 是不可接受的，因为我希望这是按需的，因此 CPU 周期不会浪费在不需要的内容上，但我也希望缓存已请求的内容。排除缓存的理想解决方案是将 tar 命令输出到标准输出，但我如何通过 PHP 发送它而无需等待命令完成？这方面的一些指导会有所帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-26T03:54:20.110

要在不等待的情况下发送它，您可以在使用“ob_implicit_flush()”时执行 gz 命令，不确定该命令是否会在仍在运行时读取，但您可以在后台运行它并在输出到文件或其他内容时从中读取。您还可以检查目录/文件上的日期，然后运行 ​​gzip 脚本

# regex - 正则表达式，在两个单词之间选择单词

> ID：14035766
> 
> 赞同：10
> 
> 时间：2012-12-26T03:43:06.493
> 
> 标签：regex

我对正则表达式很陌生，我需要一些帮助。我试图弄清楚自己，但没有运气！

我正在尝试在 2 个字符串之间选择文本（最后一个字符串的字符）

IE：

```
word word2 : 
```

我正在尝试在单词和之间选择“word2”：

谢谢！

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-12-26T03:50:20.117

另一种选择是使用这种模式

```
(?<=word\s).*(?=\s:) 
```

参见[Lookahead 和 Lookbehind 零宽度断言](http://www.regular-expressions.info/lookaround.html)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-26T03:48:16.673

`/word (.*?) \:/`这应该可以解决问题

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-26T03:57:34.697

如果您获得第一组，这应该有效：

```
\w+\s*(.+)\s*:
```

# c - 在 printf 语句中连接字符串

> ID：14035769
> 
> 赞同：2
> 
> 时间：2012-12-26T03:43:23.653
> 
> 标签：c, printf

```
gcc 4.7.2
c89 
```

你好，

```
#define LOG_ERR(fmt, ...)                                               \
    fprintf(stderr, "[ERROR] %s:%d: error [%s] " fmt "\n", __func__, __LINE__, strerror(errno), ##__VA_ARGS__) 
```

我正在这样使用它：

```
LOG_ERR("Failed to connect to message queue [ %d ]", msg_id); 
```

fmt 已在 fprintf 语句中连接。这怎么可能？

我尝试对以下内容进行相同的操作以测试该概念，但因编译错误而失败：

```
/* Using char array */
const char name[] = "Joe";

printf("Hello how " name " how are you today?\n");

Using constant string literal
const char *name = "Joe";

printf("Hello how " name " how are you today?\n"); 
```

两者都给我以下错误：

```
expected ')' before name 
```

非常感谢您的任何建议，

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-26T03:52:39.343

您需要一个格式说明符，请查看[printf 的文档](http://www.cplusplus.com/reference/cstdio/printf/)

```
const char *name = "Joe"; // or your char array, either's fine

printf("Hello how %s how are you today?\n", name); 
```

您的尝试：

```
printf("Hello how " name " how are you today?\n"); 
```

看起来有点 C++ish

```
cout << "Hello how " << name << "are you today?\n"; 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-12-26T04:35:02.517

不同之处在于宏在文本上`fmt`用您的字符串替换单词。将两个或多个文字字符串放在一起可以获得这些字符串的连接。

```
"Hello " "World" "!!"
/* is the same as */
"Hello World!!" 
```

请记住，只有**文字**字符串才能做到这一点。这**不适**用于变量。

将宏想象为代码中的查找/替换。为了说明，请考虑您的宏定义 -

```
#define LOG_ERR(fmt, ...)  \
    fprintf(stderr, "[ERROR] %s:%d: error [%s] " fmt "\n",
            __func__, __LINE__, strerror(errno), ##__VA_ARGS__) 
```

当你像这样使用它时 -

```
LOG_ERR("Failed to connect to message queue [ %d ]", msg_id); 
```

它进行文本替换并变为 -

```
fprintf(stderr, "[ERROR] %s:%d: error [%s] " "Failed to connect to message queue [ %d ]" "\n",
            __func__, __LINE__, strerror(errno), msg_id) 
```

并排的字符串并连接起来，瞧 -

```
fprintf(stderr, "[ERROR] %s:%d: error [%s] Failed to connect to message queue [ %d ]\n",
            __func__, __LINE__, strerror(errno), msg_id) 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-12-26T03:53:11.000

当它失败时，那是因为你正在使用变量。编译器可以连接字符串文字，即如果您写“abc”“123”，那么编译器会将其视为“abc123”。当您在宏中执行此操作时，预处理器意味着这正是发送给编译器的内容

```
LOG_ERR("Failed to connect to message queue [ %d ]", msg_id); 
```

变成

```
fprintf(stderr, "[ERROR] %s:%d: error [%s] " "Failed to connect to message queue [ %d ]" "\n", myfunction, 123, strerror(errno), msg_id); 
```

可能也值得检查字符串化器和连接宏（对于预处理器 -`#`而且`##`我不记得哪个是哪个......）

安德鲁

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-12-26T04:23:50.880

如果您想为`fprintf()`您定义一个宏，可以这样做，这是最简单的恕我直言。

```
#define LOG_ERR(...)   fprintf(stderr, __VA_ARGS__) 
```

并像使用它一样

```
int main()
{

    int  myVar =100;

    LOG_ERR ("The value of myVar is %d", myVar); 

    return 0; 
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2018-04-20T07:38:34.857

```
#include <stdio.h>
#include <sys/time.h>
#include <string>

#define MyPrint(...) {\
struct timeval tv;\
gettimeofday(&tv,0);\
printf("%d.%d:", (unsigned int)tv.tv_sec, (unsigned int)tv.tv_usec);\
printf(__VA_ARGS__);} 
```

# apache - Apache 文件不存在 - 错误

> ID：14035770
> 
> 赞同：0
> 
> 时间：2012-12-26T03:43:24.637
> 
> 标签：apache, .htaccess, lamp

我的 Apache 日志经常包含诸如“文件不存在”之类的消息。我有一个名为 404.shtml 的页面，当我尝试接收无效页面时，会显示 404.shtml 的内容。但与此同时，无效的页面 url 也会写入日志中。

有可能避免在 Apache 日志中出现此类错误，因为有时日志中充斥着此类条目

# c++ - 是否有一个特殊的文件可以在其中存储额外的参数？(Mac OS X)

> ID：14035771
> 
> 赞同：0
> 
> 时间：2012-12-26T03:43:40.510
> 
> 标签：c++, clang, macports

我最近卸载了 macports 以用自制软件替换它。但是，从那时起，当我编译一些 C++ 代码时，我收到了一个奇怪的警告

```
ld: warning: directory not found for option '-L/opt/local/lib' 
```

那就是macport的旧目录路径已经被删除了。但是，从未指定过该选项。我打电话给以下几行

```
clang++ -c -W -std=c++11 -stdlib=libc++ src/main.cpp -o obj/main.o
clang++ -stdlib=libc++ obj/main.o -o bin/myprog-debug 
```

我检查了变量`LD_LIBRARY_PATH`，但它是空的。那么，该库路径从何而来？

# excel - 如何将 Excel 范围分配给二维数组？

> ID：14035772
> 
> 赞同：4
> 
> 时间：2012-12-26T03:43:44.387
> 
> 标签：excel, vbscript, vba

您能否说一下 - 如何将 Excel Range("G2:AA1000") 分配给 2D 数组？如果可能，如何在对该二维数组执行某些操作后将该二维数组返回到相同的范围？在将范围分配给二维数组后，如何从该二维矩阵中识别每一行？

谢谢，

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-27T20:13:31.953

有一种简单的方法可以使用数组对区域进行更改，并将其写入同一个地方或其他地方。

此示例代码将使用数组将数据从一个区域复制到另一个区域：

```
Sub example()
Dim testdata()
testdata = Range("A1:B13")
Range("D1:E13") = testdata ' simple copy
Range("G1") = testdata ' copy only 1 cell
Range("I1:K22") = testdata 'try to copy too much
End Sub 
```

该`testdata`数组从**1**开始，并将扩展到该范围中指定的列数和行数。在这种情况下，`testdata(1,1)`指的是从**A1**中得到的数据，`testdata(1,2)`指的是**B1**，最后是`testdata(13,1)`指**A13**，`testdata(13,2)`指的是**B13**。

将范围设置为等于下一行中的数组将数组复制到指定位置。

*   如果该区域小于原始数组，它将仅复制足够的数组以填充该空间，因此`Range("D1")=testdata`只会在工作表上放置一个单元格。
*   如果指定更大的区域，则**#N/A**将填充不在数组元素覆盖的空间中的区域，因此`Range("A1:A3")=testdata`将使用数组中的数据填充 A1 和 A2，但 A3 将具有**#N/A**

示例程序结果：
注：A1:B13 为原始数据，后续复制`range(??)=testdata` ![上述代码的结果](../Images/3c5525d527a02fd692cbaca8081a6b55.png)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-26T05:21:13.757

这是一个从工作表中读取一系列数据，对数组进行操作，然后将其写回同一个工作表的示例。

```
 Sub RangeArray()

    Dim Rng As Range
    Dim Arr()
    Dim ArrItem
    Dim i As Long, j As Long
    Dim rUB as Long, cUB as Long

     Set Rng = Worksheets("Sheet1").Range("A1:G19")
    rUB = Rng.Rows.Count    'Row upper bound
    cUB = Rng.Columns.Count  ' Column upper bound

    ReDim Arr(1 To rUB, 1 To cUB)

   'Read worksheet range into array
    For i = 1 To rUB
       For j = 1 to cUB
          Arr(i, j) = Rng.Cells(i, j).Value
       Next
    Next

   'Do something to array 
    For i = 1 To rUB
       For j = 1 To cUB
          If i <> j Then
             Arr(i, j) = Arr(i, j) / (i * j)
          End If
       Next
    Next

   'Write array back to worksheet
    Set Rng = Worksheets("Sheet1").Range("I1")
    For i = 1 To rUB
       For j = 1 To cUB
          Rng.Offset(i - 1, j - 1).Value = Arr(i, j)
       Next
    Next

    End Sub 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2021-02-08T19:45:13.640

是的，可以在一次分配中将 Excel 范围*分配*给二维数组。在 C++/CLI 中，它看起来像这样：

cli::array<Object^, 2>^ arrData = safe_cast<cli::array<Object^, 2>^>(rg->Value[Excel::XlRangeValueDataType::xlRangeValueDefault]); 在 c# 或 Visual Basic 中，它看起来要简单得多（例如参见[https://www.automateexcel.com/vba/assign-range-to-array/](https://www.automateexcel.com/vba/assign-range-to-array/)，顺便说一句，在 dotnet 中，对象现在扮演了变体数据的角色类型）。请注意，它必须是二维数组，并且返回的数组具有从一开始的索引，而不是从零开始的索引。

对于大型数据集，此方法比循环快得多。循环生成大量 COM 对象。我将这两种方法与 33000 行 Excel 范围进行了比较，数据导入数组几乎是瞬时的，而循环需要很长时间并且会加热 CPU。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-26T03:48:14.923

循环范围的一种方法是使用带有 Cells 属性的 For...Next 循环。使用 Cells 属性，您可以将循环计数器（或其他变量或表达式）替换为单元格索引号。在下面的示例中，变量 counter 被替换为行索引。该过程循环通过范围 C1:C20，将绝对值小于 0.01 的任何数字设置为 0（零）。

```
Sub RoundToZero1()
    For Counter = 1 To 20
        Set curCell = Worksheets("Sheet1").Cells(Counter, 3)
        If Abs(curCell.Value) < 0.01 Then curCell.Value = 0
    Next Counter
End Sub 
```

# python - Python 模块安装，为特定模块设置“环境”

> ID：14035775
> 
> 赞同：0
> 
> 时间：2012-12-26T03:44:51.343
> 
> 标签：python, graph, path, plot, installation

尝试安装一个名为 Dislin 的 Python 模块。不幸的是，我没有成功设置 Dislin 的环境，我会收到安装错误。设置路径的说明如下，但它们对我来说有点模糊。任何人都可以让它更明确一点吗？（我在学）。

```
d) Choose a directory in the file structure where DISLIN should be
   installed and define the environment variable DISLIN with it:

   For example:   export DISLIN/$HOME/dislin 
```

[ftp://ftp.gwdg.de/pub/grafik/dislin/darwin/README.DARWIN](ftp://ftp.gwdg.de/pub/grafik/dislin/darwin/README.DARWIN)

我的 python 2.7 站点包在这里：/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/site-packages。我假设我需要在这里将 Dislin 指向家，但到目前为止还没有成功，因为我可能做错了，但我收到如下错误：export: `DISLIN/Library/Frameworks/Python.framework/Versions/2.7 /lib/python2.7/site-packages/dislin'：不是有效的标识符

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-26T03:49:10.703

如果你已经安装了 dislin，你需要做的是确保无论你安装了*dislin*数据（不是 Python），都在你的系统环境变量[`PYTHONPATH`](http://docs.python.org/2/using/cmdline.html#envvar-PYTHONPATH)中。这在您发布的 ftp 链接中的**#5**中指出。

如果可以在您的计算机上在您上面发布的路径上找到 dislin，您会做的是将以下内容添加到您的 PYTHONPATH：

```
DISLIN/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/site-packages/dislin 
```

# iphone - Xcode 4.5 与 iOs 6 在 iOs 4.3 中的问题

> ID：14035783
> 
> 赞同：0
> 
> 时间：2012-12-26T03:46:36.140
> 
> 标签：iphone, ios4, ios6, xcode4.5

我正在使用 XCode 4.2 开发 iPhone/iPad 应用程序。通过最近的更新，我使用 iOs6 将我的 XCode 升级到了 4.5。我用这个开发了一个 iPhone 应用程序。但是当我在 iPhone 3GS 上运行带有 iOs 4.3 的应用程序时出现问题，它有时会崩溃。我找不到导致此崩溃的任何具体或常见原因。它是随机发生的，而不是在执行特定操作时发生。但它在带有 iOs 5 和 iOs 6 的 iPhone 中很少发生。我尝试使用 Instruments 跟踪问题，但仍然找不到任何原因。存在一些内存泄漏，但这不是问题。

所以，我有一些猜测，可能是由于设备是 3GS 而发生的？或者因为，iOs 6 附带的某些代码在 iPhone 3GS 或 iOs 4.3 中不支持。在 Xcode 中它没有显示任何警告。

所以，我不确定，我的猜测是否有任何可能性？

另外，我想知道，现在我们有iOs 6，那么当我们开发新应用程序时，我们是否仍然支持iOs < 5？或者我们可以指定它需要 iOs 5 或更高版本作为要求吗？

请给我一些建议。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-26T03:56:18.533

关于您的第一个问题 - “应用程序随机崩溃”。您提到您的应用程序在所有 iOS 版本上崩溃 - 很少在 5 和 6 上但经常在 4.3 上。如果是这样的话，那么根据我的经验，这个问题主要与“内存不足”有关。要验证这一点，请在设备上调试您的应用程序并检查您的调试器是否显示“内存不足警告”。这是您找到问题的方式。

现在关于您的第二个问题 - “支持哪个 iOS”。对此的答案是**iOS 5.0 及更高版本 - 是**。并非所有 iPhone/iPad 用户都将他们的设备更新到 iOS 6。还有一些用户因为设备问题而无法更新。因此，您至少必须提供对 iOS 5.0 的支持。根据最新统计，iOS 设备用户几乎不使用 iOS 4.x，但 iOS 5.x 用户已经足够了。App Store 中的很多应用程序不提供对 iOS 5.0 以下的支持。因此，请使用 iOS 5.0 及更高版本。休息这取决于您的要求，例如如果应用程序足够简单，那么提供对 iOS 5.0 以下的支持并不令人头疼。

# php - Ajax XML - 使用 html 标签返回

> ID：14035788
> 
> 赞同：0
> 
> 时间：2012-12-26T03:47:48.777
> 
> 标签：php, javascript, xml, ajax

嗨，我有这段代码，这是带有 ajax 的 xml，我希望从 res 获得的返回值不包含 html 标记，因为它总是返回这个值。例如我应该返回一个值 1 而不是 ajax 返回这个值

```
<html>
</html>
1 
```

这是我的 xml 代码

```
function sendEscalationEmail()
{
    var xmlHttp = GetXmlHttpObject();
    if (xmlHttp==null) { alert ("The system cannot process your request.\nPlease use browser that supports AJAX!"); return; }

var params1 = $('#formTrans').serialize();
var params2 = $('#formClient').serialize();

xmlHttp.onreadystatechange = function generateOutput()
{
    if (xmlHttp.readyState==4 && xmlHttp.status==200)
    {
        var res = xmlHttp.responseText;

        if (res.indexOf('1')<-1) alert('Transaction is saved but there has been an error sending the details to your supervisor\'s email.\nKindly contact the system administrator.');
        else
        {
            alert('Transaction submitted and sent to your supervisor\'s email.');
            document.getElementById('emailpreview').innerHTML = '';
            $("#emailpreview").dialog("close");
        }
    }
};
xmlHttp.open('GET', 'send.esemail.php?'+params1+'&'+params2, true);
xmlHttp.send('');
} 
```

这是 send.esemail.php 的代码

```
$arrTo[] = "xx@xx.com";

$mail = new htmlMimeMail();
$mail->setTextCharset('utf-8');
$mail->setHtmlCharset('utf-8');
$mail->setHeadCharset('utf-8');
$mail->setSMTPParams($SMTPServer, $SMTPPort);
$mail->setHtml($strHTML);
$mail->setFrom("xxxxx");
$mail->setSubject($strSubject);
$mail->setReturnPath('xx@xx,net');
$mail->setBcc("xx@eg.net");
$result = $mail->send($arrTo);

echo $result; 
```

我如何从返回值中删除标签，这样我就可以摆脱使用 indexOf 来找到正确的响应。$result 应该只输出`1`，但它有`<html></html> 1`.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-26T07:52:07.627

在 send.esemail.php 中写入 echo strip_tags($result); 应该只返回 1。

# ruby-on-rails - 为什么我不能从手机上传图片文件，但从电脑上传？

> ID：14035797
> 
> 赞同：0
> 
> 时间：2012-12-26T03:49:22.527
> 
> 标签：ruby-on-rails, ruby-on-rails-3

我已经使用名为“回形针”的 gem 实现了将图像上传到我的应用程序的功能。

当我从 PC 上传图像文件时它工作正常，但如果我从 Android 的默认浏览器上传它不会保存图像。
它显示闪存消息“它已保存！” 但事实并非如此。

但如果采取这部分，它保存罚款。这太奇怪了。

**模型/comment.rb**

```
validates_attachment_content_type :comment_icon, :content_type => ['image/jpeg', 'image/png','image/gif'] 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-26T03:56:31.453

大多数移动浏览器不支持从其存储中上传图像。您的代码运行良好，这是浏览器支持的问题。

# java - 如何使用弹簧缓存抽象返回条目数

> ID：14035799
> 
> 赞同：9
> 
> 时间：2012-12-26T03:49:50.383
> 
> 标签：java, spring, caching

我正在使用 spring 缓存抽象来缓存服务层中的对象。这适用于简单的 get/put 操作，如下所示：

```
static private final String cacheName = "messages";

@CacheEvict(value=cacheName, key="#message.id")
public void deleteMessage(Message message) {
...
}

@Cacheable(value=cacheName, key="#id")
public Message findMessage(Long id) {
...
}

@CachePut(value=cacheName, key="#message.id")
public void saveMessage(Message message) {
...
}

@CachePut(value=cacheName, key="#message.id")
public Message updateMessage(Message message) {
...
} 
```

但是，我将为以下方法使用什么注释：

```
public long countAllMessages() {
...
} 
```

由于所有对象都将在缓存中，因此应该有一种方法可以从缓存中获取答案，而不必去存储库层。

此外，缓存正在应用于以下方法：

```
@Cacheable(cacheName)
public List<Message> findAllMessages() {
...
} 
```

我可以让 count 方法调用 find all 方法，如下所示：

```
public long countAllMessages() {
    return findAllMessages().size();
} 
```

但这在禁用缓存的情况下效率不高，因为调用会从数据库加载所有记录，而不是执行 SELECT COUNT(*)...

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-12-26T06:20:25.530

# android - 运行服务的 Android 网络应用程序

> ID：14035800
> 
> 赞同：0
> 
> 时间：2012-12-26T03:49:52.680
> 
> 标签：android, sockets, networking, service, adb

我创建了一个运行后台服务的 android 应用程序，该服务执行以下操作：

1) 要求 UDP 服务器向其发送 100 个数据包

2) 在 while(true) 循环中接收数据包

3) 使用 setSoTimeout 使接收在 5 分钟后超时并退出循环

上述操作每 2 分钟重复一次。当手机连接到 PC 并使用 adb logcat 监控每一步时，该应用程序运行良好，但当手机与 PC 断开连接时，该应用程序停止工作。然后在文件中记录每个步骤表明最后一步是接收步骤，之后套接字不会超时。可能的原因是什么？有没有其他方法可以让我以恒定的时间间隔完成预期的任务？这是从服务启动的线程的运行函数：

```
 public void downlink() 
{
    String path = extStorageDirectory + "/" + appFolder + "/REP_DT_" + Long.toString(System.currentTimeMillis()) + ".txt";
    File file = new File(path);
    if(!file.exists())
    try 
    {
        file.createNewFile();
    }
    catch (IOException e) 
    {
        // TODO Auto-generated catch block
        e.printStackTrace();
    }
    String p = extStorageDirectory + "/Goonj/logtput.txt";
    try {
        DatagramSocket clientSocket = new DatagramSocket();
        try {
            FileWriter fw = new FileWriter(path,true);
            fw.write("\n\n");
            fw.close();             
            clientSocket.setSoTimeout(120000);
            InetAddress IPAddress = InetAddress.getByName(IP);
            long id = System.currentTimeMillis();      
            byte[] sendData = createMessage(id,0,1400,150);     
            DatagramPacket sendPacket = new DatagramPacket(sendData, sendData.length, IPAddress, 9010);
            clientSocket.send(sendPacket);      
            byte[] receiveData = new byte[10240];
            boolean flag = true;
            while(flag)//for(int i=0; i<100; i++)
            {      
                DatagramPacket receivePacket = new DatagramPacket(receiveData, receiveData.length); 
                writeToLog(p,"START");
                clientSocket.receive(receivePacket);
                writeToLog(p,"END");
                long time = System.currentTimeMillis();
                String data = new String(receivePacket.getData(), 0, receivePacket.getLength());
                System.out.println(data);
                fw = new FileWriter(path,true);
                fw.write(Long.toString(getSeqno(data)) + " " + Long.toString(time) + "\n");
                fw.close();
            }                               
        }
        catch(SocketTimeoutException e)
        {
            writeToLog(p,"SOCKET EXCEPTION HAS BEEN CAUGHT!!!" + Long.toString(System.currentTimeMillis()));
            e.printStackTrace();
        }
        catch(IOException e)
        {
            writeToLog(p,"IO EXCEPTION HAS BEEN CAUGHT!!!" + Long.toString(System.currentTimeMillis()));
            e.printStackTrace();
        }
        clientSocket.close();
    }
    catch(SocketException e){}
    //fw.close();
} 
```

# android - 删除后Android刷新Listview

> ID：14035805
> 
> 赞同：2
> 
> 时间：2012-12-26T03:50:47.143
> 
> 标签：android

我正在尝试在项目删除后刷新我的列表视图。但这似乎不起作用。我是不是错过了什么。我用 listAdapter.notifyDataSetChanged(); 也不工作。有人可以帮助我吗？谢谢

```
@Override
    public void onActivityCreated(Bundle savedInstanceState) {
        super.onActivityCreated(savedInstanceState);
        getActivity().setContentView(R.layout.dl_listview);

        View empty = getActivity().findViewById(R.id.empty);
        DLListView = (ListView) getActivity().findViewById(R.id.DLListView);
        DLListView.setEmptyView(empty);

        if (!Environment.getExternalStorageState().equals(
                Environment.MEDIA_MOUNTED)) {
            Toast.makeText(getActivity(),
                    "Error! No SDCARD Found!",
                    Toast.LENGTH_LONG).show();
        } else {
            File directory = new File(Environment.getExternalStorageDirectory()
                    + File.separator + "St");
            directory.mkdirs();
        }
        DLListView = (ListView) getActivity().findViewById(R.id.DLListView);

        myList = new ArrayList<String>();

        File sdCard = Environment.getExternalStorageDirectory();
        file = new File(sdCard.getAbsolutePath() + "/St/");

        File list[] = file.listFiles();

        for (int i = 0; i < list.length; i++) {
            String fileName = list[i].getName();
            fileName = fileName.replace(".txt", "");
            myList.add(fileName);

        }

        listAdapter = new ArrayAdapter<String>(getActivity(),
                R.layout.simplerow, myList);

        DLListView.setAdapter(listAdapter);

        DLListView.setOnItemClickListener(new OnItemClickListener() {
            @Override
            public void onItemClick(AdapterView<?> parent, View view,
                    int position, long id) {
                // TODO Auto-generated method stub
                String textToPass = myList.get(position);
                Intent i = new Intent(getActivity(), ViewActivity.class);
                textToPass = textToPass.replace(textToPass + "", textToPass
                        + ".txt");
                i.putExtra("textToPass", textToPass);
                startActivity(i);
            }
        });

        DLListView.setOnItemLongClickListener(new OnItemLongClickListener() {

            @Override
            public boolean onItemLongClick(AdapterView<?> parent, View view,
                    int position, long id) {
                // TODO Auto-generated method stub
                registerForContextMenu(DLListView);
                return false;
            }
        });

    }

    public void onCreateContextMenu(ContextMenu menu, View v,
            ContextMenuInfo menuInfo) {
        super.onCreateContextMenu(menu, v, menuInfo);
        AdapterContextMenuInfo info = (AdapterContextMenuInfo) menuInfo;
        String name = ((TextView) info.targetView).getText().toString();
        menu.setHeaderTitle(name);
        menu.add(0, v.getId(), 0, "Delete");
    }

    @Override
    public boolean onContextItemSelected(MenuItem item) {

            deletefunc(item.getItemId());

        return true;
    }

    public void deletefunc(int id) {

        String filenamec = fileName1;
        filenamec = filenamec.replace(filenamec + "", filenamec + ".txt");
        File folder = Environment.getExternalStorageDirectory();
        String fileName = folder.getPath() + "/St/" + filenamec;

        File myFile = new File(fileName);
        if (myFile.exists())
            myFile.delete();
        Toast.makeText(getActivity(), fileName1+" Deleted", Toast.LENGTH_SHORT)
        .show();
        listAdapter.remove(listAdapter.getItem(id));
    } 
```

日志猫：

```
12-26 11:57:27.334: E/AndroidRuntime(5576): FATAL EXCEPTION: main
12-26 11:57:27.334: E/AndroidRuntime(5576): java.lang.IndexOutOfBoundsException: Invalid index 2131034154, size is 1
12-26 11:57:27.334: E/AndroidRuntime(5576):     at java.util.ArrayList.throwIndexOutOfBoundsException(ArrayList.java:251)
12-26 11:57:27.334: E/AndroidRuntime(5576):     at java.util.ArrayList.get(ArrayList.java:304)
12-26 11:57:27.334: E/AndroidRuntime(5576):     at android.widget.ArrayAdapter.getItem(ArrayAdapter.java:337)
12-26 11:57:27.334: E/AndroidRuntime(5576):     at free.st.app.MyDownloads.deletefunc(MyDownloads.java:137)
12-26 11:57:27.334: E/AndroidRuntime(5576):     at free.st.app.MyDownloads.onContextItemSelected(MyDownloads.java:118)
12-26 11:57:27.334: E/AndroidRuntime(5576):     at android.support.v4.app.FragmentManagerImpl.dispatchContextItemSelected(FragmentManager.java:1933)
12-26 11:57:27.334: E/AndroidRuntime(5576):     at android.support.v4.app.FragmentActivity.onMenuItemSelected(FragmentActivity.java:360)
12-26 11:57:27.334: E/AndroidRuntime(5576):     at com.actionbarsherlock.app.SherlockFragmentActivity.onMenuItemSelected(SherlockFragmentActivity.java:200)
12-26 11:57:27.334: E/AndroidRuntime(5576):     at com.android.internal.policy.impl.PhoneWindow$DialogMenuCallback.onMenuItemSelected(PhoneWindow.java:3691)
12-26 11:57:27.334: E/AndroidRuntime(5576):     at com.android.internal.view.menu.MenuBuilder.dispatchMenuItemSelected(MenuBuilder.java:735)
12-26 11:57:27.334: E/AndroidRuntime(5576):     at com.android.internal.view.menu.MenuItemImpl.invoke(MenuItemImpl.java:149)
12-26 11:57:27.334: E/AndroidRuntime(5576):     at com.android.internal.view.menu.MenuBuilder.performItemAction(MenuBuilder.java:874)
12-26 11:57:27.334: E/AndroidRuntime(5576):     at com.android.internal.view.menu.MenuDialogHelper.onClick(MenuDialogHelper.java:167)
12-26 11:57:27.334: E/AndroidRuntime(5576):     at com.android.internal.app.AlertController$AlertParams$3.onItemClick(AlertController.java:929)
12-26 11:57:27.334: E/AndroidRuntime(5576):     at android.widget.AdapterView.performItemClick(AdapterView.java:292)
12-26 11:57:27.334: E/AndroidRuntime(5576):     at android.widget.AbsListView.performItemClick(AbsListView.java:1185)
12-26 11:57:27.334: E/AndroidRuntime(5576):     at android.widget.AbsListView$PerformClick.run(AbsListView.java:2713)
12-26 11:57:27.334: E/AndroidRuntime(5576):     at android.widget.AbsListView$1.run(AbsListView.java:3468)
12-26 11:57:27.334: E/AndroidRuntime(5576):     at android.os.Handler.handleCallback(Handler.java:605)
12-26 11:57:27.334: E/AndroidRuntime(5576):     at android.os.Handler.dispatchMessage(Handler.java:92)
12-26 11:57:27.334: E/AndroidRuntime(5576):     at android.os.Looper.loop(Looper.java:137)
12-26 11:57:27.334: E/AndroidRuntime(5576):     at android.app.ActivityThread.main(ActivityThread.java:4512)
12-26 11:57:27.334: E/AndroidRuntime(5576):     at java.lang.reflect.Method.invokeNative(Native Method)
12-26 11:57:27.334: E/AndroidRuntime(5576):     at java.lang.reflect.Method.invoke(Method.java:511)
12-26 11:57:27.334: E/AndroidRuntime(5576):     at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:982)
12-26 11:57:27.334: E/AndroidRuntime(5576):     at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:749)
12-26 11:57:27.334: E/AndroidRuntime(5576):     at dalvik.system.NativeStart.main(Native Method) 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-26T03:54:20.020

```
listAdapter.notifyDataSetChanged(); 
```

没有做任何事情是因为您没有对适配器做任何事情。您尚未从 listAdapter 中删除任何内容，因此无需更改任何内容。更改`onContextMenuItemSelected()`为这样（使其纯粹与列表位置一起使用。MenuItem ids 不是列表中的位置）：

```
@Override
    public boolean onContextItemSelected(MenuItem item) {
    AdapterView.AdapterContextMenuInfo info = (AdapterView.AdapterContextMenuInfo)item.getMenuInfo();
    int position = info.position;
    deletefunc(position);
    return true;
    } 
```

然后考虑在`listAdapter.remove(listAdapter.getItem(id))`某处做`deletefunc()`。`notifyDataSetChanged();`无论如何，这应该会自动调用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-26T03:54:32.810

您似乎实际上并没有从适配器列表中删除该元素。你可以打电话`listAdapter.remove(myFile)`，它会删除元素，并`notifyDataSetChanged()`为你打电话。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-26T04:45:55.887

真的没有理由不在这里使用[Loaders](http://developer.android.com/guide/components/loaders.html)。您也不[应该在 UI 线程上访问文件系统](http://developer.android.com/training/articles/perf-anr.html#anr)。更好的实现是使用[AsyncTaskLoader](http://developer.android.com/reference/android/content/AsyncTaskLoader.html)并将您的文件访问权限移动到`loadInBackground()`. [您也可以通过扩展ListActivity](http://developer.android.com/reference/android/app/ListActivity.html)而不是 Activity 来稍微清理一下。

# c++ - 从杜高斯贝刻度二进制文件中读取数据

> ID：14035808
> 
> 赞同：6
> 
> 时间：2012-12-26T03:51:22.877
> 
> 标签：c++

我已经下载了 Dukascopy 刻度数据，并使用 easylzma 库对其进行了解压缩。原始压缩二进制文件为 EURUSD/2010/00/08/12h_ticks.bi5 (EURUSD/2010/ian/8/12h) 解压后得到如下格式：

```
+-------------------------+--------+-------+
|           time          |  Bid   |   Ask |
+-------------------------+--------+-------+
000003CA 00022EC0 00022EB6 40CCCCCD 41180000
000004F5 00022EB6 00022EB1 4099999A 404CCCCD 
```

[（您可以从： EURUSD/2010/00/08/ **12h_ticks.bi5**](https://docs.google.com/open?id=0B0PJ51qZTKX2QXJhdGRKNE9uRWs)下载原始压缩文件 。用lzma解压后得到文件： [**12h_ticks**](https://docs.google.com/open?id=0B0PJ51qZTKX2eDd0MmM5R2NyR00)）

读取二进制文件：

```
int ii1;
int ii2;
int ii3;
float ff1;
float ff2;
ifstream in("12h_ticks",ofstream::binary);
in.read((char*)(&ii1), sizeof(int));
in.read((char*)(&ii2), sizeof(int));
in.read((char*)(&ii3), sizeof(int));
in.read((char*)(&ff1), sizeof(float));
in.read((char*)(&ff2), sizeof(float));
std::cout << " ii1=" << ii1 << std::endl;
std::cout << " ii2=" << ii2 << std::endl;
std::cout << " ii3=" << ii3 << std::endl;
std::cout << " ff1=" << ff1 << std::endl;
std::cout << " ff2=" << ff2 << std::endl;
in.close(); 
```

我得到以下结果：

```
ii1=-905773056
ii2=-1070726656
ii3=-1238498816
ff1=-4.29492e+08
ff2=8.70066e-42 
```

怎么了？我无法从二进制文件中读取数据。请帮我。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-12-26T04:18:07.410

数据似乎以大端格式存储在文件中。加载时需要将其转换为小端。

```
#include <iostream>
#include <fstream>
#include <algorithm>

template<typename T>
void ByteSwap(T* p)
{
    for (int i = 0;  i < sizeof(T)/2;  ++i)
        std::swap( ((char *)p)[i], ((char *)p)[sizeof(T)-1-i] );
}

int main()
{
    int ii1;
    int ii2;
    int ii3;
    float ff1;
    float ff2;
    std::ifstream in("12h_ticks",std::ofstream::binary);
    in.read((char*)(&ii1), sizeof(int));
    in.read((char*)(&ii2), sizeof(int));
    in.read((char*)(&ii3), sizeof(int));
    in.read((char*)(&ff1), sizeof(float));
    in.read((char*)(&ff2), sizeof(float));

    ByteSwap(&ii1);
    ByteSwap(&ii2);
    ByteSwap(&ii3);
    ByteSwap(&ff1);
    ByteSwap(&ff2);

    std::cout << " ii1=" << ii1 << std::endl;
    std::cout << " ii2=" << ii2 << std::endl;
    std::cout << " ii3=" << ii3 << std::endl;
    std::cout << " ff1=" << ff1 << std::endl;
    std::cout << " ff2=" << ff2 << std::endl;
    in.close();
    return 0;
} 
```

这给出了结果：

```
ii1=970
ii2=143040
ii3=143030
ff1=6.4
ff2=9.5 
```

如果您想了解有关该主题的更多信息，我从这里获取了 ByteSwap 函数。 [如何在 C++ 中的大端和小端值之间进行转换？](https://stackoverflow.com/questions/105252/how-do-i-convert-between-big-endian-and-little-endian-values-in-c)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-03-14T15:17:08.213

ii1 是这一小时内的秒数

ii2 是询价 * 10000

ii3 是出价 * 10000

ff1 是卖出量

ff2 是投标量

# entity-framework - 如何对主键使用代码优先迁移？

> ID：14035813
> 
> 赞同：0
> 
> 时间：2012-12-26T03:51:45.770
> 
> 标签：entity-framework, entity-framework-5, entity-framework-migrations

在 biginning 中，我这样定义模型：

```
public class Category
{
  public long CategoryId { get; set;}
  public string CategoryName { get; set; } 
  public virtual ICollection<ContentInfo> Contents { get; set; }
}

Public class Article
{
  public int ContentId { get; set; }
  public string Content { get; set; }
  [ForeignKey("Category")]
  public long CategoryId { get; set; }
  public virtual Category Category { get; set; }
} 
```

使用 Automatic-Migration 从模型生成数据库后，我将 CategoryId 的类型从“long”更改为“int”，并再次使用 Automatic-Migration 更新数据库。

这次抛出异常，告诉我“CategoryId”列被Primary key和Foreign Key引用，所以迁移失败。如果我手动删除主键和外键，一切正常。但我希望自动迁移为我做这件事，可以吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-22T15:17:47.933

您可以使用“服务器探索”并手动操作表结构，例如删除键约束或删除整个表。并让 EF 生成全新的表定义。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-26T04:04:26.667

Havent自己尝试过这样的迁移，但我记得看到一个选项

公共类 MYMigrationConfiguration : DbMigrationsConfiguration {

```
 public MyMigrationConfiguration()
    {
        AutomaticMigrationsEnabled = true;
        AutomaticMigrationDataLossAllowed = true; //have you tried this ?

    } 
```

否则，您可能需要针对此类更改进行基于代码的迁移

# matlab - 如何将频域转换为时域

> ID：14035814
> 
> 赞同：1
> 
> 时间：2012-12-26T03:52:12.897
> 
> 标签：matlab, time, fft, ifft, time-frequency

我创建了一个 3 个三个不同频率的信号并过滤掉我不想要的信号。但是当我在matlab中使用ifft时，它显示了一个错误的图。如何将我的频域频谱转换回我的3秒时域图？下面我的代码如下：

```
clc
clear all
Fs = 8192;
T = 1/Fs;                                             
%create tones with different frequency
t=0:T:1;
t2=1:T:2;
t3=2:T:3;

y1 = sin(2*pi*220*t); 
y2 = sin(2*pi*300*t2);
y3 = sin(2*pi*440*t3);                          

at=y1+y2+y3;

figure;
plot(t,y1,t2,y2,t3,y3),title('Tones with noise');

[b,a]=butter(2,[2*290/Fs,2*350/Fs],'stop');
e=filter(b,a,at);
et=(ifft(abs(e)));
figure,
plot(et) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-26T04:01:47.647

就像现在一样，`et`是在频域中，因为 fft。你不需要fft。只是`plot(e)`，你会得到时域滤波波形。哟可以在频率检查过滤器性能。不过，fft 的域，只是

```
plot(abs(fftshift(fft(fftshift(e)))));
xlim([4000 5000]) 
```

**编辑：**

您在问题上编写的代码具有以下错误：其中 `at`包含 1 秒的信息（或 8192 个元素）。如果您`plot(at)`会看到频率的总和，但它们都`happen`在同一时间。这是修复它的方法：

```
clear all
Fs = 8192; % or multiply by 3 if needed
T = 1/Fs;                                             
%create tones with different frequency
t=0:T:3;

y1 = sin(2*pi*220*t).*(t<1); 
y2 = sin(2*pi*300*t).*(t<2 & t>=1);
y3 = sin(2*pi*440*t).*(t>=2);                          

at=y1+y2+y3;

[b,a]=butter(2,[2*290/Fs,2*350/Fs],'stop');
e=filter(b,a,at);
figure,
plot(t,e) 
```

![在此处输入图像描述](../Images/053bd7f3e86b6812261ecc1951d79fd8.png)

```
dt=t(2)-t(1);
N=length(at);
df=1/(N*dt);        % the frequency resolution (df=1/max_T)
if mod(N,2)==0
    f_vector= df*((1:N)-1-N/2);     % frequency vector for EVEN length vectors: f =[-f_max,-f_max+df,...,0,...,f_max-df]
else
    f_vector= df*((1:N)-0.5-N/2);   % frequency vector for ODD length vectors f =[-f_max,-f_max+fw,...,0,...,f_max]
end
freq_vec=f_vector;
fft_vec=fftshift(fft(e));

plot(freq_vec,abs(fft_vec))
xlim([0 1000]) 
```

![在此处输入图像描述](../Images/a595ce1d2c3717cea632fc43f6712351.png)

# wordpress - 重写规则以删除分页前缀

> ID：14035815
> 
> 赞同：0
> 
> 时间：2012-12-26T03:52:26.700
> 
> 标签：wordpress, .htaccess, pagination, nextgen-gallery

什么将是重写规则..或任何其他改变 Nextgen Gallery 分页名称的技巧？即 [http://www.Example.com/wallpapers/category/gallery-name/?nggpage=2](http://www.Example.com/wallpapers/category/gallery-name/?nggpage=2)

至

[http://www.Example.com/wallpapers/category/gallery-name/?page=2](http://www.Example.com/wallpapers/category/gallery-name/?page=2)

类别和画廊名称总是根据画廊而变化。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-26T04:40:03.997

你可以试试这个：

```
Options +FollowSymLinks -MultiViews
RewriteEngine On
RewriteBase /
RewriteCond %{QUERY_STRING} nggpage=([0-9]+) [NC]
RewriteRule ^(.*)$  $1?page=%1?      [L,R=301,NC] 
```

它重定向这个：

`http://www.Example.com/wallpapers/category/gallery-name/?nggpage=2`

对此：

`http://www.Example.com/wallpapers/category/gallery-name/?page=2`

哪里`2`可以是任何值。

# javascript - geoxml3 和地标不起作用

> ID：14035816
> 
> 赞同：1
> 
> 时间：2012-12-26T03:52:31.873
> 
> 标签：javascript, google-maps, kml

好吧，我已经通读并试图找出解决方案但失败了......

我按照 geoxmlv3 的说明进行操作：[http ://code.google.com/p/geoxml3/wiki/Usage](http://code.google.com/p/geoxml3/wiki/Usage)

这是该文件的引述：

```
 <script type="text/javascript">
    var myParser = new geoXML3.parser({afterParse: useTheData});
    myParser.parse('my_geodata.kml');

    function useTheData(doc) {
      // Geodata handling goes here, using JSON properties of the doc object
      for (var i = 0; i < doc.placemarks.length; i++) {
        doSomething;
      }
    };
  </script> 
```

根据文档， doc.placemarks 应该可以正常工作并在 KML 文件中返回一个地标 json 数组，不幸的是，这个“doc”甚至不存在（未定义），知道吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-26T12:49:52.953

如果您使用的是 poly 分支，“doc”是一个数组。

```
function useTheData(doc) {
  // Geodata handling goes here, using JSON properties of the doc object
  for (var i = 0; i < doc[0].placemarks.length; i++) {
    doSomething;
  }
}; 
```

我将修复文档中的示例。

[工作示例](http://www.geocodezip.com/geoxml3_test/v3_geoxml3_simpleExample.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-26T04:03:35.980

为什么不使用 Google Maps API v3 的 KmlLayer？将 KML 文件中的信息映射到地图上很容易。

[https://developers.google.com/maps/documentation/javascript/layers#KMLLayers](https://developers.google.com/maps/documentation/javascript/layers#KMLLayers)

# indexing - 使用 ix() 方法对带有负索引的 pandas DataFrame 进行切片

> ID：14035817
> 
> 赞同：5
> 
> 时间：2012-12-26T03:52:31.940
> 
> 标签：indexing, dataframe, pandas, slice

使用负索引时，DataFrame.ix() 似乎没有对我想要的 DataFrame 进行切片。

我有一个 DataFrame 对象，想对最后 2 行进行切片。

```
 In [90]: df = pd.DataFrame(np.random.randn(10, 4))

    In [91]: df
    Out[91]: 
            0         1         2         3
    0  1.985922  0.664665 -2.800102  1.695480
    1  0.580509  0.782473  1.032970  1.559917
    2  0.584387  1.798743  0.095950  0.071999
    3  1.956221  0.075530 -0.391008  1.692585
    4 -0.644979 -1.959265  0.749394 -0.437995
    5 -1.204964  0.653912 -1.426602  2.409855
    6  1.178886  2.177259 -0.165106  1.145952
    7  1.410595 -0.761426 -1.280866  0.609122
    8  0.110534 -0.234781 -0.819976  0.252080
    9  1.798894  0.553394 -1.358335  1.278704 
```

一种方法：

```
 In [92]: df[-2:]
    Out[92]: 
              0         1         2         3
    8  0.110534 -0.234781 -0.819976  0.252080
    9  1.798894  0.553394 -1.358335  1.278704 
```

花药的做法：

```
 In [93]: df.ix[len(df)-2:, :]
    Out[93]: 
              0         1         2         3
    8  0.110534 -0.234781 -0.819976  0.252080
    9  1.798894  0.553394 -1.358335  1.278704 
```

现在我想使用负索引，但有问题：

```
 In [94]: df.ix[-2:, :]
    Out[94]: 
              0         1         2         3
    0  1.985922  0.664665 -2.800102  1.695480
    1  0.580509  0.782473  1.032970  1.559917
    2  0.584387  1.798743  0.095950  0.071999
    3  1.956221  0.075530 -0.391008  1.692585
    4 -0.644979 -1.959265  0.749394 -0.437995
    5 -1.204964  0.653912 -1.426602  2.409855
    6  1.178886  2.177259 -0.165106  1.145952
    7  1.410595 -0.761426 -1.280866  0.609122
    8  0.110534 -0.234781 -0.819976  0.252080
    9  1.798894  0.553394 -1.358335  1.278704 
```

如何正确使用带有 DataFrame.ix() 的负索引？谢谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-27T00:12:26.890

这是一个错误：

```
In [1]: df = pd.DataFrame(np.random.randn(10, 4))

In [2]: df
Out[2]: 
          0         1         2         3
0 -3.100926 -0.580586 -1.216032  0.425951
1 -0.264271 -1.091915 -0.602675  0.099971
2 -0.846290  1.363663 -0.382874  0.065783
3 -0.099879 -0.679027 -0.708940  0.138728
4 -0.302597  0.753350 -0.112674 -1.253316
5 -0.213237 -0.467802  0.037350  0.369167
6  0.754915 -0.569134 -0.297824 -0.600527
7  0.644742  0.038862  0.216869  0.294149
8  0.101684  0.784329  0.218221  0.965897
9 -1.482837 -1.325625  1.008795 -0.150439

In [3]: df.ix[-2:]
Out[3]: 
          0         1         2         3
0 -3.100926 -0.580586 -1.216032  0.425951
1 -0.264271 -1.091915 -0.602675  0.099971
2 -0.846290  1.363663 -0.382874  0.065783
3 -0.099879 -0.679027 -0.708940  0.138728
4 -0.302597  0.753350 -0.112674 -1.253316
5 -0.213237 -0.467802  0.037350  0.369167
6  0.754915 -0.569134 -0.297824 -0.600527
7  0.644742  0.038862  0.216869  0.294149
8  0.101684  0.784329  0.218221  0.965897
9 -1.482837 -1.325625  1.008795 -0.150439 
```

[https://github.com/pydata/pandas/issues/2600](https://github.com/pydata/pandas/issues/2600)

请注意，这`df[-2:]`将起作用：

```
In [4]: df[-2:]
Out[4]: 
          0         1         2         3
8  0.101684  0.784329  0.218221  0.965897
9 -1.482837 -1.325625  1.008795 -0.150439 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-26T04:14:32.790

`ix`的主要目的是允许类似 numpy 的索引，并支持行和列标签。所以我不确定你的用例是预期的目的。以下是我能想到的几种方法，主要是微不足道的：

```
In [142]: df.ix[:][-2:]
Out[142]:
          0         1         2         3
8  0.386882 -0.836112 -0.108250 -0.433797
9  0.642468 -0.399255 -0.911456 -0.497720

In [161]: df.ix[df.index[-2:],:]
Out[161]:
          0         1         2         3
8  0.386882 -0.836112 -0.108250 -0.433797
9  0.642468 -0.399255 -0.911456 -0.497720 
```

我认为根本不`ix`支持负索引。它似乎完全忽略了它：

```
In [181]: df.ix[-100:,:]
Out[181]:
          0         1         2         3
0 -1.144137 -1.042034 -2.158838  0.674055
1 -0.424184  1.237318 -1.846130  0.575357
2 -0.844974 -0.541060  2.197364 -0.031898
3  0.846263  1.244450 -1.570566 -0.477919
4 -0.193445  0.171045 -0.235587 -1.185583
5  1.361539 -1.107389 -1.321081 -0.776407
6  0.505907 -1.364414 -2.093770  0.144016
7 -0.888465 -0.329153  0.491264 -0.363472
8  0.386882 -0.836112 -0.108250 -0.433797
9  0.642468 -0.399255 -0.911456 -0.497720 
```

编辑：从我们拥有的[熊猫文档](http://pandas.pydata.org/pandas-docs/stable/indexing.html#indexing-advanced)中：

> 带有整数轴标签的基于标签的索引是一个棘手的话题。它已经在邮件列表和科学 Python 社区的各个成员中进行了大量讨论。在 pandas 中，我们的一般观点是标签比整数位置更重要。因此，对于整数轴索引，使用 .ix 等标准工具只能进行基于标签的索引。以下代码将产生异常：
> 
> ```
> s = Series(range(5))
> s[-1]
> df = DataFrame(np.random.randn(5, 4))
> df
> df.ix[-2:] 
> ```
> 
> 这个深思熟虑的决定是为了防止歧义和微妙的错误（许多用户报告在 API 更改以停止“退回”基于位置的索引时发现错误）。

# jquery - $(window).height() 与 $(document).height

> ID：14035819
> 
> 赞同：63
> 
> 时间：2012-12-26T03:52:43.667
> 
> 标签：jquery

我遇到身高错误的问题

```
$(window).height(); 
```

[并在这里](https://stackoverflow.com/questions/10569301/why-is-window-height-so-wrong)得到了类似的问题

就我而言，当我尝试

```
$(document).height(); 
```

它似乎给我返回了正确的结果

窗口高度返回 320

而文档高度返回 3552！

我也发现[了这个](https://stackoverflow.com/questions/12015201/why-doesnt-window-height-return-a-value-but-document-height-does)问题

但在我的情况下，窗口已经完全加载，因为我在几次 ajax 操作后调用了高度函数

那么知道当前窗口高度的最佳方法是什么？

**编辑：**

![在此处输入图像描述](../Images/c358d2b7c0461ed53dab631eabeb6456.png) ![在此处输入图像描述](../Images/842156712b16e1479844f0fab47c3939.png)

* * *

## 回答 #1

> 赞同：127
> 
> 时间：2012-12-26T05:59:49.163

Well you seem to have mistaken them both for what they do.

`$(window).height()` gets you an unit-less pixel value of the **height of the (browser) window** aka viewport. With respect to the web browsers the viewport here is visible portion of the canvas(which often is smaller than the document being rendered).

`$(document).height()` returns an unit-less pixel value of the **height of the document** being rendered. However, if the actual document’s body height is less than the viewport height then it will return the viewport height instead.

*Hope that clears things a little.*

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2016-10-05T15:28:04.783

这固定了我

```
var width = window.innerWidth;
var height = window.innerHeight; 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-12-26T04:18:10.657

AFAIK`$(window).height();`返回窗口的高度并`$(document).height();`返回文档的高度

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2020-12-28T12:33:02.427

jQuery`$(window).height();`或`$(window).width();`仅当您的 html 页面文档类型为 html 时才能完美运行

```
<!DOCTYPE html>
<html lang="en">
... 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-12-26T05:40:00.140

您需要知道文档和窗口的含义。

1.  window 对象表示浏览器中打开的窗口。[点击这里](http://www.w3schools.com/jsref/obj_window.asp)
2.  Document 对象是文档树的根。[点击这里](http://www.w3schools.com/jsref/dom_obj_core_document.asp)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2015-09-13T16:49:14.657

`$(document).height:`如果您的设备`height`更大。您的页面没有任何滚动；

`$(document).height:`假设你没有滚动并返回这个`height`；

`$(window).height:``height`在您的设备上返回您的页面。

# c - memrcr 给出一些垃圾值

> ID：14035825
> 
> 赞同：0
> 
> 时间：2012-12-26T03:53:40.617
> 
> 标签：c

```
 1 #include<stdio.h>
  2 #include<string.h>
  3 
  4 int main(void)
  5 {
  6         char p[] = "I'm shia";
  7         printf("%p\n",p);
  8         printf("%d\n",memrchr(p+3,'s',strlen(p)));
  9         printf("%p\n",memchr(p,'i',strlen(p)));
 10         return 0;
 11 } 
```

* * *

输出：

```
0x7fff0eeae950
0xeeae954  /*garbage value?*/
0x7fff0eeae956 
```

为什么`memrchr`返回值超出数组的边界`p`，`memchr`工作正常。
如果这种行为是故意的，为什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-26T03:58:14.153

问题不在于`memrchr` *vs* `memchr`。你这样称呼它：

```
memrchr(p+3,'s',strlen(p)); 
```

`'s'`这表示在以字符开头的字符串`p+3`中搜索`strlen(p)`。`memrchr`执行您要求的操作也是如此，它查看*空终止符*和字符串之外的其他两个值。你应该这样称呼它：

```
memrchr(p+3,'s',strlen(p+3)); 
```

甚至：

```
memrchr(p+3,'s',strlen(p)-3); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-26T04:04:03.343

进行了一些更改，但这不是您想在生产中使用的代码。可以看看 memrchr 是如何工作的。

```
#include<stdio.h>
#include<string.h>

 int main(void)
 {
         char p[] = "I'm shia";
         printf("%p\n",p);
         printf("%s\n",(char *)memrchr(p+3,'s',strlen(p) - 3));
         printf("%p\n", memchr(p,'i',strlen(p)));
         return 0;
 } 
```

我的 cygwin 1.7 上的输出：

```
$ ./memrchr
0x28ac57
shia
0x28ac5d 
```

# java - 如何在不解码整个图像的情况下知道 jpeg 格式（android）

> ID：14035828
> 
> 赞同：3
> 
> 时间：2012-12-26T03:54:06.643
> 
> 标签：java, android, jpeg

有什么方法可以在不解码完整图像的情况下在 android 上了解 JPEG 格式？格式是指基线、渐进式等。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-12-26T04:16:36.570

1.  来自文件扩展名，即 *.jpg 或 *.jpeg

2.  [魔术数字](http://en.wikipedia.org/wiki/Magic_number_%28programming%29)。大多数文件格式在文件开头都有一些特殊字节，表示该文件的类型。

3.  其余详细信息交错在[EXIF 数据](http://gvsoft.homedns.org/exif/exif-explanation.html)中，您必须为此阅读文件的一部分。

4.  使用将文件划分为段的[标记](http://en.wikipedia.org/wiki/JPEG#Syntax_and_structure)`0xFF, 0xC0`，指示基线 DCT，`0xFF, 0xC2`指示渐进 DCT。此外，如果文件具有多个扫描标记的开头，`0xFF, 0xDA`则它是渐进式 jpeg。看看你是否在文件中点击了这些字节序列。

# meteor - Meteorjs 限制不起作用

> ID：14035835
> 
> 赞同：1
> 
> 时间：2012-12-26T03:54:59.910
> 
> 标签：meteor

我正在努力找出限制不起作用的原因。相同的代码正在控制台中运行，但是当我在模板中编写时它不起作用。请帮我解决这个问题。

```
var balls = Balls.find({ }, {sort :{ created_at: -1}, limit : 3}).fetch(); 
```

Meteor._atFlush 异常：TypeError：无法调用未定义的方法“containerNode”

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-06T07:38:10.423

这是我的错；`Balls`在订阅收藏之前，我试图加载球。

# insert - 为什么我想在basicblock中插入一些指令那么麻烦？

> ID：14035836
> 
> 赞同：0
> 
> 时间：2012-12-26T03:55:08.270
> 
> 标签：insert, llvm, llvm-ir

当我尝试在基本块中插入一些指令时，我发现它很麻烦。

```
AllocaInst* pa = new AllocaInst(Type::getInt32Ty(getGlobalContext()), 0, 4, "dataKey");
Value* dataValue = ConstantInt::get(IntegerType::get(getGlobalContext(),6) , 100); 
```

以上是我使用的一些代码。到现在我还是不明白在basicblock中插入各种指令的原理。（我只是可以插入一个allocaInst）。我希望有人能告诉我一些在基本块中插入各种指令的例子。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-26T05:49:33.243

首先，插入指令的话题[在 LLVM Programmer's Manual](http://llvm.org/docs/ProgrammersManual.html#creating-and-inserting-new-instructions)中有介绍，推荐看一下。程序员手册对于初学者来说是一个很好的起点。

此外，LLVM 源代码本身也有大量示例。例如：

*   [例子/斐波那契/fibonacci.cpp](http://www.opensource.apple.com/source/lldb/lldb-69/llvm/examples/Fibonacci/fibonacci.cpp?txt)
*   [示例/ModuleMaker/ModuleMaker.cpp](http://www.opensource.apple.com/source/lldb/lldb-69/llvm/examples/ModuleMaker/ModuleMaker.cpp?txt)
*   大多数[通行证](http://llvm.org/docs/doxygen/html/dir_c8acc62e898517adbea11076b88ef3a0.html)

或者，如果您想添加多个新指令，请考虑使用[IRBuilder](http://llvm.org/docs/doxygen/html/classllvm_1_1IRBuilder.html)，这样添加它们会稍微方便一些；[这是一个关于如何使用 IRBuilder 的教程](http://llvm.org/releases/2.6/docs/tutorial/JITTutorial1.html)。

# php - 使用 PHP 进行基于引用的正常注册

> ID：14035842
> 
> 赞同：0
> 
> 时间：2012-12-26T03:56:28.773
> 
> 标签：php, mod-rewrite

我想为基于参考的注册实施解决方案。我希望我的用户通过他们的参考链接邀请他们的朋友，但我也想保持非参考正常注册。

例如，用户正在通过`www.mywebsite.com/user/register`. 我还想让他们通过参考代码（如`www.mywebsite.com/user/register/1`. 我试图实现下面的代码，但是在我尝试之后我的正常注册停止工作。

```
if(isset($_GET["ref"])) {
  $ref = intval($_GET["ref"]);
  // register proccesses
} 
```

我已经尝试过这个规则，但我的非引用部分停止工作。

```
RewriteRule ^user/register/(.*)/?$ user/register.php?ref=$1 [L] 
```

我怎样才能使两者都起作用？

希望你能帮忙。谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-26T04:02:37.710

两个规则接二连三怎么办？

```
RewriteRule ^user/register/(.*)/?$ user/register.php?ref=$1 [L]
RewriteRule ^user/register/?$ user/register.php [L] 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-26T04:10:08.810

请尝试使用此方法。以下是您的参考链接

```
www.mywebsite.com/user/register?ref=125rhu

if(isset($_GET['ref'])){
 $reffernce_user = /*find the reffered user and put there id here*/
}
else{
 $reffernce_user = 0;
} 
```

因此，如果您将此字段添加到您的表格中，您可以通过引用和直接注册用户找到注册用户。这是一个简单的方法

# php - 3次登录失败后如何在几分钟内阻止登录

> ID：14035845
> 
> 赞同：-2
> 
> 时间：2012-12-26T03:57:09.680
> 
> 标签：php, security, login

> **可能重复：**
> [在 PHP 中限制用户登录尝试](https://stackoverflow.com/questions/679756/limiting-user-login-attempts-in-php)

在 3 次登录尝试失败后，我试图在登录中设置一些安全性以阻止用户访问。例如，如果特定用户尝试使用错误的用户名或密码登录 3 次，我应该显示该用户需要在 10 分钟后重试的对话框或消息（例如）

10分钟后，用户可以使用正确的用户名和密码再次登录。

我怎么做？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-26T04:08:46.237

最简单的方法是使用 SESSION 存储失败登录次数，每次用户登录使用错误的用户名或密码时，增加您的计数。它是这样的：

```
if(isset($_SESSION['num_login_fail']))
{
  if($_SESSION['num_login_fail'] == 3)
   {
     if(time() - $_SESSION['last_login_time'] < 10*60*60 ) 
      {
         // alert to user wait for 10 minutes afer
          return; 
      }
      else
      {
        //after 10 minutes
         $_SESSION['num_login_fail'] = 0;
      }
   }      
}

$sucess = doLogin() // your check login function
if($success)
{
   $_SESSION['num_login_fail'] = 0;
   //your code here
}
else
{
 $_SESSION['num_login_fail'] ++;
 $_SESSION['last_login_time'] = time();
} 
```

但是，用户可以通过关闭浏览器来绕过它，然后再次打开，所有用户的会话都将为空。为了更完美，您可以将 num_login_fail 和 last_login_time 存储在数据库中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-26T04:00:26.570

您可以使用`$_SESSION`var 保存尝试次数和尝试的时间。只有当用户仍然有相同的会话（例如，没有关闭浏览器）时，这才有效。如果您希望它持续存在，请使用 cookie。如果您不希望用户能够避免这种情况，请使用 IP 的 db 值，但如果它是 NAT 等，这将是一个问题。`$_SESSION`您可能希望在使用var记录 3 次尝试失败后阻止 IP

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-26T04:12:55.907

在我看来，Cookie 或 Session 也可以解决您的问题，但在我看来，这些方法并不完美，特别是如果您专注于安全。如果用户清除 cookie 会发生什么？

# php - DOMDocument XPath 查询以获取类名和标记值

> ID：14035850
> 
> 赞同：1
> 
> 时间：2012-12-26T03:57:53.160
> 
> 标签：php, xpath, domdocument, xpathquery

我有这个示例代码，它将提取每个标签的值。除此之外，获取该标签的类名..

```
<?php
$doc = new DOMDocument;
$doc->loadxml( <<< eox
<tr class="calendar_row" data-eventid="42023">
    <td class="date"/>
    <td class="time">All Day</td>
    <td class="currency">CAD</td>
    <td class="impact">
        <span title="Non-Economic" class="holiday"/>
    </td>
    <td class="event">
        <span>Bank Holiday</span>
    </td>
    <td class="detail">
        <a class="calendar_detail level1" data-level="1" title="Open Detail"/>
    </td>
    <td class="actual"/>
    <td class="forecast"/>
    <td class="previous"/>
    <td class="graph"/>
</tr>
eox
);
$xpath = new DOMXPath($doc);

foreach( $xpath->query('//tr[@data-eventid="42023"]/td[@class]') as $n ) {
    echo $n->nodeName.'-'.$n->nodeValue."<br />";
}
?> 
```

使用上面的代码段，我想要的只是获取这些值，即使某些标签格式不正确（我正在废弃网络源）。我如何在 DOMDocument XPath 查询中做到这一点。我遇到了麻烦，因为要获取的值是：

```
td-
td-All Day
td-CAD
td- 
td-Bank Holiday 
td- 
td-
td-
td-
td- 
```

代替：

```
date-
time-All Day
currency-CAD
impact- 
event-Bank Holiday 
detail- 
actual-
forecast-
previous-
graph- 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-26T04:06:29.257

而不是这样做，`$n->nodeName`你应该这样做`$n->getAttribute('class')`。

演示：[http ://codepad.viper-7.com/ktpnv2](http://codepad.viper-7.com/ktpnv2)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-26T04:07:18.353

```
echo $n->getAttribute("class") . '-' . $n->nodeValue . "<br />"; 
```

# wordpress - 我应该如何为不同的内容实现不同的页面

> ID：14035854
> 
> 赞同：0
> 
> 时间：2012-12-26T03:58:14.900
> 
> 标签：wordpress

我正在制作我的第一个自定义 WordPress 主题，我遇到了我的第一堵大墙。

我有不同的内容。我有视频、文章和照片。我需要以不同的方式显示这些页面。

我应该只添加一个类别并以不同的方式显示它们吗？我认为这很容易，但我在谷歌搜索这个问题时遇到了麻烦。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-26T04:00:38.497

您可以为每个页面创建自定义模板，然后根据您的要求进行设置。

*   [参考链接](http://codex.wordpress.org/Pages)
*   [示例链接](http://www.expand2web.com/blog/custom-page-template-wordpress/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-26T04:07:58.213

这可能会有所帮助：

[创建_Your_Own_Page_Templates](http://codex.wordpress.org/Pages#Creating_Your_Own_Page_Templates)

[wordpress 客户页面](http://codex.wordpress.org/Pages)

# java - 如何清理 SQLite 并设置默认值？

> ID：14035857
> 
> 赞同：2
> 
> 时间：2012-12-26T03:58:45.150
> 
> 标签：java, android, database, sqlite

这是我被教导构建 SQLite 数据库的方式，但我觉得应该有更简单的方式。我的大多数列总是以相同的默认值开头，所以当我创建表时有没有办法设置默认值。

```
public class SQLiteTable {

public static final String KEY_ROWID = "_id";
public static final String KEY_LEVEL = "level";
public static final String KEY_HEALTH = "health";
public static final String KEY_NAME = "name";
public static final String KEY_CRIT = "crit";
public static final String KEY_CRIT_RANGE = "crit_range";
public static final String KEY_CRIT_INC = "crit_increment";
public static final String KEY_HIT_RANGE = "hit_range";
public static final String KEY_HIT_INC = "hit_increment";
public static final String KEY_CHAR_IMG = "character_image";
public static final String KEY_TOTAL_XP = "total_xp";
public static final String KEY_XP = "xp";
public static final String KEY_XP_NEEDED = "xp_needed";
public static final String KEY_COINS = "coins";
public static final String KEY_SMALL_POTS = "small_pots";
public static final String KEY_LARGE_POTS = "large_pots";

private DbHelper ourHelper;
private final Context ourContext;
private SQLiteDatabase ourDatabase;

private static final String DATABASE_NAME = "Battle For Christams";
private static final String DATABASE_TABLE = "Application Variables";
private static final int DATABASE_VERSION = 1;

private static class DbHelper extends SQLiteOpenHelper{

    public DbHelper(Context context) {
        super(context, DATABASE_NAME, null, DATABASE_VERSION);
        // TODO Auto-generated constructor stub
    }

    @Override
    public void onCreate(SQLiteDatabase db) {
        // TODO Auto-generated method stub
        db.execSQL("CREATE TABLE " + DATABASE_TABLE + " (" +
                KEY_ROWID + " INTEGER PRIMARY KEY AUTOINCREMENT, " + 
                KEY_LEVEL + " TEXT NOT NULL, " + 
                KEY_HEALTH + " TEXT NOT NULL, " +
                KEY_NAME + " TEXT NOT NULL, " +
                KEY_CRIT + " TEXT NOT NULL, " +
                KEY_CRIT_RANGE + " TEXT NOT NULL, " +
                KEY_CRIT_INC + " TEXT NOT NULL, " +
                KEY_HIT_RANGE + " TEXT NOT NULL, " +
                KEY_HIT_INC + " TEXT NOT NULL, " +
                KEY_CHAR_IMG + " TEXT NOT NULL, " +
                KEY_TOTAL_XP + " TEXT NOT NULL, " +
                KEY_XP + " TEXT NOT NULL, " +
                KEY_XP_NEEDED + " TEXT NOT NULL, " +
                KEY_COINS + " TEXT NOT NULL, " + 
                KEY_SMALL_POTS + " TEXT NOT NULL, " +
                KEY_LARGE_POTS + " TEXT NOT NULL)"
            );

    }

    @Override
    public void onUpgrade(SQLiteDatabase db, int oldVersion, int newVersion) {
        // TODO Auto-generated method stub
        db.execSQL("DROP TABLE IF EXIST " + DATABASE_TABLE);
        onCreate(db);
    }

} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-26T04:05:07.353

您可以对具有默认值的列使用**DEFAULT子句。**你不能吗？有关更多详细信息，请参阅[此](http://www.sqlite.org/lang_createtable.html)。

# node.js - 通过 Node.js 代理管道 MJPEG 流

> ID：14035864
> 
> 赞同：8
> 
> 时间：2012-12-26T04:00:29.430
> 
> 标签：node.js, proxy, motion, mjpeg

在 linux 上使用 Motion，每个网络摄像头都在其自己的端口上作为流提供。我现在想使用 Node.js 在同一个端口上提供这些流。

*   编辑：这个解决方案现在有效。我需要从原始 mjpeg 流中获取边界字符串（在我的 Motion 配置中是“BoundaryString”）

```
 app.get('/motion', function(req, res) {

    var boundary = "BoundaryString";

  var options = {
    // host to forward to
    host:   '192.168.1.2',
    // port to forward to
    port:   8302,
    // path to forward to
    path:   '/',
    // request method
    method: 'GET',
    // headers to send
    headers: req.headers
  };

  var creq = http.request(options, function(cres) {

        res.setHeader('Content-Type', 'multipart/x-mixed-replace;boundary="' + boundary + '"');
        res.setHeader('Connection', 'close');
        res.setHeader('Pragma', 'no-cache');
        res.setHeader('Cache-Control', 'no-cache, private');
        res.setHeader('Expires', 0);
        res.setHeader('Max-Age', 0);

    // wait for data
    cres.on('data', function(chunk){
      res.write(chunk);
    });

    cres.on('close', function(){
      // closed, let's end client request as well 
      res.writeHead(cres.statusCode);
      res.end();
    });

  }).on('error', function(e) {
    // we got an error, return 500 error to client and log error
    console.log(e.message);
    res.writeHead(500);
    res.end();
  });

  creq.end();

}); 

```

我认为这会将 192.168.1.2:8302 处的 mjpeg 流作为 /motion 提供，但事实并非如此。也许是因为它永远不会结束，而这个代理示例并不是真正的流式示例？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-26T04:07:44.563

通过 HTTP 流式传输不是问题。我经常用 Node 来做这件事。我认为您遇到的问题是您没有向客户端发送内容类型标头。实际上，您无需发送任何响应标头即可直接写入数据。

在发送任何实际内容数据之前，请务必将正确的内容类型标头发送回发出请求的客户端。

如果 Node 的 HTTP 客户端还没有为您处理，您可能需要[处理多部分响应。](http://en.wikipedia.org/wiki/Motion_JPEG#M-JPEG_over_HTTP)

另外，我建议使用 Wireshark 进行调试，这样您就可以准确地看到发送和接收的内容。这将帮助您快速缩小此类问题的范围。

我还应该注意，一些客户端在分块编码方面存在问题，如果你不指定内容长度（你不能因为它是不确定的），这就是 Node 将发送的内容。如果您需要禁用分块编码，请在此处查看我的答案： [https](https://stackoverflow.com/a/11589937/362536) ://stackoverflow.com/a/11589937/362536 基本上，您只需要禁用它： `response.useChunkedEncodingByDefault = false;`。除非你需要，否则不要这样做！并确保`Connection: close`在您的标题中发送一个！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-01-03T09:34:00.390

您需要做的是在需要时仅在一个线程中请求 mjpeg 流，并使用 mjpeg 或 jpeg 响应每个客户端（如果您需要 IE 支持）。

# ruby-on-rails - 如何将 Rails 指向正确的 Ruby 安装

> ID：14035866
> 
> 赞同：0
> 
> 时间：2012-12-26T04:00:43.450
> 
> 标签：ruby-on-rails, ruby, installation, rvm

我一直在与我的 Mac OS X 10.8 安装版本的 Ruby 作斗争，并试图转移到 .rvm 安装以使所有内容保持最新。

在浏览了 RVM 网站上的所有文档后，以下是一些结果：

```
~$ which ruby
/Users/localadmin/.rvm/rubies/ruby-1.9.3-p327/bin/ruby
~$ ruby -v
ruby 1.9.3p327 (2012-11-10 revision 37606) [x86_64-darwin12.2.0]
~$ which rails
/usr/bin/rails
~$ rails -v
-bash: /usr/bin/rails: /System/Library/Frameworks/Ruby.framework/Versions/1.8/usr/bin/ruby: bad interpreter: No such file or directory 
```

我不确定是什么原因造成的。我期待 Rails 正在尝试使用系统 Ruby 版本，这不是我在 RVM 中设置的默认值。

我读过这可能是 .gemrc 问题，但我似乎无法在我的主目录中找到 .gemrc 文件。我似乎在我的 .rvm 目录中找不到任何对 rails 的引用，所以我想也许当我执行“gem install rails”时，“gem”实际上是我的系统 Ruby 的附属项。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-26T04:08:19.523

很抱歉回答我自己的问题，如果它被删除我会很高兴，但解决方案相当烦人。

我一直在安装导轨：

```
sudo gem install rails 
```

我想这让我离开了我的 RVM 安装所在的用户空间

```
gem install rails 
```

正确安装了导轨，现在我得到“Rails 3.2.9”作为 rails -v 的结果

任何人都可以阐明为什么会发生这种情况吗？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-27T14:40:53.480

使用 RVM 时，您几乎从不使用 sudo 做任何事情。我发现的唯一常见例外是在安装乘客模块时。

这意味着您想要在 gem、rubies、rubygems 或 RVM 本身上执行的所有操作都不应使用 sudo 执行。

还要确保确保`rvm use [RUBY] --default`您始终使用系统红宝石以外的红宝石。

# css - 创建一个带虚线边框的输入元素

> ID：14035868
> 
> 赞同：2
> 
> 时间：2012-12-26T04:01:01.343
> 
> 标签：css, border

我想在表单中放置一个输入元素。但是，我希望它有一个虚线边框，而不是它有一个实心框边框。

这类似于 basecamp 邀请新人加入现有项目的方式。 [![大本营项目访问](../Images/8a605863e2780850d07774d6f5fec8a4.png)](https://i.stack.imgur.com/Lo8o4.png)

任何想法如何做到这一点？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-12-26T04:16:39.477

这是我想出的代码：

**HTML**

```
<input type="text" id="dotted"> 
```

**CSS**

```
#dotted {
    border:0;
    border-bottom: 2px dotted;
} 
```

这是一个[jsfiddle](http://jsfiddle.net/NZptx/1/)。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-12-26T04:08:45.630

HTML：

```
<input type="text" class="dotted-input">​​​​​​​​​​​​​​​​​​​​​​ 
```

CSS：

```
.dotted-input {
    border: 0px; 
    border-bottom:1px dotted #000;
}​ 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-26T04:02:42.003

像这样：

```
<input type="text" style="border:0;border-bottom:2px dashed #c3c3c3;padding:5px;color:gray;font-family:Arial;font-weight:bold;font-size:14px;"> 
```

如果您希望它不是虚线，而只是一条实线，请替换“border-bottom:2px dashed #c3c3c3;” 带有“边框底部：2px 实心#c3c3c3；”。如果你想要它不是 2px，而只是 1px，请替换“border-bottom:2px dashed #c3c3c3;” 带有“border-bottom:1px dashed #c3c3c3;”。另请注意，在底部添加 2px 边框像素的代码部分是“border-bottom:2px dashed #c3c3c3”。我做的其余代码只是为了点缀。

您还可以参考这样的样式表：

```
<style>
.classy{
border:0;
border-bottom:2px dashed #c3c3c3;
padding:5px;
color:gray;
font-family:Arial;
font-weight:bold;
font-size:14px;
}
</style> 
```

对于文本框，您可以这样做：

```
<input type="text" class="classy"> 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-12-26T04:16:52.997

这是一个

```
<input type="text" class="dotbox">​​​​​​​​​​​​​​​​​​​​​​ 
```

```
.dotbox{
    border:none;
    border-bottom:thin dashed black;
    padding-bottom:0;
    outline:none;
} 
```

[**演示**](http://jsfiddle.net/ksS65/)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-12-26T04:33:47.417

对于周围的虚线边框：

```
<input type="text" style="border:1px dotted #ccc"> 
```

对于您想要的一侧的虚线边框：

```
<input type="text" style="border-<side you want either top, bottom, left, right> 1px dotted #ccc> 
```

# log4cplus - 如何防止日志消息中出现 log4cplus 日志消息？

> ID：14035870
> 
> 赞同：2
> 
> 时间：2012-12-26T04:01:43.537
> 
> 标签：log4cplus

我的 C++ 程序中有以下（简化的）代码：

```
std::string DataRequest::toString() const {
LOG4CPLUS_TRACE(logger,
        LOG4CPLUS_TEXT("symbol=" << m_contract.symbol));

std::ostringstream oss;
oss << "id=" << reqId
    << ",symbol=" << m_contract.symbol;
return oss.str();
} 
```

和

```
int DataService::requestData(
    DataRequest request) {

LOG4CPLUS_INFO(logger, LOG4CPLUS_TEXT("requestData: " << request.toString()));
} 
```

然后，此代码会生成日志消息：

```
TRACE symbol=AAA
INFO  symbol=AAArequestData: id=1,symbol=AAA 
```

但是我期待

```
TRACE symbol=AAA
INFO  requestData: id=1,symbol=AAA 
```

由于在 log4cplus 消息中生成了一条 log4cplus 消息，因此它似乎将两条消息连接成一条消息。这是正常行为吗？是否有强制每条消息独立生成的解决方案？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-31T07:27:32.700

这是错误的代码

```
LOG4CPLUS_TRACE(logger,
        LOG4CPLUS_TEXT("symbol=" << m_contract.symbol)); 
```

它应该读

```
LOG4CPLUS_TRACE(logger,
        LOG4CPLUS_TEXT("symbol=") << m_contract.symbol); 
```

反而。

至于连接的消息，您使用的是什么输出布局？如果是模式布局，那么您应该`%n`在格式字符串的最后添加格式化程序。

**编辑：**

> 不幸的是，我仍然遇到日志消息被连接的问题。我认为这与日志消息本身中的调用 request.toString() 也有对日志消息的调用有关，但由于某种原因，即使在代码修复之后，这两条消息也会一起打印。:(

啊，我最初误解了这个问题。因此，您在首先准备时正在记录第二个事件。问题是格式化是针对 thread-local 完成的`ostringstream`。线程本地`ostringstream`用作性能增强。（`ostringstream`不必在每条记录的消息上构造和销毁。）

为了立即解决，您有两个选择。首先，您停止此嵌套日志记录。其次，您“修复”`LOG4CPLUS_*()`宏以不使用线程本地`ostringstream`或滚动您自己的日志记录宏。两者都不应该那么难。

从长远来看，我可以为日志记录宏添加一个特殊情况，使它们`ostringstream`每次都使用新鲜，以允许您的用例。

**编辑2：**

我已经填写了一个错误报告并附加了一个实现解决方法的补丁。请参阅[https://sourceforge.net/p/log4cplus/bugs/153/](https://sourceforge.net/p/log4cplus/bugs/153/)。

# r - ddply 在 R 中按组求和

> ID：14035872
> 
> 赞同：24
> 
> 时间：2012-12-26T04:01:48.980
> 
> 标签：r, plyr

我有一个示例数据框“数据”，如下所示：

```
X            Y  Month   Year    income
2281205 228120  3   2011    1000
2281212 228121  9   2010    1100
2281213 228121  12  2010    900
2281214 228121  3   2011    9000
2281222 228122  6   2010    1111
2281223 228122  9   2010    3000
2281224 228122  12  2010    1889
2281225 228122  3   2011    778
2281243 228124  12  2010    1111
2281244 228124  3   2011    200
2281282 228128  9   2010    7889
2281283 228128  12  2010    2900
2281284 228128  3   2011    3400
2281302 228130  9   2010    1200
2281303 228130  12  2010    2000
2281304 228130  3   2011    1900
2281352 228135  9   2010    2300
2281353 228135  12  2010    1333
2281354 228135  3   2011    2340 
```

如果我对每个 Y 有四个观察值（例如 2281223，2010 年第 6、9、12 个月和 2011 年第 3 个月），我想使用`ddply`来计算每个`Y`（不是）的收入。`X`如果我有少于四个观察值（例如 Y = 228130），我想简单地忽略它。`R`为了上述目的，我使用以下命令：

```
require(plyr)
     # the data are in the data csv file
    data<-read.csv("data.csv")
    # convert Y (integers) into factors
    y<-as.factor(y)
    # get the count of each unique Y
    count<-ddply(data,.(Y), summarize, freq=length(Y))
    # get the sum of each unique Y 
    sum<-ddply(data,.(Y),summarize,tot=sum(income))
    # show the sum if number of observations for each Y is less than 4
    colbind<-cbind(count,sum)
    finalsum<-subset(colbind,freq>3) 
```

我的输出如下：

```
>colbind
       Y freq      Y   tot
1 228120    1 228120  1000
2 228121    3 228121 11000
3 228122    4 228122  6778
4 228124    2 228124  1311
5 228128    3 228128 14189
6 228130    3 228130  5100
7 228135    3 228135  5973
>finalsum
       Y freq    Y.1  tot
3 228122    4 228122 6778 
```

上面的代码有效，但需要很多步骤。所以，我想知道是否有执行上述任务的简单方法（使用 plyr 包）。

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2012-12-26T04:16:39.447

正如评论中指出的，您可以在`summarize`.

这会将您的代码减少到一行`ddply()`和一行子集，这对于`[`操作员来说很容易：

```
x <- ddply(data, .(Y), summarize, freq=length(Y), tot=sum(income))
x[x$freq > 3, ]

       Y freq  tot
3 228122    4 6778 
```

* * *

使用该`data.table`软件包也非常容易：

```
library(data.table)
data.table(data)[, list(freq=length(income), tot=sum(income)), by=Y][freq > 3]
        Y freq  tot
1: 228122    4 6778 
```

事实上，计算向量长度的操作有它自己的捷径`data.table`——使用`.N`捷径：

```
data.table(data)[, list(freq=.N, tot=sum(income)), by=Y][freq > 3]
        Y freq  tot
1: 228122    4 6778 
```

* * *

## 回答 #2

> 赞同：21
> 
> 时间：2014-08-12T09:33:16.740

我认为这个包`dplyr`比更快`plyr::ddply`更优雅。

```
testData <- read.table(file = "clipboard",header = TRUE)
require(dplyr)
testData %>%
  group_by(Y) %>%
  summarise(total = sum(income),freq = n()) %>%
  filter(freq > 3) 
```

# ipad - uinavigation 中的多个按钮

> ID：14035874
> 
> 赞同：1
> 
> 时间：2012-12-26T04:02:07.070
> 
> 标签：ipad, uinavigationcontroller, ios6, uinavigationbar

是否可以在 ipad 基础应用程序的 ui 导航栏中添加多个按钮？就像图片中的一样？任何人都可以帮助我吗？

![在此处输入图像描述](../Images/ed6e3484175de84b4bada7a530c061ee.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-26T04:32:51.430

当然可以，您可以将按钮添加为`UIBarButtonItem`，有关更多信息，请在此页面查看我的答案

[xcode中的导航栏或工具栏问题](https://stackoverflow.com/questions/13908977/navigation-bar-or-toolbar-trouble-in-xcode/13909341#13909341)

你可以通过轻微的修改来达到你所需要的

问候

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-26T04:36:34.373

UINavigationBar 通过 UINavigationItem 填充。通常这是 UIViewController 的导航项（尽管它不是必须的）。UINavigationItem 具有`rightBarButtonItems`和`leftBarButtonItems`。这些都是复数；你可以给他们每一个栏按钮项目的数组。

# android - 水平滚动视图：它真的是一个解决方案吗？

> ID：14035879
> 
> 赞同：10
> 
> 时间：2012-12-26T04:03:14.203
> 
> 标签：android, android-layout

像成千上万的其他开发人员一样，在某些时候我想要一个水平的图像画廊。（在我的情况下，我希望它在 PageViewer 的页面中）。然后我听说有一个名为 android.wiget.Gallery 的小部件专为这种情况而设计。

很快，我开始听说 Gallery 已被弃用，并检查 StackOverflow，一个接一个的帖子表明 Horizo​​ntalScrollView 是要走的路。

我放弃了 Gallery 并在 Horizo​​ntalScrollView 中设置了所有内容。我首先注意到 Horizo​​ntalScrollView 在某种意义上并不是一个真正的小部件，它只能处理一个根布局。好的，所以我将根布局实现为 LinearLayout。在 LinearLayout 中添加我所有的可滚动项，并意识到 Horizo​​ntalScrollView 也没有适配器。没问题，我将循环浏览视图，将它们一一放大，然后丢弃 AsyncTask 以加载图片。在 4.03 上运行良好。然后我在 2.2 上运行它，你猜怎么着，运行的异步任务太多 - 所以它崩溃了。也许一个 AsyncTask 贯穿所有但有超过 30 个图像。现在我又开始考虑画廊了。

但后来我听说有一个 Horizo​​ntalListView。我实现了它，加上一个适配器。它工作得很好，除了现在滚动不是那么流畅（在 ViewPager 的页面内），并且在重新加载几次后卡住了（在 ViewPager 的页面内）。我想知道我是否应该花更多时间修改 Horizo​​ntalListView 或重新审视我的其他三个实现。也许我只是不应该如此认真地对待弃用。

有什么建议么？

结语：

最后，我决定在 ViewPager 内部使用 Horizo​​ntalScrollView，在其他情况下使用 Horizo​​ntalListView。这是由于滚动效率快如闪电，我终于能够通过覆盖 Horizo​​ntalScrollView 中的 onScroll 来设计一个自定义适配器，并结合 CountDownTimer 定期更新某个范围内的图像，而不管速度如何。建议的另一个解决方案是在速度足够慢时使用速度开始下载。如果 Horizo​​ntalListView 倡导者会检查它在 ViewPager 中的行为，那就太好了，因为我确信它可以被优化和改进。如果我有更多时间，这将是我的首选解决方案。但时间转瞬即逝..

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-02T06:03:10.397

如果您仍然打算使用 a`HorizontalScrollView`我建议在[此处](http://android-er.blogspot.com/2012/07/implement-gallery-like.html)查找布局并[在此处](http://android-er.blogspot.com/2012/12/handle-onclick-for-our-custom.html)查找用于处理项目选择侦听器。但是我不喜欢这条路线，因为您实际上只是在其中制作一个巨人`LinearLayout`，`HorizontalScrollView`这可能会导致内存问题，因为所有图像即使在屏幕外仍然存在。

我个人建议使用`HorizontalListView`找到的[here](http://www.dev-smart.com/archives/34)。

# php - 如何在 PostgreSQL 中将空转换为空？

> ID：14035883
> 
> 赞同：20
> 
> 时间：2012-12-26T04:04:21.113
> 
> 标签：php, sql, postgresql, null

我有一些列类型为 int，但值为空。所以我想在插入数据库时​​将空转换为空。我使用代码：

```
function toDB($string) {
    if ($string == '' || $string == "''") {
        return 'null';
    } else {
        return "'$string'";
    }
}

//age,month,year is type integer.
$name="Veo ve";
$age='10';
$month='';
$year='';
    $query="Insert Into tr_view(name,age,month,year) values ({toDB($name)},{toDB($age)},{toDB($month)},{toDB($year)})
 $db->setQuery($query);
 $result= $db->query(); 
```

但它显示错误：

```
 pg_query(): Query failed: ERROR: syntax error at or near ";" LINE 153: {toDB(10)}, ^ in... 
```

为什么？

* * *

## 回答 #1

> 赞同：77
> 
> 时间：2012-12-26T04:05:33.753

有以下[**`NULLIF()`**](https://www.postgresql.org/docs/current/functions-conditional.html#FUNCTIONS-NULLIF)功能：

```
SELECT NULLIF(var, ''); 
```

如果`var`持有 2 美元的价值，你会得到`NULL`。
在示例中，我将空字符串：替换`''`为`NULL`.

integer 类型没有**空字符串**。只是不可能。由于`NULLIF()`无法切换数据类型，您必须在 PHP 中清理您的输入。

如果您没有定义列默认值，您也可以在命令中**省略该列**`INSERT`，它将被填充`NULL`（这是默认值`DEFAULT`）。

检查PHP中的参数是否为空，如果是，则不要在`INSERT`命令中包含该列。

或者使用**PHP 文字 NULL**代替，就像 Quassnoi[在这里](https://stackoverflow.com/a/1027549/939860)演示的那样。

### 其余的仅对字符串类型有意义

为了**绝对确定**，没有人可以输入一个空字符串`CHECK`给表添加一个约束：

```
ALTER TABLE tr_view
ADD CONSTRAINT tr_view_age_not_empty CHECK (age <> ''); 
```

为**避免由此引起的异常**，您可以添加一个自动修复输入的触发器：

```
CREATE OR REPLACE FUNCTION trg_tr_view_avoid_empty()
  RETURNS trigger AS
$func$
BEGIN
   IF NEW.age = '' THEN
      NEW.age := NULL;
   END IF;

   IF NEW.month = '' THEN
      NEW.month := NULL;
   END IF;

   RETURN NEW;
END
$func$  LANGUAGE plpgsql

CREATE TRIGGER tr_view_avoid_empty
BEFORE INSERT OR UPDATE ON tr_view
FOR EACH ROW
WHEN (NEW.age = '' OR NEW.month = '')
EXECUTE PROCEDURE trg_tr_view_avoid_empty(); 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-12-26T05:22:25.507

`NULLIF`虽然 Erwin的回答*很棒*，但它并没有解决您的语法错误。

让我们看一下查询：

```
$query="Insert Into tr_view(name,age,month,year) values ({toDB($name)},{toDB($age)},{toDB($month)},{toDB($year)}) 
```

之前您定义了一个名为`toDB`. 不幸的是，您在这里使用的语法*不是*如何从双引号字符串中调用函数，因此 curlies 和`toDB(`bits 仍在传递。有两种选择：

1.  连接使用`.`：

    ```
    $query='insert Into tr_view(name,age,month,year) values (' . toDB($name) . ',' . toDB($age) . ',' . toDB($month) . ',' . toDB($year) . ')') 
    ```

2.  因此，您可以将可调用*变量*插入双引号字符串：

    ```
    $fn = 'toDB';
    $query="Insert Into tr_view(name,age,month,year) values ({$fn($name)},{$fn($age)},{$fn($month)},{$fn($year)})"; 
    ```

第一个是清晰和理智的，第二个对于不熟悉的和彻头彻尾的*疯子*来说是模糊的。

但是，您仍然不应该像这样组装输入。您仍然可能容易受到[SQL 注入攻击](http://en.wikipedia.org/wiki/SQL_injection)。您应该使用[带有参数化占位符的准备好的语句](http://en.wikipedia.org/wiki/Prepared_statement)。

Postgres 扩展[`pg_prepare`](http://php.net/pg_prepare)用于此目的。它们具有明显的优势，例如，允许您通过 PHP`null`而不必担心所有的 null 检测和引用。

如果您坚持保持`toDB`原样，请考虑将其中一个`pg_escape_`函数，如[`pg_escape_string`](http://php.net/pg_escape_string)，添加到构建引用字符串的事物中。

# jquery - Fancybox - 如何实现这个效果？

> ID：14035891
> 
> 赞同：0
> 
> 时间：2012-12-26T04:05:51.460
> 
> 标签：jquery, fancybox, lightbox

这个站点似乎在使用 jquery fancybox，但 fancybox 所涵盖的示例都没有做同样的事情。显示灯箱和点击灯箱消失到它来自的地方的效果非常好！有谁知道如何用fancybox达到同样的效果？

[http://www.glauce.com/](http://www.glauce.com/)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-26T21:52:16.583

他们正在使用 fancybox **v1.3.4**并使用记录在案的 API 选项，但与示例中的值不同。

使用这些选项可以实现您想要的效果：

```
$("a.fancybox").fancybox({
    'transitionIn': 'elastic',
    'transitionOut': 'elastic',
    'speedIn': 1000,
    'speedOut': 700
});​ 
```

见**[演示](http://jsfiddle.net/2cTep/)**

...或在不关闭按钮的情况下单击内容时关闭**[相同的效果。](http://jsfiddle.net/Zb3hR/)**

# javascript - 在 Velocity 中使用 jQuery 时出现语法/解析错误

> ID：14035895
> 
> 赞同：0
> 
> 时间：2012-12-26T04:06:43.763
> 
> 标签：javascript, jquery

```
<script type="text/javascript>
(function($, win) {
function mySettingsInitJS () {  

    var self = this;
    var opts = {
        'params' : "userId=" + userId;
    }; 
    self.init = function() {
        self.initUnlinkAction();
    };
    self.initbtnAction = function() {
        $('#Btn').click(self.btnAction);
    };

    self.btnAction = function(e) {
        if(e) { e.preventDefault(); }
        jQuery.post(
        'http://abc/rest/PostRequest', 
        opts.params, function(data) {
        alert('This worked!');
        }, "json");                         
    };

}
function win.MyFilesSettingsInitJS = new MyFilesSettingsInitJS();
}(jQuery, window));
</script> 
```

我在速度模板页面中有这个脚本，其中还有一个 Btn。这基本上是一个花哨的链接。我也确信服务器端的其余 API 工作正常。但不知何故我的java脚本函数没有被调用。有人可以帮我吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-26T04:13:54.277

好像您在这里忘记了引号：

```
'http://abc/rest/PostRequest' 
```

通过良好的语法突出显示，它变得非常明显。另外，如果您使用[JSLint](http://www.jslint.com/)或类似工具，它会发现大多数问题，以及调试代码时的控制台。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-26T04:14:05.147

您的 URL 值需要是一个字符串...为其添加引号

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-27T14:16:59.290

您应该使用浏览器中可用的一些开发人员工具。大多数浏览器至少有一个错误控制台，可以显示任何 JS 错误。例如，这段代码有几个语法错误：

1.  在定义对象文字（也称为映射或字典）时，`var opts = { 'params' : "userId=" + userId; };`以结束行是非法的。`;`
2.  再次在这一行，在哪里`userId`定义？拥有全局变量是一种不好的做法，因此如果`userId`是在另一个脚本中定义的全局变量，则应重构代码
3.  `function win.MyFilesSettingsInitJS = new MyFilesSettingsInitJS();`是非法的，因为您要向对象添加属性，所以您没有声明函数或变量。只需使用`win.MyFilesSettingsInitJS = new MyFilesSettingsInitJS();`
4.  实际上，这也可能是错误的，因为您在上面定义了`mySettingsInitJS`，而不是`MyFilesSettingsInitJS`（但该函数实际上可以在其他地方定义，我没有完整的代码）

# php - 如何获取自动行号php和mysql

> ID：14035896
> 
> 赞同：0
> 
> 时间：2012-12-26T04:06:48.230
> 
> 标签：php, mysql, sql, select

```
No   Name     Sex
1      A       M
2      B       F
3      C       F
4      D       M 
```

我想用 mysql 数据库在表上获取自动编号。那么该怎么做呢？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-26T04:12:48.203

您已创建具有主键和自动增量的表

[http://dev.mysql.com/doc/refman/5.0/en///example-auto-increment.html](http://dev.mysql.com/doc/refman/5.0/en///example-auto-increment.html)

请参见下面的代码：

```
CREATE TABLE Persons
(
id int NOT NULL AUTO_INCREMENT,
name varchar(50) NOT NULL,
sex char(1),
PRIMARY KEY (id)
) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-26T04:12:52.910

有多种方法可以做到这一点，

一种技术是改变表格

*   更改表
*   添加新列
*   将其设置为`AUTO_INCREMENT`

另一种是使用会话变量

```
SELECT @rank := @rank+1 As `No`,
       Name, 
       Sex
FROM   table1, (SELECT @rank := 0) r 
```

*   [SQLFiddle 演示链接](http://sqlfiddle.com/#!2/f60ce/3)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-26T04:22:52.520

自动编号是通过为您希望自动递增的数字列指定[auto_increment属性来完成的。](http://dev.mysql.com/doc/refman/5.0/en/example-auto-increment.html)在创建表时在“id”列上指定它是一种很好的数据库实践，每个 id 唯一地标识一行（也称为主键）。

```
CREATE TABLE people (
  id MEDIUMINT NOT NULL AUTO_INCREMENT,
  name VARCHAR(50) NOT NULL,
  sex ENUM('m', 'f'),
  PRIMARY KEY (id)
) ENGINE=MyISAM; 
```

或者，您可以[在表存在后添加 ID（自动增量）](http://dev.mysql.com/doc/refman/5.0/en/example-auto-increment.html)。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-26T04:15:20.520

如果您想创建一个自动执行此操作的表，大致可以使用...

```
create table mytable (
    `No` serial,
    /* other fields... */); 
```

[http://dev.mysql.com/doc/refman/5.5/en/numeric-type-overview.html](http://dev.mysql.com/doc/refman/5.5/en/numeric-type-overview.html)

```
SERIAL is an alias for BIGINT UNSIGNED NOT NULL AUTO_INCREMENT UNIQUE 
```

但是，如果您删除行，则行号中会出现空白。如果要重置 auto_increment 字段，请使用

```
alter table mytable
auto_increment = 1; 
```

# c# - 合成器从一个频率滑到另一个频率

> ID：14035906
> 
> 赞同：1
> 
> 时间：2012-12-26T04:08:31.677
> 
> 标签：c#, audio, synthesizer

我正在使用 NAudio 在 C# 中编写一个合成器。我试图让它在频率之间平滑滑动。但我有一种感觉，我对所涉及的数学不太了解。在切换到正确的下一个音高之前，它会以高音疯狂滑动。

从一个音高滑到另一个音高的数学正确方法是什么？

这是代码：

公共覆盖 int Read(float[] buffer, int offset, int sampleCount) { int sampleRate = WaveFormat.SampleRate;

```
 for (int n = 0; n < sampleCount; n++)
        {
            if (nextFrequencyQueue.Count > 0)
            {                    
                nextFrequency = nextFrequencyQueue.Dequeue();
            }

            if (nextFrequency > 0 && Frequency != nextFrequency)
            {
                if (Frequency == 0) //special case for first note
                {
                    Frequency = nextFrequency;
                }
                else //slide up or down to next frequency
                {
                    if (Frequency < nextFrequency)
                    {
                        Frequency = Clamp(Frequency + frequencyStep, nextFrequency, Frequency);
                    }
                    if (Frequency > nextFrequency)
                    {
                        Frequency = Clamp(Frequency - frequencyStep, Frequency, nextFrequency);
                    }
                }
            }

            buffer[n + offset] = (float)(Amplitude * Math.Sin(2 * Math.PI * time * Frequency));
            try
            {
                time += (double)1 / (double)sampleRate;
            }
            catch
            {
                time = 0;
            }
        }
        return sampleCount;
    } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-26T04:21:50.567

您正在使用绝对时间来确定波函数，因此当您稍微改变频率时，如果您以该新频率开始运行，下一个样本将会是什么。

我不知道已建立的最佳方法，但一种可能足够好的简单方法是计算相位 (φ = t mod 1/f [old] ) 并调整 t 以保持新频率下的相位 (t = φ/f[新]）。

更平滑的方法是保留一阶导数。这更加困难，因为与波本身不同，一阶导数的幅度随频率而变化，这意味着保持相位是不够的。无论如何，考虑到您正在平稳地改变频率，这种增加的复杂性几乎可以肯定是矫枉过正。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-26T08:36:45.210

一种方法是使用波表。你在一个数组中构造一个完整的正弦波周期，然后在你的 Read 函数中你可以简单地查找它。您阅读的每个样本，您都会根据所需的输出频率计算出一个数量。然后，当您想滑行到一个新频率时，您计算新的增量以查找表，然后不是直接去那里，而是逐步调整增量以在设定的时间段内移动到新值（'glide ' 或滑音时间）。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-12-26T12:35:38.103

```
 Frequency = Clamp(Frequency + frequencyStep, nextFrequency, Frequency); 
```

人耳不是这样工作的，它是高度*非线性的*。自然是对数的。中间 C 的频率为 261.626 Hz。下一个音符 C# 与前一个音符的关系是 Math.Pow(2, 1/12.0) 或大约 1.0594631。所以 C# 是 277.183 Hz，增量为 15.557 Hz。

刻度上的下一个 C 具有两倍的频率，即 523.252 Hz。之后的 C# 是 554.366 Hz，增量为 31.084 Hz。注意增量是如何翻倍的。因此，您的代码片段中的 frequencyStep 不应该是加法，而应该是*乘法*。

```
 buffer[n + offset] = (float)(Amplitude * Math.Sin(2 * Math.PI * time * Frequency)); 
```

这也是一个问题。您计算的样本不会从一个频率平滑过渡到下一个频率。当“频率”改变时有一个步骤。您必须对“时间”应用偏移量，以便它在采样时间“时间 - 1”产生完全相同的采样值，与之前使用频率值计算的值相同。这些步骤会产生带有许多谐波的高频伪影，这些谐波对人耳来说非常明显。

背景信息可在此[Wikipedia 文章中](http://en.wikipedia.org/wiki/Chirp#Exponential_chirp)找到。它将有助于可视化您生成的波形，您将很容易诊断出阶跃问题。我将复制 Wiki 图像：

![在此处输入图像描述](../Images/d881fc0cae0fcb3074226b3f077858b8.png)

# history.js - 奇怪的 History.js 安全错误

> ID：14035909
> 
> 赞同：1
> 
> 时间：2012-12-26T04:09:34.723
> 
> 标签：history.js

我在我的页面中收到此错误。

```
SecurityError: The operation is insecure 
```

起初，我认为这只是同源策略问题。为了测试这一点，我注释掉了所有处理 History.js 的代码

但是我仍然在该页面中收到该错误。

似乎我只是通过在页面中包含 jquery.history.js 来得到这个错误。

任何想法为什么会这样？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-09-06T10:55:21.990

我有同样的问题 - 显然我错过了“www”。从我推的网址。它确实需要完全匹配 - 否则它将不起作用。如果您想同时使用 www.example.com 和 example.com，您需要为此编写一些辅助方法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-08-13T20:00:20.043

This is likely due to pushing state with a URL that is of a different domain name. Check to see you are not using pushState or replaceState with a different domain.

# cassandra - 可以在列名上指定单个比较器吗？

> ID：14035911
> 
> 赞同：0
> 
> 时间：2012-12-26T04:09:45.630
> 
> 标签：cassandra

到目前为止，我在创建列族的同时定义了比较器（它指定了列名的数据类型），并且该族中的所有列都使用相同的比较器数据类型。

```
[default@Voting] create column family User with comparator = UTF8Type; 
```

我想在列族中拥有具有不同比较器数据类型的列。

我的问题是：是否可以在为单个列定义元数据时指定 Comparator 以与定义该列的 validation_class 相同的方式？

例如

```
update column family User with column_metadata = [{column_name: firstName, validation_class: UTF8Type}]; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-26T14:13:38.777

比较器告诉 Cassandra 如何对列*名*而不是值进行排序。所以在一个列族中不可能有多个比较器。您可能会将它们与强制数据类型的**验证器混淆。**您可以在列元数据中指定您的验证器。

```
...
with column_metadata = [
  {column_name: firstName, validation_class: UTF8Type}
  ...
]; 
```

# ruby-on-rails - ActionMailer 方法缺少“default_url_setting”

> ID：14035915
> 
> 赞同：1
> 
> 时间：2012-12-26T04:10:50.147
> 
> 标签：ruby-on-rails, actionmailer, production-environment, method-missing

当我在开发模式下运行我的 rails 应用程序时，它运行良好。但是，当我在生产模式下运行它时，它会在启动时崩溃，我从服务器获得以下输出：

```
/Users/user/.rvm/gems/ruby-1.9.3-p0/gems/actionmailer-3.2.3/lib/action_mailer/base.rb:437:in `method_missing': undefined method `default_url_setting=' for ActionMailer::Base:Class (NoMethodError)
from /Users/user/.rvm/gems/ruby-1.9.3-p0/gems/actionmailer-3.2.3/lib/action_mailer/railtie.rb:34:in `block (3 levels) in <class:Railtie>'
from /Users/user/.rvm/gems/ruby-1.9.3-p0/gems/actionmailer-3.2.3/lib/action_mailer/railtie.rb:34:in `each'
from /Users/user/.rvm/gems/ruby-1.9.3-p0/gems/actionmailer-3.2.3/lib/action_mailer/railtie.rb:34:in `block (2 levels) in <class:Railtie>'
from /Users/user/.rvm/gems/ruby-1.9.3-p0/gems/activesupport-3.2.3/lib/active_support/lazy_load_hooks.rb:36:in `instance_eval'
from /Users/user/.rvm/gems/ruby-1.9.3-p0/gems/activesupport-3.2.3/lib/active_support/lazy_load_hooks.rb:36:in `execute_hook'
from /Users/user/.rvm/gems/ruby-1.9.3-p0/gems/activesupport-3.2.3/lib/active_support/lazy_load_hooks.rb:43:in `block in run_load_hooks'
from /Users/user/.rvm/gems/ruby-1.9.3-p0/gems/activesupport-3.2.3/lib/active_support/lazy_load_hooks.rb:42:in `each'
from /Users/user/.rvm/gems/ruby-1.9.3-p0/gems/activesupport-3.2.3/lib/active_support/lazy_load_hooks.rb:42:in `run_load_hooks'
from /Users/user/.rvm/gems/ruby-1.9.3-p0/gems/actionmailer-3.2.3/lib/action_mailer/base.rb:733:in `<class:Base>'
from /Users/user/.rvm/gems/ruby-1.9.3-p0/gems/actionmailer-3.2.3/lib/action_mailer/base.rb:325:in `<module:ActionMailer>'
from /Users/user/.rvm/gems/ruby-1.9.3-p0/gems/actionmailer-3.2.3/lib/action_mailer/base.rb:10:in `<top (required)>'
from /Users/user/Desktop/MetaRepo/MetaWebsite/app/mailers/notification_mailer.rb:1:in `<top (required)>'
from /Users/user/.rvm/gems/ruby-1.9.3-p0/gems/activesupport-3.2.3/lib/active_support/dependencies.rb:251:in `require'
from /Users/user/.rvm/gems/ruby-1.9.3-p0/gems/activesupport-3.2.3/lib/active_support/dependencies.rb:251:in `block in require'
from /Users/user/.rvm/gems/ruby-1.9.3-p0/gems/activesupport-3.2.3/lib/active_support/dependencies.rb:236:in `load_dependency'
from /Users/user/.rvm/gems/ruby-1.9.3-p0/gems/activesupport-3.2.3/lib/active_support/dependencies.rb:251:in `require'
from /Users/user/.rvm/gems/ruby-1.9.3-p0/gems/activesupport-3.2.3/lib/active_support/dependencies.rb:359:in `require_or_load'
from /Users/user/.rvm/gems/ruby-1.9.3-p0/gems/activesupport-3.2.3/lib/active_support/dependencies.rb:313:in `depend_on'
from /Users/user/.rvm/gems/ruby-1.9.3-p0/gems/activesupport-3.2.3/lib/active_support/dependencies.rb:225:in `require_dependency'
from /Users/user/.rvm/gems/ruby-1.9.3-p0/gems/railties-3.2.3/lib/rails/engine.rb:439:in `block (2 levels) in eager_load!'
from /Users/user/.rvm/gems/ruby-1.9.3-p0/gems/railties-3.2.3/lib/rails/engine.rb:438:in `each'
from /Users/user/.rvm/gems/ruby-1.9.3-p0/gems/railties-3.2.3/lib/rails/engine.rb:438:in `block in eager_load!'
from /Users/user/.rvm/gems/ruby-1.9.3-p0/gems/railties-3.2.3/lib/rails/engine.rb:436:in `each'
from /Users/user/.rvm/gems/ruby-1.9.3-p0/gems/railties-3.2.3/lib/rails/engine.rb:436:in `eager_load!'
from /Users/user/.rvm/gems/ruby-1.9.3-p0/gems/railties-3.2.3/lib/rails/application/finisher.rb:53:in `block in <module:Finisher>'
from /Users/user/.rvm/gems/ruby-1.9.3-p0/gems/railties-3.2.3/lib/rails/initializable.rb:30:in `instance_exec'
from /Users/user/.rvm/gems/ruby-1.9.3-p0/gems/railties-3.2.3/lib/rails/initializable.rb:30:in `run'
from /Users/user/.rvm/gems/ruby-1.9.3-p0/gems/railties-3.2.3/lib/rails/initializable.rb:55:in `block in run_initializers'
from /Users/user/.rvm/gems/ruby-1.9.3-p0/gems/railties-3.2.3/lib/rails/initializable.rb:54:in `each'
from /Users/user/.rvm/gems/ruby-1.9.3-p0/gems/railties-3.2.3/lib/rails/initializable.rb:54:in `run_initializers'
from /Users/user/.rvm/gems/ruby-1.9.3-p0/gems/railties-3.2.3/lib/rails/application.rb:136:in `initialize!'
from /Users/user/.rvm/gems/ruby-1.9.3-p0/gems/railties-3.2.3/lib/rails/railtie/configurable.rb:30:in `method_missing'
from /Users/user/Desktop/MetaRepo/MetaWebsite/config/environment.rb:5:in `<top (required)>'
from /Users/user/Desktop/MetaRepo/MetaWebsite/config.ru:4:in `require'
from /Users/user/Desktop/MetaRepo/MetaWebsite/config.ru:4:in `block in <main>'
from /Users/user/.rvm/gems/ruby-1.9.3-p0/gems/rack-1.4.1/lib/rack/builder.rb:51:in `instance_eval'
from /Users/user/.rvm/gems/ruby-1.9.3-p0/gems/rack-1.4.1/lib/rack/builder.rb:51:in `initialize'
from /Users/user/Desktop/MetaRepo/MetaWebsite/config.ru:1:in `new'
from /Users/user/Desktop/MetaRepo/MetaWebsite/config.ru:1:in `<main>'
from /Users/user/.rvm/gems/ruby-1.9.3-p0/gems/rack-1.4.1/lib/rack/builder.rb:40:in `eval'
from /Users/user/.rvm/gems/ruby-1.9.3-p0/gems/rack-1.4.1/lib/rack/builder.rb:40:in `parse_file'
from /Users/user/.rvm/gems/ruby-1.9.3-p0/gems/rack-1.4.1/lib/rack/server.rb:200:in `app'
from /Users/user/.rvm/gems/ruby-1.9.3-p0/gems/railties-3.2.3/lib/rails/commands/server.rb:46:in `app'
from /Users/user/.rvm/gems/ruby-1.9.3-p0/gems/rack-1.4.1/lib/rack/server.rb:301:in `wrapped_app'
from /Users/user/.rvm/gems/ruby-1.9.3-p0/gems/rack-1.4.1/lib/rack/server.rb:252:in `start'
from /Users/user/.rvm/gems/ruby-1.9.3-p0/gems/railties-3.2.3/lib/rails/commands/server.rb:70:in `start'
from /Users/user/.rvm/gems/ruby-1.9.3-p0/gems/railties-3.2.3/lib/rails/commands.rb:55:in `block in <top (required)>'
from /Users/user/.rvm/gems/ruby-1.9.3-p0/gems/railties-3.2.3/lib/rails/commands.rb:50:in `tap'
from /Users/user/.rvm/gems/ruby-1.9.3-p0/gems/railties-3.2.3/lib/rails/commands.rb:50:in `<top (required)>'
from script/rails:6:in `require'
from script/rails:6:in `<main>' 
```

显然它与我的 ActionMailer gem 有关，但我完全被难住了。任何帮助深表感谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-26T04:31:33.647

在[文档](http://api.rubyonrails.org/classes/ActionMailer/Base.html)(ctrl+F "default_url") 上，有`default_url_options`. 也许你拼错了方法？

```
 config.action_mailer.default_url_options = { :host => "example.com" } 
```

# php - 如何从地址栏中隐藏当前页面名称

> ID：14035921
> 
> 赞同：-2
> 
> 时间：2012-12-26T04:12:22.717
> 
> 标签：php

我希望我的 URL 在地址栏
**http://mysite.com/**
中看起来像这样， 而不是
**http://mysite.com/somepage.html**或**.php**
我想在我网站的所有页面中都这样做
谢谢进步！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-26T04:19:34.480

您已在 apache 服务器中启用 mod_rewirte 并将您的页面称为调用您的页面，例如：

```
http://mysite.com/11/news
or 
http://mysite.com/11/blog 
```

在根目录中添加 .htaccess 文件-

```
RewriteEngine On
RewriteRule ^news/([0-9]+)/(.*)$ viewnews.php?news_id=$1 [L]
RewriteRule ^blog/([0-9]+)/(.*)$ blog.php?news_id=$1 [L] 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-26T04:21:46.663

只需放置一个包含您网站内容的 iframe，其大小与窗口一样大

因此，每次用户点击链接时，iframe 都会更改内容而不更改您的网站 URL

或者你可以使用这个方法：[http ://html5demos.com/history](http://html5demos.com/history)

# linux - 通过 ConsoleKit 或 systemd 限制登录用户对 D-Bus 的访问

> ID：14035922
> 
> 赞同：3
> 
> 时间：2012-12-26T04:12:24.147
> 
> 标签：linux, dbus, systemd

我需要将 D-Bus 服务的客户端限制为仅通过 ConsoleKit 或 systemd 在本地登录系统的用户。我必须如何配置或编写 D-Bus 服务才能做到这一点？

# php - 我可以有一个同名的php函数和javascript函数吗？

> ID：14035927
> 
> 赞同：-4
> 
> 时间：2012-12-26T04:13:57.213
> 
> 标签：php, javascript, forms, function, names

php 函数验证包含文件夹中的用户表单详细信息。

我的 javascript 函数验证 javascript 外部源中的用户详细信息。

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2012-12-26T04:15:18.690

当然可以。您甚至可以为您的小马提供与任何功能相同的名称。

# python - 如何通过共享事件循环将 Tornado 和 Pika 与 RabbitMQ 连接起来？

> ID：14035932
> 
> 赞同：0
> 
> 时间：2012-12-26T04:14:32.090
> 
> 标签：python, rabbitmq, tornado, pika

我在 Pika 中使用 TornadoConnection 适配器，但是发现文档很轻。我想要：

1.  Tornado 通过处理程序启动 Pika 生产者
2.  Pika 执行消费者
3.  消费完成时通过回调通知 Tornado 并更新 Web 客户端

文档展示了如何使用 Tornado IOLoop，但我还没有看到这样的例子。非常感激。

* * *

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-26T23:11:35.630

我建议阅读这篇博文，它真的很好：

[http://reminiscential.wordpress.com/2012/04/07/realtime-notification-delivery-using-rabbitmq-tornado-and-websocket/](http://reminiscential.wordpress.com/2012/04/07/realtime-notification-delivery-using-rabbitmq-tornado-and-websocket/)

# android - Android 语句 Sqlite 光标

> ID：14035938
> 
> 赞同：-1
> 
> 时间：2012-12-26T04:15:41.033
> 
> 标签：android, sqlite, cursor

我有这样的源代码：

```
if (proses == 3) {
    HistoryConnector dbkonek = new HistoryConnector(this);
    dbkonek.open();

    //CURSOR air
    cursorSumberAir = dbkonek.getOneDataSumberAir(rowId);
    cursorKegunaanAir = dbkonek.getOneDataKegunaanAir(rowId);
    cursorSifatAir = dbkonek.getOneDataSifatAir(rowId);
    cursorPerlakuanAir = dbkonek.getOneDataPerlakuanAir(rowId);
    cursorPenyimpananAir = dbkonek.getOneDataPenyimpananAir(rowId);
    cursorSanitasi = dbkonek.getOneDataSanitasi(rowId);
    cursorSumberAir.moveToFirst();
    cursorKegunaanAir.moveToFirst();
    cursorSifatAir.moveToFirst();
    cursorPerlakuanAir.moveToFirst();
    cursorPenyimpananAir.moveToFirst();
    cursorSanitasi.moveToFirst();
} else {  
    DatabaseConnector dbkonek = new DatabaseConnector(this); 
    dbkonek.open();

    //CURSOR air
    cursorSumberAir = dbkonek.getOneDataSumberAir(rowId);
    cursorKegunaanAir = dbkonek.getOneDataKegunaanAir(rowId);
    cursorSifatAir = dbkonek.getOneDataSifatAir(rowId);
    cursorPerlakuanAir = dbkonek.getOneDataPerlakuanAir(rowId);
    cursorPenyimpananAir = dbkonek.getOneDataPenyimpananAir(rowId);
    cursorSanitasi = dbkonek.getOneDataSanitasi(rowId);
    cursorSumberAir.moveToFirst();
    cursorKegunaanAir.moveToFirst();
    cursorSifatAir.moveToFirst();
    cursorPerlakuanAir.moveToFirst();
    cursorPenyimpananAir.moveToFirst();
    cursorSanitasi.moveToFirst();
} 
```

我想要这个：如果`proses == 3`然后`dbkonek`创建新的`HistoryConnector`. 否则`dbkonek`创建新`DatabaseConnector`的，我怎么能做到这一点？因为当我制作这样的来源时：

```
if (proses == 3) {
    HistoryConnector dbkonek = new HistoryConnector(this);
    dbkonek.open();
} else {  
    DatabaseConnector dbkonek = new DatabaseConnector(this); 
    dbkonek.open();
}
    //CURSOR air
    cursorSumberAir = dbkonek.getOneDataSumberAir(rowId);
    cursorKegunaanAir = dbkonek.getOneDataKegunaanAir(rowId);
    cursorSifatAir = dbkonek.getOneDataSifatAir(rowId);
    cursorPerlakuanAir = dbkonek.getOneDataPerlakuanAir(rowId);
    cursorPenyimpananAir = dbkonek.getOneDataPenyimpananAir(rowId);
    cursorSanitasi = dbkonek.getOneDataSanitasi(rowId);
    cursorSumberAir.moveToFirst();
    cursorKegunaanAir.moveToFirst();
    cursorSifatAir.moveToFirst();
    cursorPerlakuanAir.moveToFirst();
    cursorPenyimpananAir.moveToFirst();
    cursorSanitasi.moveToFirst(); 
```

编辑，任何一个这样的连接器：

```
public class DatabaseConnector {

    private static final String DB_NAME = "DataAssessment.db";
    private SQLiteDatabase database;
    private DatabaseOpenHelper dbOpenHelper;

    public DatabaseConnector(Context context) {
        dbOpenHelper = new DatabaseOpenHelper(context, DB_NAME, null, 1);
    }
} 
```

上面的源代码，`dbkonek`无法在游标中检测到。我怎么能简单这个源代码。感谢提前

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-26T04:31:27.970

您的类层次结构必须设计为`HistoryConnector`共享`DatabaseConnector`一个通用的*基类*或*接口*（大概称为），它定义了在*任何*类型的*连接器*`Connector`上可用的操作集。然后，您只需执行以下操作：

 **```
Connector dbkonek;
if(proses == 3){
    dbkonek = new HistoryConnector(this);
}else{  
    dbkonek = new DatabaseConnector(this);
}
dbkonek.open();
... 
```**

# objective-c - 如何在矩形或点中找到对象

> ID：14035942
> 
> 赞同：0
> 
> 时间：2012-12-26T04:16:19.930
> 
> 标签：objective-c, macos, cocoa, nsview

在 NSView 上还有许多其他 NSView，其中一些正在使用键盘滚动键移动。当移动物体出现在任何静态物体之上时，我想知道哪个物体位于移动物体之下。用鼠标这很容易，但是没有鼠标我找不到实现这一目标的方法。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-26T04:34:49.707

您需要遍历所有要测试的视图，获取每个视图的框架，将该矩形转换为相关视图的坐标系（在 NSView 文档中搜索“convertRect:”），然后使用几何函数[测试移动视图的转换框架是否与](http://developer.apple.com/library/mac/documentation/Cocoa/Reference/Foundation/Miscellaneous/Foundation_Functions/Reference/reference.html#//apple_ref/c/func/NSIntersectsRect)静态视图的框架相交。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-12-26T04:48:08.150

这可能会帮助你

```
-(void)handleTap:(UIGestureRecognizer *)gesture
{
    CGPoint tappedPoint = [gesture locationInView:self.view];
    NSLog("You tapped in on screen point : %@",tappedPoint);
} 
```

使用它`tappedPoint`我们可以检查这些点存在于哪个视图的矩形中。

**重要**我们必须在视图中添加点击手势才能使用此功能。

# iphone - 实例方法 presentModalViewController:animated not found

> ID：14035943
> 
> 赞同：0
> 
> 时间：2012-12-26T04:16:22.137
> 
> 标签：iphone, ipad

我正在应用程序委托中实现电子邮件编写器。我不知道为什么，但我收到了警告

> “实例方法 presentModalViewController：找不到动画”

仅在 appdelegate 中，而我在其他视图控制器中使用相同的方法，它运行顺利。

```
 MFMailComposeViewController *mail = [[MFMailComposeViewController alloc] init]; 
  mail.mailComposeDelegate = self; 

  if([MFMailComposeViewController canSendMail]) 
  {
     //Setting up the Subject, recipients, and message body.

     [mail setToRecipients:[NSArray arrayWithObjects:@"abc@gmail.com",nil]];
     UIImage *pic = [UIImage imageNamed:@"page0.png"];
     NSData *exportData = UIImageJPEGRepresentation(pic ,1.0);
     [mail addAttachmentData:exportData mimeType:@"image/jpeg" fileName:@"Picture.jpeg"];

     [mail setSubject:@"dummy text"];
     [mail setMessageBody:@"Please tell us what your concerns are and we will try to fix them" isHTML:NO];
     //Present the mail view controller
     [self presentModalViewController:mail animated:YES]; 
     //release the mail [mail release];
  } 
```

`[self presentModalViewController:mailer animated:YES];`当到达这里时，这是发出警告并且应用程序崩溃了。

有什么建议么。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-26T04:27:07.927

```
[self presentModalViewController:mail animated:YES]; 
```

是 UIViewControllers 方法。请检查您是否从 UIViewController 扩展了您的课程

```
@interface abc : UIViewController 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-08-03T16:03:04.083

@NiravPatel：谢谢。你给了我线索。但在我的情况下，我不得不用“mailer”替换“mail”。

所以，我让它在iOS7下工作

```
[self presentViewController:mailer animated:YES completion:nil]; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-26T07:56:01.380

这是因为 presentModalViewController 在 ios 6 中已被弃用。所以对于 ios 6，您必须编写如下方法

```
[self presentViewController:mail animated:YES completion:nil]; 
```

让我知道它是否工作......！！！！

快乐编码！！！！！！

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-26T04:19:55.377

presentModalViewController 是`UIViewController`的子类的方法，而不是 的方法`appDelegate`，因为它本身没有任何视图控制器。

您可以做的是，如果您正在使用它，请将其呈现给导航控制器的最后一个视图控制器

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-12-26T04:21:49.723

为什么要在您的应用程序委托中实现这一点。我只是制作一个单独的视图并将您的 AppDelegate 正在执行的任何操作放在视图上，然后在视图控制器中实现此代码。尝试在 AppDelegate 中实现类似 PresentModalViewController 的代码是不可能的。只需创建一个新视图并指向应用程序委托以在启动时加载该视图。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-12-26T04:42:16.647

`presentModalViewController:animated:`不会工作，因为`that's method`但`UIViewController`这里`self`是一个`app delegate`.

请参阅[View Controllers](http://developer.apple.com/library/ios/#featuredarticles/ViewControllerPGforiPhoneOS/Introduction/Introduction.html#//apple_ref/doc/uid/TP40007457)链接以获取更多参考

# ruby-on-rails - rails 3中的“retract”功能

> ID：14035944
> 
> 赞同：0
> 
> 时间：2012-12-26T04:16:27.013
> 
> 标签：ruby-on-rails, post, get, crud

我已经阅读了如何使用**retract添加****额外的成员路由**，但无法彻底理解。据说，就像**edit**是**update**的入口一样，**retract**是**destroy**的入口，我对 CRUD 功能非常了解。那么我能否通过示例详细但简单地解释一下**retract**方法在**rails 3**中的工作原理。

 ******你可以在这里找到上下文。[informit.com/articles/article.aspx?p=1671632&seqNum=8](http://informit.com/articles/article.aspx?p=1671632&seqNum=8)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-02T09:34:16.713

Rails中没有`retract`方法。作为示例，它是添加到资源控制器的路由（它可能有不同的命名）。这个新动作被添加到资源的 7 个默认动作中：`index`, `new`, `create`, `show`, `edit`, `update`,`destroy`

您可以查看[Rails 路由指南](http://guides.rubyonrails.org/routing.html)以获取有关路由和资源的更多信息，尤其是第 2.9 章，它涵盖了与您的链接相同的主题。******

# php - 在 PHP 中查找重复的单词而不指定单词本身

> ID：14035945
> 
> 赞同：4
> 
> 时间：2012-12-26T04:16:27.087
> 
> 标签：php, regex, repeat, words

我一直在为我想做的项目考虑一些事情，我不是高级用户，我只是在学习。不知道这是否可能：

假设我们有 100 个 html 文档，其中包含许多表格和文本。

问题一是：是否可以分析所有这些文本并找到重复的单词并计算它？

是的，可以使用某些功能，但问题是：如果我们不知道会找到的单词怎么办？也就是说，我们必须告诉代码一个词的含义。

例如，假设一个词是七个字符的并集，想法是找到其他相似的模式并提及它。最好的方法是什么？

非常感谢您提前。

例子：

搜索：下一个短语的五个字符模式：

文字一：

> “需要一片海洋才能不破裂”

文字二：

> “海洋是咸水体”

**结果**

```
Takes 1 
Break 1
water 1
Ocean 2 
```

在此先感谢您的帮助。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-12-26T04:19:41.407

```
function get_word_counts($phrases) {
   $counts = array();
    foreach ($phrases as $phrase) {
        $words = explode(' ', $phrase);
        foreach ($words as $word) {
          $word = preg_replace("#[^a-zA-Z\-]#", "", $word);
            $counts[$word] += 1;
        }
    }
    return $counts;
}

$phrases = array("It takes an ocean of water not to break!", "An ocean is a body of saline water, or so I am told.");

$counts = get_word_counts($phrases);
arsort($counts);
print_r($counts); 
```

**输出**

```
Array
(
    [of] => 2
    [ocean] => 2
    [water] => 2
    [or] => 1
    [saline] => 1
    [body] => 1
    [so] => 1
    [I] => 1
    [told] => 1
    [a] => 1
    [am] => 1
    [An] => 1
    [an] => 1
    [takes] => 1
    [not] => 1
    [to] => 1
    [It] => 1
    [break] => 1
    [is] => 1
) 
```

**编辑**
根据@Jack 的评论更新以处理基本标点符号。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2021-12-17T20:28:01.050

另一种使用内置函数的替代方法也忽略短词：

```
 function get_word_counts($text) 
   {
        $words = str_word_count($text, 1);
        foreach ($words as $k => $v) if (strlen($v) < 4) unset($words[$k]); // ignore short words
        $counts = array_count_values($words);
        return $counts;
    }
$counts = get_word_counts($text);
arsort($counts);        
print_r($counts); 
```

注意：这假设一个文本块，如果处理一组短语添加`foreach ($phrases as $phrase)`等

# c# - 报告类型参数错误的最佳实践？

> ID：14035949
> 
> 赞同：4
> 
> 时间：2012-12-26T04:16:45.103
> 
> 标签：c#, .net, generics

在 .NET 中报告泛型方法的无效类型参数是否有特定的最佳实践或其他建议？

（具体例子：我有一个带有签名的方法

```
public static T GetRoles<T> (this WindowsIdentity id) where T: struct 
```

然后我对 T 进行一些思考，以确保它既是 (a) 枚举，又是 (b) 正确的枚举类型，因为这不是我可以在 where 子句中使用的约束。）

对于大多数参数错误，我会做显而易见的事情并使用适当的参数名称和消息抛出 ArgumentException，除非因为类型参数不是常规参数，所以尝试抛出*新的 ArgumentException ("oops", "T")*使代码分析器抱怨参数名称不是一个。当然，如果没有更好的方法，这不会阻止我，但是如果在这方面有指定或推荐的做法，我想知道它是什么。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-26T07:55:47.260

通过检查可转换接口可以充分地限制枚举：

```
where T : struct, IConvertible 
```

这应该可以为您节省一些反思工作。

# php - PHP替换文本中的 , 如果需要更改

> ID：14035951
> 
> 赞同：0
> 
> 时间：2012-12-26T04:17:03.030
> 
> 标签：php, javascript, html, arrays

我正在尝试用 div 中的 PHP 替换文本，

> 西大街 18 号

虽然如果文本是`19 West Main Street`. 如果是这样，它会被改变成别的东西。我试过用一个数组来做这个，但没有运气。

[http://php.net/manual/en/function.array-replace.php](http://php.net/manual/en/function.array-replace.php)，尽管我找不到使用 if 语句并包括 div 标签中更改的文本的方法。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-26T04:24:23.360

像下面这样的东西应该让你开始：

```
<?php
$html = '<div>19 West Main Street</div><div>18 West Main Street</div>';

$doc = new DOMDocument();
$doc->loadHTML($html);

$xPath = new DOMXPath($doc);
$nodes = $xPath->query("//div[text() = '18 West Main Street']|//div[text() = '19 West Main Street']");

foreach ($nodes as $node) {
    if ($node->nodeValue == '18 West Main Street') {
        $node->nodeValue = 'Something';
    } else {
        $node->nodeValue = 'something else';
    }
}

echo $doc->saveHTML(); 
```

演示：[http ://codepad.viper-7.com/V4ZMPT](http://codepad.viper-7.com/V4ZMPT)

它找到所有`div`带有文本的 s 并将其`19 / 18 West Main Street`替换为“something (else)”。如果那不是您想要的，我不完全理解您的问题:)

或者，如果您只想替换文本`19 West Main Street`，您可以这样做：

```
<?php
$html = '<div>19 West Main Street</div>';

$doc = new DOMDocument();
$doc->loadHTML($html);

$xPath = new DOMXPath($doc);
$nodes = $xPath->query("//div[text() = '19 West Main Street']");

foreach ($nodes as $node) {
    $node->nodeValue = 'something else';
}

echo $doc->saveHTML(); 
```

演示：[http ://codepad.viper-7.com/HeLk5i](http://codepad.viper-7.com/HeLk5i)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-26T12:30:49.597

我已经这样做了，而且效果很好:)

下面的链接显示了工作示例 `{ http://jsfiddle.net/SagarPPanchal/u225F/1/ }` 谢谢

正是我不知道如何在这里以正确的方式编写链接，所以我很抱歉

```
<div id="example2div" style="border-style:solid; padding:20px;">Replace me with something, please.</div>
    <textarea cols="36" rows="4" name="new" style="width:350px;" onchange="EffectReplacement(this)" wrap="on"></textarea>
    <select onchange="" id="s_box" style="visibility: hidden;">
        <option value="TEST_ONE">TEST_ONE</option>
        <option value="TEST_TWO">TEST_TWO</option>
    </select>
    <br />
    <input type="button" value="Change Content" style="width:350px;" onclick="return show_stuff();">
    <br />
    <input type="button" value="Hide Content" style="width:350px;" onclick="return hide_stuff();">

<script>
 function ReplaceContentInContainer(id, content) {
     var container = document.getElementById(id);
     container.innerHTML = content;
 }

 function EffectReplacement(it) {
     re = /script/ig;
     var content = it.value.replace(re, 's.c.r.i.p.t');
     ReplaceContentInContainer('example2div', content);
 }

 function show_stuff() {
     document.getElementById('s_box').style.visibility = "Visible";
 }

 function hide_stuff() {
     document.getElementById('s_box').style.visibility = "hidden";
 }
</script> 
```

# java - GrantedAuthorityImpl() 类的替代方案

> ID：14035953
> 
> 赞同：39
> 
> 时间：2012-12-26T04:17:23.437
> 
> 标签：java, spring, spring-mvc, spring-security

我想要一个 GrantedAuthorityImpl() 类的替代品。我希望在春季安全实施中做到这一点。GrantedAuthorityImpl() 类已弃用。因此，我想要一个替代解决方案。我的代码：

```
public Collection<GrantedAuthority> getAuthorities(Integer access) {
    List<GrantedAuthority> authList = new ArrayList<GrantedAuthority>(2);

    if (access.compareTo(1) == 0) {
        authList.add(new GrantedAuthorityImpl("ROLE_ADMIN"));
    }
    else{
        authList.add(new GrantedAuthorityImpl("ROLE_USER"));
    }
    return authList;
} 
```

* * *

## 回答 #1

> 赞同：79
> 
> 时间：2012-12-26T09:08:11.777

GrantedAuthorityImpl 类已被弃用 - 您可以改用 SimpleGrantedAuthority：

```
public Collection<GrantedAuthority> getAuthorities(Integer access) {
    List<GrantedAuthority> authList = new ArrayList<GrantedAuthority>(2);

    if (access.compareTo(1) == 0) {
        authList.add(new SimpleGrantedAuthority("ROLE_ADMIN"));
    }
    else{
        authList.add(new SimpleGrantedAuthority("ROLE_USER"));
    }
    return authList;
} 
```

# ios - GKScore 必须包含一个初始化值？

> ID：14035954
> 
> 赞同：0
> 
> 时间：2012-12-26T04:17:28.940
> 
> 标签：ios, gamekit, sigabrt

我有时会遇到 SIGABRT 崩溃，崩溃时说：GKScore 必须包含一个初始化值。

所以它追踪到这一行：

```
[localScore reportScoreWithCompletionHandler:^(NSError* error) {}]; 
```

localStore 是这样创建的：

```
GKScore* localScore = [scores objectForKey:category]; 
```

-- 类别来自...

```
for (NSString* category in categories) 
```

-- 类别来自...

```
[GKLeaderboard loadCategoriesWithCompletionHandler:^(NSArray *categories, NSArray *titles, NSError *error) 
```

* * *

```
-(void) initScores
{
    NSString* libraryPath = [NSSearchPathForDirectoriesInDomains(NSLibraryDirectory, NSUserDomainMask, YES) objectAtIndex:0];
    NSString* file = [libraryPath stringByAppendingPathComponent:currentPlayerID];
    file = [file stringByAppendingString:kScoresFile];
    id object = [NSKeyedUnarchiver unarchiveObjectWithFile:file];

    if ([object isKindOfClass:[NSMutableDictionary class]])
    {
        NSMutableDictionary* loadedScores = (NSMutableDictionary*)object;
        scores = [[NSMutableDictionary alloc] initWithDictionary:loadedScores];
    }
    else
    {
        scores = [[NSMutableDictionary alloc] init];
    }

    //NSLog(@"scores initialized: %d", scores.count);
} 
```

对不起所有的代码，但几乎所有这些代码都来自这个库的文件：[https ://github.com/csdavies/DDGameKitHelper/blob/master/DDGameKitHelper.m](https://github.com/csddavies/DDGameKitHelper/blob/master/DDGameKitHelper.m)

无论如何，我将如何解决这个问题？

谢谢！！！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-26T07:46:59.663

来自[GameKit 参考](https://developer.apple.com/library/mac/#documentation/GameKit/Reference/GKScore_Ref/Reference/Reference.html)：

> 要向 Game Center 报告分数，您的游戏会分配并初始化一个新对象，将[`value`](https://developer.apple.com/library/mac/documentation/GameKit/Reference/GKScore_Ref/Reference/Reference.html#//apple_ref/occ/instp/GKScore/value)属性设置为玩家获得的分数，然后调用该`reportScoreWithCompletionHandler:`方法。

Most likely it's complaining because you haven't set the `value` property, but it's also possible that you're missing the first step too -- i.e. it doesn't like you submitting `GKScore` objects that came from a leaderboard instead of ones you create yourself.

# javascript - 完成两个功能需要多次点击

> ID：14035956
> 
> 赞同：2
> 
> 时间：2012-12-26T04:18:05.053
> 
> 标签：javascript, jquery, codeigniter

我有一些javascript，由于某种原因需要连续两次点击才能正常运行。这是链接的代码：

```
<a href="" onclick="select_all_com(); return false">Select All</a> 
```

现在，这里是使用 onclick 调用的函数的代码：

```
function select_all_com(){
$("[name=file_com_appeal].com-checkbox").each( function() {   
    $(this).attr('checked', true);
}); 
UpdateTotalFee();
} 
```

最后，这是最后一段代码：

```
function UpdateTotalFee(){
    var AppealCount = 0;

    $('input[name=file_com_appeal].com-checkbox').each(function(){
    if( $(this).next().hasClass('checked') ){ 
        AppealCount++; } 
    });

    $('#AppealFeeTotal').text("$"+(AppealCount*140));
} 
```

这最后一部分应该在第一次单击链接时运行，但由于某种原因它第一次没有运行，只有第二次运行。具体来说，我的意思是第一次单击会将所有复选框从关闭更新为打开，但不会更新`#AppealFeeTotal`. 当复选框已被选中时，随后单击“全选”链接会导致`#AppealFeeTotal`更新。

任何想法为什么这可能需要点击两次？我还应该补充一点，特别是我不确定的一行代码。我从其他人那里继承了代码，但我不确定使用它的原因：

```
if( $(this).next().hasClass('checked') ){ 
```

感谢您可能有的任何想法。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-26T04:25:25.950

有几件事，首先`attr('checked')`与`hasClass('checked')`我怀疑这是您的问题所在不同。您的代码没有添加我可以看到的“已检查”类，但您正在计算这种情况。您应该`is:checked`为此使用选择器。

其次，如果我正确阅读了您的代码，您只需计算选中的复选框即可获得总数。您可以像这样更有效地执行此操作：

`$(":checkbox").filter(':checked').length`

自然地，您会想要改进该选择器（因此它只计算特定的复选框）但没有更多的 html，我对此无能为力。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-26T04:23:19.133

```
$(document).ready( function() { // this is a function which execute when document is ready in jQuery
var clicks = 0; // I am taking clicks variable so, to check whether the user have clicked for the first time

$("a").on("click", function() { // this is a function which execute when target anchor tag is clicked
    clicks++; // now user have clicked the anchor tag so, i have to increase value to 1
    if(clicks==1) { // this condition checks whether user have clicked the anchor tag for the first time? if yes, then execute the code
        $("[name=file_com_appeal].com-checkbox").each( function() { // this is a each function which loops through all targets perform operations
        $(this).attr('checked', true); // while looping through all targets this will set attribute or property "checked" to true means its checked
        });
    }
    else if(clicks==2) { // this conditions check that whether anchor tag is clicked for second time
        var AppealCount = 0;
        $('input[name=file_com_appeal].com-checkbox').each(function(){
            if( $(this).prop('checked') ){ 
                AppealCount++; 
            } 
        });
        $('#AppealFeeTotal').text("$"+(AppealCount*140));
        clicks = 0; // set to zero because if user repeatedly clicks the anchor tag
    }
});
}); 
```

# javascript - BackboneJS 中的树结构：如何用视图渲染它们

> ID：14035965
> 
> 赞同：1
> 
> 时间：2012-12-26T04:21:30.210
> 
> 标签：javascript, backbone.js, nested, backbone-views

我有一个简单的 Backbone 应用程序来处理分层项目。该模型（到目前为止）很简单，除了`ID`: `content`、`order`和. 它应该只包含三个属性`parent_id`。最后一个属性应该包含对它的父模型实例的引用，或者`null`它是否是根级别的项目。该`order`属性将用于对树的同一级别的项目进行排序，我想实现一些拖放功能来手动对项目进行排序。

服务器端 JSON 已经将项目按树顺序排序，但我不确定如何在视图中处理这个问题。目前，我在项目视图中所做的是向元素添加左填充以`$el`指示一些“缩进”，但本质上它仍然是项目的平面列表。这就是为什么我不确定如何实现拖放排序，防止项目超出范围（如上面的父项目）

如何使用 BackboneJS 彻底解决此模型渲染问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-05-28T07:45:27.817

它不是“纯粹的”Backbone（它使用 Marionette.js），但是对于任何研究类似问题的人来说，这篇文章应该会感兴趣：http: [//lostechies.com/derickbailey/2012/04/05/composite-views -树结构表和更多/](http://lostechies.com/derickbailey/2012/04/05/composite-views-tree-structures-tables-and-more/)

# java - 有时我会关闭流，有时我不会。为什么我会得到这个？

> ID：14035970
> 
> 赞同：2
> 
> 时间：2012-12-26T04:21:55.167
> 
> 标签：java, spring, spring-ws

我有一大段这样的代码：

```
AxiomSoapMessage message = (AxiomSoapMessage)webServiceMessage; 

SoapHeader soapHeader = message.getSoapHeader();
SOAPMessage soapMessage = message.getAxiomMessage();

TransportContext transContext = TransportContextHolder.getTransportContext();

HttpServletConnection connection = (HttpServletConnection)transContext.getConnection();
HttpServletRequest httpRequest = connection.getHttpServletRequest();

InputStream inputStream = httpRequest.getInputStream();

SniffedXmlInputStream sniffedXmlInputStream = new SniffedXmlInputStream(inputStream);

String encoding = sniffedXmlInputStream.getXmlEncoding();
sniffedXmlInputStream.close();

String soapVersion = message.getVersion().toString();       

ByteArrayOutputStream baos = new ByteArrayOutputStream();

**soapMessage.serialize(baos);** //THIS LINE 
```

这是接收 Spring ws 的**WebServiceMessage**的类的一部分，我从中提取**SOAPMessage**，如上所示。

在上面代码中用“THIS LINE”标记的粗体行，我“有时”得到以下异常

```
 org.springframework.integration.MessageHandlingException: 
    org.apache.axiom.om.OMException: 
       javax.xml.stream.XMLStreamException: 
          ParseError at [row,col]:[1,4090] Message: Stream closed 
```

有什么解决办法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-26T04:39:05.787

由于无效的 XML，可能会发生 javax.xml.stream.XMLStreamException。打印 XML 并查看它是否根据 DTD 或 XSD 进行验证。

# c# - 需要一点帮助才能使 Windows Phone SDK 正常工作

> ID：14035973
> 
> 赞同：0
> 
> 时间：2012-12-26T04:22:47.167
> 
> 标签：c#, .net, visual-studio, windows-phone-7, windows-phone-7.1

为什么尝试使用 Windows Phone SDK（任何版本）会出现问题？我尝试使用 Visual Studio 2012 Ultimate 在我的 Windows 8 机器上安装 WP8，尽管进行了一个月的故障排除和搜索，但没有任何东西可以解决这个问题。首先，WP8 安装程序告诉我我的操作系统不是 Windows 8 - 然后它告诉我不支持我的 .NET Framework 版本（我有从 3.0 到 4.5 的每个版本）。作为最后的手段，我尝试在兼容模式下运行安装程序，但该选项甚至不适用于安装程序。

然后我查看了“开始”菜单，发现了一个名为 Visual Studio 2010 Express 的文件夹。我展开了这个文件夹，令我惊讶的是，它里面有 Visual Studio 2010 Express for Windows Phone.Ink（WP7.0 和 WP7.1）——所以我打开了它。一切似乎都很顺利。我创建了一个新项目“PhoneApp1”，没有编写任何代码或进行任何更改，我点击了调试按钮 - 这就是我得到的：

![在此处输入图像描述](../Images/171b3483fe821e78688af455ecce1cf2.png)

它说“在没有帮助的情况下运行程序”。所以我点击了它。然后会发生这种情况：

![在此处输入图像描述](../Images/acff41c7b2e01bf3a32cb7772a531f5c.png)

点击确定...

![在此处输入图像描述](../Images/dff456b2d54794fa8fae04b6d7838dc4.png)

点击否...

![在此处输入图像描述](../Images/800c32b103fd30883030b6bcf9a3902c.png)

> 由于命令行参数无效，连接失败。

现在我们收到错误消息。不是很有帮助，但我上网搜索并在 Google 结果中尽可能深入地挖掘，我想我已经尝试了至少 20 个不同的站点，甚至更多的“解决方案”，但没有一个解决方案有效。

有没有人有这个完全相同的问题？你怎么修好它的？

请不要告诉我安装 WP8 SDK，除非您也有适用的解决方案。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-26T06:45:08.867

尝试安装win8 Ultimate，因为我认为wp8只兼容win 8 RTM。关于wp7，我不知道，但是win 8兼容那些wp7和wp8

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-26T12:54:58.780

最佳解决方案是安装 Windows 8 Pro 或更高版本并安装 WP SDK 8 或 7.1。您可以并排拥有两个 VS 版本。

如果现在无法做到这一点，那么暂时您的问题可能会通过安装[Windows Phone SDK 7.1.1 Update](http://www.microsoft.com/en-us/download/details.aspx?id=29233)来解决。这使得 WP 7.1 SDK 与 Windows 8 兼容并且还增加了对 256MB RAM 设备的模拟器支持。您的屏幕截图表明您没有此 7.1.1 更新。

# jquery - jQuery Ajax：如何指定不同的 div 来更新

> ID：14035980
> 
> 赞同：0
> 
> 时间：2012-12-26T04:23:19.303
> 
> 标签：jquery, ajax

我想在 Ajax 返回数据的第一行添加一些内容，以指定要更新的 div。一个假设的例子如下：

```
$(document).ready(function() {
  $('.submitForm').ajaxForm({
    success: function(returnData) {
      if (firstLineOf(returnData) == 'firstDiv')
          $('#firstDiv').html(returnData(restOfLines));
      else if (firstLineOf(returnData) == 'secondDiv')
          $('#secondDiv').html(returnData(restOfLines));
      else
          $('#thirdDiv').html(returnData(restOfLines)); 
    }
  });
}); 
```

我该怎么做？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-26T05:43:27.877

根据您的需要添加一些代码示例

假设您的 JSON 是

```
[{"targetElement":"div1","HtmlContent":"<div>inner html</div>"}] 
```

jQuery 是

```
 $(document).ready(function() {
  $('.submitForm').ajaxForm({
    success: function(returnData) {
      $(returnData.targetElement).html(returnData.HtmlContent)
    }
  });
}); 
```

希望这会对你有所帮助！

# python - django 简单评分，查询太多

> ID：14035983
> 
> 赞同：3
> 
> 时间：2012-12-26T04:23:57.667
> 
> 标签：python, django, django-ratings

我在我的项目中使用[django-simple-ratings](https://github.com/coleifer/django-simple-ratings)。我将它连接`ratings`到我的`Post`应用程序，因此用户可以投票赞成/反对，然后按分数排序。我想要的几乎都包含在`ratings`应用程序中。有这个页面我需要列出所有的`Post`（就像stackoverflow一样）。但是对于我显示评级的每一个`post`地方`Post`，它都会击中数据库，这会使网站速度变慢。模型.py：

```
from ratings.models import Ratings, RatedItemBase

class PostRatings(RatedItemBase):

    content_object = models.ForeignKey('Post')

class Post(models.Model):

    title = models.CharField(max_length = 200)
    content = models.TextField()
    ratings = Ratings(PostRatings)

for q in Post.objects.all():
    print q.ratings.cumulative_score()
    #or
    print q.postratings_set.aggregate(Sum('score'))['score__sum'] 
```

对于每个循环，它都会命中数据库，再试一次：

```
for q in Post.objects.prefetch_related('postratings_set'):
    print q.postratings_set.aggregate(Sum('score'))['score__sum'] 
```

仍然为每个循环打分贝。

你们中有人有同样的问题吗？你是怎么解决的？或者我应该改用另一个评分应用程序吗？谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-26T04:57:34.630

我怀疑可能`JOIN`存在没有适当索引的类型查询。但是您需要发布或检查 Django ORM 实际执行的查询。只有这样，才能出现优化的解决方案。为此有一个完美的工具[`Django-debug`](https://github.com/django-debug-toolbar/django-debug-toolbar)。

安装此应用程序后，您可以使用`debugsqlshell`. 在这种模式下运行模型会输出在 Python 交互式 shell 中工作时执行的 SQL。例如 -

```
$ ./manage.py debugsqlshell
Python 2.6.1 (r261:67515, Jul  7 2009, 23:51:51)
[GCC 4.2.1 (Apple Inc. build 5646)] on darwin
Type "help", "copyright", "credits" or "license" for more information.
(InteractiveConsole)
>>> from page.models import Page
>>> ### Lookup and use resulting in an extra query...
>>> p = Page.objects.get(pk=1)
SELECT "page_page"."id",
       "page_page"."number",
       "page_page"."template_id",
       "page_page"."description"
FROM "page_page"
WHERE "page_page"."id" = 1 
```

希望这可以帮助...

# javascript - 使用 Reportgrid 作为图形库，如何在折线图的数据点处显示图像而不是形状

> ID：14035985
> 
> 赞同：1
> 
> 时间：2012-12-26T04:24:10.597
> 
> 标签：javascript, graph

我正在使用reportgrid js 图表/绘图工具来显示图表，问题是我不想显示我想要显示图像的节点，还有吗？还是我应该使用其他图书馆？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-31T23:06:27.310

该选项目前正在开发中，并且已经可用于 Sankey。对于支持符号的其他图表，它应该在本周末之前可用。

同时，有一些方法可以解决这个问题，方法是使用 JQuery（或其他库）选择相应的符号节点并用图像节点替换它们。

不幸的是，SVG 不支持使这项壮举变得微不足道的背景图像。

# android - 无法将音频文件附加到三星设备

> ID：14035987
> 
> 赞同：0
> 
> 时间：2012-12-26T04:24:46.277
> 
> 标签：android, android-intent

我无法将音频文件附加到三星 GalaxyS2、Nexus 等三星设备上。我不知道是什么问题。我可以附加所有其他设备。请有人帮我解决这个问题。我的代码是：

```
Intent sendIntent = new Intent(Intent.ACTION_SEND);

            sendIntent.putExtra("sms_body",
                    getResources().getText(R.string.Message));
            sendIntent.setClassName("com.android.mms",
                    "com.android.mms.ui.ComposeMessageActivity");

            AssetManager mngr = getAssets();
            InputStream path = null;
            try {
                path = mngr.open("*.mp3");
            } catch (IOException e) {
                // TODO Auto-generated catch block
                e.printStackTrace();
            }

            BufferedInputStream bis = new BufferedInputStream(path, 1024);

            // get the bytes one by one
            int current = 0;
            //
            try {
                while ((current = bis.read()) != -1) {

                    baf.append((byte) current);
                }
            } catch (IOException e) {
                // /TODO Auto-generated catch block
                e.printStackTrace();
            }
            byte[] bitmapdata = baf.toByteArray();

            File file = new File(Environment.getExternalStorageDirectory()
                    .getAbsolutePath(), "*.mp3");

            // if (file.exists() == true) {
            // } else {
            // Log.v("directory is created", "new  dir");
            // file.mkdir();
            // }

            FileOutputStream fos;

            try {
                fos = new FileOutputStream(file);
                fos.write(bitmapdata);
                fos.flush();
                fos.close();
            } catch (FileNotFoundException e) {
                // handle exception
            } catch (IOException e) {
                // handle exception
            }

            final File file1 = new File(Environment
                    .getExternalStorageDirectory().getAbsolutePath(),
                    "*.mp3");
            Uri uri = Uri.fromFile(file1);

            Log.e("Path", "" + uri);

            sendIntent.putExtra(Intent.EXTRA_STREAM, uri);
            sendIntent.setType("audio/mp3");
            // sendIntent.putExtra(Intent.EXTRA_STREAM, mms_uri.toString());

            startActivity(Intent.createChooser(sendIntent, ""));
            // startActivity(sendIntent);

        } catch (Exception e) {
            Toast.makeText(getApplicationContext(),
                    "SMS faild, please try again later!", Toast.LENGTH_LONG)
                    .show();
            e.printStackTrace();
        } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-26T06:54:40.990

不要通过调用显式设置类名`setClassName()`。[相反，只需按照此处](https://stackoverflow.com/a/10491109/165674)所述设置操作、类型和额外内容。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-16T16:20:47.857

您假设设备上有可用的 ExternalStorage 即 sd 卡。您的 S2 或 Nexus 可能没有 sd 卡。我以前见过这个问题。

# javascript - 如何全局导入一次 ExternalInterface

> ID：14035989
> 
> 赞同：-1
> 
> 时间：2012-12-26T04:25:04.423
> 
> 标签：javascript, flash, externalinterface

我正在开发一个 Flash 项目（网络速度测试），并希望在每个步骤中都使用 ExternalInterface.call() 来与 HTML 页面沟通 Flash 项目现在的步骤。

问题是，在每个场景的动作上，我必须像这样导入 ExternalInterface `import flash.external.*;`，然后这个命令才起作用`ExternalInterface.call('console.log','Upload test FINISHED!');`

谁能告诉我如何在全球范围内**只导入一次ExternalInterface 吗？**

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-26T04:27:53.520

您不能只导入一次。嗯，这只是有点真实。

您可以在其他地方创建一个单例实例（或静态实例）并使用它，但不是在`import flash.external.ExternalInterface`任何地方，而是在任何地方做类似的事情`import myCustomClass`。

由于这样做没有任何好处，我建议您在需要的任何地方导入 flash.external.ExternalInterface。

# python - 如何在 OS X Lion 上维护 Python 包？

> ID：14035991
> 
> 赞同：6
> 
> 时间：2012-12-26T04:25:32.163
> 
> 标签：python, installation, package, osx-mountain-lion

使用 Apple 的内置 Python 在 OS X Mountain Lion 上安装和更新 Python 包的正确方法是什么？

我已经尝试了所有可以在此处和文档中找到的各种软件包的所有内容，但不断遇到各种导致安装或更新失败或中止的错误。值得注意的是，`pip`我经常遇到错误，例如

> RuntimeError：在 cmp 中超出最大递归深度

或者

> SError：[Errno 24] 打开的文件太多：'/Library/Python/2.7/site-packages'

并且某些命令`pip`命令（例如`list`）似乎根本不存在。

我有一个最新版本`pip`，可以很好地与某些软件包配合使用，并且安装了最新的 Xcode 命令行工具。

唯一似乎有效——而且一直有效——是

```
python setup.py install 
```

这是在 Lion 上维护和安装 python 包的正确方法吗？有什么理由*不*使用这种方法作为我保持软件包最新的主要方法吗？应该`pip`为我工作，还是不适用于 Apple 的 Python？

* * *

**更新：**我说得太早了。我也有问题

```
python setup.py install 
```

偶尔（经常）我会得到：

> 错误：/Library/Python/2.7/site-packages：打开的文件太多

当新终端中什么都没有运行时，我得到大约 50

```
lsof | grep python | wc -l 
```

如果我退出 Dropbox，这似乎是这些的来源，并将数字减少到 0，对于大多数软件包安装操作，我仍然会得到“打开的文件过多”，无论我使用什么工具，即使在我的系统重新启动后.

*为什么我经常收到“打开的文件太多”错误？*

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-12T19:59:23.220

您应该能够完全按照您的方式进行维护，但可能需要将您的 PYTHONPATH 更新到 /Library 之外的某个位置，因此其他人都提到这一点和/或使用自制软件安装 python 的原因。

我使用以下方法安装 python 包`pip`并对其进行维护：

[https://github.com/nvie/pip-tools](https://github.com/nvie/pip-tools)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-26T04:29:41.643

首先，从[python 网站](http://python.org/download/)下载并安装完整的 Python 。
然后使用[`pip`](http://dubroy.com/blog/so-you-want-to-install-a-python-package/)（或[`homebrew`](http://mxcl.github.com/homebrew/)）。内置的python在很多方面都不完整，主要包括安装新包的能力。当我拿到我的 MacBookPro 并在内置的上面安装完整的 python 解决了我所有的麻烦时，我遇到了类似的问题

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-12-26T04:31:16.207

为什么要使用 Apple 的内置 Python？我认为它不完整。

我正在使用 Homebrew，`brew install python`对我来说效果很好。

来自[https://github.com/mxcl/homebrew/wiki/Homebrew-and-Python](https://github.com/mxcl/homebrew/wiki/Homebrew-and-Python)：

> 我们建议这样做，`brew install python`因为：
> 
> *   随附`pip`（并分发）
> *   即使没有安装 Xcode 的命令行工具，Python (distutils) 也会查找已编译的软件（包括、库），了解编译器和标志。
> *   无需`PYTHONPATH`为 Homebrew 绑定设置。
> *   无需解决`sudo`-is-needed-for-`easy_install`问题

# android - 使用按钮单击将 EditText 数据发送到预定义的联系人号码

> ID：14035992
> 
> 赞同：0
> 
> 时间：2012-12-26T04:25:53.020
> 
> 标签：android, android-layout, android-intent, android-emulator, android-widget

我制作了一个程序，在其中我正在获取**设备的当前位置**详细信息并在**编辑文本中****显示**，但现在我想**使用 SMS 将设备的当前位置详细信息发送到其他设备**，并且我想**在我的代码中定义其他设备的联系号码****: XXXXXXX9,**

 ******所以请帮助我做到这一点，这对我来说怎么可能......

**回答：**

我在 Nagaraj436 & Appu 的帮助下编写了代码，如下所示：

```
String phoneNumber = "XXXX9";
String message = editLocation.getText().toString();
SmsManager smsManager = SmsManager.getDefault();
smsManager.sendTextMessage(phoneNumber, null, message, null, null);
Toast.makeText(getApplicationContext(), 
                    "Message Sent!", Toast.LENGTH_LONG).show(); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-26T04:32:20.383

```
public void onClick(View v)
{
  sendSMS(yourPhoneNumber,editLocation.getText().toString());
} 
```

在您的按钮单击时编写并调用以下方法。

```
 private void sendSMS(String phoneNumber, String message)
       {
           SmsManager sms = SmsManager.getDefault();
           sms.sendTextMessage(phoneNumber, null, message, null, null);
        } 
```

并使用以下权限。

```
<uses-permission android:name="android.permission.SEND_SMS"></uses-permission> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-26T04:32:21.247

试试这个：

```
SmsManager sms = SmsManager.getDefault();
sms.sendTextMessage(contactNumber, null, message, null, null); 
```

其中 phoneNumber= 您的目的地号码和消息是包含您的位置详细信息的字符串。

根据您的评论：`editLocation.getText().toString()`用于获取您在编辑文本中设置的位置详细信息。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-26T05:01:17.653

> 您可以在此处获得位置的详细信息：

```
private class mylocationlistener implements LocationListener {
    @Override 
    public void onLocationChanged(Location location) {    
     Date today = new Date();  
  Timestamp currentTimeStamp = new Timestamp(today.getTime());  
        if (location != null) {
        Log.d("LOCATION CHANGED", location.getLatitude() + "");
        Log.d("LOCATION CHANGED", location.getLongitude() + "");
        Strig str = "\n CurrentLocation: "+
            "\n Latitude: "+ location.getLatitude() + 
            "\n Longitude: " + location.getLongitude() + 
            "\n Accuracy: " + location.getAccuracy() + 
            "\n CurrentTimeStamp "+ currentTimeStamp;         
          Toast.makeText(LocationSample.this,str,Toast.LENGTH_LONG).show();
          tv.append(str);               
        } 
    } 
```

现在获取 latlong 的值并通过 sms manager 发送值发送

```
SmsManager smsManager = SmsManager.getDefault();
smsManager.sendTextMessage(smsNumber, null, youredittex, null, null); 
```******

# xaml - 在 gridview 中为文本块提供样式

> ID：14035993
> 
> 赞同：0
> 
> 时间：2012-12-26T04:26:07.523
> 
> 标签：xaml, gridview, windows-8

我有一个gridview，里面有很多gridviewitem，每个gridviewitem 都包含一些文本块，我可以一次为所有文本块指定一个样式吗？不一一指定样式？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-26T06:34:18.717

您应该能够利用[对象资源](http://msdn.microsoft.com/en-us/library/windows/apps/windows.ui.xaml.controls.gridview)并隐式命名它。就像是;

```
<GridView>
  <GridView.Resources>
    <Style TargetType="TextBlock">
       <Setter Property="Foreground" Value="Red"/>
       <!-- Etc, etc, etc -->
    </Style>
  </GridView.Resources>
</GridView> 
```

# diff - 本地和 repo 文件之间的图形差异查看器

> ID：14035999
> 
> 赞同：1
> 
> 时间：2012-12-26T04:27:41.207
> 
> 标签：diff, phpstorm, file-comparison

这是我的用例。我想使用差异查看器将我正在处理的本地文件与 repo 文件进行比较。例如

```
file 1 : /path-to-local-file-in-my-computer
file 2 : http://core.svn.wordpress.org/trunk/wp-load.php 
```

是否有任何程序可以比较我机器中的文件和 Internet 中的 repo 文件？我想编辑，与文件相比逐行还原更改。像phpstorm diff查看器之类的东西？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-08T22:19:38.770

如果本地文件*不是*在线存储库的签出，它认为您唯一的选择是下载在线存储库，选择您自己的版本和下载的版本并与 PhpStorm 的比较功能（ctrl +D 或 cmd+D 在 OS X 上）

PhpStorm 还允许您比较两个目录（包括它们的子目录）。这是描述此功能的最新博客文章：

[http://blog.jetbrains.com/webide/2013/02/comparing-files-and-folders-within-your-ide/](http://blog.jetbrains.com/webide/2013/02/comparing-files-and-folders-within-your-ide/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-11T11:10:46.067

如果您只想在计算机上编辑文件，ECMerge（我们的工具）可以做到这一点。只需打开 2-way 合并，在左侧窗格中选择本地文件并将其设置为输出，右侧窗格中的 Web 文件。选择什么是好的（差异突出显示并且可以选择，然后在结果窗格中进一步修改）。保存将更新您在磁盘上的左侧文件，您可以刷新以继续。