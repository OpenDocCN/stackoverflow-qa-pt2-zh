# StackOverflow 问答 13278000-13278999

# java - 在属性/上下文类中封装属性

> ID：13278003
> 
> 赞同：1
> 
> 时间：2012-11-07T20:51:48.967
> 
> 标签：java

我创建了一个`BicycleProducer`具有不同实现的接口：`OffroadBicycleProducer`等等`FastBicycleProducer`。

这些工厂中的每一个都需要许多参数才能生产自行车。我想将这些属性封装在一个类中并将其传递给`produce`方法。然而，自行车需要不同的属性——有些可能是相同的——我想知道如何正确地做到这一点。在我的接口中，`BicycleProducer`我目前有一个名为的方法`produce`，它接受一个参数，该参数`BicycleProducingContext`是一个具有所有公共属性的接口。然后你有实现它的实现，并根据它是什么类型的自行车添加必要的属性。然后你需要在`produce`方法中强制转换它......但我不知道。我觉得这似乎有点狡猾（可能不是）。

这是一个很好的方法还是我应该以另一种方式来做？

```
public interface BicycleProducer {
    void produce(BicycleProducingContext context);
}

public class OffroadBicycleProducer implements BicycleProducer {

    public void produce(BicycleProducingContext context) {
        context = (OffroadBicycleProducingContext) context;
    }
} 
```

和

```
public interface BicycleProducingContext {

    int numberOfBicycles();
    void brand(String brand);
}

public class OffroadBycycleProducingContext implements BicycleProducingContext {

    //..
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-08T01:42:50.133

我发现您提出的设计有两点有点尴尬：

1.  对我来说，看起来您可能根本不需要工厂（即您的`Producer`课程）。当您需要构造一个在编译时类型未知的对象时，工厂非常有用。但是由于您正在考虑为每种类型的自行车（例如`OffroadBicycleProducer`）设置单独的工厂类，我假设您确实知道要提前构建什么样的对象。

2.  使用上下文类使参数传递不那么难看是一个好主意，但是如果您开始为每种类型的自行车创建单独的上下文类，那么您最终会陷入尴尬的境地，即必须知道要构造哪个上下文以及哪些数据它需要 - 如果您拥有所有这些，您不妨跳过中间步骤并`Bicycle`立即构建。

如果我假设您确实知道需要提前构造什么样的对象是正确的，那么我将不使用工厂，而是使用构建器模式，或者使用普通的旧构造器。构造函数方法可能类似于以下内容：

```
public abstract class Bicycle {
    private int year;
    private String color;

    public Bicycle(BicycleProducingContext context) {
        this.year = context.getYear();
        this.color = context.getColor();
    }
}

public class OffroadBicycle extends Bicycle {
    private String terrainType;

    public OffroadBicycle(BicycleProducingContext context) {
        super(context);
        this.terrainType = context.getTerrainType();
    }
}

public class FastBicycle extends Bicycle {
    private int maxSpeed;

    public FastBicycle(BicycleProducingContext context) {
        super(context);
        this.maxSpeed = context.getMaxSpeed();
    }
} 
```

如果在运行时之前不知道`Bicycle`要构造什么类型，那么可以将上述方法与单个工厂一起使用。例如：

```
public class BicycleFactory {
    public static Bicycle constructBicycle(BicycleProducingContext context) {
        if (context.getBicycleType().equals("OffroadBicycle")) {
            return new OffroadBicycle(context);
        } else if (context.getBicycleType().equals("FastBicycle")) {
            return new FastBicycle(context);
        } else {
            throw new IllegalArgumentException("Encountered unrecognized Bicycle type: " + context.getBicycleType());
        }
    }
} 
```

我希望我不会过度简化您的用例，但在我看来，上面的内容应该可以完成您正在寻找的内容。

# querystringparameter - 在查询字符串中添加多个参数

> ID：13278005
> 
> 赞同：0
> 
> 时间：2012-11-07T20:51:57.423
> 
> 标签：querystringparameter

我想知道如何向这个查询字符串添加另一个参数。

```
e.Item.Cells[0].Text = "<a  title=\"Click to see " + 
functions.email.getFullName(e.Item.Cells[0].Text) + 
"'s Pending Requests\" href=\"default.aspx?U=" + e.Item.Cells[0].Text + 
"\">" + functions.email.getFullName(e.Item.Cells[0].Text) + "</a>"; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-07T21:01:14.143

恐怕你的问题似乎有点不清楚。对我来说，看起来您正在将值设置`e.Item.Cells[0].Text=`为字符串。那个字符串本身不是参数吗？如果是，您的意思是您想要将另一个值*连接到它吗？*

包含您设置它的函数也将有所帮助，以获得更多上下文。

# c# - 正则表达式开始结束位置

> ID：13278011
> 
> 赞同：1
> 
> 时间：2012-11-07T20:52:19.847
> 
> 标签：c#, regex

我需要使用正则表达式在带有位置信息的字符串中进行验证。

例子：

```
020005254877841100557810AAAAAA841158891BBBB 
```

我需要将匹配位置 5 直到 10 并且必须只是数字。

如何使用 RegEx 执行此操作？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-11-07T20:55:17.767

嗯，它真的必须是正则表达式吗？我会这样做的。

```
var myString = "020005254877841100557810AAAAAA841158891BBBB";
var isValid = myString.Substring(4, 5).All(Char.IsDigit); 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-11-07T21:07:45.620

如果您绝对必须使用正则表达式，那就是……（尽管我认为您应该使用类似 Jonas W 的答案）。

```
Match m = Regex.Match(myString, "^.{4}\d{5}.*");

if(m.Success){
    //do stuff
} 
```

正则表达式的意思是，“从字符串 (^) 的开头，匹配任何字符 (.{4}) 中的 4 个，然后是五个数字 (\d{5})，然后是任何其他字符 (.*) "

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-07T21:09:40.077

如果你真的觉得你必须使用正则表达式，这将是一个：

```
"^....\d{5}" 
```

您还可以像这样进行多项检查：

```
"^....(\d{5}|\D{5}) 
```

那个将匹配所有数字或所有非数字字符，但不匹配混合或任何带有空格的字符。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-11-07T20:58:12.467

以 FailedDev 提到的内容为基础。

```
string myString = "020005254877841100557810AAAAAA841158891BBBB";
myString.Substring(5, 5); //will get the substring at index 5 to 10.
double Num;
bool isNum = double.TryParse(myString, out Num); //returns true of all numbers 
```

希望有帮助，

# javascript - jQuery 轮询聊天 - 重复条目

> ID：13278012
> 
> 赞同：3
> 
> 时间：2012-11-07T20:52:21.393
> 
> 标签：javascript, jquery, setinterval

这是我的场景：

*   每当用户发送新消息时，我都会将其作为*预览*附加到对话线程中，同时`HTTP POST`请求将其保存到服务器。
*   每隔一段时间，`setInterval`我会使用 来检查对话中的新消息。
*   如果返回任何新消息，我会*删除*消息的预览版本，然后从数据库中附加任何新消息。

这是生成聊天内容的脚本：

```
function refresh_chat(){
    var last = $('.conversation li:not(.fake):last').data('id');
    $.post('includes/router.php', {
        task: 'update_conversation',
        id: '<?=$_GET['conversationid']?>',
        last: last
    }, function (data, response) {
        var recibidas = $(data).find('li');

        /* IF there are new entries */
        if (recibidas.length > 0) {
            /* Remove all fake entries */
            $('.conversation li.fake').remove();

            /* Append new entries */
            $('.conversation').append($(data).filter('.notifications').html());

            /* If this new entries are not unread, 
               remove the unread to the previous ones*/
            if(!$(data).find('li:last').hasClass('unread')) {
                $('.conversation li.unread').removeClass('unread');
            }
        }
    });
}

var t = setInterval(function () {   
    refresh_chat();
}, 3000); 
```

这就是我在用户键入新条目时添加新条目的方式：

```
$('body').on('submit', '.send_message_form_conversation', function(e) {
    e.preventDefault();
    var id_to = $(this).find('#id_to').val();
    var msj = $(this).find('#msj').val();
    if (msj.length >= 2) {
        $(this).find('#msj').val('');
        $(this).find('.nicEdit-main').html('');
        //alert(id_to);
        $('.conversation').append(
            '<li class="unread fake">' +
             '<div class="avatar">' +
              '<a href="index.php?userid=<?=sesion()?>">' +
               '<img alt="" src="<?=$_SESSION['avatar']?>">' +
              '</a>' +
             '</div>' +
             '<div class="txt">' +
              '<a class="userName" href="index.php?userid=<?=sesion()?>">' + 
               '<?=$_SESSION['alias']?> -- ' +
               '<span class="date">' +
                "<?=get_texto_clave('ahora mismo')?>" +
               '</span>' +
              '</a>
             '<span class="msj">' + msj + '</span>' + 
            '</div>' +
            '<span data-id="47" class="close">X</span>' + 
           '</li>');

        $.post('includes/msj.php?', {
            task  : 'post_message',
            id_to : id_to,
            msj   : msj
        }, function (data, response) {
            $(".conversation").scrollTop($(".conversation")[0].scrollHeight);
        });
    } else {
        $(this).parent().effect("shake", { times:0, distance: 3 }, 200);
    }                       
}); 
```

可以看到，`<li>`item可能有两个类：（`.fake`表示这个item是用户刚刚提交的预览，已经被js追加）或者`.unread`（表示接收方刚刚收到消息）

我正在努力解决的问题是，有时我开始看到一些重复的条目（虽然只显示 - 它们在数据库中没有重复）。我猜我的间隔有问题？

这可能是什么原因造成的？（我只是继续阅读它，但我找不到任何奇怪的东西......）

PD：基本上，有些消息不止一次显示：S

-编辑-

```
$q = "SELECT * FROM pms " .
     "WHERE ((id_to = $id and id_from = " . sesion() . ") OR " .
     "       (id_from = $id and id_to = " . sesion() . ")) " .
     "AND (id > $from) " .
     "ORDER by fecha ASC " . $limit; 
```

此查询是`$.post()`请求中使用的查询，其中`$from`JavaScript 参数中的最后一个（代表显示给用户的最后一条消息）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-22T00:54:21.997

想想场景：

1.  refresh_chat() - 请求发送到服务器
2.  3秒过去
3.  refresh_chat() - 发送到服务器的相同请求
4.  第一次收到回复。添加了新条目。
5.  收到第二个回复。再次添加了相同的条目。

解决这个问题的最简单方法是去掉 setInterval，并在处理完响应后添加 setTimeout。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-26T09:20:46.360

当问题出现时，检查您从服务器返回的数据（即 ajax 响应正文）是否也存在“旧”数据。如果是这种情况，您必须调试您的查询。

此外，您的数据库查询很容易受到 SQL 注入攻击[http://en.wikipedia.org/wiki/SQL_injection](http://en.wikipedia.org/wiki/SQL_injection) （例如，最后提供值为：x'；DROP TABLE pms；--）

```
 $q = "SELECT * FROM pms " .
 "WHERE ((id_to = $id and id_from = " . sesion() . ") OR " .
 "       (id_from = $id and id_to = " . sesion() . ")) " .
 "AND (id > $from) " .
 "ORDER by fecha ASC " . $limit; 
```

最后，投票似乎并不是实现聊天应用程序的最佳方式。也许套接字和轮询（如果浏览器不支持套接字）的组合会更好。最佳C

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-24T20:22:50.277

试试 Socket.io！即使您将消息发送到服务器，在那里对其进行解析和转换并将其发送回，也不会出现任何明显的延迟，因此无需进行预览。

将 Ajax 和 setTimeout 用于聊天应用程序只会给您带来痛苦。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-27T13:47:42.673

A few points, the 'unread' class doesn't seem to do much. You're auto refreshing anyways, when is a private message read or unread? If someone closes the chat and goes back later should they get all of their messages or just the newest ones? Just things to think about...

You bug is likely because you use setInterval and resend the same request here's some code that corrects the issue. Notice the use of the "last_id" variable to stop repeated requests, as well as, calling setTimeout only after processing has completed.

I would suggest you use long polling or comet for your chat. [Comet, long polling with jquery tutorial](https://stackoverflow.com/questions/3940732/comet-long-polling-with-jquery-tutorial) If you want to be really cutting edge go with HTML5 WebSockets, but you'll have to do some server configuration.

```
function refresh_chat(){
    var last = $('.conversation li:not(.fake):last').data('id');
    if(last_id == last) {
        /* this request was already successfully processed */
        /* wait some more and try again */
        if(auto_refresh) window.setTimeout(refresh_chat, 3000);
        return;
    }
    $.ajax({
    type: 'POST',
    url: 'includes/router.php',
    data: { task: 'update_conversation',id: '<?=$_GET['conversationid']?>',last: last },
    success: function(data) {
        var recibidas = $(data).find('li');
        /* IF there are new entries */
        if (recibidas.length > 0) {
            last_id = last;
            /* Remove all fake entries */
            $('.conversation li.fake').remove();
            /* Append new entries */
            $('.conversation').append($(data).filter('.notifications').html());
        }
        //
        if(auto_refresh) window.setTimeout(refresh_chat, 3000);
    },
    error: function(jqXHR, textStatus, errorThrown) {
        console.log("Ajax Error: " + (textStatus||""));
        //
        if(auto_refresh) window.setTimeout(refresh_chat, 3000);
    }
    });
}
var auto_refresh = true;
var last_id = -1;
refresh_chat(); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-11-07T21:08:19.687

我认为这是因为如果要显示新条目，您只是在“隐藏”假条目：

```
if(recibidas.length>0){
    $('.conversation li.fake').remove(); 
```

我建议将其从 if 语句中删除。似乎您应该`remove()`在发布新消息后拥有，就像在您`function(data,response){`的提交功能中一样。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-11-27T12:45:51.487

正如@zch 指出的那样，您的实际方法可能会引发此问题。

我建议2种方法：

1.- 就在调用 refresh_chat() 之前，将最后一个帖子中止到服务器。通过这样做，如果在这 3 秒后响应没有发送到浏览器（或服务器根本没有响应），则您放弃最后一次尝试，并再次发送请求。这不是最好的方法，因为服务器资源可能会被永远不会采取的响应所浪费。

2.-尝试制作一个循环计数器（如从0到10），随着每个请求递增并发送它，并让服务器将其发送回来，然后丢弃任何不重合的响应。像这样的东西：

```
Request with 0 -> Response with 0
Request with 1 -> Response with 1
Request with 2 -> (no response)
Request with 3 -> Response with 2 (Discarded as it doesn't match)
Request with 4 -> (no response yet)
           -> Response with 3 (Discarded as 4 is already sent)
           -> Response with 4 (Accepted, actual Request was with 4) 
```

希望您觉得这个有帮助。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-11-27T10:45:29.097

您遇到的问题与每 3000 毫秒`setInterval`安排一次新的`refresh_chat`函数执行有关，无论当前是否正在进行执行。

相反，您应该做的是简单地`refresh_chat`自己调用一次，然后在内部回调函数的最底部（当有数据从服务器返回时调用的那个），添加一个`setTimeout(refresh_chat, 3000)`.

这将确保客户端在`refresh_chat`您知道它已完成其工作之前不会尝试安排对该函数的新调用。

将其视为某种延迟递归调用（尽管从技术上讲，它不是一个，因为调用堆栈不会不断增加）。

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2012-11-24T19:36:39.793

这个 ajax 聊天根本不是解决方案。[你需要读这本书](http://professionalxmpp.com/)。如果您没有 jabber 服务器，我会给您访问权限（用户注册更新等）。看书，然后联系我。这是 XMPP + Strophe 库聊天（谷歌和 Facebook 正在使用的）！所以最好重新开始学习新的东西，然后在 ajax 聊天中修复错误！

# javascript - 从 chrome 中的 HTML5 input[type="date"] 获取输入值

> ID：13278016
> 
> 赞同：6
> 
> 时间：2012-11-07T20:52:51.717
> 
> 标签：javascript, html, google-chrome

在 chrome 中，像这样的标签

```
<input id="picker" type="date"> 
```

呈现为文本字段。然而，调用试图通过类似的东西来获得它的价值

```
$("#picker").val() 
```

在输入或从下拉列表中选择有效日期之前，不返回任何内容。我在按键上查看了对象的所有直接属性

```
$("#picker").keypress(function() {
    var output = ""
    for (var i in this) {       
        output += i +" value:"+ this[i] + "\n";
    }
    alert(output);
});​ 
```

但在其中任何一个中都看不到我的输入。[在http://jsfiddle.net/5cN2q/](http://jsfiddle.net/5cN2q/)检查自己

我的问题是：当输入不是有效日期时，是否可以从 chrome 中的 input[type="date"] 获取文本？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-07T21:08:17.293

[W3C 日期状态规范](http://www.w3.org/TR/html5/states-of-the-type-attribute.html#date-state-%28type=date%29)定义了清理算法：

> *   值清理算法如下：如果元素的值不是有效的日期字符串，则将其设置为空字符串。

每当设置输入元素的值时都会调用它，如[DOM 输入值规范](http://www.w3.org/TR/html5/common-input-element-apis.html#dom-input-value)中所定义：

> *   在获取时，它必须返回元素的当前值。设置时，必须将元素的值设置为新值，将元素的脏值标志设置为 true，**调用值清理算法**，如果元素的类型属性的当前状态定义为 1，然后，如果元素具有文本输入光标位置，应该将文本输入光标位置移动到文本字段的末尾，取消选择任何选定的文本并将选择方向重置为无。

因此，`value`当日期无效时，该属性将始终为空字符串。似乎没有指定“原始/脏/用户键入的文本值”的任何属性，因为它毕竟不是文本输入。

IMO 这是一件好事，它有助于表单验证，因为无效日期被视为虚假值（空字符串），它还让浏览器更自由地实现日期输入的 UI。

如果您更喜欢非 W3C 日期输入，则可以使用带有良好的旧 JS 日期验证和日期选择器的文本输入，例如[jQuery UI datepicker](http://jqueryui.com/datepicker/)。这将允许您检索输入的实际文本值，并且也是一个更跨浏览器的解决方案。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2014-06-06T12:01:56.403

作为[另一个答案](https://stackoverflow.com/a/13278250/2792078)，您看不到原始值，但是您可以使用`ValidityState`

```
<script type="text/javascript">
function submitform()
{
  var inputdate = document.getElementById("inputdate")
  // check if date is valid.
  // you can use `inputdate.validity.valid` too.
  if(inputdate.validity.badInput) {
    // error message from the browser
    document.getElementById("message").innerHTML = inputdate.validationMessage
  }
  //document.myform.submit();
}
</script>

<div>message: </div><div id="message" style="color: red; font-weight:bold;"></div>
<form method=post action="./post">
  <input type="date" id="inputdate" value="2016-02-29">
  <a href="javascript: submitform()">get date!</a>
</form> 
```

如果您将日期更改为 30 并单击该链接，您将看到一条错误消息。

好好享受。

# java - 尝试在 xml 布局中使用自定义视图时出现运行时 InflateException

> ID：13278017
> 
> 赞同：2
> 
> 时间：2012-11-07T20:52:55.757
> 
> 标签：java, android, xml, layout-inflater

我一直在阅读很多类似的问题，试图找到解决方案，但没有运气。

MainActivity.java

```
public class MainActivity extends Activity {

@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    requestWindowFeature(Window.FEATURE_NO_TITLE);
    getWindow().setFlags(WindowManager.LayoutParams.FLAG_FULLSCREEN, WindowManager.LayoutParams.FLAG_FULLSCREEN);
    setContentView(R.layout.game);
} 
```

游戏.xml

```
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
xmlns:tools="http://schemas.android.com/tools"
android:layout_width="match_parent"
android:layout_height="match_parent" >
<View
    android:id="@+id/adView"
    android:background="@drawable/ad"
    android:layout_width="320dp"
    android:layout_height="50dp"
    />

<my.package.MainGamePanel
    android:id="@+id/gameView"        
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"
    /> </RelativeLayout> 
```

MainGamePanel.java

```
public class MainGamePanel extends SurfaceView implements SurfaceHolder.Callback {

private MainThread thread;

public MainGamePanel(Context context, AttributeSet a) {
    super(context, a);
    View.inflate(context, R.layout.game, null);
    onFinishInflate();
    thread = new MainThread(getHolder(), this);
    setFocusable(true);
    thread.setRunning(true); 
```

等等等等

然后在 MainGamePanel 构造函数之外是函数：

```
@Override
protected void onFinishInflate() {
    getHolder().addCallback(this);
} 
```

还有一个 MainThread.java 文件，但我认为这不是问题。

这是运行时异常：

```
java.lang.RuntimeException: Unable to start activity ComponentInfo{my.package/my.package.MainActivity}: android.view.InflateException: Binary XML file line #13: Error inflating class my.package.MainGamePanel 
```

如果我将`setContentView`in更改`MainActivity`为`setContentView(new MainGamePanel(this))`并`AttributeSet`从构造函数中删除参数，然后删除`View.Inflate(context, R.layout.game, null);`，那么它可以工作，但我想弄清楚如何在 xml 文件中使用自定义视图。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-08T14:53:32.293

看起来您正在循环膨胀布局。你在 R.layout.game 上设置ContentView，它包含一个 MainGamePanel，它膨胀 R.layout.game，它包含一个 MainGamePanel 等。

您应该从 onCreate 方法中取出 View.inflate 行。据我所知，它什么也没做。你也不应该明确调用`onFinishInflate`. 当 MainGamePanel 实例的膨胀实际完成时，它将自动调用。

# android - 创建线性布局时出现 NullPointerException

> ID：13278024
> 
> 赞同：1
> 
> 时间：2012-11-07T20:53:24.820
> 
> 标签：android, android-layout, nullpointerexception, android-linearlayout

我的代码给了我一个 NullPointerException 并且我已经阅读了[建议进行清理和重建的帖子，](https://stackoverflow.com/questions/8204130/strange-nullpointerexception-when-trying-to-retrieve-linearlayout)但到目前为止这种方法对我没有帮助。

我的堆栈跟踪如下：

```
E/AndroidRuntime(553): FATAL EXCEPTION: main
E/AndroidRuntime(553): java.lang.RuntimeException: Unable to start activity ComponentInfo{com.example.touchlogger/com.example.touchlogger.MainActivity}: java.lang.NullPointerException
E/AndroidRuntime(553):  at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1956)
E/AndroidRuntime(553):  at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:1981)
E/AndroidRuntime(553):  at android.app.ActivityThread.access$600(ActivityThread.java:123)
E/AndroidRuntime(553):  at android.app.ActivityThread$H.handleMessage(ActivityThread.java:1147)
E/AndroidRuntime(553):  at android.os.Handler.dispatchMessage(Handler.java:99)
E/AndroidRuntime(553):  at android.os.Looper.loop(Looper.java:137)
E/AndroidRuntime(553):  at android.app.ActivityThread.main(ActivityThread.java:4424)
E/AndroidRuntime(553):  at java.lang.reflect.Method.invokeNative(Native Method)
E/AndroidRuntime(553):  at java.lang.reflect.Method.invoke(Method.java:511)
E/AndroidRuntime(553):  at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:784)
E/AndroidRuntime(553):  at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:551)
E/AndroidRuntime(553):  at dalvik.system.NativeStart.main(Native Method)
E/AndroidRuntime(553): Caused by: java.lang.NullPointerException
E/AndroidRuntime(553):  at android.view.ViewGroup.addViewInner(ViewGroup.java:3336)
E/AndroidRuntime(553):  at android.view.ViewGroup.addView(ViewGroup.java:3208)
E/AndroidRuntime(553):  at android.view.ViewGroup.addView(ViewGroup.java:3188)
E/AndroidRuntime(553):  at com.android.internal.policy.impl.PhoneWindow.setContentView(PhoneWindow.java:270)
E/AndroidRuntime(553):  at com.android.internal.policy.impl.PhoneWindow.setContentView(PhoneWindow.java:260)
E/AndroidRuntime(553):  at android.app.Activity.setContentView(Activity.java:1855)
E/AndroidRuntime(553):  at com.example.touchlogger.MainActivity.onCreate(MainActivity.java:30)
E/AndroidRuntime(553):  at android.app.Activity.performCreate(Activity.java:4465)
E/AndroidRuntime(553):  at android.app.Instrumentation.callActivityOnCreate(Instrumentation.java:1049)
E/AndroidRuntime(553):  at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1920) 
```

我的 XML 文件如下：

```
<com.example.touchlogger.DrawView
    android:id="@+id/drawView1"
    android:layout_width="wrap_content"
    android:layout_height="357dp" />

<Button
    android:id="@+id/button1"
    android:layout_width="160dp"
    android:layout_height="49dp"
    android:layout_gravity="center|center_vertical"
    android:layout_marginBottom="29dp"
    android:text="End" />

</LinearLayout> 
```

导致错误的行是：

```
setContentView((LinearLayout)(findViewById(R.id.layout))); 
```

我是 Android 编程新手，即使问题很简单，恐怕它对我来说根本没有任何意义。我在这上面花了两天多的时间，我完全迷失了。我的代码一直在运行，直到我决定在 drawView 中包含一个按钮。这就是它有点搞砸的地方。从那以后我就一直遇到问题。

任何帮助将不胜感激！提前致谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-07T20:58:16.620

它不起作用，因为您在调用该`findViewById()`方法之前调用了该方法`setContentView()`，因此它将搜索尚未创建的视图。改用这个：

```
setContentView(R.layout.my_xml_file); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-07T21:02:26.253

看起来您正在尝试组合两个不兼容的步骤。第一步是告诉系统要扩充和显示哪个 XML 文件，因此您要按照其他人的建议进行操作：

```
setContentView(R.layout.xml_layout_filename); 
```

然后，获取按钮或其他控件的第二步`DrawView`，使用类似

```
Button button = (Button)findViewById(R.id.button1);
DrawView drawView = (DrawView)findViewById(R.id.drawView1); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-07T20:55:42.090

这应该是：

```
setContentView(R.layout.your_xml_file_name_here); 
```

# expressionengine - Stash：条件内容

> ID：13278027
> 
> 赞同：6
> 
> 时间：2012-11-07T20:53:37.710
> 
> 标签：expressionengine, expressionengine-stash

首先，需要注意的是……我是 Stash 的新手。我听说过很多，但这是我第一次真正玩它。我明白了这个概念，但是很难弄清楚这件事。

我有一个主“包装器”文件，该包装器中的所有内容都保持不变。但是，我希望该选项能够在需要时打开和关闭侧边栏。

我不认为我需要一个完全独立的布局包装器吗？

有没有办法在存储中使用布尔变量？（例如 2col=TRUE）还是我想错了？

在此先感谢您的帮助！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-07T21:00:50.427

一般来说，我在这里要做的是在包装器中设置多个 Stash 。然后在您的个人模板中，您可以设置侧边栏和主要内容区域。对于您可能重复内容的部分，例如侧边栏的打开和关闭 div，您始终可以将一些片段放入存储中。

您还可以使用`exp:stash:not_empty` [[docs]](https://github.com/croxton/Stash#expstashnot_empty)在包装器中包装侧边栏的 div 或容器。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-08T00:13:13.813

我通常为每个模板使用一个包装器。它将包含一个`{exp:stash:get name="content"}`标签，就像你的一样，其中包含唯一的可变内容。

在我的个人模板中，我在开始时使用常规 EE embed 嵌入了包装器，即。`{embed="includes/wrapper"}`. 然后我使用标签
存储要插入到包装器中的内容。 无论如何，这似乎是您正在做的事情。`{exp:stash:set name="content"}`

如果我想有条件地显示一个侧边栏，我可能只是将一个变量传递给嵌入。
例如。`{embed="includes/wrapper" show_sidebar="yes"}`

在我的包装中，我会这样做：

```
{if embed:show_sidebar}
  Sidebar stuff.
{/if} 
```

# css - 窗口调整大小时嵌套的div父重叠子

> ID：13278028
> 
> 赞同：1
> 
> 时间：2012-11-07T20:53:39.623
> 
> 标签：css, resize, overlapping, html

调整浏览器窗口大小时，内容 div 与徽标 div 重叠。有什么解决办法吗？我希望在调整窗口大小时调整徽标大小。

```
@charset "utf-8";
/* CSS Document */

html, body {
    background-color:#ffffff;
    margin:0;
    padding:0;
    height:100%;
    width:100%;
}

#content {
    height:74%;
    background-color:#7d6961;
    width:100%;
    position:relative;
    top: 10%;
}

#logo {
    background-image:url(logo.png);
    background-repeat:no-repeat;
    position:absolute;
    left: 9%;
    top: 5%;
    right: 2%;
    bottom: 21%;
    width: 77%;
    height: 65%;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-07T21:14:07.267

您必须使用来自 window-DOM 对象的调整大小回调。

```
$(window).resize(function () {
    var _width = $(window).width(),
        _height = $(window).height();

    console.log('width: ' + _width);
    console.log('height: ' + _height );
});​ 
```

查看这个 jsfiddle 的实现示例（我将徽标放入 img-Tag，因此它始终完全可见）：http: [//jsfiddle.net/qY3kM/](http://jsfiddle.net/qY3kM/)

完全通过 css 动态调整图像大小是不可能的（afaik...也许通过使用 css 表达式，但它们很丑陋，根本不应该使用。）。也有用于动态调整大小的 jquery 插件，但我从来没有使用过，所以我不能推荐一个。

# c# - Datagrid RowDetails 未更新

> ID：13278040
> 
> 赞同：5
> 
> 时间：2012-11-07T20:54:23.230
> 
> 标签：c#, wpf, xaml, mvvm, wpfdatagrid

`RowDetailsTemplate`在修改 a`DataGrid`绑定到的集合（“项目”）时，我在获取更新时遇到问题。正在从视图模型中修改集合。当我修改其中一个绑定项的*内容*时，DataGridRow 和 RowDetailsTemplate 中的更改都会更新。例如

```
Items[i].Name = "new name";  // RowDetailsTemplate gets updated 
```

**但是**，如果我将其中一项分配给一个全新的对象，则 DataGridRow 会更新，但 RowDetailsTemplate 不会更新。例如

```
Items[i] = new Model {Name = "new name"};  // RowDetailsTemplate NOT updated 
```

一开始我唯一想到的是，我需要为绑定的 Items 的 CollectionChanged 事件添加一个侦听器，并显式地引发一个属性更改通知。例如

```
Items = new ObeservableCollection<Model>();
Items.CollectionChanged += (o,e) => OnNotifyPropertyChanged("Items"); 
```

但这没有用。

我的 XAML 绑定如下所示：

```
<DataGrid DataContext="{StaticResource viewmodel}" 
          ItemsSource="{Binding Items, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged, NotifyOnTargetUpdated=True, NotifyOnSourceUpdated=True}">
  <DataGrid.RowDetailsTemplate>
    <DataTemplate>
      <TextBlock Text="{Binding Name, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged, NotifyOnTargetUpdated=True, NotifyOnSourceUpdated=True}"/>
    </DataTemplate>
  </DataGrid.RowDetailsTemplate>
</DataGrid> 
```

为什么`DataGridRow`通知更改的项目而不是`RowDetailsTemplate`？！

**更新** 执行删除/添加而不是修改集合的工作。例如

```
Items.Remove(Items[i]);
Items.Add (new Model {Name = "new name"});  // RowDetailsTemplate updated OK 
```

（哦，模型类当然实现了`INotifyPropertyChanged`。）

似乎这可能是我需要刷新详细信息视图的 DataContext 的问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-07T21:01:03.433

为什么你不能：

```
Items.RemoveAt(i);
Items.Insert(i,(new Model {Name = "new name"}); 
```

会有同样的效果。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-02-26T13:22:06.677

我不得不在 CellEditEnding 处理程序代码中插入这样一个肮脏的黑客：

```
DataTemplate temp = ProfileDataGrid.RowDetailsTemplate;
ProfileDataGrid.RowDetailsTemplate = null;
ProfileDataGrid.RowDetailsTemplate = temp; 
```

行得通，Row Detail 更新了，但我也想知道大师们是如何更新 RowDetails 的。

# java - 如何在漫长的过程中让 JScrollPane 更新

> ID：13278045
> 
> 赞同：1
> 
> 时间：2012-11-07T20:54:59.123
> 
> 标签：java, swing

我有一个包含 JTextArea 对象的 JScrollPane。在这个特定的应用程序中，JTextArea 充当“​​进程控制台”，因此人们可以看到长时间运行的进程发生了什么。我的代码如下所示：

```
JTextArea console;

...

// Initializes the console panel, including creation of the JTextArea and JScrollPane
private void initializePanel() {
    JPanel consolePanel = new JPanel();
    ...
    console = new JTextArea();
    console.setEnabled(false);
    textAreaScrollPane = new JScrollPane(console);
    ...
}

// Appends an incoming message to the console
@Override
public void update(Observable observable, Object consoleMessage) {
    console.append(consoleMessage + "\n");
    console.update(console.getGraphics());
} 
```

我遇到的问题是我的 JScrollPane 不是以滚动条开头的。当文本被附加到底层 JTextArea 时，它会离开 JScrollPane 的底部。不幸的是，滚动条直到长时间运行的过程完成后才会出现。此时，滚动条突然出现，视图跳转到 JTextArea 的最末端。

因此，应用程序看起来像是被冻结了，因为更多消息位于 JScrollPane 的当前视口之外。

我尝试了不同的代码组合来尝试让 JSrollPane 在每次写入消息时重新绘制，但没有这样的运气。JTextArea 获取消息并在收到消息后立即打印 - 实际上是 JScrollPane 没有立即添加滚动条是有问题的。

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-07T22:11:02.787

Mrpyo 的评论很到位。我生成了第二个线程（使用 SwingWorker）来执行长时间运行的过程，从而释放用户线程来执行 UI 更新。

我必须添加的一件事是强制 JScrollPane 始终滚动到底部。我通过简单地调用来做到这一点

```
console.selectAll(); // console is my JTextArea object 
```

因为我的 JTextArea 对象未启用，所以调用 selectAll() 实际上不会导致选择任何内容，但它确实具有将 JScrollPane 滚动到最后的副作用。这不是一个优雅的解决方案，因此，如果有人有更好的解决方案，我会全力以赴 - 但它确实有效。

谢谢，先生！

垃圾神提供的链接把我带到了这里：

[http://docs.oracle.com/javase/tutorial/uiswing/concurrency/index.html](http://docs.oracle.com/javase/tutorial/uiswing/concurrency/index.html)

...这变成了有关如何正确执行此并发的重要资源。

# python - 如何知道 python 使用 random.choice 选择哪个列表

> ID：13278049
> 
> 赞同：-3
> 
> 时间：2012-11-07T20:55:25.280
> 
> 标签：python, list, random, choice

我想知道 python 选择哪个列表，`random.choice`以便我可以使用`if`语句来获得不同的结果。

```
thelists = [L1, L2, L3, L4, L5, L6]
theplayers = random.choice(thelists) 
```

我想知道选择了哪个列表，L1，L2...，变量 theplayers 是。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-07T21:12:37.323

为什么不[`random.randint`](http://docs.python.org/2/library/random.html#random.randint)改用，这样以后就不用用`list.index`查找列表了：

```
from random import randint

# your list of lists
l = [[1,2,3],[4,5,6],[7,8,9]]
# choose a valid *index* into l, at random
index = randint(0,len(l) - 1)
# use the randomly chosen index to get a reference to the list
choice = l[index]

# write your conditionals which handle different choices
if index == 1:
    print 'first list'
elif index == 2:
    print 'second list'
... 
```

这将比使用`random.choice`然后`list.index`每次做出选择时更有效。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-07T20:56:17.547

非常简单：

```
 res = random.choice(my_list) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-07T20:59:03.240

看看[文档](http://docs.python.org/3.3/library/random.html#random.choice)：

> `random.choice(seq)`
> 
> 从非空序列中返回一个随机元素 `seq`。如果`seq`为空，则提高`IndexError`.

这`seq`是你的清单。

您可以通过以下方式获取所选元素的索引：

```
thelists.index(theplayers) 
```

# sql - SQL 百分位数计算

> ID：13278051
> 
> 赞同：0
> 
> 时间：2012-11-07T20:55:35.300
> 
> 标签：sql, sql-server, percentile

我有以下查询，即使没有大量数据（约 3k 行），执行起来仍然有点慢，而且逻辑有点过头了——希望能得到一些帮助来优化查询甚至替代方法：

```
Select companypartnumber, (PartTotal + IsNull(Cum_Lower_Ranks, 0) ) / Sum(PartTotal) over() * 100 as Cum_PC_Of_Total
FROM PartSalesRankings PSRMain
Left join 
    (
        Select PSRTop.Item_Rank, Sum(PSRBelow.PartTotal) as Cum_Lower_Ranks
          from partSalesRankings PSRTop
          Left join PartSalesRankings PSRBelow on PSRBelow.Item_Rank < PSRTop.Item_Rank
         Group by PSRTop.Item_Rank 
    ) as PSRLowerCums on PSRLowerCums.Item_Rank = PSRMain.Item_Rank 
```

PartSalesRankings 表简单地由 CompanyPartNumber(bigint) 组成，它是零件编号指定，PartTotal(decimal 38,5) 是总销售额，以及 Item_Rank(bigint) 是基于总销售额的项目排名。

我试图根据零件的百分位数将零件分类 - 所以“A”项目将是前 5%，“B”项目将是接下来的 15%，“C”项目将是较低的第 80 个百分位。我创建的视图运行良好，执行只需要近三秒钟，就我的目的而言，这非常慢。我将瓶颈缩小到上述查询 - 任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-07T21:11:55.250

您遇到的问题是计算`PartTotal`. 如果您使用的是 SQL Server 2012，则可以执行以下操作：

```
select (case when ratio <= 0.05 then 'A'
             when ratio <= 0.20 then 'B'
             else 'C'
        end),
       t.*
from (select psr.companypartnumber,
             (sum(PartTotal) over (order by PartTotal) * 1.0 / sum(PartTotal) over ()) as ratio
      FROM PartSalesRankings psr
     ) t 
```

SQL Server 2012 还具有百分位函数和其他早期版本中没有的函数。

在早期版本中，问题是如何有效地获得累积和。您的查询可能与可以在一个查询中完成的任何事情一样好。创建partSalesRankings时可以计算累计和吗？可以使用临时表吗？

# com - 如何在网络共享上打开 Lotus Notes 数据库？

> ID：13278055
> 
> 赞同：0
> 
> 时间：2012-11-07T20:55:53.393
> 
> 标签：com, lotus-notes

我正在尝试通过 C# 与 Notes 数据库（我的个人邮件文件）进行交互，并且被卡在大门外，试图使用以下代码打开数据库：

```
 string sNotesSourceFolder = "$Inbox";
        string sUserName = "scady";
        string sMailFile = @"NotesMail_FDrive\ARchives\" + sUserName + ".nsf";         
        string sServerName = @"Answers1/Answers";
        string sPassword = "xxxxxx";

        //Creating the notes session 
        NotesSession session = new NotesSession();
        session.Initialize(sPassword);
        NotesDatabase NotesDb = session.GetDatabase(sServerName, sMailFile, false);

        //If the database is not already open then open it. 
        if (!NotesDb.IsOpen)
        {
            NotesDb.Open();
        } 
```

使用服务器名称和路径调用 session.GetDatabase()，nsf 文件返回 null，这显然意味着它无法打开数据库。

我在本地运行此代码，针对名为“Answers1/Answers”的 Notes 服务器。我现在正在考虑基于从 Notes 服务器，nsf 文件位于“NotesMail_FDrive\ARchives\xyz.nsf”的网络文件共享上。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-07T22:03:55.307

对不起，我在第一次通过时没有注意到这一点...

sMailFile 的值不应为“\10.10.10.71\notesdata1\NotesMail\ARchives\scady.nsf”。您注释掉的其他两个值也是错误的。getDatabase 的参数是 Domino 服务器的专有名称和相对路径。没有服务器 IP，没有卷，也没有“文件：”前缀。就像这样：`"archives\scady.nsf"`。当您在 Notes 客户端中打开数据库并调出数据库属性对话框时，它应该与您看到的路径完全相同。

**上一个答案**

您的 sServername 变量应该包含 Domino 服务器的专有名称。

但是你为什么要使用 File.Exists？Domino 服务器希望独占访问其数据树中的所有文件。如果您实际上通过文件系统调用成功地访问了 Domino 服务器上的文件，那么您可能正在锁定 Domino 服务器而无法访问它。

而且：你在哪里运行这段代码？您是否在同一台计算机上运行它，并且使用您通常用来阅读电子邮件的同一帐户？还是在不同的计算机和帐户上？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-08T16:19:44.710

文件所在的服务器是 Notes 服务器还是只是网络共享？

如果它是网络共享，则需要驱动器映射，但 sServerName 将是“”以获取“本地”驱动器。我假设 Notesdata1 是 X 上的一个目录，所以如果它是驱动器名称，请将其删除。

```
string sMailFile = @"X:\Notesdata1\NotesMail\ARchives\scady.nsf";
string sServerName = @""; 
```

如果它是 Notes 服务器并且 Notesdata1 是 Notes 服务器的数据目录，则

```
string sMailFile = @"NotesMail\ARchives\scady.nsf";
string sServerName = @"Answers1/Answers"; 
```

# debugging - Chrome 控制台调试坏了？

> ID：13278057
> 
> 赞同：4
> 
> 时间：2012-11-07T20:55:59.450
> 
> 标签：debugging, google-chrome, console, inspector

随着 Chrome 更新到 2.3 版，我遇到了以下问题。当 ik 调试类似

```
console.log($('canvas')) 
```

我通常会在控制台中返回一些代码（在本例中为 html），我可以将其悬停在上面，因此该对象在 HTML 中突出显示。现在我得到了这个：

```
[<canvas>, <canvas>, <canvas>, prevObject: jQuery.fn.jQuery.init[1], context: #document, selector: "canvas"] 
```

有没有可以改回来的设置，所以我可以在 HTML 页面中通过悬停获得正常的 html？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-07T21:10:31.627

JQuery 是 javascript 语言的扩展`Array`，或者说是 javascript 语言——JQuery 的原型是 Array。因此，当您使用它时`$('canvas')`，它需要一组文档元素。解决方案是调试元素本身，使用如下代码：

```
console.debug($('canvas')[0]); // or other index if there is more than one elements is collected 
```

# sql - 日期部分上的 SQL Server LIKE 不适用于时间元素

> ID：13278058
> 
> 赞同：0
> 
> 时间：2012-11-07T20:56:02.130
> 
> 标签：sql, sql-server

我正在尝试返回表中具有特定日期但也具有特定小时的行。

目前，我可以使用以下方法很好地处理查询的日期部分：

```
CONVERT(VARCHAR(25), col1, 126) LIKE '2012-11-05%' 
```

这完美地工作并返回 col1 值为 11 月 5 日的所有行。但是，当我还想像这样将小时添加到末尾时：

```
CONVERT(VARCHAR(25), col1, 126) LIKE '2012-11-05 15%' 
```

该查询不返回任何行，即使有些行的小时数设置为 15。

看起来查询的时间元素需要某种不同的语法？我只是想知道是否有人可以证实这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-08T01:42:47.140

在 SQL Server 中：

```
create table #test(part varchar(10),lastTime datetime)
go

insert into #test (part ,lastTime )
values('A','2012-11-05 10:30')

insert into #test (part ,lastTime )
values('B','2012-11-05 15:00')

insert into #test (part ,lastTime )
values('A','2012-11-05 16:15')

go 
```

select * from #test where CONVERT(varchar,lastTime,126) like '2012-11- **05T15** %' ----OK

```
B   2012-11-05 15:00:00.000 
```

select * from #test where CONVERT(varchar,lastTime, **21** ) like '2012-11-05 15%' ----OK

```
B   2012-11-05 15:00:00.000 
```

select * from #test where CONVERT(varchar,lastTime,21) like '2012-11-05 %15%' -- 有错误

```
B   2012-11-05 15:00:00.000
A   2012-11-05 16:15:00.000 
```

考虑性能：

```
select * from #test where lastTime  >= CONVERT(datetime, '2012-11-05 15:00:00') and lastTime  < CONVERT(datetime, '2012-11-05 16:00:00') 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-07T20:59:12.857

```
CONVERT(VARCHAR(25), col1, 126) LIKE '2012-11-05T15%' 
```

[http://msdn.microsoft.com/en-us/library/ms187928.aspx](http://msdn.microsoft.com/en-us/library/ms187928.aspx)

格式 126 返回 ISO8601 yyyy-mm-ddThh:mi:ss.mmm（无空格）

# axapta - 如何清理 INVENTDIM 表？

> ID：13278060
> 
> 赞同：0
> 
> 时间：2012-11-07T20:56:04.897
> 
> 标签：axapta

在 AX2009 中，存在清理不属于任何事务的未使用库存维度的过程。

我可以在 AX4 中执行这样的过程吗，其中 INVENTDIM 表现在有 2000 万多条记录。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-12T13:52:53.600

没有这样的标准流程。

勇敢的人可能会这样做：

```
InventDim.skipDeleteActions(true);
InventDim.skipDeleteMethod(true);
delete_from InventDim
    notexists join InventTrans
        where InventTrans.inventDimId == InventDim.inventDimId; 
```

这将删除项目交易未引用的任何记录。不幸的是，可能存在其他参考。

您可以尝试降级 AX 2009 流程。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-13T00:35:58.070

如果没有这样的标准流程，您可以尝试以下方法。

1.  编写一个作业来识别所有表中的所有`InventDimId`（+`ReqCovInventDimId`等）字段。
2.  `InventDimId`编写作业或 SQL 查询以使用所有这些字段的值填充临时表。
3.  编写作业或 SQL 查询以从表中删除此临时表中`InventDim`没有`InventDimId`' 的所有此类记录。

# python - Python 安装抛出大量 MemoryError()

> ID：13278073
> 
> 赞同：1
> 
> 时间：2012-11-07T20:56:28.823
> 
> 标签：python, linux, centos, cpanel

我刚刚在我的 centos 6.3 服务器上安装（并重新安装）python 2.7.3，并将 cpanel 内置到我系统上的 /opt/python2.7.3 目录中。我还使用 --enable-shared 标志安装了它，然后为它配置了 setuptools。我现在遇到问题了，尽管当我尝试easy_install 或使用基本的python thigns，例如bin/pcreate（我正在构建一个Web 应用程序）时，它会抛出MemoryError()

我确信有可用内存，因为 free -m 表明系统上有超过 2gb 的可用内存。这是 MemoryError 回溯之一的示例：

```
Traceback (most recent call last):

  File "bin/pcreate", line 8, in <module>
    load_entry_point('pyramid==1.4a3', 'console_scripts', 'pcreate')()
  File "/home/urcellar/betaurcellar/lib/python2.7/site-packages/setuptools-0.6c11-py2.7.egg/pkg_resources.py", line 318, in load_entry_point
  File "/home/urcellar/betaurcellar/lib/python2.7/site-packages/setuptools-0.6c11-py2.7.egg/pkg_resources.py", line 2221, in load_entry_point
  File "/home/urcellar/betaurcellar/lib/python2.7/site-packages/setuptools-0.6c11-py2.7.egg/pkg_resources.py", line 1954, in load
  File "/home/urcellar/betaurcellar/lib/python2.7/site-packages/pyramid-1.4a3-py2.7.egg/pyramid/scripts/pcreate.py", line 5, in <module>
    import optparse
  File "/opt/python2.7/lib/python2.7/optparse.py", line 90, in <module>
    from gettext import gettext
MemoryError 
```

我不确定是什么坏了或该怎么办...我做了一个全新安装，所以它绝对不是python下载或安装，必须是系统上的其他东西......

谢谢

编辑：ulimit-a

```
core file size          (blocks, -c) 1000000
data seg size           (kbytes, -d) unlimited
scheduling priority             (-e) 0
file size               (blocks, -f) unlimited
pending signals                 (-i) 127196
max locked memory       (kbytes, -l) 64
max memory size         (kbytes, -m) unlimited
open files                      (-n) 4096
pipe size            (512 bytes, -p) 8
POSIX message queues     (bytes, -q) 819200
real-time priority              (-r) 0
stack size              (kbytes, -s) 8192
cpu time               (seconds, -t) unlimited
max user processes              (-u) 14335
virtual memory          (kbytes, -v) unlimited
file locks                      (-x) unlimited 
```

# sql-server-2012 - SQL Server 2012 扩展事件 wait_info 与 2008 R2

> ID：13278074
> 
> 赞同：2
> 
> 时间：2012-11-07T20:56:41.333
> 
> 标签：sql-server-2012, extended-events

2012 年刚开始玩 EE，并且正在研究一个在 2012 年不太成功但在 2008 R2 上运行良好的演示。该演示用于跟踪等待统计信息，但由于版本之间可用数据列的差异而失败。

```
SELECT *
FROM sys.dm_xe_object_columns
WHERE [object_name] = 'wait_info' 
```

在 2008 R2 中，上述允许跟踪`wait_type`、`opcode`、`duration`、`max_duration`、`total_duration`和。`signal_duration``completed_count`

在 2012 年，我能看到的只有`wait_type`、和。`opcode``duration``signal_duration`

这里没有什么重要的，只是找到我的方式，但我试图了解这些列是否以及为什么确实已从新版本中删除（我找不到支持这一点的文档），它们现在是否无法追踪或移动到其他地方？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-07T21:53:07.720

这些列已被删除，因为它们与您从 sys.dm_os_wait_stats 聚合的输出完全相同，并且它们在事件触发时不会向事件添加任何附加值。要求这样做是为了在 2008 年 Connect 的时间范围内使事件更加轻量级。如有必要，我可以尝试找到该 Connect 项，但这些列并不真正属于为引擎中等待的开始或结束而生成的时间点 wait_info 事件。

# javascript - 如何将此 javascript ajax 代码转换为查询 ajax？

> ID：13278080
> 
> 赞同：2
> 
> 时间：2012-11-07T20:57:13.727
> 
> 标签：javascript, jquery, ajax

这段代码看起来很长——但我不完全理解用于转换这段代码的 jquery .ajax 函数——我的主要问题是我不知道如何实现 responseText-bit

很感谢任何形式的帮助：

```
function getCategory(category){
  if (window.XMLHttpRequest){
    xmlhttp=new XMLHttpRequest();
  }else{
    xmlhttp=new ActiveXObject("Microsoft.XMLHTTP");
  }
  xmlhttp.onreadystatechange=function(){
    if (xmlhttp.readyState==4 && xmlhttp.status==200){
      document.getElementById("products").innerHTML=xmlhttp.responseText;
    }
  }
  xmlhttp.open("GET","productlist.php?q="+category,true);
  xmlhttp.send();
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-07T20:59:00.853

```
$.ajax({
    url: "productlist.php?q=" + category,
    success: function( data ) {
         $("#products").html( data );
    }
}); 
```

或者简单地说：

```
$("#products").load("productlist.php?q=" + category); 
```

以及函数包装的原因：

```
function getCategory( category ) {
    $("#products").load("productlist.php?q=" + category);
} 
```

# jquery - 确定 touchmove 的垂直方向

> ID：13278087
> 
> 赞同：42
> 
> 时间：2012-11-07T20:57:34.507
> 
> 标签：jquery, ipad, touch

我正在尝试为平板电脑实现一个触摸监听器，以根据它是向上还是向下触摸来触发一些动作。

我尝试了本地侦听器：

```
($document).bind('touchmove', function (e)
{
    alert("it worked but i don't know the direction");
}); 
```

但我不知道如何确定方向。

这可能吗？

或者我需要使用 touchstart/touchend，如果我需要这个，我可以在触摸移动停止之前确定方向吗？

如果我只能使用外部库来做到这一点，那么最好的一个是什么？

谢谢。

* * *

## 回答 #1

> 赞同：68
> 
> 时间：2014-03-07T18:22:33.650

我在 Ipad 中遇到了一些问题，并通过两个事件解决了它

```
var ts;
$(document).bind('touchstart', function (e){
   ts = e.originalEvent.touches[0].clientY;
});

$(document).bind('touchend', function (e){
   var te = e.originalEvent.changedTouches[0].clientY;
   if(ts > te+5){
      slide_down();
   }else if(ts < te-5){
      slide_up();
   }
}); 
```

* * *

## 回答 #2

> 赞同：45
> 
> 时间：2012-11-07T21:06:05.760

您需要保存触摸的最后位置，然后将其与当前位置进行比较。
粗略的例子：

```
var lastY;
$(document).bind('touchmove', function (e){
     var currentY = e.originalEvent.touches[0].clientY;
     if(currentY > lastY){
         // moved down
     }else if(currentY < lastY){
         // moved up
     }
     lastY = currentY;
}); 
```

* * *

## 回答 #3

> 赞同：22
> 
> 时间：2014-03-10T01:27:34.230

Aureliano 的答案似乎非常准确，但不知何故它对我不起作用，所以给他学分我决定用以下方法改进他的答案：

```
var ts;
$(document).bind('touchstart', function(e) {
    ts = e.originalEvent.touches[0].clientY;
});

$(document).bind('touchmove', function(e) {
    var te = e.originalEvent.changedTouches[0].clientY;
    if (ts > te) {
        console.log('down');
    } else {
        console.log('up');
    }
}); 
```

我只是将`'touchend'`事件更改为**`'touchmove'`**

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2015-09-17T07:19:48.120

我创建了一个脚本，可以确保文档中的元素滚动而不滚动其他任何内容，包括正文。这适用于浏览器以及移动设备/平板电脑。

```
// desktop scroll
$( '.scrollable' ).bind( 'mousewheel DOMMouseScroll', function ( e ) {
    var e0 = e.originalEvent,
    delta = e0.wheelDelta || -e0.detail;

    this.scrollTop += delta * -1;
    e.preventDefault();
});

var lastY;
var currentY;

// reset touch position on touchstart
$('.scrollable').bind('touchstart', function (e){
    var currentY = e.originalEvent.touches[0].clientY;
    lastY = currentY;
    e.preventDefault();
});

// get movement and scroll the same way
$('.scrollable').bind('touchmove', function (e){
    var currentY = e.originalEvent.touches[0].clientY;
    delta = currentY - lastY;

    this.scrollTop += delta * -1;
    lastY = currentY;
    e.preventDefault();
}); 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2014-06-14T13:27:15.147

该解决方案考虑了当前答案没有考虑的方向变化。下面的解决方案还考虑了触摸灵敏度；当用户在一个方向上移动但在触摸端时，用户的手指会朝另一个方向轻推，从而弄乱了实际方向。

```
 var y = 0; //current y pos
 var sy = y; //previous y pos
 var error = 5; //touch sensitivity, I found between 4 and 7 to be good values. 

 function move(e) {
    //get current y pos
    y = e.pageY;

    //ingnore user jitter
    if (Math.abs(y - sy) > error) {
        //find direction of y
        if (y > sy) {
            //move down 
        } else {
            //move up
        }
        //store current y pos
        sy = y;
    }
} 
```

# php - 将表单中动态生成的 $_POST 值从 php 插入 mysql

> ID：13278088
> 
> 赞同：1
> 
> 时间：2012-11-07T20:57:37.050
> 
> 标签：php, mysql

我目前正在尝试从我的表单中插入回数据库值。

```
 <?php do { ?>
  <tr>
    <td><?php echo $row_questions['question']; ?><br /><table><tr><td style=

    "padding:15px; text-align:center">
      <label>
        <center><input type="radio" name="answers_<?php echo $row_questions['id']; ?>_<?php echo $row_questions['sub_category']; ?>" value="1" id="answers_1" /></center><br />
        Low</label>
      </td><td style="padding:15px; text-align:center">
      <label>
        <center><input type="radio" name="answers_<?php echo $row_questions['id']; ?>_<?php echo $row_questions['sub_category']; ?>" value="2" id="answers_2" /></center><br />
        Fairly Low</label>
      </td><td style="padding:15px; text-align:center">
      <label>
        <center><input type="radio" name="answers_<?php echo $row_questions['id']; ?>_<?php echo $row_questions['sub_category']; ?>" value="3" id="answers_3" /></center><br />
        Average</label>
      </td><td style="padding:15px; text-align:center">
      <label>
        <center><input type="radio" name="answers_<?php echo $row_questions['id']; ?>_<?php echo $row_questions['sub_category']; ?>" value="4" id="answers_4" /></center><br />
        Fairly High </label>
      </td><td style="padding:15px; text-align:center">
      <label>
        <center><input type="radio" name="answers_<?php echo $row_questions['id']; ?>_<?php echo $row_questions['sub_category']; ?>" value="5" id="answers_5" /></center><br />
        High</label>
      </td></tr></table><br />
  </tr>
  <?php } while ($row_questions = mysql_fetch_assoc($questions)); ?> 
```

该表单从我的数据库中的表中获取问题（称为问题）。它们分为三类，并且每次只提取一类问题。

我需要将每个答案单独插入另一个表（称为 user_answers）。

我很难弄清楚如何去做这件事，它开始让我头疼了！

表单设法通过 $_POST 一个值，当`print_r($_POST);`我得到

> 数组（[answers_90_5] => 3 [answers_91_5] => 3 ）

在这两种情况下，90 和 91 是问题 ID，5 是子类别。

从这里我被难住了。

如何识别每个帖子的这些部分以及答案并将它们作为一行插入表格中？

我可以正常执行 MySQL 插入和标准表单传递值等，但我完全不知道如何做到这一点！

提前谢谢了！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-07T21:05:58.323

使用多维数组应该可以简化您的迭代工作：

```
<input 
    type="radio" 
    name="answers[<?php echo $row_questions['id']; ?>][<?php echo $row_questions['sub_category']; ?>]" 
    value="1" 
    id="answers_<?php echo $row_questions['id'] . '_' . $row_questions['sub_category']; ?>" /> 
```

调试这个应该会给你`$_POST`一个喜欢的数组：

```
Array ( [answers] => Array(
     90 => Array ( 5 => 3 ),
     91 => Array ( 5 => 3 ),
)) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-07T21:22:52.440

我认为另一个建议多暗阵列的答案很有意义。以为我仍然会提供一个关于如何解析字符串的示例。它可能很简单：

```
foreach ($post as $k => $v) {
    $parts = explode('_', $k);
    $questionId = $parts[1];            
    $questionCategoryId = $parts[2];    
    $sql = "INSERT INTO answers (questionId, subCategoryId, answerValue ) VALUES ($questionId, $questionCategoryId, $v)";

    ....
} 
```

...只希望更好地转义 POST 数据。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-07T21:00:26.207

当然，分开你的查询，为查询 1 发布 val 1 和 sub cat 1，查询 2 对 cat 2 和 sub cat 2 执行相同的操作。

很简单。

# c++ - 操作后迭代器会失效吗？

> ID：13278093
> 
> 赞同：-4
> 
> 时间：2012-11-07T20:57:58.287
> 
> 标签：c++, map, std

> **可能重复：**
> [迭代器失效规则](https://stackoverflow.com/questions/6438086/iterator-invalidation-rules)

想象一下，我有一个`map<int, int>`. 不知何故，我检索了一个指向`pair<35,37>`地图中条目的迭代器。我将此迭代器保存为`map<int, int>::iterator _my_iterator3537`.

在那之后，我在地图上做了很多插入。`_my_iterator3537`还在指着吗`pair<35,37>`？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-07T21:02:45.817

来自文档：

> Map 有一个重要的属性，即在 map 中插入一个新元素不会使指向现有元素的迭代器失效。
> 
> 从映射中擦除元素也不会使任何迭代器无效，当然，除了实际指向正在被擦除的元素的迭代器。

从标准：23.1.2/8

> 插入成员不应影响迭代器和对容器的引用的有效性，而擦除成员应仅使迭代器和对被擦除元素的引用无效。

# ruby-on-rails - Rails 中的用户到用户消息

> ID：13278096
> 
> 赞同：1
> 
> 时间：2012-11-07T20:58:13.307
> 
> 标签：ruby-on-rails, ruby

我一直在 Rails 应用程序中构建消息传递，以便用户能够相互发送消息。我查看了一些 gem，例如 mailboxer，但最终决定自己构建。

我希望有人能帮我把这些碎片放在一起。我一直在[这里](https://stackoverflow.com/questions/5141564/model-users-message-in-rails-3)关注类似问题的答案。

我正在 Rails 控制台中进行测试，但我不断收到以下错误：

未定义的方法 `send_message' 用于#

我怎样才能解决这个问题？

**控制器**

```
class MessagesController < ApplicationController
    # create a comment and bind it to an article and a user  
    def create
      @user = User.find(params[:id])
      @sender = current_user
      @message = Message.send_message(@sender, @user)
      flash[:success] = "Message Sent."
      flash[:failure] = "There was an error saving your comment (empty comment or comment way to long)"
    end
end 
```

**路线**

```
 resources :users, :except => [ :create, :new ] do
     resources :store
     resources :messages, :only => [:create, :destroy] 
  end 
```

**消息模型**

```
class Message < ActiveRecord::Base
  belongs_to :user

  scope :sent, where(:sent => true)
  scope :received, where(:sent => false)

  def send_message(from, recipients)
     recipients.each do |recipient|
       msg = self.clone
       msg.sent = false
       msg.user_id = recipient
       msg.save
     end
     self.update_attributes :user_id => from.id, :sent => true
   end
end 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-07T21:01:45.153

您正在类级别调用该方法：`Message.send_message`. 为此，它需要这样的声明：

```
def self.send_message(from, recipients)
  # ...
end 
```

但是，你得到了这个：

```
def send_message(from, recipients)
  # ...
end 
```

因此，要么在您需要的实例上调用该方法，要么重构以使其在类级别上工作。

# jquery - 在索引值处单击时jQuery切换DIV并在单击的DIV的索引处更改图像

> ID：13278102
> 
> 赞同：2
> 
> 时间：2012-11-07T20:58:38.967
> 
> 标签：jquery, html

我有一个项目，我在其中显示一组 div。当我单击一个 div 时，无论是 0、1、2、...的索引值，都会从单击的 div 中显示下拉菜单。我目前已将其设置为单击 div 时下拉显示的位置，并且 div 中包含的图像将更改（例如 (+) 到 (-) 图像），从而表明 div 已打开。我已经编写了一个响应，所以我知道单击的 div 的索引值，并将其显示在 a`<span>`中（这只是为了帮助我在调试时查看索引值。）当我单击 div 时，图像将在适当的div，但问题是无论我单击什么 div，索引值（0）处的 div 是唯一一个下拉显示我的菜单的 div。我希望单击的 div 更改图像（工作）并显示菜单（已损坏，索引（0）除外。

CSS

```
 .hidden { display: none; } 
```

HTML

```
 <div class="geolink-bar">
       <div id="arrow">
           <img src="https://geoto.s3.amazonaws.com/images/arrow_down.png">
       </div>
   </div>
   <div id="dropdown-mobile-account" class="hidden">
       <div>Display after geolink-bar is clicked</div>
   </div>
   <span></span> 
```

脚本

```
 $(document).ready( function() {
       $('.geolink-bar').click(function(){
           var index = $('.geolink-bar').index(this);
           $("span").text("That was div index #" + index);//DISPLAYS INDEX NUMBER F DIV CLICKED     
           $('#dropdown-mobile-account').slideToggle("slow");
           $(this).html(function(i,html) {
              if (html.indexOf('Show') != -1 ){
                  html = html.replace('Show','Hide');
              } else {
              html = html.replace('Hide','Show');
              }
              return html;
           }).find('img').attr('src',function(i,src){
           return (src.indexOf('arrow_down.png') != -1)? 'https://geoto.s3.amazonaws.com/images/arrow_open.png' :'https://geoto.s3.amazonaws.com/images/arrow_down.png';
           });
       }); 
   }); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-07T21:24:03.200

## *[jsBin 演示](http://jsbin.com/agosat/3/edit)*

CSS：

```
.dropdown-mobile-account{
    display:none;
} 
```

HTML：

```
 <div class="geolink-bar">
     <span class="tog-txt">Show</span>
       <div class="arrow">
           <img src="https://geoto.s3.amazonaws.com/images/arrow_down.png">
       </div>
   </div>
   <div class="dropdown-mobile-account">
       <div>Display after geolink-bar is clicked</div>
   </div> 
```

jQuery：

```
$('.geolink-bar').click(function() {

      var visible = $(this).next('.dropdown-mobile-account').is(':visible'),
         slideTog = visible?'slideUp':'slideDown',
              txt = visible?'Show':'Hide',
           arrUrl = ['https://geoto.s3.amazonaws.com/images/arrow_down.png', 'https://geoto.s3.amazonaws.com/images/arrow_open.png'],
            arrow = visible? arrUrl[0] : arrUrl[1];

      $('.dropdown-mobile-account').slideUp();
      $('span.tog-txt').text('Show');
      $('.arrow').find('img').attr('src', arrUrl[0] );

      $(this).find('span.tog-txt').text( txt ).end().find('img').attr('src', arrow).end().next('.dropdown-mobile-account')[slideTog]();

}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-07T23:15:27.480

感谢“nnnnnn”的评论，我替换了我的

```
 $('#dropdown-mobile-account').slideToggle("slow"); 
```

和

```
 $(this).next().slideToggle("slow"); 
```

“RoXon's”的例子是一个很好的演示，也可以看看@。:-)

# c# - 记录系统上的每个文件访问尝试并按用户/系统帐户对其进行排序

> ID：13278110
> 
> 赞同：0
> 
> 时间：2012-11-07T20:58:53.263
> 
> 标签：c#, .net, iis, application-pool

我有一个奇怪的问题，我需要查看为什么我的应用程序池由于权限问题而崩溃并且没有日志有帮助。有没有办法记录系统上的每个文件访问尝试并按尝试访问它的用户/系统帐户对其进行排序，特别是如果它无法访问所需的文件？即使有第三方应用程序，它也会非常有帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-07T21:04:08.007

[Sysinternals/Microsoft 的Process Monitor](http://technet.microsoft.com/en-us/sysinternals/bb896645.aspx)将显示这一点以及许多其他活动。

# java - 如何使用特定的 Widget 注入 GWT Activity#start？

> ID：13278111
> 
> 赞同：0
> 
> 时间：2012-11-07T20:58:53.667
> 
> 标签：java, gwt, mvp, gwt-activities, gwt-places

我有以下父容器：

```
public class ParentContainer extends Composite {
    // Contains a bunch of TextButtons (RedButton, GreenButton, etc.).
    private LayoutPanel buttonPanel;

    // When user clicks a TextButton inside the buttonPanel,
    // it changes the content of this contentPanel.
    private LayoutPanel contentPanel;
} 
```

因此，当用户单击 中的其中一个 TextButtons 时`buttonPanel`，`contentPanel`的内容会发生变化。我正在尝试使用“活动/地点”框架让每个 TextButton 点击​​被记住在历史中。因此，如果用户分别点击“红色”、“绿色”和“蓝色”按钮，`contentPanel`则会改变 3 次，然后他们可以点击 Back/Forward 浏览器历史记录按钮并在历史记录中不断来回移动（并且“重播”按钮一遍又一遍地点击，等等）。

我还有以下课程：

```
com.mywebapp
    MainModule.gwt.xml
com.mywebapp.client
    MainModule
com.mywebapp.client.places
    RedButtonPlace
    GreenButtonPlace
    BlueButtonPlace
    ... 1 place for all buttons
com.mywebapp.client.activities
    RedButtonActivity
    GreenButtonActivity
    BlueButtonActivity
    ... 1 activity for all buttons
com.mywebapp.client.ui
    ParentContainer
    RedButton
    GreenButton
    BlueButton
    BlackButton
    PurpleButton
    OrangeButton 
```

我正计划将事情连接起来，以便：

*   `PlaceController.goTo(new RedButtonPlace())`最终路由到`RedButtonActivity`
*   `PlaceController.goTo(new GreenButtonPlace())`最终路由到`GreenButtonActivity`
*   等等（每个按钮的颜色都有一个位置和活动）

**我坚持的是：如果我`PlaceController.goTo(new RedButtonPlace())`从点击处理程序内部调用`RedButton`，我如何以及在哪里指示`RedButtonActivity`更新`contentPanel`？**例如：

```
public class RedButton extends TextButton {
    // ... bunch of stuff, nevermind why I am extending TextButton
    // this is just to help me connect all the major dots of GWT!

    public RedButton() {
        this.addClickHandler(new ClickHandler() {
            public void onClick(ClickEvent event) {
                // If the RedButton is clicked, we want all the content in RedButtonActivity#RedButtonView
                // to go inside ParentContainer#contentPanel.
                PlaceController.goto(new RedButtonPlace());
            }
        });
    }
}

public class RedButtonActivity extends AbstractActivity {
    public interface RedButtonView extends IsWidget {
        // Whatever the RedButton expects to be able to display.
    }

    private RedButtonView view;

    @Override
    public void start(AcceptsOneWidget panel, EventBus eventBus) {
        // Probably injected via GIN.
        view = somehowInjectTheView();

        panel.setWidget(view);
    }
} 
```

最后一行是这里的关键：`panel.setWidget(view)`. 我们如何确保这`panel`是`ParentContainer#contentPanel`? 提前致谢！

**编辑**：根据一个答案建议，这是一个代码更新：

```
public class ParentContainer extends Composite {
    // All the stuff that's up above in the first parent container.

    public ParentContainer() {
        super();

        // Again, via GIN.
        ActivityManager redButtonActivityManager = getSomehow();
        redButtonActivityManager.setDisplay(contentPanel);
    }
} 
```

如果这是正确的方法，那么我假设在`start(AcceptsOneWidget panel, EventBus eventBus)`调用该方法时，`redButtonActivityManager`知道为`panel`参数注入正确的显示吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-07T21:54:35.620

作为管理器初始化的一部分，您将传递`ParentContainer#contentPanel`给您的[`setDisplay()`](http://google-web-toolkit.googlecode.com/svn/javadoc/latest/com/google/gwt/activity/shared/ActivityManager.html#setDisplay%28com.google.gwt.user.client.ui.AcceptsOneWidget%29)方法。`ActivityManager`

# android - 尽管默认为 1234 或 0000，我们可以在 Android 中以编程方式更改蓝牙密码吗？如果是，如何？

> ID：13278112
> 
> 赞同：1
> 
> 时间：2012-11-07T20:58:55.573
> 
> 标签：android, bluetooth, passwords

如何以**编程方式更改**[Android](http://en.wikipedia.org/wiki/Android_%28operating_system%29) [蓝牙](http://en.wikipedia.org/wiki/Bluetooth)通信中的默认密钥（即 1234 或 0000） ？

我的意思是，如果我想在与另一台设备配对之前输入密码（如 5674 或其他），那么另一台设备必须输入我在配对开始之前定义的相同密码。

此外，在Bluetooth Mate Gold 中，我如何设置自己定义的密钥，以便任何连接到Bluetooth mate Gold 的用户都必须输入该密钥？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-20T22:42:03.150

只需要自己为蓝牙伴侣（银色）做这件事。

[要设置设备 PIN，请进入命令模式并使用Roving Networks 高级用户手册](http://www.sparkfun.com/datasheets/Wireless/Bluetooth/rn-bluetooth-um.pdf)中指定的 SP 命令。

例子：

```
// Assumes Bluetooth Mate is connected on Serial1
Serial1.connect(115200);
// Enter command mode
Serial1.print("$$$");
delay(100);
// ... add code to read 'CMD' from Serial1 here ...
// Set PIN to '5678'
Serial1.println("SP,5678");
// Exit command mode
Serial1.println("---"); 
```

# pdf - pdf>png>pdf后文本pdf的质量下降

> ID：13278118
> 
> 赞同：1
> 
> 时间：2012-11-07T20:59:08.640
> 
> 标签：pdf, imagemagick, ghostscript, fax, imagemagick-convert

我有一个非常具体的要求，我必须自动标记 PDF 文件的每一页（对于传真应用程序），所以这是我所做的过程：

*   ***第 1 步：将 PDF 转换为 PNG，每页一个 png 文件***

    *   cmd1：**gs -dSAFER -dBATCH -dNOPAUSE -sDEVICE=png16m -dGraphicsAlphaBits=4 -dTextAlphaBits=4 -r400 -sOutputFile=image_raw.png input.pdf**
    *   cmd2: **mogrify -resize 31.245% image_raw.png**
    *   input.pdf（输入）：[https ://www.dropbox.com/s/p2ajqxe99nc0h8m/input.pdf](https://www.dropbox.com/s/p2ajqxe99nc0h8m/input.pdf)
    *   image_raw.png（输出）：[https ://www.dropbox.com/s/4cni4w7mqnmr0t7/image_raw.png](https://www.dropbox.com/s/4cni4w7mqnmr0t7/image_raw.png)
*   **第 2 步：标记每个 PNG 文件（使用第三方工具..）**

    *   image_stamped.png（输出）：[https ://www.dropbox.com/s/3ryiu1m9ndmqik6/image_stamped.png](https://www.dropbox.com/s/3ryiu1m9ndmqik6/image_stamped.png)
*   **第 3 步：将 PNG 文件重新转换为一个 PDF 文件**

    *   cmd：**转换 -resize 1240x1753 -units PixelsPerInch -density 150x150 image_stamped.png output.pdf**
    *   output.pdf（输出）：[https ://www.dropbox.com/s/o9y0jp9b4pm08ci/output.pdf](https://www.dropbox.com/s/o9y0jp9b4pm08ci/output.pdf)

第三步的输出文件“理论上”应与步骤 1 中的输入文件相同（加上上面的标记），但事实并非如此，该文件有点模糊，并且在传真后变得无法阅读，因为模糊了即使您可能看到 input.pdf 和 output.pdf 之间没有区别，像素也不会通过传真线，尝试放大，您会发现文本字符的边缘模糊。

在输入（第 1 步）或输出（第 3 步）中使用的最佳参数是什么？

谢谢 ！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-08T08:26:06.170

您正在使用抗锯齿 (TextAlphaBits=4)。这通过在文本边缘的黑色像素之间引入灰色像素来“平滑”文本的边缘。在低分辨率（例如显示器）下，这可以防止文本中出现“锯齿”并提供更易读的结果。在更高的分辨率下，它的价值值得商榷。

传真是 1 位单色介质，因此必须通过抖动重新创建灰度值。正如您所发现的，这在分辨率有限的设备中不是一个好主意，因为它会导致清晰度下降。

我相信，如果您删除 -dTextAlphaBits=4，您会立即看到改进。我还建议您也删除 GraphicsAlphaBits，因为这将对线条产生相同的影响。

如果你认为你仍然想要抗锯齿，你可以尝试降低侵略性，你现在将其设置为 4，尝试将其降低到 2。

关于其他评论；Kurt 非常正确，fourat 也是如此，恐怕 MarcB 弄错了，-r400 设置渲染分辨率，以每英寸点数为单位。如果只给出一个数字，则它同时用于 x 和 y 分辨率。可以使用 Ghostscript 生成固定大小的栅格，但您可以使用 -dFIXEDMEDIA 和 -sPAPERSIZE 开关或 -g 开关，它也会自动设置 FIXEDMEDIA。

虽然我同意 yms 和 Kurt 的观点，即将 PDF 转换为位图格式 (PNG)，然后再转换回 PDF*会*导致质量下降，但如果最终的 PDF 仅用于通过传真传输，那没关系。PDF 必须在此过程中的某个时间点呈现为传真分辨率位图，如果在应用图章之前完成，则问题不大。

我不同意这里的 BitBank，将矢量表示转换为位图意味着以特定的分辨率对其进行光栅化。完成此操作后，无法在不损失质量的情况下重新缩放生成的图像，而原始矢量表示可以简单地以不同的分辨率再次渲染。PDF 中的图像是指位图，不能有矢量位图。yms 发布的图片清楚地显示了将矢量表示渲染成图像的效果。

最后一个警告。我不熟悉这里使用的其他工具，但其中两个命令行至少暗示了“调整大小”。如果您“调整”位图的大小，那么该工具很可能会引入您遇到问题的相同种类的人工制品（抗锯齿）。一旦你创建了位图，你根本不应该改变它。首先以正确的大小创建 PNG 非常重要。

最后......

我刚刚检查了您的原始 PDF 文件，发现页面内容*已经*是图像。不仅是它的 DCT (JPEG) 图像。对于单色图像，JPEG 是一种非常糟糕的格式选择。它是一种有损压缩格式，总是会在图像中引入伪影。如果您在 Acrobat（或类似查看器）中打开原始 PDF 文件并放大，您会看到文本周围有微弱的“光晕”，您还会看到文本*已经*模糊。

然后渲染图像，很可能以与原始图像分辨率不同的分辨率，同时通过设置 -dGraphicsAlphaBits 引入更多模糊。然后，您对我无法评论的图像数据进行进一步更改。最后，您再次将图像渲染为单色位图。表示灰色像素所需的抖动会导致您的文本不可读。

这里有一些改进的方法： 1）不要像这样将文本转换成图像，它会立即导致质量损失。2) 不要使用 JPEG 压缩单色图像 3) 如果您要处理图像，请不要一直来回转换它们，在完成之前使用原始图像，然后制作 PDF 文件，如果您真的必须。4）如果你真的坚持做这一切，*不要*通过使用更多的抗锯齿来使问题复杂化。从命令行中删除 -dGraphicsAlphaBits。您也可以删除 -dTextAlphaBits ，因为您的文件不包含文本。请在使用开关之前阅读文档并了解您在做什么。

您应该在这里真正考虑一下您的工作流程。显然我们不知道你在做什么或为什么，所以可能有很好的理由说明某些事情是不可能的，但你应该尽量避免像这样操纵图像。因为这些不是矢量，所以每次您对图像数据进行更改时，您都可能会丢失无法在以后恢复的信息。通过进行许多此类转换（并且您所描绘的工作流程似乎从“原始”图像数据执行多达 5 次转换），您将不可避免地损失质量。

如果可能，将所有内容保留为矢量数据。当无法避免移动到图像数据时，根据需要创建最终使用的图像数据，不要进一步转换它。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-11-08T09:43:33.100

我仔细查看了您提供的文件，请参见此处：

![放大位图](../Images/87a3e46f2fc91a2064277eb04c8fa88f.png)

因此，mogrify resize 命令的结果已经是第一张图像 (image_raw)，在 1062x1375 处相当模糊。虽然第二张图像 (image_stamped) 的模糊度并没有变得更糟，这是第三方工具的结果，但第三张图像（从您的 output.pdf 中提取），即转换命令的结果，更加模糊是由于图形被调整大小（这是你明确告诉它做的事情）。

我不知道您的传真程序在哪种分辨率下工作，但仍然存在更多质量损失，至少由于 24 位颜色到黑白转换。

如果您坚持工作流程（即 pdf->png->stamped png->pdf->fax），您应该

1.  在初始光栅化中已经使用了您的光栅图像在所有后续步骤（包括传真传输）中将具有的每英寸分辨率，

2.  避免抗锯齿和使用 alpha 位（参见 KenS 的回答），以及

3.  将光栅化图像限制为传真传输可用的色彩空间，即很可能是黑白的。

**PS**正如 KenS 指出的那样，原始 PDF 已经只是图像的容器（开始时有些模糊）。因此，改进工作流程的另一种方法是*提取*该图像而不是*渲染*它，标记该原始图像并仅在传真时调整其大小（同样没有抗锯齿）。

![在此处输入图像描述](../Images/24382dc130356ea303729dc043def25e.png)

# java - 使用 Tomcat 手动部署 webapp（即 autoDeploy=false, noDeployOnStartup=false）

> ID：13278123
> 
> 赞同：6
> 
> 时间：2012-11-07T20:59:28.680
> 
> 标签：java, jakarta-ee, tomcat

我正在尝试将几个 Web 应用程序部署到 tomcat 6.x，并且我已经关闭了 autoDeploy 和 onDeployStartup，因为我想手动注册这些应用程序并将它们映射到不基于它们的战争文件名称的 URL。

我将以下上下文文件放在 $catalina.home/conf/Catalina/localhost 中：

```
<Context path="" docBase="web-1.0-SNAPSHOT.war" debug="1">
</Context> 
```

我将战争文件放在 $catalina.home/webapps 下，但是当我启动 tomcat 时，什么都没有部署。我什至没有看到有关我创建的上下文文件的任何错误消息。或者任何打印出来的东西都说错了。

有什么问题？我已经阅读了很多概述自动部署的文档，但是对于如何在自动部署之外执行此操作的细节非常粗略。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-08T14:59:23.717

因此，有关 autoDeploy 工作原理以及替代部署的详细信息仅在此处真正讨论：

[http://wiki.apache.org/tomcat/HowTo#How_do_I_make_my_web_application_be_the_Tomcat_default_application.3F](http://wiki.apache.org/tomcat/HowTo#How_do_I_make_my_web_application_be_the_Tomcat_default_application.3F)

我不知道为什么tomcat让这变得如此复杂。如果您关闭自动部署，您唯一的选择是修改 server.xml 并在那里添加您的上下文。您无法将上下文的定义外部化，这似乎是部署事物的复杂方式。如果我要花时间删除一个 XML 配置文件，我应该能够控制它安装到的 URL 和 docBase。只需直截了当，因为 Jetty 可以。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-08T04:42:30.323

尝试以下步骤

关闭tomcat

将 web-1.0-SNAPSHOT.war 复制到 webapps 文件夹。

部署 web 应用程序。

现在 webapps 中有一个名为 web-1.0-SNAPSHOT 的文件夹。

转到 conf/server.xml

添加以下条目

```
<Context path="/abc" docBase="web-1.0-SNAPSHOT" debug="1"></Context> 
```

文档库没有 .war 扩展名。部署 web-1.0-SNAPSHOT.war 后，webapps 内将有一个目录 web-1.0-SNAPSHOT。文档库应该指向这个目录。

请确保上下文标签在

```
<Host>  </Host> tag 

<Host>
    <Context path="/abc" docBase="web-1.0-SNAPSHOT" debug="1"></Context>
</Host> 
```

编辑 server.xml 后，您必须重新启动 tomcat 服务器以反映更改。现在您可以在以下位置找到您的 webapp

```
localhost:8080/abc 
```

希望这可以帮助

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-07T22:54:06.777

将 deployonstartup 设置为 false 告诉 tomcat 不要在启动时部署应用程序。我认为它足以关闭自动部署。所以也许可以在 server.xml 的主机中尝试以下操作：autoDeploy="false" deployOnStartup="true"。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2019-06-06T03:25:30.500

示例代码

```
<Host name="localhost"  appBase="webapps"
        unpackWARs="true" autoDeploy="false" deployOnStartup="false">

    <Context path="/howto-prepareexam" docBase="howto-prepareexam" debug="1"></Context>

    <Valve className="org.apache.catalina.valves.AccessLogValve" directory="logs"
           prefix="localhost_access_log" suffix=".txt"
           pattern="%h %l %u %t &quot;%r&quot; %s %b" />

  </Host> 
```

然后重启tomcat

# c# - 无法弄清楚这个 NullReferenceException

> ID：13278127
> 
> 赞同：0
> 
> 时间：2012-11-07T20:59:39.067
> 
> 标签：c#, vb.net, nullreferenceexception

StackTrace：在 System.Threading._IOCompletionCallback.PerformIOCompletionCallback(UInt32 errorCode, UInt32 numBytes, NativeOverlapped* pOVERLAP) 来源：mscorlib

我在目标源中看到了一些关于反射的东西。所以我会发布非常少量的使用反射的代码。

我通常能够轻松找到 NullReferenceExceptions。虽然这似乎不是我的代码，但我无法弄清楚以挽救我的生命。我在 VB.net 中有这个代码机器人，和 C#.Net 都有同样的问题。我认为我的问题在于我的指针是如何工作的，但我可能是错的。

代码很简单。我有一个通过 USB 连接的条形码扫描仪，它处于 COM 模式。我从另一个程序中复制了一些代码，该程序使用了同样可以完美运行的条形码。但是总结一下它的作用是打开，然后通过反射，获取指向打开的com端口的指针，设置一个DataEventListener。当我扫描某些东西时，我会等待 100 毫秒，然后以字符串形式吐出数据。尽可能简单。我的代码与另一个完美运行的代码之间的区别在于我必须获得指针。要打开我的扫描仪，我需要一个指向使用 IntPtr 的 comport 的指针。C# 我使用 IntPtr，在 VB 中我使用 SafeFileHandle。两者都有相同的错误。唯一发生错误的时间是触发数据事件时。这就是为什么我认为它必须与手柄有关。奇怪的是需要手柄来打开和关闭成像仪，所以我知道我有一个有效的手柄。（只是不知道它是否被保留）那么有人对我为什么会出现这个错误有任何帮助或资源吗？

首先.. VB.NET Public Class ImagerOposDevice Inherits AbstractOPOSDevice Dim PortHandle As SafeFileHandle Dim ImagerPort As SerialPort Public exitCode = 1 Sub New(ByVal comName As String) ImagerPort = New SerialPort(comName) End Sub

```
Protected Overrides Function Open() As Boolean
    ImagerPort.Open()
    PortHandle = GetHandleFromSerialPort(ImagerPort)

    If Not PortHandle.IsInvalid Then
        AddHandler ImagerPort.DataReceived, AddressOf DataReceivedHandler
    End If

    Return (Not PortHandle.IsInvalid)
End Function
Protected Overrides Sub Close()
    Try
        ImagerPort.Close()
        ImagerPort.Dispose()
    Catch ex As Exception
        Console.WriteLine(ex.Message)
        Console.ReadLine()
    End Try

End Sub

Protected Overrides Function RunCommand(ByVal X As Integer) As Boolean
    If X = 0 Then
        Return TurnImagerOn()
    ElseIf X = 1 Then
        Return TurnImagerOff()
    Else
        Return False
    End If
End Function

Private Shared Function GetHandleFromSerialPort(ByVal sp As SerialPort) As SafeFileHandle
    Dim BaseStream As Object = sp.BaseStream
    Dim BaseStreamType As Type = BaseStream.GetType
    Return BaseStreamType.GetField("_handle", BindingFlags.NonPublic Or BindingFlags.Instance).GetValue(BaseStream)
End Function
Private Sub DataReceivedHandler(ByVal sender As Object, ByVal e As SerialDataReceivedEventArgs)
    Try
        'Dim sp As SerialPort = CType(sender, SerialPort)
        System.Threading.Thread.Sleep(100)
        Dim len = ImagerPort.BytesToRead
        Dim buffer(len - 1) As Byte
        ImagerPort.Read(buffer, 0, len)

        Dim indata As String = System.Text.ASCIIEncoding.ASCII.GetString(buffer)
        Console.WriteLine("Data Received:")
        Console.Write(indata)
        TurnImagerOff()
    Catch ex As Exception
        Console.WriteLine(ex.Message)
    End Try
    exitCode = 0
End Sub 
```

在我的主要形式中，它是直截了当的

```
 imager = New ImagerOposDevice("COM7")
    imager.OpenDevice()
    imager.SendCommand(0)
    For index = 1 To 100 Step 1
        System.Threading.Thread.Sleep(100)
        If imager.exitCode = 0 Then
            Exit For
        End If
    Next
    Console.WriteLine("Press Enter to Close")
    Console.ReadLine()
    CloseDevices() 
```

现在是 C# 代码。它是一种窗口形式，但概念几乎相同。

```
 private SerialPort devicePort;
    private IntPtr deviceHandle;
    public Imager(string Port) : base()
    {
        devicePort = new SerialPort(Port);
    }
    protected override bool Open()
    {
        try
        {
            devicePort.Open();
            deviceHandle = GetHandleFromSerialPort(devicePort);
            Console.WriteLine("Device Handle:{0}", deviceHandle);
            Console.WriteLine("Device Open:{0}", devicePort.IsOpen);
        }
        catch(Exception ex)
        {
            Console.WriteLine(ex.Message);
        }
        return devicePort.IsOpen;
    }
    protected override bool Close()
    {
            devicePort.Close();
            devicePort.Dispose();
        return true;
    }
    protected override CommandReturnCodes RunCommand(int command)
    {
        switch (command)
        {
            case 0:
                TurnImagerOn();
                break;
            case 1:
                TurnImagerOff();
                break;
            case 2:
                ReadLatch();
                break;
            case 3:
                GetPartNumber();
                break;
            case 4:
                GetSerialNumber();
                break;
            case 5:
                GetProductString();
                break;
            default:
                return CommandReturnCodes.FAIL;
        }
        return CommandReturnCodes.SUCCESS;
    }
    private static IntPtr GetHandleFromSerialPort(SerialPort sp)
    {
        Type t = typeof(SerialPort);
        BindingFlags bf = BindingFlags.Instance | BindingFlags.NonPublic;
        FieldInfo fi = t.GetField("internalSerialStream", bf);
        object ss = fi.GetValue(sp);
        Type t2 = fi.FieldType;
        FieldInfo fi2 = t2.GetField("_handle", bf);
        SafeFileHandle _handle = (SafeFileHandle)fi2.GetValue(ss);
        Type t3 = typeof(SafeFileHandle);
        FieldInfo fi3 = t3.GetField("handle", bf);
        IntPtr handle = (IntPtr)fi3.GetValue(_handle);
        return handle;
    }
    public void TurnOnImagerEventListener()
    {
        devicePort.DataReceived += new SerialDataReceivedEventHandler(devicePort_DataReceived);
    }

    void devicePort_DataReceived(object sender, SerialDataReceivedEventArgs e)
    {
        System.Threading.Thread.Sleep(100);
        SerialPort imager = sender as SerialPort;
        byte[] buffer = new byte[imager.BytesToRead];
        imager.Read(buffer, 0, imager.BytesToRead);
        var scannedText = System.Text.Encoding.ASCII.GetString(buffer).Trim();
        SendBarcodeEvent(scannedText);
        TurnImagerOff();
        Console.WriteLine(scannedText);
    } 
```

并称它为同一件事

```
 im = new Imager(comportBox.Text);
        im.OpenDevice();
        im.TurnOnImagerEventListener();
        im.BarcodeScanned += new DataAvailableHandler(DeviceInformationReceived); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-08T12:21:49.043

事实证明，LightStriker 帮助我看到了昨天让我失明的迷雾。我仍然没有工作的 vb.net 版本，但它最终是当一个单独的线程（即 dataevent）调用它时，我的 C# 程序中使用的 IntPtr 没有被保留。当我单步执行数据事件部分时，它直到我调用 TurnImagerOff() 部分才失败。这是一个简单的解决方法，我所要做的就是将我的串行端口和我的 IntPtr 都更改为静态成员。我在 VB.net 代码中尝试过……但显然我不够聪明，无法弄清楚。哦，今天又是一天，我的代码至少有 50% 有效。

所以对于那些有空引用错误并且在任何地方都找不到它的人来说。而且堆栈跟踪不会给你一个行号，检查在另一个线程上运行的任何东西，它正在调用任何指针成员。（或反映为指针）。检查数据事件、线程池、后台工作人员、计时器、委托等。我希望我的愚蠢能帮助别人。

# fullcalendar - 将 POST 数据从日历发送到 json_events.php

> ID：13278128
> 
> 赞同：2
> 
> 时间：2012-11-07T20:59:42.280
> 
> 标签：fullcalendar

我想这很简单，但我不太清楚这个概念。
基本上我正在加载上一个/下一个点击事件

```
viewDisplay: function(view) { var next = view.title;  }, //alert(next); 
```

给我“2012 年 11 月”
然后拆分这个

```
events:  { 
url: 'json-events.php',  
type: 'POST',  <br/>
data: { month: month,  
year: year } }, 
```

那么，如何读取 json-events.php 中的 POST val 假设我在正确的轨道上。【超级新手】

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-10-22T11:07:33.827

用作对象参考[http://arshaw.com/fullcalendar/docs/event_data/Event_Object/](http://arshaw.com/fullcalendar/docs/event_data/Event_Object/)

```
<?php
//obtain params
$month = $_POST["month"];
$year = $_POST["year"];

//... get the list of events due to month and year

//create an events array due to docs
$events = array(array('id' => 1, 'title' => 'Event', 'allDay' => true)); 

//return json feed
echo json_encode($events);
?> 
```

# java - Java Gui 返回项

> ID：13278129
> 
> 赞同：0
> 
> 时间：2012-11-07T20:59:47.857
> 
> 标签：java, swing, user-interface, textfield

我想从 gui 实例中获得回报我运行来创建 GUI 的代码：

```
JFrame frame = new JFrame();
frame.getContentPane().add(new ChatPopup());
frame.setDefaultCloseOperation(WindowConstants.DISPOSE_ON_CLOSE);
frame.pack();
frame.setVisible(true); 
```

我的 GUI（ChatPopUp 代码如下：

```
public class ChatPopup extends javax.swing.JPanel {
private JButton cancelButton;
private JTextField textFieldchatRoomName;
private JLabel jLabel1;
private JButton okButton;

public ChatPopup() {
    super();

    initGUI();
}

private void initGUI() {
    try {
        this.setPreferredSize(new java.awt.Dimension(294, 85));
        {
            jLabel1 = new JLabel();
            this.add(jLabel1);
            jLabel1.setText("Please enter the new chat room name:");
        }
        {
            textFieldchatRoomName = new JTextField();
            this.add(textFieldchatRoomName);
            textFieldchatRoomName.setPreferredSize(new java.awt.Dimension(263, 22));
        }
        {
            cancelButton = new JButton();
            this.add(cancelButton);
            cancelButton.setText("Cancel");
            cancelButton.setPreferredSize(new java.awt.Dimension(84, 22));
            cancelButton.addActionListener(new ActionListener() {
                public void actionPerformed(ActionEvent evt) {
                    System.out.println("Cancel PRESSED");
                }
            });
        }
        {
            okButton = new JButton();
            this.add(okButton);
            okButton.setText("Ok");
            okButton.setPreferredSize(new java.awt.Dimension(60, 22));
            okButton.addActionListener(new ActionListener() {
                public void actionPerformed(ActionEvent evt) {
                    System.out.println("OK PRESSED");
                }
            });
        }
    } catch (Exception e) {
        e.printStackTrace();
    }
}

} 
```

这是一个非常简单的 GUI，它有一个文本字段和 2 个按钮，一个是“Ok”，一个是“Chancel”。当我单击“确定”时，我希望将 textField 值发送到最初运行 GUI 实例的类。

任何想法如何做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-08T15:56:52.600

您发布的内容`JPanel`应添加到模式`JDialog`内容窗格中。在同一个类中，您可以提供一些方法来返回用户在文本字段中输入的值。

在原始窗口中，您打开对话框。

```
SomeDialog dialog = new SomeDialog(parent);
dialog.setVisible(true); 
```

之后的代码`setVisible()`只会在模态对话框关闭后执行。此时您可以调用我上面提到的方法来获取文本字段值。

# ruby - 无法在 Ruby 代码中捕获 Errno::ECONNRESET

> ID：13278133
> 
> 赞同：1
> 
> 时间：2012-11-07T21:00:09.390
> 
> 标签：ruby, heroku, amazon-s3, fog

在部署到 Heroku 的 Rails 3.1 项目中，我有一个 rake 任务，它根据数据库中的记录生成几十万个小 PNG，并使用[雾](http://fog.io/)将结果上传到 S3 ，一次一个文件。（在我使用 heroku 之前，该任务将文件保存在本地，一切正常。）当我使用 运行任务时`heroku run:detached`，它运行了一段时间，并上传了一堆文件，但最终以`Connection reset by peer (Errno::ECONNRESET)`. 奇怪的是，我修改了脚本以捕获并重试该异常，如下所示：

```
file_exists = false
retry_count = 10
begin
  file_exists = directory.files.head(filekey)
rescue Errno::ECONNRESET => e
  if retry_count > 0 then
    logger.warning("Connection reset: #{e.inspect}")
    retry_count -= 1
    sleep(1)
    retry
  else
    raise
  end
end 
```

根据堆栈跟踪，`file_exists = directory.files.head(filekey)`是我的代码行导致异常，所以我觉得我错过了一些关于 Ruby 异常处理的东西。我很想知道我做错了什么，因为我不能 100% 确定这是否是我的开始/救援块的问题，雾处理网络错误的方式，或者什么。

这是完整的堆栈跟踪：

```
Nov 07 12:08:01 ... app/run.1:  Connection reset by peer (Errno::ECONNRESET)
Nov 07 12:08:01 ... app/run.1:  /app/vendor/ruby-1.8.7/lib/ruby/1.8/openssl/buffering.rb:36:in `sysread'
Nov 07 12:08:01 ... app/run.1:  /app/vendor/ruby-1.8.7/lib/ruby/1.8/openssl/buffering.rb:36:in `fill_rbuff'
Nov 07 12:08:01 ... app/run.1:  /app/vendor/ruby-1.8.7/lib/ruby/1.8/openssl/buffering.rb:68:in `read'
Nov 07 12:08:01 ... app/run.1:  /app/vendor/bundle/ruby/1.8/gems/excon-0.16.7/lib/excon/socket.rb:121:in `read'
Nov 07 12:08:01 ... app/run.1:  /app/vendor/ruby-1.8.7/lib/ruby/1.8/timeout.rb:67:in `timeout'
Nov 07 12:08:01 ... app/run.1:  /app/vendor/bundle/ruby/1.8/gems/excon-0.16.7/lib/excon/socket.rb:120:in `read'
Nov 07 12:08:01 ... app/run.1:  /app/vendor/bundle/ruby/1.8/gems/excon-0.16.7/lib/excon/ssl_socket.rb:79:in `read'
Nov 07 12:08:01 ... app/run.1:  /app/vendor/bundle/ruby/1.8/gems/excon-0.16.7/lib/excon/response.rb:21:in `parse'
Nov 07 12:08:01 ... app/run.1:  /app/vendor/bundle/ruby/1.8/gems/excon-0.16.7/lib/excon/connection.rb:275:in `request_kernel'
Nov 07 12:08:01 ... app/run.1:  /app/vendor/bundle/ruby/1.8/gems/excon-0.16.7/lib/excon/connection.rb:103:in `request'
Nov 07 12:08:01 ... app/run.1:  /app/vendor/bundle/ruby/1.8/gems/fog-1.6.0/lib/fog/core/connection.rb:20:in `request'
Nov 07 12:08:01 ... app/run.1:  /app/vendor/bundle/ruby/1.8/gems/fog-1.6.0/lib/fog/aws/storage.rb:392:in `request'
Nov 07 12:08:01 ... app/run.1:  /app/vendor/bundle/ruby/1.8/gems/fog-1.6.0/lib/fog/aws/requests/storage/head_object.rb:53:in `head_object'
Nov 07 12:08:01 ... app/run.1:  /app/vendor/bundle/ruby/1.8/gems/fog-1.6.0/lib/fog/aws/models/storage/files.rb:98:in `head'
Nov 07 12:08:01 ... app/run.1:  /app/lib/tasks/assets.rake:45
Nov 07 12:08:01 ... app/run.1:  /app/lib/tasks/assets.rake:37:in `each'
Nov 07 12:08:01 ... app/run.1:  /app/lib/tasks/assets.rake:37
Nov 07 12:08:01 ... app/run.1:  /app/vendor/bundle/ruby/1.8/gems/activerecord-3.1.8/lib/active_record/relation/batches.rb:21:in `find_each'
Nov 07 12:08:01 ... app/run.1:  /app/vendor/bundle/ruby/1.8/gems/activerecord-3.1.8/lib/active_record/relation/batches.rb:21:in `each'
Nov 07 12:08:01 ... app/run.1:  /app/vendor/bundle/ruby/1.8/gems/activerecord-3.1.8/lib/active_record/relation/batches.rb:21:in `find_each'
Nov 07 12:08:01 ... app/run.1:  /app/vendor/bundle/ruby/1.8/gems/activerecord-3.1.8/lib/active_record/relation/batches.rb:69:in `find_in_batches'
Nov 07 12:08:01 ... app/run.1:  /app/vendor/bundle/ruby/1.8/gems/activerecord-3.1.8/lib/active_record/relation/batches.rb:20:in `find_each'
Nov 07 12:08:01 ... app/run.1:  /app/lib/tasks/assets.rake:35
Nov 07 12:08:01 ... app/run.1:  /app/vendor/bundle/ruby/1.8/gems/rake-0.9.2.2/lib/rake/task.rb:205:in `call'
Nov 07 12:08:01 ... app/run.1:  /app/vendor/bundle/ruby/1.8/gems/rake-0.9.2.2/lib/rake/task.rb:205:in `execute'
Nov 07 12:08:01 ... app/run.1:  /app/vendor/bundle/ruby/1.8/gems/rake-0.9.2.2/lib/rake/task.rb:200:in `each'
Nov 07 12:08:01 ... app/run.1:  /app/vendor/bundle/ruby/1.8/gems/rake-0.9.2.2/lib/rake/task.rb:200:in `execute'
Nov 07 12:08:01 ... app/run.1:  /app/vendor/bundle/ruby/1.8/gems/rake-0.9.2.2/lib/rake/task.rb:158:in `invoke_with_call_chain'
Nov 07 12:08:01 ... app/run.1:  /app/vendor/ruby-1.8.7/lib/ruby/1.8/monitor.rb:242:in `synchronize'
Nov 07 12:08:01 ... app/run.1:  /app/vendor/bundle/ruby/1.8/gems/rake-0.9.2.2/lib/rake/task.rb:151:in `invoke_with_call_chain'
Nov 07 12:08:01 ... app/run.1:  /app/vendor/bundle/ruby/1.8/gems/rake-0.9.2.2/lib/rake/task.rb:144:in `invoke'
Nov 07 12:08:01 ... app/run.1:  /app/vendor/bundle/ruby/1.8/gems/rake-0.9.2.2/lib/rake/application.rb:116:in `invoke_task'
Nov 07 12:08:01 ... app/run.1:  /app/vendor/bundle/ruby/1.8/gems/rake-0.9.2.2/lib/rake/application.rb:94:in `top_level'
Nov 07 12:08:01 ... app/run.1:  /app/vendor/bundle/ruby/1.8/gems/rake-0.9.2.2/lib/rake/application.rb:94:in `each'
Nov 07 12:08:01 ... app/run.1:  /app/vendor/bundle/ruby/1.8/gems/rake-0.9.2.2/lib/rake/application.rb:94:in `top_level'
Nov 07 12:08:01 ... app/run.1:  /app/vendor/bundle/ruby/1.8/gems/rake-0.9.2.2/lib/rake/application.rb:133:in `standard_exception_handling'
Nov 07 12:08:01 ... app/run.1:  /app/vendor/bundle/ruby/1.8/gems/rake-0.9.2.2/lib/rake/application.rb:88:in `top_level'
Nov 07 12:08:01 ... app/run.1:  /app/vendor/bundle/ruby/1.8/gems/rake-0.9.2.2/lib/rake/application.rb:66:in `run'
Nov 07 12:08:01 ... app/run.1:  /app/vendor/bundle/ruby/1.8/gems/rake-0.9.2.2/lib/rake/application.rb:133:in `standard_exception_handling'
Nov 07 12:08:01 ... app/run.1:  /app/vendor/bundle/ruby/1.8/gems/rake-0.9.2.2/lib/rake/application.rb:63:in `run'
Nov 07 12:08:01 ... app/run.1:  /app/vendor/bundle/ruby/1.8/gems/rake-0.9.2.2/bin/rake:33
Nov 07 12:08:01 ... app/run.1:  /app/vendor/bundle/ruby/1.8/bin/rake:23:in `load'
Nov 07 12:08:01 ... app/run.1:  /app/vendor/bundle/ruby/1.8/bin/rake:23
Nov 07 12:08:01 ... app/run.1:  Tasks: TOP => ...:make_outlines
Nov 07 12:08:02 ... heroku/run.1:  Process exited with status 1
Nov 07 12:08:02 ... heroku/run.1:  State changed from up to complete 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-07T21:04:37.247

也许试试这样：

```
begin
  ...
rescue Errno::ECONNRESET => e
  ...
rescue => e
  ...
end 
```

# sql - 用新数据重新填充 UITableView

> ID：13278134
> 
> 赞同：1
> 
> 时间：2012-11-07T21:00:09.550
> 
> 标签：sql, xcode, uitableview

我正在使用 UIAlertView 实现搜索功能，它将在 SQL 表中搜索匹配项并重新填充 UITableView。到目前为止，我在下面有这段代码。“结果”是从搜索查询返回的匹配数据数组。然后，我检查了“元素”是否为空，这意味着它与 SQL 表中的任何项目都不匹配。如果是这样，那么我想删除当前在 UITableView 上的数据并替换为“结果”数据。

到目前为止，这是我的代码：

```
 NSUInteger *elements = [results count];
            if(elements == 0)
            {
                UIAlertView *av = [[UIAlertView alloc]initWithTitle:@"Item Not Found" message:@"Sorry the item was not found" delegate:self cancelButtonTitle:@"Cancel"
                                                  otherButtonTitles:nil, nil];
                [av show];
            }
            if(elements >= 1)
            {
                    //Repopulate UITableView with Data
                    self.itemTitles = itemstitle;
                    self.itemPrices = itemsprice;
                    self.itemCategory = itemscategory;
            } 
```

注意：我尝试使用`[tableView reloadData]`但不确定在这种情况下如何实现它。

在此先感谢您的帮助。

# java - 单击按钮时在java中隐藏一个框架

> ID：13278137
> 
> 赞同：1
> 
> 时间：2012-11-07T21:00:38.283
> 
> 标签：java, swing, button, hide, frame

单击按钮后，我试图隐藏框架。“注册”按钮应该打开一个用户可以注册的框架，这很有效，但我试图隐藏前一个框架，我不知道该怎么做。

这是我的代码：

主页.java

```
package Practice_1;
import java.awt.*;
import java.awt.Insets;
import java.awt.GridBagLayout;
import java.awt.event.ActionEvent;
import java.awt.event.ActionListener;
import javax.swing.*;
/**
 *
 * @author Ivan 
 */
public class MainPage extends JPanel 
{
    JButton regButton, logButton, listButton;
    JLabel homeMessage;
    GridBagConstraints gbc = new GridBagConstraints();

    public MainPage()
    {
        setLayout(new GridBagLayout());

        gbc.insets = new Insets(5,5,5,5);

        homeMessage = new JLabel("Please select an option below:");
        gbc.gridx = 0;
        gbc.gridy = 0;
        add(homeMessage, gbc);

        regButton = new JButton("Register");
        gbc.gridx = 0;
        gbc.gridy = 1;
        gbc.fill = GridBagConstraints.HORIZONTAL;

        regButton.addActionListener(new ActionListener() {

            public void actionPerformed(ActionEvent e)
            {
                //Execute when button is pressed
                //System.out.println("clicked");
                RegisterPage regFrame = new RegisterPage();

                JFrame register = new JFrame();
                register.setTitle("Registration");
                register.setSize(300,200);
                register.setVisible(true);
                register.add(regFrame);
                new MainPage().setVisible(false);  / THIS DOES NOT WORK

            }
        });
        add(regButton, gbc);

        logButton = new JButton("Log in");
        gbc.ipadx = 40;
        gbc.gridx = 0;
        gbc.gridy = 2;
        add(logButton, gbc);

        listButton = new JButton("Customer list");
        gbc.ipadx = 40;
        gbc.gridx = 0;
        gbc.gridy = 3;
        add(listButton, gbc);

        JFrame home = new JFrame();

        home.setTitle("Main menu");
        home.setSize(300,200);
        home.setResizable(false);
        home.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
        home.setVisible(true);
        home.add (mainFrame);

    }

    public static void main(String[] args) {
        // TODO code application logic here
        MainPage mainFrame = new MainPage();

    }
} 
```

注册页面.java

```
package Practice_1;

import java.awt.GridBagConstraints;
import java.awt.GridBagLayout;
import java.awt.Insets;
import javax.swing.JButton;
import javax.swing.JLabel;
import javax.swing.JPanel;

/**
 *
 * @author Ivan
 */
public class RegisterPage extends JPanel {

    //JButton regButton, logButton, listButton;
    JLabel homeMessage;
    GridBagConstraints gbc = new GridBagConstraints();

    public RegisterPage()
    {
        setLayout(new GridBagLayout());

        gbc.insets = new Insets(5,5,5,5);

        homeMessage = new JLabel("Register new user:");
        gbc.gridx = 0;
        gbc.gridy = 0;
        add(homeMessage, gbc);

    }

} 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-11-07T21:11:52.487

根据您的代码，您试图隐藏`JPanel`而不是`JFrame`. 我的建议是使用

```
public class MainPage extends JFrame 
```

而不是像这样实例化你`JPanel`：

```
JPanel panel = new JPanel(); 
```

并在该面板上添加组件。要隐藏您的 MainPage，您可以调用：

```
this.setVisible(false); 
```

但如果你使用会更好：

```
this.dispose(); 
```

# sql - 具有单个 GUID 列的 SQL Server MergeReplication

> ID：13278138
> 
> 赞同：0
> 
> 时间：2012-11-07T21:00:40.847
> 
> 标签：sql, replication

我有一个包含单列的表，它是主键，uniqueidentified，rowguid = true。如果创建合并复制，代理将无法启动：

“该文章仅包含 rowguidcol 列。您必须至少发布一个其他列。”

有没有办法发布这个表，而不删除 rowguid 并添加第二列？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-08T06:09:10.393

发生的情况是快照代理错误地将您的 rowguid 列识别为合并复制中发布的每个表所需的 ROWGUIDCOL。

有关合并复制创建并用于唯一标识已发布文章中的每一行的列的更多信息，请参阅[增强合并复制性能](http://msdn.microsoft.com/en-us/library/ms152770.aspx)中的*快照注意事项部分。*

由于现有列的性质，很可能需要添加第二个虚拟列才能使其适用于合并复制。

# mysql - 智能计算加入mysql中的id

> ID：13278141
> 
> 赞同：0
> 
> 时间：2012-11-07T21:00:54.197
> 
> 标签：mysql, if-statement, count, sum, case

运行此查询时，COUNT 函数不会按“check_if_new_customer”标志进行过滤。我在这篇文章中读到：[http](http://dev.mysql.com/tech-resources/articles/wizard/page4.html) ://dev.mysql.com/tech-resources/articles/wizard/page4.html 在某些情况下可以使用 SUM 而不是 COUNT 来获得更准确的结果，但是当我尝试这样做时，我得到了一些非常不同的东西，它似乎显示出大量的数字翻倍。我认为这可能是因为我正在对 id 字段中的 UUID 求和，而不是在该点进行计数。关于我可以放什么来计算所有现有客户与新客户的任何建议？

```
SELECT
  YEAR(so.date_entered),
  so.technical_address_country,
  so.technical_address_state,
  COUNT(so.id) as all_sales,
  COUNT(mf.id) as all_jobs,
  SUM(so.total_value) as all_value,
    COUNT(IF(so.check_if_new_customer=1,so.id,0)) as sales_order_new,
  SUM(IF(so.check_if_new_customer = 1,so.total_value,0)) as total_value_new,
    COUNT(IF(so.check_if_new_customer=1,mf.id,0)) as jobs_new,
    COUNT(IF(so.check_if_new_customer=0,so.id,0)) as sales_order_existing,
  SUM(IF(so.check_if_new_customer = 0,so.total_value,0)) as total_value_existing,
    COUNT(IF(so.check_if_new_customer=0,mf.id,0)) as jobs_existing,
    SUM(IF(so.check_if_new_customer=0,mf.id,0)) as jobs_existing_t
FROM 
  sugarcrm2.so_order so 
LEFT JOIN 
  sugarcrm2.mf_job mf on so.id = mf.sales_order_id 
WHERE 
  so.date_entered > "2011-10-30" AND 
    so.technical_address_country IS NOT NULL AND  
  so.technical_address_state IS NOT NULL AND 
  so.deleted = 0 AND 
  so.has_been_promoted = 1 
GROUP BY 
    YEAR(so.date_entered),
  so.technical_address_country, 
  so.technical_address_state
ORDER BY 
  so.technical_address_country, so.technical_address_state 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-07T21:12:38.713

[`COUNT()`](http://dev.mysql.com/doc/en/group-by-functions.html#function_count)返回其参数（如果指定）为 non 的记录数`NULL`。由于在这种情况下它的参数是一个`IF()`表达式的结果（如果为真，如果为假，则计算某个列的值`0`），几乎每条记录都将被计算在内，而与测试条件无关。

[`SUM()`](http://dev.mysql.com/doc/en/group-by-functions.html#function_sum)，顾名思义，将其参数的值相加。在这种情况下，只要测试条件为真，它就会对引用列的值求和。

显然，您所追求的也不是，尽管您的问题对于您到底想要什么是相当模棱两可的。猜测一下，你可能想要这样的东西：

```
SUM(so.check_if_new_customer) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-07T21:23:28.303

If you want to use `SUM()` like `COUNT()` you will need to pass it either a 1 or 0 so that all of the 1's will sum up to your desired count. So in your example, if you want a sum of all the new jobs you would do this:

> SUM(IF(so.check_if_new_customer=1,1,0)) as jobs_new

or if so.check_if_new_customer always returns a 1 or 0 you could alternatively do this:

> SUM(so.check_if_new_customer) as jobs_new

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-07T21:21:29.827

每次连接表的 id 字段不为空时，我想求和 +1。

SUM(IF(so.check_if_new_customer=0 AND mf.id IS NOT NULL,1,0)) as jobs_existing

# git - 自从我上次使用 Git 拉动以来，我如何才能获得在远程服务器上更改的唯一文件列表

> ID：13278144
> 
> 赞同：0
> 
> 时间：2012-11-07T21:01:09.097
> 
> 标签：git

我们试图弄清楚从我们以前的版本控制系统迁移到 git 是否有意义。我们正在努力解决的一个问题是如何简洁地弄清楚自上次拉取以来其他人在所有提交中更改了哪些文件。**特别是，如果同一个文件在多次提交中被更改，我们只想在列表中看到该文件一次。** 从我读过的内容来看，似乎我必须先拉取远程存储库才能进行检查，但即便如此，似乎也没有一种（简单的？）方法来获取所有已更改文件名的列表。我们对 git 的理解还不是很深，但是做 fetch 的顾虑是一些非常大的文件（图像、aiff 等）可能已经被推送了，没有人愿意为了找出发生了什么而不得不去获取所有内容? 我已经阅读了 stackoverflow 中的其他一些 Q/As，但尽管我看到了看起来相似的问题，但我还没有看到任何似乎可行的答案。我们一直在尝试几种 GUI 工具来让生活更轻松（Tower 和 SmartGit），但它们似乎都无法做到这一点。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-07T21:11:37.997

显示当前和以前的主文件之间更改了哪些文件的方法：

```
git fetch
git diff --stat master origin/master 
```

第一个命令在不更改树的情况下检索最新更新。第二个打印一个已更改文件的列表（以及插入/删除统计信息） - 如果您输入了所有提交，则会被拉出`git pull`。之后，您可以运行`git merge origin/master`以将您的更改与上游的更改合并。（这相当于 a `git pull`，除了 pull 可以从服务器获取*新*的更改（如果在此期间已推送任何更改。）

不幸的是，git 并没有明确说明如何在*不*将更新拉到本地的情况下进行差异化。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-08T06:46:01.337

通过 ssh 直接访问存储库，您可以从本地克隆运行类似的内容。

```
ssh githost "git --git-dir=/data/repo.git diff --name-only\
             $(git rev-parse origin/master) master" 
```

您可能希望将其放入脚本或别名中。请注意`$(git rev-parse origin/master)`克隆中本地运行以检索克隆的远程跟踪分支的 id。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-07T21:04:11.893

尝试：

```
git log --stat 
```

这应该打印出当前签出存储库的详细日志。

如果不先在本地签出，不确定 git 会做你想做的事。

# asp.net - 列表框项宽度

> ID：13278146
> 
> 赞同：0
> 
> 时间：2012-11-07T21:01:16.440
> 
> 标签：asp.net, css, telerik

我有一个 radlistbox 并且正在以编程方式插入项目，如何扩展项目的宽度，以便多个项目不会像现在显示的那样显示在一行上。

目前正在将项目插入到 c# 中的列表框中，例如：

```
rlbAssigned.Items.Add(new RadListBoxItem(rlbAvailable.Items[rlbAvailable.SelectedIndex].Text, rlbAvailable.Items[rlbAvailable.SelectedIndex].Value)); 
```

并且列表框声明为：

```
<telerik:RadListBox ID="rlbAvailable" runat="server" Height="320px" Width="200px">                                         </telerik:RadListBox> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-07T22:17:38.107

从未使用过 radlistbox 但看到您的其他解决方案，它看起来就像一个普通的列表项。

如果您只希望每行显示其中一个。显示块应该可以解决问题。

```
.RadListBox ul li       
    { 
      display:block;    
    } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-07T21:13:41.377

我想通了，因为它有 Ul 和 li 我使用 css 解决了它，如下所示：

```
 .RadListBox ul li       
    { 
      float: left !important;      
      width: 170px;
    } 
```

如果有人提出另一种解决方案，我会很高兴。

# sql - 使用不同的值遍历 sql 脚本

> ID：13278147
> 
> 赞同：0
> 
> 时间：2012-11-07T21:01:20.757
> 
> 标签：sql, sql-server-2008

这是我的脚本的一部分：

```
DECLARE @dataId int = 123               

-- Here I run more SQL scripts using @dataId

Select from table A where id = @dataId 

-- So on it goes in other tables and delete and update other tables 
```

我的问题是有一种方法可以输入 100 个值`@dataId`，它会按顺序遍历脚本吗？在 SQL Server 2008 中是否有更简单的方法来执行此操作，而不是`@dataId`每次手动输入？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-07T21:21:29.870

好吧，根据您的评论，我想这`CURSORS`就是要走的路。这样的事情应该做：

```
DECLARE @dataId int

DECLARE DataIds CURSOR LOCAL STATIC READ_ONLY FORWARD_ONLY FOR
SELECT DataId
FROM YourTableWithDataIdsHere

OPEN DataIds
FETCH NEXT FROM DataIds INTO @dataId
WHILE @@FETCH_STATUS = 0
BEGIN

    -- Here I run more SQL scripts using @dataId

    Select from table A where id = @dataId 

    -- So on it goes in other tables and delete and update other tables

    FETCH NEXT FROM DataIds INTO @dataId
END

CLOSE DataIds
DEALLOCATE DataIds 
```

# sql-server - case语句一次选择多行

> ID：13278148
> 
> 赞同：0
> 
> 时间：2012-11-07T21:01:22.800
> 
> 标签：sql-server, sql-server-2008, case

我希望根据条件参数从两个不同的表中提取相同的列。

所以我偶然发现了我以前很少使用的 CASE 语句。我发现这对我有用，但如果我可以做一个 CASE 语句然后选择我需要的列，而不是每列都做，我会喜欢它。

这是我拥有和工作的一个例子，看起来有点多余。

```
SELECT TOP(10)
    u1.userid as userid,
    version = CASE
        WHEN (u2.userid IS NULL OR u1.enabled = 0)
        THEN 3
        ELSE 4
    END,
    nameOrg = CASE
        WHEN (u2.userid IS NULL OR u1.enabled = 0)
        THEN CONVERT(NVARCHAR, u1.title)
        ELSE CONVERT(NVARCHAR, u2.title)
    END,
    nameContact = CASE
        WHEN (u2.userid IS NULL OR u1.enabled = 0)
        THEN CONVERT(NVARCHAR, u1.contact)
        ELSE CONVERT(NVARCHAR, u2.contact)
    END,
    pltName = CASE
        WHEN (u2.userid IS NULL OR u1.enabled = 0)
        THEN p1.name
        ELSE p2.name
    END
FROM
    usr1 u1
LEFT OUTER JOIN
    usr2 u2
    ON u1.userid = u2.userid
LEFT OUTER JOIN
    plt2 p2
    ON u2.pltid = p2.pltid
LEFT OUTER JOIN
    plt1 p1
    ON u1.pltid = p1.pltid 
```

有什么建议吗？

*   编辑 mov 7, 5:22：添加连接到 plt 表和 pltName 案例，以添加到所需的功能。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-07T21:53:00.630

如果 usr2 数据集中没有匹配的用户 ID，则所有字段都将为空。您可以使用 isnull 函数来使其不那么冗长，就像我在下面所做的那样，但您不会只写一行。

```
SELECT TOP(10)
    u1.userid as userid
    ,version = CASE
        WHEN (u2.userid IS NULL OR u1.enabled = 0)
        THEN 3
        ELSE 4
    END 
    ,CONVERT(NVARCHAR,isnull(u2.title,u1.title)) nameOrg
    ,CONVERT(NVARCHAR,isnull(u2.contact,u1.contact)) nameContact
FROM
    usr1 u1
LEFT OUTER JOIN
    usr2 u2
ON u1.userid = u2.userid 
```

# html - 您可以通过 html url 方案打开 iOS6 共享表吗？

> ID：13278150
> 
> 赞同：1
> 
> 时间：2012-11-07T21:01:41.647
> 
> 标签：html, ios, url, share

只是想知道这是否可以通过 url 实现？就像您可以通过输入打开推文机器人一样：

```
tweetbot://post?message=hello%20world 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-07T21:36:12.120

共享表是一个模式视图，将出现在您的应用程序中——它不是一个单独的应用程序，您使用 URL 方案就是为了它。

# c# - 什么更有效，数据表或自定义对象？

> ID：13278159
> 
> 赞同：0
> 
> 时间：2012-11-07T21:02:00.820
> 
> 标签：c#, wpf, mvvm, dataset

通常，当使用表单应用程序处理来自数据库的数据时，我会将其保存在数据集或数据表中，并根据需要提取数据。现在，我正在使用 WPF 并尝试更符合 MVVM 模式。将这些数据表转换为对象可以更轻松地与 MVVM 一起使用。

例如，如果我有一个由这样的查询填充的表 - **Select p.first_name, p.last_name, p.phone,p.email from person as p where p.first_name = 'Bob'** 而不是保留数据表，我现在将其转换为人员对象。

从性能的角度来看，制作对象是否存在和失败，或者我应该坚持使用数据集和数据表？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-07T21:17:38.517

在您所描述的应用程序中，使用诸如 EF（或滚动您自己的）而不是 DataTable/DataSet 的 ORM 对性能的影响可以忽略不计，但这取决于它的实现方式。

使用 ORM 的主要优点是确保类型安全，并且在从 DataTable 对象检索数据时不必执行类型转换。在 Linq 中使用延迟加载也有好处。

我不认为到处使用实体对象一定是一个解决方案。在 ViewModel 中使用 DataTable 对象并没有什么真正的问题（尽管我不确定您将如何使用 DataTable 类的数据同步功能，但您可以完全不使用它）。

在一个新项目中，我会使用 EF，只是因为我喜欢为我处理打字，但如果你有一个使用工作正常的表的旧项目，我会坚持使用它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-07T21:18:27.600

只要确保您的对象仅包含必要的字段并包含这些对象，如果它们使解决方案更清晰。

任何最终的性能下降（最小）都将通过更清洁和更清晰的解决方案的潜在长期性能优势得到补偿。

# mercurial - Mercurial 错误：无法导入扩展 hgext.gpg

> ID：13278167
> 
> 赞同：0
> 
> 时间：2012-11-07T21:02:39.827
> 
> 标签：mercurial, mercurial-extension

我试图启用 Mercurial 附带的 gpg 扩展来签署我的变更集。

我正在使用以下两行来启用 hgrc 文件中的扩展：[extensions]

```
hgext.gpg= FILEPATH 
```

将这些行添加到 hgrc 文件后，我收到以下错误：

```
***Failed to import extension hgext.gpg from ...location...: Non-ASCII character '\xf3' in file ...location... on line 1, 
but no encoding declared; see http://www.python.org/dev/peps/pep-0263.html for details 
```

有人能帮我吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-08T00:04:14.840

好的，我阅读了[GPG 扩展 Wiki](http://mercurial.selenic.com/wiki/GpgExtension)

> 此扩展程序目前与 Mercurial 一起分发

和**配置**部分也

> 通过添加以下行来配置您的 .hgrc 以启用扩展：

```
[extensions]
hgext.gpg= 
```

（看你的不同）

# c# - 解析格式为“Nov. 7, 2012, 9:02 pm”的日期时间字符串

> ID：13278170
> 
> 赞同：0
> 
> 时间：2012-11-07T21:02:46.317
> 
> 标签：c#

如何解析格式为“2012 年 11 月 7 日晚上 9:02”的日期字符串

我想我很接近了。试过：

```
 string line = "Nov. 7, 2012, 9:02 p.m.";
        string format = "MMM. dd, yyyy, hh:mm p.m."; ;
        DateTime result = DateTime.ParseExact(line, format, null); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-07T21:16:49.257

这将起作用。

```
 string format = string.Format("{0:MMM. dd, yyyy, hh:mm tt}", DateTime.Now);
        Console.WriteLine(format); 
```

这将以您预期的格式打印结果（2012 年 11 月 7 日，晚上 9:02）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-07T21:08:43.030

```
string format = "MMMM. dd, yyyy, hh:mm p.m."; 
```

你用 4 M 的时间度过了整整一个月

尝试

```
string format = "MMM. dd, yyyy, hh:mm p.m."; 
```

得到短暂的月份，即 11 月 -> 11 月

这是参考指南：http: [//msdn.microsoft.com/en-us/library/8kb3ddd4.aspx](http://msdn.microsoft.com/en-us/library/8kb3ddd4.aspx)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-07T21:29:19.770

使用单个`h`而不是`hh`. 此外，`t.'m'.`可能会匹配您的 am/pm，具体取决于它是否区分大小写。

# jquery - 最后执行 jQuery 块

> ID：13278172
> 
> 赞同：0
> 
> 时间：2012-11-07T21:02:48.757
> 
> 标签：jquery, timeout, delay, execute

**[在将我的问题称为此](https://stackoverflow.com/questions/1549200/forcing-a-jquery-ready-block-to-run-after-all-other-ready-blocks)问题的副本之前，请通读我的问题。**

我的博客文章有一组演示页面。这些页面可以有 CSS、HTML、jQuery/JS 或三者的任意组合。页面组织如下：

```
<div id="page-wrapper">
<style type="text/css">
//CSS here.
</style>

<!--Include jQuery here-->
<script type="text/javascript">
//JS here
</script>

<!--Demo HTML would go here-->
</div> 
```

（我知道正文中的样式标签不好，我有我的理由。）

在页面包装器 div 之后，我包含了一个 JavaScript 源文件，该文件创建了一个“查看源”链接/按钮。

出现问题是因为演示 JavaScript 可能包含对 CSS 的更改，并且这些更改显示在演示 HTML（例如`style="color: #ff0000; "`）中，因为代码最后被 JavaScript 源文件“获取”，如下所示：

```
var sourceCode = "<!DOCTYPE HTML>\n<html>" + $('html').html() + "\n</html>"; 
```

我希望演示 jQuery 最后执行；也就是说，在执行源文件包含之后。我不能做以下事情：

1.  将源文件包含/引用移动到`<head>`标签，因为 jQuery 包含在正文中。这是为了让源代码查看者知道我正在使用 jQuery。
2.  将代码添加到演示 JavaScript 以使其等待，因为源代码查看者会感到困惑。
3.  让演示 JavaScript 等待*太久*，因为观众不耐烦 :)

有解决办法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-07T21:13:49.800

看起来您正在创建类似 jsFiddle 或 jsBin 的东西。

你可以做的是确保你想要注入到模板中的 JS 代码被注入到函数回调中。该`onload`事件听起来应该做你想做的事。

```
<div id="page-wrapper">
    <style>
        <!-- ### demo CSS -->
    </style>
    <script>
        (function ($) {
            $(window).load(function () {
                <!-- ### demo JS -->
            });
        })(jQuery);
    </script>
    <!-- ### demo HTML -->
</div> 
```

根据您的实施，这可能不起作用，因此您可以尝试触发自定义事件回调，如果`onload`没有削减它。

```
<script>
    (function ($) {
        $(window).on('my.custom.event', function () {
            <!-- ### demo JS -->
        });
    })(jQuery);
</script>
<!-- ### demo HTML -->
<script>
    jQuery(window).trigger('my.custom.event');
</script> 
```

# ruby-on-rails-3 - Rails 3 中的关联

> ID：13278177
> 
> 赞同：0
> 
> 时间：2012-11-07T21:03:04.280
> 
> 标签：ruby-on-rails-3, associations

我有一个应用程序，它允许用户添加食谱，然后选择他们最喜欢的食谱以在他们的会员区查看，我可以选择一个最喜欢的，我得到 user_id、recipe_id 并给它一个 favourite_id。

我想做的是将实际食谱输出到我的视图中（作为收藏夹），例如菜名、country_of_origin 等。我可以使用实际食谱而不是收藏夹来执行此操作。我需要为此使用 has_many_through 吗？

我的模型看起来像这样

用户

```
has_many :recipes
has_many :favourites 
```

食谱

```
belongs_to :user
has_many :ingredients 
has_many :preperations
has_many :favourites 
```

最爱

```
belongs_to :user
belongs_to :recipe

attr_accessible :user_id, :recipe_id 
```

我的控制器

```
 @favourites = current_user.favourites 
```

我的链接发布

```
 <%= link_to "Add to favorites",  {:controller => 'favourites', :action => 'create', :recipe_id => r.id}, {:method => :post } %> 
```

我可以列出当前用户的食谱，这是我的控制器

```
@recipes = current_user.recipes if current_user.recipes 
```

然后像这样将它们输出到视图

```
 <% @recipes.each do |r| %>
 <tr>
 <td><%= r.dish_name %></td>
 <td><%= r.country_of_origin %></td>
 <td><%= r.difficulty %></td>
 <td><%= r.preperation_time %></td>
 <td><%= ingredient_names(r.ingredients) %></td>
 <td><%= preperation_steps(r.preperations) %></td>
 <td><%= image_tag r.avatar.url(:thumb)%></td>
 <tr> 
```

所以如果我在视图中这样做

```
 <li><%= @favourites %></li> 
```

我得到这个输出

```
 <Favourite id: 16, user_id: 8, recipe_id: 21, created_at: "2012-11-07 20:24:39", updated_at: "2012-11-07 20:24:39">] 
```

如果我尝试

```
 <%= @favourites.dish_name %> 
```

然后我得到错误未定义的方法dish_name

我如何让配方模型的参数显示在视图中。我很抱歉只是无法解决，我猜这应该很容易吗？

任何帮助表示赞赏

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-07T21:10:32.517

你得到 undefined disc_name 因为你最喜欢的模型没有这样的属性。

`@favourites = current_user.favourites`返回收藏夹对象的数组。

在你看来，你会做类似的事情

```
 <% @favourites.each do |f| %>
   <%= f.recipe %>
 <% end %> 
```

这将显示您 current_user 最喜欢的所有食谱。您可以缩小范围以显示特定的食谱或其他什么。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-07T21:07:02.893

最喜欢的只是保持关系。您可以通过以下方式访问食谱

```
@favourites.recipe 
```

然后它将是一个食谱对象并包含您的属性，如 disc_name 等。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-07T21:23:46.653

@favourites 是一个数组，是吗？然后，您必须遍历 @favourites 并单独处理每个元素，如下所示：

```
<% @favourites.each do |favorite| %>
  <%= favorite.recipe.dish_name %>    
<% end %> 
```

# jena - 使用自动完成在网页中显示本体

> ID：13278184
> 
> 赞同：0
> 
> 时间：2012-11-07T21:03:32.807
> 
> 标签：jena

我需要将网页中 OWL 文件中的单词显示为自动完成字段。因此，当用户键入一个术语时，它应该查询使用 Protege 创建的本体文件并在自动完成文本字段中显示匹配项。

我怎样才能做到这一点？这可以使用 Jena API 吗？有人可以提供例子吗？我对本体完全陌生。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-12T10:21:00.773

您可以通过多种方式解决此问题：

1.  您可以拥有一个 Web 服务 (REST API)，它接受一个关键字并以自动完成字段进行响应。这里的 Web 服务可以使用 Jena API (SPARQL) 对本体进行查询。

2.  如果您的数据是 RDF 形式，您可以使用[链接](http://jowl.ontologyonline.org/)查询本体，然后使用[链接](http://code.google.com/p/rdfquery/)

SPARQL 查询语言（它是 Jena API 的一部分）有助于从本体中检索数据。

希望这些信息有所帮助。

# django - 如何在 django-mediagenerator 中为每个应用程序指定媒体包？

> ID：13278185
> 
> 赞同：0
> 
> 时间：2012-11-07T21:03:33.337
> 
> 标签：django, django-mediagenerator

[到目前为止， Django-mediagenerator](https://django-mediagenerator.readthedocs.org/en/latest/)一直很有帮助，但一直困扰我的是所有`MEDIA_BUNDLES`都定义在`settings.py`. 我希望能够在单个应用程序文件夹中定义媒体包。

媒体包如何按应用程序分开，而不是全部集中在`settings.py`？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-09T15:51:06.653

我发现这样做的唯一方法是自己做。我最终在与我的设置文件相同的文件夹中编写了一个小文件：

```
from settings import MEDIA_BUNDLES, INSTALLED_APPS

BUNDLE_NAME = 'MEDIA_BUNDLES'  # Name of bundles tuple
BUNDLE_FILE = 'media'          # Name of python file

for app_name in INSTALLED_APPS:
    if app_name.startswith('apps'):
        try:
            path = '{app}.{media}'.format(app=app_name, media=BUNDLE_FILE)
            app  = __import__(path, None, None, [BUNDLE_NAME])

            bundles       = getattr(app, BUNDLE_NAME)
            MEDIA_BUNDLES = MEDIA_BUNDLES + bundles
        except Exception, e:
            print e 
```

# python - 为 Python 安装 matplotlib 时出现问题——或者，如何在 Python 中绘制图形？

> ID：13278186
> 
> 赞同：0
> 
> 时间：2012-11-07T21:03:37.393
> 
> 标签：python, macos, python-3.x, python-2.7, python-module

我目前在 Mac 上安装了 Python2.7 和 Python3.3。我正在尝试安装 matplotlib，以便我可以创建烛台和折线图。我尝试了多种安装 matplotlib 的方法，但都失败了。例如：

```
port install py27-matplotlib
No broken files found.
MacBook$ python2.7
Python 2.7.1 (r271:86832, Jul 31 2011, 19:30:53) 
>>> import matplotlib
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
ImportError: No module named matplotlib 
```

尝试从 matplotlib-1.1.1 构建源代码会导致 C 标头错误。

我要解决的父问题是创建烛台和线图。是否有另一个图书馆更适合这个？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-07T21:48:18.467

好像你有一个**python 的路径**问题，也许这篇[文章](https://stackoverflow.com/questions/9305154/python-will-not-recognize-macports-installed-packages)会有所帮助。

更新：由于评论，我再次强调了我对路径问题的提示......

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-07T22:10:58.273

您需要使用 MacPorts 提供的 Python 2.7，而不是 Apple 提供的系统 Python 2.7。尝试：

```
/opt/local/bin/python2.7 
```

为避免必须使用绝对路径，请确保推荐的 MacPorts`bin`目录位于您的 shell 上`PATH`并运行`sudo port select python python27`以选择 MacPorts Python 2.7 作为`/opt/local/bin/python`.

# html - CSS 布局方法：圆角不是 CSS3 和图像沿边（不仅仅是角落）

> ID：13278193
> 
> 赞同：0
> 
> 时间：2012-11-07T21:04:02.460
> 
> 标签：html, css, layout

*   我需要制作具有最小宽度和最小高度但会扩展到浏览器大小的 80% 的 CSS 布局。
*   主 div 将具有圆角（使用图像，因为不支持 CSS3） - 但是，也有图像在顶部和底部以及左侧和右侧的角之间运行。这也提供了阴影效果。
*   挑战在于，因为我有 div which position:relative 和我的角落是 position: absolute （此时一切都很好），但是我希望我的中间图像扩展以填充角落之间的空间。除了这不能正常工作外，它会延伸到 div 的末尾。
*   我对一种全新的方法持开放态度，我在下面包含图像和代码，但可以随意解决代码使用背景颜色与必须使用我的图像。

这是我想要实现的目标：

![线框](../Images/5ad6031d27e04c67fe1373e4f44237fd.png) 以下是容器的图像：

[http://imgur.com/a/EVJgQ](http://imgur.com/a/EVJgQ)

这是一些代码...

HTML：

```
<html>
<head>
    <link rel="stylesheet" type="text/css" href="style.css" />
</head>
<body>
    <div class="pageWrapper">
        <div class="contentWrapper">
            <span class="top-left"></span>
            <span class="top-middle"></span>
            <span class="top-right"></span>
            <span class="bottom-left"></span>
            <span class="bottom-middle"></span>
            <span class="bottom-right"></span>
            <div class="content">
                <p>
                    Lorem ipsum dotor sit amet, consectetur adipiscing elit. 
                    Ut viverra lectus vitae est ullamcorper a tempus est commodo. 
                    Phasellus et pulvinar risus. Cras quis aliquet odio. Ut condimentum porta mi ultrices elementum. 
                    Maecenas feugiat magna at tellus convallis congue. Aenean tincidunt rutrum varius. Aenean nec eros id odio dapibus faucibus. 
                    Pellentesque blandit gravida erat id sodales. Etiam nunc odio, pharetra nec aliquam a, gravida at metus. Nullam dapibus vulputate blandit. 
                    Cum sociis natoque penatibus et magnis dis parturient montes, nascetur ridiculus mus. Vestibulum ullamcorper lectus ut sapien scelerisque 
                    vitae ullamcorper mauris venenatis.
                </p>
            </div>  
        </div>
    </div>
</body> 
```

CSS：

```
body {
background-color: #eeeee7;
}

.pageWrapper {
margin: 0px auto;       /* centers the div horizontally */
min-width: 900px;
min-height: 430px;
height: 80%;
width: 80%;
background-color: red;
}

.contentWrapper {
position: relative;        /* makes our corners absolute relative to our container not our browser window    */
background-color: yellow;
height: 100%;
width: 100%;
padding-right: 34px;
padding-left: 34px;
padding-top: 155px;
}

.top-left,
.top-right {
position: absolute;
height: 155px;
width: 34px;
background-color: blue;
}

.bottom-left,
.bottom-right {
position: absolute;
height: 29px;
width: 34px;
}

.top-left {
top: 0;
left: 0;
background-image:url('images/cornerLeftTop.jpg');
 }
 .top-right {
top: 0;
right: 0;
background-image:url('images/cornerRightTop.jpg');
 }
.bottom-left {
bottom: 0; 
left: 0;
background-image:url('images/cornerBottomLeft.jpg');
 }
.bottom-right {
bottom: 0;
right: 0;
background-image:url('images/cornerBottomRight.jpg');
 }
 .top-middle {
position: absolute;
top: 0;
left: 34px;
height: 155px;
width: 100%;
background-image:url('images/headerMiddle.jpg');
}

.bottom-middle {
position: absolute;
bottom: 0;
height: 29px;
width: 100%;
background-image:url('images/footerMiddle.jpg');
}

.middle-left {

}

.middle-right { 
```

}

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-08T20:33:35.307

这对我有用，我仍在完善在 < ie 8 中不起作用的最小宽度。我意识到有现代方法可以做到这一点。但是，我工作的地方仍然必须支持一些即 6 个用户。这行得通！

```
<html>
<head>
    <link rel="stylesheet" type="text/css" href="style.css" />
</head>
<body>
    <div class="pageWrapper">
        <div class="contentWrapper">    
            <div class="headerMiddle">
            </div>
            <span class="top-left"></span>
            <span class="top-right"></span>
            <div class="contentRight">
            </div>                                  
            <div class="contentLeft">
            </div>  
            <div class="content">                   
                <p>
                    Lorem ipsum dotor sit amet, consectetur adipiscing elit. 
                    Ut viverra lectus vitae est ullamcorper a tempus est commodo. 
                    Phasellus et pulvinar risus. Cras quis aliquet odio. Ut condimentum porta mi ultrices elementum. 
                    Maecenas feugiat magna at tellus convallis congue. Aenean tincidunt rutrum varius. Aenean nec eros id odio dapibus faucibus. 
                    Pellentesque blandit gravida erat id sodales. Etiam nunc odio, pharetra nec aliquam a, gravida at metus. Nullam dapibus vulputate blandit. 
                    Cum sociis natoque penatibus et magnis dis parturient montes, nascetur ridiculus mus. Vestibulum ullamcorper lectus ut sapien scelerisque 
                    vitae ullamcorper mauris venenatis.
                </p>
                <p>
                    Lorem ipsum dotor sit amet, consectetur adipiscing elit. 
                    Ut viverra lectus vitae est ullamcorper a tempus est commodo. 
                    Phasellus et pulvinar risus. Cras quis aliquet odio. Ut condimentum porta mi ultrices elementum. 
                    Maecenas feugiat magna at tellus convallis congue. Aenean tincidunt rutrum varius. Aenean nec eros id odio dapibus faucibus. 
                    Pellentesque blandit gravida erat id sodales. Etiam nunc odio, pharetra nec aliquam a, gravida at metus. Nullam dapibus vulputate blandit. 
                    Cum sociis natoque penatibus et magnis dis parturient montes, nascetur ridiculus mus. Vestibulum ullamcorper lectus ut sapien scelerisque 
                    vitae ullamcorper mauris venenatis.
                </p>                    
            </div>

            <div class="footerMiddle">
            </div>
            <span class="bottom-left"></span>
            <span class="bottom-right"></span>      
        </div>  
    </div>
</body> 
```

```
body {
    background-color: #eeeee7;
    text-align:center;
}

.pageWrapper {
    margin: 0px auto;       /* centers the div horizontally */
    min-width: 900px;
    height: 768px;
    width: 80%;
}

.contentWrapper {
    position: relative;        /* makes our corners absolute relative to our container not our browser window    */
    background-color: white;
    height: 100%;
    width: 100%;
    padding-top: 155px;
    text-align: left;
}

.content {
    padding: 75px;
}

.headerMiddle {
    position: absolute;
    top: 0;
    left: 0;
    height: 155px;
    width: 100%;
    background-image:url('images/headerMiddle.jpg');
}

.footerMiddle {
    position: absolute;
    bottom: 0;
    right: 0;
    height: 29px;
    width: 100%;
    background-image:url('images/footerMiddle.jpg');    
}

.contentLeft {
    float: left;
    height: 100%;
    width: 34px;
    background-image:url('images/contentLeft.jpg');
}

.contentRight {
    float: right;
    height: 100%;
    width: 34px;
    background-image:url('images/contentRight.jpg');
}

.top-left,
.top-right {
    position: absolute;
    height: 155px;
    width: 34px;
    background-color: blue;
}

.top-left {
    top: 0;
    left: 0;
    background-image:url('images/cornerLeftTop.jpg');
}

.top-right {
    top: 0;
    right: 0;
    background-image:url('images/cornerRightTop.jpg');
}

.bottom-left,
.bottom-right {
    position: absolute;
    height: 29px;
    width: 34px;
}

.bottom-left {
    bottom: 0; 
    left: 0;
    background-image:url('images/cornerBottomLeft.jpg');
}
.bottom-right {
    bottom: 0;
    right: 0;
    background-image:url('images/cornerBottomRight.jpg');
}

.minWidth {
    width: 600px;
    height:1px;
} 
```

# c# - LINQ 和 Array.Copy

> ID：13278194
> 
> 赞同：1
> 
> 时间：2012-11-07T21:04:04.967
> 
> 标签：c#, arrays, linq, multidimensional-array

我有以下内容：

```
var list = new List<double[]>();
list.Add(new double[] { 300, 12, 22 });
list.Add(new double[] { 310, 13, 23 });
list.Add(new double[] { 320, 14, 24 });
list.Add(new double[] { 330, 15, 25 }); 
```

我想从中得到一个包含前 2 列的多维数组：

```
double[,] a = { {300,12}, {310,13}, {320,14}, {330,15}} 
```

我可以使用 linq 做到这一点吗？如何？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-07T21:05:07.127

尝试以下

```
var a = list.Select(x => new [] { x[0], x[1] }).ToArray(); 
```

**编辑**

起初并没有意识到其意图是从源中获取非锯齿状的二维数组。不幸的是，使用标准 LINQ 方法并没有真正的方法来做到这一点。他们主要处理`IEnumerable<T>`和`T[]`。然而，没有什么能阻止你创建一个新的方法来做到这一点

```
 public static T[,] ToMultidimensionArray<T>(this List<T[]> list, int columns)
    {
        var array = new T[list.Count, columns];
        for (int i = 0; i < list.Count; i++)
        {
            var source = list[i];
            for (int j = 0; j < columns; j++)
            {
                array[i, j] = source[j];
            }
        }

        return array;
    } 
```

现在您可以通过简单的查询来转换原始列表

```
var a = list.ToMultidimensionArray(2); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-07T21:14:30.167

LINQ 和多维数组不能很好地混合。Array.Copy 在这里也不适用。

使用传统`for`循环：

```
double[,] result = new double[list.Count, 2];

for (int i = 0; i < list.Count; i++)
{
    result[i, 0] = list[i][0];
    result[i, 1] = list[i][1];
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-07T21:16:09.993

```
public static T[,] GetColumns<T>(IList<IEnumerable<T>> source, int numColumns)
{
    T[,] output = new T[source.Count, numColumns];

    for (int i = 0; i < source.Count; i++)
    {
        int j = 0;
        foreach (T item in source[j].Take(numColumns))
        {
            output[i, j] = item;
            j++;
        }
    }

    return output;
} 
```

请注意，在这种情况下，如果任何列表包含的数组没有足够的值来填充您想要的所有列，那么它们将保留默认值，它不会引发异常。如果您希望发生这种情况，您需要检查并自己扔一个。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-07T21:09:17.830

```
var array = list.Select(item => item.Take(2).ToArray()).ToArray();
foreach (var item in array)
{
    Console.WriteLine("{0}, {1}", item[0], item[1]);
} 
```

# .net - 阻止审阅功能区中的 Office“添加评论”按钮

> ID：13278195
> 
> 赞同：1
> 
> 时间：2012-11-07T21:04:04.890
> 
> 标签：.net, vsto, ms-office, add-in, office-interop

我们有一个我维护的自定义加载项功能区（不是 COM 共享的“可扩展性”加载项），它使用评论和跟踪更改功能（例如，有几个与插入、查找、编辑和删除相关的按钮），但是我们最近有一些用户错误地使用了“评论”功能区的评论按钮。

因此，当用户通过加载项加载文档时，我被要求阻止此操作。目前，我只是想弄清楚如何：

a) 将 Review 功能区的添加评论按钮单击事件处理到我现有的事件处理程序，或者

b) 禁用 Review 功能区的添加评论按钮

我似乎无法发现其中任何一个都是可能的，*除非*我可以[“重新利用 Office fluent 按钮上的命令”](http://msdn.microsoft.com/en-us/library/bb462633.aspx)，但所描述的方法涉及创建一个新的基于 COM 加载项的“可扩展性”项目；我已经部署了一个，不想仅仅为了这个小需求而创建第二个。有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-12T16:32:43.283

我想通了...我只需要花更多时间使用 Watches 窗格。app.CommandBars("Reviewing") 返回正确的命令栏，我只是为每个循环通过其控件获取“插入评论”控件，然后设置 .Enabled = False

# c# - Linq Query 对 Parent 和相应的子项进行分组

> ID：13278201
> 
> 赞同：0
> 
> 时间：2012-11-07T21:04:32.990
> 
> 标签：c#, linq, entity-framework

这是我的课程：

```
class Country
{
    public Country()
    {
        States = new List<State>();
    }

    public int Id { get; set; }
    public int Name { get; set; }

    public virtual ICollection<State> States  { get; set; }
}

class State
{
    public State()
    {
        Counties = new List<County>();
    }

    public int Id { get; set; }
    public int Name { get; set; }
    public int CountryID { get; set; }

    [ForeignKey("CountryID")]
    public virtual Country Country { get; set; }

    public virtual ICollection<County> Counties { get; set; }
}

class County
{
    public County()
    {
        Cities = new List<City>();
    }

    public int Id { get; set; }
    public int Name { get; set; }
    public int StateID { get; set; }

    [ForeignKey("StateID")]
    public virtual State State { get; set; }

    public virtual ICollection<City> Cities { get; set; }
}

class City
{
    public int Id { get; set; }
    public int Name { get; set; }
    public int CountyID { get; set; }

    [ForeignKey("CountyID")]
    public virtual County County { get; set; }
} 
```

我在创建查询时遇到困难，该查询将为我提供上述每个实体的所有记录，按国家、州、县、市

我最终试图把它放到一个backbone.js 树视图中。

**什么是正确的 Linq 查询来收集各自组中的记录**

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-09T11:54:22.860

```
 public List<Country> GetCountryHeiracrchy()
    {
        var countries = DbContext.GetAll();
        var lstCountries = new List<Country>();

        foreach (var _country in countries)
        {
            var country = new Country { Name = _country.Name };

            foreach (var _state in _country.States)
            {
                var state = new State() {Name = _state.Name};

                foreach(var _county in _state.Counties)
                {
                    var county = new County {Name = _county.Name};
                    foreach(var _city in _county.Cities)
                    {
                        var city = new City {Name = _city.Name};
                        county.Cities.Add(city);
                    }
                    state.Counties.Add(county);
                }
                country.States.Add(state);
            }
            lstCountries.Add(country);
        }
        return lstCountries;
    } 
```

# asp.net - 如何找到我们的 ThreadPool 工作线程在做什么？

> ID：13278210
> 
> 赞同：4
> 
> 时间：2012-11-07T21:05:07.643
> 
> 标签：asp.net, cpu, windbg

我在 w3wp.exe 中的 CPU 利用率为 100%，CPU 的前 3 个线程如下所示

当我切换到有问题的线程之一（例如 18）时，我在尝试遍历调用堆栈时收到下面的错误，所以我认为它只是非托管代码，“k”和“dumpstack”也在下面

所以我的问题是我如何找出在那些 Theadpool 工作线程上消耗所有 CPU 的原因？

```
 0:018> !runaway
     User Mode Time
      Thread       Time
      15:12a4      0 days 0:13:15.359
      18:830       0 days 0:10:49.046
      17:1084      0 days 0:10:47.343
      12:fc        0 days 0:00:36.828
    ...

    0:018> !threadpool
    CPU utilization 100%
    Worker Thread: Total: 3 Running: 0 Idle: 3 MaxLimit: 100 MinLimit: 1
    Work Request in Queue: 6
    --------------------------------------
    Number of Timers: 8
    --------------------------------------
    Completion Port Thread:Total: 1 Free: 1 MaxFree: 2 CurrentLimit: 0 MaxLimit: 100 MinLimit: 1

    0:018> !threads 
    ThreadCount: 10
    UnstartedThread: 0
    BackgroundThread: 10
    PendingThread: 0
    DeadThread: 0
    Hosted Runtime: no
                                          PreEmptive   GC Alloc           Lock
           ID OSID ThreadOBJ    State     GC       Context       Domain   Count APT Exception
       7    1 1078 016eced8      8220 Enabled  00000000:00000000 016e84d0     0 Ukn
      12    2   fc 016fb0c8      b220 Enabled  00000000:00000000 016e84d0     0 MTA (Finalizer)
      10    3 1148 01717b60   880a220 Enabled  00000000:00000000 016e84d0     0 MTA (Threadpool Completion Port)
      13    4  680 0171dad8    80a220 Enabled  00000000:00000000 016e84d0     0 MTA (Threadpool Completion Port)
      14    5  9b8 0171e470      1220 Enabled  00000000:00000000 016e84d0     0 Ukn
      15    6 12a4 017629f0   180b220 Enabled  00000000:00000000 016e84d0     0 MTA (Threadpool Worker)
       3    7 1188 016ef888       220 Enabled  00000000:00000000 016e84d0     0 Ukn
      17    8 1084 003085e8   180b220 Enabled  00000000:00000000 016e84d0     0 MTA (Threadpool Worker)
      18    9  830 03e433b8   180b220 Enabled  00000000:00000000 016e84d0     0 MTA (Threadpool Worker)
      19    a  f3c 03e79448       220 Enabled  00000000:00000000 016e84d0     0 Ukn

0:018> !clrstack
OS Thread Id: 0x830 (18)
Failed to start stack walk: 80004005

0:018> k
ChildEBP RetAddr  
077ef7a4 76630a91 ntdll!ZwWaitForSingleObject+0x15
077ef810 75711194 KERNELBASE!WaitForSingleObjectEx+0x98
077ef828 6ec25497 kernel32!WaitForSingleObjectExImplementation+0x75
077ef86c 6ec253e3 mscorwks!PEImage::LoadImage+0x1af
077ef8bc 6ec25402 mscorwks!CLREvent::WaitEx+0x117
077ef8d0 6ec8b75f mscorwks!CLREvent::Wait+0x17
077ef950 6ec8bbed mscorwks!ThreadpoolMgr::SafeWait+0x73
077ef9b4 6ed8305a mscorwks!ThreadpoolMgr::WorkerThreadStart+0x11c
077efc58 7571339a mscorwks!Thread::intermediateThreadProc+0x49
077efc64 77559ef2 kernel32!BaseThreadInitThunk+0xe
077efca4 77559ec5 ntdll!__RtlUserThreadStart+0x70
077efcbc 00000000 ntdll!_RtlUserThreadStart+0x1b

0:018> !dumpstack
OS Thread Id: 0x830 (18)
Current frame: ntdll!ZwWaitForSingleObject+0x15
ChildEBP RetAddr  Caller,Callee
077ef7a4 76630a91 KERNELBASE!WaitForSingleObjectEx+0x98, calling ntdll!ZwWaitForSingleObject
077ef810 75711194 kernel32!WaitForSingleObjectExImplementation+0x75, calling KERNELBASE!WaitForSingleObjectEx
077ef828 6ec25497 mscorwks!PEImage::LoadImage+0x1af
077ef854 6eea07a9 mscorwks!UM2MDoADCallBack+0x98, calling mscorwks!_EH_epilog3
077ef86c 6ec253e3 mscorwks!CLREvent::WaitEx+0x117, calling mscorwks!PEImage::LoadImage+0x180
077ef89c 6ec243ea mscorwks!UnsafeEELeaveCriticalSection+0x25, calling mscorwks!DECTHREADNONHOSTLOCKCOUNT
077ef8a8 6ec243ab mscorwks!CrstBase::Leave+0x8c, calling mscorwks!UnsafeEELeaveCriticalSection
077ef8bc 6ec25402 mscorwks!CLREvent::Wait+0x17, calling mscorwks!CLREvent::WaitEx
077ef8d0 6ec8b75f mscorwks!ThreadpoolMgr::SafeWait+0x73, calling mscorwks!CLREvent::Wait
077ef8f8 6ec2d529 mscorwks!GCHolder<1,0,1>::GCHolder<1,0,1>+0x29, calling mscorwks!Thread::DisablePreemptiveGC
077ef900 6ec299cc mscorwks!Thread::EnablePreemptiveGC+0xf, calling mscorwks!Thread::CatchAtSafePoint
077ef950 6ec8bbed mscorwks!ThreadpoolMgr::WorkerThreadStart+0x11c, calling mscorwks!ThreadpoolMgr::SafeWait
077ef9b4 6ed8305a mscorwks!Thread::intermediateThreadProc+0x49
077ef9d0 77559e83 ntdll!LdrInitializeThunk+0x1a, calling ntdll!NtContinue
077efc44 6ed83048 mscorwks!Thread::intermediateThreadProc+0x37, calling mscorwks!_alloca_probe_16
077efc58 7571339a kernel32!BaseThreadInitThunk+0xe
077efc64 77559ef2 ntdll!__RtlUserThreadStart+0x70
077efca4 77559ec5 ntdll!_RtlUserThreadStart+0x1b, calling ntdll!__RtlUserThreadStart 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-13T14:09:57.580

是的，那是非托管代码。

尝试分析您的代码，以确定您的代码的哪一部分正在占用 CPU。有一些免费的代码分析器，看看这个线程： [https ://stackoverflow.com/questions/308816/any-good-free-net-profiler](https://stackoverflow.com/questions/308816/any-good-free-net-profiler)

# ios - iOS：Scrollview 的 SetContentOffset 不起作用

> ID：13278212
> 
> 赞同：0
> 
> 时间：2012-11-07T21:05:15.520
> 
> 标签：ios, uiscrollview, contentoffset

我有 3 个滚动视图，它们应该与另一个滚动同步...

但是这段代码不起作用：

```
- (void)scrollViewDidScroll:(UIScrollView *)scrollView {
[rowIdCellScrollView setContentOffset:CGPointMake(0, contentScrollView.contentOffset.y)];
[headerScrollView setContentOffset:CGPointMake(contentScrollView.contentOffset.x, 0)];
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-07T21:10:48.320

你有 UIScrollViewDelegate 吗？并设置 delagate：

```
rowIdCellScrollView.delegate = self; 
```

这个 scrollViewDidScroll 甚至会调用吗？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-10T15:58:40.103

我找到了解决方案，问题是，我在 layoutsubviews 中初始化了组件......

# vb.net - 在VB中合并两个数据表（相同的模式）并且只得到不匹配的行

> ID：13278218
> 
> 赞同：1
> 
> 时间：2012-11-07T21:05:27.793
> 
> 标签：vb.net

我有两个数据表。我想合并它们，并且只想从两个数据表中获取不匹配的行。有人可以帮忙吗？

目前我正在使用以下代码，但它没有返回任何内容：

```
Actual_Table = myDataSet_Actual.Tables("Actuals")
Planned_Table = myDataset_Planned.Tables("Planned")

Planned_Table.AcceptChanges()
Planned_Table.Merge(Actual_Table, False)

change = Planned_Table.GetChanges(DataRowState.Added)
DGV1.DataSource = change ' DGV1= Data grid view 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-05-24T17:11:00.397

## TL;博士

您可以使用以下代码执行此操作，但请继续阅读以了解更多详细信息：

```
change = Planned_Table.AsEnumerable _
                      .Except(Actual_Table.AsEnumerable, DataRowComparer.Default) _ 
                      .CopyToDataTable 
```

## 这里有几点需要注意：

[正如在这个 SO question](https://stackoverflow.com/questions/1460953/datatable-merge-and-datatable-importrow-does-not-change-rowstate)中指出的那样，`DataTable.Merge`不会改变行状态，所以寻找行`DataRowState.Added`总是空的。

此外，`Merge`将第二个表中的每一行添加到第一个表中，因此即使 RowState*已*更改，第二个表中的*所有内容也会出现。*

 *最后，假设我们只将第二个数据表中的唯一值添加到第一个数据表中，我们只会取回第二组中的元素，而不是第一组中的元素。也许这就是你想要的，但如果你真的想要其中一个，我会描述这两个选项。

## 我们需要的工具

正如在[此处](https://stackoverflow.com/questions/9840539/how-do-i-get-the-difference-in-two-lists-in-c)和[此处](https://stackoverflow.com/questions/10815387/compare-two-lists-c-sharp-linq?rq=1)的其他 SO 问题中发现的那样，我们可以使用以下任何一种找到正确的条目集[`LINQ Set Operations`](http://msdn.microsoft.com/en-us/library/bb386998.aspx)：

*   [`Distinct`](http://msdn.microsoft.com/en-us/library/system.linq.enumerable.distinct.aspx)
*   [`Union`](http://msdn.microsoft.com/en-us/library/system.linq.enumerable.union.aspx)
*   [`Intersect`](http://msdn.microsoft.com/en-us/library/system.linq.enumerable.intersect.aspx)
*   [`Except`](http://msdn.microsoft.com/en-us/library/system.linq.enumerable.except.aspx)

您可以在 MSDN 中进一步探索这些中的每一个，但正[如此](https://stackoverflow.com/questions/4961910/joining-or-appending-two-ienumerable-sequences/4961949#4961949)SO Question中提到的，仅供参考，`Union`并且`Concat`都会将一个可枚举附加到另一个上，但 Union 将删除重复项（在检查`DataRow`s 的相等性时，您必须传入重载`IEqualityComparer`= `DataRowComparer.Default`)

此外，我们还想枚举一个 DataTable，所以要做到这一点，我们需要[`AsEnumerable`](http://msdn.microsoft.com/en-us/library/system.data.datatableextensions.asenumerable.aspx)从命名空间调用该方法`DataTableExtensions`。

## 解决方案设置

就像我们正在查看相同的代码一样，这里有一些基本的数据表，我们可以在这些数据表上执行集合操作

```
Dim dt, dataTable1, dataTable2 As New DataTable

With dt.Columns
    .Add("ID", GetType(Integer))
    .Add("Name", GetType(String))
End With

dataTable1 = dt.Clone
dataTable2 = dt.Clone

With dataTable1.Rows
    .Add(1, "Tod")
    .Add(2, "Jim")
End With

With dataTable2.Rows
    .Add(2, "Jim")
    .Add(3, "Han")
End With 
```

## 解决方案集

因此，如果您只想要第二个表中未出现在第一个表中的新项目，那么您需要`Right Outer Join`：

![右外连接](../Images/9fcd466014707ea5a532ffc95c54cee8.png)

如果您想要两组之间不同的所有数据，您需要`Full Outer Join`排除`Inner Join`

![右外连接](../Images/4a5ad56c09ee9ea808256ca8188bfc54.png)

[您可以在这篇 Jeff Atwood帖子](http://www.codinghorror.com/blog/2007/10/a-visual-explanation-of-sql-joins.html)中阅读有关不同集合和创建它们的连接的更多信息。

## 代码

如果你想要第一个选项，你可以通过调用`Except`第二个`Datatable`并传入第一个来获取第二个集合中的元素

```
Dim just2 As DataTable
just2 = dataTable2.AsEnumerable _
                  .Except(dataTable1.AsEnumerable, DataRowComparer.Default) _
                  .CopyToDataTable() 
```

输出将是：

```
| ID | Name |
| 3  | Han  | 
```

如果您想要每组中的唯一值，则必须调用 distinct 两次，然后加入这两个值。我们不需要将 传递`DataRowComparer`给该`Union`方法，因为我们已经保证两个表中没有重复项

```
Dim just1 As IEnumerable(Of DataRow)
Dim just2 As IEnumerable(Of DataRow)
Dim union As DataTable

'get rows that are only in table1
just1 = dataTable1.AsEnumerable.Except(dataTable2.AsEnumerable, DataRowComparer.Default)

'get rows that are only in table2
just2 = dataTable2.AsEnumerable.Except(dataTable1.AsEnumerable, DataRowComparer.Default)

'get all unique rows
union = just1.Union(just2).CopyToDataTable 
```

由于我们不需要单独的唯一元素集，因此无需调用`CopyToDataTable`just 以便我们可以重新转换为`IEnumerable(Of DataRow)`with`AsEnumerable`

联合的输出将是：

```
| ID | Name |
| 1  | Tod  |
| 3  | Han  | 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-07T21:42:26.743

我希望这对你有帮助：http: [//www.dotnetperls.com/datatable-compare-rows](http://www.dotnetperls.com/datatable-compare-rows)

在示例中，它在控制台中写入比较结果，但我想你可以做到这一点；）

祝你好运！

**编辑：**实际上，如果您`DataTable`的 s 具有相同的行数并且您正在一对一地比较行，您应该更改`For Each`一个语句的`For`语句。就像是：

```
For i As Integer = 0 To RowNo - 1
    'compare datatable1_row(i) with datatable2_row(i) and do the magic
Next 
```*

# php - 根据另一个数组对数组进行排序和比较？

> ID：13278220
> 
> 赞同：0
> 
> 时间：2012-11-07T21:05:34.883
> 
> 标签：php

我有一个看起来很简单的问题，但是很难以优雅的方式找到解决方案。

我有一个简单的客户管理系统，他们可以在他们的网站上登录以订购他们的视频。它使用 jQuery UI 的可拖动组件，然后将结果保存为 JSON 文件并由前端解析。我现在的问题是，如果客户将任何视频上传到他们的 Vimeo 帐户，JSON 文件可能会过期

所以现在我从他们的 Vimeo 帐户中获取视频，但留下了一个问题，我如何根据之前保存的订单订购视频，但将任何新上传的视频附加到列表的末尾以便客户能够订购？

请用PHP回答！

# javascript - JSF 使用 Javascript 设置 CSS 样式？

> ID：13278223
> 
> 赞同：0
> 
> 时间：2012-11-07T21:05:47.780
> 
> 标签：javascript, css, jsf

我一直在寻找是否可以使用javascript动态地将css样式应用于JSF组件或div，但没有成功。这可能吗。

这是伪代码

```
<div style="myJSStyleFunction("#{myBean.value}")"> stuff </div> 
```

并且该函数将返回类似“位置：相对；左：25px；”的内容

我没有运气，也许无法完成，但想要第二个意见。

编辑：

* * *

我正在尝试查看是否可以保持分离/减少演示/视图与模型/控制器之间的耦合。这是为了缩进评论或产品评论（嵌套回复评论或评论）。我最想跟踪的是一个关于回复深度的整数。第一级 = 0 第二级 = 1，以此类推。因此，评论或产品评论的深度为 0，对评论或评论的回复为 1，依此类推。

然后在 EL 中我想调用一个 javascript 函数并执行类似的操作

```
<script>
    myJSStyleFunction(depth){
        if(depth<=5){
            var nest=20*depth;
            var style="position:relative;left:" + nest + "px;";
            return style;
        }
    }
</script> 
```

然后说对于第三级评论（对回复的回复），它看起来像这样：

```
<div style="position:relative;left:40px;"> stuff </div> 
```

在哪里

```
#{myBean.value} 
```

评估为 2

我怀疑就像丹尼尔说的那样，我必须紧密结合视图，但我宁愿不必这样做。我想一定有办法。但也许不是。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-08T05:45:46.887

我不知道哪里有更清洁的解决方案。然而，这是一个建议。
假设您的页面如下所示，并且`myBean.getValue()`方法返回一个`integer`.

> `<h:form id="frm">`
>    `<div style="#{myBean.value}"> div1 </div>`
>    `<div style="#{myBean.value}"> div2 </div>`
> `</h:form>`

所以你可以在“window.onload”做这样的事情。

> `<head>`
> `<script>`
> `window.onload = function() {`
>    `var childList = document.forms['frm'].childNodes;`
>    `for(var i = 0; i &lt; childList.length; i++) {`
>       `if(childList[i].nodeName == 'DIV') {`
>          `var _div = childList[i];`
>          `var depth = _div.getAttribute('style');`
>          `_div.setAttribute('style', 'position:relative;left:' +(depth *20)+ 'px;');`
>       `}`
>    `}`
> `}`
> `</script>`
> `</head>`

注意：
1\. 在上面的示例代码中，我假设`DIV`表单内的所有 s 都应该缩进。
2\. 对于 IE，您可能需要使用`_div.style.setAttribute('cssText','position:relative;left:' +(depth *20)+ 'px;')`
3\. 您的问题的另一个解决方案是`<script>`在 div 之后立即使用标签并将 js 部分放入其中。通过这种方式，您不必使用虚假样式`style="#{myBean.value}"`或`window.onload`事件，因为您可以直接`#{myBean.value}`在脚本中调用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-12T04:35:06.567

我决定跳过 javascript 方法并选择一种更简单且我认为更简洁的方法来为我的情况创建动态 css 类。我已经在输入每个评论时捕获/计算了它的深度值。所以我只是在 EL 中返回该值并将其连接到 css 类的“基本名称”，如下所示：

```
<div class="indent_#{(comment.commentDepth le 5) ? comment.commentDepth : 5}" >
    comment comment blah blah blah
</div> 
```

“indent_”是 css 类的基本名称。因此，对于 0 级评论，它将有一个`class="indent_0"`. 对该评论的回复将有`class="indent_1"`。

我使用三元组，这样如果给定评论下有很多回复，它就不会从页面右侧缩进。即使您可以继续深入，它也最多只能缩进 5 级。

对于我目前的情况，这是一种添加一些动态生成的 css 类名的更简单、更简洁的方法。现在我必须在 css 文件中为此定义 6 个类，但也许我会弄清楚如何嵌套这些框，但这不是优先级，这对我来说现在很好。

# gnuplot - 如何将这些数据绘制到 GNUplot 中

> ID：13278225
> 
> 赞同：1
> 
> 时间：2012-11-07T21:05:48.870
> 
> 标签：gnuplot, p2p, topology

我有一个程序产生这样的数据：

```
0.5 0.5
0.49597550441921423 0.7868142593062702

0.5 0.5
0.6538646510750382 0.5364703734652149 
```

以此类推。。

这是网络拓扑数据。有人告诉我这是对 gnuplot 友好的数据，但是我询问如何将这些数据绘制到 gnuplot，因为它不是我熟悉的程序。理想情况下，数据应形成星形集群。还应该将此数据添加到 .dat 文件中，但是为了便于阅读，我将其添加到 .txt 文件中。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-07T21:34:31.003

一个简单的：

```
plot 'yourdatafile' using 1:2 
```

应该策划*一些事情*。然而，真正定制情节以使其看起来完全符合您的要求是棘手的部分。

# play2-mini - 如何在开发模式下运行 play2-mini

> ID：13278226
> 
> 赞同：2
> 
> 时间：2012-11-07T21:05:54.917
> 
> 标签：play2-mini

据我所知，它应该默认执行此操作，但每当我启动 play2-mini 应用程序时，它都会在 Prod 模式下运行（因此我不会重新加载代码等）。

如何指定我希望它在开发模式下运行？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-02-07T08:33:53.483

'play run' 是在开发模式下运行 play 应用程序的命令。虽然这个问题太老了，但我正在重播以供其他人参考。

# database-design - 你怎么知道在 crud 矩阵的顶部或侧面有什么？

> ID：13278233
> 
> 赞同：1
> 
> 时间：2012-11-07T21:07:02.123
> 
> 标签：database-design, crud, diagram, use-case

没有我红色的地方实际上解释了顶部和侧面的crud矩阵是什么？例如[这里](http://blog.aplikacja.info/2011/12/crud-matrix-as-a-software-design-and-estimation-tool/)，为什么“Product”、“Order”、“Item”、“Payment”和“ERP Order”在顶部？为什么“添加产品”在旁边？使用的规则是什么？是不是您计划实现的功能在旁边，而您从中获取的数据存储在顶部？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-19T13:38:25.683

这并不重要，也没有单一的标准方法可以做到这一点。这取决于上下文，我个人通常将（创建、读取、更新、删除）活动放在顶部，将域对象（或表）放在旁边。然而，另一种常见的格式是将场景/用例放在一边，将域对象放在顶部，将 crud 活动放在框中。关键是问自己为什么要使用 CRUD 矩阵。分析问题，澄清你的理解，记录进度，展示测试覆盖率，向第三方传达信息。然后决定哪种格式最适合该目标。不要沉迷于形式，沉迷于目标。

# .net - 如何在一列上使用 IF 条件执行 SQL

> ID：13278234
> 
> 赞同：0
> 
> 时间：2012-11-07T21:07:06.843
> 
> 标签：.net, sql

我有一个简短的问题，关于这是否可以在 ASPX 页面的 SQL 语句中实现。

假设有三列，`USER`，`Password`和`permission`。

如果在我的`SELECT`陈述中我只想选择`USER`并且`PASSWORD`只有当`Permission`是`> 2`，如果它小于 2 我只想显示`USER`。

这可能吗？或者我必须在我的表示层中这样做吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-07T21:09:09.440

基本的 SQL..

```
select USER, CASE WHEN (Permission > 2) THEN PASSWORD ELSE null END
from YOURTABLE 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-07T21:10:13.857

您可以通过在 (T-)SQL 查询中使用[CASE](http://msdn.microsoft.com/en-us/library/ms181765.aspx?ppud=4)语句来实现此目的

```
SELECT [user], CASE 
                 WHEN Permission > 2 THEN [password] 
                 ELSE '' 
               END 
FROM [table] 
```

# php - 数据库和用户照片管理

> ID：13278239
> 
> 赞同：1
> 
> 时间：2012-11-07T21:07:25.463
> 
> 标签：php, mysql, database, content-management-system, photo

我想知道建立一个网站的最佳选择，该网站允许用户发送照片以显示在网站的开放部分，我不知道我是否应该在 mysql 中建立一个数据库来接收这些照片，然后到这个表被推到屏幕上，它会增长。还有其他选择吗？就像将这些照片放在一个文件夹中，然后像编写普通的 html 和 css 一样制作一个系统来获取它们。将这些照片作为一个 blob 在表格中获取可能是一种意见，但可能还有其他一些有趣的方式。多谢你们！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-07T21:15:18.630

上传照片时管理用户照片的最佳方法是合并您已经提到的两种方式，如下所示：您在项目的根文件夹中创建一个文件夹，上传照片将位于该文件夹中，您还必须考虑重命名用户照片这样，如果两个不同的用户上传具有相同名称的照片，您就不会发生冲突。其次必须在用户表中添加一个字段，该字段将保存他的照片名称。谢谢。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-07T21:18:40.147

首先，您永远不应该将照片保存到您的数据库中。数据库应该只保存有关图像的信息，它们存储在哪里，它们的大小等......

**第一个解决方案：**

您可以将上传的照片保存在服务器上的某个文件夹中，然后当您想要显示这些照片时，只需阅读该文件夹的内容即可获取有关上传照片的信息并在您的网络上显示它们。您可以使用 PHP 轻松列出文件夹的内容。通过这种方式，您可以获得图像位置信息，并且可以轻松地将它们添加到您的 HTML 中。如果您愿意，您可以为每个用户创建一个文件夹。然后您可以从会话中获取用户，并且您知道他的图像已保存到 /uploads/images/{user}/

**第二种解决方案：**

更好的方法是将照片上传到您的服务器文件夹，但是在上传照片时，您可以将有关照片的信息保存到数据库中。因此，当您要显示照片时，只需通过数据库表即可获得有关上传照片的信息。您将在该表中保存有关照片所需的所有内容，例如 photo_path、photo_size、photo_dimensions、photo_uploader、photo_category 等...

通过这种方式，您可以轻松缓存这些信息并在需要时加快您的网站速度。

第一个解决方案不适用于高流量站点，因为您必须在每个页面请求上列出所有文件夹/图像，这可能会很慢。

无论如何，图像应该进入您的服务器文件夹，并且您可以使用 PHP 函数来读取该文件夹以获取诸如文件夹中有多少图像、它们的大小等信息......您可以使用 PHP 完成所有这些操作。或者更好的是，在将图像上传到文件夹之前，检查每张图像并将该信息保存到数据库中。如果您使用第一个解决方案，您甚至不需要使用数据库，但如果您的网站增长并且您想要提高性能，这可能会咬到您。

# javascript - 需要 js 示例中的 RegExp

> ID：13278242
> 
> 赞同：0
> 
> 时间：2012-11-07T21:07:39.897
> 
> 标签：javascript, regex

我想从 Javascript 中的文本“SouthDacota (SD)”中提取这个“SD”。我是 js 中正则表达式的新手，想知道是否有人有任何想法。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-07T21:13:41.687

最简单的正则表达式将匹配括号，并在两个大写字母之间。此外，您可以“捕获”这两个字母（带有未转义的括号），因此您可以在没有括号的情况下检索它们：

```
var regex = /\(([A-Z]{2})\)/;
var matches = inputString.match(regex);
var stateCode = matches[1]; 
```

但是你真的应该阅读[一些基础知识](http://www.regular-expressions.info/tutorial.html)。

# makefile - 仅链接一次到库

> ID：13278243
> 
> 赞同：0
> 
> 时间：2012-11-07T21:07:44.793
> 
> 标签：makefile, autotools, automake

我有我的主应用程序和两个库：foo 和 bar。foo 在某些方法中使用 bar，它在 LDADD 中指定。我的主应用程序使用 foo，并间接使用 bar，所以它在 Makefile 中有 LDADD = foo。

在这种情况下，如果我没有将 bar 库添加到我的主应用程序的 LDADD，我会得到一个编译错误。

未定义参考; 它说来自 foo 的 .so 文件需要来自 bar 的 .so 文件。

我不明白这一点。一旦我用 LDADD = bar 编译（非静态） foo ，为什么我在编译使用 foo 的应用程序时再次需要它？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-09T13:10:28.957

您没有指定是否`foo`和/或`bar`libtool 库是作为源代码树的一部分构建的。如果是，libtool 应该接受链接。即，因为`foo`需要`bar`作为库的一部分：

```
libfoo_la_LIBADD = ../bar/libbar.la # in: foo/Makefile.am 
```

和，

```
prog_LDADD = ../foo/libfoo.la # in: app/Makefile.am 
```

# asp.net - Gridview BoundField 在编辑/更新模式下从 DateTime 中删除时间

> ID：13278246
> 
> 赞同：3
> 
> 时间：2012-11-07T21:07:55.463
> 
> 标签：asp.net, datetime, gridview, edit, boundfield

我有以下 GridView：

```
<asp:GridView ID="GridView1" runat="server" AutoGenerateColumns="False" CellPadding="4"
    DataKeyNames="EVENT,TERM_CODE" DataSourceID="OracleDataSource" ShowHeaderWhenEmpty="True"
    EnableViewState="False">
    <Columns>
        <asp:CommandField ShowEditButton="True" />
        <asp:BoundField DataField="EVENT" HeaderText="Event" ReadOnly="True" 
            SortExpression="EVENT" />
        <asp:BoundField DataField="TERM_CODE" HeaderText="Term Code" ReadOnly="True" 
            SortExpression="TERM_CODE" />
        <asp:BoundField DataField="SNAPSHOT_DATA_DATE" HeaderText="Snapshot Date" 
            SortExpression="SNAPSHOT_DATA_DATE" DataFormatString="{0:d}"  />
    </Columns>
</asp:GridView> 
```

SNAPSHOT_DATA_DATE 列是数据库中的 DateTime 字段。
我只想显示日期而不是日期和时间。2012 年 7 月 25 日
所以我添加`DateFormatString="{0:d}"`到 BoundField，这在查看 Gridview 时效果很好。但是，如果我单击编辑链接以更新显示为的日期：7/25/2012 12:00:00 AM DateFormatString 在编辑模式下被忽略。有人可以告诉我如何删除处于编辑/更新模式的时间吗？我不希望用户只处理日期时间。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-11-07T21:24:53.790

确保您已设置以下格式属性，以便在“绑定”字段中的编辑模式下工作。

```
DataFormatString = ({0:d})
ApplyFormatInEditMode = True 
```

在您的代码中，如果您像下面这样修改，它应该可以正常工作

```
<asp:BoundField DataField="SNAPSHOT_DATA_DATE" HeaderText="Snapshot Date" ApplyFormatInEditMode="true" SortExpression="SNAPSHOT_DATA_DATE" DataFormatString="{0:d}"  /> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2017-06-26T11:53:00.737

我特别想将我的日期格式化为`yyyy/MM/dd`没有相当于以下内容的时间：

```
string dateString = DateTime.Now.ToString("yyyy/MM/dd"); 
```

为此，我只是`DataFormatString`在 BoundField 的属性上添加了格式：

```
<asp:BoundField DataField="DatePosted" HeaderText="Date" DataFormatString="{0:yyyy/MM/dd}" /> 
```

# django - 避免使用 django-mediagenerator 为单个文件创建媒体包

> ID：13278252
> 
> 赞同：0
> 
> 时间：2012-11-07T21:08:19.097
> 
> 标签：django, django-mediagenerator

我在使用[Django-Mediagenerator](https://django-mediagenerator.readthedocs.org/en/latest/)时遇到的一个小问题是，在使用`include_media`标签时......

```
{% load media %}
{% include_media 'my_style.css' %} 
```

`my_style.css`...除非媒体包存在，否则将引发错误。但是，在某些情况下，这意味着我的媒体包仅包含一个文件。

有没有办法避免为单个文件创建媒体包？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-19T15:10:35.220

似乎没有办法使用 Django-mediagenerator 来做到这一点。这样做的唯一方法是对某些部分使用静态文件，对其他部分使用媒体包（违背了使用 Django-mediagenerator 的目的）。

# bash - 正确使用引号

> ID：13278255
> 
> 赞同：0
> 
> 时间：2012-11-07T21:08:33.360
> 
> 标签：bash

我想用 bash 来实现这一点：

```
for i in {1..2}
do
for j in {1..2}
do
echo $i $j >> tmp.txt
done
done

cat tmp.txt
1 1
1 2
2 1
2 2 
```

但是我想用引号内的 echo 变量来做这样的事情：

```
cmd="
for i in {1..2};
do for j in {1..2};
do echo \$i "\$j" '\$i' "'\$j'" \$i "'$j'" \'$i\' \"$j\" >> tmp.txt;
done;
done
"
eval $cmd 
```

我似乎无法正确引用引号。有没有可能实现我想要的？

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-07T21:16:11.227

只需使用单引号并确保在每个`done`.

```
cmd='for i in {1..2}; do
for j in {1..2}; do
echo $i $j >> tmp.txt;
done;
done'
eval $cmd 
```

# video - 使用 YouTube Player IFrame API 时如何获取视频标题？

> ID：13278257
> 
> 赞同：1
> 
> 时间：2012-11-07T21:08:44.917
> 
> 标签：video, youtube, youtube-api, gdata, gdata-api

我有一个视频ID。然后我通过 YouTube Player API 的 IFrame API 显示一个视频。视频已显示，现在我需要**立即**获取此视频的标题。

请注意，当我通过 YouTube Player IFrame API 显示 YouTube 视频时，我需要**立即获取视频的标题。**

获得视频标题的**最快方法是什么？**我需要解决方案。

谢谢你。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2016-03-03T11:34:09.177

**确实可以得到Video Title**

调用“YouTube Player API 的 IFrame API”时，您可以访问“ **event.target.getVideoData().title** ”函数：

```
new YT.Player('player', {
height: '390',
width: '640',
videoId: 'D3pYbbA1kfk',
events: {
  'onReady': function onPlayerReady(event) {
    alert("The video title is: " +  event.target.getVideoData().title);
  }
}
}); 
```

完整的工作示例：[https ://codepen.io/anon/pen/vGOzqy?editors=0010](https://codepen.io/anon/pen/vGOzqy?editors=0010)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-08T02:47:22.487

从 Player IFrame API 看来这是不可能的：

[https://groups.google.com/forum/?fromgroups=#!topic/youtube-api-gdata/D0w8wA0UV7A](https://groups.google.com/forum/?fromgroups=#!topic/youtube-api-gdata/D0w8wA0UV7A)

“无法使用 Players API 获取该信息。您需要使用 Data API。”

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-04-17T16:59:28.250

在 onStateChange 事件中检查未启动和播放状态。我将此用作解决方案，也许不是最好的，但效果很好。

```
 var info = null;
    function onStateChange(e) 
    {
        switch(e.data) {
        case YT.PlayerState.UNSTARTED:
            info = null;
            break;
        case YT.PlayerState.PLAYING:
            if(info == null)
            {
                info = {title: player.getVideoData().title, duration: player.getDuration()};
                // use info here...
            }
            break;
        }
    } 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-03-22T19:03:22.083

**斯威夫特 3**

你可以使用 YTPlayerState+Extension.swift

```
extension YTPlayerView {
    var videoTitle: String {
        let callString = "player.getVideoData().title"
        return webView?.stringByEvaluatingJavaScript(from: callString) ?? "no title"
    }
} 
```

# android - onItemClick 显示详情页面

> ID：13278258
> 
> 赞同：0
> 
> 时间：2012-11-07T21:08:48.130
> 
> 标签：android, android-layout, android-intent, onclick

我正在使用自定义光标适配器从数据库读取到列表视图。列表视图显示了数据库中每个条目的一些详细信息。当我单击一个列表项时，我想打开一个详细信息页面，该页面显示该记录的其他详细信息，这些详细信息未显示在列表视图中。我想不通。

我附上了 MainActivity 中的光标创建和适配器创建的代码片段。我还有一个单独的 customAdapter 类和一个用于详细信息页面的类。

**主要活动：**

```
public class MainActivity extends ListActivity {
    ....
    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_main);

        ...
        ...  
    }

    private void fillList() {
        ListView lv = getListView();

        Cursor c = db.getData();
        startManagingCursor(c);

        CustomCursorAdapter adapter = new CustomCursorAdapter(getApplicationContext(), c);
        lv.setAdapter(adapter);

        lv.setOnItemClickListener(new OnItemClickListener() {

            public void onItemClick(AdapterView<?> parent, View view, int position, long id){
                Intent k = new Intent(MainActivity.this, ProductDetails.class);
            }
        });
    }

} 
```

**自定义光标适配器：**

```
public class CustomCursorAdapter extends CursorAdapter {

        public CustomCursorAdapter(Context context, Cursor cursor) {
            super(context, cursor);
        }

        @Override
        public View newView(Context context, Cursor cursor, ViewGroup parent) {
            LayoutInflater inflater = LayoutInflater.from(context);
            View v = inflater.inflate(R.layout.list_entry, parent, false);
            bindView(v, context, cursor);
            return v;
        }

        @Override
        public void bindView(View view, Context context, Cursor cursor) {
            TextView txtvw1 = (TextView)view.findViewById(R.id.prodcode_entry);
            txtvw1.setText(cursor.getString(cursor.getColumnIndex(ProdDB.KEY_PRODCODE)));

            TextView txtvw2 = (TextView)view.findViewById(R.id.prodtype_entry);
            String ptype = (cursor.getString(cursor.getColumnIndex(ProdDB.KEY_PRODTYPE)));
            txtvw2.setText(ptype.substring(0, 1));

            TextView txtvw3 = (TextView)view.findViewById(R.id.prodcat_entry);
            String cat = (cursor.getString(cursor.getColumnIndex(ProdDB.PRODCAT)));
            txtvw3.setText(cat.substring(0, 2));

            TextView txtvw4 = (TextView)view.findViewById(R.id.prodcost_entry);
            float price = (cursor.getFloat(cursor.getColumnIndex(ProdDB.PRODPRICE)));
            txtvw4.setText(Float.toString(price));

            TextView txtvw5 = (TextView)view.findViewById(R.id.prodSup_entry);
            txtvw5.setText(cursor.getString(cursor.getColumnIndex(ProdDB.SUPPLIER)));
        }
} 
```

**产品详情**

```
public class ProductDetails extends Activity {

    /** Called when the activity is first created. */
    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);

        setContentView(R.layout.product_details);
    }
} 
```

**db.getData() - 来自 ProdDB**

```
public Cursor getData() {
        String[] columns = new String[] {KEY_ROWID, 
                KEY_PRODCODE,
                KEY_PRODNAME,
                KEY_PRODTYPE,
                KEY_PRODCAT,
                KEY_PRODPRICE,
                KEY_PRODRRP,
                KEY_PRODSUPPLIER,
                KEY_NOTES};

        return db.query(DB_TABLE, columns, null, null, null, null, null);
    } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-07T21:13:03.423

在这一行之后：

```
Intent k = new Intent(MainActivity.this, ProductDetails.class); 
```

还传递项目的 id：

```
k.putExtra("item_id", id);
// and start the activity
startActivity(k); 
```

然后，从`ProductDeftails`活动中，再次获取 id，查询数据库并检索其信息：

```
// after setContentView...
long id = getIntent().getLongExtra("item_id", 0);
// use this variable to get the item again and populate your views 
```

`getLongExtra`接收要检索的额外的键加上一个默认值。总是值得检查返回值与默认值，以确保活动确实收到了一些东西。

所以，下次记住这一点......创建一个意图不会启动它所代表的活动（你必须使用其中一个`startActivity`或`startActivityForResult`方法）。此外，您可以使用 Intent 的附加功能将数据传递给将要启动的活动。它可以是原始类型、字符串、字符串的 ArrayLists 或 Parcelables（单个对象、数组列表或数组）。

### 细节

要获取产品的详细信息，您可以使用以下内容：

```
String[] columns = new String[] {KEY_ROWID, 
        KEY_PRODCODE,
        KEY_PRODNAME,
        KEY_PRODTYPE,
        KEY_PRODCAT,
        KEY_PRODPRICE,
        KEY_PRODRRP,
        KEY_PRODSUPPLIER,
        KEY_NOTES};
return db.query(DB_TABLE, columns, KEY_ROWID + " = ?", new String[]{String.valueOf(id)}, null, null, null); 
```

您可以将它放在一个名为`getDetails(long id)`（`ProdDB`类内部）的新方法中。然后，在您的活动中，您可以执行以下操作：

```
Cursor cursor = db.getDetails(id);
if(cursor.moveToFirst()){
    // I assume you had already created the views in the ProductDetails activity
    txtvw1.setText(cursor.getString(cursor.getColumnIndex(ProdDB.KEY_PRODCODE)))
} else {
    // something went wrong, do something
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-07T21:17:59.670

您应该创建一个类来表示数据库中的每个数据，并具有相同的字段。然后您将能够在适配器中使用它，并且可以更轻松地做您想做的事情，因为您将能够在`onItemClick()`使用 integer 的方法中检索`position`。然后您只需将其放入 中`Intent`，然后在第二个活动中您可以使用它来显示`ListView`未显示的其他信息（字段）。

# objective-c - 每次滑动后增加页面 Objective-C

> ID：13278260
> 
> 赞同：7
> 
> 时间：2012-11-07T21:08:50.910
> 
> 标签：objective-c, ipad, uiswipegesturerecognizer

我有一个`UIViewController`，里面有 3 个`UIWebView`。我以编程方式向我的 webViews 添加了向左滑动。现在我可以滑动，但只有 3 页，然后再次重复。我想增加我的 currentPage 并将其添加到我的 webView3，但我不知道该怎么做。

你能给我一些提示吗？这部分我真的有问题！

这是我的代码：

```
- (void)viewDidLoad
{
[super viewDidLoad];
NSLog(@"test view");

NSURL *url = [NSURL fileURLWithPath:[ [ NSBundle mainBundle ] pathForResource: @"Name/Name1" ofType:@"html" ]];
NSURLRequest *request = [NSURLRequest requestWithURL:url];
 [webView2 loadRequest:request];
 [webView2 bringToFront];

  NSURL *url = [NSURL fileURLWithPath:[ [ NSBundle mainBundle ] pathForResource: 
@"Name/Name2" ofType:@"html" ]];
NSURLRequest *request = [NSURLRequest requestWithURL:url];
 [webView3 loadRequest:request]; 

UISwipeGestureRecognizer *swipeLeft = [[UISwipeGestureRecognizer alloc]  
initWithTarget:self action:@selector(swipeLeftAction:)];
swipeLeft.direction = UISwipeGestureRecognizerDirectionLeft;
swipeLeft.delegate = self;
[self.view addGestureRecognizer:swipeLeft];
}

- (BOOL)gestureRecognizer:(UIGestureRecognizer *)gestureRecognizer 
 shouldRecognizeSimultaneouslyWithGestureRecognizer:(UIGestureRecognizer 
*)otherGestureRecognizer
{
return YES;
} 
```

currentPage 是一个整数，一开始它是 0。我的问题是我应该如何将我的 currentPage 添加到 webView3 以便当我刷它时增加我的页面？

```
 - (void)swipeLeftAction:(id)ignored
 {
NSLog(@"Swipe Left");
UIWebView *temp = webView2 ;
webView2 = webView3;
webView3 = webView;
webView = temp;

[webView2 bringToFront];
currentPage++;
 } 
```

提前致谢！

****编辑：**

此当前页面未连接到任何 webView，如何在我的 webView 中获得这种增加？**

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-08T19:20:55.470

根据这篇文章的信息（[UIGestureRecognizer 在 UIWebView 上工作吗？](https://stackoverflow.com/questions/2909807/does-uigesturerecognizer-work-on-a-uiwebview)），看起来手势识别器和 webviews 并不总是一起玩得很好，原因是 webview 自己的手势识别器。也许最好的方法是在你的 webview 中添加链接，当被触摸时使用你自己的方案来增加 currentPage

```
-(BOOL) webView:(UIWebView *)inWeb shouldStartLoadWithRequest:(NSURLRequest *)inRequest navigationType:(UIWebViewNavigationType)inType {
  if ( [[[inRequest URL] absoluteString] hasPrefix:@"mySchemeIncrementPage:"] ) {
    currentPage++;
    NSLog(@"CURRENT PAGE COUNT: %i", currentPage);
    return NO;
  }
} 
```

# activerecord - 使用 class_name 的几个多态关联？

> ID：13278263
> 
> 赞同：1
> 
> 时间：2012-11-07T21:09:09.813
> 
> 标签：activerecord, ruby-on-rails-3.2, nested-forms, nested-attributes, polymorphic-associations

我正在尝试使用 Rails 多态关联和嵌套表单创建一篇包含 in_prices 和 out_prices （每个国家/地区一个）的文章。

我有一个看起来像这样的数据模型：

```
# app/models/article.rb
class Article < ActiveRecord::Base
    has_many :out_prices, :class_name => "Price", :as => :priceable
    has_many :in_prices, :class_name => "Price", :as => :priceable
end

# app/models/price.rb
class Price < ActiveRecord::Base
    belongs_to :priceable, :polymorphic => true
end

# db.schema for prices
create_table "prices", :force => true do |t|
    t.integer  "value"
    t.integer  "country_id"
    t.integer  "priceable_id"
    t.string   "priceable_type"
end 
```

文章及其关联是使用嵌套形式创建的，例如：

```
# app/views/articles/_article_form.html.erb
<%= form_for setup_article(@article) do |f| %>
    <%= f.fields_for :in_prices do |ff| %>
        <%= ff.text_field :value %>
    <% end %>
    <%= f.fields_for :out_prices do |ff| %>
        <%= ff.text_field :value %>
    <% end %>
<% end %> 
```

setup_article 方法是建立关联的辅助方法：

```
# app/helpers/articles_helper.rb
def setup_article(article)
    if article.in_prices.nil?
        # Setup one in price for each country
        Country.all.each do |country|
            article.in_prices.build(:value => 0, :country_id => country.id)
        end
    end
    if article.out_prices.nil?
        # Setup one out price for each country
        Country.all.each do |country|
            article.out_prices.build(:value => 0, :country_id => country.id)
        end
    end
    article
end 
```

需要 setup_article 以确保在创建新文章时显示空的价格表单字段（每个国家/地区一个）。

现在到实际问题。当我编辑已经创建的文章（关联了 in_prices 和 out_prices）时，Rails 将无法区分这些不同类型的多态关联（in_prices 和 out_prices）。因此，两个嵌套的表单助手都会为*所有*相关价格呈现表单字段，这不是所需的行为。我只想在其中一种嵌套形式中列出 in_prices，而在另一种形式中列出 out_prices。

应该如何配置这些关联以确保 rails 可以区分两个不同嵌套表单助手中的 in_prices 和 out_prices 关联？

**编辑**（***已解决***）

我的一个朋友指出我需要在价格表中添加另一个字段来标记它是什么类型的价格。我将此字段称为 price_type 并且 db.schema 最终看起来像这样：

```
# db.schema for prices
create_table "prices", :force => true do |t|
    t.integer  "value"
    t.integer  "price_type"
    t.integer  "country_id"
    t.integer  "priceable_id"
    t.string   "priceable_type"
end 
```

注意：不要将此字段命名为“类型”，因为这是保留名称。

可以通过在嵌套表单中添加隐藏字段（不太安全）来填充“price_type”字段，或者在保存文章及其相关数据之前在控制器中处理它。我选择将其添加为隐藏参数，例如：

```
# app/views/articles/_article_form.html.erb
<%= form_for setup_article(@article) do |f| %>
    <%= f.fields_for :in_prices do |ff| %>
        <%= ff.text_field :value %>
        <%= ff.text_field :price_type, :value => "in" %>
    <% end %>
    <%= f.fields_for :out_prices do |ff| %>
        <%= ff.text_field :value %>
        <%= ff.text_field :price_type, :value => "out" %>
    <% end %>
<% end %> 
```

为了确保关联被正确过滤，它们需要使用 ':conditions' 标签声明，例如：

```
# app/models/article.rb
class Article < ActiveRecord::Base
    has_many :out_prices, :class_name => "Price", :as => :priceable, :conditions => { :price_type => "in" } 
    has_many :in_prices, :class_name => "Price", :as => :priceable, :conditions => { :price_type => "out" }
end 
```

..现在一切都按预期工作。干杯！

# jquery-autocomplete - 表单上其他字段的自动填充值

> ID：13278264
> 
> 赞同：0
> 
> 时间：2012-11-07T21:09:11.730
> 
> 标签：jquery-autocomplete, jquery-ui-autocomplete

我想将表单上其他输入字段的值传递给具有 jquery 自动完成功能的输入。我尝试了几种方法，但都没有奏效。这是我到目前为止的一个例子：

html:

```
<input type="text" class="fieldname"/>
<input type="text" class="fieldname"/>
<input type="text" class="fieldname"/>
<input type="text" class="fieldname"/>
<input type="text" class="autofieldnames"/>
<input type="text" class="autofieldnames"/> 
```

jQuery：

```
$(".fieldname").each(function() {
  $(this).blur(function() {
    var fieldnames = $(".fieldname").map(function(){ return this.value; }).get();
    });
$(".autofieldnames").each(function() {
  $(this).autocomplete({ source: fieldnames });
  }); 
```

如果我手动设置 fieldnames 数组（即 fieldnames = ["aaa", "abc"];）自动完成工作但由于某种原因无法将其他字段的值传递到数组中。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-07T21:21:36.720

当你使用`var`关键字声明一个变量时，它就变成了一个局部变量。这意味着`fieldnames`它只对定义它的函数可见 - 而不是试图读取它的函数，所以删除`var`关键字。

但是，由于`fieldnames`它是一个非常通用的名称，因此您不应该将其设为全局变量（您也应尽量避免使用非通用名称创建全局变量，但使用通用命名的变量会更加危险）。因此，您应该将其声明为局部变量 - 但在**所有**需要它的函数可见的范围内。

像这样的东西：

```
$(function(){
        var fieldnames;
        $(".fieldname").each(function() {
                $(this).blur(function() {
                        fieldnames = $(".fieldname").map(function(){ return this.value; }).get();
                });
        });
        $(".autofieldnames").each(function() {
                $(this).autocomplete({ source: fieldnames });
        });
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-08T19:31:15.410

解决了。仅供参考，这就是我想出的：

```
html:
<input type="text" class="fieldname"/>
<input type="text" class="fieldname"/>
<input type="text" class="fieldname"/>
<input type="text" class="fieldname"/>
<input type="text" onfocus="getfieldnames"/>
<input type="text" onfocus="getfieldnames"/>

jquery:
function getfieldnames(obj) {
  var fieldnames = $(".fieldname").map(function(){ return this.value; }).get();
  $(obj).autocomplete({ source: fieldnames });
  } 
```

# javascript - 带有打印屏幕按钮的javascript弹出窗口

> ID：13278265
> 
> 赞同：0
> 
> 时间：2012-11-07T21:09:15.200
> 
> 标签：javascript

我有一个基本网页，它使用简单的 javascript 验证函数在返回 TRUE 以允许提交之前验证字段内容。如果 validate 为 false，那么它只显示一个 alert() 并返回 FALSE。

但是，我需要对此进行修改，以便如果一切都验证，则会出现一个弹出窗口，上面写着“您即将提交此表单并同意 XYZ。单击确定继续，取消离开，或打印以打印此页面”

换句话说，我需要一个带有 OK、CANCEL 和 PRINT 按钮的警告框（打印按钮实际上会打印页面本身，然后允许用户单击 OK 并继续执行提交命令。

** 编辑：我应该澄清一下，使用模式弹出窗口会导致该模式出现在打印屏幕中。所以也许 close.modal 后跟一组 print.screen 命令？库不是一个选项，因为我们被限制在没有任何外部负载的单个页面上，因为这是在银行平台内部，并且它们只允许 html/inline-css/on-page javascript。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-07T21:12:09.043

您需要使用自定义代码来执行此操作，因为无法将按钮添加到 window.confirm。

像[jQuery UI](http://jqueryui.com/dialog/#modal-confirmation)、[YUI](http://developer.yahoo.com/yui/examples/container/simpledialog-quickstart.html)、[DOJO](http://livedocs.dojotoolkit.org/dijit/Dialog)等库有一个模态对话框，可以让你做类似的事情。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-07T22:06:05.940

[http://jsfiddle.net/QRm4c/1/](http://jsfiddle.net/QRm4c/1/)

你总是可以只用 a`<div>`来制作一个假的。

```
<div id="confirmation">
    <p>Blah, blah, blah</p>
    <form>
        <input type="button" name="ok" id="ok" value="OK" />
        <input type="button" name="cancel" id="cancel" value="Cancel" />
        <input type="button" name="confirm" id="confirm" value="Confirm" />
    </form>
</div> 
```

epascarello 是对的，window.confirm 不能这样做。

# firefox - 在 FireFox 的插件中调用 GetOpenFileName

> ID：13278268
> 
> 赞同：0
> 
> 时间：2012-11-07T21:09:31.853
> 
> 标签：firefox, npapi, browser-plugin

我为 FireFox 编写了插件，它提供了选择文件的方法。此方法调用 Win API 函数`GetOpenFileName`。当显示“打开文件”对话框并且我没有切换到其他窗口时，一切正常。如果我点击浏览器窗口，那么一切都会被阻止，一段时间后我会看到插件崩溃的消息。此问题仅在 FireFox 中存在，在 Chrome 和 Safari 中不存在。`GetOpenFileName`我认为这与有自己的消息循环的事实有关。有没有简单的方法来纠正这种行为？

例如函数`SHBrowseForFolder`在 FireFox 中运行良好。

在 FireFox 源代码中，我看到了可能可以解决这个问题的类`MessageLoop`和方法`SetNestableTasksAllowed()`（至少这个结论可以从标题中的解释中得出）。但是在 xulrunner-sdk-13.0.1 中没有带有类的头文件，`MessageLoop`尽管有带有 function 的 xul.lib `GetIOMessageLoop`。可能可以从 FireFox 源中获取标头，但我认为在我的 VS 2010 项目中使用它们并不容易

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-08T03:43:38.830

您需要在这里了解的主要内容是，您绝*不能*阻塞 NPAPI 插件中的主线程。你所说的函​​数都是阻塞调用，所以你绝对不能在主线程上使用它们。

如果您在不同的线程上调用它们，您的问题应该会消失；请注意，当您执行此操作时，您可能需要一个回调函数（javascript 函数以 NPObject 形式出现，您可以在其上调用 InvokeDefault），并且您只能在主线程上调用 NPN_InvokeDefault，因此您必须设置一个在主线程上进行回调的方法。

# c# - iOs 是否与 C# Array.GetLength(int dimension) 等效？

> ID：13278272
> 
> 赞同：-3
> 
> 时间：2012-11-07T21:09:42.337
> 
> 标签：c#, objective-c, ios, multidimensional-array

如何获得多维数组，一维，长度（在目标 c 中）？

在 C# 中是：

```
Array.GetLength(int dimension) 
```

我正在寻找类似这样的东西：

```
int[10,4] mda = new int[10,4];
int A = mda.GetLength(1);
//A=4 
```

我知道有一些方法可以在不使用内置函数的情况下实现这一点..

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-07T21:38:42.330

您可以使用`[mda objectAtIndex:0].count;`它应该返回多维数组索引 0 处的数组长度。

`[mda objectAtIndex:0].count;`应该与`mda.GetLength(1)`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-07T21:14:00.443

```
NSArray *myArray = [NSArray alloc] initWithObjects:@"1", @"2", @"3", nil];

int arrayCount = [myArray count]; //arrayCount = 3 
```

也可通过以下方式访问：

```
myArray.count 
```

# c++ - 自定义 QGraphicItem 和重绘问题

> ID：13278281
> 
> 赞同：1
> 
> 时间：2012-11-07T21:10:33.147
> 
> 标签：c++, qt

所有，我实现了一个 QGraphicsItem，它是一个多边形。我通过使用作为点（用于拖动功能）来加快开发速度`QGraphicsEllipseItem`。但是，我现在在`update()`功能上遇到了困难。我的代码贴在最后，我的问题是：

1.  我在这里采取了正确的方法吗？我开始怀疑自己
2.  我应该调用`QGraphicsItem::update()`我的实现吗？我经常称呼它

其他一些信息：

*   我做了一个肮脏的小黑客。在我的实际代码中，我也继承自`QObject`. 这允许我安装一个`eventFilter`on the scene() （我知道它是使用 设置的`itemChange`）。从我`QGraphicsSceneMouseEvent`在鼠标移动期间过滤并调用的场景中，`QGraphicsItem::update()`否则我的线条不会被重绘。
*   当我现在将我`InteractivePolygon`从场景中移除时，我的线条并没有被移除！我必须调用场景（）->更新。我觉得有些不对劲。

* * *

宣言：

```
class InteractivePolygon : public QGraphicsItem
{

public:
   //Only important methods
   QRectF boundingRect() const;
   void paint(bla bla bla);
   bool eventFilter(QObject *, QEvent *);

private:
   QList<QGraphicsEllipseItem *> m_points;

   void AddPolygonPoint(QPointF);
   QGraphicsEllipseItem * MakeNewPoint(QPointF);
} 
```

执行：

```
QRectF InteractivePolygon::boundingRect() const
{
   return childrenBoundingRect();
}

void InteractivePolygon::paint(QPainter painter.. otherstuf)
{
   QPen line_pen(QColor(255,0,0));
   painter->setPen(line_pen);

   if(m_points.count() > 1)
   {
      for(int i = 1; i < m_points.count(); ++i)
          painter->drawLine(m_points[i-1]->pos(), m_points[i]->pos());
   }
}

void AddPolygonPoint(QRectF point)
{
   QGraphicsEllipseItem * new_item = MakeNewPoint(point);
   new_item->setParent(this);

   m_points->push_front(new_item);

   update();  
}

QGraphicsEllipseItem * InteractivePolygon::MakeNewPoint(QPointF & new_point)
{
   QGraphicsEllipseItem * result = 0;
   result = new QGraphicsEllipseItem();
   result->setPos(new_point);
   result->setRect(-4, -4, 8, 8);
   result->setFlags(QGraphicsItem::ItemIsMovable | QGraphicsItem::ItemIsSelectable)

   return result;
}

//Lets pretend this method is correctly setup/exists
bool InteractivePolygon::eventFilter(QObject *object, QEvent *event)
{
   if(event->type() == QEvent::QEvent::GraphicsSceneMouseMove)
   {
      QGraphicsSceneMouseEvent * mouse_move = (QGraphicsSceneMouseEvent *)event;
      //Selected index is set else, let's assume it works
      if(selected_index)
      {
         update(); //If I don't do this, my lines in my paint() are not redrawn.
      }
   }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-08T14:42:19.983

解决方案是`prepareGeometryChange()`每次我更改我的项目中会改变其边界框的任何内容。一切都正确重绘并根据需要进行更新。

这使我可以删除所有`update()`呼叫。

# servlets - 如何获取运行的 servlet 的确切路径？

> ID：13278282
> 
> 赞同：0
> 
> 时间：2012-11-07T21:10:34.660
> 
> 标签：servlets, path

我有一个在 servlet 中使用的应用程序。应用程序假定文本数据库位于执行它的同一目录中。当我尝试在 servlet 中使用它时，甚至在将文本数据库文件放在 /WebContent、/DataProject 和 src 文件夹中之后。应用程序找不到数据库。我需要确切知道 servlet 文件的执行位置，以便可以将数据库文件放在同一目录中。我已经有 /.metadata/.plugin......../tmp0/wtpwebapps 目录。任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-08T15:58:47.610

通常当我们在 java 中访问文件时，我们会给出绝对路径。不要使用相对路径。我们对 jsp/html/css 等使用相对路径。对于访问普通文件，使用完整路径。所以把文件放在 /home/tomcat/.../../directoryDatabase

# javascript - 绑定到 jQuery：输入不是触发事件

> ID：13278286
> 
> 赞同：-4
> 
> 时间：2012-11-07T21:10:52.777
> 
> 标签：javascript, jquery

这是我运行它时不起作用的代码。请告诉我缺少什么或哪里出错了。

```
$(':input').bind('keypress keydown keyup change', function() {
    var acho = parseFloat($(':input[name="acho"]').val(),10),
        alto = parseFloat($(':input[name="alto"]').val(),10),
        matl = parseFloat($(':input[name="material"]').val(),10);
        cat = parseFloat($(':input[name="category"]').val(),10);

    var v = '';

    if (!isNaN(acho) && !isNaN(alto) && !isNaN(matl)){
        v = cat*(matl / 100) / ((alto / 100) * (acho / 100));
    }

    $(':input[name="ml"]').val(v.toString());

​});​ 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-07T21:13:46.827

您的变量定义存在问题：

```
matl = parseFloat($(':input[name="material"]').val(),10); 
```

这一行后面应该有一个逗号，后面的变量赋值的 b/c。我会投入`v`只是为了很好的衡量。

```
var acho = parseFloat($(':input[name="acho"]').val()),
    alto = parseFloat($(':input[name="alto"]').val()),
    matl = parseFloat($(':input[name="material"]').val()),
    cat = parseFloat($(':input[name="category"]').val()),
    v = ''; 
```

（还从 中删除了无效的基数参数`parseFloat`）

更正的代码：

```
$(':input').bind('keypress keydown keyup change', function() {
    var acho = parseFloat($(':input[name="acho"]').val()),
        alto = parseFloat($(':input[name="alto"]').val()),
        matl = parseFloat($(':input[name="material"]').val()),
        cat = parseFloat($(':input[name="category"]').val()),
        v = '';

    if ( !isNaN(acho) && !isNaN(alto) && !isNaN(matl) ){
        v = cat*(matl / 100) / ((alto / 100) * (acho / 100));
    }

    $(':input[name="ml"]').val( v.toString() );
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-07T21:25:46.693

您的代码*大多*有效：

1.  确保它在`document.ready`处理程序中
2.  从中删除`10`radix 参数`parseFloat`- 不支持
3.  不要在`keyXXX`函数上注册 - 其中一些在按下的键被添加到输入值之前被调用
4.  改用 HTML5 的`input`事件 (and `change`)
5.  不要忘记测试`cat`[`isNaN` 啊，这是一个下拉列表 - 没关系]
6.  确保每个`var`都正确声明

我的修改最少的工作版本位于[http://jsfiddle.net/alnitak/6hNQ2/](http://jsfiddle.net/alnitak/6hNQ2/)和清理后的版本：

```
$(':input').bind('input change', function() {

    // don't repeat yourself - also strips whitespace
    function val(f) {
        var $el = $(':input[name="' + f + '"]');
        return parseFloat($.trim($el.val()));
    }

    var acho = val('acho'),
        alto = val('alto'),
        matl = val('material'),
        cat = val('category');

    if (isNaN(acho) || isNaN(alto) || isNaN(matl)) {
        return;
    }

    var v = cat * (matl / 100) / ((alto / 100) * (acho / 100));
    $(':input[name="ml"]').val(v);
});​ 
```

在[http://jsfiddle.net/alnitak/4Xw3D/](http://jsfiddle.net/alnitak/4Xw3D/)

# android - 廉价安卓平板电脑上的 Hammer.js 触摸手势不起作用

> ID：13278288
> 
> 赞同：0
> 
> 时间：2012-11-07T21:10:57.883
> 
> 标签：android, hammer.js

我刚买了一个 7" android 4.0 平板电脑（Arnova 7F G3），我正在尝试运行几个演示来测试触摸手势。事情是......当我触摸屏幕时什么都没有发生，而在 iPad 上，它工作一种享受！真的很顺利！

我正在查看的演示是： http: [//riagora.com/mobile/hammer/](http://riagora.com/mobile/hammer/)

正如我所说，它在 iPad 上和我桌面上的 Firefox 上都很完美。只是想知道平板电脑是否只是垃圾？也就是说，对于大多数其他事情来说，它真的很快

有人知道发生了什么吗？

干杯! D

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-23T22:06:57.207

quick update! I've just downloaded the latest version of Firefox for Android and all the gesture events seem to be working. Still no luck with the default stock android 4.0.2 browser which is very disappointing! Also Dolphin, which I had high hopes for is a dead duck!

But at least I know its not the tablet that sux! In fact it is very smooth and quick! Kudos to Arnova!

Cheers! Dec

# php - 对数据库中的代码使用 php eval

> ID：13278290
> 
> 赞同：-1
> 
> 时间：2012-11-07T21:11:12.837
> 
> 标签：php, mysql, forms, input, eval

我正在尝试根据 Mysql 数据库中的信息自动生成表单。现在，一张表存储有关所需字段的信息——字段类型、最大长度、默认值等。

第二个表包含 html / php 代码，用于根据从前面提到的表中检索到的信息显示正确的表单输入。这些表都不包括任何用户输入的数据。为了处理和显示这个存储的代码，我一直在尝试使用 php 的 eval 函数。虽然我不确定这是一个好的解决方案，但我能想到的唯一选择是拥有几十个一两行文件，这些文件是通过使用 php 的 include 或使用 jquery 来附加内容来检索的。我不想这样做的主要原因是为了避免有几十个额外的文件。

这是我到目前为止的 eval 语句

```
eval("\$code=\"$field[input_code]\";");echo"<td>$code</td>"; 
```

这是 $field['input_code'] 的内容之一的示例

```
<input name='".$field['form_name']."'type='text'placeholder='".ucwords(str_replace('_',' ',$field['form_name']))."'".if($field['req']==1){echo"class='textvalreq'required";}else{echo"class='textval'";}."> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-07T21:19:17.203

如果`$field['input_code']`包含表达式，

```
eval("\$code=\"$field[input_code]\";"); 
```

将无法工作，因为 php 会尝试做某事。喜欢：

```
$code = "if (<condition>) { ... }"; 
```

这最终会成为一个有效的字符串，但如果变量包含引号，所有的地狱都会崩溃。

对不起。除了不将任意代码存储在数据库中并尝试使用之外，我没有看到解决该问题的简单方法`eval()`。

顺便说一句：`eval()`是邪恶的。

# linq - EF Tracing Provider 确定调用方法或被查询的实体

> ID：13278294
> 
> 赞同：1
> 
> 时间：2012-11-07T21:11:40.457
> 
> 标签：linq, entity-framework, logging, linq-to-entities, ef-code-first

我已经让 EFTracingProvider 与我的代码优先应用程序一起工作，但是在记录时，我的应用程序会尝试记录调用类。由于我的上下文始终是 EFTracing 提供程序所在的位置，因此这就是存储在调用类中的内容，即使引用实体的实际尝试发生在另一个类中。

无论如何要跟踪实际调用发生的位置，或者跟踪上下文中的哪个实体或 DBSet 试图被访问，然后导致 Tracing 触发？

# objective-c - 在 VoIP 通话中 iphone gsm 通话静音铃声

> ID：13278297
> 
> 赞同：1
> 
> 时间：2012-11-07T21:11:48.787
> 
> 标签：objective-c, ios, pjsip

有什么方法可以静音或降低 iphone 上 gsm 通话的铃声。

问题是当有人正在进行 voip 呼叫并且 gsm 呼叫通过时，那么一个人可能需要看医生。无论如何以编程方式暂时静音或降低铃声？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-05T11:21:16.803

在 Apple 重新考虑为开发人员提供一些自由之前，无法以编程方式更改铃声音量。

# c# - 样式化多个验证控件

> ID：13278303
> 
> 赞同：1
> 
> 时间：2012-11-07T21:12:00.050
> 
> 标签：c#, asp.net, validation, controls

我正在使用验证控件（即`RequiredFieldValidator`and `RegularExpressionValidator`）并且在让它们正确设置样式时遇到了一些麻烦。

问题是因为我有这样的标记：

```
<asp:RequiredFieldValidator ID="EmailRequiredValidator" ControlToValidate="Email" ErrorMessage="Email field is required" runat="server"></asp:RequiredFieldValidator>
<asp:RegularExpressionValidator ID="EmailFormatValidator" ControlToValidate="Email" ValidationExpression="^[_a-z0-9-]+(\.[_a-z0-9-]+)*@[a-z0-9-]+(\.[a-z0-9-]+)*(\.[a-z]{2,4})$" runat="server" ErrorMessage="Invalid email address"></asp:RegularExpressionValidator> 
```

`RegularExpressionValidator`被推到一边，因为它`RegularExpressionValidator`在路上。也许图形表示会有所帮助：

![问题](../Images/193ffc517e7a4ac9840dc7e4f63b4b6e.png)

“无效的电子邮件地址”错误标签本应位于输入框旁边，但另一个验证器将其推到一边。

我怎样才能使验证器不可见，直到它们发出错误消息或使它们相互浮动？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-07T21:31:27.620

我相信关键是 Display='Dynamic'，这是 Validators 的一个属性。

# c++ - 当有人尝试在当前 .cpp 或 .h 文件中使用 STL 时显示错误（在 Visual Studio 中）

> ID：13278304
> 
> 赞同：1
> 
> 时间：2012-11-07T21:12:07.607
> 
> 标签：c++, visual-studio, stl

在我们公司，有时我们会编写 .cpp 和 .h 文件，这些文件用于旧 WM（我们为此使用 Embedded Visual C++ 3.0 或其他东西）和更现代的代码（VS 2010）的项目中。

此 Embedded Visual C++ 不支持 STL。

因此，如果一位在 VS2010 中工作的开发人员更改了一个共享的文件，并添加了一些使用 std::vector 的函数，例如，在他这边一切都会好起来的，但是构建（相当长） 将失败。

所以为了早点看到这个错误，我想添加类似

```
#if defined(%%STL%%)
#error("!!!!")
#endif 
```

在所有使用旧工具集编译的文件中。在这种情况下，即使在 VS2010 中，开发人员也可以看到编译时错误。

但我找不到我可以放的东西 %%STL%% 那里。

有任何想法吗？或者也许有人知道我可以如何做到这一点的更好方法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-07T21:24:13.510

根据对该问题的评论，您可以浏览每个不受支持的头文件，并查看它们为其包含保护定义的符号。然后检查那些被定义的符号。

EG Microsoft C++ 标头`<algorithm>`定义`_ALGORITHM_`，因此您可以检查：

```
#ifdef _ALGORITHM_
#error("<algorithm> included")
#endif 
```

可以将其中的一堆收集起来并放入一个头文件中，最后您可以将其包含在每个共享源文件中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-07T22:18:31.083

有一个很好的解决方案（至少我没有看到陷阱）

**%%STL%%**应该是**_STD_BEGIN**

此宏用于 VS stl 实现中的“命名空间 std {”

# iphone - 从应用程序内关闭 iPhone 应用程序

> ID：13278305
> 
> 赞同：1
> 
> 时间：2012-11-07T21:12:07.760
> 
> 标签：iphone, ios, xcode, ios5, ios6

有没有办法从应用程序内关闭 iPhone 应用程序？一位客户问我是否有一种方法可以通过按下应用程序中的按钮来关闭应用程序，而无需手动通过双击主页按钮然后按住应用程序图标然后点击 - 符号来关闭应用程序。

显然，客户想要构建一个使用蓝牙和 ANT+ 设备的应用程序，这些设备是耗电的，并希望能够快速关闭应用程序。

有什么想法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-07T21:14:35.713

我认为你应该让按钮处理蓝牙和其他“电池猪”。您甚至可以使应用程序足够智能，以根据某些事件（例如用户离开应用程序或某个功能完成时）将其关闭。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-07T21:15:45.790

除了退出应用程序中的按钮违反[Apple 人机界面指南](http://developer.apple.com/library/ios/#documentation/UserExperience/Conceptual/MobileHIG/UEBestPractices/UEBestPractices.html#//apple_ref/doc/uid/TP40006556-CH20-SW27)外，它甚至不是[推荐的行为](https://stackoverflow.com/questions/3097244/exit-application-in-ios-4-0)。

但是如果你仍然想关闭你的应用程序。使用“退出（）；”。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-07T21:29:28.880

此行为违反 Apple 的人机界面指南。如果您仍想这样做，请使用 C 函数`exit();`。但是对于用户来说，这看起来就像应用程序崩溃了，所以我不会这样做，即使不是在非 AppStore 应用程序上！

# android - DialogFragment 方向更改时发生内存泄漏，扩展 Spinner

> ID：13278308
> 
> 赞同：1
> 
> 时间：2012-11-07T21:12:14.543
> 
> 标签：android, memory-leaks, android-spinner, orientation-changes

我知道有很多关于内存泄漏和方向变化的问题。我花了几个小时寻找和测试试图弄清楚到底发生了什么。我已将我的应用程序与一个活动和一个对话框片段配对。对话片段在方向改变时消失。我知道并且知道如何处理它。我只是想尽量减少代码量。当我点击微调器以展开它，然后改变方向时，我得到了内存泄漏。如果没有展开它，对话框就会消失——现在这很好。

谁能明白为什么我扩展的 Spinner 会在方向更改时出现内存泄漏？是我还是我必须解决的android bug？

这是我的应用程序代码：

测试 Manifest.xml

```
<manifest xmlns:android="http://schemas.android.com/apk/res/android"
package="com.danlconsulting.testing"
android:versionCode="1"
android:versionName="1.0" >

<uses-sdk
    android:minSdkVersion="8"
    android:targetSdkVersion="15" />

<application >
    <activity
        android:name=".MainActivity"
        android:label="Main" >
        <intent-filter>
            <action android:name="android.intent.action.MAIN" />

            <category android:name="android.intent.category.LAUNCHER" />
        </intent-filter>
    </activity>
</application> 
```

MainActivity.java

```
package com.danlconsulting.testing;

import android.os.Bundle;
import android.support.v4.app.FragmentActivity;

public class MainActivity extends FragmentActivity {

    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);

        MyDialogFragment myDialog = new MyDialogFragment();
        myDialog.show(getSupportFragmentManager(), "dlg");
    }
} 
```

MyDialogFragment.java

```
package com.danlconsulting.testing;

import android.os.Bundle;
import android.support.v4.app.DialogFragment;
import android.view.LayoutInflater;
import android.view.View;
import android.view.ViewGroup;

public class MyDialogFragment extends DialogFragment{

    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        //setRetainInstance(true);
    }

    @Override
    public View onCreateView(LayoutInflater inflater, ViewGroup container,
            Bundle savedInstanceState) {
        return inflater.inflate(R.layout.dialog_fragment,container,false);
    }  
} 
```

dialog_fragment.xml

```
 <?xml version="1.0" encoding="utf-8"?>
    <ScrollView xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="match_parent"
    android:layout_height="wrap_content" >

    <LinearLayout
        xmlns:android="http://schemas.android.com/apk/res/android"
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        android:minWidth="1000dp"       
        android:orientation="vertical" >

        <Spinner
            android:id="@+id/inputSpinner"
            android:layout_width="match_parent"
            android:layout_height="0dip"
            android:layout_weight="0.07" />

    </LinearLayout>

</ScrollView> 
```

和activity_main.xml

```
<?xml version="1.0" encoding="utf-8"?>

 <LinearLayout
     xmlns:android="http://schemas.android.com/apk/res/android"
     android:paddingTop="4dip"
     android:paddingBottom="6dip"
     android:layout_width="fill_parent"
     android:layout_height="wrap_content"
     android:orientation="horizontal">
</LinearLayout> 
```

编辑：当然，我刚刚看到另一个似乎相同的问题。

[Spinner 下拉列表和屏幕方向更改问题](https://stackoverflow.com/questions/5233741/spinner-drop-down-list-and-screen-orientation-change-problem)

但是，我认为添加 android:configChanges="keyboardHidden|orientation" 不是理想的解决方案？

我的日志：

11-07 14:59:34.834: E/WindowManager(14250): 活动 com.danlconsulting.testing.MainActivity 泄露了最初添加在这里的窗口 com.android.internal.policy.impl.PhoneWindow$DecorView@40531e60 11-07 14:59:34.834: E/WindowManager(14250): android.view.WindowLeaked: Activity com.danlconsulting.testing.MainActivity 泄露了最初添加在这里的窗口 com.android.internal.policy.impl.PhoneWindow$DecorView@40531e60 11-07 14:59:34.834: E/WindowManager(14250): 在 android.view.ViewRoot.(ViewRoot.java:273) 11-07 14:59:34.834: E/WindowManager(14250): 在 android.view .WindowManagerImpl.addView(WindowManagerImpl.java:174) 11-07 14:59:34.834: E/WindowManager(14250): 在 android.view.WindowManagerImpl.addView(WindowManagerImpl.java:117) 11-07 14:59:34.834 : E/WindowManager(14250): 在 android.view.Window$LocalWindowManager。addView(Window.java:424) 11-07 14:59:34.834: E/WindowManager(14250): 在 android.app.Dialog.show(Dialog.java:241) 11-07 14:59:34.834: E/ WindowManager(14250): 在 android.app.AlertDialog$Builder.show(AlertDialog.java:823) 11-07 14:59:34.834: E/WindowManager(14250): 在 android.widget.Spinner.performClick(Spinner.java :265) 11-07 14:59:34.834: E/WindowManager(14250): 在 android.view.View$PerformClick.run(View.java:9299) 11-07 14:59:34.834: E/WindowManager(14250 ): 在 android.os.Handler.handleCallback(Handler.java:587) 11-07 14:59:34.834: E/WindowManager(14250): 在 android.os.Handler.dispatchMessage(Handler.java:92) 11- 07 14:59:34.834: E/WindowManager(14250): 在 android.os.Looper.loop(Looper.java:130) 11-07 14:59:34.834: E/WindowManager(14250): 在 android.app。 ActivityThread.main(ActivityThread.java:3691) 11-07 14:59:34.834:E/WindowManager(14250): 在 java.lang.reflect.Method.invokeNative(Native Method) 11-07 14:59:34.834: E/WindowManager(14250): 在 java.lang.reflect.Method.invoke(Method. java:507) 11-07 14:59:34.834: E/WindowManager(14250): 在 com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:912) 11-07 14:59:34.834: E/WindowManager(14250): 在 com.android.internal.os.ZygoteInit.main(ZygoteInit.java:670) 11-07 14:59:34.834: E/WindowManager(14250): 在 dalvik.system.NativeStart.main （本机方法）E/WindowManager(14250): 在 com.android.internal.os.ZygoteInit.main(ZygoteInit.java:670) 11-07 14:59:34.834: E/WindowManager(14250): 在 dalvik.system.NativeStart.main （本机方法）E/WindowManager(14250): 在 com.android.internal.os.ZygoteInit.main(ZygoteInit.java:670) 11-07 14:59:34.834: E/WindowManager(14250): 在 dalvik.system.NativeStart.main （本机方法）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-13T04:38:27.640

```
 private MyDialogFragment myDialog;

    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);

        myDialog = new MyDialogFragment();
        myDialog.show(getSupportFragmentManager(), "dlg");
    }

    @Override
    public void onConfigurationChanged( Configuration newConfig ) {
        super.onConfigurationChanged( newConfig );
        if( !myDialog.isHidden() ){
            myDialog.dismiss();
        }
    } 
```

# sql - Subs 0 表示没有结果的 SQL 语句

> ID：13278315
> 
> 赞同：4
> 
> 时间：2012-11-07T21:12:40.647
> 
> 标签：sql

我在从我的 SQL 语句中获取我想要的结果时遇到问题。我知道我可能遗漏了一些简单的东西，但我就是看不到它。

这是我的桌子。

```
表：用户 *（RoleID 与 Roles 表中的 ID 相关联）*
ID、    FirstName、    LastName、    RoleID 
1，马特，瑞恩，1
2、奇普、琼斯、1
3，胡里奥，琼斯，2
4、杰森、伯恩、3

表：角色
ID、    名称
1、现场代表
2、科技
3、管理员

表：FRrequests  *（UserID 与 Users 表中的 ID 相关联）* 
ID、    UserID、     Status
1, 1, 打开
2, 1, 提交
3, 1, 延迟
4, 1, 完成

```

我想要的是一条 SQL 语句，它向我显示所有现场代表的所有“提交”和“延迟”请求的计数。下面是所需结果的示例。

```
名称             计数
奇珀·琼斯 0
马特·瑞恩 2

```

这是我到目前为止的声明以及它给我的结果。

```
SELECT Users.FirstName + ' ' + Users.LastName AS Name, COUNT(FRrequests.ID) AS 'Open Requests'
FROM 用户 INNER JOIN
          角色 ON Users.RoleID = Roles.ID LEFT OUTER JOIN
          FRrequests ON Users.ID = FRrequests.UserID
WHERE (Roles.Name = N'Field Rep') AND (FRrequests.Status = 'Submitted' OR FRrequests.Status = 'Delayed')
GROUP BY Users.FirstName, Users.LastName

名称             计数
马特·瑞恩 2

```

我知道“AND（FRrequests.Status = 'Submitted' OR FRrequests.Status = 'Delayed'）”部分是破坏它的原因。如果我在语句中不使用它运行它，我会得到所有用户，但它会计算所有状态，而不仅仅是提交和延迟。我只是无法弄清楚我缺少什么才能让它工作。任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-07T21:18:22.643

您真的很接近，请尝试以下操作：

```
SELECT U.FirstName + ' ' + U.LastName AS Name, COUNT(F.ID) AS 'Open Requests'
FROM Users U
INNER JOIN Roles R
    ON U.RoleID = R.ID 
LEFT JOIN ( SELECT * FROM FRrequests 
            WHERE Status IN ('Submitted','Delayed')) F
    ON U.ID = F.UserID
WHERE R.Name = N'Field Rep' 
GROUP BY U.FirstName, U.LastName 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-07T21:29:10.300

如果您希望包含没有请求的现场代表，则需要为每个现场代表设置一行。因此，您需要按照以下几行使用左外连接：

```
SELECT 
    u.FirstName || ' ' || u.LastName as Name 
    , COALESCE(frr.Counter,0) as Count 
FROM 
    Users u 
    LEFT OUTER JOIN ( 
        SELECT 
            UserID 
            ,count(*) as Counter 
        FROM 
            FRrequests 
        WHERE 
            Status IN ('Submitted', 'Delayed') 
        GROUP BY
            UserID
    ) frr ON frr.UserID = u.ID 
    , Roles r 
WHERE 
    u.ID = f.UserID 
    AND u.RoleID = r.ID 
    AND r.Name = 'Field Rep' 
; 
```

左外连接将仅在发生匹配时提供连接，因此它不会从自然连接集中删除行。在这种情况下，您将获得所有现场代表用户的列表，以及他们的 FR 请求计数，如果有的话，状态为“已提交”或“延迟”。

COALESCE 用于（至少在 Postgresql 中）检查空值，然后将其强制为提供的值，在本例中为 0。因此，如果出现 NULL 值（例如，因为没有从左外连接）它被 0 替换。

# xpages - 部分刷新不刷新渲染属性或组合框值

> ID：13278316
> 
> 赞同：-2
> 
> 时间：2012-11-07T21:12:43.747
> 
> 标签：xpages

```
<xp:comboBox id="txtRequestType" style="width:290px" required="true" defaultValue="Select One">

                        <xp:selectItem itemLabel="Select One" id="selectItem21">
                        </xp:selectItem>

                        <xp:selectItems>
                            <xp:this.value><![CDATA[#{javascript:return @DbColumn("","vwAdminRateTypes",1);}]]></xp:this.value>
                        </xp:selectItems>

                        </xp:comboBox>
<xp:br></xp:br>
<xp:comboBox id="txtRateType" style="width:290px" required="true" defaultValue="Select One">
                                <xp:selectItem itemLabel="Select One">
                                </xp:selectItem>
                                <xp:selectItems id="selectItems10">
                                    <xp:this.value><![CDATA[#{javascript:var key=getComponent("txtRequestType").getValue();
@DbLookup("","vwAdminRateTypes",key ,2);}]]></xp:this.value>
                                </xp:selectItems>

                            </xp:comboBox><xp:br></xp:br>
<xp:panel>
    <xp:label value="New Money" id="label1">
        <xp:this.rendered><![CDATA[#{javascript:return getComponent("txtRequestType").getValue() == "New Money";}]]></xp:this.rendered>
    </xp:label></xp:panel>
<xp:button value="Refresh" id="button1">
    <xp:eventHandler event="onclick" submit="false">
        <xp:this.script><![CDATA[XSP.partialRefreshGet("#{id:txtRateType}", {
   onComplete: function() {
XSP.partialRefreshGet("#{id:panel1}", {
    onComplete: function() {
        XSP.partialRefreshGet("#{id:computedField1}", {});
       }
   });
 }
 });]]
              ></xp:this.script>
    </xp:eventHandler>
</xp:button> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-07T21:58:33.443

*将您的XSP.partialRefreshGet*更改为*XSP.partialRefreshPost*。这将正确调用 JSF 生命周期并更新组件中的值。

```
<xp:eventHandler event="onclick" submit="false">
   <xp:this.script><![CDATA[
      XSP.partialRefreshPost("#{id:txtRateType}", {
         onComplete: function() {
            XSP.partialRefreshGet("#{id:panel1}", {
               onComplete: function() {
                  XSP.partialRefreshGet("#{id:computedField1}", {});
               }
         });
      }
   });]]></xp:this.script>
</xp:eventHandler> 
```

# encoding - Azure 编码密钥

> ID：13278318
> 
> 赞同：1
> 
> 时间：2012-11-07T21:12:47.150
> 
> 标签：encoding, key

我使用 enstratus 管理/编排平台，我需要将我的 Azure 帐户中的编码密钥添加到其中，但我似乎找不到它，谁能指出我正确的方向？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-08-27T18:25:26.527

对于新版本的 Enstratus、Dell Cloud Management，请执行以下程序：

要添加您的亚马逊账户，您需要以下信息：

```
Account number
Access key
Secret access key
AWS certificate
AWS private key 
```

如果您没有该信息，请按照这些说明获取您的 AWS 账户信息。

要通过 AWS Web 控制台生成新的访问密钥对和 X.509 证书：

```
Navigate to "Security Credentials" under your AWS account name.
Click on Account Identifiers at the bottom to find your AWS Account ID. Copy it to a notepad.
Click on "Create New Access Key". Note that AWS allows only two active keypairs.

Copy the Access Key ID and Secret Access Key.
Click on X-509 Certificates.
Download the Private Key File and X.509 Certificate.
Return to DCM and enter your AWS Account ID, Access Key ID, Secret Access Key, Certificate and Private Key.
Click Connect Cloud Account. 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-01-31T15:40:56.027

在这里阅读所有相关信息。基本要点是您必须在本地创建自己的证书并将其上传到您的 Azure 帐户。

[http://docs.enstratius.com/clouds/azure/configuration.html?highlight=azure](http://docs.enstratius.com/clouds/azure/configuration.html?highlight=azure)

# android - 在 ViewFlipper 中对齐视图

> ID：13278319
> 
> 赞同：1
> 
> 时间：2012-11-07T21:12:53.573
> 
> 标签：android, android-layout, viewflipper

我有一个在 2 个视图之间翻转的 ViewFlipper，一个视图是 ImageView，一个是 TextView。
图像和文本的大小取决于我从服务器检索到的内容。

我希望 TextView 始终具有与 ImageView 相同的高度尺寸，以便在翻转 ImageView 时 TextView 布局的大小不会改变，即使与 TextView 关联的文本很少；如果有很多文本，如果 TextView 的高度超过 ImageView，我想做一个 ellipsize="end"。

下面是我在布局中使用的代码：

```
<ViewFlipper
    android:id="@+id/flipperZoneMediumLeft"
    android:layout_width="fill_parent"
    android:layout_height="wrap_content">

    <ImageView
        android:id="@+id/imgZonePic"
        android:layout_width="fill_parent"
        android:layout_height="wrap_content"
        android:src="@drawable/stock_service1"
        android:background="@android:color/black"
        android:scaleType="center" />

    <TextView
        android:id="@+id/txtZoneNameFlipperLeft"
        android:layout_width="fill_parent"
        android:layout_height="wrap_content"
        android:ellipsize="end"
        android:gravity="center"
        android:text="This is a description"
        android:background="@android:color/black"
        android:textColor="@android:color/white" />
</ViewFlipper> 
```

我觉得这个问题有一个简单的解决方案，但我在这种方式上挣扎太久了。任何帮助解决我的问题将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-07T21:33:36.073

`ImageView`将and包裹`TextView`在 a 中`LinearLayout`，这样您就可以对它们施加权重。将它们的高度设置为 0dp 并给它们每个 layout_weight 1。这样它们将始终具有相同的高度。像这样：

```
<ViewFlipper
    android:id="@+id/flipperZoneMediumLeft"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent" >

    <LinearLayout
        android:layout_width="fill_parent"
        android:layout_height="fill_parent"
        android:orientation="vertical" >

        <LinearLayout
            android:layout_width="fill_parent"
            android:layout_height="0dp"
            android:layout_weight="1" >

            <ImageView
                android:id="@+id/imgZonePic"
                android:layout_width="fill_parent"
                android:layout_height="fill_parent"
                android:background="@android:color/black"
                android:scaleType="center"
                android:src="@drawable/stock_service1" />
        </LinearLayout>

        <LinearLayout
            android:layout_width="fill_parent"
            android:layout_height="0dp"
            android:layout_weight="1" >

            <TextView
                android:id="@+id/txtZoneNameFlipperLeft"
                android:layout_width="fill_parent"
                android:layout_height="fill_parent"
                android:background="@android:color/black"
                android:ellipsize="end"
                android:gravity="center"
                android:text="This is a description"
                android:textColor="@android:color/white" />
        </LinearLayout>
    </LinearLayout>

</ViewFlipper> 
```

# php - 安装时的 Wordpress WSOD

> ID：13278320
> 
> 赞同：0
> 
> 时间：2012-11-07T21:12:59.193
> 
> 标签：php, mysql, wordpress, wsod

我在安装全新的 WP 时遇到了一些问题。我正在尝试将其安装在客户端主机上。当我开始安装时，已经安装了 WP。我向客户询问了这件事，并被告知我可以删除它，这只是为了从他们这边进行测试。但是我保存了它并复制了数据库和东西。

然后，我从 FTP 中删除了所有文件，删除了数据库中的所有表和所有爵士乐。然后，我下载了一个全新的 WP 版本并上传。我在 wp-config.php 中设置了所有正确的值，然后启动了该站点并获得了白屏死机。

我删除了 wp-config.php 并得到了“没有 wp-config”的东西。我试图更改文件，甚至使用了 wisard，无论哪种方式我都得到了 WSOD 或 WP 错误。我被重定向到“wp-admin/install.php”，仅此而已。在 install.php 中，我开始回显内容以查看崩溃的位置。似乎它在这条线上崩溃了：

```
require_once( dirname( dirname( __FILE__ ) ) . '/wp-load.php' ); 
```

然后，我尝试将 define('WP_HOME', '') 和 d define('WP_SITEURL', '') 设置为实际的 URL。我什至尝试获取旧站点的 .htaccess 文件，但它什么也没给我。然后我开始用谷歌搜索，一无所获。

在此之后，我放弃并安装了客户之前在那里的所有旧表进行测试，然后上传了旧站点。仍然是WSOD。

有谁知道这里发生了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-08T18:26:26.113

好吧，正如我在评论中提到的，问题是一堆重新声明......

传输文件时发生了非常糟糕的事情，文件变得非常糟糕。

如果文件看起来像这样：

```
<?php
/* BLA BLA INFO */
function a_function()
{ //something } 
```

该文件在上传时可能如下所示：

```
<?php
/* BLA BLA INFO */
function a_function()
{ //something }
<?php
/* BLA BLA INFO */
function a_function()
{ //something } 
```

这使得某些文件中的重新声明，而不是所有文件，只是随机文件。楼主在测试的时候也遇到了同样的问题，所以那边真的很糟糕。

至少，现在我知道为什么 WSOD 的原因 :)

# object - 致命错误：在非对象 symfony 1.4 上调用成员函数 isNew()

> ID：13278326
> 
> 赞同：0
> 
> 时间：2012-11-07T21:13:28.773
> 
> 标签：object, symfony-1.4, php, fatal-error

我在运行条件以查看这是否是新记录时遇到此致命错误，如果是，则在数据库中创建重复的草稿记录。

**动作类.php**

```
$this->form = new AlertsForm($active_alert);
    if ($request->isMethod('post')) {
      $this->form->bind($request->getParameter('alerts'), $request->getFiles('alerts'));
      if ($this->form->isValid()) {
        try {
          /* check if record is the draft version, and if not create one */

          if (!$active_alert->isNew() && !$active_alert['is_preview'] && 
              ($request->getParameter('button_type') != 'publish' || 
              !$this->getUser()->hasPublishingPrivilege())) {

            $active_alert = $active_alert->createDraft();
            $values = $request->getParameter('alerts');
            $values['id'] = $active_alert['id'];
            $this->form = new AlertsForm($active_alert);
            $this->form->bind($values, $request->getFiles('alerts'));

            $this->getUser()->setFlash('draft', true);
          } 
```

**错误：**

```
Fatal error: Call to a member function isNew() on a non-object in apps/cms/modules/alerts/actions/actions.class.php on line 35 
```

如果我在 var_dump 上运行`$active_alert`，它会返回：

> 布尔（假）

这段代码的旧工作版本是相同的，所以我不确定是不是这个确切的代码是错误的，我只是不知道在哪里看。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-08T04:50:54.213

致命错误是因为，正如错误消息所暗示的，没有 $active_alert，即它是一个非对象，而您正试图调用`isNew()`一个非对象。

你可以做的是`$active_alert`在检查它是否（不是）新的之前检查它的存在：

`if ($active_alert && !$active_alert->isNew() && !$active_alert['is_preview'] && ...`

# c# - 业务层外观与混合业务组件

> ID：13278329
> 
> 赞同：0
> 
> 时间：2012-11-07T21:13:36.837
> 
> 标签：c#, .net, asp.net-mvc, architecture, n-tier-architecture

我目前正在为大型应用程序设计基础。我们将使用传统的 3 层系统，在数据层使用 EF，在业务层使用纯 jane c# 类，在 ui 层使用 MVC/WCF。我们已经对应用程序进行了足够多的原型设计，以意识到这对我们有用，但是由于业务需求的复杂性，**一些业务组件相互交互是很常见的。**

考虑以下两个业务组件：

*   RetailManager - 处理系统中与零售相关的一切
*   CartManager - 处理与购物车体验相关的一切

例如，在购买商品时的结账过程中，两者会进行交互。需要减少采购项目的库存。

到目前为止，这是我的思考过程：

1.  让业务组件相互引用并确保循环引用永远不会发生（CartManager 引用 RetailManager，但绝不会反过来）。“Checkout”是 CartManager 类的一个方法，它会调用 RetailManager 的一个方法来调整库存。虽然这会起作用，但我不确定它的扩展性如何，以及随着时间的推移维护成本会是多少。我觉得这不是 100%“正确”的。

2.  在业务组件和 UI 层之间创建一个 Facade。在本例中，Facade 将具有 checkout 方法和对两个管理器的引用。我比第一种方法更喜欢这种方法，但是我知道并非我的所有业务对象都需要 Facade，而且我不想创建大量 Facade 类只是为了让方法具有空传递。

我倾向于 2，但需要注意的是，我只会在需要的地方创建外观类。UI 层将可以访问 Facade 和业务层组件，并且必须知道何时使用哪个（我不喜欢这个解决方案的唯一部分）。

我做了很多研究，但还没有想出一个感觉完全正确的解决方案。

欢迎任何关于以这种方式使用外观模式的想法，或其他解决问题的想法。

提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-09T12:26:46.547

这是使用管理器/服务类的典型问题。他们总是容易臃肿。当你达到这一点时，最好开始使用命令。

使用 IoC 的好处是您不必直接重构所有代码，但可以在有时间的时候进行。只需开始为所有新功能编写命令，同时为其他所有内容保留旧架构。

这是命令介绍：http: [//blog.gauffin.org/2012/10/writing-decoupled-and-scalable-applications-2/](http://blog.gauffin.org/2012/10/writing-decoupled-and-scalable-applications-2/)

并介绍我自己的框架：http: [//blog.gauffin.org/2012/10/introducing-griffin-decoupled/](http://blog.gauffin.org/2012/10/introducing-griffin-decoupled/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-07T21:35:21.103

我倾向于使用外观实现。

我首先会问自己，在结账时确保减少库存是谁的责任？`CartManager`我认为减少库存不是责任。我会有一个第三类（在你的情况下是外观），它确保每当一个项目被 签出时`CartManager`，相应的项目就会从库存中减少。

我会考虑的另一个选择是基于事件的实现。每当签出项目时`CartManager`都会引发事件。将订阅此事件并在引发事件时减少库存。如果您不熟悉事件驱动设计，请在 quora 上关注此问题 - [http://www.quora.com/What-are-some-good-resources-on-event-driven-software-design](http://www.quora.com/What-are-some-good-resources-on-event-driven-software-design)`ItemCheckedOut``RetailManager`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-08T13:48:24.530

我个人喜欢[CQRS](http://martinfowler.com/bliki/CQRS.html)的模式，它自然地适合其他架构模式，例如[事件](http://martinfowler.com/eaaDev/EventSourcing.html)溯源，并且适合复杂的领域。

# mysql - 如何让 MySQL 将第二个表的查询结果存储在第一个表中？

> ID：13278330
> 
> 赞同：0
> 
> 时间：2012-11-07T21:13:35.573
> 
> 标签：mysql

我有一份商务中心的清单。有时数据录入的人并没有丢失城市名称等所有信息，但其余信息却是完整的。我有另一张邮政编码表。我希望能够对那些没有城市的地址进行邮政编码查找，并获得城市名称。我在 MySQL 中这样做。

我很难获得正确的 MySQL。不知道是语法问题还是MySQL的逻辑不对。这就是我所拥有的：

```
update centers city
set centers.city = (
select zipcode_types.primary_city
from centers, zipcode_types 
where centers.city="" and centers.zipcode=zip); 
```

这是我从上面的 MySQL 得到的错误：

```
ERROR 1093 (HY000): You can't specify target table 'city' for update in FROM clause 
```

我正在尝试做的是从 zipcode_types 表中找到城市名称并更新中心表中缺少的城市名称。感谢您的帮助，谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-07T21:21:34.783

您可以使用多表[更新语法](http://dev.mysql.com/doc/refman/5.5/en/update.html)：

```
update centers 
  inner join zipcode_types on zipcode_types.zip = centers.zipcode
set centers.city = zipcode_types.primary_city
where centers.city=''; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-07T21:40:01.907

尝试如下重写您的更新语句：

```
update centers set city=(select zipcode_types.primary_city from zipcode_types where enters.zipcode=zipcode_types.zip)
where centers.city='' 
```

如此 SQL Fiddle 页面所示：[http ://sqlfiddle.com/#!2/3f7b5/1](http://sqlfiddle.com/#!2/3f7b5/1)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-07T21:40:09.833

试一试：

```
UPDATE centers SET city = (
SELECT primary_city
FROM zipcode_types 
WHERE zipcode=city.zip) 
WHERE city IS null 
OR city =='''; 
```

# asp.net - 如何创建简单的 aspx 网页，它将在链接中向我发送参数

> ID：13278331
> 
> 赞同：0
> 
> 时间：2012-11-07T21:13:38.653
> 
> 标签：asp.net, vb.net, web-applications

我正在尝试在 asp 中从头开始做一些事情

我想得到类似下面的东西。从基本的硬编码值。

```
http://localhost:2478/Default.aspx?phone=905123456&order=123456 
```

之后我想在我的 SQLquery 变量中使用这个参数

我是 asp.net 和 vb 的新手，我正在学习。你能详细解释一下吗？任何帮助将不胜感激。

你能提供我可以从哪里开始的任何基本代码吗

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-08T01:27:40.520

根据您的最新评论：

```
<form method="get" action="default.aspx">
   <input type="text" name="phone" />
   <input type="text" name="order" />
   <input type="submit" value="submit" />
</form> 
```

关键点：

*   `method=get`（字段在 url 而不是正文中）
*   请注意，上面的表单没有`runat=server`（下面更多）-它是纯 HTML 页面上的纯 HTML 表单
*   在 ASP.Net Web 表单的上下文中，您可能会遇到问题，尤其是在使用时`Master Pages`（您不能嵌套表单，母版页是整个页面的容器）。
*   ASP.Net 表单做`POSTbacks` - 重新：`method=post`
*   只要不**嵌套**它们（在服务器端 ASP.Net 之外`form`），就可以在 ASP.Net 页面中使用/添加普通表单。
*   如果您别无选择（例如母版页），则必须在 POSTback 之后手动构造查询字符串，然后再构造`Response.Redirect`其他目标（手动添加查询字符串）。
*   还有其他非 ASP.Net-y 的方法 - 例如 javascript，但这是一个不同的故事

# sublimetext2 - 为特定语法更改 Sublime 2 中的注释字符

> ID：13278334
> 
> 赞同：2
> 
> 时间：2012-11-07T21:13:45.157
> 
> 标签：sublimetext2

当我点击 cmd-/ 时， Sublime 的 Haml 语法`//`用于注释。我想`-#`改用它。我怎么做？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-08T00:47:22.557

您在 ST2 中使用的是哪个 Haml 包？

看看这个包里面 ，把它`~/Library/Application Support/Sublime Text 2/Packages/Rails/Ruby Haml Comments.tmPreferences` 改成ie：`//``-#`

前

```
<string>TM_COMMENT_START</string>
<key>value</key>
<string>// </string> 
```

后

```
<string>TM_COMMENT_START</string>
<key>value</key>
<string>-# </string> 
```

如果您使用的是通过 ST2 包管理器提供的 HAML 包，则此方法有效

# tsql - 如果 ID/名称重复，请选择单个记录

> ID：13278337
> 
> 赞同：1
> 
> 时间：2012-11-07T21:13:52.950
> 
> 标签：tsql, select, duplicates

这似乎是一个非常简单的问题，但我现在似乎无法弄清楚......

这是我从当前存储过程中获取的数据的简化视图：

```
ID     Name         Class     Desc
---    -----        ------    -----
84     Calvin J.    2B
53     Fred D.      3B
53     Fred D.      ADJ       Change/Correction
47     Mary F.      3A
47     Mary F.      ADJ       New Product
09     Donald M.    ADJ       Cancelled
21     Richard G.   ADJ       Bad Debt
21     Richard G.   ADJ       Cancelled 
```

我需要修改我的程序，以便每个人只选择一条记录。如果一个人有调整，我只想选择有调整的记录，而忽略其他记录。基于上述，这是我试图返回的结果集：

```
ID     Name         Class     Desc
---    -----        ------    -----
84     Calvin J.    2B
53     Fred D.      ADJ       Change/Correction
47     Mary F.      ADJ       New Product
09     Donald M.    ADJ       Cancelled
21     Richard G.   ADJ       Cancelled 
```

请帮忙！

**更新**

我刚刚意识到这个查询还有一个额外的要求；如果有两项调整，一项描述为“坏账”，另一项描述为“已取消”，则需要选择描述为“已取消”的记录（参见上面的更新数据）。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-07T21:18:53.693

这应该可以解决问题：

```
SELECT ID, Name, Class, [Desc]
FROM (
  SELECT ID, Name, Class, [Desc],
         ROW_NUMBER() OVER(PARTITION BY ID
                           ORDER BY CASE WHEN Class = 'ADJ'
                                         THEN 0 ELSE 1 END) rn
  FROM Table1
) A
WHERE rn = 1 
```

它看起来比实际上更可怕。内部查询包含一个用 计算的额外列`ROW_NUMBER()`。这样做是对您的行进行编号，从 1 开始为每个不同的`ID`（在 中指定`PARTITION BY`）。`ORDER BY`告诉`ROW_NUMBER()`如何对行进行排序，是一个 case 语句，表示带有的行应该`Class = 'ADJ'`在所有其他行之前。然后在最后我们只抓取编号为 1 的行。结果是选择 ADJ 行，如果有一个`ID`，否则选择常规行。

**根据更新的要求进行编辑**
如果您有其他优先级标准，那么您可以将它们添加到 中`ORDER BY`，就像`ORDER BY`在常规查询中一样。通常只执行内部查询而不过滤到是很有帮助的，`rn = 1`这样您就可以准确地看到行号是如何分配的。

这是应满足您的新要求的更新查询：

```
SELECT ID, Name, Class, [Desc]
FROM (
  SELECT ID, Name, Class, [Desc],
         ROW_NUMBER() OVER(PARTITION BY ID
                           ORDER BY
                             CASE WHEN Class = 'ADJ'
                                  THEN 0 ELSE 1 END,
                             CASE WHEN [Desc] = 'Cancelled'
                                  THEN 0 ELSE 1 END) rn
  FROM Table1
) A
WHERE rn = 1 
```

[在这里查看它的实际应用。](http://sqlfiddle.com/#!3/71463/2)

# c++ - 如何存储双端独立

> ID：13278338
> 
> 赞同：3
> 
> 时间：2012-11-07T21:13:52.547
> 
> 标签：c++, endianness

尽管大端计算机的使用并不广泛，但我想以独立格式存储双精度数据类型。

对于 int，这真的很简单，因为位移使这非常方便。

```
int number;
int size=sizeof(number);
char bytes[size];

for (int i=0; i<size; ++i)
    bytes[size-1-i] = (number >> 8*i) & 0xFF; 
```

此代码片段以大端格式存储数字，尽管它正在运行的机器上。**双倍最优雅的方法**是什么？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-11-07T21:32:07.153

可移植性和考虑格式的最佳方法是分别序列化/反序列化尾数和指数。为此，您可以使用 frexp()/ldexp() 函数。

例如，要序列化：

```
int exp;
unsigned long long mant;

mant = (unsigned long long)(ULLONG_MAX * frexp(number, &exp));

// then serialize exp and mant. 
```

然后反序列化：

```
// deserialize to exp and mant.

double result = ldexp ((double)mant / ULLONG_MAX, exp); 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-11-07T21:39:47.557

优雅的做法是将字节顺序问题限制在尽可能小的范围内。那个狭窄的范围就是你的程序和外部世界之间的 I/O 边界。例如，将二进制数据发送到其他应用程序/从其他应用程序接收二进制数据的函数需要注意字节序问题，将二进制数据写入/从某个数据文件读取二进制数据的函数也是如此。让这些接口认识到表示问题。

让其他一切都幸福地忽略这个问题。在其他地方使用本地表示。将双精度浮点数表示为 a`double`而不是 8 字节数组，将 32 位整数表示为 an`int`或`int32_t`而不是 4 字节数组，等等。在整个代码中处理字节顺序问题会使您的代码臃肿、容易出错和难看。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-07T21:19:09.187

相同。任何数字对象，包括双精度对象，最终都是几个字节，这些字节根据字节顺序以特定顺序进行解释。因此，如果您恢复字节顺序，您将在反转字节序中获得完全相同的值。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-11-07T21:19:47.097

```
 char *src_data;
 char *dst_data;

 for (i=0;i<N*sizeof(double);i++) *dst_data++=src_data[i ^ mask];
 // where mask = 7, if native == low endian
 // mask = 0, if native = big_endian 
```

优雅之处在于`mask`它还处理短类型和整数类型：如果目标和源字节序不同，它的 sizeof(elem)-1 。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-11-07T22:01:21.350

不是很便携且违反标准，但是像这样：

```
std::array<unsigned char, 8> serialize_double( double const* d )
{
  std::array<unsigned char, 8> retval;
  char const* begin = reinterpret_cast<char const*>(d);
  char const* end = begin + sizeof(double);
  union 
  {
    uint8  i8s[8];
    uint16 i16s[4];
    uint32 i32s[2];
    uint64 i64s;
  } u;
  u.i64s = 0x0001020304050607ull; // one byte order
 //  u.i64s = 0x0706050403020100ull; // the other byte order

  for (size_t index = 0; index < 8; ++index)
  {
    retval[ u.i8s[index] ] = begin[index];
  }
  return retval;
} 
```

可以处理具有 8 位字符、8 字节双精度和任何疯狂的字节顺序的平台（例如，对于 64 位值，字中的大端序，但字之间的小端序）。

现在，这并没有涵盖与 64 位整数不同的双精度字节序。

一种更简单的方法可能是将您的 double 转换为 64 位无符号值，然后像其他任何 int 一样输出。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-11-08T16:32:09.477

```
void reverse_endian(double number, char (&bytes)[sizeof(double)])
{
    const int size=sizeof(number);
    memcpy(bytes, &number, size);
    for (int i=0; i<size/2; ++i)
        std::swap(bytes[i], bytes[size-i-1]);
} 
```

# html - 如何使用 css/html/js 制作灯光效果

> ID：13278342
> 
> 赞同：2
> 
> 时间：2012-11-07T21:14:03.390
> 
> 标签：html, css, lighting

我正在尝试为网页中的特定区域制作灯光效果。我想知道我应该使用什么技术来制作这种效果，如下面的网页。

那么，是否可以通过仅使用 css/html 来实现呢？如果没有，我还应该知道什么才能做到这一点？

![在此处输入图像描述](../Images/66e675f0e5ed32b070431e0b6c84ee38.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-07T21:51:33.200

如果您想为在页面上水平移动的光线设置动画，您可以从两张背景图像开始（一张作为完整的“点亮”图像，另一张作为具有 alpha 透明度的黑色阴影图像，让完全点亮的图像透过）。

将全光照图像作为`background-image:`元素`<html>`，将阴影图像作为`background-image:`标签`<body>`。

然后，您可以通过更改阴影图像的背景图像位置来“动画化”。您还可以通过在移动阴影时移动“全亮”图像来添加很酷的视差 (http://stephband.info/jparallax/) 效果。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-07T21:18:49.830

我不确定这可以通过 CSS3/HTML5 作为“光”效果来完成 - 您可能能够实现它，但是使用一端为黑色，另一端为不透明黑色的渐变，覆盖在完全 ' lit' 版本的照片。

我假设您正在尝试使用 CSS 来执行此操作，因为“点亮”的图像会动态变化？如果是这样，我会在 Illustrator 中创建一个透明的 PNG，并在其下方显示您的图像（使用 CSS 绝对定位很容易完成）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-07T21:26:50.940

我知道查看过使用 jquery 库的人。我不确定它是否满足您的需求，但您可以看看。看看[http://www.tonylea.com/2011/jquery-illuminate/](http://www.tonylea.com/2011/jquery-illuminate/)

# ajax - 如何在 cakephp 2.x 中使用 ajax 发送参数和更新元素

> ID：13278348
> 
> 赞同：1
> 
> 时间：2012-11-07T21:14:26.103
> 
> 标签：ajax, cakephp

我有一个输入字段“#PostTitle”，用户可以在其中输入 URL。

我想将用户的输入（在更改或退出字段时）发送到我的 Posts 控制器中的一个操作，该操作返回一个数组。如果没有 CakePHP，我认为这看起来像这样：

```
$(document).ready(function(){
 $('#PostTitle').change(function(){
    $.ajax({
           type: 'POST',
           url: '/posts/setPostImages',  
           data: $(this).serialize(),
           success: function(data){
                do something;
           },
           error: function(message){
                console.debug(message);
           }
      });
 return false;
 });
}); 
```

Posts 控制器中的操作设置了一个名为 $imageArray 的链接数组（如果感兴趣，我会 CURL 页面并返回该页面上所有图像的数组）。

然后，在我提出请求后，我想更新一个依赖于该数组内容的元素。该元素包含以下代码：

```
<div id="slider-wrap" class="boxframe">
    <div class="coda-slider" id="slider-id">
     <?php foreach ($imageArray as $image): ?>
        <div class="crop">
        <?php echo $this->Html->image($image); ?>
        </div>
    <?php endforeach; ?>
    </div>
</div> 
```

任何帮助表示赞赏！

**编辑：**如果我尝试这个，则根本不会调用该操作：

```
echo $this->Js->link('update',
      array('action' => 'setPostImages'),
      array(
         'update' => '#selectImage',
         'data' => 'www.stackoverflow.com',
         'async' => true,    
         'dataExpression'=>true,
         'method' => 'POST'
      )
   ); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-08T02:02:12.770

如果你想用CakePHP生成这个JS，看看[JsHelper的事件方法](http://book.cakephp.org/2.0/en/core-libraries/helpers/js.html#JsHelper%3a%3aevent)和[请求方法](http://book.cakephp.org/2.0/en/core-libraries/helpers/js.html#JsHelper%3a%3arequest)

POST 请求命中的操作应该呈现您的元素并以 HTML 响应。JsHelper::request 然后将`update`用您的 HTML 替换参数指定的元素的内容。

就个人而言，我发现使用 PHP 框架生成 Javascript 相当迟钝。做你想做的事很快就会变得很困难。如果你甚至有适量的 Javascript，我建议直接编写它（你似乎已经知道如何做到这一点！）。

您的编辑指的是一个可能不同的问题。当您单击该片段生成的链接时，您在浏览器的控制台中遇到了什么样的 Javascript 错误？

# javascript - 使用 $.post 显示来自多个元素的数据

> ID：13278350
> 
> 赞同：0
> 
> 时间：2012-11-07T21:14:30.413
> 
> 标签：javascript, jquery, ajax, post

我有一个脚本可以回显最后一个丢弃的可放置元素，我想这样做，所以当最后一个元素被丢弃时，在最后一个被丢弃的元素之前丢弃的所有元素都会被回显。[这](http://jsfiddle.net/Kxtvg/248/)是脚本减去回显的视觉效果。以下是包含该问题的 javscript。

```
$('#dropbox, #dropbox1').droppable({
        accept: '.sort',
        hoverClass: 'border',
        tolerance: 'touch',
        drop: function(e, ui) {
    $(this).append(ui.draggable.html() + '<br/>');
            $("#add_friend").show().fadeOut(12000);
            $(e.target).droppable("disable");
            $(e.target).append("<input type='button' name='Sub' value='clear'/>").click(function() {
            $(this).empty().droppable("enable");
            });
        var dropbox = $('#dropbox').html();
        var dropbox1 = $('#dropbox1').html();

    if(dropbox && dropbox1 !== ''){
        $.post("account_main.php", 
          {data: $(this).text()}, 
          function(data) {
               //alert("Data saved.");
               $('#demo').html(data);
          });       
        }
        }
    }); 
```

我很确定`{data:$this.text()}`是问题所在，但是当最后一个可放置的元素被丢弃时，我对如何回显其他被丢弃的元素感到困惑。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-08T02:04:11.250

您能简单地回显保管箱的内容吗？

```
alert($('#dropbox1').text());
alert($('#dropbox2').text()); 
```

或者您是否试图按照它们被丢弃的顺序来呼应它们？

# data-structures - 这种类型的图表示矩阵叫什么？

> ID：13278352
> 
> 赞同：3
> 
> 时间：2012-11-07T21:14:39.963
> 
> 标签：data-structures, graph, adjacency-matrix

在几年前的算法课程中，我遇到了一个有趣的图形表示。它基本上是一个路径矩阵，但有额外的信息。每个单元格都包含（可能为空的）与您可以通过到达`Aij`的顶点相邻的列表。`i``j`

例如，有向图非正式地表示为：

(Z → X) (Z → Y) (X → W) (Y → W)

得到以下矩阵：
![在此处输入图像描述](../Images/7c03688452cad2e1206bc36413ddc825.png)
当维护这样的矩阵时，您不仅可以知道*是否*存在从`i`到的路径`j`，还可以*知道*所有可能的路径是什么。

但我终其一生都无法在网络上找到对这种表示的任何参考。它叫什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-21T03:16:09.833

我相信它被称为**邻接列表矩阵**。请参阅[http://www.dmi.usherb.ca/~hlaoui/th.pdf](http://www.dmi.usherb.ca/~hlaoui/th.pdf)或[在 Google Scholar 中搜索](http://scholar.google.com/scholar?q=%22adjacency+list+matrix%22)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-21T14:23:49.457

经过大量搜索和一位老老师的提示，我找到了维基百科文章中关于[Floyd-Warshall 算法的](http://en.wikipedia.org/wiki/Floyd_algorithm)[路径重建](http://en.wikipedia.org/wiki/Floyd_algorithm#Path_reconstruction)部分。他们将“下一个节点”存储在他们所谓的单元格之间的最短路径中：`i``j``Aij`

*下一个矩阵*

在一组似乎是我的同事的[幻灯片中，它被称为：](http://homepages.cwi.nl/~jve/courses/12/esslli12/GraphsAlgs.pdf)

*距离下一个表*

在相同的上下文中。当然，他们正在谈论仅存储最短路径的信息。当然，为此目的，每个单元只存储一个节点（-index）就足够了。这些来源都没有引用任何科学出版物。但是找了半天，我强烈觉得我原来的问题中的矩阵表示从来没有正式命名过。所以，我给你配音：

**路径下一个矩阵**

如果有人可以引用其他说法的科学出版物，我仍然很乐意接受他们的回答而不是我自己的回答。

# java - JSON数组字符串到Java中的JSONArray对象

> ID：13278354
> 
> 赞同：2
> 
> 时间：2012-11-07T21:14:55.057
> 
> 标签：java, parsing, arrays

我是 Java 中 JSON 操作的新手，我有一个 JSON 数组形式的字符串，我需要访问多个层并将其放入类属性中。例如，这是我的 JSON 对象：

```
{"JsonObject" : [{"attributeOne":"valueOne",
                  "attributeTwo":"valueTwo",
                  "attributeThree":[{"subAttributeOne":"subValueOne",
                                     "subAttributeTwo":"subValueTwo"}],
                  "attributeFour":[{"subAttributeOne":"subValueThree",
                                    "subAttributeTwo":"subValueFour"}],
                  "attributeFive":"valueThree"},
                 {"attributeOne":"valueFour",
                  "attributeTwo":"valueFive",
                  "attributeThree":[{"subAttributeOne":"subValueFive",
                                     "subAttributeTwo":"subValueSix"}],
                  "attributeFour":[{"subAttributeOne":"subValueSeven",
                                    "subAttributeTwo":"subValueEight"}],
                  "attributeFive":"valueSix"}]} 
```

假设我有一个名为 MyClass 的类，它具有这些属性，我将如何解析这个字符串，知道这是一个包含 n 个对象的数组，每个对象都包含“attributeOne、attributeTwo、...、attributeFive”？

这是我到目前为止所拥有的：

```
public MyClass[] jsonToJava (String jsonObj)
{
    ArrayList<MyClass> myClassArray = new ArrayList<MyClass>();

    //Somehow create a JSONArray from my jsonObj String
    JSONArray jsonArr = new JSONArray(jsonObj); //Don't know if this would be correct

    for(int i=0; i<jsonArr.length; i++){
        MyClass myClassObject = new MyClass();
        myClassObject.setAttributeOne = jsonArr[i].getString("attributeOne");
        // How can I access the subAttributeOne and Two under attributeThree and Four?
        // add all other values to myClassObject
        myClassArray.add(myClassObject);
    }
    return myClassArray;
} 
```

正如您可能知道的那样，我对编程相当陌生：P 在此先感谢您的帮助！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-07T21:32:22.317

试试杰克逊 JSON：

```
ObjectMapper mapper = new ObjectMapper(); // can reuse, share globally
User user = mapper.readValue(jsonObj, User.class); //method overloaded to take String 
```

从以下位置抓住了这两个班轮：

[http://wiki.fasterxml.com/JacksonInFiveMinutes](http://wiki.fasterxml.com/JacksonInFiveMinutes)

[http://jackson.codehaus.org/0.9.9/javadoc/org/codehaus/jackson/map/ObjectMapper.html](http://jackson.codehaus.org/0.9.9/javadoc/org/codehaus/jackson/map/ObjectMapper.html)

应该将您的 JSON 强转换为对象。在 Java EE 上下文中，您可以使用适当的注释在端点处获得此解组功能。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-07T21:23:00.660

你试图这样做的方式是痛苦的和参与的。

我建议您使用像 GSON 这样的库并让它完成繁重的工作。 [http://code.google.com/p/google-gson/](http://code.google.com/p/google-gson/)

该文档有对象示例：[https ://sites.google.com/site/gson/gson-user-guide#TOC-Object-Examples](https://sites.google.com/site/gson/gson-user-guide#TOC-Object-Examples)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-07T21:31:02.247

对于您的示例，您可以使用递归，例如：

```
 public Object getChild(Object parent, int index) { 

    if (parent instanceof JSONArray) {          

        try {
            Object o =  ( (JSONArray)parent ).get(index);

            if( o instanceof JSONObject ){
                parent =  ((JSONObject) ( o ) ).getMap();                   
                return parent;
            }

            if( o instanceof Double ){
                parent =  (Double) o;                   
                return parent;
            }

            if( o instanceof Integer ){
                parent =  (Integer) o;                  
                return parent;
            }
                            ....

        } catch (JSONException e1) {
            e1.printStackTrace();
        }       
    }

    if (parent instanceof JSONObject) {             
        parent = ( (JSONObject)parent ).getMap();
    }

    if (parent instanceof Map<?, ?>) { 
        Map<?, ?> map = (Map<?, ?>) parent; 
        Iterator<?> it = map.keySet().iterator(); 
        for (int i=0; i<index; i++){
            it.next(); 
        }

        return map.get(it.next()); 
    }
    else if (parent instanceof Collection<?>) { 
        Iterator<?> it = ((Collection<?>) parent).iterator(); 

        for (int i=0; i<index; i++){
            it.next();              
        }
        return it.next(); 
    } 
    //throw new IndexOutOfBoundsException("'" + parent + "'cannot have children!"); 
    return null;
} 
```

但它有点复杂（+不好的做法`instanceof`），你不想重新发明轮子。所以使用 GSON 或杰克逊。

```
 Gson gson =  new Gson();
 String myClassStr = gson.toGson(MyClassInstance);
 ....
  Myclass yourClass = gson.fromJson(myClassStr, Myclass.class); 
```

# websocket - 使用 Server-Sent 事件进行双向客户端-服务器通信（而不是 WebSockets）的缺点

> ID：13278365
> 
> 赞同：20
> 
> 时间：2012-11-07T21:16:01.990
> 
> 标签：websocket, real-time, server-push, server-sent-events

最近，我发现 Server-Sent 事件作为 WebSockets 的一种更简单的替代方案，用于从服务器进行推送。大多数比较它们的地方（如[这里](https://stackoverflow.com/questions/5195452/websockets-vs-server-sent-events-eventsource)、[这里](http://www.html5rocks.com/en/tutorials/eventsource/basics/)和[这里](http://www.html5rocks.com/en/tutorials/casestudies/sunlight_streamcongress/)）都说，如果您不需要客户端和服务器之间的全双工通信，那么 WebSockets 就过分了，而 SSE 就足够了。

我的问题是当您确实需要双向通信（例如聊天）时使用 SSE 的缺点是什么，使用常规 ajax 请求从客户端发送消息并使用服务器流接收它们？考虑到我几乎不需要在服务器端进行任何配置即可使用 SSE，这似乎是一个更具吸引力的选择。

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2012-11-08T13:16:07.830

SSE相对于 WebSockets 的**优势：**

*   无需特殊的 Web 服务器或 Web 代理更改。
*   定义自定义事件（否则客户端API基本相同）
*   更容易集成现有的身份验证机制（OAuth、OpenID 等）

与 WebSockets 相比，SSE的**缺点：**

*   单向通信通道（服务器到客户端）。客户端到服务器需要一个单独的通道。
*   浏览器支持更有限（不支持原生 IE，而 IE 10 支持 WebSockets）：[WebSockets](http://caniuse.com/#search=websockets)，[SSE](http://caniuse.com/#search=eventsource)
*   依赖客户端验证来源（可能比 WebSocket 更容易受到 XSS 攻击）
*   不支持二进制类型（WebSockets 支持使用 ArrayBuffers 和 Blobs 的原始帧）。
*   即使 SSE 端点不提供静态 Web 内容，也需要一个成熟的 Web 服务器（独立的 WebSocket 服务器可能相当简单）
*   与使用 WebSocket 连接相比，使用 AJAX 进行双向通信的 SSE 将具有更高的往返延迟和更高的客户端->服务器带宽。这是由于每个客户端->服务器 AJAX 请求的连接设置开销。此外，服务器->客户端延迟可能会在 SSE 中出现峰值，因为在许多配置中，长期保持的连接最终将关闭（通常每 30 秒一次）并且需要重新打开，从而导致服务器->客户端延迟的临时峰值.

参考：

*   [http://www.html5rocks.com/en/tutorials/eventsource/basics/](http://www.html5rocks.com/en/tutorials/eventsource/basics/)
*   [https://developer.mozilla.org/en-US/docs/Server-sent_events](https://developer.mozilla.org/en-US/docs/Server-sent_events)
*   [https://developer.mozilla.org/en-US/docs/Server-sent_events/Using_server-sent_events](https://developer.mozilla.org/en-US/docs/Server-sent_events/Using_server-sent_events)
*   [http://dev.w3.org/html5/eventsource/](http://dev.w3.org/html5/eventsource/)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-07T21:40:35.247

与小的 WebSocket 消息相比，Ajax 请求是巨大的。标准 HTTP 请求 (Ajax) 包含大量标头，包括每个请求的 cookie，而 WebSocket 消息只有几个字节。

HTTP (Ajax) 请求的好处是，如果这对您的问题有益，那么它们更容易缓存。

# php - 谷歌地图信息窗口通过xml的多个地址

> ID：13278368
> 
> 赞同：2
> 
> 时间：2012-11-07T21:16:11.333
> 
> 标签：php, xml, google-maps-api-3, infowindow

我正在使用下面的 Google 地图代码从使用 PHP 动态创建的 XML 文件中检索和绘制多个地址的标记。除了在谷歌地图信息窗口中显示相应标记的正确信息外，该代码正在做我需要的一切。我得到了所有标记的最后一个 XML 项目/列表的信息。

我一直在寻找并尝试不同的变化来让它工作，但没有运气。

样本 XML 数据

```
<?xml version="1.0" encoding="UTF-8"?>
<listings>
<listing>
    <address>123 Street</address>
    <city>MANOTICK</city>
</listing>
<listing>
    <address>456 Street</address>
    <city>MANOTICK</city>
</listing>
<listing>
    <address>111 Avenue</address>
    <city>MANOTICK</city>
</listing>
<listing>
    <address>777 Avenue</address>
    <city>Ottawa</city>
</listing>
<listing>
    <address>333 Street</address>
    <city>Manotick</city>
</listing>
</listings> 
```

谷歌地图代码

```
function initialize ()
{
    var myLatLng = new google.maps.LatLng(45.2340684, -75.6287287);
    var myOptions =
    {
        zoom: 10,
        mapTypeControl: true,
        center: myLatLng,
        zoomControl: true,
        zoomControlOptions:
        {
            style: google.maps.ZoomControlStyle.SMALL
        },
        StreetViewControl: false,
        mapTypeId: google.maps.MapTypeId.ROADMAP
    }
    var map = new google.maps.Map(document.getElementById('google_map'), myOptions);
    var info_window = new google.maps.InfoWindow;
    google.maps.event.addListener
    (map, 'click',
    function ()
    {
        info_window.close();
    });

    downloadUrl
    ('listings.xml',
    function (listings_data)
    {
        var markers = listings_data.documentElement.getElementsByTagName('listing');
        var geocoder = new google.maps.Geocoder();
        for (var i = 0; i < markers.length; i++)
        {
            var address = markers[i].getElementsByTagName('address')[0].firstChild.data;
            var city = markers[i].getElementsByTagName('city')[0].firstChild.data;
            var address_google_map = address + ', ' + city + ', ON';
            var info_text = address + '<br />' + city + ' ON';

            geocoder.geocode
            ({'address': address_google_map},
            function (results)
            {
                    var marker = new google.maps.Marker
                    ({
                        map: map, 
                        position: results[0].geometry.location
                    });
                    google.maps.event.addListener
                    (marker, 'click',
                    function()
                    {
                        info_window.setContent(info_text);
                        info_window.open(map, marker);
                    });
            });
        }
    });
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-07T22:06:34.807

您对地理编码器的异步性质有疑问，如果您添加许多地址，您将遇到地理编码器配额/速率限制的问题（特别是因为您的代码不查看地理编码器的返回状态）。

所有这些问题都是相关的：

*   [Google Maps Api v3：信息窗口显示地图上所有标记的相同信息](https://stackoverflow.com/questions/4236522/google-maps-api-v3-info-window-displaying-same-information-for-all-the-markers)
*   [GMaps API V3 - 多个标记和信息窗口](https://stackoverflow.com/questions/6866028/gmaps-api-v3-multiple-markers-infowindow-problem)
*   [谷歌地图多个信息窗口不起作用](https://stackoverflow.com/questions/12148783/google-map-multiple-inforwindow-does-not-work)

最简单的解决方案是使用函数闭包将地理编码器的调用与返回的结果相关联：

```
geocodeAddress(xmldata)
{
        var address = xmldata.getElementsByTagName('address')[0].firstChild.data;
        var city = xmldata.getElementsByTagName('city')[0].firstChild.data;
        var address_google_map = address + ', ' + city + ', ON';
        var info_text = address + '<br />' + city + ' ON';

        geocoder.geocode
        ({'address': address_google_map},
        function (results, status)
        {
          if (status == google.maps.GeocoderStatus.OK) {
            createMarker(results[0].geometry.location, info_text);
          } else { 
            alert("geocode of "+ address +" failed:"+status);
          }
        });
    } 
```

还有一个 createMarker 函数将信息窗口内容与标记相关联：

```
function createMarker(latlng, html)
{
  var marker = new google.maps.Marker
                ({
                    map: map, 
                    position: latlng
                });
  google.maps.event.addListener(marker, 'click', function() {
                    info_window.setContent(html);
                    info_window.open(map, marker);
                });
} 
```

使您的 for 循环：

```
for (var i = 0; i < markers.length; i++)
{
  geocodeAddress(markers[i]);
} 
```

[工作示例](http://www.geocodezip.com/v3_SO_multipleGeocodedMarkersFromXml.html)

# angularjs - Angularjs过滤器被否定

> ID：13278371
> 
> 赞同：22
> 
> 时间：2012-11-07T21:16:22.940
> 
> 标签：angularjs

我有一组项目，我想在 ng-repeat 中使用 ng-model 作为字符串来过滤集合，到目前为止我还没有找到一种方法让它在表达式被否定时工作，我是做这样的事情：

```
<select ng-model="languageOrigin" ng-change="updatePrice()">
             <option ng-repeat="language in languages">{{language}}</option>
</select>
<select ng-model="languageDestination" ng-change="updatePrice()">
            <option ng-repeat="language in languages | filter:!languageOrigin">{{language}}</option>
</select> 
```

在[文档](http://docs.angularjs.org/api/ng.filter%3afilter)中，它说我们应该使用！否定表达式，但仍然没有运气。

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：43
> 
> 时间：2012-11-19T09:08:36.670

'！' 过滤器字符串前面的字符，如下所示：

> 过滤器：'！'+语言来源

```
<select ng-model="languageOrigin" ng-change="updatePrice()">
  <option ng-repeat="language in languages">{{language}}</option>
</select>
<select ng-model="languageDestination" ng-change="updatePrice()">
  <option ng-repeat="language in languages | filter:'!'+languageOrigin">{{language}}</option>
</select> 
```

* * *

## 回答 #2

> 赞同：25
> 
> 时间：2013-10-01T09:47:52.837

如果使用对象，您可能还对以下内容感兴趣：

```
<li data-ng-repeat="obj in objs | filter:({obj_attr: '!obj_val'})">
   ...
</li> 
```

在 AngularJS 1.1.5 中测试。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-11-07T23:05:55.573

**更新**：见 ENDOH takanao 的回答。

查看 AngularJS[源代码](https://github.com/angular/angular.js/blob/master/src/ng/filter/filter.js#L95)，~~似乎是“！” 否定谓词的结果，而不是谓词本身~~：

```
var search = function(obj, text){
    if (text.charAt(0) === '!') {
       return !search(obj, text.substr(1));
    }
    switch (typeof obj) {
    ... 
```

~~因此，解决此问题的一种方法是~~[如果您不喜欢 '!'+myFilter 语法，] 您可以在控制器中定义自己的谓词函数：

```
$scope.inverseOriginFilter = function(item) {
    return item.search($scope.languageOrigin) == -1
} 
```

然后在您的 HTML 中使用它：

```
<select ng-model="languageDestination" ng-change="updatePrice()" 
    ng-options="language for language in languages | filter:inverseOriginFilter">
</select> 
```

示例[小提琴](http://jsfiddle.net/mrajcok/3eGGF/)。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2015-03-16T23:55:41.163

如果您使用一种方法进行过滤，而不是在方法名称前加上“！” 不管用。相反，您可以执行以下操作：

```
// You can register this in your AppCtrl if you like, otherwise just use $scope.
$rootScope.not = function(func) {
    return function (item) { 
        return !func(item); 
    }
}; 
```

然后你做：

```
filter:not(myFilterMethod) 
```

在您的 html 中，它看起来像：

```
<select ng-model="languageDestination" ng-change="updatePrice()">
  <option ng-repeat="language in languages | filter:not(languageOrigin)">{{language}}</option>
</select> 
```

参考： [https ://stackoverflow.com/a/17811582/175830](https://stackoverflow.com/a/17811582/175830)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2015-06-12T11:44:44.290

我正在使用 1.3.15 并且[ENDOH 的](https://stackoverflow.com/a/13450568/2406748)解决方案不起作用。相反，`filter:'!':languageOrigin`为我工作。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2020-01-21T12:38:50.110

为了完全否定 $filter 过滤器，我添加了这个过滤器：

```
.filter('$nfilter', ['$filter', function($filter) {
    return function() {
        var itemsToExclude = $filter('filter').apply(null, arguments);
        return arguments[0].filter(x => !itemsToExclude.includes(x));
    }
}]) 
```

在模板中，我们可以写：

```
<ui-select-choices repeat="type.id as type in data.types | $nfilter:{id: form.typeId}:true | filter: {label: $select.search}">
    <div ng-bind-html="type.label | highlight: $select.search"></div>
</ui-select-choices> 
```

# sql - SQL中的计算模式

> ID：13278372
> 
> 赞同：7
> 
> 时间：2012-11-07T21:16:30.437
> 
> 标签：sql, mode

我已经从以前的帖子中看到了答案，它工作正常，但我有一个小困境。采取同样的场景：

列出每个班级学生成绩的表格。我想要一个看起来像这样的结果集：

```
BIO...B 
CHEM...C 
```

其中“B”和“C”是班级的模式，想要获得班级的模式。

应用以下查询后，我得到以下输出：

```
Class | Score | Freq  |  Ranking 
2010  |   B   | 8     |    1 
2010  |   C   | 8     |    1 
2011  |   A   | 10    |    1 
2012  |   B   | 11    |    1 
```

2010年，我有两个频率相同的年级。如果..我只想显示最高分，在这种情况下将是“B”。我怎样才能做到这一点？我需要为字母等级分配排名，但我不确定如何。请指教。谢谢。

上一篇： [SQL Server 模式 SQL](https://stackoverflow.com/questions/2045075/sql-server-mode-sql)

我用来检索数据的查询是彼得的答案：

```
;WITH Ranked AS ( 
SELECT 
    ClassName, Grade 
    , GradeFreq = COUNT(*) 
    , Ranking = DENSE_RANK() OVER (PARTITION BY ClassName ORDER BY COUNT(*) DESC) 
FROM Scores 
GROUP BY ClassName, Grade 
) 
SELECT * FROM Ranked WHERE Ranking = 1 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-11-07T21:20:23.870

改变：

```
SELECT * FROM Ranked WHERE Ranking = 1 
```

至：

```
SELECT Class, MIN(Grade) AS HighestGrade, Freq, Ranking
FROM Ranked
WHERE Ranking = 1
GROUP BY Class, Freq, Ranking 
```

# windows - 在现代 Windows 上绘制 HWND 的最快方法是什么？

> ID：13278373
> 
> 赞同：6
> 
> 时间：2012-11-07T21:16:32.340
> 
> 标签：windows, drawing, 2d, pixels

当我最后一次这样做时，您会使用 DirectDraw 来 blit 到硬件表面，甚至直接映射它并直接绘制。

今天推荐的方法是什么？使用 Direct3D 10/11 并做同样的事情？

编辑：为了澄清我的问题，我想做一些软件光栅化，因此需要一种快速的方法将像素数据直接传输到显示器。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-19T22:22:39.303

I would suggest to use [Direct2D](http://msdn.microsoft.com/en-us/library/windows/desktop/dd370990.aspx) which is meant for desktop applications these days. Quote:

> **Purpose**
> 
> Direct2D is a hardware-accelerated, immediate-mode, 2-D graphics API that provides high performance and high-quality rendering for 2-D geometry, bitmaps, and text. The Direct2D API is designed to interoperate well with GDI, GDI+, and Direct3D.

Requirements: Vista and higher as well as the respective server versions (if that is needed).

# android - Android SQLite Select 查询速度

> ID：13278376
> 
> 赞同：3
> 
> 时间：2012-11-07T21:16:39.453
> 
> 标签：android, sqlite, optimization, select

我想帮助加快我的`SQLite`数据库中一个相当简单的选择查询。

该查询正在搜索大约 6500 行的表，并且当前在大约 600 毫秒内返回。我不知道这是否可以接受，但我希望它会比这更快。我最终会把它放进去`AsyncTask`，但想尽可能地优化。在下面的代码片段中，您可以看到我尝试过的内容。
KEY_songPath 已编入索引。

```
public ArrayList<Song> getCurrentDirSongs(String currentDir) {
long startTime = System.currentTimeMillis();
ArrayList<Song> songsList = new ArrayList<Song>();

String selectQuery = "";
int strLength = currentDir.length();
    //selectQuery = "SELECT  * FROM " + TABLE_SONGS + " WHERE (" + KEY_songPath + " >= '" + currentDir + "')";
    //selectQuery = "SELECT  * FROM " + TABLE_SONGS + " WHERE (" + KEY_songPath + " GLOB '" + currentDir + "*')";
    //selectQuery = "SELECT  * FROM " + TABLE_SONGS + " WHERE (" + KEY_songPath + " LIKE '" + currentDir + "%')";
    selectQuery = "SELECT  * FROM " + TABLE_SONGS + " WHERE " + KEY_ID +
                    " IN (SELECT " + KEY_ID +" FROM "+ TABLE_SONGS + " WHERE length(" + KEY_songPath + ")>= "+ strLength +") AND " + 
                    "(" + KEY_songPath + " LIKE '" + currentDir + "%')";

SQLiteDatabase db = this.getReadableDatabase();

Cursor cursor = db.rawQuery(selectQuery, null);

// looping through all rows and adding to list
if (cursor.moveToFirst()) {
    do {
        Song song = new Song();
        song.setSongTitle(cursor.getString(1));
        song.setSongPath(cursor.getString(2));
        song.setSongArtist(cursor.getString(3));
        song.setSongAlbum(cursor.getString(4));
        song.setTrackNumber(cursor.getString(5));
        song.setID(Integer.parseInt(cursor.getString(6)));
        song.setAlbumID(Integer.parseInt(cursor.getString(7)));
        song.setArtistID(Integer.parseInt(cursor.getString(8)));
        song.setSongCheckedStatus(Boolean.parseBoolean(cursor.getString(9)));
        song.setSongPosition(Integer.parseInt(cursor.getString(10)));
        song.setSongDuration(Integer.parseInt(cursor.getString(11)));
        // Adding song to list
        songsList.add(song);
    } while (cursor.moveToNext());
}
long estimatedTime = System.currentTimeMillis() - startTime;
Log.d("AMCDatabase Database Handler: ", "SongsList.size(): "+ getSongsCount("SongsList") + " Time: " + estimatedTime + "ms");
// return contact list
return songsList; 
```

}

这返回了以下结果： SongsList.size(): 6390 Time: 588ms

任何帮助都感激不尽！

PS 这可能都不是问题 - 可以接受一秒钟的时间查询和 6000 个值`ArrayList`吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-08T08:00:19.790

不要使用子查询；它并没有使任何事情变得更快，因为它仍然必须进行相同的检查。

不要使用`LENGTH(column) >= value`，因为它不比`LIKE`检查快，并且不能被索引。

为了加快，在列`LIKE`上放置一个索引。`KEY_ID`因为`LIKE`默认情况下不区分大小写，所以必须`COLLATE NOCASE`在创建索引时使用（参见[CREATE INDEX 文档](http://www.sqlite.org/lang_createindex.html)）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-07T21:17:56.317

尽量不要使用嵌套`SELECT`语句，而是看看你是否可以使用`JOIN`.

例子：

```
SELECT * FROM Songs AS s1 JOIN Songs AS s2 ON s1.KEY_ID = s2.KEY_ID WHERE length (s2.KEY_SONGPATH) >= " + strLength + ") AND s1.KEY_SONGPATH LIKE '" + currentDir + "%' 
```

# google-apps-script - 使用谷歌应用脚 本保护单元格（使用动态按钮或命令）

> ID：13278382
> 
> 赞同：3
> 
> 时间：2012-11-07T21:17:27.473
> 
> 标签：google-apps-script, google-sheets

有谁知道是否可以为谷歌电子表格制作一个谷歌应用脚​​本，如果发生特定情况，它可以保护特定的单元格？外汇。如果 X 出现在“A1”中，那么“A2”应该受到保护吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-08T02:17:35.843

它不是。我不相信这是细胞保护的工作方式。一个单元被手动保护，或者根本没有保护。

没有启用该功能的单元函数或脚本对象。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-08T09:44:34.743

目前还没有用于管理单元保护的 API。此[功能请求](http://code.google.com/p/google-apps-script-issues/issues/detail?id=1721)要求这样做。您可能希望为它加注*星*标以跟踪更新并为它投票。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2018-05-17T12:58:06.997

[Henrique G. Abreu 提到](https://stackoverflow.com/a/13286398/1595451)的“功能请求”已修复。参考[评论#165](https://issuetracker.google.com/issues/36756264#comment165)

> 今天，我们推出了使用 Apps 脚本以编程方式创建和操作受保护范围和受保护工作表的功能。
> 
> 借助电子表格服务中的新保护类，您的脚本可以触及范围或工作表保护的各个方面，就像在新 UI 中一样。（旧的 PageProtection 类具有更多有限的功能，将被弃用，但会继续使用，以防您需要使用旧电子表格。新的保护类仅适用于较新版本的表格。）
> 
> 您可以在此处找到更多详细信息：
> 
> [http://googledevelopers.blogspot.com/2015/02/control-protected-ranges-and-sheets-in.html](http://googledevelopers.blogspot.com/2015/02/control-protected-ranges-and-sheets-in.html)
> 
> [https://developers.google.com/apps-script/releases/#february_2015](https://developers.google.com/apps-script/releases/#february_2015)
> 
> [https://developers.google.com/apps-script/reference/spreadsheet/protection](https://developers.google.com/apps-script/reference/spreadsheet/protection)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-12-16T09:18:42.923

我知道这是一个老问题，但谷歌“feture request”（由 Henrique Abreu 发布）直到现在（2014 年底）还没有进展

**我的预感：**当用户被要求编辑之后被锁定的单元格（通过标准或另一种逻辑）时，这种功能将是谷歌表单（[http://www.google.com/forms/about ）的一种解决方法](http://www.google.com/forms/about)

我最近在我的工作场所遇到了类似的情况，我的解决方案非常简单——制作一个表格并与相关用户分享。表单域将使用户能够填写他们应该被锁定的数据。该表格最终会生成一张信息表（每次填写表格时都会在线更新）。使用另一个工作表中的“ **IMPORTRANGE** ”（[https://support.google.com/docs/answer/3093340?hl=en](https://support.google.com/docs/answer/3093340?hl=en)）将导致查询相关工作表中的“锁定”信息。因为数据在另一张纸内并表示为公式 - 它不能被编辑（至少不能作为数据）

我真的在考虑一个真正的解决方法，它实际上可以“锁定”一个单元格（通过脚本将其值替换为原始值）..如果有这样的请求

* * *

## 回答 #5

> 赞同：-2
> 
> 时间：2012-11-08T21:12:15.603

我有一个解决方法，代码如下

```
function protect_named_range(){
  var ss = SpreadsheetApp.getActiveSpreadsheet();
  var target_sheet = ss.getSheetByName('Sheet1');//change "sheet1" for the sheet your range is in
  var array_range1 = target_sheet.getRange("A1:A1");
  var array_range2 = target_sheet.getRange("A2:A2");
  var range_test = array_range1.getValue();// or getFormula or what ever you want to test
  if(range_test == "correct answer"){ //if cell A2 = "correct answer" then cell B2 becomes a named range called "named_range"       
    ss.setNamedRange("named_range", array_range2);
   SpreadsheetApp.setActiveSheet(target_sheet);
   var sheet = SpreadsheetApp.getActiveSheet();
   var permissions = sheet.getSheetProtection();
   permissions.setProtected(true);
   target_sheet.setSheetProtection(permissions);
  }
 } 
```

对不起，我已经离开一段时间了。这是我将使用的基本代码，但是如果单元格 A2 =“正确答案”，它实际上并不保护范围“B2”。相反，如果单元格 A2 =“正确答案”，它会保护名为“sheet1”的工作表，以便只有电子表格所有者可以编辑工作表上的任何内容。

我知道这不是你所追求的，但我希望它能有所帮助。

# html - 如何增加模板的宽度？

> ID：13278385
> 
> 赞同：-1
> 
> 时间：2012-11-07T21:17:45.273
> 
> 标签：html, css

我正在考虑增加模板的宽度。

网站：laptopsisland.com

这是网站宽度的css代码。

```
/**************** MAIN WIDTH *********************/
.wrapper { padding: 0; min-width:960px }              
.boxed-layout .wrapper  { width:1000px; background: #FFF; margin:0 auto; } 
.inner { width:960px; position:relative; margin:0 auto; /* main width */ }     
.responsive .inner { max-width:960px; width:auto; }
body.responsive.isMobile .wrapper { overflow:hidden; }       
/*************************************************/ 
```

[请在此处](http://laptopsisland.com/wp-content/themes/maya/style.css)找到完整的 CSS 代码。

谁能教我如何使用上面的 CSS 代码增加宽度？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-07T21:50:35.577

您网站的宽度目前受以下规范的限制：

```
.boxed-layout .bg-shadow { max-width: 1023px; }
.boxed-layout .wrapper { width: 1000px; } 
```

如果您增加这些，您的网站将变得更广泛。

# javascript - jQuery 之外的 $

> ID：13278386
> 
> 赞同：2
> 
> 时间：2012-11-07T21:17:54.673
> 
> 标签：javascript, jquery

这个应用程序[https://developer.mozilla.org/en-US/demos/detail/meet-me-there/launch](https://developer.mozilla.org/en-US/demos/detail/meet-me-there/launch)接受上传的照片，附加一个二维码，然后允许你分享它们。除了 QR 功能之外，我已在 JavaScript 下方附加了所有内容。该应用程序不使用 jQuery，但一开始它为 $ 分配了一个函数。

```
 window.onload = function(){
                    var $ = function(id){
                            console.log(id);
                            return document.getElementById(id);
                        }, 
```

当我在上面的位置使用console.log 运行应用程序时，它表明相当多的“id”正在通过该console.log(id)。文件加载时，它会记录“surface”、“cam”和“upload”，当您使用该应用程序时，它会记录“result”、“sharer”、“uploadedURL”和许多其他内容。问题是我看不到所有东西是如何通过console.log的那个函数传递的，以便在代码中记录不同的'id'。因此，我想知道'$' 在这种情况下的意义是什么（没有 jQuery）。具体来说，通过创建“$”函数，它是否会在任何其他带有 $ 的事件运行时调用，例如`$('upload').onclick = function(){...`

它的工作方式是否类似于通过在 jquery 中使用`$.prototype.function()`在 jquery 中添加原型的方式。如果是这样，如果没有 jQuery，它从哪里获得此功能。

```
window.onload = function(){
                var $ = function(id){
                        console.log(id);
                        return document.getElementById(id);
                    },
                    canvas = $('surface'),
                    ctx = canvas.getContext('2d'),
                    watcher, loc='No location provided', located;

                $('cam').onchange = function(event){
                    console.log(event);
                    console.trace();
                    var files = event.target.files,
                        file;

                    if (files && files.length > 0) {
                        file = files[0];
                        try {
                        var URL = window.URL || window.webkitURL || window.mozURL;
                        var imgURL = URL.createObjectURL(file);

                        var img = new Image();
                            img.id = "tester";

                        //Load it onto the canvas
                        img.onload = function() {
                            console.trace();

                            canvas.width = this.width;
                            canvas.height = this.height;
                            $('info').innerHTML = ("Width: " + this.width + "px, Height: " + this.height + "px");
                            $('result').width = 400;
                            $('result').height = (400 / (this.width/this.height)) >> 0;
                            ctx.drawImage(img, 0, 0, canvas.width, canvas.height);
                            var codeSize = (canvas.height/4) >> 0;
                            var imgn = new Image(); 
                            imgn.onload = function(){
                                ctx.drawImage(imgn, (canvas.width-5- codeSize), (canvas.height-5-codeSize), codeSize, codeSize);
                                $('result').src = canvas.toDataURL();
                            }
                            imgn.src = (QR.encode(loc, codeSize, 5));
                        }

                        img.src = imgURL;

                        } catch (e) {
                            console.log("error: " + e);
                        }
                    }
                },
                // borrowed this functionality from cgack's demo
                // https://developer.mozilla.org/en-US/demos/detail/snap-and-share 
                $('upload').onclick = function(){
                    $('infomsg').style.display = 'block';
                    var url = "http://api.imgur.com/2/upload.json",
                    params = new FormData(),
                    http = new XMLHttpRequest();

                    params.append('key','29a8b1db1d8fda0df87006def2307242');
                    params.append('image',canvas.toDataURL().split(',')[1]);

                    http.open("POST", url);
                     http.onload = function() {
                        var url = JSON.parse(http.responseText).upload.links.imgur_page;
                        $('uploadedUrl').href = url;
                        $('uploadedUrl').innerHTML = url;
                        $('shareFb').href = ("http://www.facebook.com/sharer.php?u="+url);
                        $('shareTwitter').href = ("http://twitter.com/intent/tweet?url="+url);
                        $('sharer').style.display = 'block';
                         $('infomsg').style.display = 'none';

                    };
                    http.send(params);
                    console.log(params);
                };
                watcher = navigator.geolocation.watchPosition(function(position){
                    console.trace();
                    console.log("navigator"); 
                    loc = "geo:" + position.coords.latitude + "," +position.coords.longitude;
                    located = true;
                }, function(error){
                    if(error.code == error.PERMISSION_DENIED || error.code == error.POSITION_UNAVAILABLE)
                        alert('damn, we were not able to locate you. sorry.');
                    }
                );
            }; 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-07T21:21:11.463

`$`只是一个变量名，就像任何其他的一样。它没有特别的意义。

> *“问题是我看不到所有东西是如何通过console.log函数传递的，以便在代码中记录'id'。”*

任何时候你看到`$`，它都是对函数的引用。所以 a `()`after 它使用给定的参数调用它。它就像任何其他函数一样，只是用一个有趣的名字来引用它。

> *“因此，我想知道'$'在这种情况下的意义（没有jQuery）。具体来说，通过创建'$'函数，它是否会在任何其他带有$的事件运行时调用”*

同样，没有真正的意义。它只是一个函数名。如果您重命名`$`to的所有实例`byId`，它的行为将相同。

```
window.onload = function(){
           //   var $ = function(id){
                var byId = function(id){
                        console.log(id);
                        return document.getElementById(id);
                    },
                    canvas = foo('surface'),
                    ctx = canvas.getContext('2d'),
                    watcher, loc='No location provided', located;

                byId('cam').onchange = function(event){
                   /* a bunch of code */
                },
                byId('upload').onclick = function(){
                   /* a bunch of code */
                };
                // rest of the code
            }; 
```

# javascript - 为什么 Firefox 不接受 -moz-transition 样式？

> ID：13278390
> 
> 赞同：0
> 
> 时间：2012-11-07T21:18:06.337
> 
> 标签：javascript, firefox, css

> **可能重复：**
> [如何使用 javascript 设置 CSS3 过渡？](https://stackoverflow.com/questions/8742249/how-to-set-css3-transition-using-javascript)

我尝试通过元素的对象将 CSS3 转换 css 属性添加到具有（本机）JavaScript`style`的元素，它在 Firefox 中不起作用，但在`webkit`浏览器中一切都很好。我的代码：

```
var actor_object = document.querySelectorAll("p");
actor_object.style["-moz-transition-property"] = "all" 
```

*请不要回答我可以做到这一点`MozTransitionProperty`，我知道这一点，但我需要这样做`-moz-`。*

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-07T21:40:30.500

1.  稳定的 Firefox 版本使用 W3C 标准的无前缀`transition-property`CSS 属性；
2.  你必须在 JS 样式中应用驼峰式 CSS 属性；
3.  您正在尝试将样式设置为 nodeList，这是[DOM QSA 方法](https://developer.mozilla.org/En/DOM/Document.querySelectorAll)返回的内容。您需要对其进行迭代。

对于跨浏览器解决方案，使用[jQuery](http://jquery.com/)会很简单：

```
$('p').css({transitionProperty: "all", transitionDuration: '2s'});​ 
```

[见小提琴](http://jsfiddle.net/2Lgfk/1/)

如果你想要一个纯 JS 解决方案，下面是测试支持的 CSS 属性的代码[`$.cssHooks`](http://api.jquery.com/jQuery.cssHooks/)：

```
function styleSupport(prop) {
    var vendorProp, supportedProp,

        // capitalize first character of the prop to test vendor prefix
        capProp = prop.charAt(0).toUpperCase() + prop.slice(1),
        prefixes = ["Moz", "Webkit", "O", "ms"],
        div = document.createElement("div");

    if (prop in div.style) {

        // browser supports standard CSS property name
        supportedProp = prop;
    } else {

        // otherwise test support for vendor-prefixed property names
        for (var i = 0; i < prefixes.length; i++) {
            vendorProp = prefixes[i] + capProp;
            if (vendorProp in div.style) {
                supportedProp = vendorProp;
                break;
            }
        }
    }

    // avoid memory leak in IE
    div = null;

    // add property to $.support so it can be accessed elsewhere
    //$.support[prop] = supportedProp;

    return supportedProp;
} 
```

然后就这样使用它：

```
(function() {
    var transitionProperty = styleSupport("transitionProperty");
    var transitionDuration = styleSupport("transitionDuration");

    var actor_object = document.querySelectorAll("p");
    for (var i = 0, l = actor_object.length; i < l; i++) {
        actor_object[i].style[transitionProperty] = "all";
        actor_object[i].style[transitionDuration] = "2s";
    }
}()); 
```

[**小提琴**](http://jsfiddle.net/gypty/1/)

# c++ - 更改#include 文件名以匹配大小写

> ID：13278391
> 
> 赞同：2
> 
> 时间：2012-11-07T21:18:09.257
> 
> 标签：c++, c, sed

我有一段 C/C++ 源代码，其中 #include 语句中的文件名与 *.h 文件不完全匹配。匹配正确，但不区分大小写。这是在 Windows 系统中出现的源文件类型。

我想更改所有源文件，以便所有`#include`语句都与它们引用的文件名完全匹配。

所有要更改的文件名都用引号引起来。

例子：

文件列表

```
File1.h
FILE2.H
file1.cpp 
```

文件1.cpp

```
#include "file1.h"
#include "file2.h" 
```

将 file1.cpp 更改为

```
#include "File1.h"
#include "FILE2.H" 
```

我想创建一个自动脚本来执行此更新。

我在下面列出了这个过程的各个步骤，但我似乎无法将这些部分组合在一起。

1.  创建所有 *.h 文件的列表，`ls *.h > include.lst`. 这将创建一个包含正确大小写的所有文件名的文件。
2.  使用文件名`include.lst`创建一个 sed 命令`'s/<filename>/<filename>/I'`，该命令执行不区分大小写的搜索并用正确大小写的文件名替换匹配项。我相信我只需更换一次，但添加全局 g 将处理多次发生。
3.  将此替换列表应用于目录中的所有文件。

我想要关于如何创建 sed 命令 2) 给定的建议`include.lst`。我想我可以处理剩下的。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-07T21:25:46.103

```
for hfile in $(find /header/dir -type f -iname '*.h'); do
    sed -i 's/#include "'$hfile'"/#include "'$hfile'"/gI' file1.cpp
done 
```

我希望我得到了正确的报价:)`-i`在申请之前尝试不使用。

您可以将调用包装`sed`在另一个循环中，如下所示：

```
for hfile in $(find /header/dir -type f -iname '*.h'); do
    for sfile in $(find /source/dir -type f -iname '*.cpp'); do
        sed -i 's/#include "'$hfile'"/#include "'$hfile'"/gI' "$sfile"
    done
done 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-07T21:56:08.550

1.  在脚本中使用`sed`，或使用 Perl 脚本：

    ```
    find . -name *.c -print0 | xargs -0 sed -i.bak -e "s/\#include\s\"\([^\"]+/)\"/\#include\s\"\L\1\"/" 
    ```

    `-i.bak`将文件备份到，`original_file_name.bak`所以如果你搞砸了，你不必担心

    此行将 C 文件中包含的所有标题更改为小写。

2.  Then you want to change all files names:

    ```
    find . -name *.h -print0 | xargs -0 rename 's/(*)/\L\1/' 
    ```

    This renames all header file to lower case.

This is for linux only. If you are using Windows, you might want to use Perl or Python script for all above.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-07T23:55:04.197

This might work for you (GNU sed):

```
sed 's|.*|s/^#include "&"$/#include "&"/i|' list_of_files | sed -i -f - *.{cpp,h} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-08T07:49:18.713

Thanks for all the details on lowercasing filenames and #include strings. However, my original question was to perform a literal replacement.

Below is the basic command and sed script that met my requirements.

`ls *.h *.H | sed -e "s/\([^\r\n]*\)/s\/\\\(\\\#include\\\s\\\"\\\)\1\\\"\/\\\1\1\\\"\/gi/g" >> sedcmd.txt`

1.  `ls *.h *.H` creates a list of files, one line at a time
2.  Pipe this list to sed.
3.  Search for the whole line, which is a filename. Put the whole line in group 1\. `s/\(^\r\n]*\)/`
4.  Replace the whole line, the filename, with the string `s/\(\#include\s"\)<filename>"/\1<filename>"/gi`

The string `#include<space>"` is placed in group 1\. The `i` in the `gi` states to do a case insensitive search. The `g` is the normal global search and replace.

Given a filename ACCESS.H and cancel.h, the output of the script is

```
s/\(\#include\s"\)ACCESS.H"/\1ACCESS.H"/gi
s/\(\#include\s"\)cancel.h"/\1cancel.h"/gi 
```

Finally, the sed command file can be used with the command

```
sed -i.bak -f sedcmd.txt *.cpp *.h 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2018-05-11T10:40:46.467

My solution doesn't fail for pathnames containing slashes (hopefully you don't contain `%` signs in your header paths).

It's also orders of magnitude faster (takes ~13 seconds on a few hundred files, as opposed to several minutes of waiting).

```
#!/bin/bash

shopt -s globstar failglob nocaseglob

# You should pushd to your include path-root.
pushd include/path/root
headers=( **/*.h )
popd
headers+=( *.h )    # My codebase has some extra header files in the project root.

echo ${#headers[*]} headers

# Separate each replacement with ;
regex=""
for header in "${headers[@]}"; do
   regex+=';s%#include "'"$header"'"%#include "'"$header"'"%gI'
done
regex="${regex:1}"

find . -type f -iname '*.cpp' -print0 | \
    xargs -0 sed -i "$regex" 
```

It's much faster to make sed run just once per file (with many ;-separated regexes).

# java - 按在文件夹中创建的顺序列出文件

> ID：13278399
> 
> 赞同：1
> 
> 时间：2012-11-07T21:18:37.240
> 
> 标签：java, file, io

> **可能重复：**
> [如何在 Java 目录中找到最后修改的文件？](https://stackoverflow.com/questions/2064694/how-do-i-find-the-last-modified-file-in-a-directory-in-java)

我正在尝试按照创建顺序从目录中检索文件。这已成为使用 Java 的问题。File 类中的 listFiles() 方法不保证返回文件的顺序。有没有其他方法可以按照在目录中创建的顺序来检索文件？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-07T21:21:28.140

您需要使用 a对`array of files`退回的商品进行排序`File.listFiles()``Comparator`[`File.lastModified`](http://docs.oracle.com/javase/6/docs/api/java/io/File.html#lastModified%28%29)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-07T21:24:24.703

不，它没有，但是[Arrays.sort](http://docs.oracle.com/javase/6/docs/api/java/util/Arrays.html)方法确实需要一个[Comparator](http://docs.oracle.com/javase/6/docs/api/java/util/Comparator.html)。我在下面为您定义了一个简单的方法，然后将您自己淘汰：

```
new Comparator<File>() {
public int compare(File m1, File  m2) {
    return m1.lastModified().compare(m2.lastModified());
}
}); 
```

希望这可以帮助...

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-07T21:24:14.127

创建一个`Set<File>`未排序的添加所有`File`s ( `unsorted.addAll(dir.listFiles()`) 然后，使用自定义比较器比较日期创建一个新的`TreeSet`using 。`Set<File> sorted=new TreeSet(Comparator<File> byDate)`

```
Comparator<File> byDate=new Comparator<File>() {

    @Override
    public int compare(File o1, File o2) {
        return new Date(o1.lastModified()).compareTo(new Date(o2.lastModified()));
    }
}; 
```

并做：

```
sorted.addAll(unsorted); 
```

新套装将按日期订购。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-07T21:29:16.617

正如你已经弄清楚`listFiles`不保证和订购。如[本问题](https://stackoverflow.com/questions/6885269/getting-date-time-of-creation-of-a-file)所述，您可以获取其属性以查找创建时间并使用[thia](https://stackoverflow.com/questions/203030/best-way-to-list-files-in-java-sorted-by-date-modified)之类的东西对其进行排序。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-11-07T21:31:04.563

如果您查看 Java API for [File](http://docs.oracle.com/javase/7/docs/api/java/io/File.html)，有一个名为`lastModified`. 如果您按该属性对文件进行排序，您应该得到您想要的。我很确定在创建文件后无法安排文件，因为每个实现都是特定于操作系统的。

因此，如果您像这样制作比较器：

```
public class FileComparator implements Comparator<File> {
  public int compare(File x, File y) {
    Long.compare(x.lastModified(), y.lastModified());
  }
} 
```

它可以像这样使用：

```
File file = new File("...");
List<File> files = Arrays.asList(file.listFiles());
Collections.sort(files, new FileComparator()); 
```

# python - 在 Python 中解析 log4j

> ID：13278405
> 
> 赞同：2
> 
> 时间：2012-11-07T21:18:55.757
> 
> 标签：python, parsing, log4j

我有一个日志文件（log4j xml-ish 格式），我试图从中提取信息并在我的 Python 模块中使用。我可以将此文件视为 XML 吗？我的直觉告诉我不...如果不是，解析数据的最佳方法是什么？以下是日志文件的一部分。该文件不包含您的标准文档类型或版本标头，这就是我说“xml-ish”的原因。

```
<log4j:event 
logger="com.hp.cp.elk.impl.subscriptions.AsyncSimpleSubscriptionManager"
timestamp="1352320517430" level="DEBUG" thread="Thread-77">
<log4j:message><![CDATA[Broadcasting signals to subscribers...]]></log4j:message>
</log4j:event>

<log4j:event logger="com.hp.cp.jdf.idp.queue.IDPJobProgressMonitor"
timestamp="1352320517430" level="DEBUG" thread="IDPJobProgressMonitorThread">
<log4j:message><![CDATA[[JDFQueueEntry[  -->  JDFAutoQueueEntry[  --> JDFElement[
--> <?xml version="1.0" encoding="UTF-8"?><QueueEntry 
xmlns="http://www.CIP4.org/JDFSchema_1_1"
DescriptiveName="H44E61-6.pdf" DeviceID="HPPRO1-SM1"
EndTime="2012-11-07T10:58:18-08:00" JobID="Default" Priority="50"
QueueEntryID="d5fbbe98a1194e0da573b51a0c8040fb" Status="Completed" 
SubmissionTime="2012-11-06T16:35:06-08:00">  <Comment AgentName="CIP4 JDF Writer 
Java" AgentVersion="1.4a BLD 63" ID="c_121106_163506894_000804" 
Name="JobSpec">WBG_4C_Flat_21up_BusCards_Duplex</Comment>
</QueueEntry>
] ] ]] queue entries changed.]]></log4j:message>
</log4j:event>

<log4j:event logger="com.hp.cp.jdf.idp.queue.IDPJobProgressMonitor" 
timestamp="1352320517430" level="DEBUG" thread="IDPJobProgressMonitorThread">
<log4j:message><![CDATA[no active queue entries changed.]]></log4j:message>
</log4j:event> 
```

抱歉代码乱七八糟，我只是想让大家对格式有所了解。无论如何，我目前只是想从`QueueEntryID="d5fbbe98a1194e0da573b51a0c8040fb"`任何建议中提取价值？谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-07T21:21:38.357

我想您可以使用标准的 XML 工具（如 DOM 或 SAX）来解析它。否则，玩得开心`re`or `htmllib`。

# html - 防止div被推到左边

> ID：13278411
> 
> 赞同：0
> 
> 时间：2012-11-07T21:19:20.810
> 
> 标签：html, css

我有两个 div，一个充当面板，第二个是地图视图（openlayers） 面板在开始时是隐藏的，只有单击才会显示。但是，当面板出现时，mapdiv 被推到右侧并与另一个 div 重叠。我该如何防止呢？

我基本上想要的是面板出现在地图的顶部。

这是我的代码：

```
<!-- TOOLBAR/PANEL -->
    <div class="waveCreatorPanel" style="visibility:hidden; display:none;">
        <ul>
            <li><a id="createWave_addStation"data-role="button">Station hinzuf&uuml;gen</a></li>
            <li><a id="createWave_addItem" data-role="button" disabled="disabled">Item hinzuf&uuml;gen</a></li>
            <li><a id="createWave_saveWave"data-role="button">Wave speichern</a></li>
        </ul>
    </div><!-- /footer -->

    <!-- MAP -->
    <div class="geosurfmap" id="map" data-role="content" style="z-index:1"></div> 
```

CSS：

```
.waveCreatorPanel {
    float:left;
}
 .geosurfmap {
    padding:25px;
    margin:25px;
    width:80%;
    float:left;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-07T21:21:40.897

其中一个或两个的绝对定位将明确解决这个问题

```
 <div class="panel" style="visibility:hidden; display:none; position:absolute; left:0px; top:0px;">
        <ul>
           //stuff here
        </ul>
    </div>

    <!-- MAP -->
    <div class="map" id="map" data-role="content" style="position:absolute; left:100px; top:100px;"></div> 
```

样式可以通过附加的 css 样式表或内联应用 - 因为您的 div 中已经有样式属性，所以我刚刚添加了一个如何设置绝对值的示例 - 将左侧和顶部调整到您实际想要的位置

当您最初拥有时`visibility:hidden; display:none;`，将另一个 div 定位为 relative ，周围没有任何东西。它与实际上在 HTML 中根本没有它一样，然后当它变为可见时，必须调整相对定位的所有内容，绝对定位将解决此问题

另一件事：你的标题说“父 div” - 这不是正在移动的 div 的父 div，它实际上是相邻的。如果它实际上是父母，你就不会遇到这个问题。但是又一次，父级以隐藏的方式开始，因此其中的所有内容都将被隐藏

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-07T21:22:02.117

您可以将地图和面板 div 包装在另一个 div 中，并给出所需的最小宽度（面板 div 是否可见）。其次，您会将地图 div 向右浮动

```
<div id="wrapper">
    <div class="panel"></div>
    <div class="map"</div>
</div>

<style>

#wrapper {
  min-width: 500px;
}

#wrapper .panel {
  position:relative;
  float: left
}

#wrapper .map {
  position: relative;
  float:right;
}
</style> 
```

**编辑** 为了澄清我的观点，我为您做了一个[小提琴](http://jsfiddle.net/bvafR/13/)您可以将面板类设置为 display:none 或 block 以查看地图 div 现在不再因此而移位

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-07T21:22:32.397

一些可能的解决方案取决于您页面的其余部分： `position:absolute` `z-index`

# codeigniter-2 - Grocery_Crud 不可见。需要了解如何设置文件管理器

> ID：13278412
> 
> 赞同：2
> 
> 时间：2012-11-07T21:19:21.303
> 
> 标签：codeigniter-2, grocery-crud

我无法理解如何将grocery_CRUD 放入视图中。

我控制中的函数如下所示：

```
function folio()
{
$crud = new grocery_CRUD();
$crud->set_table('rfid');
$crud->columns('rfid','timestamp');
$data['output'] = $crud->render();      
$data['title'] = 'Control Escolar - Folio';
$this->db->where('id', $this->uri->segment(3));
$data['query'] = $this->db->get('alumnos');
$this->load->view('folio_view', $data);
} 
```

我的视图文件中的代码如下所示。

```
 <?php foreach($query->result() as $row) { ?>
    Datos Vitales - <B>Status:</b> <?=$row->status?><hr>
    <B>Nombre:</b> <?=$row->nombre?> <B>Fecha de Nac:</B> <?=$row->fecha_nac?></br>
    <B>Edad:</b> <?=$row->edad?> <B>Sexo:</B> <?=$row->sexo?> <B>Lugar de Nac:</B> <?=$row->lugar_nac?>
    <B>Nacionalidad:</B> <?=$row->nacionalidad?><br><br>
    Datos Escolar<hr>
    <B>Folio:</b> <?=$row->folio?> <B>Grado:</b> <?=$row->grado?> <B>Grupo:</b> <?=$row->grupo?> <B>Turno:</b> <?=$row->turno?> <B>RFID:</b> <?=$row->rfid?><br><br>
    Datos Generales<hr>
    <B>Domicilio:</b> <?=$row->domicilio?> <B>Colonia:</b> <?=$row->colonia?> <B>Codigo Postal:</b> <?=$row->cpostal?></br>
    <B>Telefono Particular:</b> <?=$row->telepart?> <B>Municipio:</b> <?=$row->municipio?></br>
    <B>Telefono de Emergencia:</b> <?=$row->tele_emer?> <B>Tutor:</b> <?=$row->tutor?><br><br>
    Datos Medicos<hr>
    <B>Tipo de Sangre:</b> <?=$row->tipo_de_sangre?></br>
    <B>Condiciones Conocidas:</b> <?=$row->condiciones?></br></br>
    <hr>
    <B>Entradas/Salidas Registradas:</b>
    <?php echo $output; ?>
    <?php } ?> 
```

效果很好，但是当我运行它时，我得到了应该出现 CRUD 的位置：

```
A PHP Error was encountered
Severity: 4096
Message: Object of class stdClass could not be converted to string
Filename: views/folio_view.php
Line Number: 65 
```

我真正想要完成的是让 CRUD 显示与学生匹配的 RFID 字段匹配的唯一 RFID 条目。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-08T21:04:30.173

实际上，该错误准确地描述了那里的问题。所以问题是你试图回显一个对象。

所以想象你的 $output 是一个像这样的对象：

```
stdClass Object
(
    [output] => Your output will appear here....
    [js_files] => Array
        (
            ...
        )

    [css_files] => Array
        (
            ...
        )

) 
```

所以解决你的问题的方法很简单：

```
echo $output->output; 
```

还要考虑杂货店 CRUD 唯一需要的就是在某处显示 js_files 和 css_files ，所以不要忘记在模板或视图中包含它：

```
<?php foreach($output->css_files as $file): ?>
        <link type="text/css" rel="stylesheet" href="<?php echo $file; ?>" />
<?php endforeach; ?>

<?php foreach($output->js_files as $file): ?>
    <script src="<?php echo $file; ?>"></script>
<?php endforeach; ?> 
```

如果您想对您更具“可读性”，只需执行以下操作：

```
$data['gcrud'] = $crud->render(); 
```

在你的视图/模板中有这样的东西：

```
<?php foreach($gcrud->css_files as $file): ?>
        <link type="text/css" rel="stylesheet" href="<?php echo $file; ?>" />
<?php endforeach; ?>

<?php foreach($gcrud->js_files as $file): ?>
    <script src="<?php echo $file; ?>"></script>
<?php endforeach; ?>

...

<?php echo $gcrud->output; ?> 
```

**最后但并非最不重要的一点是，考虑到您尝试做的事情首先**不会起作用，因为我知道您希望在一个页面中使用多个 CRUD：

```
<?php foreach($query->result() as $row) { ?>
    ...
    <B>Entradas/Salidas Registradas:</b>
    <?php echo $output->output; ?>
<?php } ?> 
```

但是，您会意识到，由于杂货店 CRUD 暂时不支持在一页中包含多个 CRUD 表单，因此它暂时对您不起作用。因此，如果您真的想使用杂货店 CRUD，您必须更改视图将显示它的逻辑

# asp.net-web-api - 域和序列化内容之间的 ASP.net Web Api 层

> ID：13278414
> 
> 赞同：0
> 
> 时间：2012-11-07T21:19:38.653
> 
> 标签：asp.net-web-api

在标准的 .NET MVC 中，我们有 Domain 类和 ModelView 类。现在，使用 ASP.Net Web API，我想不需要 ModelView 类（因为我们正在返回数据）但是我们应该直接返回（序列化）域类还是需要介于两者之间的东西？

```
// Domain class
public class User {
  public int Id {get;set;}
  public string FirstName {get;set;}
  public string LastName {get;set;}
}

// inter class
public class ProductModel {
  public int Id {get;set;}
  public string FirstName {get;set;}
  public string LastName {get;set;}
  public string FullName {get {return String.Format("{0} {1}", FirstName, LastName);}}
}

// Controller V1 returns Product    
public class UserController : ApiController 
{
   public Product GetProduct(int id) {...}
}

// Controller V2 returns ProductModel     
public class UserController : ApiController 
{    
   public ProductModel GetProduct(int id) {...}
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-07T21:38:05.903

在 API 中公开你的领域模型很少是一个好主意。

如果您是唯一将使用 API 的人，并且您可以确定您将以完全相同的频率将更新部署到客户端和服务器，那么您可以走这条捷径，但是，我不会推荐它。

# iphone - iOS：从 BTLE 设备读取电压值

> ID：13278415
> 
> 赞同：2
> 
> 时间：2012-11-07T21:19:39.407
> 
> 标签：iphone, ios, bluetooth, core-bluetooth, bluetooth-lowenergy

我开发了自己的蓝牙低功耗配置文件，以便从一堆光传感器读取电压。唯一的问题是，在我的 iPhone 上，我找不到从 GATT 数据库中读取数据的正确方法。我连接良好，发现特征没有问题，但只是不知道如何正确读取数据。我正在研究 BLE112，数据应该是 4 个字节的形式。我目前正在尝试使用的代码是：

```
[sensorZeroCharacteristic.value getBytes:&val length:sizeof(val)];          
result = (CGFloat)val; 
```

（val 是一个 uint32_t）

但这给出了一些非常大（但一致）的数字，那么我做错了什么？

# .htaccess - 旧 Joomla SEF URL 上的 301 重定向

> ID：13278420
> 
> 赞同：0
> 
> 时间：2012-11-07T21:19:49.060
> 
> 标签：.htaccess, redirect, joomla, seo

我正在删除安装了 SEF 模块的旧 Joomla 1.0 站点。我需要以搜索引擎友好的方式将 URL 重定向到静态页面。

典型的 URL 如下所示：www.mysite.com/index.php?/this-page.html。
我需要将其转发到同一站点上的静态页面，例如：www.mysite.com/this-page.html

所以，我编辑了 htaccess 来阅读：

```
redirect 301 /index.php?/this-page.html http://www.mysite.com/this-page.html 
```

重定向似乎不起作用。有任何想法吗？去除“/index.php?/”的通配符重定向将是一个奖励，因为我必须做大约 80 个。我也很高兴手动完成它们。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-08-22T11:25:53.710

RewriteEngine On RewriteCond %{REQUEST_URI} ^/index.php/ RewriteRule ^index.php/(.*) /$1 [R,L]

这从所有旧的 sef url 中消除了 index.php

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-08T10:28:20.237

添加您的 .htaccess 重定向 /path/to/new/folder [http://www.yoursite.com/new_page.html](http://www.yoursite.com/new_page.html)

第一个参数应该是文件夹的路径

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-08T01:37:17.020

在下面试试这个，让我知道

```
redirect /index.php?/this-page.html http://www.mysite.com/this-page.html 
```

# objective-c - 自定义 UIButton 背景图像显示在 iOS 6 但不是 iOS 5

> ID：13278421
> 
> 赞同：1
> 
> 时间：2012-11-07T21:19:55.673
> 
> 标签：objective-c, ios, ios5, uibutton, ios6

我在界面生成器中设置了按钮背景，但没有显示出来，所以我以编程方式设置它。所有（除了一个按钮......为什么？）都显示在模拟器上，但从不显示在设备上。

我得到这个输出：

`Could not load the "gray_button.png" image referenced from a nib in the bundle with identifier "com.example.ios"`

这是代码：

```
- (void) viewWillAppear:(BOOL)animated
{
    [super viewWillAppear:animated];

    [self.getMyTripButton setBackgroundImage:[UIImage imageWithContentsOfFile:
                                          [[self getFullPathname] stringByAppendingPathComponent:@"images/gray_button.png"]]
                                forState:UIControlStateNormal];
    [self.popupButton setBackgroundImage:[UIImage imageWithContentsOfFile:
                                      [[self getFullPathname] stringByAppendingPathComponent:@"images/gray_button.png"]]
                            forState:UIControlStateNormal];

    [self.viewOurPackages reloadData];
} 
```

我也尝试过替换`imageWithContentsOfFile`，`imageNamed`两者都产生相同的结果。

我已经在我的项目 > 目标 > 构建阶段 > 复制捆绑资源中添加了图像目录，但我认为这就是一切开始出错的地方，我不知道为什么。可能是因为它是一个目录？

*我想指出，我已经两次和三次检查它不是大写/区分大小写的问题。*

**更新：我已经解决了一个按钮不显示的问题。看起来真正的问题是图像显示在 iOS6 上而不是在 iOS5 上。**

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-05T20:23:22.233

对我有用的是以下三件事之一（或组合）：

1.  确保您的图像文件格式正确。有时 png 文件需要一点强制。（我认为这特别是我的问题）
2.  确保您的按钮是 Interface Builder 中的 Custom 类型或`UIButtonTypeCustom`.
3.  如果您在 Interface Builder 中设置图像并且它仍然没有显示，请在代码中使用`[button setBackgroundImage:image forState:UIControlStateNormal]`（或`[button setImage:image forState:UIControlStateNormal]`取决于您需要哪一个）显式设置它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-07T21:25:18.927

如果要将文件夹添加到复制包中，则不`gray_button.png`应将文件引用为 ，而应从代码或 xib 中引用文件 您还必须在名称中包含目录，例如`directory/gray_button.png`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-08T00:08:52.883

斯蒂芬，

如果您用于`@synthesize`中的按钮`.h file`，那么会自动创建 getter 和 setter。因此（这是一个长镜头，只是一个想法）有这个名字`getMyTripButton`可能会以某种方式混淆 Xcode。尝试重命名变量？

至于图像未加载...对于其中一个按钮而不是另一个...常见问题解答？这是唯一`gray_button.png`被调用的地方吗？（例如，您没有在其他地方修改该按钮，可能会告诉它再次使用该图像）。您是否尝试过将它与使用它的 nib 放在同一目录中？你确定`getMyTripButton`从笔尖正确地绑定到代码吗？

我现在能想到的最后一件事：你说

> 我在界面生成器中设置了按钮背景，但没有显示出来，所以我以编程方式设置它。所有（除了一个按钮......为什么？）都显示在模拟器上，但从不显示在设备上

你`popupButton`在 nib/interface builder 中也设置了背景图像吗？如果您已经在此处设置并在此处再次设置，则可能根本没有在代码中进行设置，而只是使用了界面生成器中的内容，这可以解释为什么`getMyTripButton`可能无法显示/显示背景图像。

如果我想到任何其他可能导致问题的东西，我会编辑这篇文章。祝你好运，坚持下去。

# c# - WPF -- 显示下一页时属性为空

> ID：13278426
> 
> 赞同：1
> 
> 时间：2012-11-07T21:20:10.357
> 
> 标签：c#, wpf, listview

我有一个问题，在我的列表视图中，当我选择一个项目时，行突出显示并且属性的值确实被设置了。但是当我单击按钮显示第二页时，列表视图没有突出显示/从上一个页面中选择。该属性为空。每个页面上的两个列表视图引用 itemsource 和 selecteditem 的相同属性。谁能帮我解释为什么第二页不会触发属性？

主窗口.xaml

```
 <UserControl.DataContext>
        <vm:MainViewModel />
    </UserControl.DataContext>

    <Grid>
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="auto"></ColumnDefinition>
            <ColumnDefinition Width="5"></ColumnDefinition>
            <ColumnDefinition Width="auto"></ColumnDefinition>
            <ColumnDefinition Width="5"></ColumnDefinition>
            <ColumnDefinition Width="auto"></ColumnDefinition>
        </Grid.ColumnDefinitions>
        <Button Name="btnPrevious" Content="&lt;" Grid.Column="0" Height="300" Click="btnPrevious_Click"></Button>
        <Grid Width="310" Height="300" Grid.Column="2">
            <Frame x:Name="UserControlContainer" NavigationUIVisibility="Hidden" Width="310" />
        </Grid>
        <Button Name="btnNext" Content="&gt;" Grid.Column="4" Height="300" Click="btnNext_Click"></Button>
    </Grid> 
```

主窗口.xaml.cs

```
public partial class MainWindow : UserControl
    {
        private FirstPage fPage;
        private SecondPage sPage;

        private static int oldIndex = 1;

        public FirstPage FPage
        {
            get
            {
                if (fPage == null)
                    fPage = new FirstPage();

                return fPage;
            }
            set
            {
                fPage = value;
            }
        }

        public SecondPage SPage
        {
            get
            {
                if (sPage == null)
                    sPage = new SecondPage();

                return sPage;
            }
            set
            {
                sPage = value;
            }
        }

        public MainWindow()
        {
            InitializeComponent();

            UserControlContainer.Source = new Uri("Views\\FirstPage.xaml", UriKind.Relative);
        }

        private void btnPrevious_Click(object sender, RoutedEventArgs e)
        {
            var content = UserControlContainer.Content as UserControl;

            var targetUserControl = this.FPage as UserControl;
            targetUserControl.DataContext = this.DataContext;

            this.UserControlContainer.NavigateToControl(targetUserControl, oldIndex, 2);

            oldIndex = 2;
        }

        private void btnNext_Click(object sender, RoutedEventArgs e)
        {
            var content = UserControlContainer.Content as UserControl;

            var targetUserControl = this.SPage as UserControl;
            targetUserControl.DataContext = this.DataContext;

            this.UserControlContainer.NavigateToControl(targetUserControl, oldIndex, 1);

            oldIndex = 1;
        }
    } 
```

主视图模型.cs

```
public class MainViewModel : INotifyPropertyChanged
{
    Dictionary<int, string> itemList;
    KeyValuePair<int, string>? selectedItemList = null;

    public event PropertyChangedEventHandler PropertyChanged;

    private void NotifyPropertyChanged(String PropertyName)
    {
        if (PropertyChanged != null)
        {
            PropertyChanged(this, new PropertyChangedEventArgs(PropertyName));
        }
    }

    public Dictionary<int, string> ItemList
    {
        get
        {
            itemList = GetItemsList();
            return itemList;
        }
    }

    private Dictionary<int, string> GetItemsList()
    {
        var resultList = new Dictionary<int, string>();

        resultList.Add(1, "Item I");
        resultList.Add(2, "Item II");
        resultList.Add(3, "Item III");

        return resultList;
    }

    public KeyValuePair<int, string>? SelectedItemList
    {
        get 
        { 
            return selectedItemList; 
        }
        set
        {
            selectedItemList = value;
            NotifyPropertyChanged("SelectedNewPtLevel");
        }
    }
} 
```

第一页.xaml

```
<UserControl.DataContext>
        <vm:MainViewModel />
    </UserControl.DataContext>

    <Grid>
        <ListView Name="lstFirst" HorizontalAlignment="Left"  
                    Height="auto" ItemsSource="{Binding Path=ItemList}" SelectedItem="{Binding Path=SelectedItemList}" 
                    FontSize="11" SelectionMode="Single" Width="310">
            <ListView.ItemContainerStyle>
                <Style TargetType="ListViewItem">
                    <Style.Triggers>
                        <Trigger Property="IsSelected" Value="True">
                            <Setter Property="Background" Value="Yellow"></Setter>
                        </Trigger>
                    </Style.Triggers>
                </Style>
            </ListView.ItemContainerStyle>
            <ListView.View>
                <GridView>
                    <GridView.ColumnHeaderContainerStyle>
                        <Style>
                            <Setter Property="FrameworkElement.Visibility" Value="Collapsed"/>
                        </Style>
                    </GridView.ColumnHeaderContainerStyle>
                    <GridViewColumn Width="69" DisplayMemberBinding="{Binding Key}"></GridViewColumn>
                    <GridViewColumn Width="109" DisplayMemberBinding="{Binding Value}"></GridViewColumn>
                </GridView>
            </ListView.View>
        </ListView>
    </Grid> 
```

第二页.xaml

```
<UserControl.DataContext>
        <vm:MainViewModel />
    </UserControl.DataContext>

    <Grid>
        <ListView Name="lstSecond" HorizontalAlignment="Left"
                    Height="auto" ItemsSource="{Binding Path=ItemList}" SelectedItem="{Binding Path=SelectedItemList}" 
                    FontSize="11" SelectionMode="Single" Width="310">
            <ListView.ItemContainerStyle>
                <Style TargetType="ListViewItem">
                    <Style.Triggers>
                        <Trigger Property="IsSelected" Value="True">
                            <Setter Property="Background" Value="Pink"></Setter>
                        </Trigger>
                    </Style.Triggers>
                </Style>
            </ListView.ItemContainerStyle>
            <ListView.View>
                <GridView>
                    <GridView.ColumnHeaderContainerStyle>
                        <Style>
                            <Setter Property="FrameworkElement.Visibility" Value="Collapsed"/>
                        </Style>
                    </GridView.ColumnHeaderContainerStyle>
                    <GridViewColumn Width="69" DisplayMemberBinding="{Binding Key}"></GridViewColumn>
                    <GridViewColumn Width="109" DisplayMemberBinding="{Binding Value}"></GridViewColumn>
                </GridView>
            </ListView.View>
        </ListView>
    </Grid> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-07T21:43:07.637

问题是，当您单击第二页时，View Model 类的一个新实例正在被实例化。为了解决这个问题，我建议将数据上下文绑定到“定位器”类。

```
<UserControl DataContext="{Binding Source={StaticResource Locator},Path=Main}"
    ... /> 
```

（这里的`Locator`实例位于应用程序的主要资源部分，如`<vm:Locator x:Key=Locator />`.）

Locator 类跟踪模型的单个实例。

```
public class Locator
{
    private MainViewModel _model;

    public MainViewModel Main
    {
        get
        {
            if (_model == null) _model = new MainViewModel();
            return _model;
        }
    }
} 
```

# android - 如何为远程机器开发和本地设备部署设置 ADB

> ID：13278429
> 
> 赞同：45
> 
> 时间：2012-11-07T21:20:25.957
> 
> 标签：android, adb, remote-debugging

我的场景是这样的：我在家远程工作并通过 Windows 远程桌面登录到我的工作机器。我在工作计算机上使用 Eclipse 作为 Android 应用程序的开发环境。

使用 ADB，我希望能够将应用程序从我的工作计算机部署到我家庭网络上的设备上，以应对模拟器无法执行应用程序公正的情况。

我发现这篇文章讨论了一个非常相似的场景，除了部署到在本地 PC 上运行的模拟器，而不是部署到本地设备：

[http://www.41post.com/5003/programming/android-adb-remote-emulator-access](http://www.41post.com/5003/programming/android-adb-remote-emulator-access)

我正在尝试采取相同的步骤，但要弄清楚如何在我的家庭 WiFi 网络上定位本地设备并连接到我的本地家用 PC，而不是本地模拟器。

现在，我将远程 PC 设置为尝试在端口 5585 上连接到我的公共路由器 IP - 但在我的路由器中，我将其转发到哪个 IP/端口以连接到本地设备？

在使用模拟器的示例中，它们转发到运行模拟器的本地 PC 地址和端口 5555，而 adb 未在本地 PC 上运行。我已将路由器配置为转发到我的设备 IP，设备在 WiFi 上，以及设备连接的本地 PC IP。

但是，在这两种情况下，当我在远程 PC 上尝试时`adb connect <routerIP>:5585`，都会出现错误`unable to connect to <routerIP>:5585:5585`。尝试转发/收听其他端口时，我得到相同的响应。我在路由器日志中没有收到任何安全错误，因此看来端口转发正在工作。

**问题：**

*   在本地网络上配置端口转发以使用远程 adb 实例连接到本地设备时，我应该转发到哪个本地 IP/端口号？
*   我应该以设备绑定的本地 PC IP 还是本地设备 IP 为目标？
*   如果我以本地设备 IP 为目标，我应该转发到哪个端口号？
*   我需要在本地 PC 上运行 adb 吗？

* * *

## 回答 #1

> 赞同：50
> 
> 时间：2013-03-12T16:00:54.980

我也有类似的情况。我在远程桌面上工作以进行开发，但我的 android 设备已连接到本地笔记本电脑。我希望能够在远程桌面上使用 eclipse 中的 adb 和 android 插件，并连接到连接到我的笔记本电脑的设备。在互联网上搜索并没有找到任何真正有用的东西后，我决定编写一个端口转发器来解决问题。你可以在[这里](https://bitbucket.org/chabernac/adbportforward/wiki/Home)找到它。我希望它对其他人也有帮助。

* * *

## 回答 #2

> 赞同：25
> 
> 时间：2013-08-31T18:11:44.207

从 Android 4.3 开始，您可以：

1.  让`adb`服务器监听所有接口。你有两个选择：
    *   使[gListen=1](http://androidxref.com/4.3_r2.1/xref/system/core/adb/adb.c#50)并重新编译`adb`（我已经在 Linux-x64 机器上为您编译并放在[这里](http://www.romansaveljev.info/adb_listens_all_interfaces/adb.zip)）
    *   使用参数启动 adb 服务器`-a`：`adb -a -P 5037 fork-server server&`
2.  `adb`在带有额外参数的远程机器上使用，例如`adb -H <remote_host> shell`

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2020-07-15T02:10:04.123

远程主机 + 本地设备测试的另一种设置。这对于许多在家使用笔记本电脑工作的人来说非常有用，连接到他们仍在办公室的开发主机。请注意，我假设 devhost/laptop 都在运行 Unix，但其他操作系统将能够在命令提示符/shell 上运行命令。

```
# Kill old adb server.
devhost$ adb kill-server 

# Activate adb server on client
laptop$ adb start-server

# Start ssh tunnel. Hide/minimize this window not to close it by accident
laptop$ ssh -XC -R 5037:localhost:5037 <your devhost machine>

# Should work by now with the local device connected to the laptop
devhost$ adb logcat 
```

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2014-07-19T04:26:32.080

您可以通过端口转发解决此问题。

*   从 Chrome 应用商店下载 Secure Shell 应用
*   连接到您的机器（逐步设置）
*   在此连接中，禁用 adb 服务器： adb kill-server
*   创建一个新的端口转发连接（与常规连接相同，但将 SSH Arguments 字段设置为：-N -R 5037:localhost:5037）
*   在您的笔记本电脑上，打开一个终端并启用 adb 服务器： adb start-server

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2015-10-27T22:14:15.983

我的情况需要使用位于不同网络上的 VM，但我 rmd 进入（Azure VM）。VM 和我的本地笔记本电脑都运行 Windows 10。首先，我必须在我的本地计算机上安装 USB Redirector RDP Edition（成本 80 美元，但可能有免费的替代品），然后在 VM 上安装 Google Android USB 驱动程序和VM 上的[通用 Adb 驱动程序。](http://download.clockworkmod.com/test/UniversalAdbDriverSetup6.msi "通用 Adb 驱动程序")我现在可以在 VM 上的 Android Studio 中加载~~一个 Android Studio 应用程序~~，在我的笔记本电脑上连接一个 Android 设备，并在设备上调试该应用程序。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2017-12-14T15:07:04.707

可能有一个更简单的解决方案，提供设备，本地和远程机器属于同一个网络。假设您的设备在网络上有一个特定的 IP，假设您决定使用首选端口：那么，您可以执行以下步骤。

在插入设备的机器上，请运行：

```
adb devices

adb tcpip <PORT> 
```

*PORT 的示例是 5555。*

在远程计算机上，您需要停用“发现 USB 设备”、“发现网络目标”和“端口转发”，然后运行：

```
adb connect IP:PORT 
```

* *IP是你的android设备IP（不是第一台机器IP），可以从`adb shell ip -f inet addr`*

你已经准备好在远程机器上调试了。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2022-02-25T16:12:21.457

这就是我如何让它从带有模拟器的主机 macOS 到 macOS 客户端工作。

#### 在主机上

```
host$ adb kill-server
host$ adb -a nodaemon server 
```

#### 在客户端

```
client$ adb kill-server
client$ ssh -L 5037:localhost:5037 <host-IP> 
```

#### 在客户端打开第二个 shell

```
client$ adb kill-server  # I observe first it kills client adb
client$ adb kill-server  # then it kills server adb, do it maybo once more
client$ adb devices      # show devices on server now 
```

现在我在 Android Studio 中也看到了主机模拟器

[![在此处输入图像描述](../Images/938f373d545d8aa0d1562597ce4b11ea.png)](https://i.stack.imgur.com/tOhkj.png)

# javascript - Greasemonkey 脚本不适用于动态插入的小部件

> ID：13278430
> 
> 赞同：1
> 
> 时间：2012-11-07T21:20:27.707
> 
> 标签：javascript, greasemonkey

我正在尝试编写一个 Greasemonkey 脚本，如果找到，它将自动将焦点放在验证码输入字段上。这工作正常，除非在动态插入验证码表单的情况下，例如[这个例子](http://www.solvemedia.com/publishers/captcha-type-in)。我认为为 DOMNodeInserted 创建一个事件侦听器应该可以处理这种情况。（我正在 Firefox 17b 上进行测试）。

```
// ==UserScript==
// @name          Focus captcha field
// @description   Adds focus on captcha fields
// ==/UserScript==

function focusCaptcha (elem) {
    var ids = ['recaptcha_response_field', 'adcopy_response', 'captcha_input'];
    for (var i = ids.length - 1; i >= 0; i--) {
        var input = elem.getElementById(ids[i]);
        if (input) {
            input.focus();
            input.value = '';
            return;
        }
    }
}

(function() {
    focusCaptcha(document);
})();

document.addEventListener('DOMNodeInserted', function(event) {
    focusCaptcha(event.target);
}, false); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-07T22:19:42.783

`DOMNodeInserted`是一个*Mutation Event*并且[**Mutation Events 被弃用**](http://www.w3.org/TR/DOM-Level-3-Events/#events-mutationevents)是有充分理由的。该代码可能会严重加载浏览器的 JS，并可能触发一些“脚本繁忙/失控”保护措施。

您可以切换到全新的[MutationObservers](https://developer.mozilla.org/en-US/docs/DOM/MutationObserver)，但这对于这类事情来说过于复杂了。

使用久经考验的真正[waitForKeyElements() 实用程序](https://gist.github.com/2625891)。像这样：

```
// ==UserScript==
// @name        _Focus captcha field
// @description Adds focus on captcha fields
// @require     http://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js
// @require     https://gist.github.com/raw/2625891/waitForKeyElements.js
// @grant       GM_addStyle
// ==/UserScript==
/*- The @grant directive is needed to work around a design change introduced
    in GM 1.0\.   It restores the sandbox.
*/

function focusCaptcha (jNode) {
    jNode.val ('');
    jNode[0].focus ();
}

waitForKeyElements (
    "#recaptcha_response_field, #adcopy_response, #captcha_input#",
    focusCaptcha
); 
```

* * *

请注意，在尝试移动焦点时，iframe*可能会使事情复杂化（虽然还没有测试过）。*

# android - 检索现有 Android 应用程序的私钥

> ID：13278431
> 
> 赞同：1
> 
> 时间：2012-11-07T21:20:29.060
> 
> 标签：android

> **可能重复：**
> [丢失了我在 android 市场上上传的应用程序的密钥库](https://stackoverflow.com/questions/11715621/lost-my-keystore-for-uploaded-app-on-android-market)

我正在将新版本的 Android 应用程序推送到 Google Play 商店，我希望它触发应用程序当前用户的更新，而不是将其视为新版本。我没有最初用于签署现有应用程序的私钥，所以我正在尝试以下方法来恢复它。

我可以进入第 3 步，但我不确定 keytool -list -keystore my-signing-key.keystore 命令的 .keystore 文件名是什么，有什么想法吗？

1.  首先，解压APK并解压文件/META-INF/ANDROID_.RSA（这个文件也可能是CERT.RSA，但应该只有一个.RSA文件）。
2.  然后发出这个命令：

    keytool -printcert -file ANDROID_.RSA 你会得到这样的证书指纹：

    MD5: B3:4F:BE:07:AA:78:24:DC:CA:92:36:FF:AE:8C:17:DB SHA1: 16:59:E7:E3:0C:AA:7A:0D :F2:0D:05:20:12:A8:85:0B:32:C5:4F:68 签名算法名称：SHA1withRSA

3.  然后再次使用 keytool 打印出签名密钥库的所有别名：

    keytool -list -keystore my-signing-key.keystore

您将获得别名列表及其证书指纹：

```
android_key, Jan 23, 2010, PrivateKeyEntry,
Certificate fingerprint (MD5): B3:4F:BE:07:AA:78:24:DC:CA:92:36:FF:AE:8C:17:DB 
```

瞧！我们现在可以确定该 apk 已使用此密钥库和别名“android_key”进行签名。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-07T21:26:15.060

除非您拥有保存私钥的原始密钥库文件，否则您无法从 .apk 中提取它。.apk 仅包含公钥和使用私钥生成的签名，但它实际上并不包含私钥本身。

考虑一下 - 如果 .apk 包含实际的私钥，并且提取它的说明非常简单，那么任何人都可以从他们的应用程序中获取 Google、Facebook、Microsoft 或 Amazon 的私钥并用它签署任何恶意软件。（Apple 不会受到这种攻击，因为他们不发布任何 Android 软件 :-P）

因此，除非您有权访问用于签署前一个 .apk 的原始密钥库文件（并且您知道密码短语 - 感谢@323go），否则我担心您会不走运。

# .htaccess - 使用 .htaccess 重定向 301 而不更改地址栏中的 URL

> ID：13278439
> 
> 赞同：3
> 
> 时间：2012-11-07T21:21:08.187
> 
> 标签：.htaccess, url, redirect

我目前有一个 WordPress 多站点网络设置。主网站位于`"http://safesideinc.com."`然后，还有另一个子域`"http://danielgosek.safesideinc.com."`

我想要指向的 URL “http://safesideinc.com”和指向的`"http://safesideinc.com,"`URL`"http://danielgosek.com"``"http://danielgosek.safesideinc.com."`

在 .htaccess 中使用 301 重定向，我可以实现这一点。但是，我希望`"http://danielgosek.com"`在 URL 栏中输入会导致`"http://danielgosek.safesideinc.com."`不更改显示的 URL——在这种情况下，显示的 URL 应该保持不变`"http://danielgosek.com."`

是否有任何规则可以帮助我实现这一目标？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-03T10:14:44.187

不可能，**301** - 永久重定向是向浏览器指示资源已永久移动并且浏览器应重定向到提供的新 URL 的指令。

如果您不想更改 URL，则需要在两个虚拟主机/域之间设置反向代理，或者如果**danielgosek.com**只是别名、相同的 IP 并由相同的 Apache 虚拟主机提供服务，您可以使用内部重写。

# javascript - 使用 ArcGIS javascript api 切换 kml

> ID：13278448
> 
> 赞同：1
> 
> 时间：2012-11-07T21:21:37.093
> 
> 标签：javascript, kml, arcgis

我正在尝试使用复选框来使用 ArcGIS javascript API 切换 kmls。

在 esri 站点上切换的示例是针对动态地图服务的，我不知道如何使其适用于 kml [http://help.arcgis.com/en/webapi/javascript/arcgis/help/jssamples_start。 htm#jssamples/map_explicitlayerlist.html](http://help.arcgis.com/en/webapi/javascript/arcgis/help/jssamples_start.htm#jssamples/map_explicitlayerlist.html)

我在这里添加了我的 kml

```
 var kmlURL = 'http://www.lohneswright.com/ctc/kml/actc_wheels.kml';
  var kml = new esri.layers.KMLLayer(kmlURL);
  map.addLayer(kml); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-02-20T15:46:16.717

[Dojo](http://dojotoolkit.org/reference-guide/1.9/dijit/form/CheckBox.html)有一个很好的复选框，可以在 ArcGIS Javascript 中切换图层。下面的代码应该适用于您正在寻找的内容。您还可以对 KML 图层使用“show()”和“hide()”方法。这也会切换它们。

```
require(["dijit/form/CheckBox", "esri/layers/KMLLayer", "dojo/domReady!"], 
function(CheckBox, KMLLayer){

var kmlURL = 'http://www.lohneswright.com/ctc/kml/actc_wheels.kml';
var kml = new KMLLayer(kmlURL);

var checkBox = new CheckBox({
    checked: false,
    onChange: function(checked){
           if(checked){
                map.addLayer(kml);
           }else{
                map.removeLayer(kml);
           }
}, "checkBox");
}); 
```

# c++ - 如何从一个文件中读取数据并将其导入另一个文件？

> ID：13278449
> 
> 赞同：0
> 
> 时间：2012-11-07T21:21:36.423
> 
> 标签：c++, arrays

我将如何读取文件 u.data 并将其存储在数组中以获取每部电影中的信息，数组由电影 ID 索引：

评分数 评分总和

上述值的比率将为您提供电影的平均评分。

现在我有：

```
 const int MAXCOUNT = 100;
   int ratingscount[MAXCOUNT];
   int ratingsum[MAXCOUNT];
   std::ifstream in("u.data");
   int movieid, rating;
   while( in >> userid >> movieid >> rating >> timestamp ) {
     if(movieid >= MAXCOUNT) {
       std::cout << "ERROR!";
       return;
     }
     ratingscount[movieid]++;
     ratingsum[movieid] += rating;
   } 
```

如何从文件 u.data 导入数据并将其存储在我声明的这些数组中？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-07T21:36:28.330

您需要从文件中读取数据。使用的工具是`std::ifstream`.

```
std::ifstream in("./intput-file.txt");
int userid, movieid, rating, timestamp;
while( in >> userid >> movieid >> rating >> timestamp ) {
  if(movieid >= MAXCOUNT) {
    std::cout << "ERROR! ERROR!";
    return;
  }
  ratingscount[movieid]++;
  ratingsum[movieid] += rating;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-07T21:37:11.933

如果您想了解如何从文件中读取数据或将数据输出到文件，请查看：[http ://www.cplusplus.com/reference/iostream/fstream/](http://www.cplusplus.com/reference/iostream/fstream/)

# vb6 - 下拉和图片框集成

> ID：13278454
> 
> 赞同：-6
> 
> 时间：2012-11-07T21:21:55.393
> 
> 标签：vb6

我有一个简单的表格，其中有一个下拉框，里面有一个名称列表，上面还有一个图片框。

当我选择一个名字时，我怎样才能使那个人的图片自动出现在图片框中？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-08T08:34:47.697

使用包含名称和图片文件的用户定义类型，然后创建此类型的数组

例如 ：

```
'1 form with :
'    1 listbox : name=List1
'    1 picturebox : name=Picture1
Option Explicit

Private Type PERSON
  strName As String
  strPicture As String
End Type

Private mperFriend(4) As PERSON

Private Sub Form_Load()
  Dim intIndex As Integer
  mperFriend(0).strName = "Bob"
  mperFriend(0).strPicture = "Bob.jpg"
  mperFriend(1).strName = "Jane"
  mperFriend(1).strPicture = "Jane.jpg"
  mperFriend(2).strName = "Fred"
  mperFriend(2).strPicture = "Fred.jpg"
  mperFriend(3).strName = "Iris"
  mperFriend(3).strPicture = "Iris.jpg"
  mperFriend(4).strName = "John"
  mperFriend(4).strPicture = "John.jpg"
  List1.Clear
  For intIndex = 0 To UBound(mperFriend)
    List1.AddItem mperFriend(intIndex).strName
  Next intIndex
End Sub

Private Sub List1_Click()
  Caption = mperFriend(List1.ListIndex).strPicture
  Picture1.Picture = LoadPicture(App.Path & "\" & mperFriend(List1.ListIndex).strPicture)
End Sub 
```

# list - OCaml - 向该列表添加一个包含元组列表的新元组

> ID：13278457
> 
> 赞同：3
> 
> 时间：2012-11-07T21:22:09.717
> 
> 标签：list, recursion, closures, ocaml, tuples

我正在用一些简单的命令在 OCaml 中编写一个交互式计算器。用户应该能够定义自己的简单函数（数学函数），例如

```
let f(x) = x
let g(x) = 2*f(x) 
```

现在，函数应该像函数式语言一样处理，这意味着它们应该记住它们的创建时间环境。这意味着，对于一个函数，我必须保持其环境的闭包，即函数和变量。

我将当前定义的函数保存在一个像`(functions_present_at_the_time_of_creation, variables_present_at_the_time_of_creation, function_name, function_argument_names, function_formula)`. 当我尝试将一个新函数添加到函数列表中时（假设它当前未定义并且我不必覆盖任何内容），我反复迭代到函数列表的末尾并希望添加一个新的元组。

问题是，假设我当前的函数列表是类型`(a*b*c*d*e) list`，当我尝试将一个带有自身的元组添加到它的末尾时，它会将其类型更改为`((a*b*c*d*e) list*f*g*h*i) list`. 我能做些什么才能执行这样的列表添加到自身，封装在一个元组中？

这是我在尝试找到解决此问题的方法时编写的一些简单的 SSCCE。

```
let rec add_to_end list list_copy dummy = match list with
| [] -> [(list_copy, dummy)]
| h::t -> h::(add_to_end t list_copy dummy) 

let add list dummy = add_to_end list list dummy 
```

这个尝试使用列表的副本来完成。以下是在没有使用副本的情况下编写的（当然，这两个示例都不起作用）：

```
let rec add_to_end list dummy = match list with
| [] -> [(list, dummy)]
| h::t -> h::(add_to_end t dummy) 
```

第一个示例在尝试使用函数 add 时不起作用，但是当以这种方式（在解释器中）执行此操作时：

```
let l = [];;
let l = add_to_end l l 1;;
let l = add_to_end l l 2;;
let l = add_to_end l l 3;; 
```

然后它工作正常。我会很感激任何帮助，我也可能会考虑改变设计，非常欢迎任何建议。

编辑：这是上述命令的输出：

```
# let l = [];;
val l : 'a list = []
# let l = add_to_end l l 1;;
val l : ('a list * int) list = [([], 1)]
# let l = add_to_end l l 2;;
val l : (('a list * int) list * int) list = [([], 1); ([([], 1)], 2)]
# let l = add_to_end l l 3;;
val l : ((('a list * int) list * int) list * int) list =
[([], 1); ([([], 1)], 2); ([([], 1); ([([], 1)], 2)], 3)] 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-07T21:35:47.193

很难说你是否知道 OCaml 列表是不可变的。您不能将值添加到现有列表的末尾。现有列表永远无法更改。您可以创建一个新列表，并在末尾添加一个值。如果你这样做，我不明白你为什么要在由列表和新值组成的末尾添加一对。我怀疑你想错了。这是一个函数，它接受一个列表和一个整数并将整数添加到列表的末尾。

```
# let rec addi i list =
    match list with
    | [] -> [i]
    | h :: t -> h :: addi i t
  ;;
val addi : 'a -> 'a list -> 'a list = <fun>
# let x = [1;2;3];;
val x : int list = [1; 2; 3]
# addi 4 x;;
- : int list = [1; 2; 3; 4]
# x;;
- : int list = [1; 2; 3]
# 
```

该函数返回一个新列表，并将值添加到末尾。原始列表没有改变。

*作为旁注，将值添加到列表的前面*更为惯用。反复添加到列表的末尾很慢——它给出了二次行为。如果你想要其他顺序，通常的做法是将所有内容添加到前面，然后反转列表——这仍然是线性的。

**编辑**

显然你真的想要一个看起来像这样的函数：

让 fa list = list @ [(list, a)]

这实际上是不可能的，类型不正确。一个列表只能包含一种类型的东西。所以可以断定list的类型和type`t`是一样的`(t, v) list`，这里`v`是a的类型。这是一种递归类型，而不是您真正想要使用的东西（恕我直言）。

您实际上可以使用以下方法在 OCaml 中获得这种类型`-rectypes`：

```
$ ocaml -rectypes
        OCaml version 4.00.0

# let f a list = list @ [(list, a)];;
val f : 'a -> (('b * 'a as 'c) list as 'b) -> 'c list = <fun>
# 
```

但是（正如我所说）这是我会避免的。

**编辑 2**

现在我看了一下，您的第一个代码示例避免了需要递归类型，因为您指定了列表的两个不同副本。在您使用相同的列表调用函数之前，这些可能是不同的类型。所以函数类型不是递归的。当您使用同一个列表的两个副本调用时，您会创建一个类型与列表类型不同的新值。它之所以有效，是因为您`l`对不同的值（具有不同的类型）使用相同的名称。它在真正的程序中不起作用，您需要一个代表您的列表的类型。

As another side comment: the beauty of adding values to the beginning of a list is that the old value of the list is still there. It's the tail of the new list. This seems *lot* closer to what you might actually want to do.

# iphone - 当用户点击返回时，如何将下一个文本字段设置为焦点以进行编辑？

> ID：13278458
> 
> 赞同：5
> 
> 时间：2012-11-07T21:22:09.027
> 
> 标签：iphone, ios, ipad, cocoa-touch

> **可能重复：**
> [如何在文本字段中导航（下一步/完成按钮）](https://stackoverflow.com/questions/1347779/how-to-navigate-through-textfields-next-done-buttons)
> [iOS 应用程序“下一步”键不会转到下一个文本字段](https://stackoverflow.com/questions/9540500/ios-app-next-key-wont-go-to-the-next-text-field)

我的视图中有两个文本字段，当用户点击返回键时，我希望光标从电子邮件文本字段移动到密码文本字段。如果密码文本字段是焦点，我希望键盘隐藏。这是我目前拥有的，但它不起作用......

```
- (BOOL)textFieldShouldReturn:(UITextField *)textField {
    return YES;
}

- (void)textFieldDidEndEditing:(UITextField *)textField {
    if(textField == self.emailTextField) {
        [self.passwordTextField becomeFirstResponder];
    }

    else if (textField == self.passwordTextField) {
        [textField resignFirstResponder];
    }
} 
```

我错过了什么？非常感谢您的智慧！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-07T21:38:56.620

您在方法中拥有的代码`textFieldDidEndEditing:`属于该`textFieldShouldReturn:`方法。

```
- (BOOL)textFieldShouldReturn:(UITextField *)textField {
    if(textField == self.emailTextField) {
        [self.passwordTextField becomeFirstResponder];
    } else if (textField == self.passwordTextField) {
        [textField resignFirstResponder];
    }

    return NO;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-08T04:12:12.397

好吧，作为参考，我们有以下两个文本字段，

```
UITextField *email_Text;
email_Text.tag  = 100;
email_Text.delegate = self;

UITextField *password_Text;
password_Text.tag = 101;
password_Text.delegate = self; 
```

您必须`UITextFieldDelegate`在您的`.h`文件中实施。

目前，我现在没有对文本字段使用任何分配方法。如果文本字段自己在 xib 中，则必须分配它或将其作为出口。我只是有两个对象仅供参考。而且这些对象必须在类中是全局可访问的（我的意思是你应该在标题中声明它）。

下一步是实现的`textFieldShouldReturn:`委托`UITextField`。

```
- (BOOL)textFieldShouldReturn:(UITextField *)textField {

    if(textField.tag == 100)
    {
        [password_Text becomeFirstResponder];
    }    
    else if(textField.tag == 101)
    {
        [textField resignFirstResponder];
    }
    else
    {
         ; //NOP
    }    

    return YES;
} 
```

试试这个。

快乐编码:)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-08T06:52:40.687

你错过了一件事

```
- (BOOL)textFieldShouldReturn:(UITextField *)textField {
if(textField == self.emailTextField) {
    [self.passwordTextField becomeFirstResponder];
     [self.emailTextField resignFirstResponder];
} else if (textField == self.passwordTextField) {
    [textField resignFirstResponder];
    [self.emailTextField becomeFirstResponder];
}

return NO; 
```

}

# c# - C#中的Json序列化

> ID：13278459
> 
> 赞同：39
> 
> 时间：2012-11-07T21:22:17.157
> 
> 标签：c#, json, serialization

我正在尝试将本地对象序列化为 json，但 msdn 文档似乎总是让我感到困惑。我相信我应该使用 DataContractJsonSerializer 但不完全确定，因为我看到了不同的反应。我也有人推荐过 Newtonsoft。

有没有人有这方面的经验可以为我指明正确的方向？

* * *

## 回答 #1

> 赞同：67
> 
> 时间：2012-11-07T21:23:55.890

您可以使用 JavaScriptSerializer。

[http://msdn.microsoft.com/en-us/library/system.web.script.serialization.javascriptserializer.aspx](http://msdn.microsoft.com/en-us/library/system.web.script.serialization.javascriptserializer.aspx)

```
var thing = new Thing();
var json = new JavaScriptSerializer().Serialize(thing); 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-11-07T22:06:26.520

那么 ServiceStack 的 JSON 序列化**器是**最快的[.NET JSON 序列化](http://www.servicestack.net/benchmarks/#burningmonk-benchmarks)器。

重量只有**159kb**，而且非常轻巧，更不用说包含许多有用的功能，例如 .NET 最快的[JSV](http://www.servicestack.net/mythz_blog/?p=176)和[CSV](https://github.com/ServiceStack/ServiceStack/wiki/ServiceStack-CSV-Format)文本序列化程序、[T.Dump()](http://www.servicestack.net/mythz_blog/?p=202) utils + 更多。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-11-07T21:26:06.897

除非您有一些非常特定的 json 需求，否则请坚持使用框架序列化程序。你会发现更多关于最终问题的反馈。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2012-11-07T21:39:32.267

.NET 中有很多不同的 json 库，它们提供了某种序列化。[查看http://json.org/](http://json.org/)的底部以查找 C# 的 JSON 库列表。哪个最好取决于您的需求。我使用过 Newtonsoft 的 json.net，虽然我个人发现序列化程序非常慢。如果您需要速度，Servicestack 声称拥有最快的（[此处](http://www.servicestack.net/mythz_blog/?p=344)）。该站点还显示了一些性能比较，尽管我没有尝试过。

做一些谷歌搜索，或者只是尝试一下，编写一些测试，或者只是选择一个框架并且不引入额外的依赖项并完成它。

# ssis - 如何通过将多个列与 Excel 源进行比较来更新表？

> ID：13278465
> 
> 赞同：0
> 
> 时间：2012-11-07T21:22:54.653
> 
> 标签：ssis

我正在创建一个 SSIS 包，以将 Excel 工作表（从 iSeries 数据库导出）中的数据增量加载到 SQL 表中，我目前遇到的问题是确定要更新哪些记录以及要在数据流中插入哪些记录，我已经看到它是通过进行术语查找来完成的，所以我设置了术语查找，我遇到的问题是我需要匹配多个列来比较唯一的行（在下面的示例中，我需要至少匹配 Parent、2nd 和 RoutingCode），并且 Term Lookup 转换只允许匹配一列，现在理论上我可以将成功匹配输出到第二个查找和第三个，但这似乎是一个迂回的解决方案，并且有大量输入行可能会降低性能，所以我正在寻找更有经验的 DBA 的任何建议。

### 样本数据：

```
Parent  2nd Itm#    3rd Itm#    Routing Code   UpdatedColumn
------- ----------- ----------- -------------- -------------
921221  TF2-14511   TF2-14511   PLANNING       1568
921221  TF2-14511   TF2-14511   COAT&CAP       14545
921221  TF2-14511   TF2-14511   S.S 0-OVERLAPS 45556
842568  TF2-14511   TF2-14511   PLANNING       4545 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-07T21:39:00.070

将 Excel 电子表格中的数据加载到 SQL Server 数据库上的临时表中。然后使用查询或存储过程（*最好是存储过程*）来比较暂存表和您要插入或更新数据的目标之间的数据。如果您使用的是 SQL Server 2008 或更高版本，则可以使用**`MERGE`**可以将源表和目标表`INSERT`与`UPDATE`记录进行比较的语句。

[**使用 MERGE 插入、更新和删除数据**](http://msdn.microsoft.com/en-us/library/bb522522%28v=sql.105%29.aspx)

您可以使用 将数据从 Excel 加载到 SQL Server 临时表`Data Flow Task`。在控制流上，您可以`Execute SQL Task`在数据流任务之后放置一个以调用将包含该**`MERGE`**语句的存储过程。

# java - 从面板绘制的复合树中检索单击的组件

> ID：13278478
> 
> 赞同：0
> 
> 时间：2012-11-07T21:23:42.437
> 
> 标签：java, swing, jpanel, mouseevent, paintcomponent

我有一个复合树。我已经通过覆盖将这棵树绘制到一个`JPanel`宽度对象。我的问题是：**如何访问单击了哪个组件？**`Graphics``paintComponent(Graphics gr)`

 **我只想出了琐碎和糟糕的解决方案，所以这就是我求助于你的原因。提前致谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-07T23:16:29.347

您绘制的形状，您需要存储。当您收到鼠标点击事件时：

```
public void mouseClicked(MouseEvent e) { 
```

您将拥有 x 和 y

```
 e.getPoint().getX()
    e.getPoint().getY() 
```

然后，您可以遍历您的形状，并查看 Shape 是否包含上述点。来自 Shape 的 Javadoc：

```
/**
 * Tests if the specified coordinates are inside the boundary of the
 * <code>Shape</code>, as described by the
 * <a href="{@docRoot}/java/awt/Shape.html#def_insideness">
 * definition of insideness</a>.
 * @param x the specified X coordinate to be tested
 * @param y the specified Y coordinate to be tested
 * @return <code>true</code> if the specified coordinates are inside
 *         the <code>Shape</code> boundary; <code>false</code>
 *         otherwise.
 * @since 1.2
 */
public boolean contains(double x, double y); 
```**

# c# - MemoryStream 数据损坏问题

> ID：13278487
> 
> 赞同：0
> 
> 时间：2012-11-07T21:24:11.030
> 
> 标签：c#, wcf, rest, stream, basichttpbinding

我创建了一个简单的基于 REST 的 WCF 服务，它在`BasicHttpBinding`. 在我的一种网络方法中，我返回了一个指向 JSON 响应的 Stream。

该方法看起来像：

```
[OperationContract]
[FaultContract(typeof(ApplicationFault))]
[WebInvoke(Method = "POST", UriTemplate = "GetActiveCalls/{nurseid}")]
Stream GetActiveCalls(string nurseid); 
```

从 的正文中`GetActiveCalls`，我正在创建一个对象`MemoryStream`并返回与响应相同的对象。代码看起来像

```
// Serialize the results as JSON
string jsonResult = new JavaScriptSerializer().Serialize(baseResponses);

// ContentType json
WebOperationContext.Current.OutgoingResponse.ContentType = "application/json";
WebOperationContext.Current.OutgoingResponse.Headers.Add("Cache-Control", "no-cache");
var bytes = Encoding.UTF8.GetBytes(jsonResult);
//Parse to memorystream
var ms = new MemoryStream(bytes);
ms.Seek(0, SeekOrigin.Begin);
ms.SetLength(bytes.LongLength);
return ms; 
```

从客户那里尝试这个时，我得到的结果是

```
{"LastEvents":[{"FormatValues":"Klic 2 3 4","Icon":null,"Color":"Red","Acknowledged":false,"EventID":28566}],"Message":"","Status":true} 
```

但有时在多次调用相同的方法后，我开始得到响应：

```
{"LastEvents":[{"FormatValues":"Klic 2 3 4","Icon":null,"Color":"Red","Acknowledged":false,"EventID":28566}],"Message":"","Statu{"LastEv 
```

您可以`"Statu`在 JSON 响应之后看到，流被重置并从头开始获取数据。

我觉得很奇怪。

*从服务器端，当我放置断点时，似乎`MemoryStream`有正确的响应。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-21T21:57:52.473

抛开是否使用内存流的问题，我最近遇到了一个类似的问题，内存流响应出现损坏，似乎是随机的。这个问题的解决方案是从我在开发模式下打开的 web.config 中删除跟踪部分。这可能是也可能不是您的问题，但可能值得一看。似乎这个问题仍然存在于 .NET 4.5 中。

# ios - iPhone 5：播放视频后视图大小发生变化

> ID：13278488
> 
> 赞同：0
> 
> 时间：2012-11-07T21:24:12.487
> 
> 标签：ios, xcode, ios6, iphone-5

我正在将我开发的旧应用程序更新为新的 iphone 5 屏幕尺寸。我有一个可以垂直拉伸的页面，但我有一个奇怪的问题。

# 问题

目前该页面如下所示：

![在此处输入图像描述](../Images/4f7f2d99c4698e7019fc01532e681350.png)

一切都在正常伸展。如您所见，在顶部我有一个链接到视频的按钮。当您按下此按钮时，我们将调用它的默认 iOS“videoView”会出现并像往常一样播放我的视频。当我按下“完成”按钮退出视频时，这是我返回时页面的样子。

![在此处输入图像描述](../Images/d7e20fdbcd8f2aeaeb6013b825cd8de2.png)

您可以看到视图被水平和垂直拉伸。此视图的弹簧和支柱如下：

![在此处输入图像描述](../Images/8d35f979e608fed8415ac5f5b2fb433c.png)

知道这里可能会发生什么吗？

**编辑**

这是视图层次结构。这是习俗。

![在此处输入图像描述](../Images/46c90314d6498430549a52ae38156e01.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-08T06:07:07.153

Not sure if it is the exact same problem, but I think there is a WWDC 2012 video showing a problem with the evolution of ViewControllers, perhaps it is the same problem you are facing.

The video is : Session 236 - The Evolution of View Controller on iOS

and also the sampling code of this video can be usefull.

To get the video go to you apple developer account and videos are freely downloadable through iTunes.

[Link to WWDC 2012](https://developer.apple.com/wwdc/)

Hope it will help you

**EDIT**

I went quickly through the video and I am not sure it is the same problem as you. However this video explains new iOS6 features in the layout and hierarchy of the view controllers which I hope will help you.

# ios - 将标签正确分配给 uitableview 的单元格和子视图

> ID：13278493
> 
> 赞同：0
> 
> 时间：2012-11-07T21:24:14.550
> 
> 标签：ios, xcode, uitableview, cell

嘿伙计们，我已经连续两天被这个问题困住了，所以我问是否有任何人可以帮助我。

我有一个由 4 个部分组成的表格视图。

第 1 部分 -> 仅由 1 行组成，其中其单元格包含一个子视图，该子视图是一个 uiimageview

第 2 部分 -> 由 2 个普通行组成（只有 2 个简单的单元格，其中包含文本）

第 3 节 -> 由 1 个普通行组成

第 4 节 -> 由 1 行组成，其中的单元格包含一个子视图，该子视图是一个可以包含动态文本的 uitextview，因此 uitextview 的高度以及单元格的高度会根据 uitextview 中的文本量而变化。

这是创建此结构的代码：

```
- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath{

//create a nsstring object that we can use as the reuse identifier
static NSString *CellIdentifier = @"Cell";

//check to see if we can reuse a cell from a row that has just rolled off the screen
UITableViewCell * cell = [tableView dequeueReusableCellWithIdentifier:CellIdentifier];

//if there re no cells that can be reused, create a new cell
if(cell==nil){
    cell = [[UITableViewCell alloc] initWithStyle:UITableViewCellStyleDefault reuseIdentifier:CellIdentifier];

    switch (indexPath.section) {
        case 0:
            cell.selectionStyle = UITableViewCellSelectionStyleNone;
            [cell.contentView addSubview:_viewForImageHeader];

            break;

        case 1:
            cell.selectionStyle = UITableViewCellSelectionStyleGray;
            cell.accessoryType = UITableViewCellAccessoryDisclosureIndicator;

            cell.textLabel.numberOfLines = 0;
            cell.textLabel.lineBreakMode = 0;
            cell.textLabel.font = [UIFont fontWithName:@"AmericanTypewriter" size:16.0];

            break;

        case 2:
            cell.selectionStyle = UITableViewCellSelectionStyleGray;
            cell.accessoryType = UITableViewCellAccessoryDisclosureIndicator;
            cell.textLabel.font = [UIFont fontWithName:@"AmericanTypewriter" size:16.0];
            break;

        default:
            cell.selectionStyle = UITableViewCellSelectionStyleNone;
            [cell.contentView addSubview:_textViewForArticle];

            break;

    }

}
else{

    NSLog(@"in else");

}

//here i fill in the 2 normal cells with text

return cell;

} 
```

当 uitableview 加载（纵向模式）时，一切都很完美（图像在第 1 节，第 2 节和第 3 节包含正确的文本，在第 4 节我有我的动态文本）。但是当我开始旋转应用程序时，所有的单元格都混在一起了。例如，我在第 4 节中找到第 3 节的内容，反之亦然。

我认为这与我可能没有正确重用单元格的事实有关。我应该使用标签吗？如果是，在特定情况下如何实现标签的使用？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-07T21:31:16.393

将`switch`案例置于外部`if`条件 - 之后`if and else`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-07T21:37:15.147

是的，这是因为重复使用单元格。这里有几个选项，但如果这个 tableView 中的单元格永远不会超过 5 个，那么到目前为止，最简单和最优化的解决方案是不重用单元格。换句话说，不是调用“dequeueReusableCellWithIdentifier”，而是每次分配一个新的单元格。

当您有更多单元时，这会降低性能，但如果您的单元是静态的且有限的（就像它们看起来那样），那么尝试重用单元并没有真正的收益。

如果您确实有 4 种“类型”的单元格和更多行（更动态分配的单元格），则解决方案是为 4 种“类型”单元格中的每一种子类 UITableViewCell，然后根据部分或其他调用正确的你的标准是。

# regex - 无法找出正则表达式 bash 或 sed 或 awk

> ID：13278495
> 
> 赞同：0
> 
> 时间：2012-11-07T21:24:19.963
> 
> 标签：regex

我想将以下内容拆分`jdk-1.6.0_30-fcs.x86_64`为`jdk-1.6.0_30`. 我尝试了以下方法`sed 's/\([a-z][^fcs]*\).*/\1/'`，但最终得到`jdk-1.6.0_30-`. 我认为以错误的方式接近它，有没有办法从单词的末尾开始并向后遍历直到遇到`-`？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-07T21:26:46.990

尝试这样做：

```
echo 'jdk-1.6.0_30-fcs.x86_64' | sed 's/-fcs.*//' 
```

如果使用[bash](/questions/tagged/bash "显示标记为“bash”的问题")、[sh](/questions/tagged/sh "显示标记为“sh”的问题")或[ash](/questions/tagged/ash "显示标记为“灰”的问题")，你可以这样做：

```
var=jdk-1.6.0_30-fcs.x86_64
echo ${var%%-fcs*}
jdk-1.6.0_30 
```

后来的解决方案使用*参数扩展*，在Linux和Minix3上测试

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-07T21:27:06.030

不完全是，但您可以使用 . 将模式锚定到字符串的末尾`$`。然后你只需要确保你重复的字符可能不包括连字符：

```
echo jdk-1.6.0_30-fcs.x86_64 | sed 's/-[^-]*$//' 
```

这将从 a 匹配`-`到字符串的末尾，但其间的所有字符都必须与 from 不同`-`（这样它就已经不匹配第一个连字符了）。

稍微详细一点的解释。引擎首先尝试匹配文字`-`。这将首先`-`在字符串中的第一个工作（显然）。然后`[^-]*`匹配尽可能多的非`-`字符，因此它会消耗`1.6.0_30`（因为下一个字符实际上是连字符）。现在引擎将尝试匹配`$`，但这不起作用，因为我们不在字符串的末尾。会发生一些回溯，但我们可以在这里忽略它。最后，引擎将放弃匹配第一个`-`并继续遍历字符串。然后引擎会将文字`-`与第二个匹配`-`。现在`[^-]*`会消耗`fcs.x86_64`。现在我们实际上在字符串的末尾并且`$`将匹配，因此完整匹配（将被删除的是）`-fcs.x86_64`。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-07T21:30:53.783

使用 `cut`>>

```
echo 'jdk-1.6.0_30-fcs.x86_64' | cut -d- -f-2 
```

# haskell - 神秘关闭的把手案例

> ID：13278498
> 
> 赞同：2
> 
> 时间：2012-11-07T21:24:35.150
> 
> 标签：haskell, conduit

首先我会给你代码，然后是错误，然后是一些类型信息。问题是：我怎样才能弄清楚发生了什么？我该如何解决这个问题？

```
readTask = do
   req' <-  parseUrl "https://10.64.251.32/rest/api/latest/issue/BNAP-291"
   manager <- newManager manSettings
   let req'' = applyBasicAuth (pack "sandboxer") (pack "sandboxer") req'
   Response _ _ _ body <-runResourceT $ http req'' manager 
   pBody <- runResourceT $
            body $$+- sinkParser json

   --   print pBody
   --   closeManager manager

   return ()
      where manSettings =
               def
                 { managerCheckCerts = \ _ _ -> return CertificateUsageAccept } 
```

这编译得很好。这是我运行编译后的代码时发生的情况

```
dist/build/Spike/Spike
Spike: <socket: 3>: hGetBuf: illegal operation (handle is closed) 
```

`body`是以下类型

```
Data.Conduit.Internal.ResumableSource
(Control.Monad.Trans.Resource.ResourceT IO)
Data.ByteString.Internal.ByteString 
```

感谢反馈，我不知道如何开始解决此问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-08T20:34:33.557

第一个`runResourceT`调用是在解析主体之前关闭套接字。您需要将这两个`runResourceT`调用合二为一。`ResourceT`是一个`Monad`实例，因此您可以`do`在解析完成后使用符号和一些小手术来释放套接字：

```
readTask = do
   req' <-  parseUrl "https://10.64.251.32/rest/api/latest/issue/BNAP-291"
   manager <- newManager manSettings
   let req'' = applyBasicAuth (pack "sandboxer") (pack "sandboxer") req'
   runResourceT $ do
      Response _ _ _ body <- http req'' manager 
      pBody <- body $$+- sinkParser json
      liftIO $ print pBody

   closeManager manager

   return ()
      where manSettings =
               def
                 { managerCheckCerts = \ _ _ -> return CertificateUsageAccept } 
```

# assembly - 虚拟盒子 vdi Nasm 跳转

> ID：13278499
> 
> 赞同：0
> 
> 时间：2012-11-07T21:24:38.540
> 
> 标签：assembly, x86, virtualbox, nasm, x86-16

我正在研究引导加载程序。也就是说，我正在尝试使用 Nasm 编写简单的引导加载程序，它将在 VB（vdi 磁盘）中运行。现在，我确实设置了一个用于测试目的的 virtualbox 环境，并成功加载了位于绝对地址（HXD 十六进制编辑器）0x2000 上的 MBR。但现在我想跳出 MBR（0x2200 大端）并执行驻留在那里的代码（下面的代码片段不能完成这项工作）。我使用 Nasm 指令 [org 0x7C00]，进行跳转时是否必须使用此偏移量？

```
[BITS 16]
[org 0x7C00]

%define location 0x0022

start:

    mov al, 0x12
    mov ah, 0
    int 0x10

    jmp location:0000

TIMES 510 - ($ - $$) db 0
DW 0xAA55 
```

这是来自 vdi 的十六进制视图（2000h 是 MBR 开始的地方，2200h 是我要跳转的地方）：

![十六进制视图](../Images/6e554a77594cd061914596a1946dc61b.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-07T22:15:24.263

引导扇区将在地址 0x7c00 加载（由于实模式段的特殊性，可以通过多种方式寻址。两个常见的是 0:0x7c00 和 0x7c0:0 - 你不应该依赖特定的一个）。它在磁盘映像中位于偏移量 0x2000 的事实可能是由于所述映像的格式，它与内存地址无关。此外，引导过程只加载一个 512 字节的扇区，如果您需要更多，则必须自己加载。然后你可以跳转到它，使用你加载它的地址。

# java - 初始化类

> ID：13278500
> 
> 赞同：0
> 
> 时间：2012-11-07T21:24:38.540
> 
> 标签：java, class, object, initialization

这是Java代码片段。

```
class A{
   public A() { }
   public A(int i) {   System.out.println(i );    }
}
class B{
   static A s1 = new A(1);
   A a = new A(2);
   public static void main(String[] args){
      B b = new B();
      A a = new A(3);
   }
   static A s2 = new A(4);
} 
```

执行顺序如下：1,4,2,3 因为类的初始化是以这种方式执行的。但是如果去掉`B b = new B();`对象创建，是不是意味着类不会按照上面的顺序初始化呢？最好的祝福

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-07T21:26:47.230

如果您删除`B b = new B()`，则`(A a)`声明为实例变量的引用将不会使用实例初始化`new A(2)`

在类加载时只加载和初始化静态变量。实例变量仅在您实例化您的类时才被初始化。

原因是：-

```
A a = new A(2); 
```

您上面的代码转换为： -

```
A a;  
public B() {
    super();
    a = new A(2);
} 
```

由编译器。编译器提供的默认构造函数在哪里`B()`，因为您没有提供自己的构造函数。如果您已声明自己的构造函数，则初始化将添加到您的每个构造函数。

因此，如果您不实例化您的`B`类，`A a`则不会被初始化，因此`A(int i)`不会调用构造函数。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-07T21:28:17.210

如果您`B b = new B()`从 main 中删除，则只会打印**1,4,3**。

在您的**B 类**中，只有标记为**静态**的对象将被初始化，因为它们不需要**类的实例**来初始化它们。供您的 B 类调用。

```
 A a = new A(2); 
```

您需要创建该类的实例，就像您当前在代码中所做的那样。如果你删除它`A a= new A(2)`不会被调用，输出将是**1,4,3**

# matlab - 构建索引矩阵

> ID：13278504
> 
> 赞同：1
> 
> 时间：2012-11-07T21:24:56.060
> 
> 标签：matlab, matrix, indexing

（首先，标题真的很模糊 - 但我想不出更好的方法来问我的问题。请随时编辑标题，然后删除此注释。）

假设我有一个矩阵`ref`：

```
>> ref
ref = 40 20 90 30 
```

我有一个矩阵`permuted`：

```
>> permuted
permuted = 20 40 30 90 
```

有没有产生`idx`这样的矩阵的操作`isequal(ref, permuted(idx))`？在这种情况下，`idx == [2 1 4 3]`。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-07T21:27:29.553

你需要的是[`ismember`](http://www.mathworks.com/help/matlab/ref/ismember.html)：

```
[tf, idx] = ismember(ref, permuted); 
```

对于您的示例，这确实会产生：

```
idx =
    2     1     4     3 
```

# php - Yii：除一种情况外始终适用的验证规则

> ID：13278505
> 
> 赞同：22
> 
> 时间：2012-11-07T21:25:07.990
> 
> 标签：php, validation, yii, model, yii-validation

我知道您可以拥有仅适用于一种情况的验证规则：

```
array('username', 'exist', 'on' => 'update'), 
```

现在我想知道是否有可能做相反的事情：除了给定的场景之外，每次都适用的规则？

现在看到的唯一解决方案是列出所有其他场景，但如果我们稍后需要添加一些新闻场景，这并不漂亮。

```
array('username', 'exist', 'on' => array('create', 'search', ...),//all the scenarios except update 
```

* * *

## 回答 #1

> 赞同：37
> 
> 时间：2012-11-07T22:30:21.267

从 Yii 1.1.11 开始，您可以使用`except`关键字：

```
array('username', 'exist', 'except' => 'update'), 
```

看看[这个页面](http://www.yiiframework.com/doc/guide/1.1/en/form.model#declaring-validation-rules)。那里有一个小例子。

[文档链接](http://www.yiiframework.com/doc/api/1.1/CValidator#except-detail)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2019-07-04T20:50:40.363

在 Yii 2.0 中以同样的方式工作。

```
['username', 'required', 'except' => 'update'] 
```

数组中验证器名称之前的每个键都是验证器类本身的属性。[您可以在https://www.yiiframework.com/doc/api/2.0/yii-validators-validator](https://www.yiiframework.com/doc/api/2.0/yii-validators-validator)中查看可用的属性

我知道这是一个老问题，但每次我忘记 yii2 在验证器类中有一个 except 属性。

[https://www.yiiframework.com/doc/guide/2.0/en/input-validation](https://www.yiiframework.com/doc/guide/2.0/en/input-validation)了解更高级的技术

# php - php生成随机和不同的数字

> ID：13278511
> 
> 赞同：0
> 
> 时间：2012-11-07T21:25:43.810
> 
> 标签：php, random

我在 php 中创建它以生成随机数

```
> <?php
> 
> $products=array("1","2","3","4","5","6","7","8","9","10");
> 
> for ($i=0;$i<count($products);$i++) {
> 
> $numbers=rand(0,count(products));
> 
> print "".$products[$numbers]."<br>";
> 
> } ?> 
```

我尝试在 bucle 中生成不同的数字，但总是显示相同的数字 1212121212 仅此而已，我如何生成这个字符串或数组，例如最后显示 2 3 4 1 5 6 7 9 8 10 ，如果重新加载脚本其他组合

感谢和问候 ！！！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-07T21:28:55.083

你忘了`$`输入`count($products)`。结果，解析器将其视为字符串`"products"`，其 a`count()`为 1。因此，该`rand()`函数返回零或一，在原始数组中对应于`"1"`and `"2"`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-07T21:29:15.977

尝试使用[shuffle](http://php.net/manual/en/function.shuffle.php)，

```
$products=array("1","2","3","4","5","6","7","8","9","10"); 
shuffle($products);
foreach($products as $v)
 echo $v; 
```

[演示](http://codepad.org/Zg3reZ4P)

# sql-server - 如何在 MSSQL 中表示应用程序中的行和列？

> ID：13278514
> 
> 赞同：3
> 
> 时间：2012-11-07T21:25:52.297
> 
> 标签：sql-server, constraints, sql-server-2012

我有一个显示表格信息并允许用户输入和编辑它的应用程序。我一直在为此进行数据库设计，并遇到了以下问题。

我想避免为应用程序中的每个表创建一个 MSSQL 表，所以我一直试图在两个表中表示所有表。

我已经定义了一个`MyAppTable`具有`Id INTEGER`主键和`Name CHARACTER VARYING(255)`列的表。

从那里，我定义了一个`MyAppColumn`表，其中外键针对该`MyAppTable.Id`列，并且还有一个`Position INTEGER`列来指示其在呈现表中的位置。

最后，我定义了一个`MyAppRow`表，其中针对该`MyAppColumn.Id`列的外键并有一个`Data BINARY(32)`列。这是一个小文件表，所以这种数据类型很合适。

实际的问题是我不能保证`MyAppColumn.Position`每个`MyAppTable`.

一个正常情况的例子：

*   `MyAppTable`与`Id`0
*   `MyAppColumn`与`Id`0, `TableId`0, `Position`0
*   `MyAppColumn`有`Id`1, `TableId`0, `Position`1
*   `MyAppRow``ColumnId`0，[`Data`某事]
*   `MyAppRow`与`ColumnId`1，`Data`[某事]
*   `MyAppTable`有`Id`1
*   `MyAppColumn`有`Id`2, `TableId`1, `Position`0
*   `MyAppRow`与`ColumnId`2，`Data`[某事]

我想在数据库中使不可能的情况示例：

*   `MyAppTable`与`Id`0
*   `MyAppColumn`与`Id`0, `TableId`0, `Position`0
*   `MyAppColumn`有`Id`1, `TableId`0, `Position`0

如您所见，我想要某种方式来约束一对列。这两列应该是`TableId`，但如果这是独立完成的，这将意味着两个表永远不会有列都为 0。`Position``UNIQUE``Position`

如何在 Microsoft SQL Server 2012 中完成此操作？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-07T21:34:38.927

您的问题的解决方案是不在表中编码元数据，而是创建实际表，即使它不方便或需要大量工作。

一些很快就会在后面咬你的东西：

*   没有关系可以建模
*   没有办法索引
*   没有输入验证（是日期、整数还是图像？）
*   无法获得实际准确的统计数据
*   **你写的每一个查询都将是一场噩梦**

将来为自己节省大量时间和精力，现在就在设计阶段制作实际的表格。 [这种类型的元数据“神表”被反复尝试，始终没有奏效。](http://c2.com/cgi/wiki?GodTable)

**话虽这么说，**如果您代表的数据集非常有限（就像您说的，仅用于文件），我会考虑使用坐标系。

保持`MyAppTable`原样。

创建一个`MyAppFile`包含字段的表：

*   FileId（整数身份）
*   `MyAppTableId`(FK)
*   `Data`（变量二进制）
*   `XPos`（整数）
*   `YPos`（整数）

在 上具有唯一约束`(MyAppTableId, Xpos, Ypos)`。

这更准确地代表了您尝试存储的内容，更易于维护，并允许您强制执行完整性。

# javascript - 前端：underscore.js 或 async.js 通过 browserify？

> ID：13278515
> 
> 赞同：6
> 
> 时间：2012-11-07T21:26:02.887
> 
> 标签：javascript, node.js, underscore.js

因此，如果您是后端 node.js 开发人员，您将了解名为[async](https://github.com/caolan/async)的很棒的库。

如果您是前端开发人员，您会知道名为[underscore](http://underscorejs.org/)的很棒的库。

* * *

现在的问题是，这两个库都倾向于在某种程度上提供相似的功能。

[所以问题是，使用browserify](https://github.com/substack/node-browserify)在前端使用 async 有意义吗？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-11-25T11:56:27.200

`Underscore`是一个实用程序库，提供了一些有用的功能`each`，如`map`和`reduce`。但是，所有这些都是同步工作的。例如

```
var results = _.map([1,2,3], function(value, index, list) {
  return value * 2;
});

console.log(results); 
```

输出：[2、4、6]

如果您注意到，`console.log(results)`只有在`_.map()`函数完全执行并返回结果后才会调用该语句。这是您在浏览器脚本中使用的典型同步编程风格。

在服务器上，`Node.js`王者在哪里，上面的同步编程对事件循环是有害的。在那里，异步编程风格是首选。看看使用该库的相同`map`方法。`async`

```
async.map([1,2,3],
        function mapper(item, callback) {
            callback(null, item * 2);
        },
        function(error, results) {
            console.log(results);
        }
); 
```

输出：[2、4、6]

如果您注意到，它不会将映射数组作为返回值返回，而是将映射数组传递给回调函数，并`console.log(results)`用于在回调内部打印结果。

这种编程风格的一个副作用是`iterator`函数被并行调用，而不是按串行顺序调用，因此如果迭代器函数使用任何 I/O，则可以实现更高的可伸缩性。

因此，尽管`async`library 提供的某些功能与 提供的功能相似`Underscore`，但它们的用途不同，如上所示。现在，决定使用哪些取决于您的应用程序要求和编程风格。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-07T21:27:47.453

根据[异步自述文件](https://github.com/caolan/async "Asyc Github")，它可以直接在浏览器中使用。使用browersify 似乎过分了。

# c - 双叉导致原始父级中的套接字断开

> ID：13278521
> 
> 赞同：2
> 
> 时间：2012-11-07T21:26:18.093
> 
> 标签：c, linux, sockets, fork

我在一个进程中做了一个双叉（叉子，然后孩子再次叉子，我等待孩子，孙子由 init 处理），在孩子关闭后，我尝试从我在父母中打开的套接字读取前叉。每次运行程序时读取都会失败。

消息正在使用 sendto() 发送，它返回 ENOENT 错误代码。

这应该有效还是我[10]？

这是 fork 函数中的代码：

```
uint8_t
upgrade(
        char *server,
        char *file)
{
    pid_t pid1, pid2;

    int status;

    if ((pid1 = fork()) < 0)
    {
        /* Fork error */
        log("FAILED: First fork() failed");
    }
    else if (pid1 == 0)
    {
        /* First child */
        if ((pid2 = fork()) < 0)
        {
            /* Fork error */
            log("FAILED: Second fork() failed");

            exit(0);
        }
        else if (pid2 == 0)
        {
            /*
                        execl("/usr/sbin/system_upgrade",
                                    "system_upgrade", NULL);
             */
            exit(0);
        }
        else
        {
            /* Second parent ie. First child
             * Note: Exit cleanly so that second child
             * gets reparented to init, and we avoid a zombie process */

            exit(0);
        }
    }
    else
    {
        /* First parent, wait for first child to exit */
        if (waitpid (pid1, &status, 0) != pid1)   
        {
            log("FAILED: waitpid() failed");
        }

    } /* FORK */

    return OK;
} 
```

编辑：删除额外的括号，固定缩进，再次将其标记为代码

# c# - 如何在 TreeView 中仅添加一个级别的上下文菜单

> ID：13278522
> 
> 赞同：0
> 
> 时间：2012-11-07T21:26:26.837
> 
> 标签：c#, .net, wpf, xaml, mvvm

我有一个 TreeView，其中包含多个级别的`TreeViewItems`.

我想为 TreeView 中的一级项目添加一个上下文菜单。但是，我的代码会产生一个结果，即 TreeView 中的每个项目都有一个上下文菜单。

这是我的代码：

```
//.... foreach item in this level.... 

{
ContextMenu cmDatabase = new ContextMenu();
MenuItem menuItem = new MenuItem();
menuItem.Header = "Close Connection";
Image imgMenuIcon = new Image();
imgMenuIcon.Source = new BitmapImage(new Uri("icon.png"));
menuItem.Icon = imgMenuIcon;
cmDatabase.Items.Add(menuItem);
treeViewItem.ContextMenu = cmDatabase;
} 
```

我还尝试手动将所有其他 TreeViewItems 的 contextMenu 属性设置为 null。虽然没有运气。有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-07T21:35:49.360

有`TreeView`一个`ContextMenuOpening`事件。将`Handled`事件处理程序参数的属性设置`e`为`true`取决于树级别。这将丢弃上下文菜单。

```
private void treeView1_ContextMenuOpening(object sender, ContextMenuEventArgs e)
{
    e.Handled = <tree level does not require a context menu>;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-07T21:38:30.773

如果您的 TreeViewItem 有一个 TextBlock，则可以将 ContextMenu 附加到它上面。

```
 Textblock header = "TreeViewItem Text";
 header.ContextMenu = cmDataBase;
 treeViewItem.Header = header; 
```

另外，对于我回答的其他问题，但在我点击保存之前您已删除。:P 我会将右键单击作为事件（也在标题上）。

```
 header.MouseRightButtonDown += new MousebuttonEventHandler(rightClickSelection);

 private void rightclickSelection(object sender, MouseButtonEventArgs e) {
      TreeViewItem clickedParent = (sender as TextBlock).Parent as TreeViewItem;
      clickedParent.IsSelected = true;
      clickedParent.UpdateLayout();
 } 
```

# php - 如何在 wordpress 中将 PHP jQuery 文件排入队列？

> ID：13278523
> 
> 赞同：1
> 
> 时间：2012-11-07T21:26:31.287
> 
> 标签：php, jquery, wordpress, initialization

我在我的 wordpress 管理面板中有一个图像滑块的设置，可让您更改过渡效果和速度等内容。这些设置（php 变量）被传递给滑块的标准初始化脚本，如下所示：

```
<script>
jQuery(function(){

    jQuery('#camera_wrap_3').camera({
        height: '40%',
        thumbnails: true,
        time: <?php echo $pause_time; ?>,
        fx: '<?php echo $transition_effect; ?>',
        transPeriod: <?php echo $transition_speed; ?>,
        autoAdvance: <?php echo $auto_advance; ?>,
        minHeight: '50px',
        mobileNavHover: false,
        imagePath: '<?php echo get_template_directory_uri(); ?>/images/'
    });
}); 
```

我选择将其保存为单独的 php 文件以清理代码。

我的问题是，我需要将 wp_head() 直接放在结束 </head> 标记之前，当我这样做时，在加载 jQuery 之后无法实现上述脚本，因此它不起作用，滑块也不起作用工作。

我已经尝试用一个动作钩子附加它，就像我用一个 js 文件一样：

```
<?php function add_camera_init() {
require_once('includes/sliders/camera/camera-init.php');
}
add_action('wp_enqueue_scripts', 'add_camera_init'); ?> 
```

但这似乎没有做任何事情。

如何在 jQuery 之后添加这样的设置并且在 < /head> 之前仍然有 wp_head() ？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-07T21:39:14.593

尝试`add_action('wp_print_footer_scripts','add_camera_init');`

# css - 循环结束时的无限动画关键帧和 z-index 问题

> ID：13278524
> 
> 赞同：4
> 
> 时间：2012-11-07T21:26:44.283
> 
> 标签：css, css-animations

我有一些动画，希望最终能组成一个漂亮的纯 CSS[复古翻转时钟](https://www.google.de/search?num=10&hl=en&site=vintage&tbm=isch&source=hp&biw=1280&bih=715&q=vintage+flip+clock&oq=vintage+flip+clock)。

基本上我将数字分成两部分，并在 X 轴上以 180° 旋转为这两个部分设置动画。

```
╔═══════╗   
║   ##  ║   
║  ###  ║   
║ # ##  ║  
║   ##  ║ 
╠═══════╣   
║   ##  ║   
║   ##  ║     
║   ##  ║     
║  #### ║   
╚═══════╝ 
```

但是，由于关键帧的无限循环，我的 z-index 存在问题 - 在循环结束时，错误的数字位于顶部，因此在短时间内显示了错误的数字。

我有两个演示版本的动画（目前只有 webkit 前缀）：

[z-index 预先声明](http://jsfiddle.net/Ddsvu/4/)

[重新排序的标记](http://jsfiddle.net/wwThL/)

第一个在动画循环中使用 z-index，后一个使用图形的自然排序（因此是默认的 z-index）。

```
<div class="nr">
    <div class="top t0">0</div>
    <div class="bottom b0">0</div>
    <!-- 1 to 9 -->
</div> 
```

关键帧如下（第一个示例）：

```
.top{
    -webkit-transform-origin:50% 100%; 
    -webkit-animation-name: flipT;
}
.bottom{
    -webkit-transform-origin:50% 0;
    -webkit-animation-name: flipB;
    -webkit-transform: rotateX(180deg);
}

@-webkit-keyframes flipT {
    from{-webkit-transform:rotateX(0deg)    }
    10% {-webkit-transform:rotateX(-180deg);}
    90% {-webkit-transform:rotateX(-180deg);}
    91% {-webkit-transform:rotateX(0deg);   }
}
@-webkit-keyframes flipB {
    from{-webkit-transform:rotateX(180deg);z-index:100;}
    10% {-webkit-transform:rotateX(0deg);  }
    11% {z-index:0;}
    20% {-webkit-transform:rotateX(0deg);  }
    21% {-webkit-transform:rotateX(180deg);}
} 
```

如果您想知道为什么它们看起来如此奇怪 - 这是为了防止进一步的动画会导致闪烁 - 您可以通过将视角更改为一些低值来看到这一点。

您将在循环结束时看到 z-index 问题。上述演示之一也有一些闪烁。你知道如何解决这个问题吗？我似乎无法解决这个问题。

^(旁注：SASS 是否在`@keyframe`指令上窒息，因为当我将 CSS 面板切换到 SCSS 时动画不会播放？)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-19T22:12:19.440

干得好：

[http://jsfiddle.net/2TAc4/](http://jsfiddle.net/2TAc4/)

这是您发布的两者的组合。对于自然排序，它们都具有相同的索引。所以使用这个概念，我们在 0、1 和 2 之间切换。

我放慢了速度（很有帮助）并使用背景颜色来查看帧的变化。

这是关键部分：

```
@-webkit-keyframes flipT {
    from{-webkit-transform:rotateX(0deg); z-index:1;}
    10% {-webkit-transform:rotateX(-180deg);}
    90% {-webkit-transform:rotateX(-180deg);}
    91% {-webkit-transform:rotateX(0deg); z-index:0;}
}
@-webkit-keyframes flipB {
    from{-webkit-transform:rotateX(180deg); z-index: 2;}
    10% {-webkit-transform:rotateX(0deg);}
    18% {-webkit-transform:rotateX(0deg);}
    19% {-webkit-transform:rotateX(180deg); z-index: 0;}
} 
```

这是最终版本：

[http://jsfiddle.net/S6EMe/](http://jsfiddle.net/S6EMe/)

# android - 安卓 ksoap 网络服务

> ID：13278527
> 
> 赞同：0
> 
> 时间：2012-11-07T21:26:50.077
> 
> 标签：android, ksoap2

我在`comunicate`使用`ksoap`android 的网络服务时遇到问题。这个想法是接收一个`JSON`字符串，然后对该字符串进行一些解析。我打开了我的 Web 服务表单 Eclipse Web 服务资源管理器，服务器端似乎一切正常，提供给请求的参数是正确的。

我的错误：

```
SoapFault - faultcode: 'soapenv:Server' faultstring: '3' faultactor: 'null' detail: org.kxml2.kdom.Node@b75ddd60 
```

[SOAP 错误代码](http://www.w3.org/TR/2000/NOTE-SOAP-20000508/#_Toc478383507)表明它是服务器错误，但正如我上面所说，它在 Eclipse Web 服务资源管理器中运行良好。

我的代码：

```
private static final String method_get_quest_by_id = "getQuestionsById";
private static final String NAMESPACE = "http://surveys.services.backend.capi.ateam";
private static final String retirieveQuestById = NAMESPACE
        + method_get_quest_by_id;
private static String url = "http://ec2-184-73-10-139.compute-1.amazonaws.com:8080/Services/services/SurveyService";

try{
       SoapObject request = new SoapObject(NAMESPACE,method_get_quest_by_id);
       SoapSerializationEnvelope envelope = new SoapSerializationEnvelope(SoapEnvelope.VER11);
       request.addProperty("userName", userName);
       request.addProperty("password", pass);
       request.addProperty("id", id);
       envelope.setOutputSoapObject(request);
       HttpTransportSE androidHttpTransport = new HttpTransportSE(url);
       androidHttpTransport.call(retirieveQuestById, envelope);
       Object result = envelope.getResponse();
       resultString= result.toString();
   } catch (Exception E) {
       E.printStackTrace();
   } 
```

我正在使用 android 2.2。

有人可以帮帮我吗？我已经坚持了几天了...谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-17T16:08:37.637

最后我找到了问题的原因。当它应该是“标识符”时，我将“id”作为参数名称传递。

花了很长时间才发现问题可能是因为故障字符串没有太大帮助。我的猜测是 faultstring = "3" 表示参数 3 有问题。

# mysql - 加入 3 个表以在两个日期之间返回每个用户的问卷（我的挑战性查询）

> ID：13278535
> 
> 赞同：2
> 
> 时间：2012-11-07T21:27:08.703
> 
> 标签：mysql, sql

我将在这里尽可能简短和切入正题。这些是我的表：

**问卷：**

*   身份证[PK]，
*   姓名，
*   类型

**user_x_questionnaire：**

*   身份证[PK]，
*   用户名 [fk],
*   问卷ID[fk 参考问卷.id]
*   完成状态，
*   迭代

**问卷调查时间**

*   编号[pk]
*   问卷ID[fk 参考问卷.id]
*   迭代
*   发布日期[日期/时间]
*   截止日期[日期/时间]

所以，用户想要填写一些问卷。可以为每个用户分配一份或多份问卷以填写 (user_x_questionnaire)。根据问卷类型（一次或频繁），用户可以多次填写每个问卷，因此问卷调查表存储每个时间的发布日期和截止日期。

我想要的是一个显示用户应该回答的所有当前问卷的查询。这意味着问卷的时间应该在发布日期和截止日期之间。我非常接近这个查询的答案，直到我意识到我返回的所有结果都产生了相同的发布和截止日期，这不是我想要的。到目前为止，这是我的解决方案。

```
SELECT * FROM (
   SELECT DISTINCT questionnaire.id
        , questionnaire.`name`
        , user_x_questionnaire.iteration
        , completedstate
        , questionnaire_time.publishdate
        , questionnaire_time.deadline
   FROM user_x_questionnaire
      , questionnaire_time
      , questionnaire 
   WHERE  userid={USERID} 
      AND user_x_questionnaire.questionnaireid=questionnaire.id
      AND questionnaire.`type`='frequent' 
      AND user_x_questionnaire.questionnaireid=questionnaire_time.questionnaireid
   ) As result
WHERE '{CURRENT DATE}' BETWEEN publishdate AND deadline; 
```

{USERID} 和 {CURRENT DATE} 将由程序提供。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-07T22:39:55.227

这应该会显示所有活动的问卷，即使 {USER} 没有回复：

```
SELECT q.id, q.`name`, u.iteration, u.completedstate, t.publishdate, t.deadline
FROM questionnaire q
  INNER JOIN questionnaire_time t 
          ON t.questionnaireid = q.id
    LEFT JOIN user_x_questionnaire u 
           ON u.questionnaireid = t.questionnaireid
          AND u.userid={USERID} 
WHERE q.`type`='frequent' 
  AND '{CURRENT DATE}' BETWEEN t.publishdate AND t.deadline; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-08T21:40:19.227

最后！

```
select distinct q.id,
q.`name`,
uq.iteration,
completedstate,
qt.publishdate,
qt.deadline
from questionnaire_time qt,questionnaire q, user_x_questionnaire uq 
where qt.questionnaireid = q.id 
and qt.questionnaireid = uq.questionnaireid 
and uq.userid="{USERID}" 
and '{CURRENT DATE}' between qt.publishdate and qt.deadline 
group by q.id 
```

# android - 使用intent显示二维码时，是否可以更改ZXing的背景？

> ID：13278541
> 
> 赞同：2
> 
> 时间：2012-11-07T21:27:37.350
> 
> 标签：android, zxing

我想使用 ZXing 生成 QR 码并将其显示在屏幕上，但是我要求 QR 码显示在特定背景 [图像] 上。ZXing可以吗？

谢谢

编辑：能够将状态栏标题从纯文本 [我正在使用 TYPE_TEXT] 更改为其他内容也很棒。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-07T21:45:04.277

只需[使用库创建条形码图像](https://stackoverflow.com/questions/11697001/android-zxing-get-barcode-image)并将其显示在您自己的活动中即可。你可以随心所欲地设计它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2021-05-16T14:33:36.370

这是如何使用 ZXING 库创建透明二维码的示例：

```
 QRCodeWriter qrCodeWriter = new QRCodeWriter();
        // create output image
        BufferedImage image = new BufferedImage(382, 382, BufferedImage.TYPE_INT_ARGB);
        // create bit matrix
        BitMatrix bitMatrix = new MultiFormatWriter().encode(
                qrCodeString,
                BarcodeFormat.QR_CODE, 382, 382);
        // set pixels of output image based of bit matrix (black or translucent)
        for (int i = 0; i < 382; i++) {
            for (int j = 0; j < 382; j++) {
                image.setRGB(i,j, bitMatrix.get(i,j) ? Color.BLACK.getRGB() : Color.TRANSLUCENT);
            }
        }
        // write output image as png
        ByteArrayOutputStream outputStream = new ByteArrayOutputStream();
        ImageIO.write(image, "PNG", outputStream); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-08T00:17:10.040

没有办法。通常，条形码周围需要一个安静的白色区域，因此您通常不想这样做。如果你真的需要这种情况，你可以编写自己的布局并嵌入与显示相同的代码。

# hibernate - 使用休眠 @NamedNativeQuery 返回数值

> ID：13278544
> 
> 赞同：3
> 
> 时间：2012-11-07T21:27:50.457
> 
> 标签：hibernate, jpa

我有这个问题：

“...如果查询只返回一个数字（即，查询类似于'select count(id) where.....）我遇到了这个错误

*org.hibernate.cfg.NotYetImplementedException：尚不支持纯本机标量查询*“

有关更多详细信息，请参阅：[http ://atechnicaljourney.wordpress.com/2012/09/30/hibernate-pure-native-scalar-queries-are-not-yet-supported/](http://atechnicaljourney.wordpress.com/2012/09/30/hibernate-pure-native-scalar-queries-are-not-yet-supported/)

我不想有一个包装类，尤其是没有一些额外的表格。这样做的正确方法是什么？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-26T15:36:18.737

面临“尚不支持纯本机标量查询”。我需要运行以查询名称作为参数的计数查询，其中一个查询必须是本机 SQL。能够通过创建假实体来克服：

```
import javax.persistence.Column;
import javax.persistence.Entity;
import javax.persistence.Id;

/**
 * Simple wrapper entity work around for the limited hibernate pure native query
 * support. Where an HQL query is not possible
 */
@SuppressWarnings("serial")
@Entity
public class CountDTO  extends Number {

    @Id
    @Column(name = "COUNT")
    private Long count;

    @Override
    public double doubleValue() {
        return count.doubleValue();
    }

    @Override
    public float floatValue() {
        return count.floatValue();
    }

    @Override
    public int intValue() {
        return count.intValue();
    }

    @Override
    public long longValue() {
        return count.longValue();
    }

} 
```

然后我设置`resultClass = CountDTO.class`

```
@NamedNativeQueries({
    @NamedNativeQuery (name="postIdSecurity",
            query="select count(...) ...", resultClass = CountDTO.class)
}) 
```

并得到计数：

```
 ((Number) getEntityManager().createNamedQuery(qryName).
setParameter(...).getSingleResult()).longValue() 
```

学分转到：http: [//jdevelopment.nl/hibernates-pure-native-scalar-queries-supported/#comment-1533](http://jdevelopment.nl/hibernates-pure-native-scalar-queries-supported/#comment-1533)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2018-03-26T10:31:47.983

您实际上可以通过以下方式执行此操作：

```
@NamedNativeQueries({
        @NamedNativeQuery(
                name = "countAll",
                query = "select count(*) from MyTable"
        )
})
public class MyTable ...

// execute like this:
((BigInteger) manager.createNamedQuery("countAll").getSingleResult()).intValue(); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-11-08T09:58:13.267

我做了一个使用 createQuery() 的工作：http: [//docs.jboss.org/hibernate/core/3.6/reference/en-US/html/objectstate.html#objectstate-querying](http://docs.jboss.org/hibernate/core/3.6/reference/en-US/html/objectstate.html#objectstate-querying)

# tfs - 我们如何使用 MTM 执行测试用例

> ID：13278546
> 
> 赞同：0
> 
> 时间：2012-11-07T21:27:51.660
> 
> 标签：tfs, microsoft-test-manager, tfs-2012

我正在使用 VS 2012、TFS 和 MTM。我在 MTM 中手动创建了测试用例。当我尝试运行测试用例时，它不会启动浏览器。请让我知道需要做什么。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-08T22:29:53.263

MTM 不会为您启动浏览器。我建议您进行干净的测试\记录：

1.  打开浏览器并导航到站点
2.  X 执行测试的步骤数
3.  重置并关闭浏览器

这样，当您从记录中生成 CodedUI 测试时，您会得到一些可以轻松自动化的东西。

# php - 将图像数组链接到 url

> ID：13278549
> 
> 赞同：0
> 
> 时间：2012-11-07T21:28:02.733
> 
> 标签：php, arrays, image, hyperlink

如何将下面数组中的每个图像链接到不同的页面？该阵列在网站上显示各种横幅。我希望每个横幅都链接到网站上的不同页面。例如 small_header_01.jpg 链接到 aboutus.html

```
$banner_small_images = array('small_header_01.jpg',
                             'small_header_02.jpg',
                             'small_header_03.jpg',
                             'small_header_04.jpg',
                             'small_header_05.jpg'); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-07T21:40:40.517

要建立链接，您需要链接位置吗？而且您的阵列不提供链接位置。但你可以解决这个问题。

为此，您可以像这样构建数组：

```
 $links = array(
    'www.link01.com' => 'small_header_01.jpg',
    'www.link02.com' => 'small_header_02.jpg',
    'www.link03.com' => 'small_header_03.jpg',
    'www.link04.com' => 'small_header_04.jpg',
    'www.link05.com' => 'small_header_05.jpg',
); 
```

现在您有了一个数组，其中包含具有适当链接位置的图像。您将链接位置存储在数组键中，并将图像位置存储在数组值中。

从那里您可以遍历所有数组项并打印您的链接，如下所示：

```
foreach($links as $link => $image) {
    echo "<a href='http://{$link}'><img src='{$image}'></img></a><br />";   
} 
```

或者您可以使用两个数组，一个包含链接，另一个包含图像，然后将它们组合起来。

希望这可以帮助！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-07T21:38:18.447

有很多方法可以做到这一点。一种方法是创建另一个链接数组，然后使用 array_combine 创建一个包含链接 => 图像的新数组。然后，当您循环访问时，您可以将键和值绑定在一起，以随心所欲地使用。就像是：

```
foreach($newarray as $key => $value){
  print '<a href="'.$key.'"><img src="'.$value.'"/></a>';
} 
```

# ruby-on-rails - 更新 has_many 关系的属性

> ID：13278550
> 
> 赞同：1
> 
> 时间：2012-11-07T21:28:03.193
> 
> 标签：ruby-on-rails, ruby

我正在打印用户联系人列表，并希望用户能够将每个联系人标记为“完成”。（基本上将它们从他们的待办事项列表中标记出来）。

如何更新特定联系人的 :done 属性？

这是带有隐藏字段的表单不起作用：

```
<% if current_user.contacts.any? %>
<% current_user.contacts.each do |c| %> 
    <li id="<%= c.id %>">
        <%= c.name %><br/>

        <%= form_for(@contact) do |f| %>
            <%= f.hidden_field :done, :value=>true %>
            <%= f.submit "Mark as done", class: "btn btn-small btn-link"%>
        <% end %>

    </li>
<% end %> 
```

我收到此错误：

```
Template is missing Missing template contacts/create, application/create with {:locale=>[:en], :formats=>[:html], :handlers=>[:erb, :builder, :coffee]}. Searched in: * "C:/Sites/rails_projects/sample_app/app/views" 
```

这是我的联系人控制器：

```
def create
  @contact = current_user.contacts.build(params[:contact])
  if @contact.save
    flash[:success] = "Contact saved!"
    redirect_to root_url
  else
    flash[:error] = "Something is wrong"
  end
end 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-07T21:31:06.373

由于某种原因，可能由于验证规则，`@contact`无法保存对象。在这种情况下，`else`您的 create 操作中的分支未指定要呈现的内容，因此它正在寻找`create`模板。假设您的新操作不需要预加载其他数据，您也许可以简单地在`render :action => :new`or中添加一行。`redirect_to :action => :new`

```
else
  flash[:error] = "Something is wrong"
  redirect_to :action => :new
end 
```

您也可以使用而不是显式重定向，如果发现错误`respond_with`，它将呈现操作：`new`

```
def create
  @contact = current_user.contacts.build(params[:contact])
  if @contact.save
    flash[:success] = "Contact saved!"
  else
    flash[:error] = "Something is wrong"
  end
  respond_with @contact, :location => root_url
end 
```

# javascript - Chrome历史记录页面覆盖在每次页面加载时触发？

> ID：13278551
> 
> 赞同：1
> 
> 时间：2012-11-07T21:28:04.607
> 
> 标签：javascript, google-chrome, google-chrome-extension

我正在编写一个[覆盖](http://developer.chrome.com/extensions/override.html)默认 Chrome 历史记录页面的扩展程序。

自定义历史页面在加载时会进行一些数据库调用。

我发现我在 background.html 覆盖页面中拥有的 history.js 文件在每次页面加载时都会被调用（即，不仅仅是当用户打开历史页面时）

这是有问题的，因为它会导致不必要的数据库调用，有时还会导致调用历史页面但未显示的其他错误。

谁能验证这是 Chrome 的预期行为（出于某种我不明白的原因），我需要找到一种方法来防止 history.js 在未显示历史页面时进行 db 调用？

或者，有谁知道我可能做错了什么会导致 history.js 在每次页面加载时被调用？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-07T21:41:52.917

叹息，这是因为我误解了如何配置我的 manifest.json 文件。

根据覆盖页面的说明，我有：

```
 "chrome_url_overrides": {"history": "history.html"} 
```

...但我也将 history.js 列为“content_scripts”成员。“content_scripts”中的任何内容都会在页面加载时被调用（当然，如果有问题的页面与您指定的“匹配”正则表达式匹配......我的设置为在任何非 https 页面上触发）

对困惑感到抱歉！

又名

# sql - 使用 SQL 按周分组

> ID：13278552
> 
> 赞同：13
> 
> 时间：2012-11-07T21:28:08.100
> 
> 标签：sql, tsql

我有以下内容：

[http://sqlfiddle.com/#!6/226ae/1](http://sqlfiddle.com/#!6/226ae/1)

我现在尝试为一年中的每一周添加一行，并相应地过滤联系人。CONTACTS 有一个日期时间列。新表将如下所示：

```
 Status 1    Status 2    Status 3
Week 1      3          4           2
Week 2      1          5           3
Week 3      2          2           4 
```

我认为需要使用 DATEADD，但是我不知道如何开始更改我的查询。

我知道 MySQL 有一个 GROUP BY WEEK 命令，但我不认为 SQL 有一个等价的命令。实现这一目标的最佳方法是什么？

* * *

## 回答 #1

> 赞同：37
> 
> 时间：2012-11-07T21:49:34.437

[`DATEPART()`](http://msdn.microsoft.com/en-us/library/ms174420.aspx)如果您的数据跨越多年，您可以使用，按周和年分组：

```
SELECT 
    'Week ' + cast(datepart(wk, created) as varchar(2)) Week,
    SUM(case WHEN status = 1 then 1 else 0 end) Status1,
    SUM(case WHEN status = 2 then 1 else 0 end) Status2,
    SUM(case WHEN status = 3 then 1 else 0 end) Status3,
    SUM(case WHEN status = 4 then 1 else 0 end) Status4,
    SUM(case WHEN status = 5 then 1 else 0 end) Status5
FROM contacts
group by datepart(wk, created), year(created) 
```

请参阅[带有演示的 SQL Fiddle](http://sqlfiddle.com/#!6/226ae/11)

将年份添加到最终结果中：

```
SELECT 
    'Week ' + cast(datepart(wk, created) as varchar(2)) Week,
    year(created) year,
    SUM(case WHEN status = 1 then 1 else 0 end) Status1,
    SUM(case WHEN status = 2 then 1 else 0 end) Status2,
    SUM(case WHEN status = 3 then 1 else 0 end) Status3,
    SUM(case WHEN status = 4 then 1 else 0 end) Status4,
    SUM(case WHEN status = 5 then 1 else 0 end) Status5
FROM contacts
group by  datepart(wk, created), year(created) 
```

请参阅[带有演示的 SQL Fiddle](http://sqlfiddle.com/#!6/8fe9c/1)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-07T21:46:30.173

您可以使用[该`datepart`函数](http://msdn.microsoft.com/en-us/library/ms174420.aspx)从日期中提取星期。

查询变为：

```
SELECT datepart(week, created) as week,
  SUM(case WHEN status = 1 then 1 else 0 end) Status1,
  SUM(case WHEN status = 2 then 1 else 0 end) Status2,
  SUM(case WHEN status = 3 then 1 else 0 end) Status3,
  SUM(case WHEN status = 4 then 1 else 0 end) Status4,
  SUM(case WHEN status = 5 then 1 else 0 end) Status5
FROM contacts
group by datepart(week, created) 
```

SqlFiddle：[http ://sqlfiddle.com/#!6/226ae/6tsq](http://sqlfiddle.com/#!6/226ae/6tsq)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-07T21:39:12.067

您可以尝试在查询中使用 group by 子句：

```
SELECT
    DATE_FORMAT( created, '%u' ) week_number,
    SUM(case WHEN status = 1 then 1 else 0 end) Status1,
    SUM(case WHEN status = 2 then 1 else 0 end) Status2,
    SUM(case WHEN status = 3 then 1 else 0 end) Status3,
    SUM(case WHEN status = 4 then 1 else 0 end) Status4,
    SUM(case WHEN status = 5 then 1 else 0 end) Status5
FROM contacts
GROUP BY DATE_FORMAT( created, '%u' ) 
```

我假设你在谈论mysql。

DATE_FORMAT 函数记录在这里：
[http ://dev.mysql.com/doc/refman/5.5/en/date-and-time-functions.html#function_date-format](http://dev.mysql.com/doc/refman/5.5/en/date-and-time-functions.html#function_date-format)

# iphone - setValue:forKey: 带有 NSString

> ID：13278556
> 
> 赞同：2
> 
> 时间：2012-11-07T21:28:22.760
> 
> 标签：iphone, objective-c, nsstring

我目前正在开发一个小型且特定的 iPhone 应用程序来连接到服务器并下载一些 JSON 数据。我的问题是关于我用来保存一些数据（服务器的登录名、密码和域）的属性列表。我在 Xcode 中轻松创建了 plist，但是当我尝试使用用户输入的文本对其进行编辑时，我遇到了问题，我不知道如何解决它......

这是`textFieldDidEndEditing: method`我尝试写入 plist 的内容，其中包含用户在 domainTextField 中写入的内容：

```
- (void)textFieldDidEndEditing:(UITextField *)textField
{

    NSArray *paths = NSSearchPathForDirectoriesInDomains (NSDocumentDirectory, NSUserDomainMask, YES);
    NSString *filepath = [NSString stringWithFormat:@"%@/userInfo.plist", [paths objectAtIndex:0]];
    NSMutableDictionary *userInfo = [[NSMutableDictionary alloc] initWithContentsOfFile:filepath];

    if (self.domainTextField) {
        NSString *domain = [NSString stringWithFormat:@"%@", self.domainTextField.text];
        [userInfo setValue:domain forKey:@"domain"];
    }

    if ([userInfo writeToFile:filepath atomically:TRUE]) {
        NSLog(@"write succeeded");
    } else {
        NSLog(@"write failed");
    }
} 
```

我总是在这里收到“写入失败”错误，在使用调试器玩了一下之后，我发现问题出在`setValue:forKey: method`. 事实上，我希望这个方法在 plist 中写：`domain = "whateverthedomainis"`因为`domain`是一个 NSString 但它写的是 : `domain = whateverthedomainis`。由于 writeToFile:atomically: 方法确保所有对象都是属性列表对象，因此它返回 NO。我试图放反斜杠，但这没有帮助。

我能做些什么来解决这个错误？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-07T21:46:17.663

如果您在字符串中有任何参数，StringWithFormat 将使用，因此您可以直接分配字符串值，就像这样

```
NSString *domain = self.domainTextField.text; 
```

# c# - 如何将参数发送到记分牌

> ID：13278558
> 
> 赞同：0
> 
> 时间：2012-11-07T21:28:58.343
> 
> 标签：c#, parameters

在我为自行车比赛构建的应用程序中，当骑自行车的人越过终点线时，我必须输入时间（小时、分钟、秒）并单击完成按钮。单击完成按钮后，我希望此信息在 lblScoreboard 中显示为：

1 号自行车竞技选手已于 1:23:49 完成

然后进入另一个骑车人的时间，lblScoreboard 应该如下所示：

1 号
自行车选手在 1:23:49 完成比赛 9 号选手在 1:20:30 完成比赛

我在“完成”按钮中使用的代码是：

```
lblCyclistsFinished.Text = finishLine.Scoreboard(currentCyc); 
```

FinishLine 类背后的代码是：

```
class FinishLine
{
    public string Scoreboard(Cyclists cyc)
    {
        String msg;

        msg = cyc.ToString();

        return msg;
    }
} 
```

但是，使用 FinishLine 中的代码，它会显示一个结果，但只要我输入一个新结果；它替换了第一个，因此只显示 1 个结果。

我要传递的信息是：类型+“编号”+编号+“已完成”+小时+“：”+分钟+“：”+秒；

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-07T21:32:27.620

```
lblCyclistsFinished.Text += "\n" + finishLine.Scoreboard(currentCyc); 
```

the`"\n"`是换行符。以供参考。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-07T21:32:17.873

你要找的是这个

```
 lblCyclistsFinished.Text += finishLine.Scoreboard(currentCyc) + Environment.NewLine(); 
```

# javascript - 如何在 jQuery 中使用这个函数

> ID：13278559
> 
> 赞同：1
> 
> 时间：2012-11-07T21:29:04.897
> 
> 标签：javascript, jquery, function

我有以下 jQuery 函数，它应该检测元素何时首次滚动到页面上的视图中：

```
function isScrolledIntoView(elem) {
    var docViewTop = $(window).scrollTop();
    var docViewBottom = docViewTop + $(window).height();

    var elemTop = $(elem).offset().top;
    var elemBottom = elemTop + $(elem).height();

    return ((elemBottom <= docViewBottom) && (elemTop >= docViewTop));
} 
```

我今天脑子很乱……我该如何使用这个功能？

假设我想检测何时`$('.guardrail360')`进入视野。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-07T21:32:42.553

有几种方法可以做到这一点。`window.scroll`如果您关心用户体验和/或性能，请不要使用幼稚的实现。

> 将处理程序附加到窗口滚动事件是一个非常非常糟糕的主意。根据浏览器的不同，滚动事件可能会触发很多，并且将代码放入滚动回调中会减慢滚动页面的任何尝试（不是一个好主意）。因此，滚动处理程序中的任何性能下降只会使整体滚动性能更加复杂。相反，最好使用某种形式的计时器每 X 毫秒检查一次，或者附加一个滚动事件，并且只在延迟后（或者甚至在给定数量的执行之后 - 然后延迟）运行您的代码。
> 
> -John Resig，jQuery 的创建者，在[ejohn.org](http://ejohn.org/blog/learning-from-twitter/)

# 方法一：setInterval

首先，有一种使用计时器的简单方法：

```
var $el = $('.guardrail360');

var timer = setInterval(function() {
    if (isScrolledIntoView($el)) {
        // do stuff

        // to run this block only once, simply uncomment the next line:
        //clearInterval(timer);
    }
}, 150); 
```

# 方法二：window.scroll 事件

然后是使用滚动事件的琐碎但**疯狂的低效方式**（取决于浏览器，滚动事件每秒会触发数百次，所以你不想在这里运行很多代码，尤其是不触发的代码浏览器重排/重绘）。

曾经访问过一个向下滚动页面感觉迟缓和紧张的网站？这通常是由如下一段代码引起的：

```
var $el = $('.guardrail360');

$(window).on('scroll', function() {
    if (isScrolledIntoView($el)) {
        // do stuff
    }
}); 
```

# 方法3：两全其美

正如 John Resig 在[上述博客文章](http://ejohn.org/blog/learning-from-twitter/)中提出的，用于高流量站点的漂亮混合方法：

```
var $el = $('.guardrail360'),
    didScroll = false;

$(window).scroll(function() {
    didScroll = true;
});

var timer = setInterval(function() {
    if ( didScroll ) {
        didScroll = false;
        if (isScrolledIntoView($el)) {
            // do stuff

            // to run this block only once, simply uncomment the next line:
            //clearInterval(timer);
        }
    }
}, 250); 
```

# 方法 4：节流/去抖动

节流（调用之间最少 N 毫秒）或去抖动（每个“突发”只有一次调用）模式也可用于有效限制内部代码执行的速率。假设您使用的是[Ben Alman 的 jQuery throttle/debounce 插件](http://benalman.com/projects/jquery-throttle-debounce-plugin/)，代码如下所示：

```
var $el = $('.guardrail360');

// Throttling
$(window).on('scroll', $.throttle( 250, function(){
    if (isScrolledIntoView($el)) {
        // do stuff
    }
}));

// Debouncing
$(window).on('scroll', $.debounce( 250, function(){
    if (isScrolledIntoView($el)) {
        // do stuff
    }
})); 
```

（请注意，去抖动的行为与其他实现略有不同，但这有时可能是您想要的，具体取决于您的用户体验场景）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-07T21:32:15.907

似乎您需要绑定滚动事件并在该事件触发时进行检测。

```
$(window).scroll(function () { 
  isScrolledIntoView('.guardrail360');
}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-07T21:31:01.117

```
if ( isScrolledIntoView('.guardrail360') ) {

} 
```

正如其他答案所建议的那样，您应该使用 act on `$(window).scroll()`。此外，为了让 if 语句在元素第一次滚动到视图中时运行，我`run_once`为您创建了这个函数：

```
$('window').on('scroll', function() {

    if ( isScrolledIntoView('.guardrail360') ) run_once(function() {
            // ...
    });

});

function run_once( callback ) {

    var done = false;

    return function() {

        if ( !done ) {

            done = true;

            return callback.apply( this, arguments );

        }

    };

} 
```

# python - 在 Numpy 中将子向量分配给多维数组

> ID：13278560
> 
> 赞同：2
> 
> 时间：2012-11-07T21:29:09.107
> 
> 标签：python, multidimensional-array, numpy

假设我有一个矩阵：

```
from numpy import *
a = zeros(shape=(nRows,nColumns)); 
```

当我尝试这样做时，我想在第一列中填写：

```
a[:][0] = ones(shape=(nRows,1)) 
```

我得到：

```
ValueError: output operand requires a reduction, but reduction is not enabled 
```

为什么它不起作用？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-07T21:30:44.053

它应该很简单：

```
a[:,0] = 1 
```

[广播](http://docs.scipy.org/doc/numpy/user/basics.broadcasting.html)将处理细节。

```
>>> a = np.zeros((10,10))
>>> a
array([[ 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.],
       [ 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.],
       [ 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.],
       [ 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.],
       [ 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.],
       [ 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.],
       [ 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.],
       [ 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.],
       [ 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.],
       [ 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.]])
>>> a[:,0]=1
>>> a
array([[ 1.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.],
       [ 1.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.],
       [ 1.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.],
       [ 1.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.],
       [ 1.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.],
       [ 1.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.],
       [ 1.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.],
       [ 1.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.],
       [ 1.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.],
       [ 1.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.]]) 
```

# entity-framework-5 - Entity Framework Linq 查询中的日期有什么奇怪的地方吗？

> ID：13278566
> 
> 赞同：0
> 
> 时间：2012-11-07T21:29:26.697
> 
> 标签：entity-framework-5

我有一个看起来像这样的测试用例：

```
[TestMethod]
public void Things_can_be_saved()
{
  var ts = DateTime.Now;
  var thing = new Thing()
  {
      Name = "Some name",
      TimeStamp = ts
  };

  // save it
  var context = new MyDataContext(testDb);
  context.Things.Add(thing);
  context.SaveChanges();

  // pull from a fresh context so we know it's a db pull not cached
  var context2 = new MyDataContext(testDb);
  var fetched = context2.Things.FirstOrDefault(t => t.TimeStamp == ts);

  Assert.AreEqual(thing.Name, fetched.Name); 
} 
```

因此，当我运行它时，我可以查看数据库并查看数据库中存在的“事物”。我可以看到它存储的 Timestamp 列在运行时等于 ts 变量中的值。但是 'fetched' 为 null，表示 EF 在 FirstOrDefault 查询中找不到它。关于 DateTime 平等，我有什么遗漏吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-03T05:32:25.433

您可能需要将数据库中的列更改为 datetime2 而不是 datetime

另请参阅此线程：[SQL Server 中的 DateTime2 与 DateTime](https://stackoverflow.com/questions/1334143/sql-server-datetime2-vs-datetime)

# html - 仅在部分网站上使用照片作为封面图片

> ID：13278569
> 
> 赞同：1
> 
> 时间：2012-11-07T21:29:31.213
> 
> 标签：html, css, internet-explorer, firefox, google-chrome

我正在尝试使用 css 将背景照片添加到网站的一部分。我想将照片设置为“封面”，以便在访问者的浏览器允许时拉伸和调整其大小。

问题是，我想将网站分成两部分，#top 和#bottom。而上半部分约为 79%，下半部分为 21%。#top 部分将包含“封面”照片，而下半部分将具有一定的背景颜色。

我的问题是，我当前的设置“有点”适用于 IE（拉伸有点偏离），但不适用于 Firefox 和 Chrome。我尝试了很多不同的事情，但就是无法做到正确。

出现的问题是，在 Firefox 和 Chrome 中，“封面”照片剪辑位于底部背景后面，而在 IE 中，照片实际上按预期工作，并填充了 #top 部分。

```
<html>
 <head>
  <title>Test</title>
  <style>
        html {
          width:100%; 
          height:100%; 
          color:white;
        }

        body {
          height:100%; 
          width:100%;
        }

        #top {
          background: url(PZwx1) no-repeat center center fixed;
          -webkit-background-size: cover;
          -moz-background-size: cover;
          -o-background-size: cover;
          background-size: cover;
          filter: progid:DXImageTransform.Microsoft.AlphaImageLoader(src='../img/BV-site-bgfoto.jpg', sizingMethod='scale');
          -ms-filter: "progid:DXImageTransform.Microsoft.AlphaImageLoader(src='../img/BV-site-bgfoto.jpg', sizingMethod='scale')";
          height:79%;
        }

        #bottom {background: #F9525F;height:21%;}enter code here
  </style>
 </head>
 <body>
   <div id="top"></div>
   <div id="bottom"></div>
 </body>
</html> 
```

我已经在这里制定了示例；[http://www.webdevout.net/test?02X](http://www.webdevout.net/test?02X)

任何帮助深表感谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-07T22:27:08.260

删除“background:fixed”（这就是它使用 100% 页面高度的原因）并使用“100% 100%”而不是“cover”。那应该这样做。

```
 #top {
      background: url(lalala.jpg) no-repeat center center;
      background-size:100% 100%;
      filter: progid:DXImageTransform.Microsoft.AlphaImageLoader(src='lalala.jpg', sizingMethod='scale');
      -ms-filter: "progid:DXImageTransform.Microsoft.AlphaImageLoader(src='lalala.jpg', sizingMethod='scale')";
      height:79%;
    } 
```

如果`fixed`很重要，则使用`background-size:100% 79%`并将其更改`background:center`为`background:top`

```
 #top {
      background: url(lalala.jpg) no-repeat top fixed;
      background-size:100% 79%;
      filter: progid:DXImageTransform.Microsoft.AlphaImageLoader(src='lalala.jpg', sizingMethod='scale');
      -ms-filter: "progid:DXImageTransform.Microsoft.AlphaImageLoader(src='lalala.jpg', sizingMethod='scale')";
      height:79%;
    } 
```

（另外，添加`padding:0,margin:0`到你的身体）

# javascript - 表单验证（如果和那么）

> ID：13278571
> 
> 赞同：2
> 
> 时间：2012-11-07T21:29:44.353
> 
> 标签：javascript, forms

如果有人选择`A`为 , 显示 javascripts 的选项`A1`，并且如果他们选择为 , `A2`,显示 javascripts ，我想制作一个 javascript 来显示。因此，它会首先从*选择*标签中询问和***B***`A3``B``B1``B2``B3``A`

 **例如：

```
<select name="AorB" >
<option value="" selected="selected">Select...</option>
<option value="A" >Option A</option>
<option value="B" >Option B</option>
</select> 
```

我正在使用这种 javascript 方式（错误警报）：

```
<SCRIPT language=JavaScript>
<!--
function check(form) {
if (form.Password.value == "")
{ alert("Please enter your Password."); form.Password.focus(); return;}
if (form.Password.value.length < 8)
{ alert("Please enter a valid Password."); form.Password.focus(); return;}
form.submit()
}
//-->
</SCRIPT> 
```

PS：当他们选择 A 来获得 B 选项 javascripts 或反向时，我不想使复杂化。

添加 - 解释：我的意思是如果我们选择 OPTION A 将会显示一些 Input-s ....并且 javascript 将只询问显示的 input-s 所以这意味着 OPTION A input-s ...但不要求选项 B 也输入-s，即使它们没有显示，因为我们没有选择选项 B ...我希望我为你解释了一点。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-07T23:42:41.290

`select`您可以通过以下方式轻松检查标签的当前值：

```
alert(document.getElementById('AorB').value); 
```

这将提醒`select`标签的当前值。

然后，只要值随`onChange`事件发生变化，您就可以检查该值：

```
<select id="AorB" onchange="alert(document.getElementById('AorB').value);">
<option value="" selected="selected">Select...</option>
<option value="A" >Option A</option>
<option value="B" >Option B</option>
</select> 
```

[这是您可以使用的 jsFiffle 示例。](http://jsfiddle.net/EfgFU/)

然后你可以根据值是什么来做一些 JavaScript，不过我不会给你写整个代码。

我希望这有帮助！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-08T00:38:37.803

我对您的问题的理解是您想要一个选择框，这将决定表单上显示哪些字段。然后，您希望验证脚本仅验证显示的那些字段。这最好用 JQuery 处理。这是一些工作代码来举例，还有一个[fiddle](http://jsfiddle.net/z62gA/)。

**HTML**

```
<div id="wrapper">
    <form id="myForm" name="myForm" method="POST" action="http://www.google.com">
        <select id="option" name="option">
            <option value="X">Choose One...</option>
            <option value="A">Option A</option>
            <option value="B">Option B</option>
        </select>
        <div id="optionset-a">
            <p>
                Input A1: <input name="a1" id="a1" class="option-a" type="textfield" /><br     />
                Input A2: <input name="a2" id="a2" class="option-a" type="textfield" /><br />
                Input A3: <input name="a3" id="a3" class="option-a" type="textfield" /><br />
            </p>
        </div>
        <div id="optionset-b">
            <p>
                Input B1: <input name="b1" id="b1" class="option-b" type="textfield" /><br     />
                Input B2: <input name="b2" id="b2" class="option-b" type="textfield" /><br />
                Input B3: <input name="b3" id="b3" class="option-b" type="textfield" /><br />
            </p>
        </div>
        <input type="submit" id="submit-button" name="submit" value="Submit" />
    </form>
</div>​ 
```

**jQuery**

```
$('#optionset-a').hide();
$('#optionset-b').hide();
$('#submit-button').hide();

$('#option').change(function() {
    if ($('#option').val() == 'A') {
        $('#optionset-b').hide();
        $('#optionset-a').show();
        $('#submit-button').show();
    } else if ($('#option').val() == 'B') {
        $('#optionset-a').hide();
        $('#optionset-b').show();
        $('#submit-button').show();
    }
});

$('#submit-button').click(function() {
    var validation = true;
    if ($('#option').val() == 'A') {
        $('.option-a').each(function() {
            if ($(this).val() == '') {
                $(this).css('border','1px solid red');
                validation = false;
            }
        });
    }
    if ($('#option').val() == 'B') {
        $('.option-b').each(function() {
            if ($(this).val() == '') {
                $(this).css('border','1px solid red');
                validation = false;
            }
        });
    }
    if (validation) {
        document.forms["myForm"].submit();
    } else { alert('Please fill in all fields.'); }
});​ 
```**

# css - 下拉选择器的 css

> ID：13278572
> 
> 赞同：1
> 
> 时间：2012-11-07T21:29:47.117
> 
> 标签：css

无论如何，我都不是一个网络开发人员，我基本上通过试验和大量错误来按照我想要的方式完成事情。我似乎无法弄清楚这一点。我想将下拉选择器的样式从使用默认操作系统样式更改为我找到的合适样式，但我不知道该去哪里。这是我现有的下拉选择器 css：

```
/* select
    ==========================================================*/
.selector, .selector * {
/* margin: 0;
  padding: 0; */
}
.selector select:focus { outline: 0; }

div.selector {
 /* background-position: -490px -24px;
  display: inline-block;
  overflow: hidden;
  padding-left: 2px;
  position: relative;
  vertical-align: middle;

  -webkit-border-radius: 3px;
  -moz-border-radius: 3px;
  border-radius: 3px;

  -webkit-box-shadow: 1px 1px 3px 0px rgba(0, 0, 0, 0.2);
  -moz-box-shadow: 1px 1px 3px 0px rgba(0, 0, 0, 0.2);
  box-shadow: 1px 1px 3px 0px rgba(0, 0, 0, 0.2); */
}
  div.selector span {
 /* background-position: 100% 0;
    color: #fff;
    font-size: 11px;
    font-weight: bold;
    overflow: hidden;
    padding: 0px 27px 0px 7px;
    text-overflow: ellipsis;
    text-shadow: 1px 1px 0 #000;
    white-space: nowrap; */
  }
  div.selector select {
    /*background: #fff;
    color: #000;
    border: none;
    left: 0;
    opacity: 0;
    position: absolute;
    top: 0;
    width: 100%;
  text-transform:none;*/
  font-size:12px;
  opacity: 1 !important;
  }

div.selector, div.selector span {

  /*background-repeat: no-repeat;
  line-height: 24px; 
  text-transform: uppercase; 
    background-image: url("sprite.png");
    background-repeat: no-repeat;
    line-height: 24px;*/

}
div.selector, div.selector span, div.selector select { /*height: 24px;*/     }
/* #sort {

    margin: 10px 0;
  float:right;
  width:257px;
}
#sort span {display:none;}
#sort SELECT {
    background: none repeat scroll 0 0 #fff;
    color: #000;
    vertical-align: bottom;
  opacity:1 !important;
  float:left;

} */

button, textarea, input[type=text], input[type=password] {
  border: 0;
  margin: 0;
  padding: 0;
}

textarea, input[type=text], input[type=password], select, .selector span {
  color: #888;
  font: 12px 'Helvetica Neue', Arial, sans-serif;
}

input[type=submit] { font: 12px 'Helvetica Neue', Arial, sans-serif; }

textarea, input[type=text], input[type=password] {
  border: 1px solid #a9a9a9;
  padding: 4px 8px;

}

button {
  background: transparent;
  color: #1b1e00;
  font-size: 28px;
  text-transform: lowercase;
}

button, label, input[type=submit] { cursor: pointer; }

.selector span { display: block; }
.selector, .selector span, .selector select { cursor: pointer; } 
```

这是我希望它看起来像的css：

```
/* all form DIVs have position property set to relative so we can easily position newly created SPAN */
form div{position:relative;} 

/* setting the width and height of the SELECT element to match the replacing graphics */
select.select{
    position:relative;
    z-index:10;
    width:166px !important;
    height:26px !important;
    line-height:26px;
}

/* dynamically created SPAN, placed below the SELECT */
span.select{
    position:absolute;
    bottom:0;
    float:left;
    left:0;
    width:166px;
    height:26px;
    line-height:26px;
    text-indent:10px;
    background:url(images/bg_select.gif) no-repeat 0 0;
    cursor:default;
    z-index:1;
    } 
```

基本上我不知道去哪里了。任何帮助将不胜感激。

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-13T23:22:18.533

目前唯一完全支持下拉菜单样式的浏览器是 chrome。请参阅这篇文章：
[如何在没有 JavaScript 的情况下仅使用 CSS 设置 <select> 下拉菜单的样式？](https://stackoverflow.com/questions/1895476/how-to-style-a-select-dropdown-with-css-only-without-javascript)

如果您需要下拉菜单来匹配跨浏览器，有几个选项。
1) [http://harvesthq.github.com/chosen/](http://harvesthq.github.com/chosen/)或其他类似的（我通常的选择），
2) 从头开始​​完全重新设计一个下拉菜单。不建议这样做，因为它非常复杂且容易产生错误。请参阅[http://www.jankoatwarpspeed.com/post/2009/07/28/reinventing-drop-down-with-css-jquery.aspx](http://www.jankoatwarpspeed.com/post/2009/07/28/reinventing-drop-down-with-css-jquery.aspx)
或
[http://css-tricks.com/dropdown-default-styling/](http://css-tricks.com/dropdown-default-styling/)

希望这可以帮助！

# php - php脚本杀死shell'sleep'进程

> ID：13278573
> 
> 赞同：1
> 
> 时间：2012-11-07T21:30:02.167
> 
> 标签：php, shell

我需要为一些自动化工作编写一些脚本，

我在本地 apache 服务器 test.php 上放了一个 php 文件

```
<?php
system("bash inform.sh");
?> 
```

inform.sh 的内容是：

```
#!/bin/bash
proc_id=`ps -ef|grep "sleep"|grep -v "grep"|awk '{print $2}'`
kill -9 $proc_id 
```

我在 shell 上运行 sleep 进程，并在 firefox 上打开 php 页面：localhost/test.php 但它不会杀死 sleep 进程，如果我直接通过 shell 运行 php，那么它有什么问题以及如何处理它？谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-07T21:52:37.240

我使用以下shell命令，然后就可以了：

```
sudo -u apache sleep 2000 
```

# javascript - 如何在 jquery 对话框上放置可选择的动态列表

> ID：13278574
> 
> 赞同：1
> 
> 时间：2012-11-07T21:30:09.183
> 
> 标签：javascript, jquery, dialog

如何在 jquery 对话框上放置一个可选择的动态列表。我想要做的是当用户单击一个按钮时会出现一个对话框，并且该列表由来自 sqlite 数据库的结果填充。用户然后单击他/她想要的结果，然后单击对话框上的按钮以加载结果。

我的对话框代码如下...我希望在打开显示 SQLite 结果的对话框时出现一个列表。

```
function setImportDialog()
{
    $('#importDialog').dialog({
        resizeable: false,
        autoOpen: false,
        modal: true,
        buttons:{
            "Import Test": function(){
                if( isWindows() ) 
                {
                    log("Importing Test Data: ");
                    importTestData(); //' here is where it would grab the selected item and perform actions on said item
                }
                $(this).dialog("close");
            },
            "Cancel": function(){
                $(this).dialog("close");

            }
        } });
} 
```

# android - 获取 youtube 频道上所有上传视频的带有 id 的 XML

> ID：13278576
> 
> 赞同：6
> 
> 时间：2012-11-07T21:30:22.447
> 
> 标签：android, iphone, youtube, youtube-api, gdata

我在一个 youtube 频道上传了 100 多个视频。我得到频道的 xml 为： [https://gdata.youtube.com/feeds/api/users/UserId/uploads](https://gdata.youtube.com/feeds/api/users/UserId/uploads)，它只返回 xml 和 id 的只有 25 个视频。如何获取特定频道上所有上传视频的 xml

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-07T21:39:25.233

默认情况下，API 只返回 25，您必须添加一个最大结果参数才能获得更多，但遗憾的是，这只允许您最多 50。

[https://gdata.youtube.com/feeds/api/users/UserId/uploads?&max-results=50](https://gdata.youtube.com/feeds/api/users/UserId/uploads?&max-results=50)

您需要做的是不断请求更多使用偏移量来表示您想从某个值开始，在这种情况下，您可以执行以下操作：

[https://gdata.youtube.com/feeds/api/users/UserId/uploads?&max-results=50&start-index=51](https://gdata.youtube.com/feeds/api/users/UserId/uploads?&max-results=50&start-index=51)

查看[https://developers.google.com/youtube/2.0/developers_guide_protocol_video_feeds](https://developers.google.com/youtube/2.0/developers_guide_protocol_video_feeds)了解更多信息。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2015-07-20T10:31:51.280

我知道这是一个老问题，但由于它是谷歌搜索时的最佳结果`Youtube channel xml feed`，我还是想回答。

由于 Youtube 已于 2014 年 2 月更改为 API v3 并弃用 v2，因此不再支持已接受答案中的示例。从 API v3 开始，您需要使用以下内容：

**渠道**

[https://www.youtube.com/feeds/videos.xml?channel_id=YOURCHANNELID](https://www.youtube.com/feeds/videos.xml?channel_id=YOURCHANNELID)

**用户名**

[https://www.youtube.com/feeds/videos.xml?user=USERNAME](https://www.youtube.com/feeds/videos.xml?user=USERNAME)

上面的例子（如果你用大写字母替换的话）输出一个 XML 文件。

[带有指向新 API](https://developers.google.com/youtube/v3/guides/push_notifications)的链接的[源代码](http://www.jwz.org/blog/2015/04/youtube-has-finally-destroyed-their-rss-feeds/)

# php - 无法从 feedburner xml 解析完整的 RSS

> ID：13278577
> 
> 赞同：1
> 
> 时间：2012-11-07T21:30:22.980
> 
> 标签：php, xml, rss, feed

我在解析完整的 RSS 2.0 内容提要时遇到问题。我已经检查了所有的 Wordpress 和 Feedburner 设置，一切正常。

我正在使用 simple_xml_load($link)、PHP，但我能得到的只是完整博客内容的一部分。

谢谢你们。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-22T15:48:53.920

您只需要在源中启用“完整”选项（当前配置为“摘要”）

# ruby - pik 未列出 ruby 1.9.3

> ID：13278578
> 
> 赞同：2
> 
> 时间：2012-11-07T21:30:33.680
> 
> 标签：ruby, pik

我正在运行 win 7，并且刚刚通过安装程序安装了 pik。我列出了 ruby​​ 版本，最新版本是 1.9.2[-1.3.6]。我看到有人提到使用“pik list -r”的帖子，但 pik 告诉我它已被弃用，然后无论如何都使用“list known”。我想安装 ruby​​ 1.9.3，但目前这台机器上没有安装任何 ruby​​。

如果这是一个重复的问题，请提前抱歉，但我没有看到。

谢谢帕特里克

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-07-06T04:46:44.733

正如 Raghu 所说，您需要指定现有的 ruby​​ 安装

```
pik add <path to ruby executable> 
```

但是，为了获得最新的 ruby​​ 版本，您可以像 rvm 一样执行安装，

只需执行 pik 安装，例如：

```
pik install ruby 
```

或者

```
pik install jruby 
```

# jquery - Colorbox 可以维护照片幻灯片浏览器历史记录（a la facebook）

> ID：13278579
> 
> 赞同：3
> 
> 时间：2012-11-07T21:30:40.250
> 
> 标签：jquery, colorbox

首先 - 我检查了这个非常相似的线程：[使用 Colorbox，如何为每个模式框创建浏览器历史状态？](https://stackoverflow.com/questions/8142301/using-colorbox-how-can-i-create-browser-history-states-for-each-modal-box)但这适用于模态框和内联内容。

我希望有一种（相对）简单的方法可以通过从锚点调用的 Colorbox 幻灯片来维护浏览器的点击历史记录——你可以在这里看到我的意思：http: [//katlo.freshmango.com/](http://katlo.freshmango.com/)（点击在任何照片上）。

这是由 JS 文件中的这一行调用的：

$('.lightbox').colorbox({rel:'lightbox',slideshow:true, slideshowSpeed:4000});

以及其中包含“灯箱”类的链接：

目前，如果用户单击浏览器中的后退按钮，他们将正确地被带到他们上一个网页。我在 facebook 中注意到，当您浏览相册中的照片时，它会更新浏览器中的 URL 以提供历史记录 - 有谁知道我是否可以使用 Colorbox？

非常感谢您的帮助！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-08T08:58:05.630

你想做这样的事情。

您想添加一些将在每张幻灯片加载时运行的代码，因此您将使用颜色框 onLoad 回调（onComplete 可能会更好 - 您必须尝试一下）。

然后，您需要使用 history.js 库：[https](https://github.com/browserstate/History.js/) ://github.com/browserstate/History.js/ 。一个警告。您想使用 HTML4 哈希回退。如果你不这样做，那么在 HTML4 浏览器上，按下后退按钮将导致页面刷新，这不是你想要的。

```
$('.lightbox').colorbox({
    rel: 'lightbox',
    slideshow: true,
    slideshowSpeed: 4000,
    onLoad: function() {

        // get slide number by looking in the caption field (e.g. 'image 6 of 10')
        // and removing extraneous text
        current_text = $('#cboxCurrent').html();
        current_index = current_text.substr(6).substr(0, current_text.indexOf('of') - 7)

        // add a new url with the current slide number to the browser's history
        var History = window.History;
        History.pushState('', '', window.location.href + '?slide=' + current_index);

    }
});​ 
```

您需要做的最后一件事是告诉浏览器每次状态更改时（意味着如果有人按下后退按钮），您想要重新加载 url 中指定的幻灯片的灯箱（在我们的示例幻灯片 6 中）。

```
// Bind to StateChange Event
History.Adapter.bind(window,'statechange',function(){
    var State = History.getState();
    // State.url will contain the url http://katlo.freshmango.com/?slide=6, so you
    // need to write some code to load up the colorbox on that slide.
}); 
```

# javascript - 在用户关闭选项卡/窗口之前做一些事情

> ID：13278582
> 
> 赞同：2
> 
> 时间：2012-11-07T21:30:49.430
> 
> 标签：javascript

我试过`window.onbeforeunload`了，但它似乎不起作用。有什么帮助吗？

我有一个 cookie 来跟踪用户是否登录。

```
function handleLoginRegSuccess(){
    $.cookie('loginStatus', "ON", { expires: 1, path: '/'});
    showBusyMessage();
    goToIndex();
} 
```

这是我尝试过的，但它不起作用。

```
window.onbeforeunload = function(e) {
    if(userLoginStatus()=="ON"){
        requestLogout();
        $.removeCookie('loginStatus');
        return "test";
    }
}; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-07T21:35:33.350

因此，要直接回答您的问题，onbeforeunload 需要一个返回值才能实际工作，此时它会用该字符串提示用户，他们会得到一个确认框。

此堆栈答案中的更多详细信息：[如何覆盖 OnBeforeUnload 对话框并将其替换为我自己的？](https://stackoverflow.com/questions/276660/how-can-i-override-the-onbeforeunload-dialog-and-replace-it-with-my-own)

相反，您可能会考虑使用会话超时来注销该人，或者（更积极地）来自客户端的心跳以使他们保持登录状态（通过 ajax）。当心跳无法触发时，它们将被注销。

如果您根本不尝试与用户交互（因为您的示例代码似乎没有这样做），您也可以使用 onunload 事件：http: [//msdn.microsoft.com/en-us/library/ie /ms536973(v=vs.85).aspx](http://msdn.microsoft.com/en-us/library/ie/ms536973(v=vs.85).aspx)

# ravendb - RavenB 选择数据库

> ID：13278583
> 
> 赞同：2
> 
> 时间：2012-11-07T21:30:52.847
> 
> 标签：ravendb

```
var store = new DocumentStore()
{
    Url = @"http://localhost"
};
store.Initialize();

Blog blog = new Blog()
{
    Title = "Hello RavenDB",
    Category = "RavenDB",
    Content = "This is a blog about RavenDB",
    Comments = new BlogComment[]{
        new BlogComment() { Title = "Unrealistic", Content= "This example is unrealistic"},
        new BlogComment() { Title = "Nice", Content= "This example is nice"}
    }
};

using (IDocumentSession session = store.OpenSession())
{
    session.Store(blog);
    session.SaveChanges();
} 
```

上面的代码将数据保存到默认数据库。（它是一个 Web 应用程序。）但我希望它将数据保存到我创建的 raven 管理工作室（网页）的另一个数据库中。我在哪里指定数据库名称？另外请告诉我如何将连接字符串与数据库名称一起保存在配置文件中。这就是我将它保存到没有数据库名称的配置文件的方式

```
<connectionStrings>
  <add name="Local" connectionString="DataDir = ~\Data"/>
  <add name="Server" connectionString="Url = http://localhost:8080"/>
</connectionStrings> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-07T21:58:11.837

您的所有问题都在[文档](http://ravendb.net/docs/client-api/connecting-to-a-ravendb-datastore#using-a-connection-string)中进行了解释：

```
new DocumentStore 
{
    ConnectionStringName = "Local"
} 
```

```
<connectionStrings>
    <add name="Local" connectionString="DataDir=~\Data;Database=MyDatabaseName"/>
    <add name="Server" connectionString="Url=http://localhost:8080;Database=MyDatabaseName"/>
 </connectionStrings> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-08T00:21:33.353

其他答案都可以，但为了提高效率，您真的只需要一个 DocumentStore 实例用于您的应用程序，除非您运行多个 Raven 服务器，然后每台服务器都有一个是可以接受的。

如果你只是连接到同一台服务器上的不同数据库，你应该使用：

```
var store = new DocumentStore(...your connection string or inline options...);

using (var session = store.OpenSession("the database name")
{
    ...
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-07T22:04:59.380

您可以保留显示的连接字符串数据，最好使用最后的数据库名称：

```
<connectionStrings>
  <add name="Core" connectionString="Url=http://localhost:8082/databases/Core"
    providerName="My primary database." />
  <add name="Backup" connectionString="Url=http://localhost:8082/databases/Backup"
    providerName="My backup stuff." />
</connectionStrings> 
```

接下来，您可以实现单例类，它将保留所有已定义源的处理程序，例如：

```
public class DocumentStoreProvider : IDocumentStoreProvider
{
    private static readonly IDictionary<string, IDocumentStore> _documentStores = new Dictionary<string, IDocumentStore>();    
    private static readonly DocumentStoreProvider _instance = new DocumentStoreProvider();

    private DocumentStoreProvider()
    {
        var connectionStrings = ConfigurationManager.ConnectionStrings;
        foreach (ConnectionStringSettings connectionString in connectionStrings)
        {
            var name = connectionString.Name;
            var connection = connectionString.ConnectionString;

            IDocumentStore currentStore = new DocumentStore { ConnectionStringName = name };
            currentStore.Initialize();
            currentStore.DatabaseCommands.EnsureDatabaseExists(name);
            IndexCreation.CreateIndexes(Assembly.Load("Your.Assembly.Containing.Indexes"), currentStore);

            _documentStores.Add(name, currentStore);
        }
    }

    public static DocumentStoreProvider Instance
    {
        get { return _instance; }
    }

    public IDocumentStore GetDocumentStore(string key)
    {
        return _documentStores[key];
    }
} 
```

用法可以如下：

```
using (var session = DocumentStoreProvider.Instance.GetDocumentStore("Backup").OpenSession())
{
    /* do stuff for chosen database... */
    session.Store(something);
    session.SaveChanges();
} 
```

# ms-access - 将相关行中的值组合成一个串联的字符串值

> ID：13278590
> 
> 赞同：11
> 
> 时间：2012-11-07T21:31:10.687
> 
> 标签：ms-access

我正在尝试汇总一些讲师数据（以轻松显示讲师在一个学期中教授的课程），到目前为止，我刚刚接受了每位讲师的多行数据。但是，如果我可以在一行中完成所有讲师的教学，这将对某些业务流程有益。这是一些示例数据（我的表有更多的列，但总体思路不会有太大变化。

tbl_Instructors 有：

```
 N_ID | F_Name | L_Name
    001    Joe      Smith
    002    Henry    Fonda
    003    Lou      Reed 
```

tbl_Courses 有：

```
 Course_ID | N_ID | Course_Info
    AAA         001    PHYS 1
    AAB         001    PHYS 2
    CCC         002    PHYS 12
    DDD         003    PHYS 121
    FFF         003    PHYS 224 
```

我要返回的是：

```
 N_ID | First_Name | Last_Name | Course_IDs
    001    Joe          Smith       AAA, AAB
    002    Henry        Fonda       CCC
    003    Lou          Reed        DDD, FFF 
```

我想我需要从 tbl_Instructors 中选择所有 N_ID，然后通过连接从 tbl_Courses 返回 Course_ID，但那个神奇的步骤暗示了我。有什么帮助吗？我可以通过 SQL 选择执行此操作还是需要使用 VB？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-11-07T23:57:09.250

这很容易使用 Allen Browne 的[ConcatRelated()](http://allenbrowne.com/func-concat.html)函数。从该网页复制函数并将其粘贴到 Access 标准代码模块中。

然后此查询将返回您要求的内容。

```
SELECT
    i.N_ID,
    i.F_Name,
    i.L_Name,
    ConcatRelated(
        "Course_ID",
        "tbl_Courses",
        "N_ID = '" & [N_ID] & "'"
        ) AS Course_IDs
FROM tbl_Instructors AS i; 
```

考虑将`N_ID`两个表中的数据类型从文本更改为数字。如果这样做，则不需要该`ConcatRelated()`表达式的第三个参数中的单引号。

```
"N_ID = " & [N_ID] 
```

每当您需要`N_ID`显示前导零时，请使用`Format()`表达式。

```
Format(N_ID, "000") 
```

# javascript - 在 benchmark.js 中使用字符串

> ID：13278597
> 
> 赞同：1
> 
> 时间：2012-11-07T21:31:57.017
> 
> 标签：javascript, benchmark.js

benchmark.js 的示例应用程序将其性能测试定义为字符串而不是 JavaScript 函数：

[https://github.com/bestiejs/benchmark.js/blob/master/example/jsperf/index.html#L250](https://github.com/bestiejs/benchmark.js/blob/master/example/jsperf/index.html#L250)

以这种方式定义性能测试是否有优势？为什么它不只是一个函数？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-07T23:02:26.000

据我所知，通过一连串的调用，函数代码最终会出现[在 benchmark.js 中](https://github.com/bestiejs/benchmark.js/blob/master/benchmark.js)名为 getSource 的函数中，无论如何都会将其转换为字符串：

```
/**
 * Gets the source code of a function.
 *
 * @private
 * @param {Function} fn The function.
 * @param {String} altSource A string used when a function's source code is unretrievable.
 * @returns {String} The function's source code.
 */
function getSource(fn, altSource) {
  var result = altSource;
  if (isStringable(fn)) {
    result = String(fn);
  } else if (support.decompilation) {
    // escape the `{` for Firefox 1
    result = (/^[^{]+\{([\s\S]*)}\s*$/.exec(fn) || 0)[1];
  }
  // trim string
  result = (result || '').replace(/^\s+|\s+$/g, '');

  // detect strings containing only the "use strict" directive
  return /^(?:\/\*+[\w|\W]*?\*\/|\/\/.*?[\n\r\u2028\u2029]|\s)*(["'])use strict\1;?$/.test(result)
    ? ''
    : result;
} 
```

这是在函数“clock”中完成的，它提供了另一种解释，说明每次调用时钟时从字符串中创建基准函数的动机：

```
// Compile in setup/teardown functions and the test loop.
// Create a new compiled test, instead of using the cached `bench.compiled`,
// to avoid potential engine optimizations enabled over the life of the test. 
```

我不是 benchmark.js 的专家，但我对它的理解是该库故意想要从原始代码开始基准测试，迫使编译器/解释器在它以前从未见过的代码上运行。这对我来说确实有意义，因为假设浏览器在加载时冻结 5 秒以优化代码可能具有惊人的性能，但忽略它在基准测试中编译所花费的 5 秒是不公平的。此外，它对原始代码进行了相当多的修改，以控制范围和异常处理；基准测试只需要将代码作为字符串来正确操作它。

从这个观点来看，将函数作为字符串传递并不是特别重要，但没有理由不这样做 - 无论如何它最终都会作为字符串结束。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-08T00:08:21.400

在这种情况下，将函数添加为字符串或引用对测试性能没有影响。

查看这个[benchmark.js#L336](https://github.com/bestiejs/benchmark.js/blob/master/benchmark.js#L336)和下面的示例。医生说这取决于你。

您可能想查看一个`clock`函数：[benchmark.js#L2452](https://github.com/bestiejs/benchmark.js/blob/master/benchmark.js#L2452)。您将看到，如果将函数作为引用传递，它将被转换为字符串。更重要的是，整个测试被创建为一个字符串。

我不知道为什么它是一个更好的解决方案的所有优点，但我想到了这些：

*   将整个测试设置为一段代码更容易
*   提供了从不同来源引入功能的可能性，例如数据库或文本区域
*   测试可以保存并重新运行

我想指出，我指出的所有优点都与运行代码的技术方面无关。如果它是一个字符串，它必须被解释和执行定义的次数。然后检查已经过去了多少时间，这是基准测试的结果（基本上）。整个概念是一样的：

```
var counter = N,
    after,
    before = performance.now;
while(counter--) {
    myFun();
}
after = performance.now;
console.log(after - before); 
```

# odbc - 测试连接不成功...找不到没有系统权限的数据库

> ID：13278605
> 
> 赞同：2
> 
> 时间：2012-11-07T21:32:22.907
> 
> 标签：odbc, informix

我很难连接到现有的 Informix 数据库。我正在尝试模仿当前可用的另一台机器上的配置。顺便说一句，另一台机器在同一个网络上，它通过隧道访问数据库，所以我很确定这个问题与网络配置无关。

无论如何，这是我尝试建立连接的步骤

*   下载 clientsdk.3.50.TC9DE 并安装它。工作机器使用 3.50.TC2DE，但我找不到该版本的安装程序。（请注意，起初我尝试使用 3.50TC9，不确定这是否会有所不同）

*   将新机器中的 ODBC 配置与工作机器匹配

    *   工作机器在主机名字段中有一个主机名。我认为这是允许的，因为主机被设置为主机文件中的 IP。无论如何，我正在使用IP。

    *   我也在使用 C:\Windows\SysWOW64\odbcad32.exe 创建 DSN

*   确保 INFORMIXDIR 和 PATH 目录正确。根据[http://www.dbforums.com/informix/694408-odbc-test-connection-not-successful.html#post2633932](http://www.dbforums.com/informix/694408-odbc-test-connection-not-successful.html#post2633932)我认为语言环境不是问题，因为它们没有在工作机器的 Setnet32 中设置. 此外，我确保在 ODBC 环境设置中匹配的语言环境。

    *   此外，由于我的 INFORMIXDIR 在 C:\Program Files (x86)\IBM\Informix\Client-SDK\bin 中，我尝试用 PROGRAM~2 替换 Program Files (x86) 并用 CLIENT~1 替换 Client-SDK 无济于事。

    *   尝试直接在我的系统环境变量中设置 INFORMIXDIR（在 Setnet32 之外）

*   设置 DBPATH 以匹配用户和系统环境变量中的工作系统。

*   在 Setnet 和系统环境变量中将 INFORMIXSERVER 设置为服务器。

*   完全降低了我机器上的防火墙。

*   我可以 ping 和 telnet 进入服务器。

我也试过了。。

*   在 Windows XP 上试过这个

*   测试了 ILogin 演示。结果是一个弹出窗口，在标题栏中显示“发现客户记录”，并带有一个空的文本区域字段。

*   重新安装到 C:\informix 而不是 C:\Program Files(x86)...

*   各种步骤后重新启动。

在这一点上，我不知所措。有没有人遇到过这个？我能想到的唯一其他事情是我使用的是 Win7 64 位（带有 32 位驱动程序）并且驱动程序是 9DE 而不是 2DE。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-09T16:33:10.263

好了，战斗已经结束了一半。我能够在我的 Win7 机器上获得“测试连接成功”。早在我们的文件服务器中就有一份 2.90.TC6 驱动程序的副本。我安装了它，它工作。所以我的猜测是我正在使用的数据库与 3.50.TC9DE 不兼容。

我想我的下一步行动是尝试找到 3.50.TC2DE 的安装程序，以便我可以匹配生产系统。

# regex - URI 中的协议名称是否有标准？

> ID：13278613
> 
> 赞同：0
> 
> 时间：2012-11-07T21:32:48.153
> 
> 标签：regex, uri

URI 中的协议名称是否有标准，例如 http: 或 file:？我正在尝试开发一个正则表达式，它将检测 URI 是否以协议名称开头，但我不确定那里允许使用哪些字符。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-07T21:34:50.640

[RFC 3986，第 3.1 节](https://www.rfc-editor.org/rfc/rfc3986#section-3.1)具有以下语法：

```
scheme      = ALPHA *( ALPHA / DIGIT / "+" / "-" / "." ) 
```

这意味着协议名称必须以字母开头，并且可以后跟任意数量的字母、数字、或`+`、`-`或`.`符号。协议名称不区分大小写（也就是说，`HTTP`应该`http`被视为相同），但通常它们应该被规范化为小写形式（因此`HTTP`应该成为`http`）。

# powershell - 有没有办法在 Powershell 脚本中访问 TeamCity 系统属性？

> ID：13278615
> 
> 赞同：26
> 
> 时间：2012-11-07T21:32:58.717
> 
> 标签：powershell, teamcity

我正在尝试使用 Powershell 运行器在 TeamCity 中设置新的构建配置。但是，我似乎找不到在构建脚本中访问 TeamCity 系统属性的方法。我已经看到了可能的提示，但找不到有关如何执行此操作的文档。

我尝试使用 Powershell 变量语法 $variable 访问系统属性。我还打印了内存中的所有变量，并且没有看到要使用的 teamcity 变量。

这对 Powershell 运行器是否可行，如果可以，使其工作所需的语法是什么？

* * *

## 回答 #1

> 赞同：38
> 
> 时间：2012-11-08T10:05:53.910

TeamCity 将设置环境变量，例如 build.number（您可以在 TeamCity 中查看这些变量的列表）。

*在 Powershell 中，您可以使用env* “提供程序”访问环境变量，例如

```
$env:PATH 
```

TeamCity 变量可以通过替换 . 带有 _，因此 build.number 变量可以作为

```
$env:build_number 
```

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2013-09-04T05:28:59.950

正如 TeamCity[文档](https://confluence.jetbrains.com/display/TCD9/Defining+and+Using+Build+Parameters+in+Build+Configuration#DefiningandUsingBuildParametersinBuildConfiguration-UsingBuildParametersinBuildConfigurationSettings)中所说，系统参数被传递给构建脚本运行器，但并非所有构建脚本运行器都知道如何处理它们。*对于 Powershell 脚本运行程序，当使用脚本文件时，它们不会传播到您的脚本。*

我突然想到要编写一个 psake 优化的构建运行程序*，*但同时您可以执行以下操作之一：

*   使用脚本源框中可用的参数扩展将任何 TeamCity 构建属性显式映射到脚本参数。例如`.\build.ps1 -someParam:%build.name%`

*   使用环境参数，可以在 PowerShell 中使用`$env:NAME_IN_TEAMCITY syntax`, eg显式访问`$env:TEAMCITY_VERSION`，或者循环并推入变量范围

*   访问 TeamCity 在构建期间提供的构建属性文件。该文件位于`$env:TEAMCITY_BUILD_PROPERTIES_FILE`，如果您加载 XML 版本，则很容易循环并将它们全部推送到范围内（当然，您确实将所有内容都作为字符串获取）。我发布了一个关于如何做到这一点的要点（[https://gist.github.com/piers7/6432985](https://gist.github.com/piers7/6432985)）。或者，如果使用 Psake，修改上面的脚本以返回一个哈希表，您可以直接将其传递给 Psake 的 -properties 参数。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2012-11-08T08:42:30.997

这是可能的。以下是如何将系统属性传递到 PSake 脚本的示例：

```
& .\psake.ps1 -parameters @{build_number=%build.number%; personal_build=%build.is.personal%} 
```

如果你不使用 Psake，你可以像这样定义你的变量：

```
$build_number = %build.number% 
```

该`%build.number%`部分将替换为 TeamCity 提供的数据。我认为，它仅适用于**源代码**脚本输入模式。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2014-05-08T13:43:42.120

我创建了一个元运行器，它将系统参数传递给 Powershell 脚本中声明的参数。它并不完美（如果你把'@放在你的源代码中它会中断）但它可以满足我的需要，你可以在这里找到它：[https ://gist.github.com/anonymous/ef60ada3f48f0fb25093](https://gist.github.com/anonymous/ef60ada3f48f0fb25093)

# vb.net - 在 VB .Net 代码后面读取 JQurey.ajax URL 调用数据

> ID：13278616
> 
> 赞同：0
> 
> 时间：2012-11-07T21:32:58.530
> 
> 标签：vb.net, jquery

我希望读取 .aspx 页面中文本框的值并每隔几秒保存一次。

我在以下位置找到了以下代码： [如何在 ASP.NET 中实现“自动保存”或“保存草稿”功能？](https://stackoverflow.com/questions/3889004/how-to-implement-an-auto-save-or-save-draft-feature-in-asp-net)

我出于我的目的对其进行了一些修改：

```
 <script type="text/javascript" src="http://code.jquery.com/jquery-1.4.2.min.js">    </script>
<script type="text/javascript">
    $(document).ready(function() {
        window.setInterval(saveDraft, 5000);
    });        
    function saveDraft() {
        $.ajax({
            type: "POST",
            url: "SaveDraft.aspx",
            data: ({
            draftData: $("#<%=dataTextBox.ClientID %>").val()                    
            }),
            success: function(response) {
                alert('saved draft');
            }
        });
    } 
```

假设 dataTextBox 是在 .aspx 页面中定义的文本框。我在 VB .Net 中有代码。但是我不知道如何才能在后面的代码中获取文本框文本字段的值。我想我是通过 draftData: $("#<%=dataTextBox.ClientID %>").val() 行将它传递给 SaveDraft.aspx。

在 SaveDraft.aspx.vb 我有：

```
Public Partial Class SaveDraft
Inherits System.Web.UI.Page

Protected Sub Page_Load(ByVal sender As Object, ByVal e As System.EventArgs) Handles Me.Load

    ' What should go here to read dataTextBox.text?
End Sub

End Class 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-08T11:20:57.070

您需要从 jQuery 中调用一个页面方法，同时传递数据。

可以在这里找到一个很好的例子：

[http://trentgardner.net/net/asp-net-webmethods-with-jquery-and-ajax/](http://trentgardner.net/net/asp-net-webmethods-with-jquery-and-ajax/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-28T15:59:53.043

我能够通过 Page_Load 中的以下代码行读取 dataTextBox 的值

```
 Dim testStr As String = Request.Form("draftData") 
```

# css - 如何使用 CSS 左对齐 DIV 的内容？

> ID：13278617
> 
> 赞同：0
> 
> 时间：2012-11-07T21:32:59.050
> 
> 标签：css

我有一个`DIV`875 像素宽的。它从页面的左边距开始。它的`CSS`类是

```
.three-column

    {
        width:875px;
        float:left;
    } 
```

里面`DIV`就是另一个`DIV`。这`DIV`包含标签和下面描述的字段。我希望这些 DIV 从主容器的左上角开始，从左到右流动，然后到下一行。这适用于包含的 CSS。它的`CSS`类是

```
.LabelAndField
{
    width: 240px;
    margin-left:auto;
    float:left; 
} 
```

这是字段的 CSS（输入框）

```
fieldset input[type="text"].editor-field-score
{
    border: 1px solid #cccccc;     
    font-size: 1.0em;
    font-weight: 600;   
    padding: 5px;
    margin-right : 20px;
    float : right;
    width : 50px;
    text-align: right;
} 
```

这是标签的 CSS

```
fieldset .editor-label-score 
{
    float:left;
    font-size: 1.0em;
    font-weight: normal;
    padding-right: 10px;
    margin :10px 0px 0px 0px;
    color: #9900CC;
    text-align: right;
} 
```

我希望输入框在 LabelAndField DIV 中右对齐。然后，我希望标签紧靠输入框。由于较短的文本标签而导致的任何额外空间应出现在标签的左侧。我该怎么做呢？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-07T21:38:01.477

`text-align: right;` 会这样做，但这适用于 children ，而不是元素本身

```
fieldset .editor-label-score 
{
    float:left;
    font-size: 1.0em;
    font-weight: normal;
    padding-right: 10px;
    margin :10px 0px 0px 0px;
    color: #9900CC;
    text-align: right;
} 
```

没关系，就这样做

```
<fieldset class="editor-label-score">
     <a>description of TxtBox</a>
</fieldset> 
```

# android - 快速而肮脏的 android 模块创建，无需使用 Eclipse IDE 构建 jar 文件

> ID：13278619
> 
> 赞同：1
> 
> 时间：2012-11-07T21:33:21.150
> 
> 标签：android, dynamic, jar, module, executable

我目前正在开发一个允许我动态加载模块的 android 应用程序。因此，我可以拥有任意数量的模块，而我的主应用程序只需要加载它们。

我已经设法在很大程度上完成了这项工作 - 但我想创建一个可执行文件来“加速”模块创建过程，甚至只是找到一种方法来简化所涉及的步骤。

要创建一个模块，我目前必须执行以下操作：

1.  构建包含我的模块所需文件的 android 项目 [它们都不是活动类 - 所以我根本不必担心 androidmanifest 文件]
2.  使用eclipse IDE jar创建工具选择我要编译成.class的src文件放入我的jar中，并为这个jar指定我自己的自定义manifest文件，以及将我用于模块的所有图片打包成罐子也是。
3.  然后使用 jar 文件我对其运行 dex creator 命令从 jar 中包含的类文件生成 .dex 文件，然后使用 aapt 命令将 dex 文件推回 jar 文件中。
4.  此时，jar（现在它是一个模块）已创建，我可以将它放在服务器上进行下载，在我的应用程序中下载模块并使用反射在我的应用程序中加载我需要的所有代码。

我研究过用蚂蚁建造。对于我希望实现的目标来说，它看起来相当复杂，我不太确定从哪里开始。

我显然不能使用简单的 javac 来编译我的模块 src 中包含的 java 文件，因为所有这些代码都引用了 android sdk 以及在我的主应用程序和我各自的模块之间共享的静态库。

目前我使用 Eclipse IDE 来创建包含所有打包图像、类文件、清单的初始 jar，然后我使用两个单独的批处理文件调用 android-sdk 来创建 dex 并将 dex 推送到 jar 中。

我可以用一个简单的步骤来简化这个过程吗？或者正在尝试这样做——一个完整的项目？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-08T00:05:42.047

> 我研究过用蚂蚁建造。对于我希望实现的目标来说，它看起来相当复杂，我不太确定从哪里开始。

[Ant 的文档](http://ant.apache.org)是在线的，使用 An t[构建 Android 项目的文档也是如此。](http://developer.android.com/tools/projects/projects-cmdline.html)唯一的区别是您需要向`<jar>`Ant`build.xml`文件中添加一个任务，就像我在几个项目中所做的那样，例如[这个](https://github.com/commonsguy/cwac-endless)：

```
<target name="jar" depends="debug">
    <jar
        destfile="bin/CWAC-EndlessAdapter.jar"
        basedir="bin/classes"
    />
</target> 
```

也欢迎您考虑 Maven。虽然我个人不使用 Maven，但它有很多粉丝和社区驱动的 Android 支持。

也欢迎您使用任何适合您的编程语言编写自己的构建脚本：Java、Ruby、Perl、Python 等。

> 我显然不能使用简单的 javac 来编译包含在我的模块 src 中的 java 文件，因为所有这些代码都引用了 android sdk 以及在我的主应用程序和我各自的模块之间共享的静态库。

每个 Android IDE、Ant 和 Maven 等等，“使用简单的 javac 来编译 [一个 Android 项目的] java 文件”。他们只需将适当的 Android SDK JAR 文件添加到构建路径即可。

# ruby-on-rails - 约束 find_each

> ID：13278621
> 
> 赞同：0
> 
> 时间：2012-11-07T21:33:28.843
> 
> 标签：ruby-on-rails

我有一个选择语句，

```
SELECT `metrics`.* 
FROM `metrics` 
WHERE `metrics`.`engine` = 0 
  AND (`metrics`.connection_id = 27874) 
  AND (`metrics`.`id` > 181586235) 
ORDER BY `metrics`.`id` ASC LIMIT 1000 
```

这是通过`find_each`调用关系（例如`metric.engines.find_each`）生成的。此 select 语句每次运行时扫描 1500 万条记录。

我想通过告诉查询只查找`metrics.id`s 的范围（例如`metrics.id > 1 AND metrics.id < 1000`）来减轻数据库的负担。

有没有办法做到这一点`find_each`？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-07T21:58:54.857

`find_each`可以像所有查找器方法一样应用于范围：

```
Metric.where("metrics.id between 1 and 1000"]).find_each { ... } 
```

编辑：如果您需要处理所有记录但不想一次全部加载，您可以使用[find_in_batches](http://api.rubyonrails.org/classes/ActiveRecord/Batches.html#method-i-find_in_batches)方法：

```
Metric.find_in_batches do |batch|
  batch.each { ... }
end 
```

# string - Bash/Shell 如何删除变量中的多余空格？

> ID：13278626
> 
> 赞同：1
> 
> 时间：2012-11-07T21:33:41.300
> 
> 标签：string, bash

如何删除变量中的多余空格？

```
VAR="    Eget ac vel volutpat      dic  tumst   est dui      adipiscing  "

Correct result: VAR="Eget ac vel volutpat dic tumst est dui adipiscing" 
```

有超过 16,000,000 个待编辑；`sed`太慢了！

！！！编辑 ！！！

字符串OK！谢谢你们

但

数组问题中的文本，仍然存在差距:-(

```
ITM=("  Eget ac  vel volutpat   |  Vel volutpat     dic tumst "
     "    Vestibulum  laoreet     a semper  |orttitor      eu laoreet justo congue ")

IFS=$'|'

for (( i=0 ; i<16000000 ; i++ ))
do
    AAA=( ITM[$i] )
    B=${AAA[0]}     # "  Eget ac  vel volutpat   "
    C=${AAA[1]}     # "  Vel volutpat     dic tumst "

done 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-07T21:53:37.603

您不需要为此生成子shell。只需使用 bash 的内置模式替换。

```
[ghoti@pc ~]$ shopt -s extglob
[ghoti@pc ~]$ VAR="    Eget ac vel volutpat      dic  tumst   est dui      adipiscing  "
[ghoti@pc ~]$ VAR=${VAR//+( )/ }
[ghoti@pc ~]$ echo "$VAR"
 Eget ac vel volutpat dic tumst est dui adipiscing 
[ghoti@pc ~]$ VAR=${VAR#+( )}
[ghoti@pc ~]$ echo "$VAR"
Eget ac vel volutpat dic tumst est dui adipiscing
[ghoti@pc ~]$ 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-07T21:34:55.620

只需删除引号，例如：

```
$ VAR="    Eget ac vel volutpat      dic  tumst   est dui      adipiscing  "     
$ echo $VAR
Eget ac vel volutpat dic tumst est dui adipiscing
$ echo "$VAR"
    Eget ac vel volutpat      dic  tumst   est dui      adipiscing  
$ 
```

如果你更喜欢 ：

```
$ VAR="    Eget ac vel volutpat      dic  tumst   est dui      adipiscing  "
$ VAR="$(echo $VAR)"
$ echo "$VAR"
Eget ac vel volutpat dic tumst est dui adipiscing 
```

这种行为称为*分词*。

**笔记**

如评论中所述，仅当您知道您的变量不包含特殊字符（如`*`.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-07T21:54:07.930

Shell 并没有真正设置为进行海量数据处理，甚至处理像折叠空间这样简单的处理。但这是一个不使用的解决方案`sed`

```
VAR="    Eget ac vel volutpat      dic  tumst   est dui      adipiscing  "
VAR=$(echo $VAR) 
```

此代码会将 VAR 设置为原始 var 的折叠版本。您可以通过执行以下命令来查看：

```
echo "$VAR" 
```

结果：

```
Eget ac vel volutpat dic tumst est dui adipiscing 
```

# php - PHP 正则表达式模式允许不需要的文字星号

> ID：13278627
> 
> 赞同：2
> 
> 时间：2012-11-07T21:33:43.590
> 
> 标签：php, regex, preg-match

我有一个正则表达式，它只允许 HTML 表单中名称字段中的特定字符，即字母、空格、单引号、连字符和句点。这是模式：

```
return mb_ereg_match("^[\w\s'-\.]+$", $name); 
```

问题是这种模式，由于某种原因，当 $name 中有文字星号时返回 true。除非我遗漏了什么，否则这是不可能的。我已经对文字星号进行了多次搜索，我发现的只是`"\*"`有意匹配它们的模式。

preg_match() 中的相同模式在传递“*John”之类的字符串时也会返回匹配项。

我到底错过了什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-07T21:36:55.067

您需要在这些代码前面添加一个双反斜杠。一个转义反斜杠，一个转义转义序列。

您还需要转义`-`，否则它接受“介于”`'`和之间的所有字符`.`。

```
return mb_ereg_match("^[\\w\\s'\\-\\.]+$", $name); 
```

看看一个工作案例（使用`preg_match`）：http: [//ideone.com/E8afAM](http://ideone.com/E8afAM)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-07T21:42:29.743

当括在方括号中时，连字符用作表示范围的特殊字符。在您的情况下，它将范围内的所有字符匹配`'`到`.`.

转义连字符应该返回所需的结果：

```
^[\w\s'\-\.]+$ 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-07T22:20:56.420

> 我有一个正则表达式，它只允许 HTML 表单中名称字段中的特定字符，即字母、空格、单引号、连字符和句点。

你错过了，那`\w`不是*字母*字符。[php.net](http://www.php.net/manual/en/regexp.reference.escape.php)说：

> “单词”字符是任何字母或数字或下划线字符，即任何可以成为 Perl “单词”一部分的字符。

而且，[perl 的定义](http://perldoc.perl.org/perlrecharclass.html)是：

> A`\w`匹配单个字母数字字符（字母字符或十进制数字）或*连接标点*字符，例如下划线 ("_")。

连接的*标点符号**应该*仅在我阅读时表示，`_`但这可能是多字节扩展的错误。

如果您`mb_ereg_match`仅用于整个 unicode 匹配，请尝试使用`preg_match`'s[`/u`修饰符](http://www.php.net/manual/en/reference.pcre.pattern.modifiers.php)和[Unicode 字符属性](http://www.php.net/manual/en/regexp.reference.unicode.php)功能，因为 php 5.1.0

# regex - REGEX - 如何忽略 URLS 中的某些查询字符串，但不忽略其他字符串

> ID：13278631
> 
> 赞同：2
> 
> 时间：2012-11-07T21:33:55.460
> 
> 标签：regex, wordpress, match

我需要将旧博客 URL 重定向到新博客 URL。ID 字段是关键查询字符串，查询字符串中的其他所有内容都应忽略。高层次的逻辑：

如果旧的不区分大小写的 URL 匹配：`/Blog/Post.aspx?`+ URL`ID=33`查询字符串中的任何位置，那么我将重定向到：`/newblog/newurl/`

当前正则表达式代码：`(?i:/Blog/Post.aspx)|(\?)|(?i:id=33)`

```
Success: /Blog/Post.aspx?id=33
Fails: /Blog/Post.aspx?ignore=me&id=33
Fails: /Blog/Post.aspx?ignore=me&id=33&ignoreme=too 
```

我如何让它忽略潜在的未知查询字符串`ignore=me`and `ignoreme=too`，但仍然想出一个 REGEX 匹配以`ID=33`在查询字符串中重定向？

感谢您的回答 m.buettner！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-07T21:50:34.017

现在你甚至会重定向，如果你**只有** `ID=33`在你的 URL 中，或者即使你在那里**只有**一个问号。我想这不是你想要的。您可能正在寻找这样的东西：

```
(?i:/Blog/Post.aspx\?.*id=33(?!\w)).* 
```

这将需要`/Blog/Post.aspx?`然后允许任意字符，直到`id=33`遇到。

根据您使用的语言，您还可以使用前瞻，这样可以更轻松地检查不同的参数，您可能不知道其顺序：

```
(?i:/Blog/Post.aspx\?(?=.*id=33(?!\w))).* 
```

这可以很容易地扩展到

```
(?i:/Blog/Post.aspx\?(?=.*id=33(?!\w))(?=.*another=requirement(?!\w))).* 
```

使用第一种方法，您必须为两个可能的订单添加两个备选方案。

**编辑：**所有三种解决方案的警告：在数字之后，它们需要一个非单词字符（除了字母、数字或下划线之外的任何字符）。`...id=33+34...`这意味着他们会在和等情况下给出误报`...id=33%2F...`。但这些不应该首先由 Wordpress 生成。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-07T22:08:53.117

操作，我打算提供一个通用答案来匹配 url 中的通用属性！好吧，我会把它留在这里以防你需要它

[演示](http://regex101.com/r/vK8vZ3)

`(?:(id|noignoreme|dontignoreme)=([^&\n]+)(?:\n|&|$))`

有了这个，您可以添加您想要接受的参数，它将返回为 group1（选项）和 group2（该选项的文本）。

之后你可以看看是否`ID = 33 then do that; else do thot;`

# sql - 不确定如何编写查询以返回与 group by 中的最大值关联的列

> ID：13278632
> 
> 赞同：0
> 
> 时间：2012-11-07T21:33:55.887
> 
> 标签：sql, database, postgresql

postgres 9.2 中的这个查询：

```
select max(amount) as max_analyte,concat(sarea,' ',sloc) as location,analyte
from sample natural join station
group by analyte,location
order by max_analyte desc; 
```

返回以下结果：

```
max_analyte;location;analyte
24196;"CANDLESTICK POINT WINDSURFER CIRCLE";"COLI_TOTAL  "
19863;"CHINA BEACH/BAKER BEACH LOBOS CREEK";"COLI_TOTAL  "
14136;"CRISSY FIELD EAST";"COLI_TOTAL  "
12033;"CHINA BEACH/BAKER BEACH BAKER BEACH WEST";"COLI_TOTAL  "
4352;"CHINA BEACH/BAKER BEACH LOBOS CREEK";"COLI_E      "
3076;"CHINA BEACH/BAKER BEACH BACKER BEACH EAST";"COLI_TOTAL  "
2851;"CHINA BEACH/BAKER BEACH LOBOS CREEK";"ENTERO      "
2064;"AQUATIC PARK SHORELINE";"COLI_TOTAL  "
1918;"CRISSY FIELD EAST";"ENTERO      "
...
...

74;"CHINA BEACH/BAKER BEACH CHINA BEACH";"ENTERO      "
41;"CRISSY FIELD WEST";"ENTERO      "
41;"OCEAN BEACH NORTH LINCOLN WAY";"ENTERO      "
31;"OCEAN BEACH NORTH LINCOLN WAY";"COLI_E      " 
```

该数据集包含在许多不同日期在湾区周围不同地点采样的 3 种细菌（COLI_TOTAL、COLI_E、ENTERO）的水平。上面的查询找到了每种细菌在每个位置的最大值，但现在我想找到与每个位置的最大值相关联的细菌类型。我只是不确定如何编写该查询。我应该提到我这样做是为了提高我的 SQL 技能。感谢您的任何帮助/建议。

表模式如下：

```
CREATE TABLE sample
(
  analyte character(12),
  amount integer,
  sdate date,
  sid character varying(20)
)

CREATE TABLE station
(
  sid character(20),
  sarea character varying(24),
  sloc character varying(24),
  sfreq character varying(24)
) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-07T21:44:23.263

这有点复杂，但这是一个可行的解决方案：

```
with cte as (
select max(amount) as max_analyte,
       concat(sarea,' ',sloc) as location,
       analyte
from sample natural join station
group by analyte,location
)
select location, analyte, max_analyte
from (
  select location, analyte, max_analyte,
         row_number() over (partition by location order by max_analyte desc) rn
  from cte
) A
where rn = 1; 
```

该`with cte`部分基本上将您之前的查询包装起来，以便以后可以再次使用它，`cte`就像它只是另一个表一样引用它（这称为公共表表达式）。然后在子查询中使用该 CTE，该子查询对每个位置从 1 开始的行进行编号。后面括号中的查询部分`over`告诉`row_number()`如何对它编号的行进行排序以及何时从 1 重新开始。最后，当我们抓取第 1 行（每个位置的最大值）时，它就全部结束了。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-07T22:26:06.333

我想我有一个可行的解决方案：

```
select distinct concat(sarea,' ',sloc), analyte, amount from 
    (sample natural join station) as t1 
    join
    (
        select sid,max(amount) as max_amount from 
        sample group by sid
    ) as t2 
    on t1.sid=t2.sid and t1.amount=t2.max_amount
    order by amount desc;

"CANDLESTICK POINT WINDSURFER CIRCLE";"COLI_TOTAL  ";24196
"CHINA BEACH/BAKER BEACH LOBOS CREEK";"COLI_TOTAL  ";19863
"CRISSY FIELD EAST";"COLI_TOTAL  ";14136
"CHINA BEACH/BAKER BEACH BAKER BEACH WEST";"COLI_TOTAL  ";12033
"CHINA BEACH/BAKER BEACH BACKER BEACH EAST";"COLI_TOTAL  ";3076
"AQUATIC PARK SHORELINE";"COLI_TOTAL  ";2064
"CANDLESTICK POINT SUNNYDALE COVE";"COLI_TOTAL  ";1723
"CANDLESTICK POINT JACKRABBIT BEACH";"COLI_TOTAL  ";1529
"AQUATIC PARK HYDE STREET PIER";"COLI_TOTAL  ";933
"CRISSY FIELD WEST";"COLI_TOTAL  ";884
"OCEAN BEACH NORTH BALBOA STREET";"COLI_TOTAL  ";789
"OCEAN BEACH SOUTH SLOAT";"COLI_TOTAL  ";771
"OCEAN BEACH NORTH LINCOLN WAY";"COLI_TOTAL  ";563
"CHINA BEACH/BAKER BEACH CHINA BEACH";"COLI_TOTAL  ";328 
```

看起来“COLI_TOTAL”始终是每个位置的最大值，考虑到名称，这是有道理的。

# gerrit - Gerrit 管理员角色

> ID：13278634
> 
> 赞同：1
> 
> 时间：2012-11-07T21:34:28.607
> 
> 标签：gerrit

我想知道是否有办法检查谁是某个安装的 gerrit 管理员。

作为普通用户，如果我尝试运行 sql 查询来检查用户列表，我会收到错误：致命：不是 Gerrit 管理员

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-10-18T17:04:47.233

作为管理员组的成员，您可以转到人员 > 组，然后选择管理员组，然后会显示成员。

如果您不是管理员，则 AFAIK 无法列出它们。

# sql-server - 什么是 sql server 中存储过程的包装器？

> ID：13278641
> 
> 赞同：-1
> 
> 时间：2012-11-07T21:34:56.237
> 
> 标签：sql-server, stored-procedures

sql server中存储过程的包装器的定义是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-07T21:57:26.013

你没有给我们太多的东西，但我怀疑你在谈论存储过程的 C# 包装器。这只是允许您拥有一个从代码调用存储过程的方法。例如，如果您有一个名为的存储过程，`DeleteUser` 您可以像这样制作一个 .NET 包装器：

```
private void DeleteUser(int UserId)
{
   //Call your stored proc from here
} 
```

# javascript - dojo ValidationTextBox 工具提示位置

> ID：13278642
> 
> 赞同：0
> 
> 时间：2012-11-07T21:34:58.550
> 
> 标签：javascript, dojo, textbox, position, tooltip

如何在验证文本框中定义工具提示的位置（默认为左侧）？

我的代码是：

```
var textBox = new dijit.form.ValidationTextBox({
   name : "someName",
   value : "someValue",
   regExp : "someExpression",
   invalidMessage : "someError"
}, "someId"); 
```

如果我添加

```
tooltipPosition: "below" 
```

然后我得到一个错误。我需要在文本框下方显示我的工具提示。怎么做？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-08T08:38:46.340

参数 tooltipPosition 需要一个数组。以下应该有效：

```
var textBox = new dijit.form.ValidationTextBox({
    name : "someName",
    value : "someValue",
    regExp : "someExpression",
    invalidMessage : "someError",
    tooltipPosition: ["below"]
}, "someId"); 
```

您可以在此处提供首选项列表，以便 Dojo 尝试将工具提示放置在最佳位置。使用，例如：

```
tooltipPosition: ["below","above","after","before"] 
```

可能会更好，因为它会在下面显示工具提示，除非屏幕上没有空间。如果没有空间，它会在上面尝试，然后在之后，......等等。

有关工具提示定位的更多信息，请参阅：

*   [dijit/工具提示文档](http://dojotoolkit.org/reference-guide/1.8/dijit/Tooltip.html)

# javascript - JQuery 选择器有选择地选择

> ID：13278643
> 
> 赞同：0
> 
> 时间：2012-11-07T21:34:58.433
> 
> 标签：javascript, jquery

我有以下 HTML

```
<i class="up_icon" id="1" />
<p class="position">1</p>
<i class="down_icon" id="1" /> 
```

我可以选择`.up_icon#1`但不能`.down_icon#1`

```
var u = $(".up_icon#1");     //=  [<i class=​"up_icon" id=​"1">​&lt;/i>​]

var d = $(".down_icon#1");   //=  [] 
```

我在这里想念什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-07T21:38:49.227

你不应该像那样复制 ID。ID 在文档中应该是唯一的。

在您的情况下，您可以使用 jQuery 属性选择器功能。见下文，

```
<i class="up_icon" data-id="1"/>
<p class="position">1</p>
<i class="down_icon" data-id="1"/> 
```

然后您可以通过`.up_icon[data-id=1]`and访问它们`.down_icon[data-id=1]`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-07T21:38:47.683

`can select .up_icon#1 but not .down_icon#1`

这是因为重复的 Id 是无效的 HTML 并丢弃了选择器。

jQuery 要求您在整个页面中拥有唯一的 ID，否则您将遇到意外的行为。

取自 jQuery id 选择器[**文档**](http://api.jquery.com/id-selector/)

> 每个 id 值只能在文档中使用一次。如果为多个元素分配了相同的 ID，则使用该 ID 的查询将仅选择 DOM 中第一个匹配的元素。但是，不应依赖此行为；具有多个使用相同 ID 的元素的文档无效。

将您的 HTML 更改为：

```
<i class="up_icon" id="1" />
<p class="position">1</p>
<i class="down_icon" id="2" /> 
```

现在您可以选择`.up_icon#1`或`.down_icon#2`。

显然，如果您能找到一种方法来应用除普通数字之外的更具描述性的标识符，以防止任何事情重复发生。
如果需要，您还可以使用可选的数据属性`data-value="1"`来存储任何序列或记录 ID。jQuery 选择器对于数据属性或类中的相同值没有问题。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-07T21:36:52.597

您永远不应该将相同的 ID 分配给多个标签

还：

从 HTML 规范：

> ID 和 NAME 标记必须以字母 ([A-Za-z]) 开头，后跟任意数量的字母、数字 ([0-9])、连字符 ("-")、下划线 ("_") , 冒号 (":") 和句点 (".")。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-07T21:38:40.397

你应该切换你的类和 id 定义。试试这个：

```
<i id="up_icon" class="1" />
<p class="position">1</p>
<i id="down_icon" class="1" />

var u = $("#up_icon.1");

var d = $("#down_icon.1"); 
```

# algorithm - 在 Clojure 中实现 Minimax 算法 - 具有多个递归调用的条件函数

> ID：13278646
> 
> 赞同：4
> 
> 时间：2012-11-07T21:35:14.853
> 
> 标签：algorithm, recursion, clojure, tic-tac-toe, minimax

*在我弄清楚了一些事情之后，这个问题和我的另一个问题合二为一，所以我修改了这个问题。*

下面概述了我试图用我的功能完成的事情。

1.  遍历所有的点。如果它是开放的，请选择带有当前玩家符号的位置。
2.  如果这一举动导致游戏获胜并且轮到计算机玩家，则将点的键值对（整数）和点的分数（整数，在本例中为 1）添加到`scored-spots`哈希图中。
3.  递归并调用这个相同的函数，传递给它*新* `scored-spots`的哈希映射、刚刚移除的棋盘、*相同*的玩家和*相同*的符号。
4.  但是，如果游戏没有获胜，请继续下一个条件语句并检查它。
5.  以相同的方式继续下一个条件语句，只是分数不同（轮到计算机获胜为 1，轮到人类获胜为 -1，平局为 0）。
6.  如果没有条件语句评估为真，则无论如何都要递归（`scored-spots`在这种情况下哈希映射不会有任何不同）。

这是我尝试过的代码，但这并没有返回我期望的值。

注意：
`board`是这样的散列图：（`{0 "0", 1 "1", 2 "2"}`点位置 - 点值）
`sym`是一个符号，如“X”或“O”
`current-player`是关键字，如`:computer`或是`:human`
`scored-spots`这样的散列图：`{}`

```
(defn score-spots [board sym current-player scored-spots]
  (for [spot (keys board)]
    (if (some #(= % (.toString spot)) (filter #(not= "O" %) (filter #(not= "X" %) (vals board))))
      (let [board (assoc board spot sym)]
        (cond
          (and (game-won board) (= current-player :computer))
            (score-spots board sym current-player (assoc scored-spots spot 1))
          (and (game-won board) (= current-player :human))
            (score-spots board sym current-player (assoc scored-spots spot -1))
          (game-tied board)
            (score-spots board (switch-symbol sym) (switch-player current-player) (assoc scored-spots spot 0))
          :else
            (score-spots board (switch-symbol sym) (switch-player current-player) scored-spots)))
  scored-spots)))) 
```

我期望的返回值是一个散列图，每个开放点都得分。例如，`{1 0, 4 1, 5 -1, 6 -1, 8 0}`。

相反，如果我通过这个 board:
`{1 "X" 2 "X" 3 "O" 4 "4" 5 "5" 6 "6" 7 "7" 8 "X" 9 "O"}`，
我会得到一个带有大量`list`哈希映射的返回值。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-13T18:25:53.920

一般来说，我对 Clojure 和 FP 比较陌生。每当我想到递归时，我总是首先尝试考虑它是否是`map`和/或的机会`reduce`。

在这种情况下，您正在尝试对*每个*位置进行评分。*收集*在一起的每个点都是一块板。因此，如果我可以对每个点进行评分，然后将它们收集在一起，我就可以完成手头的任务。就`reduce`术语而言，我可以对集合中的一个项目（点）做一些事情，然后将该值合并为一个值（板 - 从技术上讲，只有在下面的代码中没有“X”或“O”的点）。

这是我的重写：

```
(defn score-spot [scored-spot current-player board]
  (let [[spot score] scored-spot]
    (cond
      (and (game-won board) (= current-player :computer)) {spot 1}
      (and (game-won board) (= current-player :human)) {spot -1} 
      (game-tied board)  {spot 0}
      :else {spot score})))

(defn score-board [board current-player]
  (let [spots-to-score (filter #(and (not= "X" (second %))
                                     (not= "O" (second %))) board)]
    (reduce #(into %1 (score-spot %2 current-player board)) {} spots-to-score))) 
```

这会给你的结果，例如`{1 0, 4 1, 5 -1, 6 -1, 8 0}`

* * *

编辑：

关于递归的需要，您基本上是想使用相互递归。为此，您可以使用[declare](http://clojure.github.com/clojure/clojure.core-api.html#clojure.core/declare)转发声明函数，然后使用[trampoline](http://clojure.github.com/clojure/clojure.core-api.html#clojure.core/trampoline)（[这里是一个快速教程](http://jakemccrary.com/blog/2010/12/06/trampolining-through-mutual-recursion/)）进行实际递归。

# objective-c - 目标 c __block 变量

> ID：13278647
> 
> 赞同：0
> 
> 时间：2012-11-07T21:35:20.390
> 
> 标签：objective-c, objective-c-blocks

我目前正在努力为什么以下代码没有记录我使用的 NSString。

```
-(BOOL)login:(NSString *)email withPassword:(NSString *)password error:(NSError *__autoreleasing *)error
{

__block BOOL success = NO;

if (*error)
    return success;

__block NSString *domain = @"de.FranzBusch.Searchlight.ErrorDomain";
__block NSError *localerror = nil;

//HTTP Request
NSURL *url = [NSURL URLWithString:@"Wrong URL to test the failure block"];
AFHTTPClient *client = [[AFHTTPClient alloc] initWithBaseURL:url];

NSDictionary *params = [NSDictionary dictionaryWithObjectsAndKeys:
                        email, @"email",
                        password, @"password", nil];

NSMutableURLRequest *request = [client requestWithMethod:@"POST" path:@"" parameters:params];
AFKissXMLRequestOperation *operation = [AFKissXMLRequestOperation XMLDocumentRequestOperationWithRequest:request
success:^(NSURLRequest *request, NSHTTPURLResponse *response, DDXMLDocument *XMLDocument)
{
}failure:^(NSURLRequest *request, NSHTTPURLResponse *response, NSError *HTTPError, DDXMLDocument *XMLDocument)
{
    localerror = [NSError errorWithDomain:domain code:-101 userInfo:[self generateErrorDictionary:@"HTTPError"]];
    success = NO;
}];
[operation start];

NSLog(@"test %@", [localerror domain]);
return success;
} 
```

如果我尝试在故障块中记录域，我会得到正确的。但是在范围之外，块变量没有被修改。Ans 对我理解错误的提示表示赞赏。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-07T21:45:00.983

问题是`success`and`failure`块在您的 `login:withPassword:error: 方法完成并返回后很长时间被调用，因为操作是在后台完成的。

当你的 NSLog 语句到达时，操作还没有完成，两个块都还没有执行。所以`localerror`仍然是`nil`，`success`仍然是否。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-07T21:46:04.677

块外调用的 NSLog 域将被更早地调用，因为它将在主线程上，并且 NSLog in failure block 在新线程中触发，并且在服务器响应之后。所以返回成功也返回未设置成功（在你的情况下为否）。

# cocos2d-iphone - Cocos2d-iphone 转换后无法播放我的 .caf 文件

> ID：13278649
> 
> 赞同：0
> 
> 时间：2012-11-07T21:35:25.057
> 
> 标签：cocos2d-iphone, caf

我遇到了和这个问题一样的问题：[SimpleAudioEngine, playing .caf files](https://stackoverflow.com/questions/10286686/simpleaudioengine-playing-caf-files) (which is closed)

但是，该解决方案不起作用。

我有`Battle.wav`，这很好用

```
[[SimpleAudioEngine sharedEngine]playBackgroundMusic:@"Battle.wav"]; 
```

现在，我想将其转换为 .caf。根据那个问题的答案，我应该使用这个终端线：

```
afconvert -f caff -d LEI16@22050 Battle.wav 
```

但是，生成的文件不起作用。当我使用：

```
[[SimpleAudioEngine sharedEngine]playBackgroundMusic:@"Battle.caf"]; 
```

当我这样做时，Xcode 会显示以下消息：

> AudioStreamBasicDescription: 2 ch, 44100 Hz, 'lpcm' (0x00000C2C) 8.24 位 little-endian 有符号整数，去交错

我真的不知道那是什么意思。然而，我所知道的是该文件确实没有声音。

播放 .caf 文件的问题[：在模拟器中运行良好，但在 iPhone](https://stackoverflow.com/questions/1363972/playing-a-caf-file-works-fine-in-simulator-but-not-in-iphone)中也无济于事（而且他们遇到的问题似乎与我在这里遇到的基本问题不同）。

Cocos2d-iphone 1.0.1，iPhone 4。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-07T21:41:30.340

[尝试使用Audacity](http://audacity.sourceforge.net)（免费）打开文件并将其导出为 AIFF (.caf )。如果是文件格式问题，那应该可以。

可能是一个问题的一件事是使用 2 个通道的 caf 文件。它可能像 SimpleAudioEngine 不支持立体声效果一样简单。如果您想要背景音乐，请使用 .mp3，因为它们可以在硬件中解码，并且通常要小得多。

# java - 我的程序没有计算正确的输出，我不知道为什么

> ID：13278650
> 
> 赞同：-1
> 
> 时间：2012-11-07T21:35:28.470
> 
> 标签：java, arrays, eclipse, class, jgrasp

我已经盯着这个程序看了好几个小时，也许第二个视角会有所帮助。

```
import java.util.Arrays;
import java.util.Random;

public class Examples

{
private int numbers[]; 
private String result;

     public Examples()
        {
     numbers = new int[10];
         Arrays.fill(numbers, 42);
        } 

        public Examples(int[] array)
        {
        numbers = Arrays.copyOf(array, array.length);
        }

 public void setNumbers (int numbers) 
    {                                           
    this.numbers = new int[numbers];
    }
 public int [] getNumbers()
 {                                      
    return numbers;
 }

public  String toString()
{
    String result = new String();
    int i;                                  
    for (i = 0; i < numbers.length; i++)
        result = numbers + "\t";
        return result;
} 
```

我应该创建一个存储整数的类，然后根据我提供的静态 void main 方法打印出某个输出。我目前正在使用的是，

```
{
   public static void main( String [] args )
   {
      int i;
      FunkyNumbers funNumbers, moreFun;

      System.out.println("FunkyClientA:");
      System.out.println("Test default constructor and toString method");
      System.out.println();

      funNumbers = new FunkyNumbers();
      System.out.println("toString result from funNumbers:");
      System.out.println( funNumbers.toString() );
      System.out.println();

      moreFun = new FunkyNumbers();
      System.out.println("toString result from moreFun:");
      System.out.println( moreFun.toString() );

   } // end of method main

} // 
```

结果应该是 Test 默认构造函数和 toString 方法

来自 funNumbers 的 toString 结果：42 42 42 42 42 42 42 42 42 42

来自 moreFun 的 toString 结果：42 42 42 42 42 42 42 42 42 42

但是我得到了，测试默认构造函数和 toString 方法

来自 funNumbers 的 toString 结果：[I@6e1408

来自 moreFun 的 toString 结果：[I@e53108

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-07T21:42:34.720

**问题：您总是分配一个新值`result`而不是附加。**

最好`StringBuilder`用作：

```
 StringBuilder result = new StringBuilder();
    for (int i = 0; i < numbers.length; i++)
        result.append(numbers + "\t");
    return result.toString(); 
```

如果不想使用`StringBuilder`那么

```
 String result = new String();
    for (int i = 0; i < numbers.length; i++)
        result = result + numbers + "\t";//append in result
    return result; 
```

还要确保该方法在`FunkyNumbers`课堂上可用。如果那里无法访问，则移动/复制那里。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-07T21:39:13.957

尝试

```
 result += numbers[i] + "\t"; 
```

在你的`ToString()`方法中

将代码包含在您的`FunkyNumbers`课程中，我也许可以提供更好的反馈。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-07T21:48:49.573

java中的数组是一个对象。因此，变量 funNumbers 的值不是数组，而是指向内存中数组所在地址的引用。当您使用时`toString()`，您在屏幕上打印此内存地址，而不是将数组打印为字符串。您应该使用 a`StringBuffer`来将数组“转换”为字符串。

```
private static String convertArrayToString(int[] a) {
        StringBuffer sb = new StringBuffer();
        for(int i=0; i<a.length; i++)
            sb.append(a[i]);
        return sb.toString();
    } 
```

您还可以使用`Arrays.toString(arg)`将数组“转换”为字符串。作为参数，你给你的数组，你得到你数组的字符串表示。如果您的数组是多维的，请`Arrays.deepToString(arg)`改用。

# ios - 从 MKMapView 中删除最后添加的注释

> ID：13278659
> 
> 赞同：0
> 
> 时间：2012-11-07T21:36:01.607
> 
> 标签：ios, mkmapview, mkannotation

有没有办法删除最后添加的注释？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-07T21:43:18.627

`[self.mapView removeAnnotation:self.mapView.annotations.lastObject];`

# javascript - 如何取消已经使用 JavaScript 进行的浏览器导航

> ID：13278660
> 
> 赞同：3
> 
> 时间：2012-11-07T21:36:07.580
> 
> 标签：javascript, browser

我不相信这是可能的，但我想我会试一试。

作为我正在处理的项目的一部分，用户可以通过标准锚链接导航到不同站点上的页面。目标页面有时响应速度很慢，客户端希望设置“超时”，以便如果导航到目标页面花费的时间过长，则取消浏览器导航并显示消息。

是否可以使用 Javascript 取消已经在进行中的浏览器导航（即已经发出对目标站点的请求）？如果是这样，怎么做？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-07T21:48:55.737

我进行了一个简单的测试，是可以的。我使用 PHP 进行测试，但如果您使用不同的语言，这将不是问题。底线是 JavaScript 可以做到这一点，如`cancel.php`. 请看示例代码：

## 睡眠.php

```
<?php
sleep(30);
echo 'hello';
?> 
```

## 取消.php

```
<h1>hello?</h2>
<script type="text/javascript">
location.href='sleep.php';
setTimeout(function(){
    location.href='#';
    alert('it is taking too long to respond, probably the site is down!');
}, 10000);
</script> 
```

运行cancel.php后，会重定向到sleep.php。在 10 秒的加载时间后，它将停止加载 sleep.php 并得出该站点已关闭的结论。

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2012-11-07T21:47:02.057

您可以重定向到其他地方，而当前的 DOM 仍然存在。

我运行了这个简单的测试，它重定向到 yahoo.com

```
$("#btn").click(function() {
    document.location.href = "http://www.google.com";
    document.location.href = "http://www.yahoo.com";
});​ 
```

我没有用计时器测试过，但似乎它应该可以工作，虽然我不能确定 100%。请发表你的发现！

# asp.net-mvc-3 - 带有“？”的 MVC url.action 来自telerik网格的变量之前

> ID：13278661
> 
> 赞同：0
> 
> 时间：2012-11-07T21:36:08.623
> 
> 标签：asp.net-mvc-3, grid, url-routing, telerik-mvc

我在我的应用程序中使用 Telerik MVC 网格，尝试使用以下命令打开视图：

```
columns.Template(item => Html.Raw("<a href=\"" + Url.Action("Action", "Controller", new { id = item.ID}) + "\">" + item.Name + "</a>")).Title("Go").Width(300); 
```

我得到的网址是：

```
http://localhost:xxx/Controller/Action/54 
```

但是，视图显示正常，但它不能正常运行，url 应该是：

```
http://localhost:xxx/Controller/Action?id=54 
```

我会很感激你的建议。提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-07T21:40:05.873

如果您的 Action 方法的参数名称是 id 并且您具有正常的路由设置，则两者将相同。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-07T22:48:49.670

我发现问题出在 JW 视频播放器的路径上：原来我是这样的：

```
 type: "flash", src: "../Video/player.swf" 
```

当我将 url 发送为 ?id=xx 但当它是 /xx 时效果很好

我将其更改为：

```
 type: "flash", src: "../../Video/player.swf" 
```

这适用于两个网址！不明白为什么，但它有效。

# javascript - Javascript 正则表达式 - 如何不匹配 < 和 > 之间的子字符串

> ID：13278664
> 
> 赞同：1
> 
> 时间：2012-11-07T21:36:15.850
> 
> 标签：javascript, regex, string

我正在使用这个正则表达式：

```
var regex = /\<.*?.\>/g 
```

匹配这个字符串：

```
var str = 'This <is> a string to <use> to test the <regular> expression' 
```

使用简单的匹配：

```
str.match(regex) 
```

并且，正如预期的那样，我得到：

```
["<is>", "<use>", "<regular>"] 
```

（但没有反斜杠，抱歉任何潜在的混淆）

我怎样才能得到相反的结果？即我需要什么正则表达式不返回包含在`<`and之间的那些项目`>`？

我尝试`/(^\<.*?\>)/g`了各种其他类似的组合，包括方括号和其他东西。我有很多很酷的结果，但没有什么是我想要的。

我要去哪里：基本上我想搜索和替换子字符串的出现，但我想排除一些搜索空间，可能使用<和>。我真的不想要一种破坏性的方法，因为我不想分解字符串、更改它们并担心重建它们。

当然，我可以通过搜索字符串来“手动”执行此操作，但我认为正则表达式应该能够很好地处理这个问题。唉，我的知识不是它需要的地方！！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-07T22:18:13.480

这是一种自定义替换标签之外所有内容的方法，并从标记部分中剥离标签[http://jsfiddle.net/tcATT/](http://jsfiddle.net/tcATT/)

```
var string = 'This <is> a string to <use> to test the <regular> expression';
// The regular expression matches everything, but each val is either a
// tagged value (<is> <regular>), or the text you actually want to replace
// you need to decide that in the replacer function
console.log(str.replace( /[^<>]+|<.*?>/g, function(val){
    if(val.charAt(0) == '<' && val.charAt(val.length - 1) == '>') {
      // Just strip the < and > from the ends
      return val.slice(1,-1);
    } else {
      // Do whatever you want with val here, I'm upcasing for simplicity
      return val.toUpperCase(); 
    }
} ));​
// outputs: "THIS is A STRING TO use TO TEST THE regular EXPRESSION" 
```

为了概括它，你可以使用

```
function replaceOutsideTags(str, replacer) {
    return str.replace( /[^<>]+|<.*?>/g, function(val){
        if(val.charAt(0) == '<' && val.charAt(val.length - 1) == '>') {
          // Just strip the < and > from the ends
          return val.slice(1,-1);
        } else {
          // Let the caller decide how to replace the parts that need replacing
          return replacer(val); 
        }
    })
}
// And call it like
console.log(
    replaceOutsideTags( str, function(val){
        return val.toUpperCase();
    })
); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-07T22:28:37.200

如果我理解正确，您想对字符串应用一些自定义处理，除了*受保护*`<`的部分（用and括起来`>`）？如果是这种情况，您可以这样做：

```
// The function that processes unprotected parts
function process(s) {
    // an example could be transforming whole part to uppercase:
    return s.toUpperCase();
}

// The function that splits string into chunks and applies processing
// to unprotected parts
function applyProcessing (s) {
    var a = s.split(/<|>/),
        out = '';

    for (var i=0; i<a.length; i++)
        out += i%2
                ? a[i]
                : process(a[i]);

    return out;
}

// now we just call the applyProcessing()
var str1 = 'This <is> a string to <use> to test the <regular> expression';
console.log(applyProcessing(str1));
// This outputs:
// "THIS is A STRING TO use TO TEST THE regular EXPRESSION"

// and another string:
var str2 = '<do not process this part!> The <rest> of the a <string>.';
console.log(applyProcessing(str2));
// This outputs:
// "do not process this part! THE rest OF THE A string." 
```

基本上就是这样。它返回处理未受保护部分的整个字符串。

请注意，如果尖括号 (`<`和`>`) 不平衡，拆分将无法正常工作。

有很多地方可以改进，但我会把它留给读者作为excersize。;p

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-11-08T00:09:52.923

这是将正则表达式参数传递给核心`String.split()`方法的完美应用程序：

```
var results = str.split(/<[^<>]*>/); 
```

简单的！

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-11-07T21:40:25.027

使用您已经创建的变量，尝试使用`replace`. 它也是非破坏性的。

```
str.replace(regex, '');
--> "This  a string to  to test the  expression" 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-11-07T22:37:16.420

```
/\b[^<\W]\w*(?!>)\b/g 
```

这行得通，测试一下：

```
var str = 'This <is> a string to <use> to test the <regular> expression.';
var regex = /\<.*?.>/g;
console.dir(str.match(regex));
var regex2 = /\b[^<\W]\w*(?!>)\b/g;
console.dir(str.match(regex2)); 
```

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2012-11-07T21:47:25.397

啊，好吧，对不起 - 我误解了你的问题。这是用javascript中的纯正则表达式解决的一个难题，因为javascript不支持lookbehinds，通常我认为我会使用lookaheads和lookbehinds来解决这个问题。一种（某种人为的）方法是这样的：

```
str.replace(/((?:<[^>]+>)?)([^<]*)/g, function (m, sep, s) { return sep + s.replace('test', 'FOO'); })

// --> "This <is> a string to <use> to FOO the <regular> expression" 
```

这也适用于类似的字符串`"This test <is> a string to <use> to test the <regular> expression"`，如果你在替换函数中使用`/test/g`而不是`'test'`，它也会变成

```
"This test <is> a string to <use> to test the test <regular> expression" 
```

进入

```
"This FOO <is> a string to <use> to FOO the FOO <regular> expression" 
```

**更新**

像这样的东西也会去掉 <> 字符：

```
str.replace(/((?:<[^>]+>)?)([^<]*)/g, function (m, sep, s) { return sep.replace(/[<>]/g, '') + s.replace(/test/g, 'FOO'); })

"This test <is> a string to <use> to test the test <regular> expression"
--> "This FOO is a string to use to FOO the FOO regular expression" 
```

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2012-11-07T21:53:07.973

试试这个正则表达式：

```
\b\w+\b(?!>) 
```

更新

要支持括号内的空格，请尝试这个。它不是纯粹的 regex.match，但它可以工作，而且比上面的答案要简单得多：

```
alert('This <is> a string to <use use> to test the <regular> expression'.split(/\s*<.+?>\s*/).join(' ')); 
```

# c# - 从 SQL Server BLOB 创建图像非常缓慢

> ID：13278669
> 
> 赞同：0
> 
> 时间：2012-11-07T21:36:40.823
> 
> 标签：c#, sql-server-2008

在将 BLOB (jpg) 从 SQL Server 2008 转换为文件系统上的文件时，是否有人遇到过任何问题？检索 blob 然后创建文件需要 5-8 秒

最终，我将存储文件路径并进行类似的快速查找，但是对于每个 jpeg 的初始命中，创建文件需要很长时间，我必须假设有一种方法可以使它更快，或者我只是这样做在 C# 中错误或效率低下。

这是我从数据库中获取它的方式：

```
memberPhoto.PhotoBinary = (byte[])reader.GetValue(ordinals[(int)Enums.MemberPhotoColumn.PhotoBinary]) 
```

这是我创建文件的方式：

```
 using (FileStream file = File.Create(photoPhysicalFilepath))
        {
            BinaryWriter writer = new BinaryWriter(file);
            writer.Write(photoBinary);
            writer.Flush();
        }

        return relativePhotoFilePath; 
```

photoBinary 是我从数据读取器获得的 byte[] 值。

不确定这是否有效。我见过人们走这条路，但不明白这是否是一种旧的方式，我发现了一种更优雅的语法方式，或者我的方式只是我发现的一种更优雅的方式：

```
 fs = new FileStream(FilePath, FileMode.Create);

                    fs.Write(imageData, 0, imageData.Length);
                    fs.Close();

                    MimeType = image.MIMEType;

where imageData is again a byte[] 
```

所以我想知道是否有人按照我的方式做到了，或者您通常使用第二种语法......在任何人遇到过的大型网站上，第二种与第一种相比是否有任何性能提升？

最终只是想弄清楚为什么 blob 需要这么长时间才能创建文件。

# oracle - 有没有更有效的方法来计算 Oracle SQL 中的聚合记录数？

> ID：13278670
> 
> 赞同：0
> 
> 时间：2012-11-07T21:36:47.013
> 
> 标签：oracle, query-optimization, aggregate-functions

我在 MySQL 和 MSSQL 方面有更多经验，但我不认为自己是 SQL 专家。

我需要在 Oracle 数据库上运行一些 SQL 工作。甚至还不确定版本，但它应该是最近的（10、11？？）。

无论如何，我必须计算跨越两个表的不同记录的数量。为了争论起见，我们称它们为`master`and `detail`。

以下 SQL 为我提供了我想要的数据。但是，此 SQL 最终将被放入 UDF（或 Oracle 等价物）中。但我的问题是，有没有更好的方法？要么使用一些高级的 Oracle 优化，甚至只是一个更好的 SQL 查询。

谢谢

```
select count(*) from
(
  select 
    mas.barcode
  , det.barcode_val

  from mas 
    inner join det on (det.trans_id = mas.trans_id and mas.trans_sub_id = det.trans_sub_id)
  where 
    mas.trans_id = 12345
    and det.code_type = 'COMMODORE'
  group by
    mas.barcode
  , det.barcode_val
); 
```

数据：

```
MAS

trans_id     trans_sub_id     barcode
-------------------------------------
12345                   1      COM_A
12345                   2      COM_A
12345                   3      COM_B

DET

trans_id     trans_sub_id     code_type     barcode_val
-------------------------------------------------------
12345                   1     COMMODORE     C64
12345                   1     COMMODORE     C64
12345                   1     TANDY         TRASH80
12345                   2     COMMODORE     C128
12345                   2     ATARI         800XL
12345                   2     COMMODORE     AMIGA500
12345                   3     COMMODORE     C64

Results before count
--------------------
COM_A     C64
COM_A     C128
COM_A     AMIGA500
COM_B     C64

Results after count
-------------------
4 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-07T21:47:43.927

```
SELECT 
COUNT(DISTINCT mas.barcode || det.barcode_val)
FROM mas 
INNER JOIN det 
ON (det.trans_id = mas.trans_id and mas.trans_sub_id = det.trans_sub_id)
WHERE 
mas.trans_id = 12345
AND det.code_type = 'COMMODORE' 
```

或者

```
SELECT COUNT(*) FROM ( 
  SELECT DISTINCT mas.barcode, det.barcode_val
  FROM mas 
  INNER JOIN det 
  ON (det.trans_id = mas.trans_id and mas.trans_sub_id = det.trans_sub_id)
  WHERE 
  mas.trans_id = 12345
  AND det.code_type = 'COMMODORE'
) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-08T02:51:28.243

如果您使用

```
 COUNT(DISTINCT mas.barcode || det.barcode_val) 
```

确保在管道之间放置一个分隔符：

```
 COUNT(DISTINCT mas.barcode || '-' || det.barcode_val) 
```

例如想象以下场景：

```
 Column1    Column2   Column1 || Column2   Column1 || '-' || Column2
    A          B         AB                   A-B
    AB        <null>     AB                   AB-
    1          201       1201                 1-201
    <null>     1201      1201                 -1201 
```

该表有 4 行，有 4 个不同的值。但是如果你尝试一个

```
 COUNT(DISTINCT COLUMN1 || COLUMN2) 
```

你只会得到2个“不同的”组。只是一个提示，试图避免那些极端情况。

# c++ - 在 C++03 中将字符串转换为 int

> ID：13278674
> 
> 赞同：3
> 
> 时间：2012-11-07T21:36:55.893
> 
> 标签：c++, string, int, type-conversion, c++03

> **可能重复：**
> [如何在 C++ 中将字符串解析为 int？](https://stackoverflow.com/questions/194465/how-to-parse-a-string-to-an-int-in-c)

在 C++03 中有多种方法可以将字符串转换为 int。到目前为止我发现的最好的是：

```
string text;
cin>>text;
int converted;

if ( !(istringstream(text) >> converted) ){
    cout<<"conversion failed\n";
}
cout<<"the converted string is "<<converted; 
```

这个解决方案的问题是它接受“12monkeys”并毫不犹豫地将其转换为12。在这种情况下，是否有一些简单的方法可以检查并输出“转换失败”？

请注意，我已经尝试过 atoi()、atol() 和 strtol()，但如果失败则返回 0 的事实是徒劳的。我怎么知道字符串是否不是“0”？也没有范围检查（strtol() 除外）。没有提到那里也存在“12monkeys”问题。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-07T23:12:13.313

```
const char *string = "12monkeys";
char *end;
long value = std::strtol(string, &end, 10);
if (end == string)
    std::cout << "No number found\n";
else if (*end != '\0')
    std::cout << "Extra characters on end.\n"; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-07T22:13:44.107

您可以明确检查 eof ：

```
string text;
cin>>text;
int converted;

istringstream iss(text);
if ( !(iss >> converted) ){
    cout<<"conversion failed\n";
}
if( iss.get() != std::stringstream::traits_type::eof() ) {
    cout<<"cocnversion failed\n";
}
cout<<"the converted string is "<<converted; 
```

# eclipse - Eclipse 插件：在 Java 编辑器中放置自定义图标

> ID：13278677
> 
> 赞同：1
> 
> 时间：2012-11-07T21:37:08.233
> 
> 标签：eclipse, eclipse-plugin

我是 eclipse 的新手，但我想制作一些原型。API 有点像迷宫。我想以编程方式在编辑器的给定行上放置（然后移动/删除）一个图标，最好是在边距中。

这是一个例子：

![Java 编辑器中自定义图标的示例位置](../Images/21a1488f6f13a819f8f142e2b8faf1df.png)

有没有人有想法或实施某事的好策略？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-03T10:46:40.047

看看下面的扩展点[org.eclipse.ui.workbench.texteditor.rulerColumns](http://help.eclipse.org/indigo/index.jsp?topic=/org.eclipse.platform.doc.isv/reference/extension-points/org_eclipse_ui_workbench_texteditor_rulerColumns.html)

# c++ - sqlite3 事务和 exec 调用

> ID：13278679
> 
> 赞同：4
> 
> 时间：2012-11-07T21:37:13.000
> 
> 标签：c++, database, sqlite

我有一整套数据要插入到表中。我正在尝试让它插入/更新所有内容或回滚。我打算在事务中执行此操作，但我不确定*sql_exec()*命令是否执行相同操作。

我的目标是遍历列表。根据主键从每次迭代中选择。

```
If result was found:
  append update to string;
else
  append insert to string; 
```

然后在遍历循环之后，我会有一个巨大的字符串并说：

*sql_exec(字符串); sql_close(db);*

我应该这样做吗？我打算在循环的每次迭代中都这样做，但如果出现错误，我不认为全局回滚。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-08T05:17:27.133

不，您不应该将所有内容附加到一个巨大的字符串中。如果这样做，您将需要在进行时分配一大堆内存，并且为每个单独的语句创建好的错误消息将更加困难，因为您只会得到整个字符串的单个错误。当 SQLite 不得不再次将其解析回单独的语句时，为什么还要花费所有这些精力来构造一个大字符串？

相反，正如@Chad 建议的那样，您应该只使用`sqlite3_exec()`一个`BEGIN`语句，这将开始一个事务。然后`sqlite3_exec()`每个语句依次进行，最后`sqlite3_exec()`是一个`COMMIT`或`ROLLBACK`取决于一切如何进行。该`BEGIN`语句将启动一个事务，之后执行的所有语句都将在该事务中，因此一起提交或回滚。这就是[ACID](http://en.wikipedia.org/wiki/ACID)中的“A”所代表的意思；原子，因为事务中的所有语句都将被提交或回滚，就好像它们是单个原子操作一样。

`sqlite3_exec()`此外，如果每个语句中的某些数据不同，例如从文件中读取，您可能不应该使用。如果你这样做了，一个错误很容易给你留下一个[SQL 注入](http://en.wikipedia.org/wiki/SQL_injection)错误。例如，如果您通过附加字符串来构造查询，并且您有`char *str = "it's a string"`要插入的字符串，如果您没有正确引用它，您的语句可能会像`INSERT INTO table VALUES ('it's a string');`，这将是一个错误。或者，如果有人恶意将数据写入此文件，那么他们可能会导致您执行他们想要的任何 SQL 语句（[想象一下](http://xkcd.com/327/)，如果字符串是`"'); DROP TABLE my_important_table; --"`）。您可能认为没有恶意软件会提供输入，但如果有人将一个混淆 SQL 解析器的字符放入字符串中，您仍然可能会遇到意外问题。

相反，您应该使用[`sqlite3_prepare_v2()`](http://www.sqlite.org/c3ref/prepare.html)and [`sqlite3_bind_...()`](http://www.sqlite.org/c3ref/bind_blob.html)（`...`类型在哪里，例如`int`or`double`或`text`）。为了做到这一点，您可以使用类似的语句`char *query = "INSERT INTO table VALUES (?)"`，在其中将 a 替换`?`为您希望参数到达的位置，使用 准备它，使用`sqlite3_prepare_v2(db, query, -1, &stmt, NULL)`绑定参数`sqlite3_bind_text(stmt, 1, str, -1, SQLITE_STATIC)`，然后使用 执行该语句[`sqlite3_step(stmt)`](http://www.sqlite.org/c3ref/step.html)。如果语句返回任何数据，您将获得`SQLITE_ROW`，并且可以使用各种[`sqlite3_columne_...()`](http://www.sqlite.org/c3ref/column_blob.html)函数访问数据。请务必仔细阅读文档；我给出的一些示例参数可能需要根据您的使用方式进行更改。

是的，这比调用更痛苦`sqlite3_exec()`，但如果您的查询有任何从外部源（文件、用户输入）加载的数据，这是正确执行此操作的唯一方法。`sqlite3_exec()`如果查询的整个文本都包含在您的源代码中，则可以调用，例如`BEGIN`and `COMMIT`or`ROLLBACK`语句，或者没有来自程序外部的部分的预先编写的查询，如果有任何机会，您只需要准备/绑定意外的字符串可能会进入。

最后，您不需要查询数据库中是否已经存在某些内容，然后插入或更新它。您可以进行`INSERT OR REPLACE`查询，该查询将插入一条记录，或用匹配的主键替换一条记录，这相当于选择然后执行 an`INSERT`或 an `UPDATE`，但更快更简单。有关更多详细信息，请参阅[`INSERT`](http://www.sqlite.org/lang_insert.html)和[“冲突时”](http://www.sqlite.org/lang_conflict.html)文档。

# tfs - 如何为具有构建后事件的类库编写部署包脚本以在 TFS 构建上工作

> ID：13278683
> 
> 赞同：0
> 
> 时间：2012-11-07T21:37:31.380
> 
> 标签：tfs, tfsbuild, post-build-event

我们有一个包含许多类库项目的解决方案。它们各自产生一组 DLL。

我们想要部署这些的方式是将它们安装到 GAC。所以我们可以有一个脚本（BAT 文件）在 DLL 上运行 Gacutil /i。

我们目前使用 TFS 使用默认的 TFS 构建模板来构建我们的解决方案。

我们需要 TFS 来构建解决方案，并使用 DLL 和安装脚本为每个项目（发布包）生成文件夹。因此，之后我们需要做的就是转到放置文件夹，查看文件夹列表（发布包），以及在文件夹中安装每个类库所需的一切。

例如

```
-> 拖放文件夹
  - >项目1
     -> Proj1.dll
     -> 安装.bat
  - >项目2
     -> Proj2.dll
     -> 安装.bat
  -> Proj3
     -> Proj3.dll
     -> 安装.bat

```

***更新：***

对于每个项目，我都设置了以下构建后事件：

```
powershell -executionpolicy 绕过 -file "$(ProjectDir)Deployment\CreateDeploymentPackage.ps1" -Bin $(TargetDir) -Source $(ProjectDir) -Name $(ProjectName)

```

在我的源代码中，我有上述 powershell 脚本***Deployment\CreateDeploymentPackage.ps1***

powershell 脚本如下所示：

```
参数（
[string][parameter(mandatory=$true)] $Bin,
[string][parameter(mandatory=$true)] $Source,
[字符串][参数（强制=$true）]$Name）

$packagePath = "$Bin$Name"
新项目“$packagePath”-类型目录

复制项目 *.dll $packagePath -recurse

复制项目“$deploymentScripts\Install.ps1”“$packagePath”-recurse
复制项目“$deploymentScripts\Uninstall.ps1”“$packagePath”-recurse

```

现在这在我本地构建时有效。它拾取 bin 目录中的所有 dll 并将它们复制到文件夹中。

这也适用于 TFS 构建服务器，但仅适用于自行构建项目时。

问题在于 TFS 如何将我的解决方案中的所有 dll 构建到单个 bin 输出目录中。

**问题**

有没有办法只复制与项目相关的dll（包括依赖项）而不明确列出每个dll？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-07T22:09:26.413

1.  一点都不重要，您可以设置最适合您需要的源代码控制。

2.  阅读这篇[MSDN 文章](http://msdn.microsoft.com/en-us/library/ff977206.aspx)，该文章解释了如何控制 TFS 放置程序集的位置。对于您的 install.bat 文件，您可以将它们检入 TFS 并使用构建后步骤将它们与您的输出一起复制。如果你真的想要，你可以创建一个自定义的 TFS 活动来生成它们作为构建的一部分 - 阅读 Ewald Hofman 的[这个博客系列](http://www.ewaldhofman.nl/post/2010/04/20/Customize-Team-Build-2010-e28093-Part-1-Introduction.aspx)，了解如何自定义 TFS 构建。

# c - 整数除法在 C 中返回 0

> ID：13278685
> 
> 赞同：-4
> 
> 时间：2012-11-07T21:37:46.360
> 
> 标签：c, arrays, division

由数组元素引起的整数除法返回 0，我应该将 % 存储在同一个数组中......

```
array[6][i]=array[5][i]/total; 
```

这存储了一个 0 ......我认为它与数组是一个整数数组有关......所以我做了一个演员......

```
array[6][i]=(int)(array[5][i]/total); 
```

仍然存储 0 ......我读到我必须将它们转换为浮点，但转换不起作用......我试过这个

```
array[6][i]=(int)((float)array[5][i]/(float)total); 
```

数组声明

```
int arreglo[7][5]={{1,194,48,206,45},{2,180,20,320,16},{3,221,90,140,20},{4,432,50,821,14},{5,820,61,946,18},{0,0,0,0,0},{0,0,0,0,0}}; 
```

最后一个将存储每个百分比

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-07T21:42:58.893

如果你想要一个百分比，那么你正在寻找的是

```
array[6][i] = (int) (100 * ((float)array[5][i] / (float)total)); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-07T21:42:37.100

这将始终返回 0。

如果您使用整数，然后除以总数，结果将小于 1 并截断为 0（因为结果必须是整数）。

您必须使用双精度（或浮点数）数组，或者将整数缩放 100 倍（不是总数）

# django - 按当前登录的用户过滤 ModelForm 中的选择字段

> ID：13278686
> 
> 赞同：0
> 
> 时间：2012-11-07T21:37:50.940
> 
> 标签：django, django-models, django-forms, django-views

我正在尝试显示一个表单（ModelForm），其中包含`select`由当前登录用户过滤的字段。在这种情况下，选择字段包含类别列表。我只想显示“属于”当前登录用户的类别。类别字段是 IngredienceCategory 模型的外键。

到目前为止，这是我想出的，但它给了我一个错误（意外的关键字查询集）。任何想法我做错了什么？

```
# models.py
class IngredienceCategory(models.Model):
    name = models.CharField(max_length=30)
    user = models.ForeignKey(User, null=True, blank=True)

    class Meta:
    verbose_name_plural = "Ingredience Categories"

    def __unicode__(self):
        return self.name

class Ingredience(models.Model):
    name = models.CharField(max_length=30)
    user = models.ForeignKey(User, null=True, blank=True)
    category = models.ForeignKey(IngredienceCategory, null=True, blank=True)

    class Meta:
         verbose_name_plural = "Ingredients"

    def __unicode__(self):
        return self.name

class IngredienceForm(ModelForm):
    class Meta:
        model = Ingredience
        fields = ('name', 'category')

# views.py
def home(request):
    if request.user.is_authenticated():
        username = request.user.username
        email = request.user.email
        foods = Food.objects.filter(user=request.user).order_by('name')
        ingredients = Ingredience.objects.filter(user=request.user).order_by('name')
        ingrcat = IngredienceCategory.objects.filter(user=request.user)

        if request.method == 'POST':
            form = IngredienceForm(request.POST)
            if form.is_valid():
                # Create an instance of Ingredience without saving to the database
                ingredience = form.save(commit=False)
                ingredience.user = request.user
                ingredience.save()
        else:
            # How to display form with 'category' select list filtered by current user?
            form = IngredienceForm(queryset=IngredienceCategory.objects.filter(user=request.user))

        context = {}
        for i in ingredients:
            context[i.category.name.lower()] = context.get(i.category.name.lower(), []) + [i]

        context2 = {'username': username, 'email': email, 'foods': foods, 'ingrcat': ingrcat, 'form': form,}
        context = dict(context.items() + context2.items())
    else:
        context = {}

    return render_to_response('home.html', context, context_instance=RequestContext(request)) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-07T21:51:52.367

发生这种情况是因为 ModelForm 没有使用 queryset 关键字。

您可以通过在视图上设置查询集来实现这一点：

```
form = IngredienceForm()
form.fields["category"].queryset = 
        IngredienceCategory.objects.filter(user=request.user) 
```

[在此处](https://stackoverflow.com/questions/291945/how-do-i-filter-foreignkey-choices-in-a-django-modelform)查看相关问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2018-07-10T14:32:26.903

在这里，我有另一个解决问题的建议。您可以在视图内的表单对象中传递请求对象。

`view.py`只需传递请求对象。

```
form = IngredienceForm(request) 
```

在您的`forms.py` `__init__`函数中还添加`request`对象

```
from models import  IngredienceCategory as IC

class IngredienceForm(ModelForm):
    class Meta:
        model = Ingredience
        fields = ('name', 'category')

    def __init__(self, request, *args, **kwargs):
        super(IngredienceForm, self).__init__(*args, **kwargs)
        self.fields['name'].queryset = IC.objects.filter(user=request.user) 
```

每当您初始化表单时，总会应用此过滤器。

# math - THREE.JS 计算 floor 和 ceil 多边形

> ID：13278688
> 
> 赞同：0
> 
> 时间：2012-11-07T21:37:58.887
> 
> 标签：math, three.js, discrete-mathematics, polynomial-math

我在画布上创建了一些动态创建的墙壁，并且我知道每面墙壁的起点和终点位置。位置由 X 和 Z 坐标组成（y 坐标是恒定的，因为墙的高度是预定义的）。

因此，从技术上讲，我在 2D 平面上有一些部分（带有起点和终点）。

我需要的是多边形，从平面图中完全包裹由墙壁构成的多边形。谁能描述或链接我一个算法来做到这一点？

在此先感谢，

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-11T15:00:14.350

我发现了这个：[https ://gis.stackexchange.com/questions/1200/concave-hull-definition-algorithms-and-practical-solutions](https://gis.stackexchange.com/questions/1200/concave-hull-definition-algorithms-and-practical-solutions)

这是可视化我的问题，我需要一个算法来获得凹壳！

R

# javascript - jQueryUI 无法打开模态对话框

> ID：13278693
> 
> 赞同：1
> 
> 时间：2012-11-07T21:38:12.787
> 
> 标签：javascript, jquery, jquery-ui

我正在编写一个对 python 后端的 ajax 调用，它为模式对话框生成 HTML，然后弹出所述对话框。但是，最近我在这里遇到了问题。我的 JS 前端代码（到目前为止）如下。

```
var deletegroup = function(group){
        $.ajax({
                url: "ajax.py/get_orphaned_networks",
                data: {group: group},
                success: function(result){
                        if (result == 0){
                                alert("Group does not contain networks, no networks will be deleted.");
                        } else {
                                $("#dgf_modal").html(result);
                                $("#dgf_modal").css('visibility', 'visible');
                                $("#dgf_modal").dialog({
                                        modal: true,
                                        closeOnEscape: false,
                                        resizable: false,
                                        draggable: false,
                                        title: "Deleting Group",
                                        width: 500,
                                        height: 500,
                                        buttons: {
                                                "Yes" : function(){
                                                        alert("Well, okay then.");
                                                        $("#dgf_modal").dialog("close");
                                                },
                                                "Cancel" : function(){
                                                        $("#dgf_modal").dialog("close");
                                                }
                                        },
                                        close: function(){
                                                $("#dgf_modal").html("");
                                                $("#dgf_modal").css('visibility', 'hidden');
                                                $(this).dialog("destroy");
                                        }
                                });
                                $("#dgf_modal").dialog("open");
                        }
                },
                error: function(){
                        setlongmessage("An error has occurred. Contact your system administrator.");
                        $("#dgf_status").html("<img src='images/error.png' alt='An error occured.'/>");
                        setTimeout(function(){$("#dgf_status").html("");}, 3000);
                }
        });
} 
```

我在我的应用程序的另一部分有类似的代码，它工作得很好。但是，有了这个我收到以下错误：

> 错误：无法在初始化之前调用对话框上的方法；试图调用方法“打开”
> 
> 抛出新错误（味精）；
> 
> jquery.js（第 477 行）

编辑：如果我在 div 上调用 dialog("open") 或 dialog("close") ，我会收到相同的错误消息。同样的堆栈跟踪，唯一改变的错误是它试图调用方法'close'而不是'open'。

我正在使用最新版本的 jQueryUI 和 jQuery，因为我认为更新它们可能会解决这个问题。没有骰子。也许我在这个函数的某个地方搞砸了，但我确实知道 ajax 调用正在返回它应该返回的正确 HTML。

其他一切都检查出来了——我的 div 的 ID 为 dgf_modal，而且效果很好。不完全确定我现在搞砸了什么。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-07T21:51:48.333

没有理由调用 open，在创建对话框时使用[autoOpen](http://docs.jquery.com/UI/API/1.8/Dialog#option-autoOpen)选项。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-08T16:00:09.687

嗯，我已经想通了。毕竟这是我的 AJAX 调用，返回两个 id 为“dgf_modal”的 div。当我自动生成表格单元格时，不小心把它扔到了我的 for 循环中，而不是在最后我真正关闭表格时。

简而言之，我是个白痴。

# servicestack - servicestack ormlite 部分更新

> ID：13278706
> 
> 赞同：2
> 
> 时间：2012-11-07T21:39:01.707
> 
> 标签：servicestack, ormlite-servicestack

我正在使用 ServiceStack Ormlite 对数据库表进行部分更新。

我有一个模型：

```
public class Model
{
    public int Id;
    public int Property1;
    public int Property2;
    public int Property3;
} 
```

但我只想更新字段 Property1 和 Property2。

有人知道怎么做这个吗？

谢谢。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-11-07T22:09:31.447

有关[更新语句](https://github.com/ServiceStack/ServiceStack.OrmLite#update)，请参阅[ServiceStack 的 OrmLite 文档](https://github.com/ServiceStack/ServiceStack.OrmLite)- 它们包含许多不同的部分更新示例。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-11-14T15:26:12.327

这是带有 where 子句的 ServiceStack OrmLite 多字段更新的样子：

```
Db.UpdateOnly(
new Table_DTO_Object { Field_1 = Val_1, Field_2 = Val_2, Field_3 = Val_3 }, 
obj => new { obj.Field_1, obj.Field_2, obj.Field_3 }, 
obj => obj.Id == objId); 
```

如何更新单个表行上的多个字段/使用 where 子句在 ServiceStack 文档中并没有立即显现，因为他们没有 1) 多个字段和 2) where 子句的示例。

他们有一个更新多个字段的示例，并且他们有一个带有 where 子句的更新示例 - 实际上您需要做的 / 我所做的就是从每个示例中获取所需的功能。

# css - 如何将 .svg 文件转换为字体？

> ID：13278707
> 
> 赞同：58
> 
> 时间：2012-11-07T21:39:07.340
> 
> 标签：css, fonts, svg

如何将 .svg 文件转换为字体？是否有任何 API 或可编程方法？

* * *

## 回答 #1

> 赞同：44
> 
> 时间：2016-01-29T18:56:25.203

我在 Stack Overflow 上找到了两个相关的答案：

1.  [使用矢量软件（即inkscape）和fontforge 创建图标字体？](https://stackoverflow.com/q/12336401/519360)
2.  [将 svg 转换为 ttf 的工具 [关闭] （从这个](https://web.archive.org/web/20170107170808/http://stackoverflow.com/questions/13882328/tools-to-convert-svg-to-ttf)[已删除的 SO 问题](https://stackoverflow.com/q/13882328/519360)存档）

不幸的是，这两者都不是真正的**编码**答案，这正是我真正希望的（用于脚本转换的命令行实用程序，或者可能是某人可以编写此类东西的 API）。

尽管如此，通过结合这两个答案，我得到了我想要的东西。

## 清理 SVG

[^(（此步骤可能是可选的。）)][在免费软件程序InkScape](https://inkscape.org/) 中打开您的 SVG。复制现有的 SVG 并从 FontForge Glyph 模板创建一个新项目。粘贴到该模板中，标准化外观、大小和位置，然后保存为 PLAIN SVG，每个字符一个文件（“字形”）。

## 将 SVG 转换为字体

然后，要么直接使用免费软件程序[FontForge](https://fontforge.github.io/en-US/)（如第一个答案中的指示，[使用矢量软件创建图标字体](https://stackoverflow.com/questions/12336401/creating-icon-fonts-with-vector-software-i-e-inkscape-and-fontforge)），要么使用免费的[IcoMoon](https://icomoon.io/app/)在线服务（如第二个答案中的指示，[将 svg 转换为 ttf 的工具](https://stackoverflow.com/questions/13882328/tools-to-convert-svg-to-ttf)）。我做了后者。

### 使用图标月亮

IcoMoon 是一个相当简单的工具。单击页面顶部的紫色**导入图标**按钮以导入每个自定义 SVG 字形。然后单击集合首选项上的“获取信息”，以便您可以命名集合并为其提供一些元数据。使用“编辑”工具（铅笔图标）并单击每个字形以获得恰到好处的大小和间距。

完成后，选择字体中所需的所有字形，然后按页面底部的“生成字体”按钮。在结果屏幕上，您可以将每个字形映射到一个 Unicode 字符。在右侧，您可以键入或粘贴一个字符，或者在左侧，您可以输入其十六进制代码。[GNOME Character Map](https://en.wikipedia.org/wiki/GNOME_Character_Map)（适用于 Linux）或[Windows Character Map](https://en.wikipedia.org/wiki/Character_Map)或[Mac OS Character Palette](http://www.geekguides.co.uk/6/how-to-display-a-mac-os-character-map/)之类的程序可以帮助您找到适合您的字形的代码。

现在按屏幕顶部的“首选项”按钮（或右下角的齿轮）并确定新字体的名称和元数据，然后按右下角的“下载”。您将获得一个 Fontname.zip 文件，其中包含一堆使用建议以及字体文件本身。

## 迭代

我发现尺寸和间距真的很难正确（我在写字母）。我一直在 IcoMoon 上进行迭代，安装字体，并将我的字母与类似字体的字母进行比较（使用文字处理器）。调整大小很容易，但间距不是那么容易（而且我什至没有搞乱[连字](https://en.wikipedia.org/wiki/Typographic_ligature)或[字距调整](https://en.wikipedia.org/wiki/Kern_%28typography%29)！）。不要忘记某些系统在安装新字体后需要刷新字体缓存（在 Linux 上，`fc-cache`来自[Fontconfig](https://en.wikipedia.org/wiki/Fontconfig)）

## 验证字体

您可能还想验证您的字体。 [Font Squirrel](http://www.fontsquirrel.com/fontface/generator)是一项在线服务，可让您执行此操作，提供更正和使用提示。我认为 IcoMoon 已经这样做了，所以也许这仅对 FontForge 创作有用。

* * *

## 回答 #2

> 赞同：21
> 
> 时间：2017-10-26T16:56:27.187

有多种在线工具可让您上传 SVG 文件并将其用作创建图标字体的图标。就个人而言，我更喜欢**[Icomoon App](https://icomoon.io/app/#/select)**。

Icomoon 应用程序允许您执行以下各项操作：

*   从几种流行的图标字体中获取一个或多个图标
*   上传其他字体，可以是图标字体，也可以是常规字体
*   上传 SVG 文件以用作图标
*   从任意数量的可用字体中组合任意数量的图标
*   为您需要的任何字符设置 UNICODE 十六进制值
*   导出和/或保存您创建的字体集

![爱可梦](../Images/ae10b17b62cb1647689e60805d1912df.png)

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2016-02-22T16:40:24.387

正如其他人所写，可以将 svg 形状导入 fontforge，一些字体设计师就是这样工作的。

然而，形状（轮廓）只是现代智能字体的一部分，因此这本身是不够的。您还需要处理元数据、字距调整、提示等。这是很多绝对不好玩、困难但必要的东西，而潜在的字体设计师通常梦想着自我奖励的艺术绘画，而不是其他。

这就是 svg 字体从未成为一种格式的原因之一，它们缺少太多对渲染文本有用的部分。

# wpf - 分层选项卡控件

> ID：13278708
> 
> 赞同：1
> 
> 时间：2012-11-07T21:39:11.907
> 
> 标签：wpf, tabcontrol, tabitem, hierarchicaldatatemplate

我会意识到一种“分层 TabControl”，其中有 TabItems 作为根及其所有相关子项（始终显示为 TabItem）。

我必须意识到使用 WPF，所以我尝试使用 HierarchicalDataTemplate 编写 TabItem 的 ContentTemplate，但结果是:(

我想获得这样的东西： ![在此处输入图像描述](../Images/92a9bf37f30fc360c61a6880f5d5bdc4.png)

你们中的任何人都可以给我一些建议吗？

# ruby-on-rails - has_many 和belongs_to 属于同一模型

> ID：13278710
> 
> 赞同：2
> 
> 时间：2012-11-07T21:39:12.847
> 
> 标签：ruby-on-rails, ruby, activerecord

我对rails很陌生。我试图找出在两个模型之间建立关系的最有效方法：

1.  用户可以“收藏”许多歌曲
2.  一首歌有一个所有者。

这就是我想做的事情。是否有意义 ？

```
class User < ActiveRecord::Base
    has_many :songs #songs this user has favorited
end

class Song < ActiveRecord::Base
    belongs_to :user #the user whom submitted this song
end 
```

我对这种方法的担忧是，我不确定对数据库中的每首歌曲进行查询以找出特定用户拥有哪些歌曲的效率。我应该以不同的方式思考这个问题吗？

顺便说一句，有没有一种方法可以让我调用与模型名称不同的属性。因此，即使模型仍然是“歌曲”，`User.find(1).songs[0]`我也不能说。`User.find(1).favorites[0]`

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-11-07T21:44:23.093

您需要在 User 和 Song 模型之间建立 2 个独立的关系。也就是说，您需要一个“所有者”关系和一个“最喜欢”关系。'owner' 关系可以是一个简单的 has_many/belongs_to，就像你现在拥有的那样。“最喜欢的”关系是多对多的，需要一个连接表，用作表或具有[此处](http://api.rubyonrails.org/classes/ActiveRecord/Associations/ClassMethods.html#label-Many-to-many)解释`habtm`的关系的第一类模型。`has_many through`

通常推荐的方法是使用`has_many through`它，因为它可以让您更好地控制：

```
class User
  has_many :songs                                            # these are songs 'owned' by the user
  has_many :user_favorite_songs
  has_many :favorite_songs, :through => :user_favorite_songs # these are the favorites
end

class Song
  belongs_to :user
  has_many :user_favorite_songs
end

class UserFavoriteSong
  belongs_to :user
  belongs_to :favorite_song, :class_name => 'Song', :foreign_key => :song_id
end 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-07T21:47:56.077

这看起来非常好。
Rails 关联尽量提高效率——不要过早优化。

您可以为关联的名称起别名，如下所示：

```
class User < ActiveRecord::Base
  has_many :favorites, class_name: 'Song'
end 
```

请参阅[有关关联的文档](http://guides.rubyonrails.org/association_basics.html#has_many-association-reference)。

无论如何，关于性能，您可能想看看`:inverse_of`关联选项。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-07T21:51:40.567

我没有测试过这段代码，但你需要这样的东西。

```
class User < ActiveRecord::Base
  has_and_belongs_to_many :favorites, :class_name => "Song" #user's favorited songs
end

class Song < ActiveRecord::Base
  belongs_to :user #the user who submitted the song
  has_and_belongs_to_many :user, :as => :favorite
end 
```

而且由于多个用户可以收藏一首歌曲，因此您需要一个“加入表”

```
CreateUsersFavorites < ActiveRecord::Migration
  def up
    create_table :users_favorites do |t|
      t.references :user
      t.references :favorite
    end
    create_index :users_favorites, :user_id
    create_index :users_favorites, :favorite_id
  end
  def down
    drop_table :users_favorites
  end
end 
```

另外，我强烈建议您查看[活动记录关系的 rails 指南](http://guides.rubyonrails.org/association_basics.html)。

# rally - BlockedReason 显示为空

> ID：13278721
> 
> 赞同：2
> 
> 时间：2012-11-07T21:39:44.607
> 
> 标签：rally

在这个例子中，我用“Blocked”和“BlockedReason”增强了这个简单的应用程序，我可能会遗漏什么？即使我有这样的数据，网格上也没有显示 BlockedReason。

```
 _queryForStories: function() {
                    Ext.create('Rally.data.WsapiDataStore', {
                        model: 'UserStory',
                        autoLoad: true,
                        fetch: ['Rank', 'FormattedID', 'Name', 'Blocked', 'BlockedReason'],
                        filters: [this.down('#iterationComboBox').getQueryFromSelected()],
                        sorters: [
                            {
                                property: 'Rank',
                                direction: 'ASC'
                            }
                        ],
                        listeners: {
                            load: this._onDataLoaded,
                            scope: this
                        }
                    });
                },

                _onDataLoaded: function(store, data) {
                    var records = [], rankIndex = 1;
                    Ext.Array.each(data, function(record) {
                        records.push({
                            Ranking: rankIndex++,
                            FormattedID: record.get('FormattedID'),
                            Name: record.get('Name'),
                            Blocked: record.get('Blocked'),
                            BlockedReason: record.get('BlockedReason')
                        });
                    }); 
```

...

```
 if(!this.grid) {
                        this.grid = this.down('#grid').add({
                            xtype: 'rallygrid',
                            store: customStore,
                            columnCfgs: [
                                { text: 'Ranking', dataIndex: 'Ranking' },
                                { text: 'ID', dataIndex: 'FormattedID' },
                                { text: 'Blocked', dataIndex: 'Blocked' },
                                { text: 'BlockedReason', dataIndex: 'BlockedReason', flex: 1 },
                                { text: 'Name', dataIndex: 'Name', flex: 1 }
                            ]
                        });
                    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-10T21:25:51.617

这可能是由于最近在我们的数据模型中添加了一个内置的 BlockedReason 字段。任何定义了现有 BlockedReason 字段的人都将其重命名为 BlockedReasonDeprecated。此外，BlockedReason 字段仅在 Web 服务版本 1.38 及更高版本中可用。

因此，您可以使用 BlockedReasonDeprecated 作为您的字段，或者如果您使用 SDK 2.0p4 或更高版本，您可以在 WsapiDataStore 配置中包含 wsapiVersion: 1.38 以使用新的内置字段。

# c++ - STL 背后的设计原理

> ID：13278728
> 
> 赞同：5
> 
> 时间：2012-11-07T21:40:11.330
> 
> 标签：c++, stl

我查看了一些 STL 实现的来源（SGI、STLport、libc++），并看到了一些似乎对所有或大多数实现都通用的设计模式，但我找不到任何理由。我认为一定有一个好的共鸣，并想知道它是什么：

1.  许多类，包括`vector`其他`list_iterator`类，被实现为 2 个类，例如`list_iterator_base`，具有部分功能，然后`list_iterator`继承`list_iterator_base`接口的其余部分。重点是什么？似乎可以在一节课上轻松完成。

2.  迭代器似乎没有使用`iterator`该类。使用它会有一些性能损失吗？

这是我在快速浏览中发现的两个问题。如果有人知道一个很好的资源来解释 STL 实现的实现原理，我会很高兴听到它。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-11-07T22:13:28.087

答案相当直截了当：

1.  STL 是关于泛型编程的。关键思想是不要有重复的代码。近期目标是不重复源代码，但事实证明不重复二进制代码也是有意义的。因此，STL 组件将常用部件分解并使用它们是很常见的。列表类的链接或向量的类型无关属性只是两个示例。对于向量，甚至有多个层：有些部分完全独立于类型（例如大小），有些只需要类型本身（例如，所有访问器、迭代器等），有些部分需要知道如何处理资源分配（例如，插入和销毁需要知道正在使用的分配器）。
2.  事实证明，这`std::iterator<...>`并没有真正起作用：在基类中定义的类型取决于模板参数，在从这样的基类派生的类模板中不能直接访问。也就是说，类型需要使用基类进行限定，并且需要使用 . 标记为类型`typename`。更糟糕的是，理论上用户可以分配派生类的对象并通过指向的指针释放它们`std::iterator<...>`（是的，这样做很愚蠢）。也就是说，没有好处，只有潜在的缺点，即最好避免。

也就是说，我不知道有什么好的资源涵盖了实现通用库的技术。STL 实现中应用的大多数细节都是由多人独立发明的，但有关通用编程的文献仍然相对稀缺。我认为任何描述 STL 的论文实际上都没有讨论实现技术：它们通常专注于设计细节。鉴于似乎只有极少数人了解 STL 是什么，因此作者倾向于专注于描述 STL 是什么而不是如何实现它也就不足为奇了。

# google-plus - 更新 Google Apps 个人资料图片时是否可以更新个人资料图片

> ID：13278733
> 
> 赞同：0
> 
> 时间：2012-11-07T21:40:32.797
> 
> 标签：google-plus, google-apps

Google Apps API 允许公司将自定义集成到邮件环境中。可能的方法之一是使用 Profile API 来使联系信息保持最新。现在我们的用户开始探索 Google+ 和环聊的使用，因此也需要在那里保持信息同步。

Profile API 的主要功能之一是能够更新个人资料图片（详见此处：[https](https://developers.google.com/google-apps/profiles/#AddUpdating_photo) ://developers.google.com/google-apps/profiles/#AddUpdating_photo ）。但是，默认情况下，此 API 不会连接回 Google+ 平台，因此组织的个人资料图像会不同步。

是否可以设置为当更新一张图片时，相应的 Google+ 帐户的图片也会更新？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-08T15:43:41.647

目前，没有用于更新 Google+ 个人资料图片或其他个人资料数据的 API。

# spring - 单点对点队列和多个监听器

> ID：13278737
> 
> 赞同：2
> 
> 时间：2012-11-07T21:40:47.213
> 
> 标签：spring, jms, ibm-mq, message-queue, spring-jms

我有一个“点对点”IBM MQ 队列接收来自多个生产者的消息。我的应用程序使用队列中的消息。我正在使用 spring 'jmstemplate" 和 "DefaultMessageListenerContainer" 来异步使用消息。

我的应用程序在 2 个 jvm 上运行，这意味着每个 jvm 上有 2 个活动的侦听器正在侦听同一个队列。

来回答我的问题，如果有消息...

1) 侦听器如何知道消息到达队列？

2）在两个听众中，哪一个会收到消息？将消息分发给听众的方法是什么？

3) 我可以将单个队列的听众数量扩展到“N”个吗？如果我增长到 10 个听众，缩放是如何工作的？消息是如何分发给听众的？

4) MQ 服务器如何确保同一条消息不会发送到多个监听器？

可能这些都是简单的问题，但无法深入了解上述场景的工作原理。请分享你的想法...

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-07T23:04:39.030

1.  这是 IBM 客户端库的一个功能；侦听器容器只是轮询 JMS API 以等待消息；默认情况下，它使用 1 秒的接收超时；使用 TRACE 级别的日志记录，您将看到显示此活动的日志消息。可以通过在容器上设置 receiveTimeout 来修改超时。
2.  从客户的角度来看，这是不确定的；IBM 经纪人知道有多少消费者注册并选择了一个。一些代理允许配置预取；这有助于提高音量下的性能，但会损害低音量下的性能。
3.  是的; Spring Listener Container 可以根据负载动态扩展监听器；您可以配置最小/最大消费者，Spring 将根据需要在这些范围内进行调整。就代理而言，每个侦听器都是一个单独的消费者，因此工作是根据代理的算法分配的。
4.  这是 IBM 代理的功能（也是 JMS 合同的一部分）。

如果使用事务并且消息回滚到队列中；不能保证同一个侦听器会收到重新传递的消息。

# linux - Perl 脚本检查远程服务器的进程

> ID：13278738
> 
> 赞同：0
> 
> 时间：2012-11-07T21:40:56.133
> 
> 标签：linux, perl, scripting

我设置的脚本有点问题。一点背景：

该脚本的功能是读取由 :: 分隔的文本文件中的服务器列表，登录到服务器，检查 mysql 是否正在运行并返回报告。该文件配置为每行具有： Servername::Ip address::port number

我遇到的问题是我认为 perl 正在尝试将我提供的 IP 地址连接到我在代码中拥有的函数。谁能指出我正确的方向？

```
#!/usr/bin/perl                                                                                           

use strict;
use warnings;

open(FH, '<', 'serverlist_test') or error("Cannot open file , ($!)");
while (my $line = <FH>) {
    our ($name, $ip, $port) = split(/::/, $line);
    my $version = &MySQL_check($ip, $port);                                                                                    
}
close FH;

sub MySQL_check {

    my $issue = `ssh -t root@"$_[0]" -p$"_[1]" 'ps axco command | grep -i mysql'`;
    print $issue;
    if ($issue =~ /mysql/) {                                                                             
      return "Mysql found"; 
    } else {                                                                                             
       return "Mysql not found";                                                                         
    }                                                                                                    
} 
```

我究竟做错了什么？

谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-07T22:13:45.573

```
my $issue = `ssh -t root@"$_[0]" -p$"_[1]" 'ps axco command | grep -i mysql'`; 
```

看着

```
-p$"_[1]" 
```

应该是

```
-p "$_[1]" 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-08T02:55:02.070

您的代码稍作修改

```
...
while (my $line = <FH>) {
    chomp($line); #MOD -- remove newline
    our ($name, $ip, $port) = split("::", $line); #MOD -- change delimiter
...

sub MySQL_check {

    my $issue = `ssh -t root@"$_[0]" -p"$_[1]" 'ps axco command | grep -i mysql'`; #MOD -- fix misplaced double quotes
... 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-07T21:47:44.533

尝试

```
our ($name, $ip, $port) = split('::', $line); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-07T21:49:40.117

放入一些打印调试代码，以便您可以看到正在运行的命令。所以改变：

```
my $issue = `ssh -t root@"$_[0]" -p$"_[1]" 'ps axco command | grep -i mysql'`; 
```

至

```
my $command = qq`ssh -t root@"$_[0]" -p$"_[1]" 'ps axco command | grep -i mysql'`;
warn "Going to run \"$command\""; # comment this out when your code works!
my $issue = `$command`; 
```

这应该标记该命令的问题。这几乎可以肯定是因为您没有`chomp`从文件中读取行，所以端口号实际上`\n`在它后面。

# mysql - Mysql MATCH AGAINST 和 IN

> ID：13278741
> 
> 赞同：1
> 
> 时间：2012-11-07T21:41:11.767
> 
> 标签：mysql, sql, ruby-on-rails

我需要在我的数据库中搜索一些数据。但主要问题是我搜索匹配：

```
...MATCH(description) AGAINST ("*52*" in boolean mode) 
```

但是在一次迭代（或更多，但有一个查询）中，我不仅要搜索 52，而且还要`50,51,52,...,59` 像以前一样搜索......但是这样做真的吗？我也用 RoR 来做：

```
 @accums = Accumulator.find(:all, :conditions => ["MATCH(description) AGAINST (? in boolean mode)", size]) 
```

或者我需要在rails上做迭代器，并逐个迭代地搜索它们？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-08T02:56:33.067

如果你说：

```
 MATCH(description) AGAINST ("*52*" in boolean mode) 
```

针对“描述”所在的行：

```
34,520,1000,9000 
```

或者

```
34,452,1000,9000 
```

或者

```
34,4525,1000,9000 
```

你会得到一场比赛。这是你想要的结果吗？

我猜不是。

我想你想要的是：

```
MATCH(description) AGAINST ("52" in boolean mode) 
```

并处理您想要的多个匹配项：

```
MATCH(description) AGAINST ("51 52 53" in boolean mode) 
```

例子：

```
34,520,1000,9000
// no match

34,452,1000,9000
// no match

34,52,1000,9000
// match

34,53,1000,9000
// match

34,52,53,9000
// match 
```

未经测试。

# asp.net - Orchard CMS 支付系统

> ID：13278743
> 
> 赞同：0
> 
> 时间：2012-11-07T21:41:27.800
> 
> 标签：asp.net, orchardcms, payment

我正在寻找可用于 Orchard 网站的支付系统。该网站适用于酒店，您应该可以支付房间费用。有没有一个模块？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-07T23:27:00.920

我怀疑是否有一个现有的模块可以满足该特定要求，但是有几个很棒的电子商务模块可以很容易地扩展：

*   [Nwazet 商务](http://gallery.orchardproject.net/List/Modules/Orchard.Module.Nwazet.Commerce)
*   [Magelia 网上商店](http://gallery.orchardproject.net/List/Modules/Orchard.Module.WebStore)

[Sipke Schoorstra](http://skywalkersoftwaredevelopment.net/blog/writing-an-orchard-webshop-module-from-scratch-part-1)还提供了一个很棒的教程，它可以让你很好地编写自己的教程。

# java - 将 ActionScript Dictionary 对象作为 FREObject 读取？

> ID：13278744
> 
> 赞同：1
> 
> 时间：2012-11-07T21:41:29.677
> 
> 标签：java, air

对于我正在编写的 ANE，我有一个 flash.utils.Dictionary 对象，我想将其传递给本机 Java 代码。

Java 调用接受 FREObject[] 参数，因此我将字典作为 FREObject。我是否可以阅读字典的 FREOBject 并将其转换为 Java 等价物？

# python - Python 的 seek 函数是如何工作的？

> ID：13278748
> 
> 赞同：6
> 
> 时间：2012-11-07T21:41:30.233
> 
> 标签：python, seek

如果我有一些类似文件的对象并执行以下操作：

```
F = open('abc', 'r')
...
loc = F.tell()
F.seek(loc-10) 
```

寻找是做什么的？是否从文件开头开始并读取`loc-10`字节？还是仅仅备份 10 个字节就足够聪明了？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-11-07T21:43:13.340

它是特定于操作系统和 libc 的。该`file.seek()`操作委托给`fseek(3)`实际操作系统级文件的 C 调用。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-11-07T21:44:54.893

根据[Python 2.7 的文档](http://docs.python.org/2.7/library/stdtypes.html?highlight=seek#file.seek)：

> `file.seek(offset[, whence])`
> 
> 设置文件的当前位置，如 stdio 的 fseek()。whence 参数是可选的，默认为 os.SEEK_SET 或 0（绝对文件定位）；其他值是 os.SEEK_CUR 或 1（相对于当前位置搜索）和 os.SEEK_END 或 2（相对于文件结尾搜索）。

假设您希望相对于您的位置返回 10 个字节：

```
file.seek(-10, 1) 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-11-07T21:42:38.170

它应该足够聪明，只备份 10 个字节，但我想细节真的取决于你正在使用的文件系统/操作系统/运行时库。

请注意，如果您只想备份 10 个字节，则不需要`tell`.

```
F.seek(-10,1) 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2019-12-01T18:39:32.947

```
file.seek() set the current read/write position.
file.tell() Returns the file's current position. 
```

因此，当您这样做时，您会将`**loc = F.tell()**`当前文件位置存储到**loc**变量中。

并`**file.seek()**`接受两个参数`**file.seek(offset, from)**`

所以你需要定义从哪里偏移文件。`**from**`取以下值之一**0,1,2**（0 = 开始，1 = 当前，2 = 结束）

So that's how it's work.

* * *

## 回答 #5

> 赞同：-4
> 
> 时间：2012-11-07T21:45:55.237

根据文档，您需要这样做`f.seek(offset, from_what)`，或者在您的情况下，`F.seek(-10, loc)`

你的例子应该有效，但这更明确

# iphone - 检索 RSS 提要的详细描述

> ID：13278762
> 
> 赞同：1
> 
> 时间：2012-11-07T21:42:42.507
> 
> 标签：iphone, objective-c, ios, ipad, rss

我使用了 RSS 链接“ [http://pnlhosting.com/boldi2/feed](http://pnlhosting.com/boldi2/feed) ”

在此我已正确阅读“标题”，“日期”但是当我尝试检索“详细描述”时 - 我得到了一些信息和一些 html 标签

```
 NSString *articleTitle = [item valueForChild:@"title"];//correct
        NSString *articleUrl = [item valueForChild:@"link"];//correct
        NSString *articleDateString = [item valueForChild:@"pubDate"];//correct

        NSString *articleDescription = [item valueForChild:@"description"];//not correct 
```

我得到的结果是......

articleDescription = Girato tra Miami e le isole Bahamas il film racconta i preparativi di matrimonio, fra due famiglie: i Colombo, italiani di umili origini guidati dal tassista Cristoforo (Massimo Boldi) e dalla moglie Rosy (Sconsolata), ei Di Giacomo, italoamericani ricchissimi …[继续阅读 →](http://pnlhosting.com/boldi2/2012/05/matrimonio-alle-bahamas-regia-di-claudio-risi-2007/)

我怎样才能得到清除的描述？

# gcc - 如何使用 NCC (nccgen/nccnav)？

> ID：13278765
> 
> 赞同：3
> 
> 时间：2012-11-07T21:43:05.010
> 
> 标签：gcc, call-graph, program-flow

我想了解如何使用名为 NCC 的工具： http: [//students.ceid.upatras.gr/~sxanth/ncc/](http://students.ceid.upatras.gr/~sxanth/ncc/)

其目的是详细说明程序调用图和内部符号依赖关系，类似于 cflow/cscope。但我无法让它工作。

我已经克隆了 tcpdump 项目的 git repo 并编辑了 Makefile`CC`以指向`nccgen -ncgcc -ncld -ncfabs`而不是`CC = gcc`

这是输出：

`make[1]: Entering directory `/home/rostamn739/Software/tcpdump'`

`make[1]: Nothing to be done for `all'.`

`make[1]: Leaving directory `/home/rostamn739/Software/tcpdump'`

没有`.nccout`生成文件

# ios - iOS 6 上无法获取 ABAddressBook（无隐私提示返回空数据库）

> ID：13278767
> 
> 赞同：0
> 
> 时间：2012-11-07T21:43:09.113
> 
> 标签：ios, ios6, abaddressbook, core-foundation

我无法在某些设备上访问 iOS 6 上的用户通讯录。奇怪的是，当我在自己的设备上进行测试时它可以工作。

该应用程序从不提示用户访问地址簿，并且我的应用程序未列在其设备上的“设置”->“隐私”->“联系人”中（它在我的设备上）。

这是我的代码，如果我做错了什么，请告诉我？

```
- (void)addressBookWithCompletion:(void (^)(NSArray *addressBook, NSError *error))completion {
    dispatch_queue_t queue = dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_DEFAULT,0);
    dispatch_async(queue, ^{
        CFErrorRef error = NULL;
        ABAddressBookRef addressBook = ABAddressBookCreateWithOptions(NULL, &error);
        ABAddressBookRequestAccessWithCompletion(addressBook, ^(bool granted, CFErrorRef error) {
            if (error || !granted) {
                NSLog(@"%@", error);
                dispatch_async(dispatch_get_main_queue(), ^{
                    completion(nil, (__bridge NSError *)(error));
                });
            } else {
                CFArrayRef allContacts = ABAddressBookCopyArrayOfAllPeople(addressBook);
                // ... do stuff ... 
                CFRelease(addressBook);
                dispatch_async(dispatch_get_main_queue(), ^{
                    completion(arrayOfContacts, nil);
                });
            }
        });
    });
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-08T17:46:42.203

我会避免将所有内容分派到后台队列中。如果里面的东西`// ... do stuff ...`很慢，我会考虑创建 NSObject-Sublasses，其中包含您需要处理的联系人信息，然后将这些信息分派到后台队列中执行更复杂的事情（例如发送到服务器写入磁盘）。 ..

# android - 捏缩放图像但 ImageView 不改变大小

> ID：13278771
> 
> 赞同：1
> 
> 时间：2012-11-07T21:43:17.263
> 
> 标签：android, imageview, pinchzoom

编辑：或者，如果有人有任何其他实现捏缩放的方法，那将非常有帮助。

在我的项目中，我在一个页面上有几个 ImageView，每个都需要能够单独缩放。到目前为止，我一直在使用此代码来控制缩放

```
public class TouchImageView extends ImageView {

Matrix matrix = new Matrix();

// We can be in one of these 3 states
static final int NONE = 0;
static final int DRAG = 1;
static final int ZOOM = 2;
int mode = NONE;

// Remember some things for zooming
PointF last = new PointF();
PointF start = new PointF();
float minScale = 0f;
float maxScale = 2f;
float[] m;

float redundantXSpace, redundantYSpace;

float width, height;
static final int CLICK = 3;
float saveScale = 1f;
float right, bottom, origWidth, origHeight, bmWidth, bmHeight;

ScaleGestureDetector mScaleDetector;

Context context;

TouchImageView thisImageView = this;

public TouchImageView(Context context, AttributeSet attrs) {
    super(context, attrs);
    super.setClickable(true);
    this.context = context;
    mScaleDetector = new ScaleGestureDetector(context, new ScaleListener());
    matrix.setTranslate(1f, 1f);
    m = new float[9];
    setImageMatrix(matrix);
    setScaleType(ScaleType.MATRIX);

    setOnTouchListener(new OnTouchListener() {
        public boolean onTouch(View v, MotionEvent event) {
            mScaleDetector.onTouchEvent(event);

            matrix.getValues(m);
            float x = m[Matrix.MTRANS_X];
            float y = m[Matrix.MTRANS_Y];
            PointF curr = new PointF(event.getX(), event.getY());

            switch (event.getAction()) {
            case MotionEvent.ACTION_DOWN:
                last.set(event.getX(), event.getY());
                start.set(last);
                mode = DRAG;
                break;
            case MotionEvent.ACTION_MOVE:
                if (mode == DRAG) {
                    float deltaX = curr.x - last.x;
                    float deltaY = curr.y - last.y;
                    float scaleWidth = Math.round(origWidth * saveScale);
                    float scaleHeight = Math.round(origHeight * saveScale);
                    if (scaleWidth < width) {
                        deltaX = 0;
                        if (y + deltaY > 0)
                            deltaY = -y;
                        else if (y + deltaY < -bottom)
                            deltaY = -(y + bottom); 
                    } else if (scaleHeight < height) {
                        deltaY = 0;
                        if (x + deltaX > 0)
                            deltaX = -x;
                        else if (x + deltaX < -right)
                            deltaX = -(x + right);
                    } else {
                        if (x + deltaX > 0)
                            deltaX = -x;
                        else if (x + deltaX < -right)
                            deltaX = -(x + right);

                        if (y + deltaY > 0)
                            deltaY = -y;
                        else if (y + deltaY < -bottom)
                            deltaY = -(y + bottom);
                    }
                    matrix.postTranslate(deltaX, deltaY);
                    last.set(curr.x, curr.y);
                }
                break;

            case MotionEvent.ACTION_UP:
                mode = NONE;
                int xDiff = (int) Math.abs(curr.x - start.x);
                int yDiff = (int) Math.abs(curr.y - start.y);
                if (xDiff < CLICK && yDiff < CLICK)
                    performClick();
                break;

            case MotionEvent.ACTION_POINTER_UP:
                mode = NONE;
                break;
            }
            setImageMatrix(matrix);
            invalidate();
            return true; // indicate event was handled
        }

    });
}

public void setImageDrawable(Drawable dr) { 
    super.setImageDrawable(dr);
    bmWidth = dr.getIntrinsicWidth();
    bmHeight = dr.getIntrinsicHeight();
}

public void setMaxZoom(float x)
{
    maxScale = x;
}

private class ScaleListener extends ScaleGestureDetector.SimpleOnScaleGestureListener {
    @Override
    public boolean onScaleBegin(ScaleGestureDetector detector) {
        mode = ZOOM;
        return true;
    }

    @Override
    public boolean onScale(ScaleGestureDetector detector) {
        float mScaleFactor = (float)Math.min(Math.max(.95f, detector.getScaleFactor()), 1.05);
        float origScale = saveScale;
        saveScale *= mScaleFactor;
        if (saveScale > maxScale) {
            saveScale = maxScale;
            mScaleFactor = maxScale / origScale;
        } else if (saveScale < minScale) {
            saveScale = minScale;
            mScaleFactor = minScale / origScale;
        }
        right = width * saveScale - width - (2 * redundantXSpace * saveScale);
        bottom = height * saveScale - height - (2 * redundantYSpace * saveScale);
        if (origWidth * saveScale <= width || origHeight * saveScale <= height) {
            matrix.postScale(mScaleFactor, mScaleFactor, width / 2, height / 2);
            if (mScaleFactor < 1) {
                matrix.getValues(m);
                float x = m[Matrix.MTRANS_X];
                float y = m[Matrix.MTRANS_Y];
                if (mScaleFactor < 1) {
                    if (Math.round(origWidth * saveScale) < width) {
                        if (y < -bottom)
                            matrix.postTranslate(0, -(y + bottom));
                        else if (y > 0)
                            matrix.postTranslate(0, -y);
                    } else {
                        if (x < -right) 
                            matrix.postTranslate(-(x + right), 0);
                        else if (x > 0) 
                            matrix.postTranslate(-x, 0);
                    }
                }
            }

        } else {
            matrix.postScale(mScaleFactor, mScaleFactor, detector.getFocusX(), detector.getFocusY());
            matrix.getValues(m);
            float x = m[Matrix.MTRANS_X];
            float y = m[Matrix.MTRANS_Y];
            if (mScaleFactor < 1) {
                if (x < -right) 
                    matrix.postTranslate(-(x + right), 0);
                else if (x > 0) 
                    matrix.postTranslate(-x, 0);
                if (y < -bottom)
                    matrix.postTranslate(0, -(y + bottom));
                else if (y > 0)
                    matrix.postTranslate(0, -y);
            }

        }
        return true;

    }
}

@Override
protected void onMeasure (int widthMeasureSpec, int heightMeasureSpec)
{
    super.onMeasure(widthMeasureSpec, heightMeasureSpec);

    System.out.println(widthMeasureSpec + "  " + heightMeasureSpec);

    int  w = (int) bmWidth;
    int  h = (int) bmHeight;
    width = resolveSize(w, widthMeasureSpec);  
    height = resolveSize(h, heightMeasureSpec);

    //Fit to screen.
    float scale;
    float scaleX =  (float)width / (float)bmWidth;
    float scaleY = (float)height / (float)bmHeight;
    scale = Math.min(scaleX, scaleY);
    matrix.setScale(scale, scale);
    setImageMatrix(matrix);
    saveScale = 1f;

    // Center the image
    redundantYSpace = (float)height - (scale * (float)bmHeight) ;
    redundantXSpace = (float)width - (scale * (float)bmWidth);
    redundantYSpace /= (float)2;
    redundantXSpace /= (float)2;

    matrix.postTranslate(redundantXSpace, redundantYSpace);

    origWidth = width - 2 * redundantXSpace;
    origHeight = height - 2 * redundantYSpace;
    right = width * saveScale - width - (2 * redundantXSpace * saveScale);
    bottom = height * saveScale - height - (2 * redundantYSpace * saveScale);
    setImageMatrix(matrix);
} 
```

}

哪个有效，但是当我在 ImageView 上捏缩放时，只有里面的图像会增长和缩小。实际的 ImageView 保持相同的大小，这意味着它通常会离开 ImageView 的边缘并变得不可见。

到目前为止，我已经尝试了许多不同的方法来使用捏缩放以及使用：

```
 android:adjustViewBounds="true"
    android:scaleType="centerInside" 
```

尝试强制 ImageView 更改大小。

任何帮助将非常感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-07T21:47:45.557

试试这个

```
public class Touch extends Activity implements OnTouchListener, OnClickListener {
    private static final String TAG = "Touch";
    // These matrices will be used to move and zoom image
    Matrix matrix = new Matrix();
    Matrix savedMatrix = new Matrix();
    String extStorageDirectory;

    // We can be in one of these 3 states
    static final int NONE = 0;
    static final int DRAG = 1;
    static final int ZOOM = 2;
    static final int ROTATE = 3;
    static final int ROTATES = 4;
    int mode = NONE;
    Bitmap bitmap;

    int r = 0;

    // Remember some things for zooming
    PointF start = new PointF();
    PointF mid = new PointF();
    float oldDist = 1f;
    Bitmap bm;
    int fCount = 0;

    File _photoFile;
    Uri _fileUri;

    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.main);
        ImageView view = (ImageView) findViewById(R.id.imageView);
        view.setOnTouchListener(this);

        showImage();

        // ...
        // Work around a Cupcake bug
        matrix.setTranslate(1f, 1f);
        view.setImageMatrix(matrix);

    float[] lastEvent = null;
    float d = 0f;
    float newRot = 0f;

    @Override
    public boolean onTouch(View v, MotionEvent rawEvent) {
        WrapMotionEvent event = WrapMotionEvent.wrap(rawEvent);
        // ...
        // Dump touch event to log
        dumpEvent(event);
        ImageView view = (ImageView) v;

        // Dump touch event to log
        dumpEvent(event);
        // Handle touch events here...
        switch (event.getAction() & MotionEvent.ACTION_MASK) {
        case MotionEvent.ACTION_DOWN:
            savedMatrix.set(matrix);
            start.set(event.getX(), event.getY());
            Log.d(TAG, "mode=DRAG");
            mode = DRAG;
            break;
        case MotionEvent.ACTION_POINTER_DOWN:
            oldDist = spacing(event);
            Log.d(TAG, "oldDist=" + oldDist);
            if (oldDist > 10f) {
                savedMatrix.set(matrix);
                midPoint(mid, event);
                mode = ZOOM;
                Log.d(TAG, "mode=ZOOM");
                lastEvent = new float[4];
                lastEvent[0] = event.getX(0);
                lastEvent[1] = event.getX(1);
                lastEvent[2] = event.getY(0);
                lastEvent[3] = event.getY(1);
                d = rotation(event);
            }

            break;

        case MotionEvent.ACTION_UP:

            mode = NONE;
            Log.d(TAG, "mode=NONE");
            savedMatrix.set(matrix);
            // matrix.postRotate(90);

            break;

        case MotionEvent.ACTION_POINTER_UP:
            mode = NONE;
            Log.d(TAG, "mode=NONE");
            break;

        case MotionEvent.ACTION_MOVE:
            if (mode == DRAG) {
                // ...
                matrix.set(savedMatrix);
                matrix.postTranslate(event.getX() - start.x, event.getY()
                        - start.y);
            } else if (mode == ZOOM && event.getPointerCount() == 2) {
                float newDist = spacing(event);
                Log.d(TAG, "Count=" + event.getPointerCount());
                Log.d(TAG, "newDist=" + newDist);
                matrix.set(savedMatrix);
                if (newDist > 10f) {
                    matrix.set(savedMatrix);
                    float scale = newDist / oldDist;
                    matrix.postScale(scale, scale, mid.x, mid.y);

                }
                if (lastEvent != null) {
                    newRot = rotation(event);
                    Log.d("Dgereeee", "newRot=" + (newRot));
                    float r = newRot - d;
                    matrix.postRotate(r, view.getMeasuredWidth() / 2,
                            view.getMeasuredHeight() / 2);
                }
            }
            break;

        }

        view.setImageMatrix(matrix);
        return true; // indicate event was handled
    }

    /** Show an event in the LogCat view, for debugging */
    private void dumpEvent(WrapMotionEvent event) {
        // ...
        String names[] = { "DOWN", "UP", "MOVE", "CANCEL", "OUTSIDE",
                "POINTER_DOWN", "POINTER_UP", "7?", "8?", "9?" };
        StringBuilder sb = new StringBuilder();
        int action = event.getAction();
        int actionCode = action & MotionEvent.ACTION_MASK;
        sb.append("event ACTION_").append(names[actionCode]);
        if (actionCode == MotionEvent.ACTION_POINTER_DOWN
                || actionCode == MotionEvent.ACTION_POINTER_UP) {
            sb.append("(pid ").append(
                    action >> MotionEvent.ACTION_POINTER_ID_SHIFT);
            sb.append(")");
        }
        sb.append("[");
        for (int i = 0; i < event.getPointerCount(); i++) {
            sb.append("#").append(i);
            sb.append("(pid ").append(event.getPointerId(i));
            sb.append(")=").append((int) event.getX(i));
            sb.append(",").append((int) event.getY(i));
            if (i + 1 < event.getPointerCount())
                sb.append(";");
        }
        sb.append("]");
        Log.d(TAG, sb.toString());
    }

    /** Determine the space between the first two fingers */
    private float spacing(WrapMotionEvent event) {
        // ...
        float x = event.getX(0) - event.getX(1);
        float y = event.getY(0) - event.getY(1);
        return FloatMath.sqrt(x * x + y * y);
    }

    /** Determine the degree between the first two fingers */
    private float rotation(WrapMotionEvent event) {
        double delta_x = (event.getX(0) - event.getX(1));
        double delta_y = (event.getY(0) - event.getY(1));
        double radians = Math.atan2(delta_y, delta_x);
        Log.d("Rotation ~~~~~~~~~~~~~~~~~", delta_x + " ## " + delta_y + " ## "
                + radians + " ## " + Math.toDegrees(radians));
        return (float) Math.toDegrees(radians);
    }

    /** Calculate the mid point of the first two fingers */
    private void midPoint(PointF point, WrapMotionEvent event) {
        // ...
        float x = event.getX(0) + event.getX(1);
        float y = event.getY(0) + event.getY(1);
        point.set(x / 2, y / 2);
    }

} 
```

并在您的 xml 中使用比例类型作为矩阵

```
android:scaleType="matrix" 
```

# oracle - Oracle中的空字符串与空字符串

> ID：13278773
> 
> 赞同：91
> 
> 时间：2012-11-07T21:43:21.357
> 
> 标签：oracle, null, oracle10g, string

> **可能重复：**
> [为什么 Oracle 9i 将空字符串视为 NULL？](https://stackoverflow.com/questions/203493/why-does-oracle-9i-treat-an-empty-string-as-null)

我在 Oracle 10g 中有一个表，名称`TEMP_TABLE`只有两列 -`id`只是`description`为了演示。

该列`id`是序列生成的主键类型`NUMBER(35, 0) not null`，并且该列`DESCRIPTION`是`VARCHAR2(4000) not null`.

在这种情况下，基本表结构如下所示。

```
+--------------+-----------+---------------+
|Name          | Null?     | Type          |
+--------------+-----------+---------------+
|ID            | NOT NULL  | NUMBER(35)    |
|DESCRIPTION   | NOT NULL  | VARCHAR2(4000)|
+--------------+-----------+---------------+ 
```

创建此表后，我尝试`INSERT`交替插入以下命令。

```
INSERT INTO temp_table (id, description) VALUES (1, null); ->unsuccessful
INSERT INTO temp_table (id, description) VALUES (2, '');   ->unsuccessful 
```

显然，它们都没有成功，因为`not null`约束是在`DESCRIPTION`列上强制执行的。

在这两种情况下，甲骨文都抱怨

```
ORA-01400: cannot insert NULL into ("WAGAFASHIONDB"."TEMP_TABLE"."DESCRIPTION") 
```

**`NULL`在 Oracle 中，空字符串被视为一个值。**

* * *

如果我删除了列`not null`上的约束，`DESCRIPTION`那么基本表结构将如下所示

```
+--------------+-----------+---------------+
|Name          | Null?     | Type          |
+--------------+-----------+---------------+
|ID            | NOT NULL  | NUMBER(35)    |
|DESCRIPTION   |           | VARCHAR2(4000)|
+--------------+-----------+---------------+ 
```

并且`INSERT`指定的两个命令都会成功。他们将在. `null`_`''``DESCRIPTION``TEMP_TABLE`

现在，如果我发出以下`SELECT`命令，

```
SELECT * FROM temp_table WHERE description IS NULL; 
```

然后它获取两个行，其中一个有一个值，另一个在列中`null`有一个空字符串。`''``DESCRIPTION`

但是，以下`SELECT`语句从`TEMP_TABLE`

```
SELECT * FROM temp_table WHERE description=''; 
```

它甚至不检索列中包含空字符串的`DESCRIPTION`行。

* * *

据推测，Oracle 似乎在这里对`null`值和空字符串进行了不同的处理，但是对于阻止将值和空字符串都插入到具有约束的列中的语句，`''`情况似乎并非如此。为什么会这样？`INSERT``null``''``not null`

* * *

## 回答 #1

> 赞同：118
> 
> 时间：2012-11-07T21:50:57.337

这是因为 Oracle 在内部将空字符串更改为 NULL 值。Oracle 根本不会让插入一个空字符串。

另一方面，SQL Server 会让你做你想要达到的目标。

这里有2个解决方法：

1.  使用另一列说明“描述”字段是否有效
2.  在您希望它存储空字符串的“描述”字段中使用一些虚拟值。（即假设您的真实数据永远不会遇到这样的描述值，将字段设置为“stackoverflowrocks”）

当然，两者都是愚蠢的解决方法:)

* * *

## 回答 #2

> 赞同：34
> 
> 时间：2012-11-07T21:52:46.590

在 oracle 中，空的 varchar2 和 null 被视为相同，您的观察表明了这一点。

当你写：

```
select * from table where a = ''; 
```

和写作一样

```
select * from table where a = null; 
```

并不是`a is null`

这永远不会等于真，所以永远不要返回一行。插入时相同，NOT NULL 表示您不能插入 null 或空字符串（被视为 null）

# mongodb - 如何使用 Objectory 将二进制文件保存到 Mongodb

> ID：13278777
> 
> 赞同：-2
> 
> 时间：2012-11-07T21:43:33.993
> 
> 标签：mongodb, dart

如何使用文件上传字段中的 Objectory/Dart 将二进制文件保存到 Mongodb？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-08T06:55:07.303

实际上，您的问题在许多层面上都有很多含义。基本上在 MongoDB 一级可以将二进制数据保存在普通文档的二进制类型的字段中。我相信它现在正在 mongo_dart 中工作。在 objectory_console （通过 mongo_dart 直接与 mongodb 通信的 objectory 的服务器端版本）我认为它也可以工作。你的模型对象会像

```
class UploadedFile extends PersistentObject  {
  String get fileName => getProperty('fileName');
  set fileName(String value) => setProperty('fileName',value);

  BsonBinary get content => getProperty('content');
  set content(BsonBinary value) => setProperty('content',value);
  ....
  ....  
} 
```

BsonBinary 已命名构造函数`BsonBinary.from(List from)`，它有效但仅适用于 dart:io （在服务器端）对于基于浏览器的对象，目前您可以使用命名构造函数`BsonBinary.fromHexString()`。恐怕这会产生大量开销。

另一个考虑因素是 MongoDB 中总文档大小的限制，即 16mb。所以你的文件必须小于那个大小。

较大的文件通过 GridFS 层存储在 MongoDB 中，最近在 mongo_dart 中添加了 GridFS 支持。

[来自https://github.com/vadimtsushko/mongo_dart/blob/master/test/gridfs_tests.dart](https://github.com/vadimtsushko/mongo_dart/blob/master/test/gridfs_tests.dart)的用法示例：

```
Future testFileToGridFSToFile() {
  GridFS.DEFAULT_CHUNKSIZE = 30;  
  GridIn input;
  String dir = path.dirname(path.fromUri(Platform.script));
  var inputStream = new File('$dir/gridfs_testdata_in.txt').openRead();
  Db db = new Db('${DefaultUri}mongo_dart-test');
  return db.open().then((c){
    var gridFS = new GridFS(db);
    clearFSCollections(gridFS);
    input = gridFS.createFile(inputStream, "test");  
    return input.save();
  }).then((c) { 
    var gridFS = new GridFS(db);
    return gridFS.getFile('test');
  }).then((GridOut gridOut) {   
    return gridOut.writeToFilename('$dir/gridfs_testdata_out.txt');
  }).then((c){
    List<int> dataIn = new File('$dir/gridfs_testdata_in.txt').readAsBytesSync();
    List<int> dataOut = new File('$dir/gridfs_testdata_out.txt').readAsBytesSync();
    expect(dataOut, orderedEquals(dataIn));
    db.close();
  });
} 
```

# c# - 如何使用 XElement.Parse 然后找到特定元素的值？

> ID：13278778
> 
> 赞同：1
> 
> 时间：2012-11-07T21:43:41.187
> 
> 标签：c#, .net, xml, linq, linq-to-xml

我有一些从 REST 调用返回的 XML，如下所示：

```
<ArrayOfProperty xmlns=\"http://schemas.microsoft.com/HPCS2008R2/common\" xmlns:i=\"http://www.w3.org/2001/XMLSchema-instance\">
  <Property>
    <Name>Id</Name>
    <Value>17</Value>
  </Property>
  <Property>
    <Name>StartTime</Name>
    <Value>11/7/2012 9:13:50 PM</Value>
  </Property>
  <Property>
    <Name>State</Name>
    <Value>Failed</Value>
  </Property> 
```

我正在使用 RestSharp API 来协助执行 API 调用并尝试使用 linq-to-xml XElement.Parse 来解析结果。我不确定如何获取状态的值，以便在本文档中我想做类似的事情：

`XElement.Parse(XMLstring).Elements???`从包含元素状态的元素集中获取文本“失败”，但我想要元素中的文本“失败” `<Value>Failed</Value>`。该值元素可以有多个值，但我总是想要与状态关联的值。

有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-07T21:50:50.143

您的 XML 包含默认命名空间，因此您需要定义它并在查询中使用。

```
XNamespace ns = "http://schemas.microsoft.com/HPCS2008R2/common";

var value = (string)XDocument.Parse(input)
    .Descendants(ns + "Property")
    .Where(p => (string)p.Element(ns + "Name") == "State")
    .Elements(ns + "Value").FirstOrDefault(); 
```

# webgl - intersectObjects 不是函数

> ID：13278779
> 
> 赞同：1
> 
> 时间：2012-11-07T21:43:44.960
> 
> 标签：webgl, three.js

我一直在使用 Google WebGL Globe 并尝试进行一些基本的交互，其中之一包括单击由纬度、经度等生成的条。

从我看到的大量three.js 示例中，答案在于投影仪和射线来寻找交叉点。我遇到的问题是下面的代码，它已经从其他几个来源进行了微调：

```
var projector = new THREE.Projector();

if (event.target == renderer.domElement) {
    var x = event.clientX;
    var y = event.clientY;
    var v = new THREE.Vector3((x/w)*2-1, -(y/h)*2+1, 0.5);
    projector.unprojectVector(v, camera);
    var ray = new THREE.Ray(camera.position, v.subSelf(camera.position).normalize());
    var intersects = ray.intersectObjects(scene.children);
    if (intersects.length > 0) {
      console.log("success");
    }
} 
```

具体来说，“ray.intersectObjects 不是函数”是错误。

有任何想法吗？提前致谢。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2013-06-23T19:29:51.667

没有回答...解决方案是使用`new THREE.Raycaster`-- 不是`THREE.Ray`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-08T18:19:31.597

看来您使用的是旧版本的库。更新到 r.52。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-08T08:44:27.193

请尝试在数组中添加场景对象并尝试以下代码。

```
function onDocumentMouseDown( event ) {
            event.preventDefault();             
            var vector = new THREE.Vector3( 
                    ( event.clientX / window.innerWidth ) * 2 - 1, 
                    - ( event.clientY / window.innerHeight ) * 2 + 1, 
                    0.5 );

                projector.unprojectVector( vector, camera );
                var ray = new THREE.Ray( camera.position, vector.subSelf( camera.position ).normalize() );

                var intersects = ray.intersectObjects( objects );                                   

                if ( intersects.length > 0 ) {              
                    console.log("success");                 
                }                          

                document.addEventListener( 'mousemove', onDocumentMouseMove, false );
                document.addEventListener( 'mouseup', onDocumentMouseUp, false );
                document.addEventListener( 'mouseout', onDocumentMouseOut, false );

            mouseXOnMouseDown = event.clientX - windowHalfX;
            targetRotationOnMouseDown = targetRotation;
        } 
```

# jquery - 如何禁用单个视图的客户端验证？

> ID：13278781
> 
> 赞同：5
> 
> 时间：2012-11-07T21:43:57.987
> 
> 标签：jquery, asp.net-mvc, asp.net-mvc-3, validation

我需要在单个视图上禁用表单的客户端验证。

我该怎么做呢？

我不想只禁用以下 JS 文件：

```
<script src="@Url.Content("~/Scripts/jquery/jquery.validate.min.js")" type="text/javascript"></script>
<script src="@Url.Content("~/Scripts/jquery/jquery.validate.unobtrusive.min.js")" type="text/javascript"></script> 
```

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-11-07T21:59:48.773

布拉德威尔逊在他的博客文章中描述了这一点：http: [//bradwilson.typepad.com/blog/2010/10/mvc3-unobtrusive-validation.html](http://bradwilson.typepad.com/blog/2010/10/mvc3-unobtrusive-validation.html) - 我在下面突出显示了回答您问题的位（最后一行）引用博客文章：

> 要为整个应用程序默认打开/关闭不显眼的 JavaScript 模式并启用/禁用客户端验证，您可以使用 Web.config：
> 
> ```
> <configuration>
>     <appSettings>
>         <add key="ClientValidationEnabled" value="true"/>
>         <add key="UnobtrusiveJavaScriptEnabled" value="true"/>
>     </appSettings>
> </configuration> 
> ```
> 
> 您还可以使用代码打开或关闭它们：
> 
> ```
> HtmlHelper.ClientValidationEnabled = true;
> HtmlHelper.UnobtrusiveJavaScriptEnabled = true; 
> ```
> 
> 使用代码打开或关闭这些功能实际上是根据上下文进行的。如果这些代码行存在于您的 Global.asax 文件中，那么它将为整个应用程序打开或关闭不显眼的 JavaScript 和客户端验证。***另一方面，如果它们出现在您的控制器或视图中，它将仅为当前操作打开或关闭这些功能。***

# javascript - 多少个 javascript 事件处理程序太多了？

> ID：13278782
> 
> 赞同：2
> 
> 时间：2012-11-07T21:43:57.977
> 
> 标签：javascript, jquery, javascript-events, event-handling

我正在编写一个 PHP/jQuery 应用程序，我想知道有多少事件处理程序太多了？

例如，在我的主 .js 文件中，我大约有十五个

```
$('body').on('click','.someElementClass',function(){
    someFunction();
}); 
```

有没有更好的方法来完成这个/什么是最好的做法？

编辑：上面的“body”只是一个例子，我正在绑定到最深的元素

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-07T21:45:27.873

如果您的应用程序符合性能要求 - 那么它不会太多。如果没有——那就太多了。就这么简单。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-07T21:46:11.897

> *“有没有更好的方法来完成这个/最好的做法是什么？”*

是的，有更好的方法。现在，您将所有点击活动绑定到单个容器。

这意味着`.someElementClass`需要为页面上的每次点击调用 every ，实际上是多次调用，因为事件冒泡。

正确的方法是将处理程序绑定到包含每个给定选择器的嵌套最深的容器。这样，每个处理程序仅在页面该部分内的点击时被调用。

> *“我想知道有多少事件处理程序太多了？”*

当然，这将取决于应用程序的要求，但使用上述方法将减少多个处理程序的存在问题。

# android - 如何从资产文件夹中解析xml

> ID：13278785
> 
> 赞同：2
> 
> 时间：2012-11-07T21:44:11.543
> 
> 标签：android

如何解析位于资产文件夹中的本地 XML 文件？在此示例中，我从 URL 获取 XML，如何获取 XML？

```
public class AndroidXMLParsingActivity extends ListActivity {

    // All static variables
    static final String URL = "http://api.androidhive.info/pizza/?format=xml";
    // XML node keys
    static final String KEY_ITEM = "item"; // parent node
    static final String KEY_ID = "id";
    static final String KEY_NAME = "name";
    static final String KEY_COST = "cost";
    static final String KEY_DESC = "description";

    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.main);

        ArrayList<HashMap<String, String>> menuItems = new ArrayList<HashMap<String, String>>();

        XMLParser parser = new XMLParser();
        String xml = parser.getXmlFromUrl(URL); // getting XML
        Document doc = parser.getDomElement(xml); // getting DOM element

        NodeList nl = doc.getElementsByTagName(KEY_ITEM);
        // looping through all item nodes <item>
        for (int i = 0; i < nl.getLength(); i++) {
            // creating new HashMap
            HashMap<String, String> map = new HashMap<String, String>();
            Element e = (Element) nl.item(i);
            // adding each child node to HashMap key => value
            map.put(KEY_ID, parser.getValue(e, KEY_ID));
            map.put(KEY_NAME, parser.getValue(e, KEY_NAME));
            map.put(KEY_COST, "Rs." + parser.getValue(e, KEY_COST));
            map.put(KEY_DESC, parser.getValue(e, KEY_DESC)); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-07T21:59:34.053

从 assets 文件夹中访问文件真的很容易，例如，如果您想从 assets 目录中读取“test.xml”，您可以使用以下代码。

```
File file = new File(Environment.getExternalStorageDirectory() + "/new.xml");
        FileInputStream fis = new FileInputStream(file);
        parser.setInput(new InputStreamReader(fis));

        InputStream tinstr = null;
        try {
            XmlPullParserFactory factory = XmlPullParserFactory.newInstance();
            factory.setNamespaceAware(true);
            XmlPullParser parser = factory.newPullParser();
            AssetManager assetManager = getAssets();
            tinstr = assetManager.open("test.xml");
            parser.setInput(new InputStreamReader(tinstr));
        } catch (FileNotFoundException e1) {
            // TODO Auto-generated catch block
            e1.printStackTrace();
        } 
```

# c# - 正则表达式行尾锚并不总是有效

> ID：13278793
> 
> 赞同：3
> 
> 时间：2012-11-07T21:44:55.030
> 
> 标签：c#, .net, regex

我正在开发一个使用正则表达式的 ASP .NET (C#) 项目，但我遇到了行尾锚点的问题！我正在寻找一些文本，我想确保它只出现在字符串的末尾。

这是一些演示我的问题的示例输入。对于这种情况，我试图匹配最后的“文本”一词。

> 此文本是我的示例文本

以下是我尝试过的表达式（使用 IgnoreCase 选项）：

```
text\z
text\Z
text$ 
```

现在这是疯狂的部分。这些正则表达式都不适用于我的系统（Windows 8 Pro 64 位、VS2010、.NET 4.0）。我已经在我的项目中进行了调试，并且还尝试了 Windows 8 商店中的“Regex Tester”应用程序。它不会匹配！

但是，如果我使用在线正则表达式测试器，例如 Derek Slager 在[他的博客文章](http://derekslager.com/blog/posts/2007/09/a-better-dotnet-regular-expression-tester.ashx)中运行在 .NET 上，或者这个 Silverlight 在[http://regexhero.net/tester/](http://regexhero.net/tester/)上使用完全相同的模式和输入，它匹配“文本”的最终实例没有问题。

我很困惑。我真的需要可靠的字符串结尾匹配，我不知道我做错了什么。

编辑：显然我不能使用编译的正则表达式。这是一个使用项目实际运行的数据的示例：

```
class Program
{
    static void Main(string[] args)
    {
        string url = "http://192.168.0.113/MidlandGIS/rest/services/Osceola_Assessor_Data/MapServer/?f=pjson";
        string pattern = @"mapserver/\?f=(json|pjson)$";

        Regex myRegex = new Regex(pattern, RegexOptions.IgnoreCase & RegexOptions.Compiled);
        Console.Write("Trying compiled regex: ");
        if (myRegex.IsMatch(url))
            Console.WriteLine("Match");
        else
            Console.WriteLine("No match.");

        myRegex = new Regex(pattern, RegexOptions.IgnoreCase);
        Console.Write("Trying non-compiled regex: ");
        if (myRegex.IsMatch(url))
            Console.WriteLine("Match");
        else
            Console.WriteLine("No match.");

        Console.Write("Trying inline regex: ");
        if (Regex.IsMatch(url, pattern, RegexOptions.IgnoreCase))
            Console.WriteLine("Match");
        else
            Console.WriteLine("No match");

        Console.Write("Press any key to terminate.");
        Console.ReadKey();
    }
} 
```

输出

> 尝试编译的正则表达式：不匹配
> 
> 尝试未编译的正则表达式：匹配
> 
> 尝试内联正则表达式：匹配
> 
> 按任意键终止。

再次编辑：好的，我是个十足的白痴。当我应该使用按位或来组合正则表达式选项时，我使用了按位与。现在编译正则表达式的工作就好了。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-11-25T13:08:02.833

尝试使用这个：

```
 (\n|\r|\r\n) 
```

有关更多信息，请参阅：[匹配 C# 中的换行符 (\n) 的正则表达式](https://stackoverflow.com/questions/1175053/regex-that-matches-a-newline-n-in-c-sharp)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-07T21:54:12.780

这是直接来自最好的正则表达式来源之一的报价。

> Regex 允许使用 RegexOptions 类型的可选第二个参数。您可以将 RegexOptions.IgnoreCase 指定为最后一个参数，以使正则表达式不区分大小写。其他选项是 RegexOptions.Singleline ，它导致点匹配换行符和 **RegexOptions.Multiline ，它导致插入符号和美元匹配主题字符串中嵌入的换行符**。

您可能只需要设置该选项即可获得所需的内容。您可以查看[页面的其余部分以](http://www.regular-expressions.info/dotnet.html)获取有关 .net 和正则表达式的更多信息。

# php - 如何在不使用 jquery 的情况下进行 POST AJAX 调用？

> ID：13278804
> 
> 赞同：0
> 
> 时间：2012-11-07T21:46:00.150
> 
> 标签：php, jquery, ajax, post, get

> **可能重复：**
> [如何在没有 jquery 的情况下进行 ajax 调用？](https://stackoverflow.com/questions/8567114/how-to-make-an-ajax-call-without-jquery)

我有一个函数，我需要使用 ajax 调用更新我的数据库。出于速度原因，如果我不必在此页面上包含 jquery 源文件并因此使用 $.ajax 函数来执行我对 php 文件的发布请求，我会更喜欢它，尽管这会使通过执行 ajax 调用发布更容易。

我在这里看到了如何使用 GET 方法执行此操作，但没有找到使用 POST 方法进行非 jquery ajax 调用的任何帮助。由于此调用将对我的数据库进行更改，因此我不想使用 GET 方法。

更新：

走 jquery 路线：实际执行的任务是加载页面其余部分的优先级较低。有什么方法可以保证 ajax 调用（包括加载 jquery）是页面加载时最后一个 javascript 的事情？

# mysql - Rails 使用不同字段在 db 中搜索

> ID：13278806
> 
> 赞同：1
> 
> 时间：2012-11-07T21:46:06.283
> 
> 标签：mysql, ruby-on-rails, ruby, activerecord

我的 html 代码中有 5 个选择。我将它们发送到控制器，但例如它们中的一些可能是空的（默认值为 0），所以例如在某些情况下，我只需要通过`params[:size]` 某些情况下仅通过`params[:capacity]`和其他`params[:size] and params[:capacity]`两种情况进行搜索...但是如何这样做？如何使用 find 等操作？现在我有这样的事情：

```
size = "*"+params[:akbsize]+"*"
    @accums = Accumulator.find(:all, :conditions => ["MATCH(description) AGAINST (? in boolean mode)", size])
    cap = "*"+params[:akbcapacity]+"*"
    @accums2 = Accumulator.find(:all, :conditions => ["MATCH(description) AGAINST (? in boolean mode)", cap]) 
```

但是如何按照我的描述做呢？在这里使用元搜索 gem 好用吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-09T00:59:47.633

你可以像这样为它制作方法：

```
class Accumulator
  def self.by_size(size)
    if size
      where("description LIKE ?", "%#{size}%")
    else
      scoped
    end
  end

  def self.by_capacity(capacity)
    if capacity
      where("description LIKE ?", "%#{capacity}%")
    else
      scoped
    end
  end
end 
```

然后在您的控制器上：

```
@accums = Accumulator.by_size(params[:size]).by_capacity(params[:capacity]) 
```

这将完成你想要的。我认为这种方法根本就没有必要。

=)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-08T21:52:07.273

```
sterms = [params[:a],params[:b],params[:c]].select {|t| t}.join('%')
results = Accumulator.where("description like ?", "%#{sterms}%") 
```

或者你可以像这样使用布尔搜索

```
sterms = [params[:a],params[:b],params[:c]].select {|t| t}.map {|t| '+' + t}.join(' ')
results = Accumulator.where("MATCH(description) AGAINST( ? in boolean mode) ", sterms) 
```

或者，如果您正在搜索描述，其中任何参数传递的搜索词都会生成匹配项，您可以这样做：

```
sterms = [params[:a],params[:b],params[:c]].select {|t| t}.join(' ')
results = Accumulator.where("MATCH(description) AGAINST( ? in boolean mode) ", sterms) 
```

这些假设参数根本不存在，即零。如果有一个特定的值要用来表示空，更改.select，即

```
sterms = [params[:a],params[:b],params[:c]].select {|t| t != "0"}.join('%') 
```

如您所见，我可以继续使用搜索逻辑的各种排列和组合，这就是为什么我建议寻找某种元搜索 gem。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-08T22:28:53.323

您可以查看[Ransack gem](https://github.com/ernie/ransack)，它或多或少地解决了创建复杂搜索表单的问题。

# youtube-api - youtube 视频结束后转到新页面？

> ID：13278808
> 
> 赞同：0
> 
> 时间：2012-11-07T21:46:11.807
> 
> 标签：youtube-api

我在我的网站上使用 youtube 的 AS3 flash 播放器。我可以让它在视频完成后自动转发到特定页面吗？我该怎么做？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-08T07:14:16.377

即使在使用 AS3 播放器时，您仍然可以注册 javascript 处理程序；当您加载播放器时，请确保您追加

```
enablejsapi=1 
```

作为 URL 的参数。一旦您为 AS3 播放器注册了 javascript 处理程序，您就可以添加一个 javascript 监听器到播放器状态更改（特别是 ENDED 状态）：

```
function onytplayerStateChange(newState) {
   if (newState===YT.PlayerState.ENDED) {
      // do redirect here
   }
} 
```

**编辑**：

准备好 javascript 侦听器后，您可以设置一个 actionscript 侦听器，该侦听器将在任何状态更改时调用此 javascript 函数。像这样的东西，也许（未经测试）：

```
// 'loader' below is the youtube actionscript loader object

function onLoaderInit(event:Event):void {
    addChild(loader);
    loader.content.addEventListener("onStateChange", onPlayerStateChange);
}

function onPlayerStateChange(event:Event):void {
    // Event.data contains the event parameter, which is the new player state
// make sure ExternalInterface is imported
    ExternalInterface.call("onytplayerStateChange()", Object(event).data); // calls the javascript function

} 
```

# mongodb - MongoDB跨数据库查询

> ID：13278814
> 
> 赞同：22
> 
> 时间：2012-11-07T21:46:45.020
> 
> 标签：mongodb, cross-database

我知道我在某处看到过这个解决方案，但我现在似乎找不到它。我正在尝试在连接到另一个时查询一个 MongoDB 数据库。这应该是可能的，而无需在运行查询之前显式连接到其他数据库。有谁知道这样做的正确语法？

* * *

## 回答 #1

> 赞同：43
> 
> 时间：2012-11-08T02:05:04.317

要对同一 MongoDB 服务器上的另一个数据库运行命令，可以在`mongo`shell 中使用：

```
db.getSiblingDB('dbname').collection.command() 
```

例如：

```
db.getSiblingDB('test').foo.find() 
```

# eclipse - Eclipse 强制处理程序使用 activeWhen 重新评估

> ID：13278818
> 
> 赞同：1
> 
> 时间：2012-11-07T21:47:01.920
> 
> 标签：eclipse, eclipse-plugin

我已经查看了这个问题[Eclipse force handlers to re-evaluate](https://stackoverflow.com/questions/12092661/eclipse-force-handlers-to-to-re-evaluate)和 Paul Webster 提供的答案。为什么在处理程序中使用**activeWhen**元素不起作用？仅当我将以下 plugin.xml 更改为使用**enabledWhen**元素时，它才会起作用。运行命令后，我的特定命令不应再启用。

```
<handler
    commandId="org.eclipse.jpt.jpa.ui.xmlFileUpgradeToLatestVersion"
    class="org.eclipse.jpt.jpa.ui.internal.commands.UpgradeXmlFileVersionHandler">
        <activeWhen>
            <iterate ifEmpty="false">
                <or>
                    <adapt type="org.eclipse.jpt.jpa.core.context.XmlFile">
                        <test property="org.eclipse.jpt.jpa.core.isNotLatestSupportedVersion"/>
                    </adapt>
                    <adapt type="org.eclipse.jpt.common.core.resource.xml.JptXmlResource">
                       <test property="org.eclipse.jpt.jpa.core.isNotLatestSupportedVersion"/>
                    </adapt>
                </or>
            </iterate>
        </activeWhen>
</handler> 
```

在我的处理程序执行结束时，我调用：

```
IEvaluationService service = (IEvaluationService) activeWorkbenchWindow.getService(IEvaluationService.class);
service.requestEvaluation("org.eclipse.jpt.jpa.core.isNotLatestSupportedVersion"); 
```

**更新**：我做了更多调查，发现 4.2.1 与 3.8.1 相比出现了回归。即使我切换到使用**enabledWhen**并使用对 requestEvaluation 的调用，我仍然会在快速访问中看到该命令。我通过快速访问使用命令，然后立即再次使用快速访问，我看到命令仍然存在，如果单击它会得到 NotEnabledException。这适用于 3.8.1。

此特定命令不会打开对话框，但我添加了一个确认对话框，现在我的命令已从快速访问中删除！这甚至没有使用IValuationService.requestEvaluation。焦点的变化是否使处理程序得到重新评估？

# php - 无法在提交的页面上回显文件输入字段..？

> ID：13278819
> 
> 赞同：-1
> 
> 时间：2012-11-07T21:47:07.623
> 
> 标签：php, html, forms

我有一个非常大的表单正在提交到“更新”页面，该页面运行一些 SQL 查询并更新字段，然后重定向回原始页面。一切正常。我`$_POST`用来将我的变量发送到更新页面。

我最近需要`<input type='file' />`在页面中添加一个字段。每当用户选择一个文件时，表单就会中断，并且没有任何内容被提交到下一页。

我尝试`$_POST`在更新页面上回显我的变量。只要该`file`字段未设置，它们就会完美地通过。如果我选择一个文件，那么所有变量都不会出现。

我真的很困惑为什么会这样。有没有人知道为什么。这是摘录。

巨大表格的摘录：

```
<form enctype="multipart/form-data" method="post"  action="editConfirm.php">
      .
      .
     <input type="file" name="new_file" id="new_file"  />                                           
     <input type='field' width='25px' name='fakeInput' id='fakeInput' value='' />
     <input type="hidden" name="compressed_file_id" id="compressed_file_id"   value='<? echo $compressedID; ?>' /> 
```

和确认页面：

```
echo "New File = ".$_POST['new_file'];
echo "<br />Master Title = ".$_POST['masterTitle'];
echo "<br />Compressed File ID = ".$_POST['compressed_file_id']; 
```

因此，只要未设置新文件，这些都会正确回显。如果我选择一个文件并提交表单，它们都会中断并且没有任何结果。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-07T23:16:56.413

您不会将上传的文件数组作为 $_POST。您必须使用 $_FILES["new_file"] 来获取文件属性数组

参考 [http://php.net/manual/en/reserved.variables.files.php](http://php.net/manual/en/reserved.variables.files.php)

# angularjs - AngularJS - 模型数据聚合

> ID：13278821
> 
> 赞同：0
> 
> 时间：2012-11-07T21:47:10.450
> 
> 标签：angularjs

我正在使用 AngularJS，并且试图从 JSON 对象中获取最小值和最大值。

我有一个调用 API 并返回 JSON 对象的服务：

```
angular.module('modelLookupServices', ['ngResource']).
    factory('Year', function($resource) {
        return $resource('/api/years.json/', {},
            {
                query: {method:'GET', isArray:true}
            }
        );
    }); 
```

在我的控制器中，我正在调用此服务并将其用于不同的事情：

```
function BrowseCtrl($scope, Year) {

    $scope.years = Year.query();

    // I want to get the minimum and maximum years out of my model

} 
```

实现最小/最大功能相当简单，但我的问题是在哪里做？我是否应该将其作为可以将模型传递给的服务，并且它应该返回具有最小/最大值的对象？或者我应该把它作为一个实用功能放在控制器中？还是应该在完全不同的地方？

我正在尝试遵循 AngularJS 的干净代码方式，并在实现时考虑到关注点分离。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-07T21:54:05.050

简短的回答：你可以把它放在你最容易维护的地方。

如果获得最小/最大年份是您需要在整个应用程序中定期执行的操作，我会将其用于您的服务。由于服务面向可注入、可重用的功能，因此它很合适。

如果它是本地化到应用程序的一部分的东西，我会把它放在控制器中。由于控制器基本上用于操作范围内的数据，并且您将其放入范围内，因此它很合适。

这真的是你的电话。但我会在可读性/可维护性方面出错。

编辑：@RoyTruelove 是完全正确的......可测试性也可以（并且应该）是一个问题。

# jquery - 这是使用 History.js 的正确方法吗？

> ID：13278822
> 
> 赞同：10
> 
> 时间：2012-11-07T21:47:20.307
> 
> 标签：jquery, ajax, browser-history, history.js

我能够组合一个简化的完整 History.js 示例，使用三个链接从整个页面加载内容片段，而无需更新页面并更新浏览器历史记录。

这是相关的代码片段 - 一个完整的工作示例在这里[http://jsfiddle.net/PT7qx/show](http://jsfiddle.net/PT7qx/show)

```
<a href="/page-header">Page Header</a>
<a href="/login-form">Login Form</a>
<a href="/nothing">Nothing</a>

<script>
var History = window.History;
if (!History.enabled) {
    return false;
}

History.Adapter.bind(window, 'statechange', function() {
    var State = History.getState();
    History.log(State.data, State.title, State.url);

    if (State.title == 'Page Header') {
        $('#content').load('/user/login/ .pageHeader > *');
    }

    if (State.title == 'Login Form') {
        $('#content').load('/user/login/ #common-form > *');
    }

    if (State.title == 'Nothing') {
        $('#content').empty()
    }
});

$('body').on('click', 'a', function(e) {

    var urlPath = $(this).attr('href');
    var Title = $(this).text();
    History.pushState(null, Title, urlPath);

    // prevents default click action of <a ...>
    return false;
});
<\script> 
```

我想知道这是否是正确的用法。以前的版本可以使用 # url 绑定到事件。我没有看到任何使用这个最新版本将事件绑定到 url 的示例，所以我使用 .on() click 事件来调用 History 并整理出在那里点击了哪些链接。

我不确定这是否是完成此示例的最佳方法。

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2012-11-09T19:12:31.563

在进行了更多工作之后，我提出了一个简单但完整的示例来说明如何使用最新的 History.js。这是[工作 jsfiddle 示例](http://jsfiddle.net/Vwujy/show)，它执行托管在 Github 上的 Ajax 加载[HTML 片段](https://github.com/dansalmo/jsfiddle-ajax-host/blob/master/Demo/demo.response.html)

```
<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="content-type" content="text/html; charset=UTF-8">
    <title>Simple History.js Ajax example by dansalmo</title>

    <script type="text/javascript" src="http://code.jquery.com/jquery-1.8.2.js"></script>
    <script type="text/javascript" src="http://balupton.github.com/history.js/scripts/bundled/html4+html5/jquery.history.js"></script>

    <style type='text/css'>
      .hidden {
        display: none;
        visibility: hidden;
      }
    </style>
  </head>
  <body>
    <a href="/home">Home</a>
    <a href="/about">About</a>
    <a href="/contact">Contact</a>
    <a href="/other">Other</a>

    <p>The whole page will not re-load when the content below is updated, yet the URL is clean and the back button works!<p><br />
    <div id="content">
      <div id="home">Home Page content</div>
    </div>
    <br />
    <p>The content div will be updated with a selected div fragment from an HTML file hosted on github, however the broswer will see each content update request as a part of the page history so that the back button can be used.</p>
    <br  />
    <p>Adding more menu items is as simple as adding the new links and their corresponding html fragments.<p>
    <div id="hidden_content" class="hidden"></div>
  </body>
    <script type='text/javascript'>//<![CDATA[ 
  $(function(){
  var History = window.History;
  if (History.enabled) {
      State = History.getState();
      // set initial state to first page that was loaded
      History.pushState({urlPath: window.location.pathname}, $("title").text(), State.urlPath);
  } else {
      return false;
  }

  var loadAjaxContent = function(target, urlBase, selector) {
      $(target).load(urlBase + ' ' + selector);
  };

  var updateContent = function(State) {
      var selector = '#' + State.data.urlPath.substring(1);
    if ($(selector).length) { //content is already in #hidden_content
        $('#content').children().appendTo('#hidden_content');
        $(selector).appendTo('#content');
    } else { 
        $('#content').children().clone().appendTo('#hidden_content');
        loadAjaxContent('#content', State.url, selector);
    }
  };

  // Content update and back/forward button handler
  History.Adapter.bind(window, 'statechange', function() {
      updateContent(History.getState());
  });

  // navigation link handler
  $('body').on('click', 'a', function(e) {
      var urlPath = $(this).attr('href');
      var title = $(this).text();
      History.pushState({urlPath: urlPath}, title, urlPath);
      return false; // prevents default click action of <a ...>
  });
  });//]]>  

  </script>
</html> 
```

# java - 使用临时表的有效 SQL 不返回结果集

> ID：13278830
> 
> 赞同：2
> 
> 时间：2012-11-07T21:47:47.640
> 
> 标签：java, tsql, jdbc, sqljdbc

在过去的几个小时里，我一直在搜索谷歌和堆栈溢出，似乎无法找到与此问题完全匹配的内容。我对java比较陌生，所以如果我只是在做一些非常愚蠢的事情，请纠正我！

问题：执行 try-with-resource 查询 (statement.executeQuery(stmt)) 时，我收到“语句未返回结果集”

我可以保证这是有效的 SQL，并且当通过 SSMS 运行时，查询有效 - 当使用 select...into...from 样式语法时，此查询也有效 [在 java 中]。select...into...from 不是一个可行的选项，因为它会产生性能问题（由于资源利用率，23 秒的查询变成了 5 分钟以上的查询）

概念证明：SQL 文件：c:\test.sql

```
set nocount on
create table #test (loannum int)
insert into #test (loannum)
select 1
select * from #test
drop table #test 
```

此查询用于制作缓存结果集，以便我可以在其他函数周围传递数据，而无需与数据库建立开放连接......

**注意：下面的 SQLInfo 只是 "C:\test.sql"** < snip>

```
try(BufferedReader in = new BufferedReader(new FileReader(SQLInfo)))
                {
                    String str;
                    StringBuffer sb = new StringBuffer();
                    while((str = in.readLine()) != null)
                    {
                        sb.append(str + System.getProperty("line.separator"));
                    }

                    _stmt = sb.toString();
                } 
```

</snip>

后面会用到... < snip>

```
try (Connection connection = DriverManager.getConnection(CONNECTION);
                Statement statement = connection.createStatement();
                ResultSet resultset = statement.executeQuery(_stmt)
            ) 
        {

            crs.populate(resultset);

            return crs;
        }
        catch (SQLException e) 
        {
            e.printStackTrace();
        }
        return crs; 
```

</snip>

我所期待的是一个缓存的结果集，它将在 defaulttablemodel 中用于显示“loannum”字段，值为 1——我真正得到的是以下错误：“com.microsoft.sqlserver.jdbc. SQLServerException: 该语句没有返回结果集..."

如果我将 SQL 修改为以下内容：

```
set nocount on
select 1 as loannum
into #test
select * from #test
drop table #test 
```

我得到值为 1 的“loannum”的预期返回结果。

貌似跟executeQuery方法中的create table语句有关系，其实是临时表！有什么方法可以使上述内容与 create table (value type, value type, value type) insert into... 方法一起使用？

**注意：我尝试使用 .execute(String) 方法，并解析返回结果。它似乎有同样的问题，但完全有可能我执行不正确。

**次要说明：defaulttablemodel 工作正常，并将信息返回到屏幕上显示的 JTable。这会动态分配列名，并显示关联的值。如果需要，我可以提供此代码的示例，但我认为它与问题无关，因为这在简单地创建结果集时失败，而不是在尝试将信息分配给表模型时。

[编辑中]：在这种情况下，SQL 端的存储过程不是一个可行的选择。这是针对不允许将存储过程作为公司策略的数据仓库的查询（我已经推迟，并且已经被击倒） - 结果，我正在研究这个...... hackish 解决方案。

希望有人对这个问题有所了解！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-08T22:40:21.573

事实证明，在我更新为使用执行命令之后，我不小心将它包含在一个 try-with-resources 块中，导致将一个关闭的数据集返回给调用函数，然后将一个空的结果集传递给 create默认表模型。哎呀。

最终，执行查询与以下内容一起工作（仍然需要重构和清理，这只是“让它工作”）：

```
try 
        {
            boolean hasResults = statement.execute(_stmt);

            do { //I think... this could only possibly get one result. FIXME

            if (hasResults) 
            {
                try(ResultSet rs = statement.getResultSet())
                {
                    CachedRowSetImpl crs = new CachedRowSetImpl();
                    crs.populate(rs);

                    return crs;
                }
                catch (Exception e)
                {
                    e.printStackTrace();
                }
            }

            hasResults = statement.getMoreResults();

            } while (hasResults || statement.getUpdateCount() != -1);

            } 
        catch (Exception e) 
        {
            e.printStackTrace();
        } 
        finally 
        {
            statement.close();
        } 
```

# c# - 如何在 C# 中模拟另一个用户进行 DCOM 连接？

> ID：13278831
> 
> 赞同：4
> 
> 时间：2012-11-07T21:47:50.620
> 
> 标签：c#, .net, impersonation, dcom

我正在尝试连接到远程计算机上的 DCOM 对象，该对象以与 C# 应用程序不同的用户身份登录。我的代码在同一台计算机上运行时可以连接到同一个 DCOM 对象，如下所示：

```
MyDCOMType dcomObject;
Type remoteSessionContextType = Type.GetTypeFromProgID("ServerApp.MyDCOMType");
dcomObject = (MyDCOMType)Activator.CreateInstance(remoteSessionContextType);
string version = dcomObject.GetVersion(); 
```

MyDCOMType 是在 DCOM 应用程序（一个 VB6 应用程序）中实现的类型，我在项目中添加它作为参考。我已经能够在 C# 代码中创建它的一个实例，并调用所有具有预期结果的方法。现在我试图让它连接到远程机器上的同一个对象。我试图像这样在远程系统上模拟用户（省略了变量定义和错误处理）：

```
if (LogonUser(
       userName,
       domain,
       password,
       LOGON32_LOGON_NEW_CREDENTIALS,
       LOGON32_PROVIDER_WINNT50,
       out token) != false)
{
      if (DuplicateToken(token, (int)_SECURITY_IMPERSONATION_LEVEL.SecurityDelegation, out tokenDuplicate) != false)
      {
            impersonationContext = WindowsIdentity.Impersonate(tokenDuplicate.DangerousGetHandle());
      }
 } 
```

然后是类似的代码来创建对象：

```
MyDCOMType dcomObject;
Type remoteSessionContextType = Type.GetTypeFromProgID("ServerApp.MyDCOMType", ipAddress);
dcomObject = (MyDCOMType)Activator.CreateInstance(remoteSessionContextType);
string version = dcomObject.GetVersion(); 
```

除了 CreateInstance 调用引发 UnauthorizedAccessException 错误，错误代码为 80070005 以进行未经授权的访问。

另一件事是我有 C++ 代码，它可以完美地完成同样的事情。该代码如下所示：

```
COAUTHINFO      AuthInfo;
COAUTHIDENTITY  AuthIdentity;
COSERVERINFO    ServerInfo;
MULTI_QI        Results;
HRESULT     hr;
BSTR        version;
_MyDCOMType     *pSession = NULL;

AuthIdentity.Domain             = (unsigned short *) w_domain;
AuthIdentity.DomainLength       = wcslen( w_domain);
AuthIdentity.Flags              = SEC_WINNT_AUTH_IDENTITY_UNICODE;
AuthIdentity.Password           = (unsigned short *) w_password;
AuthIdentity.PasswordLength     = wcslen(w_password);
AuthIdentity.User               = (unsigned short *) w_username;
AuthIdentity.UserLength         = wcslen(w_username);

AuthInfo.dwAuthnLevel           = RPC_C_AUTHN_LEVEL_CALL;
AuthInfo.dwAuthnSvc             = RPC_C_AUTHN_WINNT;
AuthInfo.dwAuthzSvc             = RPC_C_AUTHZ_NONE;
AuthInfo.dwCapabilities         = EOAC_NONE;
AuthInfo.dwImpersonationLevel   = RPC_C_IMP_LEVEL_IMPERSONATE;
AuthInfo.pAuthIdentityData      = &AuthIdentity;
AuthInfo.pwszServerPrincName    = NULL;

ServerInfo.dwReserved1  = 0;
ServerInfo.dwReserved2  = 0;
ServerInfo.pAuthInfo    = &AuthInfo;
ServerInfo.pwszName     = w_nodename;

hr = CoCreateInstanceEx(clsid, NULL, CLSCTX_ALL, &ServerInfo, (ULONG) 1, &Results);
hr = CoSetProxyBlanket(Results.pItf, RPC_C_AUTHN_WINNT, RPC_C_AUTHZ_NONE, NULL,
    RPC_C_AUTHN_LEVEL_CALL, RPC_C_IMP_LEVEL_IMPERSONATE, &AuthIdentity, EOAC_NONE);
pSession = (_MyDCOMType *)Results.pItf;

hr = pSession->raw_GetVersion(&version); 
```

它连接到远程服务器，创建 DCOM 对象，并从中获取数据。我想弄清楚如何让我的 C# 代码做同样的事情。有任何想法吗？我是否弄乱了函数的枚举之一？我是否错过了一些重要的电话或做错了什么？作为背景，我的计算机和我尝试连接的计算机都在域帐户下登录，但彼此都没有权限。C++ 代码模拟远程用户以实现 DCOM 连接。我正在尝试进行 .NET 模拟，以使其对手动输入的用户名和密码的网络连接有效。

或者，如果不可能，我想我可以用相同的 C++ 代码编写一个小的 C++/CLR DLL 来处理 DCOM 连接部分并从 C# 代码中引用它，但我希望避免额外的复杂性.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-13T21:55:40.550

我敲了一阵子，没有任何进展，所以我放弃了，写了一个 C++/CLR DLL，效果很好。代码如下：

```
MyDCOMTalker::MyDCOMTalker(String ^ipAddress, String ^username, String ^password, String ^domain)
{
    COAUTHINFO      AuthInfo;
    COSERVERINFO    ServerInfo;
    MULTI_QI        Results;
    CLSID           clsid;
    AuthIdentity = new COAUTHIDENTITY;

    long        DSStatus;
    BSTR        umVersion;

    AuthIdentity->Domain            = (unsigned short *)Marshal::StringToHGlobalAuto(domain).ToPointer();
    AuthIdentity->DomainLength      = domain->Length;
    AuthIdentity->Flags             = SEC_WINNT_AUTH_IDENTITY_UNICODE;
    AuthIdentity->Password          = (unsigned short *)Marshal::StringToHGlobalAuto(password).ToPointer();
    AuthIdentity->PasswordLength    = password->Length;
    AuthIdentity->User              = (unsigned short *)Marshal::StringToHGlobalAuto(username).ToPointer();
    AuthIdentity->UserLength        = username->Length;

    AuthInfo.dwAuthnLevel           = RPC_C_AUTHN_LEVEL_CALL;
    AuthInfo.dwAuthnSvc             = RPC_C_AUTHN_WINNT;
    AuthInfo.dwAuthzSvc             = RPC_C_AUTHZ_NONE;
    AuthInfo.dwCapabilities         = EOAC_NONE;
    AuthInfo.dwImpersonationLevel   = RPC_C_IMP_LEVEL_IMPERSONATE;
    AuthInfo.pAuthIdentityData      = AuthIdentity;
    AuthInfo.pwszServerPrincName    = NULL;

    ServerInfo.dwReserved1  = 0;
    ServerInfo.dwReserved2  = 0;
    ServerInfo.pAuthInfo    = &AuthInfo;
    ServerInfo.pwszName     = (LPWSTR)Marshal::StringToHGlobalAuto(ipAddress).ToPointer();

    Results.pIID = &_uuidof(_MyDCOMType);
    Results.pItf = NULL;
    Results.hr   = 0;

    CoInitialize(NULL);
    Marshal::ThrowExceptionForHR(CLSIDFromProgID(L"MyDcomDLL.MyDCOMType", &clsid));
    Marshal::ThrowExceptionForHR(CoCreateInstanceEx(clsid, NULL, CLSCTX_ALL, &ServerInfo, (ULONG) 1, &Results));
    Marshal::ThrowExceptionForHR(CoSetProxyBlanket(Results.pItf, RPC_C_AUTHN_WINNT, RPC_C_AUTHZ_NONE, NULL, RPC_C_AUTHN_LEVEL_CALL, 
        RPC_C_IMP_LEVEL_IMPERSONATE, AuthIdentity, EOAC_NONE));
    pSession = (_MyDCOMType*)Results.pItf;
    Marshal::ThrowExceptionForHR(pSession->raw_GetVersion(&DSStatus, &umVersion));
    if (DSStatus == 0 && umVersion != NULL)
        version = Marshal::PtrToStringBSTR((System::IntPtr)umVersion);
    else
        version = String::Empty;
} 
```

带类定义：

```
public ref class MyDCOMTalker
{
private:
    _MyDCOMType *pSession;
    String ^version;
    COAUTHIDENTITY  *AuthIdentity;
public: 
    MyDCOMTalker(String ^ipAddress, String ^username, String ^password, String ^domain);
}; 
```

通常的警告适用 - 我删除了更简单的代码的实际功能和错误检查/处理细节，而且我真的不太了解 C++/CLR 或 COM 和 DCOM，所以可能有些事情可以做得更容易。如果您知道 C# 中的任何改进或方法，请酌情发表评论/回答。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-01-11T05:22:22.717

我已经为您实现了托管代码。但是谢谢你，根据你的实现，我能够理解这些事情是如何工作的。

```
using System;
using System.Runtime.InteropServices;
using System.Net;

namespace PM.Runtime.InteropServices {
    [Flags]
    public enum CLSCTX : uint {
        INPROC_SERVER          = 0x1,
        INPROC_HANDLER         = 0x2,
        LOCAL_SERVER           = 0x4,
        INPROC_SERVER16        = 0x8,
        REMOTE_SERVER          = 0x10,
        INPROC_HANDLER16       = 0x20,
        RESERVED1              = 0x40,
        RESERVED2              = 0x80,
        RESERVED3              = 0x100,
        RESERVED4              = 0x200,
        NO_CODE_DOWNLOAD       = 0x400,
        RESERVED5              = 0x800,
        NO_CUSTOM_MARSHAL      = 0x1000,
        ENABLE_CODE_DOWNLOAD   = 0x2000,
        NO_FAILURE_LOG         = 0x4000,
        DISABLE_AAA            = 0x8000,
        ENABLE_AAA             = 0x10000,
        FROM_DEFAULT_CONTEXT   = 0x20000,
        ACTIVATE_32_BIT_SERVER = 0x40000,
        ACTIVATE_64_BIT_SERVER = 0x80000,
        ENABLE_CLOAKING        = 0x100000,
        APPCONTAINER           = 0x400000,
        ACTIVATE_AAA_AS_IU     = 0x800000,
        PS_DLL                 = 0x80000000,
        INPROC = INPROC_SERVER | INPROC_HANDLER,
        SERVER = INPROC_SERVER | LOCAL_SERVER | REMOTE_SERVER,
        ALL    = SERVER        | INPROC_HANDLER
    }

    #region Native Pointers
    public abstract class PtrHandle : IDisposable {
        ~PtrHandle() { Dispose(false); }
        public void Dispose() {
            Dispose(true);
            GC.SuppressFinalize(this);
        }
        protected abstract void Dispose(bool disposing);
        public abstract IntPtr Handle { get; }
        public static implicit operator IntPtr(PtrHandle managedPtr) {
            return managedPtr != null ? managedPtr.Handle : IntPtr.Zero;
        }
    }

    public class PinnedObject<T> : PtrHandle {
        private GCHandle _handle;
        public PinnedObject(ref T obj) { 
            _handle = GCHandle.Alloc(obj, GCHandleType.Pinned);
        }
        protected override void Dispose(bool disposing) { 
            _handle.Free(); 
        }
        public override IntPtr Handle { 
            get { return _handle.AddrOfPinnedObject(); } 
        }
    }

    public class GlobalPtr : PtrHandle {
        private IntPtr _handle = IntPtr.Zero;
        protected GlobalPtr() {}
        protected override void Dispose(bool disposing) {
            Free(ref _handle); // always release unmanaged memory...
        }

        protected void SetHandle(IntPtr handle) { 
            Free(ref _handle);
            _handle = handle; 
        }
        // get handle back with: Marshal.PtrToStructure<T>(nativePtr.Handle, T value); 
        protected void SetHandle<T>(ref T value, bool deleteOld = false) where T: struct {
            Free(ref _handle);
            _handle = Marshal.AllocHGlobal(Marshal.SizeOf(typeof(T)));
            try {
                Marshal.StructureToPtr(value, _handle, deleteOld); 
            } catch { 
                Free(ref _handle);
                throw;
            }
        }
        public sealed override IntPtr Handle { 
            get { return _handle; } 
        }

        public static void Free<T>(ref T handle) where T: GlobalPtr {
            if (handle != null) {
                handle.Dispose();
                handle = null;
            }
        }
        public static void Free(ref IntPtr handle) {
            if (handle != IntPtr.Zero) {
                Marshal.FreeHGlobal(handle);
                handle = IntPtr.Zero;
            }
        }
    }

    public class LPAStr : GlobalPtr {
        public LPAStr(string value) { 
            SetHandle(Marshal.StringToHGlobalAnsi(value));
        }
    }
    public class LPWStr : GlobalPtr {
        public LPWStr(string value) { 
            SetHandle(Marshal.StringToHGlobalUni(value));
        }
    }
    public class PinnedStruct<T> : GlobalPtr where T: struct {
        public PinnedStruct(ref T value) {
            SetHandle<T>(ref value);
        }
    }
    #endregion

    public class WINNTAuthnInfo {
        public NetworkCredential Credential;
        public uint              AuthnLevel;
        public uint              ImpersonationLevel;
        public WINNTAuthnInfo(NetworkCredential Credential,
            uint AuthnLevel         = ComUtils.RPC_C_AUTHN_LEVEL_DEFAULT,
            uint ImpersonationLevel = ComUtils.RPC_C_IMP_LEVEL_IMPERSONATE) {
            this.Credential         = Credential;
            this.AuthnLevel         = AuthnLevel;
            this.ImpersonationLevel = ImpersonationLevel;
        }
        public static explicit operator WINNTAuthnInfo(NetworkCredential credential) {
            return new WINNTAuthnInfo(credential);
        }
    }

    public static class ComUtils {
        private static class Guids {
            public const string IID_IUnknown  = "00000000-0000-0000-C000-000000000046";
            public const string IID_IDispatch = "00020400-0000-0000-C000-000000000046";
        }
        // IID constants...
        public static readonly Guid IID_IUnknown  = new Guid(Guids.IID_IUnknown);
        public static readonly Guid IID_IDispatch = new Guid(Guids.IID_IDispatch);

        #region Constants
        // HResult codes...
        public  const int S_OK           = 0;
        public  const int E_ABORT        = -2147467260;
        public  const int E_ACCESSDENIED = -2147024891;
        public  const int E_FAIL         = -2147467259;
        public  const int E_HANDLE       = -2147024890;
        public  const int E_INVALIDARG   = -2147024809;
        public  const int E_NOINTERFACE  = -2147467262;
        public  const int E_NOTIMPL      = -2147467263;
        public  const int E_OUTOFMEMORY  = -2147024882;
        public  const int E_POINTER      = -2147467261;
        public  const int E_UNEXPECTED   = -2147418113;
        public  const int REGDB_E_CLASSNOTREG
                                         = -2147221164;

        // Some private values...
        private const int SEC_WINNT_AUTH_IDENTITY_ANSI    = 1;
        private const int SEC_WINNT_AUTH_IDENTITY_UNICODE = 2;

        public const uint RPC_C_AUTHN_NONE                = 0;
        public const uint RPC_C_AUTHN_DCE_PRIVATE         = 1;
        public const uint RPC_C_AUTHN_DCE_PUBLIC          = 2;
        public const uint RPC_C_AUTHN_DEC_PUBLIC          = 4;
        public const uint RPC_C_AUTHN_GSS_NEGOTIATE       = 9;
        public const uint RPC_C_AUTHN_WINNT               = 10;
        public const uint RPC_C_AUTHN_GSS_SCHANNEL        = 14;
        public const uint RPC_C_AUTHN_GSS_KERBEROS        = 16;
        public const uint RPC_C_AUTHN_DPA                 = 17;
        public const uint RPC_C_AUTHN_MSN                 = 18;
        public const uint RPC_C_AUTHN_KERNEL              = 20;
        public const uint RPC_C_AUTHN_DIGEST              = 21;
        public const uint RPC_C_AUTHN_NEGO_EXTENDER       = 30;
        public const uint RPC_C_AUTHN_PKU2U               = 31;
        public const uint RPC_C_AUTHN_MQ                  = 100;
        public const uint RPC_C_AUTHN_DEFAULT             = 0xFFFFFFFF;

        public const uint RPC_C_AUTHZ_NONE                = 0;
        public const uint RPC_C_AUTHZ_NAME                = 1;
        public const uint RPC_C_AUTHZ_DCE                 = 2;
        public const uint RPC_C_AUTHZ_DEFAULT             = 0xFFFFFFFF;

        public const uint RPC_C_AUTHN_LEVEL_DEFAULT       = 0;
        public const uint RPC_C_AUTHN_LEVEL_NONE          = 1;
        public const uint RPC_C_AUTHN_LEVEL_CONNECT       = 2;
        public const uint RPC_C_AUTHN_LEVEL_CALL          = 3;
        public const uint RPC_C_AUTHN_LEVEL_PKT           = 4;
        public const uint RPC_C_AUTHN_LEVEL_PKT_INTEGRITY = 5;
        public const uint RPC_C_AUTHN_LEVEL_PKT_PRIVACY   = 6;

        public const uint RPC_C_IMP_LEVEL_DEFAULT         = 0;
        public const uint RPC_C_IMP_LEVEL_ANONYMOUS       = 1;
        public const uint RPC_C_IMP_LEVEL_IDENTIFY        = 2;
        public const uint RPC_C_IMP_LEVEL_IMPERSONATE     = 3;
        public const uint RPC_C_IMP_LEVEL_DELEGATE        = 4;
        public const uint EOAC_NONE                       = 0;
        #endregion

        #region Internal unmanaged pointers...
        private class WINNTAuthidEntityPtr : GlobalPtr {
            public LPWStr _hdomain = null;
            public LPWStr _huser   = null;
            public LPWStr _hpass   = null;
            public static WINNTAuthidEntityPtr Create(NetworkCredential credential) {
                return credential != null
                    ? new WINNTAuthidEntityPtr(credential) : null;
            }
            public WINNTAuthidEntityPtr(NetworkCredential credential) {
                if (credential == null)
                    throw new ArgumentNullException("Credential");
                try {
                    string pasword = credential.Password;
                    var authIdentity = new NativeMethods.COAUTHIDENTITY() {
                        User           = (_huser   = new LPWStr(credential.UserName)),
                        Domain         = (_hdomain = new LPWStr(credential.Domain)),
                        Password       = (_hpass   = new LPWStr(pasword)),
                        UserLength     = (credential.UserName == null ? 0 : credential.UserName.Length),
                        DomainLength   = (credential.Domain   == null ? 0 : credential.Domain  .Length),
                        PasswordLength = (credential.Password == null ? 0 : pasword            .Length),
                        Flags          = SEC_WINNT_AUTH_IDENTITY_UNICODE
                    };

                    SetHandle<NativeMethods.COAUTHIDENTITY>(ref authIdentity);
                } catch { 
                    Free<LPWStr>(ref _hpass);
                    Free<LPWStr>(ref _hdomain);
                    Free<LPWStr>(ref _huser);
                    throw;
                }
            }
            protected override void Dispose(bool disposing) {
                base.Dispose(disposing);
                Free<LPWStr>(ref _hpass);
                Free<LPWStr>(ref _hdomain);
                Free<LPWStr>(ref _huser);
            }
        }

        private class WINNTAuthInfoPtr : GlobalPtr {
            private WINNTAuthidEntityPtr _identity   = null;
            public static WINNTAuthInfoPtr Create(WINNTAuthnInfo authInfo) {
                return authInfo != null
                    ? new WINNTAuthInfoPtr(authInfo.Credential, authInfo.AuthnLevel, authInfo.ImpersonationLevel) : null;
            }
            public WINNTAuthInfoPtr(NetworkCredential credential = null,
                uint AuthnLevel         = RPC_C_AUTHN_LEVEL_DEFAULT,
                uint ImpersonationLevel = RPC_C_IMP_LEVEL_IMPERSONATE) {
                _identity = WINNTAuthidEntityPtr.Create(credential);
                try {
                    var authInfo = new NativeMethods.COAUTHINFO() {
                        dwAuthnSvc           = RPC_C_AUTHN_WINNT,
                        dwAuthzSvc           = RPC_C_AUTHZ_NONE,
                        pwszServerPrincName  = IntPtr.Zero,
                        dwAuthnLevel         = AuthnLevel,
                        dwImpersonationLevel = ImpersonationLevel,
                        pAuthIdentityData    = _identity,
                        dwCapabilities       = EOAC_NONE
                    };

                    SetHandle<NativeMethods.COAUTHINFO>(ref authInfo);
                } catch { 
                    Free<WINNTAuthidEntityPtr>(ref _identity);
                    throw;
                }
            }
            protected override void Dispose(bool disposing) {
                base.Dispose(disposing);
                Free<WINNTAuthidEntityPtr>(ref _identity);
            }

            internal IntPtr Identity { get { return _identity; } }
        }
        #endregion

        public static object CreateInstance(
            string progId, 
            object pUnkOuter = null, CLSCTX dwClsContext = CLSCTX.SERVER) {
            return CreateInstanceEx(
                NativeMethods.CLSIDFromProgID(progId), IID_IUnknown, 
                pUnkOuter, dwClsContext);
        }
        public static object CreateInstance2(
            string progId, Guid intfId, 
            object pUnkOuter = null, CLSCTX dwClsContext = CLSCTX.SERVER) {
            return CreateInstanceEx(
                NativeMethods.CLSIDFromProgID(progId), intfId, 
                pUnkOuter, dwClsContext);
        }
        public static object CreateRemoteInstance(string remoteServer, 
            string progId, WINNTAuthnInfo authInfo = null,
            object pUnkOuter = null, CLSCTX dwClsContext = CLSCTX.REMOTE_SERVER) {
            return CreateRemoteInstanceEx(remoteServer,
                NativeMethods.CLSIDFromProgID(progId), IID_IUnknown, authInfo,
                pUnkOuter, dwClsContext);
        }
        public static object CreateRemoteInstance2(string remoteServer, 
            string progId, Guid intfId, WINNTAuthnInfo authInfo = null,
            object pUnkOuter = null, CLSCTX dwClsContext = CLSCTX.REMOTE_SERVER) {
            return CreateRemoteInstanceEx(remoteServer, 
                NativeMethods.CLSIDFromProgID(progId), intfId, authInfo,
                pUnkOuter, dwClsContext);
        }

        public static object CreateInstanceEx(
            Guid classId, Guid intfId, 
            object pUnkOuter = null, CLSCTX dwClsContext = CLSCTX.SERVER) {
            return NativeMethods.CoCreateInstance(
                classId, pUnkOuter, dwClsContext, intfId);
        }
        public static object CreateRemoteInstanceEx(string remoteServer,
            Guid classId, Guid intfId, WINNTAuthnInfo authInfo = null,
            object pUnkOuter = null, CLSCTX dwClsContext = CLSCTX.REMOTE_SERVER) {
            using (var authInfoPtr = WINNTAuthInfoPtr.Create(authInfo))
            using (var intfIdPtr   = new PinnedObject<Guid>(ref intfId)) {
                NativeMethods.COSERVERINFO si = new NativeMethods.COSERVERINFO() {
                    dwReserved1 = 0,
                    pwszName    = remoteServer,
                    pAuthInfo   = authInfoPtr,
                    dwReserved2 = 0
                };

                NativeMethods.MULTI_QI[] moi = new NativeMethods.MULTI_QI[1];
                moi[0] = new NativeMethods.MULTI_QI() {
                    pIID = intfIdPtr,
                    pItf = null,
                    hr   = 0
                };

                NativeMethods.CoCreateInstanceEx(classId, pUnkOuter, dwClsContext, ref si, 1, moi);
                if (moi[0].hr < 0)
                    Marshal.ThrowExceptionForHR(moi[0].hr);
                if (moi[0].pItf == null)
                    Marshal.ThrowExceptionForHR(E_POINTER);
                if (authInfoPtr != null && authInfo != null)
                    SetSecurity(moi[0].pItf, authInfoPtr.Identity, authInfo.AuthnLevel, authInfo.ImpersonationLevel);
                return moi[0].pItf;
            }
        }

        private static object SetSecurity(object objDCOM, 
            IntPtr authidEntity,
            uint   AuthnLevel         = RPC_C_AUTHN_LEVEL_DEFAULT,
            uint   ImpersonationLevel = RPC_C_IMP_LEVEL_IMPERSONATE) {
            //IntPtr ptrInterface = Marshal.GetIUnknownForObject(objDCOM);
            NativeMethods.CoSetProxyBlanket(
                objDCOM,            // pProxy
                RPC_C_AUTHN_WINNT,  // dwAuthnSvc
                RPC_C_AUTHZ_NONE,   // dwAuthzSvc
                IntPtr.Zero,        // pServerPrincName
                AuthnLevel,         // dwAuthnLevel
                ImpersonationLevel, // dwImpLevel
                authidEntity,       // pAuthInfo
                EOAC_NONE);         // dwCapabilities
            return objDCOM;
        }
        public static object SetSecurity(object objDCOM, WINNTAuthnInfo authInfo) {
            if (authInfo == null) 
                throw new ArgumentNullException("Authentication-Info");
            using (var authidEntity = WINNTAuthidEntityPtr.Create(authInfo.Credential))
                return SetSecurity(objDCOM, 
                    authidEntity, authInfo.AuthnLevel, authInfo.ImpersonationLevel);
        }
        public static object SetSecurity(object objDCOM, 
            NetworkCredential credential,
            uint   AuthnLevel         = RPC_C_AUTHN_LEVEL_DEFAULT,
            uint   ImpersonationLevel = RPC_C_IMP_LEVEL_IMPERSONATE) {
            using (var authidEntity = WINNTAuthidEntityPtr.Create(credential))
                return SetSecurity(objDCOM, 
                    authidEntity, AuthnLevel, ImpersonationLevel);
        }

        private static class NativeMethods {
            public static Guid CLSIDFromProgID(string progId) {
                Guid classId;
                int hr = NativeMethods.CLSIDFromProgID(progId, out classId);
                if (hr < 0)
                    Marshal.ThrowExceptionForHR(hr);
                return classId;
            }

            [DllImport("ole32.dll")]
            public static extern int ProgIDFromCLSID(
                [In] ref Guid clsid, [MarshalAs(UnmanagedType.LPWStr)]out string lplpszProgID);
            [DllImport("ole32.dll")]
            public static extern int CLSIDFromProgID(
                [MarshalAs(UnmanagedType.LPWStr)]string lpszProgID, out Guid pclsid);

            [DllImport("ole32.dll", ExactSpelling=true, PreserveSig=false)]
            [return: MarshalAs(UnmanagedType.Interface)]
            public static extern object CoCreateInstance(
                [In, MarshalAs(UnmanagedType.LPStruct)] Guid rclsid,
                [MarshalAs(UnmanagedType.IUnknown)] object pUnkOuter,
                CLSCTX dwClsContext,
                [In, MarshalAs(UnmanagedType.LPStruct)] Guid riid);

            [StructLayout(LayoutKind.Sequential)] 
            public struct COAUTHIDENTITY {
                //[MarshalAs(UnmanagedType.LPWStr)] 
                public IntPtr User;
                public int    UserLength;
                //[MarshalAs(UnmanagedType.LPWStr)] 
                public IntPtr Domain;
                public int    DomainLength;
                //[MarshalAs(UnmanagedType.LPWStr)] 
                public IntPtr Password;
                public int    PasswordLength;
                public int    Flags;
            };

            [StructLayout(LayoutKind.Sequential)]
            public struct COAUTHINFO {
                public uint   dwAuthnSvc;
                public uint   dwAuthzSvc;
                //[MarshalAs(UnmanagedType.LPWStr)] 
                public IntPtr pwszServerPrincName;
                public uint   dwAuthnLevel;
                public uint   dwImpersonationLevel;
                public IntPtr pAuthIdentityData;
                public uint   dwCapabilities;
            }

            [StructLayout(LayoutKind.Sequential)]
            public struct COSERVERINFO {
                public uint   dwReserved1;
                [MarshalAs(UnmanagedType.LPWStr)]
                public string pwszName;
                public IntPtr pAuthInfo;
                public uint   dwReserved2;
            }

            [StructLayout(LayoutKind.Sequential)]
            public struct MULTI_QI {
                public IntPtr pIID;
                [MarshalAs(UnmanagedType.Interface)] public object pItf;
                public int hr;
            }

            [DllImport("ole32.dll", ExactSpelling=true, PreserveSig=false)]
            [return: MarshalAs(UnmanagedType.Interface)]
            public static extern void CoCreateInstanceEx(
                [In, MarshalAs(UnmanagedType.LPStruct)] Guid rclsid,
                [MarshalAs(UnmanagedType.IUnknown)] object pUnkOuter, 
                CLSCTX dwClsCtx,
                [In]ref COSERVERINFO pServerInfo, 
                uint cmq, 
                [In, Out] MULTI_QI[] pResults);

            [DllImport("Ole32.dll", PreserveSig = false)]
            public static extern void CoSetProxyBlanket(
                [MarshalAs(UnmanagedType.Interface)]
                object pProxy,           // IntPtr pProxy, 
                uint   dwAuthnSvc, 
                uint   dwAuthzSvc,
                IntPtr pServerPrincName, 
                uint   dwAuthLevel,
                uint   dwImpLevel, 
                IntPtr pAuthInfo,
                uint   dwCapabilities);
        }
    }
} 
```

# java - Javahangman如何累计添加字母

> ID：13278834
> 
> 赞同：-1
> 
> 时间：2012-11-07T21:48:03.367
> 
> 标签：java, netbeans, replace, stringbuilder

我正在编写一个 Java 刽子手游戏，到目前为止，我已经获得了一次替换一个的代码。我需要的是每次都替换，直到猜到单词为止。这是一次一个的工作方式：

```
 for(int i = 0; i < GuessWord.length(); i++) {
        foundword = words[randvalue].replaceAll("[^" + xletters + "]", "_ ");
        }
            GuessedLetters = xletters.toString().toUpperCase();
            WordLabel.setText(foundword.toUpperCase());
            GuessedLabel.setText(GuessedLetters);
            GuessText.setText(null);
            GuessText.requestFocusInWindow(); 
```

这是我的另一次尝试，但效果不佳：

```
 //replace underscores with letters as they are guessed while the word is not solved
        do {
        foundword = words[randvalue].replaceAll("[^" + xletters + "]", "_ ");
        }
        while (!SetMain.equals(GuessWord));
            //set results to labels
            WordLabel.setText(foundword.toUpperCase());
            GuessedLabel.setText(GuessedLetters);
            GuessText.setText(null);
            GuessText.requestFocusInWindow(); 
```

这是我为需要它的人提供的完整代码：

```
 import java.util.Random;
    import java.util.Scanner;
    import javax.swing.JOptionPane;

    public class MainFrame extends javax.swing.JFrame {

        public MainFrame() {
            initComponents();
        }
    static String SecretWord = "";
    double Result = 0;
    StringBuilder mainword = new StringBuilder();
     String[] words = {"technology", "computer", "camera", "graphic design", "digital", "media", "technician", "photography", "troubleshoot", "pixels", "application", "download"};
     Random r = new Random();
    int randvalue = r.nextInt(11);
    String GuessWord = words[randvalue];
    int errors = 0;

        private void GoButtonActionPerformed(java.awt.event.ActionEvent evt) {                                          

        for(int i = 0; i < GuessWord.length(); i++) { 
           mainword.append("_ ");
        }
           mainword.append(SecretWord);
           String SetMain = mainword.toString();
           WordLabel.setText(SetMain);
           GuessButton.setEnabled(true);
           GoButton.setEnabled(false); 
        }                                        

        private void GuessButtonActionPerformed(java.awt.event.ActionEvent evt){                                            
        String strGuess = GuessText.getText(); //user input
        StringBuilder xletters = new StringBuilder(strGuess); // letters guessed
        String GuessedLetters = null;
        String foundword = null;

        //replace underscores with letters as they are guessed
        for(int i = 0; i < GuessWord.length(); i++) {
        foundword = words[randvalue].replaceAll("[^" + xletters + "]", "_ ");

        }
            //set to labels to display results
            GuessedLetters = xletters.toString().toUpperCase();
            WordLabel.setText(foundword.toUpperCase());
            GuessedLabel.setText(GuessedLetters);
            GuessText.setText(null);
            GuessText.requestFocusInWindow(); 
```

所以我希望代码能够累积替换字母，即如果这个词是你好：

密语：_ _ _ _ _ 猜到 e....

密语：_e _ _ _ 猜到 o....

密语：_e _ _ o 猜到了……

密语：_ e _ _ o 猜到 h....

Seret Word: he _ _ o guessed l....

密语：你好，恭喜！

我需要它在 Netbeans IDE 7.2 中工作，它必须适用于 JLayeredPane，而不是 System.out.print 方法。谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-07T23:21:59.450

我不确定这是否完全是你所追求的，但它可能会给你一些想法......

```
public class TestHangMan {

    public static void main(String[] args) {
        new TestHangMan();
    }

    public TestHangMan() {
        String word = "Testing";
        String mask = "_______";

        mask = checkGuess(word, mask, 'a');
        System.out.println(mask);
        mask = checkGuess(word, mask, 't');
        System.out.println(mask);
        mask = checkGuess(word, mask, 'e');
        System.out.println(mask);
        mask = checkGuess(word, mask, 's');
        System.out.println(mask);
        mask = checkGuess(word, mask, 'g');
        System.out.println(mask);
        mask = checkGuess(word, mask, 'n');
        System.out.println(mask);
        mask = checkGuess(word, mask, 'i');
        System.out.println(mask);
    }

    protected String checkGuess(String word, String mask, char guess) {
        guess = Character.toLowerCase(guess);
        StringBuilder sb = new StringBuilder(mask);
        for(int index = 0; index < word.length(); index++) {
            if (Character.toLowerCase(word.charAt(index)) == guess) {
                sb.setCharAt(index, word.charAt(index));
            }
        }
        return sb.toString();
    }

} 
```

哪个产生...

```
_______
T__t___
Te_t___
Test___
Test__g
Test_ng
Testing 
```

您可以检查掩码以查看用户是否已经做出了猜测，只需使用`mask.toLowerCase().contains(stringGuess.toLowerCase())`

希望能帮助到你。

# erlang - 这是否证明我的餐桌工作？

> ID：13278837
> 
> 赞同：2
> 
> 时间：2012-11-07T21:48:22.520
> 
> 标签：erlang

我认为我很好地创建了 mnesia，因为我在一个节点中添加了记录，并且我可以在另一个节点的同一张表中看到它。这证明它有效吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-08T18:48:11.593

您涵盖了分发 - 干得好；）缺少的部分是持久性。确保您的模式和表在磁盘上（而不是在内存中）——当然只有在需要时。

你的朋友是：

```
 mnesia:change_table_copy_type(schema, node(), disc_copies).
 mnesia:add_table_copy(SomeTableName, node(), disc_copies). 
```

通常它需要重新启动才能应用更改。

您可以查阅 mnesia:info() 以查看您的数据库的外观。

# maven - Jenkins 在 mercurial 提交后构建

> ID：13278840
> 
> 赞同：6
> 
> 时间：2012-11-07T21:48:52.727
> 
> 标签：maven, ubuntu, mercurial, jenkins, hudson

我已经在这个项目上工作了大约一个星期，我一直在寻找 2 天没有任何明确的在线解释。对于学校作业，我们需要使用以下程序设置构建服务器：

*   Maven，作为我们的构建工具。
*   Mercurial 作为我们的版本控制系统。
*   Java (JRE)、javac 和 javadoc。
*   JUnit 用于单元测试。
*   詹金斯（带有 JDepend 插件）。

我们需要创造 3 个工作，其中 1 个工作是：

> *每次编辑 Mercurial 的（本地）存储库时，都需要开始构建。（意思是：每个 Mercurial 提交都需要被 Jenkins 检测到。这个“检测”需要每 1 分钟触发一次）*

我们需要使用的工具是：**Javac**、**Maven**作为我们的构建工具，当然还有**Mercurial**。

这一切都发生在 Ubuntu 环境中。由于我（根本）不熟悉 Linux，所以我不知道如何做到这一点。

我不是要求一个现成的解决方案，而是要求一些“提示”来理解诸如 Mercurial *'Hooks' 之*类的东西，我需要（做）什么才能让这份工作在 Jenkins 中工作，等等。我所做的一切find online 比较模糊，使用 python 的示例。

如此具体：可能会欢迎一些指导:)感谢每一位帮助！

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-11-07T22:08:14.633

在有人推送到您的仓库后，在 Jenkins 上触发构建的最有效方法是使用 mecurial 中的[changegroup 挂钩](https://www.mercurial-scm.org/wiki/Hook#The_changegroup_hook)。

另一方面，Jenkins 允许通过使用特殊令牌调用作业的 URL 来远程触发构建。必须在 Jenkins 上的作业中配置此触发器和相应的令牌：

![构建触发器配置](../Images/2f99be84689073ee9f5463cc30663ee8.png)

将放入 repos .hg/hgrc 文件中的 mercurial 挂钩可以定义如下：

```
[hooks]
changegroup = curl --silent http://your.jenkins.server.url/jenkins/job/<YOURJOBNAMEHERE>/build?token=Foo 
```

这个钩子使用[curl](http://curl.haxx.se/)命令行工具来调用你的 jenkins 作业的 URL，并使用允许远程触发作业的定义令牌。当然，Curl 必须安装在你的 linux 机器上。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-11-07T22:02:36.447

听起来您的教授希望 Jenkins 轮询 Mercurial 存储库的更改（“每 1 分钟触发一次”）。当您设置 Jenkins 作业时，名为“构建触发器”的部分将有一个投票选项。那就是你想要的那个。

更好的解决方案是让 Mercurial 告诉 Jenkins 有关更改，因为轮询通常是一个坏主意（即使您几天没有检查任何内容，Jenkins 仍然*每分钟*询问是否有任何更改）。您可以查看[本书](http://hgbook.red-bean.com/)以获取有关如何编写 Mercurial 挂钩的示例，也可以使用我编写的[Python 脚本。](https://bitbucket.org/moswald/hgjenkins/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-07-19T14:06:10.670

要在推送到 Bitbucket 上的 Mercurial 存储库时触发 Jenkins 构建，您可以转到存储库的管理（单击齿轮）并选择服务。在那里，您可以使用四个参数定义 Jenkins 服务：

1.  Endpoint：Jenkins 服务器的 URL。
    *   对于安全的 Jenkins 服务器，您需要指定用户名和 api 令牌。api 令牌由 Jenkins 在“管理用户”/“配置”页面上为特定用户生成。
2.  模块名称：可选参数，根据推送的内容选择性地触发构建
3.  项目名称：Jenkins作业的名称
4.  Token：可选参数，与选择“Trigger builds remote (eg, from scripts)”时在Jenkins作业上定义的Authentication Token相同

（我想这只是詹姆斯在 2012 年 11 月 7 日的回复中提到的定义“变更组挂钩”的一种 gui 方式。）

# c - 解压的 msgpack_object 是否依赖于解压的缓冲区？

> ID：13278844
> 
> 赞同：0
> 
> 时间：2012-11-07T21:49:04.610
> 
> 标签：c, msgpack

根据我看到的奇怪行为，我猜测以下代码无效。我的问题是：下面创建的 msgpack_object 是否依赖于 msgpack_sbuffer？也就是说，一旦调用 msgpack_sbuffer_free(buffer)，msgpack_object（在 msg.data 中）是否无效？如果是这样，在这种情况下获得没有依赖关系的堆分配 msgpack_object 的正确方法是什么？

```
msgpack_object create_static_msg_object() {
  msgpack_sbuffer* buffer = msgpack_sbuffer_new();
  msgpack_packer* pk = msgpack_packer_new(buffer, msgpack_sbuffer_write);

  // does some calls to msgpack_pack_*() here

  msgpack_unpacked msg;
  msgpack_unpacked_init(&msg);

  msgpack_unpack_next(&msg, buffer->data, buffer->size, NULL);

  /* cleaning */
  msgpack_sbuffer_free(buffer);
  msgpack_packer_free(pk);

  return msg.data;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-09T10:21:09.583

*-`msgpack_object`下面创建的是否取决于`msgpack_sbuffer`？*

不，您`msgpack_sbuffer`仅在打包时使用（它是用于`msgpack_packer`写入二进制序列化的增长缓冲区）。

相反， msgpack 对象取决于`msgpack_unpacked`结构：

```
typedef struct msgpack_unpacked {
    msgpack_zone* zone;
    msgpack_object data;
} msgpack_unpacked; 
```

对象与此结构密切相关，与此对象相关的动态内存（例如，如果它包含数组、映射等）由`zone`.

*- `msgpack_object`(in `msg.data`) 是否无效，一旦`msgpack_sbuffer_free(buffer)`被调用？*

不，因为它与`sbuffer`（见上文）无关。

但是一旦`msg`被销毁它就无效了，即在`create_static_msg_object`函数的末尾，因为`msg`它是一个局部变量。

注意：在上面的代码中，你应该小心调用`msgpack_unpacked_destroy(&msg)`，以便在解包时分配的内部内存被正确释放。通过这样做，msgpack 对象也被清零。

*`msgpack_object`-在没有依赖关系的情况下分配堆的正确方法是什么？*

我会说你有两个解决方案：

1.  深度复制（最常见的情况）：`msg.data`递归浏览对象并在您自己的堆分配结构中复制每条数据。如果您使用预期的预定义格式解压缩档案，这样做会更容易。
2.  `msg`内存维护：动态分配`msgpack_unpacked *msg = malloc(sizeof(*msg));`解压后的结构（调用者必须管理删除：这里再次使用`msgpack_unpacked_destroy`释放内部区域内存，然后释放`msg`指针。

# visual-studio - 为什么在 Resharper/MSTest 下调试时引用的 dll 被锁定？

> ID：13278846
> 
> 赞同：4
> 
> 时间：2012-11-07T21:49:16.267
> 
> 标签：visual-studio, unit-testing, debugging, resharper, mstest

我对汇编中的方法进行了集成测试`A`。程序`A`集`B`通过项目引用引用程序集。我在 Resharper 6.1 单元测试场景中的 Visual Studio 2010 调试器下运行它们。测试引擎是微软的原生 MSTest。

我知道臭名昭著

> 该进程无法访问该文件`...\B.dll`，因为它正被另一个进程使用。

信息。我已经验证没有其他进程对该文件有句柄（例如，通过 Sysinternal 的 Process Explorer）。

从调试器中运行测试工作正常。任何想法为什么它会在调试器下发生以及我可以做些什么来修复它？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-04-22T14:25:33.570

我见过类似的情况，在任务管理器中发现vtest.discoveryengine.exe和vtest.executionengine.exe还活着。我杀了两个，这解决了问题。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2015-05-01T13:29:33.027

基于 Sébastien 的回答，我在我的测试项目中添加了一个预构建步骤，以自动终止任何`vstest.*`仍在运行的可执行文件。以下预构建命令对我有用：

```
taskkill /f /im vstest.*
exit 0 
```

该`exit 0`命令位于末尾，以防止在没有`vstest.*`可执行文件运行时构建失败。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-10-22T06:19:29.883

在@mrtumnus 的答案和[此处的答案](https://superuser.com/a/433002/167358)的基础上，我在我的测试项目中添加了一个预构建步骤以自动终止任何`vstest.*`可执行文件：

```
START taskkill /f /im vstest.* 
```

如果任务没有运行，使用`START`而不是`exit 0`所以它不会给出错误。（不过，它确实打开了一个命令窗口，这有点烦人）。

# wpf - WPF Frame 服务缓存页面

> ID：13278848
> 
> 赞同：3
> 
> 时间：2012-11-07T21:49:20.710
> 
> 标签：wpf, xaml, caching

我正在为 WPF 应用程序编写帮助系统。我想出了一个系统，内容所有者将以简化的 XML 格式构建模板，通过 IIS 中的 HttpModule 将 XSLT 转换为 XAML，生成的 XAML 页面显示在客户端应用程序的框架中。我通过视图模型向页面公开基本功能，因此可以从客户端应用程序获得命令和数据。

这很好用，但我的问题是 Frame 似乎在某处缓存 XAML。例如，如果我对 XML 进行更改，客户端会继续显示以前的 XAML。如果我在外部浏览器（IE 或 Chrome）中导航到 URI，我可以看到新的 XAML。奇怪的是，这还会导致 Frames 缓存使用新的 XAML 进行更新。

这种缓存在应用程序重新启动时仍然存在，我的开发过程是，对 XML 进行更改，导航到 IE 中的 URI，然后在客户端应用程序中导航。这很烦人，而且当它上线时我不能有这种行为。

当我在页面中导航时，我通过将 URI 分配给 Frame 的 Source 属性来做到这一点，如下所示：

```
instance.Frame.Source = new Uri(instance.WizardUri, instance.PageUri); 
```

关于可能导致这种情况的任何想法？

# mysql - Mysql子查询返回数组

> ID：13278849
> 
> 赞同：0
> 
> 时间：2012-11-07T21:49:22.070
> 
> 标签：mysql, subquery

我需要有关 MySQL 中以下子查询的帮助

```
 SELECT ... # Main query 
...      
... IN # Start of subquery that expects to return an array of a.id 
(SELECT a.id, a.multipler 
FROM a 
JOIN b ON a.id = b.id
GROUP BY(a.id)
HAVING COUNT(b.id) * a.multipler < 5) 
```

我想要实现的是对表 b (b.id) 中存在的所有 a.id 进行分组。我想计算结果并为每个 a.id 使用一个唯一的乘法器（a.multipler）进行乘法运算。

这里的问题是我希望这是一个子查询：因此我不能有 2 个结果。不过，为了使用“HAVING”，我需要在结果集中包含每个变量。

我只想要/需要没有“a.multipler”的“a.id”作为结果。有什么想法可以解决这个问题吗？

示例代码：

```
#table a
+------+-------------+
| a_id | a_multipler |  
+------+-------------+
|    1 | 2.000       |
|    2 | 0.560       |
|    3 | 1.000       |
|    4 | 1.200       |
|    5 | 2.000       | 
+----- +-------------+
#table b
+------+
| b_id | 
+------+
|    1 |
|    1 | 
|    1 |
|    4 | 
|    4 |
|    3 | 
+------+

# a.id 1: occurance in "table b": 3 x 2.000 ("a.id"==1 "a.multipler"). Fails, result >= 5

#a.id 2: Fails, no occurance of a.id in "table b".

#a.id 3: 1 x 1.000\. Result < 5 OK

# and so on... "id" in "table a" (but not in "table b") is unique, 
# also a "id" in "table b" have to exist in "table a". 
```

给定上述查询 (a.id) 的想要的结果：4,3
不想要的结果：

(a.id): 4,3

(a.multipler): 1.200, 1.000

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-08T20:37:49.497

然后，将您的子查询包装在另一个`SELECT`只选择您需要的列的地方：

```
SELECT ... # Main query 
...      
... IN
(SELECT pairs.id FROM               # <===          
    (SELECT a.id, a.multipler 
     FROM a 
     JOIN b ON a.id = b.id
     GROUP BY(a.id)
     HAVING COUNT(b.id) * a.multipler < 5) pairs) 
```

任何（子）查询都会产生一个可以进一步操作的临时表，在这种情况下，只需选择它列的子集即可。

# ios - AdMob 中介 iOS：展示的是 iAd 还是 AdMob 广告？

> ID：13278850
> 
> 赞同：1
> 
> 时间：2012-11-07T21:49:25.203
> 
> 标签：ios, admob, iad

是否有一种程序化方式来判断 AdMob 中介是展示 iAd 还是 AdMob 广告？

我的 GADBannerView 的父视图必须根据正在展示的广告做一些特别的事情......

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-08T18:33:46.517

您可以检查该`mediatedAdView`属性`GADBannerView`，看看它是否是 type `AdBannerView`。

# maven - 分析 Maven 构建和性能提示

> ID：13278852
> 
> 赞同：0
> 
> 时间：2012-11-07T21:49:29.000
> 
> 标签：maven, build, maven-3

我有一个运行大约一个小时 10 分钟的 Maven 构建。这是一个巨大的产品。我试图通过分析构建来了解需要这么多时间的原因，然后开始了解从那里改变什么。

我对如何描述它有点迷茫。我尝试使用 Jprofiler，但问题是我无法将它连接到 maven 构建 JVM 并且无法获得任何结果。

任何提示表示赞赏！

（查看了关于 stackoverflow 的最流行的类似问题，但除了建议 Jprofiler 不起作用之外，没有任何实际帮助）。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-19T22:13:10.980

将这些参数添加到您的 Maven 构建中

```
-Dcom.sun.management.jmxremote -Dcom.sun.management.jmxremote.ssl=false -Dcom.sun.management.jmxremote.authenticate=false -Dcom.sun.management.jmxremote.port=1099 
```

然后运行

`java/bin/jvisualvm`

正在运行的构建必须出现在要分析的可能 JVM 列表中。

# ruby-on-rails-3 - 使用rails对postgres“DISTINCT ON”应用不同的顺序

> ID：13278856
> 
> 赞同：19
> 
> 时间：2012-11-07T21:49:48.383
> 
> 标签：ruby-on-rails-3, activerecord, sql-order-by, distinct-on

我有一个 Rails 应用程序：

`user has_many :projects`

`user has_many :tasks, :through => :projects`

`project has_many :tasks`

每个任务都有一个里程碑日期。

要显示包含下一个里程碑日期的项目详细信息表，我正在使用：

```
@projects = current_user.tasks.joins(:project).select("distinct on (projects.id) projects.*, tasks.*").reorder("projects.id, tasks.milestone ASC") 
```

这工作正常。

我现在希望能够对表格列进行排序。

根据 Postgres`DISTINCT ON`不可排序，您必须将其包装在另一个选择语句中，即`SELECT * FROM (SELECT DISTINCT ON....) ORDER BY column_3`

我确实认为被排序的列可以根据需要在 SQL 中工作，即（按项目名称 DESC 排序）：

```
@projects = current_user.tasks.joins(:project).select("distinct on (projects.name) projects.*, tasks.*").reorder("projects.name DESC, tasks.milestone ASC") 
```

这可行，但我也希望能够按里程碑订购，但那样行不通。

有人能告诉我如何转换我的 rails 查询，以便它可以按任何列排序吗？

更新

* * *

**我想我的问题只是如何将 activerecord 查询包装在环境中`SELECT`和`ORDER BY`？**

我想我已经设法使用：

```
inner_query = current_user.tasks.select("distinct on (projects.id) projects.*, tasks.*").reorder("projects.id, tasks.milestone ASC").to_sql
@projects = Task.paginate_by_sql("select * from (#{inner_query}) as user_projects order by user_projects.name", :page => params[:page]) 
```

这是最好的方法还是有人能想到更好的方法？- find/paginate_by_sql 似乎是一种解决方法，我更愿意留在 activerecord 查询的范围内。

谢谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-06-25T17:59:00.673

您正在尝试获得一组项目，但您从`current_user.tasks`.

为什么不从`current_user.projects`保证不同项目的 开始？

```
@projects = current_user.projects.includes(:tasks).order("projects.name, tasks.milestone") 
```

**替代答案**

```
@projects = current_user.projects.joins(:tasks).select('projects.*, min(tasks.milestone) as next_milestone').order('projects.name').group('projects.id')
@projects.each{|p| puts "#{p.name} #{p.next_milestone}"} 
```

这将为每个项目提供一行，计算出的最小 tasks.milestone 值，可通过 next_milestone 在项目行结果中访问。没有额外的任务记录，只是下一个里程碑日期。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-07-03T21:11:52.427

在用户控制器中：

```
inner_query = current_user.tasks.next.to_sql
@projects = Task.paginate_by_sql("select * from (#{inner_query}) as user_projects order by user_projects.#{sort_column} #{sort_direction}", :page => params[:page]) 
```

在任务模型中：

```
scope :next, select("distinct on (projects.id) projects.*, tasks.*").reorder("projects.id, tasks.milestone ASC") 
```

这种方式利用 postgres 的强大功能仅返回必要的记录，从而使记录集更小更易于使用，但代价是 RoR 代码看起来不像 Carlos Drew 的建议那样吸引人或可读。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2018-02-13T04:45:49.203

要回答这个问题：

> 我想我的问题只是如何将 activerecord 查询包装在周围的 SELECT 和 ORDER B 中

由于 ActiveRecord 4.0.2 现在有`<model>.from`.

使用您的模型的示例：

```
inner_query = Project.joins(:tasks).select("DISTINCT ON (projects.id), *") // SELECT DISTINCT ON (projects.id) FROM projects INNER JOIN tasks ON tasks.project_id = projects.id; 
```

您可以将其包装在`from`：

```
sorted_query = Project.from(inner_query, :projects).order(:name) 
```

# html - 我的 div 不向左浮动

> ID：13278857
> 
> 赞同：0
> 
> 时间：2012-11-07T21:49:49.167
> 
> 标签：html, css

我有一个问题可能在这里被问了无数次。我正在创建一个幻灯片，因此希望我的 div 并排堆叠。

这是语义结构：

```
<section class = "slideshow">
   <div class = "slides">
       <div class = "slideholder>
          <div id = "slide_1" class = "slide">  
          </div>
        </div>
       <div class = "slideholder >
          <div id = "slide_2" class = "slide">  
          </div>
       </div>
       <div class = "slideholder>
          <div id = "slide_3" class = "slide">  
          </div>
       </div>
   </div>
</section> 
```

相应的 CSS 如下所示：

```
.slides{
position:relative;
margin:2% auto;
width:80%;
max-height:300px;
}

.slideshow{
position:relative;
margin:100px auto;
width:100%;
min-height:80%;
border:1px solid #ccc;
}

.slideholder{
width:100%;
min-height:300px;
position:relative;
}

.slide{
 position:absolute;
 width:100%;
 text-align:center;
}

.slide div{
 min-height:300px;
} 
```

你可能会问为什么幻灯片 div 的样式与幻灯片分开。好吧，类幻灯片里面有几个以特定方式设置样式的 div。min-height 仅捕获其中一个特征，其余的是动画，因此可能对这个问题的上下文没有任何重要性。

我将 float:left 样式放在 .slide div 和 .slides div 中。我有点困惑，为什么它仍然垂直渲染为块元素，而不是像我希望的那样水平渲染。谁能教我钓鱼？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-07T23:33:33.790

尝试使用绝对定位并将左侧设置为减去任何有效（足以使图像消失）

```
.slides {
position:absolute;
left:-400px;
} 
```

类似的东西

# jquery - jquery的ready事件下不显示alert

> ID：13278859
> 
> 赞同：0
> 
> 时间：2012-11-07T21:49:54.237
> 
> 标签：jquery

我正在测试 JQuery，并且我在本地计算机（可以访问 Internet）中有此代码，但没有显示警报。我错过了一些明显的东西吗？

```
<html>
    <head>
    </head>
    <body >
       <script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.8.0/jquery.min.js" />
        <script type="text/javascript" > 
            $(document).ready(function(){
                alert("ready");
            });
        </script>
        <div id="message">Hello</div>
    </body>
</html> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-07T21:53:21.763

您应该关闭脚本标签，使用`</script>`not `<script ... />`。

```
<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.8.0/jquery.min.js"></script> 
```

# .net - 使用 .NET XmlDocument 类时如何保留 XML 字符类？

> ID：13278861
> 
> 赞同：0
> 
> 时间：2012-11-07T21:49:59.430
> 
> 标签：.net, xml

我正在将包含一些 html 的字符串加载到 XmlDocument 类中，以便对其进行一些操作，然后再将其转换回字符串。

以下代码演示了我在做什么；

```
 // Example of the HTML I am working with
    var documentTypeDeclaration = "<!DOCTYPE html PUBLIC \"-//W3C//DTD XHTML 1.0 Transitional//EN\" \"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd\">";
    var html = documentTypeDeclaration + "<html><body><div>&#163;300&#160;&#169;</div></body></html>";

    // Load the HTML into an XmlDocument
    var xmlDocument = new XmlDocument();
    xmlDocument.XmlResolver = null;
    xmlDocument.LoadXml(html);

    // Manipulate the HTML...

    // Get the HTML back out
    var savedHtml = xmlDocument.OuterXml;
    Console.WriteLine(html);
    Console.WriteLine(savedHtml); 
```

我希望输出到控制台的两行输出匹配，但我得到了这个-

```
 <!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html><body><div>&#163;300&#160;&#169;</div></body></html>
    <!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"[]><html><body><div>£300 ©</div></body></html> 
```

所以看起来 [] 已添加到 doc 类型声明中，并且所有 HTML 字符类都已转换为它们的实际字符。这尤其令人讨厌，因为 HTML 现在不再符合标准。

有谁知道我怎样才能阻止 XmlDocument 类这样做？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-07T22:05:49.153

> 有谁知道我怎样才能阻止 XmlDocument 类这样做？

不，但我会使用[真正的 html 解析器](http://htmlagilitypack.codeplex.com/)而不是 XmlParser

```
HtmlAgilityPack.HtmlDocument doc = new HtmlAgilityPack.HtmlDocument();
doc.LoadHtml(html);

 // Manipulate the HTML...

StringWriter wr = new StringWriter();
doc.Save(wr);
string html2 = wr.ToString(); 
```

# python - 比较 Python 代码的等价性

> ID：13278864
> 
> 赞同：9
> 
> 时间：2012-11-07T21:50:13.050
> 
> 标签：python

是否有可靠、自动的方法（例如命令行实用程序）来检查两个 Python 文件是否是**等效**的模空格、分号、反斜杠延续、注释等？换句话说，它们与解释器相同吗？

例如，这个：

```
import sys
sys.stdout.write('foo\n')
sys.stdout.write('bar\n') 
```

应该被认为等同于：

```
import   sys
sys.stdout.\
    write('foo\n'); sys.stdout.\
    write(

    'bar\n') # This is an unnecessary comment 
```

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-11-07T22:12:34.027

使用[`ast`](http://docs.python.org/2/library/ast.html)模块。

示例（对于 Python 2）：

```
import ast

x = r'''import sys
sys.stdout.write('foo\n')
sys.stdout.write('bar\n')'''

y = r'''import   sys
sys.stdout.\
    write('foo\n'); sys.stdout.\
    write(

    'bar\n') # This is an unnecessary comment'''

xd = ast.dump(ast.parse(x))
yd = ast.dump(ast.parse(y))
print xd == yd 
```

您当然可以从实际文件而不是字符串文字中读取源代码。

*编辑：*

为了使评论有意义，我想指出我最初建议使用内置[`compile()`](http://docs.python.org/2/library/functions.html#compile)函数。但是，@Jian 发现了一个处理不好的简单案例。正如@DSM 所建议的那样，也许可以对其进行调整，但随后解决方案变得不那么整洁了。也许不是不合理，但如果`ast`解析和转储工作得一样好或更好，这是更直接的方法。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-11-07T22:18:33.070

使用 python 的[解析器](http://docs.python.org/2/library/parser.html)：

```
In [1]: import parser

In [2]: with open('file1.py', 'r') as f1:
    st1 = parser.suite(f1.read())

In [3]: with open('file2.py', 'r') as f2:
    st2 = parser.suite(f2.read())

In [4]: st1.compile() == st2.compile()
Out[4]: True 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-11-07T21:53:37.913

Python 包含自己的解析器。将其应用于两个文件，然后检查结果在结构上是否相同。

# wcf - 在 appharbor 上部署 web 服务时出错

> ID：13278870
> 
> 赞同：0
> 
> 时间：2012-11-07T21:50:35.997
> 
> 标签：wcf, web-services, appharbor

我正在通过 git 在应用程序港口部署一个 web 服务，它的 url 是[http://inmaps.apphb.com/Service1.svc](http://inmaps.apphb.com/Service1.svc)

它说我可以使用另一个 url 将服务描述作为单个文件访问：ip-0a7a164f:14460/Service1.svc?singleWsdl 但这个给我一个 404 错误。

我尝试将此服务添加为对 proyect 的引用，它也会引发 404 错误。

我能做些什么？

提前致谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-08T01:26:49.987

这是由 AppHarbor 路由设置引起的已知问题。安装[这个 NuGet 包](http://nuget.org/packages/Premotion.AspNet.AppHarbor.Integration)应该可以解决问题。

这里还有其他详细信息：

*   [http://support.appharbor.com/kb/getting-started/information-about-our-load-balancer](http://support.appharbor.com/kb/getting-started/information-about-our-load-balancer)
*   [http://support.appharbor.com/discussions/problems/3878-appharbor-does-not-handle-web-service-discovery-correctly](http://support.appharbor.com/discussions/problems/3878-appharbor-does-not-handle-web-service-discovery-correctly)

# python - Python 导入类似于 Django 设置文件

> ID：13278872
> 
> 赞同：3
> 
> 时间：2012-11-07T21:50:41.673
> 
> 标签：python, django

我正在尝试使用 *.py 文件从我的 python 应用程序中的多个导入中获取变量并使用它们，类似于 Django 设置文件的工作方式。

示例设置文件：

```
DB_NAME = 'foo'
DB_TABLE = 'bar'
#Lots of other variable names and values here 
```

好处是我可以通过这种方式快速加载不同的设置。我可以在任何我想要的地方引用一种全局“DB_NAME”，而无需处理特定的对象。

缺点是我必须更改每个必须导入它们的文件中的导入语句。

我可以设置它以便我导入文件一次然后引用通用导入来获取所有这些值吗？

还是有更好的方法来做到这一点？

任何帮助表示赞赏。

编辑：问题源于有多个设置文件。我必须为一个文件导入 settings.py，或者如果我想要一个不同的设置文件，我需要更改所有导入语句以引用 test_settings.py 等。

我不想手动更改导入位置以更改在整个应用程序中导入的内容。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-07T22:18:37.950

在文件夹中创建我们自己的 config.py 文件

```
settings = {}
settings['server'] = '172.16.150.106:1433'
settings['user'] = 'pyadmin'
settings['password'] = 'admin'
settings['db'] = 'SQLSERV_2005' 
```

打开外壳（ipython）

```
In [1]: from config import settings

In [2]: print settings
{'password': 'admin', 'db': 'SQLSERV_2005', 'user': 'pyadmin', 'server': '172.16.150.106:1433'} 
```

不要忘记你的 __init__.py 文件！

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-07T22:28:30.327

您可以使用模块`__builtin__`：

文件 a.py：

```
#!/usr/bin/env python
import __builtin__
import b

if __name__ == "__main__":
    import conf
    __builtin__.__dict__["CONF"] = conf

    print "IN A: %s" % CONF.VAR

    b.test_conf() 
```

文件 b.py：

```
def test_conf():
   print "IN B: %s" % CONF.VAR 
```

文件conf.py：

VAR = "VAL"

所以基本上你需要在内置字典中设置一个元素，然后在任何其他加载的模块中按名称访问它。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-07T22:18:24.267

本质上，您希望拥有一个全局可用的模块。

有几种方法可以做到这一点，如[Python 模块搜索路径文档](http://docs.python.org/2/tutorial/modules.html#the-module-search-path)中所述。本质上，如果您可以将全局模块放在您的`sys.path`搜索路径下，您就可以在您的用户环境中机器上的任何位置访问它。（请注意，您也可以为 wsgi 服务器添加模块到 sys.path。）

我通过我的`.bashrc`文件将一些模块添加到我的 PYTHONPATH 环境变量中；例如：

```
PYTHONPATH=~/projects/pyutil/:$PYTHONPATH 
```

您还可以在导入模块之前添加到任何 python 程序的搜索路径，方法是`sys.path`在导入发生之前添加。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-11-07T22:44:14.253

> 问题源于有多个设置文件

如果您希望能够为多个模块起别名，有几个解决方案：

```
try: 
    import test_settings as settings
except ImportError:
    import default_settings as settings 
```

请注意，您不必使用模块的存在/不存在，您可以使用任何您喜欢的流控制来选择正确的`import`语句。

此外，如建议的那样，`PYTHONPATH`可以/应该用于针对不同的设置：

```
 # code just does "import settings" and there's a settings.py in each /opt/{test,default}_settings
   PYTHONPATH=/opt/test_settings ./my_app
   PYTHONPATH=/opt/default_settings ./my_app 
```

最后，考虑`distutils`使它成为一个真正可重现的解决方案——将不同的设置分发为提供相同包名称的不同发行版。

# ruby-on-rails - 使用 Best In Place gem，我如何允许就地编辑链接？

> ID：13278878
> 
> 赞同：3
> 
> 时间：2012-11-07T21:50:55.410
> 
> 标签：ruby-on-rails, gem, best-in-place

我有一个名为“item”的对象，它有一个可以链接到任何 URL 的“title”。我使用以下代码允许使用 Best in Place gem 就地编辑标题。编辑部分工作正常，但是当从输入框中移除焦点时，链接丢失。

```
 <%= best_in_place item, :title, 
                              :display_with => :link_to, 
                              :activator => "#edit-#{item.id}",
                              :helper_options => item.url  %> 
```

我感觉我没有正确设置“helper_options”的值。

如何编辑上面的代码，以便在用户更改标题后使用更新的文本恢复链接？[我在Best in Place github 站点](https://github.com/bernat/best_in_place)或其他任何地方都找不到这样的例子。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-03-25T21:55:50.697

迟到的答案，但你永远不知道谁会是类似的东西？对于您的情况，我认为您需要一个块：

```
<%= link_to(item.url) do %>
   <span><%= best_in_place item, :title, 
     :activator => "#edit-#{item.id}" %>
   </span> 
<% end %> 
```

这假设您要编辑标题，而不是链接的 URL。

要编辑链接但使用标题作为链接正文，您将在 display_with 中使用 lambda

```
= best_in_place item, 
  :url, 
  :display_with => lambda { 
    |url| link_to item.title, url
  } 
```

那是haml，我没有测试确切的片段，但类似的正在我正在构建的应用程序中工作

# sql - 使用 WHERE 返回多个结果的 sql 查询

> ID：13278880
> 
> 赞同：2
> 
> 时间：2012-11-07T21:51:01.783
> 
> 标签：sql, database, postgresql, select

有一个表名`Top_Up`。它当前的快照是： ![充值表](../Images/0d2a768a16333ad000c51fb3a0edbde0.png)

当我对其运行查询`SELECT * FROM Top_Up WHERE Top_up_ID = (round(random() * 9 ) + 1);`时，我得到随机结果。有时它返回两个元组，有时没有元组，有时返回一个元组。

为了调试，我运行查询`Select (round(random() * 9 ) + 1);`，它总是在结果中只返回一个元组。

**为什么我得到这个模糊和随机的结果？**

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-07T22:01:25.673

每行计算轮次。尝试这个：

```
SELECT TOP 1 * FROM Top_Up ORDER BY (round(random() * 9 ) + 1); 
```

如果你对你的表运行测试，你应该会看到一个非常不同的结果：

```
 Select (round(random() * 9 ) + 1) FROM Top_Up ` 
```

如果你只想要一个随机记录，我会选择：

```
SELECT TOP 1 * FROM Top_Up ORDER BY NEWID() 
```

# css - 大 Facebook 分享按钮

> ID：13278881
> 
> 赞同：1
> 
> 时间：2012-11-07T21:51:16.213
> 
> 标签：css, twitter-bootstrap, facebook-like

我想知道如何实现我看到的大型 facebook 分享按钮。某处是否有教程，或者可能是 wordpress 插件？这就是我正在使用的。

这是我正在谈论[的一个例子：](http://www.upworthy.com/this-kid-wants-to-fall-in-love-with-a-woman-just-like-his-mom?c=fea)

## 普通的

![预习](../Images/9844db81359781ceb23612e1d0bdf069.png)

## 悬停状态

![参与预览](../Images/22009f9062daa7ef6473867182b9edbf.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-07T22:30:49.753

Tuts+ 有一个类似的教程。[http://net.tutsplus.com/tutorials/html-css-techniques/build-awesome-practical-css3-buttons/](http://net.tutsplus.com/tutorials/html-css-techniques/build-awesome-practical-css3-buttons/)

但基本上。这是一个 css3 渐变，在悬停时消失。为了创造双边框效果，他似乎使用了嵌套元素。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-11-07T22:27:17.297

```
<a href="http://www.facebook.com/sharer.php?s=100&p[title]=YOUR TITLE&p[url]=YOUR URL&p[images][0]=YOUR IMAGE URL" class="facebook">Share on Facebook</a> 
```

如果您想像大多数人一样在弹出窗口等中使用它，请询问。

```
.facebook{
background: url(NONE HOVER FACEBOOK BUTTON IMAGE) no-repeat;
display:block;
width: WIDTH OF IMAGE;
height: HEIGHT OF IMAGE;
text-indent: -999em;
}
.facebook:hover{
background-image: url(HOVERSTATE FACEBOOK BUTTON IMAGE);
} 
```

# javascript - 如何在按钮提交之前验证数据？

> ID：13278882
> 
> 赞同：1
> 
> 时间：2012-11-07T21:51:18.030
> 
> 标签：javascript, jquery, html

我有这个代码[jsFiddle](http://jsfiddle.net/ux5Kg/3/)。我想要完成的是以下内容。当用户单击对话框内的“确定”按钮时，我希望代码计算“field1”的日期是否在“field2”之后，这意味着当前时期在前一个时期之后（应该如此）。如果是这样，我希望操作继续，填充文本框并关闭对话框。每当这不正确时，我想提醒用户所做的选择是无效的（以前的不能在当前之后）。我对日期数学没有问题（插件 date.js 让它变得很容易），我在试图找出在哪里包含这个条件时遇到了问题。任何帮助将不胜感激，请随时更改代码并在此处发布您的结果。谢谢。

我觉得代码应该在关闭对话框之前运行，但我无法获得正确的条件来实现它，例如：

```
//code up to here handles 'if's and 'else's
var currentPeriod = $("input#field1").val()
var previousPeriod = $("input#field2").val()

 d1 = Date.parse(currentPeriod);
 d2 = Date.parse(previousPeriod); 

if((Date.compare(d1,d2))=='1')
{
  $(this).dialog("close");
 }
else
  {
   alert("Invalid date range");
 } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-08T00:06:43.583

你上面写的，使用`Date.compare()`大多是正确的。比较文档在[这里](http://code.google.com/p/datejs/wiki/APIDocumentation#compare)。

不过有两点：

*   该代码不在您放在一起的任何地方。
*   在您的小提琴中`$("input#field1")`，`#("input#field2")`将引用输入框，而不是对话框选择框。您希望在将值分配给输入框之前进行验证，否则您将关闭对话框并且这并不重要，因为已经分配了值。

它应该去的地方（基于小提琴）是在单击 OK 按钮时调用的函数的开头。现在看起来您正在处理当前日期并将值放入输入框中，然后处理前一个日期并分配值。在发生任何这种情况之前，您需要检查这些值是否在另一个之前。

# android - Android TabWidget 文本空间

> ID：13278887
> 
> 赞同：0
> 
> 时间：2012-11-07T21:51:41.707
> 
> 标签：android, tabwidget

无论如何都存在改变左右文本空间？看附带的屏幕。浪费了这么多空间。他们可以不换行

问候

![屏幕](../Images/45a7f1656bfe803ebff1059c00a5a26c.png)

```
<TabHost android:layout_width="fill_parent"
android:layout_height="fill_parent"
android:id="@+id/tabHost"
android:gravity="bottom"
xmlns:android="http://schemas.android.com/apk/res/android">    
<TabWidget
android:layout_width="fill_parent"
android:layout_height="wrap_content"
android:id="@android:id/tabs" />
<FrameLayout
android:layout_width="fill_parent"
android:layout_height="fill_parent"
android:id="@android:id/tabcontent"
android:paddingTop="60px">
<!-- First tab -->
<LinearLayout
android:layout_width="fill_parent"
android:layout_height="wrap_content"
android:id="@+id/tabStations"
android:orientation="vertical">    
</LinearLayout>
<!-- Second Tab -->
<LinearLayout
android:layout_width="fill_parent"
android:layout_height="fill_parent"
android:id="@+id/tabSuggestions"
android:orientation="vertical">
</LinearLayout>
</FrameLayout>
</TabHost> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-07T22:15:24.103

我猜是因为我看不到你的 xml 布局代码，但我怀疑你里面没有 android:layout_width="fill_parent" 。如果你这样做，然后发布你的 xml，我会考虑一下。

# c# - c# winforms - 刷新时是否调用 InitializeComponent() 函数？

> ID：13278888
> 
> 赞同：4
> 
> 时间：2012-11-07T21:51:46.710
> 
> 标签：c#, winforms, .net-4.5

我想问一下功能`InitializeComponent()`。在使组件失效后调用`Invalidate()`？

版本：.net 4.5，VS 2012

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-07T21:53:32.323

不，`InitializeComponent()`只在构造函数中调用。

也就是说，除非您决定从您的一种方法中自己调用它。

没有接口，也没有基类要求您的表单有一个名为 的方法`InitializeComponent()`，这就是 Visual Studio 的 WinForms 设计器所称的方法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-07T21:54:38.443

如果您仅在表单构造函数中调用 InitializeComponent() 方法，则在初始化表单时仅调用一次。

如果您在其他地方手动添加 InitializeComponent()，例如，在您调用 Invalidate() 之前，则可以。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-07T21:55:39.783

`"InitializeComponent"`必须在构造函数中调用一次。此函数存在的原因是将设计器代码初始化和您的实现分开。它为设计器生成的私有变量做了所有新的事情。您可以通过在其上按 F12 来查看该功能的实现。

希望能帮助到你。

干杯

# .net - 如何使用实体框架将数据添加到 SQL Server Express 数据库

> ID：13278889
> 
> 赞同：3
> 
> 时间：2012-11-07T21:51:46.553
> 
> 标签：.net, sql-server, wpf, entity-framework

我正在为我的大学编写简单的程序。我创建了一个实体框架模型，绘制图表，从模型创建数据库，在我的数据库上应用 SQL 文件，现在我正在尝试将一些项目添加到数据库中。

我是这样做的：

```
using (NewsletterEntities context = new NewsletterEntities())
{
   Sender newSender = new Sender();
   newSender.Login = Login.Text;
   newSender.Password = Password.Text;
   newSender.Port = 23;
   newSender.SMTP = SMTP.Text;
   newSender.Email = Email.Text;
   newSender.SenderID = 0;

   context.Senders.AddObject(newSender);
   context.SaveChanges();
} 
```

当我尝试执行它时，它会弹出内部异常：

> 当 IDENTITY_INSERT 设置为 OFF 时，无法在表“发件人”中插入标识列的显式值。

我试图寻找错误，但我对实体框架了解不多，也找不到任何具体的东西。

任何人都可以帮忙吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-07T21:55:18.387

该错误与 Entity Framework 无关，它与 SQL Server 有关，更具体地说[与 Identity 列](http://msdn.microsoft.com/en-us/library/ms186775.aspx)有关。

我的猜测是这`SenderID`是一个身份列。这意味着数据库负责为该字段分配顺序值，并且您不能为其指定值（除非您使用[`IDENTITY_INSERT`](http://msdn.microsoft.com/en-us/library/ms188059.aspx)，如错误消息所示）。

因此，从代码中删除该`newSender.SenderID = 0;`行应该可以解决问题。

# asp.net-mvc - 复杂的 SQL 到 LINQ 以填充网格（逐月计数项目）（MVC，EF 代码优先）

> ID：13278891
> 
> 赞同：0
> 
> 时间：2012-11-07T21:51:47.913
> 
> 标签：asp.net-mvc, linq, entity-framework, tsql

我有一个要填充以下内容的网格：

它正在跟踪去年每个月开放的门票。网格按优先级过滤，所以我有这样的东西：

```
| Mon | Critical | High | Tot |
| Jan |    5     |  2   |  7  |
| Feb |    2     |  3   |  5  | 
```

这是我的 SQL 语句：

```
SELECT
    MONTH(CreateDate),
    DATENAME(MONTH,m.CreateDate) AS 'Month',
    SUM(CASE WHEN (m.PriorityId = 1) THEN 1 ELSE 0 END) AS 'Critical',
    SUM(CASE WHEN (m.PriorityId = 2) THEN 1 ELSE 0 END) AS 'High',
    SUM(CASE WHEN (m.PriorityId = 3) THEN 1 ELSE 0 END) AS 'Normal',
    SUM(CASE WHEN (m.PriorityId = 4) THEN 1 ELSE 0 END) AS 'Low',
    SUM(CASE WHEN (m.PriorityId = 5) THEN 1 ELSE 0 END) AS 'Not Ready',
    Count(m.Id) AS Total
FROM
    [projects].[dbo].[tblMaintenanceTicket] m
INNER JOIN
    [projects].[dbo].[tblPriority] p
ON
    p.Id = m.PriorityId
WHERE
    StatusId = 1
    AND YEAR(CreateDate) = year(getdate())
GROUP BY 
    MONTH(CreateDate),
    DATENAME(MONTH,m.CreateDate)
ORDER BY
    MONTH(CreateDate) 
```

我希望在 VB LINQ 中转换它，但我不确定这是最好的方法。我也在考虑调用一个存储过程，但我真的想远离数据库。我将 MVC 3 与存储库模式一起使用，因此调用我的代码类似于 JSON 的以下输出：

```
Dim tickets = ticketRepo.GetAll().Include(Function(p) p.Priority).ToArray() 
```

有什么帮助吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-08T13:51:56.343

这是您可以执行的操作，目前假设 StatusId 在 tblMaintenanceTicket 表中。

视觉基础：

```
Module Module1

    Sub Main()

    Dim rand As New Random
    Dim list As New List(Of tblMaintenanceTicket)
    For count = 1 To 100

      Dim newTicket As New tblMaintenanceTicket

      newTicket.CreateDate = Now.AddDays(rand.Next(0, 365) * -1)
      newTicket.PriorityId = rand.Next(1, 6)
      newTicket.StatusId = 1

      list.Add(newTicket)

    Next

    Dim results = From ticket In list _
                  Where ticket.StatusId = 1 And ticket.CreateDate.Year = Now.Year _
                  Group ticket By ticket.CreateDate.Month Into Group _
                  Select New TicketResults With { _
                    .Month = Month,
                    .Critical = Group.Count(Function(t) t.PriorityId = 1),
                    .High = Group.Count(Function(t) t.PriorityId = 2),
                    .Normal = Group.Count(Function(t) t.PriorityId = 3),
                    .Low = Group.Count(Function(t) t.PriorityId = 4),
                    .NotReady = Group.Count(Function(t) t.PriorityId = 5)
                  }

    End Sub

  Public Class tblMaintenanceTicket

    Public CreateDate As Date
    Public PriorityId As Integer
    Public StatusId As Integer

  End Class

  Public Class TicketResults

    Public Month As Integer
    Public Critical As Integer
    Public High As Integer
    Public Normal As Integer
    Public Low As Integer
    Public NotReady As Integer

  End Class

End Module 
```

C＃：

```
 class Program
  {
    static void Main(string[] args)
    {
      //Generate some random data
      var list = new List<tblMaintenanceTicket>();    
      var rand = new Random();    
      for (var count = 0; count < 100; ++count)
      {
        var newTicket = new tblMaintenanceTicket();

        newTicket.CreateDate = DateTime.Now.AddDays(rand.Next(0, 365)* -1);
        newTicket.PriorityId = rand.Next(1, 6);
        newTicket.StatusId = 1;

        list.Add(newTicket);
      }

      var results = from ticket in list
                    where ticket.StatusId == 1 && ticket.CreateDate.Year == DateTime.UtcNow.Year
                    group ticket by ticket.CreateDate.Month into months
                    select new TicketResults
                    {
                      Month = months.Key,
                      Critical = months.Count(m => m.PriorityId == 1),
                      High = months.Count(m => m.PriorityId == 2),
                      Normal = months.Count(m => m.PriorityId == 3),
                      Low = months.Count(m => m.PriorityId == 4),
                      NotReady = months.Count(m => m.PriorityId == 5)
                    };

      System.Diagnostics.Debugger.Break();
    }
  }

  public class TicketResults
  {
    public int Month { get; set; }
    public int Critical { get; set; }
    public int High { get; set; }
    public int Normal { get; set; }
    public int Low { get; set; }
    public int NotReady { get; set; }
  }

  public class tblMaintenanceTicket
  {
    public DateTime CreateDate { get; set; }
    public int PriorityId { get; set; }
    public int StatusId { get; set; }
  } 
```

# hadoop - 通过 REST API 向外部提交应用程序

> ID：13278893
> 
> 赞同：3
> 
> 时间：2012-11-07T21:51:55.493
> 
> 标签：hadoop, mapreduce, hadoop-yarn

目前有没有办法通过为 MapReduceV1 和/或 YARN 提供的 REST API 向外部提交应用程序？我希望在不添加自定义服务的情况下找到一种方法。

到目前为止，我只弄清楚了如何使用 YARN`GET`从[ResourceManager获取应用程序状态。](http://hadoop.apache.org/docs/r2.0.2-alpha/hadoop-yarn/hadoop-yarn-site/ResourceManagerRest.html#Cluster_Application_API)

也许我看错了，有更好的方法在外部做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-11T19:28:41.550

所以在做了一些研究之后，我决定[Oozie Workflow Scheduler](http://oozie.apache.org/)是要走的路。

这是一个示例工作流，可以提交到在 Hadoop 系统内运行的 REST 端点以启动 MapReduce 作业。 `<action>`s 不限于 MapReduce。

```
<workflow-app xmlns='uri:oozie:workflow:0.1' name='map-reduce-wf'>
    <start to='hadoop1' />
    <action name='hadoop1'>
        <map-reduce>
            <job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
            <configuration>
                <property>
                    <name>mapred.mapper.class</name>
                    <value>org.apache.oozie.example.SampleMapper</value>
                </property>
                <property>
                    <name>mapred.reducer.class</name>
                    <value>org.apache.oozie.example.SampleReducer</value>
                </property>
                <property>
                    <name>mapred.map.tasks</name>
                    <value>1</value>
                </property>
                <property>
                    <name>mapred.input.dir</name>
                    <value>input-data</value>
                </property>
                <property>
                    <name>mapred.output.dir</name>
                    <value>output-map-reduce</value>
                </property>
                <property>
                  <name>mapred.job.queue.name</name>
                  <value>unfunded</value>
                </property>
            </configuration>
        </map-reduce>
        <ok to="end" />
        <error to="fail" />
    </action>
    <kill name="fail">
        <message>Map/Reduce failed, error message[${wf:errorMessage(wf:lastErrorNode())}]</message>
    </kill>
    <end name='end' />
</workflow-app> 
```

*样本取自[https://github.com/yahoo/oozie/wiki/Oozie-WF-use-cases](https://github.com/yahoo/oozie/wiki/Oozie-WF-use-cases)*

# java - 反射调用跳过其余代码

> ID：13278894
> 
> 赞同：0
> 
> 时间：2012-11-07T21:51:59.867
> 
> 标签：java, reflection

我无法弄清楚我做错了什么。我有两种方法，这一种有效：

```
protected void applySelection(String adjustment, String action){
    if(!adjustment.equals("") || !action.equals("")){
        try{
            ClassLoader myClassLoader = this.getClass().getClassLoader();
            String myPackage = this.getClass().getPackage().getName();
            String classNameToBeLoaded = myPackage + "." + action + "." + adjustment;
            Class adjust = myClassLoader.loadClass(classNameToBeLoaded);
            Object whatInstance = adjust.newInstance();
            adjust.getMethod("setBitmap", new Class[]{Bitmap.class}).invoke(whatInstance, new Object[]{this.stage.getImage()});
            Bitmap bmp = (Bitmap)adjust.getMethod("applyFilter").invoke(whatInstance);
            if(bmp != null){
                Edit.this.stage.setStageImage(bmp);
                Edit.this.stage.showTopItems(bmp);
            }
        }catch(IllegalArgumentException e){
        }catch(IllegalAccessException e){
        }catch(InvocationTargetException e){
        }catch(Exception e){}
    }
} 
```

然后这个不起作用：

```
protected void setFromSlider(String adjustment, String action){
    if(!adjustment.equals("") || !action.equals("")){
        try{
            ClassLoader myClassLoader = this.getClass().getClassLoader();
            String myPackage = this.getClass().getPackage().getName();
            String classNameToBeLoaded = myPackage + "." + action + "." + adjustment;
            Class adjust = myClassLoader.loadClass(classNameToBeLoaded);
            Object whatInstance = adjust.newInstance();
            Object returnVal = adjust.getMethod("isSeekBar").invoke(whatInstance);
            if(returnVal == true){
                // Do something
            }else{
                // Do something else
            }
        }catch(NullPointerException e){
            e.getMessage();
        }catch(IllegalArgumentException e){
            e.getMessage();
        }catch(IllegalAccessException e){
            e.getMessage();
        }catch(Exception e){
            e.getMessage();
        }
    }
} 
```

在这条线上（在第二种方法中）：
`Object returnVal = adjust.getMethod("isSeekBar").invoke(whatInstance);`

当它到达这里时，它只是跳过我的 if 语句并直接转到方法的右括号。是什么原因造成的？这是被调用的方法：

```
public boolean isSeekBar(){
    return true;
} 
```

我假设它正在抛出一个错误，但没有一个 catch 语句正在捕获一个错误。我现在被难住了……

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-07T21:55:20.423

您可以尝试捕获更通用的[Throwable](http://docs.oracle.com/javase/6/docs/api/java/lang/Throwable.html) - 如果此函数在 UI 线程中执行，您将看不到异常。

```
try{
     ...
}catch(Throwable e){
   // e.getMessage(); this would not print anything
   e.printStackTrace();
} 
```

在任何情况下，`if(returnVal == true){`都不会编译（不兼容的操作数类型 Object 和 boolean）

利用`if (returnVal.equals(true)) {`

# matlab - 在matlab中初始化具有特定值的矩阵

> ID：13278896
> 
> 赞同：0
> 
> 时间：2012-11-07T21:52:12.387
> 
> 标签：matlab, matrix, initialization

我有这个大小为 100x100 的矩阵 A。现在我有另一个向量 Z=(1,24,5,80...) 它有 100 个元素。它是一个包含 100 个元素的列向量。现在对于矩阵 A 的每一行，我希望它的 A(i,j) 元素为 1，其中 i 是 1:100 的行，j 是 Z 给出的列

所以应该是1的元素应该是1,1 2,24 3,5 4,80等等

我知道我可以使用循环来做到这一点。但是有没有一种直接简单的方法，我的意思是一个班轮？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-07T22:21:05.200

总共有 10000 个非零元素（因此只有 1% 非零）的矩阵最好存储为稀疏矩阵。使用matlab的能力。

```
A = sparse(1:100,Z,1,100,100); 
```

这是一个很好的、干净的单线性，它产生的矩阵将比完整矩阵更有效地存储。它仍然可以用于矩阵乘法，而且效率也会更高。例如...

```
Z = randperm(100);
A = sparse(1:100,Z,1,100,100);

whos A

  Name        Size             Bytes  Class     Attributes
  A         100x100             2408  double    sparse 
```

这几乎是 40 到 1 的内存减少。而且，虽然矩阵实际上相当小，但将其用作稀疏矩阵仍然更快。

```
B = rand(100);
timeit(@() B*A)
ans =
   4.5717e-05

Af = full(A);
timeit(@() B*Af)
ans =
   7.4452e-05 
```

如果 A 为 1000x1000，则节省的费用会更加显着。

如果您的目标是完整矩阵，则可以使用 full 将其转换为完整矩阵，或者 accumarray 是一个选项。如果要将值插入现有数组，请使用 sub2ind。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-07T22:07:04.223

一种方法是在using中将值转换`Z`为绝对索引，然后使用向量索引：`A`[`sub2ind`](http://www.mathworks.com/help/matlab/ref/sub2ind.html)

```
idx = sub2ind(size(A), 1:numel(Z), Z);
A(idx) = 1; 
```

或简单地说：

```
A(sub2ind(size(A), 1:numel(Z), Z)) = 1; 
```

# javascript - 为什么 .load 在 IE8 中不起作用

> ID：13278897
> 
> 赞同：0
> 
> 时间：2012-11-07T21:52:15.353
> 
> 标签：javascript, ajax, jquery, internet-explorer-8

我有这个代码，

```
 $(".delete").live("click", function () {
    alert("!");
    var self = $(this);
    var loadUrl = $(this).attr('href');
    var interestParents = self.parents('div:eq(4)').attr("id");
    $.ajax({
        type: "POST",
        url: loadUrl,
        data: "isAjax=1"
    }).done(function (msg) {
        self.parent().parent().parent().parent().parent().fadeOut('fast', function () {
            $(this).remove();
        });
        //console.log($("#"+interestParents).load(site_url+"my_profile/interests " + "#" + interestParents).fadeIn('fast'));
        //$("#UL_" + msg + "items").load(site_url + "my_profile/interests " + "#UL_" + msg + "items").fadeIn('fast');
        $("#large_buttons").load(site_url + "my_profile #large_buttons > *").show();

    });
    return false;
}); 
```

而且我一生都无法弄清楚为什么`.load`不将数据加载到 large_buttons div 中，它肯定存在于页面上，并且它可以在除 IE8 之外的所有其他浏览器中使用。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-08T10:37:45.580

你试过这样吗：

```
$("#large_buttons").show().load(site_url + "my_profile #large_buttons > *"); 
```

虽然我无法看到 site_url 变量在哪里，但如果这是一种类型，那么你应该使用它

```
$("#large_buttons").show().load(loadUrl + "my_profile #large_buttons > *"); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-08T01:34:47.870

检查以确保您正在“加载”的页面 (my_profile) 是有效的 HTML（没有放错位置的结束标签、未闭合的标签等）。我在使用 IE8 时遇到了这样的问题，因为我尝试加载的标记无效。大多数浏览器都设法解释了错误的标记，但 IE8 失败了。

HTML[验证器](http://validator.w3.org/)可能会对您有所帮助。

# html - 如何允许 g-wan 提供预先格式化的文本？

> ID：13278900
> 
> 赞同：3
> 
> 时间：2012-11-07T21:52:21.190
> 
> 标签：html, minify, g-wan

默认情况下，G-WAN 会从`HTML`文件中去除空格以最小化文件。`<pre>`允许标签定义的预格式化文本通过的最佳方法是什么？

@Richard Heath 有趣——我正在使用 G-Wan 的香草安装，`<pre>`块开始是这样的`<pre class="fragment">`。请参阅 doxygen 生成的文档示例

这是托管在 g-wan 的香草安装上。

更新：作为临时（非干净/快速修复）解决方法，我已将启动更改为如下所示： `START=""`
...
`nohup ./$NAME $START &>/dev/null &`

稍后我将尝试编写一个处理程序来过滤返回。

**更新**了用于比较的示例文件
`./gwan -d`
[http://alex4u2nv.com/test/test.html](http://alex4u2nv.com/test/test.html)
`nohup ./gwan &> /dev/null &`
[http://alex4u2nv.com/docs/test.html](http://alex4u2nv.com/docs/test.html)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-08T15:42:15.030

如果您查看[显示预格式化源代码和文本的此链接，](http://gwan.com/en_bench.html)那么很明显 G-WAN v3.3 尊重`<pre>`标签，即使在守护程序模式下运行也是如此。

如果您有一个损坏页面的示例，则发布损坏的文本而不是如此巨大的 HTML 页面。

此外，在您提供的链接中，文本没有损坏，但有一个客户端脚本阻止了 Internet 浏览器（必须停止 Javascript 才能看到整个页面）。

# django - 使用多对多字段进行 Django 查询优化

> ID：13278901
> 
> 赞同：1
> 
> 时间：2012-11-07T21:52:23.707
> 
> 标签：django

我发现我的模板中的这一段代码（粗体）产生了大约 250 个查询并且让事情变得非常慢：

```
{% for part in latestupdates %}
{{ part }}
      **{% for unipart in part.uniparts.all|slice:":5" %}**
      <tr>
        <td>
            <p style ="font-size:12px;"><a href = "/spices/{{ unipart_id }}/view_part">{{ unipart.part }}</a></p></td>
        <td><img src="{{ STATIC_URL }}images/company_logos/thumbs/{{part.model.all.0.manufacturer}}.jpg" alt="{{part.model.all.0.manufacturer}} {{unipart.part}}" height="24" width='115' /></td>
      </tr>
      {% endfor %}
{% endfor %} 
```

Unipart与Part的关系如下：

```
class UniPart (models.Model):
    model = models.ManyToManyField (Part, related_name = 'uniparts') 
```

我的看法如下：

`latestupdates = Part.objects.all().order_by('-added')`

基本上我想要的是获得 5 个链接到 Part 的 Unipart 对象。但这花费了我很多时间！！！有什么比我做的更有效的方法？我实际上有超过 600 个数据库查询，这非常可悲，我正在阅读数据库优化，但对于这一点，我找不到任何相关的东西。帮助！:-)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-07T23:31:00.923

试试[prefetch_related()](https://docs.djangoproject.com/en/dev/ref/models/querysets/#django.db.models.query.QuerySet.prefetch_related) QuerySet 的方法。

```
latestparts = Part.objects.all().prefetch_related('uniparts').order_by('-added') 
```

但请注意您尝试预取的项目数量。因为它会淹没你的记忆。

是的，这仅在`django 1.4`我认为有效。

如果您有字段（不是您的情况），请使用[select_related( )。](https://docs.djangoproject.com/en/dev/ref/models/querysets/#django.db.models.query.QuerySet.select_related)`models.ForeignKey`这适用于旧版本的 django。

# java - 从 paintComponent 方法调整大小

> ID：13278902
> 
> 赞同：2
> 
> 时间：2012-11-07T21:52:23.993
> 
> 标签：java, swing, jpanel, paintcomponent, preferredsize

我有这个小代码

```
public class Test extends JFrame {

public static void main(String[] args) {
    new Test();
}

Test() {
    getContentPane().add(new MyPanel());

    pack();
    setVisible(true);
}

private class MyPanel extends JPanel {

    @Override
    protected void paintComponent(Graphics g) {
        setSize(640, 480);
        setPreferredSize(new Dimension(640, 480));
        setMinimumSize(new Dimension(640, 480));
        g.fillRect(20, 20, 50, 50);
    }

} 
```

不幸**的是**，在调用`pack()`. 我已经阅读了该主题的相关答案，但没有一个有帮助。请给我一个解决方案好吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-07T21:59:13.470

执行时`pack()`，面板仍然不可见，并且`paintComponent()`未执行，因此也未执行`setPreferredSize()`。

但不要`setPreferredSize`从`paintComponent()`. 只做你的画`paintComponent`。避免将程序逻辑放入该方法中。绘画操作应该是快速和优化的，以获得更好的性能和用户体验。有关详细信息，请参阅[执行自定义绘画。](http://docs.oracle.com/javase/tutorial/uiswing/painting/)

覆盖面板的`getPrefferedSize()`，或至少在 之前执行 setPreferedSize `pack()`。

另请参阅[是否应该避免在 Java Swing 中使用 set[Preferred|Maximum|Minimum]Size 方法](https://stackoverflow.com/q/7229226/1048330)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-07T21:59:02.743

```
 public MyPanel() {
        setPreferredSize(new Dimension(640, 480));
    } 
```

# iphone - self.navigationController pushViewController 未将控制器添加到堆栈

> ID：13278904
> 
> 赞同：4
> 
> 时间：2012-11-07T21:52:33.857
> 
> 标签：iphone, ios, ipad, uiviewcontroller

我在一个名为 vcA 的 viewController 上，我这样做：

```
[self.navigationController pushViewController:vcB animated:YES]; 
```

它有效。vcB 被推送。在 vcB 的 viewDidAppear 里面我这样做：

```
NSArray *controllers = self.navigationController.viewControllers; 
```

控制器只包含一个对象，vcA !!!! （什么？）

为什么将 vcB 添加到控制器阵列中？有什么可以防止这种情况发生吗？

谢谢。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-11-08T00:18:38.363

为了解决这个涉及在导航控制器堆栈上推送视图控制器的问题，我苦苦挣扎了一周。

问题是这样的：我在一个基于导航控制的应用程序上，我有 3 个视图控制器，vA、vB 和 vC。

我正在使用这个从 vA 推送 vB：

```
[self.navigationController pushViewController:vB animated:YES]; 
```

它起作用了，但是，当我尝试从 vB 推送 vC 时，vB 的 self.navigationController 属性为 nil 并且 vB 不在导航控制器堆栈上。什么？是的，我将 vB 推送到导航堆栈上，并且 vB 没有被添加到其中，但即便如此，vB 仍能正确显示。

我发现在 vB 的 viewDidLoad 内部，self.navigationController 不是 nil，并且 vB 在导航控制器堆栈上，但是一旦 vB 的 viewDidLoad 结束，vB 就从导航控制器堆栈中删除，并且它的 navigationController 属性设置为 nil。那时，vB 是一种幽灵控制，在导航控制器堆栈之外。

我不需要提到从 vB 中我无法回到 vA 或推动 vC。

这是怎么发生的？

简单，我是从一个块内推 vB ......类似于：

```
void (^ block1)() = ^(){

   [self.navigationController pushViewController:vB animated:YES];

}; 
```

发生了什么，因为 UIKit 函数（推送的东西）正在一个块中执行，该块可能在一个不是主线程的线程上运行。

对此的解决方案是将推送包装到主线程的调度中，使用以下方法：

```
void (^ block1)() = ^(){
dispatch_async(dispatch_get_main_queue(),
               ^{
                   [self.navigationController pushViewController:vB animated:YES];
               });

}; 
```

该应用程序还有另一个小问题，即连接到 viewController 的错误插座，但这是主要问题。这是一种很难发现的问题，因为它很微妙。当我向导航栏添加另一个按钮并且该按钮没有出现时，我发现了这个问题。所以，我怀疑涉及 UIKit 的事情正在发生，或者在这种情况下没有发生。这里最大的问题是这段代码没有崩溃，没有错误消息，什么都没有，只是工作不好，但工作正常。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-07T21:57:49.793

我相信这与您检查的时间有关。在该`pushViewController`方法期间，下一个视图控制器的 viewWillAppear: 方法（以及其他方法，例如您正在检查的方法）正在被调用。我相信在调用所有这些方法之后，在动画完成后，视图控制器会被考虑在导航堆栈上。

# .htaccess - .htaccess 重写规则从 mydomain.com/contact.htm 到 mydomain.com/contact

> ID：13278908
> 
> 赞同：-1
> 
> 时间：2012-11-07T21:52:37.680
> 
> 标签：.htaccess

我想这是一个非常常见且简单的`.htaccess`重写规则，但是我无法通过谷歌搜索它的解决方案。

那么，问题已经在标题中了，我该如何重写地址以将其更改`example.com/contact.htm`为`example.com/contact`？该规则当然不仅适用`contact.htm`于网站中的任何页面，而且适用于网站中的任何页面。无需担心 GET 变量，因为我不会使用任何变量。

[另外，您认为这是或可能被认为是一种好的做法还是不真正相关？]

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-08T00:40:47.763

尝试这个：

```
Options +FollowSymLinks

RewriteEngine On
RewriteRule ^contact.htm$ /contact 
```

这应该`contact.html`在请求时服务`example.com/contact/`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-08T11:55:57.110

You could consider using MultiViews. You'll need to load the [content negotiation](http://httpd.apache.org/docs/current/content-negotiation.html) module and turn MultiViews on, then Apache will automatically look for a file with an extension (there's a priority list in case you have both `.html` and `.htm` files with the same name for instance).

# php - 如何只显示不正确的答案并保持相同的表格布局

> ID：13278909
> 
> 赞同：0
> 
> 时间：2012-11-07T21:52:37.770
> 
> 标签：php, mysql, mysqli

下面我有 4 个数据库表，Session、Question、Answer 和 Option_Type。

**会话表：**

```
SessionId  SessionName
1          AAA 
```

**问题表：**

```
SessionId   QuestionId  QuestionContent       OptionId
1           1           What is 1+1 and 4+4   2
1           2           Does 2+2 = 4          26
1           3           What is 3+3 and 5+5   3 
```

**答案表：**

```
AnswerId  SessionId QuestionId  Answer
1         1         1           B
2         1         1           C
3         1         2           Yes
4         1         3           A
5         1         3           C 
```

**Option_Type**

```
OptionId OptionType
1        A-C
2        A-D
3        A-E
4        A-F

.... goes up to 24 where it goes up to A-Z

25       True or False
26       Yes or No 
```

现在在这里的 jsfiddle 中，我创建了一个演示 html 表，您可以[在这里看到](http://jsfiddle.net/WHUkh/6/)

现在，如果您仔细查看 html 表格，您会意识到我要做的是在“不正确答案”列下显示不正确的答案。

以问题 1 为例：

*   选项类型为 AD
*   正确答案是 B、C
*   所以应该在表中显示的错误答案是 A 和 D

所以我的问题是，如何在我的 php 脚本中为问题选择 option_type，显示所有可能的答案并删除正确的答案，只显示不正确的答案？表格的布局必须与jsfiddle中的布局一致。

下面是 php 脚本中的表格输出。目前它正在显示与 jsfiddle 中类似的表格，不同之处在于它输出的是正确答案，而不是错误答案。

```
 $query = "SELECT q.SessionId, s.SessionName, q.QuestionId, q.QuestionContent, an.Answer, q.QuestionMarks 
   FROM Session s 
   INNER JOIN Question q ON s.SessionId = q.SessionId
   JOIN Answer an ON q.QuestionId = an.QuestionId AND an.SessionId = q.SessionId
   WHERE s.SessionName = ?
   ORDER BY q.QuestionId, an.Answer
   ";

   // prepare query
   $stmt=$mysqli->prepare($query);
   // You only need to call bind_param once
   $stmt->bind_param("s", $assessment);
   // execute query
   $stmt->execute(); 

       // This will hold the search results
    $searchQuestionId = array();
    $searchQuestionContent = array();
    $searchAnswer = array();
    $searchMarks = array();

    // Fetch the results into an array

   // get result and assign variables (prefix with db)
   $stmt->bind_result($dbSessionId, $dbSessionName, $dbQuestionId, $dbQuestionContent, $dbAnswer, $dbQuestionMarks);
      while ($stmt->fetch()) {
        $searchQuestionId[] = $dbQuestionId;
        $searchQuestionContent[] = $dbQuestionContent;
        $searchAnswer[] = $dbAnswer;
        $searchMarks[] = $dbQuestionMarks;
      } 

?>      

</head>

<body>

<form id="QandA" action="<?php echo htmlentities($_SERVER['PHP_SELF']); ?>" method="post">

<?php 

echo "<table border='1' id='markstbl'>
      <tr>
      <th class='questionth'>Question No.</th>
      <th class='questionth'>Question</th>
      <th class='answerth'>Incorrect Answer</th>
      <th class='answermarksth'>Penalty per Incorrect Answer</th>
      </tr>\n";
$previous_question_id = null;
$rowspans = array_count_values($searchQuestionId);
foreach ($searchQuestionContent as $key=>$question) {

    // removed logic, not necessary to set empty strings if you're skipping them

    echo '<tr class="questiontd">'.PHP_EOL;

    if ($previous_question_id != $searchQuestionId[$key]) {
        echo '<td class="questionnumtd" name="numQuestion" rowspan="'.$rowspans[$searchQuestionId[$key]].'">'.htmlspecialchars($searchQuestionId[$key]).'</td>' . PHP_EOL;
        echo '<td class="questioncontenttd" rowspan="'.$rowspans[$searchQuestionId[$key]].'">'.htmlspecialchars($question).'</td>' . PHP_EOL;
    }

    echo '<td class="answertd" name="answers[]">';
    echo $searchAnswer[$key];
    echo '</td>' ;
    echo '<td class="answermarkstd"><input class="individualMarks" name="answerMarks[]" id="individualtext" type="text" /></td>' . PHP_EOL;

    // moved this to the end
    if ($previous_question_id != $searchQuestionId[$key]) {
        $previous_question_id = $searchQuestionId[$key];
    }
}
        echo '</tr>';
        echo "</table>" . PHP_EOL;

        ?>

</form> 
```

目前，上面的代码在“不正确答案”列下显示正确答案，而不是错误答案。

# ios - NSString stringWithFormat 返回类型，为什么是“id”？

> ID：13278910
> 
> 赞同：5
> 
> 时间：2012-11-07T21:52:42.527
> 
> 标签：ios, nsstring, static-methods, stringwithformat

为什么该方法`[NSString stringWithFormat]`返回一个`id`类型？从我期望的名称来看，它返回一个`NSString`，而不是通用指针。其他类遵循这个“规则”。例如`[NSNumber numberWithInt]`返回一个`NSNumber`，而不是一个`id`。

我认为从工厂方法之类的事实来看，这甚至是不合理的。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-07T21:59:56.127

您提到`NSNumber`，这没有任何直接子类，因此`numberWithInt:`返回 a是安全的`NSNumber*`

`NSString*`（以及其他类，例如`NSSet`）返回类型`id`，因为它们可以有子类（`NSMutableString`和`NSMutableSet`分别），它们将继承此方法。因此，这些继承调用需要返回子类类型的实例，并且由于方法命名规则，不能仅基于返回类型进行重载。因此，它们需要一个共同的类型，即`id`.

**更新**：最近的发展意味着关键字`instancetype`现在可用。您可能已经注意到很多引用`id`现在都替换为`instancetype`. 该关键字向编译器提供了一个提示，即方法的返回类型与方法的接收者是同一类。

例如（我强调一个例子，在实际框架中可能并非如此）：

```
NSArray:
- (instancetype)initWithArray:(NSArray*)array;

NSMutableArray:
// Inherits from NSArray

----

// Receiver is NSArray, method belongs in NSArray, returns an NSArray
[[NSArray alloc] initWithArray:@[]];

// Receiver is NSMutableArray, method belongs in NSArray, returns an NSMutableArray
[[NSMutableArray alloc] initWithArray:@[]]; 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-11-07T21:55:39.673

因为它是 NSString 类的静态方法，并且假定它返回被调用对象的类型。这也取决于类型，因为它可以来自 NSMutableString。

# c# - 是否可以将整数装箱到自定义类型对象？

> ID：13278911
> 
> 赞同：2
> 
> 时间：2012-11-07T21:52:45.230
> 
> 标签：c#, casting, boxing

> **可能重复：**
> [C# 隐式/显式类型转换](https://stackoverflow.com/questions/5062213/c-sharp-implicit-explicit-type-conversion)

我有一个我试图装箱的 int，以便在构造函数中使用它，该构造函数将`CustomType`.

我的意思的一个例子。

```
 int x = 5;
 object a = x;

 CustomType test = new CustomType(a)

 //constructor in question
 public CustomType(CustomType a)
 {
   //set some variables etc
 } 
```

但是我收到以下错误

```
 The best overloaded method match for X has some invalid arguments. 
```

所以很明显我离题了。我哪里错了？拳击是正确的解决方案还是我应该看类型铸造？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-07T21:56:55.047

我不认为拳击或铸造是你要找的。如果你想将一个整数传递给你的构造函数，你的构造函数应该这样定义：

```
public CustomType(int a) {
} 
```

或者，如果您希望它成为一个对象。

```
public CustomType(object a) {
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-07T21:57:28.253

该构造函数将`CustomType`类型作为参数；你正在传递一个`int`. An`int`不是 a `CustomType`，并且 C# 语言不知道从`int`to的隐式转换`CustomType`。这就是你收到错误的原因。

将 the`int`转换为 an`object`并不会改变它仍然不是 a 的事实`CustomType`。

查看那个特定的构造函数，它是一个复制构造函数。它将自身的类型作为参数。有（希望）另一个构造函数接受另一个参数，无论是 int 还是您没有提到的其他类型，或者可能没有参数，您只需要在创建默认对象后设置一个属性。

至于实际的解决方案，有很多。这里有几个：

1.  添加一个额外的构造函数来`CustomType`接受一个`int`.
2.  定义一个以 a`int`作为参数并返回 a`CustomObject`的函数 这将是您可以使用的“转换”功能。
3.  使用默认构造函数`CustomType`并使用整数设置属性（可能适用也可能不适用，具体取决于具体`CustomType`操作。

拳击似乎与手头的问题无关。您*不应该*使用它来将整数传递给自定义类型。如果您想更多地了解拳击是什么、它是如何工作的，或者它何时有用，那么请考虑提出一个解决这些问题的问题，因为使用拳击作为解决方案会*损害这个特定的问题，而不是帮助。*

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-11-07T21:57:31.080

您的构造函数看起来像一个复制构造函数（用于复制对象）。

如果要将对象变量传递给 CustomType 构造函数，则语法必须为：

```
public CustomType(Object a)
 {
   //Unboxing
   int value = (int) a;
 } 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-07T21:57:06.560

您应该使用显式类型转换并为此实现一些运算符。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-11-07T21:58:19.900

使用泛型。

```
public CustomType<T>(T a)
{
//set some variables etc
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-11-07T22:00:16.340

您可以装箱但不能装任意类型，并且您不能从盒子中取出不在盒子里的东西`int`。`object`即`int i = (int)(object)5;`会工作，但`CustomType x = (CustomType)(object)5;`不会工作。

你需要一个构造函数接受`int`

```
public CustomType(int a) {
    ....
} 
```

* * *

顺便说一句，您创建了奇怪的递归。如果唯一的构造函数需要 a`CustomType`那么你需要另一个`CustomType`对象来初始化第一个

```
 CustomType ct = new CustomType(new CustomType(new CustomType(null))); 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-11-07T22:33:43.943

装箱是当您将（a 的值）值类型转换为

1.  直接或间接基类（在这种情况下`int`可能是`ValueType`类或`object`类
2.  值类型实现的接口（在这种情况下`int`可以是`IComparable`, `IFormattable`, `IConvertible`, `IComparable<int>`, 或`IEquatable<int>`）

由于您永远无法`int`拥有其他基类或实现更多接口，因此无法将一个装箱`int`成`CustomType`.

如果您自己编写，`struct`那么*您*决定它实现哪些接口，在这种情况下，您的值`struct`可以装箱到每个接口类型中。（但是，您不能更改 a 的基类`struct`。）

在您的类/结构**中**`CustomType`，可以定义从to的[隐式转换](http://msdn.microsoft.com/en-us/library/z5z9kes2.aspx)。这样的话就合法了**`int``CustomType`**

 **```
CustomType ct = 5; 
```

但这不是拳击。这只是对您的`implicit operator`方法的“隐形”调用。原物`5`不放入盒子中；它只是您的运算符方法的参数。**

# google-chrome - 谷歌浏览器无法正确打印网络字体

> ID：13278928
> 
> 赞同：3
> 
> 时间：2012-11-07T21:53:53.560
> 
> 标签：google-chrome, fonts

从 Google Google chrome 打印页面时，打印预览在屏幕上看起来不错，但实际打印的纸张有乱码。

我发现很多人在屏幕上遇到过同样的问题，但没有人只在实际打印的页面上遇到过问题：

*   [从 Google Chrome 打印 Web 字体时显示垃圾字符](https://stackoverflow.com/questions/10173328/garbage-character-displayed-while-printing-web-fonts-from-google-chrome)

我正在使用 fonts.com api 嵌入我的字体。我在 Mac OSX 上使用 Chrome 23.0.1271.64

有没有人遇到过类似的问题？有什么建议吗？

# javascript - 让 jquery.texteffects.js 与梦想功能一起工作

> ID：13278930
> 
> 赞同：0
> 
> 时间：2012-11-07T21:54:02.797
> 
> 标签：javascript, jquery, html

我已经尝试了几个小时来让 texteffects.js 与下面的 Dream 函数一起工作。我试过用 div 包围文本，我也没有做 document.ready，而是创建了一个函数并从 Dream Document.Ready 事件中调用它。

```
 <!DOCTYPE html>
 <html xmlns="http://www.w3.org/1999/xhtml">
 <head>
 <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.8.1/jquery.min.js"       type="text/javascript"></script>
<title></title>
<style>
 body{
  background:black;
  overflow:hidden;
  color:white;
  font-size:2em;
 }
 .drawingpix { 
position:absolute; 
top:-50px; 
left:-50px;
}

 </style>

 </head>

 <body>
 <p id="typetext">
    The text to display
 </p>
 <script src="Scripts/jquery.texteffects.js"></script>
 <script type="text/javascript">
    //the function that creates dream
    function dream() {
        //calculating random color of dream
        var color = 'rgb(' + Math.floor(Math.random() * 255) + ',' + Math.floor(Math.random() * 255) + ',' + Math.floor(Math.random() * 255) + ')';

        //calculating random X position
        var x = Math.floor(Math.random() * $(window).width());

        //calculating random Y position
        var y = Math.floor(Math.random() * $(window).height());

        //creating the dream and hide
        drawingpix = $('<span>').attr({ class: 'drawingpix' }).hide();

        //appending it to body
        $(document.body).append(drawingpix);

        //styling dream.. filling colors.. positioning.. showing.. growing..fading
        drawingpix.css({
            'background-color': color,
            'border-radius': '100px',
            '-moz-border-radius': '100px',
            '-webkit-border-radius': '100px',
            top: y - 14,    //offsets
            left: x - 14 //offsets
        }).show().animate({
            height: '500px',
            width: '500px',
            'border-radius': '500px',
            '-moz-border-radius': '500px',
            '-webkit-border-radius': '500px',
            opacity: 0.1,
            top: y - 250,    //offsets
            left: x - 250
        }, 3000).fadeOut(2000);

         //Every dream's end starts a new dream
         window.setTimeout('dream()', 200);
    }

    $(document).ready(function () {

        //calling the first dream
        dream();

    });
    $(document).ready(function () {
        $("#typetext p").texteffects({ "texteffect": "unexplode", "speed": "slow", "delay": "1000" });
    });
 </script>
 </body>

 </html> 
```

我究竟做错了什么？

有任何想法吗？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-08T01:18:09.783

虽然 jQuery.texteffects.js 在我的项目中，但它不是包含。一旦我包含它，它就起作用了。

谢谢

# jquery - 在jquery中查找，替换每个元素

> ID：13278936
> 
> 赞同：0
> 
> 时间：2012-11-07T21:54:24.333
> 
> 标签：jquery

我在这个变量中有这个：“ver”在这里我有几行这样的：

```
<div class="link" id="1"><a ...>Anchor</a></div>
<div class="link" id="2"><a ...>Anchor 2</a></div> 
```

我在 jquery 中搜索代码，将上面的代码变成：

```
<div class="link" id="1"><a ...><img src="...?anchor=Anchor" /></a></div>
<div class="link" id="1"><a ...><img src="...?anchor=Anchor 2" /></a></div> 
```

我对代码的期望：找到每个锚点 - 获取它 - 生成显示此锚点的图像。PS：我有“图像生成”的功能。

解决了：

```
$(".link").each(function(){

            anchor =  $(this).find('a').text();
             $(this).find('a').html('<img src="generateLink.php?nr='+encodeURIComponent(anchor)+'" width="39" height="12"/>');  

            }); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-07T22:42:29.233

我想最好的方法是使用正则表达式。

```
jQuery('.link').each(function() {
    jQuery(this).html(
        jQuery(this).html().replace(/<a(.*)>(.*)<\/a>/g,
            '<a $1><img src="..?anchor=$2" /></a>')
    );
}); 
```

在第一行，你告诉 jQuery 使用类 'link' 获取每个元素。然后，您可以使用'/(.*)</a>/g' 找到该元素内的每个链接。

第一组（一组看起来像这样：'(.*)'）代表我们要捕获的第一组，因为我们需要元素携带的信息。

第二组是我们要存储的信息，因此我们知道要为我们的图像 URL 提供什么变量。

在第四行，我们将去替换我们需要的东西。每个 $ 符号后跟一个数字是我们在第三行捕获的一个组。

如果您想对正则表达式进行一些测试，我当然可以推荐[http://gskinner.com/RegExr/](http://gskinner.com/RegExr/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-07T22:24:59.900

如果我理解了，你必须改变这一行：

```
$(this).find(a).text().replaceWith(anchor); 
```

为了

```
$(this).find(a).text(varwithnewcontent); 
```

如果没有，对不起！

# abap - 查找时间戳范围的 DTP 例程

> ID：13278945
> 
> 赞同：2
> 
> 时间：2012-11-07T21:55:04.800
> 
> 标签：abap, sap-bw

我正在为格式为 YYYYMMDDhhmmss 的时间戳字段开发 DTP 过滤器例程。我试图将范围声明为（{timestamp 3 months ago} 到 {current timestamp}）。我对 ABAP 非常陌生，基本上现在已经设置了代码，所以它没有任何语法错误。当我将它分配给“l_ts”时，我目前无法获得要填充的正确时间戳。

```
*$*$ begin of routine - insert your code only below this line        *-*
BREAK-POINT.

DATA: l_idx LIKE sy-tabix,
        l_ts TYPE rstimestmp,
        l_ts2 TYPE rstimestmp.

  READ TABLE l_t_range WITH KEY
   fieldname = 'TIMESTAMP'.
   l_idx = sy-tabix.

* Capture the Current Date
  l_ts = sy-datlo + sy-timlo.
  l_ts2 = ( sy-datlo + sy-timlo ) - 93.

  IF l_idx <> 0.

* fill the Selection table.
    l_t_range-low = l_ts.
    l_t_range-sign = 'I'.
    l_t_range-option = 'BT'.
    l_t_range-high = l_ts2.

    MODIFY l_t_range INDEX l_idx.
 ELSE.
* fill the Selection table.
    l_t_range-fieldname = 'TIMESTAMP'.
    l_t_range-low = l_ts.
    l_t_range-high = l_ts2.
    l_t_range-sign = 'I'.
    l_t_range-option = 'BT'.

    APPEND l_t_range.
  ENDIF.

  p_subrc = 0.

*$*$ end of routine - insert your code only before this line         *-* 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-07T22:21:04.540

您正在混淆[时间戳](http://help.sap.com/abapdocu_702/en/abentime_stamp_oview.htm)和离散的[日期和时间计算](http://help.sap.com/saphelp_nw04/helpdata/en/fc/eb334a358411d1829f0000e829fbfe/frameset.htm)- 不会以这种方式工作。你真正想要的可能是这样的：

```
 DATA: l_date TYPE d,
        l_time TYPE t,
        l_ts   TYPE rstimestmp.

  FIELD-SYMBOLS: <ls_param> LIKE LINE OF l_t_range.

* ensure that the parameter exists
  READ TABLE l_t_range ASSIGNING <ls_param> WITH KEY fieldname = 'TIMESTAMP'.
  IF sy-subrc <> 0.
    APPEND INITIAL LINE TO l_t_range ASSIGNING <ls_param>.
    <ls_param>-fieldname = 'TIMESTAMP'.
  ENDIF.

  <ls_param>-sign = 'I'.
  <ls_param>-option = 'BT'.

* "from" date = three months ago, more or less - probably the start of the day?
  l_date = sy-datlo - 93.
  l_time = '000000'. " or sy-timlo.
  CONVERT DATE l_date TIME l_time INTO TIME STAMP l_ts TIME ZONE sy-zonlo. 
  <ls_param>-low = l_ts.

* "to" date = today - probably the end of the day?
  l_date = sy-datlo.
  l_time = '235959'. " or sy-timlo.
  CONVERT DATE l_date TIME l_time INTO TIME STAMP l_ts TIME ZONE sy-zonlo. 
  <ls_param>-high = l_ts. 
```

# java - 当我将位图添加到数组列表时，最后一个元素在先前的索引中重复

> ID：13278955
> 
> 赞同：3
> 
> 时间：2012-11-07T21:55:41.030
> 
> 标签：java, android, arraylist

我正在尝试在类似手指画的应用程序中实现个人的撤消/重做方式。

我综合了三个对象：Main 类（名为 ScorePadActivity）、相关的 Main Layout（带有按钮、菜单等，以及我在其中创建绘图的 View 对象），以及我所在的第三个名为 ArrayList 的对象编写撤消/重做代码。

问题是，当我按下撤消按钮时没有任何反应，但如果我再次“一次性”绘制任何内容并按下撤消，屏幕就会更新。如果我画了很多次，要看到屏幕上发生的任何变化，我必须按我画过的相同次数的撤消按钮。

似乎（如标题）当我将位图添加到数组列表时，最后一个元素在以前的索引中重复，并且由于某种奇怪的原因，每次我按下撤消按钮时，系统一次都可以，但开始重复直到下一次撤消。使用一系列`System.out.println`插入的代码来验证索引的增加。

现在，当我在屏幕上绘制某些东西时，数组列表会使用在调用`touchup();`motionEvent 中的方法后插入的代码进行更新

```
touch_up(); }
      this.arrayClass.incrementArray(mBitmap);
    mPath.rewind();
      invalidate(); 
```

并在 ArrayList 活动中；

```
public void incrementArray(Bitmap mBitmap) {
this._mBitmap=mBitmap;
_size=undoArray.size();
    undoArray.add(_size, _mBitmap);
    } 
```

（删除所有日志以便清晰阅读）

ScorePadActivity 中的 undo 按钮调用 View 活动中的 undo 方法：

```
Button undobtn= (Button)findViewById(R.id.undo);
undobtn.setOnClickListener(new View.OnClickListener() {
            public void onClick(View v) {
                mView.undo();
                }
        }); 
```

在查看活动中：

```
public void undo() {
this.mBitmap= arrayClass.undo();
 mCanvas = new Canvas(mBitmap); 
  mPath.rewind();
    invalidate();
} 
```

调用 ArrayList 活动中的相对撤消方法：

```
public Bitmap undo() {
    // TODO Auto-generated method stub
    _size=undoArray.size();
                    if (_size>1) {
    undoArray.remove(_size-1);
_size=undoArray.size();
          _mBitmap = ((Bitmap) undoArray.get(_size-1)).copy(Bitmap.Config.ARGB_8888,true);
}
return _mBitmap;
    }

return mBitmap and invalidate: 
```

由于我的英语不好，我制定了一个计划来使问题更清楚： ![问题的通量](../Images/f6daa255de69334762904012bae1093e.png)

我试过用 HashMap，用一个简单的数组，我试过`mPath.rewind();`用等改变`reset();`，`new Path();`但没有。为什么？

抱歉，答案很复杂，我想提前非常感谢您。最好的祝福

**编辑**

```
 <?xml version="1.0" encoding="utf-8"?>
 <RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent" >

    <LinearLayout
        android:id="@+id/buttonlayout"
        android:layout_width="fill_parent"
        android:layout_height="50dp"
        android:layout_alignParentLeft="true"
        android:layout_alignParentTop="true" >

      some other layouts nested an buttons to form a upper toolbar

</LinearLayout>

    <RelativeLayout
        android:id="@+id/viewlayout"
        android:layout_width="fill_parent"
        android:layout_height="fill_parent"
        android:layout_below="@+id/buttonlayout"
        android:background="@drawable/desk_wood" >

      <com.example.android.touchexample.MyView
          android:id="@+id/viewout"
          android:layout_width="fill_parent"
          android:layout_height="fill_parent"
          android:layout_alignParentLeft="true"
          android:layout_alignParentTop="true" />

    </RelativeLayout>

</RelativeLayout> 
```

这是主要活动 ScorePadActivity

```
public class ScorePadActivity extends Activity {

MyView mView;

public void onCreate(Bundle savedInstanceState) {
    requestWindowFeature(Window.FEATURE_NO_TITLE); 
    super.onCreate(savedInstanceState);

    setContentView(R.layout.main);
    mView = (MyView)findViewById(R.id.viewout);     
Button undobtn= (Button)findViewById(R.id.undo);
undobtn.setOnClickListener(new View.OnClickListener() {
            public void onClick(View v) {
                mView.undo();
                }
        }); 
```

**这是查看活动：**

```
public class MyView extends View {

MyView myView;

Context context;
final ArrayClass arrayClass= new ArrayClass();

private Bitmap mBitmap;
private Bitmap savedBmp;
private static Canvas mCanvas;
private static Path mPath;
private static Paint mPaint;
/*
* some other variables here 
*/

public MyView(Context context) {
    super(context);
 }

public MyView(Context context, AttributeSet attrs) {
    super(context, attrs);
    mPaint = new Paint();
      mPaint.setAntiAlias(true);
        mPaint.setColor(color);
            mPaint.setStyle(Paint.Style.STROKE);
                mPaint.setStrokeJoin(Paint.Join.ROUND);
                mPaint.setStrokeCap(Paint.Cap.ROUND);
                mPaint.setStrokeWidth(bSize);
                    mPaint.setAlpha(255);
                        mPath = new Path();
}
public MyView(Context context, AttributeSet attrs, int defStyle) {
    super(context, attrs, defStyle);
}
@Override
  protected void onSizeChanged(int w, int h, int oldw, int oldh) {
    super.onSizeChanged(w, h, oldw, oldh);
mBitmap = Bitmap.createBitmap((int) bmWidth, (int) bmHeight,Bitmap.      Config.ARGB_8888);}
/*
 * here add a blank bitmap at the start of the array at index 0         
 */

arrayClass.incrementArray(mBitmap);
                mCanvas = new Canvas(mBitmap);
  }
public void onDraw(Canvas canvas) {

    canvas.save();  

    bx= (((width/mScaleFactor)-width)/2)+center;
    by= ((height/mScaleFactor)-height)/2;

    canvas.translate(mPosX, mPosY);
        canvas.scale(mScaleFactor, mScaleFactor);
            canvas.drawBitmap(penta, bx, by, null); 
                mCanvas.drawPath(mPath, mPaint);  
                canvas.drawBitmap(mBitmap, bx, by, null); 
                lastmPosX=mPosX;
                    lastmPosY=mPosY;
                        lastmScaleFactor=mScaleFactor;
                            canvas.restore();

  }
private void touch_start(float x, float y) {
      x=((x/mScaleFactor)-bx)-(mPosX/mScaleFactor);
      y=((y/mScaleFactor)-by)-(mPosY/mScaleFactor);
      mPath.rewind();
        mPath.moveTo(x, y);
            move=false;
                mX = x;
                    mY = y;
  }

  private void touch_move(float x, float y) {

      x=((x/mScaleFactor)-bx)-(mPosX/mScaleFactor);
      y=((y/mScaleFactor)-by)-(mPosY/mScaleFactor);
    float dx = Math.abs(x - mX);
        float dy = Math.abs(y - mY);
            if (dx >= TOUCH_TOLERANCE || dy >= TOUCH_TOLERANCE) {
                mPath.quadTo(mX, mY, (x + mX) / 2, (y + mY) /    2);
                    mX = x;
                    mY = y; 
                        move=true;
    }

  }

  private void touch_up() {

  mPath.lineTo(mX, mY);
        // mPath.rewind();
        }

 @Override
 public boolean onTouchEvent(MotionEvent ev) {
        x = ev.getX();
        y = ev.getY();

    switch (ev.getAction()) {

    case MotionEvent.ACTION_DOWN:
      touch_start(x, y);
      invalidate();
      break;
    case MotionEvent.ACTION_MOVE:
      touch_move(x, y);

      invalidate();

      break;
    case MotionEvent.ACTION_UP:

      touch_up(); 
      // Here update the arraylist in the ArrayList activity
      this.arrayClass.incrementArray(mBitmap);
            mPath.rewind();
                invalidate();

      break;}

  return true;
  }

 /*
 * more methods here
*/      switch (ev.getAction()) {

    case MotionEvent.ACTION_DOWN:

    public void undo() {
            // Here recall the last mBitmap from Arraylist activity
                this.mBitmap= arrayClass.undo();
                    mCanvas = new Canvas(mBitmap);  
                        mPath.rewind();
                invalidate();
}
} 
```

**这是我的 ArrayList 活动：**

```
public class ArrayClass {

ArrayList<Bitmap> undoArray =new ArrayList<Bitmap>();
private int _size;
private Bitmap _mBitmap;

public void incrementArray(Bitmap mBitmap) {
    this._mBitmap=mBitmap;
        _size=undoArray.size();
            // undoArray.add(_size, _mBitmap);
                               undoArray.add(_size, Bitmap.createBitmap(_mBitmap));
            }

public Bitmap undo() {
    // TODO Auto-generated method stub
    _size=undoArray.size();
if (_size>1) {
        undoArray.remove(_size-1);
        _size=undoArray.size();
_mBitmap = ((Bitmap) undoArray.get(_size-1)).copy(Bitmap.Config.ARGB_8888,true);
            }
return _mBitmap;
    }

public Bitmap redo() {
    // TODO 
    return null;
}
} 
```

再次感谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-27T02:14:48.760

这里的解决方案，以这种方式编辑 ArrayClass：

```
public class ArrayClass {

ArrayList<Bitmap> undoArray =new ArrayList<Bitmap>();
private int _size;
private Bitmap _mBitmap;

public void incrementArray(Bitmap mBitmap) {
this._mBitmap=mBitmap;
    _size=undoArray.size();
        // undoArray.add(_size, _mBitmap); replace with:
                           undoArray.add(_size, Bitmap.createBitmap(_mBitmap));
        }

public Bitmap undo() {
 // TODO Auto-generated method stub
_  size=undoArray.size();
if (_size>1) {
    undoArray.remove(_size-1);
    _size=undoArray.size();
      _mBitmap = ((Bitmap) undoArray.get(_size-1)).copy(Bitmap.Config.ARGB_8888,true);
        }
return _mBitmap;
}

public Bitmap redo() {
// TODO 
return null;
}
} 
```

# r - 删除表中的值及其对应的值

> ID：13278957
> 
> 赞同：0
> 
> 时间：2012-11-07T21:55:54.973
> 
> 标签：r, awk

在一个文件（1000 列，2000 行）中，每一列旁边都有另一列。就像是：

```
[,1] [,2] [,3] [,4] [,5] [,6]
3      3    4    4     4     6
6      5    2    2     5     1
9      1    3    5     4     1
2      5    6    4     8     5
6      1    5    2     3     1 
```

我想删除其对应值为 1 结果的那些值：

```
[,1] [,3] [,5] 
3    4     4
6    2     8
2    3
     6
     5 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-07T22:16:42.527

为了呼应@shellter 所说的话，在问题中包含您尝试过的内容既有帮助又有礼貌。

`split`这是使用and完成此操作的一种紧凑方法`mapply`。

```
d <- read.table(text='3      3    4    4     4     6
6      5    2    2     5     1
9      1    3    5     4     1
2      5    6    4     8     5
6      1    5    2     3     1', header=FALSE)

cols <- split(as.list(d), rep(1:2, length.out=length(d)))
mapply(function(col1, col2) col1[col2 != 1], 
       cols[[1]], cols[[2]], SIMPLIFY=FALSE)

# $V1
# [1] 3 6 2
# 
# $V3
# [1] 4 2 3 6 5
# 
# $V5
# [1] 4 8 
```

# ninject - 如何使用 Ninject 装饰绑定到多个具体类型的接口

> ID：13278958
> 
> 赞同：4
> 
> 时间：2012-11-07T21:55:56.257
> 
> 标签：ninject, decorator

所以，我有一个通过 Ninject 实例化消息处理程序的消息总线。我想用诸如日志记录、事务管理等横切关注点来装饰我的处理程序。

我像这样设置我的绑定：

```
kernel.Bind<IMessageHandler<int>>().To<IntHandlerOne>()
    .WhenInjectedInto(typeof(HandlerDecorator<>));
kernel.Bind(typeof(IMessageHandler<>)).To(typeof(HandlerDecorator<>)); 
```

每当我有一个特定消息类型的处理程序时，它都非常有效。但是，当我定义了多个处理程序时：

```
kernel.Bind<IMessageHandler<int>>().To<IntHandlerOne>()
    .WhenInjectedInto(typeof(HandlerDecorator<>));
kernel.Bind<IMessageHandler<int>>().To<IntHandlerTwo>()
    .WhenInjectedInto(typeof(HandlerDecorator<>));
kernel.Bind(typeof(IMessageHandler<>)).To(typeof(HandlerDecorator<>)); 
```

Ninject 将找到装饰器并将其注入消息总线，然后尝试将两个处理程序注入装饰器构造函数，但均未成功。

```
public HandlerDecorator(IMessageHandler<T> handler) 
```

你可能会想，我为什么不直接修改我的装饰器来接受处理程序列表呢？我想过这个，但这违背了处理程序的目的。我希望能够轻松地将多个装饰器透明地链接在一起。每个实例都`IMessageHandler<T>`应该获得一个全新的处理程序链。

我在 GitHub 上发布[了一个示例](https://github.com/kmcginnes/POC.NinjectMessageHandlerDecoration)测试库，它应该能说明我在这里所说的内容。

Ninject 有什么方法可以做到这一点吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-16T11:46:18.190

利用

```
kernel.Bind<IMessageHandler<int>>().To<IntHandlerOne>().WhenParentNamed("One");
kernel.Bind<IMessageHandler<int>>().To<IntHandlerTwo>().WhenParentNamed("Two");
kernel.Bind(typeof(IMessageHandler<>)).To(typeof(HandlerDecorator<>)).Named("One");
kernel.Bind(typeof(IMessageHandler<>)).To(typeof(HandlerDecorator<>)).Named("Two"); 
```

另请注意，大多数总线框架都有一些方法可以对消息处理程序进行修饰。可以先在那里看看。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-08T10:33:19.073

您应该将这些处理程序包装在一个[组合](http://en.wikipedia.org/wiki/Composite_pattern)中：

```
public class CompositeMessageHandler<T> : IMessageHandler<T>
{
    private readonly IEnumerable<IMessageHandler<T>> handlers;

    CompositeMessageHandler(IEnumerable<IMessageHandler<T>> handlers)
    {
        this.handlers = handlers;
    }

    public void Handle(T message)
    {
        foreach (var handler in this.handlers)
        {
            handler.Handle(message);
        }
    }
} 
```

这种复合材料可以再次注入到您的装饰器中。或者也许你应该反过来做：用装饰器包装每个处理程序并将它们包装到复合材料中。

不过，我不确定如何使用 Ninject 注册它。

# python - 从列表中随机选择项目，无法分配给变量，而是遇到 NameError

> ID：13278959
> 
> 赞同：0
> 
> 时间：2012-11-07T21:56:00.810
> 
> 标签：python, python-2.7

我无法理解为什么我创建的类对象无法从列表中返回随机选择的项目。我知道问题在于我无法理解如何传递值的基本知识。我仍然是学习 Python 的新手，这只是我的第二个应用程序。我的最终目标是创建一个`Weapons()`名为的类对象，该对象`armed`具有名为`weapon`. 我希望能够创建“armed.weapon”，这是一种从列表中随机选择的武器，然后分配给另一个类对象中的变量，即“hero_weapon = armed.weapon”。这是我编写的示例，试图创建“armed.weapon”，然后打印该值。我的逻辑有什么缺陷？为什么我会遇到“NameError: global name 'weapon' is not defined”？

```
from random import randint

class Weapons(object):

def __init__(self, weapon = ''):
    self.weapon = weapon
    self.weapons_list = [
        'Flame Blade',
        'Ice Flail',
        'Lightning Mace'
    ]

def choices(self):
    self.weapon = self.weapons_list[randint(0, 2)]
    self.weapon = weapon
    return weapon

armed = Weapons()
armed.choices()
print armed.weapon 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-07T21:59:20.363

在你的`choices()`方法中：

```
self.weapon = weapon
return weapon 
```

`weapon`没有声明，也许你想做这样的事情：

```
weapon = self.weapon
return weapon 
```

或者简单地说：

```
return self.weapon 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-07T21:58:50.910

```
def choices(self):
    self.weapon = self.weapons_list[randint(0, 2)]
    self.weapon = weapon
    return weapon 
```

在您的上述方法中，不确定您在做什么，但您尝试访问`weapon`而不声明它。所以，它会给你一个错误。

您宁愿这样使用：-

```
def choices(self):
    self.weapon = self.weapons_list[randint(0, 2)]
    return self.weapon 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-07T21:57:47.203

问题在这里：

```
self.weapon = weapon 
```

您永远不会分配名为`weapon`. 前一行您设置了一个*实例*变量`self.weapon`。只是`return self.weapon`。

另外，为了让您了解：

```
>>> import random
>>> weapons_list = [
...         'Flame Blade',
...         'Ice Flail',
...         'Lightning Mace'
...     ]
>>> 
>>> random.choice(weapons_list)
'Lightning Mace'
>>> random.choice(weapons_list)
'Ice Flail'
>>> _ 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-11-07T21:58:45.470

只需使用：

```
from random import randint

class Weapons(object):
    def __init__(self, weapon = ''):
        self.weapon = weapon
        self.weapons_list = [
            'Flame Blade',
            'Ice Flail',
            'Lightning Mace'
            ]

    def choices(self):
        self.weapon = self.weapons_list[randint(0, 2)]
        return self.weapon

armed = Weapons()
armed.choices()
print armed.weapon 
```

你的错误是：

```
self.weapon = weapon
return weapon 
```

因为武器从未被宣布

# javascript - jQuery find() 只返回第一个匹配的结果？

> ID：13278961
> 
> 赞同：3
> 
> 时间：2012-11-07T21:56:11.137
> 
> 标签：javascript, jquery, html, find

我在 jQuery 中使用 $.find() 方法，但无法获得与选择器条件匹配的所有结果。

这是我的 HTML

```
<div class="something">
<label> Hello </label>
<div class="selse">
    <label> Hi </label>
    <label class="imp"> This is </label>
    <label class="imp"> Nooo </label>
</div>
<label class="imp"> Sparta </label>
<label class="imp"> Right ? </label>
</div>

<div class="something">
<label> Hell No </label>
<div class="selse">
    <label> Hi </label>
    <label class="imp"> Cant </label>
</div>
<label class="imp"> touch </label>
<label class="imp"> this </label>
 <label class="imp"> MC  </label>
</div>​ 
```

所以当我做以下JS

```
$("div.something").each(function(index) {
   alert(index + ': ' + $(this).find("label.imp").html())
    });​ 
```

我预计它会给我 2 个警报。一个与`0\. This is, Nooo, Sparta, Right ?`另一个与`1\. Cant, touch, this, MC`。但我得到了只是`0\. This is`和`1\. Cant`。

我尝试在这样的同一函数中使用数组

```
$("div.something").each(function(index) {
    var arr=[]
    arr = $(this).find("label.cidForm").html();
    alert(arr);
    });​ 
```

不，我会收到带有“未定义”的警报框。在这两种情况下我做错了什么？我只想要一个包含**label.imp**元素内所有值的数组。

这是我提出的相同的 JSFiddle。[http://jsfiddle.net/WPeKF/1/](http://jsfiddle.net/WPeKF/1/)

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-11-07T21:58:18.960

`.html()`和其他 getter 方法只返回第一个匹配元素的值。考虑到这一点，我认为您可以弄清楚需要进行的逻辑更改。

小提琴：http: [//jsfiddle.net/WPeKF/2/](http://jsfiddle.net/WPeKF/2/)

代码：

```
var arr = $("div.something").map(function(){
    return $(this).find("label.imp").map(function(){
        return $(this).html();
    }).get().join("");        
}).get();
console.log(arr); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-07T22:02:14.493

这应该可以解决问题：

```
var myArray = $("div.something label.imp").map(function(index) {
    return $(this).html();
});​ 
```

# c# - 画线中间有一个箭头

> ID：13278962
> 
> 赞同：3
> 
> 时间：2012-11-07T21:56:13.820
> 
> 标签：c#

首先对不起我的英语......我想在c#中用箭头画线。我该怎么做？

我已经这样做了：

```
Graphics g = e.Graphics;
g.SmoothingMode = SmoothingMode.AntiAlias;

Pen p = new Pen(Color.Black, 2);
p.StartCap = LineCap.Round;
p.EndCap = LineCap.ArrowAnchor;
g.DrawLine(p, StartX, StartY, EndX, EndY);
p.Dispose(); 
```

但这还不够……我想把箭头画到线的中间……

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-07T22:00:11.693

试试这个也许有帮助

```
 AdjustableArrowCap bigArrow = new AdjustableArrowCap(5, 5);
   Pen p = new Pen(Color.Blue, 1);
   p.CustomEndCap = bigArrow;
   e.Graphics.DrawLine(p, 20, 20, 100, 100); 
```

# python - 使用 execfile 的 Eclipse PyDev 未定义变量

> ID：13278963
> 
> 赞同：1
> 
> 时间：2012-11-07T21:56:26.527
> 
> 标签：python, pydev, execfile

我是 PyDev 的新手，所以这可能是对我的问题的简单回答。

我拉入 PyDev 的代码使用 execfile 而不是导入来从另一个文件中拉入一个类。我无法控制代码，因此无法将其更改为导入。

```
execfile("my_class.py")
my_class.function() 
```

对于 execfile 引入的每个类，我得到一个未定义的变量。

有没有办法让 PyDev 识别我通过 execfile 引入的类。也许有某种方法可以在 PyDev 中进行隐式导入？

# android - 为什么 Flowplayer 不能在 Android 或 IE8 上运行？视频为mp4格式

> ID：13278965
> 
> 赞同：0
> 
> 时间：2012-11-07T21:56:33.163
> 
> 标签：android, wordpress, internet-explorer, browser, flowplayer

使用最新版本的 Flowplayer，它可以在除 Android 和 IE8 之外的所有设备上运行。在 IE9 中，它显示“HTML5：找不到视频”，这显然不是真的，因为它正在其他浏览器上播放。

视频为mp4格式。Android和IE不支持这个吗？

为什么 flowplayer 不能恢复到 flash？

我的嵌入代码如下所示：

```
 `<div id="postFeaturedImage">
    <div class="flowplayer" data-rtmp="rtmp://s3rsj73dgt28vf.cloudfront.net/cfx/st">
    <video id="video" src="https://s3.amazonaws.com/chardonnay/<?php echo get_post_meta($post -> ID, 'video-low-resolution', true); ?>.mp4" poster="<?php echo wp_get_attachment_url( get_post_thumbnail_id($post->ID) ); ?>"></video>
    </div><!-- flowplayer -->
</div><!-- postFeaturedImage -->` 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-07T22:02:34.620

Android 整体上仅支持正确设置 MOOV atom 的 mpeg 4 编码基线配置文件。较新的设备支持其他方法（HLS 和更高配置的 mpeg4 类型），但不是通用的。

这是更明确的信息：http: [//developer.android.com/guide/appendix/media-formats.html#recommendations](http://developer.android.com/guide/appendix/media-formats.html#recommendations)

# c# - Windows / Web 窗体到其他类、窗体等

> ID：13278969
> 
> 赞同：1
> 
> 时间：2012-11-07T21:56:58.390
> 
> 标签：c#, forms, class, containers

所以这个特定的话题已经被打死了；但显然我的迭代要么不是选择的方法，要么不适合实施。

目标是创建一个 Windows 窗体和一个 Web 窗体。这两种形式；在单独的类中设置属性。然后其他类引用容器；这样，随着界面的变化，功能将发生变化，而无需大量重新编码。

Windows 窗体 ---> 容器 <--- Web 窗体容器 --> 由这些引用：1 类、2 类、3 类

我是这样处理的：形式：

```
private Some.Reference.ToClass.Container _container;
public void Method(Some.Reference.ToClass.Container Container)
{
          _container = Container;
}

private void button_click(object sender, EventArgs e)
{
          _container.Name = textbox.Text (or some other component)
} 
```

类：“容器”

```
public Name { get; set; } 
```

要参考的类别或表格：

```
Class WhateverName
{
       private string REFERENCE;

       private Some.Reference.ToClass.Container _container;
       public void Method(Some.Reference.ToClass.Container Container)
       {
                _container = Container;
       }

       public void NewMethod()
       {
              REFERENCE = _container.Name;
       }
} 
```

它一直没有设置；它声明它是一个空对象。我错过了什么？任何帮助，将不胜感激。甚至是一个很好的教程供我比较学习；或者找到它为什么不起作用也会很好。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-20T21:16:42.670

根据提供的详细信息；包括空值的问题。我设置了一个构造函数以根据更改自动初始化。然后只是添加了一些空引用检查。

此分辨率的示例：

```
public class One
{

    // declared:
    private.some.Reference.ToSomeClass _container;

    One(ToSomeClass container)
    {
          _container = container;
    }

    private void button_click(object sender, EventArgs e)
    {
          if(_container != null)
          {
               _container.Name = textbox.Text (or some other component)
          }
    }
} 
```

然后在另一个班级；它引用了该属性；设置它。因此，为了避免它失败导致尚未分配值或尚未创建实例，只需添加空引用验证。

# html - Firefox 中的本地存储键返回的空值与其他浏览器不同

> ID：13278971
> 
> 赞同：0
> 
> 时间：2012-11-07T21:57:07.250
> 
> 标签：html, firefox, local-storage

Firefox 和 Chrome 在通过密钥访问本地存储时返回不同的值。

```
alert(localStorage.mykey); // FF = null, Chrome = undefined
alert(localStorage.getItem('mykey')); // FF = null, Chrome = null 
```

请参阅 Firefox 错误[localStorage/sessionStorage 应该为未定义的键返回未定义（非空）。](https://bugzilla.mozilla.org/show_bug.cgi?id=532062)

从本质上讲，Chrome 和其他浏览器`localStorage.mykey`像 Firefox 对待它的任何其他数组对象一样对待它`getItem()`。

所以，我的问题是：鉴于这种差异，检查 localStorage 中是否存在密钥的最佳方法是什么？

选项1：`if(localStorage.getItem('key') === null)`

选项 2：`if(localStorage.key === null || localStorage.key === undefined)`

`||`选项 3：没有#2的任何方法来检查 localStorage.key ？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-07T22:15:18.690

您使用的是哪个版本的 Firefox？在这种情况下，最新版本（我使用 Firefox 14 测试）返回`undefined`。无论如何，简单的测试是`typeof localStorage.key == "string"`。

# r - 如何命名时间序列对象中的列？

> ID：13278972
> 
> 赞同：12
> 
> 时间：2012-11-07T21:57:19.737
> 
> 标签：r, time-series

我在这里有点困惑，一定缺少一些非常基本的东西。我想从多个时间序列对象中提取列。也许可以通过将 ts 对象放入数据框然后提取它们来完成，但是有一种直接的方法可以对时间序列进行子集化，如本问题[链接中所给出](https://stackoverflow.com/questions/11542584/refer-to-time-series-object-by-column-name)

要弄清楚如何为 ts 对象分配名称， ?ts 显示

```
ts(data = NA, start = 1, end = numeric(), frequency = 1,
   deltat = 1, ts.eps = getOption("ts.eps"), class = , names = ) 
```

但是在 ?ts 帮助中运行代码时，无论有无名称参数，都会给出 `names(z)`NULL。

`z <- ts(matrix(rnorm(300), 100, 3), start=c(1961, 1), frequency=12)` 或者`z <- ts(matrix(rnorm(300), 100, 3), start=c(1961, 1), frequency=12, names=c("x1", "x2", "x3"))`

主要问题：1.如何为时间序列对象 ts 和 mts 中的列分配名称？2\. 随时间索引直接从时间序列对象中提取列的方法有哪些？是否有必要将其转换为 zoo 或 xts 类？还是单独添加时间索引？

为了给出我正在尝试解决的问题的想法：

```
# using inbuilt ldeaths time series dataset
ldeaths
d <- diff(ldeaths)
percen <- quantile(d, 0.9)
i <- ifelse(d>percen, 1,0)
signal <- cbind(d,i) 
```

现在要提取指标为 1 的数据集，*使用 time index*，我不知道如何继续。str(signal) 是一个 mts 对象，但打印信号显示没有时间索引。

非常感谢。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-11-07T22:00:04.580

## 提取`"mts"`对象中的系列名称

你想要`colnames()`：

```
> colnames(z)
[1] "x1" "x2" "x3" 
```

这是因为`z`实际上是一个带有额外属性的矩阵，而矩阵没有，`names`但它们确实有`colnames`。

## 分配/更改`"mts"`对象中系列的名称

`colnames`要事后分配或更改它们，请使用替换功能`'colnames<-'`

```
> colnames(z) <- paste0("a", 1:3)
> colnames(z)
[1] "a1" "a2" "a3" 
```

## `"mts"`从对象中提取特定系列

至于提取列，`[`适用于`"ts"`和`"mts"`对象。例如：

```
> z[,1]
             Jan         Feb         Mar         Apr         May
1961  0.81800833 -0.30852155  0.05915071  0.14937058  0.67734362
1962  1.12993606 -0.81176485 -0.51903387  1.12527537 -0.34377553
1963  1.30469813  0.32486340  0.01029512 -1.13631688 -1.22013150
1964  0.72449621 -0.88704234  0.78834391 -0.92956537 -0.31584252
1965  0.24610412  0.97980266  0.17136276  2.45216318  0.15846038
1966 -0.48891587 -0.62820331  0.33190472  2.14094813  1.32389152
1967  0.49120472 -0.10149521 -0.39070688 -0.78743955 -1.20563040
1968 -0.70749150  0.52333087 -0.51991721  0.02037504 -0.59848254
1969 -0.80156968 -1.38172513  0.09400527  0.66966443            
.... 
```

## OP问题的胆量

最后一点，我不确定你希望得到什么。一个`"ts"`或对象是一个规则的时间序列，并在一个向量而不是一个时间序列中`"mts"`提取结果的位。`signal[, "d"]`

```
> signal[signal[,2] == 1, 1]
[1]  761 1104  810  653  522  956  593 
```

没有任何时间索引，因为这不再是一个*对象*`"ts"`。如果你想这样做，**动物园**包可能是你想要的方式。这是一个示例，我们使用以下方法转换为 zoo 对象`as.zoo()`

```
require(zoo)
sz <- as.zoo(signal) 
```

然后我们可以提取我们想要的观察结果（名称是时间索引的有用指标）

```
> sz[sz[, "i"] == 1, "d"]
1975(12)  1976(2) 1976(12) 1977(12)  1978(1) 1978(12)  1979(1) 
     761     1104      810      653      522      956      593 
```

然后一个类似的子集调用，但使用`index()`返回整个动物园对象的时间索引，然后选择我们想要的位

```
> index(sz)[sz[, "i"] == 1]
[1] 1975.917 1976.083 1976.917 1977.917 1978.000 1978.917
[7] 1979.000 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2017-09-16T07:11:56.617

如果要重命名`mts`（矩阵时间序列）对象的列。只是简单地使用`colnames()`函数。

例如：您有一个包含三列的时间序列数据，并且您想要更改该列名称：

```
colnames(data) <- c('newname1','newname2','newname3') 
```

希望这可以帮助。

# java - 在 jtable 的双精度型单元格中输入空白值

> ID：13278978
> 
> 赞同：0
> 
> 时间：2012-11-07T21:57:46.890
> 
> 标签：java, swing, jtable

我在 jtable 中有问题的双列有自定义表模型和自定义渲染。我希望可以选择在双列中保留空白单元格。事实上，当我把它留空时，写作是空的。默认情况下，此选项位于另一个字符串列中，但如果我将其设为空白，则会引发一些异常。我怎么能做到？

编辑：这是错误

```
Exception in thread "AWT-EventQueue-0" java.lang.NullPointerException
    at table.MyTableModel.setValueAt(MyTableModel.java:62)
    at javax.swing.JTable.setValueAt(JTable.java:2710)
    at javax.swing.JTable.editingStopped(JTable.java:4712) 
```

这是 MyTaleModel 中的代码

```
public void setValueAt(Object value, int row, int col) {

    data.get(row)[col] = value;
    fireTableCellUpdated(row, col);
} 
```

这是数据： `static ArrayList<Object[]> data`

这是列渲染器

```
public class ColumnRenderer extends DefaultTableCellRenderer {

int precision = 0;
Number numberValue;
NumberFormat nf;

public ColumnRenderer(int p_precision) {
    super();
    setHorizontalAlignment(SwingConstants.RIGHT);
    precision = p_precision;
    nf = NumberFormat.getNumberInstance();
    nf.setMinimumFractionDigits(p_precision);
    nf.setMaximumFractionDigits(p_precision);
}

@Override
public void setValue(Object value) {
    if ((value != null) && (value instanceof Number)) {
        numberValue = (Number) value;
        value = nf.format(numberValue.doubleValue());
    }
    super.setValue(value);
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-07T23:03:04.567

不是一个真正的答案，但太长无法评论。

如果您只想显示`Double`实例，则不需要自定义渲染器。默认渲染器能够处理这种情况。唯一的前提是您`TableModel`在`getColumnClass`方法中返回正确的类。

可以看到源码中默认的渲染器就足够了。快速复制粘贴：

```
static class DoubleRenderer extends NumberRenderer {
    NumberFormat formatter;
    public DoubleRenderer() { super(); }

    public void setValue(Object value) {
        if (formatter == null) {
            formatter = NumberFormat.getInstance();
        }
        setText((value == null) ? "" : formatter.format(value));
    }
} 
```

所以你很可能做错了你没有告诉我们的事情。发布堆栈跟踪和相关代码以获得更好的答案。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-07T22:24:44.580

在您的自定义单元格渲染器中，您需要考虑实际的空值是什么。您可以`null`从表模型或预定义值（例如 0）返回。

如果您的模型实际上是返回`Double`，那么它变得相当容易......

在您自定义单元格渲染中，您需要检查“空”状态...

```
public Component getTableCellRendererComponent(JTable table, Object value, boolean isSelected, boolean hasFocus, int row, int column) {
    if (value == null) {
        value = "";
    } else {
        // Carry on as normal...
    }
    return super.getTableCellRendererComponent(table, value, isSelected, hasFocus, row, column);
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-11-07T22:08:10.950

我认为您应该使用包装器类`Double`代替`double`原始类型不能分配，`null`但包装器类型可以。这就是原因，具有不同类型的其他单元格，例如`String`，`String`也可以分配给`null`。

# c - 如何在 Windows 中获取 PCI 区域大小？

> ID：13278981
> 
> 赞同：8
> 
> 时间：2012-11-07T21:58:02.507
> 
> 标签：c, windows, size, regions, pci

我需要扫描我的 PCI 总线并从特定供应商处获取特定设备的信息。我的目标是找到 AMD 显卡的 PCI 区域大小，以便将该卡的 PCI 内存映射到用户空间，以便进行 i2c 传输并查看来自各种传感器的信息。

为了扫描 PCI 总线，我在一年前下载并编译了适用于 Windows x64 的 pciutils 3.1.7。据说它使用 DirectIO。

这是我的代码。

```
int scan_pci_bus()
{
    struct pci_access *pci;
    struct pci_dev *dev;
    int i;

    pci = pci_alloc();
    pci_init(pci);

    pci_scan_bus(pci);

    for(dev = pci->devices; dev; dev = dev->next) 
    {
        pci_fill_info(dev, PCI_FILL_IDENT | PCI_FILL_CLASS | PCI_FILL_IRQ | PCI_FILL_BASES | PCI_FILL_ROM_BASE | PCI_FILL_SIZES | PCI_FILL_PHYS_SLOT);
        if(dev->vendor_id == 0x1002 && dev->device_id == 0x6899)
        {
            //Vendor is AMD, Device ID is a AMD HD5850 GPU
            for(i = 0; i < 6; i++) 
            {
                printf("Region Size %d %x ID %x\n", dev->size[i], dev->base_addr[i], dev->device_id);
            }
        }
    }

    pci_cleanup(pci);

    return 0;
} 
```

正如您在我的 printf 行中看到的那样，我尝试打印一些数据，我正在成功打印`device_id`，`base_addr`但是`size`应该包含此设备的 PCI 区域大小始终为 0。我预计，循环中至少有一个循环显示大小 > 0。

我的代码基于使用相同代码的 Linux 应用程序，尽管它使用 Linux 附带的 pci.h 标头（pciutils 显然具有相同的 API）。显然，Windows（在我的情况下是 Windows 7 x64）没有显示此信息，或者至少没有暴露给 PCIUtils。

你建议我如何获得这些信息？如果有 Windows 的 pciutils 的替代品并提供此信息，我很高兴获得它们的链接。

编辑：我仍然没有找到解决方案。如果我的问题有任何解决方案并且也适用于 32 位 Windows，我们将不胜感激。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-22T23:42:18.360

这是如何工作的非常复杂。PCI 设备用于`Base Address Registers`让 BIOS 和操作系统决定其内存区域的位置。每个 PCI 设备都可以指定它想要的几个内存或 IO 区域，并让 BIOS/OS 决定将其放置在哪里。使事情复杂化的是，只有一个寄存器用于指定大小和地址。这是如何运作的？

当卡第一次上电时，它的 32 位地址寄存器中会有类似 0xFFFF0000 的内容。任何二进制 1 表示“操作系统可以改变它”，任何二进制 0 表示“必须保持零”。所以这告诉操作系统，前 16 位中的任何一个都可以设置为操作系统想要的任何值，但后 16 位必须保持为零。这也意味着这个内存区域占用了 16 位地址空间，即 64k。因此，内存区域必须与其大小对齐。如果一张卡需要 64K 的地址空间，操作系统只能将它放在 64K 的倍数的内存地址上。当操作系统决定了它想在哪里定位这张卡的 64K 内存空间时，它会将它写回这个寄存器，覆盖那里的初始 0xFFFF0000。

换句话说，卡告诉操作系统它需要内存的大小/对齐方式，然后操作系统用内存地址覆盖相同的寄存器/变量。完成此操作后，您无法在不重置地址的情况下从寄存器中恢复大小。

这意味着没有可移植的方式来询问一张卡它的区域有多大，你只能问它的区域在哪里。

那么为什么这在 Linux 中有效呢？因为它正在向内核询问这些信息。内核有一个 API 来提供这些东西，与 lspci 的工作方式相同。我不是 Windows 专家，但我不知道应用程序以任何方式向 Windows 内核询问此信息。可能有一个 API 可以以某种方式执行此操作，或者您可能需要编写一些在内核端运行的东西以将此信息传回给您。如果您查看 libpci 源代码，对于 windows，它调用 pci_fill_info() 的“通用”版本，它返回：

```
return flags & ~PCI_FILL_SIZES; 
```

这基本上意味着“我将退回您要求的所有东西，但尺寸除外。”

但是，无论如何这可能无关紧要。如果您所做的只是想读/写 I2C 寄存器，它们通常（总是？）在控制/配置区域的前 4K 中。您可能只映射 4K（一页）而忽略可能有更多的事实。另请注意，您可能需要采取其他步骤来阻止此卡的真正驱动程序在您处于读取/写入状态时进行读取/写入。如果您手动对 I2C 总线*进行位敲击*，并且驱动程序同时尝试这样做，则可能会导致总线混乱。

也可能有一种现有的方法可以让 radeon 驱动程序为您执行 I2C 请求，这可能会避免所有这些。

（另请注意，我正在简化和掩盖 BAR 如何工作的许多细节，包括 64 位地址、I/O 空间等，如果您想了解更多信息，请阅读 PCI 文档）

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-12T16:22:35.937

好吧 whamma 给出了一个很好的答案 [但是] 他错了一件事，那就是区域大小。区域大小很容易找到，这里我将展示两种方法，第一种是从栏的地址中破译它，第二种是通过 Windows 用户界面。

假设 E2000000 是基址寄存器的地址。如果我们将其转换为二进制，我们得到： 111000100000000000000000000000000

现在这里总共有 32 位，如果需要，您可以计算它们。现在，如果您不熟悉 BAR 中的位是如何布局的，请看这里 -> [http://wiki.osdev.org/PCI](http://wiki.osdev.org/PCI)，特别是“基地址寄存器”，更具体地说是读取“内存空间 BAR”的图像布局”。现在让我们开始从右端到左端读取位，并使用我在上面指向您的链接中的图像作为指南。

所以从右边开始的第一位（Bit 0）是0，表示这是一个内存地址BAR。Bits(1-2) 为 0，表示它是一个 32 位（注意这不是大小）内存条。第 3 位为 0，表示它不是 Prefetchable 内存。位 4-31 代表地址。

该页面记录了 PCI 批准的流程：

> 要确定 PCI 设备所需的地址空间量，您必须保存 BAR 的原始值，将全 1 的值写入寄存器，然后将其读回。然后可以通过屏蔽信息位、执行按位非（C 中的“~”）并将值增加 1 来确定内存量。然后应该恢复 BAR 的原始值。BAR 寄存器自然对齐，因此您只能修改设置的位。

另一种方法是使用设备管理器：开始->“设备管理器”->显示适配器->右键单击您的视频卡->属性->资源。每个标记为“内存范围”的资源类型都应该是一个内存条，正如您所见，它表示 [起始地址] 到 [结束地址]。例如，假设它读取 [00000000E2000000 - 00000000E2FFFFFF]，以从 [结束地址] 获取 [起始地址] 的大小：00000000E2FFFFFF - 00000000E2000000 = FFFFFF，十进制的 FFFFFF = 16777215 = 16777215 字节 = 16。

# emacs - 在 .csv 文件中设置 Emacs 变量以启动 org-mode

> ID：13278997
> 
> 赞同：3
> 
> 时间：2012-11-07T21:59:16.577
> 
> 标签：emacs, org-mode

`org-mode`如果我打开这个特殊文件，我希望 Emacs 24 启动`.csv`，但 id 不起作用

### 数据.csv

```
| fruit  | stock |
| apple  | 1230  |
| banana |  200  |

# 
# eval: (org-mode)
# mode: org-mode
# End: 
```

我一定是误解了文件末尾的变量机制。如果我能告诉 Emacs**不要以**同样的方式换行，那就太好了。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-07T22:04:57.117

您需要使用该行开始变量块`Local Variables:`

```
| fruit  | stock |
| apple  | 1230  |
| banana |  200  |

# Local Variables:
# eval: (org-mode)
# mode: org-mode
# End: 
```