# StackOverflow 问答 14258000-14258999

# scheme - 方案缺点和长度

> ID：14258000
> 
> 赞同：2
> 
> 时间：2013-01-10T12:29:59.127
> 
> 标签：scheme, maxlength, cons

我正在研究方案，我刚刚遇到了我的第一个问题：

```
(define x (cons (list 1 2) (list 3 4)))
(length x)
3 
```

为什么输出是 3 而不是 2？我已显示 x

```
((1 2) 3 4) 
```

为什么是这样而不是`((1 2) . (3 4))`？

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-10T12:42:16.137

也许这样更容易看到。

你有：

```
(cons (list 1 2) (list 3 4)) 
```

如果你

```
(define one-two (list 1 2)) 
```

你有

```
(cons one-two (list 3 4)) 
```

这相当于

```
(cons one-two (cons 3 (cons 4 '()))) 
```

或者

```
(list one-two 3 4) 
```

这是

```
((1 2) 3 4) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-12T10:01:37.730

List是scheme的基本数据结构。Cons 用于制作一对对象。清单是一连串的缺点。例如。列表 (1 2 3 4) 与 (cons 1(cons 2(cons 3(cons 4 '())))) 相同。请参阅块指针表示以使其清楚

# c# - 如果我有 MDIParent，如何创建全局变量？

> ID：14258002
> 
> 赞同：1
> 
> 时间：2013-01-10T12:30:07.473
> 
> 标签：c#, .net, visual-studio-2010

我正在尝试开发一个应用程序，在该应用程序上我有一个`MDIParent`和几个`MDIchilds`. 我想在 my 上创建一个全局变量`MDIParent`，并且我希望该变量可以从其子级访问。

我怎样才能做到这一点？？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-10T12:41:51.083

如果 Matthew Watson 的答案不是您想要的……

如果您只是希望特定 MDI 父窗体的子窗体可以访问您的“全局”变量，那么只需在其上使用常规实例属性。孩子们将能够通过`child.MdiParent.MyVariable`（在转换`MdiParent`为适当的类型之后）访问它。例如：

```
class ParentForm
{
    public int MyVariable
    {
        return 1;
    }
}

class ChildForm
{
    public void MyMethod()
    {
        var parent = this.MdiParent as ParentForm;
        foo = parent.MyVariable;
    }
} 
```

* * *

快速说明：通常最好尽可能避免使用“全局”变量（即静态字段/属性）。将程序状态的所有不同部分限制在适当的上下文中以减少耦合。见得[墨忒耳法则](https://en.wikipedia.org/wiki/Law_of_Demeter)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-10T12:35:27.257

C# 中的全局变量实际上是一个静态字段或属性。

所以只需向 MDIParent 添加一个公共静态属性：

```
public static int MyGlobalInt
{
    get
    {
        return 42;
    }
} 
```

这将在 MDIParent 的所有实例之间共享。如果这不是你的意思，那么它不是你想要的全局。

# silverlight - 如何解决 MVVM Light NuGet Silverlight 5 与 Microsoft.Practices.ServiceLocation DLL 的冲突

> ID：14258004
> 
> 赞同：3
> 
> 时间：2013-01-10T12:30:16.330
> 
> 标签：silverlight, mvvm-light, nuget, caliburn.micro

我们有一个 Silverlight 5 项目，我们目前有一个共享库 DLL 的文件夹。我们正在尽可能将 NuGet 用于这些库。

我们想要使用的 NuGet 包之一是 MVVMLight，以替换我们当前使用的 MVVM Light SL4 DLL，当我们从 SL4 迁移到 SL5 时，这些 DLL 从未升级。

但是，当我们安装包含 SL5 DLL 的 NuGet 包时，它会自动将我们对 Microsoft.Practices.ServiceLocation DLL 文件的现有引用更改为与 MVVM Light 包一起提供的文件，该文件具有相同的版本号，但公钥不同。

这导致与我们使用 Prism 库的其他一些代码发生冲突，该库使用 Microsoft.Practices.ServiceLocation DLL，但使用原始公钥签名。

显然，我们不能在同一个文件夹中两次使用相同命名的 DLL，因此，关于如何解决此问题的任何建议，同时保持从 NuGet 安装的 Prism 和 MVVM Light 包。

非常感谢，

马丁。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-12T16:32:23.297

我对 Microsoft.Practices.ServiceLocation.dll 有完全相同的问题。[在我的情况下，如果 MvvmLight 的 nuget 包依赖于CommonServiceLocator](http://nuget.org/packages/CommonServiceLocator)，这可以解决，正如我在这里建议的那样：http: [//mvvmlight.codeplex.com/discussions/429311](http://mvvmlight.codeplex.com/discussions/429311)

到目前为止，还没有这方面的消息。

编辑：Laurent 只需使用 Nuget 的 CommonServiceLocator 推送一个版本的 MVVM Light。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-17T04:14:21.723

Portable.CommonServiceLocator NuGet 包包含现有的签名 CSL 二进制文件以及支持 windows 8、.net 4.5 等的 PCL 二进制文件。仍在等待 Microsoft 将 PCL 包含在其官方软件包中，但二进制文件与我提到的那个相同。

您也可以尝试使用 PCL 版本的 Portable.MvvmLightLibs。它支持所有框架（WP7.5+、.NET 4.5、Store、SL4+）并使用微软官方签署的 CSL 库。

# sql - 在 SQL Server 中明智地获取 Total Branch

> ID：14258005
> 
> 赞同：1
> 
> 时间：2013-01-10T12:30:16.773
> 
> 标签：sql, sql-server, sql-server-2008

```
SELECT  b.BranchName ,
        pm.AgreementValue
FROM    dbo.Member AS m
        INNER JOIN dbo.PlanMaster AS pm ON ( m.PlanId = pm.PlanId )
        INNER JOIN dbo.Branch AS b ON ( b.BranchId = m.BranchId ) 
```

这是上述查询的结果

```
BranchName      AgreementValue
------------------------------
abc             60000.00
abc             36000.00
abc             36000.00
xyz             20000.00
xyz             10000.00 
```

现在我想明智地了解 AgreementValue BranchName 的总数..感谢您的帮助

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-10T12:32:23.547

`GROUP BY b.BranchName`像`SUM`这样：

```
SELECT   b.BranchName ,
         SUM(pm.AgreementValue) TotalValue
FROM     dbo.Member AS m
         INNER JOIN dbo.PlanMaster AS pm ON ( m.PlanId = pm.PlanId )
         INNER JOIN dbo.Branch AS b ON ( b.BranchId = m.BranchId )
GROUP BY b.BranchName; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-10T14:40:38.583

如果您尝试获取每一行的总数，请使用窗口函数`sum()`：

```
SELECT  b.BranchName ,
        pm.AgreementValue,
        sum(pm.AgreementValue) over (partition by b.BranchName) as BranchTotal
FROM    dbo.Member AS m
        INNER JOIN dbo.PlanMaster AS pm ON ( m.PlanId = pm.PlanId )
        INNER JOIN dbo.Branch AS b ON ( b.BranchId = m.BranchId ) 
```

# c# - 检查 Active Directory 服务器上的密码重置

> ID：14258007
> 
> 赞同：0
> 
> 时间：2013-01-10T12:30:20.067
> 
> 标签：c#, active-directory

我需要通过我的 .Net 应用程序重置任何用户的 Windows 密码。我正在使用用户的用户名从 AD 服务器获取其目录条目。我有这两种不同的更改密码的方法：

```
entry.Invoke("ChangePassword", oldPass, newPass); 
```

&

```
entry.Invoke("SetPassword", "pass@123"); 
```

但是在实时 AD 服务器上尝试这些方法时出现以下错误：

```
Access is denied. (Exception from HRESULT: 0x80070005 (E_ACCESSDENIED)) 
```

我有 2 个 AD 服务器。其中一个是实时的，另一个是用于测试目的。我只想检查我的代码是否正常工作。由于实时服务器上的访问被拒绝，我无法更改并稍后通过代码检查我自己的密码。如果我使用测试AD服务器更改密码，我不知道如何检查密码是否被更改。请提供任何建议以检查我的代码是否正常工作。提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-20T18:21:50.040

I think you're not getting a proper context setup before you call the invoke. Here's what I use for something similar. You'll need to set your own variables:

I'm using `System.DirectoryServices.AccountManagement` to get the functions.

```
//Domain related info
string _DCToUse = "myserver.domain.local";
string _ADConDomain = "DC=domain,DC=local";
string _AdDomain = "domain";
string _ADAdminUser = "administrator";
string _ADAdminPass = "password";

//User specific
string _UserName = "jsmith";
string _CurrentPass = "oldPass";
string _NewPass = "newPass";

    PrincipalContext principalContext =
      new PrincipalContext(ContextType.Domain, _DCToUse,
      _ADConDomain, _ADDomain+@"\"+_ADAdminUser, _ADAdminPass);
    UserPrincipal user = UserPrincipal.FindByIdentity(principalContext, _UserName);

        if (user == null)
        {
             string ADErrorMsg = "Couldn't find user, check your spelling.";
             return Changed;
        }

        user.ChangePassword(oldPass, newPass);
        user.Save(); 
```

# comet - Comet Technology 和 SignalR 有什么区别

> ID：14258011
> 
> 赞同：5
> 
> 时间：2013-01-10T12:30:34.090
> 
> 标签：comet, signalr

我搜索得非常糟糕......谁能告诉我，SignalR 和 Comet 技术之间的确切区别是什么......我知道 Comet 与 SignalR 进行相同的客户端-服务器通信......它将数据推送到客户端就像SignalR，那么这2个有什么区别。请帮忙。

谢谢！！！希瓦南德·阿鲁尔。

# php - 用引号格式化数组的键

> ID：14258012
> 
> 赞同：0
> 
> 时间：2013-01-10T12:30:36.303
> 
> 标签：php, sql, arrays

我有一个这样的数组：

```
Array ( [0] => bag [1] => resource [2] => 120 [3] => little dog [4] => 700.25 ... 
```

是否有可能一个函数在字符串中返回带有引号的每个键，如果是数字则不带引号，例如

```
'bag','resource',120,'little dog',700.25 ... 
```

谢谢你的帮助！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-10T12:34:12.990

您可以尝试：

```
$input  = array('bag', 'resource', 120, 'little dog');
$output = trim(json_encode($input), '[]'); 
```

或基于`@Rajat Garg`解决方案：

```
$input  = array('bag', 'resource', 120, 'little dog');
$data   = array();
foreach ( $input as $value ) {
  $data[] = is_numeric($value) ? $value : "'$value'";
}
$output = implode($data, ','); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-10T12:34:22.523

使用 is_numeric 来识别它是否是一个数字，否则连接引号：

```
foreach($array as $value){
    if(is_numeric($value)){
         echo $value;
      } else{
           echo "'".$value."'";
      }
 } 
```

# regex - 如何匹配重复但不相同的相似组

> ID：14258014
> 
> 赞同：1
> 
> 时间：2013-01-10T12:30:51.640
> 
> 标签：regex

我有许多与产品相关的字符串。这些中的每一个都有参考号，我想创建一个正则表达式，如果不止一次提到不同的参考号，它会拾取。因此，给出以下示例：

```
"AB01 MyProduct" >>> No match - because there is only one ID
"AB02 MyOtherProduct" >>> No match - because there is only one ID
"AB03 YetAnotherProduct" >>> No match - because there is only one ID
"AnAccessory for AB01, AB02, AB03 or AB101" >>> Matches!!
"AB02 MyOtherProduct, MyOtherProduct called the AB02" >>> No match - because the codes are the same 
```

谁能给我一个线索？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-10T12:38:38.920

如果您的正则表达式引擎支持[负前瞻](http://www.regular-expressions.info/lookaround.html)，这可以解决问题：

```
(AB\d+).*?(?!\1)AB\d+ 
```

如果有两个序列匹配`AB\d+`并且第二个序列与第一个序列不同（由负前瞻确保），则它匹配。

解释：

```
(           # start capture group 1
 AB         # match `AB` literally
 \d+        # match one or more digits
)           # end capture group one
.*?         # match any sequence of characters, non-greedy
(?!         # start negative lookahead, match this position if it does not match
 \1         # whatever was captured in capture group 1
)           # end lookahead
AB          # match `AB` literally
\d+         # match one or more digits 
```

测试（JavaScript）：

```
> var pattern = /(AB\d+).*?(?!\1)AB\d+/;
> pattern.test("AB01 MyProduct")
  false
> pattern.test("AnAccessory for AB01, AB02, AB03 or AB101")
  true
> pattern.test("AB02 MyOtherProduct, MyOtherProduct called the AB02")
  false 
```

# java - 这个片段是否会导致无限循环或其他？

> ID：14258016
> 
> 赞同：1
> 
> 时间：2013-01-10T12:30:54.760
> 
> 标签：java, android

仅在旧的 android 设备 (2.x) 上，我每次旋转模拟器时都会因 stackoverflow 导致崩溃。如果我评论“preferenze()”，模拟器不会崩溃，但应用程序不会保留新设置。这段代码可以创建一个无限循环吗？是不正确的代码吗？正确运行应该是什么？谢谢！

```
private boolean preferencesChanged;

    public void onCreate(Bundle savedInstanceState){ 
          super.onCreate(savedInstanceState);
          setContentView(R.layout.activity_main);

    private void preferenze() {

        SharedPreferences prefs = PreferenceManager.getDefaultSharedPreferences(getBaseContext());

        CheckboxPreference = prefs.getBoolean("checkboxPref", true);
        ListPreference = prefs.getString("listpref", "");
        numeronotifiche = prefs.getString("notify", "");
        Sound = prefs.getString("sound", "");
        barranotifiche = prefs.getBoolean("keep", false);
        natura = prefs.getBoolean("suoninaturasino", false);
        snatura = prefs.getString("suoninaturascelta", "");
        snaturaold = prefs.getString("snaturaoldvalue", "");

        if (snaturaold != snatura){
            stopService(new Intent(this, UnUsedService.class));

        }

        SharedPreferences prefs2 = getSharedPreferences(PRIVATE_PREF, 0);

        Editor editor10 = prefs2.edit();
        editor10.putString("snaturaoldvalue", snatura);
        editor10.commit();

        // suoni attivati (o no)

        if (natura){
            startService(new Intent(this, UnUsedService.class));
        }
        else {
            stopService(new Intent(this, UnUsedService.class));
        }

        if (barranotifiche){
            showNotification();
        }
            else {
                cancelNotification();
            }

        GestioneAllarme alarm = new GestioneAllarme();
        if (CheckboxPreference){
            if (numeronotifiche.equals("3")){
            alarm.CancelAlarm(this);
            alarm.SetAlarm3(this);
        }
            else if (numeronotifiche.equals("1")){
                alarm.CancelAlarm(this);
                alarm.SetAlarm1(this);
            }
            else if (numeronotifiche.equals("2")){
                alarm.CancelAlarm(this);
                alarm.SetAlarm2(this);
            }
            else {
//              
            }
        }
        else {
//            
            GestioneAllarme alarm2 = new GestioneAllarme();
            alarm2.CancelAlarm(this);
            }   

//        
        if (Sound.equals("")){
            Sound = "2";
            Editor editor = prefs.edit();
            editor.putString("sound", "2");
            editor.commit();
        }

        if (ListPreference.equals("")){
            ListPreference = "1500";

          Editor editor = prefs.edit();
          editor.putString("listpref", "1500");
          editor.putInt("indexfade", 1500);
          editor.commit();

        }

        if (numeronotifiche.equals("")){
            numeronotifiche = "2";
            Editor editor = prefs.edit();
              editor.putString("numeronotifiche", "2");
              editor.commit();
        }

        fade = Integer.parseInt(ListPreference);
        notify = Integer.parseInt(numeronotifiche);

        if (fade == 500){
            animazione = R.style.MyCustomTheme1;
            fadein = R.anim.fadein500;
            fadeout = R.anim.fadeout500;
        }
        else if (fade == 1000){
            animazione = R.style.MyCustomTheme2;
            fadein = R.anim.fadein1000;
            fadeout = R.anim.fadeout1000;
        }
        else if (fade == 1500){
            animazione = R.style.MyCustomTheme3;
            fadein = R.anim.fadein1500;
            fadeout = R.anim.fadeout1500;
        }
        else if (fade == 2000){
            animazione = R.style.MyCustomTheme4;
            fadein = R.anim.fadein2000;
            fadeout = R.anim.fadeout2000;

@Override
    protected void onResume() {
        super.onResume();
SharedPreferences sp = PreferenceManager.getDefaultSharedPreferences(this);
        listener = new SharedPreferences.OnSharedPreferenceChangeListener() {
public void onSharedPreferenceChanged(SharedPreferences sharedPreferences, String key) {
                    preferencesChanged = true;
                }            
        };
        sp.registerOnSharedPreferenceChangeListener(listener);

protected void onStop(){
        super.onStop();

        if(preferencesChanged){
            //Update the app
            preferenze();
        }
    }

public class Preferences extends PreferenceActivity implements OnSharedPreferenceChangeListener{
    @Override
    protected void onCreate(Bundle savedInstanceState) {
            super.onCreate(savedInstanceState);
            addPreferencesFromResource(R.layout.preferences);

    }

    @Override
    public void onSharedPreferenceChanged(SharedPreferences prefs, String listpref) { 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-10T12:36:07.500

> // 这里有几个 if/if else 来改变值

这些句子可能会更改共享首选项，这反过来会触发您的听众，而听众又会调用`preferenze`，...，等等。如果这种情况永远持续下去，就会抛出一个 SO。现在根据条件，该`preferenze`方法可能只读取但不修改任何内容。在这种情况下，循环将结束。

关于仅在 2.X 设备中观察到的错误，这可能是由于 4.x 设备更新且可能具有更多 RAM 内存。

* * *

更新：
代码仍然不完整。看起来有两个活动：您首先发布的活动和新的活动。我想（这就是我对您发布的代码所能做的全部）您必须`PreferenceActivity`显示设置并允许用户更改它们，并且侦听器可以根据新设置更新应用程序的其他部分。问题是当监听器被调用时，它本身会修改设置，而这又会再次调用监听器，这将再次修改首选项，以此类推。一旦堆内存不足，这将引发 SOException。

重新排列代码以解决此问题的一种方法是：

1.  `OnSharedPreferenceChangeListener`在您的活动中注册，`onResume`而不是`onCreate`在`onPause`方法中取消注册（调用`unregisterOnSharedPreferenceChangeListener`）。取消注册非常重要，因为我们不想在用户离开屏幕或系统重新创建活动时（例如当设备旋转时）监听更改：

    ```
     @Override
        public void onCreate(Bundle savedInstanceState){ 
            super.onCreate(savedInstanceState);
            setContentView(R.layout.activity_main);
            //We have removed the listener registration from here
        }

        @Override
        protected void onResume() {
            super.onResume();

            SharedPreferences sp = PreferenceManager.getDefaultSharedPreferences(this);
            listener = new SharedPreferences.OnSharedPreferenceChangeListener() {
                public void onSharedPreferenceChanged(SharedPreferences prefs, String   listpref) {       
                    //I'll show what to do here in point 2.
                }
            };
            sp.registerOnSharedPreferenceChangeListener(listener);
        }

        @Override
        protected void onPause() {
            super.onPause();

            SharedPreferences sp = PreferenceManager.getDefaultSharedPreferences(this);
            sp.unregisterOnSharedPreferenceChangeListener(listener);
        } 
    ```

2.  使用您当前的代码，每次用户更改单个设置时，`preferenze`都会调用该方法来更新应用程序。因此，如果它更改 5 个字段，则该方法被调用 5 次。我们现在可以做的是只检查一次更改。我假设您不在乎用户更改了多少字段，因为您只需要知道是否有更改。因此，在侦听器中`preferenze`，您可以将布尔标志设置为 true，而不是调用：

    ```
     public void onSharedPreferenceChanged(SharedPreferences sharedPreferences, String key) {
            preferencesChanged = true;
        } 
    ```

3.  好的，现在我们有一种方法可以判断设置是否已更改。当用户完成并且活动即将关闭时，方法`onPause`和`onStop`将`onDestroy`按此顺序调用。您可以使用其中一种方法来检查布尔标志，并且只有在发生更改时才更新应用程序。这样，如果用户更改了 1、3 或 20 个字段，我们将在最后只更新一次应用程序。您可以在 3 种方法中的任何一种中执行此操作，但在取消注册侦听器 ( `onPause`) 之后执行此操作非常重要，否则您将再次遇到问题。例子：

    ```
     protected void onStop(){
            super.onStop();
            ...

            if(preferencesChanged){
                //Update the app
                preferenze();
            }
        } 
    ```

你可能需要改变一些东西，但总的来说你明白了。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-10T12:38:15.823

似乎只要`preferenze()`始终修改共享首选项，您就会陷入无限循环。

由于您没有发布完整的代码，因此很难说。但我猜你的代码是这样的，它总是只在 android 2.x 上修改首选项

你可以尝试这样的事情来避免无限循环。

```
private boolean isPreferenzeRunning = false;
...
listener = new SharedPreferences.OnSharedPreferenceChangeListener() {
      public void onSharedPreferenceChanged(SharedPreferences prefs, String listpref) {       
            if(!isPreferenzeRunning)preferenze();
          }
   };
...
private void preferenze()
    isPreferenzeRunning = true;
    try{
       ...
    }finally{isPreferenzeRunning = false;}       
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-10T12:38:32.273

该代码甚至无法编译。

中的代码`preferenze()`将返回首选项值（布尔值、字符串、整数等），而不是首选项对象。通过更改该方法中的值，您还将导致`StackOverflowError`.

需要什么`OnSharedPreferenceChangeListener`？

# objective-c - NSTableCellViews 的自动布局系统是否不同？

> ID：14258020
> 
> 赞同：1
> 
> 时间：2013-01-10T12:31:18.407
> 
> 标签：objective-c, macos, cocoa, nstableview

我创建了一个`NStextField`扩展和收缩以适应文本变化的子类。这是代码：

```
- (NSSize)sizeToFitContent
{
    NSRect frame = [self frame];
    CGFloat width = frame.size.width;
    frame.size.height = CGFLOAT_MAX;
    CGFloat height = [self.cell cellSizeForBounds: frame].height;
    return NSMakeSize(width, height);
}

- (void)textDidChange:(NSNotification *)aNotification
{
    [super textDidChange:aNotification];
    [(NSCell *)self.cell title];
    NSSize newSize = [self sizeToFitContent];
    if (newSize.height != self.frame.size.height) {
        [self invalidateIntrinsicContentSize];
    }
}

- (NSSize)intrinsicContentSize
{
    if ( ![self.cell wraps] ) {
        return [super intrinsicContentSize];
    }
    return [self sizeToFitContent];
} 
```

我已经验证了该控件在几个项目中执行了我希望它执行的操作。最近我试图将控件放在 a 中`NSTableCellView`，但它停止了工作。如果我以编程方式设置控件的 stringValue，则控件会正确更改其大小。但是，如果我从控件中键入或删除文本，它不会在需要换行时调整大小。我真的无法弄清楚为什么控件在这两种情况下的行为不同？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-10T19:12:31.247

我相信你需要实施

```
- (CGFloat)tableView:(NSTableView *)tableView heightOfRow:(NSInteger)row 
```

在你的[NSTableViewDelegate](http://developer.apple.com/library/mac/#documentation/cocoa/reference/NSTableViewDelegate_Protocol/Reference/Reference.html)中。

# c++ - 将现有的 QTcpSocket 变形为 QSslSocket

> ID：14258022
> 
> 赞同：6
> 
> 时间：2013-01-10T12:31:24.743
> 
> 标签：c++, qt, qtcpsocket, qsslsocket

是否可以创建一个新的 QSslSocket 并让它接管现有的 TCP 连接，并丢弃旧的 QTcpSocket，而不中断或关闭 TCP 连接？

我需要它来在我的 FTP 服务器中实现显式 FTPS，这要求最初连接是未加密的，并且只有在 FTP 客户端的请求（命令`AUTH SSL`或`AUTH TLS`）时，如果它出现，就会启动 SSL/TLS 握手。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-10T13:31:57.267

是的，这是可能的。最简单的方法是将 替换`QTcpSocket`为`QSslSocket`. 在您`QSslSocket`调用. 之后，它将像正常一样运行，但所有通信都在后台加密。`QTcpSocket``startClientEncryption``QSslSocket``QTcpSocket`

使用它，我实际上能够在不到一小时的时间内移植一个超过 100k 行的项目以使用 SSL。

# 编辑

在未加密模式下使用没有（真正的）开销，`QSslSocket`因为它只会调用相应的`QTcpSocket`方法。例如读取方法（`qsslsocket.cpp`Qt 4.8.3）：

```
if (d->mode == UnencryptedMode && !d->autoStartHandshake) {
    readBytes = d->plainSocket->read(data, maxlen);
} else {
//encryption stuff 
```

# uitableview - 向 UISearchResults UITableView 添加手势

> ID：14258024
> 
> 赞同：1
> 
> 时间：2013-01-10T12:31:40.253
> 
> 标签：uitableview, ios4, uisearchbar, ios5, uisearchresultscontroller

目前我的应用程序有手势，如果您按住 UITableView 单元格，您可以编辑单元格中的对象，如果您点击单元格，则可以查看单元格中的对象。该部分工作得很好，但是当用户使用 UISearchBar 时，结果表没有相同的手势。

我应该将相同的手势添加到 initWithNibName 的 else 部分吗？

```
- (id)initWithNibName:(NSString *)nibNameOrNil bundle:(NSBundle *)nibBundleOrNil
{
    self = [super initWithNibName:nibNameOrNil bundle:nibBundleOrNil];
    if (self) {
        self.title = NSLocalizedString(@"AutoNotes2", @"AutoNotes2");
        if ([[UIDevice currentDevice] userInterfaceIdiom] == UIUserInterfaceIdiomPad) {
            self.clearsSelectionOnViewWillAppear = NO;
            self.contentSizeForViewInPopover = CGSizeMake(320.0, 600.0);
        }
        else {
            UIImageView *tempImageView = [[UIImageView alloc] initWithImage:[UIImage imageNamed:@"Concrete.png"]];
            [tempImageView setFrame:self.tableView.frame]; 

            self.tableView.backgroundView = tempImageView;
            self.searchDisplayController.searchResultsTableView.backgroundView = tempImageView;
        }
    }
    return self;
}

- (void)viewDidLoad
{
    [super viewDidLoad];

    UITapGestureRecognizer *doubleTap = [[UITapGestureRecognizer alloc] initWithTarget:self action:@selector(handleDoubleTap)];

    doubleTap.numberOfTapsRequired = 2;
    [self.view addGestureRecognizer:doubleTap];

    // Two finger, double tap
    UITapGestureRecognizer *twoFingerDoubleTap = [[UITapGestureRecognizer alloc] initWithTarget:self action:@selector(handleTwoFingerDoubleTap:)];

    twoFingerDoubleTap.numberOfTapsRequired = 1;
    twoFingerDoubleTap.numberOfTouchesRequired = 2;
    [self.tableView addGestureRecognizer:twoFingerDoubleTap];

    UILongPressGestureRecognizer *lpgr = [[UILongPressGestureRecognizer alloc] initWithTarget:self action:@selector(handleLongPress:)];
    lpgr.minimumPressDuration = 1.0; //seconds
    //lpgr.delegate = self;
    [self.tableView addGestureRecognizer:lpgr];

} 
```

# java - hashCode() 在 java 中的行为

> ID：14258027
> 
> 赞同：-4
> 
> 时间：2013-01-10T12:31:44.367
> 
> 标签：java

今天我正在尝试下面的代码，并期望两个 sysout 的输出不同。

```
public class StringDemo {

    public static void main(String[] args) {
        String s1 = new String("Hi");
        String s2 = new String("Hi");       
        System.out.println(s1.hashCode());
        System.out.println(s2.hashCode());
    }

} 
```

但我得到了相同的价值。任何人都可以解释一下事情是如何运作的吗？

谢谢， 苏拉夫

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-10T12:33:17.857

`String`有自己的`hashCode()`（谢天谢地）实现，它基于`String`. 也就是说，如果你有两个相等的字符串（不管它们是如何创建的），你最终会得到相同的`hashCode()`.

这是[JDK 7](http://grepcode.com/file/repository.grepcode.com/java/root/jdk/openjdk/7-b147/java/lang/String.java#String.hashCode())（简化）的[实现：`String.hashCode()`](http://grepcode.com/file/repository.grepcode.com/java/root/jdk/openjdk/7-b147/java/lang/String.java#String.hashCode())

```
public int hashCode() {
    int off = offset;
    char val[] = value;
    int len = count;

     for (int i = 0; i < len; i++) {
         h = 31*h + val[off++];
    }
    return h;
} 
```

如您所见，它仅基于`String`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-10T12:34:32.137

String的`hashCode()`规范由 JLS 规定，完全基于 String 的字符。它对于所有版本的 java 和所有 JVM 启动都是可预测和一致的。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-10T12:35:20.777

来自[http://docs.oracle.com/javase/1.4.2/docs/api/java/lang/String.html#hashCode%28%29](http://docs.oracle.com/javase/1.4.2/docs/api/java/lang/String.html#hashCode%28%29)

```
public int hashCode()

    Returns a hash code for this string. The hash code for a String object is computed as

         s[0]*31^(n-1) + s[1]*31^(n-2) + ... + s[n-1]

    using int arithmetic, where s[i] is the ith character of the string, n is the length of the string, and ^ indicates exponentiation. (The hash value of the empty string is zero.)

    Overrides:
        hashCode in class Object

    Returns:
        a hash code value for this object. 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-10T12:33:13.650

String 实现 hashCode 的方式是，对于相同的字符串，它将返回相同的 hashCode - 请注意，这对于没有实现 hashCode 的对象是不同的 - 它们通常为 hashCode 返回不同的值。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-01-10T12:36:43.867

从字符串的源代码，

String 对象的哈希码计算为

```
 s[0]*31^(n-1) + s[1]*31^(n-2) + ... + s[n-1] 
```

使用 int 算术，其中 s[i] 是字符串的第 i 个字符，n 是字符串的长度，^ 表示求幂。（空字符串的哈希值为零。）

# jquery - Jquery 1.4.2 和 1.8.3 的区别？

> ID：14258028
> 
> 赞同：-1
> 
> 时间：2013-01-10T12:31:47.050
> 
> 标签：jquery, html

我正在尝试在我的网站上实现 html5advent 日历。日历是使用`jquery-min 1.4.2`. 在我的网站中，我有很多 jquery ui 插件，所以我想使用`jquery-min 1.8.3`.

我正在工作的链接是`<a href="01">`。当我单击链接时。链接在 Firefox 中没有问题。但是铬/铬链接不起作用，控制台抛出了我`" Uncaught Error: Syntax error, unrecognized expression: a[href=#day.1] "`

错误代码的来源是以下几行

```
 $.each(PINT.calendarInfo, function() {
                PINT_calendarActivateDay($('a[href=#day' + this.toString() + ']'), false);
            }); 
```

如果我使用 1.4.2 日历可以正常工作，但其他插件停止工作。可以进行哪些更改以使其正常工作？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-10T12:32:57.777

您需要引用属性值。

```
$.each(PINT.calendarInfo, function() {
    PINT_calendarActivateDay($('a[href="#day' + this.toString() + '"]'), false);
}); 
```

# php - 使用 Amazon s3 上传视频和提取缩略图

> ID：14258033
> 
> 赞同：3
> 
> 时间：2013-01-10T12:32:03.483
> 
> 标签：php, video, upload, amazon-s3, thumbnails

我一直在一个视频网站 [平台：php] 工作，我需要在 Amazon S3 服务器中上传视频并提取缩略图。

我已经创建了一个存储桶并在该存储桶中成功上传了视频文件。但我不知道如何从上传的视频中提取缩略图。所以，这就是我坚持的地方。

任何帮助将不胜感激。提前致谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-10T12:54:40.140

在这里，您有一些选择。

**首先**- 您可以在将视频上传到 AWS 之前从视频中“提取”缩略图。例如：将视频上传到您的服务器，如果需要将其转换为适当的格式，拍摄一个（或多个缩略图），将它们保存在某个地方（例如，在 S3 或您的本地服务器上），然后将视频上传到 S3。这种方法的缺点是您的本地服务器将不得不做很多额外的工作，而不是为您的网络访问者提供服务。

**其次**- 您可以为此使用 Amazon EC2 计算服务：将视频上传到 S3，触发 EC2（例如使用 cron 作业）从 S3 获取视频，转换它，获取缩略图并将最终结果（转换后的视频 + 缩略图）上传回S3。缺点是：实现这种“通信”并不容易（你必须解决很多问题，比如确保稳定的转换、创建作业队列等），另外你还必须使用另外一项 AWS 服务S3。

视频转换和获取缩略图是怎么回事？有很多工具和程序可以做到这一点。我喜欢使用[ffmpeg](http://ffmpeg.org)进行视频转换（也有 PHP 包装器用于将其功能与 php - [php-ffmpeg](http://ffmpeg-php.sourceforge.net/)一起使用，但使用 ffmpeg 本身（例如使用 php 的*exec()*函数）将为您提供更多的灵活性和功能，请阅读文档以获取更多详细信息）。FFMpeg 也可以从视频中提取缩略图，但是这需要一些时间（关于如何有效地做到这一点有很多讨论），但我建议您为此目的使用[ffmpegthumbnailer 。](http://code.google.com/p/ffmpegthumbnailer)它的使用更简单，并且特别针对从视频文件中获取缩略图进行了优化。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-10T13:11:18.080

您应该在用于上传的机器上执行此操作。在这里，您可以直接通过文件系统访问该文件。一旦它在 S3 中，它就只能通过 HTTP 访问。

[ffmpeg](http://ffmpeg.org/trac/ffmpeg/wiki/Create%20a%20thumbnail%20image%20every%20X%20seconds%20of%20the%20video)工具可用于创建多种视频格式的缩略图。

例子：

```
ffmpeg -i "video.flv" -ss 00:00:10 -f image2 "thumbnail.jpg" 
```

将在视频秒 10 处创建一个缩略图并将其保存为 thumbnail.jpg 使用 PHP 时，您可以使用它`system`来执行

# c# - 从代码隐藏中刷新按钮单击上的更新面板

> ID：14258034
> 
> 赞同：2
> 
> 时间：2013-01-10T12:32:08.190
> 
> 标签：c#, asp.net, updatepanel

我正在使用使用数据源和数据绑定的 Gridview。当我重新加载页面时，gridview 会更新，但我希望它在 buttonclick 上，但它对我不起作用。

更新面板内的gridview：

```
<asp:ScriptManager ID="ScriptManager1" runat="server">
    </asp:ScriptManager>
    <asp:UpdatePanel ID="upWall" runat="server" ChildrenAsTriggers="true" UpdateMode="conditional">
        <ContentTemplate>
            <asp:GridView ID="gvWallPosts" runat="server" AutoGenerateColumns = "false" 
             CaptionAlign="NotSet" CellPadding="5">
            <Columns>
                <asp:TemplateField HeaderText="Avsändare">
                    <ItemTemplate>
                        <%# GetSender((int)Eval("WallSender"))%>
                        <br />
                    </ItemTemplate>
                </asp:TemplateField>
                <asp:TemplateField HeaderText="Inlägg">
                    <ItemTemplate>
                        <%# Eval("Post")%>
                        <br />
                    </ItemTemplate>
                </asp:TemplateField>
            </Columns>
            </asp:GridView>
        </ContentTemplate>
    </asp:UpdatePanel>
    <asp:TextBox ID="txtWall" runat="server" Height="105px" TextMode="MultiLine" Width="227px"></asp:TextBox>
    <br />
    <asp:Button ID="btnWall" runat="server" Text="Posta" onclick="btnWall_Click" /> 
```

代码隐藏：

```
protected void btnWall_Click(object sender, EventArgs e)
    {
        con.SendWallPost(con.GetId(Membership.GetUser().UserName), Convert.ToInt32(Request.QueryString["ID"]), txtWall.Text); //This method is sending the post
        upWall.Update();
    } 
```

所以，我希望在 ButtonClick 上更新 updatepanel，我不想重新加载整个页面来查看结果

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-01-10T12:41:26.053

由于我没有看到按钮`btnWall`，我认为它在`UpdatePanel`. 但是，如果要允许 an 之外的控件`UpdatePanel`触发回发，则需要定义显式触发器。

因此，您可以使用`AsyncPostBackTrigger`：

```
<asp:UpdatePanel ID="upWall" runat="server" ChildrenAsTriggers="true" UpdateMode="conditional">
     <ContentTemplate>
         ....
     </ContentTemplate>
     <Triggers>
        <asp:AsyncPostBackTrigger ControlID="btnWall" EventName="Click" />
     </Triggers>
 </asp:UpdatePanel> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-10T13:18:02.650

默认情况下，部分页面更新在更新面板中启用，因为 ScriptManager 控件的 EnablePartialRendering 属性的默认值为 true。将按钮放在更新面板中就足以满足您的需求，因为按钮充当异步面板内的回发控件。然后在更新后添加此行（gvWallospts.Databind()）。让我知道它是如何进行的。

```
protected void btnWall_Click(object sender, EventArgs e)
{
    con.SendWallPost(con.GetId(Membership.GetUser().UserName), Convert.ToInt32(Request.QueryString["ID"]), txtWall.Text); //This method is sending the post
    //upWall.Update();
    gvWallPosts.DataBind();
} 
```

**尝试像这样设置你的标记**

```
 <asp:ScriptManager ID="ScriptManager1" runat="server">
   </asp:ScriptManager>
      <asp:UpdatePanel ID="upWall" runat="server" ChildrenAsTriggers="true" UpdateMode="conditional">
    <ContentTemplate>
        <asp:GridView ID="gvWallPosts" runat="server" AutoGenerateColumns = "false" 
         CaptionAlign="NotSet" CellPadding="5">
        <Columns>
    <asp:Templatefield>
   <asp:Button ID="btnWall" runat="server" Text="Posta" command="Edit" />
     </asp:TemplateField>
            <asp:TemplateField HeaderText="Avsändare">
                <ItemTemplate>
                    <%# GetSender((int)Eval("WallSender"))%>
                    <br />
                </ItemTemplate>

                <EditItemTemplate>

                      <asp:TextBox Text='<%# Bind("WallSender")%>' />
                </EditItemTemplate>

            </asp:TemplateField>
            <asp:TemplateField HeaderText="Inlägg">
                <ItemTemplate>
                    <%# Eval("Post")%>
                    <br />
                </ItemTemplate>
                   <EditItemTemplate>

                     <asp:TextBox  Text='<%# Bind("Post")%>'/>
                </EditItemTemplate>
            </asp:TemplateField>
        </Columns>
        </asp:GridView>
    </ContentTemplate>
</asp:UpdatePanel> 
```

在您的网格行更新事件中

```
 protected void GridView1_RowUpdating(object sender, GridViewUpdateEventArgs e)
{

    con.SendWallPost(con.GetId(Membership.GetUser().UserName),    Convert.ToInt32(Request.QueryString["ID"]), txtWall.Text); 
     gvWallPosts.DataBind();

} 
```

确保页面加载中的绑定代码也被此夹在中间

```
 If(!IsPostBack)
     {
                   } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-10T12:54:01.350

您应该按照 Tim Schmelter 的建议将按钮放在更新面板中，或者定义一个显式触发器以在按钮单击事件上更新更新面板。

# orchardcms - 在 Orchard 中将站点用户与管理员用户分开存储

> ID：14258040
> 
> 赞同：1
> 
> 时间：2013-01-10T12:32:33.450
> 
> 标签：orchardcms

我刚刚开始使用基于 Orchard 的网站，并且有一个与用户帐户和身份验证相关的问题。

将有各种类型的**站点管理员/编辑**负责更新站点的内容。对于这些类型的用户，Orchard 中的内置角色和用户管理非常适合。但是，常规**站点用户**必须存储在**外部遗留系统**中，不应访问站点仪表板，并且即使对管理员也不应在仪表板的“用户”选项卡下可见（它们完全由外部系统管理） .

在果园实现这一点的正确方法是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-10T17:28:44.993

实施您自己的会员服务提供商。您可以从库中获取执行身份验证的示例，例如 oAuth 或 AD 模块。

# vim - 无法使用 Ruby 和 Python 支持构建 Vim

> ID：14258041
> 
> 赞同：4
> 
> 时间：2013-01-10T12:32:42.107
> 
> 标签：vim, configure

这是我遇到的一个奇怪问题-但我已经为此苦苦挣扎了一个多小时，但没有解决方案。我正在尝试配置 vim 构建，但在启用 python 和启用 ruby​​ 参数时不断遇到错误。

这是我正在尝试对相关错误部分执行的操作：

```
$ ./configure --prefix=/usr/local --with-features=huge --enable-pythoninterp --enable-rubyinterp
...
checking --enable-rubyinterp argument... yes
checking --with-ruby-command argument... defaulting to ruby
checking for ruby... (cached) /usr/bin/ruby
checking Ruby version... OK
checking Ruby rbconfig... RbConfig
checking Ruby header files... not found; disabling Ruby
...
checking --enable-pythoninterp argument... yes
checking for python2... (cached) /usr/bin/python2
checking Python version... (cached) 2.7
checking Python is 1.4 or better... yep
checking Python's install prefix... (cached) /usr
checking Python's execution prefix... (cached) /usr
(cached) checking Python's configuration directory... (cached) 
can't find it!
... 
```

我完全被难住了，我对 linux 还比较陌生，但尝试了一些不同的东西 - 都无济于事。帮助！

**编辑：**我正在运行 Mint 14

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-10T14:56:40.753

假设您想使用 Linux Mint 附带的 Ruby (1.8.7) 和 Python (??) 版本，您将需要它们各自的开发包。

```
sudo apt-get install ruby-dev python-dev 
```

完成后，您应该能够运行原始配置脚本

```
./configure --prefix=/usr/local --with-features=huge --enable-pythoninterp --enable-rubyinterp 
```

至于 Ruby，如果您使用的是 RVM 或 Rbenv 等环境管理器，则必须在配置行中指定，作为参数，以便配置脚本可以找到更新的 Ruby 标头。这方面的文档可以在[RVM](http://rvm.io)站点中找到。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-08-01T22:19:20.313

我刚刚让 Vim 在 Python 支持下编译（Arch Linux），除了 nathan 的回答之外，我还必须添加：

```
--with-python-config-dir=/path/to/python/conf 
```

到选项列表。出于某种原因，我不必这样做来获得 python3 支持。

我必须做的另一件事是更改 python 符号链接，使其指向 python2.7 可执行文件而不是 python3，因为显然它试图使用'python --version' 检查版本号并且它正在命中 python3 可执行文件并且不喜欢它返回的东西。如果 Mint 只使用 Ruby 1.8，你可能不会将 python3 安装为 python，所以你可能没有这个问题，但我认为值得一提。

# javascript - openerp web 客户端如何自定义字段（扩展基本字段小部件）

> ID：14258046
> 
> 赞同：5
> 
> 时间：2013-01-10T12:33:13.870
> 
> 标签：javascript, web, field, openerp

我是`openerp`网络开发的新手，我会很感激一些帮助。我想创建计数计时器小部件，例如在`textbox`带有开始和停止按钮的 中（包括在我的新自定义字段中或单独）。

我做了一个小`javascript`功能来计算时间。

我应该通过扩展 basic 创建一个新的小部件`FieldChar`吗？创建一个新类型的字段？

我在哪里放置我的计数器代码，以及如何在`char`字段（或新类型的字段）上显示它？

我找到了一些关于如何扩展的文档，例如`openerp.web.form.FieldChar`：

```
openerp.web_mymodule = function(openerp) {
  openerp.web.form.Field.include({
    init: function(view, node) {
        console.log('mine');
        this._super(view, node);
    }
  });
} 
```

`openerp's`即使与有关界面如何工作的文档一起，我也需要一些指导来将所有这些放在一起。

提前致谢

这是我所在的位置：模块：web_uptimer

web_uptimer.js：

```
openerp.web_uptimer = function (openerp)
{  
    openerp.web.form.widgets.add('uptimer', 'openerp.web_uptimer.CountUp');
    openerp.web_uptimer.CountUp = openerp.web.form.FieldChar.extend(
        {
        template : "uptimer.template",
        init: function (view, code) {
            this._super(view, code);
            console.log('counting...');
            alert('counting...');
        }
    });
} 
```

web_uptimer.xml：

```
<?xml version="1.0" encoding="UTF-8"?>
<templates id="template" xml:space="preserve">
<t t-name="uptimer.template">
            <html>
            </html>  
</t>
</templates> 
```

我的快速计数计时器测试：

```
<html>
    <head>
        <title></title>
        <script type="text/javascript">
            var counter = 0;
            var minutes = 0;
            var hours = 0;
            var timer;
            var todisplay;
            var h2disp;
            var m2disp;
            var s2disp;

            function countUP ()
            {
                counter = counter + 1;//increment the counter by 1
                if(counter == 60)
                {
                    counter = 0;
                    minutes = minutes + 1;
                    if(minutes == 60)
                    {
                        minutes = 0;
                        hours = hours + 1
                    }
                }
                if(counter < 10)
                {
                    s2disp = "0" + counter;
                }
                else
                {
                    s2disp = counter;
                }
                if(minutes < 10)
                {
                    m2disp = "0" + minutes;
                }
                else
                {
                    m2disp = minutes;
                }
                if(hours < 10)
                {
                    h2disp = "0" + hours;
                }
                else
                {
                    h2disp = hours;
                }
                todisplay = h2disp + ":" + m2disp + ":" + s2disp;
                document.getElementById("timer_container").innerHTML = todisplay;
            }
        </script>
    </head>
    <body onload='timer=setInterval("countUP()", 1000 );'>
        <div id="timer_container">00:00:00</div>
        <div>
            <button onclick='clearInterval(timer);'>Stop Timer</button>
            <button onclick='timer=setInterval("countUP()", 1000 );'>Continue Timer</button>
        </div>
    </body>
</html> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-28T20:19:03.817

我设法将我的计时器作为一个开放式操作进行试验，计时器计数，显示更新等......

现在我希望它成为一个可以在表单中使用的 openerp 字段：

我接近它，但按钮不再起作用。

这是我的代码：

模块名称是 web_example：

src/js/first_module.js：

```
openerp.web_example = function (openerp) {
        openerp.web.form.widgets.add('FieldUpTimer',     'openerp.web.form.FieldUpTimer');
        openerp.web.form.FieldUpTimer = openerp.web.form.FieldChar.extend({
         template: 'web_example.action',
        init: function () {
            this._super.apply(this, arguments);
            this._start = null;
            this._watch = null;

        },

    start: function() {
        this.$element.find('button#bstart').click(_.bind(this.mystart, this));
        this.$element.find('button#bstart').click(this.mystart);
        this._start = null;
    },

    countUP: function (counter,minutes,hours,timer,todisplay,h2disp,m2disp,s2disp)
            {
        var h, m, s;
        // Subtracting javascript dates returns the difference in milliseconds
        var diff = new Date() - this._start;
        s = diff / 1000;
        m = Math.floor(s / 60);
        s -= 60*m;
        h = Math.floor(m / 60);
        m -= 60*h;
                todisplay = _.str.sprintf("%02d:%02d:%02d", h, m, s);
                document.getElementById("extimer").innerHTML = todisplay;
            },

    mystart: function () {
            alert('pffff ça marche');
            this.$element.addClass('oe_web_example_started')
                            .removeClass('oe_web_example_stopped');
            //timer=setInterval(this.countUP(counter,minutes,hours,timer,todisplay,h2disp,m2disp,s2disp), 1000 );
            this._start = new Date();
                    this._watch = setInterval(this.proxy('countUP'),33);
    },

            destroy: function () {
        if (this._watch) {
            clearInterval(this._watch);
        }
        this._super();
    }
 }); 
```

};

src/css/web_example.css：

```
.openerp .oe_web_example {
     color: black;
     background-color: white;
     height: 100%;
 }
.openerp .oe_web_example h4 {
    margin: 0;
    font-size: 100%;
}
.openerp .oe_web_example.oe_web_example_started .oe_web_example_start button,
.openerp .oe_web_example.oe_web_example_stopped .oe_web_example_stop button { display: none }, 
```

src/xml/web_example.xml：我删除 < 因为我没有（快速）找到正确显示 html 代码的方法

```
templates>
    div t-name="web_example.action" class="oe_web_example">
    p>
        button type="button" id="bstart">start</button>

        h4 class="oe_web_example_timer" id="extimer">00:00:00</h4>
    /p>
    button type="button" id="bstop">Stop</button>
/div>
/templates> 
```

/web_example.xml

```
<?xml version="1.0" encoding="utf-8"?>
<openerp>
<data>
    <record model="ir.actions.act_window" id="action_web_example_form">
        <field name="name">web_example_class</field>
        <field name="res_model">web_example_class</field>
    </record>

    <record model="ir.ui.view" id="action_web_example_form_view">
        <field name="name">web_example.form</field>
        <field name="model">web_example_class</field>
        <field name="type">form</field>
        <field name="arch" type="xml">
            <form string="Web Example View">
                <field name="test2" widget="FieldUpTimer"/>
            </form>
        </field>
    </record>

<menuitem name="WEB EXAMPLE" action="action_web_example_form" id="web_example_menu"/>
</data>
</openerp> 
```

# php - 将一个数字转换为另一个数字

> ID：14258053
> 
> 赞同：0
> 
> 时间：2013-01-10T12:33:34.807
> 
> 标签：php, numberformatter

所以我有这个小问题。我有一个表格，您可以在其中输入一个数字，它可以是欧式格式，逗号作为小数点 (,)，或者美式格式带有小数点 (.)。

知道了这一点，如何将数字格式从欧美格式转换？而美国格式保持不变？

我尝试使用这个公式，但结果是错误的。

```
$american = '12.5';
$european = '12,5';

$locale = 'it_IT.utf8';
setlocale ('LC_NUMERIC', $locale);
$fmt = new NumberFormatter ($locale, NumberFormatter::DECIMAL);
$american = $ fmt->parse($american);
$european = $ fmt->parse($europen);

response

$american = 125
$european = 12.5 
```

问题出在哪里？

php版本。5.4.10

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-10T12:44:13.103

尝试以下代码：

```
$american = '12.5';
$european = '12,5';

$locale = 'en_US.utf8';
$fmt = new NumberFormatter ($locale, NumberFormatter::DECIMAL);
$american = $fmt->parse($american);

$locale = 'it_IT.utf8';
$fmt = new NumberFormatter ($locale, NumberFormatter::DECIMAL);
$european = $fmt->parse($european); 
```

得到想要的结果？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-10T12:42:41.973

改用[str_replace()](http://php.net/manual/en/function.str-replace.php)不是更好吗？

# android - IBM WorkLight 应用程序不是轻量级的

> ID：14258054
> 
> 赞同：4
> 
> 时间：2013-01-10T12:33:36.333
> 
> 标签：android, ibm-mobilefirst

我正在使用 worklight 开发一个混合应用程序，到目前为止，我的应用程序中只有几个屏幕。但是当我在我的 Android 手机上运行这个应用程序时，如果我检查 apk 文件，它的大小显示为 4.4 MB！通过我的应用程序开发，我什至没有 20%，但它仍然如此繁重。这是 worklight 的问题，还是 worklight 有办法让您的应用程序保持轻量级？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-01-11T03:58:58.757

感谢您的提醒。我们意识到了这一点，并正在为在未来版本中减少我们的应用程序文件大小而努力。

我现在不在我的工作机器前，所以在给你提示之前我无法测试它们，buuuttt...在你的 native\assets 文件夹中应该有一个 icudt46l.zip 文件。如果您不打算使用 JSONStore 功能，请尝试删除此文件并重新构建您的应用程序。这应该会大大减少文件大小，但我不能保证在运行时会发生什么（应该不会发生任何不好的事情......）。

# scala - Scala/Play 2 - 无法运行示例 specs2 测试

> ID：14258056
> 
> 赞同：2
> 
> 时间：2013-01-10T12:33:40.797
> 
> 标签：scala, playframework, dependencies, playframework-2.0, specs2

我在 OS X 上使用 Play Framework v2.04 和 Scala（通过 Homebrew 安装）。一切都按预期工作，但是我似乎无法从 Play 网站的文档中运行基本的[*Hello World*示例 specs2 测试。](http://www.playframework.org/documentation/2.0.4/ScalaTest)这是我`/app/test/example.scala`文件中的代码：

```
import org.specs2.mutable._

import play.api.test._
import play.api.test.Helpers._

class HelloWorldSpec extends Specification {

  "The 'Hello world' string" should {
    "contain 11 characters" in {
      "Hello world" must have size(11)
    }
    "start with 'Hello'" in {
      "Hello world" must startWith("Hello")
    }
    "end with 'world'" in {
      "Hello world" must endWith("world")
    }
  }
} 
```

但是，当我运行时`play test`，出现以下错误：

```
[error] /app/test/example.scala:3: object test is not a member of package play.api 
```

AFAIK，测试对象***应该***是 play.api 包的成员（[根据 API 参考文档](http://www.playframework.org/documentation/api/2.0.4/scala/index.html#play.api.test.package)）。

关于如何解决这个问题的任何想法？

谢谢！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-10T14:18:52.040

在项目根目录下创建`test`目录并将`example.scala`from移动`app/test`到`test`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-05-30T20:47:03.957

在 IntelliJ IDEA 中“将目录标记为”>“测试源根目录”。在项目窗口中单击鼠标右键。

IDEA 可能会被不规范的项目布局所误导。通常测试库是依赖类型“test”，当不被识别为“test”代码时不会编译。

# c++ - 锁保护数据的缓存一致性

> ID：14258057
> 
> 赞同：1
> 
> 时间：2013-01-10T12:33:44.897
> 
> 标签：c++, locking, mutex, memory-barriers

给定线程 TA 和 TB 在下面的 f() 中竞争：

```
struct C {
  C(): a(0) {}
  int a;
  std::mutex mtx;
  void f() {
    ... // use 'a' in readonly mode
    std::lock_guard<std::mutex> lock(mtx); // assume TA gets the lock first, then TB
    a += 2; // what value of 'a' will TB see?
  }
} 
```

在获得锁后，TB 如何知道他缓存的“a”副本已过时？

这就是人们多年来在没有明确使用原子或内存屏障的情况下进行编程的方式，并且一切正常。获取互斥锁（或自旋锁）是否会产生隐式内存屏障？谢谢。

编辑：也许这是[互斥锁功能是否足够没有易失性的重复？](https://stackoverflow.com/questions/6837699/are-mutex-lock-functions-sufficient-without-volatile).

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-10T12:36:32.367

获取互斥锁与释放互斥锁同步。这意味着无论何时获得互斥体，您都可以观察到在互斥体释放之前排序的每个副作用。该实现可以随意实现。重要的是效果是这些。

# java - 类数组 NullPointerException

> ID：14258058
> 
> 赞同：1
> 
> 时间：2013-01-10T12:33:51.403
> 
> 标签：java

这是`Element`类：

```
public class Element {

    private String elementName;
    private int atomicNumber;
    private String Symbol;
    private double atomicWeight;

    public Element()
    {

    }

    public String getElementName()
    {
        return elementName;
    }
    public int getAtomicNumber()
    {
        return atomicNumber;
    }
    public String getSymbol()
    {
        return Symbol;
    }
    public double getAtomicWeight()
    {
        return atomicWeight;
    }
    public void setElementName(String elementName)
    {
        this.elementName = elementName;
    }
    public void setAtomicNumber(int atomicNumber)
    {
        this.atomicNumber = atomicNumber;
    }
    public void setSymbol(String Symbol)
    {
        this.Symbol = Symbol;
    }
    public void setAtomicWeight(double atomicWeight)
    {
        this.atomicWeight = atomicWeight;
    }

} 
```

我正在尝试参加`Array`这个课程，这是我的`mainU.java`课程：

```
public class mainU {

    public static void main(String[] args){     

            Element[] element = new Element[103];

        element[0].setElementName("H");
        String s = element[0].getElementName();

        System.out.println(s);

} 
```

问题是我收到了这个错误：

```
Exception in thread "main" java.lang.NullPointerException
    at mainU.main(mainU.java:14) 
```

任何人都可以告诉我我收到这样一个错误的原因吗？我使我的程序尽可能简单，以便您能够帮助我。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-10T12:39:29.607

问题在于：

```
Element[] element = new Element[103];
element[0].setElementName("H"); 
```

您访问第一个元素而不在此之前创建它。您创建了数组，但它不会自动包含所使用类型的新对象，您必须明确声明这些对象，例如：

```
element[0] = new element(); 
```

然后你就可以使用这个对象了。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-10T12:35:50.797

创建新的对象数组将产生用`null`. 如果您需要拥有对象，则必须在创建数组后对其进行迭代并用新实例填充它。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-10T12:35:57.530

您需要创建对象。您刚刚创建了对象引用数组。

```
Element[] element = new Element[103];
for(int i=0; i<103; i++) {
   element[i] = new Element();
} 
```

由于您的元素是对象（数组是对象）并且它存储在堆上。所有 Element 对象引用都初始化为空值。因此，您将获得`NPE`s。

```
Element[] element = new Element[103];
element[0].setElementName("H");  // element[0] is null 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-01-10T12:36:11.210

您只初始化了元素数组，但从未初始化其元素，

```
 Element[] element = new Element[103];
    element[0].setElementName("H");// this cause NPE as element[0] is null 
```

您需要初始化如下元素：

```
 Element[] element = new Element[103];
       element[0] = new Element();
      element[0].setElementName("H"); 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-01-10T12:36:25.160

像声明数组一样初始化数组对象，但不会初始化数组的元素。您需要在数组的每个索引处创建一个 Element 对象。

```
element[0] = new Element();
element[0].setElementName("H"); 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2013-01-10T12:37:31.173

当您创建一个对象数组时，它的所有元素都被初始化为`null`. 您只需创建一个新`Element`对象并将其添加到数组中，如下所示：

```
Element[] elems = new Element[100];
elems[0] = new Element();
elem[0].setElementName("asdf"); 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2013-01-10T12:38:02.183

你还没有初始化`element[0]`。您需要首先初始化它，如果您打算使用它们，实际上是每个数组元素。

```
element[0]=new Element(); 
```

或者您可以使用循环初始化所有这些

```
 for(int i=0;i<element.length;i++)
  {
    element[i]=new Element();
  } 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2013-01-10T12:36:08.957

在这两行之间

```
 Element[] element = new Element[103];
 element[0].setElementName("H"); 
```

你需要创建`element[0]`，也就是构建一个新的实例`Element`。在您的代码`element[0]`中为空，因此`NullPointerException`当您调用`setElementName`.

# validation - 保存域类时出现“grails.validation.ValidationErrors: 0 errors”

> ID：14258059
> 
> 赞同：0
> 
> 时间：2013-01-10T12:33:55.943
> 
> 标签：validation, grails, groovy, grails-domain-class

我有以下域类：

```
class StudentQuiz {
      Date dateCreated
      Date lastUpdated
      Quiz quiz
      float price
      Student student
      Date startTime
      Date endTime
      int score
      List answers
      static hasMany = [answers:Answer]
      static constraints = {
         answers nullable:true
      }

} 
```

但是当我使用下面的代码来保存这个类的一个实例时：

```
 studentInstance =  (Student)User.findByEmailAndPassword(params.email, params.password.toString().encodeAsPassword())
 if (studentInstance) {
    StudentQuiz studentQuizInstance = new StudentQuiz(score:0,  quiz:quizInstance,price:quizInstance.price,student:studentInstance,startTime:new Date())
    if (!studentQuizInstance.save(flush:true)) {                    
      studentInstance.errors.each {
            println "===="+it+"-------"
        }
} 
```

我得到这个：

```
grails.validation.ValidationErrors: 0 errors 
```

没有其他错误解释。任何帮助将非常感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-10T12:49:03.770

您正在检查错误的实例。应该如下：

```
if (!studentQuizInstance.save(flush:true)) {                    
    studentQuizInstance.errors.each {
    println "===="+it+"-------"
} 
```

# android - Android复选框在切换到横向时更改文本

> ID：14258066
> 
> 赞同：0
> 
> 时间：2013-01-10T12:34:28.170
> 
> 标签：android, checkbox, landscape-portrait

我在 android 中有一个视图，它显示了许多复选框。它们都是动态添加的，我为每个部分设置了一个文本。

```
public class MainActivity extends Activity {

    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_main);

        LinearLayout layout = (LinearLayout) findViewById(R.id.layout);
        LayoutInflater inflater = getLayoutInflater();

        for (String string : getResources().getStringArray(R.array.string_array)) { 
            LinearLayout searchField = (LinearLayout) inflater.inflate(R.layout.cb, null);

            CheckBox checkBox = (CheckBox) searchField.findViewById(R.id.checkBox1);
            checkBox.setText(string);
            layout.addView(searchField, new LinearLayout.LayoutParams(LinearLayout.LayoutParams.FILL_PARENT, LinearLayout.LayoutParams.WRAP_CONTENT));
        }
    }
} 
```

正如您从代码中看到的那样，我有一个字符串数组，并且为数组中的每个字符串添加一个复选框。首次显示视图时，所有复选框都有正确的文本，但在我将设备旋转到横向或纵向模式后，所有复选框都有相同的文本（从最后一个复选框开始）。任何旋转（重绘屏幕）都不再影响文本。所有这些都保留最后一个复选框的文本。

我查看了调试器，复选框对象是每个字符串的新对象，所以我没有使用对象的同一个实例。我目前没有想法。

你知道为什么会这样吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-10T12:52:36.087

当你旋转屏幕时，runtime Resource 会改变，Activity 会重新启动。解决问题的两种方法：

1.  保留所有复选框的值`OnCheckedChangeListener`并将它们重新设置为`onResume`.
2.  自己处理`onConfigurationChanged`，根据[https://developer.android.com/guide/topics/resources/runtime-changes.html#HandlingTheChange](https://developer.android.com/guide/topics/resources/runtime-changes.html#HandlingTheChange)

# selenium - 在 Selenium 中自动执行“浏览”按钮事件

> ID：14258067
> 
> 赞同：1
> 
> 时间：2013-01-10T12:34:30.600
> 
> 标签：selenium, automation, automated-tests, selenium-webdriver, xpath

我需要从 Selenium 自动单击“浏览”按钮。

![在此处输入图像描述](../Images/e2dca7f01641cbcd3dc9667f9b9ba2ef.png)

为此，我尝试过

```
driver.findElement(By.xpath("//*[@id=\"dnn_ctr383_View_filename\"]")).click(); 
```

和

```
driver.findElement(By.cssSelector("Css path")).click(); 
```

两者都给了我`org.openqa.selenium.NoSuchElementException: Unable to locate element:`例外。

我在这里看到[了](http://automationtricks.blogspot.in/2010/09/how-to-click-on-browse-button-in.html)作者建议使用 AutoIT 的链接，但在第 2 步中，作者创建的脚本是针对 IE 的。有人可以建议，我如何在Firefox中自动单击“浏览”按钮？

任何帮助深表感谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-10T14:05:52.930

直接把文件路径传给id，像这样

```
driver.findElement(By.id("dnn_ctr383_View_filename")).sendKeys("C:\\path\\to\\file"); 
```

上述步骤是您前两个步骤的答案

1.  点击浏览
2.  选择要上传的文件

对于第三步（单击上传），查看屏幕截图我没有看到任何显示“上传”的按钮。因此，只需单击“保存”，我假设您的文件将成功上传。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-05-28T17:38:17.110

您需要在这里考虑两件事：

1.  ***单击浏览器按钮：***通常由警报或弹出窗口处理，如果驱动程序无法通过 xpath 找到元素（您已从 firebug 或 chrome 的检查元素中获取），您应该考虑在页面源中查找 iframe。如果一个元素完全在不同的框架中，你需要切换框架才能找到这样的元素

    `WebElement frame = driver.findElementById("name_of_iframe");`

    `driver.switchTo().frame(fr);`

现在您可以像您一样使用 xpath 或 css 选择器找到您的元素。完成后，您可以通过以下方式移出框架：-`driver.switchTo().defaultContent();`

2.  ***从桌面上传文件：***由于 selenium 仅适用于您从驱动程序调用的浏览器会话中的 html，因此它无法在您的桌面上执行操作。一旦您能够单击浏览器按钮，您就可以使用[自动它](https://www.autoitscript.com/site/autoit/)（仅适用于在 windows 上）或[Sikuli](http://www.sikuli.org/)（适用于 mac、linux、windows 甚至 android）根据上传按钮的位置模拟您的事件。

希望这可以帮助

# hibernate - 使用接口覆盖 @Embedded 的 @ManyToOne targetEntity

> ID：14258072
> 
> 赞同：9
> 
> 时间：2013-01-10T12:34:37.767
> 
> 标签：hibernate, jpa

我正在为 ORM 使用休眠和注释。我有所有 bean 的接口，并且我使用 targetEntity 来建立关系：hibernate 无法派生类型，因为 getter 返回的是接口而不是 bean。

我得到嵌入式 bean 的 MappingException（无法确定类型）。

```
@Entity(name="FieldBean")
public class FieldBean implements Field {
    ...
}

@Embeddable
public class FacetBean implements Facet {
    ...    

    @ManyToOne(targetEntity = FieldBean.class)
    @JoinColumn(name = "field_id")
    public Field getField() {
        return field;
    }

}

@Entity(name = "Chart")
public class ChartBean implements Chart {

    @Embedded
    @AssociationOverride(
        name = "field",
        joinColumns = @JoinColumn(name = "category_facet_field_id")
    )
    public Facet getCategoryFacet() {
        return categoryFacet;
    }

} 
```

我得到 MappingException：无法确定类型：字段，表：图表，列：[org.hibernate.mapping.Column(field)]

使用 bean 而不是接口进行属性和 getter/setter 声明可以解决问题，但我想坚持使用接口。单独使用 bean 进行属性声明并不能解决问题。

谁能指出我正确的方向？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2015-01-03T10:36:24.207

我已经使用了一段时间的可行解决方案，但它包括供应商锁定的小案例。我发现仅使用 JPA 注释无法做到这一点，但是有一个特定于 Hibernate 的注释`@Target`可以解决问题。我已经完成了与您类似的事情，并获得了预期的结果。但是，我没有使用您的其他注释，所以我不能保证它会按您的预期工作。

Embeddable 类中没有什么奇怪的事情发生：

```
public interface PointsInt extends Serializable {
    int offensivePoints();

    int defensivePoints();

}

@Embeddable
public class Points implements PointsInt {
    private int def;
    private int off;
    public int offensivePoints() { return off; }

    public int defensivePoints() { return def; }

} 
```

但是在消费类中，我们使用 Hibernate 的`@Target`：

```
import javax.persistence.*;
import org.hibernate.annotations.Target;

@Entity
public class Series extends LongIdEntity implements Serializable {

    @Embedded
    @Target(Points.class)
    private PointsInt points;
    // I prefer to declare my annotations on fields rather than methods
} 
```

结果：

```
mysql> describe series;
+-----------------+-------------+------+-----+---------+----------------+
| Field           | Type        | Null | Key | Default | Extra          |
+-----------------+-------------+------+-----+---------+----------------+
| id              | bigint(20)  | NO   | PRI | NULL    | auto_increment |
| def             | int(11)     | YES  |     | NULL    |                |
| off             | int(11)     | YES  |     | NULL    |                |
+-----------------+-------------+------+-----+---------+----------------+
3 rows in set (0.12 sec) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-11T17:39:36.727

我过去使用 jpa 告诉我不要使用继承。没有映射的超类，没有接口等......只是带有成员的实体。我与hibernate和eclipselink一起工作，两者都有非常非常继承的问题。用 jpa 编写一个支持多个提供者的持久层是非常困难的，因为所有这些提供者都有很多错误。尽可能简单。不要使用任何“特殊”功能。我向您保证，当您尝试更改提供程序或只是在 jboss（休眠）或 glassfish/weblogic（eclipse/top 链接）等不同的应用程序服务器上运行软件时，您会很高兴拥有一个使用最少的最简单的持久层尽可能的特色。我不知道这是否是一个错误，但我认为它是。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2019-11-27T11:54:27.980

除了讨论接口是否被过度使用之外，问题的根源在于您正在使用接口，而这些接口是需要类的。具体来说，您将 JPA 注释放在返回非 JPA 对象的方法上。

解决方案非常简单：将注释放在字段上，而不是方法上。

```
@Embeddable
public class FacetBean implements Facet {

    @ManyToOne(targetEntity = FieldBean.class)
    @JoinColumn(name = "field_id")
    private FieldBean field;

    public Field getField() {
        return field;
    }
} 
```

唯一的缺点是，如果您坚持使用带有`Field`参数的方法，那么您将遇到任何 setter 方法的问题。但是无论如何，如果您希望能够分配任何`Field`实例，即使它不是 JPA 管理的 bean，您也会遇到这样的问题。

# qt - QtDBus 链接错误

> ID：14258076
> 
> 赞同：1
> 
> 时间：2013-01-10T12:34:50.310
> 
> 标签：qt, visual-c++, dbus, unresolved-external, qtdbus

我用 WinDBus 在 Windows 上构建了 Qt。Qt 本身构建正常，但 QDbus 示例构建失败并显示消息

```
moc_car_adaptor_p.obj : error LNK2001: unresolved external 
symbol "public: static struct QMetaObject const 
QDBusAbstractAdaptor::staticMetaObject"
(?staticMetaObject@QDBusAbstractAdaptor@@2UQMetaObject@@B) 
```

文件夹`E:\qt\4.6.4\msvc2008\lib`包含 QtDBus4.dll QtDBus4.lib QtDBusd4.dll 和 QtDBusd4.lib。全部包含`'staticMetaObject@QDBusAbstractAdaptor@@2UQMetaObject@@B'`字符串。

如何解决？

事先感谢，伊利亚。

**UPD：** 所有 .PRO 文件都来自 DBus 示例，我没有更改任何内容。例如：

```
######################################################################
# Automatically generated by qmake (2.01a) Mon Aug 28 19:50:14 2006
######################################################################

TEMPLATE = app
TARGET = 
DEPENDPATH += .
INCLUDEPATH += .
CONFIG += qdbus

# Input
# DBUS_ADAPTORS += car.xml
HEADERS += car.h car_adaptor_p.h
SOURCES += car.cpp main.cpp car_adaptor.cpp

# install
target.path = $$[QT_INSTALL_EXAMPLES]/dbus/remotecontrolledcar/car
sources.files = $$SOURCES $$HEADERS $$RESOURCES *.pro *.xml
sources.path = $$[QT_INSTALL_EXAMPLES]/dbus/remotecontrolledcar/car
INSTALLS += target sources

symbian: include($$QT_SOURCE_TREE/examples/symbianpkgrules.pri) 
```

**UPD2：**

QtCreator 生成的命令行：

```
... moc.exe and cl.exe calls...
cl -c -nologo -Zm200 -Zc:wchar_t- -Zi -MDd -GR -EHsc -W3 -w34100 -w34189
-DUNICODE -DWIN32 -DQT_LARGEFILE_SUPPORT -DQT_DLL -DQT_GUI_LIB -DQT_CORE_LIB
-DQT_THREAD_SUPPORT -I"..\..\..\..\msvc2008\include\QtCore" -I"..\..\..\..\msvc2008
\include\QtGui" -I"..\..\..\..\msvc2008\include" -I"..\..\..\..\msvc2008\include
\QtDBus" -I"..\car" -I"debug" -I"..\..\..\..\msvc2008\include\ActiveQt" -I"." 
-I"..\..\..\..\msvc2008\mkspecs\win32-msvc2008" 
-Fodebug\ @C:\DOCUME~1\resu\LOCALS~1\Temp\moc_car_adaptor_p.obj.432.2453.jom
moc_car_adaptor_p.cpp

link /LIBPATH:"e:\qt\4.6.4\msvc2008\lib" /NOLOGO /DEBUG /MANIFEST 
/MANIFESTFILE:"debug\car.intermediate.manifest" /SUBSYSTEM:WINDOWS 
/MANIFESTDEPENDENCY:type='win32' name='Microsoft.Windows.Common-Controls' 
version='6.0.0.0' publicKeyToken='6595b64144ccf1df' language='*' 
processorArchitecture='*'" /OUT:debug\car.exe @C:\DOCUME~1\resu\LOCALS~1
\Temp\car.exe.432.3734.jom 
```

我构建 Qt 的选项：

```
configure.exe -platform win32-msvc2008 -shared  -debug-and-release -dbus -dbus-linked 
-qt-sql-sqlite -qt-sql-psql -no-qt3support -qt-zlib -qt-gif -qt-libpng -qt-libmng 
-qt-libtiff -qt-libjpeg -openssl-linked -confirm-license -opensource -phonon -phonon-
backend -nomake demos -nomake examples OPENSSL_LIBS="-lssleay32MD -llibeay32MD" 
-I "C:\OpenSSL-Win32\include" -I "C:\Progra~1\PostgreSQL\8.4\include" 
-I E:\qt\4.6.4\msvc2008\src\dbus" -I E:\qt\4.6.4\msvc2008\src\dbus\dbus" 
-L "C:\Progra~1\PostgreSQL\8.4\lib" -L "C:\OpenSSL-Win32\lib\VC\static" 
-l ws2_32 -l gdi32 -l user32 -l crypt32 -l advapi32 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-14T10:38:37.193

问题出在`qdbusmacros.h`：

```
#if defined(QDBUS_MAKEDLL)
# define QDBUS_EXPORT Q_DECL_EXPORT
#elif defined(QT_SHARED)
# define QDBUS_EXPORT Q_DECL_IMPORT
#else
# define QDBUS_EXPORT
#endif 
```

`QT_SHARED`没有在申请中声明，`QDBUS_EXPORT`变成了无。

添加

```
CONFIG += QT_SHARED 
```

解决了这个问题。

注意：在 Qt 4.8.4 中一切正常（之前我使用的是 4.6.4）

# linux - 连接以仅使用终端连接到 pptp vpn

> ID：14258077
> 
> 赞同：0
> 
> 时间：2013-01-10T12:34:56.297
> 
> 标签：linux, terminal, vpn

我想创建一个 pptp vpn 客户端并使用终端连接到它。我使用 ‍<code>pon‍‍</code> 命令创建了一个连接`pptp-setup`，然后连接到它。但问题是我的互联网流量没有通过这个 vpn 连接路由。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2017-06-22T12:52:29.933

如果您的 VPN 提供商支持，您可以连接到 Cisco VPN Server。

```
pacman -S openconnect
openconnect <server address> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-07-08T21:12:01.140

只需使用`route`这样的命令：

```
 sudo route add default dev ppp0 
```

将 ppp0 替换为您在其中找到的 vpn 连接名称`ifconfig`

# javascript - 使用 JavaScript 查询时，浏览器窗口宽度小于预期

> ID：14258079
> 
> 赞同：0
> 
> 时间：2013-01-10T12:35:04.647
> 
> 标签：javascript, jquery

我需要使用窗口的高度和宽度以动态方式计算标题的宽度和高度。

问题是它们变小了 16 像素，我不知道为什么。

这是我期望得到的：

1.  w_height: 929, w_width: 1280
2.  body_height: 929 - 顶部 - 底部 - 边框（1px 顶部，1px 底部）= 727
3.  body_width: 1280 - 左 - 右 - 边框（1px 左，1px 右）= 878

这就是我得到的：

1.  身体高度：711
2.  身体宽度：867

你能告诉我如何解决这个问题以及为什么会发生这种情况吗？谢谢你。

```
<html>
    <head>
        <title>Dancing Web</title>
        <!--<link rel="stylesheet" href="css/index.css" />-->
        <script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/1.6.2/jquery.min.js"></script>
        <style>
        body{
            position:absolute;
            top: 100px;
            left: 200px;
            right: 200px;
            bottom: 100px;  
        }
        figure{
            margin:0;
            padding:0;
        }

        .solid_border{
            border: 1px solid green;
        }
        </style>
    </head>
    <body class="solid_border">
        <header>

            <figure >

            </figure>
            <nav>

            </nav>
        </header>       
        <script type="text/javascript">
            $(document).ready(function(){          
                alert($(window).height() +', '+$(window).width());
                alert($('body').css('height') +', '+$('body').css('width'));        
            });
        </script>
    </body> 

</html> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-10T12:37:25.747

你应该试试：

```
alert($(window).outerHeight() +', '+$(window).outerWidth()); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-10T12:39:16.843

这可能是因为您应该获得外部宽度和高度。

看：

*   [http://api.jquery.com/outerWidth/](http://api.jquery.com/outerWidth/)
*   [http://api.jquery.com/outerHeight/](http://api.jquery.com/outerHeight/)

因为填充，边框，最终是边距。

# ios - runUntilDate 在后台线程上不起作用

> ID：14258082
> 
> 赞同：1
> 
> 时间：2013-01-10T12:35:11.743
> 
> 标签：ios, grand-central-dispatch, nsrunloop

sleep 效果很好，但 runUntilDate 在后台线程上不起作用。但为什么？

```
-(IBAction) onDecsriptionThreadB:(id)sender
{
 dispatch_async(dispatch_get_global_queue(0, 0), ^{

    while (1)
    {
        NSLog(@"we are here");
        [[NSRunLoop currentRunLoop] runUntilDate:[NSDate dateWithTimeIntervalSinceNow:2]];
        //sleep(2);
    }        
  });    
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-12T12:40:45.777

> 如果没有输入源或计时器附加到运行循环，则此方法立即退出；

如果你想使用 runUntilDate 你必须添加定时器或输入源。我的正确版本是：

```
while (1)
{
    NSLog(@"we are here");
    [NSTimer scheduledTimerWithTimeInterval:100 target:self selector:@selector(doFireTimer:) userInfo:nil repeats:YES];
    [[NSRunLoop currentRunLoop] runUntilDate:[NSDate dateWithTimeIntervalSinceNow:2]];
    //sleep(2);
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-10T14:48:28.760

看一下[函数 sleep() 和 [[NSRunLoop currentRunLoop] runUntilDate] 的用法差异的问题](https://stackoverflow.com/questions/9819004/difference-in-usage-of-function-sleep-and-nsrunloop-currentrunloop-rununtil)

NSRunLoop 更好，因为它允许 runloop 在您等待时响应事件。如果您只是休眠线程，即使事件到达（例如您正在等待的网络响应），您的应用程序也会阻塞。

NSRunLoop 的文档还说：

如果没有输入源或计时器附加到运行循环，则此方法立即退出；否则，它将通过重复调用 runMode:beforeDate: 在 NSDefaultRunLoopMode 中运行接收器，直到指定的到期日期。

如果您使用 GCD，其目的通常是避免正确地进行复杂的线程编码。您尝试这样做的更大目的是什么。可能是您的全局背景将有助于更好地解释问题。

# php - PHP服务器端超时检查

> ID：14258086
> 
> 赞同：0
> 
> 时间：2013-01-10T12:35:26.563
> 
> 标签：php, datetime, timeout

是否有一种简单直接的方法来查找开始日期之间的剩余时间 - 例如：`2013-01-10 12:34:55`和 5 分钟后？

我的意思是我有开始日期，并想检查 5 或 60 分钟后的时差是否为 0。在服务器端检查一种超时。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-10T12:43:26.357

你有 2 个日期，对吗？

```
$date1 = strtotime('2013-01-10 12:34:33'); // converto to time
$date2 = strtotime('2013-01-10 12:45:33'); // or else it won't work
$diff = date('u', $date1) - date('u', $date2); // the difference in seconds between the two
// if you want $date2 to be now, just use date('u')
if ($diff > 3600) { // an hour later
    echo 'The difference between $date1 and $date2 is more than an hour';
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-10T12:39:48.113

如果您想为用户执行“会话超时”之类的操作。使用 Javascript setintervel() 并执行 ajax() 调用以从应用程序中注销用户。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-10T17:55:23.020

好吧，似乎我走得更难了……发现从 sql 检查中获取它比在 php 中获取它更容易和更可靠。我已经成功地实现了这一点。把它留在这里以防万一它可能有用。

```
$query = "SELECT * FROM db_table 
WHERE DATE_ADD(my_start_date, INTERVAL 5 MINUTE) > NOW()"; 
```

其中 5 是可以设置的时间间隔，单位为秒 (SECOND)、分钟 (MINUTE)、小时 (HOUR)、天 (DAY) 等。

# google-apps-script - 当站点为私有时，如何使用站点的图像在其他页面上显示

> ID：14258091
> 
> 赞同：0
> 
> 时间：2013-01-10T12:35:36.060
> 
> 标签：google-apps-script, google-sites

我有一个私人的谷歌网站。我有我做的公告页面`post`...

我想获取最新的帖子图像并想在其他页面上显示它......

但我遇到的问题是，如果网站是私有的，我无法`fetch`从它的图像`URL`以及它的内容中获取该图像。

代码：

```
var page = SitesApp.getSite(domainName, sitename).getChildByName(announcementPageName)
var announcements = page.getAnnouncements();
var coll=[]
for(var i=0;i< announcements.length;i++){
    var announcementJson={title : announcements[i].getTitle(),
                          content : announcements[i].getTextContent(),
                          image : announcements[i].getAttachments()[0].getUrl()
                         }
coll.push(announcementJson)
} 
```

当我使用 HTML 的`coll[i].image`in`"img src="""`标记时，它没有给出输出。

我该如何解决这个问题？

我的站点位于 Google Apps 域中，并且站点的权限是*私有*的或*域内的个人*。我在某处读到 Google 站点对图像 URL 进行了编码，如果站点是私有的，则`post`标记对编码的 URL 无效。如果是这样，那么还有什么替代方法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-10T19:59:36.753

您将需要解决域和谷歌的安全设置。这可能违反您的雇佣协议和当地法律，因此请先咨询您的域管理员。

总体概念：

1.  在域帐户中，使用基于时间的触发器创建应用程序脚本。该脚本将定期捕获您感兴趣的图像，并将其保存在*某处*。（我们假设某处是用户的 google 驱动器，并且它使用相同的域帐户同步到 PC 上。）

2.  在域帐户之外，另一个基于时间的脚本将从*某处*获取该图像，并将其*放在某处 public*。这很可能是在具有 google docs 同步的同一台 PC 上运行的 python 脚本；该脚本可以检查图像文件的新副本是否存在，并将其复制到公共位置（例如 Dropbox 帐户 - 请参阅[Python API](https://www.dropbox.com/static/developers/dropbox-python-sdk-1.5.1.zip)）。或者，您的公司可能有一个公共 Web 服务器，您可以将文件复制到该服务器。

3.  您的外部（非域）站点只需要通过其*某个公共*URL（例如 Dropbox）来引用图像。

我希望这有助于您入门。

# java - JAVA 中的 CopyfromRecordset

> ID：14258095
> 
> 赞同：0
> 
> 时间：2013-01-10T12:35:45.627
> 
> 标签：java, jdbc, apache-poi

我的要求是我必须将数据从 Result set ( using `JAVA`) 转移到`excel`. 我可以一个单元一个单元地做那个。

但是在 VBA 中，有一种`COPYFROMRECORDSET`方法可以让我一次性传输整个数据。

想知道`JAVA`有没有这样的方法。

如果有人知道我们如何有效且快速地将数据从`RESULTSET`（in `java`）传输到`EXCEL`（我正在使用的excel `poi`） ，请分享

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-10T13:03:52.957

在标准 Java 库中没有这样的方法。但是你不是第一个有这个任务的人——通过谷歌搜索你可以找到一些实现，例如[this](http://www.codereye.com/2009/09/converting-resultset-to-excel-table-in.html)。

# python - 在 Python 3.x 中使用 eval() 评估输入时，如何避免字符串出错？

> ID：14258111
> 
> 赞同：0
> 
> 时间：2013-01-10T12:36:19.077
> 
> 标签：python, python-3.x, eval

我正在学习 Python 3.x。我想编写一个评估输入值并打印结果的函数。如果最初输入了字符串，该函数应该只打印字符串而不进行评估。

```
def eval_input():
    line=input("Something:")
    print(eval(line))

eval_input() 
```

它适用于整数和数学运算。但是当输入一个字符串时，比如“ `fasdfasd`”，它会得到一个错误：“ `name 'fasdfasd' is not defined`”。我明白为什么会发生这个错误。因为“ `fasdfasd`”被视为一个变量。但是我不明白如何检查字符串是否最初输入？

如何在评估之前从输入中填充字符串？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-01-10T12:38:36.907

第一：依靠 `eval()`.

您可以简单地捕获`NameError`（`SyntaxError`以及）并假设输入是一个字符串：

```
try:
    print(eval(line))
except (NameError, SyntaxError):
    print(line) 
```

这里可能还有其他例外情况，但接下来为了避免使用`eval()`我还想警告不要使用毯子`except:`或`except Exception:`处理程序，这些通常也不是好主意。

更好的技术是使用[`ast.literal_eval`](http://docs.python.org/3/library/ast.html#ast.literal_eval)：

```
try:
    print(ast.literal_eval(line))
except ValueError:
    print(line) 
```

`literal_eval`仅接受 python 文字值（so `'string'`or `123`or ），如果无法解析该输入`('some', 'more', [1, 2, 4.5], 'complex structure')`，将抛出 a 。`ValueError`

它*没有*遭受的安全问题`eval()`，也不需要捕获尽可能多的异常，只`ValueError`需要处理即可。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-10T12:56:38.183

如果您正在接受用户输入，那么您大概知道您要的是什么以及它应该是什么类型。你需要写一个验证器。您可以使用正则表达式以文本方式执行此操作，或者更基本地使用“强制转换”或转换函数。

例如，如果您要查找整数，请使用`int`转换它并检查错误。

```
>>> int("22")
22
>>> int("asdf")
Traceback (most recent call last):
  File "<input>", line 1, in <module>
ValueError: invalid literal for int() with base 10: 'asdf'
>>> 
```

告诉用户输入一个数字。如果该`int`函数无法解析它，它将引发 ValueError ，并且只有 that ，因此您可以轻松地判断您得到的不是数字。

```
>>> try: 
...     int("asdf")
... except ValueError:
...     print("Enter a number please")
... 
```

您可以对`float`. 你得到`input`的总是一个`str`，所以如果这是你想要的，那就使用它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-10T12:38:27.010

好的，只是作为一个答案，我将把这个

```
try:
    print(eval(line))
except Exception as e:
    print "Something went wrong, namely: %s" % e 
```

但是你真的不想使用 eval，它的邪恶、讨厌、会导致 bug 和安全风险，并且很难开发、调试和正确使用

# html - HTML表格设置td高度不起作用

> ID：14258117
> 
> 赞同：0
> 
> 时间：2013-01-10T12:36:42.800
> 
> 标签：html, css, html-table

我遇到了 Internet Explorer 9 和固定高度的问题`td`

我需要一个`td`with `5px`height 但在**IE9**中它大于`5px`.

在 Chrome、Firefox 和 Safari 中它可以工作

我尝试使用**透明的 1px gif**插入`td`，我设置了`font-size: 0px; line-height: 0px`它仍然无法正常工作。

我的测试代码：

```
<!DOCTYPE html>
<html>
<head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<title>test</title>
<style>
    .space{
        height: 5px;
        width: 5px;
        font-size: 0px;
        line-height: 0px;
        background: none;
    }

    table{
        border-spacing: 0px;
        table-layout: fixed;

    }

    td{
        background-color: red;
    }

</style>
</head>

<body>

    <table cellpadding="0" cellspacing="0" style="width: 1200px;">
        <tr >
            <td rowspan="5"> test1<br>test1<br>test1<br>test1<br>test1<br>test1<br>test1<br>test1<br>test1<br>test1<br><br>test1<br>test1<br>test1<br>test1<br>test1<br>test1<br>test1<br>test1<br>test1<br> </td>
            <td rowspan="5" class="space"> </td>
            <td rowspan="5"> test2<br>test1<br>test1<br>test1<br>test1<br>test1<br>test1<br>test1<br>test1<br>test1<br><br>test1<br>test1<br>test1<br>test1<br>test1<br>test1<br>test1<br>test1<br>test1<br> </td>
            <td rowspan="5" class="space"> </td>
            <td> test3</td>
        </tr>

        <tr>
            <td class="space"> spacer</td>
        </tr>

        <tr>
            <td> test 5</td>
        </tr>

        <tr>
            <td class="space"> spacer</td>
        </tr>

        <tr>
            <td> test 5</td>
        </tr>
  </table>

</body>
</html> 
```

我有两张图片：

**铬（工作）：**

![铬（工作）](../Images/9d47c6e45017da1d6bbfea13d306cf49.png)

**IE9**：

![即9](../Images/8cba70b9457c524e83efa7f5563b8d07.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-10T14:42:16.547

您可以在 td 内放置一个高度为 5px 的 div。[http://jsfiddle.net/aCrbz/3/](http://jsfiddle.net/aCrbz/3/)

```
<td><div class="foo"></div></td> 
```

# java - 匹配器查找无限循环

> ID：14258120
> 
> 赞同：1
> 
> 时间：2013-01-10T12:36:50.560
> 
> 标签：java, string, pattern-matching, match

我正在尝试替换长字符串中的某些单词。发生的事情是一些词保持不变，一些变化。不变的词似乎`matcher`陷入了无限循环，因为它不断尝试对本应保持不变的词执行相同的操作。下面是一个与我类似的示例 - 我无法提供我正在使用的确切代码，因为它更详细并且我担心会占用太多空间。

```
public String test() {
    String temp = "<p><img src=\"logo.jpg\"/></p>\n<p>CANT TOUCH THIS!</p>";
    Pattern pattern = Pattern.compile("(<p(\\s.+)?>(.+)?</p>)");
    Matcher matcher = pattern.matcher(temp);
    StringBuilder stringBuilder = new StringBuilder(temp);
    int start;
    int end;
    String match;

    while (matcher.find()) {
        start = matcher.start();
        end = matcher.end();
        match = temp.substring(start, end);
        stringBuilder.replace(start, end, changeWords(match));
        temp = stringBuilder.toString();
        matcher = pattern.matcher(temp);
        System.out.println("This is the word I'm getting stuck on: " + match);
    }
    return temp;
}

public String changeWords(String words) {
    return "<p><img src=\"logo.jpg\"/></p>";
} 
```

关于为什么会发生这种情况的任何建议？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-10T12:42:15.393

您在循环中重新初始化匹配器。

删除循环中的`matcher = pattern.matcher(temp);` 指令，`while`您不应再被卡住。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-10T12:40:43.510

你用`Matcher`错了。您的 while 循环显示：

```
while (matcher.find()) {
     start = matcher.start();
     end = matcher.end();
     match = temp.substring(start, end);
     stringBuilder.replace(start, end, changeWords(match));
     temp = stringBuilder.toString();
     matcher = pattern.matcher(temp);
} 
```

它应该是：

```
matcher.replaceAll(temp, "new text"); 
```

没有“while”循环，这是不必要的。匹配器*不会*替换它不匹配的文本，并且它会在同一个地方不匹配两次等方面做正确的工作——不需要用勺子喂它。

更重要的是，您的正则表达式可以在没有捕获括号的情况下完成。如果您只想替换“单词”（正则表达式没有单词的概念），请在要匹配的文本周围添加单词锚点：

```
Pattern pattern = Pattern.compile("\\btext\\b"); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-10T12:50:47.623

你为什么要使用`Matcher`？您不需要正则表达式来替换单词，只需使用`replace()`：

```
input.replace("oldtext", "newtext"); // replace all occurrences of old with new 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-11T09:41:30.053

我只是通过添加以下行来修复它：

```
if (!match.equals(changeWords(match))) {
     matcher = pattern.matcher(temp);
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-01-10T12:40:32.603

您正在寻找匹配“文本”单词并再次用“文本”（如果 changeWord() 中的条件）或“新文本”（否则在 changeWord() 中）替换该单词。这就是它导致无限循环的原因。

# c# - Sql Timeout 错误，但是为什么？

> ID：14258122
> 
> 赞同：0
> 
> 时间：2013-01-10T12:36:53.170
> 
> 标签：c#, asp.net, parameters, timeout, sqlcommand

下面的代码产生一个`System.Data.SqlClient.SqlException: Timeout expired`.

```
const string sqlStmt = @"SELECT * 
                         FROM CUSTOMER_INFO 
                         WHERE CUSTOMER_NO = @CUSTOMER_NO;";

SqlCommand command = new SqlCommand(sqlStmt, connection);
command.Parameters.AddWithValue("@CUSTOMER_NO", txtAccountNo.Text.Trim().ToUpper()); 
```

但这不会超时...

```
const string sqlStmt = @"SELECT * 
                         FROM CUSTOMER_INFO 
                         WHERE CUSTOMER_NO = @CUSTOMER_NO;";

SqlCommand command = new SqlCommand(sqlStmt, connection);            
command.Parameters.Add("@CUSTOMER_NO", SqlDbType.VarChar, 25).Value = txtAccountNo.Text.Trim().ToUpper(); 
```

不明白为什么，有大神能指教一下吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-10T12:51:55.320

你能看一下数据库执行的 SQL 语句吗？

您可能会看到参数使用的类型有所不同。我相信 AddParamWithValue 方法不会为参数使用正确的类型。

然后，DBMS 可能必须将值转换回正确的类型。在这种情况下，某些 DBMS 将无法使用索引查找，这将导致运行时间更长的查询，从而导致超时。

# sql - 将默认事务隔离级别从 READ_COMMITTED_SNAPSHOT 更改为 READ_COMMITTED 有什么期望？

> ID：14258125
> 
> 赞同：3
> 
> 时间：2013-01-10T12:37:09.583
> 
> 标签：sql, sql-server, azure-sql-database, isolation-level, transaction-isolation

在 SQL Server 中，默认隔离级别是`READ_COMMITTED`，但在 SQL Azure 中，默认级别是`READ_COMMITTED_SNAPSHOT`.

假设我将 SQL Azure 服务器中的默认级别更改为`READ_COMMITTED_SNAPSHOT`（使用`SET TRANSACTION ISOLATION LEVEL`），使其行为类似于 SQL Server。

我应该期待什么负面后果？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-10T12:56:14.300

您的应用程序逻辑可能会中断。真的，这很大程度上取决于你在做什么。总的来说，一些提示：

*   与 RCSI 相比，True SNAPSHOT 的“惊喜”要少得多。由于“快照”行版本在真正的 SNAPSHOT 中明确定义为事务开始的那一刻，因此它不会遭受在同一事务中看到不同行版本的 RCSI 问题（这会导致非常微妙且难以理解的问题）
*   您将获得更新冲突而不是死锁，但*完全是*“而不是”。存在一些差异，应用程序可能不会期望新的错误代码 3960。

我建议[阅读在 SQL Server 中实现快照或读取提交的快照隔离：指南](http://www.brentozar.com/archive/2013/01/implementing-snapshot-or-read-committed-snapshot-isolation-in-sql-server-a-guide/)。

# exception - 异常抛出smooks

> ID：14258126
> 
> 赞同：0
> 
> 时间：2013-01-10T12:37:12.877
> 
> 标签：exception, xml-parsing, smooks

是否可以在 smooks 配置文件中抛出异常。例如，如果在订单的 xml 中，

```
<order id="332">
<header>
    <customer number="123">Joe</customer>
</header>
<order-items>
    <order-item id='1'>
        <product>1</product>
        <quantity>2</quantity>
        <price>8.80</price>
    </order-item>
</order-items>
</order> 
```

如果节点`<order-items>`不存在，则应引发异常或出现错误。在 Smooks 配置文件中是否有执行此操作的选项？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-10T14:11:32.527

您可以查看验证墨盒。请参阅用户指南。

# oracle - oracle 中的约束

> ID：14258136
> 
> 赞同：1
> 
> 时间：2013-01-10T12:37:34.397
> 
> 标签：oracle, constraints

```
CREATE TABLE classname (
class_name VARCHAR2(5) CONSTRAINT class_name_pk PRIMARY KEY,
meet_at_and_timing VARCHAR2(30),
room_no VARCHAR2(5),
faculty_handling NUMBER(5) CONSTRAINT faculty_handling_fk REFERENCES faculty(faculty_id)
); 
```

在上表创建中，room_number 应始终包含“LH”作为前两个字符。

**例子：**

```
room_no=LH43 is valid but room_no=EC43 is invalid... 
```

我应该如何指定这个？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-10T13:18:38.580

我想它会更简单

```
alter table classname
     add constraint check_room_no 
      check (SUBSTR(room_no, 1, 2) = 'LH'); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-10T14:22:34.167

最简单的语法是：

```
alter table classname
 add constraint check_room_no 
  check (room_no like 'LH%'); 
```

我更喜欢这种方法，因为如果您要查询以 LH 开头的字符串，那么您很可能会使用它，而不是 SubStr()

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-01-10T14:24:58.993

这三个解决方案都很好。我创建了一个包含 200 万行的测试表，并测量了添加检查约束所需的时间：

```
 36.4s  0.17 us   CHECK (room_no LIKE 'LH%')
 54.2s  0.26 us   CHECK (substr(room_no,1,2) = 'LH') 
111.9s  0.54 us   CHECK (REGEXP_LIKE(room_no, '^LH', 'c'))
138.3s  0.66 us   CHECK (REGEXP_LIKE(room_no, '^LH', 'i')) 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-01-10T12:44:01.797

您应该使用 REGEXP_LIKE。如果你想要“LH”大写，你应该在 REGEXP_LIKE 中指定它是区分大小写的。

```
alter table classname
     add constraint check_room_no 
      check (REGEXP_LIKE(room_no,'your_regex_goes_here','C')); 
```

[然后，您可以通过使用http://www.gskinner.com/RegExr/](http://www.gskinner.com/RegExr/)来确定正则表达式对您的约束是什么。

例子 ：

```
 alter table classname
    add constraint check_room_no 
      check (REGEXP_LIKE(room_no,'^LH\w','C')); 
```

# msbuild - 使用 Coverity 使用 devenv 编译 C++ 项目时出错。(cov-build.exe)

> ID：14258145
> 
> 赞同：0
> 
> 时间：2013-01-10T12:38:16.020
> 
> 标签：msbuild, devenv, coverity-prevent, coverity

运行 Coverity 构建时，出现以下错误：

```
Failed to locate msbuild.exe when handling devenv template configuration. Shutting down resident msbuild processes is impossible. 
```

在谷歌上找不到！

有谁知道这可能意味着什么？我该如何调查？

当我在没有 Coverity 的情况下从命令行构建时，它工作正常。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-04T18:56:02.933

当您启动`cov-build devenv`它尝试做的一件事是杀死空闲的 msbuild.exe 进程，因为如果它们没有被杀死，devenv 会将构建指令传递给 msbuild 而 cov-build 无法看到它（这就是它知道如何构建您的文件）。

有几种方法可以解决这个问题 - 这取决于您如何调用 cov-build、如何设置编译器配置等。例如，您可以`cov-build msbuild`直接调用而不是通过`devenv`.

我建议使用 Coverity 打开一个支持案例（因为如果你有许可证，你就有支持）。通过 support@coverity.com 向他们发送电子邮件，我相信他们可以建议额外的调试步骤。

# wcf - 使用 https 配置 wsDualHttpBinding

> ID：14258146
> 
> 赞同：0
> 
> 时间：2013-01-10T12:38:23.260
> 
> 标签：wcf, https, web-config, wsdualhttpbinding

我正在尝试将我的 wcf 服务配置为通过 https 使用 wsDualHttpBinding。我当前的配置如下所示：

**服务**

```
<service behaviorConfiguration="SecureBackendWebServiceBehavior"
      name="WebService.InternalService.BackendWebService">
      <endpoint address="" 
        binding="wsDualHttpBinding" 
        bindingConfiguration="SecureBackendWebServiceWsDualHttpBinding"
        name="BackendWebServiceEndpoint" 
        contract="WebService.InternalService.IBackendWebService"/>
</service> 
```

**捆绑**

```
<binding name="SecureBackendWebServiceWsDualHttpBinding" 
  receiveTimeout="00:05:00"
  bypassProxyOnLocal="false" 
  transactionFlow="true" 
  maxBufferPoolSize="2147483647"
  maxReceivedMessageSize="2147483647" 
  messageEncoding="Mtom">
        <readerQuotas maxDepth="2147483647" 
           maxStringContentLength="2147483647"
           maxArrayLength="2147483647" 
           maxBytesPerRead="2147483647" 
           maxNameTableCharCount="2147483647" />
      <security mode="Message">
        <message clientCredentialType="Certificate" />
      </security>
</binding> 
```

**行为**

```
<behavior name="SecureBackendWebServiceBehavior">
      <serviceMetadata httpsGetEnabled="true"/>
      <serviceDebug includeExceptionDetailInFaults="true" />
</behavior> 
```

当我在浏览器中调用该服务时，它显示：没有使用端点绑定 WSDualHttpBinding 找到模式“http”的基地址。注册的 baseaddressschema 是 [https]。

通过对问题进行谷歌搜索，我最终只得到了普通 wsHttpBindings 的样本，但没有得到双重绑定的样本。我已经输入了 HttpsGetUrl，但最终出现了同样的错误。我是否监督了一些价值，或者他为什么试图通过 http 获取信息？

顺便提一句。将绑定更改为 NetTcp**不是**一种选择！

希望你们中的任何人都可以在这里帮助我。谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-10T16:36:22.877

wsDualHttpBinding 不支持传输安全性。

MSDN：

> WSDualHttpBinding 为 Web Service 协议提供与 WSHttpBinding 相同的支持，但用于双工协定。WSDualHttpBinding 仅支持 SOAP 安全性并需要可靠的消息传递。

因此，您只能在此处依赖消息安全性。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-16T07:03:21.770

我自己找到了解决方案。我使用了[改进 Web 服务安全性的模式和实践：WCF 的场景和实施指南来](http://wcfsecurityguide.codeplex.com/)更好地理解 WCF 中的安全性。本书还包括某些场景的 HowTos。唯一我必须做的事情。

因为我的 Web 服务分为三个较小的服务，其中之一是使用 WsDualHttpBinding 我需要告诉 iis 这个不需要 ssl 证书进行传输。

For now on my service talks, but I need to check if it really uses the security I want to have.

**UPDATE:** Found this [article](http://robbincremers.me/2011/12/27/wcf-transport-security-and-client-certificate-authentication-with-self-signed-certificates/) that also contains a step by step tutorial.

# javascript - 如何在 Javascript 中对大型 XML 字符串进行硬编码？

> ID：14258155
> 
> 赞同：2
> 
> 时间：2013-01-10T12:38:42.880
> 
> 标签：javascript, xml

我有一个需要在 JS 中处理的大型 XML。有没有更好的解决方案来复制/粘贴（从 xml 文件到 js 文件）并引用近 1000 行 xml 文件中的每一行？

是否可以将该 xml 文件“嵌入”为闪存中的资源？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-10T12:40:31.153

通常的解决方案是简单地将 XML 文件放在外面并使用[XMLHttpRequest](http://mdn.beonex.com/en/DOM/XMLHttpRequest/Using_XMLHttpRequest.html)获取它：

```
function fetchXMLFile(url, callback) {
    var httpRequest = new XMLHttpRequest();
    httpRequest.onreadystatechange = function() {
        if (httpRequest.readyState === 4) {
            if (httpRequest.status === 200) {
                var xml = httpRequest.responseXML;
                if (callback) callback(xml);
            }
        }
    };
    httpRequest.open('GET', url);
    httpRequest.send(); 
}

fetchFile('myFile.xml', function(xml){
   // use the xml
}); 
```

如果你真的想在代码中嵌入数据，你将不得不在你最喜欢的编辑器中使用正则表达式，或者构建一个小工具来进行嵌入，但将大数据与源代码合并很少被认为是最佳实践。这两个部分通常具有不同的生命周期。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-10T13:39:08.117

您可以尝试以十六进制或 json 表示形式编写它。

例如，“此字符串”将变为“\x74\x68\x69\x73\x20\x73\x74\x72\x69\x6e\x67”。有大量的在线工具可以为您做到这一点。例如[这个](http://www.functions-online.com/bin2hex.html)，将完成工作但不会包含“\x”，因此 javascript'll 将其解释为普通字符串。要附加 \x 并具有正确的十六进制格式，请在任何 javascript 控制台中即时执行此函数：（当然用生成的十六进制数字替换引用的文本）

```
"7468697320737472696e67".replace(/([A-F\d]{2})/gi, "\\x$1"); // \x74...\x67 
```

然后只需将此字符串复制到您的源中，它应该可以工作。如果你想解析 xml，看看[这个](http://www.utilities-online.info/xmltojson/)- 另一个将你的 xml 转换为 json 的在线工具，有效的 javascript 对象；赋值时直接使用。

# c# - IOException 创建文件然后尝试访问它时

> ID：14258157
> 
> 赞同：1
> 
> 时间：2013-01-10T12:38:45.247
> 
> 标签：c#, file-io

> **可能重复：**
> [文件在使用 File.Create() 后被另一个进程使用](https://stackoverflow.com/questions/2781357/file-being-used-by-another-process-after-using-file-create)

我有一种方法可以将文本附加到文件中。在我附加文本之前，我检查文件是否存在。如果它不存在我创建它然后继续如下所示。

```
if(!File.Exists(_someFile))
    File.Create(_someFile);

using (StreamWriter file = File.AppendText(_someFile))
{          
    file.WriteLine("some text");
} 
```

如果文件存在，则没有问题。该文件将被更新。如果该文件不存在并且它被创建，则在带有“使用”的行上抛出一个 IO 异常，说明另一个进程正在使用该文件。我尝试使用进程资源管理器找出正在使用该文件的内容，结果是“不存在的进程”。有谁知道发生了什么以及如何解决这个问题？

编辑：问题已解决

当我第一次搜索时，我在这个网站上找不到关于我的问题的问题。一旦我发布了我的问题，我就在右侧的“相关问题”中看到了确切的问题。指向解决方案的链接：[使用 File.Create() 后，另一个进程正在使用文件](https://stackoverflow.com/questions/2781357/file-being-used-by-another-process-after-using-file-create?rq=1) 抱歉发布重复项。我的问题解决了。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-10T12:46:18.957

发生这种情况是因为`File.Create(_someFile);`打开了必须关闭的文件流，然后才能使用新创建的文件。试试这个：

```
if(!File.Exists(_someFile))
{
    using (var stream = File.Create(_someFile))
}
using (StreamWriter file = File.AppendText(_someFile))
{          
    file.WriteLine("some text");
} 
```

但实际上您不需要先检查和创建文件。[如果文件不存在， StreamWriter](http://msdn.microsoft.com/en-us/library/36b035cb%28v=vs.100%29.aspx)将创建该文件，如果存在，则将文本附加到该文件。

```
using (StreamWriter sw = new StreamWriter(_someFile, true))
{
    file.WriteLine("some text");
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-10T13:04:36.177

弗拉德的回答是正确的。由于您想在文件不存在时创建文件并在文件存在时附加到它，所以这是简单的解决方案：

> ```
>  string _someFile = @"C:\somefile.txt";
>         TextWriter tw = new StreamWriter(_someFile, true); // append == true
>         tw.WriteLine("some text");
>         tw.Close(); 
> ```

# c# - 时间：2018-01-01 标签：c#a collection to hold两个arraylist

> ID：14258160
> 
> 赞同：1
> 
> 时间：2013-01-10T12:38:52.897
> 
> 标签：c#, collections, multidimensional-array, arraylist

我正在使用 C#。

我创建了 2 个名为的数组列表`Names`，`Performances`其中的数据是从我的数据库中填充的。

我想创建一个数组列表或类似二维数组的东西 `array[Name][Performance]`。

*   `array[0][0]`=> 应该给我第一人称的第一性能数据
*   `array[0][1]`=> 应该给我第一人称的第二性能数据
*   `array[0][2]`=> 应该给我第一人称第三性能数据...

由于不同的 sql 查询，`Names`和的大小是可变的。`Performance`由于大小是可变的，我尝试在这些循环中使用循环`Name`和数组列表的大小。`Performance`我如何处理该集合以保存我的两个数组列表？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-10T12:44:26.697

为什么不使用通用 List ？

然后，您可以例如创建一个包含 Person 及其性能数据的类型，如下所示：

```
class PersonPerformance
{
   public string Name { get; set; }

   public List<Performance> Performances { get; set; }
} 
```

您可以轻松创建一个集合：

```
var performances = new List<PersonPerformance>(); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-10T12:45:38.487

你可以使用类似的东西

```
 IList<KeyValuePair<string, string>> innerList = new List<KeyValuePair<string, string>>();
        IList<IList<KeyValuePair<String,string>>> list=new List<IList<KeyValuePair<string, string>>>();
        list.Add(innerList); 
```

其中 KeyValuePair 包含名称和性能元素

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-10T12:51:38.077

我假设你的名字是字符串类型。

我通常这样做（如果我没有设置尺寸）

```
List<KeyValuePair<string, TYPE_X>> list = new List<KeyValuePair<string, TYPE_X>>(); 
```

或（大小已知）

```
KeyValuePair<string, TYPE_X>[] array = new KeyValuePair<string, TYPE_X>[size]; 
```

或更好

```
 public Dictionary<string, TYPE_X> dict = new Dictionary<string, TYPE>(); 
```

如果名称是唯一的并且我想这样访问它们（不是按顺序）：

```
TYPE_X object = dict["myName"]; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-10T13:10:38.487

您可以使用使用`Dictionary<Name,List<Performance>>`类型，因此对于每个名称，您都会获得一组表演

# easymock - 如何通过 EasyMock 模拟第三方 API？

> ID：14258164
> 
> 赞同：0
> 
> 时间：2013-01-10T12:39:11.180
> 
> 标签：easymock

**如何通过EasyMock**模拟第三方 API ？

例如：2班--`Employee`我们班，`NPECustomer`-第三方班

假设`Employee`具有`createCustomer`以下代码的方法

```
createCustomer(Employee emp) {
NPECustomer customer = new NPECustomer();
customer.add
customer.finalize
more customer. method and it goes on... 
```

1.  现在的问题是如何通过easy Mock来模拟第三方API
2.  如果模拟第三方 API 不可行或繁琐，有哪些替代方法可以解决上述问题

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2017-08-02T01:52:40.390

可以对任何对象进行模拟。对于第三方广告服务器，我们可以启动模拟服务器。这解决了问题。

# ms-access-2007 - 根据链接子表单中的值在打开时过滤表单

> ID：14258170
> 
> 赞同：0
> 
> 时间：2013-01-10T12:39:42.013
> 
> 标签：ms-access-2007

我有一个基本的搜索页面，用户从一系列选项中选择一个或多个值，这些值用于构建一个字符串，然后在打开表单时将其作为过滤器传递，以便只显示适当的记录。表单本身包含一个子表单。

到目前为止，搜索/过滤一直基于表单主体中的控件，但我现在还需要能够搜索子表单中的字段之一。这可能吗？如果可以，怎么做？

注意。我尝试执行查询以返回一个记录集，该记录集具有我想要显示的表单中每个记录的主键，但坚持使用结果的最佳方式。如果只有一个结果，我可以将它作为字符串传递并且它工作正常，但是如何处理多个值？

# jquery - 超级鱼活动课不工作

> ID：14258172
> 
> 赞同：1
> 
> 时间：2013-01-10T12:39:51.763
> 
> 标签：jquery, html, css, menu, superfish

当我点击一个按钮时，超级鱼不会改变颜色，就像我想要的那样。HTML：

```
<div id="nav" class ="pull-right">   

    <ul id="menu-menu1" class="sf-menu sf-vertical">

                <li id="menu-item-314" class="menu-item"><a href="#">Home</a></li>
                <li id="menu-item-303" class="menu-item"><a href="#">Products</a></li>
                <li id="menu-item-302" class="menu-item"><a href="#">Dreams</a></li>
                <li id="menu-item-301" class="menu-item"><a href="#">Vouchers</a></li>

    </ul>
</div> 
```

我正在使用 superfish 的默认 css 并且一直无法正常工作。

我已经导入了样式 superfish.css 和 superfish.js。一切都很好，更少..

还有什么我需要做的吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-13T21:54:29.330

试试[这个](https://stackoverflow.com/questions/15987696/how-to-add-a-superfish-menu-to-existing-pages)。也许它会帮助你。

它在您的 CSS 中，您应该对其进行编辑。

# bash - 为在运行 SLURM 的集群上运行的 fortran 代码提供标准输入

> ID：14258175
> 
> 赞同：1
> 
> 时间：2013-01-10T12:39:58.083
> 
> 标签：bash, fortran, cluster-computing

我有一个代码，已成功安装在几个使用 PBS 排队系统的计算集群上，但是在使用 SLURM 排队系统将它安装到集群上时遇到了很大的障碍。大部分代码运行良好，但是代码需要提供其文件名（每次计算都会更改），并且它希望将其作为标准输入接收：

```
 character*8 name
      read (5,'(a8)') name 
```

我通过以下方式向集群提供此标准输入：

```
srun_ps $1/$2.exe << EOD
$2
EOD 
```

其中 $1 是可执行文件的路径，$2 是文件名，srun_ps 似乎是集群构建的 mpi-exec 脚本。请注意，这段代码在我与 PBS 排队系统一起使用的集群上运行良好。

但是，我在这里得到的是“读取期间文件结束，单元 5，文件标准输入”错误。

另外，如果我在登录服务器的命令行上运行类似的命令（通过该服务器提交作业）：

```
#helloworld.for
     charachter*5 name
     read(5,A5) name
     write(6,A5) name 
```

命令行：

```
ifort -o helloworld.exe helloworld.for
./helloworld.exe << EOD
hello
EOD 
```

提供正确的“hello”输出。如果我向集群提交相同的作业，我会再次收到“文件结尾”错误。

完整的作业提交脚本是：

```
#!/bin/bash
#SBATCH -o /home/Simulation/file.job.o
#SBATCH -D /home/Simulation/
#SBATCH -J file.job
#SBATCH --clusters=mpp1
#SBATCH --get-user-env
#SBATCH --ntasks=12
#SBATCH --time=1:00:00
source /etc/profile.d/modules.sh
/home/script/runjob /home/Simulation/ file 
```

runjob 脚本的相关部分是（脚本的其余部分正在复制相关的输入文件，并在计算完成后清理文件）：

```
#!/bin/sh
time srun_ps $1/$2.exe << EOD
$2
EOD 
```

我意识到这可能是一个完全过于具体的问题，但任何建议都将不胜感激。

大卫。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-10T12:53:36.727

尝试添加一行，例如

```
#SBATCH -i filename 
```

到您的作业提交脚本，替换为您提交脚本时将扩展`filename`的任何神秘宏（或其他）。`$3`或者，你可以把它放在你的`srun`命令中，比如

```
srun_ps $1/$2.exe EOD 
```

但我承认在你的脚本中调用什么时有些混淆。

# symfony - 在另一个翻译中引用翻译

> ID：14258177
> 
> 赞同：6
> 
> 时间：2013-01-10T12:40:07.443
> 
> 标签：symfony, symfony-2.1

我有这种情况：

```
unit:
    sqkm: Square Kilometers

my_translation: Size is %size% ## I want to append the value of unit.sqkm here ## 
```

有没有办法引用`unit.sqkm`里面`my_translation`键的翻译？

**编辑**：请注意，我确实知道如何通过 twig 做到这一点。我的问题是：**有没有办法在翻译文件中做到这一点**。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2017-08-17T08:18:13.607

我为此扩展了 Symfony Tanslator：

```
<?php

namespace Bundle\Program\Translation;

use Symfony\Bundle\FrameworkBundle\Translation\Translator as BaseTranslator;

class Translator extends BaseTranslator
{
    /**
     * Uses Symfony Translator to translate, but enables referencing other translations via @@code@@
     */
    public function trans($id, array $parameters = array(), $domain = null, $locale = null)
    {
        $text = parent::trans($id, $parameters, $domain, $locale);

        $translations = [];

        $delimiter = "@@";
        $strLen = strlen($delimiter);
        $pos = strpos($text, $delimiter);

        while ($pos !== false) {
            $startsAt = $pos + $strLen;
            $endsAt = strpos($text, $delimiter, $startsAt);
            $translations[] = $delimiter . substr($text, $startsAt, $endsAt - $startsAt) . $delimiter;
            $pos = strpos($text, $delimiter, $endsAt + $strLen);
        }

        foreach ($translations as $translation) {
            $translationTrim = str_replace($delimiter, '', $translation);
            $text = str_replace($translation, $this->trans($translationTrim, $parameters, $domain, $locale), $text);
        }

        return $text;
    }
} 
```

然后通过参数替换 Symfony 翻译器类：

```
parameters:

    translator.class: Bundle\Program\Translation\Translator 
```

现在，您可以通过 @@other.translation@@ INSIDE 引用其他翻译。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-10T13:14:16.777

在你的 Twig 模板中，试试这个：

```
{{ 'my_translation' | trans({'%size%': size, 'unit.sqkm' : ('unit.sqkm'|trans)}) }} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-10T13:13:42.347

您可以在其他翻译中使用翻译后的值。

```
{{ 'paragraph' | trans({ '%size%': 3, '%unit%': 'unit' | trans()}) }} 
```

where`unit`本身是翻译的另一个关键。但是，您的翻译文件可能如下所示：

```
paragraph: Size is %size% %unit%
unit: Square Kilometers 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2018-12-01T02:29:45.610

如果像我一样，你想**在 Symfony 4.1 中实现这一点**，这就是你的解决方案（*非常感谢[@Kim](https://stackoverflow.com/users/2396925/kim)的[回答](https://stackoverflow.com/a/45729921/8179249)和[@Aurelijus Rozenas](https://stackoverflow.com/users/846432/aurelijus-rozenas)的[回答](https://stackoverflow.com/a/40564711/8179249)，除了我的 4 小时尝试之外，所有的功劳都归于他们*）

首先，创建新的 Translator 类（此处：*src* **/Common/ReferenceTranslator.php**）

 *```
# src/Common/ReferenceTranslator.php
namespace App\Common;

use Symfony\Component\Translation\TranslatorBagInterface;
use Symfony\Component\Translation\TranslatorInterface;

class ReferenceTranslator implements TranslatorInterface, TranslatorBagInterface
{
    /** @var TranslatorBagInterface|TranslatorInterface */
    protected $translator;

    /**
     * @param TranslatorInterface|TranslatorBagInterface $translator
     */
    public function __construct($translator)
    {
        $this->translator = $translator;
    }

    /**
     * Uses Symfony Translator to translate, but enables referencing other translations via @@code@@
     * @param $id
     * @param array $parameters
     * @param null $domain
     * @param null $locale
     * @return mixed|string
     */
    public function trans($id, array $parameters = array(), $domain = null, $locale = null)
    {
        $text = $this->translator->trans($id, $parameters, $domain, $locale);

        $translations = [];

        $delimiter = "@@";
        $strLen = strlen($delimiter);
        $pos = strpos($text, $delimiter);

        while ($pos !== false) {
            $startsAt = $pos + $strLen;
            $endsAt = strpos($text, $delimiter, $startsAt);
            $translations[] = $delimiter . substr($text, $startsAt, $endsAt - $startsAt) . $delimiter;
            $pos = strpos($text, $delimiter, $endsAt + $strLen);
        }

        foreach ($translations as $translation) {
            $translationTrim = str_replace($delimiter, '', $translation);
            $text = str_replace($translation, $this->trans($translationTrim, $parameters, $domain, $locale), $text);
        }

        return $text;
    }

    /**
     * @param string $id
     * @param int    $number
     * @param array  $parameters
     * @param null   $domain
     * @param null   $locale
     *
     * @return string
     */
    public function transChoice($id, $number, array $parameters = [], $domain = null, $locale = null)
    {    
        return $this->translator->transChoice($id, $number, $parameters, $domain, $locale);
    }

    /**
     * @param string $locale
     */
    public function setLocale($locale)
    {
        $this->translator->setLocale($locale);
    }

    /**
     * @return string
     */
    public function getLocale()
    {
        return $this->translator->getLocale();
    }

    /**
     * @param string|null $locale
     *
     * @return \Symfony\Component\Translation\MessageCatalogueInterface
     */
    public function getCatalogue($locale = null)
    {
        return $this->translator->getCatalogue($locale);
    }
} 
```

然后编辑你的**services.yaml**文件

```
# app/config/services.yml

    #[...]

services:

    #[...]

    # Custom Translator (References)
    # Overrides the Translator Service (is still available as @app.decorating_translator.inner)
    app.decorating_translator:
        class:     App\Common\ReferenceTranslator
        decorates: translator
        arguments:
            - '@app.decorating_translator.inner'
        public:    false 
```

瞧！同样，如果您知道如何改进这一点，请不要犹豫，因为我不是 Symfony 专家！

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2022-01-18T21:48:05.857

TBG 答案有效，对于 Symfony 4.4，这里是 service.yaml 中的代码

```
Services
    App\Common\ReferenceTranslator:
        arguments:
            $translator: '@translator' 
```

并且不要忘记实现*LocaleAwareInterface*！*

# c++ - 支持 SIMD 的代码？

> ID：14258179
> 
> 赞同：1
> 
> 时间：2013-01-10T12:40:11.357
> 
> 标签：c++, x86, sse, simd, avx

什么代码可以使用 SIMD 指令集的严格定义是什么？是否可以并行运行计算？

所以如果我有：

```
for(int i=0; i<100; i++){
    sum += array[i];
} 
```

这可以利用 SIMD，因为我们可以运行：

```
for(int i=0; i<100;i=i+4){
    sum0 += array[i];
    sum1 += array[i+1];
    sum2 += array[i+2];
    sum3 += array[i+3];
}

sum = sum0 + sum1 + sum2 + sum3; 
```

?

它必须是浮点类型，还是可以是双精度和整数？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-10T12:43:10.023

假设您在谈论 x86（SSE*等*），那么支持的算术类型是 8、16、32 和 64 位整数，以及单精度和双精度浮点数。但请注意，并非所有数据类型都支持所有算术运算 - SSE 在这方面缺乏正交性。

假设 32 位整数和适当对齐的数组（16 字节对齐），那么您可以将上述循环示例实现为：

```
#include <emmintrin.h>                     // SSE2 intrinsics

int32_t a[100] __attribute__ ((aligned(16)));
                                           // suitably aligned array

__m128i vsum = _mm_set1_epi32(0);          // init vsum = { 0, 0, 0, 0 }
for (int i = 0; i < 100; i += 4)
{
    __m128i v = _mm_load_si128(&a[i]);     // load 4 ints from a[i]..a[i+3]
    vsum = _mm_add_epi32(vsum, v);         // accumulate 4 partial sums
}
// final horizontal sum of partial sums
vsum = _mm_add_epi32(vsum, _mm_srli_si128(vsum, 8));
int32_t sum = _mm_cvtsi128_si32(vsum);     // sum = scalar sum of a[] 
```

# ruby-on-rails - 安装 rmovie gem 时无法构建 gem 原生扩展

> ID：14258180
> 
> 赞同：1
> 
> 时间：2013-01-10T12:40:11.843
> 
> 标签：ruby-on-rails, ruby, ffmpeg

我正在尝试在 Ubuntu Desktop 12.04 LTS 上安装**rmovie gem 。**`ffmpeg`已安装，但出现此错误：

```
$ gem install rmovie
Building native extensions.  This could take a while...
ERROR:  Error installing rmovie:
    ERROR: Failed to build gem native extension.

        /home/ror_dev/.rvm/rubies/ruby-1.9.3-p362/bin/ruby extconf.rb
gcc -c -fpic -g  qp_movie.c -o qp_movie.o
In file included from qp_movie.c:4:0:
qp_util.h:4:28: fatal error: ffmpeg/avcodec.h: No such file or directory
compilation terminated.
make: *** [qp_movie.o] Error 1
checking for avcodec_init() in -lavcodec... yes
checking for av_register_all() in -lavformat... yes
checking for quadrupel_init() in -lquadrupel... no
*** extconf.rb failed ***
Could not create Makefile due to some reason, probably lack of
necessary libraries and/or headers.  Check the mkmf.log file for more
details.  You may need configuration options.

Provided configuration options:
    --with-opt-dir
    --with-opt-include
    --without-opt-include=${opt-dir}/include
    --with-opt-lib
    --without-opt-lib=${opt-dir}/lib
    --with-make-prog
    --without-make-prog
    --srcdir=.
    --curdir
    --ruby=/home/ror_dev/.rvm/rubies/ruby-1.9.3-p362/bin/ruby
    --with-ffmpeg-dir
    --without-ffmpeg-dir
    --with-ffmpeg-include
    --without-ffmpeg-include=${ffmpeg-dir}/include
    --with-ffmpeg-lib
    --without-ffmpeg-lib=${ffmpeg-dir}/lib
    --with-quadrupel-dir
    --without-quadrupel-dir
    --with-quadrupel-include
    --without-quadrupel-include=${quadrupel-dir}/include
    --with-quadrupel-lib
    --without-quadrupel-lib=${quadrupel-dir}/lib
    --with-avcodeclib
    --without-avcodeclib
    --with-avformatlib
    --without-avformatlib
    --with-quadrupellib
    --without-quadrupellib
 extconf failed: need quadrupel library 
```

第一次尝试是将 avcodec 重新定位到安装程序正在搜索它的位置。没有成功。下一步 - 更正四重文件中的路径以将其指向 avcodec 所在的位置。没有成功。

这是什么四重物以及如何强制它工作？

或者也许有一些替代 rmovie？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-12T06:09:41.593

使用[github.com/streamio/streamio-ffmpeg](http://github.com/streamio/streamio-ffmpeg)，它的开发更加活跃。`rmovie`是 2006 年开发的，可能与当前版本不兼容`ffmpeg`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-10T12:46:20.050

这样做 -

1) 将 gem 保存在 gemfile 中 -

```
 gem "rmovie", "~> 0.5.1" 
```

2) 运行`bundle install`

如果仍然出现错误，请尝试：

```
sudo apt-get install ffmpeg libavcodec-extra-52 
```

如果找不到包，请尝试：

```
sudo apt-get install ffmpeg libavcodec-extra-53 
```

你也可以尝试安装 libmp3lame0 包：

```
sudo apt-get install libmp3lame0 
```

# c# - Linq to SQL if 语句

> ID：14258187
> 
> 赞同：0
> 
> 时间：2013-01-10T12:40:36.690
> 
> 标签：c#, sql, linq

```
var PAS =
        (from v in dc.PAS
            where
            days.Contains(Convert.ToDateTime(v.fecha))
            group v.valor by new { v.entidad_id, v.modulo_id, v.peticion_id, v.hora_id, v.dia_id } into hg
            orderby hg.Key.entidad_id descending, hg.Key.peticion_id ascending, hg.Key.hora_id descending
            select new
            {
                Hora = hg.Key.hora_id,
                Dia = hg.Key.dia_id,
                Entidad = hg.Key.entidad_id,
                Modulo = hg.Key.modulo_id,
                Peticion = hg.Key.peticion_id,
                Media = Math.Round(System.Convert.ToDouble(hg.Average()), 3, MidpointRounding.AwayFromZero)
            }; 
```

然后做一个foreach，并将每个结果的新行插入到另一个具有这个新值的表中......（因为我不能批量，至少我不知道如何在LINQ中）

我有三个`v.peticion_id`可能的值...我想获得两个 ' `Media`' 列，一个带有实际媒体，另一个仅带有`v.peticion_id = 0`值...我无法更好地解释，所以这里是我想要获得的示例。 ..

```
Hora  |  Dia  |  Entidad  |  Modulo  |  Peticion  |  Media  |  Media2
  0       0         0          0           0         333.3  |  333.3
  0       0         0          0           1         4.4    |  333.3
  0       0         0          0           2         0.7    |  333.3
  1       0         0          0           0         178.2  |  178.2
  1       0         0          0           1         1.8    |  178.2
  1       0         0          0           2         0      |  178.2 
```

我希望有一个人可以帮助我..

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-10T12:47:09.203

只需选择`v.peticion_id == 0`

还是我误解了你想在这里做什么？

# eclipse - 如何在树视图中使用 IProject、IFolder 和 IFile 以仅显示所需文件？

> ID：14258188
> 
> 赞同：1
> 
> 时间：2013-01-10T12:40:36.600
> 
> 标签：eclipse, eclipse-plugin, eclipse-rcp

我只想在我的`TreeViewer`. 仅与具有**.docx**扩展名的文件类似。经过大量研究，我发现这可能通过使用 `IProject`,`IFolder`和`IFile`.

如何使用 `IProject`、`IFolder`和`IFile`在 a`TreeViewer`中仅显示所需文件？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-10T13:09:15.647

只需使用 TreeViewer#addFilter 方法添加一个过滤器，您可以在其中过滤掉所需的文件。

# asp.net - 在 asp.net 表中添加行

> ID：14258189
> 
> 赞同：1
> 
> 时间：2013-01-10T12:40:40.947
> 
> 标签：asp.net, vb.net

我的 .aspx 文件中有以下代码

```
<asp:Table ID="tabStudent" runat="server"></asp:Table> 
```

我声明了我在下面使用的所有变量。`load`我在页面事件中编写了以下代码片段。但它只显示在我的数据库中有最后一行的一行。但是当我在这个`while`循环中使用消息框来`print`获取这些值时，我得到了所有的行。

```
Reader = Command.ExecuteReader()
While Reader.Read()
    lblRollNo.Text = Reader.Item(0)
    lblName.Text = Reader.Item(1)
    lblDob.Text = Reader.Item(2)
    tcRollNo.Controls.Add(lblRollNo)
    tcName.Controls.Add(lblName)
    tcDob.Controls.Add(lblDob)
    TableRow.Cells.Add(tcRollNo)
    TableRow.Cells.Add(tcName)
    TableRow.Cells.Add(tcDob)
    tabStudent.Rows.Add(TableRow)
End While 
```

这段代码有什么问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-10T12:44:32.687

您不是在循环中创建新控件，而是始终重复使用相同的控件。

```
While Reader.Read()
    TableRow = New TableRow()
    lblRollNo = New Label()
    tcRollNo = New TableCell()
    ' and so on ...
    lblRollNo.Text = Reader.Item(0)
    lblName.Text = Reader.Item(1)
    lblDob.Text = Reader.Item(2)
    tcRollNo.Controls.Add(lblRollNo)
    tcName.Controls.Add(lblName)
    tcDob.Controls.Add(lblDob)
    TableRow.Cells.Add(tcRollNo)
    TableRow.Cells.Add(tcName)
    TableRow.Cells.Add(tcDob)
    tabStudent.Rows.Add(TableRow)
End While 
```

# c# - 如何检索从 Web 应用程序发送的数据？

> ID：14258192
> 
> 赞同：1
> 
> 时间：2013-01-10T12:40:43.617
> 
> 标签：c#, asp.net, session-state

在这里，我将单击按钮时的会话 ID 从一个 asp.net 应用程序传递到另一个 asp.net 应用程序。

**应用1：**

```
protected void imgBTN_Click(object sender, EventArgs e)
{
   string sessionKey = HttpContext.Current.Session.SessionID;
   HttpWebRequest req = (HttpWebRequest)WebRequest.Create(@"http://localhost:43392/PartnerHome.aspx");
   string svcCredentials = Convert.ToBase64String(ASCIIEncoding.ASCII.GetBytes(sessionKey));
   req.Headers.Add("Authorization", "Basic " + svcCredentials);
   try
   {
      using (WebResponse svcResponse = (HttpWebResponse)req.GetResponse())
      {
         using (StreamReader sr = new StreamReader(svcResponse.GetResponseStream()))
         {
            string jsonTxt = sr.ReadToEnd();
         }
      }
   }
   catch (Exception c)
   {
   }
} 
```

我的问题是如何在我的第二个 asp.net 应用程序页面加载中检索此会话 ID

**应用 2：**

```
protected void Page_Load(object sender, EventArgs e)
{
} 
```

有什么建议吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-11T08:48:53.653

另一种解决方案：

我要做的是在应用程序 1 的页面上添加一个不可见的图像（一些透明像素）：

`<img src="http://site2.domain.com/transpimage.aspx">`

不可见图像实际上是站点 2 托管的 asp.net 页面。
在 transpimage.aspx 的页面加载事件中。我会输出一些图像：

```
public void Page_Load(...)
{
     using(Bitmap image = new Bitmap(1,1))
     using(MemoryStream stream = new MemoryStream())
     {
          image.Save(stream);
          Response.ContentType = "image/png";
          stream.WriteTo(Response.OutputStream);
          Response.End();
     }
} 
```

由于来自应用程序 2 的图像由 aspx 页面（不是文件中的静态图像）提供，因此它将保持应用程序 2 的会话处于活动状态。我以前做过这个，它往往相当健壮。

如果您熟悉 HttpHandlers，则可以将“图像页面”编写为处理程序，但不要忘记，如果您将其作为处理程序进行，则需要从 IRequiresSessionState 接口继承才能实际访问会话。

希望这可以帮助！

# logging - JBoss 7 - 如何在 jboss 服务器上配置我的应用程序的日志记录

> ID：14258193
> 
> 赞同：1
> 
> 时间：2013-01-10T12:40:58.247
> 
> 标签：logging, jboss7.x

目前我的 Web 应用程序（Jboss 7.1.1、Hibernate 3.6.9、Spring 3.0.1）使用 log4j 进行日志记录。

log4j.xml：

```
<?xml version="1.0" encoding="UTF-8"?> 
```

```
<appender name="application" class="org.apache.log4j.DailyRollingFileAppender">
    <param name="file" value="${jboss.server.log.dir}/my.log" />
    <param name="DatePattern" value="'.'yyyy-MM-dd" />
    <layout class="org.apache.log4j.PatternLayout">
        <param name="ConversionPattern"
            value="%d{ABSOLUTE}|%5p|%c{1}:%L|%X{ipAddress}|%X{deviceId} - %m%n" />
    </layout>
</appender>

<appender name="duration" class="org.apache.log4j.DailyRollingFileAppender">
    <param name="file" value="${jboss.server.log.dir}/my-duration.log" />
    <param name="DatePattern" value="'.'yyyy-MM-dd" />
    <layout class="org.apache.log4j.PatternLayout">
        <param name="ConversionPattern"
            value="%d{ABSOLUTE}|%5p|%c{1}:%L|%X{ipAddress}|%X{deviceId} - %m%n" />
    </layout>
</appender>

<logger name="com.my">
    <level value="debug" />
</logger>

<logger name="com.my.xx.PerformanceLogger"
    additivity="false">
    <level value="info" />
    <appender-ref ref="duration" />
</logger>

<root>
    <priority value="error" />
    <appender-ref ref="application" />
</root> 
```

这是可行的，但现在我必须切换到服务器配置的日志记录。我怎样才能做到这一点？已经在 J​​Boss Application Server 控制台上尝试添加我的处理程序（core/logging/handler --> add），然后定义记录器类别。但是这个定义的日志文件错过了我使用的类中的所有（？）记录器信息：

```
 private static final Logger LOGGER = Logger
        .getLogger(MyClass.class); 
```

# c++ - LLVM 位码跨平台

> ID：14258194
> 
> 赞同：20
> 
> 时间：2013-01-10T12:41:02.367
> 
> 标签：c++, cross-platform, llvm

只是为了确定：LLVM 位码是跨平台的吗？我的意思是，生成的 IR（“.bc”）文件可以在各种平台上分发和解释/JITed 吗？

如果是这样，Clang 如何将 C++ 转换为平台无关代码？而在 C++ 语言本身中，用于确定其目标平台的预处理器是在实际编译之前使用的。

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2013-01-10T14:24:51.630

LLVM IR 可以是跨平台的，除了其他人列出的明显例外。但是，这并不意味着 Clang 会生成跨平台代码。正如您所注意到的，预处理器几乎普遍用于仅将部分代码传递给 C/C++ 编译器，具体取决于平台。即使在用户代码中没有这样做，许多系统头文件也会包含一两个特定于平台的头文件，例如`typedef`s。例如，如果您在32 位`size_t`平台上使用 LLVM IR编译 C 代码，则 LLVM IR 现在用于此目的，并且您无法通过逆向工程来修复它。`size_t``i32`

如果我理解正确，Google 的[Portable Native Client项目（感谢@willglynn 提供链接）通过修复所有目标平台的 ABI 来实现可移植性。](http://nativeclient.googlecode.com/svn/data/site/pnacl.pdf)所以从这个意义上说，它并没有解决上述问题：LLVM IR 不能移植到具有不同 ABI 的平台上。这更便携的唯一原因是客户端提供了一个将 PNaCl ABI 与实际 ABI 匹配的层。换句话说，PNaCl 代码不能移植到许多平台，“PNaCl VM”可以。

所以，底线：如果你非常小心，你可以在多个平台上使用 LLVM IR，但必须做大量的额外工作（Clang 不会做）来抽象 ABI 差异。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2013-01-10T13:31:12.940

**给定一个 IR 文件，我可以确定它可以编译到我的目标吗？**

您*不能*假设任意 IR 文件始终是跨平台的，因为给定文件中的某些内容可能不与平台无关。最值得注意的例子是 IR 可以包含实际的汇编程序序列（通过[模块级](http://llvm.org/docs/LangRef.html#moduleasm)或[内联](http://llvm.org/docs/LangRef.html#inline-assembler-expressions)汇编段），但还有其他例子 - 例如使用目标特定的内在函数或仅在某些目标上支持的调用约定。

**我可以生成保证在所有目标上编译的 IR 文件吗？**

我不知道，但我相信你可以，特别是如果你避免指定内联汇编、调用约定、类型的必需/首选 ABI 等内容。不过，它会影响编译器将执行的优化。

# ruby-on-rails-3 - Ruby on Rails：创建一个“属于”另一个类的实例

> ID：14258198
> 
> 赞同：0
> 
> 时间：2013-01-10T12:41:24.087
> 
> 标签：ruby-on-rails-3

好吧，我是新来的，我有以下几点：

```
class Post < ActiveRecord::Base
   belongs_to :category
   ...
end 
```

和

```
class Category < ActiveRecord::Base
   has_many :posts
   ...
end 
```

我想创建一个帖子，并从下拉列表中选择其类别：

```
...
select("post", "category", Post::CATEGORIES, {:include_blank => true})
... 
```

当我尝试保存时，它说类别属性不存在。

我该怎么做？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-10T12:43:08.757

post 表仅包含类别 ID，因此您需要分配给`category_id`：

```
select("post", "category_id", Post::CATEGORIES, :include_blank => true) 
```

# java - Servlet 过滤器检查附件扩展

> ID：14258201
> 
> 赞同：1
> 
> 时间：2013-01-10T12:41:25.690
> 
> 标签：java, servlet-filters, attachment

我需要限制用户附加带有某些扩展名的文件，例如：bat、exe、bin 等。

为此，我相信我需要编写一个 servlet 过滤器。我是 servlet 的新手，有人可以指导我如何实现这一目标吗？

使用 Servlet 过滤器是正确的方法吗？

任何帮助高度赞赏。如果需要我提供任何其他信息，请告诉我。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-10T12:55:40.030

好吧，您总是可以使用 servlet 过滤器添加某种在 servlet 代码之前运行的验证。根据您构建应用程序的方式，它可能是也可能不是。这是您的架构需求。

servlet过滤器的实现方式其实很简单，可以看一下[http://www.oracle.com/technetwork/java/filters-137243.html](http://www.oracle.com/technetwork/java/filters-137243.html)

关于验证输入扩展。您需要该验证的可信度如何？请记住，用户可能总是在上传文件之前使用扩展名。如果您对此感到放松，您可以以一种非常简单的方式实现它，只需检查`Content-Type`您的请求中的标头以获取有效的 mime 类型。

如果您需要更可靠的验证，您将需要使用更像 Mime-Utils 或类似的东西。检查[在 Java 中获取文件的 Mime 类型](https://stackoverflow.com/questions/51438/getting-a-files-mime-type-in-java)

# android - Android中的GCM推送通知

> ID：14258205
> 
> 赞同：1
> 
> 时间：2013-01-10T12:41:29.293
> 
> 标签：android

我正在使用 Google 示例项目来推送通知，我已经成功构建并部署了客户端和服务器应用程序，并且我能够在服务器端注册设备，当我尝试发送通知时，它显示消息已被推送但我是未在设备或模拟器上通知。

客户端应用程序使用 IDE eclipse 编译和部署，Sample Server 应用程序由 ANT builder 构建并部署在 Tomcat 7 中。

我正在使用带有 gmail 配置的 Android 4.2 Google API 模拟器和设备。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-24T13:44:55.247

在本文中，我将尝试解释如何使用 ASP.NET 和 C# 为 Android 集成推送通知服务。众所周知，移动应用正在成为蓬勃发展的市场趋势。一些自定义移动应用程序使用推送通知服务向应用程序用户提供更新。在这里，我将解释我们如何使用 Google 的 GCM 推送通知服务。

类文件“AndroidGCMPushNotification.cs”

```
 using System;
    using System.Collections.Generic;
    using System.Linq;
    using System.Web;
    using System.Net;
    using System.Text;
    using System.IO;
    using System.Security.Cryptography.X509Certificates;
    using System.Net.Security;
    using System.Collections.Specialized;

public class AndroidGCMPushNotification
{
    public AndroidGCMPushNotification()
    {
        //
        // TODO: Add constructor logic here
        //
    }
    public string SendNotification(string deviceId, string message)
    {
        string GoogleAppID = "google application id";        
        var SENDER_ID = "9999999999";
        var value = message;
        WebRequest tRequest;
        tRequest = WebRequest.Create("https://android.googleapis.com/gcm/send");
        tRequest.Method = "post";
        tRequest.ContentType = " application/x-www-form-urlencoded;charset=UTF-8";
        tRequest.Headers.Add(string.Format("Authorization: key={0}", GoogleAppID));

        tRequest.Headers.Add(string.Format("Sender: id={0}", SENDER_ID));

        string postData = "collapse_key=score_update&time_to_live=108&delay_while_idle=1&data.message=" + value + "&data.time=" + System.DateTime.Now.ToString() + "®istration_id=" + deviceId + "";
        Console.WriteLine(postData);
        Byte[] byteArray = Encoding.UTF8.GetBytes(postData);
        tRequest.ContentLength = byteArray.Length;

        Stream dataStream = tRequest.GetRequestStream();
        dataStream.Write(byteArray, 0, byteArray.Length);
        dataStream.Close();

        WebResponse tResponse = tRequest.GetResponse();

        dataStream = tResponse.GetResponseStream();

        StreamReader tReader = new StreamReader(dataStream);

        String sResponseFromServer = tReader.ReadToEnd();

        tReader.Close();
        dataStream.Close();
        tResponse.Close();
        return sResponseFromServer;
    }
} 
```

您可以通过传递设备 ID 和消息来调用 SendNotification 函数。

```
AndroidGCMPushNotification apnGCM = new AndroidGCMPushNotification();

string strResponse =
apnGCM.SendNotification("123123xxxxxxxxxxxxxxxxxxxxxxxx",
"Test Push Notification message "); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-10T13:30:27.610

要发送 GCM 推送，您实际上并不需要在 berween 拥有第三方服务器。这是 GCM 优于 C2DM 的最佳部分。

```
 HttpClient httpclient = new DefaultHttpClient();

     HttpPost httppost = new HttpPost("https://android.googleapis.com/gcm/send");
     httppost.setHeader("Authorization", "key=" + GCM_AUTH_KEY);
     httppost.setHeader("Content-Type", "application/json");

     try {

        String reqBody = DATA_YOU_WANNA_SEND_INJSON_FORMAT;

        BasicHttpEntity e = new BasicHttpEntity();

        ByteArrayInputStream is = new ByteArrayInputStream(reqBody.getBytes());
        e.setContent(is);
        httppost.setEntity(e);
        Log.d("@@ Data being sent via push : " + reqBody);

        return httpclient.execute(httppost);
     } catch (ClientProtocolException e) {
        Log.e(e.getMessage());
     } catch (IOException e) {
        Log.e(e.getMessage());
     } 
```

通过这种方法，您可以发送推送消息。

如果您谈论演示应用程序为什么不发送推送，那么我在实现时也尝试过，我遇到了同样的问题。

但是使用这种方法你总是可以发送 GCM，唯一的事情是你的设备必须注册。

此外，可以通过以下方式查看结果：

int statusCode = response.getStatusLine().getStatusCode(); Log.d("@@响应状态码::" + statusCode);

```
 if (statusCode == 200) {
           callback.onSuccess();
        } else {
           String reason = response.getStatusLine().getReasonPhrase();
           Log.d("@@ response reason phrase :: " + reason);
           callback.onFailure(reason);
        }
        Log.d("@@ complete response object : " + EntityUtils.toString(response.getEntity())); 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2014-05-13T09:50:47.403

检查您的 Android 模拟器是否正在使用 Google API，并且您已额外安装了 Google Play 服务。

**安装 Google Play 服务：** ![在此处输入图像描述](../Images/1c872e4a248cae260948b7f359835a7b.png)

**选择适用于 Android 模拟器目标的 Google API：** ![在此处输入图像描述](../Images/e367edf754f4fffa4b4eb3582528d386.png)

# java - 渐变颜料在 Apache Batik 的 svggen 中不起作用

> ID：14258206
> 
> 赞同：1
> 
> 时间：2013-01-10T12:41:34.960
> 
> 标签：java, swing, java-2d, batik

我正在使用 Apache Batik 的 SVGGraphics2D 类将我的挥杆绘图调用桥接到 SVG。除了完全忽略 LinearGradientPaint 元素外，它工作正常。[设置代码取自 svggen 教程](http://xmlgraphics.apache.org/batik/using/svg-generator.html)，并且尽可能简单。

svg 文件报告“填充：无”。有什么我遗漏的东西还是这是一个错误？该代码使用蜡染版。JRE 1.6 Swing 类上的 1.7。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-11T09:25:23.373

正如 lbalazscs 所指出的，问题在于扩展处理程序。我在网上没有找到 svggen ExtensionHandler 的正确实现，所以我自己写了一个。

代码处理 LinearGradientPaint 和 RadialGradientPaint （随意添加更多）

[https://gist.github.com/4509119](https://gist.github.com/4509119)

Batik 的问题跟踪器也报告了该片段：

[https://issues.apache.org/jira/browse/BATIK-1032](https://issues.apache.org/jira/browse/BATIK-1032)

# cuda - 如何使用 CUDA C 快速压缩稀疏数组？

> ID：14258210
> 
> 赞同：4
> 
> 时间：2013-01-10T12:41:41.753
> 
> 标签：cuda, gpgpu, sparse-array

## 概括

设备内存中的数组`[A - B - - - C]`但想要`[A B C]`- 使用 CUDA C 最快的方法是什么？

## 语境

我`A`在设备（GPU）内存上有一个整数数组。在每次迭代中，我随机选择几个大于 0 的元素并从中减去 1。我维护`L`那些等于 0 的元素的排序查找数组：

```
Array A:
       @ iteration i: [0 1 0 3 3 2 0 1 2 3]
   @ iteration i + 1: [0 0 0 3 2 2 0 1 2 3]

Lookup for 0-elements L:
       @ iteration i: [0 - 2 - - - 6 - - -]  ->  want compacted form: [0 2 6]
   @ iteration i + 1: [0 1 2 - - - 6 - - -]  ->  want compacted form: [0 1 2 6] 
```

（*在这里，我随机选择元素`1`并`4`从中减去 1。在 CUDA C 中的实现中，每个线程都映射到 中的一个元素`A`，因此查找数组是稀疏的，以防止数据竞争并保持排序顺序（例如`[0 1 2 6]`，而不是`[0 2 6 1]`） .* )

稍后，我将只对那些等于 0 的元素进行一些操作。因此我需要压缩我的稀疏查找数组`L`，以便我可以将线程映射到 0 元素。

因此，使用 CUDA C 在设备内存上压缩稀疏数组的最有效方法是什么？

非常感谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-10T20:46:29.343

假设我有：

```
int V[] = {1, 2, 0, 0, 5}; 
```

我想要的结果是：

```
int R[] = {1, 2, 5} 
```

实际上，我们正在删除零元素，或者仅在非零时复制元素。

```
#include <thrust/device_ptr.h>
#include <thrust/copy.h>
#include <stdio.h>
#define SIZE 5

#define cudaCheckErrors(msg) \
    do { \
        cudaError_t __err = cudaGetLastError(); \
        if (__err != cudaSuccess) { \
            fprintf(stderr, "Fatal error: %s (%s at %s:%d)\n", \
                msg, cudaGetErrorString(__err), \
                __FILE__, __LINE__); \
            fprintf(stderr, "*** FAILED - ABORTING\n"); \
            exit(1); \
        } \
    } while (0)

  struct is_not_zero
  {
    __host__ __device__
    bool operator()(const int x)
    {
      return (x != 0);
    }
  };

int main(){

  int V[] = {1, 2, 0, 0, 5};
  int R[] = {0, 0, 0, 0, 0};
  int *d_V, *d_R;

  cudaMalloc((void **)&d_V, SIZE*sizeof(int));
  cudaCheckErrors("cudaMalloc1 fail");
  cudaMalloc((void **)&d_R, SIZE*sizeof(int));
  cudaCheckErrors("cudaMalloc2 fail");

  cudaMemcpy(d_V, V, SIZE*sizeof(int), cudaMemcpyHostToDevice);
  cudaCheckErrors("cudaMemcpy1 fail");

  thrust::device_ptr<int> dp_V(d_V);
  thrust::device_ptr<int> dp_R(d_R);
  thrust::copy_if(dp_V, dp_V + SIZE, dp_R, is_not_zero());

  cudaMemcpy(R, d_R, SIZE*sizeof(int), cudaMemcpyDeviceToHost);
  cudaCheckErrors("cudaMemcpy2 fail");

  for (int i = 0; i<3; i++)
    printf("R[%d]: %d\n", i, R[i]);

  return 0;

} 
```

struct 定义为我们提供了一个测试零元素的函子。请注意，在推力中，没有内核，我们也没有直接编写设备代码。这一切都发生在幕后。而且我绝对建议您熟悉[快速入门指南](https://github.com/thrust/thrust/wiki/Quick-Start-Guide)，以免将这个问题变成推力教程。

在查看评论后，我认为这个修改后的代码版本将解决 cuda 4.0 问题：

```
#include <thrust/device_ptr.h>
#include <thrust/copy.h>
#include <thrust/device_vector.h>
#include <thrust/host_vector.h>
#include <stdio.h>
#define SIZE 5

  struct is_not_zero
  {
    __host__ __device__
    bool operator()(const int x)
    {
      return (x != 0);
    }
  };

int main(){

  int V[] = {1, 2, 0, 0, 5};
  int R[] = {0, 0, 0, 0, 0};

  thrust::host_vector<int> h_V(V, V+SIZE);
  thrust::device_vector<int> d_V = h_V;
  thrust::device_vector<int> d_R(SIZE, 0);

  thrust::copy_if(d_V.begin(), d_V.end(), d_R.begin(), is_not_zero());
  thrust::host_vector<int> h_R = d_R;

  thrust::copy(h_R.begin(), h_R.end(), R);

  for (int i = 0; i<3; i++)
    printf("R[%d]: %d\n", i, R[i]);

  return 0;

} 
```

# asp.net-mvc - MVC 发布 IPagedList

> ID：14258212
> 
> 赞同：4
> 
> 时间：2013-01-10T12:41:43.767
> 
> 标签：asp.net-mvc, checkbox, pagedlist

我有以下 PagedListModel：

```
public class PagedClientViewModel
{
    public int? Page { get; set; }
    public PagedList.IPagedList<ClientViewModel> Clients { get; set; }               
}

public class ClientViewModel
{        
    public string ClientNumber { get; set; }
    public bool UseThisClient{ get; set; }
} 
```

我的观点是这样的：

```
@using (Html.BeginForm("Index", "Home", FormMethod.Get, new { id = "Form" }))
{
    @foreach (var item in Model.Clients)
    {
       @Html.DisplayFor(modelItem => item.ClientNumber)
       @Html.CheckBoxFor(modelItem => item.UseThisClient)
    }    

 @Html.HiddenFor(model => model.Clients)            
} 
```

控制器动作：

```
 public ActionResult Index(PagedClientViewModel model)
 {
  //...process all clients in the list
 } 
```

我想将模型发布回控制器，以便我可以处理已勾选的复选框，但我收到以下错误：我有点理解该错误是因为我正在回发一个接口但我找不到方法周围。我怎样才能得到这份工作？

> 无法创建接口的实例。在 System.RuntimeTypeHandle.CreateInstance（RuntimeType 类型，Boolean publicOnly，Boolean noCheck，Boolean& canBeCached，RuntimeMethodHandleInternal& ctor，Boolean& bNeedSecurityCheck）在 System.RuntimeType.CreateInstanceSlow（Boolean publicOnly，Boolean skipCheckThis，Boolean fillCache，StackCrawlMark 和 stackMark）在 System.RuntimeType.CreateInstanceDefaultCtor （布尔 publicOnly，布尔 skipCheckThis，布尔填充缓存，StackCrawlMark 和 stackMark）
> 在 System.Activator.CreateInstance（类型类型，布尔非公共）
> 在 System.Activator.CreateInstance(Type type) 在 System.Web.Mvc.DefaultModelBinder.CreateModel(ControllerContext controllerContext, ModelBindingContext bindingContext, Type modelType) 在 System.Web.Mvc.DefaultModelBinder.BindSimpleModel(ControllerContext controllerContext, ModelBindingContext bindingContext, ValueProviderResult valueProviderResult)在 System.Web.Mvc.DefaultModelBinder.BindModel(ControllerContext controllerContext, ModelBindingContext bindingContext) 在 System.Web.Mvc.DefaultModelBinder.GetPropertyValue(ControllerContext controllerContext, ModelBindingContext bindingContext, PropertyDescriptor propertyDescriptor, IModelBinder propertyBinder)
> 在 System.Web.Mvc.DefaultModelBinder.BindProperty(ControllerContext controllerContext, ModelBindingContext bindingContext, PropertyDescriptor propertyDescriptor) 在 System.Web.Mvc.DefaultModelBinder.BindProperties(ControllerContext controllerContext, ModelBindingContext bindingContext) 在 System.Web.Mvc.DefaultModelBinder.BindComplexElementalModel(ControllerContext controllerContext) , ModelBindingContext bindingContext, 对象模型)
> 在 System.Web.Mvc.DefaultModelBinder.BindComplexModel(ControllerContext controllerContext, ModelBindingContext bindingContext) 在 System.Web.Mvc.DefaultModelBinder.BindModel(ControllerContext controllerContext, ModelBindingContext bindingContext) 在 System.Web.Mvc.ControllerActionInvoker.GetParameterValue(ControllerContext controllerContext, ParameterDescriptor parameterDescriptor ) 在 System.Web.Mvc.ControllerActionInvoker.GetParameterValues(ControllerContext controllerContext, ActionDescriptor actionDescriptor) 在 System.Web.Mvc.Async.AsyncControllerActionInvoker.<>c_ *DisplayClass25.b* _1e(AsyncCallback asyncCallback, Object asyncState) 在 System.Web.Mvc。 Async.AsyncResultWrapper.WrappedAsyncResult`1.Begin(AsyncCallback callback, Object state, Int32 timeout) at System.Web.Mvc.Async.AsyncControllerActionInvoker.BeginInvokeAction(ControllerContext controllerContext, String actionName, AsyncCallback callback, Object state) at System.Web.Mvc.Controller.<>c__DisplayClass1d.<BeginExecuteCore>b__17(AsyncCallback asyncCallback, Object asyncState) at System.Web.Mvc.Async.AsyncResultWrapper.WrappedAsyncResult`1.开始（AsyncCallback 回调，对象状态，Int32 超时）在 System.Web.Mvc.Controller.BeginExecuteCore（AsyncCallback 回调，对象状态）在 System.Web.Mvc.Async.AsyncResultWrapper.WrappedAsyncResult`1.Begin(AsyncCallback callback, Object state, Int32 timeout) at System.Web.Mvc.Controller.BeginExecute(RequestContext requestContext, AsyncCallback callback, Object state) at System.Web.Mvc.Controller.System.Web.Mvc.Async.IAsyncController.BeginExecute(RequestContext requestContext, AsyncCallback callback, Object state) at System.Web.Mvc.MvcHandler.<>c__DisplayClass8.<BeginProcessRequest>b__2(AsyncCallback asyncCallback, Object asyncState) at System.Web.Mvc.Async.AsyncResultWrapper.WrappedAsyncResult`1.在 System.Web.Mvc.MvcHandler.BeginProcessRequest(HttpContextBase httpContext, AsyncCallback 回调, 对象状态) 处 System.Web.Mvc.MvcHandler.BeginProcessRequest(HttpContext httpContext, AsyncCallback 回调处的开始(AsyncCallback 回调, 对象状态, Int32 超时),对象状态）在 System.Web.Mvc.MvcHandler.System.Web.IHttpAsyncHandler.BeginProcessRequest(HttpContext context, AsyncCallback cb, Object extraData) 在 System.Web.HttpApplication.CallHandlerExecutionStep.System.Web.HttpApplication.IExecutionStep.Execute() 在System.Web.HttpApplication.ExecuteStep(IExecutionStep step, Boolean& completedSynchronously)

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-01-19T14:51:27.150

解决此问题的方法是将分页元数据作为单独的属性传递，并在视图中重建 IPagedList。像下面

```
public class PagedClientViewModel
{
    public int? Page { get; set; }
    public List<ClientViewModel> Clients { get; set; }
    public IPagedList PagingMetaData { get; set; } 
} 
```

生成元数据

```
pagedClientViewModel.PagingMetaData = new StaticPagedList<ClientViewModel>(pagedClientViewModel.Clients, pageIndex, pageSize, TotalClients).GetMetaData(); 
```

在视图中构造寻呼机

```
<div style="text-align: center">
    @Html.PagedListPager(new StaticPagedList<ClientViewModel>(Model.Clients, Model.PagingMetaData), page => Url.Action("<actionname>", new { page }), PagedListRenderOptions.Classic)
</div> 
```

# css - 尝试将子菜单添加到 CSS

> ID：14258219
> 
> 赞同：0
> 
> 时间：2013-01-10T12:42:13.850
> 
> 标签：css, menu, submenu

[我正在尝试在http://jsfiddle.net/hozey/9dGuc/](http://jsfiddle.net/hozey/9dGuc/)向 css 添加子菜单，但似乎无法掌握它。有人可以帮助这个新手吗？这是html。我想为 Horses 1、2 和 3 创建一个子菜单。

```
<div class="menu">
<ul>
<!--begin to insert contents-->
<li class="item-first"><a href="http://www.lawsart.com" target="_top">Home</a></li>
<li><a class="current">Portfolio &#9660;</a>
<ul>
<li><a href="http://www.lawsart.com/Horses1.html" target="_top">Horses 1</a></li>
<li><a href="http://www.lawsart.com/Horses2.html" target="_top">Horses 2</a></li>
<li><a href="http://www.lawsart.com/Horses3.html" target="_top">Horses 3</a></li>
<li><a href="http://www.lawsart.com/Dogs.html" target="_top">Dogs</a></li>
<li><a href="http://www.lawsart.com/People.html" target="_top">People</a></li>
<li><a href="http://www.lawsart.com/Stills.html" target="_top">Stills</a></li>
</ul>
</li>
<li><a href="http://www.lawsart.com/Order.html" target="_top">Order</a></li>
<li><a href="http://www.lawsart.com/Contact.html" target="_top">Contact Me</a></li>
</ul>
</div> <!-- end menu -->

</div> 
```

这是我到目前为止的CSS：

```
body {
  margin: 0px;
}
#wrapper {
  border: px solid black;
  margin: 1em auto;
  font-family: Arial,Helvetica,sans-serif;
  width: 760px;
  text-align: left;
  background-color: #cccccc;
  overflow:hidden;
  height:150px;
}

.menu {font-family: arial, sans-serif;width:760px;position:relative;font-size:0.7em; margin:0px auto;}

.menu ul li a {display:block; 
               text-decoration:none; 
               width:97px; 
               height:25px; 
               text-align:center; 
               color:white; 
               padding-left:1x; 
               border:px solid; 
               border-width:0 0px 0px 0; 
               background:; 
               line-height:25px; 
               font-size:1.0em;}

.menu ul {padding:0;margin:0;list-style-type: none; }

.menu ul li {float:left;position:relative;}

.menu ul li ul {visibility:hidden;position:absolute;}

.menu ul li:hover a, .menu ul li a:hover {color:white;background:#3BA110;}

.menu ul li:hover ul, .menu ul li a:hover ul {visibility:visible;left:0;}

.menu ul li:hover ul li a, .menu ul li a:hover ul li a {display:block; 
                                                        background:#444444; 
                                                        color:white; 
                                                        width:97px; 
                                                        padding-left:1px;
                                                        border-right:none;}

.menu ul li:hover ul li a:hover, .menu ul li a:hover ul li a:hover {background:#3BA110;color:white;} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-10T14:32:25.943

[这将使您入门](http://jsfiddle.net/QR9S5/)，尽管它远非完美。正如 Zeta 所指出的，[如果没有子组合](http://www.w3.org/TR/selectors/#child-combinators)器，制作深度嵌套的菜单不仅很困难，而且还会导致糟糕的代码。

您需要做的是确保您*确切*知道每个选择器的目标是什么。您希望您的第二层和第三层`li`的行为不同，因此您需要确定第二层的选择器不会影响第三层。

从字面上看，我为解决您的问题所做的所有事情都是在您已经拥有的代码上的所有地方应用子组合器，因为我知道您正在为第一层和第二层菜单项编写代码。在那之后，我添加了一个简单的选择器来定位第三层项目，并有一个工作菜单。

如果我是你，我会回顾你的代码并确保你确切地知道你的选择器的目标是什么，然后重写你的 CSS。做起来并不难，而且对于非常复杂的嵌套菜单，它可能会导致非常少的代码。

# html（仅适用于第三层菜单项）

```
...
<!-- the rest of the menu -->
  <li>
    <a href="http://www.lawsart.com/Horses1.html" target="_top">Horses 1</a>
    <ul>
      <li>Submenu1</li>
      <li>Submenu2</li>
    </ul>
  </li>
<!-- the rest of the menu -->
... 
```

# css（仅适用于第三层）

```
.menu ul ul ul { visibility: hidden; position: absolute; top: 0; left: 97px; }
.menu ul ul li:hover ul { visibility: visible; background-color: #eee; } 
```

仅举几个如何选择不同层级菜单和项目的示例：

## css（以“标题项”为目标）

```
.menu > ul > li { } 
```

## css（以第一个下拉列表为目标）

```
.menu > ul > li > ul { } 
```

## css（以第一个下拉项目为目标）

```
.menu > ul > li > ul > li { }
.menu ul ul > li { } /* This will also target submenu items */
.menu > ul > ul > li { } 
```

## css（将子菜单定位到下拉项）

```
.menu > ul > li > ul > li > ul { }
.menu ul ul ul { } 
```

## css（以下拉项的子菜单项为目标）

```
.menu > ul > li > ul > li > ul > li { }
.menu ul ul ul li { } 
```

我们可以从上面的代码中收集到的是，在您到达菜单的最后一层之前，您不想停止使用子组合器。一般来说，`menu ul[n] li`在我使用伪代码表示*n*个`ul`s 的地方，将针对菜单中任何比*n深度更深的**li 。*因此，在您的情况下，可以使用第三层是最后一层。但是您不想使用仅用于第一个下拉菜单的样式，因为该选择器还针对第三个、第四个等深度。*`.menu ul ul ul li``.menu ul ul li`*

 *为了完整起见，获得深度嵌套菜单的最低要求是通过这样的思考来完成的：

您希望第一个*ul*之后的任何内容都以隐藏状态开始。所以你可以这样做：

```
.menu ul ul { visibility: hidden; } 
```

这隐藏了嵌套在另一个 ul 中的*任何**ul*。所以它击中了我们所有的子菜单。它仅适用于我们菜单中的列表。

 *然后，当您将鼠标悬停在其父链接上时，您希望每个子菜单都可见。我们可以用一个选择器来处理我们所有的子菜单，我认为：

```
.menu li:hover > ul { visibility: visible; } 
```

这应该足以适用于菜单的每个级别。从右到左阅读，当我们将鼠标悬停在作为其直接父级的*li*上时，我们使*ul可见。*而且，像往常一样，这仅适用于我们菜单中的*li 。*

 **当然，如果你愿意，你也可以使用*a*。

CSS 菜单是思考和了解[CSS 效率](https://stackoverflow.com/questions/14156362/the-most-efficient-css-selector-header-tag-class-or-id/14156622#14156622)的好时机。一旦你有一个工作菜单，看看你是否可以优化它！我在这里发布的标签可能不是最快的；我只是从头顶想到它们。我会留给你找到最好的选择器来使用。

这就是复杂嵌套 CSS 菜单的基础。希望能帮助到你。****

# sql-server - 多值参数错误

> ID：14258223
> 
> 赞同：0
> 
> 时间：2013-01-10T12:42:30.977
> 
> 标签：sql-server, reporting-services

我制作了几个使用数据源作为参数值的报告。在可用值和默认值中指定了相同的查询，以便我可以一次选择多个值。查询用法是这样的：

```
WHERE (Column.Name IN (@Parameter)) 
```

但是，我收到此错误：

![错误截图](../Images/b8c6440eb768b77a3fa8b043c0904d38.png)

任何想法可能是什么？使用相同方法的其他报告工作正常，但使用此方法则不行。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-11T13:48:51.437

所以我运行 SQL Profiler 并看到错误来自正在查看的代码是 param a null (@param is null) 这是错误的，因为我已经准备好现在允许 null

谢谢你克里斯拉塔你帮我分配:)

# jquery - 禁用 Flexslider 中的 css3 过渡？

> ID：14258224
> 
> 赞同：0
> 
> 时间：2013-01-10T12:42:38.247
> 
> 标签：jquery, css, flexslider

有谁知道如何在 Flexslider v2 中禁用 CSS3 过渡？有人告诉我你可以禁用它们，但不知道怎么做。

目前，过渡可能会导致与 ipad Safari 中的 video.js 发生冲突。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-10T12:57:22.033

我找到了; 我设置了'useCSS：false'和'video：true'。这禁用了过渡，但遗憾的是，在某个地方似乎仍然存在冲突，导致视频停止工作。

回到绘图板！

# shell - 用于将参数传递给 perl 脚本的 shell 脚本

> ID：14258227
> 
> 赞同：0
> 
> 时间：2013-01-10T12:42:45.440
> 
> 标签：shell

我对 shell 脚本完全陌生，非常感谢一些帮助。基本上我想在 shell 脚本中传递一个日志路径作为参数。有人可以向我解释如何做到这一点吗？示例代码将不胜感激。

编辑-我需要一个将参数传递给 perl 代码的 sh 代码。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-10T13:42:47.907

如果您有一个名为的 perl 脚本，例如 ，`script.pl`您将向它传递一个像这样的参数：

```
$ perl script.pl arg1 
```

或者，如果`script.pl`是可执行的并且在您的 中`$PATH`，那么只需：

```
$ script.pl arg1 
```

在您的 perl 脚本中，您可以将命令行参数作为全局`@ARGV`数组的索引来访问。因此，要打印出脚本的第一个参数，代码如下所示：

```
#!/usr/bin/perl

print "First argument: ", $ARGV[0], "\n"; 
```

# android - 为什么推送通知服务器准确地向客户端发送消息

> ID：14258233
> 
> 赞同：0
> 
> 时间：2013-01-10T12:43:11.957
> 
> 标签：android, ios, push-notification, windows-phone, android-c2dm

以 iOS 中的 Facebook 应用程序为例，使用 Apple 推送通知服务 (APNS)。我认为当 Facebook 服务器看到新提要或新朋友请求时，它会向 APNS 发送消息。之后，APNS 将向正在登录该 Facebook 帐户的客户端推送通知。我的问题是：

1.  为什么 APNS 知道哪个设备登录了该 Facebook 帐户？
2.  APNS 如何准确地向该客户端发送消息（为什么 APNS 知道客户端的 IP 地址）？

据我所知，推送通知也是 Windows Phone（Microsoft 推送通知服务）和 Android（云到设备消息）中使用的一种技术。

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-10T12:45:52.437

APNS（Apple 推送通知服务）适用于每个设备的每个应用唯一 ID。您将消息推送到此唯一 ID，然后它会在用户设备上传递。

您的应用程序必须请求此 ID 并将其传递给将发送通知的服务器。ID 是由 APNS API 创建的，因此 Apple 知道 ID 属于该设备和应用程序。我猜windows和android会以同样的方式工作。

# android - Touchwiz 未调用 onOffsetsChanged

> ID：14258234
> 
> 赞同：9
> 
> 时间：2013-01-10T12:43:17.907
> 
> 标签：android, live-wallpaper

注意：因为这是三星特有的问题，所以我也在他们的[开发板上](http://developer.samsung.com/forum/thread/onoffsetschanged-not-called-in-live-wallpaper/77/217103?boardName=GeneralB&startId=zzzzz~)问过。

我目前正在 Android 中实现动态壁纸，并且我正在监听我的壁纸引擎中的 onOffsetsChanged() 方法，以在用户在他的主屏幕上滑动时更改壁纸。这在我的带有 CM9 自定义 rom 的私人 Galaxy Tab 上效果很好。在我的公司设备上，一个股票 Galaxy S3，它不起作用。当主屏幕更改时，Touchwiz 不会以某种方式调用 onOffsetsChanged。

谷歌搜索该主题并没有产生任何显着的结果，除了[这个应用程序](https://play.google.com/store/apps/details?id=com.samsung.android.livewallpaper.parallaxspring)的描述，其中开发人员声明：“修复了最新的 TouchWiz 启动器上的滚动，其中 onOffsetsChanged() 没有被调用。” 现在我只想联系开发人员，但不幸的是它也是一个三星应用程序。

有谁知道在不依赖 onOffsetsChanged 的​​情况下获取当前偏移量的解决方法？有没有人在自己的壁纸中遇到过这个问题？有谁知道这是否是故意的，或者我是否可以假设未来的 Touchwiz 版本将再次使用该方法？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-03-28T14:40:17.753

一些开发人员正在使用触摸事件而不是系统 onOffsetsChanged() 来使用 TouchWiz。我认为，目前唯一更好的方法是使用混合事件系统，它将以这种方式工作：

**1)**始终假设 onOffsetsChanged() 消息未正确发送（使布尔属性默认为 false）。
**2）**这意味着你应该实现onTouch（）方法来正确模仿onOffsetsChanged（）。仅当布尔属性仍然为假时才收听 onTouch()。
**3)**当 onOffsetsChanged() 被调用时，检查 xOffset 参数。如果既不是 0.0f 也不是 0.5f，则将布尔属性更改为 true 并仅监听 onOffsetsChanged()。

代码将是这样的：

```
public class myEngine extends WallpaperService.Engine {
    private boolean offsetChangedWorking = false;

    public void onOffsetsChanged (float xOffset, float yOffset, float xOffsetStep, float yOffsetStep, int xPixelOffset, int yPixelOffset) {
        if (offsetChangedWorking == false && xOffset != 0.0f && xOffset != 0.5f) {
            offsetChangedWorking = true;
        }

        if (offsetChangedWorking == true) {
            // Do sth here
        }
    }

    public void onTouchEvent(MotionEvent paramMotionEvent) {
        if (offsetChangedWorking == false) {
            // Do sth else here
        }
    }
} 
```

此代码只是一个**说明**。请注意，将浮点数与 == 进行比较是不正确的，但在这种情况下它可能会起作用。

此外，三星 Parallax LWP 的工作方式似乎相同。如果您的设备带有 TouchWiz 和其他一些正常工作的启动器（通常会发送 onOffsetsChanged()），您可以自己尝试：

1) 首先在 TouchWiz 上设置视差 LWP（很重要！），看看它只依赖于 onTouchEvent()
2) 将启动器更改为另一个。看到 LWP 现在依赖于 onOffsetsChanged()
3) 再次将启动器更改为 TouchWiz，然后看到滑动不再适用于此 LWP。

所以我建议添加的是在每个 onResume() 事件上将布尔 offsetChangedWorking 再次更改为 false。这应该可以防止启动器更改出现此类错误。

# php - Jquery使用post属性传递ajax调用

> ID：14258235
> 
> 赞同：1
> 
> 时间：2013-01-10T12:43:18.227
> 
> 标签：php, jquery, ajax

在这里检查了几个关于堆栈溢出和 jquery 文档的主题，但仍然卡住了。

我基本上希望这个发布（使用 ajax/jquery）来更新 div 的内容。

```
function loadSubCats(value)
{
    $.post("load_sub_cats.php",
        data: { "catid": value },
        type: "POST",
        contentType: "application/x-www-form-urlencoded",
            function(data) {
        $('#sub_categories').html("Data Loaded: " + data);
    });
} 
```

但我没有得到任何回应。该页面包含 sub_categories div，这称为表单事件的 onclick。

```
<select name='cselect3' onChange='loadSubCats(this.value)' class='e1'> 
```

所以基本上，它应该超过字段（cselect3）的值，并且 load_sub_cats.php 应该只是 echo $_POST[catid]; 就是这样。但是我对它的活动为零，所以它认为它很简单，我搞砸了。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-10T12:46:24.890

您正在混合不同的`$.post`语法`$.ajax`。如果要使用对象语法，请调用`$.ajax`，因为`$.post`将其参数作为简单的未命名列表。

```
function loadSubCats(value)
{
   $.ajax({
        url : "load_sub_cats.php",
        data: { "catid": value },
        type: "POST",
        contentType: "application/x-www-form-urlencoded",
        success: function(data) {
            $('#sub_categories').html("Data Loaded: " + data);
        }
    });
} 
```

您也可以直接附加`change`事件，而不是内联并取消该`loadSubCats()`函数：

```
$(document).ready(function(){
    $('select[name=cselect3]').change(function(){
       $.ajax({
            url : "load_sub_cats.php",
            data: { "catid": $(this).val() },
            type: "POST",
            contentType: "application/x-www-form-urlencoded",
            success: function(data) {
                $('#sub_categories').html("Data Loaded: " + data);
            }
        });
    });
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-10T13:05:30.177

你有`$.post`语法问题。应该是这样的：

```
function loadSubCats(value)
{
    $.post("load_sub_cats.php",{ "catid": value },
            function(data) {
        $('#sub_categories').html("Data Loaded: " + data);
    });
} 
```

就这么简单。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-10T13:08:15.073

```
function loadSubCats(value)
{
$.post("load_sub_cats.php",
    {  catid: value }, 
     function(data) {
     $('#sub_categories').html("Data Loaded: " + data); }
     );
} 
```

你发送 catid 不是 "c​​atid"

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2013-01-10T12:48:31.030

两件事情：

您正在使用不需要的帖子类型。

即使删除它也不起作用，只是尝试提醒它-

```
function loadSubCats(value)
{
    $.post("load_sub_cats.php",
        data: { "catid": value },
        type: "POST",
        contentType: "application/x-www-form-urlencoded",
            function(data) {
          alert(data)
         $('#sub_categories').html("Data Loaded: " + data);
    });
} 
```

通过提醒你会知道 - 1）如果有任何 php 错误，它会提醒，2）如果 php 工作正常，它会提醒你的值。

根据最新评论更新我的帖子：尝试使用如下：

```
$(document).ready(function() {
  $('.e1').change(function() {
        $.post("load_sub_cats.php",
        data: { "catid": value },
        type: "POST",
        contentType: "application/x-www-form-urlencoded",
            function(data) {
          alert(data)
         $('#sub_categories').html("Data Loaded: " + data);
    });  
  })
}); 
```

# symfony - Orangehrm：新建菜单功能

> ID：14258237
> 
> 赞同：4
> 
> 时间：2013-01-10T12:43:22.187
> 
> 标签：symfony, orangehrm

我是 symfony 框架的新手。现在我正在定制 orangehrm 以满足某些新要求。

例如：类似于Admin>Qualifications>skills菜单，我需要创建Admin>Qualifications>Category。我通过编辑index.php文件对菜单进行了修改。

这个新页面的功能类似于“技能”页面。但是我们需要使用不同的数据库表。Orangehrm 使用原则进行数据库相关操作。我对教义也完全不熟悉。

有人可以提供实施“管理>资格>类别”功能的说明吗？这很紧急，我认为过程也很简单（不确定）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2016-05-02T15:30:11.307

首先，您必须在数据库中添加菜单，然后在您的特定模块中创建类。

第 1 步：检查您要在哪个模块中添加菜单。模块列表在 ohrm_module 表中。

第 2 步：检查您要添加菜单的用户卷。用户卷在 ohrm_user_role 中。

第 3 步：在模块的基础上添加屏幕（第 1 步）。将数据插入 ohrm_screen

第 4 步：在屏幕的基础上添加菜单项（第 3 步）。插入 ohrm_menu_item

第 5 步：根据用户滚动（第 2 步）和屏幕（第 3 步）为用户分配屏幕。插入 ohrm_user_role_screen

第 6 步：注销并再次登录。新菜单将在那里。

第 7 步：转到您的插件文件夹并在类似此类 YourLinkNameAction extends sfAction { //SANI: Start all coding in execute method } 的操作文件夹中创建您的控制器 第 8 步：在模板文件夹中创建您的视图，如 YourLinkNameSuccess.php

就这样

# javascript - 使用javascript用值填充asp隐藏字段

> ID：14258238
> 
> 赞同：2
> 
> 时间：2013-01-10T12:43:25.387
> 
> 标签：javascript, asp.net, hidden-field

我想从服务器端访问用户屏幕分辨率。为此，我可以`asp hidden`控制：

```
<asp:HiddenField runat="server" ID="hdnScreenResolution" /> 
```

实际在页面上呈现：

```
<input type="hidden" name="ctl00$MainContent$hdnScreenResolution" id="MainContent_hdnScreenResolution" /> 
```

我使用 javascript 函数在其中插入值：

```
$(document).ready(function () {
   var width = screen.width;
   var height = screen.height;

   var hiddenScreenResolution = document.getElementById('<%= hdnScreenResolution.ClientID
    %>'); 
   hiddenScreenResolution.value = "asass";
}); 
```

它在页面源代码上：

```
 $(document).ready(function () {
            var width = screen.width;
            var height = screen.height;

            var hiddenScreenResolution = document.getElementById('MainContent_hdnScreenResolution'); 
            hiddenScreenResolution.value = "asass";
        }); 
```

在服务器端，我检查隐藏值`Page_Load()`：

```
protected void Page_Load(object sender, EventArgs e)
{
    var hiddenValue = hdnScreenResolution.Value;
} 
```

但值似乎是空字符串。使用 jquery 没有帮助。

直接插入：document.getElementById('<%= hdnScreenResolution.ClientID %>').value = "asdasd"; 没有帮助。

可能是什么问题？

PS我想我捕捉屏幕分辨率`document.ready`为时已晚。页面卸载后 javascript 会触发。因此，在初始请求时无需更改即可捕获它。

期待答案。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-10T12:53:13.820

`Page_Load`在将 html 发送到客户端并执行 jQuery 之前调用服务器端，`document.ready`因此您在使用 javascript 在客户端上分配之前访问值，您应该为空。

您需要将值从客户端发送到服务器，您可以使用 jQuery ajax 进行回发以获取服务器上的屏幕坐标值。

*要查看发生了什么，只需添加 asp:button 并在其服务器端事件中访问隐藏字段值。*

# opengl-es - glsl 中的 sampler2DArrayShadow 是如何工作的

> ID：14258243
> 
> 赞同：0
> 
> 时间：2013-01-10T12:43:31.283
> 
> 标签：opengl-es, opengl-3, fragment-shader, glsles

我无法理解如何使用 sampler2DAprayShadows 以及它是如何工作的。得到其中的一部分，我们需要使用深度纹理值（GL_DEPTH_COMPONENT）来获得与参考深度的比较结果。但是接下来如何使用返回的浮点值来获取纹素。

参考来自： [http ://www.khronos.org/opengles/sdk/docs/manglsl/xhtml/texture.xml](http://www.khronos.org/opengles/sdk/docs/manglsl/xhtml/texture.xml)

我编写了一个小代码来测试它，如下所示： 我的片段着色器为：

```
in highp vec2 texcoord;
in highp vec4 basecolor;
out highp vec4 myFragColor;

uniform highp sampler2DArrayShadow basetexture;

void main(void)
{
    highp vec3 coords = (vec3(texcoord, 0.0) + vec3(1.0, 1.0, 1.0)) / 2.0;
    highp float depth = texture(basetexture, vec4(coords.x, coords.y, coords.z, -0.5));
    myFragColor = vec4(depth * basecolor);

} 
```

创建 3D 纹理（texdata），并将其绑定为：

```
glTexParameteri(GL_TEXTURE_2D_ARRAY, GL_TEXTURE_MIN_FILTER, GL_LINEAR_MIPMAP_LINEAR);
glTexParameteri(GL_TEXTURE_2D_ARRAY, GL_TEXTURE_MAG_FILTER, GL_LINEAR);
glTexParameteri(GL_TEXTURE_2D_ARRAY, GL_TEXTURE_WRAP_S, GL_REPEAT);
glTexParameteri(GL_TEXTURE_2D_ARRAY, GL_TEXTURE_WRAP_T, GL_REPEAT);
glTexParameteri(GL_TEXTURE_2D_ARRAY, GL_TEXTURE_COMPARE_MODE,  GL_COMPARE_REF_TO_TEXTURE);
glTexImage3D(GL_TEXTURE_2D_ARRAY, 0, GL_DEPTH_COMPONENT16, TEX_SIZE, TEX_SIZE, TEX_SIZE, 0, GL_DEPTH_COMPONENT, GL_UNSIGNED_SHORT, texdata); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2018-04-26T08:49:46.193

也许这可以帮助你： [深度立方体贴图制作教程](https://stackoverflow.com/questions/21210036/how-to-correctly-make-a-depth-cubemap-for-shadow-mapping?noredirect=1&lq=1)

坦率地说，您应该制作一个帧缓冲区对象，该对象绑定 2D 深度纹理而不是 Cubemap 纹理。如果要使用采样器：sampler2DArrayShadow，则只需重载glsl函数texture，即texture(Sampler2DArrayShadow gSampler, Vec4 P, [float bias]) .Pz为2D tex的个数，Pw为参考深度值。默认偏差为 0，如果不需要，可以忽略它。

# css - 包含在父项中的悬停动画

> ID：14258244
> 
> 赞同：3
> 
> 时间：2013-01-10T12:43:41.153
> 
> 标签：css, hover

我在这里有一个 JSFiddle，我正在处理一个很好的悬停效果，但我想知道是否可以将悬停效果包含在父级中

[http://jsfiddle.net/cyXKx/](http://jsfiddle.net/cyXKx/)

一切正常，除了最右边的列表项和悬停在网格之外的底行。理想情况下，我希望它们从右侧的右上角和底行的左下角开始生长。

我希望这是有道理的，我只是想知道这是否可能？

这是HTML

```
<ul class="tearsheets">
  <li><a href="#"><span><img class="galleryImg" src="http://lorempixum.com/200/200/transport"></span></a></li>
    <li><a href="#"><span><img class="galleryImg" src="http://lorempixum.com/200/200/transport"></span></a></li>
      <li><a href="#"><span><img class="galleryImg" src="http://lorempixum.com/200/200/transport"></span></a></li>
        <li><a href="#"><span><img class="galleryImg" src="http://lorempixum.com/200/200/transport"></span></a></li>
          <li><a href="#"><span><img class="galleryImg" src="http://lorempixum.com/200/200/transport"></span></a></li>
            <li><a href="#"><span><img class="galleryImg" src="http://lorempixum.com/200/200/transport"></span></a></li>
              <li><a href="#"><span><img class="galleryImg" src="http://lorempixum.com/200/200/transport"></span></a></li>
                <li><a href="#"><span><img class="galleryImg" src="http://lorempixum.com/200/200/transport"></span></a></li>
                  <li><a href="#"><span><img class="galleryImg" src="http://lorempixum.com/200/200/transport"></span></a></li>
                    <li><a href="#"><span><img class="galleryImg" src="http://lorempixum.com/200/200/transport"></span></a></li>
                      <li><a href="#"><span><img class="galleryImg" src="http://lorempixum.com/200/200/transport"></span></a></li>
                        <li><a href="#"><span><img class="galleryImg" src="http://lorempixum.com/200/200/transport"></span></a></li>

     </ul> 
```

和 CSS

```
ul.tearsheets{
        overflow:hidden;
        clear:both;
        max-width:100%;
        position:relative;
    }
    .tearsheets li span {
       display:inline-block;
       vertical-align:middle;
       height:110px;

    }
    .tearsheets{
        padding:18px 18px 108px 18px;
    }
    .tearsheets li{
        float:left;
        line-height:110px;
        width:160px;
        list-style:none;
        height:110px;
        background-color:#9C9B9B;
        text-align:center;
        position:relative;
        margin:0 1px 1px 0;
        -moz-transition: all 0.25s ease;
        -webkit-transition: all 0.25s ease;
    }
    .tearsheets li a{
        display:block;

    }
    .tearsheets li span img{
        padding-top:10px;
        z-index: 0;
        max-height:90px;
        -moz-transition: all 0.25s ease;
        -webkit-transition: all 0.25s ease;
    }
    .tearsheets li a:hover{
        height:221px;
        background-color:#9C9B9B;
        width:321px;
        position:absolute;
        z-index:1000000;
    }
    .tearsheets li a:hover span{
        padding-top:10px;

    }
    .tearsheets li a:hover span img{
        max-height:180px;
    } 
```

如果有人能帮我解决这个问题，那就太棒了，如果它在 IE8-9 上运行得更好——我在这个阶段不太担心 IE8 动画。

非常感谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-18T09:35:17.577

与 duality_ 相同的想法，但执行方式略有不同：[Demo](http://jsfiddle.net/jefferyto/tTqqa/)

新的 CSS：

```
.tearsheets li.right a:hover {
    right: 0;
}
.tearsheets li.bottom a:hover {
    bottom: 0;
} 
```

JS（使用 jQuery）：

```
function adjust() {
  $('ul.tearsheets').each(function () {
    var items = $(this).children(),
        num_items = items.length,
        num_per_row, i, n;

    if (num_items) {
      items.removeClass('right bottom');

      // find number of items per row
      n = 0;
      items.each(function (i) {
        var l = $(this).position().left;
        if (l <= n) {
          num_per_row = i;
          return false;
        } else {
          n = l;
        }
      });

      // apply 'right' class to the last column of items
      if (num_per_row > 1) {
        for (i = num_per_row - 1; i < num_items; i += num_per_row) {
          items.eq(i).addClass('right');
        }
      }

      // apply 'bottom' class to last row of items
      n = items.eq(-1).position().top;
      if (items.eq(0).position().top < n) {
        $(items.get().reverse()).each(function () {
          var item = $(this), t = item.position().top;
          if (t == n) {
            item.addClass('bottom');
          } else {
            return false;
          }
        });
      }
    }
  });
}

$(window).on('resize', adjust);
adjust(); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-20T09:21:52.790

不要浪费 Javascript。这更直接一点。

```
 .tearsheets li:nth-of-type(even) >  a:hover {
    left:-160px;
    } 
```

只需将其添加到您的 CSS 中即可。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-14T16:02:58.337

**肯定的事。这是[结果](http://jsfiddle.net/cyXKx/3/)。**

我做了什么。

**第一：** HTML 保持不变。

**第二：**对于 CSS，我为您`<li>`的 s:`last-x`和`last-y`. 第一个意味着它右边没有任何项目（即使在列表的末尾）。第二个是相同的，但垂直看。

CSS 代码：

```
.tearsheets li.last-x a:hover{ left: -161px; }
.tearsheets li.last-y a:hover{ top: -111px; } 
```

**第三：**添加 jQuery 并在上面撒一些 jQuery*魔法*。

```
<script src="http://code.jquery.com/jquery-1.8.3.min.js"></script>
<script>
$(function() {
    var $tearsheets = $(".tearsheets");
    var line_length = Math.floor($tearsheets.width() / $tearsheets.find("li:first").width());
    var items_count = $tearsheets.find("li").length;
    var full_lines_count = Math.floor(items_count / line_length);
    var index = 0; // somehow the internal index inside .each() doesn't work :-/
    $tearsheets.find("li").each(function(i) {
        var item_position = i + 1;
        var items_on_the_right = line_length - (i % line_length) - 1;
        //console.log(items_on_the_right + ", " + items_count + ", " + item_position);
        if (items_on_the_right > (items_count - item_position))
            items_on_the_right = items_count - item_position;
        if (items_on_the_right == 0)
            $(this).addClass("last-x");

        var current_line = Math.ceil(item_position / line_length);
        $(this).attr("data-current-line", current_line);
        if (current_line >= full_lines_count)
            $(this).addClass("last-y");
    });
});
</script> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-16T18:06:10.830

我认为最好的方法是使用 CSS3。您只需添加以下内容即可：

```
ul.tearsheets > li:nth-child(even):hover {
    position:relative;
    right:161px;
} 
```

这里是[jsfiddle](http://jsfiddle.net/cyXKx/5/)。

这样`li`意志就会从右向左移动，但我真的不知道这是否是你想要的。您可以通过添加以下属性来更改该行为：

```
transition:none;
-webkit-transition: none;
-moz-transition:none;  
-o-transition:none; 
```

这里是[jsfiddle](http://jsfiddle.net/cyXKx/6/)。

请注意，由于我使用了 CSS3 选择器，因此此解决方案不适用于旧浏览器，例如 IE8。

# ios - iOS导航更改为后退按钮，右对齐

> ID：14258247
> 
> 赞同：0
> 
> 时间：2013-01-10T12:43:49.903
> 
> 标签：ios, objective-c, ios6

我要求用户界面具有后退按钮及其行为，右对齐而不是左对齐。

它看起来像这样

[http://content.screencast.com/users/Quotient/folders/Jing/media/a325c184-5b34-40c3-b1bc-104d3d022eb2/2013-01-10_0643.png](http://content.screencast.com/users/Quotient/folders/Jing/media/a325c184-5b34-40c3-b1bc-104d3d022eb2/2013-01-10_0643.png)

任何帮助都是极好的！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-10T12:50:11.373

在这篇[文章](http://www.applausible.com/blog/?p=401)中，您将了解如何创建自定义后退按钮，您只需将其放在右侧而不是左侧

# javascript - 在Android上获取网页的内容字符串（不是源代码）

> ID：14258254
> 
> 赞同：0
> 
> 时间：2013-01-10T12:44:14.123
> 
> 标签：javascript, android, json

我制作了一个 Javascript 页面来生成一个 JSON 对象，然后从 Android 设备读取它。我用以下代码阅读它

```
StringBuilder stringBuilder = new StringBuilder();
        HttpClient client = new DefaultHttpClient();
        HttpGet httpGet = new HttpGet(url);

    try {
        HttpResponse response = client.execute(httpGet);
        StatusLine statusLine = response.getStatusLine();
        int statusCode = statusLine.getStatusCode();

        if (statusCode == 200){
            HttpEntity entity = response.getEntity();
            InputStream content = entity.getContent();
            BufferedReader reader = new BufferedReader(new InputStreamReader(content));
            String line;
            while ((line = reader.readLine()) != null){
                stringBuilder.append(line);
            }
        } else {
            Log.e("JSON", "Failed to donwload file");
        }
    } catch (ClientProtocolException e) {
        e.printStackTrace();
    } catch (IOException e) {
        e.printStackTrace();
    } 
```

问题是这段代码返回的是网页的源代码，而源代码是Javascript中的脚本，而不是执行后生成的JSON字符串。我需要 JSON 字符串，并且我需要使用 Javascript 来生成 JSON 字符串，因为我可以访问外部服务。

我还没有找到任何解决方案。我不在乎可能的解决方案是否涉及服务器或 Android 终端。

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-10T12:48:59.607

```
String myresponse=Html.escapeHtml(YourStringHere); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-10T12:58:46.883

尝试这个。

```
private class MyJavaScriptInterface {

     private MyJavaScriptInterface () {
      }

    public void setHtml(String contentHtml) {

                    //here you get the content html
    }
}
private WebViewClient webViewClient = new WebViewClient() {

 @Override
 public void onPageFinished(WebView view, String url) {
     view.loadUrl("javascript:window.ResponseChecker.setHtml"
                    + "(document.body.innerHTML);");
        }
 } 
```

# ruby-on-rails - 我可以在 show.html.erb 中使用 'javascript_include_tag' 和 `content_for(:head)` 吗？

> ID：14258273
> 
> 赞同：2
> 
> 时间：2013-01-10T12:45:29.690
> 
> 标签：ruby-on-rails, ruby-on-rails-3

为什么我会收到此错误？
我可以 在 show.html.erb 中使用`javascript_include_tag`with吗？ 我想把线加载到里面`content_for(:head)`
`<head>...</head>`

如果我放`<%= content_for(:head) do %>`，加载“refresh_chat.js”的行将不会出现。
如果我删除`<%= content_for(:head) do %>`，加载“refresh_chat.js”的行出现，但不在`<head>`

**意见/帖子/show.html.erb**

```
1\. <%= content_for(:head) do %>
2\.   <%= javascript_include_tag "refresh_chat.js" %>
3\. <% end %> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-10T12:56:13.350

它应该工作。确保您`yield`在以下`<head>`部分：

```
<head>
  ...
  <%= yield :head %>
</head> 
```

进而

```
<% content_for(:head) do %>
  <%= javascript_include_tag "refresh_chat.js" %>
<% end %> 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-10T12:58:27.077

您可能不想`<% content_for ...`在部分中输出 content_for 块 ( )。也不`content_for(:head)`是什么神奇的功能什么的。如果你想把它的内容放到你的脑海中，你必须在你的布局中做这样的事情：

```
<head>
  ...
  <%= yield(:head) if content_for?(:head) %>
</head> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-10T12:53:23.033

您应该只使用`<% content_for(:head) do %>`而不是`<%= content_for(:head) do %>`，以便内容不会在您的视图中呈现，而是在您的`<head>`.

# iphone - 如何使用蓝牙将联系人从 iphone 发送到 MFI 设备？

> ID：14258277
> 
> 赞同：1
> 
> 时间：2013-01-10T12:45:38.147
> 
> 标签：iphone, ios6, bluetooth, mfi

我将如何同步`contacts`到`MFi`设备，以便它可以使用`Phone Book Access Profile (PBAP)`.I 显示在设备上。我能够从中获取联系人`address book`。我想知道有什么替代方法吗？如何从设备发起电话簿请求以及如何将其传输到设备。请`MFi`让我知道使用蓝牙或任何指针同步联系人以完成任务的任何示例。“MFi”设备支持`Serial Port Profile (SPP)`。我想在下面提到的委托方法中同步联系人，但我不知道如何开始。完成此操作的任何指针。

`- (void)accessoryDidDisconnect:(EAAccessory *)accessory`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-10T23:34:50.370

什么样的蓝牙设备？如果您自己制作，它必须是蓝牙 4.0。低能量。然后，您可以使用 Core Bluetooth 传输任何数据。

然后你必须定义你自己的服务 UUID，你自己的特性 UUID。搜索设备（例如使用您的服务 UUID 或全部为“nil”）连接查找服务查找每个服务的特征

现在您可以使用 GATT 配置文件访问以您想要的任何格式传输数据。如果您的蓝牙低功耗设备知道如何解码，它可能是电话簿中的数据。也许您想制作自己的格式...

如果您不想这样做，那么您必须加入 MFI 计划以获取文档。

你也应该去iTunes，然后找到WWDC 2012 Session Videos。有几个可以为你解释的东西。会议 701 很棒关于 IOS 配件 会议 703 关于核心蓝牙 会议 705 关于高级核心蓝牙

BR亨里克

# sql - 如何在sqlserver中使用具有1到10格式的整数边界的db字符串检查整数值

> ID：14258280
> 
> 赞同：0
> 
> 时间：2013-01-10T12:45:43.523
> 
> 标签：sql, sql-server, tsql

我有如下格式的表格，条件是 nvarchar 格式的值之间的年龄

```
Id  Condition
1   0 to 10
2   10 to 20
3   20 to 30
4   30 to 40
5   40 to 50
6   50 Above 
```

现在我想在运行时检索 id 值年龄需要根据匹配边界与表条件列进行检查。

你能帮忙解决这个问题吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-10T12:58:35.687

我同意 SWeko。如果你不能改变类型，你似乎很幸运有一个简单的线性进展，所以这也可以。注意：这是一个非最佳解决方案

```
DECLARE @InputAge TINYINT = 31

;WITH MyTable (Id, Condition) AS
(
-- Corrected age overlaps
    SELECT 1, '0 to 10'     UNION ALL
    SELECT 2, '11 to 20'    UNION ALL
    SELECT 3, '21 to 30'    UNION ALL
    SELECT 4, '31 to 40'    UNION ALL
    SELECT 5, '41 to 50'    UNION ALL
    SELECT 6, '51 Above'
)
SELECT Id
FROM MyTable 
WHERE @InputAge BETWEEN 10 * Id-9 
                AND CASE WHEN Id = 6 THEN 150 ELSE 10*Id END 
```

字符串操作操作将是这样的。这也是一个很差的表演者！

```
DECLARE @InputAge TINYINT = 35

;WITH MyTable (Id, Condition) AS
(
-- Corrected age overlaps
    SELECT 1, '0 to 10'     UNION ALL
    SELECT 2, '11 to 20'    UNION ALL
    SELECT 3, '21 to 30'    UNION ALL
    SELECT 4, '31 to 40'    UNION ALL
    SELECT 5, '41 to 50'    UNION ALL
    SELECT 6, '51 Above'
)
SELECT   Id
        ,LEFT(Condition, CHARINDEX(' ', Condition))
        ,RIGHT(Condition, CHARINDEX(' ', REVERSE(Condition)))
FROM MyTable 
WHERE @InputAge BETWEEN LEFT(Condition, CHARINDEX(' ', Condition)) AND ISNULL(NULLIF(RIGHT(Condition, CHARINDEX(' ', REVERSE(Condition))), 'Above'), 255) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-10T12:50:13.090

如果您对表的结构有任何权力，请将其更改为一种`(ID, MaxAge, MinAge)`格式，然后您的查询类似于：

```
select p.*, r.ID as AgeBracket 
from people p
  inner join ageRestrictions r 
    on p.Age between r.MinAge and r.MaxAge 
```

如果表格的结构是一成不变的，那么在问题中提及这一点。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-10T12:56:25.207

您想重组该表并使用 SWekos 代码，但要直接回答您的问题：

**如果它与您描述的完全一样，那么您可以在HELLUVA DIRTY HACK**中利用年龄和范围 ID 之间的关系：

```
select 
    CASE p.age
      WHEN  p.age < 70 THEN p.age %10 + 1
      ELSE 6
FROM People as p 
```

;)

# c# - Silverlight Toolkit 图表控件并不总是显示 X 轴值

> ID：14258281
> 
> 赞同：0
> 
> 时间：2013-01-10T12:45:45.257
> 
> 标签：c#, silverlight, charts, toolkit

我有一个使用 Silverlight Toolkit 的 Silverlight 5 应用程序。现在，当从我的网络服务返回的结果集中只有一个结果时，Silverlight Toolkit 图表控件并不总是显示 X 轴值。

![X轴工作！！](../Images/1e6c91b37719fafa3459eb4b8b7d9d26.png) ![结果集中有 1 个项目，X 轴似乎消失了](../Images/0d24860157e048b02db8acf8e618ccf0.png)

第一个图像显示，选择足够大结果集时，我的图表已正确加载。第二张图片显示，当结果集存在 1 个项目时，它不存在。

这是我的实现：

```
TimeSpan monthSpan = TimeSpan.FromDays(30.0);
TimeSpan daySpan = TimeSpan.FromDays(1.0);
TimeSpan hourSpan = TimeSpan.FromHours(1.0);

foreach (TagValueResult res in e.NewItems)
{
    if (res != null)
    {
        LineSeries lineSeries = new LineSeries()
        {
            Title = string.Format("{0}" + Environment.NewLine + " {2} ({1})", res.Name, res.Attributes["UOM"], res.Attributes["Description"]),
            ItemsSource = res.Values,
            DependentValueBinding = new System.Windows.Data.Binding("Value"),
            IndependentValueBinding = new System.Windows.Data.Binding("Key"),
            Tag = res,
            PolylineStyle = Resources["thinLineStyle"] as Style,
            //DataPointStyle = Resources["dataPointStyle"] as Style
        };
        if (res.Values.Any() && chart.Series.Any() == false)
        {
            TimeSpan graphSpan = res.Values.ToList().Last().Key - res.Values.ToList().First().Key;

            lineSeries.IndependentAxis = new DateTimeAxis
            {
                Minimum = res.Values.ToList().First().Key,
                Maximum = res.Values.ToList().Last().Key,
                Interval = 1,
                Orientation = AxisOrientation.X,
                Location = AxisLocation.Bottom
            };

            if (graphSpan > monthSpan)
            {
                ((DateTimeAxis)lineSeries.IndependentAxis).IntervalType = DateTimeIntervalType.Days;
                ((DateTimeAxis)lineSeries.IndependentAxis).Interval = 5;
            }
            else if (graphSpan > daySpan && graphSpan < monthSpan)
            {
                ((DateTimeAxis)lineSeries.IndependentAxis).IntervalType = DateTimeIntervalType.Days;
                ((DateTimeAxis)lineSeries.IndependentAxis).Interval = 1;
            }
            else if (graphSpan > hourSpan && graphSpan < daySpan)
            {
                ((DateTimeAxis)lineSeries.IndependentAxis).IntervalType = DateTimeIntervalType.Hours;
                ((DateTimeAxis)lineSeries.IndependentAxis).Interval = 1;
            }
            else if (graphSpan < hourSpan)
            {
                ((DateTimeAxis)lineSeries.IndependentAxis).IntervalType = DateTimeIntervalType.Minutes;
                ((DateTimeAxis)lineSeries.IndependentAxis).Interval = 15;
            }
            else
            {
                //sometimes all comparisons fail, just back up to a safe interval of 1 day.
                ((DateTimeAxis)lineSeries.IndependentAxis).IntervalType = DateTimeIntervalType.Days;
                ((DateTimeAxis)lineSeries.IndependentAxis).Interval = 1;
            }
        }
        chart.Series.Add(lineSeries);
    }
} 
```

你有什么想法？我没有可能的解决方案。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-16T21:00:21.030

包含一个项目的集合在代码的多个位置会出现不正确的行为。

这里`graphSpan`将等于零：

```
TimeSpan graphSpan = res.Values.ToList().Last().Key - res.Values.ToList().First().Key; 
```

在这里`Maximum`和`Minimum`将是相同的：

```
lineSeries.IndependentAxis = new DateTimeAxis
{
    Minimum = res.Values.ToList().First().Key,
    Maximum = res.Values.ToList().Last().Key, 
```

我建议您添加另一个 if 块并为集合只有 1 个项目的特殊情况构建不同的轴。

```
var values = res.Values.ToList();
TimeSpan graphSpan = values.Last().Key - values.First().Key;

if (graphSpan == TimeSpan.Zero)
{
    lineSeries.IndependentAxis = new DateTimeAxis
    {
        Orientation = AxisOrientation.X,
        Location = AxisLocation.Bottom
    };
}
else
{
    lineSeries.IndependentAxis = new DateTimeAxis
    {
        Minimum = values.First().Key,
        Maximum = values.Last().Key,
        Orientation = AxisOrientation.X,
        Location = AxisLocation.Bottom
    };

    if (graphSpan > monthSpan)
    {
        ((DateTimeAxis)lineSeries.IndependentAxis).IntervalType = DateTimeIntervalType.Days;
        ((DateTimeAxis)lineSeries.IndependentAxis).Interval = 5;
    }
    else if (graphSpan > daySpan && graphSpan < monthSpan)
    {
        ((DateTimeAxis)lineSeries.IndependentAxis).IntervalType = DateTimeIntervalType.Days;
        ((DateTimeAxis)lineSeries.IndependentAxis).Interval = 1;
    }
    else if (graphSpan > hourSpan && graphSpan < daySpan)
    {
        ((DateTimeAxis)lineSeries.IndependentAxis).IntervalType = DateTimeIntervalType.Hours;
        ((DateTimeAxis)lineSeries.IndependentAxis).Interval = 1;
    }
    else if (graphSpan < hourSpan)
    {
        ((DateTimeAxis)lineSeries.IndependentAxis).IntervalType = DateTimeIntervalType.Minutes;
        ((DateTimeAxis)lineSeries.IndependentAxis).Interval = 15;
    }
    else
    {
        //sometimes all comparisons fail, just back up to a safe interval of 1 day.
        ((DateTimeAxis)lineSeries.IndependentAxis).IntervalType = DateTimeIntervalType.Days;
        ((DateTimeAxis)lineSeries.IndependentAxis).Interval = 1;
    }
} 
```

# wireshark - 使用 libpcap 格式的命令行开始捕获

> ID：14258286
> 
> 赞同：0
> 
> 时间：2013-01-10T12:45:57.333
> 
> 标签：wireshark, tshark

我尝试使用命令行开始使用 Wireshark 进行捕获，但默认输出文件是`pcap`扩展名，但 Wireshark -`pcapng`文件类型，我需要`libpcap`文件类型。我的命令是

```
tshark.exe" -i interfacenumber -W MyFile.pcap 
```

我也试过

```
tshark.exe" -i 1 -F libpcap -W MyFile.pcap 
```

在这种情况下，虽然我可以在命令行窗口中看到数据包，但在我的磁盘上没有创建文件

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-11T04:10:03.907

```
tshark.exe -i 1 -F libpcap -w MyFile.pcap` 
```

是正确的答案（注意小写'w'）。

（`-W`做一些不同的事情。有很多 tshark 选项，因此您需要仔细查看`tshark -h`输出以确保您使用的是正确的选项）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-09-19T08:44:57.153

我认为在最新`Wireshark`版本（1.8.x 或 1.10.x）中，您无法开始捕获，`libpcap format`默认格式是`pcapng`（也是 pcap 扩展 - 尝试使用版本 1.6.x）这就是解决我的问题的方法

[http://www.wireshark.org/download/win64/all-versions/](http://www.wireshark.org/download/win64/all-versions/)

[http://www.wireshark.org/download/win32/all-versions/](http://www.wireshark.org/download/win32/all-versions/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-05-07T14:26:42.363

由于该`-F libpcap`选项对我也不起作用，因此我在同一目录中使用了另一个命令行工具：

`editcap -F libpcap currentFile.pcap(ng) libpcapConvertedFile.pcap`其中“currentFile.whatever”是 pcapng 格式的文件，“libpcapConvertedFile.whatever”是输出的旧版 libpcap 格式。

一旦 tshark 完成捕获原始文件，我就会运行它。

# entity-framework - 实体框架5中的常用配置

> ID：14258288
> 
> 赞同：0
> 
> 时间：2013-01-10T12:45:59.220
> 
> 标签：entity-framework, configuration

我有几个实体，都继承了带有审计和 ID 字段的基本实体。在每个属性的配置中，我都有完全相同的行，例如：

```
this.HasKey(t0 => t0.Id)
  .Map(m => m.ToTable("templates"))
  .Property(x => x.Id)
  .HasColumnName("id")
  ................... 
```

有没有办法将此代码移动到某种“基本配置”而不是为每个实体编写它？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-10T14:50:08.340

您需要做的就是实现 Table-Per-Type 或 Table-Per-Hierarchy：

在 Table-Per-Type 中，您的实体将被拆分为不同的表，但所有分支表的 PK 都将是基本实体表的 FK。

在 Table-Per-Hierarchy 中，您的实体都将位于一个表中，但 EF 将生成一个鉴别器来辨别实体实际上属于哪个对象类型。

有关这方面的更清晰示例，请查看[此站点上](http://www.codeproject.com/Articles/393228/Entity-Framework-Code-First-Inheritance-Table-Per)的帖子。

# android - Universal Image Loader 为每个图像启用/禁用磁盘缓存

> ID：14258289
> 
> 赞同：0
> 
> 时间：2013-01-10T12:46:11.700
> 
> 标签：android, caching, universal-image-loader

在我的 android 应用程序中，我使用 Universal Image Loader 来显示图像。

我在选项中指定了在光盘上缓存图像。但有时有些图像我不想缓存在光盘上。有没有办法指定它是否应该在每次下载图像时缓存在磁盘上，而不仅仅是在初始化时？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-10T14:34:15.103

我刚刚创建了 2 个选项，一个带有缓存，一个没有，并相应地使用了每一个。将它留在这里以防万一。

# device - MDM 设备令牌问题

> ID：14258297
> 
> 赞同：0
> 
> 时间：2013-01-10T12:47:01.670
> 
> 标签：device, token, apple-push-notifications, mdm

我已经为 MDM 服务器设置了简单的演示。我可以使用 messagetype、pushmagic 令牌、APNs 令牌（32byte 作为 base46）和 unlocktoken 成功恢复初始 plist。我的问题是当我尝试使用 base64_decode php 函数解码 APNs 令牌时，它返回垃圾/垃圾字符。如果我需要使用任何其他 php 函数来解码 APNs 令牌，有什么帮助吗？

谢谢，病毒。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-11T01:08:55.050

令牌就是它的本来面目：令牌。您使用 base64_decode 得到的只是一个字节数组，您无法在其中看到任何有意义的数据或将其打印为字符串。只需将其以二进制形式存储在您的数据库中即可。稍后，当您向 APNS 发送待处理命令通知时，您需要此令牌来识别目标设备。它实际上与应用程序的推送令牌相同。

设备通知的内容在[1](http://developer.apple.com/library/mac/#documentation/NetworkingInternet/Conceptual/RemoteNotificationsPG/ApplePushService/ApplePushService.html)中描述，APNS 协议在 [2] 中描述。

**参考**

1.  Apple Inc，移动设备管理协议参考
2.  [苹果推送通知服务](http://developer.apple.com/library/mac/#documentation/NetworkingInternet/Conceptual/RemoteNotificationsPG/ApplePushService/ApplePushService.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-12-16T02:40:49.500

只是为了补充这一点。如果您使用另一个库来抽象发送通知，有时他们希望`token`64 个字符。使用 PHP，您可以使用`$token = bin2hex(base64_decode($deviceToken));`

但是，如果`token`以二进制格式存储在数据库中，则`base64_decode`可以省略。以下是处理带有 Postgres 的 PHP PDO 时需要的内容：

`bin2hex(stream_get_contents($deviceToken))`

# javascript - 日期框的日期范围功能

> ID：14258299
> 
> 赞同：0
> 
> 时间：2013-01-10T12:47:06.787
> 
> 标签：javascript, jquery, jquery-ui, datebox

我正在使用[Datebox](http://dev.jtsage.com/jQM-DateBox2/)小部件并希望限制用户可以选择的日期。例如。仅应启用 2013 年 1 月 2 日至 2013 年 1 月 25 日之间的日期，其余日期禁用。

如何以**编程方式**提供这些值？在 JSON 中传递它对我不起作用。

```
$('#dateInput').datebox({"mode": "calbox", 'min':"2013-01-02", 'max':"2013-01-25"}); 
```

请让我知道传递日期范围参数的语法。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-10T12:50:15.797

我不知道在 Datebox 小部件中是否有可能。但是如果你选择 Jquery UI datepicker，它就有这个选项。

如果你有兴趣看看这个

[http://jqueryui.com/datepicker/#min-max](http://jqueryui.com/datepicker/#min-max)

# angularjs - AngularJS fake $httpBackend.whenPOST() Uncaught TypeError: Cannot read property '2' of undefined

> ID：14258302
> 
> 赞同：8
> 
> 时间：2013-01-10T12:47:24.650
> 
> 标签：angularjs

AngularJS 很新，并且得到了一个模拟的 $httpBackend，如文档中描述的那样工作（见这里：http://docs.angularjs.org/api/ngMockE2E.$httpBackend）。我可以重现 GET 代码，例如：

```
$httpBackend.whenGET('/phones').respond(phones); 
```

但是，POST 方法因 angular-mocks.js 错误而失败。这是我指定在 POST 上发生的事情：

```
 $httpBackend.whenPOST('/phones').respond(function(method,url,data){
        console.log(data);
        phones.push(angular.fromJson(data));
  }); 
```

这就是我从控制器调用 POST 的方式：

```
 var newPhone = {name:'New Phone'};
  $http.post('/forecasts/types.json', newPhone); 
```

这就是我在控制台中看到的响应：

```
{"name":"New Phone"}  app.js:167

Uncaught TypeError: Cannot read property '2' of undefined angular-mocks.js:876
(anonymous function) angular-mocks.js:876
completeOutstandingRequest angular.js:2930
(anonymous function) angular.js:3209 
```

我的代码看起来与文档几乎相同。该函数在发布到时被调用，但我不知道为什么它不会运行。

**编辑（感谢 Josh David Miller 对小提琴的评论）**这是一个重现错误的小提琴：http: [//jsfiddle.net/elcabo/btbds/3/](http://jsfiddle.net/elcabo/btbds/3/) 小提琴基于 Angular 文档中的示例（http ://docs.angularjs.org/api/ngMockE2E.$httpBackend）和 mockE2E $httpBackend 的角小提琴（http://jsfiddle.net/vojtajina/DQHdk/）

有没有人遇到过这个问题或者对如何攻击这个有任何想法？

我已经搜索了相当广泛的解决方案/相关帖子，但找不到任何内容，因此将不胜感激任何指针。

非常感谢。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2013-01-11T23:09:18.660

我更新了您的 jsFiddle，现在可以使用：http: [//jsfiddle.net/joshdmiller/EgMpe/](http://jsfiddle.net/joshdmiller/EgMpe/)。

首先，AngularJS 的版本非常旧。我将它从 0.10.6 更新到 1.0.3。随着这种变化带来了许多句法变化，你可以在小提琴中找到。

但是您遇到的问题是没有在您的`$httpBackend.whenPOST`方法中返回值。该`respond`方法应返回一个指示状态、响应正文和标头的值。我在工作小提琴中包含的详细示例是：

```
$httpBackend.whenPOST('/phones').respond(function(method, url, data, headers){
  console.log('Received these data:', method, url, data, headers);
  phones.push(angular.fromJson(data));
  return [200, {}, {}];
}); 
```

返回的数组是一个响应状态`200`、一个空响应正文和一组空标头（即使用默认值）。

我还添加了一个`whenGET`，以便您可以看到它们一起工作：

```
$httpBackend.whenGET('/phones').respond(function(method,url,data) {
  console.log("Getting phones");
  return [200, phones, {}];
}); 
```

# liferay - Liferay pentaho 集成抛出错误 javax.naming.OperationNotSupportedException: Context is read only 错误

> ID：14258309
> 
> 赞同：1
> 
> 时间：2013-01-10T12:47:48.750
> 
> 标签：liferay

`pentaho.war`使用然后在启动tomcat后将pentaho集成到liferay中，出现以下错误：

```
06:01:23,701 ERROR [JNDIResourceProvider] error closing context
javax.naming.OperationNotSupportedException: Context is read only
        at org.apache.naming.NamingContext.checkWritable(NamingContext.java:962) at org.apache.naming.NamingContext.close(NamingContext.java:762)
        at com.tonbeller.tbutils.res.JNDIResourceProvider.close(JNDIResourceProv
ider.java:68)
        at com.tonbeller.tbutils.res.CompositeResourceProvider.close(CompositeRe
sourceProvider.java:56)
        at com.tonbeller.tbutils.res.ResourcesFactory.initialize(ResourcesFactor
y.java:163)
        at com.tonbeller.tbutils.res.ResourcesFactory.<init>(ResourcesFactory.ja
va:92)
        at com.tonbeller.tbutils.res.ResourcesFactory.<clinit>(ResourcesFactory.
java:89)
        at com.tonbeller.tbutils.res.ResourcesFactoryContextListener.contextInit
ialized(ResourcesFactoryContextListener.java:23)
        at org.apache.catalina.core.StandardContext.listenerStart(StandardContex
t.java:4779)
        at org.apache.catalina.core.StandardContext.startInternal(StandardContex
t.java:5273)
        at org.apache.catalina.util.LifecycleBase.start(LifecycleBase.java:150)
        at org.apache.catalina.core.ContainerBase$StartChild.call(ContainerBase.
java:1566)
        at org.apache.catalina.core.ContainerBase$StartChild.call(ContainerBase.
java:1556)
        at java.util.concurrent.FutureTask$Sync.innerRun(FutureTask.java:303)
        at java.util.concurrent.FutureTask.run(FutureTask.java:138)
        at java.util.concurrent.ThreadPoolExecutor$Worker.runTask(ThreadPoolExec
utor.java:886)
        at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor
.java:908)
        at java.lang.Thread.run(Thread.java:619) 
```

请帮助
提前谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-28T23:38:32.557

Tomcat 的 JNDI 实现是只读的。该错误是由 SessionFactory 试图从 JNDI 中删除自身引起的。

没那么严重，你得到的只是不正常的关机。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-04-01T10:11:58.857

*尝试在WEB-INF/classes*下添加一个名为**resfactory.properties**的文件，其中包含以下行：

 ***tbeller.usejndi=false**

见：http: [//jpivot.sourceforge.net/wcf/api/com/tonbeller/tbutils/res/package-summary.html](http://jpivot.sourceforge.net/wcf/api/com/tonbeller/tbutils/res/package-summary.html)*

# parsing - KendoUI 数据源：过滤器值的 parseInt

> ID：14258315
> 
> 赞同：0
> 
> 时间：2013-01-10T12:48:09.577
> 
> 标签：parsing, filter, datasource, kendo-ui

我需要通过以下过滤器项目对象过滤剑道数据源：

```
filters: [
    {
        field: "FIELD", 
        operator: "lt", 
        value: "080"
    }
] 
```

这意味着，由于数据的传输方式，我正在尝试测试这样的情况：“013”<“080”。

但它不能开箱即用。

有没有办法在测试值上定义一个像“parseInt”这样的过滤器？谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-10T15:53:04.657

尝试定义`FIELD`为数字`model`：

```
schema  : {
    model: {
        fields: {
            FIELD : { type: "number" }
        }
    }
}, 
```

如果这样做，则`FIELD`显示为 13, 80,... 如果要`FIELD`使用前导显示，请在网格`0`的定义中使用以下内容。`column`

```
{ field: "FIELD", title: "Field", format: "{0:000}" } 
```

即使显示为013、080 `FIELD`... 也被视为数字

你应该有类似的东西：

```
var dataSource = new kendo.data.DataSource({
    data    : entries,
    batch   : true,
    schema  : {
        model: {
            fields: {
                FIELD: { type: "number" }
            }
        }
    }
});

var grid = $("#grid").kendoGrid({
    dataSource: dataSource,
    columns   : [
        { field: "FIELD", title: "Field", format: "{0:000}" }
    ],
    filterable: true
}).data("kendoGrid"); 
```

如果你想尝试一下，请在[此处的 JSFiddle 中查看](http://jsfiddle.net/OnaBai/HHAS7/1/)

编辑：更新了使用`format`而不是`template`Mateo Piazza 建议的代码

# python - 遍历二维数组的“正交”对角线的更多 numpy 方式

> ID：14258317
> 
> 赞同：2
> 
> 时间：2013-01-10T12:48:13.027
> 
> 标签：python, numpy

我有以下代码沿着与通常返回的对角线正交的对角线进行迭代`np.diagonal`。它从位置 (0, 0) 开始，朝着右下角的坐标前进。

该代码按预期工作，但它的所有循环都不是很麻木，并且在必须创建许多数组来完成这个技巧时效率低下。

所以我想知道是否有更好的方法来做到这一点，因为我看不到我将如何跨越我的数组或使用 numpy 的对角线方法以更好的方式来做到这一点（尽管我希望有一些技巧我会失败查看）。

```
import numpy as np

A = np.zeros((4,5))

#Construct a distance array of same size that uses (0, 0) as origo
#and evaluates distances along first and second dimensions slightly
#differently so that no values in the array is the same
D = np.zeros(A.shape)
for i in range(D.shape[0]):
    for j in range(D.shape[1]):
        D[i, j] = i * (1 + 1.0 / (grid_shape[0] + 1)) + j

print D
#[[ 0\.          1\.          2\.          3\.          4\.        ]
# [ 1.05882353  2.05882353  3.05882353  4.05882353  5.05882353]
# [ 2.11764706  3.11764706  4.11764706  5.11764706  6.11764706]
# [ 3.17647059  4.17647059  5.17647059  6.17647059  7.17647059]]

#Make a flat sorted copy
rD = D.ravel().copy()
rD.sort()

#Just to show how it works, assigning incrementing values
#iterating along the 'orthagonal' diagonals starting at (0, 0) position
for i, v in enumerate(rD):

    A[D == v] = i

print A
#[[ 0  1  3  6 10]
# [ 2  4  7 11 14]
# [ 5  8 12 15 17]
# [ 9 13 16 18 19]] 
```

**编辑**

澄清一下，我想逐个元素地遍历整个`A`代码，但是按照上面代码调用的顺序（显示在 final 中`print`）。

迭代沿对角线的哪个方向（如果 1 和 2 交换放置，以及 3 和 5 等`A`）并不重要，只要对角线与 A 的主对角线正交（由 产生的对角线`np.diag(A)`）。

这个问题的应用程序/原因在我之前的问题中（在该问题底部的解决方案部分中）：[Constructing a 2D grid from 也许不完整的候选人列表](https://stackoverflow.com/questions/14242772/constructing-a-2d-grid-from-potentially-incomplete-list-of-candidates/)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-10T13:31:46.617

这是一种避免 Python for 循环的方法。

首先，让我们看看我们的加法表：

```
import numpy as np
grid_shape = (4,5)
N = np.prod(grid_shape)

y = np.add.outer(np.arange(grid_shape[0]),np.arange(grid_shape[1]))
print(y)

# [[0 1 2 3 4]
#  [1 2 3 4 5]
#  [2 3 4 5 6]
#  [3 4 5 6 7]] 
```

关键思想是，如果我们按顺序访问加法表中的总和，我们将以所需的顺序遍历数组。

我们可以使用以下命令找出与该订单相关的索引`np.argsort`：

```
idx = np.argsort(y.ravel())
print(idx)
# [ 0  1  5  2  6 10  3  7 11 15  4  8 12 16  9 13 17 14 18 19] 
```

`idx`是金色的。它基本上是您遍历任何形状 (4,5) 的二维数组所需的一切，因为二维数组只是重新整形的一维数组。

如果您的最终目标是生成`A`您在帖子末尾显示的数组，那么您可以`argsort`再次使用：

```
print(np.argsort(idx).reshape(grid_shape[0],-1))
# [[ 0  1  3  6 10]
#  [ 2  4  7 11 14]
#  [ 5  8 12 15 17]
#  [ 9 13 16 18 19]] 
```

或者，或者，如果您需要为 分配其他值`A`，也许这会更有用：

```
A = np.zeros(grid_shape)
A1d = A.ravel()
A1d[idx] = np.arange(N)  # you can change np.arange(N) to any 1D array of shape (N,)
print(A)
# [[  0\.   1\.   3\.   6\.  10.]
#  [  2\.   4\.   7\.  11\.  15.]
#  [  5\.   8\.  12\.  16\.  18.]
#  [  9\.  13\.  14\.  17\.  19.]] 
```

我知道你要求一种方法来*遍历*你的数组，但我想展示上面的内容，因为如上所述通过整个数组赋值或 numpy 函数调用（如 np.argsort）生成数组可能比使用 Python 循环更快. 但是如果你需要使用 Python 循环，那么：

```
for i, j in enumerate(idx):
   A1d[j] = i

print(A)
# [[  0\.   1\.   3\.   6\.  10.]
#  [  2\.   4\.   7\.  11\.  15.]
#  [  5\.   8\.  12\.  16\.  18.]
#  [  9\.  13\.  14\.  17\.  19.]] 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-10T13:39:10.753

```
>>> D
array([[ 0,  1,  2,  3,  4],
       [ 5,  6,  7,  8,  9],
       [10, 11, 12, 13, 14],
       [15, 16, 17, 18, 19]]) 

>>> D[::-1].diagonal(offset=1)
array([16, 12,  8,  4])
>>> D[::-1].diagonal(offset=-3)
array([0])
>>> np.hstack([D[::-1].diagonal(offset=-x) for x in np.arange(-4,4)])[::-1]
array([ 0,  1,  5,  2,  6, 10,  3,  7, 11, 15,  4,  8, 12, 16,  9, 13, 17,
       14, 18, 19]) 
```

只要不是大矩阵就更简单。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-10T12:54:42.233

我不确定这是否是您真正想要的，但也许：

```
>>> import numpy as np
>>> ar = np.random.random((4,4))
>>> ar
array([[ 0.04844116,  0.10543146,  0.30506354,  0.4813217 ],
       [ 0.59962641,  0.44428831,  0.16629692,  0.65330539],
       [ 0.61854927,  0.6385717 ,  0.71615447,  0.13172049],
       [ 0.05001291,  0.41577457,  0.5579213 ,  0.7791656 ]])
>>> ar.diagonal()
array([ 0.04844116,  0.44428831,  0.71615447,  0.7791656 ])
>>> ar[::-1].diagonal()
array([ 0.05001291,  0.6385717 ,  0.16629692,  0.4813217 ]) 
```

**编辑** 作为一般解决方案，对于任意形状的数组，您可以使用

```
import numpy as np
shape = tuple([np.random.randint(3,10) for i in range(2)])
ar = np.arange(np.prod(shape)).reshape(shape)
out = np.hstack([ar[::-1].diagonal(offset=x) \
                for x in np.arange(-ar.shape[0]+1,ar.shape[1]-1)])
print ar
print out 
```

给予，例如

```
[[ 0  1  2  3  4]
 [ 5  6  7  8  9]
 [10 11 12 13 14]
 [15 16 17 18 19]
 [20 21 22 23 24]]
[ 0  5  1 10  6  2 15 11  7  3 20 16 12  8  4 21 17 13  9 22 18 14 23 19] 
```

# delphi-xe2 - 防止多用户环境中的死锁

> ID：14258318
> 
> 赞同：0
> 
> 时间：2013-01-10T12:48:14.850
> 
> 标签：delphi-xe2, database-deadlocks, devart, multi-user

现状：我们开发了一个程序来管理多个电子商务商店。编辑订单是一项包含许多表的任务，因此需要使用事务。如果最后一个查询失败，则必须恢复之前的所有更改。

我们具有将订单更改为发票的功能。此功能可以一次更改多个订单。每个变更都有自己的事务，并且它们被逐个处理。

现在的问题：如果 2 个用户同时使用此功能 - 在不同的订单上 - 他们会遇到死锁......

DBMS：SQL Server 2008 R2 连接组件：UniDAC v4.5.9 - TUniConnection

我尝试的一种解决方案是将 LockMode 设置为 lmPessimistic。这减少了死锁，但它们仍然会发生......

更新：

通过使用“READ_COMMITTED_SNAPSHOT”作为数据库隔离模式解决了该问题。这对我们来说很好，但不适用于所有死锁情况并且有一些副作用！

# java - 用作批量依赖的 Maven 聚合模块

> ID：14258323
> 
> 赞同：2
> 
> 时间：2013-01-10T12:48:41.557
> 
> 标签：java, maven, dependency-management

是否可以使用聚合模块（聚合模块以用于构建目的的 pom）作为依赖项，将其模块传递为依赖项？考虑到它必须声明与其子模块对应的那些依赖项，否则如果将其声明为依赖项，则它没有自己的依赖项，因此不包含传递的依赖项。

我已经尝试过了，但我得到了一个循环依赖错误。

否则我将不得不创建一个额外的模块（比如 my_module_deps），它只声明所有这些依赖项，所以我可以将它用作传递包含其依赖项的依赖项。我不喜欢除了作为依赖批量之外没有任何特定用途的 Maven 模块。

这是所需的状态，因此我可以将它用于模块聚合和用于获取其传递依赖项的依赖项：

```
<project>
    <artifactId>aggregationModule</artifactId>
    <modules>
        <module>a</module>
        <module>b</module>
        <module>c</module>
    </modules>
    <dependencies>
        <dependency>
            <artifactId>a</artifactId>
        </dependency>
        <dependency>
            <artifactId>b</artifactId>
        </dependency>
        <dependency>
            <artifactId>c</artifactId>
        </dependency>
    </dependencies>
</project> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-10T17:34:20.047

是否有任何子模块将该聚合项目定义为其父模块？如果是这样，这是行不通的，因为作为父项目，必须先构建项目。但是如果父级本身同时将模块定义为依赖项，则必须首先构建模块，因此您创建了循环依赖错误。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-01-10T14:21:45.410

您不能声明对打包类型为“pom”的项目的依赖关系。如果这样做，maven 将显示与声明对本地存储库中不存在且无法从存储库列表下载的 jar 模块的依赖项时相同的错误。

也许[对这个问题](https://stackoverflow.com/questions/7848979/maven-include-all-submodules-of-a-pom-as-dependencies-in-another-module)提出的一些替代方案可以帮助你。

# tortoisesvn - TortoiseSVN 在 win8 中缺少覆盖

> ID：14258332
> 
> 赞同：15
> 
> 时间：2013-01-10T12:49:21.340
> 
> 标签：tortoisesvn

我最近安装了一个新的 win8 副本。安装tortoiseSVN 后，它确实将文件夹识别为受版本控制（菜单项在那里），但图标上没有覆盖。我按照这里的描述检查了注册表设置：[TortoiseSVN 图标在 Windows 7 下没有显示](https://stackoverflow.com/questions/1057734/tortoisesvn-icons-not-showing-up-under-windows-7) 但是前 9 个条目都是针对 tortoiseSVN 的，还有 4 个，所以那里没有问题。可能是什么问题呢？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2015-08-07T12:31:11.970

去注册。找到 HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\ShellIconOverlayIdentifiers。在文件夹前添加空格，例如：“1TortoiseNormal”->“1TortoiseNormal”。重新启动计算机。为我工作。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2015-06-27T07:58:05.130

转到 TortoiseSVN > 设置 > 图标叠加 > 状态缓存从默认更改为外壳。

如果使用驱动器 A、B 或网络，请检查驱动器

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-05-26T15:28:30.180

请试试这个：

有时您只需要重新启动 Windows（如果尚未完成）。

您可能还必须对您的工作副本进行“清理”（右键单击，Tortoise SVN shell 条目），并在窗口中检查“刷新 shell 覆盖”。

此外，请查看您的 Tortoise SVN 的 Tortoise 设置（右键单击、Tortoise SVN shell 条目、设置）设置的“图标覆盖”选项卡，特别是如果您的工作副本（例如）在移动或网络驱动器上。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2015-06-18T16:29:55.630

就我而言，问题在于我正在使用网络驱动器。默认情况下，Tortoise 不会在网络驱动器上显示图标。

要启用其他类型驱动器上的图标，请右键单击 Windows 资源管理器并转到：

`TortoiseSVN --> Icon Overlays --> Drive Types`

这也可以解决其他情况下的问题，其中其他驱动器正在使用并且没有为您显示图标。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-05-26T13:33:21.403

您必须进行 svn 实现（在我的情况下是完全结帐）。配置注册表后只需重新启动资源管理器（或计算机）在我的情况下没有显示覆盖图标

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2014-10-22T04:39:03.280

修改注册表、清理 tsvn 等没有任何帮助。

通过在任务管理器中杀死进程“TortoiseSVN 状态缓存”来解决它。之后图标又一一出现。

在 TSVN 设置中，我将状态缓存设置为默认值（最初为无），但不确定这与它有什么关系。还要重新启动 explorer.exe 以确保。

在更新到最新版本 (1.8.8) 之前，我安装了一个较旧/不兼容的 TSVN 版本 (1.6)。这可能是问题的一部分。

# html - 没有主 div 的左右两侧的 div

> ID：14258335
> 
> 赞同：0
> 
> 时间：2013-01-10T12:49:33.880
> 
> 标签：html, css

我想制作新闻系统，在左边我想从世界上获取新闻，在右边我不会从我的国家获取新闻。我真的不知道如何解决这个问题：http: [//i48.tinypic.com/15rxzkw.jpg](http://i48.tinypic.com/15rxzkw.jpg)

资源：

```
<div style="width:1000px;">
    <div style="border:1px solid red;float:left;width:400px;">news from world</div><br/><br/>

 <div style="border:1px solid red;float:left;width:400px;">news from world</div><br/><br/>

  <div style="border:1px solid red;float:left;width:400px;">news from world</div><br/><br/>

   <div style="border:1px solid red;float:left;width:400px;">news from world</div><br/> <br/>

   <div style="border:1px solid red;float:left;width:400px;">news from world</div><br/><br/>

    <div style="border:1px solid red;float:left;width:400px;">news from world</div><br/><br/>
    <div style="border:1px solid blue;width:400px;float:right;">news from my country</div><br/><br/>
    <div style="border:1px solid blue;width:400px;float:right;">news from my country</div><br/><br/>
    <div style="border:1px solid blue;width:400px;float:right;">news from my country</div><br/><br/>
</div> 
```

**我注意到我不能在左侧有主 div，在右侧列/侧有主 div。**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-10T13:09:48.860

两个 br 标签构成了类似 100% 宽度的块，并防止浮动水平堆叠。

您可以通过先制作列然后将新闻块放入[http://jsfiddle.net/yHWmv/来避免此问题](http://jsfiddle.net/yHWmv/)

不要忘记使用带有溢出的包装器清除浮动：隐藏或其他清除修复。

html:

```
<div class="news">
  <div class="news-world">
    <div></div>
    ...
  </div>
  <div class="news-local">
    <div></div>
    ...
  </div>
</div> 
```

CSS：

```
.news {
  overflow:hidden;
}
.news-world {
  float:left;
  width:30%;
}
.news-local {
  float:right;
  width:30%;
}
.news-world div,
.news-local div {
  border:1px solid red;
  padding:10px;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-10T13:04:01.573

您还可以在每个 div 中添加 `display: inline'（最好使用 css 文件）：

风格：

```
.mainbox {
     width: 1000px;
}
.mainbox div {
     width:400px;
     display: inline;
}
.leftbox {
     float: left;
     border:1px solid red;
}
.rightbox {
     float: right;
     border:1px solid blue;
}
.clearbox {
     clear: both;
     height: 0;
     border: 0;
} 
```

html:

```
<div class="mainbox">
     <div class="leftbox">news from world</div>
     <div class="rightbox">news from my country</div>
     <div class="clearbox"> </div>
     <div class="leftbox">news from world</div>
     <div class="rightbox">news from my country</div>
     <div class="clearbox"> </div>
     ...
</div> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-10T12:52:18.507

首先，您可以将所有样式移动到 CSS 文件中。

你想要的是拥有最上面的div，宽度说X，位置：绝对。

然后对于孩子的左 div，你有 position:relative 和 right:50%;left:0 然后对于孩子的右 div，你有 position:relative 和 right:0;left;50%;

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-10T12:54:31.297

将所有左侧 div 包裹在一个`<div class="left">`. 将所有正确的 div 包装在`<div class="right">`.

蚂蚁然后：

# visual-studio-2012 - VS2012中的“在线”类视图窗口或至少在类视图中打开文件的热键

> ID：14258336
> 
> 赞同：0
> 
> 时间：2013-01-10T12:49:35.143
> 
> 标签：visual-studio-2012, resharper

我喜欢“LocateInSolutionExplorer”Resharper 快捷方式，它允许我在解决方案资源管理器中快速打开文件。我希望“类视图”有相同的快捷方式，这样我就可以快速查看类的公共界面。如果这是可能的？

理想情况下，在“.cs”文件之间进行编码和切换时，我希望有一个显示类层次结构的“在线”窗口。此外，应该可以配置要显示的内容（隐藏私有字段等）。你能推荐什么？

那么如何快速查看某个（当前在文本编辑器中打开的）类的公共界面呢？

# django - Django REST 框架 - 过滤

> ID：14258338
> 
> 赞同：2
> 
> 时间：2013-01-10T12:49:43.197
> 
> 标签：django, django-filter, django-rest-framework

我想用多个查询过滤多个字段，如下所示：

```
api/listings/?subburb=Subburb1, Subburb2&property_type=House,Apartment,Townhouse,Farm .. etc 
```

是否有任何内置方式，我查看了 django-filters 但它似乎有限，我想我必须在我的 api 视图中手动执行此操作，但它变得混乱，过滤过滤器上的过滤器

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-10T13:00:03.140

过滤过滤器上的过滤器并不混乱，它被称为`chained filters`.

并且链式过滤器是必要的，因为有时会有`property_type`一些时间不是：

```
if property_type:
    qs = qs.filter(property_type=property_type) 
```

如果您认为会有多个查询，那么它仍然会在一个查询中执行，因为查询集是惰性的。

或者，您可以构建一个 dict 并只传递一次：

```
d = {'property_type:': property_type, 'subburb': subburb}
qs = MyModel.objects.filter(**d) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2016-02-19T13:21:31.587

DRF 甚至 django-filter 插件都没有开箱即用地支持复杂的过滤器。对于简单的情况，您可以定义自己的 get_queryset 方法

这直接来自文档

```
def get_queryset(self):
    queryset = Purchase.objects.all()
    username = self.request.query_params.get('username', None)
    if username is not None:
        queryset = queryset.filter(purchaser__username=username)
    return queryset 
```

但是，如果您支持多个过滤器，甚至其中一些很复杂，这很快就会变得混乱。

解决方案是定义一个自定义 filterBackend 类和一个 ViewSet Mixin。这个 mixins 告诉视图集如何理解一个典型的过滤器后端，并且这个后端可以理解所有明确定义的非常复杂的过滤器，包括应该应用这些过滤器的规则。

一个示例过滤器后端是这样的（我在不同的查询参数上定义了三个不同的过滤器，按照复杂度递增的顺序：

```
class SomeFiltersBackend(FiltersBackendBase):
    """
    Filter backend class to compliment GenericFilterMixin from utils/mixin.
    """
    mapping = {'owner': 'filter_by_owner',
               'catness': 'filter_by_catness',
               'context': 'filter_by_context'}
    def rule(self):
        return resolve(self.request.path_info).url_name == 'pet-owners-list' 
```

ORM 查找的直接过滤器。

```
 def filter_by_catness(self, value):
        """
        A simple filter to display owners of pets with high catness, canines excuse. 
        """
        catness = self.request.query_params.get('catness')
        return Q(owner__pet__catness__gt=catness)

    def filter_by_owner(self, value):
        if value == 'me':
            return Q(owner=self.request.user.profile)
        elif value.isdigit():
            try:
                profile = PetOwnerProfile.objects.get(user__id=value)
            except PetOwnerProfile.DoesNotExist:
                raise ValidationError('Owner does not exist')
            return Q(owner=profile)
        else:
            raise ValidationError('Wrong filter applied with owner') 
```

更复杂的过滤器：

```
def filter_by_context(self, value):
    """
    value = {"context_type" : "context_id or context_ids separated by comma"}
    """
    import json
    try:
        context = json.loads(value)
    except json.JSONDecodeError as e:
        raise ValidationError(e)

    context_type, context_ids = context.items()
    context_ids = [int(i) for i in context_ids]
    if context_type == 'default':
        ids = context_ids
    else:
        ids = Context.get_ids_by_unsupported_contexts(context_type, context_ids)
    else:
        raise ValidationError('Wrong context type found')
    return Q(context_id__in=ids) 
```

要完全了解它是如何工作的，您可以阅读我的详细博文：http: [//iank.it/pluggable-filters-for-django-rest-framework/](http://iank.it/pluggable-filters-for-django-rest-framework/)

所有代码都在 Gist 中：[https ://gist.github.com/ankitml/fc8f4cf30ff40e19eae6](https://gist.github.com/ankitml/fc8f4cf30ff40e19eae6)

# android - 我的 android 应用程序不调用 onResume

> ID：14258339
> 
> 赞同：0
> 
> 时间：2013-01-10T12:49:42.617
> 
> 标签：android, onresume

我正在用 android 开发一个游戏，我有一个额外的错误。当我第一次执行应用程序时，一切正常，但是当我按下主页按钮然后我返回应用程序时，屏幕仍然是白色的，使用 Log 我可以看到 onResume() 没有被调用。当我按下主页按钮时，会调用 onPause() 方法。

```
public class MainActivity extends Activity {
GameView gV;
public static final String PREFS_NAME = "ShNCoPrefs";

@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    requestWindowFeature(Window.FEATURE_NO_TITLE);
    getWindow().setFlags(WindowManager.LayoutParams.FLAG_FULLSCREEN, WindowManager.LayoutParams.FLAG_FULLSCREEN);
    gV=new GameView(this);
    setContentView(gV);
    this.setVolumeControlStream(AudioManager.STREAM_MUSIC);
    // Restore preferences
    SharedPreferences settings = getSharedPreferences(PREFS_NAME, 0);
    boolean isFirstPlay = settings.getBoolean("isFirstPlay", true);
    gV.setFirstPlay(isFirstPlay);

}

@Override
public void onResume(){
    super.onResume();
    Log.i("onResume", "main-pasó por aquí 1");
    if (gV.thread!=null)
    gV.runThread();
    Log.i("onResume", "main-pasó por aquí 2");

}

@Override
public void onPause(){
    super.onPause();
     SharedPreferences settings = getSharedPreferences(PREFS_NAME, 0);
     SharedPreferences.Editor editor = settings.edit();
     editor.putBoolean("isFirstPlay", gV.isFirstPlay());

  // Commit the edits!
     editor.commit();
  if(gV.thread!=null)
     gV.pauseThread();

    //System.exit(0);

}

@Override
public boolean onKeyUp(int keyCode, KeyEvent event){
    switch (keyCode) {
    case KeyEvent.KEYCODE_BACK:
        return true;

    }
    return super.onKeyUp(keyCode, event);
}} 
```

谢谢，如果我的英语这么差，我很抱歉。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-10T13:04:50.103

```
private boolean isActive = false;
@Override
public void onResume() {
   super.onResume();
   isActive = true;
}

@Override
pulic void onPause() {
  super.onPause();
  isActive = false;

}

//Do it if is not active
if(!isActive){
   //Operation you want to Perform
} 
```

试试这些。它可能会帮助你。

# class - 类图如何转化为代码？

> ID：14258343
> 
> 赞同：2
> 
> 时间：2013-01-10T12:49:55.180
> 
> 标签：class, class-diagram

我正在自学各种 UML 图，我理解了大多数，除了`Class Diagram`和`Object Diagram`.

我无法理解它们将如何转换为代码。

我学到的技巧是：*所有名词都变成类，动词变成类的方法*。

一切都很好，但在那之后，图表是如何转换成代码的？
看看我从网上得到的一张图：
![在此处输入图像描述](../Images/07f2309a0841c9c758fe7a4e22d4bfab.png)

那么，假设语言是**Java**，您将如何基于此编写软件？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-10T13:11:13.337

UML 图仅描述给定软件的内部架构。

因此，UML 图中包含的信息是：

*   包含哪些类
*   它们包含哪些方法和属性
*   它们如何相互关联

每个带有标题的块（例如“Train”）代表一个类，列出其属性和方法。

因此，UML 图没有说明任何关于 GUI 或用户如何与软件交互的内容。由您或 UI/UX 设计师来创建一个您可以实现的界面，该界面使用此 UML 图中概述的功能。

您可以将 UML 图视为对软件架构的描述，它非常肤浅，但非常适合项目概述。

这不是食谱。

我希望这对你有用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-10T13:14:09.293

当你有一个类图时，你就有了你应该在代码中拥有的类（及其成员）的表示。所以，当你有一个类图时，你的名词/动词分析（你在说什么）已经完成了。类图只是类的可视化表示，如果您知道要使用的语言的语法，则将它们转换为代码很容易。

# ios - Overriding "text" in UILabel does not work in iOS 6

> ID：14258345
> 
> 赞同：0
> 
> 时间：2013-01-10T12:49:58.317
> 
> 标签：ios, ios6, uilabel

My class "TypographicNumberLabel" is a subclass of UILabel. This class overrides the "text" setters and getters of UILabel with the purpose to produce nicely rendered numbers in a table. For instance, it can add some extra white space for right alignment, unary plus signs, append units, etc.

My problem is that this class has worked perfectly fine up to iOS 5.1, but in iOS 6, it has stopped working: It is now rendering exactly as the standard UILabel (but when its properties are accessed from code, they are still giving correct results). Since this class is used in a huge mass of legacy code, I would really like to repair my original code instead of rewriting it using completely new methods. So, please focus your answers on explaining how to override "-text" and "-setText:" for UILabel in iOS 6.

This is (a simplified version of) my code:

```
@interface TypographicNumberLabel : UILabel {

        NSString *numberText;
    }

    // PROPERTIES

    // "text"            will be used to set and retrieve the number string in its original version.
    //                   integerValue, doubleValue, etc. will work as expected on the string.
    // The property "text" is declared in UILabel, but overridden here!

    // "typographicText" will be used to retrieve the string exactly as it is rendered in the view.
    //                   integerValue, doubleValue, etc. WILL NOT WORK on this string.
    @property (nonatomic, readonly) NSString* typographicText;

    @end

@implementation TypographicNumberLabel

- (void) renderTypographicText
{
    NSString *renderedString = nil;

    if (numberText) 
    {
        // Simplified example!
        // (Actual code is much longer.)

            NSString *fillCharacter = @"\u2007"; // = "Figure space" character

        renderedString = [fillCharacter stringByAppendingString: numberText];
    }

    // Save the typographic version of the string in the "text" property of the superclass (UILabel)
    // (Can be retreived by the user through the "typographicText" property.)

    super.text = renderedString;
}

#pragma mark - Overridden UILabel accessor methods

- (NSString *) text
{
    return numberText;
}

- (void) setText:(NSString *) newText
{
    if (numberText != newText)
    {
        NSString *oldText = numberText;
        numberText = [newText copy];
        [oldText release];
    }

    [self renderTypographicText];
}

#pragma mark - TypographicNumberLabel accessor methods

- (NSString *) typographicText
{
    return super.text;
}

@end 
```

Example of use (aLabel is loaded from .xib file):

```
@property(nonatomic, retain) IBOutlet TypographicNumberLabel *aLabel;

self.aLabel.text = @"12";
int interpretedNumber = [self.aLabel.text intValue]; 
```

This type of code works perfectly fine in both iOS 5.1 and in iOS 6, but the rendering on screen is wrong in iOS 6! There, TypographicNumberLabel works just like a UILabel. The "figure space" character will not be added.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-10T14:52:00.073

The issue is at

```
- (NSString *) text
{
    return numberText;
} 
```

You can see the method ([self text]) is called internally, so it's better to return the text you want to be shown, otherwise you can easily ruin internal control logic:

```
- (NSString *) text
{
    return [super text];
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-10T15:05:05.213

After having submitted my question, I found a solution myself. Perhaps not the definite solution, but at least a useful workaround. Apparently, the rendering logic of UILabel has changed when *attributedText* was introduced in iOS 6\. I found that setting the *attributedText* property instead of *super.text* will work.

To be more specific: The following line in *renderTypographicText*

```
 super.text = renderedString; 
```

should be replaced with

```
 if (renderedString && [UILabel instancesRespondToSelector: @selector(setAttributedText:)])
    super.attributedText = [[[NSAttributedString alloc] initWithString: renderedString] autorelease];
else
    super.text = renderedString; 
```

then the rendering works fine again!

This is a bit "hackish", I admit, but it saved me from rewriting a huge amount of legacy code.

# c# - NHibernate 需要一个事务才能使更新成功

> ID：14258346
> 
> 赞同：0
> 
> 时间：2013-01-10T12:50:03.833
> 
> 标签：c#, nhibernate

使用 NHibernate，在我的 NUnit 测试中，我可能会进行调用，例如`session.Delete(_user)`where `_user`is an persistent object。

我的问题似乎是，除非我在事务中包含此更新和任何其他更新，否则它永远不会成功。

所以，

```
CurrentSessionContext.Bind(GetHibernateSessionFactory().OpenSession());
ITransaction trans=session.BeginTransaction()
session.Delete(_user);
trans.Commit();
CurrentSessionContext.Unbind(GetHibernateSessionFactory()) 
```

作品。

但，

```
CurrentSessionContext.Bind(GetHibernateSessionFactory().OpenSession());
session.Delete(_user);
CurrentSessionContext.Unbind(GetHibernateSessionFactory()) 
```

没有，但没有报告异常或问题。

有任何想法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-10T12:53:28.300

NHibernate 只会在刷新会话时向数据库发送更新/插入/删除。

您可以通过调用 Flush() 显式执行此操作，但您还应该查看配置：您也可以在那里指定默认的刷新行为。

有趣的阅​​读：

[NHibernate ISession Flush：何时何地使用它，为什么？](https://stackoverflow.com/questions/43320/nhibernate-isession-flush-where-and-when-to-use-it-and-why) [NHibernate Flush——它是如何工作的？](https://stackoverflow.com/questions/780755/nhibernate-flush-how-it-works)

# node.js - /socket.io/socket.io.js 中不提供 Socket.io

> ID：14258349
> 
> 赞同：3
> 
> 时间：2013-01-10T12:50:13.350
> 
> 标签：node.js, express, socket.io, http-status-code-404

我已经在这里阅读了关于我在 node.js 中的问题的答案，但我的问题仍然存在。在服务器中使用 socket.io，一切看起来都很好，但在客户端，chrome 说：加载资源失败：服务器响应状态为 404（未找到）localhost:3382/so​​cket.io/socket.io.js

```
var express = require("express");
var http = require("http");
var _io = require("socket.io");

var PORT = 3382;

var app = express();

app.listen(PORT, function(){
console.log("Listening from "+PORT);
});

var server = http.createServer(app);
var io = _io.listen(server); 
```

用玉我有：

```
script(src='/js/jquery.js')
script(src='/js/chat.js')
script(src="socket.io/socket.io.js") 
```

我在静态文件夹中有文件夹 js，它工作正常。我不知道是不是因为版本（node -v 显示 v0.8.16），我如何查看 express 和 socket.io 的版本？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-10T13:12:55.300

通读[http://expressjs.com/api.html#app.listen](http://expressjs.com/api.html#app.listen)，注意如何`app.listen`定义。

简而言之：替换`app.listen`为`server.listen`.

# ios - iOS - UIButton 在一次点击中启用/禁用两个或多个按钮

> ID：14258353
> 
> 赞同：1
> 
> 时间：2013-01-10T12:50:28.347
> 
> 标签：ios, cocoa-touch, uibutton

我有三个按钮分配给属性“botao2”（例如计算器）。

当我将鼠标悬停在左侧的圆圈（.h 文件上的@property）上时，只有一个按钮被突出显示。

当我将鼠标悬停在 - (IBAction) （在 .m 文件上）时，所有三个按钮都会突出显示......

当我尝试禁用 botao2 (_botao2.enabled = FALSE;) 它确实有效（所有三个按钮都被禁用），但是当我单击原始按钮（在 .h 文件中突出显示的那个）时，它甚至不会改变它的颜色（它真的被禁用了！）。

其他两个按钮也被禁用，但是当我单击它们时，我看到颜色发生了变化（单击时为蓝色，释放时返回白色）。

它只是一个模拟器故障还是可以将所有按钮设置为禁用，就像原始按钮（.h 文件之一）一样？

# apache - Mod_Mono 2.10 编译错误

> ID：14258354
> 
> 赞同：0
> 
> 时间：2013-01-10T12:50:30.867
> 
> 标签：apache, mono, mod-mono

我目前正在尝试在 OpenSUSE 上安装 Mono 3.0.3。我已经从各自的 tar 文件中编译并安装了每个部分（mono 3.0.3、XSP 2.10.1 和 Apache HTTPD 2.4.3），但是 mod_mono 2.10（和 2.8）都抛出编译错误。

在编译和安装每个部分时，我确保所有前缀都相同：

```
./configure --prefix=/usr/local
make
make install 
```

但是 make 导致 mod_mono 输出以下内容：

```
...SNIP...
mod_mono.c: In function ‘send_initial_data’:
mod_mono.c:1981:44: error: ‘conn_rec’ has no member named ‘remote_ip’
mod_mono.c:2029:54: error: ‘conn_rec’ has no member named ‘remote_ip’
mod_mono.c: In function ‘apache_get_groupid’:
mod_mono.c:403:1: warning: control reaches end of non-void function [-Wreturn-type]
mod_mono.c: In function ‘apache_get_userid’:
mod_mono.c:393:1: warning: control reaches end of non-void function [-Wreturn-type]
mod_mono.c: In function ‘apache_get_username’:
mod_mono.c:413:1: warning: control reaches end of non-void function [-Wreturn-type]
make[1]: *** [mod_mono_la-mod_mono.lo] Error 1 
```

有人见过这个吗？有解决办法吗？还是 mod_mono 根本不适用于 mono 3.0.3 或 Apache 2.4.3？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-11T18:44:23.517

看起来`remote_ip`apache`conn_rec`结构中的成员最近已重命名。您尝试编译的 mod_mono 与您拥有的特定 apache 版本不兼容。`remote_ip`如果这是唯一的错误，只需将有问题的引用更改为`client_ip`in即可轻松修复`mod_mono.c`。

# c# - 根据数组中的字符串数量动态创建文本框

> ID：14258355
> 
> 赞同：0
> 
> 时间：2013-01-10T12:50:31.013
> 
> 标签：c#, asp.net, arrays, web-services, textbox

我正在遍历一个字符串数组。

对于每个字符串，我需要将其显示在网页上的新文本框中。

我只有一个可用的文本框来完成这项工作，但这只是一个概念证明。我的问题是我现在正在处理更大的数组，具有不同数量的字符串。

有没有一种方法可以根据有多少字符串在页面上动态创建文本框？

这是我到目前为止所拥有的-

```
 protected void CheckBoxList1_SelectedIndexChanged(object sender, EventArgs e)
     {
        WebService1 ws = new WebService1();

        foreach (string x in ws.mRETURN(CheckBoxList1.SelectedItem.Text))
        {

            TextBox1.Text = x;

        }  
     } 
```

所以页面上已经存在一个文本框，但是我知道它需要依赖于从 web 服务传递的字符串数量，并将这个数字与所需的文本框数量相关联。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-10T12:55:37.907

试试这个

标记

```
<asp:DataList runat="server" ID="repeatedTextBox">
<ItemTemplate>
  <asp:TextBox ID="myTextBox" runat="server" Text='<%# Container.DataItem.ToString() %>'></asp:TextBox>
</ItemTemplate>
</asp:DataList> 
```

代码隐藏

```
repeatedTextBox.DataSource = myChangingArrayOfString;  //e.g ws.mRETURN(CheckBoxList1.SelectedItem.Text)
repeatedTextBox.DataBind(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-10T13:00:10.250

如何在网页上使用占位符并以编程方式向其添加控件（文本框）。

```
<asp:PlaceHolder id="Area1" runat="server"></asp:PlaceHolder></P> 
```

然后在您的后端添加：

```
TextBox tbx = new TextBox();
Area1.Controls.Add(tbx); 
```

在一个循环中你能做到吗？我还在学习，所以这是我现阶段最好的建议。

来源：[来源](http://www.developerfusion.com/code/3826/adding-controls-to-placeholders-dynamically/)

# jquery - 为什么在 jQuery API 文档中列出的处理函数带有参数？

> ID：14258356
> 
> 赞同：2
> 
> 时间：2013-01-10T12:50:31.897
> 
> 标签：jquery, syntax

在 jQuery 手册本身中，它显示了[**blur**](http://api.jquery.com/blur/)函数：

```
.blur(handler(eventObject)) // PLUS 2 OTHER VARIATIONS 
```

所以对我来说使用这个函数你会得到这样的东西：

```
<!DOCTYPE html>
<html>
  <head>
    <script src="http://code.jquery.com/jquery-latest.js"></script>
  </head>
  <body>
    <form>
      <input id="target" type="text" value="Field 1" />
      <input type="text" value="Field 2" />
    </form>
    <div id="other">Trigger the handler</div>
    <script>
      $('#target').blur(myhandler(evObj));

      function myhandler(evObj) {
        console.log(evObj);
      };
    </script>
  </body>
</html> 
```

但`$('#target').blur(myhandler(evObj));`不是正确的语法正确的语法是真的`$('#target').blur(myhandler);`

所以总体上脚本标签的整个代码应该是：

```
<script>
  $('#target').blur(myhandler);

  function myhandler(e) {
    console.log(e);
  };
</script> 
```

1.  为什么会这样？
2.  一个人怎么知道不写`.blur(handler(eventObject))` ？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-10T12:55:26.023

你是对的，技术上正确的语法是

```
blur(handler) 
```

但是，这实际上并不是很有用，因为如果您正在查看文档，您可能想知道处理程序接收哪些参数。很明显，您`blur`使用*函数*作为其唯一参数进行调用，因此 jQuery docs *par abus de notation*写道

```
blur(handler(eventObj)) 
```

表示处理函数接受一个参数，即事件对象。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-10T14:25:10.333

在 JavaScript 中，函数只是另一种对象。您偶然发现了写作`myfunction`和写作之间的巨大差异`myfunction()`——第一个是函数对象，第二个是该函数的返回值。

所以：`$('#target').blur(...)`是一种接受一个对象的方法，它**必须**是一个函数。

当你写的时候`$('#target').blur( myhandler(evObj) )`，`myhandler` *函数*没有传递给`.blur()`. 相反，它后面的括号告诉 JavaScript 评估函数（使用参数`evObj`），然后将函数的*返回值*传递给`.blur()`。

如果该返回值恰好是另一个函数对象，那么一切都很好。但如果没有，你会得到一个错误。

但是，通常开发人员不会声明单独的函数`myhandler`。相反，我们将使用这样的*匿名函数*：

```
$('#target').blur(function(evObj) {
    /* do stuff with evObj */
}) 
```

**这**就是 API 文档编写的原因`$('#target').blur( myhandler(evObj) )`——以便开发人员知道匿名处理函数接受哪些参数。

# javascript - 如何在javascript中完成第一个回调后执行第二个回调？

> ID：14258357
> 
> 赞同：0
> 
> 时间：2013-01-10T12:50:32.613
> 
> 标签：javascript, asp.net, c#-4.0, web-applications

我搜索了很多网站以获得一种方法来执行顺序回调，即第二个函数应该只在第一个函数完成后执行。在我的情况下，我正在更新按钮单击中节点的一些属性，并且每个属性更新都应该执行一个回调。我的问题是一些属性更新是基于以前的属性，我无法实现这一点..因为 javascript 全部执行。

所以请指出我正确的方向..如何在完成之前的回调后执行回调。

提前致谢。

这是我的代码：

```
function SetProperties() {
        var nodes = Control1.GetNodesList();
        var ColorStyle = {
            Color: 'Red',
            ForeColor: 'Maroon',
            ColorAlphaFactor: '255',
            ForeColorAlphaFactor: '255',
            Type: '2',                
            PathBrushStyle: '1'
        };

         var LineStyle = {                
            LineColor: 'Blue',
            LineWidth: '2'
         };

         Control1.SetColorStyle(nodes[0].FullName, ColorStyle);
         Control1.SetLocation(nodes[0], 150, 300);
         Control1.SetRadius(nodes[0], 20);
         Control1.SetShading(nodes[0], true);
         Control1.SetSize(nodes[0], 150, 150);
         Control1.SetLabel(nodes[0], label);            
         Control1.SetLineStyle(nodes[0], LineStyle);
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-10T13:22:16.600

如果理解，您可以在页面中定义隐藏字段

```
<input type='hidden' runat='server' id='funToCall'/> 
```

然后你可以在你的javascript中创建开关

```
var funToCall=<% funToCall.Value %>;
switch(funToCall){
   case "fun1": Control1.SetColorStyle(nodes[0].FullName, ColorStyle); break;
   case "fun2": Control1.SetLocation(nodes[0], 150, 300); break;
...
} 
```

并在后面的代码中定义在每个回发中要调用的下一个函数

```
funToCall.Value="next fun..."; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-10T13:31:14.753

这取决于您的第一个回调函数是如何工作的。JavaScript 实际上并不是一次全部执行，它在单个线程中按顺序执行。如果您的第一个回调在一系列命令中完成所有工作，那么下一段代码只有在完成后才会开始执行。

例如：

```
var a = 0;

function fun1() {
    a = 1;
}

function fun2() {
    alert(a);
}

fun1();
fun2(); 
```

将给出与以下相同的结果：

```
var a = 0;
a = 1;
alert(a); 
```

因为`fun2`将在执行完毕`fun1`后执行。

# javascript - javascript - 在动态图上创建事件

> ID：14258360
> 
> 赞同：0
> 
> 时间：2013-01-10T12:50:41.607
> 
> 标签：javascript, html, graph

我已经使用可视化函数创建了一个动态条形图，并且形象化.css 图形的值是通过 HTML 表给出的，现在我想在该图形上执行一个事件。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-10T12:54:16.763

创建自定义事件：

```
(function() {

    /**
     * Small event class, can be instanciated as an object or using .call used to decorate other
     * Objects with events funcitonality. 
     */
    MyEvent.Event = function() {

        this.events = {};

        this.bind = function(eventName, func) {

            if (!this.events[eventName]) {
                this.events[eventName] = [];
            }

            this.events[eventName].push(func);
        };

        this.trigger = function(eventName, args, scope) {

            if (this.events[eventName]) {

                var len = this.events[eventName].length,
                    funcArgs = (jQuery.isArray(args)) ? args : [args];

                // This will go from back to front through the array not sure if this really matters?
                while (len--) {         
                    this.events[eventName][len].apply(scope || window, funcArgs);
                }
            }
        }

        this.removeAllEvents = function() {
            this.events = {};
        }
    };

    // Page level events class
    MyEvent.pageEvents = new MyEvent.Event();

})(); 
```

触发它：

```
MyEvent.pageEvents.trigger("Method-name", "data")); 
```

最后听一下：

```
MyEvent.pageEvents.bind("Method-name", function(Data) {
    //Code goes here
}); 
```

**使用jQuery？**

看看[trigger 和 bind](http://jamiethompson.co.uk/web/2008/06/17/publish-subscribe-with-jquery/)。

# asp.net - 带有子报表导出到 Excel 的水晶报表失败

> ID：14258362
> 
> 赞同：0
> 
> 时间：2013-01-10T12:50:51.013
> 
> 标签：asp.net, visual-studio-2010, crystal-reports, export-to-excel, crystal-reports-2010

我正在使用 Visual Studio 2010 中的 ASP.Net Web 应用程序。我正在使用 SAP Crystal Reports for VS2010 中设计的报表。

我可以将报告导出为 PDF 和 Word 格式，但是当我尝试将其导出为 Excel 格式时，Visual Studio 调试会停止，并且永远不会返回响应。

我正在为 Visual Studio 2010 使用 Crystal Reports，并且有问题的报表在第 1 节（报表标题）中有一个简单的子报表（只有一个标签）。

```
using (TestReport report = new TestReport()) // TestReport inherits ReportClass
{
    TestDataSet data = this.GetData();
    report.SetDataSource(data);
    return report.ExportToStream(ExportFormatType.Excel);
} 
```

失败，`report.ExportToStream(ExportFormatType.Excel);`调试就停止了。如果我删除子报告，它可以正常工作，否则它会失败。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-11T06:37:08.853

我设法通过将输出格式枚举值替换为 to 来修复`Excel`它`ExcelWorkbook`...

代码：

```
using (TestReport report = new TestReport()) // TestReport inherits ReportClass
{
    TestDataSet data = this.GetData();
    report.SetDataSource(data);
    return report.ExportToStream(ExportFormatType.ExcelWorkbook);
} 
```

# android - 导入 com.google.android

> ID：14258367
> 
> 赞同：1
> 
> 时间：2013-01-10T12:51:01.990
> 
> 标签：android, google-maps

我无法导入 com.google.android.gms.maps.SupportMapFragment

我阅读了一些主题，但找不到解决方案。

我在propreties > android中选择了google api

我在清单 > 应用程序中添加

我进口

C:\Users\User\AppData\Local\Android\android-sdk\add-ons\addon-google_apis-google-8\libs\maps.jar

到我的项目

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-10T12:53:55.420

```
Right Click on maps.jar->Build Path-> Add to Build Path 
```

它可能会起作用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-06-03T10:48:11.820

我遇到了同样的问题，后来发现 google-play-sevices-lib ( `android-sdk\extras\google\google_play_services\libproject\google-play-services_lib` ) 项目没有添加为库项目。

# java - 导入不带包名的静态

> ID：14258369
> 
> 赞同：13
> 
> 时间：2013-01-10T12:51:24.127
> 
> 标签：java, importerror

考虑以下简单的代码示例：

```
public class TestStaticImport {
    static enum Branches {
        APPLE,
        IBM
    }
    public static void doSomething(Branches branch) {
        if (branch == APPLE) {
            System.out.println("Apple");
        }
    }
} 
```

如果我们尝试编译此代码，我们将收到错误消息：

```
java: cannot find symbol
  symbol:   variable APPLE
  location: class TestStaticImport 
```

这可以通过引入 this 的静态导入来解决`enum`：

`import static`...`TestStaticImport.Branches.*`

**但是在这一刻（对我来说）难以理解的事情开始了：**

这个解决方案工作正常，一切都编译得很好，直到类`TestStaticImport`被移动到空的根包中，即没有任何

`package blablabla;`在这个java文件的顶部；

代码行：`import static TestStaticImport.Branches.*;`在我的 Intellij IDEA 中突出显示为有效代码（IDE 的名称无关紧要，仅供参考），但是当我尝试编译此类代码时出现以下错误：

`java: package TestStaticImport does not exist`

所以，其实有两个问题：

1）**主要问题**：为什么不可能`import static`从空目录？

2)除了静态导入之外，还有什么方法（如果存在）允许仅使用枚举字段的名称（即，`APPLE`而不是）在代码中引用枚举字段？`Branches.APPLE`

* * *

PS拜托，不要告诉我，空包是丑陋的风格等等。这个问题只是理论上的问题。

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2013-01-10T12:55:35.743

[Java 语言规范](http://docs.oracle.com/javase/specs/jls/se7/html/jls-7.html#jls-7.5)禁止来自未命名包的任何导入：

> 未命名包中的类型（第 7.4.2 节）没有规范名称，因此每种导入声明中对规范名称的要求意味着（a）无法导入未命名包中的类型，以及（b）静态成员无法导入未命名包中的类型。因此，第 7.5.1 节、第 7.5.2 节、第 7.5.3 节和第 7.5.4 节都要求在尝试将类型（或其静态成员）导入未命名包中时出现编译时错误。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-01-10T13:00:51.870

在古代，Java 的发明者必须将 Java 类型映射到文件，这样编译器才能做一些真正的工作。他们决定将包映射到文件夹，将类型映射到文件。那工作得很好。尤其是给新人定下了情感背景：“我恨你，别惹我。” 但我离题了。

但是，默认包是个问题，因为它没有明确定义的文件夹。如果您有 package `com`，您知道`com`某处有一个文件夹，但默认包的文件夹名称是什么？

所以设计师决定不要`import`和默认包混合。事实上，当您尝试导入任何没有包的东西时会出现错误（即`import TestStaticImport`没有`static`and`*`也会失败）。请参阅[如何从默认包中导入类](https://stackoverflow.com/questions/2193226/how-to-import-a-class-from-default-package)

所以问题不在于静态导入，而是您尝试从默认包导入。

像 Java 中的其他一些极端情况一样，没有解决方案。

另请参阅：[在 Java 中-“无法导入默认包的静态成员”-有人可以解释此语句吗？](https://stackoverflow.com/questions/1963983/in-java-static-members-of-the-default-package-cannot-be-imported-can-some-on)

# javascript - 我是否应该使用 $rootScope 来存储只需要发出一次的 http 请求

> ID：14258370
> 
> 赞同：1
> 
> 时间：2013-01-10T12:51:24.687
> 
> 标签：javascript, angularjs

我正在将 AngularJs 用于新应用程序。我觉得我已经解决了一个问题，但我不确定我是否以最好的方式完成了它，所以想在开枪前检查一下。

例如，假设我有两个控制器 AccountsCtrl 和 ContactsCtrl，每次调用每个控制器时，都会为所有帐户或联系人分别为每个控制器发出对 REST 服务器的请求。在控制器中时，任何数据更改都会在角度模型（和服务器后端）中保持同步，以反映这一点，从而反映 UI。每次用户在每个控制器之间切换时，他们都必须调用服务器以获取上次加载时已经拥有的数据（这是最新的）。

目前，这会导致非常小的延迟。我想让它持久化，即每次加载控制器时不加载以节省滞后和服务器请求。我尝试将数据保存到 $rootScope 中，效果很好，但我不确定这样做是否正确？

问题是如何最好地解决这个问题？$rootScope 是解决这个问题的最佳方法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-10T16:01:17.280

我会将与 Web 服务器交互的数据和代码存储在一两个 Angular 服务中。每次创建控制器时（例如，当您第二次返回页面时），（适当的）服务应该决定是返回缓存数据还是向您的 REST 服务器发出 Ajax 请求。

您的服务将被注入到您的控制器中。

另请参阅[https://stackoverflow.com/a/12009408/215945](https://stackoverflow.com/a/12009408/215945)和[https://groups.google.com/d/topic/angular/eegk_lB6kVs/discussion](https://groups.google.com/d/topic/angular/eegk_lB6kVs/discussion)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-10T13:02:33.960

首先，您应该通过服务进行 REST 调用：

```
app.factory('RestService', ['$http', function($http) {
   return {
     getSomething: function(url) {
        var result = {};

        $http.jsonp(url).success(function(data) {
           result.list = data;
        });
        return result;
     }
   };
   ...
}]; 
```

你不需要`$rootScope`。只需定义一个父控制器，它涵盖两个控制器，例如`RootController`，并将数据存储在那里。这是因为子范围（例如来自 AccountsCtrl）继承了父范围中定义的内容。

```
<div ng-controller="RootController">
    <div ng-controller="AccountsCtrl">
    </div>
    <div ng-controller="ContactsCtrl">
    </div>
</div> 
```

在实践中，这与 using 几乎相同`$rootScope`，但您不需要注入它，并且您的控制器逻辑与其他控制器相似。

# orbeon - Orbeon：使用表单生成器创建向导表单

> ID：14258371
> 
> 赞同：0
> 
> 时间：2013-01-10T12:51:30.723
> 
> 标签：orbeon

创建向导窗体。我有三个部分 1) 个人 2) 家庭 3) 测试

在前两节中，它应该显示下一个按钮，在最后一节测试中应该有一个提交按钮，它将重定向到 jsp

可以帮助我们如何完成这项任务。

这是我的代码

```
< fr:buttons>
     <fr:button>
         <xforms:label>
               <xhtml:img width="16" height="16" src="/apps/fr/style/images/pixelmixer/right_16.png"
                                       alt=""/>
                <xhtml:span>Next</xhtml:span>
           </xforms:label>
            <xforms:setvalue ev:event="DOMActivate" ref="instance('fr-form-instance')/internal/part"
             value="if (. = 'personal') then  'family' 
              else if (. = 'family') then 'test' else ''"/>
     </fr:button>
      </fr:buttons> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-12T23:56:39.503

手动正确地完成这项工作将是一项艰巨的工作。由于 Orbeon Forms 4.0[开箱即用支持此](http://blog.orbeon.com/2012/12/form-runner-wizard-view.html)功能，因此我强烈建议您使用它并在缺少您需要的功能时提供反馈。可以使用 4.0的[Beta 版本](http://blog.orbeon.com/2013/01/orbeon-forms-40-beta.html)。

# iphone - 无法使用 Rails、apn_sender gem 连接到 APNS（Apple 推送通知服务器）

> ID：14258373
> 
> 赞同：0
> 
> 时间：2013-01-10T12:51:34.123
> 
> 标签：iphone, ruby-on-rails, push-notification, apple-push-notifications

我正在使用**Rails 3.2.2**和**apn_sender 1.0.5 gem**。我已经生成了正确的**apn_development.pem**和**apn_production.pem**。我已将它们添加到我的 rails 应用程序中。通过查看一些文章，我也修改了 apn_production.pem 文件权限。我仍然无法从我的 Rails 应用程序连接到 Apple 的 APNS 服务器。

```
feedback_data = APN::Feedback.new(:environment => :production), still returns
#<APN::Feedback: Connection not currently established to feedback.push.apple.com on 2196> 
```

我是否遗漏了什么，或者是否有任何机构有关于如何从 Rails 应用程序发送（APNS）Apple 推送通知的详细教程。
任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-13T02:30:09.083

我找到了解决方案。生成正确的证书后，我遇到了“为其他环境开发应用程序”的问题。通过用适当的构建替换移动应用程序，问题得到了解决。

谢谢！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-03-06T14:27:50.413

APN::Feedback.new() 返回 # 这有点误导。我认为我必须在其他地方建立联系。

原来，我只需要调用 .data 方法来启动连接

```
feedback_data = APN::Feedback.new().data 
```

# javascript - 创建两个列表并使用键盘导航并在输入键上按下列表项应从一个列表弹出到另一个列表，反之亦然

> ID：14258382
> 
> 赞同：0
> 
> 时间：2013-01-10T12:52:05.900
> 
> 标签：javascript, jquery, jquery-ui

例如：“像这样，但这是使用鼠标单击。如果使用按键，那就太好了，谢谢。” 这是代码：[演示](http://jsfiddle.net/VQu3S/173/)

```
$(".ingredient").click(function(){
   var element = $(this);
   var added = false;
   var targetList = $(this).parent().siblings(".ingredientList")[0];
   $(this).fadeOut("fast", function(){
     $(".ingredient", targetList).each(function(){
       if ($(this).text() > $(element).text()){
          $(element).insertBefore($(this)).fadeIn("fast");
          added = true; return false; 
        } 
     });
     if(!added) $(element).appendTo($(targetList)).fadeIn("fast");
   });
}); 
```

* * *

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-10T13:29:17.553

看到这个：http: [//jsfiddle.net/Nhv8n/](http://jsfiddle.net/Nhv8n/)

不完美，但它几乎在那里......

```
var li = $('li');
var liSelected;
$(window).keydown(function (e) {
if (e.which === 40) {
if (liSelected) {
  liSelected.removeClass('selected');
  next = liSelected.next();
  if (next.length > 0) {
    liSelected = next.addClass('selected');
  } else {
    liSelected = li.eq(0).addClass('selected');
  }
} else {
  liSelected = li.eq(0).addClass('selected');
}
  } else if (e.which === 38) {
if (liSelected) {
  liSelected.removeClass('selected');
  next = liSelected.prev();
  if (next.length > 0) {
    liSelected = next.addClass('selected');
  } else {
    liSelected = li.last().addClass('selected');
  }
} else {
  liSelected = li.last().addClass('selected');
}
} else if (e.which === 39) {
if (liSelected) {
  liSelected.removeClass('selected');
  next = liSelected.parent().next('ol').find('li:first');
  if (next.length > 0) {
    liSelected = next.addClass('selected');
  } else {
    liSelected = li.last().addClass('selected');
  }
} else {
  liSelected = li.last().addClass('selected');
}
  } else if (e.which === 37) {
if (liSelected) {
  liSelected.removeClass('selected');
  next = liSelected.parent().prev('ol').find('li:first');
  if (next.length > 0) {
    liSelected = next.addClass('selected');
  } else {
    liSelected = li.last().addClass('selected');
  }
} else {
  liSelected = li.last().addClass('selected');
}
}
  else if (e.which === 13) {
  var $el = $(".ingredient.selected"); //.removeClass('selected')
  var added = false;
  var targetList = $el.parent().siblings(".ingredientList")[0];
  $el.fadeOut("fast", function () {
  $(".ingredient", targetList).each(function () {
    if ($el.text() > $el.text()) {
      $el.insertBefore($el).fadeIn("fast");
      added = true;
      return false;
    }
  });
  if (!added) $el.appendTo($(targetList)).fadeIn("fast");
});
}
}); 
```

# magento - Magento 升级到 v1.7 失败并出现数据库错误

> ID：14258388
> 
> 赞同：1
> 
> 时间：2013-01-10T12:52:22.900
> 
> 标签：magento, magento-1.7, magento-1.4

我正在尝试将客户端 Magento 升级到 v1.7（从 v1.4）。一路上我遇到了一些小插曲，但没有什么太悲惨的……直到现在。

我的升级路线是复制现有的 v1.4 数据库并安装新版本的 1.7。然后运行标准升级脚本，数据库应该升级到 v1.7（当然除了升级后需要重新安装的任何已安装扩展）。这是我以前使用过的一条路线，似乎比通过 magento connect 升级更可靠。

然而，我碰上了一面砖墙。我收到以下错误报告：

```
a:5:{i:0;s:464:"Error in file: "/route/to/magento/install/app/code/core/Mage/Cms/data/cms_setup/data-upgrade-1.6.0.0.0-1.6.0.0.1.php" - SQLSTATE[23000]: Integrity constraint violation: 1452 Cannot add or update a child row: a foreign key constraint fails (`magento_1411_1702/cms_page_store`, CONSTRAINT `FK_CMS_PAGE_STORE_STORE_ID_CORE_STORE_STORE_ID` FOREIGN KEY (`store_id`) REFERENCES `core_store` (`store_id`) ON DELETE CASCADE ON UPDATE CASCAD)";i:1;s:1095:"#0 /route/to/magento/install/app/code/core/Mage/Core/Model/Resource/Setup.php(645): Mage::exception('Mage_Core', 'Error in file: ...') 
```

现在这向我推断在 cms_page_store 中有一条记录，它的 store_id 在相关表中找不到（在这种情况下，唯一相关表是 core_store）。不是这种情况。core_store 中有一条记录，cms_page_store 中没有条目，即使这没有破坏参照完整性，我还是绝望地删除了它，但没有成功。

我还检查了其他直接相关表中的记录，但仍然找不到错误原因。

有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-10T13:16:27.360

从 1.4 更新到 1.7 时，我必须先清空两个表才能成功。在此之前，我遇到了各种奇怪的错误。我清空的表（未删除，仅清空）是： 如果这对您的情况也有帮助，请尝试`report_compared_product_index`。`report_viewed_product_index`

哦，我忘了，以防你想知道。这些表格用于关于比较和查看的产品的非必要统计数据。如果您依赖于过去准确的商店统计数据，那么您可能需要更深入地研究这个问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-07-31T07:54:53.870

尝试一下

```
SET FOREIGN_KEY_CHECKS=0;
UPDATE `core_store` SET store_id = 0 WHERE code='admin';
UPDATE `core_store_group` SET group_id = 0 WHERE name='Default';
UPDATE `core_website` SET website_id = 0 WHERE code='admin';
UPDATE `customer_group` SET customer_group_id = 0 WHERE customer_group_code='NOT LOGGED IN';
SET FOREIGN_KEY_CHECKS=1; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-10T13:38:56.183

您能否验证您在 core_store 中有一个 store_id 为 0 的管理存储？我遇到了与主键 ID 变化和升级脚本期间做出的一些假设类似的问题。

# android - Android-3D-Carousel 项目在 android 中点击

> ID：14258389
> 
> 赞同：1
> 
> 时间：2013-01-10T12:52:32.483
> 
> 标签：android, carousel

我使用 Android-3D-Carousel[代码](http://www.codeproject.com/Articles/146145/Android-3D-Carousel)

当我点击轮播布局中的任何位置时，它就像我点击前面的图标一样工作，我该如何解决这个点击问题。我的意思是当我点击轮播布局中的任何位置时，我需要它不采取前面图像的点击动作。

任何人都可以帮助我。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-09-22T16:40:23.200

我也使用旋转木马，对我来说它可以正常工作我的意思是当我点击旋转木马的任何项目时，它会让我做出反应。如果您的问题尚未解决，请将您的代码放在此页面中。

# lua - 如何在我的应用程序中使用字典

> ID：14258391
> 
> 赞同：1
> 
> 时间：2013-01-10T12:52:50.160
> 
> 标签：lua, coronasdk

有没有办法导入字典或使用 Corona sdk 创建字典。我有一个游戏，用户必须从基本单词创建单词，每次提交单词时我都需要检查它是否正确

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-10T15:27:01.497

创建一个 Lua 表，并使用要存储在字典中的单词填充它，使用单词作为键，使用 true 作为值：

```
dict = {}
dict[word] = true 
```

您可能希望在存储或检查单词之前将它们转换为小写：

```
word = string.lower(word) 
```

测试本身就是这样的：

```
if dict[word] then ... 
```

# java - 从资产文件夹或 SD 卡访问文件有什么区别

> ID：14258395
> 
> 赞同：5
> 
> 时间：2013-01-10T12:52:54.840
> 
> 标签：java, android, android-sdcard, android-video-player, android-assets

我正在开发一个应用程序，我必须使用三个不同大小的文件（1mb、5mb、15mb）。我搜索了一下，然后才知道我们可以将这些视频保存在 assets 文件夹中并可以使用这些视频。

其次，我知道我们可以将这些视频保存在 assets 文件夹中，安装时我们可以将所有视频移动到 SD 卡中。当尝试第二种方法时，由于文件大小较大而面临问题。

那么，谁能告诉我这两种方法有什么区别以及我应该使用哪一种。任何指针将不胜感激。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-10T13:04:08.517

**超过 1mb 的**文件**`assets folder`将无法从您的应用程序中**读取****（它会引发异常）**。**

 **这是因为它们是`compressed`在构建过程中获得的，因此手机在手机上时需要大量`resources`解**压缩**它们。

如果`asset`是`compressed`的话，系统已经到`uncompress`了整个事情的地步`memory`。如果您有 20MB 的资产，这意味着 20MB`physical memory`被您的应用程序占用。

我相信你可以把它们放在`raw folder`不会被**压缩**的地方。

**编辑 ：**

您最多可以将**50MB 文件大小的 APK**上传到 android 市场，这是标准配置，现在它也支持更大尺寸的**APK**。请参阅下面的参考链接：

[Android 应用程序打破 50MB 的障碍](http://android-developers.blogspot.in/2012/03/android-apps-break-50mb-barrier.html)

谢谢。**

# android - YouTube 原生播放器 API 和多屏 API

> ID：14258396
> 
> 赞同：0
> 
> 时间：2013-01-10T12:52:57.210
> 
> 标签：android, youtube-api, multiscreen

我在 Nexus 4 上运行了适用于 Android 的新 YouTube Player API，没有太多问题。现在我想将它与Android 4.2 中的多屏API（即Presentation 和MediaRouter 类）结合起来。

但是，似乎无法将其结合起来，因为 YouTubePlayerView 需要使用扩展了 YouTubeBaseActivity 的上下文进行初始化。由于您在远程屏幕上绘制的 Presentation 类中获得的 Context 实例没有扩展它，因此我无法实例化新的 YouTubePlayerView 或任何其他需要 YouTubeBaseActivity 作为其构造函数参数的类。

这使我无法使用 Andorid 4.2 中的新 API 在辅助屏幕上显示 YouTube 播放器。

是否有任何解决方法或计划发布支持 Android 4.2 和新的多屏 API 的更新 API？

谢谢，埃里克

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-12T14:34:31.487

忽略这篇文章中用小字写的所有内容。我对Android API一无所知...

[我认为这是可能的，但我没有尝试过，所以我不确定它是否会起作用。]

[免责声明：我是一名 Java 开发人员，但从未开发过 Android 应用程序。把我说的每一句话都拿在手里。]

[尝试创建您自己的类来扩展[YouTubeBaseActivity](https://developers.google.com/youtube/android/player/reference/com/google/android/youtube/player/YouTubeBaseActivity)类，并包装从[Presentation](http://developer.android.com/reference/android/app/Presentation.html)类中检索到的[Context](http://developer.android.com/reference/android/content/Context.html)实例。所以你会有一个[Context](http://developer.android.com/reference/android/content/Context.html)类型的最终“wrappedContext”字段，并且在构造函数中你会有一个初始化这个字段的[Context参数。](http://developer.android.com/reference/android/content/Context.html)]

[然后，尽可能通过调用包装对象的方法来定义/重载每个需要的方法（所有超类的抽象方法，也许还有一些非抽象方法）。]

如果你能做到这一点，请告诉我。我很感兴趣，因为自从我购买了 Nexus 4 和 SlimPort 适配器后，我一直想知道镜像是否是唯一的可能性，或者是否可以在辅助显示器上显示其他内容，以及分辨率是否可以高于1280x768 在辅助显示器上。我还没有看到任何应用程序使用新的 4.2 API 进行多显示器...

[编辑：包装的上下文可能是非最终的，也可以有一个设置器（setWrappedContext）。]

[Edit2：实际上每个 Activity 对象中已经有一个包装的 Context（请参阅[ContextWrapper](http://developer.android.com/reference/android/content/ContextWrapper.html)）并且 ContextWrapper 也扩展了 Context。]

[所以我真的不知道你应该在这里做什么。或许真的是不可能的……]

Edit3：如果您还没有阅读此页面，也许[此页面会有所帮助。](http://developer.android.com/about/versions/android-4.2.html#SecondaryDisplays)

Edit4：您是否尝试过使用[YouTubePlayerFragment](https://developers.google.com/youtube/android/player/reference/com/google/android/youtube/player/YouTubePlayerFragment)而不是[YouTubePlayerView](https://developers.google.com/youtube/android/player/reference/com/google/android/youtube/player/YouTubePlayerView)？似乎它可能会有所帮助，因为您不需要扩展 YouTubeBaseActivity ......

# c# - 在数据集中添加数据表列

> ID：14258399
> 
> 赞同：2
> 
> 时间：2013-01-10T12:53:04.243
> 
> 标签：c#, datatable, dataset

我有一个`DataSet`2`DataTable`的。每个都`DataTable`包含一个名为“成本”的列。我想计算一个名为 Result table 的表中 2 个表的所有成本的总和，如下例所示。我怎样才能做到这一点？

```
Table 1
Name  | cost
balan |  6
gt    |  5

Table 2
Name  |  cost
balan |  2
gt    |  8

Result table
Name  | cost
balan | 8
gt    | 12 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-10T13:09:36.177

这是一种方法：

```
DataTable dt1 = new DataTable();
DataTable dt2 = new DataTable();
DataTable results = new DataTable();

dt1.Columns.Add("Name");
dt1.Columns.Add("cost", typeof(int));
dt2.Columns.Add("Name");
dt2.Columns.Add("cost", typeof(int));
results.Columns.Add("Name");
results.Columns.Add("cost", typeof(int));

dt1.Rows.Add("balan", 6);
dt2.Rows.Add("balan", 2);
dt1.Rows.Add("gt", 5);
dt2.Rows.Add("gt", 8);

foreach (DataRow dr1 in dt1.Rows)
{
    results.Rows
        .Add(
            dr1["Name"], 
            (int)dr1["cost"] + (int)dt2.Select(String.Format("Name='{0}'", dr1["name"]))[0]["cost"]
        );
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-10T13:02:53.337

为了得到结果，你可以做类似的事情

```
var table1 = yourDataSet.Tables["Table 1"];
var table2 = yourDataSet.Tables["Table 2"];

var results = table1.AsEnumerable().Select(t1 => new {
                  name = t1.Field<string>("Name"),
                  cost = t1.Field<int>("cost")
              })
              .Concat(

              table2.AsEnumerable().Select(t2 => new {
                  name = t2.Field<string>("Name"),
                  cost = t2.Field<int>("cost")
              })
              )
              .GroupBy(m => m.name)
              .Select(g => new {
                 name = g.Key,
                 cost = g.Sum(x => x.cost)
              }); 
```

这不会给你一个数据表，而是一个 IEnumerable。要将 IEnumerable 转换为 dataTable，请参见[此处的示例](https://stackoverflow.com/questions/1253725/convert-ienumerable-to-datatable)

或更简单，如果 table1 和 table2 有相同的行

```
var table1 = yourDataSet.Tables["Table 1"];
var table2 = yourDataSet.Tables["Table 2"];

var results = new DataTable();

results.Columns.Add("Name");
results.Columns.Add("cost", typeof(int));

table1.AsEnumerable().Concat(table2.AsEnumerable())
                .GroupBy(m => m.Field<string>("Name"))
                .Select(g => results.Rows.Add(g.Key, g.Sum(x => x.Field<int>("cost")))); 
```

# c++ - 使用虚拟类增强信号2

> ID：14258403
> 
> 赞同：0
> 
> 时间：2013-01-10T12:53:16.180
> 
> 标签：c++, boost, virtual

在我一直在做的一个项目中，我使用了 boost 的信号2。在我开始使用虚拟课程之前，这一直很好。现在插槽不再被调用。以下是我的项目的精简版。

Glue 类创建 VSig 和 Process 类的实例，并将 VSig 中的信号连接到 Process 中的插槽。

IVSig.h：

```
class IVSig {
public:
    boost::signals2::signal<void (void)> sigTest;
    virtual void update() = 0;
}; 
```

VSig.h：

```
class VSig : public IVSig {
public:
    boost::signals2::signal<void (void)> sigTest;
    void update();
}; 
```

VSig.cpp：

```
void VSig::update()
{
    printf("updating!\n");
    sigTest();
} 
```

进程.h：

```
class Process {
public:
    void process();
}; 
```

进程.cpp：

```
void Process::process()
{
    printf("hi!\n");
} 
```

胶水.h：

```
class Glue {
public:
    Glue();
    void callUpdate();

private:
    IVSig *sig;
    Process *proc;
}; 
```

胶水.cpp：

```
Glue::Glue()
{
    sig = new VSig();
    proc = new Process();

    sig->sigTest.connect(boost::bind(&Process::process, proc));

    callUpdate();
}

void Glue::callUpdate()
{
    sig->update();
} 
```

这应该打印“更新！” 接着是“嗨！” 但只输出“更新！”。

非常感谢任何帮助或建议！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-10T12:58:40.480

问题是因为您在 VSig 类中重新声明 sigTest，并且当您使用 sig->sigTest 时，您正在访问 IVSig 类的**sigTest**成员（声明的类型），但是在执行更新时，您正在调用虚拟更新方法，这将使用它的本地 sigTest 变量。不确定我是否足够清楚。

因此，经验法则是：永远不要在继承的类中重新定义具有相同名称的变量。

希望有帮助！

# c# - 重复连接字符串错误

> ID：14258406
> 
> 赞同：1
> 
> 时间：2013-01-10T12:53:24.853
> 
> 标签：c#, asp.net, connection-string, config, xdt-transform

我在服务器中部署了一个网站。有一天，它抛出了一个错误，说该`connection string`名称已添加。我检查了 web.config 文件，它的名称只有一个条目。我从配置中删除了该条目。现在该网站运行良好并从数据库中获取数据。

注意：当我更改配置文件的名称时，它会显示错误。

我认为，问题是——连接字符串部分缓存在内存中。是这样吗？我们如何克服这种不受欢迎的行为？

源代码中的配置文件

发布配置

```
<system.web>
 <compilation xdt:Transform="RemoveAttributes(debug)" />

</system.web> 
```

调试配置

```
<system.web>

</system.web> 
```

参考：

1.  [我发布的 Web 配置中出现不需要的连接字符串的问题](https://stackoverflow.com/questions/13581892/issue-with-unwanted-connection-string-appearing-in-my-published-web-config)
2.  [.NET 2.0 App.Config 连接字符串包含不需要的 SQLExpress 默认值](https://stackoverflow.com/questions/7573453/net-2-0-app-config-connection-strings-includes-unwanted-sqlexpress-default)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-10T12:56:55.190

这不是问题 - 当您更改`web.config`文件时，IIS 进程会重置，因此不会涉及任何缓存。

更有可能的是，父目录或子目录的`web.config`文件包含*相同*的连接字符串名称 - 这会导致错误。

您可以通过多种方式解决该问题：

*   确保在正确范围内只有一个`web.config`具有连接字符串名称
*   使用`remove`元素：

    ```
    <connectionStrings>
     <remove name="theConnectionString" />
     <add name="theConnectionString" ... />
    <connectionStrings> 
    ```

有关相关问题，请参阅[Encrypted config file does not apply “remove” tag in connectionStrings](https://stackoverflow.com/questions/16547034/encrypted-config-file-does-not-apply-remove-tag-in-connectionstrings)

# version-control - cvs：更新无法合并

> ID：14258414
> 
> 赞同：0
> 
> 时间：2013-01-10T12:53:52.513
> 
> 标签：version-control, merge, cvs

我刚刚发现，一个令我惊讶的 cvs 行为。

*   我在本地更改 file1
*   在此期间，人们更改同一文件的其他不相关部分，并提交到存储库
*   我从存储库更新我的本地副本
*   此时，我希望我的本地文件 file1 副本包含其他人对此文件所做的所有更改，除非上面的更新报告了冲突。但是，当我现在使用 head 进行比较时，我发现很多差异来自其他人对我根本没有触及的文件部分所做的更改。

有任何想法吗？这只是cvs合并的能力有限吗？有什么错误的设置吗？我的工作流程中有什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-10T17:37:08.897

CVS 的合并功能非常有限。如果您想要更好的合并体验，请切换到现代系统，例如 Git（`git-cvsimport`如果 repo 维护者不合作，则可能通过）。另请参阅[将 git 与 CVS 结合使用的最佳实践](https://stackoverflow.com/questions/595106/best-practices-for-using-git-with-cvs)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-12-19T03:49:16.893

最终解决方案是：

> **1.手动将本地代码保存到另一个地方**
> 
> **2\. 将可能有冲突的文件恢复到 CVS 服务器上的 HEAD（最新）版本。**
> 
> **3\. 将您的更改添加回 Reverted 文件。**

上述解决方案的概念是通过 REVERT 清除所有可能的问题，并从存储库中获取 100% 干净的版本，然后添加回我们的更改。

它可以解决以下由代码过期/代码库混乱引起的问题。

> 1.  CVS 提交有冲突且未被修改
> 2.  CVS 更新失败
> 3.  CVS 不同步

# sql-server - 将 INT（表示 UNIX 时间戳）转换为 DBTIMESTAMP

> ID：14258417
> 
> 赞同：1
> 
> 时间：2013-01-10T12:53:57.270
> 
> 标签：sql-server, ssis

我想做一个数据流转换。我的源数据库包含一个带有 UNIX 时间戳的 INT 列（我知道这很糟糕，它是一个非常古老的系统，bla bla bla ... ;)）。我想将这个 INT-TIMESTAMP-thingy 转换为我可以用于日期维度的东西，最好是 DBTIMESTAMP。

有没有办法做到这一点？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-10T15:14:01.087

在 SQL 中：

```
select DATEADD(s,unixtimestamp,'1970-01-01') as sqldatetimestamp 
from mytable 
```

在 SSIS 表达式中：

```
DATEADD( "S", [unixtimestamp] , (DT_DATE) "1970-01-01" ) 
```

当然，这是假设您拥有的 unixtimestamp 确实如此，它被定义为自 1970 年 1 月 1 日以来的秒数。

# graph - booggie 中的节点/边缘类型定义，用于使用 yEd 进行可视化？

> ID：14258425
> 
> 赞同：1
> 
> 时间：2013-01-10T12:54:21.193
> 
> 标签：graph, graph-visualization, booggie

在 booggie 2 中，我可以将图形导出为 yEd 的 graphML-Format。但是，我不知道元模型中的节点和边类型定义应该是什么样子，以便我可以控制它们的视觉外观

谁能提供一个例子？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-10T12:59:50.923

这就是带有一些 yEd 属性定义的节点类型定义（必须命名为**YEdNode**）的样子：

```
node class YEdNode{
    height: int = 50;
    width: int = 100;
    x: int = 0;
    y: int = 0;
    color : string = "#FFFFFF";
    shape : Shape = Shape::RECTANGLE;
    label : string = "";
} 
```

边缘类型定义也是如此（必须命名为**YEdEdge**）：

```
edge class YEdEdge{
    color : string = "#000000";
    lineWidth: int = 2;
    label : string ="";
    lineType : string = "line";
} 
```

shape-ENUM 应该如下所示：

```
enum Shape {RECTANGLE, ROUNDRECTANGLE, ELLIPSE, PARALLELOGRAM, HEXAGON, TRIANGLE, RECTANGLE3D, OCTAGON, DIAMOND, TRAPEZOID, TRAPEZOID2} 
```

# asp.net - 从 Web API 获取空的 500 http 状态码

> ID：14258427
> 
> 赞同：5
> 
> 时间：2013-01-10T12:54:23.977
> 
> 标签：asp.net, asp.net-mvc, serialization, asp.net-mvc-4, asp.net-web-api

我的模型中有一个圆形对象图，但这是不可避免的。

根据[本文](http://www.asp.net/web-api/overview/formats-and-model-binding/json-and-xml-serialization#handling_circular_object_references)中给出的建议，我对所有成员都使用了`DataContractAttribute`and 设置。`IsReference = true`我还提供了`DataMemberAttribute`我想要序列化的所有属性。

为了确保序列化程序不再遇到任何问题，我只选择*不*序列化导航属性。

但是，我的 catch 块中仍然遇到异常。异常详情如下：

```
 _innerException: {"Type 
'System.Data.Entity.DynamicProxies.Author_615FB9F8BB22B55A7CA168DA5ED29EC6A0B59F62FD79D1346045351BE2F163A4' with data contract name 
    'Author_615FB9F8BB22B55A7CA168DA5ED29EC6A0B59F62FD79D1346045351BE2F163A4:
http://schemas.datacontract
    .org/2004/07/System.Data.Entity.DynamicProxies' is not expected. 
Consider using a 
    DataContractResolver or add any types not known statically to 
the list of known types - for 
    example, by using the KnownTypeAttribute attribute or by adding them 
to the list of known types 
    passed to DataContractSerializer."} 
```

我可以但不希望：

1) 禁用代理创建。我可以仅仅为了序列化而删除代理创建，我可能会这样做。但我也想了解为什么我仍然会收到异常以及我能做些什么。

2）删除循环引用。原因：这些类型的引用在 Entity Framework 生成的模型中非常常见。如果我要做一个模型中有 800 - 1000 个类的大型项目，那么通过删除循环引用来实现它是一场噩梦。

我在下面描述了这个小尖峰解决方案的架构元素。

**数据库模式**

```
Id  AuthorName
-------------------------------
1   Charles Dickens
2   Charles Petzold
3   Charles Darwin
4   Charles Chaplin
5   Leo Tolstoy
6   Fydor Dostoevsky
7   Ayn Rand
8   Napolean Hill
9   Claude M. Bristol
10  Edward Dwight Easty
11  O. Henry
12  William Shakespeare
13  Juwal Lowy
14  Jeffrey Richter
15  Chris Sells
16  Don Box
17  Steven Pinker
18  Jim Rohn
19  George Eliot
20  Sathyaish Chakravarthy

Id          Title                                              AuthorId
----------- -------------------------------------------------- -----------
1           Nicholas Nickleby                                  1

Id          BookId      Review
----------- ---------------------------------------------------------------
1           1           How do I know? I haven't read it. 
```

**模型**

```
using System.Collections.Generic;
using System.Runtime.Serialization;

namespace BookReviewsModel
{
    [DataContract(IsReference = true)]
    public partial class Author
    {
        [DataMember]
        public virtual int Id { get; set; }

        [DataMember]
        public virtual string AuthorName { get; set; }

        public virtual ICollection<Book> Books { get; set; }
    }
}

namespace BookReviewsModel
{
    [DataContract(IsReference = true)]
    public partial class Book
    {
        [DataMember]
        public virtual int Id { get; set; }

        [DataMember]
        public virtual string Title { get; set; }

        [DataMember]
        public virtual int AuthorId { get; set; }

        public virtual Author Author { get; set; }

        public virtual ICollection<BookReview> BookReviews {  get; set; }
    }
}

namespace BookReviewsModel
{
    [DataContract(IsReference = true)]
    public partial class BookReview
    {
        [DataMember]
        public virtual int Id { get; set; }

        [DataMember]
        public virtual int BookId { get; set; }

        [DataMember]
        [AllowHtml]
        public virtual string Review { get; set; }

        public virtual Book Book { get; set; }
    }
} 
```

**控制器代码**

```
namespace BookReviews.Controllers
{
    public class AuthorController : ApiController
    {
        [HttpGet]
        public IEnumerable<Author> Index()
        {
            try
            {
                using (var context = new BookReviewEntities())
                {
                    var authors = context.Authors.ToList();

                    var str = Serialize(new XmlMediaTypeFormatter(), authors);

                    System.Diagnostics.Debugger.Break();
                    System.Diagnostics.Debug.Print(str);

                    return authors;
                }
            }
            catch (Exception ex)
            {
                var responseMessage = new HttpResponseMessage
                {
                    Content = new StringContent("Couldn't retreive the list of authors."),
                    ReasonPhrase = ex.Message.Replace('\n', ' ')
                };

                throw new HttpResponseException(responseMessage);
            }
        }

        string Serialize<T>(MediaTypeFormatter formatter, T value)
        {
            Stream stream = new MemoryStream();
            var content = new StreamContent(stream);

            formatter.WriteToStreamAsync(typeof(T), value, stream, content, null).Wait();

            stream.Position = 0;
            return content.ReadAsStringAsync().Result;
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-16T20:59:43.333

**解决方案**：

此问题已在 AspNetWebStack Nightly Build 中得到解决。

在我跟进多个问题时，我还没有追踪到哪个签入可以纠正这种行为。

[您可以通过将http://www.myget.org/F/aspnetwebstacknightly/](http://www.myget.org/F/aspnetwebstacknightly/)添加到您的包管理器配置中来更新您的解决方案以使用最新的夜间包，然后从这个附加存储库显式更新。

据我所知，1/18 nightly 在我的解决方案中是稳定的（odata 查询的返回速度也快得多。）

**解决方法**：

如果您不能使用最新的 aspnetwebstack 构建，如果您不需要 XML 格式的提要，则有一个潜在的解决方法。

[http://www.asp.net/web-api/overview/formats-and-model-binding/json-and-xml-serialization](http://www.asp.net/web-api/overview/formats-and-model-binding/json-and-xml-serialization)

本文档展示了如何配置 web-api 控制器使用的格式化程序，它还展示了如何处理循环引用，以及如何重新配置​​/替换默认的 xml 格式化程序。

作为一种解决方法，您可以在 Application_Start 期间删除 xml 格式化程序：

```
var xmlFormatter = config.Formatters.XmlFormatter;
if (xmlFormatter != null)
{
    config.Formatters.Remove(xmlFormatter);
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-10T13:03:25.207

我不太了解 WebAPI，但您使用[ProxyDataContractResolver](http://blogs.msdn.com/b/adonet/archive/2010/01/05/poco-proxies-part-2-serializing-poco-proxies.aspx)解决了 WCF 中的相同问题。希望 WebAPI 中有类似的钩子吗？

# ruby - Ruby 的范围和三等号 (===) 是如何工作的？

> ID：14258441
> 
> 赞同：0
> 
> 时间：2013-01-10T12:55:10.470
> 
> 标签：ruby, boolean

我正在阅读Why's guide，并并排尝试ruby终端中的一些命令。一件事不符合。我正在运行 Ruby 1.9.3。

在书中它说一个有效的命令是：

```
if 1890..1913 === 1895
   echo "works"
end 
```

但是，当我这样做时，它只会给我

```
warning: (irb):27: warning: integer literal in conditional range
=> nil 
```

一些更有趣的实验

```
1895..1913 === 1895
> ArgumentError: bad value for range
from (irb):31
from /usr/bin/irb:12:in `<main>'

x = 1895..1913
x === 1895
> true 
```

这很有趣，因为（来自 python）我会认为最后两次执行是相同的，但似乎并非如此。我想知道是否有人可以更深入地了解为什么所有这些实验都失败了，以及 === 是如何工作的。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-01-10T12:57:37.510

`1895..1913 === 1895`是一样的`1895..(1913 === 1895)`，你想要的是`(1895..1913) === 1895`。

请参阅[Ruby 运算符优先级](https://www.google.com/search?q=ruby%20operator%20precedence)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-10T12:57:45.453

这里的问题似乎是括号。
Ruby 无法正确猜测它应该如何评估该行。

例如以下作品：

```
(1895..1913) === 1895 
```

# database - 数据库规范化；重复字段

> ID：14258445
> 
> 赞同：0
> 
> 时间：2013-01-10T12:55:32.590
> 
> 标签：database, database-normalization

我有一个关于规范化的问题，关于我的场景是什么级别的正常形式。我有几个表具有相同的字段 - 姓名地址 1、地址 2、邮政编码和电话号码；

```
Client [id, instructor id, name, address, postcode, phone, practical, theory]
Staff [id, office id, name, job, address, postcode, phone]
Registration id, name, address, postcode, phone]
Office [id, manager id, address, postcode,    phone] 
```

是否存在任何正常的形式来将它们的字段分成类似这样的东西......

```
Client [id, instructor id, details_id, practical, theory]
Staff [id, office id, details_id, phone]
Registration [id, details_id]
Office [id, manager id, details_id]

Details [id, full_name, address1, address2, postcode, phone_no] 
```

不确定标准化是否会像那样工作，但这只是一个想法......

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-10T15:39:34.380

将具有相同含义的列放在多个表中与规范化无关。它与数据库设计的不同形式原则有关。Chris Date 将其称为[正交设计原则](http://en.wikipedia.org/wiki/Principle_of_Orthogonal_Design)，或 POOD。

据我所知，POOD 背后的形式逻辑还没有像普通形式那样深入研究或被广泛接受。这是观察，不是批评。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2020-03-21T01:40:00.683

我将讨论第 3 范式，因为它是最常被引用为归一化的合理水平，尽管大约有 10 种范式。本质上，第三个 NF 意味着表中没有任何内容，正常形式真正处理关系（表）而不是整个数据库，它依赖于除键之外的任何东西。我通常认为它是删除任何候选键，就好像你有一个候选键和实际键一样，那么属性在功能上依赖于键以外的东西。

就地址问题而言，具有潜在重要的实体（例如包含在另一个实体的表中的地址）意味着该地址变得可传递地依赖于（在您的情况下）客户端。这意味着地址只有在客户端存活时才能存活。

这当然不一定是坏事，如果你没有客户，这取决于你是否想要地址。

如果是这种情况，那么地址本身就失去了它作为实体的地位，并成为一个值对象。假设您有一个 Order 表，并且您想保存它的发送地址，那么将其保存在 Order 表中就可以了。如果您以这种方式考虑地址，一个关键的事情是它变得不可变，它永远不会改变，订单发送到的地址将始终相同，它永远不会改变，因为它已经发生并且是事实。

假设您需要存储客户的地址和工作地址，现在您最终会遇到需要在客户表中添加更多列的情况，这一切都结束了！这导致了出于完整性和整洁性的实际选择，因此您创建一个地址表，它可能是为了保留正常形式或可能只是为了整洁，这取决于您想对新创建的地址实体做什么。

将东西移出表只是为了使表更易于管理通常会导致一对一的关系，并且无论是在客户端表中还是在客户端表中，正常形式很可能是相同的。

出于正确的原因移动东西需要一些练习，但值得精通它。

# android - Phonegap 无法重定向到页面

> ID：14258446
> 
> 赞同：2
> 
> 时间：2013-01-10T12:55:34.867
> 
> 标签：android, jquery, html, cordova, redirect

所以我有这个表单，在提交时我会执行 SQL 查询并将其重定向到另一个页面。但是当我尝试在 android 平板电脑上测试它时，它不会重定向，也不会出错，这意味着 SQL 调用是有效的并且可以工作......有人可以帮我吗

```
 <div class="wrapper">
    <div class="oneSection">
      <form method="post" action="" id="barcodeForm">
        Barcode: <br/>
        <input name="barcode" id="barcode" type="text" class="sub"/><br/>
        <input type="submit" class="open" id="before" value="SUBMIT" onclick="check()" />
      </form>
    </div>
  </div>

  <script type="text/javascript">
    function check() {
      var barcode = $('#barcode').val();
      if(barcode.length <= 0) {
        $('#barcode').css('border', '2px solid red');
        e.preventDefault();
        return;
      } else {
      alert(barcode.length);
        var barcode = $('#barcode').val();
        checkBarcode(false, barcode);
      }
    }

function checkBarcode(doAuto, id) {
  var successCall;
  if (doAuto) {
    successCall = function (tx, result) {
      var item = result.rows.item(0);
      $('[name="client"]').val(item['cname']);
      $('[name="address"]').val(item['address']);
      $('[name="sitename"]').val(item['sname']);
      $('[name="model"]').val(item['model']);
      $('[name="lasttested"]').val(item['ltest']);
      $('[name="nounits"]').val(item['units']);
      $('[name="comments"]').val(item['comments']);
    }
  } else {
    test.innerHTML += 'at the start<br/>';
    successCall = function () {
      var URL = 'test.html?id=' + id;
      window.location.href = URL;
    }
  }

  var queryDB = function queryDB(tx) {
    tx.executeSql(getBarcode, [id], successCall, onError);
  }
  db.transaction(queryDB, onError);
}

  </script> 
```

目前发生的是它提交输入值并重置表单而不转发页面或任何东西......

# google-maps - API V3 - 从适合标记所需的缩放设置缩放 -1

> ID：14258448
> 
> 赞同：0
> 
> 时间：2013-01-10T12:55:35.950
> 
> 标签：google-maps, google-maps-api-3

我希望我的地图最初从由边界确定的缩放中缩小 -1。如果我执行以下操作，它只会放大/缩小，但我想将缩放级别设置为“大一点”。

```
map.fitBounds(bounds); 
```

由于众所周知的原因，之后我不能使用 map.setZoom 。

有一些简单的方法可以做到这一点吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-10T14:18:04.030

最好的办法是为地图`idle`事件创建一个事件监听器。一旦`fitbounds`完成它的事情，就会触发空闲事件。

如果您需要在每次适合边界时都这样做，那么创建一个自定义 fitbounds 方法

```
var fitBounds = function(map, bounds) {
   google.maps.event.addListenerOnce(map, 'idle', function() {
       this.setZoom(this.getZoom() - 1);
   });
   map.fitBounds(bounds);
} 
```

请注意，我们使用的是`addListenerOnce`方法而不是普通的`addListener`。

但是，这种方法的问题是，在地图缩小之前，您仍然会看到为一瞬间设置的初始边界。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-10T13:53:07.467

您可以在以下位置使用事件侦听器`zoom_changed`：

```
google.maps.event.addListenerOnce(map, 'zoom_changed', function() {
    var zoomLevel = map.getZoom();

    map.setZoom(zoomLevel-1);
}); 
```

# android - 启动时如何选择第二个标签栏

> ID：14258451
> 
> 赞同：0
> 
> 时间：2013-01-10T12:55:38.843
> 
> 标签：android

单击时如何转到第二个标签栏？总是选择第一个标签栏我想在屏幕显示标签栏时选择第二个标签栏我的屏幕选择第一个标签栏

[![图片](../Images/68f8424cb2378c56b9c88b1f53e31bb3.png)](https://i.stack.imgur.com/0ek03.png)

我想在这样开始时选择第二个标签栏

[![图2](../Images/2a7d5716a45642394a20821182f82dd1.png)](https://i.stack.imgur.com/VjoK9.png)

我的代码在下面

```
public class TabBarActivity extends TabActivity {
/** Called when the activity is first created. */

    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.main2);
        setTabs() ;
    }

    private void setTabs()
    {
        addTab("payments", R.drawable.tab_home, AgAppPaymentScreen.class);
        addTab("My Account", R.drawable.tab_home, AgAppMyAccountScreen.class);

        addTab("Spend Analyzer", R.drawable.tab_home, AgAppPaymentScreen.class);
        addTab("Notification", R.drawable.tab_home, AgAppPaymentScreen.class);
        addTab("Help", R.drawable.tab_home, AgAppPaymentScreen.class);
    }

    private void addTab(String labelId, int drawableId, Class<?> c)
    {
        TabHost tabHost = getTabHost();
        Intent intent = new Intent(this, c);
        TabHost.TabSpec spec = tabHost.newTabSpec("tab" + labelId); 

        View tabIndicator = LayoutInflater.from(this).inflate(
            R.layout.tab_indicator, getTabWidget(), false);
        TextView title = (TextView) tabIndicator.findViewById(R.id.title);
        title.setText(labelId);
        ImageView icon = (ImageView) tabIndicator.findViewById(R.id.icon);
        icon.setImageResource(drawableId);

        spec.setIndicator(tabIndicator);
        spec.setContent(intent);
        tabHost.addTab(spec);
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-10T12:59:41.320

```
tabHost.setCurrentTab(1); 
```

0：第一个选项卡。1：第二个标签。

# vim - 如何使用 vim 脚本将内容插入可视块的开头和结尾

> ID：14258452
> 
> 赞同：0
> 
> 时间：2013-01-10T12:55:41.610
> 
> 标签：vim

我是 vim 脚本的新手。是否可以使用**vim 脚本**执行以下操作？

我有一个可视的文本块。通过按功能键（比如 F5），我需要在可视块的开头和结尾插入一些文本。

即以下文本在视觉块中：

**Lorem ipusm doret lorem ipsum。Lorem ipusm doret lorem ipsum。Lorem ipusm doret lorem ipsum。Lorem Lorem ipusm doret lorem ipsum。**

**Lorem ipusm doret lorem ipsum。Lorem ipusm doret lorem ipsum。Lorem ipusm doret lorem ipsum。Ipusm doret lorem ipsum。**

按 F5 键时，文本应更改为：

**"[[Lorem ipusm doret lorem ipsum。Lorem ipusm doret lorem ipsum。Lorem ipusm doret lorem ipsum。Lorem Lorem ipusm doret lorem ipsum。**

**Lorem ipusm doret lorem ipsum。Lorem ipusm doret lorem ipsum。Lorem ipusm doret lorem ipsum。Ipusm doret lorem ipsum.]]"**

文本**“[[** and **]]”**需要放在可视块的开头和结尾。谁能给我一个解决方案。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-11T03:32:27.107

您将如何手动执行此操作？用于``<`转到视觉选择的开头，`i"[[`插入文本，`Esc`返回正常模式，在另一端重复。

在映射中：

```
:vnoremap <F5> <Esc>g`<i"[[<Esc>g`>a]]"<Esc> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-11T19:59:21.127

查看[环绕插件](http://www.vim.org/scripts/script.php?script_id=1697)。它使您能够获取视觉选择或由动作定义的区域（例如，单词、一对括号内的文本等），并快速方便地用一对字符将其包围。

# c# - 如何运行 TestClass 的所有单元测试及其内部 TestClass 测试？

> ID：14258453
> 
> 赞同：3
> 
> 时间：2013-01-10T12:55:51.853
> 
> 标签：c#, .net, unit-testing

我有内部类来单元测试实例方法，如下所示。

我的问题是当我去`FooClassTests`使用 VS 在上下文中运行所有测试时，它会跳过内部类测试。

如果您使用这种结构，您知道如何将所有测试与内部类中的测试一起运行吗？

```
[TestClass]
public class FooClassTests
{

    [TestMethod]
    public void CanGuardConstructorParameters()
    {
        // Asserts here
    }

    [TestClass]
    public class DoWorkTests //Tests method DoWork
    {
        [TestMethod]
        public void CanDoTheWork()
        {
            // Asserts here
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-10T13:00:40.030

通过 Visual Studio Runner 我不知道，但这在 NCrunch 中受支持。这就是我构建所有测试的方式。

见[http://www.ncrunch.net/](http://www.ncrunch.net/)

这家伙似乎在 MS 测试中也很好地使用了它：

[http://zendeveloper.blogspot.ie/2012/01/structuring-unit-tests.html](http://zendeveloper.blogspot.ie/2012/01/structuring-unit-tests.html)

而且我几乎可以肯定这些类型的测试可以在 resharper 的测试运行器中运行。

# compass-sass - 是否可以根据 (SVG) 图像的可用性在 Sass/Compass (with Middleman) 中创建条件循环？

> ID：14258454
> 
> 赞同：2
> 
> 时间：2013-01-10T12:55:53.363
> 
> 标签：compass-sass, sass, middleman

是否可以根据 (SVG) 图像的可用性在 Sass/Compass (with Middleman) 中创建条件循环？

我有多达 150 张图片 (svg)，每张都将用作导航链接的背景。但是，图像的数量是不连续的，这意味着一些中断。例如，有 1.svg、2.svg、4.svg（缺少 3.svg）。这贯穿始终。

现在我可以创建一个只涵盖所有可能性的循环：

```
@for $i from 1 through 150 {
    .icon_#{$i} {
        background-image: inline-image("svg/#{$i}.svg");
    }
} 
```

如果我在生成多余的 CSS 代码（不存在的图像的规则）时进行正常编译，那么它就可以完成工作。

但是，Middleman 使用此“覆盖所有”循环会引发错误，并且如果图像丢失（足够公平），则不会编译 CSS。这让我开始思考……</p>

由于 Compass 有图像助手，我是否可以添加其他逻辑，仅在图像存在时才生成样式？我的第一个想法是使用 Compass image-width() 助手（例如，如果 width == 0 不继续）但是，这不适用于 SVG。

谁能想到这样做的方法？或者这根本不可信？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-07-14T06:18:43.783

您可以在循环之前的顶部添加一个 sass 变量并声明所有图像编号。IE：

```
$svgs: 1, 2, 4, 15, ... 150 
```

那么你的循环将是：

```
@for $i in $svgs {
    .icon_#{$i} {
        background-image: inline-image("svg/#{$i}.svg");
    }
} 
```

这不是最好的解决方案，因为我确定您并不想输入多达 150 个数字。另外，它不是很可维护。但这是一种选择。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-07-14T08:55:44.150

只要对 Ruby 有一点了解，您就可以调整这个现有的解决方案来做您想做的事情：

[https://stackoverflow.com/a/10456412/901944](https://stackoverflow.com/a/10456412/901944)

# actionscript-3 - 如何通过 Web 界面创建 Flash 影片剪辑？

> ID：14258455
> 
> 赞同：0
> 
> 时间：2013-01-10T12:55:58.827
> 
> 标签：actionscript-3, flash

如果这不是问这样一个问题的正确地方，请原谅我。

基本上，我正在寻找一种方法，让人们可以轻松地（至少，比深入了解 Flash 更容易）创建一个基本的 Flash 动画（movieclip），其中包含一些放置的图像资源和文本，所有这些都通过 Web 界面进行。

我正在考虑使用 jQuery 来允许拖放资产，您将“记录”其中的坐标并将其以某种方式传递给 Flash 以创建 SWF 文件。

还是在 Flash 中创建一个工具（肯定会使操作更容易）然后有某种“保存”按钮来渲染 SWF 会更好吗？

我完全愿意接受建议。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-10T14:25:51.407

如果您真的需要生成一个独立的 SWF 文件（而不仅仅是您自己的“播放器”的配置文件），我可能会这样做；

1) 在您喜欢的任何系统（flash、jquery 等）中创建您的编辑器。

2）在客户端构建一个配置文件。这与用户添加的所有资源一起用于播放动画。

3) 将上述资产和配置文件上传到您的网络服务器。

4) 使用 flex 编译器（在服务器上）生成生成的 SWF，将您的播放器与生成的 AS3 结合起来，根据需要嵌入上传的资源，使其可供播放器使用。

5) 给用户一个新生成的 SWF 文件的下载链接。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-10T13:46:08.420

我认为没有可用于 Flash (actionescript) 的任何 swf 编译器。您可以创建一个允许用户创建动画的 swf，将其保存为自制矢量格式，然后重播。但我不相信你可以创建和独立的 swf 文件，其中只有创建的动画。

试想一下 Flash 中的播放器，以及播放器将读取的格式（xml、json、命名...）。您可以使用 jQuery 或 Flash 生成输入，然后将其输入播放器以显示它。您最终将需要两个文件。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-10T13:58:57.420

显然[，这个库](https://github.com/claus/as3swf)允许您在运行时编译 SWF。我自己（还）没有使用过它，也不知道它有多稳定或灵活，但它似乎是你正在寻找的。我建议试一试，看看是否足够。

我不确定它是如何保存文件的，所以你可能会遇到安全问题，因为它是一个 Web 应用程序。希望它应该没问题。

# javascript - XMLHttpRequest Access-Control-Allow-Origin 图像前几次失败

> ID：14258460
> 
> 赞同：2
> 
> 时间：2013-01-10T12:56:16.173
> 
> 标签：javascript, http-headers, cross-domain

我使用此代码大约 20 次从我的外部服务器加载图像：

```
var xhr = new XMLHttpRequest();
xhr.open('GET', uri, true); //uri is the image link
xhr.responseType = 'blob';
xhr.onload = function(event){ 
```

在存储这些图像的目录中，我放置了一个包含以下内容的 htaccess 文件：

```
Header set Access-Control-Allow-Origin "*" 
```

除了要检索的前 4 张图像外，此代码工作正常。我收到以下错误：

```
Origin http://localhost is not allowed by Access-Control-Allow-Origin. 
```

这怎么可能？图像之间没有真正的区别，代码没有改变？:\

这是我在 Chrome 中看到的失败图像：

```
Request URL:http://www.ardennenbed.nl/sitemanager/fotos/1329589074.jpg
Request Headers
Origin:http://localhost
Referer:http://localhost/app/www/
User-Agent:Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.11 (KHTML, like Gecko) Chrome/23.0.1271.97 Safari/537.11 
```

这是我在 Chrome 中看到的工作图像：

```
Request URL:http://www.ardennenbed.nl/sitemanager/fotos/1280247085.gif
Request Method:GET
Status Code:200 OK (from cache)

Request Headers
Accept:*/*
Accept-Charset:ISO-8859-1,utf-8;q=0.7,*;q=0.3
Accept-Encoding:gzip,deflate,sdch
Accept-Language:nl-NL,nl;q=0.8,en-US;q=0.6,en;q=0.4
Connection:keep-alive
DNT:1
Host:www.ardennenbed.nl
Origin:http://localhost
Referer:http://localhost/app/www/
User-Agent:Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.11 (KHTML, like Gecko) Chrome/23.0.1271.97 Safari/537.11

Response Headers
Accept-Ranges:bytes
Access-Control-Allow-Origin:*
Connection:close
Content-Length:8486
Content-Type:image/gif
Date:Thu, 10 Jan 2013 12:19:20 GMT
ETag:"8192d2-2126-eb0e53c0"
Last-Modified:Wed, 09 Jan 2013 18:06:15 GMT
Server:Apache/2.2.3 (CentOS) 
```

请帮我！

# android - Android 中的网络过滤器，“安全浏览”功能

> ID：14258464
> 
> 赞同：0
> 
> 时间：2013-01-10T12:56:30.110
> 
> 标签：android, security, filter

我正在寻找一种在打开网站 URL 之前获取它的方法，并在 URL 被列入黑名单时阻止浏览器打开它。最接近的模拟是 Lookout Mobile Security 的安全浏览功能。但是它只适用于默认浏览器，但即使这样也很棒。

据我所知，不可能对所有类型的浏览器都这样做，因为我们需要有根手机并修改 iptables。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-19T14:50:58.080

好的，它看起来像一个 hack，但是它可以工作，这是大多数 web 过滤器和反病毒在 android 中工作的方式。
您必须创建一个监控浏览器历史记录的 contentObserver。当页面快要加载时，打开的链接会出现在列表中。何时做出反应取决于您。

# php - 使用 php5.2 api 检索亚马逊 MWS 响应

> ID：14258470
> 
> 赞同：0
> 
> 时间：2013-01-10T12:56:38.417
> 
> 标签：php, amazon-web-services, php-5.2, amazon-mws

我很难从亚马逊获得一个简单的 xml 答案，它总是向我报告：

```
Sender
    InvalidParameterValue
    Either Action or Operation query parameter must be present. 
```

如果我问他们的支持，他们无法帮助我，他们没有看到缺少的参数......他们的建议是遵循他们的示例，但我的 Webhost 只支持 php 5.2，所以自动加载器不起作用。

```
<?php
#header("Content-Type:text/xml");
$sellerID = 'SELLEDERID';
$aws = 'AWSKEY';
$secret = 'SECRET';

$action = 'GetReportList';

$timestamp = gmdate("Y-m-d\TH:i:s\Z");
$signature = $action . $timestamp;
$sig = base64_encode(hash_hmac("sha256", $signature, $secret, true));
$service = 'https://mws.amazonservices.com/?';

$url  = 'AWSAccessKeyId='.$aws;
$url .= '&Action='.$action;
$url .= '&Merchant='.$sellerid;
$url .= '&SignatureVersion=2';
$url .= '&Timestamp=2013-01-10T12:22:48Z';
$url .= '&Version=2009-01-01';
$url .= '&Signature='.$sig;
$url .= '&SignatureMethod=HmacSHA256';
$awsURL = $service.urlencode($url);

$curl = curl_init();
curl_setopt_array($curl, array(
    CURLOPT_RETURNTRANSFER => 1,
    CURLOPT_URL => $awsURL,
    CURLOPT_USERAGENT => 'Request'
));
$resp = curl_exec($curl);
curl_close($curl);
echo "<pre>";
var_dump($resp);
var_dump($awsURL);
echo "</pre>";
?> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-25T01:32:07.997

“我们在您的请求中没有看到错误”可能是指您放入 Scratchpad 的请求，而不是您通过 php 发出的请求，因为您的签名计算很差。

有关如何计算 sig 的信息，请参阅[此 StackOverflow 问题](https://stackoverflow.com/questions/11694376/converting-amazon-mws-scratchpad-queries-to-api-calls)或[MWS 开发人员指南](https://images-na.ssl-images-amazon.com/images/G/01/mwsportal/doc/en_US/bde/MWSDeveloperGuide._V386854335_.pdf)（第 12 页，“如果您创建自己的客户端库”）。

实际的错误消息似乎很奇怪。我希望一旦你的签名正确，它就会改变。另请注意，相当多的 MWS API 调用需要 HTTP POST，因此如果您打算在其他地方重用该代码，您最好相应地更改您的代码。

# magento - 如何按标题获取可下载产品链接收藏顺序

> ID：14258471
> 
> 赞同：0
> 
> 时间：2013-01-10T12:56:39.043
> 
> 标签：magento, magento-1.7

从过去的两个小时开始，我一直在努力按标题获取所有可下载的产品链接，但无法实现，因为它按集合给出了错误的顺序。

谁能帮助我：D

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-10T20:19:37.497

您可以通过以下方式获取所有可下载的集合

```
$products = Mage::getModel('downloadable/link')->getCollection(); 
```

但是当您尝试使用在此集合中添加标题时

```
$products->->addTitleToResult(); 
```

那么这将自动添加两个排序顺序，一个按 sort_order ASC，第二个按标题 ASC。这样您就永远不会得到实际的排序结果，因为 sort_order 总是排在第一位。有关更多详细信息，请参阅

`Mage_Downloadable_Model_Resource_Link_Collection::addTitleToResult()`

所以你需要在你的本地池中覆盖上面的类并且需要删除

`->order('main_table.sort_order ASC'`从`addTitleToResult()`

或为其创建一个自定义类。

# linux - 从伪 tty 中分离一个 linux 进程，但保持 tty 运行？

> ID：14258478
> 
> 赞同：1
> 
> 时间：2013-01-10T12:57:15.007
> 
> 标签：linux, debugging, terminal, gdb

我想调试一个带有 2 个 xterm 窗口的控制台 linux 应用程序：一个窗口用于 gdb，另一个用于应用程序（例如 mc）。

我现在要做的是在第二个 xterm 窗口中运行 'tty && sleep 1024d'（这给了我它的伪 tty 名称），然后在 gdb 中运行 'tty' 以将程序重定向到另一个 xterm 窗口。然而，GDB 警告它不能设置控制终端并且某些次要功能不起作用（例如处理窗口大小调整），因为'sleep 1024d' 仍在该xterm 窗口上运行。

有什么更好的方法（而不是从 shell 启动进程并从 gdb 附加到它）？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-11T16:17:53.010

我对相关错误中给出的程序进行了一些修改，以将文件名存储在某处 [http://sourceware.org/bugzilla/show_bug.cgi?id=11403](http://sourceware.org/bugzilla/show_bug.cgi?id=11403)

这是一个使用它的例子：

$ xterm -e './disowntty ~/tty.tmp' & sleep 1 && gdb --tty $(cat ~/tty.tmp) /usr/bin/links

```
/* tty;exec disowntty  */
#include <sys/ioctl.h>
#include <unistd.h>
#include <stdio.h>
#include <limits.h>
#include <stdlib.h>
#include <signal.h>
static void
end (const char *msg)
{
  perror (msg);
  for (;;)
    pause ();
}
int
main (int argc, const char *argv[])
{
  FILE *tty_name_file;
  const char *tty_filename;

  if (argc <= 1)
    return 1;
  else
    tty_filename = argv[1];

  void (*orig) (int signo);
  setbuf (stdout, NULL);
  orig = signal (SIGHUP, SIG_IGN);
  if (orig != SIG_DFL)
    end ("signal (SIGHUP)");
  /* Verify we are the sole owner of the tty.  */
  if (ioctl (STDIN_FILENO, TIOCSCTTY, 0) != 0)
    end ("TIOCSCTTY");
  printf("%s %s\n", tty_filename, ttyname(STDIN_FILENO));
  tty_name_file = fopen(tty_filename, "w");
  fprintf(tty_name_file, "%s\n", ttyname(STDIN_FILENO));
  fclose(tty_name_file);

  /* Disown the tty.  */
  if (ioctl (STDIN_FILENO, TIOCNOTTY) != 0)
    end ("TIOCNOTTY");
  end ("OK, disowned");

  return 1;
} 
```

# mysql - Mysql 程序 givnng 错误未知列 Age

> ID：14258480
> 
> 赞同：0
> 
> 时间：2013-01-10T12:57:17.620
> 
> 标签：mysql, stored-procedures

这是我的 Mysql 查询

```
 DELIMITER $$

USE `divineproposal_db`$$

DROP PROCEDURE IF EXISTS `pr_Search_Profile`$$

CREATE DEFINER=`root`@`%` PROCEDURE `pr_Search_Profile`(IN vGender CHAR(1),IN vMinAge INT,IN vMaxAge INT,IN vReligion INT)
BEGIN
        SELECT DATE_FORMAT(FROM_DAYS(DATEDIFF(NOW(), cpl_DateofBirth)), "%Y")+0 AS Age FROM tbl_candidateprofile
            WHERE  Age>= vMinAge AND Age<=vMaxAge;
    END$$

DELIMITER ; 
```

**错误 ：：**

```
Unknown column 'Age' in 'where clause' 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-10T12:59:57.003

您不能在`WHERE`子句中使用别名，因此您必须使用子查询或重用以下定义`age`：

```
select Age
from
(
  SELECT DATE_FORMAT(FROM_DAYS(DATEDIFF(NOW(), cpl_DateofBirth)), "%Y")+0 AS Age 
  FROM tbl_candidateprofile
) src
WHERE  Age>= vMinAge 
   AND Age<=vMaxAge; 
```

或者：

```
SELECT DATE_FORMAT(FROM_DAYS(DATEDIFF(NOW(), cpl_DateofBirth)), "%Y")+0 AS Age 
FROM tbl_candidateprofile
WHERE DATE_FORMAT(FROM_DAYS(DATEDIFF(NOW(), cpl_DateofBirth)), "%Y")+0>= vMinAge 
  AND DATE_FORMAT(FROM_DAYS(DATEDIFF(NOW(), cpl_DateofBirth)), "%Y")+0<=vMaxAge 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-10T13:00:07.363

尝试像这样使用-

```
SELECT * FROM tbl_candidateprofile
            WHERE  DATE_FORMAT(FROM_DAYS(DATEDIFF(NOW(), cpl_DateofBirth)), "%Y")+0>= vMinAge AND DATE_FORMAT(FROM_DAYS(DATEDIFF(NOW(), cpl_DateofBirth)), "%Y")+0<=vMaxAge; 
```

Mysql中不允许您使用的内容

# javascript - 订购后将 HTML 表格保存到数据库

> ID：14258482
> 
> 赞同：1
> 
> 时间：2013-01-10T12:57:20.997
> 
> 标签：javascript, jquery, html

`jQuery`在使用UI订购 HTML 表后，我需要将其保存到数据库中`Drag'n'Drop`。

在我的数据库表中，我有**`ID`**和**`Name fields`**。

对我来说重要的是名称以有序的方式出现，而不是`ID`保持不变。

任何人都可以帮助我吗？

**编辑 ：**

让我展示一下代码：

```
<table>
<% @Clients.each do |c| %>
    <tr>
        <td>c.id</td>
        <td>c.name</td>
    </tr>
 <% end %>
 </table> 
```

我正在使用 jQuery 拖放来重新排序此表

点击“保存”按钮后，我想按原样保存表格。

例如

1 - 玛丽
2 - 约翰
3 - 克里斯

重新排序并保存后，我希望下次重新加载此表时 1 如下所示：

2 - 约翰
1 - 玛丽
3 - 克里斯

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2013-01-10T13:36:41.470

您不需要将数据按顺序存储在数据库中，您始终可以使用“order by”子句并按升序或降序获取结果以将它们显示在所需的页面中。

# javascript - GWT 中的深度克隆

> ID：14258486
> 
> 赞同：6
> 
> 时间：2013-01-10T12:57:34.850
> 
> 标签：javascript, gwt, clone

在浏览此链接 [时如何在 javascript 中进行深度克隆](https://stackoverflow.com/questions/4459928/how-to-deep-clone-in-javascript)

我遇到了一个通用的克隆方法（在接受的答案中）。我试过直接在 javascript 中运行它，它运行时给出了完美的输出。

我将该代码放在本机标记中，并试图在 GWT 中克隆一个对象。

我试图克隆的班级是

```
 private class Container
    {
        Integer i = 5;
    } 
```

当我尝试这样做时，它只是返回给我相同的对象。有人可以帮忙吗？有什么不清楚的可以问我。万分感谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-08-11T14:12:25.440

乔纳森是对的：方法（也是 GWT 中唯一的一种）是使用[https://code.google.com/p/google-web-toolkit/wiki/AutoBean](https://code.google.com/p/google-web-toolkit/wiki/AutoBean)

这可能看起来很尴尬，但它工作得很好，因为许多概念都与此相关（RequestFactory 中的 EntityProxy 也依赖于该机制，它是 GWT 的未来）。

深度 json 持久性也适用于自动 bean。

您唯一需要做的就是创建一个描述您的类的接口（并在您的类中实现它）：

```
public interface ContainerBean {
  Integer getI();
  void setI(Integer i);
} 
```

然后创建你的工厂界面

```
interface MyFactory extends AutoBeanFactory {
  // Factory method for a simple AutoBean
  AutoBean<ContainerBean> container();

  // Factory method for a non-simple type or to wrap an existing instance
  AutoBean<ContainerBean> container(ContainerBean toWrap);
} 
```

现在你可以包装你的对象并克隆它（通过json）

> clone() 可以克隆 AutoBean 和存储在其中的属性值。clone() 方法有一个布尔参数，将触发深拷贝或浅拷贝。与 AutoBean 关联的任何标记值都不会被克隆。包装委托对象的 AutoBeans 不能被克隆。

[https://code.google.com/p/google-web-toolkit/wiki/AutoBean#clone()](https://code.google.com/p/google-web-toolkit/wiki/AutoBean#clone())

因此请改用此方法： [https ://code.google.com/p/google-web-toolkit/wiki/AutoBean#AutoBeanCodex](https://code.google.com/p/google-web-toolkit/wiki/AutoBean#AutoBeanCodex)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-11T20:46:02.110

您可能实现此目的的一种方法是使用[AutoBeans](http://code.google.com/p/google-web-toolkit/wiki/AutoBean)。

我认为这种方法的唯一技巧是您必须使用 an`AutoBeanFactory`来创建所有类。

然后，您可以将您的 autobean 编码为`Splittable`，然后使用结果解码为新的 autobean 实例。

# winforms - “BindingSource 不能是它自己的数据源” - 尝试从另一个类中的方法重置绑定源时出错

> ID：14258488
> 
> 赞同：7
> 
> 时间：2013-01-10T12:57:43.660
> 
> 标签：winforms, datagridview, thread-safety, backgroundworker, bindingsource

我们正在绑定一个`DataGridview`using `BindingSource`。所以在主线程中我们给出了这样的。

```
 class1BindingSource = new BindingSource();
            class1BindingSource.DataSource = class1List;  
            this.dataGridView1.DataSource = class1BindingSource; 
```

之后，我在表单中放置了一个后台工作人员，并在单击按钮时触发。

即在按钮中单击

```
this.backgroundWorker1.RunWorkerAsync() 
```

在`BackgroundWorker` `DoWork Event`我试图`BindingSource`通过尝试更新`DataGridview`.

所以`BindingSource`重置是在另一个类的方法中完成的。

*`DoWork Event`*

```
Class2 cl2 = new Class2();
cl2.UpdateBindingSource(class1BindingSource); 
```

*`UpdateBindingSource Method`*

```
public void UpdateBindingSource(BindingSource bs)
        {
            Class1 c1 = bs.Current as Class1;    
            for (int i = 0; i < 1000; i++)
            {
                lock (bs.SyncRoot)
                {
                    c1.MyProperty1 = i;
                    bs.ResetItem(0);
                }
            }
        } 
```

现在我遇到了一个异常，比如*`BindingSource`不能是它自己的数据源。不要将`DataSource`和`DataMember`属性设置为引用回 的值`BindingSource`。*

如果我在我的中这样做，`DoWork Event`那么我可以使用在控制线程本身中重置项目`BeginInvoke method`。

但实际上我正在尝试模拟我们的应用场景。所以我想以这种格式解决这个问题。

谁可以帮我这个事。

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2013-01-11T08:45:51.157

问题是您无法`BindingSource`在 gui 线程以外的线程中更新 a 。这是因为，`BindingSource`将触发一些事件，然后您的数据网格视图将接收这些事件，然后开始自我更新，这将失败，因为它不会在 gui 线程上完成。

所以在你打电话之前`RunWorkerAsync()`你应该打电话`class1BindingSource.SuspendBinding()`，在你的内部`RunWorkerCompleted`你应该打电话`class1BindingSource.ResumeBinding()`。

还要确保在您的内部您`DoWork`不会调用绑定源上的任何方法（就像您对 所做的那样`bs.ResetItem(0)`）。

并删除此锁定语句。它根本没有任何意义（在你的例子中），如果你真的需要它（在你的真实代码中）考虑`private object _Gate = new Object();`在你的类中使用一些来避免来自外部世界的任何死锁，原因`bs.SyncRoot`是公开的。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2015-10-01T15:01:26.183

我遇到了同样的问题： - BindingSource 的元素带有 INotifyPropertyChanged - 更新元素的单独任务。

建议的解决方案 SuspendBinding 等不起作用。BindingSource 应该完成类似 IsInvokeRequired 的操作。

幸运的是，Ivan Stoev 提出了将 BindingSource 子类化并执行与 IsInvokeRequired 类似的事情的绝妙想法。谢谢伊万！

链接：[从不同的任务更新 BindingSource](https://stackoverflow.com/questions/32885552/update-elements-in-bindingsource-via-separate-task?noredirect=1#comment53602168_32885552)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-09-06T09:31:46.827

`UpdateBindingSource()`不需要太多时间，所以不需要使用`backgroundworker`. `UpdateBindingSource()`您可以在主线程中调用。此外，将 datagridview 操作保留在主线程中。

# google-analytics - 针对特定变化手动推送 Google Analytics 目标

> ID：14258490
> 
> 赞同：1
> 
> 时间：2013-01-10T12:57:45.123
> 
> 标签：google-analytics, google-experiments

我有一个关于 Google Analytics（分析）内容实验的问题。

我的目标类型目前是 URL Destination。我们在电话匹配后手动将转化推送到 Analytics，通常需要 1 天时间。

我们使用此代码来推动转化。

```
 var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'XX-XXXXXXXX-X']);
    _gaq.push(['_setAllowAnchor', true]); 
    _gaq.push(['_trackPageview','/call/conv ']); 
```

我想知道的是如何为特定变体手动推送转换。

提前感谢您的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-10T15:21:58.900

在 GA 内容实验中，每个变体都有自己的 url，因此您只需使用合适的 url 作为 _trackPageview 的第二个参数：

```
_gaq.push(['_trackPageview','/call/VARIATION']); 
```

问候，

英克

# git - 使用 git commit -a -m 时不想使用双引号

> ID：14258491
> 
> 赞同：3
> 
> 时间：2013-01-10T12:57:50.873
> 
> 标签：git, bash, shell

当我使用 git commit 时，我有点厌倦了使用双引号

```
git commit -a -m "fix xxx error" 
```

当我这样设置别名时：

```
coam = "!f() { git commit -a -m $1; }; f" 
```

当我打字时它工作

```
git coam fix 
```

它提交为

```
git commit -a -m "fix" 
```

但是如何设置一个可以处理的命令

```
git commit -a -m "fix xxx error" 
```

当我只是输入

```
git coam fix xxx error 
```

我测试

```
coam = "!f() { git commit -a -m $*; }; f" 
```

但它不起作用！

谢谢！

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-01-10T13:04:10.887

“我有点厌倦使用双引号，” <-- 但你别无选择。

这就是 shell 的工作方式：它有机制来实现，如果一个参数包含通常是输入字段分隔符的字符（提示：这就是`IFS`环境变量被命名的原因），它仍然被当作一个参数通过将要执行的命令。

并且`git commit`'s`-m`选项采用单个参数。这些双引号是必要的。

您可以扭转这种局面的唯一方法是拥有自己的小 shell 脚本，它将为您收集这些参数：

```
#!/bin/bash
exec git commit -a -m "$*" 
```

如果上面的脚本被调用`mygitcm`并且在你的路径中，你可以这样做：

```
mygitcm my commit message here 
```

引用您的示例，我想这会起作用：

```
coam = "!f() { git commit -a -m \"$*\"; }; f" 
```

（当然，另一个好主意是制作解释性的提交消息；））

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2021-01-26T01:14:57.523

```
function gc { git commit -a -m "$*"; } 
```

# php - mysql搜索查询代码问题

> ID：14258493
> 
> 赞同：0
> 
> 时间：2013-01-10T12:58:07.543
> 
> 标签：php, mysql, sql

这是我执行搜索的代码

```
SELECT d.deal_id,
       d.deal_title,
       d.friendly_url
FROM wp_deals AS d
WHERE MATCH (d.deal_title) AGAINST ('Ultimate Revitalisation Kit' IN BOOLEAN MODE)
GROUP BY d.deal_id 
```

它工作正常。

但是当我搜索 Kit 时，它变成了

```
SELECT d.deal_id,
       d.deal_title,
       d.friendly_url
FROM wp_deals AS d
WHERE MATCH (d.deal_title) AGAINST ('Kit' IN BOOLEAN MODE)
GROUP BY d.deal_id 
```

并且没有给出任何结果，尽管之前的搜索结果中有 kit。我不是这类搜索查询的专家。但我不得不问，搜索查询不应该使用like 关键字，即like '%kit%'。所以这就是我使用对抗和匹配的原因。有人精通这种高级查询吗？你能让它成为一个出色的搜索查询吗？请完善。所以它看起来比简单的查询更好。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-10T13:23:47.153

您需要更改 mySQL 安装的 /etc/my.conf。默认情况下，全文搜索仅使用 4 个字符作为最小字长。您需要将其更改为 3。

```
ft_min_word_len = 3 
```

您还需要重建表上的全文索引。您可以通过运行 REPAIR 命令来执行此操作：

```
REPAIR TABLE my_table QUICK; 
```

或者您可以删除并重新创建索引。

这样做并重新启动mysql。您的搜索现在可以工作了。

# python - Python：-u 选项的意义？

> ID：14258500
> 
> 赞同：50
> 
> 时间：2013-01-10T12:58:32.317
> 
> 标签：python

我在一些 python 代码中注意到 -u 用于启动 python 解释器。我查看了 python 的手册页，但我无法从中得到太多。请给我一些例子。

* * *

## 回答 #1

> 赞同：61
> 
> 时间：2013-01-10T12:59:12.067

来自`python --help`：

> ```
> -u     : unbuffered binary stdout and stderr; also PYTHONUNBUFFERED=x
>          see man page for details on internal buffering relating to '-u' 
> ```

手册页指出：

> ```
> -u     Force  stdin,  stdout and stderr to be totally unbuffered.  On systems where it matters, also put stdin,
>        stdout and stderr in binary mode.  Note that there is internal buffering  in  xreadlines(),  readlines()
>        and  file-object  iterators  ("for  line in sys.stdin") which is not influenced by this option.  To work
>        around this, you will want to use "sys.stdin.readline()" inside a "while 1:" loop. 
> ```

Python 以缓冲模式打开 stdin、-out 和 -error 流；它将读取或写入更大的块，将数据保存在内存中，直到达到阈值。`-u`禁用这些缓冲区。

此外，python 可以解释打开文件上的换行符，并将它们与本机平台换行符（文本模式）相互转换。该`-u`选项禁用此转换，允许您处理二进制数据而不必担心`\r\n`组合可能会发生什么。相当于使用函数打开文件时使用`rb`or模式。`wb``open()`

* * *

## 回答 #2

> 赞同：21
> 
> 时间：2013-01-10T13:02:26.197

Python 针对读取和打印大量数据进行了优化。其中一项优化是[*缓冲*](http://en.wikipedia.org/wiki/Data_buffer)Python 解释器的标准输入和输出。这意味着每当程序尝试使用其中一个流时，解释器会将使用阻塞成大块，然后一次性发送所有块。这比单独发送每个单独的读/写要快，但显然具有数据可能在中间“阻塞”的缺点。

-u 标志关闭此行为。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2021-11-29T18:39:59.660

我也有这个问题，发现这样做：

```
sudo systemctl enable myservice.service
```

修复了这个问题 - 我已经检查了这个线程中列出的所有其他内容。只需要这样做一次，服务就会在每次后续启动时启动。我的也是一个python脚本

# php - 有没有办法在 strtotime("YYYY-mm") 中设置默认日期

> ID：14258504
> 
> 赞同：0
> 
> 时间：2013-01-10T12:58:44.377
> 
> 标签：php, time

以下片段在我的项目中：

```
/*
//forget it 
$ts = 1319990400;
$y = date("Y",$ts);
$m = date("m", $ts);

var_dump(date("Y-m-d", strtotime("$y-$m")));
*/
date("Y-m-d", strtotime("2013-1")); 
```

它返回

```
"2013-01-10" 
```

在这篇[文章](http://us1.php.net/manual/en/function.strtotime.php#96095)中，它说默认日期是一个月中的第一天。但我发现它输出**2011-10-10**！我将代码片段移动到一个干净的 PHP 脚本，它正常输出 2011-10-01。

我认为设置默认日期是关于 strtotime 的一些选项？我也发现今天是10号有关系吗？

**更新**：我知道只添加像“$y-$m-01”这样的完整日期格式可以解决问题，但我想知道为什么会这样？

**更新**：太奇怪了。我只写 date("Ymd", strtotime("2013-1")) 它返回 "2013-01-10"

**更新**：更新我的答案。:)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-10T13:03:24.757

如果你想要第一个，你可以这样做：

```
$ts = 1319990400;
var_dump(date("Y-m-01", $ts));
//string(10) "2011-10-01" 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-10T13:10:42.073

此外，您可以在 PHP >= 5.2中使用[DateTime](http://php.net/manual/pl/class.datetime.php)

```
<?php
$ts = 1319990400;
$dateTime = new DateTime;
$dateTime->setDate(date('Y', $ts), date('n', $ts), 1);
var_dump($dateTime->format('Y-m-d')); // string(10) "2011-10-01"
var_dump($dateTime->getTimestamp()); // int(1317474597) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-10T14:46:59.863

我知道会发生什么伙计们。

```
int strtotime ( string $time [, int $now = time() ] ) 
```

我的项目使用 PHP 5.2.4，在这个版本中，strtotime 会将 $now 的日期设置为默认日期。我将 $now 设置为许多不同的值来确认这一点。但我在 strtotime() 更改日志中找不到任何有关此的信息。

顺便说一句，干净的脚本使用 PHP 5.2.17。

# c# - Excel-DNA：一维数组限制为 65536 行

> ID：14258507
> 
> 赞同：7
> 
> 时间：2013-01-10T12:58:50.257
> 
> 标签：c#, excel, vba, user-defined-functions, excel-dna

当试图在 VBA 中调用以下 Excel-DNA 方法时，我只得到一个大小为 1 的数组（在 65536 行之后，数组似乎被调整为实际数组大小 - 65537）。当将工作表中的方法作为数组函数调用时，整个过程都有效。

```
[ExcelFunction(Description = "Example", Name = "Example", HelpTopic = "")]
        public static object[] example() {
            object[] ret = new object[65537];
            return ret;
        } 
```

我正在使用 Excel 2007，工作表是 xlsm-Worksheet，当使用这样的二维数组时，一切正常。

```
 [ExcelFunction(Description = "Example", Name = "Example", HelpTopic = "")]
        public static object[,] example() {
            object[,] ret = new object[65537,1];
            return ret;
        } 
```

但是以另一种方式使用二维数组，以防万一

```
[ExcelFunction(Description = "Example", Name = "Example", HelpTopic = "")]
        public static object[,] example() {
            object[,] ret = new object[1,65537];
            return ret;
        } 
```

有人知道如何解决这个问题吗？

在 VBA 中做同样的事情效果很好

```
Function test()
    Dim ret As Variant
    ReDim ret(65536)
    test = ret
End Function

Sub testSub()
    Dim output
    output = Application.Run("test")
End Sub 
```

输出的维度为 65537（索引从 0 开始），大于 65537 的数字也可以工作。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-16T14:38:28.767

鉴于您使用二维数组和翻转维度表示了不同的性能，听起来您遇到了行和/或列的限制。

此页面： http: [//office.microsoft.com/en-us/excel-help/excel-specifications-and-limits-HP010073849.aspx](http://office.microsoft.com/en-us/excel-help/excel-specifications-and-limits-HP010073849.aspx)给出了 Excel 2007 的限制。如您所见，工作表限制为 16,384，您的值超过了很多倍。另一方面，1,048,576 的行限制很容易容纳 65537 的值。

我的猜测是，当您请求具有 65537 列的对象时，构造函数会默默地处理溢出并将其解析为 1。

# android - 如何从 sdk 2 转换为 android sdk 3 以发布到 feed

> ID：14258508
> 
> 赞同：0
> 
> 时间：2013-01-10T12:58:51.627
> 
> 标签：android, facebook, sdk

我用这种方式发布到提要

```
 Bundle params = new Bundle();
        String descriptionString = description.ToString();
        params.putString("name", this.getString(R.string.app_name));
        params.putString("caption", "Caption");
        params.putString("description", descriptionString);
        params.putString("link", "http://www.cnn.com");
        params.putString("message", "this is the message");
        params.putString("picture","http://www.mydomains.com/logo_1.png");

        this._facebook.dialog(this, "feed", params, new PostDialogListener()); 
```

但现在

```
 this._facebook.dialog(this, "feed", params, new PostDialogListener()); 
```

通过对话框有一条线说它已被弃用。现在没有关于如何做的建议吗？如何转换这段代码以使用新的 sdk。我在这里查看了文档，但没有提到对话

[https://developers.facebook.com/docs/tutorials/androidsdk/3.0/upgrading-from-2.0-to-3.0/#re​​quests](https://developers.facebook.com/docs/tutorials/androidsdk/3.0/upgrading-from-2.0-to-3.0/#requests)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-10T17:35:59.913

您正在寻找[WebDialog 类](https://developers.facebook.com/docs/reference/android/3.0/WebDialog)。在您的情况下，您需要查看[WebDialog.FeedDialogBu​​ilder 类](https://developers.facebook.com/docs/reference/android/3.0/WebDialog.FeedDialogBuilder)。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-01-10T13:02:42.527

在 AndroidManifest 文件中，只需键入这段代码...

```
<uses-sdk android:minSdkVersion="2" android:maxSdkVersion="3"/> 
```

# apache-flex - 为什么 ArrayCollection.addItem 在 Flex 中比 Array.push 慢？

> ID：14258510
> 
> 赞同：0
> 
> 时间：2013-01-10T12:59:04.070
> 
> 标签：apache-flex

我有一个将一堆对象添加到 ArrayCollection 中的代码（使用 ArrayCollection.addItem()）。最初，我没有注意到这段代码的响应时间有太大差异。

但是随着添加到 ArrayCollection 中的对象数量的增加，该例程需要更长的时间来响应。

我不得不放弃 ArrayCollection 并改用 Array 并将 (Array.push()) 元素推入数组。

我不明白为什么会这样。有什么区别？有人可以推理吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-10T18:48:24.660

在处理多个项目时，这让我一开始也感到困惑。RIAstar 已经触及到这个问题：Array 是一个原语，就像 int 是一个原语一样。ArrayCollection 是作为 flex 框架的一部分的可实例化类，具有更多特性。因为它是一个类，它会随着它的数据变大而变慢，因为 ArrayCollection 的所有类扩展都需要开销和处理。

ArrayCollection 的主要补充是您可以向它们[添加事件](http://blog.flexexamples.com/2008/05/14/determining-when-an-arraycollection-changes-in-flex/)，而您不能在 Arrays 上添加事件。例如，当您在 ArrayCollection 中添加、更改或删除项目时，它将调度您通过 addEventListener 函数添加的任何事件。

此外，ArrayCollection 具有更多有用的项目管理功能，例如[过滤](http://weblog.mrinalwadhwa.com/2007/07/07/flex-tip-of-the-day-filterfunction-for-real-time-filtering-of-data/)、[排序](http://www.spltech.co.uk/blog/adobe-flex/client-data/sorting-an-arraycollection-using-sortfield)以及在集合中的位置而不是其注册索引处添加、获取和删除项目。

在 Array 和 ArrayCollection 之间进行选择取决于您的编码/应用程序优先级在哪里：您需要性能/您有很多项目吗？-> Array 可能是您正在寻找的。您是否需要简短/快速的编码，更容易与 flex 对象集成？-> ArrayCollection 可能是要走的路。

**延伸阅读**

[一些差异解释](http://blog.flexdevelopers.com/2009/03/flex-basics-arraycollection.html)

[ArrayCollection 参考](http://help.adobe.com/en_US/FlashPlatform/reference/actionscript/3/mx/collections/ArrayCollection.html)

[过滤器功能在起作用](http://weblog.mrinalwadhwa.com/2007/07/07/flex-tip-of-the-day-filterfunction-for-real-time-filtering-of-data/)

# firefox - 从 Firefox 扩展检测菜单栏的存在

> ID：14258515
> 
> 赞同：0
> 
> 时间：2013-01-10T12:59:33.243
> 
> 标签：firefox, firefox-addon, mozilla

我写了一个 Firefox 扩展，它需要知道菜单栏是否存在。并且还需要通知隐藏/显示菜单栏？

我该怎么做呢 ？请帮我

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-11T21:18:46.107

检查 的`autohide`属性`toolbar-menubar`。

```
var menubarPresent = document.getElementById("toolbar-menubar").getAtttribute("autohide") === "false" ? true : false 
```

[您可以通过MutationObserver](https://developer.mozilla.org/en-US/docs/DOM/MutationObserver)获得更改通知

# html - 在跨度/标签元素上添加/删除点击事件

> ID：14258516
> 
> 赞同：1
> 
> 时间：2013-01-10T12:59:34.653
> 
> 标签：html, javascript-events, event-handling

要求：我对跨度进行了一次 ajax 调用。我需要暂时禁用/删除点击事件并在我的 ajax 请求完成后启用它。

我曾经使用过的输入按钮

```
 onRequest : function() {
            $(inputID).disabled = true ;
        },

        onComplete : function(response) {
            $(inputID).disabled = false;
        }, 
```

但是，由于“禁用”无法使用跨度/标签，我需要一个替代方案。

最坏情况解决方案：

```
 onRequest : function() {
            $(inputID).removeEvents() ;
        },

        onComplete : function(response) {
            $(inputID).addEvents() ;
        }, 
```

我不喜欢这个解决方案，因为我需要准备好保留该方法所需的参数。

javascript中是否有任何规定，我可以在不删除和添加事件的情况下快速临时禁用/启用跨度/标签上的点击事件？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-10T13:05:53.677

你可以添加一个类`span`（这样你就可以设置它的样式）......

```
$("inputID").on("click", function () {
    var $input = $(this);
    if (!$input.hasClass("loading")) {
        $input.addClass("loading");
        // pseudo code below
        $input.ajax({
            onComplete : function(response) {
                $input.removeClass("loading");
            }
        })
    }
}); 
```

因此，您不需要添加、删除或触摸任何事件。

# linux - Bash-Command 获取当前网络带宽使用率和 CPU 使用率

> ID：14258517
> 
> 赞同：2
> 
> 时间：2013-01-10T12:59:38.907
> 
> 标签：linux, bash, unix, ubuntu, console

我需要一些命令行片段来获取当前的 CPU 使用率（百分比）和当前的网络带宽使用率。

获取我发现的 CPU-Usage`top -bn1 | grep "Cpu(s)"` 但它总是给我

> %Cpu(s): 12,3 us, 3,6 sy, 0,0 ni, 83,7 id, 0,3 wa, 0,0 hi, 0,0 si, 0,0 st

此命令给出的数字永远不会改变。我试图将服务器设置为重负载，我也得到了 83.7% 的空闲。

我也发现`ps aux|awk 'NR > 0 { s +=$3 }; END {print "cpu %",s}'` 这些值正在改变，看起来不错，但我得到的值是

> 403.8
> 
> 407.3
> 
> 524.6
> 
> 553.2

而且我不知道，这些值意味着我的计算机中有 4 个内核，所以我希望 400% CPU-Usage 意味着所有内核都在 100% 但是我怎么能有超过 400% 的使用率呢？即使，如果 htop 说平均 CPU 使用率约为 3 - 5%

对于网络流量监视器，我没有发现任何可用的东西。我只需要以 kbps 为单位的输入/输出数字即可在另一个程序/脚本中使用它们

非常感谢您的帮助四：）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-10T13:07:56.477

对于网络使用情况，您可以直接从`/proc/net/dev`.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-10T13:09:32.247

试试这个命令`uptime`，它会为您提供过去 1、5 和 15 分钟的正常运行时间和负载平均值。

带宽可以在文件中`/sys/class/net/$1/statistics/rx_bytes`找到`/sys/class/net/$1/statistics/tx_bytes`

您应该记住当前值，并在一秒钟后再次查看以获取当前带宽使用情况。

关于负载的一句话：很多人认为 CPU 使用率是一种有用的衡量标准。这是不正确的。很容易拥有一个系统，其中许多进程正在等待数据（网络、磁盘等），但由于它们正在等待，CPU 负载将很低。如果您尝试在这样的系统上工作，它仍然会感到迟钝。

因此，系统负载是衡量系统“繁忙程度”的更好指标。

你应该看看`atop`那些持续监控系统并为你提供历史数据的工具，比如过去占用 CPU 的进程。（[介绍](http://www.gnutoolbox.com/atop/)）

**编辑**总是打印相同结果的原因`top -bn1 | grep`是因为您正在测量`top`自身的启动。您需要在很长一段时间内运行监视器，然后才能开始使用它为您提供的值。

# visual-c++ - #pragma 警告（默认值：全部）

> ID：14258520
> 
> 赞同：1
> 
> 时间：2013-01-10T12:59:56.230
> 
> 标签：visual-c++, compiler-warnings, pragma

有没有简单的方法来实现这一点？

```
#pragma warning(default: all) 
```

这是无效的；我可以给出一个特定的警告编号，而不是`all`将那个警告恢复为默认值，但我想将*所有*警告恢复为默认值。我不想写出所有警告的长列表！

我的目标是确保我的代码能够干净地编译，并且我不会意外地在我自己的代码中隐藏任何可能在其他地方被禁用的警告。

假设这是在一个巨大的代码库中，其他程序员在我包含但不控制的头文件（包括预编译的头文件）中以及在项目设置中或通过命令行禁用了警告。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-10T18:29:33.983

[http://msdn.microsoft.com/en-us/library/2c8f766e(v=vs.110).aspx](http://msdn.microsoft.com/en-us/library/2c8f766e(v=vs.110).aspx)

恐怕您可能已经看过上面的参考资料了。但是，我的建议是使用警告编译指示的推送/弹出功能：

```
#pragma warning(push) // The very beginning of your code
#include <...>
#pragma warning(pop)

// Your code
... 
```

Push 可以让你保存当时的每一个警告状态，并且 pop 恢复到原始状态。

# php - 不更新mysql中的多行

> ID：14258522
> 
> 赞同：0
> 
> 时间：2013-01-10T13:00:02.897
> 
> 标签：php, mysql

```
$match_id = 123; // this is the value to be updated
$update_item_number = "(3,4,5)"; // this is the id no where the value to be updated
//update query
$orders = "UPDATE orders SET item_number='$match_id' WHERE order_id IN'".$update_item_number ."'";
mysql_query($orders); 
```

此查询未更新，我被困在这里请帮助我...

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-10T13:02:31.403

修改您的查询：

```
"UPDATE orders SET item_number=$match_id WHERE order_id IN $update_item_number"; 
```

整数不需要撇号（它们是可选的，但最好使用纯 int 值）。

在`IN`语句中也不应该有`'`before 和 after 语句`(...)`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-10T13:03:03.957

据我所知，我们需要从 QUERY 中删除 IN 标记周围的单引号。

更新

```
$orders = "UPDATE orders SET item_number='$match_id' WHERE order_id IN'".$update_item_number ."'";
mysql_query($orders); 
```

到

```
$orders = "UPDATE orders SET item_number='$match_id' WHERE order_id IN".$update_item_number;
mysql_query($orders); 
```

并且代码将起作用。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-10T13:03:24.877

```
$update_item_number = "(3,4,5)"; 
```

你不能这样做，因为它将值作为一个完整的字符串，

相反，您可以这样做-

```
$match_id = 123; // this is the value to be updated
$orders = "UPDATE orders SET item_number='$match_id' WHERE order_id IN (3,4,5)";
mysql_query($orders); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-10T13:21:41.197

这可以帮助您：

```
UPDATE 'table_name' SET field_name = $your_value WHERE field_name IN $condition_array; 
```

# android - 我如何在 Windows 上处理这个 python 文件？

> ID：14258529
> 
> 赞同：0
> 
> 时间：2013-01-10T13:00:20.790
> 
> 标签：android, python, linux, windows

python 文件名是orientationplot.py 这个文件google 很容易找到。此 python 脚本用于可视化 WindowOrientationListener 在 android 中的行为。但它是为 linux 编写的。我想在 Windows 中使用它。但是有一个错误，我怎样才能让这个文件在windows中运行。

```
Traceback (most recent call last):
  File "G:\perftool\orientationplot\orientationplot.py", line 27, in <module>
    import fcntl
ImportError: No module named fcntl
fcntl.fcntl(stream, fcntl.F_SETFL, os.O_NONBLOCK) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-10T13:07:37.587

你绝对不能简单地为 Windows 重写这个程序。它大量使用了`fcntl`模块。如果您不知道，[`fcntl`](http://linux.die.net/man/2/fcntl)这是 Linux 上操纵文件描述符的系统调用。

```
fcntl.fcntl(stream, fcntl.F_SETFL, os.O_NONBLOCK) 
```

nosklo 在[这个 StackOverflow 答案](https://stackoverflow.com/a/1422436/1901658)中写道：

> `fcntl`on windows的替代品是`win32api`调用。用法完全不同。这不是您可以翻转的开关。

不过，我确实想指出，通过一些研究，这可能是可能的。您需要弄清楚如何在 Windows 中设置流的文件描述符标志（即流的权限和[open() 系统调用](http://linux.die.net/man/2/open)指定的其他标志），并设置`os.O_NONBLOCK`. [我在Winsock 网站](http://tangentsoft.net/wskfaq/articles/bsd-compatibility.html)上找到了更多信息：

> Unix fcntl() 调用在 Winsock 下没有直接等效项。必要时，Winsock 的 ioctlsocket() 调用中存在类似的功能。例如，使用 Unix 的 fcntl() 设置套接字的 O_NONBLOCK 标志的等价物是使用 Winsock 的 ioctlsocket() 设置 FIONBIO 标志。

# android - 如何在 Galaxy 选项卡上调试 Android 应用程序

> ID：14258538
> 
> 赞同：1
> 
> 时间：2013-01-10T13:00:45.507
> 
> 标签：android

我正在使用 Galaxy 选项卡来调试我的 android 应用程序。但我无法将选项卡作为正在运行的设备。USB 显示已连接，我正在使用 Mac OS。谁能帮我摆脱它？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-10T13:12:39.900

此处列出了 Galaxy 选项卡的 USB 调试步骤。

1.  [从http://www.samsung.com/ca/support/usefulsoftware/KIES/JSP](http://www.samsung.com/ca/support/usefulsoftware/KIES/JSP)在您的开发机器上安装 Samsung kies 安装 后，您可能需要重新启动机器。

2.  转到设备的设置 -> 开发人员选项并启用 USB 调试。

3.  然后将设备 USB 电缆与您的机器连接（如果已连接，请重新连接）

现在你已经准备好进行调试了。玩得开心银河标签:)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-08-21T19:55:34.300

I followed the instructions above and still couldn't set developer options on my Tab 2 because I couldn't see the developer options on the settings menu. I am currently having trouble debugging on my note 2 (this is why I'm messing with the Tab) anyway I read in stack overflow pressing the Build number seven times to show the developer options - I didn't believe it but when I'd hunted all over for how to set up the developer options and couldn't find anything for the tab I thought I would give it a try. I wouldn't have believed it if I didn't do it myself. So if you can't see the developer options press the build button seven times. After a couple of presses it even starts counting down. I had long since moved away from the post where I read it but I owe that man a tick So unbelievable but true - give it a go

在我原来的帖子之后，我已经安装了 kies，现在两个设备都可以工作我认为安装 kies 解决了我的 note2 问题，是的，Munazza 我也接受了你的回答

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-10T13:07:06.847

转到设置->开发人员选项并检查USB调试，移除并连接电缆

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-10T13:08:05.703

您需要在设备上安装用于 USB 调试的驱动程序。对于三星来说，我在 Windows 上使用了一种叫做 samsung kies 的东西。它也应该适用于 MAC。请[在这里查看](http://developer.android.com/tools/device.html)。您还应该在设备上启用 USB 调试。

# java - 如何在 Android 中编写 SQLite execSQL 函数？

> ID：14258540
> 
> 赞同：0
> 
> 时间：2013-01-10T13:00:48.287
> 
> 标签：java, android, sqlite

我正在开发一个应用程序，我需要在其中检索一些数据并存储在 SQLite 数据库中。我正在使用`SQLiteOpenHelper`. 这里`databaseHandler.addDetails(obj);`呈现错误消息。任何帮助，将不胜感激。这是我的代码。

**注册.java**

```
public class Register extends Activity{

//  variables for all text data.
    String FIRSTNAME = null;
    String LASTNAME = null;
    String USERNAME = null;
    String PASSWORD = null;
    String CITY= null;

//  variables for individual ID s .
    EditText fnameText = null;
    EditText lnameText = null;
    EditText unameText = null;
    EditText passText = null;
    EditText cityText = null;
    Button redg = null;
    @Override
    protected void onCreate(Bundle savedInstanceState) {
        // TODO Auto-generated method stub
        super.onCreate(savedInstanceState);
        setContentView(R.layout.register);

        fnameText = (EditText)findViewById(R.id.editText1);
        lnameText = (EditText)findViewById(R.id.editText2);
        unameText = (EditText)findViewById(R.id.editText3);
        passText = (EditText)findViewById(R.id.editText4);
        cityText = (EditText)findViewById(R.id.editText5);
        redg = (Button)findViewById(R.id.button1);

//      button click event
        redg.setOnClickListener(new OnClickListener() {

            @Override
            public void onClick(View v) {
                // TODO Auto-generated method stub
                System.out.println("On click event of Register Activity..........");
                UserDetailsClass obj = new UserDetailsClass();
                FIRSTNAME = fnameText.getText().toString();
                LASTNAME = lnameText.getText().toString();
                USERNAME = unameText.getText().toString();
                PASSWORD = passText.getText().toString();
                CITY = cityText.getText().toString();

                 obj.setFname(FIRSTNAME);
                 obj.setLname(LASTNAME);
                 obj.setUname(USERNAME);
                 obj.setPass(PASSWORD);
                 obj.setCity(CITY);
                 System.out.println("object set in Register Activity........");
                DatabaseHandler databaseHandler = new DatabaseHandler(getApplicationContext());
                System.out.println("Database handler created ........");
                databaseHandler.addDetails(obj);
            }
        });

    }
} 
```

**数据库处理程序.java**

```
public class DatabaseHandler  extends SQLiteOpenHelper{

    // All Static variables
    // Database Version
    private static final int DATABASE_VERSION = 1;

    // Database Name
    private static final String DATABASE_NAME = "UserManager";

    // Contacts table name
    private static final String USER_DETAILS = "userdetails";

    // Contacts Table Columns names
    private static final String KEY_FNAME = "fname";
    private static final String KEY_LNAME = "lname";
    private static final String KEY_USERNAME = "username";
    private static final String KEY_PASSWORD = "password";
    private static final String KEY_CITY = "city";

    public DatabaseHandler(Context context) {
        super(context, DATABASE_NAME, null, DATABASE_VERSION);
    }

    // Creating Tables
    @Override
    public void onCreate(SQLiteDatabase db) {
        System.out.println(" begin of table creation...");
        String CREATE_USER_TABLE = "CREATE TABLE " + USER_DETAILS + "(" + KEY_FNAME + "TEXT," 
        + KEY_LNAME + "TEXT," + KEY_PASSWORD + "TEXT," + KEY_USERNAME + " TEXT PRIMARY KEY," 
        + KEY_CITY + " TEXT" + ")";
        db.execSQL(CREATE_USER_TABLE);
    }

    // Upgrading database
    @Override
    public void onUpgrade(SQLiteDatabase db, int oldVersion, int newVersion) {
        // Drop older table if existed
        db.execSQL("DROP TABLE IF EXISTS " + USER_DETAILS);

        // Create tables again
        onCreate(db);
    }

//   REGISTERING USER METHOD 
    void addDetails(UserDetailsClass obj) {
        SQLiteDatabase db = this.getWritableDatabase();

        ContentValues values = new ContentValues();
        values.put(KEY_FNAME, obj.getFname());
        values.put(KEY_LNAME, obj.getLname());
        values.put(KEY_USERNAME, obj.getUname());
        values.put(KEY_PASSWORD, obj.getPass());
        values.put(KEY_CITY, obj.getCity());

        // Inserting Row
        db.insert(USER_DETAILS, null, values);
        db.close(); // Closing database connection
    }

    // Getting single contact
     UserDetailsClass getDetails(String uname, String pass) {
        SQLiteDatabase db = this.getReadableDatabase();
        System.out.println("I'm in getDetails() of DatabaseHandler .......");
        Cursor cursor = db.query(USER_DETAILS, new String[] { KEY_FNAME,KEY_LNAME,KEY_USERNAME,
                KEY_PASSWORD, KEY_CITY }, KEY_USERNAME + "=? & " + KEY_PASSWORD + "=?",
                new String[] { String.valueOf(uname), String.valueOf(pass) }, null, null, null, null);
        if (cursor != null)
            cursor.moveToFirst();

        UserDetailsClass obj1 = new UserDetailsClass();
        obj1.setFname(cursor.getString(0));
        obj1.setLname(cursor.getString(1));
        obj1.setUname(cursor.getString(2));
        obj1.setPass(cursor.getString(3));
        obj1.setCity(cursor.getString(4));
        // return contact
        return obj1;
    }
} 
```

**UserDetailsClass.java**

```
public class UserDetailsClass {
    public String fname = null;
    public String lname = null;
    public String Uname = null;
    public String Pass = null;
    public String city = null;
    public String getFname() {
        return fname;
    }
    public void setFname(String fname) {
        this.fname = fname;
    }
    public String getLname() {
        return lname;
    }
    public void setLname(String lname) {
        this.lname = lname;
    }
    public String getUname() {
        return Uname;
    }
    public void setUname(String uname) {
        Uname = uname;
    }
    public String getPass() {
        return Pass;
    }
    public void setPass(String pass) {
        Pass = pass;
    }
    public String getCity() {
        return city;
    }
    public void setCity(String city) {
        this.city = city;
    }

} 
```

**这是我的日志猫。**

```
01-10 18:08:46.782: E/Database(334): Error inserting username=jmwtp  lname=gjtp  password=ajtp fname=gjm  city=address 
01-10 18:08:46.782: E/Database(334): android.database.sqlite.SQLiteException: table userdetails has no column named lname: , while compiling: INSERT INTO userdetails(username, lname, password, fname, city) VALUES(?, ?, ?, ?, ?);
01-10 18:08:46.782: E/Database(334):    at android.database.sqlite.SQLiteCompiledSql.native_compile(Native Method)
01-10 18:08:46.782: E/Database(334):    at android.database.sqlite.SQLiteCompiledSql.compile(SQLiteCompiledSql.java:92)
01-10 18:08:46.782: E/Database(334):    at android.database.sqlite.SQLiteCompiledSql.<init>(SQLiteCompiledSql.java:65)
01-10 18:08:46.782: E/Database(334):    at android.database.sqlite.SQLiteProgram.<init>(SQLiteProgram.java:83)
01-10 18:08:46.782: E/Database(334):    at android.database.sqlite.SQLiteStatement.<init>(SQLiteStatement.java:41)
01-10 18:08:46.782: E/Database(334):    at android.database.sqlite.SQLiteDatabase.compileStatement(SQLiteDatabase.java:1149)
01-10 18:08:46.782: E/Database(334):    at android.database.sqlite.SQLiteDatabase.insertWithOnConflict(SQLiteDatabase.java:1569)
01-10 18:08:46.782: E/Database(334):    at android.database.sqlite.SQLiteDatabase.insert(SQLiteDatabase.java:1426)
01-10 18:08:46.782: E/Database(334):    at com.bam.testdatabse.DatabaseHandler.addDetails(DatabaseHandler.java:67)
01-10 18:08:46.782: E/Database(334):    at com.bam.testdatabse.Register$1.onClick(Register.java:62)
01-10 18:08:46.782: E/Database(334):    at android.view.View.performClick(View.java:2485)
01-10 18:08:46.782: E/Database(334):    at android.view.View$PerformClick.run(View.java:9080)
01-10 18:08:46.782: E/Database(334):    at android.os.Handler.handleCallback(Handler.java:587)
01-10 18:08:46.782: E/Database(334):    at android.os.Handler.dispatchMessage(Handler.java:92)
01-10 18:08:46.782: E/Database(334):    at android.os.Looper.loop(Looper.java:123)
01-10 18:08:46.782: E/Database(334):    at android.app.ActivityThread.main(ActivityThread.java:3683)
01-10 18:08:46.782: E/Database(334):    at java.lang.reflect.Method.invokeNative(Native Method)
01-10 18:08:46.782: E/Database(334):    at java.lang.reflect.Method.invoke(Method.java:507)
01-10 18:08:46.782: E/Database(334):    at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:839)
01-10 18:08:46.782: E/Database(334):    at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:597)
01-10 18:08:46.782: E/Database(334):    at dalvik.system.NativeStart.main(Native Method) 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-10T13:08:56.967

您的数据库创建中缺少空格：

```
String CREATE_USER_TABLE = "CREATE TABLE " + USER_DETAILS + "(" + KEY_FNAME + "TEXT," 
        + KEY_LNAME + "TEXT," + KEY_PASSWORD + "TEXT," + KEY_USERNAME + " TEXT PRIMARY KEY," 
        + KEY_CITY + " TEXT" + ")"; 
```

改成：

```
String CREATE_USER_TABLE = "CREATE TABLE " + USER_DETAILS + "(" + KEY_FNAME + "TEXT," 
        + KEY_LNAME + " TEXT," + KEY_PASSWORD + " TEXT," + KEY_USERNAME + " TEXT PRIMARY KEY," 
        + KEY_CITY + " TEXT" + ")"; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-10T13:07:10.880

错误表明您的数据库中没有名为“lname”的列。尝试在您的创建表查询中添加空格作为`KEY_LNAME + "TEXT," => lnameTEXT`

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-01-10T13:05:30.320

从你的日志

> 01-10 18:08:46.782: E/Database(334): android.database.sqlite.SQLiteException: 表 userdetails 没有名为 lname: 的列，编译时：INSERT INTO userdetails(username, lname, password, fname, city)值（？，？，？，？，？）；

你没有专栏`lname`。正如其他人已经指出的那样，您需要在列名和相应类型之间添加空格。

```
KEY_LNAME + " TEXT, " 
```

在`getDetails()`中，您`&`在 where 子句中使用运算符。AFAIK，这是二进制而*不是*逻辑和运算符。我认为，您应该`and`改用

```
Cursor cursor = db.query(..., KEY_USERNAME + " = ? and " + KEY_PASSWORD + " = ?", ...); 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-01-10T13:05:49.900

您需要在 create table 命令中添加空格。以下是更新的命令。

```
String CREATE_USER_TABLE = "CREATE TABLE " + USER_DETAILS + "(" + KEY_FNAME + " TEXT, " 
        + KEY_LNAME + " TEXT, " + KEY_PASSWORD + " TEXT, " + KEY_USERNAME + " TEXT PRIMARY KEY, " 
        + KEY_CITY + " TEXT" + ")"; 
```

# sql - 重复行并更改类别值

> ID：14258543
> 
> 赞同：0
> 
> 时间：2013-01-10T13:00:57.490
> 
> 标签：sql, sql-server, sql-server-2005

我有很多列的表 1。我想复制所有类别 = 16 的行，但我希望复制的行类别 = 17。执行此操作的正确查询是什么？谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-10T13:03:04.710

```
insert into Table1(category, Column1, Column2)
select 17, Column1, Column2
from Table1
where category = 16 
```

# c++ - 将 Windows C++ 服务器编写为服务或控制台应用程序

> ID：14258544
> 
> 赞同：3
> 
> 时间：2013-01-10T13:01:09.673
> 
> 标签：c++, windows, windows-services, client-server, console-application

这需要讨论与在 Windows 7 32 位上使用 C++ 进行服务器开发相关的最佳实践

典型要求：

1.  一个充当“服务器”的程序，在 Windows 后台运行。它应该运行几天，应该在每次启动时自动运行。
2.  服务器通过 TCP 套接字协议处理来自其他设备（PC、智能手机、平板电脑）的传入客户端连接
3.  服务器依次通过 TCP 和串行通信与连接在同一网络中的大量嵌入式设备进行通信
4.  服务器充当桥接黑白客户端（PC、智能手机、平板电脑）和嵌入式设备

服务器管理员可以通过配置.ini 文件配置服务器，然后可以启动服务器。

到客户端的接口是 TCP 套接字接口，客户端将发送命令，服务器反过来将用缓冲区（xml）回复我的问题：

1.  我是否应该将程序编写为“服务”，例如[http://code.msdn.microsoft.com/windowsdesktop/CppWindowsService-cacf4948](http://code.msdn.microsoft.com/windowsdesktop/CppWindowsService-cacf4948)

2.  或者我应该编写一个控制台应用程序并从 XYNTService [http://mysite.verizon.net/XiangYangL/XYNTService.htm](http://mysite.verizon.net/XiangYangL/XYNTService.htm)控制这个可执行文件，以便它像服务一样工作

3.  或者一个控制台应用程序，它在注册表中的条目用于在登录时启动，重新启动

这真的很重要，从上面选择哪个选项？

提前谢谢了。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-11-10T08:01:18.827

这正是服务所针对的用例，因此将其设为服务。

为了便于调试，添加命令行选项以将其作为控制台进程启动。

# asp.net - 如何将表格数据绑定到图表？

> ID：14258545
> 
> 赞同：0
> 
> 时间：2013-01-10T13:01:23.917
> 
> 标签：asp.net, sql-server, data-binding, charts, bind

实际上我有超过 10 列..在设计表单中我有 2 个下拉列表和 2 个文本框..

1-Dropdownlist-选择状态 2-Dropdownlist-选择温度、海平面等列名。 3-文本框-选择开始日期 4-文本框-选择结束日期

现在我想为此功能生成图表...每当我选择状态和温度以及开始日期和结束日期时，我都需要为此过程生成图表。

我想在图表中显示从开始日期到结束日期之间的详细信息......

我想为我的传递参数生成图表，例如...我选择加利福尼亚州和温度并选择开始日期和结束日期（即开始日期 25/08/12 和结束日期 01/01/13）...现在我想为给定的输入创建图表....

在我的数据库表中，我有 5 个字段，例如 state、temp、sealevel、snow、date....

请任何人给你这个过程的想法....

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-11T08:24:05.503

我不知道这是否可以作为答案，但请在这里输入我将在 VS 2012 中执行的操作。

如果要进行通用表示，而不是 3（温度、海平面、雪）图表，则需要表示具有相同格式/数据类型的值。vs2012 预装了 VS 2010 的 ChartControl，但我不知道 VS2008 是否有任何免费的东西。

这是向您展示 ChartControl 的链接。

[http://msdn.microsoft.com/en-us/library/dd456632.aspx](http://msdn.microsoft.com/en-us/library/dd456632.aspx) http://msdn.microsoft.com/en-us/library/system.windows.forms.datavisualization.charting.aspx

现在我想说这对你没有多大帮助，但你应该检查一些 VS2008 的解决方案。我知道很少有付费的解决方案，但我不知道这是否适合您。

# javascript - 如何从 aspx 文件中的脚本将值设置为脚本（.js）文件中的变量

> ID：14258546
> 
> 赞同：1
> 
> 时间：2013-01-10T13:01:29.480
> 
> 标签：javascript, jquery, asp.net

我有一个变量 'multi' ，与我在 js 文件中使用的名称相同。我需要在我的 aspx 页面中为变量设置一个值并将其传递给 javascript 文件。找不到任何帮助。

aspx 脚本代码

```
 var itemdata = [];
    var multi;
    //var plot;
    $(document).ready(function () {
        $.ajax({
            type: "POST",
            url: "ChartBinder.asmx/BindChart",
            data: "{}",
            contentType: "application/json; charset=utf-8",
            dataType: "json",
            success: function (response) {
                //alert(multi);

                var resultObj = $.parseJSON(response.d);
                multi = resultObj;
               // alert(resultObj.Pie);
                multi.Trend = resultObj.Trend;
                //alert(multi.Trend);
                $.getScript('Scripts/highcharts.src.js', function () {
                    DrawPie(resultObj.Pie);
                    DrawTrend(resultObj.Trend);
                    // do something here

                });

            },
            error: function (msg) {
                alert("Error");
            }
        });
    }); 
```

js脚本

```
(function () {
   var seriesCount = window.multi.Trend.length;

   var newcolors = [];

   for (i = 0; i < seriesCount; i++) {
      newcolors[i] = multi.Trend[i].color;
   }
}) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-10T14:04:46.253

`multi`在您的示例中声明在`Global`范围内，因此可用于您的应用程序中的任何其他 JS：

```
var multi; //global but must be included before code referencing it

(function () {
    var multi; //local
}) 
```

根据您的评论：

```
....
$.getScript('Scripts/highcharts.src.js', function () {
      DrawPie(resultObj.Pie);
      DrawTrend(resultObj.Trend);
      // do something here
      DoWork();
 });
 ...

 function DoWork()
 {
     var seriesCount = window.multi.Trend.length;
     var newcolors = [];
     for (i = 0; i < seriesCount; i++) {
       newcolors[i] = multi.Trend[i].color;
     }
 } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-10T18:28:07.673

在后面的代码中声明所需数据类型的变量（.aspx 页面）

在后面的代码（.aspx 页）中：

```
private string multi = "New";

public string Multi
{
    get { return multi; }
} 
```

在 JavaScript 中：

```
var multi='<%=Multi%>';
//Do your stuffs here 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-11T07:04:30.957

`multi`应该在全局范围内以便在您的包含范围内使用，因为您已在`Global`范围内声明它，即功能块之外的文档顶部。

尝试改变

```
var seriesCount = window.multi.Trend.length; 
```

到

```
var seriesCount = multi.Trend.length; 
```

题外话：

你不需要`multi.Trend = resultObj.Trend;`像你已经完成的那样做作业`multi = resultObj;`。

# magento-1.7 - magento 数据库修复工具：它是如何工作的？

> ID：14258547
> 
> 赞同：1
> 
> 时间：2013-01-10T13:01:30.267
> 
> 标签：magento-1.7, magento

我使用了下面链接中描述的数据库修复工具

[http://www.magentocommerce.com/wiki/1_-_installation_and_configuration/db-repair-tool](http://www.magentocommerce.com/wiki/1_-_installation_and_configuration/db-repair-tool)

他们说只有表字符集被改变了。

但我的问题是**它如何**与损坏的数据库和参考数据库一起工作。

我可以将新数据库设置为参考数据库吗？

# php - 使用 PHP 在 IIS 7.5 上出现 500 内部服务器错误

> ID：14258550
> 
> 赞同：0
> 
> 时间：2013-01-10T13:01:46.257
> 
> 标签：php, iis, iis-7, phpmyadmin, iis-7.5

我在 Windows 7 上运行 IIS7.5。我在 PHP 下有网站，但首先它在 linux 主机上，现在我在 IIS 上运行它。它在 linux 主机上成功运行 php，但在 IIS 上却显示错误。

```
HTTP Error 500.0 - Internal Server
Error An unknown FastCGI error occured

Module FastCgiModule
Notification ExecuteRequestHandler
Handler PHP_via_FastCGI
Error Code  0x00000000
Requested URL http://localhost:80/shubhshadi/index.php
Physical Path C:\inetpub\wwwroot\shubhshadi\index.php
Logon Method Anonymous
Logon User Anonymous 
```

# google-fusion-tables - 使用 API 密钥将行插入公共 Google Fusion Table

> ID：14258555
> 
> 赞同：0
> 
> 时间：2013-01-10T13:02:04.403
> 
> 标签：google-fusion-tables

我有一个公共的 Google Fusion Table。我想发布一个 HTTP 请求以在表中插入一个新行。从我对 Google Fusion Table V1.0 API 文档的阅读来看，我似乎可以使用 API 密钥 (&key=) 进行身份验证。但是我总是得到响应：{“error”：{“errors”：[{“domain”：“global”，“reason”：“required”，“message”：“Login Required”，“locationType”：“header ", "location": "授权" } ], "code": 401, "message": "需要登录" } }

是不是 API key 的使用不足以更新一个表？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-10T18:19:55.460

您仍然需要使用密钥传递令牌，但 FT 仍然支持已弃用的 ClientLogin 方法。见[https://stackoverflow.com/a/14060377/1211981](https://stackoverflow.com/a/14060377/1211981)

# ios - 新语言键盘 iOS

> ID：14258556
> 
> 赞同：0
> 
> 时间：2013-01-10T13:02:05.957
> 
> 标签：ios, xcode, keyboard

希望你们都度过了一个美好的节日！

可以编写带有拼写检查和所有内容的不同键盘，并使其与地球按钮一起使用..？

在南非，我们有 11 种官方语言，默认情况下，英语是 iOS 上唯一的一种。

有人有这方面的文献吗？

谢谢！！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-10T13:41:03.620

API 允许您向现有键盘添加按键，甚至可以完全替换它，但仅限于您开发的应用程序。无法注册其他应用程序可用的“全局”键盘。

# spring - 我正在使用 jsp/jstl/spring 动态生成 css 和 js。如何将此结果放置在 head 部分的链接标记中。不在头部的脚本标签中

> ID：14258558
> 
> 赞同：2
> 
> 时间：2013-01-10T13:02:19.423
> 
> 标签：spring, jsp, model-view-controller, spring-mvc, render

我在jsp中生成css，输出是：

```
<style type="text/css">
    body{background: #ffffff url('<c:url value='/resources/images/logo/logo_small.png'/>') no-repeat scroll center center}
</style> 
```

现在我在jsp中调用这段代码：

```
<%@include file="/WEB-INF/common/css/sitemap_common.jsp" %>
<%@include file="/WEB-INF/common/css/index.jsp" %> 
```

它有效，输出是这样的：

```
<head>
<style type="text/css">
    body{background: #ffffff url('<c:url value='/resources/images/logo/logo_small.png'/>') no-repeat scroll center center}
</style>
</head> 
```

但我需要的是

```
<head>
<link rel="stylesheet" href="/css/mycss.css" type="text/css">
</head> 
```

这是一个已完成的项目，包含 100 个生成 jsp 的 css。我需要更新以获得更好的性能。链接标签将被浏览器捕获。但脚本标签每次都会加载。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-16T07:44:40.463

我做到了这一点。

我创建了一个新路由 /resource/css|js ，我使用内部资源视图解析器 - （文件夹）。

我的链接网址类似于**/resource/css/qtn/page1.css**。

在控制器 /resources/{ **type** }/{ **page** }.css 中。

在这里，我获取**类型**和**页面**值，并在我的**动态 jsp**页面中使用它来实现我的结果。

为了安全起见，我*检查了网址*是否来自我自己的页面。

**暗示 ：**

在使用**内部资源视图解析器时，当您***将页面值直接传递给资源 url*时，它会抛出错误，因为有时页面 url 将是**/page1/block1**，因此我们的控制器会抛出错误。

为了解决这个问题，我将页面值作为**/resource/css/qtn/page1.css?sub=${page}**传递。

在控制器中，我们可以轻松地将这个**子值作为****模型**发送到我们的动态 jsp 。

# java - 多部分/表单数据发布 - Java Spring

> ID：14258564
> 
> 赞同：0
> 
> 时间：2013-01-10T13:02:34.477
> 
> 标签：java, spring, post, multipartform-data

所以，我是一个真正的java初学者..我正在做一个有很多工作和研究的应用程序......

事情是。我需要用 multipart/form-data 发布一些信息……我以前用 Json HashMap 来做。但不知道改用哪个对象......这是我的动作控制器帖子：

```
HashMap<String, ContentDTO> cnt = new HashMap<String, ContentDTO>();

        ContentDTO contentDTO = new ContentDTO();
        contentDTO.setExternal_id("CNT1");
        contentDTO.setTemplate_type_id(103);
        contentDTO.setChannel_id("CHN1");
        contentDTO.setTitle("Conteudo1");
        contentDTO.setText("Conteudo teste 1");
        RulesDTO rules = new RulesDTO();
        SimpleDateFormat publish_date = new SimpleDateFormat("yyyy-MM-dd hh:mm:ss-SSS");
        java.util.Date pdate = publish_date.parse("2012-12-28 11:18:00-030");
        java.sql.Timestamp pubdate = new java.sql.Timestamp(pdate.getTime());
        rules.setPublish_date(pubdate);
        SimpleDateFormat expiration_date = new SimpleDateFormat("yyyy-MM-dd hh:mm:ss-SSS");
        java.util.Date edate = expiration_date.parse("2013-12-28 11:18:00-030");
        java.sql.Timestamp expdate = new java.sql.Timestamp(edate.getTime());
        rules.setExpiration_date(expdate);
        rules.setNotify_publish(true);
        rules.setNotify_expiration(false);
        rules.setHighlihted(true);

        contentDTO.setRules(rules);

        InteractionsDTO interactions = new InteractionsDTO();
        interactions.setAllow_comment(true);
        interactions.setAuto_download(false);

        contentDTO.setInteractions(interactions);

        cnt.put("content",contentDTO);

        HttpEntity<HashMap<String, ContentDTO>> request = new HttpEntity<HashMap<String, ContentDTO>>(cnt, httpHeaders); 
```

谁能帮帮我？？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-10T14:22:10.453

由于您需要使用 multipart 上传，我认为您必须使用 File 对象，特别是 Spring 的**[MultipartFile](http://static.springsource.org/spring/docs/1.2.x/api/org/springframework/web/multipart/MultipartFile.html)**。

使用 Spring 你必须使用 Spring Controllers 在 UI 层工作，没有必要管理 HttpEntity。只需在配置文件中声明多部分解析器。

```
<beans>
<bean id="multipartResolver"
    class="org.springframework.web.multipart.commons.CommonsMultipartResolver"/>
<!-- Declare explicitly, or use <context:annotation-config/> -->
<bean id="fileUploadController" class="examples.FileUploadController"/>

</beans> 
```

这是从[官方 Spring 3 文档](http://static.springsource.org/spring/docs/3.0.x/spring-framework-reference/html/mvc.html#mvc-multipart-resolver)中提取的。您可以查看一些示例。这里我再给大家介绍一些：[Spring 3 文件上传示例](http://www.ioncannon.net/programming/975/spring-3-file-upload-example/) ，[Spring MVC 文件上传](http://www.mkyong.com/spring-mvc/spring-mvc-file-upload-example/)。

最后，我建议您使用 MVC 模式。不要创建 DTO 并在 UI 层中使用它的访问器，而是在业务层中创建一个 Service 或 Facade 来执行此操作。

# c# - 将应用程序部署到 IIS 时登录到 sql 失败

> ID：14258565
> 
> 赞同：0
> 
> 时间：2013-01-10T13:02:39.950
> 
> 标签：c#, sql, connect

我有一个调用 DLL 的 Web 应用程序，该 DLL 引用了另一个连接到 SQL Server 的 DLL。在进行一些调试后，我发现正在生成以下错误：用户 'DOMAIN\username' 登录失败。这仅在将 Web 应用程序部署到 IIS 时发生，当通过 Visual Studio 进行调试时，一切都会相应地工作。下面是我用来连接的连接字符串：

```
string strConnectionString = "user id=" + strUsername + 
                             ";password=" + strPassword + 
                             ";server=" + strServer + 
                             ";Trusted_Connection=false;database=" 
                             + strDatabaseName + ";connection timeout=30"; 
```

正在从 web.config 中检索值。请问有什么想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-10T13:41:12.027

考虑到错误消息，您的应用程序似乎根本没有使用您提供的连接字符串。相反，它使用集成的 Windows 安全性来登录数据库。当您在本地计算机上并且您在本地安装了 sql server 但不在 IIS 上时，这将起作用，因为您的帐户将无权登录到 sql server。

我建议，尝试调试应用程序，看看它是否真的在使用您提供的连接字符串。

此外，您可以在 web.config 中使用连接字符串，而不是提供值并在代码中重新构造连接字符串。

# html - 如何仅使用 HTML 将简单文本与页面的垂直中心对齐

> ID：14258567
> 
> 赞同：0
> 
> 时间：2013-01-10T13:02:44.553
> 
> 标签：html

我希望文本 Hello World 位于页面中心

这是我的代码，但不起作用：

```
<html>
<head>
    <style type="text/css">
       body { text-align: center; }
    </style>
    </head>
<body>
<center>Hello world</center>
</body>
</html> 
```

我不想使用 div 标签

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-10T13:08:08.663

试试这个：

```
<html>
<head>
    <style type="text/css">
       body { text-align: center; margin-top:50%; }
    p{margin:auto;
       color:blue;}
    </style>
    </head>
<body>
<p>Hello world</p>
</body>
</html> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-10T13:11:17.037

尝试这样的事情

**HTML**

```
<html style="width:100%;height:100%">
    <body style="width:100%;height:100%">
        <table cellpadding="0" cellspacing="0" width="100%" height="100%">
            <tr>
                <td align="center" valign="middle" width="100%" height="100%">
                    <p>Hello world</p>
                </td>
            </tr>
        </table>
    </body>
</html> 
```

**演示：http:** [//jsfiddle.net/enve/8MEwY/2/](http://jsfiddle.net/enve/8MEwY/2/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-10T13:21:04.697

将文本对齐到中心很容易，只需使用：

```
<html>
   <head>
   </head>
   <body>
      <p style="text-align:center">Hello world</p>
   </body>
</html> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-10T13:30:58.710

您可以在没有解决方案的情况下尝试这样`<table>`，但我不确定当您向页面添加更多样式时它是否会起作用。

```
<html>
<head>
   <style type="text/css">
      p  { 
           margin-top: 25%; 
           text-align: center; 
           color: blue; 
         }
   </style>
</head>
   <body>
       <p>Hello world</p> 
   </body>
</html> 
```

# php - 使用php“实时更新”表单字段

> ID：14258568
> 
> 赞同：0
> 
> 时间：2013-01-10T13:02:48.343
> 
> 标签：php, forms, auto-update

如果我有非常基本的形式；

```
<input type = 'text' name = 'input1' value = '2'>
<input type = 'text' name = 'input2'>
<input type = 'text' name = 'answer'> 
```

php有没有一种方法可以让`answer`盒子“活”起来，这样在我放10秒后它会立即显示`20`为一个值？

我熟悉如何通过提交来做到这一点。但是，我的目标是不必刷新页面

给出一个更详细的表格：

根据设定值计算棱镜体积，用户输入长度

```
$sideOfSquare;
echo "<input type = 'text' name = 'input1'>";
ehco "<input type = 'text' name = 'squareSide' value ='.$sideOfSquare.'>;
echo "<input type = 'text' name = 'answer' value = 'INPUT1 * $sideOfSqaure * $sideOfSquare'>; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-10T13:11:24.817

您也可以在 Jquery 中执行此操作

```
$("#input2").keyup(function() {
   var input2 = $(this).val();
   var answer = parseInt(input2) * parseInt($("#input1").val());

   $("#answer").val(answer);    

}); 
```

确保两件事。

1）您应该将这些 id 保存在适当的文本框中。

2) 验证输入以仅获取数值

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-10T13:20:52.223

以下是如何使用 jQuery ajax 在 PHP 中做你想做的事：( [http://api.jquery.com/jQuery.ajax/](http://api.jquery.com/jQuery.ajax/) )

```
// current file
$("#input2").keyup(function() {
    var input2 = $(this).val();
    jQuery.ajax({
        url: 'myfile.php?input2=' + input2
    }).done(function( data ){
        $(this).val(data);
    });

});

 // myfile.php
 <?php $input2 = $_GET['input2'];
 echo $input2*2; //what you echo here will be sent to data in the success function above. 
```

# c# - 如果数字大于文本框中

> ID：14258573
> 
> 赞同：0
> 
> 时间：2013-01-10T13:03:08.923
> 
> 标签：c#, .net, int

好的，如果我有此代码，我需要帮助，并且我想知道是否有办法检测数字是否大于文本框中的数字？

```
if (textbox1.text == "2")
{
     //code
} 
```

我想知道是否有检测数字是否大于那个所以说它`textbox1.text = "5"`大于 2 所以它会执行 if 命令中的代码？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-01-10T13:05:26.520

```
int value;
if (Int32.TryParse(textbox1.Text, out value))
{
   if (value > 2)
     // code
}
else
{
    // not a number in textbox
} 
```

* * *

实际应用示例：

```
TimeSpan timeOfDay = DateTime.Now.ToLocalTime().TimeOfDay;

if (8 < timeOfDay.Hours && timeOfDay.Hours < 16)
{
    // day
}
else
{
    // night
} 
```

您可以创建扩展方法：

```
public static bool IsDayTime(this DateTime date)
{
    TimeSpan timeOfDay = date.TimeOfDay;
    return 8 < timeOfDay.Hours && timeOfDay.Hours < 16;
} 
```

并以这种方式使用它：

```
var date = DateTime.Now.ToLocalTime();
var file = Path.Combine(Folder, date.IsDayTime() ? "Day.bmp" : "Night.bmp");
picThumbnail.ImageLocation = file;
picThumbnail.SizeMode = PictureBoxSizeMode.Zoom;
SystemParametersInfo(20, 0, file, 0x01 | 0x02);
var rkWallPaper = Registry.CurrentUser.OpenSubKey("Control Panel\\Desktop", true);
rkWallPaper.SetValue("WallpaperStyle", 2);
rkWallPaper.SetValue("TileWallpaper", 0);
rkWallPaper.Close(); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-10T13:06:24.700

解析文本值，然后检查它...

`if(Convert.ToInt32(Textbox.Text) > 2) { //Do something here }`

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-01-10T13:07:01.637

```
if(Int32.Parse(textbox1.text) < number)
{
   // code
} 
```

并捕获无效值情况下的任何异常。或者使用`TryParse`which 有一个`out`参数并返回一个数字是否被实际解析。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-01-10T13:04:48.273

您需要将文本解析为数字，然后您可以做您想做的事情。

C# 的 Int32 类有一个 TryParse 方法，您可以像这样使用它：

```
bool result = Int32.TryParse(textbox1.text, out number);

if (number > 2)
{
  ...
} 
```

这是一种具有输入值*和*输出值的方法。结果`bool`实际上是解析输入值的尝试（'Try'）是否有效的指标，您可以防御性地使用它，如下所示：

```
bool result = Int32.TryParse(textbox1.text, out number);

if (result)
{
  // the parse worked
  // do something with 'number'
}
else
{
    Messagebox.Show(string.Format("Could not convert {0} to a number", textbox1.text));
} 
```

# ios - 获取复杂 NSDictionary 的内容

> ID：14258575
> 
> 赞同：1
> 
> 时间：2013-01-10T13:03:15.083
> 
> 标签：ios, objective-c, nsdictionary

我正在调用一个 API，它以`JSON`格式返回一些高级数据。然后将其处理为`NSDictionary`类似的；

```
NSDictionary *results = [NSJSONSerialization JSONObjectWithData:JSONData options:kNilOptions error:&error]; 
```

当我记录这个时，我可以得到一个非常复杂的结果，类似于：

```
{
 one = {
         oneone = 12345;
         onetwo = "Hello";
         onethree = "How Are You";
       };
 two = 42;
 three = {
           threeone = {
                        threeoneone = "Name";
                        threeonetwo = {
                                          threeonetwoone = "100";
                                          threeonetwotwo = "26";
                                       };
etc etc etc 
```

现在我通过调用获得“三”的内容，`[results objectForKey:@"three"]`但如何获得“三一二”的值？

我尝试了几件事，但无济于事。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-10T13:08:12.720

使用这样的东西......请在编译器中检查它

我不确定，你是否提到了正确的字典，你所有的键都应该是正确的。

```
[results valueForKeyPath:@"three.threeone.threeonetwo.threeonetwoone"]; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-10T13:11:23.240

随着最近 Objective-C 语法的变化，你可以这样做：

```
results[@"three"][@"threeone"][@"threeonetwo"][@"threeonetwoone"]; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-10T13:14:30.387

在你的情况下：

```
NSString* threeoneone= dict[@"three"][@"threeone"][@"threeonetoone"]; 
```

# php - 处理 HTML / 文本和附件的 PHP Mail() 函数

> ID：14258576
> 
> 赞同：0
> 
> 时间：2013-01-10T13:03:21.000
> 
> 标签：php, email, word-wrap

我正在为我的电子邮件使用 PHP mail() 函数，现在我想添加新内容但不知道如何处理..

我创建的基本 PHP Mail 类如下：

```
<?php

class Send_Mail {

    private $to = array();
    private $subject = null;
    private $from = null;
    private $replyTo = null;
    private $type = self::TEXT;

    const HTML = 0;
    const TEXT = 1;

    public function __construct() {
    }

    public function setTo($array) {
        $this->to = $array;
    }

    public function setType($type) {
        if($type == self::HTML || $type == self::TEXT) {
            $this->type = $type;
        }
    }

    public function setSubject($subject) {
        $this->subject= $subject;
    }

    public function setMessage($message) {
        $this->message = $message;
    }

    public function setFrom($from) {
        $this->from = $from;
    }

    public function send() {

        if  (   $this->to == array()    || 
                $this->from == null     ||
                $this->message == null
            ) {
                trigger_error("The email can't be sent ! One of the mandatory fields at least isn't set !");
                return false;
        }
        else {

            $this->to       = implode(',', $this->to);

            $this->subject = ($this->subject == null) ? "" : $this->subject;

            $headers    = array();
            $headers[]  = "MIME-Version: 1.0" . "\r\n";

            if($this->type == self::HTML) {
                $headers[]  = "Content-type: text/html; charset=UTF-8" . "\r\n";
            } else {
                $headers[]  = "Content-type: text/plain; charset=UTF-8" . "\r\n";
            }

            $headers[]  = "To: " . $this->to . "\r\n";
            $headers[]  = "From: " . $this->from . "\r\n";

            $headers[]  = "Reply-To: " . $this->from . "\r\n";

            return mail($this->to, $this->subject, $this->message, implode('', $headers));
        }
    }

}

*/
?> 
```

所以基本上我不能发送附件。我还想添加**多个**密件抄送和**多个**抄送支持。

除了 PHP 文档中所说的行不应超过 70 个字符这一事实外。如果我使用**wordwrap**可以破坏 HTML 标签，我该如何处理？:(

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-10T13:12:24.127

提供带有附件的电子邮件并非易事，因为您需要实现多个部分正文。

最好使用库来解决这个问题。例如：

[http://framework.zend.com/manual/1.12/en/zend.mail.attachments.html](http://framework.zend.com/manual/1.12/en/zend.mail.attachments.html)

或者

[https://pear.php.net/manual/de/package.mail.mail-mime.example.php](https://pear.php.net/manual/de/package.mail.mail-mime.example.php)

否则你必须自己写

对于附件，看看这个

[http://www.shayanderson.com/php/simple-php-mail-class-with-attachment.htm](http://www.shayanderson.com/php/simple-php-mail-class-with-attachment.htm)

有关 CC 或 BCC 等其他电子邮件标题，请阅读此内容

[http://www.htmlite.com/php029.php](http://www.htmlite.com/php029.php)

# jquery - 在可拖动主干视图的上下文中传递“drop”，并将 ui.position 传递给它

> ID：14258580
> 
> 赞同：0
> 
> 时间：2013-01-10T13:03:24.083
> 
> 标签：jquery, jquery-ui, backbone.js, backbone-events

我正在尝试使用主干和 jQuery 为原型应用程序制作模型应用程序。在这一点上它非常小。 [http://jsfiddle.net/IgnorantUser/u7JkX/](http://jsfiddle.net/IgnorantUser/u7JkX/)

我只有 2 个模型`Canvas`和`ButtonWidget`. 还有 3 个视图：`CanvasView`用于 Canvas 的`ButtonInCanvas`视图，用于ButtonWidget 模型`ButtonWidget`的虚拟视图`ButtonInToolbar`，取而代之的是它从 .button css 类中获取默认值，并用于拖放到画布中，用按钮填充它。

由于会有其他小部件（标签、文本框、图像持有者等...），我采用了在“ButtonInToolbar”视图的上下文中传递由“CanvasView”触发的放置事件处理的方法，方法是使用以下代码：

```
 passDrop: function (e, ui){
        if ($(ui.draggable).parent().is('#toolbar')){
            ui.draggable.trigger('drop'); //sets the drop in the context of the dragged view (ButtonInToolbar)
        } 
```

我面临的问题是我希望能够将`ui.position.left`and`ui.position.top`值传递到`ButtonInToolbar`视图中，这样当我调用 dropHandler 方法来附加一个新`ButtonInCanvas`视图时，我可以传递放置的位置并将 Button 渲染到它实际的位置掉了。**我怎么做？**

```
 dropHandler: function () {
        $('.canvas').append(new ButtonInCanvas({model: new ButtonWidget}).render().el);
    } 
```

我尝试`(event, ui)`在上述函数中传递，以便`ui.position.left`获得值，但我得到“未捕获的类型错误：无法读取未定义的属性‘位置’”。我该如何解决这个问题？

此外，在上面的代码中，我使用的是画布选择器而不是`CanvasView`实例。考虑到将来会有多个`CanvasView`，我怎么能关联特定的`CanvasView`实例，以便小部件只附加到它而不是所有具有画布类的 DOM 元素中？

更重要的是，由于这是我第一次尝试使用 Backbone，它与“ToDo”应用程序没有太多共同之处，你能指出我的实现中的任何致命错误吗？我做错的事情，或者我本可以以更好/更有效的方式完成

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-10T13:15:13.290

来自[jQuery .trigger() 文档](http://api.jquery.com/trigger/)：

> ```
> .trigger( eventType [, extraParameters ] ) 
> ```
> 
> `eventType`类型：字符串 包含 JavaScript 事件类型的字符串，例如单击或提交。 `extraParameters`类型：Array, PlainObject 要传递给事件处理程序的附加参数。

因此，您可以在`.trigger()`函数中传递所需的任何其他参数：

```
passDrop: function (e, ui) {
    if ($(ui.draggable).parent().is('#toolbar')) {
        var offset = this.$el.offset(),
            top = ui.offset.top - offset.top,
            left = ui.offset.left - offset.left;
        ui.draggable.trigger('drop', [top, left]);
    }
} 
```

并处理回调中的额外参数：

```
dropHandler: function (event, top, left) {
    var el = new ButtonInCanvas({model: new ButtonWidget}).render().el;
    $(el).css({position: "absolute", top: top, left: left});
    $('.canvas').append(el);
} 
```

此外，将以下内容添加到您的 CSS 中：

```
.canvas {
    position: relative;
} 
```

请参阅[更新的小提琴](http://jsfiddle.net/u7JkX/27/)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-11T10:06:57.130

Lukas 对于你给我的帮助，我感激不尽！:) 最后，我设法使用您的代码将偏移量传递给视图构造函数

```
$('.canvas').append(new ButtonInCanvas({
    model: new ButtonWidget,
    xpos:left,
    ypos:top
  }).render().el); 
```

然后我`model.options`在初始化中`ButtonInCanvas`使用将放置位置值设置到模型本身中：

```
initialize: function (){
_.bindAll(this, 'render', 'setCssStyle', 'setPosition'); 
this.model.set({
    'positionx': this.options.xpos,
    'positiony': this.options.ypos
}) 
```

最后我做了一个方法，通过从模型中`setPosition`获取来设置 css 顶部/宽度。`position x/y`我在里面调用这个方法`render function`

```
setPosition: function () {
    this.$el.css({
    left: this.model.get('positionx') + 'px',
    top : this.model.get('positiony') + 'px',
    position: "absolute"
     });
}, 
```

另外，我已经更新了 jsfiddle [http://jsfiddle.net/IgnorantUser/u7JkX/](http://jsfiddle.net/IgnorantUser/u7JkX/)

现在我需要在画布的特定实例而不是`$(.canvas)`. 我想`cid`会成功的！兴奋的！

# php - 未安装 magento pdo_mysql 扩展

> ID：14258584
> 
> 赞同：1
> 
> 时间：2013-01-10T13:03:33.707
> 
> 标签：php, mysql, magento

我对 magento 命令有疑问：php shell/indexer.php reindexall

> 堆栈跟踪：
> 
> 0 /home/taatoo/www/lib/Zend/Db/Adapter/Abstract.php(459): > Varien_Db_Adapter_Pdo_Mysql->_connect()
> 
> 1 /home/taatoo/www/lib/Zend/Db/Adapter/Pdo/Abstract.php(238): Zend_Db_Adapter_Abstract->query('SET NAMES utf8', Array)
> 
> 2 /home/taatoo/www/lib/Varien/Db/Adapter/Pdo/Mysql.php(419): Zend_Db_Adapter_Pdo_Abstract->query('SET NAMES utf8', Array)
> 
> 3 /home/taatoo/www/app/code/core/Mage/Core/Model/Resource.php(169): Varien_Db_Adapter_Pdo_Mysql->query('SET NAMES utf8')
> 
> 4 /home/taatoo/www/app/code/core/Mage/Core/Model/Resource.php(110): Mage_Core_Model_Resource->_newConnection('pdo_mysql', Object(Mage_Core_Model_Config_Element))
> 
> 5 /home/taatoo/www/app/code/core/Mage/Core/Model/Resource/Db/Abstract.php(320): Mage_Core_Model_Resource->getConnection('core_write')
> 
> 6 /home/taatoo/www/app/code/core/Mage/Core/Model/Resource/Db/Abstract.php(350)：/home/taatoo/www/lib/Varien/Db/Adapter/Pdo/中的Mage_Core 302行的mysql.php

第 301/302/303 行是：

```
if (!extension_loaded('pdo_mysql')) {
    throw new Zend_Db_Adapter_Exception('pdo_mysql extension is not installed');
} 
```

或者，如果我`print_r(get_loaded_extensions());`在 /home/project/www/ 或 /home/project/www/lib/Varien/Db/Adapter/Pdo/ 中执行，我会正确获得“pdo_mysql”扩展名。

`true`如果我`var_dump(extension_loaded('pdo_mysql'));`在这个脚本中这样做，我也会得到。

但是`false`如果我在 /home/project/www/lib/Varien/Db/Adapter/Pdo/Mysql.php 做同样的事情

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-10T13:21:08.003

如评论中所述，您可能正在使用两个不同的 php.ini 文件。
要检查，请将`throw new Zend_Db_Adapter_Exception`行更改为

```
throw new Zend_Db_Adapter_Exception(
  'pdo_mysql extension is not installed. php.ini:'
  . get_cfg_var('cfg_file_path')
); 
```

并将结果与​​输出进行比较

```
var_dump(get_cfg_var('cfg_file_path'), extension_loaded('pdo_mysql')); 
```

在您的命令行脚本中。

另见： http:
[//docs.php.net/manual/en/function.get-cfg-var.php](http://docs.php.net/manual/en/function.get-cfg-var.php)
[http://docs.php.net/manual/en/function.php-ini-loaded-file。 php](http://docs.php.net/manual/en/function.php-ini-loaded-file.php)
[http://docs.php.net/manual/en/function.php-ini-scanned-files.php](http://docs.php.net/manual/en/function.php-ini-scanned-files.php)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-10-13T10:40:45.810

您经常会发现 PHP for web 和 PHP CLI（命令行界面）使用不同的 php.ini 文件。由于您的问题发生在 CLI 中，请键入`php -m`并查看 pdo_mysql 是否在列表中。如果不是，您可以通过键入来找出要编辑的 php.ini 文件`php --ini`。

需要在 php.ini 中的行是`extension=php_pdo_mysql.so`. 很可能它在那里，但用分号注释掉。

# c# - 关于用 C# 实现依赖注入

> ID：14258586
> 
> 赞同：-1
> 
> 时间：2013-01-10T13:03:39.497
> 
> 标签：c#, dependency-injection

我从不在应用程序中使用依赖注入。我浏览了几篇关于依赖注入的文章，发现这个概念很有趣，但相信在现实生活中很难实现。现在我想在我的 win 表单应用程序中实现依赖注入。

我们公司目前与许多航运公司合作，如 UPS、Fedex、Purolator 等，但未来他们计划与许多其他航运公司合作。我为 UPS、Fedex、Purolator 等所有运输公司开发了单独的独立类库项目，并将这些 dll 包含到我们的主窗体应用程序中。问题是很多时候我们在我们的代码中硬编码一些东西，比如国家代码等。

例如，我有一个表格，其中有 4 个按钮。就像这些按钮是“使用 UPS WorldShip 运送”，另一个按钮称为“使用 UPS WebAPI 运送”，另一个按钮称为“使用 FedEX 桌面应用程序运送”，最后一个按钮称为“使用 Fedex WebAPI 运送”。

当用户单击 UPS WorldShip 按钮时，会在文件夹中生成一个平面文件。当用户单击 UPS WebAPI 按钮时，请求会转到 UPS 站点。

当用户单击 FedEX WinApps 按钮时，会在文件夹中生成一个平面文件。当用户单击 FedEX WebAPI 按钮时，请求会转到 FedEx 站点。

所以当用户点击任何按钮时我现在做什么，然后我调用 dll 中存在的特定函数来完成任务。

最后一切都很好，但问题是当我们公司开始与另一家新的航运公司合作时，我必须为该公司创建另一个类库。

我说我从来没有在我的应用程序中使用过 DI，也没有经验。所以有人指导我如何处理我与 DI 的情况，因此当一家新的航运公司加入时，我不必编写任何额外的代码。所以请指导我如何在我的应用程序中实现 DI，并指导我如何使用示例 DI 代码处理我的情况以获得指导。

## 我的第二阶段问题

1) 什么时候需要调用 InitializeKernel() 函数？当应用程序加载或表单加载时

2）我不熟悉ninject所以我只是不明白这行代码的含义是什么

.Configure((b, c) => b.InTransientScope().Named(c.Name)));

3) c.Name 会返回什么？

4）我发现没有配置文件条目。ninject 不需要像 unity DI 这样的配置文件条目？

你给的代码看起来很专业。如果可能，请回答我的所有观点。

最后告诉我有没有可供 ninject 学习 DI 和 ninject 代码使用的 pdf。

谢谢

## 我的第三阶段问题

非常抱歉，您对 InitializeKernel() 声明一次。

你说 Ninject 只支持流畅的配置，然后可能会出现问题，因为当新的航运公司加入时，我必须在这个块中更改代码，比如

```
using(var kernel = InitializeKernel())     
{
    // 4.1 resolve delivery services by names
    var upsWorldShip = kernel.Get<IShippingCompanyService>("ShippingUpsWorldShip");
    var fedExDesktopApps = kernel.Get<IShippingCompanyService>("ShippingFedExDesktopApps");

    var PurolatorExDesktopApps = kernel.Get<IShippingCompanyService>("PurolatorFedExDesktopApps");

    // 4.2 delivery processing
    upsWorldShip.Delivery();
    fedExDesktopApps.Delivery();

    // 5 PROFIT!
} 
```

所以在这里我需要添加这一行

```
var PurolatorExDesktopApps = kernel.Get<IShippingCompanyService>  ("PurolatorFedExDesktopApps"); 
```

问题是每当添加新的与运输相关的 dll 时，我必须在上面的块中添加一行代码....这是不可取的。

如果我可以在配置文件中添加所有 dll 的相关信息并从那里加载和实例化所有 dll 中的所有类，那就更好了。所以我正在寻找你的建议。谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-10T14:46:23.283

似乎您要求[**按约定进行配置**](http://en.wikipedia.org/wiki/Convention_over_configuration)。这意味着您确定应该共享公共配置的组件组，然后在[阅读更多信息后在单个语句中指定该配置](https://github.com/ninject/ninject.extensions.conventions/wiki/What-is-configuration-by-convention)

在实践中，这意味着您将所有具有选定功能的库“交付”部署到项目中的“特殊”位置，并从“特殊”接口继承所有实现。最后，制作 DI 容器以找到它们并为您配置所有内容。

### 定义约定

这是一个简单的示例，如何使用[`Ninject.Extensions.Conventions`](https://github.com/ninject/ninject.extensions.conventions/wiki/What-is-configuration-by-convention).

**注意评论**

```
// 1 define "delivery" interface
interface IShippingCompanyService
{
    void Delivery();
}

// 2.1 — first assembly "Ups.Services.dll"
public class ShippingUpsWorldShip : IShippingCompanyService
{
    public void Delivery()
    {
        "Ship with UPS WorldShip".Dump();
    }
}

// 2.2 — first assembly "FedEx.Services.dll"
public class ShippingFedExDesktopApps : IShippingCompanyService
{
    public void Delivery()
    {
        "Ship with FedEX Desktop Apps".Dump();
    }
} 
```

### 定义配置

使用 Ninject Kernel 构建配置（`StandardKernel`在本例中）

```
// 3 kernel configuration
public static IKernel InitializeKernel() 
{ 
    var kernel = new StandardKernel();

    kernel.Bind(x => x
         // 3.1 search in current assembly
        .FromThisAssembly()
            .SelectAllClasses() // 3.2 select all classes implement "special" interface
            .InheritedFrom<IShippingCompanyService>()
        // 3.3 search all assemblies by wildcards
        .Join.FromAssembliesMatching("./*Services.dll")
            .SelectAllClasses() // 3.2 select all classes implement special interface
            .InheritedFrom<IShippingCompanyService>()
        // 3.4 bind to "special" interface
        .BindAllInterfaces()
        // 3.5 configure lifetime management and dependency name
        .Configure((b, c) => 
            b.InTransientScope().Named(c.Name)));

    return kernel; 
} 
```

### 如何解决依赖关系

从[应用程序的组合根目录](http://blog.ploeh.dk/2011/07/28/CompositionRoot.aspx)按名称解析交付服务

```
// 4 from your Compositon Root ...
using(var kernel = InitializeKernel())     
{
    // 4.1 resolve delivery services by names
    var upsWorldShip = kernel.Get<IShippingCompanyService>("ShippingUpsWorldShip");
    var fedExDesktopApps = kernel.Get<IShippingCompanyService>("ShippingFedExDesktopApps");

    // 4.2 delivery processing
    upsWorldShip.Delivery();
    fedExDesktopApps.Delivery();

    // 5 PROFIT!
} 
```

[此处](https://gist.github.com/4502263)提供的所有资源

### 概括

**按惯例配置**是许多项目中已经采用的非常有用的方法。不过，我建议您阅读[Mark Seemann 的书“.NET 中的依赖注入”](http://www.manning.com/seemann/)并观看他[关于约定](http://bit.ly/UkxXWG)的演讲。

### 答案

1.  *什么时候需要调用 InitializeKernel() 函数？当应用程序加载或表单加载时*，
    *   在应用程序启动时，在[组合根](http://blog.ploeh.dk/2011/07/28/CompositionRoot.aspx)
2.  *我不熟悉ninject，所以我只是不明白这行代码的含义是什么*：`.Configure((b, c) => b.InTransientScope().Named(c.Name)))`
    *   每次注入依赖时，都会创建新实例
    *   依赖项*可以*通过它们的类名来引用
3.  *什么`c.Name`会返回？*
    *   班级名称
4.  *我发现没有配置文件条目。ninject 不需要像 unity DI 这样的配置文件条目？*
    *   Ninject 仅支持流式配置
5.  *你声明了两个具有相同名称的方法，称为`InitializeKernel()`第二个`InitializeKernel()`是为了什么？*
    *   只有一个方法声明`InitializeKernel()`
6.  *最后告诉我有没有可供ninject学习DI和ninject代码使用的pdf*
    *   了解 Ninject 的最佳地点是[官方 wiki](https://github.com/ninject/ninject/wiki)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-10T13:18:40.187

首先，Seemann 有一本非常好的书[“.NET 中的依赖注入”](http://www.manning.com/seemann/)

这[是](http://www.palmmedia.de/blog/2011/8/30/ioc-container-benchmark-performance-comparison)许多 DI 容器的基准。

DI 的主要思想是消费者不能创建它所消费的服务的实例。
并且每个服务都应该以最抽象的方式呈现给客户端：接口/基类（在您的情况下是那个特殊功能）。

> 然后我必须为该公司创建另一个类库

这是不可避免的。如何引用这个新 API 并不重要。客户端代码不应该知道实现细节。

# java - 如何将 .class 文件转换为 . 文件

> ID：14258587
> 
> 赞同：0
> 
> 时间：2013-01-10T13:03:38.297
> 
> 标签：java, decompiler

我有 jar 文件，当我提取这个文件时，我得到了多个 .class 文件。我需要将所有 .class 文件转换为 .java 文件。

现在，我使用**“cavaj”** 反编译器。但它一次只转换一个文件。

我期待**将所有** *.class*文件转换为*.java*文件。

感谢有人可以帮助我找到解决方案。提前致谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-11T06:21:25.100

我在我的 Eclipse 中使用了**jadclipse反编译器。**到目前为止，我发现它很棒。

此工具 ( **jad** ) 还提供从命令行反编译的选项。所以你应该能够反编译 jar 或多个 .class 文件。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-11T06:03:21.757

我找到了另一个java反编译器。它将多个 .class 文件转换为 .java 文件。

这是链接 java [De-Compiler](http://java.decompiler.free.fr/?q=jdgui)

# symfony - EntityManager 已关闭

> ID：14258591
> 
> 赞同：97
> 
> 时间：2013-01-10T13:03:54.927
> 
> 标签：symfony, orm, doctrine-orm, entitymanager

```
[Doctrine\ORM\ORMException]   
The EntityManager is closed. 
```

在插入数据时出现 DBAL 异常后，EntityManager 关闭并且我无法重新连接它。

我试过这样，但它没有连接。

```
$this->em->close();
$this->set('doctrine.orm.entity_manager', null);
$this->set('doctrine.orm.default_entity_manager', null);
$this->get('doctrine')->resetEntityManager();
$this->em = $this->get('doctrine')->getEntityManager(); 
```

有人知道如何重新连接吗？

* * *

## 回答 #1

> 赞同：80
> 
> 时间：2013-09-29T10:36:58.403

我的解决方案。

在做任何事情之前检查：

```
if (!$this->entityManager->isOpen()) {
    $this->entityManager = $this->entityManager->create(
        $this->entityManager->getConnection(),
        $this->entityManager->getConfiguration()
    );
} 
```

所有实体都将被保存。但它对于特定类或某些情况很方便。如果你有一些注入了 entitymanager 的服务，它仍然会被关闭。

* * *

## 回答 #2

> 赞同：38
> 
> 时间：2014-02-13T10:29:39.813

**Symfony 2.0**：

```
$em = $this->getDoctrine()->resetEntityManager(); 
```

**Symfony 2.1+**：

```
$em = $this->getDoctrine()->resetManager(); 
```

* * *

## 回答 #3

> 赞同：33
> 
> 时间：2015-06-29T10:00:48.477

这就是我解决**“EntityManager 已关闭”的教义的方法。**问题。基本上每次出现异常（即重复键）或不为必填列提供数据时，都会导致 Doctrine 关闭实体管理器。如果您仍想与数据库交互，则必须通过调用*JGrinon*`resetManager()`提到的方法来重置实体管理器。

 *在我的应用程序中，我运行了多个 RabbitMQ 消费者，它们都在做同样的事情：检查数据库中是否存在实体，如果是则返回它，如果没有则创建它然后返回它。在检查该实体是否已经存在和创建它之间的几毫秒内，另一个消费者碰巧做了同样的事情并创建了丢失的实体，使另一个消费者产生了重复键异常（**竞争条件**）。

这导致了软件设计问题。基本上我想做的是在一个事务中创建所有实体。这对大多数人来说可能感觉很自然，但在我的情况下，这在概念上肯定是错误的。考虑以下问题：我必须存储一个具有这些依赖关系的足球比赛实体。

*   一个组（例如 A 组、B 组...）
*   一轮（例如半决赛......）
*   场地（即比赛进行的体育场）
*   比赛状态（例如半场、全场）
*   参加比赛的两支球队
*   比赛本身

现在，为什么场地创建应该与比赛在同一个交易中？可能是我刚刚收到了一个不在我的数据库中的新场地，所以我必须先创建它。但也可能是该场地可能举办另一场比赛，因此另一位消费者可能会同时尝试创建它。所以我必须做的是首先在单独的事务中创建所有依赖项，确保我在重复键异常中重置实体管理器。我想说匹配项旁边的所有实体都可以定义为“共享”，因为它们可能是其他消费者的其他交易的一部分。那里没有“共享”的东西是匹配本身不太可能由两个消费者同时创建。

所有这些也导致了另一个问题。**如果您重置实体管理器，那么您在重置之前检索到的所有对象对于 Doctrine 来说都是全新的。所以 Doctrine 不会尝试对它们运行*UPDATE*而是*INSERT*！**因此，请确保在逻辑正确的事务中创建所有依赖项，然后从数据库中检索所有对象，然后再将它们设置为目标实体。以以下代码为例：

```
$group = $this->createGroupIfDoesNotExist($groupData);

$match->setGroup($group); // this is NOT OK!

$venue = $this->createVenueIfDoesNotExist($venueData);

$round = $this->createRoundIfDoesNotExist($roundData);

/**
 * If the venue creation generates a duplicate key exception
 * we are forced to reset the entity manager in order to proceed
 * with the round creation and so we'll loose the group reference.
 * Meaning that Doctrine will try to persist the group as new even
 * if it's already there in the database.
 */ 
```

所以这就是我认为应该这样做的方式。

```
$group = $this->createGroupIfDoesNotExist($groupData); // first transaction, reset if duplicated
$venue = $this->createVenueIfDoesNotExist($venueData); // second transaction, reset if duplicated
$round = $this->createRoundIfDoesNotExist($roundData); // third transaction, reset if duplicated

// we fetch all the entities back directly from the database
$group = $this->getGroup($groupData);
$venue = $this->getVenue($venueData);
$round = $this->getGroup($roundData);

// we finally set them now that no exceptions are going to happen
$match->setGroup($group);
$match->setVenue($venue);
$match->setRound($round);

// match and teams relation...
$matchTeamHome = new MatchTeam();
$matchTeamHome->setMatch($match);
$matchTeamHome->setTeam($teamHome);

$matchTeamAway = new MatchTeam();
$matchTeamAway->setMatch($match);
$matchTeamAway->setTeam($teamAway);

$match->addMatchTeam($matchTeamHome);
$match->addMatchTeam($matchTeamAway);

// last transaction!
$em->persist($match);
$em->persist($matchTeamHome);
$em->persist($matchTeamAway);
$em->flush(); 
```

我希望它有帮助:)

* * *

## 回答 #4

> 赞同：27
> 
> 时间：2013-01-10T15:23:20.667

This is a very tricky problem since, at least for Symfony 2.0 and Doctrine 2.1, it is not possible in any way to reopen the EntityManager after it closes.

The only way I found to overcome this problem is to create your own DBAL Connection class, wrap the Doctrine one and provide exception handling (e.g. retrying several times before popping the exception out to the EntityManager). It is a bit hacky and I'm afraid it can cause some inconsistency in transactional environments (i.e. I'm not really sure of what happens if the failing query is in the middle of a transaction).

An example configuration to go for this way is:

```
doctrine:
  dbal:
    default_connection: default
    connections:
      default:
        driver:   %database_driver%
        host:     %database_host%
        user:     %database_user%
        password: %database_password%
        charset:  %database_charset%
        wrapper_class: Your\DBAL\ReopeningConnectionWrapper 
```

The class should start more or less like this:

```
namespace Your\DBAL;

class ReopeningConnectionWrapper extends Doctrine\DBAL\Connection {
  // ...
} 
```

A very annoying thing is that you have to override each method of Connection providing your exception-handling wrapper. Using closures can ease some pain there.

* * *

## 回答 #5

> 赞同：18
> 
> 时间：2013-05-16T19:06:48.360

你可以重置你的EM

```
// reset the EM and all aias
$container = $this->container;
$container->set('doctrine.orm.entity_manager', null);
$container->set('doctrine.orm.default_entity_manager', null);
// get a fresh EM
$em = $this->getDoctrine()->getManager(); 
```

* * *

## 回答 #6

> 赞同：13
> 
> 时间：2019-06-17T12:36:05.043

在**Symfony 4.2+**中你必须使用这个包：

```
composer require symfony/proxy-manager-bridge 
```

否则你会得到例外：

```
Resetting a non-lazy manager service is not supported. Declare the "doctrine.orm.default_entity_manager" service as lazy. 
```

你可以像这样重置 entityManager：

服务.yaml：

```
App\Foo:
    - '@doctrine.orm.entity_manager'
    - '@doctrine' 
```

Foo.php：

```
use Doctrine\Bundle\DoctrineBundle\Registry;
use Doctrine\DBAL\DBALException;
use Doctrine\ORM\EntityManagerInterface;

 try {
    $this->entityManager->persist($entity);
    $this->entityManager->flush();
} catch (DBALException $e) {
    if (!$this->entityManager->isOpen()) {
        $this->entityManager = $this->doctrine->resetManager();
    }
} 
```

* * *

## 回答 #7

> 赞同：6
> 
> 时间：2018-12-06T08:51:24.090

Symfony v4.1.6

教义 v2.9.0

处理在存储库中插入重复项

1.  访问您的仓库中的注册表

```
 //begin of repo

    /** @var RegistryInterface */
    protected $registry;

    public function __construct(RegistryInterface $registry)
    {
        $this->registry = $registry;
        parent::__construct($registry, YourEntity::class);
    } 
```

2.  将有风险的代码包装到事务中并在出现异常时重置管理器

```
 //in repo method
    $em = $this->getEntityManager();

    $em->beginTransaction();
    try {
        $em->persist($yourEntityThatCanBeDuplicate);
        $em->flush();
        $em->commit();

    } catch (\Throwable $e) {
        //Rollback all nested transactions
        while ($em->getConnection()->getTransactionNestingLevel() > 0) {
            $em->rollback();
        }

        //Reset the default em
        if (!$em->isOpen()) {
            $this->registry->resetManager();
        }
    } 
```

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2015-07-16T11:37:02.890

在控制器中。

异常关闭实体管理器。这给批量插入带来了麻烦。要继续，需要重新定义它。

```
/** 
* @var  \Doctrine\ORM\EntityManager
*/
$em = $this->getDoctrine()->getManager();

foreach($to_insert AS $data)
{
    if(!$em->isOpen())
    {
        $this->getDoctrine()->resetManager();
        $em = $this->getDoctrine()->getManager();
    }

  $entity = new \Entity();
  $entity->setUniqueNumber($data['number']);
  $em->persist($entity);

  try
  {
    $em->flush();
    $counter++;
  }
  catch(\Doctrine\DBAL\DBALException $e)
  {
    if($e->getPrevious()->getCode() != '23000')
    {   
      /**
      * if its not the error code for a duplicate key 
      * value then rethrow the exception
      */
      throw $e;
    }
    else
    {
      $duplication++;
    }               
  }                      
} 
```

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2019-04-18T15:18:05.800

我发现了一篇关于这个问题的有趣文章

```
if (!$entityManager->isOpen()) {
  $entityManager = $entityManager->create(
    $entityManager->getConnection(), $entityManager->getConfiguration());
} 
```

[Doctrine 2 异常 EntityManager 已关闭](https://www.kerstner.at/2014/09/doctrine-2-exception-entitymanager-closed/)

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2018-09-04T10:23:58.303

值得一提的是，我发现这个问题发生在批量导入命令中，因为 try/catch 循环捕获了一个`em->flush()`我没有做任何事情的 SQL 错误（带有 ）。在我的情况下，这是因为我试图插入一条不可为空的属性保留为空的记录。

通常这会导致发生严重异常并停止命令或控制器，但我只是记录了这个问题并继续。SQL 错误导致实体管理器关闭。

检查您的`dev.log`文件中是否存在类似这样的愚蠢 SQL 错误，因为这可能是您的错。:)

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2020-10-16T06:51:21.890

同样的问题，通过简单的代码重构解决了。当必填字段为空时，有时会出现问题，在执行任何操作之前，请尝试重构您的代码。更好的工作流程可以解决问题。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2021-12-08T05:15:56.037

在 Symfony 5 / Doctrine ORM 2.10 中，该`resetEntityManager`方法不可用。

我发现一个正确的解决方案是将`persist`和`flush`方法包装在 a 中`try`，但使用[显式事务](https://www.doctrine-project.org/projects/doctrine-orm/en/2.10/reference/transactions-and-concurrency.html#approach-2-explicitly)。

当发生异常时，我使用`resetManager`方法。

这是一个例子：

```
try {
    $this->entityManager->beginTransaction();
    $this->entityManager->persist($entity);
    $this->entityManager->flush();
    $this->entityManager->commit();
} catch (Exception $e) {
    $this->entityManager->rollback();
    $this->managerRegistry->resetManager();
} 
```

*`managerRegistry`指`Doctrine\Persistence\ManagerRegistry`

来源：[这条消息](https://doctrine.slack.com/archives/CER549E3E/p1616672305314000)在 Doctrine' Slack 的 #orm 频道。

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2021-09-29T22:03:19.183

当我尝试在不为该属性设置默认值的情况下使用不可为空的列保留对象时，我遇到了同样的问题。

```
/**
 * @ORM\Column(type="boolean")
 */
protected $isActive; 
```

在某些情况下，在控制器中准备该对象时，我不会通过以下方式明确设置该属性：

```
$object->setIsActive(false); 
```

所以最后，即使数据库中的那一列的默认值为 0，Doctrine 也试图在该列中保存 NULL。

改为：

```
/**
 * @ORM\Column(type="boolean")
 */
protected $isActive = false; 
```

问题消失了。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2015-02-13T12:58:17.830

我有这个问题。这就是我修复它的方法。

尝试刷新或持续时，连接似乎关闭。试图重新打开它是一个糟糕的选择，因为会产生新的问题。我试图理解为什么连接被关闭，发现我在持久化之前做了太多的修改。

persist() 早先解决了这个问题。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2021-02-26T15:10:26.700

这就是你在 Symfony3 中重置实体管理器的方式。如果它已关闭，它应该重新打开 em：

在控制器中：

```
$em = $this->getDoctrine()->resetEntityManager(); 
```

在服务中：

```
 if (!$this->em->isOpen()) {
        $this->managerRegistry->resetManager('managername');
        $this->em = $this->managerRegistry->getManager('default');
    }

    $this->em->persist(...); 
```

**不要忘记在 service.yml 中注入“@doctrine”作为服务参数！**

我想知道，如果不同的方法同时尝试同时访问同一个实体，是否会发生此问题？

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2019-07-21T09:19:48.523

我在测试 Symfony 4.3.2 中的更改时遇到了同样的问题

我将日志级别降低到 INFO

并再次运行测试

记录显示：

```
console.ERROR: Error thrown while running command "doctrine:schema:create". Message: "[Semantical Error] The annotation "@ORM\Id" in property App\Entity\Common::$id was never imported. Did you maybe forget to add a "use" statement for this annotation?" {"exception":"[object] (Doctrine\\Common\\Annotations\\AnnotationException(code: 0): [Semantical Error] The annotation \"@ORM\\Id\" in property App\\Entity\\Common::$id was never imported. Did you maybe forget to add a \"use\" statement for this annotation? at C:\\xampp\\htdocs\\dirty7s\\vendor\\doctrine\\annotations\\lib\\Doctrine\\Common\\Annotations\\AnnotationException.php:54)","command":"doctrine:schema:create","message":"[Semantical Error] The annotation \"@ORM\\Id\" in property App\\Entity\\Common::$id was never imported. Did you maybe forget to add a \"use\" statement for this annotation?"} [] 
```

这意味着代码中的某些错误会导致：

```
Doctrine\ORM\ORMException: The EntityManager is closed. 
```

所以检查日志是个好主意

* * *

## 回答 #17

> 赞同：-1
> 
> 时间：2016-03-02T15:48:19.103

这确实是个老问题，但我也遇到了类似的问题。我正在做这样的事情：

```
// entity
$entityOne = $this->em->find(Parent::class, 1);

// do something on other entites (SomeEntityClass)
$this->em->persist($entity);
$this->em->flush();
$this->em->clear();

// and at end I was trying to save changes to first one by
$this->em->persist($entityOne);
$this->em->flush();
$this->em->clear(); 
```

问题是清除所有实体，包括第一个实体并抛出错误**EntityManager 已关闭。**

在我的情况下，**解决方案**是对不同类型的实体进行明确，并留`$entityOne`在 EM 下：

```
$this->em->clear(SomeEntityClass::class); 
```

* * *

## 回答 #18

> 赞同：-1
> 
> 时间：2021-04-06T18:15:47.993

```
The EntityManager is closed. 
```

我有同样的问题。原因是数据库表中缺少列 - 我只需要运行迁移。

* * *

## 回答 #19

> 赞同：-2
> 
> 时间：2014-09-08T22:00:29.690

```
// first need to reset current manager
$em->resetManager();
// and then get new
$em = $this->getContainer()->get("doctrine");
// or in this way, depending of your environment:
$em = $this->getDoctrine(); 
```

* * *

## 回答 #20

> 赞同：-2
> 
> 时间：2015-11-19T13:23:38.670

我遇到了同样的问题。在看了几个地方之后，我是如何处理的。

```
//function in some model/utility
function someFunction($em){
    try{
        //code which may throw exception and lead to closing of entity manager
    }
    catch(Exception $e){
        //handle exception
        return false;
    }
    return true;
}

//in controller assuming entity manager is in $this->em 
$result = someFunction($this->em);
if(!$result){
    $this->getDoctrine()->resetEntityManager();
    $this->em = $this->getDoctrine()->getManager();
} 
```

希望这对某人有帮助！

* * *

## 回答 #21

> 赞同：-3
> 
> 时间：2020-02-10T15:42:39.143

我在使用 Symfony 5 / Doctrine 2 时遇到了同样的错误。我的一个字段使用 MySQL 保留字“order”命名，导致 DBALException。当您想使用保留字时，您必须使用反引号转义它的名称。以注释形式：

```
@ORM\Column(name="`order`", type="integer", nullable=false) 
```*

# xml - 在 Sharepoint Designer 的数据视图中自定义过滤器下拉菜单

> ID：14258592
> 
> 赞同：0
> 
> 时间：2013-01-10T13:03:54.377
> 
> 标签：xml, sharepoint, filter, sharepoint-designer, dataviewwebpart

我有一个 dataviewwebpart，它为列表启用了过滤、排序和分组，使用 SharePoint 设计器完成。该列表有一些类别列，这些列在部署时显示为数据视图上方的工具栏的过滤器下拉列表中。如何从下拉列表中删除它们？
我对此进行了谷歌搜索，发现 dvt.filterfield 是填充过滤器下拉列表的内容。目前，我的数据视图如下：
Filter Sort by dropdown Group by dropdown

列表...

当我单击过滤器时，列表中当前的所有列都显示为过滤器选项。重复我的问题，我想从显示的选项中删除 2-3 列。我怎么做？
希望这个问题很清楚。如果有人需要，我会发布该网站的屏幕截图。谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-10T13:59:58.193

找到了我想要的链接。这里（如果有人想知道）： [高级 DVWB 排序和过滤](http://blogs.catapultsystems.com/tlingenfelder/archive/2009/07/29/advanced-data-view-web-part-sorting-grouping-and-filtering.aspx)

# c# - 在 C# 中自动生成访问器类的方法

> ID：14258594
> 
> 赞同：1
> 
> 时间：2013-01-10T13:03:59.760
> 
> 标签：c#, unit-testing, class, private

我有以下问题。假设有一个类，其中包含一个必须测试的私有类。为了切断不必要的评论和答案，**是**的，它必须保持私密，**是**的，它必须经过测试。

说，它看起来像这样：

```
public class PublicClass
{
    private class InternalClass
    {
        void Method() { }
    }
} 
```

为了便于测试，我想创建以下类：

```
public class InternalClassAccess
{
    private object instance;

    public InternalClassAccess()
    {
        // Use reflections to instantiate InternalClass
        // and store it in instance field
    }

    public void Method()
    {
        // Use reflections to call Method() on
        // stored instance
    }
} 
```

我可以手动编写这样的类，但我想知道，是否有某种自动方式这样做？我有专业版的 VS 2012。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-10T13:13:12.303

我不知道 .NET 中为此内置了任何内容 - 但您*可以*使用`dynamic`. 你会有这样的结构：

```
public class PrivateDynamicAccessor : DynamicObject
{
    private readonly object instance;

    public PrivateDynamicAccessor(string typeName)
    {
        // Instantiate here via reflection
    }

    public override bool TryGetMember(GetMemberBinder binder,
                                      out Object result)
    {
        // Access the fields or properties with reflection
    }
} 
```

（`TryInvokeMember`方法等也是如此）

然后您可以将其用作：

```
dynamic foo = new PrivateDynamicAccessor("Foo.Bar+Baz");
string name = foo.Name;
// etc 
```

（我同意不得不这样做很奇怪的评论，请注意。你*真的*不能让它成为内部的吗？）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-10T13:19:12.337

您可以使用一些预处理指令：

```
public class PublicClass
{
    #if DEBUG
    public class InternalClass
    #else
    private class InternalClass
    #endif
    {
        void Method() { }
    }
}

//Only valid when testing in Debug
public class TestableInternalClass : PublicClass.InternalClass
{

} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-10T13:09:41.833

在 Visual Studio 2010 Ultimate 中，您只需右键单击方法/构造函数并选择生成测试。这将为外部类创建一个访问器类，允许您访问私有内部类。

# javascript - 当焦点在其他窗口时停止运行 Javascript Web 应用程序的方法

> ID：14258596
> 
> 赞同：3
> 
> 时间：2013-01-10T13:03:59.640
> 
> 标签：javascript, jquery

当焦点在其他窗口时，有什么方法可以停止运行 Javascript Web 应用程序？例如，如果我在应用程序 Web 中执行 AJAX，在这种情况下停止运行会非常有效。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-10T13:06:41.643

[使用页面可见性 API](http://www.html5rocks.com/en/tutorials/pagevisibility/intro/)

> Page Visibility API 执行一个简单但重要的功能——它让您的应用程序知道页面何时对用户可见。这条基本信息允许创建在不被查看时行为不同的网页。

[Visibility.js](https://github.com/ai/visibility.js) - 页面可见性 API 的包装器

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-10T13:12:47.093

你的问题太理论化了。JS 中没有本地方法来跟踪窗口焦点，但实现自己的方法相对简单。

一旦您知道窗口是否在给定时间点具有焦点，您就可以在您的实现中使用此信息连续触发 AJAX 请求（很可能在某种循环中）并在窗口未获得焦点时跳过请求的触发。

例如

```
var winFocused = false;

window.onfocus = function() {
  winFocused = true;
}
window.onblur = function() {
  winFocused = false;
} 
```

然后在您的“循环”或其他任何内容中，例如：

```
setInterval(function() {
  if( ! winFocused) return;

  // Otherwise, if winFocused is true, do what you need...

}, 1000); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-10T13:13:16.700

页面可见性 api 的问题在于，它不兼容跨浏览器。没有 Safari，没有 IE<10。 [https://developer.mozilla.org/en-US/docs/DOM/Using_the_Page_Visibility_API](https://developer.mozilla.org/en-US/docs/DOM/Using_the_Page_Visibility_API)

您可以尝试使用窗口焦点和模糊事件。（jQuery 示例）

```
(function() {
    var isFocused = true;
    $(window).focus(function() {
        isFocused = true;
    });

    $(window).blur(function() {
        isFocused = false;
    });

    function doSomeAjax() {
        if (isFocused) {
            doSomething();
        }
    }

}); 
```

它不像页面可见性 api 那样花哨，因为它只告诉您选项卡是否聚焦，但它可能足以实现您想要做的事情。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-10T13:21:29.717

您可以使用`beforeSend`设置将`jqXHR`对象存储在数组中，然后`window.blur`循环遍历数组并中止每个请求。下面的简化示例：

```
$(document).ready(function () {
    var ajaxRequests = [];
    $.ajax({
        "beforeSend": function (jqXHR, settings) {
            ajaxRequests.push(jqXHR);
        },
        //... other settings
    });
    $.ajax({
        "beforeSend": function (jqXHR, settings) {
            ajaxRequests.push(jqXHR);
        },
        //... other settings
    });
    $.ajax({
        "beforeSend": function (jqXHR, settings) {
            ajaxRequests.push(jqXHR);
        },
        //... other settings
    });
    $(window).blur(function () {
        var xhr = null,
            i = 0;
        for (i = ajaxRequests.length - 1; i = 0; i -= 1) {
            xhr = ajaxRequests.pop(); //remove last jqXHR from array and return it
            xhr.abort(); //abort it
        }
    });
}); 
```

# javascript - Ruby on Rails View 通过渲染插入 js.erb 文件

> ID：14258602
> 
> 赞同：3
> 
> 时间：2013-01-10T13:04:12.727
> 
> 标签：javascript, ruby-on-rails, ruby, actionview

为了在某​​些页面上包含一段我只需要的 javascript，我把

```
 = javascript_tag do
   = render "inserts_js_enhanced_element.js.erb" 
```

在我的`haml`档案中。现在我在测试中收到警告：

```
DEPRECATION WARNING: Passing a template handler in the template name is 
deprecated. You  can simply remove the handler name or pass render
:handlers => [:erb] instead.` 
```

但是，当我将线路更改为

```
 = render "inserts_js_enhanced_element.js", :handlers => [:erb] 
```

无论如何，我收到一个新警告，说

```
 DEPRECATION WARNING: Passing the format in the template name is 
 deprecated. Please pass render with :formats => [:js] instead. 
```

如果我确实将其更改为

```
 = render "inserts_js_enhanced_element", :handlers => [:erb], :formats => [:js] 
```

它给了我错误

```
 ActionView::Template::Error:
   Missing partial application/inserts_js_enhanced_element with {:handlers=>[:haml, :builder, :erb, :coffee], :locale=>[:de], :formats=>[:html]}. 
```

现在格式似乎没有改变，`:js`而且处理程序不仅是`:erb`. 我应该如何正确输入 JS-ERB？

更新：

js.erb 文件的格式为

```
 <% session_val = determine_session_val_from_config %>
 jQuery(document).ready(function() {
   //JS Code
 } 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-01-10T14:42:00.253

[很好:) 我想我通过这篇](https://stackoverflow.com/q/339130/1627888)SO 文章自己找到了答案

```
= render(:partial => 'inserts_js_enhanced_element', :handlers => [:erb], :formats => [:js]) 
```

有效，并且没有给我弃用警告

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-10T13:13:08.420

你试过用这个吗？

```
= render "inserts_js_enhanced_element" 
```

# mysql - 更新，总和 sql

> ID：14258603
> 
> 赞同：1
> 
> 时间：2013-01-10T13:04:19.913
> 
> 标签：mysql, sql

我有这些 SQL 指令：

```
 CREATE TABLE discipline (
       did INT PRIMARY KEY,
       code VARCHAR(127) UNIQUE,
       university VARCHAR(127),
       number_students INT
 ) ENGINE=INNODB; 

 CREATE TABLE precedence(
      type VARCHAR(127),
      basic INT,
      advanced INT,
      PRIMARY KEY (basic, advanced), 
      FOREIGN KEY (basic) REFERENCES discipline(did) ON DELETE CASCADE ON UPDATE CASCADE,
      FOREIGN KEY (advanced) REFERENCES discipline(did)
 )ENGINE=INNODB;

 INSERT INTO discipline VALUES (1,'BD','U1',30);
 INSERT INTO discipline VALUES (2,'IBD','U2',30);
 INSERT INTO discipline VALUES (3,'SIBD','U3',30);
 INSERT INTO precedence VALUES ('optional',1,2);
 INSERT INTO precedence VALUES ('mandatory',2,3);
 UPDATE discipline SET did=did+did WHERE did=2; 
```

我不明白为什么指令的结果`SELECT SUM (DISTINCT did)`是 6 而不是 8 (1+4+3)。更新指令的值`2`（did）不应该是`4`？你能给我解释一下吗？谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-10T13:12:43.927

> 更新指令的值 2 (did) 不应该是 4？

**不，它是 4，它应该。**

因为`UPDATE`SQL 中的语句是**一次性**操作。这意味着您在同一逻辑阶段拥有的所有表达式都被评估为好像在同一时间点。在您的示例中：

```
UPDATE discipline 
SET did = did + did 
WHERE did=2; 
```

将`did`等于，`4`因为表达式`did = did + did`同时使用值进行评估`did = 2`。

[**SQL 小提琴演示**](http://www.sqlfiddle.com/#!2/a1b10/4)

这将使您的表格看起来像：

```
| DID | CODE | UNIVERSITY | NUMBER_STUDENTS |
---------------------------------------------
|   1 |   BD |         U1 |              30 |
|   3 | SIBD |         U3 |              30 |
|   4 |  IBD |         U2 |              30 | <<<<< 
```

* * *

> 我不明白为什么指令 SELECT SUM (DISTINCT did) 的结果是 6 而不是 9 (1+4+3)。

更新后的值`Did`将是：

```
1
3
4 
```

所以：

```
SELECT SUM(DISTINCT did) 
FROM discipline 
```

将等于`8`。

[**SQL 小提琴演示**](http://www.sqlfiddle.com/#!2/a1b10/5)

* * *

在您更新的示例中，由于外键约束，您将无法这样做`UPDATE did`，并且您将遇到异常：

> 无法删除或更新父行：外键约束失败 ( `db_2_65e0c`. `precedence`, CONSTRAINT `precedence_ibfk_2`FOREIGN KEY ( `advanced`) REFERENCES `discipline`( `did`))

[**SQL 小提琴演示**](http://www.sqlfiddle.com/#!2/14345)

在这种情况下，您将需要添加`ON DELETE CASCADE ON UPDATE CASCADE`到另一个外键约束：

```
 FOREIGN KEY (advanced) REFERENCES discipline(did) 
```

然后`UPDATE`：

```
UPDATE discipline
SET did=did + did
WHERE did=2; 
```

将与之前解释的相同，并且

```
SELECT SUM(DISTINCT did) 
FROM discipline 
```

将等于`8`。

[**两个表的 SQL 小提琴演示（工作）**](http://www.sqlfiddle.com/#!2/82c86/3)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-10T13:14:43.377

正确的结果应该是 8，因为更新后三个值是 (1, 4, 3)，所以子值是 8。

# android - dimens.xml 中的大小是我们在那里看到的吗？

> ID：14258606
> 
> 赞同：1
> 
> 时间：2013-01-10T13:04:33.617
> 
> 标签：android

在我的`dimens.xml`我有：

```
<dimen name="small_title">7sp</dimen> 
```

在代码中我有：

```
Logger.i(getClass(), "size is " + getResources().getDimension(R.dimen.small_title)); 
```

这给了我：

```
size is 10.5 
```

为什么会这样，我怎样才能得到`7sp`如中所述的`dimens.xml`？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-10T13:20:46.407

> **sp**与比例无关的像素 - 这类似于 dp 单位，但它也根据用户的字体大小偏好进行缩放。建议您在指定字体大小时使用此单位，以便根据屏幕密度和用户偏好进行调整。

这就是为什么。

也看看[文档](http://developer.android.com/reference/android/content/res/Resources.html#getDimension%28int%29)

> 单位转换基于与资源关联的当前 DisplayMetrics。

# pymongo - pymongo justOne & multi

> ID：14258607
> 
> 赞同：0
> 
> 时间：2013-01-10T13:04:34.520
> 
> 标签：pymongo

我有一个带有集合“testcol”的数据库“testdb”，如下所示：

```
{u'_id': ObjectId('50eeb8029b75941b9af614bd'), u'birth': 1}
{u'_id': ObjectId('50eeb82e9b75941bc820f22c'), u'birth': 2}
{u'_id': ObjectId('50eeb82e9b75941bc820f22d'), u'birth': 3}
{u'_id': ObjectId('50eeb82f9b75941bce96032c'), u'birth': 2}
{u'_id': ObjectId('50eeb82f9b75941bce96032d'), u'birth': 3} 
```

代码如下：

```
m_connection = MongoClient(M.HOST,M.PORT)
col = m_connection['testdb']['testcol']
#some_operation
cursor = col.find()
for doc in cursor:
        print doc 
```

我试图更新所有出生大于一的文档，所以我将 some_operation 替换为`col.update({'birth':{'$gt':1}},{'$set':{'death':'near'}},{'multi':True})`我得到错误：`TypeError: upsert must be an instance of bool`

同样，我只想删除所有出生为 2 0r 3 的文档中的一个。
我将 some_operation 替换为`col.remove({'birth' : {'$in' : [2,3]}},{'justOne' : 1})`我得到错误：`TypeError: Wrong type for safe, value must be a boolean`

我尝试使用直接布尔值代替 {} 数组，但只有一个文档被更新，所有出生为 2 或 3 的文档都被删除。

以防万一它与版本有关：我有 pymongo-2.4.1 和 Python2.7 任何线索我哪里出错了？非常感谢。

编辑：文档说： update(spec, document[, upsert=False[,urgical=False[, safe=None[, multi=False[, check_keys=True[, **kwargs]]]]]])

这是否意味着：如果我想使用'multi'=True，我必须强制为它之前的任何东西（upsert、操纵、安全）定义值？

[此外，对于删除，它说： remove([spec_or_id=None[, safe=None[, **kwargs]]])这里](http://docs.mongodb.org/manual/applications/delete/)提到的“justOne”在哪里？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-11T19:52:48.213

只要您`multi=`在调用中使用`update()`（例如，`col.update({'birth':{'$gt':1}}, {'$set':{'death':'near'}}, multi=True)`），Python 就会为您省略的任何可选参数应用默认值。[您可以在http://docs.python.org/2/tutorial/controlflow.html#keyword-arguments](http://docs.python.org/2/tutorial/controlflow.html#keyword-arguments)阅读有关此行为的更多信息

对于您关于 的其他问题`justOne`，不幸的是，PyMongo 似乎还不支持它。目前执行此操作的方法是使用`find_one()`获取文档，然后将其传递`_id`给`remove()`.

# linux - 使用 tac 反向读取文件

> ID：14258616
> 
> 赞同：4
> 
> 时间：2013-01-10T13:05:11.070
> 
> 标签：linux, file, unix, reverse, gnu-coreutils

我对 UNIX 编码相当陌生，我有一个需要逐行反向读取的文件。该文件在 {} 中有代码段。然后我需要以这个反向文件作为输入来运行一个 awk 脚本。我正在让我们的支持人员安装 tac，但在他们这样做之前，我想知道它是否会输出我需要的东西，或者是否有人可以提出替代方案。

该文件具有以下形式的数据：

```
page 0 0 0 none
{
   layer 0 0 0 "1line" 0 8 8 3
   {
      sector 0 -1 0 32 
      {
        point_name 0 0 34543 34 44 1 1 0
        status 1 0 1 0 1 431232 "transformer" 23 12
        analog 1 0 1 0 1 321234 11.5 43 1 1 0
        ...
        ...
        ...
        device 1 0 1 "ground" 32 56 1 1 0
      }
    }
} 
```

我想保留 {} 但反转 {} 之间的行，所以输出看起来像：

```
page 0 0 0 none
{
   layer 0 0 0 "1line" 0 8 8 3
   {
      sector 0 -1 0 32 
      {
        device 1 0 1 "ground" 32 56 1 1 0
        ...
        ...
        ...
        analog 1 0 1 0 1 321234 11.5 43 1 1 0
        status 1 0 1 0 1 431232 "transformer" 23 12
        point_name 0 0 34543 34 44 1 1 0
      }
    }
} 
```

另外，tac 会覆盖输入文件还是将其保存为不同的文件？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-10T14:40:24.387

`tac`只是颠倒文件的行顺序，因此您需要更强大的东西来完成您想要的。此外，所有 shell 工具都不包括在不使用“临时”文件的情况下覆盖输入文件的方法。一些工具（例如`sed`，`Perl`等）具有所谓的“就地编辑”选项，当未提供备份文件后缀时，将给出文件覆盖的最终结果。

为了完成你想要的，我建议使用`awk`. 像这样运行：

```
awk -f script.awk file > newfile 
```

要使用临时文件覆盖您的输入文件，请运行：

```
awk -f script.awk file > temp && mv temp file 
```

* * *

内容`script.awk`：

```
/{/ {
    print (a ? a ORS : "") $0
    f=1; a=b=""
    next
}

f && !/}/ {
    a = (a ? a ORS : "") $0
    b = $0 (b ? ORS b : "")
    next
}

/}/ && b {
    print b ORS $0
    a=b=f=""
    next
}1 
```

结果：

```
page 0 0 0 none
{
   layer 0 0 0 "1line" 0 8 8 3
   {
      sector 0 -1 0 32 
      {
        device 1 0 1 "ground" 32 56 1 1 0
        ...
        ...
        ...
        analog 1 0 1 0 1 321234 11.5 43 1 1 0
        status 1 0 1 0 1 431232 "transformer" 23 12
        point_name 0 0 34543 34 44 1 1 0
      }
    }
} 
```

或者，这是一个班轮：

```
awk '/{/ { print (a ? a ORS : "") $0; f=1; a=b=""; next } f && !/}/ { a = (a ? a ORS : "") $0; b = $0 (b ? ORS b : ""); next } /}/ && b { print b ORS $0; a=b=f=""; next }1' file 
```

解释：

> 第一个代码块询问该行是否包含左大括号。如果是这样，打印记录 'a' 中的任何内容，然后是当前记录（包含左大括号的行）。设置一个标志，删除记录'a'和'b'并跳过处理其余代码。
> 
> 当且仅当设置了标志并且该行不包含右大括号时，才会执行第二个块。现在我们建立两个记录'a'和'b'。回想一下，如果一行包含左大括号，将打印记录'a'。所以它必须建立在“开始到结束”的方向。然后我们在“从头到尾”方向构建记录“b”。'next' 然后跳过处理其余代码。
> 
> 如果该行包含右大括号和记录“b”，则将执行第三个块（请记住，这是反向构建的记录）。然后我们打印记录'b'，后跟当前行（带有右大括号的行）。删除记录“a”、“b”并重置标志。'next' 跳过处理其余代码。末尾的“1”启用默认打印。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-10T13:41:11.437

像大多数 UNIX *（样式）*工具一样`tac`，既不会覆盖原始文件也不会写入新文件，它会打印到`stdout`，与`tac`您一起写入新文件将使用重定向`tac file > newfile`，这会将反向保存`file`到`newfile`. 你不能`tac`单独做你需要的事情，你需要一个脚本。

这是一个`awk`：

```
{
    # store each line in the array line
    line[n++] = $0
} 

/{/ {
    # get the line number of the last line containing {
    first=NR
}

!/}/ {
    # get the line number of the last line not containing }
    last=NR
} 

END {
    # print first section in order
    for (i=0;i<first;i++) 
        print line[i]
    # print second section in reverse order
    for (i=last-1;i>=first;i--)    
        print line[i]
    # print last section in order
    for (i=last;i<NR;i++) 
        print line[i]
} 
```

将此保存到文件中，`reverse`然后运行`awk -f reverse file`：

```
$ awk -f reverse file
page 0 0 0 none
{
   layer 0 0 0 "1line" 0 8 8 3
   {
      sector 0 -1 0 32 
      {
        device 1 0 1 "ground" 32 56 1 1 0
        ...
        ...
        ...
        analog 1 0 1 0 1 321234 11.5 43 1 1 0
        status 1 0 1 0 1 431232 "transformer" 23 12
        point_name 0 0 34543 34 44 1 1 0
      }
    }
} 
```

使用重定向创建一个新文件`awk -f reverse file > newfile`。

# java - 如何以编程方式调暗背光输入按钮？

> ID：14258625
> 
> 赞同：5
> 
> 时间：2013-01-10T13:05:31.550
> 
> 标签：java, android

我正在编写一个应用程序来调暗屏幕，如何从服务中调暗屏幕底部的背光输入按钮？

启动不可见的不可触摸的不可聚焦的活动不是一种选择，因为它会阻止其他活动的启动。

建议？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-07-08T23:16:37.573

尝试使用

```
getWindow().getDecorView().setSystemUiVisibility(View.SYSTEM_UI_FLAG_LOW_PROFILE); 
```

你会需要

```
<uses-sdk
android:minSdkVersion="8"
android:targetSdkVersion="11" /> 
```

在您的图书馆清单中。

如果适用，还可以在库和 shell 的属性中将目标 SDK 设置为 11

# html - 用于推送 Html5 应用的“原生容器”-“设备管理服务器”对

> ID：14258626
> 
> 赞同：0
> 
> 时间：2013-01-10T13:05:48.480
> 
> 标签：html, server-push

我们有多个客户，每个客户都有多个应用程序。另一件事是，用户将拥有由其角色分配的不同应用程序（工作流应用程序、图表应用程序、管理应用程序等）。

这些客户更愿意只安装一个本机应用程序并将其用于所有工作流程。他们想管理谁使用什么。

然后这些 Html5 应用程序会随着推送自动更新，用户不需要做任何事情。

我正在寻找一种解决方案来实现以下目标：

*   开发人员编写 Html5 应用程序
*   开发者将app（html、js、css等）发送给设备管理器/应用管理器（简称TOOL）
*   TOOL 将应用推送到用户的设备
*   在 TOOL 中，我应该能够分辨出哪些用户使用了哪些应用程序

*   原生容器（简称 NC）从 TOOL 接收 HTML5 应用

*   用户从分配的工具之一中选择他们想要在 NC 中运行的应用程序
*   NC 在嵌入式 web 视图中运行它们
*   NC正在为相机等提供一些API（可选）

有谁知道这样的解决方案？任何技术术语也会有所帮助。

Sybase 有一个工具“混合 Web 容器”，但它似乎只适用于与 SAP 相关的东西。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-19T09:22:57.213

随着 HTML5 越来越广泛地用作移动应用程序的开发标准，可以在各种移动设备上访问和管理的应用程序容器的问题将变得越来越重要，以实现 BYOD 或跨平台移动访问。现实成本。

最近，Azurati 在 HTML5 移动应用容器领域做了一些有趣的工作。看看： [http ://www.azurati.com/products/azurati-mobile-portal/](http://www.azurati.com/products/azurati-mobile-portal/)

此解决方案与您上面概述的“本机”容器方案略有不同，因为 Azurati 的应用程序容器本身也是 HTML5，但它确实支持基于角色的经过身份验证的用户访问，您可以将应用程序分配和管理到特定的角色组，用户可以使在离线模式下使用 HTML5 应用程序并使用位置服务等设备功能。

# android - Android XML 拉解析器慢，怎么提速？

> ID：14258627
> 
> 赞同：2
> 
> 时间：2013-01-10T13:05:47.747
> 
> 标签：android, xml-parsing, xmlpullparser

我使用 XmlPullParser 编写了一个 XML 解析器，但是解析几百行数据需要很长时间。

你能看一下代码并告诉我我做错了什么吗？

```
 case ONE:
            buffer.clear();
            xpp.setInput(responseBuffer[ONE], "UTF_8");
            // Returns the type of current event: START_TAG, END_TAG, etc..
            eventType = xpp.getEventType();

            while (eventType != XmlPullParser.END_DOCUMENT) {
                if (eventType == XmlPullParser.START_TAG) {
                    if (xpp.getName().equalsIgnoreCase("firstTag")) {
                        bufferA = xpp.nextText();
                    } else if (xpp.getName().equalsIgnoreCase("secondTag")) {
                        bufferB = xpp.nextText();
                    } else if (xpp.getName().equalsIgnoreCase("thirdTag")) {
                        bufferC = xpp.nextText();
                    } else if (xpp.getName().equalsIgnoreCase("u")) {
                        bufferD = xpp.nextText();
                    } else if (xpp.getName().equalsIgnoreCase("n")) {
                        bufferE = xpp.nextText();
                    } else if (xpp.getName().equalsIgnoreCase("d")) {
                        bufferF = xpp.nextText();
                    } else if (xpp.getName().equalsIgnoreCase("so")) {
                        bufferG = xpp.nextText();
                    } else if (xpp.getName().equalsIgnoreCase("wei")) {
                        bufferH = xpp.nextText();
                    } else if (xpp.getName().equalsIgnoreCase("ter")) {
                        bufferI = xpp.nextText();
                    }
                } else if (eventType == XmlPullParser.END_TAG
                        && xpp.getName().equalsIgnoreCase("close")) {
                    buffer.add(new VisitInfo(
                            bufferA,
                            bufferB,
                            bufferC,
                            bufferD, bufferE,
                            bufferF, bufferG,
                            bufferH, bufferI));
                }
                eventType = xpp.next(); // move to next element
            }

            break; 
```

基于这个结构，我还有三个解析器。谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2015-04-09T15:41:41.587

XmlPullParser 类处理大型 XML 文件的速度非常慢。为此，我更喜欢使用[VDT-XML 库](http://vtd-xml.sourceforge.net/)、[VTD-XML Benchmark](http://vtd-xml.sourceforge.net/benchmark1.html)。

就我而言，我有 66841 行的 XML 文件，您可以查看我的结果：

Nexus 5：2055 毫秒

Galaxy Note 4：2498 毫秒

XML 文件的简短示例

```
 <database name="products">
        <table name="category">
            <column name="catId">20</column>
            <column name="catName">Fruit</column>
        </table>
        <table name="category">
            <column name="catId">31</column>
            <column name="catName">Vegetables</column>
        </table>
        <table name="category">
            <column name="catId">45</column>
            <column name="catName">Rice</column>
        </table>
        <table name="category">
            <column name="catId">50</column>
            <column name="catName">Potatoes</column>
        </table>
</database> 
```

“build.gradle”文件的配置

```
dependencies {
    compile files('libs/vtd-xml.jar')
} 
```

源代码示例：

```
import com.ximpleware.AutoPilot;
import com.ximpleware.VTDGen;
import com.ximpleware.VTDNav;

String fileName = "products.xml";

VTDGen vg = new VTDGen();

if (vg.parseFile(fileName, true)) {

     VTDNav vn = vg.getNav();
     AutoPilot table = new AutoPilot(vn);
     table.selectXPath("database/table");

     while (table.iterate()) {
        String tableName = vn.toString(vn.getAttrVal("name"));

        if (tableName.equals("category")) {
            AutoPilot column = new AutoPilot(vn);
            column.selectElement("column");

            while (column.iterate()) {
                 String text = vn.toNormalizedString(vn.getText());
                 String name = vn.toString(vn.getAttrVal("name"));

                 if (name.equals("catId")) {
                    Log.d("Category ID = " + text);
                 } else if (name.equals("catName")) {
                    Log.d("Category Name = " + text);
                 } 

            }
        }
     }
} 
```

结果

```
Category ID = 20
Category Name = Fruit

Category ID = 31
Category Name = Vegetables

Category ID = 45
Category Name = Rice

Category ID = 50
Category Name = Potatoes 
```

它对我有用，希望对你有帮助。

# java - 番石榴 - InetAddress.coerceToInteger 返回 int 而不是 long

> ID：14258632
> 
> 赞同：4
> 
> 时间：2013-01-10T13:06:00.100
> 
> 标签：java, guava, inetaddress

[我对 Guava 的InetAddress.coerceToInteger](http://docs.guava-libraries.googlecode.com/git-history/release/javadoc/com/google/common/net/InetAddresses.html#coerceToInteger%28java.net.InetAddress%29)方法有疑问。

根据文档的方法：

公共静态 int coerceToInteger(InetAddress ip)

'无论提供的参数是否为 IPv4 地址，都返回一个表示 IPv4 地址的整数。'

但是，IPv4 范围是无符号的 32 位，而 Java 的 int 是有符号的 - 意味着返回的值只能覆盖 IPv4 相关范围的一半。

我错过了某人还是该方法存在真正的问题？

谢谢

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-01-10T13:08:14.577

32 位值是 32 位值，无论是有符号还是无符号，它都可以有 2^32 个值。如果您有一个像 192.168.0.1 这样的地址，它将是一个负数，不会丢失任何信息。如果将其转换为字节（也有符号），则不会丢失任何信息。

顺便说一句：对于 IPv4 地址，您可以使用此技巧

```
int address = ip.hashCode(); 
```

要将 32 位有符号值视为 32 位无符号值，您可以

```
int address32 = ...
long address = address32 & 0xFFFFFFFFL; 
```

但是，在大多数情况下，您不需要这样做。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-10T13:10:59.827

我认为 Javadoc 包含答案：

> IPv6 地址在转换为整数之前被强制转换为 IPv4 地址。
> 
> 只要有应用程序假定所有 IP 地址都是 IPv4 地址，因此可以安全地转换为整数（无论出于何种目的），此函数也可用于处理 IPv6 地址，直到应用程序得到适当修复。
> 
> 注意：强制转换为 IPv4 地址的 IPv6 地址只能用于基本识别或索引到真实 InetAddresses 集合的目的。它们不能用作网络通信的真实地址。

换句话说，如果您提供 IPv6 地址，不要期望它是实际可用的地址。准备好在您的代码或网络中处理具有特殊条件的强制地址。在我看来，文档可以从一个例子中受益匪浅。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-06-15T00:25:48.420

Java 中的 long 是 64 位值，IPv4 地址只有 32 位值。挑战在于 Java 没有无符号数据类型，因此需要一些魔法来读取无符号值，通常是通过上转换为长整数。番石榴也涵盖了这一点：

```
InetAddress addr = InetAddress.getLocalHost();
long ip = UnsignedInts.toLong (InetAddresses.coerceToInteger (addr)); 
```

# php - 如何合并到保存键的数组？

> ID：14258633
> 
> 赞同：0
> 
> 时间：2013-01-10T13:06:02.487
> 
> 标签：php, arrays

想合并

```
array(
 2 => 'a'
 3 => 'b'
); 
```

和

```
array(
 7 => 'c'
 9 => 'd'
); 
```

要得到

```
array(
 2 => 'a'
 3 => 'b'
 7 => 'c'
 9 => 'd'
); 
```

`array_merge()`给我

```
array(
 0 => 'a'
 1 => 'b'
 2 => 'c'
 3 => 'd'
); 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-10T13:07:35.573

很简单，你可以这样做-

```
$result = $array1 + $array2; 
```

简单的例子

```
$array1 = array(0 => 'zero_a', 2 => 'two_a', 3 => 'three_a');
$array2 = array(1 => 'one_b', 3 => 'three_b', 4 => 'four_b');
$result = $array1 + $array2;
var_dump($result); 
```

输出

```
array(5) {
  [0]=>
  string(6) "zero_a"
  [2]=>
  string(5) "two_a"
  [3]=>
  string(7) "three_a"
  [1]=>
  string(5) "one_b"
  [4]=>
  string(6) "four_b"
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-10T13:09:35.117

您可以简单地添加数组：`$myArray1 + $myArray2;`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-10T13:11:43.617

使用数组统一运算符：“+”

```
<?php

$foo = array(
 2 => 'a',
 3 => 'b'
);

$bar = array(
 7 => 'c',
 9 => 'd'
);

$result = $foo + $bar;

print_r( $result ); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-10T13:15:31.887

$阵列1 + $阵列2；

是我的选择，而且效果很好。

# jquery - 手工旋转木马

> ID：14258636
> 
> 赞同：0
> 
> 时间：2013-01-10T13:06:12.007
> 
> 标签：jquery, carousel

我正在制作带有上一个/下一个按钮的最简单的垂直轮播。我快到了，但我还没有弄清楚以下几点：

```
var shortnewsblockHeight = $(".shortnewsblock").outerHeight();
var totalnewsblocks = $(".shortnewsblock").length;
var i = 0;
$(".stamp.long a.prev").css({ "opacity": "0.3", "text-decoration": "none", "cursor": "default" });

goDown();
goUp();

function goDown() {
    $(".stamp.long a.next").click(function () {
        $(".stamp.long a.prev").animate({
            'opacity': '1'
        }, 300);
        $(".stamp.long a.prev").css({ "text-decoration": "underline", "cursor": "pointer" });
        i++;
        if (i != (totalnewsblocks - 5)) {
            $("#shortnewsblocks > #inner").stop().animate({
                'marginTop': '-=' + shortnewsblockHeight
            }, 600);
        } else {
            $("#shortnewsblocks > #inner").stop().animate({
                'marginTop': '-=' + shortnewsblockHeight
            }, 600);
            $(".stamp.long a.next").animate({
                'opacity': '0.3'
            }, 300);
            $(".stamp.long a.next").css({ "text-decoration": "none", "cursor": "default" });
            $(".stamp.long a.prev").animate({
                'opacity': '1'
            }, 300);
            $(".stamp.long a.prev").css({ "text-decoration": "underline", "cursor": "pointer" });

        }
        return false;
    });
}

function goUp() {
    $(".stamp.long a.prev").click(function () {
        i--;
        if (i != 0) {
            $("#shortnewsblocks > #inner").stop().animate({
                'marginTop': '+=' + shortnewsblockHeight
            }, 600);
            $(".stamp.long a.next").animate({
                'opacity': '1'
            }, 300);
            $(".stamp.long a.next").css({ "text-decoration": "underline", "cursor": "pointer" });

        } else {
            $("#shortnewsblocks > #inner").stop().animate({
                'marginTop': '+=' + shortnewsblockHeight
            }, 600);
            $(".stamp.long a.prev").animate({
                'opacity': '0.3'
            }, 300);
            $(".stamp.long a.prev").css({ "text-decoration": "none", "cursor": "default" });

        }
        return false;
    });
} 
```

1.  如果我在上一个/下一个按钮上单击得太快，高度就会被打乱，我的轮播会失去它的“块式”动画。

2.  如果轮播用完了要滚动的元素，我的按钮会淡出（并且光标变为默认，因此最终用户不会尝试单击它）。但我需要让它们完全禁用，因为现在最终用户仍然可以点击它，搞砸旋转木马。

干杯!

JSFiddle：http: [//jsfiddle.net/REVDc/1/](http://jsfiddle.net/REVDc/1/)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-10T13:34:11.783

1.  `stop`在动画进行时从动画中移除或移除点击事件。

2.  用于`pointer-events: none`禁用单击。更多信息[在这里](https://developer.mozilla.org/en-US/docs/CSS/pointer-events)。

# html - 甚至将三个 div 表与多个图像对齐 - 表 1 和 3 有 3 张大小相同的图片，表 2 有不同大小的图片

> ID：14258638
> 
> 赞同：0
> 
> 时间：2013-01-10T13:06:13.453
> 
> 标签：html, css, alignment, css-tables, assign

图片准确显示我正在尝试做的事情：

[链接到图片](http://testnow.us/divimages)

第一个图像是我在烟花中创建的项目，但我希望能够在 Dreamweaver 中操作图像。这不是家庭作业！！第一个图像是它应该看起来的方式，第二个图像是它的结果。对于我的生活，我无法弄清楚我做错了什么。我知道这可能是我忽略的一件简单的事情，但在这方面花了很多时间，似乎无法清楚地集中注意力。

CSS：

```
#header {
width:750px;
height:341px;
margin-left:25px;
display:block;
}
#tableleft {
clear: right;
float: left;
width: 128px;
margin-left:10px;
margin-right: 5px;
margin-top:10px;
 }
#tablecenter {
margin-left:165px;
clear: both;
float: left;
width: 410px;
margin-bottom:5px;
}
#tableright {
clear: left;
float: left;
width: 128px;
margin-left: 600px;
margin-right:10px;
margin-top:10px;
} 
```

html

```
<p align="center"><img src="images/SmWhitepic.jpg" alt="" width="118" height="87"     /></p>
    <p>&nbsp;</p>
    <p align="center"><img src="images/SmWhitepic.jpg" alt="" width="118" height="87" /></p>
    <p>&nbsp;</p>
    <p align="center"><img src="images/SmWhitepic.jpg" alt="" width="118" height="87" /></p>
  </div>
</div> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-10T13:09:30.363

从每个 ID 样式中删除它`clear`（如果 div 的宽度很好）

# ssis - 创建 SSIS 项目时出现“SSDT 已安装”错误

> ID：14258639
> 
> 赞同：0
> 
> 时间：2013-01-10T13:06:15.647
> 
> 标签：ssis

我确实在同一台机器上安装了 sql server 2012 express 和 sql server 2012 企业版。Express 是在企业之前安装的。

在创建集成服务项目时，我收到此错误，

> Microsoft Visual Studio 无法加载此文档：在 sql server 数据工具中设计集成服务包。SSDT 必须由 sql server 2012 标准的这些版本之一安装，企业开发人员评估要安装 SSDT，请运行 SQL Server 安装程序并选择 Sql服务器数据工具

我用谷歌搜索并找到了有关再次卸载和重新安装所有软件包的文章。

有没有办法在不卸载并重新安装上述软件包的情况下摆脱这个错误？我现在如何创建项目？

**澄清**

在安装 MSSql 2012 包时，我通过选中复选框安装了 SSDT。事实上，我已经安装了那里列出的每个组件，因此无需再次安装它们。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-10T19:13:09.460

转换为答案。

我通过快速安装验证了在安装的功能选择页面上，有一个标有 SSDT 的复选框，这就是您所需要的。您应该能够再次运行安装，当您进入功能列表时，只需将该复选框添加到已安装的那些。它应该只安装缺少的组件。

**更新**

如果您以前安装过这些工具，最好和最干净的选择是卸载/重新安装。您的快速版本可能会导致问题。卸载这两个版本并重新安装企业或开发人员版本（如果您正在构建开发工作站，最好是开发人员，如果这是您的生产服务器，则最好是企业。）

# android - 哈希映射数组列表到android中的JSON数组？

> ID：14258640
> 
> 赞同：1
> 
> 时间：2013-01-10T13:06:17.173
> 
> 标签：android, json

```
"order_item" : [{"price":"250.00","product_code":"1","quantity":"2","
total":"500.00"},
{"price":"200.00","product_**code":"2","quantity":"1","**total":"200.00"} ]
} 
```

我必须将我的哈希映射数组列表转换为上面的 json 数组格式。在我的数组列表的第一个位置，我的集合像 price=250.00,product_code=1,quantity=2,total:500.00，在我的第二个位置 price=60.00， product_code=55,quantity=10,total:600.00 等等。他们中的任何一个都知道答案帮助我。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-10T13:23:54.920

```
public class Product 
{
   private String price;

   private String product_code;

   private String quantity;

   private int total;

   public Product(String price, String product_code, String quantity, int total)
   {
      this.price = price;
      this.product_code = product_code;
      this.quantity = quantity;
      this.total = total;
   }
} 
```

商业逻辑

```
new Gson().toJson(map); 
```

用法

```
 Product pr1 = new Product("str1", "str1", "str1", 250);
      Product pr2 = new Product("str2", "str2", "str2", 200);
      List<Product> list = new ArrayList<Product>();
      list.add(pr1);
      list.add(pr2);
      Map<String, List<Product>> map = new HashMap<String, List<Product>>();
      map.put("order_item", list);

      System.out.println(new Gson().toJson(map)); 
```

**编辑**（使用[json.org](http://json.org)）

```
 Map<String, String> jsonMap1 = new HashMap<String, String>();
      jsonMap1.put("price", "250.00");
      jsonMap1.put("product_code", "1");
      jsonMap1.put("quantity", "2");
      jsonMap1.put("total", "200");
      Map<String, String> jsonMap2 = new HashMap<String, String>();
      jsonMap2.put("price", "250.00");
      jsonMap2.put("product_code", "1");
      jsonMap2.put("quantity", "2");
      jsonMap2.put("total", "200");

      JSONObject json1 = new JSONObject(jsonMap1);
      JSONObject json2 = new JSONObject(jsonMap2);

      JSONArray array = new JSONArray();
      array.put(json1);
      array.put(json2);

      JSONObject finalObject = new JSONObject();
      finalObject.put("order_item", array);

      System.out.println(finalObject.toString()); 
```

**EDIT2**（使用 Gson）

```
 Map<String, String> jsonMap1 = new HashMap<String, String>();
      jsonMap1.put("price", "250.00");
      jsonMap1.put("product_code", "1");
      jsonMap1.put("quantity", "2");
      jsonMap1.put("total", "200");
      Map<String, String> jsonMap2 = new HashMap<String, String>();
      jsonMap2.put("price", "250.00");
      jsonMap2.put("product_code", "1");
      jsonMap2.put("quantity", "2");
      jsonMap2.put("total", "200");
      List<Map<String, String>> list = new ArrayList<Map<String, String>>();
      list.add(jsonMap1);
      list.add(jsonMap2);
      Map<String, List<Map<String, String>>> map = new HashMap<String, List<Map<String, String>>>();
      map.put("order_item", list);

      System.out.println(new Gson().toJson(map)); 
```

# azure - Azure 云存储交易价格是什么意思？

> ID：14258641
> 
> 赞同：18
> 
> 时间：2013-01-10T13:06:19.180
> 
> 标签：azure, azure-blob-storage

我们正在考虑使用 Azure blob 存储作为我们的备份存储。但我们不确定交易价格在现实中对我们意味着什么。（他们收取每存储量的成本和每笔交易的成本）

例如，如果我每天将一个 16 GB 的文件传输到存储中（并删除，所以我最终总是保留 10 个版本）。这是否仅意味着每天 1 笔交易（可能还有一些用于列表等）或者是像每包某种大小的交易，这样我每天都会花费很多。或者交易是什么意思？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2013-01-10T13:42:00.047

小心，它可能没有你想象的那么简单。首先，这取决于您使用的是页面还是块 blob。它还取决于您用于上传 blob 的库。对于块 Blob，存储客户端具有正在上传的块的最大大小 (32MB) 的默认值，并将文件拆分为*n*个块 - 每个块将是一个事务（请参阅[了解块 Blob 和页面 Blob](http://msdn.microsoft.com/en-gb/library/windowsazure/ee691964.aspx)。您还将需要考虑重试，并且正如您所指出的，列出、删除等。

我建议您仔细查看备份的方式并找到块的大小 - 然后进行计算。然后在一个独立的账户中做一些受控的跟踪，看看你是否可以根据你的估计来核对账单交易。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2013-01-11T05:19:02.947

请查看存储团队关于计费的博客文章：http: [//blogs.msdn.com/b/windowsazurestorage/archive/2010/07/09/understanding-windows-azure-storage-billing-bandwidth-transactions-和容量.aspx](http://blogs.msdn.com/b/windowsazurestorage/archive/2010/07/09/understanding-windows-azure-storage-billing-bandwidth-transactions-and-capacity.aspx)

总而言之，您需要为 Windows Azure 存储中的 3 项内容付费：

1.  **存储费用**：您存储的数据量
2.  **带宽费用**：数据流出数据中心的数据出口所消耗的带宽。数据入口是免费的。
3.  **交易费用**：您实质上是使用 REST API 与 Windows Azure 存储进行交互的。事务被定义为单个 API 调用。例如，如果您上传一个文件并且该文件是单次上传的（即没有将其分成块或块），那就是一个事务。如果您上传一个文件并进行分块上传（比如 100 个块），那将是 100 个事务（嗯，从技术上讲，它将是 101 个事务:)）。同样，如果您删除一个 blob 也是一个事务。

我还构建了一个简单的计算器，可以让您大致了解您的 Windows Azure Blob 存储账单。您可以在此处使用此计算器：http: [//gauravmantri.com/2012/09/03/simple-calculator-for-comparing-windows-azure-blob-storage-and-amazon-s3-pricing/](http://gauravmantri.com/2012/09/03/simple-calculator-for-comparing-windows-azure-blob-storage-and-amazon-s3-pricing/)。它基本上是为了比较 Amazon S3 成本和 Windows Azure Blob 存储成本而构建的，但也可以仅用于 Windows Azure Blob 存储。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-10T13:14:28.307

我会说你的第一个猜测：根据他们的解释，每天 1 笔交易：

事务 – 对存储服务的每个单独的 Blob、表和队列 REST 请求都被视为潜在的计费事务。然后，应用程序可以通过控制向存储服务发送请求的频率和数量来控制其交易成本。我们分析收到的每个请求，然后根据我们处理请求的能力和请求的结果将其分类为可计费或不可计费。

[从这里引用](http://blogs.msdn.com/b/windowsazurestorage/archive/2010/07/09/understanding-windows-azure-storage-billing-bandwidth-transactions-and-capacity.aspx)。

但最好的办法是去参加审判。我认为 Azure 在一段时间内是免费的，这样您就可以看到有多少请求真正进行了。

# php - 如何通过嵌套子列表中的javascript保存父ID

> ID：14258654
> 
> 赞同：0
> 
> 时间：2013-01-10T13:07:02.767
> 
> 标签：php, jquery

**我有一个嵌套列表，其中包含任意数量的 li 和任意数量的 li，其中每个 li 都有 2 个隐藏输入：一个 id 和一个父级的 id。**

```
<ul>
    <li>
        <input type="hidden" name="question[id][]" value="'. $sub['id'] .'" />
        <input type="hidden" name="question[parent][]" value="'. $question['id'] .'" />
        <ul>
            <li>
            <input type="hidden" name="question[id][]" value="'. $sub['id'] .'" />
            <input type="hidden" name="question[parent][]" value="'. $question['id'] .'" />
            </li>
        </ul>
    </li>
    <li>
        <input type="hidden" name="question[id][]" value="'. $sub['id'] .'" />
        <input type="hidden" name="question[parent][]" value="'. $question['id'] .'" />
        <ul>
            <li>
            <input type="hidden" name="question[id][]" value="'. $sub['id'] .'" />
            <input type="hidden" name="question[parent][]" value="'. $question['id'] .'" />
            </li>
        </ul>
        <ul>
            <li>
            <input type="hidden" name="question[id][]" value="'. $sub['id'] .'" />
            <input type="hidden" name="question[parent][]" value="'. $question['id'] .'" />
            </li>
        </ul>
    </li>

</ul> 
```

我正在使用 jQuery sortable 对嵌套列表进行排序，现在在对它们进行排序之后，我需要将适当的父 ID 保存到子列表中的每个项目中。

理论上每个子问题的父 id 是第二个最接近的 ul 的第一个输入的值。另外，如果没有父ul，那么我想将父id设置为0。如何找到它？这是我到目前为止所拥有的：

```
$('#reorder_form').submit(function(){
    $('li').each(function() {
        $id = $(this).closest('ul').closest('li').find("input[name='question[id]']").val();
        if(typeof($id) == 'undefined') $id=0;
        $(this).find("input[name='question[parent]']").val($id);
    });
}); 
```

我不是 100% 确定这就是你正确循环每个输入的方式，因为我每个输入两次。也许我应该循环遍历 li 的？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-11T15:14:45.010

这是保存任意数量的 li 的 id 和父 id 的代码，该 li 包含任意数量的 ul，包含任意数量的 li 以及来自问题的相应 html。我承认这有点骇人听闻，但这是我想出的。希望它可以帮助某人。

```
 $('#reorder_form').submit(function(){
            $('li input[name^="question[parent]"]').each(function() {
                $ul = $(this).closest('ul').parent().closest('ul');
                $attr = $ul.attr("class");
                if(typeof($attr) == 'undefined')
                    $id=0;
                else
                    $id = $ul.find("li input[name^='question[id]']").val();
                $(this).val($id);

            });
        }); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-10T13:12:03.733

你想上升到最近的 li，然后再上升到最近的 li，然后再回到输入。要真正语义化：

```
$id = $(this).closest('li').closest('li').find('input[name^="question[id]"]').first().val(); 
```

没有检查。我会在 jsfiddle 中执行此操作，但它似乎已损坏。

```
$('li input[name^="question[parent]"]').each(function() {
  var $id = $(this).closest('li').closest('li').find('input[name^="question[id]"]').val();
  if(typeof($id)=="undefined") $id=0; 
  $(this).val($id);
}); 
```

如果`.save`指向表单中的按钮，请注意，请记住（通常）提交表单的方法不止一种。`$('#theform').on('submit', function(){...});`是最好的方法。

还

```
if(typeof($id) == undefined) 
```

我很确定它总是会返回 false，因为 typeof 不会 == 未定义，它将是一个值，可能是“未定义”。

```
if(typeof($id) == "undefined") 
```

# android - 如何在 android 中更改缩放时的布局参数？

> ID：14258662
> 
> 赞同：3
> 
> 时间：2013-01-10T13:07:45.607
> 
> 标签：android, layout, pinch

你好开发者，我有一个相对的布局，里面有网页视图，所以我想集成捏缩放和捏缩放我想改变网页视图的高度和宽度参数乘以当前的比例因子，我尝试了很多类似的问题，但我无法捏网页视图。请向我推荐一些合适的工作示例。提前致谢

# wpf - 在 WPF 数据网格中实现“拖放”功能

> ID：14258663
> 
> 赞同：3
> 
> 时间：2013-01-10T13:07:55.200
> 
> 标签：wpf, wpfdatagrid

我们正在开发一个利用数据网格的应用程序。网格的大部分功能将是相当标准的东西 - 设置单元格样式、单元格内编辑、排序等。然而，一个要求是提供“拖放”功能，如 Excel。这是您在一行中选择一个或多个单元格的地方，然后在它们周围绘制一个粗边框。边框的右下角有一个小正方形，当您将其向下拖动时，Excel 会将选定的单元格值复制到下面的行中。

使用 .Net WPF 数据网格尝试和实现这听起来像是一件可怕的事情（也没有商业数据网格组件提供此功能）。有没有人开发了类似的功能，或者提出了可能的方法来实现这一点？普通的旧复制和粘贴不是一种选择！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2015-10-08T14:33:11.853

以下是在数据网格中围绕所选单元格绘制粗线的一些提示：

*   订阅数据网格的 SelectedCellsChanged 事件。
*   在事件处理程序中，如果选定单元格的数量 > 0 并且还没有（缓存的）装饰器层，则获取数据网格的装饰器层并向其添加自定义装饰器。通过装饰器的构造函数传递数据网格。如果选定单元格的数量 == 0 并且缓存的 adornerlayer ！= null，则从 adorner 层中删除 adorner。在事件处理程序结束时，调用 adornerLayer.Update(datagrid)
*   使用以下 CustomAdorner 类：

    ```
    public class DataGridSelectionAdorner : Adorner {
        private readonly DataGrid datagrid;
        private readonly SolidColorBrush backgroundBrush = new SolidColorBrush(Color.FromArgb(30, 0, 0, 0));
        readonly Pen pen = new Pen(new SolidColorBrush(Colors.Black), 1);
        private readonly Dictionary<DataGridCellInfo, int[]> cellInfoToTableRowAndColumn = new Dictionary<DataGridCellInfo, int[]>();

        public DataGridSelectionAdorner(UIElement adornedElement)
            : base(adornedElement) {
            datagrid = (DataGrid)adornedElement;
            pen.DashStyle = new DashStyle(new[] { 3.0, 3.0 }, 0);
            IsHitTestVisible = false;
        }

        protected override void OnRender(DrawingContext drawingContext) {
            ItemContainerGenerator generator = datagrid.ItemContainerGenerator;
            IEnumerable<int> rows =
                    datagrid.SelectedCells.Select(c =>
                        generator.IndexFromContainer(
                            generator.ContainerFromItem(c.Item)
                        )
                    );
            IEnumerable<int> columns = datagrid.SelectedCells.Select(
                c => c.Column.DisplayIndex
            );
            int minRow = rows.Min();
            int maxRow = rows.Max();
            int minColumn = columns.Min();
            int maxColumn = columns.Max();

            foreach (var cell in datagrid.SelectedCells) {
                int row = generator.IndexFromContainer(generator.ContainerFromItem(cell.Item));
                int column = cell.Column.DisplayIndex;
                cellInfoToTableRowAndColumn[cell] = new[] { row, column };
            }

            var topLeft = cellInfoToTableRowAndColumn.First(c => c.Value[0] == minRow && c.Value[1] == minColumn).Key;
            var bottomRight = cellInfoToTableRowAndColumn.First(c => c.Value[0] == maxRow && c.Value[1] == maxColumn).Key;

            var topLeftCell = GetDataGridCell(topLeft);
            var bottomRightCell = GetDataGridCell(bottomRight);

            const double marginX = 4.5;
            const double marginY = 3.5;
            Point topLeftPoint = topLeftCell.TranslatePoint(new Point(marginX, marginY), datagrid);
            Point bottomRightPoint = bottomRightCell.TranslatePoint(
                new Point(bottomRightCell.RenderSize.Width - marginX, bottomRightCell.RenderSize.Height - marginY),
                datagrid
            );

            drawingContext.DrawRectangle(backgroundBrush, pen, new Rect(topLeftPoint, bottomRightPoint));
        }

        private static DataGridCell GetDataGridCell(DataGridCellInfo cellInfo) {
            var cellContent = cellInfo.Column.GetCellContent(cellInfo.Item);
            if (cellContent != null)
                return (DataGridCell)cellContent.Parent;
            return null;
        }
    } 
    ```

# r - 从基于状态的序列创建基于转换的序列

> ID：14258667
> 
> 赞同：4
> 
> 时间：2013-01-09T23:07:51.033
> 
> 标签：r

我有一个包含顺序数据的数据框：
`df <- data.frame(
t1=c("e","e","e"),t2=c("e","e","u"),t3=c("e","e","u"),t4=c("e","u","e"),t5=c("e","u","e"))`

看起来像

```
> df
  t1 t2 t3 t4 t5
1  e  e  e  e  e
2  e  e  e  u  u
3  e  u  u  e  e 
```

我想将此具有状态序列的数据帧转换为具有转换序列的数据帧，如下所示：

```
> dfNew
   t1  t2  t3  t4  t5
1  se  ee  ee  ee  ee
2  se  ee  ee  eu  uu
3  se  eu  uu  ue  ee 
```

其中“s”表示起始状态。

我会很感激你的帮助。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-10T08:17:58.787

这是创建转换数据框的一种方法：

```
setNames(as.data.frame(t(apply(df, 1, 
                               function(x) 
                                 paste(c("s", head(x, -1)), x, sep = "")))),
                                                                       names(df))

  t1 t2 t3 t4 t5
1 se ee ee ee ee
2 se ee ee eu uu
3 se eu uu ue ee 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-09T23:42:02.327

使用来自的示例数据`TraMineR::seqetm`

```
data(actcal)
actcal.seq <- seqdef(actcal,13:24,
        labels=c("FullTime", "PartTime", "LowPartTime", "NoWork")) 
```

您的示例似乎是`print.stslist`用于`seqconc`创建序列的输出

所以我将手动创建这个序列

```
actcal.seqconc <- seqconc(actcal.seq) 
```

这是一个矩阵。所以我们可以只应用这个函数来拆分`-`然后根据需要与过渡状态重新组合。执行此操作的函数如下：

```
transitions <- function(x, start = 'S') {

 x <- unlist(strsplit(x, '-')
 paste0(c(start, head(x, -1)), x, collapse = '-')
}

actcal.tseq <- as.matrix(apply( actcal.seqconc, 1, transitions)) 
```

如果您想要状态之间的转换率，请使用`seqtrate`

```
seqtrate(actcal.seq)
 [>] computing transition rates for states A/B/C/D ...
            [-> A]      [-> B]      [-> C]      [-> D]
[A ->] 0.986991870 0.005203252 0.001084011 0.006720867
[B ->] 0.009700665 0.970343681 0.007760532 0.012195122
[C ->] 0.005555556 0.014814815 0.934259259 0.045370370
[D ->] 0.008705580 0.006279435 0.014985015 0.970029970 
```

# eclipse - maven-compiler-plugin 3.0 坏了

> ID：14258671
> 
> 赞同：1
> 
> 时间：2013-01-10T13:08:06.040
> 
> 标签：eclipse, maven, groovy

我有一个使用 gmaven 构建的纯 groovy 项目，但想将其切换为使用 groovy eclipse 编译器。

所以我按照[这里](http://docs.codehaus.org/display/GROOVY/Groovy-Eclipse+compiler+plugin+for+Maven)的信息。那行得通。但是有一个新的 3.0 版本的 maven-compiler-plugin。当我切换到那个版本时，它会显示源文件夹被添加到列表中以进行编译，但然后退出说一切都是最新的。

所以我拿了示例项目（链接页面的底部）并按原样编译它......没问题。将那个简单的项目切换到 maven-compiler-plugin v3.0 ......它无法以相同的方式构建任何东西。

只有我吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-11T01:55:26.087

尝试在 maven-compiler-plugin 的配置部分中将以下内容添加到您的 pom 中：

```
<includes>
  <include>**/*.groovy</include>
  <include>**/*.java</include>
</includes>
<testIncludes>
  <testInclude>**/*.groovy</testInclude>
  <testInclude>**/*.java</testInclude>
</testIncludes> 
```

这是自 3.0 以来出现的问题。

# python - 为什么我需要配置一个 postgresql sqlalchemy 引擎？

> ID：14258680
> 
> 赞同：1
> 
> 时间：2013-01-10T13:08:46.117
> 
> 标签：python, postgresql, sqlalchemy

```
>>> import subprocess, sqlalchemy
>>> engine = sqlalchemy.create_engine("postgresql+psycopg://myuser:secret@localhost/mydb")
>>> subprocess.Popen(['/usr/bin/dropdb', '-U', 'myuser', 'mydb'])
dropdb: database removal failed: ERROR:  database "openstack_citest" is being accessed by other users                                                        
DETAIL:  There are 1 other session(s) using the database. 
```

我检查了哪个用户正在使用数据库，并且是试图删除它的用户。

我可以通过`engine.dispose()`拨打电话来解决这个问题，但我不知道为什么。首先不应该有任何打开的数据库连接。

在没有调用的情况下尝试与`mysql`后端工作相同的事情`dispose()`可以很好地删除数据库。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-10T13:35:35.390

这是[设计使然](http://www.postgresql.org/docs/devel/static/sql-dropdatabase.html)：

> DROP DATABASE 删除数据库。[...]。此外，当您或其他任何人连接到目标数据库时，它无法执行

# python - Python 线程

> ID：14258689
> 
> 赞同：1
> 
> 时间：2013-01-10T13:09:28.080
> 
> 标签：python, multithreading, python-multithreading

我正在尝试创建一个简单的程序，该程序使用套接字等待文件，然后将其输出返回到另一个线程上的文本字段。

我做了一些研究，我知道线程的基础知识是如何工作的，但我不明白多个线程如何相互连接。

我的问题是该`WindowManager.addText`函数仅在类本身的事件上更新`WindowManager`，而不是从`ConnectionManager`类中更新。我该如何解决这个问题，以便每次`WindowManager.addText`在另一个线程上调用它都会立即更新？

我有一个`WindowManager`类，它将一个字符串保存到一个文本字段（用 GTK 加载）：

```
class WindowManager:
    def __init__(self):
        #Load the window here, not relevant
        self.textBuffer = self.messagePanel.get_buffer()
        self.lock = threading.Lock()

    def addText(self, text, *args):
        self.lock.acquire()        
        logging.debug('Waiting for lock')
        try:
            logging.debug('Acquired lock')
            self.textBuffer.insert_with_tags_by_name(self.textBuffer.get_end_iter(), text, *args)
        finally:
            self.lock.release() 
```

现在我`ConnectionManager`这里也有一个类，它加载连接线程：

```
class ConnectionManager:
    def __init__(self, windowManager):
        self.ping = PingThread(windowManager)
        self.ping.setDaemon(True)
        self.ping.start() 
```

最后我得到了`PingThread`实际连接线程的类，在这个例子中我随机调用线程：

```
class PingThread(threading.Thread):
    def __init__(self,  window, group=None, target=None, name=None, verbose=None):
        threading.Thread.__init__(self, group=group, target=target, name=name, verbose=verbose)
        self.window = window

    def run(self):
        while True:
            self.window.addText("Test")
            time.sleep(random.randrange(1,10)) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-10T13:43:09.047

在 Stack Overflow 上进行了一番搜索后，我找到了答案。我需要做的就是通过将其放在代码的开头来初始化线程：`GObject.threads_init()`

# python - 使用 lxml 从 html 中解析字段

> ID：14258702
> 
> 赞同：1
> 
> 时间：2013-01-10T13:10:05.180
> 
> 标签：python, lxml

我试图解析来自 url 调用的 html 输出，但我发现自己在努力解决如何让它工作。

我使用以下代码：

```
 import urllib2
    import base64 as b64
    import lxml.html as LH

    request = urllib2.Request('http://%s%s' % (fInput[1], fInput[2]))
    base64string = b64.encodestring('%s:%s' % (fInput[3], fInput[4])).replace('\n', '')
    request.add_header("Authorization", "Basic %s" % base64string)
    response = urllib2.urlopen(request)
    html = response.read()
    root = LH.fromstring(html)
    sibling_content = lambda x: [b.getparent().getnext().text_content() for b in root.cssselect("td b:contains('{0}')".format(x))]
    fields = ['groupList','namelist']

    for result in zip(*[sibling_content(field) for field in fields]):
        print result 
```

我打印输出时的结果是：

```
('Admins', '\nme\nmyself\nirene')('guests', '\nhin\nhinself\nbacon') 
```

适合我需要的输出是有一个这样的数组，所以我可以将它插入数据库：

```
['Admins', 'me','myself','nirene'],['guests', 'hin','hinself','bacon'] 
```

接下来，我发送 HTTP 请求返回的 Html：

```
<BODY bgcolor="#dddddd">
   <TABLE bgcolor="#dddddd" border="1">
      <TR>
         <TD valign="top"><B>MainList</B></TD>
         <TD>
            <TABLE>
               <TR>
                  <TD>
                     <TABLE bgcolor="#dddddd" border="1">
                        <TR>
                           <TD valign="top"><B>groupList</B></TD>
                           <TD>Admins</TD>
                        </TR>
                        <TR>
                           <TD valign="top"><B>namelist</B></TD>
                           <TD>
                              <TABLE>
                                 <TR>
                                    <TD>me</TD>
                                 </TR>
                                 <TR>
                                    <TD>myself</TD>
                                 </TR>
                                 <TR>
                                    <TD>irene</TD>
                                 </TR>
                              </TABLE>
                           </TD>
                        </TR>
                     </TABLE>
                     <TABLE bgcolor="#dddddd" border="1">
                        <TR>
                           <TD valign="top"><B>groupList</B></TD>
                           <TD>guests</TD>
                        </TR>
                        <TR>
                           <TD valign="top"><B>namelist</B></TD>
                           <TD>
                              <TABLE>
                                 <TR>
                                    <TD>hin</TD>
                                 </TR>
                                 <TR>
                                    <TD>hinself</TD>
                                 </TR>
                                 <TR>
                                    <TD>bacon</TD>
                                 </TR>
                              </TABLE>
                           </TD>
                        </TR>
                     </TABLE>
                  </TD>
               </TR>
            </TABLE>
         </TD>
      </TR>
   </TABLE>
</BODY> 
```

关于如何让这个工作的任何想法？

提前致谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-10T13:14:35.927

我对你的问题有点困惑。你只是问怎么转

```
('Members', '\nme\nmyself\nirene')('Members_2', '\nhin\nhinself\nbacon') 
```

进入

```
['Members', 'me','myself','nirene'],['Members_2', 'hin','hinself','bacon'] 
```

这很容易：

```
>>> x = [('Members', '\nme\nmyself\nirene'), ('Members_2', '\nhin\nhinself\nbacon')]
>>> [[y[0]] + y[1].splitlines()[1:] for y in x] 
```

* * *

仅供参考，您应该看看[`requests`](http://docs.python-requests.org/en/latest/)Python 模块。而不是所有的`urllib2`摘要，它让你只写

```
requests.get(url, auth=(user, pass)) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-10T14:32:39.250

使用`xpath`：

```
root=LH.fromstring(html)
[t.xpath('.//td[not(contains(.,"\n"))]/text()')
    for t in root.xpath('.//table[@bgcolor="#dddddd"]')] 
```

*出去：*

```
[['Admins', 'me', 'myself', 'irene'], ['guests', 'hin', 'hinself', 'bacon']] 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-10T13:14:11.647

我认为只是从文本内容中去除空格就可以了。因此，在您的代码中，您可以在此行中添加一个条形调用：

兄弟内容 = lambda x: [b.getparent().getnext().text_content() **.strip()** for b in root.cssselect("td b:contains('{0}')".format(x))]

# java - Java：查找文件的最后一行是否为空

> ID：14258704
> 
> 赞同：2
> 
> 时间：2013-01-10T13:10:06.863
> 
> 标签：java, file-io, line

我有一个关于我需要用 Java 完成的学校作业的问题。我需要从文件中加载数据并检查这些文件中的错误。

我使用 a 读取文件，该文件`bufferedReader`在文件末尾之前运行良好：如果该行为空，它将忽略最后一行。

我知道如何检查空行，但最后一行根本没有`readLine()`使用`bufferedReader`.

重要的是我知道最后一行是否为空，因为它必须是空的。如果空行不存在，它应该给出一个错误。

长话短说，我需要一种方法来区分以下情况（`CRLF`行尾在哪里）：

**情况1（正确）：**

```
line x CRLF
line y CRLF 
```

**情况2（错误）：**

```
line x CRLF
line y 
```

这两种情况都会`readline()`在第 y 行之后返回 null。

我正在计算文件的行数，所以如果我有一个行计数器（注意：那个计数器也必须计算那个空行，我发现的所有行都没有计算）

这些文件也包含空行，如果这对我需要的代码有任何影响（这些行被正确检测到，因为它们`EOF`不在这些行上）

请注意，该程序可以在有或没有最后一行的情况下工作，纯粹是分配告诉我如果它不存在就给出一个错误。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-10T13:17:00.653

如果您想确定最后一行是否有 CRLF，您可以从最后读取。

```
public static boolean lastLineisCRLF(String filename) {
    RandomAccessFile raf = null;
    try {
        raf = new RandomAccessFile(filename, "r");
        long pos = raf.length() - 2;
        if (pos < 0) return false; // too short
        raf.seek(pos);
        return raf.read() == '\r' && raf.read() == '\n';
    } catch (IOException e) {
        return false;
    } finally {
        if (raf != null) try {
            raf.close();
        } catch (IOException ignored) {
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-10T13:17:04.010

**您的 "situation 1" 中没有空行**。`CRLF`属于 y 行，之后什么都没有（这也是告诉`readline()`你的）。只是在编辑器中，这告诉光标向下移动一行，所以它看起来像一个新的空行，但实际上这只是编辑器将字符解释为提示显示`CRLF`的“视错觉”`CR/LF`光标换行。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-10T13:18:19.767

```
while ((tmp = br.readLine()) != null) {
    strLine = tmp;
}

String lastLine = strLine; 
```

这将为您提供文件的最后一行。为什么不检查最后一行是否为空？

# php - 如何使用 php dom 获取页面样式表的内容？

> ID：14258708
> 
> 赞同：0
> 
> 时间：2013-01-10T13:10:15.643
> 
> 标签：php, regex, parsing, dom

我是 php 新手，谁能建议如何使用[php dom](http://php.net/manual/en/book.dom.php)获取页面样式表的内容，以便它们出现在页面上？

假设在页面的开头是：

```
<link rel="stylesheet" href="resources/css/reset.css" type="text/css" media="screen"/>
<link rel="stylesheet" href="resources/css/style.css" type="text/css" media="screen"/>
<link rel="stylesheet" href="resources/css/invalid.css" type="text/css" media="screen"/>
<link rel="stylesheet" href="resources/css/blue.css" type="text/css" media="screen"/> 
```

如何获取这些样式表的内容？

**更新：**

```
$url = 'http://wordpress.stackexchange.com/questions/60792/replace-image-attributes-for-lazyload-plugin-data-src';
$html = file_get_contents($url);

$xml = new SimpleXMLElement($html);
/* Search for <link rel=stylesheet> */
$result = $xml->xpath('link[@rel="stylesheet"]');

foreach($result as $node) { 
    echo $node->{'@attributes'}->href . "\n";
}
exit; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-10T13:20:09.967

使用 dom 的 simplexml 是否可行？

[http://php.net/manual/en/simplexmlelement.xpath.php](http://php.net/manual/en/simplexmlelement.xpath.php)

```
<?php

$url = 'http://wordpress.stackexchange.com/questions/60792/replace-image-attributes-for-lazyload-plugin-data-src';
$url_parts = parse_url($url);

$html = file_get_contents($url);

$doc = new DOMDocument();
// A corrupt HTML string
$doc->loadHTML($html);

$xml = simplexml_import_dom($doc);

/* Search for <link rel=stylesheet> */
$result = $xml->xpath('//link[@rel="stylesheet"]');

foreach($result as $node) { 
    $link = $node->attributes()->href;

    if (substr($link, 0, 4) == 'http') {
        // nothing to do
    } else if (substr($link, 0, 1) == '/') {
        $link = $url_parts['scheme'] . '://' . $link;
    } else {
        $link = $url_parts['scheme'] . '://' . dirname($url_parts['scheme']) . '/' . $link;
    }

    echo '--> ' . $link . "\n";
}
exit; 
```

# android - Android - SQLite 数据库浏览器未正确更新

> ID：14258709
> 
> 赞同：1
> 
> 时间：2013-01-10T13:10:22.170
> 
> 标签：android, sqlite

我有一个使用 SQLite 数据库浏览器创建的数据库的 android 应用程序，如本博客所示：[http ://www.reigndesign.com/blog/using-your-own-sqlite-database-in-android-applications/](http://www.reigndesign.com/blog/using-your-own-sqlite-database-in-android-applications/)

首先，我创建了一个包含两个表的数据库，其中一个表有一个条目，只是为了检查我是否正确创建了数据库。这行得通。

之后，我用另外 10 个条目填充其中一个表，保存，然后将数据库复制到资产文件夹（覆盖前一个），运行应用程序，然后查询第 2 到第 10 个条目。该应用程序是强制关闭给我 CursorIndexOutOfBounds 错误。

由此，我推断该应用程序无法使用我创建的新数据库并且仍在使用旧数据库（已被覆盖）。

有没有办法解决和/或解决这个问题？应用程序似乎正在使用它接收到的数据库的第一个版本，即使该数据库已被新版本覆盖。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-10T15:48:48.080

听起来您的第一个数据库，只有一个条目的数据库，仍然存在于 /data/data/your-package-name 下的应用程序数据库文件夹中（在您的 android 设备上）。如果设备上不存在数据库，该教程的代码只会从 assets 文件夹中复制数据库（查看教程中的 checkDataBase() 方法）。因此，从 /data/data/your-package-name 中删除数据库（使用代码或使用 root 访问权限），确保更新的数据库文件位于 assets 文件夹中，然后再次运行它。这将确保资产文件夹中的数据库被复制到设备上。

此外，请确保 DB_PATH 等于`context.getApplicationInfo().dataDir + "/databases/"`而不是`"/data/data/YOUR_PACKAGE/databases/"`.

# mysql - SQL - 比较 1 亿张表上的文本（组合）

> ID：14258710
> 
> 赞同：1
> 
> 时间：2013-01-10T13:10:26.893
> 
> 标签：mysql, sql, oracle

我有个问题。我有一张表，里面有大约 80-1 亿条记录。在该表中，我有一个字段，该字段存储了 3 到 16 个不同的“组合”（varchar）。组合是一个 4 位数字、一个冒号和一个 char(AE)，. 例如： `'0001:A/0002:A/0005:C/9999:E'`。在这种情况下，有 4 种不同的组合（最多可以有 16 种）。该字段在表的每一行中，绝不为空。

现在的问题：我必须遍历表，找到每一行，看看它们是否相似。示例行：

```
0001:A/0002:A/0003:C/0005:A/0684:A/0699:A/0701:A/0707:A/0709:A/0710:D/0711:C/0712:A/0713:A
0001:A/0002:A/0003:C
0001:A/0002:A/0003:A/0006:C
0701:A/0709:A/0711:C/0712:A/0713:A 
```

如您所见，这些行中的每一行都与其他行相似（在某种程度上）。这里需要做的是当您`'0001:A/0002:A/0003:C'`通过程序（或 SQL 中的参数）发送时，它会检查每一行并查看它们是否具有相同的“组”。现在这里的问题是它必须双向进行，并且必须“快速”完成，并且 SQL 需要以某种方式比较它们。

因此，当您发送时，`'0001:A/0002:A/0003:C/0005:A/0684:A/0699:A/0701:A/0707:A/0709:A/0710:D/0711:C/0712:A/0713:A'`它必须找到所有有 3-16 个相同组合的字段并返回行。这 3-16 可以通过参数指定，但问题是您需要找到所有可能的组合，因为您可以发送`'0002:A:/0711:C/0713:A'`，并且如您所见，您可以`0002:A`作为第一个参数发送。

但是您不能有索引，因为组合可以在字符串中的任何位置，并且您可以发送未“附加”的不同组合（中间可能有不同的组合）。

因此，发送`'0001:A/0002:A/0003:C/0005:A/0684:A/0699:A/0701:A/0707:A/0709:A/0710:D/0711:C/0712:A/0713:A'`必须返回具有相同 3-16 个字段的所有字段，并且必须双向发送，如果您发送“0001:A/0002:A/0003:C”，它必须找到上面的行 + 相似的行（所有包含所有参数）。

我尝试过的一些事情/选项：

*   对所有发送组合执行 LIKE 是不切实际的 + 太慢了
*   不能提供字段全索引搜索（不知道具体原因）
*   少数可行的方法之一是为字段制作一些“散列”类型的编码，通过程序计算它，并搜索所有相同的“散列”（不知道你会怎么做，因为散列会为相似的文本生成不同的组合，也许是一些专门为此编写的哈希
*   创建一个新字段，计算/写入（可以在插入时完成）所有可能的组合并通过 SQL/程序检查它们是否具有相同的组合百分比，但我不知道如何存储 10080 个组合（如果是 16 ) 有效地转换为“varchar”，或者通过一些哈希码 + 知道它们中的哪一个是熟悉的。

还有一个问题，这个表几乎 24/7 都在使用，在 SQL 中进行组合检查它们是否相同太慢了，因为表太大了，可以通过程序或其他东西来完成，但我没有关于如何将其存储在新行中的任何线索，您会以某种方式知道它们是相同的。您可能会计算组合，通过一些哈希码或每行插入的东西存储它们，通过程序计算“哈希”，并检查表，如：

```
SELECT * FROM TABLE WHERE ROW = "a346adsad" 
```

参数将通过程序发送到哪里。这个脚本需要非常快地执行，不到 1 分钟，因为表中可能有新的插入，您需要检查。

这样做的重点是查看 SQL 中是否已经存在任何类似的组合，并阻止任何对于插入“相似”的新组合。

我已经处理这个问题 3 天了，没有任何可能的解决方案，最接近的是不同类型的插入/哈希，但我不知道它是如何工作的。

预先感谢您提供任何可能的帮助，或者如果这是可能的！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-10T13:15:53.257

`it checks every row and see if they have the same "group".`

恕我直言，如果**组**是您的数据结构的基本元素，那么您的数据库结构是有缺陷的：它应该将每个组都放在自己的单元格中进行规范化。您描述的结构清楚地表明您在字段中存储了一个复合值。

我会把桌子撕成3个：

*   一个用于组序列的“标题”信息
*   一个给团体本身
*   两者之间的连接表

这些方面的东西：

```
CREATE TABLE GRP_SEQUENCE_HEADER (
    ID BIGINT PRIMARY KEY,
    DESCRIPTION TEXT
  );

CREATE TABLE GRP (
    ID BIGINT PRIMARY KEY,
    GROUP_TXT CHAR(6)
  );

CREATE TABLE GRP_GRP_SEQUENCE_HEADER (
    GROUP_ID BIGINT, 
    GROUP_SEQUENCE_HEADER_ID BIGINT,
    GROUP_SEQUENCE_HEADER_ORDER INT, /* For storing the order in the sequence */
    PRIMARY KEY(GROUP_ID, GROUP_SEQUENCE_HEADER_ID)
  ); 
```

（当然，添加外键，最重要的是必要的索引）

然后，您只需将输入分成组，并在正确索引的表上执行简单查询。

此外，您可能还会通过不存储重复项来节省磁盘空间......

用于查找“相似”序列 ID 的示例查询：

```
SELECT ggsh.GROUP_SEQUENCE_HEADER_ID,COUNT(1)
FROM GRP_GRP_SEQUENCE_HEADER ggsh  
JOIN GRP g ON ggsh.GROUP_ID=g.GROUP_ID
WHERE g.GROUP_TXT IN (<groups to check for from the sequence>)
GROUP BY gsh.ID
HAVING COUNT(1) BETWEEN 3 AND 16 --lower and upper boundaries 
```

这将返回与当前序列相似的所有标头 ID。

**编辑** 重新考虑一下，您甚至可以将小组分成两部分，但据我所知，您总是要处理完整的小组，因此似乎没有必要。

**EDIT2**也许如果你想进一步加快这个过程，我建议使用双射将序列转换为数字数据。例如，将前 4 个数字计算为整数，将其向左移动 4 位（乘以 16，但更快），并将字符的十六进制值添加到最后一个位置。

例子：

```
0001/A --> 1 as integer, A is 10, so 1*16+10 =26
...
0002/B --> 2 as integer, B is 11, so 2*16+11 =43
...
0343/D --> 343 as integer, D is 13, so 343*16+13 =5501
...
9999/E --> 9999 as integer, E is 14, so 9999*16+14 =159998 (max value, if I understood correctly) 
```

DB 可以更有效地处理数值，因此这应该会带来更好的性能 - 当然是使用新结构。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-10T13:41:45.587

所以基本上你想在一分钟内对*80-1 亿行执行复杂的字符串操作！*哈哈哈，不错！

哦，等等，你是认真的。

您不能希望即时进行这些搜索。阅读 Joel Spolsky 关于[回归基础](http://www.joelonsoftware.com/articles/fog0000000319.html)的文章以了解原因。

您需要做的是将这些 80-1 亿个字符串放入自己的表中，分解成那些离散的标记，即`'0001:A/0002:A/0003:C'`分解成三个记录（可能是两列 - 你对它们之间的关系有点模糊） th etokens 的数字和字母组成部分）。这些记录可以被索引。

然后，只需对搜索字符串进行标记并选择将搜索标记连接到新表即可。不确定它的性能如何：这取决于您拥有多少不同的令牌。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-10T13:42:59.027

正如人们所评论的那样，您将从规范化数据中受益匪浅，但是您不能作弊并使用密钥创建一个临时表并在“/”上爆炸您的列，因此您可以从

```
KEY | "0001:A/0002:A/0003:A/0006:C"
KEY1| "0001:A/0002:A/0003:A" 
```

到

```
KEY | 0001:A
KEY | 0002:A
KEY | 0003:A
KEY | 0006:C
KEY1| 0001:A
KEY1| 0002:A
KEY1| 0003:A 
```

这将允许您开发类似以下的查询（未经测试）：

```
SELECT
    t1.key
    , t2.key
    , COUNT(t1.*)
FROM
    temp_table t1
    , temp_table t2
    , ( SELECT t3.key, COUNT(*) AS cnt FROM temp_table t3 GROUP BY t3.key) t4
WHERE
    t1.combination IN ( 
        SELECT 
            t5.combination 
        FROM 
            temp_table t5 
        WHERE 
            t5.key = t2.key)
    AND t1.key <> t2.key
HAVING
    COUNT(t1.*) = t4.cnt 
```

那么返回两个键，其中 key1 是键的适当子集？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-11T09:34:58.977

我想我可以推荐建立特殊的“索引”。它会很大，但您将获得超快速的结果。

让我们将此任务视为搜索一组符号。有设计条件。这些符号由模式“NNNN:X”组成，其中 NNNN 是数字 [0001-9999]，X 是字母 [AE]。所以我们在字母表中有 5 * 9999 = 49995 个符号。此字母表的最大单词长度为 16。

我们可以为每个单词构建其符号组合的集合。例如，单词“abcd”将有以下组合：

```
abcd
abc
ab
a
abd
acd
ac
ad
bcd
bc
b
bd
cd
с
d 
```

由于符号是按单词排序的，因此我们只有 2^N-1 种组合（4 个符号对应 15 个）。对于 16 个符号的单词，有 2^16 - 1 = 65535 种组合。

因此，我们制作了一个额外的索引组织表，如下所示

```
create table spec_ndx(combination varchar2(100), original_value varchar2(100)) 
```

以开销为代价，性能将非常出色 - 在最坏的情况下，原始表中的每条记录将有 65535 条“索引”记录。
因此，对于 1 亿张桌子，我们将获得 6 万亿张桌子。但是，如果我们有短值，“特殊索引”的大小会大大减少。

# r - 为什么在傅里叶基中周期 = 2 的曲线上应用函数 pca 时存在非半正定前导次要？

> ID：14258711
> 
> 赞同：2
> 
> 时间：2013-01-10T13:10:28.750
> 
> 标签：r, pca

我正在使用 R 的 fda 包来生成随机曲线样本。更具体地说，我正在使用具有周期变化的傅立叶级数来表示我需要的特定结构。定义样本工作正常，但是当基函数的数量足够大并且我想在样本上应用“pca.fd”时遇到问题。错误是：

```
"leading minor of order [... e.g. 24] is not semi positive definite." 
```

我想知道为什么会发生这种情况，以及是否有办法规避它。显然，这是一个数字或统计问题，而不是纯粹的编码问题。但是我分配的所有系数都是独立同分布的，并且傅立叶基提供了正交函数。此外，当时间段设置为其默认级别时，一切正常。那么 period=2 出了什么问题？

我很高兴有任何关于这个问题的提示。非常感谢您提前！

这是一些重现错误的代码：

```
nc <- 40 # Number of curves  
nb <- 101 # Number of basis functions  
coefm <- matrix(rnorm(nb*nc),nrow=nb,ncol=nc) # random coeficient matrix

# basis function object with "normal" period:  
mybase = create.fourier.basis(rangeval=c(0,1), nbasis=nb, period=1) 

# generate the sample of curves:  
fdobj <- fd(coefm,mybase) 

# Principal component analysis:  
pca.fd(fdobj) # should work, even though the number of basis functions is large.

# Now: change the period of the fourier basis object:  
mybase = create.fourier.basis(rangeval=c(0,1), nbasis=nb, period=2)  
fdobj <- fd(coefm,mybase)  

pca.fd(fdobj) # Here is the error. However, this does not happen with nb<20 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2017-07-25T08:32:07.643

不幸的是，没有简单直接的答案。我联系了 fda 包的维护者，在他们调查了这个问题后，让我知道我所做的事情对于我生成的曲线的影响非常糟糕。显然，曲线在其范围的某些部分非常相似，以至于 pca 遇到了某种数字困难。所以要结束这个问题，我不再期待更好的答案了。

# jsf-2 - JSF 渲染填充间隙

> ID：14258712
> 
> 赞同：0
> 
> 时间：2013-01-10T13:10:30.593
> 
> 标签：jsf-2

当jsf不渲染组件时，如何填补组件应该放置的空白。组件刚刚消失，其他组件确实填充了它的空间。我只需要把它的空间留空

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-10T13:15:53.967

创建一个面板并将您的组件放置在面板内。给面板适当的高度和宽度。这样即使里面的组件没有渲染，空间仍然被面板填充。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-10T13:49:06.173

如果渲染不包含敏感的用户特定信息，如管理按钮（否则这个问题可能没有意义），您也可以只使用 CSS`visibility`属性。

```
<h:someComponent ... styleClass="#{bean.show ? '' : 'invisible'}" /> 
```

和

```
.invisible {
    visibility: hidden;
} 
```

这样，它仍然会渲染输出并占用所需的空间，但仍然不可见（顺便说一下，这与众所周知`display: none`的完全不占用空间的区别）。请注意，这种方式还可以通过 JavaScript 完全在客户端切换可见性。

# ruby-on-rails - 可以使用 Ruby $SAFE 级别来对抗 Rails 漏洞吗？

> ID：14258719
> 
> 赞同：3
> 
> 时间：2013-01-10T13:11:08.080
> 
> 标签：ruby-on-rails, ruby, security

Rails 漏洞（例如[CVE-2013-0155](https://groups.google.com/group/rubyonrails-security/browse_thread/thread/b75585bae4326af2)和[CVE-2013-0156）](https://groups.google.com/group/rubyonrails-security/browse_thread/thread/eb56e482f9d21934)可能允许用户运行从不受信任的源（XML/YAML 参数）构建的任意代码。

使用 $SAFE=4 （比如说）是否可以防止此类攻击？如果是，Rails 开发人员是否使用这种安全级别？如果不是，为什么？

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-10T13:43:11.750

### 受污染的对象和受保护的操作

基本上，*$SAFE*级别归结为保护应用程序免受污染数据的影响，但魔鬼在细节中。[Ruby 编程](http://www.ruby-doc.org/docs/ProgrammingRuby/html/taint.html)有一整章涉及各个级别，值得您花时间阅读。

### Rails 应用程序通常需要受污染的数据

一般来说，一般的 Rails 应用程序都会引入受污染的输入。*params*散列被定义为污染，并且您的大多数用户交互都依赖于被污染的数据。假设您可以清理输入或使用框架功能来防止[批量分配漏洞](http://guides.rubyonrails.org/security.html#mass-assignment)，在大多数情况下，您的应用程序仍然需要与用户提供的数据进行交互才能真正有用。

### 安全权衡和其他考虑

*在*`$SAFE = 4`. _ _ 坦率地说，我从未见过有人“在野外”使用生产代码来做到这一点。即使可以，您也可能不得不跳过这么多圈来清除用户提供的数据、实例化 ActiveRecord 对象并执行文件系统写入（例如日志记录或文件上传），这可能不值得在安全性上进行权衡。

通过使用较低的*$SAFE*级别并依靠其他安全最佳实践来实现您的目标，您可能会得到更好的服务。这实际上仅取决于您要完成的工作。与所有安全控制一样，您的里程肯定会有所不同。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-10T13:20:16.100

当您的整个 Rails 将 $SAFE 设置为 4 时，您不会发生任何事情。因此，您的应用程序只能提供静态视图。至少这是我前段时间的经验。

# python - 如何使用 Python 查找文本文件中的所有 isbn？

> ID：14258720
> 
> 赞同：6
> 
> 时间：2013-01-10T13:11:09.483
> 
> 标签：python, parsing

我有一个`text_isbn`包含大量 ISBN 的文本文件。我想编写一个脚本来解析它并将其写入一个新的文本文件，每个 ISBN 编号都在一个新行中。

到目前为止，我可以编写用于查找 ISBN 的正则表达式，但无法进一步处理：

```
import re
list = open("text_isbn", "r")
regex = re.compile('(?:[0-9]{3}-)?[0-9]{1,5}-[0-9]{1,7}-[0-9]{1,6}-[0-9]') 
```

我尝试使用以下内容但出现错误（我猜列表格式不正确......）

```
parsed = regex.findall(list) 
```

如何进行解析并将其写入新文件（output.txt）？

这是文本的示例`text_isbn`

```
Praxisguide Wissensmanagement - 978-3-540-46225-5
Programmiersprachen - 978-3-8274-2851-6
Effizient im Studium - 978-3-8348-8108-3 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-01-10T13:13:46.877

怎么样

```
import re

isbn = re.compile("(?:[0-9]{3}-)?[0-9]{1,5}-[0-9]{1,7}-[0-9]{1,6}-[0-9]")

matches = []

with open("text_isbn") as isbn_lines:
    for line in isbn_lines:
        matches.extend(isbn.findall(line)) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-10T14:56:44.860

试试这个正则表达式（来自[正则表达式食谱](http://my.safaribooksonline.com/book/programming/regular-expressions/9780596802837/4dot-validation-and-formatting/id2990038)）：

```
import re
data = open("text_isbn", "r")
regex = "(?:ISBN(?:-1[03])?:? )?(?=[-0-9 ]{17}$|[-0-9X ]{13}$|[0-9X]{10}$)(?:97[89][- ]?)?[0-9]{1,5}[- ]?(?:[0-9]+[- ]?){2}[0-9X]$"

for l in data.readlines():
    match = re.search(regex, l)
    isbn = match.group()
    outfile.write('%s\n' % isbn) 
```

用您的样本数据进行测试。假设每一行只包含一个 isbn 数字

# paypal-ipn - PayPal IPN 回复网址是什么？

> ID：14258724
> 
> 赞同：0
> 
> 时间：2013-01-10T13:11:19.763
> 
> 标签：paypal-ipn

在其指南中，PayPal 指定了以下内容：

1.  API 操作在 PayPal 上发起付款。
2.  PayPal 向您的 IPN 侦听器发送一条消息，通知您该事件
3.  ***您的听众将完整的未更改消息发送回 PayPal***；消息必须以相同的顺序包含相同的字段，并以与原始消息相同的方式进行编码
4.  PayPal 会返回一个单词，如果消息来自 PayPal，则为 VERIFIED，如果与最初发送的消息有任何差异，则为 INVALID

我们需要发送步骤 3 中指定的回复的 URL 是什么？这是我们需要从 HTTP 请求中获取的东西吗？

指南：[https ://www.x.com/developers/paypal/documentation-tools/ipn/integration-guide/IPNIntro](https://www.x.com/developers/paypal/documentation-tools/ipn/integration-guide/IPNIntro)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-10T13:37:04.723

URL 显示在示例中。一个用于沙盒，一个用于真正的服务。将接收到的参数附加到 url 的末尾以完成它。

[https://www.sandbox.paypal.com/cgi-bin/webscr?cmd=_notify-validate&](https://www.sandbox.paypal.com/cgi-bin/webscr?cmd=_notify-validate&) ...

[https://www.paypal.com/cgi-bin/webscr?cmd=_notify-validate&](https://www.paypal.com/cgi-bin/webscr?cmd=_notify-validate&) ...

# asp.net-mvc - 是否可以在一个 ActionResult 中使用两个 ViewModel？

> ID：14258729
> 
> 赞同：0
> 
> 时间：2013-01-10T13:11:33.803
> 
> 标签：asp.net-mvc, asp.net-mvc-3

对不起，更深奥的问题，但我想知道如何处理我在控制器操作中遇到的一种问题。

通常，我会这样做：

```
public ActionResult Page1 (MyViewModel model)
{
...
return View(model);
} 
```

或者，如果我正在序列化，我可能会在控制器的早期执行此操作：

```
private MyViewModel myData ;
protected override void OnActionExecuting(ActionExecutingContext filterContext)
{
    var serialized = Request.Form["myData"];
    if (serialized != null)
    {
        myData = (MyViewModel)new MvcSerializer()
            .Deserialize(serialized, SerializationMode.Signed);
        TryUpdateModel(myData);
    }
    else
        myData  = (MyViewModel)TempData["myData"] 
            ?? new MyViewModel();
        TempData.Keep();
    }
protected override void OnResultExecuted(ResultExecutedContext filterContext)
{
    if (filterContext.Result is RedirectToRouteResult)
        TempData["myData"] = myData;
} 
```

然后在我的 ActionResult 我可以这样做：

```
public ActionResult Page2 (string this, string that)
{
...
return View(myData);
} 
```

但是现在我正在尝试（在任何一种情况下）插入一些以某种方式重新启动 ViewModel 的代码。例如，如果我在另一个控制器中有这个，我现在无法让它在上述两种情况下工作：

```
...
var model = new MyViewModel
    {
        MyRequests = myRequests //defined earlier in ActionResult 
        //(e.g., part of a radio button list)
    }; 
```

如果我将上述内容保留在我的 ActionResult 中，它将无法工作（`model`并且会`model`发生冲突）。即使我重命名它也是如此`myData`。

如果我尝试改为`return new MyViewModel`，则会收到转换错误（无法将 ViewModel 转换为 ActionResult）。

如果我将`var`其他名称命名为`model`or `myData`，控制器将触发，但当我进入视图时，`.cshtml`我会在该单选按钮上收到对象引用错误。

我是 MVC 的新手。我可以在这两种情况下使用单独的视图模型吗（实际上，我认为使用 Serialize 我会在视图上得到另一个错误）？或者是否有其他方法可以在无需重新执行所有代码的情况下完成此任务？

如果这真的很简单，请原谅我——有时你只是陷入了一个问题，以至于看不到你面前的东西。

# c# - 添加nuget包时PublicToken有时用于参考其他时候不是......如何停止它？

> ID：14258732
> 
> 赞同：0
> 
> 时间：2013-01-10T13:11:40.793
> 
> 标签：c#, nuget, code-signing

我正在尝试调试此消息：

```
The type 'Logging.LoggingProvider' is defined in an assembly that is not referenced. You must add a reference to assembly 'Logging.LoggingProvider, Version=1.0.0.0, Culture=neutral, PublicKeyToken=71561dfc7a07d5da'. 
```

我有几个在链中相互依赖的 nuget 包。在深入研究构建这些包的项目文件时，我发现引用程序集的方式略有不同。有些人有钥匙，有些人没有。这使我相信，如果我找到一种方法使 nuget 创建的引用保持一致，我的问题就会消失。

大会曾一度签署。我认为如果我从项目中删除了已签名的程序集 = false，则参考行为会发生变化，但情况似乎并非如此。

例如，在 1 个解决方案中，我在 2 个不同的项目中使用了相同的 nuget 包和版本，引用不同

不正确的（或至少不受欢迎的）

```
<Reference Include="Logging.LoggingProvider, Version=1.0.0.0, Culture=neutral, PublicKeyToken=71561dfc7a07d5da, processorArchitecture=MSIL">
  <SpecificVersion>False</SpecificVersion>
  <HintPath>..\packages\Logging.LoggingProvider.1.0.24\lib\Logging.LoggingProvider.dll</HintPath>
</Reference> 
```

在另一个项目中，正确的是

```
<Reference Include="Logging.LoggingProvider, Version=1.0.0.0, Culture=neutral, processorArchitecture=MSIL">
  <SpecificVersion>False</SpecificVersion>
  <HintPath>..\packages\Logging.LoggingProvider.1.0.24\lib\Logging.LoggingProvider.dll</HintPath>
</Reference> 
```

这可能是什么原因造成的？我实际上是在将 nuget 包添加到 1 个项目，然后是下一个项目。一个有效，另一个无效 - 我在项目文件中看不到任何解释原因的内容。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-03T01:35:27.983

NuGet 使用底层 VS 层在安装包时添加引用。当您尝试手动将此引用添加到这些项目时，会有什么行为？

# sql - 如何根据 SQL 中的每个不同 ID 平均数字？

> ID：14258736
> 
> 赞同：-4
> 
> 时间：2013-01-10T13:12:00.060
> 
> 标签：sql, sql-server, sql-server-2008

我有`CommentRating`一个表，其中包含一个外键`DrinkId`。我正在尝试获取每个 的平均收视率，`DrinkId`除此之外，我还想显示收视率最高的前三个 drinkIds。

```
commentRating  drinkID 

     9           7

     9           4

     8          11

     8           7

     7           4

     6           4

     6          11 
```

这是我到目前为止的SQL，但我不知道如何更改它。

```
Select TOP(3)(AVG(commentRating)),DISTINCT(drinkID)
FROM  Comment order by commentRating desc 
```

如何平均评分，选择评分前三名的饮料，并在 SQL 中返回它们？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-10T13:15:43.060

您需要通过以下方式`GROUP BY`获得结果`drinkID`：

```
SELECT TOP 3 AVG(commentRating), drinkID
FROM Comment
GROUP BY drinkID
ORDER BY AVG(commentRating) DESC 
```

我建议您阅读您最喜欢的 SQL 文档，了解有关`GROUP BY`. 对于 T-SQL，它是[MSDN 上的 GROUP BY (Transact-SQL)](http://msdn.microsoft.com/de-de/library/ms177673.aspx)。

`AVG`是一个聚合函数。同样，我建议您阅读一些关于聚合函数的文档，在 T-SQL 中它也在[MSDN 库](http://msdn.microsoft.com/en-us/library/ms173454.aspx)中。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-10T13:17:13.213

对于 T-SQL：

```
select TOP 3 * from
(
select drinkID,avg(commentRating) avgCom 
from Comment group by drinkID
) t order by avgCom DESC 
```

对于 MySQL，使用[LIMIT](http://www.w3schools.com/sql/sql_top.asp)关键字。

# lucene - Lucene indexwriter.close() 是必须的吗？

> ID：14258741
> 
> 赞同：1
> 
> 时间：2013-01-10T13:12:22.303
> 
> 标签：lucene

我的程序运行速度太慢，以至于在调用 Lucene indexwriter.close 之前，在将 40,000 个文档插入数据库之后，我不得不中途终止它以优化部分代码。然后，对于某些似乎仅限于该特定运行的 40,000 个文档的记录，我找不到任何结果。

这是否意味着我在程序运行期间索引的那些记录丢失了？IndexWriter 必须始终完全关闭以允许将数据写入索引？

提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-10T15:47:02.443

您需要调用但不关闭[commit](http://lucene.apache.org/core/4_0_0/core/org/apache/lucene/index/IndexWriter.html#commit%28%29)。[addDocument](http://lucene.apache.org/core/4_0_0/core/org/apache/lucene/index/IndexWriter.html#addDocument%28java.lang.Iterable%29)仅分析文档并将数据缓冲到内存中，而 commit 将刷新挂起的更改并执行 fsync。

[close](http://lucene.apache.org/core/4_0_0/core/org/apache/lucene/index/IndexWriter.html#close%28%29)调用在内部提交，我认为这就是您认为需要 close 的原因。

但是，请注意不要过于频繁地调用 commit，因为与 addDocument 相比，此操作非常昂贵。

# javascript - javascript 链接从回调返回 this

> ID：14258744
> 
> 赞同：0
> 
> 时间：2013-01-10T13:12:29.117
> 
> 标签：javascript, callback, return, chaining

我试图从回调中返回 this，但我总是不确定。

这是剪断的

```
create: function(currentView, data){
    var itsMe = this; 
    this.thumbsWrapper = this.templates.wrapper().hide();
    currentView.append(this.thumbsWrapper);
    this.thumbsWrapper.fadeIn("fast", function(){
        return itsMe;                                                 
    });
},

var l = list().create(currentView); //need teh return that i can use chaining 
```

var l 现在是未定义的，如果我使用带有回调的淡入淡出...如果我不使用带有回调的淡入淡出它返回 obj

有人知道为什么吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-10T13:19:58.753

@Felix Kling 说的是正确的，你没有返回任何东西。如果您想退货`itsMe`，您需要执行以下操作：

```
create: function(currentView, data){
    var itsMe = this; 
    this.thumbsWrapper = this.templates.wrapper().hide();
    currentView.append(this.thumbsWrapper);
    this.thumbsWrapper.fadeIn("fast");
    return itsMe;    
} 
```

如果您想要链接，这应该足够了。

如果您想获得`itsMe`淡出完成时间的参考，您需要传递您自己的回调：

```
create: function(currentView, data, callback){
    var itsMe = this; 
    this.thumbsWrapper = this.templates.wrapper().hide();
    currentView.append(this.thumbsWrapper);
    this.thumbsWrapper.fadeIn("fast", function(){ 
        callback(itsMe);
    });  
}

list().create(function (that) {
    console.log("fade out complete");
    console.log("itsMe is", that);
}); 
```

如果你想要一个链接模式，它会在淡出完成时执行链中的下一个函数，你需要传递的不是一个引用`this`而是一个可以排队命令的对象，顺序执行每个命令。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-10T13:17:50.403

您需要在`create()`函数中返回对象，它目前没有返回任何内容：

```
create: function(currentView, data){
    var itsMe = this; 
    this.thumbsWrapper = this.templates.wrapper().hide();
    currentView.append(this.thumbsWrapper);
    this.thumbsWrapper.fadeIn("fast", function(){
        return itsMe;  //<--- this isn't going anywhere because you don't capture it                                               
    });
    return itsMe; //<------ return the object
}, 
```

# java - 给定 jsession id 时，Java Applet 似乎使用旧的响应对象

> ID：14258745
> 
> 赞同：1
> 
> 时间：2013-01-10T13:12:30.337
> 
> 标签：java, jakarta-ee, servlets, jsf-2, applet

我的 jsf 页面中有一个文件上传小程序。这个小程序需要一个可以发送它的 POST 请求的地址。（我无法编辑此帖子请求以添加更多字段或其他内容）。然后我的 servlet 的 post 方法存储该文件。这项工作不能由托管 bean 完成，因为 servlet 必须使用 @MultiPartConfig 进行注释，并且我无法将此注释添加到 jsf 托管 bean。为了强制上传小程序使用相同的会话，我根据这个[主题在 post 请求中添加了一个名为 jsessionId 的 URL 属性](https://stackoverflow.com/questions/13194034/accessing-jsf-session-scoped-bean-from-servlet-which-is-called-by-applet-embedde). 现在，每当我在会话期间尝试上传多个文件时，小程序都会停止并显示错误消息“在响应正文中找不到正则表达式字符串“^SUCCESS$””，这是因为小程序在 servlet 响应中需要此字符串为了知道上传成功。

当我查看小程序的调试代码时，响应包含很多 html 代码，但没有这个成功字符串，尽管我将它添加到我的 Servlet 代码中。这是我的 servlet 的代码：

```
@Override
protected void doGet(HttpServletRequest request, HttpServletResponse response)
        throws ServletException, IOException {
    response.reset();
    if (!userBean.getUploadedDatasets().isEmpty()) {
        String datasetID = userBean.getUploadedDatasets().getLast().replaceAll("/", "%2F");
        response.sendRedirect(response.encodeRedirectURL("http://____________/faces/details.xhtml?id="+datasetID));
    }
}

/**
 * Handles the HTTP
 * <code>POST</code> method.
 *
 * @param request servlet request
 * @param response servlet response
 * @throws ServletException if a servlet-specific error occurs
 * @throws IOException if an I/O error occurs
 */
@Override
protected void doPost(HttpServletRequest request, HttpServletResponse response){
    PrintWriter out = null;
    try {
        Part filePart = request.getPart("item");
        InputStream filecontent = filePart.getInputStream();
        String datasetID = repBean.persistDataset(filecontent, uploadBean.getFolder());
        userBean.getUploadedDatasets().add(datasetID);
        out = response.getWriter();
        out.println("SUCCESS");
    } catch (ServletException ex) {
        Logger.getLogger(RequestHandler.class.getName()).log(Level.SEVERE, null, ex);
    } catch (IOException ex) {
        Logger.getLogger(RequestHandler.class.getName()).log(Level.SEVERE, null, ex);
    }finally{
        out.close();
    }
} 
```

小程序使用 doGet 方法作为 afterUploadURL （这是上传文件后跳转到的 url）

小程序代码是：

```
 <APPLET
           CODE="wjhk.jupload2.JUploadApplet"
           NAME="JUpload"
           ARCHIVE="wjhk.jupload.jar"
           WIDTH="640"
           HEIGHT="300"
           MAYSCRIPT="true"
           ALT="The java pugin must be installed.">
           <param name="postURL" value="http://________________/request;jsessionid=#{session.id}" />
           <!-- Optionnal, see code comments -->
           <param name="showLogWindow" value="false" />
           <param name="debugLevel" value="99" />
           <param name="httpUploadParameterName" value="item" />
           <param name="nbFilesPerRequest" value="1" />
           <param name="httpUploadParameterType" value="oneFile" />
           <param name="afterUploadURL" value="http://________________/request" />
          </APPLET> 
```

在尝试上传第二个文件后，“旧”（这是我的想法，但我对 servlet 了解不够）响应如下所示： http: [//pastebin.ca/2300999](http://pastebin.ca/2300999) （字符太多，所以我不得不上传到那里）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-10T13:39:46.097

您的问题是由于 servlet 在 GET（以及隐含的 HEAD）请求上发送重定向而引起的。日志的以下部分包含相关信息：

```
00064   13:44:42.482      HttpProtocolFinderThread     [DEBUG]      Getting serverProtocol from HEAD request
00065   13:44:42.485      HttpProtocolFinderThread     [DEBUG]      Checking protocol with URL: http://___________________:8080/application1/request;jsessionid=47440f88e532021656b3724eea33
00066   13:44:42.501      HttpProtocolFinderThread     [DEBUG]      [initByteArrayEncoder] proxy=DIRECT, proxy.type=DIRECT, useProxy=false, url.host=___________________, url.port=8080
00067   13:44:42.501      HttpProtocolFinderThread     [DEBUG]      [onAppendHeader] Start
00068   13:44:42.502      HttpProtocolFinderThread     [DEBUG]      [onAppendHeader] Header appended; Cookie: __utma=132868616.170774110.1354796930.1356109339.1356547898.3; __utmz=132868616.1356547898.3.3.utmcsr=google|utmccn=(organic)|utmcmd=organic|utmctr=(not%20provided)
00069   13:44:42.509      HttpProtocolFinderThread     [DEBUG]      [onAppendHeader] Header appended; User-Agent: Mozilla/5.0 (X11; Ubuntu; Linux i686; rv:16.0) Gecko/20100101 Firefox/16.0
00070   13:44:42.510      HttpProtocolFinderThread     [DEBUG]      [onAppendHeader] End
00071   13:44:42.510      HttpProtocolFinderThread     [DEBUG]      [HTTPConnectionHelper append]
00072   13:44:42.511      HttpProtocolFinderThread     [DEBUG]      Before sendRequest()
00073   13:44:42.511      HttpProtocolFinderThread     [DEBUG]      Using non SSL socket, direct connection
00074   13:44:42.538      HttpProtocolFinderThread     [DEBUG]      After sendRequest()
00075   13:44:42.538      HttpProtocolFinderThread     [DEBUG]      -------------------------------------------------------------------------
00076   13:44:42.538      HttpProtocolFinderThread     [DEBUG]      -----------------   HEAD message sent (start)  --------------------------
00077   13:44:42.539      HttpProtocolFinderThread     [DEBUG]      -------------------------------------------------------------------------
00078   13:44:42.539      HttpProtocolFinderThread     [DEBUG]      HEAD /application1/request;jsessionid=47440f88e532021656b3724eea33 HTTP/1.1
00078   13:44:42.539      HttpProtocolFinderThread     [DEBUG]      Host: ___________________:8080
00078   13:44:42.539      HttpProtocolFinderThread     [DEBUG]      Accept: */*
00078   13:44:42.539      HttpProtocolFinderThread     [DEBUG]      Accept-Encoding: identity
00078   13:44:42.539      HttpProtocolFinderThread     [DEBUG]      Connection: close
00078   13:44:42.539      HttpProtocolFinderThread     [DEBUG]      Cookie: __utma=132868616.170774110.1354796930.1356109339.1356547898.3; __utmz=132868616.1356547898.3.3.utmcsr=google|utmccn=(organic)|utmcmd=organic|utmctr=(not%20provided)
00078   13:44:42.539      HttpProtocolFinderThread     [DEBUG]      User-Agent: Mozilla/5.0 (X11; Ubuntu; Linux i686; rv:16.0) Gecko/20100101 Firefox/16.0
00078   13:44:42.539      HttpProtocolFinderThread     [DEBUG]      
00079   13:44:42.539      HttpProtocolFinderThread     [DEBUG]      -------------------------------------------------------------------------
00080   13:44:42.540      HttpProtocolFinderThread     [DEBUG]      -----------------   HEAD message sent (end) -----------------------------
00081   13:44:42.540      HttpProtocolFinderThread     [DEBUG]      -------------------------------------------------------------------------
00082   13:44:42.548      HttpProtocolFinderThread     [DEBUG]      -------- Response Headers Start --------
00083   13:44:42.556      HttpProtocolFinderThread     [DEBUG]      HTTP/1.1 302 Moved Temporarily
00084   13:44:42.558      HttpProtocolFinderThread     [DEBUG]      Location: http://___________________:8080/application1/faces/details.xhtml;jsessionid=47440f88e532021656b3724eea33?id=%2F37ded64f-f2c9-4b90-99ea-79c34eb140e5
00085   13:44:42.559      HttpProtocolFinderThread     [DEBUG]      Content-Type: text/html;charset=ISO-8859-1
00086   13:44:42.566      HttpProtocolFinderThread     [DEBUG]      Content-Language: de-DE
00087   13:44:42.578      HttpProtocolFinderThread     [DEBUG]      Content-Length: 306
00088   13:44:42.578      HttpProtocolFinderThread     [DEBUG]      Date: Thu, 10 Jan 2013 12:44:42 GMT
00089   13:44:42.579      HttpProtocolFinderThread     [DEBUG]      Connection: close
00090   13:44:42.579      HttpProtocolFinderThread     [DEBUG]      
00091   13:44:42.580      HttpProtocolFinderThread     [DEBUG]      --------- Response Headers End ---------
00092   13:44:42.580      HttpProtocolFinderThread     [DEBUG]      This is a HEAD request: we don't care about the bytearrayResponseBody
00093   13:44:42.584      HttpProtocolFinderThread     [DEBUG]      HEAD status: 302
00094   13:44:42.585      HttpProtocolFinderThread     [DEBUG]      HEAD protocol: HTTP/1.1
00095   13:44:42.586      HttpProtocolFinderThread     [DEBUG]      Location read: http://___________________:8080/application1/faces/details.xhtml;jsessionid=47440f88e532021656b3724eea33?id=%2F37ded64f-f2c9-4b90-99ea-79c34eb140e5
00096   13:44:42.594      HttpProtocolFinderThread     [INFO]       postURL switched from http://___________________:8080/application1/request;jsessionid=47440f88e532021656b3724eea33 to http://___________________:8080/application1/faces/details.xhtml;jsessionid=47440f88e532021656b3724eea33?id=%2F37ded64f-f2c9-4b90-99ea-79c34eb140e5 
```

小程序基本上是`postURL`通过 HEAD 请求测试可用性，一旦确定它已被重定向，它就会将重定向的 URL 用作新的`postURL`（根据复制粘贴日志的最后一行）。然而，重定向的 URL 指向一个返回一大堆 HTML 的 JSF 页面。

您需要修复`doGet()`它不执行重定向的问题，或者添加一个`doHead()`实际上什么也不返回的内容。由于 HEAD 根据 HTTP 规范基本上是没有响应正文的 GET，默认`doHead()`实现委托给`doGet()`并丢弃响应正文。覆盖`doHead()`应该防止它委托给`doGet()`.

# javascript - IIS6 无法获取类型属性；JS替换危险字符

> ID：14258751
> 
> 赞同：0
> 
> 时间：2013-01-10T13:12:44.310
> 
> 标签：javascript, .net

我有网站供客户使用 U/P 登录，因为用户名必须是电子邮件地址，我通过我们的错误日志注意到一些用户不小心将他们的电子邮件格式粘贴

```
<My Name> myemail@test.com 
```

进入密码字段。我只注意到这一点，因为 .NET 由于其中的 < 引发了有关潜在危险的 Request.Form 的错误。我有一个javascript函数可以用“<”替换“<”（它后面的空格不会导致错误），我想将它应用到密码上——无论如何这都是不正确的，但至少他们会得到一个很好的“无效密码”消息，而不是一个关于危险角色的大而丑陋的消息。当然，由于它是密码，除非我先将类型更改为文本，否则我无法进行替换。这是我在javascript中尝试过的：

```
 function replaceSuspectChars(that)
{
    that.type = 'text'; 
    //Find '<' not followed by a space, and replace it with a '< '
    var text = that.value;
    text = text.replace(/</g, "< ");
    text = text.replace(/<  /g, "< ");
    that.value = text;
    that.type = 'password'; 
} 
```

这在运行 IIS7 的 IE 本地机器上运行良好。但在 IIS6 上的生产中，我收到错误“无法获取类型属性”。有没有办法让 javascript 更改文本框类型，或者能够替换密码字段中的违规字符，或者任何其他方式来避免这种危险的字符错误？我不能使用代码隐藏代码，因为危险字符错误总是在执行回发代码之前显示。

谢谢你的帮助。-VG

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-17T16:18:11.653

如果您想允许“<”，您可以`validateRequest="false"`在 .aspx 页面的 Page 属性中进行设置。这应该导致.net 允许“<”。然后你就不会得到那个丑陋的死亡黄页，让你显示你漂亮的错误信息。

尽管出于安全原因，我不确定您是否要将 validateRequest 设置为 false，因为这将阻止 .Net 检查脚本注入攻击。这是需要考虑的事情。

看：

1.  [http://www.asp.net/whitepapers/request-validation](http://www.asp.net/whitepapers/request-validation)
2.  [在 ASP 中使用将 ValidateRequest 设置为 false](https://stackoverflow.com/questions/3133093/use-of-setting-validaterequest-to-false-in-asp)
3.  [Asp.Net Validaterequest 错误](https://stackoverflow.com/questions/713007/asp-net-validaterequest-false)

# java - ActiveMQ 节流消费者

> ID：14258755
> 
> 赞同：4
> 
> 时间：2013-01-10T13:12:47.747
> 
> 标签：java, activemq

我想在 hornetq 中对 activeMQ 中某个队列的消费者进行节流（对于 jboss，这是使用 mdb 消费者定义上的注释来实现的）。我在activemq的文档中找不到任何类似的东西，我找到的最接近的是这个

```
consumer.recvDelay   0 ms    Pause consumer for recvDelay milliseconds with each message (allows consumer throttling). 
```

来自：[http ://activemq.apache.org/activemq-performance-module-users-manual.html](http://activemq.apache.org/activemq-performance-module-users-manual.html)

但是我找不到如何在java中做到这一点。

提前致谢，

问候。

编辑：这是 ActiveMQManager 代码和使用者代码：

```
public class ActiveMQManager {

    private static ActiveMQConnectionFactory CONNECTION_FACTORY;

    public static Connection CONNECTION;

    public static Session SESSION;

    public static Destination TEST_QUEUE;

    public static void start() {
        try {

            CONNECTION_FACTORY = new ActiveMQConnectionFactory("vm://localhost");

            CONNECTION = CONNECTION_FACTORY.createConnection();
            CONNECTION.start();

            SESSION = CONNECTION.createSession(false,
                    Session.CLIENT_ACKNOWLEDGE);

            TestClient testClient = new TestClient();

            TEST_QUEUE = SESSION.createQueue("TEST.QUEUE");

            MessageConsumer testConsumer = SESSION.createConsumer(TEST_QUEUE);
            test.setMessageListener(testClient);

        } catch (Exception e) {
        }
    }

    public static void stop() {
        try {
            // Clean up
            SESSION.close();
            CONNECTION.close();
        } catch (JMSException e) {
            log.error(e);
        }
    }
} 
```

消费者代码非常简单（对于这个例子）：

```
public class TestConsumer implements MessageListener {

    @Override
    public void onMessage(Message message) {
        //Do something with the message
    }

} 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-23T03:56:17.947

这取决于所使用的消费者技术......但这里有一些选择

*   您可以手动在您的消费者代码中引入延迟（不是一门精确的科学，但这会限制吞吐量）

*   您还可以通过设置 JMS 连接的 maxConcurrentConsumers 属性来控制使用者使用的线程数……也就是说，这不会限制消息吞吐量，只是限制使用者使用的并发级别

*   更好的是，您可以使用限制器 EIP 实现设置每个时间段要消耗的确切消息数

    例如，使用[Camel Throttler很简单](http://camel.apache.org/throttler.html)

    `from("activemq:queueA").throttle(10).to("activemq:queueB")`

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-18T18:37:03.093

使用 ActiveMQ，您可以设置使用者预取限制：[http ://activemq.apache.org/what-is-the-prefetch-limit-for.html](http://activemq.apache.org/what-is-the-prefetch-limit-for.html)

要配置它，您可以使用连接 URL（大多数配置可以使用 URL 完成）或 Java API。

更多有趣的参数：[http ://activemq.apache.org/connection-configuration-uri.html](http://activemq.apache.org/connection-configuration-uri.html)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2016-05-26T11:35:38.633

考虑到 Camel Throttler 在交换被 Throttler 阻止时将它们保存在内存中。因此，如果您有 100 个队列消费者并且服务器（公开 SOAP 服务）很慢，那么您的内存中可能有多达 100 个交换！

为此发布了这个问题：[所有 JMS 消费者在 ActiveMQ 队列上侦听的节流消耗率](https://stackoverflow.com/questions/37462059/throttle-consumption-rate-of-all-jms-consumers-listening-on-an-activemq-queue)

# security - playframework 中的会话安全性

> ID：14258756
> 
> 赞同：1
> 
> 时间：2013-01-10T13:12:50.463
> 
> 标签：security, session, playframework

我刚刚读到 Play 将会话数据保存在客户端：

> 重要的是要了解 Session 和 Flash 数据不存储在服务器中，而是使用 Cookie 添加到每个后续 HTTP 请求中。这意味着数据大小非常有限（最多 4 KB）并且您只能存储字符串值。

我对WEB没有经验，所以我有几个问题：

1) 安全吗？

2）在这种会话中存储敏感数据的合理性如何？

客户端可以更改请求数据（更改没有会话 ID 的会话数据）。Play 中是否有任何内置机制来防止此类情况的影响？当客户端更改会话数据，请求服务器尝试读取此数据后，会发生什么？

> Cookie 使用密钥签名，因此客户端无法修改 cookie 数据（否则将失效）。

但这意味着什么？假设客户端更改会话数据。之后服务器端发生了什么：

```
String foo = session(bar) 
```

foo 将为空？垃圾随机字符串？会抛出异常吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-10T17:30:19.170

这种“RESTful”的会话方法足够安全。有更安全和更快的方法来管理会话的问题。

cookie 可能未签名。为此使用非对称加密将是一种巨大的资源浪费。cookie 更有可能受到[散列消息身份验证代码](http://en.wikipedia.org/wiki/Hash-based_message_authentication_code)或 HMAC 的保护。如果开发人员认为 HMAC 被称为“签名”，那么您可能会遇到更大的安全问题，因为该词的使用显然是不正确的。

使用 HMAC 作为会话 ID 的最大安全问题是，您很可能使用单个密钥构建所有会话。如果需要，可以在数年内使用一组机器强制将此密钥强制离线。确保你的秘密**很大**，至少大约 1,024 字节。如果可以使用目录遍历或其他攻击从文件中读取此密钥，则攻击者可以自由地建立自己的会话状态，这可能导致完全妥协。

最安全的会话 ID 是一个很大的随机值，大概 32 个字节就足够了。此数字用于从数据库中提取会话状态。最好来自托管在本地网络上的非常快速的非关系数据库，例如 memcached。

从性能的角度来看，HMAC 会话方法是不可取的，因为它会为每个 HTTP 请求消耗额外的带宽……因此会减慢每个 http 请求并消耗客户端资源和 Web 服务器的带宽。

您应该只传输满足请求所需的最小值。复杂性是安全的大敌，大的随机值很简单。

# objective-c - 如何在 Objective-C 的后台线程中调用具有多个参数的方法？

> ID：14258759
> 
> 赞同：0
> 
> 时间：2013-01-10T13:13:09.320
> 
> 标签：objective-c

当我点击一个按钮时，它将调用一个动作，该动作又将启动一个过程（通过另一种方法）并返回。我想过使用

```
[<target> performSeleltorInBackgroundThread:....]; 
```

- 但我无法通过这个传递多个参数。

我怎样才能实现它。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-10T13:17:59.577

你可以这样做：

```
dispatch_async(dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_DEFAULT, 0), ^{
    [self goDoSomethingLongAndInvolved:arg1 and:arg2 and:arg3 and:argN];
    dispatch_async(dispatch_get_main_queue(), ^{
        [textField setStringValue:@"Done doing something long and involved - Update UI"];
    });
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-10T13:15:52.180

您不能这样做，但您可以将参数添加到数组中，并将该数组作为唯一一个参数传递给 -performSelectorInBackgroundThread。使用文字你可以很容易地做到这一点：

```
NSArray *arguement = @[first, second, third]; 
```

在 -performSelector 中：

```
id first = argument[0];
... 
```

# c - C中逻辑或执行的顺序

> ID：14258761
> 
> 赞同：6
> 
> 时间：2013-01-10T13:13:14.673
> 
> 标签：c

想知道如果 next 的值为 NULL（节点是链表），下一条语句是否会导致保护错误和其他可怕的事情。

```
if (!node->next || node->next->some_field != some_value) { 
```

我假设一旦第一部分为真，OR 的第二部分就不会被评估。我假设这个错了吗？这个编译器是特定的吗？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-01-10T13:18:19.017

在 ISO-IEC-9899-1999 标准 (C99) 的第 6.5.14 节中：

> || 如果任一操作数比较不等于 0，则运算符应产生 1；否则，它产生 0。结果具有 int 类型。4 不同于按位 | 运算符，|| 运算符保证从左到右的评估；在计算第一个操作数之后有一个序列点。如果第一个操作数比较不等于 0，则不计算第二个操作数。

这不是特定于编译器的。如果`node->next`是`NULL`，则**永远不会**评估条件的其余部分。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-01-10T13:15:56.197

在 OR 中，

`if ( expr_1 || expr_2)`

expr_2 只有在 expr_1 失败时才被“测试”（为假）

在一个 AND

`if( expr_1 && expr_2 )`

expr_2 只有在 expr_1 成功时才被“测试”（为真）

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-01-10T13:16:14.333

可以安全地假设，如果左侧的计算结果为 true，则不会计算右侧的布尔表达式。请参阅[相关问题](https://stackoverflow.com/questions/5683026/logical-comparisons-is-left-to-right-evaluation-guaranteed)。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-01-10T13:16:47.100

它不是特定于编译器的。您可以安全地依赖短路，您的代码将按预期工作。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2013-01-10T13:17:30.297

你是对的。

在运算符之后的条件（）之前，运算符（ ）之前的条件`compiler independent`总是被评估。如果条件是，则整体只评估为而不评估条件。`first``OR``!node->next``second``node->next->some_field != some_value``OR``first``true``expression``true``second`

您只是在为您的`linked list`. `next`只有当它是 时，您才会进一步访问指针`not NULL`。

# ios - TiViewProxy 和视图创建

> ID：14258763
> 
> 赞同：0
> 
> 时间：2013-01-10T13:13:27.590
> 
> 标签：ios, titanium, titanium-mobile, titanium-modules

我正在研究钛模块。

有点糊涂了**`TiViewProxy`**。

为什么我们`-(void)setColor_:(id)color`在 ViewProxy 中使用这样的方法（_ in methods）？

如果我们没有编写任何这样的方法，当我们调用时会发生什么：

```
myModule.createView({
  color : 'red'
}); 
```

如果我没有在我的`createView()`方法上传递任何参数，我的视图创建代码将如何在我的模块上工作。

方法：

我只是在我的 app.js 中创建我的视图，例如：

```
myModule.createView(); 
```

我正在处理内部的视图创建代码：

```
-(void)setColor_:(id)color
{
} 
```

如果我没有传递任何论点，我的视图是如何创建的？它会起作用吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-11T04:39:17.380

我将解释各种移动部件。这都是平台的一部分，所以你知道它是如何工作的并不重要。不过，知道它为你做这件事很重要。所以...

当您调用 myModule.createView() 时，平台会查找与某些约束匹配的模块的子模块。让我通过查看`ti.pageflip`模块来扩展该声明。`myModule`的课是`TiPageflipModule`。当我调用`myModule.createView()`时，平台会查找`TiPageflipViewProxy`以便实例化它。`TiPageflip`来自模块的名称，减去“模块”。“视图”来自`createView`. “代理”被标记，因为这就是我们从 JavaScript 到原生的方式。`TiPageflipViewProxy`创建一个原生视图，`TiPageflipView`. 代理处理 JavaScript 和本机视图之间的交互。到目前为止有意义吗？

公开属性的部分命名约定是它们以`_`. 平台查找这些方法，并调用创建字典中设置的每个方法`createView({ whatever: 'value' })`以及属性`view.whatever = 'value';`或方法`view.setWhatever('value')`。（在 iOS 模组开发指南中搜索“下划线”一词，它只出现一次，阅读更多：[https](https://wiki.appcelerator.org/display/guides/iOS+Module+Development+Guide) ://wiki.appcelerator.org/display/guides/iOS+Module+Development+Guide ）。

因为您没有定义 createView，所以平台会为您完成它，它`createView()`的处理方式与`createView({})`. 这是一个可选参数。这只是根据定义。

# c++ - 基于范围的“for”循环是否会弃用许多简单的算法？

> ID：14258768
> 
> 赞同：81
> 
> 时间：2013-01-10T13:13:47.370
> 
> 标签：c++, algorithm, stl, c++11, foreach

算法解决方案：

```
std::generate(numbers.begin(), numbers.end(), rand); 
```

基于范围的for循环解决方案：

```
for (int& x : numbers) x = rand(); 
```

为什么我要`std::generate`在 C++11 中使用更详细的基于范围的 for 循环？

* * *

## 回答 #1

> 赞同：79
> 
> 时间：2013-01-10T13:23:37.637

第一个版本

```
std::generate(numbers.begin(), numbers.end(), rand); 
```

告诉我们您要生成一系列值。

在第二个版本中，读者必须自己弄清楚。

节省打字通常不是最理想的，因为它通常会在阅读时间中丢失。大多数代码的阅读量要比输入的多得多。

* * *

## 回答 #2

> 赞同：42
> 
> 时间：2013-01-10T13:15:50.130

for 循环是否基于范围根本没有区别，它只是简化了括号内的代码。算法更清晰，因为它们显示了*意图*。

* * *

## 回答 #3

> 赞同：30
> 
> 时间：2013-01-10T14:06:53.337

就个人而言，我最初的阅读：

```
std::generate(numbers.begin(), numbers.end(), rand); 
```

是“我们正在分配范围内的所有内容。范围是`numbers`。分配的值是随机的”。

我的初步阅读：

```
for (int& x : numbers) x = rand(); 
```

是“我们正在对范围内的所有内容做某事。范围是`numbers`。我们所做的是分配一个随机值。”

这些非常相似，但并不完全相同。我可能想引起第一次阅读的一个合理原因是，因为我认为有关此代码的最重要的事实是它分配给范围。所以这就是你的“我为什么要……”。我使用`generate`因为在 C++ 中`std::generate`意味着“范围分配”。正如 btw 所做的那样`std::copy`，两者之间的区别是您分配的内容。

不过，也有一些混杂因素。`numbers`与基于迭代器的算法相比，基于范围的 for 循环具有内在更直接的方式来表达范围是。这就是人们使用基于范围的算法库的原因：`boost::range::generate(numbers, rand);`看起来比`std::generate`版本更好。

与此相反，`int&`在您的基于范围的 for 循环中是一个皱纹。如果范围的值类型不是 怎么办`int`，那么我们在这里做了一些令人讨厌的微妙事情，这取决于它是否可转换为`int&`，而`generate`代码仅取决于`rand`可分配给元素的返回。即使值类型是`int`，我仍然可能会停下来思考它是否是。因此`auto`，它推迟了对类型的思考，直到我看到分配了什么——`auto &x`我说“引用范围元素，无论可能有什么类型”。回到 C++03，算法（因为它们是函数模板）是隐藏确切类型*的*方法，现在它们是*一种*方法。

我认为，最简单的算法与等效循环相比只有一点点优势。基于范围的 for 循环改进了循环（主要是通过删除大部分样板，尽管它们还有更多的东西）。因此，利润越来越紧，也许您在某些特定情况下会改变主意。但那里仍然存在风格差异。

* * *

## 回答 #4

> 赞同：23
> 
> 时间：2013-01-10T13:34:48.960

**在我看来，Effective STL Item 43：“Prefer algorithm calls to hand-written loops”。仍然是一个很好的建议。**

我通常编写包装函数来摆脱`begin()`/`end()`地狱。如果这样做，您的示例将如下所示：

```
my_util::generate(numbers, rand); 
```

我相信它在*传达意图*和可读性方面都优于基于范围的 for 循环。

* * *

话虽如此，我必须承认，在 C++98 中，一些 STL 算法调用产生了无法发音的代码，并且遵循“首选算法调用而不是手写循环”似乎不是一个好主意。幸运的是，lambdas 改变了这一点。

考虑以下来自[Herb Sutter 的示例：Lambdas, Lambdas Everywhere](http://channel9.msdn.com/Events/PDC/PDC10/FT13)。

**任务：**找到 v 中的第一个元素，即`> x`和`< y`。

没有 lambda：

```
auto i = find_if( v.begin(), v.end(),
bind( logical_and<bool>(),
bind(greater<int>(), _1, x),
bind(less<int>(), _1, y) ) ); 
```

使用 lambda

```
auto i=find_if( v.begin(), v.end(), [=](int i) { return i > x && i < y; } ); 
```

* * *

## 回答 #5

> 赞同：22
> 
> 时间：2013-01-10T13:20:20.043

在*我*看来，手动循环虽然可能会减少冗长，但缺乏可读性：

```
for (int& x : numbers) x = rand(); 
```

我不会使用这个循环来初始化¹由*numbers*定义的范围，因为当我查看它时，在我看来它正在*迭代*一个数字范围，但实际上它没有（本质上），即而不是从范围*读取，它正在**写入*范围。

当您使用`std::generate`.

^(1.在这个上下文中*初始化*意味着给容器的元素赋予*有意义的值。*)

* * *

## 回答 #6

> 赞同：9
> 
> 时间：2013-01-10T16:24:13.023

有些事情你不能（简单地）用基于范围的循环来做，而将迭代器作为输入的算法可以。例如`std::generate`：

用来自一个分布的变量填充容器`limit`（排除，`limit`是一个有效的迭代器`numbers`），其余的用来自另一个分布的变量。

```
std::generate(numbers.begin(), limit, rand1);
std::generate(limit, numbers.end(), rand2); 
```

基于迭代器的算法使您可以更好地控制您正在操作的范围。

* * *

## 回答 #7

> 赞同：6
> 
> 时间：2013-01-11T06:27:18.823

对于 的特殊情况`std::generate`，我同意之前关于可读性/意图问题的答案。std::generate 对我来说似乎是一个更清晰的版本。但我承认这在某种程度上是一个品味问题。

也就是说，我还有另一个理由不丢弃 std::algorithm - 某些算法专门用于某些数据类型。

最简单的例子是`std::fill`. 通用版本在提供的范围内实现为 for 循环，并且在实例化模板时将使用此版本。但不总是。例如，如果您为其提供一个范围，它`std::vector<int>`通常会`memset`在后台调用，从而产生更快更好的代码。

所以我想在这里打一张效率牌。

您的手写循环可能与 std::algorithm 版本一样快，但它几乎不可能更快。不仅如此，std::algorithm 可能专门用于特定的容器和类型，并且它是在干净的 STL 接口下完成的。

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2013-01-10T13:40:59.340

我的回答可能是，不是。如果我们谈论的是 C++11，那么可能（更像是没有）。例如`std::for_each`，即使使用 lambdas 也很烦人：

```
std::for_each(c.begin(), c.end(), [&](ExactTypeOfContainedValue& x)
{
    // do stuff with x
}); 
```

但是使用基于范围的 for 要好得多：

```
for (auto& x : c)
{
    // do stuff with x
} 
```

另一方面，如果我们谈论的是 C++1y，那么我认为不，算法不会被基于范围的 for 淘汰。在 C++ 标准委员会中，有一个研究小组正在研究向 C++ 添加范围的提案，并且正在研究多态 lambda。范围将消除使用迭代器对的需要，而多态 lambda 将允许您不指定 lambda 的确切参数类型。这意味着`std::for_each`可以这样使用（不要把它当作一个铁的事实，这就是今天的梦想）：

```
std::for_each(c.range(), [](x)
{
    // do stuff with x
}); 
```

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2013-01-11T13:54:09.320

应该注意的一件事是算法表达了做了什么，而不是如何做。

基于范围的循环包括事情的完成方式：从第一个开始，应用并进入下一个元素，直到结束。即使是一个简单的算法也可以做不同的事情（至少特定容器的一些重载，甚至不考虑可怕的向量），并且至少它的完成方式与编写器无关。

对我来说，差异很大，尽可能多地封装，并且尽可能使用算法来证明句子的合理性。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2013-01-11T22:26:25.963

基于范围的 for 循环就是这样。直到当然标准被改变。

算法是一个函数。一个对其参数提出一些要求的函数。这些要求在标准中进行了表述，以允许例如利用所有可用执行线程并自动加快速度的实现。

# android - 向当前视图android添加动态线性布局

> ID：14258769
> 
> 赞同：4
> 
> 时间：2013-01-10T13:14:03.487
> 
> 标签：android, android-layout, android-linearlayout, android-scrollview

我正在尝试将线性布局添加到滚动视图这是我的代码编译的代码，但它没有向我显示新布局

这是原始布局（我想添加到它）

```
<ScrollView xmlns:android="http://schemas.android.com/apk/res/android"
android:id="@+id/ScrollView01"
android:layout_width="match_parent"
android:layout_height="wrap_content"
android:scrollbars="vertical" 

android:layout_margin="15dp"
android:layout_marginTop="15dp">

<LinearLayout 
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:orientation="vertical"
    android:paddingBottom="10dp"
    android:paddingLeft="10dp"
    android:paddingRight="10dp" 
     android:id="@+id/ViewHistoryImageLayout">

    <ImageView
        android:id="@+id/HistoryImage"
        android:layout_width="match_parent"
        android:layout_height="0dip"
        android:layout_weight="0.76"
        android:gravity="center"
        android:padding="10dp"
        android:src="@drawable/upload" 
        android:contentDescription="@string/HistoryImage"/>

    <TextView
        android:id="@+id/TranslatedText"
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        android:layout_weight="0.12"
        android:paddingBottom="10dp"
        android:paddingLeft="10dp"
        android:paddingRight="10dp"
        android:text="@string/translateImageButton" />

</LinearLayout> 
```

这是我想多次添加的布局：

```
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
android:layout_width="match_parent"
android:layout_height="match_parent"
android:orientation="vertical"
android:id="@+id/TranslationMenuLayout" >

<TextView
    android:id="@+id/textView1"
    android:layout_width="match_parent"
    android:layout_height="wrap_content"
    android:text="Medium Text"
    android:textAppearance="?android:attr/textAppearanceMedium" />

<RatingBar
    android:id="@+id/ratingBar1"
    android:layout_width="match_parent"
    android:layout_height="wrap_content"
    android:numStars="5" />

<TextView
    android:id="@+id/textView2"
    android:layout_width="match_parent"
    android:layout_height="wrap_content"
    android:text="TextView" />

</LinearLayout> 
```

添加新布局的java代码是：

```
setContentView(R.layout.activity_view_history_image);
ScrollView sv = new ScrollView(this);
LayoutInflater inflater = (LayoutInflater) getSystemService( Context.LAYOUT_INFLATER_SERVICE );
View ll = inflater.inflate(R.layout.translation_menu, null);
sv.addView(ll); 
```

代码编译良好，应用程序正在运行，但没有任何反应 .xml 文件之一有问题吗？

tnx

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-10T13:15:00.160

你应该使用充气机，改变：

```
LinearLayout ll = new LinearLayout(R.layout.translation_menu); 
```

和

```
LayoutInflater inflater = (LayoutInflater) getSystemService( Context.LAYOUT_INFLATER_SERVICE );
View ll = inflater.inflate(R.layout.translation_menu, null);
sv.addView(ll); 
```

从相应的 XML 文件创建`LayoutInflater`一个对象。`View`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-10T13:22:48.803

使用`LayoutInflator`.

`LayoutInflater`类用于将布局 XML 文件实例化为其对应的 View 对象。

换句话说，它将一个 XML 文件作为输入并从中构建视图对象。

```
ScrollView sv = new ScrollView(this);
LayoutInflater layoutInflater = (LayoutInflater) getSystemService( Context.LAYOUT_INFLATER_SERVICE );   
LinearLayout ll = (LinearLayout) li.inflate(translation_menu, this);  
sv.addView(ll); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-10T13:17:06.503

```
 LayoutInflater li = LayoutInflater.from(context);
  LinearLayout ll = (LinearLayout) li.inflate(R.layout.translation_menu, this) 
```

这是正确的方法。

# jquery - 如何获取表单中的元素具有值为 true 的数据类型..？

> ID：14258774
> 
> 赞同：0
> 
> 时间：2013-01-10T13:14:13.133
> 
> 标签：jquery

我试过这样，但不工作：

```
var elements = form.children().find($.data('required', true));

 $('#contactForm').submit(function(event){

          $(elements).each(function(){
               console.log($(this));     
          })

          return false;
     }) 
```

这是错的，请任何人纠正我吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-10T13:16:18.140

如果您查看 的[文档`jQuery.data()`](http://api.jquery.com/jQuery.data)，您会看到它是否*没有*像您要求的那样做。

最好的办法是`filter()`你的表单元素；

```
var elements = form.find(':input').filter(function () {
    return $(this).data('required') === true;
}); 
```

请参阅[`filter()`](http://api.jquery.com/filter). 另请注意`$().data()`不同于`jQuery.data()`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-10T13:15:56.353

应该这样做：

```
var elements = form.children().find('*[data-required=true]'); 
```

# javascript - 在javascript中捕获异常

> ID：14258775
> 
> 赞同：0
> 
> 时间：2013-01-10T13:14:14.750
> 
> 标签：javascript

> **可能重复：**
> [如何在 javascript 中捕获异常？](https://stackoverflow.com/questions/545181/how-to-catch-exceptions-in-javascript)

我正在更改旧的 Web 应用程序。不幸的是，一些布局更改是生成的组件，我没有找到任何合理的解决方案，所以我被迫使用“javascript hacks”。我在加载页面末尾的模板加载了更改某些生成组件的 javascript 文件“layoutfixes.js”。生成的组件有各种 Id 或根本没有它们，所以有时我不得不以可怕的方式获取元素，如下所示：

```
var tdNodes = document.getElementById('tabbedPanel').childNodes[1].childNodes[0]. ... .childNodes[0]; 
```

但正如我所说，并非每个页面都有这些组件，所以上面的行会抛出元素为空的错误。我不会在任何地方添加检查页面上是否存在这样的元素。我希望在该 javascript 中添加类似“try{} catch(Exception e){}”的内容。但我对javascript不够熟悉。在javascript中是这样的吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-10T13:23:38.633

Java 脚本确实支持异常处理。您可以编码为：

```
try {
    foo.bar();
} catch (e) {
    alert(e.name + ": " + e.message);
} 
```

你可以在这里找到更多信息：http: [//www.w3schools.com/js/js_errors.asp](http://www.w3schools.com/js/js_errors.asp)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-10T13:20:59.357

哈克是你在那里所做的事情的正确词。由于您已经进入了hackery 的世界，您不妨添加另一个带有 try/catch 的内容：

```
try {
  document.getElementById('tabbedPanel').childNodes[1]
}
catch ( ex ) {
 // do nothing
} 
```

更多信息在这里：[http ://www.w3schools.com/js/js_errors.asp](http://www.w3schools.com/js/js_errors.asp)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-10T13:21:07.207

Javascript 确实有一个[`try/catch`](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Statements/try...catch)实现：

```
try {
    // add code that can throw exceptions
}
catch (e) {
   // statements to handle any exceptions
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-01-10T13:26:16.223

您可以按照建议的其他答案使用 Try Cache，但我假设您想遍历特定节点的子节点。在这种情况下，下面的代码可以解决问题：

var tdNodes = document.getElementById('tabbedPanel');

```
for ( var i = 0; i < tdNodes.length; i++ ) {
  //do something with childNodes[i]
} 
```

如果要浏览整个 DOM（文档对象模型），可以使用如下递归调用：

var tdNodes = document.getElementById('tabbedPanel');

```
function doSomethingWithNode( node ) {
  //process the node and do whatever you like

  //process all the children with a recursive call
  for ( var i = 0; i < tdNodes.length; i++ ) {
    doSomethingWithNode( childNodes[i] );
  }  
} 
```

# c# - 流利的 Nhibernate 用于递归关系

> ID：14258777
> 
> 赞同：1
> 
> 时间：2013-01-10T13:14:19.167
> 
> 标签：c#, fluent-nhibernate

我有一个代表部门的对象。部门可以包含多个员工和一个子部门。Employee 可以包含多个 Employee for 下属。我如何用 Fluent NHibernate 表示这种关系。Domain 类如下所示：

```
public class Department : Entitybase
{
    public int Id;
    public string DepartmentName;
    public List<Employee> Employees;
    public Department SubDepartment;

}

public class  Employee : EntityBase
{
    public int Id;
    public string Name;
    public List<Employee> Subordinates
} 
```

我的数据库表看起来像：

```
Department Table
   Id: int
   SubDepartmentId : int // a sub department id
   DepartmentName : string

Employee Table
    Id : int
    SuperviserId : int // A Superviser Id
    Name : string
    DepartmentId : int // a department id that contain this employee. 
```

如何为 Select 和 Insert a Data 创建流利的 nhibernate 映射到表。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-10T14:24:21.320

请查看 Ayende 关于有效选择树的帖子：

[http://ayende.com/blog/4151/nhibernate-tips-tricks-efficiently-selecting-a-tree](http://ayende.com/blog/4151/nhibernate-tips-tricks-efficiently-selecting-a-tree)

接下来是据我所知你想要的地图

*   部门地图：

为了映射部门中的员工，您可以编写类似这样的内容。

```
Map(d => d.Id);
Map(d => d.DepartmentName);

HasMany(d => d.Employees)
.KeyColumn("DepartmentId")
.Cascade.None(); 
```

然后，对于子部门属性，我不完全了解一个部门如何只有一个子部门。您是否希望将其作为子部门列表？

```
References(d => d.Subdepartment)
.Column("SubDepartmentId")
.Cascade.All(); 
```

删除此部门时，最后一个 Cascade 会删除子部门

*   员工地图

    地图（e => e.Id）；地图（e => e.Name）；HasMany(e => e.Subordinates) .Column("SuperviserId") .Cascade.None(); //如果这是可为空的，请查看其他类型的级联并根据需要进行修改。

# html - wordpress：如何添加自定义静态 HTML 页面模板？

> ID：14258778
> 
> 赞同：0
> 
> 时间：2013-01-10T13:14:19.257
> 
> 标签：html, wordpress

仪表板是否可以添加自定义静态 HTML 文件以生成新网页？

如果不是最简单的方法是什么？

以及如何确保这些页面在谷歌搜索引擎上是可分类和可引用的？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-10T13:45:05.127

在您的主题目录中，您可以放置​​一些文件，并将它们命名为：

page-homepage.php

page-contact.php 等

现在，每个文件都需要打开：

```
<?php
/*
 * Template Name: Contact Page
 */
?> 
```

并且此标头需要针对每个文件进行区分（它为模板命名）

现在把你喜欢的任何 html 放在里面（也可以考虑添加 get_header() 和 get_footer()，这样你就有了所有必要的脚本和模型。

创建这些文件后，在 WP 中编辑页面时，您可以选择文件作为模板。

# javascript - 在动态创建的元素上添加事件监听器

> ID：14258787
> 
> 赞同：54
> 
> 时间：2013-01-10T13:14:45.927
> 
> 标签：javascript, addeventlistener, dom-events, intercept

是否可以将事件侦听器 (Javascript) 添加到所有动态生成的元素？我不是该页面的所有者，因此无法以静态方式添加侦听器。

对于页面加载时创建的所有元素，我使用：

```
doc.body.addEventListener('click', function(e){
//my code
},true); 
```

当页面上出现新元素时，我需要一种方法来调用此代码，但我不能使用 jQuery（委托、on 等无法在我的项目中工作）。我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：80
> 
> 时间：2013-01-10T13:45:52.830

听起来您需要在不退回图书馆的情况下采用委托策略。我在这里的小提琴中发布了一些示例代码：http: [//jsfiddle.net/founddrama/ggMUn/](http://jsfiddle.net/founddrama/ggMUn/)

它的要点是使用对象`target`上的`event`来查找您感兴趣的元素，并做出相应的响应。就像是：

```
document.querySelector('body').addEventListener('click', function(event) {
  if (event.target.tagName.toLowerCase() === 'li') {
    // do your action on your 'li' or whatever it is you're listening for
  }
}); 
```

**警告！**示例 Fiddle 仅包含符合标准的浏览器的代码（即 IE9+，以及几乎所有其他版本的浏览器）如果您需要支持“旧 IE” `attachEvent`，那么您还需要提供自己的自定义包装器适当的本机功能。（关于这个有很多很好的讨论；我喜欢 Nicholas Zakas 在他的《*面向 Web 开发人员的专业 JavaScript 》*一书中提供的解决方案。）

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2013-01-10T13:28:26.267

取决于您如何添加新元素。

如果你添加 using `createElement`，你可以试试这个：

```
var btn = document.createElement("button");
btn.addEventListener('click', masterEventHandler, false);
document.body.appendChild(btn); 
```

然后你可以使用`masterEventHandler()`来处理所有的点击。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2019-05-11T16:17:07.193

这里值得注意的一个晦涩问题也可能是我刚刚发现的这个事实：

> 如果一个元素`z-index`设置为`-1`或 更小，您可能会认为监听器没有被绑定，而实际上它是，但浏览器认为您正在单击更高的`z-index`元素。

在这种情况下，问题不在于侦听器未绑定，而是它无法获得焦点，因为其他东西（例如，可能是隐藏元素）位于您的元素之上，而取而代之的是焦点（意思是：事件没有被触发）。幸运的是，您可以通过右键单击元素，选择“检查”并检查您单击的内容是否是正在“检查”的内容来轻松检测到这一点。

我用的是Chrome，不知道其他浏览器有没有这么受影响。但是，它很难找到，因为从功能上讲，它在大多数方面类似于监听器未绑定的问题。我通过从 CSS 中删除以下行来修复它 `z-index:-1`：

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2017-06-29T12:08:51.410

我创建了一个小函数来添加动态事件侦听器，类似于`jQuery.on()`.

它使用与接受的答案相同的想法，只是它使用该`Element.matches()`方法检查目标是否与给定的选择器字符串匹配。

```
addDynamicEventListener(document.body, 'click', '.myClass, li', function (e) {
    console.log('Clicked', e.target.innerText);
}); 
```

你可以[从 github](https://github.com/Cristy94/dynamic-listener)获取 if 。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2021-12-07T09:18:51.780

当您必须只支持“现代”网络浏览器（而不是 Microsoft Internet Explorer）时，[突变观察](https://developer.mozilla.org/en-US/docs/Web/API/MutationObserver)器是完成此任务的正确工具：

```
new MutationObserver(function(mutationsList, observer) {
    for(const mutation of mutationsList) {
        if (mutation.type === 'childList') {
            // put your own source code here
        }
    }
}).observe(document.body, {childList: true, subtree: true}); 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2019-11-01T14:43:14.637

您可能想看看这个库：[https](https://github.com/Financial-Times/ftdomdelegate) ://github.com/Financial-Times/ftdomdelegate这是 1,8K gzipped

它用于绑定到与给定选择器匹配的所有目标元素上的事件，无论在注册时 DOM 中是否存在任何内容。

您需要导入脚本，然后像这样实例化它：

```
 var delegate = new Delegate(document.body);
  delegate.on('click', 'button', handleButtonClicks);

  // Listen to all touch move
  // events that reach the body
  delegate.on('touchmove', handleTouchMove);

}); 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2018-07-29T10:05:50.260

将匿名任务委托给动态`HTML` `elements`创建`event.target.classList.contains('someClass')`

1.  返回`true`或`false`
2.  例如。

```
let myEvnt = document.createElement('span');
myEvnt.setAttribute('class', 'someClass');
myEvnt.addEventListener('click', e => {
  if(event.target.classList.contains('someClass')){ 
    console.log(${event.currentTarget.classList})
}}) 
```

3.  参考：[https ://gomakethings.com/attaching-multiple-elements-to-a-single-event-listener-in-vanilla-js/](https://gomakethings.com/attaching-multiple-elements-to-a-single-event-listener-in-vanilla-js/)
4.  好读：[https ://eloquentjavascript.net/15_event.html#h_NEhx0cDpml](https://eloquentjavascript.net/15_event.html#h_NEhx0cDpml)
5.  MDN：[https ://developer.mozilla.org/en-US/docs/Web/API/Event/Comparison_of_Event_Targets](https://developer.mozilla.org/en-US/docs/Web/API/Event/Comparison_of_Event_Targets)
6.  插入点：

* * *

## 回答 #8

> 赞同：-13
> 
> 时间：2015-06-18T07:18:20.777

使用`classList`属性一次绑定多个类

```
var container = document.getElementById("table");
container.classList.add("row", "oddrow", "firstrow"); 
```

# c# - EF 4.2 DbContext IEntityChangeTracker 问题的多个实例

> ID：14258791
> 
> 赞同：2
> 
> 时间：2013-01-10T13:15:04.793
> 
> 标签：c#, entity-framework

我有一个 EF DataRepository 模式，它是我从头开始设计的，在通过使用它的 Web 应用程序使用 EF 时效果很好，但我的任务是生成我的系统的 WCF API 版本，该版本仅在检索时运行良好数据。

当我尝试创建新对象时（这些对象是在 Web 服务方法中创建的，并且没有从请求中序列化），我遇到以下问题：

```
An entity object cannot be referenced by multiple instances of IEntityChangeTracker 
```

现在我以前在开发系统时已经看到了这一点，但这是因为我为每次调用创建了一个新的上下文，我通过将我的上下文放入**HttpContext.Current.Items**来解决这个问题，正如我所说的那样在 Web 应用程序中效果很好，但是现在当我调用代码给我上下文时，HttpContext 为 Null（如预期的那样），因此代码将再次为方法中的每个调用生成一个新的上下文。

为了解决这个问题，我让我的服务提供者能够在初始化服务提供者时发送一个上下文（作为参数）。然后，我在方法的开头声明 Context，这意味着此方法中的所有调用都使用相同的上下文。

但我仍然遇到同样的问题？

示例代码：

```
public MyObject DoSomething()
{
    var dbContext = new myContext();

    var foos = new FooHelper(dbContext).GetAllFoos();

    var bah = new bah();
    bah.Foo = foos.First();
    bah.title = "youre a real object";

    new bahHelper(dbContext).Create(bah);
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-10T17:03:32.403

尝试正确处理上下文并测试错误是否消失：

```
public MyObject DoSomething()
{
    using (var dbContext = new myContext())
    {
        var foos = new FooHelper(dbContext).GetAllFoos();

        var bah = new bah();
        bah.Foo = foos.First();
        bah.title = "youre a real object";

        new bahHelper(dbContext).Create(bah);
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-02T21:43:06.907

当我发现这样的问题时，就我而言，我使用由另一个上下文创建的实体填充了我的模型，所以我只是忽略了该实体并使用该 ID 再次重新创建它。只需确保在同一上下文中创建所有实体（包括嵌套实体）。

# java - 从字段/方法目标注释继承

> ID：14258794
> 
> 赞同：0
> 
> 时间：2013-01-10T13:15:10.060
> 
> 标签：java, inheritance, jpa, annotations, eclipselink

我在这里和那里注释我的课程，我发现自己在重复以下内容：

```
public class Example
{
    @Basic
    @Convert("converter")
    private AnotherExample ae;
} 
```

为了节省一些麻烦并确保正确使用，我想出了创建一个继承自`@Basic`和的注释的想法`@Convert("converter")`。问题是两个注释都有`@Target(value={FIELD, METHOD})`，因此我不能用它们注释我的自定义注释。

有没有其他方法可以实现我的目标，或者这是 Java 注释的限制？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-11T01:18:58.153

这实际上是多重继承的[钻石问题](http://en.wikipedia.org/wiki/Diamond_problem#The_diamond_problem)。

我反对尝试将这些注释合并在一起。继承的目的不是为了节省打字。这两个注释是分开的是有原因的。

大多数 IDE 可以从宏创建代码，这将减少您的打字。否则，搜索和替换正则表达式肯定也会起作用。

# android - 单击按钮后出现 NullPointerException

> ID：14258796
> 
> 赞同：1
> 
> 时间：2013-01-10T13:15:16.243
> 
> 标签：android, exception

到目前为止，一切都照常工作：当我单击一个按钮时，我已经单击了一百次，突然我得到一个 NullPointerException。

这是相关代码：

```
View dbButton = findViewById(R.id.db_button);
dbButton.setOnClickListener(this);

public void onClick (View v) {
    switch (v.getId()) {
    case R.id.new_sms_button:
        Intent inte = new Intent(this, NewSMS.class);
        startActivity(inte);
        break;
    case R.id.about_button:
        Intent i = new Intent(this, About.class);
        startActivity(i);
        break;
    case R.id.db_button:
        Intent in = new Intent(this, Profile.class); duplicata
        startActivity(in);
        break;
    case R.id.prefs_button:
        Intent intent1 = new Intent(this, Settings.class);
        startActivity(intent1);
        break;
    }
} 
```

这是 Profile 类：

```
public class Profile extends Activity {

private UsersData usersData;

@Override
protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.userprofile);

    usersData = new UsersData(this);
    Cursor cursor = getUserData();
    showUserData(cursor);
}

private static String[] FROM = { PHONE_NUMBER, SMS_SENT, SMS_RECEIVED, };
private Cursor getUserData() {
    SQLiteDatabase db = usersData.getReadableDatabase();
    Cursor cursor = db.query(TABLE_NAME, FROM, null, null, null, null, null);
    startManagingCursor(cursor);
    return cursor;
}

private void showUserData(Cursor cursor) {
    StringBuilder builder = new StringBuilder("Data:\n");
    while (cursor.moveToNext()) {
        String num = cursor.getString(0);
        long smss = cursor.getLong(1);
        long smsr = cursor.getLong(2);
        builder.append("num: ").append(num).append("\n");
        builder.append("sent: ").append(smss).append("\n");
        builder.append("received: ").append(smsr).append("\n");
    }
    TextView text = (TextView) findViewById(R.id.userdata);
    text.setText(builder);
}
} 
```

日志猫：

```
01-10 14:16:56.655: E/AndroidRuntime(2550): FATAL EXCEPTION: main
01-10 14:16:56.655: E/AndroidRuntime(2550): java.lang.RuntimeException: Unable to start activity ComponentInfo{com.app/com.app.Profile}: java.lang.NullPointerException
01-10 14:16:56.655: E/AndroidRuntime(2550):     at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1647)
01-10 14:16:56.655: E/AndroidRuntime(2550):     at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:1663)
01-10 14:16:56.655: E/AndroidRuntime(2550):     at android.app.ActivityThread.access$1500(ActivityThread.java:117)
01-10 14:16:56.655: E/AndroidRuntime(2550):     at android.app.ActivityThread$H.handleMessage(ActivityThread.java:931)
01-10 14:16:56.655: E/AndroidRuntime(2550):     at android.os.Handler.dispatchMessage(Handler.java:99)
01-10 14:16:56.655: E/AndroidRuntime(2550):     at android.os.Looper.loop(Looper.java:123)
01-10 14:16:56.655: E/AndroidRuntime(2550):     at android.app.ActivityThread.main(ActivityThread.java:3683)
01-10 14:16:56.655: E/AndroidRuntime(2550):     at java.lang.reflect.Method.invokeNative(Native Method)
01-10 14:16:56.655: E/AndroidRuntime(2550):     at java.lang.reflect.Method.invoke(Method.java:507)
01-10 14:16:56.655: E/AndroidRuntime(2550):     at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:839)
01-10 14:16:56.655: E/AndroidRuntime(2550):     at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:597)
01-10 14:16:56.655: E/AndroidRuntime(2550):     at dalvik.system.NativeStart.main(Native Method)
01-10 14:16:56.655: E/AndroidRuntime(2550): Caused by: java.lang.NullPointerException
01-10 14:16:56.655: E/AndroidRuntime(2550):     at com.rpgsms.Profile.showUserData(Profile.java:78)
01-10 14:16:56.655: E/AndroidRuntime(2550):     at com.rpgsms.Profile.onCreate(Profile.java:50)
01-10 14:16:56.655: E/AndroidRuntime(2550):     at android.app.Instrumentation.callActivityOnCreate(Instrumentation.java:1047)
01-10 14:16:56.655: E/AndroidRuntime(2550):     at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1611) 
```

UsersData 是应用程序的数据库类。知道为什么会这样吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-10T13:24:17.000

很难判断`Profile.java:78`是哪个语句，但它可能`Cursor`是`null`由`db.query()`. 您需要添加更多错误检查并通过`Log.e()`.

顺便说一句，您可以简化您的`onClick()`方法，而不是创建多个`Intent`具有不同名称的 s：

```
public void onClick (View v) {
    Intent intent = null;
    switch (v.getId()) {
    case R.id.new_sms_button:
        intent = new Intent(this, NewSMS.class);
        break;
    case R.id.about_button:
        intent = new Intent(this, About.class);
        break;
    case R.id.db_button:
        intent = new Intent(this, Profile.class);
        break;
    case R.id.prefs_button:
        intent = new Intent(this, Settings.class);
        break;
    default:
        break;
    }

    if (intent != null) {
        startActivity(intent);
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-10T13:34:47.277

试着`cursor.moveToFirst()`在你的圈子之前打电话`showUserData`。如果这个方法返回`false`，那么你不会得到数据，而是试图处理它。

# android - 使用 GCM 和 ASP.NET 的 Android 推送通知仅由一台设备接收

> ID：14258797
> 
> 赞同：0
> 
> 时间：2013-01-10T13:15:17.703
> 
> 标签：android, asp.net, notifications, push-notification

根据[Google Cloud Messaging For Android (GCM) Simple Tutorial](http://fundroiding.wordpress.com/2012/06/29/google-cloud-messaging-for-android-gcm-simple-tutorial/)，我创建了一个使用 GCM 服务推送通知的 android 应用程序。现在我成功地在设备或模拟器中收到通知，但问题是我只收到一个设备（用于测试目的的设备），而不是安装了其他应用程序的设备。

```
final String regId = GCMRegistrar.getRegistrationId(this); 
```

使用此代码，我得到了注册 ID，我从 logcat 窗口复制的输出并手动发送给我的 .Net 开发人员。他在服务器端复制了该 ID，因此对于该设备，我收到了通知。请帮我将该注册 ID 动态发送到服务器端（Asp.net 服务器）。这样他就可以将这些 id 存储在数据库中，并将注册 id 数组传递给 Google GCM 服务器。我认为只有我们才能收到所有设备（已安装的应用程序）的通知。因为现在在服务器端，我们以这种方式将数据传递给 GCM 服务器：

```
string postData = "collapse_key=score_update&time_to_live=108&delay_while_idle=1&data.message=" + value + "&data.time=" + System.DateTime.Now.ToString() + "&registration_id=" + deviceIDs + ""; 
```

如果我的程序在某处出错，请纠正我。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-10T13:35:14.773

基本上你想要做的是打开一个到你的网络服务器的数据连接，并将你的 gcmid 发送给它以及你想要在你的GCMIntentService 类的 OnRegistered 方法。我向网络服务器发送表单发布请求。在网络服务器上，您可能希望将信息存储在数据库中。我对表单变量使用多维数组

```
public String formPost(String[][] Vars) {

    String url = "put url of web server here";
    HttpClient httpclient = new DefaultHttpClient();
    HttpPost httppost = new HttpPost(url);
    String tmp = null;
    String rturn = null;
    try {
        List<NameValuePair> nameValuePairs = new ArrayList<NameValuePair>(2);
        for (int i = 0; i < Vars.length; i++) {
            nameValuePairs.add(new BasicNameValuePair(Vars[i][0], Vars[i][1]));
        }
        httppost.setEntity(new UrlEncodedFormEntity(nameValuePairs));
        HttpResponse response = httpclient.execute(httppost);
        String ttmp = parseISToString(response.getEntity().getContent());
        Log.i("test", ttmp);
        if (ttmp.contains("Success")) {
            rturn = ttmp;
            Log.i("test", "Success:" + ttmp);
        } else {
            rturn = ttmp;
            Log.i("test", "Fail:" + ttmp);
        }

    } catch (ClientProtocolException e) {

    } catch (IOException e) {
    } /*
     * catch (RuntimeException e){ Context context =
     * getApplicationContext(); CharSequence text =
     * "There was an error try again later."; int duration =
     * Toast.LENGTH_SHORT; Toast toast = Toast.makeText(context, text,
     * duration);toast.show(); Log.i("test",e.getMessage()); finish(); }
     */
    return rturn;

} 
```

# javascript - 使用 JavaScript 动画/移动精灵时出现口吃

> ID：14258803
> 
> 赞同：0
> 
> 时间：2013-01-10T13:15:37.070
> 
> 标签：javascript, css, animation, sprite, css-sprites

我正在尝试通过在 div 上移动精灵图像来创建动画。精灵图像包含动画的每一帧。“画布”的大小为 600 像素 x 624 像素。精灵表上的每一帧每 600 像素定位一次，我一次将图像移动 600 像素。

这是我到目前为止所拥有的...... [voyced.com/crownacre/www/demo/sprite.html](http://voyced.com/crownacre/www/demo/sprite.html)

我正在使用以下 JavaScript 在屏幕上移动图像...

```
(function myLoop(i) {
    setTimeout(function() {
        defImg.css({
            right: '-=600'
        });
        if(--i) myLoop(i); //  decrement i and call myLoop again if i > 0
    }, 60) // delay ms
})(114); // number of frames in the sprite 
```

我使用了几个精灵都向左浮动，精灵表的总宽度为 69000 像素，如果我只使用一张图像，这会导致更多问题！因此，为什么我现在有 4 个。

所以......我遇到的问题是动画暂停了几次。在 Firefox 中（对我而言）似乎很好，但您在 Chrome 中会注意到它，并且在 IE 中不会错过它。

它也总是每隔 16200 像素就会卡顿，这让我认为这与将 1 个精灵移动到屏幕上的下一个精灵有关。

想法取悦人？

提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-10T14:43:55.773

您是否尝试过使用精灵动画插件？

[http://www.spritely.net/](http://www.spritely.net/)

做你想做的，似乎在他们的演示中运行良好。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-10T15:16:48.653

首先让我说：您尝试显示为精灵的巨大图像并不完全是精灵/动画的用途。您可以更好地研究**真正的** `<canvas>`解决方案（尤其是在查看动画时），但这需要一些更复杂的 JavaScript 技能。

无论如何，口吃的问题是因为您正在使用几个图像，这些图像都被`float`编入,`left`和属性。每次需要显示另一张图像时，*都会*注意到卡顿。这可能与浏览器引擎有关，需要绘制实际图像（这很难，因为它们很大）。`position``slider``right`

 *因此，除了使用多张图片，您还可以使用一张（请注意，您可能希望将其设为 a`.JPG`或`.GIF`因为它们往往比 更紧凑）`.PNG`并使用**带有**`background-position`.

[**这是一个使用您的代码的示例，以及一张图片**](http://jsfiddle.net/tmRJN/)。祝你好运！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-11T11:09:05.800

再次感谢反馈的家伙。我结合了您的提示，这些提示帮助我解决了我遇到的问题。

1.  Spritely 帮了大忙。本质上，它与@marcoK 建议的做法相同，并调整了 background-position 属性。这个插件还提供了一种简单的方法来控制精灵的每一帧，以及在到达指定帧时创建回调 - 太棒了！

2.  另一个问题是巨大的精灵。移动 safari 不允许任何大于 3MP 的内容，因此我可以制作的图像的最大尺寸为 4800x624。我将其中的 15 个作为单独的动画，当它到达最后一帧时调用下一个。我对这个能否顺利运行持怀疑态度，但它确实如此，并且在所有浏览器中都是如此。

我对它发出的请求数量并不太满意，但是在优化 png 之后，如果我添加一个预加载器，文件大小也不会太糟糕。

对结果真的很满意... [http://www.crownacre.voyced.com/](http://www.crownacre.voyced.com/)还有一个不使用 Flash 的理由！*

# php - 如何获取有关失败请求的更多信息

> ID：14258804
> 
> 赞同：0
> 
> 时间：2013-01-10T13:15:36.823
> 
> 标签：php, http

这是我收到的错误消息：

**警告**：file_get_contents(http://example.com/.../asoplayhd2.jpg) [function.file-get-contents]：打开流失败：HTTP 请求失败！在**/home/dttrading/qtech.sk/static/agem_images_download.php**第**40行**

有什么方法可以找到有关请求失败原因的更多信息？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-10T13:24:07.340

尝试使用卷曲

```
$ch = curl_init();

// set URL and other appropriate options
curl_setopt($ch, CURLOPT_URL, "http://www.example.com/");
curl_setopt($ch, CURLOPT_HEADER, false);
curl_exec($ch);

curl_close($ch); 
```

# java - 从多个 jar 中的单个 jar 加载一个类

> ID：14258813
> 
> 赞同：0
> 
> 时间：2013-01-10T13:15:58.640
> 
> 标签：java, maven, classloader

我想让你在代码中使用一个类'javax.xml.stream.XMLOutputFactory'。该类（XMLOutputFactory）在多个库中可用，这些库作为 maven 依赖项包含在内。问题：类（XMLOutputFactory）正在从 jar 文件加载，而我希望从其他 jar 加载。是否有任何解决方案可以自定义从特定 jar 文件加载类。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-10T13:19:20.450

不是在 java 方面（或者可能通过实现一个新的类加载器，但这不是解决您的问题的合理解决方案）。

您可能应该在 pom 文件中排除您不想要的依赖项（版本）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-10T13:22:11.763

从 maven 2.0.9 开始，类路径是根据 pom.xml 中的依赖声明生成的。

来自[Maven 网站](http://maven.apache.org/guides/introduction/introduction-to-dependency-mechanism.html)：

> 请注意，如果两个依赖版本在依赖树中的深度相同，则在 Maven 2.0.8 之前没有定义哪个会获胜，但从 Maven 2.0.9 开始，声明中的顺序很重要：第一个声明获胜。

因此，如果您处理 pom.xml 中的依赖项排序，则可以解决您的问题

# svm - Canny 算法是否足以创建特征描述符图像并为 SVM 提供？

> ID：14258814
> 
> 赞同：0
> 
> 时间：2013-01-10T13:16:04.090
> 
> 标签：svm, contour, scikit-learn, descriptor, feature-extraction

我使用精明算法从图像中检索轮廓。有一个描述符图像并放入 SVM 并找到相似之处就足够了吗？或者我需要其他特征，如伸长率、周长、面积？我谈论这个，因为受到这个例子的启发：[http](http://scikit-learn.org/dev/auto_examples/plot_digits_classification.html) ://scikit-learn.org/dev/auto_examples/plot_digits_classification.html我首先给出我的灰度图像，其次是精明的算法风格，在这两种情况下我的混淆矩阵都很多为 0，例如精度、召回率、f1 分数、支持度量

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-04-17T08:52:23.200

我的建议是：

除非您的数据库中的图像数量很少和/或识别将非常具体（例如，不是随机的事情），否则我强烈建议您应用一个或多个特征提取器，例如[SIFT](https://stackoverflow.com/questions/22722772/how-to-use-sift-in-opencv)、[傅里叶描述符](http://answers.opencv.org/question/57074/shape-matching-using-fourier-descriptor-frequency-domain/)、[Haralick 的特征](https://stackoverflow.com/questions/22113684/texture-recognition-within-a-specific-area-in-the-pic), [Hough 变换](http://docs.opencv.org/doc/tutorials/imgproc/imgtrans/hough_lines/hough_lines.html)以提取更多细节，这些细节可以总结在一个短向量中。

然后，您可以在所有这些之后应用 SVM 以获得更高的准确性。

# asp.net - 手机浏览器 c# asp.net mvc3

> ID：14258816
> 
> 赞同：1
> 
> 时间：2013-01-10T13:16:12.437
> 
> 标签：asp.net, asp.net-mvc, authorization

我刚刚在工作时关闭了电脑，我不得不快速检查是否有问题。但是我在桌面上点击了我的移动谷歌浏览器并去测试是否修复了错误。

这就是麻烦开始的地方，突然我无法举行会议。我可以登录 Web 应用程序，但无法举行会话。每次我登录时都会在 url 中放入奇怪的字符串，但我就是无法让我的浏览器保持会话。我检查了浏览器设置，我删除了所有 cookie，我重新启动了浏览器等。没有什么能帮助保持会话。

在测试时，我注意到我正在使用我的移动 google chrome 浏览器，在我检查了台式机的普通 google chrome 浏览器后，我能够保持会话。

我使用普通的 asp.net 身份验证实现，没有什么重要的自定义。但对于未来向移动平台的扩展来说，这相当令人不安。你们中的任何人都知道是什么导致了这个错误？这是谷歌浏览器（移动）中的错误吗？可能吗

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-11T09:14:16.463

在名为 App_Browsers 的文件夹中创建一个名为 generic.browser 的文件并将其放入其中：

```
<browsers>
  <browser refID="GenericDownlevel">
    <capabilities>
      <capability name="cookies" value="true" />
    </capabilities>
  </browser>
</browsers> 
```

这将解决cookie未启用的问题。显然这是在 ASP.NET 4.5 中修复的。

来源： [http ://www.hanselman.com/blog/FormsAuthenticationOnASPNETSitesWithTheGoogleChromeBrowserOnIOS.aspx](http://www.hanselman.com/blog/FormsAuthenticationOnASPNETSitesWithTheGoogleChromeBrowserOnIOS.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-10T21:42:14.783

Mobile chrome occasionally tends to do that with mvc3 and mvc4\. I'm not sure if anyone yet knows why. Having cookies on and setting the UseCookies in Web.Config doesn't help. Furthermore, I'm not sure if Web Forms is affected. But since I've seen this only in Mobile Chrome, I'd say it's something Google needs to fix.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-10T13:53:35.340

这是因为`Cookies`可能被禁用。表单身份验证依赖于`Cookies`.

# google-maps-api-3 - Google Map API v3 箭头缩放级别

> ID：14258821
> 
> 赞同：0
> 
> 时间：2013-01-10T13:16:18.997
> 
> 标签：google-maps-api-3

我正在尝试使用 Google Map APT V3 绘制多边形箭头。请参阅下面的代码。问题是当我缩小地图箭头时保持不变。有什么方法可以调整箭头的缩放级别？

```
 var myCoordinates = [
new google.maps.LatLng(54.065836, -7.415771),
new google.maps.LatLng(53.219191, -7.261963)
];
        var polyOptions = {
            path: myCoordinates,
            strokeColor: "#FF0000",
            strokeOpacity: 1,
            strokeWeight: 3
, icons: [{ icon: { path: google.maps.SymbolPath.FORWARD_OPEN_ARROW,  scale: 2 }, offset: "100%"}]
        }
        var it = new google.maps.Polyline(polyOptions);
        it.setMap(map); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-10T14:20:10.977

您可以为`zoom_changed`地图上的事件设置一个事件侦听器，它可以调整图标 Symbol 对象的 scale 属性。

# android - android maps api v2中的彩色折线

> ID：14258830
> 
> 赞同：3
> 
> 时间：2013-01-10T13:17:00.217
> 
> 标签：android, polyline, linear-gradients, android-maps-v2

我想在 android maps api 版本 2 中绘制折线。我希望它有多种颜色，最好是渐变。但在我看来，折线只允许有单一颜色。我怎样才能做到这一点？我已经有了 api-v1 覆盖画我喜欢的东西，所以想必我可以重用一些代码

```
public class RouteOverlayGoogle extends Overlay {
    public void draw(Canvas canvas, MapView mapView, boolean shadow) {
       //(...) draws line with color representing speed
    } 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2015-05-11T21:39:47.357

我知道自从有人问这个问题以来已经有很长时间了，**但是仍然没有渐变折线**（截至撰写本文时，〜 2015 年 5 月）并且绘制多条折线确实不会削减它（锯齿状的边缘，当处理几百个点，只是在视觉上不是很吸引人）。

当我不得不实现渐变多段线时，我最终做的是实现一个`TileOverlay`将多段线渲染到画布然后栅格化它的方法（请参阅此要点了解我编写的具体代码[https://gist.github.com /Dagothig/5f9cf0a4a7a42901a7b2](https://gist.github.com/Dagothig/5f9cf0a4a7a42901a7b2)）。

该实现不会尝试进行任何类型的视口剔除，因为我最终不需要它来达到我想要的性能（我不确定数字，但每个图块不到一秒，并且多个图块将是同时渲染）。

正确渲染渐变折线可能非常棘手，但是因为您正在处理不同的视口（位置和大小）：不仅如此，我还遇到了一些问题，即在高缩放级别（20+）下浮动精度的限制。最后我没有使用画布上的缩放和翻译功能，因为我会遇到奇怪的腐败问题。

如果您使用与我所拥有的数据结构相似的数据结构（纬度、经度和时间戳），还有一点需要注意的是，您需要多个段来正确渲染渐变（我最终一次使用 3 个点）。

为了后代的缘故，我还将在这里留下要点中的代码：（如果您想知道来自哪里，则使用[https://github.com/googlemaps/android-maps-utils完成预测）](https://github.com/googlemaps/android-maps-utils)`com.google.maps.android.projection.SphericalMercatorProjection`

```
import android.content.Context;
import android.graphics.Bitmap;
import android.graphics.Canvas;
import android.graphics.Color;
import android.graphics.LinearGradient;
import android.graphics.Matrix;
import android.graphics.Paint;
import android.graphics.Shader;

import com.google.android.gms.maps.model.LatLng;
import com.google.android.gms.maps.model.Tile;
import com.google.android.gms.maps.model.TileProvider;
import com.google.maps.android.SphericalUtil;
import com.google.maps.android.geometry.Point;
import com.google.maps.android.projection.SphericalMercatorProjection;

import java.io.ByteArrayOutputStream;
import java.util.List;

/**
 * Tile overlay used to display a colored polyline as a replacement for the non-existence of gradient
 * polylines for google maps
 */
public class ColoredPolylineTileOverlay<T extends ColoredPolylineTileOverlay.PointHolder> implements TileProvider {

    public static final double LOW_SPEED_CLAMP_KMpH = 0;
    public static final double LOW_SPEED_CLAMP_MpS = 0;
    // TODO: calculate speed as highest speed of pointsCollection
    public static final double HIGH_SPEED_CLAMP_KMpH = 50;
    public static final double HIGH_SPEED_CLAMP_MpS = HIGH_SPEED_CLAMP_KMpH * 1000 / (60 * 60);
    public static final int BASE_TILE_SIZE = 256;

    public static int[] getSpeedColors(Context context) {
        return new int[] {
                context.getResources().getColor(R.color.polyline_low_speed),
                context.getResources().getColor(R.color.polyline_med_speed),
                context.getResources().getColor(R.color.polyline_high_speed)
        };
    }

    public static float getSpeedProportion(double metersPerSecond) {
        return (float)(Math.max(Math.min(metersPerSecond, HIGH_SPEED_CLAMP_MpS), LOW_SPEED_CLAMP_MpS) / HIGH_SPEED_CLAMP_MpS);
    }

    public static int interpolateColor(int[] colors, float proportion) {
        int rTotal = 0, gTotal = 0, bTotal = 0;
        // We correct the ratio to colors.length - 1 so that
        // for i == colors.length - 1 and p == 1, then the final ratio is 1 (see below)
        float p = proportion * (colors.length - 1);

        for (int i = 0; i < colors.length; i++) {
            // The ratio mostly resides on the 1 - Math.abs(p - i) calculation :
            // Since for p == i, then the ratio is 1 and for p == i + 1 or p == i -1, then the ratio is 0
            // This calculation works BECAUSE p lies within [0, length - 1] and i lies within [0, length - 1] as well
            float iRatio = Math.max(1 - Math.abs(p - i), 0.0f);
            rTotal += (int)(Color.red(colors[i]) * iRatio);
            gTotal += (int)(Color.green(colors[i]) * iRatio);
            bTotal += (int)(Color.blue(colors[i]) * iRatio);
        }

        return Color.rgb(rTotal, gTotal, bTotal);
    }

    protected final Context context;
    protected final PointCollection<T> pointsCollection;
    protected final int[] speedColors;
    protected final float density;
    protected final int tileDimension;
    protected final SphericalMercatorProjection projection;

    // Caching calculation-related stuff
    protected LatLng[] trailLatLngs;
    protected Point[] projectedPts;
    protected Point[] projectedPtMids;
    protected double[] speeds;

    public ColoredPolylineTileOverlay(Context context, PointCollection pointsCollection) {
        super();

        this.context = context;
        this.pointsCollection = pointsCollection;
        speedColors = getSpeedColors(context);
        density = context.getResources().getDisplayMetrics().density;
        tileDimension = (int)(BASE_TILE_SIZE * density);
        projection = new SphericalMercatorProjection(BASE_TILE_SIZE);
        calculatePointsAndSpeeds();
    }
    public void calculatePointsAndSpeeds() {
        trailLatLngs = new LatLng[pointsCollection.getPoints().size()];
        projectedPts = new Point[pointsCollection.getPoints().size()];
        projectedPtMids = new Point[Math.max(pointsCollection.getPoints().size() - 1, 0)];
        speeds = new double[Math.max(pointsCollection.getPoints().size() - 1, 0)];

        List<T> points = pointsCollection.getPoints();
        for (int i = 0; i < points.size(); i++) {
            T point = points.get(i);
            LatLng latLng = point.getLatLng();
            trailLatLngs[i] = latLng;
            projectedPts[i] = projection.toPoint(latLng);

            // Mids
            if (i > 0) {
                LatLng previousLatLng = points.get(i - 1).getLatLng();
                LatLng latLngMid = SphericalUtil.interpolate(previousLatLng, latLng, 0.5);
                projectedPtMids[i - 1] = projection.toPoint(latLngMid);

                T previousPoint = points.get(i - 1);
                double speed = SphericalUtil.computeDistanceBetween(latLng, previousLatLng) / ((point.getTime() - previousPoint.getTime()) / 1000.0);
                speeds[i - 1] = speed;
            }
        }
    }

    @Override
    public Tile getTile(int x, int y, int zoom) {
        // Because getTile can be called asynchronously by multiple threads, none of the info we keep in the class will be modified
        // (getTile is essentially side-effect-less) :
        // Instead, we create the bitmap, the canvas and the paints specifically for the call to getTile

        Bitmap bitmap = Bitmap.createBitmap(tileDimension, tileDimension, Bitmap.Config.ARGB_8888);

        // Normally, instead of the later calls for drawing being offset, we would offset them using scale() and translate() right here
        // However, there seems to be funky issues related to float imprecisions that happen at large scales when using this method, so instead
        // The points are offset properly when drawing
        Canvas canvas = new Canvas(bitmap);

        Matrix shaderMat = new Matrix();
        Paint gradientPaint = new Paint();
        gradientPaint.setStyle(Paint.Style.STROKE);
        gradientPaint.setStrokeWidth(3f * density);
        gradientPaint.setStrokeCap(Paint.Cap.BUTT);
        gradientPaint.setStrokeJoin(Paint.Join.ROUND);
        gradientPaint.setFlags(Paint.ANTI_ALIAS_FLAG);
        gradientPaint.setShader(new LinearGradient(0, 0, 1, 0, speedColors, null, Shader.TileMode.CLAMP));
        gradientPaint.getShader().setLocalMatrix(shaderMat);

        Paint colorPaint = new Paint();
        colorPaint.setStyle(Paint.Style.STROKE);
        colorPaint.setStrokeWidth(3f * density);
        colorPaint.setStrokeCap(Paint.Cap.BUTT);
        colorPaint.setStrokeJoin(Paint.Join.ROUND);
        colorPaint.setFlags(Paint.ANTI_ALIAS_FLAG);

        // See https://developers.google.com/maps/documentation/android/views#zoom for handy info regarding what zoom is
        float scale = (float)(Math.pow(2, zoom) * density);

        renderTrail(canvas, shaderMat, gradientPaint, colorPaint, scale, x, y);

        ByteArrayOutputStream baos = new ByteArrayOutputStream();
        bitmap.compress(Bitmap.CompressFormat.PNG, 100, baos);
        return new Tile(tileDimension, tileDimension, baos.toByteArray());
    }

    public void renderTrail(Canvas canvas, Matrix shaderMat, Paint gradientPaint, Paint colorPaint, float scale, int x, int y) {
        List<T> points = pointsCollection.getPoints();
        double speed1, speed2;
        MutPoint pt1 = new MutPoint(), pt2 = new MutPoint(), pt3 = new MutPoint(), pt1mid2 = new MutPoint(), pt2mid3 = new MutPoint();

        // Guard statement: if the trail is only 1 point, just render the point by itself as a speed of 0
        if (points.size() == 1) {
            pt1.set(projectedPts[0], scale, x, y, tileDimension);
            speed1 = 0;
            float speedProp = getSpeedProportion(speed1);

            colorPaint.setStyle(Paint.Style.FILL);
            colorPaint.setColor(interpolateColor(speedColors, speedProp));
            canvas.drawCircle((float) pt1.x, (float) pt1.y, colorPaint.getStrokeWidth() / 2f, colorPaint);
            colorPaint.setStyle(Paint.Style.STROKE);

            return;
        }

        // Guard statement: if the trail is exactly 2 points long, just render a line from A to B at d(A, B) / t speed
        if (points.size() == 2) {
            pt1.set(projectedPts[0], scale, x, y, tileDimension);
            pt2.set(projectedPts[1], scale, x, y, tileDimension);
            speed1 = speeds[0];
            float speedProp = getSpeedProportion(speed1);

            drawLine(canvas, colorPaint, pt1, pt2, speedProp);

            return;
        }

        // Because we want to be displaying speeds as color ratios, we need multiple points to do it properly:
        // Since we use calculate the speed using the distance and the time, we need at least 2 points to calculate the distance;
        // this means we know the speed for a segment, not a point.
        // Furthermore, since we want to be easing the color changes between every segment, we have to use 3 points to do the easing;
        // every line is split into two, and we ease over the corners
        // This also means the first and last corners need to be extended to include the first and last points respectively
        // Finally (you can see about that in getTile()) we need to offset the point projections based on the scale and x, y because
        // weird display behaviour occurs
        for (int i = 2; i < points.size(); i++) {
            pt1.set(projectedPts[i - 2], scale, x, y, tileDimension);
            pt2.set(projectedPts[i - 1], scale, x, y, tileDimension);
            pt3.set(projectedPts[i], scale, x, y, tileDimension);

            // Because we want to split the lines in two to ease over the corners, we need the middle points
            pt1mid2.set(projectedPtMids[i - 2], scale, x, y, tileDimension);
            pt2mid3.set(projectedPtMids[i - 1], scale, x, y, tileDimension);

            // The speed is calculated in meters per second (same format as the speed clamps); because getTime() is in millis, we need to correct for that
            speed1 = speeds[i - 2];
            speed2 = speeds[i - 1];
            float speed1Prop = getSpeedProportion(speed1);
            float speed1to2Prop = getSpeedProportion((speed1 + speed2) / 2);
            float speed2Prop = getSpeedProportion(speed2);

            // Circle for the corner (removes the weird empty corners that occur otherwise)
            colorPaint.setStyle(Paint.Style.FILL);
            colorPaint.setColor(interpolateColor(speedColors, speed1to2Prop));
            canvas.drawCircle((float)pt2.x, (float)pt2.y, colorPaint.getStrokeWidth() / 2f, colorPaint);
            colorPaint.setStyle(Paint.Style.STROKE);

            // Corner
            // Note that since for the very first point and the very last point we don't split it in two, we used them instead.
            drawLine(canvas, shaderMat, gradientPaint, colorPaint, i - 2 == 0 ? pt1 : pt1mid2, pt2, speed1Prop, speed1to2Prop);
            drawLine(canvas, shaderMat, gradientPaint, colorPaint, pt2, i == points.size() - 1 ? pt3 : pt2mid3, speed1to2Prop, speed2Prop);
        }
    }

    /**
     * Note: it is assumed the shader is 0, 0, 1, 0 (horizontal) so that it lines up with the rotation
     * (rotations are usually setup so that the angle 0 points right)
     */
    public void drawLine(Canvas canvas, Matrix shaderMat, Paint gradientPaint, Paint colorPaint, MutPoint pt1, MutPoint pt2, float ratio1, float ratio2) {
        // Degenerate case: both ratios are the same; we just handle it using the colorPaint (handling it using the shader is just messy and ineffective)
        if (ratio1 == ratio2) {
            drawLine(canvas, colorPaint, pt1, pt2, ratio1);
            return;
        }
        shaderMat.reset();

        // PS: don't ask me why this specfic orders for calls works but other orders will mess up
        // Since every call is pre, this is essentially ordered as (or my understanding is that it is):
        // ratio translate -> ratio scale -> scale to pt length -> translate to pt start -> rotate
        // (my initial intuition was to use only post calls and to order as above, but it resulted in odd corruptions)

        // Setup based on points:
        // We translate the shader so that it is based on the first point, rotated towards the second and since the length of the
        // gradient is 1, then scaling to the length of the distance between the points makes it exactly as long as needed
        shaderMat.preRotate((float) Math.toDegrees(Math.atan2(pt2.y - pt1.y, pt2.x - pt1.x)), (float)pt1.x, (float)pt1.y);
        shaderMat.preTranslate((float)pt1.x, (float)pt1.y);
        float scale = (float)Math.sqrt(Math.pow(pt2.x - pt1.x, 2) + Math.pow(pt2.y - pt1.y, 2));
        shaderMat.preScale(scale, scale);

        // Setup based on ratio
        // By basing the shader to the first ratio, we ensure that the start of the gradient corresponds to it
        // The inverse scaling of the shader means that it takes the full length of the call to go to the second ratio
        // For instance; if d(ratio1, ratio2) is 0.5, then the shader needs to be twice as long so that an entire call (1)
        // Results in only half of the gradient being used
        shaderMat.preScale(1f / (ratio2 - ratio1), 1f / (ratio2 - ratio1));
        shaderMat.preTranslate(-ratio1, 0);

        gradientPaint.getShader().setLocalMatrix(shaderMat);

        canvas.drawLine(
                (float)pt1.x,
                (float)pt1.y,
                (float)pt2.x,
                (float)pt2.y,
                gradientPaint
        );
    }
    public void drawLine(Canvas canvas, Paint colorPaint, MutPoint pt1, MutPoint pt2, float ratio) {
        colorPaint.setColor(interpolateColor(speedColors, ratio));
        canvas.drawLine(
                (float)pt1.x,
                (float)pt1.y,
                (float)pt2.x,
                (float)pt2.y,
                colorPaint
        );
    }

    public interface PointCollection<T extends PointHolder> {
        List<T> getPoints();
    }
    public interface PointHolder {
        LatLng getLatLng();
        long getTime();
    }
    public static class MutPoint {
        public double x, y;

        public MutPoint set(Point point, float scale, int x, int y, int tileDimension) {
            this.x = point.x * scale - x * tileDimension;
            this.y = point.y * scale - y * tileDimension;
            return this;
        }
    }
} 
```

请注意，此实现假设了两个相对较大的事情：

1.  折线已经完成
2.  只有一条折线。

我认为处理（1）不会很困难。但是，如果您打算以这种方式绘制多条折线，您可能需要寻找一些方法来提高性能（保留折线的边界框以便能够轻松丢弃那些不适合视口的折线）。

关于使用 a 要记住的另一件事`TileOverlay`是，它是在动作完成后渲染的，而不是在执行期间渲染；因此，您可能希望在其下方使用实际的单色折线来备份叠加层，以使其具有一定的连续性。

PS：这是我第一次尝试回答问题，所以如果有什么我应该解决或做不同的事情，请告诉我。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-13T06:54:21.353

一种简单的解决方案：绘制多条折线并单独设置颜色。

# ios - 如何强制 Vimeo 播放器使用 UIWebView 内联播放？

> ID：14258833
> 
> 赞同：3
> 
> 时间：2013-01-10T13:17:05.737
> 
> 标签：ios, uiwebview, vimeo

我正在使用以下代码在 UIWebView 中显示 Vimeo 播放器：

```
_webView.delegate = self;
_webView.allowsInlineMediaPlayback = YES;    
[_webView loadRequest:[NSURLRequest requestWithURL:[NSURL URLWithString:@"http://player.vimeo.com/video/12536488"]]]; 
```

现在，当我单击播放按钮时，会出现原生 iPhone 电影播放器​​。

**如何启用内联播放？**

我已经尝试做的是在加载页面以设置*webkit-playsinline*属性后访问*视频元素。*我写：

 *```
- (void)webViewDidFinishLoad:(UIWebView *)webView {
    [_webView stringByEvaluatingJavaScriptFromString:@"var video = document.getElementsByTagName('video')[0];"];
} 
```

但*视频*变量似乎未定义。

任何想法，将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-02T12:27:42.323

毕竟我们决定使用付费帐户。Vimeo 为存储在“专业”帐户上的视频提供直接链接。*

# lync - 为 Lync 响应组启用呼叫转移

> ID：14258843
> 
> 赞同：1
> 
> 时间：2013-01-10T13:17:35.477
> 
> 标签：lync

当 Lync 响应组收到呼叫时，Lync 服务器不会应用用户呼叫转接选项或同时响铃。

在我看来，SIP 消息中有一个标题，可以防止响应组呼叫的呼叫转移。

可以使用 MSPL 脚本或其他方式更改此行为吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-19T10:23:07.800

可以使用受信任的服务器应用程序将呼叫转发到响应组。

为响应组的所有成员创建 UserEndpoint 并将它们注册为来电。

当收到来电事件时，检查它是否来自响应组并转发它

```
e.call.Forward(forwardUri); 
```

以下是检查呼叫是否来自响应组的方法： [检测来电是否发往响应组](https://stackoverflow.com/questions/14688124/detect-if-incoming-call-is-destined-to-response-group)

可以通过注册 UserEndpoint 来接收状态通知来接收用户的呼叫转移选项。在存在通知中有一个路由类别，其中包含转发选项。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-04-08T13:29:21.247

[在这里用 M. Greenlee](http://blog.greenl.ee/2013/12/16/response-groups-call-forwarding/)解释这个主题，响应组对其成员的调用包含两个额外的 SIP 标头：`Ms-Sensitivity`和`Ms-Target-Class`。这两个标头使用户的呼叫转移设置被忽略，原因如下：

> 请记住，忽略呼叫转移的默认行为主要是设计使然：出于几个原因，您通常不希望 Response Group 呼叫转到您的手机。首先，根据通过响应组的呼叫类型，您可能不希望被手机上的这些呼叫打断。其次，如果您的手机语音邮件接听了响应组呼叫，例如，响应组服务将认为该呼叫已接听，并且可能不会转到实际可以接听的另一个人。

如果您确实想更改此行为，请将`MSPL`脚本添加到管道并删除这些标头。遗憾的是，`MSPL`它本身没有删除标头的代码，因此您需要分派到托管应用程序。详细实现见前面提到的帖子。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-04-06T21:00:58.580

是的，可以在 MSPL 脚本/服务器应用程序中完成。

[Michael Greenlee 在这里](http://blog.greenl.ee/2013/12/16/response-groups-call-forwarding/)有一篇关于这个主题的文章。

# ruby-on-rails - 生成 HTML 时是否必须关心缩进？

> ID：14258850
> 
> 赞同：0
> 
> 时间：2013-01-10T13:17:59.703
> 
> 标签：ruby-on-rails, ruby-on-rails-3

如您所知，如果我们使用表单助手，`select_tag`所有生成的 HTML 的缩进都会回到最左边。

然后生成的 HTML 源代码看起来很难看。
你如何处理这个问题？

对 SEO 有影响吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-10T13:23:42.430

只要它的 HTML 有效，搜索引擎就不会关心您的空白/布局。事实上，老实说，他们甚至可以处理无效的标记。恐怕您不会因为拥有清晰的 HTML 布局而获得奖励积分。

漂亮的布局使开发/调试更容易，你至少应该尝试让它看起来很漂亮。但是使用这样的代码生成器并不总是可能的。

专注于让它运作良好，如果你有时间的话，担心以后会美化它；）

如果 Rails 仍然像上次我玩它时一样棒，我确信有一种方法可以修改输出。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-10T13:27:53.880

我使用`erector`gem 来创建我的视图，`erector`它基本上是一个纯 ruby​​ 中的 HTML-DSL，除其他外，它允许`pretty_print`你的 HTML。这通常只是在开发过程中完成，因为额外的空白只会增加页面大小、消耗带宽并稍微减慢浏览器的速度。

出于这个原因，我无法想象搜索引擎会在乎。他们只是可能需要做更多的工作，所以他们的排名可能会低一点，但我什至对此表示怀疑。他们可能关心有效的 HTML，这是`erector`（以及其他模板语言如 HAML 等）的另一个优点。

# java - 从 JUnit 单元测试的角度来看，Java EE 应用程序中 Ant 构建文件之间的层次结构和任务分布

> ID：14258851
> 
> 赞同：1
> 
> 时间：2013-01-10T13:18:00.093
> 
> 标签：java, ant, junit

我的应用程序中的 Ant 构建文件具有以下层次结构：

```
Application
|---MainProject
|       |__ build.xml
|
|---Project1
|       |__ build.xml
|
|---Project2
       |__ build.xml 
```

Ant 目标根据其任务分布如下：

1) MainProject 构建文件`ant`调用`clean`所有其他构建文件的目标

2) 所有项目中的 JUnit 测试都在 MainProject 构建文件中执行，使用一个通用的 junit 目标，其中包含 junit 任务。

3) 其他构建文件中的所有其他任务都是通过`ant`调用`build-project`所有其他文件中的目标来执行的。

4) build-project 目标进一步决定了分别在各个文件中执行的任务。

你觉得这个架构怎么样？对于这种情况，您的方法是什么？推荐的方法是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-10T22:23:14.393

这将是 ANT 中相当典型的多模块构建场景，随着时间的推移，它会导致相当典型的大型单体项目构建......

我的建议是考虑 Maven 如何构建它的多模块项目。您想模拟 Maven 的“本地存储库”概念，每个模块在其中推送其构建的工件。永远不要共享类路径，而是每个“build.xml”文件根据本地 repo 中的文件创建它们：

```
<path id="compile.path">
    <fileset dir="${local.repo.containing.built.jars}" includes="*.jar"/>
    <fileset dir="${dir.containing.third.party.jars}" includes="*.jar"/>
</path> 
```

好处

*   每个子模块都可以以独立的方式（在开发期间）构建，而无需强制重新构建整个项目。
*   您的第 3 方依赖项在您的类路径中明显不同

随着项目的发展，您需要意识到模块之间的相互依赖关系。对于少量子模块，构建顺序是显而易见的，但随着时间的推移，一个子模块可能会依赖于许多其他首先构建的子模块。

最后，[apache ivy](http://ant.apache.org/ivy/)项目提供了将类似 Maven 的功能添加到您的 ANT 构建中的工具。有一个[多模块](http://ant.apache.org/ivy/history/latest-milestone/tutorial/multiproject.html)示例，但是，我发现作为初学者很难理解。我会把它放到你的 backlog 上，并考虑在未来将子模块工件发布到像 Nexus 这样的 Maven 存储库中。这将使您的 ANT 构建与使用 Maven 和 Gradle 等替代构建技术的其他团队兼容。

# 更新

*   [ivy 简单的共享存储库](https://stackoverflow.com/questions/4106143/ivy-simple-shared-repository/4110220#4110220)

# session - 在 clojure/ring 中，如何删除 cookie？

> ID：14258856
> 
> 赞同：16
> 
> 时间：2013-01-10T13:18:25.287
> 
> 标签：session, web-applications, cookies, clojure, ring

假设我想删除一个 cookie（例如 ring 的 session cookie）：

制作这样的响应图：

```
{:cookies {"ring-session" {:value "kill", :max-age 1}}} 
```

似乎工作，但感觉有点hacky。

有没有一种干净的方法来删除它？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2013-01-10T17:14:45.380

这似乎是一种相当合理的方式。[许多网络应用程序](http://php.net/manual/en/function.setcookie.php)删除 cookie 并将其替换为即将过期的 cookie。`:max-age 1`语法使它看起来比它在例如[Javascript](https://stackoverflow.com/a/2144404/90801)中更优雅。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2015-07-11T02:06:52.927

我在 ring.middleware 中使用了 wrap-session 和其他处理程序。将cookie设置为最大年龄在响应中不起作用，因为它刚刚被覆盖（诊断非常令人沮丧！）

这是我需要做的：

```
(defn clear-session! [resp]
 (assoc resp :session nil)) 
```

[来源](https://github.com/ring-clojure/ring/blob/master/ring-core/src/ring/middleware/session.clj#L77)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2017-04-13T01:11:52.300

`ring`似乎不支持这一点，但您可以向用户代理发送一个带有过去值的过期属性的新 cookie。

[更多信息](https://www.rfc-editor.org/rfc/rfc6265#section-4.1.2)

# google-app-engine - 在应用引擎开发服务器上，为什么“应用所有待处理事务并保存数据存储”步骤需要几秒钟？

> ID：14258860
> 
> 赞同：-1
> 
> 时间：2013-01-10T13:18:41.280
> 
> 标签：google-app-engine

这似乎应该在一瞬间发生，至少在本地是这样。是否有一些时间模拟导致它的生产服务器？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-10T15:44:43.620

这取决于本地数据存储中保存了多少数据以及磁盘的速度。我注意到如果您的数据存储中有大量已删除的数据，文件最终仍然很大。

如果要清除数据库，最好删除整个文件而不是删除所有单个实体。

# java - 整数的二进制格式

> ID：14258861
> 
> 赞同：1
> 
> 时间：2013-01-10T13:18:47.580
> 
> 标签：java

我有一种方法可以打印出二进制形式的数字：

```
private static void binary(int n){
   for(int i = 1; i < Math.pow(2, n); i++)
      System.out.println(Integer.toBinaryString(i));
   }
} 
```

输出类似于 n = 3：

```
1
10
11
100
101
110
111 
```

有没有办法像这样打印出来：

```
001
010
011
100
101
110
111 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-10T13:23:48.157

```
 private static void binary(int n){
       String t = ""; int N = 1<<n;
       for (int i=0; i<n;i++) t += "0";
       for (int i = 1; i < N; i++) {
             String s = Integer.toBinaryString(i);
             System.out.println(t.substring(s.length())+s);
       }
    } 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-10T13:23:35.727

我会把它写成

```
private static void binary(int n){
   for(long i = 0, max = 1 << n; i < max; i++) {
      String s = Long.toBinaryString(i);
      while (s.length() < n) s = '0' + s;
      System.out.println(s);
   }
} 
```

或更有效地

```
private static void binary(int n) {
    char[] chars = new char[n];
    for (long i = 0, max = 1 << n; i < max; i++) {
        for (int j = 0; j < n; j++)
            chars[j] = (char) (((i >>> (n - j - 1)) & 1) + '0');
        System.out.println(chars);
    }
}

binary(3); 
```

印刷

```
000
001
010
011
100
101
110
111 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-01-10T13:26:19.967

快速/脏版：

```
System.out.println(Integer.toBinaryString(i+(1<<n)).substring(1)); 
```

（如果 n == 整数中的位数，或者如果您的整数中的位数比您想要打印的多...那么有限，但如果您知道输入可能会更简单一些）

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-01-10T13:27:10.480

尝试：

```
String.format("%" + n + "s", Integer.toBinaryString(i)).replace(' ', '0') 
```

它可能不是最有效的解决方案，但它足够简单和简短。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-01-10T13:53:25.127

```
private static void binary(int n){
   for(int i = 1; i < Math.pow(2, n); i++)
      System.out.println(String.format("%04d", Integer.parseInt(Integer.toBinaryString(i))));
   }
} 
```

[如何在左侧用零填充整数？](https://stackoverflow.com/questions/473282/left-padding-integers-with-zeros-in-java)

# jquery - 将 Select2 应用到 Slickgrid 编辑器

> ID：14258865
> 
> 赞同：1
> 
> 时间：2013-01-10T13:19:00.623
> 
> 标签：jquery, events, slickgrid, jquery-select2

[我正在使用此答案](https://stackoverflow.com/a/4041074/237690)中建议的下拉编辑器，创建如下选择：

```
<select tabindex="0" id='my_select' class="editor-select select2-search">
    <option value="Red">Red</option>
    <option value="Green">Green</option>
    <option value="Blue">Blue</option>
    <option value="Black">Black</option>
    <option value="White">White</option>
</select> 
```

现在我想使用[select2](http://ivaynberg.github.com/select2/)作为下拉菜单。

为了适用`select2`于下拉一个必须调用`$("#my_select").select2()`。由于选择编辑器是动态添加到网格中的，因此对我来说如何做到这一点并不明显。

我需要类似 after_render 但在显示事件之前将 select2 应用于它。将不胜感激任何提示。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-02T10:21:29.137

有一个具体的例子会很好，但我认为基本上可以使用以下策略：

变体 1：您直接在*SelectCellEditor*方法中应用 select2，从您发布的函数中，它应该像这样工作：

```
 this.init = function() {
        if(args.column.options){
          opt_values = args.column.options.split(',');
        }else{
          opt_values ="yes,no".split(',');
        }
        option_str = ""
        for( i in opt_values ){
          v = opt_values[i];
          option_str += "<OPTION value='"+v+"'>"+v+"</OPTION>";
        }
        $select = $("<SELECT tabIndex='0' class='editor-select'>"+ option_str +"</SELECT>");
        $select.appendTo(args.container);
        // init the select2 extension here
        $select.select2();
    }; 
```

第二种变体是使用[突变事件](https://developer.mozilla.org/en-US/docs/DOM/Mutation_events)。这将使*SelectCellEditor*方法保持干净，但有一些限制：版本 9 之前的 IE 根本不支持突变事件，并且在版本 9 中没有正确实现其中的一些，并且这些事件也存在一些性能问题。在您的情况下，您必须收听**DOMNodeInserted**：

```
document.addEventListener("DOMNodeInserted", function(event){
    var target = event.srcElement || event.target,
        $selection = (target && target.tagName.toLowerCase() == 'select') ? 
            $(target) : $(target).find('select');
        // $selection is just for the case the select field 
        // is wrapped in other elements
    if($selection) {
        // apply the select2 extension
        $selection.select2();
    }
}); 
```

我整理了[一个例子](http://jsfiddle.net/4czPG/1/)，它演示了动态应用。

在这种情况下，事件侦听器非常基础，仅限于您的请求，如果您正在寻找更高级和灵活的解决方案，已经有一些库可以处理此类事件，例如[mutabor](https://github.com/Eskat0n/mutabor)。正如我在上面所写的，如果您提供具体代码的示例，这将有助于在真实条件下测试这两种变体。

# android - 使用 ArrayAdapter 在自定义列表视图中滚动时微调器重置值

> ID：14258866
> 
> 赞同：3
> 
> 时间：2013-01-10T13:19:00.200
> 
> 标签：android, listview, android-spinner

我是 android 的初学者....我需要你的帮助。

在我的应用程序中，我使用自定义适配器和自定义行布局创建了一个列表视图。我成功地这样做了，我在所有行中添加了一个图像、文本视图和一个微调器下拉菜单。在下拉列表中有项目数（例如从 0 到 9）

但我的问题是，当我选择下拉菜单并设置一些值时，在滚动列表时，微调器会将自身重置为初始值（此处为 0）。我为微调器使用值 0 到 9 的字符串。

我能做些什么来避免这个问题？任何帮助将不胜感激....提前致谢。

```
//This is my custom adapter code....

public class MyProductsArrayAdapter extends ArrayAdapter<Products> {
Context context;
int resourceId;

Products data[] = null;

public MyProductsArrayAdapter(Context context, int resourceId,
        Products data[]) {
    super(context, resourceId, data);
    this.context = context;
    this.resourceId = resourceId;

    this.data = data;
}

static class ProductsItemViewHolder {

    ImageView image;
    TextView name;
    Spinner number;
}

String[] mArray = new String[] { "0", "1", "2", "3", "4", "5", "6", "7",

        "8", "9" };

public View getView(final int position, View convertView, ViewGroup parent) {
    View rowView = convertView;
    ProductsItemViewHolder holder = null;

    LayoutInflater mInflater = (LayoutInflater) context

            .getSystemService(Activity.LAYOUT_INFLATER_SERVICE);
    if (rowView == null) {

        rowView = mInflater.inflate(R.layout.main2, parent, false);
        holder = new ProductsItemViewHolder();
        holder.image = (ImageView) rowView.findViewById(R.id.item_icon);

        holder.name = (TextView) rowView.findViewById(R.id.tvListItemText);
        holder.number = (Spinner) rowView.findViewById(R.id.NumberSpinner);

        rowView.setTag(holder);

    } else {

        holder = (ProductsItemViewHolder) rowView.getTag();
    }

    Products f = data[position];
    holder.image.setImageResource(f.itemIcon);
    holder.name.setText(f.itemName);

    ArrayAdapter<String> adapter = new ArrayAdapter<String>(context,

            android.R.layout.simple_spinner_item, mArray);

    holder.number.setAdapter(adapter);

    return rowView;

}
} 
```

//这是我的row_layout代码

```
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
android:layout_width="match_parent"
android:layout_height="match_parent"

android:orientation="horizontal" >

<ImageView
    android:id="@+id/item_icon"
    android:layout_width="40dp"
    android:layout_height="40dip"

    android:layout_alignParentLeft="true"
    android:layout_centerVertical="true"
    android:layout_marginLeft="10dip"
    android:gravity="center_vertical"

    android:src="@drawable/ic_launcher" >
</ImageView>

<TextView
    android:id="@+id/tvListItemText"
    android:layout_width="wrap_content"

    android:layout_height="wrap_content"
    android:layout_centerVertical="true"
    android:layout_marginLeft="10dp"
    android:layout_toRightOf="@id/item_icon"

    android:maxWidth="180dp"
    android:maxLines="2"
    android:text="Hello testing"
    android:textColor="@color/brown"
    android:textSize="15dp"

    android:typeface="normal" />

<Spinner
    android:id="@+id/NumberSpinner"
    android:layout_width="80dp"
    android:layout_height="wrap_content"

    android:layout_alignParentRight="true"
    android:layout_centerVertical="true"
    android:layout_marginLeft="0dp" />

</RelativeLayout> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-10T13:43:51.007

在`getView()`您的列表适配器中，您必须调用`YOUR_SPINNER.setSelected(position you set earlier);`

发生这种情况是因为，一旦创建了列表，您总是可以进入`convertView`，`getView`并且作为其默认的微调器状态，它位于 0 位置。

此外，您始终在 getView 方法中对微调器执行 setAdapter，因此这将始终在`getView()`被调用时对其进行初始化，即。在滚动列表时。

我所说的是`setOnItemSelectedListener()`在您的设置上`spinner`，并且在`onItemSelected()`此侦听器的方法中将值设置为您的微调器对象的标记。 `holder.number.setTag(POSITION)`

声明后`holder.number.setAdapter()`做`holder.number.setSelection(Integer.parseInt(number.getTag));`

这样，您将保存您选择的值，并且在`getView()`调用时为其设置相同的索引。

编辑：

是的，将您获得的值设置为方法中的参数`onItemSelected(View v, int arg2)`。这个 arg2 是位置系统告诉你这个位置是由你为这个微调器选择的（系统提供的简单回调）。现在，在同一个方法的实现中，您必须将此值设置为此视图对象的标记，这是此回调的第一个参数。

此外，如果您没有获取此标记值，则`getView()`必须每次都初始化微调器，而不是从 convertView 获取它，因为它可能包含不在视图中的行的重用视图。

此外，如果您在实施我所说的内容时继续遇到问题，您可以采用另一种方法，使`HashTable<integer, integer>`键成为行的索引，值将成为选定的微调项的索引。

所以，在`getView`你可以设置`holder.number.setSelection(hashtable.get(position));`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-25T10:23:50.373

声明 'LayoutInflater mInflater;' 作为全局变量。

初始化 'mInflater = (LayoutInflater) 上下文 .getSystemService(Activity.LAYOUT_INFLATER_SERVICE);' 内部构造函数。

# java - 使用 sqlite 数据库

> ID：14258871
> 
> 赞同：0
> 
> 时间：2013-01-10T13:19:27.157
> 
> 标签：java, database, swing, sqlite, client

我正在开发一个用户在线和离线的应用程序。我希望用户输入的数据与中央数据库同步。

该应用程序位于 Swing 中，并使用 Web 服务来更新中央数据库中的数据。

我认为 SQLite 是一种解决方案，但我担心安全性。每个客户端系统中的关注点将有多个用户，并且每个用户都有他的特定数据。SQLite 支持这个吗？

在这种情况下，SQLite 还有其他替代方案吗？

我有 Oracle 10g 作为我的中央数据库。SQLite 的作用是一个本地数据库，存储数据直到用户上线

编辑:: 我在这里担心 SQLite 文件的安全性。通过我的初步分析，我发现访问 sqlite 文件时没有身份验证等功能。希望我现在很清楚。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-11T08:12:25.480

SQLite 不支持按用户身份验证（您可以使用密码，但对整个数据库文件都一样）。无论如何，按用户身份验证不会是有效的，因为对数据库文件具有读取权限的用户可以直接读取该文件。您可以加密数据，但您必须将解密密钥和算法存储在可执行文件中，用户可以访问它。

当您想保护每个用户的本地数据时，我建议将此责任委托给操作系统。只需在当前用户的私有用户目录中为每个用户存储一个单独的数据库文件（windows 上为 %appdata%，unix 上为 ~/）。只要用户没有 admin/root 权限，操作系统就应该阻止他们访问彼此用户目录中的数据。

当然，这仅在您的应用程序的每个用户在操作系统上也有一个单独的帐户时才有效。如果不是这种情况，您仍然可以为存储在公共位置的每个用户使用单独的数据库，但使用从每个用户的密码派生的密钥加密每个数据库文件。

# c# - BackgroundWorker 挂起

> ID：14258872
> 
> 赞同：0
> 
> 时间：2013-01-10T13:19:28.377
> 
> 标签：c#, visual-studio-2010, timer, thread-safety, backgroundworker

我有一个`BackgroundWorker` `_worker`

```
void _worker_DoWork(object sender, DoWorkEventArgs e)
{
    _timer = new System.Timers.Timer();
    _timer.Elapsed += new System.Timers.ElapsedEventHandler(_timer_Elapsed);
    _timer.Interval = 5000;
    _timer.Start();
} 
```

当它到达这条线`_timer.Start()`时，它认为它已经完成了，所以会触发`RunWorkerCompleted event`.

我不希望它在`_timer.Interval`到达时间并且`_timer Elapsed event`已经触发之前完成：

```
void _timer_Elapsed(object sender, System.Timers.ElapsedEventArgs e)
{
    for (int i = 1; i < 20; i++)
    {
        if (listBox1.InvokeRequired)
            listBox1.Invoke((Action)(() => listBox1.Items.Add("Do Things Thread")));
        else
            listBox1.Items.Add("Do Things Completed");

        _worker.ReportProgress((int)(((decimal)i / (decimal)20) * 100));

        Thread.Sleep(1000);
    }

    _timer.Stop();
} 
```

因为我需要`BackgroundWorker`报告一些进展。

我该怎么做呢。我需要它在不同的`thread`.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-10T16:12:07.980

所以要总结讨论和解决方案。

System.Timers.Timer 将自动为您处理计时器事件，除非您提供同步对象，如 MSDN 中所述：

> 如果 SynchronizingObject 属性为 null，则在 ThreadPool 线程上引发 Elapsed 事件。如果 Elapsed 事件的处理持续时间超过 Interval，则该事件可能会在另一个 ThreadPool 线程上再次引发。在这种情况下，事件处理程序应该是可重入的。

这意味着后台工作人员变得多余。您可以简单地让您的计时器事件代码按原样运行（因为它无论如何都使用调用与 UI 交互）。

这确实意味着如果这些事件需要很长时间，它们可以同时运行。但是，您当然可以在事件回调中停止和启动计时器。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-10T13:33:05.387

我认为，只是通过玩弄我所做的，就是我已经调用了进度条，所以我不需要 ReportProgress：

```
_worker.ReportProgress((int)(((decimal)i / (decimal)20) * 100)); 
```

变成 ：

```
if (progressBar1.InvokeRequired)
    progressBar1.Invoke((Action)(() => progressBar1.Value = (int)(((decimal)i / (decimal)20) * 100)));
else
    progressBar1.Value = (int)(((decimal)i / (decimal)20) * 100); 
```

这意味着，我不必暂停 BackgroundWorker，并且计时器是在不同的线程上调用的，并且会一直保留到处理掉？？？？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-10T13:28:04.323

您的 _timer_Elapsed 事件在不同的线程上。只要控制流通过 _worker_DoWork 函数，计时器的实例就会过期。您的计时器对象变量的范围仅限于函数，因此它不会以这种方式工作。

我建议您将 Thread.sleep(5000) 放入计时器 _worker_dowork 函数本身。它不会影响您的应用程序，因为线程将休眠并且 gui 仍将响应。

# javascript - 使用 textarea 在图像上键入时，文本会延迟一个字符

> ID：14258875
> 
> 赞同：0
> 
> 时间：2013-01-10T13:19:39.500
> 
> 标签：javascript, canvas, textarea

JsFiddle： http: [//jsfiddle.net/shabbirrangwala/h9uaQ/19/](http://jsfiddle.net/shabbirrangwala/h9uaQ/19/) 我试图每行只添加 50 个字符和 17 行，我想以图像的形式获得输出。不知何故，行和列不受限制。我在这里做错了什么？

示例代码：

```
tCtxt.canvas.width = tCtxt.measureText(this.value).width;       
var t = this.value.split('\n'); 

tCtxt.canvas.height = t.length*15;      
tCtxt.font = "12px monospace";
tCtxt.fillStyle = "black";

var y = 12;
for(var i=0; i<t.length; i++, y+=12) {
    tCtxt.fillText(t[i], 0, y);
}  
imageElem.src = tCtxt.canvas.toDataURL(); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-10T13:55:43.770

尝试将 wrap="hard" 添加到 textarea 标记以强制在断点处插入新行

# c# - 使用 Expression 使用嵌套类创建谓词

> ID：14258881
> 
> 赞同：6
> 
> 时间：2013-01-10T13:20:06.910
> 
> 标签：c#, .net, linq, expression, predicate

我有这个 ：

```
public class Company
{
    public int Id { get; set; }
    public string Name { get; set; }
}
public class City
{
    public int Id { get; set; }
    public string Name { get; set; }
    public int ZipCode { get; set; }
}
public class Person
{
    public int Id { get; set; }
    public string FirstName { get; set; }
    public string LastName { get; set; }
    public int? Age { get; set; }
    public City City { get; set; }
    public Company Company { get; set; }
} 
```

我想在某些情况下生成这样的谓词：

```
var result = listPerson.Where(x => x.Age == 10).ToList<>(); 
```

或这个 ：

```
var result  = listPerson.Where( x => x.Company.Name == 1234).ToList(); 
```

或这个 ：

```
var result  = listPerson.Where( x => x.City.ZipCode == "MyZipCode").ToList(); 
```

或这个 ：

```
var result  = listPerson.Where( x => x.Company.Name == "MyCompanyName").ToList(); 
```

然后我创建了一个“PredicateBuilder”，当我这样做时，这是工作（我得到类型，如果可以为空，我构建谓词）：

```
BuildPredicate<Person>("Age", 10); I get this : x => x.Age == 10 
```

但是当有这样的嵌套属性时，我不知道如何管理：

```
BuildPredicate<Person>("City.ZipCode", "MyZipCode"); 
I'd like get this : x => x.City.ZipCode == "MyZipCode" 
```

或这个 ：

```
BuildPredicate<Person>("City.Name", "MyName"); 
I'd like get this : x => x.City.Name == "MyName" 
```

或这个 ：

```
BuildPredicate<Person>("Company.Name", "MyCompanyName"); 
I'd like get this : x => x.Company.Name == "MyCompanyName" 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-01-10T21:50:04.003

（不打算复制 Jon - OP 联系我提供答案）

以下似乎工作正常：

```
static Expression<Func<T,bool>> BuildPredicate<T>(string member, object value) {
    var p = Expression.Parameter(typeof(T));
    Expression body = p;
    foreach (var subMember in member.Split('.')) {
        body = Expression.PropertyOrField(body, subMember);
    }
    return Expression.Lambda<Func<T, bool>>(Expression.Equal(
        body, Expression.Constant(value, body.Type)), p);
} 
```

这与乔恩的答案之间唯一的功能区别是它通过告诉预期类型是什么来处理`null` *得更好。*`Expression.Constant`作为使用演示：

```
static void Main() {
    var pred = BuildPredicate<Person>("City.Name", "MyCity");

    var people = new[] {
        new Person { City = new City { Name = "Somewhere Else"} },
        new Person { City = new City { Name = "MyCity"} },
    };
    var person = people.AsQueryable().Single(pred);
} 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-01-10T13:23:27.943

你只需要用点分割你的表达式，然后迭代它，使用`Expression.Property`多次。像这样的东西：

```
string[] properties = path.Split('.');
var parameter = Expression.Parameter(typeof(T), "x");
var lhs = parameter;
foreach (var property in properties)
{
    lhs = Expression.Property(lhs, property);
}
// I've assumed that the target is a string, given the question. If that's
// not the case, look at Marc's answer.
var rhs  = Expression.Constant(targetValue, typeof(string));
var predicate = Expression.Equals(lhs, rhs);
var lambda = Expression.Lambda<Func<T, bool>>(predicate, parameter); 
```

# jsp - JSP 无法写入文件

> ID：14258883
> 
> 赞同：0
> 
> 时间：2013-01-10T13:20:13.010
> 
> 标签：jsp, tomcat, file-permissions

我有一个可以工作的文件上传 JSP，但现在不行。在我们更换服务器并更新软件（tomcat5 到 tomcat6 等）后，它现在无法正常工作。这是代码：

```
FileOutputStream fileOut = new FileOutputStream(savePathFile);
fileOut.write(dataBytes, startPos, (endPos - startPos)); 
```

该文件是使用第一行 new FileOutputStream(…) (filesize is 0) 创建的，但第二行 .write 会引发异常。该文件的所有者/组是 tomcat/tomcat。

所以看来tomcat应该有正确的权限。
我还查看了 tomcat java 权限策略（catalina.policy），看看是否有正确的 FilePermissions。他们不在那里，所以我们补充说：

```
grant codeBase "file:${catalina.home}/webapps/myapp/-" {
permission java.io.FilePermission "/var/lib/tomcat6/webapps/myapp/photographs", "read, write";
} 
```

但这并没有什么不同。然后我被告知没有在启用安全选项的情况下启动tomcat。

```
tomcat6.conf:SECURITY_MANAGER="false" 
```

我不确定我还应该去哪里看。我有几个明确的问题：

如何查看用户 tomcat 在此目录上实际拥有的权限 (rwx)？

如何验证tomcat是否在启用安全选项的情况下运行？

为了获得许可，它应该是：

```
grant codeBase "file:${catalina.home}/webapps/myapp/admin/-" { 
```

因为upload.jsp 文件在webapps/myapp/admin 目录中？

谢谢你的帮助，弗兰克

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-11T13:53:52.173

这不会回答你的问题，但指向一个完全不同的方向（架构方面）：

将文件直接上传到您的 Web 应用程序是一种不好的做法。有几个原因：

*   您的应用程序可能不会“爆炸”，因此纯粹存在于尚未解压缩到文件系统的 WAR 文件中。因此没有目录可以写入
*   您将需要检查漏洞。否则很容易将恶意文件上传到您的服务器：想象一个`administration.jsp`要上传的文件。Tomcat 将愉快地在服务器端编译/执行它（这可能正是您所追求的，但“照片”文件夹表明它是应该存储在其他地方并由下载 servlet 提供的图像资源 - 您仍然可以使路径看起来好像它被用作静态资源
*   在更新时，您必须记住您的 web 应用程序可能包含与您部署时不同的内容——例如所有上传的资源。如果其他人进行更新以排除故障（“我知道如何升级 tomcat 应用程序 - 可能出现什么问题？”），他们可能会无意中删除所有上传的资源。

通过这些更改，我建议配置一个绝对路径以配置为 tomcat 可写。

回到您最初的问题，您可能想要检查您的新 tomcat 是否确实以对您的目录具有写入权限的用户 tomcat 运行。还要检查文件系统的容量、用户的配额以及目录的所有者和权限

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-12T17:14:16.470

我解决了这个问题——它与解析多部分数据的方式有关。我不确定为什么新服务器会改变，也许是字符编码，但我改变了我的代码并且它正在工作。谢谢大家的评论。

# sql - 使用 Sphinx 进行简单的标签搜索

> ID：14258884
> 
> 赞同：2
> 
> 时间：2013-01-10T13:20:14.817
> 
> 标签：sql, postgresql, sphinx

例如，我有 3 个表：

```
documents (
    id serial PRIMARY KEY,
    title character varying(256),
    content text,
    created timestamp with time zone
);

tags (
    id serial PRIMARY KEY,
    tag_content character varying(128)
);

tag_assoc (
    id serial PRIMARY KEY,
    document_id integer,
    tag_id integer
); 
```

我希望能够搜索`documents`、`title`和`content`for 标签。

我`sql_query`到目前为止非常简单，例如：

```
sql_query SELECT id, title, content FROM documents 
```

我将如何设置 Sphinx sql_query 以便将与每个文档关联的标签连接到它们？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-10T20:55:23.397

您可以在 sql_query 中使用带有 group_concat 的子选择来检索它们，但更好的方法是使用 s `ql_joined_field`。在你的情况下，看起来像：

```
sql_joined_field = tags from query; tag.assoc.document_id, \
                   tag_content from tags join tag_assoc on \
                   tags.id=tar_assoc.tag_id order by tag.assoc.document_id asc 
```

# google-apps-script - 提高电子表格过滤脚本性能

> ID：14258888
> 
> 赞同：0
> 
> 时间：2013-01-10T13:20:28.987
> 
> 标签：google-apps-script, google-sheets

我有一个电子表格，其中第一列包含名称，接下来的 17 列包含 0、1 或为空。每一行看起来像这样：

```
foobar 0 0 0 1 0 1 // and so on 
```

我需要创建从菜单调用的函数，该函数仅向用户显示`1`目标列 ( `arg1`) 中的行。这是代码：

```
var ssBase = SpreadsheetApp.getActiveSheet();
var last = ssBase.getLastRow() ;
var data = ssBase.getDataRange().getValues();

function SkillsFilter(arg1){

  ssBase.showRows(1, last+1);

  for (var i=1; i < last; i++){
    if (data[i][arg1] != "1"){                         
      ssBase.hideRows(i+1);
}}} 
```

这个功能没有我想的那么快。我应该如何提高性能？缓存会帮助我还是其他什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-10T18:52:55.820

您在`for`循环中对电子表格服务进行了多次调用 - 如果您可以将这些操作合二为一，您将看到速度大大提高。阅读[最佳实践](https://developers.google.com/apps-script/best_practices)以获取一些背景和指导。

我建议您重新考虑隐藏和显示各种数据行的方法。相反，您可以显示一个过滤列表，并使用您的菜单功能操作该过滤器。假设您拥有的数据如下所示...

![样本电子表格](../Images/ca7f7f1138750de47c4dc23bb290a151.png)

在电子表格的第二个选项卡上，您可以提供列表的过滤版本。单元格 A2 中的以下公式将从原始数据表（在此示例中称为“主”）创建过滤的数据列表：

```
=filter(Master!A2:R;Master!D2:D="1") 
```

要以编程方式创建该过滤器，请使用该`setFormulaR1C1()`函数。这是一个您可以从菜单项中调用的函数，以便为任何特定列设置过滤器。

```
/**
 * Sets the filter in cell A2 of the sheet named "Filter" to display
 * only rows with a number 1 in the indicated column.
 *
 * @param {number} column The "skill" column to filter for
 */
function setFilter(column) {
  column = column | 2;  // Use first "skill" column as default
  var sheet = SpreadsheetApp.getActiveSpreadsheet().getSheetByName("Filter");
  var formula = "Master!R[0]C[0]:C[17];Master!R[0]C["
       +column
       +"]:C["
       +column
       +"]=1";
  sheet.getRange("A2").setFormulaR1C1(formula);
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-29T18:52:58.450

这段代码将显示包含数字 1 的所有行，考虑列范围：

```
function mySort() {
  var sheet = SpreadsheetApp.getActiveSpreadsheet().getActiveSheet();

  // set col and row
  var col = sheet.getLastColumn(), row = sheet.getLastRow()-1;

  // hide all rows
  sheet.hideRows(2, row);   

  // itterate through columns
  for(var k=0; k<col; k++) {
    this.data = sheet.getRange(2, 1, row, col)
      .sort({column: parseInt(k+1), ascending: true}).getValues();

    //set counters
    var cFirst=0, cSecond=0;

    // itterate to find number of "1" rows in column k
    for(var i=0; i<row; i++) {    
      if(this.data[i][k] == 1) {
        cFirst++;
      } else {
        cSecond++;
      }
    }

    // calculate rowIndex
    var rIndex = row-cSecond;

    // show (unhide) only "1" rows
    sheet.showRows(rIndex+2, cFirst); 
  }
} 
```

请参阅我创建的示例文件：[Show the one's](https://docs.google.com/a/familietuinstra.nl/spreadsheet/ccc?key=0ApDwwZxW-IBcdEZFVWtTZHRRUVVzVFdsS1dJRVlKbFE) . 打开文件时，它会添加另一个菜单项，称为排序。你可以在那里玩耍，看看会发生什么。

# java - EntityManager.flush() 没有立即刷新？

> ID：14258892
> 
> 赞同：1
> 
> 时间：2013-01-10T13:20:36.520
> 
> 标签：java, jakarta-ee, exception, jpa, ejb

我在 EJB 中有这段代码：

```
try{
    em.persist(joueur);
    em.persist(p);
    em.persist(astre);
    em.persist(planet);
    em.flush();         
}catch(Exception e){    
       logger.log(Level.FATAL, "test");
    // ExceptionManager.manageExceptions(e);             
} 
```

这段代码必须抛出异常，因为我已经触发（通过 PostGreQSL）来检查一些约束，并且我使用测试值来启动我的触发器。

我有一个奇怪的结果，因为我的日志显示`test`，所以我输入了 catch 块，但我的代码没有捕获“全部”或“完整”异常，因为我的服务器日志显示所有异常堆栈，我不知道为什么......看起来就像这段代码在......之后抛出异常一样

我知道我必须调用`flush()`方法来立即将实体存储到我的数据库中，但看起来它在这里不起作用，并且异常仍然传播到我的代码中。

几周前这段代码**有效**，但我在另一个项目方面工作过，现在似乎我有某种回归，我不知道为什么......

所以我的问题是这个：`EntityManager.flush()` **总是**立即执行持久操作吗？

**编辑**：这是我的日志（有点净化）（第一个->GF 日志，第二个->Log4j 个人日志）：对不起，它是法语版本，但异常名称保持不变；）

```
[#|2013-01-10T15:03:28.218+0100|WARNING|glassfish3.1.2|org.eclipse.persistence.session.file:/E:/softs/serveurs/glassfish3_1122/glassfish/domains/domain1/applications/ear-0.0.1-SNAPSHOT/lib/entities-0.0.1-SNAPSHOT.jar_01|_ThreadID=72;_ThreadName=Thread-2;|Local 

Exception Stack: 
Exception [EclipseLink-4002] (Eclipse Persistence Services - 2.3.2.v20111125-r10461): 

  org.eclipse.persistence.exceptions.DatabaseException
    Internal Exception: org.postgresql.util.PSQLException: ERREUR: le pseudo est déjà pris (player_name)=(hghghghggg)
    Error Code: 0
Call: INSERT INTO pretoria.pseudos (ID, CHANGEMENT, PSEUDO, VERSION, joueur_id) VALUES (?, ?, ?, ?, ?)
    bind => [5 parameters bound]
Query: InsertObjectQuery(com.sim.entities.Pseudo@190c460)
    at org.eclipse.persistence.exceptions.DatabaseException.sqlException(DatabaseException.java:333)
    at org.eclipse.persistence.internal.databaseaccess.DatabaseAccessor.processExceptionForCommError(DatabaseAccessor.java:1494)
    ................
Caused by: org.postgresql.util.PSQLException: ERREUR: le pseudo est déjà pris (player_name)=(hghghghggg)
    at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2102)
    at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:1835)
    at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:257)
    ................
|#]

[#|2013-01-10T15:03:28.218+0100|WARNING|glassfish3.1.2|org.eclipse.persistence.session.file:/E:/softs/serveurs/glassfish3_1122/glassfish/domains/domain1/applications/ear-0.0.1-SNAPSHOT/lib/entities-0.0.1-SNAPSHOT.jar_01|_ThreadID=72;_ThreadName=Thread-2;|Local Exception Stack: 
Exception [EclipseLink-4002] (Eclipse Persistence Services - 2.3.2.v20111125-r10461): org.eclipse.persistence.exceptions.DatabaseException
Internal Exception: org.postgresql.util.PSQLException: ERREUR: la transaction est annulée, les commandes sont ignorées jusqu'à la fin du bloc
de la transaction
Error Code: 0
Call: INSERT INTO pretoria.joueurs (ID, BLOQUE, cle_validation, creation, EMAIL, LANGAGE, maj_temperament, NEWSLETTER, PASSWORD, POUSSIERE, SEL, TEMPERAMENT, VACANCES, VERSION, alliance_id) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)
    bind => [15 parameters bound]
Query: InsertObjectQuery(com.sim.entities.Joueur@1a21ad9)
    at org.eclipse.persistence.exceptions.DatabaseException.sqlException(DatabaseException.java:333)
    at org.eclipse.persistence.internal.databaseaccess.DatabaseAccessor.processExceptionForCommError(DatabaseAccessor.java:1494)
    at org.eclipse.persistence.internal.databaseaccess.DatabaseAccessor.executeDirectNoSelect(DatabaseAccessor.java:838)
    at org.eclipse.persistence.internal.databaseaccess.DatabaseAccessor.executeNoSelect(DatabaseAccessor.java:906)
    at org.eclipse.persistence.internal.databaseaccess.DatabaseAccessor.basicExecuteCall(DatabaseAccessor.java:592)
    at org.eclipse.persistence.internal.databaseaccess.DatabaseAccessor.executeCall(DatabaseAccessor.java:535)
    at org.eclipse.persistence.internal.sessions.AbstractSession.basicExecuteCall(AbstractSession.java:1717)
    ................
Caused by: org.postgresql.util.PSQLException: ERREUR: la transaction est annulée, les commandes sont ignorées jusqu'à la fin du bloc
de la transaction
    at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2102)
    at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:1835)
    at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:257)
    at org.postgresql.jdbc2.AbstractJdbc2Statement.execute(AbstractJdbc2Statement.java:500)
    ................
|#]

[#|2013-01-10T15:03:28.234+0100|WARNING|glassfish3.1.2|org.eclipse.persistence.session.file:/E:/softs/serveurs/glassfish3_1122/glassfish/domains/domain1/applications/ear-0.0.1-SNAPSHOT/lib/entities-0.0.1-SNAPSHOT.jar_01.transaction|_ThreadID=72;_ThreadName=Thread-2;|Local Exception Stack: 
Exception [EclipseLink-4002] (Eclipse Persistence Services - 2.3.2.v20111125-r10461): org.eclipse.persistence.exceptions.DatabaseException
Internal Exception: org.postgresql.util.PSQLException: ERREUR: la transaction est annulée, les commandes sont ignorées jusqu'à la fin du bloc
de la transaction
Error Code: 0
Call: INSERT INTO pretoria.joueurs (ID, BLOQUE, cle_validation, creation, EMAIL, LANGAGE, maj_temperament, NEWSLETTER, PASSWORD, POUSSIERE, SEL, TEMPERAMENT, VACANCES, VERSION, alliance_id) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)
    bind => [15 parameters bound]
Query: InsertObjectQuery(com.sim.entities.Joueur@1a21ad9)
    at org.eclipse.persistence.exceptions.DatabaseException.sqlException(DatabaseException.java:333)
    at org.eclipse.persistence.internal.databaseaccess.DatabaseAccessor.processExceptionForCommError(DatabaseAccessor.java:1494)
    at org.eclipse.persistence.internal.databaseaccess.DatabaseAccessor.executeDirectNoSelect(DatabaseAccessor.java:838)
    at org.eclipse.persistence.internal.databaseaccess.DatabaseAccessor.executeNoSelect(DatabaseAccessor.java:906)
    ................
Caused by: org.postgresql.util.PSQLException: ERREUR: la transaction est annulée, les commandes sont ignorées jusqu'à la fin du bloc
de la transaction
    at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2102)
    at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:1835)
    at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:257)
    at org.postgresql.jdbc2.AbstractJdbc2Statement.execute(AbstractJdbc2Statement.java:500)
    ................
|#]

[#|2013-01-10T15:03:28.234+0100|WARNING|glassfish3.1.2|javax.enterprise.system.core.transaction.com.sun.jts.jta|_ThreadID=72;_ThreadName=Thread-2;|JTS5054: Unexpected error occurred in after completion
Local Exception Stack: 
Exception [EclipseLink-4002] (Eclipse Persistence Services - 2.3.2.v20111125-r10461): org.eclipse.persistence.exceptions.DatabaseException
Internal Exception: org.postgresql.util.PSQLException: ERREUR: la transaction est annulée, les commandes sont ignorées jusqu'à la fin du bloc
de la transaction
Error Code: 0
Call: INSERT INTO pretoria.joueurs (ID, BLOQUE, cle_validation, creation, EMAIL, LANGAGE, maj_temperament, NEWSLETTER, PASSWORD, POUSSIERE, SEL, TEMPERAMENT, VACANCES, VERSION, alliance_id) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)
    bind => [15 parameters bound]
Query: InsertObjectQuery(com.sim.entities.Joueur@1a21ad9)
    at org.eclipse.persistence.exceptions.DatabaseException.sqlException(DatabaseException.java:333)
    at org.eclipse.persistence.internal.databaseaccess.DatabaseAccessor.processExceptionForCommError(DatabaseAccessor.java:1494)
    at org.eclipse.persistence.internal.databaseaccess.DatabaseAccessor.executeDirectNoSelect(DatabaseAccessor.java:838)
    at org.eclipse.persistence.internal.databaseaccess.DatabaseAccessor.executeNoSelect(DatabaseAccessor.java:906)
    at org.eclipse.persistence.internal.databaseaccess.DatabaseAccessor.basicExecuteCall(DatabaseAccessor.java:592)
    ................
Caused by: org.postgresql.util.PSQLException: ERREUR: la transaction est annulée, les commandes sont ignorées jusqu'à la fin du bloc
de la transaction
    at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2102)
    at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:1835)
    at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:257)
    at org.postgresql.jdbc2.AbstractJdbc2Statement.execute(AbstractJdbc2Statement.java:500)
    ................
|#]

[#|2013-01-10T15:03:28.234+0100|WARNING|glassfish3.1.2|javax.enterprise.system.container.ejb.com.sun.ejb.containers|_ThreadID=72;_ThreadName=Thread-2;|EJB5184:A system exception occurred during an invocation on EJB AccountBean, method: public void com.sim.ejbs.stateless.AccountBean.createAccount(java.lang.String,char[],java.lang.String,com.sim.basics.enums.TemperamentEnum,com.sim.dtos.xml.universes.Universe,int,int,int,java.lang.String,java.lang.String) throws com.sim.basics.exceptions.SimRuntimeException|#]

[#|2013-01-10T15:03:28.234+0100|WARNING|glassfish3.1.2|javax.enterprise.system.container.ejb.com.sun.ejb.containers|_ThreadID=72;_ThreadName=Thread-2;|javax.ejb.EJBException: Transaction aborted
    at com.sun.ejb.containers.BaseContainer.completeNewTx(BaseContainer.java:5142)
    at com.sun.ejb.containers.BaseContainer.postInvokeTx(BaseContainer.java:4901)
    at com.sun.ejb.containers.BaseContainer.postInvoke(BaseContainer.java:2045)
    at com.sun.ejb.containers.BaseContainer.postInvoke(BaseContainer.java:1994)
    at com.sun.ejb.containers.EJBLocalObjectInvocationHandler.invoke(EJBLocalObjectInvocationHandler.java:222)
    at com.sun.ejb.containers.EJBLocalObjectInvocationHandlerDelegate.invoke(EJBLocalObjectInvocationHandlerDelegate.java:89)
    ................
Caused by: javax.transaction.RollbackException
    at com.sun.jts.jta.TransactionManagerImpl.commit(TransactionManagerImpl.java:334)
    at com.sun.enterprise.transaction.jts.JavaEETransactionManagerJTSDelegate.commitDistributedTransaction(JavaEETransactionManagerJTSDelegate.java:185)
    at com.sun.enterprise.transaction.JavaEETransactionManagerSimplified.commit(JavaEETransactionManagerSimplified.java:861)
    at com.sun.ejb.containers.BaseContainer.completeNewTx(BaseContainer.java:5136)
    ... 53 more
|#] 
```

Log4j 日志：

```
2013-01-10 15:03:28,218 FATAL   [com.sim.ejbs.stateless.AccountBean] 

javax.persistence.PersistenceException: Exception [EclipseLink-4002] (Eclipse Persistence Services - 2.3.2.v20111125-r10461): org.eclipse.persistence.exceptions.DatabaseException
Internal Exception: org.postgresql.util.PSQLException: ERREUR: le pseudo est déjà pris (player_name)=(hghghghggg)
Error Code: 0
Call: INSERT INTO pretoria.pseudos (ID, CHANGEMENT, PSEUDO, VERSION, joueur_id) VALUES (?, ?, ?, ?, ?)
    bind => [5 parameters bound]
Query: InsertObjectQuery(com.sim.entities.Pseudo@190c460)
2013-01-10 15:03:28,234 FATAL   [com.sim.web.beans.LoginBean] 123 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-10T13:27:28.410

IIRC 某些数据库实际上可能会在事务提交时执行语句，因此请尝试调用 commit（而不是`flush()`，仅用于测试）并查看它是否也会发生。

编辑：另一方面，JPA 需要在完成后立即获取持久实体的 ID（如果生成策略是 IDENTITY 或 SEQUENCE），所以我上面所说的可能不正确......

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-10T14:08:05.030

是的，flush 总是会刷新。您可能没有执行您认为的代码，或者可能没有得到您期望的异常。启用最好的登录，并尝试调试。

# crystal-reports - 在表 Crystal Report 子报表中添加新列

> ID：14258893
> 
> 赞同：0
> 
> 时间：2013-01-10T13:20:37.157
> 
> 标签：crystal-reports

我用向导生成了子报告。如何在表中插入新列？![在此处输入图像描述](../Images/1852c3e71aa3ae63083f354acac81467.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-13T08:41:25.113

假设您希望在两个现有列之间插入一列（并让您的报表继续看起来不错），这在您使用的 Crystal Reports 版本中并非易事（基于您的屏幕截图）。

您必须调整/移动现有字段和字段标题以腾出空间（单击它们以显示调整大小手柄），然后将新字段从字段资源管理器拖到已创建空间的详细信息部分。

较新版本的 Crystal Reports 添加了“智能格式”功能，使列插入（和相关任务）更容易 -[本文](http://bi-insider.com/business-intelligence/crystal-reports-2011-crystal-reports-for-enterprise/)包含该功能的摘要。

# amazon-web-services - 从亚马逊云搜索 sdf 中删除无效字符

> ID：14258909
> 
> 赞同：2
> 
> 时间：2013-01-10T13:21:19.543
> 
> 标签：amazon-web-services, amazon-cloudsearch

在尝试将从 pdf 文件中提取的数据发布到亚马逊云搜索域进行索引时，由于数据中的字符无效，索引失败。

如何在发布到搜索端点之前删除这些无效字符？

我尝试转义和替换字符，但没有奏效。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2020-02-13T23:28:08.973

将文档上传到 CloudSearch（使用 aws sdk / json）时，我遇到了这样的错误：

> 字段 content_stemmed 的源错误：字段“content_stemmed”的验证错误：代码点 B 无效

正如 AWS 所记录的（见下文），我的解决方案是在上传之前从文档中删除无效字符：

例如，这是我使用 javascript 所做的：

```
const cleaned = someFieldValue.replace(
  /[^\u0009\u000a\u000d\u0020-\uD7FF\uE000-\uFFFD]/g, 
  ''
) 
```

[参考](https://docs.aws.amazon.com/cloudsearch/latest/developerguide/preparing-data.html)：

> JSON 和 XML 批处理都只能包含在 XML 中有效的 UTF-8 字符。有效字符是控制字符制表符 (0009)、回车符 (000D) 和换行符 (000A)，以及 Unicode 和 ISO/IEC 10646 的合法字符。FFFE、FFFF 和代理块 D800–DBFF 和 DC00– DFFF 无效，会导致错误。
> 
> 您可以使用以下正则表达式匹配无效字符，以便将其删除：/[^\u0009\u000a\u000d\u0020-\uD7FF\uE000-\uFFFD]/

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-11T05:57:11.810

我已使用[此处提供的解决方案解决了问题](http://maxharp3r.wordpress.com/2008/05/15/pythons-minidom-xml-and-illegal-unicode-characters/)

```
RE_XML_ILLEGAL = u'([\u0000-\u0008\u000b-\u000c\u000e-\u001f\ufffe-\uffff])' + \
                 u'|' + \
                 u'([%s-%s][^%s-%s])|([^%s-%s][%s-%s])|([%s-%s]$)|(^[%s-%s])' % \
                  (unichr(0xd800),unichr(0xdbff),unichr(0xdc00),unichr(0xdfff),
                   unichr(0xd800),unichr(0xdbff),unichr(0xdc00),unichr(0xdfff),
                   unichr(0xd800),unichr(0xdbff),unichr(0xdc00),unichr(0xdfff))
x = u"<foo>text\u001a</foo>"
x = re.sub(RE_XML_ILLEGAL, "?", x) 
```

# android - 用相机拍照并将未压缩的图片附加到电子邮件中

> ID：14258910
> 
> 赞同：1
> 
> 时间：2013-01-10T13:21:23.660
> 
> 标签：android, android-camera, email-attachments

你好 stackoverflow 社区，

我搜索了很多关于将照片附加到电子邮件的信息。我找到了有效的代码，但图片的分辨率很差。现在我想发送未压缩的图片。于是我看了很多问题，找到了这段代码，但是拍照的时候接受不了，继续往下看。

在这里您可以查看我的代码：

```
this.eco.setOnClickListener(new OnClickListener() {

        public void onClick(View v) {
            Intent cameraIntent = new Intent(
                    android.provider.MediaStore.ACTION_IMAGE_CAPTURE);
            File path = new File("/Pictures/");
            path.mkdirs();
            String fileName = "verunreinigung.jpg";
            File file = new File(path, fileName);
            cameraIntent.putExtra(android.provider.MediaStore.EXTRA_OUTPUT,
                    Uri.fromFile(file));
            startActivityForResult(cameraIntent, CAMERA_REQUEST_CODE);
        }
    });

protected void onActivityResult(int requestCode, int resultCode, Intent data) {  
    if (requestCode == CAMERA_REQUEST_CODE && resultCode == RESULT_OK) {
        Bitmap photo = (Bitmap) data.getExtras().get("data");

        // variables
        int latitude = GMapsSubActivity.getLatitude();
        int longitude = GMapsSubActivity.getLongitude();
        double dLat = latitude / 1000000.0;
        double dLng = longitude / 1000000.0;

        Log.v("lat", Integer.toString(latitude));
        Log.v("lng", Integer.toString(longitude));
        Log.v("lat", Double.toString(dLat));
        Log.v("lng", Double.toString(dLng));

        String[] address = new String[]{cursor.getString(cursor.getColumnIndex("email"))};
        String subject = "Verunreinigung am Gewässer: " + cursor.getString(cursor.getColumnIndex("gewName"))
                + " / " + cursor.getString(cursor.getColumnIndex("reviergrenzen"));
        String text = "Hallo " + cursor.getString(cursor.getColumnIndex("name"))
                + "!\n\nIch habe an/in Ihrem Gewässer eine"
                + " Verunreinigung entdeckt.\n"
                + "Sie befindet sich hier:\n"
                + "http://maps.google.com/?q=" + dLat + "," + dLng + "\n"
                + "Das Foto finden Sie im Anhang.\n\nLiebe Grüße!";

        ContentValues values = new ContentValues();
        values.put(Images.Media.TITLE, "photo");
        values.put(Images.Media.BUCKET_ID, "photo_ID");
        values.put(Images.Media.DESCRIPTION, "");
        values.put(Images.Media.MIME_TYPE, "image/jpeg");

        Uri photoUri = getContentResolver().insert(
                Media.EXTERNAL_CONTENT_URI, values);
        OutputStream outstream;

        try {
            outstream = getContentResolver().openOutputStream(photoUri);
            photo.compress(Bitmap.CompressFormat.JPEG, 100, outstream);
            outstream.close();
        } catch (FileNotFoundException e) {

        } catch (IOException e) {
            // TODO Auto-generated catch block
            e.printStackTrace();
        }

        // define the intent
        Intent emailIntent = new Intent(android.content.Intent.ACTION_SEND);
        emailIntent.setFlags(Intent.FLAG_ACTIVITY_NEW_TASK);

        emailIntent.putExtra(android.content.Intent.EXTRA_EMAIL, address);
        emailIntent.putExtra(android.content.Intent.EXTRA_SUBJECT, subject);
        emailIntent.putExtra(android.content.Intent.EXTRA_TEXT, text);
        emailIntent.putExtra(Intent.EXTRA_STREAM, photoUri);

        emailIntent.setType("plain/text");

        // start the intent
        try {
            startActivity(Intent.createChooser(emailIntent,
                    "Versende Email via:"));
        } catch (android.content.ActivityNotFoundException ex) {
            Toast.makeText(getApplicationContext(),
                    "Kein Email-Programm installiert.", Toast.LENGTH_SHORT)
                    .show();
        }
    }  
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-10T13:36:58.260

使用以下代码发送邮件

```
String filelocation="/mnt/sdcard/capture.png";    
Intent sharingIntent = new Intent(Intent.ACTION_SEND);
sharingIntent.setType("vnd.android.cursor.dir/email");
String to[] = "user@gmail.com";
sharingIntent.putExtra(Intent.EXTRA_EMAIL, to);
sharingIntent.putExtra(Intent.EXTRA_STREAM,filelocation);
sharingIntent.putExtra(Intent.EXTRA_SUBJECT,"subject");
startActivity(Intent.createChooser(sharingIntent, "Send email")); 
```

# protobuf-net - Newbe 尝试使用 protobuf-net 序列化对象

> ID：14258911
> 
> 赞同：1
> 
> 时间：2013-01-10T13:21:25.873
> 
> 标签：protobuf-net

我有两个简单的类，我想用 protobuf-net 序列化它们。一切看起来都不错，但是当我反序列化 Body 属性时为空。知道我做错了什么吗？

```
using System;
using System.Collections.Generic;
using System.IO;
using System.Runtime.Serialization;
using ProtoBuf;

namespace Protobuf_test
{
    public class Program
    {
        private static void Main(string[] args)
        {
            var innerObject = new Inner() { Id = Guid.NewGuid() };
            var outerObject = new Outer() { Body = innerObject };

            using (var stream = File.Create("serialized.bin"))
            {
                Serializer.Serialize(stream, outerObject);
            }
            using (var file = File.OpenRead("serialized.bin"))
            {
                var deserialized = Serializer.Deserialize<Outer>(file);
            }
        }
    }

    [DataContract]
    public class Inner
    {
        [DataMember]
        public Guid Id { get; set; }
    }

    [DataContract]
    public class Outer
    {
        [DataMember]
        public object Body { get; set; }
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-10T13:26:04.847

两个问题：

1.  protobuf-net 要求每个成员有一个正整数*密钥；*这可以通过`Order=`on提供`[DataMember]`。数字越小越好，所以通常这意味着`1`, `2`, `3`...

2.  protobuf 规范是一个模式绑定的序列化器；它想提前了解数据；`object`不能很好地工作。

但这会起作用：

```
[DataContract]
public class Inner
{
    [DataMember(Order=1)]
    public Guid Id { get; set; }
}

[DataContract]
public class Outer
{
    [DataMember(Order=1)]
    public Inner Body { get; set; }
} 
```

*对灵活类型的数据（即*）有一些支持`object`，但请注意，它是 protobuf-net 特定的（它不会很好地实现可移植性）。我鼓励您先查看类型化*方法*。但它*可以*做到这一点：如果你不这样做，我会更喜欢它；p

如果您**无法**更改现有模型，那么我建议的*第一*件事是：添加一个单独的 DTO 模型，该模型看起来很像您的现有模型，但标记为序列化，并使用它 - 并在两个模型之间添加垫片。如果*这*不是一个选项，您需要将系统配置为 a: 为成员定义键，然后 b: 告诉它使用*dynamic*。例如：

```
var config = RuntimeTypeModel.Default;
config.Add(typeof(Inner),false).Add("Id");
config.Add(typeof(Outer), false).AddField(1, "Body").DynamicType = true; 
```

（注意：`Serializer.*`基本上是一个捷径`RuntimeTypeModel.Default.*`，所以这个配置确实与方法有关`Serializer.*`）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-10-24T20:04:15.130

对于对象属性，您可以使用：

[ProtoMember(1, DynamicType=true)] 公共对象值 { 获取；放; }

# ios - iOS 6 本地存储文件出现两次

> ID：14258915
> 
> 赞同：2
> 
> 时间：2013-01-10T13:21:47.643
> 
> 标签：ios, ios6, sencha-touch, local-storage, sencha-touch-2.1

我有一个使用本地存储的应用程序（使用 sencha 'Ext.data.proxy.LocalStorage'）离线查看一些内容。我因违反 iOS 数据存储指南而被 iTunes 拒绝。

我认为这可能与 iOS 5.1 之前 iOS 中 /Documents 文件夹中的 localStorage 有关。为了确认在较新版本中文档文件夹是空的，我检查了，但我仍然找到了一个 .file__0.localstorage。

奇怪的想法是同一个文件（但没有前导点）也存在于 library/caches 文件夹中，它应该在哪里。

两者具有相同的内容。

有谁知道这怎么会发生？我已经在 Sencha Support 中询问过，但它似乎与 Sencha 框架无关。

注意：我没有使用 PhoneGap，只有 Sencha。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-11T14:20:30.253

使用 Sencha 制作一个非常小的 Hello World 应用程序来写入本地存储，我可以重现这种行为。似乎在应用程序退出时，它会将本地存储文件的副本写入 /Documents 文件夹。

这对我来说似乎很可疑，它让我想起了 iOS 5.1 的 PhoneGap 补丁，它也备份了 localStorage 文件。

在 iOS 5.1 中，Apple 开始将 localStorage 文件放在 Library/Caches 文件夹中，这破坏了许多应用程序，因为数据不再可靠存储。因此PhoneGap 和其他人开始实施Workarrounds，将localStorage 文件备份到documents 文件夹，并在需要时自动恢复。

为了找到 Sencha 做类似事情的证据，我打开了生成的 .app 包并找到了一个包含本机包装器代码的 stbuild_template 文件。它当然是编译过的，但是搜索字符串“localStorage”会得到一些有趣的结果，例如：

```
restoreLocalStorage
preserveLocalStorage
Could not remove source file while backing up localstorage Could not copy localstorage backup . Caches WebKit/LocalStorage .file__0.localstorage file__0.localstorage
SNLocalStoreageFix 
```

我还发现了很多对 NimbleKit 的引用，这些引用似乎在内部用于包装。

该线程还暗示了 OP 正在使用的 Sencha Touch 2.1 中 iOS 5.1 本地存储问题的解决方案：[http ://www.sencha.com/forum/showthread.php?194674-Localstorage-and-native- iOS-5.1-apps&s=04149e771f9c4eea15cb6f6d97069ff6](http://www.sencha.com/forum/showthread.php?194674-Localstorage-and-native-iOS-5.1-apps&s=04149e771f9c4eea15cb6f6d97069ff6)

所有这些都证明了 Sencha 为 iOS 5.1 实现了一个工作区，它将 localStorage 放在 /Documents 文件夹中。由于您只使用 localStorage 文件进行缓存，Apple 拒绝了您，因为您将非用户数据存储在 /Documents 中。

我认为使用 PhoneGap 可以选择禁用此备份。因此，您可能要考虑使用它或询问 Sencha 是否有类似的选项来禁用它。

# node.js - 在 node.js 中检索特定用户的最后 3200 条推文

> ID：14258916
> 
> 赞同：3
> 
> 时间：2013-01-10T13:21:56.583
> 
> 标签：node.js, twitter

我是 javascript 和 node.js 的新手，这是我的第一篇文章，所以请多多包涵。

我正在使用 ntwitter 来获取特定用户以前的所有推文。

我的问题是，如果用户有超过 200 条推文，我需要创建一个循环，我不确定我是否做得对。

这是获取 200 条最新推文的异步函数：

```
exports.getUserTimeline = function(user, callback) {

  twit.getUserTimeline({ screen_name: user, count: 200 }, function(err, data) {
    if (err) { 
      return callback(err);
    }
    callback(err, data);  
  });
} 
```

我找到了一个使用递归函数的解决方案，但它非常难看。我该如何改进它？

```
exports.getUserHistory = function(user, callback) {
  recursiveSearch(user, callback);
  function recursiveSearch(user, callback, lastId, data) {
    var data = data || []
      , args = {screen_name: user, count: 200};

    if(typeof lastId != "undefined") args.max_id = lastId;

    twit.getUserTimeline(args, function(err, subdata) {
      if (err) { 
        console.log('Twitter search failed!');
        return callback(err);
      }
      if (data.length !== 0) subdata.shift();
      data = data.concat(subdata);
      var lastId = parseInt(data[data.length-1].id_str);
      if (subdata.length !== 0) {
        recursiveSearch(user, callback, lastId, data);
      } else {
        callback(err, data);
      }
    });
  }
} 
```

非常感谢！

**更新：**这是 Hunterloftis 建议的改进（重构）功能，有两个修改：

1.  不应在第一次迭代时指定属性 max_id
2.  必须处理用户存在但未发推文的情况

代码：

```
function getUserHistory(user, done) {
  var data = [];
  search();

  function search(lastId) {
    var args = {
      screen_name: user,
      count: 200,
      include_rts: 1
    };
    if(lastId) args.max_id = lastId;

    twit.getUserTimeline(args, onTimeline);

    function onTimeline(err, chunk) {
      if (err) {
        console.log('Twitter search failed!');
        return done(err);
      }

      if (!chunk.length) {
        console.log('User has not tweeted yet');
        return done(err);
      }

      //Get rid of the first element of each iteration (not the first time)
      if (data.length) chunk.shift();

      data = data.concat(chunk);
      var thisId = parseInt(data[data.length - 1].id_str);

      if (chunk.length) return search(thisId);
      console.log(data.length + ' tweets imported');
      return done(undefined, data);
    }
  }
} 
```

在检索推文时，我注意到我的推文计数并不总是与用户的“statuses_count”属性相同。我花了一些时间才弄清楚这种差异对应于已删除推文的数量:)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-10T17:18:48.293

你的递归函数有效吗？在我看来还不错。我可能会将它重构为更像这样的东西：

```
function getUserHistory(user, done) {
  var data = [];
  search();

  function search(lastId) {
    var args = {
      screen_name: user,
      count: 200,
      max_id: lastId
    };

    twit.getUserTimeline(args, onTimeline);

    function onTimeline(err, chunk) {
      if (err) {
        console.log('Twitter search failed!');
        return done(err);
      }

      if (data.length) chunk.shift(); // What is this for?
      data = data.concat(chunk);
      var thisId = parseInt(data[data.length - 1].id_str);

      if (chunk.length) return search(thisId);
      return done(undefined, data);
    }
  }
} 
```

# linq - 从 Orchard 1.5.1 迁移到 Orchard 1.6 后的 Linq 'Group by'

> ID：14258917
> 
> 赞同：0
> 
> 时间：2013-01-10T13:21:57.783
> 
> 标签：linq, nhibernate, orchardcms, orchardcms-1.6

我对“分组依据”有疑问。在迁移到 Orchard 1.5.1 之前，我对这段代码没有任何问题：

```
var list = (from r in GetAll()
                    group new { r.FormulaCatId, r.InputPeriodId, r.CurrencyId } by new { r.FormulaCatId, r.InputPeriodId, r.CurrencyId }
                        into grp
                        select (new CatCurPerViewModel
                        {
                            FormulaCatId = grp.Key.FormulaCatId,
                            InputPeriodId = grp.Key.InputPeriodId,
                            CurrencyId = grp.Key.CurrencyId
                        })); 
```

但是在迁移到 Orchard 1.6 后出现了这个问题：

```
2013-01-10 15:01:25,704 [7] Orchard.Exceptions.DefaultExceptionPolicy - An unexpected exception was caught
System.NotImplementedException: The method or operation is not implemented.
at NHibernate.Linq.CacheableExpressionNode.Resolve(ParameterExpression inputParameter, Expression   expressionToBeResolved, ClauseGenerationContext clauseGenerationContext)
at Remotion.Linq.Parsing.Structure.IntermediateModel.ExpressionResolver.GetResolvedExpression(Expression unresolvedExpression, ParameterExpression parameterToBeResolved, ClauseGenerationContext clauseGenerationContext)
at Remotion.Linq.Parsing.Structure.IntermediateModel.GroupByExpressionNode.<>c__DisplayClass1.<GetResolvedKeySelector>b__0(ExpressionResolver r)
at Remotion.Linq.Parsing.Structure.IntermediateModel.ResolvedExpressionCache`1.GetOrCreate(Func`2 generator)
at Remotion.Linq.Parsing.Structure.IntermediateModel.GroupByExpressionNode.CreateResultOperator(ClauseGenerationContext clauseGenerationContext)
at Remotion.Linq.Parsing.Structure.IntermediateModel.ResultOperatorExpressionNodeBase.ApplyNodeSpecificSemantics(QueryModel queryModel, ClauseGenerationContext clauseGenerationContext)
at Remotion.Linq.Parsing.Structure.IntermediateModel.MethodCallExpressionNodeBase.Apply(QueryModel queryModel, ClauseGenerationContext clauseGenerationContext)
at Remotion.Linq.Parsing.Structure.QueryParser.ApplyAllNodes(IExpressionNode node, ClauseGenerationContext clauseGenerationContext)
at Remotion.Linq.Parsing.Structure.QueryParser.GetParsedQuery(Expression expressionTreeRoot)
at NHibernate.Linq.NhLinqExpression.Translate(ISessionFactoryImplementor sessionFactory)
at NHibernate.Hql.Ast.ANTLR.ASTQueryTranslatorFactory.CreateQueryTranslators(String queryIdentifier, IQueryExpression queryExpression, String collectionRole, Boolean shallow, IDictionary`2 filters, ISessionFactoryImplementor factory)
at NHibernate.Engine.Query.HQLExpressionQueryPlan.CreateTranslators(String expressionStr, IQueryExpression queryExpression, String collectionRole, Boolean shallow, IDictionary`2 enabledFilters, ISessionFactoryImplementor factory)
at NHibernate.Engine.Query.QueryPlanCache.GetHQLQueryPlan(IQueryExpression queryExpression, Boolean shallow, IDictionary`2 enabledFilters)
at NHibernate.Impl.AbstractSessionImpl.GetHQLQueryPlan(IQueryExpression queryExpression, Boolean shallow)
at NHibernate.Impl.AbstractSessionImpl.CreateQuery(IQueryExpression queryExpression)
at NHibernate.Linq.DefaultQueryProvider.Execute(Expression expression)
at NHibernate.Linq.DefaultQueryProvider.Execute[TResult](Expression expression)
at Remotion.Linq.QueryableBase`1.GetEnumerator()
at System.Linq.Buffer`1..ctor(IEnumerable`1 source)
at System.Linq.Enumerable.ToArray[TSource](IEnumerable`1 source)
at SAS.Core.Services.RateService.ListCatCurPer()
at SAS.Core.Controllers.RatesAdminController.Index()
at lambda_method(Closure , ControllerBase , Object[] )
at System.Web.Mvc.ReflectedActionDescriptor.Execute(ControllerContext controllerContext, IDictionary`2 parameters)
at System.Web.Mvc.ControllerActionInvoker.InvokeActionMethod(ControllerContext controllerContext, ActionDescriptor actionDescriptor, IDictionary`2 parameters)
at System.Web.Mvc.ControllerActionInvoker.<>c__DisplayClass13.<InvokeActionMethodWithFilters>b__10()
at System.Web.Mvc.ControllerActionInvoker.InvokeActionMethodFilter(IActionFilter filter, ActionExecutingContext preContext, Func`1 continuation)
at System.Web.Mvc.ControllerActionInvoker.InvokeActionMethodFilter(IActionFilter filter, ActionExecutingContext preContext, Func`1 continuation)
at System.Web.Mvc.ControllerActionInvoker.InvokeActionMethodFilter(IActionFilter filter, ActionExecutingContext preContext, Func`1 continuation) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-05-17T14:49:10.020

出现问题是因为在 orchard 1.6 中 Orchard.Data.Repository<T> 的 Table 属性以下列方式实现：

```
 public virtual IQueryable<T> Table
    {
        get { return Session.Query<T>().Cacheable(); }
    } 
```

并且您不能将 Group By 与 Cacheable() 一起使用 - [HNIbernate Jira 中有一张公开票](https://nhibernate.jira.com/browse/NH-2504)

Orchard 调用 Cacheable() 是为了[利用二级 Nhibernate 缓存](http://www.davidhayden.me/blog/orchard-cms-with-nhibernate-syscache2-database-caching)。

如果你不使用也不打算使用这个二级缓存和Orchard中的相应模块，你可以下载Orchard源码，将Orchard.Data.Repository<T>中Table属性的实现修改为

```
 public virtual IQueryable<T> Table
    {
        get { return Session.Query<T>(); }
    } 
```

这将解决您的问题。

或者，如果您不想更改 Orchard 源，您可以创建自己的通用存储库类，并将其连接到 DependencyContainer（默认情况下，Orchard 带有 Autofac）。以下是使用 Autofac 2.6.3.862 的方法：

```
public class MyRepository<T> : Orchard.Data.Repository<T> where T:class
{
    public MyRepository(ISessionLocator sessionLocator) : base(sessionLocator)
    {
    }

    public override System.Linq.IQueryable<T> Table
    {
        get { return Session.Query<T>(); }
    }
}

public class MyDataModule : Autofac.Module
{
    protected override void AttachToComponentRegistration(Autofac.Core.IComponentRegistry componentRegistry, Autofac.Core.IComponentRegistration registration)
    {
        base.AttachToComponentRegistration(componentRegistry, registration);

        Type limitType = registration.Activator.LimitType;
        if (!limitType.IsGenericType || limitType.GetGenericTypeDefinition() != typeof (Repository<>)) return;

        var epamRepoTye = typeof(MyRepository<>).MakeGenericType(limitType.GetGenericArguments());

        registration.Activating += (s, e) =>
                                       {
                                           var locator = e.Context.Resolve<ISessionLocator>();
                                           e.Instance = Activator.CreateInstance(epamRepoTye, new object[] {locator});
                                       };
    }
} 
```

如果您可以保证包含它的程序集将在 Orchard.Core 程序集之后加载，则可能（我尚未对此进行测试） MyDataModule 类可以简化：

```
public class MyDataModule : Autofac.Module
{
    protected override void Load(ContainerBuilder builder)
    {
        builder.RegisterGeneric(typeof(MyRepository<>)).As(typeof(IRepository<>)).InstancePerDependency();
    }
} 
```

# sql - SQL 匹配行之间的列

> ID：14258920
> 
> 赞同：1
> 
> 时间：2013-01-10T13:22:11.900
> 
> 标签：sql, select

我需要编写一个 select 语句，它不仅收集来自多个表的信息，还收集来自某个表中的信息，该表与同一个表中其他行中的数据相匹配。

因此，虽然连接适用于多表问题，但据我所知，我不能在同一个表中“连接”列 a 和列 b。

这是详细信息

我有以下表格

CR、VM 和文件夹

我需要选择以下内容：

来自 CR 的 ID 和名称

文件夹名称

但是文件夹名称不在文件夹表中，要找到它，我需要先从 CR 中获取“ID”并将其与 VM 中的“ObjectID”匹配 - 然后该行中的“Location”列与另一行的 ObjectID 匹配虚拟机表。

然后我需要将文件夹中的 ID 与该 ObjectID 匹配，并在“文件夹”表中检索“名称”以检索文件夹名称”。

我不知道从哪里开始，我应该为此使用游标吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-10T13:27:54.043

可以*通过*对连接的一侧进行别名来连接一个表。这可能足以让您入门。否则，我们将需要查看一些示例数据。

```
SELECT
  CR.ID,
  CR.Name,
  Folder.Name AS FolderName
FROM
  CR
  /* First join CR to VM */
  INNER JOIN VM ON CR.ID = VM.ObjectID
  /* Then join VM to itself aliased as VMLoc, mapping Location to ObjectID */
  INNER JOIN VM AS VMLoc ON VM.Location = VMLoc.ObjectID
  /* Finally join the second ObjectID to Folder to get Folder.Name */
  INNER JOIN Folder ON Folder.ID = VMLoc.ObjectID 
```

# uiview - UIView drawRect：是否可以在路径内描边？

> ID：14258924
> 
> 赞同：7
> 
> 时间：2013-01-10T13:22:19.460
> 
> 标签：uiview, core-graphics, stroke

使用核心图形，是否可以描边路径的内部？与在描边路径的外侧和内侧绘制一半的线宽相反？

原因是如果视图的一部分在屏幕边缘而部分不在，则更容易控制笔画的可见粗细。屏幕边缘上的部分被切断，而完全在屏幕上的视图边缘看起来更厚（如果笔划可见，则两侧）。

![在此处输入图像描述](../Images/e6231f5e75bb5ea3eab008697bcb61e6.png)

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2013-01-11T06:19:51.850

在描边之前剪辑到路径。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-01-12T15:25:56.343

这没有中风：

```
- (void)drawRect:(CGRect)rect
{
    CGContextRef context = UIGraphicsGetCurrentContext();
    CGContextSetStrokeColorWithColor(context, [UIColor darkGrayColor].CGColor);
    CGContextSetLineWidth(context, 14);
    CGRect rrect = CGRectMake(CGRectGetMinX(rect), CGRectGetMinY(rect), CGRectGetWidth(rect), CGRectGetHeight(rect));
    CGFloat radius = 30;
    CGFloat minx = CGRectGetMinX(rrect), midx = CGRectGetMidX(rrect), maxx = CGRectGetMaxX(rrect);
    CGFloat miny = CGRectGetMinY(rrect), midy = CGRectGetMidY(rrect), maxy = CGRectGetMaxY(rrect);
    CGContextMoveToPoint(context, minx, midy);
    CGContextAddArcToPoint(context, minx, miny, midx, miny, radius);
    CGContextAddArcToPoint(context, maxx, miny, maxx, midy, radius);
    CGContextAddArcToPoint(context, maxx, maxy, midx, maxy, radius);
    CGContextAddArcToPoint(context, minx, maxy, minx, midy, radius);
    CGContextClosePath(context);
    CGContextClip(context);
    CGContextDrawPath(context, kCGPathStroke);
} 
```

**编辑：这是有效的（根据正确答案）：**

```
- (void)drawRect:(CGRect)rect
{
    CGContextRef context = UIGraphicsGetCurrentContext();
    CGContextSetStrokeColorWithColor(context, [UIColor darkGrayColor].CGColor);
    CGContextSetFillColorWithColor(context, [UIColor blackColor].CGColor);
    CGContextSetLineWidth(context, 14);
    CGRect pathRect = CGRectMake(10, 10, rect.size.width -20, rect.size.height -20);
    CGPathRef path = [UIBezierPath bezierPathWithRoundedRect:pathRect cornerRadius:20].CGPath;
    CGContextAddPath(context, path);
    CGContextClip(context);
    CGContextAddPath(context, path);
    CGContextDrawPath(context, kCGPathEOFillStroke);

} 
```

# node.js - 在 node.js 服务器上重用主干路由、模型和视图

> ID：14258928
> 
> 赞同：16
> 
> 时间：2013-01-10T13:22:35.023
> 
> 标签：node.js, backbone.js

我正在尝试构建一个既可用作 SPA 又可用作普通应用程序的应用程序，而无需尽可能地重写任何代码。我的研究使我相信使用节点 + 主干（在服务器和客户端上）是非常有可能的。我找到了一些关于如何做到这一点的资源，但没有一个真正完整的。有没有人尝试过重新使用所有代码的完整解决方案？

我发现的资源：在服务器上重用主干模型：http: [//blog.andyet.com/2011/feb/15/re-using-backbonejs-models-on-the-server-with-node/](http://blog.andyet.com/2011/feb/15/re-using-backbonejs-models-on-the-server-with-node/)

在服务器上重用主干视图和布局管理器：http: [//vimeo.com/46033641](http://vimeo.com/46033641)

我还找到了一些实现这一点的框架，例如（bones、derby、meteor），但我不觉得使用这样的框架是最好的解决方案，因为我仍然希望完全控制骨干网和节点。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-13T04:46:19.220

您要实现的是`Resource-View-Presenter`模型。请完整阅读这篇文章[http://blog.nodejitsu.com/scaling-isomorphic-javascript-code](http://blog.nodejitsu.com/scaling-isomorphic-javascript-code)。它为可以在客户端和服务器上执行的同构代码提供了急需的洞察力。它还帮助我理解了各种模型和架构。

Backbone.js 使用的是传统的 MVC 框架，如果不进行修改，它不能在客户端和服务器上都工作。所以如果你想坚持使用backbone.js，你迟早会面临这个劣势。我也尝试过骨干网，但没有找到简单的方法来做到这一点。

我尝试在 node.js 上寻找 RVP 框架，但它仍然是新的。我建议您查看 flatiron.js [http://flatironjs.org/](http://flatironjs.org/)。它基于 Resource-View-Presenter 模型，这是我唯一能找到的 node.js 模型。在服务器/客户端上都需要进行一些更改，但这并不多。你会发现它类似于骨干。

希望它可以帮助您找到正确的道路。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-02-14T21:47:32.153

我最近在该领域做了一些研究，发现了一些有趣的项目，它们在客户端和服务器（nodejs）上使用相同的主干代码。

## 项目一

第一个是 Groupon 的 Keith Norma 介绍的。他设法在客户端和服务器上重用骨干路由器+模板。

应用演示：[https ://github.com/keithnorm/SpainJS-Pipedream-Demo](https://github.com/keithnorm/SpainJS-Pipedream-Demo)

在 SpainJS 的演讲：[http ://www.youtube.com/watch?v=jbn9c_yfuoM](http://www.youtube.com/watch?v=jbn9c_yfuoM)

## 项目 2

第二个项目是来自 Airbnb 的 Spike Brehm 提出的 Rendr，但尚未向公众发布。它似乎更雄心勃勃，因为它还将主干模型和集合交易到 nodejs 服务器。你可以在这里阅读更多信息：http: [//nerds.airbnb.com/weve-launched-our-first-nodejs-app-to-product](http://nerds.airbnb.com/weve-launched-our-first-nodejs-app-to-product)

**更新**：Rendr 代码已发布：[https ://github.com/airbnb/rendr](https://github.com/airbnb/rendr)

## 项目 3

还有另一个项目也允许在客户端和服务器之间共享主干代码：[https ://github.com/developmentseed/bones](https://github.com/developmentseed/bones)

# ruby-on-rails - Rails：多态关联：如何列出关联

> ID：14258930
> 
> 赞同：0
> 
> 时间：2013-01-10T13:22:41.093
> 
> 标签：ruby-on-rails, polymorphic-associations, rails-activerecord

我有一个多态关联：

```
class User < ActiveRecord::Base
  belongs_to :companiable, :polymorphic => true
end

class Agency < ActiveRecord::Base
  has_many :users, :as => :companiable
end

class Publisher < ActiveRecord::Base
  has_many :users, :as => :companiable
end 
```

现在我想列出所有用户并显示他们所属的公司。有没有比这更优雅的解决方案（强烈希望有）？

```
def index
    @publishers = Publisher.all
    @agencies = Agency.all
    @users = User.all
end 
```

...

```
<td><% unless user.companiable_id.nil? %>
            <% if user.companiable_type == "Agency" %>
              <%= @agencies[user.companiable_id].name %>
            <% elsif user.companiable_type == "Publisher"%>
              <%= @publishers[user.companiable_id].name %>
            <% end %>
          <% end %>
        </td> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-10T13:29:49.663

您可以从用户访问公司，因为`belongs_to`添加了一个方法，以便您可以通过执行直接访问其他对象`user.companiable`

```
def index
   @users = User.all
end 
```

在你看来

```
<td><% unless user.companiable.nil? %>
       <%= user.companiable.name %>
    <% end %></td> 
```

# xml - 使用 XSL 将一个 XML 的上下文附加到另一个 XML

> ID：14258932
> 
> 赞同：1
> 
> 时间：2013-01-10T13:22:43.460
> 
> 标签：xml, xslt, maven, pom.xml

我有个问题。我想将两个 XML 文件的上下文合二为一。这在 MAVEN 项目 (POM) 和 XSL 中的 xslt-generator-maven-plugin 的帮助下。

我的 pom 配置如下：

```
<plugin>
<groupId>net.sf.xsltmp</groupId>
<artifactId>xslt-generator-maven-plugin</artifactId>
<version>1.7</version>
<executions>
<execution>
<id>transform-contex</id>
<goals>
<goal>many-to-one</goal>
</goals>
<configuration>
<srcDir>src/main/webapp/META-INF/</srcDir>
<srcIncludes>**/*context.xml</srcIncludes>
<xslTemplate>src/main/webapp/Temp.xsl</xslTemplate>
<destFile>${project.build.directory}/contextNEW.xml</destFile>
</configuration>
</execution>
</executions>
</plugin> 
```

我有第一个文件，例如：

```
<?xml version="1.0" encoding="UTF-8"?>
<Context debug="0" reloadable="true" >
    <Resourcen name="jdbc/ChiDS"
               auth="Container" 
               type="javax.sql.DataSource"
               ...
</Context> 
```

第二个喜欢：

```
<?xml version="1.0" encoding="UTF-8"?>
 <Context>
    <Realm className="org.apache.catalina.realm.MemoryRealm"
           pathname="webapps/${application.name}/WEB-INF/users.xml"/>
 </Context> 
```

并想得到：

```
<?xml version="1.0" encoding="UTF-8"?>
<Context debug="0" reloadable="true" >  
<Resourcen name="jdbc/ChiDS"
               auth="Container" 
               type="javax.sql.DataSource"
               ...
<Realm className="org.apache.catalina.realm.MemoryRealm"
       pathname="webapps/${application.name}/WEB-INF/users.xml"/> 
</Context> 
```

所以我会将第二个 XML 附加到第一个。我需要创建一个正确的 TEMP.xsl 文件。

我“需要”使用以下内容：

*   xslt-生成器-maven-插件

我试过这个，但标记化是一个问题。

```
<xsl:output method="xml" indent="yes"/>

<xsl:param name="source-file-names" />
<xsl:variable name="names-sequence" select="tokenize($source-file-names,'\|')" />
<xsl:variable name="cfg-files" select="document($names-sequence)" /> 
```

有什么线索吗？我已经尝试了几件事，但没有解决这个问题。

感谢帮助。

我已尝试使用此 XSL（我修复了令牌问题）但没有成功：

```
<xsl:output method="xml" indent="yes"/>

<xsl:param name="source-file-names" />
<xsl:variable name="names-sequence" select="fn:tokenize($source-file-names,'\|')" />
<xsl:variable name="cfg-files" select="document($names-sequence)" />

<xsl:template match="/">
    <xsl:copy>
        <xsl:apply-templates select="$cfg-files/*"/>
    </xsl:copy>
</xsl:template> 
```

我看过这个样本：[https](https://github.com/ivos/xslt-generator-maven-plugin/issues/1) ://github.com/ivos/xslt-generator-maven-plugin/issues/1 但我这边没有成功。

欢迎任何帮助。:)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-11T12:30:53.640

您可以在此处查看我的示例，其中我使用 xslt 可变文档加载组合了两个 xml 文件。你可以在这里找到它：[Transform XML with multiple XSL files](https://stackoverflow.com/questions/13467069/transform-xml-with-multiple-xsl-files/14255985#14255985)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-10T13:32:45.257

您需要创建第三个 xml 文档，其中包含要加入的其他 xml 文件。
我认为这很有帮助：[http ://www.ibm.com/developerworks/library/x-tipcombxslt/](http://www.ibm.com/developerworks/library/x-tipcombxslt/)

# php - 在其他网站上使用 Javascript/PHP 共享网页

> ID：14258936
> 
> 赞同：0
> 
> 时间：2013-01-10T13:23:01.360
> 
> 标签：php, javascript, jquery, html, iframe

我有一个网站，本质上是一个人员目录。

每个人都有一个个人资料页面，我想以某种方式使其他网站管理员能够获取他们可以粘贴到他们网站上的代码链接，它将提取我页面的信息并将其格式化为我的品牌颜色等，并带有返回我的链接网站。这是可能的还是 iframe 是唯一的方法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-10T13:29:29.777

您可以在 iframe 中执行此操作，但有缺点，或者您可以使用**jquery/javascript 从您的站点加载内容**到 div 或远程站点的某个容器中。但是由于**共同的来源政策**，您将面临一些*跨域问题*。

 **因此，您已在应用程序中明确定义允许您喜欢的原始标头，您可以使用**JSONP 或 CORS**来做到这一点，其中 jsonp 仅支持获取请求，而 cors 是更合适的方式，并且支持任何类型的请求。

[CORS](http://www.nczonline.net/blog/2010/05/25/cross-domain-ajax-with-cross-origin-resource-sharing/)，了解更多 [阅读此](http://leopard.in.ua/2012/07/08/using-cors-with-rails/)**

# php - 如何在 PHP 中从 MySQL 创建自定义 JSON 布局

> ID：14258937
> 
> 赞同：2
> 
> 时间：2013-01-10T13:23:02.200
> 
> 标签：php, mysql, json

我在 PHP 中有一个 MySQL 查询，它拉回两列结果

第一列是标签第二列是值

我已阅读[http://nitschinger.at/Handling-JSON-like-a-boss-in-PHP](http://nitschinger.at/Handling-JSON-like-a-boss-in-PHP)但我很难理解如何从 MySQL 在 PHP 中执行以下 JSON

```
[
  {
    key: "Cumulative Return",
    values: [
      { 
        "label": "One",
        "value" : 29.765957771107
      } , 
      { 
        "label": "Two",
        "value" : 0
      } , 
      { 
        "label": "Three",
        "value" : 32.807804682612
      } , 
      { 
        "label": "Four",
        "value" : 196.45946739256
      } , 
      { 
        "label": "Five",
        "value" : 0.19434030906893
      } , 
      { 
        "label": "Six",
        "value" : 98.079782601442
      } , 
      { 
        "label": "Seven",
        "value" : 13.925743130903
      } , 
      { 
        "label": "Eight",
        "value" : 5.1387322875705
      }
    ]
  }
] 
```

我可以手动编写一个循环来输出原始文本以形成像上面这样的 JSON，但我真的想使用**json_encode**

```
<?php
$hostname = 'localhost'; //MySQL database
$username = 'root'; //MySQL user
$password = ''; //MySQL Password

try {
    $dbh = new PDO("mysql:host=$hostname;dbname=etl", $username, $password);

    $query = "select label, value from table";

    $stmt = $dbh->prepare($query);
    $stmt->execute();

    $result = $stmt->fetchAll(PDO::FETCH_ASSOC);

    if (!empty($result)) {
        echo '[
        {
          key: "Cumulative Return",
          values: [';

        for ($row = 0; $row < count($result); $row++) {
            echo "{";
            echo '"label": "' . $result[$row]['Label'] . '",';
            echo '"Value": ' . $result[$row]['Value'];
            echo "},";
            echo '       ]
      }
    ]';
        }

    }
}
catch (PDOException $e) {
    echo $e->getMessage();
}

?> 
```

这可以做到吗？如果是这样怎么办？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-10T13:32:22.413

利用`json_encode()`

```
$jsonArr = array( 'key' => 'Cumulative Return' , 'values' => array() );

foreach ($result as $res) 
{
   $jsonArr['values'][] = array('label'=>$res['Label'],'value'=>$res['value']);

}

echo json_encode($jsonArr); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-10T13:32:57.793

尝试这个：

```
$hostname = 'localhost'; //MySQL database
$username = 'root'; //MySQL user
$password = ''; //MySQL Password

try {
    $dbh = new PDO("mysql:host=$hostname;dbname=etl", $username, $password);

    $query = "select label, value from table";

    $stmt = $dbh->prepare($query);
    $stmt->execute();

    $result = $stmt->fetchAll(PDO::FETCH_ASSOC);
    $values = array();

    for($row = 0; $row < count($result); $row++)
    {
        $values[] = array('label' => $result[$row]['Label'], 'value' => $result[$row]['Value']);
    }

    $to_encode = array(
                        array('key' => 'Cumulative Return', 
                              'values' => $values;
                              )
                        );
    echo json_encode($to_encode);

} catch (PDOException $e) {
    echo $e->getMessage();
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-01-10T13:29:10.727

您只需要以您希望将其转换为 json 的方式创建数组：

```
$encode = array(
    'key' => 'Cumulative Return', 
    'values' => $result->fetchAll(PDO::FETCH_ASSOC)
);
echo json_encode($encode); 
```

这应该是您所要求的。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-01-10T13:31:37.630

这就是 JSON 的用处——您无需费心手动对其进行编码。

```
$json = array();
$results = array();
$json['key'] = 'Cumulative return';

foreach ($row as $entry) {
    $results['label'] = $entry['Label'];
    $results['value'] = $entry['Value'];
    $json['value'][] = $results;
}

echo json_encode($json); 
```

就是这样。享受！

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-03-03T05:14:59.017

我正在使用代码点火器

这就是我如何从数据库中的值创建自定义 json 希望它有所帮助

```
function getData() {

		$query = $this -> db -> get('gcm_users');

		$result_array=array();

		if ($query -> num_rows() > 0) {

			$results=$query->result();

			foreach ( $results as $row) {

				$data=array();

				$data['name']=$row->name;
				$data['email']=$row->email;

				array_push($result_array,$data)	;		
			}

			return json_encode($result_array);

		} else {

			echo "something went wrong";

		}
	}
```

这是我从数据库中检索数据的函数，因为我使用了诸如代码点火器之类的框架，我不必担心我的其他 sql 操作希望您可以从此代码中提取所需的内容..

输出是这样的

```
[{"name":"allu","email":"allu@gmail.com"},{"name":"ameeen","email":"cdfdfd@gmail.com"}]
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2020-06-17T10:29:28.257

我构建了一个简单的函数（我更喜欢使用它然后 json_encode - 因为我可以完全控制获取的数据）：

```
 public function mysqlToJoson($mysqlarray)
    {
        $json_string = "[";

        while ($array = $mysqlarray->fetch()) {
            $i = 1;
            if ($json_string != "["){$json_string .= ",";}
            foreach ($array as $key => $value) {
                if ($i == 1) {
                    $json_string .= '{"' . $key . '":' . '"' . htmlentities($value,ENT_QUOTES, 'UTF-8') . '"';
                } else $json_string .= ',"' . $key . '":' . '"' . htmlentities($value,ENT_QUOTES, 'UTF-8') . '"';
                $i++;
            }
            $json_string .= '}';
        }
        $json_string .= ']';
        return $json_string;
    } 
```

# typo3 - 限制typo3 extbase后端模块的输出

> ID：14258943
> 
> 赞同：0
> 
> 时间：2013-01-10T13:23:27.633
> 
> 标签：typo3, extbase

我写了一个带有 extbase 的后端模块，`typo3 4.5`我想为不同的用户组展示不同的 extbase 模型，但我不知道怎么做。我的想法是为每个用户组注册一个后端模块，但我认为它太费力了。我不想在我的扩展程序中检查用户组及其权限。有没有办法得到这个？

例子：

```
models | usergroup: editor could see

specific models | usergroup: specific_editor could see 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-10T17:16:34.750

Please explain the scenario in details. From this i can say this is possible . All you do see to check the user group and according to this you can create a switchable actions in your controller .

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-11T04:56:00.373

扩展管理器中的几个复选框 - 扩展配置选项卡用于选择用户组及其在扩展中的权限怎么样？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-11T08:34:04.377

我尝试在我自己的后端模块中向不同的用户显示不同的 extbase-model-entries。例如，用户 'editor' 只能看到 'entry1' 和 'special_editor' 看到 'entry2' 和 'entry3'。我的想法是扩展用户组 tca 并为我的模型添加一个选择字段。我的后端模块将检查当前后端用户以获取他的用户组，而不是我想检查分配的模型。这似乎很费力，但我认为这是最好的也是唯一的方法。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-11T15:39:07.117

我得到一个解决方案：

首先，我向 be_users 添加了一个字段。

```
$tempColumns = array(
    'model' => array(
        'exclude' => 0,
        'l10n_mode' => 'mergeIfNotBlank',
        'label' => 'LLL:EXT:extensionResources/Private/Language/locallang_db.xml:tx_extension_domain_model_ownmodel',
        'config' => array(
            'type' => 'select',
            'foreign_table' => 'tx_extension_domain_model_ownmodel',
            'size' => 10,
            'width' => 20,
            'minitems' => 0,
            'maxitems' => 9999,
            'allowNonIdValues' => 0,
            'eval' => 'required',

        ),
    ),
);

t3lib_div::loadTCA('be_users');
t3lib_extMgm::addTCAcolumns('be_users',$tempColumns,1);
t3lib_extMgm::addToAllTCAtypes('be_users','model;;;;1-1-1'); 
```

在我的后端模块中，我检查当前的后端用户

```
$GLOBALS['BE_USER']->user['model'] 
```

所以我得到了一个用逗号分隔的模型ID列表。

而已。

# android - 代码适用于 Gingerbread (2.3.6) 而不是 ICS (4.0.4)

> ID：14258944
> 
> 赞同：3
> 
> 时间：2013-01-10T13:23:30.660
> 
> 标签：android, android-4.0-ice-cream-sandwich

*   我有一个在 Android 2.3.6 及之前和更低版本上开发和测试的应用程序。它工作正常。
*   我在装有 Android 4.0.4 的新 Micromax A110 上运行该应用程序，当我从 Activity A 启动 Activity B 并按下后退按钮（或 A 中的 Activity C/D/E）时它崩溃，并显示以下错误日志**vv**

> 01-10 18:35:44.372: E/AndroidRuntime(18378): 致命异常: Timer-1 01-10 18:35:44.372: E/AndroidRuntime(18378): java.lang.IllegalStateException: 必须从主线程调用进程 01-10 18:35:44.372: E/AndroidRuntime(18378): 在 android.app.FragmentManagerImpl.execPendingActions(FragmentManager.java:1373) 01-10 18:35:44.372: E/AndroidRuntime(18378): 在android.app.FragmentManagerImpl.executePendingTransactions(FragmentManager.java:437) 01-10 18:35:44.372: E/AndroidRuntime(18378): 在 android.app.FragmentManagerImpl.popBackStackImmediate(FragmentManager.java:454) 01-10 18: 35:44.372: E/AndroidRuntime(18378): 在 android.app.Activity.onBackPressed(Activity.java:2134) 01-10 18:35:44.372: E/AndroidRuntime(18378): 在 com.vwap.friends.MygoBack (MyDialog.java:90) 01-10 18:35:44.372: E/AndroidRuntime(18378):在 com.vwap.friends.MyDialog$3.run(MyDialog.java:83) 01-10 18:35:44.372: E/AndroidRuntime(18378): 在 java.util.Timer$TimerImpl.run(Timer.java:284 )

*   我完全不知道片段的概念（我计划尽快处理），看起来错误与它有关。

我不知道从哪里开始。我是从阅读 Fragments 开始，还是可以快速解决这个问题并发布我的应用程序？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-10T14:09:08.440

您正在主线程上执行网络操作。如果您的目标 SDK 是 11 或更高版本，则会抛出`NetworkOnMainThreadException`，因为此行为可能会阻塞 UI 并导致应用程序无响应。

您可以使用 an[`AsyncTask`](http://developer.android.com/reference/android/os/AsyncTask.html)来解决这个问题，将数据加载到其`doInBackground(..)`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-10T13:31:01.683

> 尝试使用**runOnUiThread（可运行** **操作）。**

**或者**

您也可以尝试使用**Handler**：

```
final Runnable YOURVIEW = new Runnable()
{
    public void run() 
    {
        SampleMethod(); // Put your Method What you want change
        handler.postDelayed(this, timeout);
    }
};

handler.postDelayed(changeView, timeout); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-29T04:55:03.017

即使我也面临类似的问题，但我认为您必须包含`android_support_v4.jar`文件以兼容所有版本的 Android。

# java - java.util.ConcurrentModificationException 仅在多个触摸事件之后

> ID：14258947
> 
> 赞同：1
> 
> 时间：2013-01-10T13:23:36.883
> 
> 标签：java, android, concurrentmodification

我`java.util.ConcurrentModificationException`在我的应用程序中得到了一个，但前提是我快速连续执行多个触摸事件，并且似乎对较慢的设备（三星 Galaxy S）而不是较快的设备（Galaxy S3）有更大的影响。

我有一个队列，其中存储了一个 int 数组，用于存储相应线的点的不透明度和数据。当不透明度达到 0 时，我从队列中删除该行，因此不再绘制它。

这是堆栈跟踪：

```
01-10 14:06:27.847: E/AndroidRuntime(2081): java.util.ConcurrentModificationException
01-10 14:06:27.847: E/AndroidRuntime(2081):     at java.util.LinkedList$LinkIterator.next(LinkedList.java:124)
01-10 14:06:27.847: E/AndroidRuntime(2081):     at com.android.mcameron.singletrack.Options$TestSurfaceView.drawLinesInvalid(Options.java:559)
01-10 14:06:27.847: E/AndroidRuntime(2081):     at com.android.mcameron.singletrack.Options$TestSurfaceView.run(Options.java:438)
01-10 14:06:27.847: E/AndroidRuntime(2081):     at java.lang.Thread.run(Thread.java:1019) 
```

这些是遍历队列的 2 个函数，我执行删除操作。

```
 private void drawLinesInvalid() {
        paint.setColor(Color.RED);

        for (Iterator<int[]> iterator = invalidLines.iterator(); iterator.hasNext();) {
            int[] invalidLine = iterator.next(); // Line 559 with the error
            float[] line = {invalidLine[1], invalidLine[2], invalidLine[3], invalidLine[4]};

            Xfermode originalXfermode = paint.getXfermode();
            paint.setXfermode(new PorterDuffXfermode(PorterDuff.Mode.CLEAR));
            mCanvas.drawLines(line, paint);
            paint.setXfermode(originalXfermode);
            paint.setAlpha(invalidLine[0]);
            mCanvas.drawLines(line, paint);
        }
    }

    private void decreaseLineOpacity() {
        for (Iterator<int[]> iterator = invalidLines.iterator(); iterator.hasNext();) {
            int[] line = iterator.next();
            if (line[0] <= 0) {
                iterator.remove();
            }
        }

        for (Iterator<int[]> iterator = invalidLines.iterator(); iterator.hasNext();) {
            int[] line = iterator.next();
            line[0] -= 10;
        }
    } 
```

我在这里查看了一些其他问题，大多数人似乎在使用 Foreach 循环以及`remove()`在队列而不是迭代器上执行操作时遇到问题。我认为这两者都不适用于这里。也像上面说的那样，我可以摆脱触摸，所以这不是立即发生的错误。在抛出异常之前，我有时可以触摸 30-50 次。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-10T13:53:15.533

感谢 Peter Lawrey，我使用了`CopyOnWriteArrayList`

我将队列更改为：

```
private CopyOnWriteArrayList<int[]> invalidLines = new CopyOnWriteArrayList<int[]>(); 
```

然后将我的 reductionLineOpacity 更新为：

```
private void decreaseLineOpacity() {
    int position = 0;
    for (Iterator<int[]> iterator = invalidLines.iterator(); iterator.hasNext();) {
        int[] line = iterator.next();
        if (line[0] <= 0) {
            invalidLines.remove(position);
        }
        position++;
    }

    for (Iterator<int[]> iterator = invalidLines.iterator(); iterator.hasNext();) {
        int[] line = iterator.next();
        line[0] -= 10;
        Log.d("Counting", "Opacity: "+ line[0]);
    }
} 
```

我已经点击了几分钟，它没有抛出异常，所以看起来不错

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-10T13:55:02.227

[`ListIterator`](http://developer.android.com/reference/java/util/ListIterator.html)android中使用的`LinkedList`支持修改。因此，正如@Peter Lawrey 所建议的那样，您的问题必须与多线程有关。尝试**同步**这两种方法。如果这会影响性能，您可以尝试`CopyOnWriteArrayList`，但这并不能保证您在线程中迭代时看到最新的更改，因为您正在迭代列表的副本。

# ios - 如何处理从 UITableCell 调用的方法？

> ID：14258950
> 
> 赞同：0
> 
> 时间：2013-01-10T13:23:38.850
> 
> 标签：ios, objective-c, uitableview

在我的 xcode 应用程序中，我之前的设置如下：

主显示 -> 剧集视图表 -> 剧集详细视图

当用户在 UITableView 中选择一个情节时，详细视图被加载。详细视图随后给出了一些新功能，例如下载相应的文件。此下载是通过我制作的帮助程序类处理的，并在用户点击详细视图上的按钮时启动。一切正常。

但是因为详细视图中确实没有太多新信息，所以我开始尝试将其全部放入表格视图的单元格中。现在，当用户单击单元格时，单元格高度会扩展并显示额外信息。

所以我的问题是这个。如何处理从详细视图调用的方法，例如下载文件？

例如，我用来下载相关文件**的函数：**

```
- (IBAction)downloadTheFile:(id)sender {
    self.downloadProgress.hidden = false;
    self.downloadButton.hidden=true;

    [self.myEpisodeDownloader getFileFromURL:[self.currentEpisode epFileURL] withIndicator:[self downloadProgress]];

} 
```

当我尝试将其引入新方法时，我对传递给它的内容以及它如何访问不同的东西感到困惑。**基本上，在失去“细节视图”的过程中，我失去了一个容纳一切的容器。**你可以在我的函数中看到我使用“self”来获取和修改不同的东西。现在我有 cellForRowAtIndexPath 的实例而不是容器来尝试做事。

我开始将所有内容传递给下载功能，但它开始闻起来不对劲。我应该尝试代表吗？中级班？放弃并回到老路？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-10T13:36:16.667

您的 Cell 成为新的容器，您可能可以将您在 detailview 中的许多代码直接移动到`UITableViewCell`. 如果你没有`UITableViewCell`为你的单元子分类，你可能需要，虽然你可以从外部完成所有事情，但如果你在一个子类中完成它们，事情会更好地分离和清晰。

在那个子类中，您应该能够做与在 tableview 中所做的几乎相同的事情，您可能最终会想要阻止用户只是点击大量单元格来触发下载或排队，但那是你应该能够在第一步中学习的东西。

`UITableViewDelegate`提供一个函数`tableView:-[did|will]selectRowAtIndexPath:`，您可以使用它来查找已选择的单元格的实例，并在必要时触发该单元格的下载过程。您从自定义单元格内部完成的任何视图更新。

# java - 从android向servlet发送一个字符串

> ID：14258951
> 
> 赞同：1
> 
> 时间：2013-01-10T13:23:39.690
> 
> 标签：java, android, string, servlets, forceclose

我正在尝试将字符串从 android 应用程序发送到 servlet，然后将该字符串检索到我的 android 应用程序，但是当我尝试调用 servlet 时，它强制关闭我，我不知道为什么（我对 android 和这个很陌生对我来说是一个练习）这是我的 android 简单应用程序：

安卓

```
package com.theopentutorials.android;
import java.io.BufferedReader;
import java.io.IOException;
import java.io.InputStream;
import java.io.InputStreamReader;
import java.net.HttpURLConnection;
import java.net.URL;
import java.net.URLConnection;
import android.app.Activity;
import android.os.AsyncTask;
import android.os.Bundle;
import android.view.View;
import android.view.View.OnClickListener;
import android.widget.Button;
import android.widget.TextView;

public class HttpGetServletActivity extends Activity implements OnClickListener { 
    Button button; 
    TextView outputText; 
    public static String request = "kjo ishte e gjitha"; 
    public static final String URL = ("http://10.0.2.2:8080/HttpGetServlet/HelloWorldServlet?param1=" + request); 

    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.main);
        findViewsById();
        button.setOnClickListener(this);
    }
    private void findViewsById() { 
        button = (Button) findViewById(R.id.button);
        outputText = (TextView) findViewById(R.id.outputTxt);
    }
    public void onClick(View view) { 
        GetXMLTask task = new GetXMLTask();
        task.execute(new String[] { URL });
    }
    private class GetXMLTask extends AsyncTask<String, Void, String> {
        @Override
        protected String doInBackground(String... urls) {
            String output = null;
            for (String url : urls) {
                output = getOutputFromUrl(url);
            }
            return output;
        }
        private String getOutputFromUrl(String url) {
            StringBuffer output = new StringBuffer("");
            try {
                InputStream stream = getHttpConnection(url);
                BufferedReader buffer = new BufferedReader(
                        new InputStreamReader(stream));
                String s = "";
                while ((s = buffer.readLine()) != null)
                    output.append(s);
            } catch (IOException e1) {
                e1.printStackTrace();
            }
            return output.toString();
        }

        private InputStream getHttpConnection(String urlString)
                throws IOException {
            InputStream stream = null;
            URL url = new URL(urlString);
            URLConnection connection = url.openConnection();
            try {
                HttpURLConnection httpConnection = (HttpURLConnection) connection;
                httpConnection.setRequestMethod("GET");
                httpConnection.connect();

                if (httpConnection.getResponseCode() == HttpURLConnection.HTTP_OK) {
                    stream = httpConnection.getInputStream();
                }
            } catch (Exception ex) {
                ex.printStackTrace();
            }
            return stream;
        }
        @Override
        protected void onPostExecute(String output) {
            outputText.setText(output);
        }
    }
} 
```

这是我的简单 servlet

伺服器

```
import java.io.IOException;
import java.io.PrintWriter;
import javax.servlet.ServletException;
import javax.servlet.annotation.WebServlet;
import javax.servlet.http.HttpServlet;
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;

@WebServlet("/HelloWorldServlet")
public class HelloWorldServlet extends HttpServlet {
    private static final long serialVersionUID = 1L;

    public HelloWorldServlet() {
        super();
    }
    protected void doGet(HttpServletRequest request,
            HttpServletResponse response)
            throws ServletException, IOException {
        String par1 =  request.getParameter("param1");
        PrintWriter out = response.getWriter();
        out.println(par1);
    }
} 
```

logcat 日志错误说

```
01-10 13:36:50.014: E/AndroidRuntime(1187): FATAL EXCEPTION: AsyncTask #1
01-10 13:36:50.014: E/AndroidRuntime(1187): java.lang.RuntimeException: An error occured while executing doInBackground()
01-10 13:36:50.014: E/AndroidRuntime(1187):     at android.os.AsyncTask$3.done(AsyncTask.java:299)
01-10 13:36:50.014: E/AndroidRuntime(1187):     at java.util.concurrent.FutureTask.finishCompletion(FutureTask.java:352)
01-10 13:36:50.014: E/AndroidRuntime(1187):     at java.util.concurrent.FutureTask.setException(FutureTask.java:219)
01-10 13:36:50.014: E/AndroidRuntime(1187):     at java.util.concurrent.FutureTask.run(FutureTask.java:239)
01-10 13:36:50.014: E/AndroidRuntime(1187):     at android.os.AsyncTask$SerialExecutor$1.run(AsyncTask.java:230)
01-10 13:36:50.014: E/AndroidRuntime(1187):     at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1080)
01-10 13:36:50.014: E/AndroidRuntime(1187):     at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:573)
01-10 13:36:50.014: E/AndroidRuntime(1187):     at java.lang.Thread.run(Thread.java:856)
01-10 13:36:50.014: E/AndroidRuntime(1187): Caused by: java.lang.NullPointerException: lock == null
01-10 13:36:50.014: E/AndroidRuntime(1187):     at java.io.Reader.<init>(Reader.java:64)
01-10 13:36:50.014: E/AndroidRuntime(1187):     at java.io.InputStreamReader.<init>(InputStreamReader.java:122)
01-10 13:36:50.014: E/AndroidRuntime(1187):     at java.io.InputStreamReader.<init>(InputStreamReader.java:59)
01-10 13:36:50.014: E/AndroidRuntime(1187):     at com.theopentutorials.android.HttpGetServletActivity$GetXMLTask.getOutputFromUrl(HttpGetServletActivity.java:64)
01-10 13:36:50.014: E/AndroidRuntime(1187):     at com.theopentutorials.android.HttpGetServletActivity$GetXMLTask.doInBackground(HttpGetServletActivity.java:54)
01-10 13:36:50.014: E/AndroidRuntime(1187):     at com.theopentutorials.android.HttpGetServletActivity$GetXMLTask.doInBackground(HttpGetServletActivity.java:1)
01-10 13:36:50.014: E/AndroidRuntime(1187):     at android.os.AsyncTask$2.call(AsyncTask.java:287)
01-10 13:36:50.014: E/AndroidRuntime(1187):     at java.util.concurrent.FutureTask.run(FutureTask.java:234)
01-10 13:36:50.014: E/AndroidRuntime(1187):     ... 4 more 
```

有人知道吗？提前谢谢你的帮助 ！祝你今天过得愉快！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-10T13:51:57.777

您需要添加互联网访问权限

```
<uses-permission android:name="android.permission.INTERNET"/> 
```

我发现您应该使用 URLEncoder 对 url 进行编码，因为您的 url 包含空格。请检查[http://developer.android.com/reference/java/net/URLEncoder.html](http://developer.android.com/reference/java/net/URLEncoder.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-10T13:31:53.373

您忘记从您的 android 应用程序中设置 param1。

```
connection.setRequestProperty("param1", "Your String Value"); 
```

然后你会从 Servlet 得到返回值作为响应。

# iphone - 在块中铸造 nil

> ID：14258953
> 
> 赞同：8
> 
> 时间：2013-01-10T13:23:43.010
> 
> 标签：iphone, objective-c, cocoa-touch, objective-c-blocks

我今天刚刚快速玩积木，我遇到了错误：

```
NSString *(^testBlock)(int) = ^(int option) {
    if (option == 1) return @"ONE";
    if (option == 2) return @"TWO";
    return nil;
};
NSLog(@"OUTPUT: %@", testBlock(4)); 
```

```
Return type 'void *' must match previous return type 'NSString *' when block literal has unspecified explicit return type 
```

如果没有输入“1”或“2”，我真的想返回 nil，我决定简单地将最终返回返回到 NSString 使用：

```
NSString *(^testBlock)(int) = ^(int option) {
    if (option == 1) return @"ONE";
    if (option == 2) return @"TWO";
    return (NSString *) nil;
}; 
```

这工作得很好，我只是好奇这是否是正确的解决方案，甚至是不好的做法，因为我以前从未考虑过铸造 nil？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2013-01-10T13:29:25.250

这不是最好的方法。

您应该将第一行更正为：

```
NSString *(^testBlock)(int) =  ^NSString*(int option){
    if(option == 1) return @"ONE"; 
    if(option==2) return @"TWO";
    return nil;
}; 
```

这样，块文字具有指定的返回类型并且错误消失了。正确。

编辑：添加对初始错误的解释：

没有返回类型的块将具有编译器推断的返回类型（函数不会发生这种情况）。当块中有 2 个不同类型的返回语句时（注意 nil 是 void*），编译器无法推断返回类型并报告错误。要修复该错误，您必须手动指定返回类型以避免编译器产生歧义。

作为一个好的做法，除非您使用多态性，否则永远不要从同一个块返回不同的类型。

# android - 工作目录：null环境：尝试在android中调用已编译的FFMPEG时为null

> ID：14258959
> 
> 赞同：1
> 
> 时间：2013-01-10T13:24:00.750
> 
> 标签：android, ffmpeg, mp3

我有编译好的 FFMPEG 文件。我尝试将图像和音频剪辑组合成视频剪辑。结合这两者的功能是：ffmpeg -i /mnt/sdcard/KaraokeVideos/allmapeople.mp3 -i /mnt/sdcard/KaraokeVideos/Penguins.jpg /mnt/sdcard/KaraokeVideos/video_finale.mpg。

我在代码中使用了它：

```
public class MainActivity extends Activity {

    private Process process;
    String command, text;

    // load the library - name matches jni/Android.mk-jj
    //static {

        //System.loadLibrary("ffmpeg");
    //}

    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_main);
        try {
            Execute();
        } catch (IOException e) {
            // TODO Auto-generated catch block
            e.printStackTrace();
        }

    } 

    private void Execute() throws IOException {
        // TODO Auto-generated method stub

        Process p = Runtime.getRuntime().exec("ffmpeg -i /mnt/sdcard/KaraokeVideos/allmapeople.mp3 -i /mnt/sdcard/KaraokeVideos/Penguins.jpg /mnt/sdcard/KaraokeVideos/video_finale.mpg");
        p.getInputStream();
    } 
```

但是我在 logcat 中得到了这个异常：

```
01-10 18:44:24.209: W/System.err(31790): java.io.IOException: Error running exec(). Command: [ffmpeg, -i, /mnt/sdcard/KaraokeVideos/allmapeople.mp3, -i, /mnt/sdcard/KaraokeVideos/Penguins.jpg, /mnt/sdcard/KaraokeVideos/video_finale.mpg] Working Directory: null Environment: null
01-10 18:44:24.239: W/System.err(31790):    at java.lang.ProcessManager.exec(ProcessManager.java:211)
01-10 18:44:24.239: W/System.err(31790):    at java.lang.Runtime.exec(Runtime.java:168)
01-10 18:44:24.239: W/System.err(31790):    at java.lang.Runtime.exec(Runtime.java:241)
01-10 18:44:24.249: W/System.err(31790):    at java.lang.Runtime.exec(Runtime.java:184)
01-10 18:44:24.249: W/System.err(31790):    at com.mindtherobot.samples.ndkfoo.MainActivity.Execute(MainActivity.java:47)
01-10 18:44:24.259: W/System.err(31790):    at com.mindtherobot.samples.ndkfoo.MainActivity.onCreate(MainActivity.java:35)
01-10 18:44:24.259: W/System.err(31790):    at android.app.Activity.performCreate(Activity.java:4465)
01-10 18:44:24.269: W/System.err(31790):    at android.app.Instrumentation.callActivityOnCreate(Instrumentation.java:1049)
01-10 18:44:24.269: W/System.err(31790):    at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1919)
01-10 18:44:24.269: W/System.err(31790):    at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:1980)
01-10 18:44:24.289: W/System.err(31790):    at android.app.ActivityThread.access$600(ActivityThread.java:122)
01-10 18:44:24.289: W/System.err(31790):    at android.app.ActivityThread$H.handleMessage(ActivityThread.java:1146)
01-10 18:44:24.299: W/System.err(31790):    at android.os.Handler.dispatchMessage(Handler.java:99)
01-10 18:44:24.309: W/System.err(31790):    at android.os.Looper.loop(Looper.java:137)
01-10 18:44:24.309: W/System.err(31790):    at android.app.ActivityThread.main(ActivityThread.java:4340)
01-10 18:44:24.319: W/System.err(31790):    at java.lang.reflect.Method.invokeNative(Native Method)
01-10 18:44:24.319: W/System.err(31790):    at java.lang.reflect.Method.invoke(Method.java:511)
01-10 18:44:24.329: W/System.err(31790):    at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:784)
01-10 18:44:24.339: W/System.err(31790):    at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:551)
01-10 18:44:24.339: W/System.err(31790):    at dalvik.system.NativeStart.main(Native Method)
01-10 18:44:24.359: W/System.err(31790): Caused by: java.io.IOException: Permission denied
01-10 18:44:24.359: W/System.err(31790):    at java.lang.ProcessManager.exec(Native Method)
01-10 18:44:24.369: W/System.err(31790):    at java.lang.ProcessManager.exec(ProcessManager.java:209)
01-10 18:44:24.379: W/System.err(31790):    ... 19 more
01-10 18:44:24.699: D/gralloc_goldfish(31790): Emulator without GPU emulation detected. 
```

这里有什么问题，任何帮助都会很棒！

# android - 无法连接安卓模拟器查看本地站点和服务

> ID：14258961
> 
> 赞同：0
> 
> 时间：2013-01-10T13:24:07.553
> 
> 标签：android, cordova, android-emulator, adb

我正在尝试使用 Android 模拟器来使用在我的本地机器上运行的服务。我有一个在 IIS 下运行的站点，它在我的主机文件中如下所示：

```
127.0.0.1       www.local.company.co.uk 
```

我有几个在 Apache Tomcat 下运行的站点。我的 Tomcat 相关站点的主机文件：

```
127.0.0.1       internal.localhost.company.com  # port:8090
127.0.0.2       external.localhost.company.com  # port:8081
127.0.0.3       auth.ws.localhost.company.com  # port:8082
127.0.0.8       mysite.localhost.company.com  # port:8086 
```

到目前为止我尝试过的（在以下步骤中）：

```
adb pull /etc/hosts 
```

编辑安卓主机文件：

```
127.0.0.1        localhost
10.0.2.2         myefc.localhost.efinancialcareers.com 
```

adb remount adb push hosts /etc/hosts 然后我尝试在浏览器中访问 myefc.localhost.efinancialcareers.com 并被告知找不到网页。我至少希望它可以访问 www.local.company.co.uk。

理想情况下，我希望能够访问上述主机文件示例中指定的本地计算机上的任何站点。

我在 Windows 7 上使用 Tomcat 6。我使用的模拟器是 nexus one。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-10T19:02:50.227

您需要使用服务器的 IP 地址。如果您从设备引用 localhost，它将尝试通过环回 IP 地址 127.0.0.1 与自身建立连接。

# apache - 使用 Apache mod_proxy 反向代理和更改 url

> ID：14258967
> 
> 赞同：0
> 
> 时间：2013-01-10T13:24:23.637
> 
> 标签：apache, mod-proxy

我成功地使用 Apache mod_proxy 将对 testing.com/foo/bar 的请求反向代理到 mybackendservice.com/foo。但是，不是浏览器中显示的当前 url：testing.com/foo/bar，我想让 url 反映 testing.com/foo。我怎样才能做到这一点？我的 mod 代理设置如下所示：

```
ProxyPass /foo/bar mybackendservice.com/foo
ProxyPassReverse /foo/bar mybackendservice.com/foo 
```

我也尝试使用以下方法重写 url：

```
RewriteEngine on

RewriteRule foo/bar foo [NC] 
```

但这似乎不起作用。还有另一种方法可以实现这一目标吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-07-16T11:43:38.023

您需要使用 HTTP 重定向而不是 mod_rewrite。

创建一个返回 HTTP 状态 302 Found 的脚本并指定 HTTP 标头位置：/foo

# javascript - Javascript变量空错误？

> ID：14258970
> 
> 赞同：0
> 
> 时间：2013-01-10T13:24:33.230
> 
> 标签：javascript

嗨，我在使用 firebug 的 javascript 代码中发现了一个错误，“ **b is null** ”并且我的图像没有改变。我想要实现的是 3 张图像最终在网页上交换，但目前是独立的。目前没有发生任何事情它和我已经在 3 种知名浏览器中进行了测试。

任何帮助都会很棒

```
<script type="text/javascript">  
var ImageArr1 = new Array("banner1.jpg","banner2.jpg","banner3.jpg");
var ImageHolder1 = document.getElementById("photo");

function RotateImages(whichHolder,Start)
{
    var a = eval("ImageArr"+whichHolder);
    var b = eval("ImageHolder"+whichHolder);
    if(Start>=b.length)
        Start=0;
    b.src = a[Start];
    document.getElementById('slideNumber').textContent = "Slide "+(Start+1)+" of         "+ImageArr1.length;
    window.setTimeout("RotateImages("+whichHolder+","+(Start+1)+")",3500);
}

RotateImages(1,0);
</script> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-10T13:26:50.353

由于您使用`Start`to index into `a`，您可能应该更改您的`if`条件以反映这一点：

```
...
if(Start>=a.length)
    Start=0;
... 
```

# php - 命令行 php,socket

> ID：14258971
> 
> 赞同：3
> 
> 时间：2013-01-10T13:24:43.937
> 
> 标签：php, websocket

我试图在我的本地主机（WAMP）中运行带有套接字的 php 代码，它在浏览器中运行良好，但是当我尝试在命令行中执行相同操作时，它会抛出异常“函数 socket_create 不存在”。所以我试图检查是否启用了 php_sockets extintion 并且它是，所以它仍然无法正常工作，之前有人已经越过它了吗？这是一个例外：

> PHP 致命错误：在第 2 行的 C:\wamp\www\sock et\serverc.php 中调用未定义函数 socket_create() PHP 堆栈跟踪：PHP 1\. {main}() C:\wamp\www\socket\serverc .php:0
> 
> 致命错误：在第 2 行的 C:\wamp\www\socket\se rverc.php 中调用未定义函数 socket_create()
> 
> 调用堆栈：0.0010 230696 1\. {main}() C:\wamp\www\socket\serverc.php:0

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-17T12:53:27.650

Windows 上 CLI 模式下的 PHP 使用`php.ini`位于`C:\Windows`（请参阅[http://php.net/manual/en/configuration.file.php](http://php.net/manual/en/configuration.file.php)）中的文件。所以在这里检查是否`php_socket`启用。

# magento - 在 Magento 中将购物车添加到 top.menu

> ID：14258972
> 
> 赞同：0
> 
> 时间：2013-01-10T13:24:43.853
> 
> 标签：magento, cart

我正在构建一个导航栏，其中包括用户菜单和购物车以及愿望清单，但试图弄清楚如何将其添加到 xml 模型中以使用 getChildHtml 函数将其包含在内。

XML 文件：page.xml

```
<block type="page/html_header" name="header" as="header"> 
```

我有

```
<block type="core/text_list" name="top.menu" as="topMenu" translate="label"> 
```

现在，据我所见，我必须在某处包含以下内容或扩展块或不确定的内容，请帮助我朝正确的方向前进，甚至将我指向涵盖此内容的开发人员指南。

```
<block type="checkout/cart_sidebar" name="cart_sidebar" as="topcart" template="checkout/cart/sidebar.phtml"/> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-11T08:52:41.300

在主题文件夹 app/design/frontend/your_package/your_theme/layout/ 中创建文件**local.xml**，添加以下行并保存文件。

```
<layout version="0.1.0">
    <default>
        <reference name="top.menu">
            <block type="checkout/cart_sidebar" name="cart_sidebar" as="topcart" template="checkout/cart/sidebar.phtml"/>
        </reference>
 </default></layout> 
```

应用更改后不要忘记清除 magento 缓存（系统->缓存管理）。

为了了解更多关于 Magento 块、布局、模板的信息，有一个官方的 magento 指南[在这里查看](http://www.magentocommerce.com/resources/magento-user-guide)

# android - 安卓 srec_jni

> ID：14258976
> 
> 赞同：2
> 
> 时间：2013-01-10T13:25:00.327
> 
> 标签：android, c++, speech-recognition, android-4.2-jelly-bean

我现在正在为谷歌开发应用程序，我得到了语音识别引擎的代码，但看起来有很多与之相关的头文件。我想知道在哪里可以获得包含相关头文件的 srec_jni 完整源代码，每个我都得到 srec_jni 的基本文件，而不是所有相关的头文件。

# objective-c - 奇怪的核心数据行为

> ID：14258977
> 
> 赞同：0
> 
> 时间：2013-01-10T13:25:05.477
> 
> 标签：objective-c, core-data, nsoperationqueue, nsblockoperation

我使用一个和在这个块内执行一些工作`NSBlockOperation`，持久存储丢失了它的持久存储。

以下代码：

```
- (void) eraseCoreData_ManagedObjectsInArray:(NSArray *) arrayOfManagedObjectsToDelete usingManagedContext:(NSManagedObjectContext *) managedObjectContext
{
    NSLog(@"Managed object context is %@", managedObjectContext);
    NSLog(@"----->Persistent store of the deletion context has %d stores", [managedObjectContext.persistentStoreCoordinator.persistentStores count]);

    // add the operation to the queue with a block
    [self.coreDataDeletionQueue addOperationWithBlock:^{

    for (NSManagedObject *objectToDelete in arrayOfManagedObjectsToDelete) {
        [managedObjectContext deleteObject:objectToDelete];
    }

    NSLog(@"Managed object context in operation block is %@", managedObjectContext);
    NSLog(@"Persistence store coordinator in operation block is %@", managedObjectContext.persistentStoreCoordinator);
    NSLog(@"Persistent store of the deletion context in operation block has %d stores", [managedObjectContext.persistentStoreCoordinator.persistentStores count]);

    NSError *saveError = nil;
    if (![managedObjectContext save:&saveError]) {
        NSLog(@"Couldn't save Core-Data state for the deleted objects result: %@", [saveError localizedDescription]);
    }
    }];
} 
```

记录下来：

托管对象上下文是 < NSManagedObjectContext: 0xa46ff10 >

----->删除上下文的持久存储有1个存储

操作块中的托管对象上下文是 < NSManagedObjectContext: 0xa46ff10 >

操作块中的持久存储协调器是 < NSPersistentStoreCoordinator: 0xa1a45e0 >

操作块中删除上下文的持久存储有 0 个存储

> ***由于未捕获的异常“NSInternalInconsistencyException”而终止应用程序，原因：“此 NSPersistentStoreCoordinator 没有持久存储。它无法执行保存操作。

我不确定为什么会突然丢失存储，这可能是因为它在我设置为使用内存存储的测试套件中运行，并且内存不与`NSOperationQueue`执行块的它共享吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-10T14:03:07.077

我猜你以错误的方式使用你的代码。

首先，每个线程**必须**有自己的上下文。因此，在块操作中，您需要创建一个新上下文并在该块中使用它。

```
NSManagedObjectContext *blockContext = [[NSManagedObjectContext alloc] init];
[blockContext setPersistentStoreCoordinator:[managedObjectContext persistentStoreCoordinator]]; 
```

然后，如果您需要在上下文中共享对象，请使用`NSManagedObjectID`而不是`NSManagedObject`. 在创建该块之前，请保存主要上下文，否则您将只有临时 ID。否则用于`- (BOOL)obtainPermanentIDsForObjects:(NSArray *)objects error:(NSError **)error`获取永久ID而不保存。

```
NSArray *objectIDs = [arrayOfManagedObjectsToDelete valueForKey:@"objectID"]; 
```

在块内用于`- (NSManagedObject *)existingObjectWithID:(NSManagedObjectID *)objectID error:(NSError **)error`通过 检索您感兴趣的对象`blockContext`。

您的代码可能看起来像

```
NSArray *objectIDs = [arrayOfManagedObjectsToDelete valueForKey:@"objectID"];

// add the operation to the queue with a block
[self.coreDataDeletionQueue addOperationWithBlock:^{

    NSManagedObjectContext *blockContext = [[NSManagedObjectContext alloc] init];
    [blockContext setPersistentStoreCoordinator:[managedObjectContext persistentStoreCoordinator]];

    NSError* error = nil;
    for (NSManagedObject *objectID in objectIDs) {
        // some error handling here...
        NSManagedObject* objectToDelete = [existingObjectWithID:objectID error:&error];
        [blockContext deleteObject:objectToDelete];
    }

    if (![blockContext save:&error]) {
        NSLog(@"Couldn't save Core-Data state for the deleted objects result: %@", [error localizedDescription]);
    }
}]; 
```

# android - 处理同一配置组内的不同分辨率

> ID：14258981
> 
> 赞同：1
> 
> 时间：2013-01-10T13:25:31.653
> 
> 标签：android, android-layout

我有一个 normal-hdpi-480x800 布局，其中包括按钮和类似的图形。我主要使用RelativeLayout，因为建议使用它以获得更好的性能，并且将我的元素从左上边界相对放置。根据screens_support.html，该组可能还包括600x1024 分辨率的设备。所以，当我在同样属于 normal-xhdpi 的 LG L9 (540x960) 上测试应用程序时，它看起来很糟糕——使用像素和 dp 似乎没有区别。这是一个代码示例：

```
<Button
    android:id="@+id/fb_post_btn"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_marginLeft="@dimen/share_fb_m_l"
    android:layout_marginTop="@dimen/share_fb_m_t"
    android:background="@drawable/fb_btn" /> 
```

有什么帮助吗？我可能做错了什么？

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-10T13:40:38.800

如果您需要根据屏幕密度更好地控制按钮大小，只需在文件夹`values-ldpdi`、`values-mdpi`、`values-hdpi`中指定不同的尺寸。`values-xhdpi`像这样：

```
<resources>
    <dimen name="share_fb_m_l">47dp</dimen>
    <dimen name="share_fb_m_t">57dp</dimen>
</resources> 
```

**更新**：您可以对此进行更多控制：

为不同的屏幕分辨率和密度指定多个不同的图像。为此，请阅读支持多个屏幕。如果您需要更精确的图像缩放和质量，您可以使用屏幕属性的基本尺寸，即 swdp - 您可以指定应使用图像的屏幕的最小宽度。这是资源文件夹的限定名称。

**将您的尺寸放在这些文件夹`values-sw540dp`中，`values-sw540dp`,`values-sw600dp`** - 这些应该用作子文件夹以进行更多控制。

# android - android canvas.drawbitmap() 图像不断重复

> ID：14258982
> 
> 赞同：2
> 
> 时间：2013-01-10T13:25:46.770
> 
> 标签：android

我在 android 上制作一个游戏，那里有一个图像，你必须拖动和移动它。但是，当我拖动它时，会在拖动图像的路径上创建几个图像。请查看我的代码并提供帮助

```
package com.saad.alien;

import android.app.Activity;
import android.content.Context;
import android.graphics.Bitmap;
import android.graphics.BitmapFactory;
import android.graphics.Canvas;
import android.graphics.RectF;
import android.os.Bundle;
import android.view.MotionEvent;
import android.view.SurfaceHolder;
import android.view.SurfaceView;
import android.view.View;
import android.view.View.OnTouchListener;

public class Game extends Activity implements OnTouchListener {

    CustomView Cview;
    float x, y, left = 0, top = 0, right = 0, bottom = 0;
    float dx, dy;
    Bitmap man;
    int done = 0;
    RectF rman = new RectF(50, 50, 150, 150);

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        // TODO Auto-generated method stub
        super.onCreate(savedInstanceState);

        Cview = new CustomView(this);
        Cview.setOnTouchListener(this);
        x = 50;
        y = 600;
        dx = dy = 0;

        man = BitmapFactory.decodeResource(getResources(), R.drawable.man);

        setContentView(Cview);
    }

    @Override
    protected void onPause() {
        // TODO Auto-generated method stub
        super.onPause();
        Cview.pause();
    }

    @Override
    protected void onResume() {
        // TODO Auto-generated method stub
        super.onResume();
        Cview.resume();
    }

    public boolean onTouch(View v, MotionEvent event) {
        // TODO Auto-generated method stub

        try {
            Thread.sleep(50);
        } catch (InterruptedException e) {
            // TODO Auto-generated catch block
            e.printStackTrace();
        }

        // x = event.getX();
        // y = event.getY();
        switch (event.getAction()) {

        case MotionEvent.ACTION_DOWN:
            dx = event.getX();
            dy = event.getY();
            float length = x + man.getWidth();
            float height = y + man.getHeight();
            if (dx > x && dx < length && dy > y && dy < height) {
                done = 1;
            }
            break;
        case MotionEvent.ACTION_MOVE:
            if (done == 1) {
                x = event.getX();
                y = event.getY();
            }
            break;
        case MotionEvent.ACTION_UP:
            if (done == 1) {
                x = event.getX();
                y = event.getY();
                done = 0;
            }
            break;
        }

        return true;
    }

    public class CustomView extends SurfaceView implements Runnable {

        SurfaceHolder ourHolder;
        Thread ourThread = null;
        boolean isRunning = false;

        public CustomView(Context context) {
            super(context);
            ourHolder = getHolder();
        }

        public void pause() {
            isRunning = false;
            while (true) {
                try {
                    ourThread.join();
                } catch (InterruptedException e) {
                    // TODO Auto-generated catch block
                    e.printStackTrace();
                }
                break;
            }
            ourThread = null;
        }

        public void resume() {
            isRunning = true;
            ourThread = new Thread(this);
            ourThread.start();
        }

        public void run() {
            while (isRunning) {
                if (!ourHolder.getSurface().isValid())
                    continue;

                Canvas can = ourHolder.lockCanvas();
                left = x;
                right = (x + man.getWidth());
                top = y;
                bottom = (y + man.getHeight());
                rman.set(left, top, right, bottom);
                can.drawBitmap(man, null, rman, null);
                ourHolder.unlockCanvasAndPost(can);

            }

        }

    }

} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-10T13:29:40.880

在画布之前，您需要清除每一帧的画布。

例如，类似：

```
 Canvas.drawColor(Color.BLACK) 
```

# python - 从单个列表构建字典的最 Pythonic 方式

> ID：14258984
> 
> 赞同：8
> 
> 时间：2013-01-10T13:25:59.487
> 
> 标签：python, list, dictionary

我有一个我想从中创建字典的日期名称列表（通常是周一至周六，尽管有特殊情况适用）。我想将每天的值初始化为零。

如果我有一个与天数列表长度相同的零列表，这将是`zip()`. 但是，零列表是浪费空间，如果这是唯一的解决方案，我会尽快做类似的事情：

```
for day in weekList:
    dayDict[day] = 0 
```

有没有更蟒蛇的方式？

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2013-01-10T13:26:57.830

使用[`.fromkeys()`类方法](http://docs.python.org/2/library/stdtypes.html#dict.fromkeys)：

```
dayDict = dict.fromkeys(weekList, 0) 
```

它使用第一个参数（序列）中的元素作为键构建字典，第二个参数（默认为`None`）作为所有条目的值。

就其本质而言，此方法将重用所有键的值；不要将可变值传递给它，例如列表或字典，并期望它为每个键创建该可变值的单独副本。在这种情况下，请改用 dict 理解：

```
dayDict = {d: [] for d in weekList} 
```

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2013-01-10T13:29:15.117

除此之外，`dict.fromkeys`您还可以使用`dict-comprehension`, 但 `fromkeys()`比 dict 理解更快：

```
In [27]: lis = ['a', 'b', 'c', 'd']

In [28]: dic = {x: 0 for x in lis}

In [29]: dic
Out[29]: {'a': 0, 'b': 0, 'c': 0, 'd': 0} 
```

对于 2.6 及更早版本：

```
In [30]: dic = dict((x, 0) for x in lis)

In [31]: dic
Out[31]: {'a': 0, 'b': 0, 'c': 0, 'd': 0} 
```

`timeit`比较：

```
In [38]: %timeit dict.fromkeys(xrange(10000), 0)         # winner
1000 loops, best of 3: 1.4 ms per loop

In [39]: %timeit {x: 0 for x in xrange(10000)}
100 loops, best of 3: 2.08 ms per loop

In [40]: %timeit dict((x, 0) for x in xrange(10000))
100 loops, best of 3: 4.63 ms per loop 
```

正如@Eumiro 和@mgilson 的评论中提到的，重要的是要注意，如果使用的值是可变对象`fromkeys()`，`dict-comprehensions`则可能会返回不同的对象：

```
In [42]: dic = dict.fromkeys(lis, [])

In [43]: [id(x) for x in dic.values()]
Out[43]: [165420716, 165420716, 165420716, 165420716] # all point to a same object

In [44]: dic = {x: [] for x in lis}

In [45]: [id(x) for x in dic.values()]
Out[45]: [165420780, 165420940, 163062700, 163948812]  # unique objects 
```

# c++ - 如何在linux中实现回溯功能以在崩溃时打印堆栈跟踪

> ID：14258985
> 
> 赞同：0
> 
> 时间：2013-01-10T13:25:59.920
> 
> 标签：c++

由于我使用的是旧版本的内核，所以 glibc 的回溯功能不起作用，所以我想为 c/c++ 语言和 linux os 中的函数实现获得一些方向......

# sql - SQL 游标语法问题

> ID：14258986
> 
> 赞同：0
> 
> 时间：2013-01-10T13:26:01.047
> 
> 标签：sql, sql-server-2008, cursor

我收到此错误消息 102，级别 15，状态 1，过程 CostTest_02，第 43 行“;”附近的语法不正确。

用红色下划线的“GO”我一直在寻找错误，但我找不到！我对游标不是很有经验（这是我写的第一个）如果有人能发现它或任何其他错误，我将非常感谢

[http://imgur.com/9k40O](http://imgur.com/9k40O) <----- 图片更清晰（推荐）

```
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
-- =============================================
-- Author:      <Author,,Name>
-- Create date: <Create Date,,>
-- Description: <Description,,>
-- =============================================
CREATE PROCEDURE CostTest_02
AS
BEGIN

DECLARE @Issue_id int;
DECLARE @Master_id int;
DECLARE @Issue_table varchar(255);
DECLARE @price real;
DECLARE @rowcount bigint;

DECLARE cost_cursor cursor FOR
SELECT [Issue Id], [Master Id], [Issue Table], [Price]
from Adhoc_datafix..[Issue Table]
FOR UPDATE OF ADHOC_DATAFIX..[Issue Cost];

OPEN cost_cursor;
FETCH NEXT FROM cost_cursor into @Issue_ID, @Master_id, @Issue_table, @Price

WHILE @@FETCH_STATUS = 0
BEGIN

Select count(*) from @Issue_Table
set @Rowcount = @@rowcount

UPDATE ADHOC_DATAFIX..[Issue Cost]
set  [Issue Id] = @Issue_ID ,
[Master Issue Id] = @Master_ID ,
[Row Count] = (Select count(*) from @Issue_Table), --@Rowcount,
[Cost] = CAST(@Rowcount * @price as money)

WHERE CURRENT OF cost_cursor;
FETCH NEXT FROM cost_cursor
END

close cost_cursor;

DEALLOCATE cost_cursor;
GO 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-10T13:29:21.160

~~我的猜测是`FETCH NEXT FROM cost_cursor`脚本底部附近的行应该是`FETCH NEXT FROM cost_cursor into @Issue_ID, @Master_id, @Issue_table, @Price`~~ .

抱歉，再看这一行：

```
Select count(*) from @Issue_Table 
```

没有意义，因为@Issue_table 实际上不是一个表，它是一个 nvarchar。
在运行时，它被转移到：

```
Select count(*) from 'Value of issue table field' 
```

简而言之，这是行不通的。如果您想从表中动态获取计数，请查看这篇[开创性文章](http://www.sommarskog.se/dynamic_sql.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-10T13:31:22.307

您没有`END`存储过程的语句。只需在前面添加`GO`

# ruby-on-rails - 更新具有批准要求的模型

> ID：14258987
> 
> 赞同：0
> 
> 时间：2013-01-10T13:26:03.993
> 
> 标签：ruby-on-rails, ruby-on-rails-3, model-view-controller

罗尔 3

我有一个包含一些细节的用户模型，其中很少有可编辑的，但需要批准。

我想知道如下更新模型的最佳实践是什么。

1.  用户修改了一些数据，数据发送审批
2.  用户仍然可以看到旧数据。
3.  版主批准更改。
4.  用户看到新数据

我目前的想法是将其分为两个模型。

1.  用户模型
2.  轮廓模型

用户模型包含当前配置文件的 ID，当用户更新他的配置文件时，他会添加一个新的配置文件模型，并且当管理员批准相同时，相关的配置文件模型将链接到用户模型。（旧的可能会被销毁）。

其他的想法是

1.  每个属性都有 2 个属性（但编辑将是最少的）
2.  由于所有可编辑条目都是字符串，并且仅用于显示，因此实际模型将包含当前值和未经批准的旧值的转义 JSON。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-10T14:07:24.580

目前的*想法*肯定会奏效。不过要考虑的事情：

当用户进行 2 次或更多更改而前一个更改尚未获得批准时会发生什么？他可能会更改不同的属性或对先前更改的属性进行另一次更改。系统必须能够将这些更改合并在一起，因为它们会从不同的基础（不同的模型）分支出来。

也许更好的解决方案是拥有一个当前的配置文件并*等待被批准*的配置文件 (WTBA)。

1.  当没有要批准的更改时，用户会看到当前配置文件。
2.  用户进行更改，系统将创建一个 WTBA 配置文件。
3.  用户看到 WTBA 配置文件（但没有其他人）。
4.  用户进行另一项更改，系统会将更改保存到 WTBA 配置文件（不创建新配置文件）。
5.  版主批准了 WTBA 配置文件，此时 WTBA 成为当前配置文件，我们又回到了#1。

# linq - Foreach 使用 linq 删除

> ID：14258991
> 
> 赞同：3
> 
> 时间：2013-01-10T13:26:10.820
> 
> 标签：linq, entity-framework

以下语句应该从 allCars 中删除 someCars，它可以工作，但是我想知道是否有更好的解决方案专门使用 linq

```
foreach (var car in someCars) 
{
    db.allCars.DeleteObject(car); 
} 
```

请注意，db 是 db 实体的实例。

任何帮助将非常感激。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-10T13:31:13.833

您可以使用[EntityFramework.Extended](http://nuget.org/packages/EntityFramework.Extended)库根据某些条件删除实体（Nuget 提供的库）：

```
db.allCars.Delete(car => /*condition*/); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-11-09T22:59:11.933

使用 Linq 作为 ForEach：

```
db.allCars.Where(/* condition */).ToList().ForEach(car => db.allCars.Remove(car)); 
```

在这个答案的同一行:)，[我如何删除实体框架中的多行（没有 foreach）](https://stackoverflow.com/questions/2519866/how-do-i-delete-multiple-rows-in-entity-framework-without-foreach/2519892#2519892)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-10T13:33:42.230

您可以使用：

```
db.allCars.RemoveAll(db.allCars.Where(/* condition */)); 
```

# sql - 使用版本号插入数据库

> ID：14258992
> 
> 赞同：0
> 
> 时间：2013-01-10T13:26:12.387
> 
> 标签：sql, wix, wix3.6

我们当前的 wix 安装程序会使用版本号自动构建，但是我们现在想要扩展它，以便在安装期间将版本号添加到版本历史数据库表中。

我正在使用一个简单的 SQL 脚本来插入版本号，但是我似乎无法找到可用于获取版本号以插入表中的属性。

wix 中是否有任何可以在安装过程中访问的公共属性包含版本号，所以我可以使用它将它插入数据库？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-10T14:03:31.600

[ProductVersion 属性 (Windows)](http://msdn.microsoft.com/en-us/library/windows/desktop/aa370859%28v=vs.85%29.aspx)

有关如何实现它的提示，请参阅：

[如何在从安装程序执行的 sql 文件中使用 WiX 属性？](https://stackoverflow.com/questions/3096573/how-can-i-use-wix-properties-in-a-sql-file-executed-from-the-installer)

# networking - MSMQ：消息队列服务不可用。错误信息

> ID：14258995
> 
> 赞同：1
> 
> 时间：2013-01-10T13:26:18.223
> 
> 标签：networking, msmq

过去几个月 MSMQ 一直在工作，但我突然收到以下错误消息：

```
Message Queue service is not available. 
```

这是当我在现场测试它时在本地测试它时，我得到以下消息：

```
 Unable to validate data.
Description: An unhandled exception occurred during the execution of the current web request. Please review the stack trace for more information about the error and where it originated in the code.

Exception Details: System.Web.HttpException: Unable to validate data.

Source Error:

An unhandled exception was generated during the execution of the current web request. Information regarding the origin and location of the exception can be identified using the exception stack trace below.

Stack Trace:

[HttpException (0x80004005): Unable to validate data.]
   System.Web.Configuration.MachineKeySection.EncryptOrDecryptData(Boolean fEncrypt, Byte[] buf, Byte[] modifier, Int32 start, Int32 length, Boolean useValidationSymAlgo, Boolean useLegacyMode, IVType ivType, Boolean signData) +4961431
   System.Web.Security.MachineKey.Decode(String encodedData, MachineKeyProtection protectionOption) +194
   System.Web.Helpers.AntiForgeryDataSerializer.Deserialize(String serializedToken) +120

[HttpAntiForgeryException (0x80004005): A required anti-forgery token was not supplied or was invalid.]
   System.Web.Helpers.AntiForgeryDataSerializer.Deserialize(String serializedToken) +754
   System.Web.Helpers.AntiForgeryWorker.Validate(HttpContextBase context, String salt) +199
   System.Web.Mvc.ControllerActionInvoker.InvokeAuthorizationFilters(ControllerContext controllerContext, IList`1 filters, ActionDescriptor actionDescriptor) +156
   System.Web.Mvc.ControllerActionInvoker.InvokeAction(ControllerContext controllerContext, String actionName) +825488
   System.Web.Mvc.Controller.ExecuteCore() +159
   System.Web.Mvc.ControllerBase.Execute(RequestContext requestContext) +335
   System.Web.Mvc.<>c__DisplayClassb.<BeginProcessRequest>b__5() +62
   System.Web.Mvc.Async.<>c__DisplayClass1.<MakeVoidDelegate>b__0() +20
   System.Web.Mvc.<>c__DisplayClasse.<EndProcessRequest>b__d() +54
   System.Web.CallHandlerExecutionStep.System.Web.HttpApplication.IExecutionStep.Execute() +469
   System.Web.HttpApplication.ExecuteStep(IExecutionStep step, Boolean& completedSynchronously) +375 
```

有没有人遇到过这个问题，它一直在工作然后停止并对此进行任何修复？

编辑：我在设置 msmq 时遇到了一些问题，请参阅： [MSMQ 创建错误：工作组安装计算机不支持该操作/用户的内部消息队列证书不存在](https://stackoverflow.com/questions/12496112/msmq-creating-errors-a-workgroup-installation-computer-does-not-support-the-ope)

我的设置我们有 6 台服务器，它们是负载平衡的，并且都设置了 msmq，域设置为网络服务，还涉及另外两台服务器 - 接收消息的域控制器和接收消息的 serach 服务器消息 - 我不知道所有或仅一个特定服务器是否存在问题。我试图通过使用主机文件（C:\Windows\System32\drivers\etc\Host）并一次指向每台服务器来缩小范围，但它们似乎仍然是零星的，无论它们是否工作。我们确实使用缓存，所以我不确定这是否会影响任何事情......

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2020-04-14T09:06:56.243

我知道这可能听起来像一个虚拟的解决方案，但它肯定对我有用。

您需要删除 MSMQ 并重新安装，但为了让其他服务真正看到它，您需要在每一步之间重新启动......所以您需要执行以下操作：

*   删除 MSMQ
*   重启服务器
*   安装 MSMQ
*   重新启动服务器：注意有时不需要此步骤，这取决于其他服务是否能够在此级别看到 MSMQ。

祝你好运

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2017-09-28T06:19:25.830

若要解决此问题，请按照下列步骤操作： 以管理员身份登录到您的计算机。单击开始，然后单击运行。

出现运行对话框。在“打开”框中，键入 Services.msc，然后单击“确定”。

出现服务窗口。找到消息队列。右键单击消息队列，然后单击属性。

出现消息队列属性（本地计算机）对话框。在登录选项卡上，单击本地系统帐户。单击应用，然后单击确定。停止消息队列服务，然后启动消息队列服务。

# c++ - C++如何调用带参数的线程

> ID：14258997
> 
> 赞同：0
> 
> 时间：2013-01-10T13:26:22.387
> 
> 标签：c++, multithreading

> **可能重复：**
> [将参数传递给 _beginthreadex](https://stackoverflow.com/questions/5968076/passing-parameters-to-beginthreadex)

我如何调用而`TestFunction2`不是使用as包含 3 个附加参数`TestFunction1``ExecuteLocalThread``beginthreadex``TestFunction2`

```
unsigned __stdcall TestFunction1(void* timerPointer)
{
    unsigned result =0;
    printf("thread is running\n");
    return result;
}

unsigned __stdcall TestFunction2(void* timerPointer, wchar_t *appId, wchar_t *userName, wchar_t *password)
{
    unsigned result =0;
    printf("thread is running\n");
    return result;
}

void ExecuteLocalThread()
{
    HANDLE   heartBeatThread;
    unsigned int hbThreadID;
    heartBeatThread = (HANDLE)_beginthreadex(NULL, 0 , &TestFunction1, (void*)this, CREATE_SUSPENDED, &hbThreadID);
    ResumeThread( heartBeatThread );
} 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-01-10T13:29:57.717

使用 C++11 线程：

```
std::thread thr(func, arg0, arg1, arg2); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-10T13:28:09.213

创建一个包含您要传递的所有数据的结构，然后将指向该数据的指针传递到您的线程入口点

```
typedef struct MyThreadData {
    void* timerPointer;
    wchar_t *appId;
    wchar_t *userName;
    wchar_t *password;
}; MyThreadData

unsigned int hbThreadID;
void* threadData = calloc(1, sizeof(*threadData));
/* populate threadData */
heartBeatThread = (HANDLE)_beginthreadex(NULL, 0,
                               &TestFunction1, threadData,
                               CREATE_SUSPENDED, &hbThreadID);

unsigned __stdcall TestFunction1(void* ptr) {
    MyThreadData* threadData = (MyThreadData*)ptr;
    unsigned result;
    printf("thread is running\n");
    result = TestFunction2(ptr->timerPointer, ptr->appId, ptr->userName, ptr->password);
    free(threadData);
    return result;
}

unsigned __stdcall TestFunction2(void* timerPointer, wchar_t *appId, wchar_t *userName, wchar_t *password) {
    unsigned result =0;
    return result;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-10T13:41:51.510

按照建议创建一个结构。如果代码在一个类中并且该类已经包含信息，您也可以使用它：

```
unsigned __stdcall TestFunctionProxy(void* p)
{
    assert(p);
    MyClass* c = static_cast<MyClass*>(p);
    c->TestFunction();
    return 0;
} 
```

如果由于 TestFunction() 是私有的而这不起作用，请将其设为友元函数。顺便说一句：在挂起状态下启动一个线程然后释放它是不必要的。直接启动线程即可。

最后，请记住，使用适当的 C++ 线程库（例如 Boost.Thread）会使这更加灵活，并为您的问题提供解决方案如何传递更多参数。

# scala - 覆盖抽象类型不适用于控制抽象

> ID：14258998
> 
> 赞同：0
> 
> 时间：2013-01-10T13:26:24.620
> 
> 标签：scala, traits, abstract-type

这个问题遵循[Cake 模式中的一个问题，其中覆盖抽象类型不与 Upper Type Bounds 一起工作](https://stackoverflow.com/questions/10213395/cake-pattern-with-overriding-abstract-type-dont-work-with-upper-type-bounds)。我想用`<:`. 前面的链接给出了解决方案，其中包括通过写入特征 S 来改变线性化的顺序。但是，我添加了一个在以下代码中`this: Cake with S`命名的控制抽象。`control`我想调用其中的方法`t`。

```
trait A {
  def ping = println("ping")
}

trait Cake {
  type T
}

trait S { this: Cake with S =>
  type T <: A with S
  def t: T
  def s = println("test")
  // def control(c: =>T): T = c // compile
  // def control(c: =>T): T = c.s // does not compile
  def control(c: =>T): T = c.t // does not compile
  t.ping
  t.s
} 
```

但是，这段代码会导致我无法解释的编译错误

```
 found   : S.this.T#T
 required: S.this.T
         def control(c: =>T): T = c.t
                                    ^ 
```

怎么了 ？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-10T17:44:10.060

```
def control(c: =>T): T 
```

有返回类型`S#T`。显然，`c`也有类型`T`。因此，返回`c`：

```
def control(c: =>T): T = c 
```

编译，而返回`c.s`不编译，因为`s`返回类型为`Unit`. `c.t`无法编译，因为它的返回类型为`S#T#T`.

因此，将编译以下内容：

```
def control(c: =>T): T#T = c.t 
```

由于这里发生的所有事情背后的细节一般来说有点不重要，我建议你谷歌“类型投影”和“路径依赖类型”以获取更多信息。

本质上发生的事情是`c`有类型`T`，在哪里`T <: A with S`，所以我们知道`T`必须有所有`S`的成员，其中一个被定义为`def t: T`。但这`T`不一定与我们的 相同，因此当我们在您的示例中`T`调用时它不符合要求。`c.t`我们想要的是`T`of 类型`T`（或等价`T`的 's`T`或`T`我们的 type member `T`）。这里`T#T`准确地表明了我们想要的。