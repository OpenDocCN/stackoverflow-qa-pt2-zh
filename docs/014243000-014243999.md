# StackOverflow 问答 14243000-14243999

# android - 使用 Maven 编译 Android 测试

> ID：14243002
> 
> 赞同：0
> 
> 时间：2013-01-09T17:30:29.990
> 
> 标签：android, unit-testing, maven, continuous-integration

几天来我一直在抨击这个问题，所以我想是时候问了。

我有一个 android 项目和一个 android-test 项目。我可以在 eclipse 中运行我的测试，一切都很好。

所以现在我将继续通过 maven 使用这些测试，这样我就可以将它们用于 CI。

无论如何，长话短说，我无法让 Maven 编译/运行它们。我查看了 android-maven-plugin 提供的所有示例，但无济于事。

主 POM。

```
<groupId>com.xxx.x_android_finder</groupId>
<artifactId>x_Android_Finder</artifactId>
<version>1.0.2</version>
<packaging>apk</packaging>
<name>xxxx</name>

<dependencies>
   <!--    <dependency>
          <groupId>junit</groupId>
          <artifactId>junit</artifactId>
          <version>4.8.1</version>
          <scope>test</scope>
    </dependency> -->
    <dependency>
        <groupId>com.google.android</groupId>
        <artifactId>android</artifactId>
        <version>4.0.1.2</version>
        <scope>provided</scope>
    </dependency>

    <dependency>
<groupId>com.google.android.maps</groupId>
        <artifactId>maps</artifactId>
        <version>15_r2</version>
        <scope>provided</scope>
    </dependency>

   <dependency>
        <groupId>com.actionbarsherlock</groupId>
        <artifactId>library</artifactId>
        <version>4.1.0</version>
        <type>apklib</type>
        <exclusions>
            <exclusion>
                <groupId>com.google.android</groupId>
                <artifactId>support-v4</artifactId>
            </exclusion>
        </exclusions>
    </dependency>

    <dependency>
        <groupId>com.actionbarsherlock</groupId>
        <artifactId>plugin-maps</artifactId>
        <version>4.1.0</version>
    </dependency> 

    <dependency>
        <groupId>net.hockeyapp.android</groupId>
        <artifactId>HockeySDK</artifactId>
        <version>2.0.2</version>
        <type>apklib</type>
    </dependency>

    <dependency>
        <groupId>com.codeslap</groupId>
        <artifactId>android-facebook</artifactId>
        <version>1.6</version>
        <scope>compile</scope>
    </dependency>

     <dependency>
       <groupId>org.twitter4j</groupId>
       <artifactId>twitter4j-core</artifactId>
       <version>[3.0,)</version>
   </dependency>

</dependencies>

<repositories>
    <repository>
        <id>jakewharton</id>
        <url>http://r.jakewharton.com/maven/release/</url>
    </repository>
    <repository>
        <id>codeslap</id>
        <url>http://casidiablo.github.com/codeslap-maven/repository/</url>
    </repository>

</repositories>

<build>

    <plugins>

        <plugin>
            <groupId>com.jayway.maven.plugins.android.generation2</groupId>
            <artifactId>android-maven-plugin</artifactId>
            <version>3.2.0</version>
            <extensions>true</extensions>

            <configuration>
                <!-- replace resources with target specific -->

                <renameManifestPackage>${customerPackage}</renameManifestPackage> 
                <resourceOverlayDirectory>${customerResources}</resourceOverlayDirectory>

                 <sign>
                    <debug>false</debug>
                 </sign>
                  <manifest>
                    <versionCodeAutoIncrement>true</versionCodeAutoIncrement>
                  </manifest>
                   <zipalign>
                    <inputApk>${project.build.directory}/${project.build.finalName}.apk</inputApk>
                    <outputApk>${project.build.directory}/x_Android_Finder.apk</outputApk>
                 </zipalign>

               <proguard>
                    <skip>true</skip>
                </proguard>

                <sdk>
                    <!-- platform or api level (api level 4 = platform 1.6)-->
                    <platform>17</platform>
                </sdk>
                <assetsDirectory>${project.basedir}/${customerAssets}</assetsDirectory>
                <resourceDirectory>${project.basedir}/res</resourceDirectory>
            </configuration>

            <executions>
                <execution>
                    <id>manifestUpdate</id>
                    <phase>process-resources</phase>
                    <goals>
                        <goal>manifest-update</goal>
                    </goals>
                </execution>
                <execution>
                    <id>alignApk</id>
                    <phase>package</phase>
                    <goals>
                        <goal>zipalign</goal>
                    </goals>
                </execution>
            </executions>
        </plugin>

        <plugin>
            <groupId>org.apache.maven.plugins</groupId>
            <artifactId>maven-jarsigner-plugin</artifactId>
            <version>1.2</version>
            <executions>
                <execution>
                    <id>signing</id>
                    <goals>
                        <goal>sign</goal>
                    </goals>
                    <phase>package</phase>

                    <inherited>true</inherited>
                    <configuration>
                        <archiveDirectory></archiveDirectory>
                        <includes>
                            <include>target/*.apk</include>
                        </includes>
                        <keystore>../certificates/xxx.keystore</keystore>
                        <storepass>xxxx</storepass>
                        <keypass>xxxx</keypass>
                        <alias>csl</alias>

                    </configuration>
                </execution>
            </executions>
        </plugin>

        <!-- <plugin>
            <groupId>org.apache.maven.plugins</groupId>
            <artifactId>maven-javadoc-plugin</artifactId>
            <configuration>
              <skip>true</skip>
            </configuration>
       </plugin> -->

    </plugins>
</build> 
```

测试 pom

```
 <artifactId>x_Android_Finder_Test</artifactId>
    <packaging>apk</packaging>
    <version>1.0.0</version>
    <name>xxxxx</name>

    <dependencies>
        <dependency>
            <groupId>com.google.android</groupId>
            <artifactId>android-test</artifactId>
            <version>1.5_r3</version>
          </dependency>

        <dependency>
            <groupId>com.google.android</groupId>
            <artifactId>android</artifactId>
            <version>4.0.1.2</version>
            <scope>provided</scope>
        </dependency>

        <dependency>
            <groupId>com.google.android.maps</groupId>
            <artifactId>maps</artifactId>
            <version>15_r2</version>
            <scope>provided</scope>
        </dependency>

       <dependency>
            <groupId>com.actionbarsherlock</groupId>
            <artifactId>library</artifactId>
            <version>4.1.0</version>
            <type>apklib</type>
            <exclusions>
                <exclusion>
                    <groupId>com.google.android</groupId>
                    <artifactId>support-v4</artifactId>
                </exclusion>
            </exclusions>
        </dependency>

        <dependency>
            <groupId>com.actionbarsherlock</groupId>
            <artifactId>plugin-maps</artifactId>
            <version>4.1.0</version>
        </dependency> 

        <dependency>
            <groupId>com.connectionservices.csl_android_finder</groupId>
            <artifactId>Csl_Android_Finder</artifactId>
            <type>apk</type>
            <version>1.0.2</version>
        </dependency>

        <dependency>
            <groupId>com.connectionservices.csl_android_finder</groupId>
            <artifactId>Csl_Android_Finder</artifactId>
            <scope>provided</scope>
            <type>jar</type>
            <version>1.0.2</version>
        </dependency>

         <dependency>
              <groupId>junit</groupId>
              <artifactId>junit</artifactId>
              <version>4.8.1</version>
              <scope>test</scope>
        </dependency>

        <dependency>
            <groupId>net.hockeyapp.android</groupId>
            <artifactId>HockeySDK</artifactId>
            <version>2.0.2</version>
            <type>apklib</type>
        </dependency>

        <dependency>
            <groupId>com.codeslap</groupId>
            <artifactId>android-facebook</artifactId>
            <version>1.6</version>
            <scope>compile</scope>
        </dependency>

         <dependency>
           <groupId>org.twitter4j</groupId>
           <artifactId>twitter4j-core</artifactId>
           <version>[3.0,)</version>
       </dependency>

        <dependency>
            <groupId>com.jayway.android.robotium</groupId>
            <artifactId>robotium-solo</artifactId>
            <version>3.6</version>
        </dependency>

    </dependencies>

    <repositories>
        <repository>
            <id>oss.sonatype.org-jayway-with-staging</id>
            <url>http://oss.sonatype.org/content/groups/jayway-with-staging/</url>
        </repository>

        <repository>
             <id>jakewharton</id>
            <url>http://r.jakewharton.com/maven/release/</url>
         </repository>

         <repository>
             <id>codeslap</id>
             <url>http://casidiablo.github.com/codeslap-maven/repository/</url>
         </repository>

    </repositories>

    <build>
        <finalName>${project.artifactId}</finalName>
        <plugins>

            <plugin>
                <groupId>com.jayway.maven.plugins.android.generation2</groupId>
                <artifactId>android-maven-plugin</artifactId>

                <configuration>
                    <sdk>
                        <platform>15</platform>
                    </sdk>

            <test>

                        <createReport>true</createReport>

                    </test>

                </configuration>
                <extensions>true</extensions>

            </plugin>

            <plugin>
                <groupId>org.apache.maven.plugins</groupId>
                <artifactId>maven-surefire-plugin</artifactId>
                <version>2.13</version>

              </plugin>

            <plugin>
                <groupId>org.apache.maven.plugins</groupId>
                <artifactId>maven-jarsigner-plugin</artifactId>
                <!--   <version>1.2</version> -->
                <executions>
                    <execution>
                        <id>signing</id>
                        <goals>
                            <goal>sign</goal>
                        </goals>
                        <phase>package</phase>

                        <inherited>true</inherited>
                        <configuration>
                            <removeExistingSignatures>true</removeExistingSignatures>

                            <archiveDirectory></archiveDirectory>
                            <includes>
                                <include>target/*.apk</include>
                            </includes>
                            <keystore>../certificates/xxxx.keystore</keystore>
                            <storepass>xxx</storepass>
                            <keypass>xxxx</keypass>
                            <alias>csl</alias>
                        </configuration>
                    </execution>
                </executions>
            </plugin>
        </plugins> 
    </build>
</project> 
```

测试项目位于测试项目中的 main/java/... 下

当我编译时，我使用 mvn clean test

它抛出的错误是

```
ERROR] /Users/aidenfry/AndroidHSF(trunknew)/x_Android_Finder_Parent/x_Android_Finder_Test/src/main/java/com/xxxxxxx/x_android_finder_test/FinderActivityTest.java:[27,7] cannot access junit.framework.TestCase
[ERROR] class file for junit.framework.TestCase not found
[ERROR] public class FinderActivityTest extends ActivityInstrumentationTestCase2<FinderActivity> {
[ERROR] /Users/aidenfry/AndroidHSF(trunknew)/x_Android_Finder_Parent/x_Android_Finder_Test/src/main/java/com/xxxx/xx_android_finder_test/FinderActivityTest.java:[39,8] cannot find symbol
[ERROR] symbol  : variable super
[ERROR] location: class 
```

我可以提供更多，但它们都与此相似，似乎找不到 Junit 库？但我已经在dependancioes中拥有它。

如果有人可以帮助/提示我解决这个烂摊子，将不胜感激！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2015-03-12T09:51:06.477

如果有人遇到同样的问题，并且想要执行真正的 Android 单元测试而不是普通的 JUnit 测试：

你需要取消注释

```
<dependency>
      <groupId>junit</groupId>
      <artifactId>junit</artifactId>
      <version>4.8.1</version>
      <!-- scope is compile, not test! -->
      <scope>compile</scope>
</dependency> 
```

junit 依赖并使用正常范围（编译），而不是测试！

希望有帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-10T12:19:47.893

好的，这就是我的做法。

我最初将我的测试用例放在一个单独的模块/eclipse 项目中。这似乎扰乱了我的东西。

将类移动到 src/main/test 下的主应用程序项目中，这现在解决了我所有的问题，谢谢！

# objective-c - 为什么 NSObject 的 "isMemberOfClass:class" 在 XCode 的自动补全中指定了 __unsafe_unretained？

> ID：14243003
> 
> 赞同：4
> 
> 时间：2013-01-09T17:30:30.727
> 
> 标签：objective-c, xcode, automatic-ref-counting

模糊的概述是我正在一个`NSArray`Category 中编写一个方法，该方法将采用 a`Class`并将 Array 过滤到属于该类成员的元素。就像是：

```
@implementation NSArray(filter)
-(NSArray*)objectsOfClass:(Class)aClass {
   NSMutableArray *ret = [[NSMutableArray alloc] init];   
   for (id obj in self)
       if ([obj isMemberOfClass:aClass])
          [ret addObject:obj];

   return [NSArray arrayWithArray:ret];
}
@end 
```

Sooo，顺便说一句，我的问题。NSObject.h 显示 isMemberOfClass: 具有以下签名：

```
 -(BOOL)isMemberOfClass:(Class)aClass; 
```

当我在 XCode 中键入此方法时，自动完成提示一个方法签名，如下所示：

```
 [self isMemberOfClass:(__unsafe_unretained Class)] 
```

我的问题是：

1）为什么NSObject.h中的方法原型和XCode的自动补全有差异？
2）在我自己的方法中（显示在这个问题的开头），我应该包含`__unsafe_unretained`修饰符吗？如果是这样，为什么？如果不是，为什么不呢？

谢谢！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-09T20:30:20.387

在没有明确的所有权条件的情况下，可以推断出所有权条件；这通常是`__strong`但在它的情况下`Class`是`__unsafe_unretained`。这是有道理的，因为`Class`对象是不朽的，不需要由您的代码管理内存。

所以 Xcode 只是使隐式显式，你不需要自己做。

# jquery - 防止多个ajaxcalls不起作用

> ID：14243005
> 
> 赞同：-1
> 
> 时间：2013-01-09T17:30:32.813
> 
> 标签：jquery

我想防止多个 ajaxcalls 但我的代码没有任何反应？

```
<script type="text/javascript">
var isProcessing = false;

function updatePartij(){
    if(isProcessing) return;
    isProcessing = true;
    $.ajax( { url: 'heartbeat.php?uwBeurt=' + uwBeurt + '&w=' + w + '&ka=' + ka,
                succes: {isProcessing = false;}
                error:  {isProcessing = false;}
                    });
    setTimeout('updatePartij()', 4500);  
};
</script> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-09T17:32:06.203

错字和缺少逗号

```
succes: {isProcessing = false;}
error:  {isProcessing = false;} 
```

它们应该是函数

```
success: function(){isProcessing = false;}, //<--- comma
error: function(){isProcessing = false;} 
```

我不喜欢写两次，但为什么不这样做呢？

```
function updatePartij(){
    $.ajax( { url: 'heartbeat.php?uwBeurt=' + uwBeurt + '&w=' + w + '&ka=' + ka,
        success: function(){
           setTimeout('updatePartij()', 4500);  
        },
        error: function(){
           setTimeout('updatePartij()', 4500);  
        }

}; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-09T17:33:14.843

```
succes: {isProcessing = false;} 
```

这是无效的语法。

您需要传递一个*函数*：

```
success: function() { isProcessing = false; } 
```

此外，`success`有两个`s`s。

# javascript - 循环遍历angularjs中的嵌套指令

> ID：14243017
> 
> 赞同：1
> 
> 时间：2013-01-09T17:31:03.440
> 
> 标签：javascript, angularjs

我是 angular 新手，尝试做一些指令嵌套，但遇到了一些问题。

这是我的代码：

```
module.controller("TimelineController", ["$scope", "$compile", function ($scope, $compile) {

    $scope.text = "ohoh";
    $scope.elements = ["12", "13"];

    console.log("Timeline Controller", arguments);

}]);

module.directive('timeline', function() {
    return {
        restrict: 'E',
        transclude: true,
        scope: true,
        controller : "TimelineController",
        link: function(scope, element, attrs, controller) {
            console.log("linking timeline", arguments);
        },
        templateUrl:'templates/directives/timeline.html',
        replace: true
    };
});

module.directive('timelineEvent', function() {
    return {
        restrict: 'E',
        transclude: true,
        scope: true,
        // controller : "TimelineController",
        link: function(scope, element, attrs/*, controller*/) {
            console.log("linking element", arguments);
        },
        templateUrl:'templates/directives/timeline_element.html',
        replace: false
    };
}); 
```

我的模板：

时间线.html：

```
<div class="timeline">
    <p>
        timeline {{text}}
    </p>

    <div ng-repeat="element in elements">
        - event {{element }}
        <timeline-event ng-model="{{element}}"/>
    </div>

</div> 
```

时间线元素.html：

```
<div class="element">
    timeline element o/ \o
</div> 
```

我的 index.html ：

```
[...]
<body>

    <timeline></timeline>

</body> 
```

和意想不到的结果：

```
timeline ohoh

- event 12
- event 13
timeline element o/ \o 
```

预期的结果当然是：

```
timeline ohoh

- event 12
timeline element o/ \o
- event 13
timeline element o/ \o 
```

为什么 ng-repeat 会成功执行，但嵌套指令调用只执行一次？它不应该能够在循环中使用指令吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-09T18:09:14.460

三注。我不知道这些是否是原因（需要在 jsFiddle 中对其进行测试），但它们肯定会破坏一些东西：

*   为什么要设置`transclude: true`？您不在`ng-transclude`模板中使用。你不需要`transclude: true`。

*   `ng-model`你的应该`timeline`是`element`而不是`{{element}}`

*   您正在使用`scope: true`，这意味着将创建一个新范围。您可能需要定义您的`scope`喜欢（在您的两个指令上）。

因此：

```
scope: {
   element: '&' // provides a way to execute an expression in the context of the parent scope.
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-09-24T10:25:34.200

@Mark Rajcok 请将以下行更改为

```
<div ng-controlle="TimelineControllerCtrl"> 
```

至

```
<div ng-controller="TimelineController"> 
```

# sql-server-2008 - 更改具有多页行的列的排序规则

> ID：14243019
> 
> 赞同：1
> 
> 时间：2013-01-09T17:31:05.743
> 
> 标签：sql-server-2008

我们正在更改数据库的排序规则。

我们遇到了一个问题，当我尝试更改其中一列（使用数据类型 varchar(max)）时，我收到以下错误：

```
Cannot create a row of size 8083 which is greater than the allowable maximum row size of 8060. 
```

如果我检查最大帖子的大小。

```
select top 1 LEN(Document) as l1,* from GroupDocument where LEN(document) > 8000 order by LEN(document) desc 
```

我得到的尺寸为 39431，大约 10 页。

我认为这是我无法更改排序规则的问题。我之前在其他专栏中没有遇到过这个问题。任何帮助，将不胜感激。

我想一种解决方案是将表的所有内容复制到另一个表，更改排序规则，然后再次将其移回。但如果可能的话，我宁愿不这样做。

编辑：

尝试了以下方法：

创建表 temptable (id int, document nvarchar(max))

插入到 temptable (id, document) 中选择 GroupDocumentID, Document from GroupDocument

alter table GroupDocument drop column Document alter table temptable alter column document nvarchar(max) ALTER TABLE [GroupDocument] add [Document] ntext COLLATE Finnish_Swedish_CI_AS NULL

update GroupDocument set Document = (select temptable.document from temptable where temptable.id = GroupDocument.GroupDocumentID)

还是同样的问题。

导致问题的行有一个 7996 字节的 varchar，+ 一些整数使它成为我猜的边界情况。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-10T13:41:53.420

我结合了强制较大的值超出行列。

EXEC sp_tableoption 'dbo.GroupDocument', '行外的大值类型', 1

清洁桌子。

dbcc cleantable('ExamDoc', 'groupdocument', 0)

最后删除并重建表的索引。

解决了问题！:D

# ios - 按下删除时 uitextfield 清除

> ID：14243027
> 
> 赞同：9
> 
> 时间：2013-01-09T17:31:20.703
> 
> 标签：ios, uikit

我有一个问题，按下键盘上的删除键会清除整个 UITextField，就好像我按下了清除按钮一样。它只会在您第一次按下该屏幕上的删除键时发生。我已经检查了“编辑开始时清除”没有被选中，这不是一个安全的输入文本字段。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-07-25T20:25:10.363

如果 UITextField 的键盘类型是 UIKeyboardTypeEmailAddress，它看起来就是这种行为。当我将它切换到另一种类型时，退格键没有这种行为。不知道该怎么做。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-11-14T06:15:30.423

可能正在将返回类型更改为默认工作。我有同样的问题，但改变键盘 returnTextField.returnKeyType = UIReturnKeyDone; 解决了我的问题，希望对您有所帮助。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-08-10T18:29:50.227

在 IB 中，您必须显示清除按钮（X）（这样他们可以根据需要将其清除）。我选择了“编辑时出现”，所以它会在他们开始输入时出现。

# excel - 复制并存储到剪贴板

> ID：14243028
> 
> 赞同：0
> 
> 时间：2013-01-09T17:31:22.560
> 
> 标签：excel, vba

我会使用 AHK 将我的文本从 excel 复制并存储到剪贴板。

这是我的代码：

```
Xl.Range("A1").Copy
Xl.Range("A2").Copy
Xl.Range("A3").Copy
Xl.Range("A4").Copy 
```

如何将 A1-A4 存储到剪贴板？然后我可以手动粘贴剪贴板。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-09T18:09:56.467

```
Dim wsSource As Worksheet, wsDest As Worksheet
Dim rngSource As Range, rngDest As Range
Set wsSource = ActiveSheet 'or whatever
Set wsDest = wsSource ' or whatever
Set rngSource = wsSource.Range("A1:A4")
Set rngDest = wsDest.Range("C1")
rngSource.Copy rngDest 
```

除非您真的希望它在剪贴板上供用户粘贴到他们可能选择的任何位置，否则您将最后一行更改为`rngSource.Copy`

# c# - 如何确保我的 C#.net “webservice” 始终在共享主机中运行

> ID：14243031
> 
> 赞同：0
> 
> 时间：2013-01-09T17:31:34.220
> 
> 标签：c#, web-services, asmx

我有 ac#.net wpf 应用程序，它每天将数据发送到 web 服务。我计划在共享主机上托管我的网络服务。

我的问题是如何确保我的网络服务始终正常运行？即如果我的网络服务器关闭了几天，我应该注意什么？如果一台服务器出现故障，我是否需要维护多台服务器？为了实现这一点，我是否需要在 wpf windows 应用程序中提及两个服务器的 IP 地址？

我搜索了谷歌，但找不到正确的答案。来自社区的任何链接将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-09T18:08:07.127

我有两个建议： 1.调用Web服务方法的方法并异常处理。2\. 从部分获取动态 URL `<applicationSettings>`，然后执行 httprequest 以检查 url 是否有效

解决方案1示例：

```
[WebMethod]
public DateTime GetCurrentServerTime()
{
     return System.DateTime.UtcNow.ToString("yyyyMMddZHHmmss");
} 
```

在你的应用程序中：

```
catch (System.Net.WebException ex)
{

messgabebox.show( "Your Web Service not available");
} 
```

它会导致大约 10 秒的响应时间....

解决方案 2 示例：

```
HttpWebRequest objRequest = (System.Net.HttpWebRequest)HttpWebRequest.Create(strWebServiceUrl);
HttpWebResponse myHttpWebResponse = (HttpWebResponse)objRequest.GetResponse();

if (myHttpWebResponse.StatusCode != HttpStatusCode.OK)
{

DisplayMessage("Your Web Service not available" + "\r" + "Please try after some time");

return;
} 
```

我认为这是检查网络服务可用性的更好方法..

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-09T17:52:47.470

你在谷歌上没有找到答案的原因是没有正确的答案。每个人都根据其应用程序的需求以不同的方式处理这些问题。为了回答你的一些问题，我真的只能提供一般性的建议，即使这些只是我解决这个问题的方法：

> 我的问题是如何确保我的网络服务始终正常运行？

最大化正常运行时间很重要，并且可能需要仔细设计。您需要优雅地处理错误条件并能够处理向您抛出的任何输入。对此的一个警告是，虽然正常运行时间很重要，但数据的准确性可能更重要。如果是这种情况，最好让您的 Web 服务关闭，而不是看似已启动，但它会破坏数据。

> 如果我的网络服务器关闭了几天，我需要注意什么？

您需要以这样一种方式对您的客户端应用程序进行编码，以便它可以正确地将数据排队并在服务备份时发送。此外，您需要在您的服务聪明（即不假设上传数据== 数据日期）。不要忘记客户端应用程序也可能一次关闭数天（自然灾害、停电、维护停机、周末崩溃……）

> 如果一台服务器出现故障，我是否需要维护多台服务器？

为了实现这一点，我需要在 wpf windows 应用程序中提及两个服务器的 IP 地址吗？

这绝对是一个选择。冗余可以让您对服务器执行维护或升级，同时最大限度地减少停机时间。有很多方法可以解决这个问题。我可能会使用多个 FQDN。所以我会拥有`server1.example.com`并且`server2.example.com`每个都指向不同的服务器（最好是在不同的数据中心）。我也会让这些服务器的 DNS 条目的 TTL 非常低，因此如果它们开始出现故障，我可以将服务器换成新的 IP。

然后在您的客户端应用程序中，您可以在两台服务器之间进行循环，也可以拥有一台主服务器，而另一台仅用作备份。

说了这么多，很多人在设置这样的东西时忘记的一点是测试。您需要测试一台服务器宕机、两台服务器宕机、切换 DNS 以及您能想到的任何其他排列，以确保您的冗余解决方案有效、可扩展且不会导致其他问题。

# c# - 具有子统一容器的作用域区域

> ID：14243033
> 
> 赞同：4
> 
> 时间：2013-01-09T17:31:43.143
> 
> 标签：c#, .net, wpf, prism, unity-container

我正在使用带有 Unity 的 Prism for WPF - 我们的应用程序创建多个子视图（当用户“打开”一个项目时），这些子视图又包含其他区域，其视图是使用视图发现创建的，即

```
// The various views used in the child are registered using 
// RegisterViewWithRegion in the module that implements that view
public void Initialize()
{
    regionManager.RegisterViewWithRegion("ItemNavigation", typeof(ItemNavigationView));
    regionManager.RegisterViewWithRegion("ItemContent", typeof(ItemContentView));
} 
```

由于我们创建了多个这样的子视图，因此每个子视图都必须使用其自己的作用域区域管理器创建（我们决定不使用多个 shell，因为它看起来过于复杂），但是我们也希望每个子视图都有自己的[子统一容器](http://msdn.microsoft.com/en-us/library/ff660895%28v=pandp.20%29.aspx)这样我们就可以注入特定于项目的依赖项。

这就是我们创建子视图的方式

```
var childContainer = container.CreateChildContainer();
childContainer.RegisterInstance(...);

var childView = childContainer.Resolve<ChildItemView>();
region.Add(childView, viewName, createRegionManagerScope: true); 
```

尽管子统一容器用于正确解析 的依赖关系`ChildItemView`，但在创建嵌套视图时（`ItemNavigationView`并且`ItemContentView`）使用父容器代替，因此某些依赖关系无法解析。

如何将我的子统一容器与范围区域相关联，以便在解决该区域内创建的视图的依赖关系时使用正确的统一容器？

# mysql - MySQL 可选约束

> ID：14243038
> 
> 赞同：1
> 
> 时间：2013-01-09T17:32:03.190
> 
> 标签：mysql, sql, constraints

我有一个如下所述的数据库表。碰巧它支持具有多种形式的 Java EE 鉴别器实体，但我认为这对这个问题并不重要，我提供的信息是为了完整性。

表中的行可以采用多种形式，哪些字段允许为空，哪些必须为非空，由“类型”列的值定义。在这种情况下，例如，当`type = 'sail'`and`eShip`列`ePort`应该是非 null 并且`eShip`, `ePort`&`eDate`应该是唯一的。

有没有办法编写约束来支持这一点？我真正追求的是唯一性约束`eShip`, `ePort`&`eDate`当 `t​​ype = 'sail' 但不介意它们是多行并且当 'type' 是其他值时它们都为空？

这样做的另一种方法是将表分成两个，一个包含公共列的表，一个用于“帆”特定内容的表。但如果可以的话，我想避免这种情况，因为当我手动搜索数据库时，它使数据库选择更容易编写。

非常感谢您提供的任何建议或帮助。

```
mysql> desc vLegs;
+---------+--------------+------+-----+---------+----------------+
| Field   | Type         | Null | Key | Default | Extra          |
+---------+--------------+------+-----+---------+----------------+
| type    | varchar(10)  | NO   |     | NULL    |                | 
| id      | mediumint(9) | NO   | PRI | NULL    | auto_increment | 
| end     | datetime     | YES  |     | NULL    |                | 
| start   | datetime     | NO   |     | NULL    |                | 
| flight  | varchar(255) | YES  |     | NULL    |                | 
| oprtv   | mediumint(9) | NO   | MUL | NULL    |                | 
| dDate   | date         | YES  | MUL | NULL    |                | 
| dPort   | varchar(5)   | YES  |     | NULL    |                | 
| dShip   | varchar(10)  | YES  |     | NULL    |                | 
| eDate   | date         | YES  | MUL | NULL    |                | 
| ePort   | varchar(5)   | YES  |     | NULL    |                | 
| eShip   | varchar(10)  | YES  |     | NULL    |                | 
| landing | varchar(5)   | YES  | MUL | NULL    |                | 
| takeoff | varchar(5)   | YES  | MUL | NULL    |                | 
+---------+--------------+------+-----+---------+----------------+ 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-09T17:57:25.823

根据您对要求的描述，我建议您为每种类型创建一个表。我对 mysql 的了解还不够，无法确定您尝试做的事情是否可以通过约束来实现。即使有可能，听起来也难以理解和维护。

当您必须手动编写 SQL 时，也许视图会对用例有所帮助。

# java - 禁用自动调整大小，而不禁用手动调整大小

> ID：14243039
> 
> 赞同：1
> 
> 时间：2013-01-09T17:32:03.453
> 
> 标签：java, user-interface, javafx-2

在 Java 项目中编写 GUI 我遇到了 JavaFX 的问题。我没有为我的具体问题找到任何解决方案，所以我在这里:)

是否可以让用户调整 JavaFX 场景的大小，同时不通过比窗口更大的子节点调整它的大小？

这是一些示例代码：

```
@Override
public void startGUI(int width, int height) {
    this.main = new MainWindow(this, this.logic);
    this.scene = new Scene(this.main.getRoot());
    this.main.setScene(this.scene);
    this.primaryStage.setScene(this.scene);
    this.primaryStage.setMinHeight(height);
    this.primaryStage.setMinWidth(width);
} 
```

'MainWindow' 有一个子节点，它可能非常大（>1024x768）。我希望该节点不调整窗口大小，但同时，用户应该能够通过拖动其边框来调整窗口大小。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-09T18:10:59.547

使用[指定初始大小约束的场景构造函数](http://docs.oracle.com/javafx/2/api/javafx/scene/Scene.html#Scene%28javafx.scene.Parent,%20double,%20double%29)。

例如：

```
Scene scene = new Scene(root, 600, 400); 
```

这样，场景的初始大小将从这些约束中获取，而不是根据根节点的首选大小来计算。

# ios - 用 Chipmunk 物理创建一个圆，但半径太大？

> ID：14243044
> 
> 赞同：0
> 
> 时间：2013-01-09T17:32:18.337
> 
> 标签：ios, objective-c, xcode, physics, chipmunk

我正在尝试创建一个圆形主体/形状并将其连接到 UIImage，这是一个具有透明背景的 .png，只是一个简单的圆形，大小为 60 x 60px。

我正在使用下面的代码来做，它工作正常，除了圆形图像周围似乎有一个不可见的较大区域（即圆形图像的侧面不能接触其他物体，如圆形体/形状更大。我不知道为什么会这样，因为我在半径等的所有测量中都使用了 60px。代码如下，知道有什么问题吗？

```
- (void) createCircleAtLocation: (CGPoint) location
{
    _button1 = [[UIButton alloc] init];
    _button1 = [UIButton buttonWithType: UIButtonTypeCustom];
    [_button1 setImage: [UIImage imageNamed: @"ball.png"] forState: UIControlStateNormal];
    _button1.bounds = CGRectMake(location.x, location.y, 60, 60);
    [self.view addSubview: _button1];

    float mass = 1.0;
    body1 = cpBodyNew(mass, cpMomentForCircle(mass, 60.0, 0.0, cpvzero));
    body1 -> p = location; // Center of gravity for the body
    cpSpaceAddBody(space, body1); // Add body to space

    cpShape *shape = cpCircleShapeNew(body1, 60.0, cpvzero);
    shape -> e = 0.8; // Set its elasticity
    shape -> u = 1.0; // And its friction
    cpSpaceAddShape(space, shape); // And add it.
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-09T17:40:23.837

在这种情况下，“不可见区域”是形状。形状由其半径定义。如果你有一个 60x60 的图像，半径是 30 而不是 60。用新的半径更新形状和主体，它应该可以正常工作：

```
- (void) createCircleAtLocation: (CGPoint) location
{
    _button1 = [[UIButton alloc] init];
    _button1 = [UIButton buttonWithType: UIButtonTypeCustom];
    [_button1 setImage: [UIImage imageNamed: @"ball.png"] forState: UIControlStateNormal];
    _button1.bounds = CGRectMake(location.x, location.y, 60, 60);
    [self.view addSubview: _button1];

    float mass = 1.0;
    body1 = cpBodyNew(mass, cpMomentForCircle(mass, 30.0, 0.0, cpvzero));
    body1 -> p = location; // Center of gravity for the body
    cpSpaceAddBody(space, body1); // Add body to space

    cpShape *shape = cpCircleShapeNew(body1, 30.0, cpvzero);
    shape -> e = 0.8; // Set its elasticity
    shape -> u = 1.0; // And its friction
    cpSpaceAddShape(space, shape); // And add it. 
```

}

# google-chrome - 检查 Mountain Lion 上 chrome 浏览器的现有 cookie

> ID：14243045
> 
> 赞同：-2
> 
> 时间：2013-01-09T17:32:21.470
> 
> 标签：google-chrome, cookies, osx-mountain-lion

我想检查我的 Mac Mountain Lion OSX 10.8.2 上现有 cookie 的值是多少？我相信 Windows 上有一个 cookies 文件夹。我应该在 Mac 上哪里寻找类似的东西？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-09T17:38:12.463

哦，我已经搜索过山狮所以找不到它但是当刚刚搜索 chrome 时，找到了这个 [Google Chrome Cookie Storage](https://stackoverflow.com/questions/4528208/google-chrome-cookie-storage)

它为mac回答了它。

# deployment - airbrake:heroku:add_deploy_notification 与多个应用程序

> ID：14243056
> 
> 赞同：0
> 
> 时间：2013-01-09T17:33:07.930
> 
> 标签：deployment, heroku, airbrake

当您有多个 Heroku 应用程序（即 git 远程）时，尝试在 Heroku 部署上[设置 Airbrake 的部署通知将产生：](https://devcenter.heroku.com/articles/airbrake#set-up-deploy-notification)`rake airbrake:heroku:add_deploy_notification`

```
 !    Multiple apps in folder and no app specified.
 !    Specify app with --app APP. 
```

~~Airbrake似乎[意识到了这一点，](http://help.airbrake.io/discussions/hoptoad-notifier-patches-and-discussion/72-rake-task-for-heroku-deploy-hook-with-multiple-apps)但没有提供*真正的*解决方案。~~

有解决办法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-09T17:33:07.930

在运行之前，`rake airbrake:heroku:add_deploy_notification`您可以通过将 a 设置为所需的分支来[设置默认的 Heroku 远程。](https://devcenter.heroku.com/articles/multiple-environments#starting-from-scratch)`git config heroku.remote`

例如，要设置 Heroku 遥控器为`staging`和的应用程序`production`，您可以：

```
$ git config heroku.remote staging
$ rake airbrake:heroku:add_deploy_notification

$ git config heroku.remote production
$ rake airbrake:heroku:add_deploy_notification

$ git config --unset heroku.remote 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-20T22:47:21.567

[现在已经为此推送了一个修复程序](https://github.com/airbrake/airbrake/commit/f616190c318ddf36c011f51e60f431528d9d601c)。

您可以将环境变量设置`HEROKU_APP`为应用程序的名称。

# objective-c - NSManagedObject 的 NSNumber 属性的 NSPredicate

> ID：14243057
> 
> 赞同：7
> 
> 时间：2013-01-09T17:33:09.460
> 
> 标签：objective-c, core-data, ios6, nspredicate

我有`NSNumber * year`的属性`NSManagedObject`，它在数据模型中的类型是`Integer 16`。

我试着检查`NSPredicate`今年的，但找不到合适的。

我尝试了什么：

```
NSPredicate *p = nil;
NSNumberFormatter *nf = [[NSNumberFormatter alloc] init];
NSNumber *yearNo = [nf numberFromString:term];
if (yearNo) {
    p = [NSPredicate predicateWithFormat:@"(cars.year == %i)", yearNo.intValue];
} 
```

我也试过：

```
NSPredicate *p = nil;
NSNumberFormatter *nf = [[NSNumberFormatter alloc] init];
NSNumber *yearNo = [nf numberFromString:term];
if (yearNo) {
    p = [NSPredicate predicateWithFormat:@"(cars.year == %@)", yearNo];
} 
```

在这两种情况下，应用程序都会崩溃。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-01-09T17:51:58.920

如果您为您的模型提供更多详细信息，我们可以为您提供帮助。

但我认为问题是由于`cars`. If `cars`is to-many 你需要一个修饰符

```
[NSPredicate predicateWithFormat:@"ANY cars.year == %@", yearNo]; 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2013-01-09T18:01:06.513

正如@flexaddicted 已经说过的那样，您没有提供足够的信息，例如为哪个实体发出了获取请求。

如果你想获取`Car`一个给定`year`的对象，谓词就是

```
[NSPredicate predicateWithFormat:@"year == %@", yearNo] 
```

# python - 复杂排序 - 多键

> ID：14243060
> 
> 赞同：0
> 
> 时间：2013-01-09T17:33:14.927
> 
> 标签：python

我正在使用 Python 2.6.2。我有一个字典，`graph`它以元组（源，目标）作为键，并以一定的权重作为其值。

想`graph`根据来源按重量降序排序。在具有不同目的地的图元组中可能有多个相同的源。

```
graph= {(2, 18): 0, (5, 13): 2, (0, 10): 2, (0, 36): 1, (3, 14): 2, (5, 23): 2, (0, 24): 1, (4, 32): 7, (2, 29): 0, (3, 27): 2, (0, 33): 2, (5, 42): 2, (5, 11): 2, (5, 39): 3, (3, 9): 8, (0, 41): 4, (5, 16): 5, (4, 17): 7, (4, 44): 7, (0, 31): 2, (5, 35): 5, (4, 30): 7} 
```

创建了一个中间字典，`source_dict`它以源为键，基于源的累积权重为其值，{source:weight}

```
source_dict={0: 12, 2: 0, 3: 12, 4: 28, 5: 21} 
```

执行如下排序功能后，

```
source_desc_sort=sorted(source_dict.items(), key=lambda x: x[1], reverse=True)
sortkeys = dict((x[0], index) for index,x in enumerate(source_desc_sort))
graph_sort = sorted(graph.iteritems(), key=lambda x: sortkeys[x[0][0]]) 
```

我得到一个排序图，`graph_sort`如下所示，

```
graph_sort= [((4, 17), 7), ((4, 44), 7), ((4, 30), 7), ((4, 32), 7), ((5, 23), 2), ((5, 35), 5), ((5, 13), 2), ((5, 42), 2), ((5, 11), 2), ((5, 39), 3), ((5, 16), 5), ((0, 10), 2), ((0, 36), 1), ((0, 24), 1), ((0, 33), 2), ((0, 41), 4), ((0, 31), 2), ((3, 14), 2), ((3, 27), 2), ((3, 9), 8), ((2, 29), 0), ((2, 18), 0)] 
```

如果您注意`graph_sort`同一源的键顺序并不重要，例如对于以 5 作为源的元组， ((5, 23), 2) 可以在 ((5, 35), 5) 之前或之后价值低于另一个。

现在这是我从 2 天前开始尝试解决的挑战，

已重新定义`source_dict`为`source_dict_angle`以角度作为附加信息，{source:{angle:weight}}

```
source_dict_angle={0: {0: 2, 90: 4, 180: 6}, 2: {0: 0, 270: 0}, 3: {180: 4, 270: 8}, 4: {0: 7, 180: 21}, 5: {0: 6, 90: 10, 180: 2, 270: 3}} 
```

我喜欢进行与上述相同的排序，但基于来源角度。例如，以 4 作为源且目标在角度 180 的元组必须首先开始，因为它具有最高值，即 21。其次是以 5 作为源和目标在角度 90 的元组，依此类推。

有中间字典，`relation_graph`其中有目的地相对于源的位置信息，{source:{angle:destination:value}}

```
relation_graph={0: {0: {32: [1], 36: [1], 23: [1], 24: [1], 16: [1]}, 90: {3: [1], 41: [1], 44: [1]}, 180: {33: [1], 10: [1], 31: [1]}}, 1: {}, 2: {0: {18: [1]}, 270: {29: [1]}}, 3: {180: {27: [1], 14: [1], 31: [1]}, 270: {0: [1], 33: [1], 36: [1], 9: [1], 1: [1], 24: [1], 41: [1], 10: [1]}}, 4: {0: {32: [1], 18: [1], 23: [1]}, 180: {0: [1], 33: [1], 44: [1], 14: [1], 15: [1], 17: [1], 21: [1], 41: [1], 27: [1], 30: [1], 31: [1]}}, 5: {0: {42: [1], 11: [1], 23: [1]}, 90: {7: [1], 8: [1], 16: [1], 35: [1]}, 180: {0: [1], 13: [1], 14: [1], 44: [1]}, 270: {1: [1], 2: [1], 39: [1], 29: [1]}}} 
```

预期结果

```
graph_sort_angle= [((4, 17), 7), ((4, 44), 7), ((4, 30), 7), ((5, 35), 5), ((5, 16), 5), ((3, 9), 8), ... 
```

我目前还找不到解决方案，我正在尝试重用我已经完成的解决方案，`graph_sort`但效果不佳。有感觉我必须以不同的方式来做。

有什么方法可以使用与我相同的方法`graph_sort`吗？

感谢您能给我一些指示。

到那时将继续努力。

**附加说明 2013 年 1 月 9 日晚上 9 点 30 分：Lennart Regebro**

我想`graph`根据来自的降序值对（元组）的键进行排序`source_dict_angle`。

`graph`由 (source, destination) 组成，但`source_dict_angle`只有源和角度信息，{source:{angle:weight}}。它没有目的地信息。我们将无法`graph`像在第一个示例中那样对元组进行排序。

给定（未计算）`relation_graph`，我们有源、角度和目的地信息，{source:{angle:destination:value}}。我们将使用这个字典来查看使用哪个角度（0 度、90 度、180 度或 270 度）的源对与哪个目的地。

所以我们会

1.  首先参考`source_dict_angle`知道哪个是最高值。在这个给定的示例中，角度为 180 度的源 4 具有最高值，即 21

2.  我们将 Source 4 的所有目的地与来自 的角度 180 进行比较`relation_graph`，即 [0, 33, 44, 14, 15, 17, 21, 41, 27, 30, 31] 如果它存在于 中`graph`。如果是，我们将 (Source, Destination) 元组排在第一位，即 (4, 17)。这也可以用另一种方式完成，因为我们必须对 Source 4 进行排序，我们检查 Source 4 in 的任何目的地是否`graph`存在于 Source 4 的角度 180 in`relation_graph`. 如果是，我们将 (Source, Destination) 元组排在第一位。由于相同的源可以使用相同的角度与多个目的地配对，因此我们可能有多个 (Source, Destination) 元组。例如 (4, 17)、(4, 44) 和 (4, 30)。这意味着，源 4 使用角度 180 连接到目标 17、目标 44 和目标 30，因此是 3 对元组。这 3 对元组之间的顺序不是问题。

3.  完成此操作后，我们将在执行上述步骤时转到下一个最高值，`source_dict_angle`直到所有源都按降序排序。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-09T17:50:35.463

跳过中间字典，没有必要。

要对源进行排序，您只需执行以下操作：

```
graph_sort = sorted(graph.iteritems(), key=lambda x: x[0][0]) 
```

对于你做的角度排序：

```
def angle(x):
   key, value = x
   source, destination = key
   return <insert angle calculation here>

graph_sort = sorted(graph.iteritems(), key=angle) 
```

更新：

您需要停止使用大量不同的字典来保存所有属于一起的不同数据。为保存所有信息的项目创建一个类。

根据我从您的问题中收集到的信息，您有一个图表项目字典，其中包含源、目标和权重。然后，您又有了另一本词典，它再次保留了怀特。然后你有第三个字典来保持角度。

而是这样做：

```
class Graph(object):
    def __init__(self, source, destination, weight, angle):
        self.source = source
        self.destination = destination
        self.weight = weight
        self.angle = angle 
```

您的排序问题现在很简单。

# android - android 2.1旋转导致崩溃

> ID：14243062
> 
> 赞同：1
> 
> 时间：2013-01-09T17:33:15.383
> 
> 标签：android

经过几个月的开发，我意识到我的应用程序（仅使用 android 2.1）在我旋转屏幕时崩溃。我不知道如何调查这个错误。应该是什么原因？感谢您的建议。这个“警告”会导致错误吗？已在 com.example.app 中恢复时意外恢复 com.example.app

```
SharedPreferences prefs3 = PreferenceManager.getDefaultSharedPreferences(this);
      listener = new SharedPreferences.OnSharedPreferenceChangeListener() {
          public void onSharedPreferenceChanged(SharedPreferences prefs, String listpref) {       
                preferenze();

E/AndroidRuntime( 1269): java.lang.StackOverflowError
E/AndroidRuntime( 1269):    at java.util.HashMap.doubleCapacity(HashMap.java:561)
E/AndroidRuntime( 1269):    at java.util.HashMap.put(HashMap.java:391)
E/AndroidRuntime( 1269):    at java.util.HashSet.add(HashSet.java:95)
E/AndroidRuntime( 1269):    at java.nio.charset.Charset.<init>(Charset.java:189)
E/AndroidRuntime( 1269):    at com.ibm.icu4jni.charset.CharsetICU.<init>(CharsetICU.java:33)
E/AndroidRuntime( 1269):    at com.ibm.icu4jni.charset.CharsetProviderICU.getCharset(CharsetProviderICU.java:62)
E/AndroidRuntime( 1269):    at com.ibm.icu4jni.charset.CharsetProviderICU.charsetForName(CharsetProviderICU.java:57)
E/AndroidRuntime( 1269):    at java.nio.charset.Charset.forNameInternal(Charset.java:500)
E/AndroidRuntime( 1269):    at java.nio.charset.Charset.forName(Charset.java:570)
E/AndroidRuntime( 1269):    at com.android.internal.util.FastXmlSerializer.setOutput(FastXmlSerializer.java:292)
E/AndroidRuntime( 1269):    at com.android.internal.util.XmlUtils.writeMapXml(XmlUtils.java:180)
E/AndroidRuntime( 1269):    at android.app.ApplicationContext$SharedPreferencesImpl.writeFileLocked(ApplicationContext.java:2757)
E/AndroidRuntime( 1269):    at android.app.ApplicationContext$SharedPreferencesImpl.access$800(ApplicationContext.java:2510)
E/AndroidRuntime( 1269):    at android.app.ApplicationContext$SharedPreferencesImpl$EditorImpl.commit(ApplicationContext.java:2695)
E/AndroidRuntime( 1269):    at com.example.app.MainActivity.preferenze(MainActivity.java:3656)
E/AndroidRuntime( 1269):    at com.example.app.MainActivity.access$0(MainActivity.java:3632)
E/AndroidRuntime( 1269):    at com.example.app.MainActivity$1.onSharedPreferenceChanged(MainActivity.java:2421)
E/AndroidRuntime( 1269):    at android.app.ApplicationContext$SharedPreferencesImpl$EditorImpl.commit(ApplicationContext.java:2703)
E/AndroidRuntime( 1269):    at com.example.app.MainActivity.preferenze(MainActivity.java:3732)
E/AndroidRuntime( 1269):    at com.example.app.MainActivity.access$0(MainActivity.java:3632)
E/AndroidRuntime( 1269):    at com.example.app.MainActivity$1.onSharedPreferenceChanged(MainActivity.java:2421)
E/AndroidRuntime( 1269):    at android.app.ApplicationContext$SharedPreferencesImpl$EditorImpl.commit(ApplicationContext.java:2703)
E/AndroidRuntime( 1269):    at com.example.app.MainActivity.preferenze(MainActivity.java:3732)
E/AndroidRuntime( 1269):    at com.example.app.MainActivity.access$0(MainActivity.java:3632)
E/AndroidRuntime( 1269):    at com.example.app.MainActivity$1.onSharedPreferenceChanged(MainActivity.java:2421)
E/AndroidRuntime( 1269):    at android.app.ApplicationContext$SharedPreferencesImpl$EditorImpl.commit(ApplicationContext.java:2703)
E/AndroidRuntime( 1269):    at com.example.app.MainActivity.preferenze(MainActivity.java:3732)
E/AndroidRuntime( 1269):    at com.example.app.MainActivity.access$0(MainActivity.java:3632)
E/AndroidRuntime( 1269):    at com.example.app.MainActivity$1.onSharedPreferenceChanged(MainActivity.java:2421)
E/AndroidRuntime( 1269):    at android.app.ApplicationContext$SharedPreferencesImpl$EditorImpl.commit(ApplicationContext.java:2703)
E/AndroidRuntime( 1269):    at com.example.app.MainActivity.preferenze(MainActivity.java:3732)
E/AndroidRuntime( 1269):    at com.example.app.MainActivity.access$0(MainActivity.java:3632)
E/AndroidRuntime( 1269):    at com.example.app.MainActivity$1.onSharedPreferenceChanged(MainActivity.java:2421)
E/AndroidRuntime( 1269):    at android.app.ApplicationContext$SharedPreferencesImpl$EditorImpl.commit(ApplicationContext.java:2703)
E/AndroidRuntime( 1269):    at com.example.app.MainActivity.preferenze(MainActivity.java:3732)
E/AndroidRuntime( 1269):    at com.example.app.MainActivity.access$0(MainActivity.java:3632)
E/AndroidRuntime( 1269):    at com.example.app.MainActivity$1.onSharedPreferenceChanged(MainActivity.java:2421)
E/AndroidRuntime( 1269):    at android.app.ApplicationContext$SharedPreferencesImpl$EditorImpl.commit(ApplicationContext.java:2703)
E/AndroidRuntime( 1269):    at com.example.app.MainActivity.preferenze(MainActivity.java:3732)
E/AndroidRuntime( 1269):    at com.example.app.MainActivity.access$0(MainActivity.java:3632)
E/AndroidRuntime( 1269):    at com.example.app.MainActivity$1.onSharedPreferenceChanged(MainActivity.java:2421)
E/AndroidRuntime( 1269):    at android.app.ApplicationContext$SharedPreferencesImpl$EditorImpl.commit(ApplicationContext.java:2703)
E/AndroidRuntime( 1269):    at com.example.app.MainActivity.preferenze(MainActivity.java:3732)
E/AndroidRuntime( 1269):    at com.example.app.MainActivity.access$0(MainActivity.java:3632)
E/AndroidRuntime( 1269):    at com.example.app.MainActivity$1.onSharedPreferenceChanged(MainActivity.java:2421)
E/AndroidRuntime( 1269):    at android.app.ApplicationContext$SharedPreferencesImpl$EditorImpl.commit(ApplicationContext.java:2703)
E/AndroidRuntime( 1269):    at com.example.app.MainActivity.preferenze(MainActivity.java:3732)
E/AndroidRuntime( 1269):    a 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-09T17:40:18.503

问题出`preferenze`在 MainActivity.java 中的例程中。

需要查看更多代码才能确定，但​​看起来你有一个由修改你的`Preferences`内部`onSharedPreferenceChanged`回调引起的无限递归。如果您在回调中编辑您的首选项，则再次调用回调，然后再次编辑，再次调用回调，等等。

# css - jsp函数标签替换'

> ID：14243065
> 
> 赞同：0
> 
> 时间：2013-01-09T17:33:24.887
> 
> 标签：css, spring, jsp, include

这是我的代码，

**css/index.jsp：**

```
<%@include file="/WEB-INF/common/css/common.jsp" %>
<style type="text/css">
    body{background: #ffffff url('<c:url value='/resources/images/logo/logo_small.png'/>') no-repeat scroll center center}
</style> 
```

**index.jsp 页面调用上面的 css/index.jsp 页面：**

```
<c:set var="my_css">
    <c:if test="${branch == 'sitemap'}">
        <c:if test="${page == 'index'}">
            <%@include file="/WEB-INF/common/css/sitemap_common.jsp" %>
            <%@include file="/WEB-INF/common/css/index.jsp" %>
        </c:if>
    </c:if>
</c:set>
<c:set var="css" value='${fn:replace(fn:replace(fn:replace(my_css,"<style type=\\\"text/css\\\">", ""),"</style>", ""),"\'", "99999")}'/>
<compress:css enabled="true">
    <c:out value='${css}'/>
</compress:css> 
```

在我的项目中，有 100 个返回 css 代码的 jsp 页面。我这样做的原因是将我的 css 作为链接标签放在 head 部分。

在我的代码中 ' 被替换为 99999，但是当我将 99999 更改为 & #.. ; 返回&#..; 如何更换？

如果有更好的选择将我的 jsp 转换为 html head 部分中的 css 链接，请在此处发布。你也请发表你的建议。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-09T19:59:23.640

> 现在我需要修改以获得更好的性能

在将 css 上传到服务器之前，使用一些工具或者甚至使用一些简单的 java 程序来修改 css。然后：

*   你不需要花时间解决这个问题
*   性能要好得多（在运行时每个请求都不需要任何替换东西）

# mysql - Mysql存储过程调用错误

> ID：14243070
> 
> 赞同：0
> 
> 时间：2013-01-09T17:33:41.933
> 
> 标签：mysql, stored-procedures

我有一个引发错误的存储过程。

这是电话：

CALLcampaign_strat_placement_test ('10541','2013-1-1','2013-1-7',2,0, **2** ,0,0,32)

我已将导致错误的部分加粗，因为如果我将该选项更改为 0 或 1，程序就会运行。

这是整个过程：

```
 DELIMITER $$

    USE `reporting`$$

    DROP PROCEDURE IF EXISTS `campaign_strat_placement_test`$$

    CREATE DEFINER=`username`@`%` PROCEDURE `campaign_strat_placement_test`(strat_id VARCHAR(255),rpt_start_date DATE, rpt_end_date DATE,mrt_opt INT, mrt_rev_opt INT, mro_opt INT, mro_rev_opt INT, media_cost_opt INT, metrics_opt INT)
COMMENT 'returns client report'
    BEGIN
SELECT report_title FROM reporting.campaign_meta_cron_daily WHERE strategy_id = strat_id;
SELECT CONCAT('Data Updated Through ',DATE_FORMAT(ADDDATE(CURDATE(),-1),'%M %d, %Y'));    

SET @report_code:=CONCAT('
    select date(date) as `Date`
    , placement_id
    , placement_name
    , strategy_name as strategy
    , concept
    , size
    , exchange
    , targeting_strat
    , ifnull(IMPS_3P,0) as Imps
    , ifnull(CLICKS_3P,0) as Clicks
    ',CASE WHEN mrt_opt = 1 THEN
        ' ,ifnull(MRT_PC_3P,0) as MRT_PC'
        WHEN mrt_opt = 2 THEN 
        ' ,ifnull(MRT_PC_3P,0) as MRT_PC
        ,ifnull(MRT_PV_3P*goal1_pv_discount,0) as MRT_PV'
        WHEN mrt_opt = 3 THEN 
        ' ,ifnull(MRT_PC_3P+(MRT_PV_3P*goal1_pv_discount),0) as MRT_Tot'
        ELSE '' END
    ,CASE WHEN mrt_rev_opt = 1 THEN
        ' ,ifnull(round(sum(MRT_PC_REV_3P),2),0) as MRT_PC_Rev'
        WHEN mrt_rev_opt = 2 THEN 
        ' ,ifnull(MRT_PC_REV_3P,0) as MRT_PC_Rev
        ,ifnull(MRT_PV_REV_3P*goal1_pv_discount,0) as MRT_PV_Rev'
        WHEN mrt_rev_opt = 3 THEN 
        ' ,ifnull(MRT_PC_REV_3P+(MRT_PV_REV_3P*goal1_pv_discount),0) as MRT_Rev'
        ELSE '' END
    ,CASE WHEN mro_opt = 1 THEN
        ' ,ifnull(MRO_PC_3P,0) as MRO_PC'
        WHEN mro_opt = 2 THEN 
        ' ,ifnull(MRO_PC_3P,0) as MRO_PC
        ,ifnull(MRO_PV_3P*goal1_pv_discount,0) as MRO_PV'
        WHEN mro_opt = 3 THEN 
        ' ,ifnull((MRO_PC_3P+(MRO_PV_3P*goal1_pv_discount)),0) as MRO_Tot'
        ELSE '' END
    ,CASE WHEN mro_rev_opt = 1 THEN
        ' ,ifnull(round(MRO_PC_REV_3P,2),0) as MRO_PC_Rev'
        WHEN mro_rev_opt = 2 THEN 
        ' ,ifnull(round(MRO_PC_REV_3P,2),0) as MRO_PC_Rev
        ,ifnull(round(MRO_PV_REV_3P,2),0) as MRO_PV_Rev'
        WHEN mro_rev_opt = 3 THEN 
        ' ,ifnull(round(MRO_PC_REV_3P+sum(MRO_PV_REV_3P*goal1_pv_discount),2),0) as MRO_Rev'
        ELSE '' END
    ,CASE WHEN media_cost_opt = 1 THEN
        ' ,ifnull(round(gross_media_cost,2),0) as Media_Cost'
        WHEN media_cost_opt = 2 THEN 
        ' ,ifnull(round(net_media_cost,2),0) as Net_Media_Cost
         ,ifnull(round(gross_media_cost,2),0) as Gross_Media_Cost'
        ELSE ' ,ifnull(round(net_media_cost,2),0) as Media_Cost' END
    ,CASE WHEN metrics_opt%2 >= 1 THEN 
        ' ,round(ifnull(CLICKS_3P/IMPS_3P,0),4) as CTR' ELSE '' END
    ,CASE WHEN metrics_opt%4 >= 2 THEN 
        ' ,round(ifnull((MRT_PC_3P+(sum(MRT_PV_3P)*goal1_pv_discount))/IMPS_3P*1000,0),4) as RR_per_M' ELSE '' END
    ,CASE WHEN metrics_opt%8 >= 4 THEN 
        ' ,round(ifnull((net_media_cost/IMPS_3P)*1000,0),2) as Net_CPM' ELSE '' END
    ,CASE WHEN metrics_opt%16 >= 8 THEN 
        ' ,round(ifnull(net_media_cost/CLICKS_3P,0),2) as Net_CPC' ELSE '' END
    ,CASE WHEN metrics_opt%32 >= 16 THEN 
        ' ,round(ifnull(net_media_cost/(MRT_PC_3P+(MRT_PV_3P*goal1_pv_discount)),0),2) as Net_CPA' ELSE '' END
    ,CASE WHEN metrics_opt%64 >= 32 THEN 
        ' ,round(ifnull((gross_media_cost/IMPS_3P)*1000,0),2) as Gross_CPM' ELSE '' END
    ,CASE WHEN metrics_opt%128 >= 64 THEN 
        ' ,round(ifnull(gross_media_cost/CLICKS_3P,0),2) as Gross_CPC' ELSE '' END
    ,CASE WHEN metrics_opt%256 >= 128 THEN 
        ' ,round(ifnull(gross_media_cost/(MRT_PC_3P+(MRT_PV_3P*goal1_pv_discount)),0),2) as Gross_CPA' ELSE '' END
    ,CASE WHEN metrics_opt%512 >= 256 THEN 
        ' ,round(ifnull(((MRT_PC_REV_3P+(MRT_PV_REV_3P*goal1_pv_discount))/net_media_cost)-1,0),2) as Net_ROI' ELSE '' END
    ,CASE WHEN metrics_opt%1024 >= 512 THEN 
        ' ,round(ifnull(((MRT_PC_REV_3P+(MRT_PV_REV_3P*goal1_pv_discount))/gross_media_cost)-1,0),2) as Gross_ROI' ELSE '' END
    ,CASE WHEN metrics_opt%2048 >= 1024 THEN 
        ' ,round(ifnull(net_media_cost/(MRT_PC_3P+(MRT_PV_3P*goal1_pv_discount)),0),2) as Alt_Net_CPA' ELSE '' END
    ,CASE WHEN metrics_opt%4096 >= 2048 THEN 
        ' ,round(ifnull(gross_media_cost/(MRT_PC_3P+(MRT_PV_3P*goal1_pv_discount)),0),2) as Alt_Gross_CPA' ELSE '' END
    ,CASE WHEN metrics_opt%8192 >= 4096 THEN 
        ' ,round(ifnull(((MRO_PC_REV_3P+(MRO_PV_REV_3P*goal1_pv_discount))/net_media_cost)-1,0),2) as Alt_Net_ROI' ELSE '' END
    ,CASE WHEN metrics_opt%16384 >= 8192 THEN 
        ' ,round(ifnull(((MRO_PC_REV_3P+(MRO_PV_REV_3P*goal1_pv_discount))/gross_media_cost)-1,0),2) as Alt_Gross_ROI' ELSE '' END
    ,CASE WHEN metrics_opt%32768 >= 16384 THEN 
        ' ,round(ifnull((MRO_PC_3P+(sum(MRO_PV_3P)*goal1_pv_discount))/IMPS_3P*1000,0),4) as Alt_RR_per_M' ELSE '' END
,' from external_02.creative
where strategy_id in (',strat_id,')
    and date >= ''',rpt_start_date,'''
and date <= ''',rpt_end_date,'''
group by date(date) 
    ,advsym
    ,strategy_name
    ,placement_id
    ,placement_name
    ,concept
    ,size
    ,exchange
    ,targeting_strat
UNION ALL 
select ''Total'' as `Date`
    , '''' as placement_id
    , '''' as placement_name
    , '''' as strategy
    , '''' as concept
    , '''' as size
    , '''' as exchange
    , '''' as targeting_strat
    , ifnull(sum(IMPS_3P),0) as Imps
    , ifnull(sum(CLICKS_3P),0) as Clicks
    ',CASE WHEN mrt_opt = 1 THEN
        ' ,ifnull(sum(MRT_PC_3P),0) as MRT_PC'
        WHEN mrt_opt = 2 THEN 
        ' ,ifnull(sum(MRT_PC_3P),0) as MRT_PC
        ,ifnull(sum(MRT_PV_3P*goal1_pv_discount),0) as MRT_PV'
        WHEN mrt_opt = 3 THEN 
        ' ,ifnull(sum(MRT_PC_3P)+sum(MRT_PV_3P*goal1_pv_discount),0) as MRT_Tot'
        ELSE '' END
    ,CASE WHEN mrt_rev_opt = 1 THEN
        ' ,ifnull(sum(MRT_PC_REV_3P),0) as MRT_PC_Rev'
        WHEN mrt_rev_opt = 2 THEN 
        ' ,ifnull(sum(MRT_PC_REV_3P),0) as MRT_PC_Rev
        ,ifnull(sum(MRT_PV_REV_3P*goal1_pv_discount),0) as MRT_PV_Rev'
        WHEN mrt_rev_opt = 3 THEN 
        ' ,ifnull(sum(MRT_PC_REV_3P)+sum(MRT_PV_REV_3P*goal1_pv_discount),0) as MRT_Rev'
        ELSE '' END
    ,CASE WHEN mro_opt = 1 THEN
        ' ,ifnull(sum(MRO_PC_3P),0) as MRO_PC'
        WHEN mro_opt = 2 THEN 
        ' ,ifnull(sum(MRO_PC_3P),0),0) as MRO_PC
        ,ifnull(sum(MRO_PV_3P*goal1_pv_discount),0) as MRO_PV'
        WHEN mro_opt = 3 THEN 
        ' ,ifnull(sum(MRO_PC_3P)+sum(MRO_PV_3P*goal1_pv_discount),0) as MRO_Tot'
        ELSE '' END
    ,CASE WHEN mro_rev_opt = 1 THEN
        ' ,ifnull(round(sum(MRO_PC_REV_3P),2),0) as MRO_PC_Rev'
        WHEN mro_rev_opt = 2 THEN 
        ' ,ifnull(sum(MRO_PC_REV_3P),0) as MRO_PC_Rev
        ,ifnull(sum(MRO_PV_REV_3P*goal1_pv_discount),0) as MRO_PV_Rev'
        WHEN mro_rev_opt = 3 THEN 
        ' ,ifnull(round(sum(MRO_PC_REV_3P)+sum(MRO_PV_REV_3P*goal1_pv_discount),2),0) as MRO_Rev'
        ELSE '' END
    ,CASE WHEN media_cost_opt = 1 THEN
        ' ,ifnull(round(sum(gross_media_cost),2),0) as Media_Cost'
        WHEN media_cost_opt = 2 THEN 
        ' ,ifnull(round(sum(net_media_cost),2),0) as Net_Media_Cost
         ,ifnull(round(sum(gross_media_cost),2),0) as Gross_Media_Cost'
        ELSE ' ,ifnull(round(sum(net_media_cost),2),0) as Media_Cost' END
    ,CASE WHEN metrics_opt%2 >= 1 THEN 
        ' ,round(ifnull(sum(CLICKS_3P)/sum(IMPS_3P),0),4) as CTR' ELSE '' END
    ,CASE WHEN metrics_opt%4 >= 2 THEN 
        ' ,round(ifnull((sum(MRT_PC_3P)+(sum(MRT_PV_3P)*goal1_pv_discount))/sum(IMPS_3P)*1000,0),4) as RR_per_M' ELSE '' END
    ,CASE WHEN metrics_opt%8 >= 4 THEN 
        ' ,round(ifnull((sum(net_media_cost)/sum(IMPS_3P))*1000,0),2) as Net_CPM' ELSE '' END
    ,CASE WHEN metrics_opt%16 >= 8 THEN 
        ' ,round(ifnull(sum(net_media_cost)/sum(CLICKS_3P),0),2) as Net_CPC' ELSE '' END
    ,CASE WHEN metrics_opt%32 >= 16 THEN 
        ' ,round(ifnull((sum(net_media_cost))/((sum(MRT_PC_3P))+(sum(MRT_PV_3P)*goal1_pv_discount)),0),2) as Net_CPA' ELSE '' END
    ,CASE WHEN metrics_opt%64 >= 32 THEN 
        ' ,round(ifnull((sum(gross_media_cost)/sum(IMPS_3P))*1000,0),2) as Gross_CPM' ELSE '' END
    ,CASE WHEN metrics_opt%128 >= 64 THEN 
        ' ,round(ifnull(sum(gross_media_cost)/sum(CLICKS_3P),0),2) as Gross_CPC' ELSE '' END
    ,CASE WHEN metrics_opt%256 >= 128 THEN 
        ' ,round(ifnull((sum(gross_media_cost))/((sum(MRT_PC_3P))+(sum(MRT_PV_3P)*goal1_pv_discount)),0),2) as Gross_CPA' ELSE '' END
    ,CASE WHEN metrics_opt%512 >= 256 THEN 
        ' ,round(ifnull(((sum(MRT_PC_REV_3P)+(sum(MRT_PV_REV_3P)*goal1_pv_discount))/sum(net_media_cost))-1,0),2) as Net_ROI' ELSE '' END
    ,CASE WHEN metrics_opt%1024 >= 512 THEN 
        ' ,round(ifnull(((sum(MRT_PC_REV_3P)+(sum(MRT_PV_REV_3P)*goal1_pv_discount))/sum(gross_media_cost))-1,0),2) as Gross_ROI' ELSE '' END
    ,CASE WHEN metrics_opt%2048 >= 1024 THEN 
        ' ,round(ifnull((sum(net_media_cost))/((sum(MRT_PC_3P))+(sum(MRT_PV_3P)*goal1_pv_discount)),0),2) as Alt_Net_CPA' ELSE '' END
    ,CASE WHEN metrics_opt%4096 >= 2048 THEN 
        ' ,round(ifnull((sum(gross_media_cost))/((sum(MRT_PC_3P))+(sum(MRT_PV_3P)*goal1_pv_discount)),0),2) as Alt_Gross_CPA' ELSE '' END
    ,CASE WHEN metrics_opt%8192 >= 4096 THEN 
        ' ,round(ifnull(((sum(MRO_PC_REV_3P)+(sum(MRO_PV_REV_3P)*goal1_pv_discount))/sum(net_media_cost))-1,0),2) as Alt_Net_ROI' ELSE '' END
    ,CASE WHEN metrics_opt%16384 >= 8192 THEN 
        ' ,round(ifnull(((sum(MRO_PC_REV_3P)+(sum(MRO_PV_REV_3P)*goal1_pv_discount))/sum(gross_media_cost))-1,0),2) as Alt_Gross_ROI' ELSE '' END
    ,CASE WHEN metrics_opt%32768 >= 16384 THEN 
        ' ,round(ifnull((sum(MRO_PC_3P)+(sum(MRO_PV_3P)*goal1_pv_discount))/sum(IMPS_3P)*1000,0),4) as Alt_RR_per_M' ELSE '' END
,' from external_02.creative
where strategy_id in (',strat_id,')
and date >= ''',rpt_start_date,'''
and date <= ''',rpt_end_date,''';');

# Prepares and executes the dynamic SQL statement.
PREPARE ExecStatement FROM @report_code;
EXECUTE ExecStatement;
# Deallocates statement.
DEALLOCATE PREPARE ExecStatement;
# Prepares and executes the dynamic SQL statement.
END$$

    DELIMITER ; 
```

这是我得到的错误：

```
 Error Code: 1064
    You have an error in your SQL syntax; check the manual that corresponds to your               
    MySQL server version for the right syntax to use near ') as MRO_PC
,ifnull(sum(MRO_PV_3P*goal1_pv_discount),0) as MRO_PV ,ifnull(rou' at line 38 
```

这很令人困惑，因为我在第 38 行找不到该代码......

该错误似乎围绕代码的**WHEN mrt_opt = 2 THEN**部分。因为（正如我之前所说）如果该选项为 0 或 1，则该过程有效。

我花了很长时间看这个，想要一双新鲜的眼睛。

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-09T17:56:11.267

您`,0)`在关于该代码的声明中有一个额外的内容。

搜索并更改以下行：

```
WHEN mro_opt = 2 THEN 
    ' ,ifnull(sum(MRO_PC_3P),0),0) as MRO_PC 
```

对此：

```
WHEN mro_opt = 2 THEN 
    ' ,ifnull(sum(MRO_PC_3P),0) as MRO_PC 
```

# linux - Linux - 从文本文件创建多个文件夹

> ID：14243077
> 
> 赞同：2
> 
> 时间：2013-01-09T17:34:00.470
> 
> 标签：linux, scripting

```
 #!/bin/bash
   IFS='
   '
   for _dir in $(cat "$1 usernames.lnk"); do
   mkdir "$_dir Windows"
   done 
```

我在使用此脚本时遇到问题，它必须在 usernames.lnk 文本文件中列出的每个名称的 Windows 文件夹中创建一个文件夹，但每次我尝试运行脚本时，它都会显示“usernames.lnk”目录不能被发现。脚本和用户名文件以及 Windows 文件夹都在同一个文件夹中。提前致谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-09T17:39:50.350

这将读取文件的每一行并在目录（相对路径）`usernames.lnk`下创建一个目录。`Windows`

```
#!/bin/bash
while read -r line; do
    mkdir "Windows/$line"
done < usernames.lnk 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-09T17:47:36.863

这种方式应该有效：

```
#!/bin/bash

for i in `cat usernames.lnk`;
do mkdir "Windows/$i";
done 
```

# ios - 无法让 InnerBand CoreData 框架工作

> ID：14243078
> 
> 赞同：0
> 
> 时间：2013-01-09T17:34:08.313
> 
> 标签：ios, xcode, core-data, frameworks

我正在尝试让 InnerBand 框架工作。如果您不知道，这里是一个链接： [https ://github.com/ZaBlanc/InnerBand](https://github.com/ZaBlanc/InnerBand)

我按照 github 页面上的自述文件以及创建者网站上的教程进行操作，但是在第一个命令时出现错误。

```
Car *myCar = [Car create]; 
```

Xcode 只说“选择器'创建'没有已知的类方法”。

到目前为止我所做的：

- 创建一个 .xcdatamodeld 文件，添加实体（汽车）和属性并将其保存为 NSManagedObject 子类。

- 将以下内容导入项目并将以下内容写入 .pch 文件。

```
#import "IBCoreDataStore.h"
#import <CoreData/CoreData.h>
#import "Car.h" 
```

我对编程比较陌生，所以我错过了什么？Car.h 类是否应该以某种方式扩展 InnerBand 框架以使方法（如 create）可用？

非常感谢你！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-09T18:38:34.677

我为你验证了这一点。

你需要

```
#import "NSManagedObject+InnerBand.h" 
```

使用`create`方法。

这些是该类别扩展中包含的方法：

```
// CREATION

+ (id)create;
+ (id)createInStore:(IBCoreDataStore *)store;

// QUERY

+ (NSArray *)all;
+ (NSArray *)allForPredicate:(NSPredicate *)predicate;
+ (NSArray *)allForPredicate:(NSPredicate *)predicate orderBy:(NSString *)key ascending:(BOOL)ascending;
+ (NSArray *)allOrderedBy:(NSString *)key ascending:(BOOL)ascending;
+ (NSArray *)allInStore:(IBCoreDataStore *)store;
+ (NSArray *)allForPredicate:(NSPredicate *)predicate inStore:(IBCoreDataStore *)store;
+ (NSArray *)allForPredicate:(NSPredicate *)predicate orderBy:(NSString *)key ascending:(BOOL)ascending inStore:(IBCoreDataStore *)store;
+ (NSArray *)allOrderedBy:(NSString *)key ascending:(BOOL)ascending inStore:(IBCoreDataStore *)store;

+ (id)first;
+ (id)firstWithKey:(NSString *)key value:(NSObject *)value;

+ (id)firstInStore:(IBCoreDataStore *)store;
+ (id)firstWithKey:(NSString *)key value:(NSObject *)value inStore:(IBCoreDataStore *)store;

// DELETE/DESTROY

+ (void)destroyAll;
+ (void)destroyAllInStore:(IBCoreDataStore *)store;

- (void)destroy; 
```

# oracle - 如何使用绑定变量修复“ORA-29909：辅助运算符的标签不是文字数字”？

> ID：14243084
> 
> 赞同：2
> 
> 时间：2013-01-09T17:34:15.790
> 
> 标签：oracle, contains, oracle-text

以下 SQL 运行 Oracle Text CONTEXT 索引列：

```
variable label number;
exec :label := 1;
SELECT * FROM TEST_TABLE 
           WHERE CONTAINS(INDEXEDCOL, 'token', :label) > 0; 
```

结果是：

```
Error report:
SQL Error: ORA-29909: label for the ancillary operator is not a literal number
29909\. 00000 -  "label for the ancillary operator is not a literal number"
*Cause:    The label used for invoking the ancillary operator is not
           a literal number.
*Action:   Use a literal number as the label. 
```

我在这里发现了一个类似问题的提及：

[https://forums.oracle.com/forums/thread.jspa?threadID=91417](https://forums.oracle.com/forums/thread.jspa?threadID=91417)

但在我的情况下，使用以下命令更改光标无济于事：

```
ALTER SESSION SET cursor_sharing='EXACT'; 
```

还有这个stackoverflow问题：

[ORA-29908: 缺少辅助运算符的主要调用](https://stackoverflow.com/questions/8352796/ora-29908-missing-primary-invocation-for-ancillary-operator)

但答案不适用。我正在使用 Oracle 11.2.0.3.0

# php - Zend Framework 2 - 查看

> ID：14243086
> 
> 赞同：0
> 
> 时间：2013-01-09T17:34:19.537
> 
> 标签：php, zend-framework2

我正在使用 ZF2 开发应用程序。我被 弄糊涂了`Views`。在 ZF1 中，我在引导程序中启动了一个视图对象，并将其用于所有模块和视图。我如何使用 ZF2 做同样的事情？

在 ZF1 中，我在 Bootstrapper 中使用了以下示例代码。

```
$view = new Zend_view();
$view->sitePath = 'mysite.com'; 
```

我必须将站点名称保存在全局对象中。我认为，ZF2 中没有注册表。谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-09T18:52:40.157

请参阅官方手册并熟悉 Zend Framework 2 的工作方式。即使手册可能有很多缺失的点点滴滴，核心概念也得到了很好的解释。

*   [Zend\View 快速入门（部分：控制器和视图模型）](http://framework.zend.com/manual/2.0/en/modules/zend.view.quick-start.html#controllers-and-view-models)
*   [Zend\View 手册概览](http://framework.zend.com/manual/2.0/en/index.html#zend-view)

通过这个你会注意到，有一个[Zend\View\Helper\BasePath](http://framework.zend.com/manual/2.0/en/modules/zend.view.helpers.html#basepath-helper)存在（顺便说一句，ZF1 也是如此），它绝对适合你上面描述的用例。

# css - 在 CSS 中是否有一个选择器用于引用也有一个类的特定输入类型？

> ID：14243088
> 
> 赞同：59
> 
> 时间：2013-01-09T17:34:25.180
> 
> 标签：css, css-selectors

基本上我想要一个 CSS 选择器，它可以抓取所有的 input[type="text"]，但它也有一个类“some-class”。

以下两项似乎都不适合我：

```
input[type="text"] .some-class {}    /* doesn't work */

.some-class input[type="text"] {}    /* doesn't work */ 
```

我确定我在这里遗漏了一些简单的东西。提前致谢。

* * *

## 回答 #1

> 赞同：126
> 
> 时间：2013-01-09T17:35:22.247

你要`input.some-class[type="text"]`

`.some-class input`查找属于`.some-class`.

`input.some-class`做相反的事情。

* * *

## 回答 #2

> 赞同：29
> 
> 时间：2015-06-04T20:13:41.977

```
 input[type="text"].some-class {
    ....
     } 
```

"input[type="text"]" 和 ".some-class" 之间没有空格可以工作..

input[type="text"]-中间的空格是问题-.some-class {}

# git - Git：将 HEAD 移回上一个提交

> ID：14243089
> 
> 赞同：5
> 
> 时间：2013-01-09T17:34:27.027
> 
> 标签：git

我在我的主分支中进行了一些我认为不再合适的更改。为了争论，我有一个名为的提交哈希`791fda4e1ac0e1a393e01340bf0fba3f333a73ff`，我现在想创建我的 HEAD，因为那时一切都在 repo 中稳定了。我尝试执行以下操作：

```
git reset 791fda4e1ac 
git reset --soft HEAD@{1} 
git commit -m "Revert to 791fda4e1ac"
git reset --hard 
```

然而，当我做 a 时`git push origin`，我被拒绝了，因为 origin 认为这是一个非快进推动：

```
 ! [rejected]        master -> master (non-fast-forward) 
```

将我的 HEAD 恢复为提交哈希 791fda4e1ac 并将源服务器也放在那里的正确方法是什么？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-01-09T17:41:45.023

它被拒绝是因为它*不是*快进的——它丢弃了其他人可能建立的历史。

而是使用`git revert`创建一个新的提交来撤消现有提交的效果。

或者，如果您确定没有其他人在使用您的存储库并且您将来不关心这些提交，请继续`git push -f`忽略警告。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-09T17:37:44.613

您必须执行强制推送 ( `git push -f origin`)。

# javascript - 如何在网络浏览器中保存 PDF 文件 - 使用书签？

> ID：14243090
> 
> 赞同：3
> 
> 时间：2013-01-09T17:34:30.203
> 
> 标签：javascript, browser, bookmarklet

我正在构建一个用于大公司的社交书签应用程序。

它有一个简单的 JavaScript 书签，目前运行良好——书签允许用户从流行的浏览器中保存书签。它非常适用于公共网络链接 - 并且与浏览器完全无关。这种小书签最接近的例子是：

[http://delicious.com/help/bookmarklets](http://delicious.com/help/bookmarklets)

当我在浏览器中查看 PDF 时（比如说 Chrome/Mac）：

[http://website.com/file.pdf](http://website.com/file.pdf)

这当然行不通——因为无法在浏览器中查看的 PDF 上注入 HTML 标记。

使指向非 http 资源的链接在书签中起作用的最佳方法是什么？我是否必须创建然后注入某种不可见的 iframe，然后抓取父框架及其 URL 才能保存它？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-09T18:19:16.690

我不了解所有浏览器，但在 Firefox 中，您可以在 PDF 文件和图像上注入 Javascript 和 iFrame。这是因为图像和 PDF 文件实际上显示在 Firefox 生成的特殊虚拟 HTML 页面中。我认为Chrome可能是一样的。

您可以通过打开 PDF 或图像然后打开 Web 控制台（必须使用菜单，在这种情况下不能使用 CTRL+SHIFT+K）来获取 JS 控制台然后键入`document.documentElement.outerHTML`以查看实际的虚拟 HTML PDF 或图像被嵌入。

为了检测我无法将 iFrame 或其他 HTML 添加到页面的情况，我可能会测试是否定义了 document.documentElement，或者可能是其他一些 DOM 元素。

对于这不起作用的任何浏览器或文件类型组合，或者如果我只是想让事情更简单，我会在我的服务器上的新选项卡或窗口中打开一个页面，并将页面标题和位置传递给该页面像[http://mysocialsite.tld/add-bookmark?title=file.pdf&location=http://anothersite.tld/file.pdf](http://mysocialsite.tld/add-bookmark?title=file.pdf&location=http://anothersite.tld/file.pdf)。我服务器上的那个页面会让用户完成书签过程。

# google-drive-api - 可以使用来自 Google Apps For Business 的 OAuth 对 Google Drive API 进行身份验证吗？

> ID：14243093
> 
> 赞同：1
> 
> 时间：2013-01-09T17:34:50.063
> 
> 标签：google-drive-api

我使用 Google Apps For Business 管理一个域的 14 个帐户。

可以为域设置 OAuth 密钥和密码。使用此凭据，您可以访问每个帐户的所有文件，而无需知道他们的个人密码或 oauth 凭据。

使用 Google Documents List API 很容易编写一个小脚本，以便我可以备份数据。

是否可以在不知道每个 OAuth2 凭据的情况下使用新的 Google Drive Api 备份这些文件？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-09T19:48:57.233

有一个服务帐户的概念，您可以通过它达到您想要的，看看谷歌在这个[https://developers.google.com/drive/delegation上的文档](https://developers.google.com/drive/delegation)

# java - 您如何在 Android 中读取 .txt 文件？

> ID：14243095
> 
> 赞同：0
> 
> 时间：2013-01-09T17:34:54.960
> 
> 标签：java, android

我是android开发的新手。今天我试图在我的应用程序中显示我所有练习过的 java 程序。我希望应用程序读取写入 .txt 文件的数据。

1.  我应该将所有程序存储在哪个文件夹中？他们超过100人。
2.  当我单击列表视图或任何其他上的 2 时，我想显示程序 2 的内容
3.  我们可以将文本文件存储在数据库中吗？如果是这样，我该如何访问它们？我怎样才能阅读它们？
4.  任何基本想法我该如何解决这个问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-09T17:50:52.240

您可以将文本文件保存在 raw / assets 文件夹中。要阅读它们，只需使用此代码。从资产：

```
BufferedReader reader = new BufferedReader(
                 new InputStreamReader(getAssets().open("YourTextFile.txt"))); 
```

从原始：

```
InputStream inputStream =  context.getResources().openRawResource(R.id.yourresoureid);

             InputStreamReader inputreader = new InputStreamReader(inputStream) 
```

由于您是 Java 程序员，因此无需告诉如何从 InputStream 读取数据，如果您真的想要，请告诉我，我将发布其余代码。

在数据库中保存大量数据并不是一个好主意。

从 InputStream 读取数据的示例

```
 BufferedInputStream bis=new BufferedInputStream(inputstream);
            ByteArrayBuffer baf=new ByteArrayBuffer(1000);
            while((k=bis.read())!=-1)
            {
            baf.append((byte)k);

            }
            String results=new String(baf.toByteArray()); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-09T17:52:52.870

1.  从简单的事情开始，然后处理数据库选项。
2.  是的，答案会很长，我认为关于 SQLite 的教程将是一个开始的地方。2,1。尝试将您的文本文件放在资产文件夹中并像这样阅读它们。此代码读取一个文件，并将其逐行转储到日志中。

    @Override public void onCreate(Bundle savedInstanceState) { super.onCreate(savedInstanceState); setContentView(R.layout.activity_read);

    ```
    AssetManager assetManager = getAssets();

    try {
        BufferedReader br = new BufferedReader(new InputStreamReader( 
                assetManager.open("hi.txt")));
        // InputStream inputStream = assetManager.open("hi.txt");
        // BufferedReader br = new BufferedReader(
        // new InputStreamReader(inputStream));

        String lineIn;
        while ((lineIn = br.readLine()) != null) {
            Log.d("ReadTheDamnFile", lineIn);
        }
        assetManager.close();
    } catch (IOException e) {

    } 
    ```

    }

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-02-27T07:53:39.843

试试这个它的工作正常:)

```
try 
   {
           if(poslist==0)
           {
               in = this.getAssets().open("file1.txt");
               iv.setBackgroundResource(R.drawable.fileimage1);

           }
 }
  catch (IOException e) 
  {
      e.printStackTrace();
  }
      try {
        reader = new BufferedReader(new InputStreamReader(in,"UTF-8"));
    } catch (UnsupportedEncodingException e1) {
        // TODO Auto-generated catch block
        e1.printStackTrace();
    }
      String line="";
      String s ="";
   try 
   {
       line = reader.readLine();
   } 
   catch (IOException e) 
   {
       e.printStackTrace();
   }
      while (line != null) 
      {
       s = s + line;
       s =s+"\n";
       try 
       {
           line = reader.readLine();
       } 
       catch (IOException e) 
       {
           e.printStackTrace();
       }
    }
    tv.setText(""+s);
  }

  public void onClick(View v){
      try {
    line = reader.readLine();
   } catch (IOException e) {
    // TODO Auto-generated catch block
    e.printStackTrace();
   }
      if (line != null){
          tv.setText(line);
      } else {
          //you may want to close the file now since there's nothing more to be done here.
      } 
```

# cakephp - Cakephp HABTM 连接表为空

> ID：14243096
> 
> 赞同：1
> 
> 时间：2013-01-09T17:35:01.373
> 
> 标签：cakephp, has-and-belongs-to-many

我正在关注一个应用程序的[教程](http://www.tuxradar.com/content/cakephp-tutorial-build-file-sharing-application)，用户可以在其中上传文件并且文件属于特定用户。用户和上传之间存在 HABTM 关系，如下所示：

上传.php：

```
var $hasAndBelongsToMany = array(
    'SharedUser' => array(
        'className' => 'User',
        'joinTable' => 'uploads_users',
        'foreignKey' => 'upload_id',
        'associationForeignKey' => 'user_id',
        'unique' => 'keepExisting'
    )
); 
```

用户.php：

```
var $hasMany = array(
    'Upload' => array(
        'className' => 'Upload',
        'foreignKey' => 'user_id',
        'dependent' => false
    )
);

var $hasAndBelongsToMany = array(
    'SharedUpload' => array(
        'className' => 'Upload',
        'joinTable' => 'uploads_users',
        'foreignKey' => 'user_id',
        'associationForeignKey' => 'upload_id',
        'unique' => true
    )
); 
```

一切似乎都可以正常工作，但有一个例外，那就是在创建新的 Upload 时，uploads_users 表没有更新。如果我手动将数据插入其中，那么旨在使用它功能查找和显示数据的视图。谁能提出什么问题？

这是 uploads_users 表：

```
+-----------+----------+------+-----+---------+----------------+
| Field     | Type     | Null | Key | Default | Extra          |
+-----------+----------+------+-----+---------+----------------+
| id        | int(11)  | NO   | PRI | NULL    | auto_increment |
| upload_id | char(36) | NO   |     | NULL    |                |
| user_id   | char(36) | NO   |     | NULL    |                |
+-----------+----------+------+-----+---------+----------------+ 
```

我已经从教程中稍微更改了 add Upload 方法（因此如果数据库保存失败，它会删除上传的文件），所以这里也是：

```
function add() {
  if (!empty($this->data)) {
    $this->Upload->create();
    if ($this->uploadFile()) {
      try {
        if (!$this->Upload->saveAll($this->request->data)) {
          throw new Exception('Couldn't save to database.');
        }
        $this->Session->setFlash(__('The upload has been saved', true));
        $this->redirect(array('action' => 'index'));
      }
      catch (Exception $e) {
        unlink(APP . 'tmp/uploads/' . $this->request->data['Upload']['id']);
        $this->Session->setFlash(__('The upload could not be saved: ' . $e->getMessage(), true));
      }
    } else {
      $this->Session->setFlash(__('The upload could not be saved.', true));
    }
  }
  $users = $this->Upload->User->find('list');
  $this->set(compact('users', 'users'));
}

function uploadFile() {
  $file = $this->data['Upload']['file'];
  if ($file['error'] === UPLOAD_ERR_OK) {
    $id = String::uuid();
    if (move_uploaded_file($file['tmp_name'], APP.'tmp/uploads'.DS.$id)) {
      $this->request->data['Upload']['id'] = $id;
      $this->request->data['Upload']['user_id'] = $this->Auth->user('id');
      $this->request->data['Upload']['filename'] = $file['name'];
      $this->request->data['Upload']['filesize'] = $file['size'];
      $this->request->data['Upload']['filemime'] = $file['type'];
      return true;
    }
  }
  return false;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-09T17:51:33.200

It would be usefull to see what else is in your request->data. As written in cookbook you should use the related model structure.

It should look the following:

```
$this->request->data['Upload']['id'] = $id;
$this->request->data['Upload']['user_id'] = $this->Auth->user('id');
...
$this->request->data['SharedUser']['id'] = $this->Auth->user('id'); 
```

Also I could not see your belongsTo relation shown in your method "uploadFile". Maybe you don't need it in the "Upload" model.

# node.js - 请求回调中的请求未按预期运行（nodejs）

> ID：14243097
> 
> 赞同：0
> 
> 时间：2013-01-09T17:35:02.610
> 
> 标签：node.js, proxy, request

我昨天下午开始玩nodejs。今天早上我开始写一个代理服务器，收到请求后有以下要求：

*   执行身份验证检查（通过 request()）
*   如果 auth check 评估为 true，则执行实际请求（代理）
*   否则，重定向

一切正常，除了实际的代理请求（分配给代理 var）。它要么没有被调用，或者至少没有被返回到请求中。或者别的什么，我觉得这可能与 nodejs 的异步行为有关。

附加说明：“赢！” 在控制台上输出。

欢迎任何想法。

```
var server = httpProxy.createServer(function(request, response, proxy) {
  var requestHostname = request.headers['x-forwarded-host'];
  var configFile      = './config/'+requestHostname+'.js';

  if(path.existsSync(configFile))
  {
    var config  = require(configFile);

    var authProxy = requester({
      url:    config.proxyRequest.url+config.proxyRequest.defaultPath,
      port:   443,
      method: request.method
    }, function(error, proxyResp, body) {       
      if(config.methods.authCheck(body)) 
      {
        console.log('Win!');

        proxy = requester({
          url:    'http://www.google.com',
          port:   443,
          method: request.method
        });

        // Pipe request and response back
        request.pipe(proxy);
        proxy.pipe(response);
      }
      else
      {
        response.writeHead(300, 'Forbidden', {
          'Location': globalConf.portalUrl
        });

        response.end();
      }
    });
  }
  else
  {
    response.writeHeader(400);
    response.write('404: The requested URL '+requestHostname+' does not exist.');
    response.end();
  }

  response.addListener('end', function() {
    console.log('Ending it');
  })
}); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-09T18:43:37.577

问题是您正在为`authProxy`and分配返回值`proxy`。您应该`requester`在不分配值的情况下调用，只需：

```
requester( object, callback ); 
```

我不确定`requester`您的代码中返回了什么，但是在调用异步函数时，您通常不会期望返回值，而是处理`callback`作为参数传递的所有其他内容。也许如果您添加该代码的示例（请求者函数），事情会更清楚:)

# node.js - NodeJs 中的 response.writeHead 和 response.end

> ID：14243100
> 
> 赞同：40
> 
> 时间：2013-01-09T17:35:15.027
> 
> 标签：node.js

```
var https = require('https');
var fs = require('fs');

var options = {
  key: fs.readFileSync('test/fixtures/keys/agent2-key.pem'),
  cert: fs.readFileSync('test/fixtures/keys/agent2-cert.pem')
};

https.createServer(options, function (req, res) {
  res.writeHead(200);
  res.end("hello world\n");
}).listen(8000); 
```

1.  谁能解释一下为什么我们在 createServer 方法中调用`writeHead`and`end` 方法。
2.  createServer 方法中传递的选项对象的主要目的是什么。

* * *

## 回答 #1

> 赞同：45
> 
> 时间：2013-01-09T17:40:00.897

这些调用`writeHead`并`end`没有在`createServer`方法中完成，而是在回调中完成。

如果将回调拆分为单独的函数，则更容易查看：

```
function handleRequest(req, res) {
  res.writeHead(200);
  res.end("hello world\n");
}

https.createServer(options, handleRequest).listen(8000); 
```

所以在这里我们定义一个`handleRequest`函数，然后将它传递给`createServer`调用。现在，每当我们创建的 node.js 服务器收到传入请求时，它都会调用我们的`handleRequest`方法。

这种模式在 JavaScript 中很常见，是 node.js 异步事件处理的核心。

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2014-10-18T06:48:46.730

在您的代码中，`writeHead()`调用 来编写响应的标头，应用程序将提供给客户端。该`end()`方法既向客户端发送响应的内容，又向服务器发出响应（标头和内容）已完全发送的信号。如果您仍要发送任何其他内容，则应改为调用响应对象`write()`的方法。`res`

JSON 对象是一个修饰符，您可以使用它`options`来覆盖该`createServer()`方法的默认行为。在您的代码的情况下：
+ key：用于 SSL 的私钥（默认为 null）
+ cert：要使用的公共 x509 证书（默认为 null）

您可以在 Node.js API 文档的[此部分](http://nodejs.org/api/http.html#http_response_writehead_statuscode_reasonphrase_headers)`response.writeHead()`中找到有关该方法的更多信息。
您可以在 Node.js API 文档的[此部分](http://nodejs.org/api/http.html#http_response_writehead_statuscode_reasonphrase_headers)`https.createServer()`中找到有关该方法的更多信息。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2016-07-20T09:56:02.593

`response.writeHead(200)`向请求发送响应头。状态码是 3 位 HTTP 状态码，如 404。

此方法只能在消息上调用一次，并且必须在调用 response.end() 之前调用。

如果您在调用 this 之前调用 response.write() 或 response.end()，则会计算隐式/可变标头并为您调用此函数。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2017-12-03T05:18:22.937

据我所知，如果您不将 response.end() 放在最后，那么您的网页将继续加载，因此 response.end() 用于告诉服务器数据已加载

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2020-07-16T19:48:44.893

该`res.writeHead`方法用于向浏览器返回一个状态码，如果是客户端状态码或服务器端状态码，浏览器会抛出错误。该`res.end`方法是确保响应在准备好之前不会返回，以防嵌套代码或其他情况。

该对象的目的是在声明该页面在 https 下加密*之前*`options`，确保该页面具有有效的密钥和证书。

# android - 在 GridView (Android) 中按下图像时应用程序崩溃

> ID：14243108
> 
> 赞同：0
> 
> 时间：2013-01-09T17:35:28.737
> 
> 标签：android, gridview, onitemclicklistener

我有这个 GridView 我用来显示图像。在底线我想按下一个图像，我在另一个活动中的视图将获得图像。

这是我在 OnItemClickListener 中使用的代码-

```
 GridView grid = (GridView) findViewById(R.id.grid_view);
    grid.setOnItemClickListener(new OnItemClickListener() {

        @Override
        public void onItemClick(AdapterView<?> arg0, View arg1, int position,
                long arg3) {
            // TODO Auto-generated method stub
            View bg = (View)findViewById(R.id.background);
            bg.setBackgroundResource(ImageAdapter.mThumbIds[position]);

            finish();

        }
    });

    grid.setAdapter(new ImageAdapter(this)); 
```

我的应用程序崩溃的原因是 View(bg) 返回为空。我该如何解决？并使它正确？我真的很喜欢有人帮我解决这个问题。谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-09T18:29:14.923

正如你所说，你有`R.id.background`你的`activity_main.xml`，你必须首先将该布局分配给你的活动，`setContentView(...)`如下所示：

```
public void onCreate(Bundle savedInstanceState) {
  super.onCreate(savedInstanceState);
  setContentView(R.layout.activity_main);

  GridView grid = (GridView) findViewById(R.id.grid_view);
  grid.setAdapter(new ImageAdapter(this));

  gridview.setOnItemClickListener(new OnItemClickListener() {
      public void onItemClick(AdapterView<?> parent, View v, int position, long id) {
          View bg = (View)findViewById(R.id.background);
          bg.setBackgroundResource(ImageAdapter.mThumbIds[position]);

          finish();
      }
  });
} 
```

您`findViewById()`需要该内容视图。[`GridView`](http://developer.android.com/guide/topics/ui/layout/gridview.html)这是 a和a 的默认用法`ImageAdapter`。

注意：使用此解决方案，您还应该将您的`GridView`with id`grid_view`放在相同的布局中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-09T20:33:33.120

谢谢大家的帮助。最后我只是传递了图像的来源并在我的另一个视图中将其设置为 onStart。不管怎么说，还是要谢谢你！

# php - 使用多个条件在 PHP 中搜索目录

> ID：14243110
> 
> 赞同：0
> 
> 时间：2013-01-09T17:35:42.137
> 
> 标签：php, search, directory, glob

我一直在尝试找到一种方法来在 PHP 中搜索具有多个条件的目录，但运气不佳。

我有一个文件夹，其中包含同一文件的多个版本，但使用不同的语言和不同的设备：

例如

```
 1\. file_en_v980.jar

 2\. file_fr_v980.jar

 3\. file_en_v990.jar

 4\. file_fr_v990.jar 
```

我希望能够在目录中搜索 v980 的所有英语 (en) .jar 文件。

我试过这个：

```
foreach(glob('./'.$installer_location.'/'.$brand_name.'/*en*.jar') as $filename){
    echo $filename."</br>";
} 
```

它可以工作，但也返回法语（fr）文件。

我试过这个：

```
foreach(glob('./'.$installer_location.'/'.$brand_name.'/*en,v980*.jar') as $filename){
    echo $filename."</br>";
} 
```

但它什么也没返回，所以我假设我的语法错误。

任何帮助将不胜感激。

添加：

根据下面评论的建议，我尝试了这个：

```
foreach(glob('./'.$installer_location.'/'.$brand_name.'/*{en,v980}*.jar',GLOB_BRACE) as $filename){
    echo $filename."</br>";
} 
```

这将返回所有具有 en、v980 或两者的文件。我只需要弄清楚是否有办法说必须同时包含两者。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-09T17:53:32.193

PHP 的 glob() 本质上使用与 unix shell 相同的通配符/匹配引擎。使用您的版本，您正在搜索包含 的文件`en,v980`，并且它不会被视为“替代”。[http://www.tldp.org/LDP/GNU-Linux-Tools-Summary/html/x11655.htm](http://www.tldp.org/LDP/GNU-Linux-Tools-Summary/html/x11655.htm)

尝试

```
glob('..../*{en,v980}*.jar') 
```

相反（注意`{}`）

# .net - 实体框架：更改表以查看而不更新 EDMX

> ID：14243111
> 
> 赞同：3
> 
> 时间：2013-01-09T17:35:45.840
> 
> 标签：.net, sql, entity-framework, edmx, sql-view

如果列和名称相同，实体框架是否关心在 EDMX 中映射的表是否实际上是数据库中的视图？

我正在开发一个数据库可能必须更改的应用程序，但我们可能无法立即使用新表结构部署更新的 EDMX。我的同事想为数据库中的每个表添加一个视图并更新 EDMX 以映射到视图而不是表，并使用存储过程进行插入/更新/删除操作。这样，如果我们需要更改表结构，我们可以保持视图列和过程参数相同，并且我们的 EDMX 文件不会受到影响。对我来说，为了以防万一我们以后想更改其中一个，拥有镜像每个表的视图似乎有点矫枉过正，所以我正在寻找另一种解决方案。

一种想法是让 EDMX 映射到表。如果表需要稍后更改，则可以重命名表，并可以创建具有相同名称和相同列的视图。

我尝试了一个实验并创建了表 MyTable 并将其映射到 EDMX。然后我将 MyTable 重命名为 tblMyTable 并创建了一个名为 MyTable 的视图，该视图从 tblMyTable 中选择所有内容。尽管 EDMX 仍然认为它已映射到表，但它在选择或更新 MyTable 实体时没有问题。如果我必须拆分表并将数据重新连接到视图中，则更新将不起作用，但如果需要，我应该能够使用 INSTEAD OF 触发器来处理它。

这种方法有什么问题吗？我以前从未见过这样做，但从我所做的有限测试来看，它似乎应该可以工作。我知道这不适用于主要的数据库更改——如果我想完全删除一个表，那么应用程序代码将不得不更改。我只是想知道实体框架是否有一些技术原因不能完全支持这一点。

# java - 在渐变之间平滑淡入淡出

> ID：14243116
> 
> 赞同：1
> 
> 时间：2013-01-09T17:36:00.550
> 
> 标签：java, javafx-2, javafx

下面的代码应该在两个渐变之间平滑地淡化一个矩形：

```
public class FXTest extends Application {

    @Override
    public void start(Stage primaryStage) {
        StackPane root = new StackPane();
        Rectangle rect = new Rectangle(200, 100, new LinearGradient(0, 0, 1, 1, true, CycleMethod.REPEAT, new Stop(0, Color.BLACK), new Stop(1, Color.RED)));
        root.getChildren().add(rect);

        Scene scene = new Scene(root, 300, 250);
        primaryStage.setScene(scene);
        primaryStage.show();
        getFillTimeline(rect, new LinearGradient(0, 0, 1, 1, true, CycleMethod.REPEAT, new Stop(0, Color.RED), new Stop(1, Color.BLACK))).play();
    }

    private Timeline getFillTimeline(Shape node, Paint newPaint) {
        Timeline t = new Timeline();
        t.getKeyFrames().add(new KeyFrame(Duration.ZERO, new KeyValue(node.fillProperty(), node.getFill())));
        t.getKeyFrames().add(new KeyFrame(Duration.seconds(3), new KeyValue(node.fillProperty(), newPaint)));
        return t;
    }
} 
```

如果我在上面的例子中指定了纯色，那么褪色就没有问题了，很好很流畅。但是，如果我使用渐变（如上面的代码），那么不会发生淡入淡出，渐变会在 3 秒后突然切换（或者无论时间线的持续时间是多少。）

当使用渐变而不是简单的颜色时，如何实现渐变？为什么这不应该按照我的想法工作，或者它是一个错误，我背后是否缺少一些逻辑？

无论哪种情况，实现此效果的最佳解决方法是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-09-25T13:19:37.790

我不认为它会知道如何在完全不同的油漆之间进行平滑过渡。尝试将纯色设置为渐变，其中开始颜色和结束颜色是相同的颜色。

# entity-framework - 实体框架热门管理大型项目？

> ID：14243122
> 
> 赞同：-4
> 
> 时间：2013-01-09T17:36:15.880
> 
> 标签：entity-framework, entity-framework-4

我有一个有很多表的数据库（接近 400 个）

现在我们必须使用 dbfirst 方法构建模型。

1.  构建模型的最佳方法是什么？
2.  我们可以将整个模型编译为 dll 吗？
3.  我该怎么做才能在不同的项目中重用模型？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-09T18:18:29.090

1-最适合做什么？！如果您需要快速构建项目，我建议您使用`Database-First`方法。但我有一些限制，但速度很快。如果您使用`Model-First`，您可以快速构建您的项目，购买与 Database-First 相同，它有一些限制，但如果时间不是您的问题，那么您可以使用`Class-First`（Code-First）方法。它比其他的更灵活。

2 - 是的，你可以。如果您使用的是 n 层架构，您可以通过创建一个 DAL 层`Class Project`并将您`EDMX`或您的`POCO`实体放入其中。

3 - 我相信 Code-First 比其他更好。依靠我使用 POCO 实体的实验可以帮助您更多地使用各种数据库引擎。

通常，选择您要使用的女巫方法取决于您的项目情况。对于大型项目，我推荐 Code-First 方法。但请记住，在所有 EF 方法中，您必须注意查询。

EX：在新程序员代码中看到的一个大错误：

代码 1：

```
DataContext.Table1.ToList().Where(x => x.Username == "Ali") 
```

代码 2：

```
DataContext.Table1.Where(x => x.Username == "Ali").ToList() 
```

第一个代码获取所有记录然后获取其中一个，但是第二个代码只获取一个记录，如果您的 Table1 有 1000 万条记录，则会发生一个可怕的错误:))。所以在开发项目时要注意这些错误。选择你的方法更重要:)

祝你好运

# c# - 将数据库的多个更新合并为一个？

> ID：14243124
> 
> 赞同：0
> 
> 时间：2013-01-09T17:36:24.273
> 
> 标签：c#, .net, mysql, performance, odbc

我对 100,000 个文件进行了 foreach，每个文件都将被加载，然后将使用新数据针对 MySQL 数据库运行大约 10 个存储过程。

对于每个文件，与数据库的连接将打开和关闭。

问题是这非常慢。我试图使它成为多线程的，但 Odbc 命令会在打开连接或关闭连接的一小会后冻结。

无论如何将所有更新组合到一个脚本中而不会对代码进行太多更改并在数据库上运行一个大型脚本？

此致

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-09T17:57:59.933

您可以使用 SqlBulkCopy 类。这是一些关于此的文字：

[https://www.google.com/url?sa=t&rct=j&q=&esrc=s&source=web&cd=3&cad=rja&ved=0CEAQFjAC&url=http%3A%2F%2Fwww.codeproject.com%2FArticles%2F18418%2FTransferring-Data-使用-SqlBulkCopy&ei=eK_tULK_KtHVsgbv3IGACw&usg=AFQjCNGchoZ0gGPZ3Bcnd-8zRfolZ9xfiQ&sig2=pY4JuHwNhGsqLN8Tz5Fspg&bvm=bv.1357316858,d.Yms](https://www.google.com/url?sa=t&rct=j&q=&esrc=s&source=web&cd=3&cad=rja&ved=0CEAQFjAC&url=http://www.codeproject.com/Articles/18418/Transferring-Data-Using-SqlBulkCopy&ei=eK_tULK_KtHVsgbv3IGACw&usg=AFQjCNGchoZ0gGPZ3Bcnd-8zRfolZ9xfiQ&sig2=pY4JuHwNhGsqLN8Tz5Fspg&bvm=bv.1357316858,d.Yms)

# java - 谁在关闭我的执行人？

> ID：14243127
> 
> 赞同：4
> 
> 时间：2013-01-09T17:36:27.613
> 
> 标签：java, tomcat, executorservice

我有一个使用在服务器启动时创建的执行服务的服务器：

```
simpleExecutorService = Executors.newFixedThreadPool(nThreads, new MyThreadFactory(threadFactoryName)); 
```

然后我使用执行器服务实例来执行一些任务。但过了一会儿（30分钟左右）我得到了这个：

```
java.util.concurrent.RejectedExecutionException
    at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:1768) 
```

我在[这里](http://docs.oracle.com/javase/7/docs/api/java/util/concurrent/ThreadPoolExecutor.html)读到，当执行程序关闭时，可能会发生这种情况。我从来没有关闭它，所以这怎么会发生？关于如何调试此类问题的任何想法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-09T17:38:26.237

从您链接到的同一页面：

> 当 Executor 关闭时，以及 Executor 对最大线程和工作队列容量都使用有限的界限并且饱和时，在方法 execute(java.lang.Runnable) 中提交的新任务将被拒绝。

那么也许工作队列已满并且线程数已满？

你对它在做什么有任何了解吗？通过 JMX？附加分析器？调试日志？任何事物？

# c# - 我应该尽量避免在超低延迟软件中使用“new”关键字吗？

> ID：14243128
> 
> 赞同：2
> 
> 时间：2013-01-09T17:36:38.083
> 
> 标签：c#, performance, low-latency, hft

我正在编写高频交易软件。我确实关心每一微秒。现在它是用 C# 编写的，但我很快就会迁移到 C++。

让我们考虑这样的代码

```
// Original
class Foo {
....

    // method is called from one thread only so no need to be thread-safe
    public void FrequentlyCalledMethod() {
        var actions = new List<Action>();
        for (int i = 0; i < 10; i++) {
            actions.Add(new Action(....));
        }
        // use actions, synchronous
        executor.Execute(actions);
        // now actions can be deleted
    } 
```

我想超低延迟的软件不应该过多地使用“new”关键字，所以我搬到`actions`了一个领域：

```
// Version 1
class Foo {
....

    private List<Action> actions = new List<Action>();

    // method is called from one thread only so no need to be thread-safe
    public void FrequentlyCalledMethod() {
        actions.Clear()
        for (int i = 0; i < 10; i++) {
            actions.Add(new Action { type = ActionType.AddOrder; price = 100 + i; });
        }
        // use actions, synchronous
        executor.Execute(actions);
        // now actions can be deleted
    } 
```

也许我应该尽量避免使用“new”关键字？我可以使用一些预分配对象的“池”：

```
// Version 2
class Foo {
....

    private List<Action> actions = new List<Action>();
    private Action[] actionPool = new Action[10];

    // method is called from one thread only so no need to be thread-safe
    public void FrequentlyCalledMethod() {
        actions.Clear()
        for (int i = 0; i < 10; i++) {
            var action = actionsPool[i];
            action.type = ActionType.AddOrder;
            action.price = 100 + i;
            actions.Add(action);
        }
        // use actions, synchronous
        executor.Execute(actions);
        // now actions can be deleted
    } 
```

*   我应该走多远？
*   避免有多重要`new`？
*   使用我只需要配置的预分配对象时，我会赢得什么吗？（在上面的示例中设置类型和价格）

请注意，这是超低延迟，所以让我们假设性能优于可读性、可维护性等。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-09T17:49:26.583

在 C++ 中，您不需要`new`创建范围有限的对象。

```
void FrequentlyCalledMethod() 
{
    std::vector<Action> actions;
    actions.reserve( 10 );
    for (int i = 0; i < 10; i++) 
    {
        actions.push_back( Action(....) );
    }
    // use actions, synchronous
    executor.Execute(actions);
    // now actions can be deleted
} 
```

如果`Action`是基类并且您拥有的实际类型是派生类，您将需要一个指针或智能指针和`new`此处。但是如果 Action 是一个具体的类型并且所有元素都将是这种类型，并且这种类型是默认可构造的、可复制的和可分配的，则不需要。

但总的来说，您的性能优势不太可能来自不使用新的。在 C++ 中，当它是对象的范围时，使用局部函数范围是一种很好的做法。这是因为在 C++ 中，您必须更多地关注资源管理，这是通过一种称为“RAII”的技术完成的——这本质上意味着关注如何删除资源（通过对象的析构函数）分配点。

高性能更有可能通过以下方式实现：

*   正确使用算法
*   适当的并行处理和同步技术
*   有效的缓存和惰性评估。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-09T18:46:00.843

尽管我很讨厌高频交易，但我将告诉你如何在给定的铁块上从每个线程中获得最大的性能。

[*这是*](https://scicomp.stackexchange.com/a/1870/1262)一个示例的解释，其中最初编写的程序速度提高了 730 倍。

你分阶段进行。在每个阶段，您都会发现需要花费大量时间的东西，然后将其修复。关键字是*find*，而不是*guess*。太多的人只是盯着代码，然后修复他们认为有帮助的东西，而且通常但并不总是有帮助，有些人。那是猜测。要获得真正的加速，您需要找到*所有*问题，而不仅仅是您能猜到的少数问题。

如果您的程序正在执行*new*，那么很有可能在某些时候这将是您需要修复的。但这不是唯一的事情。

这是[*它背后的理论*](https://scicomp.stackexchange.com/a/2719/1262)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-01-29T15:55:31.453

对于优秀 HFT 商店的高性能交易引擎，避免在 C++ 代码中使用 new/malloc 是基本要求。

# sql - 在 Oracle 中连接 SQL 查询的结果

> ID：14243131
> 
> 赞同：18
> 
> 时间：2013-01-09T17:36:55.290
> 
> 标签：sql, oracle, oracle10g, concatenation

我在表格中有这样的数据

```
NAME PRICE
A    2
B    3
C    5
D    9
E    5 
```

我想在一行中显示所有值；例如：

```
A,2|B,3|C,5|D,9|E,5| 
```

我将如何进行查询以在 Oracle 中为我提供这样的字符串？我不需要将它编程为某种东西；我只是想要一种方法让该行出现在结果中，以便我可以将其复制并粘贴到 Word 文档中。

我的 Oracle 版本是 10.2.0.5。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-01-09T18:39:01.270

-- 甲骨文 10g --

```
SELECT deptno, WM_CONCAT(ename) AS employees
  FROM   scott.emp
GROUP BY deptno;

Output:
     10  CLARK,MILLER,KING
     20  SMITH,FORD,ADAMS,SCOTT,JONES
     30  ALLEN,JAMES,TURNER,BLAKE,MARTIN,WARD 
```

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2014-03-26T22:23:44.480

我知道这有点晚了，但试试这个：

```
SELECT LISTAGG(CONCAT(CONCAT(NAME,','),PRICE),'|') WITHIN GROUP (ORDER BY NAME) AS CONCATDATA
FROM your_table 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-01-09T17:53:20.880

通常当我快速需要类似的东西并且我想在不使用 PL/SQL 的情况下继续使用 SQL 时，我会使用类似于下面的 hack 的东西：

```
select sys_connect_by_path(col, ', ') as concat
from
(
  select 'E' as col, 1 as seq from dual
  union
  select 'F', 2 from dual
  union
  select 'G', 3 from dual
)
where seq = 3
start with seq = 1
connect by prior seq+1 = seq 
```

这是一个分层查询，它使用“sys_connect_by_path”特殊函数，旨在获取从父级到子级的“路径”。

我们正在做的是模拟 seq=1 的记录是 seq=2 的记录的父级，因此是第四个，然后获取最后一个孩子的完整路径（在这种情况下，记录 seq = 3），这将有效地串联所有“col”列

适应您的情况：

```
select sys_connect_by_path(to_clob(col), '|') as concat
from
(
  select name || ',' || price as col, rownum as seq, max(rownum) over (partition by 1) as max_seq
  from
  (
   /* Simulating your table */
    select 'A' as name, 2 as price from dual
    union
    select 'B' as name, 3 as price from dual
    union
    select 'C' as name, 5 as price from dual
    union
    select 'D' as name, 9 as price from dual
    union
    select 'E' as name, 5 as price from dual
  )
)
where seq = max_seq
start with seq = 1
connect by prior seq+1 = seq 
```

结果是：`|A,2|B,3|C,5|D,9|E,5`

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-01-09T18:13:57.923

由于您在 Oracle 10g 中，因此您无法使用出色的`listagg()`. 但是，还有许多其他[字符串聚合技术](http://www.oracle-base.com/articles/misc/string-aggregation-techniques.php)。

没有特别需要所有复杂的东西。假设下表

```
create table a ( NAME varchar2(1), PRICE number);
insert all
into a values ('A',    2)
into a values ('B',    3)
into a values ('C',    5)
into a values ('D',    9)
into a values ('E',    5)
select * from dual 
```

不支持的功能`wm_concat`应该足够了：

```
select replace(replace(wm_concat (name || '#' || price), ',', '|'), '#', ',')
  from a;

REPLACE(REPLACE(WM_CONCAT(NAME||'#'||PRICE),',','|'),'#',',')
--------------------------------------------------------------------------------
A,2|B,3|C,5|D,9|E,5 
```

但是，您也可以在上面的链接中更改 Tom Kyte's`stragg`以在没有替换功能的情况下执行此操作。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2013-01-09T19:05:15.837

这是另一种方法，使用`model`子句：

```
-- sample of data from your question
with t1(NAME1, PRICE) as(
   select 'A',    2 from dual union all
   select 'B',    3 from dual union all
   select 'C',    5 from dual union all
   select 'D',    9 from dual union all
   select 'E',    5 from dual
) -- the query
 select Res
  from (select name1
             , price
             , rn
             , res
         from t1
         model
         dimension by (row_number() over(order by name1) rn)
         measures (name1, price, cast(null as varchar2(101)) as res)
         (res[rn] order by rn desc = name1[cv()] || ',' || price[cv()] || '|' ||  res[cv() + 1])
       )
where rn = 1 
```

结果：

```
RES
----------------------
A,2|B,3|C,5|D,9|E,5| 
```

[SQLFiddle 示例](http://www.sqlfiddle.com/#!4/4a4df/4)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2013-01-09T17:42:27.903

像下面这样的东西，效率极低且未经测试。

```
 create function foo returning varchar2  as  
    (    
        declare bar varchar2(8000) --arbitrary number
        CURSOR cur IS
        SELECT name,price  
        from my_table  
        LOOP

    FETCH cur INTO r;

    EXIT WHEN cur%NOTFOUND;

       bar:= r.name|| ',' ||r.price || '|'

  END LOOP;  
  dbms_output.put_line(bar);
       return bar
    ) 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2013-01-09T18:02:23.200

使用 xmlagg 设法到达这里：使用 sql fiddle 中的 oracle 11G。

数据表：

```
COL1    COL2    COL3
1       0       0
1       1       1
2       0       0
3       0       0
3       1       0

SELECT
    RTRIM(REPLACE(REPLACE(
      XMLAgg(XMLElement("x", col1,',', col2, col3)

ORDER BY col1), '<x>'), '</x>', '|')) AS COLS
  FROM ab
; 
```

结果：

```
COLS
1,00| 3,00| 2,00| 1,11| 3,10| 
```

## * [SQLFIDDLE 演示](http://sqlfiddle.com/#!4/bfd9a/26)

*   [参考阅读 XMLAGG](http://docs.oracle.com/cd/B19306_01/server.102/b14200/functions215.htm)

# php - WAMP localhost 上的 Wordpress 不允许安装模板

> ID：14243134
> 
> 赞同：0
> 
> 时间：2013-01-09T17:37:12.650
> 
> 标签：php, wordpress, themes, localhost, runtime-error

我在这里遇到了 Wordpress 主题的问题，无论我尝试安装什么主题，我都会收到错误消息。

```
Fatal error: Call to undefined function of_get_option() in C:\wamp\www\wp-content\themes\Monaco\slide.php on line 4
Call Stack
#   Time    Memory  Function    Location
1   0.0007  669088  {main}( )   ..\index.php:0
2   0.0011  673872  require( 'C:\wamp\www\wp-blog-header.php' ) ..\index.php:17
3   0.4489  27395224    require_once( 'C:\wamp\www\wp-includes\template-loader.php' )   ..\wp-blog-header.php:16
4   0.4516  27410496    include( 'C:\wamp\www\wp-content\themes\Monaco\index.php' ) ..\template-loader.php:47
5   0.4787  27444544    get_template_part( )    ..\index.php:17
6   0.4787  27445320    locate_template( )  ..\general-template.php:128
7   0.4791  27445432    load_template( )    ..\template.php:381
8   0.4796  27472472    require( 'C:\wamp\www\wp-content\themes\Monaco\slide.php' ) ..\template.php:407 
```

我对这个问题感到非常沮丧，无法弄清楚可能是什么原因造成的。我重新安装了 Wordpress 两次并尝试了不同的模板，但仍然不行。它似乎与 Wordpress 包含的主题相得益彰，但与其他任何主题都无济于事。

谁能帮帮我。先感谢您。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-09T17:46:29.450

该问题肯定与您尝试安装的主题有关。它们指的`of_get_option()`是标准 WordPress 安装中不存在的函数 ( )。

幸运的是，这里有一个类似问题的论坛帖子：[WP Support Forums](http://wordpress.org/support/topic/of_get_option-equal-to-get_option)。

该功能属于插件。希望这可以帮助。

# vb.net - GC 未释放 VB.NET 内存

> ID：14243143
> 
> 赞同：0
> 
> 时间：2013-01-09T17:37:50.140
> 
> 标签：vb.net, out-of-memory, garbage

我有一小段代码，我希望GC在某个时候会擦除内存，而不是内存不足。

这是 GC 的正确行为吗？

```
Private Sub Form1_Load()
   Dim WasterWrapper as cMyClass
   For MapIndex = 1 To 50
      WasterWrapper = New cMyClass
   Next
End Sub 
```

这是分配内存的类

```
Public Class cMyClass

Private mArry(,) As Double

Sub New()

    Dim i As Integer
    Dim j As Integer

    ReDim mArry(5000, 5000)

    For i = 0 To 5000
        For j = 0 To 5000
            mArry(i, j) = Rnd() * 1000
        Next
    Next

End Sub

Protected Overrides Sub Finalize()

    MsgBox("Finalising the wrapper")
    MyBase.Finalize()

End Sub
End Class 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-10T07:47:29.023

在我删除 Finalize() 之后，GC 可以按照我的预期释放内存。

感谢您的提示。

# grails - 由于 JNDI 查找，无法在 Grails 集成测试中初始化服务

> ID：14243146
> 
> 赞同：0
> 
> 时间：2013-01-09T17:38:07.327
> 
> 标签：grails, service, groovy, jndi, integration-testing

我有一个实现 InitializingBean 和 DisposableBean 的服务

```
class MyService implements InitializingBean, DisposableBean {

    static transactional = false

    def grailsApplication

    @Override
    void afterPropertiesSet() {
        System.setProperty("JMS_TIMEOUT", grailsApplication.config.JMS_TIMEOUT);
        // code performing a JDNI lookup
    }
}
enter code here 
```

系统属性用于初始化服务中的一些其他组件。我已经在 Config.groovy 中添加了配置。

```
grails.config.locations = [ "file:${basedir}/grails-app/conf/myconfig.properties" ] 
```

这在运行应用程序时工作正常。但是，我正在测试/集成中编写一个注入服务的集成测试。

```
class MyServiceIntegrationTests  extends GrailsUnitTestCase {

   def myService

   void testMyService() {

   }
} 
```

运行测试时，我得到一个 StackTrace，其根本原因如下：

```
Caused by: javax.naming.NameNotFoundException: Name [ConnectionFactory] not bound; 0 bindings: []
at javax.naming.InitialContext.lookup(InitialContext.java:354)
at com.ubs.ecredit.common.jmsclient.DefaultConnector.<init>(DefaultConnector.java:36) 
```

似乎无法加载配置或在集成测试中有所不同。知道如何更改配置或代码，以便在实例化服务之前也为我的集成测试设置这些属性吗？

**UPDATE:** It turned out the cause was not the configurations but a JDNI lookup and a bug in Grails. See: [http://jira.grails.org/browse/GRAILS-5726](http://jira.grails.org/browse/GRAILS-5726)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-10T03:23:37.027

`${basedir}` gets different paths in different environments. As an alternative, you can use `PropertiesLoaderUtils.loadProperties` to load your customized configurations:

```
import org.springframework.core.io.support.PropertiesLoaderUtils
import org.springframework.core.io.ClassPathResource
....
void afterPropertiesSet() {
    def configProperties = PropertiesLoaderUtils.loadProperties(
                   new ClassPathResource("myconfig.properties"))
    System.setProperty("JMS_TIMEOUT", configProperties.getProperty("JMS_TIMEOUT"))
    ....
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-16T14:35:20.873

It turned out the cause was a JNDI lookup used by a library method, I have not shown in afterPropertiesSet() in my Service, which can be seen in the StackTrace.

After doing some research I found that this was a bug in Grails: [http://jira.grails.org/browse/GRAILS-5726](http://jira.grails.org/browse/GRAILS-5726)

Adding the mentioned workaround, resolved the issue for now.

# mfc - 无法让 CImage 在 Visual C++ 2005 (MFC) 中工作

> ID：14243147
> 
> 赞同：0
> 
> 时间：2013-01-09T17:38:08.500
> 
> 标签：mfc, visual-c++-2005

我正在使用 MSDN 中的示例，但我得到“'CImage'：未声明的标识符”？

```
CImage myimage;
   // load existing image
   myimage.Load("image.bmp"); 
      // save an image in BMP format
   myimage.Save("c:\image1.bmp");
   // save an image in BMP format
   myimage.Save("c:\image2",ImageFormatBMP);
   // save an image in JPEG format
   myimage.Save("c:\image3.jpg");
   // save an image in BMP format, even though jpg file extension is used
   myimage.Save("c:\image4.jpg",ImageFormatBMP); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-09T17:39:53.660

的[文档`CImage`](http://msdn.microsoft.com/en-us/library/bwea7by5%28v=vs.100%29.aspx)显示它是在`atlimage.h`. 你必须`#include`在你的源代码中。另请注意必须首先包含的警告`afxstr.h`以避免错误。

# sql-server - 对于不存在列的表，忽略“无效的列名”

> ID：14243150
> 
> 赞同：2
> 
> 时间：2013-01-09T17:38:22.730
> 
> 标签：sql-server

是否可以告诉 sql server（在查询中）如果表中不存在列可以忽略它？

用例是：
一些表有一个`isDeleted`列，但不是全部。
在整个应用程序中不返回记录 where `isDeleted`is `TRUE`。

理想情况下，最好在我们的应用程序的最低级别添加它，以便所有查询都包含`AND isDeleted=FALSE`，但如果该`isDeleted`列不存在，则不会中断查询。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-09T17:39:53.987

> 是否可以告诉 sql server（在查询中）如果表中不存在列可以忽略它？

不，没有。

SQL 数据库有模式是有原因的——作为程序员，正确查询数据库是您的责任。

您需要确保只查询`isDeleted`定义它的表上的列。

# java - Java 数组，打印其他内容

> ID：14243153
> 
> 赞同：0
> 
> 时间：2013-01-09T17:38:31.793
> 
> 标签：java, arrays, println

我正在尝试打印数组中的项目，但是当我运行程序时，它会打印出 Orders:`testorder@4, testorder@5`等等。关于如何修复它以使其写入 123 Buy 的任何提示？

```
package hej;

public class TestOrder {
public static void main(String[] args) {

    Order order1 = new Order("123", "Buy");
    Order order2 = new Order("456", "Sell");
    Order order3= new Order("231", "Buy");
    Order order4= new Order("987", "Buy");

    OrderRegister orderregister = new OrderRegister();

    orderregister.addOrder(order1);
    orderregister.addOrder(order2);
    orderregister.addOrder(order3);
    orderregister.addOrder(order4);

    System.out.println("Orders: ");        
    for (int i = 0; i < orderregister.getArrayList().size(); i++){
        System.out.println(orderregister.getArrayList().get(i) + "-");

    }
} 
```

}

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-09T17:40:02.193

因为您没有为您的类`toString()`定义方法。`Order`

当 Java 尝试打印一个 Object 时，它会尝试调用该`toString()`Object 的方法，如果找不到，它会使用`toString()`Object 超类中的方法。

默认情况下，对象会这样做`toString()`：

```
getClass().getName() + '@' + Integer.toHexString(hashCode()) 
```

这正是您所看到的输出。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-09T17:40:16.780

已`TestOrder`覆盖该`toString()`方法。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-09T17:40:26.563

当您将对象与字符串连接时（就像在您的`System.out.println(...)`语句中一样），`toString()`首先在对象上调用该方法以将其转换为字符串。

您需要覆盖类`toString()`上的方法`Order`并让它生成订单的字符串形式。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-01-09T17:40:37.220

这正是您应该期待的，因为您还没有告诉 Java 任何其他方式将 an 转换`Order`为 a `String`。如果`Order.toString()`您希望 Java 使用某种特定方式将 a 转换`Order`为`String`.

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-01-09T17:50:51.953

您可以/应该尝试`toString()`按照其他人的建议覆盖该方法（在您的示例中隐式调用）。

例如：

```
@Override public String toString()
{
return String.format("%s , %s", this.getID(), this.getAction());
} 
```

# css - 进度条动画仅适用于 IE10

> ID：14243155
> 
> 赞同：0
> 
> 时间：2013-01-09T17:38:47.900
> 
> 标签：css, microsoft-metro

我碰巧发布了一个关于outlook.com 提出的线性动画的问题，我们这里的一些朋友告诉我这是不可能的。我能够使用 CSS3 关键帧来实现这一点。但是，它似乎只在 IE10 中有效，在 Firefox 和 Chrome 中无效。我已经为 w3schools 的 Firefox 和 chrome 放置了备用标签，但我仍然不确定它为什么不起作用。这是来自 jsfiddle 的链接，其中包含我的代码。我也放了github链接以防万一。请在这方面帮助我。

[JSFiddle](http://jsfiddle.net/usaipavan/Zjwvf/)

[Github](https://raw.github.com/USaiPavan/WebAppPlayground/master/WebAppPlayground/AnimatedDots.html)

我的部分代码如下。对每个 .(dot) 重复此代码，但时间略有变化。有5个这样的点。

```
 .linearAnimate1
{
    animation-delay: 0s;
    -moz-animation-delay:0s; /* Firefox */
    -webkit-animation-delay:0s; /* Safari and Chrome */
    animation-duration: 10s;
    -moz-animation-duration:10s; /* Firefox */
    -webkit-animation-duration:10s; /* Safari and Chrome */
    animation-iteration-count: infinite;
    -moz-animation-iteration-count:infinite; /* Firefox */
    -webkit-animation-iteration-count:infinite; /*Safari and Chrome*/
    animation-name: makedotspin1;
    -moz-animation-name: makedotspin1;
    -webkit-animation-name: makedotspin1;

}

@keyframes makedotspin1 {
    from {
      animation-timing-function: ease;
      -moz-animation-timing-function:ease; /* Firefox */
      -webkit-animation-timing-function:ease; /* Safari and Chrome */
      transform: translateX(0px);
      -moz-transform: translateX(0px);
      -webkit-transform: translateX(0px);
      visibility:visible;
    }
    25% {
      animation-timing-function: ease-in;
      -moz-animation-timing-function:ease-in; /* Firefox */
      -webkit-animation-timing-function:ease-in; /* Safari and Chrome */
      transform: translateX(450px);
      -moz-transform: translateX(450px);
      -webkit-transform: translateX(450px);          
      animation-delay: 0.5s;
      -moz-animation-delay: 0.5s;
      -webkit-animation-delay: 0.5s;

    }
    50% {
      animation-timing-function: ease-inout;
      transform: translateX(900px);
      -moz-transform: translateX(900px);
      -webkit-transform: translateX(900px);
      visibility:hidden;
      animation-delay: 10s;
      -moz-animation-delay: 10s;
      -webkit-animation-delay: 10s;
    }
    to
    {
    }
} 
```

[动画按钮 Metro 风格进度条](https://stackoverflow.com/questions/14236783/animated-buttons-metro-style-progress-bar)（显示它不仅可以使用 gif

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-09T18:08:59.653

我相信您需要为不同的布局引擎添加 @keyframes 前缀，例如：

@-webkit-keyframes {} @-moz-keyframes

等，IE10 工作，因为它支持官方规范

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-10T16:44:22.043

最后我发现了这个问题。由于我使用了无序列表，因此我使用了以下 CSS

```
 ul li
    {
        display: inline;       
        font-size:4em; 
        visibility:hidden;   
    } 
```

但是，Mozilla 和 chrome 无法做动画，因​​为显示是内联的，并且所有列表项都在彼此的顶部。为了解决这个问题，我必须做两件事 1）我必须为关键帧添加 -moz- 和 -webkit- 前缀 2）如下所示将显示更改为 inline-block 并解决了问题。现在动画可以在 Mozilla、IE 和 Chrome 上运行

```
 ul li
    {
        display: inline-block;       
        font-size:4em; 
        visibility:hidden;   
    } 
```

# struts2 - 在struts 2中显示表格标签

> ID：14243158
> 
> 赞同：1
> 
> 时间：2013-01-09T17:39:04.890
> 
> 标签：struts2

```
<display:table export="true"  id="data" name="${sessionScope.forbesList}"requestURI="">

                <a href="#" rel="tooltip" content="<span>

                        Name:<s:property value="#data.rank" /><br/>
                        Email: <a><s:property value="#data.name" /></a><br/>
                        Phone:<s:property value="#data.age" /> </span>">   <display:column property="rank" title="Rank" sortable="true"   /></a>
        <display:column property="name" title="Name" sortable="true"  />
        <display:column property="age" title="Age" sortable="true"  />

    </display:table> 
```

在 Struts 2 中，我尝试在`<s:property>`标签内使用标签，`<display :column>`但我只能看到`<display:column>`值，而不是我访问的值`<s:property>`。怎么做？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-09T19:00:13.590

#1: Anchor (`<A>`) Tag does not have any `content` attribute.

Please refer to [the documentation](http://www.htmlquick.com/reference/tags/a.html) to see which attributes it supports and how to use them.

* * *

#2: in HTML, when putting the character `"` into an attribute of a Tag, you can:

*   substitute `"` with `'`, like in
    *   `myAttribute="this is 'right'"` or
    *   `myAttribute='this is "right" too'`, or
*   encode the `"` with the html entity `&quot;`, like in
    *   `myAttribute="this is &quot;right&quot;"`

You must encode the `<` and `>` too, with `&lt;` (Less Than) or `&gt;` (Greater Than).

* * *

#3: that said, you could put your HTML inside the Anchor Tag, in the place where it is supposed to be inserted, like :

```
<a href="#" rel="tooltip"> 
      Name:<s:property value="#data.rank" />
</a> 
```

but, in your case, you are injecting a lot of HTML, including *another* Anchor, that is not possible. I think you should simply use a div or something similar as a container, like:

```
<div rel="tooltip" >
   <span>
      Name:<s:property value="#data.rank" /><br/>
      Email: <a><s:property value="#data.name" /></a><br/>
      Phone:<s:property value="#data.age" /> 
   </span>
</div> 
```

Resolve this before worrying about DisplayTag

* * *

**EDIT**

#4 Change

```
<s:property value="#data.rank" /> 
```

(and all the other tags) to

```
<s:property value="#attr.data.rank" /> 
```

`#attr` is the OGNL used to access the `pageContext`,

if it is available, otherwise it searches request, session and application scopes.

# java - 无法绑定到 web 服务：java.lang.StackTraceElement 没有无参数默认构造函数

> ID：14243159
> 
> 赞同：1
> 
> 时间：2013-01-09T17:39:08.453
> 
> 标签：java, spring, jax-ws

我正在尝试绑定到在托管在 JBoss 服务器上的测试环境中运行的现有遗留 web 服务，但由于以下异常，Spring 无法创建 bean：

```
Caused by: javax.xml.ws.WebServiceException: Unable to create JAXBContext
    at com.sun.xml.internal.ws.model.AbstractSEIModelImpl.createJAXBContext(AbstractSEIModelImpl.java:153)
    at com.sun.xml.internal.ws.model.AbstractSEIModelImpl.postProcess(AbstractSEIModelImpl.java:83)
    at com.sun.xml.internal.ws.model.RuntimeModeler.buildRuntimeModel(RuntimeModeler.java:244)
    at com.sun.xml.internal.ws.client.WSServiceDelegate.createSEIPortInfo(WSServiceDelegate.java:687)
    at com.sun.xml.internal.ws.client.WSServiceDelegate.addSEI(WSServiceDelegate.java:675)
    at com.sun.xml.internal.ws.client.WSServiceDelegate.getPort(WSServiceDelegate.java:330)
    at com.sun.xml.internal.ws.client.WSServiceDelegate.getPort(WSServiceDelegate.java:313)
    at com.sun.xml.internal.ws.client.WSServiceDelegate.getPort(WSServiceDelegate.java:295)
    at javax.xml.ws.Service.getPort(Service.java:92)
    at org.springframework.remoting.jaxws.JaxWsPortClientInterceptor.getPortStub(JaxWsPortClientInterceptor.java:413)
    at org.springframework.remoting.jaxws.JaxWsPortClientInterceptor.prepare(JaxWsPortClientInterceptor.java:337)
    at org.springframework.remoting.jaxws.JaxWsPortClientInterceptor.afterPropertiesSet(JaxWsPortClientInterceptor.java:316)
    at org.springframework.remoting.jaxws.JaxWsPortProxyFactoryBean.afterPropertiesSet(JaxWsPortProxyFactoryBean.java:42)
    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.invokeInitMethods(AbstractAutowireCapableBeanFactory.java:1514)
    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.initializeBean(AbstractAutowireCapableBeanFactory.java:1452)
    ... 38 more
Caused by: java.security.PrivilegedActionException: com.sun.xml.internal.bind.v2.runtime.IllegalAnnotationsException: 1 counts of IllegalAnnotationExceptions
java.lang.StackTraceElement does not have a no-arg default constructor.
    this problem is related to the following location:
        at java.lang.StackTraceElement
        at public java.lang.StackTraceElement[] java.lang.Throwable.getStackTrace()
        at java.lang.Throwable
        at java.lang.Exception
        at uk.co.example.UserException
        at public javax.xml.bind.JAXBElement uk.co.example.ObjectFactory.createUserException(uk.co.example.UserException)
        at uk.co.example.ObjectFactory

    at java.security.AccessController.doPrivileged(Native Method)
    at com.sun.xml.internal.ws.model.AbstractSEIModelImpl.createJAXBContext(AbstractSEIModelImpl.java:140) 
```

我通过 Spring xml 绑定到 web 服务：

```
<bean id="auth1" class="org.springframework.remoting.jaxws.JaxWsPortProxyFactoryBean">
    <property name="serviceInterface" value="uk.co.example.Authentication" />
    <property name="wsdlDocumentUrl" value="http://testdomain.co.uk:30001/services/authentication?wsdl" />
    <property name="namespaceUri" value="http://example.co.uk/" />
    <property name="serviceName" value="AuthenticationWebServiceService" />
    <property name="portName" value="AuthenticationPort" />
    <property name="maintainSession" value="true" />
</bean> 
```

我的 UserException 只是扩展了 java.lang.Exception：

```
public class UserException extends Exception
{

} 
```

所以我的 web 服务包含一个声明抛出 UserException 的方法。UserException 扩展了 java.lang.Exception，其中包含对没有无参数构造函数的 StackTraceElement 的引用。因此出现了 JAXB 异常。我从其他一些关于这个问题的帖子中得到了这么多。

我不明白的是：为什么这个特定的 web 服务和这个特定的异常类？当然，我如何纠正这个问题？

我的 web 服务引发了许多其他异常（大多数似乎扩展了 java.lang.Exception）。在同一个 JBoss 服务器中运行的另一个 web 服务（它不会抛出 UserException，但会抛出其他定制的 Exception 子类）工作正常。2 组不同的 Web 服务具有不同的客户端 jar。

我只是创建了一个 Eclipse Maven 项目，引入了 Spring 测试和 web jar (v3.1.0)、junit 和 log4j。2 个客户端 jars（作为旧版本的一部分预先存在）也在类路径中。我创建了一个 Junit，它将代理 bean 自动装配为 Authentication 接口并在其上调用 authenticateUser() 方法。

因为它是遗留代码，所以我无法更改正在运行的 Web 服务或生成的客户端 jar 中的任何内容。

有什么建议么？

在谈到 web 服务以及我们的遗留代码是如何构建和部署时，我承认我有点新手，所以不要害怕问任何你认为可能太明显的问题！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-09T20:26:56.627

如果您无法更改客户端或服务器代码，您仍然可以编写自己的客户端来扩展现有客户端并尝试在[其中添加自定义 JAXB 绑定](http://docs.oracle.com/cd/E17802_01/webservices/webservices/docs/2.0/tutorial/doc/JAXBUsing4.html)。

# wpf - 如何只为 TreeView 的第一级设置 ItemContainerStyle？

> ID：14243163
> 
> 赞同：1
> 
> 时间：2013-01-09T17:39:24.297
> 
> 标签：wpf, treeview, wpf-controls, itemcontainerstyle

我只想更改`ItemContainerStyle`第一级的项目。并为更深层次保留默认样式。有可能吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-09T17:57:01.203

是的，您将创建一个自定义项，该自定义[`StyleSelector`](http://msdn.microsoft.com/en-us/library/system.windows.controls.itemscontrol.itemcontainerstyleselector.aspx)项可以根据您决定的任何标准选择不同的样式。在您的情况下，您需要检查哪个`ItemsControl`拥有容器（如在 a 中`TreeView`，每个`TreeViewItem`都是 a `ItemsControl`，并拥有其子级）。

```
public class TreeViewFirstItemStyleSelector : StyleSelector
{
    public override Style SelectStyle(object item, DependencyObject container)
    {
        var element = container as TreeViewItem;
        if (element != null && ItemsControl.GetItemsOwner(element) is TreeView)
            return element.FindResource("customStyle") as Style;

        return null;
    }
} 
```

然后将它设置在 TreeView 的 ItemContainerStyleSelector 属性上。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-09T17:52:18.313

`Style` `Trigger`如果它们是第一个元素，则应该使用s 和测试项目。这段代码只是一个想法：

```
<Style.Triggers>
                <Trigger Property="IsFirst" Value="True">
                    <Setter Property="Color" Value="Red" />
                </Trigger> 
```

# ios - Xcode InterfaceBuilder 模拟具有自定义高度的导航栏的指标

> ID：14243170
> 
> 赞同：1
> 
> 时间：2013-01-09T17:39:53.437
> 
> 标签：ios, interface-builder, uinavigationbar

我有一个项目，其中在整个应用程序中使用自定义高度导航栏，因此它是 62 像素而不是 44 像素高。我正在尝试使用情节提要编辑器（界面构建器）构建和布局我的视图，尽管在视图控制器选项下的模拟指标下使用设置为导航栏的顶部栏属性时，这变成了默认的 44 像素而不是自定义的我想要的高度导航栏（64px）。

这样，所有视图工作区都以不同的大小显示，我总是需要计算什么会超出或不会超出。

有什么方法可以优雅地使用模拟指标和自定义高度导航栏子类，同时保持我必须在剩余空间上工作的确切高度？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-17T18:54:27.113

无法通过 Xcode 将 Simulated Metrics 更改为自定义值。一种可能性是设计自定义导航栏并将其复制到任何地方而不是导航，但是不再模拟它。或者你可以通过进入

```
/Applications/Xcode.app/Contents/Developer/Platforms/iPhoneSimulator.platform/Developer/Library/Xcode/PrivatePlugIns/IDEInterfaceBuilderCocoaTouchIntegration.ideplugin/Contents/Resources 
```

并打开`CocoaTouchConstraints.plist` 在此文件中，您可以将 的值设置`NavigationBar`为所需的值。因此，如果您想要一个 60 高的导航栏，只需将最大和最小高度设置为 60：

```
<key>NavigationBar</key>
    <dict>
        <key>MaximumSize</key>
        <string>{10000, 60}</string>
        <key>MinimumSize</key>
        <string>{0, 60}</string>
    </dict> 
```

保存后，您需要**重新启动 Xcode**，您的 NavigationBar 将具有所需的高度。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-19T05:00:37.343

恐怕你不能真正做到这一点，如果你想直接在界面构建中拥有类似的行为和正确的自动布局和约束，为你的自定义导航栏类​​添加一个具有正确指标的简单视图，（它只会工作很好，因为导航栏继承自 UIView）只需添加视图，设置自定义类，并为导航栏和视图的顶部对象添加约束。

# algorithm - 理解大 O 符号

> ID：14243176
> 
> 赞同：1
> 
> 时间：2013-01-09T17:40:02.970
> 
> 标签：algorithm, big-o

一些关于算法的标准书籍产生了这一点：

> 0 ≤ f( *n* ) ≤ c⋅g( *n* ) 对于所有*n* > *n* [0]

在定义 big-O 时，谁能向我解释这意味着什么，使用一个可以帮助我更准确地可视化和理解 big-O 的强大示例？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-09T19:12:50.957

假设您有一个函数`f(n)`并且您正在尝试对它进行分类 - 它是不是某个其他函数的大`g(n)`O。

定义基本上说`f(n)`如果`O(g(n))`存在两个常数 C,N 使得

```
f(n) <= c * g(n) for each n > N 
```

现在，让我们了解它的含义。

从部分开始`n>N`- 这意味着，我们不“关心” 的低值`n`，我们只关心高值，如果某些（最终数量）低值不符合标准 - 我们可以通过选择`N`更大来默默地忽略它们然后他们。

看看下面的例子：

![在此处输入图像描述](../Images/0d9d14b972d951ec6a3099350d5c13b9.png)

虽然我们可以看到，对于 n: 的低值`n^2 < 10nlog(n)`，第二个很快赶上，并且在`N=10`我们得到所有`n>10`声明之后`10nlog(n) < n^2`是正确的，因此`10nlog(n)`在`O(n^2)`. 常数`c`意味着我们也可以通过常数因子容忍一些倍数，并且我们仍然可以接受它作为期望的行为（例如，用于证明`5*n`is `O(n)`，因为没有它我们永远无法为每个: 找到`N`这样的，但是有了常数，我们可以使用 c=6 并显示并获取.`n > N``5n < n``c``5n < 6n``5n``O(n)`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-09T18:28:02.710

这个问题是一道数学题，不是算法题。

你可以在这里找到一个定义和一个很好的例子：[https ://math.stackexchange.com/questions/259063/big-o-interpretation](https://math.stackexchange.com/questions/259063/big-o-interpretation)

正如@Thomas 指出的那样，维基百科也有一篇很好的文章：[http ://en.wikipedia.org/wiki/Big_O_notation](http://en.wikipedia.org/wiki/Big_O_notation)

如果您需要更多详细信息，请尝试提出更具体的问题。

# google-bigquery - 谷歌大查询：导出表到自己的存储桶导致意外错误

> ID：14243177
> 
> 赞同：3
> 
> 时间：2013-01-09T17:40:10.967
> 
> 标签：google-bigquery, google-cloud-storage

我一直试图将表格导出到我的谷歌云存储桶。

示例作业 ID：job_0463426872a645bea8157604780d060d

我尝试了许多不同变化的云存储目标，都显示相同的错误。如果我尝试复制出生报告，它会起作用。

我究竟做错了什么？

谢谢！

丹尼尔

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-09T19:24:56.967

看起来错误说：“表太大而无法导出到单个文件。指定一个包含 * 的 uri 来分片导出。” 尝试将目标 URI 切换为类似`gs://foo/bar/baz*`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-06-12T12:44:36.013

指定文件扩展名和模式。例子

```
gs://foo/bar/baz*.gz in case of GZIP (compressed)

gs://foo/bar/baz*.csv in case of csv (uncompressed) 
```

> foo 目录是存储桶名称，bar 目录可以是您的日期，可以是动态生成的字符串格式。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-11-17T13:55:36.770

我能够做到这一点：

```
bq extract --destination_format=NEWLINE_DELIMITED_JSON myproject:mydataset.mypartition gs://mybucket/mydataset/mypartition/{*}.json 
```

# mysql - 从 MySQL 上的数据库列中选择带有 LIMIT 的查询

> ID：14243181
> 
> 赞同：1
> 
> 时间：2013-01-09T17:40:21.330
> 
> 标签：mysql, sql, database

我有 2 张桌子：

```
user          messages
+---------+   +----------------+
|id|credit|   |id|user_id| ... |
+---------+   +----------------+
|01| 05   |   |01| 01    | ... |
|02| 01   |   |02| 01    | ... |
|03| 00   |   |03| 01    | ... |
+---------+   |04| 02    | ... |
              |05| 02    | ... |
              |06| 03    | ... |
              +----------------+ 
```

我需要从**n=user.credit的***消息*中选择**n**条消息。我想执行如下查询的查询：

 ***```
SELECT * 
FROM user u JOIN messages m ON u.id = m.user_id LIMIT u.credit 
WHERE user in ...; 
```

并且应该返回第 01、02、03、04 行，而不是 05、06 行。

我知道我不能写`LIMIT u.credit`但想要这种行为，根据他们拥有的信用值限制为每个用户获取的消息数量（用户 01 的限制为 5，用户 02 的限制为 1 等等）和我想一次获取所有消息，以避免必须为每个用户执行 COUNT 和 SELECT 。

我将 MySQL 与 InnoDB 一起使用

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-09T17:55:44.917

这是纯 SQL 的解决方案，不使用变量：

```
select user.*, messages.*
from user inner join messages
     on user.id=messages.user_id
where (select count(*) from messages m
       where m.user_id=user.id
       and m.id<messages.id)<user.credit 
```

## [演示](http://sqlfiddle.com/#!2/a4b85/14)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-09T18:07:33.820

恐怕这会很慢：

```
SELECT u.*
     , m.*
FROM 
    user AS u 
  JOIN
    ( SELECT m1.*, COUNT(*) AS cnt
      FROM messages m1
        JOIN messages m2
          ON  m2.user_id = m1.user_id 
          AND m2.id <= m1.id
      GROUP BY m1.user_id, m1.id 
    ) m 
      ON  m.user_id = u.id 
      AND m.cnt <= u.credit ; 
```

# [演示](http://sqlfiddle.com/#!2/a4b85/19)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-09T17:54:52.327

如果你下定决心，有一种方法可以在 SQL 中做到这一点。

```
SELECT u.* 
FROM user u JOIN messages m ON u.id = m.user_id
  inner join user u2 on u2.id <= u.id
WHERE user in ...
GROUP BY u.id
HAVING count(u2.id) < u.credit 
```***

# c++ - 无效向量 下标

> ID：14243185
> 
> 赞同：1
> 
> 时间：2013-01-09T17:40:28.447
> 
> 标签：c++, visual-studio-2010, vector, complex-numbers, subscript

我正在尝试制作一个二维向量，其中 0 和 1 坐标都是复数，定义向量似乎工作正常，但是当我尝试访问它时，我收到一个错误，在新选项卡中弹出一堆乱七八糟的东西，但在那里的某个地方说矢量下标无效。（删节的）代码是

```
#include <iostream>     
#include <vector>
#include <complex>
using namespace std;
int main() 
{
vector<vector<complex<double>>> rho;
for(int g = 0; g < 4; ++g){
    for(int h = 0; h < 4; ++h){
        rho.push_back(vector<complex<double>>(2));
        rho.at(g).at(h) = 0;
        cout << rho.at(g).at(h)<<endl;
    }
}
} 
```

任何帮助将不胜感激:) xx

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2019-05-23T14:13:02.860

6年前提出的问题。

有一个无效的下标，因为您有一个包含内部向量的外部向量。您的外部向量在内循环上添加了一个新向量，因此您正在推回许多大小为 2 的向量，h 范围从 0 到 3，并且 2 和 3 是所有内部向量的无效下标。

不幸的是，这是那些“无用的无上下文”错误之一。如果它至少说“大小为 2 的向量的下标 2 无效”会更有用

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-01-09T17:47:49.640

我认为对于 C++，尖括号需要用空格分隔。当我这样做时，代码会按原样工作。看这个

```
#include <iostream>
#include <vector>
#include <complex>
using namespace std;

int main()
{
    int g = 0;
    int h = 0;
    vector<vector<complex<double > > > rho;
    rho.push_back(vector<complex<double > >(2));
    rho.at(g).at(h) = 0;
    cout << rho.at(g).at(h)<<endl;
} 
```

# c++ - 有没有人能够在使用共享 DLL 的 Windows 64 位应用程序上集成 tcmalloc？

> ID：14243186
> 
> 赞同：5
> 
> 时间：2013-01-09T17:40:29.740
> 
> 标签：c++, memory-leak-detector, tcmalloc

我有一个 64 位 Visual Studio 2010（单线程）C++ Windows 应用程序，我正在尝试将 tcmalloc 与之集成，并且在使用我们的任何动态链接的 dll 时遇到问题。我将 tcmalloc 链接为静态库。在应用程序开始使用我们共享的 dll 之一之前，tcmalloc 工作得很好。我将解决方案构建为 64 位调试应用程序。所有 dll 与 CRT 库的 C/C++ 调试版本（MSVCP100D.dll 和 MVCR100D.dll）的链接。

下面是失败的代码示例。tcmalloc 被调用来分配所有的内存，但是当 delete 被调用时，应用程序崩溃了。我真的很困惑，因为当我在主可执行文件中创建一个函数并将代码复制到那里时，完全相同的代码可以正常工作。

如果有人对在这种情况下使用 tcmalloc 有任何经验，我将不胜感激您的反馈。这对我来说是个谜。它是 dll 的内存模型问题（不同的堆？？）？我不知道。在我看来，他们使用的是同一个堆。

对不起，如果这篇文章太长。我试图提供尽可能多的信息。

谢谢你。

布鲁斯

更新：作为测试，我将崩溃的共享 dll 更改为静态库，并且一切正常，直到应用程序使用不同的 dll。因此，无论出于何种原因，tcmalloc 都需要一些额外的步骤来处理共享 dll。我可以使用 tcmalloc 制作我们所有的 dll 的静态库来进行内存分析，但如果知道还需要做什么才能将共享 dll 与 tcmalloc 一起使用，那真的很高兴。

DLL 头文件方法声明：__declspec(dllexport) static std::string GetExecutablePath();

//.cpp 实现

```
string Parameters::GetExecutablePath()

    string  execPathStr;
    char exeFilePath[ MAX_PATH +1];
    if ( GetModuleFileName( NULL, exeFilePath, MAX_PATH ) )
    {
        //The line of code below is where the app crashes.
        //It calls operator new in crt/src/new.cpp. I verified the call to malloc
        //is forwarded to tcmalloc. 
        *execPathStr = string(exeFilePath);* //creates and deletes a temporary and then crashes

        long dir_pos = execPathStr.rfind( FT_DIR_SLASH ) ;
        execPathStr = execPathStr.substr( 0, dir_pos+1 );
    }

    return execPathStr;

} 
```

临时字符串销毁时调用的方法：

```
~_String_val()
{   
    // destroy the object
    typename _Alloc::template rebind<_Container_proxy>::other _Alproxy(_Alval);
    this->_Orphan_all();
    _Dest_val(_Alproxy, this->_Myproxy);
    **_Alproxy.deallocate(this->_Myproxy, 1);**
    this->_Myproxy = 0;
}

void deallocate(pointer _Ptr, size_type)
{   
    // deallocate object at _Ptr, ignore size
    **::operator delete(_Ptr);**
}

This is where it crashes. the pHead->nBlockUse is 0\. 
crt/dbgdel.cpp:

void operator delete(
        void *pUserData
        )
{
    //code omitted for brevity
    /* verify block type */
    **_ASSERTE(_BLOCK_TYPE_IS_VALID(pHead->nBlockUse));** //crashes here
} 
```

在将 tcmalloc 重建为共享 DLL 后，它现在在尝试释放内存时会在不同的地方崩溃。

afxmem.cpp：

```
void __cdecl operator delete(void* p)
{
#if !defined(_AFX_NO_DEBUG_CRT) && defined(_DEBUG)
        **_free_dbg(p, _NORMAL_BLOCK);** <-------- this function gets called 
#else
        free(p);
#endif
} 
```

dbgheap.c：

```
extern "C" _CRTIMP void __cdecl _free_dbg(
        void * pUserData,
        int nBlockUse
        )
{
 _mlock(_HEAP_LOCK);

        __try {
            /* allocate the block
             */
            **_free_dbg_nolock(pUserData, nBlockUse);**
        }
   __finally {
            /* unlock the heap
             */
            _munlock(_HEAP_LOCK);
        }
}

extern "C" void __cdecl _free_dbg_nolock(
        void * pUserData,
        int nBlockUse
        )
{
    //code omitted for brevity

    /*
    * If this ASSERT fails, a bad pointer has been passed in. It may be
    * totally bogus, or it may have been allocated from another heap.
    * The pointer MUST come from the 'local' heap.
    */
    **_ASSERTE(_CrtIsValidHeapPointer(pUserData));** <-------- crashes here
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-16T23:26:09.847

We finally got tcmalloc working on Windows 64 bit platform with shared dll's. Thanks to Captain Oblivious for his suggestions ! The trick was to build a release version in Visual Studio 2010 with debug symbols as stated in this article: [How to: Debug a Release Build](http://msdn.microsoft.com/en-us/library/fsk896zz) . tcmalloc has conflicts with CRT debug heap calls in MFC such as: _free_dbg. We were allocating memory from tcmalloc and deallocating from MFC CRT heap debug calls. In a release build that problem went away. We did some preliminary testing and tcmalloc is generating the heap profile call graph.

Thanks.

Bruce

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-09T18:33:49.287

通过静态链接 tcmalloc，每个使用它的 DLL 都会获得它自己的库内部状态的副本（包括堆和所有指针）。如果您通过 tcmalloc 从一个 DLL 分配内存并尝试从另一个 DLL 中删除，则该操作将失败，因为您最终会访问多个堆。

将 tcmalloc 链接为动态库，您的问题应该会消失。

# iphone - 从带有 UIToolbarButton 的 UITextField 中关闭数字键盘

> ID：14243187
> 
> 赞同：0
> 
> 时间：2013-01-09T17:40:31.423
> 
> 标签：iphone, ios, objective-c

我知道这里有一些关于[如何在 iPhone OS 4 的数字键盘上显示按钮“完成”的讨论？](https://stackoverflow.com/questions/3014964/how-to-show-button-done-on-number-pad-on-iphone-os-4)关闭数字键盘。我想找到一种无需添加 UIToolbarButton 即可关闭数字键盘的方法。我的 UITextFields 是邮政编码和年龄。mint.com iPhone 应用程序就是这样做的；所以必须有办法。

这是我当前添加 UIToolbarButton 的代码：

```
textField1.keyboardType = UIKeyboardTypeNumberPad;
textField1.delegate = self;

//Create a toolbar to add to the textpad
UIToolbar* numberToolbar = [[UIToolbar alloc]initWithFrame:CGRectMake(0, 0, 320, 50)];
numberToolbar.barStyle = UIBarStyleDefault;
numberToolbar.items = [NSArray arrayWithObjects:
                       [[UIBarButtonItem alloc]initWithBarButtonSystemItem:UIBarButtonSystemItemFlexibleSpace target:nil action:nil],
                       [[UIBarButtonItem alloc]initWithTitle:@"Done" style:UIBarButtonItemStyleBordered target:self action:@selector(dismissZipKeyPad)],
                       nil];
[numberToolbar sizeToFit];
textField1.inputAccessoryView = numberToolbar; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-10T03:46:58.850

当用户触摸文本字段外的任何地方时，我用它来关闭键盘：

```
- (void)touchesEnded: (NSSet *)touches withEvent: (UIEvent *)event {
for (UIView* view in self.view.subviews) {
if ([view isKindOfClass:[UITextField class]])
[view resignFirstResponder];
}
} 
```

我在这里找到了它：

[http://remarkablepixels.com/blog/2011/1/23/dismiss-iphone-keyboard.html](http://remarkablepixels.com/blog/2011/1/23/dismiss-iphone-keyboard.html)

# php - composer.json 中的 dev-master，这是疯了吗？

> ID：14243190
> 
> 赞同：27
> 
> 时间：2013-01-09T17:40:44.130
> 
> 标签：php, composer-php

我正在使用作曲家（在 Symfony2 项目中）并且经常在更新库时出错。

许多库（根据我的经验）使用 dev-master 作为其依赖项的版本（或者更糟糕的是他们使用 * ）。

每当有东西被提交到主分支时，您就可以更新库，并且随着时间的推移，API 更改的可能性会更高。今天在 master 中的版本是 1.2.1，明天可能是 1.2.7，没有任何危害，然后成为以后的 1.7 或 2.x，肯定不兼容。

我的问题是

1.  我们是怎么走到这一步的？这是来自知名人士的建议吗？
2.  我/我们可以做些什么来使作者对这个主题敏感？

还是我疯了？

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2013-01-10T10:02:20.317

你没有生气。

1.  这是先有鸡还是先有蛋的问题，除非人们标记更多，否则其他人不能要求标记发布。
2.  唠叨每个没有标签或六个月内没有标签任何东西的人（如果项目正在积极开发的话）。本周早些时候，我努力标记了我们所有的捆绑包，因为我读到了类似的咆哮，我被提醒我们大多数仍然只有 dev-master 版本。

解决方案确实是教育，我将尝试通过推动作曲家文档中的最佳实践来提供一些帮助。不是每个人都有很多包管理经验，而且很多人没有意识到这种方法有多大问题（直到为时已晚），所以每个人的工作都是通过提醒他们来提供帮助。

# ios - 在基本视图控制器中管理 ioutlets

> ID：14243191
> 
> 赞同：1
> 
> 时间：2013-01-09T17:40:46.740
> 
> 标签：ios, cocoa-touch

我的应用程序的每个 UIViewController 都在使用 UITextField 委托，例如：

```
- (void)textFieldDidBeginEditing:(UITextField*)textField {

    self.responder = textField;

}

- (BOOL)textFieldShouldReturn:(UITextField*)textField {

double elementYPosition = self.responder.frame.origin.y;
double elementHeight = self.responder.frame.size.height;
double scrollYPosition = self.scrollView.contentOffset.y;
/* some logic */

} 
```

现在我正在尝试创建一个基本视图控制器，所以我可以继承使用它，重用这些方法。基本视图控制器中的`responder`属性工作得很好，因为 UITextField 委托设置了它的值，但是滚动视图是一个 IBOutlet，我不太确定如何设计这个基类：

```
#import "ViewControllerBase.h"

@interface ViewControllerBase ()

@property (weak, nonatomic) UIView* responder;
@property (weak, nonatomic) IBOutlet UIScrollView *scrollView; /* ??? */

@end

@implementation ViewControllerBase

-- methods

@end 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-10T20:16:40.113

在子类标题中：

```
@property (weak, nonatomic) UIScrollView *scrollView; 
```

在子类加载方法中：

```
self.scrollView = (UIScrollView *)self.view.subviews[0]; 
```

但它之所以有效，是因为我的视图控制器始终采用以下格式：

```
UIViewController (self)
  UIView (self.view)
    UIScrollView (self.view.subviews[0])
      UILabel
      UIElement
    UIElement
    UIElement 
```

# ios - GDB 无法访问 iPhone 6.01 上的内存

> ID：14243193
> 
> 赞同：1
> 
> 时间：2013-01-09T17:40:54.537
> 
> 标签：ios, gdb

进行一些应用程序测试，并尝试反转应用程序。我在运行 ios 6.01 的 iPhone 上从最新的 SDK 运行 gdb。

无论我尝试什么，我总是得到相同的错误“无法访问地址 0x2000 的内存”

我尝试了不同版本的 gdb，似乎都在做同样的事情。有没有人能够在 iOS 6.01 上得到这个？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-12-16T18:53:14.453

您可能需要删除地址空间布局随机化。

这样做的几种可能性：

1.  [安全学习](http://www.securitylearn.net/2013/05/23/disable-aslr-on-ios-applications/ "安全学习")
2.  [魔术iOS论坛](http://magicios.org/topic/3002-how-to-remove-aslr/ "MagicIOS")

# python - Python 套接字绑定到 3 个网络接口中的 2 个

> ID：14243196
> 
> 赞同：1
> 
> 时间：2013-01-09T17:41:04.583
> 
> 标签：python, sockets

当绑定到 python 中的套接字时，主机的值可以是 '' ，这意味着所有接口。或者它可以是一个包含真实 IP 地址的字符串，例如“192.168.1.5”。

所以它可以绑定到所有或 1 个接口。

如果我有 3 个接口并且我只想绑定到其中的 2 个怎么办。

这可能吗？

我给主机什么值，我累了一个列表，一个元组，一个逗号分隔的字符串。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-09T18:25:00.297

不幸的是，不可能使用`socket`模块绑定到接口的子集。该模块提供对 BSD 套接字接口的访问，该接口允许在绑定时仅指定单个地址。对于这个单一地址，C 中存在一个特殊值，`INADDR_ANY`以允许绑定到所有接口（Python 将空字符串转换为该值）。

如果要使用模块绑定到多个（但不是全部）接口`socket`，则需要创建多个套接字。

# google-plus - 在没有 OAuth 的情况下查找给定电子邮件地址的 Google+ 头像

> ID：14243200
> 
> 赞同：17
> 
> 时间：2013-01-09T17:41:13.757
> 
> 标签：google-plus, avatar, avatars

在我的应用中，我想为用户显示 Google+ 个人资料图片。我发现，在 API 中获取个人资料图片的唯一函数需要一个 userId。但是，我只有他们的电子邮件地址，而不是他们的 Google+ 用户 ID。
此外，不应强迫我想要获取其图像的人登录并授权我的应用程序，因为此人与应用程序的用户大多不相同。

所以我想我需要通过电子邮件获取他们的用户 ID。我通读了 Google+ API 文档，但找不到这样做的方法，但我不敢相信这是不可能的。

所以我的问题是：
如何仅使用电子邮件地址获取 Google+ 用户 ID？
是否有其他 Google API 可以获取个人资料图片？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2016-07-31T11:13:28.143

[https://www.avatarapi.com/](https://www.avatarapi.com/)提供了一个 API，它根据 Google 的公开信息从电子邮件地址返回用户的姓名和个人资料图片。

可以在此 API 端点通过 SOAP 或 HTTP 调用它： [https ://www.avatarapi.com/avatar.asmx](https://www.avatarapi.com/avatar.asmx)

此 API 的好处之一是它不需要用户通过 OAUTH 向 Google 进行身份验证，因此这可能正是您正在寻找的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-09T22:19:17.960

您不能仅使用他们的电子邮件地址来执行此操作，但是，如果他们粘贴他们的 Google+ 网址，您可以从网址字符串中解析 id，然后使用[公共数据 API](https://developers.google.com/apis-explorer/#p/plus/v1/plus.people.get?userId=109716647623830091721&_h=1&)获取他们的个人资料图片（和封面图片！） 。网址： https: [//plus.google.com/me](https://plus.google.com/me)会将您带到他们的个人资料。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-09T21:56:29.723

您可以使用[people.search API](https://developers.google.com/+/api/latest/people/search)通过电子邮件地址进行搜索，而无需请求用户进行身份验证。但是，这只会搜索公共个人资料字段，默认情况下该电子邮件不是公共字段。

唯一需要 OAuth 的 API 方法是那些访问私有数据的方法。对于公共数据，您可以使用更简单的[API 密钥方法](https://developers.google.com/console/help/#WhatIsKey)。

为了可靠地实现您所描述的内容，您需要使用 Oauth 和 plus.me 范围来获取您想要的信息。但是，这确实需要授权您的应用程序。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-09T17:50:55.330

我高度怀疑这是可能的。针对 Google Plus API 的任何类型的查询都需要 OAUTH。更重要的是，我不知道首先通过电子邮件地址查询用户 ID 的方法。

[该线程](http://code.google.com/p/google-plus-platform/issues/detail?id=64)似乎确认这是目前不可能的。

# java - 从 Language 类获取语言

> ID：14243203
> 
> 赞同：1
> 
> 时间：2013-01-09T17:41:25.937
> 
> 标签：java, google-translate

我使用[这个](http://code.google.com/p/java-google-translate-text-to-speech/downloads/list)Unofficial Java Google Translate API 将文本从一种语言翻译成另一种语言。

我有`Language`一个包含所有语言名称的类，如下图所示： ![在此处输入图像描述](../Images/545718d91782ffb83cafc50ef6655c5a.png)

我想得到一个包含语言名称的数组。我怎样才能做到这一点？

如果是 C#，我会这样做：

```
PropertyInfo[] languages;
languages = typeof(Language).GetProperties(); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-09T17:42:49.673

由于`Language`不在`enum`该库中，因此您必须使用反射来查找所有成员。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-09T17:47:01.153

你可以得到所有的领域

```
Field[] fields = Language.class.getDeclaredFields();

for(Field field: fields) 
   if (field.getType() == String.class)
        System.out.println(field.getName() + " = " + field.get(null)); 
```

# javascript - 随机旋转和位置克隆对象

> ID：14243205
> 
> 赞同：1
> 
> 时间：2013-01-09T17:41:31.443
> 
> 标签：javascript, after-effects

我的标志形状的面具后面有一条白线。背后是黑色的背景。我希望这条线每 5 帧在蒙版下以全新的“位置”和“旋转”复制一次，直到整个东西变成白色的线条。我是表达式的初学者，我什至不知道将代码放在哪里。我认为这就是我正在寻找的东西：

```
seedRandom(1, true);
x=random(minvalue, maxvalue);
y=random(minvalue, maxvalue);
z=random(minvalue, maxvalue);
[x,y,z] 
```

但这不会克隆该行。

任何帮助都会很棒

最大限度

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-10T22:02:41.870

不幸的是，您无法使用 After Effects 表达式克隆对象。我认为您可能希望将随机位置/旋转表达式添加到一层，然后多次复制该层（Mac 上的 command+d），然后使用像这样的 After Effects 脚本：

[http://aescripts.com/pt_shiftlayers/](http://aescripts.com/pt_shiftlayers/)

（将其复制到`Adobe After Effects CS#/Scripts/ScriptUI Panels/`，重新启动 AE，然后从 Window > Scripts > pt_shiftlayers.jsx 或类似的东西打开它）。

它将使您的图层偏移您指定的帧数，在您的情况下为 5。（该脚本是按需付费，因此您可以将价格设置为 0 美元并免费试用，或者如果您真的很欣赏开发人员的工作，也可以付费。）

如果这不符合您的需求，您可以使用粒子系统插件（如 Trapcode Particular 或 CC Particle World）每 5 帧生成一个粒子，不移动、随机旋转、随机位置。

让我知道这是否适合您。

# php - Yii 的 accessRules 误解

> ID：14243210
> 
> 赞同：2
> 
> 时间：2013-01-09T16:04:41.590
> 
> 标签：php, access-control, yii

我正在尝试使用 Yii 构建一个站点，发现自己处于需要对 Yii 中的访问控制隐喻进行一些澄清的情况。具体来说，可以覆盖的后代中的[accessRules](http://www.yiiframework.com/doc/api/1.1/CController#accessRules-detail)方法`CController`。

**先决条件：**

这是 Gii 默认生成的代码，与[文档](http://www.yiiframework.com/doc/guide/1.1/en/topics.auth)非常相似：

```
public function accessRules()
{
    return array(
        array('allow',  // allow all users to perform 'index' and 'view' actions
            'actions'=>array('index','view'),
            'users'=>array('*'),
        ),
        array('allow', // allow authenticated user to perform 'create' and 'update' actions
            'actions'=>array('create','update'),
            'users'=>array('@'),
        ),
        array('allow', // allow admin user to perform 'admin' and 'delete' actions
            'actions'=>array('admin','delete'),
            'roles'=> array('admin'),
        ),
        array('deny',  // deny all users
            'users'=>array('*'),
        ),
    );
} 
```

**问题：**

我不清楚的是——*为什么我们需要为许多不同的用户和组以及不同的操作定义访问规则，而不是只检查一个当前用户和操作的权限？*- 这里用斜体突出显示我的主要问题，以防读者（答案作者）可能不太清楚。

此代码在特定请求的上下文中执行，为此，**特定`controller`、特定`action`和特定`user`是已知**的。例如，如果用户是来宾，我看不出有任何理由为“管理员”角色或经过身份验证的用户定义规则。

**推理：**

经过一番阐述，我想出了以下实现：

```
public function accessRules()
{
    return array(
      array(Yii::app()->user->hasRights()?'allow':'deny'),
      );
} 
```

其中`hasRights`是添加到`CWebUser`后代中的简单自定义方法：

```
class WebUser extends CWebUser
{
  private $ACL = // ACL example
    array('user' => // controller id
      array('index' => User::AC_MODERATOR, // action ids
            'view' => User::AC_MODERATOR,
            'create' => User::AC_MODERATOR,
            'update' => User::AC_ADMIN,
            'delete' => User::AC_ADMIN,
            'admin' => User::AC_ADMIN),
           // ...
      );

  public function hasRights()
  {
    return (Yii::app()->user->getState('accessRights') >=
      $this->ACL[Yii::app()->controller->id][Yii::app()->controller->action->id]);
  }
} 
```

如您所见，`hasRights`使用当前用户“权限”（照常从数据库读取）、当前控制器和操作来计算单个布尔值`true`或`false`值作为访问决策。

这种方法有什么问题？为什么 Yii 默认不使用这样简单的东西？

The Gii-generated `accessRules` above do not only look excessive, but also imply that access rules are scattered among many controllers. In my approach a single and compact ACL is used.

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-08-02T22:32:25.513

Here's where I think you're confused.

First of all, Yii is in fact only looking at the current user and the current action. Just like how you got the current permissions for the controller by grabbing a nested array, indexed by the controller ID, Yii is creating an instance of your controller and only looking at those access rules. Also, just like you're only looking at the permissions of a particular action, Yii is only looking at the rules pertaining to the current action. It accesses those permissions just as easily as you return the value of the nested array.

As far as the user goes, it's also only looking at the current user; the current user name, the current user role, etc. The difference is, there are multiple attributes Yii will allow within a rule, in contrast to the single permission value associated with the user.

It seems what you don't like about this approach is you think permissions should be handled all in one place. This could be simpler in some cases, but more difficult in others. What happens when you have multiple controllers and multiple actions in each controller? You now have a very large array to manage, that references data from multiple different contexts. In the way Yii does it, the current controller has control over how it's data structure can be accessed. This lines up with Yii's MVC structure, and the concept of encapsulation.

Your solution is more elegant in some respects, but it hinges on the idea that permissions will only ever need to be structured in a cascading one directional structure. What I mean is your permissions are like one long hallway, with doors separating one area from another. If the user doesn't have the key to one door, they shouldn't be able to access the next, etc. But what happens if, in your example, you need a user to both view content, and update it without being able to create new content? This is a much more complicated scenario which will need to be handled using roles. So then you'd have to process rules within your array, much like Yii does. Except instead of Yii's object oriented approach, you've got everything embedded in one long array.

So perhaps your solution will work in some cases, but I'm sure you can see why Yii chose its approach since it will work, by default, for far more situations.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-09T21:18:32.327

Yii implements a hierarchical RBAC scheme via its CWebApplication ->authManager application component, which actually similar to what you did,

Take a look at [this](http://www.yiiframework.com/wiki/136/getting-to-understand-hierarchical-rbac-scheme/)

**EDIT**

```
"let us suppose that we use RBAC and add some rules into the accessRules method, such as with admin role in the example above." 
```

you don't add rules into accessRules method when you use RBAC

what you do is , you define authorization hierarchy which involves three steps 1)define authorization itmes which includes roles and operations, this would be stored in DB,in authitem table

Eg. **Operations**

```
siteAddProduct->in this case 'site' is the controller name and addProduct is the action in 'site' controller
sitedeleteProduct ...etc 
```

**Roles**

```
admin,editor...etc 
```

2)Estabish relationship between authorization items(between role and operations) this would be stored in authitemchild table

eg.

```
admin -> siteAddProduct
editor -> sitedeleteProduct
admin->editor 
```

3)assign roles to application users this would be stored in authassignment table

for example **userid 1 ->admin**

now in your base controller( assuming that you have a controller class from which all other controllers in your app extneds from ) you override `beforeAction()` method and check the logged in user(current user) permission using

```
Yii::app()->user->checkAccess($operation); 
```

$operation is the requested controller + action

you can get the controller name using `$this->id` and action name using `$this->getAction()->id`

# jquery - Bootstrap、jQuery 和 Rails 资产管道

> ID：14243211
> 
> 赞同：0
> 
> 时间：2013-01-09T17:41:56.007
> 
> 标签：jquery, ruby-on-rails, jquery-ui, asset-pipeline, bootstrap-sass

这是我的 application.js 清单。

```
//= require jquery
//= require jquery_ujs
//= require jquery.purr
//= require best_in_place
//= require jquery-ui
//= require bootstrap-dropdown
//= require bootstrap-modal
//= require_tree . 
```

使用此设置，可排序 (JQuery)、下拉菜单 (bootstrap) 和模态 (bootstrap) 在 heroku 上的 PRODUCTION 中工作。

在开发中，下拉菜单不起作用。

当我放置引导程序需要高于 jquery 时，所有引导程序和 jquery 都停止工作。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-09T20:45:49.150

我通过在 development.rb 中使用 config.serve_static_assets = false 修复了本地下拉菜单不起作用。

我将问题留在原处，以作为 application.js 清单中“要求”的可接受顺序参考。

# security - Kerberos 和表单身份验证？

> ID：14243212
> 
> 赞同：0
> 
> 时间：2013-01-09T17:42:00.300
> 
> 标签：security, kerberos, http-authentication

我们有一个向内部用户（具有 Kerberos 身份验证）和可以通过传统用户名/密码表单登录的第三方公开的系统。我们目前所做的是让多台服务器运行，其中一些使用 a.mysite.com 进行 Kerberized，而另一些则在 b.mysite.com 上运行表单身份验证。

我想要的是有一个我们与两个组共享的 URL，并让服务器确定 Kerberos 令牌是否可用。如果是，则使用它，否则重定向到登录页面。理想情况下，用户始终停留在“myproject.mysite.com”上……但如果我们需要（自动）根据他们是否拥有该令牌，将他们重定向到 a.mysite.com 或 b.mysite.com。

想法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-18T22:16:49.580

这很容易实现。您有两种选择。

1：发回给客户

```
WWW-Authenticate: Negotiate
WWW-Authenticate: Kerberos
WWW-Authenticate: Basic (or better yet Digest) 
```

客户将选择最适合他的方法。

2：如果你真的需要form-auth，发送

```
WWW-Authenticate: Negotiate 
```

并将表单呈现为 401 页面。让表单发布到未受保护的控制器并执行表单身份验证。

您可以使用`mod_auth_kerb`或`mod_auth_gss`用于 Apache HTTPd 并`$REMOTE_USER`在成功验证后进行检查。

请记住，如果希望某些用户使用 Kerberos 身份验证，他们必须是您的网络/域的一部分，具有 KDC 帐户和正确的 DNS 条目。

# c - 在c中打印一个链表

> ID：14243215
> 
> 赞同：1
> 
> 时间：2013-01-09T17:42:10.037
> 
> 标签：c, list, struct

我必须为作业做 2 个链表，将用户给出的整数放在第一个，然后将第一个到第二个列表的每个整数的结果 = x^3。在下面的代码中，我试图打印我放在第一个列表中的内容，并使用 scanf 读取。我还不明白为什么我不能用这种方式打印。你能解释一下吗？提前致谢！！问题是我只打印最后一个元素和 0...：s

代码：

```
#include <stdio.h>
#include <stdlib.h>

struct L1 
{
    int x;
    struct L1 *next1;
};

struct L2 
{
    int x,i,v;
    struct L2 *next2;
};

int main()
{
    int i,N;
    struct L1 *root1; 
    struct L2 *root2;
    struct L1 *conductor1;  
    struct L2 *conductor2;

    root1 = malloc(sizeof(struct L1));  
    root2 = malloc(sizeof(struct L2));
    root1->next1=0;
    conductor1 = root1;
    printf("Dwste arithmo N");
    scanf("%d",&N);
    printf("\nDwse arithmo");
    scanf("%d",&conductor1->x);
    printf("%d",conductor1->x);

    for(i=0; i<N; i++)
    {
        conductor1->next1 = malloc(sizeof(struct L1));
        printf("\nDwste arithmo");
        scanf("%d",&conductor1->x);
        conductor1->next1=0;
    }
    conductor1 = root1;
    while (conductor1 != NULL)
    {
        printf("\n%d",conductor1->x);
        conductor1=conductor1->next1;
    }

    return 0;
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-09T17:47:34.837

在`for`循环中，您永远不会更改`conductor1`. 因此它将始终指向头节点，并且您将始终覆盖该节点的字段。您需要`conductor1=conductor1->next1;`在分配新节点后添加才能在每次迭代中前进到下一个节点。

# c# - 在 C# 中编组字符串、指针（使用 P/Invoke 在 C# 中为 C DLL 编写包装器）

> ID：14243223
> 
> 赞同：1
> 
> 时间：2013-01-09T17:42:38.587
> 
> 标签：c#, arrays, string, pinvoke, marshalling

我目前正在尝试为使用非托管 C DLL 进行接口的 USB 相机编写包装器。提供的软件是使用 Qt 用 C++ 编写的，我正在尝试将此相机集成到我已经编写的 C# 应用程序中（该应用程序已经使用了一个带有 C# 接口的不同相机）。我读过一堆关于非托管/托管接口的文章，但我仍然被这个特定的 DLL 所困扰。

我在处理 P/Invoking DLL 时遇到了麻烦。我已经阅读了大量关于处理托管/非托管代码的方法，似乎因为我只有函数/参数（没有别的），我无法编写 C++/CLI 包装器并被迫坚持 P/Invoke。如果这是不正确的，如果更有效的话，将不胜感激对替代方法的一些帮助。

无论如何，我目前无法调用一些（阅读：全部）函数。例如，让我们选择这个函数（取自 dijSDK.h，在 Qt 的非托管 C++ 中使用此接口时要使用的头文件）：

```
/** \brief Find cameras currently connected to the host
  *
  * \param[out]      pGuidList   List of unique identifiers of connected cameras; memory is allocated by user
  * \param[in,out]   pNumGuids   Pointer to the number of elements in pGuidList to limit the search
  * \n                           Pointer to the number of cameras found
  * \param[in]       mask        optional mask to limit the results in pGuidList
  *
  * \note
  * -    the function lists all supported cameras that are connected to the host having a driver installed
  * -    the cameras are identified by a string in a defined style:
  * \n  <i>[Name of the camera library resp. camera class]:[camera name]:[Serial number of the camera]</i>
  * -    the optional parameter mask may be used to limit the results returned in pGuidList; 
  * \n   mask is in the same style as the results in pGuidList 
  *      therefore the results can be limited to certain camera classes, camera types,
  *      and cameras with a given serial number */

DIJSDK_EXPORT error_t DijSDK_FindCameras(DijSDK_CamGuid* pGuidList, unsigned int* pNumGuids, const DijSDK_CamGuid mask = NULL); 
```

DIJSDK_EXPORT 定义如下：

```
#ifndef DIJSDK_EXPORT
 #define DIJSDK_EXPORT externC DLLEXPORT
#endif 
```

以及上述函数中使用的两个 typedef：

```
/// Return value of all DijSDK functions
/// \note All return values of type error_t can be casted to the enum <b>DijSDK_EErrorCodeList</b>, see header errorlistinstall.h
typedef int error_t;

// unique DijSDK types
/// Globally unique identifier for all supported cameras. It is used to establish a relation between <b>physical</b> and <b>logical</b> cameras.
typedef char   DijSDK_CamGuid[64]; 
```

所以查看函数，用户传入一个分配的字符串数组和该数组中分配的字符串数，该函数应该返回一堆字符串和它返回的字符串数。我完全不知道如何在 C# 中实现它。我尝试过不同`DllImport`的函数声明，比如将 pGuidList 作为...

*   `StringBuilder`

我传入的变量被初始化的地方，`var = new StringBuilder(64)`传入`uint`的只是1。

*   `StringBuilder[]`

我传入的变量在哪里初始化，在`var = new StringBuilder[length]`哪里传递给函数。`length``uint`

*   `IntPtr` 我传入的变量是用 初始化的`Marshal.AllocCoTaskMem(64 * length * Marshal.SystemDefaultCharSize)`，哪里`length`是和上面一样的 uint

然后`pNumGuids`作为`ref uint`. 我不提交参数，`mask`因为它是可选的，我不需要使用它。

由于托管导入的签名和非托管 DLL 的签名不匹配，我经常得到一个`PInvokeStackImbalance`，但我无法弄清楚正确的签名是什么。

我对我正在处理的所有功能都有疑问，但我会一次处理一个。我使用的第一个函数是一个“init”函数，它接受一个函数指针参数和一个用于回调的 void 指针参数及其关联数据，但如果我不需要使用回调，我可以不带参数调用它那就是 P/Invoking 就好了。这个问题中的函数是我需要调用的函数以获取附加设备的列表。我想如果我能让这个工作正常，我就能弄清楚其余的大部分功能。

我正在使用的 SDK 和文档并未从提供它的公司在线公开获得。如果有人希望它查看所有代码/文档，我可以将其发布在文件服务器上并发布指向它的链接。

任何帮助将非常感激！如果有什么我遗漏的，请务必质问我=P

**解决方案：** 在帮助之后，我设法让它工作：

DLL导入：

```
[DllImport(DLL,CallingConvention=CallingConvention.Cdecl)]
        public static extern error_t DijSDK_FindCameras([Out] DijSDK_CamGuid[] pCamGuid, ref uint pNumGuids, string mask); 
```

用于 DijSDK_CamGuid 的结构：

```
[StructLayout(LayoutKind.Sequential,Size=64)]
public struct DijSDK_CamGuid
{
    [MarshalAs(UnmanagedType.ByValArray,SizeConst=64)]
    public char[] id;
} 
```

和`findCameras()`功能：

```
private void findCameras()
{
     uint cameralistlen = 5;
     DijSDK_CamGuid[] cameralist = new DijSDK_CamGuid[cameralistlen];
     result = Jenoptik.DijSDK_FindCameras(cameralist, ref cameralistlen, null);
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-09T18:08:43.120

您是否需要将托管代码中的 id 作为字符串处理？如果没有，也许这样的事情会起作用，将字节视为不透明的字节数组：

```
[StructLayout(LayoutKind.Sequential)]
public struct DijSDK_CamGuid
{
  [MarshalAs(UnmanagedType.ByValAray,SizeConst=64)]
  public byte[] id;
} 
```

然后声明您的 p/invoke 签名以使用以下类型的参数：

```
DijSDK_CamGuid* 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-09T19:13:28.263

尝试这样声明：

```
 [DllImport("whatever.dll", CallingConvention = CallingConvention.Cdecl)]
    extern public static int DijSDK_FindCameras(byte[] pGuidList, ref int pNumGuids, byte[] mask); 
```

并像这样使用它：

```
 byte[] CamGuids = new byte[64 * 32];    // Up to 32 cameras
    int GuidsCount = CamGuids.Length / 64;
    int result = DijSDK_FindCameras(CamGuids, ref GuidsCount, null); 
```

# vb.net - VB.NET 进度条百分比

> ID：14243225
> 
> 赞同：2
> 
> 时间：2013-01-09T17:42:44.073
> 
> 标签：vb.net, progress-bar, transparent, percentage

我创建了一个完美运行的进度条。我最近添加了百分比，但我想在进度条顶部显示标签。

像这样：

![在此处输入图像描述](../Images/f559d41ab6cb55735fb63b9fdd5100d9.png)

您可以看到的唯一问题是背景不透明。尽管有：

```
lblPercentage.BackColor = Color.Transparent 
```

在表单加载...有什么可以做的吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-09T18:12:52.073

透明背景色确实有效。问题是标签从表单中获取它的背景色，因为表单是它的父级。因此，我们必须将进度条设为其父级并调整其位置，因为现在必须相对于进度条指定它。将此代码添加到您的表单中：

```
Public Sub New()
    InitializeComponent()

    Dim pos As Point = PointToScreen(lblPercentage.Location)
    pos = myProgressBar.PointToClient(pos)
    lblPercentage.Parent = myProgressBar
    lblPercentage.Location = pos
    lblPercentage.BackColor = Color.Transparent
End Sub 
```

或者，您可以像这样计算标签的位置

```
lblPercentage.Location = New Point(lblPercentage.Location.X - myProgressBar.Location.X,
                                   lblPercentage.Location.Y - myProgressBar.Location.Y) 
```

您不能在设计器中进行此操作，因为您的进度条可能不是容器控件（即在其上放置标签不会使其成为该栏的子控件），并且您不会在设计器中看到结果。

* * *

**更新**

您也可以尝试以下替代方案：

*   在控件的方法中绘制百分比数字`OnPaint`（覆盖`OnPaint`）。
*   在进度条中执行我在上面显示的操作。您可以在进度条的构造函数中以编程方式添加标签。
*   使用 a`UserControl`作为进度条的基类。这将允许您将标签放在设计器中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-09T17:48:19.657

在这里，您已使进度条透明，这意味着它仅对进度条透明，并且进度条后面有表格，这就是它显示表格的原因。这是一个 Windows 限制，透明效果相对于顶层窗口，堆叠效果不起作用。总是你会看到`form`作为背景，

# jasper-reports - 使用 XML 文件数据源的子报表不起作用

> ID：14243229
> 
> 赞同：3
> 
> 时间：2013-01-09T17:43:04.870
> 
> 标签：jasper-reports, ireport, subreport, xmldatasource

我在连接到 XML 文件的子报表时遇到问题。当我执行报表时，预览不显示子报表数据，但如果我单独执行子报表，它会正确显示数据。我究竟做错了什么？

数据文件：

```
<REPORTDATA>
<HEAD>
    <NUMBER>1</NUMBER>
    <DESC>BLA BLA</DESC>
    <DATE>2012.01.01</DATE>
</HEAD>
<GRID1>
    <line id="1">
        <NUMBER>11</NUMBER>
        <DESC>g11BLA BLA</DESC>
        <DATE>2012.01.01</DATE>
    </line>
    <line id="2">
        <NUMBER>12</NUMBER>
        <DESC>g12BLA BLA</DESC>
        <DATE>2012.01.01</DATE>
    </line>
</GRID1>
<GRID2>
    <line id="1">
        <NUMBER>21</NUMBER>
        <DESC>g21BLA BLA</DESC>
        <DATE>2012.01.01</DATE>
    </line>
    <line id="2">
        <NUMBER>22</NUMBER>
        <DESC>g22BLA BLA</DESC>
        <DATE>2012.01.01</DATE>
    </line>
</GRID2> 
```

报告：

```
<jasperReport xmlns="http://jasperreports.sourceforge.net/jasperreports" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://jasperreports.sourceforge.net/jasperreports http://jasperreports.sourceforge.net/xsd/jasperreport.xsd" name="reporttest" language="groovy" pageWidth="595" pageHeight="842" columnWidth="555" leftMargin="20" rightMargin="20" topMargin="20" bottomMargin="20" uuid="6a9eed56-d1c3-46d8-9e16-4166c146b8a3">
<property name="ireport.zoom" value="1.0"/>
<property name="ireport.x" value="0"/>
<property name="ireport.y" value="0"/>
<parameter name="SUBREPORT_DIR" class="java.lang.String" isForPrompting="false">
    <defaultValueExpression><![CDATA["C:\\Users\\A2O\\Desktop\\"]]></defaultValueExpression>
</parameter>
<queryString language="xPath">
    <![CDATA[/REPORTDATA/HEAD]]>
</queryString>
<field name="NUMBER" class="java.lang.String">
    <fieldDescription><![CDATA[NUMBER]]></fieldDescription>
</field>
<field name="DESC" class="java.lang.String">
    <fieldDescription><![CDATA[DESC]]></fieldDescription>
</field>
<field name="DATE" class="java.lang.String">
    <fieldDescription><![CDATA[DATE]]></fieldDescription>
</field>
<background>
    <band splitType="Stretch"/>
</background>
<title>
    <band height="79" splitType="Stretch">
        <textField>
            <reportElement uuid="bd7929b3-092d-44b9-b488-c0418fb57749" x="4" y="6" width="100" height="20"/>
            <textElement/>
            <textFieldExpression><![CDATA[$F{NUMBER}]]></textFieldExpression>
        </textField>
        <textField>
            <reportElement uuid="de902808-67e8-4b08-bd0b-c1d735409843" x="6" y="32" width="100" height="20"/>
            <textElement/>
            <textFieldExpression><![CDATA[$F{DESC}]]></textFieldExpression>
        </textField>
        <textField>
            <reportElement uuid="86d57bd0-01d3-4b1f-b9bb-0eb7cf2c19fc" x="5" y="56" width="100" height="20"/>
            <textElement/>
            <textFieldExpression><![CDATA[$F{DATE}]]></textFieldExpression>
        </textField>
    </band>
</title>
<pageHeader>
    <band height="13" splitType="Stretch"/>
</pageHeader>
<columnHeader>
    <band height="12" splitType="Stretch"/>
</columnHeader>
<detail>
    <band height="26" splitType="Stretch">
        <staticText>
            <reportElement uuid="819f4027-8ad0-46b4-b07c-c80234fe8411" x="12" y="0" width="100" height="20"/>
            <textElement/>
            <text><![CDATA[Static text]]></text>
        </staticText>
    </band>
</detail>
<columnFooter>
    <band height="11" splitType="Stretch"/>
</columnFooter>
<pageFooter>
    <band height="9" splitType="Stretch"/>
</pageFooter>
<summary>
    <band height="42" splitType="Stretch">
        <subreport>
            <reportElement uuid="4ab29d23-9ead-491e-8ca3-8f9790280026" x="0" y="0" width="555" height="42"/>
            <connectionExpression><![CDATA[$P{REPORT_CONNECTION}]]></connectionExpression>
            <subreportExpression><![CDATA[$P{SUBREPORT_DIR} + "reporttest_subreport1.jasper"]]></subreportExpression>
        </subreport>
    </band>
</summary> 
```

子报告：

```
<jasperReport xmlns="http://jasperreports.sourceforge.net/jasperreports" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://jasperreports.sourceforge.net/jasperreports http://jasperreports.sourceforge.net/xsd/jasperreport.xsd" name="reporttest_subreport1" language="groovy" pageWidth="555" pageHeight="802" columnWidth="555" leftMargin="0" rightMargin="0" topMargin="0" bottomMargin="0" uuid="ca109af7-4e08-405d-b43f-4062115c500e">
<property name="ireport.zoom" value="1.0"/>
<property name="ireport.x" value="0"/>
<property name="ireport.y" value="0"/>
<queryString language="xPath">
    <![CDATA[/REPORTDATA/GRID1/line]]>
</queryString>
<field name="NUMBER" class="java.lang.String">
    <fieldDescription><![CDATA[NUMBER]]></fieldDescription>
</field>
<field name="DESC" class="java.lang.String">
    <fieldDescription><![CDATA[DESC]]></fieldDescription>
</field>
<field name="DATE" class="java.lang.String">
    <fieldDescription><![CDATA[DATE]]></fieldDescription>
</field>
<background>
    <band splitType="Stretch"/>
</background>
<title>
    <band splitType="Stretch"/>
</title>
<pageHeader>
    <band height="36" splitType="Stretch"/>
</pageHeader>
<columnHeader>
    <band height="69" splitType="Stretch">
        <staticText>
            <reportElement uuid="867a24dd-6172-40ef-be33-f8e51fa21207" x="0" y="0" width="100" height="20"/>
            <textElement/>
            <text><![CDATA[Grid1 data:]]></text>
        </staticText>
        <staticText>
            <reportElement uuid="0885dada-a149-4cb7-b82c-fdfa9847061d" x="32" y="49" width="100" height="20"/>
            <textElement/>
            <text><![CDATA[NUMBER]]></text>
        </staticText>
        <staticText>
            <reportElement uuid="7261c001-6771-47dc-9749-5e6f64fb86df" x="159" y="49" width="100" height="20"/>
            <textElement/>
            <text><![CDATA[DESC]]></text>
        </staticText>
        <staticText>
            <reportElement uuid="2b95c6fc-3fd9-4df1-89c6-5249173db3e1" x="287" y="49" width="100" height="20"/>
            <textElement/>
            <text><![CDATA[DATE]]></text>
        </staticText>
    </band>
</columnHeader>
<detail>
    <band height="23" splitType="Stretch">
        <textField>
            <reportElement uuid="becea2ba-40fd-4208-8191-c7475293ed5b" x="32" y="1" width="100" height="20"/>
            <textElement/>
            <textFieldExpression><![CDATA[$F{NUMBER}]]></textFieldExpression>
        </textField>
        <textField>
            <reportElement uuid="182efb3b-6a66-4634-be35-fe03e8a0cd45" x="159" y="0" width="100" height="20"/>
            <textElement/>
            <textFieldExpression><![CDATA[$F{DESC}]]></textFieldExpression>
        </textField>
        <textField>
            <reportElement uuid="bdb70a35-b4e6-4857-96c5-f607ee59bc07" x="287" y="0" width="100" height="20"/>
            <textElement/>
            <textFieldExpression><![CDATA[$F{DATE}]]></textFieldExpression>
        </textField>
    </band>
</detail>
<columnFooter>
    <band height="15" splitType="Stretch"/>
</columnFooter>
<pageFooter>
    <band height="6" splitType="Stretch"/>
</pageFooter>
<summary>
    <band height="7" splitType="Stretch"/>
</summary> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-10T09:48:51.253

对于以 xml 文件作为数据源的子报表，您需要指定子报表的数据源。您需要查看的属性是

1.  连接类型：使用数据源表达式
2.  连接/数据源表达式：

> ((net.sf.jasperreports.engine.data.JRXmlDataSource)$P{REPORT_DATA_SOURCE}).subDataSource("//YOUR_SUBREPORT_ENTITY")。

您将需要类似的东西

```
<dataSourceExpression><![CDATA[

((net.sf.jasperreports.engine.data.JRXmlDataSource)
$P{REPORT_DATA_SOURCE}).subDataSource("//YOUR_SUBREPORT_ENTITY") ]]>
</dataSourceExpression> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2020-05-25T21:38:27.133

也许现在它实际上并不适合您，而是它可以帮助的人。

所有需要的 - 它为子报表设置的数据源表达式，它是如何实现的：

```
<dataSourceExpression>
<![CDATA[((net.sf.jasperreports.engine.data.JRXmlDataSource)$P{REPORT_DATA_SOURCE}).datasource("YOUR_SUBREPORT_XPATH") ]]>
</dataSourceExpression> 
```

1.  相反，“YOUR_SUBREPORT_XPATH”使用您在子报表中设置的 XPath。在这种情况下，它将是`"/REPORTDATA/GRID1/line"`
2.  在 Jasper 的较新版本（我使用 6.x）中更好更正确地`.datasource(...)`使用`.subDataSource(...)`

# c - 基于 CLRS 教科书的归并排序

> ID：14243232
> 
> 赞同：1
> 
> 时间：2013-01-09T17:43:31.830
> 
> 标签：c, function, pointers, mergesort

以下代码符合 CLRS ( [Corman, Leiserson, Rivest, Stein — 'Introduction to Algorithms'](https://rads.stackoverflow.com/amzn/click/com/0262033844) ) 教科书，该教科书应该进行归并排序。

尽管我知道函数中发生了错误，但我无法确定正在发生的错误`mergesort()`。我认为`merge()`功能完好。

```
/* Merge sort as per CLRS */
#include <stdio.h>
#include <stdlib.h>

void merge(int *a,int p,int q,int r){
int n1 = q - p + 1;
int n2 = r - q;
int* l = malloc((n1+1)*sizeof(int));
int* ri = malloc((n2+1)*sizeof(int));
int i,j;
for(i = 0 ; i < n1 ; i++)
    l[i] = a[p+i-1];
for(i = 0 ; i < n2 ; i++)
    ri[i] = a[q+i];
l[n1] = 9999;
ri[n2] = 9999;
i = 0;
j = 0;
int k;
for ( k = p ; k <= r ; k++){
    if( l[i] < ri[j] ){
        a[k] = l[i];
        i++;
    }
    else{
        a[k] = ri[j];
        j++;
    } 
}
}

void mergeSort(int* a,int p,int r){
if( p < r){

    int q = ( p + r ) / 2;
    mergeSort(a,p,q);
    mergeSort(a,p+1,r);
    merge(a,p,q,r);
}

else return;

}

int main(int argc, char* argv[]){
int a[] = {9,21,4,15,1,3};

mergeSort(a,0,5);

int i;
for( i = 0 ; i < 6 ; i++){
    printf("%d ",a[i]);
}
return 0;

} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-09T17:49:57.937

```
void merge(int *a,int p,int q,int r){
    int n1 = q - p + 1;
    int n2 = r - q;
    int* l = malloc((n1+1)*sizeof(int));
    int* ri = malloc((n2+1)*sizeof(int));
    int i,j;
    for(i = 0 ; i < n1 ; i++)
        l[i] = a[p+i-1];
    for(i = 0 ; i < n2 ; i++)
        ri[i] = a[q+i]; 
```

您正在编写从 index`p-1`到 index `q-1`to`l`的元素，以及从 index`q`到`r-1`to的元素`ri`。如果`p == 0`，则访问越界。

但是，您希望对从 index`p`到的元素进行排序`r`。

```
void merge(int *a,int p,int q,int r){
    int n1 = q - p + 1;
    int n2 = r - q;
    int* l = malloc((n1)*sizeof(int));
    int* ri = malloc((n2)*sizeof(int));
    int i,j;
    for(i = 0 ; i < n1 ; i++)
        l[i] = a[p+i];
    for(i = 0 ; i < n2 ; i++)
        ri[i] = a[q+i+1]; 
```

此外，您应该检查两个索引是否都`i`小于`j`相应的结束索引`n1`。`n2`，当一个到达其部分的末尾时，将其余部分从另一部分复制到数组中。如果数组包含大条目，则保护值会严重失败。

```
while(i < n1 && j < n2) {
    if (ri[j] < l[i]) {
        a[k++] = ri[j++];
    } else {
        a[k++] = l[i++];
    }
}
while(i < n1) {
    a[k++] = l[i++];
}
while(j < n2) {
    a[k++] = ri[j++];
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-09T17:52:36.333

在`mergeSort()`代码中，您有：

```
int q = ( p + r ) / 2;
mergeSort(a,p,q);
mergeSort(a,p+1,r);
merge(a,p,q,r); 
```

我认为第二个`mergeSort`应该是`mergeSort(a, q+1, r);`，不是吗？

[这与Daniel Fischer的](https://stackoverflow.com/users/1011995/daniel-fischer)[分析](https://stackoverflow.com/a/14243333/15168)是分开且独立的。

* * *

在`merge()`中，您分配了两个数组。您不释放这些数组。这是内存泄漏。您还应该检查分配是否成功。

# python - 研究后与标题排序

> ID：14243233
> 
> 赞同：0
> 
> 时间：2013-01-09T17:43:45.387
> 
> 标签：python, sqlite, pyqt

我有这样的功能：

```
def research(self):

    query = QtSql.QSqlQuery()
    query.prepare("SELECT * FROM videos WHERE name_simple LIKE ?")

    query.bindValue(0, "%" + liste.simpleChar(self.research_bar.text()) + "%")
    query.exec_()

    self.modele.setQuery(query)

    self.tableau.doubleClicked.connect(self.launchFile)
    self.tableau.setModel(self.modele) 
```

它在数据库中执行请求，并返回一些视频。我的水平标题有以下字段：“姓名”、“投票”、“日期”。但是，当我单击其中一个字段时，视图会返回到原始模型，其中包含所有视频，而不仅仅是函数返回的视频。

我这样定义我的标题：

```
self.horizontal_header = QtGui.QHeaderView(QtCore.Qt.Horizontal) 
self.horizontal_header.setDefaultAlignment(QtCore.Qt.AlignLeft)
self.horizontal_header.setClickable(True)
self.tableau.horizontalHeader().setResizeMode(5, QtGui.QHeaderView.Fixed)
self.tableau.resizeColumnToContents(1)
self.tableau.setHorizontalHeader(self.horizontal_header)
self.tableau.hideColumn(0)
self.tableau.hideColumn(2)
self.tableau.hideColumn(4)
#self.tableau.hideColumn(6)
self.tableau.hideColumn(7)
self.tableau.horizontalHeader().moveSection(5, 0)
self.tableau.verticalHeader().setDefaultSectionSize(72)
self.tableau.setColumnWidth(5, 127)
self.tableau.setSortingEnabled(True)
self.tableau.verticalHeader().setVisible(False) 
```

而且我无法按名称、投票或日期对返回的视频进行排序。你知道我为什么会有这种行为吗？

# jquery - .val() 没有返回正确的值

> ID：14243236
> 
> 赞同：1
> 
> 时间：2013-01-09T17:43:58.110
> 
> 标签：jquery

我有以下代码在选择框的更改时运行：

```
 $('#reg-phone-type').change( function() {
      console.dir($(this));
      console.log("$(this).val():" + $(this).val());
    if( $(this).val == 'work' ) {
      // do one thing
    } else {
      // do something else
    }
  }); 
```

当我打印出来时，`console.dir($(this));`我可以看到所选选项已设置（在我的屏幕截图示例中）为“工作”（标签是正确的大小写，但实际选项值较低，所以我知道我没有处理案例问题）。

![在此处输入图像描述](../Images/24782ba5901dbbe39db982e43f333b17.png)

这是更改选择框后来自 Firebug 的 HTML（默认为“home”）：

![在此处输入图像描述](../Images/ed953ddc06b6cbdc1616d0ba17d99544.png)

```
<select name="regPhoneType" id="reg-phone-type" style="display: none;" value="work">
    <option value="home">Home</option>
    <option value="work" selected="selected">Work</option>
    <option value="cell">Cell</option>
</select> 
```

因此您可以看到该选项被正确选择。那么，为什么在我的 jquery 中，仅在一行之后，我调用`console.log("$(this).val():" + $(this).val());`，我会得到“家”而不是“工作”吗？我的理解是`.val()`返回选择框的选定选项的值，所以我应该得到“工作”。

![在此处输入图像描述](../Images/865da2e071733771702195dc6ad91e96.png)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-09T17:47:06.127

尝试：

```
$('#reg-phone-type option:selected').val(); 
```

或者

```
$('option:selected',this).val(); 
```

# exception - 迁移休眠 1 到 3.3

> ID：14243239
> 
> 赞同：0
> 
> 时间：2013-01-09T17:44:10.933
> 
> 标签：exception, casting, hibernate3

我们正在将一个项目从休眠 1 迁移到休眠 3.3.1，我们遇到了一些查询问题：

*java.lang.ClassCastException：java.lang.String 无法转换为 java.lang.Long*

我们现在拥有的代码，曾经在 hibernate 1 中工作，但在 hibernate 3.3.1 中出现上述异常，这段代码是：

```
 if(args!=null){
            for(int i=0; i<args.length; i++)
                queryObject.setParameter(i, args[i]);
        } 
```

args 是一个对象 []

查询是，例如：

```
select obj.oid,obj.codTipoTrafico,obj.nomEmpresaOper,obj.codOrigen,obj.codFuente,obj.codIdnFuente,to_char(obj.fecFuente,'DD/MM/YYYY') from OperacionComercial obj where obj.indTpoOper = ? and obj.oidEmpresa = ? order by  order by obj.oca desc 
```

Hibernate 不能再从 String*自动转换*为 Long 了？

提前致谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-11T12:52:01.247

更改休眠配置属性“hibernate.query.factory_class”以将 ClassicQueryTranslator 用于 HQL，问题就解决了……（至少对我而言）。

```
<props>
     <prop key="hibernate.query.factory_class">
          org.hibernate.hql.classic.ClassicQueryTranslatorFactory
    </prop>
</props> 
```

# node.js - 在 Yeoman 的 server/watch/reload 任务中集成 Jade

> ID：14243245
> 
> 赞同：15
> 
> 时间：2013-01-09T17:44:57.870
> 
> 标签：node.js, build-automation, pug, gruntjs, yeoman

我一直在玩[Yeoman](http://yeoman.io/) & [Jade](http://jade-lang.com/)。我通过`yeoman init angular`（它是一个角度应用程序，但这不是重点）创建了一个小型测试应用程序......

当我`yeoman server`在命令行输入时，它将：

*   编译[咖啡脚本](http://coffeescript.org/)和[指南针](http://compass-style.org/)文件
*   启动服务器
*   启动浏览器
*   在浏览器中观看和重新加载咖啡脚本和指南针的变化

这是Yeoman的一大特色！

**现在我想要与 Jade 相同的功能。**所以我通过安装grunt **[-jade](https://github.com/phated/grunt-jade)****并在GruntFile.js**`npm install grunt-jade`中添加以下配置来编译玉模板：

 **```
 jade: {
      html: {
        src: ['app/views/*.jade'],
        dest: 'app/views',
        options: {
          client: false
        }
      }
    }, 
```

通过在任务中添加以下配置，我能够将`jade`任务集成到**Yeoman 的 watch & reload 任务**`watch`中：

```
 watch: {
     ...
     jade: {
       files: 'app/views/*.jade',
       tasks: 'jade reload'
     },
     ...
  } 
```

一切都非常好......除了初始编译不会发生，除非我将`jade`任务添加到命令中：

```
yeoman jade server 
```

我们的管家不喜欢这个好女孩，因为他不会让她融入他的`server`任务:) 这很烦人，因为`yeoman server`只会编译咖啡脚本和指南针文件。

**有什么办法可以将`jade`任务添加到默认执行`yeoman server`？**

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2013-01-09T20:30:43.187

我们创建了有关如何将 Jade 与 Yeoman 集成的指南：[使用 Yeoman 和 Jade](https://gist.github.com/passy/5229305)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-10T08:58:32.640

确保添加

```
 grunt.loadNpmTasks('grunt-jade'); 
```

在你的 gruntfile 之上，否则 yeoman 不知道如何处理“jade”任务

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-07-04T14:32:46.083

[在https://gist.github.com/passy/5229305](https://gist.github.com/passy/5229305)上有一个很好的指南来一起使用 Yeoman 1.0 和 Jade**

# php - Sphinx/PHP：Sphinx 可以返回给定数组的匹配顺序吗？

> ID：14243247
> 
> 赞同：0
> 
> 时间：2013-01-09T17:45:03.757
> 
> 标签：php, mysql, search-engine, sphinx

使用 Sphinx 2.0.6，有没有办法让 sphinx 根据文档 ID 返回特定顺序？

例如，假设有 1000 个文档的 id 均为 1-1000。但我想按顺序返回 ID 999,1000,4,5,2，依此类推。

**这个用例：**定位是动态的，需要通过 Sphinx 来完成。定位值需要作为可以动态更改的属性。这也是分页的——所以我不能简单地收集 ID 集并请求 SQL。狮身人面像本身需要返回我给它的特定命令。

```
$cl->setSelect("*,FIND_IN_SET(id,".implode($id_array).") AS id_position");
$cl->SetSortMode(SPH_SORT_EXTENDED, 'id_position DESC');

$cl->setSelect("*,FIELD(id,".implode($id_array).") AS id_position");
$cl->SetSortMode(SPH_SORT_EXTENDED, 'id_position DESC'); 
```

不幸的是，Sphinx 似乎不支持 FIELD() 和 FIELD_IN_SET()。

任何想法如何完成此任务？我现在不知所措，可以使用帮助！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-09T17:52:49.977

你需要使用那个数组结构吗？使用 Sphinx，您可以使用“ORDER BY id”语句，然后在获取结果时使用：

$cl->SetSortMode(SPH_SORT_ATTR_DESC, "id");

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-09T22:19:11.330

谢天谢地想通了！这是能够通过动态 id 数组进行排序的绝佳解决方案。（现实世界使用......用户的最爱，推荐的产品，用户最常访问的）

狮身人面像 PHP 代码：

```
$cl->SetOverride("id_position", SPH_ATTR_INTEGER, user_id_position());
$cl->SetSortMode(SPH_SORT_EXTENDED, "id_position ASC"); 
```

创建关联数组的 PHP 函数：

```
function user_id_position() {
        $id = $_original_id_list // This variable is the original id list that is in the correct order
        $max = count($id);
        $set = array();
        for ($i=0;$i < $max;$i++)
            $set[$id[$i]] = $i; // turns the array into array(document_id1 => position, document_id2 => position, ...)
        return $set;
} 
```

狮身人面像配置文件

```
source index_name
{
    sql_query                       = \
            SELECT \
                    *, 0 as id_position \
            FROM \
                    database_table;
    sql_attr_uint         = id_position
} 
```

将信息添加到 sphinx.conf 后，您需要 --rotate 并且它会起作用

# c# - StreamReader.Readline() 真的是计算文件中行数的最快方法吗？

> ID：14243249
> 
> 赞同：14
> 
> 时间：2013-01-09T17:45:16.960
> 
> 标签：c#, streamreader, readline, lines, peek

在环顾四周时，我发现了很多关于如何计算文件中行数的讨论。

例如这三个：
[c# 如何计算](https://stackoverflow.com/questions/496663/c-sharp-how-do-i-count-lines-in-a-textfile)
[文本文件中的行数 确定文本文件中的行](https://stackoverflow.com/questions/119559/determine-the-number-of-lines-within-a-text-file)
[数 如何快速计算行数？](https://stackoverflow.com/questions/6101367/how-to-count-lines-fast)

所以，我继续前进并最终使用了我能找到的最有效（至少在记忆方面？）的方法：

```
private static int countFileLines(string filePath)
{
    using (StreamReader r = new StreamReader(filePath))
    {
        int i = 0;
        while (r.ReadLine() != null) 
        { 
            i++; 
        }
        return i;
    }
} 
```

但是当文件中的行本身很长时，这需要很长时间。真的没有更快的解决方案吗？

我一直在尝试使用`StreamReader.Read()`，`StreamReader.Peek()`但我不能（或不知道如何）让它们中的任何一个在有“东西”（字符？文本？）时立即进入下一行。

请问有什么想法吗？

* * *

**结论/结果**（根据提供的答案运行一些测试后）：

我在两个不同的文件上测试了下面的 5 种方法，我得到了一致的结果，这似乎表明普通旧`StreamReader.ReadLine()`方法仍然是最快的方法之一......老实说，在答案中的所有评论和讨论之后，我感到困惑。

**文件 #1：**
大小：3,631 KB
行数：56,870

文件 #1 的结果以秒为单位：
0.02 --> ReadLine 方法。
0.04 --> 读取方法。
0.29 --> ReadByte 方法。
0.25 --> Readlines.Count 方法。
0.04 --> ReadWithBufferSize 方法。

**文件 #2：**
大小：14,499 KB
行数：213,424

文件 #1 的结果以秒为单位：
0.08 --> ReadLine 方法。
0.19 --> 读取方法。
1.15 --> ReadByte 方法。
1.02 --> Readlines.Count 方法。
0.08 --> ReadWithBufferSize 方法。

以下是我根据收到的所有反馈测试的 5 种方法：

```
private static int countWithReadLine(string filePath)
{
    using (StreamReader r = new StreamReader(filePath))
    {
    int i = 0;
    while (r.ReadLine() != null)
    {
        i++;
    }
    return i;
    }
}

private static int countWithRead(string filePath)
{
    using (StreamReader _reader = new StreamReader(filePath))
    {
    int c = 0, count = 0;
    while ((c = _reader.Read()) != -1)
    {
        if (c == 10)
        {
        count++;
        }
    }
    return count;
    }            
}

private static int countWithReadByte(string filePath)
{
    using (Stream s = new FileStream(filePath, FileMode.Open))
    {
    int i = 0;
    int b;

    b = s.ReadByte();
    while (b >= 0)
    {
        if (b == 10)
        {
        i++;
        }
        b = s.ReadByte();
    }
    return i;
    }
}

private static int countWithReadLinesCount(string filePath)
{
    return File.ReadLines(filePath).Count();
}

private static int countWithReadAndBufferSize(string filePath)
{
    int bufferSize = 512;

    using (Stream s = new FileStream(filePath, FileMode.Open))
    {
    int i = 0;
    byte[] b = new byte[bufferSize];
    int n = 0;

    n = s.Read(b, 0, bufferSize);
    while (n > 0)
    {
        i += countByteLines(b, n);
        n = s.Read(b, 0, bufferSize);
    }
    return i;
    }
}

private static int countByteLines(byte[] b, int n)
{
    int i = 0;
    for (int j = 0; j < n; j++)
    {
    if (b[j] == 10)
    {
        i++;
    }
    }

    return i;
} 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-01-09T17:51:06.550

不它不是。重点是 - 它实现了不需要的字符串。

要计算它，最好忽略“字符串”部分并转到“行”部分。

LINE 是一系列以 \r\n (13, 10 - CR LF) 或其他标记结尾的字节。

只需在缓冲流中沿着字节运行，计算行尾标记的出现次数。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-01-09T17:57:29.240

知道如何快速做到这一点的最好方法是考虑在不使用 C/C++ 的情况下最快的方法。

在汇编中，有一个 CPU 级别的操作会扫描内存中的字符，因此在汇编中您将执行以下操作

*   将文件的大部分（或全部）读入内存
*   执行 SCASB 命令
*   根据需要重复

因此，在 C# 中，您希望编译器尽可能接近这一点。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2013-01-09T21:20:05.333

我尝试了多种方法并测试了它们的性能：

读取单个字节的方法比其他方法慢约 50%。其他方法都返回大约相同的时间。您可以尝试创建线程并异步执行此操作，因此在等待读取时，您可以开始处理先前的读取。这听起来让我很头疼。

我会选择一个班轮：`File.ReadLines(filePath).Count();`它的性能与我测试的其他方法一样好。

```
 private static int countFileLines(string filePath)
        {
            using (StreamReader r = new StreamReader(filePath))
            {
                int i = 0;
                while (r.ReadLine() != null)
                {
                    i++;
                }
                return i;
            }
        }

        private static int countFileLines2(string filePath)
        {
            using (Stream s = new FileStream(filePath, FileMode.Open))
            {
                int i = 0;
                int b;

                b = s.ReadByte();
                while (b >= 0)
                {
                    if (b == 10)
                    {
                        i++;
                    }
                    b = s.ReadByte();
                }
                return i + 1;
            }
        }

        private static int countFileLines3(string filePath)
        {
            using (Stream s = new FileStream(filePath, FileMode.Open))
            {
                int i = 0;
                byte[] b = new byte[bufferSize];
                int n = 0;

                n = s.Read(b, 0, bufferSize);
                while (n > 0)
                {
                    i += countByteLines(b, n);
                    n = s.Read(b, 0, bufferSize);
                }
                return i + 1;
            }
        }

        private static int countByteLines(byte[] b, int n)
        {
            int i = 0;
            for (int j = 0; j < n; j++)
            {
                if (b[j] == 10)
                {
                    i++;
                }
            }

            return i;
        }

        private static int countFileLines4(string filePath)
        {
            return File.ReadLines(filePath).Count();
        } 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2013-01-09T17:52:47.847

```
public static int CountLines(Stream stm)
{
    StreamReader _reader = new StreamReader(stm);
    int c = 0, count = 0;
    while ((c = _reader.Read()) != -1)
    {
        if (c == '\n')
        {
            count++;
        }
    }
    return count;
} 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2013-01-09T18:18:46.603

是的，从任何实际意义上来说，这样的阅读方式都是最快和最简单的方法。

这里没有捷径。文件不是基于行的，因此您必须从文件中读取每个字节以确定有多少行。

正如 TomTom 所指出的，创建字符串并不是绝对需要计算行数，但大部分时间都花在等待从磁盘读取数据上。编写一个更复杂的算法可能会减少百分之一的执行时间，并且会大大增加编写和测试代码的时间。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2014-09-06T02:16:38.340

有很多方法可以读取文件。通常，*最快*的方法是最简单的：

```
using (StreamReader sr = File.OpenText(fileName))
{
        string s = String.Empty;
        while ((s = sr.ReadLine()) != null)
        {
               //do what you gotta do here
        }
} 
```

[这个页面对几种不同的技术进行了很好的性能比较](http://cc.davelozinski.com/c-sharp/fastest-way-to-read-text-files)，包括使用 BufferedReaders、读入 StringBuilder 对象和整个数组。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2016-07-29T22:14:45.497

`StreamReader`通常不是读取文件的最快方法，因为将字节编码为字符的开销很小，因此读取字节数组中的文件更快。
由于缓存和其他进程，我每次得到的结果都有些不同，但这是我用 16 MB 文件得到的结果之一（以毫秒为单位）：

```
75 ReadLines 
82 ReadLine 
22 ReadAllBytes 
23 Read 32K 
21 Read 64K 
27 Read 128K 
```

一般来说，应该比循环 `File.ReadLines`慢一点 。文件较大时速度较慢，并且文件较大时会抛出内存不足异常。默认缓冲区大小为4K，但在我的机器上 64K 似乎是最快的。`StreamReader.ReadLine``File.ReadAllBytes``FileStream`

```
 private static int countWithReadLines(string filePath)
    {
        int count = 0;
        var lines = File.ReadLines(filePath);

        foreach (var line in lines) count++;
        return count;
    }

    private static int countWithReadLine(string filePath)
    {
        int count = 0;
        using (var sr = new StreamReader(filePath))      
            while (sr.ReadLine() != null)
                count++;
        return count;
    }

    private static int countWithFileStream(string filePath, int bufferSize = 1024 * 4)
    {
        using (var fs = new FileStream(filePath, FileMode.Open, FileAccess.Read))
        {
            int count = 0;
            byte[] array = new byte[bufferSize];

            while (true)
            {
                int length = fs.Read(array, 0, bufferSize);

                for (int i = 0; i < length; i++)
                    if(array[i] == 10)
                        count++;

                if (length < bufferSize) return count;
            }
        } // end of using
    } 
```

并通过以下方式测试：

```
var path = "1234567890.txt"; Stopwatch sw; string s = "";
File.WriteAllLines(path, Enumerable.Repeat("1234567890abcd", 1024 * 1024 )); // 16MB (16 bytes per line)

sw = Stopwatch.StartNew(); countWithReadLines(path)   ; sw.Stop(); s += sw.ElapsedMilliseconds + " ReadLines \n";
sw = Stopwatch.StartNew(); countWithReadLine(path)    ; sw.Stop(); s += sw.ElapsedMilliseconds + " ReadLine \n";
sw = Stopwatch.StartNew(); countWithReadAllBytes(path); sw.Stop(); s += sw.ElapsedMilliseconds + " ReadAllBytes \n";

sw = Stopwatch.StartNew(); countWithFileStream(path, 1024 * 32); sw.Stop(); s += sw.ElapsedMilliseconds + " Read 32K \n";
sw = Stopwatch.StartNew(); countWithFileStream(path, 1024 * 64); sw.Stop(); s += sw.ElapsedMilliseconds + " Read 64K \n";
sw = Stopwatch.StartNew(); countWithFileStream(path, 1024 *128); sw.Stop(); s += sw.ElapsedMilliseconds + " Read 128K \n";

MessageBox.Show(s); 
```

# jsf - 如何更改primefaces中的菜单按钮图标？

> ID：14243253
> 
> 赞同：2
> 
> 时间：2013-01-09T17:45:37.917
> 
> 标签：jsf, primefaces, icons

我想在 ap:menuButton 中放一个自定义图标，这可能吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-09T22:50:34.360

是的，这是可能的。您需要做*的*就是**覆盖**为.*`p:menuButton`*

 *方法：

1.  在呈现的网页中，您可以右键单击生成的`p:menuButton`和 -> 检查元素。在那里您可以检查所有相关的*css 类*。
2.  您可以尝试对它们进行试验（如果您有时间，我会建议您这样做）以更好地理解*css 选择器*等等......
3.  这些`.ui-menubutton .ui-state-default .ui-icon`是您需要的课程。

因此，现在当您知道哪些*css 类*与图标相关时，您可以覆盖它们：

将`.ui-menubutton .ui-state-default .ui-icon`规则添加到您的*样式表*（我假设您有一个并且它已成功导入并正常工作。如果没有检查[这里](https://stackoverflow.com/a/14205456/1317692)。）

*yourStyles.css*：

```
.ui-menubutton .ui-state-default .ui-icon {
    background: orange; /** insert your background image **/
} 
```

这将覆盖`p:menuButtons`项目中使用的所有图标。如果您想将其减少到某个特定`p:menuButton`值，请将其 ID 添加到*样式*定义中。

```
#menubID.ui-menubutton .ui-state-default .ui-icon {
        background: orange; /** insert your background image **/
    } 
```*

# c# - 如何使用客户端对象模型检索呈现的 Sharepoint WebPart 数据

> ID：14243254
> 
> 赞同：2
> 
> 时间：2013-01-09T17:45:40.397
> 
> 标签：c#, sharepoint, sharepoint-2010, web-parts, sharepoint-clientobject

我正在尝试使用客户端对象模型从 sharepoint 2010 站点远程访问数据。对于某些限制，即使我使用 CAML 查询，我也无法使用我无法根据用户登录过滤适当的受众（如果您可以帮助我了解 CAML 查询也可以：我不知道如何获取当前用户受众名称和所有使用 CAML/客户端对象模型的受众。此代码位于移动站点上并调用共享点站点，如我的代码所示）。以下代码运行良好，但无法从 webpart 获取内容。有人可以帮助解决这个问题。

```
 using (ClientContext ctx = new ClientContext("https://mysite.com/Pages/Default.aspx"))
      {
                 ctx.ExecutingWebRequest += new EventHandler<WebRequestEventArgs>   (clientContext_ExecutingWebRequest);    

                 File home=ctx.Web.GetFileByServerRelativeUrl("/Student/Pages/default.aspx");                      
             //get the web part manager
                     Microsoft.SharePoint.Client.WebParts.LimitedWebPartManager wpm = home.GetLimitedWebPartManager(Microsoft.SharePoint.Client.WebParts.PersonalizationScope.Shared);

                IEnumerable<Microsoft.SharePoint.Client.WebParts.WebPartDefinition> wpds = null;
             //create the LINQ query to get the web parts from
             //the web part definition collection
                wpds = ctx.LoadQuery(wpm.WebParts.Include(wp => wp.Id,wp => wp.WebPart)); 
             //load the list of web parts
                ctx.ExecuteQuery();
             //enumerate the results
                foreach (Microsoft.SharePoint.Client.WebParts.WebPartDefinition wpd in wpds)
                {
                   string title=  wpd.WebPart.Title;
                   Microsoft.SharePoint.Client.WebParts.WebPart wpart = wpd.WebPart;     

                  ????? How to render and receive the data (looking for the same data When you browse the site with the browser)      
                }

              Code continues... 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-08T11:12:08.470

我也在为这个问题而苦苦挣扎。看起来这对于客户端对象模型来说是不可能的。实际上，我已经在 Build Conference 2012 上向一些 SharePoint 工作人员询问过。

但是，使用 SharePoint Designer 实际上可以下载所需的 WebPart。Fiddler 可能会派上用场来追踪哪些服务将为您提供这些位。

[在 SharePoint StackExchange 上](https://sharepoint.stackexchange.com/questions/38931/get-the-content-of-a-content-webpart-with-the-client-object-model)查看这篇文章

不幸的是，这篇文章不会给你任何具体的方法来解决它。

祝你好运！

# iphone - iPhone 以更高的屏幕分辨率显示“移动”网站

> ID：14243256
> 
> 赞同：1
> 
> 时间：2013-01-09T17:45:46.830
> 
> 标签：iphone, html, css, mobile, web

我目前正在开发一个网站的“移动版本”，该网站主要针对更多当前的 iPhone（4+），这是我第一次这样做。我在 iPhone 4S 上进行测试，我的理解是该设备的屏幕分辨率为 640x920（当以“纵向”方向放置时）。我将网站上的所有内容都放在一个 600 像素宽的容器中，尽管当我在手机上查看它时，它似乎默认以“缩小”状态显示，因为我仍然可以看到类似 1000-1200 像素的内容屏幕。

我假设 iPhone 以这种方式显示网站，因为许多网站不是为了适应它的较小分辨率而设计的？我在这里缺少什么吗？我是否设置了一些东西来告诉设备以实际分辨率显示网站？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-09T17:59:52.730

您需要在 html 头中添加视口元标记。

```
<meta name="viewport" content="width=device-width"> 
```

这告诉浏览器应将视口（虚拟宽度）设置为设备宽度（物理宽度）。

# jquery - 循环动态生成的选项

> ID：14243258
> 
> 赞同：0
> 
> 时间：2013-01-09T17:45:51.787
> 
> 标签：jquery

嗨，我正在尝试找到一种方法来遍历一些动态生成的选项。我尝试这样做：

```
console.log($("select#subcategory option").length);
$("select#subcategory option").each(function () {

            console.log($(this).val() + "ceva");
            if ($(this).val() == subcategoryId) {
                console.log($(this).val());
                $(this).attr("selected", "selected");
            }
}); 
```

但似乎 jQUery 没有看到任何生成的项目。我使用的是 jquery 1.5.1。

我怎么解决这个问题？

**编辑**

到目前为止，我在设法选择生成的元素方面没有运气。从到目前为止我尝试过的方法中，我可以看出两者都无法看到动态创建的 dom 元素。就好像它们不存在一样，但是如果我检查 Firebug 我可以看到它们。这个问题是否会出现，因为我在 ajax 调用后创建它们？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-09T17:47:36.037

您可以使用普通的 javascript ：

```
 var select = document.getElementById('subcategory');
   for (var i=0; i<select.options.length; i++) {
       console.log(select.options[i]);
       if (select.options[i].value==subcategoryId) {
            select.selectedIndex = i;
            break;
       }
   } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-09T18:11:41.027

试试这个：

```
$(document).find("select#subcategory option").each(function () {
    var subcategoryId = $('#subcategory').attr('id');
    console.log($(this).val() + "ceva");
    if ($(this).val() == subcategoryId) {
       console.log($(this).val());
       $(this).prop("selected", true);
    }
 }); 
```

# jqgrid - jqGrid：从层次网格中单击的行中获取数据

> ID：14243259
> 
> 赞同：0
> 
> 时间：2013-01-09T17:46:00.290
> 
> 标签：jqgrid

我目前正在开发一个使用带有多个子网格的 jqGrid 的项目。当单击或双击行时，我正在尝试获取 rowid（并获取行内的数据）。最终我想用点击行中的数据填充一个文本框。

我在这里使用 ondblClickRow 和 onSelectRow 示例尝试了一些变体，但无法使其正常工作。我想我错过了一些非常简单的东西，但看不到什么。所以我回去并尽可能简化它，只识别行点击并显示警报。这对我也不起作用。

（基于[jqGrid 中的示例：问题加载具有本地数据类型的嵌套子网格](https://stackoverflow.com/questions/13767408/jqgrid-issue-loading-nested-sub-grid-with-local-datatype/13779589#comment19031920_13779589)）在底部附近查找 //*************** 部分..

```
var myData = [
// main grid data
     { id: "1", col1: "11", col2: "12",
         subgrid: [
                // data for subgrid for the id=m1
                    { id: "1", c1: "aa", c2: "ab", c3: "ac",
                        subgrid: [
                            // data for subgrid for the id=m1, subgridId=s1a
                            { id: "1", d1: "2aa", d2: "2ab", d3: "2ac" },
                            { id: "2", d1: "2ba", d2: "2bb", d3: "2bc" },
                            { id: "3", d1: "2ca", d2: "2cb", d3: "2cc" }
                        ]},
                { id: "2", c1: "ba", c2: "bb", c3: "bc" },
                { id: "3", c1: "ca", c2: "cb", c3: "cc" }
         ]},
    { id: "2", col1: "21", col2: "22",
        subgrid: [
            // data for subgrid for the id=m2
            { id: "1", c1: "1xx", c2: "1xy", c3: "1xz",
                subgrid: [
                    // data for subgrid for the id=m2, subgridId=s2a
                    { id: "1", d1: "2xx", d2: "2xy", d3: "2xz" }
                ]}
        ]},
    { id: "3", col1: "31", col2: "32" }
],
removeSubgridIcon = function () {
    var $this = $(this),
        idPrefix = $this.jqGrid("getGridParam", "idPrefix");
    $this.find(">tbody>tr.jqgrow>td.ui-sgcollapsed").filter(function () {
        var rowData = $this.jqGrid("getLocalRow",
                $.jgrid.stripPref(idPrefix, $(this).closest("tr.jqgrow").attr("id")));
        return rowData.subgrid == null;
    }).unbind("click").html("");
},
isHasSubrids = function (data) {
    var l = data.length, i;
    for (i = 0; i < l; i++) {
        if (data[i].subgrid != null) {
            return true;
        }
    }
    return false;
},
specificGridOptions = [
    {
        colNames: ["Column 1", "Column 2"],
        colModel: [
            { name: "col1" },
            { name: "col2" }
        ],
        cmTemplate: { width: 200 },
        sortname: "col1",
        sortorder: "desc",
        idPrefix: "s_",
        pager: "#pager",
        caption: "Demonstrate how to create subgrid from local hierarchical data"
    },
    {
        colNames: ["Colunm1", "Colunm2", "Colunm3"],
        colModel: [
            { name: "c1" },
            { name: "c2" },
            { name: "c3" }
        ],
        cmTemplate: { width: 112 },
        sortname: "c1",
        sortorder: "desc"
    },
    {
        colNames: ["Col 1", "Col 2", "Col 3"],
        colModel: [
            { name: "d1" },
            { name: "d2" },
            { name: "d3" }
        ],
        cmTemplate: { width: 90 },
        sortname: "d1",
        sortorder: "desc"
    }
],
commonGridOptions = {
    datatype: "local",
    gridview: true,
    rownumbers: true,
    autoencode: true,
    height: "100%",
    //***************
    onSelectRow : function () 
    {
        alert('test!');
    },
    //also tried many variation on this
    ondblClickRow: function(rowid) 
    {
        alert(rowid);
    }
    //***************
    loadComplete: function () {
        // one can use loadComplete: removeSubgridIcon, but I included
        // curent implementation of loadComplete only to show how to call
        // removeSubgridIcon from your loadComplete callback handler
    removeSubgridIcon.call(this);
},
subGridRowExpanded: function (subgridDivId, rowId) {
    var $subgrid = $("<table id='" + subgridDivId + "_t'></table>"),
        subgridLevel = $(this).jqGrid("getGridParam", "subgridLevel") + 1,
        parentIdPrefix = $(this).jqGrid("getGridParam", "idPrefix"),
        pureRowId = $.jgrid.stripPref(parentIdPrefix, rowId),
        localRowData = $(this).jqGrid("getLocalRow", pureRowId);
    $subgrid.appendTo("#" + $.jgrid.jqID(subgridDivId));
    $subgrid.jqGrid($.extend(true, {}, commonGridOptions, specificGridOptions       [subgridLevel], {
        data: localRowData.subgrid,
        subGrid: isHasSubrids(localRowData.subgrid),
        subgridLevel: subgridLevel,
        idPrefix: rowId + "_",
        rowNum: 10000 // we use this to have no pager in the subgrids
    }));
}
};

$("#list").jqGrid($.extend(true, {}, commonGridOptions, specificGridOptions[0], {
    data: myData,
    subgridLevel: 0,
    subGrid: isHasSubrids(myData)
})); 
```

任何人都知道为什么它无法识别行单击/双击？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-10T10:45:36.907

您在评论中写道，您从服务器获取网格数据。我想`datatype: "local"`在这种情况下使用的不是最好的选择。看看我描述如何做同样的方式[的答案](https://stackoverflow.com/a/14205263/315935)`datatype: "json"`，但使用.

现在我回到你的主要问题。我不明白您要填充什么文本框（HTML 输入元素）以及输入元素是在网格内部还是在网格外部。不过，您可能遇到的唯一问题是正确使用`idPrefix`jqGrid 选项。

了解 jqGrid 使用 HTML`<table>`来表示网格主体非常重要。**在 jqGrid 的当前实现中，****必须有****每个`<tr>`元素的`<table>``id`**属性。因此，`id`输入数据中的属性将用于分配元素`id`属性的值。`<tr>`如果页面上有多个网格，或者如果一个网格带有子网格，则很容易接收`id`到所有版本的 HTML 或 XHTML 中不允许的重复项。

其他潜在问题是使用数字作为`id`值。大多数数据库都支持自增数据类型，作为表的键非常实用。在这种情况下`id`，数据库表和网格行的本机（键）将是整数。另一方面，还有一些额外的限制取决于使用的 HTML/XHTML 版本。例如 HTML5 规范说（见[这里](http://www.w3.org/TR/html5/dom.html#the-id-attribute)）

> 该值在元素的主子树中的所有 ID 中必须是唯一的，并且**必须至少包含一个字符**。该值不得包含任何空格字符。

因此，即使大多数 Web 浏览器允许使用数字作为`id`属性的值，但它是不允许的，并且在使用它的情况下可能会出现兼容性问题。

为了解决上述所有问题，jqGrid 支持`idPrefix`选项（这是根据我的建议顺便介绍的）。在这种情况下，`id`属性的值将被构建为输入数据的连接`idPrefix`。`id`例如，在示例 jqGrid 的主网格中使用`idPrefix: "s_"`和`id`值“1”、“2”、“3”的情况下，jqGrid 将分配`"s_1"`, `"s_2"`,`"s_3"`作为主网格元素的`id`属性值。`<tr>`所有回调中的`rowid`将是来自`id`属性 ( `"s_1"`, `"s_2"`, `"s_3"`) 的值。如果您需要获取*原件* `id`，您可以使用`$.jgrid.stripPref`去除前缀。jqGrid 将发送到服务器的所有 id 都将被规范化（`$.jgrid.stripPref`将被 jqGrid 本身调用）。

因此，显示如何获取数据的代码`onSelectRow`可能`ondblClickRow`如下

```
onSelectRow: function (rowid, stat, e) {
    myDebugTrace.call(this, "onSelectRow", rowid);
},
ondblClickRow: function (rowid, iRow, iCol, e) {
    myDebugTrace.call(this, "ondblClickRow", rowid);
    e.stopPropagation();
},
... 
```

其中`myDebugTrace`函数可以声明为

```
var myDebugTrace = function (startingText, rowid) {
        var $this = $(this), p = $this.jqGrid("getGridParam"), rowData, col1,
            firstCol = (p.rownumbers ? 1 : 0) + (p.subGrid ? 1 : 0);

        rowData = $this.jqGrid("getRowData", rowid);
        col1 = rowData[p.colModel[firstCol].name];
        $("<span>" + startingText + " on " + rowid + " (original id=" +
            $.jgrid.stripPref($(this).jqGrid("getGridParam", "idPrefix"), rowid) +
            "). Data from the first column: \"" + col1 +"\"</span><br/>").appendTo("body");
    }; 
```

双击内部子网格中的行，[相应的演示会显示以下内容。](http://www.ok-soft-gmbh.com/jqGrid/LocalSubgridMultileve3.htm)

![在此处输入图像描述](../Images/3e3158c1bcec8aa39ccdbba90374a97c.png)

# javascript - 如何将 onclick 功能添加到开启器窗口中的元素？

> ID：14243261
> 
> 赞同：0
> 
> 时间：2013-01-09T17:46:08.443
> 
> 标签：javascript, onclick, window.opener

我在一个网页上工作，该网页打开一个带有图片选择器的弹出窗口。添加到选择列表中的图片会立即作为缩略图克隆到打开窗口 - 这部分工作正常。

当我尝试使这些缩略图可点击时会出现问题，如下所示：

```
opener.document.getElementById("someid").onclick = function(){ alert("bam!"); } 
```

到目前为止，我只在弹出窗口仍然打开时才设法让这个工作（而不是我使用的普通 alert(...) `opener.window.alert("bam!")`）。但是，当我关闭弹出窗口时，单击缩略图会导致错误。

有谁有类似的问题并得到它的工作？提前致谢。

更新：

好的，我发现不是最漂亮的解决方案，但到目前为止它有效。我不得不在开启窗口中声明额外的功能：

```
function addbam(id){
    document.getElementById(id).onclick = function(){ alert("bam!"); }
} 
```

在弹出窗口中：

```
opener.addbam("someid"); 
```

如果这个解决方案在多浏览器测试中幸存下来，它会一直存在，但是我很确定应该可以以非常直接的方式从此类 onclick 声明中删除“错误”范围。

谢谢大家，你的建议让我思考更有成效的方式。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-09T17:50:30.200

如果你使用 jquery：

```
$("#someid").on('click', function () {  
    alert("bam");
}); 
```

或**没有**jquery: ---------编辑----------

```
//you put your element in a variablle
var div = document.getElementsByTagName("div")[0];

/*you add an event listenner to your variable, when click is triggered, it runs what's inside the brackets*/
div.addEventListener("click", function (evt) {
    alert("BAM!");
}); 
```

这是一个专为您制作的示例：）

[http://jsfiddle.net/YDFLV/50/](http://jsfiddle.net/YDFLV/50/)

# java - java中JCombo Box的定位

> ID：14243263
> 
> 赞同：4
> 
> 时间：2013-01-09T17:46:12.340
> 
> 标签：java, swing, jcombobox, layout-manager

我想`JComboBox`按照下图所示的方式定位 a。我想知道是否有简单的代码来实现这一点？

![在此处输入图像描述](../Images/cfc34f5a6ff40c50fee269fb37e1b026.png)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-09T17:46:56.797

使用适当的布局管理器，例如[`BoxLayout`](http://docs.oracle.com/javase/7/docs/api/javax/swing/BoxLayout.html). 有关详细信息，请参阅[如何使用 BoxLayout](http://docs.oracle.com/javase/tutorial/uiswing/layout/box.html)。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-09T17:55:31.820

![居中连击](../Images/da2917b7b24b4e4c70447ec345a9d7dd.png)

```
import java.awt.*;
import javax.swing.*;
import javax.swing.border.EmptyBorder;

public class CenteredCombos {

    public static void main(String[] args) {
        Runnable r = new Runnable() {

            @Override
            public void run() {
                String[] values = {"Dog","Cat"};
                // put the controls in a single column, with a little space.
                JPanel controlPanel = new JPanel(new GridLayout(0,1,5,5));
                for (int ii=0; ii<4; ii++) {
                    controlPanel.add(new JComboBox(values));
                }

                // the GUI as seen by the user (without frame)
                // The GBL is used to center the controlPanel
                JPanel gui = new JPanel(new GridBagLayout());
                gui.setBorder(new EmptyBorder(2, 3, 2, 3));
                gui.add(controlPanel);

                // Make the BG panel more clear..
                gui.setBackground(Color.WHITE);

                JFrame f = new JFrame("Demo");
                f.add(gui);
                // Ensures JVM closes after frame(s) closed and
                // all non-daemon threads are finished
                f.setDefaultCloseOperation(JFrame.DISPOSE_ON_CLOSE);
                // See http://stackoverflow.com/a/7143398/418556 for demo.
                f.setLocationByPlatform(true);

                // ensures the frame is the minimum size it needs to be
                // in order display the components within it
                f.pack();
                // should be done last, to avoid flickering, moving,
                // resizing artifacts.
                f.setVisible(true);
            }
        };
        // Swing GUIs should be created and updated on the EDT
        // http://docs.oracle.com/javase/tutorial/uiswing/concurrency/initial.html
        SwingUtilities.invokeLater(r);
    }
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-09T17:49:16.893

您可以将[MigLayout](http://www.miglayout.com/)与行和列约束一起使用，例如`[max][min][max]`- 将您的根面板划分为具有“贪婪”边框的 3x3 网格，并在中间区域（即分钟/分钟）放置一个具有垂直[流布局](http://docs.oracle.com/javase/tutorial/uiswing/layout/flow.html)的 JPanel ，其中你可以添加你的组件

# ruby-on-rails - 生产服务器中 apache 下的多个 Ruby

> ID：14243266
> 
> 赞同：0
> 
> 时间：2013-01-09T17:46:21.573
> 
> 标签：ruby-on-rails, ruby, apache, passenger

我想在我们的生产服务器上运行多个红宝石。我们有一些 ruby​​ 1.9.3 rails 3.2 站点上线，并保留了较旧的 1.8 站点。我知道，Passenger 3.2 将能够在本地执行此操作，但尚未上线。
所以现在，这是最好的方法吗？

[http://blog.phusion.nl/2010/09/21/phusion-passenger-running-multiple-ruby-versions/](http://blog.phusion.nl/2010/09/21/phusion-passenger-running-multiple-ruby-versions/)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-09T18:01:35.677

apache 乘客模块无法做到这一点。但是，您可以为每个应用程序独立运行[乘客](http://www.modrails.com/documentation/Users%20guide%20Standalone.html)（使用不同的 ruby​​ 版本），然后从 apache 代理到乘客独立。

你当然也可以代理独角兽，瘦等。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-09T17:57:19.730

为您的不同版本的 ruby​​ 和 rails 使用多个 VM/Slice 怎么样，这样您就可以更好地控制您的环境，而不必担心您的不同 ruby​​/rails 会导致彼此头痛。

**编辑**

我听说过但没有尝试过的另一个解决方案是设置多个用户并为每个不同的用户运行每个版本的 ruby​​/rails

# nhibernate - 将内存缓存与属性延迟加载一起使用时出现 PropertyAccessException

> ID：14243267
> 
> 赞同：0
> 
> 时间：2013-01-09T17:46:28.620
> 
> 标签：nhibernate, memcached, lazy-loading

我正在开发一个使用 NHibernate (v 3.3.0.4000) 和 memcache (v 3.1.0.4000，这是最新可用的) 的项目。

我有一个包含相当大字符串的大字段。由于我不想在每次调用时都加载此字段，因此我已使用 Fluent Nhibernate 将该属性配置为“延迟加载”。

一切正常（我的属性是按需加载的），除非启用了 memcache。我得到这个例外：

```
NHibernate.PropertyAccessException: The type System.Object can not be assigned to a property of type System.String setter of XYZ ---> System.ArgumentException: Impossible de convertir l'objet de type 'System.Object' en type 'System.String'. 
```

我猜这个问题与“NHibernate.Caches.MemCache”的版本有关，它已经很老了，似乎还没有活着。

我想知道是否有人设法使用惰性属性运行 memcache。如果没有，是否可以禁用单个属性的缓存？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-10T02:22:29.617

看起来这是一个已知的错误： [Retrieving object from 2nd cache with lazy property failed](https://nhibernate.jira.com/browse/NH-2898 "NH-2898")

而且，幸运的是，它已在最新版本中得到修复（截至今天为 3.3.2）

只需更新 NHibernate，问题就会消失。

# c++ - 函数声明中的 const 关键字位置

> ID：14243269
> 
> 赞同：9
> 
> 时间：2013-01-09T17:46:45.233
> 
> 标签：c++, pointers, constants

> **可能重复：**
> [C++ 中 const 声明之间的区别](https://stackoverflow.com/questions/487048/difference-between-const-declarations-in-c)

```
#include <iostream>

class Bar{};

void foo(const Bar x){}  //l5
void foo(Bar x){}        //l6
void foo(Bar const x){}  //l7

////pointer functions

void foo(const Bar* x){} //l11
void foo(Bar* x){}       //l12
void foo(Bar* const x){} //l13 
```

编译器输出：（长话短说`l5`，冲突`l6`；`l7`但只有冲突`l12`）`l13`

```
untitled.cpp:6:6: error: redefinition of ‘void foo(Bar)’
untitled.cpp:5:6: error: ‘void foo(Bar)’ previously defined here
untitled.cpp:7:6: error: redefinition of ‘void foo(Bar)’
untitled.cpp:5:6: error: ‘void foo(Bar)’ previously defined here
untitled.cpp:13:6: error: redefinition of ‘void foo(Bar*)’
untitled.cpp:12:6: error: ‘void foo(Bar*)’ previously defined here 
```

怎么了？

1.  每个声明的含义是什么
2.  为什么所有 3 个声明都与对象函数冲突，但只有 2 个与指针函数冲突？
3.  `l12`请详细说明and之间的冲突`l13`，即使`l12`不包含`const`关键字
4.  如果是琐碎的问题，真的很抱歉

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-09T18:04:37.490

“问题”是`const`参数值的值不参与重载！

首先，`Bar const`和`const Bar`已经是相同的意思，所以他们会自动有问题。但是作为函数参数，`const`它不适用于重载，因此`Bar`函数的版本也看起来相同。参数中的`const`仅告诉编译器您不打算在函数体中修改它。

出于同样的原因，`Bar*`并且`Bar* const`被视为相同：`const`适用于参数的值（不是指向的值）并且不参与重载，因此您定义了相同的函数。

另一方面`const Bar*`意味着完全不同的东西：指向`const`对象（类型`Bar`）的非常量指针。由于类型不同，它确实参与了重载并允许该函数是唯一的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-09T17:54:21.127

将 const 放在类型名称之前还是之后都没有关系。

15 和 17 具有相同的参数自变量列表。
这两个函数被认为具有相同的原型并且是重复的。

功能#1

```
void foo(const int x) {
return;
} 
```

函数 #2 - 重复的参数参数列表

```
void foo( int const x) {
return;
} 
```

const 的位置与您的示例中的 15 和 17 相同。

根据维基百科，两者都可以工作：

[http://en.wikipedia.org/wiki/Const-correctness](http://en.wikipedia.org/wiki/Const-correctness)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-09T17:58:19.440

基本上，因为 C++ 在调用函数时会复制值，所以从调用者的角度来看，前三个没有什么区别。（调用者知道函数不能改变它自己传入的值，因此从调用者的角度来看，每个函数参数在很多方面都是隐式常量）。

但是，当您谈论指针时，如果您将指向常量的指针与指向非常量的指针传递给调用者，则调用者会有所不同（一个不会更改您的东西，另一个可能会）。这就是 l11 和 l12 不冲突的原因。

l12 和 l13 冲突，因为它们都是指向 Bar* 的指针（一个是 const 指针，一个不是，所以与 l5-l7 相同的问题，调用者没有区别）。

这最后一点可能有点棘手——注意虽然`int const *a`和 一样`const int *a`，但这些*不*一样`int * const a`，前两个是指向常量 int 的指针，另一个是指向 int 的常量指针（即指针的值以后不能改）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-09T17:57:26.500

前三个产生冲突的原因是编译器在任何情况下都无法确定要使用哪个函数。当您调用编译器时，无论是否声明为`foo(BarObject);`，编译器都可以很好地使用它们中的任何一个。`BarObject``const`

但是，在以参数为指针的情况下，当您调用`foo(BarPointer);`if`BarPointer`被声明为`const Bar* BarPointer;`编译器时，编译器将选择`]11`，因为它确保指向的对象不会在函数中被修改（在前三个中按值传递时不是这种情况）。如果不是`const`，它不知道它是否应该调用`]12`，或者`]13`因为什么`Bar* const x`意思是，“`x`不能指向除了作为参数传递的任何东西”，这与调用者无关。

对声明的小参考：

```
const Bar x // x is an immutable copy of the original parameter.
Bar const x // same as above and gets compiled, but cdecl says it is a syntax error.

const Bar* x // x points to an object that can't be changed.
Bar* const x // x can't point to any other object than the parameter passed. 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-01-09T18:03:04.563

```
void foo(const Bar x){}
void foo(Bar const x){} 
```

上述两个是相同的，因为两者都 say`x`是`Bar`type 并且 it is `const`。

```
void foo(Bar x){} 
```

这与上述 2 冲突，因为是否`x`是您的函数`const`的*实现细节*，并且被编译器从函数签名中丢弃。因此，所有 3 个函数最终都具有相同的签名，即`void foo( Bar x )`.

```
void foo(Bar* x){}
void foo(Bar* const x){} 
```

这与前一种情况类似；您表示指针`x`是`const`即您不会重新指向`x`函数中的其他内容。在这两种情况下，指向的`Bar`对象都是非. 因此，ness of是函数的实现细节。`x``const``const``x`

```
void foo(const Bar* x){} 
```

在这里，您表示`x`指向的`Bar`对象是`const`. 这与前两种情况不同，因此不存在冲突。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-01-09T18:16:39.930

对于前三个函数 -如果变量按*值*`const`传输，重载分辨率无关紧要。在堆栈上创建的参数副本，如果这个副本从外部（调用者）的角度改变或没有改变，它是没有意义的。它对功能本身（内部）很重要。

 *对于第二种情况，基于指针的函数，它是函数重载解析的重要部分，因为副本不是在堆栈上创建的，从外部（调用者）的角度来看，这意味着函数将或不修改参数的值。

对于最后两个函数，对编译器使用 say：有指向 的`x`指针`Bar`，并且 I 指向的这个`Bar`值`x`可能会改变。但是在第一种情况下，您可以更改与第二种情况相反的指针`x`本身的值（例如，指向另一个）。`Bar`在这里，我们处于第一种情况 - 指针本身的副本在堆栈上，如果它们在函数内部发生变化，重载决议没有意义。*

# symfony - Symfony 开发工具栏未加载（路径错误）

> ID：14243270
> 
> 赞同：0
> 
> 时间：2013-01-09T17:46:54.940
> 
> 标签：symfony, routing, twig, symfony-2.1

我正在构建一个带有动态路由的 CMS 风格的应用程序。到目前为止，它似乎工作正常，但输出不尊重 WDT、资产和链接的环境......它总是链接到`/whatever`而不是`/app_dev.php/whatever`.

动态路由是通过 kernel.request 监听器实现的。相关代码在[gist](https://gist.github.com/4495154)上。我是否需要在某个时候将当前环境传递给 Twig？

**编辑：**

在开发模式下会出现问题......在生产模式下没有问题。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-10T12:46:39.110

感谢@AdrienBrault，我终于通过使用控制器进行渲染解决了这个问题。

在 RequestListener 中，我向路由器的 RouteCollection 添加了一条新路由，指示将处理请求的控制器。

```
$route = new Route($path, array(
             '_controller' => 'CmsBundle:Routing:routing',
        ));

$this->router->getRouteCollection()->add('cms', $route); 
```

在控制器中获取原始 URL 有点困难，但最后我通过使用前面 add() 方法中分配的名称查询路由器 RouteCollection 来解决它。

# java - 用于类层次结构的 JPA ManyToOne

> ID：14243277
> 
> 赞同：0
> 
> 时间：2013-01-09T17:47:07.207
> 
> 标签：java, jpa

我有以下

```
@MappedSuperclass
public abstract class A {
    @Id @GeneratedValue
    public Long id;
}

@Entity
public class B extends A {
}

@Entity
public class C extends A {
}

@Entity
public class D {
    @ManyToOne
    public A a;
} 
```

问题是 D 类和字段 a（可以是 B 或 C 类型）。映射应该是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-09T19:56:42.600

如果你`A`从另一个实体引用一个，那么`A`不应该是一个 MappedSuperclass，而是一个实体。你应该用 注释它`@Entity`，并选择一个[继承策略](http://docs.oracle.com/javaee/6/api/javax/persistence/Inheritance.html)。

除此之外，映射将保持原样。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-10T14:13:18.370

这在 JPA 中无效，因为无法将关系定义为 @MappedSuperclass。

您可以映射 A 和 @Entity（TABLE_PER_CLASS 继承将为您提供相同的数据模型，但也可以考虑 JOINED 或 SINGLE_TABLE，因为它们通常更有效）。

在 EclipseLink 中，您还可以将 @VariableOneToOne 用于这种类型的关系。

见， [http://www.eclipse.org/eclipselink/documentation/2.4/jpa/extensions/a_variableonetoone.htm#CHDDFDGF](http://www.eclipse.org/eclipselink/documentation/2.4/jpa/extensions/a_variableonetoone.htm#CHDDFDGF)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-09T17:58:00.983

你在做什么是正确的。它将是映射 A。因此，在表 D 中；我们将有一个额外的列，它会告诉我们 A 是 B 还是 C。在 Toplink 中，我们将列名称作为类型。即使在hibernate中我们也有类似的概念。此列由 ORM 自动填充。

# c# - 从 Norand PL\N 格式转换为纯文本

> ID：14243278
> 
> 赞同：0
> 
> 时间：2013-01-09T17:47:16.387
> 
> 标签：c#, intermec

有谁知道如何从 Norand（现在是 intermec 的）专有格式 PL\N 转换为纯文本？我们有一个在我之前编写的应用程序，我需要能够将其更改为可读格式。这需要在 c# 中。

任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-14T12:02:01.450

附录 B 中有关于 4920/4921 通信控制器的参考指南，其中描述了 PL/N：epsfiles.intermec.com/eps_files/eps_man/961021013A.pdf

对不起，我对 PL/N 没有经验。

# asp.net-mvc-3 - 将 sdf 文件迁移到 sql server

> ID：14243281
> 
> 赞同：0
> 
> 时间：2013-01-09T17:47:24.390
> 
> 标签：asp.net-mvc-3, entity-framework, ef-code-first, entity-framework-migrations

我创建了代码优先方法应用程序 mvc，它创建了 sdf 文件 db。现在我想将该 sdf 文件迁移到 sql server。

当我双击 sdf 时，它会显示类似消息`This is not a valid SQL Server Compact Database file or this file version is not supported by current SQL Server Compact Engine.`

我想迁移，将数据同步到未来任何更好方法的sql server，我该如何迁移db？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-08T18:36:08.230

错误消息的一个可能原因是您的开发计算机上没有安装正确版本的 SQL Server Compact。

当前版本是 4.0，但您的应用程序可能仍在使用 3.5。找出它是哪个版本并检查文件夹*C:\Program Files\Microsoft SQL Server Compact Edition*以查看是否存在具有该版本名称的目录。如果没有，请下载并安装它（[3.5](http://www.microsoft.com/en-us/download/details.aspx?id=5783)、[4.0](http://www.microsoft.com/en-us/download/details.aspx?id=17876)）。

如果您使用的是 SqlCE 4.0 和 Visual Studio 2010 Pro 或更高版本，则可以使用[ErikEJ 的](https://stackoverflow.com/users/183934/erikej) [SQL Server Compact Toolbox 3.3.0.4](http://sqlcetoolbox.codeplex.com/)迁移 sdf 的结构和数据，该工具箱可通过 Visual Studio 的 Extension Manager 获得。

安装 Toolbox 后，迁移步骤如下：

1.  使用工具箱，连接到 Visual Studio 中的 sdf 文件。

2.  从上下文菜单中，选择*Script Database > Script Database Schema and Data*（不要选择*Script Database Schema and Data with BLOBS*）。这将保存一个或多个“.sqlce”脚本文件，具体取决于您的 sdf 有多大。

3.  在您的 SQL Server 实例中，创建一个空的目标数据库。

4.  找到 Sql Server 安装的 SQLCMD.exe。对于 SQL Server 2008，它通常位于*C:\Program Files\Microsoft SQL Server\100\Tools\Binn*。打开具有管理员权限的常规 cmd.exe 并导航到包含 SQLCMD.exe 的目录。

5.  从那里，执行：

> sqlcmd -S [sql server 实例名称] /d [目标数据库名称] -i [完整路径][文件名].sqlce

如果您有多个 sqlce 文件，则可以在同一命令中引用它们，如下所示：

> sqlcmd -S [sql server 实例名称] /d [目标数据库名称] -i [完整路径][文件名_0].sqlce -i [完整路径][文件名_1].sqlce -i [完整路径][文件名_2].sqlce

服务器选项 -S 必须是大写字母。祝你好运。

# asp.net-mvc-4 - 实体框架 4.1 对复杂对象的渴望加载

> ID：14243282
> 
> 赞同：1
> 
> 时间：2013-01-09T17:47:25.050
> 
> 标签：asp.net-mvc-4, entity-framework-4.1, eager-loading

在当前的 MVC4.0 项目中，我使用的是 Entity Framework 4.1 Database first 模型。

该结构的一部分包括以下表格

compGroupData 调查数据 SecondaryData

compGroupData 和 SurveyData 未加入数据库

SecondaryData 通过外键 SurveyData.surveydatakey = SecondaryData.surveydatakey 以一对一的关系加入到 SurveyData

在我的项目中，我有一个类 ComparisonWithData 定义为：

```
public class ComparisonWithData
{
    public compGroupData compgrp { get; set; }
    public SurveyData surveydata { get; set; }
    public ComparisonWithData()
    {
        compgrp = new compGroupData();
        surveydata = new SurveyData();
    }
} 
```

这为我提供了特定比较组的结果集以及与之匹配的数据。

过去，我通过以下查询为此检索了数据：

```
 List<ComparisonWithData> comparisonwithdata  = ((from compgrp in db.compGroupDatas
                       where compgrp.grpYear == rptyear && compgrp.CompGroupID == ccompgrp.CompGrpID
                       join surveydata in db.SurveyDatas on new { compgrp.companyid, SurveyYear = (Int32)compgrp.SurveyYear } equals new { companyid = surveydata.companyid, SurveyYear = surveydata.surveyyear }
                       select new ComparisonWithData
                       {
                           compgrp = compgrp,
                           surveydata = surveydata,

                       }
                       )).ToList(); 
```

随着最近数据的变化，我现在还需要引用 SecondaryData 但由于记录的数量确实需要它来急切地加载而不是延迟加载。（循环期间的延迟加载会导致数以千计的数据库调用）

我已经研究过在调查数据上使用“包含”方法以及将初始查询转换为 ObjectQuery 并执行包含。

第一种方法不急于加载，第二种方法似乎总是返回一个空对象作为结果。

是否有一种方法可以为 SurveyData 加载 SecondaryData，或者我应该一起寻找不同的方法。

我对此的唯一限制是由于我们对 .Net 4.5 的限制，我无法升级到 EF5

任何帮助将不胜感激。

谢谢你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-09T22:13:08.040

您可以尝试首先投影到一个匿名对象并`SecondaryData`在该投影中使用，具体化此结果，然后再次投影到您的最终结果对象中。EF 上下文提供的自动关系修复应该填充对象的导航属性（只要您不禁用查询中的更改跟踪）`surveyData.SecondaryData`：`ComparisonWithData`

```
var data = (( // ... part up to select unchanged ...
           select new // anonymous object
           {
               compgrp = compgrp,
               surveydata = surveydata,
               secondarydata = surveydata.SecondaryData
           }
           )).AsEnumerable();
           // part until here is DB query, the rest from here is query in memory

List<ComparisonWithData> comparisonwithdata =
           (from d in data
           select new ComparisonWithData
           {
               compgrp = d.compgrp,
               surveydata = d.surveydata
           }
           )).ToList(); 
```

# c# - 如何使用反射检索字符串文字？

> ID：14243284
> 
> 赞同：3
> 
> 时间：2013-01-09T17:47:27.860
> 
> 标签：c#, .net, string, reflection, literals

是否可以使用反射从程序集中检索所有字符串文字值？

假设我有这门课：

```
public class Example
{
    public void PrintName()
    {
        Debug.Print(@"My name is Dave");
    }
} 
```

我想使用反射来获取应用程序中的字符串列表，例如字符串“我的名字是戴夫”。

如果将字符串分配给变量，但不是内联文字，我已经找到了如何执行此操作。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-01-10T06:54:41.587

下面是一些应该可以工作的快速代码。您可以做的另一件事是通过查看#US 元数据流来读取程序集中的所有字符串文字。不久前我写了一些代码，如果你有兴趣，我可以挖掘一下。

```
 class Program
    {
        static void Main()
        {
            foreach (string literal in FindLiterals(typeof(Program).GetMethod("TestMethod1", BindingFlags.NonPublic | BindingFlags.Static)))
            {
                Console.WriteLine(literal);
            }

            Console.ReadLine();
        }

        private static IEnumerable<string> FindLiterals(MethodInfo method)
        {
            ILReader reader = new ILReader(method);
            foreach (ILInstruction instruction in reader.Instructions)
            {
                if (instruction.Op == OpCodes.Ldstr)
                {
                    yield return instruction.Data as string;
                }
            }
        }

        private static void TestMethod1()
        {
            Console.WriteLine("Abc");
            Console.WriteLine("123");
        }
    }

    public interface IILReaderProvider
    {
        byte[] GetMethodBody();

        FieldInfo ResolveField(int metadataToken);
        MemberInfo ResolveMember(int metadataToken);

        MethodBase ResolveMethod(int metadataToken);
        byte[] ResolveSignature(int metadataToken);

        string ResolveString(int metadataToken);
        Type ResolveType(int metadataToken);
    }

    [StructLayout(LayoutKind.Sequential)]
    public struct ILInstruction
    {
        private readonly OpCode operationCode; // 40\.  56-64\.  The entire structure is very big.  maybe do array lookup for opcode instead.

        private readonly byte[] instructionRawData;

        private readonly object instructionData;

        private readonly int instructionAddress;

        private readonly int index;

        internal ILInstruction(OpCode code, byte[] instructionRawData, int instructionAddress, object instructionData, int index)
        {
            this.operationCode = code;
            this.instructionRawData = instructionRawData;
            this.instructionAddress = instructionAddress;
            this.instructionData = instructionData;
            this.index = index;
        }

        public OpCode Op
        {
            get
            {
                return this.operationCode;
            }
        }

        /// <summary>
        /// Gets the raw data.
        /// </summary>
        public byte[] RawData
        {
            get
            {
                return this.instructionRawData;
            }
        }

        /// <summary>
        /// Gets the data.
        /// </summary>
        public object Data
        {
            get
            {
                return this.instructionData;
            }
        }

        /// <summary>
        /// Gets the address of the instruction.
        /// </summary>
        public int Address
        {
            get
            {
                return this.instructionAddress;
            }
        }

        /// <summary>
        /// Gets the index of the instruction.
        /// </summary>
        /// <value>
        /// The index of the instruction.
        /// </value>
        public int InstructionIndex
        {
            get
            {
                return this.index;
            }
        }

        /// <summary>
        /// Gets the value as integer
        /// </summary>
        /// <value>The data value.</value>
        public int DataValue
        {
            get
            {
                int value = 0;
                if (this.Data != null)
                {
                    if (this.Data is byte)
                    {
                        value = (byte)this.Data;
                    }
                    else if (this.Data is short)
                    {
                        value = (short)this.Data;
                    }
                    else if (this.Data is int)
                    {
                        value = (int)this.Data;
                    }
                }

                return value;
            }
        }

        /// <summary>
        /// Gets the length of the instructions and operands.
        /// </summary>
        /// <value>The length.</value>
        public int Length
        {
            get
            {
                return this.Op.Size + (this.RawData == null ? 0 : this.RawData.Length);
            }
        }

        /// <summary>
        /// Returns a <see cref="System.String"/> that represents this instance.
        /// </summary>
        /// <returns>
        /// A <see cref="System.String"/> that represents this instance.
        /// </returns>
        public override string ToString()
        {
            StringBuilder builder = new StringBuilder();
            builder.AppendFormat("0x{0:x4} {1,-10}", this.Address, this.Op.Name);

            if (this.Data != null)
            {
                builder.Append(this.Data.ToString());
            }

            if (this.RawData != null && this.RawData.Length > 0)
            {
                builder.Append(" [0x");
                for (int i = this.RawData.Length - 1; i >= 0; i--)
                {
                    builder.Append(this.RawData[i].ToString("x2", CultureInfo.InvariantCulture));
                }

                builder.Append(']');
            }

            return builder.ToString();
        }
    }

    /// <summary>
    /// Reads IL instructions from a byte stream.
    /// </summary>
    /// <remarks>Allows generated code to be viewed without debugger or enabled debug assemblies.</remarks>
    public sealed class ILReader
    {
        /// <summary>
        /// The _instruction lookup.
        /// </summary>
        private static readonly Lazy<Dictionary<short, OpCode>> instructionLookup = new Lazy<Dictionary<short, OpCode>>(ILReader.GetLookupTable, System.Threading.LazyThreadSafetyMode.ExecutionAndPublication);

        /// <summary>
        /// The IL reader provider.
        /// </summary>
        private IILReaderProvider intermediateLanguageProvider;

        /// <summary>
        /// Initializes a new instance of the <see cref="ILReader"/> class.
        /// </summary>
        /// <param name="method">
        /// The method.
        /// </param>
        public ILReader(MethodInfo method)
        {
            if (method == null)
            {
                throw new ArgumentNullException("method");
            }

            this.intermediateLanguageProvider = ILReader.CreateILReaderProvider(method);
        }

        /// <summary>
        /// Gets the instructions.
        /// </summary>
        /// <value>The instructions.</value>
        public IEnumerable<ILInstruction> Instructions
        {
            get
            {
                byte[] instructionBytes = this.intermediateLanguageProvider.GetMethodBody();
                int instructionIndex = 0, startAddress;
                for (int position = 0; position < instructionBytes.Length; )
                {
                    startAddress = position;
                    short operationData = instructionBytes[position];
                    if (IsInstructionPrefix(operationData))
                    {
                        operationData = (short)((operationData << 8) | instructionBytes[++position]);
                    }

                    position++;

                    OpCode code;
                    if (!instructionLookup.Value.TryGetValue(operationData, out code))
                    {
                        throw new InvalidProgramException(string.Format("0x{0:X2} is not a valid op code.", operationData));
                    }

                    int dataSize = GetSize(code.OperandType);
                    byte[] data = new byte[dataSize];
                    Buffer.BlockCopy(instructionBytes, position, data, 0, dataSize);
                    object objData = this.GetData(code, data);
                    position += dataSize;

                    if (code.OperandType == OperandType.InlineSwitch)
                    {
                        dataSize = (int)objData;
                        int[] labels = new int[dataSize];
                        for (int index = 0; index < labels.Length; index++)
                        {
                            labels[index] = BitConverter.ToInt32(instructionBytes, position);
                            position += 4;
                        }

                        objData = labels;
                    }

                    yield return new ILInstruction(code, data, startAddress, objData, instructionIndex);
                    instructionIndex++;
                }
            }
        }

        /// <summary>
        /// Creates the IL reader provider.
        /// </summary>
        /// <param name="methodInfo">The MethodInfo object that represents the method to read..</param>
        /// <returns>
        /// The ILReader provider.
        /// </returns>
        private static IILReaderProvider CreateILReaderProvider(MethodInfo methodInfo)
        {
            IILReaderProvider reader = DynamicILReaderProvider.Create(methodInfo);
            if (reader != null)
            {
                return reader;
            }

            return new ILReaderProvider(methodInfo);
        }

        /// <summary>
        /// Checks to see if the IL instruction is a prefix indicating the length of the instruction is two bytes long.
        /// </summary>
        /// <param name="value">The IL instruction as a byte.</param>
        /// <remarks>IL instructions can either be 1 or 2 bytes.</remarks>
        /// <returns>True if this IL instruction is a prefix indicating the instruction is two bytes long.</returns>
        private static bool IsInstructionPrefix(short value)
        {
            return ((value & OpCodes.Prefix1.Value) == OpCodes.Prefix1.Value) || ((value & OpCodes.Prefix2.Value) == OpCodes.Prefix2.Value)
                        || ((value & OpCodes.Prefix3.Value) == OpCodes.Prefix3.Value) || ((value & OpCodes.Prefix4.Value) == OpCodes.Prefix4.Value)
                        || ((value & OpCodes.Prefix5.Value) == OpCodes.Prefix5.Value) || ((value & OpCodes.Prefix6.Value) == OpCodes.Prefix6.Value)
                        || ((value & OpCodes.Prefix7.Value) == OpCodes.Prefix7.Value) || ((value & OpCodes.Prefixref.Value) == OpCodes.Prefixref.Value);
        }

        /// <summary>
        /// The get lookup table.
        /// </summary>
        /// <returns>
        /// A dictionary of IL instructions.
        /// </returns>
        private static Dictionary<short, OpCode> GetLookupTable()
        {
            // Might be better to do an array lookup.  Use a seperate arrary for instructions without a prefix and array for each prefix.
            Dictionary<short, OpCode> lookupTable = new Dictionary<short, OpCode>();
            FieldInfo[] fields = typeof(OpCodes).GetFields(BindingFlags.Static | BindingFlags.Public);
            foreach (FieldInfo field in fields)
            {
                OpCode code = (OpCode)field.GetValue(null);
                lookupTable.Add(code.Value, code);
            }

            return lookupTable;
        }

        /// <summary>
        /// Gets the size of a operand.
        /// </summary>
        /// <param name="operandType">Defines the type of operand.</param>
        /// <returns>The size in bytes of the operand type.</returns>
        private static int GetSize(OperandType operandType)
        {
            switch (operandType)
            {
                case OperandType.InlineNone:
                    return 0;
                case OperandType.ShortInlineBrTarget:
                case OperandType.ShortInlineI:
                case OperandType.ShortInlineVar:
                    return 1;
                case OperandType.InlineVar:
                    return 2;
                case OperandType.InlineBrTarget:
                case OperandType.InlineField:
                case OperandType.InlineI:
                case OperandType.InlineMethod:
                case OperandType.InlineSig:
                case OperandType.InlineString:
                case OperandType.InlineSwitch:
                case OperandType.InlineTok:
                case OperandType.InlineType:
                case OperandType.ShortInlineR:
                    return 4;
                case OperandType.InlineI8:
                case OperandType.InlineR:
                    return 8;
                default:
                    return 0;
            }
        }

        private object GetData(OpCode code, byte[] rawData)
        {
            object data = null;
            switch (code.OperandType)
            {
                case OperandType.InlineField:
                    data = this.intermediateLanguageProvider.ResolveField(BitConverter.ToInt32(rawData, 0));
                    break;
                case OperandType.InlineSwitch:
                    data = BitConverter.ToInt32(rawData, 0);

                    break;
                case OperandType.InlineBrTarget:
                case OperandType.InlineI:
                    data = BitConverter.ToInt32(rawData, 0);
                    break;
                case OperandType.InlineI8:
                    data = BitConverter.ToInt64(rawData, 0);
                    break;
                case OperandType.InlineMethod:
                    data = this.intermediateLanguageProvider.ResolveMethod(BitConverter.ToInt32(rawData, 0));
                    break;
                case OperandType.InlineR:
                    data = BitConverter.ToDouble(rawData, 0);
                    break;
                case OperandType.InlineSig:
                    data = this.intermediateLanguageProvider.ResolveSignature(BitConverter.ToInt32(rawData, 0));
                    break;
                case OperandType.InlineString:
                    data = this.intermediateLanguageProvider.ResolveString(BitConverter.ToInt32(rawData, 0));
                    break;
                case OperandType.InlineTok:
                case OperandType.InlineType:
                    data = this.intermediateLanguageProvider.ResolveType(BitConverter.ToInt32(rawData, 0));
                    break;
                case OperandType.InlineVar:
                    data = BitConverter.ToInt16(rawData, 0);
                    break;
                case OperandType.ShortInlineVar:
                case OperandType.ShortInlineI:
                case OperandType.ShortInlineBrTarget:
                    data = rawData[0];
                    break;
                case OperandType.ShortInlineR:
                    data = BitConverter.ToSingle(rawData, 0);
                    break;
            }

            return data;
        }
    }

    internal class DynamicILReaderProvider : IILReaderProvider
    {
        public const int TypeRidPrefix = 0x02000000;

        public const int MethodRidPrefix = 0x06000000;

        public const int FieldRidPrefix = 0x04000000;

        public static readonly Type RuntimeDynamicMethodType;

        private static readonly FieldInfo fileLengthField = typeof(ILGenerator).GetField("m_length", BindingFlags.NonPublic | BindingFlags.Instance);

        private static readonly FieldInfo IntermediateLanguageBytesField = typeof(ILGenerator).GetField("m_ILStream", BindingFlags.NonPublic | BindingFlags.Instance);

        private static readonly MethodInfo bakeByteArrayMethod = typeof(ILGenerator).GetMethod("BakeByteArray", BindingFlags.NonPublic | BindingFlags.Instance);

        private static readonly PropertyInfo dynamicScopeIndexor;

        private static readonly FieldInfo dynamicScopeField;

        private static readonly Type genericMethodInfoType;

        private static readonly FieldInfo genericMethodHandleField;

        private static readonly FieldInfo genericMethodContextField;

        private static readonly Type varArgMethodType;

        private static readonly FieldInfo varArgMethodMethod;

        private static readonly Type genericFieldInfoType;

        private static readonly FieldInfo genericFieldInfoHandle;        

        private static readonly FieldInfo genericFieldInfoContext;

        private static readonly FieldInfo ownerField;

        private object dynamicScope;

        private ILGenerator generator;

        static DynamicILReaderProvider()
        {
            BindingFlags bindingFlags = BindingFlags.NonPublic | BindingFlags.Instance;
            dynamicScopeIndexor = Type.GetType("System.Reflection.Emit.DynamicScope").GetProperty("Item", bindingFlags);
            dynamicScopeField = Type.GetType("System.Reflection.Emit.DynamicILGenerator").GetField("m_scope", bindingFlags);

            varArgMethodType = Type.GetType("System.Reflection.Emit.VarArgMethod");
            varArgMethodMethod = varArgMethodType.GetField("m_method", bindingFlags);

            genericMethodInfoType = Type.GetType("System.Reflection.Emit.GenericMethodInfo");
            genericMethodHandleField = genericMethodInfoType.GetField("m_methodHandle", bindingFlags);
            genericMethodContextField = genericMethodInfoType.GetField("m_context", bindingFlags);

            genericFieldInfoType = Type.GetType("System.Reflection.Emit.GenericFieldInfo", false);
            if (genericFieldInfoType != null)
            {
                genericFieldInfoHandle = genericFieldInfoType.GetField("m_fieldHandle", bindingFlags);
                genericFieldInfoContext = genericFieldInfoType.GetField("m_context", bindingFlags);
            }
            else
            {
                genericFieldInfoHandle = genericFieldInfoContext = null;
            }

            RuntimeDynamicMethodType = typeof(DynamicMethod).GetNestedType("RTDynamicMethod", BindingFlags.NonPublic);
            ownerField = RuntimeDynamicMethodType.GetField("m_owner", bindingFlags);
        }

        private DynamicILReaderProvider(DynamicMethod method)
        {
            this.Method = method;
            this.generator = method.GetILGenerator();
            this.dynamicScope = dynamicScopeField.GetValue(this.generator);
        }

        public DynamicMethod Method { get; private set; }

        internal object this[int token]
        {
            get
            {
                return dynamicScopeIndexor.GetValue(this.dynamicScope, new object[] { token });
            }
        }

        public static DynamicILReaderProvider Create(MethodInfo method)
        {
            if (method == null)
            {
                throw new ArgumentNullException("method");
            }

            DynamicMethod dynamicMethod = method as DynamicMethod;
            if (dynamicMethod != null)
            {
                return new DynamicILReaderProvider(dynamicMethod);
            }

            Type methodType = method.GetType();
            if (RuntimeDynamicMethodType.IsAssignableFrom(methodType))
            {
                return new DynamicILReaderProvider(ownerField.GetValue(method) as DynamicMethod);
            }

            return null;
        }

        public byte[] GetMethodBody()
        {
            byte[] data = null;
            ILGenerator ilgen = this.Method.GetILGenerator();

            try
            {
                data = (byte[])bakeByteArrayMethod.Invoke(ilgen, null) ?? new byte[0];
            }
            catch (TargetInvocationException)
            {
                int length = (int)fileLengthField.GetValue(ilgen);
                data = new byte[length];
                Array.Copy((byte[])IntermediateLanguageBytesField.GetValue(ilgen), data, length);
            }

            return data;
        }

        public FieldInfo ResolveField(int metadataToken)
        {
            object tokenValue = this[metadataToken];
            if (tokenValue is RuntimeFieldHandle)
            {
                return FieldInfo.GetFieldFromHandle((RuntimeFieldHandle)tokenValue);
            }

            if (tokenValue.GetType() == DynamicILReaderProvider.genericFieldInfoType)
            {
                return FieldInfo.GetFieldFromHandle(
                    (RuntimeFieldHandle)genericFieldInfoHandle.GetValue(tokenValue),
                    (RuntimeTypeHandle)genericFieldInfoContext.GetValue(tokenValue));
            }

            return null;
        }

        public MemberInfo ResolveMember(int metadataToken)
        {
            if ((metadataToken & TypeRidPrefix) != 0)
            {
                return this.ResolveType(metadataToken);
            }

            if ((metadataToken & MethodRidPrefix) != 0)
            {
                return this.ResolveMethod(metadataToken);
            }

            if ((metadataToken & FieldRidPrefix) != 0)
            {
                return this.ResolveField(metadataToken);
            }

            return null;
        }

        public MethodBase ResolveMethod(int metadataToken)
        {
            object tokenValue = this[metadataToken];
            DynamicMethod dynamicMethod = tokenValue as DynamicMethod;
            if (dynamicMethod != null)
            {
                return dynamicMethod;
            }

            if (tokenValue is RuntimeMethodHandle)
            {
                return MethodBase.GetMethodFromHandle((RuntimeMethodHandle)this[metadataToken]);
            }

            if (tokenValue.GetType() == DynamicILReaderProvider.genericFieldInfoType)
            {
                return MethodBase.GetMethodFromHandle(
                    (RuntimeMethodHandle)genericMethodHandleField.GetValue(tokenValue),
                    (RuntimeTypeHandle)genericMethodContextField.GetValue(tokenValue));
            }

            if (tokenValue.GetType() == DynamicILReaderProvider.varArgMethodType)
            {
                return DynamicILReaderProvider.varArgMethodMethod.GetValue(tokenValue) as MethodInfo;
            }

            return null;
        }

        public byte[] ResolveSignature(int metadataToken)
        {
            return this[metadataToken] as byte[];
        }
        public string ResolveString(int metadataToken)
        {
            return this[metadataToken] as string;
        }

        public Type ResolveType(int metadataToken)
        {
            return Type.GetTypeFromHandle((RuntimeTypeHandle)this[metadataToken]);
        }
    }

    internal class ILReaderProvider : IILReaderProvider
    {
        public ILReaderProvider(MethodInfo method)
        {
            this.Method = method;
            this.MethodBody = method.GetMethodBody();
            this.MethodModule = method.Module;
        }

        public MethodInfo Method { get; private set; }

        public MethodBody MethodBody { get; private set; }

        public Module MethodModule { get; private set; }

        public byte[] GetMethodBody()
        {
            return this.MethodBody.GetILAsByteArray();
        }

        public FieldInfo ResolveField(int metadataToken)
        {
            return this.MethodModule.ResolveField(metadataToken);
        }

        public MemberInfo ResolveMember(int metadataToken)
        {
            return this.MethodModule.ResolveMember(metadataToken);
        }

        public MethodBase ResolveMethod(int metadataToken)
        {
            return this.MethodModule.ResolveMethod(metadataToken);
        }

        public byte[] ResolveSignature(int metadataToken)
        {
            return this.MethodModule.ResolveSignature(metadataToken);
        }

        public string ResolveString(int metadataToken)
        {
            return this.MethodModule.ResolveString(metadataToken);
        }

        public Type ResolveType(int metadataToken)
        {
            return this.MethodModule.ResolveType(metadataToken);
        }
    } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-09T17:49:59.817

恐怕你不能。您将不得不解析代码。调查[罗斯林](http://msdn.microsoft.com/en-us/vstudio/roslyn.aspx)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-09T17:53:32.950

你*可以*但不会很容易或干净或整洁，并且可能很难让它可靠地工作。

您可以从 MethodInfo.GetMethodBody() 开始，然后解析二进制 IL。有一些图书馆可以做到这一点，例如尝试[Cecil 。](http://www.mono-project.com/Cecil)

# c# - 使用 Winforms 应用程序分发 Access 数据库

> ID：14243294
> 
> 赞同：2
> 
> 时间：2013-01-09T17:47:52.540
> 
> 标签：c#, winforms, ms-access

我有一个 C# 应用程序，它可以读取和写入 Access 数据库。每个用户有一个数据库文件。我的目的是在启动时检查用户的“我的文档”文件夹中是否存在 MDB，如果未找到 MDB，则将模板 MDB 复制到该文件夹​​。

我已经将模板 MDB 添加到我的项目中，并将其放在我调用的自己的文件夹中`Packaged`。但是，我无法`Packaged`从代码中引用此文件夹，因为它没有出现在 IntelliSense 中。

我的意图是`File.Copy`用来复制 MDB，但我无法确定文件路径，因为我无法在代码中访问 MDB。如果它只是打包在.exe中，大概它不会有文件路径？

如果可能的话，我宁愿不分发单独的 MDB，实现这一目标的最佳方法是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-09T17:57:50.017

过去我通过使 MDB 成为嵌入式资源并根据需要将其写入磁盘（如果它不存在）来完成此操作。

[这是有关将嵌入式资源写入文件的更多信息。](https://stackoverflow.com/questions/4405813/copying-embedded-resource-as-file-to-disk-in-c-sharp)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-09T18:01:25.893

您几乎必须使用模板 MDB 的环境路径之一。像 ApplicationData 或 Documents and Settings\Username\Local Settings\ 或其他之一。本地用户数据是用户特定数据的最佳方式。在最开始的代码中，第一次运行时判断该文件是否存在。如果存在则复制模板，如果不存在则不复制。

这样，用户就拥有完整的读写访问权限以及复制文件或复制文件的能力，而不会出现安全问题。这些环境变量可以通过

```
 Environment.GetEnvironmentVariable 
```

您还可以有一个注册表设置并读取和写入该特定应用程序的注册表，该应用程序具有一个简单的 DatabaseAvailable 键，并切换它是或否。

您也可以将 MDB 作为资源嵌入，然后根据需要编写它。

# ruby-on-rails - pjax - 链接必须在 pjax 容器内吗？

> ID：14243295
> 
> 赞同：4
> 
> 时间：2013-01-09T17:47:53.320
> 
> 标签：ruby-on-rails, pjax

我正在使用[https://github.com/rails/pjax_rails](https://github.com/rails/pjax_rails)。

我想将我的链接放在页面的“永久”部分。即在我的布局中

```
<%= link_to "Some Action", some_action_path %> 
```

然后在视图内部：

```
<div data-pjax-container>Content to be replaced</div> 
```

这是我调用 pjax 的 javascript：

```
('[data-pjax-container]').pjax('a'); 
```

[您可能会注意到这与自述文件中的调用方法不同，但正如报告的问题所指出的那样，自述文件中的方法根本不起作用。]

这不起作用（链接重新加载整个页面）。

如果我使用 data-pjax-container 属性移动 div 内的链接，它可以工作（页面不会重新加载，只更新容器）。

我还没有看到链接实际上在容器之外的任何示例。谁能告诉我如何让它工作？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-09T18:01:23.820

我可能过于关注 pjax-rails 自述文件（不是很好）。我去了源代码（https://github.com/defunkt/jquery-pjax），这导致我将我的 js 更改为：

```
$(document).pjax('a', '[data-pjax-container]') 
```

..这让我回到了正确的轨道上。

# c# - 在控制台应用程序中从 ASP.NET Razor 模板生成 HTML 的当前最佳解决方案是什么？

> ID：14243296
> 
> 赞同：54
> 
> 时间：2013-01-09T17:47:55.943
> 
> 标签：c#, asp.net, asp.net-mvc, razor, servicestack

我想做这个：

```
string template = "Hello @Model.Name! Welcome to Razor!";
string result = Razor.Parse(template, new { Name = "World" }); 
```

看起来[http://razorengine.codeplex.com](http://razorengine.codeplex.com)是完美的，除了它已经一岁了。

编辑：事实证明 RazorEngine 已经转移到 GitHub 并在几个月前进行了提交：[https ://github.com/Antaris/RazorEngine](https://github.com/Antaris/RazorEngine)

我注意到服务堆栈有一些 Razor 自托管，但是虽然这里有一个很长的页面[http://razor.servicestack.net](http://razor.servicestack.net)没有“你好世界，你完全可以从控制台做到这一点”。

在控制台应用程序中从 ASP.NET Razor 模板生成 HTML 的当前最佳解决方案是什么？

* * *

## 回答 #1

> 赞同：38
> 
> 时间：2013-01-09T21:16:25.527

> 在控制台应用程序中从 ASP.NET Razor 模板生成 HTML 的当前最佳解决方案是什么？

[`RazorEngine`](https://github.com/Antaris/RazorEngine). 句号。

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2013-01-10T17:01:58.580

ServiceStack 是渲染 Razor 视图页面的另一个选项。尽管它针对集成到**ASP.NET**或**HttpListener** Web 主机进行了优化（并提供 API 用于在目录中自动发现和注册视图页面、动态重新编译修改的页面等），但它还支持静态生成视图页面：

```
var razor = new RazorFormat {
    VirtualPathProvider = new InMemoryVirtualPathProvider(new BasicAppHost()),
    EnableLiveReload = false, //don't scan for file system for changes
}.Init();

var page = razor.CreatePage("Hello @Model.Name! Welcome to Razor!");
var html = razor.RenderToHtml(page, new { Name = "World" });
html.Print(); 
```

[这是此示例的独立单元测试](https://github.com/ServiceStack/ServiceStack/blob/master/tests/ServiceStack.ServiceHost.Tests/Formats_Razor/StandAloneExampleTests.cs)。

使用 ServiceStack 的 Razor 视图渲染引擎的好处包括可以访问许多移植到 ServiceStack 的 MVC 的 HtmlHelper。您还可以从自托管 ServiceStack HttpListener 轻松托管 razor 网站，如[razor-console.servicestack.net](http://razor-console.servicestack.net/)中所示，其源代码可在[自托管控制台应用程序](https://github.com/ServiceStack/RazorRockstars/tree/master/src/RazorRockstars.SelfHost)或[Windows 服务](https://github.com/ServiceStack/RazorRockstars/tree/master/src/RazorRockstars.WinService)中获得。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-01-09T18:21:29.783

Nancy 具有自托管选项，并且能够将 Razor 作为视图引擎插入。

[https://github.com/NancyFx/Nancy/wiki/Hosting-nancy-with-wcf](https://github.com/NancyFx/Nancy/wiki/Hosting-nancy-with-wcf)

[https://github.com/NancyFx/Nancy/wiki/Razor-View-Engine](https://github.com/NancyFx/Nancy/wiki/Razor-View-Engine)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-09T17:54:23.963

我不会将此称为“当前最佳”解决方案。但是，我发现它很有趣，它可以让你完成你想做的事情。它只是不是很整齐地包裹起来。 [http://vibrantcode.com/blog/2010/11/16/hosting-razor-outside-of-aspnet-revised-for-mvc3-rc.html/](http://vibrantcode.com/blog/2010/11/16/hosting-razor-outside-of-aspnet-revised-for-mvc3-rc.html/)

# eclipse - OSGi 与 Eclipse：如何隐藏 Eclipse 捆绑包？

> ID：14243297
> 
> 赞同：1
> 
> 时间：2013-01-09T17:47:57.643
> 
> 标签：eclipse, autocomplete, eclipse-plugin, osgi, bundle

使用 Eclipse 进行 OSGi 开发非常棒。

Eclipse 带有很酷的自动完成功能，这在 OSGi 中也很有帮助。

默认情况下，Eclipse 会建议不是我自己创建但在 Eclipse 中可用的 Bundles/Packages。

![在此处输入图像描述](../Images/c601f6139900b4c18380f466a55b80e5.png)

所以我的问题是如何避免这种情况？我只想在这些建议或自动完成中拥有自己的捆绑包。这可能吗 ？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-09T19:13:54.540

可见捆绑包的集合由您定义的“目标平台”控制。默认情况下，它指向 self，因此您会看到 Eclipse 安装中存在各种包。

请参阅窗口 -> 首选项 -> 插件开发 -> 目标平台

# java - Java中是否有一种简单的方法来过滤unicode版本（3.2）中的字符？

> ID：14243298
> 
> 赞同：10
> 
> 时间：2013-01-09T17:47:59.860
> 
> 标签：java, unicode

我在 Java 中有一个注册过程。我想确保使用的名称都在 unicode 3.2 中。此 unicode 要求适用于我系统的另一部分，它不在 java 中。

Java 是否有一种简单的方法来验证 unicode 版本的字符串？我似乎无法从一些粗略的检查中找到任何东西。

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-09T18:42:10.523

我会阅读这个[UCD](http://www.unicode.org/Public/3.2-Update/UnicodeData-3.2.0.txt)文件并从第一列构建一个 BitSet。这将是测试字符串中每个代码点的快速方法。

# jquery - 删除/删除功能？

> ID：14243299
> 
> 赞同：0
> 
> 时间：2013-01-09T17:47:59.790
> 
> 标签：jquery

我有这个小功能，它将 div 设置为 position:fixed 在单击链接后。

```
$(window).load(function(){
    $('#linktofreeze').click(function() {
        var ftop = $('#fixedbox').offset().top - $(window).scrollTop();
        var fleft = $('#fixedbox').offset().left;
        $('#fixedbox').css({position: 'fixed', left: fleft + 'px', top: ftop + 'px'});
    });
}); 
```

我现在想要实现的是让整个事情倒退：当第二个链接被点击时，div 的位置不应该再被“固定”了。

做这个的最好方式是什么？有没有办法再次删除/删除此功能“onClick”？

为了更清楚，我在 jsFiddle 上上传了文件：http: [//jsfiddle.net/hZX5h/72/](http://jsfiddle.net/hZX5h/72/)

如果有人可以提供帮助，那就太好了。谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-09T17:55:28.000

**将其位置**重置为`relative`

```
$("#linktounfreeze").click(function() {
  $('#fixedbox').css({position: 'relative'});  
  return false;
}); 
```

小提琴：http: [//jsfiddle.net/vVbGy/1/](http://jsfiddle.net/vVbGy/1/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-09T17:55:37.433

是你想要的吗？（在你的 js 代码末尾添加这个）：

```
$('#linktounfreeze').click(function () {
  $('#fixedbox').css({
    position: 'relative'
  });
return null;
}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-09T17:56:38.000

您可以使用 unbind 方法来实现此目的：

```
$('#linktofreeze').attr('onclick','').unbind('click'); 
```

jQuery 1.7+ 中更好的方法

```
$('#linktofreeze').off('click'); 
```

# haskell - Haskell 简化技术和单子

> ID：14243303
> 
> 赞同：2
> 
> 时间：2013-01-09T17:48:12.243
> 
> 标签：haskell

如何可以减少/简化此代码（或一般而言，具有多个输入的代码）？

```
do
  sex    <- askSex
  name   <- askName
  sayHello sex name 
```

在这种情况下已经很短了，但是当它到达多个输入时，它看起来很乱。有没有办法做类似的事情：

```
sayHello askSex askName 
```

?

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-09T17:58:11.137

如果你

```
import Control.Applicative  -- for <$> and <*>
import Control.Monad        -- for join 
```

你可以写

```
join $ sayHello <$> askSex <*> askName 
```

对于您的示例，您只获取两个参数，这不是一个很大的胜利。但是对于更多数量的参数，它可以使代码更清晰。

```
join $ doSomething <$> getFirst <*> getSecond <*> getThird <*> getForth 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-09T18:10:10.310

这是 Applicative Functors 的美好时光：

```
import Control.Applicative -- at the top of your module before any functions

hello "Male" name = "Hi, " ++ name ++ ", that's a cool name."
hello "Female" name = "Hello, " ++ name ++ ", that's a pretty name."

greet = hello <$> askSex <*> askName >>= putStrLn 
```

它有点像`fmap`我今天给你的之前的答案，但是对于更多的论点，就像你在这里一样。

将我的函数`hello`与应用函子一起使用可以帮助您将 IO 代码与其他代码分开，这是非常好的做法。试着写`hello`而不是`sayHello`每次。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-10T16:12:11.240

烦人的是，hoogle 对此并没有一个简单的答案。这将被称为`bind2`. 如果它是一个只有一个输入的函数，那么您可以使用`=<<`，我称之为的中缀版本`bind1`。

```
sayHello =<< askName 
```

但是对于多个输入，我们不走运。无论出于何种原因，标准库不提供此功能：

```
bind2 :: Monad m => (a -> b -> m c) -> m a -> m b -> m c
bind2 f mx my = do
  x <- mx
  y <- my
  f x y

...

bind2 sayHello askSex askName 
```

当然，您可以自己定义。

# c# - 从正在运行的进程中获取 DLL 名称，可能吗？

> ID：14243306
> 
> 赞同：2
> 
> 时间：2013-01-09T17:48:22.327
> 
> 标签：c#, dll, process

我正在寻找一种从正在运行的进程中获取 DLL 名称的方法，但如果我表达得不好，我很抱歉。

我需要通过它的名称或 PID “连接”到这个进程，并在可能的情况下检索它正在使用的 DLL 名称。

问候。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-09T17:52:32.027

是的，有可能。你可以使用`Process`类。它有一个`Modules`列出所有已加载模块的属性。

例如，要将所有进程和所有模块列出到控制台：

```
Process[] processes = Process.GetProcesses();

foreach(Process process in processes) {
    Console.WriteLine("PID:  " + process.Id);
    Console.WriteLine("Name: " + process.ProcessName);
    Console.WriteLine("Modules: ");

    foreach(ProcessModule module in process.Modules) {
        Console.WriteLine(module.FileName);
    }
} 
```

您当然可以检查`Process.Id`您想要的 PID 等。

有关更多信息，请查看此类的文档：-

[http://msdn.microsoft.com/en-us/library/system.diagnostics.process.aspx](http://msdn.microsoft.com/en-us/library/system.diagnostics.process.aspx)

*注意：对于您无权访问的某些系统进程，此代码可能会受到干扰。*

# php - PHP 邮件 $email = $_POST['email'] in $recipients

> ID：14243307
> 
> 赞同：2
> 
> 时间：2013-01-09T17:48:24.960
> 
> 标签：php

我有以下 php 邮件文件：

```
<?php $name = $_POST['name'];
$email = $_POST['email'];
$choice = $_POST['choice'];$num = $_POST['num'];
$choice1 = $_POST['choice1'];$num1 = $_POST['num1'];
$phone= $_POST['phone'];
$town= $_POST['town'];
$formcontent="
Name: $name \n
Number: $phone \n
Choice: $choice Amount:$num
Choice: $choice1 Amount:$num1
Town: $town \n
Email: $email" ;
$recipient = "info@domain.com";
$subject = "Contact Form";
$mailheader = "From: $email \r\n";
mail($recipient, $subject, $formcontent, $mailheader) or die("Error!");
echo "Thank You!";?> 
```

我可以将 $email 添加到收件人吗？我想将表单中输入的电子邮件添加到接收电子邮件的收件人中。(info@domain.com 和表单中输入的电子邮件 ($email = $_POST['email'];) 将收到电子邮件。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-09T18:01:23.507

您可以`$recipient`通过用逗号分隔多个电子邮件地址来添加它们。试试这个。

```
$recipient = "info@domain.com, $email"; 
```

**编辑**

这是整个事情。

```
<?php

    $name = $_POST['name'];
    $email = $_POST['email'];
    $choice = $_POST['choice']; $num = $_POST['num'];
    $choice1 = $_POST['choice1']; $num1 = $_POST['num1'];
    $phone= $_POST['phone'];
    $town= $_POST['town'];

    $formcontent = "
    Name: $name \n
    Number: $phone \n
    Choice: $choice Amount:$num
    Choice: $choice1 Amount:$num1
    Town: $town \n
    Email: $email";

    $recipient = "info@domain.com, $email";
    $subject = "Contact Form";
    $mailheader = "From: $email \r\n";
    mail($recipient, $subject, $formcontent, $mailheader) or die("Error!");
    echo "Thank you";

?> 
```

# sql - 从其他选择的结果中选择列

> ID：14243309
> 
> 赞同：0
> 
> 时间：2013-01-09T17:48:33.503
> 
> 标签：sql, sql-server

我有这个 sql 查询：

```
select COUNT(batch_id) AS cc FROM tbl_associate_593932 WHERE induction_result>50 GROUP BY batch_id 
```

此查询仅使用一列 cc 即可正确执行。现在我想从该列中的值中获取最大值。我试过这样的事情：

```
select max (cc) from  (select COUNT(batch_id) AS cc FROM tbl_associate_593932 WHERE induction_result>50 GROUP BY batch_id); 
```

但是在 SQL Server 中，它给了我错误：';' 附近的语法不正确。期望 AS、ID 或 Quoted_ID

和另一个错误无效的列名'cc'。

如何在 SQL Server 中执行此操作。在Oracle中也可以这样做吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-09T17:50:25.940

你可以这样做：

```
WITH CTE
AS
(
   select COUNT(batch_id) AS cc 
   FROM tbl_associate_593932 
   WHERE induction_result > 50 
   GROUP BY batch_id
) 
SELECT MAX(cc)
FROM CTE; 
```

或者：

```
SELECT TOP(1)
  COUNT(barch_id) AS cc
FROM tbl_associate_593932 
WHERE induction_result > 50 
GROUP BY batch_id
ORDER BY cc DESC; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-16T14:56:43.017

使用：select max (t.cc) from (select COUNT(batch_id) AS cc FROM tbl_associate_593932 WHEREduction_result>50 GROUP BY batch_id) as t；

# powershell - 将 -Debug 传递给调用脚本时，模块不运行 Write-Debug

> ID：14243311
> 
> 赞同：0
> 
> 时间：2013-01-09T17:48:39.483
> 
> 标签：powershell

我有一个具有以下功能的模块。

**测试模块.psm1**

```
function Do-Stuff
{
    [CmdletBinding()]
    param($Stuff)
    Write-Debug 'Doing stuff!'
    Write-Host $Stuff
} 
```

我有一个导入模块的脚本。

**测试脚本.ps1**

```
[CmdletBinding()]
param($Stuff)

Import-Module ./Test-Module.psm1

Write-Host 'About to do stuff.'
Do-Stuff -Stuff $Stuff
Write-Host 'Just did some stuff.' 
```

但是当我调用脚本时，Do-Stuff 函数中不尊重 -Debug 标志。

```
PS > .\Test-Script.ps1 -Stuff 'foobar'
About to do stuff.
foobar
Just did some stuff. 
```

我记得最近在 StackOverflow 上看到了一些讨论这个问题的内容，并建议您可以让模块通过调用堆栈检查参数以确定它是否应该实现调试。我现在找不到它，而且我不确定我当时是否理解如何实施。

我怎样才能实现这样的东西，或者实现相同目标的不同东西。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-09T17:59:48.117

一种方法可能是将此代码添加到您的模块之上：

```
if ((get-pscallstack |select -last 2 |select -expand arguments -first 1) -match "verbose"){$verbosepreference="continue"}
if ((get-pscallstack |select -last 2 |select -expa arguments -first 1) -match "debug"){ $debugpreference="continue"} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-09T18:03:41.873

简单的解决方案：添加自定义调试开关。

测试脚本.ps1

```
[CmdletBinding()]
param($Stuff, [switch]$UseDebug)

Import-Module ./Test-Module.ps1

Write-Host 'About to do stuff.'
Do-Stuff -Stuff $Stuff -Debug:$UseDebug
Write-Host 'Just did some stuff.' 
```

复杂的解决方案：阅读以下[SO 问题](https://stackoverflow.com/questions/4301562/how-to-properly-use-the-verbose-and-debug-parameters-in-custom-cmdlet)

# css - 如何为仅 CSS 的语音气泡添加边框

> ID：14243315
> 
> 赞同：3
> 
> 时间：2013-01-09T17:48:46.570
> 
> 标签：css

我将以下代码用于纯 css 语音气泡，但是我仍然无法为整个气泡添加边框，包括向下的箭头

**HTML**

```
<div class="bubble">Welcome</div> 
```

**CSS 代码**

```
.bubble {
height: 30px;
width: 574px;
background-color: #9FC175;
background-image: -webkit-linear-gradient(top, hsla(0,0%,100%,.5), hsla(0,0%,100%,0));
background-image: -moz-linear-gradient(top, hsla(0,0%,100%,.5), hsla(0,0%,100%,0));
background-image: -ms-linear-gradient(top, hsla(0,0%,100%,.5), hsla(0,0%,100%,0));
background-image: -o-linear-gradient(top, hsla(0,0%,100%,.5), hsla(0,0%,100%,0));
background-image: linear-gradient(top, hsla(0,0%,100%,.5), hsla(0,0%,100%,0));
border-radius: 5px;
box-shadow: inset 0 1px 1px hsla(0,0%,100%,.5),3px 3px 0 hsla(0,0%,0%,.1);
text-shadow: 0 1px 1px hsla(0,0%,100%,.5);
position: absolute;
}

.bubble:after, .bubble:before {
border-bottom: 25px solid transparent;
border-right: 25px solid #9FC175;
bottom: -25px;
content: '';
position: absolute;
right: 25px;
}

.bubble:before {
border-right: 25px solid hsla(0,0%,0%,.1);
bottom: -28px;
right: 22px;
} 
```

**结果**

![在此处输入图像描述](../Images/6f2989cfc2632153249cba49c88fcea2.png)

`border:2px solid #493A34;`如果我在课堂上添加边框代码`.bubble`

**结果**

![在此处输入图像描述](../Images/e3524cfec788cd618c433843ba8b8476.png)

**问题**

如何将边框也添加到箭头？〜任何想法

编辑：这是应用的小提琴[链接](http://jsfiddle.net/aEmGa/)`box-shadow`。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-09T17:54:01.240

您可以使用 :after 伪元素制作一个稍大的棕色箭头，并将其放置在较小的绿色箭头（使用 :before 制作）的后面，向下 2px 以创建边框效果。

这是小提琴：http: [//jsfiddle.net/rhGCb/](http://jsfiddle.net/rhGCb/)

和CSS：

```
.bubble {
  border:2px solid #493A34;
height: 30px;
width: 574px;
background-color: #9FC175;
background-image: -webkit-linear-gradient(top, hsla(0,0%,100%,.5), hsla(0,0%,100%,0));
background-image: -moz-linear-gradient(top, hsla(0,0%,100%,.5), hsla(0,0%,100%,0));
background-image: -ms-linear-gradient(top, hsla(0,0%,100%,.5), hsla(0,0%,100%,0));
background-image: -o-linear-gradient(top, hsla(0,0%,100%,.5), hsla(0,0%,100%,0));
background-image: linear-gradient(top, hsla(0,0%,100%,.5), hsla(0,0%,100%,0));
border-radius: 5px;
box-shadow: inset 0 1px 1px hsla(0,0%,100%,.5),3px 3px 0 hsla(0,0%,0%,.1);
text-shadow: 0 1px 1px hsla(0,0%,100%,.5);
position: absolute;
}

.bubble:before {
border-bottom: 25px solid transparent;
border-right: 25px solid #493A34;
bottom: -27px;
content: '';
position: absolute;
right: 23px;

}

  .bubble:after {
border-bottom: 25px solid transparent;
border-right: 25px solid #9FC175;
bottom: -23px;
content: '';
position: absolute;
right: 25px;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-09T17:52:59.350

有点技巧，但您可以添加一个`box-shadow`作为边框的行为（意思`blur`是，设置为`0`）：

```
.speech-bubble{
    /* ... */

    /* 2px = border-width #333 = border-color */
    -webkit-box-shadow:0 0 0 2px #333;
            box-shadow:0 0 0 2px #333;
} 
```

# single-sign-on - StarterSTS 发出附加声明

> ID：14243318
> 
> 赞同：0
> 
> 时间：2013-01-09T17:49:03.493
> 
> 标签：single-sign-on, adfs2.0, adfs, sts-securitytokenservice

有谁知道如何从 Dominic (Codeplex) 的 StarterSTS 发出附加声明。我目前只获得登录时间实例和身份验证类型，即密码。是否有一些我可以编辑的配置文件或我需要插入的代码来向用户提供额外的声明？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-14T14:01:06.463

我不确定您是否可以在 StarterSTS 中使用，但如果您在项目上注明：-

> 重要 StarterSTS 已停产。资源将留在这里用于教育目的。请从现在开始使用我的新项目 IdentityServer (http://identityserver.codeplex.com)。

IdentityServer 确实支持其他声明。您使用用户配置文件添加声明 - 这样做非常容易，如果可能，我建议您升级到此。

我看不到 starterSTS 的源代码，所以我不确定它是否支持此功能。您可以[在此处找到 Identity Server V2](http://thinktecture.github.com/Thinktecture.IdentityServer.v2/)

# xml - 两个 xml 文件之间的“查找和替换”

> ID：14243319
> 
> 赞同：0
> 
> 时间：2013-01-09T17:49:06.050
> 
> 标签：xml, replace

这是一个例子。

文件 1：

```
<entry>
    <uselesstag1>data!</uselesstag>
    <identifier>entryname<identifier>
    <uselesstag2>data</uselesstag>
    <uselesstag5>moredata</uselesstag>
    <importantdata>8</importantdata>
    <uselesstag3>somemoredata<uselesstag>
</entry>

[...] 
```

文件 2：

```
<entry>
    <uselesstag6>yetmoredata</uselesstag>
    <identifier>entryname<identifier>
    <uselesstag3758>data</uselesstag>
    <uselesstag25>moredata</uselesstag>
    <uselesstag100>whynotmoredata<uselesstag>
    <importantdata>0</importantdata>
    <uselesstag603>stilldata<uselesstag>
</entry>

[...] 
```

我想要做的是以下内容：

如果`<importantdata>`第二个文件中的数据为0，而第一个文件中没有，则将其替换为第一个文件的值。

提前感谢您的帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-10T09:11:25.673

不知道你用的是什么编程语言，这里有一个C#的解决方案。

```
 //Load your xml files first
        XmlDocument doc1 = new XmlDocument();
        doc1.Load("file1.xml");
        XmlNode root1 = doc1.DocumentElement;

        XmlDocument doc2 = new XmlDocument();
        doc2.Load("file2.xml");
        XmlNode root2 = doc2.DocumentElement;

        //Find <importantdata> in each xml document
        XmlNode importantDataInFile1 = root1.SelectSingleNode("/entry/importantdata");
        XmlNode importantDataInFile2 = root2.SelectSingleNode("/entry/importantdata");
        string value1 = importantDataInFile1.InnerText;
        string value2 = importantDataInFile2.InnerText;
        //If the data in <importantdata> is 0, replace its value with value1 
        if (value2.Equals("0") && !value1.Equals("0"))
        {
            importantDataInFile2.InnerText = value1;
            doc2.Save("file2.xml");
        } 
```

这不是一个困难的问题，我认为你可以让它发挥作用。希望能帮助到你。

# java - 提取 Weka 中的重要属性

> ID：14243322
> 
> 赞同：3
> 
> 时间：2013-01-09T17:49:16.987
> 
> 标签：java, data-mining, weka

这是一个相当新手的问题，所以请持保留态度。

我是数据挖掘领域的新手，并试图让我的头脑围绕这个话题。现在我正在尝试完善我现有的模型，以便更好地对实例进行分类。问题是，我的模型有大约 480 个属性。我确信并非所有这些都是相关的，但我很难指出哪些确实重要。

**问题是**：拥有**有效的训练和测试集**，是否可以使用某种**数据挖掘算法**来丢弃似乎对分类质量没有任何影响的属性？

我正在使用Weka。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-09T18:38:24.430

您应该使用**Weka**拥有的一些**分类**器算法进行测试。

 **基本思想是使用**交叉验证**选项，因此您可以查看哪种算法为您提供了最佳的**正确分类实例**值。

我可以给你一个我的训练集的例子，使用**交叉验证**选项并选择**折叠**10。

如您所见，使用**J48**分类器，我将拥有：

```
Correctly Classified Instances        4310               83.2207 %
Incorrectly Classified Instances       869               16.7793 % 
```

如果我将使用例如**NaiveBayes**算法，我将拥有：

```
Correctly Classified Instances        1996               38.5403 %
Incorrectly Classified Instances      3183               61.4597 % 
```

依此类推，值因算法而异。

因此，请尽可能多地测试算法，看看哪一种可以为您提供最佳的正确分类实例/时间消耗。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-09T17:51:31.887

阅读有关聚类算法的主题（尽管仅在您的训练集上！）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-13T13:23:30.767

评论转换为 OP 建议的答案：如果您使用 weka 3.6.6 - 选择模块资源管理器 -> 而不是转到选项卡“选择属性”并选择“属性评估器”和“搜索方法”，您还可以在使用完整数据集之间进行选择或 cv 集，有关更多详细信息，请参见[http://forums.pentaho.com/showthread.php?68687-Selecting-Attributes-with-Weka](http://forums.pentaho.com/showthread.php?68687-Selecting-Attributes-with-Weka)或[http://weka.wikispaces.com/Performing+attribute+selection](http://weka.wikispaces.com/Performing+attribute+selection)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-09-18T21:56:20.677

查看 InfoGainAttributeEval 类。buildEvaluator() 和 evaluateAttribute(int index) 函数应该有所帮助。**

# c# - 如何找到从 C# 类方法调用的方法 - 不是在运行时

> ID：14243326
> 
> 赞同：5
> 
> 时间：2013-01-09T17:49:25.567
> 
> 标签：c#, .net, reflection, dll, refactoring

我有一个包含太多代码的 C# 类，我想要`refactor`它。我想做的是从所有的开始`public methods`，并为每个构建`tree`一个，显示类中的哪些其他方法是从中调用的，然后是从子类中调用的方法，依此类推。

这将使我能够看到哪些`private methods`只属于一个`public method`，哪些是共享的等等。

请注意，我不想在运行时执行此操作，我希望能够直接查看类，或者在`.cs file`编译后使用反射`DLL`。

我知道我可以在编译的 DLL 上使用反射来获取方法，但是我找不到任何方法来找出类中的其他方法调用了哪些方法。

有人有什么想法吗？同样，这不是运行时问题，它纯粹是为了构建一个可重用的实用程序来帮助重构一个超大的类。我正在研究的解决方案中有很多，所以代码会被一遍又一遍地使用。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-01-09T17:54:55.673

Visual Studio 2010 具有“查看调用层次结构”操作，您可以在其中查看解决方案中调用代码的所有位置。

根据我的经验，这种静态分析可能有些欠缺，例如可以使用反射、数据绑定、依赖注入容器等动态​​调用方法。

此外，这可能有点偏离主题，并且不适用于您的情况，但我发现找到组件死代码的好方法是拥有一套集成测试。然后您可以运行代码覆盖率，并直观地查看哪些代码路径永远不会执行。

# .net-4.0 - 将属性添加到属性窗口

> ID：14243327
> 
> 赞同：0
> 
> 时间：2013-01-09T17:49:26.707
> 
> 标签：.net-4.0, visual-studio-2012

我已经构建了一个 UserControl 类并将某些属性公开给父对象。

当我将组件拖放到父对象设计器表面时，我得到了我需要的效果（按说）。我想进一步开发的是能够将属性值（在属性窗口中）预填充为默认值，但它不会像我预期的那样自动填充。

这是我到目前为止所拥有的：

```
<Browsable(True), Category("Data"),
DefaultValue("01/01/1990")>
Public Property [Date] As String
    Get
        Return Me._dt
    End Get
    Set(value As String)
        Me._dt = value
        dtValue.Text = value
    End Set
End Property 
```

我知道`DefaultValueAttribute`如果没有进行其他分配，则会分配该值，但认为它也会将该值放在“属性”窗口的字段中。

同样，这个最终的任务将作为一个集合再上一层，所以任何关于如何通过属性窗口使组件集合可用的建议或 URL？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-09T17:50:39.833

> 我知道如果没有进行其他分配，则 DefaultValueAttribute 会分配该值

这是不正确的。

这`DefaultValueAttribute`只是告诉设计者默认值是什么的元数据。

确保属性实际获得该值仍然取决于您的代码。

# android - 适配器.notifyDataSetChanged(); 和 listview.invalidateViews 不刷新 listview

> ID：14243328
> 
> 赞同：0
> 
> 时间：2013-01-09T17:49:30.097
> 
> 标签：android, listview

我有一个应用程序，用户将在其中单击列表视图中的项目，然后保存、取消或删除该条目（这是在单击项目时启动的新活动上完成的）。因此，在单击项目时启动的活动中，单击任一按钮后，我调用finish() 以返回到我以前的活动，在这种情况下是带有列表视图的活动。但是，如果我对列表中的项目进行任何更改，则列表根本不会更改。我尝试同时使用 .notifyDataSetChanged() 和 invalidateViews 但两者都不起作用。这是我的代码。

```
public class Flashcards_List extends ListActivity{

String[] All_Cards = null;
ArrayAdapter<String> adapter;
ListView listview;

@Override
protected void onCreate(Bundle savedInstanceState) {
    // TODO Auto-generated method stub
    super.onCreate(savedInstanceState);
    setContentView(R.layout.flashcards_list);

    Flashcards Cards = new Flashcards(this);
    Cards.open();

    All_Cards = Cards.getAllFronts();

    listview = (ListView) findViewById(android.R.id.list);
    listview.invalidateViews();
    adapter = new ArrayAdapter<String>(Flashcards_List.this, android.R.layout.simple_list_item_1, All_Cards);

    // Assign adapter to ListView
    listview.setAdapter(adapter);

}

@Override
protected void onListItemClick(ListView l, View v, int position, long id) {
    // TODO Auto-generated method stub
    super.onListItemClick(l, v, position, id);

    String Specific_Card = All_Cards[position];

    /* Class to assist us in loading the activity */
    Class editClass = null;

    try {
        editClass = Class.forName("com.example.flashcards.Edit_Flashcard");
    } catch (ClassNotFoundException e) {
        // TODO Auto-generated catch block
        e.printStackTrace();
    }

    Bundle specificCard = new Bundle();
    specificCard.putString("card", Specific_Card);

    Intent ourIntent = new Intent(Flashcards_List.this, editClass);
    ourIntent.putExtras(specificCard);//passing the bundle to the activity
    startActivity(ourIntent);
    adapter.notifyDataSetChanged();
}
} 
```

此类编辑数据库条目

```
public class Edit_Flashcard extends Activity implements OnClickListener{

String front_of_card = null;
Bundle bundle_received;

Button cancel, delete, save;
EditText front, back;

String[] card;

@Override
protected void onCreate(Bundle savedInstanceState) {
    // TODO Auto-generated method stub
    super.onCreate(savedInstanceState);
    setContentView(R.layout.edit_flashcard);

    bundle_received = getIntent().getExtras();
    front_of_card = bundle_received.getString("card");//current card is the card that was clicked on
    Flashcards info = new Flashcards(this);
    info.open();
    card = info.getCard(front_of_card);
    info.close();

    initialize();
}

public void initialize(){

    front = (EditText) findViewById(R.id.front);
    back = (EditText) findViewById(R.id.back);
    front.setText(card[1]);
    back.setText(card[2]);

    cancel = (Button) findViewById(R.id.cancel);
    save = (Button) findViewById(R.id.save);
    delete = (Button) findViewById(R.id.delete);

    cancel.setOnClickListener(this);
    save.setOnClickListener(this);
    delete.setOnClickListener(this);
}

@Override
public void onClick(View v) {
    // TODO Auto-generated method stub

    switch(v.getId()) {
        case R.id.cancel:
            super.finish();//finishes the activity, and returns to previous Activity
            break;

        case R.id.save:
            try{

                Flashcards update_entry = new Flashcards(this);
                update_entry.open();

                update_entry.updateEntry(card[0], front.getText().toString(), back.getText().toString());
                update_entry.close();
            }catch(Exception e){            

                String save_text = "The Flashcard could not be saved. Please try again.";
                int duration = Toast.LENGTH_SHORT;
                Toast toast = Toast.makeText(Edit_Flashcard.this, save_text, duration);
                toast.setGravity(Gravity.CENTER_VERTICAL, 0, 0);
                toast.show();
            }
            super.finish();
            break;

        case R.id.delete:
            try{

                Flashcards delete_entry = new Flashcards(this);
                delete_entry.open();

                delete_entry.deleteEntry(card[0]);

                delete_entry.close();
            }catch(Exception e){
                /* set the value to NOT INSERTED */

                String delete_text = "The Flashcard could not be deleted. Please try again.";
                int duration = Toast.LENGTH_SHORT;
                Toast toast = Toast.makeText(Edit_Flashcard.this, delete_text, duration);
                toast.setGravity(Gravity.CENTER_VERTICAL, 0, 0);
                toast.show();
            }
        super.finish();
            break;
    }/* end Switch */
}/* end onClick */
}

<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
android:layout_width="match_parent"
android:layout_height="match_parent"
android:background="@drawable/background"
android:orientation="vertical" >

<ListView
android:id="@android:id/list"
android:layout_width="fill_parent"
android:layout_height="wrap_content" />

</LinearLayout> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-09T18:12:13.327

通过 startActivityForResult 方法启动 EditClass 活动。在调用活动中实现 onActivityResult 方法，并在该方法中调用 adapter.notifyDatasetChanged。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-09T18:19:58.810

```
Intent ourIntent = new Intent(Flashcards_List.this, editClass);
ourIntent.putExtras(specificCard);//passing the bundle to the activity
startActivity(ourIntent);
adapter.notifyDataSetChanged(); 
```

`notifyDataSetChanged`调用后立即执行`startActivity()`，它不会阻塞。相反，您应该将数据加载到 中`onResume()`，这样活动返回时将始终显示最新数据。基本上只留下`setContentView()`你的`onCreate`.

# asp.net-mvc-3 - SessionEnd 和 Session_OnEnd 有什么区别？

> ID：14243330
> 
> 赞同：2
> 
> 时间：2013-01-09T17:49:36.783
> 
> 标签：asp.net-mvc-3

我想在 Asp.net MVC 3 中使用会话结束。
但是到处的在线文档似乎可以互换使用这两个事件有什么区别吗？

# javascript - 单击 Div 将值放入文本框

> ID：14243332
> 
> 赞同：0
> 
> 时间：2013-01-09T17:49:48.723
> 
> 标签：javascript, jquery, asp.net, html

我目前正在尝试为我的页面制作壁纸更换器。

此刻，我想在单击 CSS 菜单中的相应 DIV 选项时将壁纸的 URL 放入文本框中。

这是我的 jQuery

```
$("div.bg8").click( function() {
var BackgroundURL = 'Styles/hongkongskyline.jpg'; 
var TheTextBox = document.getElementById('<%=BackgroundsTxt.ClientID%>'); 
TheTextBox.value= BackgroundURL; 
alert('This has worked'); }); 
```

..和我的HTML...

```
 <ul><li class="#cssmenu"><a>
  <div id="bg8" runat="server">
    <table style="height: 16px; width:33%;"> 
     <tr>
     <td>
     <img src='Styles/hongkongskyline.jpg' width="34px" height="32px" /></td>  <td>Hong Kong Skyline                                                                                       </td> 
     </tr> 
    </table>
   </div>
</a></li></ul> 
```

不幸的是，当我单击 DIV 时似乎什么都没有发生。

有人看到我看不到的问题吗？

非常感谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-09T17:54:29.807

这里有几个问题。

首先，您不是在 jQuery 中指代您的 div 的 ID - 您指的是一个名为 bg8 的类。试试这个：

```
$("#bg8")... 
```

接下来，您将在 jQuery 中混入一些原生 dom 的东西。代替

```
document.getElementById('<%=BackgroundsTxt.ClientID%>'); 
```

尝试

```
$("#<%=BackgroundsTxt.ClientID%>"); 
```

并确保通过查看页面的源来解析 ID。

最后，设置文本框的值：

```
theTextBox.val(BackgroundURL); 
```

你的整个功能可能是

```
$("#bg8").click( function() {
    $("#<%=BackgroundsTxt.ClientID%>").val('Styles/hongkongskyline.jpg'); 
    alert('This has worked');
}); 
```

我的策略是在进入真正的逻辑之前用简单的警报测试事件处理程序。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-09T17:53:53.187

你的 jQuery 声明 $('div.bg8') ，这需要一个带有 bg8 类的 div，

你没有设置类，而是你的 div 的 id 为 bg8

改变这个： $('div.bg8') 到 $('#bg8')

;)

# asp.net - Page_Load 执行两次

> ID：14243339
> 
> 赞同：0
> 
> 时间：2013-01-09T17:50:24.317
> 
> 标签：asp.net

这个问题与我的页面在回发时加载两次有关。我不符合 asp.net 中的页面生命周期，因此我的帖子。

简短的搜索显示 AutoEventWireup 是其中的一个参与者，目前在我的 Page 指令中没有引用。单步执行 Page_Load 执行两次的代码，第一次是从自动生成以下内容的 OnInint/InitializeComponent 开始：`this.Load += new System.EventHandler(this.Page_Load);`。主要问题是：我有一个类级别的变量`Int32 totalDuration = 0;`，它通过将名为“Duration”的单元格的值相加来填充到 gridView RowDataBound 事件中。例如，网格视图包含两行，其中第一行的单元格包含值 35（分钟），第二行包含 25。目的是将每行的所有分钟数相加。这是简化的方法：

```
protected void gv_RowDataBound(object sender, GridViewRowEventArgs e)
    {
        DataRowView drv = (DataRowView)e.Row.DataItem;

        if (e.Row.RowType == DataControlRowType.DataRow)
        {
            totalDuration = totalDuration + Convert.ToInt32(drv["Duration"]);
        }

        lblMinutes.Text = totalDuration.ToString("#,##0");
    } 
```

因为Page_Load执行两次totalDuration的值加倍，这显然是不正确的。`this.Load += new System.EventHandler(this.Page_Load);`作为修复，我在 InitializeComponents 方法中注释掉了 。站点和页面似乎可以工作，但我不确定这是否真的是解决潜在问题的方法。

我对您的建议持开放态度，我欢迎您对整个 InitilizeComponent 或 Autowireup 等内容进行一些解释。

谢谢你，里修

编辑： Page_Load 看起来像这样：

```
private void Page_Load(object sender, System.EventArgs e)
    {
        if (!Page.IsPostBack)
        {
            /code removed/

            bindGrid(site, metric, month, year);
        }
    }

private void bindGrid(string site, string metric, int month, int year)
    {
        /code removed/
        gv.DataSource = dvSearch;
        gv.DataBind();
    } 
```

# r - 重复测量的混合效应模型

> ID：14243346
> 
> 赞同：2
> 
> 时间：2013-01-09T15:13:44.960
> 
> 标签：r, mixed-models, nlme

我正在尝试在具有重复测量的数据集上开发一个混合效应模型。

`Met``Treat`在提交给 3 个处理（ 、 水平`c`和）的 24 个样本的一系列随机选择的日子里测量`uc`。`ga`

`Met`由于白天天气条件的差异而导致的变化水平（ `Date`）。因此，日期成为模型的第二个随机效应（连同抽样的项目 ( `ID`)）。

我的主要兴趣是看看是否对跨天`Treat`有显着影响。`Met`

一些样本数据：

```
# create example data frame 
ID     <-  factor(rep(c("a", "b", "c", "d", "e", "f", "g", "h", "i", "j", "k", "l", "m", "n", "o", "p", "q", "r", "s", "t", "u", "v", "w", "x"), 6))
Treat  <-  factor(rep(c(rep("c",8), rep("uc",8), rep("ga",8)), 6))
Date   <-  factor(rep(c(rep("10/06/2007",24), rep("19/06/2007",24), rep("12/07/2007",24), rep("21/07/2007",24), rep("11/08/2007",24), rep("12/08/2007",24)), 1))
Met    <-  as.numeric(c(rnorm(8,5,2),   rnorm(8,7,2),   rnorm(8,9,2), 
                        rnorm(8,15,2),  rnorm(8,17,2),  rnorm(8,19,2),
                        rnorm(8,9,2),   rnorm(8,11,2),  rnorm(8,13,2),
                        rnorm(8,8,2),   rnorm(8,10,2),  rnorm(8,12,2),
                        rnorm(8,2,2),   rnorm(8,4,2),   rnorm(8,6,2),
                        rnorm(8,3,2),   rnorm(8,5,2),   rnorm(8,7,2)))
ww     <-  gl(1,1,144)

lys.data  <-  data.frame(ID, Treat, Date, Met, ww)
head(lys.data)

# set contrasts of data frame
lys.data$Treat   <-  factor(lys.data$Treat,     levels=c("c", "uc", "ga")) 
```

然后分析：

```
library(nlme)
lme.001  <-  lme(Met ~ Treat, data = lys.data,
                 random=list(ww=pdBlocked(list(pdIdent(~Date-1),
                             pdIdent(~ID-1)))))
summary(lme.001) 
```

从我得到的结果来看，我似乎没有做我认为我正在做的事情，因为自由度似乎不正确（太高了）。分母自由度的数量随着实验进行的重复次数（日期）的增加而增加，这是否正确？

谁能在这里帮助我或为我指明正确的方向？我代表数据嵌套的方式有问题吗？（我假设没有）。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-16T18:04:36.683

`lme`用于计算分母自由度的规则在第 4 页描述。Pinheiro and Bates (2000) 的第 91 页——这个页面恰好可以[在 Google 图书上](http://bbolker.github.io/mixedmodels-misc/glmmFAQ.html)找到。（该链接也可在[GLMM 常见问题页面上找到](http://glmm.wikidot.com/faq)。）

**更新**：由于这似乎不再以有用的形式在 Google 图书上提供，因此这里是关键段落的文本：

> 这些固定效应项的条件检验需要分母自由度。在条件 $F$-tests 的情况下，分子自由度也是必需的，由术语本身决定。分母自由度由估计项的分组级别确定。如果一个术语的值可以在分组因子的给定级别内变化，则该术语称为相对于因子的*内部。*如果一个术语的值在分组因子的级别*内*没有变化，则它在分组因子之外。如果一个项在 $i-1$st 分组因子的内部并且在 $i$th 分组因子的外部，则称该词项在级别 $i$ 上进行估计。例如，模型中的术语`Machine`在`fm2Machine`外部`Machine %in% Worker`和内部`Worker`，所以估计在水平 2 ( `Machine %in% Worker`)。如果一个术语在模型中所有 $Q$ 分组因子的内部，则在组内误差的水平上进行估计，我们将其表示为 $Q+1$st 水平。
> 
> 截距是对应于模型矩阵 $X_i$ 中全 1 列的参数，当它存在时，其处理方式与所有其他参数不同。作为一个参数，它被认为是在 0 级估计的，因为它在所有分组因素之外。然而，它的分母自由度的计算就像它是在 $Q+1$ 水平上估计的一样。这是因为截距是一个参数，即使 $X_i$ 中的相应列不随级别而变化，它也可以将来自所有观察值的信息集中在一个级别上。
> 
> 令 $m_i$ 表示级别 $i$ 中的组总数（约定当固定效应模型包括截距时 $m_0=1$，否则为 0，$m_{Q+1}=N$）和$p_i$ 表示在第 $i$ 级估计的项对应的自由度之和，第 $i$ 级分母自由度定义为
> 
> $$ denDF_i = m_i - (m_{i-1} + p_i), i = 1, \dots, Q $$
> 
> 该定义与平衡、多级 ANOVA 设计中的经典自由度分解相吻合，并为更一般的混合效应模型提供了合理的近似值。

我没有详细检查你的例子，但我强烈怀疑问题在于你有一个随机块设计而不是一个严格嵌套的设计，所以你的自由度比你想象的要高。一般来说，残差/分母 df 是（块数-1）*（每块数-1），而不是（如您所料）嵌套设计的典型（块数-1）：见[这里](http://www.jerrydallal.com/LHSP/ranblock.htm)， 例如。

另一方面，`lme`如果设计足够复杂，则可能会出错——在这种情况下，您可能必须自己解决，*或者*可能不存在简单的解决方案。再次，请参阅[GLMM 常见问题解答](http://glmm.wikidot.com/faq)以获取建议。

# tsql - 一系列合并进度的状态报告

> ID：14243353
> 
> 赞同：0
> 
> 时间：2013-01-09T17:50:52.590
> 
> 标签：tsql, error-handling, transactions, merge

我想使用 T-SQL 执行一系列合并。我知道如果失败，它会回滚，但我想打印一条消息以表明效果 - 所以我知道我需要去检查它。我似乎找不到任何这样的例子。我的第一个想法是尝试将事务置于尝试中，但随后我不确定回滚语句会发生什么……将其置于捕获中似乎很奇怪。我敢肯定，其他人以前一定想这样做。有没有人有这方面的例子？

注意：我需要使用 MERGE 命令。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-09T20:00:56.207

试试下面的代码。[尝试从 msdn 获取帮助](http://msdn.microsoft.com/en-us/library/ms175976.aspx)

```
BEGIN TRY
    -- Table does not exist; object name resolution
    -- error not caught.
     SELECT * FROM Table;
END TRY
BEGIN CATCH
      Print ERROR_NUMBER() ;
      Print ERROR_MESSAGE() ;
END CATCH 
```

您可以将 OUTPUT 与合并一起使用。[样本](http://www.sqlservercentral.com/Forums/Topic1325508-391-1.aspx)

# apache - 用tomcat和ssl配置apache

> ID：14243358
> 
> 赞同：0
> 
> 时间：2013-01-09T17:51:06.723
> 
> 标签：apache, tomcat6

如何使用 ssl 配置 apache 以重定向到 tomcat http？

我有一个 .80 上的 virtualHost 重定向到 .443 和 virtualHost .443 我把 rewriteCond 和 Proxypass 是正确的配置？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-09T17:54:57.830

这可以通过 mod_jk 完成。请参阅[http://tomcat.apache.org/connectors-doc/generic_howto/quick.html](http://tomcat.apache.org/connectors-doc/generic_howto/quick.html)。

# ios - 类别上的 OCMock

> ID：14243359
> 
> 赞同：2
> 
> 时间：2013-01-09T17:51:09.050
> 
> 标签：ios, objective-c, ocmock, uidevice

我正在尝试为我创建的简单 UIDevice 类别设置一些测试用例。由于这些方法是实例方法，因此我创建了一个模拟来模拟 currentDevice 行为。添加的方法基于 name 属性，因此我创建了一个存根以在 name 属性上返回假名称。

存根运行良好，但如果我尝试访问其他方法，我会得到非模拟名称属性。

这是我的测试用例：

```
#import "UIDevice_NameFromDevice_Tests.h"

#import <OCMock/OCMock.h>

#import "UIDevice+UnitTests.h"
#import "UIDevice+NameFromDevice.h"

@implementation UIDevice_NameFromDevice_Tests

-(void)setUp
{
    self.firstName = @"John";
    self.lastName = @"Doe";
    self.fullName = [NSString stringWithFormat:@"%@ %@",self.firstName,self.lastName];

    self.mockedDevice = [UIDevice createNicelyMockedCurrentDevice];
}

-(void)tearDown
{
    self.firstName = nil;
    self.lastName = nil;
    self.fullName = nil;
    [UIDevice releaseInstance];
}

#pragma mark UIDevice mock checks

-(void)test_mockedDevice_shouldBeEqualToCurrentDevice
{
    self.mockedDevice = [UIDevice createMockedCurrentDevice];

    STAssertEqualObjects(self.mockedDevice, [UIDevice currentDevice], nil);
}

-(void)test_stubedDeviceName_shouldBeEqualToCurrentDeviceName
{

    NSString *format = @"%@ %@'s iPhone";
    NSString *fakeiPhoneName = [NSString stringWithFormat:format,self.firstName,self.lastName];

    [[[self.mockedDevice stub] andReturn:fakeiPhoneName] name];

    STAssertEqualObjects([self.mockedDevice name], [[UIDevice currentDevice] name], nil);
    STAssertEqualObjects([[UIDevice currentDevice] name], fakeiPhoneName, nil);

}

#pragma mark test langages

-(void)test_BasicENName_shouldReturnValues
{
    NSString *fakeiPhoneName = [NSString stringWithFormat:@"%@'s iPhone", self.fullName];

    [[[self.mockedDevice stub] andReturn:fakeiPhoneName] name];

    NSLog(@"name : %@",[[UIDevice currentDevice] name]);
    NSLog(@"fullname : %@",[[UIDevice currentDevice] fullNameFromDevice]);
    NSLog(@"firstname : %@",[[UIDevice currentDevice] firstName]);
    NSLog(@"lastname : %@",[[UIDevice currentDevice] lastName]);

    STAssertEqualObjects([self.mockedDevice name], [[UIDevice currentDevice] name], nil);
    STAssertEqualObjects([[UIDevice currentDevice] name], fakeiPhoneName, nil);
//    STAssertEqualObjects([[UIDevice currentDevice] fullNameFromDevice], self.fullName, nil);
//    STAssertEqualObjects([[UIDevice currentDevice] firstName], self.firstName, nil);
//    STAssertEqualObjects([[UIDevice currentDevice] lastName], self.lastName, nil);
}

@end 
```

这是完整的代码：[https ://github.com/tiboll/TLLNameFromDevice/](https://github.com/tiboll/TLLNameFromDevice/)

（3个评论断言不起作用）

有人有什么主意吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-10-11T19:52:19.060

要修复这些项目，请执行以下项目。

在`UIDevice+UnitTests.m`

添加以下方法：

```
+(id)createPartialMockedCurrentDevice
{
    _mockedCurrentDevice = [OCMockObject partialMockForObject:[UIDevice currentDevice]];
    return _mockedCurrentDevice;
} 
```

删除以下方法：

```
+(UIDevice *)currentDevice
{
    if (_mockedCurrentDevice)
        return _mockedCurrentDevice;

    return invokeSupersequentNoParameters();
} 
```

并从方法中删除以下语句

`-(NSString *)fullNameFromDevice in class UIDevice+NameFromDevice.m`

```
if (_name)
    return _name; 
```

# asp.net - CSS 不加载

> ID：14243360
> 
> 赞同：0
> 
> 时间：2013-01-09T17:51:11.587
> 
> 标签：asp.net, .net, html, css

每个人。我们这里有点急。我们面临一个问题。在我们的一个应用程序中，CSS 偶然崩溃。通过IE开发者工具，我们得到的是：

```
UNKNOWN
   font-style: normal
   font-family: Arial, Helvetica, sans-serif
   [...]
.section_head
   font-style: Arial, Helvetica, sans-serif
   color: #003366
   [...] 
```

这是不对的。UNKNOWN 是什么意思？是否加载失败？它在 DEV 中运行良好，但在 Staging 中不行（DEV 和 STG 环境具有相同的 .css 文件，但确实存档在不同的服务器中）。

非常感谢。马丁。

编辑：这是标题部分：

```
<head id="ctl00_Head1"><title>
Local Market Development – Activity Tracking Tool
</title><link rel="stylesheet" type="text/css" 
href="./App_Themes/SMT.SE/Css/SMT.SE.css?v=12" />

<link href="/WebResource.axd?d=-NDJxaf2kREMPzEZaAiVcFh35WR6hCcIbA_i4l7VEJZ0i508zIYCADtpX3503O
-khhzaW0BxzunxkTE-JqRu89g8VZ54u9zL-Y_VOk9q3PaiXxUtWIDyGgXN8doQb6-
4DFG9V2sS1UTOwjHauX2xcZ4uTu01&amp;t=634877831646886861" 
type="text/css" rel="stylesheet" /></head> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-09T17:55:14.253

也许有一个不是 UTF8 的隐藏字符（或者如果你的文件是 ANSI）？当某些文本从 Microsoft 程序（如 Word）复制时，有时会发生这种情况。

# php - 如何有效地运行同时网络请求？

> ID：14243364
> 
> 赞同：1
> 
> 时间：2013-01-09T17:51:17.943
> 
> 标签：php, asynchronous

我有一个用 PHP 编写的网络应用程序，我使用 Symfony2 作为核心框架。

我需要每 10 分钟左右定期运行数千个小型网络请求，并且我正在尝试找到异步运行这些作业的最佳解决方案，而不会发生冲突或加倍。

目前我有一个非常基本且不优雅的解决方案，其中 cron 作业执行 PHP 命令脚本。该命令同步处理数据库中的每个条目并发送网络请求。当该请求完成（或失败）时，它会继续进行下一个请求。当它遍历所有条目时，它就存在了，可以从 cron 作业中再次执行。

对于重写，我将[php-resque](https://github.com/chrisboulton/php-resque)和[pcntl_fork](http://php.net/manual/en/function.pcntl-fork.php)视为并行运行作业的解决方案，从而显着加快执行速度。我还研究过从 PHP 运行多个非阻塞套接字请求，但到目前为止，我更喜欢隔离作业的简单性。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-09T17:53:05.967

PHP 不能做传统意义上的线程，所以你想要做的事情并不是你想的那样。您已经在 中查看了（可能）最好的解决方案`pcntl_fork`，但这仍然不是真正的异步。您是否考虑过使用 cron 来代替？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-09T21:42:46.640

[http://php.net/pthreads](http://php.net/pthreads)

[http://github.com/krakjoe/pthreads](http://github.com/krakjoe/pthreads)

github 上的示例......并包含在分发中，使用 github 中的代码，它包含尚未发布的修复。

# php - PHPExcel：设置字体大小？

> ID：14243365
> 
> 赞同：39
> 
> 时间：2013-01-09T17:51:31.387
> 
> 标签：php, phpexcel

我一直在寻找使用名为 PHPExcel 的 PHP 库来更改某些 Excel 单元格的字体大小。

这是我尝试过的：

```
$objPHPExcel->getActiveSheet()->getStyle("F1:G1")->getFont()->setFontSize(16); 
```

上面的方法不起作用。我想知道是否有人知道如何做到这一点？

提前谢谢了。

* * *

## 回答 #1

> 赞同：77
> 
> 时间：2013-01-09T18:08:30.590

改用`setSize`方法`setFontSize`，它应该可以工作：

```
$objPHPExcel->getActiveSheet()->getStyle("F1:G1")->getFont()->setSize(16); 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2017-02-21T13:03:46.483

如果你想使用*样式数组*，那么你可以这样做：

```
$fontStyle = [
    'font' => [
        'size' => 16
    ]
];

$workbook->getActiveSheet()
    ->getStyle("F1:G1")
    ->applyFromArray($fontStyle); 
```

# asp.net - 安装了 VS 2003，如果不启用 32 位，VS2010 网站将无法加载

> ID：14243369
> 
> 赞同：0
> 
> 时间：2013-01-09T17:51:37.013
> 
> 标签：asp.net, iis-7

我必须支持这个 2003 年编写的应用程序，所以我将它安装在我的本地计算机上，现在我的网站在没有安装 32 位应用程序的情况下运行时出现以下错误。

以前我在没有安装 32 位应用程序的情况下运行应用程序池。有什么可以改变的？

由于配置问题，无法加载 ISAPI 筛选器“c:\Windows\Microsoft.NET\Framework\v4.0.30319\aspnet_filter.dll”。当前配置仅支持加载为 AMD64 处理器架构构建的图像。。要了解有关此问题的更多信息，包括如何解决此类处理器架构不匹配错误，请参阅[http://go.microsoft.com/fwlink/?链接ID=29349](http://go.microsoft.com/fwlink/?LinkId=29349)。

任何建议将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-09T21:28:59.513

以防万一其他人遇到这种情况......我去了有问题的网站，然后导航到 ISAPI 过滤器部分，并注意到其中一个路径有一个额外的反斜杠。

![在此处输入图像描述](../Images/6993d9d6932e07ecd08be287efe4b01f.png)

# ext.net - 如何强制页面显示在 ext:Panel 中？

> ID：14243370
> 
> 赞同：0
> 
> 时间：2013-01-09T17:51:43.370
> 
> 标签：ext.net

这是关于`ext.net`。

我在`West`部分中有一个链接，通过单击该链接，一个网页应该显示在`Center`选项卡的部分中。但是如何防止页面在新的浏览器窗口或选项卡中呈现（通过单击或右键单击，然后选择在新选项卡中打开）？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-28T06:00:50.473

我可以建议使用 LinkBut​​ton （如果你真的需要你的链接看起来像一个链接）。 [http://examples.ext.net/#/Buttons/Basic/LinkBut​​ton/](http://examples.ext.net/#/Buttons/Basic/LinkButton/)

处理其 Click 事件并将任何 URL 加载到 Center 区域。

```
App.PanelCenter.load({ url: "some URL" }); 
```

PanelCenter 应配置相应的加载程序。

希望这可以帮助。

# css - JavaFx 2.x：LineChart css 轴设置 Y Scale Side

> ID：14243371
> 
> 赞同：2
> 
> 时间：2013-01-09T17:51:47.440
> 
> 标签：css, javafx, linechart

在绘制 LineChart 的代码中，我添加了一个 CSS 字符串来选择在图表的右侧或左侧显示 Y 价格刻度。

这是代码

```
import java.util.Set;
import javafx.application.Application;
import javafx.event.EventHandler;
import javafx.scene.Node;
import javafx.scene.Scene;
import javafx.scene.chart.CategoryAxis;
import javafx.scene.chart.LineChart;
import javafx.scene.chart.NumberAxis;
import javafx.scene.chart.XYChart;
import javafx.scene.input.MouseEvent;
import javafx.scene.layout.BorderPane;
import javafx.stage.Stage;

public class XyChart extends Application {

@Override
public void start(Stage stage) {
   stage.setTitle("Line plot");

   final CategoryAxis xAxis = new CategoryAxis();
   final NumberAxis yAxis = new NumberAxis(1, 21,0.1);

   yAxis.setTickUnit(1);
   yAxis.setPrefWidth(35);
   yAxis.setMinorTickCount(10);

   yAxis.setTickLabelFormatter(new NumberAxis.DefaultFormatter(yAxis){
        @Override
    public String toString(Number object){
            String label;
            label = String.format("%7.2f", object.floatValue());
            return label;
    }
});
final LineChart<String, Number>lineChart = new LineChart<String, Number>(xAxis, yAxis);

   lineChart.setCreateSymbols(false);
   lineChart.setAlternativeRowFillVisible(false);
   lineChart.setLegendVisible(false);

   XYChart.Series series1 = new XYChart.Series();

    series1.getData().add(new XYChart.Data("Jan", 1));
    series1.getData().add(new XYChart.Data("Feb", 4));
    series1.getData().add(new XYChart.Data("Mar", 2.5));
    series1.getData().add(new XYChart.Data("Apr", 5));
    series1.getData().add(new XYChart.Data("May", 6));
    series1.getData().add(new XYChart.Data("Jun", 8));
    series1.getData().add(new XYChart.Data("Jul", 12));
    series1.getData().add(new XYChart.Data("Aug", 8));
    series1.getData().add(new XYChart.Data("Sep", 11));
    series1.getData().add(new XYChart.Data("Oct", 13));
    series1.getData().add(new XYChart.Data("Nov", 10));
    series1.getData().add(new XYChart.Data("Dec", 20));        

    BorderPane pane = new BorderPane();
    pane.setCenter(lineChart);          
    Scene scene = new Scene(pane, 800, 600);
    lineChart.setAnimated(false);
    lineChart.getData().addAll(series1); 

    String priceSide = "-fx-side: right;";

    Set<Node> axisNode = lineChart.lookupAll(".axis");
        for(final Node axis : axisNode){

            axis.setStyle(priceSide);
        }

    stage.setScene(scene);
    stage.show();
}

public static void main(String[] args) {
    launch(args);
}   
} 
```

我想我遗漏了一些东西，因为绘制的线现在全部折叠到图表的左侧。

只评论这部分

```
String priceSide = "-fx-side: right;";

    Set<Node> axisNode = lineChart.lookupAll(".axis");
        for(final Node axis : axisNode){

            axis.setStyle(priceSide);
        } 
```

它绘制正确：如果我使用也会出现同样的问题

```
"-fx-side: left;"; 
```

这段代码有什么问题？

谢谢。

# entity-framework - EF 4.3 - 更新实体和子实体

> ID：14243375
> 
> 赞同：0
> 
> 时间：2013-01-09T17:51:57.617
> 
> 标签：entity-framework, entity-framework-4.3

我有一个带有子实体 OrderDetail 的实体 Order。我想更新订单并添加一个新的 OrderDetail。我该怎么做？

我尝试将订单的状态设置为已修改，但出现此错误：

发生参照完整性约束冲突：定义参照约束的属性值在关系中的主体对象和从属对象之间不一致。

更新：添加新的 OrderDetail 后，我想更新作为主键一部分的订单类型。我尝试将 OrderDetail 的状态设置为已修改，但出现新错误：

存储更新、插入或删除语句影响了意外数量的行 (0)。自加载实体后，实体可能已被修改或删除。刷新 ObjectStateManager 条目。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-09T21:46:40.287

尝试将新设置为先`OrderDetail`进入状态，然后再将其设置为：`Added``Order``Modified`

```
var newOrderDetail = order.OrderDetails.First();
context.Entry(newOrderDetail).State = EntityState.Added;
context.Entry(order).State = EntityState.Modified; 
```

这可能有效 - 或无效，取决于您的模型和场景的详细信息......

# ruby-on-rails - 如何对新对象的派生值运行验证？

> ID：14243377
> 
> 赞同：1
> 
> 时间：2013-01-09T17:52:03.093
> 
> 标签：ruby-on-rails, validation, ruby-on-rails-3.2

我有一个模型，该模型具有在创建时提供的多个属性。该模型还具有一些从提供的属性派生的附加属性，我也想在创建时计算这些属性。更有问题的是，我希望能够对这些派生值运行验证（因为有些输入本身是有效的，会导致派生值无效）。

问题是当我这样做时：

```
class MyClass < ActiveRecord::Base
  attr_accessible :given1, :given2, :derived

  before_validation :derivation
  validates_uniqueness_of :derived

  def derivation
    self.derived = self.given1 + self.given2
  end
end

MyClass.new(:given1 => aNumber, :given2 => otherNumber) 
```

我总是收到错误说我无法添加`nil`到`nil`. 显然`self.attribute`是零，直到进一步进入验证和创建过程。

显然，我可以在稍后阶段设置我的派生值，并添加一个适用于给定属性的自定义验证，但这需要进行两次派生，这不会很干燥。

是否有其他方法可以在阶段中获得已分配但尚未验证的属性`before_validates`？

编辑：为了澄清，我想在验证检查*之前*`MyClass.new(:given1 => aNumber, :given2 => otherNumber)`调用并计算派生值，以便验证检查就像我调用了. 问题是我似乎无法访问方法和方法中的传入值。*`MyClass.new(:given1 => aNumber, :given2 => otherNumber, :derived => aNumber + otherNumber)``:given1``:given2``before_validations`*

 ** * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-09T22:00:02.757

我编写了自己的代码片段，如下所示：

```
class User < ActiveRecord::Base
  attr_accessible :email, :first_name, :last_name

  validates :email, uniqueness: true

  before_validation :derivation

  def derivation
    self.email = self.first_name + self.last_name
  end
end 
```

运行以下没有产生错误：

```
»  u = User.new first_name: "leo", last_name: "correa"
=> #<User:0x007ff62dd8ace0> {
                      :id => nil,
              :first_name => "leo",
               :last_name => "correa",
                   :email => nil,
              :created_at => nil,
              :updated_at => nil,
}
»  u.valid?
  User Exists (0.9ms)  SELECT 1 AS one FROM "users" WHERE "users"."email" = 'leocorrea' LIMIT 1
=> true 
```

运行`u.save`成功保存了记录，并在重复`User.new`并保存新记录时返回，`ROLLBACK`因为电子邮件已被使用。

在任何情况下，请确保将您正在使用的任何变量分配给 given1、given2 以及任何结果都确保不会给您错误，因为它会取消 before_validate 回调并且不会保存记录。*

# php - 如何在 CakePHP 2.2.4 中使用 find() 计算结果？

> ID：14243379
> 
> 赞同：0
> 
> 时间：2013-01-09T17:52:10.157
> 
> 标签：php, cakephp, cakephp-2.0

我正在使用**Cakephp 2.2.4**，我需要检索属于用户的 Lead 列表（**id = 106**）。

查询的结果是：

```
array(
    (int) 0 => array(
        'Lead' => array(
            'id' => '6',
            'user_id' => '106',
            'date' => '2012-12-31 22:15:23',
            'ip' => '127.0.0.1',
            'service_id' => '1',
            'location' => 'Rome',
            'message' => 'Message Message',
            'telephone' => null,
            'active' => null
        ),
        'User' => array(
            'id' => '106',
            'email' => 'daje@daje.it',
            'pwd' => '0433c024cb08be13000d59a347e640482843f46f177e95749dc6599c259617fd3491dcb940b47693cbbc7f65a2cc5ef62deca2e600c1be133ad54170f7d1fbd1',
            'role_id' => '3',
            'active' => '1'
        ),
        'Service' => array(
            'id' => '1',
            'name' => 'Primo servizio'
        ),
        'Estimate' => array(
            (int) 0 => array(
                'id' => '1',
                'lead_id' => '6',
                'user_id' => '106'
            )
        )
    )
) 
```

它看起来不错，但我需要计算估计值（估计数组），我想检索估计值的数量，而不是包含所有字段的数组（估计值表）。

我该怎么做？

我需要 ：

**如图所示的引线**阵列

**如图所示的用户**数组

**如图所示的服务**数组

**估计**（仅估计的总数......在这种情况下`1`）

查找非常简单：

```
$options = array('conditions' => array('User.id' => 106));

debug($this->Lead->find('all', $options)); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-09T17:55:14.207

尝试这样的事情，不是 100% 确定它会起作用，但如果不是，我建议您搜索 cakephp 文档以检索您的数据：

```
$options = array(
    'fields' => array('Lead.*', 'User.*', 'Service.*', 'count(Estimate.id)'),
    'conditions' => array('User.id' => 106)
); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-09T18:00:00.173

如果不深入到 Cake ORM 的内部，假设您不需要在查询时立即执行此操作，那么您不能在获取`count`后以编程方式获取估计数组的值吗？

[http://php.net/manual/en/function.count.php](http://php.net/manual/en/function.count.php)

```
$leads = $this->Lead->find('all',$options);
foreach($leads as $lead){
  //get the number of estimates for every lead result
  $lead_num = count($lead['Estimate']);
} 
```

或者，您可以手动为此获取编写一个连接查询，并使用 Cake Model 类的`query`方法执行它。在不知道您的表模式和模型关系的细节的情况下，很难给出关于如何构造查询的细节，但这应该不会太难，只需查看您的表规范并为每个具有给定 ID的每个提取一个 sql`COUNT`语句。`Estimate`

# git - 如何配置“git log”以显示“提交日期”

> ID：14243380
> 
> 赞同：164
> 
> 时间：2013-01-09T17:52:10.563
> 
> 标签：git, git-log

如何配置`git log`为显示`commit date`而不是`author date`？

* * *

## 回答 #1

> 赞同：182
> 
> 时间：2013-01-09T18:59:00.960

有几个选项可以[漂亮地打印](https://git-scm.com/docs/pretty-formats)日期。可能最简单的方法是使用其中一种预烘焙`--pretty`格式，例如`git log --pretty=fuller`- 这将显示两个日期。如果您只想查看一个日期，但将其设为提交日期，您可以使用`git log --format=<some stuff>`. 定义格式的所有[允许代码](https://www.kernel.org/pub/software/scm/git/docs/git-log.html#_pretty_formats)`git help log`都记录在. 提交日期是`%cd`、`%cD`、或中的一种`%cr`，具体取决于您喜欢的格式。`%ct``%ci`

如果这是您想要经常做的事情，请将其放在别名中或编写辅助脚本以节省打字时间。

* * *

## 回答 #2

> 赞同：85
> 
> 时间：2014-01-29T22:29:49.217

您可以使用`--pretty=format`和使用`%cr`提交日期相对。

例如：

```
$ git log --graph --pretty=format:'%C(auto)%h%d (%cr) %cn <%ce> %s' 
```

您可以在 git 中定义一个别名以使其更易于使用。我有以下内容`.gitconfig`：

```
[alias]
# see `git help log` for detailed help.
#   %h: abbreviated commit hash
#   %d: ref names, like the --decorate option of git-log(1)
#   %cn: commiter name
#   %ce: committer email
#   %cr: committer date, relative
#   %ci: committer date, ISO 8601-like format
#   %an: author name
#   %ae: author email
#   %ar: author date, relative
#   %ai: author date, ISO 8601-like format
#   %s: subject
# my awesome git log replacement
lol  = log --graph --pretty=format:\"%C(auto)%h%d%Creset %C(cyan)(%cr)%Creset %C(green)%cn <%ce>%Creset %s\"
# same as above, but ISO date
lold = log --graph --pretty=format:\"%C(auto)%h%d%Creset %C(cyan)(%ci)%Creset %C(green)%cn <%ce>%Creset %s\"
# using build-in standards
lol2 = log --oneline --graph --decorate
# shows branches and their last commits
lol3 = log --all --graph --decorate --oneline --simplify-by-decoration 
```

在 Linux 或类似系统上，您可以使用单引号`'`而不是双引号`"`：

```
[alias]
lol = log --graph --pretty=format:'%C(auto)%h%d%Creset %C(cyan)(%cr)%Creset %C(green)%cn <%ce>%Creset %s' 
```

有了这个，只需运行`git lol`或其他变体即可查看漂亮的输出。

这是输出`git lol --simplify-by-decoration`：

[![git 大声笑输出](../Images/e620859624a9f4a2a64c0ab8f7ff6e15.png)](https://i.stack.imgur.com/qEzNy.png)

*   这看起来不错的样子。:)
*   `lol`比 更容易打字`log`，而且听起来也更好。
    *   `git log`如果您需要，还可以让您访问常规。
*   您的眼睛可以通过不同的颜色快速扫描内容。
*   姓名和电子邮件对于有许多贡献者的大型项目/组织非常有用。
*   对 hash/ref 使用默认着色，因为它已经很不错了。

这是`git lold`ISO 格式的日期输出。有助于查看提交的确切日期/时间，并且能够轻松查看贡献者的时区。

[![在此处输入图像描述](../Images/1defcbbc3315fa69b8b6316e8e9ac4c8.png)](https://i.stack.imgur.com/jfg0D.png)

**编辑 2020-06**：添加了屏幕截图。更新为对（提交哈希）和（参考名称）使用`%C(auto)`（自动/默认着色）。除了电子邮件之外，还添加了（提交者姓名）。`%h``%d``%cn`

* * *

## 回答 #3

> 赞同：15
> 
> 时间：2020-01-04T16:49:07.833

我更喜欢这种格式，不包括作者姓名，包括实际提交日期。

```
git log --graph --pretty=format:"%C(yellow)%h%x09%Creset%C(cyan)%C(bold)%ad%Creset  %C(green)%Creset %s" --date=short 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2021-03-10T08:27:55.027

可能对某人有用。我正在寻找带有**作者**姓名的**日期和**时间戳。

 **[![在此处输入图像描述](../Images/37ae3399357dafd849db976703c627b9.png)](https://i.stack.imgur.com/byhCc.jpg)

```
git log --graph --pretty=format:"%C(yellow)%h%x09%Creset%C(cyan)%C(bold)%ad%Creset %C(yellow)%cn%Creset  %C(green)%Creset %s" --date=default 
```**

# java - 如何向运行 solr 的 Jetty 网络服务器添加自定义身份验证

> ID：14243384
> 
> 赞同：2
> 
> 时间：2013-01-09T17:52:32.113
> 
> 标签：java, authentication, solr, jetty, user-management

我有一个 Solr 服务器在码头上作为 web 应用程序运行。我现在想向码头添加一个自定义身份验证程序，以广告/删除可以访问 solr 搜索的用户。

用户发送一个令牌，该令牌需要由 3\. 方服务器验证，然后才允许用户访问 solr 服务器。

如何拦截从码头内部对 solr 服务器的请求并为经过身份验证的用户进行某种会话管理？

有人为 tomcat 发布了一个类似的问题：[implementing-custom-authentication-with-tomcat](https://stackoverflow.com/questions/4832992/implementing-custom-authentication-with-tomcat)的答案是使用过滤器。有一些可用于码头的过滤器类，但它们与 tomcat 相似吗？我将如何部署自己的过滤器类？

是否有针对此类问题的教程？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-21T00:28:36.473

好吧，似乎没有人回答，所以我将开始逐步回答我自己的问题。

过滤器是解决我的问题的正确方法。它们不是特定于 tomcat 或 jetty 的东西，而是由 Java Servlet 规范 2.3 版标准化。因此，tomcat 或 jetty 或任何其他实现 Java Servlet 规范的网络服务器都应该运行过滤器。

作为过滤器用例的示例，[这篇 oracle/java 文章列出了](http://www.oracle.com/technetwork/java/filters-137243.html)：“基于用户身份的身份验证阻止请求”。

这正是我想要做的。我将尝试使用过滤器并根据我的进度更新此答案，直到我发现问题已得到充分回答。

**第 1 步，过滤器开发的准备工作**
在开始编写自己的过滤器之前，您必须为 JavaEE 开发设置 IDE 或为构建工具编写所需的构建文件。有很多教程已经解释了这一点。例如： [Eclipse + Tomcat](http://theopentutorials.com/examples/java-ee/servlet/how-to-create-a-servlet-with-eclipse-and-tomcat/) [Maven + 码头](http://wiki.eclipse.org/Jetty/Tutorial/Jetty_and_Maven_HelloWorld#Developing_a_Standard_WebApp_with_Jetty_and_Maven)

**第二步，编写最简单的hello world过滤器**

```
package hello.world.filter;

import java.io.IOException;
import java.io.PrintWriter;

import javax.servlet.Filter;
import javax.servlet.FilterChain;
import javax.servlet.FilterConfig;
import javax.servlet.ServletException;
import javax.servlet.ServletRequest;
import javax.servlet.ServletResponse;

public class HelloWorldFilter implements Filter {

    public void init(FilterConfig fConfig) throws ServletException {
    }

    public void doFilter(ServletRequest request, ServletResponse response, FilterChain chain) throws IOException, ServletException {        
        PrintWriter out = response.getWriter();
        out.print("hello World");
    }

    public void destroy() {
    }

} 
```

**第 3 步，在正在运行的 solr 服务器上部署您的过滤器**
现在这一步并不像您想象的那么简单。我想我可以将我的身份验证过滤器打包到一个war文件中，然后将它用于我在任何servlet服务器上运行的任何应用程序。可悲的是，它似乎不像那样工作。每个 webapp 都在自己的上下文中部署在您的服务器上，无法访问其他 webapps 的上下文（据我所知，至少在码头上）。例如，Solr 本身就是一个 webapp，并且具有 context `http://localhost:8983/solr/`。即使您将在上下文中部署 webapp，`http://localhost:8983/*`或者`http://localhost:8983/solr/*`这根本不会影响 solr，每个人仍然可以访问您的 solr 服务器。

解决方案是将您的过滤器集成到 solr webapp 中。为此，您必须首先将 HelloWorldFilter.class 打包到 jar 文件中。然后进入你的 solr 服务器所在的目录，解压 solr.war 文件。（在您的标准安装中，这通常是*solr-4.1.0/example/webapps*）。现在您必须更改 solr webapp 的上下文文件，因为它不再打包在 solr.war 中，而是包含一个目录。到*solr-4.1.0/example/contexts*并打开 solr.xml。将行更改`<Set name="war"><SystemProperty name="jetty.home"/>/webapps/solr.war</Set>`为`<Set name="war"><SystemProperty name="jetty.home"/>/webapps/solr</Set>`. 现在您可以实际部署您的过滤器：将您的 jar 文件复制到文件夹*solr-4.1.0/example/webapps/solr/WEB-INF/lib*. 作为最后一步，我们必须让 solr 知道应该在 solr 启动时部署我们的过滤器。为此，请打开*solr-4.1.0/example/webapps/solr/WEB-INF/web.xml*并添加以下行：

```
 <filter>
    <filter-name>HelloWorldFilter</filter-name>
    <filter-class>hello.world.filter.HelloWorldFilter</filter-class>
  </filter> 
```

行前

```
<filter>
    <filter-name>SolrRequestFilter</filter-name>
    ... 
```

还有广告：

```
<filter-mapping>
  <filter-name>HelloWorldFilter</filter-name>
    <url-pattern>/*</url-pattern>
  </filter-mapping> 
```

在文件中的任何其他过滤器映射之前。

确保一切安全并重新启动您的 solr 服务器。现在，您应该在`http://localhost:8983/solr/`.

现在您可以开始更换

```
PrintWriter out = response.getWriter();
out.print("hello World"); 
```

在*doFilter*方法中使用您自己的自定义身份验证。

# sql - 对于 select 中的每一行，将多行插入到一个表中

> ID：14243386
> 
> 赞同：5
> 
> 时间：2013-01-09T17:52:34.687
> 
> 标签：sql, sql-server, select, insert

我想做这样的事情

```
SELECT ID, X, Y, Z FROM TABLE_1 
```

这给我带来了类似的东西：

```
| IDTABLE_1 |  X  |  Y  |  Z  |
| 1         |  a  |  b  |  c  |
| 2         |  d  |  e  |  f  |
| 3         |  g  |  h  |  i  | 
```

我还有另一个表 TABLE_2，其中有一列包含上一个表（TABLE_1）中的列名：

```
| IDTABLE_2 | COLUMN | 
| 101       | X      | 
| 102       | Y      |
| 103       | Z      | 
```

现在我需要将选择中的所有数据插入到这个新表 TABLE_3 中，它必须是这样的：

```
| IDTABLE_3 | IDTABLE_1 | IDTABLE_2   | VALUE |
| 201       | 1         | 101         | a     |
| 202       | 1         | 102         | b     |
| 203       | 1         | 103         | c     |
| 204       | 2         | 101         | d     |
| 205       | 2         | 102         | e     |
| 206       | 2         | 103         | f     |
| 207       | 3         | 101         | g     |
| 208       | 3         | 102         | h     |
| 209       | 3         | 103         | i     | 
```

关于简单方法的任何建议？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-09T18:01:40.057

```
SELECT
   IDENTITY(int, 200, 1) IDTABLE_3,
   T1.IDTABLE_1,
   T2.IDTABLE_2,
   CASE T2.COLUMN WHEN 'X' THEN T1.X
                  WHEN 'Y' THEN T1.Y
                  WHEN 'Z' THEN T1.Z END VALUE
INTO TABLE_3
FROM TABLE_1 T1
  CROSS JOIN TABLE_2 T2 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-09T18:09:07.263

您可以使用`UNPIVOT`表运算符来执行此操作，如下所示：

```
WITH CTE
AS
(
  SELECT IDTABLE_1, ID, value
  FROM Table_1
  UNPIVOT
  (
    ID
    FOR value   IN(x, y,z)
  ) u
)
SELECT 
  ROW_NUMBER() OVER(ORDER BY t1.ID) + 200 AS IDTABLE_3 ,
  t1.IDTABLE_1,
  t2.[IDTABLE_2],
  t1.ID AS VALUE 
FROM CTE t1
INNER JOIN TABLE_2 t2 ON t1.value = t2."Column"; 
```

## [SQL 小提琴演示](http://www.sqlfiddle.com/#!3/f2bb9/16)

这会给你：

```
| IDTABLE_3 | IDTABLE_1 | IDTABLE_2 | VALUE |
---------------------------------------------
|       201 |         1 |       101 |     a |
|       202 |         1 |       102 |     b |
|       203 |         1 |       103 |     c |
|       204 |         2 |       101 |     d |
|       205 |         2 |       102 |     e |
|       206 |         2 |       103 |     f |
|       207 |         3 |       101 |     g |
|       208 |         3 |       102 |     h |
|       209 |         3 |       103 |     i | 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-01-09T18:09:15.890

根据您的 SQL Server 版本，您可以[`UNPIVOT`](http://msdn.microsoft.com/en-us/library/ms177410%28v=sql.105%29.aspx)在第一个表上使用该函数，将 a`row_number()`应用于每个表，然后加入行号。该`UNPIVOT`函数采用列`X`、`Y`和`Z`并将它们转换为行。完成此转换后，您将为每条记录`row_number()`分配一个由`IDTABLE_1`.

```
select row_number() over(order by t1.IDTABLE_1) + 200 AS IDTABLE_3,
  t1.IDTABLE_1, t2.IDTABLE_2, t1.value
from
(
  select IDTABLE_1, value, col,
      row_number() over(partition by IDTABLE_1 order by col) rn
  from table1
  unpivot
  (
    value
    for col in (X, Y, Z)
  ) unpiv
) t1
inner join
(
  select IDTABLE_2, [COLUMN],
    row_number() over(order by IDTABLE_2) rn
  from Table2
) t2
  on t1.rn = t2.rn
order by t1.IDTABLE_1; 
```

请参阅[带有演示的 SQL Fiddle](http://sqlfiddle.com/#!3/49034/43)

结果是：

```
| IDTABLE_3 | IDTABLE_1 | IDTABLE_2 | VALUE |
---------------------------------------------
|       201 |         1 |       101 |     a |
|       202 |         1 |       102 |     b |
|       203 |         1 |       103 |     c |
|       204 |         2 |       101 |     d |
|       205 |         2 |       102 |     e |
|       206 |         2 |       103 |     f |
|       207 |         3 |       101 |     g |
|       208 |         3 |       102 |     h |
|       209 |         3 |       103 |     i | 
```

# grails - Grails：处理 HTTP 会话超时事件

> ID：14243389
> 
> 赞同：1
> 
> 时间：2013-01-09T17:52:44.210
> 
> 标签：grails, session-timeout, http-status-code-401, url-mapping

我正在编写使用 Sprint Security 进行身份验证的 Grails 应用程序。我需要向由于不活动而自动注销的用户显示一条消息。

我的应用程序同时使用 AJAX 请求和对控制器的直接请求。我注意到，对于 AJAX 请求，Sprint Security 返回带有代码 401 的 HTTP 响应，并且我以这种方式重新定义了默认 URL 映射：

```
class UrlMappings {
    static mappings = {
         // ...

         "401" (controller: 'errors', action: 'inactivityLogout')
    }
} 
```

这是`inacticityLogout()`方法的主体：

```
def inactivityLogout() {
    log.debug("the user is logged out due to inactivity")
    session.setAttribute('inactivityMessage', "You have been logged out due to inactivity.")
    render(status: 401)
} 
```

然后`LoginController`检查是否`inactivityMessage`设置了属性，并在登录页面上显示相应的消息。

问题是这个解决方案适用于 AJAX 调用，但是当我试图通过单击应用程序中的直接链接导航到另一个页面时不起作用。在第二种情况下，日志为空，因此`inactivityLogout`不调用该方法。

Firebug 显示应用程序返回代码 302 已临时移动，所以我认为这是一个原因。但后来我注意到 AJAX 调用也返回了相同的代码。所以，现在我不知道 AJAX 和非 AJAX 请求之间有什么区别，以及为什么 Grails URL 映射引擎不处理最后一个请求。

任何想法，我目前的解决方案可能有什么问题？这个问题可以用完全不同的方式解决吗？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-09T19:01:05.520

使用 jQuery，这就是我所做的：

```
$.ajaxSetup({
   statusCode: {
     401: function () {
       $('#ajaxAuthModal').modal('show');
     }
   }
}); 
```

我在一个全局 JS 文件中有它，这样我的所有 ajax 请求都可以处理 401。然后我只显示一个模式，告诉用户他们需要再次登录。实现所需的唯一真正区别是通过 ajax 轮询安全资源。这将允许 401 函数在返回 401 时触发。

大多数 JavaScript 库（如 jQuery）应该具有与`$.ajaxSetup()`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-10T04:55:29.740

> 是的，这个想法是在没有任何用户交互的情况下显示消息。只是想让用户知道他为什么退出系统。

所以基本上一旦用户加载了页面，就没有与服务器的联系。服务器无法将消息“推送”到浏览器。因此，您需要做的是检查是否存在与 JavaScript 的活动会话。你可以很容易地用计时器来做到这一点。

在您的 main.gsp 中将 javascript 变量设置为`${session.maxInactiveInterval}`. 这将为您提供用户会话的最大长度。只需启动一个`setTimeout( function() { /* code to display to the user here */ }, maxInterval)`.

记住要重置 AJAX 调用的时间间隔，因为由于页面没有被重新加载，它不会被重置。

附带说明一下，URL 映射应该只在非 AJAX 请求上发挥作用，因为页面没有被重新加载，因此没有任何东西可以显示页面。您将不得不使用 @Gregg 之类的东西来处理 AJAX 请求。

# restructuredtext - 我可以在 reStructuredText 中使用编号链接吗？

> ID：14243390
> 
> 赞同：4
> 
> 时间：2013-01-09T17:52:45.530
> 
> 标签：restructuredtext

reStructuredText 可以做以下 Markdown 所做的事情：

```
Here is some [text][1] with [links][2].

[1]: http://example.com/
[2]: http://example.org/ 
```

即将超链接文本显式绑定到具有自定义标签的目标（在这种情况下为数字）？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-04-06T11:27:20.757

看看我是怎么做的：

```
.. _`docutils`: http://docutils.sourceforge.net/

`docutils`_ is best extensible plain text markup in the world! 
```

对于就地链接：

```
`Installation instructions <INSTALL.html>`_ 
```

对于脚注：

```
See [RFC822]_ for mail format.

.. [RFC822] http://www.ietf.org/rfc/rfc0822.txt 
```

**更新**。对于谁拒绝直接回答问题（这表明 Markdown 的能力不如 ReST）：

```
.. _RFC822: http://www.ietf.org/rfc/rfc0822.txt

.. _alias:  RFC822_

Please read `RFC822`_.

Please read `alias`_.

Please read `RFC 822 <RFC822_>`_.

Please read `RFC 822 <alias_>`_. 
```

享受！

# git - git的合并策略是什么？

> ID：14243397
> 
> 赞同：55
> 
> 时间：2013-01-09T17:53:01.483
> 
> 标签：git

> **可能重复：**
> [你什么时候使用不同的 git 合并策略？](https://stackoverflow.com/questions/366860/when-would-you-use-the-different-git-merge-strategies)

当 git 合并我正在处理的文件时，我看到：

```
Merge made by the 'recursive' strategy 
```

递归策略到底是什么？还有哪些其他策略（如果有）？使用其中一个有什么好处？不同的策略有不同的表现吗？或者两种不同的策略会导致不同的合并结果？

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2013-01-09T17:55:12.690

来自`git help merge`：

```
 The merge mechanism (git-merge and git-pull commands) allows the
   backend merge strategies to be chosen with -s option. Some strategies
   can also take their own options, which can be passed by giving
   -X<option> arguments to git-merge and/or git-pull.

   resolve
       This can only resolve two heads (i.e. the current branch and
       another branch you pulled from) using a 3-way merge algorithm. It
       tries to carefully detect criss-cross merge ambiguities and is
       considered generally safe and fast.

   recursive
       This can only resolve two heads using a 3-way merge algorithm. When
       there is more than one common ancestor that can be used for 3-way
       merge, it creates a merged tree of the common ancestors and uses
       that as the reference tree for the 3-way merge. This has been
       reported to result in fewer merge conflicts without causing
       mis-merges by tests done on actual merge commits taken from Linux
       2.6 kernel development history. Additionally this can detect and
       handle merges involving renames. This is the default merge strategy
       when pulling or merging one branch.

       The recursive strategy can take the following options:

       ours
           This option forces conflicting hunks to be auto-resolved
           cleanly by favoring our version. Changes from the other tree
           that do not conflict with our side are reflected to the merge
           result.

           This should not be confused with the ours merge strategy, which
           does not even look at what the other tree contains at all. It
           discards everything the other tree did, declaring our history
           contains all that happened in it.

       theirs
           This is opposite of ours.

       subtree[=path]
           This option is a more advanced form of subtree strategy, where
           the strategy makes a guess on how two trees must be shifted to
           match with each other when merging. Instead, the specified path
           is prefixed (or stripped from the beginning) to make the shape
           of two trees to match.

   octopus
       This resolves cases with more than two heads, but refuses to do a
       complex merge that needs manual resolution. It is primarily meant
       to be used for bundling topic branch heads together. This is the
       default merge strategy when pulling or merging more than one
       branch.

   ours
       This resolves any number of heads, but the resulting tree of the
       merge is always that of the current branch head, effectively
       ignoring all changes from all other branches. It is meant to be
       used to supersede old development history of side branches. Note
       that this is different from the -Xours option to the recursive
       merge strategy.

   subtree
       This is a modified recursive strategy. When merging trees A and B,
       if B corresponds to a subtree of A, B is first adjusted to match
       the tree structure of A, instead of reading the trees at the same
       level. This adjustment is also done to the common ancestor tree. 
```

# java - JTree 不显示添加的节点

> ID：14243398
> 
> 赞同：1
> 
> 时间：2013-01-09T17:53:02.853
> 
> 标签：java, swing, jtree, treenode

我正在尝试创建我的第一个`JTree`，但是当我尝试将节点添加到树时，更改没有生效，并且显示的只是一棵树，其中包含一些默认节点（颜色、运动、食物）。

树所在的主面板代码：

```
import javax.swing.JFrame;
import javax.swing.JPanel;
import javax.swing.UIManager;
public class Scenario1Panel extends JPanel
{

/**
 * 
 */
private static final long serialVersionUID = 1L;

public Scenario1Tree scenario1Tree;

public Scenario1Panel()
{
    scenario1Tree = new Scenario1Tree();
    add(scenario1Tree);
}
public static void main(String args[]) 
{
    try
    {
        String lookAndFeel = UIManager.getSystemLookAndFeelClassName();
        System.out.println(lookAndFeel);
        UIManager.setLookAndFeel(lookAndFeel);
    }
    catch(Exception e)
    {
        System.out.println("couldn't get that LookAndFeel");
    }

    Scenario1Panel mgr = new Scenario1Panel();

    JFrame frame = new JFrame();

    frame.add(mgr);
    frame.pack();
    frame.setVisible(true);

} 
```

}

我的树代码是：

```
import javax.swing.JScrollPane;
import javax.swing.JTree;
import javax.swing.UIManager;
import javax.swing.tree.DefaultMutableTreeNode;
import javax.swing.tree.TreeSelectionModel;
public class Scenario1Tree extends JTree
{
/**
 * 
 */
private static final long serialVersionUID = 1L;

private JTree tree;

public Scenario1Tree()
{
    DefaultMutableTreeNode top = new DefaultMutableTreeNode("Scenario1");
    createNodes(top);
    tree = new JTree(top);

    //Create a tree that allows one selection at a time.
    tree.getSelectionModel().setSelectionMode
        (TreeSelectionModel.SINGLE_TREE_SELECTION);

    //Create the scroll pane and add the tree to it. 
    JScrollPane treeView = new JScrollPane(tree);

}

private void createNodes(DefaultMutableTreeNode top) {
    DefaultMutableTreeNode loginUser1 = null;
    DefaultMutableTreeNode addNewUsers = null;
    DefaultMutableTreeNode addNewUsersBreakout = null;

    loginUser1 = new DefaultMutableTreeNode("Login User 1");
    top.add(logintUser1);

    addNewUsers = new DefaultMutableTreeNode("Add New Users");
    top.add(addNewUsers);

    addNewUsersBreakout = new DefaultMutableTreeNode("Add User2");
    addNewUsers.add(addNewUsersBreakout );
    addNewUsersBreakout = new DefaultMutableTreeNode("Add User3");
    addNewUsers.add(addNewUsersBreakout );
    addNewUsersBreakout = new DefaultMutableTreeNode("Add User4");
    addNewUsers.add(addNewUsersBreakout );
    addNewUsersBreakout = new DefaultMutableTreeNode("Add User5");
    addNewUsers.add(addNewUsersBreakout );

}

public static void main(String args[]) 
{
    try
    {
        String lookAndFeel = UIManager.getSystemLookAndFeelClassName();
        System.out.println(lookAndFeel);
        UIManager.setLookAndFeel(lookAndFeel);
    }
    catch(Exception e)
    {
        System.out.println("couldn't get that LookAndFeel");
    }

    Scenario1Tree tree = new Scenario1Tree();

    JFrame frame = new JFrame();

    frame.add(tree);
    frame.pack();
    frame.setVisible(true);

} 
```

}

有人可以解释我做错了什么吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-09T18:05:52.487

您创建的 JTree 太多了。您正在将所有节点添加到 JTree 变量中，但对显示的树使用 JTree 扩展类，后者没有添加任何节点。

我建议你不要让你的类扩展 JTree，而是给它一个方法，比如`getTree()`在需要的时间和地点返回 JTree。

IE，

```
// get rid of extends JTree
public class Scenario1Tree // extends JTree
{
private static final long serialVersionUID = 1L;

private JTree tree;

public Scenario1Tree()
{
    DefaultMutableTreeNode top = new DefaultMutableTreeNode("Scenario1");
    createNodes(top);
    tree = new JTree(top);

    tree.getSelectionModel().setSelectionMode
        (TreeSelectionModel.SINGLE_TREE_SELECTION);

    // JScrollPane treeView = new JScrollPane(tree);

}

public JTree getTree() {
  return tree;
} 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-01-09T18:05:41.963

在`Scenario1Tree`而不是`JTree`实例创建调用中

```
setModel(new DefaultTreeModel(top)); 
```

事实上，您根本不需要该`JTree`实例。

# python - Python 3 详细控制另一个进程的 I/O

> ID：14243401
> 
> 赞同：3
> 
> 时间：2013-01-09T17:53:20.500
> 
> 标签：python, io, subprocess, pipe, python-3.3

在 python 3（在 Linux 或 MacOSX10.8 上）中，我怎样才能让父进程只读取子进程发出的提示（不包括`\n`），而不是整个缓冲区直到`\n`？

```
# program names.py
print("I am Joe.")                   #1print
name = input("What is your name? ")  #2prompt
print("Hi", name, "!")               #3print

# program parent.py (in python 3.3.0)
import subprocess
import sys
p = subprocess.Popen([sys.executable, "names.py"],
                      bufsize=0,
                      stdin =subprocess.PIPE,
                      stdout=subprocess.PIPE,
                      stderr=subprocess.PIPE,
                      shell=False,
                      universal_newlines=True
                    )
print(p.stdout.readline(), end='')
p.stdin.write("Sue\n")
# The next print will produce the output of 2prompt + 3print:
print(p.stdout.readline(), end='') 
```

当我运行`parent.py`它时打印：

```
I am Joe.
What is your name? Hi Sue ! 
```

如何修改`parent.py`以便打印：

```
I am Joe.
What is your name? 
Hi Sue ! 
```

即如何分别提取prompt和print产生的输出？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-09T00:26:46.103

`readline()`从`names.py`直到下一个读取`\n`，您需要的是“阅读尽可能多的内容”。时间是这里的一个额外因素，因为您基本上必须检测何时`names.py`等待（期望输入）。

基本上，您需要一个`read()`带有超时的 - 操作。`names.py`您可以启动一个单独的线程，逐字节读取缓冲区。然后，您可以`join(timeout)`此线程并访问其缓冲区。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-09T17:05:22.323

如果您知道提示的外观，那么您可以按照[@Michael 的建议](https://stackoverflow.com/questions/14243401/python-3-detailed-control-of-i-o-of-another-process#comment22623381_14243401)使用字符串操作来获得所需的输出：

```
import sys
from subprocess import Popen, PIPE

p = Popen([sys.executable, "names.py"], stdin=PIPE, stdout=PIPE,
          universal_newlines=True)
output = p.communicate("Sue\n")[0]
prompt = "name? "
print(output.replace(prompt, prompt + "\n")) 
```

### 输出

```
I am Joe.
What is your name? 
Hi Sue ! 
```

如果您不知道提示的外观，那么如果子进程在非交互式运行时使用块缓冲[，@Exp 建议的基于超时的解决方案可能不起作用。](https://stackoverflow.com/a/15891303/4279)虽然它确实适用于`names.py`. 这是一个基于超时的解决方案，它使用`select`而不是线程来读取输出：

```
import os
import sys
from select import select
from subprocess import Popen, PIPE

timeout = 1 # seconds
with Popen([sys.executable, 'names.py'],
           stdin=PIPE, stdout=PIPE,  bufsize=0) as p:
    while True:
        ready = select([p.stdout], [], [], timeout)[0]
        if ready: # there is something to read
            data = os.read(p.stdout.fileno(), 512)
            if not data: # EOF
                break
            sys.stdout.buffer.write(data) # echo subprocess output
        elif p.poll() is None: # timeout, but subprocess is still running
            print("") # print newline after the prompt
            p.stdin.write(b"Sue\n") # answer the prompt
        else: # subprocess exited
            break 
```

它在延迟后产生与第一个代码示例相同的输出。

通常，`pexpect`可用于模拟子进程的交互模式。

如果您知道提示的样子：

```
import sys
import pexpect

print(pexpect.run(sys.executable + " -mnames", events={r'name\? ': 'Sue\n'}))
# note: it echos our answer too (it can be avoided if necessary) 
```

### 输出

```
I am Joe.
What is your name? Sue
Hi Sue ! 
```

这是一个基于超时的解决方案，可以避免回显答案：

```
import sys
import pexpect # pip install pexpect-u

child = pexpect.spawn(sys.executable + " -mnames", timeout=1)
child.logfile_read = sys.stdout # echo subprocess output
child.expect(pexpect.TIMEOUT)
print("") # print newline after the prompt
child.setecho(False) # don't echo our answer
child.sendline('Sue')
child.expect(pexpect.EOF)
child.close() 
```

要使用 复制它`subprocess`，`pty`可以使用模块：

```
import os
import pty
import sys
from select import select
from subprocess import Popen, STDOUT

timeout = 1 # seconds
master_fd, slave_fd = pty.openpty()
with Popen([sys.executable, 'names.py'],
           stdin=slave_fd, stdout=slave_fd, stderr=STDOUT,
           bufsize=0) as p:
    while True:
        ready = select([master_fd], [], [], timeout)[0]
        if ready: # there is something to read
            data = os.read(master_fd, 512)
            if not data: # EOF
                break
            sys.stdout.buffer.write(data) # echo subprocess output
        elif p.poll() is None: # timeout, but subprocess is still running
            # assume that child process waits for input after printing the prompt
            answer = b"Sue\n"
            os.write(master_fd, answer) # asnwer the prompt
            os.read(master_fd, len(answer)) # don't echo our answer
        else: # subprocess exited
            break
    os.close(slave_fd)
    os.close(master_fd) 
```

# rally - 创建 Rally 应用程序骨架时出错

> ID：14243402
> 
> 赞同：2
> 
> 时间：2013-01-09T17:53:30.993
> 
> 标签：rally

我想创建自定义集会应用程序以从集会中的某些史诗/故事中提取缺陷仪表板。以下是我遵循的步骤： 1\. 安装 ruby​​ 193 2\. 安装 - gem install rake 2.1 下载的入门工具包 3\. 安装 gem install jslint-v8 我收到关于缺少 libv8 的错误我在网上做了一些研究并安装了 python27。但仍然收到类似的错误。并且无法运行 rake new[AppName]

提前感谢您的帮助！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-12T19:01:50.063

如果你有胆量，你也可以试试我的 Node.js 工具来构建应用程序。我将它创建为 Rakefile 用户的无缝升级。当我完成它时，它应该对 Windows 更友好。最终，我希望在构建器中添加一些用于应用程序测试的强大功能。如果您想查看 rally-app-builder 的 GitHub 存储库，请[点击此处](http://goo.gl/A3PKV)。

在当前状态下，它具有与 Rakefile 大部分相同的功能。

# javascript - 需要在联系表单中刷新包含验证码的 div 而无需刷新整个页面

> ID：14243405
> 
> 赞同：1
> 
> 时间：2013-01-09T17:53:33.857
> 
> 标签：javascript, jquery, html

我的联系表单中有一个 div 标签，其中包含验证码项目。如果用户发现图像不可读，我希望刷新此部分。因此，我放置了一个用于启动刷新的图像链接。我希望更新特定的 div 而不是整个页面。我尝试了所有可能的上网方式，但是，它们对某些人不起作用，我宁愿在刷新按钮的底部重新加载整个页面。

我先用这个

```
<div id="captchadiv">
    <img src="http://localhost:8000/verifyimg.php" alt="Image verification" name="vimg" style="margin-left:87px" /><a id="refresh" href="#"><img src="images/refresh.jpg" height="40px" width="40px" alt="Refresh Captcha"/></a>
    <label class="text-form-long" style="margin-left:87px">To submit this form, please
    enter the characters you see in the image:
    <input type="text" size="12" name="imgverify" /></label>
</div><br><br>

<div class="buttons">
    <a href="#" class="button" data-type="reset">Clear Form</a>
    <a href="#" class="button" data-type="submit">Send Message</a>
</div>

<script> 
  $(function() {
     $("#refresh").click(function() {
            $("#captchadiv").load("contact.html");
        return false;
     });
  });
</script> 
```

而这一秒，

```
<div id="captchadiv">
    <img src="http://localhost:8000/verifyimg.php" alt="Image verification" name="vimg" style="margin-left:87px" /><a id="refresh" href="#" onClick="refreshCaptcha"><img src="images/refresh.jpg" height="40px" width="40px" alt="Refresh Captcha"/></a>
    <label class="text-form-long" style="margin-left:87px">To submit this form, please
    enter the characters you see in the image:
    <input type="text" size="12" name="imgverify" /></label>
</div><br><br>

<div class="buttons">
    <a href="#" class="button" data-type="reset">Clear Form</a>
    <a href="#" class="button" data-type="submit">Send Message</a>
</div>

<script>
   function refreshcaptcha() {
       var container = document.getElementById("captchadiv");
       var refreshContent = container.innerHTML;
       container.innerHTML = refreshContent;
   }
</script> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-09T18:03:44.537

您将不得不使用`AJAX`或`websockets`获取异步更新，而无需重新加载页面。

[阅读有关 AJAX 的更多信息](http://www.w3schools.com/ajax/default.asp)

例子：

```
function refreshcaptcha() {
    $.ajax({
    type: "GET",
    url: "your server link to get new image",
    data: "",
    complete: function(data){
        // Read data to get the new image

        // Supposing the data contains your updated captcha content
        var container = document.getElementById("captchadiv");
        var refreshContent = data;
        container.innerHTML = refreshContent;
    }
}); 
```

**更新**

处理@Josso 的评论：

```
<script>
   function refreshcaptcha() {
       var image = document.getElementsByName("vimg")[0];
       image.setAttribute("src", "http://localhost:8000/verifyimg.php?"+(new Date()).getTime());
   }
</script> 
```

# r - 根据 R 中特定列中重复元素的数量对矩阵进行排序

> ID：14243410
> 
> 赞同：-1
> 
> 时间：2013-01-09T17:53:48.547
> 
> 标签：r, sorting

我有一个只有列标签的矩阵，我想按列 A 排序，其中重复元素在非重复之前排名。因此，因为 7 在 A 列中出现了四次，所以被移动到 A 列中 2 的行前面。我希望这是有道理的。

```
 A   B   C
    1   11  14
    2   2   2
    2   5   12
    2   13  2
    3   16  19
    3   10  0
    4   20  17
    5   5   16
    7   14  18
    7   8   10
    7   10  17
    7   7   0 
```

现在，我希望它看起来像下面这样。

```
 A   B   C
    7   14  18
    7   8   10
    7   10  17
    7   7   0
    2   2   2
    2   5   12
    2   13  2
    3   16  19
    3   10  0
    1   11  14
    4   20  17
    5   5   16 
```

非常感谢您的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-09T18:41:03.983

你的问题需要更清楚。值是如何确定`B`的`C`？从描述中，听起来这些应该只是`A`原始数据列中的对应值，但在您的示例中并非如此。

`A`在您进一步澄清之前，这是基础 R 中的一种方法，可根据您的条件对行进行排序。

```
d <- as.matrix(read.table(text="A   B   C
    1   11  14
    2   2   2
    2   5   12
    2   13  2
    3   16  19
    3   10  0
    4   20  17
    5   5   16
    7   14  18
    7   8   10
    7   10  17
    7   7   0", header=TRUE))

counts <- table(d[,'A'])
ranks <- rank(interaction(counts, names(counts), lex.order=TRUE))
d[order(ranks[match(d[,'A'], names(counts))], decreasing=TRUE), ]

#       A  B  C
#  [1,] 7 14 18
#  [2,] 7  8 10
#  [3,] 7 10 17
#  [4,] 7  7  0
#  [5,] 2  2  2
#  [6,] 2  5 12
#  [7,] 2 13  2
#  [8,] 3 16 19
#  [9,] 3 10  0
# [10,] 5  5 16
# [11,] 4 20 17
# [12,] 1 11 14 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-09T18:18:01.567

```
library(plyr)
counts <- count(df, 'A')
df[order(merge(df, counts)$freq, decreasing=TRUE), ] 
```

# sql - 将数据从 Excel 导入/更新到 SQL Server

> ID：14243413
> 
> 赞同：3
> 
> 时间：2013-01-09T17:53:53.257
> 
> 标签：sql, sql-server, excel, sql-server-2012-express

我正在将数据库从 Excel 转换为 MS SQL 服务器，但我基本上一无所知。

Excel 文件的列标题为*GroupID、Name、Members、Remarks*

SQL 表具有相同的字段。

当我更新 SQL 时，一些记录是全新的，因此需要附加，其他记录需要更新一两列，而大多数记录根本不需要。到目前为止，我已经采取了懒惰的方式并截断了文件并将所有内容重新添加，但是**正确的**方法是什么？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-09T17:59:45.083

将文件作为单独的表导入，您可以从那里进行所有更新。根据您的 SQL 服务器版本，您可能能够使用[MERGE](http://www.codeproject.com/Articles/37172/Merge-Statement-in-SQL-Server-2008)语句。敲出插入和更新语句不应该花费太长时间。

类似这样的更新：

```
UPDATE o
SET    name = i.name
FROM   originaltablename o
       INNER JOIN importedexceltablename i
           ON o.GroupID = i.GroupID
WHERE  o.name <> i.name 
```

像这样的插入：

```
INSERT INTO originaltablename
SELECT i.*
FROM   importedexceltablename i
       LEFT JOIN originaltablename o
           ON o.GroupID = i.GroupID
WHERE  o.GroupID IS NULL 
```

不过要小心，这只是一个让您继续前进的示例，因为您没有提供足够的信息来找到正确的解决方案。

# php - PHP 扩展类是否也继承接口？

> ID：14243417
> 
> 赞同：7
> 
> 时间：2013-01-09T17:54:04.203
> 
> 标签：php, oop, inheritance

这更像是一个简化开发的问题，也是一个最佳实践问题。

```
<?php
class FOO implements Iterator
{
    ....
}

class BAR extends FOO
{
    ....
}

class OTHER extends FOO implements Iterator
{
    ....
}
?> 
```

在上面的例子中，BAR 是否也有 Iterator 接口？如果是这样，是否每次都定义接口更好（就像 OTHER 一样），还是将 BAR 定义视为最佳实践？

我已经简化了这个例子，因为我们使用的是 FOO 的抽象类，我们希望确保它具有 Iterator 支持，然后可以在 BAR 类中覆盖它以在元素之间移动。我们希望强制为子类定义一些函数，但希望适当地继承其他方法，并且仍然使用基本的迭代器，而不必在子类上定义接口。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-09T17:55:53.640

子类将继承父类的 Iterator 接口实现，它可以自由覆盖。你不需要明确说`implements Iterator`，但如果你这样做了，那么你必须在子类中实现所有接口的方法。

# django-cms - 如何在带有 zinnia 的 django cms 中使用我的母语

> ID：14243420
> 
> 赞同：1
> 
> 时间：2013-01-09T17:54:17.847
> 
> 标签：django-cms, zinnia

我尝试将 Zinnia 与 Django-CMS 一起使用，但我不知道如何在其中使用我的母语。我知道它已经翻译了，zinnia 的语言环境文件夹中有一个目录。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-10T11:05:36.887

首先，您需要将 LANGUAGE_CODE 设置为您的母语并激活 Django i18n 机制。

然后，如果 Zinnia 有您的语言的翻译，它将被使用。

如果没有，您可以在 Transifex 页面上添加您的翻译，这将包含在下一个版本中。

[https://www.transifex.com/projects/p/django-blog-zinnia/resource/djangopo/](https://www.transifex.com/projects/p/django-blog-zinnia/resource/djangopo/)

# php - 变量不为空，什么时候应该为空？

> ID：14243421
> 
> 赞同：0
> 
> 时间：2013-01-09T17:54:19.657
> 
> 标签：php

```
<?php
$a = $_POST['a'];
$b = $_POST['b'];
$c;

if(is_numeric($a) && is_numeric($b)){
echo "string";
exit();
}

if(!is_numeric($a) && !is_numeric($b)) {
echo "string";
exit();
}

if(isset($a)){
$resultat=$b*2.54;
echo "string " . $c . " string";
exit();
}

if(isset($b)){
$resultat=$a/2.54;
echo "string " . $c . " string";
exit();
}
?> 
```

我首先检查表单字段 1 和 2 是否保存数字值，然后检查两者是否都保存值。这很好用，但是当我进入第二部分时，它永远不会超过第一个“if”，它总是看到“a$”为集合......

我必须用例吗？或者 ？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-09T18:43:19.270

变量 $a 的值是 $_POST['a']，当这个值为空时 PHP 会抛出一个通知错误，所以你需要做的第一件事就是使用 isset。

```
$a = isset($_POST['a']) ? $_POST['a'] : null //Set $a to $_POST['a'] when NOT empty 
```

PHP 中的 isset 函数仅在变量未设置时才返回 true，即使值为 null。

第二件事是检查值是否为空，最好的办法是使用松散比较：

```
if ($a == null) {
    echo 'A is emty..';
} 
```

这样，值：“”、0、null 和 false 将被视为“空”。

如果您想知道该值是否实际上为 null 是使用三元组“=”的严格比较：

```
if ($a === null) {
    echo 'A is empty';
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-09T18:05:02.627

当您检查时，您期望一个空字符串`if(isset($a))`。问题是您正在检查它是否已设置，而不是它是否为空。当您实例化它时，该变量在您的第一行中设置。该表单将一个空字符串传递给 $_POST，因此您应该检查 $a 是否不是空字符串。

```
if ($a !== '') {
    $resultat=$b*2.54;
    echo "string " . $c . " string";
    exit();
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-09T18:30:45.403

好吧，从技术上讲，$a 将始终被设置，因为它被设置为 $_POST['a']。所以每次都会“设置”，即使 $_POST['a'] 是空的。尝试使用这个：

```
if (!empty($a)) 
```

这将检查 $a 是否不为空。

# c# - 有没有在 StructureMap 中两次注册同一个对象的好方法？

> ID：14243425
> 
> 赞同：1
> 
> 时间：2013-01-09T17:54:24.810
> 
> 标签：c#, structuremap

我在使用 StructureMap 的 .NET 应用程序中包含了一些功能切换。我想注册功能切换有两个目的。

*   在诊断页面上显示**所有** 的当前状态。`IFeatures`
*   在依赖给定`IFeature`实现的服务的构造函数中使用某些实例

这是我的设置。我想知道的是，我这样做对吗？有没有更好的方法可以做到这一点？

```
class HotNewFeature : IFeature { ... }

class ServiceThatUsesFeature 
{
    public ServiceThatUsesFeature(HotNewFeature hotNewFeature) { ... }
}

// Type registry setup
For<HotNewFeature>().Singleton().Use<HotNewFeature>();
For<IFeature>().Singleton().Add(c => c.GetInstance<HotNewFeature>);
For<ServiceThatUsesFeature>().Singleton().Use<ServiceThatUsesFeature>());

// Get all instances on the diagnostics page:
IEnumerable<IFeature> features = ServiceLocator.Current.GetAllInstances<IFeature>(); 
```

我希望在诊断页面上，`features`在这种情况下会包含一个`IEnumerable`带有单个元素的实例，即`HotNewFeature`.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-10T18:14:47.773

使用该`Scan`功能注册所有实现 IFeature 的类型。这将满足您的第一个需求，即在“诊断”页面上显示列表。

如果一个服务需要一个特定的实现，它应该在构造函数中声明它需要的特定类型（`HotNewFeature`）而不是接口（`IFeature`）。你在你的例子中正确地做到了这一点。此时，您无需在 StructureMap 中执行任何其他操作。如果您`ServiceThatUsersFeature`从 StructureMap 请求，并且它依赖于具体类 ( `HotNewFeature`)，则 StructureMap 将知道如何实例化该具体类。

# android - 从 API 级别 11 开始，通过 adb shell 设置剪贴板文本

> ID：14243427
> 
> 赞同：17
> 
> 时间：2013-01-09T17:54:34.647
> 
> 标签：android, api, adb, clipboard

在 API 级别 11 之前，可以使用以下`service`程序设置剪贴板的内容`adb shell`：

```
service call SERVICE CODE [i32 INT | s16 STR] ...
Options:
    i32: Write the integer INT into the send parcel.
    s16: Write the UTF-16 string STR into the send parcel. 
```

有三个整数代码来定义这些方法：

```
1 TRANSACTION_getClipboardText
2 TRANSACTION_setClipboardText
3 TRANSACTION_hasClipboardText 
```

例如这个命令

```
$ adb shell service call clipboard 2 i32 1 i32 1 s16 "Hello Android!" 
```

将剪贴板的内容设置为`"Hello Android!"`. [从 API 级别 11 开始，不推荐使用](http://developer.android.com/reference/android/content/ClipboardManager.html)列出的方法，新的方法将[ClipData](http://developer.android.com/reference/android/content/ClipData.html)作为参数。您现在如何通过 设置剪贴板内容`adb shell`？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-09-03T00:52:49.893

你在这里问了两个不同的问题。服务调用与 API 函数无关。

Android 在将 API 标记为已弃用方面通常过于激进。在这种情况下，它只意味着有更多功能的新功能。、 和的功能仍然存在`getText()`，并且这些功能将继续工作，但它们现在被实现为新功能的简单包装器。`hasText()``setText()`

就服务调用而言，这些是内部实现细节，正如您所注意到的，不能保证跨 Android 版本工作。如果您查看 Android[源代码](http://grepcode.com/file/repository.grepcode.com/java/ext/com.google.android/android/4.1.2_r1/android/content/IClipboard.java/)，您会发现当前定义了这些事务：

```
TRANSACTION_setPrimaryClip = 1
TRANSACTION_getPrimaryClip = 2
TRANSACTION_getPrimaryClipDescription = 3
TRANSACTION_hasPrimaryClip = 4
TRANSACTION_addPrimaryClipChangedListener = 5
TRANSACTION_removePrimaryClipChangedListener = 6
TRANSACTION_hasClipboardText = 7 
```

源代码还指出了这些事务需要哪些参数。不幸的是，TRANSACTION_setPrimaryClip 需要一个`ClipData`，它不是 i32 或 s16，因此与`service call`. 然而，我们还有比这更大的问题；这些事务需要调用包名称作为参数，并且剪贴板服务验证指定的包名称是否与调用 uid 匹配。使用 adb shell 时，调用的 uid 是 UID_ROOT 或 UID_SHELL，两者都不拥有任何包，因此无法通过该检查。简单地说，新的剪贴板服务不能这样使用。

对于这一切，你能做些什么？您可以创建自己的服务来从命令行操作剪贴板并将其安装到您的设备上。我不知道是否有任何方法可以扩展`service call`，但您可以`am startservice`用作合适的替代品。如果您已经创建并安装了该自定义剪贴板服务，那么您可以调用它：

```
am startservice -a MySetClipboard -e text "clipboard text" 
```

实现此服务的代码可能如下所示：

```
public MyService extends Service {
    public int onStartCommand(Intent intent, int flags, int startId) {
        String text = intent.getStringExtra("text");
        ClipboardManager.setText(text);
        stopSelf();
        return START_NOT_STICKY;
    }
} 
```

服务应该有一个意图过滤器，声明它能够处理`MySetClipboard`意图操作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2021-06-30T23:57:36.077

我找到了一种使用[com.tengu.sharetoclipboard](https://f-droid.org/en/packages/com.tengu.sharetoclipboard/)的方法。您使用 F-Droid 安装它，然后使用以下参数`am`重新启动它：`adb`

```
adb shell am start-activity \
        -a android.intent.action.SEND \
        -e android.intent.extra.TEXT <sh-escaped-text> \
        -t 'text/plain' \
        com.tengu.sharetoclipboard 
```

`<sh-escaped-text>`是android剪贴板的新内容。请注意，此文本必须进行转义，以免`sh`在远程端对其进行特殊解释。实际上，这意味着用单引号将其括起来，并将所有单引号替换为`'\''`. 例如，如果本地 shell 是鱼，这将正常工作：

```
adb shell am start-activity \
        -a android.intent.action.SEND \
        -e android.intent.extra.TEXT '\'I\'\\\'\'m pretty sure $HOME is set.\'' \
        -t 'text/plain' \
        com.tengu.sharetoclipboard 
```

fish 解析后，参数为`'I'\''m pretty sure $HOME is set.'`. sh 解析后，参数为`I'm pretty sure $HOME is set.`.

这是一个简化此过程的python脚本：

```
#!/usr/bin/env python

import sys
import os

def shsafe(s):
    return "'" + s.replace("'", "'\\''") + "'"

def exec_adb(text):
    os.execvp('adb', [
        'adb', 'shell', 'am', 'start-activity',
        '-a', 'android.intent.action.SEND',
        '-e', 'android.intent.extra.TEXT', shsafe(text),
        '-t', 'text/plain',
        'com.tengu.sharetoclipboard',
    ])

if sys.stdin.isatty():
    if len(sys.argv) >= 2:
        exec_adb(' '.join(sys.argv[1:]))
    else:
        sys.stderr.write(
'''Send something to the android clipboard over ADB. Requires
com.tengu.sharetoclipboard.
acb <text>
<some command> | acb
acb <some_text_file.txt''')
        exit(1)
else:
    exec_adb(sys.stdin.read()) 
```

# php - 从组合框列表中获取价值

> ID：14243428
> 
> 赞同：2
> 
> 时间：2013-01-09T17:54:38.057
> 
> 标签：php, arrays, combobox

我有一个在运行时根据行数生成的组合框列表。如果有 5 行，则有 5 个组合框。我在底部有一个提交按钮，我希望当我点击提交时它应该在数据库中看到更新的值。在 php 中，我们从一个组合框中获取值`<select name="cc"></select>` ，`$_POST['cc']`但是现在我有每个组合框，所以我的问题是

*   为每个组合框赋予不同的名称（可能使用数组
*   从组合框集合中获取价值。任何可以帮助我的人

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-09T18:05:25.137

您可以使用 cc[] 作为名称，在 PHP 中您将收到一个包含所有信息的数组。或者，也许您可​​以在每个名称后附加一个数字并对其进行交互以读取所有结果。

```
<select name="cc[]">...options...</select>
<select name="cc[]">...options...</select>
<select name="cc[]">...options...</select> 
```

那么在 PHP 中 $_POST['cc'] 应该是一个包含所有选定选项的数组。

# php - jQuery 移动登录、php、cookie 不起作用

> ID：14243430
> 
> 赞同：0
> 
> 时间：2013-01-09T17:54:46.230
> 
> 标签：php, session, jquery-mobile, cookies, login

我正在构建网络应用程序作为我的主要学位项目。简单登录是有效的，但现在我正在尝试实现 cookie，但我的脚本由于某种原因无法正常工作。我需要找出原因，但不能在最后 2 小时内完成。这是我的问题：

从登录表单变量被传递到我的登录脚本（到目前为止没有实现密码或 jql 注入的安全性），当我按下登录错误时，“错误加载页面”，这是登录脚本：

```
session_start();

$username = $_GET["name"];
$password = $_GET["password"];
$remember_me = $_GET['remember_me'];

include('mysql_connection.php');
mysql_select_db("jzperson_imesUsers", $con);

$res1 = mysql_query("SELECT * FROM temp_login WHERE username='$username' AND password='$password'");
$count1=mysql_num_rows($res1);

if(isset($_COOKIE['usr_IMes']) && isset($_COOKIE['psw_IMes'])){
                    $user_n = $_COOKIE['usr_IMes'];
                    $pasw_n = $_COOKIE['psw_IMes'];

                    $res2 = mysql_query("SELECT * FROM temp_login WHERE username='$user_n' AND password='$pasw_n'");
                    $count2=mysql_num_rows($res2);

                    if($count2 == 1){

                                    $_SESSION['username'] = $user_n;

                                    header('Location: http://imes,jzpersonal.com/userpanel.php');

                    }else {
                                    setcookie('usr_IMes', $user_n, time() - 31*24*60*60);
                            setcookie('psw_IMes', $pasw_n, time() - 31*24*60*60);

                                    header('Location: http://imes,jzpersonal.com/index.html');
                    }

}else{

if($count1==1){
    $_SESSION['username'] = $username;

    if(isset($remember_me)){

setcookie('usr_IMes', $username, time() + 30*24*60*60);
setcookie('psw_IMes', $password, time() + 30*24*60*60);

header("Location: http://imes.jzpersonal.com/userpanel.php");
    }else{      

      header("Location: http://imes.jzpersonal.com/userpanel.php");

   }
}else{
    $login = "failed";
}
} 
```

任何人都可以在我的脚本中看到问题吗？在登录部分？如果不是这里是我在每个页面开头的身份验证脚本，也许我的错误就在那里：

```
session_start();

if(isset($_COOKIE['usr_IMes']) && isset($_COOKIE['psw_IMes'])){
                    $user_n = $_COOKIE['usr_IMes'];
                    $pasw_n = $_COOKIE['psw_IMes'];

                    $res2 = mysql_query("SELECT * FROM temp_login WHERE username='$user_n' AND password='$pasw_n'");
                    $count2=mysql_num_rows($res2);

                    if($count2 == 1){
                                    header('Location: http://imes,jzpersonal.com/userpanel.php');   
                    }else {
                                    setcookie('usr_IMes', $user_n, time() - 31*24*60*60);
                            setcookie('psw_IMes', $pasw_n, time() - 31*24*60*60);

                                    header('Location: http://imes,jzpersonal.com/index.html');
                    }

}else{

if(!isset($_SESSION['username']))
{
header('Location: http://imes.jzpersonal.com/index.html');
}

if(empty($_SESSION['username']))
{
header('Location: http://imes.jzpersonal.com/index.html');
}
} 
```

希望能发现一些错误，谢谢大家的帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-09T21:03:03.423

重定向是一个错误的 url：`http://imes,jzpersonal.com/userpanel.php`- 这会给你你的“错误加载页面”。除此之外，您永远不应该在 cookie 中存储用户名/密码 - 这是一种糟糕的做法，因为可以在机器上查看 cookie。此外，您正在使用已弃用的原始 PHP MySQL API - 您应该使用 PDO 或 mysqli。

# php - 上传时重命名文件的随机字符串

> ID：14243444
> 
> 赞同：0
> 
> 时间：2013-01-09T17:55:23.717
> 
> 标签：php, file-upload

我从[http://www.w3schools.com/php/php_file_upload.asp 获取](http://www.w3schools.com/php/php_file_upload.asp)了这段代码，我只是在玩它：

```
$allowedExts = array("jpg", "jpeg", "gif", "png");
$extension = end(explode(".", $_FILES["file"]["name"]));
if ((($_FILES["file"]["type"] == "image/gif")
    || ($_FILES["file"]["type"] == "image/jpeg")
    || ($_FILES["file"]["type"] == "image/png")
    || ($_FILES["file"]["type"] == "image/pjpeg"))
    && ($_FILES["file"]["size"] < 20000)
    && in_array($extension, $allowedExts)
) {
    if ($_FILES["file"]["error"] > 0) {
        echo "Return Code: " . $_FILES["file"]["error"] . "<br>";
    } else {
        echo "Upload: " . $_FILES["file"]["name"] . "<br>";
        echo "Type: " . $_FILES["file"]["type"] . "<br>";
        echo "Size: " . ($_FILES["file"]["size"] / 1024) . " kB<br>";
        echo "Temp file: " . $_FILES["file"]["tmp_name"] . "<br>";

        if (file_exists("upload/" . $_FILES["file"]["name"])) {
            echo $_FILES["file"]["name"] . " already exists. ";
        } else {
            move_uploaded_file($_FILES["file"]["tmp_name"],
                "upload/" . $_FILES["file"]["name"]);
            echo "Stored in: " . "upload/" . $_FILES["file"]["name"];
        }
    }
} else {
    echo "Invalid file";
} 
```

我想知道如何让它在上传时创建一个随机文件名，以便可以多次上传具有相同名称的文件。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-09T17:57:20.337

看

[http://php.net/manual/en/function.tempnam.php](http://php.net/manual/en/function.tempnam.php)

或者

[http://php.net/manual/en/function.tmpfile.php](http://php.net/manual/en/function.tmpfile.php)

取决于你的需要

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-09T17:57:37.713

```
$new_name_here = 'file_' . rand(0, 10000) . '.' . end(explode(".", $_FILES["file"]["name"]));
move_uploaded_file($_FILES["file"]["tmp_name"], "upload/" . $new_name_here);` 
```

[move_uploaded_file()](http://php.net/move_uploaded_file)的第二个参数选择新文件名。

# sql-server - 从 SQL Server 2008 中的两个或多个表中筛选数据

> ID：14243452
> 
> 赞同：1
> 
> 时间：2013-01-09T17:55:37.963
> 
> 标签：sql-server, database, tablefilter

我有几张桌子：

1.  “DCDetails”表包含一些诊断中心的主数据。
2.  包含公司主数据的“CompanyDetails”表
3.  包含调查的“调查”表（意味着要进行的一组医学测试）

这些是我的主桌。

我还有一些映射表： 1.“CompanyDCMap”表，其中包含公司到诊断中心的映射 2.“InvestigationDCMap”表，其中包含调查到诊断中心（或简称 DC）的映射

我必须根据以下两个标准过滤一组 DC：

1.  DC 属于“CompanyDCMap”并且
2.  在 (1) 中过滤的 DC 中，它也属于“InvestigationDCMap”表。

鉴于我有“CompanyDetails”和“Investigation”表的主键，我如何为此编写查询，以便获得位于 CompanyDCMap 和 InvestigationDCMap 中的 DC。

我几乎放弃了，我想不出同时过滤两组的查询。

请帮助我。

**更新** 架构：CompanyDetails 表：

```
CompanyID(PRIMARY KEY), CompanyName(NVARCHAR(100))
   1                     Company1
   2                     Company2
   3                     Company3 
```

调查表：

```
InvestigationID(Primary key) , InvestigationName(NVARCHAR(100))
   1                               HIV+ Blood Test
   2                               TMT
   3                               Urine Test 
```

DC明细表：

```
DCID(PRIMARY KEY), DCName(NVARCHAR(100))
   1                 DC1
   2                 DC2
   3                 DC3 
```

公司DCMap表

```
 CompanyDCMapID(Primary key), CompanyID(Foreign key), DCId(Foreign Key)
          1                        1                       1
          2                        1                       2
          3                        2                       2
          4                        2                       3
          5                        3                       1
          6                        3                       3 
```

调查DCMap表

```
 InvestigationDCMapID(Primary Key), InvestigationID(Foreign Key), DCId(Foreign Key)
          1                                1                           1
          2                                1                           3
          3                                2                           2
          4                                2                           3 
```

给定 CompanyID = 1 和 InvestigationID = 2、SELECT DCId 和 DCName = 的查询的预期输出

```
 DCId(Int)                   DCName(NVARCHAR(100))
      2                          DC2 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-09T18:19:40.603

```
SELECT d.DCID, d.DCName
FROM dbo.DCDetails AS d
INNER JOIN dbo.CompanyDCMap AS c
ON d.DCID = c.DCId
INNER JOIN dbo.InvestigationDCMap AS i
ON i.DCId = d.DCID; 
```

要获得“不同”的值，您可以使用：

```
SELECT DISTINCT d.DCID, d.DCName
FROM dbo.DCDetails AS d
INNER JOIN dbo.CompanyDCMap AS c
ON d.DCID = c.DCId
INNER JOIN dbo.InvestigationDCMap AS i
ON i.DCId = d.DCID; 
```

或者...

```
SELECT d.DCID, d.DCName
FROM dbo.DCDetails AS d
INNER JOIN dbo.CompanyDCMap AS c
ON d.DCID = c.DCId
INNER JOIN dbo.InvestigationDCMap AS i
ON i.DCId = d.DCID
GROUP BY d.DCID, d.DCName; 
```

更好的是，因为不需要与其他表的关系：

```
SELECT d.DCID, d.DCName
FROM dbo.DCDetails AS d
WHERE EXISTS (SELECT 1 FROM dbo.CompanyDCMap WHERE DCId = d.DCID)
AND EXISTS (SELECT 1 FROM dbo.InvestigationDCMap WHERE DCId = d.DCID); 
```

这将是一个更有效的查询，但如果您需要其他表中的其他列，则需要恢复到联接版本。

# iphone - 错误的 URL 连接错误

> ID：14243453
> 
> 赞同：1
> 
> 时间：2013-01-09T17:55:39.493
> 
> 标签：iphone, xcode

我对此束手无策。我正在尝试连接到网站数据库。我使用的 URL 是：“https://subdomain.domain.com/scripts/script.php?v=YES&userid=xxxxxxxxxx&aid=yyyy&msg=test message”

在发送 URL 之前，我对字符串进行如下编码：

```
 NSString *strURL = [url stringByReplacingPercentEscapesUsingEncoding:NSUTF8StringEncoding];
    url = [url stringByReplacingOccurrencesOfString:@" " withString:@"%20"];
    theURL = [NSURL URLWithString:strURL]; 
```

当我尝试连接到服务器时，我收到以下错误消息：

NSLocalizedDescription = "错误的 URL"; NSUnderlyingError = "错误域=kCFErrorDomainCFNetwork 代码=-1000 \"错误 URL" UserInfo=0xa11d760 {NSLocalizedDescription=错误 URL

我一生都无法弄清楚发生了什么。以下是我为排除故障而采取的一些措施：

1.  我已经测试了应用程序中的其他 URL 以相同的方式编码并且没有问题。
2.  我直接在 Safari、Google 和 Mozilla 中成功输入了 URL。
3.  当我在终端中使用 curl 测试 URL 时，我发现查询中未分配的键值对，例如 userid 为空。
4.  当我将转义文本粘贴到 curl 命令行时，结果是成功的。

我不知道在这里做什么。任何想法都非常感谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-09T19:47:47.310

我发现了问题——似乎设置为连接的 URL 没有正确转义。我将错误的字符串值传递给该方法。正如您在代码中看到的那样，我传递了 URL 而不是 strURL。

谢谢你的帮助！

# java - 检查有效会话：isRequestedSessionIdValid() vs getSession(false)

> ID：14243455
> 
> 赞同：6
> 
> 时间：2013-01-09T17:55:42.113
> 
> 标签：java, servlets, httprequest

我正在开发 Java Servlet。在检查用户是否登录时，我想检查 HTTP 请求是否具有有效会话。为了检查这一点，我有两种可能性：

(1)

```
protected void processRequest(HttpServletRequest request, 
        HttpServletResponse response) throws ServletException, IOException {

    HttpSession session = request.getSession(false);
    if (session != null) {
        // user is logged in
        ...
    }
} 
```

由于我将 false 作为参数传递，因此如果不存在有效会话，则不会创建新会话，并且该函数返回 null，我可以检查。

或者我这样做：

(2)

```
 if (request.isRequestedSessionIdValid()) {
        // user is logged in
        ...
    } 
```

有什么区别，有什么优点/缺点吗？或者这两个功能或多或少是一样的？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-01-09T18:06:40.720

表单 Javadoc

> isRequestedSessionIdValid boolean isRequestedSessionIdValid() 检查请求的会话 ID 是否仍然有效。如果客户端未指定任何会话 ID，则此方法返回 false。
> 
> 返回： 如果此请求具有当前会话上下文中有效会话的 id，则返回 true；否则为假

所以在某种意义上两者都是一样的。但是您需要注意的是 request.getSession(false) 只有在第一次请求容器的情况下才会为空。在第一个请求容器创建会话并发送 Jsessionid cookie 和 response 之后，它可以跟踪来自同一浏览器的后续请求。因此，在您的情况下，您应该存储会话属性“is_logged_in”=true，而不是检查会话是否为空，如果会话不为空，还要检查此属性。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-09-25T20:08:54.013

Based on the wording of the JavaDoc, it seems like there would be a distinction: if a valid session has already been created (from a prior call to `request.getSession(true)`), then the requested session ID will not be valid, but `request.getSession(false)` will have a valid (non-null) session to return. I haven't tested this theory.

# c# - 使用具有默认参数值的构造函数模拟类的受保护成员

> ID：14243457
> 
> 赞同：1
> 
> 时间：2013-01-09T17:55:50.293
> 
> 标签：c#, .net, unit-testing, moq

我知道测试非公共成员被认为是不好的，但为什么这不起作用？它抛出`ArgumentException`消息：成员`Connect`不存在

```
public class FtpHelper : IFtpHelper
{
   public FtpHelper(ISignalRLogger signalRLogger, IDirectoryWrap directoryWrap = null) {
    ... some code
   }

   protected virtual IFtpClient Connect(string ftpPath) {
     ... some code
   }
}

public class TestFtpHelper
{
   [Fact]
   public void Calls_connect(){

      var signalrMq = new Mock<ISignalRLogger>();
      var clientMq = new Mock<FtpHelper>(
            MockBehavior.Strict, new { signalRLogger = signalrMq.Object });

      clientMq.Protected().Setup<IFtpClient>("Connect",new { ftpPath = ""})
    .Returns(It.IsAny<IFtpClient>()); // That doesn't work

   }
} 
```

UPD：哦，我注意到，即使在它初始化的最后一行之前`clientMq`，我尝试使用`clientMq.Object`它也会抛出异常，并显示以下消息：在模拟类型上找不到给定参数的匹配构造函数。我想这与那个带有默认值的奇怪构造函数有关

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-09T18:04:03.000

您需要以下附加设置
1.`using Moq.Protected()`在顶部添加 2\. 使用属性
使类型对 Moq 可见。`InternalsVisibleTo`[程序集：InternalsVisibleTo(RhinoMocks.NormalName)] [程序集：InternalsVisibleTo(RhinoMocks.StrongName)]

从[链接](http://geekswithblogs.net/MattRobertsBlog/archive/2008/12/16/how-to-make-a-quotprotectedquot-method-available-for-quotpartialquot-mocking-and-again.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-09T18:22:51.410

我明白出了什么问题......
这个：

```
var clientMq = new Mock<FtpHelper>(
            MockBehavior.Strict, new { signalRLogger = signalrMq.Object }); 
```

应该：

```
var clientMq = new Mock<FtpHelper>(
            MockBehavior.Strict, signalrMq.Object); 
```

签名是`params object[]`

但现在它抛出`NullReferenceException`

Upd：你试图模拟的成员不仅应该，`virtual`而且还`internal'. Making them 'protected`不够。无法识别代理`Refection.Emit()`，Moq 使用它/

# ios - 如何更新 UIDocument 数据

> ID：14243459
> 
> 赞同：0
> 
> 时间：2013-01-09T17:55:52.597
> 
> 标签：ios, uidocument

我有一个本地 UIDocument，其中包含将最近查看文章的 NSArray 保存到单个文件中。

我的应用程序是基于 UITabbarController 的，在一个选项卡中有从互联网获取的文章列表，另一个是带有此 UIDocument 支持的 UITableView。一切都加载得很好，问题是 UIDocument 一旦打开就没有更新。当我使用 Core data 和 NSFetchedResultController 时，它可以与那些`controllerWillChangeContent`. UIDocument 有类似的吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-09T23:56:13.693

UIDocument 提供`updateChangeCount`了这一点。在您进行更改后将其发送到您的 UIDocument（子类），或者让 UIDocument 侦听从视图控制器发送的通知，并且选择器设置适当。

例如在你的 UIDocument 类的初始化中：

`[[NSNotificationCenter defaultCenter] addObserver:self selector:@selector(somethingChanged) name:@"DocumentDidChangeNotification" object:nil];`

同样在 UIDocument 中：

`- (void)somethingChanged { [self updateChangeCount:UIDocumentChangeDone]; }`

在视图控制器中，当内容发生变化时，请执行以下操作：

`[[NSNotificationCenter defaultCenter] postNotificationName:@"DocumentDidChangeNotification" object:nil];`

# c++ - 为什么我无法使用基于 C++11 范围的 for 循环来迭代向量？

> ID：14243463
> 
> 赞同：0
> 
> 时间：2013-01-09T17:55:57.013
> 
> 标签：c++, c++11, vector, iterator, c++98

```
std::vector<std::string> endpointLSRKey;

for(auto it = endpointLSRKey.begin(); it != endpointLSRKey.end(); ++it) {
        lsr->setItem(0, "", *it, address);
    } 
```

然后得到一个错误说“auto”已经改变了c ++ 11中的含义，删除它！

所以我像这样改变它：

```
for(std::string& str : endpointLSRKey){
        lsr->setItem(0, "", str, address);
    } 
```

然后得到一个错误说“C ++ 98模式下不允许基于范围的'for'循环”

完全困惑，如何迭代它？

为什么有时是c++11，有时是c++98？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-09T17:57:49.750

听起来您需要将编译器设置为 C++11 模式。错误信息：

> “C++98 模式下不允许基于范围的‘for’循环”

指出这一点。

您执行此操作的方式取决于您的编译器。

当您看到此消息时：

> 得到一个错误说“auto”已经改变了c ++ 11中的含义

您的编译器仍处于 C++98/03 模式。该关键字`auto`存在于 C++03 中，但在大多数情况下它没有任何意义，因为默认情况下变量会自动存储。（您可以通过用 标记变量来使变量进入静态存储`static`。也就是说，`auto`按`static`原样`signed`（`unsigned`在 C++98/03 中）。

因为这个含义在 C++98/03 中并没有真正有用，并且因为在 C++11 中含义发生了变化，所以 C++03 模式下的编译器可能会抱怨使用 of`auto`并带有警告。如果您将警告视为错误，则会变成错误。因此，您看到的消息。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-09T18:02:20.210

> 我应该如何在 c++98mode 中进行迭代？

任何一个

```
for(std::vector<std::string>::iterator it = endpointLSRKey.begin(); it != endpointLSRKey.end(); ++it) {
    lsr->setItem(0, "", *it, address);
} 
```

或者

```
for(std::size_t i = 0; i < endpointLSRKey.size(); ++i) {
    lsr->setItem(0, "", endpointLSRKey[i], address);
} 
```

# facebook - Facebook 如何使用 Graph API 获取实际照片 URL？

> ID：14243464
> 
> 赞同：16
> 
> 时间：2013-01-09T17:56:01.907
> 
> 标签：facebook, facebook-graph-api

可以使用 Graph api 获取 Facebook 图像的实际图像 url 吗？

例如，对于下面的照片 [http://www.facebook.com/photo.php?fbid=357755307655174](http://www.facebook.com/photo.php?fbid=357755307655174)

实际网址是 [https://fbcdn-sphotos-aa.akamaihd.net/hphotos-ak-ash4/252428_530045532341_5136_n.jpg](https://fbcdn-sphotos-a-a.akamaihd.net/hphotos-ak-ash4/252428_530045532341_5136_n.jpg)

是否有一些图形 api 方法来实现这一点？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2016-12-02T04:46:26.597

*   来自[https://developers.facebook.com/docs/graph-api/using-graph-api](https://developers.facebook.com/docs/graph-api/using-graph-api)：

> 默认情况下，当您进行查询时，不会返回节点或边中的所有字段。`fields`您可以使用查询参数选择要返回的字段或边。

这就是为什么当您检索照片时，您可能只会得到`created_time`,`name`和`id`.

*   来自[https://developers.facebook.com/docs/graph-api/reference/photo/](https://developers.facebook.com/docs/graph-api/reference/photo/)：

`source`字段在最新的 API (v2.8) 中已弃用。改为使用`images`。

因此，您的查询可能如下所示：

```
GET graph.facebook.com/{photo-id}?fields=images 
```

响应应该是这样的：

```
{

"images":[
    {
        "height":358,
        "source":"https://scontent.xx.fbcdn.net/v/t1.0-9/15327427_585435148333529_xxxxxxxxxxxx_n.jpg?oh=xxxxxxxx&oe=xxxxxxxxx",
        "width":518
    },
    {
        "height":320,
        "source":"https://fb-s-c-a.akamaihd.net/h-ak-xtl1/v/t1.0-0/p320x320/15327427_xxxxxxxxxxxxxx_n.jpg?oh=xxxxxxxxxx&oe=xxxx&__gda__=xxxxxxxxxxxx",
        "width":463
    },
    {
        "height":130,
        "source":"https://fb-s-c-a.akamaihd.net/h-ak-xtl1/v/t1.0-0/p130x130/15327427_xxxxxxxxxxxxxx_n.jpg?oh=xxxxxxxxxxx&oe=xxx&__gda__=xxxxxxxxxxxxxxxxxx",
        "width":188
    },
    {
        "height":225,
        "source":"https://fb-s-c-a.akamaihd.net/h-ak-xtl1/v/t1.0-0/p75x225/15327427_xxxxxxxxxxxxxxx_n.jpg?oh=xxxxxxxxxxxxxxxxx&oe=xxxxxxxxxxxxxxxxxx&__gda__=xxxxxxxxxxxxxxxxxx",
        "width":325
    }
],
"id":"585435148333529"

} 
```

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2013-01-09T18:18:00.947

> 是否有一些图形 api 方法来实现这一点？

因此，您必须查看[照片](https://developers.facebook.com/docs/reference/api/photo/)对象的`source`字段：

> 来源：
> 
> 照片的源图像 - 目前最大宽度或高度为 720 像素，2012 年 3 月 1 日增加到 960 像素
> 
> 表示有效 URL 的字符串

这将为您提供照片为较小图像上传的原始尺寸，或调整为最大尺寸。每个方向 960 像素。

对于更大的尺寸，您必须检查该`images`字段：

> 图片：
> 
> 照片的 4 种不同存储表示
> 
> 对象数组，包含高度、宽度和源字段

这“承诺”提供更大的尺寸（fe 2048×1417px）——但请注意，如果原始图像没有要求的那么大，这些条目仍将提供更小的图像。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2017-07-11T10:00:38.527

请求字段附件，您将在其中找到原始图像。

```
&fields=picture.type(large),attachments 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2014-06-16T18:50:54.673

似乎缺乏这方面的文档。可以通过这种方式简单地实现。在该网址[http://www.facebook.com/photo.php?fbid=357755307655174](http://www.facebook.com/photo.php?fbid=357755307655174)中，取出**fbid**表示的图片的 id 。在上述情况下，它是**357755307655174**。现在对这个对象[https://graph.facebook.com/357755307655174](https://graph.facebook.com/357755307655174)进行图形 api 查询。这将返回一个 JSON，其中包含其数据库中存在的所有纵横比及其实际 URL。遵循格式的每个数据字段

```
{
      "height": 1080, 
      "source": "https://scontent-a.xx.fbcdn.net/hphotos-xpf1/t31.0-8/10296099_566697856780203_6555830953677139074_o.jpg", 
      "width": 1980
} 
```

使用 Graph Explorer 再次检查返回的 JSON 数据的格式。源就是您要查找的。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2020-01-08T11:53:52.753

```
 new GraphRequest(
            facebookToken,
            String.format("/%s/photos", idAlbum),
            parameters,
            HttpMethod.GET,
            response -> {
                try {
                    JSONArray photoArray = response.getJSONObject().getJSONArray("data");
                    photosAlbumAfterPagination = response.getJSONObject().getJSONObject("paging").getJSONObject("cursors").getString("after");
                    Gson gson = new Gson();
                    Type type = new TypeToken<List<FacebookPhotoResponse>>() {
                    }.getType();
                    List<FacebookPhotoResponse> list = gson.fromJson(photoArray.toString(), type);
                } catch (JSONException e) {
                    e.printStackTrace();
                }
            }
    ).executeAsync(); 
```

# php - Facebook API 和 Ajax POST 请求

> ID：14243468
> 
> 赞同：0
> 
> 时间：2013-01-09T17:56:22.547
> 
> 标签：php, ajax, facebook, api

我有一个 Facebook 连接/断开链接。当用户点击“Facebook connect”链接（在**index.php**上）时，它会检查用户状态（他是否连接到 Facebook？）然后如果他没有连接，我的脚本会发送一个 Ajax $.post 请求到**connect.php**为了从数据库中检索信息（例如：用户是否在我们的数据库中注册？）。之后，它向 index.php 发回响应：如果没有错误，则刷新页面。**在这种情况下，如果一切正常，在脚本（ window.location.reload();** ）刷新页面后，我们应该会看到 Facebook 用户 ID (UID)。

问题是通过ajax回调重新加载页面后UID仍然为空。但是，如果我再次手动刷新页面，我现在可以看到 UID。

我测试了很多方法来了解问题出在哪里，我发现这个 Facebook 请求存在问题：**$me = $facebook->api('/me');**

无论如何，我不能没有**$me = $facebook->api('/me');** 所以如果你想测试我的脚本并找到问题，这就是你需要的！（不要忘记最后一个 Facebook SDK）;-)

任何帮助将不胜感激！谢谢 ！

**索引.php**

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<title>Facebook Connect</title>
<script src="js/jquery.js"></script>
<?php

/* FACEBOOK APP CONFIGURATION */
$appId = 'YOU_APP_ID';
$appSecret = 'YOUR_APP_SECRET';

define("APPID",$appId);
define("APPSECRET",$appSecret);

/* API CALL */
if (!class_exists('FacebookApiException'))
{
  require_once('inc/facebook.php' );
}

$facebook = new Facebook(array(
   'appId' => APPID,
   'secret' => APPSECRET,
));

$fb_user = $facebook->getUser();

if ($fb_user) {
    try
    {
       $me = $facebook->api('/me');
       $uid = $facebook->getUser();
    }
      catch (FacebookApiException $e)
    {
       //echo error_log($e);
       $fb_user = null;
    }
}
?>
</head>

<body>
<div id="fb-root"></div>
<script>(function(d, s, id) {
  var js, fjs = d.getElementsByTagName(s)[0];
  if (d.getElementById(id)) return;
  js = d.createElement(s); js.id = id;
  js.src = "//connect.facebook.net/fr_FR/all.js#xfbml=1&appId=<?=APPID?>";
  fjs.parentNode.insertBefore(js, fjs);
}(document, 'script', 'facebook-jssdk'));</script>

<script type="text/javascript">
    window.fbAsyncInit = function() {
        FB.init({
            appId   : '<?=APPID?>',
            oauth   : true,
            status  : true,
            cookie  : true,
            xfbml   : true
        });
    };

    function fb_connect() {
        alert('FB.getLoginStatus');
        FB.getLoginStatus(function(response) {
            if (response.status === 'connected') {
                var access_token = response.authResponse.accessToken;
                var user_id = response.authResponse.userID;
                //
                window.location.reload();
                //
            } else {
                alert('FB.login');
                FB.login(function(response) {
                    var access_token = response.authResponse.accessToken;
                    var user_id = response.authResponse.userID;
                        $.post('connect.php', function(data) {
                        var obj = $.parseJSON(data);
                        if (obj['error']==0) {
                            alert(obj['message']);
                            window.location.reload();
                        } else {
                            alert(obj['message']);
                        }
                    });
                    //

                }, {
                    scope: 'email, publish_stream, user_birthday'
                });
            }
        });
    }

    function fb_logout() {
        FB.logout(function(response) {
            window.location.reload();
        }); 
    }

    (function() {
      var e = document.createElement('script');
      e.src = document.location.protocol + '//connect.facebook.net/fr_FR/all.js';
      e.async = true;
      document.getElementById('fb-root').appendChild(e);
    }());
</script>
<p>UID : <?=$fb_user?></p>
<?php if ($fb_user) { ?>
<a href="#" onclick="fb_logout();">Disconnect</a>
<?php } else { ?>
<a href="#" onclick="fb_connect();">Facebook connect</a>
<?php } ?>
</body>
</html> 
```

**连接.php**

```
<?php
/* FACEBOOK APP CONFIGURATION */
$appId = 'YOUR_APP_ID';
$appSecret = 'YOUR_APP_SECRET';

define("APPID",$appId);
define("APPSECRET",$appSecret);

/* API CALL */
if (!class_exists('FacebookApiException'))
{
  require_once('inc/facebook.php' );
}

$facebook = new Facebook(array(
   'appId' => APPID,
   'secret' => APPSECRET,
));

$fb_user = $facebook->getUser();

if ($fb_user) {
    try
    {
       $me = $facebook->api('/me');
       $uid = $facebook->getUser();
    }
      catch (FacebookApiException $e)
    {
       //echo error_log($e);
       $fb_user = null;
    }
}

/* CALLBACK */
$result = array();

if ($fb_user) {
    $result['error'] = 0;
    $result['message'] = $me['first_name'];;
} else {
    $result['error'] = 1;
    $result['message'] = 'error';
}

echo json_encode($result);
?> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-10T15:49:53.687

> 对不起，但这不是多余的，我真的需要它来检查数据库中的内容。实际上，如果用户没有在数据库中注册，用户会被重定向到另一个页面，而不是重新加载索引页面

因此，正如我所怀疑的那样，实际上不需要 AJAX 调用。

您也可以重新加载您的`index.php`，在那里进行数据库检查，然后为成功登录的用户提供内容，或者使用*Location*标头从那里重定向它们。

> 无论如何，我需要了解为什么我无法通过手动重新加载来检索我的 FB 信息。这是真正的问题。

那么你应该调查你*真正的*问题：调试你可能得到的异常，或者使用额外的 AJAX 步骤检查登录流中有什么差异或避免它（比如什么 cookie 什么时候设置，它们是否被发送回下一个请求等）

# algorithm - 需要一个特殊数组的算法（线性场）

> ID：14243471
> 
> 赞同：2
> 
> 时间：2013-01-09T17:56:38.833
> 
> 标签：algorithm, runtime

我有一个带有预排序数字的数组（线性字段）

```
 [1, 2, 3, 4, 5, 6], 
```

但是这些数组向右移动（k 次），

现在它

```
[5,6,1,2,3,4], k = 2 
```

但我不知道k。只有数组 A。

现在我需要一个算法来找到 A 中的最大值（运行时 O(logn)）

我认为它与二进制搜索有关，任何人都可以帮助我吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-09T18:09:15.983

这个问题可以重新表述为寻找“不连续点”，即`6, 1`阵列中点的索引。您可以使用类似于[*二分搜索*](http://en.wikipedia.org/wiki/Binary_search_algorithm)的方法迭代地执行此操作，如下所示：

取一个数组`A`和两个索引，`low`and `high`，最初设置为`0`and `A.Length-1`。不连续点在`low`和之间`high`。

Divide `(low, high)` in half. Call the midpoint `mid`. Compare `A[low]` to `A[mid]` and `A[mid]` to `A[high]`. If only one pair is ordered correctly, adjust the endpoint: if it's the `low-mid` pair that's ordered, assign `low = mid`, otherwise assign `high = mid`. If both intervals are ordered, the answer is `A[high]`.

This runs in `O(LogN)` because each step reduces the size of the problem in half.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-09T18:06:58.403

你是对的，它基本上是一个二进制搜索。

选择中间的数字。如果它小于（当前分区的）左端的数字，那么最大的数字在左分区中。否则，它在正确的分区中。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-09T18:08:44.300

如果您知道“k”是什么，那么您可以拆分数组并重新构建它，或者您可以重新实现偏移 k 的二进制搜索算法。

例如，

```
int low = 0;
int high = array.length - 1;

while(low != high)
{
    int test = (low + high)/2;
    int testIndex = (test + k) % array.length;
    if (array[testIndex] < wanted)
        low = test;
    else if (array[testIndex] > wanted)
       high = test;
    else
       return testIndex;
 } 
```

或类似的东西。testIndex 变量偏移了“k”，但搜索索引（低、高和测试）不知道这一点。

PS.，您需要在此代码中添加更多安全检查（例如，“想要”不在数组中）；我只是想显示索引偏移部分。

# image-processing - 估计图像 Opencv 的亮度

> ID：14243472
> 
> 赞同：22
> 
> 时间：2013-01-09T17:56:41.860
> 
> 标签：image-processing, opencv, computer-vision, vision

我一直在尝试在 Opencv 中获取图像亮度，到目前为止，我使用了 calcHist 并考虑了直方图值的平均值。但是，我觉得这并不准确，因为它实际上并不能确定图像的亮度。我在图像的灰度版本上执行了 calcHist，并试图区分从明亮图像获得的平均值与中等图像的平均值。到目前为止，我还没有成功。您能否帮助我提供一种可以通过 OpenCv 实现的方法或算法来估计图像的亮度？提前致谢。

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2013-01-10T08:09:25.767

我想，[HSV 颜色模型](http://www.tech-faq.com/hsv.html)对您的问题很有用，其中通道 V 是值：

"值是颜色的明暗度，随颜色饱和度而变化。范围从0到100%。当值为'0'时，颜色空间将是全黑的。随着值的增加，颜色空间的亮度和显示各种颜色。”

所以使用 OpenCV 方法[cvCvtColor](http://opencv.willowgarage.com/documentation/miscellaneous_image_transformations.html?highlight=cvcvtcolor#cvCvtColor) (const CvArr* src, CvArr* dst, int code)，将图像从一种颜色空间转换为另一种颜色空间。在您的情况下，代码 = CV_BGR2HSV.Than 计算第三通道 V 的直方图。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2014-02-25T16:23:07.460

我正要问同样的问题，但后来发现，类似的问题没有给出令人满意的答案。我在 SO 上找到的所有答案都涉及人类对单像素 RGB 与 HSV 的观察。

根据我的观察，图像的主观亮度也很大程度上取决于图案。在白天，黑暗天空中的星星可能看起来比多云的天空更亮，而第一张图像的平均像素值会小得多。

我使用的图像是由显微镜产生的灰度细胞图像。形式差异很大。有时它们是非常黑的背景上的小亮点，有时是不太暗的背景上不太亮的较大区域。

我的做法是：

*   使用去除热像素的阈值查找直方图最大值 (HMax)。
*   计算 HMax * 2/3 和 HMax 之间的所有像素的平均值

比率 2/3 也可以增加到 3/4（这减少了被认为是明亮的像素范围）。

该方法效果很好，因为具有相同滴定度的不同细胞图案会产生相似的亮度。

PS：我真正想问的是，在OpenCV或SimpleCV中是否有类似的计算功能。非常感谢您的任何评论！

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2020-07-07T16:48:03.843

我更喜欢[Valentin 的回答](https://stackoverflow.com/a/22020098/11136955)，但是对于确定平均每像素亮度的“另一种”方法，您可以使用`numpy`几何平均值而不是算术平均值。对我来说它有更好的结果。

```
from numpy.linalg import norm

def brightness(img):
    if len(img.shape) == 3:
        # Colored RGB or BGR (*Do Not* use HSV images with this function)
        # create brightness with euclidean norm
        return np.average(norm(img, axis=2)) / np.sqrt(3)
    else:
        # Grayscale
        return np.average(img) 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2019-09-19T00:47:49.030

一些 OpenCV C++ 源代码，用于简单检查以区分明暗图像。这是受到@ann-orlova 多年前提供的上述答案的启发：

```
const int darkness_threshold = 128; // you need to determine what threshold to use

cv::Mat mat = get_image_from_device();

cv::Mat hsv;
cv::cvtColor(mat, hsv, CV_BGR2HSV);
const auto result = cv::mean(hsv);

// cv::mean() will return 3 numbers, one for each channel:
//      0=hue
//      1=saturation
//      2=value (brightness)

if (result[2] < darkness_threshold)
{
    process_dark_image(mat);
}
else
{
    process_light_image(mat);
} 
```

# php - 从 php 调用 Photoshop Droplet

> ID：14243474
> 
> 赞同：0
> 
> 时间：2013-01-09T17:56:44.553
> 
> 标签：php, photoshop, shell-exec

我正在尝试开发一个网络应用程序，用户可以在其中上传图像，然后他们可以对图像进行排序。

图像由 Photoshop 液滴处理（颜色和镜头校正）。当我从命令行调用液滴时，一切正常。但是，当我的 webapp (Apache+PHP+MySql) 使用 shell_exec() 调用液滴时，液滴启动但不执行任何操作。我尝试以管理员身份运行`httpd.exe`, `droplet.exe`。`photoshop.exe`我试图让 Apache 服务与桌面交互。但没有任何帮助。

有人有一些想法吗？

这是PHP：

```
shell_exec("D:\\scripts\\icon-01.exe D:\\users\\pmla\\DSC_0055.NEF"); 
```

这是我看到的错误：

```
Fatal error: Maximum execution time of 120 seconds exceeded in C:\BitNami\wampstack-5.4.10-0\apache2\htdocs\test.php on line 34 
```

# javascript - 循环中javascript中的变量类名

> ID：14243475
> 
> 赞同：-1
> 
> 时间：2013-01-09T17:56:52.390
> 
> 标签：javascript

在 Javascript 中，我有一排具有相同 div 的元素：

```
(....loop, where "count" is a number that can distinguish the columns in the row)
<other divs>
  <div class="pie"></div>
</div> 
```

然后我正在做这样的事情：

```
 <% var strng = 'rotate 40deg' %>
 <% $("other divs... .pie").css({'-webkit-transform': strng}); %> 
```

这样我就可以旋转每个单独的元素。问题是，因为我的 Javascript 选择器只是做“饼图”，所以所有单独的列元素都会旋转相同的数量。

看来我想要这样的东西：

```
<other divs>
  <div class"pie">
    <div class=count></div>
  </div> 
```

然后选择器将是这样的：

```
<% $("other divs... .pie" + " ." + count).css({'-webkit-transform': strng}); %> 
```

但这似乎不起作用。如何使用变量类名？

编辑：计数只是一个数字。我将在数字前面添加一个字符串，看看是否可行 - 感谢您注意到类名不能以数字开头。

编辑：我想了解为什么我在这个问题上失分。这是一个严肃的问题，我需要弄清楚。我关闭了它，即使我还没有得到有效的答案。我想这个问题对人们来说看起来很愚蠢？

编辑：现在有一个 JSFiddle。我需要让它开始工作——然后我会添加我想要解决的问题。

[http://jsfiddle.net/VJHcH/12/](http://jsfiddle.net/VJHcH/12/)

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2013-01-09T18:02:11.510

类名不允许以数字开头。它必须具有以下形式（正则表达式）：`-?[_a-zA-Z]+[_a-zA-Z0-9-]*`.

所以它以`-`（破折号）、`_`（下划线）或字母开头。

而不是只使用`count`作为类名，使用类似`".pie" + count`.

编辑：显然，从 HTML 5 开始，它们被允许以数字开头，但 jQuery 似乎没有正确选择它们。

# mysql - 如何确保mysql列有4个字符

> ID：14243476
> 
> 赞同：2
> 
> 时间：2013-01-09T17:56:55.010
> 
> 标签：mysql, sql, match, alter-table, zerofill

如何确保 mysql 列有 4 个字符？

由于使用最少 4 个字符的 MATCH 函数，我希望我的主键（即 INT）至少为 4 个字符。

我该怎么做 ？

例如。1 在 sql 表中将是 0001

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-09T18:34:09.740

使用列的**ZEROFILL**属性。更改您的主键列以启用 zerofill。

试试这个：

```
ALTER TABLE `tablename` CHANGE
COLUMN `id` `id` INT(4) ZEROFILL NOT NULL AUTO_INCREMENT ; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-09T18:01:36.547

您可以使用 MySQL 的`LPAD`功能：

```
SELECT LPAD('1',4,'0');
    -> '0001' 
```

[文档在这里](http://dev.mysql.com/doc/refman/5.1/en/string-functions.html#function_lpad)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-09T18:02:11.027

假设您的主键是一个自动递增的 id。

1.  暂时关闭自动增量。
2.  将 999 添加到每个 id。（当然，如果其他表使用这个 id 作为外键，你也必须调整它们）。
3.  重新添加自增，但要确保它至少从 1000 开始。请参阅：[如何在 MySQL 中设置初始值和自增？](https://stackoverflow.com/questions/1485668/how-to-set-initial-value-auto-increment-in-mysql)

# assembly - 如何计算表格偏移量

> ID：14243486
> 
> 赞同：1
> 
> 时间：2013-01-09T17:57:29.953
> 
> 标签：assembly, 6502

我正在寻找一种经济高效的方式来访问我的 6502 表中的记录。该表长 8 个字节。使用间接 Y，我可以偏移字段，但我想要一种方法来获取下一个第 0 条记录。

我曾想过：

```
lda #id
adc #$08
tax ; now x = x + 8 
```

我见过其他人使用 ASL，而累加器的值是 2 的幂：

```
asl a
tax ; x = x * 2 
```

如果我只有 2 条记录，那就太好了，但如果我再次 ASL，结果将是 x = 32。这将是一个太远的偏移量。

有没有比使用 ADC 更好的方法来做到这一点？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-09T19:13:46.317

如果表实际上是几个 8 字节的记录，我会将它存储为 8 个 1 字节的记录表，这样可以有效地进行索引。

即数组结构，而不是结构数组

这具有允许仅使用寄存器偏移量对 256 条记录进行索引的优点，并且还可以在不更改地址计算的情况下使用不同大小的记录（因此，如果您想要 5 字节记录，则只需使用更少的数组，而不是更改计算）。

```
LDA ELEMENT1,Y ; This is an array of the first bytes of our record
STA $1000
LDA ELEMENT2,Y ; This is the second bytes...
STA $1001
...etc...
INY            ; Just need to inc Y to access next record 
```

由于`INX`/`INY`是 2 周期指令，因此您不会在更新索引时击败它。

这是我的主要建议，因为它既快速又简单，尽管它确实意味着重新格式化您的数据。

如果这不是一个选项，您可以动态地重新格式化数据（假设您要访问它*以*使其物有所值，并且您有空间这样做），或者您可以使用各种技术，具体取决于您实际想要访问数据的方式以及性能的重要性。

如果您确实需要向索引添加任意数量，而不仅仅是递增，那么简单的方法是：

```
TYA      (2)
CLC      (2)
ADC #amt (2)
TAY      (2) 
```

然而，那个幼稚的版本需要 8 个周期。如果您省略了 clear-carry，您可以在 6 个周期内执行此操作，您可以在您*知道*它已被清除的情况下执行此操作（例如，如果遵循一些其他循环计算，其中处于循环中意味着进位没有已生成）。因此，为了避免设置标志，需要调整代码。任何小于 4 的递增都可以简单地通过多次递增来完成。

如果您不能保证清除进位，但您可以在内存中为查找表腾出一个页面，那么您可以在该页面的字节中存储 0 -> 255 并执行以下操作：

```
LDA table + amt, Y (4)
TAY                (2) 
```

进位标志不是由它设置的，但是零标志是，所以如果表绕到零，你可以检查一下。

如果你必须索引一个地址，那么你可以这样做：

```
LDA (zeropagevector), Y 
```

并增加`zeropagevector`. 但是，读取需要 5 个周期。如果您只在一条指令中读取记录，您可以简单地使用普通的绝对寻址，并修改指令本身的地址，从而节省一个周期。

基本上，在 6502 中有很多方法可以优化这种事情，但这实际上取决于您的数据到底是什么以及您希望如何访问它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-10T08:15:29.623

你需要有 2 个字节（16 位）的表指针变量是你的数据比 256 字节块长。

```
 tablePointerLo = $fa ; example zeropage value
    tablePointerHi = $fb ; example zeropage value

    tableAddress = $1000 ; example table address

    tableLength = 100*8 ; example length
    tableEnd = tableAddress + tableLength

    lda #<tableAddress
    sta tablePointerLo
    lda #>tableAddress
    sta tablePointerHi

loop02:
    ldy #$00
loop01:
    lda (tablePointerLo),y
    sta anywhereYouWant,y
    iny
    cpy #$08
    bne loop01

    lda tablePointerLo
    clc
    adc #$08
    sta tablePointerLo
    bcc pass01
    inc tablePointerHi
pass01:

    ; do whatever you want here with the datas

    lda tablePointerLo
    cmp #<tableEnd
    bne loop02
    lda tablePointerHi
    cmp #>tableEnd
    bne loop02 
```

我没有测试代码，它可能不起作用，但你应该明白主要思想。

# magento - Magento结帐手风琴不起作用

> ID：14243487
> 
> 赞同：1
> 
> 时间：2013-01-09T17:57:31.687
> 
> 标签：magento, prototype, accordion, checkout

生无可恋。我整晚都在想办法解决这个问题！我消除了所有没有冲突的错误，但结帐手风琴仍然没有展开。见这里[http://test.animalnecessity.com/checkout/onepage/](http://test.animalnecessity.com/checkout/onepage/)。添加一些东西到购物车>结帐>选择宠物主人，你会明白我在说什么。绝望请帮忙！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-09T18:51:41.857

当您单击“我是宠物主人”时，它会显示常规的一页结帐，但此 div 仍然不可见

```
<div id="checkout-step-login" class="step a-item" style="display:none;"> 
```

尝试使用它来使用 JS 修复它

```
 jQuery('#iampetowner').click(function() { 
     jQuery('#checkoutSteps').slideDown(); 
     jQuery('#petdvm').slideUp(); jQuery('#newpass').slideUp();
     jQuery('#checkout-step-login').show(); 
 }); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-09T18:17:37.627

解决它的最快方法（直到您有机会正确解决此问题）是执行以下操作：

*   将以下代码添加到您的模板中（应该放在 document.ready 函数中）

`jQuery('#checkout-step-login').show();`

PS 您的注册页面上有错误，请参见[此处](http://test.animalnecessity.com/customer/account/create/)

# javascript - Ember 中带有 Sinon 的假服务器

> ID：14243489
> 
> 赞同：2
> 
> 时间：2013-01-09T17:57:36.787
> 
> 标签：javascript, testing, ember.js, sinon

我想测试我的控制器，它对我的​​后端进行 ajax 调用。所以我想用茉莉和诗乃。为了用 sinon 伪造我的后端服务器，我尝试了这样的方法：

```
describe("fake server", function() {
 var server;

 beforeEach(function() {
    this.server = sinon.fakeServer.create();
  });

  afterEach(function() {
    this.server.restore();
  });

 it("calls callback with deserialized data", function () {
    var callback = sinon.spy();

    this.server.respondWith("GET", "/comments/1",
    [200, {"Content-Type": "application/json"},
      '{"comment":{"id":1,"title":"ducks and ducks"}}']);

    commentController = App.CommentController.create();

    //commentController.bind('getComment', callback);

    commentController.getComment(); 

    this.server.respond(); 

    expect(callback.called).toBeTruthy();
    expect(callback.getCall(0).args[0].attributes)
      .toEqual({
        id: "1",
        title: "ducks and ducks"
      });
  });
}); 
```

我的控制器如下所示：

```
 App.CommentController = Ember.Controller.extend({
      getComment: function() {
        $.ajax({
          url: 'http://myapi/comments/' + id,
          //...
          error: function(jqXHR, textStatus){
            this.set("error",true);
            //do something
          },
          success: function(data) {
            this.set("error",false);
            //do something else
          }
        });
      }
  }); 
```

有人可以告诉我如何运行它吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-14T16:30:25.017

```
this.server.respondWith("GET", "http://myapi.com/comments/1",
[200, {"Content-Type": "application/json"},
  '{"comment":{"id":1,"title":"ducks and ducks"}}']); 
```

在我的情况下，网址应该是绝对的。

# javascript - 使用 jQuery 将类添加到标签

> ID：14243498
> 
> 赞同：1
> 
> 时间：2013-01-09T17:57:57.530
> 
> 标签：javascript, jquery, jquery-selectors

我需要将类添加到`error`属性设置为. 然而，我为此编写的代码将页面上的每个标签都更改为，而不是仅仅将新标签添加到已经包含 的标签中。`<label>``name``choice_16_0``<label for="choice_16_0" class="error">``class``for="choice_16_0"`

这是我的代码：

```
 if (!$("input[@name=\"choice_16_0\"]:checked").val()) {
        $("label").attr("for","choice_16_0").addClass("error");
    }; 
```

这有什么问题，我该如何解决？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-09T18:00:02.247

您选择器`$("label")`是选择页面上每个标签的内容，将其更改`$("label[name=choice_16_0")`为让它选择具有您想要的名称的单个标签。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-09T18:00:35.567

```
var field = $("input[@name=\"choice_16_0\"]:checked");

 if (!$(field).val()) {
    $(field).attr("for","choice_16_0").addClass("error");
    error = true;
}; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-09T18:03:41.957

在 jQuery 中，`.attr(attribute, value)`是一个 setter，`.attr(atribute)`而是一个 getter。您应该改用选择器：`$("label[for=choice_16_0]").addClass("error")`

# dart - 发布飞镖的代码库？

> ID：14243501
> 
> 赞同：1
> 
> 时间：2013-01-09T17:58:08.130
> 
> 标签：dart

我想知道是否有任何论坛或谷歌存储库，我们可以在其中发布我们的 dart 项目以进行展示或娱乐，只是为了交换 github 或任何 svn 供应商以外的意见。

由于所有主要平台供应商都有此功能。

如果是的话，我会要求有人指出我正确的方向，因为我正在做一个简单的小项目，并且我有兴趣仅仅为了实验而发布我们的工作。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-10T08:56:43.700

查看[http://www.builtwithdart.com](http://www.builtwithdart.com) - 旨在展示社区贡献的 Dart 应用程序。

从以下选项中做出贡献：

1.  [在站点的github](https://github.com/Dartwatch/builtwithdart.com)上克隆、编辑和提交拉取请求
2.  在站点的[github上打开一个问题](https://github.com/Dartwatch/builtwithdart.com)
3.  给我留言

理想情况下，贡献者能够提供屏幕截图、G+ 链接和一两段关于该应用程序的内容 - 特别欢迎您对使用 Dart 开发它的任何说明。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-10T02:52:18.463

这就是我们所拥有的：[http](http://www.dartlang.org/samples/) ://www.dartlang.org/samples/ 。其他使用 Google 技术的项目在[https://developers.google.com/showcase/](https://developers.google.com/showcase/)上展示，但 Dart 有自己的网站。[http://www.dartlang.org/samples/](http://www.dartlang.org/samples/)已经有一些第三方贡献。如果我们得到更多，我们可以做更多的事情来展示它们。在 Google I/O 上展示一些很酷的应用程序也很棒，特别是如果它们很大并且正在生产中，或者如果它们在技术上特别酷。如果你正在做这些事情，你可以给我发电子邮件，给我留言，或者发布到 Dart 邮件列表。谢谢！

# windows - 以编程方式从 Windows 错误日志中删除条目

> ID：14243506
> 
> 赞同：0
> 
> 时间：2013-01-09T17:58:31.860
> 
> 标签：windows, wmi

我需要以编程方式从 Windows 事件日志中删除一个条目。我认为我很可能可以通过 WMI 实现这一点（这将是理想的，但肯定不是必需的），但不知道如何做到这一点。

# oop - 为什么两者都称为对象？

> ID：14243507
> 
> 赞同：0
> 
> 时间：2013-01-09T17:58:33.540
> 
> 标签：oop, class, object, dll

`object`该术语作为编译/组装的输出（如：共享对象文件）和`object`OOP 语言（类的实例）之间是否存在任何关系。为什么两者都被称为`object`？计算机科学中的术语是什么`object`以及如何使用它？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-09T18:26:41.980

不……这些东西之间没有任何关系。对象一词在英语的各个方面都被重载，软件也不例外。

目标文件（.o 文件）之所以称为 this 只是因为 40 多年来它一直被称为此名称（[请参阅此处](https://stackoverflow.com/questions/8249945/what-is-object-in-object-file-and-why-is-it-called-this-way)）；早于面向对象编程（OOP）的想法。OOP 之所以这样称呼，是因为它是一种将想法/功能分组到对象中的编程风格（[参见此处](http://en.wikipedia.org/wiki/Object-oriented_programming)）。

# c# - 如何使列下载或不动态

> ID：14243511
> 
> 赞同：0
> 
> 时间：2013-01-09T17:58:53.617
> 
> 标签：c#, asp.net, css

我有一个我们希望向移动用户提供的商店网站。完全重新设计此站点不是一种选择。商店有一个左右侧边栏，纯粹是信息性的，不是购买物品所必需的。我被赋予了为移动用户“隐藏”侧边栏的任务。我可以很容易地使用 CSS 来表示`#rightSidebar {display:none;}`，但它的图形很重，并且仍然会非常缓慢地下载到用户的手机上。

商店在 ASP.NET C# 中，侧边栏是 ConLibs，我知道我可以把逻辑放在那里说“如果移动设备不这样做”，但我的老板不希望对商店进行如此大量的更改。（我知道。:(）还有什么我忽略的东西可以让我“隐藏”内容而不先下载它吗？我不是 .NET 的专业人士，所以我想我应该问问你们我是否有什么东西缺少或尚未学会这样做。我觉得最好的方法是修改 ConLib，但不幸的是，目前这不是我的选择。

谢谢！

# c# - ASP.NET 动态生成的 TableRows 不会在回发之间持续存在

> ID：14243516
> 
> 赞同：5
> 
> 时间：2013-01-09T17:59:05.240
> 
> 标签：c#, asp.net

在 ASPX

```
<asp:Table ID="superTable" runat="server" Width="100%">
    <%--populate me on the fly!--%>
</asp:Table>

<asp:Button ID="btnAddRow" runat="server" CausesValidation="false" Text="Add Row" onclick="btnAddRow_Click" Width="90%"/>

<asp:Button ID="btnRemoveRow" runat="server" CausesValidation="false" Text="Remove Last Row" onclick="btnRemoveRow_Click" Width="90%"/> 

<asp:Button ID="btnSubmit" runat="server" Text="1" onclick="btnSubmit_Click"  Width="90%"/> 
```

CodeBehind 的相关位

```
protected void Page_Load(object sender, EventArgs e)
    {if (!IsPostBack){ writeHeader(); makeMeARow(); }}

protected void btnAddRow_Click(object sender, EventArgs e)
{   
    if (int.Parse(btnSubmit.Text) <= 20)
    {   int b = superTable.Rows.Count+1;

        writeHeader();
        btnSubmit.Text = (int.Parse(btnSubmit.Text) + 1).ToString();

        for (int a = 1; a <= int.Parse(btnSubmit.Text); a++)
            { makeMeARow(); }
    }
    else{/*tell user they can't do that! Max of 20 rows as noted by form requirements */}
}

private void writeHeader()
{
    //= == create row == =//
    TableHeaderRow tempHeaderRow = new TableHeaderRow();//make row

    //= == create cells == =//
    TableHeaderCell tempHeaderCell01 = new TableHeaderCell();
    TableHeaderCell tempHeaderCell02 = new TableHeaderCell();
    TableHeaderCell tempHeaderCell03 = new TableHeaderCell();

    tempHeaderCell01.Text = "Call Number";  tempHeaderCell01.Width = Unit.Percentage(33);
    tempHeaderCell02.Text = "Author";       tempHeaderCell02.Width = Unit.Percentage(33);
    tempHeaderCell03.Text = "Title";        tempHeaderCell03.Width = Unit.Percentage(33);

    //= == add TableCells to TableRow == =//
    tempHeaderRow.Cells.Add(tempHeaderCell01);
    tempHeaderRow.Cells.Add(tempHeaderCell02);
    tempHeaderRow.Cells.Add(tempHeaderCell03);

    //superTable.Rows.AddAt(superTable.Rows.Count, tempRow);
    superTable.Rows.Add(tempHeaderRow);
}

protected void btnRemoveRow_Click(object sender, EventArgs e)
{   int b = superTable.Rows.Count - 1;

    writeHeader();
    btnSubmit.Text = (int.Parse(btnSubmit.Text) - 1).ToString();
    for (int a = 1; a <= int.Parse(btnSubmit.Text); a++)
    {makeMeARow();}   
}
private void makeMeARow()
{
    //= == maybe off by one? == =//
    string rowCount = superTable.Rows.Count.ToString("00");

    //= == create row == =//
    TableRow tempRow = new TableRow();//make row

    //= == create cells == =//
    TableCell tempCell01 = new TableCell();
    TableCell tempCell02 = new TableCell();
    TableCell tempCell03 = new TableCell();

    //= == create TextBoxes == =//
    TextBox tempTextBox01 = new TextBox();
    TextBox tempTextBox02 = new TextBox();
    TextBox tempTextBox03 = new TextBox();

    //= == change the ID of TableRow == =//
    tempRow.ID = "tableRow_" + rowCount;

    //= == change the IDs of TableCells == =//
    tempCell01.ID = "tableCell_" + rowCount + "_01";
    tempCell02.ID = "tableCell_" + rowCount + "_02";
    tempCell03.ID = "tableCell_" + rowCount + "_03";

    //= == change the IDs of TextBoxes == =//
    tempTextBox01.ID = "txtCallNumber_" + rowCount;
    tempTextBox02.ID = "txtAuthor_" + rowCount;
    tempTextBox03.ID = "txtTitle_" + rowCount;

    //= == change TextBox widths to 90%;
    tempTextBox01.Width = Unit.Percentage(90);
    tempTextBox02.Width = Unit.Percentage(90);
    tempTextBox03.Width = Unit.Percentage(90);

    //= == add TextBoxes to TableCells == =//
    tempCell01.Controls.Add(tempTextBox01);
    tempCell02.Controls.Add(tempTextBox02);
    tempCell03.Controls.Add(tempTextBox03);

    //= == add TableCells to TableRow == =//
    tempRow.Cells.Add(tempCell01);
    tempRow.Cells.Add(tempCell02);
    tempRow.Cells.Add(tempCell03);

    //add TableRow to superTable
    //superTable.Rows.AddAt(superTable.Rows.Count, tempRow);
    superTable.Rows.Add(tempRow);
} 
```

好的，所以，我的问题；- 当我点击“添加行”或“删除行”按钮时，单元格中的数据不会在回发之间持续存在。相关的行和单元格拥有相同的 ID，但不保留数据。为什么不？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-01-09T18:29:37.130

必须在每次回发时将动态控件重新添加到表单中。通常这是在`Init`页面生命周期的阶段完成的。您动态添加的控件确实具有 ViewState。当使用与之前完全相同的 ID 将适当的控件重新添加到控件树时，它应该会重新出现，并带有在 ViewState 中保留的值。

Check out [this article](http://geekswithblogs.net/shahed/archive/2008/06/26/123391.aspx) for simple tips on using dynamic controls or you can check out this tutorial from [4 Guys from Rolla](http://www.4guysfromrolla.com/articles/081402-1.aspx) for a more in-depth look.

# jquery - aoCoulum中的jquery数据表img

> ID：14243518
> 
> 赞同：2
> 
> 时间：2013-01-09T17:59:11.000
> 
> 标签：jquery, html, datatables

我正在从数据库中获取数据，但其中一个是像这样的图像文件路径'~\images\food.png'，但我想将它放在一个 img 标签中，这样它就可以显示图像而不是路径。请有人帮忙，在此先感谢。

```
 $(document).ready(function () {
     load();
 });
 function load() {
     $.ajax({
         type: "POST",
         url: "ParentCategoryManagment.aspx/PopulateCategories",
         contentType: "application/json; charset=utf-8",
         data: "{}",
         dataType: "json",
         success: AjaxSucceeded,
         error: AjaxFailed
     });
 }
 function AjaxSucceeded(respone) {

     var json = jQuery.parseJSON(respone.d);

     if (typeof oTable == 'undefined') {
         oTable = $('#tblData').dataTable({
             'aaData': json,
             'aoColumns':
                [
                    { "mDataProp": "Id" },
                    { "mDataProp": "Name" },
                    { "mDataProp": "ImagePath" },
                    { "mDataProp": null, "sDefaultContent": '<a class="edit" href="">Edit</a>' },
                    { "mDataProp": null, "sDefaultContent": '<a class="delete" href="">Delete</a>' }
                ]
         });
     }
     else {

         oTable.fnClearTable(0);
         oTable.fnAddData(json);
         oTable.fnDraw();

     }
 }
 function AjaxFailed(result) {
     alert('Ajax Failed');
 } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-09T18:34:01.563

**请参阅 JSFIDDLE 演示**：http : [//jsfiddle.net/HPdVH/5/](http://jsfiddle.net/HPdVH/5/)

您需要遍历每个图像路径并将它们转换为图像。在您的情况下，它似乎总是第三个表格列，因此您可以在通过 ajax 加载表格后执行此操作：

```
 $("tr").each(function(){
         $(this).children("td")
                .eq(2)
                .html("<img src='" + $(this).html() + "'/>");
 }) 
```

# c++ - 为什么指针会导致内存泄漏到动态分配的整数？

> ID：14243523
> 
> 赞同：2
> 
> 时间：2013-01-09T17:59:20.590
> 
> 标签：c++, pointers, memory, memory-leaks

> “因为 pnValue 是唯一保存动态分配的整数地址的变量，所以当 pnValue 被销毁时，就不会再引用动态分配的内存了。这称为内存泄漏。结果，动态分配的整数无法删除，因此无法重新分配或重用。” [{引自 LearnCpp。}](http://www.learncpp.com/cpp-tutorial/69-dynamic-memory-allocation-with-new-and-delete/)

为什么 pnValue 保存动态分配的整数的地址？如果指针只是指向地址，为什么销毁指针会影响地址？这是否意味着在动态分配的整数中，我们必须总是有指针，因为指针在某种程度上**就是**地址？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-09T18:18:34.310

所有已定义的对象都存在于内存中并具有地址。对象的地址是对象开始驻留的内存位置。所以在一维内存空间中，如果一个对象开始驻留在槽 100，那么 100 被称为对象的地址。

```
 99 100 101  102  103  104  105  106
=====================================
   | O  | B  | J  | E  | C  | T  |    
=====================================
     ^
     |
     |
 pnObject 
```

指针是包含其他对象地址的对象。动态创建对象时，它是在堆内存中创建的，没有作用域。只要您不明确删除分配的内存或分配内存的程序死亡，它就会继续存在。

内存是通过 c-library 函数`malloc`或`c++`operator动态分配的`new`，它返回地址，即对象开始驻留的堆内存中的起始位置。您应该将地址保存在一个变量（称为指针的特定类型）中，该变量现在保存对象的地址。

```
Object *pnValue = new Object(); 
```

只要您知道堆中新创建对象的地址，您就可以控制，但如果您忘记了地址，无论是通过销毁指针变量、覆盖内容还是根本不存储地址，您都无法访问该位置并继续前进无法释放/删除分配的内存。

```
 99 100 101  102  103  104  105  106
=====================================
   | O  | B  | J  | E  | C  | T  |    
===================================== 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-01-09T18:04:09.647

指针“只是指向地址”。这就是说，如果您删除所有指向该地址的指针，则无法“访问”存储在那里的内存以删除/释放它。一旦没有指针“指向”该位置，您就无法再清理该内存，因此您会发生泄漏。

销毁指针不会造成泄漏 - 如果有另一个指针可用于访问内存以清理它。如果没有保留其他指针，则销毁指针只会删除访问该内存的能力。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-01-09T18:06:21.757

指针不指向地址，它们存储地址。据说它们“指向”对象。他们指向的对象是位于他们存储的地址中的对象。

想想通讯录。每个条目都是指向您的一个朋友的指针（您的朋友是对象）。假设您的朋友遍布全国（您的计算机内存），而您的内存是垃圾。所以你需要你的通讯录来找到你的朋友。如果您丢失了地址簿的一页（指针被破坏），则地址在该页上的朋友将丢失给您。也就是说，除非你有一个备份副本（更多的指针持有相同的地址）。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-01-09T18:30:00.160

正如本杰明所说，指针存储您要访问的数据的地址。如果您创建一个指针，您还必须保留所需的内存量。否则，您可以轻松创建访问冲突。您还应该知道，内存泄漏不仅令人讨厌，因为您的应用程序的虚拟空间增加了，而且对指针的错误处理也是每个想要破坏您的应用程序或系统的人的一个很好的切入点。为了发现内存泄漏，这里有一些项目@codeproject.com 像这样：http: [//www.codeproject.com/Articles/9815/Visual-Leak-Detector-Enhanced-Memory-Leak-Detectio](http://www.codeproject.com/Articles/9815/Visual-Leak-Detector-Enhanced-Memory-Leak-Detectio)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-01-09T18:39:23.370

> 为什么 pnValue 保存动态分配的整数的地址？如果指针只是指向地址，为什么销毁指针会影响地址？

您对“地址”一词的两种不同用法感到困惑。这个词既可以用来指代有关如何定位一个地方的信息，也可以用来指代这个地方本身。考虑：

> 1) 我把地址写在一张纸上。
> 
> 2) 我现在开车去那个地址。

使用第一种意义，指针存储地址；有关如何定位特定数据或内存的信息。使用另一种意义，指针指向一个地址。它们指向数据或内存的位置。就像你在一张纸上写下一个地址（到达某个地方的信息），那张纸现在指向地址（那个地方）。

因此，销毁指针会破坏有关如何访问该位置的信息。

> 这是否意味着在动态分配的整数中，我们必须总是有指针，因为指针在某种程度上就是地址？

当您使用 分配内存时`new`，您将获得有关如何访问分配的内存的信息。如果您最终未能将相同的信息返回给`delete`. 所以是的，您必须始终以某种方式维护该信息，以便最终将其返回给`delete`.

# cmake - CMake find_library 匹配行为？

> ID：14243524
> 
> 赞同：15
> 
> 时间：2013-01-09T17:59:33.367
> 
> 标签：cmake

一指定`find_library(<var> name PATHS path1..pathn)`

我的问题是如何`find_library()`将名称与库文件匹配（在 Windows 和 Linux 上）？

例如，我无法`find_library()`识别所提供的 GraphicsMagicK Windows 二进制安装中的 MagicK 和 MagicK++ DLL 文件：

这些文件是：`CORE_RL_magick_.dll`

搜索查询：`magick`或`CORE_RL_magick`不起作用。

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2013-01-10T00:00:58.840

您可能想查看此文档链接：

[http://www.cmake.org/cmake/help/v2.8.10/cmake.html#command:find_library](http://www.cmake.org/cmake/help/v2.8.10/cmake.html#command:find_library)

[http://www.cmake.org/cmake/help/v2.8.10/cmake.html#variable:CMAKE_FIND_LIBRARY_PREFIXES](http://www.cmake.org/cmake/help/v2.8.10/cmake.html#variable:CMAKE_FIND_LIBRARY_PREFIXES)

[http://www.cmake.org/cmake/help/v2.8.10/cmake.html#variable:CMAKE_FIND_LIBRARY_SUFFIXES](http://www.cmake.org/cmake/help/v2.8.10/cmake.html#variable:CMAKE_FIND_LIBRARY_SUFFIXES)

find_library 可以接受一个或多个库名称。这些名称会附加 CMAKE_FIND_LIBRARY_PREFIXES 和附加 CMAKE_FIND_LIBRARY_SUFFIXES 的值。应该为每个操作系统设置这两个变量，具体取决于库的前缀或后缀方式。

在你的情况下，我会为 Windows 写

```
SET(CMAKE_FIND_LIBRARY_PREFIXES "")
SET(CMAKE_FIND_LIBRARY_SUFFIXES ".lib" ".dll") 
```

对于 Linux

```
SET(CMAKE_FIND_LIBRARY_PREFIXES "lib")
SET(CMAKE_FIND_LIBRARY_SUFFIXES ".so" ".a") 
```

然后写

```
find_library(
    magick
    CORE_RL_magick_ (or NAMES if there are multiple names for the same library on different systems)

    PATHS
      path1
      path2
    ...
    (other options that are specified in documentation and would be usefull to you)
) 
```

**编辑：**

`CMAKE_FIND_LIBRARY_PREFIXES`并由[命令](https://cmake.org/cmake/help/v3.8/command/project.html)`CMAKE_FIND_LIBRARY_SUFIXES`自动设置，因此先调用它然后再调用它是比手动设置变量更好的解决方案。[`project()`](https://cmake.org/cmake/help/v3.8/command/project.html)`find_library()`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2018-09-19T08:20:40.440

如果您想查找 .dll ，为什么不使用`find_file()`而不是。`find_library()`

# grails - 编写转换代码时覆盖 asType() 的替代方法是什么？

> ID：14243525
> 
> 赞同：6
> 
> 时间：2013-01-09T17:59:38.267
> 
> 标签：grails, groovy

在 Groovy 中转换对象的约定似乎是使用`as`operator 和 override `asType()`。例如：

```
class Id {
    def value

    @Override
    public Object asType(Class type) {
        if (type == FormattedId) {
            return new FormattedId(value: value.toUpperCase())
        }
    }
}

def formattedId = new Id(value: "test") as FormattedId 
```

但是，Grails`asType()`在运行时覆盖了所有对象的实现，以便它可以支持像`render as JSON`.

另一种方法是在 Grails Bootstrap 类中重写`asType()`如下：

```
def init = { servletContext ->
    Id.metaClass.asType = { Class type ->
        if (type == FormattedId) {
                return new FormattedId(value: value.toUpperCase())
        }
    }
} 
```

但是，这会导致代码重复 (DRY)，因为您现在需要在 Bootstrap*和*Id 类中重复上述操作，否则`as FormattedId`将无法在 Grails 容器之外工作。

在 Groovy/Grails 中编写不会破坏良好代码/OO 设计原则（如 Single Responsibility Principal 或 DRY）的转换代码有哪些替代方法？Mixins 在这里有用吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-10T17:43:27.173

您可以使用 Grails 对[Codecs](http://grails.org/doc/latest/guide/security.html#codecs)的支持来自动将`encodeAs*`函数添加到您的 Grails 原型中：

```
class FormattedIdCodec {

    static encode = { target ->
        new FormattedId((target as String).toUpperCase()
    }

} 
```

然后，您可以在代码中使用以下内容：

```
def formattedId = new Id(value: "test").encodeAsFormattedId 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-05-01T19:57:26.087

我不优雅的解决方案是重命名原来的 asType()，并创建一个新的 asType() 来调用它，并让您的 BootStrap 通过调用该方法覆盖 astType：

所以，你的班级：

```
class Id {
    def value

    @Override
    public Object asType(Class type) {
        return oldAsType(type);
    }

    public Object oldAsType(Class type) {
        if (type == FormattedId) {
            return new FormattedId(value: value.toUpperCase())
        }
    }
} 
```

在我的应用程序中，我在多个类中定义了 asType，因此我最终在 BootStrap.groovy 中使用了一个通用闭包：

```
 def useOldAsType = {Class clazz ->
        delegate.oldAsType(clazz)
    }

    Id.metaClass.asType = useOldAsType;
    Value.metaClass.asType = useOldAsType;
    OtherClass.metaClass.asType = useOldAsType;
    SubclassOfValue.metaClass.asType = useOldAsType; 
```

请注意，如果您有一个不覆盖 asType 的子类，但您希望它使用超类的，您还必须在 BootStrap 中设置它。

# asp.net - 在 ms sql select 命令中计算从 2 点 lat 和 lon 的距离

> ID：14243534
> 
> 赞同：0
> 
> 时间：2013-01-09T18:00:06.433
> 
> 标签：asp.net, sql, sql-server

我有带有地方的表格，每个都有纬度和经度点我有纬度点和想要的公里数，我需要使用 select 命令在 db 中找到匹配的行来获取这个距离

有没有办法做到这一点，无需选择所有行并为每个点运行函数来计算距离？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-09T18:02:02.403

您没有说您使用的是什么版本的 SQL Server - 2008 具有地理查询功能，这可能会避免您的“选择所有行”问题。否则，这篇博文可能会有所帮助：http: [//johndyer.name/latitudelongitude-distance-calculation-in-sql-server/](http://johndyer.name/latitudelongitude-distance-calculation-in-sql-server/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-20T21:04:11.687

我喜欢为此使用计算列。具体来说，创建一个地理类型的计算列，即您的纬度/经度。如果您拥有它，您可以针对该列使用您想要的所有空间方法。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-25T09:13:01.213

谢谢大家！这是答案：

```
 String SelectString = "SELECT * FROM (SELECT *,(((acos(sin((";
    SelectString += userLat;
    SelectString += "*pi()/180)) * sin((latPoint*pi()/180))+cos((";
    SelectString += userLat;
    SelectString += "*pi()/180)) * cos((latPoint*pi()/180)) * cos(((";
    SelectString += userLon;
    SelectString += "- lonPoint)*pi()/180))))*180/pi())*60*1.1515*1.609344) as distance FROM MYTABLE ) t WHERE distance <=";
    SelectString += userDistance; 
```

# javascript - neo4j - 自动完成 javascript

> ID：14243535
> 
> 赞同：2
> 
> 时间：2013-01-09T18:00:08.390
> 
> 标签：javascript, jquery, autocomplete, neo4j

我的 Web 应用程序以一个表单开始，该表单采用逗号分隔的用户名列表，然后为每个用户查询 neo4j 数据库。

我想在输入用户名时添加自动完成功能，以便用户可以输入一个人的全名（数据库中每个节点的属性）并让它自动完成并带有 facebook 样式的建议。

neo4j 可以支持吗？最好的方法是什么。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-09T18:34:53.760

尝试[http://jqueryui.com/autocomplete/](http://jqueryui.com/autocomplete/)，并在功能上进行搜索

```
start n = node:person_index('name:sta*') return n 
```

`sta`您当前在 UI 上输入的开始位置在哪里。

# - 阻塞队列

> ID：14243550
> 
> 赞同：0
> 
> 时间：2013-01-09T18:01:06.360
> 
> 标签：

一种队列数据结构，在检索元素时等待（暂停当前线程）队列变为非空，并在存储元素时等待队列中的空间可用。

# php - php停止已经运行的脚本进程

> ID：14243555
> 
> 赞同：1
> 
> 时间：2013-01-09T18:01:17.713
> 
> 标签：php, execution

我有一个 php 程序，它执行广泛的 curl 请求来抓取网页。它可能多达一百万个请求。我需要完全停止脚本运行。即使我在浏览器中停止了它，它仍在处理请求。我怎样才能永久停止它？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-09T18:04:26.477

您只是在终止请求，您需要停止 apache 以暂时停止它。将来重新设计它，以便进程查找终止开关（如文件的存在）并在找到它时停止处理。听起来你正在将一个长时间运行的进程塞进一个 php 脚本中，为什么不直接将它作为一个正常的系统进程运行呢？

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-01-09T18:04:02.560

假设您正在运行典型的灯堆栈，如有必要，通过 SSH 连接到您的机器，然后重新启动 Apache。

如果您真的要使用 PHP 执行长时间运行的任务，我必须建议您考虑使用 cron 来运行它们或实现某种任务队列。从浏览器请求中触发这类事情通常是一个非常糟糕的主意。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-01-09T18:03:25.497

重启阿帕奇。如果您使用的是 XAMP，请从控制面板停止并启动它。

如果没有，在 Windows 上，转到任务管理器并结束`apache.exe`进程。然后重新开始。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-01-09T18:08:34.333

为什么每个人都认为你在运行 Apache？重新启动您的网络服务器，它应该是花花公子。将来，您可能会有一个终止开关，例如（示例）：

`while(!file_exists('stop.txt'))`

然后在您准备停止时制作该文件^。^或者在切断之前进行有限次数的迭代。

# ruby-on-rails - Rails habtm 连接

> ID：14243566
> 
> 赞同：9
> 
> 时间：2013-01-09T18:01:36.177
> 
> 标签：ruby-on-rails, join, has-and-belongs-to-many

**我在类别、产品和品牌**之间有这种关系：

```
class Brand < ActiveRecord::Base
  has_many :products
end

class Category < ActiveRecord::Base
  has_and_belongs_to_many :products
end

class Product < ActiveRecord::Base
  has_and_belongs_to_many :categories
  belongs_to :brand
end 
```

如何通过这种关系选择指定品牌的所有类别？我试试这个但得到一个错误

```
b = Brand.find(1)
Category.joins(:products).where(:products => b.products) 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-01-09T19:34:34.063

您对连接做了正确的事情，只需添加一个更复杂的 where 定义：

```
Category.joins(:products).where(:products => {:brand_id => 1}) 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-01-09T19:32:35.147

有争议的是，HABTM 很少（如果有的话）是一个好的设计，而 IMO 几乎是 Rails 唯一出错的地方。

引入一个外部参照表来连接产品和类别，并在关系的两边使用 has_many :through ，所以你最终得到

```
class Brand < ActiveRecord::Base
  has_many :products
  has_many categories :through => products # This is now allowed in Rails 3.x and above
end

class Category < ActiveRecord::Base
  belongs_to :product_category
  has_many :products :through => product_category 
end

class Product < ActiveRecord::Base
  belongs_to :brand
  belongs_to :product_category
  has_many :categories :through => product_category
end

class ProductCategory < ActiveRecord::Base
  has_many :products
  has_many :categories
end 
```

这为您提供了最大的灵活性，为您提供了最少的代码重构以及更直观的路径来获取关系任一方所需的任何数据，并使您能够实现以下目标

```
b = Brand.find(1)
b.categories.all 
```

**更新** 上面是完全未经测试的代码，我刚刚纠正了我犯的一个明显愚蠢的错误。如果您在实施此操作时遇到任何问题，请返回

# git - `git merge origin master` 和 `git merge origin/master` 之间有什么区别吗？

> ID：14243569
> 
> 赞同：10
> 
> 时间：2013-01-09T18:01:43.807
> 
> 标签：git, git-merge

`git merge origin master`任何机构都可以解释和之间的区别`git merge origin/master`吗？

我不小心做了`git merge origin master`。如果不同，重置该合并的命令是什么？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-01-10T03:45:14.423

经过我的测试，`$git merge origin master`等于`$git merge origin/HEAD master`。

这意味着将两个分支（origin/HEAD、master）合并到当前分支中，这与`$git merge origin/master`.

但通常情况下，master 分支和 origin/HEAD 位于同一提交行中，因此这两个命令执行相同。

我尝试了 master 和 origin/HEAD 分歧的情况，结果如下所示`$git merge origin master`：

```
*-.   33f82cd (HEAD, test) merge
|\ \  
| | * 46d0c92 (master) 22
| * | 9d9f51c (origin/test, origin/HEAD) 11
| |/  
* | 5ecfebd (origin/master) modify 2.txt
|/  
* 14949b6 remove 1.txt 
```

# objective-c - 如何按固定百分比扩展 MKMapRect？

> ID：14243571
> 
> 赞同：12
> 
> 时间：2013-01-09T18:01:51.147
> 
> 标签：objective-c, mapkit

我想得到一个在所有方向上都比当前 MKMapRect 大 10-20% 的结果`visibleMapRect`。如果这是一个 CGRect，我会使用负 x 和 y 值的 CGRectInset，为我提供一个反向插入（即更大的矩形）。不幸的是，MKMapInset 不支持负插入值，所以它不是那么容易。

如果地图矩形的值是可识别的单位，但原点 x 和 y 值大约为 4.29445e+07，并且宽度/高度为 2500-3000，这可能会更容易。

我从编写一个类别到手动执行此操作大约需要 10 秒，但我想确保我没有首先遗漏一些东西。有没有更简单的方法来扩展 MKMapRect？

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2013-10-10T22:26:46.390

在 iOS7 中，`rectForMapRect:`并`mapRectForRect:`已被弃用，现在是`MKOverlayRenderer`该类的一部分。我宁愿推荐使用这些`MapView` `mapRectThatFits: edgePadding:`方法。这是一个示例代码：

```
MKMapRect visibleRect = self.mapView.visibleMapRect;
UIEdgeInsets insets = UIEdgeInsetsMake(50, 50, 50, 50);
MKMapRect biggerRect = [self.mapView mapRectThatFits:visibleRect edgePadding:insets]; 
```

2017 年最新的 Swift ......

```
func updateMap() {

    mkMap.removeAnnotations(mkMap.annotations)
    mkMap.addAnnotations(yourAnnotationsArray)

    var union = MKMapRectNull

    for p in yourAnnotationsArray {
        // make a small, say, 50meter square for each
        let pReg = MKCoordinateRegionMakeWithDistance( pa.coordinate, 50, 50 )
        // convert it to a MKMapRect
        let r = mkMapRect(forMKCoordinateRegion: pReg)

        // union all of those
        union = MKMapRectUnion(union, r)

        // probably want to turn on the "sign" for each
        mkMap.selectAnnotation(pa, animated: false)
    }

    // expand the union, using the new #edgePadding call. T,L,B,R
    let f = mkMap.mapRectThatFits(union, edgePadding: UIEdgeInsetsMake(70, 0, 10, 35))

    // NOTE you want the TOP padding much bigger than the BOTTOM padding
    // because the pins/signs are actually very tall

    mkMap.setVisibleMapRect(f, animated: false)

} 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-01-30T21:05:50.643

将 a转换`visibleMapRect`为`CGRect`with `rectForMapRect:`，获取一个新`CGRect`的 with`CGRectInset`然后将其转换回 a `MKMapRect`with`mapRectForRect:`怎么样？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2019-04-25T21:48:22.790

**适用于Xcode 10+、Swift 4.2**的简单而干净的解决方案

 **只需像这样为地图的边距设置**边缘插图：**

```
self.mapView.layoutMargins = UIEdgeInsets(top: 8, right: 8, bottom: 8, left: 8)
self.mapView.showAnnotations(map.annotations, animated: true) 
```

请让我们知道它是否适合您。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-09-07T11:55:30.320

改进和更正[了 user2285781](https://stackoverflow.com/a/19307286/347339)对 Swift 4 的回答：

```
 // reference: https://stackoverflow.com/a/15683034/347339
    func MKMapRectForCoordinateRegion(region:MKCoordinateRegion) -> MKMapRect {
        let topLeft = CLLocationCoordinate2D(latitude: region.center.latitude + (region.span.latitudeDelta/2), longitude: region.center.longitude - (region.span.longitudeDelta/2))
        let bottomRight = CLLocationCoordinate2D(latitude: region.center.latitude - (region.span.latitudeDelta/2), longitude: region.center.longitude + (region.span.longitudeDelta/2))

        let a = MKMapPointForCoordinate(topLeft)
        let b = MKMapPointForCoordinate(bottomRight)

        return MKMapRect(origin: MKMapPoint(x:min(a.x,b.x), y:min(a.y,b.y)), size: MKMapSize(width: abs(a.x-b.x), height: abs(a.y-b.y)))
    }

    // reference: https://stackoverflow.com/a/19307286/347339
    // assuming coordinates that create a polyline as well as a destination annotation
    func updateMap(coordinates: [CLLocationCoordinate2D], annotation: MKAnnotation) {

        var union = MKMapRectNull
        var coordinateArray = coordinates
        coordinateArray.append(annotation.coordinate)

        for coordinate in coordinateArray {
            // make a small, say, 50meter square for each
            let pReg = MKCoordinateRegionMakeWithDistance( coordinate, 50, 50 )
            // convert it to a MKMapRect
            let r = MKMapRectForCoordinateRegion(region: pReg)

            // union all of those
            union = MKMapRectUnion(union, r)
        }

        // expand the union, using the new #edgePadding call. T,L,B,R
        let f = mapView.mapRectThatFits(union, edgePadding: UIEdgeInsetsMake(70, 35, 10, 35))

        // NOTE you want the TOP padding much bigger than the BOTTOM padding
        // because the pins/signs are actually very tall

        mapView.setVisibleMapRect(f, animated: false)
    } 
```**

# python - 从 scipy.sparse.linalg.cg 中的回调打印当前残差

> ID：14243579
> 
> 赞同：3
> 
> 时间：2013-01-09T18:02:20.673
> 
> 标签：python, scipy, linear-algebra

我`scipy.sparse.linalg.cg`用来求解一个大型的稀疏线性系统，它工作正常，除了我想添加一个进度报告，这样我就可以在求解器工作时监控残差。我设法设置了一个回调，但我不知道如何从回调内部访问当前的残差。当然，自己计算残差是可能的，但这是一个相当繁重的操作，我想避免。我错过了什么，还是没有有效的方法来获得残差？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-09T18:22:07.050

回调仅发送`xk`，即当前解决方案向量。因此，您无法直接访问残差。但是，[源代码](https://github.com/scipy/scipy/blob/v0.11.0/scipy/sparse/linalg/isolve/iterative.py#L240)显示`resid`是`cg`函数中的局部变量。

因此，使用 CPython，可以使用该`inspect`模块查看调用者框架中的局部变量：

```
import inspect
import numpy as np
import scipy as sp
import scipy.sparse as sparse
import scipy.sparse.linalg as splinalg
import random

def report(xk):
    frame = inspect.currentframe().f_back
    print(frame.f_locals['resid'])

N = 200
A = sparse.lil_matrix( (N, N) )
for _ in xrange(N):
    A[random.randint(0, N-1), random.randint(0, N-1)] = random.randint(1, 100)

b = np.random.randint(0, N-1, size = N)
x, info = splinalg.cg(A, b, callback = report) 
```

# emacs - 跨越一条线的“语义”运动

> ID：14243583
> 
> 赞同：4
> 
> 时间：2013-01-09T18:02:27.517
> 
> 标签：emacs, elisp

考虑以下 Lisp 代码行：

```
 (some-function 7 8 | 9) ;; some comment. note the extra indentation 
```

该点位于“8”和“9”之间。如果我执行`(move-beginning-of-line)`，该点将放置在该行的*绝对*开头，而不是'('。

同样适用于`move-end-of-line`：如果我执行一次，我会发现将点放在')' 处更可取，如果我第二次执行它，则放在行的绝对末尾。一些 IDE 的行为就是这样。

我试图实现这一点，但被卡住了，我的解决方案在缓冲区末尾附近表现得特别糟糕，在 minibuffer 上也是如此。**是否有提供此功能的库？**

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-09T20:34:31.823

我不知道任何库，但可以在几行 Elisp 中完成。

对于行首部分，捆绑的函数`beginning-of-line-text`和[`back-to-indentation`](http://www.gnu.org/software/emacs/manual/html_node/emacs/Indentation-Commands.html#index-back_002dto_002dindentation-1667)( `M-m`) 移动到行的“有趣”部分的开头。`back-to-indentation`仅忽略空格而`beginning-of-line-text`跳过[填充前缀](http://www.gnu.org/software/emacs/manual/html_node/emacs/Fill-Prefix.html)（在编程语言中，如果在注释中，这通常是注释标记）。请参阅[Emacs 中的 Smart home，](https://stackoverflow.com/questions/145291/smart-home-in-emacs)了解如何在实际行和逻辑行的开头之间切换。

对于行尾部分，以下函数实现了您所描述的内容。该函数`end-of-line-code`移动到行尾，除了尾随空格和可选的尾随注释。该函数`end-of-line-or-code`执行此操作，除非该点已经在目标位置，或者如果该行仅包含空格和注释，则该点将移动到实际行的末尾。

```
(defun end-of-line-code ()
  (interactive "^")
  (save-match-data
    (let* ((bolpos (progn (beginning-of-line) (point)))
           (eolpos (progn (end-of-line) (point))))
      (if (comment-search-backward bolpos t)
          (search-backward-regexp comment-start-skip bolpos 'noerror))
      (skip-syntax-backward " " bolpos))))

(defun end-of-line-or-code ()
  (interactive "^")
  (let ((here (point)))
    (end-of-line-code)
    (if (or (= here (point))
        (bolp))
        (end-of-line)))) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-09T18:17:32.437

一些几乎可以满足您要求的建议：

在 lisp 代码中，您可以使用 sexp 移动命令来做您想做的事情。要从中间的某处到达表达式的开头，请使用`backward-up-list`，它绑定到`M-C-u`。在您的示例中，这会将您带到左括号。要向后移动列表中的单个元素，请使用`backward-sexp`, 绑定到`M-C-b`; `forward-sexp`向另一个方向移动，并且必然`M-C-f`。`M-C-n`从一个 sexp 的开头，您可以使用;跳到下一个。与`M-C-p`.

这些命令实际上都没有查看您所在的物理线路，因此它们会在多条线路上返回或前进。

其他选项包括[Ace Jump 模式](https://github.com/winterTTr/ace-jump-mode)，这是一种非常巧妙的方式，可以快速导航到屏幕上任何可见单词的开头。这可能会消除您使用特定于行的命令的需要。为了在一行内快速移动，我通常使用`M-f`and`M-b`来跳过单词。在点击或时按住`M`键足够快，以至于我在大多数情况下默认使用它。`b``f`

编辑：

忘记了另一个不错的命令 - `back-to-indentation`，绑定到`M-m`. 这将使您回到一行中的第一个非空白字符。您可以建议它在第一次调用时正常运行，然后在第二次调用时备份到行首：

```
(defadvice back-to-indentation (around back-to-back)
  (if (eq last-command this-command)
      (beginning-of-line)
    ad-do-it))

(ad-activate 'back-to-indentation) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-09T19:47:51.537

我刚刚编写了这两个具有您正在寻找的行为的函数。

```
(defun move-beginning-indent ()
  (interactive)
  (if (eq last-command this-command)
      (beginning-of-line)
    (back-to-indentation))
)

(defun move-end-indent ()
  (interactive)
  (if (eq last-command this-command)
      (end-of-line)
    (end-of-line)
    (search-backward-regexp "\\s)" nil t)   ; searches backwards for a 
    (forward-char 1))                       ; closed delimiter such as ) or ]
)

(global-set-key [f7] 'move-beginning-indent)          
(global-set-key [f8] 'move-end-indent) 
```

试一试，它们的行为应该完全符合您的要求。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-01-09T20:32:57.937

我用这个：

```
(defun beginning-of-line-or-text (arg)
  "Move to BOL, or if already there, to the first non-whitespace character."
  (interactive "p")
  (if (bolp)
      (beginning-of-line-text arg)
    (move-beginning-of-line arg)))
(put 'beginning-of-line-or-text 'CUA 'move)
;; <home> is still bound to move-beginning-of-line
(global-set-key (kbd "C-a") 'beginning-of-line-or-text)

(defun end-of-code-or-line ()
  "Move to EOL. If already there, to EOL sans comments.
    That is, the end of the code, ignoring any trailing comment
    or whitespace.  Note this does not handle 2 character
    comment starters like // or /*.  Such will not be skipped."
  (interactive)
  (if (not (eolp))
      (end-of-line)
    (skip-chars-backward " \t")
    (let ((pt (point))
          (lbp (line-beginning-position))
          (comment-start-re (concat (if comment-start
                                        (regexp-quote
                                         (replace-regexp-in-string
                                          "[[:space:]]*" "" comment-start))
                                      "[^[:space:]][[:space:]]*$")
                                    "\\|\\s<"))
          (comment-stop-re "\\s>")
          (lim))
      (when (re-search-backward comment-start-re lbp t)
        (setq lim (point))
        (if (re-search-forward comment-stop-re (1- pt) t)
            (goto-char pt)
          (goto-char lim)               ; test here ->
          (while (looking-back comment-start-re (1- (point)))
            (backward-char))
          (skip-chars-backward " \t"))))))
(put 'end-of-code-or-line 'CUA 'move)
;; <end> is still bound to end-of-visual-line
(global-set-key (kbd "C-e") 'end-of-code-or-line) 
```

# twitter-bootstrap - iScroll4 和 Bootstrap 的 scrollspy

> ID：14243584
> 
> 赞同：4
> 
> 时间：2013-01-09T18:02:32.670
> 
> 标签：twitter-bootstrap, iscroll4

我一直在尝试让[Bootstrap 的 scrollspy](http://twitter.github.com/bootstrap/javascript.html#scrollspy)与使用[iScroll4的滚动 div 一起工作](http://cubiq.org/iscroll-4)

有人有这方面的经验吗？

# haskell - 当变量位于haskell中的函数中间时使用monad >>=

> ID：14243585
> 
> 赞同：1
> 
> 时间：2013-01-09T18:02:35.257
> 
> 标签：haskell

你好这里是我的问题。这是我的运行代码，很好：

```
showBalls = do
      howMany <- getInt
      return . take HowMany $ repeat 9 
```

我的 getInt 进行了几次检查以检索用户输入 Int。但是，我的问题是，有没有办法使用 monad 重写这部分代码？

我的目标是使用 >>= 并具有最终的单行功能，例如：

```
showBalls = fmap (take <$> (repeat 9)) getLine 
```

但是它不起作用（如预期的那样）。有什么建议吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-09T18:18:19.230

您可以使用`flip`来反转 的参数`take`，这使得可以应用`repeat 9`到它并获取函数：

```
> :t flip take (repeat 9)
flip take (repeat 9) :: Num a => Int -> [a] 
```

要与我们一起使用`>>=`，`getInt`我们需要`Int -> IO a`功能：

```
> :t (getInt >>=)
(getInt >>=) :: (Int -> IO b) -> IO b 
```

要做到这一点，请组合使用`return`（这是`m [a]`因为它适用于每个 monad，但也仅限于列表；从上述类型，`m`成为`IO`和`b`成为`[a]`）：

```
> :t return . flip take (repeat 9)
return . flip take (repeat 9) :: (Monad m, Num a) => Int -> m [a] 
```

最后的表达式是：

```
> :t getInt >>= return . flip take (repeat 9)
getInt >>= return . flip take (repeat 9) :: Num a => IO [a] 
```

但是，正如我所提到的，我并不真的相信它比原版更好。作为一种更有用的知识，在 GHCi 中使用表达式及其类型是发明此类转换的好方法。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-09T18:18:48.687

我自己也得到了它，但使用 lambda 表示法:)

```
showBalls = getInt >>= (\a -> return . take a $ repeat 9 ) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-09T18:16:44.657

我相信这应该有效：

```
showBalls = (liftM . flip take $ repeat 9) getInt 
```

可能也有无积分的方法，但我无法弄清楚。

# java - 可执行jar howto

> ID：14243587
> 
> 赞同：1
> 
> 时间：2013-01-09T18:02:48.027
> 
> 标签：java, jar, executable-jar

我在github上有代码，

[https://github.com/Quillion/Game](https://github.com/Quillion/Game)

我想让它可执行。jarIt.bat 是制作 jar 的东西。

```
path C:\Program Files\Java\jdk1.7.0_04\bin;%path%

cls

javac *java

echo Main-Class: Main> manifest.txt
jar cvfm Main.jar manifest.txt *.class
java -jar Main.jar

del *.class 
```

我可以使用 run.bat 文件在我的计算机上执行它，

```
path C:\Program Files\Java\jdk1.7.0_04\bin;%path%

cls

java -jar Main.jar 
```

但是如果我将它转移到另一台计算机或 Linux 上，我仍然必须使用命令来执行它。如何创建一个 jar 文件以便可以双击并执行它？

我对整个 jar 的解释有点糟糕，所以如果有人能找到一个很好的分享链接来解释一切，我将非常感激。

我试过阅读很多解释，但没有一个解释如何正确地做到这一点。我知道我可以使用 Eclipse 来完成此任务，但我想了解如何在没有任何 IDE 帮助的情况下自己制作一个。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-09T18:30:46.230

不幸的是，并非所有操作系统都支持通过双击 ootb 运行 jar。您最好为您需要支持的所有环境生成脚本。您可以使用 Maven 和为您编写脚本的插件来做到这一点：

[http://mojo.codehaus.org/appassembler/appassembler-maven-plugin/](http://mojo.codehaus.org/appassembler/appassembler-maven-plugin/)

顺便说一句，您的 jar 应该已经在现代 Windows 安装中通过双击运行！你做得很对。

# mongodb - 在 MongoDB 中缓存重复查询结果

> ID：14243588
> 
> 赞同：11
> 
> 时间：2013-01-09T18:02:51.213
> 
> 标签：mongodb, caching, tornado

我将构建一个旨在“查看”很多的页面，但很少有用户会“写入”到数据库中。例如，100 个用户中只有 1 个可以在我的网站上发布他的新闻，其余的只会阅读新闻。

在上述情况下，当他们访问我的主页时，将执行 100 个 SAME QUERIES，而实际的数据库更改很少。实际上，其中 99 个查询是对计算机能力的浪费。有没有什么方法可以缓存第一个查询的结果，当它们在短时间内检测到相同的查询时，可以传递缓存的结果？

我使用 MongoDB 和 Tornado。但是，有些帖子说 MongoDB 不做缓存。

使用 Nginx 之类的东西制作静态、缓存的 HTML 不是首选，因为我想每次都通过 Tornado 呈现个性化页面。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-01-09T18:20:36.503

> 我使用 MongoDB 和 Tornado。但是，有些帖子说 MongoDB 不做缓存。

我不知道是谁这么说的，但 MongoDB 确实有缓存查询的方法，实际上它使用操作系统的 LRU 来缓存，因为它本身不进行内存管理。

只要您的工作集适合 LRU，而操作系统不必不断地对其进行分页或交换，您就应该在大多数情况下从内存中读取此查询。所以，是的，MongoDB 可以缓存，但从技术上讲它不能；操作系统可以。

> 实际上，其中 99 个查询是对计算机能力的浪费。

解决此类问题的缓存机制在大多数技术中都是相同的，无论是 MongoDB 还是 SQL。当然，这只在有问题的情况下才重要，如果你问我，你可能是在微优化；除非您获得 Facebook 或 Google 或 Youtube 类型的流量。

缓存主题涉及一个巨大的主题，范围从在预先聚合的 MongoDB/Memcache/Redis 等中缓存查询到缓存 HTML 和其他 Web 资源以在服务器端尽可能少地工作。

正如我个人所说，您的情况听起来好像您对浪费的计算机能力的想法是错误的。即使您将此查询缓存在另一个集合/技术中，您也可能会使用与您不打扰的情况相同数量的功率和资源从该技术中检索结果。但是，这种假设归结为您拥有正确的索引、架构、设置等。

我建议您阅读一些有关良好架构设计和索引创建的链接：

*   [http://docs.mongodb.org/manual/core/indexes/](http://docs.mongodb.org/manual/core/indexes/)
*   [https://docs.mongodb.com/manual/core/data-model-operations/#large-number-of-collections](https://docs.mongodb.com/manual/core/data-model-operations/#large-number-of-collections)

> 使用 Nginx 之类的东西制作静态、缓存的 HTML 不是首选，因为我想每次都通过 Tornado 呈现个性化页面。

是的，我认为通过尝试担心查询缓存，您过早地进行了优化，特别是如果您不想起飞，那么每次服务器上 90% 的负载是多少；加载页面本身。

我会专注于您的架构和索引，然后在您真的需要时担心缓存。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-01-10T16:15:02.990

Motor (MOngo + TORnado) 包的作者在这里给出了一个缓存他的类别列表的例子：http: [//emptysquare.net/blog/refactoring-tornado-code-with-gen-engine/](http://emptysquare.net/blog/refactoring-tornado-code-with-gen-engine/)

基本上，他定义了一个全局类别列表并查询数据库以填充它；然后，每当他需要页面中的类别时，他都会检查列表：如果存在，则使用它，如果不存在，则再次查询并填写它。他将其设置为在插入数据库时​​使列表无效，但根据您的使用情况，您可以创建一个全局超时变量来跟踪您何时需要重新查询下一次。如果您正在做一些复杂的事情，这可能会失控，但如果它只是最新帖子或其他内容的列表，我认为它会很好。

# java - Java中的代理设置

> ID：14243590
> 
> 赞同：2
> 
> 时间：2013-01-09T18:02:58.963
> 
> 标签：java, properties, proxy, network-programming

谷歌搜索并找到一些关于 Java 中代理设置的链接，但很少有事情让我有点困惑

**1)**我们真的需要设置 proxySet 属性吗？

```
System.getProperties().put( "proxySet", "true" );
System.getProperties().put( "proxyHost", "proxy host" );
System.getProperties().put( "proxyPort", "8080" ); 
```

**2)**设置http.proxyHost 和proxyHost 有什么区别？基本上，这是否意味着“proxyHost”将适用于所有协议，包括http、https、ftp等，而http.proxyHost仅适用于http协议？

```
System.getProperties().put( "proxyHost", "proxy host" ); 
```

或者

```
System.getProperties().put( "http.proxyHost", "proxy host" ); 
```

**3）**我们总是需要事后做吗？

```
System.getProperties().put( "proxySet", "false" );
System.getProperties().put( "proxyHost", "" );
System.getProperties().put( "proxyPort", "" ); 
```

**4)**关于在 Java 中进行代理设置的详细官方文档在哪里？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-09T20:21:27.487

1.  不，没有这样的属性`proxySet`。它是 1997 年早已不复存在的 HotJava bean 的一个特性，并从那里泄露到了各种 3rd-party 书籍中。JDK 中从未有过这样的属性，我从 1.1.2 开始查看了所有这些属性。为了证明，设置另外两个并设置`proxySet`为 false 看看会发生什么。注意这个问题确实由文档回答，因为`proxySet`没有出现在那里。

2.  (a) 无，除非您不应该使用`proxyHost/Port`，因为它们已过时。(b) 文件没有这样说。

3.  见 (1) `proxySet`。将其他设置为 null 而不是 "" 会更重要，但我不相信它有任何效果：一旦加载了属性，它们就会粘住。如果您需要动态控制代理，则需要使用`java.net.Proxy.`

4.  这已在@tostao 的评论中得到解答。

# c# - SQL Server：无法从本地网站连接（SQL 网络接口，错误：26 - 错误定位服务器/指定实例）

> ID：14243595
> 
> 赞同：2
> 
> 时间：2013-01-09T18:03:22.783
> 
> 标签：c#, .net, sql-server-2008, visual-studio-2008, windows-7

我正在使用 Visual Studio 2008 和 Sql Server 2008 Express 开发一个网站。我开始开发，所以代码是正确的，因为我的一些同事使用相同的工具正确运行它。问题是：一旦我运行该网站**，我就无法使其与数据库通信**。他们都在我的本地机器上。抛出的错误是：

> 建立与 SQL Server 的连接时发生与网络相关或特定于实例的错误。服务器未找到或无法访问。验证实例名称是否正确以及 SQL Server 是否配置为允许远程连接。（提供者：SQL 网络接口，错误：26 - 错误定位服务器/指定的实例）

奇怪的是，我可以通过*数据资源管理器*面板通过 Visual Studio 本身导航数据库。通过这样做，我从属性中读取了连接字符串，它看起来像

> 数据源=*MY_MACHINE*\SQLEXPRESS；初始目录=*MY_DB*；集成安全=True

我也尝试了一些改变，比如

> 数据源=.\SQLEXPRESS；初始目录=*MY_DB*；集成安全=True
> 
> 数据源=localhost\SQLEXPRESS；初始目录=*MY_DB*；集成安全=True

两者都没有结果。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-09T18:23:47.240

问题是 ASP.NET 工作进程没有访问数据库的权限。

有很多方法可以解决这个问题，但最简单的方法是授予本地组每个人对数据库的权限。然后你应该能够连接。

或者

您可以将连接字符串更改为不使用集成安全性，但给它一个用户名和密码

您还应该在事件日志中看到适当的错误消息（说不允许某某用户访问数据库），然后您可以只授予该用户权限。

当您以自己的身份奔跑时，您就是以自己的身份进行连接，并且您拥有权利。当 IIs 运行时，它作为工作进程运行，并且该用户无法连接。

# linq-to-sql - SQL Server CE 是否需要/提供“UpdateOnSubmit()”？

> ID：14243597
> 
> 赞同：0
> 
> 时间：2013-01-09T18:03:25.413
> 
> 标签：linq-to-sql, sql-server-ce, sql-update, windows-phone-8, insert-update

要在 SQL Server CE 中插入一条记录，请调用 ..InsertOnSubmit()，传递代表要插入的记录的类实例，然后是 .SubmitChanges();

我是否需要类似的结构来更新记录？我有这个：

```
SQLCEDataContext sqlcedc = new SQLCEDataContext(SQLCEDataContext.DBConnectionString);
var invitations = (from SQLCEDataDefinition invitation in
                       sqlcedc.SQLCEDataDefinitions
                   where invitation.SenderID == senderID
                   select invitation).SingleOrDefault();
invitations.SenderDeviceID = senderDeviceID;
sqlcedc.SubmitChanges(); 
```

..但想知道我是否需要 InsertOnSubmit() 的类似物 - 但我看不到 UpdateOnSubmit()。即使这是更新操作而不是插入操作，我是否需要用户 InsertOnSubmit()？

windows-phone-8 sql-server-ce 更新 linq

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-09T18:43:25.153

不，您没有 UpdateOnSubmit() 并且您不能使用 InsertOnSubmit() 来更新您的记录。

您需要先获取数据，更新您的属性，然后使用 SubmitChanges()

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-09T21:21:02.130

试试这样：

```
 SQLCEDataContext sqlcedc = new SQLCEDataContext(SQLCEDataContext.DBConnectionString);
var invitations = (from SQLCEDataDefinition invitation in
                       sqlcedc.SQLCEDataDefinitions
                   where invitation.SenderID == senderID
                   select invitation).SingleOrDefault();
invitations.SenderDeviceID = senderDeviceID;
sqlcedc.SubmitChanges(); 
```

# iphone - 如何删除主从模板上的编辑按钮

> ID：14243599
> 
> 赞同：1
> 
> 时间：2013-01-09T18:03:40.743
> 
> 标签：iphone, ios, objective-c, xcode, ios6

我使用主从模板在界面构建器中创建了一个项目，我想摆脱编辑按钮。

我写（在 MasterViewController 中）：

```
- (BOOL)tableView:(UITableView *)tableView canEditRowAtIndexPath:(NSIndexPath *)indexPath
{
    // Return NO if you do not want the specified item to be editable.
    return NO;
} 
```

这会禁用编辑按钮，但该按钮仍然存在。

然后我尝试了（在 viewDidLoad 中，将 tableView 属性连接到我的 MasterViewController 类之后）：

```
 [self.tableView setEditing:NO]; 
```

但是，按钮仍然存在。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-09T18:18:02.037

您需要完全删除该按钮。`setEditing`与表格视图是否处于编辑模式有关，因此请尝试：

```
self.navigationItem.rightBarButtonItem = nil; 
```

在你的`viewDidLoad`方法中。

还要确保在 viewDidLoad 中没有看到如下代码行：

```
self.navigationItem.rightBarButtonItem = self.editButtonItem; 
```

如果是，请删除或注释掉。

# powershell - 从变量添加文本到标签

> ID：14243604
> 
> 赞同：-1
> 
> 时间：2013-01-09T18:03:57.100
> 
> 标签：powershell, label

以这段代码为例，该函数使用 vsphere cmd-let 根据列表框中选定的 VM 检索 CPU 编号。输出正在另一个列表框中工作，但我希望能够将结果输出到标签

```
function fill_updatelistbox 
{
$vmlist1 = Get-vm -Name $listBox1.SelectedItem | select NumCPU
foreach ($vm1 in $vmlist1)
{
$label1.Text($vm1.NumCPU)
}
}

$label1.DataBindings.DefaultDataSourceUpdateMode = 0
$System_Drawing_Point = New-Object System.Drawing.Point
$System_Drawing_Point.X = 400
$System_Drawing_Point.Y = 115
$label1.Location = $System_Drawing_Point
$label1.Name = "label1"
$System_Drawing_Size = New-Object System.Drawing.Size
$System_Drawing_Size.Height = 23
$System_Drawing_Size.Width = 100
$label1.Size = $System_Drawing_Size
$label1.TabIndex = 0
$label1.Text = "" 
```

编辑：下面的代码使用列表框工作

```
function fill_updatelistbox
{
$vmlist1 = Get-vm -Name $listBox1.SelectedItem | select NumCPU
foreach ($vm1 in $vmlist1)
{
[void]$listBox2.Items.Add($vm1.NumCPU)
}
}

$tabPage2.Controls.Add($panel2)
$listBox2.DataBindings.DefaultDataSourceUpdateMode = 0
$listBox2.FormattingEnabled = $True
$System_Drawing_Point = New-Object System.Drawing.Point
$System_Drawing_Point.X = 1
$System_Drawing_Point.Y = 1
$listBox2.Location = $System_Drawing_Point
$listBox2.Name = "listBox2"
$System_Drawing_Size = New-Object System.Drawing.Size
$System_Drawing_Size.Height = 369
$System_Drawing_Size.Width = 160
$listBox2.Size = $System_Drawing_Size
$listBox2.TabIndex = 0
$panel2.Controls.Add 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-09T18:25:07.320

仅供参考，我没有资源来测试这个，但我会尽力提供帮助。首先，确保列表框是单选的，因为标签更像是一个单项文本框:) 然后你可以尝试：

```
function fill_updatelistbox 
{
#Should return a single VirtualMachine object
$vm = Get-vm -Name ($listBox1.SelectedItem.toString())
$label1.Text = $vm.NumCPU.toString()
} 
```

# zurb-foundation - Zurb Foundation Clearing - Chrome 上的全屏问题。漏洞？

> ID：14243605
> 
> 赞同：3
> 
> 时间：2013-01-09T18:04:01.280
> 
> 标签：zurb-foundation

我在电子商务网站上实施了 Zurb Foundation 的 Clearing，当全屏启动时，我在 Chrome 下遇到了问题。该问题甚至出现在 Zurb Docs 中，其中第一张图片显示在屏幕的右下角。

你可以[在这里](http://foundation.zurb.com/docs/clearing.php)看到他们的画廊示例（记住你需要在 Chrome 上运行）

如果链接无效或问题未显示给您，请查看我从他们的网站截取的屏幕截图的[链接。](http://d.pr/i/lNWy)

我发布了支持，但他们似乎没有在反馈之后出现。

也许有人找到了解决这个问题的方法……你能和我分享一下吗？

谢谢！！

# r - 维恩图有问题吗？

> ID：14243609
> 
> 赞同：5
> 
> 时间：2013-01-09T18:04:09.870
> 
> 标签：r, venn-diagram

我已经使用这里给出的食谱取得了很大的成功。但是，在过去的几天里，这似乎不起作用。我的`sessionInfo()`样子如下：

```
R version 2.15.2 (2012-10-26)
Platform: x86_64-apple-darwin9.8.0/x86_64 (64-bit)

locale:
[1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8

attached base packages:
[1] grid      stats     graphics  grDevices utils     datasets  methods   base     

other attached packages:
[1] VennDiagram_1.5.1

loaded via a namespace (and not attached):
[1] tools_2.15.2 
```

我尝试了以下方法，但没有产生任何结果：

```
 require(VennDiagram)

 venn.diagram(list(B = 1:1800, A = 1571:2020),fill = c("red", "green"), alpha = c(0.5, 0.5), cex = 2,cat.fontface = 4,lty =2, fontfamily =3, filename = "trial2.emf") 
```

但没有产生任何结果。

我做错什么了吗？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-01-10T18:47:43.190

一种解决方法是使用`png()`或`pdf()`保存绘图。我们首先确认我们可以使用以下方法在屏幕上绘制绘图`grid.draw()`：

```
library(VennDiagram)
temp <- venn.diagram(list(B = 1:1800, A = 1571:2020),
    fill = c("red", "green"), alpha = c(0.5, 0.5), cex = 2,cat.fontface = 4,
    lty =2, fontfamily =3, filename = NULL)
grid.draw(temp) 
```

确认后，我们需要做的就是`grid.draw()`保存`pdf()`它`dev.off()`

```
library(grDevices)

pdf(file="venn.pdf")
    grid.draw(temp)
dev.off() 
```

如他们的帮助文件中所述，`pdf()`并且`png()`具有控制图像大小等参数的参数，从而提高了对图像质量的控制。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2013-03-27T10:37:35.497

MattBagg 的回答非常好，但为了完整起见，让我添加如何在同一页面中保存多个维恩图 - 在比较多个条件时很有用。像这样：这个解决方案是 MattBagg 和[nmel 的](https://stackoverflow.com/a/13022137/1274242 "nmel's")![在此处输入图像描述](../Images/2d7ea264496b5bc7b17fb68bdb141731.png)答案的混搭，包含在 pdf() 函数中。

```
# libraries
library(VennDiagram)
library(grid)
library(gridBase)
library(lattice)

# create the diagrams
temp1 <- venn.diagram(list(B = 1:1800, A = 1571:2020),
    fill = c("red", "green"), alpha = c(0.5, 0.5), cex = 1,cat.fontface = 2,
    lty =2, filename = NULL)
temp2 <- venn.diagram(list(A = 1:1800, B = 1571:2020),
    fill = c("red", "green"), alpha = c(0.5, 0.5), cex = 1,cat.fontface = 2,
    lty =2, filename = NULL)    

# start new page
plot.new() 

pdf("testpdf", width = 14, height = 7)
# setup layout
gl <- grid.layout(nrow=1, ncol=2)
# grid.show.layout(gl)

# setup viewports
vp.1 <- viewport(layout.pos.col=1, layout.pos.row=1) 
vp.2 <- viewport(layout.pos.col=2, layout.pos.row=1) 

# init layout
pushViewport(viewport(layout=gl))
# access the first position
pushViewport(vp.1)

# start new base graphics in first viewport
par(new=TRUE, fig=gridFIG())

grid.draw(temp2)

# done with the first viewport
popViewport()

# move to the next viewport
pushViewport(vp.2)

  grid.draw(temp2)

# done with this viewport
popViewport(1)

dev.off() 
```

# iphone - 从 iPad 应用程序转换时在 iPhone 屏幕应用程序上安装控件

> ID：14243612
> 
> 赞同：0
> 
> 时间：2013-01-09T18:04:26.473
> 
> 标签：iphone, ios, uiscrollview, screen, infinite-scroll

这可能是我的应用程序特有的问题。我有一个 iPad 应用程序功能。我正在将其转换为 iPhone 应用程序。所以在我的一个 iPad 屏幕上，我有 40-50 个控件（标签、文本字段、按钮等）。现在我也可以在我的 iPhone 上实现类似的功能。iPhone 的屏幕很小，我几乎无法在一个屏幕上放置 20 个控件。我可以有一个长的垂直滚动视图来将我的所有控件放在一个屏幕上。我的意思是用户可以向下和向下滚动并在此 iPhone 屏幕上拥有与 iPad 屏幕上相同的控件，但方向不同。或者我应该把那个屏幕分成多个 UIViewControllers 吗？如果您需要更多信息，请告诉我。谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-09T18:11:21.737

简单的回答：你可以做任何你想做的事。

更详细：你可以像你提到的那样做一个滚动视图，但我相信这将是次优的。您有几个选项来处理设备的差异。您选择的通常取决于视图或其包含的内容量。您可以 1) 简单地为其他设备调整它的大小（这只适用于您有一个简单视图或一个没有太多内容的极少数情况）。2.您为每个创建一个单独的视图控制器并为设备启动适当的视图控制器（根据苹果文档）。您可以在滚动视图中添加视图，但根据具体情况，选项卡视图、导航控制器或其他选项可能会提供更好的用户体验。最终还是看你的...

# image - Matlab - 圆边上的点矩阵

> ID：14243615
> 
> 赞同：-1
> 
> 时间：2013-01-09T18:04:40.127
> 
> 标签：image, matlab

如何在 Matlab 中找到构成任意半径圆的边缘的点矩阵？如果我绘制这些点，我应该得到一个接近圆的东西（尽管一个光滑的圆是由无限数量的点组成的）。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-09T20:38:32.310

```
radius = 5;                                    %desired radius
numPoints = 1000;                              %Number of points in your circle
angles = linspace(0,2*pi,numPoints)';          %Angles evenly spread around the circle, from 0 to 2*pi radians
xyCircle = radius*[cos(angles) sin(angles)];   %This is the matrix you probably want

plot(xyCircle(:,1), xyCircle(:,2),'.'); %Quick plot to check the result
axis equal; 
```

# ruby-on-rails - Rails 3.2.11 编码问题，因为它现在将单引号转换为 html 实体？

> ID：14243617
> 
> 赞同：5
> 
> 时间：2013-01-09T18:04:46.650
> 
> 标签：ruby-on-rails, ruby-on-rails-3

我最近从：gem 'rails'、'3.2.5' 升级到 gem 'rails'、'3.2.11'。

我现在看到以下问题：

**导轨视图：**

```
MagicThing.set({uuid : <%= "'"+Digest::MD5.hexdigest("#{current_user.id.to_s}#{SITE_CONFIG['key']}")+"'" %>}); 
```

对于 Rails 3.2.5，这将正确输出为：

```
MagicThing.set({uuid : '6cea6a412094b5633f2011df59bc86b0'}); 
```

但现在更新到 Rails 3.2.11 后：

```
MagicThing.set({uuid : &#x27;6cea6a412094b5633f2011df59bc86b0&#x27;}); 
```

知道发生了什么导致单引号变成 html 实体。并基于此正确的解决方法？谢谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-09T18:26:43.437

根据[changelog](https://github.com/rails/rails/blob/3-2-stable/activesupport/CHANGELOG.md#rails-328-aug-9-2012)，看起来 Rails 3.2.8 改变了这个：

> ERB::Util.html_escape 现在转义单引号

# php - 实体、存储库和组合 - 依赖注入

> ID：14243619
> 
> 赞同：3
> 
> 时间：2013-01-09T18:04:52.697
> 
> 标签：php, dependency-injection, domain-driven-design, repository-pattern, domain-model

我正在尝试了解 DDD，但有一些关于实体和存储库的事情我无法理解。

从这里的其他问题中，我意识到将存储库注入实体是一个坏习惯。但是当我组合对象时如何避免注入存储库？

让我们有一个简单的情况 - 事件和事件应用程序。这看起来很简单。

```
$event->add($application);
$eventRepository->save($event); 
```

我相信 $application 是一个实体，所以我相信应该有一些 $applicationRepository。

这是否意味着我应该将 $applicationRepository 注入 $eventRepository 以保存 Event 实体？像

```
class eventRepository {

    ...

    public function save(Event $event) {
        ...

        foreach ($event->applications as $app) {
            $this->applicationRepository->save($app);
        }

        ...
    }
} 
```

我想到的另一个解决方案是：

```
$eventService->addAplication($event, $application);

class $eventService {

    ...

    public function addApplication(Event $event, Application $app) {

        // simple example of validation, something like $event->isAplyable()
        if ($event->capacity > count($event->applications)) {
            $this->applicationRepository->save($app);
            $event->addApplication($app);
        }

    }
} 
```

一种方法比另一种更好吗？还是我完全搞砸了？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-09T20:02:32.213

您应该只为每个聚合根拥有一个存储库，并且它们应该独立工作。

所以我可以看到两种场景，你选择哪种取决于业务如何做事：

1.  如果应用程序和事件是两个不同的聚合根（可以将一个应用程序添加到多个事件中并且所有事件都应该引用同一个实体吗？），它们应该使用引用以数据方式绑定在一起，这样当您保存事件，它不会保存应用程序，而只会引用它持有的应用程序。

2.  如果事件是聚合根并且应用程序是与它一起存在、消亡和变化的东西（并且它们共享一致性边界），那么您的事件存储库应该能够将应用程序保存为事件的一部分。现在你没有说你如何持久化数据，但是 ORM 可以帮助你。

希望能有所帮助。并随时问。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-09T19:41:56.140

避免显式调用应用程序存储库的一种方法是让事件存储库持久保存与给定事件关联的应用程序实例。这本质上是您提出的第一个选项，但是根据您使用的持久性框架，代码可能看起来有些不同。例如，一些 ORM 通过可访问性支持持久性，这意味着如果您正在持久化一个事件并且框架发现可以从该事件访问的瞬态应用程序实例，它也会持久化这些实例。在这种情况下，不需要显式的应用程序存储库。

这里的想法是[聚合根](http://devlicio.us/blogs/casey/archive/2009/02/16/ddd-aggregates-and-aggregate-roots.aspx)。如果 an`Event`是聚合根并且 an`Application`是组成值对象，则事件存储库必须能够持久保存整个对象图，包括关联的应用程序实例。DDD 建议每个聚合根有一个存储库，而不一定是每个实体。

可能两者`Event`都是`Application`聚合根（AR）。在这种情况下，不建议在 AR 之间使用直接对象引用，而是使用身份引用。在这种情况下，您的第二个示例将适用，但形式略有不同。事件服务应该是托管与事件相关的特定用例的应用程序服务。其中之一是添加应用程序。不同之处在于该`addApplication`方法应接受事件 ID 和应用程序 ID 作为参数，然后从相应的存储库加载它们。它还能够使用各自的存储库显式地持久化事件和应用程序。

查看[Vaughn Vernon](http://dddcommunity.org/library/vernon_2011)的 Effective Aggregate Design，了解如何确定您的领域中的 AR。

# c# - 使用 nmap 或 .NET 查找 Microsoft SQL 服务器，无需身份验证

> ID：14243621
> 
> 赞同：1
> 
> 时间：2013-01-09T18:04:59.490
> 
> 标签：c#, sql-server, network-programming

我需要根据 IP 地址列表或范围在本地 LAN 上扫描和定位**SQL Server 实例**，我正在寻找以下信息：

1.  **sql server 正在侦听的**端口（常规为****1433/1434**，但可以更改），**
***   **机器的IP地址**，*   **运行 sql server 的机器的**主机名，*******   实例版本如**10.5.2500.0***   实例名称信息，例如**Joe\SQLExpress******

 ****我将无权访问 Windows 或 sql 服务器的任何凭据。赌注是使用 Windows 身份验证，但我更喜欢基于发现的方法。此外，我不想在扫描期间发出错误警报，并且扫描必须是非侵入性的。扫描必须执行几个漏洞测试（稍后），这将涉及检查和进一步的信息，因此不需要每个服务器的任何访问凭据。

此外，某些实例可能已禁用**SQL Server Browser 服务**或已停止**SQL Server 代理服务。**

我需要能够查询给定 IP 地址范围的所有 SQL Server 实例。我一直在尝试在这里使用参数：

1.  [这里](http://nmap.org/nsedoc/scripts/ms-sql-info.html)

和

1.  [这里](http://nmap.org/nsedoc/scripts/ms-sql-config.html)

基于 AC# 的解决方案也可以提供帮助，只要它返回所有实例，无论 SQL Server Browser 或 SQL Server 代理是否正在运行。

但我希望我的扫描尽可能不打扰。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-09T20:49:34.663

对于 SQL Server 2005 及更高版本，有一种使用 WMI 的文档化且受支持的方式，请参阅[常见问题解答：使用 WMI 检测 SQL Server 2005](http://blogs.msdn.com/b/sqlexpress/archive/2006/07/29/682254.aspx)。这将检测任何已安装的实例，无论是否正在运行，并且不会打开与 SQL Server 本身的任何连接。当然，它需要适当的权限才能查询远程*机器*WMI。

对于 SQL 2000，唯一的方法是使用不受支持的注册表黑客（查找特定键）。****

# android - 在多个不同的 Android 设备上加载应用程序的最佳方式是什么？

> ID：14243626
> 
> 赞同：-2
> 
> 时间：2013-01-09T18:05:05.473
> 
> 标签：android, installation, sideloading

我正在进行一项研究，该研究要求我在多部不同品牌和型号的手机上加载我的 Android 应用程序。该研究是具体的（我们不希望公众参与），所以我认为我无法在 Google Play 应用商店上发布该应用。在每部手机上单独加载应用程序真的是我的最佳选择吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-09T18:10:01.437

> 在每部手机上单独加载应用程序真的是我的最佳选择吗？

这取决于您对侧载的定义。许多人认为“Play Store 以外的任何东西”都是侧载，在这种情况下，答案是“是”。

如果您认为侧面加载意味着通过 USB 电缆，您还有其他选择。将 APK 文件放在可从设备访问的 Web 服务器上，配置为提供具有正确 MIME 类型 ( `application/vnd.android.package-archive`) 的 APK 文件。然后，在设备上的 Web 浏览器中访问该 URL，这将触发下载和可选安装。

或者，使用具有原生 Android 客户端的 DropBox 或类似服务，因为它们可以做很多相同的事情。

# delphi - 如何重现此代码完成错误？

> ID：14243629
> 
> 赞同：2
> 
> 时间：2013-01-09T18:05:16.937
> 
> 标签：delphi, delphi-xe2, code-completion

我在 Delphi XE2（更新 4 修补程序 1）上有一个错误，它在我工作的遗留项目中重复了很多次（它从 D6 演变到 D7、D2006，最后是 XE2），但我不知道如何触发它在一个较小的项目中。

最近一次，它在为应用程序上的“隐藏弹出窗口”创建事件处理程序时触发。当我单击菜单选项以创建 Click 处理程序时，会发生这种情况。

```
pprocedure TMainForm.Blablabla1Click(Sender: TObject);
begin

end;

rocedure TMainForm.FormActivate(Sender: TObject); 
```

您可以看到 IDE 在下一个方法的声明中插入了新代码……但这还不是全部。几乎所有时候，在 DPR 上，代码也会被破坏：

```
 AApplication.CreateForm(TDM_DataAcc, DM_DataAcc);
  AApplication.CreateForm(TMainForm, MainForm);
  pplication.CreateForm(Tfrm_login, frm_login);
  f frm_Login.CanLogin = mrOK then Application.Run 
```

（几乎就是这样，我不记得第 3 个 Application.CreateForm 是否剪裁了它的“A”，另一个我确定是加倍的，并且`IF`它的“I”剪裁了）。

追逐 QualityCentral 无济于事（一无所获）。这有时也会发生在类完成（Ctrl-SHIft-C）上。

有人知道是什么触发了这个错误，所以我可以创建一个新应用程序并将其发送到 Embarcadero？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-09T18:59:47.857

这样的行为表明 IDE 对文件中的字符计数错误。开发人员可能没有预料到有几个“文件异常”，这可能会导致字符索引计算错误。

*   检查您的文件是否有异常的行尾。例如，缺少回车的行将在编辑器中正确显示，但可能导致程序中其他地方的行号不正确。

*   不间断空格是另一种将正常出现的字符，甚至可能正确解析，但是当以 UTF-8 表示时，当字符的“正常”版本（常规空格）只占用一个字节时，它会占用多个字节。如果您从 Web 浏览器复制代码，有时会获得此类字符。

*   UTF-8 或 UTF-16 源文件的错误字节顺序标记也可能导致问题。

通常，在记事本或十六进制编辑器中打开源文件将帮助您识别这些问题。

# powershell - 带代理的 Powershell Web

> ID：14243631
> 
> 赞同：0
> 
> 时间：2013-01-09T18:05:21.983
> 
> 标签：powershell, powershell-2.0

我的脚本出现代理错误。“远程服务器返回错误：(407) 需要代理身份验证。”

IE 使用脚本来配置它的连接（这就是我所拥有的所有信息）。我在那里查看并在我的脚本中尝试了一些 IP/端口，但似乎没有一个工作。有没有其他方法可以在 PS 中使用这个 IE 连接脚本？

```
$web_client = New-Object System.Net.WebClient;
$web_client.Headers.Add("user-agent", "PowerWeb");

$proxyAddr =  "http://172.16.192.34:9090" 
$proxy = new-object System.Net.WebProxy
$proxy.useDefaultCredentials = $true

$proxy.Address = $proxyAddr

$web_client.proxy = $proxy

$data = $web_client.DownloadData("http://stackoverflow.com") 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-11T21:57:41.720

如果您使用的是 PowerShell 3.0，则可以使用`Invoke-WebRequest`

# database - 在数据库中存储匿名信息

> ID：14243633
> 
> 赞同：1
> 
> 时间：2013-01-09T18:05:29.583
> 
> 标签：database, security

我们的应用程序将存储来自用户的一些信息，我们不希望这些信息被追溯到数据库中的任何其他记录。例如（尽管很愚蠢）——用户必须付费才能匿名告诉我们他们最喜欢的颜色是什么。我们希望将每个颜色记录作为新行存储在数据库中并跟踪交易信息。

如果我们将颜色和事务存储在单独的表中，如果服务器被黑客入侵，这些行可以相互关联，通过使用行的顺序 ID（因为颜色总是有一个事务）或通过创建时间排。所以为了解决这个问题，我们不会有颜色表的顺序 ID 列，或者颜色表的更新/修改时间。

现在，将颜色与事务相关联的唯一方法是查看用于实际存储数据库信息的文件。虽然这可能既困难又乏味，但我想这仍然是可能的，因为颜色表信息可能会按顺序存储在文件中。

**如何将数据库信息存储在无序的事物中，这样就不会发生这种情况？** 我想一个更普遍的问题是我如何匿名和安全地存储信息？（但这太宽泛了）

显然，答案是不要让您的数据库被黑客入侵，但不是一个好的数据库。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-09T18:07:11.053

您可以预先生成数百万行并随机填充它们。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-09T21:31:38.300

如果您需要分析数据，则需要了解它，如果可以，攻击者也可以。无论您想出什么聪明的解决方案，相关性仍然是可能的。关系数据库事务日志，将显示插入更新删除的内容、时间和位置。因此，如果您想使用相同的数据库，则无法提供 100% 的数据解耦。您可以使用一些 HSM 加密数据，这会使被盗数据对攻击者毫无用处。或者您可以将数据存储在具有随机延迟或一些批处理的其他机器上（等待并插入 20 条记录而不是一条）......但这可能很棘手并且可能会失败。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-09T18:17:48.643

考虑利用非现实数据库，例如[NoSQL](http://en.wikipedia.org/wiki/NoSQL)。

# android - 通知在模拟器中有效，但在电话中无效

> ID：14243634
> 
> 赞同：2
> 
> 时间：2013-01-09T18:05:30.847
> 
> 标签：android, android-notifications

所以这是一个简单的应用程序，它从用户那里获取两个文本输入，然后在按钮上单击它会创建通知。这是代码：

```
package com.dewey.notifymanager;

import android.os.Bundle;
import android.app.Activity;
import android.app.Notification;
import android.app.NotificationManager;
import android.content.Context;
import android.view.Menu;
import android.view.View;
import android.widget.Button;
import android.widget.EditText;
import android.widget.TextView;

public class MainActivity extends Activity {

    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_main);
        final Button button = (Button) findViewById(R.id.button1);
        final TextView texty = (TextView) findViewById(R.id.textView2);
        final EditText input = (EditText) findViewById(R.id.editText1);
        final EditText input2 = (EditText) findViewById(R.id.editText2);
        button.setOnClickListener(new View.OnClickListener() {
            public void onClick(View v) {

                String notificationmessage = input.getText().toString();
                String notificationdetails = input2.getText().toString();
                texty.setText("Notification Created");
                displayNotification(notificationmessage, notificationdetails);
            }
        });
    }
    @Override
    protected void onStart() {

    super.onStart();

    }
    @Override
    public boolean onCreateOptionsMenu(Menu menu) {
        getMenuInflater().inflate(R.menu.activity_main, menu);
        return true;
    }

    public void displayNotification(String msg,String details)
    {
    NotificationManager manager = (NotificationManager) getSystemService(Context.NOTIFICATION_SERVICE);
    Notification notification = new Notification(R.drawable.ic_launcher, msg, System.currentTimeMillis());

    notification.setLatestEventInfo(this, msg, details, null);
    int num = 0;
    manager.notify(num, notification);

    }

} 
```

该应用程序在模拟器上运行并显示通知： ![模拟器](../Images/a5858669258b26e323dba37287a58f2c.png)

但是当我在手机上运行它时，点击按钮时不会显示通知，当我在运行 Android 2.3 的手机上运行它时，应用程序崩溃并在点击按钮时意外停止。

这是日志猫：

```
01-09 13:21:29.653: D/AndroidRuntime(981): >>>>>> AndroidRuntime START com.android.internal.os.RuntimeInit <<<<<<
01-09 13:21:29.653: D/AndroidRuntime(981): CheckJNI is ON
01-09 13:21:30.773: D/AndroidRuntime(981): Calling main entry com.android.commands.pm.Pm
01-09 13:21:30.832: D/AndroidRuntime(981): Shutting down VM
01-09 13:21:30.842: D/dalvikvm(981): GC_CONCURRENT freed 101K, 78% free 462K/2048K, paused 1ms+2ms
01-09 13:21:30.853: D/dalvikvm(981): Debugger has detached; object registry had 1 entries
01-09 13:21:30.872: I/AndroidRuntime(981): NOTE: attach of thread 'Binder Thread #3' failed
01-09 13:21:31.863: D/AndroidRuntime(994): >>>>>> AndroidRuntime START com.android.internal.os.RuntimeInit <<<<<<
01-09 13:21:31.863: D/AndroidRuntime(994): CheckJNI is ON
01-09 13:21:32.912: D/AndroidRuntime(994): Calling main entry com.android.commands.am.Am
01-09 13:21:32.952: I/ActivityManager(85): Force stopping package com.dewey.notifymanager uid=10040
01-09 13:21:32.952: I/Process(85): Sending signal. PID: 965 SIG: 9
01-09 13:21:32.973: I/ActivityManager(85):   Force finishing activity ActivityRecord{415d64e0 com.dewey.notifymanager/.MainActivity}
01-09 13:21:33.002: W/InputDispatcher(85): channel '4160dde0 com.dewey.notifymanager/com.dewey.notifymanager.MainActivity (server)' ~ Consumer closed input channel or an error occurred.  events=0x8
01-09 13:21:33.002: E/InputDispatcher(85): channel '4160dde0 com.dewey.notifymanager/com.dewey.notifymanager.MainActivity (server)' ~ Channel is unrecoverably broken and will be disposed!
01-09 13:21:33.002: I/WindowManager(85): WIN DEATH: Window{4160dde0 com.dewey.notifymanager/com.dewey.notifymanager.MainActivity paused=true}
01-09 13:21:33.002: W/InputDispatcher(85): Attempted to unregister already unregistered input channel '4160dde0 com.dewey.notifymanager/com.dewey.notifymanager.MainActivity (server)'
01-09 13:21:33.092: I/WindowManager(85): WINDOW DIED Window{4160dde0 com.dewey.notifymanager/com.dewey.notifymanager.MainActivity paused=true}
01-09 13:21:33.092: I/ActivityManager(85): START {act=android.intent.action.MAIN cat=[android.intent.category.LAUNCHER] flg=0x10000000 cmp=com.dewey.notifymanager/.MainActivity} from pid 994
01-09 13:21:33.103: W/WindowManager(85): Failure taking screenshot for (180x300) to layer 21045
01-09 13:21:33.193: D/AndroidRuntime(994): Shutting down VM
01-09 13:21:33.223: D/dalvikvm(1004): Not late-enabling CheckJNI (already on)
01-09 13:21:33.223: I/AndroidRuntime(994): NOTE: attach of thread 'Binder Thread #3' failed
01-09 13:21:33.223: D/dalvikvm(994): GC_CONCURRENT freed 102K, 77% free 485K/2048K, paused 1ms+1ms
01-09 13:21:33.223: D/jdwp(994): Got wake-up signal, bailing out of select
01-09 13:21:33.233: D/dalvikvm(994): Debugger has detached; object registry had 1 entries
01-09 13:21:33.263: I/ActivityManager(85): Start proc com.dewey.notifymanager for activity com.dewey.notifymanager/.MainActivity: pid=1004 uid=10040 gids={}
01-09 13:21:33.733: W/NetworkManagementSocketTagger(85): setKernelCountSet(10040, 1) failed with errno -2
01-09 13:21:34.023: W/ActivityThread(1004): Application com.dewey.notifymanager is waiting for the debugger on port 8100...
01-09 13:21:34.042: I/System.out(1004): Sending WAIT chunk
01-09 13:21:34.064: I/dalvikvm(1004): Debugger is active
01-09 13:21:34.242: I/System.out(1004): Debugger has connected
01-09 13:21:34.242: I/System.out(1004): waiting for debugger to settle...
01-09 13:21:34.553: I/System.out(1004): waiting for debugger to settle...
01-09 13:21:34.752: I/System.out(1004): waiting for debugger to settle...
01-09 13:21:34.962: I/System.out(1004): waiting for debugger to settle...
01-09 13:21:35.162: I/System.out(1004): waiting for debugger to settle...
01-09 13:21:35.362: I/System.out(1004): waiting for debugger to settle...
01-09 13:21:35.563: I/System.out(1004): waiting for debugger to settle...
01-09 13:21:35.782: I/System.out(1004): waiting for debugger to settle...
01-09 13:21:36.024: I/System.out(1004): waiting for debugger to settle...
01-09 13:21:36.281: I/System.out(1004): waiting for debugger to settle...
01-09 13:21:36.525: I/System.out(1004): waiting for debugger to settle...
01-09 13:21:36.734: I/System.out(1004): waiting for debugger to settle...
01-09 13:21:36.940: I/System.out(1004): waiting for debugger to settle...
01-09 13:21:37.148: I/System.out(1004): waiting for debugger to settle...
01-09 13:21:37.357: I/System.out(1004): debugger has settled (1477)
01-09 13:21:39.322: D/dalvikvm(85): GREF has increased to 501
01-09 13:21:39.473: D/gralloc_goldfish(1004): Emulator without GPU emulation detected.
01-09 13:21:39.622: I/ActivityManager(85): Displayed com.dewey.notifymanager/.MainActivity: +6s463ms
01-09 13:21:40.053: W/NetworkManagementSocketTagger(85): setKernelCountSet(10004, 0) failed with errno -2
01-09 13:21:42.673: D/dalvikvm(85): GC_CONCURRENT freed 488K, 7% free 12839K/13767K, paused 8ms+50ms
01-09 13:21:42.862: D/dalvikvm(139): GC_CONCURRENT freed 408K, 34% free 11007K/16519K, paused 5ms+10ms
01-09 13:21:46.232: D/dalvikvm(139): GC_FOR_ALLOC freed 400K, 34% free 10990K/16519K, paused 316ms
01-09 13:21:51.422: D/PhoneStatusBar(139): panel: ACTION_DOWN at (191.000000, 2.000000) mDisabled=0x00000000
01-09 13:21:51.422: D/PhoneStatusBar(139): panel: beginning to track the user's touch, y=2 opening=true
01-09 13:21:53.452: D/PhoneStatusBar(139): panel: ACTION_UP at (277.000000, 168.000000) mDisabled=0x00000000
01-09 13:21:53.462: D/PhoneStatusBar(139): gesture: vraw=(48.303123,-210.310593) vnorm=(48.303123,-210.310593) vlinear=-215.786316
01-09 13:21:53.462: D/PhoneStatusBar(139): panel: will fling, y=204 vel=-215.78632
01-09 13:21:54.012: W/InputManagerService(85): Window already focused, ignoring focus gain of: com.android.internal.view.IInputMethodClient$Stub$Proxy@415cf110
01-09 13:21:54.412: I/ActivityManager(85): START {act=android.intent.action.MAIN cat=[android.intent.category.HOME] flg=0x10200000 cmp=com.android.launcher/com.android.launcher2.Launcher} from pid 85
01-09 13:21:54.412: W/WindowManager(85): Failure taking screenshot for (180x300) to layer 21050
01-09 13:21:54.452: W/NetworkManagementSocketTagger(85): setKernelCountSet(10004, 1) failed with errno -2
01-09 13:21:55.842: W/InputManagerService(85): Starting input on non-focused client com.android.internal.view.IInputMethodClient$Stub$Proxy@415fb440 (uid=10040 pid=1004)
01-09 13:21:55.882: W/IInputConnectionWrapper(1004): showStatusIcon on inactive InputConnection
01-09 13:21:56.974: W/NetworkManagementSocketTagger(85): setKernelCountSet(10040, 0) failed with errno -2 
```

我的清单有问题吗？：

```
<uses-sdk
    android:minSdkVersion="8"
    android:targetSdkVersion="15" />

<application
    android:icon="@drawable/ic_launcher"
    android:label="@string/app_name"
    android:theme="@style/AppTheme" >
    <activity
        android:name=".MainActivity"
        android:label="@string/title_activity_main" >
        <intent-filter>
            <action android:name="android.intent.action.MAIN" />

            <category android:name="android.intent.category.LAUNCHER" />
        </intent-filter>
    </activity>
</application> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-09T22:26:36.893

您的应用程序需要设置 PendingIntent，这是 setLatestEventInfo() 所要求的。所以替换：

```
notification.setLatestEventInfo(this, msg, details, null); 
```

和

```
Intent intent = new Intent(this, MainActivity.class);
PendingIntent pendingIntent = PendingIntent.getActivity(this, 0, intent, 0);
notification.setLatestEventInfo(this, msg, details, pendingIntent); 
```

这将使您的应用程序工作，但此外，我强烈建议您在 Apilevels 之间进行区分。您的应用程序可能如下所示：

```
public class MainActivity extends Activity {

    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_main);
        final Button button = (Button) findViewById(R.id.button1);
        final TextView texty = (TextView) findViewById(R.id.textView2);
        final EditText input = (EditText) findViewById(R.id.editText1);
        final EditText input2 = (EditText) findViewById(R.id.editText2);
        button.setOnClickListener(new View.OnClickListener() {
            public void onClick(View v) {

                String notificationmessage = input.getText().toString();
                String notificationdetails = input2.getText().toString();
                texty.setText("Notification Created");
                displayNotification(notificationmessage, notificationdetails);
            }
        });
    }

    @Override
    protected void onStart() {
        super.onStart();
    }

    @Override
    public boolean onCreateOptionsMenu(Menu menu) {
        getMenuInflater().inflate(R.menu.activity_main, menu);
        return true;
    }

    /**
     * Show a notification while this service is running.
     * 
     */
    private void displayNotification(String msg, String details) {
        int num = 0;
        NotificationManager manager = (NotificationManager) getSystemService(Context.NOTIFICATION_SERVICE);
        Intent intent = new Intent(this, MainActivity.class);
        PendingIntent pendingIntent = PendingIntent.getActivity(this, 0,
                intent, 0);
        int currentapiVersion = android.os.Build.VERSION.SDK_INT;
        if (currentapiVersion <= 8) {
            manager.notify(num,
                    createNotificationApi8(msg, details, pendingIntent));
        } else {
            manager.notify(num,
                    createNotificationApi14(msg, details, pendingIntent));
        }
    }

    @TargetApi(value = 14)
    private Notification createNotificationApi14(String msg, String details,
            PendingIntent intent) {
        Notification.Builder builder = new Builder(getApplicationContext());
        builder.setSmallIcon(R.drawable.ic_launcher);
        builder.setContentTitle(msg);
        builder.setContentIntent(intent);
        builder.setContentInfo(details);
        Notification notification = builder.getNotification();
        return notification;
    }

    @TargetApi(value = 8)
    private Notification createNotificationApi8(String msg, String details,
            PendingIntent intent) {
        Notification notification = new Notification(R.drawable.ic_launcher,
                msg, System.currentTimeMillis());
        notification.setLatestEventInfo(this, msg, details, intent);
        return notification;
    }
} 
```

我希望这对你有帮助，否则请告诉我。安达克

# iphone - FBLoginView iPhone 视图

> ID：14243640
> 
> 赞同：0
> 
> 时间：2013-01-09T18:05:51.793
> 
> 标签：iphone, ios, objective-c, facebook, ios6

在当前 3.1 Facebook SDK 中使用 FBLoginView 不会产生我认为它应该产生的输出。生成一个基本的 [[FBLoginView alloc] init]; 和框架当前视图控制器框架的大小，它只显示下面没有“登录”按钮：

[http://cl.ly/image/1t102j1t452l](http://cl.ly/image/1t102j1t452l)

使 FBLoginView 正确显示需要什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-09T18:36:06.470

试试这个：

在 .h 文件中：

```
Use this delegate <FBLoginViewDelegate>

FBLoginView *loginview; 
```

in.m 文件中的一些方法：

```
if(!loginView)
 loginView = [[FBLoginView alloc] initWithPermissions:[NSArray arrayWithObject:@"publish_actions, user_photos,status_update"]]; // Whatever permissions you need

loginview.frame = self.view.bounds; //whatever you want

loginview.delegate = self;

[self.view addSubview:loginview]; 
```

添加这些方法：

```
- (void)loginViewShowingLoggedInUser:(FBLoginView *)loginView {

    NSLog(@"Logged In");

}

- (void)loginViewFetchedUserInfo:(FBLoginView *)loginView
                            user:(id<FBGraphUser>)user {
NSLog(@"user Id %@",user.id);

}
- (void)loginViewShowingLoggedOutUser:(FBLoginView *)loginView {
    // Called after logout
    NSLog(@"Logged out");
} 
```

希望这可以帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-17T17:04:25.723

我注意到我的项目中缺少**FacebookSDKResources.bundle**。当我添加它时，它开始工作。

# python - 使用 Google AppEngine 时 Web2py 缺少调试信息还是我做错了什么？

> ID：14243642
> 
> 赞同：0
> 
> 时间：2013-01-09T18:05:54.770
> 
> 标签：python, google-app-engine, web2py

当我对我创建的用户进行 HTTP 发布编辑时，我遇到了一个“非常简单”的 python 错误。

错误如下，但在editar_usuario.html的第115行，我只有一个“空白行”。下面的日志是我从“GAE SDK 日志控制台”获得的……这就是我必须使用的全部内容！

```
File "D:\Dropbox\Devel\www\web2py\gluon\restricted.py", line 212, in restricted
exec ccode in environment
File "D:\Dropbox\Devel\www\web2py\applications\init\views\adm/editar_usuario.html", line 115, in  <module>
TypeError: 'NoneType' object is not callable 
```

在浏览器中，我只有这几行，没有创建票证。

```
Internal error
Ticket issued: unknown 
```

在 Google App Engine 上查找错误和调试 Web2py 应用程序通常很难吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-09T18:37:59.930

> 在 Google App Engine 上查找错误和调试 Web2py 应用程序通常很难吗？

相比什么？我对 Google App Engine 和 Web2py 的体验很糟糕，主要是因为我使用的是 App Engine，它的定价计划很糟糕，而且很难确定问题是来自它们还是来自 Web2py 框架。

对我的数据的有限访问尤其令人讨厌。我切换到使用 Webfaction 的共享托管计划，在那里我获得了完全的控制权，但不幸的是，与 Django 相比，Web2py 是内存密集型的。我将我的网站从 Web2py 切换到 Django，尽管我喜欢 Web2py 的那个人；Massimo、Bruno、Jonathan 等... Django 是更好的框架和更好的支持。

您不仅要调试 Web2py 可能出现的问题，而且可能与它们无关，并且与某种导致冲突或只是一般错误的 App Engine 更新有关。如果我还没有表达我的观点，我认为对于任何试图启动他们的项目的人来说，Google App Engine 都是一个可怕的想法。我永远不会回到他们身边……永远。

# javascript - 骨干集合 - 如何过滤与其他集合的集合？

> ID：14243643
> 
> 赞同：1
> 
> 时间：2013-01-09T18:05:59.640
> 
> 标签：javascript, backbone.js, underscore.js

我有两个收藏：

*   **`A`**用`model1`, `model2`, `model3`,**收集**`model4`。

*   **`B`**与`model2`,的**集合**`model3`。

例如：

```
var model1 = new models.ExModel({id: "1", name: "model1"});
var model2 = new models.ExModel({id: "2", name: "model2"});
var model3 = new models.ExModel({id: "3", name: "model3"});
var model4 = new models.ExModel({id: "4", name: "model4"});

var A = new collections.ExCol([ model1, model2, model3, model4 ]);
var B = new collections.ExCol([ model2, model3 ]); 
```

我想获得一组`A`不包含在`B`. 例如，我想得到一个带有`model1`and的数组`model4`。我怎样才能最有效地做到这一点？

我想了两种方法来做到这一点，但我不知道是否是最好的方法。我认为 Option1 比 Option2 更有效。

选项1：

```
var idsB = B.pluck("id");
var result = A.filter( function(m) { return idsB.indexOf(m.id) === -1; } ); 
```

选项2：

```
var result = A.filter( function(m) { return !B.contains(m); }); 
```

完整示例：http: [//jsfiddle.net/VH3HU/](http://jsfiddle.net/VH3HU/)

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-09T18:26:23.720

使用可以使用下划线的方法`_.difference`。[http://underscorejs.org/#difference](http://underscorejs.org/#difference)

```
var results = _.difference(A.models, B.models); 
```

# java - 关于 Map 中的编译时错误

> ID：14243644
> 
> 赞同：0
> 
> 时间：2013-01-09T18:06:03.763
> 
> 标签：java, list, map, linkedhashmap

请不要认为这个问题是重复的，尽管我之前有一个类似的问题，但这次不同..

```
Map m = new LinkedHashMap();
m.put ("123", "23"); 
m.put ("323", "23");
m.put ("153", "23");
m.put ("623", "23");
m.put ("125", "23");
m.put ("122", "24");
m.put ("167", "24");
m.put ("173", "24");
m.put ("113", "25"); 
```

现在我的查询是我需要找出与患者 ID 23 相关联的脚本有多少，如上所示，总共有 5 个不同的脚本，

这个我做过。。

```
List<String> keys = new ArrayList<String>();
        for(String str: m.keySet())
        {
            if(m.get(str).equals("23")) {
                keys.add(str);
            }
        } 
```

但它显示编译器错误无法将对象转换为字符串请告知。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-09T18:07:48.753

改变

```
Map m = new LinkedHashMap(); 
```

至

```
Map <String,String>m = new LinkedHashMap<String,String>(); 
```

所以它知道它是一个指向字符串的字符串映射。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-09T18:07:55.910

“无法将对象转换为字符串，请告知”<-这是正常的，因为您的`Map`声明不允许这样做。

你应该声明：

```
Map<String, String> m = new LinkedHashMap<String, String>(); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-09T18:09:19.493

您尚未将 Map 定义为字符串 Map。因此，您正在迭代的键集是一组对象。尝试将您的 Map 声明更改为：

```
Map<String, String> m = new LinkedHashMap<String, String>(); 
```

# image - 从图像测量真实物体

> ID：14243645
> 
> 赞同：0
> 
> 时间：2013-01-09T18:06:04.323
> 
> 标签：image, image-processing, artificial-intelligence

我要准备我的作业。不过，作为我们的老师，这有点怪异：D。好吧，工作很简单。垂直会有一块白布。一个人会在前面。人与布的距离是 3 英尺。人物的影子将通过中分辨率（比如 1600 X 1200）相机捕捉到。这台相机的图像（img01.jpg）是我的输入。我必须从图像中测量男人的身体，我的意思是身体的一部分。我需要 80% 到 90% 的准确率。所需的输出是一些长度（厘米）：

A = ?

乙 = ?

C = ?

D = ?

E = ?

就像图片一样：

![在此处输入图像描述](../Images/63fb2b959d21ac54f352d82be4718b62.png)

我不知道这里需要什么类型的算法，我也不想问我怪异的先生。请伟大的心来帮助我。不要问我我的代码，因为我还没有。我不需要代码，而是需要算法来完成这项工作。

提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-09T18:09:27.440

找出点之间的像素数，然后根据拍摄对象与相机的距离乘以每像素的厘米数。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-09T18:09:33.367

给定一个垂直偏移量，一种可能的算法是`y`在同一行上找到第一个彩色（或在您的情况下为黑色）像素和最后一个像素之间的距离（以像素为单位）`y`。然后，一旦您修复了像素和真实世界测量之间的比例，您就可以使用您认为方便的单位转换。如您的示例所示，此答案将有效，假设距离是水平测量的，而不是在图中对角线测量的。

# sql - MS Access、Excel、SQL 和新表

> ID：14243653
> 
> 赞同：2
> 
> 时间：2013-01-09T18:06:43.920
> 
> 标签：sql, ms-access-2010

我刚开始使用 MS Access 2010 并进行了以下设置。3 个 excel 文件：masterlist.x（包含我销售的所有产品）、vender1.x（包含来自 vender1 的所有产品，我只销售其中一些产品）和 vender2.x（同样，包含来自 vender2 的所有产品，我只销售其中一些产品）。这是一个示例数据收集：

```
masterlist.x
ID     NAME     PRICE
23     bananas  .50
33     apples   .75
35     nuts     .87
38     raisins  .25

vender1.x
ID     NAME     PRICE
23     bananas  .50
25     pears    .88

vender2.x
ID     NAME     PRICE
33     apples   .75
35     nuts     .87
38     raisins  .25
49     kiwis    .88 
```

供应商列表会定期更新出售的新商品和新价格。例如，vender1 将香蕉的价格提高到 0.75 美元，我的 masterlist.x 需要更新以反映这一点。

我现在在哪里：我知道如何将 3 个 excel 图表导入 Access。从那里开始，我一直在研究是否需要设置关系、创建宏或 SQL 查询来实现我的目标。不一定要寻找解决方案，但指出正确的方向会很棒！

此外，一旦 masterlist.x 表更新，我将使用什么功能来查看哪些行项目受到影响？

更新：发现 SQL /JOIN/ 并具有以下内容：

```
SELECT * FROM master
LEFT JOIN vender1
ON master.ID = vender1.ID
where master.PRICE <> vender1.PRICE; 
```

这给了我输出（对于上述场景）

```
ID     NAME     PRICE    ID     NAME     PRICE
23     bananas  .50      23     bananas  .75 
```

什么功能会给我：

```
masterlist.x
ID     NAME     PRICE
23     bananas  .75
33     apples   .75
35     nuts     .87
38     raisins  .25 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-09T19:47:10.643

这是一个提醒，因为您正在寻求设计创意。我真的不喜欢你当前的表模式。以下查询是在 SQL Server 2008 中构建的，这是我可以在 sqlfiddle 中获得的最接近 MS Access SQL 的语法。

请看一下：

*   [SQLFIDDLE 演示](http://sqlfiddle.com/#!3/c8467/3)

建议的表设计：

`vendor`桌子：

```
VID     VNAME
1       smp farms
2       coles
3       cold str
4       Anvil NSW 
```

`product`桌子：

```
PID     VID     PNAME       PPRICE
203     2       bananas     0.5
205     2       pears       0.88
301     3       bananas     0.78
303     3       apples      0.75
305     3       nuts        0.87
308     3       raisins     0.25
409     4       kiwis       0.88 
```

`masterlist`：

```
ID  PID     MPRICE
1   203     0.5
2   303     0.75
3   305     0.87
4   308     0.25 
```

加入查询可以轻松更新您的`masterlist`现在。例如：

当供应商更新他们为您提供的水果的价格时。或者当他们停止供应该产品时。您可以根据需要使用`where`子句将条件添加到查询中。

询问：

```
SELECT m.id, p.vid, p.pname, p.pprice
FROM masterlist m
LEFT JOIN product p ON p.pid = m.pid
; 
```

结果：

```
ID  VID     PNAME       PPRICE
1   2   bananas     0.5
2   3   apples      0.75
3   3   nuts        0.87
4   3   raisins     0.25 
```

请给出意见。如果有任何疑问，很乐意为您提供帮助。

# cuda - CUDA 全球屏障——适用于开普勒而不是费米

> ID：14243654
> 
> 赞同：0
> 
> 时间：2013-01-09T18:06:51.790
> 
> 标签：cuda

以下全局屏障适用于 Kepler K10 而不是 Fermi GTX580：

```
__global__ void cudaKernel (float* ref1, float* ref2, int* lock, int time, int dim) {
  int gid  = blockIdx.x * blockDim.x + threadIdx.x;
  int lid  = threadIdx.x;                          
  int numT = blockDim.x * gridDim.x;               
  int numP = int (dim / numT);                     
  int numB = gridDim.x;

  for (int t = 0; t < time; ++t) {
    // compute @ time t
    for (int i = 0; i < numP; ++i) {
      int idx  = gid + i * numT;
      if (idx > 0 && idx < dim - 1)
        ref2 [idx]  = 0.333f * ((ref1 [idx - 1] + ref1 [idx]) + ref1 [idx + 1]);
    }

    // global sync
    if (lid == 0){
      atomicSub (lock, 1);
      while (atomicCAS(lock, 0, 0) != 0);
    }
    __syncthreads();

    // copy-back @ time t
    for (int i = 0; i < numP; ++i) {
      int idx  = gid + i * numT;
      if (idx > 0 && idx < dim - 1)
        ref1 [idx]  = ref2 [idx];
    }

    // global sync
    if (lid == 0){
      atomicAdd (lock, 1);
      while (atomicCAS(lock, numB, numB) != numB);
    }
    __syncthreads();
  }
} 
```

因此，通过查看发送回 CPU 的输出，我注意到一个线程（第一个或最后一个线程）逃脱了屏障并比其他线程更早地恢复执行。我正在使用 CUDA 5.0。块的数量也总是小于 SM 的数量（在我的一组运行中）。

知道为什么相同的代码不能在两种架构上运行吗？Kepler 中有哪些新功能有助于实现全球同步？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-09T22:55:40.367

所以我怀疑屏障代码本身可能以相同的方式工作。似乎与障碍功能本身无关的其他数据结构上发生的事情是有问题的。

Niether Kepler 和 Fermi 都有彼此一致的 L1 缓存。您发现（尽管它与您的屏障代码本身无关）是[Kepler](http://docs.nvidia.com/cuda/kepler-tuning-guide/index.html#l1-cache)和[Fermi](http://www.nvidia.com/content/PDF/fermi_white_papers/NVIDIA_Fermi_Compute_Architecture_Whitepaper.pdf)之间的 L1 缓存行为不同。

特别是，如上述链接所述，Kepler L1 缓存在全局负载上不起作用，因此缓存行为在设备范围的 L2 级别处理，因此是一致的。当 Kepler SMX 读取它的全局数据时，它会从 L2 获得一致的值。

另一方面，Fermi 具有也参与全局加载的 L1 缓存（默认情况下 - 尽管可以关闭此行为），并且上面链接中描述的 L1 缓存对于每个 Fermi SM 都是唯一的，并且与其他 SM 中的 L1 缓存。当 Fermi SM 读取它的全局数据时，它从 L1 获取值，这可能与其他 SM 中的其他 L1 缓存不一致。

这就是您所看到的“一致性”的差异，即您在障碍之前和之后操纵的数据。

正如我所提到的，我相信屏障代码本身可能在两种设备上的工作方式相同。

# java - 是否可以编写自己的对象来发出 ActionEvents？

> ID：14243657
> 
> 赞同：1
> 
> 时间：2013-01-09T18:07:10.013
> 
> 标签：java, custom-controls, awt, event-dispatch-thread, actionevent

我查看了在线的 java 教程，它们似乎都关心捕获其他已经编写的组件发出的 ActionEvents。是否可以编写自己的对象，这些对象具有自己的一组触发 actionEvents 的条件，然后可以被其他注册为侦听器的类捕获？

例如：如果我想要一个正在计数绵羊的对象在所有已注册为侦听器的睡眠对象计数 100 只时发送一个 actionEvent。

有没有办法做到这一点，网上有教程吗？

任何帮助是极大的赞赏。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-09T18:53:14.703

是的，这很简单，只要有人向您展示如何创建自己的听众。

首先，您创建自己的 EventObject。这是我的一个项目的一个例子。

```
import gov.bop.rabid.datahandler.bean.InmateDataBean;

import java.util.EventObject;

public class InmatePhotoEventObject extends EventObject {

    private static final long serialVersionUID = 1L;

    protected InmateDataBean inmate;

    public InmatePhotoEventObject(Object source) {
        super(source);
    }

    public InmateDataBean getInmate() {
        return inmate;
    }

    public void setInmate(InmateDataBean inmate) {
        this.inmate = inmate;
    }

} 
```

这个类没有什么特别的，除了它扩展了EventObject。您的构造函数由 EventObject 定义，但您可以创建任何您想要的方法。

其次，定义一个 EventListener 接口。

```
public interface EventListener {

    public void handleEvent(InmatePhotoEventObject eo);

} 
```

您将使用您创建的 EventObject。您可以使用任何您想要的方法名称或名称。这是将作为对侦听器的响应而编写的代码的接口。

第三，您编写一个 ListenerHandler。这是我来自同一个项目的。

```
import gov.bop.rabid.datahandler.bean.InmateDataBean;
import gov.bop.rabid.datahandler.main.EventListener;
import gov.bop.rabid.datahandler.main.InmatePhotoEventListener;
import gov.bop.rabid.datahandler.main.InmatePhotoEventObject;

import java.util.ArrayList;
import java.util.List;

public class InmatePhotoListenerHandler {

    protected List<EventListener> listeners;

    public InmatePhotoListenerHandler() {
        listeners = new ArrayList<EventListener>();
    }

    public void addListener(EventListener listener) {
        listeners.add(listener);
    }

    public void removeListener(EventListener listener) {
        for (int i = listeners.size() - 1; i >= 0; i--) {
            EventListener instance = listeners.get(i);
            if (instance.equals(listener)) {
                listeners.remove(i);
            }
        }
    }

    public void fireEvent(final InmatePhotoEventObject eo, 
            final InmateDataBean inmate) {
        for (int i = 0; i < listeners.size(); i++) {
            final EventListener instance = listeners.get(i);
            Runnable runnable = new Runnable() {
                public void run() {
                    eo.setInmate(inmate);
                    instance.handleEvent(eo);
                }

            };
            new Thread(runnable).start();
        }
    }

    public static void main(String[] args) {
        System.out.println("This line goes in your DataHandlerMain class "
                + "constructor.");
        InmatePhotoListenerHandler handler = new InmatePhotoListenerHandler();
        System.out.println("I need you to put the commented method in "
                + "DataHandlerMain so I can use the handler instance.");

        // public InmatePhotoListenerHandler getInmatePhotoListenerHandler() {
        //      return handler;
        // }

        System.out.println("This line goes in the GUI code.");
        handler.addListener(new InmatePhotoEventListener());

        System.out.println("Later, when you've received the response from "
                + "the web service...");
        InmateDataBean inmate = new InmateDataBean();
        inmate.setIntKey(23);
        handler.fireEvent(new InmatePhotoEventObject(handler), inmate);
    }
} 
```

此类中的主要方法向您展示了如何使用 ListenerHandler。类中的其余方法是标准的。您将使用自己的 EventObject 和 EventListener。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-09T18:19:09.927

是的。

我建议您查看 ActionEvent 和 EventListenerList 的 java API 文档。

我还建议您阅读有关侦听器（也称为观察者）模式的信息。

# java - Java，序列化非静态内部类。有诀窍吗？

> ID：14243664
> 
> 赞同：0
> 
> 时间：2013-01-09T18:07:35.673
> 
> 标签：java

我想在我的 java 程序中序列化一个非静态内部类。虽然这是不允许的，因为我的内部类（默认情况下）引用了它的外部类（在这种情况下是不可序列化的），所以如果我尝试序列化它，我会得到外部类的 NullPointerException。

那么有没有办法覆盖对外部类的引用并将其设置为瞬态，以便每次初始化都不会对其进行序列化并创建内部类的对象？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-09T18:11:29.990

您不能对封闭实例进行隐式引用`transient`，但您*可以*做的是重新设计以使其成为嵌套（静态）类并在构造函数参数中显式传递封闭实例。然后，您需要在嵌套类中使用一个显式变量，您可以将其标记为`transient`.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-09T18:13:35.660

你不能：如果你的内部类不是`static`，它的初始化状态*取决于*定义的外部类的实例。这是因为如果没有外部类的实例，您就无法获得内部类的实例。

并且由于外部类不是`Serializable`，你不能序列化外部类的实例，因此你不能序列化内部类的实例。

或者只是使内部类静态并完成它......

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-09T18:13:15.570

自动序列化有一些负面的部分：如果您更改字段名称或更改字段的可见性，则反序列化将不起作用，更重要的是：它将“自动”保存更多空间对象。出于这个原因，我几乎总是手动序列化/反序列化类：写一个 int，写一个字符串而不是读回它。使用此方法，您可以根据需要编写非静态内部类反序列化

# algorithm - big-O 表示法是对算法进行最佳、最差和平均情况分析的工具吗？

> ID：14243666
> 
> 赞同：0
> 
> 时间：2013-01-09T18:07:38.893
> 
> 标签：algorithm, big-o

big-O 表示法是对算法进行最佳、最差和平均情况分析的工具吗？还是 big-O 仅用于最坏情况分析，因为它是一个上限函数？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-09T18:09:05.923

它是大 O，因为数量级表示为 O(n)、O(logN) 等。

算法的最佳、最差和平均情况都可以用大 O 表示法表示。

有关应用于排序算法的示例，请参见

[http://en.wikipedia.org/wiki/Sorting_algorithm#Comparison_of_algorithms](http://en.wikipedia.org/wiki/Sorting_algorithm#Comparison_of_algorithms)

请注意，可以根据多个独立的标准（例如内存使用或 CPU 使用）对算法进行分类。通常，在两个或多个标准之间进行权衡（例如，使用很少 CPU 的算法可能会使用相当多的内存）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-09T18:13:02.590

大“O”是*渐近复杂度*的度量，也就是说，当 N 变得非常大时，算法大致如何缩放。

如果最好和最差收敛到相同的渐近复杂度，您可以使用单个值 - 或者您可以单独计算它们（例如，某些排序算法在已排序或几乎排序的数据上具有与未排序数据完全不同的特征） .

符号本身并没有传达这一点，但你如何使用它。

* * *

> ...或者大 O 仅用于最坏情况分析...

如果你只给出一个算法的渐近复杂度，它并不能告诉读者最好和最坏情况是否（或如何）与平均值不同。

如果您给出最佳情况和最坏情况的复杂性，它会告诉读者它们有何不同。

默认情况下，如果列出了单个值，则可能是平均复杂度，它可能（或可能不会）与最坏情况收敛。

# php - 通过 PHP 的 curl over ftps 连接删除文件正在回显目录内容

> ID：14243668
> 
> 赞同：4
> 
> 时间：2013-01-09T18:07:40.450
> 
> 标签：php, curl, ftps

这段代码的行为很奇怪。我要做的就是通过 FTPS 连接删除文件并确定它是否有效。删除完美无缺，但我遇到了副作用。我不知道为什么，但有些东西导致生成的目录内容回显。

```
$conn = curl_init();
$testfile = 'file.txt';

curl_setopt($conn, CURLOPT_PORT, $config['imt']['ftp']['port']);
curl_setopt($conn, CURLOPT_SSL_VERIFYPEER, false);
curl_setopt($conn, CURLOPT_SSL_VERIFYHOST, false);
curl_setopt($conn, CURLOPT_FTP_SSL, CURLFTPSSL_TRY);

$url = 'ftps://' . $config['imt']['ftp']['host'];

curl_setopt($conn, CURLOPT_URL, $url);
curl_setopt($conn, CURLOPT_USERPWD, $config['imt']['ftp']['username'] . ':' . $config['imt']['ftp']['password']);
curl_setopt($conn, CURLOPT_QUOTE, array('DELE /' . $testfile));

$result = curl_exec($conn);

if ($result)
{
    echo 'Success';
}

curl_close($conn); 
```

上面打印出来的正是这个。

```
drwxrwxrwx   1 DCG AbilityFTPServer          0 Jan 09 12:58 .
drwxrwxrwx   1 DCG AbilityFTPServer          0 Jan 09 12:58 ..
-rw-rw-rw-   1 DCG AbilityFTPServer        260 Jan 08 12:52 Congratulations.txt
Success 
```

我试图删除的文件确实已被删除，目录中只剩下那个 txt 文件。它甚至会打印“成功”。但是为什么在我不要求的时候打印我的目录内容！？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-09T18:16:39.507

尝试`curl_setopt($ch, CURLOPT_RETURNTRANSFER, true);`使`curl_exec()`函数返回数据而不是输出数据。

# css - div 没有移动附近的 div

> ID：14243672
> 
> 赞同：0
> 
> 时间：2013-01-09T18:08:03.367
> 
> 标签：css, html, containers, jsfiddle

我有这样的事情：

```
<div class="top">top</div>
<div class="container">
    <div class="left">left</div>
    <div class="right">right</div>
</div>
<div class="bottom">bottom</div> 
```

[jsFiddle中的相关代码](http://jsfiddle.net/FQxkq/66/)

如您所见，在顶部和底部 div 之间，有一个 div 容器。我希望这个 div 容器尽可能多地移动底部潜水（而且我不希望它是一个固定值 - 这意味着如果，假设左容器会变得更高 - 底部 div 也将被推下.

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-09T18:15:50.003

现在，您正在为左/右 div 使用绝对位置，因此您总是需要知道高度才能正确定位底部 div。你想要做的是浮动这些，然后清除底部 div 中的浮动。这样左/右可以和它们的内容一样高，底部的div总是出现在下面。

```
.bottom {
    clear: both;
}

.left {
    float: left;
    width: 50%;
    min-height: 50px;
}

.right {
    float: right;
    width: 50%;
    min-height: 150px;
} 
```

我已经[相应地修改了您的 jsFiddle](http://jsfiddle.net/FQxkq/72/)，并使正确的 div 更高以显示底部始终显示在下方。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-09T21:00:51.753

这是一个看似简单的问题，但最终变得有点棘手。上述关于 position:relative 与 position:absolute 的建议是很好的第一步。之后，您需要为设置宽度右 div 腾出一些空间：

```
.left {
    height: 100%;
    min-height: 50px;
    border:1px dashed red;
    padding-right: 50px;      <---
} 
```

然后在您创建的空间中浮动您的右侧 div：

```
.right {
    float:right;              <---
    width: 50px;              (This needs to match the padding-right value above.)
    text-align: right;
    min-height: 50px;
    height: 100%;
    border:1px dashed blue;
} 
```

最后，在 html 中将右 div 放在左 div 之前：

```
<div class="top">top</div>
<div class="container">
    <div class="right">right</div>
    <div class="left">left</div>
</div>
<div class="bottom">bottom</div> 
```

（在 Chrome 和 IE 中测试。）

请参阅：[右 div 固定宽度，左 div 扩展到最大宽度？](https://stackoverflow.com/questions/7552026/right-div-fix-width-left-div-extend-to-max-width)

您可以在这里查看小提琴：http: [//jsfiddle.net/x3QfG/1/](http://jsfiddle.net/x3QfG/1/)

这对你有用吗？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-09T18:19:51.263

使用`floats`而不是绝对定位它们。这将使您的架构非常流畅和灵活。

对and应用必要`float`的值后，使用**clearfix** hack 将浮动元素包含在容器中。现在，只要任何或div 的高度增加，底部的 div 就会被向下推。`.left``.right`**`.left``.right`**

 *** * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-09T18:55:06.533

使容器相对和左右绝对，并且用于定位设置宽度而不是使用浮动。**

# functional-programming - OCaml 中的“联合”是什么，真的

> ID：14243675
> 
> 赞同：3
> 
> 时间：2013-01-09T18:08:14.990
> 
> 标签：functional-programming, ocaml

我正在学习`union`一点 OCaml，我很困惑。

* * *

在 C 中，联合是这样的

```
union {
    int i;
    float f;
} x;
x.i = 0x27;
printf ("%f\n", x.f); 
```

那么，**OCaml 中的 union 是否具有相同的目的？**

让我们举个例子。下面是一个联合定义：

![在此处输入图像描述](../Images/e60f5a84e116093c0b3a9cb27b60e531.png)

**如何像上面的 C 示例一样使用这个联合？**

* * *

也为这个

![在此处输入图像描述](../Images/02e2a05ed77309dcd4611702096bb817.png)

**是`type 'a set`联合定义吗？怎么样`type 'a set = 'a list`？为什么？**

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-01-09T18:25:05.667

OCaml 中的可区分联合就像 C 联合与枚举的组合。因此，您的`number`类型示例可以在 C 中表示如下：

```
enum number_tag {
    ZERO, INTEGER, REAL
};

union number_value {
    int i; /* Only access this if tag is INTEGER */
    float f; /* Only access this if tag is REAL */
};

struct number {
    enum number_tag tag;
    union number_value value;
}; 
```

所以你可以通过访问枚举来询问数字的类型是什么，然后根据枚举的值访问并集的相应字段。当然，C 不会停止访问联合的错误字段。

另一方面，OCaml 消除了访问错误字段的可能性。由于您只能通过模式匹配访问值，因此您知道您始终拥有正确的类型。

类型值的模式匹配`number`在 OCaml 中如下所示：

```
match value_of_type_number with
| Zero ->
    (* Handle the case that the number is Zero *)
| Integer i ->
    (* Handle the case that the number is an Integer with the value i *)
| Float f ->
    (* Handle the case that the number is a Float with the value f *) 
```

相当于这样：

```
switch(value_of_type_number.tag) {
case ZERO:
    /* Handle the case that the number is Zero */
    break;
case INTEGER:
    int i = value_of_type_number.value.i;
    /* Handle the case that the number is an Integer with the value i */
    break;
case FLOAT:
    float f = value_of_type_number.value.f;
    /* Handle the case that the number is a Float with the value f */
    break;
} 
```

* * *

> 是`type 'a set`联合定义吗？怎么样`type 'a set = 'a list`？为什么？

`type 'a set`根本不是一个定义。它只是指定接口。它说这个接口的实现必须定义一个名为的类型`set`，它接受一个类型参数。

`type 'a set = 'a list`是一个定义，但不是一个受歧视的工会。它只是一个类型别名。那就是说“`'a set`只是`'a list`'的另一个名称。可区分联合的定义将有一个构造函数作为等号之后的第一件事。构造函数总是以大写字母开头。

# asp.net-mvc - MVC 4：强制 ScriptBundle 返回 Javascript 文件的非优化链接

> ID：14243678
> 
> 赞同：3
> 
> 时间：2013-01-09T18:08:25.350
> 
> 标签：asp.net-mvc, asp.net-mvc-4, minify, bundling-and-minification, scriptbundle

我们试图让 MVC 4 中的**ScriptBundle**在 web.config 中的 debug = false 时返回扩展的 javascript 列表。默认情况下，当 debug=false 时，ScriptBundle 会将 javascript 优化为一次调用。

目前，当您在 web.config 中设置 debug=false 时，**ScriptBundle**将像这样组合和**缩小**javascript 文件：

```
 <script src="/AAA/Scripts/a?dfkjghakjsdfhglkjasdhfkljasdf"></script> 
```

我们需要**Scriptbundle**，当**debug=false**时，输出扩展的 javascript，如下所示：

```
<script src="/AAA/Scripts/jquery.validate.unobtrusive.min.js"></script>
<script src="/AAA/Scripts/jquery.tipTip.js"></script> 
```

有没有办法关闭**Scriptbundle**优化？

为什么？当我们在网站上进行 https 重定向时，**ScriptBundle**优化的脚本链接不起作用（我们在链接上得到 503 Forbidden）

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-01-09T19:42:33.043

尝试在您设置捆绑包的 BundleConfig.cs 文件中进行设置：

```
BundleTable.EnableOptimizations = false; 
```

有关详细信息，请参阅[http://www.asp.net/mvc/tutorials/mvc-4/bundling-and-minification 。](http://www.asp.net/mvc/tutorials/mvc-4/bundling-and-minification)

# ajax - 如何使用ajax元素抓取网页

> ID：14243682
> 
> 赞同：0
> 
> 时间：2013-01-09T18:08:33.720
> 
> 标签：ajax, web, scrape

我想抓取一些网页，如下所示

[http://www.youtube.com/user/koglin66/feed?filter=2](http://www.youtube.com/user/koglin66/feed?filter=2)

但有一个“加载更多”按钮，它与 ajax 请求有关

```
http://www.youtube.com/channel_ajax?action_load_more_feed_items=1&activity_view=1&paging=1352148528&channel_id=UCCw8aVnsIeu9S6OPQyaQ14g 
```

我想爬取整个页面。手动，我反复点击按钮，直到没有更多的加载，通过自动化，我怎样才能爬取整个页面？谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-08-06T01:59:03.283

是的，您可以使用 Selenium IDE，或使用其他带有浏览器核心的程序/库来执行点击操作。像webkit，IE的activex。

你可以试试 FMiner [http://www.fminer.com/](http://www.fminer.com/)，它可以在浏览器上记录和播放人类动作来抓取数据，但它不是免费的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-17T06:23:01.883

我最近在我想废弃的其他网站上遇到了同样的问题。我使用 Java，在网络上进行了一些研究后，我将 Selenium IDE 用于 firefox，您可以在其中编写 Java Junit 测试用例，它会自动打开网页并单击按钮、填写表单等。它还支持 C#、Python、Ruby、 ETC

我用它来点击加载更多按钮，当页面在所有点击后完全加载时，我手动保存了它。

你可以从他们的网站下载 Selenium，我发现这个 youtube 视频也很有用[http://www.youtube.com/watch?v=twdDfDOrHC4](http://www.youtube.com/watch?v=twdDfDOrHC4)

# excel - 在 Excel 中，如何根据其数据验证规则检查给定范围内的任何单元格是否无效？

> ID：14243686
> 
> 赞同：1
> 
> 时间：2013-01-09T18:08:45.373
> 
> 标签：excel, excel-formula, worksheet-function

在 Excel 中，我正在尝试编写一个公式，根据每个单元格的数据验证规则，检查某个单元格范围内的任何单元格是否包含无效数据。我想使用此信息在工作表顶部附近的单元格中显示一条消息，因此用户不必滚动整个工作表来查看它是否包含任何无效数据。

我要检查的范围内的所有单元格都使用相同的规则进行数据验证，但这些规则相当复杂，并且取决于每行中其他单元格的值。我已经知道您可以使用 VLOOKUP 函数（例如）检查给定列中的任何单元格是否等于某个值`=IF(ISNA(VLOOKUP("Lookup Value", A1:A20, 1, FALSE)), "Not Found", "Found")`，但似乎没有任何方法可以使用相同的方法来检查具有无效数据的单元格。

有没有办法在不使用 VBA 的情况下在 Excel 中执行此操作？如果没有，你能推荐一个替代解决方案吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-09T19:15:33.133

因此，如果任何行在 D 列中包含 Fail 或 N/A 且同一行中的 E 列为空白，则该行无效？

尝试使用 COUNTIFS 查看是否有任何无效行，例如顶部的这个公式

`=IF(SUM(COUNTIFS(D:D,{"Fail","N/A"},E:E,"")),"Invalid Data","All OK")`

或者这个版本会给你实例的数量

`=IF(SUM(COUNTIFS(D:D,{"Fail","N/A"},E:E,"")),SUM(COUNTIFS(D:D,{"Fail","N/A"},E:E,""))&" Row(s) of Invalid Data","All OK")`

COUNTIFS 仅在 Excel 2007 或更高版本中有效，在早期版本中您可以使用 SUMPRODUCT 计算无效行，即

`=SUMPRODUCT((D1:D1000={"Fail","N/A"})*(E1:E1000=""))`

# javascript - Android WebView JavaScript onClick 错误

> ID：14243687
> 
> 赞同：0
> 
> 时间：2013-01-09T18:08:46.707
> 
> 标签：javascript, android, css

我有一些会在使用事件单击按钮时`JavaScript`添加一些。这在所有经过测试的浏览器（Safari、Firefox、Chrome 等）中都能完美运行，也适用于包括对象内的所有手机。`CSS``onClick()``iOS` `UIWebView`

`WebView`然而，尽管它在 Android 手机上的 Google Chrome 浏览器中运行良好，但它在 Android对象中不起作用。什么都没有发生。

将其从`onClick()`事件更改为`touchstart()`事件有效。

也在作品中添加`alert()`，`onClick()`似乎该`onClick()`事件无法`CSS`在 Android`WebView`对象中添加样式

这到底是怎么回事，这是某种错误，它似乎发生在我测试过的每台 Android 手机上，都使用不同的操作系统版本：S

这是我一直在使用的代码

```
if (login) {
    login.addEvent('click', function(e){
        e.stopPropagation();
        $('login_items_wrapper').setStyle('opacity', '0');
        $('loading_content_login').show();
    });
} 
```

有人可以帮忙吗？？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2017-06-02T08:41:32.360

我在自然 JS 中尝试了这个“重复版本”，它对我有用：

```
if (login) {
    login.onclick = myFunc();
    login.addEventListener('click', function() {
        myFunc();
    });
}

function myFunc() {
    $('.login_items_wrapper').setStyle('opacity', '0');
    $('.loading_content_login').show();
} 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-01-09T20:35:15.353

你需要改变

```
$('login_items_wrapper').setStyle('opacity', '0');
$('loading_content_login').show(); 
```

至

```
$('.login_items_wrapper').setStyle('opacity', '0');
$('.loading_content_login').show(); 
```

或者

```
$('#login_items_wrapper').setStyle('opacity', '0');
$('#loading_content_login').show(); 
```

因为您没有正确引用元素。

# symfony - 如何知道表单域是否可翻译

> ID：14243689
> 
> 赞同：1
> 
> 时间：2013-01-09T18:08:55.583
> 
> 标签：symfony, doctrine-orm, translation, symfony-2.1

是否有快捷方式可以知道实体字段是否`@Gedmo\Translatable`设置了属性，比如在呈现表单或显示实体值时？

例如，有这个字段：

```
/**
 * @var string
 *
 * @ORM\Column(name="name", type="string", length=255)
 * @Gedmo\Translatable
 */
private $name; 
```

在显示实体时，我想知道一个字段是否可翻译，通过做这样的事情（在**树枝**模板中它可能是什么或看起来像什么的伪代码想法）

```
{% entity.title in entity.translatable.fields %} 
```

***注意：**这背后的真正想法是在可翻译的表单字段上自动显示标记。*

*   [Doctrine2 的可翻译行为扩展](http://gediminasm.org/article/translatable-behavior-extension-for-doctrine-2)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-18T19:45:21.263

你可以创建一个 Twig 扩展：

```
class TranslatableTypeExtension extends AbstractTypeExtension
{
/**
 * @var ObjectManager
 */
private $om;

/**
 * @var TranslatableListener
 */
private $listener;

/**
 * @param ObjectManager $om
 */
public function __construct(ObjectManager $om, TranslatableListener $listener )
{
    $this->om = $om;
    $this->listener = $listener;
}

private function isTranslatableField($object, $name)
{
    $config = $this->listener->getConfiguration($this->om, get_class($object));

    if (isset($config['fields']) && in_array($name, $config['fields']) ) 
        return true;
    return false;
}

public function buildView(FormView $view, FormInterface $form, array $options)
{
    if ( $form->getParent() == null )
        return;

    if ( is_object($form->getParent()->getData())) {
        if ( $this->isTranslatableField($form->getParent()->getData(),    $form->getName()) )
            $view->vars['field_translatable'] = true;
    }
}

/**
 * Returns the name of the type being extended.
 *
 * @return string The name of the type being extended
 */
public function getExtendedType()
{
    return 'field';
}
} 
```

按如下方式加载此扩展：

```
my_extension.translatable_type_extension:
    class: Acme\DemoBundle\Form\Extension\TranslatableTypeExtension
    arguments: ["@doctrine.orm.entity_manager", "@gedmo.listener.translatable"]
    tags:
        - { name: form.type_extension, alias: field } 
```

在你的树枝模板中，你可以使用这样的东西：

```
{% if field_translatable is defined and field_translatable %} Translatable field {% endif %} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-09T20:27:25.970

在您的实体存储库中，假设您扩展 TranslationRepository，您可以创建一个自定义函数来检索具有翻译的字段。您可以按照以下方式在存储库中创建自定义方法

```
use use Doctrine\ORM\Query;
use Gedmo\Translatable\Entity\Repository\TranslationRepository;

class MyEntityRepository extends TranslationRepository 
{

     public function getTranslatableFieldsByClass($className)
     {
            $translationMeta = $this->getClassMetadata();

            $qb = $this->_em->createQueryBuilder();
            $qb->select('trans.field')
                ->from($translationMeta->rootEntityName, 'trans')
                ->where('trans.objectClass = :entityClass')
                ->groupBy('trans.field');

            $q = $qb->getQuery();

            $data = $q->execute(
                array('entityClass' => $className),
                Query::HYDRATE_ARRAY
            );

            return (array) $data;
     }
} 
```

然后将结果加载到您的模板中，并使用与上面提到的类似的“in”子句。

```
$translatableFields = $this->getDoctrine()->getRepository('MyBundle:MyTranslatableEntity')->getTranslatableFieldsByClass(get_class($myTranslatableEntity)); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-06-01T13:57:49.940

我有同样的要求，尽管接受的答案对我不起作用，因为它依赖于已经翻译的字段。因为即使 db 为空我也想要它，我想出了基于 Gedmo ExtensionMetadataFactory 的解决方案。（解决方案写在 SF 2.8 和 PHP 7.1 上）

```
 [...]

use Doctrine\ORM\EntityManager;
use Gedmo\Translatable\TranslatableListener;

/**
 * Helper Class TranslatableFieldsHelper - allow to get array of translatable fields for given entity class.
 *
 * @package [...]
 * @author [...]
 */
class TranslatableFieldsHelper
{
    /**
     * @var TranslatableListener
     */
    protected $listener;
    /**
     * @var EntityManager
     */
    protected $em;

    /**
     * TranslatableFieldsHelper constructor.
     * @param TranslatableListener $listener
     * @param EntityManager $em
     */
    public function __construct(TranslatableListener $listener, EntityManager $em)
    {
        $this->listener = $listener;
        $this->em = $em;
    }

    /**
     * Get translatable fields list of given class
     *
     * @param string $class
     * @return array
     */
    public function getTranslatableFields(string $class): array
    {
        $config = $this->listener->getConfiguration($this->em, $class);

        return $config && isset($config['fields']) && is_array($config['fields']) ? $config['fields'] : [];
    }
} 
```

实现此类后，只需将其注册为服务：

```
_alias_:
    class: _class_
    arguments: ['@stof_doctrine_extensions.listener.translatable', '@doctrine.orm.default_entity_manager'] 
```

并使用它：

```
$this->container->get(__alias__)->getTranslatableFields(__your_entity_class__); 
```

编辑：

# jquery - 左右移动图像的问题

> ID：14243691
> 
> 赞同：0
> 
> 时间：2013-01-09T18:09:00.240
> 
> 标签：jquery, html, jquery-animate, slider

我已经编写了一个内容滑块代码，并且可以在正确单击时从右向左滑动内容。

但是，如果我必须从左向右滑动内容，我必须第一次在左箭头按钮上单击两次，然后单击从左向右滑动。

另外，一旦我开始从左向右滑动内容，如果我必须从右向左滑动内容，我必须第一次双击右箭头按钮两次。

下面是代码。

```
<head>
    <title></title>
</head>
<link rel="stylesheet" type="text/css" href="css/style.css" />
<script type="text/javascript" src="js/jquery-1.8.1.min.js">

</script>
<script type="text/javascript" src="js/jquery.easing.1.3.js">

</script>
<!--script type="text/javascript" src="js/slidR.js"> </script-->

<body>
    <div id="sliderBlock">
        <div id="slide1" class="slide">
            <img src="img/nmo.jpg" />
        </div>
        <div id="slide2" class="slide">
            <img src="img/tys.jpg" />
        </div>
        <div id="slide3" class="slide">
            <img src="img/ups.jpg" />
        </div>
        <div id="slide4" class="slide">
            <img src="img/we.jpg" />
        </div>
    </div>
</body>
<script>
    $(function () {
        var count = $("#sliderBlock").children().length;
        var slideWidth = $(".slide").outerWidth();
        var slideHeight = $(".slide").outerHeight();
        var totalWidth = count * slideWidth;
        var easeFn = "swing";
        var fs = 1;
        var ls = count;
        var currentSlide;
        $("#sliderBlock").append("<div id='next'></div>")
        $("#sliderBlock").append("<div id='prev'></div>")
        $(".slide").wrapAll('<div id="allSlides">');
        $("#allSlides").css({
            "width": totalWidth,
            "height": slideHeight
        });
        $("#sliderBlock").append("<ul id='pagination'>");
        for (i = 1; i <= count; i++) {
            $("#pagination").append("<li><a id='slide" + i + "'>" + i + "</a></li>")
        }
        $("#pagination li a#slide1").addClass("liveSlide");
        var interval = 3000;
        var timeInterval = setInterval(function () {
            slidR()
        }, interval);
        $("#prev").on("click", slidR_L)
        $("#next").on("click", slidR_R)

        function slidR() {

            //  slidR_R();
            //  slidR_L();

        }
        var curSlide, curSlideNo, prevSlideNo, divReOrder;
        divReOrder = 1;

        function slidR_R() {

            $("#allSlides").animate({
                left: -slideWidth
            }, 1000, function () {
                $(".slide:first-child").clone().appendTo("#allSlides");
                $(".slide:first-child").detach();
                $("#allSlides").css('left', "0px");
            });

        }

        function slidR_L() {

            $("#allSlides").animate({
                left: "0"
            }, 1000, function () {

                $(".slide:last-child").clone().prependTo("#allSlides");
                $(".slide:last-child").detach();
                $("#allSlides").css('left', -slideWidth);
            });

        }
    });
</script> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-09T18:40:35.890

试试这个，看看是否有帮助：

```
<script>

        function slidR_R() {
            $("#allSlides").animate({
                left: -slideWidth
            }, 1000, function () {
                $(".slide:first-child").clone().appendTo("#allSlides");
                $(".slide:first-child").detach();
                $("#allSlides").css('left', "0px");
            });
        }

        function slidR_L() {
            $("#allSlides").animate({
                left: "0"
            }, 1000, function () {

                $(".slide:last-child").clone().prependTo("#allSlides");
                $(".slide:last-child").detach();
                $("#allSlides").css('left', -slideWidth);
            });
        }
    $(function () {
        var count = $("#sliderBlock").children().length;
        var slideWidth = $(".slide").outerWidth();
        var slideHeight = $(".slide").outerHeight();
        var totalWidth = count * slideWidth;
        var easeFn = "swing";
        var fs = 1;
        var ls = count;
        var currentSlide;
        $("#sliderBlock").append("<div id='next'></div>")
        $("#sliderBlock").append("<div id='prev'></div>")
        $(".slide").wrapAll('<div id="allSlides">');
        $("#allSlides").css({
            "width": totalWidth,
            "height": slideHeight
        });
        $("#sliderBlock").append("<ul id='pagination'>");
        for (i = 1; i <= count; i++) {
            $("#pagination").append("<li><a id='slide" + i + "'>" + i + "</a></li>")
        }
        $("#pagination li a#slide1").addClass("liveSlide");
        var interval = 3000;
        var timeInterval = setInterval(function () {
            slidR()
        }, interval);
        $("#sliderBlock").on("click", "#prev", slidR_L);
        $("#sliderBlock").on("click", "#next", slidR_R);

        var curSlide, curSlideNo, prevSlideNo, divReOrder;
        divReOrder = 1;

    });
</script> 
```

# dom - 防止“with”绑定移除 DOM 元素 (Knockout.js)

> ID：14243698
> 
> 赞同：5
> 
> 时间：2013-01-09T18:09:17.197
> 
> 标签：dom, knockout.js

淘汰赛，

我开始依赖 with 绑定来建立上下文嵌套。虽然我喜欢 KO 在某些情况下根据绑定元素的状态操作 DOM 的方式，但有时我只想要绑定含义而不删除 DOM。

有谁知道是否有可能防止在单个元素绑定级别上进行 DOM 操作？

谢谢，文尼

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-09T21:27:02.777

`with`当最初绑定到对象（或其他真实值）时，Knockout 版本 2.2+ 不会清除 DOM 元素。或者，您可以使用`withlight`我前段时间放在一起的绑定。它只会绑定到一个对象（不是可观察的）。

```
ko.bindingHandlers['withlight'] = {
    'init': function(element, valueAccessor, allBindingsAccessor, viewModel, bindingContext) {
        var bindingValue = valueAccessor();
        if (typeof bindingValue != 'object' || bindingValue === null)
            throw new Error('withlight must be used with an object');
        var innerContext = bindingContext['createChildContext'](bindingValue);
        ko.applyBindingsToDescendants(innerContext, element);
        return { 'controlsDescendantBindings': true };
    }
}; 
```

# ajax - 将 jQuery 应用于 ajax 创建的元素

> ID：14243699
> 
> 赞同：0
> 
> 时间：2013-01-09T18:09:17.857
> 
> 标签：ajax, jquery

我试图弄清楚如何将 jQuery 方法、函数等应用于使用 ajax 创建的元素。在我的页面中有一个下拉列表#cat_id，根据所做的选择，创建了一组 UL 元素。然后，我需要为创建的每个元素调用以下函数：

```
$('#allowSpacesTagsX').tagit({ itemName: 'itemX', fieldName: 'tagsX', availableTags: sampleTagsX, allowSpaces: true }); 
```

其中 allowSpacesTagsX (X=1,2,3,....) 是创建的 UL 元素的 id。此方法将 UL 绑定到类似于 StackOverflow 中使用的标记元素的自动完成标记小部件。

通常，上面的代码将包含在 document.ready 中，用于静态元素，但我需要为使用 ajax 创建的每个元素添加它。

这是一个小的代码示例，可以更好地理解我的问题：

```
<script src="../js/tag-it.js" type="text/javascript"></script>
<script>
    $(document).ready(function() {
        $('#cat_id').live('change', function(e){
           $.post('../includes/ajax.php', {   
            cat_id : $(this).find("option:selected").attr('value')}, function(data) {
            $("#tagholder").html(data);
           });
        }); 
    });
</script> 
```

## 编辑：

添加示例以演示应生成的代码示例：

```
$(function(){ // Creates the arrays of tags to be assigned to each tag field
var sampleTags1 = ['USB', 'DVB', 'GSM', 'OEM'];
var sampleTags2 = ['Alfa Romeo', 'Audi', 'Chevrolet', 'Mazda', 'Mercedes'];
var sampleTags3 = ['20cm', '21cm', '8in'];
$('#allowSpacesTags1').tagit({ itemName: 'item1', fieldName: 'tags1', availableTags: sampleTags1, allowSpaces: true });
$('#allowSpacesTags2').tagit({ itemName: 'item2', fieldName: 'tags2', availableTags: sampleTags2, allowSpaces: true });
$('#allowSpacesTags3').tagit({ itemName: 'item3', fieldName: 'tags3', availableTags: sampleTags3, allowSpaces: true });
}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-09T18:29:23.223

```
<script src="../js/tag-it.js" type="text/javascript"></script>
<script>
$(document).ready(function() {
    $('#cat_id').live('change', function(e){
       $.post('../includes/ajax.php', {   
        cat_id : $(this).find("option:selected").attr('value')},
        function(data) {
        $("#tagholder").html(data);//places your ajax content
        //grab that element again and then apply any jquery function to it
        //example add a class to an arbitary h1 tag inside #tagholder
        $("#tagholder h1").css('class','heading');//like so
       });
    }); 
});
</script> 
```

# android - 以对话框为主题的活动更好地包装滚动视图

> ID：14243704
> 
> 赞同：2
> 
> 时间：2013-01-09T18:09:33.550
> 
> 标签：android, android-layout, dialog, scrollview

我有一个活动，它以 Holo.Dialog（或旧 API 级别上的普通旧 Dialog）为主题，并包含一个 ScrollView 作为它的主要布局，以防我们遇到无法显示所有内容的小屏幕。我现在的问题是对话框需要滚动才能看到所有内容，即使我们有剩余的垂直屏幕空间，如下所示：

![在此处输入图像描述](../Images/558ae9b11441d1411d738e778553663c.png)

这是 ScrollView 的代码，它是一个子组件，一个 LinearLayout：

```
<ScrollView xmlns:android="http://schemas.android.com/apk/res/android"
android:id="@+id/scrollView1"
android:layout_width="fill_parent"
android:layout_height="fill_parent" >

<LinearLayout
    android:layout_width="fill_parent"
    android:layout_height="wrap_content"
    android:gravity="center_horizontal"
    android:orientation="vertical" > 
```

我需要改变什么才能让这个对话框包装得更好？谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-10T01:26:46.370

对我有用的解决方案是将按钮从 ScrollView 中取出，并将它们放在 RelativeLayout 的顶层。通过将buttonbar先放在xml中，对齐到父底部，然后将scrollView的layout_above设置为buttonBar，就得到了我想要的效果

# c++ - 在 unordered_map 中插入元素会出错

> ID：14243707
> 
> 赞同：0
> 
> 时间：2013-01-09T18:09:51.843
> 
> 标签：c++, vector, unordered-map

我已经定义了一个`unordered_map`这样的

```
struct pht {
  pht(int t, vector<bool> pat) 
: tag(t), pattern(32) {}
private:
  int tag;
  vector<bool> pattern;
};

unordered_map< pair<int, int>, pht > predictor;

int main()
{
  int pc, addr, offset, tag;
  vector<bool> pat;
  srand(time(0));

  tag = 1000; pc = 100; offset = 10; 
  for ( int i = 0; i < 32; i++ ) 
  pat.push_back( rand() % 2 );
  predictor.insert(make_pair( make_pair(pc, offset), pht(tag, pat) ) );
  return 0;
} 
```

但是我收到此错误：

（更新）

```
error C2440: 'type cast' : cannot convert from 'const std::pair<_Ty1,_Ty2>' to 'size_t' 
```

我该如何解决？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-09T18:31:36.767

错误信息具有误导性；`std::hash`真正的原因`std::pair<int, int>`是`unordered_map`. 您需要提供此专业化或（推荐）创建一个[`unordered_map`](http://en.cppreference.com/w/cpp/container/unordered_map)指定自定义哈希的：

```
struct hash_pair {
    template <typename T, typename U>
    std::size_t operator ()(std::pair<T, U> const& p) const {
        using std::hash;
        return hash<T>()(p.first) ^ hash<T>()(p.second);
    }
}; 
```

然后将地图声明为：

```
unordered_map<pair<int, int>, pht, hash_pair> predictor; 
```

# sql - 访问删除除最大值之外的所有内容

> ID：14243710
> 
> 赞同：1
> 
> 时间：2013-01-09T18:10:00.163
> 
> 标签：sql, ms-access, ms-access-2007

我正在尝试修剪一个充满重复和连接值的访问表（contam）。

桌子看起来像这样

```
FederalSiteIdentifier Contam
001 1
001 1, 2
001 1, 2, 3
001 1, 2, 3, 4
002 1
003 1
003 1, 2
003 1, 2, 3 
```

我只想为每个 ID 保留最后一个最长的条目，但无法找出在 Access SQL 中执行此操作的正确方法。

在做了一些阅读之后，我尝试了这个简单的代码：

```
SELECT FederalSiteIdentifier, Max(Contam) as MaxCont
FROM contam
ORDER BY FederalSiteIdentifier 
```

这会产生错误。

任何人都可以帮忙吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-09T18:23:04.577

我认为您想要`Contam`每个`FederalSiteIdentifier`. 您将需要一个`GROUP BY`子句。

```
SELECT FederalSiteIdentifier, Max(Len(Contam)) as MaxCont
FROM contam
GROUP BY FederalSiteIdentifier 
```

如果该查询标识了您希望保留的行，请将其保存为*qryRows2Keep*，然后尝试以下`DELETE`查询：

```
DELECT FROM contam
WHERE
    Len(Contam) < DLookup(
            "MaxCont",
            "qryRows2Keep", 
            "FederalSiteIdentifier = '" & FederalSiteIdentifier & "'") 
```

我假设`FederalSiteIdentifier`是文本数据类型。如果它是数字，则丢弃`DLookup`表达式中的单引号。

在尝试此未经测试的建议之前，请确保您已备份数据。:-)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-09T18:23:33.303

MAX 是一个聚合函数，只有使用 GROUP BY 语句才能执行这些操作。Access 在删除记录的方式上也很奇特。你不能离开加入和删除，所以你必须识别你不想要的记录，然后删除它们。

创建一个新列，以便我们可以选择要保留的记录。

```
ALTER TABLE contam ADD Keep BIT NOT NULL DEFAULT 0; 
```

现在识别记录并更新表

```
UPDATE c
SET    keep = 1
FROM   contam AS c
       INNER JOIN (
                  SELECT FederalSiteIdentifier, Max(Len(Contam)) as MaxCont
                  FROM contam
                  GROUP BY FederalSiteIdentifier
                  ORDER BY FederalSiteIdentifier
                  ) AS maxc
         ON c.FederalSiteIdentifier = maxc.FederalSiteIdentifier
         AND Len(c.Contam) = maxc.MaxCont; 
```

请注意 GROUP BY 行......这就是你错过的给你一个错误的东西..

最后执行删除

```
 DELETE FROM contam
 WHERE keep = 0; 
```

您现在可以删除多余的列

```
ALTER TABLE contam DROP COLUMN Keep; 
```

长篇大论，但你去。

# list - 如何通过 Rhino.Mocks 使用接口集合进行测试

> ID：14243715
> 
> 赞同：0
> 
> 时间：2013-01-09T18:10:16.507
> 
> 标签：list, rhino-mocks, stub

在我的界面中

`public IMyListInterface : IList<IMyItem> { void Foo(); }`

如何轻松创建一个示例来测试使用 IMyListInterface 的类。

目前我正在使用`GenerateStub<MyListInterface>()`并将所需的方法/属性委托给一个`List<IMyItem>`列表，但这很乏味。

目前要使以下正在测试的代码正常工作

```
foreach (var match in matchList) 
```

我在我的测试课上做以下事情

```
IList<IMyItem> baseList = new List<IMyItem>();
IMyListInterface matchList = MockRepository.GenerateStub<IMyListInterface>();

matchList.Stub(m => m.GetEnumerator()).Return(null).WhenCalled(i => i.ReturnValue = baseList.GetEnumerator()); 
```

有没有更好的办法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-18T10:00:38.747

在抽象基类中实现接口以进行测试：

```
public abstract MyMockableList : List<MyItem>, IMyListInterface
{
    public abstract void Foo();
} 
```

然后你可以使用`MockRepository.GenerateStub<MyMockableList>()`，它将作为一个普通的列表（RhinoMocks 不会覆盖从 继承的方法`List<MyItem>`），但你仍然可以存根该`Foo()`方法。

# mysql - 在 MySQL 数据库中找到两个相似的

> ID：14243717
> 
> 赞同：0
> 
> 时间：2013-01-09T18:10:22.093
> 
> 标签：mysql, count, substring

我想知道是否有任何行共享 ip。我发现了如何通过使用来做到这一点

> SELECT * FROM `people`WHERE ip IN ( SELECT ip FROM `people`GROUP BY ip HAVING COUNT(ip > 1 ) 按名称排序

并从这个数据库

> 约翰 123.456.78.90
> 鲍勃 123.456.78.90
> 埃里克 123.456.78.90

我有

> 约翰 123.456.78.90
> 埃里克 123.456.78.90

但是在数据库端口的一些更改被添加到 ip 之后（不要问我为什么）
所以现在数据库看起来像这样：

> 约翰 123.456.78.90:1337
> 鲍勃 123.456.78.90:4242
> 埃里克 123.456.78.90:9001

我发现我可以通过这样做删除冒号后的所有内容

> SUBSTRING_INDEX(ip,':', 1)

我不知道如何删除冒号后的所有内容，然后看看是否有人有相同的 ip
以任何方式将这两个查询混合在一起？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-09T18:22:31.983

您可以在分组中使用 SUBSTRING_INDEX 函数，例如：

```
SELECT * FROM people 
WHERE SUBSTRING_INDEX(ip, ':', 1) IN ( SELECT SUBSTRING_INDEX(ip, ':', 1) FROM people GROUP BY SUBSTRING_INDEX(ip, ':', 1) HAVING COUNT(ip > 1 ) 
ORDER BY name 
```

# c# - 在c#中转义字符串中的双引号

> ID：14243720
> 
> 赞同：1
> 
> 时间：2013-01-09T18:10:33.950
> 
> 标签：c#, .net, netduino

我知道这已经被讨论过很多次了，但我仍然对所有解决方案都有疑问。

我需要构建一个字符串以发送到需要引号的 JSON 解析器。我试过这些形式：

```
string t1 = "[{\"TS\"}]";
string t2 = "[{" + "\"" + "TS" + "\"" + "}]";
string t3 = @"[{""TS""}]"; 
Debug.Print(t1);
Debug.Print(t1);
Debug.Print(t1); 
```

调试语句正确显示它 [{"TS"}] 但是当我在调试器中查看它时，最重要的是当我将字符串发送到我的服务器端 json 解析器时，其中包含转义字符："[{\"TS \"}]"

如何摆脱实际字符串中的转义字符？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-09T18:41:34.920

> 调试语句正确显示它 [{"TS"}] 但是当我在调试器中查看它时，最重要的是当我将字符串发送到我的服务器端 json 解析器时，其中包含转义字符："[{\"TS \"}]"

从调试器的角度来看，它总是会显示转义的版本（这样您作为开发人员就可以确切地知道字符串值是什么）。这不是错误。当您将其发送到另一个 .Net 系统时，它将再次从调试器的角度显示转义版本。如果您输出值（Response.Write() 或 Console.WriteLine()），您将看到您期望的版本将在那里。

如果您突出显示变量（来自调试器）并选择放大镜图标旁边的下拉菜单并选择“文本可视化器”，您将看到它以纯文本形式显示的方式。这可能是您正在寻找的。

根据您的评论，我想建议您也注意如何将字符串转换为字节。您要确保以其他机器可以理解的格式对字节进行编码。确保使用如下命令将字符串转换为字节：

```
System.Text.Encoding.ASCII.GetBytes(mystring); 
```

我偷偷怀疑您发送的是字符串本身的位表示而不是编码版本。

# r - R 热图在行侧具有离散变量的分数

> ID：14243723
> 
> 赞同：1
> 
> 时间：2013-01-09T18:11:00.187
> 
> 标签：r, matrix, axis, heatmap

我对少数几个因素进行了几千次观察，根据每个因素的最小值将这些因素转化为离散的 1/0 值，并将其绘制在 heatmap.2（红色=1，黑色=0）中。这绘制了 A+B+C+D 为 1、3 个因素的组合为 1、2 个因素的组合等的组合。我希望将这些组合的分数绘制在左侧垂直heatmap.2中的轴：

```
nentries=10000
ci=rainbow(nentries)
set.seed=1
mean=10
## Generate some data (4 factors)
i = data.frame(
  a=round(abs(rnorm(nentries,mean-2))),
  b=round(abs(rnorm(nentries,mean-1))),
  c=round(abs(rnorm(nentries,mean+1))),
  d=round(abs(rnorm(nentries,mean+2)))
  )
minvalue = 10
# Discretise values to 1 or 0
m0 = matrix(as.numeric(i>minvalue),nrow=nrow(i))
# Remove rows with all zeros
m = m0[rowSums(m0)>0,]
# Reorder with 1,1,1,1 on top
ms =m[order(as.vector(m %*% matrix(2^((ncol(m)-1):0),ncol=1)), decreasing=TRUE),]
rowci = rainbow(nrow(ms))
colci = rainbow(ncol(ms))
heatmap(ms,
        Rowv=NA,
        labRow=" ",
        keep.dendro = FALSE,
        col=c("black","red"),
        RowSideColors=rowci,
        ColSideColors=colci,
        ) 
```

RowSideColors 现在是具有 nrow(ms) 颜色的彩虹，而我希望拥有因子和图例的 1/0 组合。RowSideColors 旁边的类似：`A+B+C+D 1%`、、等。`B+C+D 10%`有任何想法吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-17T14:25:50.487

如果我正确理解你的问题，你想要少量的行标签，每个块一个？这应该可以解决问题

```
colnames(ms)=LETTERS[1:4]
limits=c(which(!duplicated(ms)),nrow(ms))
l=length(limits)
toname=round((limits[-l]+ limits[-1])/2)
freq=(limits[-1]-limits[-l])/nrow(ms)

rn=rep("", nrow(ms))
for(i in toname) rn[i]=paste(colnames(ms)[which(ms[i,]==1)],collapse="")
rn[toname]=paste(rn[toname], ": ", sprintf( "%.5f", freq ), "%")

heatmap(ms, Rowv=NA, labRow=rn, col=c("black","red")) 
```

它利用您的数据已经排序的事实来查找每个块的中间（我们希望出现图例的位置），然后创建一个图例向量，该向量对于大多数行为空，并包含列名和比例应显示图例的行。

# java - 为什么这条线 char g = (char)(br.read()); 被跳过？

> ID：14243728
> 
> 赞同：1
> 
> 时间：2013-01-09T18:11:33.993
> 
> 标签：java

在这个程序中，`char g = (char)(br.read())`每当我运行程序时都会跳过该行。输入年龄后，如果我输入性别为 m，则会收到错误 java.lang.NumberFormatException。

```
import java.io.*;
public class Tax
{
    public static void main()throws IOException
    {
        InputStreamReader isr  = new InputStreamReader(System.in);
        BufferedReader br = new BufferedReader(isr);
        System.out.println("Enter age");
        int age = Integer.parseInt(br.readLine());
        System.out.println("Enter gender as m or f");
        char g = (char)(br.read());
        System.out.println("Enter Taxable Income");
        int ti = Integer.parseInt(br.readLine());
        double in;
        if (age > 65 || g == 'f')
        System.out.println("Wrong Category");
        else
        {
            if (ti <= 160000)
            in = 0;
            else if(ti > 160000 && ti<=500000)
            in = (ti - 160000) * (10.0/100.0);
            else if(ti > 500000 && ti<=800000)
            in = (ti - 50000) * (20.0/100.0) + 34000;
            else
            in = (ti - 800000) * (30.0/100.0) + 94000;
            System.out.println("Income Tax = " + in);
        }
    }
} 
```

但是如果程序被修改如下，即如果`char g = (char)(br.read());`被替换`String g = br.readLine()`，它可以工作

```
import java.io.*;
public class Tax
{
    public static void main()throws IOException
    {
        InputStreamReader isr  = new InputStreamReader(System.in);
        BufferedReader br = new BufferedReader(isr);
        System.out.println("Enter age");
        int age = Integer.parseInt(br.readLine());
        System.out.println("Enter gender as m or f");
        String g = br.readLine();
        System.out.println("Enter Taxable Income");
        int ti = Integer.parseInt(br.readLine());
        double in;
        if (age > 65 || g.equalsIgnoreCase("f"))
        System.out.println("Wrong Category");
        else
        {
            if (ti <= 160000)
            in = 0;
            else if(ti > 160000 && ti<=500000)
            in = (ti - 160000) * (10.0/100.0);
            else if(ti > 500000 && ti<=800000)
            in = (ti - 50000) * (20.0/100.0) + 34000;
            else
            in = (ti - 800000) * (30.0/100.0) + 94000;
            System.out.println("Income Tax = " + in);
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-09T18:17:04.690

问题是您只从阅读器中读取一个字符 - 留下行分隔符部分仍有待阅读。

因此，如果`BufferedReader`逻辑上包含：

```
30\r\nm\r\n20 
```

然后：

*   `readLine()`第一次调用会消耗`"30\r\n"`。
*   然后调用`read()`将消耗`"m"`离开`\r\n20`
*   第二次调用`readLine()`会消耗`"\r\n"`，返回一个空字符串

如果您实际上*键入*“30”，按回车，然后键入“m20”并按回车，它会起作用 - 但显然这不是您想要的 :)

要么使用扫描仪，要么只使用`readLine()`并检查“m”和“f”行的内容。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-09T18:16:53.973

尝试使用扫描仪

```
 char g;
     Scanner scan = new Scanner (System.in);
     g = scan.nextChar();` 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-09T18:18:22.950

你只读一个字节，这意味着如果你写类似的东西

```
m 22 
```

这意味着您在数字前有一个空格，如果您键入

```
m
22 
```

这意味着后面的行的其余部分`m`是空白的。

我就是这样写的

```
Scanner in  = new Scanner(System.in);
System.out.println("Enter age");
int age = in.nextInt(); in.nextLine();
System.out.println("Enter gender as m or f");
String mf = in.next(); in.nextLine();
System.out.println("Enter Taxable Income");
int ti = in.nextInt(); in.nextLine(); 
```

# ios - 通过本机 UI 控件在 iOS 中使用工具提示？

> ID：14243734
> 
> 赞同：4
> 
> 时间：2013-01-09T18:12:09.793
> 
> 标签：ios, cocoa, touch, tooltip

如何在不使用任何第三方类的情况下在 iOS 中创建工具提示或类似内容？我有一个 UIButton，我想弹出一个工具提示几秒钟或直到它被清除。我见过第三方类和库，但想知道它是否受本地支持。我还想显示一个从工具提示的来源处弹出的箭头。我见过一些 UIActionSheet 弹出窗口有这个箭头。

干杯，阿米特

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-09T18:35:37.557

好吧，我最终还是使用了第三方工具提示[CMTopTipView](https://github.com/chrismiles/CMPopTipView)。它的开销相对较低，只是一个标头和实现。稍微修改它以考虑 ARC。这是我所做的：

```
#import "CMPopTipView.h"

CMPopTipView *navBarLeftButtonPopTipView;

- (void) dismissToolTip
{
   [navBarLeftButtonPopTipView dismissAnimated:YES];
}

- (void) showDoubleTap
{
    navBarLeftButtonPopTipView = [[CMPopTipView alloc] 
       initWithMessage:@"DOUBLE Tap \n to view details"] ;
    navBarLeftButtonPopTipView.delegate = self;
    navBarLeftButtonPopTipView.backgroundColor = [UIColor darkGrayColor];
    navBarLeftButtonPopTipView.textColor = [UIColor lightTextColor];
    navBarLeftButtonPopTipView.opaque = FALSE;
    [navBarLeftButtonPopTipView presentPointingAtView:catButton1 
        inView:self.view animated:YES];
    navBarLeftButtonPopTipView.alpha = 0.75f;

    NSTimer *timerShowToolTip = [NSTimer scheduledTimerWithTimeInterval:5.0 
     target:self 
     selector:@selector(dismissToolTip) userInfo:nil repeats:NO];

 } 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-09T18:20:00.763

如果你在 iPad 上，你可以使用`UIPopoverView`. 您还可以`UIMenuController`在 iPhone 或 iPad 上使用类似“popover”的功能：[教程](http://blogs.captechconsulting.com/blog/john-szumski/getting-started-uimenucontroller-ios-5)。除此之外，您可以创建自己的`UIView`子类来执行此操作，但是您必须自己处理箭头。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-09T18:27:43.753

好吧，我最终做的事情相对简单。我最终使用了没有按钮的 UIActionSheet 只是一个文本。然后使用来自 UIButton 在 self.view 中的坐标平面的 showFromRect。

```
UIActionSheet *popup = [[UIActionSheet alloc] 
initWithTitle:@"DOUBLE Tap \n to view details." 
delegate:self cancelButtonTitle:@"Cancel" 
destructiveButtonTitle:nil otherButtonTitles: nil];

[popup sizeToFit];
popup.tag = 9999; 
CGRect myImageRect = CGRectMake(240.0f, 605.0f, 30.0f, -40.0f);
[popup showFromRect:myImageRect inView:self.view animated:YES]; 
```

我可能只是把它吸起来并使用 CMPopTipView（第三方控件）来调整它的大小和不透明度以及褪色 alpha。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2014-03-08T21:28:38.683

我看到你们中的一些人正在使用 CMPopTip，很棒的“库”。很酷的方式！

只是一些东西，如果你在 iOS7 中使用它，你会有一些弃用。

不推荐使用的文本部分的新用途（这是一个示例）

```
 NSMutableParagraphStyle *paragraphStyle = [[NSMutableParagraphStyle alloc] init];
    paragraphStyle.lineBreakMode = NSLineBreakByWordWrapping;
    paragraphStyle.alignment = self.titleAlignment;

    [self.title drawInRect:titleFrame withAttributes:@{NSFontAttributeName:self.titleFont,NSParagraphStyleAttributeName:paragraphStyle}]; 
```

再见！

# javascript - 如何启用按钮的单击事件？

> ID：14243736
> 
> 赞同：0
> 
> 时间：2013-01-09T18:12:11.730
> 
> 标签：javascript, jquery

我通过以下方式禁用 jQuery 点击事件：

```
$("#button").click( function () { return false;} 
```

我该如何启用它？目的是避免双击并多次运行触发的功能。我想在按下其他按钮时恢复事件。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-09T18:16:49.143

有几个选项，但我最喜欢以下选项：

```
//disable
$("#button").bind('click', function() { return false; });

//enable
$("#button").unbind('click'); 
```

您还可以将按钮上的再次单击绑定到其他回调函数。最后，我可能会建议从点击事件中调用`preventDefault`该事件，具体取决于`#button`实际情况：

```
$("#button").bind('click', function(e) { 
    e.preventDefault();
    return false; 
}); 
```

正如 j08691 所指出的，从 jQuery 1.7 开始，它应该看起来像：

```
$("#button").on('click', function(e) { 
    e.preventDefault();
    return false; 
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-09T18:19:14.313

你也可以使用[`one`](http://api.jquery.com/one/)：

```
$("#button").one('click', function () { /* code here */ }); 
```

该事件在被调用一次后将自行解除绑定。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-09T18:15:36.363

如果你这样做：

```
$("#button").unbind("click"); 
```

该按钮将再次工作，取消绑定功能会从所选元素中删除已注册的事件处理程序，如果您不向它传递参数，它将删除所有已注册的事件。

编辑：如评论中所述，您现在可以使用 on 和 off 方法：

```
$("#button").off("click") 
```

禁用点击和：

```
 $("#button").on("click") 
```

再次启用它们

# assembly - 减少“看你输入”程序的大小

> ID：14243738
> 
> 赞同：-1
> 
> 时间：2013-01-09T18:12:16.270
> 
> 标签：assembly, x86, size, hex, byte

```
B8 00 B8 8E E8 B4 00 CD 16 65 88 00 EF F2 
```

该程序最初有 16 个字节，但我决定牺牲 2 个字节来支持不稳定的输入位置。这是以前的版本（0 0 位置）：

```
65 88 06 00 00 
```

那么可能的候选人是：

```
EF F2 -> 
C3 ->
CF..CB..CC..CE 
```

那些单字节的人也不是帮手。我的微弱想法是改变（不使用）段组件。删除 65 并使用默认数据段。不幸的是，它似乎不起作用。

我做错了什么？昨天我将模块减小到 13 字节大小，尽管到目前为止它还不稳定，以至于每个符号都出现在单独的屏幕位置。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-09T19:56:15.270

好吧，它显然是 16 位实模式 x86 代码、用于 DOS 或其他平面二进制文件的 .com 文件。

```
$echo 'B8 00 B8 8E E8 B4 00 CD 16 65 88 00 C3' | udcli -x -16

0000000000000000 b800b8           mov ax, 0xb800          
0000000000000003 8ee8             mov gs, ax              
0000000000000005 b400             mov ah, 0x0             
0000000000000007 cd16             int 0x16                
0000000000000009 658800           mov [gs:bx+si], al      
000000000000000c c3               ret 
```

它假定`bx`并且`si`具有一些可接受的值，因此`0xb800:bx+si`指向当前文本视频模式使用的视频内存区域。嗯，这是可能的，但我不会推荐它。

无论如何，如果仍然允许对寄存器值的假设，它可以缩短至少 4 个字节。如果可以假设它`bx`具有`si`有用的值（见上文），那么它`di`也可能`0xb800:di`指向当前文本视频模式使用的视频内存区域。

```
00000000  B800B8            mov ax,0xb800
00000003  8EC0              mov es,ax
00000005  98                cbw
00000006  CD16              int 0x16
00000008  AA                stosb
00000009  C3                ret 
```

首先设置并存储到`ax`（几种BIOS文本视频模式的段地址）。`0xb800``es`

然后将字节`al`(0) 转换为 word `ax`，将 的符号位扩展`al`为`ax`，结果`ax`= 0。

`int 16h`然后使用 BIOS 键盘中断( `ah`= 0)从键盘读取输入（并等待输入，如有必要）。ASCII码输入`al`，扫描码输入`ah`。

最后将 ASCII 代码存储到视频内存（到`[es:di]`）以`stosb`在屏幕上打印字符，然后返回到 DOS（或任何操作系统）`ret`。

**编辑：**实际上可以将大小降低到 12 个字节，并且仍然有一个稳定的输出地址，如下所示：

```
00000000  6800B8            push word 0xb800
00000003  1F                pop ds
00000004  31C0              xor ax,ax
00000006  CD16              int 0x16
00000008  A20000            mov [0x0],al
0000000B  C3                ret 
```

希望这可以帮助。

# php - Windows 上的 Memcached（不是 memcache）PHP 扩展

> ID：14243745
> 
> 赞同：12
> 
> 时间：2013-01-09T18:13:20.323
> 
> 标签：php, memcached, xampp, pecl

我似乎找不到 PHP 的 Memcache **D**扩展。

php_memcache.dll 有一些编译，但不一样。

我缺少的主要内容是[getMulti()](http://php.net/manual/en/memcached.getmulti.php)，它在 Memcache 中不存在。

到目前为止，我找到了这个，但没有 DLL：

[http://pecl.php.net/package/memcached](http://pecl.php.net/package/memcached)

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-09T20:53:19.560

正式 - 它不存在。不过，有几个人创建了自己的 DLL。这是一个创建 dll 的人的博客：

[http://trondn.blogspot.com/2010/07/libmemcached-on-win32.html](http://trondn.blogspot.com/2010/07/libmemcached-on-win32.html)

以下是包含源代码的存储库的链接，因此您可以为 memcached 构建自己的 DLL：

[http://bazaar.launchpad.net/~trond-norbye/libmemcached/mingw32/files](http://bazaar.launchpad.net/~trond-norbye/libmemcached/mingw32/files)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-10-29T09:18:48.503

我知道 memcached 还有一些其他功能，但它的界面与 memcache 扩展的界面几乎相同。你可以很容易地摆脱这样的代码，就我而言，它运行得很好。如果您没有加载 memcached，请创建此文件：

```
 <?php

    class Memcached {
       const OPT_LIBKETAMA_COMPATIBLE = true;
       const OPT_COMPRESSION = true;
       const OPT_NO_BLOCK = true;
       //if you code relies on any other constants define them to avoid
       //undefined constant notice

       //http://www.php.net/manual/en/memcached.constants.php

       public $_instance;
       public function __construct() {
            $this->_instance = new Memcache;
       }

       public function __call($name, $args) {
            return call_user_func_array(array($this->_instance, $name), $args);
       }

       public function setOption() {}
    } 

```

要么包括它，要么配置自动加载器来拾取它。当然，您需要正确配置的 memcache 实例和 addServer 调用，但如果代码库假定 Memcached，则此类调用应该已经在代码中。我希望它可以帮助某人/

# ruby-on-rails - 使用 gets.chomp() 更改变量

> ID：14243746
> 
> 赞同：-3
> 
> 时间：2013-01-09T18:13:33.463
> 
> 标签：ruby-on-rails, ruby, gets, chomp

我正在尝试使用此代码写入文件：

```
 puts "-------------------- TEXT-EDITOR --------------------"
def tor(old_text)
  old_text = gets.chomp #
end

$epic=""

def torr(input)

  tore=  $epic += input + ", "

File.open("tor.txt", "w") do |write|
  write.puts tore
  end
end

loop do
  output = tor(output)
  torr(output)
end 
```

我已经阅读了 ruby​​ 编程的终极指南，它说如果我想在我正在写入的文件中使用新行，`File.open` 我必须使用`"line one", "line two` 如何使用gets.chomp() 来实现这一点？试试我的代码，你会明白我的意思谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-09T18:59:22.933

该`gets`方法将引入任意数量的文本，但当您点击“Enter”（或一旦`STDIN`接收`\n`）时，它将终止。此输入记录分隔符存储在全局变量`$/`中。如果您更改脚本中的输入分隔符，该`gets`方法实际上会将“Enter”键换成您将全局变量更改为的任何内容。

```
$/ = 'EOF' # Or any other string
lines = gets.chomp
> This is
> multilined
> textEOF
lines #=> 'This is\nmultilined\ntext' 
```

输入您想要的任何内容，然后在最后输入“EOF”。一旦它“看到”EOF，它将终止该`gets`方法。该`chomp`方法实际上会从末尾剥离字符串“EOF”。

然后将其写入您的文本文件，`\n`并将转换为新行。

```
File.open('newlines.txt', 'w') {|f| f.puts lines} 
```

换行符.txt：

> 这是
> 多行
> 文本

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-09T18:21:50.473

如果您不使用 .chomp() ，则每当您写一个新行时都会添加 \n 字符，如果您将其保存到文件中，它也会有一个新行。.chomp() 从输入的末尾删除那些转义字符。

如果这不能回答你的问题，我很抱歉我不明白。

# mysql - Mysql - 基于多行条件选择

> ID：14243748
> 
> 赞同：2
> 
> 时间：2013-01-09T18:13:44.120
> 
> 标签：mysql

假设我有这个：

```
|ID | Val |  
+---+-----+  
| 1 |  10 |  
| 1 |  20 |  
| 1 |  30 |  
| 2 |  10 |  
| 2 |  20 |  
| 3 |  20 |  
| 3 |  30 |  
+---+-----+ 
```

我只需要选择那些同时具有 10 和 30 值的 ID。所以，用英语，给我一个同时包含 10 和 30 值的 ID。我该怎么做？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-09T18:18:51.317

你将使用这样的东西：

```
select id
from yourtable
where val in (10, 30)
group by id
having count(distinct val) =2 
```

请参阅[带有演示的 SQL Fiddle](http://sqlfiddle.com/#!2/b451d/1)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-09T18:19:21.907

```
SELECT DISTINCT `ID` FROM tablename WHERE `VAL` IN ('10','30'); 
```

# regex - 扩展 MVC FoolProof 验证

> ID：14243754
> 
> 赞同：3
> 
> 时间：2013-01-09T18:15:17.687
> 
> 标签：regex, asp.net-mvc, asp.net-mvc-3, validation, asp.net-mvc-validation

我想在我的 MVC 3 应用程序中使用**[MVC FoolProof Validation 。](http://foolproof.codeplex.com/)**

我需要数字验证，也接受 N/A 或 n/a。所以我决定创建自己的自定义验证属性，例如**NumericAllowNAAttribute**，并添加一个 jQuery 验证自定义采用者方法。

我重新访问了 MVC Foolproof 并决定使用它，因为它已经有其他有用的方法构建。我也想要那些。现在我如何编写一个使用 jQuery 验证和服务器端在客户端工作的 CustomValidationAttribute？

在扩展 MVC Foolproof 上搜索谷歌我没有得到任何。

> 是否有人遇到过使用 jQuery 验证插件在服务器和客户端中扩展或实现这种验证工作？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2015-05-18T19:32:49.777

您可以通过定义一个继承 ContingentValidationAttribute 的新属性来扩展万无一失的 MVC（或万无一失的其他属性之一，但大陆非常接近准系统）。

您将需要定义以下方法覆盖。

```
public override bool IsValid(object value, object dependentValue, object container)
protected override IEnumerable<KeyValuePair<string, object>> GetClientValidationParameters()
public override string ClientTypeName 
```

ClientTypeName 字符串值由 jquery 不显眼的验证使用。

此外，请务必使用 DataAnnotationsModelValidatorProvider 注册您的适配器（万无一失的是在其类的构造函数中进行）。

```
DataAnnotationsModelValidatorProvider.RegisterAdapter(typeof(MyCustomValidationAttribute), typeof(FoolproofValidator)); 
```

一旦你定义了你的服务器端验证逻辑，你需要在客户端注册 jquery 不显眼的验证：

```
jQuery.validator.addMethod("clienttypenameyouemitontheserver", function(value, element, params) {
    // perform your checks here and return true or false
    return true; 
});

var $Unob = $.validator.unobtrusive;
$Unob.adapters.add("clienttypenameyouemitontheserver", ["param1", "param2", "paramZ"], function (options) {
    var value = {
        param1: options.params.param1,
        param2: options.params.param2,
        paramZ: options.params.paramZ
    };
    setValidationValues(options, "clienttypenameyouemitontheserver", value);
}); 
```

# android - 应用程序是否完全划分？

> ID：14243758
> 
> 赞同：1
> 
> 时间：2013-01-09T18:16:15.237
> 
> 标签：android, crash, user-permissions

我遇到了一个让我感到困惑的问题。似乎 android 应用程序没有完全划分是这种情况。

我有一部三星 SIII 手机，我正在构建用作模板的应用程序。基本上它是同一个应用程序，但内容不同，内容是在启动时从我们的数据库中检索的。

所以我的过程是创建一个应用程序让它工作，然后通过重构将它复制到另一个包，我更改数据检索调用，我有两个应用程序，内部功能和编码基本相同。

我所看到的是，我启动了一个应用程序，它似乎工作得很好，我可以打开和关闭它几次而没有问题，然后突然出现一个弹出窗口，显示某个应用程序已停止运行。问题是我从来没有打开过我可以打开其中一个副本的应用程序，但我什至忘记了我的应用程序在手机上崩溃了，更不用说启动它了。

我经常关闭所有正在运行的应用程序，以确保一切顺利运行，我从未看到这个神秘的应用程序在任何地方运行。

关闭消息只是简单地出现，但它总是在运行运行相同代码但并非一直运行的应用程序之后。

这可能是我看到其他一些问题但无法说出其他问题的基础的原因是两组代码在我的流程中几乎相同，其中一组有效，另一组无效

我很困惑 谁能帮忙清除烟雾？

这可能有助于它是我的权限列表

```
uses-permission android:name="com.android.vending.BILLING" 
uses-permission android:name="android.permission.INTERNET" 
uses-permission android:name="android.permission.WRITE_EXTERNAL_STORAGE" 
uses-permission android:name="android.permission.READ_PHONE_STATE" 
uses-permission android:name="android.permission.ACCESS_WIFI_STATE" 
uses-permission android:name="android.permission.BLUETOOTH" 
```

我所有模板应用程序的内容都将非常相似，除了包名称版本等。

```
<manifest xmlns:android="http://schemas.android.com/apk/res/android"
package="com.blah.blahblah"
android:versionCode="2"
android:versionName="0.75" >
<uses-sdk
    android:minSdkVersion="5"
    android:targetSdkVersion="7" />
<!-- VERY IMPORTANT! Don't forget this permission, or in-app billing won't work. -->
<uses-permission android:name="com.android.vending.BILLING" />
<uses-permission android:name="android.permission.INTERNET" />
<uses-permission android:name="android.permission.WRITE_EXTERNAL_STORAGE" />
<uses-permission android:name="android.permission.READ_PHONE_STATE" />
<uses-permission android:name="android.permission.ACCESS_WIFI_STATE" />
<uses-permission android:name="android.permission.BLUETOOTH" />
<application
    android:icon="@drawable/ic_launcher"
    android:label="@string/app_name" >
    <activity
        android:name=".IntroActivity"
        android:label="@string/title_activity_main"
        android:screenOrientation="portrait" >
        <intent-filter>
            <action android:name="android.intent.action.MAIN" />
            <category android:name="android.intent.category.LAUNCHER" />
        </intent-filter>
    </activity>
    <activity
        android:name=".MainActivity"
        android:configChanges="orientation|keyboardHidden"
        android:screenOrientation="portrait" >
    </activity>
    <activity
        android:name=".InfoActivity"
        android:configChanges="orientation|keyboardHidden"
        android:screenOrientation="portrait" >
    </activity>
    <activity
        android:name=".AudioActivity"
        android:configChanges="orientation|keyboardHidden"
        android:screenOrientation="portrait" >
    </activity>
    <activity
        android:name=".MovePlayActivity"
        android:configChanges="orientation|keyboardHidden"
        android:screenOrientation="portrait" >
    </activity>
    <activity
        android:name=".WebActivity"
        android:configChanges="orientation|keyboardHidden"
        android:screenOrientation="portrait" >
    </activity>
</application> 
```

这是第二个

```
<manifest xmlns:android="http://schemas.android.com/apk/res/android"
package="com.blah2.blah2blah2"
android:versionCode="4"
android:versionName="1.5" >
<uses-sdk
    android:minSdkVersion="4"
    android:targetSdkVersion="7" />
<!-- VERY IMPORTANT! Don't forget this permission, or in-app billing won't work. -->
<uses-permission android:name="com.android.vending.BILLING" />
<uses-permission android:name="android.permission.INTERNET" />
<uses-permission android:name="android.permission.WRITE_EXTERNAL_STORAGE" />
<uses-permission android:name="android.permission.READ_PHONE_STATE" />
<uses-permission android:name="android.permission.ACCESS_WIFI_STATE" />
<uses-permission android:name="android.permission.BLUETOOTH" />
<application
    android:icon="@drawable/ic_launcher"
    android:label="@string/app_name" >
    <activity
        android:name=".IntroActivity"
        android:label="@string/title_activity_main"
        android:screenOrientation="portrait" >
        <intent-filter>
            <action android:name="android.intent.action.MAIN" />
            <category android:name="android.intent.category.LAUNCHER" />
        </intent-filter>
    </activity>
    <activity
        android:name=".MainActivity"
        android:configChanges="orientation|keyboardHidden"
        android:screenOrientation="portrait" >
    </activity>
    <activity
        android:name=".AudioActivity"
        android:configChanges="orientation|keyboardHidden"
        android:screenOrientation="portrait" >
    </activity>
    <activity
        android:name=".MovePlayActivity"
        android:configChanges="orientation|keyboardHidden"
        android:screenOrientation="portrait" >
    </activity>
    <activity
        android:name=".WebActivity"
        android:configChanges="orientation|keyboardHidden"
        android:screenOrientation="portrait" >
    </activity>
</application> 
```

我确实看到最低 SDK 版本发生了变化

# php - header('HTTP/1.1 404 Not Found'); 什么也没做

> ID：14243760
> 
> 赞同：2
> 
> 时间：2013-01-09T18:16:27.780
> 
> 标签：php, redirect, header, http-status-code-404

试图将页面重定向到我的自定义 404 错误文档，但徒劳无功。这是代码

```
header('HTTP/1.1 404 Not Found', true, 404); 
```

但即使标题信息根据需要更改，它也会保持在同一页面上

```
HTTP/1.1 404 Not Found
Date: Wed, 09 Jan 2013 18:10:44 GMT
Server: Apache/2.2.21 (Win32) mod_ssl/2.2.21 OpenSSL/1.0.0e PHP/5.3.8 mod_perl/2.0.4 Perl/v5.10.1
X-Powered-By: PHP/5.3.8 
```

PHP页面继续，没有实现重定向！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-09T18:27:18.950

您应该`header("Location: /errors/junk.php");`按照 Apache 对自定义错误文档的处理方式进行操作，只是在服务器级别而不是在 PHP 中。我相信 Apache 使用 301 重定向，但我可能是错的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-09T18:40:22.787

您明显的文件结构：

```
/
  .htaccess
  request.php
  ...
  errors/
    junk.php 
```

.htaccess

```
ErrorDocument 404 /errors/junk.php 
```

请求.php

```
header('HTTP/1.1 404 Not Found', true, 404);
echo "Despite the 404 header this ~file~ actually exists as far as Apache is concerned.";
exit; 
```

错误/垃圾.php

```
header('HTTP/1.1 404 Not Found', true, 404);
echo "The file you're looking for ~does not~ exist.";
echo "<pre>" . var_export($_SERVER, TRUE) . "</pre>";
exit; 
```

[http://yoursite.com/request.php](http://yoursite.com/request.php)将显示：

> 尽管有 404 标头，但就 Apache 而言，这个 ~file~ 实际上存在。

[http://yoursite.com/filethatdoesntexist.php](http://yoursite.com/filethatdoesntexist.php)将显示：

> 您要查找的文件~不存在~。
> 
> [可能有助于编写自定义 404 处理程序代码的 $_SERVER 转储]

如果您有一个存在的文件，但您希望它假装它是 404，您可以在 PHP 中将重定向编写为：

```
header('Location: http://mysite.com/errors/junk.php');
exit; 
```

这会将浏览器重定向到完整的 URL，或者简单地：

```
include('errors/junk.php');
exit; 
```

这将使用户留在同一页面 URL，但会显示您的错误代码。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-09T18:44:33.873

不要`3xx`对错误页面使用重定向。他们所做的只是让搜索引擎误以为该页面存在于不同的位置。您可以尝试这种方法：

```
header($_SERVER['SERVER_PROTOCOL'] . ' 404 Not Found');
require_once("errors/404.php");
die; 
```

修改错误页面，使其可以直接执行（例如，当 Apache 自己处理 404 错误时）或包含（在您的脚本中）。

如果`include_once`不是一个选项，您可以执行以下操作：

```
header($_SERVER['SERVER_PROTOCOL'] . ' 404 Not Found');
echo file_get_contents("http://yoursite.com/errors/404.php");
die; 
```

此操作对最终用户将保持不可见。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-11-27T19:42:46.957

如果您使用的是 FastCGI，则无法通过以下方式发送 404 响应标头

```
header('HTTP/1.1 404 Not Found', true, 404); 
```

相反，您必须使用

```
header('Status: 404 Not Found'); 
```

此外，此`header('Status:...')`指令不能与`header('Location:...')`. 因此，在 FastCGI 的情况下，以下代码将给出正确的 404 响应代码并重定向到自定义 404 页面：

```
header('Status: 404 Not Found');
echo file_get_contents('http://www.yoursite.com/errors/custom404.html');
exit; 
```

# ios - 尝试通过 iOS 中的 NSNotifications 一次调用多个视图控制器

> ID：14243771
> 
> 赞同：0
> 
> 时间：2013-01-09T18:17:04.953
> 
> 标签：ios, nsnotificationcenter, nsnotification

我有一个正在开发的应用程序，它有几个视图控制器，每个视图控制器都显示一个供用户执行的测试。目前，用户可以单独浏览每一个。但是，我正在尝试实现一个类似向导的功能，用户可以选择多个测试或所有测试，然后应用程序将遍历每个测试，将每个屏幕呈现给用户，并且一旦用户提交了输入，应用程序将按顺序移动到下一个测试。完成所有测试后，用户将返回主屏幕。从我读到的内容来看，NSNotifications 将是做到这一点的最佳方式，但老实说，我对此并不陌生，需要帮助。我意识到我应该在启动向导的方法中包含以下行：

```
[[NSNotificationCenter defaultCenter] addObserver:self
                                             selector:@selector(testChange:)
                                                 name:@"Test"
                                               object:nil]; 
```

我也知道，一旦每个viewController运行完毕，就是通过以下方式发布通知：

```
[[NSNotificationCenter defaultCenter] postNotificationName:@"Test" object:self]; 
```

我的问题是，如果用户从表中选择了十个或二十个视图控制器，并且这些选择存储在一个数组中，我是否需要对 addObserver 方法进行尽可能多的调用，以及尽可能多的 postNotifications？我想做的只是简单地遍历每个视图控制器（由用户选择），一旦用户完成向该视图控制器提交输入，该视图控制器应该发送一条消息，用户应该转到下一个视图控制器，完成所有测试后，返回主屏幕。仅供参考，我需要调用每个 ViewController 的 (viewDidLoad) 方法。

如果我的问题令人困惑，我深表歉意。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-09T19:30:55.100

你是对的，你需要为你拥有的所有视图控制器调用 addObserver，如果你希望它们都接收通知。我创建了一个小代码片段来向您展示它是如何完成的。我想你有你想要的所有答案。试试看。

```
#import "ViewController.h"

@interface Employee:NSObject
@end

@implementation Employee
-(void)testMethod2:(NSNotification *)not{
    NSLog(@"Test method2 is called");
}
@end

@interface ViewController ()

@end

@implementation ViewController

- (void)viewDidLoad
{
    [super viewDidLoad];
    // Do any additional setup after loading the view, typically from a nib.
}

- (void)didReceiveMemoryWarning
{
    [super didReceiveMemoryWarning];
    // Dispose of any resources that can be recreated.
}

- (IBAction)postNotifications:(id)sender {
    Employee *employee = [[Employee alloc] init];
    [[NSNotificationCenter defaultCenter] addObserver:self selector:@selector(testMethod:) name:@"Notification" object:nil];
    [[NSNotificationCenter defaultCenter] addObserver:self selector:@selector(testMethod1:) name:@"Notification" object:nil];
     [[NSNotificationCenter defaultCenter] addObserver:employee selector:@selector(testMethod2:) name:@"Notification" object:nil];
    [[NSNotificationCenter defaultCenter] postNotificationName:@"Notification" object:nil];
}

-(void)testMethod:(NSNotification *)not{
    NSLog(@"Test method is called");
}
-(void)testMethod1:(NSNotification *)not{
    NSLog(@"Test method1 is called");
}
@end 
```

# jquery - 如何在 jQuery 中显示活动的 div 切换后？

> ID：14243772
> 
> 赞同：-1
> 
> 时间：2013-01-09T18:17:04.707
> 
> 标签：jquery, toggle

我有一个嵌套菜单，其中包含可切换 onclick 的内容 div。默认情况下，当页面加载时，菜单会显示所有内容 div 隐藏。我试图显示页面何时加载（没有任何点击）处于活动状态的内容 div（class="active"）。这是我的 HTML：

```
<ul> 
 <li><h3 class="toggle_action"> Mailing Lists</h3>  // toggle trigger
  <ul class="div_toggle">  // the content div
   <li><h3 class="toggle_action"><a href="/list" class="active">Overview</a></h3></li>
   <li>...another link...</li>
  </ul>
 </li>
</ul> 
```

这是我的 jQuery：

```
(function ($) {
   $(document).ready(function() {
        $(".div_toggle").slideUp();
        $(".active").Show();
        $(".toggle_action").click(function(){
            $(this).next(".div_toggle").slideToggle("slow");
        });         
    });    
  })(jQuery); 
```

我已经搜索了几个小时，但只能找到显示/隐藏 onclick 的代码，而且我必须在页面加载时遗漏一些东西才能做到这一点。请帮我指出正确的方向！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-09T18:19:56.160

让我大吃一惊的一件事是您使用的是 $('.active').Show() ，它不是 jQuery 方法。你想要 $('.active').show()。注意小写的“S”。

此外，您没有关闭 H3 标签，而是隐藏了父元素。

具有相同逻辑的简单示例：

```
<div class="a">
      <div class="b">Apple</div>
      <div class="c">Pear</div>
</div>

$(function(){
  $('.a').slideUp();
  $('.b').show();

  // No matter what you will never see .b or .c.  They will always be hidden
     when .a slides up

}) 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-01-09T18:20:09.170

应该`.show()`不是`.Show()`

工作jsfiddle示例：http: [//jsfiddle.net/MMdqp/](http://jsfiddle.net/MMdqp/)

# java - 不同视图的 Java 3D Coverflow（在 3D 对象上映射 2D 内容）-> 哪个框架/技术

> ID：14243775
> 
> 赞同：0
> 
> 时间：2013-01-09T18:17:16.593
> 
> 标签：java, 3d, jogl, java-3d, coverflow

我想用 JAVA 编写一个程序，它提供以下功能：显示视频、图片、文本，如果可能的话，还有一个浏览器（不需要很多功能）。

我的想法是将这些视图映射到（某种）类似coverflow的gui上。例如，一个立方体，它的每一侧都有一个视频或图片，并且可以由用户旋转。

现在我正在寻找合适的技术来做到这一点。我找到了一个名为“twinkle”的旧演示，它显示了我想做的一些事情（3D“窗格”上的图片）： http: [//jroller.com/gfx/entry/a_swing_opengl_photo_viewer](http://jroller.com/gfx/entry/a_swing_opengl_photo_viewer) 预告片给人留下了很好的印象.

我应该像在演示中那样使用 JOGL 和 Swing 吗？还是只有JOGL？源代码看起来很复杂，我无法让它运行。

是否可以/推荐使用 Java3D？

我很困惑，因为我发现的大多数东西都是相当古老的文章等。

你有什么建议吗？

谢谢，鲍勃

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-09-22T17:22:40.017

如果您想手动完成并且没有诸如 OpenGL 之类的预制 api，您可以帮助 youtube 并找到一个名为 JavaTutorials101 的人，他有一个 14 部分系列关于将 3D 对象渲染到屏幕上只使用普通的 java 图形和多边形。一旦你创建了“引擎”散文，你可以将图像附加到多边形，或者将视频加载到它，我知道图片会很简单，视频我不确定，但我确定你是否加载了它一张一张的或有办法将其流式传输，这应该不是问题。

# .net - 在 vb.net 中使用显示对话框关闭父表单

> ID：14243777
> 
> 赞同：-1
> 
> 时间：2013-01-09T18:17:22.207
> 
> 标签：.net, vb.net, forms

我有一个表格，可以说表格 A，它有两个按钮，确定和清除。在清除按钮上显示“确定取消”对话框。

当用户单击确定或取消按钮时，表单 A（它是对话框表单的父级正在关闭。我已经对其进行了调试，我发现当用户单击确定或取消表单关闭事件时，会引发表单 A 正在关闭。你能解释为什么会这样吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-09T18:22:38.127

如果使用显示表单，表单的接受和取消按钮（`AcceptButton1`和`CancelButton`属性）将导致它关闭`.showdialog`。`DialogResult`您可以通过将属性设置为“无”来使用“接受”按钮来防止这种情况。

# c++ - 在 C++ 中，得到一个错误说“std::string {aka std::basic_string }' 不是派生自 'const __gnu_cxx::__normal_iterator<_IteratorL, _Container>"

> ID：14243778
> 
> 赞同：0
> 
> 时间：2013-01-09T18:17:24.597
> 
> 标签：c++

```
int webServerPort = -1;    

void configure(std::string responseFile, callback_function call_back, std::string urlRegex = NULL) {
        std::string url = "http://0.0.0.0:" + webServerPort + "fake_settings/?file=" + responseFile;
        if(urlRegex != NULL) {  // GOT ERROR HERE
            url += "&pattern=" + urlRegex;
        } 
```

得到一个错误，实际上它不是称为“错误”而是“注释”

错误说：注意：'std::string {aka std::basic_string}' 不是从 'const __gnu_cxx::__normal_iterator<_IteratorL, _Container>' 派生的

有人知道吗？

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-09T18:30:40.203

两件事：首先，您默认`urlRegex`为`NULL`. 你的意思是这是空字符串吗？如果是这样，请不要打扰，因为无论如何这是字符串的默认设置。然后，当您检查是否为`urlRegex`NULL 时，请改为：

```
if(!urlRegex.empty()) { // ... 
```

其次，您试图将`webServerPort`（一个 int）添加到 std::string 上。那是不合法的。如果您真的想这样做，那么解决方法是：

```
std::ostringstream ss;
ss << "http://0.0.0.0:" << webServerPort << "fake_settings/?file=" << responseFile;
std::string url = ss.str(); 
```

# c++ - OpenSSL SHA1 校验和

> ID：14243784
> 
> 赞同：0
> 
> 时间：2013-01-09T18:17:38.637
> 
> 标签：c++, openssl

我在 Visual Studio 中使用 OpenSSL 来实现 OpenSSL 的不同用途。

我只是将二进制文件读入缓冲区并将 SHA1 应用于它

```
EVP_DigestUpdate( hCtx, fin_buf, fin_size );
int rez=EVP_DigestFinal( hCtx, pTmpBuffer, &nDigestSz );
pDigest = new unsigned char[ nDigestSz ];
memcpy( pDigest, pTmpBuffer, nDigestSz * sizeof( unsigned char ) ); 
```

fin_buf 保存文件的字节数。

```
FILE *fhash = fopen("hash.sha1", "wb");
fwrite(pDigest, 1, nDigestSz, fhash);
fclose(fhash); 
```

在这里，我将缓冲区写入 .sha1 文件。

我需要检查文件的哈希值。谁能给我看一个在 OpenSSL C++ 中检查哈希的例子吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-09T18:26:38.753

哈希的主要思想是，当您在相同的输入上计算它时，您将获得相同的哈希值。如果您阅读原始文件并执行您的第一个代码部分，则摘要的值应该等于 .sha1 文件的内容。

# ios - AUGraph 3D Mixer 噼啪声

> ID：14243785
> 
> 赞同：2
> 
> 时间：2013-01-09T18:17:41.697
> 
> 标签：ios, objective-c, audio, core-audio

我有一个 AUGraph 可以使用此设置播放和录制音频：

```
RemoteIO      ->                                 -> RemoteIO
                  Mulichannel Mixer -> 3D Mixer 
Read Callback ->                                 -> Write Callback 
```

我的问题是我在录制的声音中有爆裂声。没有 3D 混音器，声音很好。但我需要他调整播放率...

音频格式：

```
 memset(&_audioFormat, 0, sizeof(_audioFormat));
size_t bytesPerSample = sizeof (UInt16);
_audioFormat.mFormatID          = kAudioFormatLinearPCM;
_audioFormat.mFormatFlags       = kAudioFormatFlagsCanonical;
_audioFormat.mBytesPerPacket    = bytesPerSample;
_audioFormat.mFramesPerPacket   = 1;
_audioFormat.mBytesPerFrame     = bytesPerSample;
_audioFormat.mChannelsPerFrame  = 1;
_audioFormat.mBitsPerChannel    = 8 * bytesPerSample;
_audioFormat.mSampleRate        = 22100.0f; 
```

我不知道为什么 3D 混音器会添加噼啪声-.- 这是一个小示例音频：[单击](http://www.file-upload.net/download-7034313/0.wav.html)

希望有足够的信息来找到解决方案。谢谢 ：）

**一些附加信息：**

有噼啪声

```
 AudioUnitGraph 0x7F8000:
  Member Nodes:
    node 1: 'auou' 'rioc' 'appl', instance 0x1cd66d40 O I
    node 2: 'aumx' 'mcmx' 'appl', instance 0x1e055b40 O I
    node 3: 'aumx' '3dem' 'appl', instance 0x1e05e7a0 O I
  Connections:
    node   1 bus   1 => node   2 bus   1  [ 1 ch,  22000 Hz, 'lpcm' (0x0000000C) 16-bit little-endian signed integer]
    node   2 bus   0 => node   3 bus   0  [ 1 ch,  22000 Hz, 'lpcm' (0x0000000C) 16-bit little-endian signed integer]
    node   3 bus   0 => node   1 bus   0  [ 2 ch,  44100 Hz, 'lpcm' (0x00000C2C) 8.24-bit little-endian signed integer, deinterleaved]
  Input Callbacks:
    {0x12d9c1, 0x1cd65f30} => node   2 bus   0  [1 ch, 22000 Hz]
  CurrentState:
    mLastUpdateError=0, eventsToProcess=F, isRunning=F 
```

无裂纹

```
 AudioUnitGraph 0x7E7000:
  Member Nodes:
    node 1: 'auou' 'rioc' 'appl', instance 0x1e888810 O I
    node 2: 'aumx' 'mcmx' 'appl', instance 0x1e88a0e0 O I
    node 3: 'aumx' '3dem' 'appl', instance 0x1e88b200 O  
  Connections:
    node   1 bus   1 => node   2 bus   1  [ 1 ch,  22000 Hz, 'lpcm' (0x0000000C) 16-bit little-endian signed integer]
    node   2 bus   0 => node   1 bus   0  [ 1 ch,  22000 Hz, 'lpcm' (0x0000000C) 16-bit little-endian signed integer]
  Input Callbacks:
    {0x1469b9, 0x1d5bffa0} => node   2 bus   0  [1 ch, 22000 Hz]
  CurrentState:
    mLastUpdateError=0, eventsToProcess=F, isRunning=F 
```

**更新：**

我认为问题仅在 AudioGraph 重新启动后发生。

```
1.) CheckError(AUGraphStart(self.graph), "Error starting graph. - error code");
2.) Recording <- NO CRACKLE!
3.) CheckError(AUGraphStop(self.graph), "Error stopping graph. - error code");
4.) CheckError(AUGraphStart(self.graph), "Error starting graph. - error code");
5.) Recording <- CRACKLE! 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-14T18:11:42.253

我找到了解决方法，但没有找到解决方案。只需将 3DMixer 替换为 kAudioUnitSubType_Varispeed AU。

```
speedDescription.componentFlags = 0;
speedDescription.componentFlagsMask = 0;
speedDescription.componentType = kAudioUnitType_FormatConverter;
speedDescription.componentSubType = kAudioUnitSubType_Varispeed;
speedDescription.componentManufacturer = kAudioUnitManufacturer_Apple; 
```

我希望这可以帮助别人！

# c# - 我的网络服务器如何向本地运行的应用程序发送信号（包括数据）

> ID：14243786
> 
> 赞同：0
> 
> 时间：2013-01-09T18:17:42.880
> 
> 标签：c#, php, networking, web

我想在我的个人计算机上构建一个网站*（在互联网上）*`PHP`和一个应用程序*（在 C# 中） 。*例如，当我单击一个按钮*（来自网站）*时，应用程序会弹出一条消息。

一种解决方案，当我单击该按钮时，命令*（文本）*会保存在数据库中，如果有新命令，我的应用程序每 2 秒检查一次该数据库*（在 Internet 上） 。*

但我认为这个解决方案的性能最差，在大多数情况下应用程序会运行`12h/day`，并且可能会在该按钮上单击 5 次。

另一种解决方案是在我单击按钮*（来自网站）*后，继续我的应用程序并单击某个按钮以查找是否有新命令；但我不喜欢这个解决方案。

我想要一个解决方案，在我打开应用程序后我无事可做。提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-09T18:25:43.190

如果您没有从服务器到客户端的通道，则只有两种选择：

1.  使用轮询（这是你所描述的）
2.  使用某种[`Comet`](http://en.wikipedia.org/wiki/Comet_%28programming%29)Web 应用程序模型

由于服务器与客户端没有连接，它无法发送通知客户端新数据准备就绪的信号。对于具有实时更新功能的 Web 应用程序（例如聊天应用程序）而言，这是一个众所周知的问题。[Comet](http://en.wikipedia.org/wiki/Comet_%28programming%29) Web 应用程序模型是 facebook 或 twitter 等大型网站用来解决此问题的模型之一。

# java - java同步方法 - 它是如何工作的

> ID：14243790
> 
> 赞同：7
> 
> 时间：2013-01-09T18:17:51.627
> 
> 标签：java, synchronized

我想我知道这一点，但希望得到证实。

显然同步阻止了其他线程访问它，但我看到了很多例子，比如

```
 public synchronized void setValue(int value)
   {
       balance=value;
   } 
```

我的想法是对的吗，如果该方法只像上面那样做一行，那么同步就没有意义了。

谢谢

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2013-01-09T18:20:33.650

> 我的想法是对的吗，如果该方法只像上面那样做一行，那么同步就没有意义了。

不，您似乎认为同步仅意味着原子性。

但它实际上提供的远不止这些——特别是，它保证：

*   原子性，这对于单行分配没有用（除了下面的边界情况）
*   能见度
*   防止重新排序
*   互斥：同一监视器上同步的 2 个方法不能同时运行

在您的示例中，如果没有同步，您无法保证如果一个线程调用您的方法而另一个`balance`线程随后读取，则第二个线程将看到更新的值。

请注意，必须确保两端的可见性：写入和读取需要同步，使用相同的监视器。所以吸气剂`getBalance`也需要同步。

**边界情况**：[不保证双重和长赋值是原子](http://docs.oracle.com/javase/specs/jls/se7/html/jls-17.html#jls-17.7)的。因此，即使在下面这样的单行示例中，如果没有 synchronized 关键字，一个线程也可能更新双精度的前 32 位，而另一个线程更新后 32 位，从而创建一个新的混合平衡变量。

```
public synchronized void setValue(double value) {
    balance = value;
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-09T18:19:19.607

它不仅阻止其他线程访问此方法：它还阻止其他线程访问具有相同锁的任何块或方法（此处为实例）。

关键是，如果另一个同步方法更长，您可以确保不会同时运行这个同步方法。

如果其他方法依赖于`balance`在其执行期间不改变的变量，这一点很重要。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-09T18:22:22.387

同步方法做了两件事：

*   不允许超过 1 个线程执行该方法
*   将线程内存缓存与共享内存同步。

在您的情况下，只有一个线程能够更新该变量，并且所有其他线程都将在变量中看到最新数据`balance`。

如果没有同步，其他线程将使用（很可能）他们的缓存值，因此在程序执行后`balance`您将获得不一致的值。`balance`

[您可以在此演示文稿](http://www.slideshare.net/leefs/effective-java-concurrency)中找到对您的问题的非常好的解释。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-09T18:21:31.903

多个线程可以调用具有不同值的 setValue 方法。因此，如果您真的想确保一个线程的更改对另一个线程可见，则应该同步方法。

# android - 为什么应用程序突然关闭而没有显示任何错误？

> ID：14243794
> 
> 赞同：8
> 
> 时间：2013-01-09T18:17:59.990
> 
> 标签：android

**我的应用程序是做什么的？**该应用程序正在从照片库中选择一张照片。

**我的问题是什么？**一旦我从图库中选择照片，它就会毫无错误地关闭。

**我做了什么？**我增加了设备的内存，但它不起作用。我从 proyect 中取出它并且活动运行良好，它又回到了活动中。

**主要问题是什么？**它在项目上不起​​作用，我不知道为什么。

**你想看看发生了什么吗？**这是一个视频。首先是当它关闭时，其次是当我从另一个项目中完成它并且工作正常时。

[http://www.youtube.com/watch?v=SntnyKiJQ1Q&feature=youtu.be](http://www.youtube.com/watch?v=SntnyKiJQ1Q&feature=youtu.be)

* * *

**编辑**

我的问题是，一旦我从图库中选择了图片，堆栈上就没有任何活动。

**为什么？**

问题出在清单的**android:noHistory="true"**标签上，因为没有历史记录，画廊找不到任何活动并关闭了应用程序。

* * *

编码：

我用来打开图库并选择照片的意图：

```
public void openGallery(int req_code){

   Intent intent = new Intent();
   intent.setType("image/*");
   intent.setAction(Intent.ACTION_GET_CONTENT);
   startActivityForResult(Intent.createChooser(intent,"Select file to upload "), req_code);
} 
```

我获取数据的 onActivityResult 从未被调用，因为它关闭了：

```
public void onActivityResult(int requestCode, int resultCode, Intent data) {

    if (resultCode == RESULT_OK) {
        Uri selectedImageUri = data.getData();
        if (requestCode == SELECT_FILE1)
        {
            selectedPath1 = getPath(selectedImageUri);
            System.out.println("selectedPath1 : " + selectedPath1);
        }
        if (requestCode == SELECT_FILE2)
        {
            selectedPath2 = getPath(selectedImageUri);
            System.out.println("selectedPath2 : " + selectedPath2);
        }
        tv.setText("Selected File paths : " + selectedPath1 + "," + selectedPath2);
    }
} 
```

日志猫：

```
01-05 15:18:14.569: I/ActivityManager(59): Starting activity: Intent {   act=android.intent.action.UPLOADIMAGEDEMO cmp=com.example/.UploadImageDemo }
01-05 15:18:15.779: D/dalvikvm(2496): GC_EXTERNAL_ALLOC freed 2697 objects / 189152 bytes in 92ms
01-05 15:18:16.599: I/ActivityManager(59): Displayed activity com.example/.UploadImageDemo: 1953  ms (total 1953 ms)
01-05 15:18:21.899: D/dalvikvm(279): GC_EXPLICIT freed 871 objects / 134112 bytes in 217ms
01-05 15:18:26.620: I/ActivityManager(59): Starting activity: Intent {  act=android.intent.action.CHOOSER cmp=android/com.android.internal.app.ChooserActivity (has extras) }
01-05 15:18:28.250: I/ActivityManager(59): Starting activity: Intent {  act=android.intent.action.GET_CONTENT typ=image/* flg=0x3000000  cmp=com.android.gallery/com.android.camera.ImageGallery }
01-05 15:18:28.670: D/dalvikvm(279): GC_EXTERNAL_ALLOC freed 388 objects / 53352 bytes in 60ms
01-05 15:18:28.850: D/dalvikvm(279): GC_EXTERNAL_ALLOC freed 326 objects / 90664 bytes in 53ms
01-05 15:18:29.200: I/ActivityManager(59): Displayed activity    com.android.gallery/com.android.camera.ImageGallery: 873 ms (total 2345 ms)
01-05 15:18:29.420: D/dalvikvm(279): GC_EXTERNAL_ALLOC freed 725 objects / 106960 bytes in 140ms
01-05 15:18:30.430: W/InputManagerService(59): Starting input on non-focused client         com.android.internal.view.IInputMethodClient$Stub$Proxy@45020da8 (uid=10002 pid=279)
01-05 15:18:32.010: D/dalvikvm(112): GC_FOR_MALLOC freed 9994 objects / 476368 bytes in 149ms 
```

希望社区能帮帮我！！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-09T23:59:53.380

好的，伙计们，首先非常感谢您的回答，他们帮助我今天继续前进..

问题出在清单的**android:noHistory="true"**标签上，因为没有历史记录，画廊找不到任何活动并关闭了应用程序。

再次感谢大家。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-03-02T12:09:31.960

// 对不起，没有足够的声誉来评论接受的答案，但我想我的案例会对其他有同样问题的人有所帮助

我在另一位开发人员编写的代码中遇到了保存问题，并为此苦苦挣扎了几天。但是 manifest 中没有 android:noHistory 属性，但是使用标志 FLAG_ACTIVITY_NO_HISTORY 启动了活动。

像这样：

```
intent.setFlags(Intent.FLAG_ACTIVITY_NO_HISTORY); 
```

我用谷歌搜索了几个小时，两次遇到这个 SO 问题，但只有在决定在我的整个项目中搜索“历史”这个词时才找到答案。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-09T19:58:39.857

通常，如果我们尝试将图片加载为大尺寸的位图/可绘制图片（取决于操作系统分配的堆内存），Android 应用程序会崩溃；例如：1mb 大小的图像或更多。

尝试加载小尺寸图像，并检查问题是否仍然存在。通常崩溃发生在与 BitmapFactory.* 相关的代码中。

```
Bitmap bitmapOrg = BitmapFactory.decodeResource(getResources(),
       R.drawable.android); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-09T20:26:24.083

很难说到底是什么错误原因跟踪不包含任何异常消息。但我可以分享一段代码：

**启动意图**

```
private final int GALLERY_REQUEST = 0;

private void runGallery() {
  Intent intent = new Intent(Intent.ACTION_PICK, android.provider.MediaStore.Images.Media.EXTERNAL_CONTENT_URI);
  startActivityForResult(intent, GALLERY_REQUEST);
} 
```

**处理结果**

```
@Override
protected void onActivityResult(int requestCode, int resultCode, Intent data) {
    if (resultCode == RESULT_OK) {
        Uri selectedPictureUri = data.getData();
        loadGalleryAttachment(selectedPictureUri);
    }
}

private void loadGalleryAttachment(Uri uri){
    if (uri != null) {
        String path = getPath(uri);
        File f = new File(path);
        // do something with picture file   
    }
}

public String getPath(Uri uri) {
    String[] projection = { MediaStore.Images.Media.DATA };
    Cursor cursor = managedQuery(uri, projection, null, null, null);
    if (cursor != null) {
      int column_index = cursor.getColumnIndexOrThrow(MediaStore.Images.Media.DATA);
      cursor.moveToFirst();
      return cursor.getString(column_index);
    } 
} 
```

希望对您有所帮助！

# google-app-engine - 如何在 ndb 重复的结构化属性中查找实例

> ID：14243798
> 
> 赞同：3
> 
> 时间：2013-01-09T18:18:03.030
> 
> 标签：google-app-engine, data-structures, python-2.7, app-engine-ndb

当我有一个 NDB 重复属性时，我必须遍历列表以找到我正在寻找的属性。当我查看数据存储时，结构化属性的每个属性都是一个列表。我以为我可以使用 Python 列表索引方法，但这不起作用。

那么有没有一种简单的方法可以找到我需要的结构化属性实例。

```
class Instance(ndb.Model)
    instance_id = ndb.StringProperty()
    instance_data = ndb.TextProperty()

class Example(ndb.Model):
    instances = ndb.StructuredProperty(Instance, repeated = True) 
```

我试过了：

```
instance_id = 'thisone'
index = entity.instances.instance_id.index(instance_id)
data =  entity.instances.instance_data[index] 
```

但我不得不：

```
instance_id = 'thisone'
for each in entity.instances :
    if each.instance_id = instance_id :
        instance_data = each.instance_data
        break 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-10T02:43:43.723

所以这是问题所在 - entity.instances 是一个 python 列表，根据[文档here](https://developers.google.com/appengine/docs/python/ndb/properties#structured)。你想要做的更像是一个字典。Guido 在 Google Group 中拒绝了一项功能请求，这似乎与您所要求的相同：[https ://groups.google.com/d/topic/appengine-ndb-discuss/Kj7Ymhr5hlE/discussion](https://groups.google.com/d/topic/appengine-ndb-discuss/Kj7Ymhr5hlE/discussion)

entity.instances[0] 返回该列表中的第一个实例。所有其他 List 操作似乎也可以正常工作。但是您正在尝试有效地查询该列表。

如果您已经知道 ID 是什么并且您的列表很大，那么您始终可以将该 ID 设置为键并调用数据存储以获取该实例。当您创建实例时，请执行以下操作：

```
new_instance = Instance(id=instance_id, instance_data=some_data) 
```

然后像这样加载它：

```
existing_instance = Instance.get_by_id(instance_id) 
```

# php - 基于模式自动链接文件的PHP IDE？

> ID：14243802
> 
> 赞同：1
> 
> 时间：2013-01-09T18:18:14.410
> 
> 标签：php, windows, macos, ide

我有一个以可预测的方式相互关联的 php 文件结构。我正在使用 asp.net 中使用的 MVC 模式的修改版本。由于我经常在文件之间切换，我发现我打开了太多的选项卡，它们没有用。

大多数文件是相互调用和实例化的类，因此例如，dreamweaver 中的 html 包含的 css 文件之类的代码链接不起作用。

我仍然想要标签，所以我可以在这些相关文件的组之间切换。

`Source Code`，`user_registration.php`并且`users_wider.css`是这里的链接。
我谈到的链接就在本文的下方。 ![](../Images/d32d066be36a288a822510ec68aa4c04.png)

有没有办法在任何免费或低成本的 IDE 中自动更新所有相关文件的链接？我正在使用 Windows 和 Mac。两个 OS:es 的一个 IDE 会很好，但一个总比没有好。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-18T08:46:40.657

我在 Dreamweaver CS5 中找到了一种方法（偶然）。这可能是一个错误。
如果您注释掉 php 要求或包含，dreamweaver 仍会链接这些文件。

![](../Images/64021634148558f800f0ca97a0f102e1.png)

因此，通过在文档的任何位置（我更喜欢顶部）添加几行注释，您可以“链接”任何文件，就像 Dreamweaver 链接在 html 中添加的 css 和 js 一样。

适用于 mac 10.6 和 windows 7。尚未测试任何其他版本。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-09T20:11:52.267

JetBrains 的 PhpStorm 可能是一个不错的选择。[http://www.jetbrains.com/phpstorm/](http://www.jetbrains.com/phpstorm/)

我以前没有使用过这个特定的 IDE，但是我使用过 ReSharper 和 IntelliJ，他们的另外两个产品。他们制造优质的东西。它不是免费的，但有一个试用版，因此您可以在购买前查看它是否适合您的需求。

# testing - 与rejectChanges 相关的错误

> ID：14243805
> 
> 赞同：0
> 
> 时间：2013-01-09T18:18:23.060
> 
> 标签：testing, breeze

我想我发现了一个错误，为此我准备了一个小测试（基于 DocCode 项目）：

```
test("all customers (concise)", 1, function () {
    var realEm = newEm();
    var metadataStore = realEm.metadataStore; // model metadata known to this EntityManager
    var orderType = metadataStore.getEntityType("Order"); // metadata about the Customer type 
    var newOrder = orderType.createEntity(); // call the factory function for the Customer type

    realEm.addEntity(newOrder);

    newOrder.CustomerID("729de505-ea6d-4cdf-89f6-0360ad37bde7");

    var items = realEm.rejectChanges();

    var query = EntityQuery.from("Customers")
        .where("CustomerID", "==", "729de505-ea6d-4cdf-89f6-0360ad37bde7")
        .expand("Orders");
    stop();
    realEm.executeQuery(query)
        .then(function (data) {
            console.log(data);
            /*SELECT        OrderID, CustomerID, EmployeeID, OrderDate, RequiredDate, ShippedDate, Freight, ShipName, ShipAddress, ShipCity, ShipRegion, ShipPostalCode, ShipCountry, 
            RowVersion
            FROM[Order]
            WHERE(CustomerID = '729de505-ea6d-4cdf-89f6-0360ad37bde7')*/
            ok(data.results[0].Orders().length == 10, "The customers must have 10 Orders")
        })
        .fin(start);
}); 
```

如您所见（执行注释查询）客户必须有 10 个订单，但返回的数组有 11 个。

我是对的还是我做错了什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-09T19:06:57.150

好的，这是一个错误，已在 v 0.84.2 中修复。请试一试并告诉我们。

# ruby - Nokogiri XML 创建字段名称需要帮助 - Ruby 1.9

> ID：14243806
> 
> 赞同：0
> 
> 时间：2013-01-09T18:18:25.363
> 
> 标签：ruby, nokogiri

我正在尝试使用合作伙伴提供给我的规范创建 XML 文档，但在创建指定的 XML 字段名称时遇到了一些问题。我们通常创建字段名称，因此输出如下例所示。

```
def build_xml(output_rows)
builder = Nokogiri::XML::Builder.new(:encoding => 'utf-8') do |xml|     
xml.BATCH{
  xml.HEADER{
      xml.CBPosterEmail ("test@foo.com")
      xml.CBPosterPassword ('123456')
      xml.CBReplace ('Yes')
      xml.CBReplyTo ('replytome@foo.com')
  } #xml HEADER

<Header>
<CBEmail>test@foo.com</CBEmail>
<CBPosterPassword>123456</CBPosterPassword>
<CBReplace>Yes</CBReplace>
<CBReplyTo>replytome@foo.com</CBReplyTo>
</Header> 
```

我需要让字段名称出现在输出中，如下例所示：

```
<Header>
<Field name="CBPosterEmail" value="test@foo.com" />
<Field name="CBPosterPassword" value="123456" />
<Field name=”CbReplace” value=”Yes”&gt;
<Field name=”CBReplyTo” value=”replytome@foo.com”&gt;
</Header> 
```

当我尝试添加 Field name=" 和 value= 片段时出现错误。我是 Nokogiri 的新手，所以如果我听起来像个白痴，请放轻松。非常感谢任何帮助。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-09T18:45:40.087

```
require 'nokogiri'
builder = Nokogiri::XML::Builder.new(:encoding => 'utf-8') do |xml|
xml.batch {
  xml.header {
    xml.field(:name => "CBPosterEmail", :value => "test@foo.com")
    xml.field(:name => "CBPosterPassword", :value => "123456")
    xml.field(:name => "CBReplace", :value => "Yes")
    xml.field(:name => "CBReplyTo", :value => "replytome@foo.com")
  }
}
end
puts builder.to_xml

=> <?xml version="1.0" encoding="utf-8"?>
<batch>
  <header>
    <field name="CBPosterEmail" value="test@foo.com"/>
    <field name="CBPosterPassword" value="123456"/>
    <field name="CBReplace" value="Yes"/>
    <field name="CBReplyTo" value="replytome@foo.com"/>
  </header>
</batch> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-09T18:49:05.010

请参阅 Nokogiri 的 Builder 文档的“[标记属性](http://nokogiri.org/Nokogiri/XML/Builder.html)”部分。

```
builder = Nokogiri::XML::Builder.new(:encoding => 'utf-8') do |xml|     
  xml.BATCH{
    xml.HEADER{
      xml.Field( name: 'CBPosterEmail',    value: 'test@foo.com'      )
      xml.Field( name: 'CBPosterPassword', value: '123456'            )
      xml.Field( name: 'CBReplace',        value: 'Yes'               )
      xml.Field( name: 'CBReplyTo',        value: 'replytome@foo.com' )
    }
  }
end

puts builder.to_xml 
```

结果是：

```
<?xml version="1.0" encoding="utf-8"?>
<BATCH>
  <HEADER>
    <Field name="CBPosterEmail" value="test@foo.com"/>
    <Field name="CBPosterPassword" value="123456"/>
    <Field name="CBReplace" value="Yes"/>
    <Field name="CBReplyTo" value="replytome@foo.com"/>
  </HEADER>
</BATCH> 
```

示例代码显示您正在尝试添加`<BATCH>`标签，但所需的输出示例未显示它。如果输出样本是正确的，这将产生：

```
builder = Nokogiri::XML::Builder.new(:encoding => 'utf-8') do |xml|     
  xml.HEADER{
    xml.Field( name: 'CBPosterEmail',    value: 'test@foo.com'      )
    xml.Field( name: 'CBPosterPassword', value: '123456'            )
    xml.Field( name: 'CBReplace',        value: 'Yes'               )
    xml.Field( name: 'CBReplyTo',        value: 'replytome@foo.com' )
  }
end 
```

结果是：

```
<?xml version="1.0" encoding="utf-8"?>
<HEADER>
  <Field name="CBPosterEmail" value="test@foo.com"/>
  <Field name="CBPosterPassword" value="123456"/>
  <Field name="CBReplace" value="Yes"/>
  <Field name="CBReplyTo" value="replytome@foo.com"/>
</HEADER> 
```

# mysql - 如何从 3 个表中检索 mysql 数据库中的值？

> ID：14243808
> 
> 赞同：0
> 
> 时间：2013-01-09T18:18:28.833
> 
> 标签：mysql, database, select

用户表：

```
userID | name
1      | John
2      | Mary
3      | Jack 
```

项目表（用户将选择并存储到 mysql

```
itemID | name   | item 
1      | Mary   | pants, jeans
1      | John   | jacket, shirt
1      | Jack   | jacket, shirt 
```

描述表（根据用户选择的项目检索描述）

```
descID | item          | descOne | descTwo
1      | jacket, shirt | Nice!   | Great   
1      | pants, jeans  | good    | Nice    
1      | dress, jeans  | Nice!   | Great 
```

如果我想检索 Mary 的值，我的 select sql 语句应该是什么？

目前我有这个->

```
SELECT 
    d.item, 
    d.descOne, 
    d.descTwo, 
    i.name , d.item
FROM description d 
INNER JOIN items i 
WHERE d.item = i.item ON; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-09T18:21:31.510

```
SELECT 
    u.name,
    d.descOne, 
    d.descTwo, 
    d.item
FROM users as u
LEFT JOIN items as i ON i.name = u.name
LEFT JOIN description as d ON d.item = i.item
WHERE u.name = 'Mary' 
```

# asp.net-mvc-3 - MVC PRG 模式与 SessionState 冲突

> ID：14243809
> 
> 赞同：1
> 
> 时间：2013-01-09T18:18:32.680
> 
> 标签：asp.net-mvc-3, session, viewdata, tempdata, stateserver

我有一个 MVC3 网络应用程序。我一直在使用**PRG**（Post-Redirect-Get）模式。那是在回发期间，如果任何模型验证失败，我[将 ViewData 保存在 TempData 中](https://stackoverflow.com/questions/279665/how-can-i-maintain-modelstate-with-redirecttoaction)，然后重定向到原始 GET 操作。

在后期行动中 -

```
if (!ModelState.IsValid)
    TempData["ViewData"] = ViewData; 
```

稍后在 GET 操作中 -

```
if (TempData["ViewData"] != null)
    ViewData = (ViewDataDictionary)TempData["ViewData"]; 
```

这几乎是通常的做法。到目前为止，一切都运行良好。**现在**，我们需要改进会话持久性，即我们需要“更长”的会话。我已经决定使用[ASP.Net State Server](https://stackoverflow.com/questions/13779041/asp-net-mvc-keep-session-alive-for-as-long-as-possible)。

在我将会话迁移到状态服务器后 -

```
web.config - 
<system.web> ... 
<sessionState timeout="180" mode="StateServer" cookieless="UseCookies" />  
... 
```

我的一些存储自定义对象的会话开始出现“无法序列化”错误。我已经制作了这样的对象**[Serializable]**来解决这个问题。但现在我坚持使用上述 PRG 模式！

> **错误**- 程序集“System.Web.Mvc，版本=3.0.0.0，文化=中性，PublicKeyToken=31bf3856ad364e35”中的类型“System.Web.Mvc.ViewDataDictionary”未标记为可序列化。

奇怪的是，我找不到一个可以分享我的场景的线程。任何人？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-11T17:13:40.403

[TempData 存储在会话中](http://www.gregshackles.com/2010/07/asp-net-mvc-do-you-know-where-your-tempdata-is/)而我的会话又存储在外部进程中的事实要求存储的任何内容都必须是“可序列化的”。

ViewDataDictionary 甚至 ModelStateDictionary 之类的对象不是 [Serializable]。对于 MVC PRG，我只需要传递模型状态错误和无效对象。

> 我已经将该对象标记为 [Serializable] （我正在使用 xml 序列化程序来“字符串化”我的 obj 然后存储它 - 因为它是一个 L2S 实体，所以也需要避免循环引用）。参考[SO 帖子](https://stackoverflow.com/questions/2434534/serialize-an-object-to-string)

```
TempDate["modelToPass"] = Serialization.Serialize<MyModel>(modelToPass); 
```

同样，我可以将我的 ModelState 对象（仅针对错误）转换为“更简单”的对象并将其转换为类似

```
KeyValuePair<string,List<string>>[] 
```

简而言之，我正在尝试使我的模型状态和模型对象“可序列化”，以便我可以将它们放入 TempData 并保持 PRG 模式。

还有一些其他方法可以部署我们自己的 TempData 并将 TempData 存储在 cookie 中，等等。但我不想让事情复杂化。如果有人对此有更好的解决方案，请告诉我。

一些参考网址

*   [无法序列化 ModelState](http://forums.asp.net/t/1651072.aspx/1)
*   [基于 Cookie 的 TempDate](http://afana.me/post/session-less-controllers-and-TempData-ASPNET-MVC.aspx)
*   [json 的高级用法](https://stackoverflow.com/questions/2845852/asp-net-mvc-how-to-convert-modelstate-errors-to-json)
*   AJAX + PRG[一](http://ben.onfabrik.com/posts/automatic-modelstate-validation-in-aspnet-mvc)、[二](https://stackoverflow.com/questions/2845852/asp-net-mvc-how-to-convert-modelstate-errors-to-json)

# php - 我应该在设置后立即检查 cookie 是否存在吗？

> ID：14243815
> 
> 赞同：1
> 
> 时间：2013-01-09T18:18:47.853
> 
> 标签：php, cookies

使用良好的开发实践，是否应该在设置后检查是否存在`setcookie`，或者是否知道设置为 100%？谢谢你。

```
<?php
    require "includes/settings.php";
    require "functions/php_function_library.php";

    $item_id = $_REQUEST['item_id'];
    $item_qty = $_REQUEST['quantity'];

    echo $item_id;
    echo $item_qty;

    $cookie_guid = guid();

    setcookie("anonymous_cart", $cookie_guid);

    #check that the cookie I just set exists?

    #insert new cart record into DB
    ...
?> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-09T18:23:14.047

只需检查返回值，如果为 false 则失败。否则，您可以认为它已设置（我从未见过在这种情况下未设置）。

```
if(setcookie('anonymous_cart', $cookie_guid)){
    // Joy, cookie was set
} 
```

但是，如果设置的 cookie 至关重要，那么检查它不会有任何伤害（很多）。

**编辑**

对于那些指出这并不能保证 cookie 被*接受*的人，我同意并且没有说它确实（怎么可能？客户甚至还没有收到 cookie）。它只是意味着**设置**了 cookie 。这是op问的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-09T18:23:52.080

您无需在设置后立即检查以确保它存在，但最佳做法是在使用它之前检查以确保它存在。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-09T18:32:03.953

鉴于 Cookie 依赖于本地化的浏览器设置，它们本质上是不可靠的。

确保您进行了有效的处理，以防在您的脚本查找该值时无法从客户端检索该值。在某些情况下，这甚至可能需要在前端指示用户启用 cookie 或将您的域添加到他们的例外安全站点列表中，特别是因为您似乎正在实施的是购物系统。

Check `setcookies`'s return value intially to make sure your server could send the value, but don't directly rely on this as implying the cookie was accepted. Always check for presence of the value using `isset` or `array_key_exists` on the cookie global at the point you need to use the value.

# visual-studio - 在 Visual Studio 中通过“一些”关键字查找方法/类

> ID：14243819
> 
> 赞同：0
> 
> 时间：2013-01-09T18:19:01.760
> 
> 标签：visual-studio, visual-studio-2012, resharper

有没有什么方法可以通过一些关键字来搜索方法/类型？

例如，想象一下方法`GetLocalPathForOriginalFile`。比如说，进行搜索`get local original`将返回该方法（或相关性的方法列表）。

Visual Studio 2012 从“搜索解决方案资源管理器”执行此操作，但仅限于类。它不搜索方法名称。

我也在使用 Resharper v7 和 Visual Studio 2012，所以如果这样做也很好。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-09T20:31:32.713

按 Alt-Shift-T（如果您在 ReSharper 中使用 VS 键盘方案）并输入`Get*Local*Original`.

# c - gcc不再允许空数组吗？

> ID：14243823
> 
> 赞同：1
> 
> 时间：2013-01-09T18:19:17.913
> 
> 标签：c, arrays, gcc, initialization

我有 gcc 4.7.2-3，我收到以下错误：

main.c:5:6：错误：“fname”中缺少数组大小</p>

main.c:6:6：错误：“lname”中缺少数组大小</p>

初始化时：

```
int fname[];
int lname[]; 
```

使用更高版本的 gcc 是否不再可能？因为我确定我以前用过这个……

编辑：我说我记得这一点的原因是因为我什至在这里看到它：http: [//h30097.www3.hp.com/docs/base_doc/DOCUMENTATION/V40F_HTML/AQTLTBTE/DOCU_046.HTM](http://h30097.www3.hp.com/docs/base_doc/DOCUMENTATION/V40F_HTML/AQTLTBTE/DOCU_046.HTM)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-09T18:26:54.783

如果您立即初始化它，您只能声明一个没有大小的数组

```
int myarr[] = {1, 2, 3}; 
```

或者如果它是结构中的最后一个成员

```
struct foo {
  int something;
  int somethingelse;
  char emptyarr[];
}; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-09T18:32:42.327

零长度数组可以是[GNU C 扩展，也可以是 C99 中引入的灵活数组成员](http://gcc.gnu.org/onlinedocs/gcc/Zero-Length.html)（C++ 编译器也恰好支持，我不确定它是否符合 C++ 标准）。在任何一种情况下，它们都只允许作为结构的最后一个成员，否则是不允许的，也没有任何意义。

您引用的文档确实使用或显示“空”数组。您对“空”数组的[数组衰减感到困惑。](https://stackoverflow.com/questions/1461432/what-is-array-decaying)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-09T18:22:19.423

我认为在任何编译器中都不可能，数组大小必须在编译时知道。您可能正在立即进行初始化：

```
int fname[] = { 1, 2, 3}; 
```

这样编译器可以得出大小。

编辑：啊，错过了“C”标签。:) 不过，这在 C++ 中似乎是非法的。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-10-23T12:20:28.440

是的，您可以声明一个大小为 0 的数组。为此，您需要声明如下

```
int array[] = {}; 
```

例如

```
int main()
{
    int a[]={};
    printf("size = %d", sizeof(a));
    return 1;
} 
```

`./a.out`给你 0 作为输出。

# iphone - UILocalNotification 应用程序徽章编号重复

> ID：14243828
> 
> 赞同：2
> 
> 时间：2013-01-09T18:19:43.103
> 
> 标签：iphone, ios, objective-c, cocoa-touch

我`UILocalNotification`在我的应用程序中使用 s 。有时我安排重复通知，有时安排非重复通知。每当触发通知时，我都想增加应用程序徽章编号。所以我这样做`localNotification.applicationIconBadgeNumber = badgeNumber;`很好......除非通知是重复通知，因为如果我之前设置了带有标记号 1 的重复通知，那么我设置了另一个带有标记号 2 的非重复通知。

流程是这样的：

```
Notification 1 fires (first time) - Badge number = 1 (OK!) 
Notification 2 fires              - Badge number = 2 (OK!) 
Notification 1 fires (repeating)  - Badge number = 1 (ERROR) 
```

如您所知，当通知 1 再次触发时，我仍然希望应用程序徽章编号显示 2（对于 2 个错过的通知）。我可以实现这种行为吗？还是有什么明显的我错过了？对我来说，重复通知更合乎逻辑的徽章行为将是它第一次设置徽章编号，随后它不会更改徽章编号。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-09T19:28:41.873

简单：对不起，戴夫。恐怕我做不到。

没有办法让徽章计数保持在使用`UILocalNotification`.

徽章计数将始终设置为您在安排通知时设置的值（如您所知）。您不能假设用户在收到通知时会打开您的应用程序，因此在每次应用程序启动时更新已安排通知（重复和非重复）的徽章计数肯定不会起作用，也不是一个选择。

您可以做到这一点的唯一方法是使用推送通知，跟踪服务器上的所有“未读”通知，并在用户启动您的应用程序后立即在您的服务器上将通知标记为“已读”。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-09T20:40:37.183

我想处理重复通知并让它在第一次触发时增加应用程序徽章编号的唯一方法是安排没有徽章编号的重复通知，例如：

```
UILocalNotification *localNotification = [[UILocalNotification alloc] init];
localNotification.fireDate = [NSDate dateWithTimeIntervalSinceNow:60];
localNotification.alertBody = @"1";
localNotification.alertAction = @"Send";
localNotification.soundName = UILocalNotificationDefaultSoundName;
localNotification.timeZone = [NSTimeZone defaultTimeZone];
localNotification.repeatInterval = NSMinuteCalendarUnit;
[[UIApplication sharedApplication] scheduleLocalNotification:localNotification]; 
```

然后在第一次触发重复通知的同时安排一个仅设置应用程序徽章编号的通知：

```
UILocalNotification *localNotification = [[UILocalNotification alloc] init];
localNotification.fireDate = [NSDate dateWithTimeIntervalSinceNow:60];
localNotification.soundName = UILocalNotificationDefaultSoundName;
localNotification.timeZone = [NSTimeZone defaultTimeZone];
localNotification.applicationIconBadgeNumber = 1;
localNotification.hasAction = NO;
localNotification.alertBody = nil;
[[UIApplication sharedApplication] scheduleLocalNotification:localNotification]; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-09T18:36:49.637

您可以简单地使用 if 条件来执行此操作，例如：

```
- (void) application:(UIApplication *)application didReceiveLocalNotification:(UILocalNotification *)localNotification
{
   if([UIApplication sharedApplication].applicationIconBadgeNumber < localNotification.applicationIconBadgeNumber)
   {
      [UIApplication sharedApplication].applicationIconBadgeNumber = localNotification.applicationIconBadgeNumber;
   }
} 
```

（没有检查上面的代码）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-02-10T11:33:35.353

在我的应用程序中，我不得不使用重复的本地通知添加徽章编号。并且每次用户打开应用程序徽章编号时都应该重置。因此，所有预定的通知都应重新计算徽章编号。

```
func applicationDidEnterBackground(application: UIApplication) {
    addBadgeNumberToScheduledNotifications()
}

func addBadgeNumberToScheduledNotifications() {
    var badgeNumber: Int = 0
    UIApplication.sharedApplication().applicationIconBadgeNumber = 0
    if let notifications = UIApplication.sharedApplication().scheduledLocalNotifications {
        UIApplication.sharedApplication().cancelAllLocalNotifications()
        for notification in notifications {
            notification.applicationIconBadgeNumber = notification.fireDate > NSDate() ? ++badgeNumber : 0
            UIApplication.sharedApplication().scheduleLocalNotification(notification)
        }
    }
} 
```

# iphone - [self.view addSubview:_topViewController.view]; 自转问题

> ID：14243830
> 
> 赞同：0
> 
> 时间：2013-01-09T18:19:46.383
> 
> 标签：iphone, ios, objective-c, ios6, uideviceorientation

真的被困了好几个星期。我正在使用[ECSlidingViewController](https://github.com/edgecase/ECSlidingViewController)，我想要一个视图，能够旋转到横向和纵向，因为它是一张横向照片，需要利用可用空间，而我不希望应用程序的其余部分旋转, 只停留在风景中。

我确信自动旋转方法没有被调用，因为它使用这种技术切换到视图......

```
- (void)setTopViewController:(UIViewController *)theTopViewController
{
  CGRect topViewFrame = _topViewController ? _topViewController.view.frame : self.view.bounds;

  [self removeTopViewSnapshot];
  [_topViewController.view removeFromSuperview];
  [_topViewController willMoveToParentViewController:_topViewController];
  [_topViewController removeFromParentViewController];

  _topViewController = theTopViewController;

  [self addChildViewController:self.topViewController];
  [self.topViewController didMoveToParentViewController:self];

  [_topViewController.view setAutoresizingMask:self.autoResizeToFillScreen];
  [_topViewController.view setFrame:topViewFrame];
  _topViewController.view.layer.shadowOffset = CGSizeZero;
  _topViewController.view.layer.shadowPath = [UIBezierPath bezierPathWithRect:self.view.layer.bounds].CGPath;

    [self.view addSubview:_topViewController.view];
} 
```

在我的初始视图控制器上......

```
self.topViewController = [storyboard instantiateViewControllerWithIdentifier:@"Home"]; 
```

所以它只是堆叠在顶部，而不是切换到这个视图。所以，它总是在听初始视图控制器的旋转方法......

非常感谢您的帮助，正如我所说，我已经被困了好几天了......

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-09-10T11:59:16.993

经过几个小时的努力，我终于可以完成这项工作了..

首先，您需要创建一个子视图`ECSLidingViewController`并放置以下代码：

```
-(NSUInteger)supportedInterfaceOrientations{
     return [self.topViewController supportedInterfaceOrientations]; 
 }

-(BOOL)shouldAutorotate{
     return self.topViewController.shouldAutorotate;
 }

- (UIInterfaceOrientation)preferredInterfaceOrientationForPresentation{
     return [self.topViewController preferredInterfaceOrientationForPresentation];
 } 
```

您还需要创建一个类别`UINavigationController`并覆盖此代码

```
@implementation UINavigationController (Rotation_IOS6)

-(BOOL)shouldAutorotate{
     return [[self.viewControllers lastObject] shouldAutorotate];
 }

-(NSUInteger)supportedInterfaceOrientations{
     return [[self.viewControllers lastObject] supportedInterfaceOrientations];
 }

 - (UIInterfaceOrientation)preferredInterfaceOrientationForPresentation{
     return [[self.viewControllers lastObject] preferredInterfaceOrientationForPresentation];
 }

@end 
```

希望这对你有用..

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-09T18:50:01.437

这是一个常见的问题：如果你实例化一个视图控制器，通过 将它的视图添加到另一个视图控制器的视图`addSubview`中，那么第一个控制器将不会得到任何与自动旋转相关的调用。

为了应对这种用例，Apple 在 iOS5 中添加了所谓的*`UIViewController`Containment*，您可以在其中将子控制器添加到另一个控制器；然后所有相关方法（`viewWillAppear/Disappear`; 自动旋转方法等将自动路由到子控制器）。

以下是您可能需要调用的基本方法：

```
addChildViewController:
removeFromParentViewController
willMoveToParentViewController:
didMoveToParentViewController: 
```

查看[实现容器视图控制器](http://developer.apple.com/library/ios/#documentation/uikit/reference/UIViewController_Class/Reference/Reference.html)以获取详细信息。

[在这里](http://www.cocoanetics.com/2012/04/containing-viewcontrollers/)，您可以找到一个教程，该教程将为您提供有关如何使用遏制的分步说明。

请记住，这仅适用于 iOS>5，因此如果您需要支持 iOS4，那么您将不走运。在任何情况下，您都可以尝试通过将相关消息中继到子控制器来构建解决方法。例如，在我的一个应用程序中，它是`willAnimateRotationToInterfaceOrientation`这样的`didRotateFromInterfaceOrientation`：

```
- (void)willAnimateRotationToInterfaceOrientation:(UIInterfaceOrientation)interfaceOrientation
                                     duration:(NSTimeInterval)duration {

 [self.mainButtonBarController willAnimateRotationToInterfaceOrientation:interfaceOrientation
                                                               duration:duration];
 [self.boardController willAnimateRotationToInterfaceOrientation:interfaceOrientation
                                                               duration:duration];
}

- (void)didRotateFromInterfaceOrientation:(UIInterfaceOrientation)fromInterfaceOrientation {

 [self.mainButtonBarController didRotateFromInterfaceOrientation:fromInterfaceOrientation];
 [self.boardController didRotateFromInterfaceOrientation:fromInterfaceOrientation];
} 
```

即，它们只是将相同的消息转发给子控制器。您可以对需要的其他方法执行相同的操作（`shouldAutorotate...`等）

# python - Python 战斗序列

> ID：14243831
> 
> 赞同：1
> 
> 时间：2013-01-09T18:19:46.790
> 
> 标签：python, python-3.x, wing-ide

我正在尝试构建一个简单的战斗序列，其中用户选择他们的“职业”（战士、弓箭手、法师）以及他们想要战斗的怪物（地精、巨魔、兽人）。

我到目前为止的代码是：

```
import random 

def choosePlayerClass():

    class Warrior:
        health = 100
        attack = 10
        defense = 10

    class Archer:
        health = 75
        attack = 15
        defense = 7

    class Mage:
        health = 50
        attack = 20
        defense = 5

    playerChoice = input("What class do you want to be? (Warrior, Archer, Mage)? ")
    if playerChoice == "Warrior":
        Player = Warrior()
    elif playerChoice == "Archer":
        Player = Archer()
    elif playerChoice == "Mage":
        Player = Mage()

    return Player

def chooseMonsterClass():

    class Goblin:
        health = 25
        attack = 10
        defense = 5
        description = "Goblin"

    class Troll:
        health = 50
        attack = 13
        defense = 7
        description = "Troll"

    class Orc:
        health = 75
        attack = 15
        defense = 10
        description = "Orc"  

    monsterChoice = input("What kind of monster do you want to fight? (Goblin, Troll, Orc)? ")

    if monsterChoice == "Goblin":
        Monster = Goblin()
    elif monsterChoice == "Troll":
        Monster = Troll()
    elif monsterChoice == "Orc":
        Monster = Orc

    return Monster

def fightSequence():
    Player = choosePlayerClass()
    Monster = chooseMonsterClass()
    encounter = 1
    turn = 'player'
    while encounter == 1:
        if turn == 'player':
            action = input("What would you like to do (Attack)? ")
            if action == 'Attack':
                encounter = humanAttack(Player)
                turn = 'monster'
        elif turn == 'monster':
            encounter = monsterAttack(Monster)
            turn = 'player'

fightSequence() 
```

我得到这个错误：

Traceback（最近一次调用最后）：文件“C:\Program Files (x86)\Wing IDE 101 4.1\src\debug\tserver_sandbox.py”，第 109 行，在文件“C:\Program Files (x86)\Wing IDE 101 4.1\src\debug\tserver_sandbox.py”，第 102 行，fightSequence 文件“C:\Program Files (x86)\Wing IDE 101 4.1\src\debug\tserver_sandbox.py”，第 63 行，humanAttack builtins.NameError ：未定义全局名称“Monster”

谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-09T18:27:12.197

在这里初始化 Monster 变量：

```
if monsterChoice == "Goblin":
    Monster = Goblin()
elif monsterChoice == "Troll":
    Monster = Troll()
elif monsterChoice == "Orc":
    Monster = Orc() 
```

但是如果这些都不是真的并且没有输入任何 if 语句怎么办？您应该在 if 语句之前将变量设置为默认值，以便处理用户输入一些废话的情况：

```
Monster = DefaultRace
if monsterChoice == "Goblin":
    Monster = Goblin()
elif monsterChoice == "Troll":
    Monster = Troll()
elif monsterChoice == "Orc":
    Monster = Orc() 
```

最好将整个事情放在一个循环中，并在给出无意义的比赛时要求用户输入有效的比赛。

```
while True:
    monsterChoice = input("What kind of monster do you want to fight? (Goblin, Troll, Orc)? ")
    if monsterChoice in ["Goblin","Troll","Orc"]:
        break
    else:
        print "Unrecognized race requested, please select one of Goblin, Troll, Orc." 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-11T05:21:14.597

您希望`global Monster`在函数`chooseMonsterClass`或`fightSequence`. 尝试两者（一次）。所以应该是：

```
import random 

def choosePlayerClass():

    class Warrior:
        health = 100
        attack = 10
        defense = 10

    class Archer:
        health = 75
        attack = 15
        defense = 7

    class Mage:
        health = 50
        attack = 20
        defense = 5

    playerChoice = input("What class do you want to be? (Warrior, Archer, Mage)? ")
    if playerChoice == "Warrior":
        Player = Warrior()
    elif playerChoice == "Archer":
        Player = Archer()
    elif playerChoice == "Mage":
        Player = Mage()

    return Player

def chooseMonsterClass():
    global Monster
    class Goblin:
        health = 25
        attack = 10
        defense = 5
        description = "Goblin"

    class Troll:
        health = 50
        attack = 13
        defense = 7
        description = "Troll"

    class Orc:
        health = 75
        attack = 15
        defense = 10
        description = "Orc"  

    monsterChoice = input("What kind of monster do you want to fight? (Goblin, Troll, Orc)? ")

    if monsterChoice == "Goblin":
        Monster = Goblin()
    elif monsterChoice == "Troll":
        Monster = Troll()
    elif monsterChoice == "Orc":
        Monster = Orc

    return Monster

def fightSequence():
    global Monster
    Player = choosePlayerClass()
    Monster = chooseMonsterClass()
    encounter = 1
    turn = 'player'
    while encounter == 1:
        if turn == 'player':
            action = input("What would you like to do (Attack)? ")
            if action == 'Attack':
                encounter = humanAttack(Player)
                turn = 'monster'
        elif turn == 'monster':
            encounter = monsterAttack(Monster)
            turn = 'player'

fightSequence() 
```

# computer-science - 表明 NP 完全语言的判定版本是 NP 完全的

> ID：14243832
> 
> 赞同：1
> 
> 时间：2013-01-09T18:19:48.070
> 
> 标签：computer-science, complexity-theory, np-complete

假设给定一个组合优化问题 A。让我们假设 WLOG 问题是团问题。

我如何证明如果 clique 是 NP 完全的，那么 clique 的决策版本是 NP 完全的，其中决策版本当然是以下问题 B：是否存在大小等于 k ​​的 clique？

我想我有直觉，但不确定它是否足以证明：

第一步：

如果给定一组大小为 k 的顶点 C，我可以在多项式时间内验证是否存在大小为 k 的团（假设 B 的答案是肯定的，即存在大小为 k 的团）。因此，B 在 NP 中。

第二步：将A简化为B。

- 由于 A 要求最大大小的集团，我们可以将问题分解为多个部分，B1：是否存在大小为 1 的集团？，...，BN：是否存在大小为 N 的集团？

- 如果 A 是可解的，假设有一个大小为 k* 的团，那么每个 Bk, k=1,...,N 都可以通过比较 k 和 k* 轻松回答

**- 如果所有**Bks都是可解的，我们可以知道最大 clique 大小是多少。

我真的不确定这是一个减少，尽管它是在多项式时间内。也许是因为一个问题被分解成**许多**问题。此外，我不确定我应该使用上面的“全部”这个词。

谢谢您的帮助！:)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-10T12:38:42.357

组合优化问题不能是 NP 完全的。只有决策问题可以是 NP 完全的（参见例如[http://en.wikipedia.org/wiki/NP-complete](http://en.wikipedia.org/wiki/NP-complete)）。

Clique 优化问题（给定一个图，找到形成一个团的最大顶点集）是 NP-hard，因为它的决策版本（给定一个图和 ak，是否有一个大小 >= k 的团？）是 NP-完全的。

# r - 使用点阵个性化在 R 上显示的 X 轴值

> ID：14243834
> 
> 赞同：3
> 
> 时间：2013-01-09T18:19:50.993
> 
> 标签：r, lattice

我收集了大量关于日期、客户端及其 NFS 使用情况的数据。[根据 superuser 的建议，](https://superuser.com/questions/523195/plot-custom-log-data-on-gnu-linux/523217)我正在使用 lattice R 包进行绘图。此外，Stackoverflow 帮助我[将日期字符串转换为实际的日期对象](https://stackoverflow.com/questions/14234197/x-scale-values-very-compacted-on-r-plots-with-lattice)。

现在，我的代码是这样的：

```
require(lattice)

logfile <- read.table(file="nfsclients-2d.log")
names(logfile) <- c("Date","Client","Operations")

allcol <- c("blue","chocolate4","cornflowerblue","chartreuse4","brown3","darkorange3","darkorchid3","red","deeppink4","lightsalmon3","yellow","mistyrose4","seagreen3","green","violet","palegreen4","grey","slateblue3","tomato2","darkgoldenrod2","chartreuse","orange","black","yellowgreen","slategray3","navy","firebrick1","darkslategray3","bisque3","goldenrod4","antiquewhite2","coral","blue4","cyan4","darkred","orangered","purple4","royalblue4","salmon")
col=allcol[0:length(levels(logfile$Client))]

svg(filename="/tmp/nfsclients-2d.svg",width=14,height=7)

times <- as.POSIXct(strptime(levels(logfile$Date), format="%m/%d-%H:%M"))
logfile$Date <- times[logfile$Date]
xyplot(Operations~Date,group=Client,data=logfile,jitter.x=T,jitter.y=T,
 aspect = 0.5, type = "l",
 par.settings=list(superpose.line=list(col=col,lwd=3)),
 xlab="Time", ylab="Operations", main="NFS Operations (last 2 days, only clients with >40 operations/sec)",
 key=list( text=list(levels(logfile$Client)), space='right',
           lines=list(col=col),columns=1,lwd=3,cex=0.75))

dev.off() 
```

输出文件是这样的（去掉了图例）：

![在此处输入图像描述](../Images/aec67dc3e1baa2ca84e731d7224b9326.png)

X 轴值在这里不是很有用：“tue”“tue”“wed”“wed”。它似乎只将第一个有意义的值作为标签。更多的标签（可能是 6 个或 7 个）也会更有用。

绘制 2 周时情况更糟。X 轴上仅显示 2 个值：“2012”“2013”​​。甚至没有重复，只有 2 个值！

[我正在绘制](http://pastebin.com/eWrBSsKd)的数据。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-09T19:45:24.350

这不是您的 lattice 问题的直接答案，但实际上我会`scales`在此处使用带有`ggplot2`. 您可以根据需要格式化轴。

```
p <- ggplot(dat = logfile, aes(x= Date,
                          y =Operations, 
                          group = Client,
                          color = Client ))+geom_line() 
```

你只给我们 2 天的数据，所以我在 10 小时内打破我的数据来展示这个想法

```
library(scales) # to access breaks/formatting functions
p %+% scale_x_datetime(breaks = date_breaks("10 hour"), 
                    minor_breaks = date_breaks("2 hour")) 
```

![在此处输入图像描述](../Images/71d37262315751b9e3012daa4a83e3aa.png)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-09T19:27:56.667

您将需要为此轴构造一个适当的间隔。如果这真的是前两天，那么可能是这样的：

```
 interval <- as.POSIXct( Sys.Date() - c(1,3) ) 
```

然后你需要为 x 轴构造一个 scales 参数：

```
 xyplot(Operations~Date,group=Client,data=logfile,jitter.x=T,jitter.y=T,
         aspect = 0.5, type = "l",
         scales=list(x=list(at= .......  , 
                     labels=format( ......, "%H:%M") ),
          #rest of code
         ) 
```

您为 ..... 值输入的内容将类似于以下内容：

```
 seq( interval[2], interval[1], by="4 hour") 
```

这是`format.POSIXt`调用返回的内容：

```
> format( seq( interval[2], interval[1], by="4 hour") , "%H:%M")
[1] "16:00" "20:00" "00:00" "04:00" "08:00" "12:00" "16:00" "20:00" "00:00" "04:00" "08:00" "12:00"
[13] "16:00" 
```

# java - java如何从filetimestamps中找到前几天的文件

> ID：14243839
> 
> 赞同：0
> 
> 时间：2013-01-09T18:19:59.717
> 
> 标签：java

我有两个java程序

1) 第一个程序每天运行并生成文件 abc_currenttimestamp.csv (eg abc_1357615107)

2）第二个程序每天运行并读取第一个程序生成的文件。但它必须读取的文件是前几天的文件，而不是今天生成的文件。

例如，第一个程序在 1 月 9 日和 1 月 10 日等生成文件。第二个程序从 10 日开始运行，并且应该读取时间戳为 1 月 9 日的文件。

一种方法可能是第二个程序检查所有文件的时间戳并查找它是否是前几天的时间戳。我不知道如何在 Java 中做到这一点。

另一种方式可能是第一个程序将文件名写入一个字段，第二个程序通过读取该字段来知道文件名。但问题是每次第一个程序每天运行时，它都会用今天的文件名覆盖这个字段。

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-09T18:27:39.373

你可以简单地玩

```
file.lastModified(); 
```

或者您只需在文件名本身中添加日期和时间，`ddmmyyyy.csv`您就可以轻松检查它是否存在。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-09T18:28:11.327

我喜欢从文件名中获取时间戳的想法。这样，手动修改文件的人就不会弄乱您的流程。

这有点取决于您拥有什么样的时间戳值。如果它的 java 使用下面的代码并且它的 unix 乘以 1000 然后执行此操作。

```
Calendar today = Calendar.getInstance(); // use this to get todays date (and time)

Calendar mydate = Calendar.getInstance(); // this uses the timestamp for comparing
mydate.setTimeInMillis(timestamp);

// This prints out the date and shows how to get values to compare. You can also 
//  subtract one day from today's date to handle rollover of months and years.
out.println( mydate.get(Calendar.DAY_OF_MONTH)+"."+mydate.get(Calendar.MONTH)+"."+mydate.get(Calendar.YEAR)); 
```

这里有一些讨论：

[Java：来自unix时间戳的日期](https://stackoverflow.com/questions/3371326/java-date-from-unix-timestamp)

# c++ - 按值填充 std::vector 时，会删除动态分配的对象指针吗？

> ID：14243840
> 
> 赞同：2
> 
> 时间：2013-01-09T18:20:01.667
> 
> 标签：c++, pointers, memory-leaks, vector, dynamic-allocation

> **可能重复：**
> [为什么使用“新”会导致内存泄漏？](https://stackoverflow.com/questions/8839943/why-does-the-use-of-new-cause-memory-leaks)

我对 STL 还很陌生，而且我读过通常保留对象向量而不是指向对象的指针向量是一种很好的做法。为了遵守该信条，我遇到了以下情况：

```
//Approach A
//dynamically allocates mem for DD_DungeonRoom object, returns a pointer to the block.
//then, presumably, copy-constructs the de-referenced DD_DungeonRoom as a 
//disparate DD_DungeonRoom object to be stored at the tail of the vector
//Probably causes memory leak due to the dynamically allocated mem block not being
//caught and explicitly deleted
mvLayoutArray.push_back(*(new DD_DungeonRoom()));

//Approach B
//same as A, but implemented in such a way that the dynamically allocated mem block
//tempRoom can be deleted after it is de-referenced and a disparate DD_DungeonRoom is
//copy-constructed into the vector
//obviously rather wasteful but should produce the vector of object values we want
DD_DungeonRoom* tempRoom = new DD_DungeonRoom();
mvLayoutArray.push_back(*(tempRoom));
delete tempRoom; 
```

第一个问题：在方法 A 中，是否产生了内存泄漏？
第二个问题：假设A确实产生了内存泄漏，B解决了吗？第三个问题：是否有（或更可能是“什么是”）将自定义类对象（例如，需要通过“new”或“malloc”动态分配）按值添加到向量的更好方法？

谢谢，CCJ

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-01-09T18:23:51.450

> 第一个问题：在方法 A 中，是否产生了内存泄漏？

是的。

> 第二个问题：假设A确实产生了内存泄漏，B解决了吗？

是的，但这是一个愚蠢的解决方案。并且在`DD_DungeonRoom`的复制构造函数或`vector::push_back`抛出异常的情况下不安全。

> 第三个问题：是否有（或更可能是“什么是”）将自定义类对象（例如需要通过“new”或“malloc”动态分配）按值添加到向量的更好方法？

C++ 中没有对象需要动态内存分配。只需将对象直接添加到调用构造函数 sans 的向量中`new`。

```
mvLayoutArray.push_back(DD_DungeonRoom()); 
```

更好的是，如果您的编译器支持该功能（它是 C++11 的新功能），将使用`emplace_back`它完全绕过任何副本，并直接在向量中构造您的对象。只需将与构造函数相同的参数传递给它。在我们的例子中，没有：

```
myLayoutArray.emplace_back(); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-09T18:27:24.670

方法 A 会导致泄漏，是的。方法 B 没有，但是由于您所做的只是在堆上分配一个对象，将一个副本放入向量中然后删除它，因此在这种情况下您也可以这样做：

```
DD_DungeonRoom tempRoom;
mvLayoutArray.push_back(tempRoom); 
```

如果您希望析构函数之后立即运行，您可以选择在它周围做一个块以使局部变量超出范围。

此外，如果您对某些东西是否会泄漏内存感到好奇，有很多很好的工具可以实际尝试一下，看看会发生什么。[valgrind](http://valgrind.org/)是一个超级好用的例子。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-09T18:38:12.753

如果您对 aproch A 的唯一问题是内存泄漏，为什么不使用 shared_ptr 向量呢？

# ios - AFHTTPRequestOperation 返回缓存的 SOAP WSDL 文件，在浏览器中测试不会

> ID：14243841
> 
> 赞同：0
> 
> 时间：2013-01-09T18:20:02.547
> 
> 标签：ios, objective-c, afnetworking, nsmutableurlrequest

我已经在这个问题上工作了几个小时，但我无法弄清楚。

我的服务器创建了一个 WSDL 文件，用户可以使用新功能对其进行更新，并且 WSDL 文件将更新以反映这些更改。我正在使用`AFHTTPRequestOperation`with`GET`来获取该文件，以便检查文件中存在哪些函数。

出于某种原因，在用户更新文件并重新生成它之后，`AFHTTPRequestOperation`仍然看到旧版本（缓存？），但是如果我在浏览器中查看相同的 URL，而不是登录到我的网站或任何东西，它会显示新版本的文件。即使尝试`wget`抓住新副本。

我确保`NSURLRequestReloadIgnoringLocalAndRemoteCacheData`在我的身上使用，`NSMutableURLRequest`但这似乎并不重要：

```
// Setup the connection
NSString *wsdlURL = [NSString stringWithFormat:@"%@?WSDL", site.soapURL];
NSURL *serviceUrl = [NSURL URLWithString:wsdlURL];
NSMutableURLRequest *serviceRequest2 = [NSMutableURLRequest requestWithURL:serviceUrl cachePolicy:NSURLRequestReloadIgnoringLocalAndRemoteCacheData timeoutInterval:60.0];
[serviceRequest2 setHTTPMethod:@"GET"];

// Create the operation
AFHTTPRequestOperation *operation2 = [[AFHTTPRequestOperation alloc] initWithRequest:serviceRequest2];
[operation2 setCompletionBlockWithSuccess:^(AFHTTPRequestOperation *operation2, id responseObject2) {

    // Convert data to string
    NSString *wsdlStr = [[NSString alloc] initWithData:(NSData *)responseObject2 encoding:NSUTF8StringEncoding];

} failure:^(AFHTTPRequestOperation *operation2, NSError *error) {
    failure(error);
}];
[operation2 start]; 
```

有谁知道为什么它会得到文件的旧副本？浏览器显示新的？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-09T20:03:58.250

我意识到我需要在请求中添加以下内容：

```
[serviceRequest2 setValue:@"no-cache" forHTTPHeaderField:@"Cache-Control"]; 
```

# ruby - 没有“每个”的红宝石哈希迭代

> ID：14243842
> 
> 赞同：1
> 
> 时间：2013-01-09T18:20:04.013
> 
> 标签：ruby

我有一个红宝石哈希`a`如下：

```
a = {
      "module" => 'students',
      "data" => [
        {
          "age" => 12,
          "uid" => 'sd3wrew'
        },
        {
          "age" => 10,
          "uid" => '43e43r'
        },
        {
          "age" => 10,
          "uid" => 'ft34f'
        }
      ]
    } 
```

我想`uid`从上面的哈希中收集所有内容并得到一个数组，如：

```
b = ['sd3wrew', '43e43r', 'ft34f'] 
```

所以，我有代码来做到这一点，它循环通过它。

```
b = []
a['data'].each do |e|
  b << e['uid']
end 
```

`each`有没有办法在没有循环和简洁的情况下实现这个结果？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-01-09T18:22:13.413

您正在寻找称为[“地图”的函数式编程概念。](http://en.wikipedia.org/wiki/Map_%28higher-order_function%29)

```
b = a['data'].collect {|e| e['uid'] }
# or
b = a['data'].map {|e| e['uid'] } 
```

[http://www.ruby-doc.org/core-1.9.3/Array.html#method-i-map](http://www.ruby-doc.org/core-1.9.3/Array.html#method-i-map)

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2013-01-09T18:43:25.633

如果 key 等于 ，这将打印散列中的每个键`uid`：

```
b = a["data"].each_key { |e| print e if e='uid' } 
```

# meteor - Meteor.user() 只返回它的 _id

> ID：14243846
> 
> 赞同：7
> 
> 时间：2013-01-09T18:20:15.650
> 
> 标签：meteor

在使用（客户端）登录用户`Meteor.loginWithPassword()`或创建新用户后`Accounts.createUser`，我可以在他们的回调中确认`Meteor.user()`确实包含所有设置记录的属性。

```
{ _id: "XXX",
  profile: {
     name: "Joe Shmoe",
     thumbnail: "http://www.YYY.com/ZZZ.jpg"
  },
  username: "joeshmoe" } 
```

此外，根据[官方文档](http://docs.meteor.com/#meteor_users)，

> 默认情况下，当前用户的用户名、电子邮件和个人资料会发布到客户端。

那么，当我尝试访问我的模板中的这些字段时，任何人都能够说出为什么

```
Template.login.user_name = function () {
    return (Meteor.userId() ? Meteor.user().profile.name : '')
}; 
```

它失败是因为`Meteor.user()`只返回`{_id: "XXX"}`没有任何实际属性？即用户肯定已登录，但用户对象突然丢失/隐藏其所有属性。

有谁知道可能是什么问题？

非常感谢。

**编辑：** *这发生在 Meteor 0.5.4 上，这是撰写本文时的最新版本。接受的答案确实解决了这个问题；有时`Meteor.userId()`在对象的其余部分从服务器到达之前已经有效。谢谢大家。*

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-01-09T18:42:29.193

数据可能尚未从服务器到达。如果您检查属性，而不是只检查 Meteor.userId，会发生什么？

```
Template.login.user_name = function() {
  return Meteor.userId() && Meteor.user() && Meteor.user().profile ? Meteor.user().profile.name : "";
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-10T05:37:13.373

这也发生在我身上，使用 loginWithFacebook。我使用这个功能，到目前为止它没有问题：

```
var reallyLoggedIn = function() {
  var user = Meteor.user();
  if (!user) return false;
  else if (!user.profile) return false;
  else return true;
}; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-09T19:02:35.327

我无法重现这个问题，但如果你有用户 ID，你可以从完整的数据库 Meteor.users 中获取所有信息（即使它应该已经这样做了）。

```
Template.login.user_name = function() {
    return (Meteor.userId() ? Meteor.users.findOne({_id:Meteor.userId()}).profile.name : '')
} 
```

# javascript - 如何为每一行添加行 ID？

> ID：14243852
> 
> 赞同：4
> 
> 时间：2013-01-09T18:20:47.957
> 
> 标签：javascript, jquery, datatables

我正在尝试使用 jquery 数据表向 tr 添加行 ID。我什至尝试了示例 [http://datatables.net/release-datatables/examples/server_side/ids.html](http://datatables.net/release-datatables/examples/server_side/ids.html)但似乎没有用，我使用了相同的 JSON 文件。

任何帮助将不胜感激。

它应该给出类似的东西

```
<tr id="row_7">
  <td>Emkay Entertainments</td>
  <td>Nobel House, Regent Centre</td>
  <td>Lothian</td>
</tr>
<tr id="row_8">
  <td>The Empire</td>
  <td>Milton Keynes Leisure Plaza</td>
  <td>Buckinghamshire</td>
</tr> 
```

**> 更新代码**

```
<script type="text/javascript" charset="utf-8">
  $(document).ready(function () {
    var oTable = $('#example').dataTable(
      /** column structure and ppoluating columns **/ {
      "aoColumnDefs": [{
          "aTargets": [0],
          //"mData": "download_link",
          "mRender": function (data, type, full) {}
        }, {
          "aTargets": [1],
          //"mData": "download_link",
        }, {
          "aTargets": [2],
          //"mData": "download_link",
        }, {
          "aTargets": [3],
          //"mData": "download_link",
        }, {
          "aTargets": [4],
          //"mData": "download_link",
        }],
      "fnRowCallback": function(nRow, aData, iDisplayIndex) {
        nRow.setAttribute('id',some_variable);
      },
      "bFilter": false,
      "sScrollY": "300px",
      "bPaginate": false,
      "bProcessing": true,
      //"bServerSide": true,
      "sAjaxSource": "media/sample.json"
    }
  /*** End of column structure **/).makeEditable({
      sUpdateURL: "UpdateData.php",
      sAddURL: "AddData.php",
      sAddHttpMethod: "GET", //Used only on google.code live example because google.code server do not support POST request
      sDeleteURL: "DeleteData.php"
    });
  });
</script> 
```

HTML

```
<div id="demo">
  <table cellpadding="0" cellspacing="0" border="0" class="display" id="example">
    <thead>
      <tr>
        <th width="20%">field</th>
        <th width="25%">field 2</th>
        <th width="25%">field 3</th>
        <th width="15%">field 4</th>
        <th width="15%">field 5</th>
      </tr>
    </thead>
    <tbody></tbody>
  </table>
  <div class="add_delete_toolbar" /></div>
  <div class="spacer"></div> 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-09T18:31:47.790

您可以将以下内容添加到 dataTables 初始化选项中：

```
"fnRowCallback": function(nRow, aData, iDisplayIndex) {
    nRow.setAttribute('id',some_variable);
} 
```

要将特定表格单元格的值用作每行的 ID，请从`aData`变量中提取它：

```
"fnRowCallback": function(nRow, aData, iDisplayIndex) {
    nRow.setAttribute('id',aData[0]);
} 
```

[http://www.datatables.net/examples/advanced_init/row_callback.html](http://www.datatables.net/examples/advanced_init/row_callback.html)

# clearcase - 在 ClearCase 中重新定位符号链接

> ID：14243853
> 
> 赞同：1
> 
> 时间：2013-01-09T18:20:58.973
> 
> 标签：clearcase, symlink

我正在使用带有 ClearCase Explorer 7.0.1.0-IFIX01 的 Windows XP。

我有以下目录：

```
/vob_myvob/path/to/symlink/ 
```

它指向以下目录：

```
/vob_exports/path/to/third/party/dependencies/v3.4.1.0/LATEST_STABLE 
```

我想更改它，以便对于我的“未来开发”分支，我使用与所有其他分支不同的符号链接目标：

```
/vob_exports/path/to/third/party/dependencies/v3.4.6.0/LATEST_STABLE 
```

v3.4.1 和 v3.4.6 之间有很多重大变化，所以我需要完全隔离。

符号链接在这里甚至是正确的方法吗？我们无权访问 UCM。

请注意，我不是要创建符号链接。一个已经存在。我提到我的操作系统是因为我在 IBM 的网站上读到它不建议在 Windows 上弄乱符号链接。如有必要，我可以要求我们的管理团队在 UNIX 方面做一些事情。到目前为止，它们不是很有帮助，可能需要一个好的指针。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-09T20:00:59.793

UCM 不相关，除非您每个第三方都有一个 UCM 组件。

我之前为第三方尝试过符号链接方法，但除非你在谈论*源*依赖关系，否则我已经将所有这些第三方二进制文件从 ClearCase 中导出，并放在像[Nexus](http://www.sonatype.org/nexus/)这样的适当的工件存储库中。

这样，我只能对*声明*我需要的依赖项的文件进行版本化（`pom.xml`在 Nexus 的情况下为 a），这意味着特定分支可以具有该文件的一个版本，该文件声明对 3.4.6.0 的依赖项，而同一文件包括 3.4。 1.0 在所有其他分支中。

这是当前的最佳实践（即使用*源代码*控制工具来版本*源代码*，而不是二进制文件）

话虽这么说，符号链接（如`cleartool ln`）可以工作（在 Windows 或 Unix 上），只有一些副作用（如本[技术说明所示](http://www-01.ibm.com/support/docview.wss?uid=swg1PM04810)）

# c++ - C++：即使转换的对象不是 NULL，dynamic_cast 也会导致 SEGFAULT。怎么会这样？

> ID：14243854
> 
> 赞同：6
> 
> 时间：2013-01-09T18:20:58.103
> 
> 标签：c++, segmentation-fault, dynamic-cast

假设我有一个类 A 和一个派生自 A 的类 B。现在，我想使用 dynamic_cast 将 const A*（称为“a”）转换为 B*（见下文）。如果“a”真的是 B*，那么我得到的对象指针应该没问题。如果“a”不是 B*，那么我将得到 NULL。

```
const A* a = new B();
const B* b = dynamic_cast<const B*>(a); 
```

由于某种原因，dynamic_cast 操作会导致 SEGFAULT。如果“a”不为空，怎么会发生这种情况？我猜如果有任何转换问题，dynamic_cast 会给我一个 NULL 指针，而不是 SEGFAULT。如果我试图访问“b”并且动态转换不成功，我应该只获得 SEGFAULT，对吗？我什至还没有尝试访问“b”。

那么，这怎么会发生呢？在上面的代码中是否有任何东西可以导致 dynamic_cast 到 SEGFAULT，我不知道？

提前致谢 ：-）

编辑：通过 GDB 运行我的实际程序会给出以下输出：

```
Program received signal SIGSEGV, Segmentation fault.
0x0000000000000000 in ?? ()
(gdb) where
#0  0x0000000000000000 in ?? ()
#1  0x00007ffff6c0e612 in __cxxabiv1::__dynamic_cast (src_ptr=<optimized out>, 
src_type=0x4fa6b0, dst_type=0x516bb0, src2dst=0)
at /var/tmp/portage/sys-devel/gcc-4.6.3/work/gcc-4.6.3/libstdc++-v3/libsupc++/dyncast.cc:61 
```

输出中的下一行只是指向我的代码中进行动态转换的行。

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2013-01-09T18:30:25.757

使用 dynamic_cast 时可能导致崩溃的原因

*   指针指向一个空闲的内存块。
*   指针指向非多态类型。
*   指针指向具有多态类型但存在于禁用 RTTI 编译的外部库中的对象。
*   指针指向可能导致保护异常的内存访问（例如保护页或不可访问页）。

验证其中一种情况是否适用于您。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2016-04-21T15:34:46.783

对于像我这样的其他人，您可能不小心给了转换对象与您从中转换它的对象相同的变量名！

```
A *name = new B();
B *name = dynamic_cast<B*>(name); 
```

对于如此明显的代码，这**显然**是错误的，但是由于变量分散并且演员表被混淆，这样的错误可能更难被发现！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-10-20T07:57:12.210

我得到了这个...这是因为我未能初始化指针，它指向随机垃圾。

# qt - Googletest 中的 QApplication 段错误

> ID：14243858
> 
> 赞同：0
> 
> 时间：2013-01-09T18:21:21.957
> 
> 标签：qt, qt4, googletest

我有两个调用 QApplication 的 Googletest。当我运行测试时，第二个测试会抛出一个`Segmentation fault`. 添加`app.quit()`或`.exit(0)`没有帮助。有什么帮助，但我不想做的是构建`QApplication app(argc, argv, false)`，它设置了`GuiEnabled = false`.

关于做什么的任何想法？下面是显示此行为的代码。

MWE：

```
#include <gtest/gtest.h>

#include <QtGui/QApplication>

TEST(Foo, empty) {
  char** argv;
  int argc = 0;
  QApplication app(argc, argv);
  app.quit();
}

TEST(Foo, empty2) {
  char** argv;
  int argc = 0;
  QApplication app(argc, argv);
  app.quit();
} 
```

这是在 Qt4 中，Googletest 1.6.0。

# biztalk - 将多部分消息传递给编排

> ID：14243864
> 
> 赞同：0
> 
> 时间：2013-01-09T18:21:35.163
> 
> 标签：biztalk

嗨 BT 大师在那里！

我正在努力将填充的多部分消息从一个编排传递到另一个编排。我尝试过的事情：

*   使用“调用编排”形状并将消息作为参数传递（RuntimeInternalErrorException）
*   将消息发布到 MessageBox（直接绑定），然后由另一个业务流程拾取，该业务流程订阅了具有该多部分模式的消息（找不到索引为 2 的部分。此消息中的部分数为 1。确保如果您期望多部分消息，则您正在使用解码 MIME 消息的自定义管道。） - 我如何使用带有直接绑定的自定义管道？
*   将消息发布到 MSMQ 并绑定第二个业务流程以使接收端口在该 MSMQ 上侦听（“无法解码 S/MIME 消息。S/MIME 消息可能无效。”）

请帮忙！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-10T18:56:59.173

您在第二个项目符号中遇到的问题：与以正确的顺序创建多部分消息有关。您必须以相同的顺序为这两个 Multipart 消息创建部分。

例子：

```
Orch A.
1\. Header
2\. Body
3\. Footer

Orch B.
1\. Body
2\. Header
3\. Footer 
```

Biztalk 将匹配如下类型：

```
Orch A.   --> Orch B   
1\. Header --> Body
2\. Body   --> Header
3\. Footer --> Footer 
```

这会导致您收到错误。

[试试这个网站以获得更好的解释使用开始编排形状](http://msdn.microsoft.com/en-us/library/aa577574.aspx)

# c# - 如何从日期时间列按月过滤数据视图？

> ID：14243868
> 
> 赞同：0
> 
> 时间：2013-01-09T18:21:43.530
> 
> 标签：c#, date, datagridview

我有一个`DataGridView`我想从另一个组合中按月份名称过滤的。我有一个包含日期值的列（日期时间列，称为“数据”）。

我想，首先我需要从日期字段中提取月份名称并将其与组合框选定项进行比较。

数据是从 mysql 接收的，它是一个 Windows 窗体。

因此，在我要过滤的数据网格中，日期字段称为“数据”。包含月份名称的组合已填充：

```
for (int i = 0; i <= 12; i++)
        {
            comboBox3.Items.Add(System.Globalization.CultureInfo.CurrentCulture.DateTimeFormat.MonthNames[i]);
        } 
```

因此，当我从组合中选择一个月时，我希望过滤数据网格中的记录，以便仅显示组合中指定的月份的记录。

我不知道如何制作过滤器。数据网格中的日期字段是 ("yy-mm-dd")，组合包含月份名称。我尝试将数据网格中的日期字段格式化为“MMMM” - 与组合格式相同，但它不起作用，我猜是因为值仍然是 yy-mm-dd 格式，只是外观细胞改变了。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-11T02:19:56.673

这是一个解决方案...

```
dt.DefaultView.RowFilter = "CONVERT(SUBSTRING(CONVERT(data, 'System.String'), 4, 2), 'System.Int32')-1= " + comboBox3.SelectedIndex; 
```

我瞄准组合的索引，过滤器获取月份编号，而不是名称......我使用的是罗马尼亚文化，所以对于英语，它必须稍作调整。感谢大家...

# achartengine - AchartEngine 放大折线图线时消失

> ID：14243870
> 
> 赞同：3
> 
> 时间：2013-01-09T18:21:47.957
> 
> 标签：achartengine

我正在使用 AchartEngine 绘制具有多条线的图形（折线图）。放大时，点之间的线消失，只有点保持可见。有人遇到过这样的问题吗？

![在此处输入图像描述](../Images/dd823b740379a45ce83c1a7817e565ac.png)

![在此处输入图像描述](../Images/dd2b9268a0b5fb683f2f80312c99dfbc.png)

代码没什么特别的。

XYMultipleSeriesDataset mDataset = new XYMultipleSeriesDataset(); XYMultipleSeriesRenderer mRenderer = new XYMultipleSeriesRenderer();

```
 XYSeries IVseries=new XYValueSeries("IV");
    XYSeries IV_stc_series=new XYValueSeries("IVstc");

    for(double i=0;i<6;i=i+0.1){
        IVseries.add(sin(i),cos(i));
        IV_stc_series.add(2*sin(i),cos(i));
    }

    mDataset.addSeries(IVseries);
    mDataset.addSeries(IV_stc_series);

    XYSeriesRenderer IVrenderer = new XYSeriesRenderer ();
    IVrenderer.setFillPoints(true);
    IVrenderer.setPointStyle(PointStyle.TRIANGLE);
    IVrenderer.setLineWidth(5);
    IVrenderer.setColor(Color.GREEN);
    mRenderer.addSeriesRenderer(IVrenderer);

    XYSeriesRenderer IV_stc_renderer = new XYSeriesRenderer ();
    IV_stc_renderer.setFillPoints(true);
    IV_stc_renderer.setPointStyle(PointStyle.X);
    IV_stc_renderer.setLineWidth(5);
    IV_stc_renderer.setColor(Color.RED);
    mRenderer.addSeriesRenderer(IV_stc_renderer);

    mRenderer.setPanEnabled(true,true);
    mRenderer.setZoomEnabled(true, true);
    mRenderer.setZoomButtonsVisible(true);
    mRenderer.setXLabels(20);
    mRenderer.setYLabels(20);
    mRenderer.setShowGrid(true);
    mRenderer.setGridColor(Color.BLACK);
    mRenderer.setApplyBackgroundColor(true);
    mRenderer.setBackgroundColor(Color.WHITE);

    mChartView = ChartFactory.getLineChartView(context, mDataset, mRenderer);
    layout.addView(mChartView, new LinearLayout.LayoutParams(LinearLayout.LayoutParams.MATCH_PARENT,
            LinearLayout.LayoutParams.MATCH_PARENT)); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-11-27T12:43:40.260

您还可以仅针对特定视图禁用硬件加速：

```
View.setLayerType(View.LAYER_TYPE_SOFTWARE, null); 
```

这解决了我使用 achartengine 的问题。是的，在较旧的手机中，渲染明显不那么流畅......

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-14T11:08:46.153

最终我通过在 AndroidManifest.xml 中禁用硬件加速解决了这个问题

安卓：硬件加速=“假”

这样无论我放大多少，线条总是被渲染。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-07-25T13:01:13.737

这可能是因为 AbstarctChart==> calculateDrawPoint 返回浮点数组，其中有时包含 Float.NaN 。请检查帖子

[https://stackoverflow.com/a/38568422/2732632](https://stackoverflow.com/a/38568422/2732632)

# windows - windows批处理多任务问题-代码清理

> ID：14243875
> 
> 赞同：1
> 
> 时间：2013-01-09T18:22:03.870
> 
> 标签：windows, arrays, batch-file, multitasking

**如果一些Windows 批处理大师**愿意**帮助我清理我的代码**，我将不胜感激。 好的 .bat 正在工作，但它的实现很混乱，我想让它在两件事上更简单和更干净：

1-我已经放了一个“sleep 1 s”让上面那行的“复制”完成，否则似乎“for（）”与程序的其余部分一起执行多任务，对吗？

2-我愿意使用数组来存储文件名，而不是每次都重新列出它们！

[如果你想知道：代码在做什么？它正在连接 MP3 文件：silences.mp3 +inductions.mp3 以创建带有一点随机性的感应的长音轨]

感谢任何人的帮助！

* * *

```
@ECHO OFF
CLS

SETLOCAL EnableExtensions EnableDelayedExpansion

REM -----------   SET VALUES   -----------
REM   RECOMMENDED FORMAT : MP3 CBR 16kHz --> 8kbps silence  & 16kbps voice
SET Folder=.\inductions\
SET SilenceMP3=1s-blank.mp3
SET OutputMP3=output.mp3

REM -----------   GET USER INPUTS   -----------
SET /p MAX_TIME=Maximum time seconds  : 
SET /p MIN_TIME=Minimum time seconds  : 
SET /p     LOOP=Nombre de repetitions : 

SET /a MAX_TIME-=MIN_TIME

REM -----------   COUNTING NB OF INDUCTION AVAIL   -----------
SET Nb_induction=0
for /r "%folder%" %%a in (*.*) do ( SET /a Nb_induction+=1 )

REM -----------   INIT THE OUTPUT WITH 1s SILENCE   -----------
copy /Y %SilenceMP3% %OutputMP3%  1> nul

for /L %%i IN (0,1,%LOOP%) do (
    REM -----------   GET A RANDOM TIME SILENCE   -----------
    SET /A REP=!RANDOM! %% !MAX_TIME! + !MIN_TIME!

    REM -----------   ADD !REP! seconds of silence   -----------
    for /L %%j IN (0,1,!REP!) do (      
        copy /B %OutputMP3% + /B %SilenceMP3% /B %OutputMP3%  1> nul
        )
sleep 1

    REM -----------   ADD RANDOM INDUCTION   -----------
    SET /a x=!RANDOM! %% %Nb_induction%

    for /r "%folder%" %%a in (*.*) do (
        IF !x!==0 ( SET InductionMP3=%%a )
        SET /a x-=1
        )

    copy /B %OutputMP3% + /B !InductionMP3! /B %OutputMP3%   1> nul
echo %%i
    ) 
```

* * *

Antonio（第一次感谢），您的代码输出：

```
Maximum time seconds  : 20
Minimum time seconds  : 10
Nombre de repetitions : 2
AVAILABLE INDUCTION FILES:
InductionMP3[1]=D:\auto-induction\inductions\je_sors_de_mon_corps1.mp3
InductionMP3[2]=D:\auto-induction\inductions\je_sors_de_mon_corps2.mp3
InductionMP3[3]=D:\auto-induction\inductions\je_sors_de_mon_corps3.mp3
RANDOM INDUCTION # 1: D:\auto-induction\inductions\je_sors_de_mon_corps1.mp3
copy /B output.mp3 + /B D:\auto-induction\inductions\je_sors_de_mon_corps1.mp3 /
B output.mp3
0
RANDOM INDUCTION # 1: D:\auto-induction\inductions\je_sors_de_mon_corps1.mp3
copy /B output.mp3 + /B D:\auto-induction\inductions\je_sors_de_mon_corps1.mp3 /
B output.mp3
1
RANDOM INDUCTION # 2: D:\auto-induction\inductions\je_sors_de_mon_corps2.mp3
copy /B output.mp3 + /B D:\auto-induction\inductions\je_sors_de_mon_corps2.mp3 /
B output.mp3
2 
```

* * *

cmd问题：（不明白这个神秘的问题吗？所以我暂时保持模运算）

```
SET /a x=(!RANDOM! * Nb_induction) / 32768 + 1 
```

产生错误：

```
/ was unexpected at this time. 
```

我尝试了更多（）：`SET /a x=((!RANDOM! * Nb_induction) / 32768 ) + 1` 没有更多的成功！

* * *

1- %% 模运算符是整数除法的余数： set /A mod=13 %% 5 给出 3；请参阅 en.wikipedia.org/wiki/Random_number_generation。

同意，您的解决方案是正确的数学/统计实现（如果 win 可以正确处理乘法/除法；-)）

2- 我展示了 !InductionMP3[!x!]! 示例仅用于教育目的，但不能使用（正如我在回答中所说）。

对，我试着把它扭曲一下！InductionMP3[!x!]!, !InductionMP3[%x%]！等等...仍然无法使用 EnableDelayedExpansion 的东西 %a% %%a !a! ETC...

3- 我在代码中添加了一些 ECHO 命令来帮助发现问题。请再次复制上面的程序，运行它并以代码格式发布输出作为您问题的编辑（不在评论中）。

抱歉回复乱七八糟

4- 你读过关于阵列管理的帖子吗？我认为这并不难，但请随时提出任何问题

我做到了，数组非常好/容易，只是 %variable% 的事情仍然超出我的控制范围......

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-09T22:14:04.660

关于您的代码的一些评论：

*   `FOR`command 不会并行执行，因此`SLEEP`不需要 command。

*   命令中的变量`SET /A`不需要扩展；SET 命令正确地自行获取其值。

*   划分 !RANDOM! 不是一个好主意！最大。限制并获得余数，因为结果数与原始 !RANDOM! 的分布不同，因此您可能会得到相同结果的多次重复。使用 !RANDOM! 的正确方法！如下图所示。

*   批处理中的数组管理非常简单，如[本文](https://stackoverflow.com/questions/10166386/arrays-linked-lists-and-other-data-structures-in-cmd-exe-batch-script/10167990#10167990)所述。

这是我的代码版本：

```
@ECHO OFF
CLS

SETLOCAL EnableExtensions EnableDelayedExpansion

REM -----------   SET VALUES   -----------
REM   RECOMMENDED FORMAT : MP3 CBR 16kHz --> 8kbps silence  & 16kbps voice
SET Folder=.\inductions\
SET SilenceMP3=1s-blank.mp3
SET OutputMP3=output.mp3

REM -----------   GET USER INPUTS   -----------
SET /p MAX_TIME=Maximum time seconds  : 
SET /p MIN_TIME=Minimum time seconds  : 
SET /p     LOOP=Nombre de repetitions : 

SET /a MAX_TIME-=MIN_TIME

REM -----------   COUNTING NB OF INDUCTION AVAIL   -----------
REM -- AND CREATE THE INDUCTION ARRAY AT THE SAME TIME --
ECHO AVAILABLE INDUCTION FILES:
SET Nb_induction=0
for /r "%folder%" %%a in (*.*) do (
    SET /a Nb_induction+=1
    SET InductionMP3[!Nb_induction!]=%%a
    ECHO InductionMP3[!Nb_induction!]=%%a
)

REM -----------   INIT THE OUTPUT WITH 1s SILENCE   -----------
copy /Y %SilenceMP3% %OutputMP3%  1> nul

for /L %%i IN (0,1,%LOOP%) do (
    REM -----------   GET A RANDOM TIME SILENCE   -----------
    SET /A "REP=(!RANDOM! * MAX_TIME) / 32768 + MIN_TIME"

    REM -----------   ADD !REP! seconds of silence   -----------
    for /L %%j IN (0,1,!REP!) do (      
        copy /B %OutputMP3% + /B %SilenceMP3% /B %OutputMP3%  1> nul
    )
    REM sleep 1  NOT REQUIRED

    REM -----------   ADD RANDOM INDUCTION   -----------
    SET /a "x=(!RANDOM! * Nb_induction) / 32768 + 1"

    for %%x in (!x!) do (
        ECHO RANDOM INDUCTION # %%x: !InductionMP3[%%x]!
        ECHO copy /B %OutputMP3% + /B !InductionMP3[%%x]! /B %OutputMP3%
        copy /B %OutputMP3% + /B !InductionMP3[%%x]! /B %OutputMP3%   1> nul
    )

    echo %%i
) 
```

请注意，在最后一个`COPY`命令中，随机感应文件的名称是这样的：

```
 copy /B %OutputMP3% + /B !InductionMP3[!x!]! /B %OutputMP3%   1> nul 
```

但是，不可能将延迟扩展嵌套在另一个扩展中，因此使用`FOR`命令来实现第一个扩展并在第二个扩展中使用其可替换值。有关详细信息，请参阅上一个链接。

安东尼奥

# asp.net-mvc-3 - Mvc3 在 Httppost 之后检查表单值

> ID：14243876
> 
> 赞同：1
> 
> 时间：2013-01-09T18:22:03.837
> 
> 标签：asp.net-mvc-3, modelstate

我有 2 个问题，1\. 我有一个编辑操作并使用 formcollection 从 Httppost 上的**HiddenFor**中获取值，然后我用它来更改另一个数据库表，我想知道有没有一种方法可以提交表单后查看该 FormCollection 的值？

```
[HttpPost]
    public ActionResult Edit(relisting house,FormCollection tt)
    {

        if (ModelState.IsValid)
        {

// I would like a way to check the value of getid after submission since 
//my code isn't working. This is an EDIT Action so the GETID has a value 
 //atleast before the post.
            int getid = Convert.ToInt32(tt["RegistrationID"]);
var checksopen = (from d in db.openhouses where getid == d.RegistrationID 
select d).FirstOrDefault();

            house.squarefeet = checksopen.squarefeet;
            house.city = checksopen.city;

            db.Entry(checksopen).State = EntityState.Modified;
            db.SaveChanges();

        }
        return View(house);
    } 
```

我的最后一个问题是我上面的完整代码使用 2 db.Entry().State = EntityState.Modified; 但只有 1 个在工作；有什么可以使第二个 entity.modified 不起作用？假设**checkopen**确实有匹配项？我正在将数据从重新列出的父模型传递**到**子模型**openhouse**，因此对于每个 openhouse 都有一个重新列出，所以我想捕获两者的变化以保持同步。

```
 [HttpPost]
    public ActionResult Edit(relisting house,FormCollection tt)
    {

        if (ModelState.IsValid)
        {

 // This one works
            db.Entry(house).State = EntityState.Modified;
            db.SaveChanges();

// This one doesn't work

            int getid = Convert.ToInt32(Request.Form["RegistrationID"]);

            var checksopen = (from d in db.openhouses where getid == 
    d.RegistrationID select d).FirstOrDefault();

            house.squarefeet = checksopen.squarefeet;
            house.city = checksopen.city;

            db.Entry(checksopen).State = EntityState.Modified;
            db.SaveChanges();

        }
        return View(house);
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-09T18:38:53.097

> 我想知道有没有一种方法可以在表单提交后查看该 FormCollection 的值？

有可能的。您的代码可能会将参数传递给`Model`您在发布操作后返回的属性。`return View(house);`您正在返回名为`house`. 只需向此模型添加一个新的公共参数并将您的分配`RegistrationID`给它。

**提示：**出于性能考虑，无需发布`FormCollection`，因为它会发布您视图中的每个项目。仅发布`Model`包含具有隐藏模型值的必要属性的内容将是一种更好的方法。

# php - JQuery Full Calendar 使用 PHP 限制事件

> ID：14243880
> 
> 赞同：0
> 
> 时间：2013-01-09T18:22:17.177
> 
> 标签：php, mysql, sql, fullcalendar

我正在使用 JQuery 完整日历事件。我知道到目前为止还没有一个选项可以按限制加载事件。

在月视图中，如果我在 1 天有 100 个事件，它会使表格单元格变得非常大。我想将其限制为每天 10 个事件。

我想我会做的是在服务器端使用 PHP。由于我在给定日期范围的情况下使用 PHP 加载所有事件，因此我想我会每天加载并将其限制为每天 10 个事件。

这就是我在 PHP 方面所拥有的：

```
 if ($currView == 'month') //curr view is the current view of the calendar
    {
        $start = $_GET['start']; //gets from the calendar usually start of month
        $end = $_GET['end']; //gets from calendar usually end of month
        //some array to store all events before using json_encode
        $limitEvents = array();
        $limit = 10;
        //loop through from start till end by 1 day incremental
        for ($i = $start; $i < $end; $i+=strtotime($i, "+1 day"))
        {
            //make the end of day to be the current day but 23:59:59
            $endOfDay = date('m/d/Y', $start);
            $endOfDay = strtotime($endOfDay . ' 23:59:59');
            //load the events from DB using date range which is 1 day and limit of events
            $loaded = $this->loadDataFromDB($start, $endofDay, $limit);
            //merge the arrays
            array_merge($limitTasks, $loaded);
        }
    } 
```

现在这段代码的问题是，当我尝试运行它时它不是最优的，它每天循环并每天查询并且需要很长时间，甚至超时。

我的问题是，我将如何在 MySQL 端执行此操作？我会给出从月初到月底的日期范围。我不会在 PHP 端每天循环并每天加载数据，而是在 MySQL 端这样做。例如查询看起来像这样：

```
 SELECT *
  FROM Events_Table
  WHERE Ev_Date BETWEEN :startMonth AND :endMonth 
  (have extra query to load by days within given start and end month
   and have LIMIT 10 per day) 
```

无法完成上述查询，括号中的文本需要转移到有效查询中，以便每天选择10个事件，共有31天，所以应该选择310个左右的事件

如果有人有更好的解决方案，请帮忙。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-09T23:54:12.983

如果您想每月最多拥有 10 个，请像下面这样更改以减少限制，因为您循环遍历这些天...

```
$currView == 'month') //curr view is the current view of the calendar
    {
        $start = $_GET['start']; //gets from the calendar usually start of month
        $end = $_GET['end']; //gets from calendar usually end of month
        //some array to store all events before using json_encode
        $limitEvents = array();
        $limit = 10;
        //loop through from start till end by 1 day incremental
        for ($i = $start; $i < $end; $i+=strtotime($i, "+1 day"))
        {
            //make the end of day to be the current day but 23:59:59
            $endOfDay = date('m/d/Y', $start);
            $endOfDay = strtotime($endOfDay . ' 23:59:59');
            //load the events from DB using date range which is 
            //1 day and limit of events
            if ($limit>0){ //if you want to have 10 in total add this
              $loaded = $this->loadDataFromDB($start, $endofDay, $limit);
              $limit -= count($loaded); //and this
            } //and this
            //merge the arrays
            array_merge($limitTasks, $loaded);
        } 
```

并让您的 mysql 查询限制您实际获得的数量

```
SELECT *
  FROM Events_Table
  WHERE Ev_Date BETWEEN :startMonth AND :endMonth 
  LIMIT 10 
```

然后，如果您仍然让它变慢，请检查您的数据库是否有正确的字段索引。当您在 where 子句中使用开始和结束月份时，当您向每个子句添加索引时，它们会查询得更快

此外，不确定您使用什么来运行查询，但请确保在占位符周围添加单引号，否则您仍然可以进行 mysql 注入；仅仅转义变量是不够的

# html - 为什么我的精灵只显示了一部分？

> ID：14243887
> 
> 赞同：1
> 
> 时间：2013-01-09T18:22:33.997
> 
> 标签：html, css

我为导航栏创建了一个精灵，以便通过 javascript/Jquery 我可以轻松地在悬停开/关状态之间切换。我的问题是不确定我的 css 是否显示 css 类#whatIS1031 #1031Exchange，并且 #howToStart 没有显示。

这是我的 HTML

```
 <ul id="nav">
            <li class="nav-button" id="home"><a href="Index.html"></a></li>
            <li class="nav-button" id="whatIS1031"><a href="whatIs1031.html"></a></li>
            <li class="nav-button" id="1031Exchange"><a href="exchangeRequ.html"></a></li>
            <li class="nav-button" id="typesOfExchange"><a href="typesOfExchange.html"></a></li>
            <li class="nav-button" id="whyCLX"><a href="howToStart.html"></a></li>
            <li class="nav-button" id="howToStart"><a href="whyCLX.html"></a></li>
            <li class="nav-button" id="resources"><a href="resources.html"></a></li>
            <li class="nav-button" id="faq"><a href="fAQs.html"></a></li>
            <li class="nav-button" id="fee"><a href="fees.html"></a></li>
            <li class="nav-button" id="contactUs"><a href="contactUs.html"></a></li>
        </ul>
        <!--End of nav--> 
```

这是我的CSS

```
#home, #home, #whatIs1031, #whatIs1031, #h-1031Exchange, #h-1031Exchange, #typesOfExchange, #h-typesOfExchange, #whyCLX, #h-whyCLX, #h-howToStart, #h-howToStart, #resources, #h-resources, #faq, #h-faq, #fee, #h-fee, #contactUs, #h-contactUs{
    background: url(http://i1287.photobucket.com/albums/a634/debuggingfool/nav_zps03a73d67.png) no-repeat;
}

#h-home{
    background-position: -222px 0;
    width: 225px;
    height: 30px;
}

#home{
    background-position: 0 0;
    width: 225px;
    height: 30px;
}

#whatIs1031{
    background-position: 0 36px;
    width: 225px;
    height: 30px;
}

#h-whatIs1031{
    background-position: -223px -36px;
    width: 225px;
    height: 30px;
}

#1031Exchange{
    background-position: 0 -72px;
    width: 225px;
    height: 30px;
}

#h-1031Exchange{
    background-position: -224px -73px;
    width: 225px;
    height: 30px;
}

#typesOfExchange{
    background-position: 0 -111px;
    width: 225px;
    height: 30px;
}

h-typesOfExchange{
    background-position: -226px -112px;
    width: 225px;
    height: 30px;
}

#h-whyCLX{
    background-position: -227px -150px;
    width: 225px;
    height: 30px;
}

#whyCLX{
    background-position: 0 -150px;
    width: 225px;
    height: 30px;
}

#howToStart{
    background-position: 0 -190px;
    width: 225px;
    height: 30px;
}

#h-howToStart{
    background-position: -230px -189px;
    width: 225px;
    height: 30px;
}

#h-resources{
    background-position: -230px -226px;
    width: 225px;
    height: 30px;
}

#resources{
    background-position: 0 -227px ;
    width: 225px;
    height: 30px;
}

#faq{
    background-position: 0 -264px ;
    width: 225px;
    height: 30px;
}

#h-faq{
    background-position: -230px -263px ;
    width: 225px;
    height: 30px;
}

#fee{
    background-position: 0 -302px ;
    width: 225px;
    height: 30px;
}

#h-fee{
    background-position: -231px -300px ;
    width: 225px;
    height: 30px;
}

#contactUs{
    background-position: 0 -341px ;
    width: 225px;
    height: 30px;
}

#h-contactUs{
    background-position: -231px -337px ;
    width: 225px;
    height: 30px;
} 
```

这是我在 codepen [http://codepen.io/Austin-Davis/pen/Fdhej上的代码这是我在 photobucket](http://codepen.io/Austin-Davis/pen/Fdhej) [http://s1287.beta.photobucket.com/user/debuggingfool/media/nav_zps03a73d67](http://s1287.beta.photobucket.com/user/debuggingfool/media/nav_zps03a73d67.png.html)
上的精灵的副本。 [png.html](http://s1287.beta.photobucket.com/user/debuggingfool/media/nav_zps03a73d67.png.html)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-09T18:37:11.760

该项目的所有 HTML 和 CSS 都值得大修，但这里是您特定问题的答案：

*   `whatIS1031`由于大写没有显示。元素的 ID 有一个大写的 'S' ( `whatIS1031`)，而 CSS 选择器有一个小写的 's' ( `whatIs1031`)。
*   `howToStart`没有出现，因为它在`background:url()`. 相反，`#h-howToStart`出现两次。

旁注：您应该试用 Chrome 的开发工具或 Firefox 的 Firebug。它们都具有检查 DOM 元素以查看应用了哪些 CSS 样式的方法。从那里您可以看到缺少哪些样式。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-09T18:44:24.447

除了这里提到的特定 ID 命名问题外，在 javascript 中没有理由这样做，因为 CSS 有一个完美的解决方案：

让我们以#home 为例：

```
#home {
    background-position: 0 0;
}

#home:hover {
    background-position: -222px 0;
} 
```

对每个元素重复此操作。您可能还想优化您的 CSS：

而不是专门为每个 ID 应用背景图像 -

```
#home, #home, #whatIs1031, #whatIs1031, #h-1031Exchange, #h-1031Exchange, #typesOfExchange, #h-typesOfExchange, #whyCLX, #h-whyCLX, #h-howToStart, #h-howToStart, #resources, #h-resources, #faq, #h-faq, #fee, #h-fee, #contactUs, #h-contactUs{
    background: url(http://i1287.photobucket.com/albums/a634/debuggingfool/nav_zps03a73d67.png) no-repeat;
} 
```

使用您已经应用于元素的类：

```
.nav-button {
    background: url(http://i1287.photobucket.com/albums/a634/debuggingfool/nav_zps03a73d67.png) no-repeat;
} 
```

此外，您不必为每个 ID 单独分配元素大小，如果它们的大小都相同的话。只需使用 -

```
.nav-button {
    background: url(http://i1287.photobucket.com/albums/a634/debuggingfool/nav_zps03a73d67.png) no-repeat;
    width:225px;
    height:30px;
} 
```

# sql-server - 如何创建包含父子层次结构的用户定义层次结构？

> ID：14243888
> 
> 赞同：0
> 
> 时间：2013-01-09T18:22:33.720
> 
> 标签：sql-server, ssas, olap, multidimensional-array, dimensional-modeling

**环境：SSAS 2005，投标 2008。**

**数据架构**：

系主任

*   部门编号*int* (PARENT)
*   SubDepartmentNumber *int* (CHILD)

分类大师：

*   DepartmentNumber *int 引用 DepartmentMaster.DepartmentNumber*
*   类别*编号 int*

**我想要的功能：**

*   分层钻取：

    *   部门 -> 类别
    *   部门 -> 子部门 -> 类别

**通过以下方式实现：**

*   类别维度
*   部门维度
    *   子部门和部门的父子层次结构。

**为什么这是一个问题：**

我觉得 Category 真的应该在同一个 Dimension 中，叫它“Product”或“Item”。最初，没有子部门，这就是我设置它的方式：

*   物品尺寸
    *   部门 -> 类别

不幸的是，一旦在部门级别引入了父实体，我就无法再以正确（或根本）构建的方式配置属性关系。

**我的问题：**

是否可以配置这些关系，使它们都在一维中，给我上面描述的层次结构？如果有可能 - 我应该吗？是不是因为我一开始就做错了，所以效果不好？

# node.js - PassportJS - 如何获取会话对象

> ID：14243893
> 
> 赞同：5
> 
> 时间：2013-01-09T18:22:56.987
> 
> 标签：node.js, express, passport.js

我已经在我的节点应用程序中实现了 passportJS。登录后，我得到一个放置在会话中的对象。这是对象：

```
{ loginStatus: 'SUCCESS',
  orgRoles: { '7': 'ALL' },
  orgNames: { '7': 'kianoshp@gmail.com' },
  loginId: 4,
  message: 'Success',
  success: true } 
```

这是护照配置（在咖啡脚本中）：

```
passport.serializeUser (user, done) -> 
    console.log 'serializing', user
    done null, user

passport.deserializeUser (user, done) ->
    console.log 'deserializing', user
    done null, user

#passport LocalStrategy
passport.use new LocalStrategy
    usernameField: 'email'
    passwordField: 'password'
    ,
    (username, password, done) ->
        validateUser username, password, done

validateUser = (username, password, done) ->

    console.log 'loginName is --> ' + username + ' password --> ' + password
    options = 
        protocol: API_PROTOCOL
        host: API_HOST
        pathname: '/appservices/login'

    reqURL = url.format options
    requestOptions =
        headers:
            'Content-type': 'application/json; charset=utf-8' 
        body: JSON.stringify 
            loginName: username
            password: password
        method: 'POST'

    request reqURL, requestOptions, (error, response, body) ->
        console.log 'body is --> ' + body
        resObj = JSON.parse body.toString()

        console.log 'loginStatus is --> ' + resObj.loginStatus

        if resObj.loginStatus is 'FAIL' or resObj.loginStatus is 'INVALID_PASSWORD' or resObj.loginStatus is 'LOGIN_NOT_FOUND'
            return done null, false, 
                message: 'We couldn\'t find that email/password, please try again.'
        if resObj.loginStatus is 'ACCOUNT_LOCKED'
            return done null, false, 
                message: 'The user has been locked out due to too many unsuccessful login attempts or the admin has locked the account. Please contact admin or customer support.' 
        if resObj.loginStatus is 'NO_LOGIN_DOMAIN_AVAILABLE'
            return done null, false, 
                message: 'The login attempt is valid but there is no registered domain that the login can access. Please contact admin or customer support.' 
        if resObj.loginStatus isnt 'SUCCESS'
            return done null, false, 
                message: 'The login attempt has failed. If you feel this is an error please try again or contact admin/customer support.' 

        done null, resObj

app.configure ->
    #app.use express.logger()
    app.use express.static(__dirname + '/public')
    app.use express.cookieParser()
    app.use express.bodyParser()
    app.use express.methodOverride()
    app.use express.session
        secret: '###########'
        store: new RedisStore()
        cookie:
            maxAge: 3600000
    app.use flash()
    app.use passport.initialize()
    app.use passport.session()
    app.set 'view engine', 'jade'
    app.set 'views', __dirname + '/views'
    app.use app.router 
```

我看到的输出：

```
serializing { loginStatus: 'SUCCESS',
  orgRoles: { '7': 'ALL' },
  orgNames: { '7': 'kianoshp@gmail.com' },
  loginId: 4,
  message: 'Success',
  success: true }
deserializing { loginStatus: 'SUCCESS',
  orgRoles: { '7': 'ALL' },
  orgNames: { '7': 'kianoshp@gmail.com' },
  loginId: 4,
  message: 'Success',
  success: true } 
```

我希望能够访问我放置在会话中的内容并从中获取值。例如，当我发出 GET 请求时，我希望能够执行以下操作：

```
app.get '/threatStatus', (res, req) ->
    #I would like to retrieve the loginId for the user that I placed in the session 
```

任何帮助是极大的赞赏！！

干杯，

基亚诺什

**更新：** 我可以通过以下调用获得所需的数据：

```
app.get '/threatStatus', (res, req) ->
    console.log req.req.user 
```

输出以下内容：

```
{ loginStatus: 'SUCCESS',
  orgRoles: { '7': 'ALL' },
  orgNames: { '7': 'kianoshp@gmail.com' },
  loginId: 4,
  message: 'Success',
  success: true } 
```

这引出了一个问题，这是正确的吗？我是否必须深入研究请求对象才能获取此数据？'req.req.user' 正确吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-11T22:37:01.473

用户对象应该通过`req.user`.

您可以验证用户是否已通过 via 登录`req.isAuthenticated()`以避免处理未定义的 req.user。

# iphone - iOS：对齐两个 UILabel（左/右）并用点连接？

> ID：14243898
> 
> 赞同：2
> 
> 时间：2013-01-09T18:23:22.700
> 
> 标签：iphone, ios, objective-c, ios6, uilabel

![在此处输入图像描述](../Images/464cc3bef40428d4ecaaea5386559de1.png)

上图取自 Android 应用程序。我希望在 iOS 上做同样的事情。我知道如何使用点的背景图像来做到这一点，但看起来 Android 开发人员并没有为点使用图像。任何人都知道如何做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2015-10-21T18:40:03.623

我找到了通过内容拥抱/压缩阻力来做到这一点的方法。这是界面构建器解决方案： [![用点填充的 UILabel](../Images/3544370872b08debbe151ebab9a982d3.png)](https://i.stack.imgur.com/k9upe.png)

左标签有一个短语和很多点，换行=截断尾巴。内容拥抱/抗压性完成剩下的工作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-09T18:36:43.730

我认为你可以在没有任何代码的情况下做到这一点。只需使用两个标签，它们的基线对齐，水平间距约束为 0。左侧标签的文本将左对齐，例如在字符串末尾添加 10 个点，并且换行模式设置为“剪辑”。右侧标签也将左对齐，因此其文本将始终与点对齐。

**编辑后：**我无法让它在 IB 中工作。在使用约束的代码中可能是可能的，但我没有尝试过。看起来你应该可以用 3 个标签来做，两个外部的标签固定在视图的边缘，中间有一个灵活的标签，其文本是点。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-09T18:25:30.047

你可以用`NSAttributedString`这种方式格式化。

在两个范围内使用两种颜色，甚至在第二部分使用粗体。

并计算总宽度（文本的长度）并在它们之间填充点 (.)。

填充点的想法：

假设您有 30 个字符的空间。

str1 包含 10，str2 包含 6，然后使用 30-(10+6) 然后循环

```
for(30-(10+6) times) {
    [mainString appendString:@"."]
} 
```

# mysql - 如何从 talend 中的 MySQL 中选择所有表中的所有字段

> ID：14243900
> 
> 赞同：0
> 
> 时间：2013-01-09T18:23:23.570
> 
> 标签：mysql, talend

我正在寻找一种在 talend 中选择完整 MySQL 数据库并将其用作生成 XML 的源的方法。

目前我正在尝试使用该`tMysqlInput`组件，但我只能选择单个表格。我有 10 多个表，我想用几个`tMap`. 所以我正在寻找一个组件或方法来一次性获取完整的数据库。

在此先感谢您的帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-10T10:13:10.307

我会说`tMysqlInput`每张桌子需要一个。这就是 Talend 的逻辑。

我建议你做什么：

1.  使用 Talend 检索所有表模式
2.  将创建的模式拖放到 Talend Designer 并选择`tMysqlInput`
3.  您新的`tMysqlInput`应该已经设置为使用相应的架构（存储库模式）
4.  如果您在设置中按“猜测查询” `tMysqlInput`，它将列出所有列

根据您要实现的目标，请查看`tMysqlTableList` [https://help.talend.com/display/TalendOpenStudioComponentsReferenceGuide521EN/7.65+tMysqlTableList](https://help.talend.com/display/TalendOpenStudioComponentsReferenceGuide521EN/7.65+tMysqlTableList)

**编辑**

Talend 可以直接在 tMap 组件中进行 JOIN。一个很好的例子可以在这里找到：http: [//techblog.appirio.com/2009/12/performing-lookups-and-transformations.html](http://techblog.appirio.com/2009/12/performing-lookups-and-transformations.html)

# ios - Apple 应用内购买收据验证

> ID：14243909
> 
> 赞同：2
> 
> 时间：2013-01-09T18:24:02.743
> 
> 标签：ios, security, in-app-purchase

客户端应用程序成功执行应用内购买并从 iTunes 接收收据。客户端然后将此收据发送到服务器，服务器与 Apple 进行验证，如果成功，则为客户端解锁一些内容。

是否可以在**IAP 购买请求**中插入额外数据，以便收据或收据验证包含此值？

![帮助解释的收据](../Images/62d6a21041d6ea04e25b62331ff622a3.png)

我试图防止*中间人/数据包嗅探*类型的黑客攻击，**即**如果有人要发现另一个人的收据并针对我的服务器进行验证，服务器如何知道该收据不是由这个，验证人？

在 Apple 的 IAP[文档](http://developer.apple.com/library/mac/#documentation/NetworkingInternet/Conceptual/StoreKitGuide/VerifyingStoreReceipts/VerifyingStoreReceipts.html#//apple_ref/doc/uid/TP40008267-CH104-SW1)中，验证响应中有许多值返回。我可以`version_external_identifier`使用价值吗？它有什么用途或价值？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-25T12:13:50.257

> `version_external_identifier` 唯一标识应用程序修订的任意数字。沙盒创建的收据中缺少此密钥。

这真的回答了你的问题；它是一种确定购买的应用程序版本的方法。您可以拥有相同的版本号，但可以有多个修订版，这允许该版本号和 IAP。

> 是否可以在 IAP 购买请求中插入额外数据，以便收据或收据验证包含此值？

最终，没有。Apple 可以控制收据及其内容。如果您遵循文档中的指南（有关更多信息以及您发布的链接，请参阅[此](http://developer.apple.com/library/ios/#releasenotes/StoreKit/IAP_ReceiptValidation/_index.html)内容），您可以对抗中间人攻击（Apple 会考虑这一点）。确保与您的服务器和 Apple 的连接是 HTTPS。

无论如何，中间的人代表某人进行购买是没有实际意义的；购买请求与 Apple ID 相关联，这意味着中间人需要知道他们的凭据。

# c# - 如何从 C# 运行 doxygen 并通过标准输入传递配置？

> ID：14243911
> 
> 赞同：0
> 
> 时间：2013-01-09T18:24:31.127
> 
> 标签：c#, visual-studio-2005, doxygen

Doxygen 提供了一种通过标准输入传递 .doxy 文件内容的方法，而不是传递文件名，但我不知道如何从 C# 中做到这一点。

为简单起见，假设我的 doxygen 配置文件的内容只是存储在其中，`string[] lines`因此我想执行 doxygen.exe 并输入此内容。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-11T11:39:54.013

我从评论中提到的链接中得到了这个工作，类似于：

```
// Prepare the process to run
    ProcessStartInfo start = new ProcessStartInfo();
    // Enter in the command line arguments, everything you would enter after the executable name itself
    start.Arguments = " -";
    // Enter the executable to run, including the complete path
    start.FileName = "doxygen.exe";
    // Do you want to show a console window?
    start.WindowStyle = ProcessWindowStyle.Normal;
    start.CreateNoWindow = false;
    start.RedirectStandardInput = true;
    start.UseShellExecute = false;

    // Run the external process & wait for it to finish
    using (Process proc = Process.Start(start))
    {
        //doxygenProperties is just a dictionary
        foreach (string key in doxygenProperties.Keys)
            proc.StandardInput.WriteLine(key+" = "+doxygenProperties[key]);
        proc.StandardInput.Close();
        proc.WaitForExit();

        // Retrieve the app's exit code
        int exitCode = proc.ExitCode;
    } 
```

# sql - Hive 中 SQL Server UPDATE 命令的最佳等效项

> ID：14243913
> 
> 赞同：1
> 
> 时间：2013-01-09T18:24:39.563
> 
> 标签：sql, sql-server, hadoop, hive

什么是 SQL Server`UPDATE SET`命令的最佳（较便宜）等价物`Hive`？

例如，考虑我要转换以下查询的情况：

```
UPDATE TABLE employee 
SET visaEligibility = 'YES' 
WHERE experienceMonths > 36 
```

到等效`Hive`查询。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-09T19:04:02.347

我假设您有一个没有分区的表，在这种情况下您应该能够执行以下命令：

```
INSERT OVERWRITE TABLE employee SELECT employeeId,employeeName, experienceMonths ,salary, CASE WHEN experienceMonths >=36 THEN ‘YES’ ELSE visaEligibility END AS visaEligibility FROM employee; 
```

还有其他方法，但它们更加复杂，我认为 Bejoy 描述的方式是最有效的。

（来源：[Bejoy KS 博客](http://kickstarthadoop.blogspot.com/2011/06/implementing-basic-sql-update-statement.html)）

请注意，如果您必须在分区表上执行此操作（如果您有很多数据，这很可能），您可能需要在执行此操作时覆盖您的分区。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-09-19T13:13:55.777

您可以创建一个外部表并使用“插入覆盖到本地目录”，如果要更改列值，可以使用“CASE WHEN”、“IF”或其他条件操作。并将输出文件复制回 HDFS 位置。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-11-25T09:17:35.547

您可以将配置单元升级到 0.14.0

从 0.14.0 hive 开始支持 UPDATE 操作。

为此，我们需要创建 hive 表以使其支持**ACID**输出格式，并且需要在**hive-site.xml中设置***其他*属性。

 **[如何在 Hive 中进行 CURD 操作](http://unmeshasreeveni.blogspot.in/2014/11/updatedeleteinsert-in-hive-0140.html)**

# asp.net - 在 Asp.Net MVC 3 应用程序中创建新项目时出现 SqlException

> ID：14243914
> 
> 赞同：0
> 
> 时间：2013-01-09T18:24:51.997
> 
> 标签：asp.net, asp.net-mvc, database, asp.net-mvc-3, web-config

在我的“网上商店”mvc 应用程序中，我想将项目添加到数据库中。Items 表有 CreatedBy 字段，它是来自 User 表 UserId 字段的外键。在我将数据库放入 App_Data 文件夹之前，一切正常。现在我在尝试创建新项目时收到 SqlException：

> INSERT 语句与 FOREIGN KEY 约束“FK_Item_contains_User”冲突。冲突发生在数据库“C:\USERS\ALEKSEY\REPOS\2\WEBSTORE\WEBSTORE\APP_DATA\WEBSTORE.MDF”、表“dbo.Users”、列“UserId”中。

这是 ItemRepository 类的 Create 方法：

```
public Item CreateItem(int productId, Guid userId)
    {
        var item = new Item
            {
                ProductId = productId,
                CreatedBy = userId,
            };
        _dataContext.Items.InsertOnSubmit(item);
        _dataContext.SubmitChanges(); // in this line the exception occures !
        return item;
    } 
```

这是控制器方法 Create：

```
 [HttpGet]
    public ViewResult Create()
    {
        var p = _productRepository.CreateProduct("", "", 0, "", "", "");
        var userId = (Guid)Membership.GetUser().ProviderUserKey;
        var item = _itemsRepository.CreateItem(p.ProductId, userId);

        // some code
        return View(model);
    } 
```

此外，我使用 Linq to Sql 模型拖放方法。
这是更改后的 web.config 连接字符串部分：

```
<connectionStrings>
<add name="WebStoreConnectionString" connectionString="Data Source=(LocalDB)\v11.0;
     AttachDbFilename=|DataDirectory|\WebStore.mdf;Integrated Security=True;Connect Timeout=30" 
    providerName="System.Data.SqlClient" />

<add name="DefaultConnection" connectionString="Data Source=|DataDirectory|\aspnet.sdf" 
     providerName="System.Data.SqlServerCe.4.0" /> 
```

正如我所说，在我将数据库移动到 App_Data 文件之前一切正常。我还尝试删除 Items 和 Users 表之间的依赖关系——完全相同的例外。

任何帮助都是合适的。提前致谢！

**编辑：**

好的，现在我真的打破了 Items 和 Users 表之间的依赖关系，并且没有发生异常。但！我必须以某种方式知道谁创建了每个产品，因此打破依赖关系不是一种选择。我还尝试删除所有初始化 CreatedBy 字段的代码。

有任何想法吗？？

**编辑（第 2 部分）：**

下面的第二条评论给出了一个很好的建议！我发现所有创建的用户现在都存储在 aspnet.sdf 数据库中！！！
但是如果我删除连接字符串“DeafaultConnection”：

```
<add name="DefaultConnection" connectionString="Data Source=|DataDirectory|\aspnet.sdf"
  providerName="System.Data.SqlServerCe.4.0" /> 
```

我会得到 ConfigurationErrorsException：

```
"The connection name 'DefaultConnection' was not found in the applications 
configuration or the connection string is empty." 
```

在以下行中：

```
 var userId = (Guid)Membership.GetUser().ProviderUserKey; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-09T20:24:28.960

好的，正如我猜测的那样，问题出在配置中。连接字符串中的每个提供者（出于某种原因）都有“DefaultConnection”。我将其更改为“WebStoreConnectionString”。现在一切正常！

ps 谢谢@w0lf，他把想法推向了正确的方向）

# hibernate - NamedQuery 和内部连接关联

> ID：14243921
> 
> 赞同：0
> 
> 时间：2013-01-09T18:25:12.530
> 
> 标签：hibernate, hql

我想使用内部连接关联来连接一个表，但我不知道如何用 HQL 语法编写它。

我想用 HQL 语法写这个“select * from persona p inner join trabajador t on t.id_persona=p.id”。我想把这句话放在命名查询中。

我非常感谢任何帮助！

* * *

## 回答 #1

> 赞同：-2
> 
> 时间：2013-01-09T20:21:41.647

```
select p from Persona p inner join p.trabajador t 
```

[这是文档](http://docs.jboss.org/hibernate/core/3.6/reference/en-US/html_single/#queryhql-joins)中涵盖的基本内容。阅读。

# java - Java XOR 两个数组

> ID：14243922
> 
> 赞同：14
> 
> 时间：2013-01-09T18:25:22.283
> 
> 标签：java, arrays, matrix

我必须对两个数组应用异或，比如假设我有：

```
array_1: 1 0 1 0 1 1
array_2: 1 0 0 1 0 1 
```

我想要一个函数，它接受两个数组并返回一个应用 XOR 的数组，所以在这种情况下，我希望这个函数返回：

```
returned_array: 0 0 1 1 1 0 
```

请帮我一个算法..谢谢！

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2013-01-09T18:30:18.797

如果您将这些数字存储在字节数组中，请使用以下简单的解决方案：

```
byte[] array_1 = new byte[] { 1, 0, 1, 0, 1, 1 };
byte[] array_2 = new byte[] { 1, 0, 0, 1, 0, 1 };

byte[] array_3 = new byte[6];

int i = 0;
for (byte b : array_1)
    array_3[i] = b ^ array_2[i++]; 
```

**输出数组：**

```
0 0 1 1 1 0 
```

* * *

## 回答 #2

> 赞同：-3
> 
> 时间：2013-01-09T18:34:54.110

这会是一个很好的解决方案吗？（感谢你给我的东西，我写了这篇文章）

```
if(array1.length==array2.length){
  for(int i=0;i<array1.length;i++){

    output.add(logicalXOR(array1.get(i),array2.get(i)))

  }
} 
```

当然 array1,2 和输出将是 arrayLists

# java - 使用链接的哈希映射删除选定的项目

> ID：14243923
> 
> 赞同：0
> 
> 时间：2013-01-09T18:25:22.550
> 
> 标签：java, linkedhashmap

我有一个购物篮，其中添加了产品，每个产品都有一个删除按钮：

![例子](../Images/2538e11a28588aff11f092d2dd92c4d1.png)

每当我单击底部按钮时，它会删除底部产品，问题是它还会在单击顶部按钮时删除最后一个项目，直到数量为 0 并且该项目消失时，它会删除底部的第二个项目（在这种情况下第一项）

这是我的篮子类代码：

```
package model;

import java.util.ArrayList;
import java.util.Collections;
import java.util.LinkedHashMap;
import java.util.LinkedList;
import java.util.List;
import java.util.Map;
import java.util.Map.Entry;
import java.util.Observable;
import main.WinkelApplication;
import view.Payment;

public class Basket extends Observable {

    private final Map<Product, Integer> products;

    public Basket() {
        super();
        products = new LinkedHashMap<Product, Integer>(); //Map zorgt ervoor dat keys??? aan values word gebonden (dit is een soort van variabele[i], i staat voor de key
    }

    public void addProduct(Product product) {
        // check if product is allready added to the basket
        if (products.containsKey(product)) {
            products.put(product, products.get(product) + 1);

        } else {
            products.put(product, 1); 
        }
        setChanged();
        notifyObservers();
    }

    public void deleteProduct(Product product) {
        // check if product is allready added to the basket
        int i = WinkelApplication.getBasket().getProductAmount(product);
        int id = product.getProductId();

        if (WinkelApplication.getBasket().getProductAmount(product) == 1) {

            products.remove(product);
            WinkelApplication.getInstance().showPanel(new view.Payment());

        }else{
            i--;
            products.put(product, i);
            WinkelApplication.getInstance().showPanel(new view.Payment());
        }

        if (products.size() == 0) {
            WinkelApplication.getInstance().showPanel(new view.CategoryList());
        }
    }

    public void empty() {
        products.clear();
        setChanged();
        notifyObservers();
    }

    public List<Product> getProducts() {
        List<Product> list = new LinkedList<Product>(products.keySet());
        return list;
    }

    public int getProductAmount(Product product) {
        return products.get(product);
    }

    public int size() {
        return products.size();
    }

    public double getTotalCosts() {
        double total = 0.0;
        for (Entry<Product, Integer> entry : products.entrySet()) {  //gaat de lijst van producten af in basket, en doet de prijs bij totaal * het hoeveelheid van zo'n product
            total += entry.getKey().getPrice() * entry.getValue();
        }
        return total;
    }
} 
```

正如在 deleteProduct 方法中看到的那样，我做了 products.remove(product) 所以我假设它然后取最后一个项目，如果我系统出它显示我的哈希映射： {Cars=2, Dames onderbroek=1} （根据图片以上）。如何确保它删除选定的一个而不是列表中的最后一个？

产品类别：

```
package model;

public class Product {

    private int productId;
    private int categorieId;
    private String name;
    private String description;
    private double price;

    public Product() {
        this(-1, -1, "", "", 0.0);
    }

    public Product(int product_id, int categorie_id, String name, String description, double price) {
        this.productId = product_id;
        this.categorieId = categorie_id;
        this.name = name;
        this.description = description;
        this.price = price;
    }

    /**
     * @return the productId
     */
    public int getProductId() {
        return productId;
    }

    /**
     * @param productId the productId to set
     */
    public void setProductId(int productId) {
        this.productId = productId;
    }

    /**
     * @return the name
     */
    public String getName() {
        return name;
    }

    /**
     * @param name the name to set
     */
    public void setName(String name) {
        this.name = name;
    }

    /**
     * @return the description
     */
    public String getDescription() {
        return description;
    }

    /**
     * @param description the description to set
     */
    public void setDescription(String description) {
        this.description = description;
    }

    /**
     * @return the price
     */
    public double getPrice() {
        return price;
    }

    /**
     * @param price the price to set
     */
    public void setPrice(double price) {
        this.price = price;
    }

    /**
     * @return the categorieId
     */
    public int getCategorieId() {
        return categorieId;
    }

    /**
     * @param categorieId the categorieId to set
     */
    public void setCategorieId(int categorieId) {
        this.categorieId = categorieId;
    }

    @Override
    public String toString() {
        return name;
    }

    @Override
    public boolean equals(Object obj) {
        boolean value;
        if (obj instanceof Product) {
            value = this.productId == ((Product)obj).productId; //VB: product1 (met ID 1) past deze methode toe, en geeft product2 als parameter: deze method geeft dan false terug.
        } else {
            value = super.equals(obj);  //van wat is Product een subclass van? en wat heeft dit voor nut?
        }
        return value;
    }

    @Override
    public int hashCode() {   //wth is dit?
        return 13 * 3 + this.productId;
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-09T18:34:46.883

不幸的是，您还没有向我们发送课程，`Product`但我可以假设您尚未实施此类课程。`hashCode()``equals()`

简短的回答 - 这样做，你的逻辑就会奏效。

更长的答案是哈希机制使用这些方法来识别您的对象。默认情况下`hashCode()`返回java堆中的“地址”，因此`Product`即使它们的所有字段都相等，两个不同的实例也是不同的。请注意，如果`equals()`返回 true`hashCode()`必须为两个对象返回相等的值。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-09T19:14:53.943

`WinkelApplication.getBasket()`也许再送一个篮子？

不是答案，但当产品不在`products`.

```
public int getProductAmount(Product product) {
    Integer i = products.get(product);
    return i == null ? 0 : i.intValue();
} 
```

# google-apps-script - 复制工作表中的列以添加到带有 GAS 的“归档”工作表中的最后一列

> ID：14243928
> 
> 赞同：0
> 
> 时间：2013-01-09T18:25:34.513
> 
> 标签：google-apps-script, google-sheets

对不起我的英语不好。^^

呃，我找到了一个脚本，可以从一张表复制到另一张表。我的问题是：它的副本与行。我想在脚本运行时复制列并将 2 列添加到 lastcolumn。

这成了一个问题，因为列没有通知。A=1, B=2 等等 copyTo 想要 A1notification。

这是我的脚本：

```
function Archiv() {

var ss = SpreadsheetApp.getActiveSpreadsheet();
var target = SpreadsheetApp.openById("sheetid");
var source_sheet = ss.getSheetByName("sheetname");
var target_sheet = target.getSheetByName("sheetnametarget");
var source_range = source_sheet.getRange("D4:E89");
var last_col = target_sheet.getLastColumn();
target_sheet.insertColumnAfter(last_col);
var target_range = target_sheet.getRange(">>>>(lastcol+1)<<<<4:>>>>>(lastcol+2)<<<<89");
source_range.copyTo(target_range, {contentsOnly:true});
} 
```

该脚本必须每周一运行以存档 2 列的内容。我希望你能理解我的愿望。我已经测试了很多东西，但没有任何帮助。:(

提前谢谢了。

塞巴斯蒂安

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-09T19:40:14.853

您可以使用另一种范围选择模式，这将使事情变得非常简单，请参阅[此文档](https://developers.google.com/apps-script/class_sheet?hl=fr-FR#getRange)，使用整数作为行号和列号。

您的代码可能会变成这样：

```
function Archiv() {
  var ss = SpreadsheetApp.getActiveSpreadsheet();
  var target = SpreadsheetApp.openById("sheetid");
  var source_sheet = ss.getSheetByName("sheetname");
  var target_sheet = target.getSheetByName("sheetnametarget");
  var source_range = source_sheet.getRange("D4:E89");
  var last_col = target_sheet.getLastColumn();
  while(target_sheet.getMaxColumns()<=last_col+2){// add columns only if necessary
  target_sheet.insertColumnAfter(last_col)}
  var source_values = source_range.getValues();
  var target_range = target_sheet.getRange(4,last_col+1,source_values.length,2);// row Nr4, starting on last column+1, 2 columns width and 89-4 rows heigth
  target_range.setValues(source_values);
} 
```

我使用`getValues()`而`setValues()`不是`copyTo()`返回错误：*目标和源必须在同一个电子表格中*

# .htaccess - MODX：我添加了一个资源页面，现在我所有的链接都坏了

> ID：14243931
> 
> 赞同：0
> 
> 时间：2013-01-09T18:26:02.483
> 
> 标签：.htaccess, friendly-url, modx

一位客户希望我在他的 Modx 网站上添加一个页面。我只是一个 Joomla/Wordpress 人，但我想我会尝试一下。

这是我的步骤：

我单击“新文档”，给页面一个模板、一个名称、一个父级，然后粘贴一些虚拟文本并点击保存。

现在，我所有的链接都是这样的：[http ://www.myurl.com/modx/contact.html](http://www.myurl.com/modx/contact.html)

*编辑：实际上这就是他们应该如何看待谷歌。他们只是不再链接到该页面。*

我的博客链接仍然是这样的：[http](http://www.myurl.com/blog) ://www.myurl.com/blog （它是页面上唯一有效的链接）

在任何情况下我都无法删除我创建的资源。Modx 只是用红色划掉了它，并且没有永久删除它的选项，我可以找到。

*编辑：解决了那部分... :)*

感谢您的帮助，我正在尝试在客户意识到它已损坏之前解决此问题。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-09T19:06:15.637

你在头部指定`base`了标签？像这样：`<base href="http://www.myurl.com/modx/" >`。要完全删除您需要按顶部资源面板树上的垃圾桶图标的资源。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-09T23:23:36.287

摆脱资源组分配解决了问题，该站点现在可以再次完全访问。

# java - 使用 writeSelectedRows 的 iText PDF 表错误

> ID：14243937
> 
> 赞同：-1
> 
> 时间：2013-01-09T18:26:35.823
> 
> 标签：java, pdf, itext

我有下一个错误。我正在尝试使用 iText 创建具有特定格式的 PDF。我选择为页面的每个部分使用表格，因为我需要做的格式有表格。好吧，我已经做了所有事情，我创建了表格并使用`doc.add(table)`方法添加它，这很好，但我需要将表格设置到特定位置。所以我选择使用`table.writeSelectedRows()`方法，这很好用。

错误来了，这是我的代码：

```
table_SectionTwo.addCell(cell_White);
                table_SectionTwo.addCell(cell_White);
                table_SectionTwo.addCell(p);
                table_SectionTwo.addCell(cell_OrderDate);   
                table_SectionTwo.addCell(cell_CustomerOrderDate);
                table_SectionTwo.addCell(cell_OrderNumberSection);                                                              

    float[] columnWidths = new float[] {38f, 105f, 90f};
                    table_SectionTwo.setTotalWidth(columnWidths);
                    table_SectionTwo.setLockedWidth(true);
                    table_SectionTwo.completeRow();                 
                    table_SectionTwo.writeSelectedRows(0, -1, 260f, 770f, super.getPdfWriter().getDirectContent());                     
                    doc.add(table_SectionTwo); 
```

如您所见，如果我执行此代码，这将添加同一个表 2 次

问题是当我删除 doc.add(table) 时，我这样做只是为了使用`table.writeSelectedRows()`. 这就是我的代码的保留方式：

```
table_SectionTwo.writeSelectedRows(0, -1, 260f, 770f, super.getPdfWriter().getDirectContent());                     
//super.addTable(table_SectionTwo); 
```

我评论了`doc.add(table)`。这应该只写一个表。但这不起作用。当我这样做时会抛出：

```
ExceptionConverter: java.io.IOException: The document has no pages.
    at com.itextpdf.text.pdf.PdfPages.writePageTree(PdfPages.java:113)
    at com.itextpdf.text.pdf.PdfWriter.close(PdfWriter.java:1217)
    at com.itextpdf.text.pdf.PdfDocument.close(PdfDocument.java:777)
    at com.itextpdf.text.Document.close(Document.java:398)
    at PDFConstructor.CloseDocument(PDFConstructor.java:85)
    at InvoicePDF.CloseDocument(InvoicePDF.java:58)
    at Demo.main(Demo.java:72) 
```

奇怪的是，当我评论 `doc.add(table)`这不起作用时，当我评论`table.writeSelectedRows()`作品`doc.add(table)`正常时。仅当我已`doc.add(table)`评论和`table.writeSelectedRows()`取消评论时才会出现此错误。

请帮我..

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-12T17:30:32.037

我从您的问题中了解到您想在指定位置写入特定行来记录文档。如果这是正确的 super.getPdfWriter().getDirectContent()) 是必要的吗？我不这么认为。分析这部分我需要您的整个代码片段或此代码的演示版本，它们解释相同。

第二：在内部 itext 也使用 PdfContentByte 使用 PdfPRow 编写 PdfPTable 并且还记得根据作者（Bruno）itext 是建立在 Builder 模式上的。如果前面的行对你没有意义，请跳过它。

您当前甚至在设置所有必需属性之前就将内容添加到表中。

```
table_SectionTwo.addCell(cell_White);
table_SectionTwo.addCell(cell_White);
table_SectionTwo.addCell(p);
table_SectionTwo.addCell(cell_OrderDate);   
table_SectionTwo.addCell(cell_CustomerOrderDate);
table_SectionTwo.addCell(cell_OrderNumberSection); 
```

会是这样的

```
float[] columnWidths = new float[] {38f, 105f, 90f};
PdfPTable table_SectionTwo= new PdfPTable(clmnWdthTpHdr);
table_SectionTwo.setTotalWidth(500.0f);
table_SectionTwo.setWidthPercentage(100.0f);
table_SectionTwo.setLockedWidth(true); 
```

3.不要使用 super.getPdfWriter().getDirectContent())。因为上面的代码告诉我你正在使用文档，所以我认为你也必须编写以下代码片段（像这样：lol）

```
PdfWriter pdfWrtr=null;
ByteArrayOutputStream baos = new ByteArrayOutputStream();
Document doc= new Document(UtilConstant.pageSizePdf,0,0,0,0);
pdfWrtr=PdfWriter.getInstance(doc,baos); 
```

在 try catch 中使用 pdfWrtr.getDirectContent(); 反而。这些都是基于我的代码分析。例外的另一点

```
ExceptionConverter: java.io.IOException: The document has no pages.
    at com.itextpdf.text.pdf.PdfPages.writePageTree(PdfPages.java:113)
...............................
 at InvoicePDF.CloseDocument(InvoicePDF.java:58)
    at Demo.main(Demo.java:72) 
```

这是一个典型的错误，当没有任何内容添加到文档中时。可能在第 4 步中抛出（并忽略）异常（根据 Itext in Action）并且可能您正在执行第 5 步（document.close()）（尽管步骤4）中的异常。所以如果以上内容不够清楚，请附上Demo.java以帮助您。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-10T08:09:05.577

尽管您在问题中没有提供足够的信息，但我认为问题是由于您没有定义表格的宽度造成的。

做这个测试：询问桌子的总高度。如果 iText 返回 0，那么您忘记定义表格的宽度；如果它不返回 0，那么 iText 知道宽度是因为您明确定义了它，或者因为您使用了 document.add(table)，它根据文档对象的页面度量计算了表格的尺寸。

如果还有其他事情在起作用，您将不得不提供更多信息。

# delphi - 在构建时更改版本号

> ID：14243942
> 
> 赞同：7
> 
> 时间：2013-01-09T18:26:49.760
> 
> 标签：delphi, ide, version

作为构建脚本的一部分，我需要将我的 delphi 项目的版本设置为与另一个项目（不是 delphi）相同。有没有办法在不通过 IDE 的情况下控制版本号，例如编译器的命令行参数或类似的东西？谢谢

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2013-01-09T19:10:49.600

包括一行

```
{$R 'version.res'} 
```

在你的项目中。并使用您的版本信息创建一个 version.rc 文件。您必须使用 brcc32 在较旧的 Delphi 版本中自己构建资源。在较新的 Delphi 版本中，您可以使用

```
{$R 'version.res' 'version.rc'} 
```

让 IDE 自动为您构建它。

最简单的 version.rc 看起来像：

```
1 VERSIONINFO
FILEVERSION 9999, 9999, 99, 18048
PRODUCTVERSION 9999, 9999, 99, 18048
FILEOS 0x00000004L // comment: VOS_WINDOWS32
FILETYPE VFT_APP
{
 BLOCK "VarFileInfo"
 {
  VALUE "Translation", 0x409, 0x4E4 // comment: 0x4E4 = 1252
 }

 BLOCK "StringFileInfo"
 {
  BLOCK "040904E4"
  {
   VALUE "CompanyName", "Company Name\0"
   VALUE "FileVersion", "9999.9999.99.18048\0"
   VALUE "LegalCopyright", "Copyright \0"
   VALUE "ProductName", "Product Name\0"
   VALUE "ProductVersion", "9999.9999.99.18048\0"
   VALUE "Homepage", "http://www.mydomain.com\0"
  }
 }
} 
```

有关详细信息，请参阅 MSDN 上的[VERSIONINFO](http://msdn.microsoft.com/en-us/library/windows/desktop/aa381058%28v=vs.85%29.aspx)结构。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-10T15:02:55.897

Marjan 在上面给出了一个很好的答案，但我的答案更进一步。考虑这个 RC 文件：

```
VS_VERSION_INFO VERSIONINFO

#include "..\Ver_Num_Application.txt"
#define APPLICATION_NAME    "My amazing project\0"
#define VER_NUM_ARTWORKS    4
#include "..\Libraries\Paslib32\Ver_Num_Library.txt"
#define COMPANY_NAME        "My company\0"

FILEVERSION    VER_NUM_ARTWORKS, VER_NUM_LIBRARY, VER_NUM_APPLICATION, 1000
 FILEFLAGSMASK 0x3fL
#ifdef _DEBUG
 FILEFLAGS 0x9L
#else
 FILEFLAGS 0x8L
#endif
 FILEOS 0x4L
 FILETYPE 0x1L
 FILESUBTYPE 0x0L
BEGIN
    BLOCK "StringFileInfo"
    BEGIN
        BLOCK "040904b0"
        BEGIN
            VALUE "CompanyName", COMPANY_NAME
            VALUE "FileDescription", APPLICATION_NAME
            VALUE "LegalCopyright", "Copyright (C) "COMPANY_NAME
            VALUE "ProductName", APPLICATION_NAME
        END
    END 
    BLOCK "VarFileInfo" 
    BEGIN 
        VALUE "Translation", 0x409, 1200
    END 
END 
```

使用几个 #INCLUDE 语句的好处是您可以不理会 RC 文件，然后简单地修改（甚至自动生成）*.txt 包含文件，如下所示：

```
Ver_Num_Application.txt:
  #define VER_NUM_APPLICATION 6

Ver_Num_Library.txt:
  #define VER_NUM_LIBRARY 156 
```

请注意，现在您必须在运行构建之前删除 *.res 文件，以强制链接器从（可能已更改）版本号重新生成它们。

# ios - NSLayoutConstraint 并将两个标签“附加”到彼此

> ID：14243943
> 
> 赞同：4
> 
> 时间：2013-01-09T18:26:53.043
> 
> 标签：ios, objective-c, nslayoutconstraint

我有两个标签。如果一个被移动，我希望能够同时移动两者。我如何将它们与 NSLayoutConstraints “附加”在一起？我可以在 IB 中做到这一点，但需要在代码中做到这一点。

另外，什么是 NSLayoutAttributeBaseline、NSLayoutAttributeLeading 和 NSLayoutAttributeTrailing？

编辑：

居中poweredByLabel（又名label02）：

```
[constraints addObject:[NSLayoutConstraint constraintWithItem:poweredByLabel
                                                    attribute:NSLayoutAttributeCenterX
                                                    relatedBy:NSLayoutRelationEqual
                                                       toItem:myImage
                                                    attribute:NSLayoutAttributeCenterX
                                                   multiplier:1.0
                                                     constant:0]]; 
```

堆叠标签并垂直切换：

```
[constraints addObjectsFromArray:[NSLayoutConstraint constraintsWithVisualFormat:@"V:[rememberPasswordSwitch]-10-[rememberPasswordLabel]-10-[versionLabel]-[poweredByLabel]-|"
                                                                         options:NSLayoutFormatAlignAllBaseline
                                                                         metrics:nil
                                                                           views:viewsDictionary]]; 
```

这会产生错误：

> ***由于未捕获的异常“NSInvalidArgumentException”而终止应用程序，原因：“无法解析约束格式：选项掩码需要在垂直边缘对齐的视图，这对于也是垂直的布局是不允许的。五：[rememberPasswordSwitch]-10-[rememberPasswordLabel]-10-[versionLabel]-[poweredByLabel]-|............ ..................................................... ....................^'

没有 NSLayoutFormatAlignAllBaseline 选项，它运行良好（它们堆叠但并非全部水平居中）。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-09T19:36:39.890

如果您需要在代码中执行此操作，请首先创建 NSLayoutConstraint(s)，然后将约束添加到标签的超级视图。

有两种方法可以在代码中创建约束。`constraintsWithVisualFormat`通常比 . 简洁得多`constraintWithItem`。

```
// Make label1's NSLayoutAttributeTrailing be the 'standard Aqua space' away from label2's NSLayoutAttributeLeading. Also, vertically align their baselines.
NSArray* constraints = [NSLayoutConstraint constraintsWithVisualFormat:@"H:[label1]-[label2]"  options:NSLayoutFormatAlignAllBaseline  metrics:nil  views:NSDictionaryOfVariableBindings(label1, label2) ] ; 
```

然后将约束添加到标签的超级视图：

```
[label1.superview  addConstraints:constraints] ;   // Use `label1.superview` or your own reference to the label's superview. 
```

[Cocoa 自动布局指南](https://developer.apple.com/library/mac/documentation/UserExperience/Conceptual/AutolayoutPG/Articles/Introduction.html#//apple_ref/doc/uid/TP40010853)简短易懂。读一读，我很乐意回答您仍有的任何问题。

*编辑 1*

该选项`NSLayoutFormatAlignAllBaseline`创建垂直对齐所有指定对象的基线的约束（除了由 VisualFormat 字符串创建的约束）。如果您的 VisualFormat 字符串正在创建垂直约束（它以“V:”开头），您不想使用此选项。您可能想使用 0（这意味着没有选项）或创建水平约束的选项，例如 NSLayoutFormatAlignAllCenterX。

# c - 这个 C 函数返回什么？

> ID：14243944
> 
> 赞同：-1
> 
> 时间：2013-01-09T18:26:53.727
> 
> 标签：c, function, return

```
int f(int n)
{
    int i, c = 0;
    for (i=0; i < sizeof(int)*8; i++, n >>= 1)
        c = (n & 0x01)? c+1: c;
    return c;
} 
```

这是我在书上找到的一个练习，但我真的不明白！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-09T18:35:13.120

它计算传入参数中设置的位数`n`（假设您的机器有 8 位字节）。我将在您的代码中内联注释（并修复糟糕的格式）：

```
int f(int n)
{
    int i;     // loop counter
    int c = 0; // initial count of set bits is 0

    // loop for sizeof(int) * 8 bits (probably 32), 
    // downshifting n by one each time through the loop
    for (i = 0; i < sizeof(int) * 8; i++, n >>= 1) 
    {
        // if the current LSB of 'n' is set, increment the counter 'c',
        // otherwise leave it the same
        c = (n & 0x01) ? (c + 1) : c;  
    }

    return c;  // return total number of set bits in parameter 'n'
} 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-01-09T18:30:13.030

它正在按位进行 - 打开位并关闭位。

# c# - 带有存储过程的代码优先实体框架，从复杂的全文搜索返回结果

> ID：14243946
> 
> 赞同：16
> 
> 时间：2013-01-09T18:26:57.370
> 
> 标签：c#, entity-framework, stored-procedures, full-text-search

我正在寻找以下场景的设计建议：

我有一个代码优先的 EF5 MVC 应用程序。我正在构建一个全文搜索功能，它将包含来自许多表的多个加权列。由于我无法使用这些表中的索引创建视图（其中一些包含文本/二进制列），因此我创建了一个存储过程，它将输出我的对象的 ID（例如`PersonID`）以及与该对象关联的排名搜索词。

我目前的方法是创建一个辅助类来执行全文搜索，该类调用存储过程并根据返回的 ID 从上下文中加载所有对象。

我的问题是：

1.  我的方法是否合理/遵循合理的最佳实践？
2.  有没有其他人在吸取任何教训后做过类似的事情？
3.  有没有办法更有效地做到这一点（即存储过程的结果直接返回/映射到实体而不需要额外的查找？）

**更新**

将我的详细实现从问题的编辑移到自己的答案中，以更符合经常推荐的内容@meta.stackexchange.com

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2013-01-09T22:17:39.103

1.  看到你不能首先使用包含实体框架代码的 SQL 方法，你的应用程序的其余部分可能会使用它，你可能会“被迫”用你描述的存储过程做一些事情。我不知道这是否是最佳实践。但是它完成了工作，我不明白为什么它不明智。
2.  是的 - 我已经并且仍在研究围绕 EF codefirst 构建的项目，在该项目中我必须进行相当复杂的搜索，其中包括几个标记为“必须拥有”的搜索参数和几个标记为“很好拥有”的值，并且来自该返回加权结果。
3.  根据结果​​集的复杂性，我认为您不需要对数据库进行第二次往返，我将在下面向您展示我一直在做的方式。

请记住，以下只是一个示例：

```
 public List<Person> GetPeople(params string[] p)
    {
        var people = new List<Person>();

        using (var db = new DataContext())
        {
            var context = ((IObjectContextAdapter)db).ObjectContext;

            db.Database.Connection.Open();

            var command = db.Database.Connection.CreateCommand();
            command.CommandText = "SomeStoredProcedureReturningWeightedResultSetOfPeople";
            command.CommandType = System.Data.CommandType.StoredProcedure;

            //Add parameters to command object

            people = context.Translate<Person>(command.ExecuteReader()).ToList();
        }

        return people;
    } 
```

即使存储过程将有一个权重值列，当您翻译它时它也不会被映射。如果需要，您可能会从 Person 派生一个包含权重值的类。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2014-02-19T22:55:41.183

将其发布为答案而不是对我的问题的编辑：

在这里获取@Drauka（和谷歌）提供的一些见解是我为我的初始迭代所做的。

1.  创建了存储过程来进行全文搜索。即使支持，在 EF 中完成也确实太复杂了（作为一个示例，我的一些实体通过业务逻辑相关，我想将它们分组为单个结果返回）。存储过程映射到具有实体 id 和 Rank 的 DTO。
2.  我修改了这个博主的片段/代码来调用存储过程，并填充我的 DTO：[http ://www.lucbos.net/2012/03/calling-stored-procedure-with-entity.html](http://www.lucbos.net/2012/03/calling-stored-procedure-with-entity.html)
3.  我用存储过程的结果中的总计和分页信息填充我的结果对象，然后只加载当前结果页面的实体：

    ```
    int[] projectIDs = new int[Settings.Default.ResultsPerPage];
    foreach (ProjectFTS_DTO dto in 
              RankedSearchResults
              .Skip(Settings.Default.ResultsPerPage * (pageNum - 1))
              .Take(Settings.Default.ResultsPerPage)) {
                 projectIDs[index] = dto.ProjectID;
                 index++;
            }

    IEnumerable<Project> projects = _repository.Projects
                .Where(o=>projectIDs.Contains(o.ProjectID)); 
    ```

**全面实施**：

由于这个问题收到了很多意见，我认为可能值得发布我的最终解决方案的更多细节以供其他人帮助或可能的改进。

完整的解决方案如下所示：

数据库扩展类：

```
public static class DatabaseExtensions {
    public static IEnumerable<TResult> ExecuteStoredProcedure<TResult>(
             this Database database, 
             IStoredProcedure<TResult> procedure, 
             string spName) {
        var parameters = CreateSqlParametersFromProperties(procedure);
        var format = CreateSPCommand<TResult>(parameters, spName);
        return database.SqlQuery<TResult>(format, parameters.Cast<object>().ToArray());
    }

    private static List<SqlParameter> CreateSqlParametersFromProperties<TResult>
             (IStoredProcedure<TResult> procedure) {
        var procedureType = procedure.GetType();
        var propertiesOfProcedure = procedureType.GetProperties(BindingFlags.Public | BindingFlags.Instance);

        var parameters =
            propertiesOfProcedure.Select(propertyInfo => new SqlParameter(
                    string.Format("@{0}", 
                    (object) propertyInfo.Name), 
                    propertyInfo.GetValue(procedure, new object[] {})))
                .ToList();
        return parameters;
    }

    private static string CreateSPCommand<TResult>(List<SqlParameter> parameters, string spName)
    {
        var name = typeof(TResult).Name;
        string queryString = string.Format("{0}", spName);
        parameters.ForEach(x => queryString = string.Format("{0} {1},", queryString, x.ParameterName));

        return queryString.TrimEnd(',');
    }

    public interface IStoredProcedure<TResult> {
    }
} 
```

保存存储过程输入的类：

```
class AdvancedFTS : 
         DatabaseExtensions.IStoredProcedure<AdvancedFTSDTO> {
    public string SearchText { get; set; }
    public int MinRank { get; set; }
    public bool IncludeTitle { get; set; }
    public bool IncludeDescription { get; set; }
    public int StartYear { get; set; }
    public int EndYear { get; set; }
    public string FilterTags { get; set; }
} 
```

结果对象：

```
public class ResultsFTSDTO {
    public int ID { get; set; }
    public decimal weightRank { get; set; }
} 
```

最后调用存储过程：

```
public List<ResultsFTSDTO> getAdvancedFTSResults(
            string searchText, int minRank,
            bool IncludeTitle,
            bool IncludeDescription,
            int StartYear,
            int EndYear,
            string FilterTags) {

        AdvancedFTS sp = new AdvancedFTS() {
            SearchText = searchText,
            MinRank = minRank,
            IncludeTitle=IncludeTitle,
            IncludeDescription=IncludeDescription,
            StartYear=StartYear,
            EndYear = EndYear,
            FilterTags=FilterTags
        };
        IEnumerable<ResultsFTSDTO> resultSet = _context.Database.ExecuteStoredProcedure(sp, "ResultsAdvancedFTS");
        return resultSet.ToList();

    } 
```

# http - 亚马逊负载均衡器返回错误代码 400

> ID：14243948
> 
> 赞同：7
> 
> 时间：2013-01-09T18:27:01.093
> 
> 标签：http, amazon-ec2, load-balancing

我们在亚马逊上有一个负载均衡器，可以平衡 4 台服务器。当向负载均衡器发送特定的 HTTP 请求时，我得到 Http 错误代码 400。但是当我直接向每台服务器发送相同的请求时，我得到 Http 200 OK。使用平衡器时，其他请求工作正常。

有任何想法吗？

谢谢。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-02-05T09:34:55.783

不知道这是否会帮助你，但我遇到了类似的问题。我使用的是 jMeter，当通过 AWS 负载均衡器访问我的实例时，我总是会得到：HTTP/1.1 400 BAD_REQUEST。经过大量调试后，我发现我正在发送一个空标头（没有名称也没有值），因为我在 jMeter 的 HTTP 标头管理器中有一个空行。因此，我认为，AWS ELB 会检查一些标头，并返回 HTTP 400，即使直接向我的实例发出相同的请求，我也没有遇到任何问题。我不知道这是否会帮助你，但你应该仔细检查你的标题是否有像这样的愚蠢错误：D

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2018-06-04T17:08:19.300

我遇到了类似的问题，这是由于 ALB 不接受小写的 HTTP 方法引起的。

```
GET http://myhost.com/foo -> HTTP 200
get http://myhost.com/foo -> HTTP 400 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2019-05-20T15:45:19.570

就我而言，这是标题问题。

ELB-HealthChecker 正在向我的 Web 服务器发送健康检查请求，而 nginx 回复了 400。

问题是 ELB-HealthChecker 没有随请求发送标头。根据您的网络服务器的配置，这可能会返回 400 错误代码。

要检查是否是这种情况，请使用 curl 复制“no headers”请求：

```
curl -I -H 'User-Agent:'  -H 'Accept:' -H 'Host:' http://yourservice/health/ 
```

解决方案是配置将返回 200 的 nginx 端点，而不管请求标头是否存在：

```
location = /health/ { return 200; } 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2021-03-04T06:10:44.903

在我的情况下，我的端口 443 的目标组使用 HTTP 协议而不是 HTTPS，我得到“客户端使用 HTTP 连接到 HTTPS 服务器”

# python - 在python中使用eval动态创建类

> ID：14243956
> 
> 赞同：4
> 
> 时间：2013-01-09T18:27:38.623
> 
> 标签：python, oop, metaprogramming

我想接受一个参数并创建一个名称就是参数本身的类。例如，我将“Int”作为参数并创建一个名为“Int”的类，即我的类将是这样的。

```
class Int :
    def __init__(self,param) :
        self.value = 3 
```

我正在这样做。

```
def makeClass( x ) :

    return eval( 'class %s :\n    def __init__(self,param) :\n        self.type = 3'%(x,)) 
```

然后打电话

```
myClass = makeClass('Int')
myInt = myClass(3) 
```

我收到了一个语法错误。请帮忙。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-09T18:28:40.557

`eval`用于评估表达式，`class`不是表达式，而是语句。也许你想要类似的东西`exec`？

作为旁注，您在这里所做的事情可能很容易使用 完成[`type`](http://docs.python.org/2/library/functions.html#type)，然后您回避使用`eval`/的所有性能和安全影响`exec`。

```
def cls_init(self,param):
    self.type = 3

Int = type("Int",(object,),{'__init__':cls_init})
#           ^class name
#                ^class bases -- inherit from object.  It's a good idea :-)
#                           ^class dictionary.  This is where you add methods or class attributes. 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2015-06-10T08:46:52.553

根据要求，这适用于 Python 2.7 和 Python 3.4，打印`3`：

```
def makeClass(x):
    exec('class %s:\n\tdef __init__(self,v):\n\t\tself.value = v' % x)
    return eval('%s' % x)

myClass = makeClass('Int')
myInt = myClass(3)

print(myInt.value) 
```

如果您希望从现有类中添加方法：

```
def makeClass(name):
    parent = name.lower()
    exec('class %s(%s):\n\tdef __init__(self,v):\n\t\tself.value = v' % (name, parent))
    return eval('%s' % name)

Int = makeClass('Int')
myInt = Int(3)

Str = makeClass('Str')
myStr = Str(3)

print(myInt.value, myInt == 3, myInt == 5)
print(myStr.value, myStr == '3', myStr == 3) 
```

输出：

```
3 True False
3 True False 
```

少打字有副作用：

```
def makeClass(name):
    parent = name.lower()
    exec('global %s\nclass %s(%s):\n\tdef __init__(self,v):\n\t\tself.value = v' % (name, name, parent))

makeClass('Int')
myInt = Int(3)

makeClass('Str')
myStr = Str(3) 
```

不过， Mgilson 的`type`答案可能是首选。

# c - ANSI C 函数声明如何改进旧的 Kernigan 和 Ritchie 风格？

> ID：14243959
> 
> 赞同：5
> 
> 时间：2013-01-09T18:27:48.783
> 
> 标签：c

关于 ANSI C 函数声明，这对旧的 K&R 风格有何改进？我知道它们之间的区别，我只想知道使用旧样式会出现什么问题以及新样式如何改进。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-01-09T18:48:31.347

特别是旧式函数*声明*不允许在编译时检查调用。

例如：

```
int func(x, y)
char *x;
double y;
{
     /* ... */
} 
```

...

```
func(10, 20); 
```

当编译器看到调用时，它不知道函数的参数类型`func`，因此无法诊断错误。

相比之下：

```
int better_func(char *x, double y) {
    /* ... */
} 
```

...

```
better_func(10, 20); 
```

将导致编译器错误消息（或至少是警告）。

另一个改进：原型可以使函数具有参数类型`float`和整数类型比`int`（3`char`种类型和两种`short`类型）更窄的参数。没有原型，`float`被提升为`double`，而窄整数类型被提升为`int`或`unsigned int`。使用原型，`float`参数作为 a 传递`float`（除非函数是可变参数，如`printf`，在这种情况下，旧规则适用于可变参数）。

[C Rationale](http://www.open-std.org/jtc1/sc22/wg14/www/C99RationaleV5.10.pdf)文档在第6.7.5.3 节中讨论了这一点，可能比我的更好：

> 函数原型机制是 C 语言最有用的补充之一。当然，该功能在过去 25 年的许多源自 Algol 的语言中都有先例。标准中采用的特定形式在很大程度上基于 C++。
> 
> 函数原型提供了强大的翻译时错误检测能力。在没有原型的传统 C 实践中，翻译器很难检测到调用另一个源文件中声明的函数时的错误（错误的参数数量或类型）。此类错误的检测在运行时或通过使用辅助软件工具进行。
> 
> 在不在函数原型范围内的函数调用中，整数参数应用了*整数提升*，**浮点** 参数被扩展为**double**。在这样的调用中不可能传递未转换的**char**或**float**参数。函数原型为程序员提供了对函数参数类型转换的显式控制，因此通常不适当且有时效率低下的参数默认扩展规则可以被实现抑制。

还有更多; 去读吧。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-09T19:15:28.923

K&R 中的非定义函数*声明*如下所示

```
int foo(); 
```

并引入了一个接受*未指定*数量参数的函数。这种声明风格的问题很明显：它既没有指定参数的数量，也没有指定它们的类型。编译器无法根据调用点的参数数量或其类型检查调用的正确性。在参数类型与预期参数类型不匹配的情况下，编译器无法执行参数类型转换或问题和错误消息。

*在 K&R 中用作函数定义*的一部分的函数声明如下所示

```
int foo(a, b) 
int a;
char b;
{ ... 
```

它指定了参数的数量，但仍然没有指定它们的类型。此外，即使这个声明似乎暴露了参数的数量，它仍然`foo`以相同的方式正式声明`int foo();`，这意味着调用它`foo(1, 2, 3, 4, 5)`仍然不构成违反约束。

新风格，即使用原型声明更好，原因很明显：它公开了参数的数量和类型。它强制编译器检查调用的有效性（关于参数的数量和类型）。它允许编译器执行从参数类型到参数类型的隐式类型转换。

原型声明还提供了其他不太明显的好处。由于调用者和函数本身都知道函数参数的数量和类型，因此可以在调用时选择最有效的方法来传递参数（调用约定），而无需查看函数定义。如果没有这些信息，K&R 实现就不得不对所有函数遵循一个预先确定的“一刀切”的调用约定。

# javascript - 函数未作为函数传递

> ID：14243963
> 
> 赞同：1
> 
> 时间：2013-01-09T18:28:03.670
> 
> 标签：javascript, three.js, anonymous-function

我正在开发一个简短的“引擎”类，以在一定程度上简化与 Three.js 的交互。我将示例的 Render() 方法重构为这个 Engine JS 类，如下所示：

```
var Engine = function () {
  var pub = {},
      scene,
      camera;

  // SNIP: Extra private and public variables and functions...

  pub.Render = function (fixedUpdate) {
    requestAnimationFrame(pub.Render);
    fixedUpdate();
    renderer.render(scene, camera);
  };

  return pub;
}(); 
```

我尝试通过传递一些带有我想要对其执行的操作的函数来使用它。例如：

```
Engine.Render(function () {
    cube.rotation.x += 0.01;
    cube.rotation.y += 0.02;
}); 
```

但是，当我尝试在 Chrome 中运行它时，出现错误：*Uncaught TypeError: number is not a function*，并且在检查 Engine.Render 的 fixedUpdate 变量时，它通常是一个非常大的数字，并且显然没有注册为匿名函数传入的调用代码。

作为健全性测试，我尝试将句柄传递给非匿名函数，如下所示：

```
function animation() {
  cube.rotation.x += 0.01;
  cube.rotation.y += 0.02;
}

Engine.Render(animation); 
```

...并得到完全相同的结果。我怀疑问题在于我如何调用参数。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-09T18:50:08.873

试试这个：

```
 pub.Render = function (fixedUpdate) {
    requestAnimationFrame(function () {pub.Render();});
    fixedUpdate();
    renderer.render(scene, camera);
  }; 
```

# android - 为什么停止录制音频时会出现 IllegalStateException？

> ID：14243964
> 
> 赞同：6
> 
> 时间：2013-01-09T18:28:07.803
> 
> 标签：android, audio, illegalstateexception, android-audiorecord

我想用麦克风录制音频并保存音频文件。开始录制工作正常，但是当我尝试停止录制时，模拟器会出现强制关闭错误。堆栈跟踪：

```
01-09 18:16:59.075: E/AndroidRuntime(831): FATAL EXCEPTION: main
01-09 18:16:59.075: E/AndroidRuntime(831): java.lang.IllegalStateException
01-09 18:16:59.075: E/AndroidRuntime(831):  at android.media.MediaRecorder.stop(Native Method)
01-09 18:16:59.075: E/AndroidRuntime(831):  at com.example.voice.recorder.MainActivity.StopRecording(MainActivity.java:45)
01-09 18:16:59.075: E/AndroidRuntime(831):  at com.example.voice.recorder.MainActivity$1.onClick(MainActivity.java:76)
01-09 18:16:59.075: E/AndroidRuntime(831):  at android.view.View.performClick(View.java:3511)
01-09 18:16:59.075: E/AndroidRuntime(831):  at android.view.View$PerformClick.run(View.java:14105)
01-09 18:16:59.075: E/AndroidRuntime(831):  at android.os.Handler.handleCallback(Handler.java:605)
01-09 18:16:59.075: E/AndroidRuntime(831):  at android.os.Handler.dispatchMessage(Handler.java:92)
01-09 18:16:59.075: E/AndroidRuntime(831):  at android.os.Looper.loop(Looper.java:137)
01-09 18:16:59.075: E/AndroidRuntime(831):  at android.app.ActivityThread.main(ActivityThread.java:4424)
01-09 18:16:59.075: E/AndroidRuntime(831):  at java.lang.reflect.Method.invokeNative(Native Method)
01-09 18:16:59.075: E/AndroidRuntime(831):  at java.lang.reflect.Method.invoke(Method.java:511)
01-09 18:16:59.075: E/AndroidRuntime(831):  at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:784)
01-09 18:16:59.075: E/AndroidRuntime(831):  at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:551)
01-09 18:16:59.075: E/AndroidRuntime(831):  at dalvik.system.NativeStart.main(Native Method) 
```

它在 MediaRecorder.stop() 上给出错误；这就是我尝试停止录制的方式：

```
public void StopRecording() throws IOException{
    recorder.stop();
    recorder.reset();
    recorder.release();
    recorder = null;
} 
```

我如何开始录制：

```
public class MainActivity extends Activity {
    MediaRecorder recorder;
public void StartRecording(){
    recorder = new MediaRecorder();
    recorder.setAudioSource(MediaRecorder.AudioSource.MIC);
    recorder.setOutputFormat(MediaRecorder.OutputFormat.THREE_GPP);
    recorder.setAudioEncoder(MediaRecorder.AudioEncoder.AMR_NB);
    recorder.setOutputFile("/sdcard/sample.3gp");
    try {
        recorder.prepare();
        recorder.start();
    } catch (IllegalStateException e) {
        e.printStackTrace();
    } catch (IOException e) {
        e.printStackTrace();
    }
} 
```

以及我如何调用该方法：

```
 if (!tv.getText().equals("Recording...")){
                tv.setText("Recording...");
                tv.setTextColor(Color.RED);
                record.setImageResource(R.drawable.microphone_icon_pressed);
                StartRecording();

            }else{
                tv.setText("Click the button to start recording");
                record.setImageResource(R.drawable.microphone_icon);
                tv.setTextColor(Color.BLACK);
                try {
                    StopRecording();
                } catch (IOException e) {
                    // TODO Auto-generated catch block
                    e.printStackTrace();
                }
            } 
```

我的清单中有这两个权限：

```
<uses-permission android:name="android.permission.WRITE_EXTERNAL_STORAGE" />
<uses-permission android:name="android.permission.RECORD_AUDIO" /> 
```

所以开始录制工作正常，但停止录制不行。有人知道代码有什么问题吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2016-04-07T21:10:56.467

你的录音机显然没有处于录音状态。您应该确保它是否已成功启动。因为在 start() 之前调用 stop() 时会发生 IllegalStateException。如果抛出 RuntimeException，则在 stop() 块中添加 RuntimeException，然后删除输出文件。

参见[MediaRecorder.java](https://android.googlesource.com/platform/frameworks/base/+/b267554/media/java/android/media/MediaRecorder.java)

```
 /**
     * Stops recording. Call this after start(). Once recording is stopped,
     * you will have to configure it again as if it has just been constructed.
     * Note that a RuntimeException is intentionally thrown to the
     * application, if no valid audio/video data has been received when stop()
     * is called. This happens if stop() is called immediately after
     * start(). The failure lets the application take action accordingly to
     * clean up the output file (delete the output file, for instance), since
     * the output file is not properly constructed when this happens.
     *
     * @throws IllegalStateException if it is called before start()
     */
    public native void stop() throws IllegalStateException; 
```

如果您需要连续启动和停止，我还建议您在关闭应用程序之前不要释放记录器对象。按照如下流程，创建记录器onCreate()/onResume()，释放onPause/onDestroy()。

[![在此处输入图像描述](../Images/34bf697fccb5b3532eea8e5d93ae2c42.png)](https://i.stack.imgur.com/E9hzE.gif)

# jms - 如何在不使用 JMS 消息的情况下读取它们 - 使用 ActiveMQ

> ID：14243966
> 
> 赞同：8
> 
> 时间：2013-01-09T18:28:20.970
> 
> 标签：jms, activemq

我想知道是否有任何方法可以读取 jms 和 actibemq 消息而不使用它？？我知道可以从队列中消费消息，但我仍然想问这个问题。！！

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-01-09T21:17:53.170

您可以通过 JMS QueueBrowser 浏览队列上的消息，或者在 ActiveMQ 中，您可以通过 JMX 或使用命令行工具浏览内容：

[ActiveMQ 控制台工具](http://activemq.apache.org/activemq-command-line-tools-reference.html)

[JMS 队列浏览器 API](https://docs.oracle.com/javaee/7/api/javax/jms/QueueBrowser.html)

[ActiveMQ JMX](http://activemq.apache.org/jmx.html)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2016-12-14T12:17:07.797

您需要使用`QueueBrowser`该类来执行此操作，而不是使用 Message-consumers：

```
ConnectionFactory connectionFactory = 
    new ActiveMQConnectionFactory("tcp://127.0.0.1:61616"); 
Connection connection = 
    connectionFactory.createConnection("admin","admin");
connection.start();
Session session = connection.createSession(false, Session.AUTO_ACKNOWLEDGE);
Queue queue = session.createQueue("Test");
QueueBrowser queueBrowser = session.createBrowser(queue);
Enumeration msgs = queueBrowser.getEnumeration();
while (msgs.hasMoreElements()) {
    //do your things here
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2016-06-02T16:47:28.217

另一种选择是“消费”消息，但只是在事务中，然后当你完成后，将其回滚，但浏览器可能会更好，因为这就是“它的用途”。

如果您只是在寻找特定的消息，并且手册会这样做，那么您可以通过单击 UI 中的“RSS 提要”按钮来查看（我认为至少是部分）activemq 的消息及其内容。这基本上将它们全部转储到屏幕上。“原子提要”选项的加载速度似乎比“RSS”一个 FWIW 更快。

# asp.net-mvc-3 - 在存储库模式 MVC 中使用重载（可选）构造函数

> ID：14243968
> 
> 赞同：0
> 
> 时间：2013-01-09T18:28:29.660
> 
> 标签：asp.net-mvc-3, repository-pattern

我正在关注以下文章和存储库模式。

[http://www.asp.net/mvc/tutorials/getting-started-with-ef-using-mvc/implementing-the-repository-and-unit-of-work-patterns-in-an-asp-net- mvc-应用程序](http://www.asp.net/mvc/tutorials/getting-started-with-ef-using-mvc/implementing-the-repository-and-unit-of-work-patterns-in-an-asp-net-mvc-application)

我一度感到困惑，控制器中定义的可选构造函数。

```
public StudentController(IStudentRepository studentRepository)
{
    this.studentRepository = studentRepository;
} 
```

即使，我删除了 - 代码运行良好。这个构造函数有什么用。当我们在主默认构造函数中分配新的上下文对象时。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-09T18:38:35.863

此构造函数允许您传入 studentRepository 的不同实现。请注意，它接受一个接口，而不是存储库的具体实现。这对于单元测试很有用，您可以传入不需要访问数据库的假存储库。您还可以将此构造函数与依赖注入一起使用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-09T18:36:34.100

可选的 ctor 不会创建新的上下文，而可选的 ctor 会。上下文在 StudentRepository 的 ctor 中设置。

# c - 错误：赋值使指针从整数而不进行强制转换

> ID：14243969
> 
> 赞同：4
> 
> 时间：2013-01-09T18:28:31.597
> 
> 标签：c

```
int findNumber(char *exp,int i,int *num)    
{    
    int k=i;    
    char *p;    
    p=exp[i]; //<-- here
    while(*p>='0'&&*p<='9')    
    {
        (*num)=(*num)*10+(*p);
        k++;
        p++;
    }
    return k;
} 
```

我不断收到该错误：（p = exp [i];）我试图发送一个char数组和（i，num）整数，'i'我现在只是把它设为0，直到代码工作所以不要注意它。但是该函数应该返回“exp”中第一个不是数字的字符的位置，并确保之前的所有字符都是数字。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-09T18:30:03.740

`p`是 a`char*`所以你需要为它分配一个指针，但从数组中`exp[i]`返回一个元素。`char`尝试

```
p = &exp[i]; 
```

或者

```
p = (exp + i); 
```

反而。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-09T18:35:56.947

更正该行以对应于以下`p=&(exp[i]);`这意味着您正在将 exp[i] 的指针分配给 p。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-09T19:13:15.023

您需要获取地址而不是然后传递给`p`，这是一个指针。换句话说，你被分配 `char`到一个`char* returned from value at`i `index in`exp` 数组。

试试这个：`p = &exp[i];`

# performance - Java 的支持数组的堆结构

> ID：14243970
> 
> 赞同：3
> 
> 时间：2013-01-09T18:28:38.160
> 
> 标签：performance, algorithm, data-structures, heap, priority-queue

我正在寻找可以使用`Object[]`数组**而不是**对象`Node`来实现的优先级队列的堆结构。

二进制堆当然可以很好地工作，n 元堆也是如此。Java`java.util.PriorityQueue`是一个二进制堆，使用`Object[]`数组作为存储。

还有很多其他堆，例如斐波那契堆，但据我所知，这些需要使用节点来实现。从我的基准测试来看，我的印象是管理所有这些节点对象所付出的开销可能会耗尽所有获得的收益。我发现很难实现一个可以使用简单的数组支持的二进制堆来实现的堆。

所以我目前正在寻找也没有使用`Node`对象开销的高级堆/优先级队列结构。因为我希望它在现实中更快，而不仅仅是在复杂性理论中更好……而且现实中发生了更多事情：例如 CPU 有 L1、L2 和 L3 缓存等，它们确实会影响性能。

我的问题也集中在**Java**上，因为我在这里对内存管理几乎没有影响，并且没有`struct`像在 C 中那样的 s。由于内存管理开销，在 C 中实现时运行良好的许多堆在 Java 中变得昂贵和垃圾收集费用。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-09T18:34:40.077

几种不常见的堆结构可以通过这种方式实现。例如，[在 Dijkstra 的平滑排序算法](http://keithschwarz.com/smoothsort/)中使用的 Leonardo Heap 通常被实现为一个增加了两个机器字的数组。像二叉堆一样，数组表示是特定树结构（或者更确切地说是森林，因为它是树的集合）的数组表示。

[杨树堆结构](http://iwi.eldoc.ub.rug.nl/FILES/root/1991/InfProcLettBron/1991InfProcLettBron.pdf)是作为理论上效率稍低但实际上效率更高的堆结构引入的，具有相同的基本思想 - 数据表示为具有一些额外小的状态信息的数组，并且是森林结构的压缩表示。

一个更规范的基于数组的堆是[d-ary heap](http://en.wikipedia.org/wiki/D-ary_heap)，它是二叉堆的自然概括，具有 d 个孩子而不是两个。

作为一个非常愚蠢的例子，排序数组可以用作优先级队列，尽管它非常低效。

希望这可以帮助！

# c++ - 可以在 C++ 中实现 XOR 链表而不会导致未定义的行为吗？

> ID：14243971
> 
> 赞同：16
> 
> 时间：2013-01-09T18:28:39.460
> 
> 标签：c++, data-structures, linked-list, language-lawyer, xor

**[XOR 链表](http://en.wikipedia.org/wiki/XOR_linked_list)**是普通双向链表的修改版本，其中每个节点仅存储一个“指针”而不是两个。该“指针”由下一个和前一个指针的 XOR 组成。要遍历列表，需要两个指针——一个指向当前节点，一个指向下一个或前一个节点。为了向前遍历，前一个节点的地址与存储在当前节点中的“指针”进行异或运算，从而显示出真正的“下一个”指针。

C++ 标准会导致对指针和整数的一堆操作导致未定义的行为——例如，你不能保证在数字中设置特定位不会导致硬件触发中断，因此在某些情况下位的结果twiddling 可以是未定义的。

我的问题如下：是否存在不会导致未定义行为的 XOR 链表的 C++ 实现？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2013-01-09T18:34:03.243

> 我的问题如下：是否存在不会导致未定义行为的 XOR 链表的 C++ 实现？

如果“是否有实现”是指“它已经被编写过”，那么我不知道。如果您的意思是“是否可以写一个”，那么可以，但可能有一些关于可移植性的警告。

`uintptr_t`如果在开始之前将两个指针都转换为，并将该类型存储在节点中而不是指针中，则可以对您的心脏内容进行位旋转。无符号类型的按位运算永远不会导致未定义的行为。

但是，`uintptr_t`它是一个可选类型，因此它不是完全可移植的。不要求 C++ 实现实际上具有能够表示地址的整数类型。如果实现没有`uintptr_t`，则允许使用诊断编译代码，在这种情况下，其行为超出标准范围。不确定您是否认为“无UB”侵权。我的意思是，严肃地说，一个允许使用未定义类型的代码的编译器？;-)

为了避免这种情况，`uintptr_t`我*认为*您可以`sizeof(node*)`改为对一组无符号字符进行操作。指针是 POD 类型，因此只要对象表示在用作指针之前恢复到其原始状态，就可以被复制、旋转和切割。

另请注意，如果您的 C++ 实现具有垃圾收集器，则 convert-to-integer / xor / xor-back-again / convert-to-pointer 不必停止收集对象（因为它会导致“不安全地派生指针”）。因此，为了可移植性，您*还*必须确保生成的指针有效。有两种方法可以做到这一点：

1.  拜访`declare_reachable`他们。
2.  使用具有*宽松指针安全性*的实现（是否是这种情况由实现定义，您可以对其进行测试，`get_pointer_safety()`同时记住允许宽松的实现错误地声称它是严格的）。

您可能会认为还有第三种方式（尽管这种方式违背了 XOR 链表的目的，除非您碰巧拥有它）：

*   保留所有指针值的单独容器

*这不能保证有效*。不安全派生的指针是无效的，即使它恰好等于安全派生的指针 (3.7.4.3/4)。我也很惊讶。

# git - Git：如何正确合并两个功能完全不同的分支？

> ID：14243977
> 
> 赞同：11
> 
> 时间：2013-01-09T18:28:47.107
> 
> 标签：git, git-merge, git-rebase

想象一下这样一种情况，您有同一个项目的两个分支，第一个分支的一个部分在另一个分支上进行了显着重构。但是有一段时间你需要保持两个分支的功能，所以你正在对它们进行错误修复和关键功能添加，有时以不对称的方式。在某些时候，您必须将重构的分支合并到原始分支上。在这种情况下使用的最佳技术是什么？是否仍然可以保持历史清洁？

但更重要的是，在这种情况下我的初始策略应该是什么？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-01-25T08:42:39.413

由于任务是简单地使用另一个分支而不是`master`，您可以简单地完全删除`master`分支或将其重命名为 - `legacy`，然后取另一个分支并将其重命名为`master`. 就是这样。以下是您可能需要执行以在本地和 GitHub 上实现目标的实际命令：

```
git branch -m master legacy               # rename local master to legacy
git checkout legacy
git branch -m another_branch master       # another_branch will be our new master 
```

在本地，我们现在完成了。但是，您不能简单地删除`master`GitHub 上的分支。您需要先将另一个分支作为默认分支。这可以在存储库中完成`Settings > Default Branch`。完成此操作后，您可以继续：

```
git push origin :master                   # remove master on GitHub
git push origin master                    # push out our new master branch
git push origin legacy                    # push our legacy branch too 
```

然后返回`Settings > Default Branch`并将默认分支切换回`master`. 此外，您可以删除在迁移过程中可能创建的所有额外分支。

或者，如果您希望将所有操作保存在历史记录中，请在[此处](https://stackoverflow.com/questions/2763006/change-the-current-branch-to-master-in-git)检查正确答案。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-09T20:14:29.033

由于您有 2 个分支，因此对另一个分支进行了重大重构，并且您正在维护这两个分支……我会说 Git 不会神奇地帮助您。为了 git 的帮助，您应用于分支 1 的补丁/更改需要与分支 2 相似（但不完全相同）。

由于它被重构，代码可能不相似，除非新代码被模块化以在两个分支上相同。

首先你应该做什么？

*   将一些单元测试和/或集成测试代码添加到初始分支
*   在第二个分支上运行相同的集成测试
*   对于新的更改添加测试
*   然后您可以验证两个分支的更改是否有效

更新：为了管理对两个分支的更改，您可能只需要一个过程，例如： - 主要在分支重构上工作 - 在完成时将每个“故事”或工作项合并到分支遗留

第二步是我认为如果分支之间的代码差异太大，那将是很多工作。如果您确实必须维护两个分支，请尝试将新代码封装在可以在两个分支中使用的库中。这将使从一个分支合并到另一个清洁器。

# mysql - MySQL 外部参照表

> ID：14243978
> 
> 赞同：3
> 
> 时间：2013-01-09T18:28:48.210
> 
> 标签：mysql

出于某种原因，我需要一些有关外部参照表的帮助，我正在画一个空白。

我有以下 3 张桌子

```
+---------------------+
| Products            | 
+---------------------+
| id                  |
| stock_number        |
| size                |
| qty                 | 
+---------------------+

+-------------+
| Category    |
+-------------+
| id          |
| name        |
| description |
| img         |
+-------------+ 
```

*外部参照表

```
+--------------+
| category_prod|
+--------------+
| cat_id       |
| prod_id      |
+--------------+ 
```

考虑到这一点说我有

*   类别： ID 为 1 的苹果
*   产品：Granny Smith，ID 为 2
*   产品：ID 为 5 的 Yellow Delicious

所以我会在外部参照表 category_prod 中：

```
+--------+---------+
| cat_id | prod_id |
+--------+---------+
| 1      | 2       |
| 1      | 5       |
+--------+---------+ 
```

我将如何编写查询以使用外部参照表获取所有产品信息，以查看哪些产品属于哪个类别。

所以基本上我希望我的输出是 Apple 类别中的所有产品与该产品的所有字段一起显示

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-09T18:34:34.653

加入表格：

```
SELECT p.* FROM Products p
LEFT JOIN categry_prod cp ON cp.prod_id=p.id
WHERE cp.cat_id=1; 
```

# actionscript-3 - 在 Flex 4 中定义自定义 CSS 属性

> ID：14243979
> 
> 赞同：0
> 
> 时间：2013-01-09T18:28:51.283
> 
> 标签：actionscript-3, apache-flex, flex4, flex4.5, mxml

我正在创建一个 Flex 主题并定义默认组件外观。所有按钮都应具有默认外观。可以使用 styleName 将特殊样式应用于按钮，它为按钮皮肤定义一组颜色。

我创建了一个 Spark Button 皮肤，如下所示：

```
<!-- ButtonSkin.mxml -->

<s:Skin xmlns:fx="http://ns.adobe.com/mxml/2009" xmlns:s="library://ns.adobe.com/flex/spark" 
            xmlns:fb="http://ns.adobe.com/flashbuilder/2009" minWidth="21" minHeight="24" alpha.disabled="0.5">

    <fx:Metadata>
        <![CDATA[
            [HostComponent("spark.components.Button")]
            [Style(name="backgroundGradient", states="up, over, down", format="Array", inherit="yes")]
        ]]>
    </fx:Metadata>

    <fx:Script>
        <![CDATA[
            override protected function updateDisplayList(unscaledWidth:Number, unscaledHeight:Number):void
            {
                var backgroundGradient:Array = getStyle("backgroundGradient");
                topGradientEntry.color = backgroundGradient[0];
                bottomGradientEntry.color = backgroundGradient[1];

                super.updateDisplayList(unscaledWidth, unscaledHeight);
            }
        ]]>
    </fx:Script>

    <s:states>
        <s:State name="up" />
        <s:State name="over" />
        <s:State name="down" />
        <s:State name="disabled" />
    </s:states>

    <!-- shapes using topGradientEntry.color and bottomGradientEntry.color -->
</s:Skin> 
```

像这样设置主css文件：

```
/** default.css **/

s|Button {
    skinClass: ClassReference('mytheme.skins.ButtonSkin');
    fontWeight: bold;
}

skins|ButtonSkin {
    backgroundGradient: 0x000000, 0xFFFFFF;
}

s|Button.btn-primary:up {
    backgroundGradient: 0x000000, 0xFFFFFF;
}
s|Button.btn-primary:over {
    backgroundGradient: 0x000000, 0xFFFFFF;
}
s|Button.btn-primary:down {
    backgroundGradient: 0x000000, 0xFFFFFF;
}

s|Button.btn-inverted:up {
    backgroundGradient: 0xFFFFFF, 0x000000;
}
s|Button.btn-inverted:over {
    backgroundGradient: 0xFFFFFF, 0x000000;
}
s|Button.btn-inverted:down {
    backgroundGradient: 0xFFFFFF, 0x000000;
} 
```

应用程序会像这样设置按钮的样式：

```
<!-- Main.mxml -->

<s:Button label="Default" x="10" y="10" width="75" height="26"/>
<s:Button label="Button" x="110" y="10" width="75" height="26" styleName="btn-success"/>
<s:Button label="Primary" x="210" y="10" width="75" height="26" styleName="btn-primary"/> 
```

但是我在所有情况下都收到错误“不支持'backgroundGradient'的CSS值”。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-09T18:50:49.440

我不敢相信我在这个问题上花了多少时间。问题是 CSS 中的值应该使用带有 # 格式的 HEX，即 #FFFFFF 而不是 0xFFFFFF。Actionscript 使用 0x 格式，MXML 使用两者，而 CSS 使用带有 # 格式的 HEX。

# php - MySql 结果成分组的多维数组，我遗漏了一些东西

> ID：14243980
> 
> 赞同：1
> 
> 时间：2013-01-09T18:29:07.560
> 
> 标签：php, arrays, associative-array, multidimensional-array

请一些新鲜的眼睛告诉我我在这里做错了什么？我确定这很简单。

检索数据集的sql查询：

```
SELECT * FROM articles WHERE category='category' ORDER BY publish_date DESC, id DESC LIMIT 0, 10 
```

我试图达到的多维数组：

```
list [ 
    publish_date [
        0 [ id, title, body ]
        1 [ id, title, body ]
        2 [ id, title, body ]]
    publish_date [
        0 [ id, title, body ]
        1 [ id, title, body ]]
    publish_date [
        0 [ id, title, body ]
        1 [ id, title, body ]
        2 [ id, title, body ]
        3 [ id, title, body ]]]
Etc.. 
```

几个小时以来，我一直在摆弄以下 php 函数：

```
$result = $sql->prepareQuery($query_string);

// iterate through array and place results in an array at row index
$list = ['group_date' => ' '];
$r = 0;
while ($rows = mysql_fetch_assoc($result)) {
    if ($list['publish_date'] != $rows['pub_date']) {
        $list['publish_date'] = $rows['pub_date'];
        $r = 0;
        foreach ($rows as $key => $val) {
            $list['publish_date'][$r[$key = $val]];
        }
        $r++;
    }
    else {
        foreach ($rows as $key => $val) {
            $list['publish_date'][$r[$key = $val]];
        }
        $r++;
    }
}
// return result
print_r($list); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-09T18:49:33.750

认为您正在使事情变得复杂：

```
$list = array();
$current_date = '';
while ($rows = mysql_fetch_assoc($result)) {
    if ($current_date != $rows['pub_date']) {
        $current_date = $rows['pub_date'];
        $list[$current_date] = array();
    }
    $list[$current_date][] = $rows;
} 
```

# c# - 避免多余的条件语句

> ID：14243985
> 
> 赞同：4
> 
> 时间：2013-01-09T18:29:26.787
> 
> 标签：c#, entity-framework, lambda

使用下面的代码，假设我有 5 种不同的类型，我可能会在变量类型中收到这些类型。除了编写 5 个条件语句之外，有没有办法编写一个并使用变量“type”来指示模型是什么，在本例中为“CommentVote”？或者这更多是我设计数据模型的方式的缺陷，这五件事中的每一个都有一个“投票”模型？

```
 if (type == "comment")
 {
      CommentVote voteObj = db.CommentVotes
           .Where(x => x.UserID == UserID && x.CommentID == id)
           .SingleOrDefault();
      if (voteObj != null)
      {
          voteObj.Vote = vote;
          db.SaveChanges();
      }
      else
      {
          CommentVote c = new CommentVote { 
               CommentID = id, UserID = UserID, Vote = vote, DateCreated = DateTime.Now 
          };
          db.CommentVotes.Add(c);
          db.SaveChanges();
      }

      count = (db.CommentVotes.Count(x => x.CommentID == id && x.Vote == true) - db.CommentVotes.Count(x => x.CommentID == id && x.Vote == false));
 } 
```

**魔术代码：**我想做的事情。

```
 var modelName = "";
 var modelOtherName = "";
 if (type == "comment") {
      modelName = CommentVote;
      modelOtherName = CommentVotes;
 }

      modelName voteObj = db.modelOtherName
           .Where(x => x.UserID == UserID && x.CommentID == id)
           .SingleOrDefault(); 
```

**更新**：我开始认为我的模型可能是基于下面引用的一些阅读的废话。所以我把其中的一些作为参考。让我知道这是否是我应该尝试解决的问题。

```
 public class CommentVote
 {
    public int CommentVoteID { get; set; }
    public bool Vote { get; set; }
    public DateTime DateCreated { get; set; }
    public int UserID { get; set; }
    public virtual User User { get; set; } 

    public int CommentID { get; set; }  //This row changes from model to model
    public virtual Comment Comment { get; set; }  //This row changes from model to model
 } 
```

我有一些几乎相同的模型。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-09T18:47:23.823

据我了解您的问题，它更多与数据库架构相关。

如果这些投票彼此之间没有太大区别（就属性而言），我不会为它们使用不同的表格。而是创建一个带有 Type 列的 Vote 表和（如您提供的示例中）CommentID 的可为空列。

然后您可以使用类继承来反映您的投票（Vote 基类和 CommentedVote 子类）。

[实体框架中按层次结构继承的表](http://www.codeproject.com/Articles/96185/Table-Per-Hierarchy-Inheritance-in-Entity-Framewor)

**更新：** 最好不要在所有类中重复相同的属性。您只需像这样使用 inharitence ：

```
 public abstract class Vote
 {
    public int VoteID { get; set; }
    public bool isVote { get; set; }
    public DateTime DateCreated { get; set; }
    public int UserID { get; set; }
    public virtual User User { get; set; } 

    public int VoteType { get; set;} //this property specifies type of vote (e.g. VoteType=1 for CommentedVote )
 } 
 public class CommentVote : Vote
 {
    public int CommentID { get; set; }  
    public virtual Comment Comment { get; set; }  
 }
 public class OtherVote : Vote
 {
    public int OtherID { get; set; }  
    public virtual Other Other { get; set; }  
 } 
```

在[这篇](http://weblogs.asp.net/manavi/archive/2010/12/24/inheritance-mapping-strategies-with-entity-framework-code-first-ctp5-part-1-table-per-hierarchy-tph.aspx)非常好的博客文章中，您可以找到所有可能的方法。我正在写的一个叫做 Table per Hierarchy (TPH)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-09T18:50:07.980

假设您执行相同的操作并设置相同的数据，您绝对可以将代码简化为单个语句。在这种情况下，您应该有一个包含常用操作和数据的接口以及一个对象工厂，以根据类型实例化正确的对象。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-09T18:49:09.020

如果您使用反射实现工厂模式，您可以做到这一点，[这里显示](http://techtaunt.wordpress.com/2011/06/15/factory-pattern-with-reflection-c/)了一个非常基本的示例。

简而言之，您所做的是：由于您可能有 5 种不同的类型，因此您将创建 5 个不同的类，每个类都实现特定的接口。然后，您创建工厂类以使用反射来获取最适合您的情况的类（无论是使用直截了当的类名，如示例中，还是使用类上的 Attribute，如[here](http://crazorsharp.blogspot.com/2009/06/factory-pattern-with-attributes-get-rid.html)）。工厂返回该接口的一个实例，然后您只需从该接口调用公开的方法即可为您完成所有这些工作。

最好的部分是，如果您需要创建另一种类型，您所要做的就是添加另一个具有您将在工厂中搜索的属性/名称的类。您的其他代码都不需要受到影响，从而使您符合开放/封闭原则。

# php - 包含内的 Netbeans 类型提示

> ID：14243987
> 
> 赞同：2
> 
> 时间：2013-01-09T18:29:36.157
> 
> 标签：php, netbeans, type-hinting

因此，以下是一个奇怪的问题，虽然我确信人们会指责我在这种行为的发生方式上存在不良做法，但为了我正在从事的项目，这就是用例，我很想知道我是否遗漏了什么。

我有以下情况

```
 class foo()
 {
      private $_bar;

      public function __construct($bar)
      {
           $this->_bar = $bar;
      }

      public function doStuff()
      {
           include('doStuffCode.php');
      }
 } 
```

doStuffCode.php:

```
 $this->_bar->(this is where I'd like to get some type hinting) 
```

我试图加入，`/* var $this->_bar Bar */`但这似乎对我没有任何作用。似乎我无法向特定的类变量添加类型提示。目前的解决方法是设置一个名为 $bar 的临时变量，在其上设置类型提示，然后使用它来获取我正在寻找的方法并将它们复制回正确的上下文中。

我很好奇我是否只是在尝试一些错误，做一些不受支持的事情，误解我应该如何声明 javadoc，或者对这种类型提示应该如何工作有一个根本的误解。

谢谢您的帮助

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-09T18:32:13.640

您需要在类中定义 $_bar 的类型

```
 class foo()
  {
        /**
         * @var Bar
         */
        private $_bar;

        public function __construct($bar)
        {
             $this->_bar = $bar;
        }

        public function doStuff()
        {
             include('doStuffCode.php');
        }
   } 
```

然后在您包含的文件中提示：

```
/* @var $this foo */ 
```

这将是这样做的正确方法。尽管由于包含文件内容的范围，我不确定是否可以通过这种方式提示私有变量。

# java - BufferedReader 和 Scanner：限制输入字符的数量

> ID：14243991
> 
> 赞同：1
> 
> 时间：2013-01-09T18:29:44.870
> 
> 标签：java

下面是两个简单的例子：

这是第一个 -

```
...
BufferedReader bufferedReader = 
   new BufferedReader( new InputStreamReader(System.in) );

String string = new String ();
try {
   string = bufferedReader.readLine();
} сatch (IOException ioe) {
   //TODO Auto-generated catch block
   ioe.printStackTrace();
}
System.out.println(string);
... 
```

还有这个-

```
...
Scanner scanner = new Scanner(System.in);
String string = scanner.nextLine();
System.out.println(string);
... 
```

例如，我只需要`100`字符并且我想停止用户输入，当字符数等于 100 时。然后输出字符串。

如何使用`API`类`BufferedReader`和设置此限制`Scanner`？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-09T18:38:16.207

在按下 ENTER 之前，您将无法阻止用户输入数据，但您可以限制读取所消耗的字符数：

```
char[] buffer = new char[100];
int charsRead = bufferedReader.read(buffer); 
```

和

```
Scanner scanner = new Scanner(System.in);
String string = scanner.findInLine(".{100}"); 
```

# xml - XML DTD 验证错误

> ID：14243992
> 
> 赞同：2
> 
> 时间：2013-01-09T18:29:49.897
> 
> 标签：xml, validation, dtd

**在线验证：http:** [//xmlvalidator.new-studio.org](http://xmlvalidator.new-studio.org)

[**XML 文档**](http://pastebin.com/UkEt0mT3 "带有嵌入式 DTD 的 XML 文档") *（也显示在下方）*

## 问题 1

为什么会显示以下 6 个错误？

1.  第 29 行第 18 列：类型 ID 的属性值“1”必须是名称。
2.  第 34 行第 22 列：必须为元素类型“dob”声明属性“type”。
3.  第 39 行第 26 列：必须为元素类型“地址”声明属性“类型”。
4.  第 49 行第 18 列：类型 ID 的属性值“2”必须是名称。
5.  第 54 行第 22 列：必须为元素类型“dob”声明属性“类型”。
6.  第 59 行第 27 列：必须为元素类型“地址”声明属性“类型”。

## 问题2

当我取消注释以下行号时。4

```
<!ELEMENT persona (name,dob?,address*) > 
```

并评论以下行号。5

```
<!ELEMENT name (first_name,last_name) > 
```

为什么会显示以下错误？

*   第 4 行第 28 列：元素类型“persona”的声明中需要元素类型。

## 带有嵌入式 DTD 的 XML 文档

```
<?xml version="1.0" encoding="ISO-8859-1" ?>
<!DOCTYPE personality [
<!ELEMENT personality (persona*) >
<!-- <!ELEMENT persona (#PCDATA|(name,dob?,address*))> -->
<!ELEMENT persona (name,dob?,address*) >
<!ELEMENT name (first_name,last_name) >
<!ELEMENT first_name (#PCDATA) >
<!ELEMENT last_name (#PCDATA) >
<!ELEMENT dob (date+,month+,year+) >
<!ELEMENT date (#PCDATA) >
<!ELEMENT month (#PCDATA) >
<!ELEMENT year (#PCDATA) >
<!ELEMENT address (building,street,city,state,country,country_code) >
<!ELEMENT building (#PCDATA) >
<!ELEMENT street (#PCDATA) >
<!ELEMENT city (#PCDATA) >
<!ELEMENT state (#PCDATA) >
<!ELEMENT country (#PCDATA) >
<!ELEMENT country_code (#PCDATA) >

<!ATTLIST persona id ID #REQUIRED >
<!ATTLIST name type (string|number) "string" >

]>

<?xml-stylesheet type="text/css" href="xmlstyle.css" ?>

<personality>
    <persona id="1">
        <name type="string">
            <first_name>Abhisek</first_name>
            <last_name>Pattnaik</last_name>
        </name>
        <dob type="number">
            <date>29</date>
            <month>8</month>
            <year>1990</year>
        </dob>
        <address type="string">
            <building>Plot-471</building>
            <street>Sahid Nagar</street>
            <city>Bhubaneswar</city>
            <state>Odisha</state>
            <country>India</country>
            <country_code>91</country_code>
        </address>
    </persona>

    <persona id="2">
            <name type="string">
                <first_name>Anindita</first_name>
                <last_name>Patnaik</last_name>
            </name>
        <dob type="number">
            <date>5</date>
            <month>12</month>
            <year>1996</year>
        </dob>
            <address type="string">
            <building>Plot-471</building>
            <street>Sahid Nagar</street>
            <city>Bhubaneswar</city>
            <state>Odisha</state>
            <country>India</country>
            <country_code>91</country_code>
        </address>
    </persona>
</personality> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-09T20:34:34.977

```
Line 29 Column 18 : Attribute value "1" of type ID must be a name.
Line 49 Column 18 : Attribute value "2" of type ID must be a name. 
```

ID 类型的属性值不能以数字开头。它必须与`Name`XML 规范中的产生式相匹配，排除了初始数字。

*   [http://www.w3.org/TR/xml/#sec-attribute-types](http://www.w3.org/TR/xml/#sec-attribute-types)
*   [http://www.w3.org/TR/xml/#sec-common-syn](http://www.w3.org/TR/xml/#sec-common-syn)

* * *

```
Line 34 Column 22 : Attribute "type" must be declared for element type "dob".
Line 39 Column 26 : Attribute "type" must be declared for element type "address". 
```

您还没有为and元素声明`type`属性。`dob``address`

* * *

```
<!ELEMENT persona (#PCDATA|(name,dob?,address*))> 
```

这（在上面的 DTD 中注释掉）是非法声明。以下是可以的（但可能不是您想要的）：

```
<!ELEMENT persona (#PCDATA|name|dob|address)*> 
```

有关“混合内容”的限制信息，请参阅

*   [http://www.w3.org/TR/xml/#sec-mixed-content](http://www.w3.org/TR/xml/#sec-mixed-content)
*   [http://en.wikipedia.org/wiki/PCDATA](http://en.wikipedia.org/wiki/PCDATA)。

# java - 关于计算键的总数

> ID：14243993
> 
> 赞同：-1
> 
> 时间：2013-01-09T18:29:50.893
> 
> 标签：java

请不要认为这个问题是重复的，尽管我之前也有类似的问题，但这次不同了..

```
Map <String, String>m = new LinkedHashMap<String, String>();
m.put ("123", "23"); 
m.put ("323", "23");
m.put ("153", "23");
m.put ("623", "23");
m.put ("125", "23");
m.put ("122", "24");
m.put ("167", "24");
m.put ("173", "24");
m.put ("113", "25"); 
```

我需要在这里找出与患者 ID 23 关联的键的数量，如上图所示 5 个键是关联的，我遵循了以下方法

```
List<String> keys = new ArrayList<String>();
        for(String str: m.keySet())
        {
            if(m.get(str).equals("23")) {
                keys.add(str);
                System.out.println(str);
            }
        } 
```

请告知是否还有其他更有效的方法，例如制作 comprator 或其他任何东西。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-09T18:33:16.167

使用 Map.entrySet() 遍历地图并检查是否有匹配增加计数。

如果您想要键的计数或总和，它真的不清楚：

如果您只想要计数：

```
Map<String, String>m = new LinkedHashMap<String, String>();
        int count=0;
        for(Map.Entry<String,String> en: m.entrySet()){
            if(en.getValue().equals("23")){
                count++;
            }

        }
        System.out.println(count); 
```

如果你想要总和：

```
Map<String, String>m = new LinkedHashMap<String, String>();
        int sum=0;
        for(Map.Entry<String,String> en: m.entrySet()){
            if(en.getValue().equals("23")){
                sum+=Integer.parseInt(en.getKey());
            }

        }
        System.out.println(sum); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-09T18:35:02.140

```
for(String str: m.values())
        {
            if(m.equals("23")) {
                keys.add(str);

            }
        } 
```

您正在避免哈希查找。另外，如果您只需要计数；然后

```
int count = 0;
for(String str: m.values())
            {
                if(m.equals("23")) {
                    count++
                }
            }
return count; 
```

# javascript - 是否可以在此 IE6 升级警告中添加关闭按钮？

> ID：14243994
> 
> 赞同：0
> 
> 时间：2013-01-09T18:29:53.047
> 
> 标签：javascript, html, css, wordpress, internet-explorer-6

我正在使用此代码来阻止使用 IE6 的用户访问该站点。

[http://code.google.com/p/ie6-upgrade-warning/](http://code.google.com/p/ie6-upgrade-warning/)

我想让用户选择关闭警告并继续浏览网站而不升级他们的浏览器。

有没有办法做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-09T18:43:31.033

使用 Microsoft 的横幅：[http](http://www.ie6countdown.com/join-us.aspx) ://www.ie6countdown.com/join-us.aspx您可以使用以下代码添加关闭按钮：

```
<!--[if lt IE 7]> <div id="ie6banner" style='clear: both; height: 59px; padding:0 0 0 15px; position: relative;'> <a href="http://windows.microsoft.com/en-US/internet-explorer/products/ie/home?ocid=ie6_countdown_bannercode"><img src="http://storage.ie6countdown.com/assets/100/images/banners/warning_bar_0000_us.jpg" border="0" height="42" width="820" alt="You are using an outdated browser. For a faster, safer browsing experience, upgrade for free today." /></a><a onClick="document.getElementById('ie6banner').style.display = 'none'; this.style.display = 'none';"</div> <![endif]--> 
```

# facebook - OAuthException(#240) 不允许此用户将照片上传到此对象的墙

> ID：14243995
> 
> 赞同：0
> 
> 时间：2013-01-09T18:29:53.870
> 
> 标签：facebook, object, photo, access-token, facebook-oauth

这是我的 cron.php

```
<?php
ob_start();

// Load the required files

require_once('fb_src/facebook.php');
require_once('includes/fb.php');
require_once('includes/db.php');
require('includes/timezone.php');

// Connect to the DB

$con = mysql_connect(SERVER,USERNAME,PASSWORD);
if (!$con)
{
    die('Could not connect: ' . mysql_error());
}
mysql_select_db(DB, $con);

$result = mysql_query("SELECT * FROM queue WHERE date_to_post='" . date("o-m-d") . "'");

// Fetch in the DB the content that is supposed to be posted today and echo it out

date_default_timezone_set('CST');
echo "Date: " . date("o-m-d");  
echo "<br/>Time: " . date(g) . ":" . date(i) . " " . date(A);

// Connect to FB

$facebook = new Facebook(array(
    'appId' => APPID,
    'secret' => SECRET,
    'cookie' => true,
    'fileUpload' => true
));   

while($row = mysql_fetch_array($result))
{
    echo "ID: " . $row['id'];
}

echo "<br/><hr/><br/>";

echo "Connected...<br/>";

// Post the content in FB

echo "<br/><br/>Query: SELECT * FROM queue WHERE date_to_post='" . date("o-m-d") . "'";
$result2 = mysql_query("SELECT * FROM queue WHERE date_to_post='" . date("o-m-d") . "'");

while($row = mysql_fetch_array($result2))
{
    $picture_path_query = mysql_query("SELECT * FROM messages WHERE id='" . $row['message_id'] . "'");
    while ($row_for_picture_path = mysql_fetch_array($picture_path_query)) {
        $picture_path =  "@" . realpath($row_for_picture_path['picture']);
    }
    echo "<br/>Picture Path: $picture_path <br/>";
    echo "<br/>Message ID: " . $row['message_id'];
    /* if ((substr(strstr($row['time_to_post'], ':'), 0, 2) ==  ":" . substr(date('i'), 0, 1)) && (date(g) == substr($row['time_to_post'], 0, 1)) && (date(A) == $row['am_or_pm'])) {  */
        try {
            echo "<br/><br/>About to post...<br/><br/>";
            $uid = $row['uid'];
            $message = $row['message_to_post'];
            $picture = $picture_path;
            echo "PIC: $picture <br/><br/>";
            $access_token = $row['access_token'];
            $response = $facebook->api(
              "/$uid/photos/",
              'post',
              array(
                'access_token ' => $access_token,
                'message' => $message,
                'source' => $picture,
                 // @-sign must be the first character
)
            );
            echo "Reponse: $response";

            //}
            echo "Posted message #" . $row['id'] . " with message '" . $row['message_to_post'] . "' and picture path '" . $row['picture'] . "' by user: '" . $uid . "'";
            }

        catch(FacebookApiException $e) {
            $login_url = $facebook->getLoginUrl( array(
                'scope' => 'publish_stream'
            ));

            print_r($e->getType());
            print_r($e->getMessage());
        }
    }
//}

echo "<br/><br/><strong>Done.</strong> - <a href='" . $facebook->getLogoutUrl() . "'>Logout</a>";
ob_flush();
?> 
```

我从 mysql 数据库中获取 UID 和访问令牌。该用户已允许我的应用代表他们发布并访问新闻提要。运行脚本后，我得到：

OAuthException(#240) 不允许此用户将照片上传到此对象的墙

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-09T18:53:58.010

您似乎正试图将这张照片发布到用户的墙上。如果您使用`/me/photos`而不是`/$uid/photos`. 所有者`access_token`决定谁是。`me`

其他想法：您是否使用[Facbook 调试器](https://developers.facebook.com/tools/debug/)`access_token`检查了存储在数据库中的数据，以确保它是有效的，实际上属于您期望的用户并具有正确的权限？另外，您是否验证了存储以确保它是正确的？`uid`

# css - Rails 资产管道 - CSS 未更 新

> ID：14243996
> 
> 赞同：0
> 
> 时间：2013-01-09T18:29:57.413
> 
> 标签：css, ruby-on-rails, asset-pipeline

我正在尝试更新 Rails 应用程序中的字体 - 特别是顶部导航栏中品牌类中的文本。我已经成功地使用谷歌网络字体更改了字体，但是现在当我再次尝试更新字体时，它似乎“卡在”我使用的最后一个字体上。我在部署到 heroku 之前预编译了资产，我认为这可能是导致问题的原因。现在更改不会在本地或生产中更新。

我做了一些故障排除的事情，但似乎没有一个工作：

1.  重新启动 Rails 服务器
2.  清空 tmp 文件夹中的缓存文件夹
3.  删除的公共资产
4.  再次尝试预编译资产 - 字体更改在本地或 heroku 上不起作用
5.  尝试针对更具体的 css 选择器（.navbar .brand 与 .brand - 它更早地适用于 .brand 所以不要认为这是问题）
6.  清除浏览历史

关于可能导致这种情况的任何想法？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-09T18:33:34.643

你在使用涡轮链接吗？如果是这样，请阅读[此](https://github.com/rails/turbolinks#asset-change-detection)

> **资产变化检测**
> 
> 您可以跟踪某些资产，例如 application.js 和 application.css，您希望确保它们在 Turbolinks 会话中始终是最新版本。这是通过使用 data-turbolinks-track 标记这些资产链接来完成的，如下所示：
> 
> ```
> <link href="/assets/application-9bd64a86adb3cd9ab3b16e9dca67a33a.css" 
> ```
> 
> rel="stylesheet" type="text/css" 数据-turbolinks-track>
> 
> 如果这些资产更改 URL（嵌入 md5 标记以确保这一点），页面将执行完全重新加载，而不是通过 Turbolinks。这可确保所有 Turbolinks 会话将始终使用您最新的 JavaScript 和 CSS 运行。
> 
> 发生这种情况时，从技术上讲，您将请求同一页面两次。一次通过 Turbolinks 检测到资产发生了变化，然后当我们完全重定向到该页面时再一次。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-09T20:02:43.363

愚蠢的错误 - 在我的 css 中有一个导航栏类的字体样式：等宽。清除后，一切正常 - 希望故障排除步骤对其他人有所帮助！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-09T19:54:24.513

1.  查看您的页面源并搜索字体 src。如果找不到，请跳至 3。

2.  在 rails 应用程序之外测试字体和显示代码，以确保它是资产管道。

3.  如果 src 和显示代码有效，请提供您的 application.css 和 application.js 以检查您的清单。

4.  自上次资产以来，您更改了哪些配置文件/代码：预编译无法正常工作。

我的类似问题：[Bootstrap、jQuery 和 Rails 资产管道](https://stackoverflow.com/questions/14243211/bootstrap-jquery-and-the-rails-asset-pipeline)