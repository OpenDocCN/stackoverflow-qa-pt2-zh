# StackOverflow 问答 12830000-12830999

# android - Android 示例错误

> ID：12830000
> 
> 赞同：1
> 
> 时间：2012-10-10T23:28:01.213
> 
> 标签：android, facebook, sample

我克隆了 Git Hub 存储库并将文件夹导入到 eclipse 中。我尝试使用 CM10 在我的三星 Galaxy Skyrocket 上运行所有示例，但所有应用程序都失败了。然后我在带有库存 ICS 的 Galaxy S3 和带有库存姜饼的三星 R720 上运行它，它们都以同样的方式失败了。我终于在模拟器上运行它以获得相同的结果。

以下是失败的详细信息

> 例子：
> 
> SplashActivity：不幸的是 Facebook SDK 已立即停止工作
> 
> 测试：应用程序运行但登录公共 API 错误时出错失败；
> 
> 单击登录会返回一个 facebook 主题页面，其中显示发生错误。请稍后再试。
> 
> 测试 Ui 允许我正确登录，如果我输入错误的通行证，但在 auth 出现相同的错误后会返回错误
> 
> 测试注销 注销测试失败
> 
> 流：我得到欢迎屏幕和 facebook 按钮，但单击 facebook 流按钮会导致错误不幸的是 Facebook SDK 已立即停止工作

在控制台中我一直看到 [2012-10-10 19:13:56 - facebook] 找不到 facebook.apk！

Logcat 正在产生此错误

> 10-10 19:14:38.370：E/AndroidRuntime(9061)：致命异常：主要 10-10 19:14:38.370：E/AndroidRuntime(9061)：java.lang.NoClassDefFoundError：com.facebook.android.Facebook 10 -10 19:14:38.370: E/AndroidRuntime(9061): 在 com.facebook.stream.LoginHandler$JsHandler$1.run(LoginHandler.java:71) 10-10 19:14:38.370: E/AndroidRuntime(9061) : 在 android.os.Handler.handleCallback(Handler.java:615) 10-10 19:14:38.370: E/AndroidRuntime(9061): 在 android.os.Handler.dispatchMessage(Handler.java:92) 10-10 19:14:38.370: E/AndroidRuntime(9061): 在 android.os.Looper.loop(Looper.java:137) 10-10 19:14:38.370: E/AndroidRuntime(9061): 在 android.app.ActivityThread .main(ActivityThread.java:4930) 10-10 19:14:38.370: E/AndroidRuntime(9061): 在 java.lang.reflect.Method.invokeNative(Native Method) 10-10 19:14:38.370:E/AndroidRuntime(9061): 在 java.lang.reflect.Method.invoke(Method.java:511) 10-10 19:14:38.370: E/AndroidRuntime(9061): 在 com.android.internal.os.ZygoteInit $MethodAndArgsCaller.run(ZygoteInit.java:791) 10-10 19:14:38.370: E/AndroidRuntime(9061): 在 com.android.internal.os.ZygoteInit.main(ZygoteInit.java:558) 10-10 19 ：14：38.370：E / AndroidRuntime（9061）：在dalvik.system.NativeStart.main（本机方法）

我不确定问题出在哪里。它似乎可以很好地连接到 Lib 项目。也许有一个名字 collison 因为 example 和 Lib 都有 com.facebook.android？我真的很想开始将它集成到我自己的应用程序中，但由于样本无效，我感到厌倦。诚然，这可能是我的错，我只是想先看到它工作，不，是什么意思？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-11T00:27:45.903

我想到了。我从我的工作区中删除了所有项目。

1) 我选择了导入？来自现有的 AAndroid...> 将项目复制到工作区> 完成

此时我遇到了一些奇怪的错误，请参阅![奇怪的错误](../Images/b57b22b4f5a9943eb62b9ad34ce823ed.png)

2）项目>清除所有；

3）项目>构建全部；

现在我有很多错误。![]tonoferrors [2](https://i.stack.imgur.com/hkxpt.png)

因此，我浏览了其中一个错误，并尝试通过选择 Fix Project SEtup 来解决![在此处输入图像描述](../Images/4dfa5a87f565353b08f26856f8eea31f.png)

**

*   > *   *重要的！！！！*

** 我有两个选择。添加项目 facebook 并添加存档 facebook.jar。我第一次选择第一个错误消失了，项目处于我第一篇文章中描述的状态。您必须先点击第二个（添加 facebook.jar）。然后再做一次，唯一的选择是添加存档 facebook，做吧。错误仍然存​​在。

我做了最后的清理和构建，hackbooked 工作完美。每个项目每个功能。没有签名没有BS。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-05-25T05:29:27.663

我也遇到了这个问题，没有一个帖子解决了这个问题。在阅读了几个答案后，它开始测试一切。所以，我在这里编译了完整的解决方案：这对我有用。

当您使用新的 adt 17 时，您需要 Android.support.v4 来自 facebook 的示例已经添加了它。

1 - 从您的项目库文件夹中删除它。（如果它在那里） 2 - 去构建路径并将其从库中删除 3 - 去添加 Jars... 并**从 facebook sdk 项目**中选择 jar Android.support.v4 。4 - 在订单/导出选项卡下检查它。5 - 检查 android 依赖项和 android 私有库 6 - 清理您的项目。

没有更多的错误:)

谢谢大家。这是大量阅读的结果。rsrs。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-10T23:41:20.783

你必须签署你的申请。我认为以下教程将帮助您在应用程序中使用 FB。

[https://developers.facebook.com/docs/mobile/android/build/](https://developers.facebook.com/docs/mobile/android/build/) https://developers.facebook.com/docs/mobile/android/hackbook/

# maven - Maven 原型不使用属性来创建模块名称

> ID：12830002
> 
> 赞同：8
> 
> 时间：2012-10-10T23:28:02.587
> 
> 标签：maven, maven-archetype

我创建了一个原型，您可以在其中使用必需的属性 moduleName 设置 moduleName（或期望），这是原型元数据 xml（减少，我也尝试过类似的结果）

```
<?xml version="1.0" encoding="UTF-8"?>
<archetype-descriptor name="modules-archetype">

  <requiredProperties>
    <requiredProperty key="moduleName">
    </requiredProperty>
  </requiredProperties>

  <modules>
    <module id="modules-${moduleName}-api" 
            dir="modules-__moduleName__-api" 
            name="modules-${moduleName}-api">
      <fileSets>
        <fileSet encoding="UTF-8">
          <directory>src/main/java</directory>
        </fileSet>
      </fileSets>
    </module>
  </modules>

</archetype-descriptor> 
```

安装生成后，moduleName 值没有在目录名或artifactid 中使用，结果值为

```
For the directory:        project/module-__moduleName__-api
For the pom/artifactId:   module-${moduleName}-api 
```

该值在项目的其他一些文件上被正确替换，所以我猜没有拼写问题。

我见过很多类似的东西，但它们都使用 rootArtifactId，事实上，如果我使用 rootArtifactId（作为名称的开头部分），它会按预期工作。

找不到类似的问题，知道为什么它不起作用，或者如何使它起作用？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-18T15:10:03.147

我找到了一个合理的解决方法。

似乎您只能使用**rootArtifactId的唯一地方是****原型描述符**中的 **`<module>`**元素，但在其他所有地方您都可以毫无问题地使用**moduleName属性。**

 ****我做了什么：

在中使用**${moduleName}**

*   模块的 pom 中的 artifactId
*   一些默认依赖项
*   主 pom 中的模块定义 `(<module>module-${moduleName}</module>)`
*   等等

使用 **__ *moduleName* __**在

*   src/main/java & 资源中的包名

在**工件描述符中**

*   使用类似于 module-sample1 和 module-sample2 的修复模块名称（当然，以相同的方式命名工件资源中的目录）。

**创建项目后**要修复的问题****

 **1.  模块的目录名称
2.  取出主pom中包含module-sample[12]的模块元素

所有这些都在一个嵌入在 postcreate-pom.xml 中的 ant 脚本中，以便在项目创建后运行。

它工作顺利。

希望它对某人有用。

感谢所有花时间阅读我的问题的人，tonio。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2015-03-17T16:29:04.027

archetype-metadata.xml 和子模块的 pom.xml：

```
<?xml version="1.0" encoding="UTF-8"?>
<archetype-descriptor name="multi-module">

  <modules>
    <module name="${rootArtifactId}-ria" id="${rootArtifactId}-ria" dir="__rootArtifactId__-ria">
      <fileSets>
        <fileSet filtered="true" packaged="true">
          <directory>src/main/java</directory>
          <includes>
            <include>**/*.java</include>
          </includes>
        </fileSet>
        <fileSet filtered="true" packaged="true">
            <include>pom.xml</include>
        </fileSet>
      </fileSets>
    </module>
  </modules>

</archetype-descriptor> 
```

```
<project xmlns="http://maven.apache.org/POM/4.0.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd">
  <modelVersion>4.0.0</modelVersion>

  <parent>
    <groupId>${groupId}</groupId>
    <artifactId>${rootArtifactId}</artifactId>
    <version>${version}</version>
  </parent>

  <artifactId>${artifactId}</artifactId>
  <packaging>war</packaging>

</project> 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-10-11T14:52:09.140

查看 maven-archetype 源（2.2 版），似乎唯一可能使用的值是从 DefaultFilesetArchetypeGenerator 中提取的 rootArtifactId

```
 while (subprojects.hasNext() ) {

        ModuleDescriptor project = subprojects.next();

        File moduleOutputDirectoryFile = new File( outputDirectoryFile
             , StringUtils.replace( project.getDir()
                   , "__rootArtifactId__"
                   , rootArtifactId 
                   ));
        ........... 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-05-13T16:58:51.457

从项目生成原型后，编辑文件`target\generated-sources\archetype\src\main\resources\META-INF\maven\archetype-metadata.xml`.

添加

```
 <fileSet filtered="true" packaged="true" encoding="UTF-8">
      <directory></directory>
      <includes>
        <include>pom.xml</include>
      </includes>
    </fileSet> 
```

这将使它过滤您的 pom 文件！然后`mvn install`再次运行。******

# networking - 是否在路径中的每个路由器上检查 IP 校验和？

> ID：12830003
> 
> 赞同：5
> 
> 时间：2012-10-10T23:28:16.450
> 
> 标签：networking, ip

IP校验和必须在目的地明确检查。但是校验和是否被它通过的每一个路由器验证？

如果发现校验和不正确，路径中间的路由器是否会丢弃打包？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-10-11T00:56:57.133

[RFC 791](http://www.ietf.org/rfc/rfc791.txt)说：

> 如果标头校验和失败，则检测到错误的实体立即丢弃互联网数据报。

然后：

```
Header Checksum:  16 bits

    A checksum on the header only.  Since some header fields change
    (e.g., time to live), this is recomputed and verified at each point
    that the internet header is processed. 
```

`IP header checksum`因此，在对接收到的数据包采取任何行动之前，必须在网络层（第 3 层）的任何实体进行检查。

# iphone - iOS 6 上的 StatusBar 和 RootViewController

> ID：12830006
> 
> 赞同：1
> 
> 时间：2012-10-10T23:28:29.807
> 
> 标签：iphone, ios

我的应用已经运行了好几年了，但是随着 iOS 6 的发布出现了一些问题，其中之一是 StatusBar 方向的问题。

我的应用程序可以在任一横向方向上工作，但在两个方向之一中，触摸垂直偏离状态栏的宽度。直观地说，即使状态栏图像在旋转过程中被正确地重新定位，状态栏的逻辑位置也没有改变——因此会消耗屏幕错误一侧的触摸。

在我的 Info.plist 文件中，“UIStatusBarHidden”设置为 FALSE。在我的 App Delegate 的“didFinishLaunchingWithOptions”函数中，我创建了自己的自定义 ViewController 并将其设置为 Window 的 RootViewController。尽管这在 iOS 6 之前有效，但我相信此时状态栏没有“转移”到新的 RootViewController。

我推测，在 iOS 6 之前，我的代码可以工作，因为方向更改会传播到 OLD RootViewController 并导致方向按预期工作。由于 iOS 6 不再将方向传播到 NEW RootViewController 之外，因此 OLD 控制器（“逻辑上”包含 StatusBar）从未得到更新。

注意：我的应用程序没有 .XIB 文件，并且在此之前没有显式创建 RootViewController。但我认为无论如何在幕后为我创建了一个默认值。

我的“解决方案”是在 Info.plist 文件中将“UIStatusBarHidden”设置为 TRUE，并在设置自定义 RootViewController 之后的某个时间点在代码中手动将其设置为 FALSE。这似乎有效，但我可能已经解决了症状而不是实际问题。

我也担心副作用，因为除了 StatusBar 之外的其他东西在逻辑上仍然可能与旧/隐式 RootViewController 相关联，并且它们也不会“转移”到新的。

有没有人对 StatusBar 和/或 RootViewController 有类似的经验？这种方法可以吗，还是我应该保留默认/隐式 RootViewController 并以某种方式将我的 ViewController 添加到它作为一个孩子？两年前我第一次编写代码时，这似乎不起作用，这导致了我目前的实现。

以下是问题中代码的亮点。提前感谢您的建议。

-BT

```
// ******** Info.plist value *********
<key>UIStatusBarHidden</key>
<true/>

// ******** App Delegate **********
- (BOOL)application : (UIApplication *)application didFinishLaunchingWithOptions : (NSDictionary *)launchOptions
{
    CGRect rect = [[UIScreen mainScreen] applicationFrame];
    rect.origin.x = 0;  rect.origin.y = 0;
    self.window = [[[UIWindow alloc] initWithFrame:rect] autorelease];

    self.gameViewController = [[[GameViewController alloc]init] autorelease];
    self.gameView = [[[GameView alloc] initWithFrame:rect] autorelease];
    [self.gameViewController.view addSubview : self.gameView];
    [self.window setRootViewController:self.gameViewController];

    // Setting it now attaches it to our actual RootViewController instead of the
    // "phantom" controller created under the hood?
    [UIApplication sharedApplication].statusBarHidden = NO;

    // ...
} 
```

# matlab - matlab中矩阵的变换函数

> ID：12830008
> 
> 赞同：1
> 
> 时间：2012-10-10T23:28:36.760
> 
> 标签：matlab, matrix, transformation

我在 Matlab 中有 2 个矩阵，`A`并且`B`，我正在尝试找到一种简单的方法来接收这些矩阵并输出一个映射`A`到的函数`B`，它应该与`B=Ax+y`where`x`和`y`是静态数字形式的函数一样简单，但我不能似乎记得我今天的基本数学技能。在 Matlab 中是否有一种简单的方法可以做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-10T23:51:07.900

*编辑*

这是评论中解释的OP原始问题的答案。

取两个元素`b1`and `b2`from`B`和相同的元素`a1`and `a2`from `A`。一定要`a1 ~= a2`。如果 的所有元素`A`都相同，那么问题是微不足道的。然后计算

```
x = (b1-b2) / (a1-a2) ;
y = b1 - a1*x;
err = B - A*x - y;
total_error = sum(abs(err(:))); 
```

如果`x`和`y`不满足等式，则`total_error > 0`和 不存在这样的`x`和`y`。

* * *

实际上，如果 x 和 y 只是数字，你可以这样做

```
B = A*x + y; 
```

Matlab 能够通过将数字广播`x`到`A`.

如果`x`是一个向量并且`A*x`有意义，你也可以这样做。

如果`y`是与 大小相同的标量或向量`A*x`，您也可以这样做。

# javascript - r.js 优化器是否创建了引用构建文件的新 index.html 文件？

> ID：12830013
> 
> 赞同：0
> 
> 时间：2012-10-10T23:29:00.547
> 
> 标签：javascript, node.js, requirejs

当我使用 r.js 优化我的项目时，如何让它生成一个 index.html 文件，其中只包含一个脚本（我的优化脚本）和一个 css 文件（我优化​​的 css）？这是我需要在构建后自己编写的东西吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-11T02:11:21.280

`r.js`不要内置此选项。但是使用完整的堆栈构建工具，这是可以实现的。我建议`grunt.js`这样做（尽管您可能想看看如何为此创建自定义 grunt 任务）。

# aviarc - 调试 Aviarc 应用程序时出现 404 错误

> ID：12830016
> 
> 赞同：0
> 
> 时间：2012-10-10T23:29:16.090
> 
> 标签：aviarc

我打开 Aviarc 调试器并从列表中选择我的应用程序。我在工作流中设置了一个断点，然后我运行到下一个屏幕、工作流、断点。

我收到 404 错误。我的应用程序自己运行良好。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-10T23:33:18.427

我的应用程序只能从工作流 url 访问。根 url 无法运行，因此出现 404。

我不必从应用程序列表中选择我的应用程序，而是将完整的 URL 放在初始调试器屏幕上的“要调试的 URL”字段中。问题解决了。

# c# - microsoft.visualbasic.fileio 不存在

> ID：12830017
> 
> 赞同：41
> 
> 时间：2012-10-10T23:29:47.867
> 
> 标签：c#, .net

我在 .NET Framework 4.0 上，在 VisualStudio 2012 中构建 C# Web 应用程序。我添加了 Microsoft.VisualBasic 作为对项目的引用。我在使用以下代码行时遇到问题：

使用 Microsoft.VisualBasic.FileIO；

构建解决方案返回错误：命名空间“Microsoft.VisualBasic”中不存在类型或命名空间名称“FileIO”（您是否缺少程序集引用？）

我已删除并重新添加了对 Microsoft.VisualBasic 程序集的引用，但仍然出现错误。Microsoft.VisualBasic 以及 Microsoft.VisualBasic.Compatibility、Microsoft.VisualBasic.Compatibility、Microsoft.VisualBasic.PowerPacks.Vs 和 Microsoft.VisualBasic.Vsa 都在 GAC 中。

请让我知道如何让 VS2012 识别 FileIO 命名空间。

* * *

## 回答 #1

> 赞同：71
> 
> 时间：2013-06-17T11:16:38.277

1.  右键单击您的项目并选择添加引用...

2.  在 Reference Manager 中，展开 Assemblies 并选择 Framework。然后选中 Microsoft.VisualBasic 复选框并单击确定。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2019-10-06T14:45:37.740

我有类似的问题，通过将 TargetFramework（在 .csproj 中）从**netstandard2.0更改为****netcoreapp3.0**来解决。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2019-12-06T16:50:21.647

应用程序引用不可用于应用程序中的未编译文件（aspx、ashx）。此问题有两种解决方案，如下所示：

1) 将您的代码移动到应用程序的已编译部分（cs/vb 文件）

或者

2）添加对网络配置的引用

我的参考资料在 ashx 文件中。我只是将 ashx 文件中的代码复制到剪贴板，从项目中删除文件，添加一个新的通用处理程序（在 Visual Studio > 添加 > 通用处理程序中单击鼠标右键），输入与以前相同的名称，然后粘贴来自将剪贴板放到 Visual Studio 打开的 cs 文件编辑器中。我现在有一个 cs 文件，它将与项目一起编译并使用项目引用。文件名相同，因此无需更新任何其他内容——只需重新构建和部署即可。

# mysql - 查询时如何限制/混淆 MySQL 值

> ID：12830025
> 
> 赞同：1
> 
> 时间：2012-10-10T23:30:24.747
> 
> 标签：mysql, api, obfuscation

因此，我正在构建一些 API，用户可以在其中以只读访问权限查询我的数据库。但是，我想阻止某些字段，特别是 IP 地址。我目前`preg_replace`在 PHP 中使用来匹配和切换 IP，但我觉得有人可以通过巧妙的字符串拆分 MySQL 函数来解决这个问题。

有没有办法可以阻止/替换/混淆这个只读 MySQL 用户的特定字段？

记录将位于（table.field）：

```
`TrafficIp`.`Value` 
```

他们可能使用的示例查询是

```
SELECT COUNT(*) Hits, Value IpAddress
FROM TrafficIp
INNER JOIN Traffic
ON Traffic.IpId = TrafficIp.Id
GROUP BY Value
ORDER BY Hits DESC 
```

我将如何诱饵和切换？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-10T23:32:11.157

您可以[创建一个省略 IP 地址字段的表*视图*](https://dev.mysql.com/doc/refman/5.0/en/create-view.html)，并让 API 用户查询该视图，而不是基础表。

实际上，与其尝试在查询的后端进行“损害控制”，您的 API 应该在查询进入数据库*之前*对其进行过滤。仅将来自外部世界的原始 SQL 查询传递到您的数据库中是非常不可取的。

# c++ - 如何在带有向量作为值类型的地图中添加值？

> ID：12830026
> 
> 赞同：0
> 
> 时间：2012-10-10T23:30:33.463
> 
> 标签：c++, stl, map, vector

概述：我有一些代码遍历字符串列表（名称）以查找每个字符串的最后一个字符。我还有一个 myGraph typedef 映射，它接受一个结构作为值类型。该结构包含向量 nodeext 和向量 next_cnt。

要做的事情：每次在地图中插入新字符时，我都需要将向量 nextwt_vec 初始化为空向量。

问题：使用下面的代码，我的 nextwt_vec 保留了前一个字符的旧值。

```
 map<char, vector<int> > nextmap;

 for (myGraph::const_iterator j = graph.begin(); j != graph.end(); ++j)
 {
    vector<int> nextwt_vec;
    //populating next map with char and weighted ints
    for (int p=0; p< (int) (*j).second->nodenext.size(); ++p)
    {

        char cn = name[name.length() - 1];

        int wt = (*j).second->next_cnt[p];

        nextwt_vec.insert(nextwt_vec.begin()+p, wt);

        //puts char as key and weighted int as value in nextmap
        n->nextmap[cn] = nextwt_vec;

    } 
```

输出：我得到什么：

```
char: A   vec: 109 
char: C   vec: 109 vec: 48 
```

我应该得到的输出：

```
char: A   vec: 109
char: C   vec: 48 
```

谢谢你的帮助！！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-10T23:54:19.407

删除向量 nextwt_vec; 来自函数的变量。直接使用 nextmap[cn]。替换这两行：

```
 nextwt_vec.insert(nextwt_vec.begin()+p, wt);

    //puts char as key and weighted int as value in nextmap
    n->nextmap[cn] = nextwt_vec; 
```

有了这个：

```
 //puts char as key and weighted int as value in nextmap
    n->nextmap[cn].insert(nextwt_vec.begin()+p, wt);; 
```

# android - 了解使用 ContentUris.appendId 查询日历提供者

> ID：12830027
> 
> 赞同：2
> 
> 时间：2012-10-10T23:30:43.817
> 
> 标签：android, android-contentprovider

我正在处理的代码列出了日历中的事件，我需要限制日期范围，在示例中我看到了这段代码：

```
// Construct the query with the desired date range.
Uri.Builder builder = Instances.CONTENT_URI.buildUpon();
ContentUris.appendId(builder, startMillis);
ContentUris.appendId(builder, endMillis); 
```

我不明白为什么以这种方式使用 appendId。startMillis 和 endMillis 不是 id，我希望必须提供参数名称，例如 "startdate" ，我不清楚这为什么有效，以及可以通过这种方式指定哪些其他参数。appendedId 是否支持更多参数？我怎么知道？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-09T18:43:45.417

appendId 实际所做的是将 a 添加`/#`到您的 uri 中，其中 # 是一个数字。在您的示例中（假设`startMillis = 1000`and`endMillis = 3000`和 uri `content://com.google.calendar/`），这意味着您的 uri 可能会像这样结束：

```
content://com.google.calendar/1000/3000 
```

这是 uri 解析器可以拾取的东西：

```
URIMatcher.addURI(AUTHORITY, calendar + "/#/#", DATE_RANGE); 
```

长话短说：appendId 只是一种方便且类型安全的方式，可以将整数添加到 uri 路径。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-08-21T06:22:09.777

我也一直在尝试更多地了解 ContentUris，因为我有一段代码在 CalendarContract Instances 表中不起作用。这很奇怪，因为我不需要为我开发的日历或事件表查询传递这些信息。

因此，我添加了 appendId 语句，并以 UTC 格式为两个值传递了当前时间，代码现在可以工作了。我的代码中的实际查询是使用当前时间来查找当前事件 - 请参阅下面的代码。如果我取出 appendID 语句，则会引发异常 - 我认为它类似于找不到内容提供程序 URL。

```
String instanceQuery = "EVENT_ID = " + event_id + 
                    " AND begin <= " + now +
                    " AND end >= " +  now;

Uri.Builder eventsUriBuilder = CalendarContract.Instances.CONTENT_URI.buildUpon();
ContentUris.appendId(eventsUriBuilder, now);
ContentUris.appendId(eventsUriBuilder, now);
Uri eventsUri = eventsUriBuilder.build();
Cursor instanceCursor = null; 
instanceCursor = ctx.getContentResolver().query(eventsUri, 
    new String[] {  CalendarContract.Instances.EVENT_ID,
    CalendarContract.Instances.BEGIN,
    CalendarContract.Instances.END},
    instanceQuery,
    null,
    null); 
```

我的代码正在运行，但我想知道 appendID 语句实际上有什么影响，例如这些值是否添加了任何约束。看起来我的实际查询覆盖了传入的任何隐含范围，我真的不明白为什么需要它们。

希望更了解这一点的人的简短解释将使开发人员社区受益......

# prolog - 比较 prolog 匿名变量

> ID：12830029
> 
> 赞同：1
> 
> 时间：2012-10-10T23:30:48.130
> 
> 标签：prolog, prolog-anonymous-variable

我在序言中有一系列包含匿名变量的事实`_`。

```
fact(a, _).
fact(b, _).
fact(c, _). 
```

我有一些规则可以列出这些事实：

```
f([H | T]) :- H == fact(a, _),
              % stuff %
              . 
```

但是，这是行不通的。该规则不超过第一个子句`H == fact(a, _)`。我究竟做错了什么？是否有不同的相等运算符？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-10T23:37:54.737

是的，您可能应该使用`=/2`：

```
1 ?- H == fact(a,_).
false.

2 ?- H = fact(a,_).
H = fact(a, _G0). 
```

不同之处在于`==/1` *检查*这两个术语是否相等，并且未实例化的变量（具有不同的名称）被视为不同。另一方面，`=/2`统一这两个术语，根据需要进行实例化。

如果您在 head ( ) 中使用实例化模式，`f([fact(a,_)|T]):- stuff.`它的行为与`=/2`

# php - 根据数据库中动态加载的图像更改 DIV 大小

> ID：12830030
> 
> 赞同：0
> 
> 时间：2012-10-10T23:31:05.663
> 
> 标签：php, javascript, jquery, css, dynamic

我有一个我正在研究的在线作品集，我在 JQuery 和 PHP 方面都很新，但我正在努力解决所有问题，但是这个让我很难过。

所以，我有一个无缝的 iframe 用于从导航加载我的图像，我正在尝试构建它以便图像全部水平排列，通常我会加载所有内容并动态更改浏览器视口的包装，但是因为图像是来自服务器端的 PHP 脚本/mySQL 数据库，我不确定如何更改任何图像或 div 内容。

在用户选择要查看的投资组合后，所有内容都在 While 循环中加载。

这是一个链接：[http ://tbremer.com](http://tbremer.com)

任何帮助将不胜感激！

让我知道还需要什么其他信息！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-10T23:44:28.470

可以从服务器获取图像的宽度和高度。前任：

$image_data = getimagesize(PATH_TO_IMAGE); var_dump($image_data);

更好的是，您可以使用“列表”来检索宽度和高度：

列表（$宽度，$高度）= getimagesize（PATH_TO_IMAGE）；

然而，数组的前两个返回值是宽度然后是高度，然后它们设置变量，奇怪的是 $width 和 $height，您可以使用它们来重新调整 iframe 的大小。

# ruby-on-rails - Rails - 在模型规范中设计测试认证

> ID：12830034
> 
> 赞同：1
> 
> 时间：2012-10-10T23:31:33.163
> 
> 标签：ruby-on-rails, ruby-on-rails-3, authentication, devise

我觉得这应该是一个简单的问题，但我一直在努力寻找答案。我已经在我的 Rails 项目中设置了身份验证设计，并且效果很好。我还自定义了密码验证和登录要求。具体来说，一个人应该能够使用他们的用户名或电子邮件登录，并且电子邮件不应该区分大小写。

如何在我的模型规格中进行测试？具体测试：

1.  使用电子邮件登录（全部较低）和密码有效
2.  使用邮箱登录（全部为大写），密码有效
3.  使用用户名和密码登录是有效的
4.  使用用户名（大小写混乱）和密码登录无效

基本上，我只需要一个函数来接收登录详细信息并告诉我设计是否会对其进行身份验证。但是我在任何示例中或在设计文档中构造此类函数的任何方式中都找不到这样的函数。

我相信它确实在工作，并且可以在我的请求规范中对其进行测试，但正如它在模型中定义的那样，感觉它们也应该是模型测试。

我经常发现的唯一设计测试是在控制器中，这无济于事，因为它只是自动登录用户而不需要登录详细信息。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-10T23:55:07.440

好吧，这里有两个不同的组件：

1) 查找用户
2) 验证用户密码

查找用户由`find_for_database_authentication`（[有关“登录”处理用户名和电子邮件的信息](https://github.com/plataformatec/devise/wiki/How-To%3a-Allow-users-to-sign-in-using-their-username-or-email-address)）处理

密码验证由`valid_password?`方法 ( [info](http://rubydoc.info/github/plataformatec/devise/master/Devise/Models/DatabaseAuthenticatable#valid_password?-instance_method) )处理

所以，你想把这个测试分解成：

```
context "finding a user" do
  let(:user) { FactoryGirl.create(:user) }

  it "can find by lower email" do
    User.find_for_database_authentication( {login: user.email.downcase} ).should eq(user)
  end

  it "can find by upper email" do
    User.find_for_database_authentication( {login: user.email.upcase} ).should eq(user)
  end

  it "can find by jumbled username" do
    scrambled_username = user.username.downcase.chars.map{|c| rand() > 0.5 ? c.capitalize : c}.join
    User.find_for_database_authentication( {login: username} ).should eq(user)
  end
end

context "authenticating a user" do
  let(:user) { FactoryGirl.create(:user, password: "password123", password_confirmation: "password123") }

  it "will validate a correct password" do
    user.valid_password?("password123").should be_true
  end
  it "will not validate an incorrect password" do
    user.valid_password?("bad-password").should be_false
  end
end 
```

# ios - iOS 升级到 twitter api 1.1

> ID：12830037
> 
> 赞同：6
> 
> 时间：2012-10-10T23:31:57.820
> 
> 标签：ios, api, twitter, oauth, twitter-oauth

我目前有一堆应用程序可以对 twitter API 进行简单的匿名调用，并获取几个不同的时间线。显然，twitter 正在使用 1.1 进行更改，并要求使用 oauth 进行身份验证调用。这是否意味着我的每个用户都需要一个令牌（他们自己的帐户）才能进行通话，或者我是否需要一个应用令牌给他们所有人？我应该使用 iOS 5 附带的 twitter api 吗？注意：这些不是用户的时间线……只是推特上的几个新闻提要。我有点困惑。任何指针将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-06-26T05:20:24.703

这是一个很好的问题，我自己也在为此苦苦挣扎。

您可以通过 PHP 使用 Twitter API 客户端，然后 json_encode 您想要的用户时间线并对其进行解析。这不是最佳实践，但对于我只想显示不需要其他操作（例如获取链接、转发等）的推文的应用程序，这是我必须做的一项工作。

希望这有用。

# php - 用数组php中的空值替换空字符串

> ID：12830039
> 
> 赞同：15
> 
> 时间：2012-10-10T23:32:06.553
> 
> 标签：php, arrays, replace

对不起，我对这个问题进行了很多研究。是否有搜索和替换数组元素的标准函数？

str_replace 在这种情况下不起作用，因为我想搜索的是一个空字符串 '' 我想用 NULL 值替换它们

这是我的数组：

```
$array = (
    'first' => '',
    'second' => '',
); 
```

我希望它变成：

```
$array = (
    'first' => NULL,
    'second' => NULL,
); 
```

当然我可以创建一个函数来做到这一点，我想知道是否有一个标准函数可以做到这一点，或者至少是一个“单行解决方案”。

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2012-10-10T23:35:20.900

我不认为有这样的功能，所以让我们创建一个新的

```
$array = array(
   'first' => '',
   'second' => ''
);

$array2 = array_map(function($value) {
   return $value === "" ? NULL : $value;
}, $array); // array_map should walk through $array

// or recursive
function map($value) {
   if (is_array($value)) {
       return array_map("map", $value);
   } 
   return $value === "" ? NULL : $value;
};
$array3 = array_map("map", $array); 
```

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2012-10-10T23:34:37.893

据我所知，没有标准功能，但您可以执行以下操作：

```
foreach ($array as $i => $value) {
    if ($value === "") $array[$i] = null;
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2021-05-21T11:32:56.977

现在您也可以使用箭头功能：

```
$array = array_map(fn($v) => $v === '' ? null : $v, $array); 
```

# jquery - jQuery 在 last / 之后将文本插入字符串

> ID：12830040
> 
> 赞同：0
> 
> 时间：2012-10-10T23:32:07.663
> 
> 标签：jquery, string

我有一个网址：

[http://test.com/backgrounds/testimage.jpg](http://test.com/backgrounds/testimage.jpg)

我需要在文件名的开头插入一个“t_”，结果是：

[http://test.com/backgrounds/t_testimage.jpg](http://test.com/backgrounds/t_testimage.jpg)

在 jQuery 中执行此操作的最简单方法是什么？谢谢你的帮助 ：）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-10T23:39:20.490

使用正则表达式替换查找最后一个“/”并将其替换为“/t_”。使用转义符很难阅读，但是：

```
"http://test.com/backgrounds/testimage.jpg".replace(/\/([^\/]*)$/, "/t_$1"); 
```

用您想要操作的任何其他字符串或变量交换字符串。如果您想要更多控制权或只是更喜欢可读性，则可以使用某些东西来解析 URL。

或者，您也可以从模式和替换中删除“/”。我希望 JS 有一个非正则表达式 replaceLast，但似乎并非如此。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-10T23:39:47.297

甚至不需要 jQuery...

```
var derp = 'http://test.com/backgrounds/testimage.jpg';
var split_derp = derp.splitOnLast('/');
var new_derp = split_derp[0] + '/t_' + split_derp[1].slice(1); 
```

必须有一种更紧凑/更快的方式，但我认为这应该可行。

# android - 无法使用远程服务器数据库中的数据填充 Spinner

> ID：12830043
> 
> 赞同：4
> 
> 时间：2012-10-10T23:32:28.287
> 
> 标签：android, mysql, database

我试图弄清楚如何使用从远程 MySQL 数据库中获取的数据填充 Spinner（最终是一种完整的微调器）。我已经阅读了数百个示例，并试图将它们全部复制，但无济于事。

我一直在使用来自[http://www.mickyjay.co.uk/blog/?p=679](http://www.mickyjay.co.uk/blog/?p=679)的这个例子， 我从来没有让它工作，但它似乎是最有希望的。

问题：

1) 我需要使用 JDBC 桥接器连接到服务器吗？（我在读到 Android 没有附带一个库来连接到远程服务器）。

2）我不是在找人为我做这件事。如果有人有任何指向清晰且有据可查的资源的链接。我将非常感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-10T23:52:12.787

由于您拥有 MySql 数据库，因此最好使用 PHP 连接到数据库并使用 JSON 响应将结果发送回 android。Android 和 PHP 都支持 JSON。然后，您可以在 android 端根据需要读取 JSON 和处理数据。您使用 HTTP 请求来运行 php 脚本。看看这个教程，它展示了如何一起使用 android、PHP 和 MySql [http://www.androidhive.info/2012/01/android-login-and-registration-with-php-mysql-and-sqlite/](http://www.androidhive.info/2012/01/android-login-and-registration-with-php-mysql-and-sqlite/)

# python - 用于 HTML 的非 unicode 和非 ascii 的 python 中的综合字符替换模块

> ID：12830047
> 
> 赞同：1
> 
> 时间：2012-10-10T23:33:11.937
> 
> 标签：python, unicode, character-encoding, string-decoding

python 是否有一个全面的字符替换模块，可以在字符串中查找所有非 ascii 或非 unicode 字符并将它们替换为 ascii 或 unicode 等效项？在编码或解码期间对“忽略”参数的这种安慰是疯狂的，但同样也是如此。在非翻译字符所在的每个地方。

我正在寻找一个能够找到令人讨厌的字符并使它们符合任何要求的标准的模块。我意识到现存的字母和编码的数量使得这有点不可能，但肯定有人尝试过吗？即使是一个初步的解决方案也会比现状更好。

这意味着数据传输的简化是巨大的。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-17T22:50:36.953

我不认为你想要什么是真的可能 - 但我认为有一个不错的选择。

unicodedata 有一个“规范化”方法，可以为您优雅地降级文本......

```
import unicodedata
def gracefully_degrade_to_ascii( text ):
    return unicodedata.normalize('NFKD',text).encode('ascii','ignore') 
```

假设您正在使用的字符集已经映射到 unicode - 或者至少可以映射到 unicode - 您应该能够使用此模块将该文本的 unicode 版本降级为 ascii 或 utf-8（它是标准的一部分图书馆也是）

完整文档 - [http://docs.python.org/library/unicodedata.html](http://docs.python.org/library/unicodedata.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-11T00:06:05.707

查看任何单个字符并猜测其编码将很难并且可能不是很准确。但是，您可以使用 chardet 来尝试检测整个文件的编码。然后您可以使用字符串 decode() 和 encode() 方法将其编码转换为 UTF-8。

[http://pypi.python.org/pypi/chardet](http://pypi.python.org/pypi/chardet)

而且 UTF-8 向后兼容 ASCII，所以这没什么大不了的。

# php - 带有 ajax 注入的 html 选择器的 jQueryUI 对话框

> ID：12830048
> 
> 赞同：1
> 
> 时间：2012-10-10T23:33:12.227
> 
> 标签：php, jquery-ui, jquery

下面的所有代码都是我正在尝试做的一个独立的工作示例（大大简化）。如果有人将以下代码块复制/粘贴到 3 个单独的文件中，则代码是完全独立的——只需记住在文档顶部的脚本标记中引用/包含 test5.js 和 jquery 库。

**摘要：**通过 Ajax 注入的 HTML div 未在 jQuery UI 对话框小部件中打开。

**目标：**在文档加载时，jquery-ajax 会注入一个 html 表单（最终，它将从 DB 中检索适当的表单值，这就是 ajax 的原因）。带有 id="clickme" 的 div 与 html 一起注入。单击 div 应打开对话框。

**问题：** jQueryUI .dialog 没有出现。我在点击事件中放置了一个警告框，然后触发。但对话仍然难以捉摸。

因此，问题似乎是 HTML 被注入的事实。我错过了什么？

HTML：索引.php

```
<div id="putit_here">
</div> 
```

* * *

JAVASCRIPT/JQUERY：test5.js

```
$(function() {

    var pih = $('#putit_here');

    $.ajax({
        type: "POST",
        url: "ajax/ax_test5.php",
        data: 'contact_id=1',
        success:function(data){
            pih.html(data);
            var etc1 = $( "#editThisContact_1" );
    /* *****************************************************************
        Moving Dialog up >here< was correct answer.
    ********************************************************************
            etc1.dialog({
                autoOpen: false,
                height: 400,
                width: 600,
                modal: true,
                buttons: {
                    Cancel: function() {
                        $( this ).dialog( "close" );
                    }
                },
                close: function() {
                    alert('DialogClose fired');
                }
            }); //end .Dialog
    ****************************************************************** */

        }
    }); //End ajax

    /* **** This is where I had it previously ***** */
    etc1.dialog({
        autoOpen: false,
        height: 400,
        width: 600,
        modal: true,
        buttons: {
            Cancel: function() {
                $( this ).dialog( "close" );
            }
        },
        close: function() {
            alert('DialogClose fired');
        }
    }); //end .Dialog

    $(document).on('click', '#clickme', function(event) {
        alert('HereIAm...');
        $( "#editThisContact_1" ).dialog( "open" );
    }); //End #clickme.click

}); //End document.ready 
```

* * *

AJAX - ax_test5.php

```
 $rrow = array();
    $rrow['contact_id'] = 1;
    $rrow['first_name'] = 'Peter';
    $rrow['last_name'] = 'Rabbit';
    $rrow['email1'] = 'peter.rabbit@thewarren.nimh.com';
    $rrow['cell_phone'] = '+1.250.555.1212';

    $r = '

    <div id="editThisContact_'.$rrow['contact_id'].'" style="display:none">
            <p class="instructions">Edit contact information for <span class="editname"></span>.</p>
        <form name="editForm" onsubmit="return false;">
            <fieldset>
        <span style="position:relative;left:-95px;">First Name:</span><span style="position:relative;left:10px;">Last Name:</span><br />
            <input type="text" id="fn_'.$rrow['contact_id'].'" value="'.$rrow['first_name'].'" name="fn_'.$rrow['contact_id'].'">
            <input type="text" id="ln_'.$rrow['contact_id'].'" value="'.$rrow['last_name'].'" name="ln_'.$rrow['contact_id'].'"><br /><br />
        <span style="position:relative;left:-120px;">Email:</span><span style="position:relative;left:30px;">Cell Phone:</span><br />
            <input type="text" id="em_'.$rrow['contact_id'].'" value="'.$rrow['email1'].'" name="em_'.$rrow['contact_id'].'">
            <input type="text" id="cp_'.$rrow['contact_id'].'" value="'.$rrow['cell_phone'].'" name="cp_'.$rrow['contact_id'].'">
            </fieldset>
        </form>
    </div>
    ';
    echo $r; 
```

* * *

编辑：

更新了在 AJAX 成功回调中移动对话框定义的问题。虽然没有完全解决问题。如果我将 autoOpen 标志更改为 true，则现在会出现该对话框，但这不是脚本必须工作的方式。单击（注入的）#clickme div 后，对话框仍然没有打开。

编辑2：

我的错。起初我认为它不起作用，但后来发现我的现场测试和发布的 SO 问题在一行中有所不同：如何调用 .dialog("open")。在实时代码中，它仍在使用 var：etc1.dialog("open")——但在上面的帖子中，选择器被完全引用：$('#editThisContact_1').dialog("open")。发布的语法是正确的。感谢绅士们，还有 itachi 让我检查了 chrome 控制台。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-10T23:45:44.040

您正在尝试`dialog`在元素存在之前在元素上初始化 a 。在您的 ajax 调用成功返回*后，*您需要在“#editThisContact_1”上初始化对话框 。

像这样：

```
....
success:function(data){
        pih.html(data);

        //now your DIV is actually there so init the dialog
        var etc1 = $( "#editThisContact_1" );
        etc1.dialog({
            autoOpen: false,
            height: 400,
            width: 600,
            modal: true,
            buttons: {
                Cancel: function() {
                    $( this ).dialog( "close" );
                }
            },
            close: function() {
                alert('DialogClose fired');
            }
        }); //end .Dialog
    } 
```

# c - scanf（或）printf 中的格式说明符错误

> ID：12830052
> 
> 赞同：4
> 
> 时间：2012-10-10T23:33:50.313
> 
> 标签：c, input, printf, scanf

就`printf`功能而言，我从一些参考资料和实验中了解到以下内容。

*   当我们尝试**使用用于 float（或）double 的格式说明符**打印整数值时，反之亦然，行为是**不可预测**的。
*   但是可以`%c`用来打印整数值的等效字符。也可以使用 of`%d`打印字符的 ASCII 值（整数表示）。

`scanf`同样，如果**格式说明符和传递给 scanf 的参数不匹配**，则 的行为是什么。标准有定义吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-10T23:40:53.500

可变参数（与省略号匹配的参数`...`）是*默认提升的*。这意味着所有较短的整数类型都被提升为`int`（或无符号，视情况而定）。整数和字符之间没有区别（[我相信](https://stackoverflow.com/questions/11985774/is-char-default-promoted)）。`%d`和`%c`in之间的区别`printf`仅仅是值的*格式*。

`scanf`是一壶不同的鱼。您传递的所有参数都是*指针*。指针之间没有默认提升，传递与指针类型匹配的确切格式说明符至关重要。

在任何一种情况下，如果您的格式说明符与提供的参数不匹配（例如将 an 传递`int *`给 a `%p`in `printf`），则结果是*undefined behavior*，这比“不可预测”要糟糕得多——这意味着您的程序只是格式错误.

# javascript - 我在“联系人”中使用 appendChild；表单在提交时打印一条漂亮的消息，但消息立即消失

> ID：12830056
> 
> 赞同：0
> 
> 时间：2012-10-10T23:34:13.497
> 
> 标签：javascript, html

我正在制作一个非常基本的“联系我们”表单，我希望在表单验证成功后在页面上显示一些“感谢您的反馈”消息（而不是作为警报）。问题是，我点击了提交按钮，感谢消息出现了一瞬间然后消失了。

代码：

```
window.onload = init;

function init() 
{
document.getElementById("contactForm").onsubmit=validate;
}

function validate()
{
//if statements to appear here returning false if any conditions are met
addMessage();
return true;
}

function addMessage()
{
var p = document.getElementById("content");
var l = document.createElement("p");
var m = document.createTextNode("Thanks for your message!");

l.appendChild(m);
p.appendChild(l);   
} 
```

我究竟做错了什么？我对javascript很陌生。谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-10T23:38:37.113

您`true`在调用后返回`addMessage()`，因此显示消息，然后立即提交表单。

如果您想阻止立即提交表单，您可以使用标准`alert()`（它等待用户按下 OK 按钮）或通过返回 false 来阻止表单提交，然后`form.submit()`在用户阅读后单击某个按钮时通过调用方法显式提交表单信息。

实际上，像“感谢您的消息！”这样的消息。应显示在`action`表单属性中指定的目标页面上，并在表单已发送后加载。假设表单在尚未发送时已发送，这不是一个好主意。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-11T00:11:32.040

Firefox 15 和 IE 9 在提交表单之前都会更新 DOM，所以我看不出这是个问题。*但是无论如何，您可以通过从setTimeout*调用它来延迟提交，这样几乎可以保证 DOM 将更新以显示消息，然后将提交表单，例如

```
<script>
function validate(form) {

  var formValid = false;

  /* validatation stuff, set formValid to appropriate value, assume passed */

  formValid = true;

  if (formValid) {

    // Show message
    document.getElementById('message').style.display = '';

    // Delay submit until after message displayed
    setTimeout(function(){form.submit()}, 10);

    // Stop form submitting immediately
    return false;

  } else {

    /* form isn't valid, do whatever and cancel submission */
    return false;
  }
}
</script>

<span id="message" style="display: none">Success!!</span>
<form onsubmit="return validate(this);">
  <input type="text" name="foo" value="bar">
  <input type="submit">
</form> 
```

请注意，调用表单的提交方法不会调度 sumbit 事件，因此不会再次调用提交处理程序。这与 DOM 2 HTML 标准背道而驰，但浏览器从未遵循它。

它已在新的“活动”HTML 规范中进行了更改，因此如果提交来自表单的提交方法，则不得发送提交事件。

# javascript - IE8 - 输入 (type="file") 获取文件

> ID：12830058
> 
> 赞同：12
> 
> 时间：2012-10-10T23:34:20.687
> 
> 标签：javascript, jquery, html, internet-explorer

我在 Internet Explorer 中的输入 (type="file") 有问题（我只在 8 中测试过）。

HTML

```
<input id="drop-file-files" class="drop-file-waiting" type="file"> 
```

JS (http://code.jquery.com/jquery-latest.min.js)

```
$('#drop-file-files').change(function(e){
    $.each(e.target.files, function(index, file){
        alert(file);
    });
}); 
```

它在 Firefox、Chrome 和 Safari 中完美运行返回对象文件，但 IE 返回错误，因为 e.target 中的“文件”未定义。有人知道如何使用 JavaScript 获取这些“文件”吗？

已编辑：文档[MSDN 输入类型 = 文件](http://msdn.microsoft.com/en-us/library/ie/ms535263%28v=vs.85%29.aspx)- 仅在 IE10[文件属性中](http://msdn.microsoft.com/en-us/library/ie/hh772931%28v=vs.85%29.aspx)

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-10-10T23:37:34.237

Internet Explorer 8 不支持多个文件。这[已经在这里讨论过了](https://stackoverflow.com/questions/6207388/is-it-possible-to-select-and-upload-multiple-files-at-one-time-in-internet-explo)。您至少可以通过`e.target.value`.

# caching - How do I setup query cache results for built in doctrine2 repository functions?

> ID：12830063
> 
> 赞同：0
> 
> 时间：2012-10-10T23:34:54.993
> 
> 标签：caching, symfony, doctrine-orm

I have a site that is for a video game I play and am working on improving the performance of the site by implementing some additional caching. I've already been able to implement query result caching on custom repository functions, but haven't been able to find anywhere that explains how I can include query result caching on the built in functions (findOneById, etc). I'm interested in doing this because many of my database queries are executed from these 'native' repository functions.

So as an example I have a character entity object with the following properties: id, name, race, class, etc.

Race and class in this object are references to other entity objects for race and class. When I load a character for display I get the character by name (findOneByName) and then in my template I display the character's race/class by `$characterObject->getRace()->getName()`. These method calls in the template result in a query being run on my Race/Class entity tables fetching the entity by id (findOneById I assume).

I've attempted to create my own findOneById function in the repository, but it is not called under these circumstances.

How can I setup doctrine/symfony such that these query results are cache-able?

I am running Symfony 2.1.3 and doctrine 2.3.x

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-09T06:53:48.497

I've found out that it isn't possible to enable query cache on doctrine build in functions. I will post a link which explains why later after I find it again.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-11T01:17:30.077

Your entities probably look something like this:

```
MyBundle\Entity\Character:
    type: entity
    table: Character
    fields:
      id:
        id: true
        type: bigint
      name:
        type: string
        length: 255
    manyToOne:
      race:
        targetEntity: Race
        joinColumns:
          raceId:
            referencedColumnName: id

MyBundle\Entity\Race:
    type: entity
    table: Race
    fields:
      id:
        id: true
        type: bigint
      name:
        type: string
        length: 255
    oneToMany:
      characters:
        targetEntity: Character
        mappedBy: race 
```

If that's the case, then modify your Character entity mapping so that it eagerly loads the Race entity as well:

```
MyBundle\Entity\Character:
  ...
    manyToOne:
      race:
        targetEntity: Race
        joinColumns:
          raceId:
            referencedColumnName: id
        fetch: EAGER 
```

Doctrine documentation on the `fetch` option: [@ManyToOne](http://docs.doctrine-project.org/en/2.1/reference/annotations-reference.html#annref-manytoone)

# php - Symfony 2 和 Twig 缓存——它们是一样的吗？

> ID：12830064
> 
> 赞同：3
> 
> 时间：2012-10-10T23:35:00.200
> 
> 标签：php, caching, symfony, twig

我的问题是 Symfony 2 缓存机制和 Twig 缓存机制是否相同？

假设我决定在我的 MVC 框架中使用 Twig，我会使用 Symfony 2 使用的相同缓存机制吗？我知道 Symfony2 和 Twig 都是由 Fabien 创建的。但我不知道 Symfony 2 是仅使用 Twig 缓存还是还有更多？

所以我希望你能理解这个问题。Symfony 2 是否使用 Twig 进行缓存？如果不是，Symfony 2 和 Twig 缓存之间有什么区别？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-10-10T23:57:37.643

不确定完整的答案，但 symfony 和 twig 必须使用单独的缓存机制，因为您不必在 symfony 中使用 twig，但缓存仍然有效。有关更多信息，请查看[http://symfony.com/doc/current/](http://symfony.com/doc/current/)并深入研究代码。

* * *

编辑：扩展我上面的非答案。Twig 缓存实际上是一个编译缓存。您的模板保存为 php 文件。引用 F. Potencier “[...] Twig 缓存已编译的模板以避免后续请求的解析阶段。[...]”（[来源](https://groups.google.com/forum/?fromgroups=#!topic/twig-users/z8dcpDHxjsk)）

虽然 Symfony 缓存（如前所述）是 HTTP 缓存，但在[Symfony Docs 缓存部分中有详细说明](http://symfony.com/doc/2.0/book/http_cache.html)

希望这可以帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-11T00:26:21.370

Symfony 2 使用 HTTP 缓存来进行缓存。并且 Twig 缓存是 Twig 模板的较量缓存，因此它们不必在每个请求上重新编译。所以 Twig 缓存只确保模板在第一次请求时编译一次。

Symfony 2 HTTP 缓存是另一种野兽 :) 它提供了围绕 HTTP 缓存机制的抽象，因此您可以使用 HTTP 缓存标头等进行缓存...

所以简短的回答是否定的！他们是不一样的！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-11T15:54:25.083

不，它们不一样。Symfony 缓存了很多东西，比如路由、翻译、容器等；Twig 只是通过将模板编译成 PHP 类来缓存模板。当然，Twig 的缓存系统也可以在 Symfony 应用程序中运行。

# ruby - 从单词列表中查找给定单词中的单词的脚本

> ID：12830065
> 
> 赞同：1
> 
> 时间：2012-10-10T23:35:09.470
> 
> 标签：ruby, parsing, sed, awk

我有一本包含 25 万字的字典（txt 文件）。对于这些单词中的每一个，我想提出一个脚本，它将抛出所有可能的字谜（每个字谜也应该在字典中）。

理想情况下，脚本将以这种格式输出：

> 单词1：字谜1，字谜2...
> 
> 字2：字谜1，字谜2...

任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-10T23:57:14.180

它必须是字谜周。

我将向您推荐我提交给先前问题的答案：[https](https://stackoverflow.com/a/12811405/128421) ://stackoverflow.com/a/12811405/128421 。它展示了如何构建散列以快速搜索具有常见字母的单词。

为了您的目的，查找子字符串/内部词，您还需要找到可能的内部词。以下是如何根据起始词快速定位不同大小字母的独特组合：

```
word = 'misses'
word_letters = word.downcase.split('').sort
3.upto(word.length) { |i| puts word_letters.combination(i).map(&:join).uniq }

eim
eis
ems
ess
ims
iss
mss
sss
eims
eiss
emss
esss
imss
isss
msss
eimss
eisss
emsss
imsss
eimsss 
```

一旦你有了这些组合，将它们拆分（或不做`join`）并在我之前的答案构建的哈希中进行查找。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-11T00:01:19.997

受此启发[，](https://stackoverflow.com/questions/55210/algorithm-to-generate-anagrams)我建议您创建一个[Trie](http://en.wikipedia.org/wiki/Trie)。

然后，具有 N 个级别的 trie 将具有所有可能的字谜（其中 N 是原始单词的长度）。现在，要获得不同大小的单词，我建议您简单地遍历特里树，即。对于所有 3 个字母的子词，只需在 trie 中创建 3 级深度的所有字符串。

我不太确定，因为我没有对此进行测试，但这是一个有趣的挑战，这个建议将是我开始解决它的方法。

希望对您有所帮助 =)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-11T01:33:41.113

到目前为止我尝试了什么`Perl`：

```
use strict;
use warnings;

use Algorithm::Combinatorics qw(permutations);

die "First argument should be a dict\n" unless $ARGV[0] or die $!;
open my $fh, "<", $ARGV[0] or die $!;

my @arr = <$fh>;
my $h = {};

map { chomp; $h->{lc($_)} = [] } @arr;

foreach my $word (@arr) {
    $word = lc($word);
    my $chars = [ ( $word =~ m/./g ) ];
    my $it = permutations($chars);

    while ( my $p = $it->next ) {
        my $str = join "", @$p;

        if ($str ne $word && exists $h->{$str}) { 
            push @{ $h->{$word} }, $str
                unless grep { /^$str$/ } @{ $h->{$word} };
        }
    }

    if (@{ $h->{$word} }) {
        print "$word\n";
        print "\t$_\n" for @{ $h->{$word} };
    }
}

END{ close $fh; } 
```

速度可能有一些可能的改进，但它确实有效。

我使用包中的[法语字典](http://sputnick-area.net/scripts/french-dict.txt)`words` `archlinux`。

**例子**

```
$ perl annagrammes.pl /usr/share/dict/french
abaissent
        absentais
        abstenais
abaisser
        baissera
        baserais
        rabaisse
(...) 
```

**注意** 要安装 perl 模块：

```
cpan -i Algorithm::Combinatorics 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-11T01:06:46.373

```
h = Hash.new{[]}
array_of_words.each{|w| h[w.downcase.chars.sort].push(w)}
h.values 
```

# jquery - Gravity Forms 删除 jquery 设置时出错

> ID：12830068
> 
> 赞同：0
> 
> 时间：2012-10-10T23:35:27.940
> 
> 标签：jquery, wordpress

我有一个 jquery 脚本，它将一个选项值附加到在 Wordpress 的 Gravity Forms 中创建的下拉字段中。

我面临的问题是，一旦表单错误加载，假设您在电子邮件字段中输入了错误的电子邮件，附加值就会​​从下拉列表中消失。一旦我刷新页面，它们就会重新出现。

希望我说得通。

这是我用来附加字段的脚本。

```
<script type="text/javascript">
$(function() {
  $("#input_3_2").append("<option>Male</option>");
});
</script> 
```

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-02-08T01:22:22.407

解决此问题的另一种方法是使用重力表单事件`gform_post_render` ，如下所示：

```
jQuery(document).bind('gform_post_render',function(){ 
  /* Add Form Field Here */ $("#input_3_2").append("<option>Male</option>");
}) 
```

# eclipse - eUML2 for Eclipse：关联链接类型

> ID：12830083
> 
> 赞同：2
> 
> 时间：2012-10-10T23:37:53.540
> 
> 标签：eclipse, uml

我试图找出在 eUML2 for Eclipse 中有哪些不同类型的关联链接可用 - 是否有任何官方文档可以解释它？我一直在寻找一个小时左右，到目前为止没有运气。

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-11T11:03:55.933

我认为 eUML2 使用 org.eclipse.uml2 元模型。如果这是真的，它应该支持来自 UML 2.4 基础结构的所有关联类型。即这些是关联，关联类，组合，聚合。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-11T22:15:56.953

关联作为标签保存在 java 代码中。您可以以图形方式绘制关联并查看代码中的标记。没有可见的模型资源管理器，因此只有 java 代码可以提供此关联信息。

# http - 设置 HTTP 标头

> ID：12830095
> 
> 赞同：175
> 
> 时间：2012-10-10T23:39:13.230
> 
> 标签：http, go, cors, http-headers

我正在尝试在我的 Go Web 服务器中设置一个标头。我正在使用`gorilla/mux`和`net/http`包。

我想设置`Access-Control-Allow-Origin: *`为允许跨域 AJAX。

这是我的 Go 代码：

```
func saveHandler(w http.ResponseWriter, r *http.Request) {
// do some stuff with the request data
}

func main() {
    r := mux.NewRouter()
    r.HandleFunc("/save", saveHandler)
    http.Handle("/", r)
    http.ListenAndServe(":"+port, nil)
} 
```

该`net/http`软件包有描述发送 http 请求标头的文档，就好像它是客户端一样 - 我不确定如何设置响应标头？

* * *

## 回答 #1

> 赞同：243
> 
> 时间：2012-10-10T23:46:18.393

没关系，我想通了-我在（doh！）上使用了该`Set()`方法`Header()`

我的处理程序现在看起来像这样：

```
func saveHandler(w http.ResponseWriter, r *http.Request) {
    // allow cross domain AJAX requests
    w.Header().Set("Access-Control-Allow-Origin", "*")
} 
```

也许这会在某个时候帮助像我一样缺乏咖啡因的人:)

* * *

## 回答 #2

> 赞同：98
> 
> 时间：2014-07-18T06:37:52.177

以上所有答案都是错误的，因为它们无法处理 OPTIONS 预检请求，解决方案是覆盖 mux 路由器的接口。请参阅[AngularJS $http get request failed with custom header（在 CORS 中允许）](https://stackoverflow.com/questions/22452804/angularjs-http-get-request-failed-with-custom-header-alllowed-in-cors)

```
func main() {
    r := mux.NewRouter()
    r.HandleFunc("/save", saveHandler)
    http.Handle("/", &MyServer{r})
    http.ListenAndServe(":8080", nil);

}

type MyServer struct {
    r *mux.Router
}

func (s *MyServer) ServeHTTP(rw http.ResponseWriter, req *http.Request) {
    if origin := req.Header.Get("Origin"); origin != "" {
        rw.Header().Set("Access-Control-Allow-Origin", origin)
        rw.Header().Set("Access-Control-Allow-Methods", "POST, GET, OPTIONS, PUT, DELETE")
        rw.Header().Set("Access-Control-Allow-Headers",
            "Accept, Content-Type, Content-Length, Accept-Encoding, X-CSRF-Token, Authorization")
    }
    // Stop here if its Preflighted OPTIONS request
    if req.Method == "OPTIONS" {
        return
    }
    // Lets Gorilla work
    s.r.ServeHTTP(rw, req)
} 
```

* * *

## 回答 #3

> 赞同：24
> 
> 时间：2013-12-20T09:43:27.657

在您确实需要完全公开的行为之前，请勿使用 '*' 作为 Origin。
正如[维基百科所说](http://en.wikipedia.org/wiki/Cross-origin_resource_sharing)：

> ““*”值的特殊之处在于它不允许请求提供凭据，即 HTTP 身份验证、客户端 SSL 证书，也不允许发送 cookie。

这意味着，您会遇到很多错误，尤其是在 Chrome 中，当您尝试实施例如简单的身份验证时。

这是一个更正的包装器：

```
// Code has not been tested.
func addDefaultHeaders(fn http.HandlerFunc) http.HandlerFunc {
    return func(w http.ResponseWriter, r *http.Request) {
        if origin := r.Header.Get("Origin"); origin != "" {
            w.Header().Set("Access-Control-Allow-Origin", origin)
        }
        w.Header().Set("Access-Control-Allow-Methods", "POST, GET, OPTIONS, PUT, DELETE")
        w.Header().Set("Access-Control-Allow-Headers", "Content-Type, Content-Length, Accept-Encoding, X-CSRF-Token")
        w.Header().Set("Access-Control-Allow-Credentials", "true")
        fn(w, r)
    }
} 
```

并且不要忘记将所有这些标头回复到预检 OPTIONS 请求。

* * *

## 回答 #4

> 赞同：17
> 
> 时间：2015-02-26T23:26:47.957

**如果您不想覆盖您的路由器**（如果您没有以支持此功能的方式配置您的应用程序，或者想要逐个路由配置 CORS），请添加一个 OPTIONS 处理程序来处理飞行前请求.

即，使用 Gorilla Mux，您的路线将如下所示：

```
accounts := router.Path("/accounts").Subrouter()
accounts.Methods("POST").Handler(AccountsCreate)
accounts.Methods("OPTIONS").Handler(AccountsCreatePreFlight) 
```

请注意，除了我们的 POST 处理程序之外，**我们还定义了一个特定的 OPTIONS 方法处理程序**。

然后要实际处理 OPTIONS 预检方法，您可以像这样定义 AccountsCreatePreFlight：

```
// Check the origin is valid.
origin := r.Header.Get("Origin")
validOrigin, err := validateOrigin(origin)
if err != nil {
    return err
}

// If it is, allow CORS.
if validOrigin {
    w.Header().Set("Access-Control-Allow-Origin", origin)
    w.Header().Set("Access-Control-Allow-Methods", "POST")
    w.Header().Set("Access-Control-Allow-Headers",
        "Accept, Content-Type, Content-Length, Accept-Encoding, X-CSRF-Token, Authorization")
} 
```

真正让这一切对我来说很重要（除了实际了解 CORS 的工作原理之外）是**预检请求的 HTTP 方法与实际请求的 HTTP 方法不同。**为了启动 CORS，浏览器发送一个带有 HTTP Method OPTIONS 的预检请求，您必须在路由器中显式处理该请求，然后，如果它`"Access-Control-Allow-Origin": origin`从您的应用程序接收到适当的响应（或“*”），它会启动实际的要求。

我也相信您只能对标准类型的请求（即：GET）执行“*”，但对于其他请求，您必须像我上面那样明确设置来源。

* * *

## 回答 #5

> 赞同：14
> 
> 时间：2016-05-10T12:25:16.450

设置适当的 golang 中间件，以便您可以在任何端点上重用。

## 助手类型和功能

```
type Adapter func(http.Handler) http.Handler
// Adapt h with all specified adapters.
func Adapt(h http.Handler, adapters ...Adapter) http.Handler {
    for _, adapter := range adapters {
        h = adapter(h)
    }
    return h
} 
```

## 实际中间件

```
func EnableCORS() Adapter {
    return func(h http.Handler) http.Handler {
        return http.HandlerFunc(func(w http.ResponseWriter, r *http.Request) {

            if origin := r.Header.Get("Origin"); origin != "" {
                w.Header().Set("Access-Control-Allow-Origin", origin)
                w.Header().Set("Access-Control-Allow-Methods", "POST, GET, OPTIONS, PUT, DELETE")
                w.Header().Set("Access-Control-Allow-Headers",
                    "Accept, Content-Type, Content-Length, Accept-Encoding, X-CSRF-Token, Authorization")
            }
            // Stop here if its Preflighted OPTIONS request
            if r.Method == "OPTIONS" {
                return
            }
            h.ServeHTTP(w, r)
        })
    }
} 
```

## 端点

### 记住！中间件以相反的顺序应用（ExpectGET() 首先触发）

```
mux.Handle("/watcher/{action}/{device}",Adapt(api.SerialHandler(mux),
    api.EnableCORS(),
    api.ExpectGET(),
)) 
```

* * *

## 回答 #6

> 赞同：12
> 
> 时间：2013-05-08T18:06:25.573

我为这种情况创建了包装器：

```
func addDefaultHeaders(fn http.HandlerFunc) http.HandlerFunc {
    return func(w http.ResponseWriter, r *http.Request) {
        w.Header().Set("Access-Control-Allow-Origin", "*")
        fn(w, r)
    }
} 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2016-05-02T08:42:31.203

我遇到了与上述相同的问题，上面给出的解决方案是正确的，我的设置如下 1）客户端的 Angularjs 2）GO 服务器的 Beego 框架

请遵循以下几点 1) 只能在 GO 服务器上启用 CORS 设置 2) 不要在 angularJS 中添加任何类型的标头，除了这个

```
.config(['$httpProvider', function($httpProvider) {
        $httpProvider.defaults.useXDomain = true;
        delete $httpProvider.defaults.headers.common['X-Requested-With'];
    }]) 
```

在您的 GO 服务器中，在请求开始处理之前添加 CORS 设置，以便预检请求收到 200 OK，之后 OPTIONS 方法将转换为 GET、POST、PUT 或您的请求类型。

* * *

## 回答 #8

> 赞同：-7
> 
> 时间：2015-10-04T12:59:03.593

我知道这是答案的不同转折，但这不是网络服务器更关心的问题吗？例如，*nginx*可能会有所帮助。

> **ngx_http_headers_module**模块允许将“Expires”和“Cache-Control”头字段以及任意字段添加到响应头中

```
...

location ~ ^<REGXP MATCHING CORS ROUTES> {
    add_header Access-Control-Allow-Methods POST
    ...
}
... 
```

在生产中的 go 服务前面添加*nginx似乎是明智的。*它为授权、记录和修改请求提供了更多功能。此外，它还可以控制谁可以访问您的服务，不仅如此，还可以为您的应用程序中的特定位置指定不同的行为，如上所示。

我可以继续讨论为什么要在你的 go api 中使用 Web 服务器，但我认为这是另一个讨论的话题。

# oracle - 收到此 Oracle 错误消息：PLS-00330：类型名称或子类型名称的使用无效

> ID：12830098
> 
> 赞同：3
> 
> 时间：2012-10-10T23:39:29.297
> 
> 标签：oracle, compiler-errors

我正在为我的家庭作业做这个。当我运行它时，我收到错误：

```
PACKAGE PKG_Q4 Compiled.
 Warning: execution completed with warning
 PACKAGE BODY PKG_Q4 Compiled.
 50/12          PLS-00330: invalid use of type name or subtype name. 
```

我已经调查过了，但我似乎无法找到解决它的方法。它指向这条线：

```
INTO v_Room_Number, v_Pet_Status, v_Customer_Source_Description, v_Invoice_Total 
```

这是我的代码：

```
 CREATE OR REPLACE PACKAGE BODY PKG_Q4 
    AS
      FUNCTION FN_Q4
        (p_First_Name VARCHAR2, p_Last_Name VARCHAR2)
      RETURN VARCHAR2 
        AS
        v_Output VARCHAR2(500);
        v_Room_Number NUMBER(3,0);
        v_Pet_Status CHAR(1);
        v_Customer_Source_Description VARCHAR2(30);
        v_Invoice_Total NUMBER(7,2);
        v_First_Name VARCHAR2(15);
        v_Last_Name VARCHAR2(20);
        v_Customer_Code CHAR(4);
        v_Registration_Status_Code CHAR(1);

        BEGIN

          SELECT First_Name, Last_Name
          INTO v_First_Name, v_Last_Name
          FROM Customer
          WHERE First_Name = p_First_Name AND
                Last_Name = p_Last_Name;

          Select Registration_Status_Code
          INTO v_Registration_Status_Code
          FROM Registration_Status;

          IF v_Registration_Status_Code = 'N' THEN
            SELECT Room.Room_Number, Room.Pet_Status, Customer_Source.Customer_Source_Description, Invoice.Invoice_Total
            INTO v_Room_Number, v_Pet_Status, v_Customer_Source_Description, v_Invoice_Total
            FROM Registration , Customer , Customer_Source , Room , Invoice 
            WHERE Customer.customer_code = Registration.customer_code AND
                  Customer_Source.customer_source_code = Customer.customer_source_code AND
                  Room.room_number = Registration.room_number AND
                  Registration.registration_number = Invoice.registration_number;
                v_Output := 'Room Number:' || v_Room_Number ||'Pet Status:' || v_Pet_Status ||
                            'Customer Source Code:' || v_Customer_Source_Description ||'Total Cost:' || v_Invoice_Total;

         END IF;
Return Varchar2; 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-11T00:32:19.183

我敢打赌问题实际上是这一行，在代码摘录的最底部：

```
Return Varchar2; 
```

“Varchar2”是一种类型，不能将其用作 RETURN 语句的参数。在函数声明中，`RETURN VARCHAR2`是正确用法，表示函数返回值的类型。实际的 RETURN 语句应返回该类型的值，例如

```
RETURN 'This is a string literal'; 
```

在你的情况下，我猜你想要：

```
RETURN v_Output; 
```

# c# - XAML 分组 GridView/语义缩放不显示所有子级？

> ID：12830101
> 
> 赞同：3
> 
> 时间：2012-10-10T23:40:12.900
> 
> 标签：c#, xaml, windows-8, windows-runtime

我正在尝试使用[XAML C# Grouped GridView 示例](http://code.msdn.microsoft.com/windowsapps/GroupedGridView-77c59e8e)使我的 SemanticZoom 在 XAML C# Windows 8 应用程序中工作。问题是，由于某种原因，它显示了正确的标题（在这种情况下是类别），但它没有显示标题下的所有项目（当我在其中一些项目中有多达 6 个项目时，它只显示每个项目）。

这是 SemanticZoom 的 XAML 代码（请注意，为简洁起见，我省略了 ZoomedOutView，因为它运行良好）：

```
<SemanticZoom x:Name="boardZoom" Height="626" Margin="10,132,10,0" VerticalAlignment="Top">
    <SemanticZoom.ZoomedInView>
        <GridView IsSwipeEnabled="True" x:Name="ItemsGridView" Tapped="Tapped" ItemsSource="{Binding Source={StaticResource cvs2}}" SelectionChanged="selChanged">
            <GridView.ItemTemplate>
                <DataTemplate>
                    <StackPanel Orientation="Horizontal" Margin="10,10,0,0" 
                    HorizontalAlignment="Left" VerticalAlignment="Stretch">
                        <Image Source="{Binding Thumbnail}"></Image>                                
                       <TextBlock Text="{Binding Title}" TextWrapping="Wrap" Width="500"
                            FontFamily="Global User Interface" FontSize="40" VerticalAlignment="Top" />                                
                        <TextBlock Text="{Binding pinNumber}" x:Name="PinNum" Visibility="Collapsed"></TextBlock>
                    </StackPanel>
                </DataTemplate>
            </GridView.ItemTemplate>         
            <GridView.GroupStyle>
                <GroupStyle>
                    <GroupStyle.HeaderTemplate>
                        <DataTemplate>
                           <TextBlock Text='{Binding Key}' Foreground="White" Margin="5" FontSize="20" FontFamily="Segoe UI Light" />
                        </DataTemplate>
                    </GroupStyle.HeaderTemplate>
                    <GroupStyle.ContainerStyle>
                        <Style TargetType="GroupItem">
                            <Setter Property="Template">
                                <Setter.Value>
                                    <ControlTemplate TargetType="GroupItem">
                                        <StackPanel Orientation="Vertical">
                                            <ContentPresenter Content="{TemplateBinding Content}" />
                                            <ItemsControl x:Name="ItemsControl" ItemsSource="{Binding GroupItems}" />
                                        </StackPanel>
                                    </ControlTemplate>
                                </Setter.Value>
                            </Setter>
                        </Style>
                    </GroupStyle.ContainerStyle>
                    <GroupStyle.Panel>
                        <ItemsPanelTemplate>
                            <VariableSizedWrapGrid Orientation="Vertical" MaximumRowsOrColumns="5" />
                        </ItemsPanelTemplate>
                    </GroupStyle.Panel>
                </GroupStyle>
            </GridView.GroupStyle>
            <GridView.ItemsPanel>
                <ItemsPanelTemplate>
                    <WrapGrid Orientation="Vertical" MaximumRowsOrColumns="1" />
                </ItemsPanelTemplate>
            </GridView.ItemsPanel>
        </GridView>
    </SemanticZoom.ZoomedInView> 
```

以及应用启动时调用的 Refresh() C# 函数：

```
System.Collections.ObjectModel.ObservableCollection<SemanticZoomed> finalSource = new System.Collections.ObjectModel.ObservableCollection<SemanticZoomed>();
public async Task<bool> Refresh()
{
    var Pins = await pinTable.ReadAsync(); //pinTable is an Azure Mobile Services table
    List<string> categoriesMixed = new List<string>();
    if (Pins.ToArray().Length < 1)
    {
        //adds a new "Welcome" pin to the table, taken out for brevity
    }
    foreach (pin nowPin in Pins)
    {
        SemanticZoomed toAdd = new SemanticZoomed();
        toAdd.Category = nowPin.category;
        toAdd.pinNumber = nowPin.Id.ToString();
        toAdd.Title = nowPin.name;
        categoriesMixed.Add(nowPin.category);
        finalSource.Add(toAdd);
    }

    List<GroupPinList<object>> groups = new List<GroupPinList<object>>();

    var query = from nowPin in finalSource
        orderby ((SemanticZoomed)nowPin).Category
                group nowPin by ((SemanticZoomed)nowPin).Category into g
                select new { GroupName = g.Key, Items = g };
    foreach (var g in query)
    {
        GroupPinList<object> info = new GroupPinList<object>();
        info.Key = g.GroupName;
        foreach (var item in g.Items)
        {
           info.Add(item);
        }
        groups.Add(info);
    }
    cvs2.Source = groups;
    (boardZoom.ZoomedOutView as ListViewBase).ItemsSource = cvs2.View.CollectionGroups;
    return true;
} 
```

下面是一些关于组变量的截图，以及生成的 SemanticZoom 显示的内容：

组变量：

![组变量](../Images/88e74bbb9219c52b3a35f02774f9c1d7.png)

groups 变量中的“欢迎”类别（它正确显示了它的 6 个项目，以及 imgSrc 旁边的错误“无法获取字段 'imgSrc' 的值，因为有关包含类的信息不可用”，它在下面的 cvs2 中消失了） ：

![欢迎类别](../Images/9637a8c97b7a513f3462a0d931fdc9ea.png)

cvs2（它显示了 Welcome 类别下的 6 个不同的项目）：

![cvs2](../Images/1b2b2ce34d66cc71e2d5c877be570f40.png)

最后，它最终显示的内容：

![最终结果](../Images/48772a602806b95605bd4bbb3a11429d.png)

我不知道欢迎类别中的其他别针去了哪里。我缺少 XAML 代码中的某些内容吗？任何帮助将非常感激 ：）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-05-08T16:05:47.630

我也有同样的问题 。这解决了 pb 。

在 SemanticZoom.ZoomedInView 替换

```
<ItemsPanelTemplate>
<WrapGrid Orientation="Vertical" MaximumRowsOrColumns="1" />
</ItemsPanelTemplate> 
```

经过

```
<ItemsPanelTemplate>
         <VirtualizingStackPanel Orientation="Vertical"/>
</ItemsPanelTemplate> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-30T15:11:29.787

```
you need to use stackpanel instead of  WrapGrip in ItemPanelTemplate

<GridView.ItemsPanel>
           <ItemsPanelTemplate>
               <StackPanel Orientation="Horizontal" />
           </ItemsPanelTemplate>
</GridView.ItemsPanel> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-11T07:41:41.010

我想我知道问题出在哪里 - 如果您以编程方式将项目添加到 GridView 中，就会发生这种情况。这里发生的情况是，当您将第一个包含 n 个项目的组添加到 GridView 源时，然后保留编号 n，并且对于之后添加的每个组，它显示的项目不超过 n 个，即使有更多项目也是如此。

因此，如果您有 5 个包含 2、4、1、5、3 项的集合，则将空 ObservableCollection 分配为 GridView 的 ItemSource，然后将这些组添加到 ObservableCollection 中，您将只看到 2,2，每组1,2,2个项目。

我不知道为什么会发生这种情况，如果它是功能或错误，但您可以通过首先加载 ObservableCollection 然后将其分配给 GridView 作为源来解决它，或者您可以使用某种转换器，这将为每组返回相同数量的项目。对于数量较少的组，您可以添加假的空项目并使用不同的 DataTemplate 隐藏它们。

编辑：我刚刚注意到您已经立即添加了该集合，因此问题可能出在其他地方。也许您的问题的根源是 ItemsPanel 中的这个？

```
MaximumRowsOrColumns="1" 
```

# python - 在字典中查找最相关的孩子

> ID：12830102
> 
> 赞同：2
> 
> 时间：2012-10-10T23:40:13.370
> 
> 标签：python, categories

拿这本词典：

```
{'local': {'count': 7,
    'dining-and-nightlife': {'count': 1,
        'bar-clubs': {'count': 1}
    },
    'activities-events': {'count': 6,
        'outdoor-adventures': {'count': 4},
        'life-skill-classes': {'count': 2}
    }
}} 
```

我如何确定最相关的匹配（在 30% 的余地内）？例如，activity-events 的计数为 6，因此 6/7 = 85%，其子户外冒险的计数为 4 out 6 (66%)。因此，最相关的类别是户外探险。

在这个例子中：

```
{'local': {'count': 11,
    'dining-and-nightlife': {'count': 4,
        'bar-clubs': {'count': 4}
    },
    'activities-events': {'count': 6,
        'outdoor-adventures': {'count': 4},
        'life-skill-classes': {'count': 2}
    }
}} 
```

将餐饮和夜生活 (33%) 与酒吧俱乐部 (100%) 结合起来，将活动活动 (54%) 与户外探险 (66%) 结合起来。

我希望百分比截止值由

```
cutoff = 0.3 
```

这里的想法是确定哪个类别最相关，删除较小的结果（低于 30%）匹配。

@FJ 在下面回答了这个问题，但现在我希望更新树中的计数。

初始输出：

```
{'local': {'activities-events': {'count': 6,
                             'life-skill-classes': {'count': 2},
                             'outdoor-adventures': {'count': 4}},
       'count': 11,
       'dining-and-nightlife': {'bar-clubs': {'count': 4}, 'count': 4}}} 
```

帖子输出：

```
{'local': {'activities-events': {'count': 6,
                             'life-skill-classes': {'count': 2},
                             'outdoor-adventures': {'count': 4}},
       'count': 10,
       'dining-and-nightlife': {'bar-clubs': {'count': 4}, 'count': 4}}} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-10T23:54:08.260

以下应该有效，请注意，这将修改您的输入字典：

```
def keep_most_relevant(d, cutoff=0.3):
    for k, v in list(d.items()):
        if k == 'count':
            continue
        if 'count' in d and v['count'] < d['count'] * cutoff:
            del d[k]
        else:
            keep_most_relevant(v) 
```

例子：

```
>>> d1 = {'local': {'count': 7, 'dining-and-nightlife': {'count': 1, 'bar-clubs': {'count': 1}}, 'activities-events': {'count': 6, 'outdoor-adventures': {'count': 4}, 'life-skill-classes': {'count': 2}}}}
>>> keep_most_relevant(d1)
>>> pprint.pprint(d1)
{'local': {'activities-events': {'count': 6,
                                 'life-skill-classes': {'count': 2},
                                 'outdoor-adventures': {'count': 4}},
           'count': 7}}

>>> d2 = {'local': {'count': 11, 'dining-and-nightlife': {'count': 4, 'bar-clubs': {'count': 4}}, 'activities-events': {'count': 6, 'outdoor-adventures': {'count': 4}, 'life-skill-classes': {'count': 2}}}}
>>> keep_most_relevant(d2)
>>> pprint.pprint(d2)
{'local': {'activities-events': {'count': 6,
                                 'life-skill-classes': {'count': 2},
                                 'outdoor-adventures': {'count': 4}},
           'count': 11,
           'dining-and-nightlife': {'bar-clubs': {'count': 4}, 'count': 4}}} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-11T00:03:55.463

```
def matches(match, cutoff):
    total = float(match['count'])

    for k in match:
        if k == 'count':
            continue

        score = match[k]['count'] / total

        if score >= cutoff:
            yield (k, score)

            m = list(matches(match[k], cutoff))
            if m: yield max(m, key=lambda (c, s): s)

def best_matches(d, cutoff):
    for k in d:
        for m in matches(d[k], cutoff):
            yield m 
```

### 测试 1

```
>>> d = {'local': {'count': 7,
    'dining-and-nightlife': {'count': 1,
        'bar-clubs': {'count': 1}
    },
    'activities-events': {'count': 6,
        'outdoor-adventures': {'count': 4},
        'life-skill-classes': {'count': 2}
    }
}}
>>> print list(best_matches(d, 0.3))
[('activities-events', 0.8571428571428571), ('outdoor-adventures', 0.66666666666666663)] 
```

### 测试 2

```
>>> d = {'local': {'count': 11,
    'dining-and-nightlife': {'count': 4,
        'bar-clubs': {'count': 4}
    },
    'activities-events': {'count': 6,
        'outdoor-adventures': {'count': 4},
        'life-skill-classes': {'count': 2}
    }
}}
>>> print list(best_matches(d, 0.3))
[('dining-and-nightlife', 0.36363636363636365), ('bar-clubs', 1.0), ('activities-events', 0.54545454545454541), ('outdoor-adventures', 0.66666666666666663)] 
```

# ruby-on-rails - 如何在整个应用程序中优雅地处理集合中的 nil 案例？

> ID：12830107
> 
> 赞同：2
> 
> 时间：2012-10-10T23:40:42.507
> 
> 标签：ruby-on-rails, ruby-on-rails-3

我总是收到这样的错误消息：

```
undefined method 'firm_size' for nil:NilClass 
```

当迭代一个集合并遇到一些零情况时。

我通常必须进入我的视图并`if`围绕这个特定属性添加一个语句来处理 nil 情况。

这似乎是一种非常不干燥的方法。

在 Rails 中是否有更优雅的方式来处理这些类型的案例？不仅是`nil`集合中的对象，而且可能具有属性的对象`nil`- 这实际上就是这里发生的事情。

谢谢。

**编辑 1**

有关此特定错误实例的更多上下文：

这在我`Scores#index`看来——

```
<% @clients.each do |client| %>
  <tr>
    <td><%= "First Client" %></td>
  </tr>
  <tr>
    <td>Firm Size</td>
    <td><%= best_in_place client.score, :firm_size, :type => :input, :nil => "Add Score for Firm Size" %></td> 
```

这是我`scores_controller.rb`的相关部分：

```
class ScoresController < ApplicationController
    before_filter :load_clients

  def index
    @weight = current_user.weight
    @scores = current_user.scores

    respond_to do |format|
      format.html # index.html.erb
      format.json { render json: @scores }
    end
  end

    private 

    def load_clients
        @clients = current_user.clients     
    end         

end 
```

这是服务器日志：

```
Started GET "/scores" for 127.0.0.1 at 2012-10-10 18:38:05 -0500
Processing by ScoresController#index as HTML
  User Load (0.3ms)  SELECT "users".* FROM "users" WHERE "users"."id" = 1 LIMIT 1
  Weight Load (0.2ms)  SELECT "weights".* FROM "weights" WHERE "weights"."user_id" = 1 LIMIT 1
  Client Load (0.3ms)  SELECT "clients".* FROM "clients" WHERE "clients"."user_id" = 1
  Score Load (10.9ms)  SELECT "scores".* FROM "scores" WHERE "scores"."client_id" = 1 LIMIT 1
  Score Load (0.3ms)  SELECT "scores".* FROM "scores" WHERE "scores"."client_id" = 2 LIMIT 1
  Rendered scores/index.html.erb within layouts/application (276.6ms)
Completed 500 Internal Server Error in 283ms 
```

这是有问题的记录（即`client.score`何时`client.id = 2`）

```
1.9.3p194 :089 > d = Client.find(2)
  Client Load (0.2ms)  SELECT "clients".* FROM "clients" WHERE "clients"."id" = ? LIMIT 1  [["id", 2]]
 => #<Client id: 2, name: "Jack Daniels", email: "jack@abc.com", phone: 1234567890, firm_id: 2, created_at: "2012-09-05 19:26:07", updated_at: "2012-10-07 02:44:51", user_id: 1, last_contact: "2012-02-10", vote: false, vote_for_user: false, next_vote: "2012-07-12", weighted_score: nil> 
1.9.3p194 :090 > d.score
  Score Load (0.4ms)  SELECT "scores".* FROM "scores" WHERE "scores"."client_id" = 2 LIMIT 1
 => nil 
```

正如我之前所说，每当遇到 nil 记录（或属性）时都会引发此错误。在这种特殊情况下，零记录用于`2nd`未分配分数的客户记录。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-11T00:07:07.573

如果您的代码始终为不应该为 nil 的东西返回 nil，那么也许最好重新考虑如何调用函数。不过，拥有一个（或许多）自定义的 nil 类通常是件好事。您可以编写扩展`NilCLass`以捕获您拥有的函数，但如果您获得的函数名称在不同情况下相同，这可能会成为问题。如果特定属性为 nil，您还可以在辅助方法指向的所有类中创建一个单例

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-11T00:05:27.573

在您的特定情况下，假设`best_in_place`是一个助手，您可以处理助手中的 nil 。只是传入`client`，而不是`client.score`。

关键是在*某个地方*你会有一个 if 语句。只要把它放在最好的地方。

# ajax - Jboss - 使用 Access-Control-Allow-Origin 进行配置 *

> ID：12830108
> 
> 赞同：0
> 
> 时间：2012-10-10T23:40:43.997
> 
> 标签：ajax, xss, jboss5.x

我是 jboss 的新手，想知道是否可以使用 Access-Control-Allow-Origin * 进行配置。这可能吗？如果是这样，该指令在哪里？我最好只使用 nginx 作为代理吗？

谢谢，

杰森

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-12T05:19:51.223

您可以编写一个 servlet 过滤器，将其粘贴到您的应用程序的 web.xml 中，然后将其部署到 jboss。这至少适用于该应用程序。

# php - 如何在 html 文件中添加 php 语句？

> ID：12830115
> 
> 赞同：0
> 
> 时间：2012-10-10T23:41:23.477
> 
> 标签：php, html

我试图在 - 文件`<?php session_start(); ?>`的第一行之前添加命令。`index.html`除此之外，该文件仅包含 html 语句。当我注意到 php 代码没有被解释时，我将文件的结尾更改为`index.php`，从而解决了该问题。

现在我想知道我所做的是丑陋的黑客行为还是实际上是一种公认​​的做法？可以将 php 前缀添加到原本是 html 的文件中吗？

另外，很遗憾我仍然收到以下错误： `session_start() [function.session-start]: Cannot send session cache limiter - headers already sent`. 如果我的上述做法很好，是什么导致了这个错误？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-10T23:54:19.940

你所做的就是你应该做的。

基于文件系统的网络服务器，例如 Apache 和 IIS（大多数情况下）根据文件扩展名解释请求的文件并相应地处理它。当用户请求`.html`文件时，服务器将返回文件的原始字节，而如果用户请求`.php`文件，则它将通过 PHP 模块或 CGI 程序运行它，从而生成所需的输出。

您可以配置您的网络服务器（假设您不在共享托管服务上）以始终`.html`使用 PHP 处理文件，但最好在 URI 中隐藏实现细节并改用 URL 重写（Apache 和 IIS7+ 完全支持）。

关于`session_start()`您遇到的错误 - 这是因为`session_start`必须在任何内容输出到客户端之前调用，这意味着该`<?php session_start() ?>`部分必须位于文档的开头，之前没有明文或空行。您可以在调用之前有一些 PHP 代码，但要确保 PHP 代码没有发送任何响应或标头。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-11T00:03:52.157

请记住，.php 文件应该通过 PHP 和 HTML 标签进行解析。在文档的开头放置标签是一种常见的做法。

也像提到的@markus-tharkun 一样——这真的取决于你试图用 PHP 代码做什么。如果您只是想在 HTML Doc 的标头中添加时间戳，则可以像下面这样简单：

```
<h2>
  <?php echo date('l jS \of F Y h:i:s A'); //Prints Date inside the H2 Tag ?> 
</h2> 
```

再一次，我可以将此代码放在我的标签中的任何位置，它会使用 PHP 打印出当前日期。 *PHP 可以在作用域上玩一些有趣的技巧，因此应始终密切关注它。*

# watir-webdriver - 可以在 watir webdriver 中使用 isElementPresent(:id, "id")

> ID：12830119
> 
> 赞同：1
> 
> 时间：2012-10-10T23:42:16.270
> 
> 标签：watir-webdriver

使用 Watir Webdriver，我想要一个助手来检查任何具有给定 id 的元素。我可能不知道它是什么类型（按钮或链接或文本）。我能做吗

`browser.Element(:id, id).exists`

我在谷歌上找到的所有示例都针对特定元素类型进行检查，如

`browser.button(:id," ").exits`

如果有办法，请分享语法。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-11T04:15:37.543

在 Watir-Webdriver 中，我会使用这样的东西：

```
browser.element(class: 'post-tag').exists? 
```

这将在此页面上找到 watir-webdriver 标记并报告它存在。请注意，我使用了 1.9 语法，而不是以下替代语法：

```
browser.element(:class => 'post-tag').exists? 
```

或者

```
browser.element(:class, 'post-tag').exists? 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-11T07:56:11.343

正如戴夫指出的那样，有`#element`方法。（你只是在大写上错了，不是`#Element`。）

由于您询问使用`id`属性访问它，请尝试以下操作：

```
browser.element(:id => id) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-29T20:06:29.923

我从来没有得到 .exists？自己工作。

在这些情况下，我必须使用的是明确验证“存在吗？”......比如：

```
cf_checbox = @browser.text_field(:id=>'continue-ring', :value=>true).exists?

assert( cf_description == true) 
```

如果没有那个明确的断言，即使值不存在，我也总是会得到“真”。

# c# - 错误：无法加载文件或程序集 'Microsoft.Vbe.Interop，版本 = 14

> ID：12830121
> 
> 赞同：2
> 
> 时间：2012-10-10T23:42:34.870
> 
> 标签：c#, winforms, dll, ms-office

我在带有 Office2010 64 位的 64 位机器中构建了我的 dll，当我在 32 位（xp/office2003）机器中使用该 dll 时出现此错误。

> `Could not load file or assembly 'Microsoft.Vbe.Interop, Version=14.0.0.0, Culture=neutral, PublicKeyToken=71e9bce111e9429c' or one of its dependencies. The system cannot find the file specified.`

我在我的项目中引用了 VBIDE，看起来基于安装在正在构建项目的 PC 中的 office 版本 - Vbe.Interop 的版本记录在 dll 中。我怎样才能避免这种情况 - 即环境中立的构建..

提前致谢..

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-10T23:45:53.883

排除：---您可能从某处复制了所需的程序集。但是 .NET 程序集 Microsoft.Vbe.Interop 将需要存在其他（本机）DLL。这些可能不存在于您的系统上。

我认为您可能需要安装 Microsoft Office 版本才能解决此问题。----

**要对加载的内容以及融合加载程序查找（本机）DLL 的内容进行故障**排除，请在注册表中打开融合日志记录：

> 将以下值添加到
> 
> ```
>  HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Fusion 
> ```
> 
> 添加：
> 
> ```
>  DWORD ForceLog set value to 1
>  DWORD LogFailures set value to 1
>  DWORD LogResourceBinds set value to 1
>  String LogPath set value to folder for logs e.g. C:\FusionLog\ 
> ```
> 
> 此文件夹必须存在，并以反斜杠结尾

^([（从How to enable assembly bind failure logging (Fusion) in .NET](https://stackoverflow.com/questions/255669/how-to-enable-assembly-bind-failure-logging-fusion-in-net/1527249#1527249)复制的说明）)

# facebook - Facebook Open Graph like 按钮正在获取链接而不是文章

> ID：12830123
> 
> 赞同：0
> 
> 时间：2012-10-10T23:42:38.410
> 
> 标签：facebook, facebook-like, facebook-opengraph

我有一个网站，上面有 Facebook like 按钮。现在，问题是，我有开放的图形元标记；og：类型设置为文章，但是当有人喜欢并发布我的链接时，Facebook 将其视为 LINK 而不是文章。例如：John Doe 喜欢链接 bla bla bla。

但它必须是这样的：

John Doe 喜欢文章 bla bla bla。

我尝试了 Open Graph 调试器，它采用正确的类型。所以我现在不知道问题出在哪里。我已启用并将我的 Facebook 应用程序与网站连接。

[这是调试器的链接。](https://developers.facebook.com/tools/debug/og/object?q=http://getthewordout81.com/sandbox/25235)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-11T08:31:15.993

要获得该功能，您必须创建一个 Open Graph 操作（Like）并使用它而不是常规的 Like 按钮。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-11T13:09:46.567

我有一个视频网站 ->www.wootube.woolei.com，当人们喜欢我的页面时使用 facebook 插件。它将显示为**视频**而不是链接。

您可以向我们展示您的网站吗？我们想检查您的 og 财产。

问候， Woolei ->woolei.com 的 Facebook 应用程序顾问

# mercurial - 如何融合使用 hgignore

> ID：12830127
> 
> 赞同：2
> 
> 时间：2012-10-10T23:43:00.153
> 
> 标签：mercurial, meld

我刚开始使用 Meld。我正在使用它的版本控制差异功能并且它运行良好，除了它似乎没有使用 .hgignore 文件。

我正在工作的树*很大*，但我只跟踪一小部分，所以 Meld 需要很*长时间*来扫描整个树，其中 90% 是我不太关心的。

我使用的是 Meld 1.6.0，它似乎不允许用户手动选择 VC 类型，所以我不得不在包含 .hg 子目录的目录中开始比较。

有没有办法让 Meld 使用 .hgignore 文件或者覆盖 Meld 的默认 VC 选择？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-10-11T07:31:47.197

我认为您应该“反过来”，即：配置*mercurial*以使用***meld***作为其“外部差异”工具，利用“extdiff”扩展名。

> > **注意：**以上所有内容均已在类 UNIX 环境中测试过

1.  在 ~/.hgrc 通过添加到 [extensions] 部分启用“extdiff”扩展：

    ```
    [扩展]
    扩展差异 =
    ```

2.  在下面添加：

    ```
    [扩展差异]
    cmd.meld = # 如果 meld 不在您的路径中，您可能需要在此处输入脚本的绝对路径
    ```

3.  保存 ~/.hgrc 文件。

现在，您可以使用一个新的 hg 子命令。在终端中输入 hg repo 文件夹：

```
user@machine:~$ cd myrepo
user@machine:~/myrepo$ hg meld 
```

这将产生正确的融合，尊重.hgignore，善变的尊重自己）

对于 GUI 技巧，您可以将其连接到您最喜欢的文件管理器的上下文菜单中： 1\. Linux：您可以更多地与萨满的鼓共舞，但 TortoiseHg 尊重 extdiff 扩展。1\. Windows：TortoiseHg 自动执行此操作 1\. Mac：不知道如何对 Finder 执行此操作 :)，也许这里需要 AppleScripting。

问候。

# php - 正确的 SQL 查询在 PHP 中返回错误的结果？

> ID：12830130
> 
> 赞同：0
> 
> 时间：2012-10-10T23:43:23.167
> 
> 标签：php, sql, mysqli

```
 // check if user exists
        $query = "SELECT playerID FROM PLAYERS where steamid = ? LIMIT 1";
            if (mysqli_stmt_prepare($stmt, $query)) {
                echo "Steamid: $in_steamID...<br />";
                mysqli_stmt_bind_param($stmt, 's', $in_steamID);
                mysqli_stmt_bind_result($stmt, $out_playerID);
                mysqli_stmt_execute($stmt);
                if (mysqli_stmt_fetch($stmt)) {
                    $in_playerID = $out_playerID;
                }
            }
            echo ("Player ID: $in_playerID  <br />"); 
```

基本上，我想做的是如下：

1.  从一些日志文件中解析一些数据并将它们存储在变量中->>这里没有问题
2.  通过查询将此数据发送到我的数据库

问题是我在代码标签中包含的查询，它应该执行以下操作：

1.  检查数据库以查看当前 SteamID 是否在数据库中有一个 playerID - 如果它确实返回了它的 playerID。

问题是，查询似乎总是返回 1，不管它应该实际返回什么，即使根本没有返回任何行。我不知道为什么。

我已经在我的 PHP 脚本之外运行了这个 SQL 语句，它运行良好......

我已经多次检查变量，甚至在脚本运行时打印它们以确保它们包含正确的值......而且它们是！我现在该怎么办？

任何帮助表示赞赏。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-11T01:20:36.403

当没有返回行时，变量 $in_playerID 永远不会被赋予一个值。默认情况下，$in_playerID 似乎包含 1。我只能假设这一定是某个随机内存地址的内容。

为了解决这个问题，我只是在查询上方声明了 $in_playerID。

`$in_playerID = 0;`

# asp.net-ajax - ASP.Net AJAX UpdatePanel 无法触发 SelectedIndexChanged 事件

> ID：12830135
> 
> 赞同：6
> 
> 时间：2012-10-10T23:44:06.707
> 
> 标签：asp.net-ajax, updatepanel, radiobuttonlist, selectedindexchanged

我有一个将 AutoPostBack 设置为 true 的 ASP.Net RadioButtonList 控件。我还有一个 OnSelectedIndexChanged 函数，只要用户更改选择，就会调用该函数。最后，要求用户提供这个控件所请求的信息，所以当用户到达页面时，我有一个默认选择——

```
<asp:RadioButtonList ID="rblHighestDegree" runat="server" AutoPostBack="true"
        onselectedindexchanged="rblHighestDegree_SelectedIndexChanged">
   <asp:listitem Runat="server" Text="Master's Degree" Selected="True" />
   <asp:listitem Runat="server" Text="Doctorate" />
</asp:RadioButtonList> 
```

在上面的代码示例中，当用户从默认选择（例如，“硕士学位”）切换到不同的选项（例如，“博士”）时，就会触发 SelectedIndexChanged 事件。然后，如果用户改变主意，并随后选择了原来的默认选项，则 SelectedIndexChanged 事件将再次被触发。这完全按预期和预期工作。

根据上面的选择，我在代码隐藏中启用或禁用了第二个控件...

```
<asp:ScriptManager ID="scriptmanager1" runat="server" />
<asp:UpdatePanel ID="updatepanel1" runat="server">
<ContentTemplate>
<asp:RadioButtonList ID="rdlYearsOfStudy" runat="server" Enabled="false">
<asp:listitem Runat="server" Text="Less than 3 years" />
<asp:listitem Runat="server" Text="3 - 4 years" />
<asp:listitem Runat="server" Text="5 - 6 years" />
 </asp:RadioButtonList>
</ContentTemplate>
<Triggers>
  <asp:AsyncPostBackTrigger ControlID="rblHighestDegree" EventName="SelectedIndexChanged" /> 
</Triggers>
</asp:UpdatePanel> 
```

只有*在*我将第二个控件放在 ASP.Net AJAX UpdatePanel 中以启用异步回发（如上所示）之后，才会出现问题。一旦我这样做了，原来的 RadioButtonList 控件只会在我选择一个 ListItem 时回发，当用户到达页面时默认情况下*没有选择该 ListItem。*如果用户随后选择原始默认选择，则不会发生回发。

澄清一下，如果我没有在 ASP.Net AJAX UpdatePanel 中放置适用的第二个控件就回发，那么无论用户选择哪个 RadioButtonList ListItem，SelectedIndexChanged 都会起作用。另一方面，在我在 UpdatePanel 中放置一个控件以应用 AsyncPostBackTrigger 后，回发只会发生在非默认 ListItems 的选择中。

可能相关的更多信息是我正在使用 Microsoft Visual Studio 2008 进行编码，并且我使用的 UpdatePanel 控件是 Microsoft AJAX 库（不是 ASP.NET AJAX 控件工具包）的一部分。

我将不胜感激有关如何让 ASP.Net AJAX 工作的任何见解，以便在用户选择 RadioButtonList 中的默认或非默认 ListItems 时触发 SelectedIndexChanged 事件。作为记录，我尝试在 page_load 事件中设置 RadioButtonList 默认选择，但没有帮助。

提前感谢您的任何帮助！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-19T16:07:36.417

我遇到了同样的问题，发现生成的 HTML 在默认选择中没有点击处理程序。列表中的其他单选按钮都有单击处理程序来调用 __doPostBack。所以我添加了这个 jQuery：

```
$("#rbl input[checked]").click(function (e)
{
    var id = e.target.id.replace('_', '$');
    setTimeout(function () { __doPostBack(id, ""); }, 0);
}); 
```

然而，即使 ajax 调用现在按预期工作，服务器端代码仍然没有执行 selectedIndexChanged 处理程序。

认为这可能是因为服务器知道默认选择是什么，并且看到发布的选择是相同的，因此认为所选索引没有更改，因此没有执行处理程序。

Then I thought that when one of the other radios was selected, the server should have remembered that through the viewstate. 这让我想起了我`viewstatemode="Disabled"`在单选按钮列表的容器上。所以我设置`viewstatemode="Enabled"`了单选按钮列表，它现在按预期工作。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-12-17T16:55:01.330

微软表示这是设计使然。他们提供了 2 种变通方法，但两种变通方法都存在可能妨碍实际解决方案的问题。

[http://connect.microsoft.com/visualstudio/feedback/details/508710/radiobuttonlist](http://connect.microsoft.com/visualstudio/feedback/details/508710/radiobuttonlist)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-07-31T22:59:41.223

我在后面的代码中构建了单选按钮列表，并保留了 SelectedIndex = 0，然后在 onload 中我使用 JavaScript 调用了第一项的 click()。这是对我有用的最简单的事情。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-07-02T11:18:38.223

我有这个问题，它以这种方式解决，您必须在 C# 代码（加载页面）和 html 标记中设置 AutoPostBack 和 SelectedIndexChange 事件处理程序。例如：

```
 protected void Page_Load(object sender, EventArgs e)
    {
            rblHighestDegree.AutoPostBack = true;
            rblHighestDegree.SelectedIndexChanged += 
             new EventHandler  (rblHighestDegree_SelectedIndexChanged);
    } 
```

在 HTML 中：

```
 <asp:RadioButtonList ID="rblHighestDegree" runat="server" AutoPostBack="true"
    onselectedindexchanged="rblHighestDegree_SelectedIndexChanged"> 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2016-08-24T12:58:18.430

我知道这是一个老问题，但正如 Jeff Shepler 所说，默认选项没有点击处理程序，部分回发不会创建一个。

我通过使用 UpdateModel="Always" （这是默认值）将第一个单选按钮列表包装在一个新的更新面板中来解决这个问题，因此它可以通过任何回发进行更新。

由于特定的表单布局，我无法使用将两个单选按钮列表放在同一个更新面板中的解决方案。

# scala - Squeryl 0.9.5（带有 Lift 2.4）不释放数据库连接/池

> ID：12830139
> 
> 赞同：2
> 
> 时间：2012-10-10T23:44:17.537
> 
> 标签：scala, jdbc, sbt, h2, squeryl

按照 Squeryl 的[推荐事务设置](https://www.assembla.com/spaces/liftweb/wiki/Squeryl)，在我的 Boot.scala 中：

```
import net.liftweb.squerylrecord.SquerylRecord
import org.squeryl.Session
import org.squeryl.adapters.H2Adapter

SquerylRecord.initWithSquerylSession(Session.create(
  DriverManager.getConnection("jdbc:h2:lift_proto.db;DB_CLOSE_DELAY=-1", "sa", ""),
  new H2Adapter
)) 
```

第一次启动工作正常。我可以通过 H2 的网络界面连接，如果我使用我的应用程序，它会适当地更新数据库。但是，如果我在不重新启动 JVM 的情况下重新启动码头，我会得到：

```
java.sql.SQLException: No suitable driver found for jdbc:h2:lift_proto.db;DB_CLOSE_DELAY=-1 
```

如果我将“DB_CLOSE_DELAY=-1”替换为“AUTO_SERVER=TRUE”，或者将其完全删除，也会得到相同的结果。

按照 Squeryl 列表中的建议，我尝试了 C3P0：

```
import com.mchange.v2.c3p0.ComboPooledDataSource

val cpds = new ComboPooledDataSource 
cpds.setDriverClass("org.h2.Driver") 
cpds.setJdbcUrl("jdbc:h2:lift_proto") 
cpds.setUser("sa") 
cpds.setPassword("")
org.squeryl.SessionFactory.concreteFactory =
  Some(() => Session.create( 
    cpds.getConnection, new H2Adapter())
  ) 
```

这会产生类似的行为：

```
WARNING: A C3P0Registry mbean is already registered. This probably means that an application using c3p0 was undeployed, but not all PooledDataSources were closed prior to undeployment. This may lead to resource leaks over time. Please take care to close all PooledDataSources. 
```

为了确保不是我正在做的任何事情导致了这种情况，我在没有调用事务 {} 块的情况下启动和停止了服务器。没有抛出异常。然后我添加到我的 Boot.scala 中：

```
transaction { /* Do nothing */ } 
```

并且再次抛出异常（我假设因为连接是惰性的）。所以我将 db 初始化代码从 Lift 移到了它自己的文件中：

```
SessionFactory.concreteFactory = Some(()=>
  Session.create(
  java.sql.DriverManager.getConnection("jdbc:h2:mem:test", "sa", ""),
  new H2Adapter
))
transaction {} 
```

结果没有改变。我究竟做错了什么？我在 Squeryl 文档中找不到任何需要显式关闭连接或会话的内容，这是我第一次使用 JDBC。

[我在 Lift google group 上](https://groups.google.com/d/msg/liftweb/I6LKt_55qBc/9ZuVQuQXyrIJ)发现了同样的问题，但没有解决方案。

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-11T15:08:45.513

当您说要重新启动 Jetty 时，我认为您实际上在做的是在 Jetty 中重新加载您的 webapp。当您的应用程序重新加载时，h2 数据库或 C3P0 都不会自动关闭，这解释了当 Lift 尝试第二次初始化它们时您收到的错误。当您不创建事务块时，您看不到错误，因为在检索第一个数据库连接时，h2 和 C3P0 都已初始化。

我自己倾向于使用 BoneCP 作为连接池。您可以将池连接的最小数量配置为 > 1，这将阻止 h2 关闭而无需 DB_CLOSE_DELAY=-1。然后你可以使用：

```
 LiftRules.unloadHooks append { () =>
      yourPool.close() //should destroy the pool and it's associated threads
    } 
```

这将在 Lift 关闭时关闭所有连接，这也应该正确关闭 h2 数据库。

# php - 如何获取特定目录中的文件和目录列表

> ID：12830144
> 
> 赞同：1
> 
> 时间：2012-10-10T23:44:31.640
> 
> 标签：php, directory, readdir

> **可能重复：**
> [目录中特定文件的 PHP 列表](https://stackoverflow.com/questions/3062154/php-list-of-specific-files-in-a-directory)

我想列出我目录中的所有目录和文件。我怎么能这样做？下面是我的代码

```
if(opendir("user_files/".$uid."/")) {
var_dump(readdir("user_files/".$uid."/"));
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-11T00:13:32.633

[这是使用FilesystemIterator](http://php.net/manual/en/filesystemiterator.construct.php)列出文件夹中文件的另一种方法

```
$dir = __DIR__;
$fi = new FilesystemIterator($dir, FilesystemIterator::SKIP_DOTS);
echo "<ul>";
printf("<b>Total Files :  %d</b>", iterator_count($fi));
foreach ( $fi as $file ) {
    printf("<li>%s : %d</li>", $file->getFileName(), $file->getSize());
}
echo "</ul>"; 
```

# c - 在部署新代码或热交换代码时维护套接字连接？

> ID：12830145
> 
> 赞同：0
> 
> 时间：2012-10-10T23:44:39.237
> 
> 标签：c, node.js, sockets, erlang, distributed-computing

更新代码时是否可以保持套接字连接，或者重新启动进程或热插拔代码？

我正在考虑我正在开发的下一代分布式服务器应用程序（目前用 node.js 编写），我希望能够保持 tcp 套接字打开，只要服务器和远程客户端有网络连接，即使服务器代码更新或特定实例重新启动或消失。

以下是否有可能？

*   在代码重新启动之前，它会存储套接字信息，而远程端保持打开状态。似乎这在 C 中是完全可行的。
*   在代码重新启动之前，它会将套接字信息发送到另一个实例或进程吗？
*   在 Erlang 的情况下，如果一段特定的代码被热交换，数据结构和连接不会受到干扰吗？
*   在一些元组空间中分配套接字。我对此一无所知，但至少听起来很有趣。

有什么我应该看的参考资料吗？在我看来，Erlang 是该系统未来版本的一个很好的候选者，但除了玩具示例之外，我没有将它用于任何其他用途。

编辑：在linux上运行

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-11T01:39:11.657

编辑：修正一个错字。

好吧，你没有提到它在哪个平台上运行，所以我假设是 Linux/Unix。至少有两种方法可以做到这一点。

1.  向应用程序发送一个信号，意思是“分叉并执行你的新自我”。新的自我继承了套接字。

2.  您应该能够通过 unix-pipes 传递套接字 fds。您可以拥有一些最小的管家应用程序，它将向 app-v1 发送信号以将套接字转储到预定义的管道，完成后将其终止，然后启动 app-v2 并通过 unix-pipe 再次将套接字传递给它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-11T08:08:28.873

是的，在 Erlang 中可以根据新版本交换代码和转换内部状态数据结构。一句话：你必须实现transform函数，并且在加载新版本代码后同步调用它（你不会失去连接，但是你需要等待一段时间才能完成transformation）。[OTP中可靠地](http://www.erlang.org/doc/design_principles/users_guide.html)[提供](http://www.erlang.org/doc/design_principles/appup_cookbook.html#id78121)了此功能（例如，如果您正在使用，则可以实现 function ）[`gen_server`](http://www.erlang.org/doc/design_principles/gen_server_concepts.html)[`code_change`](http://www.erlang.org/doc/man/gen_server.html#Module%3acode_change-3)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-10T23:50:18.043

脑子里冒出两个念头，

1.  使用标准接口在单独的进程中实现套接字处理程序

2.  在 dll 中编译您的代码，这样您就可以在软件更新发生时加载和卸载实际的 dll。

# ruby - 如何在 GitHub 上推送 Octopress 博客的更改？

> ID：12830148
> 
> 赞同：3
> 
> 时间：2012-10-10T23:44:54.460
> 
> 标签：ruby, github-pages, octopress

我已经完成了 Octopress 设置和部署说明，并且我在 Github 上运行了 Octopress： [http ://wmerydith.github.com](http://wmerydith.github.com)

我的 repo 设置为 Master 的默认分支。

我现在想将更改推送到配置文件，例如更改 url:、title: 和 subtitle:。我进行了这些更改，提交了它们，然后进行了 rake 部署，但是这些更改没有显示出来。

我不清楚的是推送配置更改、内容更改以及在某些时候对 Octopress 博客进行新更新的过程中的差异。

例如，我会使用 rake deploy 来推送配置和内容更改吗？

我是否需要再次运行 rake generate 或 rake deploy？Octopress 更新时如何推送源更改？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-11T05:33:02.113

从[文档](http://octopress.org/docs/deploying/github/)中，您可能想要执行以下操作：

```
 rake generate 
```

之前`rake deploy`。

> 这会：
> 
> *   生成你的博客，
> *   将生成的文件复制到`_deploy/`,
> *   将它们添加到 git，
> *   提交并将它们推送到`master`分支。
> 
> 几秒钟后，您应该会收到一封来自 Github 的电子邮件，告诉您您的提交已收到并将发布在您的网站上。

* * *

[OP Will](https://stackoverflow.com/users/535822/will-merydith) Merydith[评论](https://stackoverflow.com/questions/12830148/how-to-push-changes-for-an-octopress-blog-on-github/12832838#comment17385785_12832838)：

> 我不清楚“ `rake deploy`”是否足以将内容更改推送到博客。
> 我看到一些内容没有进入博客的问题，我不清楚错误是我的部署方式还是其他原因

我确认[Rakefile 任务 :deploy](https://github.com/imathis/octopress/blob/master/Rakefile#L209-L216)将执行`default_deploy`哪个将执行[`task :push`](https://github.com/imathis/octopress/blob/master/Rakefile#L243-L260)。

# jquery - markitup - 自动检测换行符

> ID：12830151
> 
> 赞同：1
> 
> 时间：2012-10-10T23:45:49.110
> 
> 标签：jquery, parsing, text-editor, line-breaks, markitup

我正在使用 markitup (markitup.jaysalvat.com) 为没有 html 经验的用户创建自定义编辑器。我刚刚包含了标签`h1`和。现在我遇到了换行问题。我在文件*set.js*中更改了以下设置：`bold``hyperlink`

 *```
onTabEnter: {keepDefault:false, replaceWith:'<br />\n'}, 
```

至

```
onEnter: {keepDefault:false, replaceWith:'<br/>\n'}, 
```

当然可以。现在`<br/>`在 Enter/Return 上的每一次点击都有一个 -Tag。但是：人们在 MS Word、Libre Office 或简单的 RTF 编辑器等编辑器中离线编写文本和故事。如果他们想从离线编辑器中传输保存的文本（使用“复制和粘贴”）来标记，则换行符会丢失。

是否有自动检测换行符的解决`\r`方案`\n`？我认为Linux和Windows之间存在差异。如果它很重要：Web 服务器正在运行 Linux。

编辑：现在我已经看到使用 markitup 的 BB-Code-Parser 时会自动检测到换行符。但我需要它与 HTML 解析器。*

# ruby-on-rails - 在 Windows 上部署 ruby 或 rails

> ID：12830157
> 
> 赞同：2
> 
> 时间：2012-10-10T23:46:41.653
> 
> 标签：ruby-on-rails, ruby, windows, deployment

> **可能重复：**
> [是否有在 Windows 机器上运行 Ruby on Rails 应用程序？](https://stackoverflow.com/questions/35494/is-there-anyway-to-run-ruby-on-rails-applications-on-a-windows-box)

我了解大多数 Rails 部署到 *nix 服务器环境。这是我只能找到将 Rails 部署到 Windows 的文章

[http://weblog.rubyonrails.org/2006/5/11/deploying-rails-on-windows-servers/](http://weblog.rubyonrails.org/2006/5/11/deploying-rails-on-windows-servers/)

但它似乎很旧（2008 年及之前）。

我可以参考在 Windows 环境中部署 Rails 的新资源吗？

谢谢

# yeoman - 使用 Yeoman 禁用 LiveReload

> ID：12830159
> 
> 赞同：6
> 
> 时间：2012-10-10T23:46:59.293
> 
> 标签：yeoman, livereload

在 IE8 中进行测试时，由于不支持 Web 套接字，LiveReload 会引发错误。有没有办法配置 yeoman 来禁用 LiveReload？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-08T15:20:02.813

Yeoman 不支持 IE8，这是有充分理由的。

但是，您可以执行 Allan 描述的操作，或者您可以`server`通过将其放入 Gruntfile 中来覆盖该任务：

```
grunt.registerTask('server', 'yeoman-server'); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2014-01-31T12:07:30.530

尝试使用`<!--[if !IE]><!--></body><!--<![endif]--><!--[if IE]></body><!--<![endif]-->`而不是`</body>`.

生成器会尝试替换第一个`</body>`元素并在它之前添加 livereload 片段，因此代码将被放置在 IE 空间不可见的位置。

PS这是肮脏的黑客，所以小心使用

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-12-30T00:01:16.660

把它放在你的 Gruntfile 中：

```
grunt.registerHelper('reload:inject', function () {
  return function inject(req, res, next) {
      return next();
  }}); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-10-24T14:00:48.157

是的，我知道有一个。

1.  转到您的项目文件夹并找到该文件`Gruntfile.js`
2.  在编辑器中打开文件
3.  删除`reload:`在`watch:`

它看起来像这样：

```
// default watch configuration
watch: {
  coffee: {
    files: 'app/scripts/**/*.coffee',
    tasks: 'coffee reload'
  },
  compass: {
    files: [
      'app/styles/**/*.{scss,sass}'
    ],
    tasks: 'compass reload'
  },
  reload: {
    files: [
      'app/*.html',
      'app/styles/**/*.css',
      'app/scripts/**/*.js',
      'app/images/**/*'
    ],
    tasks: 'reload'
  }
} 
```

在你删除它之后是这样的：

```
// default watch configuration
watch: {
  coffee: {
    files: 'app/scripts/**/*.coffee',
    tasks: 'coffee reload'
  },
  compass: {
    files: [
      'app/styles/**/*.{scss,sass}'
    ],
    tasks: 'compass reload'
  }
} 
```

我想我已经看到了一个命令行标志，但我找不到它。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-06-01T04:19:20.077

Yeoman Livereload 由两部分组成：插入 livereload 片段的中间件和 watch 任务中的 livereload 目标。要禁用 livereload，请同时删除：

**Gruntfile 顶部的 Livereload 片段：**

```
// Generated on ...
'use strict';
var LIVERELOAD_PORT = 35729; // <- Delete this
var lrSnippet = require('connect-livereload')({port: LIVERELOAD_PORT}); // <- Delete this
var mountFolder = function (connect, dir) {
  return connect.static(require('path').resolve(dir));
}; 
```

**Watch 中的 Livereload 任务：**

```
watch: {
  // Delete this target 
  livereload: {
    options: {
      livereload: LIVERELOAD_PORT
    },
    files: [
       //...
    ]
  }
} 
```

**以及插入片段的中间件：**

```
connect: {
  options: {
    port: 9000,
    hostname: 'localhost'
  },
  livereload: {
    options: {
      middleware: function (connect) {
        return [
          lrSnippet, // <- Delete this middleware
          mountFolder(connect, '.tmp'),
          mountFolder(connect, yeomanConfig.app)
        ];
      }
    } 
```

有关修复 Yeoman 中的 livereload-connect 问题的更新，请跟踪此问题：[https ://github.com/yeoman/generator-webapp/issues/63](https://github.com/yeoman/generator-webapp/issues/63)

# r - 如何更改 ggplot 气泡图中轮廓的颜色？

> ID：12830160
> 
> 赞同：2
> 
> 时间：2012-10-10T23:47:00.060
> 
> 标签：r, ggplot2, bubble-chart

我在 ggplot2 中整理了一个气泡图，并想更改气泡的轮廓（以符合工作的格式指南）。我的问题是我正在使用颜色对变量进行分组，并且我正在使用自定义调色板（同样，为了工作）。理想情况下，我想在气泡上加上黑色边框。

这是我的数据框：

```
mmur <- structure(list(Medgrowth = c(-1.02232983588915, 3.01155115511551,-0.220617729642996, 1.96506550218342, 0.943970767356888, 0.810810810810807,0.0166694449074782, 0.21064457239153, 0.0876731544801004, 0.132216835610393,0.370644922164558,0.23378141437756, 1.27810650887574, 0.42301184433164,0.394880174291941, 0.54216172568924, 1.32690882134916, 0.499722376457527,-0.108885017421599), Medunemp = c(4.430550475, 2.5060469975,4.1239796475, 2.0585977455, 3.846659243, 3.1792594425, 4.0033450105,6.0882984255, 3.091889808,3.7462810695, 2.4038147815, 3.0065393475,2.3331894185, 4.9482480125, 2.0955470885, 1.616694725, 1.873037069,3.060170157, 3.0131425595), Empsize = c(324.2,270.6, 962.1,149, 962.4, 421.1, 1197.8, 777.8, 552.8, 234.8, 421.1, 203.2,915.7, 396.1, 685.9, 904.5, 1366.9, 215.4, 440.5), Eduratio = c(0.1,0.2, 0.1, 0.2, 0.1, 0.2, 0.1, 0.1, 0.1, 0.3, 0.3, 0.2, 0.5, 0.2,0.3, 0.6, 0.4, 0.2, 0.1), Names = structure(c(3L, 12L, 11L, 7L,5L, 19L, 17L, 1L, 18L, 10L, 8L, 16L, 14L, 2L, 15L, 6L, 9L, 4L,13L), .Label = c("Accom", "Admin","Agric", "Arts.", "Const","Educa", "Elect", "Finan", "Healt","Infor","Manuf","Minin","Other", "Profe", "Publi", "Renta", "Retai", "Trans", "Whole"), class = "factor"), colour1 = structure(c(6L, 5L, 6L, 5L, 6L,5L, 6L, 6L, 6L, 4L, 4L, 5L, 2L, 5L, 4L, 1L, 3L, 5L, 6L), .Label = c("#8C2D04","#CC4C02", "#EC7014", "#FE9929","#FEC44F", "#FEE391"), class = "factor")), .Names = c("Medgrowth","Medunemp", "Empsize", "Eduratio", "Names", "colour1"), row.names = c("Agric","Minin", "Manuf", "Elect", "Const", "Whole", "Retai", "Accom","Trans", "Infor", "Finan", "Renta", "Profe", "Admin", "Publi","Educa", "Healt", "Arts.", "Other"), class = "data.frame") 
```

这是我的情节代码：

```
bbubc1 <- ggplot(mmur, aes(x = Medgrowth, y = Medunemp, size = Empsize, label = Names, colour = colour1)) +
    geom_point() + 
    scale_size(range = c(5, sqrt(max(mmur$Empsize)/min(mmur$Empsize)*5^2)), name = "Employment in\n2012 (thousands)") +
    geom_text(size = 4, colour = "black", vjust = -1) + 
    scale_colour_manual(values = levels(mmur$colour1), name = "Per cent with\ntertiary degree", label = c(60, 50, 40, 30, 20, 10)) + 
    xlab("Median employment growth rate 2001 - 2012") +
    ylab("Median unemployment rate 2001 - 2012") + 
    opts(axis.text.x=theme_text(angle=0, hjust=0, size = 16)) + 
    opts(axis.text.y=theme_text(angle=0, hjust=0, size = 16)) +
    opts(axis.title.x=theme_text(size = 16)) + 
    opts(legend.title = theme_text(size = 16)) + 
    opts(axis.title.y=theme_text(size = 16, angle = 90)) + 
    geom_vline(colour = I("grey")) + 
    geom_hline(colour = I("grey")) + 
    ylim(c(0,7)) 
```

剧情在这里： ![我要编辑的情节](../Images/dc7dda9c0d8022b43b0358aab8954ee7.png)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-10T23:57:28.447

R 的一些绘图字符允许内部填充和边缘颜色，因此使用这些形状之一来绘制您的点，并用 替换您的`colour`美学`fill`，应该可以完成这项工作：

```
ggplot(mmur, aes(x = Medgrowth, y = Medunemp, size = Empsize, label = Names, fill = colour1)) +
  geom_point(shape=21, colour='black') + 
  scale_size(range = c(5, sqrt(max(mmur$Empsize)/min(mmur$Empsize)*5^2)), name = "Employment in\n2012 (thousands)") +
  geom_text(size = 4, colour = "black", vjust = -1) + 
  scale_fill_manual(values = levels(mmur$colour1), name = "Per cent with\ntertiary degree", label = c(60, 50, 40, 30, 20, 10)) + 
  xlab("Median employment growth rate 2001 - 2012") +
  ylab("Median unemployment rate 2001 - 2012") + 
  opts(axis.text.x=theme_text(angle=0, hjust=0, size = 16)) + 
  opts(axis.text.y=theme_text(angle=0, hjust=0, size = 16)) +
  opts(axis.title.x=theme_text(size = 16)) + 
  opts(legend.title = theme_text(size = 16)) + 
  opts(axis.title.y=theme_text(size = 16, angle = 90)) + 
  geom_vline(colour = I("grey")) + 
  geom_hline(colour = I("grey")) + 
  ylim(c(0,7)) 
```

运行`example(points)`并转到第三个图，看看哪些形状可以像这样填充，即形状 21:25。

# mongodb - MongoDb 时间戳

> ID：12830161
> 
> 赞同：9
> 
> 时间：2012-10-10T23:47:03.353
> 
> 标签：mongodb, date, collections, timestamp, unix-timestamp

我已经创建并想现在导入一个虚拟集合。每个项目中的一个字段是“已创建”和“已更新”字段。我可以在源/json 文件中放入什么，以便 MongoDb 使用当前日期和时间作为导入值？

这行不通

```
"created" : Date() 
```

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-10-11T13:20:35.490

`mongoimport`用于以 CSV、TSV 或 JSON 格式导入数据*现有数据。*如果要插入新字段（例如`created`时间戳），则必须为它们设置一个值。

例如，如果要将`created`时间戳设置为当前时间，则可以从命令行获取 unix 时间戳（自纪元以来的秒数）：

```
$ date +%s
1349960286 
```

期望的[JSON`<date>`表示](http://docs.mongodb.org/manual/administration/import-export/#data-type-fidelity)是`mongoimport`一个 64 位有符号整数，表示自纪元以来的毫秒数。您需要将 unixtime 秒值乘以 1000 并包含在 JSON 文件中：

```
{ "created": Date(1349960286000) } 
```

另一种方法是在插入文档后将创建的时间戳添加到文档中。

例如：

```
db.mycoll.update(
    {created: { $exists : false }},    // Query criteria
    { $set : { created: new Date() }}, // Add 'created' timestamp
    false, // upsert
    true   // update all matching documents
) 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-10-25T09:08:37.633

正如 Stennie 正确指出的那样，您不能仅使用`mongoimport`or来执行此操作`mongorestore`：它们仅用于恢复您之前转储的数据。正确的做法是恢复数据，然后对恢复的数据进行更新。

使用新的 mongo 2.6，您可以使用[$currentDate](http://docs.mongodb.org/master/reference/operator/update/currentDate/#up._S_currentDate)操作轻松完成此操作，该操作旨在将时间更新为当前时间戳。

在您的情况下，您需要类似的东西

```
db.users.update( 
  {},
  {
     $currentDate: {
      created: true,
      updated: true
     },
  }
) 
```

# django - Django - 表单元素的默认值错误

> ID：12830164
> 
> 赞同：0
> 
> 时间：2012-10-10T23:47:24.847
> 
> 标签：django, django-forms

一页有两个链接[管理页面]。两者都进入相同的表单页面[添加帖子]。在管理页面中；您可以单击“新帖子”链接，也可以在连接到同一页面的文本框中输入您的标题[添加帖子]。在那个页面中；我有一个带有复选框字段的表单。

```
isdraft = forms.BooleanField(required=False,initial=True) 
```

如你看到的 ; 我将字段的默认值设置为 True。如果我在管理页面点击“新帖子”；来到那个表格页面；效果很好。复选框对我来说是真实的。但是如果我使用其他方式[在文本框中输入标题]复选框对我来说是假的。我想不通。

**编辑**：我认为这个问题很复杂。不清楚。如果需要任何其他数据；我可以添加它。

**编辑**：

管理员.html：

```
<h1>Posts<a href="{% url add_post %}" class="button">New Post</a></h1> #this works!

    <form action="{% url add_post %}" method="POST">{% csrf_token %}
        {{ form.title }} <!-- this is textbox -->
        {{ form.isdraft.as_hidden }} <!-- when i add this line form works correctly. but i get 'please fill all fields' warning when redirected to add_post page. -->
    </form> 
```

**编辑2： add_post**视图：

```
@login_required(login_url='/login/')
def add_post(request):

    template_name = 'add.html'
    owner = request.user
    if request.method == "POST":
        form = addForm(request.POST)
        if form.is_valid():
            titleform = form.cleaned_data['title']
            bodyform = form.cleaned_data['body']
            checkform = form.cleaned_data['isdraft']

            n = Post(title=titleform, body=bodyform, isdraft=checkform, owner=owner)
            n.save()
            messages.add_message(request, messages.SUCCESS, 
                'New post created successfully!')
            return HttpResponseRedirect('/admin/post/add/')
        else:
            messages.add_message(request, messages.WARNING, 
                'Please fill in all fields!')
    else:
        form = addForm()
    return render_to_response(template_name, {'form': form, 'owner':owner,},context_instance=RequestContext(request))` 
```

管理员视图：

```
@login_required(login_url='/login/')

def admin_view(request):
    if request.session.get('loggedin') == "djangoo":
        form = newDraft() # textbox in admin page
        return render_to_response('admin.html', {'form':form },context_instance=RequestContext(request))
    else:
        return HttpResponseRedirect('/login/') 
```

添加表格：

```
class addForm(forms.Form):

    title = forms.CharField(max_length=100, 
        widget=forms.TextInput(attrs={'placeholder':'Title here',}))
    body = forms.CharField(widget=forms.Textarea(
        attrs={'placeholder':'Write post here','rows':'25','cols':'90',}))
    isdraft = forms.BooleanField(required=False,initial=True) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-10T23:58:13.057

`initial`仅在表单[未绑定](https://docs.djangoproject.com/en/dev/ref/forms/api/#bound-and-unbound-forms)时有效。

当您单击新的帖子链接时，您正在页面上执行获取请求，因此表单未绑定并`initial`使用该值。

当您输入标题并提交时，我假设您正在页面上进行发布请求。因此表单是绑定的，并且`initial`不会使用该值。

恐怕我不完全理解这个问题，而且你没有显示太多代码，所以我不能为你建议任何解决方法。希望你让它工作。

## 更新对您的问题的以下编辑

当数据来自`add_post`视图时，不要创建绑定表单，因为这样数据将被验证并且您将收到错误消息。

相反，`title`从发布数据中获取，并使用它来创建一个`initial`字典来实例化你`addForm`的。

您需要一种方法来判断发布请求是来自管理员还是添加发布视图。您可以通过将另一个隐藏字段添加到`addForm`.

```
action = forms.CharField(widget=forms.HiddenInput, initial="addform") 
```

然后将您的`add_post`视图更改为：

```
if request.method == 'POST':
    if request.POST.get('action') == 'addform':
        form = addForm(initial={'title': request.POST.get('title'), 'isdraft': True})
    else:
        # your existing code for handling a request post 
```

# visual-c++ - 我们如何去除照明噪声？

> ID：12830168
> 
> 赞同：5
> 
> 时间：2012-10-10T23:47:59.573
> 
> 标签：visual-c++, image-processing, opencv, computer-vision

我在 OpenCV2.3.1 和 Visual C++ 中有一个汽车检测项目。

在前景分割中，由于照明存在反射。在背景被移除后，这（反射）成为前景的一部分。![在此处输入图像描述](../Images/670b61affe436df5d5b79215ae98fbcd.png)

我需要有关如何消除这种噪音的建议或想法。因为它会导致一些前景对象作为一个对象连接起来，就像使用 findContours 和 drawContours 函数时看到的那样。请参阅附加图像上以红色突出显示的图像部分。我认为这将简化斑点检测阶段。

*注意 - 我不允许在 OpenCV 中使用内置的 cvBlobLib

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-11T00:39:35.890

这里的问题是眩光的一部分可以是背景或相应的汽车。

这就是我要做的。

[我相信通过二值化和阈值​​化或类似方式识别眩光部分](https://dsp.stackexchange.com/questions/1215/how-to-remove-the-glare-and-brightness-in-an-image-image-preprocessing)不会有大问题。

一旦识别出所有眩光像素，我将用图像同一行中最近的非眩光像素替换每个眩光像素。这样，汽车和背景就会充满眩光。使用这种方法，您将能够毫无问题地检测汽车。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-11T00:05:13.857

也许尝试将图像转换为 HSV 然后过滤高 V 量

```
IplImage imgHSV = cvCreateImage(cvGetSize(imgInput), 8, 3);
IplImage imgThreshold = cvCreateImage(cvGetSize(imgHSV), 8, 1);
cvInRangeS(imgHSV, cvScalar(0, 0, 90, 0), cvScalar(0, 0, 100, 0), imgThreshold); 
```

..根据需要调整标量以消除眩光

# sql - 从哪里获得有关二阶 SQL 注入的资源和演示？

> ID：12830170
> 
> 赞同：1
> 
> 时间：2012-10-10T23:48:17.253
> 
> 标签：sql, sql-injection

我一直在互联网上四处寻找关于二阶 SQLi 的演示，但我还没有找到一个。许多网站并没有真正彻底解释它是如何工作的。我需要做一个简短的演示，我一直在练习使用 Mutillidae。任何人都可以引导我朝着正确的方向前进吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-11T12:18:36.190

谷歌搜索“二阶 sql 注入”会出现一些或多或少相关的解释，说明二阶 SQL 注入是什么，具有不同程度的详细信息（如您所说）。

基本思想是数据库存储一些来自用户的文本，这些文本随后被合并到 SQL 语句中——但在重用之前文本没有得到充分的净化。

考虑一个允许用户针对数据库创建用户定义查询的应用程序。一个简单的示例可能是错误跟踪系统。一些用户定义的查询属性可能是简单的条件，例如“错误状态为“关闭””。这可以通过查看存储的查询定义来编码：

```
CREATE TABLE UserDefinedQuery
(
    ...user info...,
    bug_status    VARCHAR(20),
    ...other info...
);

SELECT ..., bug_status, ...
  INTO ..., hv_bug_status, ...
  FROM UserDefinedQuery
 WHERE bug_status IS NOT NULL
   AND ...other criteria... 
```

where`hv_bug_status`是保存错误状态标准的主变量（PHP，C，您使用的任何语言）。

如果此值为`= 'closed'`，则生成的 SQL 可能包含：

```
SELECT *
  FROM Bugs
 WHERE status = 'closed'
   AND ...other criteria... 
```

现在假设当用户定义他们的查询时，他们改为写：

```
= 'open' or 1=1 
```

这意味着生成的查询现在看起来像：

```
SELECT *
  FROM Bugs
 WHERE status = 'open' or 1=1
   AND ...other criteria... 
```

查询的存在`OR`极大地改变了查询的含义，并且将显示用户不希望看到的各种其他记录。这是错误查询应用程序中的错误。如果此修改意味着 CustomerX 可以看到其他客户 CustomerY 和 CustomerZ 报告的他们不应该看到的错误，那么 CustomerX 已经设法创建了二阶 SQL 注入攻击。（如果注入仅仅意味着他们可以看到比他们应该看到的更多的记录，包括那些与他们无关的记录，那么他们只是创建了一个错误的查询。）

显然，在 VARCHAR(20) 字段中，您注入致命 SQL 的选项是有限的，因为 SQL 是一种冗长的语言。但是，如果标准存储在更长的字段中，[“小 Bobby Tables”可能会出现问题。](http://xkcd.com/327)

```
='';DELETE Bugs;-- 
```

（对 DELETE 语句使用非标准的缩写；在 18 个字符时发出吱吱声。）

你怎么能避免这种情况？不允许用户编写包含在生成的 SQL 中的原始 SQL 片段。将 UserDefinedQuery.Bug_Status 中的值视为空格/逗号分隔的字符串值列表，并相应地构建查询：

```
SELECT *
  FROM Bugs
 WHERE status IN ('=', '''open''', 'or', '1=1')
   AND ...other criteria... 
```

该查询可能没有用，但它的结构不会因 UserDefinedQuery 表中的数据而改变。

# c++ - c++ winsock recv接收0数据时终止线程而不是返回错误码

> ID：12830174
> 
> 赞同：3
> 
> 时间：2012-10-10T23:48:53.370
> 
> 标签：c++, winsock, recv

已建立到服务器的有效套接字连接。有一个简单的循环旨在继续接收数据，直到服务器停止发送。所有文档都表明，多次尝试 recv() 只会导致它返回 0 或 -1（取决于具体情况）。相反，它会用某种 IOError 杀死线程（在 recv 调用的那一行）。我错过了什么？

编辑： `sad`只是一些字符串流。我保证这与问题无关：D

另一个编辑：包含`errno.h`并检查了 errno 代码，但无济于事。

```
do {            
    memset(buffer,0,sizeof(buffer));
    bytes = recv(s,buffer,sizeof(buffer)-40,0);
    sad << buffer;
    Sleep(1);
} while (bytes>0); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-10T23:54:02.353

也许您也应该检查一下`errno`，因为通信通道可能会永久结束。

```
#include <errno.h>
#include <string.h>

do {            
    memset(buffer,0,sizeof(buffer));
    bytes = recv(s,buffer,sizeof(buffer)-40,0);
    if (errno)
       break;
    sad << buffer;
    Sleep(1);
} while (bytes>0);

if (errno)
   std::cerr << "Premature end of connection: " << strerror(errno) << '\n'; 
```

# python - Python进程在执行期间突然终止

> ID：12830175
> 
> 赞同：1
> 
> 时间：2012-10-10T23:49:05.593
> 
> 标签：python, memory, memory-leaks, process, psycopg2

我是 python 新手，正面临似乎是内存泄漏错误。我编写了一个简单的脚本，它试图从 postgres 数据库中获取多个列，然后继续对这些列执行简单的减法并将结果存储在一个正在写入文件的临时变量中。我需要对数据库中的多对列执行此操作，并且我正在使用列表列表来存储不同的列名。

我在这个列表的各个元素上循环，直到列表用完。虽然我得到了前几列对的有效结果（有效我的意思是输出文件包含预期值），但程序在执行之间的某个地方突然被“杀死”。下面的代码：

```
varList = [ ['table1', 'col1', 'col2'],
        ['table1', 'col3', 'col4'],
        ['table2', 'col1', 'col2'],
        # ..
        # and many more such lines
        # ..
        ['table2', 'col3', 'col4']]

try:

    conn = psycopg2.connect(database='somename', user='someuser', password='somepasswd')

    c = conn.cursor()

    for listVar in varList:
        c.execute("SELECT %s FROM %s" %(listVar[1], listVar[0]))

        rowsList1 = c.fetchall();

        c.execute("SELECT %s FROM %s" %(listVar[2], listVar[0]))

        rowsList2 = c.fetchall();

        outfile = file('%s__%s' %(listVar[1], listVar[2]), 'w')

        for i in range(0, len(rowsList1)):
            if rowsList1[i][0] == None or rowsList2[i][0] == None:
                timeDiff = -1

            else:
                timestamp1 = time.mktime(rowsList1[i][0].timetuple())
                timestamp2 = time.mktime(rowsList2[i][0].timetuple())
                timeDiff = timestamp2 - timestamp1

            outfile.write(str(timeDiff) + '\n')

        outfile.close();

    del rowsList1, rowsList2

#numpy.savetxt('output.dat', column_stack(rows))

except psycopg2.DatabaseError, e:
    print 'Error %s' % e
    sys.exit(1)

finally:
    if conn:
        conn.close() 
```

我最初的猜测是存在某种形式的内存泄漏，为了解决这个问题，我在两个大数组上添加了一个 del 语句，希望内存被正确收集。这一次，我得到了稍微好一点的输出（稍微好一点是指为 db 列对创建了更多的输出文件）。但是，在第 10 对或第 11 对列之后，我的程序又被“杀死”了。有人可以告诉我这里可能出了什么问题。有没有更好的方法来完成这项工作？任何帮助表示赞赏。

PS：我知道这是一个相当低效的实现，因为我循环了很多次，但我需要一些快速而肮脏的东西来证明概念。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-11T07:44:50.113

我认为这里的问题是您选择了所有内容，然后在您应该使用 sql 查询选择所需内容时在应用程序代码中对其进行过滤。如果您在 sql 查询中选择您想要的内容，如下所示：

对于 varlist 中的列表变量：从列表变量 [0] 中选择列表变量 [1]、列表变量 [2]，其中列表变量 [1] 不为空且列表变量 [2] 不为空

```
# then...

timeDiff = {}
for row in rows:
    timestamp1 = time.mktime(row[0].timetuple())
    timestamp2 = time.mktime(row[0].timetuple())
    timeDiff[identifier] = timestamp2 - timestamp1 #still need to assoc timediff with row... maybe you need to query a unique identifyer also?

#and possibly a separate... (this may not be necessary depending on your application code.  do you really need -1's for irrelevant data or can you just return the important data?)

select listvar[1], listvar[2] from listvar[0] where listvar[1] is null or listvar[2] is null

for row in rows:
    timeDiff[identifier] = -1 # or None 
```

# python - 无法将信息传递给回调函数

> ID：12830177
> 
> 赞同：1
> 
> 时间：2012-10-10T23:49:06.740
> 
> 标签：python, lambda, callback, tkinter, partial

我正在使用 Tkinter，python 2.7，并且是 gui 编程的新手。我想将字符串传递给按钮中的回调函数。我已经尝试了 functools 和 lambda 函数的部分。到目前为止还没有运气。所以我一定做错了什么。

```
 def fetch_urls(name):
        print name        

    root=Tk()
    aname=StringVar()
    E1 = Entry(root, bd =5,textvariable=aname,justify=CENTER,width=20)
    E1.grid(row=0,column=1,columnspan=3)

    fetchbutton=Button(root,text ="FETCH",command =fetch_urls)
    fetchbutton.grid(row=7,column=0) 
```

我基本上想要的是将aname 中的字符串（即条目小部件E1 中的文本）发送到函数fetch_urls。我尝试了以下但没有成功

1) 使用 lambda

```
 anime=aname.get()
    lambdafetch=lambda: fetch_urls(anime)
    fetchbutton=Button(root,text ="FETCH",command =lambdafetch) 
```

2) 使用来自 functools 的部分

```
 anime=aname.get()
    parfetch=partial(fetch_urls,anime)
    fetchbutton=Button(root,text ="FETCH",command =parfetch) 
```

在这两种情况下，字符串都不会传递给函数。我想知道我做错了什么以及如何让它发挥作用。

```
 def fetch():
        fetch_urls(aname.get())
    fetchbutton=Button(root,text ="FETCH",command =fetch) 
```

这有效（发布问题后 15 分钟得到了这个想法）。但这肯定不是唯一的方法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-11T00:28:32.113

问题在于，两者都是在创建回调时进行评估，`lambda`而不是在实际调用时进行评估。`partial``aname`

对于`partial`，您需要修改`fetch_urls`函数以实际评估值：

```
def fetch_urls(aStringVar):
    print aStringVar.get()   

parfetch = partial(fetch_urls, aname) 
```

对于`lambda`，只需让它评估对象：

```
lambdafetch = lambda: fetch_urls(aname.get()) 
```

但我倾向于不使用`lambda`回调，因为您可能会遇到范围问题。您可能必须使用技巧来“捕获”`aname`对象：

```
lambdafetch = lambda s=aname: fetch_urls(s.get()) 
```

# c - 如何使用内部 C API 读取 Ruby 全局变量？

> ID：12830182
> 
> 赞同：3
> 
> 时间：2012-10-10T23:49:30.850
> 
> 标签：c, ruby

在 README.EXT 文档（随 Ruby 平台源代码一起提供）中，它提到`rb_define_variable`，它接受一个 C 指针`VALUE`并将其“连接”到一个 Ruby 全局变量，因此从 Ruby-land 读取/写入变量将访问给定的内存中的位置。

但我需要一些不同的东西：从 C 语言中，我想访问在 Ruby 中定义和初始化的全局变量。我不需要列出所有定义的全局变量——我只想访问给定名称的全局变量的值，并且我想从 C 端进行。

如果一切都失败了，我知道我可以使用`rb_eval_string`（这与 Ruby 中的相同`eval`），但应该有更好的方法！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-11T00:07:15.790

你想要的方法是`rb_gv_get`（它本身就是一些全局变量的包装器）。使用 ruby​​inline 你可以写

```
require 'inline'
class Foo
  inline :C  do |builder|
    builder.c_raw_singleton <<SRC
      VALUE read_global(VALUE self, VALUE *name){
        return rb_gv_get(rb_string_value_cstr(name));
      }
SRC
  end
end 
```

进而

```
$bar = 1
Foo.read_global('bar') #=> 1 
```

（rubyinline 在 irb 中不起作用）。

# apache - Apache 使用 http 时显示默认页面而不是 https

> ID：12830183
> 
> 赞同：4
> 
> 时间：2012-10-10T23:49:34.050
> 
> 标签：apache, mod-rewrite, https, virtualhost

我正在尝试将我的所有 foo.mydomain.com 请求重定向到[https://foo.mydomain.com](https://foo.mydomain.com)。

我的 VirtualHost 包含以下内容：

```
<VirtualHost *:443>
    ServerName foo.mydomain.com

    # Indexes + root dir
    DirectoryIndex index.html
    DocumentRoot /home/web/foo.mydomain.com/htdocs

    SSLEngine on

    SSLCertificateFile /etc/apache2/ssl/server.crt
    SSLCertificateKeyFile /etc/apache2/ssl/server.key

    SSLVerifyClient none

    <IfModule mime.c>
            AddType application/x-x509-ca-cert      .crt
            AddType application/x-pkcs7-crl         .crl
    </IfModule>

    # Logfiles
    ErrorLog /home/web/foo.mydomain.com/logs/error.log
    CustomLog /home/web/foo.mydomain.com/logs/access.log combined
</VirtualHost> 
```

所以现在我试图在这个 .htaccess 文件中使用 mod_rewrite 将所有 http-request 重定向到 https：

```
Options FollowSymLinks
RewriteEngine On
RewriteCond %{HTTPS} off
RewriteRule (.*) https://foo.mydomain.com 
```

有谁知道我做错了什么？先感谢您！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-14T07:25:15.187

在非 https 站点的虚拟主机配置中尝试以下操作。

即我的设置是：

```
<VirtualHost *:80>
RewriteCond %{SEVER_PORT} !^443$
RewriteRule ^(.*)$ https://%{HTTP_HOST}%{REQUEST_URI} [R,L]
.....
</VirtualHost> 
```

这应该将所有传入的 http 请求重定向到 https。然后在端口 443 的配置中，你可以做任何你需要的事情......

注意：也应该在 htaccess 中工作。

希望有帮助。不确定您所说的“默认页面”是什么意思，但标题和代表太低而无法发表评论......

让我知道...

干杯

罗宾

# html - 如何自动下载网站的 html 源代码

> ID：12830193
> 
> 赞同：0
> 
> 时间：2012-10-10T23:51:09.733
> 
> 标签：html, web-crawler

有谁知道我可以在其中输入域名的任何程序，该程序将爬取整个域并能够为我下载所有 HTML 源代码 - 所以如果该站点在页面上有链接，它只会爬取到域名上的页面，显然不是外部域名。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-10T23:53:34.293

看看python的scrapy：

[http://www.scrapy.org](http://www.scrapy.org)

或 java 的 crawler4j：

[http://code.google.com/p/crawler4j/](http://code.google.com/p/crawler4j/)

# c# - 正则表达式验证 test@test.com.com.com

> ID：12830194
> 
> 赞同：0
> 
> 时间：2012-10-10T23:51:16.997
> 
> 标签：c#, asp.net, regex, validation, email-validation

如何在 c# 中使用正则表达式验证以下不正确的电子邮件地址？

例如：

```
test@test.com.net.com 
```

或者

```
test@test.net.net.org 
```

这些正在被验证为正确的电子邮件地址。有什么想法吗？谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-12T05:54:58.053

虽然`test@test.com.net.com`和`test@test.net.net.org`都是**有效**的，但从句法的角度来看，它们的域部分并不指向现有域。对于这种测试，您可能希望提取您感兴趣的域部分并查询 DNS（请参阅[RFC 2821](http://www.ietf.org/rfc/rfc2821.txt)和[RFC 2822](http://www.ietf.org/rfc/rfc2822.txt)）以查看它是否存在。

由于您使用的是 .NET，顺便说一下，我建议您看看我们的[EmailVerify.NET](http://cobisi.com/email-validation/.net-component)，这是一个领先的[电子邮件验证](http://cobisi.com/email-validation/.net-component)库，可以验证语法（根据最新的 IETF 标准）、域部分和存在您的电子邮件地址的邮箱。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-11T00:00:15.003

您可能只想使用类似的东西：

```
[a-z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-z0-9!#$%&'*+/=?^_`{|}~-]+)*@(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])? 
```

有关列表，请参阅[此](http://www.regular-expressions.info/email.html)页面。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-11T02:38:23.790

请考虑这个正则表达式：

```
([a-zA-Z0-9_\-\.]+)@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.)|(([a-zA-Z0-9\-]+\.)+))([a-zA-Z]{2,4}|[0-9]{1,3}) 
```

它将匹配所有电子邮件地址，如果与电子邮件地址不匹配，则电子邮件广告格式不正确，希望对您有所帮助:)

# php - 如何区分答案

> ID：12830196
> 
> 赞同：0
> 
> 时间：2012-10-10T23:51:24.097
> 
> 标签：php

下面我有一段代码，它结合了每个问题的每个答案：

```
// $questionNumber is simply n in value[n][]
// $answers is an array of value attributes from <input>s for this question

foreach ($_POST['value'] as $questionNumber => $answers) {
    // combine all the answers into a single string (e.g. ACE)
    $selected_answer = implode('', $answers);

    // continue onto inserting rows into the Answer and Questions tables
    // ...
} 
```

例如：

```
Question 1: Answer: ACE
Question 2: Answer: BD
Question 3: Answer: C 
```

但我实际上想分开答案，以便它显示如下：

```
Question 1: Answer: A
Question 1: Answer: C
Question 1: Answer: E
Question 2: Answer: B
Question 2: Answer: D
Question 3: Answer: C 
```

那么我的问题是，我需要在我的 php 中进行哪些更改以便将它们分开？

是不是应该像下面这样：

```
// $questionNumber is simply n in value[n][]
// $answers is an array of value attributes from <input>s for this question

foreach ($_POST['value'] as $questionNumber => $answers) {
    // combine all the answers into a single string (e.g. ACE)
    $selected_answer = $answers;

    // continue onto inserting rows into the Answer and Questions tables
    // ...
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-11T00:04:24.900

尝试这个：

```
foreach ($_POST['value'] as $questionNumber => $answers) 
{
    foreach($answers as $a)
    {  
             echo "Question: $questionNumber Answer: $a";

    }
} 
```

似乎循环内的循环将输出您想要的内容。如果您需要进一步的帮助，请在 $_POST 上运行 print_r() 并给我答案。

# c++ - 声明一个没有大小的多维数组

> ID：12830197
> 
> 赞同：7
> 
> 时间：2012-10-10T23:51:30.167
> 
> 标签：c++, multidimensional-array

我想在不知道大小的情况下声明一个数组或多维数组。

我想做一些类似于我在这种情况下使用简单数组所做的事情：

```
int *array;
cin >> size;
array = new int[size]; 
```

也许我可以循环初始化一个指针，如下所示：

```
int **array;
cin >> rows >> col;
array = new *int[rows]
for (int i = 0; i < rows; ++i)
    array[i] = new int[col]; 
```

但如果存在更好的解决方案，我宁愿不这样做。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-10T23:56:12.433

为什么不使用 std::vector？

```
std::vector<std::vector<int> > array; 
```

如果您不想使用指针数组，则可以使用一个大数组，在获得大小后动态分配并将其作为行数组访问。

```
int rows = 10;
int columns = 20;

int* array = new int[rows * columns];

for (int count = 0; count < rows; count++)
{
   int* row = &array[count * columns];

   for (int inner_count = 0; inner_count < columns; inner_count++)
   {
      int* element = &row[inner_count];

      //do something
   }
}

delete [] array; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-11T00:03:58.993

您几乎将不得不使用循环版本。你可以做一个小小的改进，就是分配一个大块，然后在`int*`里面建立你自己的索引：

```
int **array;
int *storage;
cin >> rows >> col;
array = new *int[rows];
storage = new int[rows*col];
for (int i = 0; i < rows; ++i)
    array[i] = storage + col * i; 
```

这有一个很好的属性，您仍然可以使用`array[i][j]`语法来访问数组。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-11T04:45:35.200

您可以使用单个 std::vector 来包含整个二维数组并将其包装在一个类中以隐藏细节。这是一个示例，它使用一个`data( row, col )`成员函数，该函数返回对`row`and元素的引用`col`。我包含了一个示例二维矩阵，`int`其中数组中的每个条目都被初始化为其`row`和的乘积`col`。当此类的实例超出范围时，将调用默认析构函数并释放内存，这样您就不必记住调用 delete[] 来释放内存。矩阵的所有元素在内存中都是连续的，这是缓存友好的，应该会给你很好的性能。

```
#include <iostream>
#include <vector>
#include <stdexcept>

template <typename T>
class matrix {
    std::vector<T> data_;
public:
    size_t const rows_;
    size_t const cols_;
    matrix(size_t rows, size_t cols)
        : rows_(rows)
        , cols_(cols)
        , data_( rows * cols )
    {}
    T& data( size_t row, size_t col ) {
        if (row > rows_ || col > cols_) throw std::out_of_range("matrix");
        return data_[ row * cols_ + col ];
    }
};

int main( int argc, char** argv )
{
    matrix<int> array(100,100);

    for(size_t r=0; r < array.rows_; ++r) {
        for(size_t c=0; c < array.cols_; ++c) {
            array.data(r,c) = r * c;
        }
    }

    std::cout << "8 x 7 = " << array.data(8,7) << std::endl;

    return 0; // array goes out of scope here, memory released automatically
} 
```

当你运行这个你会得到

```
8 x 7 = 56 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-11T00:08:51.807

如果你在乎，你可以有一个帮手更方便一点

```
template <typename T>
struct C3DArray
{
    vector<vector<vector<T>>> m;
    C3DArray(int size_x, int size_y, int size_z)
        : m(make(T(), size_z, size_y, size_x))
    { }

    template <typename U> static std::vector<U> make(U v, size_t n) {
        return { n, std::move(v) };
    }

    template <typename U, typename... Dim> static auto make(U v, size_t n, Dim... other)
        -> std::vector<decltype(make(v, other...))> {
        return { n, make(v, other...) };
    }
}; 
```

这使用可变参数。像这样使用它：

```
C3DArray<int> arr(3,4,20); 
```

# mysql - NLog mySQL 目标配置

> ID：12830199
> 
> 赞同：1
> 
> 时间：2012-10-10T23:51:37.330
> 
> 标签：mysql, target, nlog

我正在尝试使用 NLog 来使用 mySQL 表。我似乎正确设置了配置，但是我收到以下错误（在 NLog 中捕获异常）。

2012-10-10 17:09:20.0200 错误初始化目标数据库目标时出错 [slogger] System.Configuration.ConfigurationErrorsException：找不到或加载已注册的 .Net Framework 数据提供程序。在 System.Data.Common.DbProviderFactories.GetFactory(DataRow providerRow) 在 System.Data.Common.DbProviderFactories.GetFactory(String providerInvariantName) 在 NLog.Targets.DatabaseTarget.InitializeTarget() 在 NLog.Targets.Target.Initialize(LoggingConfiguration 配置) .

我认为此错误与数据库目标配置页面中的“参数名称应为在 machine.config 或 app.config 中注册的提供程序不变名称”语句有关，但我不确定如何更正该错误。我在应用程序中引用了 mySQL DLL。

以下是我的配置：

![日志目标](../Images/63e9f0d965585637de5ab779723e3d89.png)

请让我知道我做错了什么以及如何改变。我真的很感激帮助。这真的是一个很酷的应用程序！

谢谢

射线

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2015-02-18T15:15:33.797

尝试将 dbProvider 更改为此 `dbProvider="MySql.Data.MySqlClient.MySqlConnection, MySql.Data"`

# scala - 相当于 Ant 目标的 SBT

> ID：12830201
> 
> 赞同：0
> 
> 时间：2012-10-10T23:51:59.480
> 
> 标签：scala, ant, sbt, target

Ant 目标的 SBT 等效项（如果有）是多少？例如，Ant 的 build.xml 文件中的片段将是：

```
<target name="runClient" description="run client">
    <java classname="client.Client" fork="true">
        <jvmarg value="-Djava.rmi.server.codebase=${client_web_codebase}"/>
        <jvmarg value="-Djava.security.policy=policy"/>
        <arg value="localhost"/>
        <classpath>
            <pathelement location="dist/client.jar"/>
        </classpath>
    </java>
</target> 
```

然后我会做一些事情，比如`ant runClient`使用 XML 中指定的 jvmargs 启动应用程序“client.Client”。是否有 SBT 等效项，或者 SBT 挂钩到 Ant 来执行此操作的方法？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-11T21:33:32.773

你可以使用[Sbt Tasks](http://www.scala-sbt.org/release/docs/Detailed-Topics/Tasks)来做到这一点。您定义的任务可以依赖于其他任务和/或设置（例如，您的项目基目录）：

```
import sbt._
import Keys._

object TestBuild extends Build {
  lazy val runClient = TaskKey[Unit]("runClient", "run client")

  lazy val root = Project("Test", file("."),
    settings = Defaults.defaultSettings ++ Seq(
    runClient <<= baseDirectory map {
      base =>
        val clientWebCodebase = base / "yourpath"
        val opts = Seq("-Djava.rmi.server.codebase=" + clientWebCodebase,
          "-Djava.security.policy=policy",
          "-cp", "dist/client.jar",
          "client.Client", "localhost"
        )
        Fork.java.fork(None, opts, None, Map(), false, StdoutOutput)
      }
    )
  )
} 
```

拥有这样的任务定义，您可以使用以下方式运行它：

```
sbt runClient 
```

或在 sbt 外壳中：

```
>runClient 
```

您甚至可以使用 Tab 补全：runC + tab :)

# c++ - 我应该如何在一个函数中锁定 wxMutex 并在另一个函数中解锁它？

> ID：12830206
> 
> 赞同：2
> 
> 时间：2012-10-10T23:52:52.447
> 
> 标签：c++, multithreading, thread-safety, wxwidgets, mutex

我应该实现自己的日志记录类，以便在具有两个线程的程序中使用，主线程和可连接的处理线程。我不希望任何一个线程在另一个线程使用记录器时使用它，所以我想我会使用 wxMutex。记录器必须像带有 operator<< 的 C++ ostream 一样工作，除了流操纵器函数（例如 std::endl）将指示记录器输出的结束。我想我需要一个递归互斥锁，以便在互斥锁被锁定时同一个线程可以继续输出。

问题（我认为）是互斥锁没有完全解锁，所以当另一个线程试图输出到记录器时，它会死锁。

我的代码中是否有我遗漏的东西？

```
class Logger{
  private:
    std::ostream* out;
    wxMutex* mut;
  ....
  public:
    template<class T>
    Logger& operator<<(T str){ // accept any type of input and lock outputting until finished
      if(out){
        if(mut->TryLock() == wxMUTEX_BUSY){ // if we didn't get lock
          mut->Lock(); // we block
        }
        if(out){
          (*out) << str;
          out->flush();
        }
        //mut->Unlock(); // leave locked until done outputting (use std::endl or similar)
      }
      return *this;
    }

    // accept stream manipulators and unlock stream output
    Logger& operator<<(std::ostream& (*pf) (std::ostream&)){
      if(out){
        if(mut->TryLock() == wxMUTEX_BUSY){
          mut->Lock();
        }
        (*out) << pf;
        out->flush();
        while(mut->Unlock()!= wxMUTEX_UNLOCKED);
      }
      return *this;
    }
}; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-11T06:24:59.313

如果您担心线程问题，您可以改为创建一个宏，以确保在输出之前获取互斥锁并在输出之后释放。

就像是：

```
#define LOG(logger, output) \
    do { logger.lock(); logger << output; logger.unlock(); } while (0)

Logger my_logger;
int some_integer = 5;
LOG(my_logger, "Hello world!" << some_integer << std::endl); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-11T12:50:38.917

首先，wxWidgets 2.9`wxLog`本身是 MT 安全的，您可以为每个线程拥有独立的日志目标，因此也许您可以直接使用它而不是自己编写。

其次，使用`TryLock()`是可疑的，如果您希望能够重新锁定已经属于当前线程的互斥锁，您应该`wxMUTEX_RECURSIVE`在创建互斥锁时使用并简单地使用`Lock()`。但是我个人认为使用递归互斥锁是一个*坏*主意，因为它会使您的 MT 代码变得不那么清晰并且更难以推理，这几乎总是灾难性的。

最后，依靠某人打电话的整个想法`<< endl`是错误的。很容易忘记在某个地方执行此操作并让互斥锁处于锁定状态，从而阻止所有其他线程继续执行。您绝对应该创建一个代理对象，将互斥锁锁定在其 ctor 中并在其 dtor 中解锁，并使用它来确保在执行日志记录的语句结束时始终解锁互斥锁。我认为通过使用这种技术，您也应该避免使用递归互斥锁。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-11T00:57:49.243

我可能错了，但在我看来，您正试图在互斥锁已在使用时对其进行锁定。

```
if(mut->TryLock() == wxMUTEX_BUSY) // if TryLock() returns wxMUTEX_BUSY another thread is using it.
{
    mut->Lock(); // A dead lock situation could be detected here because Lock() also returns an error code.
} 
```

TryLock() 通常尝试在不阻塞的情况下获取互斥锁。因此，如果互斥体已经忙于该调用，则意味着另一个线程正在使用它。

您可以查看[wxMutex](http://docs.wxwidgets.org/2.8/wx_wxmutex.html)中的此链接，该链接解释了每个函数的工作原理。他们的函数返回值，因此您可以使用它来查看程序中出了什么问题。

请参阅下面他们网站上的文档。

> **wxMutex::Lock**
> 
> **wxMutexError Lock()**
> 
> 锁定互斥对象。
> 
> 返回值
> 
> 之一：
> 
> **wxMUTEX_NO_ERROR** 没有错误。
> 
> **wxMUTEX_DEAD_LOCK** 检测到死锁情况。

# c++ - 未使用的“新长”循环之后的所有内容在 C++ 中运行得更快

> ID：12830217
> 
> 赞同：-2
> 
> 时间：2012-10-10T23:54:03.707
> 
> 标签：c++, optimization, memory-management

我对此感到困惑..这个：

```
for (int j=0; j<100; ++j) {
  long* data = new long[0];
}

clock_t launch = clock();
sim.Run();
clock_t done = clock(); 
```

运行速度比仅此一项快 50%：

```
clock_t launch = clock();
sim.Run();
clock_t done = clock(); 
```

这是在使用 -O3 时。如果我使用 -O0 则执行时间没有区别。不管是`long`还是`short`不重要。向量的长度也不会改变任何东西。我没有`data`在任何地方使用。如果我`delete[] data;`在循环中，改进就会消失。当我将迭代次数减少到以下`100`时，性能增益会降低；上面`100`没有任何区别。

如果这是 Java，我会认为我正在触发 GC，但这是 C++！此外，它是一个单线程软件，所以它不应该是内存共享优化的东西。

这会是什么？这种行为是否是我的代码中内存管理不善的症状？谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-11T11:06:17.520

你怎么说，“长 50%”？我们是在谈分钟，还是在谈秒？

在几秒钟的情况下，它可能只是一个同步错误（两个`clock_t`可能相差最多两秒，而实时变化不会超过百分之几秒）。

但我的猜测是我们正在寻找更长的时间。并且在不查看您的代码的情况下，我怀疑通过分配“泄漏”的内存可以“启动”内存堆，以便以后更快地检索信息。

这告诉我，是的，您的内存管理可能不是最优的，并且可能会从预分配和重用内存（“[对象池](http://en.wikipedia.org/wiki/Object_pool_pattern)”）中受益。

“启动”内存堆，我的意思是内存分配通常需要*内存管理器*来跟踪堆内存。在更简单的情况下使用链表。即使您没有*垃圾收集器*，您仍然有一个*内存管理器*，它位于`malloc`,`free`等后面`realloc`（以及`new`，就此而言）。MM**可以**通过向操作系统请求大块，然后将其分配给应用程序，和/或通过“调整”您在请求中发出的请求来操作，这些请求可能由操作系统更好/更快地处理。例如，操作系统通常“看到”*页面中的内存*1K，4K，64K，取决于。如果您为自己分配 50 个 10 字节的字符串，它们可能会发现自己位于不同的页面并浪费大量内存。MM 在看到你第一次请求 10 字节时可能会分配 4096，然后将它们以 10 字节为单位打包给你。

现在（我要在这里冒险了！），假设您的应用程序需要分配与整个页面相等的内存，分十块。由于程序本身需要少量开销，您的初始堆分配是四分之一页。

所以你继续分配你的十个块。前六个适合部分空的页面零；接下来的四个请求新分配一个新页面，即第一页。

分配完成后，您开始在块之间来回处理数据，而不会意识到它们位于两个不同的页面中。根据操作系统、编译器、优化和天气预报，这可能意味着*这些操作会产生开销*。

现在让我们假设您分配并泄漏了四分之三的页面。然后，当您分配第一个块时，它不适合第 0 页，而第一个 - 和剩余的 9 个 - 块全部进入并适合第 1 页。如果 -O3 优化利用同页数据访问，您将体验到**依赖于编译器**的性能提升。

**请记住，这只是一个临时假设**。在我看来这似乎是合理的，但这并不能真正保证任何事情:-)

有关 libc 标准内存管理的更多详细信息（其他存在）here

```
http://www.chemie.fu-berlin.de/chemnet/use/info/libc/libc_3.html#SEC27 
```

您还可以查看[Google 的 C++ 工具](http://code.google.com/p/gperftools/?redir=1)。

# c++ - C++：链表排序

> ID：12830221
> 
> 赞同：0
> 
> 时间：2012-10-10T23:54:49.007
> 
> 标签：c++, linked-list

我有一个功能，它应该组织一个词干词典。我插入了一个函数调用，然后假设按正确的字母顺序放置它。添加到列表的前面和中间有效，但添加到后面不起作用。我查看了几个来源，但我不知道出了什么问题。

```
void dictionary::insert(string s) {
    stem* t = new stem;

    t->stem = s;
    t->count =0;
    t->next = NULL;

    if (isEmpty()) head = t;
    else {
        stem* temp = head;
        stem* prev =  NULL;

        while (temp != NULL) {
            if (prev == NULL && t->stem < temp ->stem) {
                head = t;
                head->next = temp;
            }
            prev = temp;
            temp = temp->next;

            if(t->stem > prev->stem && t->stem < temp->stem ){
                prev->next =t;
                t->next=temp;
            }
        }

        if(temp == NULL && t->stem > prev->stem){  
            prev->next=t;
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-11T00:12:06.127

```
if (temp->next=NULL) {
    prev->next = t; 
} 
```

请注意单个等号的用法。这样做的效果是设置`temp->next`to`NULL`然后评估`if (NULL)`witch 将始终为 false。你应该使用`==`.

* * *

这可能会完成这项工作：（对不起，我现在没有编译器来测试它）

```
#include <string>

struct node;
struct node
{
    node* next;
    std::string value;
};

node* head = NULL;

void insert(const std::string& word)
{
    node* n = new node;
    n->value = word;
    node* temp = head;
    node** tempp = &head;
    while (true)
    {
        if (temp == NULL or temp->value > word)
        {
            n->next = temp;
            *tempp = n;
            return;
        }
        temp = temp->next;
        tempp = &temp->next;
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-11T00:19:49.753

if(temp->next=NULL) 语句不会产生布尔值，而是赋值。这就是为什么插入到列表末尾似乎不起作用的原因。

# primefaces - 如何用 jquery 隐藏 p:commandbutton 使用 primefaces 3.4

> ID：12830224
> 
> 赞同：2
> 
> 时间：2012-10-10T23:55:12.410
> 
> 标签：primefaces

我打算`<p:commandbutton>`通过一个 jquery 表单隐藏一个，并且我无法访问对象 primefaces 按钮，表单本身。我正在使用primefaces 3.4。

我隐藏了一个按钮：以一种形式保存，按钮所在的位置：编辑：

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-11T02:00:33.357

您可以使用渲染属性并将其设置为 false。

```
<p:commandButton rendered="false" 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-11T05:04:36.803

您可以通过其 ID 访问按钮，只需添加`display:none`css 属性：

```
$("#yourButtonsId").css("display", "none); 
```

当按钮在没有 的表单中时`prependId=false`，按钮 ID 类似于`:testForm1:testButton`您的 jQuery 选择器，如下所示：

```
$("#testForm1\\:testButton").css("display", "none"); 
```

# design-patterns - 用于扩展可区分联合的“设计模式”

> ID：12830225
> 
> 赞同：1
> 
> 时间：2012-10-10T23:55:25.463
> 
> 标签：design-patterns, discriminated-union

众所周知，类继承是“开放的”类型层次结构，而有区别的联合是“封闭的”类型层次结构。然而，虽然添加新的子类很容易，但添加新的虚函数需要修改所有现有类。同时，有区别的工会可以很容易地添加新的功能。

```
 | inheritance | discriminated union
new type     | easy        | hard
new function | hard        | easy 
```

OOP 已经出现了足够多的时间，以至于我们经历了“向类型层次结构中添加新方法”的困难，并且在“修改所有类”不是一个好选择的情况下，我们提出了诸如访问者模式之类的东西为现有类型添加新功能。

例如：

```
class Base       Base.f()    Base.g()
class A : Base   A.f()       A.g()
class B : Base   B.f()       B.g() 
```

因为添加虚拟`Base.h()`是困难的，所以我们使用访问者模式，所以可以封装未来的功能。*这基本上是模式匹配函数的基于继承的类似物！*

```
class H : BaseVisitor { 
   visit(A)  { } 
   visit(B)  { }
}
// this looks really similar to:
let H something = 
    match something with 
    | A -> ..
    | B -> .. 
```

**TLDR：**是否有一种常见的抽象（类似于访问者模式）来处理向可区分联合添加类型？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-18T12:15:14.943

如果我正确理解你的问题，我会支持桥模式。它使您可以独立于其实现来改变接口/抽象，从而实现结构上的灵活性。但是，我从来没有需要使用桥接模式。

希望有所帮助：D

# background - 在java中按下没有框架的键（或背景中的框架）

> ID：12830227
> 
> 赞同：1
> 
> 时间：2012-10-10T23:55:53.233
> 
> 标签：background, mouse, keylistener

我创建了一个使用键盘控制鼠标的程序。我将 KeyListener 实现到一个名为 Keyboard 的类，然后我创建了一个名为 frame 的 JFrame，它添加了这个键盘类。这是解释我在做什么的代码的一部分：

```
class Keyboard implements KeyListener
{
    //Overrides key methods
}

class MainClass
{
    public static void main(String [] args)
    {
        JFrame frame = new JFrame();
        frame.setSize(width, height);
        frame.addKeyListener(new Keyboard());
        frame.setVisible(true);
    }
} 
```

我的问题是我希望程序在未选择框架时运行（甚至更好，没有框架）。例如，当我选择另一个程序（浏览器、Word 等）的另一个窗口时，使用键盘时鼠标不会移动。我必须选择我的程序窗口来控制鼠标。

我怎样才能做到这一点？

谢谢。

# jquery - jQuery查找壁橱元素

> ID：12830229
> 
> 赞同：0
> 
> 时间：2012-10-10T23:56:07.100
> 
> 标签：jquery, html, css, class, css-selectors

我正在寻找找到并选择“活动”类的 5 个最接近的“li”（二、三、四、五和六）的方法。有什么想法吗？

```
<li class="one">Hello</li>
<li class="two">Hello</li>
<li class="three">Hello</li>
<li class="four active">Hello</li>
<li class="five">Hello</li>
<li class="six">Hello</li>
<li class="seven">Hello</li>
<li class="eight">Hello</li> 
```

谢谢 ：）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-11T00:05:41.417

您可以使用`index`和`slice`方法：

```
var $li = $('li');
var ind = $li.filter('.active').index(); 
if ( ind-2 < 0 ) ind = 0;

$li.slice(ind-2, ind+3); 
```

[http://jsfiddle.net/dc8Xu/](http://jsfiddle.net/dc8Xu/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-11T00:15:13.940

尝试这个：

```
var $a = ​$( ".active" ),
    $all = $a.​​​​​​siblings().andSelf(),
    i = $all.index( $a ),
    i0 = i < 2 ? 0 
    : i + 5 > $all.length ? $all.length - 5 : i - 2;
    $five = $all.slice( i0, i0 + 5 ); 
```

$five 是你的收藏。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-11T00:05:30.487

不是我给过的最漂亮的代码示例......但确实有用:)

```
var activeItem = $('li.active');

activeItem.prev('li').addClass('active').prev('li').addClass('active');
activeItem.next('li').addClass('active').next('li').addClass('active'); 
```

我在这里使用了 jQuery 的一个特性，称为链接。这意味着我使用的函数实际上返回了执行操作的对象本身。所以这个`addClass()`函数实际上返回了我们添加类的项目。这允许我们将函数“链接”在一起。

### [在此处查看实际操作](http://jsfiddle.net/JbPTD/1/)

参考 -

*   [`next()`](http://api.jquery.com/next/)
*   [`prev()`](http://api.jquery.com/prev/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-11T00:31:47.400

如果你必须有 5 个结果：

```
var length = $('li').length;
var start = $('.active').index() - 2;
start = start + 5 > length ? length - 6 : start;
start = start < 0 ? 0 : start;
var result = $('li').slice(start, start + 5); 
```

应该这样做。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-10-11T00:45:34.020

单行答案

```
$('li.active').prevAll().andSelf().slice(-3).add('li.active + *').add('li.active + * + *').css('color','red'); 
```

说明：首先获取活动项之前的所有元素，[`prevAll`](http://api.jquery.com/prevAll/)然后添加活动项本身，并且只返回最后3项与[`slice`](http://api.jquery.com/slice/)函数。使用包含特殊选择器`li.active`的函数添加后面的项目[`add`](http://api.jquery.com/add/)[`+`](http://api.jquery.com/next-adjacent-Selector/)

[演示](http://jsfiddle.net/nhP33/)

# php - php包含不起作用

> ID：12830236
> 
> 赞同：0
> 
> 时间：2012-10-10T23:56:24.977
> 
> 标签：php

我试图让我的 config.php 文件工作，但每次我将它与我的 login.php 一起使用时，它只会给我一个白页，而不是继续通过我的 login.php 文件访问我的 members.php 页面。我将连接信息放入我的 login.php 脚本中，它可以正常工作，下面列出了我一直在尝试做的事情。

配置文件

```
<?php 

$con = mysql_connect("mysql","DBUSER","DBPASS");
if (!$con)
{
die('Could not connect: ' . mysql_error());
}

mysql_select_db("DBNAME", $con);

/* WHAT I ORIGINALLY WANTED TO USE
$localhost = "mysql";
$dbuser = "DBUSER";
$dbpass = "DBPASS";
$dbname = "DBNAME";

$connect = mysql_connect($localhost, $dbuser, $dbpass);
mysql_select_db("$dbname", $connect); 
*/

?> 
```

登录.php

```
<?php
// I ALSO USED includes"config.php";
require("config.php");

$username = $_POST['username'];
$password = $_POST['password'];

$query = mysql_query("SELECT * FROM member WHERE username = '$username' AND password =       '$password'");
$data = mysql_fetch_assoc($query);

if(mysql_num_rows($query)){
session_start();
$_SESSION['username'] = $data['username'];
header("Location: members.php");
exit;
}

header("Location: index.php");

?> 
```

我是 PHP 新手，所以不要嘲笑我的代码，请感谢您的帮助！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-11T00:01:09.557

在您的代码之上打开错误：

```
ini_set("display_errors","On"); 
```

并确保您可以看到您的 mysql 错误：

```
$query = mysql_query(...) or die("Error: ".mysql_error()); 
```

最后一件事：尽管`mysql_*`函数已被弃用，但如果您使用它们，请始终在查询中使用之前转义您的数据；你可能成为[SQL 注入](http://php.net/manual/en/security.database.sql-injection.php)的受害者。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-11T09:14:22.513

尝试使用：

```
include "config.php"; 
```

应该`include`不是`includes`

# python - python 2.7 - 递归斐波那契爆炸

> ID：12830239
> 
> 赞同：3
> 
> 时间：2012-10-10T23:56:50.780
> 
> 标签：python, recursion

我有两个函数`fib1`来`fib2`计算斐波那契。

```
def fib1(n):
    if n < 2:
        return 1
    else:
        return fib1(n-1) + fib1(n-2)

def fib2(n):
    def fib2h(s, c, n):
        if n < 1:
            return s
        else:
            return fib2h(c, s + c, n-1)
    return fib2h(1, 1, n) 
```

`fib2`工作正常，直到它破坏递归限制。如果理解正确，Python 不会针对尾递归进行优化。这对我来说很好。

让我感到惊讶`fib1`的是，即使`n`. 为什么会这样？为什么它在变得迟缓之前没有达到递归限制？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-11T00:28:45.547

基本上，您通过反复计算相同的 n 值的 fib1 来浪费大量时间。您可以像这样轻松地记住函数

```
def fib1(n, memo={}):
    if n in memo:
        return memo[n]
    if n < 2:
        memo[n] = 1
    else:
        memo[n] =  fib1(n-1) + fib1(n-2)
    return memo[n] 
```

您会注意到我使用空字典作为默认参数。这通常是一个坏主意，因为每个函数调用都使用相同的 dict 作为默认值。

在这里，我利用它来记忆我计算的每个结果

您还可以使用 0 和 1 来初始化备忘录以避免需要`n < 2`测试

```
def fib1(n, memo={0: 1, 1: 1}):
    if n in memo:
        return memo[n]
    else:
        memo[n] =  fib1(n-1) + fib1(n-2)
    return memo[n] 
```

变成

```
def fib1(n, memo={0: 1, 1: 1}):
    return memo.setdefault(n, memo.get(n) or fib1(n-1) + fib1(n-2)) 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-10-11T00:12:55.193

你的问题不是python，而是你的算法。`fib1`是[树递归](http://mitpress.mit.edu/sicp/chapter1/node13.html "树递归")的一个很好的例子。你可以[在 stackoverflow](https://stackoverflow.com/questions/360748/computational-complexity-of-fibonacci-sequence)上找到这个特定算法是 (~ ) 的证明。`θ(1.6`^(`n`)`)`

`n=30`（显然来自评论）大约需要三分之一秒。如果计算时间扩大为`1.6^n`，我们预计`n=100`需要大约[210 万年。](https://www.google.com/search?q=1.6%5E100%20/%201.6%5E30%20*%200.35%20seconds&oq=1.6%5E100%20/%201.6%5E30%20*%200.35%20seconds)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-10-11T00:09:48.613

想想每个中的递归树。第二个版本是递归的单个分支，在函数调用的参数计算中进行添加，然后返回值。正如您所指出的，Python 不需要尾递归优化，但如果尾调用优化是您的解释器的一部分，则也可以触发尾递归优化。

另一方面，第一个版本在每个级别都需要 2 个递归分支！因此，该函数的潜在执行次数大幅增加。不仅如此，大部分工作还要重复两次！考虑：`fib1(n-1)`最终`fib1(n-1)`再次调用，这与`fib1(n-2)`从第一个调用帧的参考点调用相同。但是在计算出那个值之后，它必须`fib1(n-2)`再次加到 的值上！因此，这项工作被不必要地重复了很多次。

# objective-c - 在计算器应用程序中退格数字

> ID：12830240
> 
> 赞同：1
> 
> 时间：2012-10-10T23:57:05.353
> 
> 标签：objective-c, cs193p

有人可以解释这段代码吗

```
- (IBAction)backspacePressed {
   self.display.text =[self.display.text substringToIndex:
                  [self.display.text length] - 1]; 

   if ( [self.display.text isEqualToString:@""]
      || [self.display.text isEqualToString:@"-"]) {

      self.display.text = @"0";
      self.userIsInTheMiddleOfEnteringNumber = NO;
   }
} 
```

我不明白目标 c 中的 2 行是什么意思。|| 另外，我不明白 substringToIndex 的含义。程序员如何知道在我看到 substringFromIndex 等文档中的所有不同方法中使用 substringToIndex 。有很多。这是否表示索引中的字符串被计算在内，-1 表示它删除了一个字符串？苹果文档中的含义与删除字符有何关系？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-11T11:29:17.573

注释提供了代码解释...

```
- (IBAction)backspacePressed
{
   // This is setting the contents of self.display (a UITextField I expect) to
   // its former string, less the last character.  It has a bug, in that what
   // happens if the field is empty and length == 0?  I don't think substringToIndex
   // will like being passed -1...
   self.display.text =[self.display.text substringToIndex:
                  [self.display.text length] - 1]; 

   // This tests if the (now modified) text is empty (better is to use the length
   // method) or just contains "-", and if so sets the text to "0", and sets some
   // other instance variable, the meaning of which is unknown without further code.
   if ( [self.display.text isEqualToString:@""]
      || [self.display.text isEqualToString:@"-"]) {

      self.display.text = @"0";
      self.userIsInTheMiddleOfEnteringNumber = NO;
   }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-11T11:24:38.733

|| 是 OR 运算符。至少其中一项陈述必须是真实的。

查看 Apple 的 substringToIndex: 方法的文档

[https://developer.apple.com/library/mac/#documentation/Cocoa/Reference/Foundation/Classes/NSString_Class/Reference/NSString.html](https://developer.apple.com/library/mac/#documentation/Cocoa/Reference/Foundation/Classes/NSString_Class/Reference/NSString.html)

这是您可以通过 google 搜索轻松找到的内容。

# internet-explorer - Tabindex 在 IE 中无法用于 jquery 远程验证

> ID：12830242
> 
> 赞同：0
> 
> 时间：2012-10-10T23:57:24.970
> 
> 标签：internet-explorer, jquery-validate, tabindex

我有一个网站在注册和登录页面上使用[http://docs.jquery.com/Plugins/Validation/Methods/remote](http://docs.jquery.com/Plugins/Validation/Methods/remote)来检查用户名是否存在。

它在 Chrome 和 Firefox 中运行良好。

但是，在IE7-9中，存在这个问题：

如果您键入用户名并快速按 Tab 键（进入下一个字段），焦点不会集中在下一个字段上，而是会跳转到浏览器地址栏。（实际上，有时它正确地专注于下一个领域；它似乎取决于远程响应的速度。）

我已经尝试了 1.9.0 和 v1.10.0 的全新下载。

有什么想法吗？

PS 我在 Win XP sp2 上测试了原生 Internet Explorer 7，在 Win7 上测试了 IE9。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-12T23:23:00.913

这似乎是修复：

我有一行在页面加载后将光标集中在用户名字段上。但是由于我使用的是持久占位符（http://jsfiddle.net/mrcoles/Kwsts/），所以我以迂回的方式做到了：

`$('#username').parent().children('label').click();`

当我将其更改为 时`$('#username').focus();`，它起作用了。

我不知道发生冲突的位置/原因，但似乎已通过删除该单击处理程序来解决。

# erlang - 如何提供价值并取回钥匙

> ID：12830247
> 
> 赞同：1
> 
> 时间：2012-10-10T23:57:41.527
> 
> 标签：erlang

所以我做了2个数据库：

1.  Db1 包含：`[{james,london}]`
2.  Db2 包含：`[{james,london},{fredrik,berlin},{fred,berlin}]`

我有一个看起来像这样的匹配函数：

```
match(Element, Db) -> proplists:lookup_all(Element, Db). 
```

当我这样做时：`match(berlin, Db2)`我得到：`[ ]`

我想要得到的是一种输入值并以这种方式取回密钥的方法：`[fredrik,fred]`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-11T00:21:23.957

关于文档的`proplists:lookup_all`其他方式：

```
Returns the list of all entries associated with Key in List. 
```

因此，您只能通过键查找：

```
(kilter@127.0.0.1)1> Db = [{james,london},{fredrik,berlin},{fred,berlin}].
[{james,london},{fredrik,berlin},{fred,berlin}]
(kilter@127.0.0.1)2> proplists:lookup_all(berlin, Db). 
[]
(kilter@127.0.0.1)3> proplists:lookup_all(fredrik, Db).
[{fredrik,berlin}] 
```

您可以使用`lists:filter`and`lists:map`代替：

```
(kilter@127.0.0.1)7> lists:filter(fun ({K, V}) -> V =:= berlin end, Db).       
[{fredrik,berlin},{fred,berlin}]
(kilter@127.0.0.1)8> lists:map(fun ({K,V}) -> K end, lists:filter(fun ({K, V}) -> V =:= berlin end, Db)).
[fredrik,fred] 
```

所以，最后

```
match(Element, Db) -> lists:map(
    fun ({K,V}) -> K end, 
    lists:filter(fun ({K, V}) -> V =:= Element end, Db)
). 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-11T00:22:15.483

`proplists:lookup_all/2`将键作为第一个参数；在您的示例中，`berlin`是一个值，它不是一个键，因此返回一个空列表。

自然地，您可以使用递归并找到所有元素（这意味着您将像使用普通列表而不是 proplist 一样使用它）。

另一种解决方案是更改编码方案：

```
[{london,james},{berlin,fredrik},{berlin,fred}] 
```

然后使用`proplists:lookup_all/2`

对其进行编码的正确方法取决于您访问数据的方式（您将执行最多的“查询”类型）；但除非您操作大量数据（在这种情况下您可能想要使用其他数据[结构](http://learnyousomeerlang.com/a-short-visit-to-common-data-structures#key-value-stores)），否则它并不值得分析。

# javascript - 更改 javascript 缩略图的 alpha 级别

> ID：12830249
> 
> 赞同：0
> 
> 时间：2012-10-10T23:58:11.027
> 
> 标签：javascript, jquery, css, plugins

我正在使用插件来显示图像轮播。用于导航的缩略图被设置为当前未选择的任何图像都“变灰”。如何更改它们“变灰”的程度？

[现场直播。](http://urbanpalate.com/)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-11T00:18:39.270

不透明度在文件第 228 行的选择器中指定`settings.css`：

```
.tp-bullets.tp-thumbs .bullet {
    ...
    opacity: 0.5;
    ...
} 
```

那里还有其他特定于供应商的属性（包括`-ms-filter`IE 的属性），因此您必须更改它们以匹配。

# vb.net - VB.NET Datagridview 排序而不排序总计

> ID：12830252
> 
> 赞同：0
> 
> 时间：2012-10-10T23:58:13.167
> 
> 标签：vb.net, sorting, datagridview

我有一个交叉表的datagridview。当用户单击其中一个列标题时，我想对 datagridview 进行排序，但我不希望对最终（总）行进行排序。有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-11T00:23:50.100

您可以通过将最后一行分配给临时网格线并`.RemoveAt(lineID)`在网格上执行 a 来临时将其从列表中取出，然后排序，最后将临时网格线重新附加到网格上。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-14T17:32:39.653

最终使用了 XCeed 的自定义 DataGridView。它在控件中内置了一个摘要行。看起来有点矫枉过正，但是，嘿，你会怎么做？

# assembly - GAS 无法识别寄存器 %ip

> ID：12830253
> 
> 赞同：1
> 
> 时间：2012-10-10T23:58:13.457
> 
> 标签：assembly, gnu-assembler, att

在我的 16 位程序中，GAS 对指令犹豫不决：

```
movw %ip, %dx 
```

我觉得这很奇怪，因为移动段寄存器可以正常工作，例如：

```
movw %ss, %ax 
```

完整的错误信息是：

> 错误：错误的寄存器名称 `%ip'

我的版本字符串是：

> GNU 汇编器 (GNU Binutils) 2.22

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-11T00:05:13.517

不幸的是，并非每个寄存器都可以轻松访问。有一些限制。

如[x86 wikibook GPR 部分](http://en.wikibooks.org/wiki/X86_Assembly/X86_Architecture#General-Purpose_Registers_.28GPR.29)中所列，在 x86 中有 8 个通用寄存器 (GPR)：AX、CX、DX、BX、SP、BP、SI、DI，可用于许多命令。它们被编码为 3 位；并且指令编码中没有空间来编码特殊寄存器，如 EIP (IP) 或 EFLAGS (FLAGS)。

如果你向下滚动wikibook，有一个关于IP的部分：

> **指令指针**
> 
> 如果没有进行分支，EIP 寄存器包含要执行的下一条指令的地址。
> 
> EIP 只能在调用指令后通过堆栈读取。

所以，用mov读取IP确实是违法的。

这里有一些使用`call`then`pop %ax`序列读取 ip 的示例：http: [//www.programmersheaven.com/mb/x86_asm/267963/267963/how-to-access-ip-register/](http://www.programmersheaven.com/mb/x86_asm/267963/267963/how-to-access-ip-register/)

更新：关于读取 SS 寄存器：

mov 指令编码实际上有很多变体，例如在这张[表中](http://ref.x86asm.net/coder32-abc.html#M)，我们看到了段读取

```
 mnemonic   op1 op2 po     o    description, notes 
 MOV    Sreg    r/m16   8E     r        Move 
```

或控制寄存器写入：

```
 MOV    r32 CRn 0F20   r ...    Move to Control Registers 
```

但仍然没有用于 IP 寄存器的 MOV。

更新 2：根据[https://stackoverflow.com/a/1047968/196561 ，在 x86_64 中有一个带有 LEA 的 EIP 读数](https://stackoverflow.com/a/1047968/196561)

# javascript - HTML5 命中检测是否可行？

> ID：12830255
> 
> 赞同：5
> 
> 时间：2012-10-10T23:58:51.570
> 
> 标签：javascript, png, html5-canvas

我使用本网站其他地方提供的 Canvas 代码创建了一个屏幕，其中有几个重叠的透明 png，其中不透明部分是不规则形状。我可以得到光标下的颜色，这很棒。但是我的形状都是相同的颜色，我需要一种方法来获取特定形状的 ID，以便我知道点击了哪个形状。想象一张由覆盖国家/地区的重叠 png 组成的地图，您想检测点击了哪个国家/地区。据我所知，id 检测仅适用于矩形区域。有什么建议么？

```
$('#myCanvas').click(function(e){
var position = findPos(this);
var x = e.pageX - position.x;
var y = e.pageY - position.y;
var coordinate = "x=" + x + ", y=" + y;
var canvas = this.getContext('2d');
var p = canvas.getImageData(x, y, 1, 1).data;
var hex = "#" + ("000000" + rgbToHex(p[0], p[1], p[2])).slice(-6);
alert(hex);
}); 
```

此代码获取并显示颜色（为清楚起见，findPos 和 rgbToHex 是分开的函数）。我要身份证！帮助！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-11T02:08:25.883

即使有透明度，图像也是矩形。然后，您可以通过矩形交叉点知道哪些图像位于单击点 - 检查您的图像数组及其 x、y 点的宽度、高度是否有交叉点。然后，您会想出一系列可能被点击的图像。如果列表中只有一个，那么您就完成了。

这些图像具有与您编写它们的相反顺序的隐含 Z 顺序，这意味着，一个图像被与其重叠的下一个写入的图像覆盖。您可以使用它来知道如果在单击点处有多个，则尝试使用哪个顺序进行命中测试。唯一的技巧是检测图像像素是否透明。

要检测单个图像中单击的像素点的透明度，您可以保留第二个隐藏的画布元素。清除它，然后将目标图像写入它的相同位置，并使用相同的代码查看第二个画布内点击的像素是否为透明色。如果是，请对 Z 顺序中的下一个图像重复此过程，直到您获得单击了非透明像素的图像。

一个小而重要的优化是首先检查点击的颜色，如果它是透明颜色，您已经知道没有任何图像被点击在不透明的点上。

# php - csv 文件导入 mysql 与 php 行返回

> ID：12830257
> 
> 赞同：0
> 
> 时间：2012-10-10T23:59:12.037
> 
> 标签：php, mysql, csv, import

我有一个保存为 csv 文件的 Excel 电子表格。我有一个 php 脚本，用于将 csv 导入 mysql 数据库。我尝试导入它，它会通过一半并失败，经过大量试验和错误，我发现有时线路返回有问题，但我不知道为什么。例如，如果您查看下面的行（图 1.），它将运行导入正常，超过 20 行，到达下面的行并出错，如果我删除一行返回（图 2.），所以 2行变为一行，然后在同一位置添加一行返回（图 3。）并再次运行导入它可以工作。

图。1。

```
C10940,Design CLOSED,BRAN B,D4072/2,IN000773,IN000773,2003-06-18,GAG,VG232-232AULP,10
C12261,Newton,CHARLTON G,G4377,IN000908,IN000908,2003-06-18,GAG,VK230-110,31
C12261,Newton,CHARLTON G,G4377,IN000908,IN000908,2003-06-18,GAG,EB211-130,39 
```

图 2。

```
C10940,Design CLOSED,BRAN B,D4072/2,IN000773,IN000773,2003-06-18,GAG,VG232-232AULP,10C12261,Newton,CHARLTON G,G4377,IN000908,IN000908,2003-06-18,GAG,VK230-110,31
C12261,Newton,CHARLTON G,G4377,IN000908,IN000908,2003-06-18,GAG,EB211-130,39 
```

图 3。

```
C10940,Design CLOSED,BRAN B,D4072/2,IN000773,IN000773,2003-06-18,GAG,VG232-232AULP,10
C12261,Newton,CHARLTON G,G4377,IN000908,IN000908,2003-06-18,GAG,VK230-110,31
C12261,Newton,CHARLTON G,G4377,IN000908,IN000908,2003-06-18,GAG,EB211-130,39 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-11T00:07:49.923

您可能只想查看 MySQL 的本机[LOAD DATA INFILE](http://dev.mysql.com/doc/refman/5.0/en/load-data.html#id780182)

例如

```
LOAD DATA LOCAL INFILE /path/to/example.csv
INTO TABLE example_table_name
FIELDS TERMINATED BY ','
LINES TERMINATED BY '\r\n' 
```

# javascript - 选择具有所有相同元素标记的子组

> ID：12830266
> 
> 赞同：1
> 
> 时间：2012-10-11T00:00:40.137
> 
> 标签：javascript, jquery, html, css

我有一个包含四个段落标签的 div。加载页面时，我希望显示前两段，然后隐藏后面的段落元素，但我不知道该怎么做。为简单起见，我在下面的 jsfiddle 示例中将事件设置为按钮而不是文档就绪事件。

[http://jsfiddle.net/zTCFe/4/](http://jsfiddle.net/zTCFe/4/)

```
<div id="div">
<p>1 keep me shown</p>
<p>2 keep me shown</p>
<p>3 hide me</p>
<p>4 hide me</p>
</div>

<input type="button" value="press" id="button"/>

<script>

$('#button').click(function () {

$('#div').children().hide();

});

</script> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-11T00:05:03.160

你几乎在那里：

`$('#div').children(':gt(1)').hide();`

更多关于[:gt](http://api.jquery.com/gt-selector/)选择器的信息。

[http://jsfiddle.net/gromer/Tdue6/1/](http://jsfiddle.net/gromer/Tdue6/1/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-11T00:05:12.830

使用[:gt() 选择器](http://api.jquery.com/gt-selector/)来选择它们

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-11T00:05:36.353

您可以使用`:gt()`选择器：

```
$("#div p:gt(1)").hide(); 
```

或者，您也可以使用`.slice()`从 jQuery 对象的 DOM 数组中选择特定元素：

```
$("#div p").slice(2).hide(); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-10-11T00:07:49.500

作为替代方案，您也可以使用 .slice()

```
$('#div').children().slice(2).hide(); 
```

[http://api.jquery.com/slice/](http://api.jquery.com/slice/)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-10-11T01:07:42.987

您也可以为此使用 CSS

```
li:nth-child(-1n+2) {
    background: yellow;
} 
```

# c - Inserting error in an hashtable of queues as linked list?

> ID：12830267
> 
> 赞同：0
> 
> 时间：2012-10-11T00:00:43.030
> 
> 标签：c, linked-list, hashtable

I've implemented the following code for queues as a linked list. Now I'm trying to get an hashtable as an array of queues as a linked list. It works fine until I do insertion after deletion.

What is being done is a queue is implemented as linked list. So when I want to remove, I delete the head element and for insert I use tail.

To do an hashtable I maintain another linked list of keys in the order in which they were inserted. Deletion starts with first removing this key and going to that individual linked list and removing the head and updating the head.

```
#include<stdio.h>
#include<stdlib.h>

struct Node{
   int value;
   struct Node *next;
   struct Node* head;
   struct Node* tail;

};

struct Node* lruhashtable[10];
struct Node* trackHead;
struct Node* trackTail;

 void insert(int page)
 {
  if(trackHead==NULL)
  {

    trackHead=malloc(sizeof(struct Node));
    trackHead->value=(page-1)%10;
    trackHead->next=NULL;
    trackTail=trackHead;        
}
else
{
    struct Node* temp=malloc(sizeof(struct Node));
    temp->value=(page-1)%10;
    temp->next=NULL;
    trackTail->next=temp;
    trackTail=temp;

 }

}

void hashEntry(int page)
{
 struct Node** iter;
 iter=&lruhashtable[(page-1)%10];
 for(;*iter;iter=&(*iter)->next);
   *iter = malloc(sizeof **iter );

 (*iter)->value = page;  
 (*iter)->next = NULL;
 if((*iter)->head==NULL)  
 {
    (*iter)->head=*iter;
    (*iter)->tail= (*iter)->head;

 }
 else
 {
    (*iter)->tail->next=*iter;
    (*iter)->tail=*iter;

 }
 insert(page);

}

void deleteInHashEntry()
 {
  int pageToDelete=delete();

struct Node** iter;
iter=&lruhashtable[pageToDelete];
if((*iter)->head!=NULL)
{        
struct Node* curr=(*iter)->head;
(*iter)=curr->next;
if((*iter)!=NULL)
    (*iter)->head=*iter;
free(curr);

}
else
{
    (*iter)->tail=NULL;

}

  }

void print()
{

int i;
struct Node **iter;
for(i=0;i<10;i++)
{
    iter=&lruhashtable[i];
    for(;*iter;iter=&(*iter)->next)
    {            
        printf("%d%s%d\n",(*iter)->value,"--",i);
    }

}

 }

int delete()
{
int page=-1;

if(trackHead!=NULL)
{
struct Node*current=trackHead;
page=current->value;    
trackHead=current->next;
free(current);
}
else
{
   trackTail=NULL;

}
return page;

 } 

 void printTrack()
 {  
   struct Node* temp=trackHead;

while(temp!=NULL)
{
    printf("%d",temp->value);
    printf("\n");
    temp=temp->next;   
}

}

int main()
{

hashEntry(1);
hashEntry(11);
hashEntry(2);
hashEntry(3);
hashEntry(22);
hashEntry(4);
hashEntry(33);

print();
printTrack();
deleteInHashEntry();
print();
printTrack();
deleteInHashEntry();
print();
printTrack();
deleteInHashEntry();
print();
printTrack();
hashEntry(1);
hashEntry(11);
hashEntry(22);
deleteInHashEntry();
deleteInHashEntry();
deleteInHashEntry();
deleteInHashEntry();
deleteInHashEntry();
deleteInHashEntry();
deleteInHashEntry();
return 0;

 } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-11T02:48:34.900

GDB to the rescue, thought I think I should have caught it much before,in the function hashEntry `if((*iter)->head==NULL)` this statement is wrong as everytime this will execute after malloc. Added a STATUS variable to do this check before malloc statement and change if condition to if status. Hopefully this is the only bug.

# c++ - 我可以使用 volatile sig_atomic_t 来避免 C++03 中的互斥锁吗？

> ID：12830268
> 
> 赞同：1
> 
> 时间：2012-10-11T00:00:55.893
> 
> 标签：c++, mutex, volatile, stdatomic, sig-atomic-t

如果我在具有原子读取和递增/递减支持的硬件上，我可以`volatile sig_atomic_t`在 C++03 中使用 a 来访问原子操作并避免完全成熟的互斥锁，还是必须等待 C++11 和`std::atomic<int>`？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-11T00:16:58.313

*一些*编译器提供了非标准语义，`volatile`允许它工作，但它不是可移植的。 `volatile`用于访问硬件，**而不是**用于线程间通信。无法保证`volatile`一个线程对变量的写入将永远对另一个线程可见-对于线程之间的通信，您需要同步操作，例如内存屏障，这些操作由对`std::atomic`类型的操作提供。

有关更多信息，请参阅[“volatile vs. volatile”](http://herbsutter.com/2009/01/12/effective-concurrency-volatile-vs-volatile/)和 Hans Boehm 的 ISO C++ 论文[“Should volatile Acquire Atomicity and Thread Visibility Semantics？”](http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2006/n2016.html) （两个链接都取自最近的[Herb Sutter 博客文章](http://herbsutter.com/2012/08/31/reader-qa-how-to-write-a-cas-loop-using-stdatomics/)的脚注）

您不必等待编译器中的 C++11 支持，大多数平台都提供了一些特定于平台的原子操作，其中还包括任何必要的内存屏障，例如 GCC 的[`__sync`](http://gcc.gnu.org/onlinedocs/gcc-4.6.3/gcc/Atomic-Builtins.html)内置、Solaris 的原子操作或 Win32 的互锁函数. 还有一些可移植的库，例如提议的[Boost.Atomic](http://www.chaoticmind.net/~hcb/projects/boost.atomic/)，它们为特定于平台的实现提供了一个通用接口。

# xml - xml阅读器限制结果

> ID：12830270
> 
> 赞同：1
> 
> 时间：2012-10-11T00:01:09.777
> 
> 标签：xml, limit, xmlreader

使用 xml 阅读器时限制结果的最佳方法是什么？

我尝试过的下面的代码似乎不起作用。它不仅导入了 3 个节点，还导入了整个文件。我查看了其他论坛，并感谢 rrrfusco 和 Jose Vega[从这篇文章](https://stackoverflow.com/questions/4349105/php-xmlreader-to-array)这里是到目前为止的代码：

```
$i = 0;
$limit = 3;

while ($xmlReader->read()) {
if ($xmlReader->name == "product") {
$product = array();

if ($i == $limit) break;

while ($xmlReader->read()) {

$name = $xmlReader->name;

if ($name == "product") break;

  switch($name) {

    case $title:
    case $keywords:
    case $url:

    if (!isset($product[$i][$name]))
    $product[$i][$name] = $xmlReader->readString();

    break;
  }
}
$i++;

}

} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-27T14:43:08.310

这是我的解决方案，domxpath 成功了。此示例将结果限制为 10。

```
$dom = new DOMDocument;
$dom->Load('http://domain.xml');
$xpath = new DOMXpath($dom);

for( $h=1; $h<10; $h++ ) {
$xc = $xpath->evaluate("count(//product[".$h."]/product_name)");
echo "<h1> Hotel" .$h. "</h1>";

$x1 = $xpath->query("//product[".$h."]/product_name");
$title = $x1->item(0)->nodeValue;
echo $title."<br /><br />";

    for( $i=1; $i<$xc+1; $i++ ) {

    $x2 = $xpath->query("//product[".$h."]/url[".$i."]");
    $url = $x2->item(0)->nodeValue;

    echo "<li>".$url."</li>";

    }

} 
```

# sql - 枢轴中的语法不正确

> ID：12830271
> 
> 赞同：0
> 
> 时间：2012-10-11T00:01:10.403
> 
> 标签：sql, pivot

我的任务是创建一个基于 OrdinalPosition 的 sql 脚本，据我所知我的代码应该可以工作，但是在最后一个“ViewData.SONumber”附近显然存在“语法错误”错误，我都无法解决而无法识别。有人可以看看我的大脑是否有一些东西没有处理吗？

```
FROM    tblReps RIGHT OUTER JOIN tblServiceOrders RIGHT OUTER JOIN     dbo.tblCustomFieldDefinitions LEFT OUTER JOIN
                    (SELECT SONumber, [1] AS [ShippingCompany], [2] AS [Consignment_Number]
                    FROM        (SELECT     tvw_CustomSOFieldData.SONumber, tvw_CustomSOFieldData.CustomFieldValue, tvw_CustomSOFieldData.OrdinalPosition
                                FROM    tvw_CustomSOFieldData)
                                PivotData PIVOT(max(CustomFieldValue) FOR OrdinalPosition IN ([1], [2])) AS CustomFieldsPivot)
                                AS ViewData ON tblServiceOrders.SONumber = ViewData.SONumber 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-11T00:14:13.100

好吧，您的语法似乎遗漏了几件事。您缺少`ON`几个`JOIN`s 的语法：

```
FROM    tblReps 
RIGHT OUTER JOIN tblServiceOrders 
  ON -- missing JOIN
RIGHT OUTER JOIN dbo.tblCustomFieldDefinitions 
  ON -- missing JOIN
LEFT OUTER JOIN
(
  SELECT SONumber, 
    [1] AS [ShippingCompany], 
    [2] AS [Consignment_Number]
  FROM        
  (
    SELECT tvw_CustomSOFieldData.SONumber, 
      tvw_CustomSOFieldData.CustomFieldValue, 
      tvw_CustomSOFieldData.OrdinalPosition
    FROM    tvw_CustomSOFieldData
  ) PivotData 
  PIVOT
  (
    max(CustomFieldValue) 
    FOR OrdinalPosition IN ([1], [2])
  ) CustomFieldsPivot
) ViewData 
  ON tblServiceOrders.SONumber = ViewData.SONumber 
```

# android - Android：如何从本机代码获取设备 DPI

> ID：12830272
> 
> 赞同：3
> 
> 时间：2012-10-11T00:01:12.837
> 
> 标签：android, java-native-interface, native, dpi

我们正在基于我们现有的原生库开发一个 Android 应用程序。我们有一组 JNI 类来公开原生 API。原生库有一个 DPI 全局静态变量需要在这个块中初始化：

```
JNIEXPORT jint JNICALL JNI_OnLoad( JavaVM *vm, void *pvt ) {
 ...
} 
```

问题是我如何在本机级别获得设备 DPI。我知道在 Java 级别上，一旦活动启动，您可以通过 WindowManager 轻松获取该属性。是否可以在我的活动开始之前获得该物业？

感谢你的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-01T22:40:13.243

我记得，你需要有**Context**才能获得 DPI，但在本机代码中你没有。我建议您添加一个将在**Application.onCreate**中调用的本机方法并设置您的本机变量。这不会在**JNI_OnLoad**中完成，而是在任何活动开始之前完成。

# django - django urls 正则表达式

> ID：12830274
> 
> 赞同：0
> 
> 时间：2012-10-11T00:01:20.807
> 
> 标签：django

所以我有一个看起来像这样的主要 urls.py：

```
 urlpatterns = patterns('',
(r'^users/(?P<username>.*)/', include('app.urls')), 
url(r'^users/(?P<username>.*)$',direct_to_template,{'template':'accounts/profile.html'}, name='profile'),) 
```

和一个 app.urls.py

```
urlpatterns = patterns('',url(r'^app/create/$', create_city ,name='create_city'),) 
```

我的问题是，当我 localhost:8000/users/michael/app/create/ 它不会调用我的视图。我尝试过更改网址的顺序但没有运气，所以我相信我的问题出在正则表达式上，但不知道要更改什么，有人吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-11T00:20:20.957

命名组`(?P<username>.*)`将匹配任何字符，零次或多次。在您的用户名中，包括正斜杠。

在 url 模式中，使用`(?P<username>[-\w]+)`. 这将匹配一组小写 az、大写 AZ、数字 0-9 连字符和下划线中的至少一个字符。

我还建议您在模式中添加一个斜杠以供您`profile`查看。

综上所述，我建议您将以下内容作为您的起点`urls.py`：

```
urlpatterns = patterns('',
   url(r'^users/(?P<username>[-\w]+)/$',direct_to_template, {'template':'accounts/profile.html'}, name='profile'), 
   (r'^users/(?P<username>[-\w]+)/', include('app.urls')), 
) 
```

# ios - UIDatePicker 泄漏

> ID：12830278
> 
> 赞同：11
> 
> 时间：2012-10-11T00:01:49.170
> 
> 标签：ios, datepicker, memory-leaks

我似乎有一个泄漏的 UIDatePicker。我已经注意到将 datePickerMode 设置为显示日期和时间的内存泄漏。但是，我只是想显示日期。我相当肯定这是一个框架泄漏，因为当我注释掉几个 UIDatePicker 属性分配时，泄漏就消失了。此代码泄漏 1 个 CGColor 对象和 1 个 UIDeviceRGBColor 对象：

```
datePicker = [[UIDatePicker alloc] initWithFrame:[self detailViewRect]];

datePicker.datePickerMode = UIDatePickerModeDate; //leaks CGColor when setting this
datePicker.hidden = NO;
datePicker.timeZone = [NSTimeZone systemTimeZone]; //leaks UIDeviceRGBColor
datePicker.maximumDate = [NSDate date];//leaks UIDeviceRGBColor
datePicker.autoresizingMask = UIViewAutoresizingFlexibleWidth; 
```

通过评论 Instruments 报告为有问题的行，我没有发现任何泄漏：

```
datePicker = [[UIDatePicker alloc] initWithFrame:[self detailViewRect]];

//datePicker.datePickerMode = UIDatePickerModeDate; //leaks CGColor when setting this
datePicker.hidden = NO;
//datePicker.timeZone = [NSTimeZone systemTimeZone]; //leaks UIDeviceRGBColor
//datePicker.maximumDate = [NSDate date];//leaks UIDeviceRGBColor
datePicker.autoresizingMask = UIViewAutoresizingFlexibleWidth; 
```

如果至少没有设置日期模式，则 UIDatePicker 毫无价值。有人有解决方法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-20T03:16:31.480

这种方法对我有用：

在 xib 而不是编程方法中创建 DatePicker。然后，在 Attributes Inspector 上，将 Mode 设置为 Date。

# mysql - mysql连接两个不同的表以列出一个结果

> ID：12830279
> 
> 赞同：0
> 
> 时间：2012-10-11T00:01:56.360
> 
> 标签：mysql, union

我有两个 MySQL 表：'invoice' 和 'credit_memo'

我想将它们结合起来并列出一个按日期排序的结果。

发票：
ID INT
日期 DATETIME
customer_id INT

credit_memo:
ID INT
日期 DATETIME
customer_id INT

我的最后尝试：

```
(SELECT ID AS invoice_number FROM invoice)
UNION
(SELECT ID AS credit_memo_number FROM credit_memo)
ORDER BY date 
```

问题是 invoice_number 和 credit_memo_number 都被放入 invoice_number 变量中。因此，当我运行结果时，它看起来像是来自“发票”表。

如何确定每个特定行从哪个表中提取？

谢谢你，安迪

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-11T00:12:15.793

```
select id, t.table_name from invoice join information_schema.tables t on t.table_name='invoice'
union
select id, t.table_name from credit_memo join information_schema.tables t on t.table_name='credit_memo' 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-11T00:06:14.763

以下是您将如何处理它。

这两个表都有客户 ID，因此我们可以通过它加入它们：

```
SELECT i.ID AS invoice_number,c.ID AS credit_memo_number 
FROM invoice i
JOIN credit_memo c ON c.customer_id = i.customer_id
ORDER BY i.date ASC 
```

这将选择发票 ID 和信用 ID，并按发票日期排序。

# php - MD5 + Salt 给了我一些奇怪的字符

> ID：12830283
> 
> 赞同：2
> 
> 时间：2012-10-11T00:02:17.090
> 
> 标签：php, mysql, security

```
$salt = uniqid();
   $crypt = md5($password , $salt);
   $new_pass = $crypt.':'.$salt; 
```

在数据库中：`­ot÷„[ªà%ÛÅ‰¹:17b8bc731c322c9e05a26666458117f4`

这是语法错误吗？或者数据库没有设置正确的字符格式？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-10-11T00:03:28.683

您启用了`raw_output`

[PHP文档](http://php.net/manual/en/function.md5.php)

> 如果可选 raw_output 设置为 TRUE，则 md5 摘要以长度为 16 的原始二进制格式返回。

改变

```
$crypt = md5($password , $salt);
                       ^------ You moved the salt to raw_output 
```

到

```
$crypt = md5($password . $salt);
                       ^------ Should be this 
```

出于安全原因，我不建议您使用`md5`密码散列。MD5 被严重破坏，不再需要很长时间才能找到合适的冲突或反向哈希。**一旦被破坏，哈希算法只会变得更糟**，永远不会更好，因此最好选择一个完整的哈希算法。

标准

*   [沙1](http://php.net/manual/en/function.sha1.php)
*   [哈希](http://php.net/manual/en/function.hash.php)（sha256 和 sha512）

更好的选择

*   [密码兼容](https://github.com/ircmaxell/password_compat)
*   [可移植的 PHP 密码散列框架](http://www.openwall.com/phpass/)
*   [PBKDF2](http://www.itnewb.com/tutorial/Encrypting-Passwords-with-PHP-for-Storage-Using-the-RSA-PBKDF2-Standard)

# android - Android：在 EditText 字段中添加小数点，并使其随输入移动

> ID：12830284
> 
> 赞同：6
> 
> 时间：2012-10-11T00:02:18.387
> 
> 标签：android, android-edittext

在我的应用程序中，用户可以在文本字段中输入美元金额。问题是，当他们输入数字时，我需要输入以适应最终数字，而无需实际输入小数点。解释这一点的最好方法是举个例子：

假设用户从一个包含以下内容的 EditText 字段开始：

.

用户想要在字段中输入 $12.53（即数字 1、2、5、3）。然后他/她从输入 1 开始，该字段应如下所示：

.1

然后：

.12

下一个：

1.25

最后：

12.53

因此，您可能会注意到，当输入数字时，小数点会相应地放置。在输入数字时是否可以这样做？谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2017-09-22T10:37:48.990

`"$"`是的，这很有可能，即使您不必`decimal`单独管理。

下面很简单`EditText`，由`TextWatcher`:

```
final EditText editText = (EditText) findViewById(R.id.edt);
    editText.addTextChangedListener(new TextWatcher() {
        @Override
        public void beforeTextChanged(CharSequence charSequence, int i, int i1, int i2) {

        }

        @Override
        public void onTextChanged(CharSequence charSequence, int i, int i1, int i2) {
        }

        @Override
        public void afterTextChanged(Editable editable) {
            if (editText == null) return;
            String inputString = editable.toString();
            editText.removeTextChangedListener(this);
            String cleanString = inputString.toString().replaceAll("[$,.]", "");
            BigDecimal bigDecimal = new BigDecimal(cleanString).setScale(2, BigDecimal.ROUND_FLOOR).divide(new BigDecimal(100), BigDecimal.ROUND_FLOOR);
            String  converted = NumberFormat.getCurrencyInstance().format(bigDecimal);
            editText.setText(converted);
            editText.setSelection(converted.length());
            editText.addTextChangedListener(this);
        }
    }); 
```

如果你需要知道`EditText`应该如何创建`xml`，有这个：

```
<EditText
    android:layout_width="match_parent"
    android:layout_height="wrap_content"
    android:id="@+id/edt"
    android:inputType="numberDecimal"
    android:textDirection="anyRtl"
    android:gravity="right"/> 
```

这是一个老问题，但也许最好回答一下：）

# java - 当我尝试获取周长时，为什么我的所有形状对象都为空？

> ID：12830287
> 
> 赞同：1
> 
> 时间：2012-10-11T00:03:00.257
> 
> 标签：java

现在我正在做涉及形状类的经典形状程序。我可以毫无问题地创建圆形或矩形对象。但是当我得到所有对象的周长或面积时，结果发现所有对象都是空的。这是代码：

//案例菜单选择动作

这里是实例变量和数组

```
private int menu_select;
private int i=0;
private Shape[] s = new Shape[10]; 
```

这是菜单选项

```
public static void display_menu()
{
    System.out.print("Choose an option:\n"+
            "1-Add a new circle\n"+
            "2-Add a new rectangle\n"+
            "3-Delete all shapes\n"+
            "4-Scale all shapes\n"+
            "5-Display perimeter of all shapes\n"+
            "6-Display the area of all shapes\n"+
            "7-Enter scale factor\n"+
            "8-Exit program\n");
} 
```

这是菜单代码

这里是开关

```
//Case menu selection actions
    public void select_case()
    {

        if(i<=10)
        {
            switch (menu_select)
            {

                 case 1: Circle c = new Circle(1);
                         s[i]=c;
                         i++;
                         break;
                 case 2: Rectangle r = new Rectangle(1,1);
                         s[i]=r;
                         i++;
                         break;

                 case 3: s=null;
                         i=0;
                         break;
                 case 4: Scanner input = new Scanner(System.in);  
                         double d = input.nextDouble();
                         for(int i=0; i<s.length; i++)
                         {
                             s[i].setScaleFactor(d);
                         }
                         break;
                 case 5: for(int i=0; i<s.length; i++)
                         {
                            if(s[i] != null)
                            {   
                                System.out.println(s[i].getPerimeter());
                            }
                         }
                         break;
                 case 6: for(int i=0; i<s.length; i++)
                         {
                            System.out.println(s[i].getArea());
                         }
                         break;
                 case 7: //Enter scale factor

                        //No need for a case 8 since while loop terminates it.
                 default: System.out.println("Number must be 1-8");

            }
        }
    } 
```

这里是主要方法

```
public static void main(String args[])
    {
        Menu m;
        do
        {
            Menu.display_menu();
            m = new Menu(0);

        }
        while(m.getMenu_Select() != 8);

    }

} 
```

我尝试给形状数组索引一个固定的数字，但我仍然得到一个空对象。我还尝试使用固定索引删除 for 循环，但仍然得到空对象。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-11T00:31:32.703

以下代码中的“i”是否可以等于 10？

数组 s 中的最大索引应该是 9

```
public void select_case()
{
    if(i<=10)
    {
        switch (menu_select)
        { 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-11T00:22:37.440

您正在为循环的每次迭代创建一个新的 Menu 对象！

```
 {
        Menu.display_menu();
        m = new Menu(0); // here!

    } 
```

不要这样做，因为对此对象所做的任何更改都不会对下一个对象产生影响或记忆。

在循环之前创建一个 Menu 对象，*然后*在循环中调用它的方法

# java - 更新子查询中的数据

> ID：12830288
> 
> 赞同：2
> 
> 时间：2012-10-11T00:03:23.507
> 
> 标签：java, sql, hibernate, postgresql

我有两张桌子：

*   `PERSON`与列`person_id`和`total`
*   `DATA`列`data_a`, `data_b`, `data_c`, 和`data_person_id`

每个“人”可以有零个或多个条目`DATA`- 您的标准一对多关系。`PERSON`有一`total`列是 中的值的总和`DATA`。目前在正确但错误的地方`total`与实际条目之间存在一些差异。`DATA``DATA``total`

这是我用来查找差异的查询：

```
SELECT
  person_id
FROM PERSON JOIN (
  SELECT
    data_person_id,
    SUM( data_a + data_b + data_c ) as data_total
  FROM
    DATA
  GROUP BY
    data_person_id
  ) x ON data_person_id = person_id
WHERE
  person_total != data_total 
```

我计划通过 Hibernate 作为后端将是 Postgres 9.x 的查询来执行此操作。

我试图理解/修复的错误查询是：

```
UPDATE
  ONLY PERSON
SET
  total = data_info.calc_total
FROM (
  SELECT
    SUM( data_a + data_b + data_c ) as calc_total
  FROM
    DATA
  WHERE
    DATA.data_person_id = person_id
  GROUP BY
    DATA.data_person_id
) as data_info
WHERE
  PERSON.person_id IN (
    SELECT
      data_person_id
    FROM PERSON JOIN (
      SELECT
        data_person_id,
        SUM( data_a + data_b + data_c ) as data_total
      FROM
        DATA
      GROUP BY
        data_person_id
      ) x ON person_id = data_person_id
    WHERE
      total != data_total
  ) 
```

现在，它不会运行，因为`WHERE DATA.data_person_id = person_id`. 但如果我把它拿出来，就会使用错误的值。

以下似乎有效，但我对为什么感到困惑：

```
UPDATE
  ONLY PERSON
SET
  total = data_info.calc_total
FROM 
  PERSON P JOIN (
    SELECT
      data_person_id,
      SUM( data_a + data_b + data_c ) as calc_total
    FROM
      DATA
    WHERE
      DATA.data_person_id = person_id
    GROUP BY
      DATA.data_person_id
  ) as data_info ON P.person_id = data_person_id
WHERE
  PERSON.person_id IN (
    SELECT
      data_person_id
    FROM PERSON JOIN (
      SELECT
        data_person_id,
        SUM( data_a + data_b + data_c ) as data_total
      FROM
        DATA
      GROUP BY
        data_person_id
      ) x ON person_id = data_person_id
    WHERE
      total != data_total
  ) 
```

我相信我的问题在于我对[文档](http://www.postgresql.org/docs/9.0/static/sql-update.html)的误解（我猜测关于自加入的部分）。

此外，感谢任何改进此查询的方法！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-11T00:44:47.757

似乎您的查询很复杂。任务应该很简单：

```
UPDATE person p
SET    total = d.calc_total
FROM (
  SELECT data_person_id, sum(data_a + data_b + data_c) as calc_total
  FROM   data
  GROUP  BY 1
) d
WHERE  p.person_id = d.data_person_id
AND    p.total IS DISTINCT FROM d.calc_total; 
```

*   `calc_total`表中的第一个聚合`data`，按 分组`data_person_id`。

*   然后在`UPDATE`.

*   我`IS DISTINCT FROM`用来确保 NULL 值被覆盖，而实际上只有会更改的行被更新。
    如果定义了所有涉及的列`NOT NULL`，则可以`=`改用。

[-> sqlfiddle 演示。](http://www.sqlfiddle.com/#!12/fb4dc/1)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-11T00:24:31.240

这是普通的语法`UPDATE...FROM`。因此，使用 WHERE 之外的最后一个查询

```
UPDATE
  ONLY PERSON
SET
  total = data_info.calc_total
FROM 
  PERSON P JOIN (
    SELECT
      data_person_id,
      SUM( data_a + data_b + data_c ) as calc_total
    FROM
      DATA
    WHERE
      DATA.data_person_id = person_id
    GROUP BY
      DATA.data_person_id
  ) as data_info ON P.person_id = data_person_id 
```

# php - PHPExcel - 所有值均未显示在图表中

> ID：12830298
> 
> 赞同：1
> 
> 时间：2012-10-11T00:04:41.013
> 
> 标签：php, graph, charts, phpexcel, missing-data

有问题的库是[PHPExcel 1.7.7](http://phpexcel.codeplex.com/releases/view/88098)

我使用了在[codeplex](http://phpexcel.codeplex.com/discussions/359273)的一个线程中找到的示例代码来使用 PHPExcel 创建图表。但是，论坛中提供的示例代码只处理两列数据，我希望扩大图表中显示的列数。无论我尝试如何处理第三组数据（D 列及以后）都不会显示。

标签/类别字符串没有问题 - 因此与任何保留名称都没有冲突（即使它们是字符串），我返回 plotValues 以查看是否丢失了任何内容，我仍然看到定义的列显示在那里，但无法弄清楚为什么图表中没有显示第三列。

```
$excel->getActiveSheet()->fromArray(array(
    $header ,
    array('Central',   12,   15 , 12 ),
    array('Northeast',   56,   73 , 10 ),
    array('Southeast',   52,   61 , 33 ),
    array('Western',   30,   32 , 55 ),
));

$labels = array(
    new PHPExcel_Chart_DataSeriesValues('String', 'Summary!$B$1', null, 1),
    new PHPExcel_Chart_DataSeriesValues('String', 'Summary!$C$1', null, 1),
    new PHPExcel_Chart_DataSeriesValues('String', 'Summary!$D$1', null, 1),
);

$categories = array(
    new PHPExcel_Chart_DataSeriesValues('String', 'Summary!$A$2:$A$5', null, 4),
);

// this is where the problem arises - the third DataSeriesValues is not being displayed
$values = array(
    new PHPExcel_Chart_DataSeriesValues('Number', 'Summary!$B$2:$B$5', null, 4),
    new PHPExcel_Chart_DataSeriesValues('Number', 'Summary!$C$2:$C$5', null, 4),
    new PHPExcel_Chart_DataSeriesValues('Number', 'Summary!$D$2:$D$5', null, 4),
/*
    new PHPExcel_Chart_DataSeriesValues('Number', 'Summary!$C$2:$C$5', null, 5),
    new PHPExcel_Chart_DataSeriesValues('Number', 'Summary!$D$2:$D$5', null, 5)
    new PHPExcel_Chart_DataSeriesValues('Number', 'Summary!$E$2:$E$5', null, 5),
    new PHPExcel_Chart_DataSeriesValues('Number', 'Summary!$F$2:$F$5', null, 5),
*/
);

$series = new PHPExcel_Chart_DataSeries(
    PHPExcel_Chart_DataSeries::TYPE_BARCHART,       // plotType
    PHPExcel_Chart_DataSeries::GROUPING_CLUSTERED,  //      plotGrouping
    array(0, 1),                                    // plotOrder
    $labels,                                        // plotLabel
    $categories,                                    // plotCategory
    $values                                         // plotValues
);

$series->setPlotDirection(PHPExcel_Chart_DataSeries::DIRECTION_COL);
$plotarea = new PHPExcel_Chart_PlotArea(null, array($series));
$legend = new PHPExcel_Chart_Legend(PHPExcel_Chart_Legend::POSITION_RIGHT, null, false);

$chart = new PHPExcel_Chart(
    'chart1',                                       // name
    null,                                           // title
    $legend,                                        // legend
    $plotarea,                                      // plotArea
    true,                                           // plotVisibleOnly
    0,                                              // displayBlanksAs
    null,                                           // xAxisLabel
    null                                            // yAxisLabel
);

$chart->setTopLeftPosition('A7');
$chart->setBottomRightPosition('H20');
$excel->getActiveSheet()->addChart($chart);
$excel->getActiveSheet()->setTitle("Summary"); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-11T06:28:37.613

正如 Robbie 指出的那样：当您在创建系列时设置 plotOrder 值时，您只是在告诉图表使用图 0 和 1

```
array(0, 1), 
```

不绘制 0、1 和 2

```
array(0, 1, 2), 
```

我倾向于使用

```
range(0, count($values)-1), 
```

确保包含所有数据系列（无论有多少）

# javascript - 使用 jquery 强制事件连续触发的模式

> ID：12830301
> 
> 赞同：0
> 
> 时间：2012-10-11T00:05:11.113
> 
> 标签：javascript, jquery, event-handling

我正在从浏览器向服务发出一堆 ajax 调用，我希望通过不一次发送所有这些来对服务器友好。是否有一种标准模式用于序列化事件列表的触发，以便下一个事件在最后一个事件完成之前不会触发？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-11T00:43:24.733

我认为[使用延迟对象链接异步回调的 jQuery.whenSync() 插件](http://www.bennadel.com/blog/2326-jQuery-whenSync-Plugin-For-Chaining-Asynchronous-Callbacks-Using-Deferred-Objects.htm)可以帮助您对 AJAX 调用进行排队。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-11T00:21:52.413

我现在用我的一个应用程序来做这件事。基本上我有一个数组来存储我所有的 ajax 调用参数。在回调中，我传递下一个增量，直到不再有。这是一个通用示例（您当然可以使用 ajax 或 get，这就是我的做法：

```
var params = [
{url : 'someurl', data : 'somedata', callback : doSomething},
{url : 'anotherurl', data : 'moredata'}
],
process = function(i) {

    if (i < params.length) {  

        var item = params[i];     

        // Navigate to first view trainee screen
        $.post(
            item.url,
            item.data,
            function(data) {
                // Could test for function, etc but this is how I do it
                try {
                     item.callback(data);
                } catch (e) {}

                process(++i);
            }
         );

    }
};

process(0); 
```

# yii - Yii：在 POST 方法中从视图中接收单个模型的多条记录：保存父子数据

> ID：12830315
> 
> 赞同：1
> 
> 时间：2012-10-11T00:06:15.397
> 
> 标签：yii, parent-child, models

我的情况是，我有超过 4 个子表与一个父表关联。我需要创建一种用户体验，其中用户只按一次保存按钮，这意味着用户在父模型字段中输入所有数据，然后在所有四个子模型字段中输入数据，然后按保存按钮。据我所知，模型中的关系允许您轻松插入关联的行，但主要问题是如何在单个模型的 POST 方法中从视图中接收多行（这里我基本上是指子模型）。我已经通过在视图中重复子模型的属性来手动尝试它，但是当我保存记录时，只有最后一个行集与父表一起存储在子表中，子表的一行被遗漏。

Yii有可能还是我太一厢情愿了……有什么建议或意见吗？？？？

提前谢谢了。问候，费萨尔

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-11T18:11:48.470

我得到了解决方案，但得到了这里和其他论坛的所有帮助。我关注了 Kiran的[帖子，并通过使用 jQuery 生成额外的 HTML 属性对其进行了测试。](http://www.yiiframework.com/wiki/362/how-to-use-multiple-instances-of-the-same-model-in-the-same-form/)在提交时，我得到了我想要的所有行。在控制器中，首先我计算了在发布请求中提交的模型总数，然后对每个模型进行迭代以进行所需的处理。以下是代码片段。

```
 if(!empty($_POST))
{
    $v=count($_POST['Address'])+1;
    Yii::log(count($_POST['Address']));
    for ($i=1; $i<$v; $i++){
            $addressModel_1->attributes=$_POST['Address'][$i];
            Yii::log('Dumping Data from '.$i.' model');
            Yii::log($addressModel_1->city);
            Yii::log($addressModel_1->street);
            Yii::log($addressModel_1->state);}} 
```

在视图方面，我使用 jQuery 函数生成了 HTML。这个函数所做的只是添加另一组 html 以允许用户输入数据。生成 HTML 时要注意的重要一点是模型的名称，否则它不会出现在控制器中您想要的位置。

以下是该函数的代码片段。请注意，我将“3”硬编码为 id，因为我在 DOM 中已经有两组行。我将进一步改进此代码，但请放心，逻辑有效。

```
function createNewAddress(){
     var newdiv = document.createElement('div');
     var inner_html='<div class="row">';
        inner_html+='<label for="Address_3_street">Street</label>        <input name="Address[3][street]" id="Address_3_street" type="text" maxlength="200" />            </div>';
        inner_html+='<div class="row">';
        inner_html+='<label for="Address_3_city">City</label>        <input name="Address[3][city]" id="Address_3_city" type="text" maxlength="200" />            </div>  ';
        inner_html+='<div class="row">';
        inner_html+='<label for="Address_3_state">State</label>        <input name="Address[3][state]" id="Address_3_state" type="text" maxlength="200" />            </div>';
     newdiv.innerHTML=inner_html;
     $('#user-form').append(newdiv); 
```

}

这样，我可以从浏览器中即时添加 n 个子行，用户只需按一次“保存”或“提交”按钮即可保存所有数据。

感谢大家的支持。

问候，

费萨尔

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-11T00:29:17.983

您应该使用[表格输入](http://www.yiiframework.com/doc/guide/1.1/en/form.table)，这样您就可以接收相同类型的多个实例的数据，然后您可以保存父项并使用其 id 来填充子外键。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-11T08:07:10.690

您可以创建一个新的 CFormModel 来处理所有表单字段验证，然后在 POST 函数中的 $model->validate 之后手动设置属性。例如：

```
if ($model->validate){
    $model_one = new ModelOne;
    $model_one->name = $model->model_one_name;
    $model_one->surname = $model->model_one_surname;
    ....

    $model_two = new ModelTwo;
    $model_two->name = $model->model_two_name;
    $model_two->surname = $model->model_two_surname;
    ....
} 
```

# scjp - 树集子集

> ID：12830320
> 
> 赞同：2
> 
> 时间：2012-10-11T00:06:52.510
> 
> 标签：scjp, treeset, ocpjp

嗨，我无法理解为什么这段代码的输出是 'ex [6, 7, b, d] [6, 7, b]'。请有人建议子集如何处理数字和字母？谢谢

```
import java.util.*;
public class Corner {
  public static void main(String[] args) {
    TreeSet<String> t1 = new TreeSet<String>();
    TreeSet<String> t2 = new TreeSet<String>();
    t1.add("b"); t1.add("7");
    t2 = (TreeSet)t1.subSet("5", "c");

     try {
     t1.add("d");
     t2.add("6");
     t2.add("3");
     }
     catch (Exception e) { System.out.print("ex "); }
     System.out.println(t1 + " " + t2);
     } } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-27T11:28:44.700

我进行了一些更改以清理您的代码（使用原始泛型类型和未经检查的转换）并使日志输出更具洞察力：

```
import java.util.SortedSet;
import java.util.TreeSet;

public class Corner {
    public static void main(String[] args) {
        SortedSet<String> t1 = new TreeSet<String>();
        SortedSet<String> t2 = new TreeSet<String>();
        t1.add("b");
        t1.add("7");
        System.out.println(t1 + " " + t2);
        t2 = t1.subSet("5", "c");
        System.out.println(t1 + " " + t2);
        t1.add("d");
        System.out.println(t1 + " " + t2);
        t2.add("6");
        System.out.println(t1 + " " + t2);
        try {
            t2.add("3");
        } catch (Exception e) {
            e.printStackTrace(System.out);
        }
        System.out.println(t1 + " " + t2);
    }
} 
```

输出如下所示：

```
[7, b] []
[7, b] [7, b]
[7, b, d] [7, b]
[6, 7, b, d] [6, 7, b]
java.lang.IllegalArgumentException: key out of range
    at java.util.TreeMap$NavigableSubMap.put(Unknown Source)
    at java.util.TreeSet.add(Unknown Source)
    at Corner.main(Corner.java:18)
[6, 7, b, d] [6, 7, b] 
```

好的，在插入“b”和“7”之后，t1 以 ASCII（或 Unicode）排序顺序包含这些元素。t2 为空。这里没有惊喜。

调用后`subSet`，两个集合具有相同的内容，因为给定范围“5”到“c”跨越了原始集合的整个当前范围，从“7”到“b”。也不足为奇。

请注意：该子集由[API JavaDoc](http://docs.oracle.com/javase/6/docs/api/java/util/TreeSet.html#subSet%28E,%20E%29)描述**的原始集支持**。

此外，API 描述说**返回的集合将`IllegalArgumentException`尝试在其范围之外插入元素。**这在以后很重要。

好的，接下来您将元素“d”添加到 t1，它显示在 t1 中，但不在 t2 中，因为“d”超出了 t2 的“5”到“c”范围。

现在您将元素“6”添加到 t2（它仍然由 t1 支持！）。它在 t2 的正确范围内，因此成功添加到两个逻辑集中。

现在您遇到了麻烦，因为您尝试将“3”添加到 t2，这超出了“5”到“c”的范围，从而导致`IllegalArgumentException`在日志输出中可以看到。该元素*没有*插入到 t2 中（因此也没有插入到 t1 中）。因此，它没有显示在日志输出的最后一行。

底线：根据 JDK 文档，您的程序的行为与预期的一样。`:-)`

# objective-c - Core Data：如何开启版本控制？

> ID：12830324
> 
> 赞同：0
> 
> 时间：2012-10-11T00:07:15.817
> 
> 标签：objective-c, ios, core-data

当我创建一个新项目并创建一个核心数据模型时，在右侧面板上，我可以看到一个名为“版本化核心数据模型”的部分和一个名为“当前”的下拉列表，列表中只有一个项目，这是否意味着版本控制已打开？我问是因为有人告诉我我需要去 Editor->Add Model Version 并添加另一个模型版本，然后 LHS 中的 Model.xcdatamodeld 文件将有一个小箭头和两个 xcdatamodel 文件，直到我打开版本控制这样做，这是正确的吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-11T00:26:30.277

要添加模型的新版本，您可以转到 Editor->Add Model Version 创建一个新名称，例如 xxx v2，并将其基于以前的版本。

获得新版本后，您可以添加、更改和删除实体。

然后，您需要从侧边栏的下拉列表中选择您的新版本（无论您在创建版本时如何调用它），并更新任何子类 NSManagedObjects。

最后，您需要在旧版本和新版本之间创建映射。（文件->新建->文件->核心数据->映射模型）

注意：您只需要在您发布应用程序时执行此操作，并且稍后想要更改您的模型以进行更新。从你的问题来看，听起来你刚刚开始了一个新项目？（值得注意的是，版本化的核心数据模型与源代码控制没有任何关系，以防您对此感到困惑）

# php - 动态 div 大小只在一页上？

> ID：12830332
> 
> 赞同：0
> 
> 时间：2012-10-11T00:08:28.080
> 
> 标签：php, html, css, wordpress, css-transitions

[现场直播。](http://urbanpalate.com/portfolio/)

我的网站设置为在木质背景 ( ) 上显示图像或画廊`#above`，下面的其余内容在亚麻背景 ( `#below`) 上显示。这适用于每个页面，但投资组合页面 - 在选择特定画廊之前，木制空间没有内容。

有没有办法让亚麻背景和内容（`#below`）显示而不是普通的木制背景（`#above`），直到画廊被选中？（如果是这样，是否有可能让它看起来从屏幕顶部向下滑动？）

头文件.php

```
<body>
<div class="above">
    <div id="header">
        <div class="logo">
            <a href="<?php bloginfo('url'); ?>"><img src="<?php echo get_template_directory_uri(); ?>/img/logo.png" alt="Urban Palate logo" id="logo" /></a>
        </div><!-- end logo -->
        <nav>
            <ul>
                <li><a href="?page_id=7"><img src="<?php echo get_template_directory_uri(); ?>/img/about.png" alt="Urban Palate intro" /></a></li>
                <li><a href="?page_id=12"><img src="<?php echo get_template_directory_uri(); ?>/img/portfolio.png" alt="Urban Palate portfolio" /></a></li>
                <li><a href="?page_id=15"><img src="<?php echo get_template_directory_uri(); ?>/img/blog.png" alt="Urban Palate blog" /></a></li>
                <li><a href="?page_id=10"><img src="<?php echo get_template_directory_uri(); ?>/img/contact.png" alt="Urban Palate contact" /></a></li>
            </ul>
        </nav>
    </div><!-- end header --> 
```

投资组合.php

```
<?php
/*
Template Name: Portfolio
*/
?>

<?php get_header(); ?>  

    <div class="gallery">
       <?php     
            if( is_page( 24 ) ) {
              // make your stuff here
               echo do_shortcode('[rev_slider slider1]');
            } else {
              // output standard content here
            }

        ?>

        <?php     
            if( is_page( 26 ) ) {
              // make your stuff here
               echo do_shortcode('[rev_slider slider2]');
            } else {
              // output standard content here
            }

        ?>

        <?php     
            if( is_page( 28 ) ) {
              // make your stuff here
               echo do_shortcode('[rev_slider slider3]');
            } else {
              // output standard content here
            }

        ?>

        <?php     
            if( is_page( 30 ) ) {
              // make your stuff here
               echo do_shortcode('[rev_slider slider4]');
            } else {
              // output standard content here
            }

        ?>

        <?php     
            if( is_page( 32 ) ) {
              // make your stuff here
               echo do_shortcode('[rev_slider slider5]');
            } else {
              // output standard content here
            }

        ?>

        <?php     
            if( is_page( 34 ) ) {
              // make your stuff here
               echo do_shortcode('[rev_slider slider6]');
            } else {
              // output standard content here
            }

        ?>

        <?php     
            if( is_page( 36 ) ) {
              // make your stuff here
               echo do_shortcode('[rev_slider slider7]');
            } else {
              // output standard content here
            }

        ?>

        <?php     
            if( is_page( 42 ) ) {
              // make your stuff here
               echo do_shortcode('[rev_slider slider8]');
            } else {
              // output standard content here
            }

        ?>

    </div><!-- end gallery -->
</div><!-- end above -->
<div class="below">
    <div class="blurb">
        <img src="<?php echo get_template_directory_uri(); ?>/img/portfolio_blurb.png" alt="see who has experienced our fabulous + creative and beautiful + cutting edge decor firsthand" />
    </div><!-- end blurb -->
    <div id="client-list">
        <?php wp_nav_menu( array( 'sort_column' => 'menu_order', 'container_class' => 'menu-header' ) ); ?>
    </div><!-- end client-list -->

<?php get_footer(); ?> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-11T01:16:17.400

可以对上面的代码进行很多改进。调查该`switch`声明，或至少放弃所有`else`块。反正，

在你的`header.php`，尝试

```
<body>
<div class="above <?php if (is_page(1)) echo 'short'; ?>">
    <div id="header">
        <div class="logo">
        // etc... 
```

您将需要更改`is_page(1)`部件以获得正确的页码。我不知道你是如何用 WordPress 解决这个问题的，但如果你可以为每个画廊做到这一点，你可以为空的投资组合页面做到这一点。

然后，在您的网站 css 中：

```
.above.short {
    height: 200px;
} 
```

我的解决方案很丑陋，但它会与你所拥有的其他 PHP 相匹配。如果您为这项工作向开发人员付费，请获得新的开发人员。

了解 WP 的人可能会告诉您如何提供`div.above`额外的课程，而无需像我所做的那样使用内联代码。这将是一个更好的解决方案。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-11T01:22:56.243

你可以用 jQuery 做到这一点。

例如：

```
// check if the gallery is empty and hide if it is.
if ($('.above .gallery').contents().length == 0){
  $('.above').hide();
} 
```

或使用 css 代替`.hide`and`display:none`或将高度设置为 0。

```
 $('.above').css('height', '0'); 
```

# arrays - 伪代码 - 我怎么能在这个数组？

> ID：12830334
> 
> 赞同：-1
> 
> 时间：2012-10-11T00:08:52.143
> 
> 标签：arrays, algorithm, pseudocode

我有一个作业问这个：

> 做一个算法和伪代码，它会询问20个学生的20个年级，包括学生的姓名、学位和入学人数，所有这些都必须存储在一个数组中。数据输入后，会打印每组所有学生的平均值，（假设您输入不同学生组的数据）。

虽然我什么都明白，但我对此只有几个问题。首先是我不知道如何组织（或制作）数组以及如何对学生的学位/班级进行分组。

编辑：我对伪代码知之甚少，因为没有人教我如何做到这一点，所以不要对我期望太多。

```
set StudentArray[20,23]
    for j=1 to 20
        StudentArray[j,21] = prompt Name
        StudentArray[j,22] = prompt Degree
        StudentArray[j,23] prompt RegNum
        for k=1 to 20
            StudentArray[j,k] = prompt Grade
        end for
    end for 
```

使用这个伪代码可以很容易地继续使用学生平均成绩的方法。这里的问题是数组“StudentArray”是否“接受”不同的数据类型（整数或数字、字符串等）。而且我不知道如何“将学生分组”。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-11T01:13:32.020

您对不同的数据类型有问题吗？根据您的编程语言，您的数组可能会也可能不会保存不同的数据类型。如果这在您使用的语言中是不可能的，您将不得不为每种数据类型保存一个数组，或者创建一个新的复杂数据类型。

# python - 使用 Google Calendar Api 创建日历时出现错误 404

> ID：12830335
> 
> 赞同：1
> 
> 时间：2012-10-11T00:09:11.013
> 
> 标签：python, google-calendar-api, google-api-python-client

我刚刚编写了这段代码，它应该检查日历是否存在，如果不存在则创建一个。好吧，当我尝试创建日历并且日历没有出现时，它会返回错误 404。有任何想法吗？我清除了客户端 ID、秘密、应用程序密钥。

```
 import gflags
            import httplib2
            import sys, traceback

            from apiclient.discovery import build
            from oauth2client.file import Storage
            from oauth2client.client import OAuth2WebServerFlow
            from oauth2client.tools import run

            FLAGS = gflags.FLAGS

            # Set up a Flow object to be used if we need to authenticate. This
            # sample uses OAuth 2.0, and we set up the OAuth2WebServerFlow with
            # the information it needs to authenticate. Note that it is called
            # the Web Server Flow, but it can also handle the flow for native
            # applications
            # The client_id and client_secret are copied from the API Access tab on
            # the Google APIs Console
            FLOW = OAuth2WebServerFlow(
                    client_id='MY_CLIENT_ID',
                    client_secret='MY_SECRET',
                    scope='https://www.googleapis.com/auth/calendar',
                    user_agent='KUDOS_CALENDAR/v1')

            # To disable the local server feature, uncomment the following line:
            # FLAGS.auth_local_webserver = False

            # If the Credentials don't exist or are invalid, run through the native client
            # flow. The Storage object will ensure that if successful the good
            # Credentials will get written back to a file.
            storage = Storage('calendar.dat')
            credentials = storage.get()
            if credentials is None or credentials.invalid == True:
                credentials = run(FLOW, storage)

            # Create an httplib2.Http object to handle our HTTP requests and authorize it
            # with our good Credentials.
            http = httplib2.Http()
            http = credentials.authorize(http)

            # Build a service object for interacting with the API. Visit
            # the Google APIs Console
            # to get a developerKey for your own application.
            service = build(serviceName='calendar', version='v3', http=http,
                         developerKey='MY_DEV_KEY')
            kudos_calendar = None
            try:
                kudos_calendar = service.calendarList().get(calendarId='KudosCalendar').execute()
            except:
                print 'Calendar KudosCalendar does not exist!'
                print 'Creating one right now...'
                kudos_calendar_entry = {
                    'id': 'KudosCalendar'
                }

                kudos_calendar = service.calendarList().insert(body=kudos_calendar_entry).execute() 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-11T13:59:58.233

好的，我找到了解决办法。我不确定谷歌抽象到底反映了什么，但我很确定不能只创建日历列表​​。但是，如果您只是创建一个日历，那么一切都会很好，然后可以使用日历 id 访问与该日历对应的 calendarlist 条目。

Ufff..可怕的混乱。同样在尝试这样做时，我在文档中给出的示例 python 代码中发现了至少两个错误。我认为他们仍然没有正确推出 v3。

# html - javascript 文件处理的标记中的特殊属性

> ID：12830338
> 
> 赞同：0
> 
> 时间：2012-10-11T00:09:52.557
> 
> 标签：html

Impress.js 支持许多属性：

data-x, data-y, data-z 将在 3D 空间中移动屏幕上的幻灯片；

data-rotate, data-rotate-x, data-rotate-y 围绕指定轴旋转元素（以度为单位）；

data-scale – 放大或缩小幻灯片。

```
div id="intro" class="step" data-x="0" data-y="0">
<h2>Introducing Galaxy Nexus</h2>
<p>Android 4.0<br /> Super Amoled 720p Screen<br />
<img src="assets/img/nexus_1.jpg" width="232" height="458" alt="Galaxy Nexus" /> 
```

```
 <!-- We are offsetting the second slide, rotating it and making it 1.8 times larger -->
<div id="simplicity" class="step" data-x="1100" data-y="1200" data-scale="1.8" data-rotate="190">
<h2>Simplicity in Android 4.0</h2>
<p>Android 4.0, Ice Cream Sandwich brings an entirely new look and feel..</p>
<img src="assets/img/nexus_2.jpg" width="289" height="535" alt="Galaxy Nexus" /> 
```

印象.js

```
(function ( document, window ) {
'use strict';

// HELPER FUNCTIONS

var pfx = (function () {

    var style = document.createElement('dummy').style,
        prefixes = 'Webkit Moz O ms Khtml'.split(' '),
        memory = {};

    return function ( prop ) {
        if ( typeof memory[ prop ] === "undefined" ) {

            var ucProp  = prop.charAt(0).toUpperCase() + prop.substr(1),
                props   = (prop + ' ' + prefixes.join(ucProp + ' ') + ucProp).split(' ');

            memory[ prop ] = null;
            for ( var i in props ) {
                if ( style[ props[i] ] !== undefined ) {
                    memory[ prop ] = props[i];
                    break;
                }
            }

        }

        return memory[ prop ];
    }

})();

var arrayify = function ( a ) {
    return [].slice.call( a );
};

var css = function ( el, props ) {
    var key, pkey;
    for ( key in props ) {
        if ( props.hasOwnProperty(key) ) {
            pkey = pfx(key);
            if ( pkey != null ) {
                el.style[pkey] = props[key];
            }
        }
    }
    return el;
}

var byId = function ( id ) {
    return document.getElementById(id);
}

var $ = function ( selector, context ) {
    context = context || document;
    return context.querySelector(selector);
};

var $$ = function ( selector, context ) {
    context = context || document;
    return arrayify( context.querySelectorAll(selector) );
};

var translate = function ( t ) {
    return " translate3d(" + t.x + "px," + t.y + "px," + t.z + "px) ";
};

var rotate = function ( r, revert ) {
    var rX = " rotateX(" + r.x + "deg) ",
        rY = " rotateY(" + r.y + "deg) ",
        rZ = " rotateZ(" + r.z + "deg) ";

    return revert ? rZ+rY+rX : rX+rY+rZ;
};

var scale = function ( s ) {
    return " scale(" + s + ") ";
};

var getElementFromUrl = function () {
    // get id from url # by removing `#` or `#/` from the beginning,
    // so both "fallback" `#slide-id` and "enhanced" `#/slide-id` will work
    return byId( window.location.hash.replace(/^#\/?/,"") );
};

// CHECK SUPPORT

var ua = navigator.userAgent.toLowerCase();
var impressSupported = ( pfx("perspective") != null ) &&
                       ( document.body.classList ) &&
                       ( document.body.dataset ) &&
                       ( ua.search(/(iphone)|(ipod)|(android)/) == -1 );

var roots = {};

var impress = window.impress = function ( rootId ) {

    rootId = rootId || "impress";

    // if already initialized just return the API
    if (roots["impress-root-" + rootId]) {
        return roots["impress-root-" + rootId];
    }

    // DOM ELEMENTS

    var root = byId( rootId );

    if (!impressSupported) {
        root.className = "impress-not-supported";
        return;
    } else {
        root.className = "";
    }

    // viewport updates for iPad
    var meta = $("meta[name='viewport']") || document.createElement("meta");
    // hardcoding these values looks pretty bad, as they kind of depend on the content
    // so they should be at least configurable
    meta.content = "width=1024, minimum-scale=0.75, maximum-scale=0.75, user-scalable=no";
    if (meta.parentNode != document.head) {
        meta.name = 'viewport';
        document.head.appendChild(meta);
    }

    var canvas = document.createElement("div");
    canvas.className = "canvas";

    arrayify( root.childNodes ).forEach(function ( el ) {
        canvas.appendChild( el );
    });
    root.appendChild(canvas);

    var steps = $$(".step", root);

    // SETUP
    // set initial values and defaults

    document.documentElement.style.height = "100%";

    css(document.body, {
        height: "100%",
        overflow: "hidden"
    });

    var props = {
        position: "absolute",
        transformOrigin: "top left",
        transition: "all 0s ease-in-out",
        transformStyle: "preserve-3d"
    }

    css(root, props);
    css(root, {
        top: "50%",
        left: "50%",
        perspective: "1000px"
    });
    css(canvas, props);

    var current = {
        translate: { x: 0, y: 0, z: 0 },
        rotate:    { x: 0, y: 0, z: 0 },
        scale:     1
    };

    var stepData = {};

    var isStep = function ( el ) {
        return !!(el && el.id && stepData["impress-" + el.id]);
    }

    steps.forEach(function ( el, idx ) {
        var data = el.dataset,
            step = {
                translate: {
                    x: data.x || 0,
                    y: data.y || 0,
                    z: data.z || 0
                },
                rotate: {
                    x: data.rotateX || 0,
                    y: data.rotateY || 0,
                    z: data.rotateZ || data.rotate || 0
                },
                scale: data.scale || 1,
                el: el
            };

        if ( !el.id ) {
            el.id = "step-" + (idx + 1);
        }

        stepData["impress-" + el.id] = step;

        css(el, {
            position: "absolute",
            transform: "translate(-50%,-50%)" +
                       translate(step.translate) +
                       rotate(step.rotate) +
                       scale(step.scale),
            transformStyle: "preserve-3d"
        });

    });

    // making given step active

    var active = null;
    var hashTimeout = null;

    var goto = function ( el ) {
        if ( !isStep(el) || el == active) {
            // selected element is not defined as step or is already active
            return false;
        }

        // Sometimes it's possible to trigger focus on first link with some keyboard action.
        // Browser in such a case tries to scroll the page to make this element visible
        // (even that body overflow is set to hidden) and it breaks our careful positioning.
        //
        // So, as a lousy (and lazy) workaround we will make the page scroll back to the top
        // whenever slide is selected
        //
        // If you are reading this and know any better way to handle it, I'll be glad to hear about it!
        window.scrollTo(0, 0);

        var step = stepData["impress-" + el.id];

        if ( active ) {
            active.classList.remove("active");
        }
        el.classList.add("active");

        root.className = "step-" + el.id;

        // `#/step-id` is used instead of `#step-id` to prevent default browser
        // scrolling to element in hash
        //
        // and it has to be set after animation finishes, because in chrome it
        // causes transtion being laggy
        window.clearTimeout( hashTimeout );
        hashTimeout = window.setTimeout(function () {
            window.location.hash = "#/" + el.id;
        }, 1000);

        var target = {
            rotate: {
                x: -parseInt(step.rotate.x, 10),
                y: -parseInt(step.rotate.y, 10),
                z: -parseInt(step.rotate.z, 10)
            },
            translate: {
                x: -step.translate.x,
                y: -step.translate.y,
                z: -step.translate.z
            },
            scale: 1 / parseFloat(step.scale)
        };

        // check if the transition is zooming in or not
        var zoomin = target.scale >= current.scale;

        // if presentation starts (nothing is active yet)
        // don't animate (set duration to 0)
        var duration = (active) ? "1s" : "0";

        css(root, {
            // to keep the perspective look similar for different scales
            // we need to 'scale' the perspective, too
            perspective: step.scale * 1000 + "px",
            transform: scale(target.scale),
            transitionDuration: duration,
            transitionDelay: (zoomin ? "500ms" : "0ms")
        });

        css(canvas, {
            transform: rotate(target.rotate, true) + translate(target.translate),
            transitionDuration: duration,
            transitionDelay: (zoomin ? "0ms" : "500ms")
        });

        current = target;
        active = el;

        return el;
    };

    var prev = function () {
        var prev = steps.indexOf( active ) - 1;
        prev = prev >= 0 ? steps[ prev ] : steps[ steps.length-1 ];

        return goto(prev);
    };

    var next = function () {
        var next = steps.indexOf( active ) + 1;
        next = next < steps.length ? steps[ next ] : steps[ 0 ];

        return goto(next);
    };

    window.addEventListener("hashchange", function () {
        goto( getElementFromUrl() );
    }, false);

    window.addEventListener("orientationchange", function () {
        window.scrollTo(0, 0);
    }, false);

    // START 
    // by selecting step defined in url or first step of the presentation
    goto(getElementFromUrl() || steps[0]);

    return (roots[ "impress-root-" + rootId ] = {
        goto: goto,
        next: next,
        prev: prev
    });

} 
```

})(文档，窗口);

// 事件

（函数（文档，窗口）{'使用严格';

```
// keyboard navigation handler
document.addEventListener("keydown", function ( event ) {
    if ( event.keyCode == 9 || ( event.keyCode >= 32 && event.keyCode <= 34 ) || (event.keyCode >= 37 && event.keyCode <= 40) ) {
        switch( event.keyCode ) {
            case 33: ; // pg up
            case 37: ; // left
            case 38:   // up
                     impress().prev();
                     break;
            case 9:  ; // tab
            case 32: ; // space
            case 34: ; // pg down
            case 39: ; // right
            case 40:   // down
                     impress().next();
                     break;
        }

        event.preventDefault();
    }
}, false);

// delegated handler for clicking on the links to presentation steps
document.addEventListener("click", function ( event ) {
    // event delegation with "bubbling"
    // check if event target (or any of its parents is a link)
    var target = event.target;
    while ( (target.tagName != "A") &&
            (target != document.body) ) {
        target = target.parentNode;
    }

    if ( target.tagName == "A" ) {
        var href = target.getAttribute("href");

        // if it's a link to presentation step, target this step
        if ( href && href[0] == '#' ) {
            target = document.getElementById( href.slice(1) );
        }
    }

    if ( impress().goto(target) ) {
        event.stopImmediatePropagation();
        event.preventDefault();
    }
}, false);

// delegated handler for clicking on step elements
document.addEventListener("click", function ( event ) {
    var target = event.target;
    // find closest step element
    while ( !target.classList.contains("step") &&
            (target != document.body) ) {
        target = target.parentNode;
    }

    if ( impress().goto(target) ) {
        event.preventDefault();
    }
}, false);

// touch handler to detect taps on the left and right side of the screen
document.addEventListener("touchstart", function ( event ) {
    if (event.touches.length === 1) {
        var x = event.touches[0].clientX,
            width = window.innerWidth * 0.3,
            result = null;

        if ( x < width ) {
            result = impress().prev();
        } else if ( x > window.innerWidth - width ) {
            result = impress().next();
        }

        if (result) {
            event.preventDefault();
        }
    }
}, false); 
```

})(文档，窗口);

我的问题是 Impress.js 应该处理 div 标签的 data-x、data-y、data-scale 属性。但我没有看到 Impress.js 中的代码在哪里执行此操作。有人可以指出吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-11T00:41:53.440

[对数据集的介绍](http://dev.opera.com/articles/view/an-introduction-to-datasets/)可能会有所帮助。

首先这部分检查对.dataset的支持：

```
// CHECK SUPPORT

var ua = navigator.userAgent.toLowerCase();
var impressSupported = ( pfx("perspective") != null ) &&
                       ( document.body.classList ) &&
                       ( document.body.dataset ) &&
                       ( ua.search(/(iphone)|(ipod)|(android)/) == -1 ); 
```

然后这部分代码，大概往下看：

```
steps.forEach(function ( el, idx ) {
        var data = el.dataset,
            step = {
                translate: {
                    x: data.x || 0,
                    y: data.y || 0,
                    z: data.z || 0
                },
                rotate: {
                    x: data.rotateX || 0,
                    y: data.rotateY || 0,
                    z: data.rotateZ || data.rotate || 0
                },
                scale: data.scale || 1,
                el: el
            }; 
```

# android - 保存充斥数据库的位置位置

> ID：12830339
> 
> 赞同：0
> 
> 时间：2012-10-11T00:10:02.533
> 
> 标签：android, database-design, gps, gis

我开发了一个安卓应用程序来保存跑步者的赛道。因为它是一个正在运行的应用程序，所以我需要每 10 秒报告一次位置。这意味着每 10 秒将 lang lat 保存为设备上的 sqlite 和使用 webservice 调用的 web 服务器上的本地副本。

该应用程序的目的是显示每个特定时间的确切位置和人的速度。

我和我的朋友安装了该应用程序 3 周，几乎每天都使用它几个小时，我的数据库被淹没了大约 6,000,000 条记录 - 每条记录我将无法继续运行它，因为服务器空间将用完。

有没有其他方法可以保存位置或任何其他架构或算法，让我知道人在赛道任何点的确切位置和他的速度？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-12T18:51:01.557

有多种方法可以减少跟踪日志的空间需求。基本上，您可以将附近的位置聚集和过滤到一个点，并且如果记录器保持在同一点进行两次或多次后续读取，您可以在位置记录上增加一个计数器，而不是创建一个新的。

为曲目的开头加上时间戳并跳过其余部分，您可以计算时间信息，因为读取是以固定间隔完成的。

您可以查看以下 pdf 文件以获取更多信息。

[http://www.activelivingresearch.org/files/DataReduction_GPS_Workshop.pdf]

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-11T00:27:15.843

您不应该只有：3（周）* 7（天）* 3（小时）* 60（分钟）* 6（10 秒间隔）= 22680 条记录吗？

一种方法可能是将运行数据存储为字符串，并在每次“运行”（或每小时或 n 分钟）的 db 中存储一条记录

字符串可以格式化为仅存储起始位置和偏移量，例如：“36.234234234,-114.3434434,0.004,0.006,0.002,0.000 ...

# security - 如何在 IBM iSeries 上仔细检查我对 Profile Tokens 的使用？

> ID：12830341
> 
> 赞同：1
> 
> 时间：2012-10-11T00:10:20.630
> 
> 标签：security, ibm-midrange

当用户进行身份验证以便以用户身份启动作业时，我使用 IBM 安全 API（QSYGENPT、QSYRMVPT 等）在 iSeries 系统上创建配置文件令牌。系统上可以创建 2,000,000 个此类令牌的固定限制，因此需要小心删除不再需要时创建的任何令牌。否则将构成关键系统资源的泄漏。

但是，我无法在系统上报告令牌的当前总数、列出由特定作业和/或用户创建的令牌或类似的东西，所以我无法验证我的程序没有泄漏令牌。

到目前为止，唯一的方法似乎是使用系统的审计日志条目并乏味地匹配令牌创建/删除审计条目。啊!

谁能提供更好的想法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-12T18:53:10.050

根据[此页面](http://publib.boulder.ibm.com/infocenter/iseries/v5r3/index.jsp?topic=%2Fapis%2Fqsygenpt.htm)，配置文件令牌有效的最长时间为 3600 秒。我无法想象系统需要在一小时内生成 2,000,000 个配置文件令牌的任何合法情况。我提到这一点只是为了让您放心 - 我认为您不必担心您的程序泄漏资源！

我不知道列出个人资料令牌的任何方式，但没有理由不能维护自己的列表。

1) 创建一个表（iSeries 术语中的物理文件）来存储令牌 ID、用户 ID 和创建令牌的日期时间。如果您创建具有不同生命周期的令牌，它可能也会过期。

2）调用`QSYGENPT`API。

3）如果成功，将记录添加到您的表中。

4）有一个定期运行并查看表中所有记录的作业。`QSYRMVPT`如果当前日期时间晚于 Profile Token 的到期日期时间，则让它调用API。

然后您将知道分配了多少代币，分配给谁以及何时到期。

如果有问题的 iSeries 有一个正常的“夜间停机时间”，它会在其中执行备份、补丁或任何您可以调用[QsyRemoveAllPrfTkns API](http://publib.boulder.ibm.com/infocenter/iseries/v5r3/index.jsp?topic=%2Fapis%2Fqsyrmapt.htm)的操作，并确保您已删除所有令牌，这样您将拥有完整的 2,000,000 个令牌。系统恢复。

# sql - Tablix 列标题显示在后续页面上

> ID：12830342
> 
> 赞同：1
> 
> 时间：2012-10-11T00:10:48.810
> 
> 标签：sql

有没有办法可以在 SSRS 2008 的后续页面上显示列标题？我正在使用 ReportBuilder 3.0。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-11T01:31:25.573

请参阅[http://social.msdn.microsoft.com/Forums/en-US/sqlreportingservices/thread/d75b382c-f314-430c-9b04-fea007be9315/](http://social.msdn.microsoft.com/Forums/en-US/sqlreportingservices/thread/d75b382c-f314-430c-9b04-fea007be9315/)

您还可以在此处查看分步程序[http://technet.microsoft.com/en-us/library/dd207045%28v=sql.105%29.aspx](http://technet.microsoft.com/en-us/library/dd207045%28v=sql.105%29.aspx)

快乐的报道！:))

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-11T00:19:05.393

转到 tablix 属性，然后将 RepeatColumnHeaders 设置为 True。

# ruby-on-rails - TypeError：无法在 Heroku 中转储匿名类 Class

> ID：12830343
> 
> 赞同：3
> 
> 时间：2012-10-11T00:11:05.707
> 
> 标签：ruby-on-rails, ruby, postgresql, nokogiri

我正在使用`scheduler addon`from heroku 运行 rake 任务。它在开发中有效，但在生产中失败。这是heroku日志中的堆栈跟踪：

```
2012-10-10T23:30:23+00:00 heroku[api]：通过 scheduler@addons.heroku.com 使用命令 `bundle exec rake deal --trace` 启动进程
2012-10-10T23:30:29+00:00 heroku[scheduler.1]：使用命令“bundle exec rake deal--trace”启动进程
2012-10-10T23:30:30+00:00 heroku[scheduler.1]：状态从开始变为向上
2012-10-10T23:30:56+00:00 app[scheduler.1]：弃用警告：供应商/插件中有 Rails 2.3 风格的插件！Rails 4.0 将删除对这些插件的支持。将它们移出并将它们捆绑到您的 Gemfile 中，或者将它们作为 lib/myplugin/* 和 config/initializers/myplugin.rb 折叠到您的应用程序中。有关更多信息，请参阅发行说明：http://weblog.rubyonrails.org/2012/1/4/rails-3-2-0-rc2-has-been-released。（从 /app/Rakefile:7 调用）
2012-10-10T23:30:56+00:00 app[scheduler.1]：弃用警告：供应商/插件中有 Rails 2.3 风格的插件！Rails 4.0 将删除对这些插件的支持。将它们移出并将它们捆绑到您的 Gemfile 中，或者将它们作为 lib/myplugin/* 和 config/initializers/myplugin.rb 折叠到您的应用程序中。有关更多信息，请参阅发行说明：http://weblog.rubyonrails.org/2012/1/4/rails-3-2-0-rc2-has-been-released。（从 /app/Rakefile:7 调用）
2012-10-10T23:30:56+00:00 app[scheduler.1]: ** 调用交易 (first_time)
2012-10-10T23:30:56+00:00 app[scheduler.1]: ** 调用环境 (first_time)
2012-10-10T23:30:56+00:00 app[scheduler.1]: ** 调用文档：remove_documents (first_time)
2012-10-10T23:30:56+00:00 app[scheduler.1]: ** 执行环境
2012-10-10T23:31:00+00:00 app[scheduler.1]: ** 执行文档：remove_documents
2012-10-10T23:31:01+00:00 app[scheduler.1]: ** 调用环境
2012-10-10T23:31:01+00:00 app[scheduler.1]: ** 执行文档：add_documents
2012-10-10T23:31:01+00:00 app[scheduler.1]: ** 调用文档：add_documents (first_time)
2012-10-10T23:31:18+00:00 app[scheduler.1]: TypeError: can't dump anonymous class Class: INSERT INTO "documents" ("body", "created_at", "merchant_id", "updated_at ") 值 ($1, $2, $3, $4) 返回 "id"
2012-10-10T23:31:18+00:00 应用程序 [scheduler.1]:/usr/local/lib/ruby/1.9.1/syck/rubytypes.rb:16:in `map'
2012-10-10T23:31:18+00:00 app[scheduler.1]:/usr/local/lib/ruby/1.9.1/syck/rubytypes.rb:16:in `block in to_yaml'
2012-10-10T23:31:18+00:00 应用程序 [scheduler.1]:/usr/local/lib/ruby/1.9.1/syck/rubytypes.rb:6:in `to_yaml'
2012-10-10T23:31:18+00:00 应用程序 [scheduler.1]:/usr/local/lib/ruby/1.9.1/syck/rubytypes.rb:17:in `each'
2012-10-10T23:31:18+00:00 app[scheduler.1]:/usr/local/lib/ruby/1.9.1/syck/rubytypes.rb:18:in `node_export'
2012-10-10T23:31:18+00:00 app[scheduler.1]: /usr/local/lib/ruby/1.9.1/syck/rubytypes.rb:18:in `block (3 levels) in to_yaml '
2012-10-10T23:31:18+00:00 应用程序 [scheduler.1]:/usr/local/lib/ruby/1.9.1/syck/rubytypes.rb:17:in `each'
2012-10-10T23:31:18+00:00 应用程序 [scheduler.1]:/usr/local/lib/ruby/1.9.1/syck/rubytypes.rb:16:in `map'
2012-10-10T23:31:18+00:00 app[scheduler.1]:/usr/local/lib/ruby/1.9.1/syck.rb:401:in `emit'
2012-10-10T23:31:18+00:00 app[scheduler.1]:/usr/local/lib/ruby/1.9.1/syck/rubytypes.rb:16:in `block in to_yaml'
2012-10-10T23:31:18+00:00 应用程序 [scheduler.1]:/usr/local/lib/ruby/1.9.1/syck/rubytypes.rb:17:in `each'
2012-10-10T23:31:18+00:00 app[scheduler.1]:/usr/local/lib/ruby/1.9.1/syck.rb:401:in `call'
2012-10-10T23:31:18+00:00 应用程序 [scheduler.1]：rake 中止！
2012-10-10T23:31:18+00:00 app[scheduler.1]: /usr/local/lib/ruby/1.9.1/syck/rubytypes.rb:17:in `block (2 levels) in to_yaml '
2012-10-10T23:31:18+00:00 应用程序 [scheduler.1]:/usr/local/lib/ruby/1.9.1/syck/rubytypes.rb:15:in `to_yaml'
2012-10-10T23:31:18+00:00 app[scheduler.1]: /usr/local/lib/ruby/1.9.1/syck/rubytypes.rb:17:in `block (2 levels) in to_yaml '
2012-10-10T23:31:18+00:00 应用程序 [scheduler.1]:/app/vendor/bundle/ruby/1.9.1/gems/activerecord-3.2.8/lib/active_record/connection_adapters/postgresql_adapter.rb :665:in `exec_query 中的块'
2012-10-10T23:31:18+00:00 应用程序 [scheduler.1]:/usr/local/lib/ruby/1.9.1/syck/rubytypes.rb:18:in `add'
2012-10-10T23:31:18+00:00 app[scheduler.1]: /usr/local/lib/ruby/1.9.1/syck/rubytypes.rb:18:in `block (3 levels) in to_yaml '
2012-10-10T23:31:18+00:00 应用程序 [scheduler.1]:/usr/local/lib/ruby/1.9.1/syck/rubytypes.rb:16:in `map'
2012-10-10T23:31:18+00:00 app[scheduler.1]:/usr/local/lib/ruby/1.9.1/syck/rubytypes.rb:16:in `block in to_yaml'
2012-10-10T23:31:18+00:00 app[scheduler.1]:/app/vendor/bundle/ruby/1.9.1/gems/activerecord-3.2.8/lib/active_record/connection_adapters/abstract_adapter.rb :280:in `block in log'
2012-10-10T23:31:18+00:00 app[scheduler.1]:/usr/local/lib/ruby/1.9.1/syck.rb:401:in `emit'
2012-10-10T23:31:18+00:00 应用程序 [scheduler.1]:/app/vendor/bundle/ruby/1.9.1/gems/activerecord-3.2.8/lib/active_record/connection_adapters/postgresql_adapter.rb :1168:in `exec_cache 中的块'
2012-10-10T23:31:18+00:00 应用程序 [scheduler.1]:/usr/local/lib/ruby/1.9.1/syck/rubytypes.rb:18:in `add'
2012-10-10T23:31:18+00:00 app[scheduler.1]: /usr/local/lib/ruby/1.9.1/syck/rubytypes.rb:17:in `block (2 levels) in to_yaml '
2012-10-10T23:31:18+00:00 应用程序 [scheduler.1]:/usr/local/lib/ruby/1.9.1/syck.rb:401:in `quick_emit'
2012-10-10T23:31:18+00:00 app[scheduler.1]:/usr/local/lib/ruby/1.9.1/syck.rb:119:in `dump'
2012-10-10T23:31:18+00:00 app[scheduler.1]: /usr/local/lib/ruby/1.9.1/syck/rubytypes.rb:18:in `block (3 levels) in to_yaml '
2012-10-10T23:31:18+00:00 app[scheduler.1]:/usr/local/lib/ruby/1.9.1/syck.rb:401:in `emit'
2012-10-10T23:31:18+00:00 app[scheduler.1]:/app/vendor/bundle/ruby/1.9.1/gems/activerecord-3.2.8/lib/active_record/connection_adapters/abstract/query_cache .rb:14:在“插入”中
2012-10-10T23:31:18+00:00 app[scheduler.1]:/app/vendor/bundle/ruby/1.9.1/gems/activerecord-3.2.8/lib/active_record/relation.rb:66 ：在“插入”中
2012-10-10T23:31:18+00:00 应用程序 [scheduler.1]:/usr/local/lib/ruby/1.9.1/syck/rubytypes.rb:15:in `to_yaml'
2012-10-10T23:31:18+00:00 应用程序 [scheduler.1]:/usr/local/lib/ruby/1.9.1/syck/rubytypes.rb:18:in `add'
2012-10-10T23:31:18+00:00 app[scheduler.1]:/usr/local/lib/ruby/1.9.1/syck.rb:401:in `call'
2012-10-10T23:31:18+00:00 应用程序 [scheduler.1]:/usr/local/lib/ruby/1.9.1/syck/rubytypes.rb:15:in `to_yaml'
2012-10-10T23:31:18+00:00 应用程序 [scheduler.1]:/app/vendor/bundle/ruby/1.9.1/gems/activerecord-3.2.8/lib/active_record/connection_adapters/postgresql_adapter.rb :1167:in `exec_cache'
2012-10-10T23:31:18+00:00 app[scheduler.1]:/app/vendor/bundle/ruby/1.9.1/gems/activerecord-3.2.8/lib/active_record/timestamp.rb:57 ：在“创建”中
2012-10-10T23:31:18+00:00 应用程序 [scheduler.1]:/app/vendor/bundle/ruby/1.9.1/gems/activerecord-3.2.8/lib/active_record/connection_adapters/postgresql_adapter.rb :468:in `type_cast'
2012-10-10T23:31:18+00:00 app[scheduler.1]:/app/vendor/bundle/ruby/1.9.1/gems/activesupport-3.2.8/lib/active_support/callbacks.rb:403 ：在`_run__2196213232156732911__create__4012089935340517551__callbacks'
2012-10-10T23:31:18+00:00 app[scheduler.1]:/app/vendor/bundle/ruby/1.9.1/gems/activesupport-3.2.8/lib/active_support/callbacks.rb:385 ：在`_run_create_callbacks'
2012-10-10T23:31:18+00:00 app[scheduler.1]:/app/vendor/bundle/ruby/1.9.1/gems/activerecord-3.2.8/lib/active_record/callbacks.rb:268 ：在“创建”中
2012-10-10T23:31:18+00:00 app[scheduler.1]:/usr/local/lib/ruby/1.9.1/syck/rubytypes.rb:18:in `node_export'
2012-10-10T23:31:18+00:00 app[scheduler.1]:/usr/local/lib/ruby/1.9.1/syck.rb:401:in `call'
2012-10-10T23:31:18+00:00 app[scheduler.1]:/app/vendor/bundle/ruby/1.9.1/gems/activerecord-3.2.8/lib/active_record/connection_adapters/abstract/quoting .rb:74:in `type_cast'
2012-10-10T23:31:18+00:00 应用程序 [scheduler.1]:/app/vendor/bundle/ruby/1.9.1/gems/activesupport-3.2.8/lib/active_support/notifications/instrumenter.rb :20:在“仪器”中
2012-10-10T23:31:18+00:00 app[scheduler.1]:/app/vendor/bundle/ruby/1.9.1/gems/activerecord-3.2.8/lib/active_record/callbacks.rb:264 :in `block in create_or_update'
2012-10-10T23:31:18+00:00 app[scheduler.1]:/app/vendor/bundle/ruby/1.9.1/gems/activesupport-3.2.8/lib/active_support/callbacks.rb:385 ：在`_run_save_callbacks'
2012-10-10T23:31:18+00:00 app[scheduler.1]:/app/vendor/bundle/ruby/1.9.1/gems/activerecord-3.2.8/lib/active_record/callbacks.rb:268 :in `block in create'
2012-10-10T23:31:18+00:00 应用程序 [scheduler.1]:/usr/local/lib/ruby/1.9.1/syck.rb:401:in `quick_emit'
2012-10-10T23:31:18+00:00 app[scheduler.1]:/app/vendor/bundle/ruby/1.9.1/gems/activesupport-3.2.8/lib/active_support/callbacks.rb:405 :in `__run_callback'
2012-10-10T23:31:18+00:00 应用程序 [scheduler.1]:/usr/local/lib/ruby/1.9.1/syck.rb:401:in `quick_emit'
2012-10-10T23:31:18+00:00 app[scheduler.1]:/usr/local/lib/ruby/1.9.1/syck/rubytypes.rb:18:in `node_export'
2012-10-10T23:31:18+00:00 应用程序 [scheduler.1]:/app/vendor/bundle/ruby/1.9.1/gems/activerecord-3.2.8/lib/active_record/connection_adapters/postgresql_adapter.rb :663:在“exec_query”中
2012-10-10T23:31:18+00:00 app[scheduler.1]:/app/vendor/bundle/ruby/1.9.1/gems/activerecord-3.2.8/lib/active_record/connection_adapters/abstract/database_statements .rb:63:in `exec_insert'
2012-10-10T23:31:18+00:00 app[scheduler.1]:/app/vendor/bundle/ruby/1.9.1/gems/activerecord-3.2.8/lib/active_record/connection_adapters/abstract/database_statements .rb:90:在“插入”中
2012-10-10T23:31:18+00:00 app[scheduler.1]:/app/vendor/bundle/ruby/1.9.1/gems/activerecord-3.2.8/lib/active_record/callbacks.rb:264 ：在`create_or_update'
2012-10-10T23:31:18+00:00 app[scheduler.1]:/app/vendor/bundle/ruby/1.9.1/gems/activesupport-3.2.8/lib/active_support/callbacks.rb:405 :in `__run_callback'
2012-10-10T23:31:18+00:00 app[scheduler.1]:/app/vendor/bundle/ruby/1.9.1/gems/activesupport-3.2.8/lib/active_support/callbacks.rb:81 :in `run_callbacks'
2012-10-10T23:31:18+00:00 app[scheduler.1]:/app/vendor/bundle/ruby/1.9.1/gems/activerecord-3.2.8/lib/active_record/validations.rb:50 ：在“保存”中
2012-10-10T23:31:18+00:00 app[scheduler.1]:/app/vendor/bundle/ruby/1.9.1/gems/activerecord-3.2.8/lib/active_record/persistence.rb:366 ：在“创建”中
2012-10-10T23:31:18+00:00 app[scheduler.1]:/app/vendor/bundle/ruby/1.9.1/gems/activesupport-3.2.8/lib/active_support/callbacks.rb:81 :in `run_callbacks'
2012-10-10T23:31:18+00:00 应用程序 [scheduler.1]:/app/vendor/bundle/ruby/1.9.1/gems/activerecord-3.2.8/lib/active_record/connection_adapters/postgresql_adapter.rb :1167:在“地图”中
2012-10-10T23:31:18+00:00 app[scheduler.1]:/app/vendor/bundle/ruby/1.9.1/gems/activerecord-3.2.8/lib/active_record/connection_adapters/abstract_adapter.rb :275:在“日志”中
2012-10-10T23:31:18+00:00 app[scheduler.1]:/app/vendor/bundle/ruby/1.9.1/gems/activerecord-3.2.8/lib/active_record/persistence.rb:347 ：在`create_or_update'
2012-10-10T23:31:18+00:00 app[scheduler.1]:/app/vendor/bundle/ruby/1.9.1/gems/activerecord-3.2.8/lib/active_record/persistence.rb:84 ：在“保存”中
2012-10-10T23:31:18+00:00 app[scheduler.1]:/app/vendor/bundle/ruby/1.9.1/gems/activesupport-3.2.8/lib/active_support/callbacks.rb:425 ：在`_run__2196213232156732911__save__4012089935340517551__callbacks'
2012-10-10T23:31:18+00:00 app[scheduler.1]:/app/vendor/bundle/ruby/1.9.1/gems/activerecord-3.2.8/lib/active_record/attribute_methods/dirty.rb :22:在“保存”中
2012-10-10T23:31:18+00:00 app[scheduler.1]:/app/vendor/bundle/ruby/1.9.1/gems/activerecord-3.2.8/lib/active_record/transactions.rb:241 :in `block (2 levels) in save'
2012-10-10T23:31:18+00:00 app[scheduler.1]:/app/vendor/bundle/ruby/1.9.1/gems/activerecord-3.2.8/lib/active_record/transactions.rb:295 :in `block in with_transaction_returning_status'
2012-10-10T23:31:18+00:00 app[scheduler.1]:/app/vendor/bundle/ruby/1.9.1/gems/activerecord-3.2.8/lib/active_record/connection_adapters/abstract/database_statements .rb:192:在“交易”中
2012-10-10T23:31:18+00:00 app[scheduler.1]:/app/vendor/bundle/ruby/1.9.1/gems/activerecord-3.2.8/lib/active_record/transactions.rb:208 ：在“交易”中
2012-10-10T23:31:18+00:00 app[scheduler.1]:/app/vendor/bundle/ruby/1.9.1/gems/activerecord-3.2.8/lib/active_record/transactions.rb:293 :in `with_transaction_returning_status'
2012-10-10T23:31:18+00:00 app[scheduler.1]:/app/vendor/bundle/ruby/1.9.1/gems/activerecord-3.2.8/lib/active_record/transactions.rb:241 :in `block in save'
2012-10-10T23:31:18+00:00 app[scheduler.1]:/app/vendor/bundle/ruby/1.9.1/gems/activerecord-3.2.8/lib/active_record/transactions.rb:252 :in `rollback_active_record_state!'
2012-10-10T23:31:18+00:00 app[scheduler.1]:/app/vendor/bundle/ruby/1.9.1/gems/activerecord-3.2.8/lib/active_record/transactions.rb:240 ：在“保存”中
2012-10-10T23:31:18+00:00 app[scheduler.1]:/app/vendor/bundle/ruby/1.9.1/gems/activerecord-3.2.8/lib/active_record/persistence.rb:45 ：在“创建”中
2012-10-10T23:31:18+00:00 app[scheduler.1]:/app/app/models/worker.rb:54:in `block in add_documents'
2012-10-10T23:31:18+00:00 app[scheduler.1]: /app/app/models/worker.rb:27:in `each'
2012-10-10T23:31:18+00:00 app[scheduler.1]:/app/app/models/worker.rb:27:in `add_documents'
2012-10-10T23:31:18+00:00 app[scheduler.1]:/app/lib/tasks/scrape.rake:9:in `block (2 levels) in '
2012-10-10T23:31:18+00:00 应用程序 [scheduler.1]:/app/vendor/bundle/ruby/1.9.1/gems/rake-0.9.2.2/lib/rake/task.rb:205 ：在“通话”中
2012-10-10T23:31:18+00:00 应用程序 [scheduler.1]:/app/vendor/bundle/ruby/1.9.1/gems/rake-0.9.2.2/lib/rake/task.rb:205 :in `block in execute'
2012-10-10T23:31:18+00:00 app[scheduler.1]: /app/vendor/bundle/ruby/1.9.1/gems/rake-0.9.2.2/lib/rake/task.rb:200 ：在“每个”中
2012-10-10T23:31:18+00:00 app[scheduler.1]: /app/vendor/bundle/ruby/1.9.1/gems/rake-0.9.2.2/lib/rake/task.rb:200 ：在“执行”中
2012-10-10T23:31:18+00:00 app[scheduler.1]:/app/vendor/bundle/ruby/1.9.1/gems/rake-0.9.2.2/lib/rake/task.rb:158 :in `block in invoke_with_call_chain'
2012-10-10T23:31:18+00:00 app[scheduler.1]:/app/vendor/bundle/ruby/1.9.1/gems/rake-0.9.2.2/lib/rake/task.rb:174 ：在“每个”中
2012-10-10T23:31:18+00:00 app[scheduler.1]: /app/vendor/bundle/ruby/1.9.1/gems/rake-0.9.2.2/lib/rake/task.rb:151 :in `invoke_with_call_chain'
2012-10-10T23:31:18+00:00 应用程序 [scheduler.1]:/app/vendor/bundle/ruby/1.9.1/gems/rake-0.9.2.2/lib/rake/task.rb:176 :in `block in invoke_prerequisites'
2012-10-10T23:31:18+00:00 app[scheduler.1]:/usr/local/lib/ruby/1.9.1/monitor.rb:201:in `mon_synchronize'
2012-10-10T23:31:18+00:00 app[scheduler.1]:/usr/local/lib/ruby/1.9.1/monitor.rb:201:in `mon_synchronize'
2012-10-10T23:31:18+00:00 app[scheduler.1]:/app/vendor/bundle/ruby/1.9.1/gems/rake-0.9.2.2/lib/rake/task.rb:174 :in `invoke_prerequisites'
2012-10-10T23:31:18+00:00 app[scheduler.1]: /app/vendor/bundle/ruby/1.9.1/gems/rake-0.9.2.2/lib/rake/task.rb:151 :in `invoke_with_call_chain'
2012-10-10T23:31:18+00:00 应用程序 [scheduler.1]:/app/vendor/bundle/ruby/1.9.1/gems/rake-0.9.2.2/lib/rake/task.rb:157 :in `block in invoke_with_call_chain'
2012-10-10T23:31:18+00:00 app[scheduler.1]:/app/vendor/bundle/ruby/1.9.1/gems/rake-0.9.2.2/lib/rake/task.rb:144 ：在“调用”中
2012-10-10T23:31:18+00:00 app[scheduler.1]:/app/vendor/bundle/ruby/1.9.1/gems/rake-0.9.2.2/lib/rake/application.rb:116 :in `invoke_task'
2012-10-10T23:31:18+00:00 app[scheduler.1]: /app/vendor/bundle/ruby/1.9.1/gems/rake-0.9.2.2/lib/rake/application.rb:94 :in `block (2 levels) in top_level'
2012-10-10T23:31:18+00:00 app[scheduler.1]: /app/vendor/bundle/ruby/1.9.1/gems/rake-0.9.2.2/lib/rake/application.rb:94 :in `block in top_level'
2012-10-10T23:31:18+00:00 app[scheduler.1]: /app/vendor/bundle/ruby/1.9.1/gems/rake-0.9.2.2/lib/rake/application.rb:94 ：在“每个”中
2012-10-10T23:31:18+00:00 app[scheduler.1]: /app/vendor/bundle/ruby/1.9.1/gems/rake-0.9.2.2/lib/rake/application.rb:133 ：在“标准异常处理”中
2012-10-10T23:31:18+00:00 app[scheduler.1]: /app/vendor/bundle/ruby/1.9.1/gems/rake-0.9.2.2/lib/rake/application.rb:88 ：在`top_level'中
2012-10-10T23:31:18+00:00 app[scheduler.1]:/app/vendor/bundle/ruby/1.9.1/gems/rake-0.9.2.2/lib/rake/application.rb:66 :in `block in run'
2012-10-10T23:31:18+00:00 app[scheduler.1]: /app/vendor/bundle/ruby/1.9.1/gems/rake-0.9.2.2/lib/rake/application.rb:133 ：在“标准异常处理”中
2012-10-10T23:31:18+00:00 app[scheduler.1]: /app/vendor/bundle/ruby/1.9.1/gems/rake-0.9.2.2/lib/rake/application.rb:63 ：在“运行”中
2012-10-10T23:31:18+00:00 app[scheduler.1]: /app/vendor/bundle/ruby/1.9.1/gems/rake-0.9.2.2/bin/rake:33:in `'
2012-10-10T23:31:18+00:00 app[scheduler.1]: /app/vendor/bundle/ruby/1.9.1/bin/rake:19:in `load'
2012-10-10T23:31:18+00:00 app[scheduler.1]：任务：TOP => 交易 => 文档：add_documents
2012-10-10T23:31:18+00:00 app[scheduler.1]: /app/vendor/bundle/ruby/1.9.1/bin/rake:19:in `'
2012-10-10T23:31:20+00:00 heroku[scheduler.1]：进程以状态 1 退出
2012-10-10T23:31:20+00:00 heroku[scheduler.1]：状态从 up to complete

```

这是我试图插入数据库的模型方法：

```
def self.add_documents
  body = Nokogiri::HTML(open('http://www.someurl.com')).to_s.to_my_utf8
  Merchant_id = Merchant.find(1)
  Document.create(:merchant_id => Merchant_id, :body => body)
结尾

# 配置/初始化程序/string.rb
需要'iconv'

类字符串
  def to_my_utf8
    ::Iconv.conv('UTF-8//IGNORE', 'UTF-8', self + ' ')[0..-2]
  结尾
结尾

```

我很想在这个问题上提供任何帮助！

编辑：更新了完整的堆栈跟踪。

# c++ - 从其他文件调用 C++ 主类

> ID：12830346
> 
> 赞同：2
> 
> 时间：2012-10-11T00:11:43.900
> 
> 标签：c++

好吧，我用 C++ 制作了一个文本冒险游戏，我对它很陌生。我在java和其他一些语言方面经验丰富。但我有一个问题。我正在尝试将主文件中的类调用到我的另一个文件中，但出现错误。即使我在头文件或 .cpp 文件中包含 main.cpp，我也会得到它。我已经知道将 .cpp 调用到另一个文件中是不好的做法，但是由于 main 没有头文件，我不能完全包含它。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-11T00:18:25.677

第一条规则；发布您的代码。代码本身是比您的描述更好的调试工具。无论如何...

> 即使我在头文件或 .cpp 文件中包含 main.cpp，我也会得到它。

这是倒退。*您在使用它们的*文件中包含包含类定义的头文件，而不是相反。所以...

```
// foo.h
#ifndef FOO_H
#define FOO_H

#include <string>

class foo {
public:
    foo(const std::string& s);
    void print_whatever() const;
private:
    std::string _whatever;
};

#endif 
```

* * *

```
//foo.cpp
#include <foo.h>
#include <iostream>

foo::foo(const std::string& s) 
  : _whatever(s) { }

void foo::print_whatever() const { 
    std::cout << _whatever; 
} 
```

* * *

```
//main.cpp
#include <foo.h>

int main() {
    foo f("hola");
    f.print_whatever();
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-11T00:17:25.280

C++ 不是 Java。将您的类声明移动`main.cpp`到头文件中，并将定义放在另一个 .cpp 文件中。

然后将头文件包含在使用该类的任何文件中（包括`main.cpp`）。

# javascript - JavaScript 添加一行并更改上一个按钮名称

> ID：12830350
> 
> 赞同：0
> 
> 时间：2012-10-11T00:12:24.117
> 
> 标签：javascript, jquery, button, row

如何将新的数据行添加到表中，但将上一个按钮更改为删除？

这是我目前拥有的一个例子：

[http://jsfiddle.net/ZmDu5/1/](http://jsfiddle.net/ZmDu5/1/)

我想做的是，当用户第一次进来时，他们会在第一行填写以下数据：

复选框，名称，进行选择，其他内容，然后选择其中一个单选按钮，然后当他们单击添加时，我想添加新的空单元格行，但将前一行的添加行按钮更改为说删除并继续，直到单击提交按钮

# php - 试图将表单内容写入文本文件，但只会胡说八道

> ID：12830351
> 
> 赞同：0
> 
> 时间：2012-10-11T00:12:27.190
> 
> 标签：php, javascript, ajax, forms, webforms

我正在尝试将从此表单提交的内容写入文本文件，但没有成功，并且我不断收到奇怪的输出，例如一串空格等。

```
<?php
$data = $_POST['url_submit'];
$fh = fopen('info.txt', 'a');
if (flock($fh, LOCK_EX)) {
    fwrite($fh, $data . "\n");
    fflush($fh);
    flock($fh, LOCK_UN);
} else {
    trigger_error("failed to lock file");
}
fclose($fh);
?>    

<form method="post" action="<?=$_SERVER['PHP_SELF']?>" onSubmit="return validateURL()" id="url_submit" name="url_submit">
<input type="text" autofocus="" autocomplete="off" placeholder="" style="width: 600px;margin-left: -11%;" value="" name="url">
</form> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-11T00:15:08.027

您输入的名称是 url 而不是 url_submit。

```
$data = $_POST['url']; 
```

你的 javascript 函数 validateURL() 做什么？

# wpf - 覆盖 DataGrid 的集合元素可防止编辑下一个选定的单元格

> ID：12830357
> 
> 赞同：1
> 
> 时间：2012-10-11T00:13:10.170
> 
> 标签：wpf, datagrid, observablecollection

我有一个由 ObservableCollection 支持的 DataGrid。每当我更改一些数据时，我都会将整个 ObservableCollection 写入远程服务器。然后几毫秒后，我从服务器收到更新。由于设计的性质以及为了维护 DataGrid 中的选定元素，我使用来自服务器的更新一个一个地覆盖 ObservableCollection 中的元素。

问题是我可以编辑一行的单元格，然后单击另一行，我将无法编辑该单元格。在进行编辑之前，我必须再次单击另一个单元格。

我知道这与延迟后覆盖元素有关，下面的示例重现了该问题。关于发生了什么的任何想法？

xml:

```
<Window x:Class="WpfApplication3.Window1"
xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
xmlns:dg="clr-namespace:Microsoft.Windows.Controls;assembly=WPFToolkit"
Title="Window1" Height="300" Width="300">
<Grid>
  <dg:DataGrid Name="dg" AutoGenerateColumns="True"/>
</Grid>
</Window> 
```

后面的代码：

```
using System;
using System.Windows;
using System.Collections.ObjectModel;
using System.ComponentModel;
using System.Windows.Threading;

namespace WpfApplication3
{
   /// <summary>
   /// Interaction logic for Window1.xaml
   /// </summary>
   public partial class Window1 : Window
   {
      public Window1()
      {
         InitializeComponent();
         mPeople = new People();
         dg.ItemsSource = mPeople.mList;      
      }

      public People mPeople;
   }

   public class People : INotifyPropertyChanged
   {
      public event PropertyChangedEventHandler PropertyChanged;

      public People()
      {
         mList = new ObservableCollection<Person>();
         mList.Add(CreatePerson("Jacob", "Lewis"));
         mList.Add(CreatePerson("Scott", "Doe"));
         mList.Add(CreatePerson("Corey", "Dorn"));

         dp = new DispatcherTimer();
         dp.Tick += new EventHandler(dp_Tick);
         dp.Interval = new System.TimeSpan(0, 0, 0, 0,100);
      }

      public Person CreatePerson(string first, string last)
      {
         Person p = new Person(first, last);
         p.EditCompleted += new Person.EditCompletedDelegate(OnPersonEditComplete);
         return p;
      }

      public void OnPersonEditComplete(Person p)
      {
         dp.Start();
      }

      void dp_Tick(object sender, EventArgs e)
      {
         dp.Stop();
         for (int i = 0; i < mList.Count; i++) {
            mList[i] = CreatePerson(mList[i].FirstName, mList[i].LastName);
         }
      }

      public ObservableCollection<Person> mList;
      private DispatcherTimer dp;
   }

   public class Person : INotifyPropertyChanged, IEditableObject
   {
      public event PropertyChangedEventHandler PropertyChanged = delegate { };
      public delegate void EditCompletedDelegate(Person p);
      public EditCompletedDelegate EditCompleted;

      void IEditableObject.EndEdit()
      {
         EditCompleted(this);
      }

      void IEditableObject.BeginEdit() { }
      void IEditableObject.CancelEdit() { }

      public Person(string first, string last)
      {
         FirstName = first;
         LastName = last;
      }

      public string FirstName 
      {
         get { return mFirstName; }
         set { mFirstName = value; PropertyChanged(this, new PropertyChangedEventArgs("FirstName")); }
      }

      public string LastName
      {
         get { return mLastName; }
         set { mLastName = value; PropertyChanged(this, new PropertyChangedEventArgs("LastName")); }
      }

      private string mFirstName;
      private string mLastName;
   }
} 
```

# delphi - delphi setup - 错误无法启动设置损坏或密码保护

> ID：12830358
> 
> 赞同：1
> 
> 时间：2012-10-11T00:13:15.800
> 
> 标签：delphi, delphi-xe2, installaware

一开始我有这个错误，当我想安装`rad studio xe2`时`windows xp sp3`。我不确定我有哪个版本的 radstudio，但`iso`文件名是`delphicbuilder_xe2_4429_win_dl`

有完整的错误：

> 安装感知向导
> 
> 无法开始安装 - 安装文件可能已损坏，或者您的密码可能错误。如果您下载了此文件，请下载新副本。如果文件受密码保护，请检查您的密码并重试。

我确定`iso`文件没有损坏并且没有密码保护。因为我`iso`以前用过这个文件。但我不知道为什么我想开始安装时出错。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-03T16:09:06.510

该错误通常意味着文件不完整 - 它可能缺少 1 个字节。如果缺少任何字节，安装程序将不会启动。

# java - 是否指定 @Transactional rollbackFor 还包括 RuntimeException

> ID：12830364
> 
> 赞同：25
> 
> 时间：2012-10-11T00:14:17.873
> 
> 标签：java, spring, exception, transactions, rollback

```
@Transactional(rollbackFor = MyCheckedException.class)
public void foo() {
    throw new RuntimeException();    
} 
```

此事务会回滚，还是我还需要在注释中包含 RuntimeException.class？

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2012-10-11T04:59:29.590

无需包含`RuntimeException`在`rollbackFor`列表中。即使您不提及它，它也会处理它。

我已经为 jdbcTemplate 尝试过：-

```
@Transactional(propagation = Propagation.REQUIRED, rollbackFor = MyException.class)
public void updateSalary(final int increment){
    jdbcTemplate.update("update EMPLOYEE set emp_salary = emp_salary + ?", increment);
    throw new RuntimeException("update exception");
} 
```

```
输出：
插入后：
1 迪帕克 35000
2 约格什 35000
3 阿迪亚 35000

更新异常
更新后
1 迪帕克 35000
2 约格什 35000
3 阿迪亚 35000

```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2012-10-11T05:45:11.277

> 但是请注意，Spring 框架的事务基础代码默认情况下只会在运行时、未经检查的异常情况下将事务标记为回滚；也就是说，当抛出的异常是 RuntimeException 的实例或子类时。（默认情况下，错误也会导致回滚。）从事务方法抛出的检查异常不会导致事务回滚。

[来源](http://static.springsource.org/spring/docs/2.0.x/reference/transaction.html)

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2017-07-17T15:37:25.350

因此它也可以使用 CheckedException 回滚（默认为 RuntimeException），例如：

```
@Transactional(rollbackFor = Exception.class)
public void save(Book book) throws Exception {
    bookRepository.save(book);
    System.out.println("Saved in transcation.");
    // No data is persisted
    if (true) {
        throw new Exception();
    }
} 
```

# python - 如何创建带参数的 GET 请求？

> ID：12830365
> 
> 赞同：10
> 
> 时间：2012-10-11T00:14:35.927
> 
> 标签：python, http, get, urllib2

默认情况下，似乎（对我来说）每个`urlopen()`带参数的人似乎都发送一个 POST 请求。如何设置调用以发送 GET？

```
import urllib
import urllib2

params = urllib.urlencode(dict({'hello': 'there'}))
urllib2.urlopen('http://httpbin.org/get', params) 
```

> urllib2.HTTPError：HTTP 错误 405：不允许使用方法

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-10-11T00:28:41.883

您可以使用与发布请求相同的方式：

```
import urllib
import urllib2

params = urllib.urlencode({'hello':'there', 'foo': 'bar'})
urllib2.urlopen('http://somesite.com/get?' + params) 
```

第二个参数只应在发出 POST 请求时提供，例如在发送`application/x-www-form-urlencoded`内容类型时。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-10-11T00:25:41.383

当提供数据参数时，HTTP 请求将是 POST 而不是 GET。试试`urllib2.urlopen('http://httpbin.org/get?hello=there')`吧。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-10-11T00:42:55.907

如果您正在发出 GET 请求，那么您想要传递查询字符串。您可以通过放置问号“？”来做到这一点。在参数之前的网址末尾。

```
import urllib
import urllib2

params = urllib.urlencode(dict({'hello': 'there'}))
req = urllib2.urlopen('http://httpbin.org/get/?' + params)
req.read() 
```

# ruby-on-rails - Rails：从控制器重定向

> ID：12830366
> 
> 赞同：0
> 
> 时间：2012-10-11T00:14:45.677
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3, ruby-on-rails-3.2

在我的 Rails 3.2 项目中，在我的控制器中，我有一个`show_html`函数。如果它可以在数据库中找到具有特定 URL 的站点，它将把它传递给视图。否则，我希望它重定向到[http://www.google.com](http://www.google.com)

```
def show_html
  site_list = Site.where(:url => params[:url])
  if site_list.length > 0
    site = site_list.first

  else
    redirect_to "http://www.google.com"
  end

  @html = site.html
  render "show_html.html.erb"

end 
```

当我测试它时`site_list.length > 0`，它可以工作。但是什么时候`site_length_list = 0`，它给出了一个错误`undefined method 'html' for nil:NilClass`。为什么它不进入`else`语句并渲染`google.com`？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-11T00:27:57.837

重定向后，您不需要渲染（以及在其他情况下为 nil.html 的 site.html）。你需要其中之一。

```
def show_html
  site_list = Site.where(:url => params[:url])
  if site_list.length > 0
    site = site_list.first
    @html = site.html
    render "show_html.html.erb"
  else
    redirect_to "http://www.google.com"
  end
end 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-11T00:31:27.890

如果你不进入`if`，你`site`将成为`nil`。
如果你不设置`return`，`redirect`该函数将一直向下，即使你没有 nil 错误，你可能会得到另一个带有重定向 + 渲染的错误。

定义函数的简洁方法

```
def show_html
  site_list = Site.where(:url => params[:url])

  return redirect_to "http://www.google.com" if site_list.empty?

  site = site_list.first
  @html = site.html
  render "show_html.html.erb"
end 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-11T00:19:10.323

似乎将执行重定向后的指令。这是[一篇](http://blog.hulihanapplications.com/browse/view/60-rails-security-execute-after-redirect)引用此问题的文章。

解决此问题的一种方法是`return`重定向，如下所示：

```
def show_html
  site_list = Site.where(:url => 参数[:url])
  如果 site_list.length > 0
    站点 = site_list.first

  别的
    返回redirect_to“http://www.google.com”
  结尾

  @html = 网站.html
  渲染“show_html.html.erb”

结尾

```

# php - 在 mysql/php 中选择列名

> ID：12830367
> 
> 赞同：0
> 
> 时间：2012-10-11T00:14:55.533
> 
> 标签：php, mysql, select

向站点添加一些 php/mysql 数据库查询，但不知道如何构建这个。

该表如下所示：

```
memberid    1111    1112    1119    1349    1350...
1           1       1       0       0       0
2           0       1       1       0       0
3           1       1       0       0       1
... 
```

列名（1111 等）是视频 ID，0 和 1 表示该成员的队列中是否有该视频。

我的查询需要查看一位成员，并查看他们的队列中有哪些视频。

我打算让我的代码看起来有点像：

```
$data = mysql_query("SELECT column names FROM queue WHERE memberid = $memberid AND its value = 1", $connection);
if (!$data) {
    die("Database query failed: " . mysql_error());
}

while ($result = mysql_fetch_array($data)) {
    $list[] = $result['columnnames'];
} 
```

帮助！谢谢。-丹尼尔

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-11T00:26:45.533

为什么每个视频都有一个专栏？

成员：

```
CREATE TABLE member (
    member_id INT PRIMARY_KEY,
    name VARCHAR(100)
); 
```

视频：

```
CREATE TABLE video (
   video_id INT PRIMARY_KEY,
   title VARCHAR(150)
); 
```

成员队列：

```
CREATE TABLE memberqueue (
    member_id INT,
    video_id INT
); 
```

在他们的队列中获取成员视频：

```
SELECT video.video_id, video.title
FROM member
JOIN memberqueue
    ON member.member_id = memberqueue.member_id
JOIN video
    ON memberqueue.video_id = video.video_id
WHERE member.member_id = $member_id 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-11T00:35:03.210

此外，如果您*真的*想获取列名，请执行以下操作：

```
SELECT column_name 
FROM information_schema.columns 
WHERE table_schema = 'YOUR_DATABASE_NAME' 
AND table_name = 'YOUR_TABLE_NAME'; 
```

当然，这意味着您的 MySQL 用户`SELECT`需要`information_schema`.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-11T00:24:40.943

像这样的东西应该工作，

```
SELECT if (`1111`=1 then `1111` else NULL) as `1111`, if (`2222`=1 then `2222` else NULL) as `2222` ... 
FROM queue
WHERE memberid = $memberid 
```

我还没有测试过，所以可能需要一些时间。还有很多更好的方法来处理这样的事情。添加新视频时，您会怎么做？添加新的数据库列？

您是否考虑过拥有一列并将视频存储为一点。然后保持位到视频的映射。

```
eg.
member_id       videos
1               1010
2               0110

videos table
video_id        bit
1               1000
2               0100
3               0010
4               0001 
```

现在您可以使用会员 ID 选择视频的值。并使用按位运算来确定哪些视频在他们的队列中。

# apache - 将旧子域重定向到新子域

> ID：12830374
> 
> 赞同：2
> 
> 时间：2012-10-11T00:16:38.213
> 
> 标签：apache, .htaccess, redirect, rewrite

我正在尝试分别将旧子域重定向到新子域：

```
sub.mydomain.com/d/(all_files),
sub.mydomain.com/d2/(all_files) 
```

重定向到

```
sub2.mydomain.com/d/(all_files),
sub2.mydomain.com/d2/(all_files) 
```

原始“子”中还有其他文件夹/文件不会被重定向。只有“d”和“d2”文件夹中的文件需要重定向。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-11T00:20:56.867

用于`RewriteCond`测试`HTTP_HOST`：

```
RewriteEngine On
# If it matches sub. the old subdomain,,,
RewriteCond %{HTTP_HOST} ^sub\.
# Redirect URLs starting with d/ or d2/ into sub2.mydomain.com
RewriteRule ^(d2?)/(.*)$ http://sub2.mydomain.com/$1/$2 [L,R=301] 
```

表达式`^(d2?)`为：

*   `^`字符串的开头
*   `d`后跟一个可选的`2`（`?`表示前面的表达式是可选的）
*   `()`整个东西都被捕获以供重用`$1`

# node.js - 使用 Stylus 编写一个由 nginx 服务的 CSS 文件

> ID：12830377
> 
> 赞同：1
> 
> 时间：2012-10-11T00:17:04.833
> 
> 标签：node.js, stylus

在`node.js`环境中，不是每次都`stylus`生成，而是希望将文件写入要由.`.css``.css``nginx`

似乎名称的版本控制部分，例如，`client-<unixTime>.css`然后`nginx`会很高兴并且页面缓存将正常工作。

有没有现成的工具可以帮助解决这个问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-15T06:04:55.097

没有意识到这`stylus`也是一个可以一次性运行或作为恶魔运行的可执行文件。在任何一种情况下，都会将`.styl`文件转换为`.css`，将它们放在您选择的目录中。

in `node.js`, 获取可执行文件

```
sudo npm install stylus -g

```

对我来说，`stylus`由于`stylus middleware`. 而不是解决这个问题，使用可执行文件。这也使开发和生产`node`服务器更紧密地保持一致，但不能解决版本控制问题。

* * *

这是我编译一个文件（同步）的函数：

```
var stylus = require('stylus'),
    笔尖=需要（'笔尖'）；

// 编译手写笔
export.css = 函数（fn，出）{
  var buf = fs.readFileSync(fn, 'utf8' );
  var oldCode = (fs.existsSync(out)) ? fs.readFileSync(out, 'utf8') : 'none';
  手写笔（buf）
    .set('文件名', fn)
    .使用（笔尖（））
    .render（函数（错误，新代码）{
      if( err ) throw( '手写笔错误: '+err );
      如果（旧代码！=新代码）{
        console.log('手写笔：创建'+out);
        fs.writeFileSync(out, newCode, 'utf8');
      }
    });
};

```

（在使用（同步）使用非当前`gz`文件编译我 gzip 之后`compress-buffer`

# c# - 选择所有节点

> ID：12830383
> 
> 赞同：6
> 
> 时间：2012-10-11T00:17:27.407
> 
> 标签：c#, xml

我想获取 xml 文件中的所有元素。

我只得到第一个元素。

```
XmlDocument XDoc = new XmlDocument();
            XDoc.Load("d://avi.xml");        
            XmlNodeList XList = XDoc.SelectNodes("//level1");
            foreach (XmlNode XNode in XList)
            {
                Console.WriteLine("the current node is - {0}", XNode.Name);
            } 
```

xml：

```
<?xml version="1.0" encoding="utf-8"?>
<level1>
    <level2>
        <level3>header3</level3>
            <level4>another</level4>
        <level31>header31</level31>
    </level2>
    <level2>
        <level3>nnn</level3>
        <level31>nnnnn</level31>
    </level2>
</level1>
<!--test test--> 
```

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-10-11T00:31:49.130

试试怎么样：

```
XmlNodeList XList = XDoc.SelectNodes("//*"); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2021-12-29T14:44:44.567

```
string nodeSet = @"//* | //*/@*"; //gets both elements & attributes
XmlNodeList allNodes = XDoc.SelectNodes(@nodeSet); 
```

# javascript - scrollpath.js 获得最高价值

> ID：12830384
> 
> 赞同：0
> 
> 时间：2012-10-11T00:17:33.080
> 
> 标签：javascript, jquery, path, scroll

我如何获得追随最高价值？

```
<div class="sp-scroll-handle" style="top: 1.0416666666666665px; "> </div> 
```

这个值是由一些javascript创建的，我认为它如下：

```
function dragScrollHandler( e ) {
        var dragStep,
            y = e.clientY - scrollBar.offset().top;

        dragStep = limitWithin( Math.round( y / scrollBar.height() * ( pathList.length - 1 ) ), 0, pathList.length - 1 );

        scrollToStep( snap(dragStep, STEP_SIZE) );
    } 
```

现在我需要这个值，我试过这个：

```
$('.sp-scroll-handle').scroll(function () {

    var top_value = $('.sp-scroll-handle').css("top");
    $('.settings b').text(top_value);}
}); 
```

但它不起作用 - 有什么线索吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-11T00:20:57.193

由于您正在选择一个类，请尝试像这样循环：

```
$('.sp-scroll-handle').each(function(i) {
  if(i=0){ 
    //assuming you want the first .sp-scroll-handle top value
    $('.settings b').text($(this).css('top'));
  }
}); 
```

`offset.top`也可以帮助您获得所需的东西。[文档](http://api.jquery.com/offset/)

根据您的评论，我建议您阅读有关[scrollTop()](http://api.jquery.com/scrollTop/)的文档。这似乎是您正在寻找的值，它与 CSS`top`值不同。

# jquery - 让我的 jquery 代码在 ie8 上运行良好

> ID：12830394
> 
> 赞同：0
> 
> 时间：2012-10-11T00:19:16.650
> 
> 标签：jquery, internet-explorer-8

这是我现在的代码：

```
jQuery(document).ready(function($) {
$("div#main").hide();
$("div#footer").hide();
setTimeout(function () { $("div#main").fadeIn("slow"); }, 2000);
setTimeout(function () { $("div#footer").fadeIn("slow"); }, 2000);
}); 
```

这是网站： [http ://thecodefixer.com/tatmuda/blog/](http://thecodefixer.com/tatmuda/blog/)

请在ie8中查看，看看会发生什么

我需要先查看背景图像，然后主要内容方块和页脚会淡入淡出……（就像在 Firefox 和 chrome 中一样……效果很好）

有人知道如何在ie8中解决这个问题吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-11T00:35:22.913

`display:none`在 CSS 中默认这两个元素。看起来 IE8 中的问题是加载所有内容的时间太长，而您的 #main 和 #footer 都`block`在开始。然后当 jQuery 最终“准备好”时，这些元素就被隐藏了。这就是让它们像那样闪烁的原因。因此，将其添加到您的页面以查看是否是这种情况：

```
#main{display:none;}
#footer{display:none;} 
```

# normalization - 归一化 - 朴素贝叶斯

> ID：12830395
> 
> 赞同：1
> 
> 时间：2012-10-11T00:19:34.410
> 
> 标签：normalization, classification

我试图理解为什么在将数值数据提供给朴素贝叶斯分类器之前对其进行标准化会有更好的结果。这是否与此特定分类器中用于计算的正态分布有关？如何计算？

# ruby - Ruby Datamapper 如何在同一个应用程序中使用不同的数据存储

> ID：12830396
> 
> 赞同：2
> 
> 时间：2012-10-11T00:19:37.687
> 
> 标签：ruby, sinatra, datamapper, ruby-datamapper

我正在将 sinatra 与 datamapper 一起使用，并且有多个数据库，我想在同一个应用程序中按照我的逻辑连接并使用它们。

我在一个文件中定义了我的数据映射器设置，比如 app.rb

```
#Default database
dm = DataMapper.setup :default, {
:adapter => 'mysql',
:path => 'dsfsdf',
:username => 'sdf2r',
:password => '234wer',
:host => 'f3rwefwe'
}

#Logrecord database
lrdm = DataMapper.setup :logrecdm, {
:adapter => 'mysql',
:path => 'dsf34',
:username => 't4h6',
:password => '56erg',
:host => 'g45gfg'
}

#my database
mdb = DataMapper.setup :mydb, {
:adapter => 'mysql',
:path => 'dsf34',
:username => 't4h6',
:password => '56erg',
:host => 'g45gfg'
}

# Here I include all my model files.

DataMapper.finalize 
```

## 我的第一个模型文件（xyz_db.rb），对应于 xyz 表，该表位于默认数据存储中：default

```
 class xyz  
      include DataMapper::Resource  
      property :id, Serial
      property :created_at, DateTime  
    end 
```

## 我的第二个模型文件（userlogrecord_db.rb），对应于 userlogrecords 表，该表位于其他数据存储中：logrecdm

```
class userlogrecord  
  include DataMapper::Resource  
  property :id, Serial  
  property :content, Text, :required => true
  property :created_at, DateTime  
  property :updated_at, DateTime  
end 
```

## 我的第三个模型文件（abc_db.rb），对应于 abc，该表位于其他数据存储中：mydb

```
class abc
  include DataMapper::Resource
  is :reflective
  reflect 
end 
```

当我运行我的 app.rb 时，默认情况下第一个模型 (xyz_db.rb) 使用默认数据存储。但是对于第二个和第三个模型，我希望它们应该分别在 :logrecdm 和 :mydb 数据存储中生成。为了实现这一目标，我应该在第二个和第三个模型中做出哪些改变？在第三个数据存储（：mydb）中，我使用的是 dm-reflective。我查看了[http://datamapper.org/docs/misc.html](http://datamapper.org/docs/misc.html)但这并没有真正帮助。任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-11T01:11:21.410

我找到了解决方案

```
class abc
  include DataMapper::Resource
  def self.default_repository_name
    :mydb
  end

  is :reflective
  reflect 
end 
```

我从[http://workswithruby.com/2008/12/using-datamapper-on-legacy-databases](http://workswithruby.com/2008/12/using-datamapper-on-legacy-databases)中获得了这个想法， 我希望 datamapper 文档会在某处提到它。

# eclipse - 在 Eclipse 中刷新问题视图

> ID：12830400
> 
> 赞同：3
> 
> 时间：2012-10-11T00:20:05.060
> 
> 标签：eclipse, eclipse-cdt

有时我的 C++ 项目中有“**未解决的包含**”。在项目中重建索引会从源代码中删除标记，但`Problems View`仍然会列出它们，就好像它们没有被解析一样。

让它们离开的唯一方法`Problems View`是单击它们，这将打开带有`#include`指令的相应文件，并使 Eclipse 意识到它们已被解决（Eclipse 然后删除与该文件相关的所有包含问题）。

有没有办法让 Eclipse`Problems View`在重建索引后刷新？我试过了 `F5`， `Ctrl-a F5`但没有运气。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-11T14:35:47.987

使用 CDT，您可能必须重新编译源代码以消除警告/错误标记。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-11T06:08:58.277

这个问题根本与问题视图无关。问题视图仅*显示由**其他*插件计算的警告/错误，并且始终是最新的。因此，如果 CDT 项目发生这种情况，则必须在 CDT 安装设置或 CDT 项目属性中搜索问题。

# java - JavaFX 2按钮大小填充宽度并且每个宽度都相同？

> ID：12830402
> 
> 赞同：13
> 
> 时间：2012-10-11T00:20:31.447
> 
> 标签：java, javafx-2

在 Java FX 2.2 中工作。场景的水平宽度是固定的，但在编译时是未知的。我想在水平行中放置 2 个或更多按钮，以完全填充场景中的水平空间，并且每个按钮的宽度完全相同。按钮的数量随程序状态动态变化。什么程序片段会完成这个？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2016-06-17T21:23:27.760

具有属性绑定的更清洁的解决方案：

```
 HBox buttonLayout = new HBox();
    buttonLayout.getChildren().add(button1);
    buttonLayout.getChildren().add(button2);

    int btnCount = buttonLayout.getChildren().size();
    button1.prefWidthProperty().bind(buttonLayout.widthProperty().divide(btnCount));
    button2.prefWidthProperty().bind(buttonLayout.widthProperty().divide(btnCount)); 
```

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2012-10-11T06:17:07.857

[HBox javadoc](http://docs.oracle.com/javafx/2/api/javafx/scene/layout/HBox.html)中的这段代码几乎可以满足您的要求，除了“按钮本身的大小根据按钮中包含的文本而不同 - 更宽的文本会导致更宽的按钮”。

```
HBox hbox = new HBox();
Button button1 = new Button("Add");
Button button2 = new Button("Remove");
HBox.setHgrow(button1, Priority.ALWAYS);
HBox.setHgrow(button2, Priority.ALWAYS);
button1.setMaxWidth(Double.MAX_VALUE);
button2.setMaxWidth(Double.MAX_VALUE);
hbox.getChildren().addAll(button1, button2); 
```

通过创建基于 HBox 的自定义布局窗格并覆盖它的布局方法，您可以获得您所描述的行为。

```
import javafx.application.Application;
import javafx.collections.ObservableList;
import javafx.event.*;
import javafx.scene.*;
import javafx.scene.control.Button;
import javafx.scene.layout.*;
import javafx.stage.Stage;

// displays equal width buttons which fill a layout region's width.
// http://stackoverflow.com/questions/12830402/javafx-2-buttons-size-fill-width-and-are-each-same-width
public class HorizontallyTiledButtons extends Application {
  public static void main(String[] args) { launch(args); }
  @Override public void start(Stage stage) {
    final Button addButton    = new Button("Add");
    final Button removeButton = new Button("Remove");
    final Button extraButton  = new Button("The wizard of Frobozz is watching");

    final ButtonBar buttonBar = new ButtonBar(5, addButton, removeButton);

    addButton.setOnAction(new EventHandler<ActionEvent>() {
      @Override public void handle(ActionEvent event) {
        buttonBar.addButton(extraButton);
      }
    });

    removeButton.setOnAction(new EventHandler<ActionEvent>() {
      @Override public void handle(ActionEvent event) {
        buttonBar.removeButton(extraButton);
      }
    });

    VBox layout = new VBox(10);
    layout.getChildren().addAll(buttonBar);
    layout.setStyle("-fx-background-color: cornsilk; -fx-padding: 10;");

    stage.setScene(new Scene(layout));
    stage.setWidth(800);
    stage.show();
  }

  class ButtonBar extends HBox {
    ButtonBar(double spacing, Button... buttons) {
      super(spacing);
      getChildren().addAll(buttons);
      for (Button b: buttons) {
        HBox.setHgrow(b, Priority.ALWAYS);
        b.setMaxWidth(Double.MAX_VALUE);
      }
    }

    public void addButton(Button button) {
      HBox.setHgrow(button, Priority.ALWAYS);
      button.setMaxWidth(Double.MAX_VALUE);
      ObservableList<Node> buttons = getChildren();
      if (!buttons.contains(button)) {
        buttons.add(button);
      }
    }

    public void removeButton(Button button) {
      getChildren().remove(button);
    }

    @Override protected void layoutChildren() {
      double minPrefWidth = calculatePrefChildWidth();
      for (Node n: getChildren()) {
        if (n instanceof Button) {
          ((Button) n).setMinWidth(minPrefWidth);
        }
      }
      super.layoutChildren();
    }

    private double calculatePrefChildWidth() {
      double minPrefWidth = 0;
      for (Node n: getChildren()) {
        minPrefWidth = Math.max(minPrefWidth, n.prefWidth(-1));
      }
      return minPrefWidth;
    }
  }
} 
```

示例程序输出： ![双按钮](../Images/6a76a407c5cd3f41f0037daf35572613.png) ![三键](../Images/a774c9d0af3627d7e762962164f85070.png)

# javascript - 如何引入类似ExtJs的类系统

> ID：12830406
> 
> 赞同：1
> 
> 时间：2012-10-11T00:21:05.440
> 
> 标签：javascript, extjs, extjs4

我试图通过查看 ExtJs 代码来解决这个问题，但我没有得到那里发生的魔力。

我想重新创建 Ext 类行为，可以将其剥离为两个基本功能：

*   定义
*   创造

定义用于为新类保留命名空间并保存对类构造函数的引用（至少我的调试表明这一点）。样品用法：`Ext.define('Foo', {param: 1})`；

Create 用于实例化仅返回新对象实例的类。

现在我想知道在“定义”步骤中应该存储什么，因为 afaik 构造函数本身不足以实例化一个对象？（或者我错了）

有没有人看到任何关于 javascript 中类系统主题的材料的参考资料？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-11T00:38:36.023

Douglas Crockford 有一篇关于 JavaScript 中经典继承的好文章：[http ://www.crockford.com/javascript/inheritance.html](http://www.crockford.com/javascript/inheritance.html)

我认为一些伪代码类似于 Sencha 在他们的 Ext 中的工作（尽管我认为你应该先看看上面链接中的正确实现）：

```
//define takes class name (string) and definition(object)
//definition in this case should have a method called constructor()

var classes = {};

classes.define = function(className, definition){
    classes[className] = definition;
}

//call create with class name and it will make a new class using that constructor
classes.create = function(className){
   return new classes[className].apply(this);
}

classes.define('Hello',{name: "Pi" , game : "Tennis"});

console.log(classes);

classes.create('Hello'); 
```

# mysql - MySql 不保存到磁盘

> ID：12830407
> 
> 赞同：0
> 
> 时间：2012-10-11T00:21:11.563
> 
> 标签：mysql, memory, innodb, disk

我通过 PHP 脚本将数据存储到 MySql 数据库。数据库没有存储到磁盘，但查询存储在内存中的数据库中。当我运行 mysqldump 时，文件大小约为 130M，但当我检查位于“/var/lib/mysql/db_name”中的文件大小时，它约为 80K。我使用的引擎是 InnoDB。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-11T15:41:25.377

有一种方法可以检查它是否存储到磁盘或内存中。重新启动机器，如果数据仍然存在，则将其存储在磁盘上（就是这种情况）。

因此，要进一步测试，请使用此查询来查看数据的存储位置：

```
SHOW VARIABLES WHERE variable_name LIKE '%datadir%' 
```

然后在该目录中可能会有一个带有数据库名称的文件夹。在该文件夹中检查具有您的表名的文件。有一个用于定义（table.frm）。这可能是您看到的可能是 80K 的那个，还有另一个 (tablename.ibd) 保存数据。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-11T00:29:48.980

你怎么知道它没有被存储到磁盘？

如果您根据这些尺寸进行评估，您可能不会比较相同的东西。

数据库本身只是纯数据。

mysqldump 包含所有冗长的实际创建语句，这些语句可能更长。

例如

```
Data: 1,5000,23,300  4 bytes.

Create statements from backup:
insert into summary_categories(category_sum_product) values (1);
insert into summary_categories(category_sum_product) values (5000);
insert into summary_categories(category_sum_product) values (12);
insert into summary_categories(category_sum_product) values (300);
= 262 characters/bytes 
```

# c# - 我仍然不明白为什么会出现错误：

> ID：12830411
> 
> 赞同：-2
> 
> 时间：2012-10-11T00:21:44.183
> 
> 标签：c#

```
private void button6_Click(object sender, EventArgs e)
        {
          string[] entries = File.ReadAllLines(@"D:\Keywords.txt");
            foreach (string entry in entries)
            {
                string[] values = entry.Split(',');
                LocalyKeyWords[values[0]].Clear();
                for (int i = 1; i < values.Length; i++)
                    LocalyKeyWords[values[0]].Add(values[i]);
            }
            using (var w = new StreamWriter(@"D:\Keywords.txt"))
            {
                crawlLocaly1 = new CrawlLocaly();
                crawlLocaly1.StartPosition = FormStartPosition.CenterParent;
                DialogResult dr = crawlLocaly1.ShowDialog(this);
                if (dr == DialogResult.OK)
                {
                    if (LocalyKeyWords.ContainsKey(mainUrl))
                    {
                        LocalyKeyWords[mainUrl].Clear();
                        //probably you could skip this part and create new List everytime
                        LocalyKeyWords[mainUrl].Add(crawlLocaly1.getText());
                    }
                    else
                    {
                        LocalyKeyWords[mainUrl] = new List<string>();
                        LocalyKeyWords[mainUrl].Add(crawlLocaly1.getText());
                    }
                    foreach (KeyValuePair<string, List<string>> kvp in LocalyKeyWords)
                    {
                        w.WriteLine(kvp.Key + "," + string.Join(",", kvp.Value));
                    }
                }
            } 
        } 
```

错误在线：

```
LocalyKeyWords[values[0]].Clear(); 
```

错误是：`KeyNotFoundException: The given key was not present in the dictionary`

LocalyKeyWords 是一个列表：

```
Dictionary<string, List<string>> LocalyKeyWords = new Dictionary<string, List<string>>(); 
```

而且文件`Keywords.txt`现在不是空的：

```
http://www.cnet.com,changing for test
http://www.wlala.co.co,adding 
```

然而，在阅读文件时，我遇到了异常。我在错误行上看到它`LocalyKeyWords`为空 0 但值包含两个索引：

```
[0] http://www.cnet.com and [1] changing for test 
```

索引 0 是 url，索引 1 是 url 键！

我尝试在此行之前添加并将那里的代码更改为：

```
if (LocalyKeyWords.Count == 0)
   {                         
    LocalyKeyWords[values[0]] = new List<string>();
   }
   else
   {
    LocalyKeyWords[values[0]].Clear();
   } 
```

但它没有用，也没有解决问题。我仍然在线上遇到错误。我该如何解决？

该列表是这样构建的： url，例如键：[http://www.google.com](http://www.google.com) ","google 文本文件格式也是这样的：

```
http://www.cnet.com,changing for test
http://www.wlala.co.co,adding 
```

更改测试是[http://www.cnet.com](http://www.cnet.com)的关键 ，addin 是[http://www.wlala.co.co的关键](http://www.wlala.co.co)

所以我想在从文本文件中读回 url,key 时做两件事：

1.  要将 url 及其所属键添加到 a`ListBox`所以我在构造函数中完成了它。每次用户更改 url 的键或添加新的 url 及其键时，我想在按钮单击事件中执行此操作，以便用户实时看到 ListBox 中的更改。在构造函数中，我添加了 url 和键并将其显示在 ListBox 中，如下所示：

    sr = new StreamReader(@"d:\Keywords.txt"); while (null != (line = sr.ReadLine())) {

    ```
     index = line.IndexOf(",");
                    key_of_each_line = line.Substring(0, index);
                    value_of_each_key = line.Substring(index + 1);
                    listBox1.Items.Add("Url: " + key_of_each_line + " --- " + "Key: " + value_of_each_key );
                }
                sr.Close(); 
    ```

sr 是一个`StreamReader`。它在构造函数中运行良好。构造函数中的格式相同。当用户添加新/更改键/s或url/s时，我想在按钮单击事件中实时显示它

1.  修复现在在按钮单击事件中出现异常错误的读取部分。

* * *

新阅读部分代码：

```
if (File.Exists(@"d:\Keywords.txt"))
            {
                string[] entries = File.ReadAllLines(@"D:\Keywords.txt");
                foreach (string entry in entries)
                {
                    string[] values = entry.Split(',');
                    if (LocalyKeyWords.ContainsKey(values[0]))
                        LocalyKeyWords[values[0]].Clear();
                    else
                        LocalyKeyWords[values[0]] = new List<string>();
                    for (int i = 1; i < values.Length; i++)
                        LocalyKeyWords[values[0]].Add(values[i]);
                }
            } 
```

还添加了检查文件是否存在以防用户删除它。但是如果文件存在，我不希望每次用户单击按钮时都会创建一个新的空文本文件。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-11T00:51:14.957

这样做是否可以解决问题：

```
foreach (string entry in entries)
{
    string[] values = entry.Split(',');
    LocalyKeyWords[values.First()] = values.Skip(1).ToList();
} 
```

或者，如果您可以重新分配，`LocalyKeyWords`您可以这样做：

```
var LocalyKeyWords =
    File
        .ReadAllLines(@"D:\Keywords.txt")
        .Select(entry =>
        {
            var values = entry.Split(',');
            return new
            {
                key = values.First(),
                values = values.Skip(1).ToList(),
            };
        })
        .ToDictionary(kv => kv.key, kv => kv.values); 
```

后一种方法更可取，因为它正在完全重建字典，因此不可能存在现有键。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-11T00:23:54.020

你的字典里没有钥匙。尝试检查该键是否存在于字典中，然后将其清除。此外，如果密钥不在字典中，则无需清除它。然后，您必须将密钥添加到字典中。：

```
if(LocalyKeyWords.ContainsKey(values[0]))
    LocalyKeyWords[values[0]].Clear();
else
    LocalyKeyWords[values[0]] = new List<string>(); 
```

尝试阅读[Dictionary.Item Property](http://msdn.microsoft.com/en-us/library/9tee9ht2.aspx)，其中说：

> 如果找不到指定的键，get 操作会抛出 KeyNotFoundException，而 set 操作会使用指定的键创建一个新元素。

# node.js - nodejs mongo, generate test data

> ID：12830412
> 
> 赞同：3
> 
> 时间：2012-10-11T00:21:44.473
> 
> 标签：node.js, mongoose, test-data

I would like to populate my mongo with some test data.

I have defined mongoose models and I was wandering if it was possible to pragmatically create mongo documents using pre defined models.

For example, model Items

```
var Schema = mongoose.Schema;

var Items = new Schema({
    title:      { type: String, required: true },
    desc:       { type: String}
}); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-11T14:07:18.490

Sure, do it in a single-purpose node app. Create a new app that doesn't use express or whatever web framework, but instead just has your model definition and a connection to your database.

You'll need a data source of course for the test data, which you could just use a random word generator, like this one: [http://james.padolsey.com/javascript/random-word-generator/](http://james.padolsey.com/javascript/random-word-generator/)

```
function createRandomWord(length) {
    var consonants = 'bcdfghjklmnpqrstvwxyz',
        vowels = 'aeiou',
        rand = function(limit) {
            return Math.floor(Math.random()*limit);
        },
        i, word='', length = parseInt(length,10),
        consonants = consonants.split(''),
        vowels = vowels.split('');
    for (i=0;i<length/2;i++) {
        var randConsonant = consonants[rand(consonants.length)],
            randVowel = vowels[rand(vowels.length)];
        word += (i===0) ? randConsonant.toUpperCase() : randConsonant;
        word += i*2<length-1 ? randVowel : '';
    }
    return word;
} 
```

Then you'd need to populate the database like this:

```
var numTestDocs = 100; // or however many you want
for(var i = 0; i < numTestDocs; i++) {
   var someLength = 12; // Alternatively, you could use a random number generator
   var randomWord = createRandomWord(someLength);
   var item = new Item ({
      title : randomWord ,
      desc  : randomWord + ' is just a test'
   });
   item.save(function(err, doc) {
      // do error handling if you want to
      console.log('Test Record Saved with id: ' + doc._id);
   });
} 
```

Then just run that node app.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-04-17T22:03:23.440

There are many ways to do this using different mongoose modules. Go and check mongoose fakery.

[https://www.npmjs.org/package/mongoose-fakery](https://www.npmjs.org/package/mongoose-fakery)

# android - 从 IntentService 向 Activity 发送消息

> ID：12830417
> 
> 赞同：1
> 
> 时间：2012-10-11T00:22:28.013
> 
> 标签：android, service

我在同一个应用程序中有一个活动和一个意图服务。活动结束后服务必须继续运行，所以我不想绑定。我已经在谷歌上搜索了几个小时，找不到一个很好的例子来说明如何做到这一点。我能够启动该服务并将附加信息传递给它，但现在该服务必须使用 Messenger 将数据发送回活动。

我读到这个过程基本上涉及... 调用 Message.obtain() 以获取一个空的 Message 对象 用所需的任何数据填充该对象 在 Messenger 上调用 send()，将消息作为参数提供

但我找不到任何关于如何做到这一点的代码示例。

有几篇文章引用了 SDK 示例 APIDemos 中的一个 messengerService 示例，我有，但我在那里找不到任何东西。谢谢，加里

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-11T04:08:12.673

您必须为此使用广播。您可以在完成意图服务后发送广播消息。您还需要在您的活动中注册您的意图过滤器（您想要接收数据的地方）

这可能会对您有所帮助：[http ://www.mysamplecode.com/2011/10/android-intentservice-example-using.html](http://www.mysamplecode.com/2011/10/android-intentservice-example-using.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-15T16:26:33.357

作为记录，我将回答我自己的问题，因为它可能对其他人有用......（我使用的是常规服务，而不是 IntentService，因为它需要保持活跃）

对于从服务接收消息的活动，它必须实例化一个 Handler ......

```
 private Handler handler = new Handler() 
{
    public void handleMessage(Message message) 
    {
        Object path = message.obj;

        if (message.arg1 == 5 && path != null)
        {
            String myString = (String) message.obj;
            Gson gson = new Gson();
            MapPlot mapleg = gson.fromJson(myString, MapPlot.class);
            String astr = "debug";
            astr = astr + " ";
        }
    };
}; 
```

上面的代码由我的调试内容组成。该服务将消息发送到活动，因此......

```
 MapPlot mapleg = new MapPlot();
            mapleg.fromPoint = LastGeoPoint;
            mapleg.toPoint = nextGeoPoint;              
            Gson gson = new Gson();
            String jsonString = gson.toJson(mapleg); //convert the mapleg class to a json string
            debugString = jsonString;

            //send the string to the activity
            Messenger messenger = (Messenger) extras.get("MESSENGER");
            Message msg = Message.obtain();  //this gets an empty message object

            msg.arg1 = 5;
            msg.obj = jsonString;
            try
            {
                messenger.send(msg);
            }
            catch (android.os.RemoteException e1)
            {
                Log.w(getClass().getName(), "Exception sending message", e1);
            } 
```

我现在只是选择了数字 5 作为消息标识符。在这种情况下，我在 json 字符串中传递一个复杂的类，然后在活动中重新构造它。

# c++ - 违反封装？

> ID：12830420
> 
> 赞同：5
> 
> 时间：2012-10-11T00:22:50.563
> 
> 标签：c++, encapsulation

> **可能重复：**
> [运算符重载中的类数据封装（私有数据）](https://stackoverflow.com/questions/12390408/class-data-encapsulationprivate-data-in-operator-overloading)

请看这个例子。

```
class myClass {
    int a;
public :
    myClass () {
     this->a = 0;
  }

  myClass(int val) {
     this->a = val;
  }

  void add(myClass &obj2) {
     cout << "Result = " << this->a + obj2.a;
     obj2.a = 0;
  }

  void show() {
     cout << "a = " << this->a;
  }
};

int main() {
  myClass obj1(10), obj2(20);

  obj2.show(); //prints 20.
  obj1.add(obj2);
  obj2.show(); //prints 0\. 

  return 0;
} 
```

在 add() 函数中，当我在 obj1 的上下文中实际调用 add() 时，我能够访问 obj2 的私有成员的值。这不是违反封装吗？

起初我以为编译器会给我一个错误，但事实并非如此。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-10-11T00:25:12.600

不。

封装在*类*级别工作，而不是在实例级别。

您可以访问类的任何实例的私有成员。
您甚至可以通过对从您的类派生的类的引用来访问由您的类定义的私有成员。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-11T00:32:38.147

这并不违反封装，因为您正在访问属于同一类的方法中的成员变量。如果 obj2 是另一个类的引用，例如 yourClass，那么当您访问另一个类的私有成员时，这将是违规行为。

# c# - 如何读取 microsoft project 中所有自定义字段的名称？

> ID：12830421
> 
> 赞同：0
> 
> 时间：2012-10-11T00:22:52.460
> 
> 标签：c#, ms-project, ms-project-server-2010, psi

我无法找到自定义字段的本地名称。我尝试使用 PSI 自定义字段服务，但没有运气。它似乎只是获得企业领域。我真的不确定它在哪里隐藏本地名称。

我能够从 ReadProjectDataSet 调用中获取自定义字段，但它不包含自定义字段的名称。

这是我的代码，我认为它是从 projtool 示例中复制的：

```
 public static SvcCustomFields.CustomFieldDataSet ReadCustomFields( )
    {
        CheckAccess();

        using (var scope = new OperationContextScope(projectClient.InnerChannel))
        {
            ProjectAuthentication.UseCorrectHeaders(isImpersonated);

            return customFieldsClient.ReadCustomFields(string.Empty, false);
       }
    } 
```

这是它如何出现项目桌面的屏幕截图：

![在此处输入图像描述](../Images/23e4d73151cede7813e1cb9445661d7d.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-11T17:25:24.047

代码是这样的：

```
CustomFieldDataSet cfDS = new CustomFieldDataSet();

PSLibrary.Filter cfFilter = new Microsoft.Office.Project.Server.Library.Filter();
cfFilter.FilterTableName = cfDS.CustomFields.TableName;

cfFilter.Fields.Add(new PSLibrary.Filter.Field(cfDS.CustomFields.TableName, cfDS.CustomFields.MD_PROP_NAMEColumn.ColumnName));
cfFilter.Fields.Add(new PSLibrary.Filter.Field(cfDS.CustomFields.TableName, cfDS.CustomFields.MD_PROP_IDColumn.ColumnName));
cfFilter.Fields.Add(new PSLibrary.Filter.Field(cfDS.CustomFields.TableName, cfDS.CustomFields.MD_PROP_UIDColumn.ColumnName));
cfFilter.Fields.Add(new PSLibrary.Filter.Field(cfDS.CustomFields.TableName, cfDS.CustomFields.MD_LOOKUP_TABLE_UIDColumn.ColumnName));
cfFilter.Fields.Add(new PSLibrary.Filter.Field(cfDS.CustomFields.TableName, cfDS.CustomFields.MD_PROP_TYPE_ENUMColumn.ColumnName));

cfDS = ReadCustomFields(cfFilter.GetXml(), false); 
```

该示例是作为 CustomFieldsClient 的补充编写的。它读取自定义字段的名称、ID、UID、查找表的 UID 和字段的类型。

但它只读取字段的名称。字段有用户定义的标签，标签在 Project Pro 中定义并存储在仅通过 Project Pro 可用的表定义中。

# objective-c - 右标注附件按钮在此代码的注释视图上不可见

> ID：12830423
> 
> 赞同：0
> 
> 时间：2012-10-11T00:23:10.117
> 
> 标签：objective-c, ios, button, mkmapview, mkannotation

我在我的应用程序中实现了以下功能

编译时没有错误。然而，我在模拟器中的地图注释上看不到正确的附件按钮。我看到注释，只是上面没有按钮。我错过了这个技巧吗？

```
- (MKAnnotationView *)mapView:(MKMapView *)mapView viewForAnnotation:(id 
 <MKAnnotation>)annotation
 {
    static NSString *identifier = @"Vendor";

    //Set upt the right accessory button
    UIButton *myDetailAccessoryButton = [UIButton 
    buttonWithType:UIButtonTypeDetailDisclosure];
    myDetailAccessoryButton.frame = CGRectMake(0, 0, 23, 23);
    myDetailAccessoryButton.contentVerticalAlignment = 
    UIControlContentVerticalAlignmentCenter;
    myDetailAccessoryButton.contentHorizontalAlignment = 
    UIControlContentHorizontalAlignmentCenter;

    [myDetailAccessoryButton addTarget:self
                            action:nil
                  forControlEvents:UIControlEventTouchUpInside];

     if ([annotation isKindOfClass:[Vendor class]])
     {

       MKPinAnnotationView *annotationView = (MKPinAnnotationView *) [self.mapView

       dequeueReusableAnnotationViewWithIdentifier:identifier];
       if (annotationView == nil)
      {
        annotationView = [[MKPinAnnotationView alloc]
                          initWithAnnotation:annotation
                          reuseIdentifier:identifier];
        annotationView.rightCalloutAccessoryView = myDetailAccessoryButton;
        annotationView.enabled = YES;
        annotationView.canShowCallout = YES;
        annotationView.calloutOffset = CGPointMake(-5, 5);

    }
    else
    {
        annotationView.annotation = annotation;
    }

    return annotationView;
     }

     return nil;
   } 
```

编辑此代码有效，但上述代码无效。

这是为什么？

```
 if ([annotation isMemberOfClass:[MKUserLocation class]])
    return nil;

 MKPinAnnotationView *annView=[[MKPinAnnotationView alloc]
                               initWithAnnotation:annotation
                               reuseIdentifier:@"currentloc"];

   UIButton *myDetailButton = [UIButton 
   buttonWithType:UIButtonTypeDetailDisclosure];
    myDetailButton.frame = CGRectMake(0, 0, 23, 23);
    myDetailButton.contentVerticalAlignment = 
    UIControlContentVerticalAlignmentCenter;
    myDetailButton.contentHorizontalAlignment = 
   UIControlContentHorizontalAlignmentCenter;

[myDetailButton addTarget:self
                   action:nil
         forControlEvents:UIControlEventTouchUpInside];

    annView.rightCalloutAccessoryView = myDetailButton;

   annView.animatesDrop=NO;
   annView.canShowCallout = YES;
   annView.calloutOffset = CGPointMake(-5, 5);
   return annView; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-11T01:38:57.673

您确定要添加 type 的注释`Vendor`吗？

因为第一个代码块只设置了`rightCalloutAccessoryView`for 类型的注解`Vendor`。对于任何其他类型，它返回`nil`导致通用标注（无按钮）。

第二个代码块`rightCalloutAccessoryView`为除 之外的任何注释类型设置`MKUserLocation`。

顺便说一句，您已将按钮操作设置为`nil`这意味着当它被点击时不会发生任何事情。

# ajax - 如何检测 XHR 何时返回缓存的资源？

> ID：12830425
> 
> 赞同：14
> 
> 时间：2012-10-11T00:23:42.397
> 
> 标签：ajax, http, http-headers, xmlhttprequest, http-caching

我想知道是否有一种方法可以检测何时从本地缓存返回响应？可能吗？

解决方案应该是通用的，并且适用于无条件请求。在这种情况下，响应代码始终为 200 OK，但 XHR 为第二个请求返回一个缓存的资源（例如，第一个响应包含 Expires 标头，因此无需在过期日期之前向服务器请求新资源）。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-04-16T15:48:26.803

答案是日期标题

*   如果日期标头在发送日期之前，则响应来自缓存。
*   如果日期标头在发送请求的日期之后，则响应是新鲜的。

例如

*   来自缓存：请求于 11:00 发送，响应日期为 10:59
*   无缓存：请求在 11:00 发送，响应日期为 11:01

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-11T00:37:21.900

在onreadystatechange函数中查看返回的状态码是否为304（未修改）。类似于以下内容：

```
xmlhttp.onreadystatechange=function()
{
  if (xmlhttp.readyState==4 && xmlhttp.status==304)
    {
      alert("Cached");
    }
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2016-12-20T18:39:13.223

显然，我们还可以使用[Resource Timing API](https://developer.mozilla.org/en-US/docs/Web/API/Resource_Timing_API/Using_the_Resource_Timing_API)来确定是否从浏览器缓存中提供了某些内容；如果 transferSize 为 0（并且 encodedBodySize > 0），那么这是缓存命中。

只要您使用[的是支持它的浏览器，](https://developer.mozilla.org/en-US/docs/Web/API/PerformanceResourceTiming#Browser_compatibility)这似乎是比其他解决方案更好的解决方案。

参考：[https ://developer.mozilla.org/en-US/docs/Web/API/PerformanceResourceTiming/transferSize](https://developer.mozilla.org/en-US/docs/Web/API/PerformanceResourceTiming/transferSize)

# sql-server - 获取链接服务器状态的存储过程

> ID：12830432
> 
> 赞同：2
> 
> 时间：2012-10-11T00:24:31.270
> 
> 标签：sql-server, tsql, stored-procedures, linked-server

我正在尝试创建一个存储过程来获取链接服务器的状态，以防止在尝试对其执行任何操作时出错。我在网上看到了一些例子，但我没有成功。

这是我的代码：

```
ALTER PROCEDURE [dbo].[checkLinkedServer] 
    @servername ntext
AS
BEGIN
    SET NOCOUNT ON;
    DECLARE @retval int = 0;
    BEGIN TRY
        EXEC @retval = sys.sp_testlinkedserver @servername;
        SELECT 1;
    END TRY
    BEGIN CATCH
        SELECT 0;
    END CATCH;      
END 
```

无论链接服务器是否存在，我总是得到返回值 0。

有什么想法我在这里做错了吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-10-11T00:32:56.173

您的 @servername 参数必须是类型 sysname 而不是 ntext 如错误消息所述

如果您无法更改进入过程的参数，请考虑在过程中创建一个新变量并进行转换：

```
ALTER PROCEDURE [dbo].[checkLinkedServer] 
    @servername ntext
AS
BEGIN
    SET NOCOUNT ON;
    DECLARE @retval int = 0,
            @sysservername sysname;
    BEGIN TRY
        SELECT  @sysservername = CONVERT(sysname, @servername);
        EXEC @retval = sys.sp_testlinkedserver @sysservername;
        SELECT 1;
    END TRY
    BEGIN CATCH
        SELECT 0;
    END CATCH;      
END 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-11T01:54:02.650

不幸的是，文档和实现`sp_testlinkedserver`不一致，自从在 SQL Server 2005 中添加该过程以来一直如此。BOL 说该过程**在失败时返回 1**。

作为参考，您可以查看：[http ://connect.microsoft.com/SQLServer/feedback/details/522821/sp-testlinkedserver-fails-catastrophically-when-linked-server-is-offline](http://connect.microsoft.com/SQLServer/feedback/details/522821/sp-testlinkedserver-fails-catastrophically-when-linked-server-is-offline)

# android - 如何通过 android 访问存储在 Tomcat 服务器上的 JSONObject？

> ID：12830434
> 
> 赞同：0
> 
> 时间：2012-10-11T00:24:50.030
> 
> 标签：android, json, jersey, httpclient, http-get

> **可能重复：**
> [如何从服务器下载 JSON 的示例？](https://stackoverflow.com/questions/3578441/example-of-how-to-download-json-from-server)

我已经阅读了很多教程，但仍然不清楚它是如何工作的。这是服务器端代码：

```
@GET
@Produces(MediaType.APPLICATION_JSON)
     public JSONObject respondAsReady() throws JSONException {
           JSONObject json = new JSONObject();
           json.put("email", "email");
           json.put("szam", 5);
           json.put("boolean", true);
           return json;
           } 
```

服务器端代码：

```
public class GetJson extends Activity {
    public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.getjson_layout);
    Button get=(Button)findViewById(R.id.get);

    get.setOnClickListener(new OnClickListener() {
        public void onClick(View v) {
          getMethod();
        }
      });   
    }} 
```

编写 getMethod 函数的最简单方法是什么？我不需要AsyncTask，也不需要任何额外的东西，只是为了通过服务器取回@GET中写的JSONObject，例如打印到控制台。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-12T07:08:25.190

如何使用 REST Web 服务

`String url = "getserviceurl";`// 如`http://yourhost:8080/rest-ws/resources/admin/getCities`

```
 String responseString ="";

        final HttpGet httpGet = new HttpGet(url);
        final DefaultHttpClient httpclient = new DefaultHttpClient();
        final HttpResponse response = httpclient.execute(httpGet);
        final HttpEntity reponseEntity = response.getEntity();
        InputStream inputStream = reponseEntity.getContent();

        if (inputStream != null)
        {
            responseString = getStringFromInputStream(inputStream);

        }

// This will convert your inputStream into a String
protected String getStringFromInputStream(InputStream inputStream) throws IOException
{
    String responseString = null;
    final StringBuilder stringBuilder = new StringBuilder();
    int ch;

    while ((ch = inputStream.read()) != -1)
    {
        stringBuilder.append((char) ch);
    }

    responseString = stringBuilder.toString();

    return responseString;
} 
```

# c# - 如何使用 STAMP 加密读取 tbf 文件

> ID：12830437
> 
> 赞同：3
> 
> 时间：2012-10-11T00:25:19.023
> 
> 标签：c#, python, sql, database, sml

我在迈拓硬盘中有多伦多证券交易所的股票数据。数据是一个 TBF 文件，包含`.dat`和`.pos`组件。该`.dat`文件包含二进制格式的所有 Stamp 格式传输信息。

我可以`.pos`使用 R 读取文件。它有 3 列数字，这对我来说毫无意义。数据是关于库存的信息，我认为这是 Streambase 的结果。

我需要获取一些我感兴趣的股票的 2007 年价格、价值等信息。您能否建议任何读取数据的方法？我应该使用一些特定的软件来理解这些数据吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-10-15T21:10:30.927

您是否考虑过使用 FileViewerPro 之类的东西？它的免费下载工具可以打开文件。另外，到目前为止，您尝试过哪些 Windows 程序，例如记事本、excel？

# macos - 如何在 NSTextView 中禁用查找（字典、词库、维基百科）功能？

> ID：12830438
> 
> 赞同：17
> 
> 时间：2012-10-11T00:25:21.677
> 
> 标签：macos, osx-lion, nstextview, appkit, quicklook

我的一个项目是一个测试应用程序，学生在打字时不应该能够轻松地查找单词。

[`setContinuousSpellCheckingEnabled:`](http://developer.apple.com/library/mac/documentation/Cocoa/Reference/ApplicationKit/Classes/NSTextView_Class/Reference/Reference.html#//apple_ref/occ/instm/NSTextView/setContinuousSpellCheckingEnabled:)通过和关闭 NSTextView 中的自动拼写检查相对容易[`setAutomaticSpellingCorrectionEnabled:`](https://developer.apple.com/library/mac/documentation/Cocoa/Reference/ApplicationKit/Classes/NSTextView_Class/Reference/Reference.html#//apple_ref/occ/instm/NSTextView/setAutomaticSpellingCorrectionEnabled:)。

我刚刚发现，学生[只需用三根手指在](http://www.macosxtips.co.uk/index_files/three-finger-tap-dictionary-wikipedia-lion.php)任何应用程序中的任何选定单词上轻按，然后弹出一个有用的窗口，其中包含字典、同义词库甚至维基百科条目（如果可以在那里找到该单词），这都是非常简单的。

![查找功能是什么样的](../Images/737e9d18633c77ca5af6980d3f8caad8.png)

这对 99% 的 MacOS 应用程序来说都是很棒的功能，但不适用于我的测试应用程序。

几个月后，Apple 为我提供了一个仅适用于 10.8 的（未记录且微妙的）解决方案，我最终可能会在下面的答案中提供它，但我**需要**一个也适用于 10.7 的解决方案（其中是这个功能出现的地方）。

针对这个问题有三种可能的攻击计划，但我不确定如何处理这三种中的任何一种：

1)

我需要阻止此查找功能在此文本视图中发生。

2)

我已经尝试删除字典首选项（如果它们存在；如果用户从未打开 Dictionary.app，则没有首选项）和字典缓存文件（在“ `~/Library/Cache`”中，但这似乎并没有改善这种情况。

3)

或者有没有办法能够检测到“使用三指点击时使用查找”的触控板设置？它可能在某个 com.apple.*.plist 某处或可通过“ `defaults`”检测到，但我不确定在哪里。

编辑：

只剩下一点时间来解决这个问题并奖励赏金了。这是我尝试使用“ `defaults`”的方法：

```
defaults write com.apple.driver.AppleBluetoothMultitouch.trackpad TrackpadThreeFingerTapGesture -bool false
defaults write com.apple.driver.AppleBluetoothMultitouch.trackpad TrackpadThreeFingerDoubleTapGesture -bool false 
```

但我不能 100% 确定这些是要输入的正确手势/关键字。即使在输入它们（并通过“ `defaults read com.apple.driver.AppleBluetoothMultitouch.trackpad`”验证它们是否正确保存）之后，字典查找窗口仍然出现。

现在这是*唯一有效的*方法，但它仅在 MacOS 10.8 下有效（这是暴露/引入这些方法的地方）。只需在 NSTextView 子类中重写这两个方法：

```
- (void)quickLookWithEvent:(NSEvent *)event;
- (void)quickLookPreviewItems:(id)sender; 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-17T19:55:20.213

我怀疑字典查找是以两种方式之一实现的，作为服务或通过`NSTextInputClient`协议。所以，我会`-validRequestorForSendType:returnType:`在你的文本子类中重写，看看它是否被三指点击调用。无论如何，听起来您想要`NO`为所有服务返回您的应用程序。您还应该覆盖`writeSelectionToPasteboard:types:`以返回`NO`。

如果这样做不行，请尝试覆盖 的方法`NSTextInputClient`以查看它们是否被调用。特别是，`-attributedString`和`-attributedSubstringForProposedRange:actualRange:`方法将是字典查找获取文本的方式。使这两个返回`nil`应该阻止它工作。请注意，该`NSTextInputClient`协议对于输入法的使用以及对带有重音符号和变音符号的字符的按住访问至关重要，因此您可能会破坏它。我不知道您是否能够区分来自普通输入法的请求和来自字典查找手势的请求。

如果一切都失败了，您可以[实现自定义文本视图](https://developer.apple.com/library/mac/documentation/TextFonts/Conceptual/CocoaTextArchitecture/TextEditing/TextEditing.html#//apple_ref/doc/uid/TP40009459-CH3-SW24)，而不是使用`NSTextView`. 这不是微不足道的，但你可以完全控制它的行为。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-04-10T12:08:38.363

This answer to a similar question解决了这个问题而不会抛出异常，但它使用私有API：[https ://stackoverflow.com/a/20618984/959140](https://stackoverflow.com/a/20618984/959140)

只需`-(void)quickLookWithEvent:(NSEvent *)event`在您的子类中覆盖并且不对事件执行任何操作。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-03-20T16:55:32.013

当字典屏幕弹出时，转到文件（或者可能是编辑）/首选项并取消选中所有选项，以便不检查实际的字典选项，然后关闭应用程序，它不再显示 - 大多数情况下 -偶尔尝试使用鼠标垫选择一串文本进行复制和/或剪切时，它会出现，但不像以前那样经常出现......

# ruby - 难以输出二维数组

> ID：12830440
> 
> 赞同：1
> 
> 时间：2012-10-11T00:25:38.030
> 
> 标签：ruby, class, multidimensional-array

我正在解决一个需要创建`CartesianProduct`类的问题。我应该能够通过这个 2 类列表，然后输出这些列表的笛卡尔积（所有可能的组合）。

到目前为止，我可以从此类中创建一个对象，创建所有可能的组合，但是当我尝试将这些结果输出到屏幕时，我将每个项目都放在自己的行中，就好像它没有意识到它是一个数组一样。

我的代码：

```
class CartesianProduct
    include Enumerable
    # Your code here
    def initialize(a,b)
        @output = []
        a.each do |x|
            b.each do |y|
                if !(output.include? [x,y])
                    output << [x,y]
                end
            end
        end
    end

    #getter
    def output
        @output
    end

    def each
        @output.each do |a| puts a end
    end

    #setter
    def output=(a,b)
        a.each do |x|
            b.each do |y|
                if !(output.include? [a,b])
                    output << [a,b]
                end
            end
        end
    end
end 
```

我用什么来测试：

```
c = CartesianProduct.new([:a,:b], [4,5])
=> #<CartesianProduct:0x93569f8 @output=[[:a, 4], [:a, 5], [:b, 4], [:b, 5]]> 
```

测试通过以下命令完成：`c.each { |elt| puts elt.inspect }`

我得到：

```
irb(main):1403:0> c.each { |elt| puts elt.inspect }
a
4
a
5
b
4
b
5
=> [[:a, 4], [:a, 5], [:b, 4], [:b, 5]] 
```

但我应该得到：

```
# [:a, 4]
# [:a, 5]
# [:b, 4]
# [:b, 5] 
```

我的输出不是打印`symbols`as 符号而是转换为字符串，并将每个项目打印在自己的行上......

这是家庭作业，所以我不是在寻找答案，但是朝着正确的方向轻推会很有帮助。

**编辑** =================================================== ======================= 更改我`each`在课堂上的定义解决了这个问题。

```
def each
    @output.map do |x|
        yield x
    end
end 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-11T00:46:45.960

您的问题是您正在申请`each`，`c`这是`CartesianProduct`. 你需要做`each`的就`@output`可以了。至于如何`@output`从外部访问，你应该知道；这是一件基本的事情。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-11T00:51:49.527

我刚开始使用 Ruby，但我想我找到了原因：当你调用`c.each { |elt| puts elt.inspect }` 它时，首先执行你在类中定义的调用。其结果是传递给测试中的块的字符串，该块`{ |elt| puts elt.inspect }`将它们拆分为单独的行。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-11T00:57:06.850

您的 #each in`CartesianProduct`实现不接受块，因此，对于 instance `c`，将块传递给`c.each`无效。试试这个：

```
c.each { |elt| raise "an error!" }

# no error is raised because the block is not called. 
```

现在，`each`您`puts`对`@output`. 调用`puts`数组将遍历每个元素，甚至在嵌套数组中（换句话说，数组的扁平化版本）：

```
ruby-1.9.3-p125 :006 > puts [1,2,[3,4]]
1
2
3
4
=> nil 
```

我相信您想要的是`each`将给定块传递给每个方法的实现`@output`：

```
def each(&block)
  @output.each(&block)
end 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-12T20:49:34.463

更改我对班级中每个人的定义解决了这个问题。

```
def each
    @output.map do |x|
        yield x
    end
end 
```

# node.js - new Date() 如何返回比先前调用 new Date() 更早的时间（在 Node.js 中）？

> ID：12830442
> 
> 赞同：2
> 
> 时间：2012-10-11T00:25:48.730
> 
> 标签：node.js, date

我有这样的代码顺序：

```
 var d0 = new Date();
  ... 
  ...
  var d1 = new Date();

  if (d0>d1) {
    console.log("Problem");
  } 
```

先看一下，d1 没有办法比 d0 大。但我刚刚在 2 天前在生产服务器上体验过。d1 比 d0 早几毫秒。怎么会这样？

Date() 是从哪里来的？是V8的吗？还是从操作系统系统？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-11T00:47:22.220

如果不仔细查看您的系统就很难说，但总的来说，使用日期和时间库进行编程有时会非常非常奇怪。

推荐阅读：[程序员相信时间的谎言](http://infiniteundo.com/post/25326999628/falsehoods-programmers-believe-about-time)

我最近在生产机器上的 v8 中遇到了类似的问题，并且（我们认为）正在发生的事情是网络时间守护程序正在改变系统的时钟——正如它的设计目的一样。所以，我们偶尔会有一些分析说我们的“结束时间”*比*我们的“开始时间”早，因为系统时钟在代码执行过程中被 NTP 重新同步。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-11T00:42:39.960

许多服务器使用某种方法将它们的系统时间同步到某个更高的权限（使用 NTP 或其他协议）。这种同步是定期进行的，如果需要使系统时钟恢复同步，可能会导致时间向后移动。这是与您自己的代码异步完成的，因此它可能发生在这两个`new Date()`调用之间。

的价值`new Date()`最终来自 V8 调用以获取时间的操作系统。

# c# - 未来的 c# XNA 还是 c++ directX11？

> ID：12830448
> 
> 赞同：5
> 
> 时间：2012-10-11T00:26:54.160
> 
> 标签：c#, c++, xna

我最近开始学习 XNA，非常喜欢它，它是托管代码。但是，在阅读了一些资料后，似乎对于 windows 8 和 windows 8 手机，XNA 不会更新以使用这些新功能，而将使用 Directx11。

那么，有人知道这是不是真的吗？我不知道任何 c++，但我对 c# 相当有信心，所以我想坚持使用 XNA，但如果未来将使用 c++ 和 Directx，也许我现在应该切换？如果我知道 c#，那么学习 c++ 的难度有多大？

如果情况是directX是未来的方式，我可能只是团结一致，所以我可以继续使用c#。

非常感谢有关此主题的任何帮助，非常感谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-11T13:58:17.757

在去年的 Build 大会和其他场所，MS 的 Herb Sutter 是这样说的（转述）：

* * *

在过去的十年里，硬件变得越来越强大，以至于我们能够负担得起像 .net 这样的生产性语言的开销。如果我们突破性能限制，那又如何，明年计算机将毫不费力地处理它。以托管语言制作软件的成本低于本地语言，而且我们拥有硬件能力来减轻托管开销。

在接下来的十年中，用于完成工作的硬件将变得更小、更移动、更不强大、更节能。突然间，软件中的代码效率和性能变得越来越重要。到目前为止，native 具有这种优势。

* * *

我想由于图形软件（游戏）可能是一个快速达到性能极限的开发领域，因此可以理解这可能是第一个经历这种转变的领域。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-11T01:43:00.810

据我所知（以及从网上找到的信息）windows 将远离 XNA，尽管从技术上讲它应该是向后兼容的。如果您正在寻找有关 XNA 未来的文章来阅读：

[https://gamedev.stackexchange.com/questions/22292/what-is-the-future-of-xna-in-windows-8-or-how-will-manged-games-be-develop-in](https://gamedev.stackexchange.com/questions/22292/what-is-the-future-of-xna-in-windows-8-or-how-will-manged-games-be-developed-in)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-11T14:08:09.660

我会坚持使用 C#，你的开发速度更快，性能差异也不大，所以你不必抱怨它。

如果您也不想针对移动平台，我建议您使用 OpenGL，从它开始更难，但您应该能够开发一个同时支持移动和桌面平台的框架（使用 MonoTouch 和 Monodroid）。

* * *

**对于那些现在尖叫 DirectX 更好的人：**我知道，一般来说你是对的，但 iOS 和 Android 等移动平台不支持 DirectX。所有平台都有一个XNA[克隆](http://monogame.codeplex.com/)，它可能正在工作，但我不知道它是否支持新的 DirectX/OpenGL 功能。

# c++ - 是否有任何控制循环展开的预处理器指令？

> ID：12830450
> 
> 赞同：10
> 
> 时间：2012-10-11T00:27:14.030
> 
> 标签：c++, visual-c++, pragma, preprocessor-directive

此外，假设循环中的所有操作完全独立于其他迭代，编译器如何确定展开循环的程度。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-10-11T00:31:26.840

对于 MSVC，只有一个向量独立提示：http: [//msdn.microsoft.com/en-us/library/hh923901.aspx](http://msdn.microsoft.com/en-us/library/hh923901.aspx)

```
#pragma loop( ivdep ) 
```

对于许多其他编译器，例如[Intel](http://software.intel.com/en-us/articles/use-pragmas-with-the-intel-c-compiler-for-linux-on-64-bit-architecture) / [ibm](http://publib.boulder.ibm.com/infocenter/comphelp/v8v101/topic/com.ibm.xlcpp8a.doc/compiler/ref/rnpgunrl.htm)，有一些用于优化循环的 pragma 提示：

```
#pragma unroll
#pragma loop count N
#pragma ivdep 
```

MSVC++ 人员有一个关于展开启发式的线程：[http://social.msdn.microsoft.com/Forums/en-US/vcgeneral/thread/d0b225c2-f5b0-4bb9-ac6a-4d4f61f7cb17/](http://social.msdn.microsoft.com/Forums/en-US/vcgeneral/thread/d0b225c2-f5b0-4bb9-ac6a-4d4f61f7cb17/)

> VC 试图平衡执行速度和代码大小。您可以通过使用标志 /O1 或 /O2 来更改平衡，但即使优化速度 VC 也会尝试节省代码大小。

基本上，展开会增加代码大小，因此可能会在 Os 和 O1 模式下受到限制（[模式表](http://msdn.microsoft.com/en-us/library/k1ack8f1.aspx)）

PS： Pragma 看起来像预处理器指令，但它不是。它是编译器的指令，它被预处理器忽略（保留）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-03-13T18:47:53.527

对于英特尔编译器：

**#pragma loop count N**帮助编译器使用最佳策略来向量化循环。它节省了时间所以，我们可以说它有助于推动循环展开。例子：

```
#pragma loop_count min(n),max(n),avg(n) 
```

**#pragma unroll (n)**仅在与 -O3 标志一起使用时有效，您可以使用以下策略根据目标处理器展开循环。

除了循环展开生成的代码增加之外，它可能值得，因为编译器将为标量操作和向量操作生成循环版本。

在展开影响性能的情况下，例如：循环 20 次迭代，向量长度为​​ 16，导致 1 个循环一次执行 16 个操作，而余数循环依次执行 4 个操作。为了避免编译器生成的剩余循环，我们可以在循环之前使用：

```
#pragma vector novecremainder //or -mP2OPT_hpo_vec_peel = F to disable peel and remainder loops (compiler internal option) 
```

或者

```
#pragma nounroll //where unrolling is not worth at all 
```

只是为了澄清**#pragma ivdep**：

*   它提供了修改编译器启发式有关依赖项的具体提示，并且只有在我们知道假定的依赖项可以安全忽略时才必须使用。
*   最重要的是，它会覆盖潜在的依赖关系，但编译器仍会执行依赖关系分析，尝试 #pragma simd 进行矢量化，而不考虑任何分析。

希望这可以帮助。

# java - 嗅探访问过的站点并保存到文件

> ID：12830453
> 
> 赞同：1
> 
> 时间：2012-10-11T00:27:22.540
> 
> 标签：java, http, url, browser, sniffer

我想在连接到我的网络的某些 PC 中记录 http 流量，以便了解用户访问了哪些站点。该程序将在一家公司运行，可能是为了检查工人是否没有去网站做额外的工作，可能是为了统计数据。我只需要知道什么电脑在什么时间浏览了哪个网站，没有其他信息。

我在网上冲浪了几个小时，没有找到任何对我有用的东西。我试过wireshark，但是太复杂了，不能作为守护进程运行（我知道，也许我错了）而且那个窗口很大。

我尝试将 ServerSocket 绑定到 80 端口，但没有成功，似乎没有数据到达我的套接字。与 Socket 相同的结果（绑定到 80 localhost）是否有任何类允许我在 safari（或任何其他浏览器）和端口之间插入？

[在我被要求这样做之前，公司使用了几天的键盘嗅探器。但这种方式的隐私是零，显然这不是正确的解决方案。]

任何想法？Ps 该程序不会是“秘密”，工作人员知道它，但需要的是非管理员不能阻止它。

首选 java 解决方案，因为它是我知道的唯一语言。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-11T02:20:48.037

根据您的最后评论（顺便说一句，您应该更新您的问题）我知道您需要一些东西来记录所有 http 流量。

您必须了解，要轻松做到这一点，您需要位于专用网络和 Internet 之间，可能使用 linux 防火墙为专用网络计算机进行 NAT。

[如果您可以运行非 java 软件，那么您可以使用dsniff](http://monkey.org/~dugsong/dsniff/)的软件 urlsnarf 来满足您的需求。您可以运行它并将其保留在后台日志记录中，也可以按端口或 ip 过滤。

大多数发行版已经有一个名为 dsniff 的包，其中包含 urlsnarf 命令。

对于基本的开始：

```
urlsnarf -n -i eth0 
```

这将开始将 tcp 端口 80、8080 或 3128 上的所有 url 记录到标准输出。如果您想存储捕获以供以后可视化（例如使用 wireshark），您可以使用`-p`选项。

如果您问我，我认为您的做法是错误的，您应该放置一个透明代理并拒绝访问“未授权”网站，而不是记录每个请求的 http url。否则，您将侵犯人们的隐私，并且根据国家/地区的不同，这甚至可能是非法的。

为 NAT 设置服务器并不难，您只需要一台带有两个网卡的 linux PC，一个防火墙软件，如[aifw](http://rocky.eld.leidenuniv.nl/joomla/)或[ipmasq](http://www.bbassett.net/ipmasq/)，这样您就可以通过阻止其 IP 来阻止访问网站。如果你还想弄乱 http 流量包数据你需要一个透明代理（[不是反向代理](http://wiki.squid-cache.org/SquidFaq/ReverseProxy)），最流行的是[Squid](http://wiki.squid-cache.org/)。

如果您选择 Squid，我建议您查看[SquidGuard 。](http://www.squidguard.org/)

如果您坚持自己编写代码，除了注释上的警告，毫无疑问您应该使用[jpcap 库](http://netresearch.ics.uci.edu/kfujii/Jpcap/doc/)，请查看[示例部分](http://netresearch.ics.uci.edu/kfujii/Jpcap/doc/samples.html)，其中已经有您可以用来快速开始的代码。

祝你好运！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2020-05-13T04:27:25.470

这个线程已经快 9 年了，但如果有人仍在寻找这个问题的答案......

看看这个 [https://superuser.com/questions/52181/how-to-track-websites-that-have-been-visited](https://superuser.com/questions/52181/how-to-track-websites-that-have-been-visited)

通过检索访问文件列表创建命令并将其保存为 .txt，将其保存到您的数据库中，瞧。您已经实现了对每台 pc 站点的跟踪。

请使用 java 检查此代码以下载/查看和清除（删除缓存）访问的站点列表：

> ```
> > import java.io.IOException;
> > 
> > public class DNS_Actions {
> >     public void RetrieveDNS(){
> >         try {
> >             Process p = Runtime
> >                             .getRuntime()
> >                             .exec("cmd /min start cmd.exe /K \" cd "+System.getProperty("user.dir")+" && ipconfig /displaydns >
> > lists.txt\"");
> >         } catch (IOException e) {
> >             // TODO Auto-generated catch block
> >             e.printStackTrace();
> >         } 
> >     }
> >     public void purgeDNS(){
> >         try {
> >             Process p = Runtime
> >                             .getRuntime()
> >                             .exec("cmd /min start cmd.exe /K \" ipconfig /flushdns\"");
> >         } catch (IOException e) {
> >             // TODO Auto-generated catch block
> >             e.printStackTrace();
> >         } 
> >     }
> >     public static void main(String[] args){
> >         new DNS_Actions().RetrieveDNS();
> >     } } 
> ```

# mysql - VB.NET Mysql，我应该使用 MySQL 连接器吗？

> ID：12830455
> 
> 赞同：0
> 
> 时间：2012-10-11T00:27:24.190
> 
> 标签：mysql, vb.net, connector

我正在制作一个连接到 MySQL 数据库的程序，我想知道使用 MySQL 连接器是否安全，我将向公众发布它，但我不希望数据库信息泄露，所以我将混淆代码。

安全吗？

谢谢，-亚当

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-11T00:29:08.233

不; 那根本**不安全**。

如果您将数据库凭据公开，无论您对它们做什么，都会受到攻击。

相反，您可以：

*   不释放数据库凭据。
*   释放没有写入权限的用户的凭据
*   使用访问控制的 Web 服务，而不是直接访问 MySQL

# java - 将 jqplot 图表导出为 PDF

> ID：12830460
> 
> 赞同：1
> 
> 时间：2012-10-11T00:27:55.187
> 
> 标签：java, javascript, jqplot

我有一个疑问，我无法解决。

我想从 jqplot 插件下创建的一些图表的结果生成一个 PDF 文档。

我知道我可以将它们导出为 PNG：

```
 var imgelem = evt.data.chart.jqplotToImageElem(); 
```

（这个 imgelem 是来自 javascript 的 HTMLImageElement 对象）

但我不知道如何从 javascript 编码此图像（未保存在任何地方）以作为参数（或其他）获取 JAVA。

我正在使用 struts，我想创建一个 servlet（动作）来响应这个 PDF 文档。

提前致谢。问候。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-30T12:22:44.167

```
var imgelem = evt.data.chart.jqplotToImageElem();
var imageSrc = imgelem.src; // this stores the base64 image url in imagesrc
open(imageSrc); // this will open the image in another tab 
```

现在您可以将其发送到服务器或将其放入 html 图像元素中。您只需要设置“src = imageSrc”。

# c# - 开发 BigInt 类

> ID：12830462
> 
> 赞同：1
> 
> 时间：2012-10-11T00:28:02.113
> 
> 标签：c#, stack, bigint

我已经开始开发一个 BigInt 类，我现在被困住了。问题是当我尝试将两个不同长度的数字相加时，结果不正确。例如，123 + 1 将返回 223。我知道问题出在哪里，但我需要帮助解决它。

```
 public static BigInt operator +(BigInt n1, BigInt n2)
    {
        Stack<char> sNew = new Stack<char>();
        Stack<char> sTemp = new Stack<char>();
        int currentDigit1, currentDigit2, sum;
        int carry = 0;

        //insert the digits, XXXyyy + ZZZ = first insert ___yyy and then calculate XXX+ZZZ
        if (n1.GetLength() > n2.GetLength())
        {
            while (n1.GetLength() > n2.GetLength())
                sNew.Push(n1.sDigits.Pop());
        }
        else if (n2.GetLength() > n1.GetLength())
        {
            while (n2.GetLength() > n1.GetLength())
                sNew.Push(n2.sDigits.Pop());
        }

        while (n1.sDigits.Count > 0)
        {
            currentDigit1 = int.Parse(n1.sDigits.Pop().ToString());
            currentDigit2 = int.Parse(n2.sDigits.Pop().ToString());
            sum = currentDigit1 + currentDigit2 + carry;
            carry = 0;

            if (sum > 10)
            {
                carry = 1;
                sum = sum % 10;
            }

            sNew.Push(char.Parse(sum.ToString()));

        }

        //if there is a carry, for example 95+18
        if (carry > 0)
            sNew.Push(char.Parse(carry.ToString()));

        //flip the stack
        while (sNew.Count > 0)
            sTemp.Push(sNew.Pop());
        while (sTemp.Count > 0)
            sNew.Push(sTemp.Pop());

        return new BigInt(sNew);
    } 
```

不管这个问题，这种类设计模式有效吗？设计这种类有更好的主意吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-11T00:39:46.157

这是一个相当浪费的表示，一个十进制数字使用完整的八位 - 大约浪费了 60% 的空间！

即使您继续使用这种表示，您也应该考虑将内部表示从 a 切换`Stack<char>`到 a `List<char>`，最低有效位存储在 position `0`，十位的数字存储在 position `1`，依此类推。这将允许您使用单个循环实现加法，如果两个数字都可用，则在同一位置添加数字，或者将进位添加到较长数字的数字。

更好的表示方法是使用 base-256 系统，并将单个“数字”存储为字节数组。

请注意，加法并不是最难实现的操作：等到您遇到乘法和除法！要了解您需要解决的复杂性，请下载[Java 的`BigInteger`](http://developer.classpath.org/doc/java/math/BigInteger-source.html).

我假设您这样做是为了好玩，而不是作为真实项目的一部分。否则，没有理由不使用 .NET 的内置表示`BigInteger`。

# html - 如何获得完全像 IE 呈现的 html 字符串？

> ID：12830464
> 
> 赞同：0
> 
> 时间：2012-10-11T00:28:16.063
> 
> 标签：html, internet-explorer, mshtml

我在获取与 IE10 呈现的完全相同的 HTML 字符串时遇到了一些问题。由 IE 10 呈现的那个和我用 WebClient.DownloadString(url) 检索的那个有一些细微的差别。（见[这个问题](https://stackoverflow.com/questions/12824081/difference-between-ie-10-rendered-html-and-its-output-html)）

如何获得**完全相同**的HTML 字符串？我需要模拟浏览器的行为吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-11T00:41:16.557

尝试将 IE10 的用户代理标头添加到您的请求中：

```
WebClient client = new WebClient ();
client.Headers.Add ("user-agent", "Mozilla/5.0 (compatible; MSIE 10.0; Windows NT 6.2; Trident/6.0)"); 
```

根据您的场景（移动设备、x64 等），标头可能具有不同的值。有关其他示例，请参阅[IE10 用户代理字符串更新](http://blogs.msdn.com/b/ie/archive/2012/07/12/ie10-user-agent-string-update.aspx)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-24T09:44:12.473

这个问题与这个问题重复：[How to get the page source from an IE window?](https://stackoverflow.com/questions/12842277/how-to-get-the-page-source-from-an-ie-window)

我已经在那里解决了。

# .htaccess - 具有多个查询字符串的 url 的 RewriteRule 301 重定向

> ID：12830465
> 
> 赞同：1
> 
> 时间：2012-10-11T00:28:29.977
> 
> 标签：.htaccess, mod-rewrite

我有这样的网址：

```
siteurl.com/category.php?id=6&name=internet 
```

我想做一个 301 重定向到

```
siteurl.com/category/6/internet/ 
```

我试过没有成功：

```
RewriteRule ^category.php?id=([^&]*)&name=([^&]*) /category/$1/$2/ [R=301,L] 
```

有关它的更多信息：[谷歌上的重复内容。htaccess 还是 robots.txt？](https://stackoverflow.com/questions/12827183/duplicated-content-on-google-htaccess-or-robots-txt)

有什么帮助吗？

* * *

**额外编辑；**该页面也可以通过`siteurl.com/category.php?id=6`（没有名称查询）访问。处理这个问题的最佳方法是什么？将这种 URL 重定向到主页？如果是这样，我该怎么做？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-11T00:31:18.240

查询字符串不会出现在`RewriteRule`表达式中。相反，您必须在`RewriteCond`, via中匹配它`%{QUERY_STRING}`。

```
RewriteEngine On
# Capture the id and name into %1 and %2 from the query string
RewriteCond %{QUERY_STRING} ^id=(\d+)&name=([a-zA-Z-]+)
# If the query string does not include noredirect=
# This protects against a rewrite loop when attempting to 301 redirect the ugly URL
RewriteCond %{QUERY_STRING} !noredirect=
# Rewrite category.php to /category/id/name
RewriteRule ^category\.php /category/%1/%2/? [L,R=301] 
```

有`?` 必要避免在 URL 末尾重复查询。

```
# I assume you also have the following rule, which configures the pretty URL in the first place
# Then in the rule which points the pretty URL to the real internal one, add
# the fake query string param noredirect=1, which won't actually be used by PHP. It just 
# matches in the rules above to prevent rewriting when present
RewriteRule ^category/(\d+)/([^/]+) category.php?id=$1&name=$2&noredirect=1 [L] 
```

# node.js - Node.js 中有没有办法将数据库结果异步推送到客户端？

> ID：12830470
> 
> 赞同：2
> 
> 时间：2012-10-11T00:28:45.000
> 
> 标签：node.js, knockout.js, comet, faye

假设您正在使用 Node.js 在数据库（本例中为 sqlite）上运行一系列查询。您知道这些查询可能需要一段时间来处理，并且您希望客户端在结果进来时进行更新。也就是说，您希望将结果异步推送到客户端，然后更新 DOM。

[我认为我可以使用Faye](http://faye.jcoglan.com/)（或其他一些彗星系统）、[JavaScript 模板](http://embeddedjs.com/)和 Knockout.js拼凑出一种方法。但是是否已经有一个框架或工具来做这种事情？

或者这只是错误的方法？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-11T00:36:35.177

在以前的项目中，我使用[了 Socket.IO](http://socket.io/)，它可以轻松地将更改推送到客户端。一个例子是这样的：

服务器代码：

```
socket.emit('ranQuery', { info: 'Info From Server!' }); 
```

客户代码：

```
socket.on('ranQuery', function(data) {
    console.log(data.info); // would output "Info From Server!"
    // update the DOM with the new information
} 
```

他们的网站上有很多工作示例。它可以像任何其他节点包一样安装，`npm install socket.io`.

* * *

**更新：**

打开并阅读您发布的链接后，我会说您的方法是正确的。虽然我从未听说过 Faye，但它似乎做与 Socket.IO 类似的事情（将对象从服务器发送到客户端），并且 KnockoutJS 将处理数据绑定（当您更新模型时，它也会在页面上更新）。如果您遇到任何障碍，我会说去吧并在这里发布问题。

我提出 Socket.IO 的唯一原因是它的易用性和文档。我最近开始了一个使用 AngularJS + Socket.IO 的项目。如果您要根据服务器的频繁更新在客户端进行大量更改，您可能还想看看[AngularJS](http://angularjs.org/)并在他们的网站上弄乱示例。

如果您认为这对您有用，请访问此博客文章 ( [http://briantford.com/blog/angular-socket-io.html](http://briantford.com/blog/angular-socket-io.html) )，以获取有关让 AngularJS 与 Socket.IO 良好工作的非常好的指南

# django - 命名 URL 模式引发 NoReverseMatch 异常

> ID：12830476
> 
> 赞同：2
> 
> 时间：2012-10-11T00:29:16.420
> 
> 标签：django, django-templates

我正在 Django 1.4 中实现规范的书籍/作者/出版商示例。在显示所有书籍列表的视图中，我已将 url 模板标记插入到引用命名 URL 模式的锚标记中：

```
{% for book in book_list %}
    {# <a href="/book/{{ book.id }}/">{{ book.title }}</a> #}
    <a href="{% url 'book-details' book.id %}">{{ book.title }}</a>
{% endfor %} 
```

（请注意，我已经注释掉了*确实*有效的硬编码 URL 锚。）

我的 urlpatterns 是：

```
url(r'^book/$', 'app.views.show_all_books', name="all-books"),
url(r'^book/(\d+)/$', 'app.views.show_book_details', name="book-details"), 
```

当我单击锚点查看一本书的详细信息时，我收到此错误：

```
NoReverseMatch at /book/
Reverse for "book-details" with arguments '(1,)' and keyword arguments '{}' not found. 
```

我在这里阅读了其他关于其他出现此错误的帖子以及 url 模板标签和命名 URL 模式上的 Django 文档，但我看不出我做错了什么。如果有帮助，这里是“show_book_details”函数的签名：

```
def show_book_details(request, id): 
```

我想我不完全理解错误消息告诉我的内容。我已经尝试删除 urlpattern 名称周围的单引号，并且我还尝试使用视图路径 'app.views.show_book_details' 而不是命名的 urlpattern，但是这两种更改都没有解决问题。有人可以帮忙吗？

非常感谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-11T02:05:02.983

从模板中的 url 标记中删除引号：

```
{% url book-details book.id %} 
```

[https://docs.djangoproject.com/en/1.4/ref/templates/builtins/?from=olddocs#url](https://docs.djangoproject.com/en/1.4/ref/templates/builtins/?from=olddocs#url)

# .htaccess - htaccess 301 重定向附加 URL 的最后一部分

> ID：12830480
> 
> 赞同：0
> 
> 时间：2012-10-11T00:30:29.257
> 
> 标签：.htaccess, mod-rewrite, redirect

如何在保留 url 的最后一段的同时使用 htaccess 重定向到另一个 url。

前任：

**[从http://xyz.mysite.com/signup/202](http://xyz.mysite.com/signup/202)**重定向**（202 是动态的，可以更改）**

 ****到** [http://mysite.com/somewhere/202](http://mysite.com/somewhere/202)

我搜索了分配，但找不到与此相关的任何内容。任何指导或帮助将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-11T00:41:10.493

在**xyz.mysite.com**的文档根目录中的 htaccess 文件中，使用 mod_alias：

```
Redirect 301 /signup http://mysite.com/somewhere 
```

使用 mod_rewrite：

```
RewriteEngine On
RewriteRule ^/?signup/(.*)$ http://mysite.com/somewhere/$1 [L,R=301] 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-11T00:43:15.080

它在 Apache HTTPD mod_rewrite 文档中明确记录。甚至还有一个您正在尝试的示例。

[http://httpd.apache.org/docs/2.2/mod/mod_rewrite.html](http://httpd.apache.org/docs/2.2/mod/mod_rewrite.html)**

# jquery - jquery mobile可折叠集中的数据图标位置移出视图？

> ID：12830481
> 
> 赞同：0
> 
> 时间：2012-10-11T00:30:34.193
> 
> 标签：jquery, jquery-mobile

我通过 data-collapsed-icon="arrow-r" data-expanded-icon="arrow-l" 将可折叠集的数据图标设置为箭头，但有点不合理。

对于初学者来说，当在 iphone 上查看而不是折叠显示右箭头时，它会显示一个几乎不可见的左箭头，因为它向右移动；在 iphone 上展开时，它是一个放置良好的向上箭头。？？？

它在 Chrome 中显示良好。[https://www.ubat.com/mobile/test.html](https://www.ubat.com/mobile/test.html)

```
<!DOCTYPE html>
<html>
<head>
<title>My Page</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<link href="css/jquery.mobile-1.0a3.min.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="/js/jquery-1.7.2.min.js"></script>

<script src="jquery.mobile-1.2.0.min.js" type="text/javascript"></script>

<script type="text/javascript" src="//use.typekit.net/kxv5fxv.js"></script>
<script type="text/javascript">try{Typekit.load();}catch(e){}</script>
</head>
<body>
<div data-role="page">
  <div data-role="header">
    <h1>My Title</h1>
  </div>
  <!-- /header -->

  <div data-role="content">
    <p>Hello world</p>

    <div data-role="collapsible-set" data-iconpos="right" data-collapsed-icon="arrow-r" data-expanded-icon="arrow-l">
      <div data-role="collapsible" data-collapsed="true" >
        <h3>Section 1</h3>
        <p>I'm the collapsible set content for section 1.</p>
      </div>
      <div data-role="collapsible" data-collapsed="true">
        <h3>Section 2</h3>
        <p>I'm the collapsible set content for section 2.</p>
      </div>
    </div>

  </div>
  <!-- /content --> 

</div>
<!-- /page -->

</body>
</html> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-11T06:56:51.613

您不应该混合使用新旧版本的 jQuery Mobile 文件。

使用版本 1.2.0 试试这个工作示例：

```
<!DOCTYPE html>
<html>
<head>
<title>My page</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="apple-mobile-web-app-capable" content="yes" />
<link rel="stylesheet"
    href="http://code.jquery.com/mobile/1.2.0/jquery.mobile-1.2.0.min.css" />
<script src="http://code.jquery.com/jquery-1.8.2.min.js"></script>
<script
    src="http://code.jquery.com/mobile/1.2.0/jquery.mobile-1.2.0.min.js"></script>
</head>

<body>
<div data-role="page">
  <div data-role="header">
    <h1>My Title</h1>
  </div>
  <!-- /header -->

  <div data-role="content">
    <p>Hello world</p>

    <div data-role="collapsible-set" data-iconpos="right" data-collapsed-icon="arrow-r" data-expanded-icon="arrow-l">
      <div data-role="collapsible" data-collapsed="true" >
        <h3>Section 1</h3>
        <p>I'm the collapsible set content for section 1.</p>
      </div>
      <div data-role="collapsible" data-collapsed="true">
        <h3>Section 2</h3>
        <p>I'm the collapsible set content for section 2.</p>
      </div>
    </div>

  </div>
  <!-- /content --> 

</div>
<!-- /page -->

</body>
</html> 
```

* * *

**在 iPhone 5 上：**

![1](../Images/c184c93569636ef37337e1de7f5d7ee4.png)

**在火狐上：**

![2](../Images/a1173c66f174b259916189b63fd31e24.png)

不应该有任何数据图标放置问题。

# c# - Bing Maps GPXRouteViewerSample 无法运行 - 附加了调试器是意外的吗？

> ID：12830485
> 
> 赞同：0
> 
> 时间：2012-10-11T00:31:23.140
> 
> 标签：c#, windows-8, microsoft-metro, bing-maps

当我尝试运行 GPXRouteViewerSample 时，它​​在 App.gics 中的这一行停止：

```
if (Debugger.IsAttached) Debugger.Break(); 
```

...我收到错误消息：

*错误 1 ​​找不到指定的过程。（HRESULT 异常：0x8007007F）C:\Users\Clay\Documents\Visual Studio 2012\Samples\bingMapsCSharpGPXRouteViewerSample\GPXRouteViewerSample\MainPage.xaml 12 9 GPXRouteViewerSample*

我不明白为什么如果附加了调试器，他们会希望它中断 - IOW，你不能从 Visual Studio 运行它，或者..???

## 更多信息

当我打开示例应用程序时，WPF/XAML 设计图面显示“无法创建“地图”的实例，但是当我在适当的位置 (Credentials="") 输入我的 Bing 地图密钥时，它会显示。

但是，在运行时，当“调试中断”行发生错误时，表面/画布显示相同的错误。它是否在设计时接受凭据但在运行时不接受？

以下是异常的详细信息（这实际上来自不同的样本（Landmark Events），但我确信这是同一个问题，因为它正在同一个地方死去）：

*调用的目标已引发异常。堆栈跟踪：在 System.RuntimeMethodHandle.InvokeMethod(Object target, Object[] arguments, Signature sig, Boolean constructor) at System.Reflection.RuntimeConstructorInfo.Invoke(BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfoculture) COMException: The找不到指定的程序。（来自 HRESULT 的异常：0x8007007F）*

# inheritance - 在 Mongoid 中，如何在基本控制器中排除继承的模型对象？

> ID：12830490
> 
> 赞同：0
> 
> 时间：2012-10-11T00:31:31.877
> 
> 标签：inheritance, mongoid

我使用 Mongoid 和 Rails 3，并且我有以下单表继承：

```
class Post
  include Mongoid::Document
  field :title, type: String
  field :content, type: String
end 
```

从 Post 继承了一个模型“文章”：

```
class Article < Post
  field :source, type: String
end 
```

我是尝试 STI 的新手。我了解到“一个控制器”对于基本模型和继承模型来说是一个很好的设计。所以我有这样的 PostsController

```
class PostsController < ApplicationController
  def index
    @type = param[:type]  # type is passed from the route.rb
    @posts = Post.where(_type: @type)

    ... 
```

因此，如果@type 被指定为“文章”，@posts 将只包含“文章”类型的帖子。这在文章视图中效果很好：只会显示文章，而不会显示其他类型的帖子。

但是，在帖子视图中，它将同时显示帖子和文章。

我不希望文章显示在我的帖子视图中——实际上，我只希望来自基本模型的帖子显示在视图中。有没有办法从基本控制器的继承模型中排除项目？

换句话说，我怎样才能只从基本模型中找到项目？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-11T17:16:18.587

我刚刚发现我可以在控制器中使用以下内容：

```
@post = Post.where(_type: "Post") 
```

这是正确的方法吗？

# java - 我的代码有什么问题。

> ID：12830501
> 
> 赞同：-4
> 
> 时间：2012-10-11T00:34:23.750
> 
> 标签：java

我有这个代码用于返回低于 60 的分数百分比。但它不会产生所需的百分比。有人帮我找出问题所在。

```
public float getPercentFailing(float[] grades) {

    float sum= 0;

    for (int i = 0; i < .6; i++) {
        sum = sum + grades[i];
        return sum/100;
    }
    return 0;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-11T00:37:56.347

尝试这样的事情。您需要首先将所有成绩相加，这就是您在 for 循环中所做的事情。现在因为我们只想要超过 60 的成绩，所以我们使用一个`if`语句来检查该值是否高于 60。如果是，将其添加到总和中并计算一个以`int count`跟踪到目前为止我们已经添加了多少成绩。

```
for (int i = 0; i < grades.length; i++) {      //loop through all the grades
   if(grade[i] < 60) {                         //if the grade is over 60
       sum = sum + grades[i];                  //add the grade to the sum
       count++                                 //remember how many grades so we can get average
   }
} 
```

然后将成绩的总和除以成绩的总数，或者`grades.length`和`return`它。

```
return sum/count ;                             //calculate average 
```

现在一切都在一起：

```
public float getPercentFailing(float[] grades) {
    int count=0;
    float sum= 0;
    for (int i = 0; i < grades.length; i++) {
          if(grade[i] < 60) {
             sum = sum + grades[i];
             count++
          }
    }
    return sum/count;

} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-11T00:40:43.253

你的逻辑是错误的。您想检查所有成绩并对照 0.6 检查每个成绩（不是循环索引）。你不想平均成绩，你想计算有多少低于阈值。像这样的东西应该工作：

```
public float getPercentFailing(float[] grades) {

    int failed = 0;

    for (int i = 0; i < grades.length; i++) {
        if (grades[i] < 0.6) {
            failed++;
        }
    }
    return ((float) failed) / grades.length;
} 
```

如果您需要它作为百分比而不是分数，请将最后一行更改为：

```
 return 100.0f * failed / grades.length; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-11T00:36:57.913

您的循环只工作一次， for `i=0`，因为从to`i`递增为整数。`0``1`

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-11T00:39:21.133

您想遍历所有成绩并计算低于 60% 的成绩：

```
int count = 0;
for (int i=0; i!=grades.length; ++i) {
    if (grades[i] < 0.6) {
        count++;
    }
}

return ((float) count)/grades.length 
```

然后您通过将其除以总数来计算百分比

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2012-10-11T00:45:10.227

变量“i”是一个整数，被用作一个计数器来遍历数组“grades”。使用计数器“i”索引到数组中以获取等级的值，然后使用 if 语句检查它是否是小于 60% 的等级。然后，如果它小于 60%，则将其添加到您的总百分比中并以百分比形式返回该值。

扩展/编辑功能代码：

```
public float getPercentFailing(float[] grades) {
    int count=0;
    float sum= 0;
    for (int i = 0; i < grades.length; i++) {
        float grade = grades[i];
        if( grade < 0.6 )
            sum = sum + grades[i];
        count++;
    }
    return sum/count;
} 
```

# go - 使用 Go 语言简单 HTTP 服务器打印到日志

> ID：12830504
> 
> 赞同：7
> 
> 时间：2012-10-11T00:34:50.490
> 
> 标签：go

我正在尝试记录请求者的 IP 地址、他们使用的 METHOD 以及他们请求的文件。但由于某种原因，它只在终端上输出，并没有将其保存到 logfile.txt...

```
package main

import (
  "fmt"
  "net/http"
  "log"
  "encoding/json"
  "io/ioutil"
)

type Options struct {
  Path string
  Port string
}

func Log(handler http.Handler) http.Handler {
  return http.HandlerFunc(func(w http.ResponseWriter, r *http.Request) {
    fmt.Printf("%s %s %s\n", r.RemoteAddr, r.Method, r.URL)
    handler.ServeHTTP(w, r)
  })
}

func main() {

  op := &Options{Path: "./", Port: "8001"}

  data, _ := ioutil.ReadFile("./config.json")

  json.Unmarshal(data, op)

  http.Handle("/", http.FileServer(http.Dir(op.Path)))
  err := http.ListenAndServe(":" + op.Port, Log(http.DefaultServeMux))
  if err != nil {
    log.Fatal("ListenAndServe: ", err)
  }
} 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-10-11T01:12:44.370

在您的`Log`功能中，您使用的是[`fmt.Printf`](http://golang.org/pkg/fmt/#Printf)not [`fmt.Fprintf`](http://golang.org/pkg/fmt/#Fprintf)。

例如，

```
package main

import (
    "fmt"
    "log"
    "net/http"
    "os"
)

var logFile *os.File

func Log(handler http.Handler) http.Handler {
    return http.HandlerFunc(func(w http.ResponseWriter, r *http.Request) {
        fmt.Fprintf(logFile, "%s %s %s\n", r.RemoteAddr, r.Method, r.URL)
        handler.ServeHTTP(w, r)
    })
}

func main() {
    var err error
    logFile, err = os.Create("logfile.txt")
    if err != nil {
        log.Fatal("Log file create:", err)
        return
    }
    defer logFile.Close()
} 
```

# android - 带有套接字编程的 Android 多人游戏

> ID：12830505
> 
> 赞同：2
> 
> 时间：2012-10-11T00:34:59.340
> 
> 标签：android, communication, multiplayer

我一直在寻找是否可以通过 WiFi 在 android 平台上使用套接字编程开发多人游戏，但我无法找到某个答案。

我发现，android sdk 中有 ServerSocket 和 Socket 类。

我可以使用它们通过 WiFi 在 2 个设备之间建立通信吗？

另外，如果我可以以某种方式连接 2 个设备，我应该如何将它与我的游戏架构结合起来？

任何建议将不胜感激。这是我第一次尝试 Android 和 Socket 编程。我听说过 Skiller、WiFi Direct 和其他一些东西，但必须使用 Sockets 来完成。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-07T18:15:01.687

我实际上来自斯基勒，我将尝试至少解决您的一些观点：

*   为什么你的游戏需要插座？如果你能解释你到底想要达到什么目标，这将有很大帮助。也许还有其他不太复杂的方法可以实现相同的目标。将通信解决方案与您的游戏逻辑集成直接依赖于此。

*   直接连接两个设备，无论是使用 wifi 还是 3G 连接，都是一项非常复杂的任务。为此，您需要知道设备的 IP，它从困难（wifi - 取决于您连接的 wifi）到几乎不可能（3g - 您看不到运营商代理后面的设备的 IP）除非您实施几种不同的技术或使用中间服务器来完成这项工作。由于硬件资源和最重要的时间资源，这些解决方案当然会花费您。根据我在该领域的经验，如果它符合您的需求，我强烈建议使用现有的解决方案（我真的很想保持客观；））

希望它有助于进一步调查您对游戏的需求。如果您想查看 Skiller SDK，我们非常欢迎您访问我们的 wiki：[http](http://wiki.skiller-games.com/) ://wiki.skiller-games.com/或发送电子邮件至 developers@skiller-games.com

迈克尔

# python - Django提交多对一关系模型

> ID：12830509
> 
> 赞同：0
> 
> 时间：2012-10-11T00:35:10.800
> 
> 标签：python, django

我正在尝试开发一个与每次锻炼相关的 Django 应用程序。

我目前有两个表，一个存储锻炼（每次锻炼多个锻炼）信息，另一个存储锻炼信息，**锻炼**是两者之间的**外键。**

但是，我很难理解在一个表单中提交多个练习的概念，而不会很快变得相当丑陋。

请记住，我是 Django 菜鸟，因此请随时指出您看到的任何多余或无用的代码

模型.py

```
class workout(models.Model):
    user = models.ForeignKey(User , db_column='userid')

    datesubmitted = models.DateField() 
    workoutdate = models.DateField(); 
    bodyweight = models.FloatField(null=True);
    totalreps = models.IntegerField() 
    totalweight = models.FloatField()
    numsets = models.IntegerField(); 
    numexercises = models.IntegerField()
    workoutname = models.CharField(max_length=250) 

    def getallexercises (self,id):
        all_workout_exercises = exercise.objects.filter(workoutid = id)
        return all_workout_exercises
    def get_absolute_url(self):
        return "/home"

class workoutForm(ModelForm): 

    class Meta:

        model = workout
        exclude = ('user','bodyweight','totalreps','totalweight','datesubmitted')

class exercise(models.Model):
    workout = models.ForeignKey(workout,db_column='workoutid')  
    userid = models.IntegerField();

    exercisename = models.CharField(max_length = 100)
    repetitions = models.IntegerField()
    weight = models.FloatField() 

    def get_absolute_url(self):
        return "/home"

class exerciseForm(ModelForm):
    class Meta: 
        model = exercise 
```

视图.py

```
class workoutCreate(CreateView):
    form_class = workoutForm
    model = workout 

    def form_valid(self,form):
        createxercise(self.request,self.model.pk)
        form.instance.user = self.request.user; 
        form.instance.bodyweight = self.request.POST['weight']
        form.instance.datesubmitted = datetime.datetime.now()
        form.instance.totalweight = summation(list(self.request.POST['weightinputboxes']))
        form.instance.totalreps = summation(list(self.request.POST['repinputboxes']))
        return super(workoutCreate, self).form_valid(form) 
```

我应该在哪里尝试提交练习？我已经阅读了有关**inlineformset_factory 的信息**，但我不确定是否可以通过这项工作在我的表中创建多个练习行......

感谢各位大侠的帮助，不胜感激！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-11T04:04:16.977

[Modelformset](https://docs.djangoproject.com/en/dev/topics/forms/modelforms/#model-formsets)是您所需要的。查看文档，其中有很好的示例来解释它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-11T04:19:10.797

您没有提出具体问题，但这里有几件事可以清理您的代码：

1.  按照惯例，Python 中的类名使用 CapWords（每个单词的首字母大写）。[PEP8](http://www.python.org/dev/peps/pep-0008/)提供了 Python 的风格指南。
2.  您不需要该`getallexercises`方法，django 提供了进行[关系查找](https://docs.djangoproject.com/en/dev/topics/db/queries/#following-relationships-backward)的方法。对于您的情况，如果`w`是锻炼实例，您可以这样做`w.exercise_set.all()`
3.  您还应该避免硬编码 url `get_absolute_url`，考虑使用[`reverse`](https://docs.djangoproject.com/en/dev/topics/http/urls/#django.core.urlresolvers.reverse)与[命名您的 url 模式](https://docs.djangoproject.com/en/dev/topics/http/urls/#naming-url-patterns)一起使用。

最后，您在正确的轨道上使用`inlineformset_factory`.

# python - SQLAlchemy 字母排序查询

> ID：12830512
> 
> 赞同：8
> 
> 时间：2012-10-11T00:35:41.680
> 
> 标签：python, sqlalchemy

有没有办法在实际查询中按字母顺序对 SQLAlchemy 查询返回的行进行排序，或者按字母顺序排序的唯一方法是对查询返回的行列表进行排序。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-10-11T00:39:02.287

您可以添加一个`order_by`子句：

```
query = query.order_by(MyTable.column_name) 
```

# spring - Spring UserService ClassNotFound 使用 @ViewScoped 但与 @SessionScoped 一起使用

> ID：12830514
> 
> 赞同：0
> 
> 时间：2012-10-11T00:36:04.270
> 
> 标签：spring, jsf, jsf-2

我有一个 UserService 在使用 ViewScoped 时因 ClassNotFound 而失败，但与 SessionScoped 一起使用，我希望有人能告诉我原因。我的应用程序将 JSF2 与 Spring 混合在一起。

我得到的错误是：

```
java.lang.ClassNotFoundException: com.dave.user.service.IUserService 
```

托管 bean 是

```
@ManagedBean(name="ClientMB")
@ViewScoped
public class ClientMB implements Serializable{

@ManagedProperty(value="#{UserService}")
IUserService  userService;

public IUserService getUserService() {
    return userService;
}

public void setUserService(IUserService userService) {
    this.userService = userService;
} 
```

UserService 定义为

```
public class UserService implements Serializable, IUserService  {

// UserDAO is injected...
IUserDAO userDAO;

} 
```

IUserService 只是一个接口：

```
public interface IUserService { 
```

ApplicationContext 中的声明是

```
<bean id="UserService" class="com.dave.user.service.UserService">
    <property name="userDAO" ref="UserDAO" />
</bean> 
```

正如我所说，使用 SessionScoped 可以正常工作，但是当我将托管 bean 更改为 ViewScoped 时会失败。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-12T19:49:02.547

Problem came from changing the state saving from server to client. Once I returned the state saving to server viewscope worked fine. Not quite sure why that happened but embarassing none the less.

# php - 如何从 PHP 脚本运行 linux 命令

> ID：12830520
> 
> 赞同：11
> 
> 时间：2012-10-11T00:36:51.603
> 
> 标签：php, linux, debian

> **可能重复：**
> [php shell_exec() vs exec()](https://stackoverflow.com/questions/7093860/php-shell-exec-vs-exec)

如何从 PHP 脚本运行 linux 命令？我正在运行 Linux Debian 和 PHP5。我希望能够向`wget`控制台发出命令。

我正在寻找的一个例子是这样的：

```
phpFunction ("wget http://www.example.com/image.jpg /folder");
echo "done"; 
```

我也可以回显该函数的输出吗？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-10-11T00:38:00.823

用于[`exec`](http://php.net/manual/en/function.exec.php)运行任何命令。但请注意不要执行任何用户输入，因为它会严重损害您的服务器。

另外，请注意，大多数共享服务器会阻止该`exec`功能，因此您将无法使用它。

最后，作为简写，您可以将要执行的命令包装在[backticks](http://php.net/manual/en/language.operators.execution.php)中。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-10-11T00:38:08.263

你可以用下面的代码做你想做的事：

```
system(command); 
```

见[http://php.net/system](http://php.net/system)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-10-11T00:40:33.317

您可以在 php 脚本中执行 linux 命令 - 您所要做的就是将命令行放在括号 (`) 中。

并且还专注于`exec()`，这个和`shell_exec()`..

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-10-11T00:38:23.583

您可以使用

```
exec
shell_exec 
```

[http://php.net/manual/en/function.shell-exec.php](http://php.net/manual/en/function.shell-exec.php)

# javascript - 如何在 Mongo J/S 中将 UTC 时间转换为任意本地时间

> ID：12830521
> 
> 赞同：5
> 
> 时间：2012-10-11T00:36:53.967
> 
> 标签：javascript, mongodb, timezone

我正在 Mongo db 中运行 map reduce 作业。

映射功能应该将某种性质的事件映射（例如计数）到某个时区的天数（映射的关键是日历日）。时区可以不同，实际上是 map/reduce 作业的输入参数。

存储在数据库对象中的时间采用 UTC。

例子：

```
object1: time=78000
object2: time=86420

mapReduce(objects, tz='America/Los_Angeles')
would return: [{"1/1/1970" : 2}] 
```

和

```
mapReduce(objects, tz='Europe/London')
would return: [{"1/1/1970":1},{"1/2/1970":1}] 
```

在同一个数据集上。

JavaScript Date 对象可以完美地将任何 UTC 时间转换为本地时间，但它似乎仅限于 J/S 环境的“当前”时区。我似乎找不到一种方法来指定我希望转换所在的时区。

转换应考虑 DST，最好考虑闰秒。

我能做些什么来实现这一目标吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-12T19:58:45.813

I found the answer that will work for me. The scope, after all, was limited to having this support in server-side mongo DB, and only on Linux.

@AsyaKamsky pointed to a greate J/S library, [timezone-js](https://github.com/mde/timezone-js), that does full and proper time zone support, considering that it uses actual time zone files from IANA. However, loading arbitrary java-script libraries into Mongo server environment is not that easy. You can only load global function definitions. [timezone-js](https://github.com/mde/timezone-js) also needs to be provided with a custom transport mechanism to download the timezone files (I don't even know if MongoDB server environment provides files access), or the time zone files have to be precompiled into JSON objects, and served along with the library. I decided that this would be too tedious of an approach, and I will have to be responsible of providing mechanism to update time zone files when they are changed.

The other alternative I was looking into - is hacking the J/S implementation used in Mongo to add a function that will do the job I want it to do. That is what I have done. Things are actually as dismal in the world of glibc as they are in JavaScript, but there is a library for the job, [icu](http://www.icu-project.org).

I've made this [patch](http://manticore.2y.net/cgi-bin/dlwct.sh?f=mongo-jstz.patch.gz&ct=application/gzip), that adds a static Date.daytz() function, which, taken a UTC timestamp, and a time zone name, will return a yyyy-mm-dd string.

Considering the following map/reduce functions:

```
fmap = function () {
    emit(Date.daytz(this.time * 1000, globtz), {count:1});
};
fred = function (k, v) {
    var r = {count:0};
    v.forEach(function (v0) {r.count += v0.count;});
    return r;
}; 
```

I get exactly what I wanted, running these two map reduce commands:

```
{ "mapreduce" : "objects",
    "map" : fmap,
    "reduce" : fred,
    "out" : { "inline" : 1 },
    "scope" : { "globtz" : "Europe/London" } } 
```

and

```
{ "mapreduce" : "objects",
    "map" : fmap,
    "reduce" : fred,
    "out" : { "inline" : 1 },
    "scope" : { "globtz" : "America/Los_Angeles" } } 
```

# jquery - 如何将这段简单的 jQuery 转换为 coffeescript

> ID：12830525
> 
> 赞同：-2
> 
> 时间：2012-10-11T00:37:32.087
> 
> 标签：jquery, coffeescript

我已经尝试了各种各样的东西，但都没有奏效

我在咖啡脚本中需要以下内容

```
$('html,body').animate({
    scrollTop: '+=' + $('#comment-div').offset().top + 'px'
}, 'fast'); 
```

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-11T00:44:03.380

[正如 Thilo 在评论中所说](https://stackoverflow.com/q/12830525/x#comment17357916_12830525)，您的 JavaScript 代码原样在 CoffeeScript 中也可以工作，但如果您想让它更符合 CoffeeScript-y，您可以。由于语言非常相似，因此没有太大区别。

```
$("html, body").animate {
    scrollTop: "+=#{$("#comment-div").offset().top}px"
}, "fast" 
```

我在这里所做的是：

*   删除了不必要的括号。
*   在字符串中使用字符串插值（`#{}`语法）`scrollTop`。

这些使代码更像 CoffeeScript-y。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-12T05:55:33.280

如果您需要最快的转换方式，请尝试将此作为临时解决方案

```
[www.js2coffee.org](http://www.js2coffee.org)
```

我建议你把它用作交叉验证，而不是在编译错误后更正代码（仅在初始阶段），我强烈建议你学习咖啡脚本而不是做这种转换的事情。

如果你想要除了[Little Book](http://arcturo.github.com/library/coffeescript/)之外的更详细的咖啡脚本书籍， 试试这些，
[Coffee](http://books.google.co.in/books/about/Programming_in_CoffeeScript.html?id=FaP-H_URQ2sC&redir_esc=y)
[CoffeeScript 中的编程加速 JavaScript 开发](http://pragprog.com/book/tbcoffee/coffeescript)

# javascript - 在智能手机上预览和上传图像

> ID：12830531
> 
> 赞同：0
> 
> 时间：2012-10-11T00:38:09.207
> 
> 标签：javascript, android, iphone, jquery-mobile

我正在尝试编写一个脚本，允许用户在我的 jquerymobile 驱动网站上上传由他们的手机拍摄（或从中选择）的图片。我发现 AJAX 不允许在表单中提交文件，我将不得不使用以下行

```
<form method=”POST” enctype=”multipart/form-data” action=”process_update.php” data-ajax=”false”&gt; 
```

对于表单本身，但我无论如何都找不到告诉智能手机提示用户在选择手机上的照片或拍摄新照片之间进行选择。

我该如何做到这一点？我会更好地考虑使用某种插件吗？

作为表单提交的一部分，我计划在服务器端执行裁剪和大小更改。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-11T01:04:18.043

使用三星 Galaxy S II 设备的浏览器 (webkit = 534.30) 和以下表单时：

```
<form method="POST" enctype="multipart/form-data" action="process_update.php">
  <input type="file" accept="image/*; capture=camera" />
  <input type="submit" />
</form> 
```

按下文件输入按钮时，设备提示我选择相机或画廊。我相信在 webkit 中触发这种行为的是 accept="image/*..." 属性。

# python - 使用 Python 求一些数字的平均值

> ID：12830540
> 
> 赞同：2
> 
> 时间：2012-10-11T00:39:44.847
> 
> 标签：python, while-loop, except

我正在使用 Python 做一个问题，比如不断要求用户输入数字。如果不是，程序应该计算这些数字的平均值。似乎我的程序无法从第二个 while 循环中逃脱，并且“except”仍然是错误的。这是我的程序：

```
count =0
total=0
ask=input ("Do you want to enter a number? (Y/N)")
while ask=="Y":
    numbers=float(input("Enter number"))
    count= count+1
    total=total+numbers
    con_ask=input ("Do you want to continue entering a number? (Y/N)")
    if con_ask=="Y":
        numbers=float(input("Enter number"))
        count=count+1
        total=total+numbers
    elif con_ask=="N":
        print ("The average of", count, "numbers is", total/count)
except :
    print ("Zero Division Occured. Average cannot be calculated") 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-11T00:52:30.897

我的计算平均数版本：

```
count = 0
total = 0
ask = raw_input("Do you want to enter a number? (Y/N)")
try:
    while ask == "Y":
        numbers = float(raw_input("Enter number"))
        count = count + 1
        total = total + numbers
        con_ask = raw_input("Do you want to continue entering a number? (Y/N)")
        if con_ask == "Y":
            continue
        elif con_ask == "N":
            print "The average of", count, "numbers is", total / count
            break
except:
    print "Zero Division Occured. Average cannot be calculated" 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-11T17:52:07.837

另一种方法：

```
numbers = []
ask = raw_input("Do you want to enter a number? (Y/N) ")
while ask == "Y":
   numbers.append(float(raw_input("Enter number ")))
   ask = raw_input("Do you want to continue entering a number? (Y/N) ")

if numbers:
    avg = sum(numbers,0.0) / len(numbers)
    print "The average of {0} numbers is {1}".format(len(numbers),avg)
else:
    print "You didn't enter any numbers" 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-11T00:44:43.420

您似乎在循环 while `ask == "Y"`，但后来设置了变量`con_ask`。可以重复使用`ask`吗？

此外，实现此目的的另一种方法可能是首先使用输入中的所有数字填充一个数组，然后平均值变为：

```
sum(numbers) / len(numbers) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-11T00:48:23.793

这里只有一个`while`循环。您可以重用`ask`，以便在每次循环迭代后对其进行测试。

```
ask=input ("Do you want to continue entering a number? (Y/N)") 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-10-11T16:18:22.930

如果你想要一个简单的程序来计算某个数字的平均值，你可以查看[Python Cookbook](http://code.activestate.com/recipes/440625/)。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2014-04-23T06:00:54.153

```
from sys import argv

t=0
c=0
ans=raw_input("Enetr the choice")

while ans=="Y" or ans=="y":
    a=float(raw_input("Value\t"))
    t=t+a
    c=c+1
    print  "-------------------------------------------"
    print "avarage %f\n" %(t/c)
    ask=raw_input("do you wanna continue \t")
    if ask=="y" or ask=="y":
        continue
    else:
        print "Not wanna more inputs\n"
        break
        print "---------- END ----------------------------" 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2019-03-01T11:17:47.680

如果你知道你需要输入多少数字

我的回答是：

```
l=[]

a=int(input('How much numbers you need to enter:'))

for x in range(a):

    s=float(input())
    l.append(s)
print(sum(l)/a) 
```

如果您不知道需要输入多少数字

```
l=[]

a=input('If you want to enter a number then enter a Y if you dont't enter N:')

while a=='Y':
     s=float(input())
     l.append(s)
     a=input('If you want to enter a number then enter a Y if you dont't enter N:')
print(sum(l)/len(l)) 
```

# vim - 使用 VIM 插入额外的换行符

> ID：12830543
> 
> 赞同：1
> 
> 时间：2012-10-11T00:40:06.537
> 
> 标签：vim, text-manipulation

我有一个带有连续文本的采访记录。有时，会写上说话人的名字（Aron：、Kalle：、Tomas：等）。我想在后跟冒号 (:)（我指定的名称）的每个名称之前插入一个换行符。

如何在 VIM 中编写脚本，以便当我运行命令时，它会遍历整个文本文件并插入那些额外的换行符？

换句话说，我想把这个变成：

```
Aron: bla, bla, bla
Kalle: yes, yes, yes 
```

进入：

```
Aron: bla, bla, bla

Kalle: yes, yes, yes 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-11T00:52:43.910

试试这个简单的命令：

```
:g/^/pu_ 
```

*   `g/^/`将匹配每一行，然后执行下面的命令。
*   `pu _`将来自寄存器`_`（黑洞寄存器）的文本放在当前匹配行之后。

* * *

您还可以使用以下`:substitute`命令：

```
:%s/$/\r 
```

* * *

另一个使用 external 的`sed`：

```
:%!sed G 
```

* * *

所有命令都具有相同的长度。选一个你喜欢的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-11T07:13:07.923

尝试这个

```
:%s#^\(\w*:\)#\r\1#g

- % : serach in all lines
- s : search and replace command
- # : separators (I perfer '#' to '/')
- \(\w*:\) : grep your required format (Aron:, Kalle:, Tomas: etc.) and store in \1
- \r : for inserting a line
- g : global search and replace 
```

# html - accept-charset="UTF-8" 参数在表单中使用时不执行任何操作

> ID：12830546
> 
> 赞同：11
> 
> 时间：2012-10-11T00:40:17.413
> 
> 标签：html, forms, spring-mvc, encoding, freemarker

我在表单中使用了 accept-charset="utf-8" 属性，发现当使用非 ascii 发布表单时，标头在请求标头中有不同的接受字符集选项。我有什么遗漏吗？我的表格看起来像这样

```
<form method="post" action="controller" accept-charset="UTF-8">
..input text box
.. submit button
</form> 
```

提前致谢

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-10-11T06:15:14.073

正如所问的，这个问题是自相矛盾的：标题说`accept-charset`参数不做任何事情，而问题主体说当使用`accept-charset`属性（这是正确的术语）时，“标题有不同的接受字符集选项请求标头”。我想后一个陈述中缺少否定。

浏览器`Accept-Charset`根据自己的原则和设置在 HTTP 请求头中发送参数。例如，我的 Chrome 发送`Accept-Charset:windows-1252,utf-8;q=0.7,*;q=0.3`. 这样的标头通常会被服务器端软件忽略，但它可以用于（并且它被设计用于）确定在服务器响应中使用哪种编码，以防服务器端软件（表单处理程序，在这种情况下）能够在响应中使用不同的编码。

元素中的`accept-charset`属性`form`预计不会影响 HTTP 请求标头，它也不会。它旨在指定用于请求中表单数据的字符编码，这就是它的实际作用。HTML 4.01 规范对此[并不明确](http://www.w3.org/TR/html401/interact/forms.html#adef-accept-charset)，但[W3C HTML5 草案对此](http://www.w3.org/TR/html5/the-form-element.html#attr-form-accept-charset)进行了说明，尽管出于某些奇怪的原因使用了复数形式：“给出用于提交的字符编码”。我想原因是您可以指定替代编码，以准备浏览器无法使用您首选编码的情况。例如，在 Chrome 中实际发生的情况是，如果您使用`accept-charset="foobar utt-8"`，则使用 UTF-8。

在实践中，该属性用于使数据提交的编码与包含表单的页面的编码不同。假设您的页面采用 ISO-8859-1 编码，并且有人在您的表单中输入了希腊语或希伯来语字母。浏览器必须进行一些错误恢复，因为这些字符无法在 ISO-8859-1 中表示。（实际上，他们将字符转换为数字字符引用，这在逻辑上都是错误的，但实际上可能是他们能做的最好的。）`<form charset=utf-8>`在这里使用帮助：无论编码是什么，表单数据都将以 UTF-8 编码发送，它可以处理任何字符。

如果您想告诉表单处理程序在其响应中应该使用哪种编码，那么您可以为此在表单中添加一个隐藏（或非隐藏）字段。

# iphone - 如何在 touchesBegan、touchesEnded 中实现 Touch Up Inside

> ID：12830547
> 
> 赞同：3
> 
> 时间：2012-10-11T00:40:27.717
> 
> 标签：iphone, ios, cocoa-touch, uigesturerecognizer

我想知道当用户按下然后在`touchesBegan`,`touchesEnded`方法中抬起手指时，是否有人知道如何实现“内部修饰”响应。我知道这可以用 来完成 `UITapGestureRecognizer`，但实际上我正在尝试让它只在快速点击时起作用（用`UITapGestureRecognizer`，如果你把你的手指放在那里很长时间，然后抬起，它仍然会执行）。有人知道如何实现吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2014-02-19T04:20:02.953

使用实际是模仿( , , , 等)`UILongPressGesturizer`的所有功能的更好的解决方案：`UIButton``touchUpInside``touchUpOutside``touchDown`

```
- (void) longPress:(UILongPressGestureRecognizer *)longPressGestureRecognizer
{
    if (longPressGestureRecognizer.state == UIGestureRecognizerStateBegan || longPressGestureRecognizer.state == UIGestureRecognizerStateChanged)
    {

        CGPoint touchedPoint = [longPressGestureRecognizer locationInView: self];

        if (CGRectContainsPoint(self.bounds, touchedPoint))
        {
            [self addHighlights];
        }
        else
        {
            [self removeHighlights];
        }
    }
    else if (longPressGestureRecognizer.state == UIGestureRecognizerStateEnded)
    {
        if (self.highlightView.superview)
        {
            [self removeHighlights];
        }

        CGPoint touchedPoint = [longPressGestureRecognizer locationInView: self];

        if (CGRectContainsPoint(self.bounds, touchedPoint))
        {
            if ([self.delegate respondsToSelector:@selector(buttonViewDidTouchUpInside:)])
            {
                [self.delegate buttonViewDidTouchUpInside:self];
            }
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-11T00:44:30.003

您可以通过创建 UIView 子类并在那里实现它来实现 touchesBegan 和 touchesEnded。

但是，您也可以使用[UILongPressGestureRecognizer](http://developer.apple.com/library/ios/#documentation/uikit/reference/UILongPressGestureRecognizer_Class/Reference/Reference.html)并获得相同的结果。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-10-15T23:25:14.397

我通过放置一个在 touchesBegan 中触发的计时器来做到这一点。如果在调用 touchesEnded 时此计时器仍在运行，则执行您想要的任何代码。这给出了 touchUpInside 的效果。

```
 -(void) touchesBegan:(NSSet *)touches withEvent:(UIEvent *)event
    {
        NSTimer *tapTimer = [[NSTimer scheduledTimerWithTimeInterval:.15 invocation:nil repeats:NO] retain];
        self.tapTimer = tapTimer;
        [tapTimer release];
    }

    -(void) touchesEnded:(NSSet *)touches withEvent:(UIEvent *)event
    {
        if ([self.tapTimer isValid])
        {

        }
    } 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2019-02-12T06:21:16.943

我不确定它是什么时候添加的，但该属性是任何派生对象（例如）`isTouchInside`的救命稻草。`UIControl``UIButton`

```
override func endTracking(_ touch: UITouch?, with event: UIEvent?) {
    super.endTracking(touch, with: event)
    if isTouchInside {
        // Do the thing you want to do
    }
} 
```

这是[苹果官方文档](https://developer.apple.com/documentation/uikit/uicontrol/1618234-endtracking)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-10-11T01:05:02.627

您可以创建一些`BOOL`变量，然后`-touchesBegan`检查触摸了什么视图或您需要的任何内容，并将此`BOOL`变量设置为`YES`. 之后`-touchesEnded`检查这个变量是否是`YES`你的视图或你需要的任何东西被触及，这将是你的`-touchUpInside`. 当然，将`BOOL`变量设置为`NO`之后。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-10-11T02:35:55.803

您可以添加 a`UTapGestureRecognizer`和 a`UILongPressGestureRecognizer`并使用添加依赖项`[tap requiresGestureRecognizerToFail:longPress];`（点击和长按是添加识别器的对象）。

这样，如果长按被触发，将不会检测到点击。

# java - 如果文件不断更改，我是否必须创建一个新的 fileinputstream 实例？

> ID：12830554
> 
> 赞同：0
> 
> 时间：2012-10-11T00:41:43.110
> 
> 标签：java, io, saxparser, fileinputstream

我有一个被另一个应用程序不断修改的 xml 日志；但是我的 Java 代码同时运行并检查几个字符串。我正在使用 SAX 解析器。现在我的问题是每次循环文件时都必须有一个 FileInputStream 的新实例吗？解析器呢？

所以让我们说：

```
while(notfound)
{
    FileInputStream fis = new FileInputStream(new File("c:/tmp/123.xml"));
    SaxParser.parse(fis, sampleHandler);
    notFound = sampleHandler.checkIfFound();
} 
```

感谢：D

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-11T00:46:04.383

在您提供的示例中，每次您想从文件开头开始读取时**都**需要一个新的。类通常不允许手动定位/重置“位置”，正如名称（“流”）所暗示的那样，它只是一个喷出比特的管道。`FileInputStream``Stream`

由于您使用`SaxParser.parse()`类方法来启动解析，因此您似乎实际上没有要重新创建的解析器对象。因此，您只需重新创建`FileInputStream`.

但！似乎当前版本的`SaxParser`类支持将`File`实例作为第一个参数传递，因此您可以重复使用：

```
while(notfound)
{
    SaxParser.parse(new File("c:/tmp/123.xml"), sampleHandler);
    notFound = sampleHandler.checkIfFound();
} 
```

避免完全重新创建`FileInputStream`，并允许解析器处理它。

# python - 如何在程序中多次调用同一个进程

> ID：12830556
> 
> 赞同：1
> 
> 时间：2012-10-11T00:41:48.840
> 
> 标签：python, multiprocessing

我正在使用 python 2.7 多处理模块。我想启动一个进程，然后终止它，然后使用新参数再次启动它。

```
p = Process(target=realwork, args=(up, down, middle, num))
def fun1():
    p.start()

def fun2():
    p.terminate() 
```

在程序流程的过程中（通过循环和事件），我按以下顺序调用函数：

```
fun1()
fun2()
fun1()
fun2() 
```

如果我尝试这样做，我会收到一条错误消息，说我不能多次调用同一个进程。有解决方法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-11T03:54:52.857

所以 - ypu 可能在某处读到“使用全局变量不是一个好习惯” - 这就是原因。您的“p”变量仅包含一个“进程”实例，并且它只能启动（和终止）一次。

如果你重构你的代码，让“fun1”和“fun2”把它们作为参数的进程，或者可能以OO方式，其中fun1和fun2是方法，进程是一个实例变量，你不会有任何这些问题。

在这种情况下，OO 可以快速查看并直接使用：

```
class MyClass(object):
    def __init__(self):
        self.p = Process(target=realwork,args=(up,down,middle,num))
    def fun1(self):
        self.p.start()

    def fun2(self):
        self.p.terminate() 
```

然后，无论您需要对“fun1”和“fun2”进行一对调用，您都可以：

```
action = Myclass()
action.fun1()
action.fun2() 
```

反而。这甚至可以在 for 循环或其他任何循环中工作。

**edit* - I just saw ou are using this as answer to a button press in a Tkinter program, so, you have to record the Process instance somewhere between button clicks. Without having your code to refactor, and supposing you intend to persist on your global variable approach, you can simply create the Process instance inside "fun1" - this would work:

```
def fun1():
    global p
    p = Process(target=realwork,args=(up,down,middle,num))
    p.start()

def fun2():
    p.terminate() 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-11T01:14:23.127

一旦你`terminate`一个进程，[它就死了](http://docs.python.org/library/multiprocessing.html#multiprocessing.Process.terminate)。例如，您可能能够重组进程以便能够[使用管道](http://docs.python.org/library/multiprocessing.html#pipes-and-queues)与其通信。如果子进程表现不佳，这可能很难正确处理。否则，您可以`Process`为每组参数创建一个新实例。

# ruby - Rails 3.2 中的 DRY 控制器

> ID：12830558
> 
> 赞同：8
> 
> 时间：2012-10-11T00:41:54.283
> 
> 标签：ruby, ruby-on-rails-3, dry

在进行代码气候分析后，我发现我的控制器并非 DRY。方法如：

```
 def index
    @animals = current_user.animals.valid_animals.search(params[:search], params[:page])
    respond_to do |format|
      format.html # index.html.erb
      format.json { render json: @animals }
    end   
 end 
```

在所有控制器中基本相等。

基本上，脚手架导轨生成的代码在所有控制器中都是“相同的”。我怎样才能以真正好的方式让它更干净和干燥？

提前致谢

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-10-11T00:43:43.220

无需按照您所说的方式使代码干燥。想一想，使代码 DRY 的主要目的之一是，如果您在一个地方更新代码，则不必在另一个地方更新代码。但是，在您的情况下，如果您在控制器 X 中更新代码，那么您在控制器 Y 中进行相同更改的可能性有多大？如果不是，那么它不是抽象的好选择。（事实上​​，如果你甚至要远程更改 X 中不会影响 Y 的东西，那么它是 DRY-ness 的糟糕候选者）

一般来说，抽象是好的。但是，过度抽象并不是一件好事，应该避免。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-11T05:53:25.797

您可以对这些操作使用[respond_with](http://api.rubyonrails.org/classes/ActionController/MimeResponds.html)。

```
class AnimalController < ApplicationController
  respond_to :html, :json

  def index
    @animals = current_user.animals.valid_animals.search(params[:search], params[:page])
    respond_with @animals
  end   
end 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-10-11T01:02:57.907

Ken Li 是对的，过度抽象不是一件好事，在这种情况下有点不必要，但如果你的控制器中确实有重复的代码，你可以使用[Before、Around 和 After 过滤器](http://guides.rubyonrails.org/action_controller_overview.html#filters)来干燥代码。

# sql - Oracle SQL - 为查询中的日期可能性创建多个范围

> ID：12830560
> 
> 赞同：1
> 
> 时间：2012-10-11T00:42:07.153
> 
> 标签：sql, oracle

我有这个查询：

```
Select * 
From Player_Chkin_Cs 
```

这吐出了结果：

```
Player_ID     CS_ID   CS_LISTING_ID  CS_COMP_NAME   PT_ADD  CREATE_DTIME   UUID
 179364        300      60132          Wilshire       3      22-DEC-10     (null)
 179364        320      68968          Wilshire       30     28-JAN-10     (null)
 132489        200      55168          Wilshire       13     03-Jan-10     (null)
 132489        900      65478          Wilshire       23     15-Feb-10     (null) 
```

我想创建一个查询，该查询仅返回具有 create_dtimes 在 01-Dec-10 到 31-Dec-10 和 01-Jan-10 到 31-Jan-10 范围内的玩家的 player_ids。（仅Player_ID 179364 将显示在此示例的结果中）

如果您有任何建议，请告诉我！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-11T00:46:58.387

一种选择是

```
SELECT player_id,
       COUNT(DISTINCT trunc(create_dtime, 'MM')) num_months
  FROM player_chkin_cs
 WHERE trunc(create_dtime,'MM') IN (date '2010-12-01', date '2010-01-01')
 GROUP BY player_id
HAVING COUNT(DISTINCT trunc(create_dtime, 'MM')) = 2 
```

# javascript - 在 jQuery.ajax url 参数中附加服务名称

> ID：12830561
> 
> 赞同：2
> 
> 时间：2012-10-11T00:42:12.143
> 
> 标签：javascript, jquery

如果我要使用以下方法设置未来的 ajax 调用：

```
$.ajaxSetup({
    url: '/WebServices/AjaxService.asmx',
    type: 'POST',
    dataType: 'json',
    contentType: 'application/json; charset=utf-8'
}); 
```

有什么办法可以在以后的调用中*附加服务名称吗？*像这样：

```
$.ajax({
    url: '+=/ServiceName'
}); 
```

还是全局变量是我最好的选择？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-11T00:47:55.867

不是您建议的方式（尽管`$.ajaxSetup.url`可以这样使用），但您可能想要创建一个路径固定的对象，并且您可以设置服务方法名称：

```
function Service(){
  var path = 'http://myserver';

  this.getServiceUrl = function(serviceName) { return path + '/' + serviceName; };
}

...

var s = new Service();
$.ajax({
  url: s.getServiceUrl('myServiceName'),
  ...
}); 
```

或类似的东西。我希望这会有所帮助。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-11T00:57:22.723

`$.ajaxSettings`将允许您访问 ajax 设置。然后你可以去：

```
$.ajax({ 
  url: $.ajaxSettings + "/ServiceName"
  ... 
}); 
```

# c# - 委托不通知该方法

> ID：12830568
> 
> 赞同：1
> 
> 时间：2012-10-11T00:43:02.547
> 
> 标签：c#, delegates

你能看看我的代码并告诉我哪里出错了吗？在下面的代码中，我试图`myMethod()`在 Form1 最大化时向方法发送通知。

谢谢！

```
namespace WindowsDelegate1
{

    public delegate void ChangedEventHandler(object sender, EventArgs e);

    class myForm : Form
    {
        public event ChangedEventHandler Changed;

        protected virtual void OnChanged(EventArgs e)
        {
            if (Changed != null)
                Changed(this,e);
        }

        public override System.Drawing.Size MaximumSize
        {
            //get
            //{
            //    return base.MaximumSize;
            //}
            set
            {
                base.MaximumSize = value;
                OnChanged(EventArgs.Empty);
            }
        }
    }
}

namespace WindowsDelegate1
{
    class EventListener
    {
        private myForm TheForm;

        public EventListener(myForm theform)
        {
            TheForm = theform;
            TheForm.Changed += new ChangedEventHandler(myMethod);
        }

        private void myMethod(object sender, EventArgs e)
        {
            MessageBox.Show("hey, window should be maximized now!");
        }

        public void Detach()
        {
            TheForm.Changed -= new ChangedEventHandler(myMethod);
            TheForm = null;
        }
    }
} 
```

这是测试单元/或 main()

```
namespace WindowsDelegate1
{
    public partial class Form1 : Form
    {
        public Form1()
        {
            InitializeComponent();
        }

        private void button1_Click(object sender, EventArgs e)
        {
            myForm f = new myForm();
            EventListener listener = new EventListener(f);
            f.ShowDialog();
            f.WindowState = FormWindowState.Maximized;
            listener.Detach();

        }
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-11T00:55:12.443

可能发生的情况是事件在您`.Detach()`调用后被触发，或者根本不会被触发。我将从删除`listener.Detach()`呼叫开始。通常，您在创建表单或加载表单时附加到事件，并在卸载表单时将其分离。

除此之外，您的`Detach`方法存在问题，因为它试图删除与`ChangedEventHandler`添加的实例不同的实例。如果您将方法包装在`ChangedEventHandler`其中，则需要存储您添加的实例。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-11T01:08:42.017

感谢您分享您的想法！

我通过删除属性来修复它（不知道我为什么使用它！！）并使用方法来代替：

```
protected override void OnActivated(EventArgs e)
{
    base.OnActivated(e);
    OnChanged(EventArgs.Empty);
} 
```

我也更新了上面的源代码

# python - 可以运行python文件的python编辑器？

> ID：12830569
> 
> 赞同：0
> 
> 时间：2012-10-11T00:43:05.730
> 
> 标签：python, editor

> **可能重复：**
> [用于 Python 的 IDE 是什么？](https://stackoverflow.com/questions/81584/what-ide-to-use-for-python)

是否有任何 Python 编辑器可以通过简单的键绑定运行当前查看的文件，因此我不必打开命令提示符？如果它也可以打开 Python 解释器，则可以加分。

提及您认识的任何可以执行此操作的编辑器，因此我有一些选项可供选择。其他便利功能的奖励积分，如自动代码完成、错误标记、智能缩进、括号匹配、行号等。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-11T00:47:47.293

就个人而言，我认为命令提示符是最好的部分；）但如果您坚持，请尝试[http://pydev.org/](http://pydev.org/)，它是 eclipse 的 python 插件。它是一个 IDE，并且可以具有自动完成功能等。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-11T00:54:42.240

如果您不限于开源产品，您可以尝试 WingWare IDE：

[http://wingware.com/](http://wingware.com/)

就专业的所见即所得编辑器而言，它相当成熟且易于使用。它提供三个版本：

*   Wing IDE 专业版
*   Wing IDE 个人版
*   翼IDE 101

Wing IDE 101 是面向教育工作者、学生和爱好者的免费版本。另外两个是商业版本，比免费版本提供更多功能。所有三个版本的 Wing IDE 都可以在 Windows、Linux 和 Mac OS X 上运行。

此外，它还满足您要求的许多功能：

```
Auto-completion, call tips, error indicators, goto-definition, find uses, source browser, code indices, and symbol lookup. 
```

另请参阅此 Wikipedia 链接以了解其某些功能：[http ://en.wikipedia.org/wiki/Wing_IDE](http://en.wikipedia.org/wiki/Wing_IDE)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-11T01:15:54.520

我在 Eclipse 之上使用[PyDev](http://pydev.org/)，我目前正在构建一个[实时编码插件](http://donkirkby.github.com/live-py-plugin/)，它可以*在您键入*.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-11T01:16:54.567

对于只有几个文件的小型项目，我是[Spyder](http://code.google.com/p/spyderlib/)的忠实拥护者 ，它重量轻，易于使用，但具有完整 IDE 的许多功能。

如果您需要功能齐全的 IDE 而不是轻量级的 IDE，那么我建议您使用 Pydev。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-10-11T01:07:14.937

*   [**Emacs**](http://www.gnu.org/software/emacs/)
*   [**vim**](http://www.vim.org/download.php)
*   [**Eclipse**](http://www.eclipse.org/)及其强大的[pydev](http://pydev.org/)插件
*   [**翼件**](http://wingware.com/)

Emacs: meta x shell-command 可以解决问题。

```
M-x shell-command 
```

其次是

```
python foo.py 
```

请参阅[emacs 中的运行命令](http://www.nongnu.org/emacsdoc-fr/manuel/shell.html)。

# c - fopen 打不开

> ID：12830570
> 
> 赞同：2
> 
> 时间：2012-10-11T00:43:07.047
> 
> 标签：c

我正在使用 Code::Blocks 并通过 IDE 设置了命令行参数。`NULL`我还使用正确的参数打开了可执行文件，但我无法获得非`fopen()`返回值。我试过硬编码文件名也没有成功。该平台是Windows XP SP3。

第一个是失败的，当我对其进行硬编码时，我使用了双反冲。我也不知道第二个是否有效，因为我从未设法通过打开第一个来启动该过程。

显然我将文本文件放在可执行文件的同一目录中并多次重建可执行文件，但它仍然不起作用。

编辑：我添加了 perror("fopen"); if(finput==NULL) 块中的行。这是输出。

[http://prntscr.com/h71pa](http://prntscr.com/h71pa)

```
#include <stdio.h>
#include <stdlib.h>
#include <string.h>

#define first_part_url "[url=http://magiccards.info/query?q="
#define second_part_url "&v=card&s=cname]"
#define end_bracket "[/url]\n"
#define output_file_prefix "output_"

char* get_card(FILE* finput);

int main(int n, char* arguments[])
{
FILE* finput;
FILE* foutput;
short int counter;
char* output_filename;
char* finalstring;

for(counter=1; counter<n; counter++)
{
    finput=fopen(arguments[counter], "r");

    if (finput==NULL)
    {
        printf("Unable to open ");
        puts(arguments[counter]);
                    perror("fopen");
        break;
    }

    strcpy(output_filename, output_file_prefix);
    strcat(output_filename, arguments[counter]);

    if((foutput=fopen(output_filename, "w"))==NULL)
    {
        printf("There was an error while trying to open ");
        puts(arguments[counter]);
        printf(" .\n");
        break;
    }

    while(!feof(finput))
    {
    finalstring=get_card(finput);
    fputs(finalstring, foutput);
    while(((fgetc(finput))!='\n')||feof(finput));
    }

    printf("Autocarding ");
    puts(arguments[counter]);
    printf(" was a success.\n");
    fclose(foutput);
}

if(finput!=NULL)
{
fclose(finput);
free(finalstring);
}
return 0;
}

char* get_card(FILE* finput)
{
char* currentcard;
char* finalstring;

currentcard=(char*)malloc(sizeof(char)*150);
fgets(currentcard, 150, finput);

/* Allocates the exact amount of space needed for the final string*/
finalstring=(char*)malloc(sizeof(char)*(strlen(first_part_url)+strlen(second_part_url)+strlen(end_bracket)+strlen(currentcard)));

/* Get all the final forum link together*/
strcat(finalstring, first_part_url);
strcat(finalstring, currentcard);
strcat(finalstring, second_part_url);
strcat(finalstring, end_bracket);

free(currentcard);

return finalstring;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-11T01:22:32.057

您收到的错误“没有这样的文件或目录”表示您尝试打开的文件名不存在。

在这种情况下，可能是因为程序的当前工作目录与包含可执行文件的目录不同。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-11T01:13:46.973

这个

```
finput=fopen(arguments[counter], "r"); 
```

仅当您不提供正确的文件名时才会失败（例如，如果名称中有非 ASCII 字符或名称不包含正确的路径，`fopen()`如果文件名中未指定路径，则在当前目录中打开文件）。

这个

```
output_filename=(char*)malloc(sizeof(arguments[counter])); 
```

很可能没有为名称分配足够的空间，因为`arguments[counter]`是一个指针，并且`sizeof()`指针与`strlen(that_same_pointer) + 1`.

这个

```
output_filename=output_file_prefix; 
```

丢失刚刚分配的内存，因为您正在重新分配指针`output_filename`以指向其他地方`output_file_prefix`（`"output_"`）。

在上面这个之后

```
strcat(output_filename, arguments[counter]); 
```

可能会使您的程序崩溃，因为这将尝试覆盖字符串文字 ( `"output_"`)，这样做会导致 C 标准中未定义的行为。

您必须为要连接的字符串分配足够的累积空间，并且必须在分配的空间中连接它们。

为了给你省更多麻烦，这里还有一个问题：

```
finput=fopen(arguments[counter], "r");
...
while(!feof(finput)) 
```

`feof()`仅在从文件中读取至少一次后才有效。这已被多次[询问和回答](https://stackoverflow.com/questions/5431941/while-feof-file-is-always-wrong)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-11T01:17:47.157

尝试改变

```
for(counter=1; counter<n; ++n)
{ 
```

至

```
for(counter=1; counter<n; ++counter) 
```

看起来代码无限循环，因此它会耗尽参数数组中的可能元素，从而导致返回 NULL 指针。

# javascript - 如何在另一个对象的被调用函数中获取调用者引用？

> ID：12830573
> 
> 赞同：0
> 
> 时间：2012-10-11T00:43:31.140
> 
> 标签：javascript

以下是我正在尝试的代码：

```
var varincaller;
function mainfunction(arg)
{
 varincaller = arg;
}

function mainfunction2()
{
var obj2 = new anotherclass;

obj2.anotherfunction = function()
{
   //How can I get varincaller, here ?
}
} 
```

有人可以帮忙吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-11T00:45:36.940

以下语句创建一个全局变量`varincaller`。因此，它可以从任何功能访问。

```
var varincaller; 
```

此语句在语法上不正确：

```
var obj2 = new anotherclass; 
```

应该：

```
var obj2 = new anotherClass(); 
```

要访问`varincaller`有问题的函数内部，只需简单调用它：

```
obj2.anotherfunction = function()
{
   alert(varincaller);
}
obj2.anotherfunction(); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-11T00:46:27.717

给定您的代码，因为`varincaller`在定义的范围之外或在相同的范围内`.anotherfunction`定义，我们可以直接访问它：

```
obj2.anotherfunction = function() {
   varincaller; // this works
}; 
```

# ruby-on-rails - 如何在 Ruby on Rails 中呈现之前选择的选项？

> ID：12830588
> 
> 赞同：1
> 
> 时间：2012-10-11T00:44:56.883
> 
> 标签：ruby-on-rails

目前，我有一个 select 标签，其中包含我拥有的 State 的各种选项。当验证失败时，页面会再次呈现，之前在文本框中输入的值不会丢失并且仍然存在。但不保留所选项目。我如何对其进行编码以便保留它？

查看代码：

```
= form_for @user do |f|
  = f.text_field :name
  = f.select :state, { "California" => "CA", "Texas" => "TX"} , :prompt => ''
  = f.submit "Submit" 
```

控制器代码：

```
 def new
   @user = User.new
 end

 def create
    @user = User.new(params[:user])
    if @user.save
      redirect_to root_path
    else
      render 'new'
    end
  end 
```

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-11T01:19:29.757

您的控制器代码很好。您的视图代码可能是这里的罪魁祸首。请确保您视图中的表格是一致的。

# python - Python socket.connect 在 for 循环中

> ID：12830591
> 
> 赞同：0
> 
> 时间：2012-10-11T00:45:23.793
> 
> 标签：python, sockets, for-loop, port, port-scanning

我正在用 Python 编写一个程序，其中一部分是扫描网站上的活动端口。在模块扫描端口中，如果我说扫描端口 79 到 81，我知道它应该返回一个包含 80 的列表。我肯定知道这一点，因为当我运行 scanport 时，它显示端口 80 已启动。很抱歉没有任何评论：

```
import subprocess, socket, urllib2, sys
class pymap:
    def __init__(self):
        pass

################################################################################
################################################################################

    def host(self, host):
        self.host = host
        socket1 = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
        self.sock = socket1

################################################################################
################################################################################

    def getip(self):
        if self.host == None:
            print "Specify a host first."
        else:
            return socket.gethostbyname(self.host)

################################################################################
################################################################################

    def scanports(self, start, end):
        ports = []
        self.sock.settimeout(0.000001)
        for i in xrange(start, end+1):  #49151
            try:
                self.sock.connect((self.host, i))
                ports.append(i)
            except:
                pass
        return i

################################################################################
################################################################################

    def scanport(self, port1):
        self.sock.settimeout(0.000001)
        try:
            self.sock.connect((self.host, port1))
            return 1
        except:
            return 0

################################################################################
################################################################################

    def traceroute(self):
        if self.host == None:
            print "Specify a host first."

        else:
            proc=subprocess.Popen(('tracert', self.host), shell=True, stdout=subprocess.PIPE)
            output=proc.communicate()[0]
            return output

################################################################################
################################################################################

    def getsource(self, url):
        page = urllib2.urlopen(url)
        return page.read()

################################################################################
################################################################################

x = pymap()
x.host("www.google.com")
print x.scanports(70, 85)
print x.scanport(80) 
```

编辑：我改变了它，感谢 James Henstridge 指出我正在使用迭代变量，否则会更难。但是，它仍然不起作用：

```
 def scanports(self, start, end):
        ports = []
        self.sock.settimeout(3)
        for i in xrange(start, end+1):  #49151
            try:
                self.sock = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
                self.sock.connect((self.host, port1))
                self.sock.close()
                ports.append(i)
            except:
                pass
            return ports 
```

编辑：我想通了，ports.append 有问题，感谢您的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-11T01:18:05.530

您的代码存在一些问题：

1.  您的方法正在返回循环迭代变量，因此无论它检测到什么端口`scanports`，它都会返回。`end`也许您打算返回`ports`列表？

2.  您一遍又一遍地重用同一个套接字。从`connect`系统调用手册页：

    > 通常，基于连接的协议套接字可能只成功连接一次（）

    因此，如果要测试多次连接尝试，请每次创建一个新套接字。您还应该在使用后关闭这些套接字。

# django-admin - geodjango 管理员没有提供几何值

> ID：12830597
> 
> 赞同：1
> 
> 时间：2012-10-11T00:46:04.607
> 
> 标签：django-admin, geodjango

我正在为我的宠物项目尝试geodjango，除了例外，一切看起来都很好......

在我的模型中，我有一个这样的字段：

```
coordinates= models.PointField(srid=4326,default='POINT(0.0 0.0)') 
```

并且我的管理员扩展自`admin.OSMGeoAdmin`但当我在管理员中打开一个新模型实例时，我没有看到地图中选择的“0.00,0.00”点，如果我尝试保存文档，我会得到“没有几何值假如'。就像管理员无法将点放在地图上一样。

此外，如果我尝试使用 shell，我可以保存没有问题的实例并获取默认值 POINT(0.0 0.0) 的字段。

我在管理员中遗漏了什么吗？

感谢您的任何提示！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-13T15:57:49.583

我有同样的问题。有点奇怪。发布的内容毫无意义。在点击提交时，textarea 具有正确的几何值（因为我在输出我这个值的表单上放置了一个 onsubmit）。但是提交的不是那个值。所以我关掉了JS……哇。提交了正确的值，我有点高兴，但这不是解决方案。但是我不知道javascript在做什么。我已经用 Django 1.3 和 1.4 试过了。你有运气吗？

更新。另一个“解决方案”...覆盖 openlayers.html 并将 textarea 转换为标准文本输入。哇。再次工作。

解决了！

所以我的挖掘了一些......但我的管理员使用tinymce...... Tinymce在textareas上工作是的......好吧，它搞砸了小部件textarea，但一直如此安静。

editor_deselector：“vWKTField”

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-16T01:33:56.650

好吧，在玩弄了打开的 layers.html 之后（感谢嘈杂的锅炉！）我发现 OSMGeoAdmin 上有一个属性`display_wkt`，将其设置为`True`将显示 textArea 而不会破坏模板。

对于具有现有点的条目，它包含以下格式的值：

```
SRID=3857;POINT(890338.8453418 -1109499.0330941) 
```

所以我只是将我的点场更改为：

```
coordinates= models.PointField(srid=4326,default='SRID=3857;POINT(0.0 0.0)') 
```

我从[Spherical Mercator](http://docs.openlayers.org/library/spherical_mercator.html)了解到的是 4326 用于二维地图，但似乎谷歌地图使用 3857，其中包括球面投影。

现在有效！

# calendar - 如果没有 javascript 后备，如何使用 YUI 日历获取选定日期

> ID：12830598
> 
> 赞同：0
> 
> 时间：2012-10-11T00:46:11.053
> 
> 标签：calendar, yui, accessibility

请温柔一点，我很困惑，我无法弄清楚...有人告诉我使用 YUI 库，因为它是最容易访问的库，并且它在 JavaScript 未启用时提供了回退。当未启用 JavaScript 时，我无法弄清楚如何获取日历小部件的选定日期。提交时似乎没有发布任何内容。我尝试绑定到输入框而不是 div，但它只是忽略了绑定。如果启用了 JavaScript，我可以将选定的值推送到输入框。这个小部件是规则的例外，因为它绑定到一个 div，还是有一种秘密方法可以找出用户在未启用 JavaScript 的情况下选择了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-22T13:17:37.437

许多 YUI 小部件旨在增强现有的 HTML，即使 JS 被关闭或损坏，也会退回到有用的东西。例如，一个 YUI TabView 的核心标记是一个链接列表；如果你破坏了 JS，你仍然可以点击那些工作链接。

但是 YUI 日历本身并不是一个表单元素——相反，您应该将其视为表单元素的*增强器*。您将其附加到输入元素的本能是正确的。好消息是 YUI 库有一个弹出式日历，它建立在基本日历之上，旨在绑定到元素，并在用户关注时显示在元素下方。

这是一个经典的渐进增强场景。如果用户有 JS，他们会得到一个精美的日历。如果没有，他们仍然可以填写简单的输入字段——没有伤害。

# android - 当我的活动正在运行并且设备已连接到充电器时，防止设备锁定 android

> ID：12830605
> 
> 赞同：4
> 
> 时间：2012-10-11T00:47:05.943
> 
> 标签：android, security, locking

我有一个夜间时钟应用程序，我想在应用程序运行并且设备在充电器上时禁用设备的键盘保护。这个想法是，如果你在充电器上并且这个应用程序正在运行，那么假设你在一个安全的位置是合理的。当应用程序退出（通过返回或主页）时，我不希望出现解锁屏幕，只允许正常使用，就好像手机从未空闲超过设备的锁定时间一样。

目前我的应用程序使用 FLAG_SHOW_WHEN_LOCKED 窗口选项，它可以很好地保持屏幕开启和解锁，但是当我回击或回家时（锁定时间到期后），我得到解锁键盘屏幕来解锁设备。我想防止在我的应用程序正在运行并且设备在充电器上时发生这种锁定其他应用程序的情况。我显然会将这个功能设置为用户选择的设置，但是如何实现呢？

任何人都可以帮我解决这个问题 - 我所有的谷歌搜索工作都指向只让我的应用程序不被锁定，但我已经解决了这个问题。

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-11T00:56:42.833

首先创建一个意图过滤器并监听充电器事件

```
IntentFilter ifilter = new IntentFilter(Intent.ACTION_BATTERY_CHANGED);
Intent batteryStatus = context.registerReceiver(null, ifilter); 
```

在听众中

```
// Are we charging / charged?
int status = batteryStatus.getIntExtra(BatteryManager.EXTRA_STATUS, -1);
boolean isCharging = status == BatteryManager.BATTERY_STATUS_CHARGING ||
                     status == BatteryManager.BATTERY_STATUS_FULL;

if(isCharging) {
//disable keyguard
} 
```

在你的 onPause()

启用键盘保护

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-11T06:40:54.687

非系统应用程序无法禁用键盘保护。你能做的最好的就是让你的应用成为设备[管理员](http://developer.android.com/reference/android/app/admin/DevicePolicyManager.html)并增加锁定时间。但是，这对于时钟应用程序可能会被视为可疑。此外，一旦用户退出您的应用程序，您通常无法控制其他应用程序或系统发生的情况，这就是 Android 的工作方式。我明白为什么在您按下主页键后设备突然被锁定可能会感觉不自然，但我认为您对此无能为力。

# macos - 在 Sublime Text 2 中使用默认的 ruby 版本

> ID：12830607
> 
> 赞同：4
> 
> 时间：2012-10-11T00:47:16.670
> 
> 标签：macos, sublimetext2, ruby-1.9.3

我的默认和当前版本的 ruby​​ 是 1.9.3。它实际上是我跑步时出现的唯一版本，`rvm list`所以我不明白我怎么能把那部分弄乱。我确实遵循了我在这里找到的[本](http://upstre.am/blog/2011/07/sublime-text-2-with-rvm-on-osx/) 教程，但它似乎破坏了一切。对于我看到的所有修复变体，甚至在评论中，我不断收到“没有这样的文件或目录”。我在 Mac 上，请让我知道我需要在此处发布的其他信息，以帮助您弄清楚我是如何破坏事物的。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-12-17T16:48:27.897

您始终可以`ruby`通过编辑 Build 命令首选项来编辑使用的内容：

```
subl ~/Library/Application\ Support/Sublime\ Text\ 2/Packages/Ruby/Ruby.sublime-build 
```

将默认值更改为`"ruby"`您需要的任何路径。您在任何给定时间使用的版本都可以通过以下方式发现：

```
which ruby 
```

或者，您可以只链接到通常位于的默认值`/opt/local/rvm/bin/ruby`。

# java - Scala 闭包与 Java 内部类相比 -> final VS var

> ID：12830611
> 
> 赞同：7
> 
> 时间：2012-10-11T00:47:49.110
> 
> 标签：java, scala, closures, anonymous-function, inner-classes

我首先问过这个关于`final`在 Java 中使用 with 匿名内部类的问题： [为什么我们在匿名内部类中使用 final 关键字？](https://stackoverflow.com/questions/7076773/why-do-we-use-final-keyword-with-anonymous-inner-classes)

我实际上正在阅读 Martin Odersky 的 Scala 书。看起来 Scala 简化了很多 Java 代码，但是对于 Scala 闭包，我可以注意到一个显着的不同。

虽然在 Java 中我们使用匿名内部类“模拟”闭包，捕获一个最终变量（它将被复制到堆而不是堆栈上），但在 Scala 中我们似乎可以创建一个可以捕获 val 的闭包，但是也是一个 var，因此在闭包调用中更新它！

所以就像我们可以在没有`final`关键字的情况下使用 Java 匿名内部类！我还没有读完这本书，但目前我还没有找到关于这种语言设计选择的足够信息。

有人能告诉我为什么 Martin Odersky，他似乎真的很关心函数的副作用，选择闭包来同时捕获`val`and`var`而不是只捕获`val`？

Java 和 Scala 实现的优缺点是什么？

谢谢

相关问题： [使用 Scala 闭包，捕获的变量何时开始存在于 JVM 堆上？](https://stackoverflow.com/questions/12831024/with-scala-closures-when-do-captured-variables-start-to-live-on-the-jvm-heap)

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-10-11T04:46:12.250

一个对象可以看作是一袋闭包，它们共享对同一环境的访问，并且该环境通常是可变的。那么为什么要让匿名函数生成的闭包不那么强大呢？

此外，其他具有可变变量和匿名函数的语言也以相同的方式工作。租赁惊奇原则。Java 实际上很奇怪，它不允许内部类捕获可变变量。

有时它们只是非常有用。例如，一个自我修改的 thunk 以创建您自己的惰性或未来处理变体。

缺点？它们具有共享可变状态的所有缺点。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-11T03:04:44.130

以下是一些优点和缺点。

语言设计中有一条原则，即程序员应该清楚某物的成本。（我在 Holt 的《图灵语言的设计和定义》中第一次看到这一点，但我忘记了他给它起的名字。）两个看起来一样的东西应该是一样的。两个本地变量应该有相似的成本。这对 Java 有利。Java 中的两个本地变量的实现方式相同，因此无论内部类中是否提及其中一个变量，它们的成本都相同。Java 的另一优点是，在大多数情况下，捕获的变量确实是最终的，因此阻止程序员捕获非最终本地变量的成本很小。对 final 的坚持也简化了编译器，因为这意味着所有局部变量都是堆栈变量。

语言设计的另一个原则是正交的。如果可以捕获 val 为什么不能捕获 var。只要有合理的解释，何必设限制。当语言不够正交时，它们似乎是不正当的。另一方面，具有太多正交性的语言可能具有复杂的（因此有错误和/或延迟和/或很少）实现。例如，Algol 68 在黑桃上具有正交性，但实施起来并不容易，这意味着实施很少，吸收也很少。Pascal（大约在同一时间设计）有各种不雅的限制，使编写编译器更容易。结果是大量的实施和大量的吸收。

# mysql - GROUP BY 子句未正确显示行

> ID：12830612
> 
> 赞同：0
> 
> 时间：2012-10-11T00:47:51.857
> 
> 标签：mysql, sql, database, group-by

我在下面有一个“答案”数据库表：

答案表

```
AnswerId SessionId QuestionId Answer
10       AAD       7          A
11       AAD       7          B
12       AAD       7          D
13       AAA       1          A
14       AAC       1          True 
```

现在正如您在上面看到的那样，考试（会议）AAD 中的问题 7 有 3 个答案，考试（会议）AAA 中的问题 1 有 1 个答案，这些是考试（会议）AAC 中问题 1 的 1 个答案。

所以当我在 php/html 中输出表格时，它应该像这样显示它：

```
 Question  Answer

  7         ABD
  1         A
  1         True 
```

但问题是它在我不想要的 3 个单独的行中显示表格：

```
Question  Answer
7         ABD
7         ABD
7         ABD
1         ATrue
1         ATrue 
```

所以我猜我的 GROUP BY CLAUSE 不正确，我的问题是 GROUP BY 子句应该是什么才能正确？

```
 SELECT DISTINCT an.SessionId, an.QuestionId, q.QuestionContent, o.OptionType, q.NoofAnswers, GROUP_CONCAT( an.Answer
ORDER BY an.Answer
SEPARATOR  ' ' ) AS Answer, r.ReplyType, q.QuestionMarks
FROM Answer an
INNER JOIN Question q ON q.QuestionId = an.QuestionId
JOIN Reply r ON q.ReplyId = r.ReplyId
JOIN Option_Table o ON q.OptionId = o.OptionId
GROUP BY an.SessionId, an.QuestionId 
```

下面我包含了“问题”和“答案”表的 SHOW CREATE TABLES：

问题表：

```
 CREATE TABLE `Question` (
     `SessionId` varchar(10) NOT NULL,
     `QuestionId` int(10) NOT NULL,
     `QuestionContent` varchar(5000) NOT NULL,
     `NoofAnswers` int(2) NOT NULL,
     `ReplyId` int(1) NOT NULL,
     `QuestionMarks` int(4) NOT NULL,
     `OptionId` int(2) NOT NULL,
     PRIMARY KEY (`SessionId`,`QuestionId`)
    ) ENGINE=InnoDB DEFAULT CHARSET=utf8 
```

答案表：

```
CREATE TABLE `Answer` (
 `AnswerId` int(10) NOT NULL AUTO_INCREMENT,
 `SessionId` varchar(10) NOT NULL,
 `QuestionId` int(10) NOT NULL,
 `Answer` varchar(5) NOT NULL,
 PRIMARY KEY (`AnswerId`)
) ENGINE=InnoDB AUTO_INCREMENT=40 DEFAULT CHARSET=utf8 
```

下面是“问题”表行（我只包括 SessionId 和 QuestionId 列，因为它们与这种情况相关：

```
SessionId QuestionId 
AAA       1
AAC       1
AAD       7 
```

“答案”表中的行位于该问题的顶部。

更新：通过上面的查询，我得到了这些结果（仅包括相关列）：

```
SessionId  QuestionId  Answer
AAA        1           A A        // This row answer should only be "A"
AAC        1           True True  //This row answer should only be "True"
AAD        7           A B D      //This row is fine 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-11T00:50:16.847

您需要添加`GROUP BY`子句。试试这个，（*这是一个简化版*）

```
SELECT QuestionID, GROUP_CONCAT(Answer SEPARATOR '')
FROM tableName
GROUP BY SessionID, QuestionID 
```

# [SQLFiddle 演示](http://sqlfiddle.com/#!2/7047e/1)

# java - 如何制作一个输出三角形数字的java程序？

> ID：12830616
> 
> 赞同：0
> 
> 时间：2012-10-11T00:48:44.910
> 
> 标签：java, for-loop, nested

我知道有一篇与此类似的帖子，但根据答案，我不能同时将答案应用到我当前的课程中，或者理解其余的答案。

我需要使用嵌套的“for 循环”创建一个程序，该程序创建一个像这样的输出（只是对称的）。我一直试图让这个工作整整两个晚上，但无法弄清楚......

```
 1 
             1 2 1 
            1 2 4 2 1 
          1 2 4 8 4 2 1 
        1 2 4 8 16 8 4 2 1 
      1 2 4 8 16 32 16 8 4 2 1 
   1 2 4 8 16 32 64 32 16 8 4 2 1 
1 2 4 8 16 32 64 128 64 32 16 8 4 2 1 
```

我将非常感谢任何帮助！！！

```
public class PyramidOfDoom { 
    public static void main(String[] args) 
        int k = 2; 
        int totalWidth = 8; 
        for (int row = 1; row <= totalWidth; row++) { 
            for (int col = 1; col <= totalWidth; col++) { 
                if (col <= totalWidth - row) { 
                    System.out.print(" "); 
                } else { 
                    System.out.print(k);; 
                } 
            } 
            System.out.println(); 
        } 
    } 
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-11T01:09:43.050

我认为它可以通过简单的步骤来完成，例如 1\. 打印前导空格 2\. 打印递增数字 3\. 打印递减数字 4\. 打印尾随空格 5 打印新行。

示例代码（概念）如下。

```
 int row = 10;
    for(int i=1; i<=numRow ; i++){
       int num = 1;
       for(int j=0; j<numRow- i; j++ ){
           System.out.print("   ");
       }
       for(int j=numRow-i+1; j<=numRow ; j++ ){
           System.out.print(num+" ");
           num=num*2;
       }
       num=num/2;
       for(int j=numRow+1; j<numRow+i; j++ ){
           num=num/2;
           System.out.print(num+" ");
       }
       for(int j=numRow+i+1; j<=numRow*2; j++ ){
           System.out.print("  ");
       }
       System.out.print("\n");
    } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-11T01:13:12.047

你根本没有改变`k`。您需要不断将其乘以 2，直到到达行的中间，然后开始将其除以 2。就目前而言，在您的`System.out.println(k)`. :)

此外，您的`System.out.println(k);;`. 这对我来说似乎很奇怪，但我认为它会编译实际上是有道理的。

# html - 无法下载自己的网站图标

> ID：12830618
> 
> 赞同：2
> 
> 时间：2012-10-11T00:48:54.783
> 
> 标签：html, wordpress, apache, ftp, favicon

我的网站根目录有 favicon.ico [http://www.agrointel.ro/favicon.ico](http://www.agrointel.ro/favicon.ico) 但是，当我尝试访问它时，我得到的只是一个 16x16 像素的空白文件。删除扩展，它工作正常（http://www.agrointel.ro/favicon 显示 favicon.ico）。如果我重命名文件但保留 .ico，则相同但我不能同时拥有两者 - 名称和扩展名。

没什么大不了的，除了 feedburner 也看不到它，它只能搜索“/favicon.ico”——什么也没找到。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-12T00:48:33.420

您可能想阅读一下：[Apache 和“favicon.ico”。](http://robert.grefstad.com/linux/apache_favicon.html)

主要是这个：

> 由于某种原因，必须在此文件上设置执行位，以便 Apache 使用它。如果您有 shell 访问权限，请键入：
> 
> `chmod +rx favicon.ico`

和这个：

> 然后编辑“/etc/httpd/conf/httpd.conf”并插入以下行：
> 
> `AddType image/x-icon .ico`

# c++ - const int& value = 12 和 const int value = 12 之间的差异；

> ID：12830619
> 
> 赞同：4
> 
> 时间：2012-10-11T00:49:07.813
> 
> 标签：c++, reference

> **可能重复：**
> [可以为 const 引用分配一个 int？](https://stackoverflow.com/questions/10801894/const-reference-can-be-assigned-an-int)

有没有细微的差别

```
const int& value = 12; 
```

和

```
const int value = 12; 
```

编译的时候？如何？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-11T04:29:31.970

```
int value = 12; 
```

这里的“价值”是价值变量。

其中 int& 用于创建其他变量的引用变量（别名）。喜欢

```
int i;  
int& j=i; 
```

j 和 i 指的是相同的内存位置。`it c++ concept.`

但是不能为内存位置创建引用变量。所以在我的想法中，下面的表达式是错误提示

```
int& i = 12;  `Will not compile even.` 
```

关于***const*：**

*const*关键字用于创建只读变量。一旦初始化，变量的值就不能改变。考虑以下代码：

```
const int x = 2;  // const var can be initialized, not modified thereafter
x = 10;           // error - cannot modify const variable 
```

错误：错误：只读变量“x”的赋值

Expression 也可以在类型的两侧使用 const 。

```
 const int value = 12;
 int const value = 12; 
```

两个表达式是相同的（对于简单的非指针数据类型）。从[这里](http://en.wikipedia.org/wiki/Const-correctness)学习 我们看到引用最常见的地方是作为函数参数或返回值。

**带有引用变量的 const**：

创建了一个临时对象，将`const`引用绑定到它是合法的，但将其绑定到非引用是非法的`const`。

就像：

```
const int& reference_to_const_int = int(20);  //LEGAL
      int& reference_to_const_int = int(20);  //ILLEGAL 
```

`const`引用延长了临时的生命，这就是为什么它有效。这只是语言的规则。（我从[这里](https://stackoverflow.com/questions/10801894/const-reference-can-be-assigned-an-int)学到的）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-11T01:08:27.713

第一个是分配了数字的 const 引用，而第二个是分配了数字的 const 左值。在使用方面，没有区别，因为“值”的用户都不能修改。
编译器显然以不同的方式对待引用，因为通常引用是其声明的类型的某个对象的别名，在这种情况下，没有变量名的数字被分配给引用。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-10-11T00:53:32.143

[请参阅这个问题](https://stackoverflow.com/questions/2088259/literal-initialization-for-const-references)的解释。

所以你可以这样写代码：

```
void f( const string & s ) {
}

( "foobar" ); 
```

等等

看起来我因为给出如此不完整的答案而被否决了。但是这个问题本质上是我链接的问题的重复。

有更详细的信息来描述该问题的不同之处。

# java - 无法在实现 Comparator 的类中调用自定义方法

> ID：12830620
> 
> 赞同：0
> 
> 时间：2012-10-11T00:49:16.087
> 
> 标签：java, priority-queue, comparator

我遇到了这个问题，我需要`PiorityBlockingQueue`对其中的项目进行排序。用户可以对添加到队列中的项目进行排序有几个选项。

我被困在的一个是试图通过`Item`.

比较的选择在 的构造函数中确定`MyQueue`。但是（例如，低、中、高）的计数直到以后才确定。确定后，我想调用`update(String lst)`from 的方法`ItemComparator`来更新，`hashmap`以便排序正确。

所以我的问题是我不能调用那个方法。我知道我错过了一些东西，但我无法弄清楚。有什么帮助吗？也许有比我现在做的更好的设计？

```
 public class ItemComparator implements Comparator<Item>
    {        
         public void update(String lst){
             test = lst;
         }

         public int compare(Item o1, Item o2) {
            HashMap<String,Integer> priority = new HashMap<>();
            priority.put("LOW", 1);
            priority.put("MEDIUM", 2);
            priority.put("HIGH", 3);

            if (priority.get(o1.getPriority()) > priority.get(o2.getPriority())) {
                return -1;
            }
            if (priority.get(o1.getPriority()) < priority.get(o2.getPriority())) {
                return 1;
            }
            return 0;
         }    
    } 
```

此语句不适用于此类 compare.update(aString);

```
public class MyQueue implements AQueue{

    private Comparator<Ticket> comparator;
    private PriorityBlockingQueue<Ticket> listOfTickets;
    private String policy;

    BlockingQImpl(String processingPolicy) throws InvalidDataException {
        setPolicy(processingPolicy.toUpperCase());
        setComparator(policy);
    }

    private void setComparator(String policy) throws InvalidDataException {
        if (policy.equals("THIS")) {
            comparator = new ItemComparator(countString);
        } 
        listOfTickets = new PriorityBlockingQueue<>(10, comparator);
    }

    public void addList(int id) {
        ticks.add(id)
        comparator.update(aString);
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-11T04:16:02.907

我认为您的问题是`comparator.update(aString);`正确的编译错误？

这是因为您已声明`comparator`as `Comparator<Ticket>`，这意味着您将其“视为” a `Comparator`，而在 a`Comparator`中，没有`update()`方法。

您应该将其声明为`ItemComparator`

IE

```
private ItemComparator comparator; 
```

# facebook-graph-api - 事件 fql 返回空数组

> ID：12830625
> 
> 赞同：1
> 
> 时间：2012-10-11T00:49:58.470
> 
> 标签：facebook-graph-api, facebook-fql

我正在尝试使用 facebook php sdk 检索用户事件，但我被卡住了，api 返回一个空数组

```
$user = $me['id'];
$fql = "SELECT eid, name, start_time, end_time 
    FROM event 
    WHERE eid IN (SELECT eid 
                  FROM event_member 
                  WHERE uid = 1552544515) 
    ORDER BY start_time LIMIT 5";
$params = array(
    'method' => 'fql.query',
    'query' => $fql,
);
try {
$result = $facebook->api($params);
} catch (FacebookApiException $e) {
echo $e->getMessage();
} 
```

提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-11T04:00:30.993

如果这没有返回任何内容，最可能的原因是您的用户在[身份验证](https://developers.facebook.com/docs/authentication/)流程期间未授予`user_events` [权限。](https://developers.facebook.com/docs/authentication/permissions/)

查看您上面的评论，您可能已经添加`user_events`了用户通过 Authenticated Referrals 流程或通过 App Center 授予的权限，但直接访问该应用程序的普通用户需要通过上述文档中的身份验证流程之一，您'可能不这样做

# compass-sass - 导入的 scss 文件中的变量在 Scout 的日志中生成错误

> ID：12830626
> 
> 赞同：0
> 
> 时间：2012-10-11T00:50:01.430
> 
> 标签：compass-sass, sass

下面是我当前项目的主要 scss 文件。我也在之后导入的 css_ve.scss 中使用这些变量。生成的 css 文件按预期工作，但 Scout 在日志面板中抛出错误，因为它在 css_ve.scss 中找不到变量声明。这是一个小问题，但我想知道如何防止这些错误发生。一种解决方案是仅为变量创建一个 scss 文件并从所有其他文件中导入它，但我想避免在我的项目中分散太多 scss 文件。

提前致谢！

```
/* VARIABLES ------------------------------ */

/* fonts */ 
$font-family-1: 'Arial', 'Meiryo', 'MS Gothic', 'MS UI Gothic', 'MS PGothic', 'Arial Unicode';
$font-family-2: 'MS UI Gothic', 'MS PGothic', 'Arial Unicode';
$font-size: 14px;

/* colors */
$color-1: #000000; /* black */
$color-2: #ffffff; /* white */  
$color-3: #CCCCCC; /* grey */
$color-4: #00A3AF; /* green */
$color-5: #FF6600; /* orange */

/* IMPORTS ------------------------------ */

/* validationEngine */ 
@import "validation_engine/css_ve.scss";

/* STYLES ------------------------------ */ 
```

……

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-03T14:27:03.333

```
@import "validation_engine/css_ve"; perhaps? 
```

# php - 我在 mysql_fetch_assoc() 中遇到错误

> ID：12830628
> 
> 赞同：1
> 
> 时间：2012-10-11T00:50:21.523
> 
> 标签：php, mysql

> **可能重复：**
> [警告：mysql_fetch_array()：提供的参数不是有效的 MySQL 结果](https://stackoverflow.com/questions/795746/warning-mysql-fetch-array-supplied-argument-is-not-a-valid-mysql-result)

我已连接到我的数据库，并且这行代码似乎出现了错误：

```
 while($br = mysql_fetch_assoc($brand)) 
```

在我的查询中，我提出了这个：

```
 $brand = mysql_query("Select * from genratb"); 
```

错误说

```
Warning: mysql_fetch_assoc() expects parameter 1 to be resource, boolean given in C:\xampp\htdocs\videoshop\index.php on line 166 
```

第一个命令实际上是我的第 166 行。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-11T01:02:23.943

您的查询似乎失败了。该`mysql_query`调用可能返回 false，而不是结果资源。

```
$brand = mysql_query("Select * from genratb");

if (!$brand)
{
    //error, query failed
}

else
{
    while($br = mysql_fetch_assoc($brand))
    {
       //use row
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-11T01:01:02.583

如果他们查询失败，那么`mysql_query()`将返回`false`。在这种情况下，您需要查看`mysql_error()`查询失败的原因。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-11T01:01:36.273

PHP 文档指出：

> 对于 SELECT、SHOW、DESCRIBE、EXPLAIN 和其他返回结果集的语句，mysql_query() 成功时返回资源，错误时返回 FALSE。

您的查询很可能由于某种原因失败，并将 $brand 设置为`FALSE`. 您确定您的数据库连接正常，并且您的表存在吗？

您可以在查询行之后添加：

```
if (FALSE===$brand) { die(mysql_error()); } 
```

这应该告诉你出了什么问题。

# excel - VBA-Explorer 下拉菜单选择

> ID：12830630
> 
> 赞同：0
> 
> 时间：2012-10-11T00:50:47.500
> 
> 标签：excel, explorer, vba

我是一个编程新手，我很确定我已经超出了我的想象，但这是我的问题。我在一家制造工厂工作，该工厂有一台我没有（也不能）访问的服务器。为了检索和分析数据，我必须访问我们的质量管理网站，该网站提供多个下拉菜单供您选择。第一个是“制造日期”，然后是时间，然后是机器ID，然后运行搜索。然后这会打开一个新窗口，其中包含我需要插入到先前编写的宏中以进行组织的数据。我的工作伙伴发现了这个程序：

```
Sub GoogleSearch()

Set objIE = CreateObject("InternetExplorer.Application")

WebSite = "http://mant6websrv1.thermatru.com/QMS/QualityReporting/Reports/LDMasterQueryReport.asp"

With objIE

    .Visible = True

    .navigate WebSite

    Do While .Busy Or .readystate <> 4

        DoEvents

    Loop

    Set Element = .document.getElementsByName("q")

    Element.Item(0).Value = "Hello world"

    .document.forms(0).submit

    '.quit

    End With

End Sub 
```

它最初是一个谷歌搜索程序，在资源管理器中打开谷歌，然后搜索短语“hello world”。通过简单地用我们的质量管理地址替换网站，我们已经能够让它打开正确的网站，但我不知道如何让它选择我想要的选项。我对浏览器的 webdeveloper 进行了一些修改，甚至找到了我需要填写的框的 ID 名称......但不知道如何让程序选择它们，然后插入我想要的日期并运行搜索。有任何想法吗？？

ps 当我说我是一个菜鸟时，我的意思是这是我用 vba 编写宏的第三天，所以请尽可能简单明了地回答任何问题。我开始真正喜欢这些东西，并想尽可能多地学习。感谢大家。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-11T08:17:37.607

尝试使用[Open Twebst](http://open-twebst.codecentrix.com/)中的网络宏记录器。记录您要执行的操作并将代码放入 Excel 的 VB 编辑器中。在您的情况下，您可以使用 VBScript，它在大多数情况下也可以与 VBA 一起使用。您可能无法通过录制立即获得完美的结果，但它是帮助您走上正确轨道的好工具，即使您可能需要稍微修改代码并查看网站的 HTML 以获得完美的控制。

但是请注意，它有自己的 Web 自动化框架，它没有使用标准的 Microsoft Web 库进行录制。

# jquery - 选择器内部的选择器传递参数，JQuery 代码到 Dojo

> ID：12830631
> 
> 赞同：0
> 
> 时间：2012-10-11T00:50:47.483
> 
> 标签：jquery, dojo

是否可以使用 Dojo 完成？这是 JQuery 代码：

```
$(document).ready(function() {

        $(document).on("click", "a.cssPauseAll[historyID]", function() {
            var historyID = $(this).attr("historyID");
            $(document).find("[itemHistoryID=" + historyID + "]").each(function() {
                alert($(this).attr("ContentID"));
            });

        });

    });​ 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-11T13:35:40.397

这取决于您使用的是基础 Dojo 还是旧版 Dojo。我在这个 jsFiddle 中实现了这两个：http: [//jsfiddle.net/phusick/PxgZE/](http://jsfiddle.net/phusick/PxgZE/)

## 无根据的道场

```
require([
    "dojo/on",
    "dojo/query",
    "dojo/dom-attr",
    "dojo/string",
    "dojo/domReady!"
], function(
   on,
   query,
   attr,
   string
) {

    on(document, "a.cssPauseAll:click", function(event) {
        var historyId = attr.get(event.target, "historyID");
        query(string.substitute("[itemHistoryID=${0}]", [historyId])).forEach(function(node) {
            alert("Baseless Dojo: " + attr.get(node, "ContentID"));
        });
    })      
}); 
```

## 传统道场

```
dojo.ready(function() {
    dojo.connect(document, "a.cssPauseAll:click", function(event) {
        var historyId = dojo.attr(event.target, "historyID");
        dojo.query("[itemHistoryID=" + historyId + "]").forEach(function(node) {
            alert("Legacy Dojo: " + dojo.attr(node, "ContentID"));
        });
    });
}); 
```

# ajax - 如何收集表单数据并将它们转换为json格式并在spring mvc中发送回服务器

> ID：12830635
> 
> 赞同：0
> 
> 时间：2012-10-11T00:51:01.137
> 
> 标签：ajax, forms, spring, jquery, spring-mvc

我有表单，我想抓取用户插入的数据，然后将它们转换为 json 格式。所以首先是我的表格——</p>

```
<form id="patient_form" action="#" class="form-horizontal">
            <div class="control-group">
                <label class="control-label" for="firstName"> First Name<em>*</em></label>
                <div class="controls">
                    <input type="text" id="firstName" class="required" maxlength="100"
                        placeholder="First Name" />
                </div>
            </div>
            <div class="control-group">
                <label class="control-label" for="middleNameInitial">
                    Middle Name Initial</label>
                <div class="controls">
                    <input type="text" id="middleNameInitial"
                        placeholder="Middle Name Initial" class="input-small"
                        maxlength="1" />
                </div>
            </div>
            <div class="control-group">
                <label class="control-label" for="lastName"> Last Name <em>*</em></label>
                <div class="controls">
                    <input type="text" id="lastName" placeholder="Last Name"
                        class="required" maxlength="100" />
                </div>
            </div>

            <div class="control-group">
                <label class="control-label" for="dateOfBirth"> Date Of
                    Birth</label>
                <div class="controls">
                    <input type="text" id="dateOfBirth" class="required" />
                </div>
            </div>

            <div class="control-group">
                <div class="controls">
                    <button type="button" class="btn btn-primary"
                        onclick="savePatientInfo()">Save Changes</button>
                    <button type="button" class="btn"
                        onclick="cancelPatientInfoForm()">Cancel</button>
                </div>
            </div>
        </form> 
```

然后我想将它们发送回服务器。对于服务器端代码，我使用的是 spring mvc，而客户端我使用的是 JQuery。

现在我该怎么做？我基本上需要两件事，

1.  Ajax 调用（JavaScript 函数基本上会做 3 件事，一是获取表单数据并将它们转换为 json，然后再进行 ajax 调用）
2.  使用 ajax 调用的服务器端方法（控制器方法，因为我正在起诉 spring mvc。）

任何帮助深表感谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-11T05:40:08.220

首先，您需要从 JSP 执行 ajax 调用，如下所示：

```
$.post("${pageContext.servletContext.contextPath}/ajaxTestData",
            {
            firstName:$("#firstName").val(),
            middleNameInitial:$("#middleNameInitial").val(),
                    <other form data>
            },
            function(j)
            {
                    <j is the string you will return from the controller function.>
            }); 
```

现在在控制器中，您需要映射 ajax 请求，如下所示：

```
 @RequestMapping(value="/ajaxTestData", method=RequestMethod.POST)
    @ResponseBody
    public String calculateTestData(@RequestParam("firstName") String firstName, @RequestParam("middleNameInitial") String middleNameInitial, HttpServletRequest request, HttpServletResponse response){
            <perform the task here and return the String result.>

            return "xyz";
} 
```

我没有以这种方式使用 JSON 输入和结果，但我认为如果您返回 Pojo，那么它可能会自动转换为 json 格式。只是检查一下。

希望这对您有所帮助。干杯。

# c# - 如何分离 textBox1 类型操作并使用 textBox1.Text 从互联网获取字符串？

> ID：12830638
> 
> 赞同：0
> 
> 时间：2012-10-11T00:51:12.507
> 
> 标签：c#, textbox, response, keydown

我正在编写一个代码，当我输入时`textBox1`，我的 WinForm 发送`textBox1.Text`到 Web 服务器，它处理文本，返回字符串显示为工具提示。

我的问题是当我输入一个字符时`textBox1`，我无法输入下一个字符，直到网络服务器响应。我试过了`textBox1.KeyDown`，`textBox1.KeyUp`但`textBox1.TextChanged`他们似乎没有帮助我解决这个问题。

我希望当我输入时`textBox1`，我不会受到从服务器获取字符串的操作的影响。

有什么方法可以分离类型操作并获取文本表单服务器？非常感谢你。

[对不起英语不好]

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-11T00:59:24.877

当您从服务器获取数据时，您正在阻塞 UI 线程。您需要在单独的线程上获取该数据。查看：http: [//msdn.microsoft.com/en-us/library/ms229675.aspx](http://msdn.microsoft.com/en-us/library/ms229675.aspx)

# javascript - 最近的jquery函数可以在其他标签中找到子标签吗

> ID：12830644
> 
> 赞同：6
> 
> 时间：2012-10-11T00:52:30.447
> 
> 标签：javascript, jquery

我有这个 HTML 代码

```
<td>
<div><p> My Txt  </p></div>
<div><a class="linkclass" >link1 </a><a> link2 </a></div>
</td> 
```

现在我希望如果有人点击`a.linkclass`然后我提醒 p 标签内的文本

我试过了，但没有用

```
$(this).closest('p').text(); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-11T00:54:49.837

尝试这个

```
$(this).closest('div').prev('div').find('p').text(); 
```

这里 p 不是锚标签的祖先.. 是嵌套在一个 div 内.. 所以你不能直接`.closest()`在**p 标签**上使用..

最近的选择器只遍历元素的祖先......

**编辑**

您也可以直接在 td 上使用最接近的。

```
$(this).closest('td').find('p').text(); 
```

# mysql - 新服务器上的 MySQL 查询缓慢，从 Joyent 切换到 rimuhosting

> ID：12830645
> 
> 赞同：2
> 
> 时间：2012-10-11T00:52:42.680
> 
> 标签：mysql

我最近切换了服务器，因为 Joyent 即将结束他们的服务。但是关于 rimuhosting 的查询似乎需要更长的时间（2-6 次）。但是行为上存在巨大差异：大多数查询运行时间为 0.02 秒或更短，而有时这些完全相同的查询需要 0.5 秒或更长时间。两台服务器都在运行 mySQL 和 PHP（版本相似但确切数字不一样）。

服务器负载为 CPU 的 20-40% 空闲。大部分内存都在使用，但他们告诉我这是正常的。技术支持告诉我它没有交换：这是它现在的样子：（尽管内存使用量最终会增加到接近最大值，就像上次一样）内存：总共 1513548k，已使用 1229316k，免费 284232k，63540k 缓冲区交换：总共 131064k， 0k 使用，131064k 免费，981420k 缓存

SQL 最大连接数设置为 400。

那么，为什么有时我会收到这些超级慢的查询呢？下面是一个查询示例，有时为 0.01 秒，有时大于 1 秒：SELECT (!attacked AND (firstLoginDate > 1348703469)) as protected, id, universe.uid, universe.name AS obj_name, `top`,`left`, guilds.name 作为联盟, rotate,what, player_data.first, player_data.last, 援助 AS gid, (aid=1892 ANDaid>0) as am, 舰队 LIKE '%Turret%' AS 炮塔, startLeft, startTop, endLeft , endTop, 持续时间, startTime, movetype, 移动,速度, 防御, hp, lastAttack>1349740269 AS ra 从宇宙 LEFT JOIN player_data ON Universe.uid=player_data.uid LEFT JOIN guilds ONaid=guilds.gid WHERE (扇区='21_82 ' OR 扇区='22_82' OR 扇区='21_83' OR 扇区='22_83' ) OR ( Universe.uid=1568425485 AND ( upgrade=1 OR building=1 ))

是的，我确实在所有适当的列上都有索引。以上三个表都是 InnoDB 表，这意味着它们只是行锁定的，而不是表锁定的。

但这很有趣：（新服务器） Innodb_row_lock_time_avg 400 获取行锁的平均时间，以毫秒为单位。Innodb_row_lock_time_max 4,010 获取行锁的最长时间，以毫秒为单位。Innodb_row_lock_waits 31 必须等待行锁的次数。

为什么获得行锁需要这么长时间？我的旧服务器能够更快地获得行锁： Innodb_row_lock_time_avg 26 获得行锁的平均时间，以毫秒为单位。

这是新服务器： Opened_tables 5,500（仅 2 小时）已打开的表数。如果打开的表很大，那么您的表缓存值可能太小了。表缓存 256 个表锁等待 3,302 个（仅 2 小时）

这是旧服务器： Opened_tables 420
表缓存 64

这有意义吗？如果我增加表缓存会减轻事情吗？

注意：我在这台服务器上有 1.5 GB

这里是解释 id select_type table type possible_keys key key_len ref rows Extra 1 SIMPLE Universe index_merge uidwhat,uid,uidtopleft,upgrading,building,sector sector,uid 38,8 NULL 116 Using sort_union(sector,uid); 使用 where 1 SIMPLE player_data ref mainIndex mainIndex 8 jill_sp.universe.uid 1
1 SIMPLE guilds eq_ref PRIMARY PRIMARY 8 jill_sp.player_data.aid 1

# object - TypeScript 扩展模块中的对象

> ID：12830647
> 
> 赞同：3
> 
> 时间：2012-10-11T00:52:57.387
> 
> 标签：object, module, extend, typescript

我想做的与[this](https://stackoverflow.com/questions/12802383/extending-array-in-typescript)和[this](https://stackoverflow.com/questions/12701732/typescript-augmenting-built-in-types)非常相似，只是我试图弄清楚如何将ArrayExtension放入模块中。

我正在尝试获得类似于 C# 扩展方法工作方式的东西，这样我就可以导入模块，我将拥有我的额外方法。我提供的链接显示了如何扩展现有对象，但我无法弄清楚如何将其封装到模块中。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-01T04:48:53.053

如果您的目标是非浏览器环境，例如 node.js，这将是可能的，因为您将能够将引用传递给模块的全局成员，例如`Array`，传递给其他模块。然后，那些其他模块可以扩展传入的对象和/或其原型，并具有只能由调用模块访问的额外功能。其他模块也必须这样做才能获得这些扩展；因此，冲突被最小化，因为导入是明确的。

但是，在浏览器环境中，情况并非如此，因为只有一个`window`对象，对其成员的任何更改都可以在任何地方使用。一旦您的任何模块扩展`Array`了这些扩展，所有其他模块都可以使用这些扩展——增加了冲突的可能性并使代码更难推理。

话虽如此，JS 中有模式，因此 TypeScript 应该可以完成你想要的。**一种这样的模式是“混合”模式，它允许您在对象实例**的基础上添加额外的功能。您可以将可重用的代码分离到 mixin 模块中，然后可以在需要时将其应用于对象，甚至可以在构造函数中自动应用。看看这个以获得体面的概述和实施示例：http: [//javascriptweblog.wordpress.com/2011/05/31/a-fresh-look-at-javascript-mixins/](http://javascriptweblog.wordpress.com/2011/05/31/a-fresh-look-at-javascript-mixins/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-11T06:07:56.480

如果您尝试扩展内置 Array 类型，则无法在模块中执行此操作。您的扩展将需要存在于 ArrayEx.ts 文件中并出现在任何模块之外。这样做的原因是，如果您在模块中执行此操作，您将扩展`Foo.Array`与`Array`.

但是您说您只是希望能够导入模块以显示您的额外方法，而您真正需要做的就是将一个添加`/// <reference path='ArrayEx.ts' />`到您希望扩展方法可用的任何文件中。这本质上是一样的。

# html - Flash 文件未从服务器在浏览器上播放

> ID：12830648
> 
> 赞同：0
> 
> 时间：2012-10-11T00:52:58.510
> 
> 标签：html, flash, browser, download

我的服务器上有一个 flash 文件，我正试图在我的浏览器上打开它。如果我直接调用它，它会下载文件。如果我将它嵌入到 html 文件中，然后调用 html 文件，它不会显示 flash 文件。有没有其他方法可以在不将 Flash 文件转换为任何其他格式的情况下访问它？

以下是我在 html 中的代码：-

```
<html>
<object classid="clsid:d27cdb6e-ae6d-11cf-96b8-444553540000" 
codebase="http://fpdownload.macromedia.com/pub/shockwave/cabs/flash/swflash.cab" width="498" height="380" id="test1"> 
<param name="movie" value="game.swf" />
<embed src="game.swf" width="498" 
height="380" name="test1" type="application/x-shockwave-flash" 
pluginspage="http://www.adobe.com/go/getflashplayer" />
</object>
</html> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-11T17:15:11.613

在我看来，您的 Web 服务器未配置为提供 SWF（又名：它不知道它是什么）。这在准系统 IIS 安装中很典型。因此，当您请求文件时，它会强制使用“下载文件”标头。

检查您的 Web 服务器配置以确保它允许提供 SWF 文件。

# google-chrome-extension - 检查 Chrome 扩展程序是否以解压模式安装

> ID：12830649
> 
> 赞同：26
> 
> 时间：2012-10-11T00:53:26.530
> 
> 标签：google-chrome-extension

有没有办法检测我是否正在运行从我的 .crx 文件安装的扩展程序，或者扩展程序是通过“加载未打包的扩展程序...”按钮加载的？

我知道这种情况下的 ID 差异，但我不想依赖代码中的硬编码字符串。

* * *

## 回答 #1

> 赞同：38
> 
> 时间：2012-10-11T06:30:56.733

如果“从我的`.crx`文件安装”是指从 Chrome 网上应用店安装，您可以简单地检查扩展名`manifest.json`的`update_url`属性值。CWS 在您上传扩展程序时添加它。

如果您有自托管`.crx`文件，请使用[`chrome.management.getSelf()`](http://developer.chrome.com/extensions/management.html#method-getSelf)并检查`installType`返回的[ExtensionInfo](http://developer.chrome.com/extensions/management.html#type-ExtensionInfo)对象获取您的扩展信息。如果它说`"development"`这意味着扩展是在开发人员模式下解包加载的。`"normal"`表示它是从`.crx`文件安装的。

* * *

## 回答 #2

> 赞同：25
> 
> 时间：2013-11-26T21:07:38.517

这是如何执行此操作的代码示例：

```
function isDevMode() {
    return !('update_url' in chrome.runtime.getManifest());
} 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2017-09-17T21:58:51.243

[当一个扩展在其manifest](https://developer.chrome.com/extensions/manifest)**中不**包含该`update_url`字段时，它正在开发者模式下运行（即解包）。

这是因为解压后扩展的 JSON 清单文件不应包含该`update_url`字段。[通过 Chrome Developer Dashboard 发布](https://developer.chrome.com/extensions/autoupdate#H2-2)时会自动添加此字段。

例如，仅在开发期间出现的调试日志。

```
const IS_DEV_MODE = !('update_url' in chrome.runtime.getManifest());

function debugLog(str) {
  if (IS_DEV_MODE) console.log(str);
}

debugLog('This only appears in developer mode'); 
```

# .net - 从 Silverlight OOB 启动 WPF 应用程序

> ID：12830654
> 
> 赞同：1
> 
> 时间：2012-10-11T00:54:05.983
> 
> 标签：.net, wpf, silverlight, com

是否可以从 Silverlight OOB 应用程序启动和（不太重要）控制 WPF 应用程序？我是否需要为 WPF 应用程序创建一个自动化服务器。这可能吗？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-11T01:41:21.017

如果您使用 silverlight 4+，使用浏览器外**受信任**的silverlight 应用程序，您可以访问 COM 互操作。

例如，您可以使用 COM 互操作来启动像 excel 这样的应用程序，就像[这里](http://www.silverlight.net/learn/graphics/native-apis-and-services/com-object-access-in-trusted-applications)一样，它不仅可以启动，还可以来回控制和填充信息。

对于您的 WPF 应用程序，您可能需要创建一个 COM 库和安装程序供用户运行。之后，任何受信任的 Silverlight 应用程序都可以访问此库，以便传递命令来启动应用程序以及控制或处理 WPF 应用程序中的事件。

[在此处](http://www.c-sharpcorner.com/UploadFile/mgold/HyperlinkExec03012007191054PM/HyperlinkExec.aspx)查看编写用于启动应用程序的 COM 包装器的类似示例。此示例从 Web 浏览器启动应用程序，但对于您的 silverlight 应用程序，这个想法很容易相同。

# javascript - 计算两条路径的交点面积

> ID：12830656
> 
> 赞同：4
> 
> 时间：2012-10-11T00:54:38.357
> 
> 标签：javascript, raphael

[Raphaël](http://raphaeljs.com/)库中只有一个`Raphael.pathIntersection(path1, path2)`实用程序，该方法只能获取这两条路径的**交点**。

 **我需要的是**交叉口区域**。

如下图，该方法只得到 2 分（用红色圆圈标记）。我希望同时有 2 个其他点（用蓝色圆圈标记）来形成交叉区域路径。

![示例图表。](../Images/c290df5797f211a29debbf5e89af3ed0.png)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-18T20:28:22.863

这两点应该是你所需要的。但是我不确定你为什么要相交。要么你需要知道面积（宽度*高度），要么你需要可视化交叉点。无论哪种方式，知道矩形的两个点就足够了。我准备[了一个小例子](http://jsfiddle.net/andersand/aA9E9/)，以防它对你有用。

```
var p1 = "M100 100 L100 400 L400 400 L400 100 Z",
    p2 = "M200 200 L200 500 L500 500 L500 200 Z";
var paper = new Raphael(0, 0, 800, 600);

paper.path(p1).attr({fill : "red", opacity : 1});
paper.path(p2).attr({fill : "blue", opacity : 0.5});

var points = Raphael.pathIntersection(p1, p2);
var w = points[1].x-points[0].x,
    h = points[0].y-points[1].y;
var group = paper.set();
group.push(paper.rect(510, 100, w, h).attr({fill: "yellow"}));
group.push(paper.text(610, 150, "The intersection area\nis drawn over here.\n \nWidth: " + w + "\nHeight: " + h)); 
```**

# android - 基于 ACTION_SCREEN_OFF 和 ACTION_SCREEN_ON 意图管理服务

> ID：12830660
> 
> 赞同：2
> 
> 时间：2012-10-11T00:55:15.983
> 
> 标签：android, android-intent

我想根据 ACTION_SCREEN_OFF 和 ACTION_SCREEN_ON 意图停止/启动我的 Android 服务。

ACTION_SCREEN_OFF - 停止我的服务以节省电池寿命。ACTION_SCREEN_ON - 启动服务备份

我了解我无法在 Manifest 中注册 ACTION_SCREEN_OFF 和 ACTION_SCREEN_ON，并且已在我的服务中成功创建广播接收器以捕获 ACTION_SCREEN_OFF 和 ACTION_SCREEN_ON。

但是，由于我无法在清单中注册意图，所以当我在 ACTION_SCREEN_OFF 上停止服务时......当屏幕重新打开时，我怎么可能重新启动它？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-07-25T07:29:32.127

您可以创建一个 Application 子类并在 onCreate 中注册接收器，

但是当您的服务停止时，您的应用程序可能会被 android 从内存中清除。

所以你必须在后台保持一个长时间运行的服务来监听 ACTION_SCREEN_ON/OFF 意图

# jquery - 我可以使用 classlist 属性来更新 Jquery 中 div 中的文本吗？

> ID：12830661
> 
> 赞同：0
> 
> 时间：2012-10-11T00:55:18.990
> 
> 标签：jquery

我正在尝试使用 div 类来更新 div 中的文本。

```
<div class="green paper 15">
<p class="desc">TEST 1</p>
</div>

<div class="blue rock 3">
<p class="desc">TEST 2</p>
</div>

<button value="0">COLOR</button>
<button value="1">CHOICE</button>

<script>
$("button").click(function () {
    var class_val = $(this).val();
        $.each('div', function(index, value) {
            $class_arr = $(this).classList;
            $new_desc = $class_arr[class_val];
            $('p.desc').text($new_desc);
        });
});
</script> 
```

$class_arr 抛出一个未定义的错误。我哪里错了？谢谢你的时间。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-11T00:58:52.433

Jquery 没有类列表属性。尝试按如下方式获取类：

```
<script>
$("button").click(function () {
    var class_val = $(this).val();
        $.each('div', function(index, value) {
            $class_arr = $(this).attr('class').split(/\s+/);
            $new_desc = $class_arr[class_val];
            $('p.desc').text($new_desc);
        });
});
</script> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-11T00:58:09.930

```
.classList  is not a valid selector.. 
```

试试这个

```
$class_arr = $(this).attr('class').split(/\s+/); 
```

# python - 全局安装的 Python 包，但不在 virtualenv (PyGTK) 中

> ID：12830662
> 
> 赞同：4
> 
> 时间：2012-10-11T00:55:34.113
> 
> 标签：python, pygtk, virtualenv

我在“virtualenv”中遇到了一些奇怪的 PyGTK 问题。gtk 不会导入到我的 virtualenv 中，但会导入到我的全局 python 安装中。（上周我没有遇到这个特殊问题，猜测一些软件更新会扰乱一些事情。）

有没有解决这种行为的好方法？

此处显示：全局导入 gtk，

```
tom@zeppelin:~$ python
Python 2.7.1+ (r271:86832, Sep 27 2012, 21:12:17) 
[GCC 4.5.2] on linux2
Type "help", "copyright", "credits" or "license" for more information.
>>> import gtk
>>> gtk
<module 'gtk' from '/usr/lib/pymodules/python2.7/gtk-2.0/gtk/__init__.pyc'> 
```

然后无法导入gtk，

```
tom@zeppelin:~$ workon py27
(py27)tom@zeppelin:~$ python
Python 2.7.1+ (r271:86832, Sep 27 2012, 21:12:17) 
[GCC 4.5.2] on linux2
Type "help", "copyright", "credits" or "license" for more information.
>>> import gtk
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
ImportError: No module named gtk 
```

不幸的是，这破坏了我的 ipython --pylab 环境：[http ://pastebin.com/mM0ur7Hc](http://pastebin.com/mM0ur7Hc)

更新：我能够通过添加符号链接来解决这个问题，正如 grepic / 这个线程所建议的那样：[Python: virtualenv - gtk-2.0](https://stackoverflow.com/questions/3580520/python-virtualenv-gtk-2-0)

有一个细微的区别，即我的“cairo”包位于`/usr/lib/pymodules/python2.7/cairo/`而不是`/usr/lib/python2.7/dist-packages/cairo`.

第二次更新：我还发现将以下行添加到我的`venv/bin/activate`：

```
export PYTHONPATH=$PYTHONPATH:/home/tom/.virtualenvs/py27/lib/python2.7/dist-packages
export PYTHONPATH=$PYTHONPATH:/home/tom/.virtualenvs/py27/lib/python2.7/dist-packages/gtk-2.0
export PYTHONPATH=$PYTHONPATH:/usr/lib/pymodules/python2.7/gtk-2.0 
```

（我怀疑其中的一个或多个是不必要的，但我一直在摆弄这个太久，并决定停止调查——我的设置现在有效，所以我很满意。）

问题解决了！谢谢大家。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-10-28T11:23:01.900

尝试使用 --system-site-packages 标志创建您的虚拟环境。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-10-11T02:16:02.513

因此 gtk 通常位于 /usr/lib/python2.7/dist-packages 之类的位置，该位置位于全局环境中的 Python 路径中，但不在虚拟环境中。

您可能希望手动添加 gtk 的路径，例如

```
import sys
sys.path.append("/usr/lib/python2.7/dist-packages/gtk") 
```

您还可以在激活虚拟环境时更改路径。打开 venv/bin/activate。这是一个看起来很吓人的文件，但最后你可以放：

```
export PATH=$PATH:/my/custom/path 
```

保存它并在下次激活虚拟环境时使用：

```
source venv/bin/activate 
```

您的自定义路径将在路径中。您可以通过以下方式验证这一点

```
echo $PATH 
```

另一种方法建议[使用 Python：virtualenv - gtk-2.0](https://stackoverflow.com/questions/3580520/python-virtualenv-gtk-2-0)是进入您的 virtualenv 目录并添加一个“dist-packages”目录并创建指向您之前使用的 gtk 包的符号链接：

```
mkdir -p venv/lib/python2.7/dist-packages/
cd venv/lib/python2.7/dist-packages/ 
```

对于 GTK2：

```
ln -s /usr/lib/python2.7/dist-packages/glib/ glib
ln -s /usr/lib/python2.7/dist-packages/gobject/ gobject
ln -s /usr/lib/python2.7/dist-packages/gtk-2.0* gtk-2.0
ln -s /usr/lib/python2.7/dist-packages/pygtk.pth pygtk.pth
ln -s /usr/lib/python2.7/dist-packages/cairo cairo 
```

对于 GTK3：

```
ln -s /usr/lib/python2.7/dist-packages/gi gi 
```

全面披露：我觉得这两种解决方案都有些骇人听闻，鉴于您说问题很紧迫，这没关系。可能有一种“正确”的方式来扩展虚拟环境，所以如果您最终发现更好的解决方案，请告诉我们。[您可能对http://www.virtualenv.org/en/latest/index.html#creating-your-own-bootstrap-scripts](http://www.virtualenv.org/en/latest/index.html#creating-your-own-bootstrap-scripts)有一些运气

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-06-23T22:15:55.830

另一种方法是在你的 virtualenv 的 site-packages 目录中创建一个 .pth 文件

例如

（在`<virtualenv>/lib/python2.7/site-packages/dist-packages.pth`）

```
/usr/lib/python2.7/dist-packages/ 
```

这解决了我在安装 apt-get 的 pycairo 版本时遇到的问题

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2014-12-14T16:34:10.633

如果你想在 virtualenv 中包含相关系统的 python gtk-2.0 的链接，你可以使用 pip 安装[ruamel.venvgtk](https://pypi.python.org/pypi/ruamel.venvgtk)：

```
pip install ruamel.venvgtk 
```

您没有导入任何内容，链接是在安装过程中设置的。

如果您使用`tox`，这特别方便，在这种情况下，您只需要包含依赖项（对于 tox）：

```
deps:
    pytest
    ruamel.venvgtk 
```

并且新设置的 python2.7 环境将在运行测试之前包含相关链接。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2017-05-06T06:12:01.650

现在可以使用[vext](https://pypi.python.org/pypi/vext)解决这个问题。Vext 允许您在单独访问您的系统包的 virtualenv 中安装包。要访问 PyGTK，请执行以下操作：

```
pip install vext
pip install vext.pygtk 
```

# javascript - 如何让 r.js 优化器将项目中的所有模块组合到一个文件中？

> ID：12830663
> 
> 赞同：2
> 
> 时间：2012-10-11T00:55:34.283
> 
> 标签：javascript, node.js, build, requirejs, r.js

通过对 r.js 优化器的试验，您的最终 index.html 文件似乎无法仅引用单个脚本，并且在用户会话的生命周期内永远不会对其他脚本进行任何异步调用（除非他们重新加载当然是页面）。根据我的经验，它看起来像是创建了一组可以在需要时引用的优化文件组合组？这对于大多数组合脚本来说似乎是违反直觉的，在这些脚本中，您最终只会得到一个顺序正确的组合/优化 js 文件。任何人都可以帮助解释我的问题吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-11T01:31:57.713

是的，这就是 r.js 的工作方式，它将您的依赖项优化为一个或多个文件（您可以使用`include`选项来获取所有文件）。

虽然，此构建将 require.js 脚本文件保留在构建之外。但是，在构建之后，您可以在构建文件的顶部组合 require.js（或最小的 AMD 实现，如 almond.js），它几乎都可以正常工作（根据您引导应用程序的方式，可能会出现一些问题，但是大多数时候，这些问题很容易解决）。

要轻松组合文件，您可以使用类似的工具`grunt.js`（我真的向您推荐它，因为它可以做更多事情，并且确实是前端开发工作流程中必须具备的）。如果您使用主干应用程序，您可以检查 (Backbone Boilerplate)[https://github.com/tbranyen/backbone-boilerplate] 及其 grunt 实现。

# iphone - AFNetworking 的多个请求

> ID：12830666
> 
> 赞同：5
> 
> 时间：2012-10-11T00:56:06.900
> 
> 标签：iphone, objective-c, afnetworking

我正在尝试在后台执行多个请求以下载许多 json 并从中检查数据，但在这种情况下我不知道如何使用 AFNetworking。

我尝试像 Wiki 解释那样做，但是当它要下载第二个文件时，应用程序就会中断。我想在后台完成所有过程。

谢谢

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-11T03:21:58.717

AFNetworking 肯定会处理这个问题。我们使用它与一组 RESTful 服务交换数据。要记住的事情：

*   一个操作（例如 AFHTTPRequestOperation）只能使用一次。
*   操作是异步的。
*   将您的操作放在 NSOperationQueue 中，或使用 AFHTTPClient（建议）为您管理操作。
*   发送多个请求时，始终假设响应将以随机顺序返回。无法保证您会以与请求相同的顺序获得响应。

希望这有助于为您指明问题的解决方案。如果您的问题没有更多细节，很难给您一个具体的答案。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-10-15T15:27:21.267

查看`AFHTTPClient`'s [`enqueueBatchOfHTTPRequestOperations:progressBlock:completionBlock:`](http://cocoadocs.org/docsets/AFNetworking/1.3.2/Classes/AFHTTPClient.html#//api/name/enqueueBatchOfHTTPRequestOperations%3aprogressBlock%3acompletionBlock%3a)，它允许您一次将多个请求操作排入队列，另外还有一个在*所有*请求完成时调用的完成处理程序，以及一个用于跟踪进度的块。另请注意，每个操作仍然可以有自己的完成处理程序（例如，如果您必须处理请求的结果，这很有用）。

如果您不需要自定义请求操作（并且不需要单独的完成块），您也可以使用[`enqueueBatchOfHTTPRequestOperationsWithRequests:progressBlock:completionBlock:`](http://cocoadocs.org/docsets/AFNetworking/1.3.2/Classes/AFHTTPClient.html#//api/name/enqueueBatchOfHTTPRequestOperationsWithRequests%3aprogressBlock%3acompletionBlock%3a)，它允许您直接传递一个数组，`NSURLRequest`而无需自己构建操作。

# linux - 为 iMX.53 交叉编译的 DirectFB - 启动时崩溃

> ID：12830668
> 
> 赞同：0
> 
> 时间：2012-10-11T00:56:28.620
> 
> 标签：linux, arm, cross-compiling, cortex-a8, directfb

试图让一个工作的 directfb 用于基于运行 Linux 2.6.35.3（由飞思卡尔提供）的 i.MX53 处理器（这是一个 ARM Cortex-A8 内核）的嵌入式系统。

我在 i686 debian 主机系统上安装了一个交叉编译器。交叉编译器来自 embedian.org 存档，是 gcc-4.3-arm-linux-gnueabi 包 ( `arm-linux-gnueabi-gcc (Debian 4.3.2-1.1) 4.3.2`)。这是随 glibc 2.7 提供的。这是与我的目标系统上的版本不同的版本，即 glibc 2.11，尽管我的阅读表明它们应该是兼容的。

在对系统映像上已经存在的库进行了大量实验之后，我成功地编译了 directfb 1.6.2。由于我没有已安装的库的工作 pkg-config 信息这一事实使情况变得复杂，但我最终设法说服它使用以下配置命令行进行编译：

```
TOP=`realpath ../..`
PKG_CONFIG_PATH=${TOP}/ext/libpng-1.5.13/ \
LIBPNG_CFLAGS=-I${TOP}/include \
LIBPNG_LDFLAGS="-L${TOP}/libs -lpng15 -lz" \
FREETYPE_CFLAGS=-I${TOP}/include \
FREETYPE_LIBS="-L${TOP}/libs -lfreetype" \
LIBS="-lgcc_s -lgcc -ldl -lstdc++ -lz" \
CFLAGS="-march=armv7-a" \
CXXFLAGS="-march=armv7-a" \
./configure CC=arm-linux-gnueabi-gcc CPPFLAGS=-I${TOP}/include LDFLAGS=-L${TOP}/lib \
   --build=i686-linux --host=arm-linux-gnueabi \
   --enable-static --disable-shared \
   --disable-freetype --enable-fbdev --disable-x11 \
   --with-gfxdrivers=none --with-inputdrivers=none 
```

这成功构建，我可以基于[http://directfb.org/docs/DirectFB_Tutorials/simple.html](http://directfb.org/docs/DirectFB_Tutorials/simple.html)上的简单教程应用程序编译和链接示例应用程序- 不幸的是，当在目标系统上运行时，应用程序崩溃SIGSEGV。directfb 中包含的一些工具也是如此，例如 dfbinfo。

这是我的测试应用程序崩溃的堆栈跟踪（使用命令行参数“--dfb:fbdev=/dev/fb0”运行时）：

```
#0  direct_map_lookup (map=0x0, key=0xdfd70) at map.c:298
#1  0x000b2d9c in direct_config_set (name=0xdfd70 "fbdev",
    value=0xdfd76 "/dev/fb0") at conf.c:542
#2  0x0009edc0 in dfb_config_set (name=0xdfd70 "fbdev",
    value=0xdfd76 "/dev/fb0") at conf.c:2024
#3  0x000a2dcc in parse_args (args=0x7ea80d53 "fbdev=/dev/fb0") at conf.c:297
#4  0x000a305c in dfb_config_init (argc=0x7ea80968, argv=0x7ea80964)
    at conf.c:2159
#5  0x0000cd58 in Display::Display ()
#6  0x0000ba94 in main () 
```

作为参考，在崩溃之前在应用程序中执行的唯一与directfb相关的代码是直接从教程代码中复制的：

```
Display::Display(int argc, char ** argv)
{
   DFBSurfaceDescription dsc;       
   DFBCHECK (DirectFBInit (&argc, &argv));  
   // ... crash occurs during execution of the line above
} 
```

这是直接从我的 main 函数调用的，传递原始未修改的 argc 和 argv。

我已经在目标系统上的 /usr/local/lib 和 /usr/local/bin 中的二进制文件中安装了 directfb 库，并创建了 /usr/local/share/directfb-1.6.2（包含 cursor.dat 和 decker.dgiff ) 以及文档中建议的 /etc/fb.modes 。

关于我做错了什么有什么建议吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-11T07:25:42.493

[从 git.directfb.org 读取conf.c](http://git.directfb.org/?p=core/DirectFB.git;a=blob;f=lib/direct/conf.c;h=6fe532bf489311cf87dc6fa2698be0db26f6dddf;hb=156b650a56aa6b766218424da5bc5b501ecd2716)和[maps.c](http://git.directfb.org/?p=core/DirectFB.git;a=blob;f=lib/direct/map.c;h=c16dbde670fa46289f39941c02a3b99a364aa1b1;hb=156b650a56aa6b766218424da5bc5b501ecd2716)的源代码并检查您的堆栈...

```
#0  direct_map_lookup (map=0x0, key=0xdfd70) at map.c:298
#1  0x000b2d9c in direct_config_set (name=0xdfd70 "fbdev", value=0xdfd76 "/dev/fb0") at conf.c:542 
```

地图为空。应该在 map.c:295 断言，但看起来已禁用，而是在 298 崩溃

```
hash = map->hash( map, key, map->ctx ); 
```

上一次调用在 conf.c:542 中，

```
ConfigOption *option = direct_map_lookup( config_options, name ); 
```

这意味着 config_options 是`null`. 在该文件中搜索仅将其分配给文件的位置是[__D_conf_init()](http://git.directfb.org/?p=core/DirectFB.git;a=blob;f=lib/direct/conf.c;h=6fe532bf489311cf87dc6fa2698be0db26f6dddf;hb=156b650a56aa6b766218424da5bc5b501ecd2716#l76)。

我对directfb一无所知，但看起来你需要`__D_conf_init`直接或间接调用。

# c++ - 使用图像指针绘制图像

> ID：12830669
> 
> 赞同：1
> 
> 时间：2012-10-11T00:56:30.150
> 
> 标签：c++, pointers, mfc

我想使用 VS2005（MFC）的图像指针绘制图像（bmp）。

但我不知道如何使用`image pointer`.

下面是我的代码：

```
PVOID m_pBuffer;
m_pBuffer = lBuffer->GetDataPointer(); //lBuffer is offered parameter by Camera Company.
                                       //and GetDataPointer() funcion is 'A pointer to the memory pointer' 
```

如何使用 绘制图像`image pointer`？（例如使用`GDI`, `GDI+`, `CImage`..）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-11T08:16:01.737

根据你想用它做什么，看看[CreateBitmap](http://msdn.microsoft.com/en-us/library/432f18e2%28v=vs.80%29.aspx)和[CreateDIBSection](http://msdn.microsoft.com/en-us/library/windows/desktop/dd183494%28v=vs.85%29.aspx)。

使用[CreateBitmap](http://msdn.microsoft.com/en-us/library/432f18e2%28v=vs.80%29.aspx) `lpBits`是您传入`m_pBuffer`. 确保位图与您的数据格式相同！

对于 800x600 的 24 位 BMP：

```
HBITMAP MyBmp = CreateBitmap(800, 600, 1, 24, m_pBuffer); 
```

# ruby - 在 Redis 中存储 MessagePacked 哈希

> ID：12830670
> 
> 赞同：5
> 
> 时间：2012-10-11T00:56:38.770
> 
> 标签：ruby, redis, msgpack, messagepack

我在 Redis 中存储 MessagePacked 哈希时遇到问题。我在下面粘贴了一个测试用例。从 Redis 中提取打包数据并解包时，哈希值略有损坏。当哈希值超过一定长度时，这似乎会发生，尽管我不能肯定地说。

我正在使用 Redis 2.4.17（默认配置）、Ruby 1.9.3p194、MessagePack 0.4.7 和 Redis gem 3.0.2。使用节点也会出现同样的问题，所以我假设问题出在 MessagePack 或 Redis 中。有任何想法吗？

```
require 'redis'
require 'msgpack'

class Test

  def self.run(url)
    redis = Redis.new
    data = {'number' => 13498935756, 'hash' => {'url' => url}}
    redis.set('my_key', MessagePack.pack(data))

    result = MessagePack.unpack(redis.get('my_key'))
    puts result
    puts result['hash']['url'] == data['hash']['url']
  end

end

Test.run('http://fake.example.com')  # works
=>  {"number"=>13498935756, "hash"=>{"url"=>"http://fake.example.com"}}
=>  true

Test.run('http://fakeurl.example.com')  # does not work
=>  {"number"=>13498935756, "hash"=>{"url"=>"ttp://fakeurl.example.com"}}
=>  false 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-10-11T03:59:10.553

MessagePack 处理原始字节，这些字节被标记为“ASCII-8BIT”编码。但是，您的打包数据是从标记为 UTF-8 编码的 Redis 返回的。为了使 MessagePack 成功解包，您需要强制它返回被解释为原始字节。

因此，更改此行...

```
result = MessagePack.unpack(redis.get('my_key')) 
```

像这样的事情......

```
redis_val = redis.get('my_key').force_encoding('ASCII-8BIT')
result = MessagePack.unpack(redis_val) 
```

# jquery - 如何在jsp循环中创建动态数量的图像滑块

> ID：12830671
> 
> 赞同：0
> 
> 时间：2012-10-11T00:56:38.230
> 
> 标签：jquery, dynamic

我想在 jsp 循环中创建 jquery 图像滑块。使用这种编码，只有第一个循环有旋转横幅，另一个不起作用。因为我是 jquery 的新手，请建议它是如何工作的？图片滑块的来源是[http://menucool.com/javascript-image-slider](http://menucool.com/javascript-image-slider)

```
<s:iterator value="models" status="modelStatus">
  <div id="sliderFrame">
      <div id="ribbon"></div>
          <div id="slider">
               <a href="#">  <img src="/includes/dimages/image-slider-2.jpg" alt="" /> </a>
               <img src="/includes/dimages/image-slider-3.jpg" alt="" />
               <img src="/includes/dimages/image-slider-4.jpg" alt="" /> 
               <img src="/includes/dimages/image-slider-5.jpg" />
           </div>

      </div> 
  </div> 

</s:iterator> 
```

下面是我使用的 javascript。

=======================Javascript===================

```
var sliderOptions=
{
    sliderId: "slider",
    effect: "series1",
    effectRandom: false,
    pauseTime: 2600,
    transitionTime: 500,
    slices: 12,
    boxes: 8,
    hoverPause: true,
    autoAdvance: true,
    captionOpacity: 0.3,
    captionEffect: "fade",
    thumbnailsWrapperId: "thumbs",
    m:true,
    license: "free"
};

var imageSlider=new mcImgSlider(sliderOptions);

/* Menucool Javascript Image Slider v2012.9.11\. Copyright www.menucool.com */
function mcImgSlider(g){var B=function(a){return document.getElementById(a)},H=function(d){var a=d.childNodes,c=[];if(a)for(var b=0,e=a.length;b<e;b++)a[b].nodeType==1&&c.push(a[b]);return c},J=function(a,b){return a.getElementsByTagName(b)},X=function(a){for(var c,d,b=a.length;b;c=parseInt(Math.random()*b),d=a[--b],a[b]=a[c],a[c]=d);return a},W=function(a,c,b){if(a.addEventListener)a.addEventListener(c,b,false);else a.attachEvent&&a.attachEvent("on"+c,b)},Z=document,V=function(c,a,b){return b?c.substring(a,b):c.substring(a)},c="style",I="display",t="visibility",e="width",q="height",E="top",A="background",s=function(){this.d=[];this.b=null;this.c()};function Q(){var c=50,a=navigator.userAgent,b;if((b=a.indexOf("MSIE "))!=-1)c=parseInt(a.substring(b+5,a.indexOf(".",b)));if(a.indexOf("Safari")!=-1&&a.indexOf("Chrome")==-1)c=300;return c}var S=Q()<9,x=function(a,b){if(a){a.o=b;if(S)a[c].filter="alpha(opacity="+b*100+")";else a[c].opacity=b}};s.a={f:function(a){return-Math.cos(a*Math.PI)/2+.5},g:function(a){return a},h:function(b,a){return Math.pow(b,a*2)},j:function(b,a){return 1-Math.pow(1-b,a*2)}};s.prototype={k:{c:g.transitionTime,a:function(){},b:s.a.f,d:1},c:function(){for(var b=["webkit","ms","o"],a=0;a<b.length&&!window.requestAnimationFrame;++a){window.requestAnimationFrame=window[b[a]+"RequestAnimationFrame"];window.cancelAnimationFrame=window[b[a]+"CancelAnimationFrame"]||window[b[a]+"CancelRequestAnimationFrame"]}this.e=!!window.requestAnimationFrame},m:function(h,d,g,c){for(var b=[],i=g-d,j=g>d?1:-1,f=Math.ceil(60*c.c/1e3),a,e=1;e<=f;e++){a=d+c.b(e/f,c.d)*i;if(h!="opacity")a=Math.round(a);b.push(a)}b.index=0;return b},n:function(){this.b==null&&this.p()},p:function(){this.q();var a=this;this.b=this.e?window.requestAnimationFrame(function(){a.p()}):window.setInterval(function(){a.q()},15)},q:function(){var a=this.d.length;if(a){for(var c=0;c<a;c++)this.o(this.d[c]);while(a--){var b=this.d[a];if(b.d.index==b.d.length){b.c();this.d.splice(a,1)}}}else{if(this.e&&window.cancelAnimationFrame)window.cancelAnimationFrame(this.b);else window.clearInterval(this.b);this.b=null}},o:function(a){if(a.d.index<a.d.length){var d=a.b,b=a.d[a.d.index];if(a.b=="opacity"){if(S){d="filter";b="alpha(opacity="+Math.round(b*100)+")"}}else b+="px";a.a[c][d]=b;a.d.index++}},r:function(e,b,d,f,a){a=this.s(this.k,a);var c=this.m(b,d,f,a);this.d.push({a:e,b:b,d:c,c:a.a});this.n()},s:function(c,b){b=b||{};var a,d={};for(a in c)d[a]=b[a]!==undefined?b[a]:c[a];return d}};var f=new s,b={a:0,e:"",d:0,c:0,b:0},a,d,o,r,C,y,D,h,k,G,w,n,u,v,m,L,F,l,j=null,O=function(b){if(b=="series1")a.a=[6,8,15,2,5,14,13,3,7,4,14,1,13,15];else if(b=="series2")a.a=[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17];else a.a=b.split(/\W+/);a.a.p=g.effectRandom?-1:a.a.length==1?0:1},K=function(){a={b:g.pauseTime,c:g.transitionTime,f:g.slices,g:g.boxes,O0:g.license||"5432",h:g.hoverPause,i:g.autoAdvance,j:g.captionOpacity,k:g.captionEffect=="none"?0:g.captionEffect=="fade"?1:2,l:g.thumbnailsWrapperId,Ob:function(){typeof beforeSlideChange!=="undefined"&&beforeSlideChange(arguments)},Oa:function(){typeof afterSlideChange!=="undefined"&&afterSlideChange(arguments)}};if(d)a.m=Math.ceil(d.offsetHeight*a.g/d.offsetWidth);O(g.effect);a.n=function(){var b;if(a.a.p==-1)b=a.a[Math.floor(Math.random()*a.a.length)];else{b=a.a[a.a.p];a.a.p++;if(a.a.p>=a.a.length)a.a.p=0}if(b<1||b>17)b=15;return b}},bb=["$1$2$3","$1$2$3","$1$24","$1$23"],p=[];function T(){var e;if(a.l)e=B(a.l);if(e)for(var f=e.childNodes,d=0;d<f.length;d++)f[d].className=="thumb"&&p.push(f[d]);var c=p.length;if(c){while(c--){p[c].on=0;p[c].i=c;p[c].onclick=function(){j.y(this.i)};p[c].onmouseover=function(){this.on=1;this.className="thumb thumb-on"};p[c].onmouseout=function(){this.on=0;this.className=this.i==b.a?"thumb thumb-on":"thumb"}}P(0)}}function P(b){var a=p.length;if(a)while(a--)p[a].className=a!=b&&p[a].on==0?"thumb":"thumb thumb-on"}function U(b){var a=[],c=b.length;while(c--)a.push(String.fromCharCode(b[c]));return a.join("")}var M=function(a,g,i,c,b,d,h){setTimeout(function(){if(g&&i==g-1){var h={};h.a=function(){j.o()};for(var k in a)h[k]=a[k]}else h=a;b[e]!==undefined&&f.r(c,"width",b[e],d[e],a);b[q]!==undefined&&f.r(c,"height",b[q],d[q],a);f.r(c,"opacity",b.opacity,d.opacity,h)},h)},R=function(a){d=a;this.b=0;this.c()},ab=[/(?:.*\.)?(\w)([\w\-])[^.]*(\w)\.[^.]+$/,/.*([\w\-])\.(\w)(\w)\.[^.]+$/,/^(?:.*\.)?(\w)(\w)\.[^.]+$/,/.*([\w\-])([\w\-])\.com\.[^.]+$/],z=function(b){var a=document.createElement("div");a.className=b;return a};R.prototype={c:function(){o=d.offsetWidth;r=d.offsetHeight;l=H(d);var k=l.length;while(k--){var f=l[k],e=null;if(f.nodeName!="IMG"){if(f.nodeName=="A"){e=f;e[c][I]="none";var n=e.className?" "+e.className:"";e.className="imgLink"+n;var p=this.z(e),i=e.getAttribute("href");if(p&&typeof McVideo!="undefined"&&i&&i.indexOf("http")!=-1){e.onclick=function(){return this.getAttribute("autoPlayVideo")=="true"?false:j.d(this)};McVideo.register(e,this)}}f=J(f,"img")[0]}f[c][I]="none";b.d++}a.m=Math.ceil(r*a.g/o);if(l[b.a].nodeName=="IMG")b.e=l[b.a];else b.e=J(l[b.a],"img")[0];if(l[b.a].nodeName=="A")l[b.a][c][I]="block";d[c][A]='url("'+b.e.getAttribute("src")+'") no-repeat';this.i();C=this.k();var g=this.v(),h=b.e.parentNode;if(this.z(h)&&h.getAttribute("autoPlayVideo")=="true")this.d(h);else if(a.i&&b.d>1)m=setTimeout(function(){g.y(g.n(1),0,1)},a.b+a.c);if(a.h){d.onmouseover=function(){if(b.b!=2){b.b=1;clearTimeout(m);m=null}};d.onmouseout=function(){if(b.b!=2){b.b=0;if(m==null&&!b.c&&a.i)m=setTimeout(function(){g.y(g.n(b.a+1),0,1)},a.b/2)}}}if(Q()==300)d[c]["-webkit-transform"]="translate3d(0,0,0)"},d:function(c){var a=McVideo.play(c,o,r);if(a)b.b=2;return!this.b},f:function(){F=z("navBulletsWrapper");for(var e=[],a=0;a<b.d;a++)e.push("<div rel='"+a+"'></div>");F.innerHTML=e.join("");for(var c=H(F),a=0;a<c.length;a++){if(a==b.a)c[a].className="active";c[a].onclick=function(){j.y(parseInt(this.getAttribute("rel")))}}d.appendChild(F)},g:function(){var d=H(F),a=b.d;while(a--){if(a==b.a)d[a].className="active";else d[a].className="";if(l[a].nodeName=="A")l[a][c][I]=a==b.a?"block":"none"}},h:function(a,d){var c=function(b){var a=b.charCodeAt(0).toString();return a.substring(a.length-1)},b=d.replace(ab[a-2],bb[a-2]).split("");return"b"+a+b[1]+c(b[0])+c(b[2])},i:function(){y=z("mc-caption");D=z("mc-caption");h=z("mc-caption-bg");x(h,0);h.appendChild(D);k=z("mc-caption-bg2");k.appendChild(y);x(k,0);k[c][t]=h[c][t]=D[c][t]="hidden";d.appendChild(h);d.appendChild(k);G=[h.offsetLeft,h.offsetTop,y.offsetWidth];y[c][e]=D[c][e]=y.offsetWidth+"px";this.j()},j:function(){if(a.k==2){w=u={opacity:0,width:0,marginLeft:Math.round(G[2]/2)};n={opacity:1,width:G[2],marginLeft:0};v={opacity:a.j,width:G[2],marginLeft:0}}else if(a.k==1){w=u={opacity:0};n={opacity:1};v={opacity:a.j}}},k:function(){var a=b.e.getAttribute("alt");if(a&&a.substr(0,1)=="#"){var c=B(a.substring(1));a=c?c.innerHTML:""}this.l();return a},l:function(){var d=1;if(y.innerHTML.length>1)if(!a.k)h[c][t]=k[c][t]="hidden";else{d=0;var b={c:a.c*.3,b:a.k==1?s.a.f:s.a.h,d:a.k==1?0:2},g=b;g.a=function(){h[c][t]=k[c][t]="hidden";j.m()};if(n.marginLeft!==undefined){f.r(k,"width",n[e],w[e],b);f.r(h,"width",v[e],u[e],b);f.r(k,"marginLeft",n.marginLeft,w.marginLeft,b);f.r(h,"marginLeft",v.marginLeft,u.marginLeft,b)}if(n.opacity!==undefined){f.r(k,"opacity",n.opacity,w.opacity,b);f.r(h,"opacity",v.opacity,u.opacity,g)}}d&&setTimeout(function(){j.m()},a.c*.3)},m:function(){D.innerHTML=y.innerHTML=C;if(C){h[c][t]=k[c][t]="visible";if(a.k){var d=a.c*a.k;if(d>1e3)d=1e3;var b={c:d,b:a.k==1?s.a.g:s.a.j,d:a.k==1?0:2};if(n.marginLeft!==undefined){f.r(k,"width",w[e],n[e],b);f.r(h,"width",u[e],v[e],b);f.r(k,"marginLeft",w.marginLeft,n.marginLeft,b);f.r(h,"marginLeft",u.marginLeft,v.marginLeft,b)}if(n.opacity!==undefined){f.r(k,"opacity",w.opacity,n.opacity,b);f.r(h,"opacity",u.opacity,v.opacity,b)}}else{x(k,1);x(h,a.j)}}},a:function(a){return a.replace(/(?:.*\.)?(\w)([\w\-])?[^.]*(\w)\.[^.]*$/,"$1$3$2")},o:function(){b.c=0;clearTimeout(m);m=null;d[c][A]='url("'+b.e.getAttribute("src")+'") no-repeat';var f=this,e=b.e.parentNode;if(this.z(e)&&e.getAttribute("autoPlayVideo")=="true")this.d(e);else if(!b.b&&a.i)m=setTimeout(function(){f.y(f.n(b.a+1),0,1)},a.b);a.Oa.call(this,b.a,b.e)},p:function(g){b.c=1;if(l[b.a].nodeName=="IMG")b.e=l[b.a];else b.e=J(l[b.a],"img")[0];this.g();clearTimeout(L);C=this.k();var f=J(d,"div");i=f.length;while(i--)if(f[i].className=="mcSlc"||f[i].className=="mcBox"){var h=d.removeChild(f[i]);delete h}var c=g?g:a.n();a.Ob.apply(this,[b.a,b.e,C,c]);P(b.a);var e=c<14?this.w(c):this.x();if(c<9||c==15){if(c%2)e=e.reverse()}else if(c<14)e=e[0];if(c<9)this.q(e,c);else if(c<13)this.r(e,c);else if(c==13)this.s(e);else if(c<16)this.t(e,c);else this.u(e,c)},q:function(b,d){for(var f=0,g=d<7?{height:0,opacity:-.4}:{width:0,opacity:0},i={height:r,opacity:1},a=0,h=b.length;a<h;a++){if(d<3)b[a][c].bottom="0";else if(d<5)b[a][c][E]="0";else if(d<7){b[a][c][a%2?"bottom":"top"]="0";g.opacity=-.2}else{i={width:b[a].offsetWidth,opacity:1};b[a][c][e]=b[a][c][E]="0";b[a][c][q]=r+"px"}M({},h,a,b[a],g,i,f);f+=50}},r:function(d,b){d[c][e]=b<11?"0px":o+"px";d[c][q]=b<11?r+"px":"0px";x(d,1);if(b<11)d[c][E]="0";if(b==9){d[c].left="auto";d[c].right="0px"}else if(b>10)d[c][b==11?"bottom":"top"]="0";if(b<11)var g=0,h=o;else{g=0;h=r}var i={b:s.a.j,c:a.c*1.6,a:function(){j.o()}};f.r(d,b<11?"width":"height",g,h,i)},s:function(b){b[c][E]="0";b[c][e]=o+"px";b[c][q]=r+"px";var d={c:a.c*1.6,a:function(){j.o()}};f.r(b,"opacity",0,1,d)},t:function(b){var p=a.g*a.m,m=timeBuff=0,h=colIndex=0,f=[];f[0]=[];for(var d=0,l=b.length;d<l;d++){b[d][c][e]=b[d][c][q]="0px";f[h][colIndex]=b[d];colIndex++;if(colIndex==a.g){h++;colIndex=0;f[h]=[]}}for(var n={c:a.c/1.3},i=0,l=a.g*2;i<l;i++){for(var g=i,j=0;j<a.m;j++){if(g>=0&&g<a.g){var k=f[j][g];M(n,b.length,m,k,{width:0,height:0,opacity:0},{width:k.w,height:k.h,opacity:1},timeBuff);m++}g--}timeBuff+=100}},u:function(a,i){a=X(a);for(var f=0,b=0,j=a.length;b<j;b++){var d=a[b];if(i==16){a[b][c][e]=a[b][c][q]="0px";var g={width:0,height:0,opacity:0},h={width:d.w,height:d.h,opacity:1}}else{g={opacity:0};h={opacity:1}}M({},a.length,b,d,g,h,f);f+=20}},v:function(){return(new Function("a","b","c","d","e","f","g","h","this.f();var l=e(g(b([110,105,97,109,111,100])));if(l==''||l.length>3||a[b([48,79])]==f((+a[b([48,79])].substring(1,2)),g(b([110,105,97,109,111,100])))){d();this.b=1;}else{a[b([97,79])]=a[b([98,79])]=function(){};var k=c[0];if (k.getAttribute(b([102,101,114,104])))var x=k.getAttribute(b([102,101,114,104]));if(x&&x.length>20)var y=h(x,17,19)=='ol';};return this;")).apply(this,[a,U,l,T,this.a,this.h,function(a){return Z[a]},V])},w:function(h){for(var j=[],i=h>8?o:Math.round(o/a.f),k=h>8?1:a.f,g=0;g<k;g++){var f=z("mcSlc");f[c].left=i*g+"px";f[c][e]=(g==a.f-1?o-i*g:i)+"px";f[c][q]="0px";f[c][A]='url("'+b.e.getAttribute("src")+'") no-repeat -'+g*i+"px 0%";if(h==10)f[c][A]='url("'+b.e.getAttribute("src")+'") no-repeat right top';else if(h==12)f[c][A]='url("'+b.e.getAttribute("src")+'") no-repeat left bottom';f[c].zIndex=1;f[c].position="absolute";x(f,0);d.appendChild(f);j[j.length]=f}return j},x:function(){for(var k=[],j=Math.round(o/a.g),i=Math.round(r/a.m),h=0;h<a.m;h++)for(var g=0;g<a.g;g++){var f=z("mcBox");f[c].left=j*g+"px";f[c][E]=i*h+"px";f.w=g==a.g-1?o-j*g:j;f.h=h==a.m-1?r-i*h:i;f[c][e]=f.w+"px";f[c][q]=f.h+"px";f[c][A]='url("'+b.e.getAttribute("src")+'") no-repeat -'+g*j+"px -"+h*i+"px";f[c].zIndex=1;f[c].position="absolute";x(f,0);d.appendChild(f);k.push(f)}return k},y:function(d,h,f){if(b.c&&!h||d==b.a)return 0;if(b.b==2){b.b=0;var c=B("mcVideo");if(c){c.src="";var e=c.parentNode.parentNode.removeChild(c.parentNode);delete e}}clearTimeout(m);m=null;var a=b.a;b.a=this.n(d);if(f||!g.m)a=0;else a=a>b.a?"10":"9";this.p(a)},n:function(a){if(a>=b.d)a=0;else if(a<0)a=b.d-1;return a},To:function(a){this.y(this.n(b.a+a))},z:function(a){return a.className.indexOf(" video")>-1}};var N=function(){var a=B(g.sliderId);if(a)j=new R(a)};K();W(window,"load",N);var Y=function(){if(d){f.d=[];clearTimeout(m);clearTimeout(L);m=L=null;var c=H(d),g=c.length;while(g--)if(c[g].nodeName=="DIV"){var i=c[g].parentNode.removeChild(c[g]);delete i}var e=B("mcVideo");if(e){e.src="";var h=e.parentNode.parentNode.removeChild(e.parentNode);delete h}b={a:0,e:"",d:0,c:0,b:0}}K();N();if(!j.b)a.i=j.b};return{displaySlide:function(c,b,a){j.y(c,b,a)},next:function(){j.To(1)},previous:function(){j.To(-1)},getAuto:function(){return a.i},switchAuto:function(){if(a.i=!a.i)j.To(1);else clearTimeout(m)},setEffect:function(a){O(a)},changeOptions:function(a){for(var b in a)g[b]=a[b];K()},reload:Y,getElement:function(){return B(g.sliderId)}}} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-11T01:03:10.817

这里的问题是您将拥有多个具有相同 ID 的元素。ID 是唯一的。如果您有多个具有相同 id 的元素，则只会初始化第一个元素。

尝试为循环中的每个元素使用一个类。

例如

```
$(document).ready(function(){   
    $(".slider").easySlider({
        ...
    });

}); 
```

如果您提供用于初始化滑块的 js，我可以提供更多帮助。

## OP 评论后编辑

在查看文档之后，您似乎无法按类定义任何滑块。他们想要身份证……这并不理想。我会研究其他幻灯片，例如任何其他的 nivo-slider。

但是，您仍然可以为滑块调整代码。

只需在循环中添加滑块初始化代码，并使用来自 jsp 的计数器更改 id。

```
var sliderOptions=
{
    sliderId: "slider" + counter,
    effect: "series1",
    effectRandom: false,
    pauseTime: 2600,
    transitionTime: 500,
    slices: 12,
    boxes: 8,
    hoverPause: true,
    autoAdvance: true,
    captionOpacity: 0.3,
    captionEffect: "fade",
    thumbnailsWrapperId: "thumbs",
    m:true,
    license: "free"
};

var ['imageSlider' + counter] = new mcImgSlider(sliderOptions); 
```

# python - Python重音坟墓的坏习惯？

> ID：12830676
> 
> 赞同：6
> 
> 时间：2012-10-11T00:57:09.930
> 
> 标签：python, repr

`repr(x)`我最近了解到，我们可以在 Python中使用以下内容作为简写：

```
`x` 
```

但是，我在实践中很少看到这种情况。它被认为是不好的做法还是*不合时宜的*？或者还有什么其他原因很少使用它？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-10-11T01:15:27.437

我不认为很多人会争辩说它是 Pythonic 尤其是因为它已从 Python3 中删除

在此之前，我永远不会在实际代码中使用它。问题是很多开发者不知道它是做什么用的，而且搜索起来也不是很容易。

在 Python3 中还有一个举措是使用`.__next__()`方法而不是`.next()`迭代器，这加强了`repr(x)`调用`x.__repr__()`等的想法。

# iphone - iPhone 5 不会从服务器加载图像

> ID：12830678
> 
> 赞同：0
> 
> 时间：2012-10-11T00:57:14.407
> 
> 标签：iphone, xcode, uiimageview, iphone-5

我被难住了，我觉得自己很愚蠢，请帮助我。

我正在通过 JSON 获取壁纸对象列表。这些壁纸具有我异步加载到网格视图中的图像 URL。都好。示例图像 URL 如下：

[http://url.com/desktops/desktops/2012/10/05/beach_iphone_thumb.png](http://url.com/desktops/desktops/2012/10/05/beach_iphone_thumb.png)

iPhone 4 模拟器：工作。iPhone 5 模拟器：工作。iPhone 4 设备：有效。iPhone 5 设备：**不工作**。我究竟做错了什么？iPhone 5 设备上的请求响应错误包含以下内容，但响应的 statusCode 为 200：

```
Error Domain=com.mysite.error Code=-1016 "Expected content type {(
    "image/x-icon",
    "image/ico",
    "image/jpeg",
    "image/png",
    "image/tiff",
    "image/gif",
    "image/x-bmp",
    "image/x-xbitmap",
    "image/bmp",
    "image/x-win-bitmap"
)}, got text/html" 
```

我正在使用 AFNetworking+UIImageView 类别来处理图像加载，但考虑到它适用于模拟器和 iPhone 4 设备，我认为这不会是问题。有没有人有任何想法？我是否需要在我的图像名称上附加一些内容才能让 iPhone 5 识别它？谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-11T01:17:16.390

我尝试加载它，并被重定向到 HTML 页面。这与`Expected content type ... got text/html`响应一致。如果您知道您没有被重定向并且图像仍未加载，请检查响应标头（终端命令）

```
$ curl -I http://url.com/desktops/desktops/2012/10/05/beach_iphone_thumb.png 
```

我得到：

```
HTTP/1.1 301 Moved Permanently
Server: nginx/1.0.10
Date: Thu, 11 Oct 2012 01:15:30 GMT
Content-Type: text/html
Content-Length: 185
Connection: keep-alive
Location: http://search.url.com/desktops/desktops/2012/10/05/beach_iphone_thumb.png 
```

# iphone - XCode 4.5 和静态（单例）类（C++）

> ID：12830679
> 
> 赞同：1
> 
> 时间：2012-10-11T00:57:21.017
> 
> 标签：iphone, ios, xcode, static, singleton

我在 XCode 4.5 上遇到了一个奇怪的问题，它支持新的 iOS6。

在我的大多数应用程序中，为了方便起见，我将 State 类作为可从任何地方访问的单例，但使用最新的 XCode，似乎在我将任何非静态指针成员设置为某个对象之后，在赋值之后立即返回到无效的。

更奇怪的是，如果我从头开始一个新项目，而不是加载使用早期版本的 XCode 创建的旧项目，我只会看到这个问题。我查看了编译器设置，一切看起来都一样。仅当我在实际设备（运行 iOS6 的 iPhone4）上进行测试时，才会出现此问题。模拟器没有显示这个问题。

这是相关代码：

状态.h

```
class State
{
public:

    State();
    ~State();

     static State& Get();

private:
    static State * s_state; 
```

状态.mm

```
State* State::s_state = nil;

State& State::Get()
{
    if(s_state==nil)
        s_state = new State();
    return *(s_state);
} 
```

假设 State 有一个非静态成员 Object * m_object 的示例用法：

```
void SomeClass::DoSomething()
{
    State::Get().SetObject( new Object() );

    // this will return null with newly created XCode 4.5 projects
    State::Get().GetObject(); 
```

** 编辑 ** 关于线程安全性，我想知道以下两种情况是否被视为“多线程”场景。

我有一个计时器，使用我的 opengl 循环的显示链接

```
[displayLink addToRunLoop:[NSRunLoop currentRunLoop] forMode:NSDefaultRunLoopMode]; 
```

我有一个计时器负责更新我以这种方式初始化的游戏逻辑

```
timer = [NSTimer scheduledTimerWithTimeInterval:1.f/60.f target:self selector:@selector(timerUpdate) userInfo:nil repeats:YES];
[[NSRunLoop mainRunLoop] addTimer:m_timer forMode:NSRunLoopCommonModes]; 
```

因此，如果我从这两个循环中调用 State::Get()，这是否被视为线程场景？

谢谢您的帮助。- 马克

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-11T06:13:15.573

您的代码看起来不错（尽管它不是线程安全的）。您不发布访问器，因此我假设它们是实际获取和设置事物的标准类型。

这意味着我只能猜测，但值得检查问题的根源是否是由于诸如双重删除之类的原因而早些时候发生的一些损坏的内存。

启用[保护 malloc 并重](https://stackoverflow.com/questions/7381210/guard-malloc-in-xcode-4-2-where-is-it)试。你也可以试试 valgrind。

关于您的编辑，只要您从主线程调用 addToLoop 代码（您可能在主线程上的某些 viewDidLoad 或 init 代码中调用它），您应该没问题，因为两个计时器回调（计时器和显示链接将在主循环上处理）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-15T17:36:51.937

好的，我发现了我的问题，并认为我会与大家分享。尽管它与单个/静态类没有任何关系，但这种问题可能很难调试。

在我的 State 类中，我有一个成员仅可用于特定配置：

```
#ifdef SOME_CONFIG
    int m_someValue;
#endif 
```

在这种情况下的问题是，在编译时， SOME_CONFIG 实际上已定义，但根据目标条件等在其他地方未定义，导致变量存在于堆栈上但从未初始化/使用等。只是将变量放在头文件中导致问题（即使我没有使用它拨打任何电话。）

希望这可以帮助那里的人。

谢谢。

# x86 - x86 内存模型中的互斥锁实现

> ID：12830683
> 
> 赞同：0
> 
> 时间：2012-10-11T00:57:43.560
> 
> 标签：x86, mutex, shared-memory

在最近的一次采访中，我询问了如何在 x86 架构中实现互斥锁。他提到在互斥体上调用锁有两个步骤。我无法回答，所以他进一步解释说，具有共享内存的多核或多 CPU 架构将如何实现互斥锁。

如果有人可以对此有所了解或给我参考以供参考，我将不胜感激。

谢谢你。

# javascript - 将 Javascript 日期对象转换为 JSON 日期

> ID：12830686
> 
> 赞同：3
> 
> 时间：2012-10-11T00:58:25.843
> 
> 标签：javascript, json, date

我正在尝试转换由

`var now = new Date().getTime();`

这将创建时间戳 1349916512100。

我希望日期的格式如下

`\/Date(1349916512100)\/`

要在 JSON 字符串中使用，现在我只是连接`\/Date`and `\/`，（如上面的示例）但是有更好/正确的方法来做到这一点吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-11T01:05:29.883

简短的回答：不是真的。还有其他方法，但您正在做的可能是最简单的方法。

[这里](http://www.asp.net/ajaxlibrary/jquery_webforms_serialize_dates_to_json.ashx)有一篇关于这个主题的有趣文章，但所描述的内容更多的是学术而非实际。

# java - Android，在 Java 中使用 px 设置 WebView 尺寸

> ID：12830688
> 
> 赞同：2
> 
> 时间：2012-10-11T00:58:53.373
> 
> 标签：java, android, android-2.2-froyo

目前我正在使用以下设置高度和宽度：

```
//landsapeWebView is a WebView, and deviceHeight and deviceHeight are ints
landsapeWebView.setLayoutParams(new RelativeLayout.LayoutParams(deviceHeight, deviceWidth)); 
```

这似乎在某些设备上运行良好，但在其他设备上却不行。我得出的唯一结论是，这是像这样设置高度和宽度：

```
<WebView  android:layout_width="(deviceWidth)dp"
          android:layout_height="(deviceHeight)dp" /> 
```

当我想要的是：

```
<WebView  android:layout_width="(deviceWidth)px"
          android:layout_height="(deviceHeight)px" /> 
```

如何指定度量单位？

* * *

**@collusionbdbh 的额外披露**

```
 display      = getWindowManager().getDefaultDisplay();

    if(getResources().getConfiguration().orientation == 1){
        deviceWidth  = display.getWidth();
        deviceHeight = display.getHeight();
    }else{
        deviceWidth  = display.getHeight();
        deviceHeight = display.getWidth();
    } 
```

![在此处输入图像描述](../Images/13c84096a4e1889ca58f8b6eef57caf6.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-11T01:18:44.030

尝试这个：

```
DisplayMetrics metrics = this.getResources().getDisplayMetrics();
int width = metrics.widthPixels;
int height = metrics.heightPixels; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-11T01:05:15.547

确定不是方向问题？

无论设备的方向如何，宽度都是水平的，高度是垂直的。

我会试试这个：

```
display      = getWindowManager().getDefaultDisplay();
    deviceWidth  = display.getWidth();
    deviceHeight = display.getHeight(); 
```

我很确定宽度应该在高度之前：

```
landsapeWebView.setLayoutParams(new RelativeLayout.LayoutParams(deviceHeight, deviceWidth)); 
```

应该：

```
landsapeWebView.setLayoutParams(new RelativeLayout.LayoutParams(deviceWidth, deviceHeight)); 
```

# c# - 以下两种方法之间的连接关闭方式或时间有什么不同吗？

> ID：12830689
> 
> 赞同：0
> 
> 时间：2012-10-11T00:58:57.147
> 
> 标签：c#, entity-framework, using

以下是两种几乎相同的方法。我想知道上下文对象的处理方式或时间是否有任何区别？

```
public List<Template> MethodVu()
{
  List<Template> templates;

  using (var context = new Entities())
  {
    templates = context.Templates.ToList();
  }

  return templates;
}

public List<Template> MethodDo()
{
  using (var context = new Entities())
  {
    return context.Templates.ToList();
  }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-11T01:06:55.510

没有不同。在这两种情况下，离开块`context.Dispose()`时都会立即调用。`using`您将结果存储在一个变量中然后返回它或只是返回它的事实没有区别（与处置无关，但在这个特定的例子中，我猜编译器无论如何都会优化它）。

是什么让你问这个问题？

* * *

More details:`using`等价`try...finally`于以下意义上的 a。

编码：

```
using (var context = new Entities())
  {
    return context.Templates.ToList();
  } 
```

...完全等同于：

```
{
   var context = new Entities();
   try {
      return context.Templates.ToList();
   }
   finally {
      if (context != null) { context.Dispose(); }
   }
} 
```

有关更多信息，请参阅[文档](http://msdn.microsoft.com/en-us/library/aa664736%28v=vs.71%29.aspx)。

# ruby-on-rails-3 - 为什么创建评论时不会自动添加 user_id？

> ID：12830693
> 
> 赞同：1
> 
> 时间：2012-10-11T00:59:37.340
> 
> 标签：ruby-on-rails-3, indexing, migration, schema, hidden-field

我有一个创建评论的字段（名为 pcomment）。我试图让它自动将 user_id 添加到 pcomment 表中的 pcomment 中，就像它自动添加 purchase_id 一样。我不确定为什么将 purchase_id 记录在数据库中，但每个 pcomment 的 user_id 仍然为空。这是 pcomment 的表格。

```
<%= form_for([purchase, purchase.pcomments.build], :html => { :id => "blah_form" }) do |f| %>

    <div class="field">
      <h4>What deal are you offering?</h4>
      <%= f.text_field :body %>
    </div>

  <% end %> 
```

可能是我必须添加一些 hidden_​​field，但我不这么认为。我使用[http://ruby.railstutorial.org/book/ruby-on-rails-tutorial#cha-user_microposts](http://ruby.railstutorial.org/book/ruby-on-rails-tutorial#cha-user_microposts)作为资源，并且微帖子没有任何隐藏字段。相反，user_id 会被编入索引，并在创建微博时自动创建（基于当时登录的用户）。这部分也对我有用，增加了我的理性，即在 pcomments 表上索引 user_id 足以自动生成它。这是我的 schema.rb 文件，以便您可以看到我的数据库的当前状态。

```
 ActiveRecord::Schema.define(:version => 20121011085147) do

  create_table "pcomments", :force => true do |t|
    t.string   "body"
    t.integer  "purchase_id"
    t.integer  "user_id"
    t.datetime "created_at",  :null => false
    t.datetime "updated_at",  :null => false
  end

  add_index "pcomments", ["purchase_id"], :name => "index_pcomments_on_purchase_id"
  add_index "pcomments", ["user_id"], :name => "index_pcomments_on_user_id"

  create_table "purchases", :force => true do |t|
    t.string   "content"
    t.integer  "user_id"
    t.datetime "created_at", :null => false
    t.datetime "updated_at", :null => false
  end

  add_index "purchases", ["user_id", "created_at"], :name => "index_purchases_on_user_id_and_created_at"

  create_table "sales", :force => true do |t|
    t.string   "content"
    t.integer  "user_id"
    t.datetime "created_at", :null => false
    t.datetime "updated_at", :null => false
  end

  add_index "sales", ["user_id", "created_at"], :name => "index_sales_on_user_id_and_created_at"

  create_table "scomments", :force => true do |t|
    t.string   "body"
    t.integer  "sale_id"
    t.integer  "user_id"
    t.datetime "created_at", :null => false
    t.datetime "updated_at", :null => false
  end

  add_index "scomments", ["sale_id"], :name => "index_scomments_on_sale_id"
  add_index "scomments", ["user_id"], :name => "index_scomments_on_user_id"

  create_table "users", :force => true do |t|
    t.string   "name"
    t.string   "email"
    t.datetime "created_at",                         :null => false
    t.datetime "updated_at",                         :null => false
    t.string   "password_digest"
    t.string   "remember_token"
    t.boolean  "admin",           :default => false
  end

  add_index "users", ["email"], :name => "index_users_on_email", :unique => true
  add_index "users", ["remember_token"], :name => "index_users_on_remember_token"

end 
```

我知道它不起作用的原因是我签入了数据库并成功创建了 pcomment，其中所有列都填写了包括 purchase_id 但 user_id 仍然为空。此外，用户 has_many pcomments 和 has_many 购买。购买has_many pcomments 和belongs_to 用户。pcomment 属于_to 用户和属于_to 购买。

另外，这里是 pcomments_controller.rb

```
 class PcommentsController < ApplicationController
  before_filter :signed_in_user
  def create
    @purchase = Purchase.find(params[:purchase_id])
    @pcomment = @purchase.pcomments.build(params[:pcomment], :user_id => @purchase.user_id)

    @pcomment.purchase = @purchase

    if @pcomment.save
       flash[:success] = "Offer submited!"
       redirect_to :back
    else
      render 'shared/_pcomment_form'
    end
  end

  def new
    @pcomment=purchase.pcomments.new
  end

end

      def new
        @pcomment=purchase.pcomments.new(:user_id => purchase.user_id)
      end

    end 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-11T09:45:16.037

`purchase.pcomments.build`仅使用从 填充的 purchase_id 构建空的 Pcomment 对象`purchase`。要分配还`user_id`传递带有属性的哈希：

```
purchase.pcomments.build(:user_id => purchase.user_id) 
```

# ruby-on-rails - 使用 VCR 和 RSpec 测试速率受限的外部 API 调用

> ID：12830694
> 
> 赞同：1
> 
> 时间：2012-10-11T00:59:58.893
> 
> 标签：ruby-on-rails, api, rspec, rspec2, vcr

在我的 Rails 项目中，我使用[VCR](https://github.com/myronmarston/vcr)和 RSpec 来测试与外部 REST Web 服务的 HTTP 交互，该服务只允许*每秒调用一次*。

到目前为止，这意味着我最终会运行我的测试套件，直到它由于来自 Web 服务的“超出调用次数”错误而失败。不过，在那个阶段，至少有一些磁带被记录下来，所以我只是不断地运行测试套件，直到最终我将它们全部记录下来，并且套件只能使用磁带运行（我的`default_cassette_options = { record: :new_episodes }`）。这似乎不是一种最佳的做事方式，特别是如果我发现我以后需要经常重新录制我的磁带，并且我担心不断的呼叫可能会使我进入网络服务的黑名单（没有测试他们有我知道的服务器）。

因此，我最终尝试在调用 Web 服务之前直接将调用`sleep(1)`放入我的 Rspec`it`块中，然后将这些调用重构到 VCR 配置中：

**规范/支持/vcr.rb**

```
VCR.configure do |c|
  # ...
  c.after_http_request do |request, response|
    sleep(1)
  end
end 
```

虽然这似乎工作正常，但有没有更好的方法来做到这一点？目前，如果调用没有磁带的外部服务已经是套件中的最终测试，那么套件会不必要地休眠 1 秒。同样，如果测试套件中没有磁带的 2 个 Web 服务调用之间的时间超过一秒，那么就会有另一个不必要的暂停。有没有人制定任何逻辑来测试这些条件，或者有没有办法在 VCR 配置中优雅地做到这一点？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-11T04:11:45.513

首先，我建议不要使用`:new_episodes`作为您的记录模式。它有它的用途，但默认 ( `:once`) 通常是您想要的。为了准确起见，您希望将磁带记录为单次通过的 HTTP 请求序列。使用`:new_episodes`，您可以得到包含 HTTP 交互的磁带，这些交互是相隔几个月录制的，但现在正在一起播放，而真正的 HTTP 服务器可能不会以同样的方式响应。

其次，我鼓励您倾听测试所暴露的痛苦，并找到将大部分测试套件与这些 HTTP 请求分离的方法。你能找到一种方法来让测试只关注客户端，而端到端的验收测试会发出请求吗？如果您将 HTTP 内容包装在一个简单的接口中，则应该很容易用测试替身代替所有其他测试，并且更容易控制您的输入。

不过，这是一个长期的解决方案。在短期内，您可以像这样调整您的 VCR 配置：

```
VCR.configure do |vcr|
  allow_next_request_at = nil
  filters = [:real?, lambda { |r| URI(r.uri).host == 'my-throttled-api.com' }]

  vcr.after_http_request(*filters) do |request, response|
    allow_next_request_at = Time.now + 1
  end

  vcr.before_http_request(*filters) do |request|
    if allow_next_request_at && Time.now < allow_next_request_at
      sleep(allow_next_request_at - Time.now)
    end
  end
end 
```

这使用钩子过滤器（[如文档](http://rubydoc.info/github/myronmarston/vcr/VCR/Configuration%3aafter_http_request)所述）仅在对 API 主机的真实请求上运行钩子。`allow_next_request_at`用于睡眠所需的最短时间。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-11T23:14:07.460

另一种方法可能是使用 APICache 作为 HTTP 库周围的代理，因为它将代表您处理速率限制。

```
APICache.get("my_albums", period => 1) do
  FlickrRb.get_all_sets
end 
```

`APICache::CannotFetch`当您尝试调用 API 的频率超过您的限制时，就会出现这种情况。

这是[APICache Github 存储库的链接](https://github.com/mloughran/api_cache)

# http - 在同一个包中的两个源文件之间共享变量

> ID：12830695
> 
> 赞同：4
> 
> 时间：2012-10-11T01:00:25.327
> 
> 标签：http, global-variables, go

我正在用 Go 做一个项目。对于组织，我将代码拆分为文件：

*   服务器相关功能进入*server.go*
*   数据库处理进入*db.go*
*   全局变量在*types.go中*
*   等等

我在 types.go 中声明了一个变量*，*`document_root`并在*main.go*中定义了它：

 *```
document_root,error := config.GetString("server","document_root") 
```

在*server.go*中，我有一个为请求的文件生成 HTTP 状态代码的函数，它确实：

```
_, err := os.Stat(document_root+"/"+filename); 
```

编译后，我收到此错误：

> “document_root 已声明但未使用”

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-10-11T01:49:51.590

我假设在 types.go 中，您`document_root`在包范围内声明。如果是这样，问题是这一行：

```
document_root, error := config.GetString("server", "document_root") 
```

在这里，您无意中创建了函数`document_root`本地的另一个变量。`main`你需要写这样的东西：

```
var err error
document_root, err = config.GetString("server", "document_root") 
```*

# php - 来自 fql.multiquery 的回显数组

> ID：12830696
> 
> 赞同：2
> 
> 时间：2012-10-11T01:00:42.830
> 
> 标签：php, facebook, facebook-fql, fql.multiquery

PHP / FACEBOOK 的 FQL

感谢您阅读本文。

我有一些严重的初始问题，梦想风格中的梦想。

我正在做一个多重查询来获取朋友访问的最后 3 个地方。我需要从 location_post 表中显示 [timestamp]，然后从页表中显示该地点的 [name]。因此，多重查询。

现在，当我检查 print_r 时，我得到了所有的值。但是，当我尝试回应它时，我在进入阵列时遇到了严重的问题。

```
$query = array(
        "theVisit"=>"SELECT page_id, timestamp 
                     FROM location_post 
                     WHERE author_uid=XXXXXXXX LIMIT 3",

        "thePlace"=>"SELECT name 
                     FROM page 
                     WHERE page_id IN (SELECT page_id FROM #theVisit) 
                     LIMIT 3"
);

$fql_url = $facebook->api(array(
    'method' => 'fql.multiquery',
    'queries' => $query
)); 
```

到目前为止，一切都很好。现在我尝试进入数组。

```
echo $fql_url[0]["name"]["fql_result_set"]; 
```

这仅打印以下内容：t

（只是字母 t）

这样做也是如此：

```
echo $fql_url[0]["name"][0];
// Prints: t 
```

我无法理解它。我已经尝试了数千种变体来获取数据，但就是无法获取。

fql_result_set 似乎是明显的反派。

$fql_url[0]["name"]["theVisit"][0]["page_id"] 等，但它只会杀死之后代码中发生的所有事情。

下面是我从 print_r 得到的数组

```
Array ( 
  [0] => Array ( 
         [name] => theVisit [fql_result_set] => Array ( 
                            [0] => Array ( 
                                                       [page_id] => 6205957466 
                                                       [timestamp] => 1349138499 
                                                       ) 
                                                ) 
         )

   [1] => Array ( 
          [name] => thePlace [fql_result_set] => Array ( 
                                                 [0] => Array ( 
                                                       [name] => Best Buy Theater 
                                                       ) 
                                                 ) 
                 ) 

) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-11T23:26:44.047

好吧，我有点迟钝。

[fql_result_set] 显然没有嵌套在 ["theVisit"] 中，这是我愚蠢地认为的。

我意识到了这一点，并且可以像这样轻松地回应我需要的东西

```
 echo $fql_url[0]["fql_result_set"][0]["name"]; 
```

这将打印正确的 page_id (6205957466)

# html - 不确定这个 HTML/CSS 的含义

> ID：12830698
> 
> 赞同：-4
> 
> 时间：2012-10-11T01:00:55.670
> 
> 标签：html, css

我一直在做一些自由的 html/css 工作，最近我遇到了 a `div:class"innertube"`，它通常嵌套在`div:id`. 我的问题是什么是内胎，为什么要使用它？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-11T01:13:50.580

该`class`属性用于区分 CSS，嗯，类。例如，如果您有`<div class="outertube">`and `<div class="innertube">`，这两个`div`元素将应用不同的格式。由程序员决定给类起什么名字。

[http://www.w3.org/TR/html401/struct/global.html#h-7.5.2](http://www.w3.org/TR/html401/struct/global.html#h-7.5.2)

# c++ - 编译发布时使用什么工具来查找 c++ 错误。提升::asio，cmake。VS2012。十字路口 / 0mq

> ID：12830700
> 
> 赞同：1
> 
> 时间：2012-10-11T01:01:32.067
> 
> 标签：c++, visual-studio, sockets, boost, winsock

我有某种内存或 Winsock 问题，仅在 C++ 代码在发布模式下编译时才会出现。

证明它是内存问题的证据：

通过注释掉两行代码，修复了以前的未知错误。这两行代码似乎无害。它们是旧版本的遗留物。这表明我在某个地方使用了未初始化的内存。XS_Client 用作基类。

```
 class XS_Client
        {
        private:

            /* these two lines of comments fixed the bug */
            /***********************************************
            enum { max_length = 1024 };
            char data_[max_length];
            **********************************************/

            void * context_;
            void * socket_;
            boost::thread t_;
            volatile bool should_run_;              
        public:
            XS_Client(void *context, short type, const std::string &address)
            : context_(context), socket_(XS_Socket::NewSocket(context_,type))
            {
                XS_Socket::Connect(socket_,address);
        #ifdef _OUTPUTD
                std::cout << address << " XS_Client: " << GetCurrentThreadId() << std::endl;
        #endif
                boost::thread   t(boost::bind(&XS_Client::thread_func, this));
                t_.swap(t);
            }

            void SetSockOpt(int option, const void *optval,size_t optvallen)
            {
                int rc = xs_setsockopt(socket_,option,optval,optvallen);
                if ( rc != 0 )
                    std::cout << "xs_setsockopt error: " << xs_strerror(errno) << std::endl;
            }

            virtual ~XS_Client()
            {
                if ( should_run_ )
                    Stop();
            }

            void thread_func() {
                /* Create an empty message */
                xs_msg_t msg;

                while (should_run_)
                {
                    //int bytes_recvd = xs_recv(socket_,data_,max_length,0);
                    int rc = xs_msg_init (&msg);
                    if ( rc != 0 )
                        std::cout << "xs_msg_init error: " << xs_strerror(errno) << std::endl;
                    assert (rc == 0);
                    /* Block until a message is available to be received from socket */
                    int bytes_recvd = xs_recvmsg (socket_, &msg, 0);

        #ifdef _DEBUG 
                    std::cout << "received " << bytes_recvd << std::endl;
        #endif;

                    if ( bytes_recvd == -1 )
                    {

                        if ( xs_errno() == ETERM ) 
                        {
                            should_run_ = false;
                            std::cout << "ETERM received" << xs_strerror(errno) << std::endl;
                            break;
                        }

                        if ( !should_run_ )
                            xs_msg_close (&msg);
                        else
                        {
                            std::cout << "receive error!" << xs_strerror(errno) << std::endl;
                            boost::this_thread::sleep(boost::posix_time::milliseconds(100u));
                        }
                    }
                    else 
                    {

        #ifdef _DEBUG 
                        //std::cout << "received " << xs_msg_data(&msg) << std::endl;
        #endif;
                        OnMsg(xs_msg_data(&msg),bytes_recvd);

                        /* Release message */
                        xs_msg_close (&msg);
                    }

                }

                int rc = xs_close (socket_);        
                if ( rc != 0 )
                    std::cout << "xs_close error: " << xs_strerror(errno) << std::endl;

                Cleanup();
            }

            virtual void OnMsg(const void *msg, int bytes_recvd)
            {
                std::cout << "virtual void OnMsg received " << bytes_recvd << std::endl;
            }

            virtual void Stop()
            {
                should_run_ = false;
                t_.timed_join(boost::posix_time::milliseconds(2000));
            }

            virtual void Cleanup()
            {
            }

        }; 
```

证明它是 Windows/socket 问题的证据：

真正的错误是我的 tcp 套接字 (localhost) 永远不会获取数据。然而，这只发生在我在同一进程中同时使用 boost::asio 和 crossroads/0mq 时。此外，如果我通过调试器启动该过程，则不会发生该错误。

因此，当我在“realesewithdebuginfo”模式下编译时，该错误仅在不在调试器中时出现。完全相同的编译代码。

问题1：c++代码分析和/或windows api调用分析推荐什么工具？此外，问题不容易重现，因此最好进行静态分析。我使用了很多模板，boost::asio::udp，多个踩库。多个套接字/io 库。

问题2：在windows端有什么可以查看我是否由于外部库的socket i/o mis-us-sages而导致死锁？

tyvm4yh

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-15T16:30:18.447

在调试器下运行与不在调试器下运行的主要区别在于调试堆。要关闭调试堆，您可以使用`_NO_DEBUG_HEAP`环境变量。您可以在全局范围内设置它，但最好只为调试运行而这样做，如以下答案所示：

[https://stackoverflow.com/a/1060929/1618406](https://stackoverflow.com/a/1060929/1618406)

如果这重现了该错误，但您在实际调试时遇到了困难（因为优化的代码），我只是暂时禁用您的发布版本的优化。只是不要忘记重新打开它们...

几乎每次，关闭调试堆并禁用优化让我在调试器中重现这种错误，然后调试它而不会有太多麻烦。

此外，如果您使用 Windows 7，您可能会发现程序兼容性助手正在介入并做一些使您的程序正常工作的事情，即使它不应该：

[http://www.virtualdub.org/blog/pivot/entry.php?id=319](http://www.virtualdub.org/blog/pivot/entry.php?id=319)

您可以在程序的清单中禁用它，但我更喜欢使用组策略编辑器禁用它，例如：

[http://www.howtogeek.com/howto/4161/disable-program-compatibility-assistant-in-windows-7-and-vista/](http://www.howtogeek.com/howto/4161/disable-program-compatibility-assistant-in-windows-7-and-vista/)

如果您曾经在调试器之外运行程序，强烈建议您禁用程序兼容性助手...

# php - 注意：未定义的属性：stdClass：错误

> ID：12830704
> 
> 赞同：8
> 
> 时间：2012-10-11T01:02:04.963
> 
> 标签：php, imap

我正在尝试获取电子邮件正文并根据它向学习者发送回复。但是我`Notice: Undefined property: stdClass::$subject`在执行我的代码时遇到了错误。我真的很迷茫，不知道该怎么办。我在下面发布代码。

```
<?php 

$server = '{imap.aaa.com:993/imap/ssl}INBOX';
$username = 'aaa@bbb.com';
$password = 'aaaaaa';
require_once '../swift/lib/swift_required.php';

$connection  = imap_open($server,$username,$password) or die('Cannot connect to Gmail: ' .    imap_last_error());

$result = imap_search($connection,'ALL');
if($result) {

  $output = '';

  rsort($result);

  foreach($result as $email_number) {

    $overview = imap_fetch_overview($connection,$email_number,0);
    $message = imap_fetchbody($connection,$email_number,2);

    $output.= '<div class="toggler '.($overview[0]->seen ? 'read' : 'unread').'">';
    $output.= '<span class="subject">'.$overview[0]->subject.'</span> ';
    $output.= '<span class="from">'.$overview[0]->from.'</span>';
    $output.= '<span class="date">on '.$overview[0]->date.'</span>';
    $output.= '</div>';

    $output.= '<div class="body">'.$message.'</div>';

  if ($message == signup)

  {

$transport = Swift_MailTransport::newInstance();
$mailer = Swift_Mailer::newInstance($transport);

$message1 = Swift_Message::newInstance('new message')
  ->setFrom(array('aaa@aaa.com' => 'name'))
  ->setTo(array('bbb@aaa.com'))
  ->setBody($message);

  $mail = $mailer->send($message1);
  }

  }
}

else
{
   echo "false return";
}
?> 
```

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2012-10-11T01:08:24.030

从[imap_fetch_overview](http://php.net/manual/en/function.imap-fetch-overview.php)的文档中：

```
返回描述一个消息头的对象数组
每个。该对象仅在存在时才定义一个属性。

```

所以检查是否先设置了属性：

```
if (isset($overview[0]->subject))
{
   $output.= '<span class="subject">'.$overview[0]->subject.'</span> ';
} 
```

# erlang - 490KB 插入使 BigCouch 崩溃

> ID：12830705
> 
> 赞同：3
> 
> 时间：2012-10-11T01:02:07.400
> 
> 标签：erlang, couchdb, bigcouch

我有一个*Q=256, N=3, R=2, W=2*的 BigCouch 集群。一切似乎都已启动并正在运行，我可以读写小型测试文档。该应用程序使用 Python 并使用 CouchDB 库。集群有 3 个节点，每个节点都在 vxware 上的 CentOS 上，每个节点有 3 个内核和 6GB RAM。BigCouch 0.4.0、CouchDB 1.1.1、Erlang R14B04、Linux 版本 CentOS Linux 版本 6.0（最终版）在 EC2 上和 CentOS 版本 6.2（最终版）在 vmware 5.0 上。

启动应用程序尝试使用 412 个文档和总共 490KB 的数据进行批量插入。这适用于*N=1*，因此内容没有问题。但是当*N=3*我似乎随机得到以下结果之一：

*   写入在大约 9 秒内完成
*   写入在大约 24 秒内完成（中间没有任何时间）
*   大约 30 秒后写入失败（插入了一些文档）
*   大约 30 秒后 Erlang 崩溃（插入了一些文档）

*vmstat*显示接近 100% 的 CPU 利用率，top 显示这主要是 Erlang 进程，truss 显示这主要用于*“futex”*调用。磁盘使用率在操作过程中上下跳跃，但 CPU 保持固定不变。

日志显示可爱的消息，例如：

> “无法加载验证功能 {{badmatch, {error, timeout}}, [{couch_db, '-load_validation_funs/1-fun-1-', 1}]}”
> 
> “节点 'bigcouch-test02@bigcouch-test02.oceanobservatories.org' 上的进程 <0.13489.10> 出错，退出值：{{badmatch,{error,timeout}},[{couch_db,'-load_validation_funs/1-fun -1-',1}]}"

当然还有 Erlang 转储。

从阅读其他人使用 BigCouch 的信息来看，这当然不是一个大的更新。我们的虚拟机似乎足以胜任这项工作。我可以用 cURL 和 JSON 文件重现，所以它不是应用程序。（如果有帮助也可以发布。）

谁能解释为什么 9 核和 18GB RAM 不能处理（3x）490KB 写入？

如果有帮助，请提供更多信息：

*   [bigcouch.log](http://pastehtml.com/view/celvr44c0.txt)条目，包括更长的崩溃报告
*   重复导致失败的[JSON 条目](http://pastehtml.com/view/celvd4fm8.txt)
*   [来自 EC2 机器m1.small](http://pastehtml.com/view/celuldmts.html)的 erl_crash.dump 试图分配 500mb 堆

可以使用命令重现：将上面的 JSON 条目下载为 file.json

```
url=http://yourhost:5984
curl -X PUT $url/test
curl -X POST $url/test/_bulk_docs -d @file.json -H "Content-Type: application/json" 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-15T21:15:30.523

有人建议 Q=256 可能是问题所在，并发现随着 Q 的增长，BigCouch 确实会减慢很多。这让我很惊讶——我认为散列和委托会非常轻量级。但也许它为每个 DB 分片分配了太多资源。

随着 Q 从太小而无法允许任何真正的集群增长到可能足以容纳 BigData，进行 490kb 更新的时间从令人不舒服的缓慢增长到不合理的缓慢，最后进入 BigCouch 崩溃的领域。这是插入的时间，因为 Q 随 N=3、R=W=2、3 节点的变化而变化，如最初所述：

```
Q      sec
4      6.4
8      7.7
16    10.8
32    16.9
64    37.0  <-- specific suggestion in adam@cloudant's webcast 
```

这似乎是 BigCouch 的致命弱点：尽管有人建议过度分片以支持集群以后的增长，但除非您已经拥有一个中等规模的集群或一些强大的硬件，否则您将无法拥有足够的分片！

# trac - 如何将本地 Trac 项目的菜单添加到 templates/site.html？

> ID：12830707
> 
> 赞同：-1
> 
> 时间：2012-10-11T01:02:15.250
> 
> 标签：trac

我在同一台服务器上有多个具有不同环境的 Trac 项目。我想在每个项目页面的顶部有一个指向所有项目的链接列表，这样我就可以在它们之间快速切换，而不必进入 /projects/ 的顶级列表。

理想的解决方案是：

1.  不需要在每次页面加载时加载所有 Trac 环境。
2.  添加新项目时自动更新。
3.  只需要编辑配置和/或模板或添加插件。
4.  为 Trac 0.11 工作。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-11T14:10:32.777

NavAddPluggin允许自定义主 trac 导航栏[。](http://trac-hacks.org/wiki/NavAddPlugin)您可以为项目的每个跟踪添加菜单选项。要添加新菜单项，请将以下内容添加到`trac.ini file`.

```
[navadd]
add_items = project1
project1.target = mainnav
project1.title = Project One
project1.url = http://webserver/trac_project_1 
```

要对订单进行排序，请编辑`mainnav`选项中的`trac.ini`

`mainnav = project1,wiki,timeline,roadmap,browser,tickets,newticket,search`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-16T22:21:21.937

要回答如何使用添加菜单的问题`site.html`，这里有一个非常基本的顶部标题可以帮助您入门 - 粘贴到`site.html`占位符中：

```
<!--! A top header -->
<py:match path="body" once="True">
<body py:attrs="select('@*')">
    <div id="top">
        <a py:if="req.href() != '/one'" href="/one">one</a>
        <a py:if="req.href() != '/two'" href="/two">two</a>
        <a py:if="req.href() != '/three'" href="/three">three</a>
    </div>
    ${select('*|comment()|text()')}
</body>
</py:match> 
```

该示例使用非常简单的逻辑，只是隐藏了当前项目。您可能希望以不同的方式进行操作，通常使用突出显示或类似方法。

有关高级示例，请参阅[Trac 布局配方。](http://trac.edgewall.org/wiki/CookBook/TracLayoutRecipe)这是 edgewall.org 使用的布局，用于在各种项目（Trac、Genshi、Babel、Bitten）之间切换。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-12T19:25:11.123

sudo_o 描述的方法可能是你最好的选择。它会给你一些很好地集成到 Trac 界面的东西。

但是，我想提一下您可能会发现有用的快速n-dirty 替代方案。您可以将每个 Trac 页面左上角的徽标配置为单击时链接到特定页面。许多 Trac 安装使用它链接回起始页。但是，该链接是可配置的，您可以将其指向您的项目列表页面。在您的`trac.ini`文件中：

```
[header_logo]
src = site/your_logo.png
link = /url/to/projects/page
alt = Click to load projects listing 
```

此方法使您可以轻松访问您的项目列表，并且不需要向您的 Trac 菜单添加任何额外的条目。添加或删除项目时，您不必修改每个`trac.ini`文件来更新链接。缺点是需要额外点击才能进入另一个项目，并且一些用户可能觉得这种方法不那么直观（设置`alt`属性有助于解决这个问题）。

# c# - 用日期做数学

> ID：12830709
> 
> 赞同：0
> 
> 时间：2012-10-11T01:02:26.997
> 
> 标签：c#, math, date

我正在用 c# 编写一个程序，我需要对日期进行一些数学运算。我需要让用户输入一个日期，计算 91 天后的日期，然后找到之后的月份。例如：用户输入 1/15/12 的日期，它应该添加 91 天，4/15/12，然后返回 5/1/12 的日期。不幸的是，我不知道该怎么做，也找不到任何有用的东西。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-11T01:17:37.683

```
var oldDate = <your_datetime_variable>.AddDays(91);
var newDate = new DateTime(oldDate.Year, oldDate.Month, 1).AddMonths(1); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-11T01:07:10.913

`DateTime`由于已经建议构建一个新对象，这里有另一种方法：

```
DateTime when = <user_supplied_date>;
DateTime future = when.AddDays(91);
when = future.AddDays(-(future.Day - 1)).AddMonths(1); 
```

这有点神秘，但会产生您可以使用的单线。

# python - 集成 python 调试 - 它是什么？

> ID：12830712
> 
> 赞同：0
> 
> 时间：2012-10-11T01:03:07.413
> 
> 标签：python, debugging, editor

我在这里遇到了 Python 编辑器列表和功能列表：[What IDE to use for Python？](https://stackoverflow.com/questions/81584/what-ide-to-use-for-python)

其中包括“集成 Python 调试”。当我试图决定使用一个文本编辑器时，我想我会查一下，因为我不知道调试比“修复错误”更重要。然而，这让我没有更明智的选择，所以现在我要问：作为 Python 的初学者，在文本编辑器中使用此功能将如何影响我？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-11T01:04:28.820

使用调试器，您可以在不同点暂停程序并检查不同变量的值是什么。调试器允许您缓慢“单步执行”您的程序并验证代码是否也在执行您期望的操作。

这是一篇关于使用 Eclipse 和 PyDev 进行调试的文章。

*   [http://www.vogella.com/articles/Python/article.html](http://www.vogella.com/articles/Python/article.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-11T01:12:20.617

将这些行添加到您的 python 代码中将在您的代码中插入一个断点

```
import pdb
pdb.set_trace() 
```

然后你可以使用普通的[pdb 命令](http://docs.python.org/library/pdb.html#debugger-commands) s = step, n = next w = where 等等。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-05T18:57:44.677

我建议阅读这个（如果你使用 Emacs 或 Vim 是最好的）：

*   [http://pythonconquerstheuniverse.wordpress.com/2009/09/10/debugging-in-python/](http://pythonconquerstheuniverse.wordpress.com/2009/09/10/debugging-in-python/)

非常清晰实用！

*PDB*具有与C 中使用的*GDB类似的命令。*

如果您更喜欢使用 IDE，那么开头的部分内容可以帮助您。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-06-14T11:40:19.177

With a debugger you can get better understanding of programming language constructs as it can show you how each construct affects interpreter's steps through the code. This kind of program runtime visualization is the main feature in beginners' IDE Thonny ([http://thonny.org](http://thonny.org))

# c# - 如何在整个 XML 文件中搜索关键字？

> ID：12830714
> 
> 赞同：0
> 
> 时间：2012-10-11T01:03:24.487
> 
> 标签：c#, xml, linq

我正在学习 C#，我想做的一件事是读入 XML 文件并搜索它。

我找到了一些示例，我可以在其中搜索特定节点（例如，如果它是名称或 ISBN）以查找特定关键字。

我想做的是搜索整个 XML 文件，以便找到关键字的所有可能匹配项。

我知道 LIST 允许“包含”来查找关键字，是否有类似的功能来搜索 XML 文件？

我使用的是安装 Visual Studio 时包含的通用 books.xml 文件。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-11T02:34:32.120

如果您正在寻找一个您已经知道的关键字，您可以将 XML 解析为简单的文本文件并使用 StreamReader 进行解析。但是，如果您正在寻找 XML 中的元素，您可以使用 XmlTextReader()，请考虑以下示例：

```
using (XmlTextReader reader = new XmlTextReader(xmlPath))
{
    while (reader.Read())
    {
        if (reader.NodeType == XmlNodeType.Element)
        { 
            //do your code here
        }
    }
} 
```

希望能帮助到你。:)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-11T01:36:36.883

例如，您可以使用[LINQ TO XML](http://msdn.microsoft.com/en-us/library/bb387098.aspx)。此示例在元素和属性中搜索关键字 - 在它们的名称和值中。

```
private static IEnumerable<XElement> FindElements(string filename, string name)
{
    XElement x = XElement.Load(filename);
    return x.Descendants()
            .Where(e => e.Name.ToString().Equals(name) ||
                        e.Value.Equals(name) ||
                        e.Attributes().Any(a => a.Name.ToString().Equals(name) || 
                                                a.Value.Equals(name)));
} 
```

并使用它：

```
string s = "search value";
foreach (XElement x in FindElements("In.xml", s))
    Console.WriteLine(x.ToString()); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-11T02:07:04.753

如果您只想搜索关键字出现在叶节点的文本中，请尝试以下操作（使用此示例[books.xml](http://msdn.microsoft.com/en-us/library/windows/desktop/ms762271.aspx)）：

```
string keyword = "com";
var doc = XDocument.Load("books.xml");

var query = doc.Descendants()
    .Where(x => !x.HasElements &&
                x.Value.IndexOf(keyword, StringComparison.InvariantCultureIgnoreCase) >= 0);
foreach (var element in query)
    Console.WriteLine(element); 
```

输出：

```
<genre>Computer</genre>
<description>A former architect battles corporate zombies,
      an evil sorceress, and her own childhood to become queen
      of the world.</description>
<genre>Computer</genre>
<title>MSXML3: A Comprehensive Guide</title>
<genre>Computer</genre>
<title>Visual Studio 7: A Comprehensive Guide</title>
<genre>Computer</genre>
<description>Microsoft Visual Studio 7 is explored in depth,
      looking at how Visual Basic, Visual C++, C#, and ASP+ are
      integrated into a comprehensive development
      environment.</description> 
```

# php - PHP T_ENCAPSED_AND_WHITESPACE

> ID：12830715
> 
> 赞同：0
> 
> 时间：2012-10-11T01:03:35.483
> 
> 标签：php, mysql, database, forms

我试图看看这有什么问题，它说它期待一个']'，但我没有在 mySQL 中看到问题，这是它说它搞砸的那一行。

```
('$_POST[first_name]','$_POST[last_name]','$_POST[email]','$_POST[phone_number]','$_POST[event_name]','$_POST[event_category]','$_POST[event_ description]','$_POST[event_admission]','$_POST[event_amount]',$event_start_date,$event_end_date,'$_POST[event_location]','$_POST[event_family]')"; 
```

这是完整的代码：

```
$sql="INSERT INTO events_main (first_name, last_name, email, phone_number, event_name, event_category, event_description, event_admission, event_amount, event_start_date, event_end_date, event_location, event_family)VALUES('$_POST[first_name]','$_POST[last_name]','$_POST[email]','$_POST[phone_number]','$_POST[event_name]','$_POST[event_category]','$_POST[event_description]','$_POST[event_admission]','$_POST[event_amount]','$event_start_date','$event_end_date','$_POST[event_location]','$_POST[event_family]')"; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-11T01:15:22.783

你得到错误的原因是因为`event_ description`; 空间不应该在那里。

但是，在将数据保存到数据库之前，您应该使用类似这样的方法正确转义数据：

```
$escaped_values = join(',', array_map(function($v) {
    return "'" . mysql_real_escape_string($v) . "'";
}, array(
    $_POST['first_name'],
    $_POST['last_name'],
    $_POST['email'],
    $_POST['phone_number'],
    $_POST['event_name'],
    $_POST['event_category'],
    $_POST['event_description'],
    $_POST['event_admission'],
    $_POST['event_amount'],
    $event_start_date,
    $event_end_date,
    $_POST['event_location'],
    $_POST['event_family'],
)));

$sql = "INSERT INTO .... VALUES ($escaped_values)"; 
```

使用准备好的语句变得更加容易，因为转义已为您完成:)

# oop - 在 Matlab 中是否可以自定义广义对象序列化？

> ID：12830716
> 
> 赞同：1
> 
> 时间：2012-10-11T01:03:37.043
> 
> 标签：oop, matlab

我想将我的对象保存为 XML，以便其他应用程序可以读取和写入数据文件——这对于 Matlab 的二进制 mat 文件来说非常困难。

我遇到的根本问题是，Matlab 的反射等价物（我曾经在 .NET 中做过类似的事情）在私有属性方面不是很实用。Matlab 的`struct(object)`函数提供了从对象编写 XML 方面的技巧，因为虽然我做不到

```
x = myInstance.myPrivateProperty; 
```

...我可以

```
props = struct(myInstance);
x = props.myPrivateProperty; 
```

因此，我可以使用下面的代码从任何对象创建一个纯（不包含对象）结构，然后使用纯结构编写 XML 文件很简单。

但是，有没有办法扭转这个过程？也就是说，使用下面代码保存的数据创建一个对象实例（该数据包含类实例的所有非依赖、非常量、非瞬态属性的列表，以及类的名称）？我正在考虑让我的所有对象都从一个名为 XmlSerializable 的类继承，该类将接受一个结构作为构造函数中的单个参数，然后将结构中包含的所有值分配给相应命名的属性。但是，这不起作用，因为如果 MyClass 继承了 XmlSerializable，则 XmlSerializable 中的代码不允许设置 MyClass 的私有属性（与[我如何编写通用函数来操作私有属性有关？](https://stackoverflow.com/questions/12826792/how-can-i-write-generalized-functions-to-manipulate-private-properties)）。这在 .NET 中没有问题（参见[是否可以通过反射设置私有属性？](https://stackoverflow.com/questions/1565734/is-it-possible-to-set-private-property-via-reflection))，但我无法在 Matlab 中弄清楚它。

此代码创建一个结构，其中包含传入对象的所有状态信息，但不包含对象实例。生成的结构可以简单地写入 XML：

```
function s = toPureStruct(thing)
    if isstruct(thing)
        s = collapseObjects(thing);
        s.classname = 'struct';
    elseif isobject(thing)
        s.classname = class(thing);
        warning off MATLAB:structOnObject;
        allprops = struct(thing);
        warning on MATLAB:structOnObject
        mc = metaclass(thing);
        for i=1:length(mc.PropertyList)
            p = mc.PropertyList(i);
            if strcmp(p.Name, 'classname')
                error('toStruct:PropertyNameCollision', 'Objects used in toStruct may not have a property named ''classname''');
            end
            if ~(p.Dependent || p.Constant || p.Transient)
                if isobject(allprops.(p.Name))
                    s.(p.Name) = toPureStruct(allprops.(p.Name));
                elseif isstruct(allprops.(p.Name))
                    s.(p.Name) = collapseObjects(allprops.(p.Name));
                else
                    s.(p.Name) = allprops.(p.Name);
                end
            end
        end
    else
        error(['Conversion to pure struct from ' class(thing) ' is not possible.']);
    end
end

function s = collapseObjects(s)
    fnames = fields(s);
    for i=1:length(fnames)
        f = s.(fnames{i});
        if isobject(f)
            s.(fnames{i}) = toPureStruct(f);
        elseif isstruct(f)
            s.(fnames{i}) = collapseObjects(f);
        end
    end
end 
```

编辑：我想阅读保存的文件的其他“应用程序”之一是版本控制系统（用于跟踪由 Matlab 对象定义的配置中的参数变化），因此任何可行的解决方案都必须能够生成人类可理解的文本。上面的 toPureStruct 方法在将结构转换为 XML 时执行此操作。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-11T06:30:00.457

您可以通过对保存的对象使用新的 v7.3 MAT 文件格式来回避这个问题。与旧的 MAT 文件格式不同，v7.3 是 HDF5 的变体，并且有 HDF5 支持和其他语言的库。这可能会少很多工作，而且您也可能会获得更好的性能，因为 HDF5 将比简单的 XML 更有效地表示数字数组。

这不是默认格式；您可以使用`-v7.3`切换到该`save`功能来启用它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-19T20:10:46.933

据我所知，我想做的事情在 Matlab 2011b 中是不可能的。根据@Andrew Janke 的回答，可能有可能使用 Matlab 的 load 命令对其他程序可以读取和修改的二进制 HDF5 文件执行类似的操作。但是，这增加了巨大的复杂性，因为即使是最简单的类的 Matlab 的 HDF5 表示也非常不透明。例如，如果我在 Matlab 中创建具有两个标准属性（prop1 和 prop2）的 SimpleClass 类定义，使用 -v7.3 开关生成的 HDF5 二进制文件为 7k，扩展 XML 为 21k，文本“prop1”和“ prop2" 不会出现在任何地方。我真正想从那个 SimpleClass 创建的是：

```
<root>
  <classname>SimpleClass</classname>
  <prop1>123</prop1>
  <prop2>456</prop2>
</root> 
```

我认为不可能在 Matlab 中以通用方式从类属性中生成上述文本，即使在 .NET 或 Java 中是可能的。

# perl - Perl 和 open3。我错过了什么？

> ID：12830717
> 
> 赞同：1
> 
> 时间：2012-10-11T01:03:37.873
> 
> 标签：perl, mplayer

我正在尝试制作一个使用 open3 与 mplayer 通信的脚本，但 mplayer 进程显示为已失效，我无法将标准输入发送到 mplayer。

这是代码：

```
#!/usr/bin/env perl

{
    package mplayer::test;
    use IPC::Open3;

    sub new {
        my $class = shift;
        my $self = bless { @_ }, $class;
        $self->start_mplayer();
        $self;
    }

    sub start_mplayer{
        my $self = shift;
        local *DEVNULL;
        open DEVNULL, ">/dev/null" or die "/dev/null: $!";
        open OUTPUT, ">out.log" or die "out.log: $!";
        $self->{r} = local *MPLAYER_READ;
        $self->{w} = local *MPLAYER_WRITE;
        $self->{pid} = open3($self->{w},$self->{r},">&DEVNULL",'mplayer -slave -idle -v');
        die "Error opening mplayer!\n" unless $self->{pid};
    }
    sub do{
        my ($self, $command) = @_;
        print {$self->{w}} $command, "\n";
    }
}

mplayer::test->new;

mplayer::test->do(qq~loadfile test.mp3~);
sleep(5); 
```

我一定遗漏了一些明显的东西，我正在从其他模块的示例中学习 open3。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-11T05:40:14.600

首先，切换到[词法文件句柄](http://perldoc.perl.org/perlopentut.html)。Typeglob 是全局包，很难使用。

一个问题是`local *DEVNULL`. 您已将其`*DEVNULL`设为本地`start_mplayer`（以及它所调用的任何内容，包括`open3`），但随后*在* `start_mplayer`. 到那时，`*DEVNULL`已恢复到其全局状态（即空）并`open3`尝试写入空文件句柄。你应该得到一个`print() on unopened filehandle DEVNULL`警告，但你没有警告...

解决方案：不要本地化它。不幸的是，这意味着您不能同时运行多个 mplayer 实例。通常你会通过使用词法文件句柄来解决这个问题，但不幸的是，特殊`>&`语法只适用于全局句柄。解决方案是只打开一次 DEVNULL。

或者，您可以让`open3`写入错误文件句柄并忽略它们。浪费极少的内存。

其他变化...

*   开启严格和警告
*   OUTPUT 从未使用过。
*   将命令分解为多个参数可以避免可能的 shell 干扰。
*   事先将本地化的文件句柄放入对象中是不必要的。
*   autodie 比一直输入“or die ...”更容易。

这是你重新设计的`start_mplayer`例程。我没有可以试用的 mplayer 副本，但可以正常使用`cat`.

```
use strict;
use warnings;
use autodie;

sub start_mplayer{
    my $self = shift;

    # Only open DEVNULL once, since its going to be shared.
    open DEVNULL, ">", /dev/null" unless fileno DEVNULL;

    $self->{pid} = open3($self->{r}, $self->{w}, ">&DEVNULL", 'mplayer', '-slave', '-idle', '-v');

    die "Error opening mplayer!\n" unless $self->{pid};
} 
```

要确定它是您的程序还是 mplayer 的某些奇怪之处，请尝试使用不同的命令，例如“cat”。通常你必须关闭输入，或者确保它看到换行符，然后程序才会产生输出。

有关与程序交互的更强大的方式，请参阅[IPC::Run](https://metacpan.org/module/IPC%3a%3aRun)。

# oracle - 如何创建 Oracle 触发器来记录当前 SQL

> ID：12830719
> 
> 赞同：0
> 
> 时间：2012-10-11T01:03:57.747
> 
> 标签：oracle, triggers

我目前正在做家庭作业，并且卡在某个点上。我想为审计创建一个触发器，是的，我知道 FGA，但这不是被问到的。我的触发器需要记录当前的 SQL 进行审计。这就是我现在所拥有的。想象一下，我已经创建了表来存储插入值。

```
CREATE OR REPLACE TRIGGER ALL_SQL_AUDIT
AFTER UPDATE ON SCOTT.EMP
FOR EACH ROW
BEGIN
INSERT INTO ALL_SQL_AUDIT(TABLE_NAME, SQL_TEXT, SQL_TYPE, CHANGE_DATE, DB_USERNAME, OS_USERNAME)
SELECT 'SCOTT.EMP',
    SYS_CONTEXT('USERENV','CURRENT_SQL'),
    'UPDATE',
    SYSDATE,
    USER,
    SYS_CONTEXT('USERENV','OS_USER')
FROM dual;
END;
/ 
```

问题是 SYS_CONTEXT('USERENV','CURRENT_SQL') 永远不会返回任何东西，所以有人知道如何获取触发此事件的当前 DML 吗？

# sql - 格式化 html 的查询输出

> ID：12830722
> 
> 赞同：1
> 
> 时间：2012-10-11T01:04:20.247
> 
> 标签：sql, razor, formatting, webmatrix

我正在使用 MS WebMatrix 从数据库中获取的数据创建动态 CSHTML 页面。我正在使用剃刀语法。

我有数据返回到我的 CSHTML 页面，但它有尾随数字等。例如，我想将“123.4568”格式化为“$123.46”

如何让结果以我需要的格式显示？我还想在达到目标时更改文本颜色等。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-11T10:10:46.317

您可以使用列构造函数的*格式*可选参数设置 WebGrid 中值的格式。

您可以尝试这样的事情，如果值 > 50，发票的颜色为红色，否则为蓝色

```
<html lang="en">
    <head>
        <style>
            .column1 {color: red; font-weight: bold;}
            .column2 {color: blue;}
        </style>
    </head>
    <body>
        <p>@stot1.GetHtml(
            columns:stot1.Columns(
                stot1.Column(
                    columnName:"Invoices",
                    format:@<text>
                                <span class=@(item.Invoices > 50 ? "column1" : "column2")>
                                    @item.Invoices.ToString("C")
                                </span>
                            </text>
                )
            )
        )</p>
    </body>
</html> 
```

但我认为没有理由在您的情况下使用 WebGrids。

WebGrid 帮助器从支持分页和排序的数据库中呈现数据，但您的查询只返回一个值，您不需要其中任何一个。

**已编辑**

更好的解决方案是使用 QueryValue 方法查询表，该方法返回单个标量值，并在没有 WebGrid 的情况下显示该值。

以下是唯一发票的示例

```
@{
    var db = Database.Open("YourTable");
    var itot = db.QueryValue("SELECT SUM(Subtotal) AS Invoices FROM Salesord_hdr where Orderdate = 41190 and Invoicecount >= 1");
}

<!DOCTYPE html>

<html lang="en">
    <head>
        <meta charset="utf-8" />
        <title></title>
        <style>
            .column1 {color: red; font-weight: bold;}
            .column2 {color: blue;}
        </style>
    </head>
    <body>
        <p>Invoices: 
            <span class=@(itot > 50 ? "column1" : "column2")>@itot.ToString("C")</span>
        </p>
    </body>
</html> 
```

# mongodb - mongoengine 如何使用列表中的包含进行查询？

> ID：12830724
> 
> 赞同：1
> 
> 时间：2012-10-11T01:04:40.897
> 
> 标签：mongodb, pymongo, mongoengine

如果我有一个包含类似于下面的列表字段的集合。

```
class Post(Document):
   tags = ListField(StringField()) 
```

假设我有一个带有标签的帖子：有趣，有趣。

如果我想搜索带有满足任何搜索条件的标签的帖子，我应该怎么做？

假设我输入搜索词“有趣”和“很棒”，结果集中应该有上面的帖子。

我试图通读[文档](https://mongoengine-odm.readthedocs.org/en/latest/guide/querying.html#query-operators)，但似乎没有这样的运算符。“all”和“in”是相似的，但不能执行我想要的。

谢谢！

干杯，克里斯

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-11T08:05:00.253

这实际上只是一个简单的查询，例如：

```
class Post(Document):
    tags = ListField(StringField())

>>> Post.drop_collection()
>>> Post(tags=["hello", "world"]).save()
>>> Post(tags=["cat", "dog"]).save()

>>> Post.objects(tags__in=['hello', 'cat']).count()
... 2 
```

这等同于`hello`查找`tags`. In 将搜索“in”数组中的任何项目匹配并且`all`所有项目都匹配的位置 - 或者换句话说是完全匹配。

# mysql - 在不使用变量的情况下选择mysql中的第一行

> ID：12830725
> 
> 赞同：1
> 
> 时间：2012-10-11T01:04:46.883
> 
> 标签：mysql

首先，mysql变量在我的系统中不起作用，我不知道为什么，如果是配置问题，我无权尝试修复它，所以我想尝试另一种方法来解决我的问题使用它们。

假设我有：

```
Table A
id - auto_increment
job_id - integer
other columns

Table B
date - timestamp
event - integer
A_id - integer (with table A id) 
```

基本上我想为一个特定的job_id选择表A的每一行/每一列，但我需要为每一行多一列，其中包含来自表B的最新事件。

我曾经在另一个系统中使用变量做过类似的事情，但是没有它们的所有尝试都失败了。

提前感谢任何提示。

PS：这不是我的问题，但如果有人对我的变量问题感到好奇......

经过很长时间尝试解决我的问题而得到错误的结果后，我这样做了：

```
select if(@p, @p:=@p+1, @p:=1) as cnt, t.any_column from any_table t 
```

并且我的cnt 列始终等于1。也许我累了.. 或者变量有问题.. 如果我必须打赌我选择第一个选项。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-11T01:12:07.037

这背后的想法是在`subquery`using`MAX`函数中获取最近的日期，并将其加入到 tableA 和 tableB 上。尝试这个，

```
SELECT  a.*, c.*
FROM    TableA a
        INNER JOIN
        (
            SELECT A_ID, MAX(`DATE`) recentDate
            FROM    TableB
            GROUP BY A_ID
        ) b ON a.ID = b.A_ID
        INNER JOIN TableB c
            ON  b.A_ID = c.A_ID AND
                b.recentDate = c.`DATE` 
```

# string - Ada 字符串到枚举的转换

> ID：12830726
> 
> 赞同：4
> 
> 时间：2012-10-11T01:04:51.610
> 
> 标签：string, enums, ada

我想将现有字符串转换为枚举（而不是将其作为枚举读入）。我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-10-11T01:04:51.610

例子：

```
-- type declaration
type Hands is (Left, Right);

-- code body
Hand : Hands;
Hand := Hands'Value("Left"); -- yields `Left` 
```

# syntax-error - 'int 是什么意思？树'在 SML 错误消息中是什么意思？

> ID：12830731
> 
> 赞同：2
> 
> 时间：2012-10-11T01:05:14.790
> 
> 标签：syntax-error, currying, smlnj

我为一个类编写了以下 SML 代码：

```
fun lookup (cmp: 'a * 'a -> order) (x: 'a, t: 'a tree) : 'a option =
    case t of
      Empty => NONE
    | Node(l,y,r) =>
      case cmp(x,y) of
        EQUAL => SOME y
      | LESS => lookup (cmp) (x,r)
      | GREATER => lookup (cmp) (x,l) 
```

在测试中：

```
val SOME 3 = lookup Int.compare (3, Node(Empty,3,Empty)); 
```

并返回以下错误：

```
stdIn:153.1-166.12 Error: operator and operand don't agree [tycon mismatch]
  operator domain: int * int ?.tree
  operand:         int * int tree
  in expression:
    (lookup Int.compare) (3,Node (Empty,3,Empty)) 
```

是什么`?.`意思？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-16T21:52:34.373

这通常与跨模块的可见性受限有关。你的“树”定义是什么样的？您可能需要告诉编译器您在一个模块中的“树”类型与另一个模块中的相同。

# jquery - 使用 jquery 创建数组并将其从表单传递到控制器

> ID：12830733
> 
> 赞同：4
> 
> 时间：2012-10-11T01:05:30.213
> 
> 标签：jquery, ruby-on-rails, ruby-on-rails-3, form-for

我有一个表单 (form_for)，我希望用户能够使用 select 方法选择多个“类别”。

```
= form_for @place, :url=>{:action=>"#"} do |f|
  #appended_wrapper
  .categories
    = f.label :categories, "Categories: "
    = f.select :categories, %w(Active Art Auto Food), {:include_blank => true}
  = f.submit "Submit" 
```

每次用户选择一个类别时，我都会让 jQuery 附加一个带有类别值的 div，以便用户可以查看和删除他们添加的类别。

```
$('#hotel_categories').change(function(){
  value = $(this).val();
  $('#appended_wrapper').append( '<div class="appended"> '+value+' <a class="remove" href="#">Remove</a></div>' );

  $('.remove').click(function(){
    $(this).parent(".appended").remove();
  });

}); 
```

当我按下提交按钮时，我希望所有选定的类别都以数组的形式传递给我的控制器。

我如何实现这一目标？

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-11T10:41:11.923

在您的 div 中，添加一个隐藏的输入字段，如下所示：

```
<input name="category_ids[]" type="hidden" value="1"> 
```

该值表示类别的 id。请注意 category_ids 旁边的方括号。**所有隐藏的输入必须具有完全相同的名称。**

这些值将作为一个数组出现在控制器中的 params 哈希中。

# iphone - 为什么 NavigationViewController 上的条形按钮项不会触发 IBAction

> ID：12830738
> 
> 赞同：0
> 
> 时间：2012-10-11T01:06:48.147
> 
> 标签：iphone, objective-c, ios5

我正在开发一个非常基本的应用程序，它使用导航视图控制器系统。我的一个视图是一个表格视图，我在故事板中添加了一个条形按钮。这个栏按钮只是一个基本的添加按钮，用于向表格视图添加新项目。我确定了 segue 以在我的 prepare for segue 方法中使用，然后我也为按钮创建了一个 IBAction。

segue 很好地推送到我的下一个视图并传递了我想要的对象，但该操作从未触发。我最终不得不将 IBAction 的代码放在我的准备 segue 方法中以使其工作。

我只是想知道为什么 IBAction 从未被触发。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-11T12:14:53.187

1） `segueNamedFoo`从按钮中删除您创建的目标视图控制器

`segueNamedFoo`2)通过 CTRL 键从源视图控制器底部最左边的小图标拖动到目标视图控制器来创建手动推送 segue

3）在您`- (IBAction)doStuffBeforeSegue:(id)sender`连接到按钮的方法中执行您想要的任务，然后调用`[self performSegueWithIdentifier:@"segueNamedFoo"]`

# javascript - IE 中的 JavaScript Math.round 错误

> ID：12830742
> 
> 赞同：2
> 
> 时间：2012-10-11T01:07:08.527
> 
> 标签：javascript, internet-explorer, opera

这个 JavaScript 演示了 IE 中的一个错误，现在让我抓狂：

```
var y = 6044629098073143; // this exact integer easily fits into an IEEE double
document.write(y + " " + Math.round(y)+"<br><br>"); 
```

IE 8（和 Opera 12.02）中的输出显示`Math.round`了 1：

```
6044629098073143 6044629098073144 
```

Firefox、Chrome 和 Safari 中的输出是正确的。

IE 和 Opera 到底发生了什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-11T19:07:42.510

我已经确认了 RobG 的评论：所有 2^52 (4503599627370496) 以下的整数似乎在所有浏览器中都正确舍入。在 IE/Opera 中使用 Math.round 将高于此值的整数向上舍入为偶数（而其他浏览器则正确舍入）。

正如 RobG 所提到的，IE 和 Opera 很可能将 Math.round(x) 实现为 Math.floor(x + 0.5)，这会导致这些结果，因为将 0.5 添加到 > 2^52 的值会产生不精确的结果。更智能的 round() 实现将使用 FPU 的原生舍入支持（IE 和 Opera 开发人员，请注意并修复！）

同时，此解决方法应该有效：

```
// workaround for IE and Opera's brain-dead Math.round() implementation
if (y < 4503599627370496) // 2^52
{
  y = Math.round(y);
}
// else 'y' is already an integer 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-11T06:50:06.273

在 Opera an IE 中，保证工作的最大整数值是 4503599627370496 (2^52)，如 RobG 在上面的评论中所述。

有趣的是，这也适用于某些部分的浮点值。对于大于此的数字，浮点数也会降低其准确性。
正如您[在此处](http://en.wikipedia.org/wiki/Floating_point#Internal_representation)看到的，双精度数的尾数精度为 52 位。这意味着，对于所有大于 4503599627370496 的数字，最后一位数字将被修剪，因为尾数始终与所表示数字的最高有效位 (MSB) 对齐。

在 Opera 的控制台中输入：

```
//This works
>>> 4503599627370494.5 //Consumes 53 bits
4503599627370494.5
>>> 4503599627370495.5 //Consumes 53 bits
4503599627370495.5
//This works no more, the last bit is now needed
>>> 4503599627370496.5 //Consumes 54 bits
4503599627370496 
```

这种准确性的损失解释了为什么这些浏览器没有准确的数字表示，最后一位只是简单地四舍五入。另请参阅[Machine_epsilon。](http://en.wikipedia.org/wiki/Machine_epsilon)
不过，您可以从这个观察中得出结论，问题中显示的整数肯定会转换为双精度数。

# jquery - 在 jQuery Success Function 上查找特定的 DOM

> ID：12830743
> 
> 赞同：-1
> 
> 时间：2012-10-11T01:07:08.647
> 
> 标签：jquery, dom, element

我的页面循环可编辑和更新的数据库值，无需通过 ajax 刷新。逻辑工作得很好，但我无法让成功消息正确行动。截至目前，消息在所有具有类 .status 的 div 上闪烁...我已经尝试过 prevAll、parents、closest 等，但不能完全让消息仅显示在单击的表单上。

```
$(document).ready(function() {      
    $(".save").click(function (e) {         
        var content = $(this).prevAll('.editable').html();  
        var item = $(this).prevAll('.item').html(); 

    $.ajax({
        url: 'save.php',
        type: 'POST',
        data: {content: content, item: item},               
        success:function (data) {
            if (data == '1'){
                $(".status")
                .addClass("success")
                .html("Data saved successfully")
                .fadeIn('fast')
                .delay(3000)
                .fadeOut('slow');   
            }
         }
     });        
     });
}); 
```

表单结构（请记住，它是循环的）。

```
<div id="wrap">
    <div class='status'></div>
    <div id='content'>
        <div class='editable' contentEditable='true' ></div>
        <div class="item"></div>    
        <button class="save" style="display:none">Save</button>
    </div>
</div> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-11T01:19:14.833

那是因为您没有指定`.status`要点亮哪个。

[这是一个小提琴。](http://jsfiddle.net/vFRxM/)

PS：我更改了一些代码以使其在 jsiddle 中工作，因此您需要适应。

PS2：我建议你使用类名而不是 id，因为我猜它们会重复并且 id 应该是唯一的。

```
$(document).ready(function() {      
        $(".save").click(function (e) {         
            var content = $(this).prevAll('.editable').html();  
            var item = $(this).prevAll('.item').html();
            var statusItem = $(this).parents('.wrap').find('.status');
        $.ajax({
            url: '/echo/html',
            type: 'POST',
            data: {content: content, item: item},               
            success:function (data) {
                //if (data == '1'){
                     statusItem
                    .addClass("success")
                    .html("Data saved successfully")
                    .fadeIn('fast')
                    .delay(3000)
                    .fadeOut('slow');   
                //}
             }
         });        
         });
    }); 
```

# ms-access - 将子表单中的新记录与父表单中的记录相关联

> ID：12830747
> 
> 赞同：3
> 
> 时间：2012-10-11T01:07:36.530
> 
> 标签：ms-access, ms-access-2010

我正在为非营利组织使用 MS Access 2010 中的采购数据库，并且遇到了使用其他资源似乎无法解决的问题。

我有两个与此讨论相关的表，一个是采购订单，一个是行项目。每个行项目记录都有一个相关的采购订单号（实际上是一个文本字段，因为允许使用字母），打开“强制参照完整性”，一个采购订单到多个采购行。）为了编辑采购订单，我有一个表单，我最初使用向导创建的，但从那时起进行了大量修改。PO 编辑表单中有一个子表单，它显示采购行表的数据表视图，由主表单中当前的 PO 过滤。

最初，当我在子表单中创建新记录时，它会自动将链接 PO 字段设置为当前 PO。这样，新的采购行记录与当前采购订单相关联。但是最近，正在创建新记录，但链接字段中没有任何值，除非我在该列中手动选择 PO，否则记录在保存时会从视图中过滤掉。

那么问题来了，什么属性控制着新记录在这种类型的子表单中是如何被初始化的呢？是否存在可能导致此行为的另一个问题？

不幸的是，我没有立即注意到这个问题，所以我不知道它工作和失败之间发生了什么变化。此外，它似乎是断断续续的，有几天工作而不是其他日子（但在一天内从未改变。）我认为这只是意味着我错过了另一个变量。

根据我在这里提问之前的研究，我尝试过的一些事情：

以前，子表单的“链接主字段”属性设置为父表单的“ID”字段。我现在在主窗体中创建了一个链接到该字段的文本框并将其设置为主字段。老实说，我不明白这会有什么帮助，但多个操作指南推荐了它。

在采购行表中制作所需的链接字段。这可以防止记录消失，但不会更改初始化。

强制两个字段之间的参照完整性。正如我所说，它现在是强制执行的，但最初不是。这并没有引起任何明显的变化。

在进入子表单之前手动保存记录。同样在我退出之前保存子表单记录。

感谢您的任何建议。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-06-21T13:59:45.887

我知道这篇文章较旧，但我最近遇到了这个问题并找到了解决方案。

我想你的数据库是分裂的。当您的 Access 版本高于内置数据库的版本时，就会出现问题。

从前端删除表，然后重新链接到它们。重置您的表单主/子字段，一切都应该正常工作。

希望这对将来的其他人有所帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-11T21:26:56.103

在子窗体上，确保将链接子字段和链接主字段属性都设置为创建关系的数据库字段。如果父表单绑定到包含创建关系的关键字段的记录源，则不需要指定文本框或任何其他要链接的控件，只需指定字段名称即可。

# wcf - wsHttpBinding 在自托管的 WCF 服务中不起作用；基于 SOAP 的绑定确实有效

> ID：12830756
> 
> 赞同：1
> 
> 时间：2012-10-11T01:08:28.583
> 
> 标签：wcf, rest, webhttpbinding

我有一个简单的 WCF 服务，如下所示。

```
[ServiceContract]
public interface IService1
{
    [OperationContract]
    [WebInvoke(Method = "POST", BodyStyle = WebMessageBodyStyle.WrappedRequest)]
    string GetData(int value);
}

public class Service1 : IService1
{
    public string GetData(int value)
    {
        return string.Format("You entered: {0}", value);
    }
} 
```

服务器 Web.config 文件是

```
<?xml version="1.0"?>
<configuration>
<appSettings>
    <add key="aspnet:UseTaskFriendlySynchronizationContext" value="true" />
</appSettings>

<system.serviceModel>
    <behaviors>
        <endpointBehaviors>
            <behavior name="webHttpEndpointBehavior">
                <webHttp faultExceptionEnabled="true" />
            </behavior>
        </endpointBehaviors>
        <serviceBehaviors>
            <behavior name="serviceBehaviourDebug">
                <!-- To avoid disclosing metadata information, set the values below to false before deployment -->
                <serviceMetadata httpGetEnabled="true" httpsGetEnabled="true"/>
                <!-- To receive exception details in faults for debugging purposes, set the value below to true.
                     Set to false before deployment to avoid disclosing exception information -->
                <serviceDebug includeExceptionDetailInFaults="true"/>
            </behavior>
        </serviceBehaviors>
    </behaviors>

    <services>
        <service name="Diws.Service1" behaviorConfiguration="serviceBehaviourDebug">
            <endpoint
                address="/basicHttp"
                binding="basicHttpBinding"
                contract="Diws.IService1"/>
            <endpoint
                address="/webHttp"
                binding="webHttpBinding"
                behaviorConfiguration="webHttpEndpointBehavior"
                contract="Diws.IService1"/>
            <endpoint
                address="/wsHttp"
                binding="wsHttpBinding"
                contract="Diws.IService1"/>
            <endpoint
                address="mex"
                binding="mexHttpBinding"
                contract="IMetadataExchange" />
        </service>
    </services>

    <serviceHostingEnvironment aspNetCompatibilityEnabled="true" multipleSiteBindingsEnabled="true" />
</system.serviceModel>

<system.web>
    <compilation debug="true" targetFramework="4.5" />
    <httpRuntime targetFramework="4.5"/>
</system.web>

<system.webServer>
    <modules runAllManagedModulesForAllRequests="true"/>
    <!--
    To browse web app root directory during debugging, set the value below to true.
    Set to false before deployment to avoid disclosing web app folder information.
    -->
    <directoryBrowse enabled="true"/>
</system.webServer>
</configuration> 
```

客户端是一个控制台应用程序，其 App.config 是这样的。

```
<?xml version="1.0" encoding="utf-8" ?>
<configuration>
<startup> 
    <supportedRuntime version="v4.0" sku=".NETFramework,Version=v4.5" />
</startup>

<system.serviceModel>
    <behaviors>
        <endpointBehaviors>
            <behavior name="webHttpEndpointBehavior">
                <webHttp />
            </behavior>
        </endpointBehaviors>
    </behaviors>

    <bindings>
        <basicHttpBinding>
            <binding name="BasicHttpBinding_IService1" />
        </basicHttpBinding>
        <wsHttpBinding>
            <binding name="WsHttpBinding_IService1" />
        </wsHttpBinding>
        <webHttpBinding>
            <binding name="WebHttpBinding_IService1" />
        </webHttpBinding>
    </bindings>

    <client>
        <endpoint
            address="http://localhost:50001/Service1.svc/basicHttp"
            binding="basicHttpBinding"
            bindingConfiguration="BasicHttpBinding_IService1"
            contract="ServiceReference1.IService1"
            name="BasicHttpEndpoint_IService1" />
        <endpoint
            address="http://localhost:50001/Service1.svc/webHttp"
            behaviorConfiguration="webHttpEndpointBehavior"
            binding="webHttpBinding"
            bindingConfiguration="WebHttpBinding_IService1"
            contract="ServiceReference1.IService1"
            name="WebHttpEndpoint_IService1" />
        <endpoint
            address="http://localhost:50001/Service1.svc/wsHttp"
            binding="wsHttpBinding"
            bindingConfiguration="WsHttpBinding_IService1"
            contract="ServiceReference1.IService1"
            name="WsHttpEndpoint_IService1"/>
    </client>
</system.serviceModel>

<system.web>
    <compilation debug="true" targetFramework="4.5" />
    <httpRuntime targetFramework="4.5"/>
</system.web>
</configuration> 
```

客户端程序是这样的。

```
class Program
{
    static void Main(String[] args)
    {
        String response = "";

        Service1Client basicHttpClient = new Service1Client("BasicHttpEndpoint_IService1");
        response = basicHttpClient.GetData(10);
        basicHttpClient.Close();
        Console.WriteLine(response);

        ///* Some communication exception
        Service1Client webHttpClient = new Service1Client("WebHttpEndpoint_IService1");
        response = webHttpClient.GetData(20);
        webHttpClient.Close();
        Console.WriteLine(response);
        //*/

        Service1Client wsHttpClient = new Service1Client("WsHttpEndpoint_IService1");
        response = wsHttpClient.GetData(30);
        wsHttpClient.Close();
        Console.WriteLine(response);

        Console.WriteLine();
        Console.WriteLine("Done");
        Console.ReadLine();
    }
} 
```

basicHttpClient 和 wsHttpClient 完美运行。但是，webHttpClient 抛出异常“System.ServiceModel.CommunicationException 未处理，HResult=-2146233087，Message=Internal Server Error”

我无法在服务器端进行调试，因为 Visual Studio 2012 显示“无法自动调试 'MyProject'。无法调试远程过程。这通常表明服务器上尚未启用调试。”

但是，调试已启用。在启用诊断的情况下使用 SvcTraceViewer 我无法获得任何见解。

我的主要兴趣是找出使用 WebHttpBinding 的 REST 调用失败的原因，但帮助让服务器端调试工作也将不胜感激。我正在使用多个启动项目在 VS2012 中调试客户端和服务器。本地主机是唯一涉及的服务器。

我知道 REST 端点不会出现在 WcfTestClient 中，因为它不提供元数据交换，但我希望能够通过该端点调用服务，并且我发现我的代码和调用 RESTful WCF 服务的示例之间没有区别。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-11T23:00:02.720

要访问 REST 端点，请尝试使用浏览器或 HttpClient 向 URL 发出 HTTP POST 请求：$http://localhost:50001/Service1.svc/webHttp/GetData$。当您像在代码中那样使用 webHttpClient 来调用服务时，您正在发送一个 REST 端点无法处理的 SOAP 请求。我相信这就是您的其他两个端点工作正常但不是这个端点的原因。

# objective-c - 在 UIScrollView 子类中创建委托

> ID：12830758
> 
> 赞同：1
> 
> 时间：2012-10-11T01:08:33.390
> 
> 标签：objective-c, ios, delegates

我对 UIScrollView 进行了子类化以对其进行一些自定义。我正在尝试创建一个委托，它将通知其他几个类用户在 UIScrollView 中做了某件事。在我的 UIScrollView 类中，我有下面的代码。我遇到的问题是我收到警告

> 属性“委托”“保留（或强）”属性与从“UIScrollView”继承的属性不匹配

我看到这是因为我的类继承自 UIScrollView，但我的委托符合 NSObject。这是我第一次尝试创建自己的委托。我能做些什么来解决这个问题？

我的代码：

```
#import <UIKit/UIKit.h>

@protocol ChangeSpaceDelegate <NSObject>
- (void)changeSpace:(int)spaceId;

@end

@interface CustomUIScrollView : UIScrollView {
    id<ChangeSpaceDelegate> delegate;
}

@property (retain, nonatomic)id delegate;

@end 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-11T01:20:13.573

为了具体回答您的问题，您正在重新定义`delegate`您从中获得的属性的属性属性`UIScrollView`。它应该像所有代表一样是`weak`（或者，iOS 5 之前的版本`unsafe_unretained`）。

但是，您不应该这样做。`UIScrollView`已经有一个委托，如果您希望将实现新委托方法的自己的委托对象放入其中，那么内部的工作`UIScrollView`将不会令人满意。为它定义一个新协议和一个新的委托属性。

```
@property (weak, nonatomic) id<ChangeSpaceDelegate> changeSpaceDelegate; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-11T02:32:10.323

您不必`delegate`在自定义滚动视图类中创建对象，因为您是从`UIScrollView`. `self.delegate`您可以像在自定义滚动视图类中一样直接使用它。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-11T03:50:44.317

正如@Steve Madsen 所提到的，我经常为子类添加自己的委托属性。Like`UITableView`具有单独的`DataSource`和`Delegate`属性，并且被分配了相同的对象。从长远来看，这肯定会得到回报，因为它不会强迫您重复已经在超类中实现的内容，并使您的子类实现更易于管理

# excel - 用于查找扩展名为 .xls 和 .xlsx 的 Excel 文件的 PowerShell 脚本

> ID：12830767
> 
> 赞同：0
> 
> 时间：2012-10-11T01:09:52.247
> 
> 标签：excel, powershell, directory

我有一个已经编写好的脚本，它只查找一个扩展名为 .xls 的 excel 文件。现在，

1.  我想要相同的脚本来查找它在该特定位置找到的 .xls 或 .xlsx 并使用它......

2.  旧脚本仅在 excel 表/文件上搜索 F 列中的文件.....这使得搜索需要永远，所以我希望它搜索 F 列中只有这个路径的文件：root_project/ Fut_DB_Projects 在 Excel 工作表的 E 列中。

请让我确切地知道在脚本中插入它的位置。我对 Powershell 很陌生，非常感谢您的回答。

```
# Creating an object for the Excel COM addin

$excelfile = $args[0]
$folder = $args[1]
echo $excelfile
echo $folder

if($excelfile -ne $Null -and $excelfile.Contains(".xls") -and (Test-Path $excelfile) -eq $True)
{
    if($folder -ne $Null -And $folder.Contains("\") -and (Test-Path $folder) -eq $True)
    {
        $ExcelObject = New-Object -ComObject Excel.Application

        # Opening the Workbook
        $ExcelWorkbook = $ExcelObject.Workbooks.Open($excelfile)

        # Opening the Worksheet by using the index (1 for the first worksheet)
        $ExcelWorksheet = $ExcelWorkbook.Worksheets.Item(1)

        #The folder where the files will be copied/The folder which will be zipped later
        $a = Get-Date

        $targetfolder = "C:\"+$a.Month+"_"+$a.Day+"_"+$a.Year+"_"+$a.Hour+$a.Minute+$a.Second

        #Check if the folder already exists. Command Test-Path $targetfolder returns true or false.
        if(Test-Path $targetfolder)
        {
            #delete the folder if it already exists. The following command deletes a particular directory
            Remove-Item $targetfolder -Force -Recurse -ErrorAction SilentlyContinue
        }

        #The following command is used to create a particular directory
        New-Item -ItemType directory -Path $targetfolder
        echo "Temp folder created"
        #Declaration of variables, COlumn value = 6 for Column F
        $row = 1
        $col = 6 

        # Read a value from the worksheet with the following command
        $filename = $ExcelWorksheet.Cells.Item($row,$col).Value2
        $filename
        #change the folder value below to specify the folder where the powershell needs to search for the filename that it reads from excel file.
        $null = ""

        # Loop through each row in the excel file.
        do
        {
            $filename = $ExcelWorksheet.Cells.Item($row,$col).Value2

            #Checking if value read from Excel is Null
            #In powershell operator for NOT EQUAL TO is -ne not <>
            if($filename -ne $Null)
            {
                $filepath = $folder+$filename
                #Check if the filepath read from excel is a real filepath OR check if the file exists.
                if(Test-Path $filepath)
                {
                    #If the file exists, move it to the folder declared above
                    # Change the below command to Move-Item if you want to Move the file and not Copy...
                    Copy-Item $filepath $targetfolder
                }
                else
                {
                    #$Allfiles = Get-ChildItem -Recurse $folder
                    #You add the folders to the following list that you want the script to skip as it searches
                    #for the files through directory and its subdirectories
                    #eg. $xdir = @("Folder1","Folder2","Folder3")
                    $xdir = @("Tables","Views","Update","Synonyms","BES","ADTLTransit","Fut_DB_Jobs","Triggers","Scripts")
                    $remove = [string]::join("|",$xdir)

                    $Allfiles = Get-ChildItem -Recurse $folder | ? { $_.DirectoryName -notmatch $remove} 
                    Write-Host -Fore Yellow ("Looking through subfolders now")

                    foreach ($file in $Allfiles)
                    {
                        $testpath = $file.FullName
                        if($testpath.Contains($filename))
                        {
                            Write-Host -Fore Yellow ("Found the file in a subfolder at location:" + $testpath)
                            Move-Item $testpath $targetfolder
                        }
                    }
                }
            }
            #incrementing the row variable by 1 to move to the next available row in excel.
            $row = $row + 1
        }
        #while condition evaluates if value read from the excel is null. If null, then the loop breaks.
        while($filename -ne $Null)

        # Important: The object needs to quit and the variables release, otherwise
        # an Excel.exe will remain open.
        $ExcelObject.Quit()

        $ExcelObject = $null
        $ExcelWorkbook = $null
        $ExcelWorksheet = $null

        [GC]::Collect()
        do
        {
        }
        while((Test-Path -path $targetfolder) -ne $True)
        $targetfolderinfo = Get-ChildItem -Recurse $targetfolder | Measure-Object
        $targetfolderfilecount = $targetfolderinfo.count

        if($targetfolderfilecount -ne 0)
        {
            #Following command calls the function to zip all the files moved from source folder to target folder
            $directory = [IO.DirectoryInfo] $targetfolder

            If ($directory -eq $null)
            {
                Throw "Value cannot be null: directory"
            }

            Write-Host ("Creating zip file for folder (" + $directory.FullName + ")...")    
            [IO.DirectoryInfo] $parentDir = $directory.Parent    
            [string] $zipFileName

            If ($parentDir.FullName.EndsWith("\") -eq $true)
            {
                # e.g. $parentDir = "C:\"
                $zipFileName = $parentDir.FullName + $directory.Name + ".zip"
            }
            Else
            {
                $zipFileName = $parentDir.FullName + "\" + $directory.Name + ".zip"
            }

            If (Test-Path $zipFileName)
            {
                Remove-Item $zipFileName -Force -Recurse -ErrorAction SilentlyContinue
            }

            Set-Content $zipFileName ("PK" + [char]5 + [char]6 + ("$([char]0)" * 18))

            $shellApp = New-Object -ComObject Shell.Application
            $zipFile = $shellApp.NameSpace($zipFileName)

            If ($zipFile -eq $null)
            {
                Throw "Failed to get zip file object."
            }

            [int] $expectedCount = (Get-ChildItem $directory -Force -Recurse).Count
            $expectedCount += 1 # account for the top-level folder

            $zipFile.CopyHere($directory.FullName)

            Write-Host -Fore Green ("Successfully created zip file for folder (" `
                + $directory.FullName + ").")
        }
        else
        {
            Write-Host -Fore Red ("There are no files to be zipped")
        }

        [System.Threading.Thread]::Sleep(10000)
        Remove-Item $targetfolder -recurse
    }
    else
    {
        Write-Host -Fore Red ("Target folder path not specified correctly")
    }
}
else
{
    Write-Host -Fore Red ("Excel file path not specified") 
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-11T15:14:53.303

尝试将第一个 if 更改为此

```
if($excelfile -ne $Null -and $excelfile -like "*.xls*" -and (Test-Path $excelfile) -eq $True) 
```

# android - 捕获或检测 ANR 异常

> ID：12830773
> 
> 赞同：2
> 
> 时间：2012-10-11T01:11:02.920
> 
> 标签：android, crash, detect

如果应用程序崩溃了，我想发送 /data/anr/traces.txt，但问题是我怎么知道我的应用程序之前崩溃了。

```
 File file = new File("/data/anr/traces.txt");
    if (file.exists()) {
        Intent intent = new Intent(Intent.ACTION_SEND);
        intent.putExtra("subject", file.getName());
        intent.putExtra("body", "...");
        intent.putExtra(Intent.EXTRA_STREAM, Uri.fromFile(file));

        if (file.getName().endsWith(".gz")) {
            intent.setType("application/x-gzip");
        } else if (file.getName().endsWith(".txt")) {
            intent.setType("text/plain");
        } else {
            intent.setType("application/octet-stream");
        }

                    // ? Can I send it without permission?
        startActivity(intent);
    } 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-11T01:20:45.357

一种可靠的方法是使用“脏位”；当您的应用程序启动时向文件写入一个值，并在它干净关闭时向文件写入一个不同的值。每次您的应用程序启动时，在写入文件之前检查文件中的内容；如果它不是您在应用程序完全关闭时写入的值，您就知道应用程序崩溃了。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-11T02:16:55.377

或者，您可以使用 ACRA [http://code.google.com/p/acra/](http://code.google.com/p/acra/)。它将使您能够将崩溃报告直接发送到您的应用服务器/第三方服务器。

# java - java - 从移动设备复制文件

> ID：12830778
> 
> 赞同：3
> 
> 时间：2012-10-11T01:11:54.153
> 
> 标签：java, android, file, storage, mobile-devices

我一直在尝试制作这个小型桌面 java 应用程序，以将一些预定义的文件从 android 平板电脑/智能手机备份到我的计算机。

到目前为止，我一直主要使用 File.getRoots() 函数来轻松访问每个驱动器。我在两部安卓手机上成功测试了这个，但是当我在 Galaxy Note 上尝试时问题就来了。与前两个不同。此设备不被视为“可移动媒体”，而是被视为“移动设备”。因此，我无法使用我目前的方法达到它，它只是没有“列出”。

我还查看了是否有办法通过 cmd 访问这些移动设备，希望能有所帮助，但没有发现任何有用的东西。

我的目标是通过plug > run-application > unplug 进行备份。

所以，就是这样，我被卡住了！有什么线索吗？

先谢谢了

# c++ - 设计一个具有很少在副本中访问的大型成员的 C++ 类？

> ID：12830779
> 
> 赞同：0
> 
> 时间：2012-10-11T01:12:06.233
> 
> 标签：c++, oop, design-patterns, architecture, software-design

由于性能问题，我正在尝试重构一些 C++ 代码，我想知道解决这个问题的最佳方法。我有一个类说 DataGatherer，它是大型系统的核心组件。此类被序列化并通过数据流发送，复制并存储到表中，为了并发而复制（签出副本而不是访问原始 DataGatherer 对象）。我列出示例只是为了让您知道它具有同时使用的复制和赋值运算符。

问题是 DataGatherer 对象可能变得非常大，因为它们本质上包含大量收集的数据以及有关数据的统计信息和元数据。在许多情况下，只需要统计数据和元数据，而不是后端数据收集。

是否有任何设计模式可能对这里有所帮助？也许更普遍的问题是，在大多数情况下您只需要对象的一部分，但对象内部耦合如此紧密以至于几乎不可能将其拆分时，您会怎么做？

我曾经的想法，

*   将该类拆分为一个 DataGatherer 类和一个指向 DataGathererBackend 对象的指针。在大多数情况下返回浅副本以避免在不使用 DataGathererBackend 时复制它的所有开销。我讨厌这样做，因为当你想要一个浅拷贝与你想要一个深拷贝时处理所有的麻烦，而且只是一般的混乱形式不得不求助于 DataGatherer 对象，这些对象具有 NULL 指针作为后端对象，因为它不是在这些情况下需要。

*   将该类拆分为 DataStatistics 和 Data，并创建一个包装并包含两者的第三个类。

*   其他想法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-11T01:21:10.750

一个选项是您可以执行 Copy On Write，其中复制构造函数或赋值运算符被重载以首先不复制（后端？）数据，引用它，并仅在修改数据时复制它。您可以在 DataGatherer 内部执行此操作，因此 iterface 不会更改，只要您可以重载数据修改成员即可。但是，如果您已经公开了指向数据的指针并在任何地方使用它，那就更难了。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-11T02:49:52.747

如果只需要统计信息，那么您可以通过值或常量引用返回一个统计信息结构，并将检索从复制运算符更改为调用统计信息获取器函数。

# objective-c - setBackButtonBackgroundImage 没有标题 IOS5

> ID：12830782
> 
> 赞同：8
> 
> 时间：2012-10-11T01:12:19.227
> 
> 标签：objective-c, xcode, ios5, user-interface, uiappearance

我试图获得一个没有标题的后退按钮，但我无法让它工作。我真的是objective-c的新手...

```
UIImage *backButtonImage = [[UIImage imageNamed:@"back.png"] resizableImageWithCapInsets:UIEdgeInsetsMake(0, 0, 30, 50)];
[[UIBarButtonItem appearance] setBackButtonBackgroundImage:backButtonImage
                                                  forState:UIControlStateNormal
                                                barMetrics:UIBarMetricsDefault]; 
```

使用该代码，我有我的后退按钮，还有上一页的标题。

我找到了一些使用 UIViewController 类的工作示例，但在我的情况下，代码位于 appDelegate.m 文件中。

知道如何使它工作吗？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-11-17T09:22:03.207

我改编的一个非常简单**的使用 iOS 5 外观代理**的 hack 如下（不用说，代理的好处是对所有导航栏的全局更改）：

```
[[UIBarButtonItem appearance] setBackButtonTitlePositionAdjustment:UIOffsetMake(-400.f, 0)
                                                     forBarMetrics:UIBarMetricsDefault]; 
```

此方法在 iOS 5 SDK 中可用，所以不用担心。

* * *

**编辑**

为了避免图像拉伸，请使用以下内容：

```
UIImage* image = [UIImage imageNamed:@"back"];
return [image resizableImageWithCapInsets:UIEdgeInsetsMake(0, image.size.width, 0, 0)]; 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-10-27T22:58:40.300

据我所知，您正确设置了外观代理。这里的问题是为您的后退按钮设置一个新标题。

为此，请使用您的行为创建一个自定义按钮，并将其用作新的后退按钮。**在你推送或弹出视图控制器之前设置它，例如在 init**

```
UIBarButtonItem *backButton = [[UIBarButtonItem alloc] initWithTitle:@""
                                                               style:UIBarButtonItemStyleBordered
                                                              target:nil
                                                              action:nil];

[self.navigationItem setBackBarButtonItem: newBackButton]; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-30T07:01:27.830

```
UIImage *image1 = [UIImage imageNamed:@"image.png"];
[[UIBarButtonItem appearance] setBackButtonBackgroundImage:image1 forState:UIControlStateNormal barMetrics:UIBarMetricsDefault]; 
```

上面的代码用于在返回按钮中设置免费图像。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-02T11:10:03.123

我还没有尝试过，但我认为它应该可以工作....把这个放到你的 viewdidLoad 中，我希望它是你要找的。

```
UIBarButtonItem *backBarButtonItem = [[UIBarButtonItem alloc] initWithTitle:@"" 
style:UIBarButtonItemStylePlain target:nil action:nil];
self.navigationItem.backBarButtonItem = backBarButtonItem;
[backBarButtonItem release]; 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-10-31T11:00:57.020

据我了解，您在问如何更改后退按钮的标题。

这就是我总是这样做的

```
self.navigationItem.backBarButtonItem.title=@"My Title"; 
```

我想您可以通过不提供任何标题将其设置为空

```
self.navigationItem.backBarButtonItem.title=@""; 
```

确保在推送新视图之前调用此函数。

* * *

## 回答 #6

> 赞同：-4
> 
> 时间：2012-10-30T12:37:15.777

只需在您已经编写的代码之后添加这一行：

```
[[UIBarButtonItem appearance] setTitle:@""]; 
```

希望它有效。

# php - 如何在 PHP 中检查文件中的更改

> ID：12830784
> 
> 赞同：1
> 
> 时间：2012-10-11T01:12:21.437
> 
> 标签：php, multiplayer, inotify

我目前正在编写多人 Connect 4 游戏。当玩家移动时，该移动将写入包含 Connect 4 棋盘上每个位置状态的文件。

我目前有一个带有延迟循环的 PHP 脚本，它检查自上次循环迭代以来的更改，如果有更改，PHP 脚本会返回更新后的文件以发送给播放器。

这种方法效率极低且混乱；有没有更好的方法可以立即通知游戏的变化？

另外，我尝试使用 inotify，但它似乎不适用于我的服务器。（Mac OS X Server 10.8，所以这可能就是为什么......）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-11T01:21:18.210

在后台进行轮询以获得这样的更改并不少见。你能更具体地说明你不喜欢什么吗？

如果您正在寻找更聪明的东西，每个玩家都可以向“游戏会话”API 异步打开一个保持活动请求。该实现可以监视文件的更改并在检测到更改时发送下一个块。更改是来自文件还是来自数据库取决于服务器实现。当然，您的客户端应用程序需要确保请求保持打开状态并在关闭时重新连接。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-11T07:48:56.310

在 PHP 中很难，使用[node.js](http://nodejs.org)怎么样？它内置了这些功能。

# qt - 处理按键事件 Ctrl+Tab 和 Ctrl+Shift+Tab

> ID：12830788
> 
> 赞同：7
> 
> 时间：2012-10-11T01:12:50.640
> 
> 标签：qt, event-handling, keyboard-shortcuts, qml

我想处理两个关键事件`Ctrl`+`Tab`和`Ctrl`+ `Shift`+`Tab`以便在我的应用程序中的选项卡之间切换（分别为“前进”和“后退”）。但是，这似乎没有按预期工作。

这是我当前的代码（最小示例）：

```
import QtQuick 1.1

Item {
    width: 100
    height: 100

    focus: true

    Keys.onPressed: {
        if(event.modifiers & Qt.ControlModifier) {
            if(event.key === Qt.Key_Tab) {
                if(event.modifiers & Qt.ShiftModifier)
                    console.log('backward')
                else
                    console.log('forward')
            }
        }
    }
} 
```

`qmlviewer`我用（Qt 4.8.2 版）运行了这段代码

按`Ctrl`+时输出`Tab`：

```
forward
forward 
```

按`Ctrl`+ `Shift`+时输出`Tab`：

> *没有任何*

所以我看到了两个错误：前一个键序列被处理了两次，而另一个根本没有。

*   **编辑：**另一个根本没有得到处理的原因已解决，请参阅评论。

为什么会发生这种情况，我该如何解决？

注意：我已经在我的应用程序中使用了 Qt Components for Desktop，所以如果您知道需要此模块的解决方案就可以了。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-11-10T19:58:13.530

您必须接受该事件，否则该事件将传播给父母，直到它被接受。以下代码对我有用。

```
Item {
    width: 100
    height: 100

    focus: true

    Keys.onPressed: {
        if(event.modifiers && Qt.ControlModifier) {
            if(event.key === Qt.Key_Tab) {
                console.log('forward')
                event.accepted = true;
            }
            else if(event.key === Qt.Key_Backtab) {
                console.log('backward')
                event.accepted = true;
            }
        }
    }
} 
```

**编辑：**这种行为让父母可以处理孩子无法处理的事件，比如热键。

希望这可以帮助！

# c# - 所有者绘制的列表框未绘制先前选择的项目

> ID：12830790
> 
> 赞同：3
> 
> 时间：2012-10-11T01:12:53.970
> 
> 标签：c#, winforms, listbox, ownerdrawn

我想增加列表框中项目的高度 - 基本上在内部填充它们。除此之外，我不想更改默认列表框行为。我已按照 MSDN 示例进行所有者绘制的列表项，但我遇到了问题。默认列表框以黑色绘制项目，以蓝色突出显示选定的项目。为了完成同样的功能，我在 DrawItem 事件处理程序中使用了以下代码：

```
private void listBox1_DrawItem(object sender, DrawItemEventArgs e)
    {
        Brush b = (e.Index == ((ListBox)sender).SelectedIndex ? Brushes.White : Brushes.Black);
        e.DrawBackground();
        e.Graphics.DrawString(listBox1.Items[e.Index].ToString(), e.Font, b, new Rectangle(new Point(e.Bounds.X, e.Bounds.Y + 2), e.Bounds.Size));
        e.DrawFocusRectangle();
    } 
```

除非我单击列表，否则这似乎工作正常。所选项目确实显示为蓝色背景上的白色文本，但之前选择的项目仍为白色。似乎我选择的项目被重绘，但之前选择的项目没有。如果我移动到另一个控件，列表框会重新绘制。我错过了什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-20T19:47:15.353

要将填充添加到列表框，只需将列表框的 .ItemHeight 设置为某个高度。

否则，如果您想进行所有者绘制，而不是手动选择颜色，请使用 e.ForeColor。像这样：

```
Brush b = new SolidBrush(e.ForeColor); 
```

请注意，在这种情况下，您也必须为所选项目绘制背景。检查列表框项目的状态可以这样执行：

```
e.Graphics.FillRectangle((e.State & DrawItemState.Selected) != 0 ? SystemBrushes.Highlight : SystemBrushes.Window, new Rectangle(new Point(e.Bounds.X, e.Bounds.Y + 2), e.Bounds.Size)); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-01-14T11:29:12.623

**答：** `ListBox.SelectedIndex`非常不合理（就像汉斯说的那样），但`e.ForeColor`足够正确。改用那个。

替换您的代码：`e.Index == ((ListBox)sender).SelectedIndex`

和`e.ForeColor == SystemColors.HighlightText`

**支持数据：**

将此行添加到顶部`listBox1_DrawItem`：

```
Console.WriteLine("e.Index=" + e.Index + " SelectedIndex=" + 
  listBox1.SelectedIndex + " ForeColor=" + e.ForeColor); 
```

它产生这样的输出（//注释）

```
// Added 4 items to listbox
e.Index=0 SelectedIndex=-1 ForeColor=Color [WindowText]
e.Index=1 SelectedIndex=-1 ForeColor=Color [WindowText]
e.Index=2 SelectedIndex=-1 ForeColor=Color [WindowText]
e.Index=3 SelectedIndex=-1 ForeColor=Color [WindowText]

// MouseDown on item 0
e.Index=0 SelectedIndex=-1 ForeColor=Color [WindowText]
e.Index=0 SelectedIndex=0 ForeColor=Color [HighlightText]
e.Index=0 SelectedIndex=0 ForeColor=Color [HighlightText]
e.Index=0 SelectedIndex=0 ForeColor=Color [HighlightText]
e.Index=0 SelectedIndex=0 ForeColor=Color [HighlightText]
e.Index=0 SelectedIndex=0 ForeColor=Color [HighlightText]
e.Index=1 SelectedIndex=0 ForeColor=Color [WindowText]
e.Index=2 SelectedIndex=0 ForeColor=Color [WindowText]
e.Index=3 SelectedIndex=0 ForeColor=Color [WindowText]
e.Index=0 SelectedIndex=0 ForeColor=Color [HighlightText]
// MouseUp on item 0 (no DrawItem events)

// MouseDown for item 1
e.Index=0 SelectedIndex=0 ForeColor=Color [HighlightText]
e.Index=0 SelectedIndex=0 ForeColor=Color [WindowText]
e.Index=1 SelectedIndex=1 ForeColor=Color [HighlightText]
e.Index=1 SelectedIndex=1 ForeColor=Color [HighlightText]
// MouseUp for item 1 (no DrawItem events)

// MouseDown for item 2
e.Index=1 SelectedIndex=1 ForeColor=Color [HighlightText]
e.Index=1 SelectedIndex=1 ForeColor=Color [WindowText]
e.Index=2 SelectedIndex=2 ForeColor=Color [HighlightText]
e.Index=2 SelectedIndex=2 ForeColor=Color [HighlightText]

// Drag to item 3
e.Index=2 SelectedIndex=2 ForeColor=Color [HighlightText]
e.Index=2 SelectedIndex=2 ForeColor=Color [WindowText]
e.Index=3 SelectedIndex=3 ForeColor=Color [HighlightText]
e.Index=3 SelectedIndex=3 ForeColor=Color [HighlightText]
// MouseUp over item 3 (no DrawItem events) 
```

所以基本上...... ListBox 绘制的可能比我们想要的要多，但您最终会在最后一次绘制时获得正确的颜色。

我还推荐[DoubleBuffering](https://stackoverflow.com/questions/3274861/overriding-drawitem-for-listbox-unselected-items-are-not-redrawn)。

# objective-c - 将图像上传到 Dropbox

> ID：12830794
> 
> 赞同：0
> 
> 时间：2012-10-11T01:13:35.617
> 
> 标签：objective-c, ios, cocoa-touch, dropbox, dropbox-api

我正在尝试将图像上传到保管箱。我正在使用最新版本的 SDK（9 月 17 日）并成功验证了我的应用程序。

这是执行此操作的代码：

```
for ( NSUInteger i = 0; i < [photos count]; i ++ ) {

    NSString *filename = [NSString stringWithFormat:@"%d.png", i+1];
    NSString *file = [NSTemporaryDirectory() stringByAppendingPathComponent:filename];

    [UIImagePNGRepresentation([photos objectAtIndex:i]) writeToFile:file atomically:YES];

    NSString *destDir = @"/";
    [self.dropboxClient uploadFile:filename toPath:destDir withParentRev:nil fromPath:file];

} 
```

笔记：

*   `self.dropboxClient`是一个实例化的`DBRestClient`对象。
*   `photos`是 UIImages 的 NSMutableArray （我已经检查以确保对象是使用列表中每个对象的 NSStringFromClass() 方法的图像）；

`DBRestClient`最重要的是，我认为我的对象 ( )可能存在问题`self.dropboxClient`，因为即使我设置了委托，也没有输入任何委托方法。

任何和所有的帮助将不胜感激！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-11T06:20:20.517

这是一个线程问题。DBRESTClient 方法，`createFolder`和`uploadFile::::`必须在主线程上执行。

# java-native-interface - 通过JNI将大量字符串从Java传递到c ++的最有效方法是什么

> ID：12830797
> 
> 赞同：0
> 
> 时间：2012-10-11T01:13:45.307
> 
> 标签：java-native-interface, hbase

我正在尝试为 HBase HFiles 编写一个 JNI 包装器，以便我可以在一次 JNI 调用中从我的 c++ 代码中的 HFile 读取所有键值对。我可能会为每个键值对获取一个 jstring 数组，但我不确定这是否是最有效的方法。我想知道是否有办法让我将所有字符串写入 ByteBuffer 中，然后将其传递给我可以正确恢复所有字符串的 c++ 端？我能想到的一种方法是使用重复的字符串创建自己的原型缓冲区，但似乎必须有更好的解决方案。

# javascript - 切换类使事件功能无效？

> ID：12830800
> 
> 赞同：2
> 
> 时间：2012-10-11T01:14:13.977
> 
> 标签：javascript, jquery, html, css

我认为这会起作用，但是每当我单击类名为 one 的元素并将其更改为名为 two 的类时，我就无法使第二个事件起作用。我在这里想念什么？

```
//first event
$('.one').on('click', function () {

  $('.one').attr('class', 'two');

});

//second event
$('.two').on('click', function () {

  $('.two').attr('class', 'one');

}); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-11T01:19:13.533

您需要将事件委托给**静态父**级..问题是，因为您似乎动态更改了每次更改类时都需要绑定事件的类..所以委托它应该可以消除这个问题..

你也可以把它写成一个单一的事件..

```
$('body').on('click','.one' , '.two', function() {

     if( $(this).hasClass('one'){
          function1();
     }
     else if( $(this).hasClass('two'){
         function2();
     }
     $(this).toggleClass('one two');
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-11T01:27:35.800

为什么不更简单的`:)` [http://jsfiddle.net/XZeNE/1/](http://jsfiddle.net/XZeNE/1/) **或**这个[http://jsfiddle.net/4mJJe/](http://jsfiddle.net/4mJJe/)

使用 API -`toggleClass`

进一步的 HTML 更改**Dmeo** [http://jsfiddle.net/vuLQK/1/](http://jsfiddle.net/vuLQK/1/)

**代码**

```
$('.one').on('click', function() {

    $(this).toggleClass('two');

});​ 
```

**HTML 更改**

```
$('.one').on('click', function() {
    $(this).toggleClass(function(){
           if($(this).hasClass('two'))
               $(this).html('NOw its class two HTML HULK');
           else                 
              $(this).html('CLASS ONE HTML IRONMAN' );

             return "two";            
        })

});

​ 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-11T01:17:35.720

您应该使用`.on`附加到 2 个元素的祖先之一，然后使用选择器参数来匹配事件目标。选择器不会匹配绑定处理程序时不存在的元素。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-10-11T01:56:05.190

```
$(function () {
        $("#container").delegate(".one", "click", function () {
            $(this).attr('class', 'two');
        });
        $("#container").delegate(".two", "click", function () {
            $(this).attr('class', 'one');
        });
    }) 
```

# php - Facebook PHP api：墙/动作链接重定向回FB？

> ID：12830802
> 
> 赞同：1
> 
> 时间：2012-10-11T01:14:38.547
> 
> 标签：php, facebook, facebook-graph-api, facebook-opengraph

我有一个 FB 应用程序，它正在发布到用户的时间线，并且还将一个操作发布到用户的聚合活动框。一切正常，发布正常，但如果我单击发布的链接将查看者带回应用程序（这是一个独立站点），它会快速进入该站点，并直接重定向回 FB。有没有其他人看过这个？

网站上的注意事项

*   这是一个有FB登录的网站

*   身份验证推荐已关闭

*   OG 动作尚未提交

*   其他一切工作正常。

这是我正在使用 PHP API 和 Codeigniter 发布到 FB 的操作：

```
 $object             = "[object]";
    $url                = base_url().'home/index/unique_url_for_object';
    $namespace      = "[namespace]";
    $action             = "[action]";

    $params = array($object=>$url, 'access_token'=>$this->facebook->getAccessToken());

    $post_id = $this->facebook->api('/me/'.$namespace.':'.$action,'post',$params); 
```

.. FB 上的每个可点击链接在应该指向我的网站时都会重定向回 FB！

有没有其他人看到这个，或者你能指出我做错了什么？

谢谢，保罗

# apache - 通过 wsgi 访问 web2py 管理界面

> ID：12830808
> 
> 赞同：0
> 
> 时间：2012-10-11T01:15:28.947
> 
> 标签：apache, wsgi, web2py, mod-proxy

[web2py](http://web2py.com/books/default/search/29?search=mod_proxy)书指出

> 管理界面 admin 只能从 localhost 访问，除非您使用 mod_proxy 在 Apache 后面运行 web2py。如果管理员检测到代理，则会话 cookie 设置为安全，并且管理员登录不起作用，除非客户端和代理之间的通信通过 HTTPS；这是一项安全措施。客户端和管理员之间的所有通信必须始终是本地的或加密的；否则攻击者将能够执行中间人攻击或重放攻击并在服务器上执行任意代码。

但是，我想知道这是否意味着通过 WSGI 使用 web2py 意味着我将无法远程访问管理界面。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-11T01:42:37.913

如果您尝试通过 HTTP 访问管理界面，您会看到以下内容：

```
Forbidden

You don't have permission to access /admin/default/index on this server.

Apache/2.2.22 (Ubuntu) Server at yourserver.com Port 80 
```

只需使用 HTTPS 导航到同一页面即可远程访问管理界面。

[https://yourserver.com/admin/default/index](https://yourserver.com/admin/default/index)

# php - 为什么我在..etc 中找不到“SoapClient”类

> ID：12830809
> 
> 赞同：1
> 
> 时间：2012-10-11T01:15:31.913
> 
> 标签：php, soap

> **可能重复：**
> [WAMP 堆栈 PHP “致命错误：找不到类 'SoapClient'”</a>](https://stackoverflow.com/questions/6760716/wamp-stack-php-fatal-error-class-soapclient-not-found)
> 
> [](https://stackoverflow.com/questions/6760716/wamp-stack-php-fatal-error-class-soapclient-not-found)

[](https://stackoverflow.com/questions/6760716/wamp-stack-php-fatal-error-class-soapclient-not-found)

[我从这个站点](https://stackoverflow.com/questions/6760716/wamp-stack-php-fatal-error-class-soapclient-not-found)[库](https://github.com/Exeu/Amazon-ECS-PHP-Library/downloads)下载了一个库，当我尝试使用它的示例时，它说：“致命错误：在 C:\wamp\www\Amazon-ECS\Exeu-Amazon-ECS-PHP-Library 中找不到类 'SoapClient' -9030053\lib\AmazonECS.class.php 在第 231 行“我应该如何解决这个问题？

```
 <?php
/**
 * Amazon ECS Class
 * http://www.amazon.com
 * =====================
 *
 * This class fetchs productinformation via the Product Advertising API by Amazon (formerly ECS).
 * It supports three basic operations: ItemSearch, ItemLookup and BrowseNodeLookup.
 * These operations could be expanded with extra prarmeters to specialize the query.
 *
 * Requirement is the PHP extension SOAP.
 *
 * @package      AmazonECS
 * @license      http://www.gnu.org/licenses/gpl.txt GPL
 * @version      1.3.4-DEV
 * @author       Exeu <exeu65@googlemail.com>
 * @contributor  Julien Chaumond <chaumond@gmail.com>
 * @link         http://github.com/Exeu/Amazon-ECS-PHP-Library/wiki Wiki
 * @link         http://github.com/Exeu/Amazon-ECS-PHP-Library Source
 */
class AmazonECS
{
  const RETURN_TYPE_ARRAY  = 1;
  const RETURN_TYPE_OBJECT = 2;

  /**
   * Baseconfigurationstorage
   *
   * @var array
   */
  private $requestConfig = array(
    'requestDelay' => false
  );

  /**
   * Responseconfigurationstorage
   *
   * @var array
   */
  private $responseConfig = array(
    'returnType'          => self::RETURN_TYPE_OBJECT,
    'responseGroup'       => 'Small',
    'optionalParameters'  => array()
  );

  /**
   * All possible locations
   *
   * @var array
   */
  private $possibleLocations = array('de', 'com', 'co.uk', 'ca', 'fr', 'co.jp', 'it', 'cn', 'es');

  /**
   * The WSDL File
   *
   * @var string
   */
  protected $webserviceWsdl = 'http://webservices.amazon.com/AWSECommerceService/AWSECommerceService.wsdl';

  /**
   * The SOAP Endpoint
   *
   * @var string
   */
  protected $webserviceEndpoint = 'https://webservices.amazon.%%COUNTRY%%/onca/soap?Service=AWSECommerceService';

  /**
   * @param string $accessKey
   * @param string $secretKey
   * @param string $country
   * @param string $associateTag
   */
  public function __construct($accessKey, $secretKey, $country, $associateTag)
  {
    if (empty($accessKey) || empty($secretKey))
    {
      throw new Exception('No Access Key or Secret Key has been set');
    }

    $this->requestConfig['accessKey']     = $accessKey;
    $this->requestConfig['secretKey']     = $secretKey;
    $this->associateTag($associateTag);
    $this->country($country);
  }

  /**
   * execute search
   *
   * @param string $pattern
   *
   * @return array|object return type depends on setting
   *
   * @see returnType()
   */
  public function search($pattern, $nodeId = null)
  {
    if (false === isset($this->requestConfig['category']))
    {
      throw new Exception('No Category given: Please set it up before');
    }

    $browseNode = array();
    if (null !== $nodeId && true === $this->validateNodeId($nodeId))
    {
      $browseNode = array('BrowseNode' => $nodeId);
    }

    $params = $this->buildRequestParams('ItemSearch', array_merge(
      array(
        'Keywords' => $pattern,
        'SearchIndex' => $this->requestConfig['category']
      ),
      $browseNode
    ));

    return $this->returnData(
      $this->performSoapRequest("ItemSearch", $params)
    );
  }

  /**
   * execute ItemLookup request
   *
   * @param string $asin
   *
   * @return array|object return type depends on setting
   *
   * @see returnType()
   */
  public function lookup($asin)
  {
    $params = $this->buildRequestParams('ItemLookup', array(
      'ItemId' => $asin,
    ));

    return $this->returnData(
      $this->performSoapRequest("ItemLookup", $params)
    );
  }

  /**
   * Implementation of BrowseNodeLookup
   * This allows to fetch information about nodes (children anchestors, etc.)
   *
   * @param integer $nodeId
   */
  public function browseNodeLookup($nodeId)
  {
    $this->validateNodeId($nodeId);

    $params = $this->buildRequestParams('BrowseNodeLookup', array(
      'BrowseNodeId' => $nodeId
    ));

    return $this->returnData(
      $this->performSoapRequest("BrowseNodeLookup", $params)
    );
  }

  /**
   * Implementation of SimilarityLookup
   * This allows to fetch information about product related to the parameter product
   *
   * @param string $asin
   */
  public function similarityLookup($asin)
  {
    $params = $this->buildRequestParams('SimilarityLookup', array(
      'ItemId' => $asin
    ));

    return $this->returnData(
      $this->performSoapRequest("SimilarityLookup", $params)
    );
  }

  /**
   * Builds the request parameters
   *
   * @param string $function
   * @param array  $params
   *
   * @return array
   */
  protected function buildRequestParams($function, array $params)
  {
    $associateTag = array();

    if(false === empty($this->requestConfig['associateTag']))
    {
      $associateTag = array('AssociateTag' => $this->requestConfig['associateTag']);
    }

    return array_merge(
      $associateTag,
      array(
        'AWSAccessKeyId' => $this->requestConfig['accessKey'],
        'Request' => array_merge(
          array('Operation' => $function),
          $params,
          $this->responseConfig['optionalParameters'],
          array('ResponseGroup' => $this->prepareResponseGroup())
    )));
  }

  /**
   * Prepares the responsegroups and returns them as array
   *
   * @return array|prepared responsegroups
   */
  protected function prepareResponseGroup()
  {
    if (false === strstr($this->responseConfig['responseGroup'], ','))
      return $this->responseConfig['responseGroup'];

    return explode(',', $this->responseConfig['responseGroup']);
  }

  /**
   * @param string $function Name of the function which should be called
   * @param array $params Requestparameters 'ParameterName' => 'ParameterValue'
   *
   * @return array The response as an array with stdClass objects
   */
  protected function performSoapRequest($function, $params)
  {
    if (true ===  $this->requestConfig['requestDelay']) {
      sleep(1);
    }

    $soapClient = new SoapClient(
      $this->webserviceWsdl,
      array('exceptions' => 1)
    );

    $soapClient->__setLocation(str_replace(
      '%%COUNTRY%%',
      $this->responseConfig['country'],
      $this->webserviceEndpoint
    ));

    $soapClient->__setSoapHeaders($this->buildSoapHeader($function));

    return $soapClient->__soapCall($function, array($params));
  }

  /**
   * Provides some necessary soap headers
   *
   * @param string $function
   *
   * @return array Each element is a concrete SoapHeader object
   */
  protected function buildSoapHeader($function)
  {
    $timeStamp = $this->getTimestamp();
    $signature = $this->buildSignature($function . $timeStamp);

    return array(
      new SoapHeader(
        'http://security.amazonaws.com/doc/2007-01-01/',
        'AWSAccessKeyId',
        $this->requestConfig['accessKey']
      ),
      new SoapHeader(
        'http://security.amazonaws.com/doc/2007-01-01/',
        'Timestamp',
        $timeStamp
      ),
      new SoapHeader(
        'http://security.amazonaws.com/doc/2007-01-01/',
        'Signature',
        $signature
      )
    );
  }

  /**
   * provides current gm date
   *
   * primary needed for the signature
   *
   * @return string
   */
  final protected function getTimestamp()
  {
    return gmdate("Y-m-d\TH:i:s\Z");
  }

  /**
   * provides the signature
   *
   * @return string
   */
  final protected function buildSignature($request)
  {
    return base64_encode(hash_hmac("sha256", $request, $this->requestConfig['secretKey'], true));
  }

  /**
   * Basic validation of the nodeId
   *
   * @param integer $nodeId
   *
   * @return boolean
   */
  final protected function validateNodeId($nodeId)
  {
    if (false === is_numeric($nodeId) || $nodeId <= 0)
    {
      throw new InvalidArgumentException(sprintf('Node has to be a positive Integer.'));
    }

    return true;
  }

  /**
   * Returns the response either as Array or Array/Object
   *
   * @param object $object
   *
   * @return mixed
   */
  protected function returnData($object)
  {
    switch ($this->responseConfig['returnType'])
    {
      case self::RETURN_TYPE_OBJECT:
        return $object;
      break;

      case self::RETURN_TYPE_ARRAY:
        return $this->objectToArray($object);
      break;

      default:
        throw new InvalidArgumentException(sprintf(
          "Unknwon return type %s", $this->responseConfig['returnType']
        ));
      break;
    }
  }

  /**
   * Transforms the responseobject to an array
   *
   * @param object $object
   *
   * @return array An arrayrepresentation of the given object
   */
  protected function objectToArray($object)
  {
    $out = array();
    foreach ($object as $key => $value)
    {
      switch (true)
      {
        case is_object($value):
          $out[$key] = $this->objectToArray($value);
        break;

        case is_array($value):
          $out[$key] = $this->objectToArray($value);
        break;

        default:
          $out[$key] = $value;
        break;
      }
    }

    return $out;
  }

  /**
   * set or get optional parameters
   *
   * if the argument params is null it will reutrn the current parameters,
   * otherwise it will set the params and return itself.
   *
   * @param array $params the optional parameters
   *
   * @return array|AmazonECS depends on params argument
   */
  public function optionalParameters($params = null)
  {
    if (null === $params)
    {
      return $this->responseConfig['optionalParameters'];
    }

    if (false === is_array($params))
    {
      throw new InvalidArgumentException(sprintf(
        "%s is no valid parameter: Use an array with Key => Value Pairs", $params
      ));
    }

    $this->responseConfig['optionalParameters'] = $params;

    return $this;
  }

  /**
   * Set or get the country
   *
   * if the country argument is null it will return the current
   * country, otherwise it will set the country and return itself.
   *
   * @param string|null $country
   *
   * @return string|AmazonECS depends on country argument
   */
  public function country($country = null)
  {
    if (null === $country)
    {
      return $this->responseConfig['country'];
    }

    if (false === in_array(strtolower($country), $this->possibleLocations))
    {
      throw new InvalidArgumentException(sprintf(
        "Invalid Country-Code: %s! Possible Country-Codes: %s",
        $country,
        implode(', ', $this->possibleLocations)
      ));
    }

    $this->responseConfig['country'] = strtolower($country);

    return $this;
  }

  /**
   * Setting/Getting the amazon category
   *
   * @param string $category
   *
   * @return string|AmazonECS depends on category argument
   */
  public function category($category = null)
  {
    if (null === $category)
    {
      return isset($this->requestConfig['category']) ? $this->requestConfig['category'] : null;
    }

    $this->requestConfig['category'] = $category;

    return $this;
  }

  /**
   * Setting/Getting the responsegroup
   *
   * @param string $responseGroup Comma separated groups
   *
   * @return string|AmazonECS depends on responseGroup argument
   */
  public function responseGroup($responseGroup = null)
  {
    if (null === $responseGroup)
    {
      return $this->responseConfig['responseGroup'];
    }

    $this->responseConfig['responseGroup'] = $responseGroup;

    return $this;
  }

  /**
   * Setting/Getting the returntype
   * It can be an object or an array
   *
   * @param integer $type Use the constants RETURN_TYPE_ARRAY or RETURN_TYPE_OBJECT
   *
   * @return integer|AmazonECS depends on type argument
   */
  public function returnType($type = null)
  {
    if (null === $type)
    {
      return $this->responseConfig['returnType'];
    }

    $this->responseConfig['returnType'] = $type;

    return $this;
  }

  /**
   * Setter/Getter of the AssociateTag.
   * This could be used for late bindings of this attribute
   *
   * @param string $associateTag
   *
   * @return string|AmazonECS depends on associateTag argument
   */
  public function associateTag($associateTag = null)
  {
    if (null === $associateTag)
    {
      return $this->requestConfig['associateTag'];
    }

    $this->requestConfig['associateTag'] = $associateTag;

    return $this;
  }

  /**
   * @deprecated use returnType() instead
   */
  public function setReturnType($type)
  {
    return $this->returnType($type);
  }

  /**
   * Setting the resultpage to a specified value.
   * Allows to browse resultsets which have more than one page.
   *
   * @param integer $page
   *
   * @return AmazonECS
   */
  public function page($page)
  {
    if (false === is_numeric($page) || $page <= 0)
    {
      throw new InvalidArgumentException(sprintf(
        '%s is an invalid page value. It has to be numeric and positive',
        $page
      ));
    }

    $this->responseConfig['optionalParameters'] = array_merge(
      $this->responseConfig['optionalParameters'],
      array("ItemPage" => $page)
    );

    return $this;
  }

  /**
   * Enables or disables the request delay.
   * If it is enabled (true) every request is delayed one second to get rid of the api request limit.
   *
   * Reasons for this you can read on this site:
   * https://affiliate-program.amazon.com/gp/advertising/api/detail/faq.html
   *
   * By default the requestdelay is disabled
   *
   * @param boolean $enable true = enabled, false = disabled
   *
   * @return boolean|AmazonECS depends on enable argument
   */
  public function requestDelay($enable = null)
  {
    if (false === is_null($enable) && true === is_bool($enable))
    {
      $this->requestConfig['requestDelay'] = $enable;

      return $this;
    }

    return $this->requestConfig['requestDelay'];
  }
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-11T01:23:54.327

该错误似乎是由您拥有的 PHP 版本未启用 SOAP 扩展引起的。

要解决这个问题，只需启动 wamp，单击 wamp 系统托盘图标。在此屏幕中选择 PHP，然后选择 PHP 扩展。这将显示一个扩展列表。确保 php_soap 被勾选。

如果您打算访问使用 HTTPs 的 soap 服务器，那么您还需要确保 php_openssl 被勾选。

# f# - 有没有办法将 F# Option 类型的支持注入到 ServiceStack 中？

> ID：12830814
> 
> 赞同：7
> 
> 时间：2012-10-11T01:15:54.500
> 
> 标签：f#, servicestack

***下面更新...***

我最近开始在 F# 中试验 ServiceStack，所以我自然而然地开始[移植 Hello World 示例](http://servicestack.net/ServiceStack.Hello/)：

```
open ServiceStack.ServiceHost
open ServiceStack.ServiceInterface
open ServiceStack.WebHost.Endpoints

[<CLIMutable; Route("/hello"); Route("/hello/{Name}")>]
type Hello = { Name : string }

[<CLIMutable>]
type HelloResponse = { Result : string }

type HelloService() =
    inherit Service()

    member x.Any(req:Hello) =
        box { Result = sprintf "Hello, %s!" req.Name }

type HelloAppHost() =
    inherit AppHostBase("Hello Web Services", typeof<HelloService>.Assembly)
    override x.Configure container = ()

type Global() =
    inherit System.Web.HttpApplication()

    member x.Application_Start() =
        let appHost = new HelloAppHost()
        appHost.Init() 
```

这很好用。它非常简洁，易于使用，我喜欢它。但是，我注意到示例中定义的路由允许`Name`不包含参数。当然，`Hello, !`作为输出看起来有点蹩脚。我可以使用，但在 F# 中，通过使用[Option](http://msdn.microsoft.com/en-us/library/dd233245.aspx)类型`String.IsNullOrEmpty`来明确说明可选的事物是惯用的。所以我相应地修改了我的类型，看看会发生什么：`Hello`

```
[<CLIMutable; Route("/hello"); Route("/hello/{Name}")>]
type Hello = { Name : string option } 
```

一旦我这样做了，F# 类型系统就迫使我处理`Name`可能没有值的事实，所以我改为`HelloService`这样来编译所有内容：

```
type HelloService() =
    inherit Service()

    member x.Any(req:Hello) =
        box { Result = 
                match req.Name with
                | Some name -> sprintf "Hello, %s!" name
                | None -> "Hello!" } 
```

当我不提供`Name`参数时，它可以编译并完美运行。但是，当我确实提供名称时...

> KeyValueDataContractDeserializer：转换为类型时出错：类型定义应以“{”开头，期望序列化类型“FSharpOption`1”，字符串开头为：World

当然，这并不完全令人惊讶，但它让我想到了我的问题：

编写一个可以将 type 的实例包装到 type`T`的实例中的函数对我来说是微不足道的`FSharpOption<T>`。**ServiceStack 中是否有任何钩子可以让我在反序列化期间提供这样的功能？**我看了看，但我找不到任何东西，我希望我只是找错地方了。

这对于 F# 的使用比最初看起来更重要，因为在 F# 中定义的类默认情况下不允许为空。因此，将一个类作为另一个类的可选属性的唯一（令人满意的，非 hacky）方法是使用 Option 类型，您猜对了。

* * *

***更新：***

我能够通过进行以下更改来完成这项工作：

在 ServiceStack 源代码中，我公开了这种类型： `ServiceStack.Text.Common.ParseFactoryDelegate`

...我还公开了这个领域： `ServiceStack.Text.Jsv.JsvReader.ParseFnCache`

公开这两件事后，我可以在 F# 中编写这段代码来修改`ParseFnCache`字典。在创建 AppHost 的实例之前，我必须运行此代码 - 如果我在 AppHost 的`Configure`方法中运行它，它就不起作用。

```
JsvReader.ParseFnCache.[typeof<Option<string>>] <- 
    ParseFactoryDelegate(fun () -> 
        ParseStringDelegate(fun s -> (if String.IsNullOrEmpty s then None else Some s) |> box)) 
```

这适用于我的原始测试用例，但除了我必须对 ServiceStack 的内部进行脆弱的更改之外，这很糟糕，因为我必须为每种我希望能够包装在`Option<T>`.

如果我能以通用的方式做到这一点，那会更好。在 C# 术语中，如果我可以向 ServiceStack 提供 a`Func<T, Option<T>>`并且 ServiceStack 将在反序列化其泛型类型定义与我的函数的返回类型匹配的属性时，反序列化`T`然后将结果传递给我的函数，那就太棒了。

像这样的东西会非常方便，但如果它实际上是 ServiceStack 的一部分，而不是我的丑陋黑客可能会破坏其他地方的东西，我可以接受一次包装类型的方法。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-11T11:07:18.847

因此，ServiceStack 中有几个可扩展点，在框架级别上，您可以添加自己的[自定义请求绑定](https://github.com/ServiceStack/ServiceStack/wiki/Serialization-deserialization)器，这允许您提供自己使用的模型绑定器，例如：

```
base.RequestBinders.Add(typeof(Hello), httpReq => {
    var requestDto = ...;
    return requestDto;
}); 
```

但是您需要自己处理不同 Content-Type 的模型绑定，请参阅[CreateContentTypeRequest](https://github.com/ServiceStack/ServiceStack/blob/master/src/ServiceStack/WebHost.Endpoints/Support/EndpointHandlerBase.cs#L91)了解 ServiceStack 是如何做到的。

然后是 JSON 序列化器级别的钩子，例如：

```
JsConfig<Hello>.OnDeserializedFn = dto => newDto; 
```

这使您可以修改返回的类型的实例，但它仍然需要是相同的类型，但看起来 F# 选项修饰符更改了类型的结构定义？

但我愿意添加任何可以使 ServiceStack 更适合 F# 的钩子。`Hello`使用选项将普通类型一般转换为 F#类型的代码是什么样的`Hello`？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-11T10:53:01.023

我能想到的唯一一件事就是用您自己的类型替换选项类型，该类型具有从`string`to的隐式转换`myOption`，以及您需要的任何其他类型。

不是那么好，但可行。您的类型可能还需要可序列化。

```
type myOption = 
   | None 
   | Some of string
   static  member public op_Implicit (s:string) = if s <> null then Some s else None
   member public this.Value = match this with 
                              | Some s -> s
                              | _      -> null
   member this.Opt = match this with 
                     | Some s -> Option.Some s
                     | None   -> Option.None 
```

您的记录类型将是

```
[<CLIMutable>]
type Hello = 
   { Name : myOption } 
```

另一方面，ServiceStack*是*开源的，所以也许可以在那里做点什么。

# delphi - 为什么将 NIL 数组分配给 Variant 会导致在 Delphi 6 中返回非空数组？

> ID：12830822
> 
> 赞同：5
> 
> 时间：2012-10-11T01:17:35.313
> 
> 标签：delphi, dynamic-arrays, variant, delphi-6

**考虑下面的代码，它在 Delphi 6 中编译和运行没有错误。当我恢复动态字符串数组时，我看到的不是在sa**中看到的空数组，而是一个长度为 1 的数组，其中单个元素包含一个空字符串。为什么会这样？如何安全地将 NIL 动态数组分配给 Variant 并正确恢复它？这是代码：

```
TDynamicStringArray = array of string;

var
    V: Variant;
    sa: TDynamicStringArray;
begin
    sa := nil;

    V := sa;

    sa := V;

    OutputDebugString('sa has a single element now with an empty string in it when I expect it to be empty.');
end; 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-11T08:44:20.593

这里有两个错误。

首先在`Variants.DynArrayVariantBounds`. 当动态数组是`nil`this 错误地返回一个低/高边界对`(0, 0)`. 它应该返回`(0, -1)`。此错误已在最新版本的 Delphi 中修复。这会导致`V := sa`返回一个带有单个空元素的变体数组。

第二个错误影响另一个方向，`sa := V`. 这个错误仍然存​​在于最新版本的 Delphi 中。这个错误在`Variants.DynArrayFromVariant`. 有一个`repeat/until`循环遍历输入变量数组并填充输出动态数组。当输入变量数组为空时，不应进入该`repeat/until`循环。但是，代码错误地这样做并尝试使用 读取变体数组的元素`VarArrayGet`。由于数组为空，因此会引发运行时错误。我已经报告了这个：[QC#109445](http://qc.embarcadero.com/wc/qcmain.aspx?d=109445)。

这是修复错误的非常简单的代码。请注意，我只考虑了数组是一维的情况。如果您需要支持更高维的数组，那么您可以扩展这种方法来做到这一点。

```
program Project1;

{$APPTYPE CONSOLE}

uses
  Variants;

var
  OriginalVarFromDynArray: procedure(var V: Variant; const DynArray: Pointer; TypeInfo: Pointer);
  OriginalVarToDynArray: procedure(var DynArray: Pointer; const V: Variant; TypeInfo: Pointer);

function DynArrayVarType(typeInfo: PDynArrayTypeInfo): Integer;
const
  tkDynArray  = 17;
begin
  Result := varNull;
  if (typeInfo<>nil) and (typeInfo.Kind=tkDynArray) then
  begin
    Inc(PChar(typeInfo), Length(typeInfo.name));
    Result := typeInfo.varType;
    if Result=$48 then
      Result := varString;
  end;
  if (Result<=varNull) or (Result=$000E) or (Result=$000F) or ((Result>varInt64) and not (Result=varString)) then
    VarCastError;
end;

procedure VarFromDynArray(var V: Variant; const DynArray: Pointer; TypeInfo: Pointer);
var
  VarType, DynDim: Integer;
begin
  DynDim := DynarrayDim(PDynArrayTypeInfo(TypeInfo));
  if DynDim=1 then
  begin
    //only attempt to deal with 1 dimensional arrays
    if DynArray=nil then begin
      VarClear(V);
      VarType := DynArrayVarType(PDynArrayTypeInfo(TypeInfo));
      if VarType = varString then
        VarType := varOleStr;
      V := VarArrayCreate([0, -1], VarType);
      exit;
    end;
  end;
  OriginalVarFromDynArray(V, DynArray, TypeInfo);
end;

procedure VarToDynArray(var DynArray: Pointer; const V: Variant; TypeInfo: Pointer);
var
  DimCount: Integer;
  Len: Integer;
begin
  DimCount:= VarArrayDimCount(V);
  if DimCount=1 then
  begin
    //only attempt to deal with 1 dimensional arrays
    Len := VarArrayHighBound(V, 1) - VarArrayLowBound(V, 1) + 1;
    if Len=0 then begin
      DynArraySetLength(DynArray, PDynArrayTypeInfo(TypeInfo), 1, @Len);
      exit;
    end;
  end;
  OriginalVarToDynArray(DynArray, V, TypeInfo);
end;

procedure FixVariants;
var
  VarMgr: TVariantManager;
begin
  GetVariantManager(VarMgr);
  OriginalVarFromDynArray := VarMgr.VarFromDynArray;
  VarMgr.VarFromDynArray := VarFromDynArray;
  OriginalVarToDynArray := VarMgr.VarToDynArray;
  VarMgr.VarToDynArray := VarToDynArray;
  SetVariantManager(VarMgr);
end;

type
  TDynamicStringArray = array of string;

var
  V: Variant;
  sa: TDynamicStringArray;
begin
  FixVariants;

  sa := nil;
  V := sa;
  sa := V;

  Writeln(Length(sa));
  Readln;
end. 
```

# java - getExternalFilesDir(null) 抛出 NullPointerException

> ID：12830827
> 
> 赞同：2
> 
> 时间：2012-10-11T01:17:48.747
> 
> 标签：java, android, nullpointerexception

我正在构建一个 Android 应用程序，并且我选择在外部存储中使用扁平苍蝇作为我的持久性方法。我有一个使用一些静态实例方法扩展 Application 的类。调试几次后，我注意到实例变量都不是`null`，并且`NullPointerException`来自内部`Context.getExternalFilesDir(null)`。

我想以它不返回null作为任何答案的开头。此外，我在清单中拥有正确的权限，并检查 SD 卡是否已安装到设备上。

这是保存调用`getExternalFilesDir(null)`并引发错误的类。

```
public class WhileImOut extends Application {

    public static TaskManager taskManager;
    private static Context appContext;

    public WhileImOut() {
        super();
        appContext = this;
        initialize();
    }

    public static void initialize() {
        if (taskManager == null && Environment.getExternalStorageState().equals(Environment.MEDIA_MOUNTED)) {
            try{
            File f = appContext.getExternalFilesDir(null); // Exception being thrown here
            taskManager = new TaskManager(f.getAbsolutePath());
            }catch(NullPointerException e){
                Log.d("Bad","NPE");
            }catch(Exception e){

            }
        }
    }
} 
```

这是在我的 AndroidManifest.xml 中：

```
<uses-permission android:name="android.permission.WRITE_EXTERNAL_STORAGE" /> 
```

任何帮助将不胜感激。我已经为此苦苦挣扎了几个小时，我会接受给出的任何建议。谢谢

EDIT: LogCat information

```
10-10 18:55:56.424: E/AndroidRuntime(964): FATAL EXCEPTION: main
10-10 18:55:56.424: E/AndroidRuntime(964): java.lang.RuntimeException: Unable to resume activity {zsmith.capstone.whileimout/zsmith.capstone.whileimout.TaskListActivity}: java.lang.NullPointerException
10-10 18:55:56.424: E/AndroidRuntime(964):  at android.app.ActivityThread.performResumeActivity(ActivityThread.java:2575)
10-10 18:55:56.424: E/AndroidRuntime(964):  at android.app.ActivityThread.handleResumeActivity(ActivityThread.java:2603)
10-10 18:55:56.424: E/AndroidRuntime(964):  at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:2089)
10-10 18:55:56.424: E/AndroidRuntime(964):  at android.app.ActivityThread.access$600(ActivityThread.java:130)
10-10 18:55:56.424: E/AndroidRuntime(964):  at android.app.ActivityThread$H.handleMessage(ActivityThread.java:1195)
10-10 18:55:56.424: E/AndroidRuntime(964):  at android.os.Handler.dispatchMessage(Handler.java:99)
10-10 18:55:56.424: E/AndroidRuntime(964):  at android.os.Looper.loop(Looper.java:137)
10-10 18:55:56.424: E/AndroidRuntime(964):  at android.app.ActivityThread.main(ActivityThread.java:4745)
10-10 18:55:56.424: E/AndroidRuntime(964):  at java.lang.reflect.Method.invokeNative(Native Method)
10-10 18:55:56.424: E/AndroidRuntime(964):  at java.lang.reflect.Method.invoke(Method.java:511)
10-10 18:55:56.424: E/AndroidRuntime(964):  at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:786)
10-10 18:55:56.424: E/AndroidRuntime(964):  at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:553)
10-10 18:55:56.424: E/AndroidRuntime(964):  at dalvik.system.NativeStart.main(Native Method)
10-10 18:55:56.424: E/AndroidRuntime(964): Caused by: java.lang.NullPointerException
10-10 18:55:56.424: E/AndroidRuntime(964):  at zsmith.capstone.whileimout.TaskListActivity.onResume(TaskListActivity.java:58)
10-10 18:55:56.424: E/AndroidRuntime(964):  at android.app.Instrumentation.callActivityOnResume(Instrumentation.java:1184)
10-10 18:55:56.424: E/AndroidRuntime(964):  at android.app.Activity.performResume(Activity.java:5082)
10-10 18:55:56.424: E/AndroidRuntime(964):  at android.app.ActivityThread.performResumeActivity(ActivityThread.java:2565) 
```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-10-11T01:22:44.513

You are doing your initialization in the constructor; this will not work. You should be doing your initialization in `onCreate()`. When the constructor is invoked, the context has not been properly initialized.

```
public class WhileImOut extends Application {

    public static TaskManager taskManager;
    private static Context appContext;

    public void onCreate() {
        super();
        appContext = this;
        initialize();
    }

    public static void initialize() {
        if (taskManager == null && Environment.getExternalStorageState().equals(Environment.MEDIA_MOUNTED)) {
            try{
            File f = appContext.getExternalFilesDir(null); // Exception being thrown here
            taskManager = new TaskManager(f.getAbsolutePath());
            }catch(NullPointerException e){
                Log.d("Bad","NPE");
            }catch(Exception e){

            }
        }
    }
} 
```

(By the way, is there any reason to have a separate `initialize()` method? If so, is there any reason for it to be `public`?)

# django - 带有 Django Social Auth 和 uwsgi 的 Nginx Bad Gateway

> ID：12830828
> 
> 赞同：0
> 
> 时间：2012-10-11T01:17:53.923
> 
> 标签：django, nginx, uwsgi, django-socialauth

[我的网站在本地正常运行（使用内置的 runserver），但是当使用 nginx 和 uwsgi 运行时，在django-social-auth](https://github.com/omab/django-social-auth)重定向期间我得到了一个错误的网关（502） 。

相关的 nginx error_log：

`IPREMOVED - - [11/Oct/2012:12:10:18 +1100] "GET /complete/google/? ..snip .. HTTP/1.1" 502 574 "-" "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_7_4) AppleWebKit/537.11 (KHTML, like Gecko) Chrome/23.0.1271.26 Safari/537.11"`

uwsgi 日志：

`invalid request block size: 4204 (max 4096)...skip Thu Oct 11 12:16:46 2012 - error parsing request`

刷新错误网关响应重定向并正确登录。每次都会发生这种情况。这里的 nginx 和 uwsgi 日志有不同的时间，因为它们是单独的请求。日志是一致的。

这是我第一次将 django 部署到 nginx，所以我不知道从哪里开始。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-11T02:23:00.700

您是否尝试过增加 uwsgi 缓冲区的大小：

```
-b 32768 
```

[http://comments.gmane.org/gmane.comp.python.wsgi.uwsgi.general/1171](http://comments.gmane.org/gmane.comp.python.wsgi.uwsgi.general/1171)

# python - “a：b”的正则表达式

> ID：12830829
> 
> 赞同：3
> 
> 时间：2012-10-11T01:17:54.877
> 
> 标签：python, regex

一直在努力，试图为自己弄清楚。基本上我正在接受用户输入，它可以有一个像这样的关键字/值结构：
`Blah abc:def lah:123!dfj blah:22:34`
最终应该是
`('abc', 'def', 'lah':'123!dfj', 'blah':'22:34')`

目前我有`(.[^: ]+):(.[^ ]+)`，但这只是获得第一个值。我在这里遗漏了一些明显的东西吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-11T01:25:30.600

您不能期望从正则表达式中得到超过一对，因为现在一组括号可以返回多个匹配项。即使你做了类似的事情`(([^:]+):([^ ]+) ?)*`（这将匹配你的字符串），里面的括号集也只会返回一个匹配项（最后一个）。

如果你想获得更多的配对，你不能通过改变正则表达式来做到这一点，你可以通过一个函数多次应用你的正则表达式来查找所有匹配项，就像`scan`在 Ruby 中一样。

# ruby-on-rails - 使用 link_to 传递非链接字符串，但使其不可点击

> ID：12830833
> 
> 赞同：1
> 
> 时间：2012-10-11T01:18:23.637
> 
> 标签：ruby-on-rails

在我的助手中，我试图将“Category »”放在我的 link_to 之前，但显然不能让它不是链接，下面的代码就是这样做的。不确定最好的方法，所以我想我会休息一下并获得一些帮助。

这是 rails 2.3 和 ruby​​ 1.8.7（我知道我们下周要升级！）

```
 elsif session[:ref].to_f > 0 
    @category = Category.find(session[:ref]).category_name
    link_to  "Category » " + @category, category_catalog_items_path
    end 
```

提前感谢您的帮助

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-11T01:28:03.377

我不知道我是否理解正确，您在链接上制作 'Category' "+ @ category 时遇到问题？首先我建议使用 #{} 而不是 +。

“类别 » #{link_to(@category, category_catalog_items_path)}”

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-11T01:25:25.960

我将假设~~这是 Rails >= 3~~，这是来自辅助模块的代码。试试这个

```
elsif session[:ref].to_f > 0 
    @category = Category.find(session[:ref]).category_name
    "Category » " + link_to  @category, category_catalog_items_path
    end 
```

编辑：

这可能是由 Rails/Ruby-gems 引起的错误造成的，这些错误可能超出您的控制范围，如果我真的坚持这一点，我会使用客户端 JavaScript 来执行此操作。您应该将所有链接归类为某个类，例如“.category”，然后使用 jQuery 将所有链接与该类“.category”进行分类，然后在其前面插入 Category >>。

# windows-phone-7 - 必应地图覆盖了标题面板！为什么？

> ID：12830834
> 
> 赞同：0
> 
> 时间：2012-10-11T01:18:27.057
> 
> 标签：windows-phone-7

我在scrollviewer中放了一个MapControl，但是当我拉起MapControl时，MapControl覆盖了TitlePanel！喜欢这张照片 ![在此处输入图像描述](../Images/93b2017819aa2e0c5dce8e06ad435b40.png) 如何解决这个问题？是系统错误吗？Thx~~~

这是我的 xaml 代码

```
 <Grid x:Name="LayoutRoot" Background="Transparent">
    <Grid.RowDefinitions>
        <RowDefinition Height="Auto"/>
        <RowDefinition Height="*"/>
    </Grid.RowDefinitions>

    <!--TitlePanel 包含應用程式的名稱和頁面標題-->
    <StackPanel x:Name="TitlePanel" Grid.Row="0" Margin="12,17,0,28">
        <TextBlock x:Name="ApplicationTitle" Text="我的應用程式" Style="{StaticResource PhoneTextNormalStyle}"/>
        <TextBlock x:Name="PageTitle" Text="頁面名稱" Margin="9,-7,0,0" Style="{StaticResource PhoneTextTitle1Style}"/>
    </StackPanel>

    <!--ContentPanel - 其他內容置於此-->
    <Grid x:Name="ContentPanel" Grid.Row="1" Margin="12,0,12,0">
        <ScrollViewer>
            <Grid Width="440" Height="258" VerticalAlignment="Top">
                <msMap:Map x:Name="Map" CopyrightVisibility="Collapsed" LogoVisibility="Collapsed" ScaleVisibility="Collapsed"  CredentialsProvider="Al1klJ_w8MPrZ0kntZyMogTJkXb79xyNKVC2XpJuwSPp0NmAbrIuAthSzs5xbomJ">                        
                </msMap:Map>
            </Grid>
        </ScrollViewer>
    </Grid>
</Grid> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-11T03:34:06.467

你的网格边距肯定有一些问题。如果你粘贴你的`xaml`代码。也许我会以更好的方式帮助你

**[更新]**

尝试：这对我有用。

```
 <Grid x:Name="LayoutRoot" Background="Transparent">
    <Grid.RowDefinitions>
        <RowDefinition Height="Auto"/>
        <RowDefinition Height="*"/>
    </Grid.RowDefinitions>

    <!--TitlePanel contains the name of the application and page title-->
    <StackPanel x:Name="TitlePanel" Grid.Row="0" Margin="12,17,0,28">
        <TextBlock x:Name="ApplicationTitle" Text="MY APPLICATION" Style="{StaticResource PhoneTextNormalStyle}"/>
        <TextBlock x:Name="PageTitle" Text="page name" Margin="9,-7,0,0" Style="{StaticResource PhoneTextTitle1Style}"/>
    </StackPanel>

    <!--ContentPanel - place additional content here-->
    <Grid x:Name="ContentPanel" Grid.Row="1" Margin="12,0,12,0">
        <ScrollViewer>
            <Grid MaxHeight="400" VerticalAlignment="Top">
                <my:Map HorizontalAlignment="Stretch" Name="map1" VerticalAlignment="Stretch" />
            </Grid>
        </ScrollViewer>
    </Grid>
</Grid> 
```

# python - 在列表列表中查找索引和总和

> ID：12830838
> 
> 赞同：2
> 
> 时间：2012-10-11T01:19:12.860
> 
> 标签：python, list, csv, sum

你好我有一个我希望是一个容易解决的问题。我正在尝试读取 csv 文件并将一部分写入列表。我需要确定每行中的索引和值，然后进行汇总。

所以该行将有 32 个值...每个值都是一个分类（0 类、1 类等），并带有一个与之关联的数字。我需要一个 pythonic 解决方案来完成这项工作。

```
import os,sys,csv
csvfile=sys.argv[1]
f=open(csvfile,'rt')
reader=csv.reader(f)
classes=[]
for row in reader:
  classes.append(row[60:92])
f.close()

classes = [' ', '1234', '645', '9897'],  [' ', '76541', ' ', '8888'] 
```

我将如何从每个列表中提取索引值以获得每个列表的总和？例如： 0=(' ', ' ') 1=('1234', '76541') 2= ('645', ' ') 3= ('9897', '8888') 然后求每个之和

```
class 0 = 0
class 1 = 77775
class 2 = 645
class3 = 18785 
```

任何帮助将不胜感激

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-11T01:30:37.223

我发现您的用例有点难以理解，但是这个列表理解是否为您提供了一些关于如何解决问题的新想法？

```
>>> classes = [' ', '1234', '645', '9897'],  [' ', '76541', ' ', '8888']
>>> [sum(int(n) for n in x if n != ' ') for x in zip(*classes)]
[0, 77775, 645, 18785] 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-11T04:38:51.727

您可以在浏览 CSV 文件行时求和。（例如，将 for class_ 循环放入您的行循环中）..：

```
>>> classes
[[' ', '1234', '645', '9897'], [' ', '76541', ' ', '8888']]
>>> sums = {}
>>> for row in classes:
...     for class_, num in enumerate(row):
...         try:
...             num = int(num)
...         except ValueError:
...             num = 0
...         sums[class_] = sums.get(class_, 0) + num
...
>>> sums
{0: 0, 1: 77775, 2: 645, 3: 18785} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-11T04:31:35.573

```
>>> classes = [[' ', '1234', '645', '9897'],  [' ', '76541', ' ', '8888']]
>>> my_int = lambda s: int(s) if s.isdigit() else 0
>>> class_groups = dict(zip(range(32), zip(*classes)))
>>> class_groups[1]
('1234', '76541')
>>> class_sums = {}
>>> for class_ in class_groups:
...     group_sum = sum(map(my_int, class_groups[class_]))
...     class_sums[class_] = group_sum
...
>>> class_sums[1]
77775
>>> class_sums[3]
18785
>>> 
```

# algorithm - 多少位足以散列英文网页？

> ID：12830844
> 
> 赞同：0
> 
> 时间：2012-10-11T01:19:47.777
> 
> 标签：algorithm, hash

最近我遇到了一个问题，问有多少位足以用这些假设散列一个网页：

1.  有 10 亿个网页
2.  网页平均长度为300字
3.  我们有 250,000 个英文单词
4.  页面是 ASCII

显然这个问题没有一个正确的答案，但这个问题的目的是看看一般方法是如何工作的。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-11T02:03:38.350

您还没有定义“散列网页”的含义；该短语出现在这个问题和互联网上的其他几个页面中。在那些其他页面中，它用于表示计算校验和（例如使用`sha1sum`）以验证内容是否完整。如果这就是你的意思，那么你需要对任何页面的所有位进行“散列”；平均而言，即 300 * 8 * 平均英语单词长度。题目没有说明平均英文字长，但是如果是五个字母加一个空格，那么每页的平均位数是6*300*8或者14400。

如果你的意思是把所有网页的所有单词放入一个索引结构中，以允许搜索找到包含任何给定单词集的所有网页，一个答案是大约 10^13 位：在一个索引结构中有 3000 亿个单词引用十亿页；每个引用使用 log_2(1G) 位，或者大约 30 位，如果引用是天真的存储的话；因此 9 万亿位，或大约 10^13。您还可以计算出十亿个 URL 的原始存储至少比这小一个数量级，即最多 10^12 位。可以使用特殊方法将引用存储减少几个数量级，但由于 URL 更容易压缩或紧凑保存（例如，通过 trie），引用存储可能仍然远远超过存储 URL 所需的存储量.

# google-app-engine - 如何在由 Google App Engine 托管的网站上集成开源 API？

> ID：12830849
> 
> 赞同：0
> 
> 时间：2012-10-11T01:20:29.740
> 
> 标签：google-app-engine, gwt

我正在制作一个云系统，我想集成一些开源 API，如 Writer、Image Viewer 等。我使用**GWT**框架和**Google App Engine**作为主机服务器我知道我的 API 必须是 Python 或 Java谷歌应用引擎平台支持，所以我搜索了其中一个，发现 API 叫
**Zoho Writer**

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-11T01:24:23.007

如果您正在寻找的是访问 Google 的公共 API，并且您正在使用 Eclipse 和 Google Plugin for Eclipse，那么您有一个按钮可以显示所有具有 GWT 接口的 Google API 列表，并允许您安装每个的客户端库。

见这里：[https ://developers.google.com/eclipse/docs/googleapis](https://developers.google.com/eclipse/docs/googleapis)

# stylesheet - reStructuredText - 如何创建 rst2odt 使用的表格样式？

> ID：12830850
> 
> 赞同：3
> 
> 时间：2012-10-11T01:20:33.943
> 
> 标签：stylesheet, restructuredtext

来自文档：[http ://docutils.sourceforge.net/docs/user/odt.html#styles-used-by-odtwriter](http://docutils.sourceforge.net/docs/user/odt.html#styles-used-by-odtwriter)

> 默认表格样式 - 可选地，通过修改样式表（styles.odt 或副本）中的表格“rststyle-table-0”来更改和自定义默认应用于文档中表格的样式。注意：请勿更改此表的名称。

据我了解，我需要创建一个名为“rststyle-table-0”的表并按照我想要的方式对其进行格式化，然后将其保存为styles.odt。将 rst 转换为 odt 的命令行：

```
rst2odt --stylesheet=styles.odt rst.txt rst.odt 
```

这引发了一个异常：

```
TypeError: cannot serialize None (type NoneType)
Exiting due to error.  Use "--traceback" to diagnose.
Please report errors to <docutils-users@lists.sf.net>.
Include "--traceback" output, Docutils version (0.8.1 [release]),
Python version (2.7.3), your OS type & version, and 
the command line used. 
```

删除表“rststyle-table-0”，该命令工作正常。

* * *

**编辑：**

首先，我发现我做错了。我应该为我的自定义样式表使用文件 styles.odt（安装目录中的 writers/odf_odt/styles.odt）的副本。

其次，异常的原因是因为我的自定义表格没有边框。如果您想要一个无边框的表格，您可以创建一个带有白色边框的表格。

# sql-server-2008 - SQL Server 2008 - 不包括数字范围的数量

> ID：12830854
> 
> 赞同：0
> 
> 时间：2012-10-11T01:21:07.527
> 
> 标签：sql-server-2008, loops

我需要有关 SQL 脚本的帮助。

我有一个`orders`带有一`card_number`列的表，还有另一个表`card_range`，它存储`card_number`每个客户端的范围，并有一列来标记它是否处于活动状态。

当我从`orders`表中选择数据时，我想排除所有`card_number`不活动的范围

例如。`orders`桌子

```
order_id   card_number
1          101
2          102
3          201
4          301 
```

`card_range`表，活动 0 = 否，1 = 是

```
start_card_number end_card_number active
101               199             0
201               299             1
301               399             0 
```

所以我想从订单表返回的唯一数据是

```
order_id card_number
3        201 
```

我试图弄清楚的脚本是通过`card_range`表格循环...谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-11T01:28:28.413

假设卡片范围不重叠：

```
declare @orders as table ( order_id int, card_number int )
insert into @orders ( order_id, card_number ) values
  ( 1, 101 ), ( 2, 102 ), ( 3, 201 ), ( 4, 301 )

declare @card_range as table ( start_card_number int, end_card_number int, active bit )
insert into @card_range ( start_card_number, end_card_number, active ) values
  ( 101, 199, 0 ), ( 201, 299, 1 ), ( 301, 399, 0 )

select order_id, card_number
  from @orders as o inner join
    @card_range as cr on
      cr.start_card_number <= o.card_number and o.card_number <= cr.end_card_number and
      cr.active = 1 
```

# c++ - 什么是 void(*)(void *)

> ID：12830860
> 
> 赞同：7
> 
> 时间：2012-10-11T01:21:33.107
> 
> 标签：c++, c, function-pointers

> **可能重复：**
> [“void *(*)(void *)”在 C++ 中是什么意思？](https://stackoverflow.com/questions/9371171/what-does-void-void-mean-in-c)

void(*)(void *) 类型是什么意思？

我在“Mastering Algorithms with C”一书的示例代码中遇到了这种类型

```
void list_init(List *list, void (*destroy)(void *data)) 
{
...

...
} 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-10-11T01:28:53.220

这是一个函数指针。

```
void (*destroy)(void *data) 
```

`destroy`是一个指向函数的指针，该函数返回`void`并将 a`void*`作为参数。

[cdecl.org](http://cdecl.org/)是识别复杂 C 声明的有用工具。另外，看看[螺旋规则](https://stackoverflow.com/questions/3707096/spiral-rule-and-declaration-follows-usage-for-parsing-c-expressions)。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-11T01:47:14.763

在这种特定情况下，它是一个指针，任何函数都可以转换为 void(*)(void *) 并且函数参数 void * 可以是任何类型。

# java - 如何将 Heapsorts 的 Maxheap 函数的成本从 2lg(n) 降低到 ~lg(n)？（爪哇）

> ID：12830861
> 
> 赞同：0
> 
> 时间：2012-10-11T01:21:48.057
> 
> 标签：java, heapsort, max-heap

这是到目前为止的堆排序程序。

```
public class HeapSort{

private static int[] a;
private static int n;
private static int left_child;
private static int right_child;
private static int largest;

public static void main(String[] args) {
    Scanner input = new Scanner( System.in );
    System.out.println("What size of an array would you like?");
    int y = input.nextInt();
    int[] heapvictim = new int[y];

    for (int z=0;z<heapvictim.length;z++)
    {
        System.out.println("Insert Integer at Array["+z+"]");
        heapvictim[z] = input.nextInt();
    }
    System.out.println("Unsorted Array:");

    for(int z=0;z<heapvictim.length;z++)
        System.out.print(heapvictim[z]+" ");

    System.out.println();
    System.out.println("Sorted Array:");
    sort(heapvictim);
    for(int i=0;i<heapvictim.length;i++){
        System.out.print(heapvictim[i] + " ");
    }
}

public static void sort(int []a0){
    a=a0;
    buildheap(a);        
    for(int i=n;i>0;i--){
        exchange(0, i);
        n=n-1;
        maxheapify(a, 0);
    }
}

public static void buildheap(int []a){
    n=a.length-1;
    for(int i=n/2;i>=0;i--){
        maxheapify(a,i);
    }
}

public static void maxheapify(int[] a, int i){ 
    left_child=2*i+1;
    right_child=2*i+2;
    if(left_child <= n && a[left_child] > a[i]){
        largest=left_child;
    }
    else{
        largest=i;
    }

    if(right_child <= n && a[right_child] > a[largest]){
        largest=right_child;
    }
    if(largest!=i){
        exchange(i,largest);
        maxheapify(a, largest);
    }
}

public static void exchange(int i, int j){
    int t=a[i];
    a[i]=a[j];
    a[j]=t; 
    }
} 
```

在 maxheapify 函数中，要确定是向下堆到左子还是右子，它会进行两次比较。对于最坏的情况，这意味着它将进行两次比较，乘以树的高度（ lg(n) ）。这意味着 maxheapify 的成本为 2*lg(n)。如何更改 maxheapify 使其只需要大约 1*lg(n)？

我得到一个提示说我可以递归地使用二进制搜索，但我一点也不知道如何这样做。

我感谢任何帮助/见解！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-09-10T18:48:15.843

我不这么认为。在 heapify 中，您必须找到 3 个节点的最小值/最大值 - 父节点、左子节点和右子节点。如何在一次比较中找到最小值 3？

无论如何，如果您删除递归并将其放入循环中，您将获得更好的性能 - 假设它还没有进行尾部优化。

如果你仍然好奇，看看[这个](http://www.yendor.com/programming/sort/heapsort.c)和[这个](https://github.com/numpy/numpy/blob/master/numpy/core/src/npysort/heapsort.c.src)快速实现。

# ios - [NSData writeToFile] 写入哪里？

> ID：12830862
> 
> 赞同：6
> 
> 时间：2012-10-11T01:22:18.067
> 
> 标签：ios, objective-c, nsdata, xcode4.5

我写了一个简单的程序来帮助我调试。

```
#import "UIImage+saveScreenShotOnDisk.h"

@implementation UIImage (saveScreenShotOnDisk)

-(void)saveScreenshot{
    NSData * data = UIImagePNGRepresentation(self);
    [data writeToFile:@"foo.png" atomically:YES];
}

@end 
```

执行后，我想知道它`foo.png`的位置。

我去了

```
~Library/Application Support 
```

我找不到`foo.png`。它在哪里？

如果我做

```
BOOL result = [data writeToFile:@"foo.png" atomically:YES]; 
```

结果将是`NO`，这有点奇怪，因为模拟器不像 iPhone，可以在任何地方写。

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2012-10-11T06:39:02.550

您需要将 NSData 对象指向要保存数据的路径：

```
NSString *docsDir;
NSArray *dirPaths;

dirPaths = NSSearchPathForDirectoriesInDomains(NSDocumentDirectory, NSUserDomainMask, YES);
docsDir = [dirPaths objectAtIndex:0];
NSString *databasePath = [[NSString alloc] initWithString: [docsDir stringByAppendingPathComponent:@"foo.png"]];
[data writeToFile:databasePath atomically:YES]; 
```

这会将您的文件保存在设备（或模拟器）上的应用程序文件夹中。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-12-24T06:01:25.807

存储文件的默认位置是存储可执行文件的文件夹。

通过右键单击 Products->YourExecutable 查看可执行文件的存储位置：

![屏幕截图 - 在 finder 可执行文件中显示](../Images/efb8d702a928eb746f8066f7b033baa1.png)

然后在finder中打开。

这里`pawel.plist`资源创建通过

```
NSArray *a = @[@"mybike", @"klapki", @"clapki", @"ah"];
[a writeToFile:@"pawel.plist" atomically:NO]; 
```

![我从代码中完成的 pawel.plist 资源](../Images/6d7488a70729c0ee40b6d2fb263c0941.png)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2016-02-24T03:51:05.993

对于 Swift，基于 Shachar 的回答：

```
let path = NSSearchPathForDirectoriesInDomains(.DocumentDirectory, .UserDomainMask, true)[0] + "/foo.png"
data?.writeToFile(path, atomically: true) 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-10-11T04:42:19.800

你忘了提供你想写的位置或路径。检查这个**writeToFile:options:error:**

将接收器中的字节写入给定路径指定的文件。

```
- (BOOL)writeToFile:(NSString *)path options:(NSDataWritingOptions)mask error:(NSError **)errorPtr 
```

**参数**

**小路**

```
The location to which to write the receiver's bytes. 
```

**面具**

```
A mask that specifies options for writing the data. Constant components are described in “NSDataWritingOptions”. 
```

**错误指针**

```
If there is an error writing out the data, upon return contains an NSError object that describes the problem. 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-10-11T04:49:44.910

您可以搜索“NSDocumentsDirectory”，我通常使用此方法搜索文档目录的路径，然后将我的文件名附加到它。在方法`writeToFile:`中，提供了这个附加的路径。然后使用iTunes>应用程序，滚动到底部，选择您的应用程序，您应该能够看到保存的文件。

PS：您应该在 plist 中设置一个 valur，指定您的应用程序使用手机存储。

# compiler-construction - Ceylon 编译器和 VM

> ID：12830864
> 
> 赞同：1
> 
> 时间：2012-10-11T01:22:26.440
> 
> 标签：compiler-construction, ceylon, vm-implementation

是否有任何锡兰特定的虚拟机？还是所有可用的锡兰编译器都生成 JVM 字节码？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2015-07-26T16:50:56.097

目前（两年后），有用于 JVM 和 JavaScript 的生产就绪编译器。还有两个社区驱动的项目可以创建编译器：

*   Dart 虚拟机，以及
*   LLVM。

这些社区驱动项目的成功将在很大程度上取决于它们吸引了多少社区兴趣和贡献。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-07T17:59:01.210

Ceylon 尚未完成，但据我了解，它首先是一种语言规范，而不是特定的编译器实现，因此它编译成的内容是灵活的。

为了证明其目标代码不可知论，Ceylon 目前正在开发 jvm 和 javascript 的参考编译器。

# php - 使用 file_get_content 获取文件并将文本插入占位符变量

> ID：12830866
> 
> 赞同：0
> 
> 时间：2012-10-11T01:22:32.753
> 
> 标签：php, html, file-get-contents

> **可能重复：**
> [将 php 文件加载到变量时出现问题（将 php 代码的结果而不是代码作为字符串加载）](https://stackoverflow.com/questions/7220830/problem-when-loading-php-file-into-variable-load-result-of-php-code-instead-of)

我正在尝试创建基于模板的应用程序，但在将用户数据写入预先存在的模板文件时遇到问题。

我最初会使用`file_get_contents('template.php');`

和 template.php 将包含以下内容：

```
echo $user; 
```

无论如何使用 将数据插入到模板文件中的占位符变量中`file_get_contents`？

我想我可以使用 DomDocument 或正则表达式将数据插入到占位符字符串中，但这可能与 php 变量有关吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-11T01:24:13.790

如果您可以控制`template.php`并了解安全注意事项，您可能正在寻找`include`或`require`：

```
include('template.php'); 
```

会做你想做的事。

编辑

输出缓冲

```
ob_start();
include('template.php');
$result = ob_get_clean(); 
```

# javascript - 如何通过 AJAX 提交复杂的表单（包括文件）？

> ID：12830870
> 
> 赞同：1
> 
> 时间：2012-10-11T01:22:56.643
> 
> 标签：javascript, ajax, forms, html, file-upload

我正在寻找一种通过 ajax 提交相当复杂的表单的机制。想想“浏览器中的电子邮件”。我有多个“保管箱”以允许用户拖放文件附件，但我还需要同时提交其他表单元素。因此，我需要将文件项排队，而不是立即发送它们。

我已经看过 100,000,001 篇关于如何处理拖放的博客文章和 SO 线程。我已经覆盖了。问题是一起提交完整的表格，而不是单独上传文件然后提交表格的其余部分。

我查看了 FormData，但我遇到的示例似乎需要“老派”文件输入。而且由于您无法在 JS 中操作文件输入，因此该机制似乎对我没有用。

我考虑过错开操作（例如提交表单的主要部分，并在成功后使用单独的 XMLHttpRequest 和 FileReader 提交其后面的文件，但如果可能的话，我宁愿一起完成）。

此外，如果有一个支持 IE 的解决方案会很好，但坦率地说，FF 和 Safari 就足够了。任何援助将不胜感激。希望我忽略了一些简单的事情。提前致谢。

# c - ncurses 程序在 PuTTY 以外的任何东西上崩溃

> ID：12830871
> 
> 赞同：4
> 
> 时间：2012-10-11T01:23:14.513
> 
> 标签：c, ncurses

我有一个较旧的基于 ncurses 的程序，它对一些文件（即：安装程序）执行一些简单的 IO。但是，从不同于 PuTTY 的终端，它与 SIGBUS 一起崩溃

```
Program received signal SIGBUS, Bus error.
0x00000000004028b1 in fDisplay (ptr=Variable "ptr" is not available.
) at file_cpy.c:676
676             sprintf(p, " %-36s ", (*ptr)->datainfo.option);
(gdb) where
#0  0x00000000004028b1 in fDisplay (ptr=Variable "ptr" is not available.
) at file_cpy.c:676
#1  0x0000000000402cdb in fredraw (c=0x7fffffffe860) at file_cpy.c:696
#2  0x0000000000401996 in ls_dispatch (c=0x2020202020202020) at ds_cell.c:324
#3  0x0000000000403bf2 in main_dir (c=0x2020202020202020) at file_cpy.c:811
#4  0x0000000000403cb3 in main () at file_cpy.c:1345
(gdb) x/i $pc
0x4028b1 <fDisplay+17>: mov    (%rax),%rdx
(gdb) 
```

无论 ncurses 版本和 32/64 位架构如何，这都会发生在 Linux 和 FreeBSD 上。我完全被难住了。

fDisplay() 在这里被调用：

```
/*
 * File redraw routine. Draws current list on screen.
 */
int fredraw (CELL * c)
{
        register int row = c->srow;
        dlistptr p = c->list_start;
        int i = 0;
        char buff[200];
        if (c->ecol - c->scol)
                sprintf(buff, "%*s",c->ecol - c->scol + 1, " ");
        while (i <= c->erow - c->srow && p != NULL)
        {
                if (p == c->current) wattron(c->window,A_REVERSE);
                        mvaddstr (row , c->scol, fDisplay(&p));
                if (p == c->current) wattroff(c->window,A_REVERSE);
                        row++; i++;
                p = p->nextlistptr;
        }
        if (row <= c -> erow)
                for (; row <= c -> erow ; row++)
                        mvaddstr(row, c->scol, buff);
        wrefresh(c->window);
        c -> redraw = FALSE;
        return TRUE;
} 
```

fredraw() 在这里被调用：

```
int main_dir(CELL *c) {
int i;

        getcwd(current_path, sizeof(current_path));
        strcat(current_path, "/.config.h");
        load_file(current_path);

        c->keytable = file_cpy_menu;
        c->func_table = file_cpy_table;
        c->ListEntryProc = File_Entry;
        c->UpdateStatusProc = status_update;
        c->redraw = TRUE;
        c->ListExitProc = List_Exit;
        c->ListPaintProc = fredraw;

        c->srow = 3;
        c->scol = 1;
        c->erow = c->window->_maxy - 5;
        c->ecol = c->window->_maxx - 1;
        c->max_rows = c->window->_maxy;
        c->max_cols = c->window->_maxx;

        c->filename = "[ Config ]";
        c->menu_bar = 0;
        c->normcolor = 0x07;
        c->barcolor = 0x1f;
        init_dlist(c);
        for (i = 0; config_type[i].option; i++)
                insert_fdlist(c, &config_type[i]);

        /*
        * Go Do It
        */
        do {
                c->redraw = TRUE;
                ls_dispatch(c);
        } while (c->termkey != ESC && c->termkey != ALT_X);
        return TRUE;
} 
```

最后，main() 调用上述函数：

```
int main() {
    CELL file_cpy = {0};
    WINDOW *mainwin;
    mainwin = initscr();
    start_color();
    setup_colors();
    cbreak();
    noecho();
    keypad(mainwin, TRUE);
    meta(mainwin, TRUE);
    raw();

    leaveok(mainwin, TRUE);
    wbkgd(mainwin, COLOR_PAIR(COLOR_MAIN));
    wattron(mainwin, COLOR_PAIR(COLOR_MAIN));
    werase(mainwin);
    refresh();

    file_cpy.window = mainwin;

    main_dir(&file_cpy);

    wbkgd(mainwin, A_NORMAL);
    werase(mainwin);
    echo();
    nocbreak();
    noraw();
    refresh();
    endwin();
    return TRUE;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-16T10:38:39.200

显然，您正在调用`main_dir`并且`ls_dispatch`指针`c`初始化为`0x2020202020202020`. 虽然并非*完全*不可能，但我觉得这不太可能，而且在我看来，好像你正在用空格**覆盖**指针。

`valgrind`可能会有所帮助，或者某种内存或堆栈保护检查。

为什么这取决于终端，我不能说；可能有一些依赖于 TERM 的代码（例如“分配与屏幕上一样多的行”）。无论如何，这不是错误：这只是将错误公开的*条件。*这种错误通常是由一个硬连线常量引起的，该常量有时会被实际值超出（在上面的示例中，我可以说“分配 96 行”，假设*96 行对每个人来说总是足够的*；而 TERM 与100 行会破坏假设并导致缓冲区溢出）。

它也可能是调试器的工件，看如何`c`在堆栈上分配（但我不这么认为：它应该是`c=0x7fffsomething`- 至少在我检查的系统上）。无论如何，我会通过使`file_cpy`堆动态化来重复这样的测试：

```
int main() {
    CELL *file_cpy = NULL;
    WINDOW *mainwin;

    file_cpy = malloc(sizeof(CELL));

    ...

    file_cpy->window = mainwin;

    main_dir(file_cpy);

    ...
    free(file_cpy); // file_cpy = NULL; // we immediately return
    return TRUE; 
```

然后我会尝试在整个`main_dir`函数中列出指针的值，以防它被覆盖。

# http - 来自网络服务器搜索日志的用户和会话识别

> ID：12830872
> 
> 赞同：0
> 
> 时间：2012-10-11T00:03:40.777
> 
> 标签：http, web, log-analysis

在这里，我有一个 Web 服务器搜索日志（事务日志），其中包含详细信息，例如他/她请求的日期和时间戳、状态代码和许多其他字段的客户端 IP 地址网页。那么通过使用这个网络搜索日志文件，我如何执行用户识别和会话识别呢？谁能帮帮我吗 ....

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-11T06:46:39.400

什么是用户，对你来说什么是会话？

何时“识别”用户？

从原始日志中，用户 = IP，会话 = 一个 IP 的所有请求，中间没有大的时间间隔。只需相应地解析数据，这相当简单。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-06-18T14:58:46.257

有多种方法可以识别用户和会话。一种简单的会话识别方法是超时方法。在该方法中，使用了预定义的阈值。如果两个 tcp 连接之间的到达间隔时间小于阈值，则两个连接属于同一个会话，如果大于阈值，则第一个连接属于当前会话，第二个连接属于下届会议。

# python - Python - 操作乱序

> ID：12830880
> 
> 赞同：0
> 
> 时间：2012-10-11T01:24:28.440
> 
> 标签：python, tkinter

下面的代码应该在按下按钮时抛出指定的 tkMessagebox （例如，如果在选择项目之前按下 update_cost 按钮，它将抛出一个错误。但是，它目前仅在我按下 OK 后显示按下 update_cost 后的按钮。

谁能看到我做错了什么？干杯。（下面的代码示例）。

```
def update_name(self, new_name):
    key=self.get_key_from_selection()  
    if key == None:  
        tkMessageBox.showerror("Update Name","No item selected.")
    else:  
        self.products.get_item(key).set_name(new_name)  
        self.refresh_listbox()

def update_cost(self, new_cost):  
    key=self.get_key_from_selection()  
    if key!=None:  
        item=self.products.get_item(key)  
        if item.get_type()==PART:  
            if new_cost.isdigit():  
                item.set_cost(int(new_cost))  
                self.refresh_listbox()  
            else:  
                tkMessageBox.showerror("Update Cost","Your input should be a number.")  
        else:  
            tkMessageBox.showerror("Update Cost","Action: 'Update_Cost' cannot be performed on a compound item.")  
    else:  
        tkMessageBox.showerror("Update Cost","No item selected.")  

def update_items(self, new_items_list):  
    key=self.get_key_from_selection()  
    if key!=None:  
        item=self.products.get_item(key)  
        if item.get_type()==COMPOUND:  
            # In order to use the internal methods of compound class to check the format and dependence, a temporary compound will recieve new list first before add to the products list..  
            temp=Compound('temp','',self.products,[])  
            try:  
                temp.set_items(new_items_list)  
            except:  
                tkMessageBox.showerror("Update Items","Invalid Items List.")  
                return  
            do=True  
            # Check all the items in the new list to ensure them not conflict any conditions below, or the add operation will not be done.  
            for sub_item in temp.get_depend():  
                if sub_item not in self.products.get_keys():  
                    tkMessageBox.showerror("Update Items","There is at least one item not in the products list.")  
                    do=False  
                    break  
                elif sub_item==item.get_ID():  
                    tkMessageBox.showerror("Update Items","The item could not refer to the compound itself.")  
                    do=False  
                    break  
            if do:  
                item.set_items(new_items_list)  
                self.refresh_listbox()  
        else:  
            tkMessageBox.showerror("Update Items","Invalid Items List.")  
    else:  
        tkMessageBox.showerror("Update Items","No item selected.")  

def push_remove_item(self):  
    key=self.get_key_from_selection()  
    if key!=None:  
        if not self.products.check_depend(key):  
            self.products.remove_item(key)      
            self.refresh_listbox()  
        else:  
            tkMessageBox.showerror("Remove Item","Selected item contained in compound item.")     
    else:  
        tkMessageBox.showerror("Remove Item","No item selected.")  

# Controller part:  

class Controller(object):  
    # This class organise all the controllers in the window.  
    def __init__(self, window):  
        # Initialise the View object.  
        self.view=View(window)  
        self.view.pack(side=TOP, ipady=130)  

        # Initialise the menu.   
        self.menu_bar=Menu(window)  
        window['menu']=self.menu_bar  
        self.file_menu=Menu(self.menu_bar)  
        self.menu_bar.add_cascade(label='File', menu=self.file_menu)  
        self.file_menu.add_command(label='Open Products File', command=self.view.push_open_file)  
        self.file_menu.add_command(label='Save Products File', command=self.view.push_save_file)  
        self.file_menu.add_command(label='Exit', command=exit)  

        # Initialise the function buttons, using a Frame to container layout them.  
        self.control_bar=Frame(window, width=150)  
        self.control_bar.pack(side=TOP, pady=10)  
        self.add_part_button=Button(self.control_bar, text="Add Part", command=self.push_add_part)  
        self.add_part_button.pack(side=LEFT, padx=20, anchor=CENTER)  
        self.add_compound_button=Button(self.control_bar, text="Add Compound", command=self.push_add_compound)  
        self.add_compound_button.pack(side=LEFT, padx=20, anchor=CENTER)  
        self.update_name_button=Button(self.control_bar, text="Update Name", command=self.push_update_name)  
        self.update_name_button.pack(side=LEFT, padx=20, anchor=CENTER)  
        self.update_cost_button=Button(self.control_bar, text="Update Cost", command=self.push_update_cost)  
        self.update_cost_button.pack(side=LEFT, padx=20, anchor=CENTER)  
        self.update_items_button=Button(self.control_bar, text="Update Items", command=self.push_update_items)  
        self.update_items_button.pack(side=LEFT, padx=20, anchor=CENTER)  
        self.remove_item_button=Button(self.control_bar, text="Remove Item", command=self.view.push_remove_item)  
        self.remove_item_button.pack(side=LEFT, padx=20, anchor=CENTER)  

        # Initialise the entry area in the botttom, using a Frame to container layout them.  
        self.entry_area=Frame(window, width=150)  
        self.entry_area.pack(side=BOTTOM, pady=10)  
        self.status=Label(self.entry_area, width=20)  
        self.status.pack(side=LEFT, padx=0, anchor=CENTER)  
        self.entry=Entry(self.entry_area, width=80)  
        self.entry.pack(side=LEFT, padx=0, anchor=CENTER)  
        self.OK_button=Button(self.entry_area, text="OK", command=self.push_OK)  
        self.OK_button.pack(side=LEFT, padx=20, anchor=CENTER)  

    # The next 5 methods will be activated after their corresponded buttons are pushed, the actions of them are to change the commandID variable and label text.  
    # The function of this variable is to set the function statue before typing in the entry box.  

    def push_add_part(self):  
        self.commandID=ADD_PART  
        self.status.config(text="Add Part ID")  

    def push_add_compound(self):  
        self.commandID=ADD_COMPOUND  
        self.status.config(text="Add Compound ID")  

    def push_update_name(self):  
        self.commandID=UPDATE_NAME  
        self.status.config(text="Update Name")  

    def push_update_cost(self):  
        self.commandID=UPDATE_COST  
        self.status.config(text="Update Cost")  

    def push_update_items(self):  
        self.commandID=UPDATE_ITEMS  
        self.status.config(text="Update Compound Items")          

    # The operations setted beofre will only be done after OK button pushed.   
    def push_OK(self):  
        if self.commandID==ADD_PART:  
            self.view.add_part(self.entry.get())  
        elif self.commandID==ADD_COMPOUND:  
            self.view.add_compound(self.entry.get())  
        elif self.commandID==UPDATE_NAME:  
            self.view.update_name(self.entry.get())  
        elif self.commandID==UPDATE_COST:  
            self.view.update_cost(self.entry.get())  
        elif self.commandID==UPDATE_ITEMS:  
            self.view.update_items(self.entry.get())  
        # Clear the label box.  
        self.status.config(text='')  
        # Clear the entry box.  
        self.entry.delete(0, END)  
        # Reset the command statue.  
        self.commandID=None 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-11T14:26:32.043

您已经像这样定义了“update_cost”按钮：

```
self.update_cost_button=Button(..., command=self.push_update_cost)  
...
def push_update_cost(self):  
    self.commandID=UPDATE_COST  
    self.status.config(text="Update Cost") 
```

请注意，`push_update_cost()`您实际上没有调用会生成错误的代码。该错误是由`update_cost`视图上的方法生成的，但该方法仅从 调用`push_OK`，并且`push_OK`仅作为对单击 OK 按钮的响应而被调用。

# javascript - JQuery Mobile 验证插件“必需”不起作用

> ID：12830881
> 
> 赞同：0
> 
> 时间：2012-10-11T01:24:28.983
> 
> 标签：javascript, html, jquery-mobile

首先公开，这是功课。

编辑：好的，所以我现在可以使用插件，但仅适用于数字和电子邮件地址之类的东西，默认的“始终需要”似乎不起作用，这有点重要。综上所述，如果我将表单元素的类设置为“class="required"”，无论它是否有效，它都会始终进行验证，而如果我执行“class="required number"”之类的操作，则验证有效正确。

旧文本：我需要在 JQM 站点上使用 JQuery Validate 插件，其中包含一个表单。学校的指示是，我需要做的就是将一些表单元素的类更改为“必需”或类似的东西，然后只需在表单上调用 .validate 即可。

好吧，我现在已经这样做了几十次，但我无法让它工作，所以也许我的代码中有一些东西导致了这个问题，这里是我的代码的相关部分：

作为说明，在此之前我实际上只与 JQM 合作了大约一周，所以对于任何愚蠢的错误/马虎，我深表歉意。）

表格：

```
<!--Add char form-->
<div data-role="page" id="add-item" data-theme="a" >
    <!--I decided to edit my form from the previous week to be more flexable and generic for use in many different RPGs, and not just Dungeons and Dragons, as it was before.-->

    <div data-role="header">
            <h1>Add New Character</h1>
        </div>
    <div data-role="content">
        <form action="" method="post" data-ajax="false" id="addCharForm">
            <fieldset data-role="controlgroup">
                <label for="dateCreated">Date Created:</label>
            <input type="date" id="dateCreated">
        </fieldset>

        <fieldset data-role="controlgroup">
                <label for="name">Age:</label>
            <input type="text" name="name" id="charAge" value="">
        </fieldset>

        <fieldset data-role="controlgroup">
            <label for="charName">Name:</label>
            <input type="text" id="charName" placeholder="Character Name" class="required">
        </fieldset>

        <fieldset data-role="controlgroup" data-type="horizontal">
            <legend>Choose character gender:</legend>
            <input type="radio" name="gender" id="radioMale" value="Male">
            <label for="radioMale">Male</label>

            <input type="radio" name="gender" id="radioFemale" value="Female">
            <label for="radioFemale">Female</label>
        </fieldset>

        <fieldset data-role="controlgroup">
            <label for="charAttrs">Describe your character's <b>attributes</b> in this field:</label>
            <textarea id="charAttrs"></textarea>
        </fieldset>
        <fieldset data-role="controlgroup">
            <label for="charSkills">Describe your character's <b>skills</b> in this field:</label>
            <textarea id="charSkills"></textarea>
        </fieldset>
        <fieldset data-role="controlgroup">
            <label for="charBio">Character Biography:</label>
            <textarea id="charBio"></textarea>
        </fieldset>
        <fieldset data-role="controlgroup">
            <label for="charRating">Rate Your Character:</label>
            <input type="range" name="charRating" id="charRating" value="100" min="0" max="100">
        </fieldset>

        <input type="submit" value="Submit Character" data-theme="b">
        <input type="button" id="testBtn" value="Test">
    </form>
    </div>
</div> 
```

JS：

```
$('#add-item').on('pageinit', function(){
console.log("In init");

    var myForm = $('#addCharForm');
        myForm.validate({
        invalidHandler: function(form, validator) {
        },
        submitHandler: function() {
                    var data = myForm.serializeArray();
        //TODO storeData(data);
    }
});
}); 
```

任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-11T01:49:19.007

我认为您必须包含`class="required"`并`<input>`初始化您的表单，如下所示：

```
$("#nameOfTheForm").validate(); 
```

# c++ - 类层次循环 - 高级设计建议

> ID：12830882
> 
> 赞同：0
> 
> 时间：2012-10-11T01:24:42.587
> 
> 标签：c++, oop

在这个程序的高级设计方面，我需要一点帮助。

我正在基于 XML 描述手动创建类对象。它具有定义硬件设置的节点。问题是 XML 中的节点可以简单地按名称指向其他节点。为了能够根据名称快速找到这些节点对象的地址，我使用了地图。这是简化的视图：

```
class XMLfile
{
    public:
        Node* GetNode(const string FeatName);   //Searches through "nodes" map to get pointer to     Node
    private:
         map<std::string, Node*> nodes;
}; 
```

然后我定义节点如下：

```
class Node
{
    public:
        virtual int GetValue();
        virtual int Load(XML_type);
}; 
```

然后根据节点的确切“类型”，我创建了一些带有附加变量的派生类。

```
class Integer: public Node
{
    int IntegerSpecificVar;
    int GetValue();
    int Load(XML_type);
    private:    
       int Value;
       string p_Value;
}; 
```

XML 可以是以下两种之一：

```
<Value>5</value>    Which my object load will load 5 into int Value.
or
<p_Value>NodeName</p_Value>  Which my object loader will load the string into p_Value. 
```

根据 XML 中的对象，GetValue() 返回 int 值或指向具有不同节点名的字符串的指针。如果它是一个指针，我需要获取指向该节点的指针，然后对该对象调用 GetValue。我真正想做的是调用 XML::GetNode(nodename") 但这不符合上下文。

让我的 Node 对象访问该映射的一个想法是创建从 XMLfile 派生的类 Node：

```
class Node: public XMLfile 
```

然后我得到循环引用，因为它还没有加载。如果我在类 Node 和类 XMLfile 之间切换顺序，那么 XMLfile 不知道 Node 类/类型是什么。请注意，目前这一切都在一个大文件中。

如果有人可以就如何更好地安排这一点提供一般性建议，我们将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-11T02:16:18.297

`Node`将 a视为 的特定情况是个坏主意`XMLfile`，因此不要从另一个派生。继承意味着**A 'is-a' B**的关系。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-11T09:27:08.887

快速且可能肮脏的解决方案：

1.  使地图成为 的参数`GetValue`，或
2.  将（const）引用或指向地图的指针存储在`Node`.

# c++ - 分配给类中函数指针的函数

> ID：12830884
> 
> 赞同：2
> 
> 时间：2012-10-11T01:24:51.753
> 
> 标签：c++, class, function-pointers

我有一个处理多项式运算的程序。“操作符”类有一个指向输入字符串的 char 指针，一个指向用于对参数执行操作的浮点类型函数的指针（float，float）。然后是一系列方法，setSymb(char *) 将opChar 指向参数，将opFunc 指针指向操作符对应的函数。但是，当我运行此方法时，在将函数分配给指针函数的行中，当它尝试分配某种内存时，new.cpp 下会出现未处理的异常。这让我很困惑。

```
#include "stckArrClassLib.h"
using namespace stacks;
using namespace conversion;

#define SIDE bool
#define LEFT 0
#define RIGHT 1

class oprt
{
public:
    typedef float (oprt::*fp)(float, float);
private:
    char *opSymb;
    fp opFunc;
    float *lOpnd;
    float *rOpnd;
    oprt *Lnext;
    oprt *Rnext;
    float rslt;
protected:
        float add(float a, float b){return a+b;};
    float mult(float a, float b){return a*b;};
    float div(float a, float b){return a/b;};
    float exp(float a, float b){return powf(a, b);};
    float par(float a, float b){return a;};
public:
    oprt (void) {opFunc=NULL;};
    oprt &setSymb(char *);
    oprt &setNext(SIDE, oprt *);
    oprt &setOpnd(SIDE, float);
    float evaluate();
    char *getSymb();
    fp getFunc();
    float *getOpnd(SIDE);
    oprt *getNext(SIDE);
};

oprt& oprt::setSymb(char *set)
{
        CArray<char, 8> opStr;
    opStr[0]=*(set), set;
    int i;
    for(i=1; i<7 && (!(set[i]>='0' && set[i]<='9') && !(set[i]=='+' || set[i]=='-' || opStr[i]=='*' || set[i]=='/' || set[i]=='^' || set[i]=='(')); i++)
    opStr[i]=set[i];
    opStr[i]=0;
    if(strcmp((const char *)opStr.arr, "+")==0)
            //problem is here
    opFunc=&oprt::add;
    else if(strcmp((const char *)opStr.arr, "*")==0)
            //and here
    opFunc=&oprt::mult;
    else if(strcmp((const char *)opStr.arr, "/")==0)
            //etc.
    opFunc=&oprt::div;
    else if(strcmp((const char *)opStr.arr, "^")==0)
    opFunc=&oprt::exp;
    else if(strcmp((const char *)opStr.arr, "(")==0 || strcmp((const char *)opStr.arr, ")")==0)
    opFunc=&oprt::par;
        return *this;
}

oprt& oprt::setNext(SIDE side, oprt *next)
{
    if(side==LEFT)
{
    Lnext=next;
    lOpnd=&(next->rslt);
}
else if(side==RIGHT)
{
    Rnext=next;
    rOpnd=&(next->rslt);
}
return *this;
}

float oprt::evaluate()
{
return rslt=(this->*opFunc)(*getOpnd(LEFT), *getOpnd(RIGHT));
}

char *oprt::getSymb()
{
return opSymb;
}

oprt::fp oprt::getFunc()
{
return opFunc;
}

float *oprt::getOpnd(SIDE side)
{
if(!((side==LEFT)? (Lnext==this):(Rnext==this)))
    (side==LEFT? Lnext:Rnext)->evaluate();
return (side==LEFT)? (lOpnd):(rOpnd);
}

oprt *oprt::getNext(SIDE side)
{
return (side==LEFT)? (Lnext):(Rnext);
}

oprt& oprt::setOpnd(SIDE side, float set)
{
(side==LEFT)? (*lOpnd=set):(*rOpnd=set);
return *this;
} 
```

这是在`opFunc=&oprt::add`函数中调用的 new.cpp 的摘录`oprt& oprt::setSymb(char *)`

```
extern "C" void * __cdecl _nh_malloc_dbg (
    size_t nSize,
    int nhFlag,
    int nBlockUse,
    const char * szFileName,
    int nLine
    )
{
    int errno_tmp = 0;
    void * pvBlk = _nh_malloc_dbg_impl(nSize, nhFlag, nBlockUse, szFileName, nLine, &errno_tmp);

    if ( pvBlk == NULL && errno_tmp != 0 && _errno())
    {
        errno = errno_tmp; // recall, #define errno *_errno()
    }
    return pvBlk;
} 
```

调用 malloc 时会调用错误。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-11T01:33:39.517

我认为您必须将 typedef 修改为：

```
typedef float (oprt::*fp)(float, float); 
```

您也不想在分配时省略“&”符号：

```
opFunc=&oprt::mult; 
```

# c# - 如何使用淘汰模板指定 mvc3 操作链接

> ID：12830885
> 
> 赞同：0
> 
> 时间：2012-10-11T01:24:52.560
> 
> 标签：c#, asp.net-mvc-3, knockout.js

我有一个淘汰模板（使用 koExternaltemplateEngine_all.js），我想要一个指向控制器/动作的编辑链接。我非常喜欢淘汰赛在 MVVM 方面为我提供的功能，但不确定我是否试图通过在淘汰赛视图中指定操作链接来混合苹果和橙子。我想敲敲什么是完成此任务的最佳方法？

提前致谢！

```
<p>
  <b><span data-bind='text: Title'></span></b>
  <span data-bind='text: ArticleDate'></span>
</p>
<span data-bind='text: BodyText'></span> 
```

就像是

```
<a data-bind="attr: { 'href': '@Url.Action("Details" .. ? 
```

该模型

```
 public class SecureModel
    {
       public SecureModel()
       {

       }

       private List<Article> _articles;

       public List<Article> Announcements
       {
          get
          {
              return _articles;
          }
          set
          {
              _articles = value;
          }
       }
    } 
```

看法

```
 @model UI.Models.SecureModel
    @{
      ViewBag.Title = "Announcements";
    }
    var viewModel = {

    isEditable: ko.observable(false),
    articles: ko.mapping.fromJS([]),
    loadInitialData: function () {
        ko.mapping.fromJS(serverData, dataMappingOptions, viewModel.articles);
    },
    loadUpdatedData: function () {
        ko.mapping.fromJS(serverData, dataMappingOptions, viewModel.articles);
    }
}; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-11T01:58:11.190

如果我正在阅读您的代码，那么您已经将范围限定为`Article`自从您的第一个 KO 数据绑定示例显示 Title、ArticleDate 等......这有点难以判断，因为您没有显示`Article`属性的内容。 ..

如果是这种情况，您应该能够执行以下操作：

```
<a data-bind="attr: { 'href': '@Url.Action("Details", "ControllerName", new {actionParameterName=ArticleModelKeyFieldName}">Details</a> 
```

Where`actionParameterName`是您的操作中的参数名称，并且`ArticleModelKeyFieldName`是您的文章模型上的关键字段。

所以如果你有这样的动作：

```
public ActionResult Details(int articleId)
{
....
} 
```

然后`actionParameterName`是articleId。

# c# - 需要加速转换时间戳的 C# 应用程序

> ID：12830892
> 
> 赞同：4
> 
> 时间：2012-10-11T01:26:10.693
> 
> 标签：c#

我很难让一个小应用程序更快地工作。我不是开发人员，我花了一些时间才让它按原样工作。任何人都可以提供任何建议或替代代码来加快此过程，处理 10m 的输入文件大约需要 1 小时。

下面列出了代码，这里是输入文件的示例。

> 4401,imei:0000000000,2012-09-01 12:12:12.9999

```
using System;
using System.Globalization;
using System.IO;

class Sample 
{
    public static void Main(string[] args) 
    {
if (args.Length == 0)
                {
                    return;
                }

                using (FileStream stream = File.Open(args[0], FileMode.Open, FileAccess.Read, FileShare.ReadWrite))
                {

                    using (StreamReader streamReader = new StreamReader(stream))
                    {
                        System.Text.StringBuilder builder = new System.Text.StringBuilder();
                        while (!streamReader.EndOfStream)
                        {
                            var line = streamReader.ReadLine();
                            var values = line.Split(',');
                            DateTime dt = new DateTime();
                            DateTime.TryParse(values[2], out dt);
                            values[2] = Convert.ToString(dt.Ticks);

                            string[] output = new string[values.Length];
                            bool firstColumn = true;
                            for (int index = 0; index < values.Length; index++)
                            {
                                if (!firstColumn)
                                    builder.Append(',');
                                builder.Append(values[index]);
                                firstColumn = false;

                            }
                            File.WriteAllText(args[1], builder.AppendLine().ToString());

                        }
                    }
                }
            }
} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-11T01:33:36.260

最大的性能损失是每次读取一行时，整个文件（到目前为止已处理）都会写回磁盘。为了快速获胜，请尝试将您的 StringBuilder 移出循环：

```
 System.Text.StringBuilder builder = new System.Text.StringBuilder();

            using (FileStream stream = File.Open(args[0], FileMode.Open, FileAccess.Read, FileShare.ReadWrite))
            {
                using (StreamReader streamReader = new StreamReader(stream))
                {
                    while (!streamReader.EndOfStream)
                    {
                        var line = streamReader.ReadLine();
                        var values = line.Split(',');
                        DateTime dt = new DateTime();
                        DateTime.TryParse(values[2], out dt);
                        values[2] = Convert.ToString(dt.Ticks);

                        string[] output = new string[values.Length];
                        bool firstColumn = true;
                        for (int index = 0; index < values.Length; index++)
                        {
                            if (!firstColumn)
                                builder.Append(',');
                            builder.Append(values[index]);
                            firstColumn = false;
                        }
                        builder.AppendLine();
                    }
                }
            }

            File.WriteAllText(args[1], builder.ToString()); 
```

如果要进一步重构，请更改逗号分隔逻辑：

```
 System.Text.StringBuilder builder = new System.Text.StringBuilder();

            using (FileStream stream = File.Open(args[0], FileMode.Open, FileAccess.Read, FileShare.ReadWrite))
            {
                using (StreamReader streamReader = new StreamReader(stream))
                {
                    while (!streamReader.EndOfStream)
                    {
                        var line = streamReader.ReadLine();
                        var values = line.Split(',');
                        DateTime dt = new DateTime();
                        DateTime.TryParse(values[2], out dt);
                        values[2] = Convert.ToString(dt.Ticks);

                        builder.AppendLine(string.Join(",", values));
                    }
                }
            }

            File.WriteAllText(args[1], builder.ToString()); 
```

**编辑：**为了避免内存使用，删除`Stringbuilder`并使用另一个`FileStream`写入磁盘。您提出的解决方案（使用 a `List`）仍将使用大量内存，并且可能会破坏较大的文件：

```
 using (FileStream input = File.Open(args[0], FileMode.Open, FileAccess.Read, FileShare.ReadWrite))
        using (FileStream output = File.Create(args[1]))
        {
            using (StreamReader streamReader = new StreamReader(input))
            using (StreamWriter streamWriter = new StreamWriter(output))
            {
                while (!streamReader.EndOfStream)
                {
                    var line = streamReader.ReadLine();
                    var values = line.Split(',');
                    DateTime dt = new DateTime();
                    DateTime.TryParse(values[2], out dt);
                    values[2] = Convert.ToString(dt.Ticks);

                    streamWriter.WriteLine(string.Join(",", values));
                }
            }
        } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-11T15:20:40.103

这是我发现可以解决此问题并处理大文件的方法。

感谢@Muzz 和@Vache 的帮助。

```
string line = ""; 
System.IO.StreamReader file = new System.IO.StreamReader("c:/test.txt"); 
List<string> convertedLines = new List<string>(); 
while ((line = file.ReadLine()) != null) 
{
    string[] lineSplit = line.Split(','); 
    DateTime dt = new DateTime(); 
    DateTime.TryParse(lineSplit[2], out dt); 
    lineSplit[2] = Convert.ToString(dt.Ticks); 

    string convertedline = lineSplit[0] + "," + lineSplit[1] + "," + lineSplit[2]; 
    convertedLines.Add(convertedline);
}
file.Close();
File.WriteAllLines("c:/newTest.txt", convertedLines); 
```

# java - 从 Caliper 获取对数基准运行时

> ID：12830895
> 
> 赞同：0
> 
> 时间：2012-10-11T01:26:53.927
> 
> 标签：java, performance, benchmarking, caliper

我最近发现了[Java 的 Caliper 基准框架，](http://code.google.com/p/caliper/)它似乎是一个非常有用的微基准测试工具。我正在使用它为我的向量数学库 ( [vectorz](https://github.com/mikera/vectorz) )运行微基准测试

然而，标准的“SimpleBenchmark”输出给出了一个**线性**运行时图表，如果你有非常不同的执行时间，这不是很有用：

```
 benchmark     ns linear runtime
  Vector3Addition   1.04 =
  Matrix3Rotation   4.92 =
VectorAddMultiple   6.29 =
    MatrixInverse 955.27 ============================== 
```

您如何配置 Caliper 以在图表中输出**对数运行时间？**

我通过代码而不是从命令行运行 Caliper：[source code here](https://github.com/mikera/vectorz/blob/master/src/test/java/mikera/vectorz/performance/PerformanceTest.java)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-11T05:55:35.593

Caliper 在开发的早期就放弃了对数结果显示的支持。您仍然可以通过单击切换在[Web 应用程序中获取它。](http://microbenchmarks.appspot.com/)`linear runtime`

# javascript - SVG 渲染但仅在 Firefox 中被切断 - 为什么？

> ID：12830897
> 
> 赞同：21
> 
> 时间：2012-10-11T01:27:14.160
> 
> 标签：javascript, firefox, svg, cross-browser, d3.js

我正在使用使用 SVG 的 d3js 创建图表。在 www.uscfstats.com/deltas 上查看它（使用 12842311 作为输入值；现在它已经被完全破解了）。

在 Chrome、Safari 和 Firefox 10 上，这按预期呈现了一个完整的图表，占据了整个白框。然而，在更高版本的 Firefox（特别是 15 个）上，SVG 渲染的前 200 像素左右，但其余的被切断了。

当我在 Firebug 中打开页面时，我可以突出显示 HTML 元素，看起来它们都在那里，就好像某个大白框覆盖了我图表底部的 75%（没有任何这样的 HTML元素，虽然）。我在点上有点击事件，渲染的事件我可以点击，但那些不是我可以找到但点击它们什么也不做。

我通过写作解决了这个问题

`var svg = d3.select("#scatterplot").append("svg").attr("width", "100%").attr("height", "100%");`

为什么这行得通，发生了什么？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-10-11T04:32:14.573

发生的事情是，关于 svg 大小应该如何工作的规范得到了澄清，因此它在各种情况下都能更好地工作，并且 Firefox 进行了更新以跟踪更新的规范。特别是，`<svg>`现在大小与其他 CSS 替换元素相同，而不是尝试在各种情况下失败的自动魔术。

特别是，过去缺少宽度和高度属性被视为等同于将它们都设置为 100%，除了它在 CSS 中实际设置宽度或高度时并没有真正发挥作用，而且还有一些其他的问题。所以现在，行为是，如果您设置宽度和高度，它们将被视为表示提示（就像 的宽度和高度属性一样`<img>`），如果您不设置，您将获得默认的 300x150 内在大小，然后您可以使用样式规则将其覆盖为想要的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-05-29T09:10:46.070

我也面临同样的问题

```
.attr("width", window.innerWidth).attr("height",window.innerHeight) 
```

为我工作。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2014-12-17T15:39:32.840

在 Firefox 中，您需要定义您使用的单位：`px`等`%`

因此以下内容对我不起作用：

```
var width = 800,
    height = 600;

var el = d3.select('#d3_element')
    .style('width', width)
    .style('height', height); 
```

但以下确实有效：

```
var el = d3.select('#d3_element')
    .style('width', width + 'px')
    .style('height', height + 'px'); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-11-19T22:39:12.603

奇怪的是，“100%”适用于宽度，但不适用于高度。我结束将两者都设置为 innerWidth/innerHeight。CentOS6 上的 Firefox 31.0。供参考

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-01-23T18:54:24.287

还要仔细检查并确保您没有使用像*innerWidth*或*outerHeight*这样的变量名。这就是我的问题。IE9 和 Chrome 可以很好地呈现它，但 Firefox (33.0) 变得疯狂 - 可能是一个错误。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2019-05-30T00:25:20.530

在 flex 容器中插入 svg 并添加属性 flex: auto; 到 svg。这个对我有用

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2021-10-22T09:50:33.150

尤其是小型 SVG 图标时遇到了这个问题。通过使其大于绘制的图像来编辑 SVG 的 viewBox 属性为我解决了这个问题。

# ruby-on-rails - 任何防止事故数据库数据破坏的heroku/rails方法？

> ID：12830898
> 
> 赞同：0
> 
> 时间：2012-10-11T01:27:16.270
> 
> 标签：ruby-on-rails, heroku, rake

我现在有多个生产 Heroku 应用程序，还有几个正在开发中。

对于正在积极开发的应用程序，我经常在我仍在进行早期开发时运行诸如 heroku run rake db:setup、rake db:seed 之类的命令来重置数据。

在生产应用程序的 heroku 命令提示符下，我可能会意外运行这些命令，这可能会很糟糕。

简而言之，是否可以为 heroku 应用程序 rails 禁用某些 rake 任务（db:reset、db:setup、db:seed）。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-11T02:31:25.613

将任务依赖项添加到适当的“危险”任务中：

```
task :env_check_development => :environment do
    raise Exception.new("CAN ONLY RUN IN DEVELOPMENT") unless ::Rails.env.development?
end

task 'db:migrate' => :env_check_development 
```

然后：

```
$ RAILS_ENV=test rake db:migrate

rake aborted!
CAN ONLY RUN IN DEVELOPMENT 
```

# opencv - 如何使用 CMakeLists.txt 将头目录添加到 C++？

> ID：12830899
> 
> 赞同：1
> 
> 时间：2012-10-11T01:27:21.237
> 
> 标签：opencv, cmake, kinect, openni, point-cloud-library

我已经用 CMakeLists.txt 配置了 OpenNI+PCL+OpenCV。不是我自己写的。只是复制了 PCL 文档的片段、OpenCV 手册和一些我发现的将 OpenNI 集成到一个项目中的代码。我能够构建它并成功找到所有包含和库。当 OpenNI 样本使用 GL/glut.h 或 GLES 或 opengles.h 时，就会出现问题。我不明白如何使用 cmake 将其添加到我的项目中。

我要构建的命令：

```
>projectDir/build/cmake ..
>projectDir/build/make
>projectDir/build/./project 
```

projectDir 有`GLES/` `GL/`

[CMakeLists.txt](http://pastie.org/private/appbpa6uv93a5wbxuubvaw)将帮助许多使用 OpenNI+PCL+OpenCV 的初学者。

# python - 为什么在第二次导入时导入错误变为“无法导入名称”？

> ID：12830901
> 
> 赞同：11
> 
> 时间：2012-10-11T01:27:38.280
> 
> 标签：python, importerror, python-import

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-10-11T02:58:12.410

我可以说明*导致*每个之间差异的原因`import`，但我对 Python 的导入过程不够专业，无法很好地解释*原因。*

```
>>> import sys
>>> before_import = set(sys.modules.keys())
>>> import mypkg
imported module_a
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
  File "mypkg\__init__.py", line 2, in <module>
    yarg  ## cause import error
NameError: name 'yarg' is not defined
>>> after_import = set(sys.modules.keys())
>>> after_import.difference(before_import)
set(['mypkg.module_a']) 
```

当您`import mypkg`成功导入`module_a`并将其添加到`sys.modules`. 然后`mypkg`错误并且*不会*被添加到`sys.modules`字典中。删除该条目允许您重新导入，但出现相同的错误：

```
>>> import sys
>>> del sys.modules['mypkg.module_a']
>>> import mypkg
imported module_a
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
  File "mypkg\__init__.py", line 2, in <module>
    yarg  ## cause import error
NameError: name 'yarg' is not defined 
```

现在，我*认为*正在发生的是：

1.  `import mypkg`开始导入过程`mypkg`

2.  在处理过程`mypkg`中，它*成功地*将其作为自身的子包导入`module_a`并将其添加到`sys.modules`

3.  当它遇到错误时，导入过程失败并且没有留下`mypkg`任何条目`mypkg``sys.modules`

4.  包失败但子包成功的结合与后续导入冲突

这是我能理解的最好的，对不起。Python 的导入过程是一种魔法。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-11T02:50:23.017

我很确定问题是您的包无法加载。您`yarg`在文件中添加了一些废话（单独）`__init__.py`。这意味着`mypkg`无法导入。因此，`mypkg.module_a`也无法导入。

我怀疑你会得到不同的错误，因为 Python 正在对模块状态进行一些缓存。第一次尝试导入`mypkg`其子模块的导入`module_a`是允许的，即使`mypkg`正在加载。`mypkg`第二次，无法正常工作的事实被缓存，因此`mypkg.module_a`由于其父包损坏而无法加载。

# ruby-on-rails - Refactor: Generating a unique slug for a Model

> ID：12830902
> 
> 赞同：1
> 
> 时间：2012-10-11T01:27:41.870
> 
> 标签：ruby-on-rails, ruby, optimization, refactoring

I'm currently generating url slugs dynamically for my models (and implementing to_param/self.from_param to interpret them). My slug generation code feels verbose, and could use a refactor.

How would you refactor this so that it is still readable, but less verbose and perhaps more clear?

**Relationships**

*User* has_many :lists

*List* belongs_to :owner

**Code**

```
def generate_slug
  if self.owner
    slug_found = false
    count      = 0
    temp_slug  = to_slug

    until slug_found
      # increment the count
      count += 1

      # create a potential slug
      temp_slug = if count > 1
        suffix = "_" + count.to_s
        to_slug + suffix
      else
        to_slug
      end

      # fetch an existing slug for this list's owner's lists
      # (i.e. owner has many lists and list slugs should be unique per owner)
      existing = self.owner.lists.from_param(temp_slug)

      # if it doesn't exist, or it exists but is the current list, slug found!
      if existing.nil? or (existing == self)
        slug_found = true
      end
    end

    # set the slug
    self.slug = temp_slug
  else
    Rails.logger.debug "List (id: #{self.id}, slug: #{self.slug}) doesn't have an owner set!"
  end
end 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-11T03:56:07.480

你也许可以这样做

```
def generate_slug
  return Rails.logger.debug "List (id: #{self.id}, slug: #{self.slug}) doesn't have an owner set!" if !self.owner

  count = 1
  begin
    temp_slug = %Q!#{to_slug}#{"_#{count}" if count > 1}!
    existing = self.owner.lists.from_param(temp_slug)

    if existing.nil? or (existing == self)
      self.slug = temp_slug
    end
  end while count += 1
end 
```

但是有两件事。首先，您有一个不好的无限循环。其次，不是每次循环检查对象是否存在以及您需要增加后缀，您最好获取最后一个现有列表并在其后添加一个。

# floating-point - Lua floating point errors in table index

> ID：12830903
> 
> 赞同：4
> 
> 时间：2012-10-11T01:27:43.043
> 
> 标签：floating-point, lua

Usually, I compare two floats by seeing if they are within a range of a very small number. It doesn't work for table keys because you do not know if they exist without knowing their key (if that makes sense).

Example with lua 5.1 on a 64 bit computer:

```
a, b, c = 1.7, -0.8, -0.4
d = a + b + c -- prevents constant folding
print(string.format('%1.20f', d)) --  0.49999999999999989000  (around 0.5)
assert(d ~= 0.5)
t = {[0] = 'foo', [0.5] = 'bar'}
print(t[d]) -- nil  (I want it to print 'bar') 
```

Basically, how can I find a key in a table while accounting for floating point error? I'd want it to work without a comparison to each key in the table, so it can still be fast with big tables. There's probably already a built-in function to do this, but I could not find one.

Any help would be appreciated!

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-11T01:41:31.127

如果您确实必须从来自不同来源的浮点数索引，我建议您将它们转换为固定格式的字符串，您希望保留尽可能多的小数位，并使用这些字符串索引表。

`__newindex`您甚至可以通过为代理表设置适当的元方法来自动实现这一点。

# objective-c - UIManagedDocument 如何找到默认的数据模型文件？

> ID：12830905
> 
> 赞同：2
> 
> 时间：2012-10-11T01:28:13.070
> 
> 标签：objective-c, ios, xcode, core-data

我一直在关注 CS193p 关于核心数据的讲座，并且在插入新的托管对象时遇到了问题。

错误是：

> 由于未捕获的异常**“NSInternalInconsistencyException”**而终止应用程序，原因：“+entityForName：无法在此模型中找到名为“Card”的实体。

我在我的数据模型文件中创建了“卡片”实体。但是我感觉它没有正确找到数据模型文件，因为一起删除该文件会产生相同的错误。我想知道如何确定是否是由于 UIManagedDocument 对象没有找到导致此错误的数据模型。

这是我在控制器类中所做的事情：

```
NSURL *docURL = [[[NSFileManager defaultManager] URLsForDirectory:NSDocumentDirectory inDomains:NSUserDomainMask] lastObject];
NSURL *databaseURL = [docURL URLByAppendingPathComponent:@"Cards Database"];
self.cardsDatabase = [[UIManagedDocument alloc] initWithFileURL:databaseURL];

if (![[NSFileManager defaultManager] fileExistsAtPath:[self.cardsDatabase.fileURL path]]) {
    [self.cardsDatabase saveToURL:self.cardsDatabase.fileURL forSaveOperation:UIDocumentSaveForCreating completionHandler:^(BOOL success) {
        NSLog(@"Done");
    }];
} else if (self.cardsDatabase.documentState == UIDocumentStateClosed) {
    NSLog(@"Closed");
    [self.cardsDatabase openWithCompletionHandler:^(BOOL success) {
        if (success) {
            NSLog(@"Opened");
            [self addSampleData];
        }
    }];
} else if (self.cardsDatabase.documentState == UIDocumentStateNormal) {
    NSLog(@"Normal");
}

- (void)addSampleData
{
    NSManagedObjectContext *context = self.cardsDatabase.managedObjectContext;

    [context performBlockAndWait:^{
        Card *card = [NSEntityDescription insertNewObjectForEntityForName:@"Card" inManagedObjectContext:context];

        card.title = @"Test Title";
    }];

    [self.cardsDatabase saveToURL:self.cardsDatabase.fileURL forSaveOperation:UIDocumentSaveForOverwriting completionHandler:^(BOOL success) {
        NSLog(@"Saved");
    }];
} 
```

错误发生在这一行：

```
Card *card = [NSEntityDescription insertNewObjectForEntityForName:@"Card" inManagedObjectContext:context]; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-11T04:21:06.523

当您更新 Core Data 模型时，可能会发生这种问题，方法是更改​​实体的属性名称，然后在不使用设备上旧版 Core Data 模型的情况下运行（删除）应用程序。除非您打算使用轻迁移或模型映射，否则请注意在您运行应用程序时可能会发生这种情况

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-11T02:25:38.107

尝试重置模拟器（在设备中，删除应用程序），清理构建并再次运行。这应该可以解决与“找不到实体”相关的大部分问题。

# google-app-engine - 使用 Objectify 4 获取实体密钥

> ID：12830906
> 
> 赞同：3
> 
> 时间：2012-10-11T01:28:19.640
> 
> 标签：google-app-engine, objectify

我需要`getKey()`处理这种实体：

```
@Entity
public class Value {
    @Id
    private long id;
    private byte[] value;

    com.googlecode.objectify.Key<Value> getKey() {
        return com.googlecode.objectify.Key.create(Value.class, id); // When executed this line throws NullPointerException
    }

        // Code omitted
} 
```

然而，我之前在版本 3 中使用的模式似乎不再适用。被`@Transient`替换为但是当我用我的函数`@Ignore`注释我得到这个错误：`getKey()``@Ignore`

```
The annotation `@Ignore` is disallowed for this location 
```

所以我只是把它注释掉了。看看它是否会起作用。

此外，

当我运行我的应用程序时，函数会按照上面的注释`getKey()`抛出。`NullPointerException`

那么，获取`@Entity`密钥的模式是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-11T21:13:55.290

您不能创建具有 null 或 0 id 的密钥。Objectify 和数据存储都不允许这样做。

如果你想从一个实体创建一个 Key，首先要确保它有一个有效的 id。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-11T05:52:25.990

注释 @Ignore 仅针对实体的字段，以声明这些字段不会存储在数据存储中。由于 getKey() 是一种方法，因此不应在其上使用 @Ignore 注释。

有关 @Ignore 注释的更多信息，请查看： [http ://objectify-appengine.googlecode.com/git/javadoc/index.html](http://objectify-appengine.googlecode.com/git/javadoc/index.html)

希望这可以帮助！

**更新：**

对于 NPE，不确定是什么问题。你可以尝试用这个替换你的方法，看看它是否有效。

```
com.googlecode.objectify.Key<Value> getKey() {
    return new com.googlecode.objectify.Key<Value>(Value.class, id); 
} 
```

# ruby-on-rails - Rails：表单提交后在视图中访问参数

> ID：12830912
> 
> 赞同：5
> 
> 时间：2012-10-11T01:29:39.417
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3, ruby-on-rails-3.2

`new.html.erb`在我的 Rails 3.2 项目中，我有一个表单可以在其中创建一个新站点`app/views/sites/`

```
<%= form_for(@site) do |site_form| %>
  ...
  <div class="field">
    <%= site_form.label :hash_name %><br />
    <%= site_form.text_field :hash_name %>
  </div>
  ...
  <div class="actions">
    <%= site_form.submit %>
  </div>
<% end %> 
```

然后`create`函数在`sites_controller.rb`

```
def create
  @site = Site.new(params[:site])

  respond_to do |format|
    if @site.save
      format.html { redirect_to @site }
    else
      format.html { render action: "new" }
    end
  end
end 
```

然后在用户提交后，我想显示`hash_name`用户刚刚提交的，在`show.html.erb`

```
You just put in <%= params[:hash_name] %>. 
```

但是访问`params[:hash_name]`不起作用。我怎样才能访问它？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-11T01:38:32.267

只需将它们附加到选项中：

redirect_to @site, :hash_name => 参数[:hash_name]

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-10-11T01:51:11.277

您正在重定向到不同的操作 - 这将重置您传递给创建操作的所有参数。

`hash_name`要么像其他答案建议的那样作为参数传递，要么直接从`@site`对象中获取它。

# java - 小程序中不显示按钮

> ID：12830923
> 
> 赞同：0
> 
> 时间：2012-10-11T01:31:38.960
> 
> 标签：java, applet, awt, keylistener, runnable

以下是我的小程序游戏的*精简代码：*

```
import java.applet.Applet;
import java.awt.event.*;
import java.awt.*;

public class Game extends Applet implements KeyListener, Runnable {
    Button options = new Button("Options");
    Thread thread = new Thread(this);

    public void init() {
        addKeyListener(this);
        thread.start();
    }

    public void paint(Graphics graphics) {
        // draw stuff
    }

    public void run() {
        try {
            while (true) {
                thread.sleep(40);
                repaint();
            }
        } catch (InterruptedException exception) {}
    }

    public void keyPressed(KeyEvent keyEvent) {
        switch (keyEvent.getKeyCode()) {
        case KeyEvent.VK_ESCAPE:
            // pause game
            add(options);
        }
    }

    public void keyReleased(KeyEvent keyEvent) {}
    public void keyTyped(KeyEvent keyEvent) {}
} 
```

我的游戏按预期运行。但是，当用户按下时，`Esc`我想暂停游戏并显示一个选项按钮。

问题是当我按下`Esc`它时会按预期暂停游戏。但是它不会在屏幕上显示按钮。我试图寻找解决方案无济于事。到底发生了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-11T02:02:10.517

对我来说非常好......

```
public class TestApplet02 extends Applet implements KeyListener, Runnable {

    Button options = new Button("Options");
    Thread thread = new Thread(this);
    int y = 0;

    public void init() {
        thread.start();
    }

    @Override
    public void start() {
        SwingUtilities.invokeLater(new Runnable() {
            @Override
            public void run() {
                setLayout(new BorderLayout());
                addKeyListener(TestApplet02.this);
            }
        });
    }

    public void paint(Graphics graphics) {
        super.paint(graphics);
        Graphics2D g2d = (Graphics2D) graphics;
        y++;
        if (y > getHeight()) {
            y = 0;
        }
        g2d.drawLine(0, y, getWidth(), y);
    }

    public void run() {
        try {
            while (true) {
                thread.sleep(40);
                SwingUtilities.invokeLater(new Runnable() {
                    @Override
                    public void run() {
                        repaint();
                    }
                });
            }
        } catch (InterruptedException exception) {
        }
    }

    public void keyPressed(KeyEvent keyEvent) {
        switch (keyEvent.getKeyCode()) {
            case KeyEvent.VK_ESCAPE:
                // pause game
                add(options);
                invalidate();
                revalidate();
        }
    }

    public void keyReleased(KeyEvent keyEvent) {
    }

    public void keyTyped(KeyEvent keyEvent) {
    }
} 
```

从 TrashGod 提供的链接...

> 在applet 中，必须使用invokeAndWait 从init 方法启动GUI 创建任务；否则，init 可能会在创建 GUI 之前返回，这可能会导致 Web 浏览器启动小程序时出现问题。在任何其他类型的程序中，调度 GUI 创建任务通常是初始线程所做的最后一件事，因此它使用 invokeLater 还是 invokeAndWait 并不重要。

**更新**

我遇到的主要问题是：

在您使用转义键处理程序时，如果方向为 0，则暂停选项将永远不会激活...

```
case KeyEvent.VK_ESCAPE:
    direction = -direction;

    if (direction < 0) {
        add(options);
    } else {
        remove(options);
    } 
```

我不得不做的另一件事是打电话`revalidate`...

```
invalidate();
revalidate();
repaint(); 
```

# oracle - pl/sql 嵌套循环

> ID：12830926
> 
> 赞同：3
> 
> 时间：2012-10-11T01:32:01.737
> 
> 标签：oracle, plsql

如何使用 items 表显示数据库中的所有记录？我当前的查询显示项目 894 的信息。我尝试使用循环，但没有运气。

我有两个表，inventory 和 itemid。其中 itemid 有商品编号和描述，库存表有商品的信息，例如尺寸、颜色、价格和手头数量。

```
 set serveroutput on
 DECLARE
    current_item    number(8);      
    totalvalue      number(8,2);
    description     varchar2(50);
    item_id         number(3);

    CURSOR Inventory_Info IS       
      SELECT 
         itemsize
        ,color
        ,curr_price
        ,qoh
        ,curr_price*qoh as Total
    FROM inventory
     WHERE itemid=Current_item;

BEGIN

    current_item:=894;
    totalvAlue:=0;  

    SELECT 
     itemdesc, itemid         
       INTO description, item_id
    FROM item
      WHERE itemid=current_item;

    DBMS_OUTPUT.PUT_LINE('Item ID: ' || TO_CHAR(item_id) || ' Item Description: ' || description);

    OPEN Inventory_Info;
    LOOP
            Fetch Inventory_Info INTO Inventory_rocord;
            EXIT WHEN Inventory_Info%NOTFOUND;

     DBMS_OUTPUT.PUT_LINE('Size: ' || Inventory_record.itemsize);
     DBMS_OUTPUT.PUT_LINE('Color: ' || Inventory_record.color);
     DBMS_OUTPUT.PUT_LINE('Price: ' || Inventory_record.curr_price);
     DBMS_OUTPUT.PUT_LINE('QOH: ' || Inventory_record.qoh);
     DBMS_OUTPUT.PUT_LINE('Value: ' || Inventory_record.total);

     TotalValue:=TotalValue + Inventory_record.total;

     End Loop;

     DBMS_OUTPUT.PUT_LINE('TOTAL VALUE: ' || TotalValue);
 Close Inventory_Info;

    EXCEPTION
       WHEN NO_DATA_FOUND THEN                      
       DBMS_OUTPUT.PUT_LINE('No inventory for Item No. '|| current_item);
    WHEN OTHERS THEN                             
       DBMS_OUTPUT.PUT_LINE('Error Message: '|| SQLERRM);

 END; 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-11T11:59:34.870

如果我们暂时忘记了格式化，这可以使用光标 for 循环更简单地完成。

```
set serveroutput ON
DECLARE
BEGIN
  FOR item_rec IN (SELECT itemdesc, itemid         
                     FROM item
                  ) LOOP
    DBMS_OUTPUT.PUT_LINE('Item ID: ' || TO_CHAR(item_rec.itemid) 
                             || ' Item Description: ' || item_rec.itemdesc);                      

    FOR Inventory_record IN (SELECT itemsize
                                  , color
                                  , curr_price
                                  , qoh 
                                  , curr_price*qoh AS Total
                               FROM inventory
                              WHERE itemid = item_rec.itemid
                            ) LOOP

      DBMS_OUTPUT.PUT_LINE('Size: ' || Inventory_record.itemsize);
      DBMS_OUTPUT.PUT_LINE('Color: ' || Inventory_record.color);
      DBMS_OUTPUT.PUT_LINE('Price: ' || Inventory_record.curr_price);
      DBMS_OUTPUT.PUT_LINE('QOH: ' || Inventory_record.qoh);
      DBMS_OUTPUT.PUT_LINE('Value: ' || Inventory_record.total);

      TotalValue:= TotalValue + Inventory_record.total;

    END LOOP;      
  END LOOP;
END; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-11T15:27:30.693

不要使用嵌套查找，使用*连接*。数据库非常擅长连接，集合操作的性能比逐行处理好很多。

此外，在大多数情况下，您不需要声明游标和变量。使用游标循环，让 Oracle 为您完成繁重的工作。

```
set serveroutput on  
DECLARE     
    totalvalue      number(8,2);
BEGIN      
    totalvAlue:=0;
    FOR inv_itm_rec IN (       
        SELECT    itm.itemid
            , itm.itemdesc
            , inv.itemsize         
            , inv.color         
            ,inv.curr_price         
            ,inv.qoh         
            ,inv.curr_price*inv.qoh as Total     
        FROM inventory  inv   
        JOIN item itm
            ON itm.itemid=inv.itemid
       ) 
     LOOP   
    DBMS_OUTPUT.PUT_LINE('ItemId: ' || inv_itm_rec.itemid);
    DBMS_OUTPUT.PUT_LINE('Description: ' || inv_itm_rec.itemdesc);
    DBMS_OUTPUT.PUT_LINE('Size: ' || inv_itm_rec.itemsize);
    DBMS_OUTPUT.PUT_LINE('Color: ' || inv_itm_rec.color);
    DBMS_OUTPUT.PUT_LINE('Price: ' || inv_itm_rec.curr_price);
    DBMS_OUTPUT.PUT_LINE('QOH: ' || inv_itm_rec.qoh);
    DBMS_OUTPUT.PUT_LINE('Value: ' || inv_itm_rec.total);
    TotalValue:=TotalValue + inv_itm_rec.total;
    END LOOP;
    DBMS_OUTPUT.PUT_LINE('TOTAL VALUE: ' || TotalValue);
END; 
```

请注意，此解决方案假定 evry ITEM 确实具有匹配的 INVENTORY 记录。如果数据模型允许其他任何情况，这将是一个老式的仓库应用程序。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-11T04:17:54.790

您正在使用单独`SELECT..INTO`的来获取`itemid`，但您将 分配`itemid`给单个值并且不要更改它。

查看您的查询，您可以将`itemid`fetch 移动到游标中并加入 2 个表。您将项目提取到 中`inventory_record`，但我在任何地方都看不到它的定义/声明。

在这里，我声明了一个记录类型变量，其中包含您要获取的内容，打开游标，将详细信息获取到该游标中。由于没有明确的 where 条件，它将在 item 和 inventory 表之间执行内部连接并获取与连接条件匹配的所有行。

```
set serveroutput ON

DECLARE
    TYPE inventory_rec IS RECORD (
      itemid item.itemid%TYPE,
      itemdesc item.itemdesc%TYPE,
      itemsize inventory.itemsize%TYPE,
      color inventory.color%TYPE,
      curr_price inventory.curr_price%TYPE,
      qoh inventory.qoh %TYPE,
      total inventory.curr_price%TYPE); -- record type to hold what cursor will be fetching

    inventory_record INVENTORY_REC;
    current_item     NUMBER(8);
    totalvalue       NUMBER(8, 2);
    description      VARCHAR2(50);
    item_id          NUMBER(3);

    CURSOR inventory_info IS
      SELECT itemid,
             itemdesc,
             itemsize,
             color,
             curr_price,
             qoh,
             curr_price * qoh AS Total
      FROM   inventory
             join item USING (itemid);
-- join item & inventory, so that it shows listings for all items present in inventory

BEGIN

    OPEN inventory_info;

    LOOP
        FETCH inventory_info INTO inventory_record;
        EXIT WHEN inventory_info%NOTFOUND;
        dbms_output.Put_line('Current item: '
                             || inventory_record.itemdesc);
        dbms_output.Put_line('Size: '
                             || inventory_record.itemsize);
        dbms_output.Put_line('Color: '
                             || inventory_record.color);
        dbms_output.Put_line('Price: '
                             || inventory_record.curr_price);
        dbms_output.Put_line('QOH: '
                             || inventory_record.qoh);
        dbms_output.Put_line('Value: '
                             || inventory_record.total);

        totalvalue := totalvalue + inventory_record.total;
    END LOOP;

    dbms_output.Put_line('TOTAL VALUE: '
                         || totalvalue);

    CLOSE inventory_info;
EXCEPTION
    WHEN no_data_found THEN
      dbms_output.Put_line('No inventory for Item No. '
                           || current_item);
    WHEN OTHERS THEN
      dbms_output.Put_line('Error Message: '
                           || SQLERRM);
END; 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-10-11T06:08:27.947

如果它只是一份报告（似乎是）。考虑使用`sql*plus`报表格式化命令以您希望的方式显示查询的输出。

这是一个例子：

```
SQL> create table Items(
  2    i_num number,
  3    i_descr varchar2(101),
  4    i_size varchar2(3),
  5    i_price number,
  6    i_qoh number
  7  );

Table created

SQL> create table Inventories(
  2    id number,
  3    i_num number
  4  );

Table created

SQL> insert into items(i_num,i_size,i_price,i_qoh,i_descr)
  2    select 1, 'S', 123, 25, 'Item_1' from dual union all
  3    select 2, 'L', 424, 12, 'Item_1' from dual union all
  4    select 4, 'S', 45,  54, 'Item_4' from dual union all
  5    select 5, 'S', 78,  54, 'Item_4' from dual union all
  6    select 6, 'S', 123, 22, 'Item_5' from dual union all
  7    select 7, 'S', 127, 65, 'Item_5' from dual
  8  ;

6 rows inserted

SQL> commit;

Commit complete

SQL> insert into inventories
  2    select i_num, i_num
  3      from items;

6 rows inserted

SQL> commit;

Commit complete 
```

现在我们的报告：

```
SQL> column i_descr format a10
SQL> column i_size  format a3
SQL> column i_price format 99999
SQL> column i_qoh   format 99999
SQL> column value   format 99999
SQL> break on i_descr skip 2
SQL> compute sum label 'Total: ' of value on i_descr;

SQL> select itm.i_descr
  2       , itm.i_size
  3       , itm.i_price
  4       , itm.i_qoh
  5       , sum(i_price*i_qoh) Value
  6   from inventories inv
  7   join items itm on (inv.i_num = itm.i_num)
  8   group by itm.i_num
  9          , itm.i_descr
 10          , itm.i_size
 11          , itm.i_price
 12          , itm.i_qoh
 13   order by i_descr, i_price;

I_DESCR    I_S    I_PRICE  I_QOH  VALUE
---------- --- ---------- ------ ------
Item_1     S          123     25   3075
           L          424     12   5088
**********                       ------
Total:                             8163

Item_4     L           45     54   2430
           S           78     54   4212
**********                       ------
Total:                             6642

Item_5     S          123     22   2706
           L          127     65   8255
**********                       ------
Total:                            10961

6 rows selected. 
```

# uiscrollview - UIScrollView 中的小错误

> ID：12830927
> 
> 赞同：2
> 
> 时间：2012-10-11T01:32:08.337
> 
> 标签：uiscrollview, ios6, constraints, frame

我终于能够使用约束和自动布局更新我的应用程序。但是，现在我有一些奇怪的行为。我的应用程序翻转到我有我的设置的页面，但是当我返回滚动视图中的分页时很古怪。看起来它在触发时卡在页面之间`viewWillAppear`。我让它记录了 contentOffset。当错误发生时，它实际上报告偏移量为 0.000000 时它还没有一直滚动回来。有什么想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-13T08:36:38.203

好的，我找到了解决我的问题的 hacky 解决方法。我还是没有安装核心的问题。

基本上，我只是恢复对我的 contentView 中心所做的更改。

```
- (void)viewDidLoad
{
    [super viewDidLoad];
    [_contentView addObserver:self forKeyPath:@"center" options:NSKeyValueObservingOptionNew context:nil];
}

- (void)observeValueForKeyPath:(NSString *)keyPath ofObject:(id)object change:(NSDictionary *)change context:(void *)context
{
    if (object == _contentView && [keyPath isEqualToString:@"center"]) {
        if (!_ignoreNextChange) {
            _ignoreNextChange = YES;
            _contentView.frame = CGRectMake(0, 0, _contentView.frame.size.width, _contentView.frame.size.height);
        }
        _ignoreNextChange = NO;
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-06T02:10:01.497

好吧，最后我决定将一个变量设置为 UIScrollView 偏移量 on`scrollViewDidEndDecelerating`并返回到它 on `viewWillAppear`。我仍然对 ScrollView 中的图像有问题，但我将其归因于此时的约束。

# python - 使用 Big Θ 表示法的运行时间

> ID：12830929
> 
> 赞同：6
> 
> 时间：2012-10-11T01:32:24.923
> 
> 标签：python, algorithm, analysis

```
def filter(f, lst):     
    if lst == []: return []
    if f(lst[0]): return [lst[0]] + filter(f, lst[1:])
    return filter(f, lst[1:]) 

def my_reverse(lst):        # Reverse the list
    def reverse_helper(x,y):
        if x == []: return y
        return reverse_helper(x[1:], [x[0]] + y)
    return reverse_helper(lst, []) 

def revfilter_alpha(f, lst):    # Reverse and filter ...
    return my_reverse(filter(f, lst))

def revfilter_beta(f, lst): # Reverse and filter ...
    if lst == []: return []
    return revfilter_beta(f, lst[1:]) + ([lst[0]]  if f(lst[0])  else []) 
```

有人可以向我解释如何确定这些的 Big Θ 符号的运行时间吗？我已经阅读了很多东西，但仍然不知道从哪里开始。

在`filter`中，我认为它是 Θ(n^2)，因为它使用谓词函数 f 检查大小为 n 的列表中的每个元素，并进行 n 个递归调用，因此 n*n。

`revfilter_beta`看起来很相似，只是在过滤时反转，所以这不是 Θ(n^2) 吗？

`revfilter_alpha`过滤然后反向，所以这不是n ^ 2 * n ^ 2 = Θ（n ^ 4）吗？

有人有想法吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-11T01:39:39.000

`filter`有`n`递归调用，但你也对每次迭代进行复制操作`n`，所以你最终得到 Θ(n^2)。如果你“正确地”实现它，它应该是 Θ(n)。

对`my_reverse`.

对`revfilter_beta`.

`revfilter_alpha`只做 a`filter`然后 a `reverse`，所以 Θ(n^2 + n^2) = Θ(n^2)。

* * *

编辑：让我们`filter`再看看。

您要弄清楚的是相对于输入的大小执行了多少操作。`O(n)`意味着在最坏的情况下，您将按照操作顺序进行`n`操作。我说“按顺序”是因为您可以进行`O(n/2)`操作，或者`O(4n)`，但最重要的因素是`n`. 也就是说，随着`n`增长，常数因素变得越来越不重要，所以我们只看非常数因素（`n`在这种情况下）。

`filter`那么，对 size 的列表执行多少操作`n`？

让我们从下往上看。如果`n`是 0 - 一个空列表怎么办？然后它只会返回一个空列表。因此，假设这是 1 次操作。

如果`n`是 1 呢？它将检查是否`lst[0]`应该包括在内——不管调用需要多长时间`f`——然后它会复制列表的其余部分，并对该副本进行递归调用，在这种情况下是一个空列表。所以`filter(1)`需要`f + copy(0) + filter(0)`操作，其中`copy(n)`是复制列表需要`f`多长时间，以及检查是否应包含元素需要多长时间，假设每个元素花费相同的时间。

怎么样`filter(2)`？它将进行 1 次检查，然后复制列表的其余部分并调用`filter`其余部分：`f + copy(1) + filter(1)`。

你已经可以看到模式了。`filter(n)`需要`1 + copy(n-1) + filter(n-1)`.

现在，`copy(n)`只是`n`- 它需要`n`操作以这种方式对列表进行切片。所以我们可以进一步简化：`filter(n) = f + n-1 + filter(n-1)`.

现在您可以尝试扩展`filter(n-1)`几次，看看会发生什么：

```
filter(n) = f + n-1 + filter(n-1)
          = 1 + n-1 + (f + n-2 + filter(n-2))
          = f + n-1 + f + n-2 + filter(n-2)
          = 2f + 2n-3 + filter(n-2)
          = 2f + 2n-3 + (f + n-3 + filter(n-3))
          = 3f + 3n-6 + filter(n-3)
          = 3f + 3n-6 + (f + n-4 + filter(n-4))
          = 4f + 4n-10 + filter(n-4)
          = 5f + 5n-15 + filter(n-5)
          ... 
```

我们可以概括`x`重复吗？那个`1, 3, 6, 10, 15`... 序列是三角形数字 - 即 , , `1`,等。从到的所有数字的总和是。`1+2``1+2+3``1+2+3+4``1``x``x*(x-1)/2`

```
 = x*f + x*n - x*(x-1)/2 + filter(n-x) 
```

现在，什么是`x`？我们会有多少次重复？好吧，您可以看到当`x`=时`n`，您不再有递归 - `filter(n-n)`= `filter(0)`= `1`。所以我们的公式现在是：

```
filter(n) = n*f + n*n - n*(n-1)/2 + 1 
```

我们可以进一步简化：

```
filter(n) = n*f + n^2 - (n^2 - n)/2 + 1
          = n*f + n^2 - n^2/2 + n/2 + 1
          = n^2 - n^2/2 + f*n + n/2 + 1
          = (1/2)n^2 + (f + 1/2)n + 1 
```

所以你有它 - 一个相当详细的分析。那将是`Θ((1/2)n^2 + (f + 1/2)n + 1)`......假设`f`是微不足道的（比如`f`= 1）`Θ((1/2)n^2 + (3/2)n + 1)`。

现在您会注意到，如果`copy(n)`花费了恒定的时间而不是线性的时间（如果`copy(n)`是 1 而不是`n`），那么您将不会`n^2`在那里得到该术语。

我承认，当我`Θ(n^2)`最初说的时候，我并没有在脑海中做这一切。相反，我想：好的，你有`n`递归步骤，每个步骤都会花费`n`大量时间，因为`copy`. `n*n = n^2`，因此`Θ(n^2)`。为了更准确地做到这一点`n`，每一步都会缩小，所以你真的有`n + (n-1) + (n-2) + (n-3) + ... + 1`，最终与上面的数字相同：`n*n - (1 + 2 + 3 + ... + n)`= `n*n - n*(n-1)/2`= `(1/2)n^2 + (1/2)n`，如果我在上面使用`0`而不是 ,也是一样的`f`。同样，如果您有`n`步骤但每个步骤都采取了`1`而不是`n`（如果您不必复制列表），那么您将拥有`1 + 1 + 1 + ... + 1`、`n`times 或简单`n`的 .

但是，这需要更多的直觉，所以我想我也会向你展示你可以应用于任何事情的蛮力方法。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-11T02:38:08.773

您的所有功能都是`O(N^2)`因为它们每个递归步骤都需要时间，并且长度列表中`O(N)`会有步骤。`N``N`

`O(N)`您在函数中执行了两个昂贵的（即）操作。第一个是切片（例如`lst[1:]`）。第二个是列表连接（使用`+`运算符）。

这两个可能都比您预期的要贵，主要是因为 Python 的列表不像其他语言中的列表数据类型。在引擎盖下它们是数组，而不是链表。可以在 O(1) 时间内对链表执行上述操作（尽管`O(1)`切片具有破坏性）。例如，在 Lisp 中，您使用的算法是`O(N)`，而不是`O(N^2)`。

递归在 Python 中也经常是次优的，因为没有[尾调用消除](http://en.wikipedia.org/wiki/Tail_call)。在最近的版本中，Python 的默认递归限制是 1000，所以长列表会破坏纯粹的递归解决方案，除非你在`sys`模块中乱来增加限制。

也可以`O(N)`在 Python 中执行这些算法的一个版本，但您需要尽可能避免上述昂贵的列表操作。我建议不要使用递归，而是使用生成器，这是一种更“pythonic”的编程风格。

使用生成器进行过滤非常容易。内置`filter`函数已经完成了，但您只需几行代码即可编写自己的函数：

```
def my_filter(f, iterable):
    for e in iterable:
        if f(e):
            yield e 
```

颠倒事物的顺序有点复杂，因为您需要能够对源进行随机访问或使用`O(N)`额外的空间（您的算法使用该空间的堆栈，即使列表遵循序列协议并且可以是随机的访问）。内置`reversed`函数仅适用于序列，但这里有一个适用于任何可迭代对象（例如另一个生成器）的版本：

```
def my_reversed(iterable):
    storage = list(iterable)  # consumes all the input!
    for i in range(len(storage)-1, -1, -1):
        yield storage[i] 
```

请注意，与许多生成器不同，this on 在开始产生输出之前会立即消耗其所有输入。不要在无限输入上运行它！

您可以按任意顺序组合它们，并且`my_reversed(filter(f, lst))`应该等效于`filter(f, my_reversed(lst))`（尽管对于后者，使用内置`reversed`函数可能更好）。

上述两个生成器的运行时间（以及它们的组成以任一顺序）将为`O(N)`.

# rest - 从 ColdFusion 使用 Rest API 的问题

> ID：12830932
> 
> 赞同：0
> 
> 时间：2012-10-11T01:33:32.203
> 
> 标签：rest, coldfusion, coldfusion-9

我正在尝试使用 ColdFusion 的 Rest API，但遇到了这个错误。代码和错误如下

```
<cfset theURL = "https://api.dev.net/rest/test/encrypt/124123">
<cfhttp url="#theURL#" result="value" method="get" username="XXX" password="XXX">
<cfhttpparam type="header" name="Accept" value="application/xml">
<cfhttpparam type="header" name="Content-Type" value="application/xml">
</cfhttp> 
```

错误：400 错误请求。未指定内容类型

对此的任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-11T12:34:44.790

`<cfhttpparam>`可以接受**XML**作为类型 (type="XML")，它将请求的内容类型设置为 'text/xml'。在这种情况下， value 属性应该包含 xml 请求的主体。所以试试

```
<cfhttpparam type="XML" value="#your_XML_string#"> 
```

看看这是否有效。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-11T15:10:05.497

您的第一个问题是您将方法设置为“获取”。这用于检索文件。如果您使用的是 resftul 服务，则您“发布”到该服务。

您将遇到的下一个问题是，由于它是一项 SSL 服务，您需要将 SSL 证书安装到您的受信任密钥库中。（谷歌这个）。

您可能会遇到的下一个问题是服务“压缩”响应的位置。如果发生这种情况谷歌 cfhttp 压缩，你会得到你的答案。

# collections - AutoMapper：收集处理期间对每个元素的操作？

> ID：12830937
> 
> 赞同：1
> 
> 时间：2012-10-11T01:33:48.037
> 
> 标签：collections, action, automapper

是否可以对使用 AutoMapper 从源复制到目标集合的每个对象调用方法？目标对象有一个名为 Decrypt() 的方法，我希望为创建的每个 CustomerDTO 元素调用它。我唯一能想到的是执行映射转换，然后再次循环调用 Decrypt() 方法。感谢您对这个问题的帮助。

谢谢，

麦克风

```
IQueryable<CustomerDTO> dtos = AutoMapper.Mapper.Map<IQueryable<CustomerEntity>,     IQueryable<CustomerDTO>>((BaseRepository.List));

foreach (var item in dtos)
{
    item.Decrypt(Seed);
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-11T04:53:31.767

这取决于您是仅解密一个属性还是整个对象。根据你的问题我不确定。

如果您只是在解密属性，那么我建议您查看 AutoMapper 的[自定义值解析器](https://github.com/AutoMapper/AutoMapper/wiki/Custom-value-resolvers)。它们允许您在解析目标属性时进行控制。

如果您需要解密整个对象，那么我建议您查看 AutoMapper 的[自定义类型转换器](https://github.com/AutoMapper/AutoMapper/wiki/Custom-type-converters)。这使您可以完全控制转换，尽管它确实将自动从 AutoMapper 中取出。

# sed - 在 sed -f 中使用变量（其中 sed 脚本在文件中而不是内联）

> ID：12830940
> 
> 赞同：5
> 
> 时间：2012-10-11T01:34:27.197
> 
> 标签：sed

我们有一个进程可以使用包含`sed`命令的文件来更改管道输入。

我需要用变量值替换输入中的占位符，例如在`-e`我可以运行的单一类型的命令中；

```
$ echo "Today is XX" | sed -e "s/XX/$(date +%F)/"
Today is 2012-10-11 
```

但是我只能指定`sed`文件中的方面（然后将进程指向文件），例如一个名为的文件`replacements.sed`可能包含；

```
s/XX/Thursday/ 
```

很明显；

```
$ echo "Today is XX" | sed -f replacements.sed
Today is Thursday 
```

但是，如果我想使用环境变量或 shell 值，我找不到使其扩展的方法，例如 if `replacements.txt`contains;

```
s/XX/$(date +%F)/ 
```

然后;

```
$ echo "Today is XX" | sed -f replacements.sed
Today is $(date +%F) 
```

在文件文本中包含双引号只会打印双引号。

有谁知道一种能够在`sed`文件中使用变量的方法？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-10-11T05:55:31.557

这可能对您有用（GNU sed）：

```
cat <<\! > replacements.sed
/XX/{s//'"$(date +%F)"'/;s/.*/echo '&'/e}
!
echo "Today is XX" | sed -f replacements.sed 
```

如果您没有 GNU sed，请尝试：

```
cat <<\! > replacements.sed
/XX/{
    s//'"$(date +%F)"'/
    s/.*/echo '&'/
}
!
echo "Today is XX" | sed -f replacements.sed | sh 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-11T01:48:27.973

AFAIK，这是不可能的。您最好的选择是：

**输入文件**

```
aaa
bbb
ccc 
```

**SH脚本**

```
#!/bin/sh

STRING="${1//\//\\/}"   # using parameter expansion to prevent / collisions

shift

sed "
s/aaa/$STRING/
" "$@" 
```

**命令行**

```
./sed.sh "fo/obar" <file path> 
```

**输出**

```
fo/obar
bbb
ccc 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-10-11T02:55:08.593

正如其他人所说，您不能在 sed 脚本中使用变量，但您可以使用添加到您的保持缓冲区的额外前导输入来“伪造”它。例如：

```
[ghoti@pc ~/tmp]$ cat scr.sed 
1{;h;d;};/^--$/g
[ghoti@pc ~/tmp]$ sed -f scr.sed <(date '+%Y-%m-%d'; printf 'foo\n--\nbar\n')
foo
2012-10-10
bar
[ghoti@pc ~/tmp]$ 
```

在此示例中，我使用进程重定向来获取 sed 的输入。“重要”数据由 生成`printf`。您可以改为 cat 文件，或运行其他程序。“变量”由`date`命令生成，并成为脚本的第一行输入。

sed 脚本获取第一行，将其放入 sed 的保持缓冲区，然后删除该行。然后对于任何后续行，如果它匹配双破折号（我们的“宏替换”），它将替换保持缓冲区的内容。并打印，因为这是 sed 的默认操作。

保持缓冲区（g、G、h、H 和 x 命令）代表“高级”sed 编程。但是，一旦您了解了它们的工作原理，它们就会打开 sed fu 的新维度。

注意：此解决方案仅帮助您替换整行。使用保持缓冲区可以替换行内的子字符串，但我无法想象一种方法。

（另一个注意事项：我在 FreeBSD 中执行此操作，它使用的 sed 与您在 Linux 中找到的不同。这可能在 GNU sed 中有效，也可能无效；我没有测试过。）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-11T02:02:02.850

我同意斯普特尼克的观点。我不相信 sed 能够完成这项任务。

但是，您可以即时生成该文件。

您可以将日期更改为固定字符串，例如 `__DAYOFWEEK__`.

创建一个临时文件，使用 sed 替换`__DAYOFWEEK__`为`$(date +%Y)`.

然后用 . 解析你的文件`sed -f $TEMPFILE`。

sed 很棒，但可能是时候使用 perl 之类的东西来即时生成日期了。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2019-08-06T14:01:18.437

要使用 sed 文件在替换表达式中添加换行符，最终对我有用的是转义文字换行符。示例：在字符串 NewLineHere 之后附加一个换行符，那么这对我有用：

```
#! /usr/bin/sed -f
s/NewLineHere/NewLineHere\
/g 
```

不确定这是否重要，但我在 Solaris unix 上，所以肯定不是 GNU sed。

# css - 为什么我身体的背景颜色会溢出边界？

> ID：12830941
> 
> 赞同：3
> 
> 时间：2012-10-11T01:34:27.790
> 
> 标签：css, background-color, document-body

在[此页面](http://result.dabblet.com/gist/3869589/9df1c4de67ae227aecfb57ee16ff9eaade788727)中，我有一个带有蓝色背景的 200x200 主体。

但是背景是否应用于整个窗口？

为什么会这样？

这是代码：[https ://gist.github.com/3869589/9df1c4de67ae227aecfb57ee16ff9eaade788727](https://gist.github.com/3869589/9df1c4de67ae227aecfb57ee16ff9eaade788727)

我测试过的浏览器：FF 16 和 Chrome 22。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-11T01:38:37.087

我会将 200x200 的蓝色盒子放在它自己的标签内。

```
<style> .blue-box{ width:200px; height:200px; background:blue; } </style>

<body>
    <div class="blue-box"></div>
</body> 
```

# iphone - 如何在同一个请求中上传图像和数据？

> ID：12830944
> 
> 赞同：0
> 
> 时间：2012-10-11T01:34:50.703
> 
> 标签：iphone, objective-c, ipad, cocoa-touch

我想知道如何在同一个 NSMutableRequest 中上传图像和一些数据

```
- (void)startAsyncRequest
{
   // Setting of the request
   NSMutableURLRequest *urlRequest = [[NSMutableURLRequest alloc] initWithURL:self.url cachePolicy:NSURLRequestUseProtocolCachePolicy timeoutInterval:20.0];
   [urlRequest setHTTPMethod:self.method];
   [urlRequest setHTTPBody:data];

   // Send the request
   NSURLConnection *connection = [[NSURLConnection alloc] initWithRequest:urlRequest delegate:self];

   if (connection) {
      // Connection succeded 
     self.receiveData = [NSMutableData data];
   } else {
      // Connection Failed
      self.error = @"Connection Failed";
      // Inform the user that the connection failed
      [self.delegate requestFailed:self];
   }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-11T01:44:17.710

您应该模拟一个表单帖子，例如：

```
NSString *boundary = [NSString stringWithString:@\"---------------------------14737809831466499882746641449\"];  
NSString *contentType = [NSString stringWithFormat:@\"multipart/form-data; boundary=%@\",boundary];  
[request addValue:contentType forHTTPHeaderField: @\"Content-Type\"];
/* 
 now lets create the body of the post 
 */  
NSMutableData *body = [NSMutableData data];  

//parameter1  
[body appendData:[[NSString stringWithFormat:@\"\r\n--%@\r\n\",boundary] dataUsingEncoding:NSUTF8StringEncoding]];   
[body appendData:[[NSString stringWithFormat:@\"Content-Disposition: form-data; name=\\"guid\\"\r\n\r\n%@\", [Settings sharedInstance].uploadID] dataUsingEncoding:NSUTF8StringEncoding]];  
[body appendData:[[NSString stringWithFormat:@\"\r\n--%@\r\n\",boundary] dataUsingEncoding:NSUTF8StringEncoding]];  
//Image  
[body appendData:[[NSString stringWithFormat:@\"Content-Disposition: form-data; name=\\"filMyFile\\"; filename=\\"%@\\"\r\n\", fileName] dataUsingEncoding:NSUTF8StringEncoding]];  
[body appendData:[[NSString stringWithString:@\"Content-Type: image/png\r\n\r\n\"] dataUsingEncoding:NSUTF8StringEncoding]];  
[body appendData:[NSData dataWithData:dataObj]];  
[body appendData:[[NSString stringWithFormat:@\"\r\n--%@--\r\n\",boundary] dataUsingEncoding:NSUTF8StringEncoding]];  

// setting the body of the post to the reqeust  
[request setHTTPBody:body]; 
```

# css - CSS 限制 div 溢出到另一个 div

> ID：12830947
> 
> 赞同：0
> 
> 时间：2012-10-11T01:35:09.223
> 
> 标签：css

长期的 Java 程序员，对 CSS/HTML 很陌生。这是我正在开发的投资组合网站。

www.zdware.com/projects.html

使用非大浏览器窗口访问它会迫使我的内容溢出到另一个 div 中。目前，我为其添加了一些填充，因此它并没有完全溢出，但现在内容被向下推（出于某种奇怪的原因，即使似乎有空间。

我正在使用一些“hackish”的东西来有点像：

```
margin-bottom: -10000px;
padding-bottom: 10000px; 
```

对于我中间的两个“列”。这和它有什么关系吗？

我的两列都受此影响。

```
.sidebar1 {
    float: left;
    min-height: 100%;
    min-width:250px;
    width: 20%;
    background-color:gray;
    margin-bottom: -10000px;
    padding-bottom: 10000px;
}
.content {
    padding: 10px 0;
    width: 80%;
    float:right;
}

.content section{
    padding-left:30px;
} 
```

我尝试将 min-width 添加到 .content，但它并没有真正做任何事情。我在页面上确实有更大的图像，但它们应该仍然适合。

视觉上详细说明..

![当浏览器窗口不大（小于 17-18 英寸显示器全屏）时会发生什么](../Images/e0245e603b664d3e10ac57559c90e569.png)

![大浏览器窗口的外观..预期外观](../Images/424924c5934948e9bb1184125887ff57.png)

我希望这个工作的首选方式是缩短非“容器”部分（包含侧边栏和内容标签），而不是容器。

我也觉得这是一个普遍的问题。但是，处理 CSS 的方式时，我觉得如果我实现了其他人的解决方案（基于他们自己的问题），另一段代码最终会阻止它工作。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-11T02:06:07.183

`min-width: 250px;`规则`.sidebar1`是导致div将`.content`自身定位在侧边栏下方的原因。如果你摆脱它，那么你的内容列就会移动到正确的位置。

至于如何处理徽标，我要么将其向下撞以使其适合该空间，要么将其设置为在 css 中具有百分比宽度，因此无论该列有多宽，它始终适合该列。

是的，我会失去 10000px 负边距黑客。

# java - 对于 Java 中的按位运算，我是否需要注意 Java 中的大多数数字类型都是有符号的？

> ID：12830949
> 
> 赞同：4
> 
> 时间：2012-10-11T01:36:10.720
> 
> 标签：java, math, bit-manipulation, signed, primitive-types

这是一个非常基本的问题，但我从来没有完全说服自己我对“没有区别”的直观回答是正确的，所以也许有人有一个很好的方法来理解这一点：

如果我想要对 Java 中的一种原始数字类型做的只是按位算术，我可以简单地将其视为无符号值还是我需要避免负数，即始终将最高位设置为 0 ? 例如，我可以像使用无符号 32 位数字一样使用 int，还是应该只使用最低 31 位？

我正在寻找尽可能一般的答案，但让我举个例子：假设我想存储 32 个标志。如果我使用类似的东西，我可以将它们全部存储在一个 int 中吗

```
store = store & ~(1 << index) | (value << index) 
```

设置标志和`index`类似的`value`东西

```
return (store & (1 << index)) != 0 
```

检索标志`index`？`index`或者，如果我将标志设置为31 为 1 ，我是否会遇到此代码或类似代码的任何问题？

我知道我需要始终使用 >>> 而不是 >> 进行右移，但这是唯一的问题吗？或者当我使用最高位时，是否会出现与负数的二进制补码表示相关的其他问题？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-11T01:41:27.123

> 我知道我需要始终使用 >>> 而不是 >> 进行右移，但这是唯一的问题吗？

是的，这是唯一的担忧。左移对有符号数和无符号数的作用相同；`AND`ing、`OR`ing 和ing 也是如此`XOR`。只要使用`>>>`for 右移，就可以使用有符号的所有 32 位`int`。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-11T10:30:08.370

在这种情况下也有合理的理由使用`>>`（一个常见的情况是直接制作应该为 0 或 -1 的掩码，而不必否定 0 或 1 的掩码），所以根本不用担心. 请注意您正在做的事情，以确保它符合您的意图。

关心签名的操作（即它们具有不同语义的有符号和无符号形式）是：

*   右移
*   除法（Java 中没有无符号形式）
*   模（Java 中没有无符号形式）
*   比较（相等除外）（Java 中没有无符号形式）

不关心签名的操作是：

*   和
*   或者
*   异或
*   添加
*   减法
*   二进制补码否定（`-x`手段`~x + 1`）
*   一个补码（`~x`意思`-x - 1`）
*   左移
*   乘法

# vim - 有没有办法让一个片段在一个单词之后立即起作用？

> ID：12830950
> 
> 赞同：1
> 
> 时间：2012-10-11T01:36:15.817
> 
> 标签：vim, snipmate

每当我尝试在一个单词之后使用一个片段（使用 snipMate）时，没有空格，它就不起作用。所以我必须点击空格，输入我的片段，点击标签，然后消除空格。有没有更好的方法来做到这一点？有没有办法让片段在一个单词之后立即起作用？这就是我的意思：

让我们说我的片段是这样的：

```
snippet test
        <some code>${1}</code>${2} 
```

典型用途：

```
hello test[TAB] 
```

变成这样：

```
hello <some code>|</code> 
```

但如果我试试这个：

```
hellotest[TAB] 
```

它变成了这样：

```
hellotest_____ 
```

**_**是空格。有没有办法来解决这个问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-11T07:38:57.837

Vim 缩写可以是三种类型（full-id、end-id 和 non-id, cp. `:help abbreviations`），这有助于解决这个问题。然而，snipMate 允许片段名称使用所有非空白字符，因此必须依靠空白进行分隔。

您必须修改片段名称的解析，在`plugin/snipMate.vim`，它在函数中`TriggerSnippet()`：

```
let word = matchstr(getline('.'), '\S\+\%'.col('.').'c') 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-11T05:44:33.430

如果这就是您所要求的，则没有这种效果。恐怕您将不得不查看源并自己进行更改。

此外，它可能被视为一种限制，但它绝对不是错误，所以你所追求的是改进，而不是“修复”。不过，我的建议是按设计使用它：让触发器工作，即使它们是另一个词的一部分，也完全没有意义。空格是分隔想法和单词的最自然方式。

# php - 使用 PHP 在一个 SQL 查询中执行多个 UPDATE

> ID：12830956
> 
> 赞同：1
> 
> 时间：2012-10-11T01:36:53.217
> 
> 标签：php, mysql, sql-update

所以我看过[HERE](https://stackoverflow.com/questions/412101/is-it-possible-to-perform-multiple-updates-with-a-single-update-sql-statement)，但由于我正在做的事情的简单性，这似乎有点令人费解。我最多会处理一百个要更新的项目（大多数时候它会更像 40 )

目前我有这样的东西

```
$sql_update = '';
for($x = 0; $x < count($nodes); $x++){
  if($nodes[$x]['loaded'] == 'true'){
    if($nodes[$x]['changed'] == 'true'){
        $sql_update .= 'UPDATE `genetic_decomp`.`tbl_node2view` SET `x` = "'.$nodes[$x]['location']['x'].'", `y` = "'.$nodes[$x]['location']['y'].'" WHERE `tbl_node2view`.`id` = "'.$nodes[$x]['id'].'";'; 
        $sql_update .= 'UPDATE `genetic_decomp`.`tbl_nodes` SET `name` = "'.$nodes[$x]['name'].'", `type` = "'.$nodes[$x]['type'].'" WHERE `tbl_nodes`.`node_id` = "'.$nodes[$x]['id'].'";';
    }
  }
}
if($sql_update != ''){
    $sql_result=mysql_query($sql_update,$connection) or exit("Sql Error".mysql_error());
} 
```

现在，当我让它打印输出时`echo $sql_update`，然后将输出粘贴到 MAMP 中的 SQL 框中，它工作正常.. 遍历并更新我想要的两个表中的行

但是，当我运行上面的代码时，它会吐回来：

```
Sql Error
You have an error in your SQL syntax; 
check the manual that corresponds to your MySQL server version for the right syntax to use near 'UPDATE `genetic_decomp`.`tbl_nodes` SET `name` = "lala", `type` = "p" WHERE `tbl' at line 1 
```

我究竟做错了什么？有更好的方法吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-11T01:39:36.760

您的 SQL 在语法上看起来是正确的（除非我错过了一些简单的东西）。实际问题是因为您使用的是[`mysql_query()`](http://php.net/mysql_query)- 它*不*支持多个语句；因此，您不能`UPDATE`使用此方法同时运行两个查询。

从手册：

> mysql_query() 发送唯一查询（不支持多个查询）

同样，这些`mysql_`方法已被弃用，因此我（和社区）建议您更新代码以使用[`mysqli_`](http://php.net/manual/en/book.mysqli.php)或[`PDO`](http://php.net/manual/en/book.pdo.php)方法——这两种方法都支持在单个语句中进行多个查询。

如果您需要坚持使用`mysql_query()`（而不是重组整个应用程序），只需拆分查询并背靠背运行它们。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-11T01:41:13.530

如果您使用 mysql_query，则需要单独更新它们。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-07-31T17:45:55.960

作为mysqli的替代品，我发现了这个： [http ://www.karlrixon.co.uk/writing/update-multiple-rows-with-different-values-and-a-single-sql-query/](http://www.karlrixon.co.uk/writing/update-multiple-rows-with-different-values-and-a-single-sql-query/)

这个想法

```
UPDATE categories
    SET display_order = CASE id
        WHEN 1 THEN 3
        WHEN 2 THEN 4
        WHEN 3 THEN 5
    END,
    title = CASE id
        WHEN 1 THEN 'New Title 1'
        WHEN 2 THEN 'New Title 2'
        WHEN 3 THEN 'New Title 3'
    END
WHERE id IN (1,2,3) 
```

现实生活中的例子

```
// An array containing the category ids as keys and the new positions as   values
$display_order = array(
    1 => 4,
    2 => 1,
    3 => 2,
    4 => 3,
    5 => 9,
    6 => 5,
    7 => 8,
    8 => 9
);

$ids = implode(',', array_keys($display_order));
$sql = "UPDATE categories SET display_order = CASE id ";
foreach ($display_order as $id => $ordinal) {
    $sql .= sprintf("WHEN %d THEN %d ", $id, $ordinal);
}
$sql .= "END WHERE id IN ($ids)";
echo $sql; 
```

**我的情况**

我收到的数组

```
Array
(
    [0] => stdClass Object
        (
            [movement_id] => 278
            [leg_miles] => 3.5
            [leg_km] => 5.63
        )

    [1] => stdClass Object
        (
            [movement_id] => 279
            [leg_miles] => 
            [leg_km] => 
        )

    [2] => stdClass Object
        (
            [movement_id] => 280
            [leg_miles] => 
            [leg_km] => 
        )

) 
```

我的函数（必须**使用 sprintf 上的浮点数**）

```
 //get ids string
    $ids = "";
    foreach ($movementsData as $movement) {
        $ids .= $movement->movement_id.",";
    }
    $ids = rtrim($ids, ",");

    //MySQL query construct
    $sql = "UPDATE movements SET movement_miles = CASE movement_id ";

    foreach ($movementsData as $movement) {
        $sql .= sprintf("WHEN %d THEN %.2f ", $movement->movement_id, $movement->leg_miles);
    }

    $sql .= "END, ";

    $sql .= "movement_km = CASE movement_id ";

    foreach ($movementsData as $movement) {
        $sql .= sprintf("WHEN %d THEN %.2f ", $movement->movement_id, $movement->leg_km);
    }

    $sql .= "END ";

    $sql .= "WHERE movement_id IN (".$ids.")"; 
```

**最终查询结果**

```
UPDATE movements SET 
    movement_miles = CASE movement_id 
        WHEN 278 THEN 3.50 
        WHEN 279 THEN 0.00 
        WHEN 280 THEN 0.00 
    END, 
    movement_km = CASE movement_id 
        WHEN 278 THEN 5.63 
        WHEN 279 THEN 0.00 
        WHEN 280 THEN 0.00 
    END 
    WHERE movement_id IN (278,279,280) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2019-01-07T02:07:12.510

在 php 中，您使用 mysqli 实例的 multi_query 方法。

来自[php 手册](http://php.net/manual/en/mysqli.quickstart.multiple-statement.php)

> MySQL 可选地允许在一个语句字符串中包含多个语句。一次发送多个语句可以减少客户端-服务器往返，但需要特殊处理。

# java - 如何等到用户关闭框架才能运行其余代码？

> ID：12830957
> 
> 赞同：1
> 
> 时间：2012-10-11T01:37:10.020
> 
> 标签：java, frame, wait

我在这里有这段代码，它是一个调用另一个 jFrame 来编辑内容的按钮，这些内容进入需要用户输入更新的 jTable。我想通过输入相同的按钮使这个更新自动进行，但是当我调用更新 jTable 的函数时什么也没发生，可能是因为 java 机器不等待......

```
private void editarImovelActionPerformed(java.awt.event.ActionEvent evt) // Button {                                             
    int i = 0;
    int linha = tabelaImoveis.getSelectedRow(); // tabelaImoveis = jTable
    if (tabelaImoveis.isRowSelected(linha)) {
        {
            try { 
                Integer codigo = Integer.parseInt(tabelaImoveis.getValueAt(linha, 0).toString());
            } catch (Exception e) { 
                mensagem.message("Linha sem Valor!"); 
                i = 1;
            } finally {
                if (i == 0) { 
                    Integer codigo = Integer.parseInt(tabelaImoveis.getValueAt(linha, 0).toString());
                    for (Imovel imovel : imovelLista) { 

                        if (imovel.getCodigo() == codigo) {                               frmAlterar alterar = new frmAlterar();
                            alterar.setLocationRelativeTo(null); 
                            alterar.setVisible(true);
                            alterar.setDefaultCloseOperation(alterar.DISPOSE_ON_CLOSE);
                            alterar.setarAtributos(imovel);

                        }
                    }
                }
            }
        }
    } else {
        mensagem.message("Select Something!"); // Same as System.out...
    }

    updatejTable(); // This code here I want to execute after the frame "alterar" closes
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-11T01:38:57.407

这个问题的答案与所有​​类似问题的答案相同（并且有很多）：不要使用另一个 JFrame，使用模态 JDialog。

```
 if (i == 0) { 
        Integer codigo = Integer.parseInt(tabelaImoveis.getValueAt(linha, 0).toString());
        for (Imovel imovel : imovelLista) { 
            if (imovel.getCodigo() == codigo) {                               
                frmAlterar alterar = new frmAlterar();  // *** this should be a modal JDialog
                alterar.setLocationRelativeTo(null); 
                // alterar.setVisible(true);
                // alterar.setDefaultCloseOperation(alterar.DISPOSE_ON_CLOSE);
                alterar.setarAtributos(imovel);
                alterar.setVisible(true);
            }
        }
    } 
```

# google-bigquery - 如何在 BigQuery 中实现“喜欢”？

> ID：12830961
> 
> 赞同：11
> 
> 时间：2012-10-11T01:38:29.750
> 
> 标签：google-bigquery

我正在尝试运行一个简单的查询，在[BigQuery](https://en.wikipedia.org/wiki/BigQuery)中限制 like % ，但 LIKE 不在它们的语法中，那么如何实现呢？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-10-11T01:45:31.193

您可以使用 REGEXP_MATCH 函数（请参阅查询参考[页](https://developers.google.com/bigquery/docs/query-reference)）： REGEXP_MATCH('str', 'reg_exp')

而不是使用 LIKE 使用的 % 语法，您应该使用正则表达式（详细语法定义[here](http://code.google.com/p/re2/wiki/Syntax)）

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2016-07-21T00:28:55.727

BigQuery 标准 SQL 正式支持 LIKE - [https://cloud.google.com/bigquery/docs/reference/standard-sql/functions-and-operators#comparison_operators](https://cloud.google.com/bigquery/docs/reference/standard-sql/functions-and-operators#comparison_operators)

而且我认为它也适用于 Legacy SQL！

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2013-04-28T19:33:11.803

如果 str 匹配正则表达式，则 REGEXP_MATCH 返回 true。对于没有正则表达式的字符串匹配，使用 CONTAINS 而不是 REGEXP_MATCH。

[https://developers.google.com/bigquery/docs/query-reference#stringfunctions](https://developers.google.com/bigquery/docs/query-reference#stringfunctions)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2016-07-20T23:25:51.210

如果您知道如何使用 REGEXP_MATCH，它会很棒，但对于那些不确定是否有任何常用的特殊字符（例如“.”、“$”或“？”）的人来说。在查找字符串中，您可以使用`LEFT('str', numeric_expr)`或`RIGHT('str', numeric_expr)`。即，如果您有一个名称列表并希望返回所有您将使用的 LIKE 'sa%' 的名称：

`select name from list where LEFT(name,2)='sa';`（其中 2 是 'sa' 的长度）

此外，如果您想说明一列的值与另一列的值在哪里，您可以将 2 换成`LENGTH(column_with_lookup_strings)`和`='sa'`for `=column_with_lookup_strings`，使其看起来像这样：

`select name from list where LEFT(name,LENGTH(column_with_lookup_strings))= column_with_lookup_strings;`

[https://cloud.google.com/bigquery/query-reference](https://cloud.google.com/bigquery/query-reference)

# ios - IOS推特应用程序添加图像

> ID：12830967
> 
> 赞同：1
> 
> 时间：2012-10-11T01:38:58.553
> 
> 标签：ios, xcode, image, twitter

我正在创建一个与 Twitter 集成的应用程序 .. 并且想知道如何创建一个按钮以在推文中添加设备的图像。还想知道使用哪个框架以及在哪里代码

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-11T05:02:08.500

你可以只使用 twitter 框架，它从 iOS 5 开始就包含了

我使用的代码：

```
- (IBAction)twitter:(id)sender {
    if([TWTweetComposeViewController canSendTweet])
    {
        NSLog(@"Ready to Tweet.");   
        TWTweetComposeViewController *tweetComposer = [[TWTweetComposeViewController alloc] init];
        [tweetComposer setInitialText:[NSString stringWithFormat:@"My message"]];
        [tweetComposer addImage:[UIImage imageNamed:@"114x114"]];
        [tweetComposer addURL:[NSURL URLWithString:@"http://myPage"]];
        tweetComposer.completionHandler = ^(TWTweetComposeViewControllerResult result){
        if(result == TWTweetComposeViewControllerResultDone){
            NSLog(@"Tweeted.");

        } else if(result == TWTweetComposeViewControllerResultCancelled) {
            NSLog(@"Cancelled.");
        }

        [self.navigationController dismissViewControllerAnimated:YES completion:nil];
        };
        [self presentModalViewController:tweetComposer animated:YES];
    }else {
        UIAlertView *alert = [[UIAlertView alloc] initWithTitle:@"Oops"
                                                        message:@"You can't send a tweet right now, make sure your device has an internet connection and you have at least one Twitter account setup"
                                                       delegate:nil
                                              cancelButtonTitle:@"OK"
                                              otherButtonTitles:nil];
            [alert show];
            [alert release];
        }
} 
```

# c# - “对象引用未设置为对象的实例”错误

> ID：12830970
> 
> 赞同：2
> 
> 时间：2012-10-11T01:39:16.363
> 
> 标签：c#, oop, nullreferenceexception, access-modifiers, object-reference

我在弄清楚为什么我在表示层中收到“对象引用未设置为对象的实例”错误时遇到了问题：

**TempAccountManager.Accounts.Add(tempAccount);**

我已经使用 Visual Studios 调试器浏览了代码并创建了帐户。我相信我有一个访问修饰符的问题，不确定。

**表示层**

```
using myBudget.BusinessObject;
using myBudget.BusinessLogic;

namespace myBudget
{
    public partial class NewBudgetWizard : Form
    {

        public int CurrentStep { get; set; }

        public Account TempAccount = new Account();
        public AccountManager TempAccountManager = new AccountManager();

        public NewBudgetWizard()
        {

        private void createAccountList(ListView lvAccounts)
        {

            foreach (ListViewItem lvi in lvAccounts.Items)
            {

                int tempAccNumber = Int32.Parse(lvi.SubItems[0].Text);
                string tempAccName = lvi.SubItems[1].Text;
                string tempAccType = lvi.SubItems[2].Text;
                decimal tempAccBalance = decimal.Parse(lvi.SubItems[3].Text, System.Globalization.NumberStyles.Currency);

                Account tempAccount = new Account(tempAccNumber, tempAccName, tempAccType, tempAccBalance, DateTime.Now);
                TempAccount = new Account(tempAccNumber, tempAccName, tempAccType, tempAccBalance, DateTime.Now);

                TempAccountManager.Accounts.Add(tempAccount);

            }

        }

    }
} 
```

**业务逻辑层**

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Collections;
using myBudget.BusinessObject;

namespace myBudget.BusinessLogic
{
    public class AccountManager : Account
    {

        public List<Account> Accounts { get; set; }

    }
} 
```

**业务对象**

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;

namespace myBudget.BusinessObject
{
    public class Account
    {

        public int AccountID { get; set; }

        public int UserID { get; set; }

        public int Number { get; set; }

        public string Name { get; set; }

        public string Type { get; set; }

        public decimal Balance { get; set; }

        public DateTime ReconcileTimeStamp { get; set; }

        public Account()
        {

        }

        public Account(int number, string name, string type, decimal balance, DateTime reconcileTimeStamp)
        {
            Number = number;
            Name = name;
            Type = type;
            Balance = balance;
            ReconcileTimeStamp = reconcileTimeStamp;
        }

    }
} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-11T01:43:23.123

类`AccountManager`从不初始化`Accounts`属性。因此`TempAccountManager.Accounts`为空。

添加这样的构造函数将修复它。

```
public class AccountManager : Account
{
    public AccountManager()
    {
        Accounts = new List<Account>();
    }

    public List<Account> Accounts { get; set; }

} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-11T01:41:30.830

你`Accounts`在你的`AccountManager`?

你应该在某处做：

```
Accounts = new List<Account>(); 
```

**编辑**

你有公共`set`访问者。你可以这样做：

```
TempAccountManager.Accounts = new List<Account>(); 
```

或者按照 Joel Mueller 的建议为类添加一个构造函数。但是仔细想想，如果你需要公众`set`。它提供了一个机会，可以将您的集合完全替换为对象。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-11T01:43:44.247

不确定，但是您在哪里初始化帐户？

```
public List<Account> Accounts { get; set; } 
```

您的 get、set 接口提供访问权限，但未定义值。

# html - word-break:break-all 单引号显示错误

> ID：12830975
> 
> 赞同：0
> 
> 时间：2012-10-11T01:39:39.443
> 
> 标签：html, css, word-break

```
 <html>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<body>
<table style="width:150px; word-break:break-all;">
    <tr>
        <td>'''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''</td></tr>
        <tr>
        <td>&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;&apos;aaaaaaaaaaaaaaaaaaaa</td></tr>
        <tr>
        <td>eeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeee</td></tr>
</table>
</body>
</html> 
```

但是，显示错误（所有单引号显示在一行中）。我使用了 ' 相反，但它没有用。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-11T03:16:25.660

尝试将此添加到您的 CSS 中：`-ms-word-break: break-all;`

# c# - 如何检查日期是否在 XPath 中的其他两个日期之间

> ID：12830976
> 
> 赞同：1
> 
> 时间：2012-10-11T01:39:47.087
> 
> 标签：c#, date, xpath, event-log

给定某些信息，我正在尝试从 Windows PC 中提取事件日志。这段代码运行良好，但只提取当天的日志。我只想提取在之前指定的日期“toDate”和“fromDate”之间创建的日志。这是我第一次使用 xpath，我似乎无法在网上找到任何处理此类问题的内容。

```
 string queryString = 
            "<QueryList>" +
            "  <Query Id=\"0\" Path=\"Application\">" +
            "    <Select Path=\"Application\">" +
            "        *[System[(Level=3) and " + 
            "        TimeCreated[timediff(@SystemTime) &lt;= 86400000]]]" +
            "    </Select>" +
            "  </Query>" +
            "</QueryList>"; 
```

# windows-7 - VBS 中的 800a0ad 错误，Windows 7 32

> ID：12830978
> 
> 赞同：1
> 
> 时间：2012-10-11T01:40:01.113
> 
> 标签：windows-7, atl, wsh, ole-automation

我用 C++ 和 ATL (VS2010) 编写了一个简单的 ActiveX Dll 对象，用于嵌入在 SCADA 系统中的 VBS 脚本引擎。它现在只是一个代码尸体，只是与存根接口，没有依赖关系。每个设计为从客户端调用的接口都有双接口。我可以从 OLE/COM 对象查看器中看到这个对象，并可以从那里实例化它。出于调试目的，使用 C# 的互操作服务实例化此 ActiveX 对象没有问题。

但是，当我尝试从 wscript (vbs) 实例化它时，我得到了这个 800a0ad 错误。

操作系统是 Windows 7（32 位），而不是 x64。

# java - Java：Android 开发人员：“方法 getHolder() 未为 GameView 类型定义”

> ID：12830979
> 
> 赞同：4
> 
> 时间：2012-10-11T01:40:10.980
> 
> 标签：java, android

我一直在尝试按照这里的教程进行操作：

[http://www.edu4java.com/en/androidgame/androidgame2.html](http://www.edu4java.com/en/androidgame/androidgame2.html)

但是遇到了障碍。出于某种原因，eclipse 无法识别 getHolder() 并给我以下错误：

对于 GameView 类型，方法 getHolder() 未定义

以及以下解决方案：

更改为 getHandler(...); 创建方法 getHolder()

代码与教程几乎相同，但无论如何我都有：

```
package com.example.killthemall;

import android.content.Context;
import android.graphics.Bitmap;
import android.graphics.BitmapFactory;
import android.graphics.Canvas;
import android.graphics.Color;
import android.view.SurfaceHolder;
import android.view.SurfaceHolder.Callback;
import android.view.SurfaceView;
import android.view.View;

public class GameView extends View {

private Bitmap bmp;
private SurfaceHolder holder;

public GameView(Context context) {
    super(context);
    holder = getHolder();
    holder.addCallback(new Callback() {

        public void surfaceDestroyed(SurfaceHolder holder) {

        }

        public void surfaceCreated(SurfaceHolder holder) {
               Canvas c = holder.lockCanvas(null);
               onDraw(c);
               holder.unlockCanvasAndPost(c);
        }

        public void surfaceChanged(SurfaceHolder holder, int format,
                      int width, int height) {

        }

 }); 

    bmp = BitmapFactory.decodeResource(getResources(), R.drawable.ic_launcher);
}

@Override
protected void onDraw(Canvas canvas) {
    canvas.drawColor(Color.BLACK);
    canvas.drawBitmap(bmp, 10, 10, null);
}

} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-11T01:54:35.587

`getHolder()`是 的一种方法`SurfaceView`，并且您正在扩展`View`. 改成：

```
public class GameView extends SurfaceView { 
```

# java - 尝试根据单独的变量设置不同名称的变量

> ID：12830980
> 
> 赞同：0
> 
> 时间：2012-10-11T01:40:22.610
> 
> 标签：java, variables, batch-file

可能有更好的方法来做到这一点，但我基本上想要一个用户输入，每次都可以在一个新变量中设置无限次。我试图弄清楚如何使用名称中的变量设置变量。

来自 DOS Batch 我会做类似的事情：

```
set /A num=0

set /A coins%num%=%num% & set /A num=(%num%+1) 
```

这将根据“num”的值每次在变量“coins1,coins2,coins3”下设置一个新变量

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-11T01:43:16.480

有许多基本结构可以满足您的需求，最常见的是列表和数组......

我先看看[`Arrays`](http://docs.oracle.com/javase/tutorial/java/nutsandbolts/arrays.html)介绍。

当这有意义时，我会看看[`Collections`](http://docs.oracle.com/javase/tutorial/collections/index.html)

主要区别（在这种情况下）是数组往往是固定长度的，而列表可以是可变长度的

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-11T01:44:32.110

你不能直接做你想做的事。

最接近的方法是使用集合来存储变量名称（键）和值（值）

我会`Map<String, Object>`为此目的使用 a 。

因此，如果用户指定一个变量名“var1”（as `variableName`）和一个值“some value”作为（`value`），你可以做

```
// do this once
Map<String, Object> vars = new HashMap<String, Object>();
// every time you get a new "variable" and value do 
vars.put(variableName, value); 
```

如果您需要输入所有“变量”，您可以使用该`keySet`方法获取键的集合。 [文档在这里。](http://docs.oracle.com/javase/6/docs/api/java/util/Map.html#keySet%28%29)

# javascript - 擦除 div 数据并隐藏滑块

> ID：12830986
> 
> 赞同：0
> 
> 时间：2012-10-11T01:41:03.447
> 
> 标签：javascript, jquery, slider

我一直在研究一个 jquery 滑块，一旦单击记录，它就会滑出，然后当你单击关闭时，它会滑出屏幕。我最初遇到的问题是，如果我单击记录两次，它会尝试加载相同的信息最重要的是它自己并创建了一堆错误..所以我找到了一些代码，我可以用它来删除所有数据，然后将滑块窗格移回屏幕上，我遇到的问题是它会像我不会的那样擦除所有细节但是滑块窗格根本不动我只把javascript代码放在这里看看是否有人能告诉我我的代码做错了什么以及如果可能的话如何修复它......

```
 function deleteParentElement(){
         $(this).parent().animate({right:-1000});    // on its own as an onlcick event 
attached to the button it works on its own the pane its moving class is called "details"
         $('.student').remove()   //the class defined in here is only the div containing the data
         e.stopPropagation()
    } 
```

这是用于触发功能的按钮

```
<button style="position: absolute; top:40px; right:25px;" href="#" id="bt-close" class="<? echo $Stu_id;?>" onClick="deleteParentElement()">Close</button> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-11T01:53:49.670

您缺少两个分号和一个

```
$(document).ready(function(){
//the rest of the code
}); 
```

...这可能是你的问题

# linux - 关于 grep 的用法和中缀运算符

> ID：12830987
> 
> 赞同：0
> 
> 时间：2012-10-11T01:41:09.293
> 
> 标签：linux, unix, grep

这个表达式应该做什么？

```
grep -i Keyword1 | grep -i Keyword2 file.txt 
```

是否应该返回包含关键字 1 或关键字 2 的行？我问这个是因为这不是我得到的。我总是以某种方式得到关键字 2 的行，而且事情似乎没有完成。我的意思是当你运行一个正常的命令时，它在完成后返回到命令提示符。似乎没有当我运行上述内容时会发生这种情况。这里是否发生了某种管道？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-11T01:44:06.117

这真的没有意义。`|`是一个管道，它重定向 stdin/stdout：将 s stdout`a | b`重定向`a`到`b`s stdin。`grep`，没有文件作为参数，将从标准输入获取输入，这就是您的命令不返回的原因。

你想要的是

```
grep -i Keyword1 file.txt | grep -i Keyword2 
```

哪个将 grep for `Keyword1`，输出将被 grep for `Keyword2`。这将产生一个合乎逻辑`and`的过滤器`Keyword1 AND Keyword2`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-11T01:42:53.607

如果你想要逻辑或，你可以使用`grep -Ei '(Keyword1|Keyword2)' file.txt`

你目前拥有的是奇怪和错误的。这就是你打算做的：

```
grep -i Keyword1 file.txt | grep -i Keyword2 
```

这会给你逻辑和。

# xcode - 尝试将应用上传到 iTunes 时出错

> ID：12830995
> 
> 赞同：0
> 
> 时间：2012-10-11T01:41:51.633
> 
> 标签：xcode, submission

所以我有 xcode 3，我正在尝试通过应用程序加载器将应用程序上传到 itunes。我之前已经多次这样做了，但我不得不更新我的 iTunes 连接帐户，它弄乱了我所有的证书。这些是我得到的错误。

应用程序未通过协同设计验证。签名无效，或未使用 Apple 提交证书签名。

无法从您的应用程序中提取代码签名权利。请确保“应用程序名称”是经过正确代码签名的有效 Mach 可执行文件。

现在我确保所有证书/配置文件/Bundle Id 都正确。我还确保压缩文件的名称中没有空格。并且选择codesigning作为项目和目标下的分布。

到底怎么回事？

谢谢ps不要告诉我我需要一台新电脑和一个新的xcode......我知道

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-11T01:49:46.037

在我看来，您首先下载以签署所有其他证书的 Apple 证书已损坏。我将首先从钥匙串中删除所有证书，然后再次下载 Apple WW 证书，然后创建您的证书并对其进行签名，最后创建您的分发配置文件。

# php - 带有curl的php解析器xml，仅显示我想要的标签

> ID：12830996
> 
> 赞同：1
> 
> 时间：2012-10-11T01:42:11.750
> 
> 标签：php, xml, curl

> **可能重复：**
> [PHP 的最佳 XML 解析器](https://stackoverflow.com/questions/188414/best-xml-parser-for-php)

我有一个 PHP/curl 文件

```
<?php
echo "Conversion Stats<br />"; 

$ch = curl_init();
curl_setopt($ch, CURLOPT_HEADER, 0);
curl_setopt($ch, CURLOPT_VERBOSE, 0);
curl_setopt($ch, CURLOPT_RETURNTRANSFER, true);
curl_setopt($ch, CURLOPT_USERAGENT, "Mozilla/4.0 (compatible;)");
curl_setopt($ch, CURLOPT_POST, true);
curl_setopt($ch, CURLOPT_URL,'http://login.leadkitchen.com/affiliates/api/4/reports.asmx/Conversions' );
$post_array = array(
       'affiliate_id' => '123',
    'api_key' => 'abc',
    'start_date' => '10/8/2012',
    'end_date' => '10/11/2012',
    'offer_id' => '123',
    'start_at_row' => '1',
    'row_limit' => '0',
    'sub_affiliate' => 'email'
);

//url-ify the data
foreach($post_array as $key=>$value) 
{ 
    $post_array_string .= $key.'='.$value.'&'; 
}
$post_array_string = rtrim($post_array_string,'&');
//set the url, number of POST vars, POST data
curl_setopt($ch,CURLOPT_POST,count($post_array ));
curl_setopt($ch,CURLOPT_POSTFIELDS,$post_array_string);
$response = curl_exec($ch);

print "$response";

?> 
```

以及可能的 XML 响应

```
<conversion_response>
<success>true</success>
<row_count>1</row_count>
<summary>
<price>22.26555000000000</price>
<currency_symbol>$</currency_symbol>
</summary>
<conversions>
<conversion>
<conversion_id>221D4853</conversion_id>
<conversion_date>2011-06-24T11:51:05.117</conversion_date>
<offer_id>100</offer_id>
<offer_name>$100 Bendy's Gift Card + Free Frosti</offer_name>
<campaign_id>1781</campaign_id>
<subid_1>111770</subid_1>
<subid_2/>
<subid_3/>
<subid_4/>
<subid_5/>
<price>15.0000</price>
<disposition>Voicemail matches name</disposition>
<test>false</test>
<currency_symbol>€&lt;/currency_symbol>
</conversion>
</conversions>
</conversion_response> 
```

我实际上只需要在页面中显示conversion_id 和price。我不希望页面上显示其他结果。我该怎么做呢？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-11T01:44:56.730

你可以`SimpleXMLElement`用来获取你想要的元素

```
$xml = new SimpleXMLElement($response);
echo "<pre>";
echo $xml->conversions->conversion->conversion_id, PHP_EOL;
echo $xml->conversions->conversion->price, PHP_EOL; 
```

输出

```
221D4853
15.0000 
```

# php - 创建 MySQL 的更多外键

> ID：12830999
> 
> 赞同：0
> 
> 时间：2012-10-11T01:42:26.610
> 
> 标签：php, mysql, sql, mysql-workbench

我正在尝试使用此脚本创建数据库。但我在黑洞里。我不知道现在该怎么办。这是我的 MySQL 代码。请有人踢我。

如果我使用一个外键没问题，但我不知道如何使用更多。

**EROOR 是：**

```
#1005 - Can't create table 'ruda_dev_souteze2.results' (errno: 150) 
```

**查询是：**

```
SET @OLD_UNIQUE_CHECKS=@@UNIQUE_CHECKS, UNIQUE_CHECKS=0;
SET @OLD_FOREIGN_KEY_CHECKS=@@FOREIGN_KEY_CHECKS, FOREIGN_KEY_CHECKS=0;
SET @OLD_SQL_MODE=@@SQL_MODE, SQL_MODE='TRADITIONAL,ALLOW_INVALID_DATES';

CREATE SCHEMA IF NOT EXISTS `ruda_dev_souteze2` DEFAULT CHARACTER SET utf8 COLLATE utf8_czech_ci ;

USE `ruda_dev_souteze2` ;

-- -----------------------------------------------------
-- Table `ruda_dev_souteze2`.`contests`
-- -----------------------------------------------------
CREATE  TABLE IF NOT EXISTS `ruda_dev_souteze2`.`contests` (
  `id` BIGINT(20) NOT NULL AUTO_INCREMENT ,
  `name` VARCHAR(255) CHARACTER SET 'utf8' COLLATE 'utf8_czech_ci' NOT NULL ,
  `date` DATE NOT NULL ,
  `public` TINYINT(1) NOT NULL ,
  PRIMARY KEY (`id`) )
ENGINE = InnoDB
AUTO_INCREMENT = 11
DEFAULT CHARACTER SET = utf8
COLLATE = utf8_czech_ci;

-- -----------------------------------------------------
-- Table `ruda_dev_souteze2`.`people`
-- -----------------------------------------------------
CREATE  TABLE IF NOT EXISTS `ruda_dev_souteze2`.`people` (
  `contest_id` BIGINT(20) NOT NULL ,
  `number` INT(11) NOT NULL ,
  `category` VARCHAR(255) CHARACTER SET 'utf8' COLLATE 'utf8_czech_ci' NOT NULL ,
  `fname` VARCHAR(255) CHARACTER SET 'utf8' COLLATE 'utf8_czech_ci' NOT NULL ,
  `lname` VARCHAR(255) CHARACTER SET 'utf8' COLLATE 'utf8_czech_ci' NOT NULL ,
  PRIMARY KEY (`contest_id`, `number`) ,
  INDEX `id_idx` (`contest_id` ASC) ,
  CONSTRAINT `cidfp`
    FOREIGN KEY (`contest_id` )
    REFERENCES `ruda_dev_souteze2`.`contests` (`id` )
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB
DEFAULT CHARACTER SET = utf8
COLLATE = utf8_czech_ci;

-- -----------------------------------------------------
-- Table `ruda_dev_souteze2`.`subjects`
-- -----------------------------------------------------
CREATE  TABLE IF NOT EXISTS `ruda_dev_souteze2`.`subjects` (
  `contest_id` BIGINT(20) NOT NULL ,
  `number` INT(11) NOT NULL ,
  `name` VARCHAR(255) CHARACTER SET 'utf8' COLLATE 'utf8_czech_ci' NOT NULL ,
  `direct` TINYINT(1) NOT NULL ,
  `type` VARCHAR(255) CHARACTER SET 'utf8' COLLATE 'utf8_czech_ci' NOT NULL ,
  `subjectscol` VARCHAR(45) CHARACTER SET 'utf8' COLLATE 'utf8_czech_ci' NULL DEFAULT NULL ,
  PRIMARY KEY (`contest_id`, `number`) ,
  INDEX `id_idx` (`contest_id` ASC) ,
  CONSTRAINT `cidfs`
    FOREIGN KEY (`contest_id` )
    REFERENCES `ruda_dev_souteze2`.`contests` (`id` )
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB
DEFAULT CHARACTER SET = utf8
COLLATE = utf8_czech_ci;

-- -----------------------------------------------------
-- Table `ruda_dev_souteze2`.`results`
-- -----------------------------------------------------
CREATE  TABLE IF NOT EXISTS `ruda_dev_souteze2`.`results` (
  `contest_id` BIGINT(20) NOT NULL ,
  `subject_number` INT(11) NOT NULL ,
  `people_number` INT(11) NOT NULL ,
  `number_8c2` FLOAT(10,2) NULL DEFAULT NULL ,
  `time_time` TIME NULL DEFAULT NULL ,
  `time_frag` FLOAT(2,2) NULL DEFAULT NULL ,
  PRIMARY KEY (`contest_id`, `subject_number`, `people_number`) ,
  INDEX `cidfr_idx` (`contest_id` ASC) ,
  INDEX `snfr_idx` (`subject_number` ASC) ,
  INDEX `pnfr_idx` (`people_number` ASC) ,
  CONSTRAINT `cidfr`
    FOREIGN KEY (`contest_id` )
    REFERENCES `ruda_dev_souteze2`.`contests` (`id` )
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `snfr`
    FOREIGN KEY (`subject_number` )
    REFERENCES `ruda_dev_souteze2`.`subjects` (`number` )
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `pnfr`
    FOREIGN KEY (`people_number` )
    REFERENCES `ruda_dev_souteze2`.`people` (`number` )
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB
DEFAULT CHARACTER SET = utf8
COLLATE = utf8_czech_ci;

-- -----------------------------------------------------
-- Table `ruda_dev_souteze2`.`users`
-- -----------------------------------------------------
CREATE  TABLE IF NOT EXISTS `ruda_dev_souteze2`.`users` (
  `username` VARCHAR(255) CHARACTER SET 'utf8' COLLATE 'utf8_czech_ci' NOT NULL ,
  `fullname` VARCHAR(255) CHARACTER SET 'utf8' COLLATE 'utf8_czech_ci' NOT NULL ,
  `password` BINARY(40) NOT NULL ,
  `access` CHAR(1) CHARACTER SET 'utf8' COLLATE 'utf8_czech_ci' NOT NULL ,
  PRIMARY KEY (`username`) )
ENGINE = InnoDB
DEFAULT CHARACTER SET = utf8
COLLATE = utf8_czech_ci;

SET SQL_MODE=@OLD_SQL_MODE;
SET FOREIGN_KEY_CHECKS=@OLD_FOREIGN_KEY_CHECKS;
SET UNIQUE_CHECKS=@OLD_UNIQUE_CHECKS; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-11T02:07:31.063

我想我明白你在问什么（如果没有，请澄清）。

在`CREATE TABLE`对表的查询`results`中，您尝试创建三个单独`FOREIGN KEY`的列，每个列都转到不同的表。查询中的问题是这三行：

```
INDEX `cidfr_idx` (`contest_id` ASC) ,
INDEX `snfr_idx` (`subject_number` ASC) ,
INDEX `pnfr_idx` (`people_number` ASC) , 
```

如果您更改`INDEX`为`KEY`它应该可以正常工作。此外，`ASC`这是默认设置 - 因此从技术上讲，您可以将其排除在外（但将其保留不会有任何伤害。

所以，在这个小更新之后，你`CREATE TABLE`的`results`表应该如下所示：

```
CREATE  TABLE IF NOT EXISTS `ruda_dev_souteze2`.`results` (
  `contest_id` BIGINT(20) NOT NULL ,
  `subject_number` INT(11) NOT NULL ,
  `people_number` INT(11) NOT NULL ,
  `number_8c2` FLOAT(10,2) NULL DEFAULT NULL ,
  `time_time` TIME NULL DEFAULT NULL ,
  `time_frag` FLOAT(2,2) NULL DEFAULT NULL ,
  PRIMARY KEY (`contest_id`, `subject_number`, `people_number`) ,
  KEY `cidfr_idx` (`contest_id`) ,
  KEY `snfr_idx` (`subject_number`) ,
  KEY `pnfr_idx` (`people_number`) ,
  CONSTRAINT `cidfr`
    FOREIGN KEY (`contest_id` )
    REFERENCES `ruda_dev_souteze2`.`contests` (`id` )
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `snfr`
    FOREIGN KEY (`subject_number` )
    REFERENCES `ruda_dev_souteze2`.`subjects` (`number` )
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `pnfr`
    FOREIGN KEY (`people_number` )
    REFERENCES `ruda_dev_souteze2`.`people` (`number` )
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB
DEFAULT CHARACTER SET = utf8
COLLATE = utf8_czech_ci; 
```

我使用更改在本地测试了完整的脚本，它运行良好 - 如果您有任何问题，请告诉我，我可以进一步调查。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-12T06:16:01.283

引用的列是`BIGINT`：

```
CREATE  TABLE IF NOT EXISTS `ruda_dev_souteze2`.`subjects` (
  `contest_id` BIGINT(20) NOT NULL ,                           --- BIGINT
 ... 
```

而参考是`INT`：

```
CREATE  TABLE IF NOT EXISTS `ruda_dev_souteze2`.`results` (
  `contest_id` BIGINT(20) NOT NULL ,
  `subject_number` INT(11) NOT NULL ,                          --- INT
    ...
  CONSTRAINT `snfr`
    FOREIGN KEY (`subject_number` )
    REFERENCES `ruda_dev_souteze2`.`subjects` (`number` )
    ON DELETE NO ACTION
    ON UPDATE NO ACTION, 
```

它们应该具有相同的数据类型。