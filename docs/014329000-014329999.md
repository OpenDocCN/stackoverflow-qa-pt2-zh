# StackOverflow 问答 14329000-14329999

# mysql - 在已经建立索引时提高计数和求和的性能

> ID：14329000
> 
> 赞同：1
> 
> 时间：2013-01-14T23:59:34.853
> 
> 标签：mysql, sql

首先，这是我的查询：

```
SELECT 
    COUNT(*) as velocity_count, 
    SUM(`disbursements`.`amount`) as summation_amount 
FROM `disbursements` 
WHERE 
    `disbursements`.`accumulation_hash` = '40ad7f250cf23919bd8cc4619850a40444c5e90c978f88635a09ccf66a82ffb38e39ea51cdfd651b0ebdac5f5ca37cd7a17e0f60fea6cbce1397ccff5fa37346' 
    AND `disbursements`.`caller_id` = 1 
    AND `disbursements`.`active` = 1 
    AND (version_hash != '86b4111677294b27a1805643d193b8d437b6ddb170b4ed5dec39aa89bf070d160cbbcd697dfc1988efea8429b1f1557625bf956180c65d3dcd3a318280e0d2da') 
    AND (`disbursements`.`created_at` BETWEEN '2012-12-15 23:33:22' 
    AND '2013-01-14 23:33:22') LIMIT 1 
```

解释扩展返回如下：

```
+----+-------------+---------------+-------+-----------------------------------------------------------------------------------------------------------------------------------------------+------------------------------+---------+------+--------+----------+--------------------------+
| id | select_type | table         | type  | possible_keys                                                                                                                                 | key                          | key_len | ref  | rows   | filtered | Extra                    |
+----+-------------+---------------+-------+-----------------------------------------------------------------------------------------------------------------------------------------------+------------------------------+---------+------+--------+----------+--------------------------+
|  1 | SIMPLE      | disbursements | range | unique_request_index,index_disbursements_on_caller_id,disbursement_summation_index,disbursement_velocity_index,disbursement_version_out_index | disbursement_summation_index | 1543    | NULL | 191422 |   100.00 | Using where; Using index |
+----+-------------+---------------+-------+-----------------------------------------------------------------------------------------------------------------------------------------------+------------------------------+---------+------+--------+----------+--------------------------+ 
```

实际查询大约有 95,000 行。如果我解释另一个命中约 50 行的查询，则解释是相同的，只是估计的行数更少。

选择的索引按顺序包括累积哈希、调用者 ID、活动、版本哈希、创建时间、金额。

我尝试过使用 COUNT(id) 或 COUNT(caller_id)，因为它们是非空字段并返回与 count(*) 相同的内容，但它对计划或运行时间没有任何影响的实际查询。

这也是一个很重的插入表，基本上每个查询自上次运行以来都会插入或更新一行，因此 mysql 查询缓存并不完全有用。

在我去使用 memcache 或 redis 之类的东西制作某种分桶时间序列缓存之前，是否有一个明显的解决方案可以让它更快地工作？正常的约 50 行查询在 5MS 内返回，超过 90k+ 行的查询需要 500-900MS，而我真的负担不起超过 100MS 的任何东西。

我应该指出日期是一个滚动的 30 天窗口，需要基本上是实时的。过期可能会以大约 1 分钟的粒度发生，但新项目需要在提交后立即看到。我也在RDS上，读取IOPS基本上是0，cpu大概是60-80%。当我不查询庞大的 90,000 多个记录项时，CPU 通常保持在 10% 以下。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-15T00:27:11.853

您可以尝试`created_at`以前的索引`version_hash`（可能会更好地进行索引范围扫描...不清楚该非相等谓词如何`version_hash`影响计划，但我怀疑它会禁用`created_at`列上的范围扫描。

除此之外，查询和索引看起来和您将要获得的一样好，EXPLAIN 输出显示查询正在从索引中得到满足。

考虑到它聚合了 95,000 多行，尤其是考虑到 1543 字节的密钥长度，该语句的性能听起来并不太合理。这比我通常处理的要大得多。

索引中列的数据类型是什么，簇键或主键是什么？

```
accumulation_hash - 128-character representation of 512-bit value
caller_id - integer or numeric (?)
active - integer or numeric (?)
version_hash - another 128-characters
created_at - datetime (8bytes) or timestamp (4bytes)
amount - numeric or integer 
```

95,000 行，每行 1543 字节，数据量约为 140MB。

# jquery - jQuery Vallenato 手风琴显示

> ID：14329004
> 
> 赞同：0
> 
> 时间：2013-01-14T23:59:40.003
> 
> 标签：jquery, accordion, default

这个 jQuery 手风琴脚本默认显示第一个手风琴内容。如何将第三个手风琴内容设置为默认显示？

```
$(document).ready(function()
{
//Add Inactive Class To All Accordion Headers
$('.accordion-header').toggleClass('inactive-header');

//Set The Accordion Content Width
var contentwidth = $('.accordion-header').width();
$('.accordion-content').css({'width' : contentwidth });

//Open The First Accordion Section When Page Loads
$('.accordion-header').first().toggleClass('active-header').toggleClass('inactive-header');
$('.accordion-content').first().slideDown().toggleClass('open-content');

// The Accordion Effect
$('.accordion-header').click(function () {
    if($(this).is('.inactive-header')) {
        $('.active-header').toggleClass('active-header').toggleClass('inactive-header').next().slideToggle().toggleClass('open-content');
        $(this).toggleClass('active-header').toggleClass('inactive-header');
        $(this).next().slideToggle().toggleClass('open-content');
    }

    else {
        $(this).toggleClass('active-header').toggleClass('inactive-header');
        $(this).next().slideToggle().toggleClass('open-content');
    }
});

return false;
}); 
```

[http://www.switchroyale.com/vallenato/](http://www.switchroyale.com/vallenato/)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-15T00:16:56.343

删除此行：

```
//Open The First Accordion Section When Page Loads
$('.accordion-header').first().toggleClass('active-header').toggleClass('inactive-header');
$('.accordion-content').first().slideDown().toggleClass('open-content'); 
```

并添加：

```
$('.accordion-header:eq(2)').toggleClass('active-header').toggleClass('inactive-header');
$('.accordion-content:eq(2)').slideDown().toggleClass('open-content'); 
```

`:eq(2)`定义默认部分的部分

# ios - 更改 UIView 后不保存状态框

> ID：14329005
> 
> 赞同：0
> 
> 时间：2013-01-14T23:59:46.490
> 
> 标签：ios, objective-c, xcode

有一个标准的应用程序tabBar。

TabBar1 和 TabBar2

控制器 TabBar2 有一个 UIButton 和 UITextField

UIButton 运行代码

```
[textField setFrame:CGRectMake(0, 222, 320, 150)]; 
```

作品。并在字段中输入文本。

为什么我切换到Tab1，然后再切换到Tab2，文本状态保存，大小被重置？

**已解决：自动布局已关闭**

# asp.net-mvc-4 - ASP.NET MVC4 模型未绑定

> ID：14329006
> 
> 赞同：4
> 
> 时间：2013-01-14T23:59:48.313
> 
> 标签：asp.net-mvc-4, model-binding

我有一个非常简单的 ASP.NET MVC4 页面。它正在为 CustomerModel 呈现一个编辑表单。表单显示正确，但是当我点击编辑并回发时，模型没有被绑定。相反，CustomerModel 的所有属性都保留为默认值。请注意，正在调用正确的控制器方法*，*所以这不是问题。

我可以看到名称与模型属性（ID、名称、描述）匹配的表单值，但模型没有设置它们。

想法？

这是模型：

```
public class CustomerModel
{
    [Required] 
    public Guid Id;

    [Required]
    public string Name;

    [Required]
    public string Description;
} 
```

这是相关的控制器方法：

```
 [HttpPost]
    [ValidateAntiForgeryToken]
    public ActionResult Edit(CustomerModel customerModel)
    {
        if (ModelState.IsValid)
        {
            //...Do stuff

            return RedirectToAction("Index");
        }

        return View(customerModel);
    } 
```

最后，这是带有填充值的表单集合的屏幕截图：

![在此处输入图像描述](../Images/8172e7206c36890ffd2152522607dfc5.png)

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-01-15T04:02:20.290

您的模型具有公共字段但没有公共属性，这些不一样。

改成：

```
public class CustomerModel
{
    [Required] 
    public Guid Id {get; set;}

    [Required]
    public string Name {get; set;}

    [Required]
    public string Description {get; set;}
} 
```

默认的 MVC 模型绑定器将使用属性，而不是字段。

更多关于这里 - [http://rightbrainleft.net/2011/02/default-mvc-model-binder-doesnt-like-fields/](http://rightbrainleft.net/2011/02/default-mvc-model-binder-doesnt-like-fields/)

# regex - 匹配不同的词序正则表达式

> ID：14329007
> 
> 赞同：0
> 
> 时间：2013-01-14T23:59:51.083
> 
> 标签：regex, perl, bash, sed

我一直在努力尝试在单个正则表达式行中匹配一组相对简单的可能单词顺序。

基本上，我想匹配这些（以及其他语法相似的）可能性：

> “设置变量”
> 
> “关闭 var”
> 
> “设置变量”
> 
> “设置 var 关闭”
> 
> “引爆 var”
> 
> “设置在 var 上”
> 
> “在 var 上设置”
> 
> “启动 var”

我需要的唯一组是“ **var** ”（可以是任何单个单词）和始终打开或关闭的**值。**这是基本的想法。

考虑到这一点，有两种可能的语法结构：

```
(on/off) (perhaps a word) (a word)

(a word) (on/off) 
```

我已经能够使用以下正则表达式独立匹配这些可能性：

```
/((on |off )([a-z]{1,})? ([a-z]{2,}))/i

/([a-z]{2,}) (on|off)/i 
```

所以，我想我可以这样做：

```
/(((on |off )([a-z]{1,})? ([a-z]{2,})))|(([a-z]{2,}) (on|off))/i 
```

这只是（短语 1）|（短语 2），但短语 2 将始终与“set off”匹配，认为“set”是名称。我也试过：

```
/((?!set)) (((on |off )([a-z]{1,})? ([a-z]{2,})))|(([a-z]{2,}) (on|off))/i 
```

没有成功。

* * *

**编辑1：**另外，我没有提到这些短语可以在文件的任何地方找到；他们不在独立的路线上。

例如：“ **this is the way to set the var on** ”与“ **set the var on** ”一样

* * *

**问题：**

1.  我可以一起做这件事而不必单独匹配的最好方法是什么？

2.  有没有办法强制正则表达式 OR 语句匹配顺序？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-15T00:12:40.190

'the' 可能总是出现在 'var' 之前：

```
((the)? var) 
```

'set' 总是以表达式开头：

```
^set 
```

'on' 和 'off' 是互斥的，但需要一个：

```
(on|off) 
```

'var' 和 'on'/'off' 一个接一个地出现，没有特定的顺序。现在都在一起了：

```
^set ((the)? var (on|off)|(on|off) (the)? var)$ 
```

*注意：我是一名 .NET 开发人员。正则表达式是相当标准的，上面应该可以工作，但是在 perl 中可能有更有效的方法来编写它。*

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-15T00:53:14.807

每当您尝试匹配复杂数据时，您可能应该尝试创建语法。Perl 正则表达式允许您通过`(?(DEFINE)...)`.

```
use strict; use warnings; use feature 'say';
my $grammar = qr(
    set \s+ (?:the \s+)? (?<variable>(?&VAR)) \s+ (?:to \s+)? (?<value>(?&VAL))
  | set \s+ (?<value>(?&VAL)) \s+ (?:the \s+)? (?<variable>(?&VAR))

  (?(DEFINE)
    (?<VAL> on | off) # edit only here to add new values
    (?<VAR> (?!the|(?&VAL)) \w+)
  )
)x; # /x -- whitespace is irrelevant

while(<>){
  if (/$grammar/) { say "> val: $+{value} var: $+{variable}" }
  else            { say "> no match" }
} 
```

要注意的语法：`(?&rule)`调用命名规则。`(?<name>pattern)`命名捕获，允许通过`%+`哈希访问。也用于在`(DEFINE)`块中声明规则。

示例会话：

```
set the switch to off!
> val: off var: switch
I would like to set something on fire...
> val: on var: something
set on the set!
> val: on var: set
set on the set off something
> val: on var: set
set on off
> no match 
```

请注意，我通过断言变量也不匹配值来使语法相当明确。然而，上面的例子确实展示了一些有趣的案例，这些案例可能没有像预期的那样被解析。

有关在正则表达式中编写语法的更强大方法，请查看[Regexp::Grammars](https://metacpan.org/module/Regexp%3a%3aGrammars)。

# ios - 无法让 Phonegaps FileWriter 工作

> ID：14329010
> 
> 赞同：0
> 
> 时间：2013-01-15T00:00:14.457
> 
> 标签：ios, cordova, filewriter

Phonegap 新手，很难理解该`FileWriter`功能。我试图让这个例子在 iOS6 上工作，但我被这个`error`消息卡住了

```
 <script type="text/javascript" charset="utf-8" src="cordova-2.3.0.js"></script>
    <script type="text/javascript" charset="utf-8">

        var fileWriter;
        function onNotesLoad() {
            window.requestFileSystem(LocalFileSystem.PERSISTENT, 0, onFSComplete, fail);
        }
        function onFSComplete(fileSystem) {
            // Load the notes.txt file, create it if it doesn't exist
            fileSystem.root.getFile("notes.txt", {create: true}, onFileEntryComplete, fail);
        }
        function onFileEntryComplete(fileEntry) {
            // set up the fileWriter
            fileEntry.createWriter(onFileWriterComplete, fail);
        }
        function onFileWriterComplete(fileWriter) {
            // store the fileWriter in a
            // global variable so we have it
            // when the user presses save
            fileWriter = fileWriter;
        }
        function saveNotes() {
            // make sure the fileWriter is set
            if (fileWriter != null) {
                // create an oncomplete write function
                // that will redirect the user
                fileWriter.onwrite = function(evt) {
                    alert("Saved successfully");
                    $.mobile.changePage("index.html");
                };
                var form = document.getElementsByTagName('form')[0].elements;
                var notes = form.notes.value;
                // save the notes
                fileWriter.write(notes);
            } else {
                alert("There was an error trying to save the file");
            }
            return false;
        }
        function fail(error) {
            alert(error.code);
        }
        </script> 
```

HTML：

```
<body>
    <div data-role="page" id="notes-page">
        <div data-role="header" data-position="inline">
            <a href="index.html" data-icon="delete">Cancel</a>
            <h1>Your Thoughts?</h1>
            <a onClick="return saveNotes()" href="#"
                data-icon="check" data-theme="b">Save</a>
        </div>
        <form action="index.html" method="post">
            <textarea name="notes" rows="30" cols="10"></textarea>
        </form>
    </div>
</body> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-15T00:29:08.677

onwrite 处理程序被称为进度事件。我相信你会想挂接到 onwriteend 处理程序。

# javascript - 原型继承 - 为什么这不起作用？

> ID：14329014
> 
> 赞同：1
> 
> 时间：2013-01-15T00:00:31.217
> 
> 标签：javascript, prototype

```
example = {};

example.Math = {
  sin: function() {console.log('sin');},
  cos: function() {console.log('cos');}
};

foo = function(){
   sin(); 
};
foo.prototype = window.example.Math;

console.log(foo.prototype)
console.log(foo.cos)
console.log(foo()) 
```

[http://jsfiddle.net/Mubqy/9/](http://jsfiddle.net/Mubqy/9/)

从我认为我理解的内容来看，引用是通过范围链搜索的。所以理论上，如果我将一个具有定义给原型的函数的对象分配给我，我应该得到对象的所有这些函数和字段，或者我想。我的理解错误在哪里？以上两种情况都不起作用。此外，内部*proto*变量没有被更新。显然这就是它不起作用的原因，但为什么我对原型的分配不起作用？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-15T00:10:42.473

我认为您需要意识到原型方法需要使用`new`关键字运行，并且需要使用它`this`来访问其变量和方法，如下所示：

```
example = {};

example.Math = {
  sin: function() {console.log('sin');},
  cos: function() {console.log('cos');}
};

foo = function(){
   this.sin(); 
};
foo.prototype = window.example.Math;

console.log(foo.prototype)
console.log(foo.cos)
console.log(new foo()) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-15T00:10:35.237

你错过了原型的两个非常重要的方面。

*   原型充当对象的父级
*   您必须启动对象的实例

首先，使用关键字`this`访问对象的方法和变量：

```
var foo = function(){
   this.sin(); 
}; 
```

比使用关键字启动对象的实例`new`：

```
new foo(); 
```

就像 OOP，只是不是 :)

[http://jsfiddle.net/46fPe/](http://jsfiddle.net/46fPe/)

# mysqldump - mysqldump 挂起

> ID：14329015
> 
> 赞同：0
> 
> 时间：2013-01-15T00:00:40.817
> 
> 标签：mysqldump

我有 2 个 mysql 表，其中一个在另一个表中有一个外键。当 mysqldump 使用 where 语句选择性地转储某些子集时，第二个 mysqldump 进入准备状态并永远挂起。我该如何解决？

```
mysqldump -u$username -p$password --quick --lock-all-tables --where="table1_id<1000" $db table1 > $dump_dir/table1.sql                                                                                                 

mysqldump -u$username -p$password --quick --lock-all-tables --where="table2_id in (select table2_id from table1 where table1_id<1000)" $db table2 >$dump_dir/table2.sql

```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-15T00:10:35.030

Here's a couple of things you could try.

Try adding indexes:

```
... ON table1 (table1_id, table2_id) 
```

Also, try adding the `DISTINCT` keyword in subquery:

```
 table2_id in (select DISTINCT table2_id from table1 where table1_id<1000) 
```

* * *

Other than performance of the query that MySQL is using, I don't see anything there that should cause a "hang", other than that `lock-all-tables` option. I'm assuming you've tested without that, and observed the same behavior.

* * *

**Q:** What do you suspect is causing the hang?

I suspect it's just the SELECT statement that is cranking. I think it's likely that for EVERY row in table2, the execution plan is doing a nested loops lookup from table1\. I suspect that the `IN (subquery)` predicate is being optimized into an equivalent `EXISTS (correlated subquery)`.

**Q:** Why would adding indexes help?

Indexes may not help at all. But an appropriate index on table1 may cut down on the amount of time required to retrieve the results from the subquery. (It's likely the results from the subquery will be "cached", so that there will only be a savings when that subquery is first run, adn not a savings for each row from table2 that is evaluated.)

# matlab - MATLAB - 绘制 .wav 文件的时频图

> ID：14329017
> 
> 赞同：6
> 
> 时间：2013-01-15T00:00:58.203
> 
> 标签：matlab, graph, signal-processing, frequency, wave

我正在做一个项目，该项目涉及使用波形文件查看音高/频率随时间的变化（我是 MATLAB 新手，但不是编程新手）。我能够看到时间-幅度图和频率-幅度（FFT 之后）图，但是我如何能够隔离频率并在每个时间点显示它？

代码：

```
filename = '/Users/Username/Sample_1.wav'

[y, fs] = wavread(filename);
y = y(:,1);
dt = 1/fs;
t = 0:dt:(length(y)*dt)-dt;
plot(t,y); xlabel('Seconds'); ylabel('Amplitude');

transformed = fft(y);
mag = abs(transformed);
plot(mag); 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-01-15T00:03:22.020

如果您有信号处理工具箱，那么您可能会发现该[`spectrogram`](http://www.mathworks.co.uk/help/signal/ref/spectrogram.html)功能很有用。

如果不这样做，那么您可以通过计算时域数据的连续（可能重叠）窗口段的 FFT，然后绘制幅度来手动实现相同的效果。

这本质上是[*短时傅里叶变换*](http://en.wikipedia.org/wiki/STFT)(STFT)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-15T12:51:10.287

如果你有信号处理工具箱，那么频谱图就是你要走的路（正如 Oli Charlesworth 提到的）。

如果您没有它，MATLAB 中央文件交换始终是寻找通用内容的好地方。

[http://www.mathworks.com/matlabcentral/fileexchange/1553-spectrogram-short-time-ft-log-magnitude](http://www.mathworks.com/matlabcentral/fileexchange/1553-spectrogram-short-time-ft-log-magnitude)

这似乎是频谱图功能的明智且运行良好的实现。

# jquery - 使用 touchslider.com 传递选项以在幻灯片 2 上打开

> ID：14329021
> 
> 赞同：0
> 
> 时间：2013-01-15T00:01:15.760
> 
> 标签：jquery, touch, slide

我正在使用 touchslider.com 并且有一个关于实现开始幻灯片的问题

目前它总是从幻灯片 1 开始，但有时我希望它从幻灯片 2 开始。

html会是这样的

```
<div class="touchslider">
<div class="touchslider-viewport" style="width:500px;overflow:hidden"><div>
    <div class="touchslider-item">page1</div>
    <div class="touchslider-item">page2</div>
    ...
</div></div>

<div>
    <span class="touchslider-nav-item touchslider-nav-item-current">1</span>
    <span class="touchslider-nav-item">2</span>

</div>
</div> 
```

然后开始

```
<script>
jQuery(function($) {
 jQuery(".touchslider").touchSlider({/*options*/});
});
</script> 
```

和 JavaScript 是

[http://touchslider.com/jquery.touchslider.js](http://touchslider.com/jquery.touchslider.js)

我想传递一个像 startSlide 这样的选项，但这不是当前选项。

任何帮助表示赞赏

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-15T00:12:34.040

我决定这样做

在主页

```
<script>
jQuery(function($) {
 jQuery(".touchslider").touchSlider({ startSlide:2}); 
});
</script> 
```

然后将此添加到JS

在添加的选项中

开始幻灯片：1

然后靠近默认下一步按钮的位置

```
if ( options.startSlide > 1  ) {
        startSlide(options.startSlide);
} 
```

然后添加了这个功能

```
function startSlide(number, complete) {
        switching.to(ret.current + number-1, { dirX: + number-1, complete: complete });
} 
```

# javascript - 侦听器事件总是使用最后一个元素的信息触发

> ID：14329023
> 
> 赞同：1
> 
> 时间：2013-01-15T00:01:24.613
> 
> 标签：javascript, google-maps

我正在尝试制作基于地图的应用程序，但遇到了一些困难。我一直在使用的原始代码为每个标记添加了一个单独的 InfoWindow，但我想使用一个可以动态设置内容的 InfoWindow 来获取它。

但是，我对 JavaScript 的行为方式似乎仍然有些模糊，因为每次单击任何标记时，InfoWindow 都会在最后一个标记上方弹出，并且警报会指示`locations`.

简短的片段，突出显示的问题：

```
function plotLocations(my_locations) {
    locations = my_locations;
    for(var i=0; i<locations.length; i++) {
        var pos = new google.maps.LatLng(locations[i].loc_lat, locations[i].loc_lng);
        var icon = new google.maps.MarkerImage(
            "http://goo.gl/TQpwU",
            new google.maps.Size(20,32),
            new google.maps.Point(0,0),
            new google.maps.Point(0,32)
        );
        var marker = new google.maps.Marker({
            map: map,
            position: pos,
            animation: google.maps.Animation.DROP,
            icon: icon
        });
// ! -- trouble right here -- ! //
        google.maps.event.addListener(marker, 'click', function() {
            setPopInfo(pos, i);
        });
// ! -- ------------------ -- ! //
    }
}

function setPopInfo(pos, index) {
    pop_info.setPosition(pos);
    pop_info.open(map);
    window.alert(pos+"::"+index);
} 
```

我的大部分代码：

```
var map;
var mapBounds;
var locations;
var pop_info;

$(document).ready(init);

function init() {
    var mapOptions = {
        mapTypeId: google.maps.MapTypeId.ROADMAP
    };
    map = new google.maps.Map(document.getElementById('map_canvas'), mapOptions);
    pop_info = new google.maps.InfoWindow({
        content: "I'm not populated!",
        size: new google.maps.Size(100,25)
    });
    google.maps.event.addListener(map, 'bounds_changed', function() {
        queryLocations(map.getBounds());
    });

    prepareGeolocation();
    doGeolocation();
}

function queryLocations(bounds) {
    jQuery.ajax({
        url: 'http://mydomain.com/myapp/test2.php',
        data: bounds.toString(),
        dataType: 'json',
        success: addLocations
    });
}

function addLocations(new_locations) {
    document.getElementById('footer').innerHTML = new_locations;
    plotLocations(new_locations);
} 
```

我对单个 InfoWindow 的推理是，一旦创建了几百个标记和 InfoWindow，性能可能会急剧下降。我正在尝试做的事情是否可行/可取？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-15T00:37:53.777

出现问题是因为您在循环内定义事件侦听器回调函数。闭包动态引用它们的上下文，而不是在定义时绑定到数据的副本，因此您有效地创建了`locations.length`许多函数，这些函数都绑定到 , 和 的相同值`marker`，`pos`它们`i`在循环终止。

`addListener`为了解决这个问题，您可以创建一个在循环体外部调用的函数，如下所示：

```
function plotLocations (my_locations) {
    locations = my_locations;
    for(var i=0; i<locations.length; i++) {
        var pos = new google.maps.LatLng(locations[i].loc_lat, locations[i].loc_lng);
        var icon = new google.maps.MarkerImage(
            "http://goo.gl/TQpwU",
            new google.maps.Size(20,32),
            new google.maps.Point(0,0),
            new google.maps.Point(0,32)
        );
        var marker = new google.maps.Marker({
            map: map,
            position: pos,
            animation: google.maps.Animation.DROP,
            icon: icon
        });
        bindEvent(marker, pos, i);
    }
}

function bindEvent (marker, pos, i) {
    google.maps.event.addListener(marker, 'click', function() {
        setPopInfo(pos, i);
    });
} 
```

# c# - 将函数分配给通用委托

> ID：14329032
> 
> 赞同：0
> 
> 时间：2013-01-15T00:03:06.483
> 
> 标签：c#, generics, delegates, assign

我有一个通用类，我想在其中保存一个使用 Type T 作为参数和返回值的委托。如何将方法分配给属性 getValueDefault？

```
private delegate TOut GetValueDefault<in TIn, TOut>(string key, TIn defaultValue);

private GetValueDefault<T, T> getValueDefault = null; 
```

例如带有签名的方法`bool ThirdPartyClass.foo(string key, bool defValue)`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-15T00:08:56.747

它应该很简单：

```
private delegate TOut GetValueDefault<in TIn, TOut>(string key, TIn defaultValue);

private GetValueDefault<int, bool> getValueDefault = afoo;

static bool ThirdPartyClass.foo(string key, int defValue)
{
    \\...
} 
```

但是，如果*在所有情况下您都将拥有相等的 in 和 out 类型参数*，您可以将其简化为：

```
private delegate T GetValueDefault<T>(string key, T defaultValue);

private static GetValueDefault<bool> getValueDefault = afoo; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-15T05:36:51.463

我认为你应该写这样的东西：

```
class Sample<T>
{
    public delegate TOut GetValueDefault<in TIn, TOut>(string key, TIn defaultValue);

    private GetValueDefault<T, T> getValueDefault = null; 
    public Sample(GetValueDefault<T, T> del)
    {
        getValueDefault = del;
    }
} 
```

# javascript - Javascript 代码在 iPhone 上不起作用

> ID：14329033
> 
> 赞同：1
> 
> 时间：2013-01-15T00:03:09.977
> 
> 标签：javascript, ios, ajax

我正在为 iPhone 设计一个网络应用程序。当用户按下按钮时，它会向 Web 服务器发送一条带有三个值的 JSON 消息，并作为回报接收 JSON 状态响应。javascript如下。

```
var args = {};
args.Val1 = parseInt(document.getElementById("Val1").value);
args.Val2 = parseInt(document.getElementById("Val2").value);
args.Val3 = parseInt(document.getElementById("Val3").value);
var jsonString = JSON.stringify(args);

if(window.XMLHttpRequest)           // code for IE7+, Firefox, Chrome, Opera,
{
    ajaxReq = new XMLHttpRequest();
}
else if(window.ActiveXObject)       // code for IE6, IE5
{
    ajaxReq = new ActiveXObject("Microsoft.XMLHTTP");
}

ajaxReq.onreadystatechange=function()
{
    if (ajaxReq.readyState==4 && ajaxReq.status==200)
    {
         rsp = JSON.parse(ajaxReq.responseText)
         if(parseInt(rsp.Status) == 0)
         {
            document.getElementById("Status").value = "OK"
         }
         else
         {
            document.getElementById("Status").value = "Fail"
         }
    }
}
ajaxReq.open("POST", "Handler.json", true);
ajaxReq.send(jsonString); 
```

当我使用桌面浏览器（Firefox 或 Chrome）对此进行测试时，它工作得很好，服务器获取消息并返回状态，并且状态显示在屏幕上。如果我使用 iPhone 使用 Safari 浏览，它不起作用。我从来没有收到状态响应，有时浏览器“锁定”并且在我按下按钮时不会发送 JSON 消息。

有任何想法吗？

# php - 生成随机唯一序列

> ID：14329038
> 
> 赞同：2
> 
> 时间：2013-01-15T00:03:30.457
> 
> 标签：php, mysql

我想构建一个**令牌**编号生成器。在每次调用中，应返回一个随机且唯一的 8 位数字。我正在使用 PHP 和 MySQL。在 MySQL 中，我将在每次生成新序列时插入一个表。

如何在每次通话中生成新号码？

最终用户将使用令牌来激活软件（并将过期，例如 1 周后）。所以，我需要令牌是唯一的而不是连续的。这更好地描述了我的需求。令牌格式将只是数字，因此可以轻松拼写和键入。

即使令牌过期，我也不想在以后生成已经生成的令牌。

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-15T00:59:41.120

好的，所以这段代码不会将序列号放入数据库，但它会返回一个 8 位长的序列号。如果您只想要数字，请将允许的字符变量更改为仅数字。

```
<?php

    function generate_serial_number() {

       $Allowed_Charaters = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ1234567890';
       return substr(str_shuffle($Allowed_Charaters), 0, 8);

    }

?> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-15T10:21:52.670

我通常使用[http://php.net/manual/en/function.uniqid.php](http://php.net/manual/en/function.uniqid.php)并将**more_entropy**参数设置为 true。

# lambda - 什么是方案中的 lambda

> ID：14329039
> 
> 赞同：2
> 
> 时间：2013-01-15T00:03:56.450
> 
> 标签：lambda, functional-programming, lisp, scheme

我对计划很陌生。对每个人来说都是非常基本的问题。我在网上随处可见的函数调用中的 lambda 是什么？它有什么作用？不使用它会失去什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-15T00:13:16.663

`lambda`是 Lisp 编程语言家族中的一种特殊形式（以及在一定程度上支持函数式编程的其他语言），它是一个匿名函数，它围绕定义它的上下文创建一个闭包。

Lambda 在 Lisp 中随处可见，无论是显式的还是隐式的（在宏转换之后，隐式地以其他特殊形式等）。不使用它会失去什么？*一切*。对于初学者来说，定义程序的能力！

要查看我的意思的一些示例，此过程定义：

```
(define (f x)
  x) 
```

... 只是为此的语法糖，一个*命名*过程，它只是将名称与匿名相关联`lambda`：

```
(define f
  (lambda (x)
    x)) 
```

同样，`let`将值绑定到变量的形式：

```
(let ((x 9))
  (+ x 1)) 
```

... 只是语法糖：

```
((lambda (x)
   (+ x 1))
 9) 
```

当然，可以使用 lambdas 作为定义匿名函数的快捷方式：

```
(map (lambda (x) (* x x))
     '(1 2 3 4 5)) 
```

说实话，几乎不可能*不*使用 lambda 在 Lisp 中编写任何重要的程序。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-15T00:28:45.183

Lambda 是一个函数式文字。一个类比可能会有所帮助：

假设我想显示数字 10。我可以通过两种方式实现。首先，我可以将它放在一个变量中，然后显示该变量，如下所示：

```
(define x 10)
(display x) 
```

或者，我可以直接显示数字——一个数字文字——像这样：

```
(display 10) 
```

一个 lambda 也是一样的。例如，如果我想显示应用一个将两个数字相加的函数的结果，我可以将该函数放在一个变量中并像这样显示结果：

```
(define f (lambda (x y) (+ x y)))
(display (f 10 20)) 
```

或者我可以只使用一个函数文字——lambda——就像这样：

```
(display ((lambda (x y) (+ x y)) 10 20)) 
```

顺便说一句，Scheme 为您提供了定义函数的简写，它可以隐藏 lambda 的真实性质。我也可以定义 f ：

```
(define (f x y) (+ x y)) 
```

但我想让通信清楚。

Lambda 之所以有用，与数字文字有用的原因相同。在 Scheme 中，您可以拥有将其他函数作为参数的函数。好吧，有时您想使用其中一个具有“一次性”功能的功能，因此不想费心给它起个名字。例如，让我们看一下 map，它将函数应用于列表：

```
(map f my-list) 
```

生成一个新列表，其结果为 f 应用于每个元素。那么如果我想增加列表的每个元素呢？我可以做：

```
(define inc (lambda (x) (+ x 1)))
(display (map inc '(1 2 3))) 
```

但是，如果我们假装这个公司是一次性的，那么我可能不想费心定义名称，因此我可以这样做：

```
(display (map (lambda (x) (+ x 1)) '(1 2 3))) 
```

lambda 另一个有用的地方是，如果您想创建类似控制结构的东西，但又不想使用宏。好吧，我可以用 lambda 包装我想要做的事情，并且由于它继承了它所在的上下文，所以它工作得很好。例如，假设我需要编写自己的“for-each”版本。这是大纲：

```
(define for-each (lambda (collection body) 
     ...)) 
```

其中 body 是表示“控制结构”主体的 lambda。

然后我会这样使用它：

```
(for-each collection (lambda (element)
    ...)) 
```

您还可以使用 lambdas 动态构建带有其他参数的函数；如果你想做一些手动柯里化，这会带来很大的好处。我不会详细介绍，因为我可能已经走得太远了，但我希望您能看到 lambda 为您提供了很多功能，而不会引入太多复杂性。这也应该回答您关于不使用它会失去什么的问题。

函数字面量（又名匿名函数）在函数式编程中很重要，而且它们也在命令式语言中不断发展。掌握此功能可以让您的生活更轻松，并帮助您学习其他一些语言。

# c++ - How can I convert a pointer to a reference?

> ID：14329056
> 
> 赞同：0
> 
> 时间：2013-01-15T00:05:45.977
> 
> 标签：c++, pointers, reference, type-conversion

I have a function:

```
bool IntersectBoxBox(IShape3D* a, IShape3D* b)
    {
        Box* boxA = (Box*)a;
        Box* boxB = (Box)b;

        return(boxA->Intersects(boxB));
    } 
```

and it's called when the 2 **IShape3D**'s are determined to be a `box` and a `box` type (there is a `IShape3D->GetType()` method).

Anyways,the problem is that **Intersects** takes a `Box& box`,so I can't pass it a pointer. Is there an cheap way to convert the arguments?

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-01-15T00:06:56.473

Just dereference your pointer (`*boxB`).

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-15T00:11:39.507

You can't in general – this is only possible when you have a non-`nullptr`. That may indeed be quite relevant when dynamic casting is involved here, as it seems (don't use C-style casts for dynamic dispatch). After eliminating the `nullptr` case, you may indeed simply dereference the pointer, `*boxB`.

# css - 减小a的宽度 使用 css 阻止

> ID：14329057
> 
> 赞同：1
> 
> 时间：2013-01-15T00:05:48.847
> 
> 标签：css

这是我创建的页面：

![在此处输入图像描述](../Images/0bd801b50c8f786f54bbb21be4145a29.png)

我想减小具有橙色作为背景色的块的宽度，而不在属性宽度中使用数字，有没有其他方法可以做到这一点？

我试过浮动：左；并且它有效，但它向左我希望自动检测宽度，因为文本长度和在 html 页面的中心。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-15T00:07:51.947

一种解决方案是在 div 周围添加一个包装元素：

```
<div id="outer">
    <div id="inner">Vous avez acheté 6 pieces, le total à payer est : 200DH</div>
</div> 
```

进而：

```
#inner {
    display: inline-block; /* for the background */
}

#outer {
    text-align: center; /* for centering */
} 
```

[http://cssdesk.com/Y8SB8](http://cssdesk.com/Y8SB8)

当然，如果 div 的父级已经拥有`text-align: center`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-15T00:13:44.680

好吧，如果您希望它居中并具有自动宽度，则一种选择是将其视为`inline`元素。

```
display: inline; 
```

或者：

```
display: inline-block; 
```

假设父元素有`text-align: center`，这应该足够了。

# sas - SAS合并不同的列

> ID：14329058
> 
> 赞同：1
> 
> 时间：2013-01-15T00:05:58.320
> 
> 标签：sas

我有两个要按城市合并的数据集。问题是一个数据集只有名称，例如：“Bently”、“Caroline”等。但另一个数据集有例如“Bently 镇”、“Caroline 村”等。有没有合并他们使用子字符串？有什么建议么

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-15T09:11:33.497

你可以像这样使用`index`函数`proc sql`：

```
data data_a;
input city $ x;
datalines;
London 1
York 4
Bukovica 10
Berlin 3
;
run;

data data_b;
input city $1-15 y;
datalines;
Good Old London 10
New York        40
Spisic Bukovica 100
;
run;

proc sql;
  create table merge as
  select a.city as city_a
        ,b.city as city_b
        ,x
        ,y
  from data_a as a
         inner join
       data_b as b
         on index(b.city, strip(a.city)) > 0 or index(a.city, strip(b.city)) > 0;
quit; 
```

只需修改连接，使其适合您的需求（内部、左侧、右侧、完整）。

如果您的城市名称不是彼此的子字符串，您可以尝试使用`complev`or计算两个名称之间的编辑距离，`compged`并尝试以这种方式进行一些匹配（可能采用最接近的匹配或超过某个限制的最接近的匹配）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-15T08:47:56.943

如果在第二个数据集中，表单始终是“word + of + actual_name”，那么我将使用 datastep

```
city = scan(city_old,-1); 
```

然后您可以将两者与合并或 proc sql 语句进行比较。

[这里](http://support.sas.com/documentation/cdl/en/lrdict/64316/HTML/default/viewer.htm#a000214639.htm)是扫描功能的 SAS 支持的链接。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-15T00:12:28.503

我建议你使用索引功能。

[http://support.sas.com/documentation/cdl/en/lrdict/64316/HTML/default/viewer.htm#a000212242.htm](http://support.sas.com/documentation/cdl/en/lrdict/64316/HTML/default/viewer.htm#a000212242.htm)

> 在字符表达式中搜索字符串，并返回字符串第一次出现时字符串的第一个字符的位置。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-15T15:20:11.787

如果总是'... of'，那么你可以用“of”的位置来引导你。扫描 (... -1) 在多词城市（“纽约市”）的情况下并不总是有效。

```
data test;
c1='Town of Bentley';
c1_of=find(c1,'of');
c2=substr(c1,c1_of+2);
put _all_;
run; 
```

# java - 同步和可见范围

> ID：14329064
> 
> 赞同：3
> 
> 时间：2013-01-15T00:06:35.890
> 
> 标签：java, concurrency, synchronized, java-memory-model

我一直在阅读 Java 并发性，却忘记了使用相同锁的两个线程中的同步块也会影响变量的可见性，即使它们没有被定义为“易失性”。如果我有这样的代码

```
Object lock = new Object();
boolean a = false, b = false, c = false;

void threadOne() {

   a = true;
   synchronized(lock) {
      b = true;
   }
   c = true;

}

void threadTwo() {

   while (true) {
      synchronized(lock) {
         if (a && b && c) break;
      }
   } 

} 
```

...并且 threadOne 和 threadTwo 将被不同的线程调用：

1.  是否保证代码会跳出while循环？

2.  如果我们从方程中删除变量 c 怎么办？我想知道是否只有 b 保证在 threadTwo 中可见，因为它在同步块内。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-15T00:18:48.273

> 是否保证代码会跳出while循环？

不，Java 内存模型是根据“[发生在](http://docs.oracle.com/javase/specs/jls/se7/html/jls-17.html#jls-17.4.5)”关系定义的：

> 两个动作可以通过happens-before关系排序。如果一个动作发生在另一个动作之前，那么第一个动作对第二个动作可见并在第二个动作之前排序。

规范继续说：

> 如果动作 x 与后续动作 y 同步，那么我们也有 hb(x, y)。

where`hb`代表发生在之前，和

> 监视器 m 上的解锁操作与 m 上的所有后续锁定操作同步（其中“后续”根据同步顺序定义）。

另请注意：

> 如果 hb(x, y) 和 hb(y, z)，则 hb(x, z)。

因此，在您的示例中，`synchronized(lock)`around`b`将为以下读取建立发生前的关系，因此`b`保证 的值在也使用的其他线程中可见`synchronized(lock)`。明确地说，

```
hb(write to b in threadOne, unlock in threadOne) AND 
hb(unlock in threadOne, lock in threadTwo) AND 
hb(lock in threadTwo, read from a in threadTwo) IMPLIES 
hb(write to b in threadOne, read from b in threadTwo) 
```

同样，`a`将保证对其他线程可见。明确地说，

```
hb(write to a in threadOne, lock in threadOne) AND 
hb(lock in threadOne, unlock in threadOne) AND 
hb(unlock in threadOne, lock in threadTwo) AND 
hb(lock in threadTwo, read a in threadTwo) IMPLIES 
hb(write to a in threadOne, read a in threadTwo). 
```

写入和随后的读取`c`没有发生之前的关系，因此，根据规范，写入`c`不一定对`threadTwo`.

> 如果我们从方程中删除变量 c 怎么办？我想知道是否只有 b 保证在 threadTwo 中可见，因为它在同步块内。

是的，见上文。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-15T00:15:19.117

假设每个线程共享您在问题中定义的（不完整）类的相同实例：

> 是否保证代码会跳出while循环？

在实践中，是的。锁只在 threadOne 方法中设置 b 的时间很短。threadTwo 中有足够的上下文切换，以便 threadOne 能够执行同步块。*“在实践中”的含义：在极不可能的情况下（以及实施不佳的 JVM 线程），threadOne 可能被排除在同步块之外，而 threadTwo 继续为 if 检查重新获取同步锁。*（事实上​​，我挑战任何人来制作一个 OPs 场景没有完成的工作示例）。

> 如果我们从方程中删除变量 c 怎么办？我想知道是否只有 b 保证在 threadTwo 中可见，因为它在同步块内。

相同的。在实践中，是的。

对于额外的功劳（挑战），找到一个执行以下代码的 JVM，这样它就不会终止：

```
public class SyncTest {

  public static void main(String args[]) throws Exception {

          final Shared s = new Shared();
          Thread t1 = new Thread () { public void run() { s.threadOne(); } };
          Thread t2 = new Thread () { public void run() { s.threadTwo(); } };

          t2.start();
          t1.start();
  }
}

class Shared {

  Object lock = new Object();
  boolean a = false, b = false, c = false;

  void threadOne() {
    a = true;
    synchronized(lock) {
       b = true;
    }
    c = true;
  }

  void threadTwo() {
    while (true) {
      synchronized(lock) {
         if (a && b && c) break;
      }
    }
  }
} 
```

# iphone - iOS Layer Rendering Queue

> ID：14329072
> 
> 赞同：1
> 
> 时间：2013-01-15T00:07:09.360
> 
> 标签：iphone, ios, quartz-graphics, layer

I ran into a behavior I don't understand yet. My code basically does this:

*   Create view with some custom UIView content (Views with drawRect), this view has no superview yet, so the Quartz subsytem dosen't call it's [layer display].

*   Then i do a renderInContext of the view.

*   The problem is that sometime the view is rendered perfectly, sometimes it does not render the subviews and it does not call their drawRect.

Why does it happen? I'm missing something. I actually know that the same layer can't be rendered simultaneously. But this view is not rendered on the main thread since it doesn't have a superview.

Thank you much

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-06-06T14:59:31.553

非常有趣，没有看过源代码几乎是不可能理解的，但我得到了一些你可以使用的技巧。

*   将视图添加到超级视图设置它的 alpha 为 0
*   尝试将其添加到超级视图的范围之外
*   尝试在该视图上调用 -setNeedsDiplay

我不知道它们是否有效，渲染系统不是一项简单的任务，但我会试一试。我没有得到的一件事，通常子视图被添加为子视图，但你说你用它们做一些事情在drawrect里面。不要在drawRect [drawRect和addSubview中添加子视图：自定义绘图会影响哪些视图？](https://stackoverflow.com/questions/7225789/drawrect-and-addsubview-custom-drawing-affects-which-views)

# c++ - Using pugixml in wchar_t mode and in usual mode in one project

> ID：14329075
> 
> 赞同：0
> 
> 时间：2013-01-15T00:07:22.620
> 
> 标签：c++, xml, pugixml

I have a project with many .cpp files. In some of these files I need to use pugixml in wchar_t mode and some of them are already implemented using char and pugixml in usual mode. I know I have to use definition

```
#define PUGIXML_WCHAR_MODE 
```

When I trying to do like this in files that use wchar_t mode:

```
#define PUGIXML_WCHAR_MODE
*some code*
#undef 
```

it gives me linking errors. What do I do wrong?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-15T05:39:45.310

pugixml is not designed to work this way. Ideally you can try to change the code to use one combination of compilation flags (functions to perform UTF-8 <-> wchar_t conversion, pugi::as_utf8 and pugi::as_wide, might help).

There is an unsupported way that should work, but is not particularly pretty - you can rename pugi namespace for wchar configuration.

To do that, you'd have to create a special header, i.e. pugixmlw.hpp, that you'll include for wide-char configuration; this header contents should be roughly as follows:

```
#ifndef HEADER_PUGIXMLW_HPP
#define HEADER_PUGIXMLW_HPP

#define PUGIXML_WCHAR_MODE
#define pugi pugiw

#undef HEADER_PUGIXML_HPP
#undef HEADER_PUGICONFIG_HPP
#undef SOURCE_PUGIXML_CPP

#undef PUGIXML_TEXT
#undef PUGIXML_CHAR

#include "pugixml.hpp"

#undef PUGIXML_TEXT
#undef PUGIXML_CHAR

#undef HEADER_PUGIXML_HPP
#undef HEADER_PUGICONFIG_HPP
#undef SOURCE_PUGIXML_CPP

#undef pugi
#undef PUGIXML_WCHAR_MODE

#endif 
```

If you're using header-only pugixml variant, that should be it; if you're compiling pugixml.cpp, you'll have to add an extra source file, pugixmlw.cpp, with the following contents:

```
#define PUGIXML_WCHAR_MODE    
#define pugi pugiw
#include "pugixml.cpp" 
```

That should be it.

# css - CSS 3 - 过渡前缀 - 使用哪些？

> ID：14329084
> 
> 赞同：17
> 
> 时间：2013-01-15T00:08:07.627
> 
> 标签：css, css-transitions, transitions

我有一个关于过渡的 CSS 供应商前缀的问题。

[该来源](http://html5please.com/#transition)声明“您需要使用所有常用前缀才能使其在所有浏览器中工作（-o-、-webkit-、-moz-、-ms-）”。

[该页面](http://www.css3files.com/transition/)仅显示`-webkit-`和`-moz-`前缀，并声称 IE 10+、FF 16+ 和 Opera 12.1+ 可以读取前缀免费版本。

在 Twitter Bootstrap 的代码中，除了不加前缀的版本之外，总是存在一个`-webkit-`,`-moz-`和`-o-`前缀的版本。

我应该使用什么前缀？

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2013-01-15T00:13:11.843

[http://caniuse.com/#search=transition](http://caniuse.com/#search=transition)说现代浏览器需要 -webkit- 和普通属性。

```
-webkit-transition: all .5s ease;
transition: all .5s ease; 
```

但是如果你把它们都加起来也没问题，只要确保没有前缀的属性是最后一个。

**编辑：**正如下面评论中所说，如果您单击“所有版本”，您可以看到每个浏览器何时删除前缀。现在最好同时使用 -moz- 和 -o-。

**2015 年 5 月编辑：**我强烈建议使用[Autoprefixer](https://github.com/postcss/autoprefixer)作为构建过程的步骤（如 Gulp/Grunt 任务）或作为代码编辑器的插件。它在 caniuse.com 浏览器支持统计信息上提供自动前缀。

**编辑 2019：**不需要前缀，Autoprefixer 的需要越来越少，未来很好:)

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2013-01-15T00:09:31.843

# 编辑：您不再需要任何前缀。

## 只需使用`transition`.

* * *

到目前为止，所有供应商前缀都应该用于 CSS3 过渡。例如，

```
-webkit-transition: all 500ms;
   -moz-transition: all 500ms;
     -o-transition: all 500ms;
        transition: all 500ms; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-15T00:12:59.710

这取决于您要使用的 CSS 属性。Mozilla 在去除许多属性的前缀方面做得很好。但是你不能告诉**所有**属性现在都没有前缀。我听到 Chrome 团队的消息，他们希望让渐变没有前缀。我不了解 Opera，但 Internet Explorer 10 需要`-ms`许多 CSS3 属性的前缀。

我会说今天你应该只添加前缀。但未来不会是这样的！

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-15T00:10:20.943

帮自己一个忙，下载[Prefix Free](http://leaverou.github.com/prefixfree/)。这是一个很小的 ​​JavaScript，它可以让您使用几乎任何需要前缀的属性，而无需前缀（包括过渡、动画和媒体查询）。

编辑：所有这一切的唯一例外是 Opera 的媒体查询，其中像素比率（仅此而已）必须表示为分数而不是小数。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-01-15T00:14:37.317

-webkit- only，当然还有不带前缀的版本。

所有其他浏览器要么使用无前缀属性（如 Firefox 或 Opera）移动，要么从未使用过它们（如 IE）

我建议定期查看 CanIUse.com 以获取最新信息。

[http://caniuse.com/#feat=css-transitions](http://caniuse.com/#feat=css-transitions)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-01-15T00:19:03.413

我将在此违背常规并建议一种不同的方法：如果您的网站设置了分析功能，请检查浏览器统计信息和版本，看看您的用户实际使用的是什么。

当然，您可以删除大多数前缀，但如果您的用户使用过时的浏览器（无论出于何种原因），他们将无法获得这些功能。

没有任意网站可以告诉*您*所需的确切前缀，只有*您*可以从自己的数据中找出该信息。

如果您没有数据，请添加所有前缀以支持尽可能多的人。然后在几个月内检查数据并在需要时进行重构。

# android - Delete a file from contentResolver only delete the entry from database (not file)

> ID：14329086
> 
> 赞同：5
> 
> 时间：2013-01-15T00:08:17.370
> 
> 标签：android, android-contentresolver, mediastore

I try to delete a file using contentResolver but only delete the entry from database, not the real file. So I try delete first the entry and later the file:

```
int rows = context.getContentResolver().delete(
MediaStore.Audio.Media.EXTERNAL_CONTENT_URI,
MediaStore.Audio.Media._ID + "=" + idSong, null);

// Remove file from card
if (rows != 0) {
Uri uri = ContentUris.withAppendedId(
        MediaStore.Audio.Media.EXTERNAL_CONTENT_URI, idSong);
File f = new File(uri.getPath());
if(!f.delete())
    Log.d("fail-2", "fail-2");  
}
else
Log.d("fail-1", "fail-1"); 
```

...and the output is "fail-2". Why?

Why ContentResolver doesn't delete the real file? Is this normal?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-15T11:23:47.497

这是有效的：

```
 // Remove entry from database
    int rows = context.getContentResolver().delete(
            MediaStore.Audio.Media.EXTERNAL_CONTENT_URI,
            MediaStore.Audio.Media._ID + "=" + idSong, null);

    // Remove file from card
    if (rows != 0) {
        try {
            File f = new File(path);
            if (f.delete())
                return true;
        } catch (Exception e) {
            Log.d("MusicDB", "file: '" + path
                    + "' couldn't be deleted", e);
            return false;
        }
    }
    return false; 
```

但是为什么 contentResolver 不删除文件？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-05-26T15:25:55.680

似乎在 4.2 中，它会将文件归零，但不会删除它。我实际上希望它只是从 MediaStore 中删除它而不是从文件系统中删除它。无论哪种方式，这似乎是一个 Android 错误。

更新文件时遇到问题。我遇到的问题是媒体扫描仪不会在重新扫描时删除旧条目，因此您最终会得到两个条目。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2020-10-02T14:50:42.030

在 kotlin 中试试这个

```
 contentResolver.delete(
          MediaStore.Audio.Media.EXTERNAL_CONTENT_URI
          ,"_data" + "=?", 
          arrayOf(path) ) 
```

# html - 锚点可以包含使用图像映射的图像吗？

> ID：14329096
> 
> 赞同：0
> 
> 时间：2013-01-15T00:09:28.903
> 
> 标签：html

它有效，但我想知道这个标记是否有效，并想解释浏览器如何解析链接。我对 HTML5 如何解释这一点最感兴趣。

```
<a href="http://site1.com/">
  <img src="/image.png" usemap="#map">
</a>

<map name="map">
  <area shape="rect" coords="0,0,50,100" href="http://site2.com">
  <area shape="rect" coords="50,0,100,100" href="http://site3.com">
  <area shape="rect" coords="100,0,150,100" href="http://site4.com">
</map> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-15T00:52:25.370

我查看了 HTML 5 [w3.org/TR/2011/WD-html5-20110113/the-map-element.html](http://w3.org/TR/2011/WD-html5-20110113/the-map-element.html)中地图的 w3 规范。

我阅读第 4.8.14.2 节的方式，处理模型似乎点击图像由浏览器分两步处理。第一步是激活地图中最顶部形状的链接（假设形状及其坐标存在重叠），第二步是向整个图像本身发送事件。通过这两个步骤，我希望在您的 HTML 中，如果点击落在其中一个形状上，则该链接将触发，如果点击所在的位置没有形状，则整个图像的链接将触发。

# ios - App crash due to low memory

> ID：14329100
> 
> 赞同：0
> 
> 时间：2013-01-15T00:09:54.300
> 
> 标签：ios, objective-c, cocoa-touch, memory-management

I have an app that generates PDF files. These PDf's can be large due to the user being able to add pages, potentially unlimited, although usual is approx. ten. Im having problems with iPhone 4 users experiencing a crash at the PDF genration stage. Some investigative work shows the app is running out of memory. I can reproduce the problem on If I add 50 plus pages on iPhone 5, a lot less on iPhone 4 etc and not on the simulator which is expected.

Just to clarify my app runs out of memory when generating the PDF and crashes.

Ive researched here [iPhone App Crashes due to Low Memory but works fine in simulator](https://stackoverflow.com/questions/4275323/iphone-app-crashes-due-to-low-memory-but-works-fine-in-simulator)

and here [Quartz PDF API Causing Out of Memory Crashes](https://stackoverflow.com/questions/3088376/quartz-pdf-api-causing-out-of-memory-crashes)

Is there a way I can reduce this memory usage. Ive ran it through instruments and here is what I get, Im not an experienced programmer so not sure how to interpret this properly or fix this.

![enter image description here](../Images/779a226addce8b74c2ca662b2a3c0806.png)

```
- (void)generatePdf
{
NSMutableArray *pagesArray = [NSMutableArray array];

if ([self.certificate.certificateType.title isEqualToString:@"Minor Works"]) {
    [pagesArray addObject:[[ICPDFMinorWorksPage1 alloc] initWithCertificate:self.certificate]];
    [pagesArray addObject:[[ICPDFMinorWorksPage2 alloc] initWithCertificate:self.certificate]];

} else if ([self.certificate.certificateType.title isEqualToString:@"EIC"]) {
    [pagesArray addObject:[[ICPDFEICPage1 alloc] initWithCertificate:self.certificate]];
    [pagesArray addObject:[[ICPDFEICPage2 alloc] initWithCertificate:self.certificate]];
    [pagesArray addObject:[[ICPDFEICPage3 alloc] initWithCertificate:self.certificate]];
    [pagesArray addObject:[[ICPDFEICPage4 alloc] initWithCertificate:self.certificate]];
    [pagesArray addObject:[[ICPDFEICPage5 alloc] initWithCertificate:self.certificate]];
    [self addDistributionBoardsToPagesArray:pagesArray];
    ICPDFEICPageFinal *pageFinal = [[ICPDFEICPageFinal alloc] initWithCertificate:self.certificate];
    pageFinal.pageNumber.text = [NSString stringWithFormat:@"%d", pagesArray.count+1];
    [pagesArray addObject:pageFinal];

} else if ([self.certificate.certificateType.title isEqualToString:@"Domestic EIC"]) {
    [pagesArray addObject:[[ICPDFDomesticEICPage1 alloc] initWithCertificate:self.certificate]];
    [pagesArray addObject:[[ICPDFDomesticEICPage2 alloc] initWithCertificate:self.certificate]];
    [pagesArray addObject:[[ICPDFDomesticEICPage3 alloc] initWithCertificate:self.certificate]];
    [pagesArray addObject:[[ICPDFDomesticEICPage4 alloc] initWithCertificate:self.certificate]];
    [self addDistributionBoardsToPagesArray:pagesArray];
    [pagesArray addObject:[[ICPDFDomesticEICPageFinal alloc] initWithCertificate:self.certificate]];

} else if ([self.certificate.certificateType.title isEqualToString:@"EICR"]) {
    [pagesArray addObject:[[ICPDFEICRPage1 alloc] initWithCertificate:self.certificate]];
    [pagesArray addObject:[[ICPDFEICRPage2 alloc] initWithCertificate:self.certificate]];
    [self addObservationsToPagesArray:pagesArray];
    [self addDistributionBoardsToPagesArray:pagesArray];
    [pagesArray addObject:[[ICPDFEICRInspection alloc] initWithCertificate:self.certificate]];
    [pagesArray addObject:[[ICPDFEICRInspectionPage1 alloc] initWithCertificate:self.certificate]];
    [pagesArray addObject:[[ICPDFEICRInspectionPage2 alloc] initWithCertificate:self.certificate]];
    [pagesArray addObject:[[ICPDFEICRInspectionPage3 alloc] initWithCertificate:self.certificate]];
    [pagesArray addObject:[[ICPDFEICRPageFinal alloc] initWithCertificate:self.certificate]];
}

// Set page count on all pages
int pageNumber = 0;
for (ICCertificateComponent *page in pagesArray) {
    page.pageNumber.text = [NSString stringWithFormat:@"%d", ++pageNumber];
    page.pageCount.text = [NSString stringWithFormat:@"%d", pagesArray.count];
}

NSData *pdfData = [self createPdfWithPages:pagesArray];
[self performSelectorOnMainThread:@selector(pdfDone:) withObject:pdfData waitUntilDone:YES];

}

- (void)pdfDone:(NSData *)data
{
self.pdfData = data;
[self.webView loadData:self.pdfData MIMEType:@"application/pdf" textEncodingName:@"utf-8" baseURL:nil];
[ICUtils removeProgressView];
}

- (NSData *)createPdfWithPages:(NSArray *)pages
{
// Creates a mutable data object for updating with binary data, like a byte array
NSMutableData *pdfData = [NSMutableData data];

ICCertificateComponent *firstPage = [pages objectAtIndex:0];

    UIGraphicsBeginPDFContextToData(pdfData, firstPage.contentView.bounds, nil);

for (int i = 0; i < pages.count; i++) {
    ICCertificateComponent *thisPage = [pages objectAtIndex:i];
    UIGraphicsBeginPDFPageWithInfo(thisPage.contentView.bounds, nil);
    //
   // CGContextSetInterpolationQuality((__bridge CGContextRef)(thisPage), kCGInterpolationHigh); CGContextSetRenderingIntent((__bridge CGContextRef)(thisPage), kCGRenderingIntentDefault);
   //

    CGContextRef pdfContext = UIGraphicsGetCurrentContext();
    [thisPage.contentView.layer renderInContext:pdfContext];
}

UIGraphicsEndPDFContext();

return pdfData;
}

- (void)addDistributionBoardsToPagesArray:(NSMutableArray *)pagesArray
{
int pageCount = pagesArray.count;
NSSortDescriptor *sortDescriptor = [[NSSortDescriptor alloc] initWithKey:@"createdAt" ascending:YES];
NSArray *sortDescriptors = [[NSArray alloc] initWithObjects:sortDescriptor, nil]; 
NSArray *boards = [self.certificate.distributionBoards sortedArrayUsingDescriptors:sortDescriptors];
for (DistributionBoard *thisBoard in boards) {
    DebugLog(@"Creating a board page");
    ICPDFDistributionBoard *boardPage = [[ICPDFDistributionBoard alloc] initWithDistributionBoard:thisBoard];
    boardPage.pageNumber.text = [NSString stringWithFormat:@"%d", ++pageCount];
    DebugLog(@"Page number is %d", pageCount);
    [pagesArray addObject:boardPage];

    NSSortDescriptor *circuitDescriptor = [[NSSortDescriptor alloc] initWithKey:@"createdAt" ascending:YES];
    NSArray *circuitDescriptors = [[NSArray alloc] initWithObjects:circuitDescriptor, nil]; 
    NSArray *circuits = [thisBoard.circuits sortedArrayUsingDescriptors:circuitDescriptors];

    //int circuitCount = circuits.count;
    ICPDFCircuitDetails *circuitDetails = boardPage.circuitDetails;

    int circuitCount = 0;
    for (Circuit *thisCircuit in circuits) {
        circuitCount++;
        if (circuitCount > 16) {
            // Add an extension page
            DebugLog(@"Adding an extension sheet");
            circuitCount = 1;
            ICPDFDistributionBoardExtension *boardExtension = [[ICPDFDistributionBoardExtension alloc] initWithDistributionBoard:thisBoard];
            [pagesArray addObject:boardExtension];
            boardExtension.pageNumber.text = [NSString stringWithFormat:@"%d", ++pageCount];
            circuitDetails = boardExtension.circuitDetails;
        }
        NSString *key = [NSString stringWithFormat:@"circuitRow%d", circuitCount];
        ICCircuitRow *circuitRow = [circuitDetails valueForKey:key];
        [circuitRow populateFromCircuit:thisCircuit];
       }
    }
 }

- (void)addObservationsToPagesArray:(NSMutableArray *)pagesArray
{
int pageCount = pagesArray.count;
NSSortDescriptor *sortDescriptor = [[NSSortDescriptor alloc] initWithKey:@"createdAt" ascending:YES];
NSArray *sortDescriptors = [[NSArray alloc] initWithObjects:sortDescriptor, nil]; 
NSArray *observations = [self.certificate.observations sortedArrayUsingDescriptors:sortDescriptors];

ICPDFObservations *observationsPage = [[ICPDFObservations alloc] initWithCertificate:self.certificate];
if (observations.count > 28) {
    observationsPage.additionalObservations.text = @"\u2714";
    observationsPage.additionalNotesAttachedOrToFollowRef.text = @"Attached";
}
observationsPage.pageNumber.text = [NSString stringWithFormat:@"%d", ++pageCount];
DebugLog(@"Page number is %d", pageCount);
[pagesArray addObject:observationsPage];

ICObservationTable *observationTable = observationsPage.observationTable;

int observationCount = 0;
for (Observation *observation in observations) {
    observationCount++;
    if (observationCount > 28) {
        // Add an extension page
        DebugLog(@"Adding an extension sheet");
        observationCount = 1;
        ICPDFObservationsExtension *observationsExtension = [[ICPDFObservationsExtension alloc] initWithCertificate:self.certificate];
        [pagesArray addObject:observationsExtension];
        observationTable = observationsExtension.observationTable;
    }
    NSString *key = [NSString stringWithFormat:@"observationRow%d", observationCount];
    ICObservationRow *observationRow = [observationTable valueForKey:key];
    [observationRow populateFromObservation:observation];
  }

 } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-15T00:24:31.433

使用仪器检查由于保留但未泄漏的内存而导致的泄漏和内存丢失。后者是仍然指向的未使用内存。在 Instruments 上的 Allocations 工具中使用 Heapshot。

有关如何使用 Heapshot 查找内存占用，请参阅：[bbum 博客](http://www.friday.com/bbum/2010/10/17/when-is-a-leak-not-a-leak-using-heapshot-analysis-to-find-undesirable-memory-growth/)

基本上有方法是运行 Instruments allocate 工具，拍摄一个 heapshot，运行你的代码的直觉和另一个 heapshot 重复 3 或 4 次。这将指示在迭代期间已分配但未释放的内存。

要弄清楚结果，请查看个人分配。

如果您需要查看对象使用工具的保留、释放和自动释放发生的位置：

在仪器中运行，在 Allocations 中设置“ **Record reference counts** ”（您必须停止记录才能设置选项）。使选择器运行，停止记录，搜索 ivar (datePickerView)，向下钻取，您将能够看到所有保留、释放和自动释放发生的位置。

![](../Images/7838716286f7948b8b94a93abc6764ae.png)

# visual-studio-2010 - Deploy web.config file using MSDeploy

> ID：14329105
> 
> 赞同：0
> 
> 时间：2013-01-15T00:10:16.040
> 
> 标签：visual-studio-2010, msdeploy

Here is my requirement:

I want to be able to deploy my project in such a way that my web.config is not overwritten and stays intact. For all the changes that have been made to web.config during development are copied to a file called new_web.config and that is loaded to the server during the deployment. So that server now has total of two files web.config(The original one before deployment) and new_web.config(the new one).

To achieve that I am doing a Copy from web.config to new_web.config on

and had set BuildAction for web.config= None.

Thats would work fine if the deployment process is copying all the files over from source to destination.

But it is not working in my case because it is deleting all the files in destination folder and then copying all the files from the source.

Can anyone suggest any work around this?

# ios - 检测用户是否在 UITextView 中输入了表情符号字符

> ID：14329110
> 
> 赞同：13
> 
> 时间：2013-01-15T00:10:41.053
> 
> 标签：ios, objective-c, unicode, detect, emoji

我有一个 UITextView，我需要检测用户是否输入了表情符号字符。

我认为只检查最新字符的 unicode 值就足够了，但是对于新的 emoji 2s，一些字符分散在整个 unicode 索引中（即 Apple 新设计的版权和注册标志）。

也许与使用 NSLocale 或 LocalizedString 值检查字符的语言有关？

有谁知道一个好的解决方案？

谢谢！

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2013-01-23T03:51:34.490

多年来，随着 Apple 添加带有新方法的新表情符号（例如通过预先诅咒一个角色和一个额外角色构建的肤色表情符号）等，这些表情符号检测解决方案不断出现问题。

我终于崩溃了，只写了以下适用于所有当前表情符号的方法，并且应该适用于所有未来的表情符号。

该解决方案创建一个带有字符和黑色背景的 UILabel。然后 CG 拍摄标签的快照，我扫描快照中的所有像素以查找任何非纯黑色像素。我添加黑色背景的原因是为了避免由于亚[像素渲染而导致的假着色问题](https://en.wikipedia.org/wiki/Subpixel_rendering)

该解决方案在我的设备上运行得非常快，我可以每秒检查数百个字符，但应该注意这是一个 CoreGraphics 解决方案，不应该像使用常规文本方法那样大量使用。图形处理的数据量很大，因此一次检查数千个字符可能会导致明显的延迟。

```
-(BOOL)isEmoji:(NSString *)character {

    UILabel *characterRender = [[UILabel alloc] initWithFrame:CGRectMake(0, 0, 1, 1)];
    characterRender.text = character;
    characterRender.backgroundColor = [UIColor blackColor];//needed to remove subpixel rendering colors
    [characterRender sizeToFit];

    CGRect rect = [characterRender bounds];
    UIGraphicsBeginImageContextWithOptions(rect.size,YES,0.0f);
    CGContextRef contextSnap = UIGraphicsGetCurrentContext();
    [characterRender.layer renderInContext:contextSnap];
    UIImage *capturedImage = UIGraphicsGetImageFromCurrentImageContext();
    UIGraphicsEndImageContext();

    CGImageRef imageRef = [capturedImage CGImage];
    NSUInteger width = CGImageGetWidth(imageRef);
    NSUInteger height = CGImageGetHeight(imageRef);
    CGColorSpaceRef colorSpace = CGColorSpaceCreateDeviceRGB();
    unsigned char *rawData = (unsigned char*) calloc(height * width * 4, sizeof(unsigned char));
    NSUInteger bytesPerPixel = 4;
    NSUInteger bytesPerRow = bytesPerPixel * width;
    NSUInteger bitsPerComponent = 8;
    CGContextRef context = CGBitmapContextCreate(rawData, width, height,
                                                 bitsPerComponent, bytesPerRow, colorSpace,
                                                 kCGImageAlphaPremultipliedLast | kCGBitmapByteOrder32Big);
    CGColorSpaceRelease(colorSpace);

    CGContextDrawImage(context, CGRectMake(0, 0, width, height), imageRef);
    CGContextRelease(context);

    BOOL colorPixelFound = NO;

    int x = 0;
    int y = 0;
    while (y < height && !colorPixelFound) {
        while (x < width && !colorPixelFound) {

            NSUInteger byteIndex = (bytesPerRow * y) + x * bytesPerPixel;

            CGFloat red = (CGFloat)rawData[byteIndex];
            CGFloat green = (CGFloat)rawData[byteIndex+1];
            CGFloat blue = (CGFloat)rawData[byteIndex+2];

            CGFloat h, s, b, a;
            UIColor *c = [UIColor colorWithRed:red green:green blue:blue alpha:1.0f];
            [c getHue:&h saturation:&s brightness:&b alpha:&a];

            b /= 255.0f;

            if (b > 0) {
                colorPixelFound = YES;
            }

            x++;
        }
        x=0;
        y++;
    }

    return colorPixelFound;

} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2016-12-07T03:37:23.943

首先让我们谈谈您的*“55357 方法”* ——以及**为什么**它适用于许多表情符号字符。

在 Cocoa 中，an`NSString`是`unichar`s 的集合，并且`unichar`只是一个类型别名，`unsigned short`与`UInt16`. `UInt16`由于is的最大值`0xffff`，这排除了相当多的 emoji 表情能够放入 one `unichar`，因为用于表情符号的六个主要 Unicode 块中只有两个属于这个范围：

*   [杂项符号](https://en.wikipedia.org/wiki/Miscellaneous_Symbols)(U+2600–U+26FF)
*   装饰符号 (U+2700–U+27BF [)](https://en.wikipedia.org/wiki/Dingbat#Unicode)

这些块包含 113 个表情符号，另外 66 个可以表示为单个的表情符号`unichar`散布在其他各种块中。但是，这 179 个字符仅代表[1126 个 emoji 基本字符](http://www.unicode.org/reports/tr51/#Emoji_Counts)的一小部分，其余的必须由多个`unichar`.

让我们分析一下您的代码：

```
unichar unicodevalue = [text characterAtIndex:0]; 
```

发生的情况是您只是获取`unichar`字符串的第一个，虽然这适用于前面提到的 179 个字符，但当您遇到 UTF-32 字符时它会分解，因为`NSString`将所有内容都转换为 UTF-16 编码。通过用[*代理对*](https://en.wikipedia.org/wiki/UTF-16#U.2BD800_to_U.2BDFFF)[替换 UTF-32 值来进行](https://en.wikipedia.org/wiki/UTF-16#U.2BD800_to_U.2BDFFF)*转换，这意味着`NSString`now 包含两个`unichar`s。*

 ***现在**我们来了解为什么数字 55357 或出现`0xd83d`在许多表情符号中：当您只查看 UTF-32 字符的第一个 UTF-16 值时，您会得到高代理项，每个代理项的跨度为 1024低代理。高位代理的范围`0xd83d`是 U+1F400–U+1F7FF，从最大的表情符号块、[杂项符号和象形文字](https://en.wikipedia.org/wiki/Miscellaneous_Symbols_and_Pictographs)(U+1F300–U+1F5FF) 的中间开始，一直延伸到[几何形状扩展](https://en.wikipedia.org/wiki/Geometric_Shapes_Extended)(U+1F780–U+1F7FF) – 在这个范围内总共包含 563 个表情符号和 333 个非表情符号字符。

因此，令人印象深刻的 50% 的 emoji 基本字符具有高代理`0xd83d`，但这些扣除方法仍然留下 384 个未处理的 emoji 字符，并且至少给出同样多的误报。

* * *

### 那么，如何检测一个字符是否是表情符号呢？

我最近[用 Swift 实现回答了一个有点相关的问题](https://stackoverflow.com/a/41001432/5389870)，如果你愿意，你可以看看在[这个框架](https://github.com/xoudini/emojica)中是如何检测表情符号的，我创建这个框架的目的是用自定义图像替换标准表情符号。

无论如何，您可以做的是从字符中提取 UTF-32 代码点，我们将根据[规范](http://unicode.org/faq/utf_bom.html)执行此操作：

```
- (BOOL)textView:(UITextView *)textView shouldChangeTextInRange:(NSRange)range replacementText:(NSString *)text {

    // Get the UTF-16 representation of the text.
    unsigned long length = text.length;
    unichar buffer[length];
    [text getCharacters:buffer];

    // Initialize array to hold our UTF-32 values.
    NSMutableArray *array = [[NSMutableArray alloc] init];

    // Temporary stores for the UTF-32 and UTF-16 values.
    UTF32Char utf32 = 0;
    UTF16Char h16 = 0, l16 = 0;

    for (int i = 0; i < length; i++) {
        unichar surrogate = buffer[i];

        // High surrogate.
        if (0xd800 <= surrogate && surrogate <= 0xd83f) {
            h16 = surrogate;
            continue;
        }
        // Low surrogate.
        else if (0xdc00 <= surrogate && surrogate <= 0xdfff) {
            l16 = surrogate;

            // Convert surrogate pair to UTF-32 encoding.
            utf32 = ((h16 - 0xd800) << 10) + (l16 - 0xdc00) + 0x10000;
        }
        // Normal UTF-16.
        else {
            utf32 = surrogate;
        }

        // Add UTF-32 value to array.
        [array addObject:[NSNumber numberWithUnsignedInteger:utf32]];
    }

    NSLog(@"%@ contains values:", text);

    for (int i = 0; i < array.count; i++) {
        UTF32Char character = (UTF32Char)[[array objectAtIndex:i] unsignedIntegerValue];
        NSLog(@"\t- U+%x", character);
    }

    return YES;
} 
```

键入“”到`UITextView`控制台中：

```
 contains values:
    - U+1f60e 
```

使用这种逻辑，只需将 的值`character`与您的表情符号代码点的数据源进行比较，您就会确切地知道该字符是否是表情符号。

* * *

附言

还有一些*“不可见”*的字符，即[Variation Selectors](https://en.wikipedia.org/wiki/Variation_Selectors_(Unicode_block))和[zero-width joiners](https://en.wikipedia.org/wiki/Zero-width_joiner)，也应该被处理，所以我建议研究这些字符以了解它们的行为方式。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2015-01-08T12:56:47.523

另一种解决方案：[https ://github.com/woxtu/NSString-RemoveEmoji](https://github.com/woxtu/NSString-RemoveEmoji)

然后，导入此扩展后，您可以像这样使用它：

```
- (BOOL)textView:(UITextView *)textView shouldChangeTextInRange:(NSRange)range replacementText:(NSString *)text
{
    // Detect if an Emoji is in the string "text"
    if(text.isIncludingEmoji) {
        // Show an UIAlertView, or whatever you want here
        return NO;
    }

    return YES;
} 
```

希望有帮助；）

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2016-06-02T07:30:25.657

如果您不希望键盘显示表情符号，您可以使用 `YOURTEXTFIELD/YOURTEXTVIEW.keyboardType = .ASCIICapable`
这将显示没有表情符号的键盘

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2019-04-30T09:43:35.690

这是**Swift中的****表情符号检测**方法。它工作正常。希望它会帮助别人。

 **```
 func isEmoji(_ character: String?) -> Bool {

        if character == "" || character == "\n" {
            return false
        }
        let characterRender = UILabel(frame: CGRect(x: 0, y: 0, width: 1, height: 1))
        characterRender.text = character
        characterRender.backgroundColor = UIColor.black  
        characterRender.sizeToFit()
        let rect: CGRect = characterRender.bounds
        UIGraphicsBeginImageContextWithOptions(rect.size, true, 0.0)

        if let contextSnap:CGContext = UIGraphicsGetCurrentContext() {
            characterRender.layer.render(in: contextSnap)
        }

        let capturedImage: UIImage? = (UIGraphicsGetImageFromCurrentImageContext())
        UIGraphicsEndImageContext()
        var colorPixelFound:Bool = false

        let imageRef = capturedImage?.cgImage
        let width:Int = imageRef!.width
        let height:Int = imageRef!.height

        let colorSpace = CGColorSpaceCreateDeviceRGB()

        let rawData = calloc(width * height * 4, MemoryLayout<CUnsignedChar>.stride).assumingMemoryBound(to: CUnsignedChar.self)

            let bytesPerPixel:Int = 4
            let bytesPerRow:Int = bytesPerPixel * width
            let bitsPerComponent:Int = 8

            let context = CGContext(data: rawData, width: Int(width), height: Int(height), bitsPerComponent: Int(bitsPerComponent), bytesPerRow: Int(bytesPerRow), space: colorSpace, bitmapInfo: CGImageAlphaInfo.premultipliedLast.rawValue | CGBitmapInfo.byteOrder32Big.rawValue)

        context?.draw(imageRef!, in: CGRect(x: 0, y: 0, width: width, height: height))

            var x:Int = 0
            var y:Int = 0
            while (y < height && !colorPixelFound) {

                while (x < width && !colorPixelFound) {

                    let byteIndex: UInt  = UInt((bytesPerRow * y) + x * bytesPerPixel)
                    let red = CGFloat(rawData[Int(byteIndex)])
                    let green = CGFloat(rawData[Int(byteIndex+1)])
                    let blue = CGFloat(rawData[Int(byteIndex + 2)])

                    var h: CGFloat = 0.0
                    var s: CGFloat = 0.0
                    var b: CGFloat = 0.0
                    var a: CGFloat = 0.0

                    var c = UIColor(red:red, green:green, blue:blue, alpha:1.0)
                    c.getHue(&h, saturation: &s, brightness: &b, alpha: &a)

                    b = b/255.0

                    if Double(b) > 0.0 {
                        colorPixelFound = true
                    }
                    x+=1
                }
                x=0
                y+=1
            }

        return colorPixelFound
} 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2019-06-18T08:06:31.503

以下是检查绘制的字符是否具有任何颜色的代码的更清洁和更有效的实现。

这些已被编写为类别/扩展方法，以使它们更易于使用。

**目标-C：**

NSString+表情符号.h：

```
#import <Foundation/Foundation.h>

@interface NSString (Emoji)

- (BOOL)hasColor;

@end 
```

NSString+表情符号.m：

```
#import "NSString+Emoji.h"
#import <UIKit/UIKit.h>

@implementation NSString (Emoji)

- (BOOL)hasColor {
    UILabel *characterRender = [[UILabel alloc] initWithFrame:CGRectZero];
    characterRender.text = self;
    characterRender.textColor = UIColor.blackColor;
    characterRender.backgroundColor = UIColor.blackColor;//needed to remove subpixel rendering colors
    [characterRender sizeToFit];

    CGRect rect = characterRender.bounds;
    UIGraphicsBeginImageContextWithOptions(rect.size, YES, 1);
    CGContextRef contextSnap = UIGraphicsGetCurrentContext();
    [characterRender.layer renderInContext:contextSnap];
    UIImage *capturedImage = UIGraphicsGetImageFromCurrentImageContext();
    UIGraphicsEndImageContext();

    CGImageRef imageRef = capturedImage.CGImage;
    size_t width = CGImageGetWidth(imageRef);
    size_t height = CGImageGetHeight(imageRef);
    CGColorSpaceRef colorSpace = CGColorSpaceCreateDeviceRGB();
    size_t bytesPerPixel = 4;
    size_t bitsPerComponent = 8;
    size_t bytesPerRow = bytesPerPixel * width;
    size_t size = height * width * bytesPerPixel;
    unsigned char *rawData = (unsigned char *)calloc(size, sizeof(unsigned char));
    CGContextRef context = CGBitmapContextCreate(rawData, width, height,
                                                 bitsPerComponent, bytesPerRow, colorSpace,
                                                 kCGImageAlphaPremultipliedLast | kCGBitmapByteOrder32Big);
    CGColorSpaceRelease(colorSpace);

    CGContextDrawImage(context, CGRectMake(0, 0, width, height), imageRef);
    CGContextRelease(context);

    BOOL result = NO;
    for (size_t offset = 0; offset < size; offset += bytesPerPixel) {
        unsigned char r = rawData[offset];
        unsigned char g = rawData[offset+1];
        unsigned char b = rawData[offset+2];

        if (r || g || b) {
            result = YES;
            break;
        }
    }

    free(rawData);

    return result;
}

@end 
```

示例用法：

```
if ([@"" hasColor]) {
    // Yes, it does
}
if ([@"@" hasColor]) {
} else {
    // No, it does not
} 
```

* * *

**迅速：**

字符串+表情符号.swift：

```
import UIKit

extension String {
    func hasColor() -> Bool {
        let characterRender = UILabel(frame: .zero)
        characterRender.text = self
        characterRender.textColor = .black
        characterRender.backgroundColor = .black
        characterRender.sizeToFit()
        let rect = characterRender.bounds
        UIGraphicsBeginImageContextWithOptions(rect.size, true, 1)

        let contextSnap = UIGraphicsGetCurrentContext()!
        characterRender.layer.render(in: contextSnap)

        let capturedImageTmp = UIGraphicsGetImageFromCurrentImageContext()
        UIGraphicsEndImageContext()
        guard let capturedImage = capturedImageTmp else { return false }

        let imageRef = capturedImage.cgImage!
        let width = imageRef.width
        let height = imageRef.height

        let colorSpace = CGColorSpaceCreateDeviceRGB()

        let bytesPerPixel = 4
        let bytesPerRow = bytesPerPixel * width
        let bitsPerComponent = 8
        let size = width * height * bytesPerPixel
        let rawData = calloc(size, MemoryLayout<CUnsignedChar>.stride).assumingMemoryBound(to: CUnsignedChar.self)

        guard let context = CGContext(data: rawData, width: width, height: height, bitsPerComponent: bitsPerComponent, bytesPerRow: bytesPerRow, space: colorSpace, bitmapInfo: CGImageAlphaInfo.premultipliedLast.rawValue | CGBitmapInfo.byteOrder32Big.rawValue) else { return false }

        context.draw(imageRef, in: CGRect(x: 0, y: 0, width: width, height: height))

        var result = false
        for offset in stride(from: 0, to: size, by: 4) {
            let r = rawData[offset]
            let g = rawData[offset + 1]
            let b = rawData[offset + 2]

            if (r > 0 || g > 0 || b > 0) {
                result = true
                break
            }
        }

        free(rawData)

        return result
    }
} 
```

示例用法：

```
if "".hasColor() {
    // Yes, it does
}
if "@".hasColor() {
} else {
    // No, it does not
} 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2019-11-27T08:30:52.647

Swift 的 String 类型有一个属性 .isEmoji

最好检查 isEmojiPresentation 警告的文档

[https://developer.apple.com/documentation/swift/unicode/scalar/properties/3081577-isemoji](https://developer.apple.com/documentation/swift/unicode/scalar/properties/3081577-isemoji)

* * *

## 回答 #8

> 赞同：-3
> 
> 时间：2013-01-15T02:41:22.523

好吧，您可以使用以下方法检测它是否只有 ascii 字符：

```
[myString canBeConvertedToEncoding:NSASCIIStringEncoding]; 
```

如果失败（或有表情符号），它会拒绝。然后你可以做一个 if else 语句，不允许他们点击进入或其他东西。

* * *

## 回答 #9

> 赞同：-4
> 
> 时间：2015-01-28T15:19:32.953

表情符号字符长度为 2，因此在 shouldChangeTextInRange: 方法中检查字符串长度是否为 2：在键盘击中每个键后调用

```
- (BOOL)textView:(UITextView *)textView shouldChangeTextInRange:(NSRange)range replacementText:(NSString *)text

{

    // Detect if an Emoji is in the string "text"
    if([text length]==2) {
        // Show an UIAlertView, or whatever you want here
        return YES;
    }
    else
{

       return NO;
}

} 
```***

# macos - Qt 4.8 - 在 mac-mini (OS X Lion) 上检测 sd 卡的插入和移除

> ID：14329114
> 
> 赞同：10
> 
> 时间：2013-01-15T00:11:27.497
> 
> 标签：macos, qt4, notifications, sd-card, qt4.8

我对在 Mac 上开发应用程序完全陌生。在这里，我只使用 Qt 开发了 2-3 个应用程序，而没有使用 Objective-c / cocoa / xcode 开发的应用程序。

**在 Qt 4（特别是 4.8）中，有没有办法检测 SD 卡何时插入 Mac mini（OS X Lion）？**

我在网上和 stackoverflow 上（重新）搜索了很多 - 并且出现了一些结果 - 但都是针对 Android 和 Windows - 与 Mac（mini OS X Lion）无关。

直到现在我发现了这个：

*   在 Mac (mini) 上，读卡器的处理方式与任何其他 USB 设备一样
*   我还在 Mac Developer Library 中找到了这个[示例](https://developer.apple.com/library/mac/#samplecode/USBPrivateDataSample/Listings/USBPrivateDataSample_c.html)。我希望所有人都可以访问此链接。
    此示例...“演示了使用 IOKitLib 和 IOUSBLib 在 USB 设备连接到系统或从系统中移除时设置异步回调”。因此是可以实现的。
    我想在 Qt 中做同样的事情。

我想检测何时插入了 SD 卡，然后我想显示我的应用程序，获取一些输入并将所选文件从卡移动到本地磁盘。
显然，一切都很简单——仅检测卡片并显示应用程序（从托盘或最小化状态）是重要且困难的部分。

如果您能指出正确的方向，我将不胜感激。
提前致谢！！

* * *

**更新：**

我进一步研究发现：

*   在 Linux 上我们可以用它`udev(libudev)`来实现这样的事情。
*   但后来我发现[udev 是 Linux 特定的，在 OS X 中找不到](https://apple.stackexchange.com/q/46951)。[这里](https://apple.stackexchange.com/q/46951)
    的答案建议. [我在这里](http://larsmichelsen.com/open-source/photo-autocopy-from-sd-card/)和[这里](https://stackoverflow.com/q/4189383/1082289)发现了一些非常相似的东西，但是对于使用*udev*规则的 Linux :(`use the diskutil activity command to continuously monitor disks being mounted or ejected`

**   最新且看似最相关的发现是：
    *   `diskutil` `plist`并且`IOKit(DiskArbitration)`必须成为我寻求的解决方案的一部分*   最后，[在这里](https://apple.stackexchange.com/q/3030)我发现`launchd` `plist`了`Lingon`*

 *现在......我有比昨天更多的东西，但我仍然需要帮助将所有这些放在一起并在 Qt 应用程序中使用它。我非常感谢有人指导我达到最终结果。如果我真的能创造出有用的东西，我会继续努力并更新。

提前致谢！！:)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-20T10:07:30.527

我认为您需要创建一个[启动代理](http://developer.apple.com/library/mac/#documentation/MacOSX/Conceptual/BPSystemStartup/Chapters/CreatingLaunchdJobs.html)，该代理使用[DiskArbitration 框架](http://developer.apple.com/library/mac/#documentation/Darwin/Reference/DiscArbitrationFramework/_index.html)来监视正在安装的新磁盘。当用户登录时，此代理将设置为在后台运行。当您的助手检测到已安装新磁盘时，它可以检查`DADiskRef`代表磁盘的属性以确定您的应用程序是否感兴趣。如果是，则它可以使用[LaunchServices](https://developer.apple.com/library/mac/#documentation/Carbon/Conceptual/LaunchServicesConcepts/LSCIntro/LSCIntro.html#//apple_ref/doc/uid/TP30000999) API 启动应用程序的面向用户的部分。

使用 DiskArbitration 注册磁盘挂载事件的代码草图如下：

```
#include <Foundation/Foundation.h>
#include <DiskArbitration/DiskArbitration.h>

static void diskAppearedCallback(DADiskRef disk, void* context)
{
    CFDictionaryRef description = DADiskCopyDescription(disk);
    NSLog(@"Disk appeared: %@", description);
    CFRelease(description);
}

int main(int argc, char **argv)
{
    DASessionRef session = DASessionCreate(kCFAllocatorDefault);
    DARegisterDiskAppearedCallback(session, kDADiskDescriptionMatchVolumeMountable, diskAppearedCallback, 0);
    DASessionScheduleWithRunLoop(session, CFRunLoopGetCurrent(), kCFRunLoopDefaultMode);

    CFRunLoopRun();

    return 0;
} 
```

返回的字典`DADiskCopyDescription`包含许多属性，您可能会发现这些属性在确定新安装的磁盘是否感兴趣时很有用，包括媒体是否可移动、可弹出等。*

# google-maps - 将 Google Play 服务库添加到项目后资源不同步错误

> ID：14329120
> 
> 赞同：1
> 
> 时间：2013-01-15T00:11:55.043
> 
> 标签：google-maps, google-play-services

我在使用 Google Maps Android API v2 的项目中遇到了一些麻烦。

我正在尝试按照 Maps API 2 官方教程调试示例项目： [https ://developers.google.com/maps/documentation/android/start?hl=pt-PT](https://developers.google.com/maps/documentation/android/start?hl=pt-PT)

一切运行良好，但是当我将 Google Play 服务库添加到项目中时，就像遵循本教程一样： [https ://docs.google.com/document/pub?id=19nQzvKP-CVLd7_VrpwnHfl-AE9fjbJySowONZZtNHzw](https://docs.google.com/document/pub?id=19nQzvKP-CVLd7_VrpwnHfl-AE9fjbJySowONZZtNHzw)

我收到以下错误：

`> Unable to create editor ID org.eclipse.jdt.ui.PropertiesFileEditor: Resource is out of sync with the file system: '/tnc/project.properties'.`

当我将库 ( `.jar`) 文件添加到项目时发生错误。当我删除库文件时，一切都恢复正常。

我不明白为什么添加库会使我的`project.properties`文件无效。我已经尝试了一切：刷新，*Android 工具*->*修复项目属性* ，但我无法修复错误。发生错误时，项目文件夹图标中会出现一个红色感叹号。

# java - Java - Socket Swing 应用程序崩溃

> ID：14329121
> 
> 赞同：0
> 
> 时间：2013-01-15T00:11:55.657
> 
> 标签：java, swing, sockets

我正在制作一个 Java Socket Swing 应用程序。我创造了这个空白：

```
private static void sendMessage(JTextField message) {
    try {
        String data = user + ": " + message.getText();
        out.println(data);
        System.out.println(in.readLine());
    }
    catch(Exception exc) {
        JOptionPane.showMessageDialog(dpanel,
            "Could not send message. Reason: " + exc, "",
            JOptionPane.ERROR_MESSAGE);
    }
} 
```

在我尝试将第二条消息发送到服务器后，程序卡住了。有人可以为我的代码提供任何建议吗？谢谢！

附言

`sendMessage()`由 a `MouseLisitener`for a触发`JButton`。
有一个`PipeStream`for`System.err`和 out to a `JTextArea`。
这就是输入输出和连接是/是：

```
try {
    connection = new Socket(ipa, port);
    out = new PrintWriter(connection.getOutputStream(), true);
    in = new BufferedReader(new InputStreamReader(connection.getInputStream())));
}
... 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-15T00:25:33.200

问题：

*   为什么是静态方法？除非有充分的理由，否则您应该避免所有静态问题，而这里没有。
*   你没有提到你是如何处理你的线程的，这很可能会导致你的问题。您是否使用 SwingWorker 来创建后台线程？您是否注意在 Swing 事件线程上进行所有 Swing 调用？
*   您声明您让 JButton 使用 MouseListener，这不是一个好习惯。JButton 的构建是为了最好地响应 ActionListener。这将触发对 JButton 状态的视觉更改，并且还允许您通过禁用 JButton 来禁用操作。我建议您阅读 Oracle Swing 教程按钮部分以获取更多详细信息。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-15T00:25:56.517

听起来您正试图从事件调度线程的上下文中调用潜在的阻塞 I/O。这绝不是一个好主意，任何会阻止 EDT 的东西都会停止（除其他外）重绘请求并阻止 EDT 处理鼠标和键盘事件......

所有与 UI 的交互（创建和修改）都应该在 EDT 的上下文中完成。

我建议您查看[Swing 中的并发以](http://docs.oracle.com/javase/tutorial/uiswing/concurrency/index.html)了解一些背景...

在您的情况下，您将需要某种`Thread`能够通过套接字发送和接收数据的或后台工作人员。这将允许您在不阻塞 EDT 的情况下排队发送消息并处理结果。

但是这实际上是如何实现的将归结为你的要求是什么......

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-15T15:21:53.067

我删除了 void 部分并将其放入鼠标侦听器中，并在每次发送消息时打开和关闭连接。这防止了程序崩溃。感谢您帮助我认识到我的错误。

# apache-pig - 如何在 Pig 中指定任务超时？

> ID：14329122
> 
> 赞同：2
> 
> 时间：2013-01-15T00:12:02.297
> 
> 标签：apache-pig

我想知道当我运行猪作业时是否可以执行 -Dmapred.task.timeout= ... 之类的操作？另一种方法是更改​​底层 hadoop 集群的 mapred-site.xml 配置，但现在不可行。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-24T18:06:47.027

自己回答我的问题：这是一个例子：SET mapred.task.timeout 18000

最后一个数字以毫秒为单位。（不是秒）

# php - 这个 php 查询如何生成选择输入字段？

> ID：14329124
> 
> 赞同：-1
> 
> 时间：2013-01-15T00:12:23.557
> 
> 标签：php, wordpress, select

```
<p class="<?php if (get_option('jr_submit_cat_required')!=='yes') : echo 'optional'; endif; ?>"><label for="job_cat"><?php _e('Job Category', 'appthemes'); ?> <?php if (get_option('jr_submit_cat_required')=='yes') : ?><span title="required">*</span><?php endif; ?></label> <?php
            $sel = 0;
            if (isset($posted['job_term_cat']) && $posted['job_term_cat']>0) $sel = $posted['job_term_cat']; 
            global $featured_job_cat_id;
            $args = array(
                'orderby'            => 'name', 
                'exclude'            => $featured_job_cat_id,
                'order'              => 'ASC',
                'name'               => 'job_term_cat',
                'hierarchical'       => 1, 
                'echo'               => 0,
                'class'              => 'job_cat',
                'selected'           => $sel,
                'taxonomy'           => 'job_cat',
                'hide_empty'         => false
            );
            $dropdown = wp_dropdown_categories( $args );
            $dropdown = str_replace('class=\'job_cat\' >','class=\'job_cat\' ><option value="">'.__('Select a category&hellip;', 'appthemes').'</option>',$dropdown);
            echo $dropdown;
        ?></p> 
```

我尝试插入 `onchange="changeValue();`此选择字段，但找不到该字段！然而，代码实际上在表单中生成了一个选择字段。

请帮我找出原因。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-15T00:18:40.630

它`<select>`为您生成，但您可以将其潜入底部附近。

替换这一行

```
$dropdown = str_replace('class=\'job_cat\' >','class=\'job_cat\' ><option value="">'.__('Select a category&hellip;', 'appthemes').'</option>',$dropdown); 
```

有了这个

```
$dropdown = str_replace('class=\'job_cat\' >','class=\'job_cat\' onchange="changeValue();"><option value="">'.__('Select a category&hellip;', 'appthemes').'</option>',$dropdown); 
```

它应该按照您的要求工作！

# lxc - 在 lxc 容器中执行命令并得到响应

> ID：14329131
> 
> 赞同：1
> 
> 时间：2013-01-15T00:13:03.500
> 
> 标签：lxc

我想在沙箱中执行不受信任的用户提交的代码。除非存在错误或用户试图破坏服务器，否则代码不应使用太多 CPU 和 Ram。

我可以使用 lxc 创建临时沙箱吗？创建和停止容器的开销是多少？如何获得脚本的输出？是否有一个配置示例阻止容器中的所有内容以使其 100% 安全，而不是只打开我需要的东西？容器是否能够使用主机上安装的 Java 和 Python 等程序，但仍无法破坏主机？

谢谢

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2014-01-24T03:43:34.317

我认为您应该尝试[docker.io](https://www.docker.io/gettingstarted/)。有了这个，LXC 变得非常容易。设置 LXC 是一个一次性的过程，然后您可以在 < 5 秒内随时运行它。

LXC 内部的错误或用户不可能危及主机。客户端 LXC 使用 cgroup 和命名空间在基本级别完全分离资源，不仅与主机，而且在同一主机上运行的其他 LXC 也是如此。

# visual-studio-2010 - 无法添加 SOAP Web 参考

> ID：14329134
> 
> 赞同：1
> 
> 时间：2013-01-15T00:13:22.513
> 
> 标签：visual-studio-2010, soap, web-reference

我在本地服务器上安装了一个 .wsdl 文件。但是，当我尝试通过 VS 添加它时，它无法在安装路径（本地主机的根目录）中找到它。我知道该文件在那里，因为当我浏览文件系统时可以看到它。当我尝试将其添加为 Web 参考时，我是否遗漏了什么？我试过 localhost、127.0.0.1 和服务器的 IP。

# html - 在用户调整窗口大小时移动 div

> ID：14329135
> 
> 赞同：1
> 
> 时间：2013-01-15T00:13:24.713
> 
> 标签：html, css

HTML：

```
<!DOCTYPE HTML>
<html>
<head>
    <meta charset="UTF-8">
    <title></title>
    <link href="style.css" rel="stylesheet" type="text/css">
    <script src="http://code.jquery.com/jquery-1.6.4.min.js"></script>

    <link href='http://fonts.googleapis.com/css?family=Open+Sans:300' rel='stylesheet' type='text/css'>
</head>

<body>

    <div id="nav">
        <p id="welcomeLink">Welcome</p>
        <p id="historyLink">History</p>
        <p id="valueLink">The Value</p>
        <p id="contactLink">Contact</p>
    </div>
    <div id="welcomeArrow"></div>
    <div id="historyArrow"></div>
    <div id="valueArrow"></div>
    <div id="contactArrow"></div>

    <div id="wrapper">

        <div id="mainHeader">
            <img src="Carnaby_Full__Logo_1.jpg" />
        </dvi>

        <div id="content">

            <p id="welcomeP">
                When clothed, one's image, apart from his hands and face, is completely self-defined.  That means that everyone has a style.  It's upon this idea that Carnaby Custom works. Operating from our showroom in Midtown Manhattan, my father and I provide the most valuable custom made suits, shirts, and sport coats in the tri-state area.
            </p>

            <p id="historyP">
                In 1971, Leonard Logsdail Sr. opened his bespoke tailoring shop in London. At that time, Carnaby Street, right off of the famous Saville Row, was the fashion center of the world.  For 20 years, he ran a successful business, traveling around the world, hand-making garments for lawyers, lords, governors, princes, businessmen, barons, earls, bankers, and actors.  At the bidding of my American mother, he moved his Saville Row tailoring business to New York City. Since then, he quickly became one of the most well-respected tailors in the country and the world. <br> <br> As you can imagine, making a suit by hand is no easy task. It requires plenty of time and money. This is why Carnaby Custom exists. Carnaby Custom provides a custom garment, overseen by and utilizing the experience of master tailor Leonard Sr, for a much more affordable price point.
            </p>

            <p id="valueP">
            No two people are shaped the same way. Hypothetically, if we were to make suits for two men with identical dimensions (arm, length, height, etc), the completed garments would still not fit one another. This is because people stand with different postures, have varying shoulder heights, pigeon chests, uneven hips-just to name a few. We take all of these things into account when sizing our clients up for custom made to measure garments. This allows for a superior fit. <br> <br>

    Because your future garment does not yet exist, we work together with our clients designing the suit to however best suits his lifestyle. With thousands of fabrics, hundreds of linings, and countless other style and preference options-the possibilities are endless. <br> <br>

    During the first appointment, we will ask a series of questions in order to better understand your style and needs. Unlike salesmen at most retail stores, who get paid an hourly rate, no matter if you're happy with your purchase or not, we are always looking to do future business with our clients. This means that you can be sure that we will do everything in our power to make your purchase a satisfactory one. <br> <br>

    We take great pride in our ability to provide custom garments at the most competitive prices in the market today. Our garments are available at the same price point that most retailers sell their off-the-rack suits for. Except ours will be made specifically for you! </p></a>

        </div>

    </div> 

</body>
</html> 
```

CSS: body { 背景: url(navy_blue/navy_blue.png); }

```
#nav {
    position: absolute;
    text-align:center;
    top: 322px;
    float: left;
    left: 155px;
    padding-right: 20px;
    padding-left: 20px;
    background: #D5D5D5;
    font-family: 'Open Sans', sans-serif;
    font-size: 16px;
    border: black solid thin;
    border-radius: 10px;
    line-height: 16px;  
}

#nav p {
    color: #000099;
}

#nav p:hover {
    opacity: .6;
    cursor: pointer;
    -moz-transition: .3s ease-in-out;
    -webkit-transition: .3s ease-in-out;
}

#welcomeArrow {
    position: absolute;
    left: 255px;
    top: 336px;
    width: 0; 
    height: 0; 
    border-top: 17px solid transparent;
    border-bottom: 17px solid transparent;
    border-left: 17px solid #D5D5D5;
}

#historyArrow {
    display: none;
    position: absolute;
    left: 256px;
    top: 364px;
    width: 0; 
    height: 0; 
    border-top: 17px solid transparent;
    border-bottom: 17px solid transparent;
    border-left: 17px solid #D5D5D5;
}

#valueArrow {
    display: none;
    position: absolute;
    left: 256px;
    top: 396px;
    width: 0; 
    height: 0; 
    border-top: 17px solid transparent;
    border-bottom: 17px solid transparent;
    border-left: 17px solid #D5D5D5;
}

#contactArrow {
    display: none;
    position: absolute;
    left: 256px;
    top: 430px;
    width: 0; 
    height: 0; 
    border-top: 17px solid transparent;
    border-bottom: 17px solid transparent;
    border-left: 17px solid #D5D5D5;
}

#wrapper {
    background: url(billie_holiday/billie_holiday.png);
    top: auto;
    margin: auto;
    text-align: center;
    height: auto;
    width: 640px;
    font-family: 'Open Sans', sans-serif;
    padding: 30px;
    border: black solid medium;
    border-radius: 10px;
}

#wrapper p {
    padding-top: 20px;
    font-size: 14px;    
}

#mainHeader img{
    border: solid thin black;
}

#welcomeP {
    display: inline;
}

#historyP {
    display: none;
}

#valueP{
    display: none;
}

#contactP {
    display: none;
}

#welcomeH {
    font-size: 24px;
    color: #993300; 
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-15T00:18:07.997

将导航 div 放入包装器 div 并将其位置更改为相对。然后给导航 div 一个负的左边距。之后你可能需要调整你的小箭头。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-15T00:20:57.023

将#nav 放在#wrapper 中。将#wrapper 的位置设置为相对，将#nav 的位置设置为绝对。这将使用位置为“相对”的父容器作为边界框。然后给#nav 'left' 一个负值。

```
#wrapper{
position: relative;
}

#nav{
position:absolute;
left:-100px;
} 
```

# javascript - 使用方法 javascript 将框添加到页面

> ID：14329138
> 
> 赞同：1
> 
> 时间：2013-01-15T00:13:50.830
> 
> 标签：javascript, object, methods

我在这里有一个对象构造函数：

```
function Box (id, name, color, number, coordinates) {  
   this.id = id;
   this.name = name;
   this.color = color;
   this.number = number;
   this.coordinates = coordinates;

   this.add = function(howMany) {
   }
  } 
```

我在这里有一个函数的一部分，我可以在其中获得用户使用单选按钮选择的数值（5,10 或 15）。

```
 function getBoxValues() {
   var nameInput = document.getElementById("name");  
   var name = nameInput.value; 

   var numbersArray = dataForm.elements.amount;
   for (var i = 0; i < numbersArray.length; i++) {
   if (numbersArray[i].checked) {
    number = numbersArray[i].value;

   if (name == null || name == "") {                    
     alert("Please enter a name for your box");
     return;
   }
   else {
    var newbox = new Box("id", name, color, number, "coordinates");  
    boxes.push(newbox);                                       
    addBox(newbox);                                           

   var data = document.getElementById("dataForm");               
    data.reset();
   } 
```

后来，我用这个函数在页面中添加了框：

```
 function addBox(newbox) {                                   
   var scene = document.getElementById("scene");              
   var div = document.createElement("div");                   
   div.innerHTML += newbox.name; 
   var x = Math.floor(Math.random() * (scene.offsetWidth-101));
   var y = Math.floor(Math.random() * (scene.offsetHeight-101));
   div.style.left = x + "px";
   div.style.top = y + "px";                        
   scene.appendChild(div);
   newbox.add(number);   
   for (var i = 0; i < howMany; i++) {
   console.log("added"); 
    addBox(newbox);
    }                          
  } 
```

我的问题是我想向网页添加与用户使用单选按钮选择的相同数量的框。到目前为止，我的控制台日志告诉我“添加”了“数字”的值循环通过的次数。但是，我不知道如何更改我的代码，以便为数字的值创建新框。我是这方面的初学者，所以对于任何混淆，我提前道歉。将不胜感激任何帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-15T00:26:32.583

```
function addBoxes () {
    var i;

    for (i=0; i < number; i += 1) {
        // create box
        addBox(newBox);
    }
} 
```

# html - R中的HTML字符实体替换

> ID：14329140
> 
> 赞同：1
> 
> 时间：2013-01-15T00:13:51.797
> 
> 标签：html, r, xml-parsing, character, replace

我有一大组 HTML 文件，其中包含来自节点中杂志的文本`span`。`&nbsp;`我的 PDF 到 HTML 转换器在整个 HTML 中插入了字符实体。问题是在 R 中，我使用该`xmlValue`函数（在 XML 包中）来提取文本，但无论`&nbsp;`单词之间有空格的地方都被消除了。例如：

```
<span class="ft6">kids,&nbsp;and kids in your community,&nbsp;in                                   DIY&nbsp;projects.&nbsp;</span> 
```

将从`xmlValue`功能中出来：

```
"kids,and kids in your community,in DIYprojects." 
```

我在想解决这个问题的最简单方法是`&nbsp;`在运行`span`节点之前找到所有节点`xmlValue`，然后用`" "`（空格）替换它们。我将如何处理？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-15T00:23:10.843

我已经重写了答案，以反映原始海报无法从`XMLValue`. 可能有不同的方法来解决这个问题，但一种方法是直接打开/替换/写入 HTML 文件本身。通常使用正则表达式处理 XML/HTML 是一个坏主意，但在这种情况下，我们有一个直接的问题，即不需要的不间断空格，所以这可能不是太大的问题。以下代码是如何创建匹配文件列表`gsub`并对内容执行 a 的示例。它应该很容易根据需要进行修改或扩展。

```
setwd("c:/test/")
# Create 'html' file to use with test
txt <- "<span class=ft6>kids,&nbsp;and kids in your community,&nbsp;in                                   DIY&nbsp;projects.&nbsp;</span>
<span class=ft6>kids,&nbsp;and kids in your community,&nbsp;in                                   DIY&nbsp;projects.&nbsp;</span>
<span class=ft6>kids,&nbsp;and kids in your community,&nbsp;in                                   DIY&nbsp;projects.&nbsp;</span>"
writeLines(txt, "file1.html")

# Now read files - in this case only one
html.files <- list.files(pattern = ".html")
html.files

# Loop through the list of files
retval <- lapply(html.files, function(x) {
          in.lines <- readLines(x, n = -1)
          # Replace non-breaking space with space
          out.lines <- gsub("&nbsp;"," ", in.lines)
          # Write out the corrected lines to a new file
          writeLines(out.lines, paste("new_", x, sep = ""))
}) 
```

# ruby - 如何使用 WITH 和 OR 进行 Sequel 查询链接

> ID：14329150
> 
> 赞同：0
> 
> 时间：2013-01-15T00:15:30.280
> 
> 标签：ruby, sequel

我正在尝试在 Sequel 中构建一个查询，这给我带来了一些麻烦。

基本上我有几个哈希，每个都包含几个条件。每个散列中的条件需要在它们自身内部进行 AND 运算，并在每组条件内部进行 OR 运算。

例如：

```
conditions = [
  { :id => 123, :published => true },
  { :id => 456, :published => false }
] 
```

应该生成：

```
SELECT * FROM item WHERE ((id = 123 AND published = true) OR (id = 456 AND published = false)) 
```

我有：

```
conditions.each do |condition|
  query = query.where(condition)
end 
```

这将把所有东西都放在一起，所以：

```
conditions.each do |condition|
  query = query.or(condition)
end 
```

引发错误，因为 OR 在查询中需要多个条件。除了将第一个条件放入 a`where`并将其余的放入 a之外`or`，这有点难看：

```
query.where(condition.first)
conditions[1..-1].each do |condition|
  query = query.or(condition)
end 
```

有更好的方法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-16T05:37:52.807

最简单的做法是将单个查询的结果收集到一个数组中，这与在一个查询中将所有 AND 子句进行 OR-ing 相同：

```
results = conditions.map{|c| query.where(c).all}.flatten 
```

# c# - 使用“CreateViewAccessor.Read”和“Write”

> ID：14329153
> 
> 赞同：1
> 
> 时间：2013-01-15T00:15:42.077
> 
> 标签：c#, memory-mapped-files

我正在尝试编写一种十六进制编辑器（用于编辑 Playstation 1 ISO），但我不确定如何使用`CreateViewAccessor.Read`和`Write`. 具体来说，我不知道第二个参数使用什么，`out T structure`. 到目前为止，这是我的代码：

```
long offset = 0x0064773C;
long length = 0x02;

// Create the memory-mapped file.
using (var mmf =
    MemoryMappedFile.CreateFromFile(strFileName, FileMode.Open, "ISO"))
{
    using (var accessor = mmf.CreateViewAccessor(offset, length))
    {
        for (long i = 0; i < length; i++)
        {
            accessor.Read(i, out ???);
        }
    }
} 
```

我从来没有真正理解过`out`关键字，所以我不知道在那里做什么......

如果有人看到我之前的帖子，我决定使用 C# 和 VS 而不是 C++ 和 Qt。我比 C++ 更了解 C#。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-15T01:58:34.097

该`Read<>`方法用于从映射中读取任何结构。这里有两个等价的例子——一个使用内置`ReadByte`方法，另一个使用泛型`Read<>`方法：

```
bytes[i] = accessor.ReadByte(i);
accessor.Read<byte>(i, out bytes[i]); 
```

通常，`out`意味着调用方法提供数据作为输出。

# asp.net-mvc - KendoUI：foreach 循环中的多个网格 (MVC)

> ID：14329155
> 
> 赞同：0
> 
> 时间：2013-01-15T00:15:50.810
> 
> 标签：asp.net-mvc, asp.net-mvc-4, kendo-ui

使用 KendoUI，MVC4。

我需要显示一些网格，但是当我尝试这个时，它什么也不渲染：

```
@foreach (TheItem item in Model)
{
    Html.Kendo().Grid(item.DisplayList)
    .Name(item.GetHashCode().ToString())
    .Columns(columns =>
        {
            columns.Bound(p => p.Name).Title("Status");
            columns.Bound(p => p.Value).Title(" ");
        });    
} 
```

当我尝试只使用一个实体时，它工作正常：

```
 @(Html.Kendo().Grid(Model[0].DisplayList) 
    .Name("ItemGrid")
    .Columns(columns =>
        {
            columns.Bound(p => p.Name).Title("Status");
            columns.Bound(p => p.Value).Title(" ");
        })) 
```

有没有让许多网格被渲染的技巧？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-15T01:00:55.740

您缺少围绕 Grid 声明的**@()剃刀运算符。**没有它，您不会向输出呈现任何内容。

要么使用**@()**运算符，要么调用 Widget 的**Render()**方法。

# c# - 静态变量声明的时机

> ID：14329162
> 
> 赞同：0
> 
> 时间：2013-01-15T00:16:27.417
> 
> 标签：c#, c#-4.0

在 C# 4.0 及更高版本中，在创建类的静态变量（即分配的内存）时（在任何可能的编译器中）是否（严格）定义？我可以确定在进入任何已创建实例的构造函数之前，已经分配了该类的静态变量吗？

请看下面的例子：

```
class X
{
static Vector2 v = new Vector2();

public X()
  {
  v.Set(1,1); // Can I be sure that memory for v is allocated here ? Always ??
  }
} 
```

这被认为是良好的编程习惯吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-15T00:21:02.273

是的，您可以确定这一点。你可以参考[这个](http://msdn.microsoft.com/en-us/library/k9x6w0hc%28v=vs.110%29.aspx)链接。不过，我看不到以这种方式设置该向量的目的。也许您更喜欢静态构造函数，例如：

```
static X()
{
   v.Set(1, 1);
} 
```

# c# - 如何提供要在函数中使用的字段？

> ID：14329164
> 
> 赞同：1
> 
> 时间：2013-01-15T00:16:36.960
> 
> 标签：c#, .net, lambda

像 Linq 的 OrderBy 这样的东西，你可以在其中指定它应该用来进行排序的键。

具体来说，在我的例子中，我有一个等效于具有两个 bool 属性的结构，一个 .IsNice 和另一个 .IsPretty; 然后我希望能够执行一个函数，返回一个实例是漂亮还是漂亮。

我可以做两个功能，

```
 bool itIsPretty (ExampleStruct toVerify);
    bool itIsNice (ExampleStruct toVerify); 
```

然而，两者本质上是一样的！两者都无非是返回验证。（IsPretty / IsNice），我不想有复制和粘贴的功能。

另一种选择是进行以下操作：

```
 bool isItNiceOrPretty (ExampleStruct toVerify, bool checkForNiceness)
    {
        if (checkForNiceness) return toVerify.IsNice;
        else return toVerify.IsPretty;
    } 
```

但是，如果不止这两种类型呢？好吧，我可以将此布尔参数转换为整数或字符串，但随后我需要保留一个包含所有键值及其各自字段的表......这有可能导致混乱和反直觉我添加和/或删除示例结构的字段，我什至不想再考虑它了。

那么，有没有办法按照我的想法来创建这样一个灵活的功能？还是我必须坚持可怕的 Ctrl+C Ctrl+V？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-15T00:20:52.470

你可以传入一个`Func<ExampleStruct,bool>`：

```
bool DoSomething(ExampleStruct value, Func<ExampleStruct,bool> predicate)
{
    if (predicate(value))
    {
       // Do your thing
    }
} 
```

然后您可以通过以下方式调用它：

```
bool result = DoSomething(toVerify, v => v.IsNice); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-15T00:27:13.050

您可以使用枚举器作为第二个参数：

```
public enum CheckType
{
    Nice,
    Pretty,
    // And so on...
}

public Boolean IsWhat(ExampleStruct struct, CheckType type)
{
    switch (type)
    {
        case CheckType.Pretty: 
           return toVerify.IsPretty;

         // And so on...
    }    
} 
```

如果你有不同的结构，你可以实现一个通用接口：

```
public interface ILook
{
    Boolean IsNice { get; }
    Boolean IsPretty { get; }
}

public struct ExampleStructA : ILook { }

public Boolean IsWhat(ILook tiVerify, CheckType type)
{
    switch (type)
    {
        case CheckType.Pretty: 
           return toVerify.IsPretty;

         // And so on...
    }    
} 
```

或者您可以使用带有谓词的通用函数。

# ios - 为什么我的 NSString 不适合使用我的 NSString 宽度创建的框架？

> ID：14329166
> 
> 赞同：1
> 
> 时间：2013-01-15T00:16:49.187
> 
> 标签：ios, objective-c, uitextview

在我看来，我正在处理的代码应该是这样写的：

```
 if (!instructions)
{
    instructions = [[UITextView alloc] init];
    instructions.backgroundColor=[UIColor clearColor];
    instructions.font = [UIFont fontWithName:@"Helvetica Neue" size:12];
    instructions.editable=NO;
    instructions.text = @"\nFor millennia, the Japanese haiku has allowed great\nthinkers to express their ideas about the world in three\nlines of five, seven, and five syllables respectively.";

//THIS IS THE RELEVANT LINE:
    NSString *t = @"thinkers to express their ideas about the world in three"; //Using this to set width since it's the longest line of the string.

    CGSize thisSize = [t sizeWithFont:[UIFont fontWithName:@"Helvetica Neue" size:12]];
    float textWidth = thisSize.width;
    const int INSTRUCTIONS_HEIGHT=10; //I know this is an ugly hack.
    float textHeight = thisSize.height*INSTRUCTIONS_HEIGHT;
    instructions.frame = CGRectMake(screenWidth/2-textWidth/2, screenHeight/2-textHeight/2, textWidth, textHeight);
} 
```

但输出看起来像这样，行必须环绕：

![在此处输入图像描述](../Images/feb6a954d060ae96174e844947b13d01.png)

当我调整代码以在设置宽度的行中添加一些字符时：

```
 {
    instructions = [[UITextView alloc] init];
    instructions.backgroundColor=[UIColor clearColor];
    instructions.font = [UIFont fontWithName:@"Helvetica Neue" size:12];
    instructions.editable=NO;
    instructions.text = @"\nFor millennia, the Japanese haiku has allowed great\nthinkers to express their ideas about the world in three\nlines of five, seven, and five syllables respectively.";

//THIS IS THE LINE I CHANGED:
    NSString *t = @"thinkers to express their ideas about the world in three lin"; //

    CGSize thisSize = [t sizeWithFont:[UIFont fontWithName:@"Helvetica Neue" size:12]];
    float textWidth = thisSize.width;
    const int INSTRUCTIONS_HEIGHT=6; //Since there's no wraparound here I could reduce this number.
    float textHeight = thisSize.height*INSTRUCTIONS_HEIGHT;
    instructions.frame = CGRectMake(screenWidth/2-textWidth/2, screenHeight/2-textHeight/2, textWidth, textHeight);
} 
```

输出看起来像我想要的：

![在此处输入图像描述](../Images/c555dade73cbe03b8aebaa3d68f6f773.png)

为什么“思想家在三个方面表达他们对世界的想法”这一行不适合设置在“思想家在三个方面表达他们对世界的想法”这一行宽度处的文本视图？

（显然，我需要学习如何在屏幕上定位事物。例如，我还没有弄清楚“中心”，我怀疑这会解决我的很多问题。但这就是我正在使用的现在，我很好奇。）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-15T00:23:20.370

UITextView 默认有一些填充。如果你愿意，你可以摆脱它：[如何在 UITextView 中丢失边距/填充？](https://stackoverflow.com/questions/746670/how-to-lose-margin-padding-in-uitextview)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-15T00:23:53.070

您需要将 sizeWithFont 限制为文本视图的宽度。

就像是：

```
drawnSize = [t sizeWithFont:[UIFont fontWithName:@"Helvetica Neue" size:12]
                 constrainedToSize:CGSizeMake(instructions.frame.size.width, 3000)
                 lineBreakMode:NSLineBreakByWordWrapping ] ; 
```

您可能还需要从文本视图中获取插图并从宽度中减去它们：

```
UIEdgeInsets edgeInsets = instructions.contentInset;
CGFloat totalwidth = instructions.frame.size.width - edgeInsets.left - edgeInsets.right; 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-01-15T00:23:56.470

一个原因是您正在使用文本视图。你所做的对 UILabel 来说很好。并且标签可能有多行。因此，如果您真的不需要文本视图来滚动文本，那么请考虑使用标签。

我不记得确切的值。但是对于文本视图，请考虑一些模糊昆虫值，其中文本本身的实际宽度/空间小于文本视图。

# java - Java String.format() 是否存在内存泄漏

> ID：14329171
> 
> 赞同：1
> 
> 时间：2013-01-15T00:17:37.343
> 
> 标签：java, memory, memory-leaks, string.format

我在while循环中有这个语句，我注意到在windows任务管理器中，java应用进程使用的内存不断增加，大约每秒几k。String.format 是否存在内存问题？

```
String str = String.format("%dDays %02d : %02d : %02d",days,hours,minutes,seconds); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-15T00:21:19.433

如果之后你没有`str`在任何地方使用，那只是垃圾收集器没有运行，所以应该释放的内存还没有被收集。这可能是因为 Java 不需要它（因为它还有一些保留页面），但由于运行垃圾收集器是一项昂贵的任务，Java 在开始回收内存之前必须使用一定数量的内存。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-15T00:37:09.947

如果您执行以下操作应该会有所帮助：

```
String days = "Monday";
String hours = "10:00pm";
String minutes = "60";
String seconds = "01";

while(condition){
     String str = String.format("%dDays %02d : %02d : %02d",days,hours,minutes,seconds);
} 
```

这将传递对字符串的引用，而不是为循环中每次迭代的每个字符串占用 32 位。如果您无法确定循环中的字符串，请尝试切换到字符或字节（如果可能），这将减少您使用的内存量。

如果你想强制垃圾收集器运行（非常不安全）看这里

```
http://stackoverflow.com/questions/1481178/forcing-garbage-collection-in-java 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-15T00:21:40.213

我将假设您不保留对您创建的字符串的引用。

基本上，该调用每次运行时都会创建一个新对象。这些对象保留在内存中，直到 Java 虚拟机决定执行垃圾回收。JVM 在确定有必要之前不会这样做。必要的通常是当您的内存使用量超过某个阈值时。该阈值将取决于您的机器和启动 JVM 的设置。

# linux - 为什么我的 perl 系统命令不起作用？

> ID：14329173
> 
> 赞同：1
> 
> 时间：2013-01-15T00:17:41.663
> 
> 标签：linux, perl

这是我将结果移动到已发送文件夹的 perl 代码。

```
 system("mv /home/pi/downloads/$result /home/pi/downloads/sent/$result"); 
```

我得到的错误是：

```
mv: missing destination file operand after `/home/pi/downloads/filename.txt' 
```

我在这里做错了什么？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-01-15T00:29:46.053

很可能`$result`包含一个换行符，它会提前终止命令。用于`chomp`丢弃额外的换行符。

如果`$result`来自用户输入并且没有被压缩，则几乎可以肯定有一个换行符。而且，根据您的程序的受众，您现在遇到了恶意代码注入问题。

为了避免注入问题，使用`rename`函数将文件移动到目的地怎么样？

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-01-15T00:25:29.110

这很难说，但你可以做一些事情来帮助你解决它。

首先确保你的脚本是这样开始的：

```
#!/pathe/to/perl -w

use strict; 
```

注意 -w 以启用警告。还将`use strict`帮助您识别代码问题。

另一件很有帮助的事情是将要运行的命令存储在标量中并打印它以查看它实际在做什么：

```
my $result = "filename.txt";
chomp($result);
my $cmd = sprintf("mv /home/pi/downloads/%s /home/pi/downloads/sent/%s", $result, $result);
print "$cmd\n";
system($cmd); 
```

在您的脚本中，您是否从用户输入中获得 $result 的值？我觉得它有一个换行符。chomp 函数将安全地从字符串末尾删除换行符。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-01-15T02:35:09.527

`system()`虽然您可以使用or调用外部程序为您做某事`qx{}`，但 Perl 非常强大且用途广泛，对于许多常见操作，只需使用 Perl 本身（或其众多模块）即可完成，而无需使用任何外部工具。如果外部程序出现任何问题，它会更快更可靠。例如，如果外部可执行文件有错误并且在紧密循环中旋转，`system()`则可能永远不会返回，从而冻结您的脚本。

在您的情况下，此 Perl 代码工作得更好并处理错误：

```
use File::Copy;

unless (move ("/home/pi/downloads/$result",
              "/home/pi/downloads/sent/$result"))
{
    print "Rename has failed!\n";
    # ...
} 
```

（当然，在运行它之前，您应该确保它`$result`不包含换行符。）

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-01-15T00:30:42.450

检查两者`$result`和目录本身：

*   确保其中`$result`没有**斜杠**（除非您期望子目录）
*   确保其中`$result`没有**空格**，因为该命令不使用引号
*   确保`$result`不为空

对于目录：

*   确保`/home/pi/downloads`存在并且是一个目录
*   确保`/home/pi/downloads/sent`存在并且是一个目录
*   确保`/home/pi/downloads`具有可写权限
*   确保`/home/pi/downloads/sent`具有可写权限

# kivy - Kivy 按钮循环绑定 on_press 以回调

> ID：14329174
> 
> 赞同：2
> 
> 时间：2013-01-15T00:17:43.277
> 
> 标签：kivy

所以我在 kivy 用户支持（谷歌群组）上问过这个问题，但还没有得到任何答复，所以我会在这里尝试。

我有一组基于搜索工具创建的按钮。基本上它的工作方式是用户在文本输入框中输入搜索词，并根据输入文本，我的程序在数据库中搜索匹配的结果。如果有任何匹配的结果，就会创建按钮（将其文本作为匹配结果的文本），这非常有效。但我的问题是，当在循环中创建按钮时，如何将它们各自的 on_press 分配给回调？例如在我的例子中，代码看起来像这样：

在我的 .kv 文件中，我有 textinput 小部件：

```
<my rule>:
    ti: Ti
    TextInput:
        id: Ti
    on_text: root.function() 
```

在我的 .py 文件中，我有以下内容（加上一些其他代码）：

```
t1 = ObjectProperty()
function():
    layout = StackLayout(orientation = 'lr-tb', size_hint = (0.3, 0.8), pos_hint =   {'top' : 0.87})

    root.clear_widgets() #added this so that upon user input (i.e. on_text event of textinput) only matching results create new buttons

    list_1 = ['a', 'b', 'c'] #this is a list of matching results
    root.add_widget(layout)

    for item in list_1: #this is the loop which creates the buttons
        buttons = Button(text = str(item), size_hint = (1, 0.1), background_color = [255, 0, 0, 1])
        buttons.bind(on_press = self.t1.insert_text(str(item)))                   
        layout.add_widget(buttons) 
```

分配给回调的 on_press（如上所示）实际上不起作用。它应该完成的是，当用户按下该按钮时，textinput 小部件（self.ti1）中的文本应该更改为按钮文本（即按钮作为自动填充小部件工作）。我究竟做错了什么？请注意，以上只是部分代码。主要代码的结构应该是这样，唯一的问题在于上面的代码片段。
谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-16T16:09:14.823

将**事件**类型或**属性**[绑定](http://kivy.org/docs/api-kivy.event.html#kivy.event.EventDispatcher.bind)到***回调***

```
self.bind(x=my_x_callback, width=my_width_callback,...) 
```

所以`x`应该是[事件](http://kivy.org/docs/api-kivy.event.html?highlight=event#kivy.event)或[属性](http://kivy.org/docs/gettingstarted/index.html#doc-properties)，并且`my_x_callback`需要是对[回调/方法的引用](https://stackoverflow.com/questions/3786881/what-is-a-method-in-python)

my_method() 和 my_method 有什么区别？

让我们在控制台上执行此操作，考虑`what_up`以下代码中的方法：

```
python<enter>
Python 2.7.3 (default, Sep 26 2012, 21:51:14) 
[GCC 4.7.2] on linux2
Type "help", "copyright", "credits" or "license" for more information.
>>> def what_up():
...     return 'nothing man, same old stuff' 
... 
>>> print what_up
<function what_up at 0x7f8df8a76a28>
>>> print what_up()
nothing man, same old stuff 
```

从上面的结果可以看出，如果`what_up`直接打印，则会得到该方法的引用，另一方面，如果调用该方法`what_up()`，则会得到函数返回的任何内容，如果没有返回任何内容，则返回 None。

您可以将函数的引用传递给任何变量，例如 ::

```
>>>my_up = what_up
>>> my_up()
'nothing man, same old stuff'
>>> 
```

在您的代码中::

```
buttons.bind(on_press = self.t1.insert_text(str(item))) 
```

您正在调用该函数

```
on_press = self.t1.insert_text(str(item)) 
```

而不是传递函数

```
on_press = partial(self.t1.insert_text, str(item)) 
```

`from functools import partial`提前打电话

# mongodb - 防止 Mongo 的 Spring Data 将 id 转换为 ObjectId

> ID：14329175
> 
> 赞同：7
> 
> 时间：2013-01-15T00:17:45.017
> 
> 标签：mongodb, spring-data-mongodb

我在现有数据库上使用 Spring Data for Mongo。之前的应用程序使用纯字符串作为 id 而不是 ObjectId。

我的问题是 Spring Data 坚持将字符串转换为 ObjectId，这使得所有按 id 的查询都失败了。

例如，当我这样做时`repository.findOne('')`，执行的查询`{ "_id" : { "$oid" : "50cf9f34458cf91108ceb2b4"}}`应该是`{ "_id" : "50cf9f34458cf91108ceb2b4" }`

有没有办法避免 Spring Data 将字符串 id 转换为 ObjectId？

谢谢！

迭戈

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-15T03:10:47.803

我终于找到了解决方案。可能不是最好的选择，但有效。

我所做的是将转换器从使用`String`中删除。这样，我创建了以下 Mongo 转换器：`ObjectId``MongoTemplate``QueryMapper`

```
public class CustomMongoConverter extends MappingMongoConverter {
    public CustomMongoConverter(MongoDbFactory mongoDbFactory, MappingContext<? extends MongoPersistentEntity<?>, MongoPersistentProperty> mappingContext) {
        super(mongoDbFactory, mappingContext);
        conversionService.addConverter(new Converter<String, ObjectId>() {
            @Override
            public ObjectId convert(String source) {
                throw new RuntimeException();
            }
        });
    }
} 
```

然后，我将转换器的实现传递给`MongoTemplate`：

```
<bean id="mongoConverter" class="com.abcompany.model.repositories.utils.CustomMongoConverter">
    <constructor-arg ref="mongoDbFactory"/>
    <constructor-arg>
        <bean class="org.springframework.data.mongodb.core.mapping.MongoMappingContext"/>
    </constructor-arg>
</bean>

<bean class="org.springframework.data.mongodb.core.MongoTemplate" id="mongoTemplate">
    <constructor-arg ref="mongoDbFactory"/>
    <constructor-arg ref="mongoConverter"/>
</bean> 
```

这样，当尝试从 String 转换为 ObjectId 时，它会引发异常并且不会执行此操作。请注意，您可能只需从`conversionService`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2017-06-06T12:14:16.740

我遇到了同样的问题，我的解决方案如下：

```
 @Bean
  public MappingMongoConverter mappingMongoConverter(MongoDbFactory factory, MongoMappingContext context, CustomConversions conversions) {
    MappingMongoConverter converter = new MappingMongoConverter(new DefaultDbRefResolver(factory), context) {
      @Override
      public void afterPropertiesSet() {
        conversions.registerConvertersIn(conversionService);
      }
    };
    converter.setCustomConversions(conversions);
    return converter;
  } 
```

这个想法是为了防止默认转换器注册。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2020-07-10T21:04:08.147

现在只需覆盖 MappingMongoConverter 中的 convertId 方法即可。

默认在这里[https://github.com/spring-projects/spring-data-mongodb/blob/master/spring-data-mongodb/src/main/java/org/springframework/data/mongodb/core/convert/MongoConverter。爪哇#L128](https://github.com/spring-projects/spring-data-mongodb/blob/master/spring-data-mongodb/src/main/java/org/springframework/data/mongodb/core/convert/MongoConverter.java#L128)。正如我们所见，conversionService 并没有那么大的帮助。

这是我的配置的一部分（我的集合中根本不需要字符串中的 ObjectId）：

```
@Configuration
public class MongoCommonConfig extends AbstractMongoClientConfiguration {
    ...
    @Bean
    @Primary
    public MongoTemplate mongoTemplate(MongoDbFactory dbFactory, 
        MappingMongoConverter mappingMongoConverter) {
        return new MongoTemplate(dbFactory, mappingMongoConverter);
    }

    @Bean
    @Primary
    @Override
    public @NotNull MappingMongoConverter mappingMongoConverter() throws Exception {
        DbRefResolver dbRefResolver = new DefaultDbRefResolver(mongoDbFactory());
        MappingMongoConverter converter = new MappingMongoConverter(dbRefResolver, mongoMappingContext()) {
            @Override
            public Object convertId(Object id, @NotNull Class<?> targetType) {
                return id;
            }
        };
        converter.setCustomConversions(customConversions());
        converter.setCodecRegistryProvider(mongoDbFactory());

        return converter;
    }
    ...
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2020-11-30T08:15:21.673

我找到了一种更简单的方法来处理相同的[serhii](https://stackoverflow.com/users/3215626/serhii) 方法，您只需`convertId`在`MobileMappingMongoConverter`类中覆盖方法，您会在这篇[文章](https://stackoverflow.com/a/65069850/5726051)中找到它。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2022-02-16T18:00:54.160

您可以使用字段注释。

```
import org.springframework.data.mongodb.core.mapping.Field;
import org.springframework.data.mongodb.core.mapping.FieldType;
import org.springframework.data.mongodb.core.mapping.Document;

@Document    
public class Dog{
@Id
@Field(targetType = FieldType.STRING)
String myId;
...
} 
```

# python - Python 循环：额外打印？

> ID：14329176
> 
> 赞同：2
> 
> 时间：2013-01-15T00:17:58.063
> 
> 标签：python, function, loops, printing, for-loop

我在 Python Programming: An Intro to Comp Sci 中做书后练习：

```
for i in [1,3,5,7,9]:
    print(i, ":", i**3)
print(i) 
```

这打印出来

```
1:1
3:27
5:125
7:343
9:729
9 
```

我的问题是为什么它打印额外的 9？最后一个循环打印不是 9:729 吗？它必须与

```
print(i, ":", i**3) 
```

因为如果我只是输入：

```
for i in [1,3,5,7,9]:
   print(i) 
```

它只是打印

```
1
3
5
7
9 
```

在此先感谢，因为我没有其他人可以帮助我！:)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-15T00:28:19.547

在 python for 循环中，循环的“主体”是缩进的。

所以，在你的情况下，`print(i, ":", i**3)`是“身体”。它将打印`i, ":", i**3`的每个值`i`，从 1 开始到 9 结束。

随着循环的执行，它会将 的值更改为`i`列表中的下一项。

一旦循环终止，它会继续执行下一行代码，这完全独立于 for 循环。因此，在 for 循环之后有一个命令，即`print(i)`. 由于`i`上次设置为 9，因此该命令基本上意味着`print(9)`.

你想要的是：

```
for i in [1,3,5,7,9]:
    print(i, ":", i**3) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-15T00:20:39.610

最后一行的 print(i) ...........

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-15T00:21:13.950

分配给的最后一个值`i`是 9，因此您的最后一行是指在循环中发生的这个值分配。虽然`9:729`是打印的最后一件事，但它不是最后一个作业。

**编辑：**

> 为什么不打印这样的内容：1:1 1 3:27 3 5:125 5 7:343 7 9:729 9？

如果您的代码缩进并看起来像这样，它将打印出来：

```
for i in [1,3,5,7,9]:
    print(i, ":", i**3)
    print(i) 
```

最后一行缺少缩进导致它落在 for 循环之外。

# sql - 将带引号的字符串传递给存储过程中的函数

> ID：14329177
> 
> 赞同：0
> 
> 时间：2013-01-15T00:18:01.340
> 
> 标签：sql, sql-server, tsql, stored-procedures

我有这个功能：

```
SET ANSI_NULLS OFF
GO
SET QUOTED_IDENTIFIER OFF
GO
ALTER FUNCTION [dbo].[SE_VALOR] (@valor int, @verd char(20), @fals char(20))
RETURNS char(20)
AS
BEGIN
DECLARE @resposta char(20)
    ---Check for unit, if meters(MT), convert it to feet(FT)
    IF @valor=1
        BEGIN
            set @resposta = @verd
        END
    ELSE
        BEGIN
            set @resposta =@fals
    END
RETURN( @resposta   )
END 
```

然后我有这个存储过程：

```
SET ANSI_NULLS OFF
GO
SET QUOTED_IDENTIFIER OFF
GO
ALTER PROCEDURE [dbo].[SP_pn_FichaTecnica_Motor_Web]
@IDVersao int

AS

DECLARE @Comando nvarchar(4000)
DECLARE @DIESEL varchar(10)
DECLARE @GASOLINA varchar(10)

SET @DIESEL = 'Diesel'
SET @GASOLINA = 'Gasolina'

--

set @Comando = 'SELECT somefield1, somefield2, somefield3,
                dbo.SE_VALOR(TblMotor.TipoInjeccao,@DIESEL,@GASOLINA) AS TipoInjeccao
                FROM sometable
                WHERE IDVersao = @IDVersao'

EXEC sp_executesql @Comando, N'@IDVersao int, @DIESEL varchar(10),@GASOLINA varchar(10)',@IDVersao,@DIESEL,@GASOLINA
print(@Comando) 
```

如何通过变量@DIESEL 和@GASOLINA 而不给我错误？

如果我尝试使用以下命令执行 SP：

```
exec SP_pn_FichaTecnica_Motor_Web 27828 
```

我得到：

> 消息 102，级别 15，状态 1，第 32 行附近的语法不正确

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-15T00:56:01.993

我想我遇到了你的问题，你想将常量作为常量传递，而不是作为参数传递。在这种情况下：

```
set @Comando = 'SELECT somefield1, somefield2, somefield3,
            dbo.SE_VALOR(TblMotor.TipoInjeccao,''Diesel'',''Gasolina'') AS TipoInjeccao
            FROM sometable
            WHERE IDVersao = @IDVersao'

EXEC sp_executesql @Comando, N'@IDVersao int',@IDVersao 
```

换句话说，您只需要将单引号加倍。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-15T22:59:08.280

感谢你的帮助。我将有用的答案分配给@Naomi，因为双引号有效。但真正的问题是 var @Comando 的大小。我把它定义为：

```
DECLARE @Comando nvarchar(4000) 
```

但意识到查询超出了此值，因此将其更改为：

```
DECLARE @Comando nvarchar(max) 
```

解决了我的问题。

希望这对其他人有所帮助。:)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-15T00:41:36.467

您得到的确切错误是什么（完全错误）？乍一看，您的代码是可以的（除了错误地为您自己的存储过程使用 sp_ 前缀 - 这个前缀是为系统存储过程保留的，您应该尝试使用其他任何东西，例如，没有 _ 的 sp）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-15T00:50:43.000

对于输入参数，您可以直接将它们放在查询中，但您可能希望`'`通过将其替换为来转义字符`''`。

你的 SP 的输出应该是输出参数，例如：

```
SET @DIESEL = (REPLACE (@DIESEL, '''', ''''''))
SET @GASOLINA = (REPLACE (@GASOLINA, '''', ''''''))
SET @IDVersao = (REPLACE (@IDVersao, '''', ''''''))

set @Comando = 'SELECT @myOutput = 
            dbo.SE_VALOR(TblMotor.TipoInjeccao,'+@DIESEL+','+@GASOLINA+') AS TipoInjeccao
            FROM sometable
            WHERE IDVersao = '+@IDVersao+''

EXEC sp_executesql @Comando, N'@myOutput CHAR(20) OUTPUT', @myOutput OUTPUT 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-01-15T05:24:29.020

```
set @Comando = 'SELECT somefield1, somefield2, somefield3,
                dbo.SE_VALOR(TblMotor.TipoInjeccao,@DIESEL,@GASOLINA) AS TipoInjeccao
                FROM sometable
                WHERE IDVersao = @IDVersao' 
```

将其更改为

```
SET QUOTED_IDENTIFIER OFF
set @Comando = "SELECT somefield1, somefield2, somefield3,
                dbo.SE_VALOR(TblMotor.TipoInjeccao,@DIESEL,@GASOLINA) AS TipoInjeccao
                FROM sometable
                WHERE IDVersao = @IDVersao"
SET QUOTED_IDENTIFIER ON 
```

# awk - 如何仅在awk中打 印带有数字的某些列

> ID：14329185
> 
> 赞同：0
> 
> 时间：2013-01-15T00:18:43.017
> 
> 标签：awk

我有一个文本文件，其中每行包含不同数量的列。

如果该行的第 3、4 和 5 列仅包含数字，我只想打印这些行。

诀窍是有时第 3、4 和 5 列会嵌入一个特殊字符“（”或“）”，我也想打印这些数字。

```
cat $filename | awk '{ if ( ($3 != "^[0-9]") && ($4 != "^[0-9]") && ($5 != "^[0-9]") ) print $2, $3, $4, $5 }' >>text.dat 
```

但它也打印诸如：Au2、Cu2 等。

有什么建议么？

更新：

输入文本文件的相关部分如下所示：

```
Cu1 Cu 0.00000 0.094635(14) 0.094635(14)
Cu2 Cu 0.00000 0.125943(15) 0.125943(15)
.
.
. 
```

我想要的是以下内容：

```
Cu 0.00000 0.094635 0.094635
Cu 0.00000 0.125943 0.125943
.
.
. 
```

请注意，“Cu”来自原始输入文件第二列中的字符串，我已经去掉了第 4 列和第 5 列中的数字和括号。另请注意，括号也可能存在于第 3 列中。括号中的数字可以是个位数。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-15T00:27:55.177

在您的代码中：

```
 ($3 != "^[0-9]") && ($4 != "^[0-9]") && ($5 != "^[0-9]") 
```

`!=`意味着`not equal to`它不进行正则表达式匹配测试。

尝试`$3~/[0-9]+/ && $4~/[0-9]+/`等等

对于`(`or`)`问题，您可以做的是，在检查 $2 $3 $4 上的正则表达式匹配之前，将`( or )`这些字段中的所有内容替换为`""`然后进行匹配测试。

我希望上面的解释足够清楚。

**编辑**

```
awk '{for(i=3;i<=5;i++)gsub(/\([^\)]*\)/,"",$i)}$3~/[0-9\.]*/&&$4~/[0-9\.]*/&&$5~/[0-9\.]*/' file 
```

上面的这一行是：

*   从 $3,$4, $5 中移除 (...)
*   检查 $3、$4、$5 是否为数字（或小数）。
*   如果是，打印行

用你的例子：

```
kent$  echo "Cu1 Cu 0.00000 0.094635(14) 0.094635(14)
Cu2 Cu 0.00000 0.125943(15) 0.125943(15)"|awk '{for(i=3;i<=5;i++)gsub(/\([^\)]*\)/,"",$i)}$3~/[0-9\.]*/&&$4~/[0-9\.]*/&&$5~/[0-9\.]*/'                                               
Cu1 Cu 0.00000 0.094635 0.094635
Cu2 Cu 0.00000 0.125943 0.125943 
```

只有 2 美元、3 美元、4 美元、5 美元：

```
awk '{for(i=3;i<=5;i++)gsub(/\([^\)]*\)/,"",$i);if($3~/[0-9\.]*/&&$4~/[0-9\.]*/&&$5~/[0-9\.]*/)print $2,$3,$4,$5}' file 
```

# linux - UNIX lseek/读/写行为

> ID：14329187
> 
> 赞同：1
> 
> 时间：2013-01-15T00:18:50.193
> 
> 标签：linux, unix, file-io, seek

如果我有一个大小为 5 的文件，我使用 lseek 寻找位置 10，然后使用 read 从该位置读取 1 个字节，read 系统调用的返回值为 0。我想知道 lseek/read/ 的返回值在以下情况下写入：如果我寻求超过文件系统允许的最大文件大小，然后执行读取。我们可以寻求这个位置/这是一个错误吗？如果不是，如果我在这里读取，读取的返回值是什么？0 还是 -1？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-15T00:36:14.247

允许您将位置设置在文件末尾之外的状态的[POSIX 规范：`lseek()`](http://pubs.opengroup.org/onlinepubs/009695399/functions/lseek.html)

> lseek() 函数应允许将文件偏移量设置为超出文件中现有数据的末尾。

如果结果位置超出`off_t`从返回的变量类型的范围，它只会抱怨`lseek()`。似乎没有指定错误消息来指示“超出您的进程特定限制”或“超出文件系统本身的容量”之类的内容。

* * *

[但是，再次根据 POSIX](http://pubs.opengroup.org/onlinepubs/009695399/functions/write.html) ，在使用 a 搜索之后尝试扩展文件`write()`可能会返回`EFBIG`错误代码。最好的办法是实际尝试一下，看看行为是什么，*特别是*因为 Linux 不一定在所有情况下都符合 POSIX - 换句话说，符合 POSIX 的 UNIX 系统和 Linux 之间的行为可能不同。

 ** * *

[POSIX`read()`规范](http://pubs.opengroup.org/onlinepubs/009695399/functions/read.html)对发生的事情非常坚定：

> 在当前文件结尾之后不会发生任何数据传输。如果起始位置在文件末尾或之后，则返回 0。

因此，您应该返回零，因为根据定义，如果您已经`lseek()`超出了文件系统的容量，那么您肯定会超出文件的末尾（您不能创建大于文件系统允许的文件）。*

# ruby-on-rails - 只比较时间，不比较日期？

> ID：14329198
> 
> 赞同：34
> 
> 时间：2013-01-15T00:20:25.370
> 
> 标签：ruby-on-rails, ruby

我需要编写一个方法来检查是否`Time.now`在商店的营业时间和关闭时间之间。

营业时间和关闭时间保存为时间对象，但我无法正确比较它，因为商店保存了营业时间，`2012/2/2`因此营业时间将类似于：

```
2012-02-02 02:30:00 UTC 
```

并且`Time.now`将是：

```
07:23 +0200 
```

我怎样才能比较没有日期部分的时间部分？

* * *

## 回答 #1

> 赞同：38
> 
> 时间：2014-01-24T13:58:29.530

您可以比较`Time`没有日期的部分，例如，如下所示：

```
time1.utc.strftime( "%H%M%S%N" ) <= time2.utc.strftime( "%H%M%S%N" ) 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2018-10-05T11:28:29.010

有一个不错的库[https://github.com/bokmann/business_time](https://github.com/bokmann/business_time)可以为您做这些以及更多。

```
BusinessTime::Config.with(beginning_of_workday: "8:30 am", end_of_workday: "5:30 pm") do
  Time.now.during_business_hours?
end 
```

它将为您做更多的事情，例如将时间滚动到下一个或上一个开放时间，计算两个时间戳之间的营业时间等。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2015-04-06T09:57:52.187

您可以只比较没有日期部分的rails中的时间，例如：---这`post_review`是表格，我们只得到这些记录，这些记录`post_review`在`created_at`任何日期的上午10点---下午5点之间

```
post_review.where("(created_at::time >= :start_time) AND (created_at::time <= :end_time)", 
    start_time: Time.parse("10 am").strftime("%r"),
    end_time:   Time.parse("5 pm").strftime("%r")
 ) 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2013-01-15T00:25:55.193

您可以将时间拆分为小时、分钟和秒。

如[时间类](http://www.ruby-doc.org/core-1.9.3/Time.html)中所述：

```
t = Time.now
hour = t.hour
minute = t.min
seconds = t.sec 
```

由于您只需要比较它是否在 2 小时内，您可以按如下方式进行检查。

```
if hour > openingHour and hour < closingHour 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2015-02-16T16:39:05.093

尝试将时间转换为数字并去掉天数。由于时间表示为自 UNIX 纪元以来的秒数，小数点是秒的小数部分，因此您可以将此数字转换为天数，小数部分是一天的小数部分。

基于日期的数字 = Ruby 时间数字 / 60 / 60 / 24

然后，您可以使用取模运算符去除日期部分，这样您就剩下要比较的就是时间了。所以你想要这样的东西：

```
def is_open?(time)
  open_h=Time.parse('2012-02-02 02:30:00 UTC')
  close_h=Time.parse('2012-02-02 10:00:00 UTC')
  (((time.to_r / 60 / 60 / 24) % 1) >= ((open_h.to_r / 60 / 60 / 24) % 1)) && (((time.to_r / 60 / 60 / 24) % 1) <= ((close_h.to_r / 60 / 60 / 24) % 1))
end

is_open? (Time.parse('2013-01-01 09:58:00 UTC'))
=> true
is_open? (Time.parse('2013-01-01 12:58:00 UTC'))
=> false 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2018-10-04T22:23:27.010

Instead of trying to compare the point of time directly, you can compare their offsets from a common reference (e.g. midnight). You might need to make sure all times are using the same time zone, depending on your use case.

In Rails, this can be done easily with one of the helpers such as `#seconds_since_midnight`:

```
#given
opening_hour = DateTime.new(2012,2,2,2,30,0)

#compare
now = DateTime.now.in_time_zone('UTC')
opening_hour_since_midnight = opening_hour.seconds_since_midnight
now_since_midnight = now.seconds_since_midnight
p 'shop opened' if now_since_midnight > opening_hour_since_midnight 
```

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2013-01-15T00:27:06.543

```
close_or_open_time_object.to_a.first(3).reverse <=> Time.now.to_a.first(3).reverse 
```

* * *

## 回答 #8

> 赞同：-6
> 
> 时间：2015-11-21T09:30:46.300

这仅适用于 24 小时格式且开始时间小于结束时间的时间。

```
Time start = DateUtil.convertStringToTime(Object.getStartTime());
Time mid = DateUtil.convertStringToTime(time);
Time end = DateUtil.convertStringToTime(Object.getEndTime());

    if(mid.getHours()>start.getHours() && mid.getHours()< end.getHours())
    {
        flag=true;
    }
    else if(mid.getHours() == start.getHours() && mid.getHours() < end.getHours())
    {
        if(mid.getMinutes() > start.getMinutes())
        {               
            flag=true;              
        }
        else if(mid.getMinutes() == start.getMinutes())
        {               
            if(mid.getSeconds() >= start.getSeconds())
            {
                flag=true;
            }
        }
    }
    else if(mid.getHours() > start.getHours() && mid.getHours() == end.getHours())
    {
        if(mid.getMinutes() < end.getMinutes())
        {
            flag=true;
        }
        else if(mid.getMinutes() == end.getMinutes())
        {
            if(mid.getSeconds() <= end.getSeconds())
            {
                flag=true;
            }
        }
    }
    else if(mid.getHours() == start.getHours() && mid.getHours() == end.getHours())
    {
        if(mid.getMinutes() > start.getMinutes() && mid.getMinutes() < end.getMinutes())
        {
            flag=true;
        }           
        else if(mid.getMinutes() == start.getMinutes() && mid.getMinutes() < end.getMinutes())
        {
            if(mid.getSeconds() > start.getSeconds())
            {
                flag=true;
            }
        }
        else if(mid.getMinutes() > start.getMinutes() && mid.getMinutes() == end.getMinutes())
        {
            if(mid.getSeconds() < end.getSeconds())
            {
                flag=true;
            }
        }
        else if(mid.getMinutes() == start.getMinutes() && mid.getMinutes() == end.getMinutes())
        {
            if(mid.getSeconds() > start.getSeconds() && mid.getSeconds() < end.getSeconds())
            {
                flag=true;
            }
        }
    } 
```

# django - Django 字段查询处理

> ID：14329206
> 
> 赞同：4
> 
> 时间：2013-01-15T00:21:12.407
> 
> 标签：django, ember.js, django-views, django-rest-framework

我目前正在编写一个项目，该项目在后端使用带有 Django-Rest-Framework 的 Django，在前端使用 Ember.js/Ember-data。

我希望以这种格式将查询从我的 ember 应用程序传递回我的 django api

```
http://myurl.com/application/api/model/?parameter=X 
```

其中参数是正在查询的模型上的字段，X 是要搜索的值。

像这样松散的东西应该是结果查询

```
queryset = Model.objects.filter(**request.QUERY_PARAMS.dict()) 
```

其中 QUERY_PARAMS.dict() 是 Django 语法，它提供格式的字典

```
{parameter:X} 
```

** 将 dict 转换为 Django 所期望的关键字参数。
因此，上面的行实际上是：

```
queryset = Model.objects.filter(parameter=X) 
```

我已经使用自定义视图和自定义 mixin 进行了这项工作，但我担心我的查询处理实现可能有点幼稚，这让我觉得这是一种非常常见的模式。

我想知道是否有用于 Django 的库，或者我不完全理解的一些 Django 内部组件是否可以在没有自定义查询集代码的情况下为我处理这些相对常见的查询？

任何指向正确方向的指针将不胜感激。

史蒂夫凯恩

编辑：

```
 def get_integer_queryset(self, query, queryset):
    #stringify the first entry in query.keys (query is request.QUERY_PARAMS)
    query_key = str(query.keys()[0])
    #split the string into individual strings since the request object dict 
    #contains only a string of numbers and not an actual array (see below)
    #query = {'parameter':'1,2,3,4'} becomes {'parameter':['1','2','3','4']}
    query_values = query.get(query_key, None).split(",")
    #construct two dicts.  One handles integers and the other handles "null"
    #all the code below is required because Django does not seem to handle "null"
    #as a valid query to a field that is type "integer"
    #as a side note, I think this is poor and create annoying work...i would love
    #to be wrong here
    #the Q objects are required in order to compose a query of both integers and 
    #the string "null" 
    query_vals_no_null = {query_key+"__in": []} 
    optional_null_dict = {}
    for value in query_values:
      if value == "null" or value == "None":
        optional_null_dict[query_key+"__isnull"] = True
      else:
        query_vals_no_null[query_key+"__in"].append(value)
    return queryset.filter(  Q(**query_vals_no_null) | 
                             Q(**optional_null_dict)   ) 
```

这是我从处理整数查询的自定义视图中获取的主要方法。我插入评论以澄清正在发生的事情。让我知道这是否有帮助或看起来很熟悉/可怕/真棒/有点温和。

史蒂夫

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-19T10:13:38.477

[django-filter](https://github.com/alex/django-filter)（和 REST framework 的相应 django-filter based [filter backend](http://django-rest-framework.org/api-guide/filtering.html#generic-filtering)）确实是最接近您正在寻找的开箱即用应用程序，但您发现它并不完全支持用例你需要，特别是因为：

*   它不支持查询字符串中的`null`/`None`键。
*   它不支持`__in`使用逗号分隔的样式查找。

（我可能对上述任何一个/两个都错了，但这就是我从源/文档中看到的样子）

这意味着您的选择可能是：

1.  编写您自己的过滤器以完全按照您需要的方式运行。
2.  为上述两个问题提供支持`django-filter`。
3.  寻找[替代过滤应用程序](http://www.djangopackages.com/search/?q=filter)，并使用它，可能将其包装在 REST 框架过滤器后端中，以使其更易于在任何所需的视图中使用。

我认为 (3) 中的任何选项都不能满足您的需求，尽管您可能想快速深入研究一下美味派和活塞，看看它们是否提供了满足您需要的过滤实现，并基于某些东西如果是的话。

还有一个[针对 REST framework 的替代过滤器解决方案](https://github.com/tomchristie/django-rest-framework/pull/230)的封闭拉取请求，看起来它确实支持您`__in`的样式过滤。如果这似乎可以满足您的需要，那么值得对票据进行评论，我们可以考虑重新打开它，以便在 REST 框架中提供另一个过滤器后端。（理想情况下作为第 3 方过滤器后端。）

如果你继续使用你已经开始做的过滤器解决方案，并最终得到更全面的东西，那么值得在[REST 框架组](https://groups.google.com/forum/?fromgroups#!forum/django-rest-framework)中提及它，以便其他人可以使用它，因此我们可以考虑如果值得将其组合成一个更易于重复使用的 3rd 方包。

通过使用更新编辑此问题，让我知道您在小组中的进展情况。

# c# - 让一个对象“锁定”在画布或容器中？

> ID：14329209
> 
> 赞同：1
> 
> 时间：2013-01-15T00:21:23.730
> 
> 标签：c#, visual-studio-2010, windows-phone-7

如何让对象锁定在内容面板或画布上，以便当方向从纵向更改为横向时，它会保持不变并且不会改变大小。

# javascript - 在哪里更改 node.js 中的对象原型？

> ID：14329210
> 
> 赞同：7
> 
> 时间：2013-01-15T00:21:31.883
> 
> 标签：javascript, node.js, module, prototype

我想在 node.js 应用程序中添加或覆盖一些对象、函数和数组的标准方法（例如，像[这个答案中建议的那样）。](https://stackoverflow.com/questions/14307264/what-object-javascript-function-is-bound-to-what-is-its-this/14309359#14309359)我应该如何在一个模块中完成所有“补丁”，以便它影响我的所有其他模块？

如果我在一个只是`require`'d 的模块中执行它就足够了，否则它将无法工作，因为这两个模块具有不同的全局名称空间，因此它们具有不同的对象？...或者我应该在这之后运行一些初始化`require`函数这些“补丁”也在这个模块中工作吗？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-01-15T00:51:24.553

```
//require the util.js file 
require('./util.js');

var a = [];
a.doSomething(); 
```

在您的“util.js”文件中：

```
//in your util.js file you don't have to write a module, just write your code...
Array.prototype.doSomething = function(){console.log("doSomething")}; 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2013-01-15T00:33:58.513

加载的每个文件都共享相同的原始对象，如 Object、Array 等，除非在不同的 vm 上下文中运行，因此在初始化时要求文件一次将在任何地方进行更改。

# groovy - 在 Groovy 中拦截 ClassCastException？

> ID：14329212
> 
> 赞同：0
> 
> 时间：2013-01-15T00:21:42.120
> 
> 标签：groovy

我有很多代码使用并期待 java.util.Date，我想将它们迁移到 org.joda.time.LocalDate。问题是大部分代码都是动态类型的。

所以我想知道是否有任何常规方法来拦截 ClassCastException，在运行时进行转换（而不是让异常冒泡）并记录操作（这样我就可以修复代码）。

例子：

```
import org.joda.time.LocalDate

def someMethod(date) {
    println date.year()
}

// this call is ok
someMethod(new LocalDate())

// this call raises an exception
someMethod(new Date()) 
```

我不想修改上面的代码，比如用 try-catch 包围第二个调用并用正确的类型调用。我想要一种在全球范围内做到这一点的方法。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-15T11:50:49.270

**想法1：**

您可以从 Groovy 多方法中受益：您为 JodaTime 编写方法重载，并在 java.util.Date 方法是动态方法参数时选择它：

```
def someMethod(date) {
    println date.year()
} 
```

我的建议是在此类中编写这些方法的重载来进行转换：

```
def someMethod(LocalDate date) {
    someMethod date.convertToJavaDate()
} 
```

如果您无权访问该代码，则可以使用元编程。

* * *

**想法2：**

如果你有一个庞大的图书馆，我猜你最好混合 JodaTime 类。您将从鸭子打字中获得强大的好处。您将需要知道 java.util.Date 中的哪些成员被调用并将它们重新路由到 Joda 自己的方法：

```
class LocalDateMixin {
  def year() { this[Calendar.YEAR] }
}

LocalDate.metaClass.mixin LocalDateMixin 
```

您还可以使用[扩展方法](http://docs.codehaus.org/display/GROOVY/Creating+an+extension+module)应用元编程。

# c++ - Why is one thread faster than just calling a function, mingw

> ID：14329214
> 
> 赞同：6
> 
> 时间：2013-01-15T00:22:33.513
> 
> 标签：c++, multithreading, performance, function, mingw

When I call function execution time is 6.8 sec. Call it from a thread time is 3.4 sec and when using 2 thread 1.8 sec. No matter what optimization I use rations stay same.

In Visual Studio times are like expected 3.1, 3 and 1.7 sec.

```
#include<math.h>
#include<stdio.h>
#include<windows.h>
#include <time.h>

using namespace std;

#define N 400

float a[N][N];

struct b{
    int begin;
    int end;
};

DWORD WINAPI thread(LPVOID p)
{
    b b_t = *(b*)p;

    for(int i=0;i<N;i++)
        for(int j=b_t.begin;j<b_t.end;j++)
        {
            a[i][j] = 0;
            for(int k=0;k<i;k++)
                a[i][j]+=k*sin(j)-j*cos(k);
        }

    return (0);
}

int main()
{
    clock_t t;
    HANDLE hn[2];

    b b_t[3];

    b_t[0].begin = 0;
    b_t[0].end = N;

    b_t[1].begin = 0;
    b_t[1].end = N/2;

    b_t[2].begin = N/2;
    b_t[2].end = N;

    t = clock();
    thread(&b_t[0]);
    printf("0 - %d\n",clock()-t);

    t = clock();
    hn[0] = CreateThread ( NULL, 0, thread,  &b_t[0], 0, NULL);
    WaitForSingleObject(hn[0], INFINITE );
    printf("1 - %d\n",clock()-t);

    t = clock();
    hn[0] = CreateThread ( NULL, 0, thread,  &b_t[1], 0, NULL);
    hn[1] = CreateThread ( NULL, 0, thread,  &b_t[2], 0, NULL);
    WaitForMultipleObjects(2, hn, TRUE, INFINITE );
    printf("2 - %d\n",clock()-t);

    return 0;
} 
```

Times:

```
0 - 6868
1 - 3362
2 - 1827 
```

CPU - Core 2 Duo T9300

OS - Windows 8, 64 - bit

compiler: mingw32-g++.exe, gcc version 4.6.2

edit:

Tried different order, same result, even tried separate applications. Task Manager showing CPU Utilization around 50% for function and 1 thread and 100% for 2 thread

Sum of all elements after each call is the same: 3189909.237955

Cygwin result: 2.5, 2.5 and 2.5 sec Linux result(pthread): 3.7, 3.7 and 2.1 sec

@borisbn results: 0 - 1446 1 - 1439 2 - 721.

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-16T09:52:21.213

The difference is a result of something in the math library implementing `sin()` and `cos()` - if you replace the calls to those functions with something else that takes time the significant difference between step and 0 and step 1 goes away.

Note that I see the difference with `gcc (tdm-1) 4.6.1`, which is a 32-bit toolchain targeting 32 bit binaries. Optimization makes no difference (not surprising since it seems to be something in the math library).

However, if I build using `gcc (tdm64-1) 4.6.1`, which is a 64-bit toolchain, the difference does *not* appear - regardless if the build is creating a 32-bit program (using the `-m32` option) or a 64-bit program (`-m64`).

Here are some example test runs (I made minor modifications to the source to make it C99 compatible):

*   Using the 32-bit TDM MinGW 4.6.1 compiler:

    ```
    C:\temp>gcc --version
    gcc (tdm-1) 4.6.1

    C:\temp>gcc -m32 -std=gnu99 -o test.exe test.c

    C:\temp>test
    0 - 4082
    1 - 2439
    2 - 1238 
    ```

*   Using the 64-bit TDM 4.6.1 compiler:

    ```
    C:\temp>gcc --version
    gcc (tdm64-1) 4.6.1

    C:\temp>gcc -m32 -std=gnu99 -o test.exe test.c

    C:\temp>test
    0 - 2506
    1 - 2476
    2 - 1254

    C:\temp>gcc -m64 -std=gnu99 -o test.exe test.c

    C:\temp>test
    0 - 3031
    1 - 3031
    2 - 1539 
    ```

A little more information:

The 32-bit TDM distribution (gcc (tdm-1) 4.6.1) links to the `sin()`/`cos()` implementations in the `msvcrt.dll` system DLL via a provided import library:

```
c:/mingw32/bin/../lib/gcc/mingw32/4.6.1/../../../libmsvcrt.a(dcfls00599.o)
                0x004a113c                _imp__cos 
```

While the 64-bit distribution (gcc (tdm64-1) 4.6.1) doesn't appear to do that, instead linking to some static library implementation provided with the distribution:

```
c:/mingw64/bin/../lib/gcc/x86_64-w64-mingw32/4.6.1/../../../../x86_64-w64-mingw32/lib/../lib32/libmingwex.a(lib32_libmingwex_a-cos.o)
                              C:\Users\mikeb\AppData\Local\Temp\cc3pk20i.o (cos) 
```

* * *

**Update/Conclusion:**

After a bit of spelunking in a debugger stepping through the assembly of `msvcrt.dll`'s implementation of `cos()` I've found that the difference in the timing of the main thread versus an explicitly created thread is due to the FPU's precision being set to a non-default setting (presumably the MinGW runtime in question does this at start up). In the situation where the `thread()` function takes twice as long, the FPU is set to 64-bit precision (`REAL10` or in MSVC-speak `_PC_64`). When the FPU control word is something other than 0x27f (the default state?), the `msvcrt.dll` runtime will perform the following steps in the `sin()` and `cos()` function (and probably other floating point functions):

*   save the current FPU control word
*   set the FPU control word to 0x27f (I believe it's possible for this value to be modified)
*   perform the `fsin`/`fcos` operation
*   restore the saved FPU control word

The save/restore of the FPU control word is skipped if it's already set to the expected/desired 0x27f value. Apparently saving/restoring the FPU control word is expensive, since it appears to double the amount of time the function takes.

You can solve the problem by adding the following line to `main()` before calling `thread()`:

```
_control87( _PC_53, _MCW_PC);   // requires <float.h> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-15T07:35:35.217

Not a `cache matter`here.

Likely different runtime libraries for user created threads and main thread. You may compare the calculations `a[i][j]+=k*sin(j)-j*cos(k);` in detail (numbers) for specific values of i, j, and k to confirm differences.

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-01-16T23:53:51.127

The reason is the main thread is doing 64 bit float math and the threads are doing 53 bit math.

You can know this / fix it by changing the code to

```
...
extern "C" unsigned int _control87( unsigned int newv, unsigned int mask );

DWORD WINAPI thread(LPVOID p)
{
    printf( "_control87(): 0x%.4x\n", _control87( 0, 0 ) );
    _control87(0x00010000,0x00010000);
... 
```

The output will be:

```
c:\temp>test   
_control87(): 0x8001f
0 - 2667
_control87(): 0x9001f
1 - 2683
_control87(): 0x9001f
_control87(): 0x9001f
2 - 1373

c:\temp>mingw32-c++ --version
mingw32-c++ (GCC) 4.6.2 
```

You can see that 0 was going to run w/o the 0x10000 flag, but once set, runs at the same speed as 1 & 2\. If you look up the [`_control87()`](http://msdn.microsoft.com/en-us/library/e9b52ceh%28v=vs.71%29.aspx) function, you'll see that this value is the _PC_53 flag, which sets the precision to be 53 instead of 64 had it been left as zero.

For some reason, Mingw isn't setting it to the same value at process init time that CreateThread() does at thread create time.

Another work around it to turn on SSE2 with [`_set_SSE2_enable(1)`](http://msdn.microsoft.com/en-us/library/bthd138d%28v=vs.71%29.aspx), which will run even faster, but may give different results.

```
c:\temp>test   
0 - 1341
1 - 1326
2 - 702 
```

I believe this is on by default for the 64 bit because all 64 bit processors support SSE2.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-15T06:47:10.493

As others suggested, change the order of your three tests to get some more insight. Also, the fact that you have a multi-core machine pretty well explains why using two threads doing half the work each takes half the time. Take a look at your CPU usage monitor (Control-Shift-Escape) to find out how many cores are maxed out during the running time.

# mysql - 从字段插入中减去

> ID：14329215
> 
> 赞同：1
> 
> 时间：2013-01-15T00:22:45.273
> 
> 标签：mysql, sql, sql-insert

我正在开发一个里程表应用程序来跟踪我每天驾驶的公里数，这个结果存储在数据库中。由于我的车没有给出每天行驶多少公里，所以我从今天的公里数中减去总公里数。

假设总公里数为 42,904。我通过这样的查询获得该值：

```
SELECT SUM(kilometros) FROM  `kilometraje` WHERE id_vehiculo =2 
```

但是今天我的里程表显示 42,967 公里，然后我手动进行减法并将差值插入数据库中。

```
INSERT INTO kilometraje (id_vehiculo, kilometros, fecha) VALUES (2, 63, '2013-01-14') 
```

如何在单个查询中实现此过程？，我尝试了以下但没有成功：

```
INSERT INTO kilometraje (id_vehiculo, kilometros, fecha) VALUES (2, 42967-(SELECT SUM(kilometros) FROM  `kilometraje` WHERE id_vehiculo =2) , '2013-01-14') 
```

因为我收到此错误： **-您无法在 FROM 子句中指定目标表“kilometraje”进行更新**

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-15T00:24:47.753

采用`INSERT..INTO SELECT`

```
INSERT INTO kilometraje (id_vehiculo, kilometros, fecha) 
SELECT 2, 42967 - SUM(kilometros), '2013-01-14'
FROM  `kilometraje` 
WHERE id_vehiculo = 2 
```

# c++ - C++ 和 Objective C 之间的事件处理

> ID：14329218
> 
> 赞同：7
> 
> 时间：2013-01-15T00:23:23.087
> 
> 标签：c++, ios, objective-c, xcode, events

我最近开始开发一款 iOS 游戏，并决定用 C++ 编写该项目的一个独特部分。只要Objective C 类简单地访问一些成员或调用C++ 对象上的函数，这种方法似乎就可以正常工作。但是，我似乎找不到一种优雅的方式来让我的 Objective C 类响应 C++ 类中的“事件”。任何使用回调的事件处理系统似乎都是不可能的（因为 Objective C 方法和 C++ 函数并且可能不可互换）。我能想到的只是使用委托模式并围绕我的 C++ 委托类编写包装类，以便我可以在 Objective C 代码中使用它们。所以我的问题是：有没有更好的方法来做到这一点？

注意：我想避免在我的 C++ 文件中直接使用 Objective C，因为这些类应该是平台独立的。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-15T00:44:12.063

您可能需要考虑 CoreVideo 使用的机制。

在他们的模型中，他们有一种涉及注册 C 回调函数（[http://tinyurl.com/axtxajf](http://tinyurl.com/axtxajf)）的机制，并且该函数的参数之一是 void*，它可以被类型转换为 Objective-C 类你需要访问。

这是您可以在 C++ 模块中实现以注册回调函数的 C 函数示例。参数是回调函数和指向类实例的指针：

```
SetEventCallback(EventCallbackFunction, self); 
```

当需要处理事件时，会调用回调函数，您可以将void*类型转换为调用Obj-C类并调用方法：

```
void EventCallbackFunction(void* objCPtr)
{
    [(MyObjCClass*)objCPtr someMethod];
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-15T08:26:58.673

您可以使用 C++0x lambda 函数，它们可以与 Objective-C 块互换（可相互分配）。

# python - 转到另一个视图

> ID：14329219
> 
> 赞同：0
> 
> 时间：2013-01-15T00:23:24.073
> 
> 标签：python, django

假设我有以下观点：

```
def show(request):
    protect(request)

    ... some more code here...

    return render_to_response
    ... 
```

“保护”是我正在导入的另一个应用程序视图： from watch.actions import protect

在保护中，我进行了一些检查，如果满足条件，我想从“保护”中直接使用 render_to_response 并防止返回显示。如果不满足条件，我想正常返回“显示”并继续执行代码。

我该怎么做？

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-15T00:25:13.130

如果它的唯一目的是您所描述的，您应该考虑将其编写`protect`为视图装饰器。[这个答案](https://stackoverflow.com/a/4320739)提供了一个如何做到这一点的例子。

根据我写的视图装饰器，你的`protect`装饰器可能看起来像：

```
from functools import wraps

from django.utils.decorators import available_attrs

def protect(func):
    @wraps(func, assigned=available_attrs(func))
    def inner(request, *args, **kwargs):
        if some_condition:
            return render_to_response('protected_template')
        return func(request, *args, **kwargs)
    return inner 
```

这将允许您像这样使用它：

```
@protect
def show(request):
   ...
   return render_to_response(...) 
```

# php - preg_match_all 返回 2 个结果

> ID：14329220
> 
> 赞同：0
> 
> 时间：2013-01-15T00:23:43.977
> 
> 标签：php, regex

```
$string = "c4414b8e90510db12 GET /emailtrack/blank.gif?source=mailchimp&guid=12345&campaign=myCampaign HTTP/1.1"
preg_match_all('/("GET.*?"+)/is',$string,$match);

Result:

Array (
    [0] => Array (
        [0] => "GET /emailtrack/blank.gif?source=mailchimp&guid=12345&campaign=myCampaign HTTP/1.1"
    )

    [1] => Array (
        [0] => "GET /emailtrack/blank.gif?source=mailchimp&guid=12345&campaign=myCampaign HTTP/1.1"
    )
) 
```

解析字符串`preg_match_all`只是为了获取 GET 字符串，但它返回 GET 字符串的 2 个结果，我只需要数组中的一个结果

感谢它对我有用的早期答案。

```
$string = "source=xxxx&campaign=asdas&guid=121" 
```

无论如何你可以帮我告诉我一个正则表达式，用于从上面的字符串中提取 source=xxxxx

我试过这个

```
preg_match_all('/source.*?\s/', $string, $match); 
```

但它给了我整个字符串，我想将字符串源、活动和 guid 分开

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-15T00:25:21.687

结果的第一个条目始终是完整匹配。整个模式周围还有额外的括号，这将成为第一个“子模式”。

解决方法：去掉括号。

# c# - unity，奇怪的调试

> ID：14329222
> 
> 赞同：14
> 
> 时间：2013-01-15T00:23:45.400
> 
> 标签：c#, list, unity3d

我添加了必要的 using 语句。在我的类的顶部使用 System.Collections.Generic，编译器很乐意接受我对列表的使用，但是当我调试时，我遇到了一个非常奇怪的调试问题，因为当我展开列表时，我得到：

未知类型'System.Collections.Generic.CollectionDebuggerView'1 mscorlib。

可能有哪些原因？谷歌似乎没有帮助我......

列表在声明和空时似乎确实声明了它们的信息，并且它们是用我创建的类定义的，但我从未在任何其他工具包（如 XNA 等）中看到这个问题。

我还应该提到这是通过 MonoDevelop 我看到了这个错误。

谢谢。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-01-15T00:29:30.607

根据[这些发行说明](http://www.mono-project.com/Release_Notes_Mono_2.10.2)，这是 Mono 中的一个错误。它已修补`2.10.2`，但 Unity 未使用修补后的 Mono 构建。

> 679586：在调试器中查看参数化集合时出现未知类型 System.Collections.Generic.CollectionDebuggerView 错误

Unity 使用 Mono 2.6。如果无法访问 Unity 的源代码，我不确定如何实现该补丁。即使有源代码，`2.6`它仍然是稳定的构建，`2.10.2`所以它可能会在其他地方引起问题。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-08-18T14:54:23.187

使用`.ToArray()`方法将 my 转换`List<T>`为`T[]`数组。只是不要忘记在发布时扫描此代码！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-01-05T15:40:19.317

对我有用的快速而肮脏的解决方法：

```
private class CellList : List<Cell> {} 
```

不知何故，它在调试器中正确显示。

# javascript - Array.select 不选择元素

> ID：14329224
> 
> 赞同：0
> 
> 时间：2013-01-15T00:23:49.153
> 
> 标签：javascript, express

我有以下数组：

```
var jobs = [
  { ID: 'grt34hggf', Title: 'tobi', Location: 'Los Angeles, CA', Description: "bla-bla-bla", DateExpiration: "FFF" },
  { ID: 'vbnhty', Title: 'n', Location: 'Los Angeles, CA', Description: "bla-bla-bla", DateExpiration: "FFF" },
  { ID: 'bnm7ii78', Title: 'bnui', Location: 'Los Angeles, CA', Description: "bla-bla-bla", DateExpiration: "FFF" }
]; 
```

然后我尝试从这个数组中获取一个元素。以下代码不起作用：

```
app.get('/job/:id', function (req, res) {
    res.render('job', {
        job: jobs.filter(function(x) { return x.ID == 'bnm7ii78'; }),
        title: "Job Descr",
        header: "descr"
    });
}); 
```

但以下代码有效：

```
app.get('/job/:id', function (req, res) {
    res.render('job', {
        job : jobs[0],
        title: "Job Descr",
        header: "descr"
    });
}); 
```

为什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-15T00:32:40.137

看起来您期望一个对象，但`jobs.filter(...)`返回一个包含所有符合您条件的元素的[数组。](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Array/filter)你可以试试`jobs.filter(...)[0]`。

# javascript - 将 html 中的字段计算传递给 SAME 表单中的另一个字段

> ID：14329225
> 
> 赞同：0
> 
> 时间：2013-01-15T00:23:49.373
> 
> 标签：javascript, html, forms

所以，我只能找到如何将信息传递到另一个页面而不是同一页面，这必须完全在客户端完成，没有服务器端工作，因为使用它时将没有互联网连接，因此 mailto 用于表单数据，以便在连接可用时发送。

基本上我有两张表，左边一张有一组标准数字（字段 time1-time8），用户可以根据需要进行更改。这些值合计到“设计小时”字段中。该数字必须输入右侧的“设计小时”字段，以便进行所需的各种计算。在我以前的工作（不是 HTML 或 javascript）中，如果字段名称相同，则传递数据，显然不是这里的情况。

在我把表格放在左边之前，这个表格工作得很好，但现在我需要添加一个总计一个新的“设计小时”值的选项。非常感谢以前帮助过我的人，也非常感谢现在帮助过我的人。我还在学习，但我正在到达那里。

**删除了大多数字段的示例代码**，因此您可以看到我在做什么（感谢您指出）下面的完整代码方式...

**所以左表中的字段名称**

*time1 - time8*这些值被添加到总设计小时数中

 ***和正确的桌子**

工资、教师、班级、设计 *时间（与左表相同）*、成本、许多、atetextfield7、build_cost、buy_cost、build_hours、buy_hours、build_train、buy_train、build_total、buy_total

```
<script type="text/javascript">
var btn = document.getElementById('calculate');
btn.onclick = function() {
var wageval = parseInt(document.getElementById('wage').value) || 0;
var instructorsval = parseInt(document.getElementById('instructors').value) || 0;

var build_cost = document.getElementById('build_cost');
var buy_cost = document.getElementById('buy_cost');

var msg = [];

if (isNaN(wageval)) {
    msg.push('Average instructor hourly wage is not a number');
    // the value isn't a number
    }
if (isNaN(instructorsval)) {
    msg.push('Number of instructors per course is not a number');
    // the value isn't a number
        }

if (msg.length > 0)   {
    build_cost.value = msg.join(', ');
    buy_cost.value = msg.join(', '); 
```

以及以下计算：

```
} else {
    designhours.value = (time1 + time2 + time3 + time4 + time5 + time6 + time7 + time8);
    build_cost.value = (wageval * designhoursval);
    buy_cost.value = (costval * hiddenval);
    build_hours.value = (designhoursval * manyval);
    build_train.value = (classval * hiddenval);
    build_total.value = (wageval * designhoursval * manyval + classval);
    buy_total.value = (costval * manyval);
    var build_costval = parseInt(build_cost.value) || 0;
    var buy_costval = parseInt(buy_cost.value) || 0;
    var build_hoursval = parseInt(build_hours.value) || 0;
    var build_trainval = parseInt(build_train.value) || 0;
    var build_totalval = parseInt(build_total.value) || 0;
    var buy_totalval = parseInt(buy_total.value) || 0;
    var designhoursval = parseInt(designhours.value) || 0;
} 
```

**完整代码如下**

**HTML**

```
<form id="form1" name="form1" method="post" action="mailto:?subject=Laerdal%20ROI%20Information" enctype="text/plain">
    <table width="859" border="0" cellpadding="0" cellspacing="0">
        <tr>
            <td valign="bottom">
                <table width="352" border="0" cellspacing="0" cellpadding="0">
                    <tr>
                        <td height="22" colspan="2">&nbsp;</td>
                    </tr>
                    <tr>
                        <td width="225" height="22">&nbsp;</td>
                        <td width="127" height="22" align="left">&nbsp;</td>
                    </tr>
                    <tr>
                        <td height="22"><span class="norm">Needs Analysis</span></td>
                        <td height="22" align="center"><input name="time1" type="text" class="field" id="time1" value="1" size="10" /></td>
                    </tr>
                    <tr>
                        <td height="22"><span class="norm">Research</span></td>
                        <td height="22" align="center"><input name="time2" type="text" class="field" id="time2" value="2" size="10" /></td>
                    </tr>
                    <tr>
                        <td height="22"><span class="norm">Design</span></td>
                        <td height="22" align="center"><input name="time3" type="text" class="field" id="time3" value="2" size="10" /></td>
                    </tr>
                    <tr>
                        <td height="22"><span class="norm">Scenario Programming</span></td>
                        <td height="22" align="center"><input name="time4" type="text" class="field" id="time4" value="3" size="10" /></td>
                    </tr>
                    <tr>
                        <td height="22"><span class="norm">Support Materials</span></td>
                        <td height="22" align="center"><input name="time5" type="text" class="field" id="time5" value="16" size="10" /></td>
                    </tr>
                    <tr>
                        <td height="22"><span class="norm">Validation</span></td>
                        <td height="22" align="center"><input name="time6" type="text" class="field" id="time6" value="2" size="10" /></td>
                    </tr>
                    <tr>
                        <td height="22"><span class="norm">Revision</span></td>
                        <td height="22" align="center"><input name="time7" type="text" class="field" id="time7" value="4" size="10" /></td>
                    </tr>
                    <tr>
                        <td height="22"><span class="norm">Implementation</span></td>
                        <td height="22" align="center"><input name="time8" type="text" class="field" id="time8" value="2" size="10" /></td>
                    </tr>
                    <tr>
                        <td height="22"><span class="norm">Total</span></td>
                        <td height="22" align="center"><input name="designhours" class="field" type="text" id="designhours" size="10" /></td>
                    </tr>
                    <tr>
                        <td height="73" colspan="2">&nbsp;</td>
                    </tr>
                </table>
                <p>&nbsp;</p></td>
            <td width="55" valign="bottom">&nbsp;</td>
            <td>
                <table width="440" border="0" cellspacing="0" cellpadding="0">
                    <tr>
                        <td height="36" colspan="2" align="right" class="norm">Average Instructor hourly wage:</td>
                        <td height="36" align="right"><input name="wage" class="field" type="text" id="wage" size="12" /></td>
                    </tr>
                    <tr>
                        <td height="36" colspan="2" align="right" class="norm">Number of Instructors per course:</td>
                        <td height="36" align="right"><input name="instructors" class="field" type="text" id="instructors" size="12" /></td>
                    </tr>
                    <tr>
                        <td height="36" colspan="2" align="right" class="norm">Scenario Programing Class:</td>
                        <td height="36" align="right"><input name="class" class="field" type="text" id="class" size="12" /></td>
                    </tr>
                    <tr>
                        <td height="36" colspan="2" align="right" class="norm">Instruction design hours per scenarios:</td>
                        <td height="36" align="right"><input name="designhours" class="field" type="text" readonly="true" id="designhours" size="12" /></td>
                    </tr>
                    <tr>
                        <td height="36" colspan="2" align="right" class="norm">Average cost of SimStore Scenarios:</td>
                        <td height="36" align="right"><input name="cost" class="field" type="text" id="cost" value="295" size="12" /></td>
                    </tr>
                    <tr>
                        <td height="36" colspan="2" align="right" class="norm">How many scenarios do you need:</td>
                        <td height="36" align="right"><input name="many" class="field" type="text" id="many" size="12" /></td>
                    </tr>
                    <tr>
                        <td height="36" colspan="2" align="right" class="norm">Date needed?:</td>
                        <td height="36" align="right"><input name="atetextfield7" class="field" type="text" id="atetextfield7" size="12" /></td>
                    </tr>
                    <tr>
                        <td height="40" colspan="3" align="center" class="calc">CALCULATED RESULTS</td>
                    </tr>
                    <tr>
                        <td height="40"><input name="hidden" type="hidden" id="hidden" value="1" /></td>
                        <td height="40" align="center" class="bold">BUILD</td>
                        <td height="40" align="center" class="bold">BUY</td>
                    </tr>
                    <tr>
                        <td height="38" align="right" class="norm">Cost per scenario:<img src="images/Blank.png" alt="" width="12" height="5" /></td>
                        <td height="38" align="center"><input name="build_cost" class="field" type="text" id="build_cost" size="12" /></td>
                        <td height="38" align="center"><input name="buy_cost" class="field" type="text" id="buy_cost" size="12" /></td>
                    </tr>
                    <tr>
                        <td height="38" align="right" class="norm">Total development hours:<img src="images/Blank.png" alt="" width="12" height="5" /></td>
                        <td height="38" align="center"><input name="build_hours" class="field" type="text" id="build_hours" size="12" /></td>
                        <td height="38" align="center"><input name="buy_hours" class="field" type="text" id="buy_hours" value="0" size="12" /></td>
                    </tr>
                    <tr>
                        <td height="38" align="right" class="norm">
                            Scenario Programming<img src="images/Blank.png" alt="" width="12" height="5" /><br />
                            Training (8h):<img src="Blank.png" alt="" width="12" height="5" />
                        </td>
                        <td height="38" align="center"><input name="build_train" class="field" type="text" id="build_train" size="12" /></td>
                        <td height="38" align="center"><input name="buy_train" class="field" type="text" id="buy_train" value="0" size="12" /></td>
                    </tr>
                    <tr>
                        <td height="38" align="right" class="norm">Total Cost:<img src="images/Blank.png" alt="" width="12" height="5" /></td>
                        <td height="38" align="center"><input name="build_total" class="field" type="text" id="build_total" size="12" /></td>
                        <td height="38" align="center"><input name="buy_total" class="field" type="text" id="buy_total" size="12" /></td>
                    </tr>
                    <tr>
                        <td height="50" colspan="3" align="center" valign="bottom"><input type="reset" />
                            <img src="images/Blank.png" alt="" width="15" height="25" />
                            <input name="calculate" type="button" id="calculate" value="Calculate" />
                            <img src="images/Blank.png" alt="" width="15" height="25" />
                            <input name="share" type="submit" id="submit" value="Share" />
                        </td>
                    </tr>
                </table>
            </td>
        </tr>
    </table>
</form> 
```

**Javascript**

```
var btn = document.getElementById('calculate');
btn.onclick = function () {
    //get the input values
    var wageval = parseInt(document.getElementById('wage').value) || 0;
    var instructorsval = parseInt(document.getElementById('instructors').value) || 0;
    var classval = parseInt(document.getElementById('class').value) || 0;
    var designhoursval = parseInt(document.getElementById('designhours').value) || 0;
    var costval = parseInt(document.getElementById('cost').value) || 0;
    var manyval = parseInt(document.getElementById('many').value) || 0;
    var hiddenval = parseInt(document.getElementById('hidden').value) || 0;
    var time1val = parseInt(document.getElementById('time1').value) || 0;
    var time2val = parseInt(document.getElementById('time2').value) || 0;
    var time3val = parseInt(document.getElementById('time3').value) || 0;
    var time4val = parseInt(document.getElementById('time4').value) || 0;
    var time5val = parseInt(document.getElementById('time5').value) || 0;
    var time6val = parseInt(document.getElementById('time6').value) || 0;
    var time7val = parseInt(document.getElementById('time7').value) || 0;
    var time8val = parseInt(document.getElementById('time8').value) || 0;
    // get the elements to hold the results
    var build_cost = document.getElementById('build_cost');
    var buy_cost = document.getElementById('buy_cost');
    var build_hours = document.getElementById('build_hours');
    var buy_hours = document.getElementById('buy_hours');
    var build_total = document.getElementById('build_total');
    var build_train = document.getElementById('build_train');
    var buy_total = document.getElementById('buy_total');
    var time1 = document.getElementById('time1');
    var time2 = document.getElementById('time1');
    var time3 = document.getElementById('time1');
    var time4 = document.getElementById('time1');
    var time5 = document.getElementById('time1');
    var time6 = document.getElementById('time1');
    var time7 = document.getElementById('time1');
    var time8 = document.getElementById('time1');
    var designhours = document.getElementById('designhours');
    // create an empty array to hold error messages
    var msg = [];
    // check each input value, and add an error message to the array if it's not a number
    if (isNaN(wageval)) {
        msg.push('Average instructor hourly wage is not a number');
        // the value isn't a number
    }
    if (isNaN(instructorsval)) {
        msg.push('Number of instructors per course is not a number');
        // the value isn't a number
    }
    if (isNaN(classval)) {
        msg.push('Scenario programming class is not a number');
        // the value isn't a number
    }
    if (isNaN(designhoursval)) {
        msg.push('Instruction design hours per scenario is not a number');
        // the value isn't a number
    }
    if (isNaN(costval)) {
        msg.push('Average cost of SimStore scenarios is not a number');
        // the value isn't a number
    }
    if (isNaN(manyval)) {
        msg.push('How many scenarios do you need is not a number');
        // the value isn't a number
    }
    if (isNaN(hiddenval)) {
        msg.push('joe messed up');
        // the value isn't a number
    }
    if (isNaN(time1val)) {
        msg.push('Needs Analysis is not a number');
        // the value isn't a number
    }
    if (isNaN(time2val)) {
        msg.push('Research is not a number');
        // the value isn't a number
    }
    if (isNaN(time3val)) {
        msg.push('Design is not a number');
        // the value isn't a number
    }
    if (isNaN(time4val)) {
        msg.push('Scenario Programming is not a number');
        // the value isn't a number
    }
    if (isNaN(time5val)) {
        msg.push('Support Materials is not a number');
        // the value isn't a number
    }
    if (isNaN(time6val)) {
        msg.push('Validation is not a number');
        // the value isn't a number
    }
    if (isNaN(time7val)) {
        msg.push('Revision is not a number');
        // the value isn't a number
    }
    if (isNaN(time8val)) {
        msg.push('Implementation is not a number');
        // the value isn't a number
    }
    // if the array contains any values, display an error message

    if (msg.length > 0)  {
        build_cost.value = msg.join(', ');
        buy_cost.value = msg.join(', ');
        build_hours.value = msg.join(', ');
        build_train.value = msg.join(', ');
        build_total.value = msg.join(', ');
        buy_total.value = msg.join(', ');
        time1.value = msg.join(', ');
        time2.value = msg.join(', ');
        time3.value = msg.join(', ');
        time4.value = msg.join(', ');
        time5.value = msg.join(', ');
        time6.value = msg.join(', ');
        time7.value = msg.join(', ');
        time8.value = msg.join(', ');
    } else {
        designhours.value = (time1 + time2 + time3 + time4 + time5 + time6 + time7 + time8);
        build_cost.value = (wageval * designhoursval);
        buy_cost.value = (costval * hiddenval);
        build_hours.value = (designhoursval * manyval);
        build_train.value = (classval * hiddenval);
        build_total.value = (wageval * designhoursval * manyval + classval);
        buy_total.value = (costval * manyval);
        var build_costval = parseInt(build_cost.value) || 0;
        var buy_costval = parseInt(buy_cost.value) || 0;
        var build_hoursval = parseInt(build_hours.value) || 0;
        var build_trainval = parseInt(build_train.value) || 0;
        var build_totalval = parseInt(build_total.value) || 0;
        var buy_totalval = parseInt(buy_total.value) || 0;
        var designhoursval = parseInt(designhours.value) || 0;
    }
}; 
```

再次感谢任何人都可以提供的任何指导。我正在努力度过这一切。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-15T01:15:55.590

首先，不知道这些是干什么用的：

```
var time1 = document.getElementById('time1');
var time2 = document.getElementById('time1');
var time3 = document.getElementById('time1');
var time4 = document.getElementById('time1');
var time5 = document.getElementById('time1');
var time6 = document.getElementById('time1');
var time7 = document.getElementById('time1');
var time8 = document.getElementById('time1'); 
```

然后，您只有在 timex 中作为 var 的元素。

所以最简单的解决方法是：
`designhours.value = time1val + time2val + time3val + time4val + time5val + time6val + time7val + time8val;`

代替：
`designhours.value = time1 + time2 + time3 + time4 + time5 + time8 + time7 + time8;`

看看你哪里出错了？您将对象（输入字段）添加在一起，而不是它们的值（您已经开始使用）。
请注意，输入字段中的数字不是数字而是字符串。
您可能还想用 parseInt 指定一个基数，例如`parseInt(val,10);`

最后，您可以对代码进行相当多的重构，这确实有点多（但对您提供有用的错误检测很有用）。

看到这个小提琴：http: [//jsfiddle.net/4nHvc/1/](http://jsfiddle.net/4nHvc/1/)

**更新：**经过进一步检查，还有很多错误：为什么在函数末尾设置这些函数局部变量？

```
var build_costval = parseInt(build_cost.value) || 0;
var buy_costval = parseInt(buy_cost.value) || 0;
var build_hoursval = parseInt(build_hours.value) || 0;
var build_trainval = parseInt(build_train.value) || 0;
var build_totalval = parseInt(build_total.value) || 0;
var buy_totalval = parseInt(buy_total.value) || 0;
var designhoursval = parseInt(designhours.value) || 0; 
```

在您使用错误变量名（因此添加对象而不是它们的值）的第一行之后的下一行 javascript 也无法工作：
`build_cost.value = (wageval * designhoursval);`

好吧，如果你在代码的开头得到 inputfield designhoursval 的值，那个字段还是空的。那么当脚本执行上面的行时，什么是`designhoursval`??? 对的，空的。例如，如果您在没有变量声明的情况下使用最后一个“无用”代码块重新读取该值`var`（您已经在函数的开头声明了它）并将其放在该行上方，那么计算器的另一个字段开始工作：

```
designhoursval = parseInt(designhours.value) || 0;
build_cost.value = (wageval * designhoursval); 
```

但是然后..首先获取所有输入值，进行数学运算，然后输出值不是更容易吗？

看到这个小提琴，现在它几乎可以工作了：http: [//jsfiddle.net/4nHvc/2/](http://jsfiddle.net/4nHvc/2/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-15T01:32:33.513

更新您的时间值...

```
var time1 = parseInt(document.getElementById('time1').value);
var time2 = parseInt(document.getElementById('time1').value);
var time3 = parseInt(document.getElementById('time1').value);
var time4 = parseInt(document.getElementById('time1').value);
var time5 = parseInt(document.getElementById('time1').value);
var time6 = parseInt(document.getElementById('time1').value);
var time7 = parseInt(document.getElementById('time1').value);
var time8 = parseInt(document.getElementById('time1').value); 
```

另外，我不确定你是如何将你的按钮连接到你的脚本的，所以我改变了你的功能......

```
function doThis() { 
```

和你的按钮...

```
<input name="calculate" type="button" id="calculate" value="Calculate" onclick="doThis()" /> 
```

这些在您的代码中可能没问题，但是在您的帖子中省略了该部分，因此请检查一下。（您可以只使用“alert('foo');”来检查。）*

# web-applications - 主屏幕上的网络书签图标，通过应用程序/播放商店？

> ID：14329232
> 
> 赞同：0
> 
> 时间：2013-01-15T00:24:55.010
> 
> 标签：web-applications, mobile

我有一个支持经典浏览器和移动浏览器的 Web 应用程序。

我的大多数用户似乎都在为创建 URL 书签并选择“添加到主屏幕”的概念而苦恼设备。

有没有办法可以为他们简化这个过程？或者也许将本机应用程序提交到应用程序/播放商店，这只不过是一个快捷方式？

还是本机 webview 是唯一的解决方案？

您的任何建议将不胜感激

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-15T00:35:01.943

我认为您想要“添加到主屏幕气泡”以下链接将带您了解谷歌是如何做到的。我从未实施过，据我所知，此解决方案仅适用于 iOS。但它可能会为您提供所需的东西

[http://code.google.com/p/mobile-bookmark-bubble/](http://code.google.com/p/mobile-bookmark-bubble/)

源代码示例如下：

[http://code.google.com/p/mobile-bookmark-bubble/source/browse/example/example.html?r=0699d12cfe8cc906accd66e7c49f3fd4fb10bad6](http://code.google.com/p/mobile-bookmark-bubble/source/browse/example/example.html?r=0699d12cfe8cc906accd66e7c49f3fd4fb10bad6)

祝你好运，希望我能提供更多帮助。

# c - 从 signed char 到 sign int 的符号扩展如何工作？

> ID：14329238
> 
> 赞同：3
> 
> 时间：2013-01-15T00:25:27.397
> 
> 标签：c, type-conversion, signed

为什么`255`用有符号字符表示的值会转换为`-1`整数？我看到一条`mov sbl`指令被用来`x86`将签名转换为`char`签名`int`，但为什么它会以现在的方式转换？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-15T00:35:30.237

假设一个 8 位字符，类型的对象`signed char`永远不会有值 255。当您将 255 分配给这样的对象时，它会以实现定义的方式进行转换（实际上，它总是以 256 为模归约到范围内）。因此，此时它的值*已经*是 -1。将其转换为类型`int`根本不会改变。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-15T00:28:43.507

符号扩展通过检查值的高位并从那里扩展来工作。255 是无符号的全 1，因此当它的符号扩展时，它会用 1 填充。有符号整数格式的所有 1 都是 -1。

我注意到你说 255 作为签名字符。有符号字符的最大值实际上是 127。如果你这样做

```
char a = 255; 
```

在某些编译器中，您实际上会得到 -1。不过，无符号字符可以容纳 255。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-15T00:44:24.307

该指令`movsb{w,l,q}`查看字节中的“最高位”，并用该值填充字的剩余位（16、32 或 64 位）。

这个的姊妹指令是`movzb{w,l,q}`，它是零扩展（也就是说，做一个“无符号扩展”。

在 64 位 x86 中，32 位操作会自动用零填充高 32 位，因此要将 32 位值扩展为 64 位，编译器将添加一个`movslq`以将 32 位数字扩展为 64 位。

还有`movswl`和`movswq`将 16 位寄存器分别扩展到 32 位和 64 位。

# nuget - 检查 nuget 包的内容

> ID：14329243
> 
> 赞同：68
> 
> 时间：2013-01-15T00:25:44.080
> 
> 标签：nuget

有没有办法检查 NuGet 包的内容以查看它将进行哪些更改？Nuget.exe 命令行上没有此选项，我在 NuGet 文档中找不到有关此的任何信息。

* * *

## 回答 #1

> 赞同：88
> 
> 时间：2013-01-15T11:54:56.447

`.nupkg`文件只是带有一些元数据的 ZIP 文件，因此您可以查看内容。[NuGet 包资源管理器](https://github.com/NuGetPackageExplorer/NuGetPackageExplorer)应该更容易查看内容。

NuGet Gallery（例如[https://www.nuget.org/](https://www.nuget.org/)）在右侧有一个“下载”链接，否则只需将包安装到一个空项目中，然后查看。

* * *

## 回答 #2

> 赞同：51
> 
> 时间：2016-02-15T14:49:58.197

## 视窗用户：

正如乔纳森·罗西指出的那样，

> .nu​​pkg 文件只是 ZIP 文件，因此您可以查看内容

因此，在 Windows 机器上，为了临时修复，只需将文件扩展名从 更改`.nupkg`为`.zip`，然后使用 Windows'`File Explorer`来利用`.zip`( `CompressedFolder`) 文件的现有文件关联。

可以“永久”`.nupkg`与您的系统`CompressedFolder`工具关联。但是，这`IconCache.db`至少会损坏 ，并且恢复它的典型方法对我不起作用（删除`IconCache.db`并重新启动）。因此，如果您担心***在***`.nupkg`.`CompressedFolder``File Explorer`

`.nupkg`考虑到这一点，如果您想要在不更改扩展名的情况下打开文件的长期解决方案......

您可以通过命令提示符 ( `cmd`) 轻松设置文件关联，如下所示：

[![在此处输入图像描述](../Images/ebb5e59bb5e79875dabd888817ab34d2.png)](https://i.stack.imgur.com/6ZaH0.png)

这些文件现在将与您的文件系统上的任何其他文件具有相同的图标`CompressedFolder`，并且您可以保持它们的扩展名不变（如`.nupkg`）。

要撤消此关联，请重复`assoc`命令，`.nupkg`但将 RHS 留空：

[![在此处输入图像描述](../Images/ba9f5fcd9038ee0e9a48f33a95457971.png)](https://i.stack.imgur.com/V5Uun.png)

您可以随时通过运行**删除等号 (**`assoc .nupkg` )来确认当前文件关联**。**：**`=`**

[![在此处输入图像描述](../Images/db1002edc0f386f37c792326e7e80cac.png)](https://i.stack.imgur.com/ylWNS.png)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2019-09-20T07:59:02.160

另一种解决方案是使用[DotPeek](https://www.jetbrains.com/decompiler/)。

它有一个选项可以直接从 NuGet 和 NuGet 缓存反编译包。

[![DotPeek 的屏幕截图](../Images/b254d20865f4a11ee7bd664610e329a6.png)](https://i.stack.imgur.com/6U5yH.png)

# php - 使用 SQL TimeDiff 填充 PHP 表数据

> ID：14329246
> 
> 赞同：0
> 
> 时间：2013-01-15T00:25:56.207
> 
> 标签：php, mysql, datetime, pdo, html-table

我已经在 Google 上搜索了很长时间，但我不知道这是我提出问题的方式还是什么，但我找不到任何与此密切相关的东西。我有一个 PDO SQL 语句：

```
 try 
    {
$query = $dbh->prepare("SELECT id, anum, first, last, signintime, counselorname, 
                        finishtime, TIMEDIFF(finishtime, signintime) AS Total_wait  FROM inoffice;");
$query->execute();
$result = $query->fetchall();
    }
        catch (PDOException $e) {
        error_log($e->getMessage());
        die($e->getMessage());
        } 
```

然后我有一个结构如下的表：

```
<table id='datatables' class='display'>
                <thead>
                    <tr>

                        <th>Session Id</th> 
                        <th>A Number</th>
                        <th>First Name</th>
                        <th>Last Name</th>
                        <th>Signin Time</th>
                        <th>Counselor Name</th>
                        <th>Finish Time</th>
                        <th>Total Wait Time</th>
                    </tr>
                </thead>
                <tbody>
                 <?php
                    foreach($result as $row) {
                        ?>
                        <tr>
                            <td><?=$row['id'] ?></td>
                            <td><?=$row['anum'] ?></td>
                            <td><?=$row['first'] ?></td>
                            <td><?=$row['last'] ?></td>
                            <td><?=$row['signintime'] ?></td>
                            <td><?=$row['counselorname'] ?></td>
                            <td><?=$row['finishtime'] ?></td>
                            <td><?= ?></td>
                        </tr>
<?php
}
?>            

                    </tbody>
            </table> 
```

我的问题是我到底如何在我的表的最后一个 td 标记中获得我的 PDO 选择的最后一部分？我感到困惑的部分是：

```
TIMEDIFF(finishtime, signintime) AS Total_wait 
```

我希望它能够包含在表格的最后一个 td 中。任何帮助/技巧/解决方法都很棒。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-15T00:33:38.787

你必须对待`TIMEDIFF(finishtime, signintime) AS Total_wait`

作为数据库中自己的行。

结果是：

```
 <td><?=$row['Total_wait'] ?></td> 
```

现在这张桌子看起来很好用：

![在此处输入图像描述](../Images/c77befd2f036104b0809eb41f30bd35e.png)

# arrays - 从 Wordpress 的下拉菜单中保存数组

> ID：14329248
> 
> 赞同：0
> 
> 时间：2013-01-15T00:26:07.793
> 
> 标签：arrays, wordpress

我已成功将自定义帖子类型拉入自定义元框中的下拉列表中。但是，当在前端显示它时，我还想提供指向实际帖子的链接，而不仅仅是帖子的名称。所以我猜我需要将它保存为一个数组？这可以通过下拉菜单实现吗？对我应该如何处理这个感到困惑。任何帮助是极大的赞赏。

这是我到目前为止所拥有的：

```
// Add Meta Box To Select Overseeing Pastor
add_action('admin_init', 'ministry_select_add_meta');
function ministry_select_add_meta(){
    add_meta_box('ministry_select_post', __('Overseeing Pastor'), 'ministry_select_meta', 'ministry', 'side');
}

function ministry_select_meta( $post ) {
    $values = get_post_custom( $post->ID );
    $selected = isset( $values['pastor_select'] ) ? esc_attr( $values['pastor_select'][0] ) : '';
    wp_nonce_field( 'my_meta_box_nonce', 'meta_box_nonce' );
    ?>
        <select name="pastor_select">
            <?php
            $args = array(
                'post_type' => 'employee',
                'position' => 'pastor'
            );
            $pastorList = new WP_Query($args); while ($pastorList->have_posts()) : $pastorList->the_post();
                $is_selected = (get_the_title() == $selected) ? 'selected="selected"' : '';
                echo '<option value="'.get_the_title().'" '.$is_selected.'>'.get_the_title().'</option>';
            endwhile; wp_reset_postdata();
            ?>
        </select>
    <?php   
}

add_action( 'save_post', 'ministry_select_save' );
function ministry_select_save( $post_id )
{
    // Stop If Autosaving
    if( defined( 'DOING_AUTOSAVE' ) && DOING_AUTOSAVE ) return;

    // Stop If Nonce Can't Be Verified
    if( !isset( $_POST['meta_box_nonce'] ) || !wp_verify_nonce( $_POST['meta_box_nonce'], 'my_meta_box_nonce' ) ) return;

    // Stop If Unauthorized User
    if( !current_user_can( 'edit_post' ) ) return;

    // Make Sure Data Is Set Then Save      
    if( isset( $_POST['pastor_select'] ) )
        update_post_meta( $post_id, 'pastor_select', esc_attr( $_POST['pastor_select'] ) );
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-15T05:20:16.480

要获取帖子的链接，您可以使用[get_permalink 函数](http://codex.wordpress.org/Function_Reference/get_permalink)

```
<?php $permalink = get_permalink( ); ?> 
```

或者如果你在循环之外，就像这样

```
<?php $permalink = get_permalink( $post->ID ); ?> 
```

您可以使用它在 HTML 代码的任何位置打印它。

如果您想要在下拉列表中选择帖子标题时转到帖子 URL，您可以使用 JavaScript 代码执行此操作，执行以下操作：

```
<select name="pastor_select" onchange='location=this.options[this.selectedIndex].value;'>
            <?php
            $args = array(
                'post_type' => 'employee',
                'position' => 'pastor'
            );
            $pastorList = new WP_Query($args); while ($pastorList->have_posts()) : $pastorList->the_post();
                $is_selected = (get_the_title() == $selected) ? 'selected="selected"' : '';
                echo '<option value="'.get_permalink( ).'" '.$is_selected.'>'.get_the_title().'</option>';
            endwhile; wp_reset_postdata();
            ?>
        </select> 
```

如果你想要保存一些 POST 信息，建议保存 POST 的 ID，以便稍后你可以检索该 POST 的任何数据，如果你想存储永久链接和标题，你可以结合函数 get_permalink(); 和 get_the_title(); 在选择“值”属性中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-15T21:45:13.493

所以我想出了一个不同的解决方案。我没有尝试保存数组，而是保存了帖子 ID，这将允许我访问帖子的标题以及永久链接。

这是我修改后的代码

```
<select name="pastor_select">
    <?php
    $args = array(
        'post_type' => 'employee',
        'position' => 'pastor'
    );
    $pastorList = new WP_Query($args); while ($pastorList->have_posts()) : $pastorList->the_post();
        $employeeID = get_the_ID(); // THIS FIXED THE PROBLEM
        $is_selected = ($employeeID == $selected) ? 'selected="selected"' : '';
        echo '<option value="'.$employeeID.'" '.$is_selected.'>'.get_the_title().'</option>';
    endwhile; wp_reset_postdata();
    ?>
</select> 
```

这就是我在前端的称呼

```
<?php 
$id = $post_meta_data['pastor_select'][0];
echo '<a href="'.get_permalink($id).'">';
echo get_the_title($id);
echo '</a>';
?> 
```

# css - 智能手机、平板电脑的纵向和横向查询

> ID：14329256
> 
> 赞同：0
> 
> 时间：2013-01-15T00:27:04.240
> 
> 标签：css, responsive-design, media-queries

我偶然发现了这篇文章：

[http://css-tricks.com/snippets/css/media-queries-for-standard-devices/](http://css-tricks.com/snippets/css/media-queries-for-standard-devices/)

它显示了各种@media 查询，我认为这些查询非常有用。但我有点困惑。它包括以下内容：

```
/* Smartphones (portrait and landscape) ----------- */
@media only screen 
and (min-device-width : 320px) 
and (max-device-width : 480px) {
/* Styles */
}

/* Smartphones (landscape) ----------- */
@media only screen 
and (min-width : 321px) {
/* Styles */
}

/* Smartphones (portrait) ----------- */
@media only screen 
and (max-width : 320px) {
/* Styles */
} 
```

我觉得很困惑，我应该使用其中的 3 个@media 查询还是只使用一个涵盖横向和纵向的查询。有人可以为我解释一下区别吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-20T05:53:41.143

在**第一个**查询中，您定义纵向和横向的样式。在**第二个**媒体查询中，您只需设置要在智能手机处于横向模式时应用的样式，**最后一个**查询是您要在其中输入智能手机样式的位置，其中智能手机处于纵向模式。为了更好地使用**响应式设计调整大小工具**进行测试，例如[http://lab.maltewassermann.com/viewport-resizer/](http://lab.maltewassermann.com/viewport-resizer/)

# c# - 属性初始化反模式

> ID：14329258
> 
> 赞同：2
> 
> 时间：2013-01-15T00:27:08.633
> 
> 标签：c#, design-patterns, initialization, anti-patterns

我一次又一次地得到沿这些行的代码，在那里我创建一些对象，然后循环它们以使用另一个类初始化一些属性......

```
ThingRepository thingRepos      = new ThingRepository();
GizmoProcessor  gizmoProcessor  = new GizmoProcessor();
WidgetProcessor widgetProcessor = new WidgetProcessor();

public List<Thing> GetThings(DateTime date)
{
    List<Thing> allThings = thingRepos.FetchThings();

    // Loops through setting thing.Gizmo to a new Gizmo
    gizmoProcessor.AddGizmosToThings(allThings);

    // Loops through setting thing.Widget to a new Widget
    widgetProcessor.AddWidgetsToThings(allThings);

    return allThings;
} 
```

...这只是，嗯，感觉不对。

1.  这是一个坏主意吗？
2.  是否有我在这里使用的反模式的名称？
3.  有哪些替代方案？

* * *

**编辑：**假设两者都`GizmoProcessor`必须`WidgetProcessor`进行一些计算，并从其他表中获取一些额外的数据。它们不仅仅是存储在存储库中的数据。他们正在基于每个创建新的 Gizmo 和小部件`Thing`，并将它们分配给`Thing`的属性。

这让我觉得奇怪的原因是它`Thing`不是一个自主的对象。它不能创建自己和子对象。它需要更高级别的代码来创建一个完全完成的对象。我不确定这是否是一件坏事！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-15T10:23:08.350

`ThingRepository`应该是获取`Thing`'s 集合的单一访问点，或者至少这是开发人员直观地查看的地方。因此，`GetThings(DateTime date)`应该由另一个对象提供感觉很奇怪。我宁愿把这个方法放在`ThingRepository`自己身上。

事实上，`Thing`返回的 's`GetThings(DateTime date)`是不同的，比返回的那些“更胖”的动物`ThingRepository.FetchThings()`也让人感到尴尬和违反直觉。如果`Gizmo`并且`Widget`确实是`Thing`实体的一部分，那么您应该能够在每次拥有 的实例时访问它们`Thing`，而不仅仅是`GetThings(DateTime date)`.

如果 Date 参数 in`GetThings()`不重要或可以在其他时间收集，我将使用计算属性 on来实现对and`Thing`的按需访问：`Gizmo``Widget`

```
public class Thing
{
  //...

  public Gizmo Gizmo
  {
    get 
    { 
       // calculations here 
    }
  }

  public Widget Widget
  {
    get 
    { 
       // calculations here 
    }
  }
} 
```

请注意，只要执行的计算成本不太高，这种方法就有效。不建议使用昂贵处理的计算属性 - 请参阅[http://msdn.microsoft.com/en-us/library/bzwdh01d%28VS.71%29.aspx#cpconpropertyusageguidelinesanchor1](http://msdn.microsoft.com/en-us/library/bzwdh01d%28VS.71%29.aspx#cpconpropertyusageguidelinesanchor1)

然而，这些计算不必在 getter 中内联实现——它们可以委托给第三方 Gizmo/Widget 处理器，可能带有缓存策略等。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-15T00:47:43.117

唯一真正的潜在问题是您多次迭代同一个循环，但如果您需要访问数据库以获取所有小工具和小部件，那么批量请求它们可能会更有效，因此传递完整列表添加到您的 Add... 方法将是有意义的。

另一种选择是考虑在第一个存储库调用中返回 gizmo 和小部件（假设它们位于同一个存储库中）。它可能会使查询更复杂，但它可能会更有效。当然，除非你在取东西时并不总是需要获取小工具和小部件。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-15T12:32:36.837

如果您有复杂的初始化，那么您可以使用策略模式。这是改编自此[策略模式概述​​的快速概述](http://www.remondo.net/strategy-pattern-example-csharp/)

创建一个策略接口来抽象初始化

```
public interface IThingInitializationStrategy
{
  void Initialize(Thing thing);
} 
```

策略可以使用的初始化实现

```
public class GizmosInitialization
{
  public void Initialize(Thing thing)
  {
     // Add gizmos here and other initialization
  }
}

public class WidgetsInitialization
{
  public void Initialize(Thing thing)
  {
    // Add widgets here and other initialization
  }
} 
```

最后是一个以抽象方式接受策略实现的服务类

```
internal class ThingInitalizationService
{
  private readonly IThingInitializationStrategy _initStrategy;

  public ThingInitalizationService(IThingInitializationStrategy initStrategy)
  {
     _initStrategy = initStrategy;
  }

  public Initialize(Thing thing)
  {
    _initStrategy.Initialize(thing);
  }
} 
```

然后您可以像这样使用初始化策略

```
var initializationStrategy = new GizmosInitializtion();
var initializationService = new ThingInitalizationService(initializationStrategy);

List<Thing> allThings = thingRepos.FetchThings();

allThings.Foreach ( thing => initializationService.Initialize(thing) ); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-16T11:01:35.477

要回答您的问题：

1.  **这是一个坏主意吗？**

    *   根据我的经验，在你需要改变它之前，你很少知道这是一个好主意还是坏主意。
    *   IMO，代码是：**过度设计**、设计**不足**或**不可读**
    *   同时，您尽最大努力并坚持最佳实践（KISS、单一责任等）
    *   就个人而言，我认为处理器类不应该修改任何事物的状态。
    *   我也不认为应该给处理器类一个要修改的东西的集合。
2.  **是否有我在这里使用的反模式的名称？**

    *   抱歉，帮不上忙。
3.  **有哪些替代方案？**

就个人而言，我会这样编写代码：

```
public List<Thing> GetThings(DateTime date)
{
    List<Thing> allThings = thingRepos.FetchThings();

    // Build the gizmo and widget for each thing
    foreach (var thing in allThings)
    {
        thing.Gizmo = gizmoProcessor.BuildGizmo(thing);
        thing.Widget = widgetProcessor.BuildWidget(thing);
    }

    return allThings;
} 
```

我的理由是：

1.  该代码位于“获取事物”的类中。所以从逻辑上讲，我认为遍历每个 Thing 对象并初始化它们是可以接受的。
2.  意图很明确：我`Thing`在返回它们之前初始化每个属性。
3.  `Thing`我更喜欢在中心位置初始化 的任何属性。
4.  我认为 gizmoProcessor 和 widgetProcessor 类不应该与 Collection of Things 有任何关系
5.  我更喜欢处理器有一种方法来构建和返回单个小部件/gizmo

但是，如果您的处理器类一次**构建**多个属性，那么我只会重构每个处理器的属性初始化。

```
public List<Thing> GetThings(DateTime date)
{
    List<Thing> allThings = thingRepos.FetchThings();

    // Build the gizmo and widget for each thing
    foreach (var thing in allThings)
    {
        // [Edited]
        // Notice a trend here: The common Initialize(Thing) interface
        // Could probably be refactored into some 
        // super-mega-complex Composite Builder-esque class should you ever want to
        gizmoProcessor.Initialize(thing);
        widgetProcessor.Initialize(thing);
    }

    return allThings;
} 
```

附言：

*   我个人不太关心（反）模式名称。
*   虽然它有助于在更高的抽象级别讨论问题，但我不会将每个（反）模式名称都提交给记忆。
*   当我遇到一个我认为有用的模式时，我只会记住它。
*   我很懒惰，我的理由是：如果我只使用少数，为什么还要记住每个模式和反模式？

[编辑]

注意到已经给出了关于使用策略服务的答案。

# c++ - “seekp”和“seekg”可以互换吗？

> ID：14329261
> 
> 赞同：27
> 
> 时间：2013-01-15T00:27:15.723
> 
> 标签：c++, position, binaryfiles, fstream

好吧，我刚刚注意到，通过“seekp”更改位置 - 在 microsoft Visual Studio 中，我在处理文件时也隐含地更改了读取位置。

但是，我想知道这是否是“便携式”行为？我可以期望阅读和写作的位置始终相同吗？因此：将`tellp`&`tellg`总是返回相同的值？

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2013-01-15T00:40:13.063

对于*文件位置*，它们是相同的。换句话说，只维护**一个**指针。

来自`27.9.1.1p3`：

> 为输入序列和输出序列维护一个联合文件位置。

因此，`seekg`并且`seekp`对于文件流是可互换的。但是，对于其他类型的流，情况并非如此，因为它们可能为 put 和 get 位置保存单独的指针。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2013-01-15T00:34:26.913

**更新：**所以从所有的评论和一切来看，似乎对于 fstream、seekp 和 seekg 使用相同的指针。但是对于 stringstream 和可能的其他非基于文件的流，它们是分开的。

* * *

**原帖：**

在带有 g++ 4.7.2 的 linux 上对我不起作用。他们似乎是独立的：

```
#include <sstream>
#include <iostream>

int main(int, char**) {
    std::stringstream s("0123456789");
    std::cout << "put pointer: " << s.tellp() << std::endl;
    std::cout << "get pointer: " << s.tellg() << std::endl;
    std::cout << std::endl;
    s.seekp(2);
    std::cout << "put pointer: " << s.tellp() << std::endl;
    std::cout << "get pointer: " << s.tellg() << std::endl;
    std::cout << std::endl;
    s.seekg(4);
    std::cout << "put pointer: " << s.tellp() << std::endl;
    std::cout << "get pointer: " << s.tellg() << std::endl;
    std::cout << std::endl;
} 
```

**输出：**

```
put pointer: 0
get pointer: 0

put pointer: 2
get pointer: 0

put pointer: 2
get pointer: 4 
```

* * *

此外，您描述的行为听起来不符合[此处](http://www.cplusplus.com/reference/istream/istream/seekg/)的引号：

> 设置获取指针的位置。获取指针确定要在与流关联的源中读取的下一个位置。

[在](http://www.cplusplus.com/reference/ostream/ostream/seekp/)这里：

> 设置放置指针的位置。put 指针确定输出序列中下一个输出操作将发生的位置。

# r - mapply 和两个列表

> ID：14329264
> 
> 赞同：6
> 
> 时间：2013-01-15T00:27:37.020
> 
> 标签：r, list, apply

我正在尝试使用 mapply 来组合两个列表（A 和 B）。每个元素都是一个数据框。我正在尝试将 A 中的数据帧绑定到 B 中的相应数据帧。以下返回我想要的组合 1：

```
num = 10
A<-list()
B<-list()
for (j in 1:num){
    A[[j]] <- as.data.frame(matrix(seq(1:9),3,3))
    B[[j]] <- as.data.frame(matrix(seq(10:18),3,3))
}

combo1<-list()
for (i in 1:num){
    combo1[[i]] <-rbind(A[[i]], B[[i]])  
} 
```

我正在尝试使用 mapply 来做同样的事情，但我无法让它工作：

```
combo2<-list()
combo2<-mapply("rbind", A, B) 
```

我希望有人可以帮助我

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-01-15T00:41:33.393

你很亲近！

```
## Make this a more _minimal_ reproducible example
A <- A[1:2]
B <- B[1:2]

## Override default attempt to reduce results to a vector, matrix, or other array
mapply("rbind", A, B, SIMPLIFY=FALSE)
# [[1]]
#   V1 V2 V3
# 1  1  4  7
# 2  2  5  8
# 3  3  6  9
# 4  1  4  7
# 5  2  5  8
# 6  3  6  9
# 
# [[2]]
#   V1 V2 V3
# 1  1  4  7
# 2  2  5  8
# 3  3  6  9
# 4  1  4  7
# 5  2  5  8
# 6  3  6  9 
```

# jquery - jQuery UI 工具提示 - 在 event.stopImmediatePropagation 之后手动关闭，没有效果？

> ID：14329265
> 
> 赞同：1
> 
> 时间：2013-01-15T00:27:39.140
> 
> 标签：jquery, jquery-ui, javascript-events, event-handling

[http://jsfiddle.net/r2nzc/5/](http://jsfiddle.net/r2nzc/5/)

```
var $textInput = $('#textInput');
var items = '.ui-autocomplete li.ui-menu-item a';

$textInput.autocomplete({
  source: ['a', 'b', 'c'],
  minLength: 0,
  open: function(){
    $('body').tooltip({
      items: items,
      content: 'Hello!'
    });

    $(items).mouseout(function(event){
        event.stopImmediatePropagation();
        $('body').tooltip('close');
    });
  }
}).focus(function(){
    $(this).autocomplete('search', '');
}); 
```

我正在尝试覆盖 jQuery UI 的工具提示自动关闭功能。我的意图是能够将鼠标悬停在工具提示上而不关闭它，但尚未引入此功能。因此，我正试图破解它。

我的理解是我应该能够调用 event.stopImmediatePropagation 以防止工具提示在 mouseleave 事件后关闭。但是，这将使工具提示永远打开。所以，我需要手动关闭工具提示。

如果我在工具提示上调用“destroy”，我可以强制它立即关闭。这似乎是一个丑陋的解决方法，因为我没有很好地淡出工具提示。

不确定如何调试为什么关闭似乎不起作用。工具提示是否跟踪其内部状态？

# ruby-on-rails - 如何验证模型中控制器的数据？

> ID：14329267
> 
> 赞同：0
> 
> 时间：2013-01-15T00:27:55.377
> 
> 标签：ruby-on-rails, ruby, model-view-controller

我的控制器中有从另一个 Rails 应用程序和数据库接收的数据（[这](https://stackoverflow.com/questions/14309688/how-to-validate-in-a-model-data-from-a-controller)**必须在控制器中**）一些代码示例的[问题）](https://stackoverflow.com/questions/14309688/how-to-validate-in-a-model-data-from-a-controller)

**我的问题**是我无法直接从模型中的控制器中获取这些数据，因为这违反了 MVC。

**我的问题**是我将如何检查模型中的控制器数据？

*   我是否必须在视图中加载此数据/真 - 假响应，然后将其链接到我的模型？（我真的不希望它显示在视图中，并且还没有完全弄清楚如何做到这一点）

*   我是否需要将此数据传递给路由`example/data.json`，然后在我的模型中检查它？（我还没有弄清楚如何在我的模型中使用这个 data.json）

任何朝着正确方向的帮助/转向都会非常有用。（**我也不能用宝石来做到这一点**）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-15T01:47:27.703

首先，请确保您不会通过模型本身不包含的数据来验证模型。模型应该验证它的当前状态，而**不是**它进入这个状态的方式（例如，哪个用户将模型置于这个状态）。

其次，你不应该在模型中使用控制器方法。如果控制器包含一些业务逻辑，则将该逻辑提取到第三个类中，控制器和模型都将使用该类。

此外，您在控制器中有数据并且可以访问模型，对吗？因此，如果您在控制器方法中，例如在过滤器或操作之前，您可以获取该数据并将其传递给模型，如下所示：

```
def controller method
  hey_model.is_this_correct?(data)
end 
```

如果您说必须在控制器响应请求**后**检查该数据（例如，在下一个向导步骤，即在下一个请求时），那么您肯定必须在请求之间的某个位置存储该值。

这正是无状态 HTTP 的重点。在您明确执行此操作之前，不会在请求之间保存任何数据。您可以将您的值存储在 cookie 或数据库中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2020-03-17T01:49:58.920

我知道这个问题是不久前的问题，但对于那些仍在搜索的人，我找到了确切的答案，即如何将信息从控制器传递到模型。

有了这条线，一切都解决了

```
var = request.env['target_model'].sudo().function_in_your_model(data) 
```

`var`是一个变量，以防您需要在控制器中处理该数据，`target_model`是您要发送数据的模型，`function_in_your_model`是您要处理模型中已有数据的函数，并且在此函数中发送数据你需要的。

# android - 从数据库获取数据时出现 NullPointerException

> ID：14329270
> 
> 赞同：0
> 
> 时间：2013-01-15T00:28:19.623
> 
> 标签：android, multithreading, nullpointerexception

我以前在同步数据库上制作了工作源代码，但现在突然不工作了。在这里，我试图在`DB_User`课堂上读取我在本地数据库中的记录。但它回来了`java.lang.NullPointerException`。所以这就是我做的。

这是我的错误的堆栈跟踪

```
01-15 06:42:20.080: I/ActivityManager(60): Displayed activity com.yolanda.ta/.DBSynchronizer: 387 ms (total 387 ms)
01-15 06:42:40.639: D/dalvikvm(1147): GC_FOR_MALLOC freed 2008 objects / 125592 bytes in 74ms
01-15 06:43:21.149: D/dalvikvm(1147): GC_FOR_MALLOC freed 777 objects / 219464 bytes     in 79ms
01-15 06:44:02.018: D/dalvikvm(1147): GC_FOR_MALLOC freed 830 objects / 404856 bytes     in 67ms
01-15 06:44:35.578: D/dalvikvm(1147): GC_FOR_MALLOC freed 830 objects / 404976 bytes in 78ms
01-15 06:44:58.399: W/dalvikvm(1147): threadid=7: thread exiting with uncaught exception (group=0x4001d800)
01-15 06:44:58.411: E/AndroidRuntime(1147): FATAL EXCEPTION: Thread-8
01-15 06:44:58.411: E/AndroidRuntime(1147): java.lang.NullPointerException
01-15 06:44:58.411: E/AndroidRuntime(1147):     at com.yolanda.ta.ThreadUser.fetchLocal(ThreadUser.java:192)
01-15 06:44:58.411: E/AndroidRuntime(1147):     at com.yolanda.ta.ThreadUser.run(ThreadUser.java:59)
01-15 06:44:58.492: W/ActivityManager(60):   Force finishing activity com.yolanda.ta/.DBSynchronizer 
```

这是 fetchLocal() 从数据库中获取数据，我称之为从本地数据库中获取数据

```
public String[] fetchLocal (int column)
{
Cursor user = mDbHelper.getAllRow3();
    String Result[] = new String[user.getCount()];
    user.moveToFirst();
    int i = 0;
    while (user.isAfterLast() == false) {
        Result[i++] = user.getString(column);
        user.moveToNext();
    }
    user.close();
    return Result;
} 
```

这是 getAllRow3(​​) 的方法

```
public Cursor getAllRow3()
{
Cursor c = db.query(NAMA_TABEL, new String[]{ROW_ID, ROW_NAMAL, ROW_NAMA, ROW_PW, ROW_ALAMAT, ROW_TELEPON, ROW_LEVEL, ROW_STATUS,ROW_TIME}, null, null, null, null, null, null);
return c;
} 
```

这是我的表结构

```
public class DB_User {
private static final String ROW_ID = "IDUser";
private static final String ROW_NAMAL = "NamaLogin";
private static final String ROW_NAMA ="NamaUser";
private static final String ROW_PW ="PasswordUser";
private static final String ROW_ALAMAT ="AlamatUser";
private static final String ROW_TELEPON ="TeleponUser";
private static final String ROW_LEVEL ="LevelUser";
private static final String ROW_STATUS ="StatusUser";
private static final String ROW_TIME ="Waktu";

private static final String NAMA_DB = "TA";
private static final String NAMA_TABEL = "User";
private static final int DB_VERSION = 1;
private static int batas = 5;
private static final String CREATE_TABLE = "create table if not exists "+ NAMA_TABEL +" ("+ ROW_ID +" INTEGER PRIMARY KEY AUTOINCREMENT," +
        ROW_NAMAL +" VARCHAR not null, "+ ROW_NAMA +" VARCHAR not null, " + ROW_PW + " VARCHAR not null, " + ROW_ALAMAT + " VARCHAR not null, " 
        + ROW_TELEPON + " VARCHAR, "+ ROW_LEVEL+ " VARCHAR not null, "  + ROW_STATUS + " INTEGER not null, "+ROW_TIME+"  LONG not null)"; 
```

我不知道，因为其他活动可以使用相同的查询获得完全相同的数据，而我的线程却不能。欢迎任何建议。

编辑：第 192`Cursor user = mDbHelper.getAllRow3();` 行：第 59 行：`String[] LocalRowID = fetchLocal(0);`

这是我的 ThreadUser 代码：

```
public class ThreadUser  extends Thread implements Runnable {

private boolean RunSync = false;     
private DB_User mDbHelper;
private long sleeptime;

public void setDatabase(DB_User mDbHelper)
{
    this.mDbHelper = mDbHelper;
}

public void setRun(boolean set)
{
    RunSync = set;
}

public void setDelay(long delay)
{
    sleeptime = delay;
}

@Override
public void run()
{
    while(RunSync)
    {
    String[] RemoteID = fetch("http://10.0.2.2/project/User.php?ct=Sel_IDUser");
    String[] RemoteNamaL = fetch("http://10.0.2.2/project/User.php?ct=Sel_NamaLogin");
    String[] RemoteNama = fetch("http://10.0.2.2/project/User.php?ct=Sel_NamaUser");
    String[] RemotePassword = fetch("http://10.0.2.2/project/User.php?ct=Sel_PasswordUser");
    String[] RemoteAlamat = fetch("http://10.0.2.2/project/User.php?ct=Sel_AlamatUser");
    String[] RemoteTelepon = fetch("http://10.0.2.2/project/User.php?ct=Sel_TeleponUser");
    String[] RemoteLevel = fetch("http://10.0.2.2/project/User.php?ct=Sel_LevelUser");
    String[] RemoteStatus = fetch("http://10.0.2.2/project/User.php?ct=Sel_StatusUser");
    String[] RemoteTime = fetch("http://10.0.2.2/project/User.php?ct=Sel_Waktu");
    //ROW_ID, ROW_NAMAL, ROW_NAMA, ROW_PW, ROW_ALAMAT, ROW_TELEPON, ROW_LEVEL, ROW_STATUS,ROW_TIME
    String[] LocalRowID = fetchLocal(0);
    String[] LocalNamaL = fetchLocal(1);
    String[] LocalNama = fetchLocal(2);
    String[] LocalPassword = fetchLocal(3);
    String[] LocalAlamat = fetchLocal(4);
    String[] LocalTelepon = fetchLocal(5);
    String[] LocalLevel = fetchLocal(6);
    String[] LocalStatus = fetchLocal(7);
    String[] LocalTime = fetchLocal(8);

    Calendar cal = Calendar.getInstance();;

    for(int i = 1; i <  RemoteID.length; i++)
    { Log.e("index remote1", Integer.toString(i));
        for(int j = 0; j < LocalRowID.length; j++)
        {
            Log.e("indexlocal1", Integer.toString(j));
            if(RemoteID[i].equalsIgnoreCase(LocalRowID[j]))
            {                   
                if(Long.parseLong(RemoteTime[i]) > Long.parseLong(LocalTime[j]))
                {
                    // //id, namal, nama, alamat, password, telepon, level, status, time
                    mDbHelper.updateBaris2(Integer.parseInt(LocalRowID[j]), RemoteNamaL[i],
                            RemoteNama[i], RemoteAlamat[i],RemotePassword[i], 
                            RemoteTelepon[i], RemoteLevel[i], Integer.parseInt(RemoteStatus[i]), cal.getTimeInMillis());
                    break;
                }
                else if (Long.parseLong(RemoteTime[i]) < Long.parseLong(LocalTime[j]))
                {
                    call("http://10.0.2.2/project/User.php?ct=EDT&namal="+LongData(LocalNamaL[j].toString())+
                            "&nama="+LongData(LocalNama[j].toString())+"&pw="+LongData(LocalPassword[j].toString())+"&alamat="+LongData(LocalAlamat[j].toString())+
                            "&telepon="+LongData(LocalTelepon[j].toString())+"&level="+LongData(LocalLevel[j].toString())+"&status="+LocalStatus[j]+"&time="
                            +cal.getTimeInMillis()+"&id="+LocalRowID[j].toString());

                    break;
                }
            }   
        }
        if (LocalRowID.length + 1 > RemoteID.length)
        {//namal, nama, alamat, password, telepon, level, status, time
            try{
            call("http://10.0.2.2/project/User.php?ct=INS&namal="+LongData(LocalNamaL[LocalRowID.length-1].toString())+
                    "&nama="+LongData(LocalNama[LocalRowID.length-1].toString())+"&pw="+LongData(LocalPassword[LocalRowID.length-1].toString())+"&alamat="+LongData(LocalAlamat[LocalRowID.length-1].toString())+
                    "&telepon="+LongData(LocalTelepon[LocalRowID.length-1].toString())+"&level="+LongData(LocalLevel[LocalRowID.length-1].toString())+"&status="+LocalStatus[LocalRowID.length-1]+"&time="
                    +cal.getTimeInMillis());    
            Log.e("nambah server","voila");
            break;
            }
            catch (Exception e){Log.e("walah",e.toString());}
        }
        else
        if (LocalRowID.length == RemoteID.length)
        {
            break;
        }
    }

    for(int i = 0; i < LocalRowID.length-1; i++)
    { Log.e("index local2", Integer.toString(i));
        if(RemoteID.length <= 1)
        {
            try{
            call("http://10.0.2.2/project/User.php?ct=INS&namal="+LongData(LocalNamaL[i].toString())+
                    "&nama="+LongData(LocalNama[i].toString())+"&pw="+LongData(LocalPassword[i].toString())+"&alamat="+LongData(LocalAlamat[i].toString())+
                    "&telepon="+LongData(LocalTelepon[i].toString())+"&level="+LongData(LocalLevel[i].toString())+"&status="+LocalStatus[i]+"&time="
                    +cal.getTimeInMillis()+"&id="+LocalRowID[i].toString());
            }
            catch(Exception e){
            Log.e("wooooy", e.toString());
            }
            }

        for(int j = 1; j < RemoteID.length; j++)
        {
            Log.e("indexremote2", Integer.toString(j));
            if(LocalRowID[i].equalsIgnoreCase(RemoteID[j]))
            {
                break;
            } 
            if (LocalRowID.length ==  RemoteID.length)
            {
                break;
            }

        }

        if (RemoteID.length-1 > LocalRowID.length)
        {
            i-=1;
        try{
                mDbHelper.addRow2(RemoteNamaL[RemoteID.length-1], RemoteNama[RemoteID.length-1], RemoteAlamat[RemoteID.length-1], RemotePassword[RemoteID.length-1],
                        RemoteTelepon[RemoteID.length-1],   RemoteLevel[RemoteID.length-1], Integer.parseInt(RemoteStatus[RemoteID.length-1]), cal.getTimeInMillis());
                break;
            }
            catch(Exception e){
                Log.e("wuuuy", e.toString());
                }
        }
        if (LocalRowID.length ==  RemoteID.length)
        {
            break;
        }

    }

    try {
        sleep(sleeptime);
    } catch (InterruptedException e) {
        break;
    }
    }
}

public String LongData (String Data)
{
    String LongData ="";

    for (int i = 0; i < Data.length(); i++) 
    {
        if (Data.charAt(i)==' ') 
        {
            LongData += '~';
        }
        else            
            LongData += Data.charAt(i);
    }
    return LongData;
}

public String[] fetchLocal (int column)
{
    Cursor user = mDbHelper.getAllRow3();       
    String Result[] = new String[user.getCount()];
    user.moveToFirst();
    int i = 0;
    while (user.isAfterLast() == false) {
        Result[i++] = user.getString(column);
        user.moveToNext();
    }
    user.close();

    return Result;
}

public String[] fetch(String url)
{        
    HttpClient httpclient = new DefaultHttpClient();
    HttpRequestBase httpRequest = null;
    HttpResponse httpResponse = null;
    InputStream inputStream = null;
    String response = "";
    StringBuffer buffer = new StringBuffer();
    httpRequest = new HttpGet(url);

    try
    {
        httpResponse = httpclient.execute(httpRequest);
    }
    catch (ClientProtocolException el)
    {
        el.printStackTrace();
    }
    catch (IOException el)
    {
        el.printStackTrace();
    }

    try
    {
        inputStream = httpResponse.getEntity().getContent();
    }
    catch (IllegalStateException el)
    {
        el.printStackTrace();
    }
    catch (IOException el)
    {
        el.printStackTrace();
    }

    byte[] data = new byte[512];
    int len = 0;

    try
    {
        while(-1 != (len = inputStream.read(data)))
        {
            buffer.append(new String(data,0,len));
        }
    }
    catch (IOException el)
    {
        el.printStackTrace();
    }

    try
    {
        inputStream.close();
    }
    catch (IOException el)
    {
        el.printStackTrace();
    }

    response = buffer.toString();
    StringParser parser = new StringParser();
    ArrayList<Object> output = parser.Parse(response);
    Object[] Output = output.toArray();
    String[] content = new String[Output.length];

    for (int i = 0; i < content.length; i++)
    {
        content[i] = Output[i].toString();
    }

    return content;
}

public String call(String url)
{
    int BUFFER_SIZE = 2000;
    InputStream in = null;

    try
    {
        in = OpenHttpConnection(url);
    }
    catch (IOException el) {
        el.printStackTrace();
        return "Error: " + el.getMessage();
    }

    InputStreamReader isr = new InputStreamReader(in);
    int charRead;

    String str = "";
    char[] inputBuffer = new char[BUFFER_SIZE];

    try
    {
        while((charRead = isr.read(inputBuffer)) > 0)
        {
            String readString = String.copyValueOf(inputBuffer, 0, charRead);
            str += readString;
            inputBuffer = new char[BUFFER_SIZE];
        }
        in.close();
    }
    catch (IOException e)
    {
        e.printStackTrace();
        return "Error 02";
    }
    return str;
}

private InputStream OpenHttpConnection(String urlString) throws IOException
{
    InputStream in = null;
    int response = -1;

    URL url = new URL(urlString);
    URLConnection conn = url.openConnection();

    if(!(conn instanceof HttpURLConnection)) throw new IOException("Not an Http Connection");

    try
    {
        HttpURLConnection httpConn = (HttpURLConnection) conn;
        httpConn.setAllowUserInteraction(false);
        httpConn.setInstanceFollowRedirects(true);
        httpConn.setRequestMethod("GET");
        httpConn.connect();

        response = httpConn.getResponseCode();
        if(response == HttpURLConnection.HTTP_OK) {
            in = httpConn.getInputStream();
        }
    }
    catch (Exception e)
    {
        throw new IOException("Error Connecting");
    }
    return in;
} 
```

}`

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-15T01:52:09.300

首先，你的代码没有代码行号，所以我们不知道哪一行是“ThreadUser.java:192”和“ThreadUser.java:59”。

实际上这个问题可能是同步问题，请提供更多关于 TheadUser.java 代码的代码细节。如果是这样，请将同步添加到方法或同步块以解决此问题。

# django - Django选择不同的没有正确返回

> ID：14329281
> 
> 赞同：1
> 
> 时间：2013-01-15T00:29:55.483
> 
> 标签：django, django-models, model

您好，我正在一个网站上工作，并且有一个问题，为什么它会返回原来的样子？

我想从 {table} 中选择不同的“类别”

我尝试了有和没有 Flat = True

```
In [27]: q = EyeMakeUpWaxing.objects.values_list('category', flat=True).distinct()

In [28]: print q.query
SELECT DISTINCT `eye_make_up_waxing`.`category`, `eye_make_up_waxing`.`created_at` FROM `eye_make_up_waxing` ORDER BY `eye_make_up_waxing`.`created_at` ASC

In [29]: print q
[u'EYE_BEAUTIFICATION', u'EYE_BEAUTIFICATION', u'EYE_BEAUTIFICATION', u'MAKE_UP', u'MAKE_UP', u'MAKE_UP', u'MAKE_UP', u'ENHANCER_ADD_ON', u'ENHANCER_ADD_ON', u'ENHANCER_ADD_ON', u'ENHANCER_ADD_ON', u'ENHANCER_ADD_ON', u'ENHANCER_ADD_ON', u'ENHANCER_ADD_ON'] 
```

如果这不是这个请帮助获得正确的 django 语法

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-15T00:38:20.893

那里有一个排序语句导致问题（来自您的模型/其他地方定义的默认排序）。

通过清除订购`order_by()`

```
EyeMakeUpWaxing.objects.order_by().values_list('category', flat=True).distinct() 
```

排序迫使 SELECT created_at 使每个条目都不同。

[https://docs.djangoproject.com/en/dev/ref/models/querysets/#distinct](https://docs.djangoproject.com/en/dev/ref/models/querysets/#distinct)

# java - Android ADT全屏项目向导相关接口Java使用方法

> ID：14329284
> 
> 赞同：3
> 
> 时间：2013-01-15T00:30:38.907
> 
> 标签：java, android, interface, adt

随着新外观的 Android ADT（Android 开发者工具）有一些新的项目向导，它们比我习惯的旧的 hello world 模板更进一步，我试图理解它们，但发现它真的很困难。

我正在查看全屏项目向导。

`enter code here`当您使用此向导创建项目时，它将创建一个包含文件 SystemUIHider.java 的 util 库。

这是问题。

我懂了：

```
protected OnVisibilityChangeListener mOnVisibilityChangeListener = sDummyListener; 
```

它调用了类文件底部的接口：

```
public interface OnVisibilityChangeListener {

        public void onVisibilityChange(boolean visible);
    } 
```

我的问题是：

1）我认为必须扩展接口，那么这段代码有什么实际用途？

2）如果 OnVisibilityChangeListener 是一个接口而不是严格来说是一个类，这怎么可能？

```
 private static OnVisibilityChangeListener sDummyListener = new OnVisibilityChangeListener() {
        @Override
        public void onVisibilityChange(boolean visible) {
        }
    }; 
```

谢谢 ！

```
package com.example.test2.util;

import android.app.Activity;
import android.os.Build;
import android.view.View;

public abstract class SystemUiHider {
    /**
     * When this flag is set, the
     * {@link android.view.WindowManager.LayoutParams#FLAG_LAYOUT_IN_SCREEN}
     * flag will be set on older devices, making the status bar "float" on top
     * of the activity layout. This is most useful when there are no controls at
     * the top of the activity layout.
     * <p>
     * This flag isn't used on newer devices because the <a
     * href="http://developer.android.com/design/patterns/actionbar.html">action
     * bar</a>, the most important structural element of an Android app, should
     * be visible and not obscured by the system UI.
     */
    public static final int FLAG_LAYOUT_IN_SCREEN_OLDER_DEVICES = 0x1;

    /**
     * When this flag is set, {@link #show()} and {@link #hide()} will toggle
     * the visibility of the status bar. If there is a navigation bar, show and
     * hide will toggle low profile mode.
     */
    public static final int FLAG_FULLSCREEN = 0x2;

    /**
     * When this flag is set, {@link #show()} and {@link #hide()} will toggle
     * the visibility of the navigation bar, if it's present on the device and
     * the device allows hiding it. In cases where the navigation bar is present
     * but cannot be hidden, show and hide will toggle low profile mode.
     */
    public static final int FLAG_HIDE_NAVIGATION = FLAG_FULLSCREEN | 0x4;

    /**
     * The activity associated with this UI hider object.
     */
    protected Activity mActivity;

    /**
     * The view on which {@link View#setSystemUiVisibility(int)} will be called.
     */
    protected View mAnchorView;

    /**
     * The current UI hider flags.
     * 
     * @see #FLAG_FULLSCREEN
     * @see #FLAG_HIDE_NAVIGATION
     * @see #FLAG_LAYOUT_IN_SCREEN_OLDER_DEVICES
     */
    protected int mFlags;

    /**
     * The current visibility callback.
     */
    protected OnVisibilityChangeListener mOnVisibilityChangeListener = sDummyListener;

    /**
     * Creates and returns an instance of {@link SystemUiHider} that is
     * appropriate for this device. The object will be either a
     * {@link SystemUiHiderBase} or {@link SystemUiHiderHoneycomb} depending on
     * the device.
     * 
     * @param activity The activity whose window's system UI should be
     *            controlled by this class.
     * @param anchorView The view on which
     *            {@link View#setSystemUiVisibility(int)} will be called.
     * @param flags Either 0 or any combination of {@link #FLAG_FULLSCREEN},
     *            {@link #FLAG_HIDE_NAVIGATION}, and
     *            {@link #FLAG_LAYOUT_IN_SCREEN_OLDER_DEVICES}.
     */
    public static SystemUiHider getInstance(Activity activity, View anchorView, int flags) {
        if (Build.VERSION.SDK_INT >= Build.VERSION_CODES.HONEYCOMB) {
            return new SystemUiHiderHoneycomb(activity, anchorView, flags);
        } else {
            return new SystemUiHiderBase(activity, anchorView, flags);
        }
    }

    protected SystemUiHider(Activity activity, View anchorView, int flags) {
        mActivity = activity;
        mAnchorView = anchorView;
        mFlags = flags;
    }

    /**
     * Sets up the system UI hider. Should be called from
     * {@link Activity#onCreate}.
     */
    public abstract void setup();

    /**
     * Returns whether or not the system UI is visible.
     */
    public abstract boolean isVisible();

    /**
     * Hide the system UI.
     */
    public abstract void hide();

    /**
     * Show the system UI.
     */
    public abstract void show();

    /**
     * Toggle the visibility of the system UI.
     */
    public void toggle() {
        if (isVisible()) {
            hide();
        } else {
            show();
        }
    }

    /**
     * Registers a callback, to be triggered when the system UI visibility
     * changes.
     */
    public void setOnVisibilityChangeListener(OnVisibilityChangeListener listener) {
        if (listener == null) {
            listener = sDummyListener;
        }

        mOnVisibilityChangeListener = listener;
    }

    /**
     * A dummy no-op callback for use when there is no other listener set.
     */
    private static OnVisibilityChangeListener sDummyListener = new OnVisibilityChangeListener() {
        @Override
        public void onVisibilityChange(boolean visible) {
        }
    };

    /**
     * A callback interface used to listen for system UI visibility changes.
     */
    public interface OnVisibilityChangeListener {
        /**
         * Called when the system UI visibility has changed.
         * 
         * @param visible True if the system UI is visible.
         */
        public void onVisibilityChange(boolean visible);
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-15T00:50:39.757

```
private static OnVisibilityChangeListener sDummyListener = new OnVisibilityChangeListener() {
        @Override
        public void onVisibilityChange(boolean visible) {
        // Implementation here.
        }
}; 
```

上面的代码片段创建并实例化了一个匿名类，该类`OnVisibilityChangeListener`通过提供接口中定义的函数的实现来实现。

匿名类旨在用于您需要不会被重用的特定实现的地方。也就是说，如果上面的类只在一个地方实例化，就没有理由给它一个名字，只需使用一个匿名类。通常，匿名类在使用它们的位置被内联实例化，例如：

```
protected OnVisibilityChangeListener mOnVisibilityChangeListener = new OnVisibilityChangeListener() {
        @Override
        public void onVisibilityChange(boolean visible) { }
}; 
```

或作为函数的参数，如以下代码片段：

```
something.setOnVisibilityChangeListener(new OnVisibilityChangeListener() {
        @Override
        public void onVisibilityChange(boolean visible) { }
}); 
```

# objective-c - 需要帮助操作模板（来自 Cartoonsmart 的波攻击）

> ID：14329285
> 
> 赞同：2
> 
> 时间：2013-01-15T00:30:41.607
> 
> 标签：objective-c, xcode, templates, cocos2d-iphone

首先，我在编程方面的知识为零......我只是想在我被行话轰炸之前先这么说哈哈。我是一名插画家、动态图形艺术家和动画师，试图制作他们的第一款游戏。这个游戏涵盖了所有的艺术作品......我计划重新设计所有东西 100% 看起来在任何层面上都不像 Cartoonsmarts。

太伤心了……哈哈

如果您不熟悉此模板，您可以查看我在[https://vimeo.com/34988233#at=1购买的 Wave Attack 模板的简要概述](https://vimeo.com/34988233#at=1)

我需要做的是：

1.  将游戏旋转到敌人从右边来的地方，而玩家则留在左边。这意味着将菜单更改为顶部的横向。

2.  将“波浪”变成关卡……我想要 5 个世界，每个世界有 4 个关卡。我有 5 种不同的背景来展示世界的变化。

3.  每次世界变化都会添加一组新的敌人。我为每个世界都覆盖了所有精灵。

4.  添加菜单屏幕！哈哈模板不包括一个，直接跳进游戏。

5.  最后，我需要用一个图像幻灯片从一个图像到另一个图像淡化来划分世界，在一本插图漫画书中大约有 2-3 个图像来解释到下一个世界的过渡。

如果有人知道如何做这些事情或以任何方式帮助我，请通过 Skype (the25thPixel) 与我联系

我也愿意在某人可能正在从事的任何项目中使用一些插图、图形或动画进行交易。我的网站是 25thPixel.com ... 请看一看，我打算通过一款看起来很棒的有趣游戏来真正展示我的技能。

我随时待命，同时将从事图形工作。我希望很快能收到你们中的一些人的消息……模板的创建者通过他的教程视频向我推荐了这个网站，所以希望这是发布的正确位置。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-15T01:08:57.380

这并不是一个真正的自由职业者/招聘网站，尽管您实际上只是在寻求帮助而不是一个完整的项目，所以这可能没问题。在学习如何做你概述的事情方面，准备在项目上投入更多的时间。您想要做的一些事情，例如将游戏和菜单的方向更改为横向以及添加主菜单，应该相当简单，尽管在本网站有限的空间中很难解释。在我看来，遵循 Cocos2d 的初学者教程是你最好的选择。

一些应该有帮助的例子：

[Cocos2d - 设置设备/屏幕方向](https://stackoverflow.com/questions/5792706/cocos2d-setting-device-screen-orientation) （游戏方向）

[http://www.reigndesign.com/blog/creating-a-simple-menu-with-scene-transition-in-cocos2d/](http://www.reigndesign.com/blog/creating-a-simple-menu-with-scene-transition-in-cocos2d/) （主菜单和不同级别）

[http://www.raywenderlich.com/352/how-to-make-a-simple-iphone-game-with-cocos2d-tutorial](http://www.raywenderlich.com/352/how-to-make-a-simple-iphone-game-with-cocos2d-tutorial) （您正在寻找的**最佳**资源 - 应该可以帮助您创建多种敌人类型，并对模板的各个部分有基本的了解）

此外，您可能已经知道 Google 是您最好的朋友。如果您不确定要查找什么，请举几个例子：（顺便说一下，请记住您的模板在 Cocos2d 中，您应该特别查找有关该信息的信息）

**场景**将允许您创建菜单、世界之间的“幻灯片过渡”等。非常非常重要。

**CCSprite**是你的船和你的敌人最有可能基于的东西。有时也用于添加 UI 元素。

我希望你能够完成你想做的事情，并且可能会在此过程中获得一些编程知识。此外，优秀的作品集——你有一些非常令人印象深刻的作品。

干杯，

XenElement

# silverlight - 安装 BitDefender 2013 后 Internet Explorer 无法运行 Silverlight 应用程序

> ID：14329292
> 
> 赞同：0
> 
> 时间：2013-01-15T00:31:54.510
> 
> 标签：silverlight, antivirus

我不知道这里发生了什么。我所知道的是，我的 silverlight Web 应用程序在 12 月部署后运行良好，现在当我打开我的项目并运行它时，它会因检查清单错误而死：

错误：Silverlight 应用程序代码中未处理的错误：2103
类别：InitializeError
消息：无效或格式错误的应用程序：检查清单

我知道那个愚蠢的错误，相信我，我没有改变任何东西（没有名字，没有命名空间，什么都没有）

在 fiddler 中稍微摆弄一下，每次加载应用时都找不到以下 2 个文件：

/B1D671CF-E532-4481-99AA-19F420D90332/netdefender/hui/ndhui.css

和

/B1D671CF-E532-4481-99AA-19F420D90332/netdefender/hui/ndhui.js?0=0&0=0&0=0

我不熟悉这些文件，并且在我的应用程序的任何区域都没有引用它们。我现在想知道最近安装的 BitDefender 2013 是否与它有关，或者可能是最近更新了 .NET 框架 4.0 的 Windows 更新。我尝试编辑反网络钓鱼功能，实际上我关闭了 BitDefender 中的所有功能，但无济于事。如果有人知道该怎么做，我将非常感谢您的提示。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-29T04:18:36.923

好吧，毕竟我是对的。BitDefender 有过错。我终于下定决心，决定卸载bitDefender 2013。于是我运行了我用来卸载bitDefender 2012的BitDefender卸载工具。它似乎已经完成了这个过程，然后按预期要求重新启动以完成卸载。我没有意识到只有专门为bitDefender 2013制作的卸载工具才能卸载它。因此，重新启动后 bitDefender 2013 仍然存在并且运行良好。但是，现在不同的是，Visual Studio 调试我的应用程序没有问题，我的浏览器在本地或外部加载我的 Silverlight 应用程序也没有任何问题。

奇怪的？相信它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-15T07:28:29.477

从错误代码 2103 来看，清单文件似乎存在问题。很可能您已经更改了命名空间。这里有 4 个可能有用的链接。

[MSDN 博客](http://blogs.msdn.com/b/alvarod/archive/2010/11/14/error-unhandled-error-in-silverlight-application-code-2103-category-initializeerror-message-invalid-or-malformed-application-check-manifest.aspx)

[另一个 MSDN 博客](http://blogs.msdn.com/b/narend/archive/2009/10/21/silverlight-3-error-unhandled-error-in-silverlight-application-code-2103-category-initializeerror-message-invalid-or-malformed-application-check-manifest.aspx)

[代码项目](http://www.codeproject.com/Tips/393604/Error-2103-Unhandled-Error-in-Silverlight-Applicat)

[StackOverflow 线程](https://stackoverflow.com/questions/1793877/silverlight-application-doesnt-run-i-get-an-invalid-or-malformed-application-e)

# android - Android - Imageviews 使它们再次可见，不工作

> ID：14329293
> 
> 赞同：1
> 
> 时间：2013-01-15T00:32:07.177
> 
> 标签：android, visible

我的 ImageView 有问题。在某个时间，我将其禁用并使其不可见。稍后在程序中，但它们应该重新启用并可见。不幸的是，它不起作用。经常尝试用调试器找bug，但是没有跳过对应的代码。然而，应用程序中的按钮不可见或不启用。即使是动画drawable也不会启动，即使它应该启动。这应该在从 playanimation() 调用时发生。

由于这是我的第一个应用程序或程序，代码有点不可读。

也许可以帮助我？这是代码：

我的意思是代码的一部分：

```
case 1:
                imageViewsleepbutton.setVisibility(View.VISIBLE);
                imageViewfeedbutton.setVisibility(View.VISIBLE);
                imageViewShowerbutton.setVisibility(View.VISIBLE);
                imageViewPlaybutton.setVisibility(View.VISIBLE);
                imageViewsleepbutton.setEnabled(true);
                imageViewfeedbutton.setEnabled(true);
                imageViewShowerbutton.setEnabled(true);
                imageViewPlaybutton.setEnabled(true);
                Settings.setLevel(2, context);
                helper.setCorrectPet();
                helper.playAnimation();
                textviewStatus.setText(activity.getString(R.string.baby));
                break; 
```

在那个班级：

```
package at.android.virtualpet;

import java.util.Random;

import android.app.Activity;
import android.content.Context;
import android.os.Handler;
import android.view.View;
import android.widget.ImageView;
import android.widget.TextView;
import android.widget.Toast;

public class TimerC{

    //TODO Try-Catch Timer
    private Handler handler;
    Toast toast;

    private ImageView imageViewsleepbutton;
    private ImageView imageViewfeedbutton;
    private ImageView imageViewShowerbutton;
    private ImageView imageViewPlaybutton;
    private TextView textviewStatus;

    private int intervall;

    private Helper helper;

    private Context context;
    Activity activity;

    public TimerC(Context context, Activity activity, int intervall){
        this.context = context;
        this.activity = activity;
        this.intervall = intervall;
    }

    public void startTimer() {
        boolean b, resume;
        b = Settings.getFirstStart(context);
        resume = Settings.getResumeStatus(context);
        handler = new Handler();

        helper = new Helper(context, activity);

        if (b == true) {
            Settings.setFirstStart(false, context);
            handler.postDelayed(timedTask, 45000); //45000
        }
        else {
            if (resume == true) {
                helper.resumeStats();
                Settings.setResumeStatus(false, context);
        }
        handler.postDelayed(timedTask, intervall);
        }
    }

    public void stopTimer() {
        handler.removeCallbacks(timedTask);
    }

    private void changePet() {
        int stufe;
        int progress;

        imageViewsleepbutton = (ImageView) activity.findViewById(R.id.ImageViewsleepbutton);
        imageViewfeedbutton = (ImageView) activity.findViewById(R.id.imageViewfeedbutton);
        textviewStatus = (TextView) activity.findViewById(R.id.textViewStatus);
        imageViewShowerbutton = (ImageView) activity.findViewById(R.id.imageViewShowerButton);
        imageViewPlaybutton = (ImageView) activity.findViewById(R.id.imageViewPlayButton);

        stufe = Settings.getLevel(context);
        progress = Settings.getLevelProgress(context);

        if (progress <= 0 || stufe == 1) {
            switch(stufe) {
            case 1:
                imageViewsleepbutton.setVisibility(View.VISIBLE);
                imageViewfeedbutton.setVisibility(View.VISIBLE);
                imageViewShowerbutton.setVisibility(View.VISIBLE);
                imageViewPlaybutton.setVisibility(View.VISIBLE);
                imageViewsleepbutton.setEnabled(true);
                imageViewfeedbutton.setEnabled(true);
                imageViewShowerbutton.setEnabled(true);
                imageViewPlaybutton.setEnabled(true);
                Settings.setLevel(2, context);
                helper.setCorrectPet();
                helper.playAnimation();
                textviewStatus.setText(activity.getString(R.string.baby));
                break;
            case 2:
                Settings.setLevel(3, context);
                helper.setCorrectPet();
                helper.playAnimation();
                textviewStatus.setText(activity.getString(R.string.teen));
                break;
            case 3:
                Settings.setLevel(4, context);
                helper.setCorrectPet();
                helper.playAnimation();
                textviewStatus.setText(activity.getString(R.string.adult));
                break;
            }
            Settings.setLevelProgress(1000, context);
        }
    }

    private void changeStats() {
        int hunger;
        int progress;
        int stufe;
        int sleep;
        int fun;
        int dirty;
        int level;
        int xp;

        boolean day;
        boolean firststart;

        Random randInt = new Random();

        int promp = 1; //progress multiplikator
        int minushunger = randInt.nextInt(4)+3;
        int minussleep = 3;
        int sleepnight = 15;
        int hungernight = randInt.nextInt(3)+2;
        int minusdirty = randInt.nextInt(4)+2;
        int minusfun = randInt.nextInt(2)+2;
        int dirtynight = minusdirty;
        int funnight = minusfun;

        hunger = Settings.getHunger(context);
        progress = Settings.getLevelProgress(context);
        fun = Settings.getFun(context);
        dirty = Settings.getDirty(context);
        stufe = Settings.getLevel(context);
        sleep = Settings.getSleep(context);
        level = Settings.getLevel(context);
        firststart = Settings.getFirstStart(context);
        xp = Settings.getXP(context);

        day = Settings.getDay(context);

        if ((firststart == false) && (level != 1)) {

            if (day == true) {
                hunger = hunger - minushunger;
                sleep = sleep - minussleep;
                dirty = dirty - minusdirty;
                fun = fun - minusfun;
            } else {
                hunger = hunger - hungernight;
                sleep = sleep + sleepnight;
                dirty = dirty - dirtynight;
                fun = fun - funnight;
            }

            if(sleep > 100) {
                sleep = 100;
                helper.wakeup();
            }

            if(hunger < -5 ) {hunger = -5;}
            if(sleep < -5) {sleep = -5;}            
            if(hunger > 110) {hunger = 110;}
            if(dirty < -15 ) {dirty = -15;}
            if(fun < -15 ) {fun = -15;}
            if(dirty > 110) {dirty = 110;}
            if(fun > 110) {fun = 110;}

            Settings.setSleep(sleep, context);
            Settings.setHunger(hunger, context);
            Settings.setDirty(dirty, context);
            Settings.setFun(fun, context);

            //promp = 1
            if ((sleep < 0) && (hunger < 0) && (dirty < 20) && (fun < 20)) {promp = 0;};
            if ((sleep > 90) && (hunger > 90) && (dirty > 75) && (fun > 75)) {promp = 2;};

            switch(stufe) {
            case 1:
                //Stufe 1 ist Ei. Das Ei schlüpft automatisch nach x Sek
                break;
            case 2:
                progress = progress - (5 * promp);
                break;
            case 3:
                progress = progress - (4 * promp);
                break;
            case 4:
                progress = progress - (3 * promp);
                break;
            }
            xp = xp + 4*promp;
            Settings.setXP(xp, context);
            helper.setCorrectPet();
            helper.checkLevel();
            Settings.setLevelProgress(progress, context);
            helper.checkStatus();
        }

    }

    private Runnable timedTask = new Runnable(){
          @Override
          public void run() {
              changePet();
              changeStats(); //Werte ändern und Meldungen ausgeben
              helper.updateprogress();
              helper.updateDebugFields();
              handler.postDelayed(timedTask, intervall);
          }};
} 
```

和另一个类中的 playanimation() 。此类具有来自 MainActivity 的活动的上下文。

```
public void playAnimation() {
    imageViewPet = (ImageView)activity.findViewById(R.id.imageViewPet);
    if (imageViewPet.getDrawable() instanceof AnimationDrawable) {
        animatedaotori = (AnimationDrawable)imageViewPet.getDrawable();
        Handler handler = new Handler(activity.getMainLooper());
        handler.postDelayed(new Runnable() {

            @Override
            public void run() {
                animatedaotori.start();             
            }
        }, 1500);
    }
} 
```

# css - WP - 不能样式框或加载图片？

> ID：14329298
> 
> 赞同：0
> 
> 时间：2013-01-15T00:33:00.480
> 
> 标签：css, wordpress, html

在这个[网站上](http://raad-mal.dk)，我需要添加指向 google+ 和 Facebook 的链接。我无法让我使 div 框生效的 CSS。我也尝试使用 img 标签添加图片，但即使它似乎是正确的目录并且其他图像具有相同的目录，我也无法加载图片。我想在菜单栏的右侧添加 2 个图标。

HTML：

```
<div class="art-nav">
    <ul class="art-menu">
        <?php art_menu_items(); ?>
    </ul>
    <div id="facebooktopmarc">
        <a href="https://www.facebook.com/raadmal">
            <img src="images/facebook.png" alt="Go to Facebook!"/>
        </a>
    </div>
    <div id="googleplustopmarc">
        <a href="https://www.facebook.com/">
            <img src="images/google-plus.png" alt="Go to Google-plus!"/>
        </a>
    </div>
</div> 
```

CSS：

```
#facebooktopmarc {
  background-image: url("images/facebook.png");
  background-position: right center;
  background-repeat: no-repeat;
  display: block;
  float: right;
  height: 25px;
  margin: 0 5px 0 0;
  position: relative;
  width: 25px;
}

#googleplustopmarc {
  background-image: url("images/google-plus.png");
  background-position: right center;
  background-repeat: no-repeat;
  display: block;
  float: right;
  height: 25px;
  margin: 0 5px 0 0;
  position: relative;
  width: 25px;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-15T00:39:57.033

CSS 中的 Urls 与文件系统中的这个 CSS 文件位置有关。如果要在 html 中使用 img，则应使用相对于该 html 的路径或带有域名的绝对路径。

你的图片有网址

```
http://raad-mal.dk/wp-content/themes/green_room/images/facebook.png
http://raad-mal.dk/wp-content/themes/green_room/images/google-plus.png 
```

# objective-c - 在 Web 视图中使用 setMainFrameURL 捕获错误

> ID：14329299
> 
> 赞同：1
> 
> 时间：2013-01-15T00:33:05.517
> 
> 标签：objective-c, cocoa, webview

我正在使用以下代码在我的 Mac 应用程序中填充 webView...

```
NSURL *url = [NSURL URLWithString:@"https://joeworkman.net"];
[self setMainFrameURL:[url absoluteString]]; 
```

我希望能够在加载此 URL 时出现错误，然后加载存储在我的应用程序中的本地 HTML 文件。通过这种方式，用户会看到一个可呈现的错误，而不是一个丑陋的 500 服务器错误（如果是这样的话）。更不用说大多数用户无论如何都不知道这意味着什么。

# php - 经 Ghostscript/ps2pdf 优化后 PDF 中缺少图像

> ID：14329300
> 
> 赞同：0
> 
> 时间：2013-01-15T00:33:08.670
> 
> 标签：php, pdf, optimization, tcpdf, ghostscript

我正在开发一个用于以 PDF 和打印形式创建书籍的网络应用程序 (PHP)。每个书页都保存为单独的高分辨率 JPEG，并插入到由 TCPDF ( [http://www.tcpdf.org/](http://www.tcpdf.org/) ) 创建的新 PDF 文档中。最后一页在底部附近插入了一个额外的水印图像（PNG，2500x2000，72dpi）。

所有这些都可以正常工作，但是当我使用以下命令调用 Ghostscript 来优化 PDF 时，我遇到了麻烦。除了缺少水印外，它可以毫无错误地处理整个 PDF。

```
gs -dBATCH -dNOPAUSE -sDEVICE=pdfwrite -sOutputFile=LowResOutput.pdf -dPDFSETTINGS=/screen -dCompatibilityLevel=1.4 HiResInput.pdf 
```

我已经确认水印在未优化的源文件中正确显示。如果我将质量设置 (-dPDFSETTINGS) 从*/screen*更改为*/printer*，它会生成包含水印的高分辨率 PDF。

我不确定我是否缺少导致水印图像被排除的质量/输出设置或什么。如果有人知道为什么会发生这种情况，我将不胜感激。

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-15T10:24:48.323

您使用的是什么版本的 Ghostscript？“水印”是如何创建的？（注解、修改页面内容流，还有什么？是透明的吗？）

不要在不完全了解所有单独设置的影响的情况下使用 PDFSETTINGS，很可能是颜色转换导致输出发生一些变化，但也可能有其他原因。一般来说，我根本不会使用 PDFSETTINGS 开关，单独设置每个开关。

最后，您能否将您要发送到 Ghostscript 的类型的（小！）文件放在公共的地方。几乎不可能在没有看到示例的情况下做出明智的评论。

# xcode - 在 ipad 和模拟器之间测试 GKSession (iOS 6)

> ID：14329304
> 
> 赞同：0
> 
> 时间：2013-01-15T00:33:43.770
> 
> 标签：xcode, ipad, ios6, ios-simulator, gksession

我正在尝试在模拟器和 ipad 之间启动 GKSession。但我认为他们甚至没有连接，因为我尝试分别列出客户端和服务器。设备和模拟器上均未显示任何内容。我正在尝试这个 Ray Wenderlich 的教程[http://www.raywenderlich.com/12735/how-to-make-a-simple-playing-card-game-with-multiplayer-and-bluetooth-part-1](http://www.raywenderlich.com/12735/how-to-make-a-simple-playing-card-game-with-multiplayer-and-bluetooth-part-1)甚至是第二个教程的一部分。好吧，我尝试下载他们的项目并尝试运行它。它没有列出客户端和服务器，所以我假设它根本没有连接。我在想也许是因为我在 iOS6.0.1 上使用它？你认为它的版本问题？

我没有在这里发布任何代码，因为我只是想按照上面的教程进行操作。当然没有其他错误..它们运行得很好，只是没有列出客户端和服务器。

任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-07-08T00:32:49.750

我需要回答这个问题，这是因为我试图在我组织的网络环境中运行这段代码（网络有限制）。所以当我在家庭网络上尝试时，它确实工作得很好。

# java - 三角-三角相交检测

> ID：14329305
> 
> 赞同：2
> 
> 时间：2013-01-15T00:33:43.860
> 
> 标签：java, 3d, computational-geometry

我正在使用[这篇](http://www.applet-magic.com/trintersection.htm)文章研究三角-三角检测算法。我写了这段代码，但不幸的是，当三角形之间有交集时，该方法返回 false。

```
private boolean checkTriangleCollision(Triangle triangle1, Triangle triangle2) {
    Vector3f n1 = getN(triangle1);
    Vector3f n2 = getN(triangle2);
    Vector3f v = null;
    v = Vector3f.cross(n1, n2, v);

    Vector3f p = new Vector3f();

    float pxy = n1.z * triangle1.vertex1.position.z * n1.x * n1.y;
    float px = n1.z * triangle1.vertex1.position.z * n1.x * n1.y * triangle1.vertex1.position.y;
    float py = n1.z * triangle1.vertex1.position.z * n1.x * triangle1.vertex1.position.x * n1.y;
    float p0 = n1.z * triangle1.vertex1.position.z * n1.x * triangle1.vertex1.position.x * n1.y * triangle1.vertex1.position.y;

    p.x = (p0/(px/pxy))/pxy;
    p.y = (p0/(py/pxy))/pxy;

    Vector3f x = null;
    x = Vector3f.add(p, v, x);

    Vector3f xq1 = null;
    xq1 = Vector3f.sub(x, triangle1.vertex1.position, xq1);
    float i1 = Vector3f.dot(xq1, n1);

    Vector3f xq2 = null;
    xq2 = Vector3f.sub(x, triangle2.vertex1.position, xq2);
    float i2 = Vector3f.dot(xq2, n2);

    if (i1 == 0 && i2 == 0) {
        return true;
    }
    return false;
}

private Vector3f getN(Triangle triangle) {
    Vector3f vn1 = null;
    vn1 = Vector3f.sub(triangle.vertex2.position, triangle.vertex1.position, vn1);
    Vector3f vn2 = null;
    vn2 = Vector3f.sub(triangle.vertex3.position, triangle.vertex1.position, vn2);
    Vector3f n = null;
    n = Vector3f.cross(vn1, vn2, n);
    return n;
} 
```

我不完全知道为什么，但我想问题出在计算上`p`。如果是，那么我如何通过代码解决这个等式？

```
N1·(P0-Q1) = 0 
and
N2·(P0-R1) = 0 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-20T19:25:41.697

在我看来，你做错了点积。

试试这个：

```
 Vector3f n1 = getN(triangle1);
    Vector3f n2 = getN(triangle2);
    Vector3f v = null;
    v = Vector3f.cross(n1, n2, v);

    Vector3f p = new Vector3f();

//P0 calcuiation

    float C1 = n1.x * triangle1.vertex1.position.x + n1.y * triangle1.vertex1.position.y + n1.z * triangle1.vertex1.position.z;

    float C2 = n2.x * triangle2.vertex1.position.x + n2.y * triangle2.vertex1.position.y + n2.z * triangle2.vertex1.position.z;

    float Kn = n2.x / n1.x;

    p.y = (C2 - C1 * Kn) / (n2.y - n1.y * Kn);

    p.x = (C1 - n1.y * p.y) / n2.x;

p.z = 0;

//P0 calcuiation ends

    Vector3f x = null;
    x = Vector3f.add(p, v, x); 
```

这是我的计算：http: [//i.stack.imgur.com/3USpZ.png](http://i.stack.imgur.com/3USpZ.png)

# java - 在Java中创建对象数组

> ID：14329306
> 
> 赞同：-3
> 
> 时间：2013-01-15T00:33:47.903
> 
> 标签：java, arrays

我正在尝试在 Java 中创建一个对象数组，并且在执行此操作时遇到了一些问题，我希望在我已经设置的现有类型上创建数组，并且我想要创建的 arra 对象的数量将使用声明一个全局整数。

```
 task = new TaskSim(taskDelay, taskPeriod); 
```

我想创建一个上述对象的数组，taskDelay 和 taskPeriod 的值对于数组中的每个元素都是相同的，这将通过构造函数传递。但是，我要创建的元素数量将使用全局 int 定义。

TaskSim 是我实现的一个类，用于创建如上所示的任务对象，所以我的问题是如何创建具有如上所示参数的任务数组。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-15T00:35:45.277

```
TaskSim[] instances = new TaskSim[numberOfElements];
for (int i=0; i<instances.length; i++) {
    instances[i] = new TaskSim(taskDelay, taskPeriod);
} 
```

[http://docs.oracle.com/javase/tutorial/java/nutsandbolts/arrays.html](http://docs.oracle.com/javase/tutorial/java/nutsandbolts/arrays.html)

# java - JTextArea 不可选择，但仍显示“幽灵”光标

> ID：14329310
> 
> 赞同：4
> 
> 时间：2013-01-15T00:34:14.890
> 
> 标签：java, swing, jtextarea, alpha-transparency

我将 JTextArea 放在 JPanel 中。这个 JPanel 在背景上有一张图片，而 JTextArea 是半透明的（半透明红色）以显示背景。我不希望用户能够编辑或选择文本，我希望它充当 JLabel（但具有多行并且易于自动换行和调整屏幕大小）。

我尝试了所有这些选项：

```
text.setEditable(false);
text.setFocusable(false);
text.setEnabled(false);
text.setHighlighter(null); 
```

但是当用户将鼠标拖到 JTextArea 上时，颜色仍然会发生一些变化。有谁知道发生了什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-15T00:59:44.113

您不能简单地将组件的背景颜色设置为“透明”并期望 Swing 处理它。您需要将组件标记为透明 ( `setOpaque(false)`)，然后 Swing 的重绘管理器才会知道它必须更新其下的组件。

这会导致您遇到如何绘制背景的问题（因为 Swing 只有完全不透明或完全透明的概念）。

为此，您需要提供自己的绘制例程（覆盖`paintComponent`、填充背景、更新组件）...这基本上就是[Rob Camick 的](http://tips4java.wordpress.com/2009/05/31/backgrounds-with-transparency/)解决方案正在做的事情，它只是为您提供了一个很好的包装组件...

`JLabel`下面是使用 HTML 和 a 包装的 using 文本的示例`JTextArea`，两者均已更新为支持“半透明”...

用一个`JLabel`

![在此处输入图像描述](../Images/21b431c88d2b4be5dd04b2349701463a.png)

用一个`JTextArea`

![在此处输入图像描述](../Images/b920f52173a68ff993f3d1b800ff990b.png)

现在，使用 Rob 的包装类实现起来会容易得多，但这让您了解出了什么问题以及您需要做些什么来修复它。

```
public class MultiLineLabel {

    public static void main(String[] args) {
        new MultiLineLabel();
    }

    public MultiLineLabel() {
        EventQueue.invokeLater(new Runnable() {
            @Override
            public void run() {
                try {
                    UIManager.setLookAndFeel(UIManager.getSystemLookAndFeelClassName());
                } catch (ClassNotFoundException | InstantiationException | IllegalAccessException | UnsupportedLookAndFeelException ex) {
                }

                JFrame frame = new JFrame();
                frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
                frame.setLayout(new BorderLayout());
                frame.add(new BackgroundPane());
                frame.pack();
                frame.setLocationRelativeTo(null);
                frame.setVisible(true);
            }
        });
    }

    public class TransclucentLabel extends JLabel {

        public TransclucentLabel(String text) {
            super(text);
            setVerticalAlignment(TOP);
        }

        @Override
        protected void paintComponent(Graphics g) {
            Graphics2D g2d = (Graphics2D) g;
            Insets insets = getInsets();
            int x = insets.left;
            int y = insets.top;
            int width = getWidth() - (insets.left + insets.right);
            int height = getHeight() - (insets.top + insets.bottom);
            g2d.setColor(new Color(255, 0, 0, 128));
            g2d.fillRect(x, y, width, height);
            super.paintComponent(g);
        }
    }

    public class TransclucentTextArea extends JTextArea {

        public TransclucentTextArea(String text) {
            super(text);
            setOpaque(false);
            setLineWrap(true);
            setWrapStyleWord(true);
        }

        @Override
        protected void paintComponent(Graphics g) {
            Graphics2D g2d = (Graphics2D) g;
            Insets insets = getInsets();
            int x = insets.left;
            int y = insets.top;
            int width = getWidth() - (insets.left + insets.right);
            int height = getHeight() - (insets.top + insets.bottom);
            g2d.setColor(new Color(255, 0, 0, 128));
            g2d.fillRect(x, y, width, height);
            super.paintComponent(g);
        }
    }

    public class BackgroundPane extends JPanel {

        private BufferedImage background;

        public BackgroundPane() {
            setLayout(new BorderLayout());
//            addLabel();
            addTextArea();
            setBorder(new EmptyBorder(24, 24, 24, 24));

            try {
                background = ImageIO.read(new File("/path/to/your/image"));
            } catch (IOException ex) {
                ex.printStackTrace();
            }
        }

        protected void addTextArea() {
            StringBuilder sb = new StringBuilder(128);
            sb.append("I put a JTextArea in a JPanel. This JPanel has a picture on the background, and the JTextArea is translucent (translucid red) to show the background through. I don't want the user to be able to edit or select the text, I want it to act just as a JLabel (but with multiple lines and easy to word wrap and adjust to screen resize).\n\n");
            sb.append("I tried all these options:\n\n");
            sb.append("text.setEditable(false);\n");
            sb.append("text.setFocusable(false);\n");
            sb.append("text.setEnabled(false);\n");
            sb.append("text.setHighlighter(null);\n\n");
            sb.append("but still some change of color happens as the user drags the mouse over the JTextArea. Anyone knows what is going on?\n");
            add(new TransclucentTextArea(sb.toString()));
        }

        protected void addLabel() {
            StringBuilder sb = new StringBuilder(128);
            sb.append("<html>");
            sb.append("<p>I put a JTextArea in a JPanel. This JPanel has a picture on the background, and the JTextArea is translucent (translucid red) to show the background through. I don't want the user to be able to edit or select the text, I want it to act just as a JLabel (but with multiple lines and easy to word wrap and adjust to screen resize).</p><br>");
            sb.append("<p>I tried all these options:</p><br>");
            sb.append("<p>text.setEditable(false);<br>");
            sb.append("text.setFocusable(false);<br>");
            sb.append("text.setEnabled(false);<br>");
            sb.append("text.setHighlighter(null);</p><br>");
            sb.append("<p>but still some change of color happens as the user drags the mouse over the JTextArea. Anyone knows what is going on?</p>");
            add(new TransclucentLabel(sb.toString()));

        }

        @Override
        public Dimension getPreferredSize() {
            return background == null ? super.getPreferredSize() : new Dimension(background.getWidth(), background.getHeight());
        }

        @Override
        protected void paintComponent(Graphics g) {
            super.paintComponent(g);
            if (background != null) {
                int x = (getWidth() - background.getWidth()) / 2;
                int y = (getHeight() - background.getHeight()) / 2;
                g.drawImage(background, x, y, this);
            }
        }
    }
} 
```

# android - 数组没有打印它应该是什么 - android

> ID：14329313
> 
> 赞同：0
> 
> 时间：2013-01-15T00:34:38.150
> 
> 标签：android, listview

当我尝试将值打印到文本字段时，它们显示为 [Ljava.lang.String;@405af10

```
try {
    JSONObject jObject = new JSONObject(byteArrayOutputStream.toString());

    JSONArray Monday = jObject.getJSONArray("Monday");

    String time = "";
    String module = "";
    String lecturer = "";

    listAdapter = new ArrayAdapter<String[]>(this, R.layout.simplerow);

    for (int i = 0; i < Monday.length(); i++) 
    {
        time = Monday.getJSONObject(i).getString("time");
        module = Monday.getJSONObject(i).getString("module");
        lecturer = Monday.getJSONObject(i).getString("lecturer");

        listAdapter.add(new String[] {time, module, lecturer});

    }
    mainListView.setAdapter(listAdapter);    

} catch (Exception e) {
    e.printStackTrace();
} 
```

在我有的 simplerow xml 文件中

```
<TextView  xmlns:android="http://schemas.android.com/apk/res/android"
 android:id="@+id/rowTextView" 
 android:layout_width="fill_parent" 
 android:layout_height="wrap_content"
 android:padding="10dp"
 android:textSize="16sp" >
</TextView> 
```

因此，每次打印模块或讲师时，它都应该在它自己的文本视图框中。但它不起作用，我不知道为什么或如何修复它。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-15T00:50:00.677

这很可能是因为您`ArrayAdapter`设置为接受`String`数组 ( `String []`)。

```
listAdapter = new ArrayAdapter<String[]>(this, R.layout.simplerow); //Parameterized for String [] 
```

因此，您有一个`String`数组列表，它基本上相当于一个二维数组。

这意味着，当将`ArrayAdapter`Text 设置为您指定的 TextView 时，它正在调用`toString()`整个数组对象，因此是哈希码。

考虑制作自己的方法`ArrayAdapter`并覆盖该`getView()`方法，以便它执行您想做的事情。网上有很多教程，比如[这个](http://sogacity.com/how-to-make-a-custom-arrayadapter-for-listview/)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-15T00:55:34.520

我建议你做一个 POJO 来保存你的数据。POJO 可以具有`CourseInfo`明确定义其含义的名称。同样，成员`CourseInfo`将清楚地定义他们所代表的内容。这比数组更可取，因为您可以清楚地定义每条数据的含义。通常，Java 程序员不喜欢使用包含异构数据的数组。在这种情况下，即使每条数据的类型相同，但数组中每个元素的含义是不同的。

此解决方案的优点是您可以更改

```
listAdapter = new ArrayAdapter<String[]>(this, R.layout.simplerow); 
```

到

```
listAdapter = new ArrayAdapter<CourseInfo>(this, R.layout.simplerow); 
```

# mysql - 什么 MySQL 排序规则最适合接受所有 unicode 字符？

> ID：14329314
> 
> 赞同：22
> 
> 时间：2013-01-15T00:34:41.177
> 
> 标签：mysql, collation

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2013-01-17T02:15:27.120

The *collation* is the least of your worries, what you need to think about is the *character set* for the column/table/database. The collation (rules governing how data is *compared* and *sorted*) is just a corollary of that.

MySQL supports several Unicode character sets, `utf8` and `utf8mb4` being the most interesting. `utf8` supports Unicode characters in the [BMP](http://en.wikipedia.org/wiki/Basic_Multilingual_Plane#Basic_Multilingual_Plane), i.e. a subset of all of Unicode. `utf8mb4`, available since MySQL 5.5.3, supports *all* of Unicode.

The *collation* to be used with any of the Unicode encodings is most likely `xxx_general_ci` or `xxx_unicode_ci`. The former is a general sorting and comparison algorithm independent of language, the latter is a *more complete* language independent algorithm supporting more Unicode features (e.g. treating "ß" and "ss" as equivalent), but is therefore also slower.

See [https://dev.mysql.com/doc/refman/5.5/en/charset-unicode-sets.html](https://dev.mysql.com/doc/refman/5.5/en/charset-unicode-sets.html).

# django - 为什么带有 DjangoJSONEncoder 的 json.dumps 返回整数字段的字符串？

> ID：14329315
> 
> 赞同：1
> 
> 时间：2013-01-15T00:34:48.807
> 
> 标签：django, json, django-models, django-serializer

所以我有这个代码：

```
class JSONResponseJSONDumps(HttpResponse):
    """JSON response class."""
    def __init__(self, obj='', json_opts={}, mimetype="application/json", *args, **kwargs):
         content = json.dumps(obj, cls=DjangoJSONEncoder)
         super(JSONResponseJSONDumps,self).__init__(content, mimetype, *args, **kwargs)

class Equipment(models.Model):
    serial = models.CharField(max_length=64, blank=False)
    volts = models.IntegerField(blank=True, null=True)
    hertz = models.IntegerField(blank=True, null=True)
    amps = models.IntegerField(blank=True, null=True) 
```

//views.py

```
 data = {
             "serial": equipment.serial,
             "hertz": equipment.hertz,
             "volts": equipment.volts,
             "amps" : equipment.amps,
             }                                
      response = JSONResponseJSONDumps(data, {}, 'application/json') 
```

我将其发送回 iOS。现在，我遇到了一个奇怪的问题，安培作为整数发送，iOS 看到了这一点，在伏特和安培的情况下，它作为字符串发送？！

这在我的其他模型中也发生过。有任何想法吗？！

谢谢！

# android - 点击号码拨打电话——安卓

> ID：14329318
> 
> 赞同：0
> 
> 时间：2013-01-15T00:35:14.687
> 
> 标签：android, html

我正在尝试使用它，以便在单击电话号码时拨打电话。电话号码显示正确，但单击它时没有任何反应。

为什么这不起作用？

```
tvInfo.setText(Html.fromHtml("<a href='tel:15555555555'><b>(555) 555-5555</b></a>")); 
```

如果需要更多信息，请告诉我。谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-15T00:47:04.713

试试看[`Linkify`](http://developer.android.com/reference/android/text/util/Linkify.html)。用 正常设置电话号码`setText`，然后使用`Linkify`。

```
tvInfo.setText("(555)555-5555");
Linkify.addLinks(tvInfo, Linkify.PHONE_NUMBERS); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-15T07:40:29.367

尝试这个：

```
 call.setText(Html.fromHtml("<u>" + "9999999999" + "</u>"));
 call.setOnClickListener(new OnClickListener() {

        public void onClick(View v) {

            number = call.getText().toString();
            Intent intent = new Intent(Intent.ACTION_DIAL);
            intent.setData(Uri.parse("tel:" + number));
            startActivity(intent);

        }
    }); 
```

# php - 向 Magento 管理员添加搜索字段

> ID：14329320
> 
> 赞同：0
> 
> 时间：2013-01-15T00:35:27.653
> 
> 标签：php, mysql, magento-1.7, magento

有没有办法在 Magento 管理员的“订单”下添加一个新的搜索字段？我希望能够按优惠券代码使用情况进行搜索（例如：按优惠券代码搜索：“sale2013”​​，在结账时找到所有应用该优惠券代码的订单）。

![在此处输入图像描述](../Images/52eb34eb963a309bf5cbe44bdcb28e65.png)

我能够将这些数据从 Magento DB 中提取出来，但我真的很想将此功能添加到 Magento 管理员中，以便让同事和我的老板更轻松。可以完成吗？如果可以，我可以从哪里开始？多谢你们。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-15T01:41:10.780

The coupon code used during checkout is stored on the primary order table (`sales_flat_order`) when the customer checks out. If there is no value, then no coupon code was used. However, the data for the grid in the admin comes from the `sales_flat_order_grid` table; it comes from there instead of the primary order table for performance reasons which become particularly evident on very high traffic sites.

Now that we know where the data is that you need to filter on, and where the data for the grid comes from, we can move on to build it!

The first thing that you will need to do is add a `coupon_code` column to the `sales_flat_order_grid` table matching the definition of the column on the `sales_flat_order` table. The values in the `coupon_code` column of `sales_flat_order` should automatically populate into `sales_flat_order_grid` once the matching column is there and your cache storage has been flushed.

The data is updated on the order save, so to be specific, new orders and orders updated via the admin (even a comment on the order) will have the data populated. For existing orders, run a data upgrade script to copy the values over.

After the data/schemas are in place, you'll want to have the grid show a filterable column for it. For this you will want to rewrite the `Mage_Adminhtml_Block_Sales_Order_Grid` class from your custom module (please don't edit the core files directly, it will haunt you later) and override the `_prepareColumns` method with one that includes your column definition:

```
 $this->addColumn('coupon_code', array(
        'header' => Mage::helper('sales')->__('Coupon Code'),
        'index' => 'coupon_code',
    )); 
```

If you're very fresh on Magento development, I'd venture to say that I've only begun to help you. But you'll have plenty of reference points from which to dig in and build the functionality you need. HTH! :)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-15T07:39:32.763

使用此扩展程序可以轻松地将新列添加到网格： [https ://github.com/magento-hackathon/GridControl](https://github.com/magento-hackathon/GridControl)

`gridcontrol.xml`添加此扩展程序，在您的 etc 目录中编写您自己的扩展程序

然后这样的事情应该可以工作：

```
<?xml version="1.0"?>
<gridcontrol>
<grids>
    <order.grid>
        <coupon_code>
            <after>columnname</after>

            <add>
                <header>Coupon code</header>
                <type>text</type>
                <index>coupon_code</index>
                <joinField>coupon_code|sales/order|coupon_code|entity_id=entity_id||left</joinField>
            </add>
        </coupon_code>
    </order.grid>
</grids>
</gridcontrol> 
```

# c++ - OpenMP 并行循环加速问题

> ID：14329323
> 
> 赞同：0
> 
> 时间：2013-01-15T00:35:35.493
> 
> 标签：c++, openmp

最近我开始使用 OpenMP。进行涉及在 c++ 中创建的 3d 矩阵作为向量的数值计算，我使用并行 for 循环来加速代码。但它的运行速度比串行代码慢。我在 Windows 7 中使用 Codeblocks 编译代码。代码是这样的。

```
int main(){
  vector<vector<vector<float> > > Dx; //

/*create 3d array Dx[IE][JE][KE] as vectors*/
  Dx.resize(IE);
  for (int i = 0; i < IE; ++i) {
    for (int j = 0; j < JE; ++j){
      dx[i][j].resize(KE);
    }
  }
  //declare and initialize more matrices like this
  .
  .
  .
  double wtime = omp_get_wtime(); // start time
  //and matrix calculations using parallel for loop 

  #pragma omp parallel for
  for (int i=1; i < IE; ++i ) {
    for (int j=1; j < JE; ++j ) {
      for (int k=1; k < KE; ++k ) {
        curl_h = ( Hz[i][j][k] - Hz[i][j-1][k] - Hy[i][j][k] + Hy[i][j][k-1]);
        idxl[i][j][k] = idxl[i][j][k] + curl_h;
        Dx[i][j][k] = gj3[j]*gk3[k]*dx[i][j][k] 
                    + gj2[j]*gk2[k]*.5*(curl_h + gi1[i]*idxl[i][j][k]);
      }  
    }
  }

  wtime =  omp_get_wtime() - wtime;
} 
```

但是具有并行循环的代码比串行代码运行得慢。有任何想法吗 ？谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2017-02-01T13:26:10.587

循环使用`curl_h`未声明为线程私有的变量。这既是一个错误，也是您感知到的性能问题的原因：

由于内存中只有一个存储位置`curl_h`，*所有线程不断地同时尝试读取和写入它*。一个 CPU 内核会将值加载到其缓存中，下一个 CPU 内核将向其发出写入，使第一个 CPU 的缓存无效，当它自己尝试使用时`curl_h`（读取或写入，两者都需要cacheline 在本地缓存中）。

关键是，硬件提出的只有一个内存位置被称为的激烈伪装`curl_h`要求它致敬。您在缓存一致性协议中会遇到大量的问题，并让您的内存总线忙于不断地从内存中重新获取相同的缓存行。你所有的线程真正在做的就是争夺那个缓存线。

当然，线程之间的持续竞争是一个大错误，因为没有进程可以确定它当前使用的值实际上是它在上面的语句中计算的值。

因此，只需将正确`private()`的声明添加到您的`omp parallel for`语句中，您就可以修复错误和性能问题。

# android - 从手机中删除推送通知设置

> ID：14329327
> 
> 赞同：1
> 
> 时间：2013-01-15T00:36:12.007
> 
> 标签：android, ios, actionscript-3, air

我想知道是否有人知道从 iPhone/Android 设置中完全删除推送通知的方法？

我正在为移动设备在 AS3 中构建一个 AIR 应用程序，并且在首次启动时，通知设置存储在手机设置中，但我需要删除它才能检查一些提示用户接受/拒绝推送通知的附加代码。

我正在使用 Distriqt 的扩展，一切运行良好。我只需要删除设置来检查其他代码块。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-15T00:53:18.363

在 iOS 上，执行此操作的方法是在“常规”->“重置”->“重置所有设置”下的“设置”应用程序中重置手机设置。但是，它会删除您的所有手机设置，因此您应该只在测试设备上执行此操作。

# iphone - 越狱者怎么做

> ID：14329328
> 
> 赞同：0
> 
> 时间：2013-01-15T00:36:12.813
> 
> 标签：iphone, jailbreak

我只是试图在没有开发者帐户的情况下在我的 iPhone 上获取我自己的应用程序。以下是我执行的步骤：

1.  我用 JailCoder 修补了 Xcode 和我的项目 (Currency.xcodeproj)

2.  我想在 Xcode 中使用“iOS 设备”构建项目。但是我收到一条错误消息，例如“找不到设备”。所以我在模拟器中运行它，我在 /Users/Dogan/Library/Developer/Xcode/DerivedData/Currency-gjxrulouxbmjslbzslsplyehgfgm/Build/Products/Debug-iphonesimulator 中获得了 currency.app-file

3.  SSH 到 /var/mobile/Applications 中的 iPhone

4.  创建一个名为 FADE9826-4878-4458-B5BE-90AD4EB60FDF 的新文件夹（我必须使用有效的 UDID。我是否使用特定工具来创建 UDID？我有另一个示例中的 UDID）。我还在这个文件夹中创建了一个名为“Documents”的目录。

5.  chown -R 手机 FADE9826-4878-4458-B5BE-90AD4EB60FDF

6.  scp -r Currency.app root@IP-ADRESS-OF-IPHONE:/var/mobile/Applications/FADE9826-4878-4458-B5BE-90AD4EB60FDF/

7.  使用“killall SpringBoard”在 SSH 中重新启动 Springboard

我得到了应用程序，但它不起作用。每次点击时，它都会崩溃并将我踢到主屏幕。我错过了什么吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-15T01:00:22.603

您错过了模拟器构建不适用于 iPhone，因为它们是为错误的 CPU 类型构建的。模拟器构建是 Intel x86 应用程序，iPhone 有一个 ARM CPU。

可能还有其他问题（我不知道 jailcoder 是如何工作的），但你无法让模拟器构建在手机上运行。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-06-18T01:51:17.363

下载 Jailcoder 并通过 Xcode 的引导补丁，然后为您的项目打补丁后，如果您的设备已插入您的计算机，请选择目标类型（您可以选择模拟器、iOS 设备等），应该有一个列表您设备的名称。

# python - Python - 在确定的点打印一个添加空行的列表

> ID：14329330
> 
> 赞同：2
> 
> 时间：2013-01-15T00:36:23.083
> 
> 标签：python

我有一个包含日志的列表，我正在尝试在特定块之间添加一个空行。因此，当我到达特定块的末尾时，我可以看到一些分离，而不是看起来像一个连续的列表。

```
EX:
log a:
kdsaldklsadkaslk
kasldkasldkasldkasldk

log a1:
lkpadkfaldkfdsl
klsdkfldskfsdl 
```

到目前为止，我已经尝试了所有我能在网上找到的方法，但我没有成功。要么我被迫添加除空行之外的任何内容（例如 ----- 序列），要么添加的空间将添加到每一行（这不是我想要的）。

如果我在列表中添加空行，例如

```
log_list.append(" \n") 
```

当我使用打印列表时

```
print "\n".join(log_list) 
```

我添加的所有空行都没有打印出来。

但是如果我在附加命令中添加任何字符，那么它将被打印出来。

当我执行 join 命令时，是否有任何选项会自动删除列表中的空行？否则我不明白为什么我不能在列表中有一个空行。

还有另一种打印列表的方法吗？我总是看到使用 join 命令打印列表（列表中的所有对象都是字符串）。

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-15T00:42:11.593

对我来说，这很有效（表明没有附加 a`\n`然后加入 a的猴子业务`\n`）：

```
>>> log_list = ['a']
>>> log_list.append('\n')
>>> log_list.append('b')
>>> log_list.append('c')
>>> print '\n'.join(log_list)
a

b
c 
```

你做了什么不同的事情？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-15T00:44:52.717

`":"`如果列表已经创建，例如，您可以在以这样结尾的每一行之前插入一个空行

```
print "\n".join("\n"+s if s.endswith(":") else s for s in log_list) 
```

不过，使用循环可能更清楚

```
for s in log_list:
    if s.endswith(":"):
        print
    print s 
```

您可以更改条件以满足您的要求，例如`s.startswith("log ")`

# ios - 我的自定义 UITableViewCell（使用情节提要创建）中的对象为零

> ID：14329334
> 
> 赞同：3
> 
> 时间：2013-01-15T00:36:58.960
> 
> 标签：ios, uitableview, storyboard

我通过以下步骤在我的 iPhone 应用程序中创建了一个自定义表格视图单元格。

1.  在我的故事板中，我创建了一个示例单元格，将 a`UILabel`和 a拖入其中`UIImageView`。
2.  添加了新文件，我创建了`UITableViewCell`.
3.  在 Interface Builder 中，我选择了我的单元格并将其类分配为我刚刚在步骤 2 中创建的类。
4.  在我的自定义表格视图单元的代码中，我创建了两个 IBOutlet 属性并将它们连接到我的`UILabel`和`UIImageView`故事板中。
5.  我的自定义表格视图单元格还包括一个方法，它接收另一个对象，从中设置自己的属性：

    ```
    -(void)populateWithItem:(PLEItem *)item
    {
        if (item.state == PLEPendingItem) {
            status.text = @"Pending upload..."; //status is a UILabel IBOutlet property
        }
        else if(item.state == PLEUploadingItem)
        {
            status.text = @"Uploading...";
        }

        imageView.image = [UIImage imageWithContentsOfFile:item.path]; //imageView is the UIImageView IBOutlet property
    } 
    ```

这个方法是从我的`tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath as follows:`

```
 PLEPendingItemCell* cell = (PLEPendingItemCell*)[tableView dequeueReusableCellWithIdentifier:item_id];
    if (cell == nil) {
        cell = [[PLEPendingItemCell alloc] initWithStyle:UITableViewCellStyleDefault reuseIdentifier:pending_id];
    }

    [cell populateWithItem:((PLEItem*)[itemList objectAtIndex:indexPath.row])];

    return cell; 
```

问题是单元格总是显示为空。我在 populateWithItem 中设置了一个断点，并意识到该方法中的状态`UILabel`和图像`UIImageView`都为零。

IB不应该初始化这些吗？如果没有，我应该在哪里这样做？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-15T00:50:02.390

如果您在故事板中设置单元格，则始终需要使用创建单元格，`tableView:dequeueReusableCellWithIdentifier:forIndexPath:`因为这是故事板创建单元格并连接视图的地方。

直接使用其构造函数创建单元格，如在您的示例代码中，不会从情节提要、笔尖等加载任何子视图。您创建的类对情节提要原型单元格一无所知。

# google-drive-api - How to copy permissions of one drive file to another

> ID：14329336
> 
> 赞同：4
> 
> 时间：2013-01-15T00:37:06.950
> 
> 标签：google-drive-api

As i understand it a request for files.get only returns my own permissions on a file. How can i read all of them or at lest get a handle for all of the permissions to copy them to another file.

The use case would be an app which creates a related file alongside the original and wants to set the same permissions and sharing settings as the original file on the app created copy.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-16T17:38:38.990

As you can see from previous questions, currently, this will not be possible for the restrictions you state. Sorry.

Google are aware of the importance of this feature and are working to resolve it as soon as possible.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2018-02-06T05:24:04.503

I faced the same issue and this is the workaround I used.

1) Go to google contacts and add all the members into a custom/new group.

2) Select the file you want to share and instead of searching individuals type group label name and all the members would be automatically added.

# asp.net-mvc - 如何管理 _Layout.cshtml 中的逻辑

> ID：14329338
> 
> 赞同：2
> 
> 时间：2013-01-15T00:37:24.010
> 
> 标签：asp.net-mvc, razor, asp.net-mvc-4

我目前正在使用一个 mvc 站点，其中有一个相当广泛的主布局页面。它依赖于数据库中的数据，而数据库中的数据又包括固有逻辑，例如布局中要包含的内容等。

我的大部分控制器操作都在此布局中呈现。我不确定如何工作。用于 Web 表单中的母版页面，所有逻辑都驻留在母版页中。我有几种机制来实现通用布局逻辑，但正在寻找实现这一目标的最佳实践方式。

选项是：

*   在所有控制器操作中复制逻辑（不是真正的选择）
*   将逻辑提取到另一个类并从控制器操作中调用它
*   所有控制器都继承自基础控制器，该基础控制器覆盖 OnActionExecuting 方法，我们使用它来执行逻辑并在 TempData 中返回必要的数据
*   在 cshtml 中使用“RenderAction”来调用必要的控制器操作并将布局提取到较小的局部视图中

还有其他对我开放的选择或建议吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-15T01:06:47.447

如果我理解正确，我会使用部分动作

```
@Html.Action("{ActionName}", "{Controller}", new { roleName= "Admin" }) 
```

动作部分调用类型的专用控制器动作方法

```
 [ChildActionOnly]
    public ActionResult _TopNav(string roleName) 
```

通过这种方式，您可以设计将在整个应用程序中传播而无需复制的重复逻辑。

更好的是，如果您的 _Layout 处理基于权限的链接生成，您可以传递角色 ID 并控制最终用户看到的内容以及他们的导航按钮指向的内容。

# jquery - 网络摄像头捕获图像

> ID：14329339
> 
> 赞同：1
> 
> 时间：2013-01-15T00:37:30.140
> 
> 标签：jquery, html, webcam

我正在尝试使用[Jquery WebCam Plugin](http://www.xarg.org/project/jquery-webcam-plugin/)从我的网络摄像头捕获图像。我无法看到捕获的图像。我想我在我的代码中遗漏了一些东西。我需要捕获图像并将其显示给画布中的用户。

**代码：**

```
$(document).ready(function(){

    $("#camera").webcam({
            width: 315,
            height: 240,
            useMicrophone: false,
            mode: "callback",
            swffile: "resources/swf/jscam_canvas_only.swf", 

            onLoad: function() {

                var cams = webcam.getCameraList();
                for(var i in cams) {
                    jQuery("#cams").append("<li>" + cams[i] + "</li>");
                }
            },

            debug: function (type, string) {
                $("#status").html(type + ": " + string);
            },

            onCapture: function () {

                jQuery("#flash").css("display", "block");
                jQuery("#flash").fadeOut("fast", function () {
                jQuery("#flash").css("opacity", 1);

                webcam.capture();
                 alert($.webcam.getFrameAsBase64());    
                });

            },

            onSave: function(data) {

                var col = data.split(";");
                var img = image;

                for(var i = 0; i < 320; i++) {
                    var tmp = parseInt(col[i]);
                    img.data[pos + 0] = (tmp >> 16) & 0xff;
                    img.data[pos + 1] = (tmp >> 8) & 0xff;
                    img.data[pos + 2] = tmp & 0xff;
                    img.data[pos + 3] = 0xff;
                    pos+= 4;
                }

                if (pos >= 4 * 320 * 240) {
                    ctx.putImageData(img, 0, 0);
                    pos = 0;
                }
            }

    }); 
```

});

```
<label id="status"></label>                             
                    <div id="camera"></div>
                    <div><p><canvas id="canvas" height="240" width="320"></canvas></p></div>
                     <a href="javascript:webcam.capture();changeFilter();void(0);">Take a picture instantly</a> 
```

# regex - 弹性匹配正则表达式

> ID：14329344
> 
> 赞同：-1
> 
> 时间：2013-01-15T00:38:44.753
> 
> 标签：regex, apache-flex, loops

我以前问过这个问题并得到了一些答复，但我仍然不清楚如何做到这一点，如果有人可以帮助我更多，我将不胜感激。我正在做的是从 URL 读取一些信息，然后我使用正则表达式（匹配）来获取我需要的字符串。但是我需要每个匹配的结果是一个字符串，因为我需要操作这个字符串。以下是您拥有的代码。有任何帮助。我再次问过这个问题，但我不知道如何在我这边进行。

```
var composer:StandardFlowComposer = txtSource.textFlow.flowComposer as StandardFlowComposer;
    var pattern:RegExp=  new RegExp("href=\"/player/.*?\">");
    var pattern2:RegExp=  new RegExp("href=\"/player/.*?\"");
    var myArrayOfLines:Array = ul.data.split(/\n/);
    var line:Array;
    var str:String = "";
    var lineFinal:Array;
    var lineURL:String;
    lineFinal =  myArrayOfLines;
    for each (var lineRaw:String in myArrayOfLines)
    { 
    trace(lineRaw);
        }
    trace(line); 
```

任何帮助表示赞赏。非常感谢您。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-15T05:39:30.280

Try this , this will matches the specifed pattern against the string and returns array of strings...

```
var myArrayOfLines:Array = ul.data.match(/"your pattern here"/gs);

for each (var lineRaw:String in myArrayOfLines)
{ 
trace(lineRaw);
    }
trace(line); 
```

[Try your regex here](http://gskinner.com/RegExr/)

# kendo-ui - KendoUI 网格修改单元格删除选择

> ID：14329345
> 
> 赞同：0
> 
> 时间：2013-01-15T00:38:57.970
> 
> 标签：kendo-ui

`set`使用KendoUI 网格修改元素会删除选择。

如果 a 将 KendoUI`DataSource`定义为：

```
var dataSource = new kendo.data.DataSource({
    data    : [
        { "id": 1, "item": "item1", "value": "foo" },
        { "id": 2, "item": "item2", "value": "foo" },
        { "id": 3, "item": "item3", "value": "foo" },
        { "id": 4, "item": "item4", "value": "foo" }
    ],
    pageSize: 5
}); 
```

和`grid`作为：

```
var grid = $("#grid").kendoGrid({
    dataSource: dataSource,
    columns   : [
        { field: "item", title: "Item" },
        { field: "value", title: "Value" }
    ],
    selectable: "row"
}).data("kendoGrid"); 
```

如果我连续单击（选择它），然后使用以下代码更新模型：

```
dataSource.data()[0].set("value", "bar"); 
```

选择会丢失。

JSFiddle 中的示例代码在[这里](http://jsfiddle.net/OnaBai/DELNw/1/)

指示：

1.  选择任意行。
2.  单击用于更改`value`第一行的按钮。

更新本地时有什么方法可以保留选择`DataSource`吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-15T01:07:25.947

当数据源的更改事件发生时，这是预期的行为，网格会做出反应并重新绘制。您可以像这样默默地更新字段：

```
dataSource.data()[0].value = "bar"; 
```

但是，这不会触发更改事件，并且网格也不会更新。

要在“刷新”之间保留对 Grid 的选择，您可以使用[本](http://www.kendoui.com/code-library/web/grid/preserve-grid-state-in-a-cookie.aspx)代码库文章中介绍的方法。您可以将它们存储在 cookie 中或内存中，这取决于您。

问候

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-08-22T12:33:12.410

我能够找到一个非常相似的问题的解决方案。我尝试在修改选定行后选择下一行，但更新数据项清除了选择。

诀窍是保存`data-uid`要选择的元素。更新后，我只需按 uid 选择元素。

```
var selected = grid.select();
var next = selected.next();
var nextUid = next.data("uid");
var dataItem = grid.dataItem(selected);
if (dataItem) {
    dataItem.set("value", dataItem.get("value") - 1);
    if (next.length)
        grid.select($("#grid").find("*[data-uid='" + nextUid + "']"));
} 
```

[你可以在这里试试。](http://jsfiddle.net/r2L0smu9/3/)

# php - 根据 PHP 中的对象类型实例化不同的类

> ID：14329346
> 
> 赞同：2
> 
> 时间：2013-01-15T00:39:08.833
> 
> 标签：php

我正在寻找基于对象类型实例化不同子类或使用子类的方法扩展基类的架构解决方案。

举个例子：有一个基类**User**和几个子类**Partner**，**Cl​​ient**，**Moderator**，它们具有特定的方法和自己的构造函数。当我打电话时

```
$user = new User($userid); 
```

我想要**用户**类

```
class User
{
  public function __construct($userid) {
    self::initDB(); 

    if ($this->isPartner()) {
        //extend this class with the methods of "Partner" child class and run "Partner" class constructor
    }

    if ($this->isClient()) {
        //extend this class with the methods of "Client" child class and run "Client" class constructor
    }

    if ($this->isModerator()) {
        //extend this class with the methods of "Moderator" child class and run "Moderator" class constructor
    }
  }
} 
```

根据用户拥有的角色返回一个包含所有方法的对象。

我知道我的逻辑在某处被破坏了，我提供的示例是错误的。但我现在看到的唯一解决方案是构建一个包含所有角色的所有方法的巨型类——这看起来像一团糟。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-15T00:47:33.860

首先，您的数据库逻辑应该与您的域对象（用户等）完全分开。否则，您将违反单一责任原则 (SRP)。

设置您的类，如下所示（基类 User 和多个子类）：

```
class User 
{
  private $id;
  // getters and setters go here
}

class Moderator extends User {}
class Partner extends User {}
// etc 
```

然后，创建某种`UserManager`类来实现如下所示的接口：

```
interface UserManagerInterface {
  function loadUserById($id);
} 
```

该方法的实现应该从数据库中加载传递的用户 id 信息，查看它是什么类型（合作伙伴、主持人等），然后实例化适当的类并混合适当的信息。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-15T00:47:11.117

问题是您不能调用`new User`和获取除对象以外的任何东西`User`。

这听起来像是工厂模式的完美用例。

最简单的形式使用静态方法来调用正确的构造函数。

所以你可以有这样的代码：

```
class User {
    public static function create($userid) {
        // get user from the database

        // set $isPartner to true or false
        // set $isClient to true or false
        // set $isModerator to true or false

        if ($isPartner) {
            return new Partner($userid);
        } elseif ($isClient) {
            return new Client($userid);
        } elseif ($isModerator) {
            return new Moderator($userid);
        } else {
            return new User($userid);
        }
    }
} 
```

然后，您可以调用`User::create($userid)`以获取适当的对象。

如果您的代码结构合理，则很可能会按照 Lusitanian 的答案（充实）的方式编写代码，这样可以做得更好、更灵活。

# php - 注册用户（php & mysql）不将用户插入 mysql（无错误）

> ID：14329348
> 
> 赞同：1
> 
> 时间：2013-01-15T00:39:11.963
> 
> 标签：php, mysql

我的代码如下：

```
<?php

require("db.php");

if(isset($_POST['username']) && isset($_POST['password']) && isset($_POST['email'])){

    //prevent SQL injections
    $username = mysql_real_escape_string($_POST['username']);
    $email = mysql_real_escape_string($_POST['email']);

    //get MD5 hash of password
    $password = md5($_POST['password']);

    //check to see if username exists
    $sql = mysql_query("SELECT Username FROM Users WHERE Username = '".$username."'");

    if(mysql_num_rows($sql)>0){
        die ("Username taken. Please pick a different Username");
    }

    mysql_query("INSERT INTO Users (Username, Password, Email, UserType)
                VALUES ('$username','$password','$email','3')") 
        or die (mysql_error()); 

    echo "Account Created.";
}    
?>

<html>
    <form action="register.php" method="post">
        Username: <input name="username" ID="username" type="text"/><br>
        Password: <input name"password" id="password" type="password"/><br>
        Email: <input name="email" id="email" type="text" /><br>
        <input type = "submit" value = "Submit"/>

    </form>

</html> 
```

我不确定为什么没有创建我的用户。在过去的几个小时里，我已经尝试过研究，但我不确定为什么会出错......它看起来对我来说......

如果有人可以提供任何帮助，那就太好了。谢谢。

编辑：

```
<?php

session_start();

$host="<myDBHost>"; // Host name 
$localusername="<myDBusername>";
$localpassword="<myDBpassword";
$database_name="<mydbName>";

mysql_connect("$host", "$localusername", "$localpassword")
    or die("An error occured while establishing a connection to the DB.");
mysql_select_db($database_name); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-15T00:49:32.047

在此处查看如何设置变量的使用：

```
"SELECT Username FROM Users WHERE Username = '".$username."'" 
```

您需要始终在整个脚本中执行此操作：

```
"INSERT INTO Users (Username, Password, Email, UserType)
            VALUES ('".$username."','".$password."','".$email."','3')" 
```

还有其他方法可以做到这一点，但只需选择一种并坚持下去。

正如我上面所说：

不要`md5()`在密码上使用。您应该使用盐和散列算法。[**请不要`mysql_*`**](https://stackoverflow.com/q/12859942/)在[**新代码中使用函数**](https://stackoverflow.com/q/12859942/)。它们不再被维护[并被正式弃用](https://wiki.php.net/rfc/mysql_deprecation)。看到[**红框**](https://www.php.net/manual/en/function.mysql-connect.php)了吗？改为了解[*准备好的语句*](https://en.wikipedia.org/wiki/Prepared_statement)，并使用[PDO](http://php.net/pdo)或[MySQLi](http://php.net/mysqli) -[本文](https://php.net/manual/en/mysqlinfo.api.choosing.php)将帮助您决定使用哪个。如果您选择 PDO，[这里有一个很好的教程](http://wiki.hashphp.org/PDO_Tutorial_for_MySQL_Developers)。

好的，这是一个基于您的代码的框架，它将帮助您从正确的方向开始使用 mysqli。**请记住**，您仍然需要始终验证用户输入并对密码进行散列和加盐。还有更好的方法来显示您的错误。我这样做是为了帮助您调试脚本。

```
 <?php
session_start();
define("DB_HOST", "your host");     
define("DB_USERNAME", "your username");          
define("DB_PASSWORD", "your password"); 
define("DB_NAME", "database name");

if(isset($_POST['username']) && isset($_POST['password']) && isset($_POST['email']))
    {
    $Mysqli = new mysqli(DB_HOST, DB_USERNAME, DB_PASSWORD, DB_NAME);
        if ($Mysqli->connect_errno)
            {
                echo "Failed to connect to MySQL: (" . $Mysqli->connect_errno . ") " . $Mysqli->connect_error;
                $Mysqli->close();
            }   
    //prevent SQL injections you should validate these with form validation functions
    $username = $_POST['username'];
    $email = filter_var($_POST['email'], FILTER_VALIDATE_EMAIL);
    //get MD5 hash of password - this should be hashed and salted
    $password = md5($_POST['password']);
    //first query check if user name exist
    $query = "SELECT Username FROM Users WHERE Username = ?";

    if(!$stmt = $Mysqli->prepare($query))
          {
             echo "Failed to Prepare Query: (" . $stmt->errno . ") " . $stmt_error;

          }
    if(!$stmt->bind_param("s",$username))
          {
             echo "Failed to bind Query: (" . $stmt->errno . ") " . $stmt_error;
          }
    if($stmt->execute())
         {    
            $stmt->store_result();
            if($stmt->num_rows>0)
                {
                    die ("Username taken. Please pick a different Username");
                }
            $stmt->free_result();
        }
    //second query put user in database 
    $query = "INSERT INTO Users (Username, Password, Email, UserType)VALUES (?,?,?,?)";

    if(!$stmt = $Mysqli->prepare($query))
          {
             echo "Failed to Prepare Query: (" . $stmt->errno . ") " . $stmt_error;

          }
    if(!$stmt->bind_param("sssi",$username,$password,$email,3))
          {
             echo "Failed to bind Query: (" . $stmt->errno . ") " . $stmt_error;
          }
    if($stmt->execute())
         {    
            echo "Account Created.";
            $stmt->close();
        }
        else
            {   
                echo "Could not create account at this time.";
            }
    }
    else
        {
?>

<html>
    <form action="<?php echo htmlentities($_SERVER['PHP_SELF']);?>" method="post">
        Username: <input name="username" ID="username" type="text"/><br>
        Password: <input name"password" id="password" type="password"/><br>
        Email: <input name="email" id="email" type="text" /><br>
        <input type = "submit" value = "Submit"/>

    </form>

</html>

<?PHP
}
?> 
```

# breeze - 导航属性错误/一对零或一对关系

> ID：14329352
> 
> 赞同：0
> 
> 时间：2013-01-15T00:39:29.217
> 
> 标签：breeze

这是我的用户模型：

```
public User{
   ... (no navigation Property to modeltype)

} 
```

以下模型的灵感来自 DocCode OrderDetails->Product，其中只有 OrderDetail 具有产品的外键。对于此配置，我从微风中收到一条错误消息：用户 SB 和 TL 的“导航属性错误”，但不适用于 MA。

```
public modeltype{
  public DateTime? ClosedBySB { get; set; }

    public long? SBId { get; set; }
    [ForeignKey("SBId")]
    public User SB { get; set; }

    public DateTime? ClosedByTL { get; set; }

    public long? TLId { get; set; }
    [ForeignKey("TLId")]
    public User TL { get; set; }

    public DateTime? ClosedByMA { get; set; }

    public long? MAId { get; set; }
    [ForeignKey("MAId")]
    public User MA { get; set; }
    ....
} 
```

虽然这有效：

```
public modeltype{
  public DateTime? ClosedBySB { get; set; }

    //public long? SBId { get; set; }
    //[ForeignKey("SBId")]
    //public User SB { get; set; }

    public DateTime? ClosedByTL { get; set; }

    //public long? TLId { get; set; }
    //[ForeignKey("TLId")]
    //public User TL { get; set; }

    public DateTime? ClosedByMA { get; set; }

    public long? MAId { get; set; }
    [ForeignKey("MAId")]
    public User MA { get; set; }
    ....
} 
```

我认为这应该工作？没有进行额外的 Fluent Api 配置。谢谢你的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-17T17:11:50.260

当模型包含具有相同类型（1 对 1 关系）的 2 个以上属性时，我遇到了同样的问题。为了解决这个问题，我必须深入研究与协会合作的微风逻辑。如果当前关联具有两端，则微风似乎会分析它们中的每一个并从临时数组中删除。否则，微风会显示“不良导航属性”错误。如果有多个具有相同类型的 1 对 1 属性，微风会删除所有这些 1 对 1 关系的一端，但第一个属性除外，并显示错误。尝试在微风.js 中的“addToIncompleteMap”函数中更改此字符串：

```
 incompleteTypeMap[np.entityTypeName] = assocMap; 
```

至

```
if (incompleteTypeMap[np.entityTypeName]) 
  (incompleteTypeMap[np.entityTypeName])[np.associationName] = np;
else
   incompleteTypeMap[np.entityTypeName] = assocMap; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-29T02:45:46.477

此错误已在微风 v 1.0.0 中修复。并感谢谢尔盖指出修复。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-15T07:34:00.987

我怀疑是 EF 配置问题。

当有一个导航返回相关的用户实体时，您成功，但当您拥有三个这样的导航属性时，您会失败。您无需`[InverseProperty]`帮助 EF 解决问题，因为您不希望用户返回导航属性`ModelType`（我可以想象您为什么不想要它们）。

我认为您将不得不使用 Fluent API 来告诉 EF 您的意思。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-15T10:02:58.907

我注释掉了 ForeignKey Attributes 并将其放在 ModelType 的 Config 文件中：

```
HasOptional(p => p.SB)
            .WithMany()
            .HasForeignKey(s => s.SBId)
            .WillCascadeOnDelete(false);

        HasOptional(p => p.TL)
        .WithMany()
        .HasForeignKey(s => s.TLId)
        .WillCascadeOnDelete(false);

        HasOptional(p => p.MA)
        .WithMany()
        .HasForeignKey(s => s.MAId)
        .WillCascadeOnDelete(false); 
```

但这会产生相同的错误。SB 和 TL 抛出`bad nav property`异常。导航属性必须可以为空，所以我使用了`HasOptional()`. 我不知道在哪里放置任何其他配置，所以轻而易举地识别实体类型（SB/TL 未定义，因此例外）。

# grid - 如何创建网格以动态重新配置网格列

> ID：14329353
> 
> 赞同：0
> 
> 时间：2013-01-15T00:39:36.173
> 
> 标签：grid, extjs4

我有一个有 10 列的网格，另一个有超过 60 列的网格。我想提供这些网格的视图，其中可以选择任何列或列数以保持可见。然后提交请求以隐藏所有剩余的“未选定”网格列，使选定的列可见。

最终用户需要有一种机制，他们可以选择查看哪些列，而其余列将暂时隐藏在视图之外。我知道我可以从上下文菜单中选择每一列来隐藏每一列，但如果我有一个包含多列的网格，那么选择每一列来隐藏可能会非常困难。我想创建一种机制，用户可以选择他们想要“查看”的列并允许隐藏剩余的列。

我相信网格重新配置可能是要走的路，但没有真实的例子展示我如何选择列以允许“即时”查看，然后根据新的列模型重新配置网格。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-15T01:09:27.253

有几种方法可以解决这个问题：

1.  一种方法是遍历列并在您希望隐藏的那些上调用 hide() 方法。

2.  对于大量列，使用重新配置方法可能会更好。使用 reconfigure 和第一个参数 undefined 您可以重用最初配置的商店：

    重新配置（未定义，我的列）

# perl - Perl 正则表达式匹配中的数字符号 (#) 是什么意思？

> ID：14329355
> 
> 赞同：10
> 
> 时间：2013-01-15T00:39:50.153
> 
> 标签：perl

perl中以下语句的含义是什么？

```
($script = $0) =~ s#^.*/##g; 
```

我试图理解运算符 =~ 以及右侧 s#^.*/##g 的语句。

谢谢

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2013-01-15T00:54:17.567

[`=~`](http://perldoc.perl.org/perlop.html#Binding-Operators)将右侧的事物（模式匹配或搜索和替换）应用于左侧的事物。有很多关于`=~`那里的文档，所以我只想为[您指出一个非常好的](http://ofps.oreilly.com/titles/9781118013847/regular_expressions.html)文档。

那里有几个成语不明显，也没有很好的记录，可能会让你绊倒。让我们覆盖它们。

首先是这个...

```
($copy = $original) =~ s/foo/bar/; 
```

这是一种复制变量并在一个步骤中对其执行搜索和替换的方法。它相当于：

```
$copy = $original;
$copy =~ s/foo/bar/; 
```

*运行左侧代码后*，对左侧的`=~`任何内容进行操作。 评估为对副本执行的操作。*`($copy = $original)``$copy``=~`*

 *`s#^.*/##g`与`s/^.*\///g`使用[替代定界符](http://perldoc.perl.org/perlop.html#Quote-and-Quote-like-Operators)以避免[倾斜牙签综合症](https://en.wikipedia.org/wiki/Leaning_toothpick_syndrome)相同。您几乎可以使用任何东西作为正则表达式分隔符。 `#`很常见，尽管我认为它丑陋且难以阅读。我更喜欢`{}`，因为他们平衡。 `s{^.*/}{}g`是等效代码。

展开成语，你有这个：

```
$script = $0;
$script =~ s{^.*/}{}g; 
```

[`$0`](http://perldoc.perl.org/perlvar.html#General-Variables)是脚本的名称。所以这是复制脚本名称并将所有内容剥离到*最后一个*斜杠（`.*`贪婪并且会尽可能匹配）的代码。它只获取脚本的文件名。

`/g`表示对字符串执行尽可能多的匹配。由于这只能匹配一次（将其`^`锚定到字符串的开头）它没有任何用途。

有一种更好、更安全的方法可以做到这一点。

```
use File::Basename;
$script = basename($0); 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-01-15T02:02:55.567

这非常非常简单：

Perl*类似引号的*表达式可以采用许多不同的字符作为部分分隔符。命令之后的分隔符（在本例中为`s`）是其余操作的分隔符。例如：

```
 # Out with the "Old" and "In" with the new

 $string =~ s/old/new/;
 $string =~ s#old#new#;
 $string =~ s(old)(new);
 $string =~ s@old@new@; 
```

所有这四种表达方式都是一样的。他们用`old`我`new`的`$string`. 之后的任何`s`内容都是分隔符。请注意，括号、花括号和方括号使用配对。这对于`q`and `qq`which 可以用来代替单引号和双引号非常有效：

```
print "The value of \$foo is \"foo\"\n";   # A bit hard to read
print qq/The value of \$foo is "$foo"\n/;  # Maybe slashes weren't a great choice...
print qq(The value of \$foo is "$foo"\n);  # Very nice and clean!
print qq(The value of \$foo is (believe it or not) "$foo"\n); #Still works! 
```

最后一个仍然有效，因为引号之类的运算符计算左括号和右括号。当然，对于正则表达式，括号和方括号是正则表达式语法的一部分，因此您不会在替换中看到太多。

大多数情况下，强烈建议您坚持使用该`s/.../.../`表单只是为了便于阅读。这是人们习惯的，而且很容易消化。但是，如果你有这个怎么办？

```
$bin_dir =~ s/\/home\/([^\/]+)\/bin/\/Users\/$1\bin/; 
```

那些反斜杠会使阅读变得困难，因此传统上一直更换反斜杠分隔符以避免*山丘和山谷效应*。

```
$bin_dir =~ s#/home/([^/]+)/bin#/Users/$1/bin#; 
```

这有点难以阅读，但至少我不必引用每个正斜杠和反斜杠，因此更容易看到我要替换的内容。正则表达式很难，因为很难找到好的引号字符。各种特殊符号，如`^`、`*`、`|`和`+`是神奇的正则表达式字符，可能出现在正则表达式中，`#`是常用的符号。在字符串中不常见，在正则表达式中也没有什么特殊含义，所以不会用到。

* * *

回到你原来的问题：

```
($script = $0) =~ s#^.*/##g; 
```

相当于：

```
($script = $0) =~ s/^.*\///g; 
```

但是因为最初的程序员不想反引号那个斜线，所以他们改变了分隔符。

至于：

($script = $0) =~ s#^.*/##g;`

这和说的一样：

```
$script = $0;
$script =~ s#^.*/##g; 
```

您正在分配`$script`变量并在一个步骤中进行替换。它在 Perl 中很常见，但一开始有点难以理解。

顺便说一句，如果我理解这个基本表达式（将所有字符删除到最后一个正斜杠。这会更干净：

```
use File::Basename;
...

$script = basename($0); 
```

更容易阅读和理解——即使对于 Perl 的老手来说也是如此。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2013-01-15T00:52:27.240

在 perl 中，您可以使用多种字符作为引用字符（字符串、正则表达式、列表）。让我们分解一下：

*   `$script`为变量分配内容`$0`（包含调用脚本名称的字符串。）
*   `=~`字符是[*绑定*运算符](http://perldoc.perl.org/perlop.html#Binding-Operators)。 它调用正则表达式匹配或正则表达式搜索和替换。在这种情况下，它与新变量 匹配`$script`。
*   该`s`字符表示*搜索和替换*正则表达式。
*   该`#`字符被用作正则表达式的分隔符。正则表达式模式引号字符通常是`/`字符，但您可以使用其他字符，包括`#`在这种情况下。
*   正则表达式，`^.*/`。这意味着，“在字符串的开头，搜索零个或多个字符，直到出现斜杠。这将继续捕获每一行，但换行符除外（`.`默认情况下不匹配。）
*   指示“替换”值的`#`开始。通常，您在这里有一个模式，它使用第一行的任何捕获部分。
*   `#`再次。这结束了替换模式。由于替换模式的开始和结束之间没有任何内容，因此在第一个中找到的所有内容都将被替换为任何内容。
*   `g`，或全局匹配。搜索和替换将继续发生与值匹配的次数。

实际上，搜索并清空 value 中 / 之前的每个值，但保留脚本名称中的所有换行符。当在仅适用于类 unix 路径的长脚本中调用时，这是获取脚本名称的一种非常懒惰的方式。

如果有机会，请考虑用`File::Basename`Perl 中的核心模块替换：

```
use File::Basename;

# later ... 

my $script = fileparse($0); 
```*

# c# - 自动映射器映射动态对象

> ID：14329356
> 
> 赞同：5
> 
> 时间：2013-01-15T00:39:51.870
> 
> 标签：c#, dynamic, dictionary, automapper

我正在使用 Automapper，需要实现以下映射，但不确定如何完成。

我想将 Dictionary 对象映射到动态对象，以便键是对象上的属性，字典的值是动态对象中属性的值。

这可以通过 automapper 实现吗？如果可以，如何实现？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-01-16T10:54:42.073

您可以简单地`Dictionary`从`ExpandoObject`原始字典值中获取并填充它

```
void Main()
{
    AutoMapper.Mapper.CreateMap<Dictionary<string, object>, dynamic>()
                     .ConstructUsing(CreateDynamicFromDictionary);

    var dictionary = new Dictionary<string, object>();
    dictionary.Add("Name", "Ilya");

    dynamic dyn = Mapper.Map<dynamic>(dictionary);

    Console.WriteLine (dyn.Name);//prints Ilya
}

public dynamic CreateDynamicFromDictionary(IDictionary<string, object> dictionary)
{
    dynamic dyn = new ExpandoObject();
    var expandoDic = (IDictionary<string, object>)dyn;

    dictionary.ToList()
              .ForEach(keyValue => expandoDic.Add(keyValue.Key, keyValue.Value));
    return dyn;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-15T00:49:39.173

这是一个示例，但如果您删除评论或详细说明您的帖子，它可能更具描述性。给定这个类：

```
class Foo
{
    public Foo(int bar, string baz)
    {
        Bar = bar;
        Baz = baz;
    }

    public int Bar { get; set; }
    public string Baz { get; set; }
} 
```

您可以通过以下方式创建其公共实例属性和值的字典：

```
var valuesByProperty = foo.GetType().
     GetProperties(BindingFlags.Public | BindingFlags.Instance).
     ToDictionary(p => p, p => p.GetValue(foo)); 
```

如果要包括更多或不同的结果，`BindingFlags`请在`GetProperties`方法中指定不同的。如果这不能回答您的问题，请发表评论。

或者，假设您正在使用动态对象和匿名类型，方法类似。显然，以下示例不需要 class `Foo`。

```
dynamic foo = new {Bar = 42, Baz = "baz"};
Type fooType = foo.GetType();
var valuesByProperty = fooType.
    GetProperties(BindingFlags.Public | BindingFlags.Instance).
    ToDictionary(p => p, p => p.GetValue(foo)); 
```

# c# - PostSharp方面引入一个接口和LocationInterception切入点

> ID：14329365
> 
> 赞同：1
> 
> 时间：2013-01-15T00:41:30.143
> 
> 标签：c#, postsharp

我需要实现一个复杂的方面，它需要能够引入一个接口以及几个切入点。我不知道该怎么做。

我的目标是拦截类上的一些字段设置器，以便我可以引入一些行为（通过装饰字段上的事件处理程序）。我想转换一些数据，然后引发在特定接口上声明的事件，所以我想将此接口引入包含这些字段的类。

最简单的概念是一个容器，它捕获其子级上的所有事件并将它们转换为容器类上的单个外部事件。

所以，我知道如何使用 LocationInterceptionAspect 引入方法切入点；

```
public override void OnSetValue(LocationInterceptionArgs args)
{
    // attach event handler to args.Value.SomeEvent,
} 
```

以及如何使用 InstanceLevelAspect 引入接口/方法。

但不是如何将 2 组合成一个方面。

我不能简单地在 LocationInterceptionAspect 中引入接口或成员，因为范围是位置，而不是包含类型，并且它不会编译。

我总是可以把它分成两个方面，但这意味着每个方面都不会独立运作，我必须确保两者总是一起应用。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-15T02:08:41.020

看来我可以将 OnLocationSetValueAdvice（通过属性）添加到 InstanceLevelAspect，这很有效。

```
[IntroduceInterface(typeof(IMyInterface)]
public class CustomAspect : InstanceLevelAspect
{
    [OnLocationSetValueAdvice]
    [MulticastPointcut(Targets = MulticastTargets.Field, Attributes = MulticastAttributes.Instance)]
    public void OnSetValue(LocationInterceptionArgs args)
    {
       ...
    }
} 
```

# ruby-on-rails-3.2 - Rails Update to 3.2.11 breaks running multiple servers

> ID：14329370
> 
> 赞同：15
> 
> 时间：2013-01-15T00:41:47.293
> 
> 标签：ruby-on-rails-3.2

Our application runs two Rails servers at different ports that talk to each other. Using Rails 3.2.8, I could open a terminal, `cd` to the project, run `rails s -p3000`, open another terminal, run `rails s -p3001` and everything worked fine. The gemfile contains `thin`, so `thin` would be launched automatically, but using the `rails s` would allow using the `--debugger` when needed.

Since updating the Rails 3.2.11 this no longer works. I get an error: "A server is already running. Check /home/george/Projects/dashboard/tmp/pids/server.pid". I can launch `thin` directly on both ports, but then have no debugging support. Launching `thin` on one and `rails` on the other seemed to not work, but it was not clear that all the server tasks were getting killed when the error stopped the server.

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2013-01-21T20:45:43.433

Both commands are checking the default PID file location (`tmp/pids/server.pid`), so you're seeing this error. Try running multiple servers like so:

**Server 1:** `bundle exec rails s`

**Server 2:** `bundle exec rails s -p 3001 -P tmp/pids/server2.pid`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-15T00:41:47.293

Posted elsewhere on Stackoverflow was the mention that if you have problems with rails 3.2.11, try locking `rack` at 1.4.1\. This seems to work so far. I added:

```
gem 'rack' , '1.4.1' 
```

to the `gemfile`, and then executed

```
bundle update rack 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-10-24T07:59:04.837

try using foreman [https://github.com/ddollar/foreman](https://github.com/ddollar/foreman)

Railscast: [http://railscasts.com/episodes/281-foreman?view=comments](http://railscasts.com/episodes/281-foreman?view=comments)

# java - 需要帮助查找全面的 netbeans 插件开发教程

> ID：14329375
> 
> 赞同：5
> 
> 时间：2013-01-15T00:42:00.227
> 
> 标签：java, netbeans, netbeans-plugins

我正在尝试开发/创建一个插件，但我似乎无法找到涵盖这样做所涉及的广泛主题的 [good] 系列教程。我已经找到了[Developer FAQ Page](http://wiki.netbeans.org/NetBeansDeveloperFAQ)、[NetBeans Platform Learning Trail](http://netbeans.org/kb/trails/platform.html)和[NetBeans Platform 7.3 Plugin Quick Start](http://platform.netbeans.org/tutorials/nbm-google.html)，但是这些网站或 netbeans.org 上的类似网站都没有关于插件开发的[n广泛]教程。所以我的问题基本上是：有谁知道开发netbeans插件的好、全面的教程。一如既往，我们非常感谢任何信息、资源或建议。

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-15T01:04:49.747

您可能想要的所有文档：

[http://netbeans.org/kb/index.html](http://netbeans.org/kb/index.html)

教程：

[http://netbeans.org/kb/docs/javaee/ecommerce/intro.html](http://netbeans.org/kb/docs/javaee/ecommerce/intro.html)

插件：

[http://platform.netbeans.org/tutorials/nbm-google.html](http://platform.netbeans.org/tutorials/nbm-google.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-11-03T17:44:59.480

不知道，如果您仍在寻找答案，我想这就是您要寻找的[链接。](https://netbeans.org/kb/trails/platform.html)此链接中的视频非常详细地描述了如何在文档中查看，并且是一个非常好的快速入门指南，您还有应用程序教程，这些教程是逐步构建的真实示例，甚至还有一本书：Netbeans 初学者平台如果你想更深入，[这里](https://platform.netbeans.org/tutorials/nbm-10-top-apis.html)有一个视频列表......基本上只需仔细查看第一个链接，它有很多资源，它们只是分散的。

# php - 获取成分数量和名称的正则表达式

> ID：14329381
> 
> 赞同：1
> 
> 时间：2013-01-15T00:42:44.920
> 
> 标签：php, regex

我被要求从成分表中获取数量和成分。我已经成功地从列表中提取了数量和成分，但我被困在出现半个字符的地方，例如 ¼、½ 等。它们没有用 HTML 编码，我的正则表达式在那里失败。

这是成分清单

```
$subject = array("1 teaspoon salt",
"¼ teaspoon black pepper",
"1 cup all-purpose flour",
"1 ½ - 2 cups shredded Parmesan cheese"); 
```

## 正则表达式

```
 preg_replace ('/(([0-9][\s+]*[\-]*[0-9]*[\s+]*)(teaspoon|tablespoons|cup|cups)*)([a-z0-9\s]+)/','Quantity: $1 Name: $4',$food) 
```

## 输出

```
 Quantity: 1 teaspoon Name: salt
 ¼ teaspoon black pepper (failed)
 Quantity: 1 cup Name: all-purpose flour
 Quantity: 1 Name: ½ - Quantity: 2 cup Name: s shredded Parmesan cheese (failed) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-15T00:53:40.800

将[Unicode 代码点](http://symbolcodes.tlt.psu.edu/bylanguage/mathchart.html#fractions)合并到您的正则表达式中。乍一看，看起来适当的代码点是`[\x{00BC}-\x{00BE}\x{2153}-\x{215E}]` 您还必须使用`u`修饰符才能在 preg 中启用 unicode。

# mysql - 转移WordPress，尝试了一切

> ID：14329384
> 
> 赞同：0
> 
> 时间：2013-01-15T00:43:15.310
> 
> 标签：mysql, wordpress, installation, move, transfer

我已经为这个问题苦苦挣扎了好几个小时了。我目前有一个在 domain.com/subdomain 上运行的 Wordpress 站点。我想将此转移到 domain2.com。

我做了什么：

*   从 PHPMyAdmin 导出表。
*   在 .SQL 文件中将 domain.com/subdomain 中的“全部替换”到 domain2.com。（我什至使用替换工具来保持字符串长度或其他 -> [WP Serialized PHP Replacer](http://interconnectit.com/products/search-and-replace-for-wordpress-databases/)）
*   从 domain.com/subdomain 下载整个站点。
*   将整个网站上传到 domain2.com。
*   将 wp-config.php 中的数据库信息更改为 domain2.com 上新数据库的正确信息。
*   将 .SQL 文件导入新数据库。

现在会发生什么？好吧，当我导航到 domain2.com 时，我收到错误“无法显示网页”。我曾尝试在 domain2.com 上安装全新的 WordPress，效果非常棒。

唯一的问题是，我有数百个页面和插件以及我真正想保留的设置，我花了几天时间才把它们整理好，而客户的截止日期是明天到期。

这个`Wordpress Tools > Export`工具就像一头披着羊皮的狼，骗我把它修好。但它没有复制用户信息或插件设置。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-15T01:16:41.157

确保您的`.htaccess`文件如下所示：

```
# BEGIN WordPress

<IfModule mod_rewrite.c>
RewriteEngine On
RewriteBase /
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule . /index.php [L]
</IfModule>

# END WordPress 
```

不**喜欢**这样

```
# BEGIN WordPress

<IfModule mod_rewrite.c>
RewriteEngine On
RewriteBase /subdomain/
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule . /subdomain/index.php [L]
</IfModule>

# END WordPress 
```

# php - PHP preg_match 在子字符串之后返回字符串中的值

> ID：14329387
> 
> 赞同：1
> 
> 时间：2013-01-15T00:43:27.930
> 
> 标签：php, regex

我有一个问题，我需要返回一个存在于固定子字符串之后的数值，而不管它周围的字符串中的其他字符如何。我有点在那里，因为以下工作。

```
$string = "Created Ticket_Id#234 (Some info)";
preg_match("/Ticket Id_#([0-9]+\s)/", $string, $res);
print $res[1];

Outputs: 234 
```

但是当我得到如下字符串时。

```
$string = "Created Ticket_Id#234";
preg_match("/Ticket Id_#([0-9]+\s)/", $string, $res);
print $res[1];

Outputs: nothing 
```

有没有更好的方法可以在不寻找空白的情况下做到这一点？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-15T00:47:58.217

是的，只需使用`\b`，单词边界特殊字符类，而不是`\s`.

所以你的模式是：

```
/\bTicket_Id#([0-9]+)\b/ 
```

请注意，我将特殊字符类从捕获括号中拉出，因为您不需要捕获它。

我还注意到你的字符串有`Ticket_Id#234`，而你的正则表达式有`Ticket Id#234`。您应该根据实际情况更改正则表达式中的下划线。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-15T00:47:37.153

只需删除最终`\s`

取决于字符串或正则表达式是否正确

```
/Ticket_Id#([0-9]+)/ 
```

或者

```
/Ticket Id_#([0-9]+)/ 
```

这将在找到的最后一个数字处停止并返回搜索到的数字。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-15T00:47:05.857

一些。您可以使用单词边界：

```
"/Ticket Id_#([0-9]+)\b/" 
```

检查字符串的结尾：

```
"/Ticket Id_#([0-9]+)(\s|$)/" 
```

或者只是收集所有数字：

```
"/Ticket Id_#([0-9]+)/" 
```

# awk - 使用 awk 删除特定的空格并用分号替换

> ID：14329395
> 
> 赞同：1
> 
> 时间：2013-01-15T00:44:28.223
> 
> 标签：awk

我是 linux 和命令行的新手。我正在尝试找到一个命令，该命令将允许我用`white space`分号替换（在 .csv 文本文件中）**除第一个之外的所有字段**。请看下面的例子，任何帮助将不胜感激，我花了很长时间寻找解决方案。如果您确实有答案，请解释一下命令，以便我可以尝试了解如何以及为什么。非常感谢。

输入文本示例：

```
0   k__Bacteria  p__Firmicutes   c__Bacilli             
1   k__Bacteria  p__Firmicutes   c__Clostridia      
2   k__Bacteria  p__Bacteroidetes    c__Bacteroidia     
3   k__Bacteria  p__Bacteroidetes    c__Bacteroidia 
```

我需要的输出是：

```
0   k__Bacteria;p__Firmicutes;c__Bacilli        
1   k__Bacteria;p__Firmicutes;c__Clostridia    
2   k__Bacteria;p__Bacteroidetes;c__Bacteroidia   
3   k__Bacteria;p__Bacteroidetes;c__Bacteroidia 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-15T16:03:18.413

```
$ cat file
0   k__Bacteria  p__Firmicutes   c__Bacilli     foo     bar
1   k__Bacteria  p__Firmicutes   c__Clostridia  the   quick     brown
2   k__Bacteria  p__Bacteroidetes    c__Bacteroidia     fox jumped      over
3   k__Bacteria  p__Bacteroidetes    c__Bacteroidia     the lazy dogs back

$ awk -v skip=1 '{match($0,"([^[:space:]]+[[:space:]]+){"skip"}"); head=substr($0,1,RSTART+RLENGTH); tail=substr($0,RSTART+RLENGTH+1); gsub(/[[:space:]]+/,";",tail); print head tail}' file
0   k__Bacteria;p__Firmicutes;c__Bacilli;foo;bar
1   k__Bacteria;p__Firmicutes;c__Clostridia;the;quick;brown
2   k__Bacteria;p__Bacteroidetes;c__Bacteroidia;fox;jumped;over
3   k__Bacteria;p__Bacteroidetes;c__Bacteroidia;the;lazy;dogs;back

$ awk -v skip=2 '{match($0,"([^[:space:]]+[[:space:]]+){"skip"}"); head=substr($0,1,RSTART+RLENGTH); tail=substr($0,RSTART+RLENGTH+1); gsub(/[[:space:]]+/,";",tail); print head tail}' file
0   k__Bacteria  p__Firmicutes;c__Bacilli;foo;bar
1   k__Bacteria  p__Firmicutes;c__Clostridia;the;quick;brown
2   k__Bacteria  p__Bacteroidetes;c__Bacteroidia;fox;jumped;over
3   k__Bacteria  p__Bacteroidetes;c__Bacteroidia;the;lazy;dogs;back

$ awk -v skip=3 '{match($0,"([^[:space:]]+[[:space:]]+){"skip"}"); head=substr($0,1,RSTART+RLENGTH); tail=substr($0,RSTART+RLENGTH+1); gsub(/[[:space:]]+/,";",tail); print head tail}' file
0   k__Bacteria  p__Firmicutes   c__Bacilli;foo;bar
1   k__Bacteria  p__Firmicutes   c__Clostridia;the;quick;brown
2   k__Bacteria  p__Bacteroidetes    c__Bacteroidia;fox;jumped;over
3   k__Bacteria  p__Bacteroidetes    c__Bacteroidia;the;lazy;dogs;back 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-15T00:55:16.070

你可以像这样在python中做到这一点：

```
#!/usr/bin/env python
import sys

if __name__ == '__main__':
    for line in sys.stdin:
        cols = line.split()
        print ' '.join([cols[0], ';'.join(cols[1:])]) 
```

只是`chmod +x script`文件并执行它`./script < input`。

请注意， line.split() 将被多个空格分割，即`'a b\tc'`在`['a', 'b', 'c']`.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-15T01:17:42.957

这就是解决办法`awk`。它可能很脏，有人可以改进它，但它有效

`awk 'OFS=";"{a=$1;$1="";$0=a";"$0}sub(/;;/," ",$0) ' temp.txt`

输出是

```
0 k_Bacteria;p_Firmicutes;c_Bacilli
1 k_Bacteria;p_Firmicutes;c_Clostridia
2 k_Bacteria;p_Bacteroidetes;c_Bacteroidia
3 k_Bacteria;p_Bacteroidetes;c_Bacteroidia 
```

* * *

```
cat temp.txt
0 k_Bacteria p_Firmicutes c_Bacilli
1 k_Bacteria p_Firmicutes c_Clostridia
2 k_Bacteria p_Bacteroidetes c_Bacteroidia
3 k_Bacteria p_Bacteroidetes c_Bacteroidia 
```

**编辑：**根据评论更新

试试这个 awk 脚本`myawk.sh`

```
 BEGIN { print "Begin Processing "}
   OFS=";"{
       $9=$9"%%"
   b = $0;
   split($0,a,"%%");
   gsub(/;/," ",a[1])
   print a[1]a[2]
   }
  END {print "Process Complete"} 
```

执行`awk -f myawk.sh temp.txt`$9 是变量 uptill ，你想保留空格

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-15T07:00:57.173

```
awk -v OFS=";" '{$1=$1" "$2;$2="";gsub(/;;/,";",$0);print}' your_file 
```

或者可能在 perl 中：

```
perl -F -lane 'print join ";",@F' your_file| perl -pe 's/;/ /' 
```

# java - Hibernate 如何使用 setCacheMode(CacheMode.IGNORE) 抛出 NonUniqueObjectException？

> ID：14329396
> 
> 赞同：1
> 
> 时间：2013-01-15T00:44:34.357
> 
> 标签：java, hibernate

我具有以下代码和休眠配置的等效项（基本上， StreamRef 属于磁带，并且在该磁带上必须是唯一的）：

```
<class name="StreamRef" table="StreamRefToTape">
 <composite-id> <key-property name="UUID"/> 
   <key-many-to-one class="Tape" name="tape">
     <column name="Tape_TapeId" not-null="true"/>
   </key-many-to-one>
 </composite-id>
 ...</class>

 <class name="Tape" table="Tape">
 <id column="TapeId" name="tapeId"/></class> 
```

我有数百万个这样的 StreamRef，我想将它们全部保存在同一个事务中，但我也想在此事务期间保存在 RAM 上。

所以我尝试了下面的代码，我的假设是如果我关闭 CacheMode，那么它不会在内部跟踪对象，所以它会节省大量的 RAM（这在某种程度上似乎有帮助）。但是在测试这个假设时，像这样：

```
 session = sessionFactory.openSession();
 session.setCacheMode(CacheMode.IGNORE);   // disable the first level cache
 session.beginTransaction();
 Tape t = new Tape();
 StreamRef s1 = new StreamRef("same uuid");
 StreamRef s2 = new StreamRef("same uuid"); // force a primary key collision
 session.saveOrUpdate(t);
 for(StreamRef s : t.getStreams()) {
     session.save(s);
 }
 session.commit(); 
```

我本以为这*不会*引发，因为我关闭了 CacheMode （但它引发了 NonUniqueObjectException [https://gist.github.com/4542569](https://gist.github.com/4542569)）。有人可以确认1）休眠内部缓存*不可*禁用吗？2）这个异常与CacheMode无关？有什么方法可以在这里完成我想要的（在事务中不使用大量的休眠 RAM？）

有点相关：[https ://stackoverflow.com/a/3543740/32453](https://stackoverflow.com/a/3543740/32453)

（作为一个附带问题...... setCacheMode 被称为 vin 与 beginTransaction 关系的顺序是否重要？我认为它不重要？）

非常感谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-15T03:25:16.163

例外是有道理的。你违反了你告诉 Hibernate 你要遵守的规则。如果你真的想做你编写的代码，你需要使用 StatelessSession API 或 createSQLQuery API。就目前而言， Session.setCacheMode 用于与二级缓存交互，而不是会话缓存。

关于内存使用，您需要逐步将成批的记录刷新到磁盘，以便 Hibernate 可以清除其[ActionQueue](http://docs.jboss.org/hibernate/orm/3.5/api/)。

以下是[用户指南](http://docs.jboss.org/hibernate/orm/3.3/reference/en/html/batch.html#batch-inserts)中批量更新部分的示例：

```
Session session = sessionFactory.openSession();
Transaction tx = session.beginTransaction();

for ( int i=0; i<100000; i++ ) {
    Customer customer = new Customer(.....);
    session.save(customer);
    if ( i % 20 == 0 ) { //20, same as the JDBC batch size
        //flush a batch of inserts and release memory:
        session.flush();
        session.clear();
    }
}

tx.commit();
session.close(); 
```

您还可以在同一章中阅读有关无状态会话的内容。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-15T03:32:44.590

Hibernate 将一次保存所有会话对象...缓存将为其他会话存储对象...因此您不能禁用单个会话的对象...您不能尝试使用 merge()... .

# php - 解析网站时输出不同

> ID：14329404
> 
> 赞同：1
> 
> 时间：2013-01-15T00:45:25.747
> 
> 标签：php, asp.net, parsing, web-scraping, simple-html-dom

我正在尝试从以下网站 [http://cricos.deewr.gov.au/Institution/InstitutionDetails.aspx?ProviderID=00001](http://cricos.deewr.gov.au/Institution/InstitutionDetails.aspx?ProviderID=00001) 使用 PHP 和 simple_html_dom i抓取包含“机构名称：，机构类型：等”的表格已生成以下代码：

```
<?php
require 'simple_html_dom.php';
$html = file_get_html('http://cricos.deewr.gov.au/Institution/InstitutionDetails.aspx?ProviderID=00001');
$element = $html->find("table");
echo $element[1];
?> 
```

我已经遍历了表格（例如 $element[0]、$element[1]、$element[2] 等），但没有找到正确的表格。

然后我在网站的本地副本上尝试了相同的代码：

```
<?php
require 'simple_html_dom.php';
$html = file_get_html('Institution Details.htm');
$element = $html->find("table");
echo $element[1];
?> 
```

它有效，我可以在 $element[1] 下看到我正在寻找的表格。为什么它在本地副本上有效，但在使用 url 时无效？如何使第一组代码工作？谢谢

# java - javax.jdo.JDOFatalUserException (maven + datanucleus + jetty + com.mysql.jdbc.Driver)

> ID：14329405
> 
> 赞同：0
> 
> 时间：2013-01-15T00:45:29.460
> 
> 标签：java, maven, datanucleus

环境：Eclipse、Maven

我一直在关注[Datanucleus JDO 教程](http://www.datanucleus.org/products/accessplatform_3_2/jdo/guides/tutorial_rdbms.html)但无济于事，因为我被困在第 4 步。它有“信息”，但由于我是 Maven 新手和 Datanucleus 新手，没有明确的方法可以找到它。

我想做的只是从 AppEngine& [Objectify](http://code.google.com/p/objectify-appengine/)切换一个正常运行的项目，并将其移植到一个 Linode（使用像 Hibernate 或 Datanucleus 这样的持久层）。这与教程中声称的“Straight Forward™”相去甚远。

执行代码时出现以下错误`JDOHelper.getPersistenceManagerFactory("datanucleus.properties")`：

```
javax.jdo.JDOFatalUserException: A property named javax.jdo.PersistenceManagerFactoryClass must be specified, or a jar file with a META-INF/services/javax.jdo.PersistenceManagerFactory entry must be in the classpath, or a property named javax.jdo.option.PersistenceUnitName must be specified.
at javax.jdo.JDOHelper.getPersistenceManagerFactory(JDOHelper.java:861)
at javax.jdo.JDOHelper.getPersistenceManagerFactory(JDOHelper.java:1099)
at javax.jdo.JDOHelper.getPersistenceManagerFactory(JDOHelper.java:919)
at myproject.HelloWorld.handle(HelloWorld.java:45)
at org.eclipse.jetty.server.handler.HandlerWrapper.handle(HandlerWrapper.java:116)
at org.eclipse.jetty.server.Server.handle(Server.java:365)
at org.eclipse.jetty.server.AbstractHttpConnection.handleRequest(AbstractHttpConnection.java:485)
at org.eclipse.jetty.server.AbstractHttpConnection.headerComplete(AbstractHttpConnection.java:926)
at org.eclipse.jetty.server.AbstractHttpConnection$RequestHandler.headerComplete(AbstractHttpConnection.java:988)
at org.eclipse.jetty.http.HttpParser.parseNext(HttpParser.java:635)
at org.eclipse.jetty.http.HttpParser.parseAvailable(HttpParser.java:235)
at org.eclipse.jetty.server.AsyncHttpConnection.handle(AsyncHttpConnection.java:82)
at org.eclipse.jetty.io.nio.SelectChannelEndPoint.handle(SelectChannelEndPoint.java:628)
at org.eclipse.jetty.io.nio.SelectChannelEndPoint$1.run(SelectChannelEndPoint.java:52)
at org.eclipse.jetty.util.thread.QueuedThreadPool.runJob(QueuedThreadPool.java:608)
at org.eclipse.jetty.util.thread.QueuedThreadPool$3.run(QueuedThreadPool.java:543)
at java.lang.Thread.run(Thread.java:722) 
```

从中取得进展会很好，因为似乎可能需要再花几天时间阅读所有必需的技术才能弄清楚发生了什么，但我实际上只是想开始，所以如果是一两天的“弄清楚”我只需要选择一个“解决方案”，目前看起来它会是休眠状态。

我对 pom.xml 进行了各种修改，例如包括 ${basedir} 作为 exec:java 配置的额外类路径，并复制到[Datanucleus maven](http://www.datanucleus.org/products/accessplatform_3_2/jdo/maven.html)设置中。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-15T08:21:51.113

在我看来，错误信息是明确的

> 必须指定名为 javax.jdo.PersistenceManagerFactoryClass 的属性，或者必须在类路径中指定具有 META-INF/services/javax.jdo.PersistenceManagerFactory 条目的 jar 文件，或者必须指定名为 javax.jdo.option.PersistenceUnitName 的属性.

所以“datanucleus.properties”可能不在 CLASSPATH 的根目录下？或者你在 CLASSPATH 中没有 jdo-api.jar，或者 datanucleus-api-jdo.jar，或者其他 jar。实际打印出 CLASSPATH 并将其呈现在您的“问题描述”中，以及其下的目录结构将是一项简单的任务。

您没有说出您在第 4 步中输入的内容，因为提供的 README 文件会告诉您要做什么并且经过验证可以工作；提供的 Maven *pom.xml*与**提供的示例一起使用**。正如您所说，您正在“调整它（TM）”以适应您自己的应用程序，并且您没有展示您已更改的内容以及更改原因、代码位置等。

# jquery - Kendo UI Mobile - 使用按钮单击另一个按钮

> ID：14329406
> 
> 赞同：0
> 
> 时间：2013-01-15T00:45:47.793
> 
> 标签：jquery, css, kendo-ui

在以下场景中：

**HTML**

```
<a id="mButton" data-role="button" data-click="clickFn">myButton</a>

<asp:ImageButton runat="server" ID="aspButton" style="display: none"></asp:ImageButton> 
```

**脚本**

```
function clickFn(e) {
    $("#aspButton").click();
} 
```

当我点击“mButton”时，“aspButton”的点击事件[几乎]从未触发。我尝试绑定到“mButton”touchend 事件，但这也不起作用。

我如何能够使用带有 data-role="button" 属性的锚标记来触发 asp 按钮的单击事件？我正在使用最新的 Kendo UI Mobile 和最新的 JQuery。

谢谢！

**更新**

如果我将 clickFn 更改为以下内容，它会完美运行：

```
function clickFn(e) {
    setTimeout(function () {
        $("#aspButton").click();
    }, 400);
} 
```

这让我相信 Kendo UI Mobile 的事件处理可能与我不知道的事情有关。根据他们的论坛，Kendo UI Mobile View 转换速度为 400 毫秒。此外，即使将超时设置为 399 毫秒也无法成功执行 aspButton 单击事件。

希望这可以帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-15T01:11:14.143

您确定“ **aspButton** ”实际上是否是客户端小部件的 id 吗？（我个人对此有疑问）

您可以尝试使用jQuery 提供的[触发方法来触发事件。](http://api.jquery.com/trigger/)

# python - Python - 参数

> ID：14329409
> 
> 赞同：0
> 
> 时间：2013-01-15T00:45:52.137
> 
> 标签：python

我有这样的代码：

```
>>> def enterText(value):
    command = input ("enter text: ")
    value = command

>>> def start():
    text = ""
    enterText(text)
    print ("you entered: "+str(text)) 
```

我绑了很多东西，但我似乎无法弄清楚。我是 Python 新手，可以帮我通过函数传递字符串吗？谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-15T00:47:57.203

Python 中的字符串是*不可变*的。您需要从中返回字符串，`enterText()`以便可以在`start()`.

```
>>> def enterText():
    return input("enter text: ")

>>> def start():
    text = enterText()
    print ("you entered: " + str(text)) 
```

*不能*更改给定的字符串对象。当您调用时`enterText(text)`，`value`将引用在其中创建的空字符串对象`start()`。

分配给`value`然后重新*绑定*变量，即它将*名称*“值”与分配右侧引用的对象连接起来。对普通变量的赋值*不会*修改对象。

但是，该`text`变量将继续引用空字符串，直到您`text`再次分配给。但既然你不这样做，它就行不通。

# android - 有没有一种覆盆子ADK板

> ID：14329424
> 
> 赞同：2
> 
> 时间：2013-01-15T00:47:40.443
> 
> 标签：android, usb, raspberry-pi, adk

树莓派有没有办法通过usb电缆和gpio连接器与android设备通信（读/写），不一定是usb协议，而是使用Api并且没有root权限。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-16T15:57:43.827

[2012 年在 Google IO 上展示的ADK2](http://developer.android.com/tools/adk/adk2.html)允许 Android 手机连接 USB 主机并与之通信。Raspberry Pi 可以是一个 USB 主机，因此它可以使这项工作成为可能。

唯一需要注意的是手机很可能会进入充电模式并消耗 USB 规范允许的全部 500mA。您的 Raspberry Pi 需要能够提供这么多的电力（以及自己的电力）。

# javascript - Javascript setInterval 状态

> ID：14329426
> 
> 赞同：3
> 
> 时间：2013-01-15T00:47:55.390
> 
> 标签：javascript, setinterval

如果我正在编写包含大量间隔的 javascript，我倾向于在一组间隔对象中跟踪它们

```
function Interval(id, desc){
 this.id = id;
 this.desc = desc;
}

prototypes etc.... 
```

然后我用类似的东西创建我的区间函数

```
intervalArray.push(new Interval(setInterval(function, milli),"Demo interval")) 
```

我知道这接近强迫症，但相信我，它使问题解决变得更容易，因为当你想在运行时清除其中一两个的间隔时，在开发工具提示符下跟踪那些糟糕的事情更简单。

那么问题...

给定一个区间 id，有没有办法访问它的当前状态？

即，如果我将间隔 x 设置为 300000 的重复时间以每五分钟触发一次，有没有办法获得 x.timer，一个在一分钟后返回 60000 的函数？

现在有几次，在调试时，知道给定间隔与触发有多接近会很有用。

我想我可以向我的间隔对象添加另一个值 - .lastFired，用 0 启动它，并在它触发时用时间戳更新它，但大概浏览器会在某处跟踪间隔......

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-15T01:11:26.993

您可以进一步扩展您的区间函数：

```
function Interval(fn, desc, ms){
  this.desc = desc;
  this.status = -1;

  var that = this;

  this.id = window.setInterval(function () {

    // save some progess to the Interval object
    // that is used, because in interval callback this === window
    that.status++;

    // now call your function fn, using this === Interval object
    fn.call(that);
  }, ms);

  this.stop = function () {
    if (this.id) {
      window.clearInterval(this.id);
      this.id = 0;
      this.status = -1;
    }
  };
}

// Usage:
var myInterval = new Interval(function () {
  // frequent action

  // this === Interval object instance
  if (this.status === 5) this.stop();
}, "description", 10000); 
```

现在，您还可以创建一个 onprogress 事件处理程序，例如回调，以便在您的进度更改时收到通知。您还可以将`this.id = window.setInterval(...`语句移动到`this.start = function () {`公共函数中，以便稍后启动和停止。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-15T00:56:28.823

浏览器安排回调在间隔到期时运行。在其内部事件循环的每个“滴答”中，它都会检查是否有任何间隔已过期。如果是，则调用其回调。浏览器如何跟踪时间间隔取决于实现，但没有显示在调用回调之前它将等待多长时间。所以**没有**。`:(`

# rspec - 使用 Faraday 和 Rspec 存根

> ID：14329429
> 
> 赞同：8
> 
> 时间：2013-01-15T00:47:59.700
> 
> 标签：rspec, mocking, stubbing, faraday

我有一个看起来像这样的模型：

```
class Gist
    def self.create(options)
    post_response = Faraday.post do |request|
      request.url 'https://api.github.com/gists'
      request.headers['Authorization'] = "Basic " + Base64.encode64("#{GITHUB_USERNAME}:#{GITHUB_PASSWORD}")
      request.body = options.to_json
    end
  end
end 
```

和一个看起来像这样的测试：

```
require 'spec_helper'

describe Gist do
  context '.create' do
    it 'POSTs a new Gist to the user\'s account' do
      Faraday.should_receive(:post)
      Gist.create({:public => 'true',
                   :description => 'a test gist',
                   'files' => {'test_file.rb' => 'puts "hello world!"'}})
    end
  end
end 
```

不过，这个测试并不能真正让我满意，因为我正在测试的是我正在使用 Faraday 进行一些 POST，但我实际上无法测试 URL、标头或正文，因为它们是通过一个块。我尝试使用 Faraday 测试适配器，但我也没有看到任何测试 URL、标头或正文的方法。

有没有更好的方法来编写我的 Rspec 存根？或者我是否能够以某种我无法理解的方式使用法拉第测试适配器？

谢谢！

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-01-16T07:27:40.927

我的朋友@n1kh1l 向我指出了 Rspec`and_yield`方法和[这篇 SO 帖子](https://stackoverflow.com/questions/12641631/rspec-use-test-double-as-block-argument)，它让我可以像这样编写我的测试：

```
require 'spec_helper'

describe Gist do
  context '.create' do
    it 'POSTs a new Gist to the user\'s account' do
      gist = {:public => 'true',
              :description => 'a test gist',
              :files => {'test_file.rb' => {:content => 'puts "hello world!"'}}}

      request = double
      request.should_receive(:url).with('https://api.github.com/gists')
      headers = double
      headers.should_receive(:[]=).with('Authorization', "Basic " + Base64.encode64("#{GITHUB_USERNAME}:#{GITHUB_PASSWORD}"))
      request.should_receive(:headers).and_return(headers)
      request.should_receive(:body=).with(gist.to_json)
      Faraday.should_receive(:post).and_yield(request)

      Gist.create(gist)
    end
  end
end 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2016-02-08T16:10:54.893

您可以使用优秀的 WebMock 库来存根请求并测试已发出请求的期望，[请参阅文档](https://github.com/bblimke/webmock#setting-expectations-in-rspec-with-a_request)

在您的代码中：

```
Faraday.post do |req|
  req.body = "hello world"
  req.url = "http://example.com/"
end

Faraday.get do |req|
  req.url = "http://example.com/"
  req.params['a'] = 1
  req.params['b'] = 2
end 
```

在 RSpec 文件中：

```
stub = stub_request(:post, "example.com")
  .with(body: "hello world", status: 200)
  .to_return(body: "a response to post")
expect(stub).to have_been_requested

expect(
  a_request(:get, "example.com")
    .with(query: { a: 1, b: 2 })
).to have_been_made.once 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2020-07-21T08:54:18.753

我的解决方案：

```
stub_request(method, url).with(
  headers: { 'Authorization' => /Basic */ }
).to_return(
  status: status, body: 'stubbed response', headers: {}
) 
```

使用 gem **webmock**

您可以通过替换来加强验证：

```
/Basic */ -> "Basic #{your_token}" 
```

# javascript - 将 10000 等数字格式化为 10k

> ID：14329430
> 
> 赞同：-1
> 
> 时间：2013-01-15T00:48:10.323
> 
> 标签：javascript, jquery

我有一个 5 位数字，比如`10000`，我想将它显示为`10k`，因为我最终会有 6 位数字（实际上我说的是 Twitter 计数）。我想我必须使用子字符串，但我还没有习惯 JavaScript。

这只是关于我正在尝试使用的内容。它基本上通过 JSON 获取关注者的数量。

```
<script type="text/javascript">
    $(function() {
        $.ajax({
            url: 'http://api.twitter.com/1/users/show.json',
            data: {
                screen_name: 'lolsomuchcom'
            },
            dataType: 'jsonp',
            success: function(data) {
            $('#followers').html(data.followers_count);
                }
        });
    });
</script> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-15T01:08:59.803

尝试 ：

```
$('#followers').html(Math.floor(data.followers_count/1000) + 'K'); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-15T00:53:55.693

```
$('#followers').html(data.followers_count.substring(0, data.followers_count.length - 3)); 
```

演示：http: [//jsfiddle.net/ZWfPW/](http://jsfiddle.net/ZWfPW/)

编辑..这是文字代码，仅供您使用：

```
$(function() {
    $.ajax({
        url: 'http://api.twitter.com/1/users/show.json',
        data: {
            screen_name: 'lolsomuchcom'
        },
        dataType: 'jsonp',
        success: function(data) {
            // Ensure it's a string
            data.followers_count += '';
            $('#followers').html(data.followers_count.substring(0, data.followers_count.length - 3) + 'K');
        }
    });
}); 
```

# jquery - 使用 JSON 文件创建 highchart 饼图

> ID：14329432
> 
> 赞同：0
> 
> 时间：2013-01-15T00:48:27.090
> 
> 标签：jquery, json, highcharts

嗨，我想使用此 JSON 数据创建一个高饼图，通过将用户 ID 替换为人数来显示喜欢足球俱乐部（例如切尔西）的人数，但我无法实现：

```
{
  "data": [
    {
      "id":    "/en/chelsea_fc",
      "topic": "Chelsea F.C.",
      "audience": [{
        "information": [
          {
            "category": "Athlete",
            "source":   "Didier Drogba"
          },
          {
            "category": "Athlete",
            "source":   "Frank Lampard"
          },
          {
            "category": "Professional sports team",
            "source":   "Chelsea Football Club"
          },
          {
            "category": "favorite_teams",
            "source":   "Chelsea Football Club"
          }
        ],
        "userid": "100003914111287"
      }],
      "type":  "/soccer/football_team"
    },
    {
      "id":    "/en/manchester_united_fc",
      "topic": "Manchester United F.C.",
      "audience": [{
        "information": [
          {
            "category": "Athlete",
            "source":   "Ryan Giggs"
          },
          {
            "category": "Professional sports team",
            "source":   "Manchester United"
          },
          {
            "category": "favorite_teams",
            "source":   "Manchester United"
          }
        ],
        "userid": "100003921730958"
      }],
      "type":  "/soccer/football_team"
    }
  ]
} 
```

这是我尝试过的，但它不起作用：

```
var pts = [];
$.each(json.data, function(i,v){
    pts.push([v.topic, v.audience.length]);
});

 var chart;
    $(document).ready(function() {
        chart = new Highcharts.Chart({
            chart: {
                renderTo: 'container',
                plotBackgroundColor: null,
                plotBorderWidth: null,
                plotShadow: false
            },
            title: {
                text: 'Facebook like'
            },
            tooltip:{
                pointFormat: '{series.name}: <b>{point.percentage}%</b>',
                percentageDecimals: 0
                }

            ,
            plotOptions: {
                pie: {
                    allowPointSelect: true,
                    cursor: 'pointer',
                    point: {
                        events:{
                            click: function (event){
                                //var personame =" ";
                                var id ="10150616324193820";
                                for (var i = 0; i < jsonFB.user1.length; i++) {
                                    for (var k = 0; k < json.data.length; k++) {
                                        for (var j = 0; j < json.data[k].audience.length; j++) {

                                       if (jsonFB.user1[i].id = json.data[k].audience[j].userid) {
                                            var personname = jsonFB.user1[i].name;

                                            var id = 100003921730958;

                                            }

                                       else {

                                           alert("Error!");

                                             }

                                             }

                                            }

                                    alert("Person who like "+this.name +"  are"+ personname);
                                    var ans = confirm("Do you want to view this person profile?");
                                    if (ans)
                                      window.location="http://www.facebook.com/people/@/"+id;

                            }
                        }
                        }
                    },
                    showInLegend: true ,
                    dataLabels: {
                        enabled: true,
                        color: '#000000',
                        connectorColor: '#000000',

                        formatter: function() {
                            return '<b>'+ this.point.name +'</b>: '+ Math.round(this.percentage) +'%';
                        }

                    }
                }
            },

            series: [{
                type: 'pie',
                name: 'Likes',
                data: pts

            }]
        });
    });

}); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-31T11:06:58.573

你应该修改你的解析器，因为在这一行

```
pts.push([v.topic, v.audience.length]); 
```

长度不正确，但您需要从信息长度中获取值。因此，解析器应如下所示：

```
$.each(tmp.data, function(i,v){
    pts.push([v.topic, v.audience[0].information.length]);
}); 
```

其中 tmp.data 是来自 JSON 的数据。

# c# - 获取具有任何签名的任何方法的 MethodInfo（任何签名的委托）

> ID：14329433
> 
> 赞同：3
> 
> 时间：2013-01-15T00:48:27.983
> 
> 标签：c#, reflection, delegates

我想编写一个方法来分析任何方法的自定义属性（具有任意数量的参数和任何返回类型），只知道方法信息。此函数将检查方法是否具有特定属性。像这样：`var tmp = methodInfo.GetCustomAttributes(typeof(LineItemAttribute),false);`如果它具有这样的属性，它将执行它。我想让该函数的调用非常易于使用。`GetMethodAttributes`因此，在示例中，我想调用三种方法和方法。

```
class Test
{
      public static void Main()
      {
      }

      public void Test1(){}

      public void Test2(int a){}

      public void Test3(object a, string c, Boolean d);

      public void GetMethodAttributes(MethodInfo mi) {}
} 
```

理想情况下，我想写这样的东西

```
public static void Main()
    {
        var t = new Test();
        GetMethodAttributes(t.Test1);
        GetMethodAttributes(t.Test2);
        GetMethodAttributes(t.Test3);
    } 
```

我不想使用方法名称的字符串表示，因为方法名称可能会更改，如下所示：

```
MethodInfo info = type.GetMethod(name); 
```

我有什么选择吗？基本上我需要一种将委托用于具有不同特征的函数的方法

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-15T12:38:41.643

正如[克里斯辛克莱](https://stackoverflow.com/users/1269654/chris-sinclair)在上面的评论中指出的那样；您可以使用委托而不使用反射或表达式树来获取`MethodInfo`. 缺点是编译器无法推断出泛型参数，因此您必须指定委托类型以匹配给定方法的签名，如下所示：

```
public class Test
{
    public static void Main()
    {
        var t = new Test();
        CheckMethodAttributes<Action>(t.Test1);
        CheckMethodAttributes<Action<int>>(t.Test2);
        CheckMethodAttributes<Action<object, string, bool>>(t.Test3);
    }

    public void Test1() { }

    public void Test2(int a) { }

    public void Test3(object a, string c, bool d) { }

    public static void CheckMethodAttributes<T>(T func)
    {
        MethodInfo method = new MethodOf<T>(func);

        // Example attribute check:
        var ignoreAttribute = method.GetAttribute<IgnoreAttribute>();
        if (ignoreAttribute != null)
        {
            // Do something here...
        }
    }
} 
```

这使用了两个实用程序类，用于从给定`MethodOf<T>`中提取和一些用于获取强类型自定义属性检索：`MethodInfo``Delegate``AttributeUtils`

```
public static class AttributeUtils
{
    public static bool HasAttribute<TAttribute>(this MemberInfo member, bool inherit = true)
        where TAttribute : Attribute
    {
        return member.IsDefined(typeof(TAttribute), inherit);
    }

    public static TAttribute GetAttribute<TAttribute>(this MemberInfo member, bool inherit = true)
        where TAttribute : Attribute
    {
        return member.GetAttributes<TAttribute>(inherit).FirstOrDefault();
    }

    public static IEnumerable<TAttribute> GetAttributes<TAttribute>(this MemberInfo member, bool inherit = true)
        where TAttribute : Attribute
    {
        return member.GetCustomAttributes(typeof(TAttribute), inherit).Cast<TAttribute>();
    }
}

public class MethodOf<T>
{
    public MethodOf(T func)
    {
        var del = func as Delegate;
        if (del == null) throw new ArgumentException("Cannot convert func to Delegate.", "func");

        Method = del.Method;
    }

    private MethodInfo Method { get; set; }

    public static implicit operator MethodOf<T>(T func)
    {
        return new MethodOf<T>(func);
    }

    public static implicit operator MethodInfo(MethodOf<T> methodOf)
    {
        return methodOf.Method;
    }
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-15T01:21:48.660

您可以使用[Expression Trees](http://msdn.microsoft.com/en-us/library/bb397951.aspx)执行类似的操作，在其中通过 lambda 表达式传递方法。但是，您仍然需要为参数传递存根值。有关此操作的一个很好的示例，请查看[Moq](http://code.google.com/p/moq/)的源代码，它广泛使用此模式来设置单元测试的模拟行为。请注意，这不是一件容易设置的事情。如果你需要一些相对快速和肮脏的东西，你最好的选择可能是使用良好的重构工具和/或自动化测试来帮助处理重命名问题的字符串名称。

# asp.net-mvc - 将 SimpleMembership 与 WPF 应用程序一起使用

> ID：14329443
> 
> 赞同：1
> 
> 时间：2013-01-15T00:49:40.817
> 
> 标签：asp.net-mvc, wcf, wcf-client

我使用 ASP.NET SIMPLE MEMBERSHIP 开始了我的项目。现在我有必要创建一个可以将用户添加到 SIMPLEM MEMBERSHIP 表的 WPF 应用程序。

在 ASP.NET 中，我发现这是创建新帐户的函数：

```
 WebSecurity.CreateUserAndAccount(model.UserName, model.Password); 
```

您会建议在桌面应用程序中实现此功能吗？我正在考虑创建一个 WCF Web 服务，但我不知道创建它有多么困难。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-15T01:02:32.530

您可以使用 WCF，但可能最简单的解决方案是将 Asp.net 简单成员表作为实体框架模型的一部分，并在 WPF 应用程序中使用该模型。查看这篇[文章](http://blog.spontaneouspublicity.com/including-asp-net-simple-membership-tables-as-part-of-your-entity-framework-model)了解更多详情。

当然，这需要直接访问您的 SQL Server，并且必须使用可以访问从 EF 模型引用的表的 SQL Server 帐户，或者应用程序用户必须通过集成安全性访问 SQL Server （如果对 SQL Server 使用混合模式身份验证）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-15T03:35:08.837

何必？

我只想让您的用户转到一个链接并通过 asp.net 页面在线注册一个帐户。注册后，提供 WPF/windows 客户端作为下载。这些东西几乎都是内置的。

该链接可能会有所帮助： [http ://weblogs.asp.net/jgalloway/archive/2012/08/29/simplemembership-membership-providers-universal-providers-and-the-new-asp-net-4-5-web -forms-and-asp-net-mvc-4-templates.aspx](http://weblogs.asp.net/jgalloway/archive/2012/08/29/simplemembership-membership-providers-universal-providers-and-the-new-asp-net-4-5-web-forms-and-asp-net-mvc-4-templates.aspx)

# jquery - 获取localStorage数据并通过Porthole js跨域发送

> ID：14329444
> 
> 赞同：2
> 
> 时间：2013-01-15T00:49:42.007
> 
> 标签：jquery, iframe, local-storage

我正在做一个像 dabblet 这样的在线代码编辑器，带有添加引导程序或仅规范化以帮助用户的选项，我使用**localStorage**在他们刷新页面时返回代码，同时保留他们选择的选项。

[JS代码](https://github.com/thinkxl/docss/blob/master/js/app.js)，[现场演示](http://thinkxl.github.com/docss/)

我正在使用 iframe 跨域通信和 PortholeJS 来做到这一点。

当用户键入代码时，它的 .val() 保存在 localStorage 上，因此当用户刷新页面时，我想从 localStorage 获取代码并保存在 var 上，然后再次显示在编辑器上并发送帖子PortholeJS 到 iframe，但是当我刷新时只能取回代码，但我没有在 iframe 上得到结果

```
 getLocalStorageData: function(){
        cssMSG = "/* Do your CSS here! */";
        htmlMSG = "<!-- Do your HTML here! -->";

        // If the localStorage is empty then set the default msgs
        if (!localStorage.getItem('cssDB')) { localStorage.setItem('cssDB', cssMSG); }
        if (!localStorage.getItem('htmlDB')) { localStorage.setItem('htmlDB', htmlMSG); }

        // Save the data on a object
        getCSSData = localStorage.getItem('cssDB');
        getHTMLData = localStorage.getItem('htmlDB');

        // Send the data to the code editors
        docss.setValue(getCSSData);
        dohtml.setValue(getHTMLData);

        // Set an option like overflow-x: break-word on the code editors
        dohtml.session.setUseWrapMode(true);
        docss.session.setUseWrapMode(true);

        // This send the data to the iframe from the code editors when load the page
        windowProxy.post({'html' : getHTMLData });
        windowProxy.post({'css' : getCSSData });
    }, 
```

对不起，我的英语不好

# javascript - 从下拉列表中调用 javascript 函数

> ID：14329445
> 
> 赞同：3
> 
> 时间：2013-01-15T00:49:50.363
> 
> 标签：javascript, html

我现在有这个 HTML 代码：

```
Theme
<ul id="dropdown">
    <li> Choose theme
        <ul> 
            <li id="stylesheet1" > <a href="#"> Default </a></li>
            <li id="stylesheet2" > <a href="#"> Theme 1 </a></li>
            <li id="stylesheet3" > <a href="#"> Theme 2 </a></li>
            <li id="stylesheet4" > <a href="#"> Theme 3 </a></li>

        </ul>
    </li>
</ul> 
```

在一个单独的 javascript 文档中，我有以下代码：

```
function initate()
{

document.getElementById("myList").onchange = function() {
   var sheet=document.getElementById("myList").value;

   if(sheet=="one"){
   setActiveStyleSheet("theme1");
   }
   else if(sheet=="two"){
   setActiveStyleSheet("theme2");
   }
   else if(sheet="three"){
   setActiveStyleSheet("theme3");
   }
   else{
   setActiveStyleSheet("default");
   }
   return false
};

}

window.onload = initate; 
```

现在这很好用，但不是我在上面使用的下拉菜单，而是我想使用这个 HTML 代码：

```
Select Theme
<form>
<select id="myList" >
  <option id="stylesheet1">Default</option>
  <option id="stylesheet2">Theme 1</option>
  <option id="stylesheet3">Theme 2</option>  
  <option id="stylesheet4">Theme 3</option>
</select>
<form> 
```

和以前一样，我希望在单独的 javascript 文档中包含我的事件处理程序。我试图将我的 javascript 替换为这些函数：

```
document.getElementById("stylesheet1").onchange = function() {
   setActiveStyleSheet("default");
   return false
}; 
```

但它不起作用。您如何以这种方式纠正呼叫功能？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-15T00:59:15.900

演示：http: [//jsfiddle.net/zYMFa/](http://jsfiddle.net/zYMFa/)

使用选项的值并处理选择的更改事件。select 的 value 属性获取所选选项的值，因此您可以在 change 函数中使用 this.value。

```
<form>
<select id="myList" >
  <option value="default">Default</option>
  <option value="theme1">Theme 1</option>
  <option value="theme2">Theme 2</option>  
  <option value="theme3">Theme 3</option>
</select>
<form>

document.getElementById("myList").onchange = function() {
   setActiveStyleSheet(this.value);
   return false
}; 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-01-15T00:57:26.563

```
<select id="myList" >
  <option id="stylesheet1" value="default">Default</option>
  <option id="stylesheet2" value="one">Theme 1</option>
  <option id="stylesheet3" value="two">Theme 2</option>  
  <option id="stylesheet4" value="three">Theme 3</option>
</select>

document.getElementById("myList").onchange = function() {
   var sheet=document.getElementById("myList").value;

   if(sheet=="one"){
   setActiveStyleSheet("theme1");
   }
   else if(sheet=="two"){
   setActiveStyleSheet("theme2");
   }
   else if(sheet=="three"){
   setActiveStyleSheet("theme3");
   }
   else{
   setActiveStyleSheet("default");
   }
   return false
}; 
```

# ajax - Safari 会在 iOS 6.0/6.0.1 中缓存 AJAX POST 请求的结果多长时间？

> ID：14329449
> 
> 赞同：1
> 
> 时间：2013-01-15T00:50:08.417
> 
> 标签：ajax, caching, safari, ios6

我最近遇到了 Safari 在 iOS 6.0 和 6.0.1 中缓存 AJAX POST 请求结果的问题，如[本问题](https://stackoverflow.com/questions/12506897/is-safari-on-ios-6-caching-ajax-results)所述。

我已经实施了一种解决方法，以便该应用程序现在将为`Cache-Control: no-cache`POST 请求的所有响应添加一个标头。该应用程序是一个 ASP.NET Web 应用程序，之前`private`为`Cache-Control`标头返回一个值，我想这是默认值（我们没有在任何地方明确设置它）。没有包括时间跨度。

虽然该解决方法对首次向特定 URL 提交请求的最终用户非常有用，但已经缓存数据的用户仍可能受到影响。在没有为 Safari 提供特定缓存时间跨度的情况下，它会在 POST 请求数据过期之前缓存多长时间？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-15T00:54:30.420

如果您对此感到担忧并且想要清除缓存的请求，您可以随时更改 POST 请求，方法是添加一些您甚至不关心的值的新隐藏字段。由于这是一个新请求，浏览器不应依赖它的缓存响应。

# f# - F# 类型约束和反射

> ID：14329454
> 
> 赞同：6
> 
> 时间：2013-01-15T00:50:28.760
> 
> 标签：f#

有没有办法通过反射来确定给定的类型参数是否满足 F# 比较约束？

我怀疑不是，因为表达式

```
typedefof<Set<_>>.MakeGenericType [| typeof<System.Type> |] 
```

似乎没有产生任何错误。不过，我还是想听听一些权威的意见。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-01-15T15:11:22.987

引用 Don Syme[关于平等和比较约束的详尽帖子](https://docs.microsoft.com/en-us/archive/blogs/dsyme/equality-and-comparison-constraints-in-f)：

约束*类型 : 比较*在以下情况下成立：

*   如果类型是命名类型，则类型定义没有*NoComparison*属性；和
*   类型定义实现*System.IComparable*；和
*   该类型的任何“比较依赖项”也满足*ty [i]：比较*

约束`'T when 'T :> IComparable`可以在 CIL 中编码并反映在上面，而`'T when 'T : comparison`.

由于这两个约束不等价，`comparable`使用约束标记类型`IComparable`有点误导，因为使用反射无法区分两者。

`equality`约束和之间有类似的关系`IEquatable<_>`。

编辑

Jack 提到`comparison`可以在 F# 元数据中编码约束，这促使我查看了 PowerPack 中的元数据阅读器。它可用于检测约束：

```
open Microsoft.FSharp.Metadata

let setEntity = FSharpAssembly.FSharpLibrary.GetEntity("Microsoft.FSharp.Collections.FSharpSet`1")
for typeArg in setEntity.GenericParameters do
  printfn "%s - comparison=%b" 
    typeArg.Name 
    (typeArg.Constraints |> Seq.exists (fun c -> c.IsComparisonConstraint)) 
```

`IComparable`这是一个人为的例子，显示了实施和满足之间的差异`comparison`：

```
type A() = 
  interface IComparable with
    member __.CompareTo(_) = 0

[<NoComparison>]
type B() =
  inherit A()

type C<'T when 'T : comparison>() = class end
type D<'T when 'T :> IComparable>() = class end

let c = C<B>() //ERROR
let d = D<B>() //OK 
```

# angularjs - Angular UI / select2 多个如何预选值/选项？

> ID：14329456
> 
> 赞同：4
> 
> 时间：2013-01-15T00:50:37.977
> 
> 标签：angularjs, jquery-select2, angular-ui

将 angular-ui 与 select2 一起使用，如下所示：

```
<select ui-select2 ng-model="search.categories" multiple style="width:300px" data-placeholder="select category">
      <option value="open" >open</option>
      <option value="close" >close</option>
</select> 
```

我应该在哪里以及如何预选选项？默认情况下，选择的选项只有第一个。不知何故在控制器中？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-15T01:20:53.877

对于一个简单`<select>`的列表很容易：

```
MyController function($scope) {
    $scope.search = {
        categories: 'close'
    };
} 
```

因为`<input>`它变得更棘手，因为您可能需要添加一个`initSelection`选项

# qt - 结构填充不正确

> ID：14329459
> 
> 赞同：1
> 
> 时间：2013-01-15T00:50:58.923
> 
> 标签：qt, struct, bytearray

我有以下结构：

```
typedef union
{
    struct
    {
        unsigned char       ID;
        unsigned short      Vdd;

        unsigned char       B1State;
        unsigned short      B1FloatV;
        unsigned short      B1ChargeV;
        unsigned short      B1Current;
        unsigned short      B1TempC;
        unsigned short      B1StateTimer;
        unsigned short      B1DutyMod;

        unsigned char       B2State;
        unsigned short      B2FloatV;
        unsigned short      B2ChargeV;
        unsigned short      B2Current;
        unsigned short      B2TempC;
        unsigned short      B2StateTimer;
        unsigned short      B2DutyMod;

    } bat_values;
    unsigned char buf[64];
} BATTERY_CHARGE_STATUS; 
```

我从一个数组中填充它，如下所示：

```
for(unsigned char ii = 0; ii < 64; ii++) usb_debug_data.buf[ii]=inBuffer[ii]; 
```

我可以看到该数组具有以下（任意）值：

```
inBuffer[0] = 80;
inBuffer[1] = 128;
inBuffer[2] = 12;
inBuffer[3] = 0;
inBuffer[4] = 23;
... 
```

现在我想通过更改 QEditLine 的文本来显示这些值：

```
str=QString::number((int)usb_debug_data.bat_values.ID);
ui->batID->setText(str);
str=QString::number((int)usb_debug_data.bat_values.Vdd)
ui->Vdd->setText(str);
str=QString::number((int)usb_debug_data.bat_values.B1State)
ui->B1State->setText(str);
... 
```

但是，QEditLine 文本值没有按预期出现。我看到以下内容：

```
usb_debug_data.bat_values.ID = 80 (correct)
usb_debug_data.bat_values.Vdd = 12 (incorrect)
usb_debug_data.bat_values.B1State = 23 (incorrect) 
```

看起来像'usb_debug_data.bat_values.Vdd'，这是一个简短的，没有从inBuffer [1]和inBuffer [2]中获取它的值。同样，“usb_debug_data.bat_values.B1State”应该从 inBuffer[3] 中获取它的值，但由于某种原因正在从 inBuffer[4] 中获取它的值。

知道为什么会这样吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-15T00:54:17.013

C 和 C++ 可以自由地在结构的元素之间以及最后一个元素之外插入填充，无论出于何种目的（通常是效率，但有时是因为底层架构根本不允许未对齐的访问）。

所以你可能会发现两字节长度的项目与两字节边界对齐，所以你最终会得到类似的东西：

```
unsigned char       ID;          // 1 byte
//                                  1 byte filler, aligns following short
unsigned short      Vdd;         // 2 bytes
unsigned char       B1State;     // 1 byte
//                                  3 bytes filler, aligns following int
unsigned int        myVar;       // 4 bytes 
```

许多编译器将允许您指定如何打包结构，例如：

```
#pragma pack(1) 
```

或`gcc`：

```
__attribute__((packed)) 
```

属性。

如果您不想（或不能）打包您的结构，您可以恢复为逐字段复制（可能是函数中最好的）：

```
void copyData (BATTERY_CHARGE_STATUS *bsc, unsigned char *debugData) {

    memcpy (&(bsc->ID), debugData, sizeof (bsc->ID));
    debugData += sizeof (bsc->ID);

    memcpy (&(bsc->Vdd), debugData, sizeof (bsc->Vdd));
    debugData += sizeof (bsc->Vdd);

    : : :

    memcpy (&(bsc->B2DutyMod), debugData, sizeof (bsc->B2DutyMod));
    debugData += sizeof (bsc->B2DutyMod); // Not really needed

} 
```

您必须保持结构和功能同步是一种痛苦，但希望它不会发生太大变化。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-15T00:56:27.793

默认情况下不*打包*结构，因此编译器可以自由地在成员之间插入填充。最常见的原因是为了确保某些机器相关的对齐。[*关于数据结构对齐*](http://en.wikipedia.org/wiki/Byte_packing)的[维基百科条目](http://en.wikipedia.org/wiki/Byte_packing)*是一个很好的起点。你基本上有两个选择：*

 *1.  插入编译器特定的编译指示以强制对齐（例如，`#pragma packed`或`__attribute__((packed))__`.
2.  编写显式序列化和反序列化函数以将结构转换为字节数组和从字节数组转换为字节数组

我通常更喜欢后者，因为它不会让我的代码变得丑陋，到处都有很少的编译器特定的装饰。

接下来您可能会发现多字节整数的字节顺序也是特定于平台的。 [查找*字节序*以获取更多详细信息](http://en.wikipedia.org/wiki/Endianness)*

# android - 导航方法上有 WebView 吗？

> ID：14329464
> 
> 赞同：1
> 
> 时间：2013-01-15T00:51:42.467
> 
> 标签：android, android-webview

我有一个加载某个 URL 的 WebView，在加载时我为网站设置了一些 cookie。我注意到如果用户点击网站上的任何链接，我设置的 cookie 不会影响新页面。有没有办法在每次有页面导航时设置 cookie？这是我设置 cookie 的代码。

```
CookieManager cookieManager = CookieManager.getInstance(); 
cookieManager.setAcceptCookie(true);
cookieManager.setCookie("URL HERE", "COOKIES HERE"); 
```

在导航时，我计划使用以下代码为新页面设置 cookie。

```
CookieManager cookieManager = CookieManager.getInstance(); 
cookieManager.setAcceptCookie(true);

cookieManager.setCookie(browser.getUrl(), "My Cookies"); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-16T01:58:11.703

我找到了。您可以在 onCreate 方法中使用以下代码。

```
final WebView browser = (WebView) findViewById(R.id.webView1);

        browser.setWebViewClient(new WebViewClient( ) {

                @Override
                public void onLoadResource(WebView view, String url) {

                CookieManager cookieManager = CookieManager.getInstance(); 
                cookieManager.setAcceptCookie(true);
                cookieManager.setCookie("URL HERE, "COOKIES HERE");

                }

            }); 
```

# php - m2epro 模板的 magento 标记标签

> ID：14329466
> 
> 赞同：0
> 
> 时间：2013-01-15T00:52:08.380
> 
> 标签：php, magento, m2e

我正在开发一个具有 M2EPro 扩展的 magento 站点，其中包含一个 ebay 模板。前一个开发人员创建的页面具有如下标记：

```
#ebay_name#
#sku#
#description#
{{block id="ebay_shipping"}} 
```

这些是内置在magento中的吗？在哪里可以获得我可以放入 html 模板的其他标签的列表？我已经深入研究了 magento 文档，但找不到任何关于此的内容。谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-15T02:51:58.870

它们不是内置在 magento 中的，它们可以通过 PHP 或 XML 看到。一个很好的轮廓可以在[这里](http://bradfrostweb.com/blog/web/magento-static-blocks/)看到。至于原生 Magento 块，我无法找到一组原生 Magento 块列表。无论出于何种原因，它都没有得到很好的记录。您可以在主题的布局目录中四处`app/code/design/frontend/default/YOUR_THEME/layout`寻找 XML 文件。在那里你会看到类似的东西：

```
<reference name="left">
    <block type="newsletter/subscribe" name="left.newsletter" template="newsletter/subscribe.phtml"/>
</reference> 
```

我们可以通过以下方式在 CMS 页面或静态块中进行所有这些块：

```
{{block type="newsletter/subscribe" name="left.newsletter" template="newsletter/subscribe.phtml"}} 
```

我希望这会有所帮助！不是直接的答案，但至少这是一个开始！

# javascript - Google Maps v3 API 获取路线持续时间失败

> ID：14329473
> 
> 赞同：0
> 
> 时间：2013-01-15T00:52:30.940
> 
> 标签：javascript, google-maps, google-maps-api-3

你能解释一下为什么我没有进入`google.maps.DirectionsStatus.OK`这段代码吗？

```
function measureDistance(m1, m2) {
    var wp = new Array();
    var lstart = new google.maps.LatLng(markers[m1].position);
    var lend = new google.maps.LatLng(markers[m2].position);
    var request = {
        origin : lstart,
        destination : lend,
        waypoints : [],
        optimizeWaypoints: true,
        travelMode : google.maps.DirectionsTravelMode.DRIVING
    };
    directionsService.route(request, function(response, status) {
        if (status== google.maps.DirectionsStatus.OK) {
            response.routes[0].legs[0].duration.text;
        } else {
            document.getElementById('locationD').value = "drawRouteBad";
        }

    });
} 
```

`Markers`是带有地图标记的全局字典。`directionsService`是全局定义的（`directionsService`在另一个函数中同样适用于我）。问题是，由于某种原因，我无法得到正确的响应（我的网站上的一个字段中有 drawRouteBad）。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-15T01:37:05.840

问题是，我不需要创建新的 LatLng 对象。Markers[].position 里面的内容对于开始和结束来说已经足够了。

```
 var lstart = markers[m1].position;
 var lend = markers[m2].position; 
```

# .htaccess - 静态（seo 友好）到动态 url 重写

> ID：14329475
> 
> 赞同：0
> 
> 时间：2013-01-15T00:52:57.567
> 
> 标签：.htaccess, mod-rewrite, url-rewriting, friendly-url, dynamic-url

这是我的问题...

我有一个重定向这样的链接：

> > **site.com/virtualfolder/some-seo-friendly-keywork**
> > 到
> > **site.com/folder/page.php?id=some-seo-friendly-keyword**

在**site.com**中没有真正的文件夹“ **virtualfolder** ”，它是虚拟的。我必须采用“ **some-seo-friendly-keyword** ”并将其用作查询字符串

我想我必须首先匹配文件夹“ **virtualfolder** ”，然后捕获“ **some-seo-friendly-keyword** ”，但是如何？**some-seo-friendly-keyword**是一串字符和数字加上连字符，所以下面这样的东西是现实的吗？

> > RewriteRule ^virtualfolder/([a-zA-Z0-9-])? 文件夹/page.php?id=$1 [L]

我仍在努力尝试 mod_rewrite，这对我来说就像伏都教！：-/

非常感谢您的帮助或建议

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-15T01:00:34.570

尝试在 htaccess 中使用此代码：

使用原始网址显示：

```
Rewriterule ^virtualfolder/([a-zA-Z0-9_-]+)$ folder/page.php?id=$1 
```

使用 RedirectMatch 重定向到结束 url（使用第二部分中的完整 URL）：

```
RedirectMatch 301 ^/virtualfolder/([a-zA-Z0-9_-]+)$ http://www.site.com/folder/page.php?id=$1 
```

使用 mod_rewrite 重定向到结束 url（使用第二部分中的完整 URL）：

```
Rewriterule ^virtualfolder/([a-zA-Z0-9_-]+)$ http://www.site.com/folder/page.php?id=$1 [R=301,L,NE] 
```

更多信息[在这里](https://www.google.com/search?q=301%20redirectmatch%20examples)

# php - Wordpress：页面加载后加载到 div 中的页面中的 query_posts

> ID：14329476
> 
> 赞同：0
> 
> 时间：2013-01-15T00:53:00.063
> 
> 标签：php, wordpress, html

我刚刚让 jQuery 能够将页面加载到 body div 中。

现在我正在尝试将 wordpress 功能添加到各种页面中，然后我可以将它们加载到该主体 div 中。

一切都加载了，我知道正在访问正确的页面，但我遇到了一个非常意想不到的问题。

> 致命错误：在第 2 行调用 /home/nighthav/public_html/GENOMESTUDIOS.CA/wp-content/themes/GenomeStudios2013/news.php 中未定义的函数 wp_head()

我现在意识到，因为页面在加载时与主站点是分开的，所以它没有任何访问权限。

需要加载的页面超级简单：

```
This is a body blah blah
                    <?php wp_head();
                    global $query_string;
                    define('WP_USE_THEMES', false);
                    query_posts( $query_string . '&posts_per_page=1&order=ASC&cat=2');?>
                    <?php if ( have_posts() ) : while ( have_posts() ) : the_post(); ?>

                            <h1>Title: <?php the_title(); ?></h1>

                                Body: <?php the_content(); ?>

                                Time: <?php the_time(); ?>

                <?php endwhile; else: ?>
                <p><?php _e('Sorry, no posts matched your criteria.'); ?></p>
                <?php endif; ?> 
```

有没有办法重新连接到我的 WP 功能？一切都在同一个位置。

我没有经常使用 Wordpress，也没有练习，所以请尽可能清楚地说明。

* * *

补充：如果我删除标题调用，我会得到：

> 致命错误：在第 5 行调用 /home/nighthav/public_html/GENOMESTUDIOS.CA/wp-content/themes/GenomeStudios2013/news.php 中未定义的函数 query_posts()

我试图加载的这个页面没有连接到 Wordpress 系统。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-15T05:10:54.937

您应该在文件开头添加以下代码（在调用 wordpress 函数之前）：

```
require('../../../wp-blog-header.php'); 
```

您调整`../`以匹配`wp-blog-header.php`您的 wordpress 安装文件（在顶级文件夹中找到）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-15T01:19:49.870

替换`wp_head();`为`get_header();`or 如果您不需要那里的标题，只需将其删除即可。

# java - 组件扫描中的基础包选择了错误的子包

> ID：14329477
> 
> 赞同：0
> 
> 时间：2013-01-15T00:53:01.827
> 
> 标签：java, spring, jakarta-ee, spring-mvc

我把大部分课程都放在了

```
 com.company.productline.product  -- classpath 1 
```

在该类路径中将有服务、Web、域、i18n... 子包。

出于某种原因，我将另一个服务 bean 包装在一个罐子里，它应该适用于整个产品线，因此它在

```
 com.company.productline    -- classpath 2 
```

所以在 applicationContext.xml 中，组件扫描的基础包必须妥协到上一层，作为类路径 2 而不是类路径 1，像这样

```
 <context:component-scan base-package="com.company.productline">
        <context:exclude-filter expression=".*_Roo_.*" type="regex"/>
        <context:exclude-filter expression="org.springframework.stereotype.Controller" type="annotation"/>
  </context:component-scan> 
```

然后让 Spring 扫描整个应用程序的 @Service 或 @Component ，甚至在那个 jar 文件中。

但是，现在在 applicationContext 中有一个错误说：

```
 Annotation-specified bean name 'someServiceClass' for bean class
 [com.company.productline.i18n.someServiceClass] conflicts with existing, 
 non-compatible bean definition of same name and class 
[com.company.productline.product.i18n.someServiceClass]' 
```

`com.company.productline.i18n.someServiceClass`问题是Spring似乎在没有中间的虚假包下找到了一个bean类`product`，但这是我可以确认的：

1.  package 下没有class/classpath `com.company.productline.i18n.someServiceClass`，但是下有class `com.company.productline.product.i18n.someServiceClass`。

2.  该类`someServiceClass`确实有一个@Component 注释。

但是，如果我将 中的类路径降低一级`base-package`，错误就消失了：

```
 <context:component-scan base-package="com.company.productline.product">
        <context:exclude-filter expression=".*_Roo_.*" type="regex"/>
        <context:exclude-filter expression="org.springframework.stereotype.Controller" type="annotation"/>
  </context:component-scan> 
```

该类的定义如下：

```
@Component
@Scope(proxyMode = ScopedProxyMode.TARGET_CLASS, value = "request")
public class SomeServiceClass implements CurrentRequest {

    @Autowired
    private HttpServletRequest request;

    public Locale getCurrentLocale() {
        LocaleResolver localeResolver = RequestContextUtils.getLocaleResolver(request);
        return localeResolver.resolveLocale(request);
    }

    public HttpServletRequest getRequest() {
        return request;
    }

    public void setRequest(HttpServletRequest request) {
        this.request = request;
    }

} 
```

所以真的不知道发生了什么以及为什么会出现这个问题。

该应用程序在 STS 2.9.1 上的 Spring 3.1.0 上运行

请帮助，提前谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-15T15:24:27.993

原来ninn是正确的。除了应用程序中具有相同 bean 名称的类之外，没有其他可能性。

在这种情况下，项目搜索不起作用的原因是我们有另一个具有相同服务类的 jar 文件。直到注意到我才知道。删除源代码中的类后，错误就消失了。

谢谢宁。

# php - 对于非常基本的降价，这些正则表达式会起作用吗？

> ID：14329483
> 
> 赞同：0
> 
> 时间：2013-01-15T00:53:36.447
> 
> 标签：php, mysql, regex, code-injection

只是一个关于正则表达式的快速问题：这段代码是否适用于我需要做的任何修饰？（即可以将其输入数据库并且安全吗？）

```
function markdown2html($text) {
        $text = htmlspecialchars($text, ENT_QUOTES, 'UTF-8');
    // Strong Emphasis
    $text = preg_replace('/__(.+?)__/s', '<strong>$1</strong>', $text);
    $text = preg_replace('/\*\*(.+?)\*\*/s', '<strong>$1</strong>', $text);

    // Underline
    $text = preg_replace('/_([^_]+)_/', '<p style="text-decoration: underline;">$1</p>', $text);
    //Italic
    $text = preg_replace('/\*([^\*]+)\*/', '<em>$1</em>', $text);

    // Windows to Unix
    $text = str_replace('\r\n', '\n', $text);
    // Macintosh to Unix
    $text = str_replace('\r', '\n', $text);

    //Paragraphs
    $text = '<p>' . str_replace("\n\n", '</p><p>', $text) . '</p>';
    $text = str_replace("\n", '<br />', $text);

    // [Linked Text](Url)   
   $text = preg_replace('/\[([^\]]+)]\(([a-z0-9._~:\/?#@!$&\'()*+,;=%]+)\)/i', '<a href="$2">$1</a>', $text);

   return $text;

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-15T02:06:45.040

不，绝对不是。

您的代码与 SQL 无关——它根本不修改`'`或`\`字符。将此函数的格式化功能与 SQL 转义混合在一起是愚蠢的。

在某些情况下，您的代码也可能会引入 HTML 注入——我特别怀疑 URL 链接正则表达式。如果没有适当的解析器，我不会相信它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-15T02:00:14.187

不，数据通过该功能后不能保证安全。

您需要转义 sql 敏感字符或使用 PDO/Mysqli。无论如何，准备好的陈述要方便得多。

不要使用将查询组合在一起的旧方法，即：

```
$query = 'select * from table where col = '.$value; 
```

你只是在那里自找麻烦。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-15T03:09:56.247

我突然想到了几件事：

我相信前两个正则表达式（`'/__(.+?)__/s'`以及对应的 for `*`）处理 ___word___ 和 ***word*** 不正确——它们会将第三个字符视为单词的一部分，所以你会得到***word** * （第一个* 是粗体，后面的不是）而不是***word***。

在第三个（`'/_([^_]+)_/'`）上，它真的适合

> 不要那样做

变成

> 做 <p style="text-decoration: underline;">不</p> 那样做

?

当然，我***并不是***说如果你解决了这些问题就可以使用。

# c - 从excel文件自动创建文件夹

> ID：14329488
> 
> 赞同：0
> 
> 时间：2013-01-15T00:53:59.887
> 
> 标签：c, file, directory

我想创建大约 1000 个文件夹，但我认为最好的方法不是“创建新文件夹 - 重命名它”。我有一个 excel 文件 (.xls)，其中有一列完整的带有首选名称的列..

例如

names.xls 第 1 列 = name1、name2、name3、name4、name5、name6 等

第 2 列 = 金额 1、金额 2、金额 3、金额 4。等

因此，我想要一个名称为 test 的文件夹，在其中我想要所有名称为第 1 列的文件夹。这是否可能以及如何做到这一点？我认为这份工作最好的语言是C，还是不是？excel文件有问题吗？我可以将 xls 文件的第一列插入 txt 文件吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-15T01:36:49.863

最快的方法可能是这样做：

1.  使用命令在第 1 列之前插入一列以创建目录 (md)
2.  向下填充名称列（现在是第二列）中具有值的所有行
3.  将两列复制到文本文件
4.  如果需要，搜索并删除空格
5.  将文本文件另存为 .bat 或 .cmd 并在正确的目录中执行

如果这是一次性的事情，编写一个程序可能是矫枉过正，但如果你需要这样做，通常按照上面的建议使用 VBS。

# css - 如何减少虚线下划线链接的间隙？

> ID：14329491
> 
> 赞同：7
> 
> 时间：2013-01-15T00:54:26.103
> 
> 标签：css, hyperlink

我们有带有虚线下划线样式的自定义链接。

![间隙截图](../Images/2242d9f953c23f3c9b9bc5bb47988d99.png)

我怎样才能减少差距？目前`padding: 0;`并且`line-height`不工作。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-15T01:29:38.537

这是你可以尝试的有点冗长的东西，但如果你真的想缩小差距，你可以尝试添加一个绝对放置的伪元素来重新创建下划线。

这是我的[小提琴](http://jsfiddle.net/tracyfu/RtQgh/)。

编辑：这是@bradchristie 在评论中更新的[小提琴](http://jsfiddle.net/32HJL/2/)，其中包含使用 OP 样式之前和之后的内容。

这是我的 CSS：

```
a {
  background: #ff0;
  color: #f00;
  position: relative;
  text-decoration: none;
}

a::after {
  border-bottom: 1px dotted #f00;
  bottom: 3px;
  content: '';
  height: 0;
  left: 0;
  position: absolute;
  right: 0;
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-15T08:34:53.583

由于您使用的不是下划线而是底部边框，因此该空间可以容纳可能存在的任何文本，包括可能出现在基线下方的下降线和变音符号。所以你需要打败正常的行格式，例如通过使用降低内容高度的诡计，例如通过设置

```
a { display: inline-block; line-height: 0.8; height: 0.8em; } 
```

# html - canvas.toDataURL() 导致安全错误

> ID：14329493
> 
> 赞同：5
> 
> 时间：2013-01-15T00:54:27.783
> 
> 标签：html, apache, canvas, html5-canvas, kineticjs

我通过[KineticJS 的](http://www.html5canvastutorials.com/kineticjs/html5-canvas-stage-data-url-with-kineticjs/)方法使用 HTML5 画布和`.toDataURL()`函数。画布使用我的用户上传到站点的图像，这些图像存储在不同的机器和子域上。 `.toDataURL()``farm1.domain.com`

**问题：**当`.toDataURL()`被调用时，我得到了错误

```
SECURITY_ERR: DOM Exception 18 
```

有没有解决的办法？如果用户通过访问页面`domain.com`并且图像托管在`www.domain.com`.

**试图：**

我在虚拟主机中添加了以下几行`httpd.conf`并重新启动了 apache 服务。

```
Header add Access-Control-Allow-Origin "http://www.domain.com"
Header add Access-Control-Allow-Origin "http://domain.com"
Header add Access-Control-Allow-Origin "http://farm1.domain.com" 
```

`www.domain.com`从页面上访问托管的图像时，我仍然遇到相同的错误`domain.com`！在 KineticJS 中有没有办法解决这个问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-15T07:35:22.800

您需要将`Access-Control-Allow-Origin`标题添加到正在加载的图像中，而不是添加到正在加载它们的页面中。有关此标头以及一般 CORS 的详细信息，您可能需要阅读“ [CORS 不仅适用于 XHR](http://remysharp.com/2013/01/14/cors-isnt-just-for-xhr/) ”，其中专门讨论了此问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-15T06:54:53.177

没有办法解决这个错误。从不同域加载到画布中的图像将引发此错误，因为每个浏览器当前都实现了此错误。在您的情况下，图像应该存储在同一个域中，并且您不会遇到异常。

# ruby-on-rails - POW 错误 - 导轨

> ID：14329495
> 
> 赞同：4
> 
> 时间：2013-01-15T00:54:31.777
> 
> 标签：ruby-on-rails, ruby-on-rails-3, rack-pow

出于某种原因，我的一个应用程序不适用于 pow。

我将符号链接设置为...到我的应用程序，并且该应用程序显示为链接。

```
curl get.pow.cx | sh
cd ~/.pow
ln -s ~/desktop/rails_project/myaccountdeck/myaccountdeck 
```

但后来我得到这个错误：

```
Error: unknown process error
Error: unknown process error
    at Process.<anonymous> (/Users/me/Library/Application Support/Pow/Versions/0.4.0/node_modules/nack/lib/process.js:116:38)
    at Socket.<anonymous> (/Users/me/Library/Application Support/Pow/Versions/0.4.0/node_modules/nack/lib/process.js:3:63)
    at Socket.emit (events.js:67:17)
    at Pipe.onread (net.js:367:14) 
```

奇怪的是，localhost 可以工作，而我的其他应用程序也可以工作......

知道可能是什么原因造成的吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2014-06-23T08:15:30.903

评论中指出了这一点，但要完全清楚：如果出现这样的错误

```
rails s 
```

是你的朋友。它将使用 WEBrick（而不是 pow）运行您的应用程序，您几乎肯定会看到阻止您的应用程序启动的错误（作为控制台输出）。

# xpath - sitecore 查询是否支持 current() 函数？

> ID：14329500
> 
> 赞同：0
> 
> 时间：2013-01-15T00:54:55.503
> 
> 标签：xpath, sitecore, sitecore6

如果我尝试在嵌套表达式内的 sitecore 查询中使用 xpath 'current()' 函数，则会出现错误，如下所示：

```
/sitecore/content/Home/Topics/*[contains(current()/@MainTopics, @@id)] 
```

我要做的是，将此查询用作我的 DropLink 字段的来源，以仅列出已在同一项目的另一个“MainTopics”字段中选择的“主题”项目。

但这给了我一个错误，比如`")" expected at position 50`

所以看起来`current()`函数不能在嵌套表达式中使用，或者完全不能使用。如果没有，有没有办法从嵌套表达式中引用**当前**节点而不是**上下文节点？**

有任何想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-15T01:07:24.637

> sitecore 查询支持`current()`功能吗？

**`current()`是仅在 XSLT 中定义的函数**。

根据定义`current()`产生与当前匹配的`xsl:template`节点或在一个`xsl:for-each`

**由于 SiteCore 似乎没有 XSLT 实现，所以答案肯定是否定的**。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-16T15:59:30.763

我认为在 Sitecore 查询中没有任何简单的方法可以做到这一点。

但是要将数据源放在引用在另一个字段中选择的项目的模板字段上（如果我理解正确的话），那么一种可能的解决方案是构建一个自定义字段。在自定义字段的代码中，您将执行一些字符串处理以扩展或覆盖 Sitecore 查询，从而允许您添加指定特定字段 ID 的查询类型。本质上，您必须编写自己的非常基本的查询语言，可以在 C# 代码中使用。

您可以从您的字段派生并使用您的自定义查询处理`ValueLookupEx`覆盖该方法。`GetItems(Item current)`如您所见，它非常方便地与提供的当前项目一起提供！

我们有一个类似的要求，我们通过这种方式解决了。

# javascript - 是否可以向 jquerymobile 对话框添加表单？

> ID：14329501
> 
> 赞同：0
> 
> 时间：2013-01-15T00:54:59.160
> 
> 标签：javascript, jquery, dom, jquery-mobile, dialog

我的应用程序中有一个表单，用户可以在其中编辑他们的设置。对于某些偏好，我想打开一个包含下拉菜单的对话框，允许用户选择一个选项并通过 ajax 保存它。jquery mobile可以吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-15T01:29:12.067

是的，它甚至显示在他们的示例中。我建议您查看 1.2.0 的[Popup](http://jquerymobile.com/demos/1.2.0/docs/pages/popup/index.html)功能，它们可能更适合这种类型的快速更改。

示例：http: [//jsfiddle.net/Twisty/BrsR2/](http://jsfiddle.net/Twisty/BrsR2/)

```
<div data-role="page">
    <div data-role="header">
        <h1>Test PopUp</h1>
    </div>
    <div data-role="content">
        <a href="#popupBasic" data-rel="popup">Open Popup</a>
        <div data-role="popup" id="popupBasic">
            <form>
                <div style="padding:10px 20px; width: 440px">
                    <h3>Please sign in</h3>
                    <div data-role="fieldcontain">
                        <label for="un">Username:</label>
                        <input placeholder="username" id="un" value="" name="user">
                        <label for="pw">Password:</label>
    <input id="pw" type="password" placeholder="password" value="" name="pass">
                    </div>
                    <div data-shadow="true" data-iconshadow="true" data-icon="" data-iconpos="" data-theme="b" aria-disabled="false">
                    </div>
                </div>
            </form>
        </div>
        <div data-role="fieldcontain">
             <label for="input"> Fieldname </label>
             <input type="text" id="input" value="" />
        </div>
    </div>
</div> 
```

# checkbox - 确保用 Capybara 选中一个框？

> ID：14329507
> 
> 赞同：0
> 
> 时间：2013-01-15T00:55:33.473
> 
> 标签：checkbox, cucumber, capybara, webrat

我是使用 Cucumber 和 Capybara 的新手。我已经在网页上设置了一个测试，并在尝试运行时遇到了这个错误。

```
undefined method `locate' for #<Webrat::Session:0x007fdf2ac41c18> (NoMethodError)
  ./Documents/Work:etc./Raster Media/Cucumber/Klinq Testing/1/features/step_definitions/steps.rb:14:in `/^I make sure the (.*) box is checked$/'
  ./Documents/Work:etc./Raster Media/Cucumber/Klinq Testing/1/features/account.feature:16:in `And I make sure the vendor[tos] box is checked' 
```

我正在尝试获取它以确保在我的网页中选中了一个框。这是我的步骤定义：

```
When /^I make sure the (.*) box is checked$/ do |box|
locate(:css, 'box').set(true) 
```

我的 env.rb 文件：

```
require 'rspec/expectations'
require 'test/unit/assertions'
require 'capybara'
require 'webrat'
World(Test::Unit::Assertions)
Webrat.configure do |config|
config.mode = :mechanize
end
World do
session = Webrat::Session.new
session.extend(Webrat::Methods)
session.extend(Webrat::Matchers)
session
end 
```

这是我的复选框的源代码

```
<input type="checkbox" name="vendor[tos]" value="1" id="vendor[tos]" class="one left"> 
```

如果它没有通过这个测试，知道如何设置一个复选框来检查它也会很有帮助。

非常感谢任何提供帮助的人。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-10T16:40:32.823

使用 Capybara，您可以选中这样的复选框：

```
 When /^I make sure the (.*) box is checked$/ do |box|
      check(box)
    end 
```

其中“box”可以是 id、name 或 label。

这是检查方法的 Capybara 文档的链接：[http ://rubydoc.info/github/jnicklas/capybara/master/Capybara/Node/Actions#check-instance_method](http://rubydoc.info/github/jnicklas/capybara/master/Capybara/Node/Actions#check-instance_method)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-22T13:06:45.133

如果选中复选框，则它将与 css 关联。那就是复选框被选中，而不是它上面会“选中”css。

# objective-c - 如何管理从 NSCoder 返回的解码对象的内存？

> ID：14329513
> 
> 赞同：2
> 
> 时间：2013-01-15T00:56:13.957
> 
> 标签：objective-c, memory-management, nscoder

我已经从使用 NSCoder 编码中带回了一个根对象，并且不知道如何内存管理这个返回的对象。我用一个自动释放池包围了它，但是这个对象并没有随池一起出去。[代码在这里，见第 289](https://github.com/cxx6xxc/Node/blob/master/nodeInterface.m) *行代码可能会随着 Git Hub 提交而改变，但最终你会在工作代码中看到答案，手指交叉。*

自从：

*   retainCount 方法是[不可预测](http://www.friday.com/bbum/2011/12/18/retaincount-is-useless/)的，并且

*   自动释放池在解码后不会删除未保留的对象，*[本文指出解码后的对象是自动释放的，必须保留。](http://cocoaheads.byu.edu/wiki/nscoding)*

**什么是完全释放我的解码对象的有保证的方法？**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-15T01:08:29.050

您正在管理从`NSKeyedArchiver.`

您要么需要显式保留它，并在完成后调用 release，要么立即使用它——例如写入文件。

我建议重新熟悉一下[Objective-C 的内存管理规则](http://interfacelab.com/objective-c-memory-management-for-lazy-people/)

手动内存管理一开始有点棘手，但是一旦你掌握了规则，它就会让这种情况很容易解决。

现在，如果您需要确保立即删除内存，则需要编写自己的二进制序列化程序，该序列化程序将遵循 alloc:init 模式，以便调用者明确拥有内存。这样，当您在对象上调用 release 时，它​​将被释放。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-15T01:06:21.380

NSCoder 不属于该发布池。

# java - 通过网络播种选择性下载种子

> ID：14329517
> 
> 赞同：0
> 
> 时间：2013-01-15T00:56:49.823
> 
> 标签：java, http, jetty, p2p, libtorrent

我从 Jetty 网络服务器提供文件，这些文件目前通过常规 HTTP GET 下载。

但是，我对 P2P 模型感兴趣，用户可以通过网络种子下载文件。这将如何在带有 libtorrent 的 Jetty 服务器的上下文中实现？

其次，我不想永远在 Jetty 网络服务器上“播种”所有文件，而我只想能够“按需”播种文件。例如，与其盲目地播种种子，我希望在收到请求时（通过 GET 或网络播种或其他方式）让文件可供需求 - 可以在其上“播种”。

我想按需播种或上传，因为我有大量文件，不知道我是否能够同时播种数万个文件。顺便说一句，有人知道可以同时播种的文件数量的上限是多少吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-15T10:06:31.293

关于 libtorrent 部分的相关文档在这里：[http](http://www.rasterbar.com/products/libtorrent/manual.html#http-seeding) ://www.rasterbar.com/products/libtorrent/manual.html#http-seeding和规格是[http://bittorrent.org/beps/bep_0019.html](http://bittorrent.org/beps/bep_0019.html)和[http ://bittorrent.org/beps/bep_0017.html](http://bittorrent.org/beps/bep_0017.html)（libtorrent 都支持，作为“url 种子”和“http 种子”）。

IIRC、BEP19（webseeds 或 urlseeds）从服务器 POV 相当直接，您不需要在那里做任何特别的事情 - 您*只需像处理对该文件的正常 HTTP 请求一样提供文件*（所以，您问题的第二部分在这里不太有意义）。

使用 BEP17，您宁愿使用唯一的 http 端点，并通过它获取参数以指定客户端想要的内容（例如，允许更好的节流控制和范围选择）（例如：[http ://example.com/seed/?info_hash =X&piece=Y&ranges=Z](http://example.com/seed/?info_hash=X&piece=Y&ranges=Z) )。

如果您打算对下载的内容进行更多（编程）控制，则第二种方法更加灵活，但显然需要编写更多代码来处理请求。

同样，从服务器 POV 来看，这与常规 HTTP 事务没有什么不同，这里的“播种”没有什么特别之处。您只需提供文件（每个文件都有自己的 url，直接或通过处理程序）。

对于元数据部分，使用 BEP19，您添加一个“url-list”扩展名（带有文件的完整 url：[http](http://example.com/seeds/SOMEFILE.txt) ://example.com/seeds/SOMEFILE.txt - 注意多文件种子），而 BEP17 使用密钥“httpseeds”（使用您的端点，例如：[http](http://example.com/seed/) ://example.com/seed/ ）。

根据您的 Jetty 是否也处理元数据生成，您可能更喜欢 BEP19 而不是 BEP17，因为您的 url 更可预测/元数据生成更简单......

希望有帮助。

# android - SetOnClickListener 更改 List Linearlayout 中的视图

> ID：14329518
> 
> 赞同：0
> 
> 时间：2013-01-15T00:56:49.907
> 
> 标签：android, list, view, android-linearlayout, onclicklistener

我用我的代码创建了列表线性布局

```
String[] name = {"Chicken", "Beef", "Milk" ,"Juice"};
    final Integer[] price = {10, 50, 5, 3};
    final Integer[] qty = {1, 2, 5, 5};

    listOrder.removeAllViews();
    LinearLayout.LayoutParams image = new LinearLayout.LayoutParams(Utility.getDip(175, CartActivity.this), Utility.getDip(70, CartActivity.this));
    LinearLayout.LayoutParams text = new LinearLayout.LayoutParams(Utility.getDip(140, CartActivity.this), Utility.getDip(80, CartActivity.this));
    LinearLayout.LayoutParams textQty = new LinearLayout.LayoutParams(Utility.getDip(100, CartActivity.this), Utility.getDip(80, CartActivity.this));
    LinearLayout.LayoutParams textPrice = new LinearLayout.LayoutParams(Utility.getDip(125, CartActivity.this), Utility.getDip(80, CartActivity.this));
    LinearLayout.LayoutParams textTotal = new LinearLayout.LayoutParams(Utility.getDip(130, CartActivity.this), Utility.getDip(80, CartActivity.this));
    LinearLayout.LayoutParams editImage = new LinearLayout.LayoutParams(Utility.getDip(40, CartActivity.this), Utility.getDip(40, CartActivity.this));
    for(int i = 0; i < 4; i++){
        list = new LinearLayout(ctx);
        list.setOrientation(LinearLayout.HORIZONTAL);
        //if((i % 2) == 0) list.setBackgroundColor(R.color.bg_grey);

        listImage = new ImageView(ctx);
        //listImage.setImageDrawable(getResources().getDrawable(R.drawable.sample_logo_publisher));
        listImage.setBackgroundColor(getResources().getColor(R.color.bg_grey));
        listImage.setAdjustViewBounds(Boolean.TRUE);
        listImage.setScaleType(ScaleType.FIT_XY);

        image.gravity = Gravity.CENTER;
        image.setMargins(Utility.getDip(10, CartActivity.this), 0, Utility.getDip(10, CartActivity.this), 0);
        list.addView(listImage, image);

        listText = new TextView(ctx);
        listText.setText(name[i]);
        listText.setGravity(Gravity.CENTER);
        text.gravity = Gravity.CENTER;
        text.setMargins(Utility.getDip(10, CartActivity.this), 0, 0, 0);
        list.addView(listText, text);

        listQty = new TextView(ctx);
        listQty.setText(qty[i].toString());
        listQty.setGravity(Gravity.CENTER);
        textQty.gravity = Gravity.CENTER;
        textQty.setMargins(Utility.getDip(5, CartActivity.this), 0, Utility.getDip(5, CartActivity.this), 0);
        list.addView(listQty, textQty);

        listPrice = new TextView(ctx);
        listPrice.setText(price[i].toString());
        listPrice.setGravity(Gravity.CENTER_VERTICAL);
        textPrice.gravity = Gravity.CENTER;
        list.addView(listPrice, textPrice);

        Integer total = qty[i]*price[i];
        listTotal = new TextView(ctx);
        listTotal.setText(total.toString());
        listTotal.setGravity(Gravity.CENTER_VERTICAL);
        textTotal.gravity = Gravity.CENTER;
        textTotal.setMargins(Utility.getDip(5, CartActivity.this), 0, Utility.getDip(2, CartActivity.this), 0);
        list.addView(listTotal, textTotal);

        plus = new ImageView(ctx);
        plus.setImageDrawable(getResources().getDrawable(R.drawable.plus));
        plus.setAdjustViewBounds(Boolean.TRUE);
        plus.setScaleType(ScaleType.FIT_XY);
        editImage.gravity = Gravity.CENTER;
        list.addView(plus, editImage);
        final int pos = i;
        plus.setOnClickListener(new OnClickListener() {

            @Override
            public void onClick(View v) {
                // TODO Auto-generated method stub
                qty[pos] = qty[pos] + 1;
                listQty.setText(qty[pos].toString());
                listTotal.setText(""+ (qty[pos]*price[pos]));
            }
        });

        minus = new ImageView(ctx);
        minus.setImageDrawable(getResources().getDrawable(R.drawable.min));
        minus.setAdjustViewBounds(Boolean.TRUE);
        minus.setScaleType(ScaleType.FIT_XY);
        editImage.gravity = Gravity.CENTER;
        list.addView(minus, editImage);

        remove = new ImageView(ctx);
        remove.setImageDrawable(getResources().getDrawable(R.drawable.trash));
        remove.setAdjustViewBounds(Boolean.TRUE);
        remove.setScaleType(ScaleType.FIT_XY);
        editImage.gravity = Gravity.CENTER;
        list.addView(remove, editImage);

        listOrder.addView(list);
    } 
```

我想在点击加图片时添加数量。但是当我单击列表中的加号图像时，textQty 在列表末尾发生了变化，而不是在我单击图像的同一个列表中。

如何修复我的代码？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-15T01:34:00.710

您需要将 TextViews 和按钮链接在一起。他们不知道他们在 for 循环的同一迭代中。

当您通过循环时，您可以将每组按钮和文本视图放入一个数组中。

然后在您的 onClickListener 中，您将执行以下操作：

```
for(int i = 0; i < buttonArray.length; i++){
    if(v == buttonArray[i]){
       // make whatever changes to TextViews at index i
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-16T07:46:16.503

我已经解决了我的问题。这是我的代码...
我在 listQty 和 listTotal 中设置了 id

```
listQty = new TextView(ctx);
listQty.setId(99000+i);
listQty.setText(qty[i].toString());
listQty.setGravity(Gravity.CENTER);
textQty.gravity = Gravity.CENTER;
textQty.setMargins(Utility.getDip(5, CartActivity.this), 0, Utility.getDip(5, CartActivity.this), 0);
list.addView(listQty, textQty);

listTotal = new TextView(ctx);
listTotal.setId(98000+i);
listTotal.setText(total.toString());
listTotal.setGravity(Gravity.CENTER_VERTICAL);
textTotal.gravity = Gravity.CENTER;
textTotal.setMargins(Utility.getDip(5, CartActivity.this), 0, Utility.getDip(2, CartActivity.this), 0);
list.addView(listTotal, textTotal); 
```

并在 listQty 和 listTotal 的 clicklistener 设置变量中

```
plus = new ImageView(ctx);
plus.setImageDrawable(getResources().getDrawable(R.drawable.plus));
plus.setAdjustViewBounds(Boolean.TRUE);
plus.setScaleType(ScaleType.FIT_XY);
editImage.gravity = Gravity.CENTER;
list.addView(plus, editImage);
final int pos = i;
plus.setOnClickListener(new OnClickListener() {
    @Override
    public void onClick(View v) {
    // TODO Auto-generated method stub
        listQty = (TextView)findViewById(99000+pos);
        listTotal = (TextView)findViewById(98000+pos);
        qty[pos] = qty[pos] + 1;
        listQty.setText(qty[pos].toString());
        listTotal.setText(""+ (qty[pos]*price[pos]));
    }
}); 
```

# wordpress - memcached 是否值得只在一台服务器上运行？

> ID：14329520
> 
> 赞同：3
> 
> 时间：2013-01-15T00:57:10.430
> 
> 标签：wordpress, caching, memcached, mediatemple

我在 MediaTemple 运行一个 dv 服务器，有 4 Gigs 的 RAM，我刚刚开始研究使用 memcached 来安装我的大型 Wordpress。我知道，尽管 memcached 主要设计用于多服务器设置，但它只能在一台机器上使用 - 即，一台同时运行缓存网站和 memcached 的服务器。

但我的问题是：在单个服务器上运行它是否值得麻烦？如果我只是在 W3 Total Cache Wordpress 插件上配置数据库缓存，那么这与将 memcached 配置为在与我的 WP 安装相同的服务器上运行的效果几乎相同吗？我提前感谢您可以分享的任何见解-

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-10-06T18:47:41.250

是的，Memcached 非常适合在单个服务器上运行 - 但它在集群之间共享缓存结果时尤其出色，通过消除集群范围内的大部分处理和查找来加速每个主机以及整个集群。

使用 W3 Total Cache 运行 Memcached 效果非常好，它会自动缓存大量内容，并让您能够直接在其中存储 WP 数据库缓存和对象缓存。

但是，对于 WordPress 和单服务器安装，我可能会建议您改用 php 加速器，例如[APC](http://php.net/manual/en/book.apc.php)。

APC 主要是一个操作码缓存，旨在通过预编译它并从共享内存缓存中提供字节码来加速 php 的执行。它还使您能够像 memcached 一样存储键控数据（使用 W3 Total Cache 的数据库缓存和对象缓存）。

# c# - Fluent NHibernate (ASP.NET MVC) 中的枚举类型不匹配

> ID：14329523
> 
> 赞同：6
> 
> 时间：2013-01-15T00:57:36.153
> 
> 标签：c#, asp.net-mvc-3, nhibernate, fluent-nhibernate

表型号：

```
public class UserOwnerShip
{
    public virtual int Id { get; set; }
    public virtual User User { get; set; }
    public virtual City City { get; set; }
    public virtual Company Company { get; set; }
    public virtual UserRole UserRole { get; set; }
    public virtual DateTime RegistryDate { get; set; }
    public virtual bool IsActive { get; set; }
} 
```

映射：

```
internal class UserOwnerShipMap : ClassMap<UserOwnerShip>
{
    public UserOwnerShipMap()
    {
        Id(x => x.Id);
        Map(x => x.IsActive);
        Map(x => x.UserRole).CustomType(typeof(int));
        Map(x => x.RegistryDate);

        References(x => x.User).Not.Nullable();
        References(x => x.City).Nullable();
        References(x => x.Company).Nullable();
    }
} 
```

我的 EnumConvention 类：

```
public class EnumConvention : IUserTypeConvention
{
    public void Accept(IAcceptanceCriteria<IPropertyInspector> criteria)
    {
        criteria.Expect(x => x.Property.PropertyType.IsEnum ||
            (x.Property.PropertyType.IsGenericType &&
             x.Property.PropertyType.GetGenericTypeDefinition() == typeof(Nullable<>) &&
             x.Property.PropertyType.GetGenericArguments()[0].IsEnum)
            );
    }

    public void Apply(IPropertyInstance target)
    {
        target.CustomType(target.Property.PropertyType);
    }
} 
```

和 UserRole 枚举

```
public enum UserRole
{
    User,
    Operator,
    Manager,
    Manager,
    Admin
} 
```

还有我的休眠配置部分：

```
....().Conventions.AddFromAssemblyOf<EnumConvention>()) 
```

所以当我查询时：

```
 IList<UserOwnerShip> userOwnerShip = session.QueryOver<UserOwnerShip>()
                                                    .Where(u => u.UserRole == UserRole.Owner)
                                                    .Where(u => u.IsActive)
                                                    .List<UserOwnerShip>(); 
```

我有例外：

```
Type mismatch in NHibernate.Criterion.SimpleExpression: UserRole expected type System.Int32, actual type XXX.XXX.UserRole (which is enum type class) 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-01-15T01:04:22.567

如果要存储枚举的 int 值，映射很简单：

```
Map(x => x.UserRole).CustomType<UserRole>(); 
```

不需要 EnumConvention。

# css - 流体固定设计

> ID：14329524
> 
> 赞同：0
> 
> 时间：2013-01-15T00:57:40.390
> 
> 标签：css

我需要有两个内联 div，左边的 div 应该是流动的，右边应该是固定的。左侧流体列的最小宽度应为 801 像素，左侧 div 的最大宽度应为 1250 像素。正确的固定 div 宽度应始终为 250 像素。

有人可以告诉我如何做到这一点吗？例如，如果 body 宽度为 1500 像素，则左侧流体 div 应该增长并将右侧 div 推到 1250 像素并停止。如果正文内容是 801px，那么左 div 应该在 550px 左右。

我已经问过这个问题，但无法得到任何有用的东西。

```
.intro {
  float:left;
  height:200px;
  width:100%;
  padding:10px 0;
}

.intro-right,
.intro-left{
  display:inline;
}

.intro-right {
  float:left;
  width:250px;
  margin-right:20px;
  height:200px;
}

.intro-left {
  min-width:801px;
  max-width:1250px;
  height:200px;
}

<div class="intro">
  <div class="intro-left">
    <h2><a href="#">Test</a></h2>
    <p>Test</p>
  </div>

  <div class="intro-right">right fixed</div>
</div> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-16T12:44:40.013

以一种在页面加载时看起来不会太糟糕的方式尝试使用 javascript

例如，您隐藏右前奏，左设置为 100%，

加载时计算左侧的大小，使右侧出现在右侧，同时减少左侧+如果没有固定宽度的 JavaScript，则为后备

注意：添加一个窗口调整大小事件监听器

# sql - 在 SQL 中计算条件匹配

> ID：14329526
> 
> 赞同：1
> 
> 时间：2013-01-15T00:58:07.113
> 
> 标签：sql, select, join

**问题：**

查找 Person 表中名字和姓氏相同或 SSN 相同的匹配记录数。

***给定***

**表结构：**人

```
FirstName
LastName
SSN
RecordId 
```

**数据：**在人员表中

```
╔═══════════╦══════════╦═════════════╦══════════╗
║ FIRSTNAME ║ LASTNAME ║     SSN     ║ RECORDID ║
╠═══════════╬══════════╬═════════════╬══════════╣
║ Bob       ║ Smith    ║ 111-11-1111 ║        1 ║
║ Robert    ║ Smyth    ║ 111-11-1111 ║        2 ║
║ Bob       ║ Smith    ║ 222-22-2222 ║        3 ║
║ Tom       ║ Gunn     ║ 333-33-3333 ║        4 ║
║ Jim       ║ Gunn     ║ 444-44-4444 ║        5 ║
║ Jimmy     ║ Gunn     ║ 444-44-4444 ║        6 ║
║ Alice     ║ Jones    ║ 555-55-5555 ║        7 ║
║ Alice     ║ Jones    ║ 666-66-6666 ║        8 ║
╚═══════════╩══════════╩═════════════╩══════════╝ 
```

**期望的结果：**

```
╔════════════╦═══════════╦══════════╦═════════════╦══════════╗
║ MATCHCOUNT ║ FIRSTNAME ║ LASTNAME ║     SSN     ║ RECORDID ║
╠════════════╬═══════════╬══════════╬═════════════╬══════════╣
║          3 ║ Bob       ║ Smith    ║ 111-11-1111 ║        1 ║
║          2 ║ Robert    ║ Smyth    ║ 111-11-1111 ║        2 ║
║          2 ║ Bob       ║ Smith    ║ 222-22-2222 ║        3 ║
║          1 ║ Tom       ║ Gunn     ║ 333-33-3333 ║        4 ║
║          2 ║ Jim       ║ Gunn     ║ 444-44-4444 ║        5 ║
║          2 ║ Jimmy     ║ Gunn     ║ 444-44-4444 ║        6 ║
║          2 ║ Alice     ║ Jones    ║ 555-55-5555 ║        7 ║
║          2 ║ Alice     ║ Jones    ║ 666-66-6666 ║        8 ║
╚════════════╩═══════════╩══════════╩═════════════╩══════════╝ 
```

**我试过的**

我尝试使用 GROUP BY 和 LEFT self JOIN 来解决这个问题。

GROUP BY 失败，因为无法有条件地分组。

LEFT self JOIN 失败，因为它大致返回匹配数的平方。

我会发布我尝试的代码，但我的真实表有大量列，实际上要复杂得多，几乎肯定会掩盖这个问题。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-15T01:12:57.840

既然你还没有提到 RDBMS，试试这个，

```
SELECT  COUNT(*) MatchCount,a.*
FROM    person a
        INNER JOIN person b
            ON  (a.firstname = b.firstname AND
                    a.lastname = b.lastname) OR
                    a.SSN = b.SSn
GROUP BY firstname, lastname, ssn, recordid
ORDER By recordid 
```

**结果**

```
| 比赛计数 | 名字 | 姓氏 | 社会保障号 | 记录 |
-------------------------------------------------- ------------
| 3 | 鲍勃 | 史密斯 | 111-11-1111 | 1 |
| 2 | 罗伯特 | 史密斯 | 111-11-1111 | 2 |
| 2 | 鲍勃 | 史密斯 | 222-22-2222 | 3 |
| 1 | 汤姆 | 冈恩 | 333-33-3333 | 4 |
| 2 | 吉姆 | 冈恩 | 444-44-4444 | 5 |
| 2 | 吉米 | 冈恩 | 444-44-4444 | 6 |
| 2 | 爱丽丝 | 琼斯 | 555-55-5555 | 7 |
| 2 | 爱丽丝 | 琼斯 | 666-66-6666 | 8 |
```

[SQL小提琴](http://sqlfiddle.com/#!2/8295e/2)

# python - 如何让 Python jsonpickle 递归工作？

> ID：14329531
> 
> 赞同：3
> 
> 时间：2013-01-15T00:58:35.187
> 
> 标签：python, json, jsonpickle

我无法让 Python 的 jsonpickle 0.4.0“递归”到包含自定义对象的自定义对象中。这是显示我的问题的示例代码。

```
import jsonpickle
import jsonpickle.handlers

class Ball(object):
    def __init__(self, color):
        self.color = color

class Box(object):
    def __init__(self, *args):
        self.contents = args

class BallHandler(jsonpickle.handlers.BaseHandler):    
    def flatten(self, obj, data):
        data['color'] = obj.color
        return data

class BoxHandler(jsonpickle.handlers.BaseHandler):    
    def flatten(self, obj, data):
        data['contents'] = obj.contents
        return data

jsonpickle.handlers.registry.register(Ball, BallHandler)
jsonpickle.handlers.registry.register(Box, BoxHandler)

# works OK -- correctly prints: {"color": "white"}
white_ball = Ball('white')
print jsonpickle.encode(white_ball, unpicklable=False)

# works OK -- correctly prints: [{"color": "white"}, {"color": "green"}]
green_ball = Ball('green')
balls = [white_ball, green_ball]
print jsonpickle.encode(balls, unpicklable=False)

# works OK -- correctly prints: {"contents": [1, 2, 3, 4]}
box_1 = Box(1, 2, 3, 4)
print jsonpickle.encode(box_1, unpicklable=False)

# dies with "Ball object is not JSON serializable"
box_2 = Box(white_ball, green_ball)
print jsonpickle.encode(box_2, unpicklable=False) 
```

球有“颜色”，盒子有“内容”。如果我有一个 [native] Balls 数组，那么就`jsonpickle`可以了。如果我有一盒 [native] 整数，那么就`jsonpickle`可以了。

但如果我有一个球盒，`jsonpickle`用`"Ball object is not JSON serializable"`.

从堆栈跟踪中，我有预感编码器正在离开`jsonpickle`并转到其他一些 JSON 库......显然不知道我已经注册了 BallHandler。

我该如何解决这个问题？

顺便说一句，我的示例没有明确使用 Django 的任何部分，但我需要它才能在 Django 应用程序中工作。

提前感谢您的任何意见！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-15T01:08:14.263

首先，为什么要创建自定义处理程序？您正在尝试做与默认处理程序已经做的完全相同的事情。删除这两条`register`线，并用所有这些对象调用`encode`和不调用`unpicklable=False`，你会得到相同的结果——除了它会完全按照你想要的方式处理装满球的盒子，而不是失败。

如果您浏览教程、API、测试用例和示例，他们永远不会创建自定义处理程序来模拟这样的集合。（例如，查看测试套件（和）中的//`Node`类。）所以，我认为您正在尝试做一些您不希望做的事情，并且不打算这样做。`Document``Section`[`samples.py`](https://github.com/jsonpickle/jsonpickle/blob/master/tests/samples.py)[`document_test.py`](https://github.com/jsonpickle/jsonpickle/blob/master/tests/document_test.py)

但是，让我们看看您的实际问题：为什么它不起作用？

嗯，这很容易。你这样做是错的。根据 的文档[`BaseHandler.flatten`](http://jsonpickle.github.com/api.html#jsonpickle.handlers.BaseHandler.flatten)，您应该：

> 将 obj 展平为对 json 友好的形式。

所以，鉴于此：

```
class BoxHandler(jsonpickle.handlers.BaseHandler):    
    def flatten(self, obj, data):
        data['contents'] = obj.contents
        return data 
```

您有效地承诺`obj.contents`采用 JSON 友好的形式。但事实并非如此；这是一个`list`对象`Ball`。

那么，正确答案是什么？好吧，您*可以*像扁平化一样扁平化内容中的每个元素。您认为必须有一些简单的方法可以做到这一点，但老实说，我在 API、文档、示例或单元测试中看不到任何内容，所以我想没有，所以您必须这样做它手动。大概是这样的（未经测试）：

```
class BoxHandler(jsonpickle.handlers.BaseHandler):    
    def flatten(self, obj, data):
        p = jsonpickle.Pickler()
        data['contents'] = [p.flatten(elem) for elem in obj.contents]
        return data 
```

但是……因为你得到`Pickler`的不是用来腌制你的东西——而且我看不出有什么办法——这很可能`maxdepth`会`unpicklable`违反`encode`.

所以，也许没有*正确*的方法可以做到这一点。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2017-06-21T02:39:09.563

我认为您可以回调酸洗上下文以继续酸洗。

```
class BoxHandler(jsonpickle.handlers.BaseHandler):
def flatten(self, obj, data):
    return [self.context.flatten(x,reset=False) for x in obj.contents] 
```

这似乎类似于内置 _list_recurse() 函数在 pickler.py:44 中处理这种情况的方式，因为 flatten() 只是调用 self._flatten （在可选地重置状态变量之后）。

`def _list_recurse(self, obj): return [self._flatten(v) for v in obj]`

我现在只是对此进行测试，并且 _depth 似乎按预期保持。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-01-15T01:21:24.890

对我来说似乎是一个错误，也是一个原则。如果`jsonpickle`是关于添加自定义对象处理`json`，它应该集成到后者中，而不是尝试为它“预处理”内容。[正如阿巴内特所说](https://stackoverflow.com/questions/14329531/how-can-i-get-python-jsonpickle-to-work-recursively#answer-14329603)，要求用户以任何方式自己处理这个问题的现状是把责任归咎于另一个人的门 IMO。

如果我是你，我会自己解决这个问题，或者让我的对象像 JSON 一样友好——例如让它们看起来像原生 Python 数据结构（JSON 是它的替代表示）。当然，更简单的方法是避免这种结构。

# css - 将鼠标悬停图像向左移动？

> ID：14329533
> 
> 赞同：0
> 
> 时间：2013-01-15T00:59:12.810
> 
> 标签：css, html, onmouseover

这是我的页面：[http ://www.ostmoconstruction.com/portfolio.php](http://www.ostmoconstruction.com/portfolio.php)

我决定为这个小画廊中的每个图像更改鼠标悬停图像，以提供更大的图像预览，但是当我提供更多图像时，它们会超出 div 的范围。无论如何将中间段落移动到左侧 onmouseover 或沿着这些线移动以将整个内容保留在 div 层中？

有没有办法，当鼠标悬停时图像发生变化时，将其移动到 div 层的左侧 - 以有效地防止它超出（右侧）div 层？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-15T01:11:12.283

将此样式添加到鼠标悬停时显示的图像

```
position: absolute;
left: 0;
top: 38px; 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-01-22T18:15:58.203

另一个答案几乎是正确的，但我还必须将它包装在一个具有“位置：相对；”的 div 中。有它自己的负左边距。这将另一个图像和它的标题推到了视野之外！

你可以在这里看到结果：[http ://www.ostmoconstruction.com/portfolio.php](http://www.ostmoconstruction.com/portfolio.php)

# android - 启动器应用程序不在选择器中

> ID：14329541
> 
> 赞同：0
> 
> 时间：2013-01-15T01:00:03.480
> 
> 标签：android, android-launcher

我正在制作启动器应用程序，但是当按下主页按钮时，我的应用程序无法显示在活动选择器中。我确定我只是缺少一些简单的东西，但我找不到它！这是我的清单文件：

```
<manifest xmlns:android="http://schemas.android.com/apk/res/android"
package="com.espian.jump"
android:versionCode="1"
android:versionName="1.0">

<uses-sdk android:minSdkVersion="16" android:targetSdkVersion="17" />
<application
    android:label="@string/app_name"
    android:icon="@drawable/ic_launcher">
    <activity
        android:name="JumpActivity"
        android:label="@string/app_name"
        android:theme="@android:style/Theme.Holo.NoActionBar"
        android:launchMode="singleTask"
        android:clearTaskOnLaunch="true"
        android:stateNotNeeded="true">
        <intent-filter>
            <action android:name="android.intent.action.MAIN" />
            <category android:name="android.intent.category.HOME" />
            <category android:name="android.intent.category.LAUNCHER" />
        </intent-filter>
    </activity>
</application> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-15T01:28:07.870

尝试替换它

```
<category android:name="android.intent.category.LAUNCHER"/> 
```

和

```
<category android:name="android.intent.category.DEFAULT"/> 
```

正如它在 android[意图过滤器文档](http://developer.android.com/guide/components/intents-filters.html)中所说：

> 愿意接收隐式意图的活动必须在其意图过滤器中包含“android.intent.category.DEFAULT”

实际上，我建议打开该页面并搜索该文本，然后阅读一下它。我想如果你这样做，你会发现这些类别更有意义。您指定它出现在启动器中。

# symfony - Symfony2 多个 Twig 扩展

> ID：14329542
> 
> 赞同：4
> 
> 时间：2013-01-15T01:00:03.910
> 
> 标签：symfony, twig, symfony-2.1

是否可以创建多个 Twig 扩展？因为当我添加第二个时，我收到第一个扩展方法在第二个扩展中不存在的错误消息。

这是我的扩展在 services.xml 中的定义方式：

```
<service id="acme.extension.view_helper" class="FLS\AcmeBundle\Extension\ViewHelperExtension">
        <argument type="service" id="doctrine.orm.entity_manager" />
        <tag name="twig.extension" />
 </service>

<service id="acme.extension.stats_helper" class="FLS\AcmeBundle\Extension\StatsExtension">
        <argument type="service" id="doctrine.orm.entity_manager" />
        <tag name="twig.extension" />
</service> 
```

这是错误消息：

> 致命错误：在第 232 行调用 F:\www\AcmeBundle\app\cache\dev\twig\fe\fd\4ff31bf8efd0669b6d0b2a14ba11.php 中的未定义方法 FLS\AcmeBundle\Extension\StatsExtension::findTask()

findTask 方法在 ViewHelperExtension 中定义。

提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2017-02-09T18:50:15.587

**编辑：TL；DR。是的。有可能的**

我现在刚遇到这个问题。就我而言，这样做的原因是我从两个扩展的相同样板开始，并且`getName()`每个扩展中的函数都返回相同的名称。

一旦我更改了函数在每个扩展上返回的名称，两个扩展都被添加了。我假设以下内容会起作用：

在*src/AppBundle/Twig/AppBundleFooExtension.php*

```
/* ... */
public function getName()
{
    return 'appbundle_foo_extension';
}
/* ... */ 
```

在*src/AppBundle/Twig/AppBundleBarExtension.php*

```
/* ... */
public function getName()
{
    return 'appbundle_bar_extension';
}
/* ... */ 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-15T05:21:46.517

我在我的项目中使用了几个树枝扩展，一切都很好。您的 services.xml 包含服务标签？ `<services> // Services definition </services>` 看起来像第二个服务覆盖第一。

文章[如何编写自定义 Twig 扩展](http://symfony.com/doc/2.0/cookbook/templating/twig_extension.html)

# python - 我可以将 python **kwargs 从 sub 传递给父类吗？

> ID：14329552
> 
> 赞同：10
> 
> 时间：2013-01-15T01:01:24.190
> 
> 标签：python, keyword-argument

我想做这样的事情：

```
class A(object):
    def __init__(self, **kwargs):
       """ 
       return exception if certain arguments not set
       """

class B(A):
    def __init__(self, **kwargs):
       super(B, self).__init__(**kwargs) 
```

基本上，每个子类都需要正确实例化某些参数。它们在所有方面都是相同的参数。我只想检查这些参数一次。如果我可以从父**级 init** () 中做到这一点 - 那就更好了。

是否有可能做到这一点？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-01-15T01:14:15.340

当然。这不是一个不常见的模式：

```
class A(object):
    def __init__(self, foo, bar=3):
        self.foo = foo
        self.bar = bar

class B(A):
    def __init__(self, quux=6, **kwargs):
        super(B, self).__init__(**kwargs)

        self.quux = quux

B(foo=1, quux=4) 
```

这也使您免受恶作剧的影响：现在[`super`argspec](https://fuhm.net/super-harmful/)`A`可以更改而无需对 进行任何编辑`B`，并且钻石继承不太可能中断。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-15T01:05:22.113

绝对地。当输入参数和关键字参数时，参数和关键字扩展将自然地起作用。

# angularjs - 在 AngularJS Partials 中使用 3rd Party Javascript？

> ID：14329554
> 
> 赞同：1
> 
> 时间：2013-01-15T01:01:46.940
> 
> 标签：angularjs

我使用 AngularJS Partial 模板来创建仪表板。有一个列表视图，当您单击一个项目时，它会切换到 Items-Detail 部分。

在 Items detail 部分中，我想通过 RGraph 显示一些图表。但是，对于我的生活，我无法弄清楚如何做到这一点。

我似乎无法从部分 html 中调用 javascript。所以我认为我需要在控制器中执行它，或者创建一个指令？

我对 AngularJS 很陌生，所以我的理解仍然非常初级，可能会被误导。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-15T02:07:08.340

AngularJS ("jqlite") 不支持部分内的 <script> 标签。

但是，在您的页面上包含 jQuery，它应该可以工作。请注意，必须在 AngularJS 之前包含 jQuery。

另请参阅[AngularJS：如何在 ng-include 中制作角度加载脚本？](https://stackoverflow.com/questions/12197880/angularjs-how-to-make-angular-load-script-inside-ng-include)

# objective-c - 有没有办法在 xcode 中轻松运行一组特定的测试或单个测试？

> ID：14329555
> 
> 赞同：2
> 
> 时间：2013-01-15T01:02:03.447
> 
> 标签：objective-c, xcode, ocmock, sentestingkit

有没有办法单独运行单个测试或一组测试？

我发现当我试图调试一个特定的测试时，这真的很烦人，因为以前的测试用例可能会触发相同的断点——所以我通常会注释掉我所有的测试，除了我正在处理的测试，但这似乎太贫民窟了。 ..所以我想知道是否有更好的方法？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-15T02:07:38.333

我知道这样做的唯一方法是编辑方案。“测试”操作有一堆复选框，您可以在其中打开或关闭测试组（即类）或单个测试。如果您经常使用相同的测试执行此操作，您可以为不同的组创建一组方案并按照您想要的方式进行设置。（或者每次都编辑它。）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-15T04:16:53.213

也许不是您要寻找的答案，但在 AppCode、Jetbrains 的 iOS 和 OSX IDE 中，您将光标放在您想要的测试上的任何位置，然后使用键盘快捷键触发它。（我使用 IntelliJ 映射，所以它的 Ctrl+Shift+F10）。

它还有一个很棒的测试运行器，显示通过或失败的测试的绿色/红色条。

# serial-port - 重新打开关闭的串口

> ID：14329558
> 
> 赞同：0
> 
> 时间：2013-01-15T01:02:07.350
> 
> 标签：serial-port, at-command

我有一个应用程序可以检测用于发送 SMS 的 USB 3G 加密狗。我的应用程序通过 AT 命令查询加密狗以确定它是否是正确的加密狗，这意味着某些加密狗只能在我的应用程序中使用（即使加密狗是同一型号）。发送和接收都很好，没有问题或任何问题。如果 3G Dongle 从 USB 端口移除，系统会检测到这一点并执行适当的程序。

这是我的问题。当重新插入 3G 加密狗时，比如在同一个端口 (COM5) 上，我的应用程序检测到这一点并执行一些 AT 命令来确定重新插入的加密狗是正确的加密狗。但是会出现错误说明：

资源正在使用中

必须终止或关闭应用程序才能使用相同的端口（例如 COM5）。然后我遇到了一个应用程序，几乎具有相同的功能，但重新插入后能够使用加密狗。

顺便说一句，我的加密狗是中兴MF190，我看到的应用程序来自华为。我正在使用 C#。有什么解决办法吗？或者更好，这有更好的逻辑吗？说使用服务等。

编辑：对加密狗的每个查询都在一个单独的线程中完成，以便能够在发送和接收时使用我的应用程序..

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-15T01:13:57.523

Windows 串口组件也有类似的问题。C# 代码中似乎存在错误。

长话短说，我设法通过在后台线程中关闭端口来解决这个问题。

这是我的代码，请注意您可能需要修改以适合您的应用程序：

```
 private bool ClosePort()
    {
        _Closing = true;
        _SerialPort.DiscardInBuffer();
        _SerialPort.DiscardOutBuffer();
        if (!_SerialPort.IsOpen) return true;
        //We run this in a new thread to avoid issue when opening and closing
        //The .NET serial port sucks apparently - and has issues such as hanging and random exceptions
        System.Threading.Thread t = new System.Threading.Thread(new System.Threading.ThreadStart(DoClosePort));
        t.Start();
        //here we wait until is **SHOULD*** be closed - note the better way is to fire an internal event when its finished 
        //We may need to tinker with this wait time
        System.Threading.Thread.Sleep(500);
        return _SerialPort.IsOpen;
    }

    private void DoClosePort()
    {
        try
        {
            //System.Threading.Thread.Sleep(500);
            _SerialPort.Close();
        }
        catch (Exception ex)
        {
            MessageBox.Show("Error closing " + _SerialPort.PortName + ". Error Message: " + ex.Message + "\r\n");
        }
    } 
```

请注意，如果您在关闭时尝试发送/接收，请在`_Closing`尝试发送之前检查类变量。

希望这对任何人都有帮助。

# sql - 当值为文本时转置 SQL 表

> ID：14329559
> 
> 赞同：0
> 
> 时间：2013-01-15T01:02:15.710
> 
> 标签：sql, sql-server, transpose

我有一个包含一系列调查回复的表格，结构如下：

```
Question Category | Question Number | Respondent ID | Answer 
```

这似乎是数据最合乎逻辑的存储方式。`Question Category`、`Question Number`和的组合`Respondent ID`是唯一的。

问题是，我被要求提供`Respondent ID`以`Answer`列为行的报告。由于`Answer`是自由文本，因此数字期望`PIVOT`命令无济于事。如果每一行都是一个特定的`Question Category`/`Question Number`配对，那就太好了，这样所有的信息都显示在一个表中。

这可能吗？我猜测将需要一定数量的动态 SQL，尤其是要显示预期的 50 多个调查。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-15T01:17:38.277

我认为这项任务应该由您的客户端代码完成 - 尝试在 SQL 端进行转置并不是一个好主意。这样的 SQL（即使可以构造）可能会非常复杂和脆弱。

首先，您应该计算有多少不同的答案 - 如果所有答案都不同，您可能不想创建 1000 列宽的报告。此外，您可能想确保答案是狭窄的——如果有人给出了非常糟糕的 1KB 宽答案怎么办？

然后，您应该根据您的标准、非转置 SQL 的结果动态构建您的报告（可能是 HTML 或其他内容）。

例如，在 HTML 中，您可以`<th>column</th>`为表格标题和`<td>value</td>`数据单元格创建任意数量的列 - 只要您已经知道输出结果中将包含多少列。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-15T02:42:00.730

如果报告服务或 excel power pivot 是报告的可能性，那么它们都可能比直接的 sql 查询更容易完成你想要的。在 RS 中，您可以使用 tablix，在 power pivot 中可以使用数据透视表。两者都避免了必须在 sql 数据透视语句中定义数据透视列，并且都可以从表格结果集中动态确定列名。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-15T02:19:07.767

对我来说，问题似乎在于列数。你不知道有多少受访者。

一种想法是连接受访者 ID。您可以在 SQL Server 中这样做：

```
select distinct Answer,
       (select cast(RespondentId as varchar(255))+'; '
        from Responses r2
        where r2.Answer = r.Answer
        for xml path ('')
       ) AllResponders
from Responses r 
```

（这是未经测试的，因此可能有语法错误。）

# ruby-on-rails - 获取与控制器中的操作关联的视图的文件名

> ID：14329566
> 
> 赞同：2
> 
> 时间：2013-01-15T01:02:54.100
> 
> 标签：ruby-on-rails, ruby-on-rails-3, ruby-on-rails-3.2

我正在使用rails 3.2。我希望能够获取将由控制器中正在执行的操作呈现的视图的文件名。我想获取文件的最后修改日期，但我不确定如何动态获取视图的文件名。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-15T11:03:20.273

Rails 3 中当前模板的完整路径名：

**在 View 环境中：**

```
<%= @view_renderer.lookup_context.find_template(@virtual_path).identifier %> 
```

**在控制器动作中：**

```
# example

def index
  @template_path = lookup_context.find_template("#{controller_path}/#{action_name}").identifier
end 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-15T02:28:29.620

这在控制器动作中很难做到，我什至不确定这是否可能，因为控制器动作不知道将呈现哪个视图（如果有的话），因为重定向是可能的。但是如果您知道视图的文件扩展名并假设它的名称与操作相同，您可以这样做：

```
Rails.root.join("app", "assets", "views", controller_name, action_name + ".html.erb").to_s 
```

在视图中，您可以执行以下操作：

```
<%= __FILE__ %> 
```

# mysql - 查找不为空且超过 10 分钟的行

> ID：14329572
> 
> 赞同：0
> 
> 时间：2013-01-15T01:03:54.377
> 
> 标签：mysql, sql, select

我正在尝试查找所有早于 10 分钟且不等于 0 或 null 的行。我好像写错了。

```
SELECT * FROM locked_users WHERE lockset < (UNIX_TIMESTAMP() - 600) AND IS NOT NULL 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-15T01:04:41.590

您只需要添加`lockset`第二个条件即可使其正常工作。

```
SELECT  *   
FROM    locked_users 
WHERE   lockset < (UNIX_TIMESTAMP() - 600) AND 
        lockset IS NOT NULL AND
        lockset <> 0 
```

# c# - 为什么这个内存映射文件不能正确读取？

> ID：14329574
> 
> 赞同：0
> 
> 时间：2013-01-15T01:04:22.337
> 
> 标签：c#, memory-mapped-files

我有一种感觉，我做错了什么，但我不确定是什么。

这是我的代码：

```
 long offset = 0x009694E3;
        long length = 0x02;
        byte[] bytes = new byte[length];

        // Create the memory-mapped file.
        using (var mmf =
            MemoryMappedFile.CreateFromFile(strFileName, FileMode.Open, "ISO"))
        {
            // Create a random access view, from the 256th megabyte (the offset)
            // to the 768th megabyte (the offset plus length).
            using (var accessor = mmf.CreateViewAccessor(offset, length))
            {
                // Make changes to the view.
                for (long i = 0; i < length; i++)
                {
                    bytes[i] = accessor.ReadByte(i);
                    dialogEdit.Text = bytes[i].ToString();
                }
            }
        } 
```

当我加载文件时，上述偏移处的文本为 0x22 0x44（“ASCII 中的 D”），但文本框的输出为“68”...

我想我误解了字节是如何工作的，但我不完全确定......

任何帮助深表感谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-15T01:21:13.703

在文本框中，您在第二个循环中用值 68 (0x44) 覆盖值 34 (0x22)。

您的程序按编程方式工作。内存映射文件的幸运逃脱。

# php - 如何创建 youtube 视频的实时流？

> ID：14329576
> 
> 赞同：7
> 
> 时间：2013-01-15T01:04:24.207
> 
> 标签：php, javascript, youtube, logic, youtube-api

我正在编写一个 youtube 视频流，这些视频应该按照设定的时间表播放，类似于电视。如果您进入网站，视频流应该会在时间表中出现的任何视频上播放。因此，它不是按视频顺序设置的播放列表，而是视频时间表。

我开始将其编码为 youtube ID 代码列表、视频长度以及视频应该播放的时间。本质上，该程序将检查当前时间，然后找到最接近该时间的视频。然后，它将找到当前时间（真实世界时间）与视频应该播放的时间之间的差异，从而快进该视频的“时间差”秒。

这是一种愚蠢的做法吗？我正在用 PHP 编写。我觉得有比手动将所有信息输入列表更好的方法。而且，还有另一种说法，现在播放这个，无论谁打开它，这都是应该播放的当前视频。每 x 分钟更新一次，检查当前视频并存储它，然后播放该视频的 cron 作业？

我希望你们能帮助我理解这个逻辑。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-17T15:17:01.617

这是我的建议：

1) 有一个包含视频链接和视频运行时间的数据库。
2）在您的页面中，如果用户正在访问该页面，请检查时间并将其与数据库中的 youtube 运行时间进行比较。
3) 如果大于或等于数据库时间，则播放视频。
4）您可以添加一些ajax并实时检查时间，如果时间等于下一个视频，则移动到下一个视频。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-05-09T04:07:18.600

创建链接数组：如果存储在数据库中并在其中包含预定时间，则更好

一旦时间被击中，让您的html元素源代码被替换..

你需要有异步类型的对象来做到这一点..

# mysql - 抛出 Grails MySQLIntegrityConstraintViolationException

> ID：14329582
> 
> 赞同：0
> 
> 时间：2013-01-15T01:05:26.170
> 
> 标签：mysql, spring, grails

我创建了一个 Grails 应用程序并将其部署到 Tomcat 服务器。我已将 Grails 应用程序配置为使用外部 MySQL 数据库。在启动 Tomcat 服务器并部署应用程序（并创建数据库模式）后，我运行一个脚本，它将关系数据从现有数据库中的多个表传输到 Grails 应用程序生成的新数据库。

该脚本运行没有问题，并且**在 INSERT 期间没有数据库错误。**

插入后，我使用我的 Grails 应用程序查看所有现有数据，没有任何问题。

但是，如果我停止 Tomcat 服务器然后重新启动它，就会出现问题。我在 catalina.out 中遇到以下错误：

```
2013-01-15 00:43:37,820 [pool-2-thread-1] ERROR util.JDBCExceptionReporter  - Duplicate entry '1-2' for key 'PRIMARY'
2013-01-15 00:43:37,826 [pool-2-thread-1] ERROR events.PatchedDefaultFlushEventListener  - Could not synchronize database state with session
org.hibernate.exception.ConstraintViolationException: Could not execute JDBC batch update
        at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:471)
        at java.util.concurrent.FutureTask$Sync.innerRun(FutureTask.java:334)
        at java.util.concurrent.FutureTask.run(FutureTask.java:166)
        at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1110)
        at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:603)
        at java.lang.Thread.run(Thread.java:679)
Caused by: java.sql.BatchUpdateException: Duplicate entry '1-2' for key 'PRIMARY'
        at com.mysql.jdbc.PreparedStatement.executeBatchSerially(PreparedStatement.java:2024)
        at com.mysql.jdbc.PreparedStatement.executeBatch(PreparedStatement.java:1449)
        at org.apache.commons.dbcp.DelegatingStatement.executeBatch(DelegatingStatement.java:297)
        at org.apache.commons.dbcp.DelegatingStatement.executeBatch(DelegatingStatement.java:297)
        ... 6 more
Caused by: com.mysql.jdbc.exceptions.jdbc4.MySQLIntegrityConstraintViolationException: Duplicate entry '1-2' for key 'PRIMARY'
        at com.mysql.jdbc.Util.handleNewInstance(Util.java:411)
        at com.mysql.jdbc.Util.getInstance(Util.java:386)
        at com.mysql.jdbc.SQLError.createSQLException(SQLError.java:1039)
        at com.mysql.jdbc.MysqlIO.checkErrorPacket(MysqlIO.java:3597)
        at com.mysql.jdbc.MysqlIO.checkErrorPacket(MysqlIO.java:3529)
        at com.mysql.jdbc.MysqlIO.sendCommand(MysqlIO.java:1990)
        at com.mysql.jdbc.MysqlIO.sqlQueryDirect(MysqlIO.java:2151)
        at com.mysql.jdbc.ConnectionImpl.execSQL(ConnectionImpl.java:2625)
        at com.mysql.jdbc.PreparedStatement.executeInternal(PreparedStatement.java:2119)
        at com.mysql.jdbc.PreparedStatement.executeUpdate(PreparedStatement.java:2415)
        at com.mysql.jdbc.PreparedStatement.executeBatchSerially(PreparedStatement.java:1976)
        ... 9 more 
```

我对这个错误感到困惑，因为如果存在重复数据，那么如何首先成功插入信息？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-22T14:45:30.457

检查您的 BootStrap.groovy 文件并检查您没有在存在的数据库中插入任何内容

示例： def adminRole = Role.findByAuthority("ROLE_ADMIN") ?: new Role(authority: "ROLE_ADMIN").save(failOnError: true)

# wifi - 查找周围启用 wifi 的设备 [站]

> ID：14329583
> 
> 赞同：7
> 
> 时间：2013-01-15T01:05:32.260
> 
> 标签：wifi, wireless, aircrack-ng

想象一下这种情况，周围有一些智能手机和计算机，它们的 WiFi 适配器（无线适配器）打开，但没有必要连接到网络。

有没有办法通过 Linux 机器查看 MAC 地址？

任何见解都值得赞赏。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-07-30T02:09:48.253

断开连接的客户端并不总是保持沉默。事实上，通常情况下，客户端发送定向和广播探测请求，搜索他们之前连接的接入点，从而揭示它们的 MAC 地址，这些地址可以通过 airodump-ng 或通过过滤 Wireshark 中的捕获数据包来显示探测请求. 这是合适的 Wireshark 过滤器：

```
wlan.fc.type_subtype eq 4 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-11-01T03:46:48.710

老问题，但无论如何我都会去。

启用 Wifi 的设备通常会发送探测请求以尝试查找它们之前已连接到的接入点，即使它们不在附近。

如果你使用 backtrack/kali linux，试试这个：

创建一个在监控模式下运行的无线适配器别名（假设您的适配器名称是 wlan0）：

`airmon-ng start wlan0`

开始扫描设备和接入点：

`airodump-ng mon0`

接入点将首先在“BSSID”下列出其 Mac 地址，然后是在“STATION”下列出其 MAC 地址的设备，如果它们未连接到切入点。

# meteor - 如何使用 smart.json 告诉陨石使用流星的稳定版本？

> ID：14329585
> 
> 赞同：7
> 
> 时间：2013-01-15T01:05:44.203
> 
> 标签：meteor

据我所知，meteorite 的目的是简化处理您的项目需要哪些版本的插件和流星分支。但我不想跟随流星树枝上的翻腾；我想使用稳定的版本。似乎这应该是可能的。我该怎么做？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-15T01:26:31.780

您可以分别[指定备用分支和分叉](https://github.com/oortcloud/meteorite)：

```
{
  meteor: {
    "branch": "devel",
    "git": "https://github.com/meteor/meteor.git"
  }
} 
```

根据文档：

> 流星规范不是必需的。Meteor 的公共 repo 签出到 master 分支是默认的。您可以指定meteor.branch 和meteor.git 分别使用备用分支和分叉。

要使用稳定版本，只需`meteor`从 smart.json 文件中完全省略该部分，您将使用最新的稳定版本。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2013-01-16T01:52:33.043

使用标签选择特定的 Meteor 版本：

```
"meteor": {
  "git": "https://github.com/meteor/meteor.git",
  "tag": "release/0.6.3.1"
}, 
```

（参见[http://oortcloud.github.com/meteorite/](http://oortcloud.github.com/meteorite/)中的 --tag ）

# .htaccess - .htaccess & mod_rewrite 重定向问题

> ID：14329586
> 
> 赞同：1
> 
> 时间：2013-01-15T01:05:55.623
> 
> 标签：.htaccess, mod-rewrite

好吧。我没有运气。所以我想我会看看你们是否可以帮助理解这个问题。

我继承了一个以前有很多不同子域的站点，这些子域现在都被写入 .htaccess 文件以重写为子目录（即*blog.site.com*变为*site.com/blog*）。

为避免重复内容问题，我还需要将所有*site.com* URL 重写为***www*** *.site.com*。尽管当前的规则对我来说看起来不错，但它们显然并没有重写域的所有子目录。（我对 RegEx 的使用从未如此出色，因此这可能是问题的一部分。）

以下是 .htaccess 中的当前规则：

```
#---------------------------------
# Start rewrite engine
#---------------------------------

<IfModule mod_rewrite.c>
  Options +FollowSymlinks
  RewriteEngine On
</IfModule>

 <IfModule mod_rewrite.c>
   RewriteCond %{HTTPS} !=on
   RewriteCond %{PATH_INFO} !^$
   RewriteCond %{HTTP_HOST} !^localhost$ [NC]
   RewriteCond %{HTTP_HOST} !^www\..+$ [NC]
   RewriteCond %{HTTP_HOST} !^blog\..+$ [NC]
   RewriteCond %{HTTP_HOST} !^docs\..+$ [NC]
   RewriteRule ^ http://www.%{HTTP_HOST}%{REQUEST_URI} [R=301,L]
 </IfModule>

#---------------------------------
# Rewrite some of our subdomains
#---------------------------------
<IfModule mod_rewrite.c>
   RewriteEngine On
   RewriteCond %{HTTP_HOST} ^blog\.site\.com$ [NC]
   RewriteRule (.*)$ "http://www.site.com/blog/$1" [R=301,QSA,L]

   RewriteCond %{HTTP_HOST} ^docs\.site\.com$ [NC]
   RewriteRule (.*)$ http://www.site.com/docs/$1 [R=301,QSA,L]

   RewriteCond %{HTTP_HOST} ^wiki\.site\.com$ [NC]
   RewriteRule (.*)$ http://www.site.com/wiki/$1 [R=301,L]

</IfModule>

#---------------------------------
# Wordpress specific - do not place anything below this line
#---------------------------------

# BEGIN WordPress
<IfModule mod_rewrite.c>
RewriteEngine On
RewriteBase /

RewriteRule ^index\.php$ - [L]
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule . /index.php [L]
</IfModule>

# END WordPress 
```

（显然，其中一些是为了允许本地开发环境等而存在的）。

关于为什么我没有看到*site.com/directory*重写为***www*** *.site.com/directory*的任何想法？我在这里想念什么？

# perl - Perl 模块找不到 IO::Handle->blocking()

> ID：14329597
> 
> 赞同：1
> 
> 时间：2013-01-15T01:07:11.250
> 
> 标签：perl, nonblocking, perl-module

我正在尝试使用 Lincoln Stein 的*Network Programming With Perl*中的一组 IO 模块，并遇到以下错误：

```
Can't locate object method "blocking" via package "IO::LineBufferedSessionData" 
at /mxhome/charrison/private/perl/IO/SessionData.pm line 22. 
```

我从 Addison/Wesley 站点为本书下载的模块集合不包含 blocking() 子例程，经过一番挖掘后，我发现它希望调用 IO::Socket 中的 blocking() 子例程的证据或者 IO::File，或者 IO::Handle.... 实际上在 IO::Handle 中有一个 blocking() 方法。

这是 IO::SessionData 模块的顶部部分，包括它正在吐槽的那一行：

```
package IO::SessionData;
# file: IO/SessionData.pm                                                                                                   
# Figure 13.5: The IO::SessionData Module Code                                                                              

use strict;
use Carp;
use IO::SessionSet;
use Errno 'EWOULDBLOCK';
use vars '$VERSION';
$VERSION = 1.00;

use constant BUFSIZE => 3000;

# Class method: new()                                                                                                       
# Create a new IO::SessionData object.  Intended to be called from within                                                   
# IO::SessionSet, not directly.                                                                                             
sub new {
  my $pack = shift;
  my ($sset,$handle,$writeonly) = @_;
  # make the handle nonblocking        
  #######################################################################                                                                                     
  $handle->blocking(0);       # <=== THIS IS THE CALL IT FAILS ON
  #######################################################################
  my $self = bless {
                outbuffer   => '',
                sset        => $sset,
                handle      => $handle,
                write_limit => BUFSIZE,
                writeonly   => $writeonly,
                choker      => undef,
                choked      => undef,
               },$pack;
  $self->readable(1) unless $writeonly;
  return $self;
} 
```

我不知道这是否足以解决问题。我对模块或面向对象的 Perl 了解甚少。我猜作者打算`blocking`在某个超类中调用一个方法（例如 IO::Handle？）。这本书写于 2001 年，也许有些规则已经改变。或者文本可能有错误。任何人都可以提出解决方案，或要求提供更多信息吗？

**更新 1：**`confess`这是在有问题的阻塞（）调用之前 生成的堆栈跟踪：

```
/Users/chap/private/wdi/server$ ./server_template -v
 at /Users/chap/private/wdi/lib/IO/SessionData.pm line 21.
    IO::SessionData::new('IO::LineBufferedSessionData', 'IO::LineBufferedSet=HASH(0x7fcbe19bd450)', 'IO::Socket::INET=GLOB(0x7fcbe18a8070)', undef) called at /Users/chap/private/wdi/lib/IO/LineBufferedSessionData.pm line 21
    IO::LineBufferedSessionData::new('IO::LineBufferedSessionData', 'IO::LineBufferedSet=HASH(0x7fcbe19bd450)', 'IO::Socket::INET=GLOB(0x7fcbe18a8070)', undef) called at /Users/chap/private/wdi/lib/IO/SessionSet.pm line 46
    IO::SessionSet::add('IO::LineBufferedSet=HASH(0x7fcbe19bd450)', 'IO::Socket::INET=GLOB(0x7fcbe18a8070)') called at /Users/chap/private/wdi/lib/IO/SessionSet.pm line 136
    IO::SessionSet::wait('IO::LineBufferedSet=HASH(0x7fcbe19bd450)') called at /Users/chap/private/wdi/lib/IO/LineBufferedSet.pm line 24
    IO::LineBufferedSet::wait('IO::LineBufferedSet=HASH(0x7fcbe19bd450)') called at ./server_template line 221 
```

如您所见，new() 正在内部被调用。（我的应用程序在堆栈的底部；其他所有内容都来自本书。）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-15T01:25:11.137

发生的事情是该类需要一个传递给它的具有该`->blocking()`方法的参数（第二个参数）。应该像这样调用它：

```
my $sset = ...;
my $handle = IO::Handle->new( ... ); #  build your IO handle
my $writeonly = ... ; 

my $session_data = IO::SessionData->new($sset, $handle, $writeonly); 
```

第一行，

```
my $pack = shift; 
```

是类名。这应该是惯用的名称：

```
my $class = shift; 
```

`new`当通过对象调用语法（语法）调用时，会自动添加这个额外的变量。通过移位，它会从参数列表`Object::Name->method`中删除该类名。`@_`其余的值是构造函数的参数。由于调用了第二个参数`$handle`并调用了该方法，因此您需要向它传递一个具有该方法的变量。处理该方法的任何东西都可以，但您可能需要某种 IO::Handle。:)

**对更新 1 的回应：**

如果您查看跟踪，您将看到：

```
IO::SessionData::new('IO::LineBufferedSessionData', 'IO::LineBufferedSet=HASH(0x7fcbe19bd450)', 'IO::Socket::INET=GLOB(0x7fcbe18a8070)', undef) 
```

作为调用该方法的事物。The `IO::Socket::INET`is an `IO::Socket`which is an `IO::Handle`，所以它应该能够有`->blocking()`可用的方法。21号线是什么？

# preg-replace - preg_replace 添加；到 javascript 函数

> ID：14329607
> 
> 赞同：0
> 
> 时间：2013-01-15T01:08:46.323
> 
> 标签：preg-replace

我有一个 javascript，其中包含类似这样的内容

```
var f = function(){
    if(){
    }else{
    }
} 
```

我需要添加；最后，像这样

```
var f = function(){
    if(){
    }else{
    }
}; 
```

我需要一些帮助来获取关闭函数 } 标记，而不是函数内部的 } 标记。谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-15T01:19:40.243

你不能，如果你只能使用正则表达式。这很像[用 regex 解析 HTML](https://stackoverflow.com/a/1732454/781965)。

相反，看看您是否可以在 PHP 中找到用于 javascript 的[AST](http://en.wikipedia.org/wiki/Abstract_syntax_tree)解析器 - 这就是您需要能够找到合适的右括号的东西。

# jquery - Resig 的 jQuery 1.7 及更高版本的 Live Search redux？

> ID：14329613
> 
> 赞同：0
> 
> 时间：2013-01-15T01:09:38.543
> 
> 标签：jquery, search, livesearch, quicksilver, resig

我最近发现 Resig 的[Quicksilver Live Search 的 jQuery 重写](http://ejohn.org/apps/livesearch/)并且喜欢它的工作原理......但我正在尝试更新它以使用新的 .on() 事件处理程序。然而，我的能力（或缺乏能力）让我失望。

我想我需要编辑“this.keyup(filter)...”，但我什么也没做。有任何想法吗？

**更新：**只是澄清一点。我想要更新脚本的想法是接受动态引入的列表项。只要它是一个静态列表，一切都可以正常工作，但是由于我引入了一个通过 ajax 调用创建的列表，所以它无法工作。我将模拟一个小提琴并很快将其链接到此处。与此同时，如果有人能帮助我，它会拯救我的隐藏。谢谢。

```
jQuery.fn.liveUpdate = function(list){
    list = jQuery(list);

    if ( list.length ) {
    var rows = list.children('li'),
        cache = rows.map(function(){
        //return this.innerHTML.toLowerCase();
        return $('a', this)[0].innerHTML.toLowerCase();
        });

    this
        .keyup(filter).keyup()
        .parents('form').submit(function(){
            return false;
        });

    }

    return this;

    function filter(){
        var term = jQuery.trim( jQuery(this).val().toLowerCase() ), scores = [];

        if ( !term ) {
            rows.show();
        } else {
            rows.hide();

            cache.each(function(i){
                var score = this.score(term);
                if (score > 0) { scores.push([score, i]); }
            });

            jQuery.each(scores.sort(function(a, b){return b[0] - a[0];}), function(){
                jQuery(rows[ this[1] ]).show();
            });
        }
    }
}; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-16T01:07:48.753

所以偶然我遇到了[这篇文章](https://stackoverflow.com/questions/13887697/adding-jquery-live-search-to-dynamic-inputs)，在[jfk](https://stackoverflow.com/users/1055987/jfk)的帮助下，它几乎总结了我正在寻找的东西。我想让脚本在创建动态内容后运行，而我应该做的是在用户想要进行搜索时调用脚本。

```
$('#staticParent').on("click", "#searchField", function(){
    $(this).livesearch("#dynamicElements").focus();
}); 
```

任何来自更高级开发人员的关于使其变得更好的额外信息，我都在听。我希望这有一天可以帮助另一个。:)

# java - 将孩子投射到不同的孩子Java

> ID：14329614
> 
> 赞同：0
> 
> 时间：2013-01-15T01:09:58.360
> 
> 标签：java, casting

我正在尝试将一个孩子投给 Java 中的兄弟姐妹（尽管我不确定这是否允许）。基本上写在下面：

```
public interface BaseInterface {
    public int a = 5;
}

public class ClassA implements BaseInterface {
    public int a = 3;
}

public class ClassB implements BaseInterface {}

public static void main(String[] args) {
    BaseInterface a = new ClassA();
    ClassB b = (ClassB) a;
} 
```

我不断收到 ClassCastException。我正在尝试将所有成员变量从 BaseInterface 对象 a 复制到 b。有人可以提供有关如何执行此操作的解决方案吗？谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-15T01:11:47.993

这是不可能的。相反，您应该给`ClassA`并`ClassB` [复制构造函数](http://www.javapractices.com/topic/TopicAction.do?Id=12)，采用`BaseInterface`：

```
public class ClassB implements BaseInterface {

    public ClassB(BaseInterface other) {
        //copy state from other instance
    }
}

public static void main(String[] args) {
    BaseInterface a = new ClassA();
    ClassB b = new ClassB(a);
} 
```

当然，这意味着您要复制到新对象而不是转换，但如果您想从 a`ClassA`转到 a ，这是唯一的选择`ClassB`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-15T01:11:19.090

A`ClassA`不是 a `ClassB`，所以这当然是不允许的。即使您禁止所有警告/错误并让代码编译，在运行时强制转换也会导致[`ClassCastException`](http://docs.oracle.com/javase/7/docs/api/java/lang/ClassCastException.html).

[http://docs.oracle.com/javase/tutorial/java/IandI/subclasses.html](http://docs.oracle.com/javase/tutorial/java/IandI/subclasses.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-15T01:16:02.007

```
public interface BaseInterface {
    public int getA();
}

public class ClassA implements BaseInterface {
    private final int a;

    public ClassA(int a) {
        this.a = a;
    }

    public int getA() {
        return a;
    }
}

public class ClassB implements BaseInterface {
    private final int a;

    public ClassB(BaseInterface baseInterface) {
        this.a = baseInterface.getA();
    }

    public int getA() {
        return a;
    }
}

public static void main(String[] args) {
    BaseInterface a = new ClassA(5);
    ClassB b = new ClassB(a);
} 
```

会做你想做的。正如其他人指出的那样，强制转换总是会给出`ClassCastException`.

# php - itemname 相同的两个数值之间的差异

> ID：14329615
> 
> 赞同：1
> 
> 时间：2013-01-15T01:10:02.430
> 
> 标签：php, mysql

我有一个名为“项目”的表

```
id       month       year       **itemname**       distmoney
 1        12         2012         chicken           20
 2        12         2012         pork              15
 3        11         2012         chicken           21
 4        11         2012         pork              15 
```

我试图找出两个月之间相同项目名称的“distmoney”之间的区别。

例子：

ID 1，物品名称 chicken。第 12 个月的 distmoney 是 20，而第 11 个月的 distmoney 是 21。我希望能够计算 id=1、itemname=chicken 的差值 1

现在我有 php 代码来计算两个数字之间的差异，但我很难弄清楚如何抓住上个月的 distmoney。

```
<?php foreach($rows as $row): ?>
<?php $number1 = htmlentities($row['distmoney']) ?>
<?php endforeach; ?>
<?php
$number1 = $row['distmoney'];
$number2 = ????????; // THIS NEEDS TO BE THE PREVIOUS MONTH DISTMONEY VALUE
if ($number1 <= $number2) {
$difference = "(Price Lowered) Price difference of $";
$result = $number2 - $number1;
$percent = round(100.0*($number2-$number1)/$number1);
echo $difference; echo $result; echo $percent; echo "%";
} elseif ($number1 > $number2) {
$result = $number1 - $number2;
$percent = round(100.0*($number2/$number1-1));
$addition = "(Price Higher) Price difference of $";
echo $addition; echo $result; echo $percent; echo "%";
} 
```

?>

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-15T01:20:43.093

您可以只预处理数据，使其按项目名称分组，并存储该项目的 distmoney 值数组。假设数据已经按日期正确排序。

```
$diff = array();
foreach($rows as $row)
{
   if(!isset($diff[$row['itemname']])
   {
      $diff[$row['itemname']] = array();
   }
   $diff[$row['itemname']][] = $row['distmoney'];
}

foreach($diff as $itemname=>$months)
{
    if(count($months) == 2)
    {
        echo $itemname.' difference: '.$months[0]-$months[1];
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-15T01:25:01.667

如果要在 SQL 中执行此操作，则可以转换列中的数据以获取差异：

```
select 
  itemname,
  max(case when month = 12 and year = 2012 then distmoney else 0 end) Dec2012,
  max(case when month = 11 and year = 2012 then distmoney else 0 end) Nov2012
from yourtable
group by itemname 
```

请参阅[带有演示的 SQL Fiddle](http://sqlfiddle.com/#!2/a7318/1)

查询的结果是：

```
| ITEMNAME | DEC2012 | NOV2012 |
--------------------------------
|  chicken |      20 |      21 |
|     pork |      15 |      15 | 
```

# dart - Dart 目录扫描和列表填充

> ID：14329616
> 
> 赞同：0
> 
> 时间：2013-01-15T01:10:03.897
> 
> 标签：dart

我是这个飞镖的新手，并且在从目录中创建包含文件名的列表时遇到问题。示例代码有意义，但不起作用并且不提供错误消息。

我真的不喜欢 Dart 如何使简单的任务复杂化。

```
var flist = new List();
Process.run('cmd', ['/c', 'dir *.txt /b']).then((ProcessResult results) {
 flist.add(results.toString());
}); 
```

我知道这很遥远..我如何在不必调用任何外部空白的情况下进行此操作..我想将我的代码保留在“主”函数中。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-15T03:09:08.757

您可能会发现此答案很有用。它展示了如何使用 Directory 对象列出目录的内容：[如何使用 Dart 列出目录的内容？](https://stackoverflow.com/questions/14268967/how-do-i-list-the-contents-of-a-directory-with-dart)

看起来您正试图在以 *.txt 结尾的目录中查找所有文件。你可以这样做：

```
import 'dart:io';

main() {
  var dir = new Directory('some directory');
  var contents = dir.listSync();
  var textFiles = contents.filter((f) => f.name.endsWith('.txt'));
} 
```

# php - POST 到 php 时不使用 &

> ID：14329619
> 
> 赞同：0
> 
> 时间：2013-01-15T01:10:36.577
> 
> 标签：php, ajax, post

我正在构建一个非常 AJAX 的站点，这意味着将大量信息发布到服务器，有时由用户键入。

这就是我发布东西的方式

```
xmlhttp.open("POST", 'somepage.php' ,true);
xmlhttp.setRequestHeader("Content-type","application/x-www-form-urlencoded");
xmlhttp.send('post=stuuf I want to send'); 
```

我的问题的一个例子是，有人输入 FOO BAR 作为他们的名字，这将发布 firstName=FOO&lastName=BAR

在 php 中得到 $_POST['firstName'] 是 FOO 而 $_POST['lastName'] 是 BAR

但是如果有人输入名字 FOO&BAR SMITH 它会像这样发布 firstName=FOO&BAR&lastName=SMITH

在 php 中，你得到 $_POST['firstName'] 是 FOO 和 $_POST['BAR'] 没有价值，这开始分崩离析。这意味着我必须在发布的所有内容中替换 & 并且我发现它很烦人。

有没有办法告诉php忽略任何&，只发送一个大字符串。当我需要发送多个值时，我打算用“_”将它们分开，然后我可以用 _ 替换任何用户键入的 _，而不必再担心了。

这可以在 .htaccess 中完成，还是在 php 文件本身中完成？

谢谢你的帮助

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-15T01:14:57.897

不要在 PHP 端这样做……发送正确的 HTTP 请求！您正在修改所有数据客户端。如果您要发送 URL 编码数据，请发送 URL 编码数据。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-15T01:15:26.120

不，但您绝对必须在将数据用作 ajax 请求中的字符串之前对其进行转义。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-15T01:15:44.830

`encodeURI`您应该使用或对要发送的数据进行编码`encodeURIComponent`。这样你就可以发送你想要的任何字符。

# javascript - 构建高级音频播放器

> ID：14329623
> 
> 赞同：0
> 
> 时间：2013-01-15T01:11:01.850
> 
> 标签：javascript, ruby-on-rails, audio-streaming

我正在构建一个允许用户上传和收听歌曲的 Rails 应用程序。为这些文件构建一个具有以下功能的播放器会很好：

**要求**

*   它根据歌曲的旋律显示声波（静态）
*   它有一个播放/暂停按钮
*   进度条可拖动快进快退
*   它在后台异步触发事件以用于跟踪目的，例如播放次数、听众的地理数据、听众保留（平均用户注意力跨度）——所有这些功能都将在后端，只需要被触发
*   它需要嵌入到其他网站上

总而言之，它很像带有一些额外功能的 soundcloud 播放器。

**问题**

*   您会为此使用哪种技术？闪光？Javascript？还有什么？
*   这有红宝石吗？
*   是否已经有（可定制的）工具或多或少地满足了这些要求？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-15T01:13:37.100

> 您会为此使用哪种技术？闪光？Javascript？还有什么？

出于兼容性目的，您确实需要同时使用两者。并非所有设备都支持 Flash，也并非所有浏览器都支持音频输出所需的 Javascript 功能。

> 这有红宝石吗？

不。您描述的大多数功能都存在于客户端，而不是服务器上。

> 是否已经有（可定制的）工具或多或少地满足了这些要求？

他们中的许多人，是的。例如，参见[jPlayer](http://www.jplayer.org/)。

# java - 在一个类中初始化一个数组并使其可供另一个类访问

> ID：14329625
> 
> 赞同：1
> 
> 时间：2013-01-15T01:11:06.737
> 
> 标签：java, arrays

这似乎很愚蠢

```
sub.local = new int[2][2];  
sub.local[0][0] =row;
sub.local[0][1]=col;
sub.local[1][0]=row;
sub.local[1][1] =col+1;

toServer.writeInt(row);
toServer.writeInt(col);
toServer.writeChar('s');

sub.placed=true;
setp1sub(sub.local); 
```

当我通过另一个类将其打印回来时，它会返回内存中的位置而不是我需要的数字。这是什么原因

```
public class ShipLocations {

static int [][] p1sub;

public ShipLocations()
{
    p1sub = new int[2][2];
}
public int[][] getp1sub()
{
    return p1sub;
}
public void setp1sub(int[][] local) {
    for (int i = 0;i <local.length;i++)
    {
        for(int j = 0;j<local.length;j++)
        {
            p1sub [i][j]= local[i][j];
        }
    }

}

} 
```

会不会是我将它作为 sub.local 传递？输出是 [[I@a401c2

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-15T01:15:33.063

而不是写

```
System.out.println(yourArray); 
```

采用

```
// for multidemensional arrays:
System.out.println(Arrays.deepToString(yourArray));
// or for one dimemsional arrays:
System.out.println(Arrays.toString(yourArray)); 
```

这是相关[JavaDoc](http://docs.oracle.com/javase/7/docs/api/java/util/Arrays.html#deepToString%28java.lang.Object%5B%5D%29)的链接。

有关您的输出的解释，您可以查看[此答案](https://stackoverflow.com/questions/13641462/string-to-char-array-showing-silly-characters/13641478#13641478)。

# r - 在应用中使用数据框列名称作为图表标签

> ID：14329626
> 
> 赞同：3
> 
> 时间：2013-01-15T01:11:06.747
> 
> 标签：r, lattice

我想创建一系列 xy 散点图，其中 y 始终是同一个变量，x 是我要检查它们是否相关的变量。作为一个例子，让我们使用`mtcars`数据集。

我对 R 比较陌生，但越来越好。

下面的代码有效，列表图表包含所有图表，除了 X 轴显示为“x”，我希望它是变量的名称。我尝试了很多组合，`xlab=`但我似乎没有得到它

如果我使用`names(data)`，我会看到我想使用的名称。我想我想引用第`names(data)`一次迭代的第一次`apply`，第二次第二次，等等。我该怎么做？

下一步是将它们打印在一个格子中，我假设一个`lapply`或`sapply`将使用打印功能来解决问题 - 我也很欣赏这个想法，只是我不需要解决方案的指针。

```
load(mtcars)
   mypanel <- function(x,y,...) {
   panel.xyplot(x,data[,y],...)
   panel.grid(x=-1,y=-1)
   panel.lmline(x,y,col="red",lwd=1,lty=1)
   } 
   data <- mtcars[,2:11]
   charts <- apply(data,2,function(x) xyplot (mtcars[,1] ~ x, panel=mypanel,ylab="MPG")) 
```

这一切都始于我无法使用面板功能循环。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-15T01:37:24.917

我没有发现这段代码“有效”。修改它这样做：

```
mypanel <- function(x,y,...) {
   panel.xyplot(x, y, ...)
   panel.grid(x=-1, y=-1)
   panel.lmline(x,y,col="red",lwd=1,lty=1)
   } 
data <- mtcars[,2:11]
charts <- lapply(names(data), function(x) { xyplot (mtcars[,1] ~ mtcars[,x], 
                                               panel=mypanel,ylab="MPG", xlab=x)}) 
```

需要从面板函数中删除 'data[,y]' 并传递名称而不是列向量，因此有一些东西可用于 x-label。

# java - Eclipse 不会将使用 maven 编译的类移动到 tomcat 运行目录

> ID：14329634
> 
> 赞同：2
> 
> 时间：2013-01-15T01:11:37.187
> 
> 标签：java, eclipse, maven, tomcat

好吧，我正在使用 Tomcat 运行时环境（它从 Eclipse 运行）运行 Eclipse，并且我最近将我的 Web 项目变成了 Maven 项目。现在它终于编译好了，但是当我尝试在服务器上运行它时，它似乎没有将编译的类和休眠配置文件加载到 Tomcat 工作目录中：

```
**D:\Dropbox\EclipseWorkspace\.metadata\.plugins\org.eclipse.wst.server.core\tmp0\wtpwebapps\myProject** 
```

因此，每次我现在更改任何内容时，我都必须手动复制所有已编译的类和几乎所有丢失的文件......

我可以更改 Eclipse 设置中的任何内容吗？另外我应该在哪里从 Maven 输出我编译的类？目前 pom.xml 中的构建如下所示：

```
<build>
    <sourceDirectory>src/</sourceDirectory>
    <directory>${basedir}/build</directory>
    <plugins>
        <plugin>
            <groupId>org.apache.maven.plugins</groupId>
            <artifactId>maven-compiler-plugin</artifactId>
            <version>2.1</version>
            <configuration>
                <source>1.6</source>
                <target>1.6</target>
            </configuration>
        </plugin>
    </plugins>
</build> 
```

谁能帮我这个？提前致谢。

# javascript - 禁用通常在提交时出现的默认警报

> ID：14329636
> 
> 赞同：1
> 
> 时间：2013-01-15T01:11:53.080
> 
> 标签：javascript, jquery

我正在尝试禁用触发 onSubmit 的默认确认框。我已经尝试了一段时间，但没有成功。这是我试过的...

我的标记

```
<form method="post" action="special.php" id="myForm" onsubmit="return confirm('Are you sure you ready to submit this order?\n\n')"> 
    //input fields
</form> 
```

我的 JavaScript

```
$('.excelDL').click(function(){
       $('#myForm').trigger('submit', function(e){
            window.alert = function() {}; //overwrite default alert
            $.post('mail.php', $(this).serialize(), function (data) {})                 
            e.preventDefault();
        });         
}); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-15T01:16:06.030

由于`onsubmit="return confirm(...)"`您的`<form>`. 如果您删除它，当您通过 JQuery 提交表单时，确认对话框将不会出现。

如果您需要显示此确认，*除非*使用您的`$('#myForm').trigger(...)`代码提交表单，然后删除您的`window.alert = function() {};`行并`$('#myForm').submit(function(){ return true; });`在调用之前添加该行`.trigger()`。这将`onsubmit`在提交表单之前删除表单的处理程序。

尝试覆盖内置方法（如`confirm()`）通常是一个坏主意，最好不要调用它们。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-15T01:21:48.750

首先，您不是在发出警报，而是在发出确认。所以改变 window.alert = function() {}; 到 window.confirm = function() {};

然后将其移到提交函数之外，以便在提交发生之前覆盖本机函数。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-15T01:43:16.443

jQuery 文档没有提到您可以将函数`.trigger`作为第二个参数传递，我不相信它确实有效。

如果你只是想发起Ajax请求而不触发`.submit`，可以直接调用

```
$.post('mail.php', $('#myForm').serialize(), function (data) {}); 
```

或仅触发使用 jQuery 绑定的事件处理程序[`.triggerHandler`](http://api.jquery.com/triggerHandler/)。在这两种情况下，`submit`都不会生成本机事件，并且不会触发与其他方式绑定的事件处理程序。

* * *

正如其他人所说，使用 jQuery 绑定所有事件处理程序而不是使用内联事件处理程序也会改进代码。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-15T01:18:43.850

把这个拿出来

```
 onsubmit="return confirm('Are you sure you ready to submit this order?\n\n')" 
```

然后您可以手动决定何时在此功能中使用警报

```
 $('#myForm').trigger('submit', function(e){
        // cal the confirm here , or write your own pop up script that looks the way you want.

    }); 
```

# javascript - 对象属性的获取器/设置器？

> ID：14329640
> 
> 赞同：1
> 
> 时间：2013-01-15T01:12:47.077
> 
> 标签：javascript, variables, typescript, getter-setter

在 Typescript 中，如何对对象的所有属性使用 getter/setter？例如，我可以有以下代码：

```
class Div {
    private _container: HTMLDivElement;
    public get container() {
        return this._container;
    }
    public set container(value) {
        alert("Updated!");
        this._container = value;
    }

    testDiv() {
        this.container = <HTMLDivElement>document.createElement('div');
        this.container.style.width = "100px";
    }
}
var newDiv: Div = new Div();
newDiv.testDiv(); 
```

“更新！” 只发出一次警报 - 当第一次设置 div 时（我猜，这确实是它应该的样子），但我希望它提醒“已更新！” 即使我在该对象上设置属性。有没有办法做到这一点，或者我应该想出某种解决方法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-15T03:16:11.850

创建一个在对象状态更改时触发的事件系统。不允许直接访问属性。通过一个控制器汇集所有活动，该控制器在必要时触发状态更改。

或者考虑使用已经这样做的框架。骨干网、淘汰赛、Angularjs 等。

# bash - 使用期望脚本自动化 install.sh 脚本

> ID：14329642
> 
> 赞同：1
> 
> 时间：2013-01-15T01:13:28.617
> 
> 标签：bash, automation, expect

我有点困惑，我似乎无法弄清楚，我相信这很容易..

我有一个外部shell脚本，我们称之为“install.sh”，用于安装我们公司开发的一个软件。我想使用 expect （带有外部参数）自动化 install.sh 过程，因为它很容易在输出字符串上进行模式匹配并传入一堆参数，作为数组或参数传递给期望脚本。

不幸的是，网上的许多示例都是针对“scp”或“ftp”的，而这些对我来说都不感兴趣，因为我正在尝试自动化一个简单的安装脚本，而不是那些交互式 shell，而不是“脚本”。

这是我正在尝试创建的简单期望脚本的示例：

```
# !/usr/bin/expect
# passed arguments
set domPassw [lindex $argv 1]
set joinDomain [lindex $argv 2]
set cdcVersion [lindex $argv 3]
set domUser [lindex $argv 4]

# cd over
cd /Users/wqcoleman/Desktop/suite-mac10.6/;

# start install
spawn ./install.sh

# first match
expect "Install the 5.1.0 package? (Q|Y|N) [Y]:"
send "Y\r" 
```

我确信我可以在这里变得聪明并在 bash 脚本中执行此操作，但就我而言，这更难，我宁愿有一个简单的迭代脚本来“匹配”输出并发送输入，看起来对我来说更简单。

我有两个基本问题。

1.  在上面运行时，它似乎没有“触发” ./install.sh 脚本。没有什么？没有什么可匹配的？什么都没有输出。
2.  我需要以 root 身份运行 ./install.sh 脚本，当我最初启动它时，我认为 spawn 会有一些“提升”的启动，但它没有，所以我不知道如何在这里执行此操作。

我打算运行这样的东西：

```
#!/bin/bash
# Ask for the administrator password upfront
sudo -v

# Keep-alive: update existing `sudo` time stamp until `.update` has finished
while true; do sudo -n true; sleep 60; kill -0 "$$" || exit; done 2>/dev/null &

# cd over
cd /Users/wqcoleman/Desktop/suite-mac10.6/;

# start install
spawn ./install.sh 
```

然后进入期望，但这根本不起作用..所以我不确定从哪里开始，编写一个bash脚本并在里面调用期望？还是编写一个期望脚本并在其中调用带有提升提示符的 install.sh ？

任何建议都是最有帮助的。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-15T02:58:38.153

```
#!/bin/bash
.......
.......
expect -c "
spawn ./install.sh
expect \"Install the 5.1.0 package\? \(Q\|Y\|N\) \[Y\]\: \"
send \"Y\r\"
interact "
.......
....... 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-15T13:10:24.197

与其专注于期望脚本，您可能会获得更好的帮助来显示安装脚本需要哪些输入。该解决方案可能就像在其标准输入上提供对 install.sh 的响应一样简单：

```
install.sh << END_OF_RESPONSES
Y
answer1
answer2
answer3
END_OF_RESPONSES 
```

# macros - 球拍宏如何将省略号传递给辅助函数？

> ID：14329644
> 
> 赞同：4
> 
> 时间：2013-01-15T01:13:39.983
> 
> 标签：macros, racket, ellipsis

鉴于：

```
(define-syntax (test stx)
  (syntax-case stx ()
    [(_ body ...)
     (with-syntax ([body0 (process-body #'(body ...))])
       #'body0)])) 
```

我应该如何接收助手中的模式和省略号？我什至不确定将 body ... 包裹在 () 内是否正确，但我已经看到它，它是唯一不会崩溃的东西。

process-body 过程以具有额外 () 包装它的语法结束。我可以尝试将其分开，但我只是想知道正确的方法是什么。

process-body 在之前和之后用一些代码包装了主体模式。而且，与定义类似，我希望能够为宏提供多种形式，而不是一个列表中的所有形式。因此，如果给定 (form1) (form2)，其中 form2 是省略号，则流程主体应该 (do-something) (form1) (form2) (do-something-else)。

IE，

```
(define-for-syntax (process-body body-syntax)
  (with-syntax ([stx body-syntax])
    (syntax/loc body-syntax
      (λ (request)
         stx)))) 
```

当然，当我在线定义模板时，我有这个工作，我想我可以在这里做到这一点，但有时模板变得笨拙，调用助手很好。

非常感谢。

作为尝试 dyoo 的第一个示例的编辑，我提供以下内容：

```
#lang racket

(define-syntax (test2 stx)
  (syntax-case stx ()
    [(_ body ...)
     (with-syntax ([(body0 ...) (process-body2 #'(body ...))])
       #'(begin body0 ...))]))

(define-for-syntax (process-body2 bodies)
  (with-syntax ([(body ...) bodies])
    (syntax/loc bodies
      (λ (request)
         body ...))))

(test2 (print "hi")) 
```

> > λ：语法错误

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-15T02:13:16.187

图案的左侧`with-syntax`也可以有椭圆，因此可以进行以下操作：

```
(define-syntax (test stx)
  (syntax-case stx ()
    [(_ body ...)
     (with-syntax ([(body0 ...) (process-body #'(body ...))])
       #'(begin body0 ...))])) 
```

基本思想是，如果`process-body`返回转换后的 body 元素，我们可以将它们全部与 a 一起引入`begin`。

* * *

您的`process-body`定义也可以`with-syntax`与省略号一起使用。所以你可以做这样的事情：

```
(define-for-syntax (process-body bodies)
  (with-syntax ([(body ...) bodies])
    (syntax/loc bodies
      (λ (request)
         body ...)))) 
```

如果这是 的定义`process-body`，我们应该修改，`test`因为结果 from`process-body`现在是一个完整的 lambda 表达式，所以我们可以直接返回它的结果：

```
(define-syntax (test stx)
  (syntax-case stx ()
    [(_ body ...)
     (process-body (syntax/loc stx (body ...)))])) 
```

* * *

作为一个独立的例子：

```
#lang racket

(define-syntax (test stx)
  (syntax-case stx ()
    [(_ body ...)
     (process-body 
      (syntax/loc stx (body ...)))]))

(define-for-syntax (process-body bodies)
  (with-syntax ([(body ...) bodies])
    (syntax/loc bodies
      (λ (request)
        (printf "before the body\n")
        body ...
        (printf "after the body\n")))))

;; Let's try it:    
(define p 
  (test (displayln "hello") (displayln "world")))

(p 'should-be-a-request) 
```

# jboss - 如何使 @id 字段在 forge crud 中可编辑？

> ID：14329648
> 
> 赞同：0
> 
> 时间：2013-01-15T01:13:57.243
> 
> 标签：jboss, annotations, crud, jboss-forge

我想为具有可编辑主键的实体生成一个 crud，但 forge 不会生成 @id 字段，这是我的实体，请注意 id 字段是一个字符串，它不是一个自动递增的 id 字段。

```
package com.samples.model;

// Generated 14/01/2013 11:23:23 AM by Hibernate Tools 3.4.0.CR1

import java.util.Date;
import java.util.HashSet;
import java.util.Set;
import javax.persistence.Column;
import javax.persistence.Entity;
import javax.persistence.FetchType;
import javax.persistence.Id;
import javax.persistence.OneToMany;
import javax.persistence.Table;
import javax.persistence.Temporal;
import javax.persistence.TemporalType;

/**
 * Pais generated by hbm2java
 */
@Entity
@Table(name = "pais", schema = "public")
public class Pais implements java.io.Serializable
{

   /**
   * 
   */
   private static final long serialVersionUID = -8369022633869576848L;
   private String paisId;
   private Date fechaRegistro;
   private String descripcion;
   private short estatus;
   private Set<Estado> estados = new HashSet<Estado>(0);

   public Pais()
   {
   }

   public Pais(String paisId, Date fechaRegistro, short estatus)
   {
      this.paisId = paisId;
      this.fechaRegistro = fechaRegistro;
      this.estatus = estatus;
   }

   public Pais(String paisId, Date fechaRegistro, String descripcion, short estatus, Set<Estado> estados)
   {
      this.paisId = paisId;
      this.fechaRegistro = fechaRegistro;
      this.descripcion = descripcion;
      this.estatus = estatus;
      this.estados = estados;
   }

   @Id
   @Column(name = "pais_id", unique = true, nullable = false, length = 5)
   public String getPaisId()
   {
      return this.paisId;
   }

   public void setPaisId(String paisId)
   {
      this.paisId = paisId;
   }

   @Temporal(TemporalType.TIMESTAMP)
   @Column(name = "fecha_registro", nullable = false, length = 29)
   public Date getFechaRegistro()
   {
      return this.fechaRegistro;
   }

   public void setFechaRegistro(Date fechaRegistro)
   {
      this.fechaRegistro = fechaRegistro;
   }

   @Column(name = "descripcion", length = 30)
   public String getDescripcion()
   {
      return this.descripcion;
   }

   public void setDescripcion(String descripcion)
   {
      this.descripcion = descripcion;
   }

   @Column(name = "estatus", nullable = false)
   public short getEstatus()
   {
      return this.estatus;
   }

   public void setEstatus(short estatus)
   {
      this.estatus = estatus;
   }

   @OneToMany(fetch = FetchType.LAZY, mappedBy = "pais")
   public Set<Estado> getEstados()
   {
      return this.estados;
   }

   public void setEstados(Set<Estado> estados)
   {
      this.estados = estados;
   }

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-15T02:09:36.693

JBoss Forge 使用[Metawidget](http://metawidget.org)生成 UI。因此，要完成此操作，您必须修改 Forge 的 metawidget.xml 配置文件。

Forge 实际上有 3 个 Metawidget 配置文件：用于查看/编辑屏幕的 metawidget-entity.xml，用于搜索过滤器的 metawidget-search.xml，以及用于生成 Java 代码的 metawidget-qbe.xml。

出于您的目的，您需要修改 metawidget-entity.xml。具体来说，您必须找到 JpaInspector 条目...

```
<jpaInspector xmlns="java:org.metawidget.inspector.jpa" config="JpaInspectorConfig"> 
```

...并添加一个子节点...

```
<hideIds><boolean>false</boolean></hideIds> 
```

那一点应该很简单。然而，实际上将修改后的 metawidget-entity.xml 重新放入 Forge 是很笨拙的。目前最简单的方法可能是解压缩并修改 forge-scaffold-faces.jar 本身。希望这将在未来的 Forge 版本中变得更清晰。

# winapi - REPARSE_DATA_BUFFER 结构的 PathBuffer 中的“SubstituteName”字符串是否总是以前缀“\??\”开头，如果是，为什么？

> ID：14329653
> 
> 赞同：2
> 
> 时间：2013-01-15T01:14:21.660
> 
> 标签：winapi, reparsepoint

我正在尝试使用与 Windows XP 及以上兼容的 Windows API 函数来查找联结或符号链接的目标。我`CreateFile`用来获取重解析点的句柄，然后`DeviceIoControl`使用`FSCTL_GET_REPARSE_POINT`标志将重解析数据读入`REPARSE_DATA_BUFFER`. 然后，我使用缓冲区中的偏移量和长度来提取`SubstituteName`和`PrintName`字符串。

在 Windows 8 中，完美地提取`PrintName`作品，给我一个正常的路径（即`c:\filename.ext`），但在 XP 中，该`PrintName`部分的`REPARSE_DATA_BUFFER`长度似乎总是为 0，给我留下一个空字符串。

使用`SubsituteName`似乎在两者中都有效，但我总是`\??\`在文件路径的开头加上前缀（即`\??\c:\filename.ext`）。（作为旁注，也`fsutil reparsepoint query`显示`\??\`前缀）。

我已经阅读了 MSDN 上的大部分文档，但我找不到这个前缀的任何解释。如果保证前缀从每个 开始`SubstituteName`，那么当我从缓冲区复制文件路径时，我可以排除前四个字符，但我不确定是否是这种情况。我很想知道`"\??\"`前缀是否出现在`SubstituteName`所有 Microsoft 重新分析点中以及为什么。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-15T03:49:32.483

`\??\`前缀表示不解析路径。不能保证每个名称都有，因此您必须根据每个名称查找前缀，如果存在则跳过它。

**更新：**我找不到任何确切解释`\??\`实际代表的确切文档，但这里有一些链接提到了实际使用的`\??\`前缀：

[http://www.flexhex.com/docs/articles/hard-links.phtml](http://www.flexhex.com/docs/articles/hard-links.phtml)

> 请注意，szTarget 字符串必须包含以“未解析”前缀“\??\”为前缀的路径，并以反斜杠字符结尾，例如“\??\C:\Some Dir\”。

[http://social.msdn.microsoft.com/Forums/en-US/vbgeneral/thread/908b3927-1ee9-4e03-9922-b4fd49fc51a6](http://social.msdn.microsoft.com/Forums/en-US/vbgeneral/thread/908b3927-1ee9-4e03-9922-b4fd49fc51a6)

[http://mjunction.googlecode.com/svn-history/r5/trunk/MJunction/MJunction/JunctionPoint.cs](http://mjunction.googlecode.com/svn-history/r5/trunk/MJunction/MJunction/JunctionPoint.cs)

> 此前缀向 NTFS 指示该路径将被视为虚拟文件系统中的非解释路径。
> 
> Private Const NonInterpretedPathPrefix As String = "\??\"

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-15T04:03:10.767

Windows 内核有一个“DOS 设备名称空间” `\DosDevices\`，基本上是您可以打开的*任何东西*`CreateFile`所在的位置。（`QueryDosDevice`是一个为您提供该命名空间的所有成员的函数。）

因为它是一个常用的路径，所以`\??\`也会重定向到那个命名空间。所以，对于**内核**来说，路径`C:\Windows`是无效的——它真的应该写成`\??\C:\Windows`. 这就是这个符号的来源。

# java - 如何通知另一个线程

> ID：14329654
> 
> 赞同：8
> 
> 时间：2013-01-15T01:14:31.503
> 
> 标签：java, multithreading

我想知道如何通知另一个线程的最佳方式。例如，我有一个后台线程：

```
public void StartBackgroundThread(){
new Thread(new Runnable() {         
        @Override
        public void run() {
            //Do something big...
            //THEN HOW TO NOTIFY MAIN THREAD?
        }
    }).start();
} 
```

当它完成时它必须通知主线程？如果有人知道如何做到这一点的最佳方法，我将不胜感激！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-15T01:55:13.337

典型的答案是`BlockingQueue`. 两者`BackgroundThread`（通常称为生产者）和`MainThread`（通常称为消费者）共享队列的单个实例（也许它们在实例化时得到它）。每次有新消息时调用并`BackgroundThread`调用“queue.take() BlockingQueue ArrayBlockingQueue”。`queue.put(message)``MainThread``which will block until there's a message to receive. You can get fancy with timeouts and peeking but typically people want a``instance such as`

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-15T03:47:23.333

纯粹基于您的问题，您可以这样做：

```
public class test
{
  Object syncObj = new Object();

  public static void main(String args[])
  {
    new test();
  }

  public test()
  {
    startBackgroundThread();

    System.out.println("Main thread waiting...");
    try
    {
      synchronized(syncObj)
      {
        syncObj.wait();
      }
    }
    catch(InterruptedException ie) { }
    System.out.println("Main thread exiting...");
  }

  public void startBackgroundThread()
  {
    (new Thread(new Runnable()
    {
      @Override
      public void run()
      {
        //Do something big...
        System.out.println("Background Thread doing something big...");
        //THEN HOW TO NOTIFY MAIN THREAD?
        synchronized(syncObj)
        {
          System.out.println("Background Thread notifing...");
      syncObj.notify();
        }
        System.out.println("Background Thread exiting...");
      }
    })).start();
  }
} 
```

并看到这个输出

```
PS C:\Users\java> javac test.java
PS C:\Users\java> java test
Main thread waiting...
Background Thread doing something big...
Background Thread notifing...
Background Thread exiting...
Main thread exiting... 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-15T01:21:47.087

只需调用 notify()

```
public void run() { 
    try { 
        while ( true ) { 
            putMessage(); 
            sleep( 1000 ); 
        } 
    }  
    catch( InterruptedException e ) { } 
} 

private synchronized void putMessage() throws InterruptedException { 
    while ( messages.size() == MAXQUEUE ) 
        wait(); 

    messages.addElement( new java.util.Date().toString() ); 
    notify(); 
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-01-15T02:00:28.570

您不能“通知主线程”。

最好的方法是使用[`ExecutorService`](http://docs.oracle.com/javase/6/docs/api/java/util/concurrent/ExecutorService.html)，例如：

```
 import java.util.concurrent.*;

 // in main thread
 ExecutorService executorService = Executors.newSingleThreadExecutor();

 Future<?> future = executorService.submit(new Runnable() {         
    @Override
    public void run() {
        //Do something big...
    }
});

future.get(); // blocks until the Runnable finishes 
```

这些类是专门为处理异步操作而编写的，并且其中的所有代码都已经为您编写好了并且是防弹的。

### 编辑

如果您不想在等待时阻塞主线程，请在另一个线程中等待：

```
 final Future<?> future = executorService.submit(new Runnable() {         
    @Override
    public void run() {
        //Do something big...
    }
});

new Thread(new Runnable() {         
    @Override
    public void run() {
        future.get(); // blocks until the other Runnable finishes
        // Do something after the other runnable completes
    }
}).start(); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-01-15T01:23:04.947

一个线程通知另一个线程不是一个好方法。最好有 1 个主线程让从属线程工作。从属线程始终在运行并等待直到它收到工作。我建议您绘制两列并准确确定每个线程需要等待的位置。

```
 public void run() 
    {
    //Do something big...
    synchronized(this)
    {
        done = true;
    }
    } 
```

Java 包括使这一点非常容易看到的库`ExecutorService`和以下帖子 [Producer/Consumer threads using a Queue](https://stackoverflow.com/questions/2332537/producer-consumer-threads-using-a-queue)

# javascript - jQuery显示/隐藏不起作用

> ID：14329655
> 
> 赞同：10
> 
> 时间：2013-01-15T01:14:35.153
> 
> 标签：javascript, jquery, html, css

我遇到了 jQuery`hide()`和`show()`函数最奇怪的问题。

我正在处理的网站（开发版本）在[这里](http://intensity.emergingdesigns.com/)

在页面上，您将在特色产品下看到一个名为 Hydrate 的产品。这个产品有一些风味选项，所以我想做的是，当用户单击“添加到购物车”按钮时，它会显示默认隐藏的图层。请参阅此处的两个屏幕截图：

![在此处输入图像描述](../Images/168a5c42e8ffe1d24627f86ebcc4164b.png)![在此处输入图像描述](../Images/e3f38a3b6e0de791bb67183e538a40d7.png)

但是，当我单击“添加到购物车”按钮时，该图层不会出现。下面的 Firebug 屏幕截图显示了我单击“添加到购物车”按钮后元素的外观。 ![在此处输入图像描述](../Images/4ca3a18330a1f3f83fef702ce9311df4.png)

请注意，根据 jQuery 规范，元素样式是“display: block”，然后*应该*覆盖“display: none”的 CSS 元素样式。我已经这样做了数百次，如果不是更多的话，这是第一次没有奏效。现在看看下面的 Firebug 屏幕截图。如果我在调试控制台中单击 display:none 旁边的红色斜线圆圈，则该图层将完全按照应有的方式显示。 ![在此处输入图像描述](../Images/05aceb70bbab503de38a920df862ad8f.png)

以下是我认为相关代码的片段，但我看不出问题出在哪里。

CSS 代码：

```
.carouselProduct {float:left; border:2px solid #e9e9e9; width:223px; min-height:242px; margin:18px 2px 0 2px; position:relative; overflow:hidden;}
.productOptions{
    position:absolute;
    bottom:0px;
    left:0px;
    width:211px;
    background: url('../images/black_background_75.png');
    z-index:99999;
    padding: 6px;
    height:170px;
    display:none;
} 
```

JS代码：

```
$(document).ready(function(){
    $.noConflict();
    jQuery('.add_to_cart_btn').live('click',function(e){
        e.preventDefault();
        $(this).getForm().sendRequest( 'shop:on_addToCart', {update: {'mini_cart': 'mini:cart'} });
    });
    jQuery('.choose_options').live('click',function(e){
        e.preventDefault();
        jQuery('#options_'+jQuery(this).attr('rel')).show();
    });
}); 
```

注意：我想也许有某种方式干扰了所以我实施了 noConflict 但它没有任何区别。另请注意，我在 Firebug 中没有收到任何 JS 错误。

HTML 代码：

```
<article class="carouselProduct"> 
    <!--productContent starts here-->
    <article class="productContent">
        <a href="/shop/product/intensity-hydrate"><img class='productImage' src="/uploaded/thumbnails/db_file_img_33_autox126.png" style="margin: 3px;"></a>
        <hgroup>
            <h4>Hydrate</h4>
           <h3>$25.00</h3>
            <h3 class="orange">$15.00</h3>
        </hgroup>
        <strong>Key Benefits:</strong>
        <ul>
            <li>Proper electrolyte balance</li>
            <li>Reduce muscle fatigue & cramping</li>
        </ul>
        </article>
        <!--productContent ends here--> 
        <!--productOptions layer starts here -->
        <div class="productOptions" id="options_1">
            <div class='selectbox1'>
                <label>Flavor</label>
                <select class='my-dropdown' name='product_options[4448804864d703e8b696c3fa7713aa23]'>
                    <option value='Fruit Punch'>Fruit Punch</option>
                    <option value='Orange'>Orange</option>
                </select>
            </div><br>
            <article class="product_btn">
                <a class="yellow_btn" rel="1" title="Add To Cart" href="#" onclick="return $(this).getForm().sendRequest( 'shop:on_addToCart', {update: {'mini_cart': 'mini:cart'},onSuccess: function(){ close_layer(1) } })">Add To Cart</a>
                <a class="gray_btn" title="View More" href="#" onclick="close_layer(1)">Cancel</a>
            </article>
        </div>
        <!--productOptions layer ends here -->
        <!--product_btn starts here-->
        <article class="product_btn">
            <a class="yellow_btn choose_options" title="Add To Cart" href="#" rel="1">Add To Cart</a>
            <a class="gray_btn" title="View More" href="/shop/product/intensity-hydrate">View More</a>
        </article>
    <!--product_btn ends here--> 
</article> 
```

请注意，有两个“添加到购物车”按钮。只有此处代码中的最后一个（最初显示的那个）具有“choose_options”类。此外，在覆盖层内的取消按钮上，我调用了一个名为 close_layer 的函数，该函数将 id 传入，然后运行 ​​jQuery hide() 函数，该函数也不起作用。

我已经尝试了我能想到的一切。我已经禁用了其他 JS 和 CSS，但它仍然不起作用。我已经控制台记录了所有内容并添加了警报。它正在运行该函数，因为它将元素显示样式添加到隐藏的 div 中，但某些东西并没有让它覆盖 CSS 文件。

任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-01-15T01:47:21.397

在您的页面上，有多个 div 具有相同的 ID - 'options_1'。所以你的代码只改变其中一个。如果您确实想显示所有这些，那么您可以按如下方式进行：

```
jQuery('div[id=options_'+jQuery(this).attr('rel')+']').show(); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-15T01:22:39.313

我觉得这个问题是由**特异性引起的**

`element.style`具有更高的特异性，`.productoptions`因为**该属性是样式属性的一部分**

即使你`apply the class`对元素 `element.style`也会**给予优先考虑。**.

对您来说更好的选择是`Remove the style attribute from your HTML..`

添加`display:block`里面的类..

```
.block
{
    display : block;
} 
```

* * *

```
<div id="options_1" style="display:block"> 
```

现在应该看起来像

```
<div id="options_1" class="block"> 
```

现在使用`.addClass()` and`.removeClass()`来指定你的逻辑。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-15T01:44:09.307

看来你的 DOM 搞砸了。也许您在某处或某处缺少标签？

无论如何，我访问了您的页面，当我更改时：

`jQuery('#options_'+jQuery(this).attr('rel')).show();`

到

`jQuery('#options_'+jQuery(this).attr('rel')).show().appendTo(jQuery(this).parent())`

一切安好。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-10-28T15:22:24.647

我有一个类似的问题，调试后发现我在覆盖我的隐藏（）的地方之一强制“显示：内联块！重要”。你能检查一下 !important 是否在 CSS 中可以相关的任何地方使用吗？

# jquery - 颜色框 jQuery 编辑

> ID：14329656
> 
> 赞同：0
> 
> 时间：2013-01-15T01:14:43.453
> 
> 标签：jquery, colorbox

我正在使用 jQuery 插件 ColorBox。

我想让它的样式像 facebook。

所以照片会在左边，描述和评论在右边。

我不擅长 javascript，我在问是否有人可以看一下代码并就如何编辑代码给我一个建议..

基本上，我需要用 2 个 DIV 替换当前显示图像的 div `float:left`。

第一个 div 将加载图像，第二个 div 将加载描述和一些自定义 html。

我正在使用固定宽度/高度主题。

我看过了，但正如我之前所说，我不擅长 javascript，而且我不知道在哪里编辑。

希望可以有人帮帮我！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-15T01:41:25.523

你不需要编辑插件的源代码

更改 cboxTitle 和 cboxLoadedContent 的 css (float:left, 设置一些宽度)

要添加自定义内容（超过 a 标签的 title 属性），您必须使用 onLoad 或 onOpen 回调

```
$("#inline").colorbox({
       onOpen : function() {
            //apend your content to cboxTitle
          }
       }); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-15T16:47:19.543

一个更简单的方法是使用 ColorBox 和它的 iFrame 选项。我这样做是为了让插件打开一个全新的 HTML 页面，可以随意设置样式。通过这种方式，您基本上将 ColorBox 用作窗口管理器。祝你好运！

# php - 带连字符的 GET 引发错误 403

> ID：14329657
> 
> 赞同：3
> 
> 时间：2013-01-15T01:14:52.390
> 
> 标签：php, apache, .htaccess, request.querystring, mod-security2

我有一个`PHP`脚本可以处理来自支付处理器的回调。

如果查询字符串 'result' 包含双破折号后跟一个单破折号，我们会得到 403，例如

```
/index.php?result=A--B-  (returns 403)
/index.php?result=A-B-   (is OK)
/index.php?result=A-B--  (is OK)
/index.php?result=A--B   (is OK)
/index.php?result=A---B  (returns 403)
/index.php?result=A-B-C- (is OK) 
```

`.htaccess`对于此站点，或中没有重写规则`apache config`。

加载的模块如下：

```
core prefork http_core mod_so mod_auth_basic 
mod_auth_digest mod_authn_file mod_authn_alias 
mod_authn_anon mod_authn_dbm mod_authn_default 
mod_authz_host mod_authz_user mod_authz_owner 
mod_authz_groupfile 
mod_authz_dbm mod_authz_default util_ldap 
mod_authnz_ldap mod_include mod_log_config mod_logio 
mod_env mod_ext_filter mod_mime_magic mod_expires 
mod_deflate mod_headers mod_usertrack mod_setenvif 
mod_mime mod_dav mod_status mod_autoindex mod_info 
mod_dav_fs mod_vhost_alias mod_negotiation 
mod_dir mod_actions mod_speling mod_userdir mod_alias 
mod_rewrite mod_cache mod_suexec mod_disk_cache 
mod_file_cache mod_mem_cache mod_cgi mod_version 
mod_security2 mod_unique_id mod_php5 mod_ssl 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-15T02:52:06.877

当然它已经被 mod_security 阻止了。

“--”通常是 SQL 中行注释的开始标志。有时程序员会直接使用用户输入（如 $_GET[] 数组）来构建 SQL 查询，这会导致称为 SQL 注入的漏洞。

因此 mod_security 将检查 cookie、查询字符串和发布形式中的此类字符串。一旦发现非法字符串，它将显示 403 Forbidden 错误。

如果您的查询字符串中**确实需要**“--”并且您确定您已正确处理查询字符串（或者您实际上并未执行 SQL 查询），您可以从 mod_security 中删除此规则。

您可能会在

> MOD_SRCURITY_INSTALLATION_PATH/base_rules/modsecurity_crs_41_sql_injection_attacks.conf

MOD_SRCURITY_INSTALLATION_PATH 取决于您的服务器环境。

您可能会在附近找到此类规则

```
#
# -=[ Detect SQL Comment Sequences ]=-
# 
```

和

```
#
# -=[ PHPIDS - Converted SQLI Filters ]=-
#
# https://dev.itratos.de/projects/php-ids/repository/raw/trunk/lib/IDS/default_filter.xml
# 
```

搜索包含字符串的规则`--`并对其进行修改。由于它们都是用 RegExp 编写的，因此您应该先学习它。

# mysql - 如何编辑 mysql 表中列中的 xml 属性标记？

> ID：14329658
> 
> 赞同：0
> 
> 时间：2013-01-15T01:14:53.283
> 
> 标签：mysql, xml, xml-parsing

这是 mySQL 表中的第 XX 列。我需要更改其中一个 xml 标记的值。

如果我想在

```
<entry value="false" key="SaveColorSC"/> 
```

我该怎么做.. 表称为人员，列称为 xx.??

```
<!DOCTYPE preferences SYSTEM "http://java.sun.com/dtd/preferences.dtd">
    <preferences EXTERNAL_XML_VERSION="1.0">
        <root type="user">
            <map/>
            <node name="xxx">
                <map/>
                <node name="user">
                    <map/>
                    <node name="admin">
                        <map>
                            <entry value="DICOM" key="ImportDestination"/>
                           ...
                            <entry value="false" key="SaveColorSC"/>
                            <entry value="-256" key="GSPSColor"/>
                            <entry value="-16711936" key="SelectedAnnotationColor"/>
                            <entry value="1" key="MeasurementType"/>
                            <entry value="false" key="ChangeMeasurementTypeAfterCanc
    el"/>

Please help !

Thanks a lot !! 
```

# ruby-on-rails - Rails 3.2 - 我不想预编译的资产

> ID：14329671
> 
> 赞同：0
> 
> 时间：2013-01-15T01:16:05.310
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3.2, asset-pipeline

我正在使用带有资产管道的 Rails 3.2。它工作正常，但是在一种特殊情况下，我希望不预编译一个特定的第三方资产。

我将资产移回 public/javascripts 目录，希望可以像以前一样使用该工具，但是在运行时出现以下错误：

```
tiny_mce/tiny_mce.js isn't precompiled 
```

我很困惑，因为我认为只要将第三方 JavaScript 工具放在公共目录中，它就会被排除在资产管道之外。

在我看来，我有以下内容：

```
<%= javascript_include_tag 'tiny_mce/tiny_mce' %> 
```

任何关于这个主题的光都将不胜感激。

非常感谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-15T01:24:06.637

您可以考虑将您的供应商资产移动到`app/vendor/assets/javascripts`目录中，而不是`public`. 该`public`目录在资产预编译后用于生产环境。

如果您依赖asset-pipeline，那么`tiny-mce`在清单文件中`application.js`包含这样的文件就足够了：

```
/= require tiny_mce/tiny_mce 
```

并避免任何`javascript_include_tag`在你的意见。

# c# - 检索硬盘串行和物理 MAC 地址的最快方法

> ID：14329673
> 
> 赞同：1
> 
> 时间：2013-01-15T01:16:27.847
> 
> 标签：c#, security, native, guid

我正在开发一个客户端/服务器应用程序，它需要根据硬盘序列号和物理适配器 MAC 地址为每个注册的客户端分配一个唯一标识符......但我不喜欢使用 ManagementObjectSearcher 或任何 WMI 解决方案，因为它们很慢. 如何使用本机方法获取这些值？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-15T01:33:15.093

如果您想从硬件值中获取唯一标识符，您必须记住，对每个注册客户端始终应用相同的方法非常重要。我的意思是，如果一台机器有多个 HDD，而且这很常见，那么对于每个人，您总是必须从第一个或最后一个中取出序列号。除非您仅出于许可目的这样做，否则您还必须实施一种容差算法，该算法能够理解用户是否更改了其计算机的一个或多个组件。我将向您展示我通常用于根据硬件值创建唯一标识符的代码......它可能有点过时，特别是对于 64x 支持（尤其是注册表键和指针）而言，但这只是为了给你一个想法。指纹是从第一个 HDD 序列中创建的，

```
public static class HardwareAnalyzer
{
#region Methods: Imports
[DllImport("Iphlpapi.dll", CharSet = CharSet.Unicode, ExactSpelling = true, SetLastError = true)]
internal static extern Int32 GetAdaptersInfo(IntPtr handle, ref UInt32 size);

[DllImport("Kernel32.dll", CharSet = CharSet.Unicode, ExactSpelling = true, SetLastError = true)]
[return: MarshalAs(UnmanagedType.Bool)]
internal static extern Boolean CloseHandle([In] IntPtr handle);

[DllImport("Kernel32.dll", CharSet = CharSet.Unicode, ExactSpelling = true, SetLastError = true)]
[return: MarshalAs(UnmanagedType.Bool)]
internal static extern Boolean DeviceIoControl([In] IntPtr handle, [In] UInt32 controlCode, [In, Optional] IntPtr bufferIn, [In] UInt32 bufferInSize, [Out, Optional] IntPtr bufferOut, [In] UInt32 bufferOutSize,  [Out] out UInt32 bytesReturned, [In, Out, Optional] IntPtr overlapped);

[DllImport("Kernel32.dll", CharSet = CharSet.Unicode, ExactSpelling = false, SetLastError = true)]
internal static extern IntPtr CreateFile([In] String fileName, [In] eFileAccess fileAccess, [In] EFileShare fileShare, [In, Optional] IntPtr fileSecurity, [In] eCreationDisposition creationDisposition, [In] UInt32 flags, [In, Optional] IntPtr handleTemplateFile);
#endregion

#region Methods: Functions
private static String RetrieveDiskSerial()
{
    String serial = String.Empty;

    try
    {
        IntPtr handle = IntPtr.Zero;

        for (Int32 i = 0; i < 16; ++i)
        {
            handle = CreateFile(String.Format("\\\\.\\PhysicalDrive{0}", i), (eFileAccess.GenericRead | eFileAccess.GenericWrite), (EFileShare.Read | EFileShare.Write), IntPtr.Zero, eCreationDisposition.OpenExisting, 0, IntPtr.Zero);

            if (handle != IntPtr.Zero)
            {
                serial = RetrieveDiskSerialSmart(handle);

                if (serial.Length == 0)
                    serial = RetrieveDiskSerialStorageQuery(handle);

                if (serial.Length == 0)
                    continue;

                if (!CloseHandle(handle))
                    Console.WriteLine("WARNING: a file handle has not been correctly closed.");

                break;
            }
        }
    }
    catch { }

    return serial;
}

private static String RetrieveDiskSerialSmart(IntPtr handle)
{
    IntPtr bufferIn = Marshal.AllocHGlobal(32);
    IntPtr bufferOut = Marshal.AllocHGlobal(24);
    String serial = String.Empty;
    UInt32 bytesReturned = 0;

    try
    {
        if (DeviceIoControl(handle, 0x074080, IntPtr.Zero, 0, bufferOut, 24, out bytesReturned, IntPtr.Zero))
        {
            if ((Marshal.ReadInt32(bufferOut, 4) & 4) > 0)
            {
                SCInputParameters parameters = new SCInputParameters();
                bufferOut = Marshal.ReAllocHGlobal(bufferOut, (IntPtr)528);

                Marshal.StructureToPtr(parameters, bufferIn, true);

                if (DeviceIoControl(handle, 0x07C088, bufferIn, 32, bufferOut, 528, out bytesReturned, IntPtr.Zero))
                {
                    String serialANSI = Marshal.PtrToStringAnsi((IntPtr)(bufferOut.ToInt32() + 36), 20);

                    if (serialANSI.Length != 0)
                    {
                        Char[] serialANSICharacters = serialANSI.ToCharArray();

                        for (Int32 i = 0; i <= (serialANSICharacters.Length - 2); i += 2)
                        {
                            Char current = serialANSICharacters[i];

                            serialANSICharacters[i] = serialANSICharacters[(i + 1)];
                            serialANSICharacters[(i + 1)] = current;
                        }

                        serial = new String(serialANSICharacters).Trim();
                    }
                }
            }
        }
    }
    finally
    {
        Marshal.FreeHGlobal(bufferIn);
        Marshal.FreeHGlobal(bufferOut);
    }

    return serial;
}

private static String RetrieveDiskSerialStorageQuery(IntPtr handle)
{
    IntPtr bufferIn = Marshal.AllocHGlobal(12);
    IntPtr bufferOut = Marshal.AllocHGlobal(1024);
    StoragePropertyQuery query = new StoragePropertyQuery();
    String serial = String.Empty;
    UInt32 bytesReturned = 0;

    try
    {
        Marshal.StructureToPtr(query, bufferIn, true);

        if (DeviceIoControl(handle, 0x2D1400, bufferIn, 12, bufferOut, 1024, out bytesReturned, IntPtr.Zero))
        {
            Int32 address = bufferOut.ToInt32();
            Int32 offset = Marshal.ReadInt32(bufferOut, 24);

            if (offset != 0)
            {
                String serialANSI = Marshal.PtrToStringAnsi((IntPtr)(address + offset));

                if (serialANSI.Length != 0)
                {
                    StringBuilder builder = new StringBuilder();

                    for (Int32 i = 0; i < serialANSI.Length; i += 4)
                    {
                        for (Int32 j = 1; j >= 0; --j)
                        {
                            Int32 sum = 0;

                            for (Int32 y = 0; y < 2; ++y)
                            {
                                sum *= 16;

                                switch (serialANSI[(i + (j * 2) + y)])
                                {
                                    case '0':
                                        sum += 0;
                                        break;

                                    case '1':
                                        sum += 1;
                                        break;

                                    case '2':
                                        sum += 2;
                                        break;

                                    case '3':
                                        sum += 3;
                                        break;

                                    case '4':
                                        sum += 4;
                                        break;

                                    case '5':
                                        sum += 5;
                                        break;

                                    case '6':
                                        sum += 6;
                                        break;

                                    case '7':
                                        sum += 7;
                                        break;

                                    case '8':
                                        sum += 8;
                                        break;

                                    case '9':
                                        sum += 9;
                                        break;

                                    case 'a':
                                        sum += 10;
                                        break;

                                    case 'b':
                                        sum += 11;
                                        break;

                                    case 'c':
                                        sum += 12;
                                        break;

                                    case 'd':
                                        sum += 13;
                                        break;

                                    case 'e':
                                        sum += 14;
                                        break;

                                    case 'f':
                                        sum += 15;
                                        break;
                                }
                            }

                            if (sum > 0)
                                builder.Append((Char)sum);
                        }
                    }

                    serial = builder.ToString().Trim();
                }
            }
        }
    }
    finally
    {
        Marshal.FreeHGlobal(bufferIn);
        Marshal.FreeHGlobal(bufferOut);
    }

    return serial;
}

private static String RetrieveMACAddress()
{
    String address = String.Empty;

    try
    {
        UInt32 size = 0;
        Int32 result = GetAdaptersInfo(IntPtr.Zero, ref size);

        if ((result == 0) || (result == 111))
        {
            IntPtr buffer = Marshal.AllocHGlobal((IntPtr)size);
            result = GetAdaptersInfo(buffer, ref size);

            if (result == 0)
            {
                while (true)
                {
                    String adapterName = Marshal.PtrToStringAnsi((IntPtr)(buffer.ToInt32() + 8));
                    IntPtr handle = CreateFile(String.Format("\\\\.\\{0}", adapterName), (eFileAccess.GenericRead | eFileAccess.GenericWrite), (EFileShare.Read | EFileShare.Write), IntPtr.Zero, eCreationDisposition.OpenExisting, 0, IntPtr.Zero);

                    if (handle != IntPtr.Zero)
                    {
                        IntPtr bufferIn = GCHandle.Alloc(0x1010101, GCHandleType.Pinned).AddrOfPinnedObject();
                        IntPtr bufferOut = Marshal.AllocHGlobal(6);
                        UInt32 bytesReturned = 0;

                        try
                        {
                            if (DeviceIoControl(handle, 0x170002, bufferIn, 4, bufferOut, 6, out bytesReturned, IntPtr.Zero))
                            {
                                String temporaryAddress = String.Empty;

                                for (Int32 i = 0; i < 6; ++i)
                                    temporaryAddress += Marshal.ReadByte(bufferOut, i).ToString("X2") + ((i == 5) ? "" : ":");

                                if (temporaryAddress != "00:00:00:00:00:00")
                                {
                                    address = temporaryAddress;
                                    break;
                                }
                            }
                        }
                        finally
                        {
                            if (!CloseHandle(handle))
                                Console.WriteLine("WARNING: a file handle has not been correctly closed.");

                            Marshal.FreeHGlobal(bufferOut);
                        }
                    }

                    Int32 nextAdapterOffset = Marshal.ReadInt32(buffer);

                    if (nextAdapterOffset != 0)
                        buffer = (IntPtr)nextAdapterOffset;
                    else
                        break;
                }
            }
        }
    }
    catch { }

    return address;
}

private static String RetrieveSMBiosData()
{
    String data = String.Empty;

    try
    {
        using (RegistryKey key = Registry.LocalMachine.OpenSubKey(@"System\CurrentControlSet\Services\MSSMBios\Data", false))
        {
            if (key != null)
            {
                Byte[] keyData = (Byte[])key.GetValue("SMBiosData");

                if (keyData != null)
                {
                    using (MD5CryptoServiceProvider provider = new MD5CryptoServiceProvider())
                        keyData = provider.ComputeHash(keyData);

                    for (Int32 i = 0; i < keyData.Length; ++i)
                        data += keyData[i].ToString("X2");
                }
            }
        }
    }
    catch { }

    return data;
}

public static String CreateFingerprint()
{
    String serial = RetrieveDiskSerial();
    String address = RetrieveMACAddress();
    String data = RetrieveSMBiosData();

    if ((serial.Length == 0) && (address.Length == 0) && (data.Length == 0))
        return "0000-0000-0000-0000-0000-0000-0000-0000";

    String fingerprint = String.Empty;

    using (MD5CryptoServiceProvider provider = new MD5CryptoServiceProvider())
    {
        Byte[] hash = provider.ComputeHash(Encoding.ASCII.GetBytes(serial + " - " + address + " - " + data));

        for (Int32 i = 0; i < 16; ++i)
        {
            fingerprint += hash[i].ToString("X2");

            if (((i & 1) != 0) && (i != 15))
                fingerprint += "-";
        }
    }

    return fingerprint;
}
#endregion

#region Nesting: Enumerators
public enum eCreationDisposition : uint
{
    New              = 1,
    CreateAlways     = 2,
    OpenExisting     = 3,
    OpenAlways       = 4,
    TruncateExisting = 5
}

[Flags]
public enum eFileAccess : uint
{
    Delete               = 0x00010000,
    ReadControl          = 0x00020000,
    WriteDAC             = 0x00040000,
    WriteOwner           = 0x00080000,
    Synchronize          = 0x00100000,
    AccessSystemSecurity = 0x01000000,
    MaximumAllowed       = 0x02000000,
    GenericAll           = 0x10000000,
    GenericExecute       = 0x20000000,
    GenericWrite         = 0x40000000,
    GenericRead          = 0x80000000
}

[Flags]
public enum EFileShare : uint
{
    None   = 0x00000000,
    Read   = 0x00000001,
    Write  = 0x00000002,
    Delete = 0x00000004
}
#endregion

#region Nesting: Structures
[StructLayout(LayoutKind.Sequential)]
private class SCInputParameters
{
    private int BufferSize = 528;
    private Byte Features = 0;
    private Byte SectorCount = 1;
    private Byte SectorNumber = 1;
    private Byte LowOrderCylinder = 0;
    private Byte HighOrderCylinder = 0;
    private Byte DriveHead = 160;
    private Byte Command = 236;
    private Byte Reserved = 0;
    private Byte DriveNumber = 0;
    [MarshalAs(UnmanagedType.ByValArray, SizeConst = 16)]
    private Byte[] UselessData = new Byte[16];
}

[StructLayout(LayoutKind.Sequential)]
private class StoragePropertyQuery
{
    private Int32 PropertyID;
    private Int32 QueryType;
    private Int32 UselessData;
}
#endregion
} 
```

您只需调用 HardwareAnalyzer.CreateFingerprint() 即可获得所需的信息。

# css - 如何创建一个 CSS 箭头，它可以缩放到包含 div 的大小？

> ID：14329678
> 
> 赞同：1
> 
> 时间：2013-01-15T01:17:05.990
> 
> 标签：css

我有一个 div 需要在合并事件期间从 4 个方向（上、左、右、下）之一显示箭头。div 可以是任意大小，箭头应缩放到 div 大小的 30% 左右。

我不确定如何在不使用 JavaScript 设置三角形大小的情况下将此[jsfiddle](http://jsfiddle.net/3DzMS/)中的箭头缩放到div 的大小（将鼠标悬停在框上以了解我的意思）。也许你们知道画箭头的更好方法。`.box``border-width`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-16T04:14:40.503

这实际上隐藏了问题，但有时可能有用：（我曾经`zoom`改变容器的大小）

```
.box {
  position: relative;
  margin: 20px;  
  width: 20em;
  height: 20em;
  border: 1px solid rgb(77, 77, 77);
  box-shadow: 0px 0px 4px 0px rgb(189, 189, 189),
    0px 0px 0px 0px black inset;
}

.box:hover {
  width: 10em;
  margin: 10px;
  zoom: 200%;
}

.box:before {
  content: '';
  position: relative;
  width: 30%;
  left: 0; right: 80%; 
  height: 40px; 
  top: 45%;
  background: rgba(0,0,0,0.1);
  display: inline-block;
}

.box:after {
  content: '';
  position: absolute;
  left: 30%; top: 45%;
  margin-top: -20px;
  border-style: solid;
  border-width: 40px;
  border-color: transparent transparent transparent rgba(0,0,0,0.1);
} 
```

[演示](http://jsfiddle.net/oceog/9qS5H/)

[这里](http://jsfiddle.net/oceog/9qS5H/4/)也是带有 svg 数据的箭头，但是当您希望更改箭头的纵横比时不能使用它。

因为边框宽度不能是百分比，所以没有真正的方法来实现目标

# backbone.js - 主干开/关（拆卸）和listenTo/stopListening实现之间的区别

> ID：14329679
> 
> 赞同：4
> 
> 时间：2013-01-15T01:17:21.980
> 
> 标签：backbone.js, bind, listen, teardown

我目前正在使用骨干网来实现我的应用程序。作为内存管理的一部分，我将在切换视图时触发所有视图的拆卸

```
teardown: ->
  for viewName, view of @subViews
    view.teardown()
  for object, events of @objectEvents
    @_handleObjectEvents("off", object, events)

  @off()
  @remove()
  @undelegateEvents()
  @ 
```

这种方法是否足以确保大多数内存问题得到解决？我在这里看到的挑战是我需要跟踪每个视图的所有子视图，并在清理过程中调用所有主视图和子视图的拆卸。

我做了一些搜索，发现主干也有这两个事件：“listenTo”和“stopListening”，我们在视图级别控制事件与模型的绑定。

```
view.listenTo(model, 'change', view.render);
view.stopListening(model); 
```

我的问题是，我的拆卸实现和使用“stopListening”之间是否存在重叠？我可以只使用“stopListening”进行内存管理吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-16T06:23:09.340

简短的回答是肯定的，有重叠。

更复杂的答案是 Backbone 0.9.9 中引入的 listenTo/stopListening 方法已经使用了开/关方法，但还有一些有用的附加功能——它们将当前事件侦听器存储在称为 _listeners 的内部对象中。

使用这个对象的好处是你总是知道所有监听器的完整列表——你可以迭代它并从中删除特定的元素（记住监听器只是一个函数，一个函数只是一个对象）。

所以，你可以这样称呼它：

```
this.stopListening(emitting_object, ["reset", "add"]) // Removes listeners  for "reset" and "add" on emitting_object
this.stopListening(emitting_object) // Removes all listeners on emitting_object
this.stopListening() // Iterates over _listeners object and removes all listeners (probably the most usable case) 
```

因此，使用此方法，您可以将拆卸方法转换为以下内容：

```
this.teardown = function(){
  this.stopListening();
  ...
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-16T04:29:32.837

我建议使用 listenTo 方法。它的好处在于，当您在视图上使用 remove 方法时，它会自动取消绑定（调用 stopListening）它正在收听的内容。根据 Derrick Bailey 的说法，它还解除了 events 属性下的事件的绑定。

我将要做的，因为我正在将我的应用程序从 0.9.2 升级到 0.9.9（到目前为止实际上仍然有效），只是将我所有的开关切换到 listenTo 和 stopListening。大多数情况下，我也有关闭方法。但是，我仍然会调用 undelegateEvents，以防万一。知道您仍在摆脱事件侦听并没有什么坏处。

# python - 将字符串转换为 datime.time，错误？

> ID：14329682
> 
> 赞同：2
> 
> 时间：2013-01-15T01:17:47.867
> 
> 标签：python

我正在以字符串格式获取时间数据，例如“HH:MM”，例如“13:33”将是 13 小时 33 分钟。

所以，我用这段代码来获取时间对象，效果很好

```
datetime.datetime.strptime('13:33', '%H:%M').time() 
```

但是，我现在有新问题。新的字符串开始出现超过 24 小时，并且`datetime.datetime.strptime('25:33', '%H:%M').time()`会失败。你的建议是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-15T01:39:30.040

A `datetime.time` object represents a (local) **time of day**, independent of any particular day.

You shouldn't use it to represent an elapsed time, like you appear to be.

More appropriate might be a [`datetime.timedelta`](http://docs.python.org/2/library/datetime.html#timedelta-objects):

> A `timedelta` object **represents a duration**, the difference between two dates or times.
> 
> `class datetime.timedelta([days[, seconds[, microseconds[, milliseconds[, minutes[, hours[, weeks]]]]]]])`
> 
> All arguments are optional and default to 0\. Arguments may be ints, longs, or floats, and may be positive or negative.

An example:

```
>>> from datetime import timedelta
>>> d = timedelta(hours=25,minutes=10)
>>> d
datetime.timedelta(1, 4200) #Days, seconds 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-15T01:33:42.243

唉，您必须手动执行此操作。

```
def parse_stopwatch(s):
    hours, minutes = s.split(':', 1)
    return datetime.time(hour=int(hours), minute=int(minutes)) 
```

这真是愚蠢，理所当然。您可以自动将超过 60 分钟的时间转换为小时，或者使用正则表达式获得所有幻想，或者添加几天或几秒钟的支持。但是您必须更具体地了解这些数据的来源以及它应该代表什么。:)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-15T01:25:05.020

当你说“它只会失败”时，我假设你想知道它什么时候会失败。这是一种方法：

```
>>> import datetime
>>>
>>> time_strs = [
... "13:33",
... "25:33",
... "12:88"
... ]
>>>
>>> for s in time_strs:
...     try:
...         print datetime.datetime.strptime(s, '%H:%M').time()
...     except ValueError:
...         print "Bad time: {0}".format(s)
...
13:33:00
Bad time: 25:33
Bad time: 12:88 
```

# javascript - window.open() 调用第一次没有击中控制器

> ID：14329684
> 
> 赞同：0
> 
> 时间：2013-01-15T01:17:58.853
> 
> 标签：javascript, spring, spring-mvc, controller

请帮我解决这个荒谬的问题。我通过使用 window.open() 函数从我的 js 表单传递一个 URL，该函数将命中一个控制器方法，并且还包括一些路径变量。也就是说，

```
myUrl = "controller/"+pathVar1+"/"+pathVar2+"/controllerMethod?AUTH_TOKEN=" + getAuthTokenId() +"&";

window.open(myUrl,true); 
```

getAuthTokenId() 写在我的“global.js”文件中并且在控制器中我将方法写为

```
@Controller
@RequestMapping("/controller")
public class ControllerName{

  @RequestMapping(value = "/{pathVar1}/{pathVar2}/controllerMethod", method = RequestMethod.GET)
  public @ResponseBody void ControllerMethodDefinition(HttpServletRequest request, HttpServletResponse response, @PathVariable("pathVar1") String pathVar1,@PathVariable("pathVar2") String pathVar2){
        /***/
    }

} 
```

现在我的问题是，当 js 第一次执行来自 js 的调用时，它没有击中控制器，但下次每次都击中控制器。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-15T04:16:54.190

对于这个问题，最好的调查方法是：

1）在你的window.open（）命令之前和之后放置`alert('Before open ' + myUrl);`，`alert('After open ' + myUrl);`以确保它被执行。

2）`System.out.println("Controller hit. Pathvar 1 = " + pathVar1 + "; Pathvar 2 = " + pathVar2);`在您的控制器中，以确保它确实被击中。

我的猜测是，在第一次您的 URL 未正确初始化时，该命令将无法运行。但不管是什么原因，在您执行上述 2 个测试后应该清楚。

# php - PHP会话再生安全

> ID：14329685
> 
> 赞同：3
> 
> 时间：2013-01-15T01:18:06.613
> 
> 标签：php, security, session

我在使用 PHP 做一些非常基本的会话安全类型的事情时遇到了困难：

*   当从非认证的上下文切换到认证的上下文时，应该生成一个新的会话 ID
*   从经过身份验证的上下文切换到未经过身份验证的上下文时，应生成新的会话 ID

我想做的不仅是在切换上下文时重新生成会话ID，而且在切换这些上下文时立即将一些东西放入会话中（例如FLASH）。这三页应该有望澄清我的期望：

```
<?php
/* page1.php */
session_start();
# Just putting something in the session which I expect to
# not show up later
$_SESSION['INFO1'] = 'INFO1';
?>
<html>
<a href="page2.php">Page 2</a>
<?php print_r($_SESSION) ?>
</html> 
```

因此，当显示此页面时，我希望看到`INFO1`显示。我也希望当我回到这里时不会看到`INFO2`出现。如果我还没有会话 ID，我希望得到一个（我有）。

```
<?php
# page2.php
session_destroy();
session_regenerate_id(TRUE);
$_SESSION['INFO2'] = 'From page 2';
session_write_close();
header('Location: page3.php');
exit;
?> 
```

这将最类似于注销功能 - 我们通过传递`TRUE`给现有会话无效`session_regenerate_id`。另外，我在（可能的）**新**会话中放了一些东西——可能就像一个 FLASH——说“你已经成功注销了。

```
#page3.php
<html>
<body>
<?php session_start(); ?>
<?php print_r($_SESSION); ?>
</body>
</html> 
```

在这个页面上，我**预计**会发生两件事：

*   重定向`page2.php`应该向我发送了一个新的会话 ID cookie（它没有）
*   我希望`print_r`从 打印信息`INFO2`，而**不是**从`INFO1`。它没有来自 的信息`INFO1`，但不包括来自 的信息`INFO2`。

我`session_regenerate_id`与重定向的结果非常非常不一致。手动发送该标头似乎很麻烦`Set-Cookie`-但即使我没有，`session_regenerate_id(TRUE)`也应该使旧的会话 ID 无效-因此，即使浏览器由于某种原因没有获得新的会话 ID，它也不会看到会话中的任何信息，因为旧会话已失效。

有没有其他人遇到过这类问题？有没有解决这些问题的好方法？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-15T01:26:24.007

根据 的[文档](http://php.net/manual/en/function.session-regenerate-id.php)，`session_regenerate_id`听起来*会话的内容*总是被保留。您正在向它传递一个`TRUE`参数，但这只会删除磁盘上的实际会话文件；存储在其中的值会保留在`$_SESSION`其中，然后写入新会话。

所以也许手动清除它：

```
$_SESSION = array(); 
```

不过，不确定为什么您没有看到新的 cookie。你在哪里检查，你看到了什么？

编辑：正如 OP 在下面的评论中所揭示的那样，问题似乎是 page2 从未调用`session_start`加载第一个会话。产生以下内容：

```
<?php
    session_start();    # Load the old session
    session_destroy();  # Nuke it
    session_unset();    # Delete its contents
    session_start();    # Create a new session
    session_regenerate_id(TRUE);  # Ensure it has a new id
    $_SESSION['FLASH'] = "You've been logged out";
    session_write_close();  # Convince it to write
    header('Location: index.php');
?> 
```

我不知道这是否是最小的。弄清楚其中有多少可以删除，留给读者作为练习。

# hadoop - 是否有适用于 Hadoop/HBase 的 Amazon 社区 AMI？

> ID：14329690
> 
> 赞同：2
> 
> 时间：2013-01-15T01:18:45.200
> 
> 标签：hadoop, amazon-ec2, hbase, amazon-ami

我想在 Amazon EC2 中测试 Hadoop 和 HBase，但我不确定它有多复杂。是否有安装了 Hadoop 和 HBase 的稳定社区 AMI？我正在考虑类似[生物导体 AMI](http://www.bioconductor.org/help/bioconductor-cloud-ami/)

谢谢你。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-16T23:28:39.550

我强烈推荐使用[Amazon 的 Elastic MapReduce](http://aws.amazon.com/elasticmapreduce/)服务，特别是如果您已经拥有 AWS/EC2 账户。原因是：

1.  EMR 带有一个“开箱即用”的工作 Hadoop/HBase 集群 - 您无需调整任何内容即可使 Hadoop/HBase 正常工作。它只是工作（TM）。
2.  Amazon EC2 的网络与您可能习惯的完全不同。AFAIK，它有一个 1 对 1 的 NAT，节点可以在其中看到自己的私有 IP 地址，但它通过公共 IP 连接到外部世界。当您手动构建集群时，这会导致问题 - 即使使用专门用于 EC2 的 Apache Whirr 或 BigTop 等软件。
3.  单独的 AMI 不可能帮助您启动和运行 Hadoop 或 HBase 集群 - 如果您想运行 Hadoop/HBase 集群，您可能需要花时间调整网络设置等。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-15T02:34:45.663

据我所知，没有，但您应该能够使用[Apache Whirr](http://whirr.apache.org/)轻松部署在 EC2 上，这是一个非常好的替代方案。

这是使用 Whirr 执行此操作[的一个很好](http://www.bigfastblog.com/run-the-latest-whirr-and-deploy-hbase-in-minutes)的教程，因为教程说您应该能够在几分钟内完成此操作！

关键是创建这样的配方：

```
whirr.cluster-name=hbase
whirr.instance-templates=1 zk+nn+jt+hbase-master,5 dn+tt+hbase-regionserver
whirr.provider=ec2
whirr.identity=${env:AWS_ACCESS_KEY_ID}
whirr.credential=${env:AWS_SECRET_ACCESS_KEY}
whirr.hardware-id=c1.xlarge
whirr.image-id=us-east-1/ami-da0cf8b3
whirr.location-id=us-east-1 
```

然后，您将能够使用以下命令启动集群：

```
bin/whirr launch-cluster --config hbase-ec2.properties 
```

# java - 将纬度/经度点转换为墨卡托投影上的像素 (x,y)

> ID：14329691
> 
> 赞同：71
> 
> 时间：2013-01-15T01:19:10.783
> 
> 标签：java, math, maps, 2d, mercator

我正在尝试将 lat/long 点转换为 2d 点，以便可以将其显示在世界图像上——这是一个墨卡托投影。

我已经看到了执行此操作的各种方法以及有关堆栈溢出的一些问题-我尝试了不同的代码片段，尽管我得到了正确的像素经度，但纬度似乎总是越来越合理。

我需要公式来考虑图像大小、宽度等。

我试过这段代码：

```
double minLat = -85.05112878;
double minLong = -180;
double maxLat = 85.05112878;
double maxLong = 180;

// Map image size (in points)
double mapHeight = 768.0;
double mapWidth = 991.0;

// Determine the map scale (points per degree)
double xScale = mapWidth/ (maxLong - minLong);
double yScale = mapHeight / (maxLat - minLat);

// position of map image for point
double x = (lon - minLong) * xScale;
double y = - (lat + minLat) * yScale;

System.out.println("final coords: " + x + " " + y); 
```

在我正在尝试的示例中，纬度似乎偏离了大约 30 像素。有什么帮助或建议吗？

*更新*

基于这个问题：[Lat/lon to xy](https://stackoverflow.com/questions/2103924/mercator-longitude-and-latitude-calculations-to-x-and-y-on-a-cropped-map-of-the/10401734#10401734)

我尝试使用提供的代码，但在纬度转换方面仍然存在一些问题，经度很好。

```
int mapWidth = 991;
int mapHeight = 768;

double mapLonLeft = -180;
double mapLonRight = 180;
double mapLonDelta = mapLonRight - mapLonLeft;

double mapLatBottom = -85.05112878;
double mapLatBottomDegree = mapLatBottom * Math.PI / 180;
double worldMapWidth = ((mapWidth / mapLonDelta) * 360) / (2 * Math.PI);
double mapOffsetY = (worldMapWidth / 2 * Math.log((1 + Math.sin(mapLatBottomDegree)) / (1 - Math.sin(mapLatBottomDegree))));

double x = (lon - mapLonLeft) * (mapWidth / mapLonDelta);
double y = 0.1;
if (lat < 0) {
    lat = lat * Math.PI / 180;
    y = mapHeight - ((worldMapWidth / 2 * Math.log((1 + Math.sin(lat)) / (1 - Math.sin(lat)))) - mapOffsetY);
} else if (lat > 0) {
    lat = lat * Math.PI / 180;
    lat = lat * -1;
    y = mapHeight - ((worldMapWidth / 2 * Math.log((1 + Math.sin(lat)) / (1 - Math.sin(lat)))) - mapOffsetY);
    System.out.println("y before minus: " + y);
    y = mapHeight - y;
} else {
    y = mapHeight / 2;
}
System.out.println(x);
System.out.println(y); 
```

使用原始代码时，如果纬度值为正，则返回负点，因此我对其稍作修改并使用极端纬度进行了测试——应该是点 0 和点 766，它工作正常。但是，当我尝试不同的纬度值例如：58.07（就在英国北部）时，它显示为西班牙北部。

* * *

## 回答 #1

> 赞同：143
> 
> 时间：2013-01-22T11:07:15.523

> 墨卡托地图投影是以赤道为单一标准纬线的兰伯特圆锥保形地图投影的特殊限制情况。纬度的所有其他纬线都是直线，子午线也是与赤道成直角的直线，等距。它是投影的横向和倾斜形式的基础。它很少用于土地测绘目的，但几乎普遍用于导航图。除了保形外，它还具有在其上绘制的直线是恒定方位线的特殊属性。因此，导航员可以根据直线与经线形成的角度得出他们的航向。^([1.])

![墨卡托投影](../Images/c431e9c21f6c7615fd9d080776619bb3.png)

从球面纬度 φ 和经度 λ 导出投影东向和北向坐标的公式是：

```
E = FE + R (λ – λₒ)
N = FN + R ln[tan(π/4 + φ/2)] 
```

其中 λ [O]是自然起源的经度，FE 和 FN 是东偏和北偏。在球形墨卡托中，实际上没有使用这些值，因此您可以将公式简化为

![墨卡托投影的推导（维基百科）](../Images/a0f4b8a83d76f3c9c3e9379649d3b5f3.png)

伪代码示例，因此可以适应每种编程语言。

```
latitude    = 41.145556; // (φ)
longitude   = -73.995;   // (λ)

mapWidth    = 200;
mapHeight   = 100;

// get x value
x = (longitude+180)*(mapWidth/360)

// convert from degrees to radians
latRad = latitude*PI/180;

// get y value
mercN = ln(tan((PI/4)+(latRad/2)));
y     = (mapHeight/2)-(mapWidth*mercN/(2*PI)); 
```

资料来源：

1.  OGP Geomatics Committee，指导说明第 7 号，第 2 部分：坐标转换和转换
2.  [墨卡托投影的推导](http://en.wikipedia.org/wiki/Mercator_projection#Derivation_of_the_Mercator_projection)
3.  [国家地图集：地图投影](http://www.nationalatlas.gov/articles/mapping/a_projections.html)
4.  [墨卡托地图投影](https://stackoverflow.com/questions/1019997/convert-lat-longs-to-x-y-co-ordinates)

**编辑** 在 PHP 中创建了一个工作示例（因为我不擅长 Java）

[https://github.com/mfeldheim/mapStuff.git](https://github.com/mfeldheim/mapStuff.git)

**编辑2**

墨卡托投影的漂亮动画 [https://amp-reddit-com.cdn.ampproject.org/v/s/amp.reddit.com/r/educationalgifs/comments/5lhk8y/how_the_mercator_projection_distorts_the_poles/?usqp=mq331AQJCAEoAVgBgAEB&_js_v=0.1](https://amp-reddit-com.cdn.ampproject.org/v/s/amp.reddit.com/r/educationalgifs/comments/5lhk8y/how_the_mercator_projection_distorts_the_poles/?usqp=mq331AQJCAEoAVgBgAEB&amp_js_v=0.1)

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2013-01-15T01:56:32.583

你不能仅仅像这样从经度/纬度转置到 x/y，因为世界并不平坦。你看过这个帖子吗？[将经度/纬度转换为 X/Y 坐标](https://stackoverflow.com/questions/5983099/converting-longitude-latitude-to-x-y-coordinate)

**更新 - 2013 年 1 月 18 日**

我决定试一试，这就是我的做法：-

```
public class MapService {
    // CHANGE THIS: the output path of the image to be created
    private static final String IMAGE_FILE_PATH = "/some/user/path/map.png";

    // CHANGE THIS: image width in pixel
    private static final int IMAGE_WIDTH_IN_PX = 300;

    // CHANGE THIS: image height in pixel
    private static final int IMAGE_HEIGHT_IN_PX = 500;

    // CHANGE THIS: minimum padding in pixel
    private static final int MINIMUM_IMAGE_PADDING_IN_PX = 50;

    // formula for quarter PI
    private final static double QUARTERPI = Math.PI / 4.0;

    // some service that provides the county boundaries data in longitude and latitude
    private CountyService countyService;

    public void run() throws Exception {
        // configuring the buffered image and graphics to draw the map
        BufferedImage bufferedImage = new BufferedImage(IMAGE_WIDTH_IN_PX,
                                                        IMAGE_HEIGHT_IN_PX,
                                                        BufferedImage.TYPE_INT_RGB);

        Graphics2D g = bufferedImage.createGraphics();
        Map<RenderingHints.Key, Object> map = new HashMap<RenderingHints.Key, Object>();
        map.put(RenderingHints.KEY_INTERPOLATION, RenderingHints.VALUE_INTERPOLATION_BICUBIC);
        map.put(RenderingHints.KEY_RENDERING, RenderingHints.VALUE_RENDER_QUALITY);
        map.put(RenderingHints.KEY_ANTIALIASING, RenderingHints.VALUE_ANTIALIAS_ON);
        RenderingHints renderHints = new RenderingHints(map);
        g.setRenderingHints(renderHints);

        // min and max coordinates, used in the computation below
        Point2D.Double minXY = new Point2D.Double(-1, -1);
        Point2D.Double maxXY = new Point2D.Double(-1, -1);

        // a list of counties where each county contains a list of coordinates that form the county boundary
        Collection<Collection<Point2D.Double>> countyBoundaries = new ArrayList<Collection<Point2D.Double>>();

        // for every county, convert the longitude/latitude to X/Y using Mercator projection formula
        for (County county : countyService.getAllCounties()) {
            Collection<Point2D.Double> lonLat = new ArrayList<Point2D.Double>();

            for (CountyBoundary countyBoundary : county.getCountyBoundaries()) {
                // convert to radian
                double longitude = countyBoundary.getLongitude() * Math.PI / 180;
                double latitude = countyBoundary.getLatitude() * Math.PI / 180;

                Point2D.Double xy = new Point2D.Double();
                xy.x = longitude;
                xy.y = Math.log(Math.tan(QUARTERPI + 0.5 * latitude));

                // The reason we need to determine the min X and Y values is because in order to draw the map,
                // we need to offset the position so that there will be no negative X and Y values
                minXY.x = (minXY.x == -1) ? xy.x : Math.min(minXY.x, xy.x);
                minXY.y = (minXY.y == -1) ? xy.y : Math.min(minXY.y, xy.y);

                lonLat.add(xy);
            }

            countyBoundaries.add(lonLat);
        }

        // readjust coordinate to ensure there are no negative values
        for (Collection<Point2D.Double> points : countyBoundaries) {
            for (Point2D.Double point : points) {
                point.x = point.x - minXY.x;
                point.y = point.y - minXY.y;

                // now, we need to keep track the max X and Y values
                maxXY.x = (maxXY.x == -1) ? point.x : Math.max(maxXY.x, point.x);
                maxXY.y = (maxXY.y == -1) ? point.y : Math.max(maxXY.y, point.y);
            }
        }

        int paddingBothSides = MINIMUM_IMAGE_PADDING_IN_PX * 2;

        // the actual drawing space for the map on the image
        int mapWidth = IMAGE_WIDTH_IN_PX - paddingBothSides;
        int mapHeight = IMAGE_HEIGHT_IN_PX - paddingBothSides;

        // determine the width and height ratio because we need to magnify the map to fit into the given image dimension
        double mapWidthRatio = mapWidth / maxXY.x;
        double mapHeightRatio = mapHeight / maxXY.y;

        // using different ratios for width and height will cause the map to be stretched. So, we have to determine
        // the global ratio that will perfectly fit into the given image dimension
        double globalRatio = Math.min(mapWidthRatio, mapHeightRatio);

        // now we need to readjust the padding to ensure the map is always drawn on the center of the given image dimension
        double heightPadding = (IMAGE_HEIGHT_IN_PX - (globalRatio * maxXY.y)) / 2;
        double widthPadding = (IMAGE_WIDTH_IN_PX - (globalRatio * maxXY.x)) / 2;

        // for each country, draw the boundary using polygon
        for (Collection<Point2D.Double> points : countyBoundaries) {
            Polygon polygon = new Polygon();

            for (Point2D.Double point : points) {
                int adjustedX = (int) (widthPadding + (point.getX() * globalRatio));

                // need to invert the Y since 0,0 starts at top left
                int adjustedY = (int) (IMAGE_HEIGHT_IN_PX - heightPadding - (point.getY() * globalRatio));

                polygon.addPoint(adjustedX, adjustedY);
            }

            g.drawPolygon(polygon);
        }

        // create the image file
        ImageIO.write(bufferedImage, "PNG", new File(IMAGE_FILE_PATH));
    }
} 
```

**结果：图像宽度 = 600 像素，图像高度 = 600 像素，图像填充 = 50 像素**

![在此处输入图像描述](../Images/b26fe373d6ad071eb2a07f33ff83442f.png)

**结果：图像宽度 = 300 像素，图像高度 = 500 像素，图像填充 = 50 像素**

![在此处输入图像描述](../Images/105fa0e5d0ee4d5c92ae80cf47ad6c19.png)

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2013-07-02T06:53:31.130

Java版原版[Google Maps JavaScript API v3](https://developers.google.com/maps/documentation/javascript/examples/map-coordinates) java脚本代码如下，运行没有问题

```
public final class GoogleMapsProjection2 
{
    private final int TILE_SIZE = 256;
    private PointF _pixelOrigin;
    private double _pixelsPerLonDegree;
    private double _pixelsPerLonRadian;

    public GoogleMapsProjection2()
    {
        this._pixelOrigin = new PointF(TILE_SIZE / 2.0,TILE_SIZE / 2.0);
        this._pixelsPerLonDegree = TILE_SIZE / 360.0;
        this._pixelsPerLonRadian = TILE_SIZE / (2 * Math.PI);
    }

    double bound(double val, double valMin, double valMax)
    {
        double res;
        res = Math.max(val, valMin);
        res = Math.min(res, valMax);
        return res;
    }

    double degreesToRadians(double deg) 
    {
        return deg * (Math.PI / 180);
    }

    double radiansToDegrees(double rad) 
    {
        return rad / (Math.PI / 180);
    }

    PointF fromLatLngToPoint(double lat, double lng, int zoom)
    {
        PointF point = new PointF(0, 0);

        point.x = _pixelOrigin.x + lng * _pixelsPerLonDegree;       

        // Truncating to 0.9999 effectively limits latitude to 89.189\. This is
        // about a third of a tile past the edge of the world tile.
        double siny = bound(Math.sin(degreesToRadians(lat)), -0.9999,0.9999);
        point.y = _pixelOrigin.y + 0.5 * Math.log((1 + siny) / (1 - siny)) *- _pixelsPerLonRadian;

        int numTiles = 1 << zoom;
        point.x = point.x * numTiles;
        point.y = point.y * numTiles;
        return point;
     }

    PointF fromPointToLatLng(PointF point, int zoom)
    {
        int numTiles = 1 << zoom;
        point.x = point.x / numTiles;
        point.y = point.y / numTiles;       

        double lng = (point.x - _pixelOrigin.x) / _pixelsPerLonDegree;
        double latRadians = (point.y - _pixelOrigin.y) / - _pixelsPerLonRadian;
        double lat = radiansToDegrees(2 * Math.atan(Math.exp(latRadians)) - Math.PI / 2);
        return new PointF(lat, lng);
    }

    public static void main(String []args) 
    {
        GoogleMapsProjection2 gmap2 = new GoogleMapsProjection2();

        PointF point1 = gmap2.fromLatLngToPoint(41.850033, -87.6500523, 15);
        System.out.println(point1.x+"   "+point1.y);
        PointF point2 = gmap2.fromPointToLatLng(point1,15);
        System.out.println(point2.x+"   "+point2.y);
    }
}

public final class PointF 
{
    public double x;
    public double y;

    public PointF(double x, double y)
    {
        this.x = x;
        this.y = y;
    }
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2020-10-22T18:13:24.070

仅限JAVA？

Python代码在这里！请参阅[在墨卡托投影上将纬度/经度点转换为像素 (x,y)](https://stackoverflow.com/questions/14329691/convert-latitude-longitude-point-to-a-pixels-x-y-on-mercator-projection#answer-14457180)

```
import math
from numpy import log as ln

# Define the size of map
mapWidth    = 200
mapHeight   = 100

def convert(latitude, longitude):
    # get x value
    x = (longitude + 180) * (mapWidth / 360)

    # convert from degrees to radians
    latRad = (latitude * math.pi) / 180

    # get y value
    mercN = ln(math.tan((math.pi / 4) + (latRad / 2)))
    y     = (mapHeight / 2) - (mapWidth * mercN / (2 * math.pi))

    return x, y

print(convert(41.145556, 121.2322)) 
```

回答：

```
(167.35122222222225, 24.877939817552335) 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2021-06-13T23:15:28.967

我是新来的，只是为了写作，因为我已经关注社区好几年了。我很高兴能够做出贡献。

好吧，我几乎花了一天的时间来寻找它，你的问题鼓励我继续寻找。

我到达了以下功能，该功能有效！本文致谢：[https ://towardsdatascience.com/geotiff-coordinate-querying-with-javascript-5e6caaaf88cf](https://towardsdatascience.com/geotiff-coordinate-querying-with-javascript-5e6caaaf88cf)

```
var bbox = [minLong, minLat, maxLong, maxLat];
var pixelWidth = mapWidth;
var pixelHeight = mapHeight;
var bboxWidth = bbox[2] - bbox[0];
var bboxHeight = bbox[3] - bbox[1];

var convertToXY = function(latitude, longitude) {
    var widthPct = ( longitude - bbox[0] ) / bboxWidth;
    var heightPct = ( latitude - bbox[1] ) / bboxHeight;
    var x = Math.floor( pixelWidth * widthPct );
    var y = Math.floor( pixelHeight * ( 1 - heightPct ) );
    return { x, y };
} 
```

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2014-04-02T23:54:22.157

```
 public static String getTileNumber(final double lat, final double lon, final int zoom) {
 int xtile = (int)Math.floor( (lon + 180) / 360 * (1<<zoom) ) ;
 int ytile = (int)Math.floor( (1 - Math.log(Math.tan(Math.toRadians(lat)) + 1 /  Math.cos(Math.toRadians(lat))) / Math.PI) / 2 * (1<<zoom) ) ;
if (xtile < 0)
 xtile=0;
if (xtile >= (1<<zoom))
 xtile=((1<<zoom)-1);
if (ytile < 0)
 ytile=0;
if (ytile >= (1<<zoom))
 ytile=((1<<zoom)-1);
return("" + zoom + "/" + xtile + "/" + ytile);
 }
} 
```

# mysql - 可以将外键约束添加到 mysql 中的复合键吗？

> ID：14329692
> 
> 赞同：2
> 
> 时间：2013-01-15T01:19:25.563
> 
> 标签：mysql, sql, phpmyadmin

所以我有2张桌子。

主题时间表：

```
CREATE TABLE IF NOT EXISTS `subject_schedule` (
  `subject` varchar(10) NOT NULL,
  `schedule_id` int(11) NOT NULL,
  `id` int(11) NOT NULL,
  PRIMARY KEY (`subject`,`schedule_id`),
  KEY `schedule_id` (`schedule_id`)
) ENGINE=InnoDB DEFAULT CHARSET=latin1; 
```

和预约：

```
CREATE TABLE IF NOT EXISTS `appointment` (
  `work_plan` varchar(1000) DEFAULT NULL,
  `date` date DEFAULT NULL,
  `homework_given` varchar(1000) DEFAULT NULL,
  `tutor_comments` varchar(1000) DEFAULT NULL,
  `admin_comments` varchar(1000) DEFAULT NULL,
  `id` int(11) NOT NULL AUTO_INCREMENT,
  `schedule_id` int(11) NOT NULL,
  `attended` tinyint(1) NOT NULL DEFAULT '1',
  `arrival_time` time DEFAULT NULL,
  `departure_time` time DEFAULT NULL,
  `homework_completed` tinyint(1) NOT NULL DEFAULT '0',
  `subject` varchar(10) NOT NULL,
  PRIMARY KEY (`id`),
  KEY `schedule_id` (`schedule_id`),
  KEY `subject` (`subject`)
) ENGINE=InnoDB  DEFAULT CHARSET=latin1 AUTO_INCREMENT=10004 ; 
```

我想创建一个在约会中引用复合键的外键。我试过了：

```
ALTER TABLE 'appointment'
ADD CONSTRAINT 'appointment_fk' FOREIGN KEY (`schedule_id`, `subject`) 
REFERENCES 'subject_schedule' ('schedule_id', 'subject'); 
```

但它在 PhpMyAdmin 中返回错误：

> `#1064`- 您的 SQL 语法有错误；检查与您的 MySQL 服务器版本相对应的手册，以在 ''appointment' ADD CONSTRAINT 'appointment_fk' FOREIGN KEY ( `schedule_id`, 'su' at line 1附近使用正确的语法

我究竟做错了什么？将 id 作为主键并引用它而不是使用复合键会更好吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-15T01:21:17.773

columnNames 不应该用单引号引起来，因为它将被转换为字符串（*不再是列*）

```
ALTER TABLE appointment
ADD CONSTRAINT appointment_fk FOREIGN KEY (`schedule_id`, `subject`) 
REFERENCES subject_schedule (schedule_id, subject); 
```

*   [SQLFiddle 演示](http://sqlfiddle.com/#!2/95f8a/1)

# mysql - MySQL WHERE 1=2 仍然显示所有结果

> ID：14329694
> 
> 赞同：3
> 
> 时间：2013-01-15T01:19:37.017
> 
> 标签：mysql, sql, database

我正在运行一个查询，例如：

```
SELECT * FROM `view_meeting` WHERE 1=2 
```

它正在返回所有数据，我也使用 1=1 得到相同的结果。为什么是这样？

它与它是视图而不是表有关吗？

# python - Python中的重复排列

> ID：14329696
> 
> 赞同：6
> 
> 时间：2013-01-15T01:19:46.463
> 
> 标签：python, algorithm, permutation

我想遍历`n`大小为 1 的维度立方体的所有顶点。我知道我可以这样做`itertools.product`：

```
>>> n = 3
>>> for j in it.product((0,1), repeat=n) :
...     print j
... 
(0, 0, 0)
(0, 0, 1)
(0, 1, 0)
(0, 1, 1)
(1, 0, 0)
(1, 0, 1)
(1, 1, 0)
(1, 1, 1) 
```

但是我需要对每个顶点进行不同的处理，具体取决于`1`在其坐标中找到的 s 的数量，即`(0, 1, 1)`，`(1, 0, 1)`并且 `(1, 1, 0)`都会收到相同的处理，因为它们都有两个`1`s。而不是使用上面的迭代器，然后计算`1`s 的数量，我想生成按`1`s 数量排序的笛卡尔积，类似于：

```
>>> for ones in xrange(n) :
...     for seq in magic_expression(ones, n) :
...         print ones, seq
... 
0 (0, 0, 0)
1 (0, 0, 1)
1 (0, 1, 0)
1 (1, 0, 0)
2 (0, 1, 1)
2 (1, 0, 1)
2 (1, 1, 0)
3 (1, 1, 1) 
```

我的高中数学老师会称这些**为一次****取两个元素的排列，其中第一个元素重复多次，第二个`n``n - ones``ones`**元素重复，很容易证明它们存在`n! / ones! / (n - ones)!`。

根据[维基百科](http://en.wikipedia.org/wiki/Permutation#Generation_in_lexicographic_order)，我可以按字典顺序生成它们，如下所示：

```
def lexicographical(ones, n) :
    perm = [0] * (n - ones) + [1] * ones
    yield tuple(perm)
    while True :
        k = None
        for j in xrange(n - 1) :
            if perm[j] < perm[j + 1] :
                k = j
        if k is None :
            break
        l = k + 1
        for j in xrange(k + 2, n) :
            if perm[k] < perm[j] :
                l = j
        perm[k], perm[l] = perm[l], perm[k]
        perm[k+1:] = perm[-1:k:-1]
        yield tuple(perm) 
```

但是计时，这只会开始对计算 的完整笛卡尔积`n >= 10`，然后只计算`ones < 2`，这不是典型的用例。有没有一种优雅的方式来加速我上面的代码，也许是一些强大的`itertools`巫术，或者完全使用不同的算法？如果它有什么不同，我就不会关心产生的排列的顺序。还是我应该听天由命地数数？

* * *

***编辑***

我对提出的解决方案做了一些计时。按顺序消耗顶点会`itertools.product`生成它们，计数总是最快的。但是要让它们按个数排序，Eevee 的列表排序解决方案是最快的`n <= 6`，从那时起，Cam 的解决方案是两者中最快的。

我接受了 Cam 的解决方案，因为它更好地回答了所提出的问题。但就我将在我的代码中实现的内容而言，我将让自己接受计数。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-15T02:10:13.513

如果您编写了超过 8 行代码来生成 8 个常量值，那么就出现了问题。

除了嵌入我想要的列表之外，我会用愚蠢的方式来做：

```
vertices = (
    (v.count(1), v)
    for v in itertools.product((0, 1), repeat=3)
)
for count, vertex in sorted(vertices):
    print vertex 
```

除非您使用 1000 个超立方体，否则您不应该担心任何巨大的性能问题。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-15T02:37:36.900

一种（低效）替代方法：

```
>>> ['{0:03b}'.format(x) for x in range(8)]
['000', '001', '010', '011', '100', '101', '110', '111'] 
```

或作为元组：

```
>>> [tuple(int(j) for j in list('{0:03b}'.format(x))) for x in range(8)]

[(0, 0, 0),
 (0, 0, 1),
 (0, 1, 0),
 (0, 1, 1),
 (1, 0, 0),
 (1, 0, 1),
 (1, 1, 0),
 (1, 1, 1)] 
```

按顶点数排序：

```
>>> sorted(_, key=lambda x: sum(x))

[(0, 0, 0),
 (0, 0, 1),
 (0, 1, 0),
 (1, 0, 0),
 (0, 1, 1),
 (1, 0, 1),
 (1, 1, 0),
 (1, 1, 1)] 
```

* * *

或使用 itertools：

```
>>> sorted(itertools.product((0, 1), repeat=3), key=lambda x: sum(x))

[(0, 0, 0),
 (0, 0, 1),
 (0, 1, 0),
 (1, 0, 0),
 (0, 1, 1),
 (1, 0, 1),
 (1, 1, 0),
 (1, 1, 1)] 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-01-15T02:18:09.827

对于您的 3d 立方体用例，Eevee 的解决方案是正确的。

然而，为了好玩并展示 itertools 的强大功能，这里有一个线性时间解决方案，可以推广到更高的维度：

```
from itertools import combinations

# n is the number of dimensions of the cube (3 for a 3d cube)
def generate_vertices(n):
    for number_of_ones in xrange(0, n + 1):
        for location_of_ones in combinations(xrange(0, n), number_of_ones):
            result = [0] * n
            for location in location_of_ones:
                result[location] = 1
            yield result

for vertex in generate_vertices(3):
    print vertex

# result:
# [0, 0, 0]
# [1, 0, 0]
# [0, 1, 0]
# [0, 0, 1]
# [1, 1, 0]
# [1, 0, 1]
# [0, 1, 1]
# [1, 1, 1] 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-01-18T21:29:01.453

Following is some code that runs faster (for medium `n`) and several times faster (for large `n`) than that of Cam or Eevee. A time comparison follows.

```
def cornersjc (n):   # Re: jw code
    from itertools import product
    m = (n+1)/2
    k = n-m
    # produce list g of lists of tuples on k bits
    g = [[] for i in range(k+1)]
    for j in product((0,1), repeat=k):
        g[sum(j)].append(tuple(j))
    # produce list h of lists of tuples on m bits
    if k==m:
        h = g
    else:
        h = [[] for i in range(m+1)]
        for j in product((0,1), repeat=m):
            h[sum(j)].append(tuple(j))
    # Now deliver n-tuples in proper order
    for b in range(n+1):  # Deliver tuples with b bits set
        for lb in range(max(0, b-m), min(b+1,k+1)):
            for l in g[lb]:
                for r in h[b-lb]:
                    yield l+r 
```

The timing results shown below are from a series of `%timeit` calls in ipython. Each call was of a form like
`%timeit [x for x in cube1s.f(n)]`
with the names `cornersjc, cornerscc, cornersec, cornerses` in place of `f` (standing for my code, Cam's code, Eevee's code, and my version of Eevee's method) and a number in place of `n`.

```
n    cornersjc    cornerscc    cornersec    cornerses

5      40.3 us      45.1 us      36.4 us      25.2 us    
6      51.3 us      85.2 us      77.6 us      46.9 us    
7      87.8 us      163 us       156 us       88.4 us    
8     132 us       349 us       327 us       178 us    
9     250 us       701 us       688 us       376 us    
10    437 us      1.43 ms      1.45 ms       783 us
11    873 us      3 ms         3.26 ms      1.63 ms
12   1.87 ms      6.66 ms      8.34 ms      4.9 ms 
```

Code for `cornersjc` was given above. Code for `cornerscc`, `cornersec`, and `cornerses` is as follows. These produce the same output as `cornersjc`, except that Cam's code produces a list of lists instead of a list of tuples, and within each bit-count group produces in reverse.

```
def cornerscc(n):   # Re: Cam's code
    from itertools import combinations
    for number_of_ones in xrange(0, n + 1):
        for location_of_ones in combinations(xrange(0, n), number_of_ones):
            result = [0] * n
            for location in location_of_ones:
                result[location] = 1
            yield result

def cornersec (n):   # Re:  Eevee's code
    from itertools import product
    vertices = ((v.count(1), v)
                for v in product((0, 1), repeat=n))
    for count, vertex in sorted(vertices):
        yield vertex

def cornerses (n):   # jw mod. of Eevee's code
    from itertools import product
    for vertex in sorted(product((0, 1), repeat=n), key=sum):
        yield vertex 
```

Note, the last three lines of `cornersjc` can be replaced by

```
 for v in product(g[lb], h[b-lb]):
                yield v[0]+v[1] 
```

which is cleaner but slower. Note, if `yield v` is used instead of `yield v[0]+v[1]`, the code runs faster than `cornersjc` but (at `n=5`) produces pair-of-tuple results like ((1, 0), (1, 1, 0)); when `yield v[0]+v[1]` is used, the code runs slower than `cornersjc` but produces identical results, a list of tuples like (1, 0, 1, 1, 0). An example timing follows, with `cornersjp` being the modified `cornersjc`.

```
In [93]: for n in range(5,13):
    %timeit [x for x in cube1s.cornersjp(n)]
   ....:     
10000 loops, best of 3: 49.3 us per loop
10000 loops, best of 3: 64.9 us per loop
10000 loops, best of 3: 117 us per loop
10000 loops, best of 3: 178 us per loop
1000 loops, best of 3: 351 us per loop
1000 loops, best of 3: 606 us per loop
1000 loops, best of 3: 1.28 ms per loop
100 loops, best of 3: 2.74 ms per loop 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-01-15T01:53:03.990

根据你对顶点的处理来计算并不是一个坏主意，因为如果你必须遍历所有这些顶点，O(f(n)) 至少是 O(f(n)*2 **n)，对它们进行排序是 O(n*2** n)。所以它基本上取决于f（n）是否专业n。

除此之外，这里还有一个可能的魔术表达式：

```
def magic_expression(ones, n):
    a = (0,) * (n - ones) + (1,) * ones
    previous = tuple()
    for p in itertools.permutations(a):
        if p > previous:
            previous = p
            yield p 
```

[在具有唯一值的排列的](https://stackoverflow.com/questions/6284396/permutations-with-unique-values)帮助下。

这是有效的，因为 itertools.permutations 产生排序结果。请注意， a 最初是排序的，因为零在前。

# android - 使用 Tabhost 选择 Android 自定义 Listview 项目

> ID：14329698
> 
> 赞同：0
> 
> 时间：2013-01-15T01:19:58.450
> 
> 标签：android, android-listview, android-tabhost

我是 Andoid 的新手，还在学习。
我正在尝试在包含三个文件的 TabHost 内的自定义列表视图中选择一个项目。一个用于 Tabhost，一个用于标准列表视图，一个用于修改后的列表视图。
下面添加的代码正确显示。我只是无法弄清楚如何长按显示列表中的项目，以便我可以将其从列表中删除。

第一个活动

```
public class View_categories extends TabActivity {

  @Override
  public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.view_edit_cat);

    TabHost tabHost = getTabHost();
    tabHost.addTab(tabHost.newTabSpec("tab1").setIndicator("Category").setContent(new Intent(this, Category.class)));
    tabHost.addTab(tabHost.newTabSpec("tab2").setIndicator("Sub_Category").setContent(new Intent(this, Sub_category.class)));        
    tabHost.setCurrentTab(0); 

  }

} 
```

单独文件中的第二个活动。

```
public class Category extends ListActivity {

  List<String> cCategory;

  public void onCreate(Bundle savedInstanceState){
    super.onCreate(savedInstanceState);

    catList(); //Loads list
    setListAdapter(new ArrayAdapter<String>(this, R.layout.list_item,cCategory));

  }
} 
```

第三个文件中的第三个活动。

```
public class Sub_category extends ListActivity {

List<String> sSub_cat;
List<String> sCategory;

public void onCreate(Bundle savedInstanceState){        

    super.onCreate(savedInstanceState);     
    subList();      //loads list
    setListAdapter(new MyAdapter(this, android.R.layout.simple_list_item_1,R.id.textView1,sCategory));

}

private class MyAdapter extends ArrayAdapter<String>{

    public MyAdapter(Context context, int resource, int textViewResourceId,
            List<String> objects) {
        super(context, resource, textViewResourceId, objects);

    }
    @Override
    public View getView(int position, View convertView, ViewGroup parent) {

        LayoutInflater inflater = (LayoutInflater) getSystemService(Context.LAYOUT_INFLATER_SERVICE);
        View row = inflater.inflate(R.layout.sub_cat_list, parent, false);

        TextView cat_v = (TextView) row.findViewById(R.id.textView1);
        TextView sub_v = (TextView) row.findViewById(R.id.textView2);           
        cat_v.setText(sCategory.get(position));
        sub_v.setText(sSub_cat.get(position));  

        return row;
    }
}

} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-15T20:33:51.403

我需要在 setListAdapter() 之后添加以下代码
我最初将第一行放在 setListAdapter() 之前并且出现错误。

```
 ListView list = getListView();      
    list.setOnItemLongClickListener(new OnItemLongClickListener(){

        @Override
        public boolean onItemLongClick(AdapterView<?> arg0, View arg1,
                int arg2, long arg3) {
            Toast.makeText(Category.this, "test toast Cat", Toast.LENGTH_LONG).show();
            return false;
        }

    }); 
```

# php - 在mysql中分组或选择不同的列

> ID：14329699
> 
> 赞同：0
> 
> 时间：2013-01-15T01:20:15.807
> 
> 标签：php, mysql

我有一张这样的桌子

```
记录            
列A 列B 列C 列D
加里 2011 0 一个
加里 2011 0 b
加里 2010 年 1 个
2011 年 3 月 0 个
2010 年 3 月 1 日
2010 年 3 月 1 日
```

我想解析表格，如果我找到多行，其中 columnA columnB columnC 是共同的，以显示这三列中的值一次，然后显示在 columnD 上从每条记录中找到的值，其中这些列 ABC 相同。

像这样的东西

```
打印输出           
加里 2011 0 a,b
加里 2010 年 1 个
2011 年 3 月 0 个
2010 年 3 月 1 日 b,c
```

我正在使用 mysql，我尝试使用 distinct，但是当找到类似的 ABC 列时，它会重复打印。例如，而不是显示

```
加里 2011 0 a,b
```

一次，它将显示这条线两次，依此类推三、四次……对于找到的每条相似线……

谢谢你，莫兹利

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-15T01:27:46.417

您正在寻找`GROUP_CONCAT`：

```
SELECT columnA, columnB, columnC,
     GROUP_CONCAT(DISTINCT columnD
               ORDER BY columnD ASC SEPARATOR ', ') AS columnD
     FROM records
     GROUP BY columnA, columnB, columnC 
```

**结果**

```
| 专栏 | 专栏 | 专栏 | 栏目 |
-----------------------------------------
| 加里 | 2010 | 1 | 一个 |
| 加里 | 2011 | 0 | a, b |
| 玛丽 | 2010 | 1 | b, c |
| 玛丽 | 2011 | 0 | 一个 |
```

## [查看演示](http://sqlfiddle.com/#!2/9228d/3)

# objective-c - 我在 UICollectionViewCell 中的单元格自动取消选择或取消突出显示手指

> ID：14329701
> 
> 赞同：1
> 
> 时间：2013-01-15T01:20:40.753
> 
> 标签：objective-c, ipad, uicollectionview, uicollectionviewcell

我有一个 UICollectionView，在手指向上（或鼠标向上）时，单元格取消选择/取消突出显示。我可以看到它们在手指向下时突出显示（实际上是长手指向下，因为它在 uiscrollview 内），但是一旦你放手，它们就会被取消突出显示。

而且（当我确实有一个委托集时），没有调用 didSelectItemAtIndexPath。

有什么建议么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-15T03:36:48.580

事实证明，在一个超级视图上有一个点击手势识别器，它贪婪地吞噬了所有的点击手势。

# java - Hibernate 3 / JPA：返回 ClassCastException 的简单选择查询

> ID：14329703
> 
> 赞同：0
> 
> 时间：2013-01-15T01:20:45.373
> 
> 标签：java, hibernate, jpa

我在 Java 6 上使用 Hibernate 3 / JPA。我试图从数据库（已填充）中获取一个简单的行。

创建了以下 JPA 注释域对象：

```
@Entity
@Table(name = "person", catalog = "mydatabase", uniqueConstraints = {
        @UniqueConstraint(columnNames = "person_name") })
public class Person {
    private Integer id;

    private String personName;

    @Id
    @GeneratedValue(strategy = IDENTITY)
    @Column(name = "id", unique = true, nullable = false)
    public Integer getId() {
        return id;
    }

    @Column(name = "person_name", unique = true, nullable = false, length = 30)
    public String getPersonName() {
        return personName;
    }

    public void setPersonName(String personName) {
        this.person = person;
    }
} 
```

我的 hibernate.cfg.xml 文件：

```
<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE hibernate-configuration PUBLIC
"-//Hibernate/Hibernate Configuration DTD 3.0//EN"
"http://hibernate.sourceforge.net/hibernate-configuration-3.0.dtd">
<hibernate-configuration>
    <session-factory>
        <property name="hibernate.bytecode.use_reflection_optimizer">false</property>
        <property name="hibernate.connection.driver_class">com.mysql.jdbc.Driver</property>
        <property name="hibernate.connection.url">jdbc:mysql://localhost:3306/mydatabase</property>
        <property name="hibernate.connection.username">root</property>
        <property name="hibernate.connection.password"></property>
        <property name="hibernate.dialect">org.hibernate.dialect.MySQLDialect</property>
        <property name="show_sql">true</property>
        <property name="current_session_context_class">thread</property>
        <mapping class="com.myapp.domain.Person"></mapping>
    </session-factory>
</hibernate-configuration> 
```

调用类的代码片段：

```
session = HibernateUtil.getSessionFactory().getCurrentSession();
session.beginTransaction();
org.hibernate.Query query = session.createQuery("SELECT p FROM Person p");
List<Person> persons = query.getResultList(); 
```

当我运行调用类时，这是我得到的异常：

```
java.lang.ClassCastException: org.hibernate.impl.QueryImpl cannot be cast to javax.persistence.Query
    at com.myapp.PersonApp(PersonApp.java:15) 
```

发生此 ClassCastException 的第 15 行是：

```
org.hibernate.Query query = session.createQuery("SELECT p FROM Person p"); 
```

这是我的依赖项：

```
 <dependency>
        <groupId>mysql</groupId>
        <artifactId>mysql-connector-java</artifactId>
        <version>5.0.8</version>
    </dependency>

    <dependency>
        <groupId>org.codehaus.mojo</groupId>
        <artifactId>hibernate3-maven-plugin</artifactId>
        <version>3.0</version>
    </dependency>

    <dependency>
        <groupId>org.hibernate</groupId>
        <artifactId>hibernate-annotations</artifactId>
        <version>3.5.6-Final</version>
    </dependency>

    <dependency>
        <groupId>org.hibernate</groupId>
        <artifactId>hibernate-commons-annotations</artifactId>
        <version>3.2.0.Final</version>
    </dependency>

    <dependency>
        <groupId>javax.transaction</groupId>
        <artifactId>jta</artifactId>
        <version>1.1</version>
    </dependency>

    <dependency>
        <groupId>org.eclipse.persistence</groupId>
        <artifactId>javax.persistence</artifactId>
        <version>2.0.0</version>
        <scope>provided</scope>
    </dependency> 
```

我可能做错了什么？我只想针对人员表调用一个简单的选择查询。

感谢您抽出时间来阅读。

# node.js - 如何修改服务器相对url作为响应

> ID：14329706
> 
> 赞同：2
> 
> 时间：2013-01-15T01:20:57.693
> 
> 标签：node.js, response

我使用 http.request 一个 URL 并将响应放入 Nodejs 中的新响应。但是http请求的响应里面有一些服务器相关的url，用于链接、资源等。

如何使相对 url 成为完整的 url，然后我可以在 nodejs 响应中显示整个内容。谢谢。

# apache - 挣扎于 Apache .htaccess RewriteRule

> ID：14329708
> 
> 赞同：0
> 
> 时间：2013-01-15T01:21:01.550
> 
> 标签：apache, .htaccess, mod-rewrite

我目前正在 Wordpress 中重做我的网站之一。在我测试时，此安装当前位于 wwww.mydomain.com/wordpress 中。

在我的主站点上，请求是这样的： [http ://www.mydomain.com/index/newsid/16589/some-text-here-that-is-irrelevant](http://www.mydomain.com/index/newsid/16589/some-text-here-that-is-irrelevant)

[http://www.mydomain.com/.htaccess](http://www.mydomain.com/.htaccess)上的 .htaccess当前如下所示：

```
Options +FollowSymLinks
RewriteEngine on
RewriteBase /
RewriteRule index/newsid/(.*) index.php?newsid=$1
RewriteEngine On 
```

我的 Wordpress .htaccess 目前位于 www.mydomain.com/wordpress/.htaccess 如下

```
# BEGIN WordPress
<IfModule mod_rewrite.c>
RewriteEngine On
RewriteBase /wordpress/
RewriteRule ^index\.php$ - [L]
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule . /wordpress/index.php [L]
</IfModule>

# END WordPress 
```

当我迁移我的站点时，来自其他站点的所有链接都将中断，我已将所有文章合并到论坛中的存档中。我需要有效地做两件事，让我的 .htaccess 在我的网站根目录上运行，然后在移动它并将任何新闻请求重定向到其他地方。

本质上我想把这个： [http ://www.mydomain.com/index/newsid/16589/some-text-here-that-is-irrelevant](http://www.mydomain.com/index/newsid/16589/some-text-here-that-is-irrelevant)

进入： [http ://www.mydomain.com/forums/index.php?showtopic=16589](http://www.mydomain.com/forums/index.php?showtopic=16589)

他们这里的主要 id 是 16589，它是一个变量并且可以改变。

任何帮助将不胜感激，我可以做简单的 .htaccess 文件，但这超出了我的范围。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-15T04:20:51.203

将wordpress 安装移动到文档根目录后，您需要在 wordpress规则*之前*添加一些规则。您需要在文档根目录的 htaccess 文件中执行以下操作：

```
Options +FollowSymLinks
RewriteEngine on

# redirect your newsid
RewriteRule ^index/newsid/([0-9]+)/ /forums/index.php?showtopic=$1 [L,QSA,R]

# here are the wordpress rules

# BEGIN WordPress
<IfModule mod_rewrite.c>
RewriteEngine On
RewriteBase /
RewriteRule ^index\.php$ - [L]
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule . /index.php [L]
</IfModule>

# END WordPress 
```

如果您想要 301 重定向，请将 替换`[L,QSA,R]`为`[L,QSA,R=301]`.

# multithreading - epoll 问题：隧道和多线程

> ID：14329713
> 
> 赞同：-1
> 
> 时间：2013-01-15T01:21:30.147
> 
> 标签：multithreading, tcp, epoll

我在尝试在两个线程之间进行 TCP 隧道时遇到了这个问题。

```
Thread 1
  listen at Port
  accept
  then add the sock after accept to epoll_ctl
  while (1)
    epoll_wait
    read whatever from Port to remote (tunnelling)

Thread 2
  connect to Port
  if connected 
    communicate... 
```

我实际观察到的是：虽然线程 2 在连接时被阻塞，但线程 1 没有机会运行 epoll_wait 并将连接信息发送到远程。因此，两个线程都无法取得进展。

一种可能的解决方案是使用父子进程而不是多线程。但是在我切换到那个之前，它仍然可以用多线程来完成吗？我认为这里需要的是某种中断，而不仅仅是轮询。正确的？

谢谢你的洞察力。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-15T01:28:09.713

您可以将服务器端套接字描述符添加到 epoll_ctl。但是我很好奇如果thread2在连接上被阻塞，你需要向服务器发送什么信息？谢谢你的提示。

# ruby - 分布式校验和生成

> ID：14329715
> 
> 赞同：1
> 
> 时间：2013-01-15T01:21:38.600
> 
> 标签：ruby, redis, md5

我有一个通过 HTTP 运行并获取文件块（通常为 10MB）并将它们作为块存储在远程文件系统上的服务。这些块的组合将构成一个完整的文件。

我想从块中生成一些关于文件的元数据。具体来说，我想生成文件的总文件大小和 MD5 校验和。

最终文件可能相对较大（500+ MBytes）。有没有办法以分布式方式迭代生成校验和？例如，假设我有两个 Web 服务器在负载平衡器后面运行此服务，该负载平衡器在两个服务器之间分配请求。是否可以使用共享 Redis 服务器等动态生成完整文件的 MD5 校验和？

我试图避免在磁盘上本地缓存块或在完全上传后查询远程数据存储以获取实际文件内容。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-15T06:30:45.337

您可以使用[Merkle Tree](http://en.wikipedia.org/wiki/Merkle_tree)来做到这一点，[例如 Cassandra](http://wiki.apache.org/cassandra/AntiEntropy)。

引用亚马逊的 Dynamo 第 4.7 节，

> 为了更快地检测副本之间的不一致并最大限度地减少传输的数据量，Dynamo 使用了 Merkle 树。Merkle 树是一个哈希树，其中叶子是单个键值的哈希值。树中较高的父节点是它们各自子节点的哈希值。Merkle 树的主要优点是可以独立检查树的每个分支，而不需要节点下载整个 [...] 数据集。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-15T19:49:35.977

发现了这个小宝石。它允许您使用数据库累积计算 MD5 和。

[https://github.com/jarl-dk/digest_extensions](https://github.com/jarl-dk/digest_extensions)

# python - 什么样的模型字段用于 Django 中的二维数组？

> ID：14329721
> 
> 赞同：2
> 
> 时间：2013-01-15T01:22:38.023
> 
> 标签：python, django

我是 Django 的新手，我正在尝试创建一个 Battleship 游戏。我想为我的战舰板创建一个模型，它将是 10 行和 10 列，每个点的坐标为 [x,y]。我不确定要使用哪个模型字段。到目前为止，这是我的 Board 类的代码：

```
class Board(models.Model):
    ships_left = models.IntegerField()
    available_spots = models.???  #This is to contain [x,y] coordinates of open spots 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-15T02:45:12.253

您可能需要考虑将板表示为一个或多个[NumPy](http://www.numpy.org/)二维数组。例如，您可以使用布尔二维数组来跟踪玩家已经开火的坐标，并使用整数数组来表示各种船只的位置，方法是为每种船只类型指定一个唯一的整数值（例如，0 表示公海, 1 代表驱逐舰，2 代表航母，等等）。这将使查找攻击是否被击中以及攻击的船只类型变得非常容易。

将数组序列化到数据库中需要一些工作；我先看看[这篇文章](http://www.michaelgrosner.com/blog/2011/8/9-django-and-numpy.html)；它将向您展示要考虑覆盖哪些模型方法。在评论中，建议仅将 cPickle 与[django-picklefield](http://pypi.python.org/pypi/django-picklefield/)一起使用，为简单起见，这是我首先尝试的路线。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-15T01:37:26.150

一种可能性是创建一个`Coordinate`类，并表示每个可能的坐标对：

```
class Coordinate(models.Model):
    x = models.IntegerField()
    y = models.IntegerField()
    board = models.ForeignKey(Board)
    hit = models.BooleanField(default=False)
    ship = models.ForeignKey(Ship, null=True)  # assumes you have Ship objects somewhere 
```

您可以按如下方式点击一个位置（假设`board`是一个`Board`对象）：

```
x = 2
y = 3
location = board.coordinate_set.filter(x=x, y=y)
if location.ship != None:
    # hit a ship! Do something with location.ship object
# either way, save that it was hit
location.hit = True
location.save() 
```

这对于大型网格来说效率不高，但在这种情况下，每个板只有 100 个坐标，因此它可能是合理且直观的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-15T02:18:38.593

如果是一对一的关系，我只需将坐标拆分为 2 个字段：

```
class Board(models.Model):
    ships_left = models.IntegerField()
    x = models.IntegerField()
    y = models.IntegerField() 
```

问题解决了。我认为不需要构建另一个模型并将其与外键链接。使事情复杂化并导致再次加入，这是真正的成本。

# javascript - 英镑符号之间的Javascript正则表达式匹配

> ID：14329724
> 
> 赞同：0
> 
> 时间：2013-01-15T01:22:41.790
> 
> 标签：javascript, regex

快的。我有一个字符串：`#user 9#I'm alive!`我想拔出“用户 9”。

到目前为止我在做：

```
 if(variable.match(/\#/g)){
            console.log(variable):
    } 
```

但输出仍然是完整的线。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-15T01:25:34.133

使用`.split()`, 以取出您想要的物品。

```
var variable = variable.split("#");
console.log(variable[1]); 
```

`.split()`将你的字符串变成一个数组，第一个变量作为分隔符。

当然，如果你只想要正则表达式，你可以这样做：

```
console.log(variable.match(/([^#]+)/g)); 
```

这将再次为您提供一个项目数组，但一个较小的项目，因为它不使用散列之前的空值作为项目。此外，正如@Stephen P 所说，您将需要使用捕获组（`()`）来捕获您想要的项目。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-15T01:28:07.877

沿着这些思路尝试更多的东西......

```
var thetext="#user 9#I'm alive!";
thetext.match(/\#([^#]+)\#/g); 
```

您想引入一个*捕获组*（括号中的部分）来收集井号之间的文本。

您可能想要使用`.exec()`而不是`.match()`取决于您在做什么。另请参阅SO 问题的[答案](https://stackoverflow.com/a/432503)*“您如何在 javascript 正则表达式中访问匹配的组？”*

# ios - Xcode 4.5：无法在 Interface Builder 中设置根视图 autoresizingMask

> ID：14329726
> 
> 赞同：3
> 
> 时间：2013-01-15T01:22:48.440
> 
> 标签：ios, uiview, interface-builder, autoresizingmask

我对它似乎是 Xcode 4.5 中的错误感到非常困惑。我无法在 Interface Builder 中设置新创建的 UIViewController 的根视图的 autoresizingMask 属性。这些是重现问题的步骤：

*   创建一个新的故事板
*   在文件检查器中取消选中使用自动布局
*   选择默认场景的根视图
*   转到尺寸检查器
*   Autosizing 对话框中的弹簧呈虚线、灰色且无法单击（支柱工作正常）。

如果我删除现有视图并从对象库中拖动一个新视图，则新视图将启用 autosizingMask（并且无法禁用）。

这在我正在处理的 2 个项目中发生了两次，但在新创建的项目中没有发生。我错过了什么吗？什么可以触发这种行为？

这是测试故事板的 XML。第一个 ViewController`storyboardIdentifier="springsWorking"`是我编辑删除原始视图的那个，第二个`storyboardIdentifier="default"`是默认的。

```
<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<document type="com.apple.InterfaceBuilder3.CocoaTouch.Storyboard.XIB" version="2.0" toolsVersion="2844" systemVersion="12C60" targetRuntime="iOS.CocoaTouch.iPad" propertyAccessControl="none" initialViewController="KEy-1l-Qqy">
<dependencies>
    <plugIn identifier="com.apple.InterfaceBuilder.IBCocoaTouchPlugin" version="1930"/>
</dependencies>
<scenes>
    <!--View Controller-->
    <scene sceneID="dwh-DZ-gCp">
        <objects>
            <viewController storyboardIdentifier="springsWorking" id="KEy-1l-Qqy" sceneMemberID="viewController">
                <view key="view" contentMode="scaleToFill" id="ngZ-jh-RR4">
                    <rect key="frame" x="0.0" y="20" width="768" height="1004"/>
                    <autoresizingMask key="autoresizingMask" widthSizable="YES" heightSizable="YES"/>
                    <color key="backgroundColor" white="1" alpha="1" colorSpace="custom" customColorSpace="calibratedWhite"/>
                </view>
            </viewController>
            <placeholder placeholderIdentifier="IBFirstResponder" id="jow-h4-M4B" userLabel="First Responder" sceneMemberID="firstResponder"/>
        </objects>
        <point key="canvasLocation" x="-428" y="-327"/>
    </scene>
    <!--View Controller-->
    <scene sceneID="445-Ak-YxL">
        <objects>
            <viewController storyboardIdentifier="default" id="ZA8-km-Ecn" sceneMemberID="viewController">
                <view key="view" contentMode="scaleToFill" id="lRF-Uf-5lh">
                    <rect key="frame" x="0.0" y="20" width="768" height="1004"/>
                    <autoresizingMask key="autoresizingMask" flexibleMaxX="YES" flexibleMaxY="YES"/>
                    <color key="backgroundColor" white="1" alpha="1" colorSpace="custom" customColorSpace="calibratedWhite"/>
                </view>
            </viewController>
            <placeholder placeholderIdentifier="IBFirstResponder" id="fZf-TK-JQE" userLabel="First Responder" sceneMemberID="firstResponder"/>
        </objects>
        <point key="canvasLocation" x="760" y="-313"/>
    </scene>
</scenes>
<simulatedMetricsContainer key="defaultSimulatedMetrics">
    <simulatedStatusBarMetrics key="statusBar" statusBarStyle="blackTranslucent"/>
    <simulatedOrientationMetrics key="orientation"/>
    <simulatedScreenMetrics key="destination"/>
</simulatedMetricsContainer> 
```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-01-15T01:27:30.890

在“属性检查器”（右侧面板；图标看起来像一个滑块）中，在“模拟指标”下打开“大小”弹出窗口并选择“自由形式”。这将解锁这些控件。（否则，它会将大小与全屏匹配，因为它认为这就是您想要的。）

# javascript - Brunch.io 构建工具是否应该复制隐藏文件？

> ID：14329729
> 
> 赞同：0
> 
> 时间：2013-01-15T01:23:06.693
> 
> 标签：javascript, build, build-process, brunch

我已经开始使用早午餐：

[http://brunch.io](http://brunch.io)

构建我的基于 javascript 的应用程序。我正在使用 Backbone.js，它需要一个 .htaccess 文件才能使用 HTML5 pushState 处理路由。

我的问题：Brunch 是否应该复制所谓的“隐藏”文件，例如 .htaccess？因为无论我尝试什么，我似乎都无法让它复制 .htaccess 文件作为构建过程的一部分。

我在 app/assets/ 文件夹中有该文件，据我所知，它应该直接复制到 public/ 中。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-15T23:59:44.203

默认情况下，brunch 不会复制任何以`.`or开头的文件`#`，所以答案是否定的，您必须手动将其移动到那里。

我正在寻找在下一个版本中使这个可配置的。

# algorithm - 将相同字符串组合在一起的最佳算法是什么？

> ID：14329730
> 
> 赞同：0
> 
> 时间：2013-01-15T01:23:14.077
> 
> 标签：algorithm

每个排序算法都将是工作，但它是一个过度杀伤。

对于像这样的输入：

```
aa
cc
aa
bb
dd
bb
cc 
```

我只需要类似的东西：

```
aa
aa
cc
cc
bb
bb
dd 
```

每个模式的顺序不是必需的。

这种工作有这样的算法吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-15T01:31:22.463

您只想在这里使用[哈希表](http://en.wikipedia.org/wiki/Hashtable)，或者更抽象地说是[关联数组](http://en.wikipedia.org/wiki/Associative_array)。遍历输入，如果尚未看到它，则将其添加到值为*1的哈希表（标记，如果您愿意），或者如果它已经存在于哈希表中，则将计数加一。*

因此，该算法在时间和空间上都是*O(n)*，这与您合理预期的一样好。我建议阅读一下哈希表，因为它是一种非常有用的数据结构，出现在算法和软件设计的各个地方。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-15T01:25:12.727

好吧，在我的脑海中，你可以运行一个计算每个元素存在多少的通道，然后创建一个新数组，并按顺序发布它们。那将是 O(n) 但不是“就地”。

因此：

```
// Make outputArrayCounter
// While inputArray has elements left:
//   if current element is new, add to outputArrayCounter
//   if current element has been seen before, increment a counter associated with that 
//   element.
// Part 2...
// Make outputArray
// create the appropriate number of elements as found in the outputArrayCounter for
// every different element type. 
```

让我们尝试一个例子：

我们有一个原始输入`aa bb aa cc cc dd cc`。

我们将制作我们的计数器设备，并扫描输入。 `aa`，第一个元素被读取，因为我们以前从未遇到`aa`过，我们将把它添加到我们的计数器设备中。

计数器装置：`[(aa, 1)]`

现在让我们继续阅读下一个输入，`bb`. 它也没有找到并被添加：

计数器装置：`[(aa, 1), (bb, 1)]`

再一步并`aa`作为第三个元素阅读。这可以在我们的设备中找到，因此我们没有再次添加它，而是将关联的计数器增加`aa`1。

计数器装置：`[(aa, 2), (bb, 1)]`

我将继续为您提供终端计数器设备状态：

`[(aa, 2), (bb, 1), (cc, 3), (dd, 1)]`

现在我们遍历设备并多次打印出每个元素的数量，并将每个同名元素*放在*一起。（如果顺序很重要，这是一个实现细节，它将确定是使用关联的集合字典，还是使用某种存储顺序的双数组设备。这是特定于语言的，但我相信你可以弄清楚。如果你不能，在这里发表评论，我将描述一个解决方案。）

`print aa aa bb cc cc cc dd`

# geolocation - 显示距离用户纬度和经度 1 公里半径的最近地点

> ID：14329735
> 
> 赞同：2
> 
> 时间：2013-01-15T01:23:57.693
> 
> 标签：geolocation, latitude-longitude

我最近表示正在研究 gps 地图。我有一个包含纬度和经度列表的数据库。当用户访问我的网络应用程序时，我想显示距离用户点 1 公里或指定半径范围内的地点。我尝试使用 mysql 查询

SELECT * FROM Locations
WHERE（MINLATITUDE 和 MAXLATITUDE 之间的纬度）
和（MINLONGITUDE 和 MAXLONGITUDE 之间的经度）

但它显示最小和最大之间的纬度和经度，有人可以告诉我如何显示距离用户点仅在 1 公里半径内的纬度和经度。
谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-15T10:41:41.103

对于 1 公里左右的距离，Haversine 太过分了。使用更简单的 equirectangular 投影来熟悉 x 和 y。请记住，lat 和 lon 下面的公式是以弧度表示的。距离 d 以 km 为单位，因为地球的半径 (R) 以 km 为单位。纬度/经度以弧度表示（是的，我再说一遍）。与 Haversine 相比，这消除了几个触发函数，这将使您的查询更快。

```
var R = 6371; // radius of the earth in km
var x = (lon2-lon1) * Math.cos((lat1+lat2)/2);
var y = (lat2-lat1);
var d = Math.sqrt(x*x + y*y) * R;  // distance in km 
```

现在，这是一个网络应用程序，所以我将假设圣诞老人（北极）和南极洲站的人们不会使用您的应用程序。有了这个假设，您可以在数据库中按经度组织纬度/经度点。因此，如果某人的 lon 为 -76.1，您就知道数据库中小于 -78 度的经度超过 1 公里。您还知道大于 -74 度的经度也很远。这将减少您需要在数据库中检查的点数。

# php - str_replace 干扰

> ID：14329737
> 
> 赞同：3
> 
> 时间：2013-01-15T01:24:17.457
> 
> 标签：php

我正在尝试使用 . 将两个字母的语言缩写转换为完整的单词`str_replace`。我遇到的问题是它们在回显时会相互影响。

```
$lang = str_replace("en", "English", $lang); 
$lang = str_replace("es", "Spanish", $lang);
$lang = str_replace("pt", "Portuguese", $lang); 
$lang = str_replace("fr", "French", $lang);
$lang = str_replace("de", "German", $lang);
$lang = str_replace("it", "Italian", $lang);
$lang = str_replace("pl", "Polish", $lang);
$lang = str_replace("ru", "Russian", $lang);
$lang = str_replace("sv", "Spanish (El Salvador)", $lang);
$lang = str_replace("ko", "Korean", $lang);
$lang = str_replace("zh", "Chinese", $lang);
$lang = str_replace("nl", "Dutch", $lang); 
```

一个例子：当我回显时`en`，我得到`EnglIcelandich`.

上面的列表更大，但这只是一个例子。我曾尝试重命名变量，但没有运气。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-15T01:32:30.493

这很简单！改为使用[`strtr`](http://www.php.net/strtr)。

```
<?php
$replace = array(
    "en" => "English",
    "es" => "Spanish",
    "pt" => "Portuguese",
    "fr" => "French",
    "de" => "German",
    "it" => "Italian",
    "pl" => "Polish",
    "ru" => "Russian",
    "sv" => "Spanish (El Salvador)",
    "ko" => "Korean",
    "zh" => "Chinese",
    "nl" => "Dutch"
);

echo strtr("en it sv\n", $replace); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-15T01:28:02.263

您可以使用以下命令一次完成所有操作`preg_replace_callback`：

```
$map = array(
    'en' => 'English',
    ...
);

$lang = preg_replace_callback('/' . implode('|', array_keys($map)) . '/', function($match) use ($map) {
    return $map[$match[0]];
}, $lang); 
```

哦，如果您的任何字符串中有任何特殊字符，您需要映射`preg_quote`到数组的键并将分隔符作为第二个参数传递。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-15T01:33:32.977

如果`$lang`将始终是两个字符串，则根本不需要搜索/替换，只需使用如下查找表：

```
$languages = array(
    'en'=>'English' 
    'es'=>'Spanish'
    'pt'=>'Portuguese' 
    'fr'=>'French'
    'de'=>'German'
    'it'=>'Italian'
    'pl'=>'Polish'
    'ru'=>'Russian'
    'sv'=>'Spanish (El Salvador)'
    'ko'=>'Korean'
    'zh'=>'Chinese'
    'nl'=>'Dutch'   
);
$lang = $languages[strtolower($lang)]; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-15T01:30:08.087

除非您期望像`ensppt`原始值这样的东西，否则只需使用模仿的查找表：

```
$lang_lookup = array(
  'en' => 'English',
  'es' => 'Spanish',
  'pt' => 'Portuguese',
  // ...
);
$lang = array_key_exists($lang, $lang_lookup) ? $lang_lookup[$lang] : 'Unknown'; 
```

或者（但速度较慢）您可以将一个字符串复制到另一个：

```
$lang_lookup = array(
  'en'=>'English',
  'es'=>'Spanish',
  'pt'=>'Portuguese', 
  'fr'=>'French',
  'de'=>'German',
  'it'=>'Italian',
  'pl'=>'Polish',
  'ru'=>'Russian',
  'sv'=>'Spanish (El Salvador)',
  'ko'=>'Korean',
  'zh'=>'Chinese',
  'nl'=>'Dutch'   
);
$lang = 'es stands for Spanish';

$output = '';
for ($i = 0; $i < strlen($lang); $i++){
  $l = substr($lang, $i, 2);
  if (array_key_exists($l, $lang_lookup)){
    $output .= $lang_lookup[$l];
    $i++;
  } else {
    $output .= $lang[$i];
  }
}
echo $output; // "Spanish stands for Spanish" 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-01-15T01:30:25.880

如果只支持在字符串中出现一次，那么只需检查哪个首先存在。使用数组作为查找表。

```
$languages = array(
    'en'=>'English' 
    'es'=>'Spanish'
    'pt'=>'Portuguese' 
    'fr'=>'French'
    'de'=>'German'
    'it'=>'Italian'
    'pl'=>'Polish'
    'ru'=>'Russian'
    'sv'=>'Spanish (El Salvador)'
    'ko'=>'Korean'
    'zh'=>'Chinese'
    'nl'=>'Dutch'   
);

foreach($languages as $key=>$value)
{
    if(strpos($lang,$key) !== false)
    {
        $lang = str_replace($key,$value,$lang);
        break;
    }
} 
```

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2013-09-12T13:12:35.400

```
$entries = array(
    "en" => "English",
    "es" => "Spanish",
    "pt" => "Portuguese",
    "fr" => "French",
    "de" => "German",
    "it" => "Italian",
    "pl" => "Polish",
    "ru" => "Russian",
    "sv" => "Spanish (El Salvador)",
    "ko" => "Korean",
    "zh" => "Chinese",
    "nl" => "Dutch"
); 
```

使用 str_replace：

```
for ( $i = 0 ;  $i < $entries['count']; $i++ ) {
    foreach($entries[$i] as $key => $entrie) {
        if ( is_string($key) ) {
        $result = str_replace('{'.$key.'}', $entrie[0], $result);
        }
    }

    $contact_data[] = $result;
} 
```

# xml-parsing - pugixml 子节点数

> ID：14329738
> 
> 赞同：14
> 
> 时间：2013-01-15T01:24:57.100
> 
> 标签：xml-parsing, count, size, pugixml

pugixml 节点对象是否有 number-of-child-nodes 方法？我在文档中找不到它，不得不使用如下迭代器：

```
int n = 0;
for (pugi::xml_node ch_node = xMainNode.child("name"); ch_node; ch_node = ch_node.next_sibling("name")) n++; 
```

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2013-01-15T05:26:01.360

没有内置函数可以直接计算；另一种方法是使用`std::distance`：

```
size_t n = std::distance(xMainNode.children("name").begin(), xMainNode.children("name").end()); 
```

当然，这在子节点的数量上是线性的；请注意，计算所有子节点的数量`std::distance(xMainNode.begin(), xMainNode.end())`也是线性的 - 没有对子节点计数的恒定时间访问。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-28T19:09:49.260

您可以使用基于 xpath 搜索的表达式（但不能保证效率）：

```
xMainNode.select_nodes( "name" ).size() 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2020-08-29T21:30:52.270

```
int children_count(pugi::xml_node node)
{
  int n = 0;
  for (pugi::xml_node child : node.children()) n++;
  return n;
} 
```

# python - Python 在使用 Psycopg2 的 cursor.execute() 期间挂起

> ID：14329749
> 
> 赞同：5
> 
> 时间：2013-01-15T01:25:56.487
> 
> 标签：python, postgresql, execute, database-cursor

我目前的 Python 脚本存在问题，当我从 cursor.execute() 为特定函数执行 SQL 函数时，它运行该函数，函数完成，然后脚本挂起近五个小时，然后恢复其余部分的程序。

我在 pgAdminIII 中观察我的函数的服务器状态，因为它是从 Python 调用的，当函数完成时，服务器只显示与我的 python 用户的打开连接。之前它会在事务中空闲，但在添加 conn.set_isolation_level(0) 之后，它只显示打开的连接。

我还在 cursor.execute() 周围放置了打印，但需要五个小时才能继续执行以下打印语句。我尝试终止连接并重新启动它无济于事。我完全从我的脚本中剥离了函数调用，所以它是我的脚本处理的唯一过程。没有任何效果。

困难在于双方都一直指向对方是问题的根源。我假设这是这个特定功能的某种交互效果。运行特定功能后，也许没有从 postgres 将信号发送回 python？其他功能都没有与相同的执行方法有关的问题。

想法？解决方案？-我正在考虑超时，但运行时间可以从 20 分钟到 2 小时不等。- 它运行的函数创建一个表并仅返回一个说明“完成”的字符串，所有操作在它作为服务器状态下的活动函数消失后都在数据库中进行说明。

这是我用于复制问题的代码，与我的主脚本隔离：

```
#!/usr/bin/env python

import sys
import os
import smtplib
import ftplib
import gzip
import logging
import shutil
import argparse
import traceback
import subprocess
from email.mime.text import MIMEText

import psycopg2
import psycopg2.extras
import psycopg2.extensions
from psycopg2 import OperationalError

pg_db    = "ppl"
pg_port  = "5432"
pg_user  = "<user>"
pg_pass  = "<pass>"
pg_host  = "<host>"

# connect to database
try:
    conn = psycopg2.connect(database=pg_db,
                            port=pg_port, 
                            user=pg_user, 
                            password=pg_pass, 
                            host=pg_host)
    conn.set_isolation_level(0)
except:
    print "Unable to connect to the database."

cur = conn.cursor()

print 'Starting select <function1>'
cur.execute("select <function1>(999999, null );")
print 'Assign variable...'
a = cur.fetchall()
print 'Done'

print 'Starting select <function2>'
cur.execute("select <function2>(999999, null );")
print 'Assign variable...'
b = cur.fetchall()
print 'Done'

print a
print b

conn.close()
sys.exit() 
```

然后我按照这些结果的建议运行了一个 strace：

```
<previous function statements for about 4k lines>

write(1, "Starting select <function>"..., 45) = 45
sendto(3, "Q\0\0\0009select <function>"..., 58, MSG_NOSIGNAL, NULL, 0) = 58
poll([{fd=3, events=POLLIN|POLLERR}], 1, -1) = 1 ([{fd=3, revents=POLLIN}])
recvfrom(3, "T\0\0\0001\0\1<function_name>\0"..., 16384, 0, NULL, NULL) = 500
poll([{fd=3, events=POLLIN|POLLERR}], 1, -1) = 1 ([{fd=3, revents=POLLIN}])
recvfrom(3, "N\0\0\0mSINFO\0C00000\0Mv_eval_table "..., 16384, 0, NULL, NULL) = 110
poll([{fd=3, events=POLLIN|POLLERR}], 1, -1) = 1 ([{fd=3, revents=POLLIN}])
recvfrom(3, "N\0\0\4\247SINFO\0C00000\0Mcmd := CREATE"..., 16384, 0, NULL, NULL) = 1192
poll([{fd=3, events=POLLIN|POLLERR}], 1, -1) = 1 ([{fd=3, revents=POLLIN}])
recvfrom(3, "N\0\0\23hSINFO\0C00000\0Mcmd := \t--For"..., 16384, 0, NULL, NULL) = 4969
poll([{fd=3, events=POLLIN|POLLERR}], 1, -1) = 1 ([{fd=3, revents=POLLIN}])
recvfrom(3, "N\0\0\0SSINFO\0C00000\0Mlicense_row_i"..., 16384, 0, NULL, NULL) = 84
poll([{fd=3, events=POLLIN|POLLERR}], 1, -1) = 1 ([{fd=3, revents=POLLIN}])
recvfrom(3, "N\0\0\0SSINFO\0C00000\0Mlicense_row_i"..., 16384, 0, NULL, NULL) = 672
...
brk(0xbe9000)                           = 0xbe9000
poll([{fd=3, events=POLLIN|POLLERR}], 1, -1) = 1 ([{fd=3, revents=POLLIN}])
recvfrom(3, "N\0\0\0SSINFO\0C00000\0Mlicense_row_i"..., 16384, 0, NULL, NULL) = 84
poll([{fd=3, events=POLLIN|POLLERR}], 1, -1) = 1 ([{fd=3, revents=POLLIN}])
recvfrom(3, "N\0\0\0SSINFO\0C00000\0Mlicense_row_i"..., 16384, 0, NULL, NULL) = 168
poll([{fd=3, events=POLLIN|POLLERR}], 1, -1) = 1 ([{fd=3, revents=POLLIN}])
recvfrom(3, "N\0\0\0SSINFO\0C00000\0Mlicense_row_i"..., 16384, 0, NULL, NULL) = 1008
...

<does this for about 600k more lines before executing the rest of the script, I am assuming it is indefinitely looping until a timeout> 
```

接下来，我为一个函数运行了一个 cProfile，该函数包装了调用第二个函数的第二个代码块：

```
Tue Jan 15 16:04:50 2013    function2_prof

         7 function calls in 15755.988 CPU seconds

   Random listing order was used

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    0.000    0.000 {method 'cursor' of 'psycopg2._psycopg.connection' objects}
        1    0.000    0.000 15755.988 15755.988 test_sql_sub2.py:48(LR2)
        1 15755.988 15755.988 15755.988 15755.988 {method 'execute' of 'psycopg2._psycopg.cursor' objects}
        1    0.000    0.000 15755.988 15755.988 <string>:1(<module>)
        1    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}
        1    0.000    0.000    0.000    0.000 {method 'close' of 'psycopg2._psycopg.cursor' objects}
        1    0.000    0.000    0.000    0.000 {method 'fetchall' of 'psycopg2._psycopg.cursor' objects} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-16T01:26:12.837

我认为您的功能比您意识到的要多。看看你的 strace：

```
brk(0xbe9000)                           = 0xbe9000
poll([{fd=3, events=POLLIN|POLLERR}], 1, -1) = 1 ([{fd=3, revents=POLLIN}])
recvfrom(3, "N\0\0\0SSINFO\0C00000\0Mlicense_row_i"..., 16384, 0, NULL, NULL) = 84
poll([{fd=3, events=POLLIN|POLLERR}], 1, -1) = 1 ([{fd=3, revents=POLLIN}])
recvfrom(3, "N\0\0\0SSINFO\0C00000\0Mlicense_row_i"..., 16384, 0, NULL, NULL) = 168
poll([{fd=3, events=POLLIN|POLLERR}], 1, -1) = 1 ([{fd=3, revents=POLLIN}])
recvfrom(3, "N\0\0\0SSINFO\0C00000\0Mlicense_row_i"..., 16384, 0, NULL, NULL) = 1008 
```

`brk`意思是“给我更多的内存”，所以很明显 Python 正在积累数据。 `poll`检查是否有数据等待；正返回值（此处为`1`）表示存在。并`recvfrom`读取该数据并返回读取的字节数。

所以看起来 Postgres 正在向您发送*大量*数据，以至于需要花费大量时间来接收。我对 Postgres 的有线格式知之甚少，但`license_row_i...`在每次民意调查中，听起来你肯定会得到大量的行。该函数不再显示为正在执行，因为它*不是*；工作已经完成，Postgres 现在只是将结果发回。

难怪双方都指责对方。问题在中间。:)

* * *

编辑：啊哈，更多信息暗示`RAISE INFO`。Psycopg2 确实将所有这些通知存储[在连接对象上](http://initd.org/psycopg/docs/connection.html#connection.notices)。

它只保留最后 50 个，但如果您向客户端发送**超过 50 万**条通知，则需要一段时间才能继续将它们转换为 Python 字符串，丢弃最旧的，附加最新的等等。如果命令-line 客户端完全忽略它们（甚至只是在 C 中完成这一切），它自然会快得多。

所以简单的解决方案是“不要那样做”。:) 您也可以[将 Postgres 配置为不将这些发送到客户端](http://www.postgresql.org/docs/9.2/static/runtime-config-logging.html#GUC-CLIENT-MIN-MESSAGES)，但当然它们最终对调试毫无用处。我可以看到，没有办法要求 psycopg2 不收集发送给客户的通知。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-16T21:04:06.743

问题是由于 SQL 函数中的多个 for 循环中的一行：

```
raise info 'license_row_id := %', rec.license_row_id; 
```

这些引发信息消息在某种程度上没有被 python 适当地处理，因为它们被 bash 和 pgAdmin 处理。我的猜测是，因为它们没有被处理，所以它们不断循环和处理并要求更多内存，直到它无法处理，最后在没有警告或错误的情况下丢弃引发信息并恢复程序。

我注释掉了这个不必要的 raise 信息行，整个脚本在 20 分钟内运行，这是程序的正常运行时间。如果有人知道如何让 python 处理来自 postgresql 的引发信息消息，这可能会进一步回答这个问题。

# javascript - 无论我做什么，Javascript 函数都不会执行

> ID：14329751
> 
> 赞同：0
> 
> 时间：2013-01-15T01:26:15.503
> 
> 标签：javascript, execute, visible

```
<script type="text/javascript">
function appearbox(){
document.getElementById('hotelparoikia').style.display = 'block';
document.getElementById('desc1').style.display = 'block';
document.getElementById('desc2').style.display = 'block';
document.getElementById('typeofroom').style.display = 'block';
}
</script> 
```

如您所见，以上是我的 HTML 文件中的 javascript 代码。

```
<form>
<table>
<tr><th>Επιλέξτε Περιοχή</th><th style="display:none;" id="desc1">Επιλέξτε ξενοδοχειακό συγκρότημα</th><th style="display:none;" id="desc2">Επιλέξτε τύπο δωματίου</th></tr>
<tr><td align="center">
<select id="hotelarea" onFocus="appearbox">
<option value="0" selected="selected" onFocus="appearbox" >ΠΑΡΟΙΚΙΑ</option>
<option value="1" onFocus="appearbox" >ΝΑΟΥΣΑ</option>
<option value="2" onFocus="appearbox" >ΧΡΥΣΗ ΑΚΤΗ</option>
<option value="3" onFocus="appearbox" >ΠΙΣΩ ΛΙΒΑΔΙ</option>
<option value="4" onFocus="appearbox" >ΑΛΙΚΗ</option>
</select>
</td>
<td align="center">
<select style="display:none;" id="hotelparoikia">
<option value="0" selected="selected">PAROS BAY HOTEL</option>
<option value="1">MARISA ROOMS</option>
<option value="2">AROKARIA BEACH</option>
<option value="3">REPPAS APARTMENTS</option>
<option value="4">VASSILIKI ROOMS</option>
</select>
</td>
<td align="center">
<select style="display:none;" id="typeofroom">
<option value="0" selected="selected">ΜΟΝΟΚΛΙΝΟ</option>
<option value="1">ΔΙΚΛΙΝΟ</option>
<option value="2">ΤΡΙΚΛΙΝΟ</option>
<option value="3">ΤΕΤΡΑΚΛΙΝΟ</option>
</select>
</td>
</tr>
</table>
</form> 
```

这是我的 HTML 文件中代码的另一部分

如您所见，当 DropDownList 为 OnFocus 时，appearbox() 应该运行并使某些元素可见，但它不会运行。谁能帮我？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-15T02:25:52.500

你错过了（）

这里有很多关于使用 jQuery、分离 js 逻辑等的其他建议，这些在概念上可能都是好主意。但据我所知，您的 html 的真正问题就在这里->

```
<select id="hotelarea" onFocus="appearbox"> 
```

它需要->

```
<select id="hotelarea" onFocus="appearbox()"> 
```

因为出现框只是一个函数引用。这`()`就是本质上说的“运行引用指向的任何函数”。

除此之外，如果您确保您的`<script>`标签位于头部（或将在表单之前加载的任何其他位置），它应该可以正常工作。

如果仍然无法正常工作，请在浏览器中打开开发者控制台（可能是 F12）并检查控制台以查看在选择框焦点时是否有错误。我将您的代码几乎完全放在 .html 文件中（我将脚本标记放在 head 中，将 form 标记放在 body 中，我还将 () 添加到您的 onFocus 侦听器中。否则它是一个复制粘贴作业）并且它可以工作，据我所知，问题是以下之一：

*   失踪的（）
*   创建 onFocus 侦听器时尚未加载脚本标记，您将收到未定义的错误
*   您页面上的其他一些东西正在做一些时髦的事情，例如覆盖定义`appearbox`或其他东西 - 不太可能，但是，如果您从 html 文件中粘贴整个页面（或提供 jsfiddle 链接），那么您的回答者会好得多有能力提供帮助。

哦，这是关于它可能是什么的另一个想法（纯属猜测，因为我看不到您页面的其余部分）。表单是否在页面上出现多次？或者，出于任何其他原因，页面上是否还有其他元素具有相同的 ID？如果是这样，getElementById() 将无法返回元素；ID 必须是页面唯一的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-15T01:42:41.917

The code below works for me just fine:

```
<select id="hotelarea" onFocus="javascript:appearbox();"> 
```

You don't need onFocus events in the option tags, just one inside the select tag is fine.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-15T01:28:09.877

```
onFocus="javascript:appearbox()" 
```

但老实说，开始使用 jQuery。从 html 中删除所有 onFocus 并将您的 js 替换为：

```
$(document).ready(function() {
  $("#hotelarea").focus(function() {
    $("#hotelparoikia").css("display", "block"); // or just .show()
    ...        
  });
}); 
```

* * *

## 回答 #4

> 赞同：-2
> 
> 时间：2014-05-01T09:59:54.967

这很简单。

```
appearbox
// just a reference to the function

appearbox()
// call the function (with no arguments) 
```

所以：

```
onFocus="appearbox();" 
```

会工作得很好。

# 3d - 如何将围绕 3D 轴的旋转表示为围绕固定轴的旋转以及旋转的角度是多少

> ID：14329753
> 
> 赞同：0
> 
> 时间：2013-01-15T01:26:28.720
> 
> 标签：3d, rotation

我想知道 3D 旋转的方程来自哪里？（http://en.wikipedia.org/wiki/Rotation_matrix）。如果我想先围绕 x 轴旋转一个点以获得 thetax 度数，然后围绕 y 轴旋转以获得 thetay 度数，最后围绕 z 轴旋转以获得 thetaz 度数，我想问：如何定义 ux、uy 和 uz在上面的等式中？

以及如何计算方程中的 theta？

谢谢阅读

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-15T17:28:23.593

三角函数，2x2 矩阵只是 2 个二维向量。对于更高维度，您需要 3x3 或仿射 4x4 矩阵。见图片：

![二维旋转矩阵](../Images/6555d94c3a2ddcd4d5310ca93c69b1de.png)

对于这些只是矩阵的组合，将矩阵按您需要的顺序或相反的顺序相乘（顺序取决于您有列向量或行向量）。在这种特殊情况下，它们是行主矩阵，因此乘法是相反的顺序。

# html - 现场动态调整固定菜单的大小

> ID：14329755
> 
> 赞同：0
> 
> 时间：2013-01-15T01:27:01.000
> 
> 标签：html, css

这里的目标是让二级固定风味菜单随主要内容动态调整大小。

该站点的大小最大为 1086 像素，宽度最小为 960 像素。

二级菜单需要调整相同的大小。我已经尝试了多种方法，但还没有探索 JS 解决方案。我不知道我什至会在这一点上开始。

这是网站：

[https://devtest.eboost.com/](https://devtest.eboost.com/)

我目前将菜单设置为 960px 宽度并居中。

谢谢，

乔治

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-15T02:01:57.807

只需将链接的宽度设置为 width: 20%; 这应该将 5 分成 20% 或任何您设置的包装器。

```
 a {
          display: block;
          float: left;
          width: 20%;
        } 
```

还要查看边界框以处理我预计您接下来会遇到的填充问题。

# mysql - 我需要在这条 SQL 指令中添加什么来过滤某些项目？

> ID：14329757
> 
> 赞同：0
> 
> 时间：2013-01-15T01:27:12.870
> 
> 标签：mysql, sql

我想要的是过滤（不获取）出现在这个新表中的报价，我们像黑名单一样使用它（即，对于域 X，我们不想要来自 Y 的报价）。

```
TABLE:      black_list_deals

COLUMNS: id 
         domain_id (we save here an id from the table "domain")
         origin_offer (we save here a value from deal, the field deal_source_id) 
```

到目前为止，我一直在使用此指令，但现在我需要添加新行为以根据黑名单表进行过滤以过滤这些优惠。

```
SELECT
    a.lat,
    a.lon,
    a.id,
    a.image,
    a.link,
    a.deal_source_id,
    a.date_posted,
    a.date_expires,
    a.tags_external,
    a.tags_internal,
    a.gender,
    a.price,
    a.discount,
    a.areas,
    a.hits,
    a.bias,
    a.collection_type,
    a.uniqueness,
    a.date_posted = current_date AS today,
    DATEDIFF( a.date_expires, current_date) AS days_remaining,
    a.collection_type,
    b.id AS area_id,
    b.area,
    a.image_thumb,
    c.source_img_email,
    c.source_price,
    c.source_img_sm,
    c.source_name,
    c.frame,
    a.date_posted = current_date AS today,
    d.country,
    d.region,
    e.level1,
    e.level2,
    e.level3,
    e.level4

FROM deal a
      LEFT JOIN area b ON (a.areas = b.id)
      LEFT JOIN deal_source c ON (a.deal_source_id = c.id)
      LEFT JOIN deal_travel d ON (a.id = d.deal_id)
      LEFT JOIN deal_travel_country e ON (d.country = e.id)
WHERE
      a.validated = 'y' AND
      a.date_posted = current_date AND
      a.date_expires >= current_date AND
      email_deal = '1' 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-15T01:32:43.567

添加`WHERE a.deal_source_id NOT IN (SELECT origin_offer FROM black_list_deals)`到您的 WHERE 子句应该可以解决这个问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-15T01:46:21.803

我会补充

```
SELECT
   ...
FROM deal a
...
   LEFT JOIN black_list_deals bld ON (bld.origin_offer = a.deal_source_id)
...
WHERE
...
   AND bld.id IS NULL 
```

基本上，您将仅返回未找到黑名单条目的数据

# jquery - JQuery - 使用动态图像作为单选按钮等

> ID：14329758
> 
> 赞同：0
> 
> 时间：2013-01-15T01:27:16.907
> 
> 标签：jquery, image, input, radio

我对 JS 知之甚少，必须完成以下任务：

*   我们使用第三方模块，它在 magento 选项中启用图像。我无法修改以下的html结构，只能通过jquery。
*   我们要隐藏 RADIO BUTTON 并使用缩略图作为按钮
*   选择后，图像将获得不同的样式（不知道到底是什么，可能是边框）
*   此外，输入的名称（即 SPAN 中）应该出现在某处 - 图像上方。
*   将图像并排放置的样式是 CSS 的小菜一碟。问题出在 Jquery 上。此外，工具提示还可以。

我们想要的样子：http://www.inusual.com.br/chaise-anelideos.html 今天的样子：http://www.inusual.com.br/namoradeira-francesca.html[他们](http://www.inusual.com.br/namoradeira-francesca.html)的 行为不同，因为他们是不同的模块。

嗯，HTML 代码基本上是这样的：

```
<ul class="options-list">
  <li>
    <a class="img-radio">
      <img class="small-image-preview" src="#"/>
    </a>
    <input class="radio required-dependent" type="radio" value="somevalue" onclick="dependentOptions.select(this);opConfig.reloadPrice();">
    <span class="label">
      <label for="xxx">Option Name</label>
    </span>                                 
  </li>
  <li>
    <a class="img-radio">
      <img class="small-image-preview" src="#"/>
    </a>
    <input class="radio required-dependent" type="radio" value="somevalue" onclick="dependentOptions.select(this);opConfig.reloadPrice();">
      <span class="label">
    <label for="xxx">Option Name</label>
    </span>                                 
  </li>
</ul> 
```

我正在尝试的 jQuery 部分是这样的：

```
jQuery(window).load(function()
{
  jQuery('li a.img-radio').click( function(){
  jQuery('li a.img-radio.selected').removeClass('selected');
  jQuery(this).addClass('selected');
  jQuery(this).find('input:radio').attr('checked','checked');
});
}) 
```

关于如何使这项工作的任何提示？非常感谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-15T01:35:24.057

您不能这样做`jQuery(this).find('input:radio')`，但可以将其替换为：

```
jQuery(this).find('input[type=radio]') 
```

如果您想将收音机设置为选中，`attr('checked' , 'checked')`可能会起作用，但我更喜欢这个：

```
jQuery(this).find('input[type=radio]').checked = true; 
```

# java - 针对接口工作的 JSON 库

> ID：14329760
> 
> 赞同：0
> 
> 时间：2013-01-15T01:27:31.730
> 
> 标签：java, json

有谁知道一个 Java JSON 解析器，它适用于 Java 接口并生成实现（在运行时）。类似于[gwtquery](http://code.google.com/p/gwtquery/wiki/DataBinding)中数据绑定的工作方式，但对于服务器端？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-15T02:44:02.527

GWT AutoBeans 是一种选择。它们可以在客户端和服务器上使用。

[http://code.google.com/p/google-web-toolkit/wiki/AutoBean](http://code.google.com/p/google-web-toolkit/wiki/AutoBean)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-15T02:48:40.157

Jackson 的[MrBean](http://wiki.fasterxml.com/JacksonFeatureMaterializedBeans)扩展是我用过的唯一一个。只需向您的 ObjectMapper 注册 MrBean 模块，Jackson 遇到的任何接口或抽象类都将由 MrBean 自动实现（如果您想为此创建异常，接口或抽象类上的任何注释都将优先）。

编辑：更详细的[文章](http://www.cowtowncoder.com/blog/archives/2011/08/entry_459.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-15T03:49:45.030

谷歌 GSON 可能是另一种选择。它支持自定义序列化和反序列化，因此您可以为所欲为：

[http://code.google.com/p/google-gson/](http://code.google.com/p/google-gson/)

# c# - 是否可以通过 C# 中的昵称从 Google Apps 发送电子邮件

> ID：14329761
> 
> 赞同：0
> 
> 时间：2013-01-15T01:27:40.853
> 
> 标签：c#, google-apps

我有一个标准的 Google Apps 帐户，他们为我托管我的电子邮件..

目前我可以用 C# 代码发送电子邮件，但它们总是来自我的主要电子邮件地址。我设置了几个昵称...在 Gmail 界面中，它可能如下所述：[Google Apps - 从昵称发送电子邮件](https://stackoverflow.com/questions/4587016/google-apps-send-email-from-a-nickname)

但我想从代码中做到这一点..所以我可以发送电子邮件为“info@”或“support@”......我有一个名为“EmailFrom”的appSetting被定义为“info@”......

```
MailMessage mm = new MailMessage(ConfigurationManager.AppSettings["EmailFrom"], ToAddress);

//'(2) Assign the MailMessage's properties
mm.Subject = Subject;
mm.Body = MessageBody;
mm.IsBodyHtml = true;

//'(3) Create the SmtpClient object
SmtpClient smtp = new SmtpClient();

smtp.Port = System.Convert.ToInt32(ConfigurationManager.AppSettings["smtpPort"]);
smtp.EnableSsl = true;

smtp.Send(mm); 
```

那可能吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-15T01:40:00.417

Ok..

Figured it out...

It would seem that I needed to add the email address in the gmail interface... Select the Settings menu, and choose Accounts.... then select "Add another email address you own".. I just went through the verification process adding in the nickname I wanted to send from..

Easy..

# android - 无法启动 Youtube API 示例 Demo，需要 YouTube 应用

> ID：14329763
> 
> 赞同：0
> 
> 时间：2013-01-15T01:27:51.813
> 
> 标签：android, api, youtube

我成功地让 Youtube API 演示从 Eclipse 启动。但是，当我尝试启动演示时，它指出：“如果没有 YouTube 应用程序，此应用程序将无法运行，而您的设备中缺少该应用程序。”

我正在运行 android 模拟器，因此默认情况下它不附带 youtube 应用程序。

有没有人遇到过这个问题，你做了什么来纠正它？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-22T20:48:07.610

您需要安装了 Youtube 应用程序的物理设备来运行 YouTubeAPIDemoActivity。

# java - intellij 插件开发书

> ID：14329771
> 
> 赞同：10
> 
> 时间：2013-01-15T01:28:26.550
> 
> 标签：java, plugins, intellij-idea

我想为intellij开发一个插件，但是我发现这方面的资源很少，而且没有关于它的书，所以有人知道这个资源或书吗？非常感谢你

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-01-15T01:32:24.117

此页面应该可以帮助您：

[http://www.jetbrains.com/idea/features/open_api_plugin_manager.html](http://www.jetbrains.com/idea/features/open_api_plugin_manager.html)

本质上，您需要学习 Open API，这并不难，您可以访问一些现有的插件示例，了解其他人是如何做事的。一些带源码的插件：

*   [https://github.com/kinabalu/mysticpaste/tree/master/idea-plugin](https://github.com/kinabalu/mysticpaste/tree/master/idea-plugin)
*   [http://blogs.jetbrains.com/idea/2012/10/check-out-more-than-200-open-source-plugins/](http://blogs.jetbrains.com/idea/2012/10/check-out-more-than-200-open-source-plugins/)（这里有很多插件示例代码）

# javascript - 使用 Javascript Cookie 验证隐藏/取消隐藏广告横幅

> ID：14329775
> 
> 赞同：0
> 
> 时间：2013-01-15T01:29:17.293
> 
> 标签：javascript, flash, cookies, actionscript

我正在尝试在我的网站上实现类似的东西：[http://code.google.com/p/iab-billboard-adunit/](http://code.google.com/p/iab-billboard-adunit/) ......

它的演示在这里：http: [//johnpaulkelly.me/iab/js_nobrand/index.html](http://johnpaulkelly.me/iab/js_nobranded/index.html)

我的主要问题是我想将广告制作成图片而不是 Flash 文件。将 .jpg 插入广告所在的位置（在 Javascript 本身中）很容易，但是一旦这样做，我就会丢失作为动作脚本功能的一部分的“关闭广告”按钮。

有人可以帮助我，或者建议将“关闭广告”功能附加到 HTML 元素而不是让它成为动作脚本的一部分的最佳方法吗？（并且不会中断 cookie 的生成）

这很容易吗？一般来说，我是 Javascript 的新手，但是一旦我指出正确的方向，我可能会弄明白——我似乎无法用最简单的方法来做这件事......

如果它更容易，我不需要在设置 cookie 后保留“显示广告”按钮，如果它使它更简单......

（再一次，也许这不是做这样的事情的最好方法——所以如果有人有另一种方法来处理类似的功能......我完全愿意尝试）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-15T02:31:15.803

如果您只是想添加隐藏广告链接，请通过使用您自己的图像 url 更改第二行，在函数 loadBanner() 中添加您的图像和链接。您还需要一些 CSS 来设置关闭文本的样式。

刚刚注意到这段代码将在 iframe 内。它需要像这样调用父级的关闭函数。

Javascript：

```
window.frames["banner"].document.write('<a href="#" id="closeAd" onclick="window.parent.document.getElementById('adUnit').style.display = 'none';">CLOSE AD <b>X</b></a>'); 
```

CSS：这需要在 iframe 代码中

```
#closeAd {
    position: absolute;
    right: 0;
    color: white;
    text-decoration: none;
    padding: 2px;
    line-height: 1em;
} 
```

# jquery - Uncaught SyntaxError: Unexpected token < jQuery .load()

> ID：14329776
> 
> 赞同：0
> 
> 时间：2013-01-15T01:29:20.607
> 
> 标签：jquery, ajax

我被难住了。我有一个用服务器端 Javascript 编写的处理页面，它使用我们系统中的一些数据构建一个 HTML 表。

我通过 jQuery .load() 函数调用页面。调用有效并返回了数据，但是发生了一些事情，引发了下面的错误副本。这也会停止我在 .load() 之后进行的任何调用。

你可以在这里看到页面

```
http://pages.email.tofw.com/page.aspx?QS=38dfbe491fab00eadb06a33c6c7834943533ebb484a35c6efcab45c78cd9df38#

I have tried .load(), .post(), .ajax()... 
```

一个注意事项是，当我提醒响应时，我注意到我们的后端系统似乎正在放置一些对其他 js 文件的引用。见下文，这对我来说看起来不错。

我还应该提到，

在所有浏览器中都会发生这种情况，响应只是 HTML（+ 那些 js 行）格式正确 chrome 报告了 jQuery 的第 564 行中的错误，这是一些称为 noop 的函数

任何直升机都值得赞赏，我不能再花一整天的时间试图自己解决这个问题。

提前致谢

**JS 被我们的系统添加到响应中**

```
<script type="text/javascript" src="http://pages.email.tofw.com/Script/HttpRequest.js">        </script>
<script type="text/javascript" src="http://pages.email.tofw.com/Script/pageTracking.js">               </script>
<script type="text/javascript">
    absoluteBaseUrl = "http://pages.email.tofw.com/";
SaveAnalyticData(7000926, 'd7ba6684-ae81-48dd-bac7-969595eb9846', '92401e11-8737-4d03-a458-be89ca0cbecf'); 
</script> 
```

**Chrome 报告的错误**

```
Uncaught SyntaxError: Unexpected token < jquery-1.8.3.js:564
(anonymous function) jquery-1.8.3.js:564
jQuery.extend.globalEval jquery-1.8.3.js:565
jQuery.ajaxSetup.converters.text script jquery-1.8.3.js:8258
ajaxConvert jquery-1.8.3.js:8143
done jquery-1.8.3.js:7779
callback jquery-1.8.3.js:8518
send jquery-1.8.3.js:8524
jQuery.extend.ajax jquery-1.8.3.js:7986
(anonymous function) jquery-1.8.3.js:6007
jQuery.extend.each jquery-1.8.3.js:611
jQuery.fn.extend.domManip jquery-1.8.3.js:6004
jQuery.fn.extend.append jquery-1.8.3.js:5777
(anonymous function) jquery-1.8.3.js:5904
jQuery.extend.access jquery-1.8.3.js:814
jQuery.fn.extend.html jquery-1.8.3.js:5868
(anonymous function) jquery-1.8.3.js:7474
fire jquery-1.8.3.js:974
self.fireWith jquery-1.8.3.js:1084
done jquery-1.8.3.js:7803
callback 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-15T15:16:54.337

谢谢或输入，但我发现了问题。事实证明，其中一个引用的 js 文件引发了一个错误，该错误显示了一个包含完整 html 文档的错误页面。所以我的回复包含 html 标签，我猜这让 jQuery 感到不安

我如何修复它是将我的预期结果包装在一个具有已知名称的 div 中，然后使用 load 函数传递该 div 以仅给我该 div 的内容。

工作完美。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-15T01:33:46.700

看起来您在**第二个脚本标记中缺少****> 。**

 **```
<script type="text/javascript"
       src="http://pages.email.tofw.com/Script/pageTracking.js" > </script>
                                              Missing this ---- ^ 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-15T01:33:38.297

问题似乎在这里

```
<script type="text/javascript" 
   src="http://pages.email.tofw.com/Script/pageTracking.js"            
</script> 
```

请注意，您错过了关闭脚本开始标签

这是您修复的脚本参考

```
<script type="text/javascript" 
   src="http://pages.email.tofw.com/Script/pageTracking.js">            
</script> 
```**

# javascript - 查找/替换 Texareas 内部所见即所得

> ID：14329784
> 
> 赞同：1
> 
> 时间：2013-01-15T01:30:11.907
> 
> 标签：javascript, jquery, replace, tinymce, wysiwyg

我相信查找/替换文本的问题是当所见即所得的介入时。但是，我相信有人已经想出了如何施展魔法。

这是文本区域，没有附加编辑器：

```
<textarea id="template1" style="width:400px; height:200px;">
<div>Dear {{companyname}},</div>
<div>A new Support Case has been opened for you.</div>
<div>Support Case description:</div>
.........more html text follows
</textarea>

<script language="javascript" type="text/javascript">
$(document).ready(function(){

   var str = $("#template1").val();
   var newstr = str.replace("{{companyname}}", "ACME Inc");
   $("#template1").val(newstr);

}); 
</script> 
```

没有编辑，我很高兴。一旦我应用我选择的编辑器 (TinyMCE)，replace() 方法就会被忽略。

有谁知道为什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-15T03:52:52.697

如果您在您最喜欢的页面检查器（firebug、dev tools、dragonfly 等）中查看由 tinymce 生成的实际 Html，您会发现您实际上正在编辑启用 contentEditable 的 iframe。据我所知，它将使用 textarea/input 来设置初始内容，并在您将表单发布回服务器时执行其他某种巫术来将其设置回来。

如果您想手动执行此操作，可以使用以下方法：

[http://www.tinymce.com/wiki.php/API3:method.tinymce.Editor.getContent](http://www.tinymce.com/wiki.php/API3:method.tinymce.Editor.getContent)

[http://www.tinymce.com/wiki.php/API3:method.tinymce.Editor.setContent](http://www.tinymce.com/wiki.php/API3:method.tinymce.Editor.setContent)

您可以通过这些进行文本处理。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-15T09:17:12.140

您的替换功能不起作用有两个原因。

**1.**之前的 textarea 的内容被替换了，但是你看不到结果，因为 tinymce 隐藏了 textarea 并使用 contenteditable iframe 来加载和设置之前的内容。编辑器内容被写回文本区域 onSave 和 onSubmit

**2.** `$(document).ready`您页面的所有资源都已加载，但tinymce编辑器尚未准备好。

这将导致如何替换tinymce编辑器中的代码的问题。`$(document).ready`在这里帮不上忙。您将需要使用 tinymce 配置参数[onInit](http://www.tinymce.com/wiki.php/API3%3aevent.tinymce.Editor.onInit)

```
// Adds an observer to the onInit event using tinyMCE.init

tinyMCE.init({
   ...
   setup : function(ed) {
      ed.onInit.add(function(ed) {
          //console.debug('Editor is done: ' + ed.id);

          // replace the editor content
          var str = ed.getContent();
          var newstr = str.replace("{{companyname}}", "ACME Inc");
          ed.setContent(newstr);
      });
   }
}); 
```

# sql - 在 EXISTS 中，我的 JOIN ON 可以使用原始选择中的值吗

> ID：14329789
> 
> 赞同：0
> 
> 时间：2013-01-15T01:30:51.000
> 
> 标签：sql, advantage-database-server

我有一个订单系统。用户可以作为不同用户的一种类型附加到不同的订单。他们可以下载与订单相关的文档。文档仅提供给订单上的某些类型的用户。我在编写查询以检查用户查看文档的权限并选择有关文档的信息时遇到问题。

我有以下表格和（适用的）字段：

```
Docs: DocNo, FileNo
DocAccess: DocNo, UserTypeWithAccess
FileUsers: FileNo, UserType, UserNo 
```

我有以下查询：

```
SELECT Docs.* 
FROM Docs
WHERE DocNo = 1000
  AND EXISTS (
         SELECT * FROM DocAccess
         LEFT JOIN FileUsers
           ON FileUsers.UserType = DocAccess.UserTypeWithAccess 
           AND FileUsers.FileNo = Docs.FileNo /* Errors here */
         WHERE DocAccess.UserNo = 2000 ) 
```

问题是在 Exists Select 中，它不能将 Docs（位于 Docs.FileNo）识别为有效表。如果我将第二个 on 参数移到 where 子句，它会起作用，但我宁愿限制初始连接，而不是事后将它们过滤掉。

我可以通过几种方式解决这个问题，但这似乎是最好的。我在这里缺少什么吗？还是根本不允许？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-15T02:05:40.410

我认为这是您的数据库引擎的限制。在大多数数据库中，`docs`将在整个子查询的范围内——包括`where`and`in`子句。

但是，您不必担心将特定子句放在哪里。SQL 是一种*描述性*语言，而不是一种过程语言。SQL 的目的是描述输出。SQL 引擎、解析器和编译器应该选择最佳的执行路径。并非总是如此。但是，将条件移到`where`子句中，不要担心。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-15T01:59:11.193

我不清楚为什么您需要在子查询中加入 FileUsers？查询的目的和想法是什么（用简单的英语）？

无论如何，如果您确实需要加入 FileUsers，那么我建议使用内部连接并将第二个过滤器移动到 WHERE 条件。我认为您不能在子查询的 JOIN 条件中使用它——至少我以前从未见过它以这种方式使用过。我相信您只能通过 WHERE 子句进行关联。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-15T12:13:36.697

您必须使用别名才能使其正常工作：

```
SELECT
  doc.* 
FROM 
  Docs doc
WHERE 
      doc.DocNo = 1000
  AND EXISTS (
SELECT 
  * 
FROM 
  DocAccess acc
LEFT OUTER JOIN 
  FileUsers usr
ON 
      usr.UserType = acc.UserTypeWithAccess 
  AND usr.FileNo   = doc.FileNo
WHERE 
  acc.UserNo = 2000
) 
```

这也使得每个字段属于哪个表更加清晰（考虑在具有不同别名的同一查询中使用同一个表两次或多次）。

如果您只想将输出限制为一行，您可以使用`TOP 1`：

```
SELECT TOP 1
  doc.* 
FROM 
  Docs doc
INNER JOIN
  FileUsers usr
ON  
  usr.FileNo = doc.FileNo
INNER JOIN
  DocAccess acc
ON
  acc.UserTypeWithAccess = usr.UserType
WHERE 
      doc.DocNo  = 1000
  AND acc.UserNo = 2000 
```

当然，第二个查询与第一个查询有点不同（两个 JOINS 都是 INNER）。根据您的数据模型，您甚至可能会忽略该`TOP 1`查询。

# vb.net - 如何设置“始终由该程序打开”

> ID：14329790
> 
> 赞同：1
> 
> 时间：2013-01-15T01:30:58.390
> 
> 标签：vb.net

我希望我的程序询问用户“你想设置 .mp3 文件类型始终默认由该程序打开吗？” （仅限第一次）有什么例子可以做到这一点？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-15T01:50:28.863

首先，您需要熟悉 Windows 注册表。

程序和扩展之间的关联在 HKEY_CLASSES_ROOT 键内处理。每个扩展都显示为一个子键。

作为每个键的默认值，您将找到处理该特定文件类型当前支持的大多数操作的关联键。

例如，如果您已安装 VLC 并将其配置为默认 MP3 播放器，您可能会发现 .mp3 的默认值设置为“WMP11.AssocFile.MP3”或者可能设置为“VLC.mp3”。因此，现在您需要再次在 HKEY_CLASSES_ROOT 中找到该密钥。

尽管这可能会有所不同，但您应该会发现“VLC.mp3”（或与 .mp3 扩展名关联的任何键）有一个名为“shell”的子键。在“shell”下，您会发现另一个名为“Open”的子键。最后，在“打开”下，您将看到另一个名为“命令”的子键。

“Command”键是包含 Windows（和其他程序）用来打开/启动当前与“.mp3”（或任何其他）扩展名关联的任何应用程序的信息的键。

一旦您了解并熟悉在注册表中处理关联的方式，您就应该使用 .NET 的`Microsoft.Win32`Registry 类来导航和查询所需的键及其值。

这是代码外观的非常基本的说明：

```
Dim mp3 = Registry.ClassesRoot.OpenSubKey(".mp3")
Dim associatedValue = mp3.GetValue("")
Dim associatedKey = Registry.ClassesRoot.OpenSubKey(associatedValue)
Dim defaultProgram = associatedKey.OpenSubKey("Shell\Open\Command").GetValue("")

MsgBox("MP3 Files Are Opened Using: " + vbCrLf + defaultProgram) 
```

希望这可以帮助...

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-15T01:40:01.833

您需要设置文件关联。[有关在 VB.NET](http://www.codeproject.com/Articles/18594/File-Association-in-VB-NET)中设置文件关联的代码项目，请参阅这篇文章。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-10-06T12:23:55.883

导入并声明后再次出现错误

```
Dim rgText As Registry.ClassesRoot.OpenSubKey(".txt") 
```

错误如下所示：

> 未定义类型“Registry.ClassesRoot.OpenSubKey”。

# python - 获取Python中整数所需的字节大小

> ID：14329794
> 
> 赞同：23
> 
> 时间：2013-01-15T01:31:38.770
> 
> 标签：python, integer, numbers, byte, size

如何找出某个整数占用的存储字节数？

例如对于

*   十六进制`\x00`- `\xff`（或十进制`0`- `255`= 二进制`0000 0000`- `1111 1111`）我希望得到 1（字节），
*   十六进制`\x100`- `\xffff`（或十进制`256`- `65535`= 二进制`0000 0001 0000 0000`- `1111 1111 1111 1111`）会给我 2（字节）

等等。

十六进制或十进制格式作为输入的任何线索？

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2013-01-15T01:38:37.967

除非您正在处理 an`array.array`或 a `numpy.array`- 大小总是有对象开销。而且由于 Python 自然地处理 BigInts，所以真的很难说...

```
>>> i = 5
>>> import sys
>>> sys.getsizeof(i)
24 
```

因此，在 64 位平台上，它需要 24 个字节来存储可以存储在 3 位中的内容。

但是，如果你这样做了，

```
>>> s = '\x05'
>>> sys.getsizeof(s)
38 
```

所以不，不是真的 - 你已经得到了定义`object`而不是原始存储的内存开销......

如果你然后采取：

```
>>> a = array.array('i', [3])
>>> a
array('i', [3])
>>> sys.getsizeof(a)
60L
>>> a = array.array('i', [3, 4, 5])
>>> sys.getsizeof(a)
68L 
```

然后你会得到所谓的正常字节边界，等等……等等……等等……

如果您只想存储“纯粹”的内容-减去对象开销，则可以从 2.(6|7) 开始使用`some_int.bit_length()`（否则只需将其移位，如其他答案所示），然后从那里开始工作

* * *

## 回答 #2

> 赞同：28
> 
> 时间：2013-01-15T01:48:07.440

```
def byte_length(i):
    return (i.bit_length() + 7) // 8 
```

当然，正如 Jon Clements 指出的那样，这不是实际的大小`PyIntObject`，它有一个 PyObject 标头，并以最容易处理而不是最紧凑的方式将值存储为 bignum，你必须这样做在实际对象之上至少有一个指针（4 或 8 个字节），依此类推。

但这是数字本身的字节长度。它几乎可以肯定是最有效的答案，也可能是最容易阅读的。

还是`ceil(i.bit_length() / 8.0)`更具可读性？

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2013-01-15T01:39:25.387

您可以使用简单的数学：

```
>>> from math import log
>>> def bytes_needed(n):
...     if n == 0:
...         return 1
...     return int(log(n, 256)) + 1
...
>>> bytes_needed(0x01)
1
>>> bytes_needed(0x100)
2
>>> bytes_needed(0x10000)
3 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2013-01-15T01:37:18.137

通过使用简单的二元运算将所有使用的位每次移动超过 1 个字节，您可以看到存储一个数字需要多少字节。

可能值得注意的是，虽然这种方法非常通用，但它不适用于负数，并且只查看变量的二进制而不考虑它存储的内容。

```
a = 256
i = 0

while(a > 0):
    a = a >> 8;
    i += 1;

print (i) 
```

该程序的行为如下：

a 是`0000 0001 0000 0000`二进制的，每次循环运行都会将其向左移动 8：

```
loop 1:
0000 0001 >> 0000 0000
0000 0001 > 0 (1 > 0)

loop 2:

0000 0000 >> 0000 0001
0000 0000 > 0 (0 > 0)

END 0 is not > 0 
```

所以需要2个字节来存储数字。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2015-01-12T11:07:37.540

在 python 命令提示符下，您可以使用函数的大小

```
**$ import python 
$ import ctypes
$ ctypes.sizeof(ctypes.c_int)** 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2016-04-19T19:39:18.340

```
# Python 3

import math

nbr = 0xff                 # 255 defined in hexadecimal
nbr = "{0:b}".format(nbr)    # Transform the number into a string formated as bytes.

bit_length = len(nbr)      # Number of characters
byte_length = math.ceil( bit_length/8 ) # Get minimum number of bytes 
```

# c - 使用标准输入读取单列数据文件并在 C 中使用函数值返回值

> ID：14329795
> 
> 赞同：0
> 
> 时间：2013-01-15T01:31:45.427
> 
> 标签：c, stdin, getline

我有以下数据文件

```
1.0
2.0
3.0 
```

这是一个文件`text.dat`。到目前为止，我拥有以下代码，`mygetline.c`并将其编译为可执行文件`mygetline`。执行它我将数据文件输入到可执行文件中，因此 `./mygetline < text.dat`在 bash 终端中。

我想像这样读取数据文件并打印到标准输出该列，以及它的一些功能。这是到目前为止的代码。

```
#include <stdio.h>
int mygetline ( char s[], int lim )
{
  int c, i;

  i = 0;
  while( --lim > 0 && ( c = getchar() ) != EOF && c != '\n' )
  s[i++] = c;
  if ( c == '\n' )
  s[i++] = c;
  s[i] = '\0';
  return i ;
 }

void main()
{
     const int maxline = 10000;
     int nl, length;
     char line[maxline];
     double value ; 
     nl = 0;
     while ( ( length = mygetline( line, maxline ) ) != 0 ) //avoiding blanks
          {
    //Original error  sscanf( "%lf", line, &value ) ; //trying to get each line   
                                               //as the right 
                                              //number
       //FOllowing line is corrected implementation of sscanf()
              sscanf( line, "%lf", &value ) ; 
              printf( "%lf %lf\n", value ,value*value ) ; //trying to output x & x*x
           }
 } 
```

输出如下

```
0.000000 0.000000
0.000000 0.000000
0.000000 0.000000 
```

我想要类似的东西

```
1.0 1.0 
2.0 4.0 
3.0 9.0 
```

到任何精度。有没有人对我缺少什么来获得我想要的输出有任何建议？谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-15T01:39:52.527

Re-read the [documentation](http://www.cplusplus.com/reference/cstdio/sscanf/) for `sscanf`.

The format is the **second** parameter.
But you put the `"%lf"` as the **first** parameter.

# c# - jqgrid将参数传递给方法

> ID：14329798
> 
> 赞同：0
> 
> 时间：2013-01-15T01:32:03.680
> 
> 标签：c#, asp.net-mvc, jqgrid

我有以下示例：

```
 var url = '@Url.Action("GetProgData", "Prog")' + '?lbId=' + labId;        

      $("#loginList").jqGrid({
       url: url,
       datatype: "json",
       colNames: ['PNum', 'Client', 'Salesperson', 'Email'],
       colModel: [ ...
       ...... 
```

该方法在 c# MVC 中如下所示：

```
 public JsonResult GetLoginData(int rows, int page, string sidx, string sord, string searchField, string searchString, string searchOper, int? labId) 
```

我喜欢做的是有条件地传递labId的值，所以我有以下但似乎没有传递labId，因为它返回null：

```
 $("#LabId").change(function () {
        labId = $("#LabId").val();
        setupGrid(labId);
        $("#loginList").trigger("reloadGrid", [{ page: 1}]);
       }); 
```

不确定当我在下拉列表的 .change 中执行此操作时，labID 的值不会正常

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-15T09:11:46.637

我认为你可以`null`作为`labId`if的值发送

```
$("#loginList").jqGrid({
    url: '@Url.Action("GetProgData", "Prog")',
    postData: {
        lId: function () {
            var labId = $("#LabId").val();
            return labId === "" ? null : labId;
        }
    },
    datatype: "json",
    colNames: ['PNum', 'Client', 'Salesperson', 'Email',
    ...
}); 
```

如果上述解决方案不起作用，您可以选择执行以下操作

```
$("#loginList").jqGrid({
    url: '@Url.Action("GetProgData", "Prog")',
    serializeGridData: function (data) {
        var labId = $("#LabId").val();
        return labId === "" ? data : $.extend(true, {}, data, {lId: labId});
    },
    datatype: "json",
    colNames: ['PNum', 'Client', 'Salesperson', 'Email',
    ...
}); 
```

# java - 重复的局部变量

> ID：14329799
> 
> 赞同：0
> 
> 时间：2013-01-15T01:32:13.910
> 
> 标签：java, eclipse

我最近开始使用 java 编程并需要帮助。

使用 Programming Java for Dummies，我正在尝试制作一个用户必须猜数字的游戏。一旦用户最终得到正确答案，就会记录并显示尝试次数。

星号线给我带来了麻烦，有什么帮助吗？

```
import static java.lang.System.out;
import java.util.Scanner;
import java.util.Random;

import javax.swing.JOptionPane;

public class HelloWorld
{
        public static void main(String args[])
        {
            Scanner keyboard = new Scanner (System.in);
            out.println("Hello, welcome to the Guessing Game.");
            out.println("To begin, pick a random number from 1 - 10: ");

            int inputNumber = keyboard.nextInt();
            int randomNumber = new Random(1).nextInt(10);
            int numGuesses = 0;

            while (inputNumber != randomNumber){

                out.println();
                out.println("You're guess was wrong, try again.");
                out.println("Pick an integer from 1-10.");
                **int inputNumber = keyboard.nextInt();** 
                numGuesses++;
            }

            {

                out.println("You won in " + numGuesses + " guesses.");

                out.println("Thanks for playing!");
            }
            }

} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-15T01:35:00.980

代替

```
**int inputNumber = keyboard.nextInt();** 
```

和

```
inputNumber = keyboard.nextInt(); 
```

使用原始版本，您是在 范围内创建一个**新变量**`while`，而不是分配给外部的旧变量。

由于它**在 while 块之后被销毁**，因此条件本身使用函数范围内的变量。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-15T01:34:54.037

此行正在重新声明已声明的 inputNumber。

```
int inputNumber = keyboard.nextInt(); 
```

将其更改为

```
inputNumber = keyboard.nextInt(); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-15T01:36:19.083

您已经在顶部定义了，因此您不必重新定义它。相反，它应该是`inputNumber = keyboard.nextInt();`

# reportviewer - 无法以编程方式从主报表引用子报表属性 (EnableExternalImages)

> ID：14329800
> 
> 赞同：3
> 
> 时间：2013-01-15T01:32:22.210
> 
> 标签：reportviewer, rdlc, subreport

我有我认为在其他问题中没有解决的独特要求。我在 Microsoft 报表设计器中开发了一个本地报表作为 rdlc，并通过报表查看器控件查看它。该报告包含一个子报告。子报表呈现来自外部文件的图像。问题是我需要在运行时以编程方式设置子报表的 EnableExternalImages 属性。没有这个，子报告拒绝呈现（“错误：无法显示子报告”是我得到的错误消息）。我已经以编程方式在主/外部报告上设置了这个属性，使用这个语句没有问题：

Me.ReportViewer1.LocalReport.EnableExternalImages = True

但是我需要在子报告上做同样的事情......所以最理想的是，我想编写这样的代码：

Me.ReportViewer1.LocalReport.Subreport1.EnableExternalImages = True。

问题是，我没有看到可以让我以这种方式直接访问子报表属性的可用属性。我已经研究过使用 SubreportProcessingEvent，但是这个事件只公开了子报告的有限数量的属性（Reportparamaters、Datasources、ReportPath 等），但没有让我能够访问它的所有属性（例如EnableExternalImages 属性）。

感谢您提供任何信息...

# javascript - 基本的开源 JavaScript 图像编辑器

> ID：14329801
> 
> 赞同：0
> 
> 时间：2013-01-15T01:32:23.100
> 
> 标签：javascript, html, image-processing

我一直在寻找，但一直未能找到基于 Web/JavaScript 的图像编辑器。类似[aviary](http://www.aviary.com)的东西，但能够`POST`将图像数据直接返回到我的托管服务器（[在 aviary`POST`处理到我的服务器](http://www.aviary.com/web/documentation#saving-steps)之前无需处理）。

我只是在寻找基本的图像编辑——裁剪、调整大小，也许还有一些过滤功能。

*Aviary 本来是解决方案，但上述限制排除了它的可行性。*

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-18T19:40:51.717

我使用 Aviary，我所做的就是获取数据并将其发送到新页面并使用 asp.net 将其保存到服务器

在编辑页面上，我更改了功能：

```
onSaveButtonClicked: function() 
{
    myEditor.getImageData(function(data) 
   {
      // set image to new data, and close editor
      if (myImage) 
      {
    document.getElementById('image2').value=data;
    document.form2.submit();  //Send to next page
      }
      myEditor.close();
    });
    return false;
}

I added a new form under the first form:

<form name="form2" id="form2"> method="post" action="edit_save_image_task.aspx?filename=<%=filename %>" 
        <input id="image2" type="hidden" name="image2" value="" />
</form> 
```

在下一页上，我使用以下代码保存文件：

```
<script Runat="Server">    
    Sub Page_Load()
        Dim file1,image3
        image3 = Replace(request("image2"), vbCrLf, "")
        image3 = Replace(image3, vbTab, "")
        image3 = Replace(image3, " ", "")

        file1=replace(image3,"data:image/png;base64,","")

        ' Convert the Base64 UUEncoded input into binary output. 
        Dim binaryData() As Byte
        Try
            binaryData = System.Convert.FromBase64String(file1)
        Catch exp As System.ArgumentNullException
            System.Console.WriteLine("Base 64 string is null.")
            Return
        Catch exp As System.FormatException
            System.Console.WriteLine("Base 64 length is not 4 or is " + _
                                     "not an even multiple of 4.")
            Return
        End Try

        'Write out the decoded data. 
        Dim outFile As System.IO.FileStream
        Try
            Dim filelocation

            filelocation="Where you would like the file saved"

            outFile = New System.IO.FileStream(filelocation, _
                                               System.IO.FileMode.Create, _
                                               System.IO.FileAccess.Write)
            outFile.Write(binaryData, 0, binaryData.Length - 1)
            outFile.Close()
        Catch exp As System.Exception
            ' Error creating stream or writing to it.
            System.Console.WriteLine("{0}", exp.Message)
        End Try

    End Sub
</script> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2018-01-04T02:11:45.743

我认为您需要实现一个简单的用户界面来设置某些框架提供的图像处理算法的参数。处理完图像后，您可以将其发布到您的后台。一些纯 Javascript 图像处理框架：

*   [织物.js](http://fabricjs.com/)
*   [处理.js](http://processingjs.org/)
*   [马文杰](http://www.marvinj.org/)

对于[MarvinJ](http://www.marvinj.org/)，使用以下代码加载您的图像：

```
var image = new MarvinImage();
image.load("https://i.imgur.com/By6tvip.jpg", imageLoaded); 
```

我将使用以下输入图像来演示如何使用它：

[![在此处输入图像描述](../Images/481a583520da45cd4345805f43d8a7e2.png)](https://i.stack.imgur.com/mk0wr.jpg)

**规模：**

```
 Marvin.scale(image, imageOut, 80); 
```

[![在此处输入图像描述](../Images/4ba8093d2c366a9052fd8a91a431ca4e.png)](https://i.stack.imgur.com/c7eEU.png)

**裁剪：**

```
Marvin.crop(image, imageOut, 60, 0, 80, 120); 
```

[![在此处输入图像描述](../Images/bda2dda833419db19d0c8a801c649f7a.png)](https://i.stack.imgur.com/vMChu.png)

**棕褐色：**

```
Marvin.sepia(image, imageOut, 40); 
```

[![在此处输入图像描述](../Images/5c85e93e65b4496454e64344f052e613.png)](https://i.stack.imgur.com/KRpwX.png)

**浮雕：**

```
Marvin.emboss(image, imageOut); 
```

[![在此处输入图像描述](../Images/e637002972ecda46a6761eb3ec269013.png)](https://i.stack.imgur.com/qTrxr.png)

**边缘检测：**

```
Marvin.prewitt(image, imageOut); 
```

[![在此处输入图像描述](../Images/f5add2df705e76e76a84e891ae3bdc33.png)](https://i.stack.imgur.com/pomzJ.png)

**模糊：**

```
Marvin.gaussianBlur(image, imageOut, 3); 
```

[![在此处输入图像描述](../Images/767315d73e8d253b5c73c5206fe1f661.png)](https://i.stack.imgur.com/ExNFa.png)

**亮度和对比度：**

```
Marvin.brightnessAndContrast(image, imageOut, 70, 60); 
```

[![在此处输入图像描述](../Images/e86f9774065cbe26fc01a5527377df7f.png)](https://i.stack.imgur.com/n7Hfg.png)

**颜色通道：**

```
Marvin.colorChannel(image, imageOut, 0, 0, 110); 
```

[![在此处输入图像描述](../Images/859076a4241f1e8ad2a401fb03c21e3e.png)](https://i.stack.imgur.com/p66gR.png)

**先前过滤器的可运行示例：**

```
var canvas1 = document.getElementById("canvas1");
var image = new MarvinImage();
image.load("https://i.imgur.com/By6tvip.jpg", imageLoaded);

function imageLoaded(){
	var imageOut = new MarvinImage(image.getWidth(), image.getHeight());

	// Scale
	Marvin.scale(image, imageOut, 80);
	imageOut.draw(canvas1);
	imageOut = new MarvinImage(image.getWidth(), image.getHeight());

	// Cropping
	Marvin.crop(image, imageOut, 60, 0, 80, 120);
	imageOut.draw(canvas2);
	imageOut = new MarvinImage(image.getWidth(), image.getHeight());

	// Sepia
	Marvin.sepia(image, imageOut, 40);
	imageOut.draw(canvas3);

	// Emboss
	Marvin.emboss(image, imageOut);
	imageOut.draw(canvas4);

	// Edge
	imageOut.clear(0xFF000000);
	Marvin.prewitt(image, imageOut);
	imageOut.draw(canvas5);

	// Gaussian Blur
	Marvin.gaussianBlur(image, imageOut, 5);
	imageOut.draw(canvas6);

	// Brightness
	Marvin.brightnessAndContrast(image, imageOut, 70, 60);
	imageOut.draw(canvas7);

	// Color Channel
	Marvin.colorChannel(image, imageOut, 0, 0, 110);
	imageOut.draw(canvas8);
}
```

```
<script src="https://www.marvinj.org/releases/marvinj-0.7.js"></script>
<canvas id="canvas1" width="192" height="120"></canvas>
<canvas id="canvas2" width="192" height="120"></canvas>
<canvas id="canvas3" width="192" height="120"></canvas>
<canvas id="canvas4" width="192" height="120"></canvas>
<canvas id="canvas5" width="192" height="120"></canvas>
<canvas id="canvas6" width="192" height="120"></canvas>
<canvas id="canvas7" width="192" height="120"></canvas>
<canvas id="canvas8" width="192" height="120"></canvas>
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-15T03:35:07.473

我不知道有任何完整的开源解决方案，但如果你想构建一个简单的编辑器，[裁剪](http://www.html5canvastutorials.com/tutorials/html5-canvas-image-crop/)和[旋转是相当直接的实现。](https://stackoverflow.com/questions/4649836/using-html5-canvas-rotate-image-about-arbitrary-point)

CamanJS [(Repo)](https://github.com/meltingice/CamanJS/)库可能是[过滤](http://camanjs.com/) [器](http://www.html5rocks.com/en/tutorials/canvas/imagefilters/)的一个选项。[这个关于排版](http://www.html5rocks.com/en/tutorials/canvas/texteffects/)的 tut也可能很有用。

# php - 创建设置 php 脚本

> ID：14329805
> 
> 赞同：1
> 
> 时间：2013-01-15T01:32:37.600
> 
> 标签：php, settings

我最近才开始 web 开发/编程。我开始喜欢它，现在我开始掌握 php 编程。尽管我遇到了一个我无法解决/不明白如何解决的问题。

我创建了一个“滚动回顶部”按钮，我想在管理页面上打开或关闭它。这也是问题所在。我不知道如何正确地做到这一点。我是否必须创建一个 Sql 表来存储一个值并在按钮脚本中调用该值，还是有其他方法？

现在，按钮和 jquery 函数在一个单独的文件中编写脚本，我将其包含在需要按钮的页面上。我尝试在管理页面中创建一个表单，该表单将一个值（打开或关闭）提交给配置文件，并且配置文件包含在按钮脚本文件中。现在我觉得这是做我想做的事情的正确方法。

有没有人可以通过解释如何实现这一点或向我指出一些关于如何在 PHP 中做这些事情的资源/教程来帮助我和其他面临同样问题的初级开发人员？

我的感激之情将是超乎寻常的！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-15T01:35:48.723

好吧，这取决于您是否已经有数据库。我不会为此创建数据库，甚至不会创建表。我会考虑简单地将 xml 文件写入文件系统，以实现如此简单的事情。如果您有一个多用户站点并且每个用户都需要它，那么这将证明一个 db 表是合理的，因为您以后可能会向它添加更多。

如果您不担心在访问站点之间保留它，您可以使用 $_Session： [http ://php.net/manual/en/reserved.variables.session.php](http://php.net/manual/en/reserved.variables.session.php)

如果您不想做数据库工作并且需要跨会话持久性，甚至可能在 cookie 中：http: [//php.net/manual/en/reserved.variables.cookies.php](http://php.net/manual/en/reserved.variables.cookies.php)

检查滚动问题，这不是 php： [https ://developer.mozilla.org/en-US/docs/DOM/window.scroll](https://developer.mozilla.org/en-US/docs/DOM/window.scroll)

检查这篇文章，它可能会有所帮助： [Creating/Writing an XML file in PHP?](https://stackoverflow.com/questions/9596604/creating-writing-an-xml-file-in-php)

# ios - 如何反映旋转的图像视图

> ID：14329808
> 
> 赞同：2
> 
> 时间：2013-01-15T01:32:58.610
> 
> 标签：ios, core-graphics, scaling, transformation, caanimation

我正在构建一个 iOS 应用程序，我需要一种方法来将旋转 (by `CABasicAnimation`) 图像反射到下面的表面，就像半透明的材质效果一样。这是我命名`indicator`和`indicatorReflection`初始化图像的代码：

```
#define rotation_reflected(ANG) CGAffineTransformMakeRotation(M_PI/2 - (ANG * M_PI / 180.0))
#define rotation(ANG) CGAffineTransformMakeRotation(-M_PI/2 - (ANG * M_PI / 180.0))
[self rotateIndicator:0];

-(void)rotateIndicator:(float)degrees{
    self.indicatorView.transform = rotation(degrees);
    self.indicatorReflectionView.transform = rotation_reflected(degrees);
} 
```

之后，我使用以下代码为它们设置动画：

```
-(void)startWanderingIndicator{
    CABasicAnimation *anim = [CABasicAnimation animationWithKeyPath:@"transform"];
    CATransform3D xform = CATransform3DMakeAffineTransform(rotation(180));
    anim.toValue = [NSValue valueWithCATransform3D:xform];
    anim.duration = 4.0f;
    anim.fillMode = kCAFillModeForwards;
    anim.removedOnCompletion = NO;
    [self.indicatorView.layer addAnimation:anim forKey:@"rotation"];

    anim = [CABasicAnimation animationWithKeyPath:@"transform"];
    xform = CATransform3DMakeAffineTransform(rotation_reflected(180));
    anim.toValue = [NSValue valueWithCATransform3D:xform];
    anim.duration = 4.0f;
    anim.fillMode = kCAFillModeForwards;
    anim.removedOnCompletion = NO;
    [self.indicatorReflectionView.layer addAnimation:anim forKey:@"rotation"];

} 
```

第一个没有问题。问题始于反射视图。我已经尝试了几乎所有的 +/- PI/2 和 +/- ANGLE 组合，但我永远无法使反射视图遵循正确的反射路径。我不是三角学专家，但这对于任何懂数学的人来说都应该是微不足道的，除此之外，我已经尝试了所有可能的组合，其中一个应该是正确的答案。我的旋转计算代码有问题，还是与动画/变换方法有关？

谢谢，

能。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-15T01:56:41.630

您的功能可能应该是：

```
#define rotation_reflected(ANG) CGAffineTransformMakeRotation(M_PI/2 + (ANG * M_PI / 180.0))
#define rotation(ANG) CGAffineTransformMakeRotation(-M_PI/2 - (ANG * M_PI / 180.0)) 
```

注意第一行的+号；您希望这两个对象以*相反的方向*旋转。但是，除非您翻转其中一个视图（仅通过旋转无法模拟镜像），否则您仍然不会拥有正确的外观。尝试制作一个在 y 轴上具有 -1 比例变换的子视图。

但是，这可能不会达到您想要的效果，因为变换无法知道您尝试旋转的方向。（假设您从中午旋转到 6 点；您可以指定从上到下，但 CABasicAnimation 不知道您是指顺时针还是逆时针；变换没有“符号”，因此它无法区分 180 度和 -180 度。）

获得预期效果的方法是使用`CAValueFunction`. 您无需指定 from 和 to 变换，而是指定您想要做什么（围绕 Z 轴旋转）以及您想要从哪个角度旋转（在这种情况下，它将尊重符号）。引用[CAValueFunction 文档](https://developer.apple.com/library/mac/documentation/GraphicsImaging/Reference/CAValueFunction_class/Reference/Reference.html)：

> 通过创建 CAValueTransform 函数并指定 kCAValueFunctionRotateZ，然后创建一个 fromValue 为 0、toValue 为 M_PI 的动画，然后将动画的 valueTransform 属性设置为值转换实例。

所以，你会想要这样的东西：

```
-(void)startWanderingIndicator{
    CABasicAnimation *anim = [CABasicAnimation animationWithKeyPath:@"transform"];
    anim.valueFunction = [CAValueFunction functionWithName:kCAValueFunctionRotateZ];
    anim.toValue = rotation(180);
    anim.duration = 4.0f;
    anim.fillMode = kCAFillModeForwards;
    anim.removedOnCompletion = NO;
    [self.indicatorView.layer addAnimation:anim forKey:@"rotation"];

    anim = [CABasicAnimation animationWithKeyPath:@"transform"];
    anim.valueFunction = [CAValueFunction functionWithName:kCAValueFunctionRotateZ];
    anim.toValue = rotation_reflected(180);
    anim.duration = 4.0f;
    anim.fillMode = kCAFillModeForwards;
    anim.removedOnCompletion = NO;
    [self.indicatorReflectionView.layer addAnimation:anim forKey:@"rotation"];
} 
```

# maven - maven 使用 shade jar 打包 JDO 依赖项

> ID：14329812
> 
> 赞同：2
> 
> 时间：2013-01-15T01:33:18.290
> 
> 标签：maven, datanucleus, maven-shade-plugin

我正在尝试打包一个由我的代码 + 依赖项组成的阴影 jar。我可以很好地打包所有东西，但是因为我使用的是 DataNucleus（datanucleus-core、datanucleus-api-jdo、datanucleus-rdbms），所以它们的 plugin.xml 在它们的根目录中。我尝试使用带有阴影的 XmlAppendingTransformer，但由于这些 xml 的根元素只是`<plugin>`将所有`<extension>`元素合并到一个巨大`<plugin>`标签中的转换器，并且在运行时 DataNucleus 类加载器无法找到正确的插件。所以我的问题是：

1) 将所有依赖项打包到 1 个 jar 中是一个好习惯吗？或者我应该将依赖项复制到一个文件夹中并在运行时将该文件夹包含在类路径中？

2）如果我想用我的jar打包DataNucleus，如何处理多个plugin.xml？我尝试将它们放在`<plugins>`根标签中，但这也不起作用。他们必须在根文件夹中吗？我可以在阴影过程中将它们移动到不同的文件夹吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-15T08:40:03.430

所有 plugin.xml（Eclipse OSGi 插件）都必须位于 CLASSPATH 的根目录中，因此您必须合并它们。同样，您需要合并 META-INF/MANIFEST.MF（OSGi 元数据）的内容。

好的做法？我不会争论任何一种方式。做适合您的环境和项目的事情。

如果您找到一种可靠地合并它们的方法，请告诉我们，以便可以将其放入 DN 文档中，以造福那些想要做这种事情的人。其他人之前尝试过，stackoverflow IIRC上的一些帖子

# opencv - opencv 类“cvKalman”无法识别

> ID：14329814
> 
> 赞同：1
> 
> 时间：2013-01-15T01:33:27.073
> 
> 标签：opencv, ros, kalman-filter

我有一个问题，在 ROS 中，我使用 openCv 处理相机馈送。现在我尝试实现 cvKalman，但无法识别这种类型，但是 opencv 示例运行良好。

我错过了什么，为什么不能识别这种类型？

这是我对 ROS 节点的包含：

```
#include <ros/ros.h>
#include <math.h>
#include <image_transport/image_transport.h>
#include <cv_bridge/cv_bridge.h>
#include <sensor_msgs/image_encodings.h>
#include <opencv2/imgproc/imgproc.hpp>
#include <opencv2/highgui/highgui.hpp>

#include <opencv2/core/core.hpp>

// for img processing 
#include "opencv2/highgui/highgui.hpp"
#include "opencv2/imgproc/imgproc.hpp"

#include <opencv/cv.h> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-15T01:40:27.643

Try including with `"`s not `<`s such as:

```
#include "ros/ros.h" 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-15T13:40:16.873

我通过使用包装类解决了这个问题`KalmanFilter`，但我仍然不明白为什么我不能使用简单`Kalman`类。

# javascript - 反转文本颜色？

> ID：14329817
> 
> 赞同：-2
> 
> 时间：2013-01-15T01:33:37.393
> 
> 标签：javascript, jquery, css, html

我有一个横向滚动的页面，我有一个浮动菜单。我希望菜单中的文本反转它下面的颜色。有没有办法用 HTML5、Javascript 和/或 jQuery 做到这一点？

**补充：**当图像越过页面的不同部分时，您将如何反转图像？CSS？

这是我用于菜单的 CSS

```
body{
  background:#000;
  font-family:Georgia;
  font-size: 34px;
  font-style: italic;
  letter-spacing:-1px;
  width:12000px;
  position:absolute;
  top:0px;
  left:0px;
  bottom:0px;
}
ul#banner{
  position: fixed;
  line-height: 45px;
  margin: 0 30px; padding: 0; 
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-15T02:02:44.643

尝试使用：

```
var color = // color in hex.
color ^ 0xFFFFFF (XOR bit operator) to get it? 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-15T02:20:29.093

我写了一个测试页。 [演示在这里](http://jsfiddle.net/jikeytang/wsnJS/)。inside body 不能写宽度，否则会使页面出现滚动条。包括以下知识点：

1.  CSS封面：

    ```
    .nav .selected .nav-01{background:#f93;}
    .nav .selected .nav-02{background:#3c3;}
    .nav .selected .nav-03{background:#36c;} 
    ```

2.  jQuery插件：

    ```
    (function($){
      $.fn.extend({
        first: function(){ },
        second: function(){}
      });
    }(jQuery)); 
    ```

3.  jQuery 调用

    ```
    $(document).ready(function(){
        $('#content').scrollPage({
            pTag   : '.list',
            menu   : '.nav',
            speed  : 600
        });
    }) 
    ```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-15T02:57:14.800

### 第1步。获取菜单的位置

### 第2步。删除菜单并获取放置在位置上的元素

也许你可以使用 document.elementFromPoint

### 第三步。反转元素的颜色并将其应用于您的菜单

### 第4步。再次显示您的菜单

### 步骤 5。每当您需要更改菜单的颜色（滚动等）时重复此操作

# android - 涉及完成（）和后退按钮的启动画面

> ID：14329822
> 
> 赞同：1
> 
> 时间：2013-01-15T01:33:50.743
> 
> 标签：android, splash-screen

好的，所以我的应用程序上有一个启动画面。我想知道是否有办法让我只在第一次打开应用程序时才出现它（或者如果他们强制关闭它等等），所以如果他们按下后退键，它不会将它们带到初始屏幕。

我可以做到这一点，这样用户就无法通过键入 finish() 来返回启动屏幕，虽然我现在不记得了，但我可以让它只加载一次。一旦我调用了finish()，重新进入应用程序时就会重新出现启动画面。有没有什么办法解决这一问题？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-15T01:42:51.383

Yes, you can do that by calling `finish()` on the `onPause` method of your `splashActivity`.

Or another way to do this is to add `android:noHistory="true"` on `splashActivity` of your `manifest.xml`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-09-02T15:13:41.337

你在`SplashScreenActivity`浪费时间，因为他们在继续之前会暂停初始化 2-3 秒。

我更喜欢`Splash Screen Layout`在我的`main_activity.xml`. 我通过扩展应用程序来检测应用程序的第一次启动。如果是第一次开始，我会在后台构建 UI 时显示我的 Splash-Screen ...（如果 ProgressBar 滞后，请使用后台线程！）

```
//Extend Application to save the value. You could also use getter/setter for this instead of Shared Preferences...
public class YourApplication extends Application {

    public static final String YOUR_APP_STARTUP = "APP_FIRST_START";

    @Override
    public void onCreate() {
        super.onCreate();

        //set SharedPreference value to true
        SharedPreferences mPreferences = PreferenceManager.getDefaultSharedPreferences(getApplicationContext());
        SharedPreferences.Editor editor = mPreferences.edit();
        editor.putBoolean(YOUR_APP_STARTUP, true);
        editor.apply();     
        ...    
     } 
```

检查你的第一次开始`MainActivity`

```
public class YourMainActivity extends Activity {

@Override
protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    //hide actionbar and other menu which could overlay the splash screen
    getActionBar().hide();

    setContentView(R.layout.activity_main);

    Boolean firstStart = PreferenceManager.getDefaultSharedPreferences(getApplicationContext()).getBoolean(TVApplication.YOUR_APP_STARTUP, true);

    if (firstStart) {
        //First app start, show splash screen an hide it after 5000ms
        final RelativeLayout mSplashScreen = (RelativeLayout) findViewById(R.id.splash_screen);
        mSplashScreen.setVisibility(View.VISIBLE);
        mSplashScreen.setAlpha(1.0f);
        final FrameLayout mFrame = (FrameLayout) findViewById(R.id.frame_container);
        mFrame.setAlpha(0.0f);

        Handler handler = new Handler();
        handler.postDelayed(new Runnable() {
            @Override
            public void run() {
                Animation fadeOutAnimation = AnimationUtils.loadAnimation(getApplicationContext(),
                        R.anim.fade_out_animation);
                fadeOutAnimation.setDuration(500);
                fadeOutAnimation.setAnimationListener(new Animation.AnimationListener() {

                    @Override
                    public void onAnimationStart(Animation animation) {
                        mFrame.setAlpha(1.0f);
                        getActionBar().show();
                    }

                    @Override
                    public void onAnimationEnd(Animation animation) {
                        mSplashScreen.setVisibility(View.GONE);
                    }

                    @Override
                    public void onAnimationRepeat(Animation animation) {

                    }
                });
                mSplashScreen.startAnimation(fadeOutAnimation);
            }
        }, 5000); //<-- time of Splash Screen shown

    } else {
        ((RelativeLayout) findViewById(R.id.splash_screen)).setVisibility(View.GONE);
        getActionBar().show();
    } 
```

在 main.xml 的顶部插入 SplashScreen。我更喜欢`RelativeLayout`那个。在示例中，SplashScreen 放置在带有 的布局中`Navitgation Drawer`，这是我们非常喜欢的，不是吗？

```
//main_activity.xml
<?xml version="1.0" encoding="utf-8"?>
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="match_parent"
    android:layout_height="match_parent" >

    <android.support.v4.widget.DrawerLayout
        android:id="@+id/drawer_layout"
        android:layout_width="match_parent"
        android:layout_height="match_parent" >

        <!-- The main content view -->

        <FrameLayout
            android:id="@+id/frame_container"
            android:layout_width="match_parent"
            android:layout_height="match_parent" />

        <!-- The navigation drawer list -->

        <ListView
            android:id="@+id/slider_list"
            android:layout_width="240dp"
            android:layout_height="match_parent"
            android:layout_alignParentTop="true"
            android:layout_gravity="start"
            android:background="@color/tvtv_background"
            android:choiceMode="singleChoice"
            android:divider="@drawable/nav_bar_divider"
            android:dividerHeight="1dp"
            android:listSelector="@android:color/transparent" />
    </android.support.v4.widget.DrawerLayout>

    <RelativeLayout
        android:id="@+id/splash_screen"
        android:layout_width="match_parent"
        android:layout_height="match_parent"
        android:layout_alignParentTop="true"
        android:background="@color/tvtv_white"
        android:visibility="visible" >

        <ImageView
            android:id="@+id/splash_screen_logo"
            android:layout_width="match_parent"
            android:layout_height="wrap_content"
            android:layout_centerInParent="true"
            android:paddingLeft="50dp"
            android:paddingRight="50dp"
            android:scaleType="fitCenter"
            android:src="@drawable/ic_launcher" />

        <TextView
            android:id="@+id/splash_screen_text"
            style="@style/TVTextBlueContent"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:layout_below="@+id/splash_screen_logo"
            android:layout_centerHorizontal="true"
            android:padding="10dp"
            android:text="Awesome splash shiat" />

        <ProgressBar
            android:id="@+id/splash_screen_loader"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:layout_below="@+id/splash_screen_text"
            android:layout_centerHorizontal="true"
            android:clickable="false"
            android:indeterminate="true" />
    </RelativeLayout>

</RelativeLayout> 
```

# c++ - 错误 C2059：语法错误：'}'

> ID：14329824
> 
> 赞同：-1
> 
> 时间：2013-01-15T01:34:09.590
> 
> 标签：c++, syntax-error

我正在写一个二十一点程序。我创建了包含两个字符串和一个整数的类卡。“dealer”是“card”类的向量，“dtotal”和“deckplace”都是整数。'display()' 是一个打印卡片、花色和总数的函数。错误发生在“else if (total>16)”上方的行中。

```
void dealerTurn()
{
    if (dtotal<17)
    {
        do while (dtotal<17)
        {
            dealer.pop_back(deck[deckplace]);
            deckplace = deckplace+1;

            for (y=0;y<dealer.size();y++)
            {
                if (dealer[y].name=="A" && dtotal>21)
                {
                    dealer[y].value = 1;
                    dtotal = 0;
                    for (z=0;z<dealer.size();z++)
                        dtotal = dtotal + dealer[z].value;
                }
            }

            display();

            if (dtotal>21)
            {
                cout << endl << "-----DEALER BUSTED!-----" << endl << endl;
                dtotal = 0;
            }
        }
    }
    else if (total>16)
    {
        display();
    }
    result();
} 
```

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-01-15T01:35:16.333

没有这样的事情`do while`。它是`while (__condition__) { __statements__ }`或`do { __statements__ } while (__condition__);`。

# python - 使用 gitpython 编辑提交

> ID：14329828
> 
> 赞同：7
> 
> 时间：2013-01-15T01:34:51.433
> 
> 标签：python, git, gitpython

假设您在终端中，当前位于 git repo 的根目录中。

如果你已经安装了[GitPython](http://packages.python.org/GitPython/0.3.1/reference.html)，你可以这样做来获取最后提交的提交，或者更确切地说，是 HEAD 指向的提交：

```
>>> import git
>>> r = git.Repo('.')
>>> c = r.head.commit
>>> c
<git.Commit "62e71e8210d0d0275b1f5845bf3033a7bfa3ed73">
>>> c.message
u'old message'
>>> c.message = "new message"
>>> c.message
'new message' 
```

但是如果你退出 python 并进入`git log`这里，你会看到提交消息保持不变。如何使用此库编辑提交？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-15T02:33:20.910

**你不能编辑 git 提交。** 这是合同的一部分`git`。

不过，您*可以*用新的提交替换 git 提交。就是这样`git commit --amend`做的：它回溯上次提交，将更改与您所做的新更改结合起来，然后从组合中进行全新的提交。与`git rebase`声称“改变”历史的任何其他事物相同。

所以你必须在这里做同样的事情：将分支指针移回一个提交，重用相同的树对象，并使用不同的消息提交它。请记住，您会搞砸任何看到该提交的人；**永远不要更改已发布的历史记录。**

我根本不知道这个库，但是文档中的示例组合可能会满足您的需求：

```
branch = r.head.reference
commit = r.head.commit
branch.commit = commit.parents[0]
# This works because the index is unchanged by the `branch.commit`
# edit, but it won't work if you're trying to change a commit on
# another branch -- you can't really do that
new_commit = repo.index.commit(u"new message") 
```

新提交将具有不同的哈希，但应包含相同的更改并具有新消息。 **仔细做这件事，我的粗体字很重要，改变历史是一项不平凡的操作，你应该明白你在做什么。**

* * *

* 好吧，有 git "notes" 可以独立于它们所附加的提交进行编辑。但这显然不是你在这里的意思，而且我还没有看到有人真正使用它们。

# java - 准备好的语句中的整数和字符串

> ID：14329837
> 
> 赞同：-1
> 
> 时间：2013-01-15T01:36:02.577
> 
> 标签：java, jsp, netbeans

我在我的 try 子句中有这个......如果我删除`pst.setString(5, value5)`它工作正常，如果我删除所有整数值它也工作，但如果添加所有整数和 value5 我无法让它工作......

```
try {
  Class.forName("org.postgresql.Driver");
  connection = DriverManager.getConnection(connectionURL, "username", "password");
  String sql ="UPDATE table1 SET value1 = ?, value2 = ?, value3 = ?, value4 = ? value5 = ? WHERE value6 = ? ";
  PreparedStatement pst = connection.prepareStatement(sql);

  Integer value1A = Integer.parseInt(value1),
  value2A = Integer.parseInt(value2),
  value2A = Integer.parseInt(value3),
  value2A = Integer.parseInt(value4);  

  pst.setInt(1, value1A);
  pst.setInt(2, value2A);
  pst.setInt(3, value3A);
  pst.setInt(4, value4A);
  pst.setString(5, value5);
  pst.setString(6, value6);

  int numRowsChanged = pst.executeUpdate();

  pst.close();
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-15T01:38:49.417

You're missing a comma in your `SQL`:

```
String sql ="UPDATE table1 SET value1 = ?, value2 = ?, value3 = ?, value4 = ?, value5 = ? WHERE value6 = ? ";
                                                                             ^ 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-15T01:39:51.677

it seems you are missing a comma?

# ios - 应用程序在后台时的PhoneGap iOS getCurrentPosition

> ID：14329838
> 
> 赞同：3
> 
> 时间：2013-01-15T01:36:04.717
> 
> 标签：ios, cordova, background, geolocation

我正在开发一个使用 PhoneGap/Cordova 跟踪用户地理位置的应用程序。即使应用程序处于后台，了解用户的位置也至关重要。我在谷歌群组和论坛上发现了很多相互矛盾的信息。一些人声称它可以工作，而另一些人则声称它根本不起作用，因为 Apple 拒绝在后台执行 JavaScript。很多信息已经过时了，我尝试的黑客和解决方法都失败了。

我将“必需的后台模式”/“应用程序注册位置更新”属性添加到我的 projectname.info.plist。

我的简单问题是；在运行PhoneGap iOS应用程序的情况下收集地理信息是否可能在后台运行？

问候！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-28T10:47:04.690

答案是不。当应用程序在后台时，Apple 不允许执行 Javascript。一个可能的解决方案是创建一个 phonegap 插件，它可以在不使用 Javascript 的情况下执行此操作。

# html - 如何使用 HTML 在每个打印页面的末尾打印页脚？

> ID：14329839
> 
> 赞同：1
> 
> 时间：2013-01-15T01:36:09.630
> 
> 标签：html, printing, footer

我已经在这个网站上到处找了这个。我正在使用 EditLive！房地产公司创建租赁文件的功能。该文档非常完整，只是他们希望能够在文档的每个打印页面的末尾插入一个页脚。它的奇怪之处在于，分页符取决于输入到页面中进行打印的数据（许多租户等），因此页面不会总是在同一个地方打印。它可以是一个租户的 12 页文档或另一个租户的 14 页文档。所以我需要弄清楚如何让页脚在每页的末尾自动打印。它只会有一些文字而已......有什么想法吗？我不能使用脚本...只是 HTML/CSS。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-15T01:59:23.203

通过这篇很棒的文章[http://www.alistapart.com/articles/boom](http://www.alistapart.com/articles/boom)找到了这个规范[http://www.w3.org/TR/2004/CR-css-print-20040225/#s.8.4](http://www.w3.org/TR/2004/CR-css-print-20040225/#s.8.4)。

试图测试下一个代码，但遗憾的是 chrome 和 ff 似乎不支持。

```
<style media="print">
 @page {
  @bottom-center {
      content: "Your footer text";
  }
 }
</style> 
```

# scala - Scala 隐式类型类依赖注入

> ID：14329843
> 
> 赞同：2
> 
> 时间：2013-01-15T01:36:25.243
> 
> 标签：scala, dependency-injection, akka, typeclass

我需要一些帮助来解决这种情况。我有一个 Akka 演员，我想在其中注入一个依赖项，在本例中为 RemoteFetcher，我也希望在我的测试中模拟它。像这样：

main/src/scala/ **mypackage/Services.scala**

```
package mypackage
import RemoteFetcherFileSystem._

trait RemoteFetcher {
  def fetch( path:String ): Future[Stream[String]]
}

class MyRemoteResourceActor extends Actor with ActorLogging {
  def fetchRemote( path:String ) = implicitly[RemoteFetcher].fetch( path )
  def receive = {
     case FetchRemoteResource( path ) => fetchRemote( path ).map( _.foreach( sender ! _ ) )
  }
} 
```

为此，我有一个隐式对象，我将其导入到上面的文件中。看起来像这样：

```
implicit object RemoteFetcherFileSystem extends RemoteFetcher {
   def fetchRemote( path:String ) = Future[Stream[String]] { ... reading from file system ... }
} 
```

现在在我的测试中，我有来自 akka-testkit 的 TestActor。在这里，我想导入我的模拟依赖项：

```
implicit object RemoteFetcherMock extends RemoteFetcher {
   def fetchRemote( path:String ) = Future[Stream[String]] { ... mock implementation ... }
} 
```

我的问题是要编译 Services.scala 我需要导入隐式对象。但是我如何在我的测试文件中隐藏/覆盖它。我不使用隐式参数的原因是我想避免修改所有演员的构造函数参数。

当我环顾四周并阅读类型类依赖注入模式时，我根据教程让它工作，但是当我想像我的示例中那样测试和覆盖时，我没有让它工作。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-15T01:45:54.440

我不确定如何使用隐式来做到这一点，但通常可以像这样注入：

```
trait RemoteFetcherComponent {
  def remoteFetcher: RemoteFetcher
  trait RemoteFetcher {
    def fetch(path: String): Future[Stream[String]]
  }
}

trait RemoteFetcherFileSystemComponent extends RemoteFetcherComponent {
   val remoteFetcher = RemoteFetcherFileSystem
   object RemoteFetcherFileSystem extends RemoteFetcher {
     def fetch(path: String): Future[Stream[String]] = ???
   }
}

class MyRemoteResourceActor extends Actor with ActorLogging with RemoteFetcherFileSystemComponent {
  def fetchRemote(path: String) = remoteFetcher.fetch(path)
  def receive = {
     case FetchRemoteResource(path) => fetchRemote(path).map( _.foreach(sender ! _))
  }
}

val myRemoteResourceActor = new MyRemoteResourceActor() 
```

然后将定义一个测试值，如下所示：

```
trait RemoteFetcherMockComponent extends RemoteFetcherComponent {
  def remoteFetcher = RemoteFetcherMock
  object RemoteFetcherMock extends RemoteFetcher {
    def fetch(path: String): Future[Stream[String]] = ???
  }
}

val myMockedResourceActor = new MyRemoteResourceActor with RemoteFetcherMockComponent {
  override val remoteFetcher = super[RemoteFetcherMockComponent].remoteFetcher
} 
```

您遇到隐含问题的原因是因为您使用它的方式与简单地使用`def fetchRemote(path: String) = RemoteFetcherFileSystem.fetch(path)`. 通过导入，您已经定义了实现，而不是允许稍后注入。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-15T02:10:10.940

您还可以将 更改`implicitly`为隐式参数：

```
trait RemoteFetcher {
  def fetch(path: String): Future[Stream[String]]
}

object RemoteFetcher {
   implicit val fetcher = RemoteFetcherFileSystem
}

class MyRemoteResourceActor extends Actor with ActorLogging {
  def fetchRemote(path: String)(implicit remoteFetcher: RemoteFetcher) = remoteFetcher.fetch(path)
  def receive = {
     case FetchRemoteResource(path) => fetchRemote(path).map( _.foreach(sender ! _))
  }
} 
```

`RemoteFetcher`然后，您可以通过简单地导入来覆盖在伴随对象中解析的隐式`RemoteFetcherMock`。

有关隐式参数解析优先规则的更多信息，请参阅[这篇文章](https://stackoverflow.com/questions/8623055/scala-implicit-parameter-resolution-precedence)。

# php - 在函数中你可以返回一个空值来退出函数 PHP

> ID：14329845
> 
> 赞同：0
> 
> 时间：2013-01-15T01:36:40.117
> 
> 标签：php

我通过 ref 传递两个 var 来更改它们，一旦我更改了它们或（8 个循环）之一在我正在使用的字符串中找到了一个正数，我想退出该函数，但我不需要返回任何东西，因为它们是由 ref 传递的。

我可以只传递一个副本，然后引用另一个副本，并将复制 = 的那个的 var 设置为函数并返回它，但是有没有一种更简洁的方法，我只调用函数，设置 var 并且我可以继续吗？

```
function get_cat_size($urlstr, &$cat, &$size){ return null; };

$cat = get_cat_size($urlstr, &$size); 
```

第一个有效还是无效？女巫的可读性更好？

感谢您的输入！

```
while( $i < $countz )
    {
    $pos = strpos($outdoor, $outdoor[$i]);
    if($pos != false)
    {
        $cat = $outdoorID;
            while( $j < $sizeArrayCount)
            {
            $poz = strpos($outdoor, $outdoor[$i]);
            if($poz != false)
            {
                $size = $outdoorID;
                return;
            }
            $j++;
            }
        return;
    }
    $i++;
    } 
```

^ 所以这应该可行，是的，不是的，也许是这样？

所以这是按顺序设置的 8 个循环之一，因为它们是最不重要的，不同的 var = 不同的商店。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-15T01:39:37.723

You can just return without a value:

```
function returnsNothing (&$a, &$b) {
    return;
} 
```

Or simpler just omit the return statement at all

```
function returnsNothing (&$a, &$b) {
    // do something
} 
```

Both snippets will make the function returning NULL.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-15T01:39:44.683

Take a look at [`break`](http://php.net/manual/en/control-structures.break.php) for returning out of your `for` loops.

I would personally avoid returning `null` within a function since `NULL` will be returned by default when there is no `return` value specified. You can read more here at [PHP: Returning values](http://php.net/manual/en/functions.returning-values.php)

# rspec - 多租户和 rspec

> ID：14329846
> 
> 赞同：0
> 
> 时间：2013-01-15T01:36:47.600
> 
> 标签：rspec, factory-bot, multi-tenant

我仍然熟悉 RSpec，并且在为我的多租户应用程序设置测试时遇到了一些问题。

该应用程序适用于：

client1.example.com

client2.example.com

ETC....

在我的 RSpec 中，我正在执行以下操作：

```
let(:tenant) { FactoryGirl.create(:tenant, subdomain: "client1") }
let(:root_path) { "http://client1.example.dev:3000" }

before {
  tenant.save
  visit root_path
}

describe "header" do
   it "should have the right title" do
     page.should have_selector('title', :text => tenant.name)
   end
end 
```

我在这里做了一些感觉不对的事情，但不确定最好的方法是什么。

1.  我正在对 root_path 进行硬编码。做类似的事情`visit '/'`是行不通的，因为测试不知道正确的子域是什么。这个可以吗？

2.  我不知道为什么，但我必须在每次测试之前执行tenant.save，以便测试能够真正根据子域找到租户。如果我删除tenant.save，我会得到一个`Couldn't find Tenant with subdomain = client1`错误。我以为 FactoryGirl.create 实际上保存到数据库中？

谢谢您的帮助！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-15T01:51:53.670

1：似乎这是必要的，我认为没有办法只指定子域。

2：是的，`create`保存到数据库中（虽然`build`没有）。然而，RSpec`let`是惰性的——它只在第一次调用时进行评估。

这意味着如果没有租户，直到发生 - 通话之后`tenant.save`才会创建租户，所以为时已晚。`page.should have_selector('title', :text => tenant.name)``visit`

幸运的是，RSpec 还提供了`let!`一个急切的版本`let`，所以如果你使用它，你就不需要块`tenant.save`中的。`before`

# c++ - 特定对象 (ROI) 的立体对应和 3D 位置

> ID：14329847
> 
> 赞同：1
> 
> 时间：2013-01-15T01:36:47.947
> 
> 标签：c++, opencv

除了获取其在右图中的位置之外，我还对在给定左图像中的位置和 ROI 的情况下获取特定对象的 3D 位置（使用立体视觉）感兴趣。

我在网上找到的只是如何使用 (StereoBM::operator()/cvFindStereoCorrespondenceBM) 获取视差图。

方法是什么？如何获得该对象的差异？获得视差图后是否有直接的方法，或者我应该首先在正确的图像中匹配对象以获得视差？

你能推荐一个好的算法来匹配对象吗？请在答案中包含代码。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-06T10:11:57.137

您的任务包含以下步骤：

1) 相机校准
2) 提取特征（手动或通过算法。例如 - SURF、SIFT）；
3) 匹配特征（由您决定。OpenCV 有一个蛮力匹配器）
4) 基本矩阵和单应矩阵估计
5) 校正（OpenCV 立体匹配器仅适用于校正后的图像）
6) 视差图
7) 基于您的相机模型的三角测量（可能不是针孔）

这些带有代码的书籍提供了很好的解释：
1）Robert Laganière 的 OpenCV 2 计算机视觉应用程序编程食谱
2）Gary Bradski 的学习 OpenCV
3）Boguslaw Cyganek 和 J. Paul Siebert 的 3D 计算机视觉技术和算法简介

希望能帮助到你！=)

# jquery - ie9 更改 div 内容时出错

> ID：14329852
> 
> 赞同：0
> 
> 时间：2013-01-15T01:37:14.437
> 
> 标签：jquery, html, ajax, internet-explorer-9

该页面适用于 firefox、chrome 和 safrie。仅在 ie9 中中断

SCRIPT65535：对方法或属性访问的意外调用。jquery-1.5.1rc1.js，第 5093 行字符 5

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-15T01:46:25.987

如果您打算使用 jQuery，请充分利用它。删除每个节点上的`onmouseclick`和`onmouseover`事件。`<a>`并添加以下代码：

```
$(document).ready(function() {
    $('.vids').click(function(){
        var cv = $(this).attr('alt');
        var url = "random.php";
        $.post(url, {contentVar: cv}, function(data) {
            $("#myElement").html(data).show();
        });
    });
}); 
```

`<a>`节点需要具有特定 vid 和 class 的 alt属性`vids`。例如：

```
<a href="#" class="vids" alt="vid1"><img>blabla</img></a>
<a href="#" class="vids" alt="vid2">
<a href="#" class="vids" alt="vid3"> 
```

你明白了

# image - 如何处理博客提要中的图像？

> ID：14329858
> 
> 赞同：0
> 
> 时间：2013-01-15T01:37:57.293
> 
> 标签：image, rss, feed

这似乎是一件基本的事情，但我在网络上没有看到明显的最佳实践。

1.  在博客提要中包含图像的最佳方式是什么，以及
2.  解析提要并在不同域的网页上提供图像的最佳方法是什么？

任何答案都会很棒。谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-15T02:12:03.573

“处理”图像的两种可能方式：附件和描述标签的正文。如果它们是大图像，请使用附件。如果它们很小，请将它们嵌入到描述标签中并将其内容类型设置为 html。

然而，“大”和“小”之间的界限似乎是任意的。

# android - Android EditText - Text overlay issue

> ID：14329870
> 
> 赞同：0
> 
> 时间：2013-01-15T01:39:27.527
> 
> 标签：android, android-edittext, overlay

I am seeing a weird bug in my app and I was wondering if someone could help me fix it. I have a simple EditText with some existing Text, if I move the cursor to the top and hit the Enter key it moves the first line down and on top of the second line. I made a video to help with the visual of what I am seeing:

[https://www.youtube.com/watch?v=vJfTDjBxdT4&feature=youtube_gdata_player](https://www.youtube.com/watch?v=vJfTDjBxdT4&feature=youtube_gdata_player)

The phone is a stock Samsung Galaxy Nexus. I have tried to change the InputType to various other things but they all see to have the same issue. Here is the layout:

```
<EditText
    android:id="@+id/editor_text"
    android:layout_width="fill_parent"
    android:layout_height="0dip"
    android:layout_marginLeft="10dp"
    android:layout_marginRight="10dp"
    android:layout_weight="0.72"
    android:gravity="top"
    android:inputType="textMultiLine|textCapSentences|textAutoCorrect"
    android:singleLine="false" >
</EditText> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-15T17:51:32.993

这是硬件加速的果冻豆问题，这里是谷歌链接：

[http://code.google.com/p/android/issues/detail?id=38770](http://code.google.com/p/android/issues/detail?id=38770)

我验证了使用软件层为我解决了这个问题。

# ruby-on-rails - 渲染无法在rescue_from ActiveRecord::Rollback 方法中渲染正确的模板

> ID：14329877
> 
> 赞同：1
> 
> 时间：2013-01-15T01:39:50.940
> 
> 标签：ruby-on-rails, ruby-on-rails-3, exception-handling, transactions, rails-activerecord

我正在为电子商务网站构建结帐页面，并且我有一个相当长的事务，它创建了一个新的用户模型和一个新的订单模型。我将这些模型的创建包装在一个事务中，这样如果一个验证失败，另一个就不会在数据库中徘徊。这是我的 OrdersController 中的精简代码：

```
rescue_from ActiveRecord::Rollback, with: :render_new

def render_new
  render action: 'new'
end

ActiveRecord::Base.transaction do
  @user = User.new params[:user]
  unless @user.save
    raise ActiveRecord::Rollback
  end
  //More stuff
  ...
  @order = Order.new params[:order]
  ...
  unless @order.save
    raise ActiveRecord::Rollback
  end
end 
```

我看到的错误是这样的：

> 缺少模板订单/创建，使用 {:locale=>[:en], :formats=>[:html], :handlers=>[:erb, :builder, :coffee]} 的应用程序/创建

我很困惑为什么它试图呈现模板订单/创建和应用程序/创建而不是呈现订单/新。

有没有更好的方法来强制事务失败以便发生回滚？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-15T01:48:47.570

我认为将事务包装在开始/救援块中时，意图更加清晰。

```
def create
  begin 
    ActiveRecord::Base.transaction do
      @user = User.new params[:user]
      unless @user.save
        raise ActiveRecord::Rollback
      end
      //More stuff
      ...
      @order = Order.new params[:order]
      ...
      unless @order.save
        raise ActiveRecord::Rollback
      end
    end
  rescue ActiveRecord::Rollback
    render action: "new" and return
  end
end 
```

你需要在方法中**返回**`create`，否则它会一直执行到方法的末尾，并且会发生 Rails 默认渲染*（在这种情况下，它意味着试图找到一个`create.___`模板）*。

如果您不喜欢开始/救援块，您可以在行中`and return`添加`raise`一个

```
raise ActiveRecord::Rollback and return 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-04-16T08:33:20.300

上面的答案是正确的，但是渲染动作需要一些修改。

像这样做：-

```
def create
    is_project_saved = false
    is_proposal_saved = false

    ActiveRecord::Base.transaction do
      is_project_saved = @project.save
      is_proposal_saved = @proposal.save
      if is_project_saved && is_proposal_saved
        # Do nothing
      else
        raise ActiveRecord::Rollback
      end
    end

    if is_project_saved && is_proposal_saved
      # You can add more nested conditions as per you need.
      flash[:notice] = "Proposal Created Successfully."
      redirect_to project_show_path(:job_id => @project.job_id)
    else
      render :new
    end
end 
```

**ActiveRecord::Rollback**不会被 resque 捕获。所以它需要在事务块之外完成。

`:requires_new => true`您还可以在嵌套中使用 save_point `ActiveRecord::Base.transaction`。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-03-01T19:35:01.117

您需要提高 ActiveRecord::Rollback 并根据需要管理渲染/重定向。正如@WasimKhan 所说，ActiveRecord::Rollback 不会被救援捕获。

```
def create
  @user = User.new params[:user]
  ActiveRecord::Base.transaction do
    if @user.save
      @order = Order.new params[:order]
      if @order.save
        redirect_to :index
      else
        raise ActiveRecord::Rollback
      end
    else
      render :new
    end
  end
  render :new if @user.id.nil?
end 
```

# hadoop - Mahout 集群中的 CPU 利用率

> ID：14329883
> 
> 赞同：0
> 
> 时间：2013-01-15T01:40:13.240
> 
> 标签：hadoop, cpu, cluster-analysis, mahout

我使用 mahout 进行文本聚类

我的电脑设备和软件在下面

服务器：
CPU：Intel Xeon E5-2620 2GHz，内存：64GB

软件：
VirtualBox 上的 ubuntu-12.4.1
hadoop-1.0.4、mahout-0.7

我使用树冠算法来聚类 80000 txt。但是它运行时间很长，只需要两三个星期就可以完成，但我发现 CPU 利用率只有 20% 以下。

我发现有人也有这个问题， http: [//mail-archives.apache.org/mod_mbox/mahout-user/201212.mbox/%3C7959565186420075099@unknownmsgid%3E#archives](http://mail-archives.apache.org/mod_mbox/mahout-user/201212.mbox/%3C7959565186420075099@unknownmsgid%3E#archives)

但是我仍然不知道如何加速它，另一方面，我是否丢失了一些参数设置？还是服务器没有强大的功能来运行这个工作？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-15T07:37:54.307

Hadoop 和 Mahout 适用于**多台计算机**。在单个主机上，针对此类操作优化的软件可能会快得多。

Hadoop（和 Mahout）管理太大而无法放入单个计算机内存的数据。这需要将数据存储在文件中并通过网络传输到其他主机。

现在，如果您采用这种方法 - 重复写入中间结果 - 而无需这样做，那么您当然会比在内存中执行所有操作要慢。

由于您的 CPU 未完全使用，您可能会猜到其他地方一定存在瓶颈。看看你的磁盘 IO。这可能是目前您的限制因素。

# php - web scrape using preg_match_all

> ID：14329892
> 
> 赞同：0
> 
> 时间：2013-01-15T01:41:16.413
> 
> 标签：php, html-parsing, web-scraping

I'm trying to get the contact information from this site [http://www.internic.net/registrars/registrar-967.html](http://www.internic.net/registrars/registrar-967.html) using PHP.. I was able to get the e-email ad by using the href links by doing this:

```
$contactStr = "http://www.internic.net/registrars/registrar-967.html";
                $contact_string = file_get_contents("$contactStr");
                preg_match_all('/<a href="(.*)">(.*)<\/a>/i', $contact_string, $contactInfo);
                $email = str_replace("mailto:", "", $contactInfo[1][6]); 
```

However, I'm having a hard time getting the address and the phone # since there's no html element I can use like < p > maybe.. I just need 1800 SW First Ave., Suite 440 Portland OR 97201 United States and 310-467-2549 from this site.. Please enlighten me on how to do this using preg_match_all or some other ways possible.. Thanks!

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-15T02:15:08.980

正如其他人在评论中所说，不要使用正则表达式尝试[DOMDocument 。](http://www.php.net/domdocument)

这是一个例子（有点hacky tho）希望它有所帮助：

```
function get_register_by_id($id){
    $site = file_get_contents('http://www.internic.net/registrars/registrar-'.$id.'.html');
    $dom = new DOMDocument();
    @$dom->loadHTML($site);
    $result = array();
    foreach($dom->getElementsByTagName('td') as $td) {
        if($td->getAttribute('width')=='420'){
            $innerHTML= '';
            $children = $td->childNodes;
            foreach ($children as $child) {
                $innerHTML .= trim($child->ownerDocument->saveXML($child));
            }
            $fixed = array_map('strip_tags', array_map('trim', explode("<br/>",trim($innerHTML))));
            foreach($fixed as $val){
                if(empty($val)){continue;}

                $result[] = str_replace(array('! '),'',$val);
            }
        }
    }
    return $result;
}

print_r(get_register_by_id(965));
/*Array
(
    [0] => Domain Central Australia Pty Ltd.
    [1] => Level 27
    [2] => 101 Collins Street
    [3] => Melbourne Victoria 3000
    [4] => Australia
    [5] => +64 300 4192
    [6] => robert.rolls@domaincentral.com.au
)*/
print_r(get_register_by_id(966));
/*
Array
(
    [0] => Web Business, LLC
    [1] => PO Box 1417
    [2] => Golden CO 80402
    [3] => United States
    [4] => +1.303.524.3469
    [5] => support@webbusiness.biz
)*/

print_r(get_register_by_id(967));
/*
Array
(
    [0] => #1 Host Australia, Inc.
    [1] => 1800 SW First Ave., Suite 440
    [2] => Portland OR 97201
    [3] => United States
    [4] => 310-467-2549
    [5] => registry-operations@moniker.com
)*/ 
```

# iphone - 为未经身份验证的 iPhone 应用程序提供自定义令牌

> ID：14329894
> 
> 赞同：1
> 
> 时间：2013-01-15T01:41:49.480
> 
> 标签：iphone, ruby-on-rails-3, json, devise

我目前正在为 iphone 应用程序构建 Rails 后端。iphone 访问特殊控制器，该控制器返回 iphone 应用程序解析并适当显示的 JSON。Rails 应用程序确实有一个管理面板，用于为 iphone 应用程序插入新数据。该身份验证由设计控制。除此之外，无需进行复杂的身份验证，因为 iphone 应用程序不需要任何用户信息即可运行。

这是我卡住的地方。我添加了一个控制器，用户可以在其中提交来自应用程序的反馈。该反馈将存储在 Rail 的数据库中。为了做到这一点，我已经关闭`protect_from_forgery`了使用`skip_before_filter :verify_authenticity_token, :only => [ :create ]`该控制器方法。但是通过这样做，我知道这会产生安全问题。[我也明白我必须根据这个答案](https://stackoverflow.com/a/8292244/1323305)和[这个答案](https://stackoverflow.com/a/10049965/1323305)创建自定义保护（例如令牌）。我的网络搜索只找到了如何使用 Devise 或通过 Oauth 执行此操作，但正如我所提到的，iphone 没有用户身份验证。我想做的就是打开这个安全漏洞，除非我遗漏了什么。我很难找到任何关于这种特殊情况的文章。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-15T04:44:53.890

默认情况下，带有`:protect_from_forgery`on 的 Rails 应用程序在有关页面的信息中包含一个真实性令牌`<meta>`，如下所示：

```
<meta content="arBBP614zvMxug9+5ozHakrXhAaTNmQ9aBJ/Ehp3nl8=" name="csrf-token"> 
```

你需要做的是下载你的表单的一个普通的旧 html 副本，`:protect_from_forgery`打开，这样就生成了这个标签。然后，一旦您在 a 中拥有该 HTML，`NSString*`您就可以像这样找到令牌：

```
 NSArray* firstArray = [htmlString componentsSeparatedByString:@"\" name=\"csrf-token\">"];
    NSArray* secondArray = [[firstArray objectAtIndex:0] componentsSeparatedByString:@"<meta content=\""];
    NSString* authToken = [secondArray objectAtIndex:1]; 
```

然后你只需要`authToken`作为`X-CSRF-Token`标题字段发送。这些通常不会经常更改，因此您可以保留一份副本一段时间。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-18T17:06:44.350

我最终想出了一个我选择的令牌。我设置控制器以使用`before_filter`. 然后用 SSL 锁定它。

```
before_filter :has_token?, only: :create
skip_before_filter :authenticate_user!, :verify_authenticity_token, only: :create 
```

这是我用来检查令牌的方法：

```
def has_token?
  if request.request_parameters[:token] == "SECRET"
    true
  else
    head :unauthorized
  end
end 
```

然后令牌被硬编码到 iPhone 应用程序中，并与它发送到 Rails 后端的参数一起传递。我知道这意味着如果该令牌必须更改，我必须发布新版本的 iPhone 应用程序，但这样我可以更好地控制正在发生的事情。

# java - 将 char 转换为字符串时会发生什么？（爪哇）

> ID：14329898
> 
> 赞同：0
> 
> 时间：2013-01-15T01:42:34.783
> 
> 标签：java, string, char

> **可能重复：**
> [如何比较 Java 中的字符串？](https://stackoverflow.com/questions/513832/how-do-i-compare-strings-in-java)

我正在使用 String.valueOf 将 char 转换为字符串。但是返回值似乎与同一个字母的字符串不完全相同。以下代码：

```
 String myString = "s";
    char myChar = 's';//both string and char are assigned as letter 's'

    String stringFromChar = String.valueOf(myChar);

    if (myString == stringFromChar) {
        out.println("equal");
    } else {
        out.println("not equal");
    } 
```

每次打印不相等。请帮忙，谢谢！:)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-15T01:47:06.153

`==`比较参考值，而不是实际值。您必须使用`equals`来比较值。

如果您不明白，请阅读这篇[文章，它清晰而简单。](http://www.programmerinterview.com/index.php/java-questions/java-whats-the-difference-between-equals-and/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-15T01:45:48.960

永远不要再这样做了！！！答应我！！！=P

在比较字符串时，总是，总是，总是使用 equals 方法。见下文！

```
 String myString = "s";
    char myChar = 's';//both string and char are assigned as letter 's'

    String stringFromChar = String.valueOf(myChar);

    if (myString.equals(stringFromChar)) {
        System.out.println("equal");
    } else {
        System.out.println("not equal");
    }
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-15T01:50:36.447

> 将 char 转换为字符串时会发生什么？

好吧，您正在使用该`String.valueOf(char)`方法，其 javadoc 没有*说明*它是如何进行转换的。但是您看到的行为强烈表明您使用的 JVM`String`每次调用该方法时都会创建一个新对象。

但是您应该依赖于这种情况。

底线是您*应该始终*使用该`equals`方法来比较字符串。将字符串与 进行比较`==`通常会给您带来误报……取决于字符串的创建/获取方式。你刚刚被那个咬了。学习。

参考：

*   [如何比较 Java 中的字符串？](https://stackoverflow.com/questions/513832/how-do-i-compare-strings-in-java)

# hadoop - 使用 Hadoop MapReduce 按月和 IP 对日志条目进行分组

> ID：14329900
> 
> 赞同：2
> 
> 时间：2013-01-15T01:42:40.787
> 
> 标签：hadoop, mapreduce

我对 Apache Hadoop 真的很陌生。但是我想学习如何使用它来总结我的机器日志。实际上它还不够大（GB），我可以解析它并等待几个小时。但我认为学习 Hadoop 可能会有用。

所以，我有一个格式如下的日志条目。

```
Location, Date, IP Address 
```

例如

```
New York, 2011-11-31 10:50:59, 1.1.1.1
New York, 2011-11-31 10:51:01, 1.1.1.2
Chicago, 2011-11-31 10:52:02, 1.1.1.1
Los Angeles, 2011-11-31 10:53:04, 1.1.1.4 
```

我想按位置聚合它，按月份分组，然后按 IP 地址。下面是我脑海中的一些东西。

```
 Location, Month, IP,   Count
+ New York
|   +-- November 2011
|   |     +---- 1.1.1.1    5
|   |     +---- 1.1.1.2    2
|   |     +---- 1.1.1.3    7
|   +-- December 2011
|   |     +---- 1.1.1.1    6
|   |     +---- 1.1.1.4    6
|   +-- January 2012
|         +---- 1.1.1.1   10 
+ Chicago 
|   +-- November 2011
|   |     +---- 1.1.1.1   20
|   |     +---- 1.1.1.2    1
|   |     +---- 1.1.1.3   10
(so on) 
```

我的问题是：

1.  我可以使用 Hadoop 来做到这一点，还是有更好的方法来做到这一点？
2.  使用 Hadoop 执行此操作的常用方法是什么？

感谢您提供指向链接或文章或示例代码的指针。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-15T02:27:28.877

```
can I do this using Hadoop or is there a better way to do it? 
```

您绝对可以为此使用 Hadoop，如果您只有几个 Gbs，则可能没有必要，但是使用 Hadoop 进行此操作的好处是您将能够轻松**扩展**，假设明天您必须在500Gb，你的代码可能没有任何改变，只有硬件和配置。

```
what is the common way to do this using Hadoop? 
```

我认为没有“通用方式”可以这么说，Hadoop 是一个封装多个项目的框架，您可以在 Map/Reduce、Hive、Pig 中做到这一点......

我认为您的用例非常适合使用 Hive 执行此操作，因为您想要进行聚合并拥有可以轻松将其放入表的结构，并且如果您是 Hadoop 新手，您可以熟悉 SQL，所以这里有一些提示。

1.  将这些日志上传到 HDFS。无论您希望如何进行处理，这都是所需的第一步，HDFS 是一个分布式文件系统，因此您的日志将在集群中分割成块并进行复制。

    ```
    hadoop fs -put /path/to/your/log/directory /user/hive/warehouse/logs 
    ```

2.  在 Hive 中创建一个表。您必须将其设置在您将日志放入 HDFS 的位置之外（并指定文件中的分隔符）：

    ```
    hive -e "create external table logs(location string, day string, ip string) row format delimited fields terminated by ',' location /user/hive/warehouse/logs" 
    ```

3.  现在您可以对您的数据进行一些查询！在您的示例中，您应该执行以下操作：

    ```
    hive -e "select location, month(day), ip, count(*) from logs group by location, month(day), ip order by location, month, ip" 
    ```

    请注意，我`MONTH()`在当天调用以增加一天中的月份部分以进行聚合，这就是 Hive 所说`UDF`的 s。

即使您正在编写 SQL 查询，这也会在后台生成 Map/Reduce 作业，这些作业将在您的集群上运行，因此您的作业将根据集群的大小进行扩展。

我希望这是有道理的，如果您想了解有关 Hive 的更多详细信息，我想将您重定向到[Hive DDL 描述](https://cwiki.apache.org/Hive/languagemanual-ddl.html)以及[官方项目页面](http://hive.apache.org/)。

# android - Background resource not found

> ID：14329903
> 
> 赞同：0
> 
> 时间：2013-01-15T01:42:53.677
> 
> 标签：android, android-relativelayout

I'm getting this error log from google and I don't know what's causing it. This resource is in the folder that it says that it's not. I have never ran into this error myself. Here's the error:

```
android.content.res.Resources$NotFoundException: File res/drawable-mdpi/notebook_ul.jpg from drawable resource ID #0x7f020090
at android.content.res.Resources.loadDrawable(Resources.java:1714)
at android.content.res.Resources.getDrawable(Resources.java:581)
at android.view.View.setBackgroundResource(View.java:7391)
at com.bfreq.dice.fragments.SettingsFrag.onCreateView(SettingsFrag.java:76)
..............................
Caused by: java.lang.NullPointerException......... 
```

Here's me calling the resource in my fragment

```
@Override
    public View onCreateView(LayoutInflater inflater, ViewGroup container,
            Bundle savedInstanceState) {
        // TODO Auto-generated method stub
        View v = inflater.inflate(R.layout.settings, container, false);

        // Initializing Background
        rLayout = (RelativeLayout) v.findViewById(R.id.relativeLayout_Settings);
        switch (background) {
        case 0:
            rLayout.setBackgroundResource(R.drawable.clay_ul);
            break;
        case 1:
            rLayout.setBackgroundResource(R.drawable.parchment_ul);
            break;
        case 2:
            rLayout.setBackgroundResource(R.drawable.brownpaper_ul);
            break;
        case 3:
            rLayout.setBackgroundResource(R.drawable.notebook_ul);
            break;
        case 4:
            rLayout.setBackgroundColor(Color.WHITE);
            break;
        }
            ........
            return v;
        } 
```

I Also call it from a method. Now I know that I'm not suppose to talk directly from one fragment to another but it's been working with no problem and haven't had time to rewrite everything.

```
public void setBackground() {

    switch (background) {
    case 0:
        SettingsFrag.rLayout.setBackgroundResource(R.drawable.clay_ul);
        DiceFrag.rLayout.setBackgroundResource(R.drawable.clay_uc);
        DiceLogFrag.rLayout.setBackgroundResource(R.drawable.clay_ur);
        break;
    case 1:
        SettingsFrag.rLayout.setBackgroundResource(R.drawable.parchment_ul);
        DiceFrag.rLayout.setBackgroundResource(R.drawable.parchment_uc);
        DiceLogFrag.rLayout.setBackgroundResource(R.drawable.parchment_ur);
        break;
    case 2:
        SettingsFrag.rLayout.setBackgroundResource(R.drawable.brownpaper_ul);
        DiceFrag.rLayout.setBackgroundResource(R.drawable.brownpaper_uc);
        DiceLogFrag.rLayout.setBackgroundResource(R.drawable.brownpaper_ur);
        break;
    case 3:
        SettingsFrag.rLayout.setBackgroundResource(R.drawable.notebook_ul);
        DiceFrag.rLayout.setBackgroundResource(R.drawable.notebook_uc);
        DiceLogFrag.rLayout.setBackgroundResource(R.drawable.notebook_ur);
        break;
    case 4:
        SettingsFrag.rLayout.setBackgroundColor(Color.WHITE);
        DiceFrag.rLayout.setBackgroundColor(Color.WHITE);
        DiceLogFrag.rLayout.setBackgroundColor(Color.WHITE);
        break;
    }
} 
```

I make sure whenever I call that method that it won't return a null pointer. Any ideas would be great. I can also put more code up if someone wants to see it. Thanks!

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-15T01:46:35.647

当我为特定 dpi（即 hdpi、xhdpi ...）创建一个资产时，我得到了这个，确保您的可绘制对象在`drawable/`、`drawable-hdpi/`、`drawable-mdpi/`等中可用。您可能在一个`drawable`目录中创建了一个可绘制对象，但不是在那个目录中当前仿真器/设备正在从中提取。

# javascript - 点击事件重复 4 次

> ID：14329906
> 
> 赞同：1
> 
> 时间：2013-01-15T01:43:20.793
> 
> 标签：javascript, jquery

## 我的代码

```
var post = {};
post.DivPostContent = $('.content');
post.DivPostContent.live({
    mouseenter:
        function()
        {
            var post_id = $(this).attr('data-post_id');
            var content_id = $('#content' + '_' + post_id);
            var link = $('#link' + '_' + post_id);
            content_id.find('.post_ratings').hide();
            content_id.find('.post_actions').show();
            //I removed the click event on a whim, i have no clue why it works
            link.unbind('click');
            link.click(function(){
                post.link_action(post_id);

            });

        },
    mouseleave:
        function()
        {
            //does something

        }
});

post.link_action = function(){
//Does some Ajax request
} 
```

在我从“链接”中解绑点击事件之前，它四次调用“post.link_action”，我试图弄清楚它为什么这样做。在一遍又一遍地阅读我的代码几个小时后，我心想，让我们尝试删除点击事件，我错误地将那行放在错误的位置（我猜是出于沮丧）。我运行了代码，中提琴！有效！如何？我没有线索。

现在我的问题是，为什么在添加单击事件之前取消绑定单击事件会阻止该过程重复自身？我真的很想知道为什么。谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-15T01:49:38.157

因为每次您的鼠标进入对象 post.DivPostContent 时，它都会将一个新的点击事件绑定到您的链接对象；它触发了 4 次，因为您将鼠标悬停了 4 次。

忘记 .live & .click; 改用 .on 并在 mouseenter 事件之外绑定一次，或者如果您坚持在其中绑定它，请在之前使用 .off

```
 $elem.off("click").on("click",function() {}); 
```

但是在你的mouseenter之外做一次

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-15T01:53:34.740

> 现在我的问题是，为什么在添加单击事件之前取消绑定单击事件会阻止该过程重复自身？

编码：

```
link.click(function(){
    post.link_action(post_id);
}); 
```

`click`如果您多次注册，则向事件添加回调，例如在您的情况下`onmouseenter`，您最终将多次触发相同的事件。

该`unbind`函数会删除任何先前对特定事件的回调，因此这就是回调只触发一次的原因。

By the way, unless your jQuery version is 1.4.3 or less you shouldn't be unsing `live`.
Use `on` which is available from version **1.7** ore `delegate` which is avaiable from version **1.4.4.**

# javascript - Assign a Function Argument with a Loop

> ID：14329907
> 
> 赞同：1
> 
> 时间：2013-01-15T01:43:23.320
> 
> 标签：javascript, function, loops, arguments

I have an array of list items in a piece of Javascript code. I would like to assign an onclick event handler to each one. Each handler would be the same function, but with a different input argument. Right now I have:

```
function contentfill(i) {
    box = document.getElementById("text");
    box.style.background="rgba(0,0,0,0.8)";
    var content = new Array();
    contentdivs = document.querySelectorAll("#contentfill>div");
    box.innerHTML = contentdivs[i].innerHTML;
}
li[3].onclick = function() {contentfill(0);};
li[4].onclick = function() {contentfill(1);};
li[5].onclick = function() {contentfill(2);}; 
```

This works well enough, but I would like to achieve the same thing with a loop, for example:

```
for(i=3;i<=5;i++) {
    j=i-3;
    li[i].onclick = function() {contentfill(j);};
} 
```

This, however, does not work. Since j seems to be defined as 2 at the end of the loop, each time I click, it only seems to call contentfill(2).

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-15T02:19:00.550

对于另一种方法，请考虑让每个元素都知道它应该使用什么参数。

```
for (var i = 0; i < 3; i++) {
    var el = li[i + 3];
    el.dataset.contentIndex = i;
    el.addEventListener('click', contentfill);
} 
```

当然，然后`contentfill`必须从中提取论点`.dataset`而不是进行论点。（这与 jQuery 的机制相同`$.data`。）

我更喜欢这个，因为（a）它不会生成大量微小的包装，（b）它允许我稍后检查并可能更改“参数”，并且（c）它允许我在文档中使用`data-`属性预定义它们. 有效地将它们从函数参数更改为行为。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-15T01:52:29.053

的值`i - 3`应该绑定到点击处理函数；闭包可以提供此功能：

```
li[i].onclick = (function(j) {
    return function() {
        contentfill(j);
    }
)(i - 3)); 
```

[`addEventListener`](https://developer.mozilla.org/en/docs/DOM/element.addEventListener)顺便说一句，使用或[`attachEvent`](http://msdn.microsoft.com/en-us/library/ms536343%28VS.85%29.aspx)注册点击处理程序是更好的做法。

# javascript - 检索输入文本值

> ID：14329908
> 
> 赞同：0
> 
> 时间：2013-01-15T01:44:00.400
> 
> 标签：javascript, html

对于以下 HTML

```
<form>
    Enter hash here: <input type="text" name="hash">
       <button type="submit" formaction="/tasks/">Retrieve Url</button>
</form> 
```

如何将用户重定向到`/tasks/A`where `A`= 用户在“哈希”`<input>`框中输入的内容？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-15T01:53:51.920

看看[这篇文章](https://stackoverflow.com/questions/11563638/javascript-get-input-text-value)会有所帮助。

它与示例完全相同。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-15T01:49:17.777

您需要阻止提交的默认操作[( `event.preventDefault();`)](http://api.jquery.com/event.preventDefault/)，或者将按钮从 更改`type="submit"`为`type="button"`，然后使用 JavaScript 设置表单的操作。这是一些可以为您完成工作的jQuery：

```
$('button').click(function() {
    //set the form action
    $('form').attr('action', '/tasks/'+$('input[type="text"]').val())
    //submit the form
    .submit();
}); 
```

[请参阅http://jsfiddle.net/jhfrench/BQ8MW/](http://jsfiddle.net/jhfrench/BQ8MW/)上的工作示例

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-01-15T01:51:16.063

您可以使用临时帖子并重定向。例如：

```
<?php
if(isset($_POST['hash'])){
header("Location:/tasks/" . $_POST['hash']);
}
?> 
```

或者，如果您愿意，可以使用 AJAX 收集值，然后在不刷新的情况下重定向。

# eclipse - 如何更改 Eclipse 调试视图字体？

> ID：14329911
> 
> 赞同：2
> 
> 时间：2013-01-15T01:44:36.220
> 
> 标签：eclipse

什么字体偏好驱动 Eclipse 调试视图字体？我觉得我已经尝试了所有有意义的方法（包括 Debug 下的那些），但似乎都没有改变它。

如果重要的话，我在 OSX 10.8.2 上使用 Eclipse 4.2.1。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2015-08-10T10:59:09.623

在 Eclipse 中无法更改用于 Package Explorer、Debug View 和其他此类视图的字体。您只能更改编辑器视图的字体。这是 Eclipse 开发人员的政策决定。使用的字体是您使用的任何桌面的一般外观设置的字体。

在 Windows 7 上，您可以通过以下方式影响许多 eclipse GUI 字体，包括调试视图和项目资源管理器：

控制面板 -> 个性化 -> 窗口颜色和外观 -> 高级外观设置

更改“消息框”的字体大小。

当然，这会与您操作系统中其他东西的外观相混淆，但我发现与眯着眼睛看调试视图相比，这是可以忍受的......

# mongodb - 索引的顺序在 MongoDB 中重要吗？

> ID：14329912
> 
> 赞同：2
> 
> 时间：2013-01-15T01:44:40.490
> 
> 标签：mongodb

*MongoDB 开发人员提示和技巧*中的提示#25是否正确？

它说这个查询：

```
collection.find({"x" : criteria, "y" : criteria, "z" : criteria}) 
```

可以优化

```
collection.ensureIndex({"y" : 1, "z" : 1, "x" : 1}) 
```

我认为这是错误的，因为要使它起作用， x 应该在前面。我认为索引的顺序很重要。

那么我哪里做错了？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-15T01:57:13.677

仅当查询不包括索引中的所有字段时，索引中字段的顺序才重要。此查询引用所有三个字段，因此索引中字段的顺序无关紧要。

[在有关复合索引的文档中](http://docs.mongodb.org/manual/core/indexes/#compound-indexes)查看更多详细信息。

查询对象中字段的*顺序*`find`不相关。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2021-08-15T21:02:30.913

*   **对于想要更好地理解它的初学者**
*   Mongodb 说*索引包含对文档的引用，这些文档首先按 item 字段的值排序，在 item 字段的每个值中，按 stock 字段的值排序。”*这是什么意思？？？？
*   让我们按升序在字段 a、b、c 和 d 上创建复合索引 (1)

```
Model.createIndex({ a: 1, b: 1, c: 1, d: 1 }); 
```

*   我将其想象为：

    *   在第 1 级，根据第一个索引字段 (a) 的值按指定顺序 (1) 排序的参考列表
    *   在第 2 级，第 1 级的每个引用根据链 (b) 中第二个字段的值以指定的顺序 (1) 保存来自其位置的另一组引用。
    *   在第 3 层，第 2 层的每个引用根据链 (c) 中第二个字段的值以指定的顺序 (1) 保存来自其位置的另一组引用。
    *   在第 4 级，第 3 级的每个引用根据链 (d) 中第二个字段的值以指定的顺序 (1) 保存来自其位置的另一组引用。
*   该链形成一个树结构，因此被选择存储在`B-TREE data structure`.

*   在这种情况下，我很想将此存储系统称为 a `compound-index-chain`。

*   *通常我们建立索引来执行两种类型的操作`1\. Query Operation like find()`和`2\. Non-query operation like Sort()`*

*   现在您在`{ a: 1, b: 1, c: 1, d: 1 }`. 但仅创建索引是不够的。如果您不以使用这些索引的方式构建数据库操作（查找和排序），它就会变得低效甚至无用。

*   让我们深入挖掘一下什么样的查询支持什么样的索引？

*   **寻找（）：**

    *   以下`prefixes`复合索引还支持`find()`对字段的索引查询操作

    ```
    {a:1},
    {a:1, b:1},
    {a:1, b:1, c:1}
    // Index prefixes are the beginning subsets of indexed fields 
    ```

    *   **@JohnnyHK 已经说过*“查找查询对象中字段的顺序不相关。”***

        *   这些字段可以是任何顺序，例如 {b:1, a1} 而不是 {a1:, b:1}。只要在复合索引或复合索引的前缀上操作 find() 操作，仍将使用索引。
        *   但是，`performance`即使 find() 查询使用相同的索引并且正在使用索引，**如果 find() 中的字段顺序与其他后续字段相比不具有高度选择性**，则查询的结果将不一样（可能会降级） 。
        *   意思是，如果查询中的第一个字段说`find({a: 'red', b: tshrt})`has ，那么即使两个查询都使用一个 index `HIGH SELECTIVITY`，查询的效率也会低于`find({a: 'tshirt', b: 'red'})`这个查询 hs 。`LOWER SELECTIVITY``{a:1, b:1}`
        *   然而，HIGHLY SELECTIVE 查询将比根本没有任何索引执行得更好。
        *   我认为@Sushil 试图触及这个话题。
            *   如果您仍然想知道，`Query selectivity`是指查询谓词排除或过滤出集合中的文档的程度。查询选择性可以决定查询是否可以有效地使用索引，甚至可以完全使用索引。
    *   现在让我们来看看复合索引的前缀

    *   ***注意：`find()`复合索引 {a:1, b:1, c:1, d1} 的这个 {a:1, c:1} 前缀的行为与其其他前缀不同吗？***

    *   在这种情况下，`find()`操作将无法有效地利用我们的复合索引。

    *   发生的事情是`a:1 field`索引将只能支持查找查询。index on`c:1 field`根本不会被使用，因为由于前缀`compound-index-chain`中没有，所以在两者之间被打破了。`b:1 index field`

    *   因此，如果 find() 查询同时对 a 和 c 字段进行操作，则将`field a:1`使用 IXSCAN（即在 a 上使用索引）和`field c`COLLSCAN（即不使用索引）。意味着查询将比使用单独的复合索引要慢，`{a:1,c:1}`但比根本没有任何索引要快。

    *   结论是索引字段是按顺序解析的；如果查询省略了特定的索引前缀，则无法使用该前缀后面的任何索引字段。

*   **2.排序（）：**

    *   对于`non-query-operation(i.e Sort)`，在创建复合索引时，复合索引的子集必须相同`order of the index`，也必须位于`same or oposite direction`为每个字段指定的方向之一。

    *   让我们看看`{ a: 1, b: 1, c: 1, d: 1 }`带有升序方向的复合索引在 sort() 操作中的表现：

    *   让我们看一下索引字段在排序中的方向。

        *   正如我们所知，{a:1} 上的单个字段索引可以支持 {a:1} 同向和 {a:-1} 反向排序，
        *   复合索引在排序时遵循相同的规则。

        ```
        {a:1, b:1, c:1, d:1} // in same-direction as of our compound index
        {a:-1, b:-1, c:-1, d:-1 } // in reverse-direction of our compound index

        // But these field have neither same-direction nor reverse-direction but is ARBITARY/MIXED. Thus
        // Index will be discarded while performing sorting with these fields and directions
        {a:-1:, b:1, c:1, d:1} 
        ```

        *   另一个例子是`compound index on {a:1, b:-1}`可以支持在 {a:1,b:-1} (same-direction) 和 {a:-1,b:1}(reverse-direction) BUT 上的索引排序`NOT support {a:-1, b:-1}`。
    *   现在让我们看看索引字段在排序中的顺序

    *   **最佳排序：**

        *   当使用复合索引或使用复合索引的前缀进行排序操作时，不需要检查内存（RAM）中的结果集。这种排序操作仅满足索引中可用的字段，从而在排序操作中提供最佳性能。
        *   例如：

        ```
        // compound index
        {a:1, b:1, c:1, d:1}

        // prefix of the compound index
        {a:1},
        {a:1, b:1},
        {a:1, b:1, c:1} 
        ```

    *   **复合指数链断裂：**

    *   当一个排序操作被复合索引部分覆盖时，可能需要检查内存中的非索引匹配结果集。

    ```
    Model.find({ a: 2 }).sort({ c: 1 }); // will not use index for sorting using field c. But will be used for finding
    Model.find({ a: { $gt: 2 } }).sort({ c: 1 }); // will not use index for sorting But will be used for finding
    // because compound-index-chain-break due to absence of field b of the prefix {a:1, b:1, c:1} of our compound index {a:1, b:1, c:1, d:1} 
    ```

    *   **按非前缀子集排序：**

    *   当索引的前缀键同时出现在查询谓词（即 find()）和 sort() 中时，位于排序子集之前（或重叠）的索引字段必须具有相等条件（$eq,$gte,$lte ) 在查询中。所以

    *   复合索引也可以支持对其索引前缀的索引查询。

    ```
    Model.find({ c: 5 }).sort({ c: 1 }); // will not use index at all because it does not belongs to any of the prefix of our compound index
    Model.find({ b: 3, a: 4 }).sort({ c: 1 }); // will use the index for both finding and sorting as it belongs to one our index prexfix ie. {a:1, b:1, c:1}

    Model.find({ a: 4 }).sort({ a: 1, b: 1 }); // will use index for finding but not use index for sorting because a field is overlapped.
    Model.find({ a: { $gt: 4 } }).sort({ a: 1, b: 1 }); // will use index for both finding and sorting because overlapped field (a) in the predicate uses equality operator and it belongs to the prefix {a:1, b:1}

    Model.find({ a: 5, b: 3 }).sort({ b: 1 }); // will not use index for sorting
    Model.find({ a: 5, b: { $lt: 3 } }).sort({ b: 1 }); // will use index for both finding and sorting 
    ```

*   希望这可以帮助某人

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-15T07:41:02.870

# php - 如何使主键在php中的数据库中自动递增？

> ID：14329913
> 
> 赞同：1
> 
> 时间：2013-01-15T01:44:50.237
> 
> 标签：php, sql, phpmyadmin, auto-increment

我有一个数据库，我将数据放入其中。我有一个名为 key 的节点，它是主键和其他节点。现在，当我将数据放在我的表上时，我将数据放在除了这个关键节点之外的所有节点中。当我有新条目时，如何使其自动从 0 增加？如果我运行脚本将某些内容放入数据库中，我可以看到节点具有正确的所有数据并且键的值为 0。当我再次运行我的脚本时，我得到了错误：

```
Fatal error: Uncaught exception 'PDOException' with message 'SQLSTATE[23000]: Integrity constraint violation: 1062 Duplicate entry '0' for key 'PRIMARY'' 
```

据我了解，因为我没有向这个节点传递任何东西，所以数据库“认为”我再次传递了一个 0 参数，所以我有错误。每次有新条目时，如何将其修复为自动递增？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-15T01:49:16.813

您需要将该字段设置为自动增量。您需要运行这样的`ALTER TABLE`语句：

```
ALTER TABLE table_name
MODIFY `key` MEDIUMINT NOT NULL AUTO_INCREMENT 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-15T01:47:56.893

使用 MySQL，您可以在定义表时使用 AUTO_INCREMENT 关键字声明表以实现此行为

例子：

```
CREATE TABLE animals (
     id MEDIUMINT NOT NULL AUTO_INCREMENT,
     name CHAR(30) NOT NULL,
     PRIMARY KEY (id)
) ENGINE=MyISAM; 
```

[http://dev.mysql.com/doc/refman/5.0/en/example-auto-increment.html](http://dev.mysql.com/doc/refman/5.0/en/example-auto-increment.html)

当您插入数据时，您不指定主键的值。MySQL 将自动使用键的下一个可用整数值。

**更新**

您可以直接在 PHP My Admin 中更改此设置：转到有问题的表，然后

> 操作->表格选项->自动增量

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-01-15T01:48:49.523

id MEDIUMINT NOT NULL AUTO_INCREMENT

[http://dev.mysql.com/doc/refman/5.0/en/example-auto-increment.html](http://dev.mysql.com/doc/refman/5.0/en/example-auto-increment.html)

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2013-01-15T01:52:09.593

从 1 开始，而不是 0。所以第一条记录是 id 号 1。

你用的是什么数据库？在 postgres 中，您注册一个数字序列。在我的 sql 中，您只需在指定列属性时使用 AUTO_INCREMENT

# ios - 带有多个按钮的导航栏

> ID：14329916
> 
> 赞同：24
> 
> 时间：2013-01-15T01:45:00.633
> 
> 标签：ios, objective-c, uinavigationcontroller, uibarbuttonitem

我有一个带有左右按钮的导航栏，我需要在右侧按钮旁边放另一个按钮。有谁知道我该怎么做？这里有一些代码可以提供帮助：

```
- (id)init {
    self = [super initWithStyle:UITableViewStyleGrouped];
    if (self) {

        _pinArray = [[NSArray alloc]init];
        _pinArray = [Data singleton].annotations;

        UIBarButtonItem *right = [[UIBarButtonItem alloc]initWithTitle:@"Map"
                                                                 style:UIBarButtonItemStylePlain
                                                            target:self
                                                            action:@selector(goToMap:)];
        self.navigationItem.rightBarButtonItem = right;

        UIBarButtonItem *left = [[UIBarButtonItem alloc]initWithTitle:@"Menu"
                                                            style:UIBarButtonItemStylePlain
                                                           target:self
                                                           action:@selector(goToMenu:)];
        self.navigationItem.leftBarButtonItem = left;
        self.navigationItem.title = @"My Homes";
    }
    return self;
} 
```

* * *

## 回答 #1

> 赞同：53
> 
> 时间：2013-01-15T01:50:26.213

这很容易:)

[https://developer.apple.com/documentation/uikit/uinavigationitem/1624956-rightbarbuttonitems](https://developer.apple.com/documentation/uikit/uinavigationitem/1624956-rightbarbuttonitems)

```
navigationItem.rightBarButtonItems = [rightA, rightB] // @[rightA, rightB] for ObjC 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2013-01-15T01:51:17.697

而不是使用`self.navigationItem.rightBarButtonItem`，使用

```
self.navigationItem.rightBarButtonItems //note the plural 
```

这允许您设置一组按钮而不是单个按钮。

有关详细信息，请参阅[UINavigationItem 类参考](https://developer.apple.com/documentation/uikit/uinavigationitem/1624956-rightbarbuttonitems)。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2016-07-12T11:22:29.123

```
 let RightBarButton = UIButton()
        RightBarButton.setTitleColor(UIColor.blueColor(), forState: .Normal)
        RightBarButton.frame = CGRectMake(30,0,30,30)
        RightBarButton.setImage(UIImage(named: "search-icon.png"), forState: .Normal)
        RightBarButton.addTarget(self, action: #selector(BaseViewController.OpenQuickLink), forControlEvents: .TouchUpInside)

        let RightBarButton2 = UIButton()
        RightBarButton2.setTitleColor(UIColor.blueColor(), forState: .Normal)
        RightBarButton2.frame = CGRectMake(0,0,30,30)
        RightBarButton2.setImage(UIImage(named: "share-icon.png"), forState: .Normal)
        RightBarButton2.addTarget(self, action: #selector(BaseViewController.Opensharelink), forControlEvents: .TouchUpInside)
        let barButtonItem1 = UIBarButtonItem(customView: RightBarButton2)

        let barButtonItem = UIBarButtonItem(customView: RightBarButton)

navigationItem.rightBarButtonItems = [barButtonItem1, barButtonItem2] 
```

# c# - 如何在 Word 文档中设置一页 PageSetup.PageSize

> ID：14329918
> 
> 赞同：0
> 
> 时间：2013-01-15T01:45:20.230
> 
> 标签：c#, ms-word

我试过这个：

```
range= wDoc.Bookmarks.get_Item(ref oEndOfDoc).Range;
object Type = Word.WdBreakType.wdPageBreak;
range.InsertBreak(ref Type);
range.PageSetup.PaperSize = Word.WdPaperSize.wdPaperCSheet; 
```

但它将所有页面设置为`wdPaperCSheet`.

如何将一页设置为 wdPaperCSheet ？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-16T01:36:49.987

我已经尝试了很多时间。最后我找到了解决方案。

```
range= wDoc.Bookmarks.get_Item(ref oEndOfDoc).Range;
object Type = Word.WdBreakType.wdSectionBreakNextPage;
range.InsertBreak(ref Type);
range.PageSetup.PaperSize = Word.WdPaperSize.wdPaperCSheet; 
```

此代码会将范围之后的页面设置为 wdPaperCSheet。我们可以再次执行此操作以使页面正常。所以最后我们可以将一页设置为 wdPaperCSheet。但我不知道为什么 wdPageBreak 和 wdSectionBreakNextPage 采取这种不同。有人可以解释一下吗？

# c# - 到 RightFax 的 ActiveReports 接口

> ID：14329919
> 
> 赞同：0
> 
> 时间：2013-01-15T01:45:22.533
> 
> 标签：c#, fax, activereports, rightfax

我正在尝试将 ActiveReports 格式的报告发送到我公司的 RightFax 服务器，并预先设置了一些传真字段，例如传真号码、发件人和收件人。RightFax 文档说该文档必须包含嵌入代码才能设置这些值，例如`<TOFAXNUM:12345556789><TONAME:Recipient><FROMNAME:Sender>`. 我在 ActiveReports 中创建了一个包含此文本的 TextBox 或 Label。但是当 RightFax 接收到文档并调出 RightFax 客户端 UI 时，不会设置这些值。嵌入代码保留在传真图像中。我将 RightFax 打印机驱动程序设置为 HP LaserJet 4。我正在使用 Visual Studio 2010 Professional 在 C# 中进行开发。

网络上的一个建议是确保嵌入代码设置为 Courier 或其他“打印机字体”。但是，Visual Studio 没有“Courier”或“Times Roman”，只有这些标准字体的 MS true type 版本，“Courier New”和“Times New Roman”。

这种发送传真的方法适用于使用相同 RightFax 服务器的另一台机器上不使用 ActiveReports 的旧软件。

您可以分享将 ActiveReports 连接到 RightFax 的任何经验将不胜感激。

谢谢，

格雷格·洛布德尔

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-15T06:00:04.060

您可以通过控制整个打印过程并使用 Windows API 发送转义序列来完成您的任务。我假设您使用 ActiveReports 6 或 ActiveReports 7 的基于部分的报告。

更详细地说：

*   创建您自己的 PrintDocument 并定义 PrintPage 处理程序
*   在 PrintPage 处理程序中，使用 Escape winapi 调用将转义序列发送到打印机（参见[CodeProject](http://www.codeproject.com/Articles/17086/Sending-Passthrough-Commands-to-a-Printer)上的示例）
*   通过调用 Page.Draw() 呈现页面本身

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-23T21:49:29.167

只要您使用真正的类型字体，打印机就应该能够识别该字体并能够“阅读”其中的文本。只有旧的位图字体是打印机可能无法读取的字体。通常在 Windows 上常用的 TT 字体，如“Courier New”或“Times New Roman”，已经在打印机中，因此它们甚至不会被下载。

但是，[RightFax 在此处确实有一些关于转义码的文档](ftp://ftp.diem.com/Technical/RightFax/Tech%20Notes%20&%20How%20To/RightFax/Embedded%20Codes/RightFax%20Embedded%20Codes.PDF)，因此您可能想尝试在 ActiveReports 中使用转义码。此外，[这里](http://helpcentral.componentone.com/NetHelp/ActiveReports6/ActiveReports6~DataDynamics.ActiveReports.Interop.SystemPrinter~Escape.html)是一个使用 ActiveReports6 中的 SystemPrinter 对象直接向打印机发送转义码而不使用任何特殊 API 的示例。您可以尝试使用该代码并将其中的转义代码替换为 RightFax 可以理解的代码。

最后，ActiveReports 本质上是通过从打印机获取图形并在其上绘图来打印的。文本框是用适当的文本命令绘制的真实文本（即文本*不*呈现为位图）。这是在现代 Windows 中打印的一种正常方式，因此任何打印机都应该将文本视为普通文本。通过在 .NET 中编写自己的简单打印代码并将其发送到 RightFax 驱动程序，您应该能够看到相同的确切结果。如果它在那里工作，它将在 ActiveReports 中工作。

如果它不起作用，并且上面的转义代码技巧不起作用，我认为联系 RightFax 并询问他们如何从 .NET 应用程序打印到他们的驱动程序将是下一个合乎逻辑的步骤。

希望这可以帮助！

# asp.net - 如何将值发布到数据列表中的网页

> ID：14329922
> 
> 赞同：0
> 
> 时间：2013-01-15T01:45:38.683
> 
> 标签：asp.net, vb.net, visual-studio

我想在代码中将 Prd_id 发布到网页 Products.aspx

```
<asp:DataList ID="DataList1" runat="server"
         DataKeyField="Prd_id" DataSourceID="AccessDataSource1">
         <ItemTemplate>
            <a href='Products.aspx?prdid=<%# Eval("Prd_id") %>'>Add to Cart</a>
         </ItemTemplate>
</asp:DataList> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-15T02:25:29.323

尝试使用隐藏字段来存储选定的产品 ID：

HTML：

```
 <script type="text/javascript">
        function addProduct(prid) {
            // assign the product ID to the hidden field's value
            document.getElementById("<%= hidProductId.ClientID %>").value = prid;
        }
    </script>

    <asp:DataList ID="DataList1" runat="server" DataKeyField="Prd_id" DataSourceID="AccessDataSource1">
        <ItemTemplate>
            <asp:LinkButton ID="btnAdd" runat="server" OnClick="btnAdd_Click" OnClientClick="<%# "addProduct('" + Eval("Prd_id") + "');" %>" ></asp:LinkButton>
        </ItemTemplate>
    </asp:DataList>

    <asp:HiddenField ID="hidProductId" runat="server" /> 
```

后面的代码：

```
 protected void btnAdd_Click(object sender, EventArgs e)
    {
        var productId = hidProductId.Value;
    } 
```

# android - 从前台调度读取标签 NFC ID

> ID：14329923
> 
> 赞同：1
> 
> 时间：2013-01-15T01:45:40.093
> 
> 标签：android, nfc

我正在尝试读取 NFC 标签 ID。我知道我无法读取数据，因为它是一个安全标签（MBTA 票价卡）。我想读取标签的唯一 ID 并敬酒该值。我已成功使 NFC 意图工作，因此当扫描标签时，我的应用程序会尝试处理它。但是，应用程序不会显示带有标签 ID 的吐司。

```
 package com.example.nfctest;

import android.nfc.NdefMessage;
import android.nfc.NfcAdapter;
import android.nfc.Tag;
import android.nfc.tech.NfcF;
import android.os.Bundle;
import android.app.Activity;
import android.app.PendingIntent;
import android.content.Intent;
import android.content.IntentFilter;
import android.content.IntentFilter.MalformedMimeTypeException;
import android.util.Log;
import android.view.Menu;
import android.widget.Toast;

public class MainActivity extends Activity {
     private NfcAdapter mAdapter;
        private PendingIntent mPendingIntent;
        private IntentFilter[] mFilters;
        private String[][] mTechLists;
        private int mCount = 0;

    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_main);

        mAdapter = NfcAdapter.getDefaultAdapter(this);

        // Create a generic PendingIntent that will be deliver to this activity. The NFC stack
        // will fill in the intent with the details of the discovered tag before delivering to
        // this activity.
        mPendingIntent = PendingIntent.getActivity(this, 0,
            new Intent(this, getClass()).addFlags(Intent.FLAG_ACTIVITY_SINGLE_TOP), 0);

    // Setup an intent filter for all MIME based dispatches

    IntentFilter ndef = new IntentFilter(NfcAdapter.ACTION_NDEF_DISCOVERED);
    try {
        ndef.addDataType("*/*");
    } catch (MalformedMimeTypeException e) {
        throw new RuntimeException("fail", e);
    }
    mFilters = new IntentFilter[] {

    };

    // Setup a tech list for all NfcF tags
    mTechLists = new String[][] { new String[] { NfcF.class.getName() } };
}
public void onResume() {
    super.onResume();
    mAdapter.enableForegroundDispatch(this, mPendingIntent, mFilters, mTechLists);

}

@Override
public void onNewIntent(Intent intent) {
    Log.i("Foreground dispatch", "Discovered tag with intent: " + intent);
    CharSequence text = ("Discovered tag " + ++mCount + " with intent: " + intent);
    int duration = Toast.LENGTH_SHORT;

    Tag myTag = (Tag) intent.getParcelableExtra(NfcAdapter.EXTRA_TAG);

    Toast toast = Toast.makeText(MainActivity.this,myTag.getId().toString() , duration);
    toast.show();
}

@Override
public void onPause() {
    super.onPause();
    //mAdapter.disableForegroundDispatch(this);
    throw new RuntimeException("onPause not implemented to fix build");
}

@Override
public boolean onCreateOptionsMenu(Menu menu) {
    getMenuInflater().inflate(R.menu.activity_main, menu);
    return true;
}

} 
```

它不再崩溃，只是不使用 ID 敬酒。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-15T02:01:07.323

我强烈推荐这个[链接](http://www.jessechen.net/blog/how-to-nfc-on-the-android-platform/)中的[这个示例应用程序](http://nfc.android.com/StickyNotes.zip)。不要像我一样尝试一切来成功简单的操作，从而给自己带来痛苦。

您可能在 onResume 和 onNewIntent 中的操作位置上做错了。但是，在我链接的示例中，它在 onResume 和 onNewIntent 中都有新标签和 ndef 控件。如果你真的想继续自己的项目，试试这个。

# linux - Express.js 抛出错误：Linux 服务器上的 ENOENT

> ID：14329934
> 
> 赞同：1
> 
> 时间：2013-01-15T01:46:55.360
> 
> 标签：linux, node.js, express, forever

所以，我一直在研究我在 Windows 机器上工作的上传脚本（代码如下），但在我的 Linux 服务器上它似乎失败了

```
Error: ENOENT, open 'uploads/da5ab67b48ea2deecd25127186017083' 
```

我知道错误是说没有路径/文件，但在尝试重命名文件之前，我会检查文件是否存在。

```
exports.product_files_upload = function (req, res) {
    if (req.files) {
        var tmpArray = [];
        for(var file in req.files){
            console.log(file)
            if (file){
                var splitName = file.split('-');
                if (splitName.length > 1) {
                    var username = splitName[0];
                    var productId = splitName[1];
                    var index = splitName[2];
                } else {
                    return;
                }
            } else {
                return;
            }
            //console.log(username)
            //console.log(productId)
            var tmp_path = req.files[file].path;
            console.log(fs.existsSync(tmp_path))
            createUserDir();
            createProductDirs(username, productId);
            //console.log(__dirname)
            var target_path = './public/user_files/'+ username + '/products/'+productId+'/files/' + req.files[file].name,
                save_path = 'user_files/'+ username + '/products/'+productId+'/files/' + req.files[file].name;
            if (fs.existsSync(target_path)) {
                tmpArray.push({exists:true, name:req.files[file].name});
            } else {
                tmpArray.push({
                    size: req.files[file].size,
                    type: req.files[file].type,
                    name: req.files[file].name,
                    path: save_path,
                    exists:false
                });
                if (fs.existsSync(tmp_path)) {
                    fs.rename(tmp_path, target_path, function(err) {
                        if (err) throw err;
                        // delete the temporary file, so that the explicitly set temporary upload dir does not get filled with unwanted files
                        fs.unlink(tmp_path, function() {
                            if (err) throw err;
        //                    res.send(save_path);

                        });
                    });
                } else {
                    tmpArray.push({
                        size: req.files[file].size,
                        type: req.files[file].type,
                        name: req.files[file].name,
                        path: save_path,
                        exists:false
                    });
                }
            }
        }
        res.json(tmpArray);
    }

}; 
```

更新：我永远使用运行我的快速应用程序，当我永远停止我的应用程序进程并切换到“node app.js”时，问题得到了解决。这不是一个可接受的修复。我在想永远可能有问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-16T04:49:46.563

好吧，我想通了。我一直在使用绝对路径在我的 linux 机器上启动我的应用程序，比如

```
forever start /path/to/app.js 
```

但是当我 cd 进入应用程序目录然后启动应用程序时它可以工作。

```
forever start app.js 
```

# cgaffinetransform - 多个UIView变换动画，一个重复，一个不重复

> ID：14329935
> 
> 赞同：1
> 
> 时间：2013-01-15T01:46:59.087
> 
> 标签：cgaffinetransform, catransform3d

我有一个 UIImageView，它的实例有一个重复的类似脉冲的动画。

我希望这个 UIImageView 随着加速度计的力量移动。为此，我添加了另一个动画，这次是翻译。

但是，一旦发生这种转换，它就会停止脉冲，即使它没有动画。

由于这两个动画是分开的，我不能使用该`CGAffineTransformConcat`方法来组合两个动画。

我尝试将一个添加到 UIView 和一个添加到同一 UIView 的 layer 属性，但它不起作用。

我也尝试将移动直接添加到视图的框架中，但是，这只会导致我的视​​图违反将其约束到超级视图中心 x 的约束。

有没有人使用/知道解决这个问题的方法？

一如既往的感谢！

# coldfusion - 不尊重 web.xml 中的默认文档（开发人员/独立服务器）

> ID：14329937
> 
> 赞同：4
> 
> 时间：2013-01-15T01:47:17.963
> 
> 标签：coldfusion, coldfusion-10

由于某种原因，当浏览到以文件夹结尾的 URL（例如 //localhost:8500/website/directory/）时，index.cfm 没有加载，而是返回 404 错误页面。我已经确认 ...\web-inf\web.xml 文件正在通过修改 filter-mappings 来启用 .htm 和 .txt 文件的显示。事实上，welcome-file-list 部分中的任何文件都没有被使用，即使它们存在，这让我相信 web.xml 文件的这部分有问题。

web.xml 文件如下：

*   {安装根}\cfusion\runtime\conf\web.xml
*   {安装根}\cfusion\wwwroot\web-inf\web.xml

这两个文件都包含下面列出的相同 XML。

> ```
> <web-app>
> ...
> <welcome-file-list id="WelcomeFileList_1034013110672">
>     <welcome-file>index.cfm</welcome-file>
>     <welcome-file>index.html</welcome-file>
>     <welcome-file>index.htm</welcome-file>
>     <welcome-file>index.txt</welcome-file>
> </welcome-file-list>
> ...
> </web-app> 
> ```

我最近刚刚修补了更新 6，但我相信问题从初始安装开始就一直存在。请注意，这是开发独立服务器。

除了重新安装 CF10 和使用 IIS 之外，有没有人已经解决了这个问题或者对如何进行有任何想法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-08-22T19:24:08.223

Late to the party, IMO there are two possible reasons that i can think of for this issue

*   Either your have additional mapping like "/" in place which is taking over servletcontainer's builtin default servlet who is the one responsible for going to the right root path
*   your folder name is something which CF already have a mapping for e.g. /flashservices/gateway/, CFFormGateway, cfform-internal, WSRPProducer, JSDebugServlet, flex2gateway

I think sharing your web.xml could have helped pin point the issue here.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-05-04T19:08:27.290

我最近遇到了这个问题，这是 Tomcat 中区分大小写的问题（尽管这是在 Windows 上安装的 ColdFusion 10）。

当我导航到[http://127.0.0.1](http://127.0.0.1)时，我的默认 index.cfm 会加载，但是当我转到[http://127.0.0.1/mysite](http://127.0.0.1/mysite)时，我得到了 404。该文件夹在 Windows 中被命名为 mySite。一旦我将我的 URL 更改为[http://127.0.0.1/mySite](http://127.0.0.1/mySite)，它就开始工作了。

# java - 如何在 JDBC 中使用 MySQL 子查询？

> ID：14329944
> 
> 赞同：6
> 
> 时间：2013-01-15T01:48:16.580
> 
> 标签：java, mysql, prepared-statement

示例查询：

```
SELECT country 
FROM data 
WHERE city LIKE 
(SELECT LEFT ('jakartada',7)); 
```

JDBC 中的示例：

```
String sql = " SELECT country FROM data WHERE city LIKE (SELECT LEFT ('?',7)) ";
PreparedStatement ps = koneksi.prepareStatement(sql);
ps.setString(1,     city    );
ResultSet rs = ps.executeQuery(); 
```

为什么这不能正常工作？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-15T01:50:12.800

准备好的语句中没有参数，但是代码会尝试设置参数。尝试在语句中添加参数。

```
String sql = " SELECT country FROM data WHERE city LIKE (SELECT LEFT (?,7)) ";
PreparedStatement ps = koneksi.prepareStatement(sql);
ps.setString(1,     city    );
ResultSet rs = ps.executeQuery(); 
```

或者尝试删除设置参数的语句：

```
String sql = " SELECT country FROM data WHERE city LIKE (SELECT LEFT ('jakartada',7)) ";
PreparedStatement ps = koneksi.prepareStatement(sql);
ResultSet rs = ps.executeQuery(); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-15T03:00:54.533

我相信你让这变得比它需要的更难，同时你错过了一些东西。这是你想要做的吗？

```
 SELECT country FROM data WHERE city LIKE 'jakarta%' 
```

也就是说，您是否从城市名称以“jakarta”开头的每一行中查找国家列？如果是这样，不要忘记这个`%`标志。如果你不包括`%`标志，那么

```
 SELECT country FROM data WHERE city LIKE 'jakarta' 
```

和

```
 SELECT country FROM data WHERE city = 'jakarta' 
```

意思完全一样，`LIKE`算符没有意义；您也可以使用`=`运算符。

所以，在我看来，你想要的 MySQL 查询是

```
 SELECT country FROM data WHERE city LIKE CONCAT(LEFT('jakartada',7),'%') 
```

添加 % 符号。在这种情况下，您不需要子选择。

就像您指出的那样，您需要的 Java 代码是：

```
 String sql = "SELECT country FROM data " . 
              "WHERE city LIKE CONCAT(LEFT(?,7),'%')";

 PreparedStatement ps = koneksi.prepareStatement(sql);
 ps.setString(1,     city    );
 ResultSet rs = ps.executeQuery();
 ... process the rs records ...
 rs.close();  /* please don't forget to close your result sets */ 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-15T03:54:25.037

将此链接用于您的解决方案和此查询

[http://sqlfiddle.com/#!2/c79ab/10](http://sqlfiddle.com/#!2/c79ab/10)

```
SELECT country FROM data
WHERE city LIKE CONCAT(LEFT('jakartada',7),'%') 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-15T02:28:22.120

在运行时设置值时不要在准备好的语句中引用...否则它将仅将其作为输入而不是 ps 位置...从问号中删除单引号...

# vb.net - 如何使用 Visual Studio.net 打开 Visual Basic 6 程序

> ID：14329954
> 
> 赞同：17
> 
> 时间：2013-01-15T01:49:38.783
> 
> 标签：vb.net, visual-studio-2010, visual-studio, vb6-migration

我想打开一个程序（用 Visual basic 6 编写）在 Visual Studio.net 中打开。请指导，我该怎么做？

尝试直接从 Visual studion.net 中的 OPEN 项目选项打开 VB6（.vbp 文件）程序时，出现此错误，

> “无法在 Visual Studio 中打开 Visual Basic 6 (.vbp) 文件”

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2014-08-14T16:52:37.073

> 我正在尝试在 VS 2010 中打开。

Visual Studio 2010 不支持 VB6 项目。[请参阅此处](http://msdn.microsoft.com/en-us/library/bszew91f(v=vs.100).aspx)的链接

来自[msdn 文档：](http://msdn.microsoft.com/en-us/library/bszew91f(v=vs.100).aspx)

> Visual Studio 2010 不提供用于从 Visual Basic 6.0 升级应用程序和项目的工具。如果要将项目从 Visual Basic 6.0 升级到 Visual Basic 2010，可以使用 Visual Studio 早期版本提供的升级工具，然后在 Visual Studio 2010 中再次升级项目。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2015-11-17T19:13:55.700

有一个名为[Visual Basic Tools for Visual Studio](https://visualstudiogallery.msdn.microsoft.com/6a06be60-1198-486e-9bce-6ace36b24316)的插件，它提供以下功能：

*   > 加载经典的 VB 工作区和项目文件，并提供对扩展选项的快速访问

*   > 与解决方案资源管理器和代码编辑器集成，支持语法突出显示、基本大纲（允许展开/折叠方法、属性和类型）以及导航栏支持。

*   > 可以使用对象浏览器和类视图检查类、类型、模块、表单和控件。

从阅读中看，您是否可以真正构建该项目尚不清楚，尽管它确实说：

> 导入工具会创建一个新的解决方案和 MSBuild 兼容的项目。

VS 版本的插件链接

*   [2012-2013](https://visualstudiogallery.msdn.microsoft.com/6a06be60-1198-486e-9bce-6ace36b24316)
*   [2015](https://visualstudiogallery.msdn.microsoft.com/00cc8ff8-beb3-4f08-8aa6-59eefba3bb40)
*   [2017](https://marketplace.visualstudio.com/items?itemName=MatthiasFriedrich.VisualBasicToolsforVisualStudio2017)

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2016-05-25T12:47:40.530

以我的经验来说，在 2008 以上的任何版本的 Visual Studio 中打开 Visual Basic 6.0 项目都不容易。

尽管 2008 及以下版本确实提供了将 Vb6 代码转换为 VB.net 框架的自动功能。但是，问题在转换后开始 - 它可以跳过一些代码，自行添加函数/变量，或自行修改功能行为，因此 VB.proj 将创建错误，您将无法在任何地方打开它作为解决方案文件。任何 3rd 方工具都是如此。

如果你想打开VB6代码试试Visual Basic 6.0 Portable edition。但是头痛仍然会跟着你，请参考这个链接 [Installation of VB6 on Windows 7 / 8 / 10](https://stackoverflow.com/questions/10495680/installation-of-vb6-on-windows-7-or-windows-8-or-windows-10)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-01-15T03:00:13.430

确保您单击的是项目文件本身...右键单击该文件并选择“打开方式”并选择您的 Visual Studio 程序。它可能需要转换，如果需要，它会提示您转换项目。

谢谢！

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2016-03-16T18:10:17.353

下载适用于 Visual Studio 的 Visual Basic 工具，允许使用经典的 VB 工作区和项目

# python - getaddrinfo 11004 和 python 的 httplib

> ID：14329956
> 
> 赞同：0
> 
> 时间：2013-01-15T01:49:41.290
> 
> 标签：python, httplib, getaddrinfo

我正在尝试获取[http://www.epicurious.com/recipes/food/reviews/Breaded-Chicken-Cutlets-aka-Grandma-Jodys-Chicken-51114400](http://www.epicurious.com/recipes/food/reviews/Breaded-Chicken-Cutlets-aka-Grandma-Jodys-Chicken-51114400)的渲染标记；理论上与 Firefox 中的“查看页面源代码”菜单选项给出的标记完全相同。

我正在使用 Python 2.7 脚本和**httplib**库*[(http://docs.python.org/2/library/httplib.html)](http://docs.python.org/2/library/httplib.html)*。我创建了一个 HTTPConnection 对象，当我尝试通过 HTTPResponse 对象的函数获取标记时，不可避免地会收到**getaddrinfo - 11004**错误。此脚本已在 Windows 7 和 Ubuntu 环境中执行。

我读过的针对此错误的其他解决方案都不符合要求：我不在任何防火墙后面，而且我在 ping www.google.com 时没有问题。我想知道该网站是否不符合我不知道的某些标准，因为**我无法成功 ping 我的目标网站**。

我对其他方法持开放态度，如果有更好的方法，请告诉我。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-15T02:18:03.530

`reqests`你可能想去图书馆看看。它使像这样的简单事情变得容易得多：

```
import requests

r = requests.get('http://www.epicurious.com/recipes/food/reviews/Breaded-Chicken-Cutlets-aka-Grandma-Jodys-Chicken-51114400')

print r.text 
```

以下是文档：[http ://docs.python-requests.org/en/latest/](http://docs.python-requests.org/en/latest/)

运行上述并验证它有效。

# mysql - 我的 MySQL 语法错误，我错过了什么？

> ID：14329964
> 
> 赞同：-1
> 
> 时间：2013-01-15T01:50:28.293
> 
> 标签：mysql

```
INSERT INTO 'tblJobNumbers' 
VALUES (NULL, '3006', '05', 'THISTHS', 0, 'JOBLOCATION', '', '', 
        'JOBCOMMENTS', 'ES', '01/14/2013', '01/15/2013, 
        '', '', '', 'CRS-2', '25000') 
```

这是我的声明

```
 jobID int(11) NOT NULL AUTO_INCREMENT COMMENT 'referenced by tblJobResources.jreJobID',
  jobNumber int(4) NOT NULL,
  jobPrefix int(2) NOT NULL COMMENT 'reference tblJobPreix.jprID',
  jobCustomerTID varchar(7) NOT NULL,
  jobCustomerID int(11) NOT NULL COMMENT 'reference tblCustomers.cusID',
  jobLocation text NOT NULL,
  jobContactName text NOT NULL,
  jobContactInfo text NOT NULL,
  jobComments text NOT NULL,
  jobSoldBy varchar(2) NOT NULL COMMENT 'reference tblUsers.userID',
  jobStartDate varchar(10) NOT NULL,
  jobEstCompleteDate varchar(10) NOT NULL,
  jobCompleteDate varchar(10) NOT NULL,
  jobAcctgMethod text NOT NULL,
  jobBillMethod text NOT NULL,
  jobProduct varchar(10) NOT NULL,
  jobProductAmount varchar(10) NOT NULL,
  PRIMARY KEY (jobID) 
```

我的表转储显示布局和数据类型。我错过了什么？请有人帮忙，这是我工作的笔记本电脑，我不认为“但愚蠢的代码”是破坏公司财产的正当借口。

错误信息：

> `#1064`- 您的 SQL 语法有错误；检查与您的 MySQL 服务器版本相对应的手册以获取正确的语法，以便在 ''tblJobNumbers' VALUES (NULL, 3006, 05, 'THISTHS', 0, 'JOBLOCATION', '', '', 'JO' at line 1.

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-15T01:53:11.337

删除 tableName 周围的单引号，它将转换为字符串。（*不再是一张桌子*）

```
INSERT INTO tblJobNumbers
         -- ^ remove single quotes
VALUES (NULL, '3006', '05', 'THISTHS', 0, 
'JOBLOCATION', '', '', 'JOBCOMMENTS', 'ES', '01/14/2013', 
'01/15/2013', '', '', '', 'CRS-2', '25000')
        -- ^ add single quote here 
```

此外，如您所见，您忘记关闭日期值周围的单引号。

*   [SQLFiddle 演示](http://sqlfiddle.com/#!2/3983c/1)

# css - 完成后如何阻止CSS3动画跳回到开头

> ID：14329966
> 
> 赞同：9
> 
> 时间：2013-01-15T01:50:32.420
> 
> 标签：css, css-animations

我有一个 CSS3 动画，它只是向下移动`<div>`（通过`top: 0px;`to `top: 300px;`）。但我的问题是，我不知道如何防止`<div>`动画完成后返回顶部。有什么办法可以防止这种情况发生吗？

这是一个示例小提琴：http: [//jsfiddle.net/y8tJ7/](http://jsfiddle.net/y8tJ7/)

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2013-01-15T02:09:25.243

你需要像这样反转动画。

```
@keyframes move {
  from{
    top: 20px;
  }
} 
```

见[http://jsfiddle.net/gleezer/y8tJ7/1/](http://jsfiddle.net/gleezer/y8tJ7/1/)

这样，它的结束位置在 div 样式中指定，您只需在关键帧中指定开始状态。

**编辑**：实现它的另一种方法可能是简单地添加：

`animation-fill-mode: forwards`.

看到这个其他的[小提琴](http://jsfiddle.net/gleezer/y8tJ7/2/)。

[Mozilla Dev Network](https://developer.mozilla.org/en-US/docs/CSS/animation-fill-mode)上有关它的更多信息。

# gcc - 使用 gcc -l 后在 ldd 中缺少一个库

> ID：14329967
> 
> 赞同：10
> 
> 时间：2013-01-15T01:50:34.097
> 
> 标签：gcc, linker, shared-libraries, ld

我正在编译一个名为“询问”的可执行文件：

```
g++ -o built/bin/interrogate -Lbuilt/lib -Lbuilt/tmp -L/usr/X11R6/lib \
建/tmp/interrogate_composite1.o 建/tmp/interrogate_composite2.o \
-lp3cppParser -lp3dtool -lp3dtoolconfig -lp3pystub -pthread -ldl

```

编译后，当我尝试执行可执行文件时：

```
$ LD_LIBRARY_PATH=built/lib built/bin/interrogate
built/bin/interrogate：符号查找错误：built/lib/libp3dtool.so.1.8：未定义符号：_Py_NoneStruct

```

此符号由 libp3pystub.so 提供，但询问可执行文件没有对此库的任何引用（我确实使用了 -lp3pystub）：

```
$ LD_LIBRARY_PATH=built/lib ldd built/bin/interrogate
    linux-vdso.so.1 => (0x00007fff2016a000)
    libp3dtool.so.1.8 => 内置/lib/libp3dtool.so.1.8 (0x00007f498d57a000)
    libp3dtoolconfig.so.1.8 => 内置/lib/libp3dtoolconfig.so.1.8 (0x00007f498d51b000)
    libstdc++.so.6 => /usr/lib/x86_64-linux-gnu/libstdc++.so.6 (0x00007f498d1f2000)
    libgcc_s.so.1 => /lib/x86_64-linux-gnu/libgcc_s.so.1 (0x00007f498cfdc000)
    libpthread.so.0 => /lib/x86_64-linux-gnu/libpthread.so.0 (0x00007f498cdbf000)
    libc.so.6 => /lib/x86_64-linux-gnu/libc.so.6 (0x00007f498c9ff000)
    libdl.so.2 => /lib/x86_64-linux-gnu/libdl.so.2 (0x00007f498c7fb000)
    libm.so.6 => /lib/x86_64-linux-gnu/libm.so.6 (0x00007f498c4ff000)
    /lib64/ld-linux-x86-64.so.2 (0x00007f498d5bc000)

```

如果我手动加载 libp3pystub.so，可执行文件有效：

```
$ LD_PRELOAD=built/lib/libp3pystub.so LD_LIBRARY_PATH=built/lib built/bin/interrogate

用法：
  询问 [opts] file.C [file.C ...]
  询问 -h

```

我的问题是：为什么可执行文件`-lp3pystub`没有引用我添加的库？`interrogate`

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2013-01-15T02:32:08.833

我实际上自己找到了答案。我在 Ubuntu 上编译，他们添加了一个默认优化标志：`-Wl,--as-needed`. 此优化检查是否在主可执行文件中没有使用通过 -l 传递的库中的符号，它们将被删除。

这就是我的错误所在：_Py_NoneStruct 不是由询问直接使用，而是由另一个共享库使用。所以我必须手动指定需要 p3pystub。

一种可能的解决方法是：

```
$ g++ -o built/bin/interrogate -Lbuilt/lib -Lbuilt/tmp -L/usr/X11R6/lib \
建/tmp/interrogate_composite1.o 建/tmp/interrogate_composite2.o \
-Wl,--不需要 -lp3cppParser -lp3dtool -lp3dtoolconfig -lp3pystub \
-pthread -ldl

```

然后我正确地在 ldd 输出中获得了库：

```
$ LD_LIBRARY_PATH=built/lib ldd built/bin/interrogate
    linux-vdso.so.1 => (0x00007fff0edff000)
    libp3dtool.so.1.8 => 内置/lib/libp3dtool.so.1.8 (0x00007fa1c36be000)
    libp3dtoolconfig.so.1.8 => 内置/lib/libp3dtoolconfig.so.1.8 (0x00007fa1c365f000)
>>> libp3pystub.so.1.8 => 内置/lib/libp3pystub.so.1.8 (0x00007fa1c3658000)
    libdl.so.2 => /lib/x86_64-linux-gnu/libdl.so.2 (0x00007fa1c342f000)
    libstdc++.so.6 => /usr/lib/x86_64-linux-gnu/libstdc++.so.6 (0x00007fa1c312c000)
    libm.so.6 => /lib/x86_64-linux-gnu/libm.so.6 (0x00007fa1c2e2f000)
    libgcc_s.so.1 => /lib/x86_64-linux-gnu/libgcc_s.so.1 (0x00007fa1c2c19000)
    libpthread.so.0 => /lib/x86_64-linux-gnu/libpthread.so.0 (0x00007fa1c29fc000)
    libc.so.6 => /lib/x86_64-linux-gnu/libc.so.6 (0x00007fa1c263c000)
    /lib64/ld-linux-x86-64.so.2 (0x00007fa1c3700000)

```

参考： [https ://wiki.ubuntu.com/NattyNarwhal/ToolchainTransition](https://wiki.ubuntu.com/NattyNarwhal/ToolchainTransition)

# c# - 从 IEnumerable 继承

> ID：14329979
> 
> 赞同：1
> 
> 时间：2013-01-15T01:52:28.850
> 
> 标签：c#, windows-phone-7, user-interface, expression-blend

我正在尝试[阅读本教程](http://visualstudiomagazine.com/Articles/2012/11/01/LongListSelector.aspx?Page=1)，并且有 [相关的代码](http://visualstudiomagazine.com/articles/2012/11/01/longlistselector/listing1.aspx)。这部分

```
IEnumerator IEnumerable.GetEnumerator()
{
    return Items.GetEnumerator();
} 
```

给我一个错误

```
"Using the generic type 'System.Collections.Generic.IEnumerator<T>' requires 1 type arguments" 
```

你能告诉我有什么问题吗？谢谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-15T01:58:14.813

您不会从*IEnumerable**继承*。那是一个界面。您可以实现接口。

 *您显示的错误消息使我怀疑您正在实现`IEnumerable.GetEnumerator()`哪个返回`IEnumerator`（非通用接口）但试图`IEnumerator<T>`在您的代码中使用通用接口。

您链接中的代码确实显示了通用接口的实现

```
public IEnumerator <T> GetEnumerator()
{
    return Items.GetEnumerator();
} 
```*

# objective-c - NSMutableSet 联合集性能/实现

> ID：14329982
> 
> 赞同：1
> 
> 时间：2013-01-15T01:52:34.557
> 
> 标签：objective-c, nsmutableset

我想知道联合集是如何在 NSMutableSet 实例中实现的。我有两个需要经常合并的大集合，我想知道我是否应该实施自己的合并两个集合的方式，或者 Apple 的方式是否足够快。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-15T01:55:59.250

我敢打赌，Apple 版本已经过高度优化。为什么不直接运行 Instruments 看看是否存在性能问题？

CFSet 源代码参见：[opensource.apple.com](http://www.opensource.apple.com/source/CF/CF-550/CFSet.c)

```
static Boolean __CFSetEqual(CFTypeRef cf1, CFTypeRef cf2) {
return __CFBasicHashEqual((CFBasicHashRef)cf1, (CFBasicHashRef)cf2);
}

static CFHashCode __CFSetHash(CFTypeRef cf) {
return __CFBasicHashHash((CFBasicHashRef)cf);
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-15T01:59:41.243

的性能在`NSMutableSet`很大程度上取决于集合中对象的实现`-hash`和执行。`-isEqual`我认为您自己实施它*不会提高性能。*但是，您可以尝试一下，然后分析您的代码以查看它是否“太慢”。

# c# - 如何以及何时在 C# 中处理对象？

> ID：14329984
> 
> 赞同：-3
> 
> 时间：2013-01-15T01:52:48.543
> 
> 标签：c#, ado.net

我必须从数据库中读取大量 Blob 数据（超过 300Gb）并插入到另一个数据库中。我正在使用以下代码读取数据

```
if (dr.HasRows)
{
    while (dr.Read())
    {
       media m = new media
       {
           docid = Convert.ToInt32(dr["Id"]),
           Content = Convert.ToByte(dr["BlobData"]),
           madiaName = Convert.ToString(dr["Name"])
       }
    }

    InsertInNewDb(m);
} 
```

我正在逐行读取并在另一个数据库中插入数据。问题是在发送一些数据后会生成内存已满异常，因为我没有处理对象。单次迭代后如何处理对象？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-15T02:29:00.187

要将多个答案和评论联系在一起，请尝试以下操作：

```
// The SqlConnection, SqlCommand and SqlDataReader need to be in using blocks
// so that they are disposed in a timely manner. This does not clean  up
// memory, it cleans up unmanaged resources like handles
using (SqlConnection conn = new SqlConnection(connectionString))
{
    using (SqlCommand cmd = new SqlCommand("SELECT * FROM OldTable", conn))
    {
        using (SqlDataReader dr = cmd.ExecuteReader())
        {
            if (dr.HasRows)
            {
                while (dr.Read())
                {
                   media m = new media
                   {
                       // Don't convert - cast instead. These are already the correct
                       // type.
                       docid = (int) dr["Id"],
                       // There are more efficient ways to do this, but
                       // Convert.ToByte was copying only a single byte
                       Content = dr["BlobData"],
                       madiaName = (string)dr["Name"]
                   }

                    // You probably want to insert _all_ of the rows.
                    // Your code was only inserting the last
                    InsertInNewDb(m);
                }
            }
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-15T02:01:32.550

您可以尝试对 DataReader 进行分页，这应该可以工作。尝试在某些行之后关闭数据的连接、源和目标。请记住将对象与**using**指令一起使用，以更好地管理内存。

# hadoop - Cloudera 蜂蜡服务器和蜂巢服务器

> ID：14329985
> 
> 赞同：1
> 
> 时间：2013-01-15T01:52:52.820
> 
> 标签：hadoop, hive, cloudera, beeswax

关于 cloudera cdh4 发行版中提到的两台服务器，我有一个基本问题

1.  这两个是否可以互换/可替换，因为您可以运行蜂蜡代替蜂巢服务器吗？
2.  我正在尝试使用节俭客户端进行连接，并且在我的设置中只有蜂蜡正在运行，而不是蜂巢服务器。在这种情况下，我可以连接到蜂蜡服务器吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-15T02:03:56.737

Hive Server 是默认进程，Beeswax 是一个较新的进程，旨在更好地支持并发并使用 Kerberos 提供身份验证。您应该运行其中一个。

是的，您绝对应该能够使用 Thrift 连接到蜂蜡。[您可以在此处](https://github.com/cloudera/hue/tree/master/apps/beeswax/src/beeswax/server)找到 Beeswax 和 Hive 服务器的客户端。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-02-20T09:07:56.630

hive-server2 和蜂蜡有什么区别？它们都旨在更好地支持并发性和安全性。

# nosql - 优化大型 Redis Hash 和 Sorted set 的内存使用

> ID：14329991
> 
> 赞同：2
> 
> 时间：2013-01-15T01:53:38.327
> 
> 标签：nosql, redis, in-memory-database, in-memory, memory-optimization

作为分布式爬虫的一部分，我们将所有 URL 存储在**Redis 排序集中**，这是爬取队列和**Redis 哈希**（用于去重复和标记访问的 URL）。

我们在一个文件中拥有大约 1100 万个我们希望访问的各个域的 URL，该文件占用了*506 MB 的磁盘空间*。

但是，当放入**Redis 排序集**时，相同的 URL 集（优先级从整数 11M 一直到 0 递减）占用 1.759 GB 的 RAM，而**Redis 哈希**来自键：URL-> 值：相同**的 URL，占用 2.048 GB RAM 空间**。

redis 服务器托管在 AWS 的高内存 (17GB) 超大型 EC2 实例中。

我想弄清楚是什么导致了 Redis 中的空间膨胀，可能是因为存储它们的方式效率低下，还是我们应该以某种方式优化内存以避免空间膨胀？任何提高内存性能的建议都是 gr8。提前感谢您的帮助！

这是 redis 信息转储：

```
redis_version:2.4.14
redis_git_sha1:00000000
redis_git_dirty:0
arch_bits:64
multiplexing_api:epoll
gcc_version:4.6.3
process_id:739
uptime_in_seconds:329647
uptime_in_days:3
lru_clock:1603627
used_cpu_sys:9521.58
used_cpu_user:3165.06
used_cpu_sys_children:19535.11
used_cpu_user_children:126500.32
connected_clients:76
connected_slaves:0
client_longest_output_list:0
client_biggest_input_buf:0
blocked_clients:0
used_memory:12794713864
used_memory_human:11.92G
used_memory_rss:13586632704
used_memory_peak:16575849280
used_memory_peak_human:15.44G
mem_fragmentation_ratio:1.06
mem_allocator:jemalloc-2.2.5
loading:0
aof_enabled:0
changes_since_last_save:46321
bgsave_in_progress:1
last_save_time:1358213403
bgrewriteaof_in_progress:0
total_connections_received:1702
total_commands_processed:95112145
expired_keys:3488037
evicted_keys:0
keyspace_hits:43443780
keyspace_misses:38945
pubsub_channels:2
pubsub_patterns:0
latest_fork_usec:3820832
vm_enabled:0
role:master
db0:keys=116,expires=25 
```

# api - Foursquare users/self/checkins API 已弃用

> ID：14329992
> 
> 赞同：0
> 
> 时间：2013-01-15T01:53:39.363
> 
> 标签：api, foursquare

我正在构建一个使用 Foursquare API 的应用程序，并且我正在尝试获取经过身份验证的用户最近签到的列表。API 的其他部分工作得很好，但是当我对以下 URL 发出 get 请求时，它会返回一条弃用错误消息，然后是一堆似乎忽略`afterTimestamp`参数的结果。

`https://api.foursquare.com/v2/users/self/checkins?afterTimestamp=1358127640&v=20130113`

错误信息：

`Please provide an API version to avoid future errors.See http://bit.ly/vywCav`

当我通过[他们的 API explorer](https://developer.foursquare.com/docs/explore)使用相同的 URL 时，它工作得非常好。

有任何想法吗？

编辑：

弃用错误实际上发生在所有请求上，即使我包含了他们在[链接](http://bit.ly/vywCav)中提到的“v”参数。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-15T05:26:55.553

您的网址格式不正确。第一次出现的 & 应替换为 ?。

# javascript - 设置 innerHTML 属性会中断对子元素的引用

> ID：14329996
> 
> 赞同：0
> 
> 时间：2013-01-15T01:55:04.097
> 
> 标签：javascript, dom, web-applications, reference, cross-browser

据我所知，该问题与[此处](https://stackoverflow.com/questions/5982268/element-reference-breaks-on-modification-of-innerhtml-property-of-container)描述的问题相似。但是，我没有使用 mootools，我的问题和结果不同。这是一个演示该问题的测试页面：http: [//jsfiddle.net/S7rtU/2/](http://jsfiddle.net/S7rtU/2/)。

`createElement`我使用and将元素添加到容器中`appendChild`。在添加每一个时，我还将对它的引用存储在私有数组 ( `elems`) 中。

然后，我决定清除容器，并通过设置`container.innerHTML = ''`.

（在我的示例中，我首先将其设置为待处理消息，然后在 3 秒后使用`setTimeout`, 清除它。这是为了给时间观察 DOM 的变化。）

然后，我尝试从`elems`数组中重新填充容器，调用`container.appendChild`每个存储的元素。

我已经在手头的浏览器上进行了测试：Firefox 17.0.1、Chrome 23.0.1271.97、Safari 3.1.2、IE 6 和 IE 7。除了 IE 6 和 7 之外的所有浏览器*实际上都会恢复这些元素*。所以它们成功地存储在内存中并且引用没有被破坏。此外，注册到这些元素的事件处理程序仍然有效。

在 IE 中，元素不会重新出现。

我读过的关于这个问题的内容，包括另一个 SO 问题，似乎表明当您`innerHTML`在容器上修改时引用应该被破坏。事件处理程序也应该被破坏。然而，我测试的 3 个现代浏览器并没有破坏引用，也没有破坏事件处理程序。

当然，要在 IE 中完成这项工作，我可以使用类似的东西，但如果有很多元素，这是一个重要的额外处理：

```
function explicitClearContainer() {
    var e;
    // Explicitly remove all elements
    for (var i = 0; i < elems.length; ++i) {
        e = elems[i];
        // Update the reference to the removed Node
        elems[i] = e.parentNode.removeChild(e);
    }
} 
```

我的问题是对这种行为的了解，在不同的环境中可以预期什么，使用这种技术的陷阱是什么？

我将不胜感激任何评论。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-15T02:03:52.463

innerHTML 属性仅在 HTML5 中“标准化”，它实际上只是记录了许多功能的常见浏览器行为。诸如innerHTML之类的东西在不同的浏览器中实现的方式不同，并且在一段时间内会继续不同，所以如果它引起问题最好避免使用它。

还有其他方法可以清除元素的子节点，例如：

```
function removeContent(element) {
  while (element.firstChild) {
    element.removeChild(element.firstChild);
  }
} 
```

这应该可以避免您的 innerHTML 问题，并且代码比您的版本少一点。您也可以`element`用其自身的浅克隆替换，但这可能会导致其他问题。

# jquery - 用jquery改变html

> ID：14329997
> 
> 赞同：0
> 
> 时间：2013-01-15T01:55:06.287
> 
> 标签：jquery, html, click

我需要使用 jquery 更改单击一个 div 中的文本。像这样：

```
$(document).ready(function() {
$("#hideall").click(function() {
$("#hideall").html("<p>SHOW</p>");
});
}); 
```

HTML是：

```
<div id="hideall" title="Hide all" name="Hide all">
<p>HIDE</p>
</div> 
```

问题是，它应该像显示状态的 div，当它隐藏时，它显示

```
<p>SHOW</p> 
```

当它显示出来时

```
<p>HIDE</p> 
```

我意识到这应该与“if”函数一起使用，但不能分解它。有什么帮助吗？谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-15T01:56:50.917

像这样的东西应该工作

```
$(document).ready(function() {
    $("#hideall").toggle(function() {
        $(this).text('HIDE');
    }, function() {
        $(this).text('SHOW');
    });
}); 
```

**演示：http: [//jsfiddle.net/UN76V/](http://jsfiddle.net/UN76V/)**

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-15T01:57:34.100

或者您可以使用一个名为 hidden 的类来解决这个问题。

```
 $(document).ready(function() {
    $("#hideall").click(function() {
       if ($(this).is('.hidden') {
          $(this).removeClass('hidden').html("<p>SHOW</p>");
        } else {
          $(this).addClass('hidden').html("<p>HIDE</p>");
        }
    });
  }); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-15T01:59:18.500

您可以创建一个变量来检查此状态。

```
$(document).ready(function() {
var isHidden = false; 
$("#hideall").click(function() {
if(isHidden){
    $(this).html("<p>SHOW</p>");
    isHidden = false;
}
else{
   $(this).html("<p>Hidden</p>");
   isHidden = true;
}
});//end click function
});//end ready 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-15T01:59:49.623

试试这个

```
$(document).ready(function () {
  $("#hideall").on('click', function () {
    var $p = $(this).find('p');
    var txt = 'SHOW';
    if ($p.text() === 'SHOW') {
      txt = 'HIDE';
    }
    $p.text(txt);
  });
}); 
```

**[检查小提琴](http://jsfiddle.net/sushanth009/zXBqA/)**

# ios - 将 FBFriendPickerViewController 与 Parse 框架一起使用

> ID：14329999
> 
> 赞同：1
> 
> 时间：2013-01-15T01:55:14.507
> 
> 标签：ios, facebook, friend, picker, parse-framework

我正在尝试构建一个 facebook 朋友选择器。目前我正在使用 Parse 框架使用我的 Fb 帐户登录我的应用程序。您知道使用 Parse 登录后是否可以使用 FacebookSDK 的 FBFriendPickerViewController ？我已经尝试使用[https://developers.facebook.com/docs/howtos/add-search-to-friend-picker-using-ios-sdk/](https://developers.facebook.com/docs/howtos/add-search-to-friend-picker-using-ios-sdk/)但视图控制器不加载任何数据。

我应该从头开始创建朋友选择器吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-26T04:25:11.627

我不确定这是否有帮助，但您可以使用 PF_FBFriendPickerViewController 进行解析。它的工作原理与 FB iOS SDK 中描述的完全一样。