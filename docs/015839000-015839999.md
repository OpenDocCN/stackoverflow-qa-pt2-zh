# StackOverflow 问答 15839000-15839999

# google-maps - 如何使用谷歌地图在街道上绘制一些网络

> ID：15839000
> 
> 赞同：0
> 
> 时间：2013-04-05T16:32:00.353
> 
> 标签：google-maps

所以，我有这个光纤网络。我想知道是否可以绘制电缆穿过的任何街道。

我想实现的目标就像模拟城市，在那里我可以看到我有电网的地方。因此，在某些情况下，我可以绘制整个地区（甚至一个城市）的地图。

我的问题是知道这是否可以通过谷歌地图实现......

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-06T12:04:19.333

我想这真的取决于你的光纤网络数据。一旦您知道您拥有绘制网络的任何图形表示所需的数据，就有多种方法可以在谷歌地图上显示它。如果您的网络数据用连接在一起的地理位置表示，也许您可​​以将网络连接绘制为折线？这至少是一个相当简单的方法。在这里，您可以了解如何在地图中绘制折线：

[https://developers.google.com/maps/documentation/javascript/overlays#Polylines](https://developers.google.com/maps/documentation/javascript/overlays#Polylines)

使用内置的绘图功能（线、多边形、标记、圆等）可能是最容易做的事情，但也有可能拥有更复杂/自定义的叠加层。您还可以在上面的 URL 上找到有关自定义叠加层的更多信息。

# php - 使用数组和 memcached 创建小时统计信息

> ID：15839005
> 
> 赞同：0
> 
> 时间：2013-04-05T16:32:15.450
> 
> 标签：php, multidimensional-array, memcached

我正在尝试计算每小时在我的网站上的点击次数，但不知道如何处理这个问题。

这是我现在拥有的：

```
if($cacheAvailable == true){ // WE GOT A CACHE

    date_default_timezone_set("UTC");
    $thisHour = date("H", time());

    $moveStats = $memcache->get('moveStats');

    if(!$moveStats){
        $todayStats = array(array(hour => $thisHour, hits => 1, executetime => $total_time));
        $memcache->set('moveStats', $todayStats);
    } 

    foreach ($moveStats as $k => $v) {
        if($v['hour'] == $thisHour){
            $moveStats[$k]['hits']=$moveStats[$k]['hits']+1;
        }
    }

    $memcache->set('moveStats', $moveStats);

    echo '<pre>';
    print_r($moveStats);
    echo '</pre>';

} 
```

这使得一个像这样的数组：

```
Array
(
    [0] => Array
        (
            [hour] => 18
            [hits] => 6
            [executetime] => 0
        )

) 
```

//＃＃＃＃＃ 编辑 ＃＃＃＃＃＃//

我可以添加到当前小时，但我不知道如何在时钟变成新小时时添加新小时？

希望得到帮助并提前感谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-05T18:13:47.963

You just have to check if that index already exists, if not create a new one, and always increase the old value:

```
$todayStats = $moveStats;
if (!isset($todayStats [$thisHour])) {
    $todayStats[$thisHour] = 0;
}
$todayStats[$thisHour]['hits']++;
$todayStats[$thisHour]['executetime'] = $total_time; 
```

But you have some other problems in your implementation: - Don't use string without quotes. That will try to call a constant with that name and only as fallback return the string itself. It also raises a notice. - $thisHour won't contain the current hour. If you really want to have the hour try: date('H') only.

# zend-framework2 - Zend Framework 2 - 登录时隐藏登录链接，反之亦然注销

> ID：15839010
> 
> 赞同：-1
> 
> 时间：2013-04-05T16:32:35.590
> 
> 标签：zend-framework2

我对 ZF2 很陌生，我正在尝试找到一种简单的方法来允许登录链接隐藏在用户已登录的视图中，并在用户注销时再次显示。我已经查看了 ZF2 的 ACL 示例，但我仍然有点困惑，我不确定这是否真的是实现如此简单的事情所需要的。

如果有人可以分享一些关于如何做到这一点的知识，我会永远感激不尽。谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-06T17:05:25.803

可以帮助您解决此问题的标准[身份视图助手。](https://github.com/zendframework/zf2/blob/master/library/Zend/View/Helper/Identity.php)如果您将身份验证服务添加到服务管理器，这将开箱即用，例如在您的模块中是`config/module.config.php`这样的：

```
/* Some configuration omitted */

return array(
    'service_manager' => array(
        'Zend\Authentication\AuthenticationService' => function($sm) {
            $authService = new \Zend\Authentication\AuthenticationService();
            $authService->setStorage(new \Zend\Authentication\Storage\Session('user', 'details'));

            return $authService;
        },
    ),
); 
```

然后你可以在你的视图脚本中这样做：

```
if ($this->identity() == null) {
    // User is not logged in; show login link here
}

else {
    // User is logged in; show profile link here or do nothing
} 
```

# java - 用正则表达式将一个字符替换为其他索引？

> ID：15839015
> 
> 赞同：0
> 
> 时间：2013-04-05T16:32:42.817
> 
> 标签：java, regex

可以使用匹配索引中的特定字符替换 java 中 String 中的字符。

例如：

我想使用一些特定的地图：

a=d , b=e , c=f

然后：a 想用 d 代替 a，用 e 代替 b，用 f 代替 c。

这是代码的想法：

```
 String src = "text_abc";
    String regex = "a|b|c";
    String replacement = "d|e|f";
    String replaced = src.replace(regex, replacement); 
```

我不知道我应该在正则表达式中使用什么正则表达式并替换它。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-05T16:35:11.613

你为什么不这样做呢？

```
String replaced = src.replace("a", "d").replace("b", "e").replace("c", "f"); 
```

另请注意，要使用正则表达式，您需要使用`replaceAll()`not `replace()`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-09-24T10:48:29.923

您可以使用[`String.replace(char, char)`](http://docs.oracle.com/javase/7/docs/api/java/lang/String.html#replace(char,%20char))这种情况。

```
String src = "text_abc";
String replaced = src.replace('a', 'd')
                     .replace('b', 'e')
                     .replace('c', 'f'); 
```

如果您坚持使用正则表达式（在这种情况下这是一个愚蠢的想法，它效率低下且不必要地不可维护），您可以使用`Map`带有相应查找的替换：

```
String src = "text_abc";

// Can move these to class level for reuse.
final HashMap<String, String> map = new HashMap<>();
map.put("a", "d");
map.put("b", "e");
map.put("c", "f");
final Pattern pattern = Pattern.compile("[abc]");

String replaced = src;
Matcher matcher;
while ((matcher = pattern.matcher(replaced)).find())
    replaced = matcher.replaceFirst(map.get(matcher.group()));

// System.out.println(replaced); 
```

这是一个[在线代码演示](http://jdoodle.com/a/cp)。

# jquery - ReferenceError: $ is not defined - jQuery not working on my computer

> ID：15839018
> 
> 赞同：3
> 
> 时间：2013-04-05T16:32:49.153
> 
> 标签：jquery, zurb-foundation

我正在使用基础来构建一个基本站点，但我遇到了一个有点奇怪的问题......我似乎无法在 chrome 和 Firefox 中加载 jQuery（我没有尝试过其他的）。

提示我 jQuery 未加载的是错误消息：

错误：**ReferenceError：$ 未定义**

我在模板末尾调用函数基础：

```
 <script>
    $(document).foundation();
  </script> 
```

但在此之前，在页脚之后（在其他 .js 之前）：

```
 <script>
      document.write('<script src="/js/vendor/'
        + ('__proto__' in {} ? 'zepto' : 'jquery')
        + '.js"><\/script>');
  </script> 
```

这是调用 jQuery 或 Zepto。但是由于担心这个功能可能无法正常工作（我不是 javascript 专家......）我插入：

```
 <script src="http://code.jquery.com/jquery-latest.js"></script> 
```

到代码和其他变体......但似乎没有任何效果。

此外，我还在其他项目中使用 Bootstrap，我注意到工具提示和其他东西等小细节通常可以工作，但设计不正确。我不确定它与jQuery无关......

我知道这是一种奇怪的假设，但是我的计算机是否有可能无法正常使用 jQuery？我被引导相信这一点，因为我在我的计算机中编写的代码片段在这里不能很好地工作（如引导工具提示），但在我朋友的计算机上工作得很好。

不工作的完整代码：

```
 <!-- End Header and Nav -->

  <script src="http://code.jquery.com/jquery-latest.js"></script>

<!--
  <script>
      document.write('<script src="/Foundation_custom/js/vendor/'
        + ('__proto__' in {} ? 'zepto' : 'jquery')
        + '.js"><\/script>');
  </script>
-->

<!--  <script src="/Foundation_custom/js/foundation.min.js"></script>-->

  <script src="/Foundation_custom/js/foundation/foundation.js"></script>

  <script src="/Foundation_custom/js/foundation/foundation.alerts.js"></script>

  <script src="/Foundation_custom/js/foundation/foundation.clearing.js"></script>

  <script src="/Foundation_custom/js/foundation/foundation.cookie.js"></script>

  <script src="/Foundation_custom/js/foundation/foundation.dropdown.js"></script>

  <script src="/Foundation_custom/js/foundation/foundation.forms.js"></script>

  <script src="/Foundation_custom/js/foundation/foundation.joyride.js"></script>

  <script src="/Foundation_custom/js/foundation/foundation.magellan.js"></script>

  <script src="/Foundation_custom/js/foundation/foundation.orbit.js"></script>

  <script src="/Foundation_custom/js/foundation/foundation.placeholder.js"></script>

  <script src="/Foundation_custom/js/foundation/foundation.reveal.js"></script>

  <script src="/Foundation_custom/js/foundation/foundation.section.js"></script>

  <script src="/Foundation_custom/js/foundation/foundation.tooltips.js"></script>

  <script src="/Foundation_custom/js/foundation/foundation.topbar.js"></script>

  <script>
    $(document).foundation();
  </script>

</body>
</html> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-05T16:38:55.057

检查 jQuery 库是否实际加载。根据您的浏览器设置，如果您从计算机本地加载它，有时浏览器会阻止来自远程源的脚本。

你可以看看控制台来检查一下。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-07T10:20:43.993

您必须等待文档就绪事件。试试这个：

```
<script>
$(function() {
   $(document).foundation();
});
</script> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-06-24T20:39:02.770

确保没有 jQuery.noConflict(); 在 jquery.js 的最后一行

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-07-09T16:28:53.600

通常，jQuery 库或 Zepto 库被插入到页面中尽可能低的位置，就在结束标记之前。

确保在包含 jQuery/Zepto 的行之后插入脚本：

```
<script>
  document.write('<script src=/js/vendor/' +
  ('__proto__' in {} ? 'zepto' : 'jquery') +
  '.js><\/script>')
</script> 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-12-09T09:51:44.113

您可以重新初始化它：
$(document).foundation('tooltip');

# sql-server-2008-r2 - SSRS 2008 R2 参数下拉条件可用性

> ID：15839022
> 
> 赞同：0
> 
> 时间：2013-04-05T16:32:57.373
> 
> 标签：sql-server-2008-r2, ssrs-2008

在 SQL Server 2008 R2 的 SSRS 中，是否可以在下拉列表中有一个参数，允许多个值，除非选择了特定值？

例如，参数列表可以具有值 A、B、C、D 和 E。

用户可以选择 A、B 或 C 的任意组合。但是，如果用户选择 D 或 E，则无法选择其他值。只能选择 D 或 E。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-19T23:26:02.680

在参数列表中选择值不会触发事件，因此无法动态控制可以选择哪些其他值。最好的解决方案是在单击“查看报告”按钮后控制行为。

1.  添加一条解释无效选择的消息。
2.  向其添加可见性表达式，使其仅在适用时显示。
3.  将相反的可见性表达式条件添加到包含报表其余部分的矩形。

这样，当您尝试查看包含无效组合的报告时，您会收到一条友好的警告消息。

# wpf - GetPositionAtOffset 仅等效于文本？

> ID：15839031
> 
> 赞同：7
> 
> 时间：2013-04-05T16:33:23.767
> 
> 标签：wpf, wpf-controls, richtextbox

是否有一个**相当好的**解决方案`GetPositionAtOffset()`，它只计算文本插入位置而不是所有符号？

C# 中的动机示例：

```
TextRange GetRange(RichTextBox rtb, int startIndex, int length) {
    TextPointer startPointer = rtb.Document.ContentStart.GetPositionAtOffset(startIndex);
    TextPointer endPointer = startPointer.GetPositionAtOffset(length);
    return new TextRange(startPointer, endPointer);
} 
```

编辑：到目前为止，我以这种方式“解决”了它

```
public static TextPointer GetInsertionPositionAtOffset(this TextPointer position, int offset, LogicalDirection direction)
{
    if (!position.IsAtInsertionPosition) position = position.GetNextInsertionPosition(direction);
    while (offset > 0 && position != null)
    {
        position = position.GetNextInsertionPosition(direction);
        offset--;
        if (Environment.NewLine.Length == 2 && position != null && position.IsAtLineStartPosition) offset --; 
    }
    return position;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-09-06T09:02:00.187

据我所知，没有。我的建议是您为此目的创建自己的 GetPositionAtOffset 方法。您可以使用以下方法检查 TextPointer 与哪个 PointerContext 相邻：

```
TextPointer.GetPointerContext(LogicalDirection); 
```

要获取指向不同 PointerContext 的下一个 TextPointer：

```
TextPointer.GetNextContextPosition(LogicalDirection); 
```

我在最近的一个项目中使用了一些示例代码，这通过循环直到找到一个来确保指针上下文是文本类型。您可以在您的实现中使用它并在找到时跳过偏移增量：

```
// for a TextPointer start

while (start.GetPointerContext(LogicalDirection.Forward) 
                             != TextPointerContext.Text)
{
    start = start.GetNextContextPosition(LogicalDirection.Forward);
    if (start == null) return;
} 
```

希望您可以利用这些信息。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-11-14T15:54:07.797

很长一段时间都没有找到有效的解决方案。下一段代码在我的情况下具有最高性能。希望它也会对某人有所帮助。

```
TextPointer startPos = rtb.Document.ContentStart.GetPositionAtOffset(searchWordIndex, LogicalDirection.Forward);
startPos = startPos.CorrectPosition(searchWord, FindDialog.IsCaseSensitive);
if (startPos != null)
{
    TextPointer endPos = startPos.GetPositionAtOffset(textLength, LogicalDirection.Forward);
    if (endPos != null)
    {
         rtb.Selection.Select(startPos, endPos);
    }
}

public static TextPointer CorrectPosition(this TextPointer position, string word, bool caseSensitive)
{
   TextPointer start = null;
   while (position != null)
   {
       if (position.GetPointerContext(LogicalDirection.Forward) == TextPointerContext.Text)
       {
           string textRun = position.GetTextInRun(LogicalDirection.Forward);

           int indexInRun = textRun.IndexOf(word, caseSensitive ? StringComparison.InvariantCulture : StringComparison.InvariantCultureIgnoreCase);
           if (indexInRun >= 0)
           {
               start = position.GetPositionAtOffset(indexInRun);
               break;
           }
       }

       position = position.GetNextContextPosition(LogicalDirection.Forward);
   }

   return start; } 
```

# c++ - 如何将数字转换为 0.mynumber

> ID：15839034
> 
> 赞同：0
> 
> 时间：2013-04-05T16:33:46.347
> 
> 标签：c++, numbers, converter

如何将数字转换为 0。和数字？

所以

```
int i = 50;
float a = 0.i //wrong code :D 
```

要不然是啥？我该怎么做？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-05T16:34:53.140

```
float a = i;
while( a >= 1.0f ) a /= 10.0f; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-05T16:39:17.537

这很丑，但我认为这有效：

```
 int i = 50;
    std::stringstream ss;
    ss << "0." << i;
    float a;
    ss >> a; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-05T21:21:25.990

关于什么：

```
#include <cmath>
#include <initializer_list>
#include <iostream>

float zero_dot( float m ) {
   return m / pow( 10.0, floor( log( m ) / log( 10.0 ) ) + 1 );
}

int main() {

   for( auto const & it: { 5.0, 50.0, 500.0, 5509.0, 1.0 } ) {
      std::cout << it << ": " << zero_dot( it ) << std::endl;
   }

   return 0;
} 
```

输出是：

```
5: 0.5
50: 0.5
500: 0.5
5509: 0.5509
1: 0.1 
```

计算不使用任何循环。

# cryptography - 7-zip 如何检查您提供的密码是否正确？

> ID：15839035
> 
> 赞同：4
> 
> 时间：2013-04-05T16:33:47.243
> 
> 标签：cryptography, compression, 7zip

我试图了解 7-zip 如何准确识别您提供的密码是否正确。

例如，我有一个文件 x.7z，我用“密码”保护了密码。在我尝试打开它之前，界面要求我输入密码。7zip 如何在尝试解压缩文件并失败之前检查此密码是否正确？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-05T16:38:04.773

它使用密码作为密钥[使用 AES 加密文件。](http://en.wikipedia.org/wiki/7-Zip#Features)通常，这些东西会尝试解密它知道值的块（例如每个 7z 文件的相同标头），然后将解密的值与预期的值进行比较。如果它们不匹配，则它知道密码不正确。

# c - 如何从文件函数中进行工作读取？

> ID：15839037
> 
> 赞同：0
> 
> 时间：2013-04-05T16:33:52.473
> 
> 标签：c

```
int main()
{
    char a[100][100];
    int i = 0, k = 0;
    FILE* file = fopen( "A:/input.txt", "r" );
    if( file == NULL ){
        perror( "Error opening file !\n" );
    } else {
        while( ! feof( file )){
            fscanf( file, "%d;%s\n", &i, a[i] );
        }
    }
    for( ; k < i; ++k ){
        printf( "%d -> %s\n", k, a[k] );
    }
    return 0;
} 
```

我有这段工作代码，我试图将它实现为这样的函数：

```
int reader(char b[20], char *a[100][100], int *i){
    int j = 0;
    FILE* file = fopen(b, "r" );
    if( file == NULL ){
        perror( "Error opening file !\n" );
    } else {
        while( ! feof( file )){
            fscanf( file, "%d;%s\n", j, a[j] );
        }
    }
*i = j;
return 0;} 
```

并从 main 拨打电话：

```
char a[100][100];
int i = 0;
reader("Type.txt", &a, &i); 
```

但是当我使用该功能时，代码在 fscanf 调用时崩溃。任何想法我怎样才能使这项工作或我怎样才能创建一个函数从文件中逐行读取并以这种形式创建一个数组：array[0] = firstline、array[1] = secondline 等。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-05T16:35:36.533

你在你的`main()`函数中使用变量正确地做到了`i`，但是当你把它移到一个函数时你忘记了一个符号。您需要将地址传递`j`给`fscanf()`：

```
fscanf( file, "%d;%s\n", &j, a[j] ); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-05T16:40:03.757

首先，您必须在此行中添加`&`to`j`

```
fscanf( file, "%d;%s\n", j, a[j] ); 
```

它应该是

```
fscanf( file, "%d;%s\n", &j, a[j] ); 
```

函数的输入数组也不应该包含星号`*`

```
int reader(char b[20], char a[100][100], int *i){ 
```

# ruby-on-rails - Rails 平均 - 折扣 0 值

> ID：15839039
> 
> 赞同：0
> 
> 时间：2013-04-05T16:33:57.427
> 
> 标签：ruby-on-rails, ruby-on-rails-3, ruby-on-rails-3.1

我创建了数组，我需要找到如下的平均值：

```
total_rating = []
#add numbers to total_rating
average = total_rating.inject(:+).to_f / total_rating.size 
```

如何从此平均计算中删除 0 值？我不希望在平均计算中计算 0 行。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-05T16:35:27.037

```
total_rating.reject(&:zero?) 
```

# java - 如何在 Java 中格式化具有多个日期的字符串

> ID：15839041
> 
> 赞同：1
> 
> 时间：2013-04-05T16:34:02.370
> 
> 标签：java, localization, date-formatting

我想格式化一个包含多个日期/时间模式的字符串。例如：

```
'Starting on' EEEE 'at' h:mm a 'and ending on' MMM d 
```

在这里，我尝试使用相同格式字符串中的两个日期，一个开始日期和一个结束日期。我不想把它分成两个字符串，因为句子的顺序和结构在其他语言中可能不同，我不想在我的代码中加入任何假设。据我所知，这不能用 SimpleDateFormat 完成，因为 format() 方法只接受一个日期对象。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-05T16:37:18.177

您可以使用[java.text.MessageFormat](http://docs.oracle.com/javase/1.4.2/docs/api/java/text/MessageFormat.html)来提供所需的数据格式。

```
String result = MessageFormat.format(
     "At {1,time} on {1,date}, there was {2} on planet {0,number,integer}.",
     arguments); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-05T16:45:49.570

请参阅[http://docs.oracle.com/javase/7/docs/api/java/util/Formatter.html#dt](http://docs.oracle.com/javase/7/docs/api/java/util/Formatter.html#dt)，例如：

```
 Date today = new Date();
    Date yesterday = new Date();
    yesterday.setTime(today.getTime() - (1000*60*60*24) );
    System.out.printf( "Yesterday was: %ta, today is: %ta%n ", yesterday, today ); 
```

输出

```
 Yesterday was: Thu, today is: Fri 
```

# jquery - 使用 jQuery 的 Ajax 纯 JSONP 请求

> ID：15839042
> 
> 赞同：2
> 
> 时间：2013-04-05T16:34:04.750
> 
> 标签：jquery, ajax, jsonp

好的。我到处搜索，没有找到任何可以理解的答案。请注意这是我第一次实施这种请求。（“我认为每个人都会发生”）：P 问题：我有一个 json 文件，例如[https://www.example.com/something.json](https://www.example.com/something.json)，我想使用 Ajax 通过 JSONP 请求它。我已经读过，为了发出 JSONP 请求，您必须将数据包装到回调函数中。所以我编辑了生成 json 文件的 php 文件并添加了 $_GET('callback') 函数来包装数据。因此，如果我在浏览器中键入[https://www.example.com/something.json/?callback=jsonpCallBack](https://www.example.com/something.json/?callback=jsonpCallBack)我可以看到我的数据包装 jsonpCallBack([{.......}]);

在 jQuery 中，我现在尝试访问此信息并每 20 秒将数据附加到 html 中。所以我有

```
 var url='https://www.example.com/something.json/?callback=jsonpCallBack';

      var main= $.ajax({
                type:'GET',
                url : url, 
                dataType:'jsonp',
                jsonpCallback:'jsonpCallBack',
                success: function(data)
                {
                    .......
                     var outputhtml='<ul>';
                     var item = [];
                      for(var i =0; i < data.length-1 ;i++)
                      {

                        var item = data[i];
                        ..........
                     $('.div').html(outputhtml) ;
                }

            });

setInterval(function() {
    main;
},20000);

    main; 
```

但相反，我看不到我的数据更新。我错过了什么？我还需要使用 $.getJSON() 函数来获取数据吗？如果是，将在代码中添加到哪里？

很多混乱...

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-05T21:05:34.483

试试这样：

```
var main = function() {
    var url = 'https://www.example.com/something.json/';
    $.ajax({
        url: url,
        jsonp: 'callback',
        dataType: 'jsonp',
        success: function (result) {
            ...
        }
    });
};

window.setInterval(main, 20000);
main(); 
```

`https://www.example.com/something.json/?callback=foobar`如果返回以下结果（您在问题中提到的情况，对吗？），哪个会起作用：

```
foobar({...}) 
```

# python - 有没有一种pythonic方法可以将文件名添加到绝对路径？

> ID：15839043
> 
> 赞同：2
> 
> 时间：2013-04-05T16:34:10.927
> 
> 标签：python, django

我正在`sqlite3`用作 django 的数据库。我现在正在学习，所以我想知道将文件名添加到现有路径的最佳方法。这个例子来自我的 django`settings.py`文件：

```
BASE_DIR = os.path.abspath(os.path.join(os.path.dirname(__file__), os.pardir))  # Creating base directory
DB_NAME = os.path.join(BASE_DIR, 'database')                                    # Adding database name
if os.sep != '/':                                                               # For all cases (bullet-proofing)
    DB_NAME.replace(os.sep, '/')                                                # replacing
DB_NAME += (os.sep + 'sqlite3DB.db')                                            # Adding file name manually 
```

为了添加数据库文件的名称，我只是简单地添加了 a`/`和文件的名称，在这种情况下是`sqlite3DB.db`. 我这样做是因为我正在关注 Database Setup 中的django*教程*[页面](https://docs.djangoproject.com/en/1.5/intro/tutorial01/)。有没有更优雅的方式来做到这一点？一种更 Pythonic 的方式，因为感觉就像我在硬编码东西。任何帮助将非常感激。

 *我还没有创建`sqlite3DB.db`，因为在教程中已经说过它将由 django 为我创建。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-05T16:53:35.390

不确定你有什么问题，但你可以`os.path.join`直接使用文件名来生成绝对路径

```
os.path.join(DB_NAME, 'sqlite3DB.db') 
```

是你要找的吗？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-05T16:59:30.907

不确定你真正需要什么。如果它使用您已经正确提及的路径加入文件名

```
DB_NAME = os.path.join(BASE_DIR, 'database') 
```

如果它添加到系统路径，那么你可以做这样的事情

```
import sys
sys.path = ['/opt/test/'] + sys.path 
```

如果你需要 cd 到目录..你可以做这样的事情

```
os.chdir(os.path.dirname(__file__)) 
```*

# jquery - 从 iframe 控制 JPlayer

> ID：15839046
> 
> 赞同：1
> 
> 时间：2013-04-05T16:34:22.630
> 
> 标签：jquery, jplayer

我正在尝试暂停我的 JPlayer 从我的 iframe 中播放音频。

我尝试使用此代码

```
$('#jquery_jplayer_1', window.parent.document).jPlayer('pause', 0); 
```

它似乎不起作用。请帮忙...

# android - Android 应用程序：在 textView 中从 SQLite 打印值

> ID：15839054
> 
> 赞同：0
> 
> 时间：2013-04-05T16:34:53.517
> 
> 标签：android, sqlite

运行应用程序后，不会打印数据库中的值。它打印出一些看起来像值的位置地址的东西？

向 db 添加值并尝试在 textView1 中打印

```
package com.androidhive.androidsqlite;

import java.util.List;

import android.app.Activity;
import android.os.Bundle;
import android.util.Log;
import android.widget.TextView;

public class AndroidSQLiteTutorialActivity extends Activity {
    /** Called when the activity is first created. */
    TextView text;

    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.main);

        DatabaseHandler db = new DatabaseHandler(this);

        /**
         * CRUD Operations
         * */
        // Inserting Contacts
        Log.d("Insert: ", "Inserting ..");
        db.addContact(new Contact("Ravi", "9100000000"));
        db.addContact(new Contact("Srinivas", "9199999999"));
        db.addContact(new Contact("Tommy", "9522222222"));
        db.addContact(new Contact("Karthik", "9533333333"));

        // Reading all contacts
        Log.d("Reading: ", "Reading all contacts..");
        List<Contact> contacts = db.getAllContacts();       

        for (Contact cn : contacts) {
            String log = "Id: "+cn.getID()+" ,Name: " + cn.getName() + " ,Phone: " + cn.getPhoneNumber();
                // Writing Contacts to log
        Log.d("Name: ", log);

        }
        Contact rando = db.getContact(1);
        text = (TextView) findViewById(R.id.textView1);
        text.setText(String.valueOf(rando));

    }
} 
```

接触类

```
package com.androidhive.androidsqlite;

public class Contact {

    //private variables
    int _id;
    String _name;
    String _phone_number;

    // Empty constructor
    public Contact(){

    }
    // constructor
    public Contact(int id, String name, String _phone_number){
        this._id = id;
        this._name = name;
        this._phone_number = _phone_number;
    }

    // constructor
    public Contact(String name, String _phone_number){
        this._name = name;
        this._phone_number = _phone_number;
    }
    // getting ID
    public int getID(){
        return this._id;
    }

    // setting id
    public void setID(int id){
        this._id = id;
    }

    // getting name
    public String getName(){
        return this._name;
    }

    // setting name
    public void setName(String name){
        this._name = name;
    }

    // getting phone number
    public String getPhoneNumber(){
        return this._phone_number;
    }

    // setting phone number
    public void setPhoneNumber(String phone_number){
        this._phone_number = phone_number;
    }
} 
```

处理程序

```
package com.androidhive.androidsqlite;

import java.util.ArrayList;
import java.util.List;

import android.content.ContentValues;
import android.content.Context;
import android.database.Cursor;
import android.database.sqlite.SQLiteDatabase;
import android.database.sqlite.SQLiteOpenHelper;

public class DatabaseHandler extends SQLiteOpenHelper {

    // All Static variables
    // Database Version
    private static final int DATABASE_VERSION = 1;

    // Database Name
    private static final String DATABASE_NAME = "contactsManager";

    // Contacts table name
    private static final String TABLE_CONTACTS = "contacts";

    // Contacts Table Columns names
    private static final String KEY_ID = "id";
    private static final String KEY_NAME = "name";
    private static final String KEY_PH_NO = "phone_number";

    public DatabaseHandler(Context context) {
        super(context, DATABASE_NAME, null, DATABASE_VERSION);
    }

    // Creating Tables
    @Override
    public void onCreate(SQLiteDatabase db) {
        String CREATE_CONTACTS_TABLE = "CREATE TABLE " + TABLE_CONTACTS + "("
                + KEY_ID + " INTEGER PRIMARY KEY," + KEY_NAME + " TEXT,"
                + KEY_PH_NO + " TEXT" + ")";
        db.execSQL(CREATE_CONTACTS_TABLE);
    }

    // Upgrading database
    @Override
    public void onUpgrade(SQLiteDatabase db, int oldVersion, int newVersion) {
        // Drop older table if existed
        db.execSQL("DROP TABLE IF EXISTS " + TABLE_CONTACTS);

        // Create tables again
        onCreate(db);
    }

    /**
     * All CRUD(Create, Read, Update, Delete) Operations
     */

    // Adding new contact
    void addContact(Contact contact) {
        SQLiteDatabase db = this.getWritableDatabase();

        ContentValues values = new ContentValues();
        values.put(KEY_NAME, contact.getName()); // Contact Name
        values.put(KEY_PH_NO, contact.getPhoneNumber()); // Contact Phone

        // Inserting Row
        db.insert(TABLE_CONTACTS, null, values);
        db.close(); // Closing database connection
    }

    // Getting single contact
    Contact getContact(int id) {
        SQLiteDatabase db = this.getReadableDatabase();

        Cursor cursor = db.query(TABLE_CONTACTS, new String[] { KEY_ID,
                KEY_NAME, KEY_PH_NO }, KEY_ID + "=?",
                new String[] { String.valueOf(id) }, null, null, null, null);
        if (cursor != null)
            cursor.moveToFirst();

        Contact contact = new Contact(Integer.parseInt(cursor.getString(0)),
                cursor.getString(1), cursor.getString(2));
        // return contact
        return contact;
    }

    // Getting All Contacts
    public List<Contact> getAllContacts() {
        List<Contact> contactList = new ArrayList<Contact>();
        // Select All Query
        String selectQuery = "SELECT  * FROM " + TABLE_CONTACTS;

        SQLiteDatabase db = this.getWritableDatabase();
        Cursor cursor = db.rawQuery(selectQuery, null);

        // looping through all rows and adding to list
        if (cursor.moveToFirst()) {
            do {
                Contact contact = new Contact();
                contact.setID(Integer.parseInt(cursor.getString(0)));
                contact.setName(cursor.getString(1));
                contact.setPhoneNumber(cursor.getString(2));
                // Adding contact to list
                contactList.add(contact);
            } while (cursor.moveToNext());
        }

        // return contact list
        return contactList;
    }

    // Updating single contact
    public int updateContact(Contact contact) {
        SQLiteDatabase db = this.getWritableDatabase();

        ContentValues values = new ContentValues();
        values.put(KEY_NAME, contact.getName());
        values.put(KEY_PH_NO, contact.getPhoneNumber());

        // updating row
        return db.update(TABLE_CONTACTS, values, KEY_ID + " = ?",
                new String[] { String.valueOf(contact.getID()) });
    }

    // Deleting single contact
    public void deleteContact(Contact contact) {
        SQLiteDatabase db = this.getWritableDatabase();
        db.delete(TABLE_CONTACTS, KEY_ID + " = ?",
                new String[] { String.valueOf(contact.getID()) });
        db.close();
    }

    // Getting contacts Count
    public int getContactsCount() {
        String countQuery = "SELECT  * FROM " + TABLE_CONTACTS;
        SQLiteDatabase db = this.getReadableDatabase();
        Cursor cursor = db.rawQuery(countQuery, null);
        cursor.close();

        // return count
        return cursor.getCount();
    }

} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-05T16:38:03.453

真是巧合。大约一个小时前，其他人遇到了完全相同的问题！

listview 正在调用`toString()`以表示您的`Contact`类的实例。您没有覆盖该方法，因此调用`toString()`了默认方法。`Object.toString()`

```
@Override
public String toString(){
   return this._name; // whatever you need to represent this instance of Contact
} 
```

此外，而不是：

```
text.setText(String.valueOf(rando)); 
```

采用

```
text.setText(rando.toString()); 
```

# java - 带有滚动箭头但没有滚动条的 JScrollPane

> ID：15839056
> 
> 赞同：2
> 
> 时间：2013-04-05T16:35:06.623
> 
> 标签：java, swing, jscrollpane, custom-component, jscrollbar

我想在这张图片上创建滚动窗格： ![在此处输入图像描述](https://i.stack.imgur.com/aZaP6.png)

组件侧面带有箭头，并且没有可见的滚动条。只需要水平滚动。可以用 JScrollPane 完成吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-05T17:08:12.823

您可以通过使用滚动窗格并创建自己的按钮来使用滚动条的操作来创建自己的组件：

```
import java.awt.*;
import javax.swing.*;
import javax.swing.plaf.basic.*;

public class ScrollPaneSSCCE extends JPanel
{
    public ScrollPaneSSCCE()
    {
        setLayout( new BorderLayout() );

        JTextArea textArea = new JTextArea(1, 80);
        textArea.setText("Hopefully this will answer your question");
        JScrollPane scrollPane = new JScrollPane( textArea );
        scrollPane.setHorizontalScrollBarPolicy(ScrollPaneConstants.HORIZONTAL_SCROLLBAR_NEVER);
        add(scrollPane);

        JScrollBar horizontal = scrollPane.getHorizontalScrollBar();

        BasicArrowButton west = new BasicArrowButton(BasicArrowButton.WEST);
        west.setAction( new ActionMapAction("", horizontal, "negativeUnitIncrement") );
        add(west, BorderLayout.WEST);

        BasicArrowButton east = new BasicArrowButton(BasicArrowButton.EAST);
        east.setAction( new ActionMapAction("", horizontal, "positiveUnitIncrement") );
        add(east, BorderLayout.EAST);
    }

    private static void createAndShowUI()
    {
        JFrame frame = new JFrame("ScrollPaneSSCCE");
        frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
        frame.add(new ScrollPaneSSCCE(), BorderLayout.NORTH);
        frame.setSize(100, 100);
        frame.setLocationByPlatform( true );
        frame.setVisible( true );
    }

    public static void main(String[] args)
    {
        EventQueue.invokeLater(new Runnable()
        {
            public void run()
            {
                createAndShowUI();
            }
        });
    }
} 
```

您还需要使用[Action Map Action](http://tips4java.wordpress.com/2008/12/06/action-map-action/)类。

# asp.net-mvc - 在 ASP.NET MVC 4 中，有没有一种方法可以为单个操作添加自定义 DateTime 模型绑定器？

> ID：15839057
> 
> 赞同：0
> 
> 时间：2013-04-05T16:35:06.837
> 
> 标签：asp.net-mvc, datetime, asp.net-mvc-4, model-binding, custom-model-binder

我正在尝试将表单绑定到控制器中的模型参数。该模型包含一个 DateTime 字段，我希望在提交表单时绑定它。表单字段希望以非标准格式输入日期（由于各种原因，我无法更改）。

控制器动作是：

```
public ActionResult Registration_Post(RegistrationDetails model) 
```

我只需要在 RegistrationDetails 类中自定义绑定一个 (DateTime) DateOfBirth 属性。所有其余属性都使用默认绑定。

我不想覆盖整个应用程序的 DateTime 绑定 - 只是为了这个单个操作（或者，如果更简单，控制器）。

知道我该怎么做吗？我尝试在操作上使用 ModelBinder 属性，如下所示：

```
public ActionResult Registration_Post([ModelBinder(typeof(CustomDateTimeBinder)]RegistrationDetails model) 
```

但是，看来我需要为整个 RegistrationDetails 类创建一个自定义活页夹，这似乎有点矫枉过正。

另外，我不希望将自定义格式放在模型属性上，因为该类在其他地方使用，所以我污染了该类。

我正在使用 MVC4。

谁能告诉我处理这个的最好方法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-05T17:02:28.203

试试这个：创建一个自定义模型绑定器提供程序。

在您的 BindModel 方法中，您必须添加逻辑来处理只有来自 Registration_Post 操作的出生日期具有特殊格式的要求。顺便说一句，您需要绑定整个模型。

```
using System;
using System.Web.Mvc;
using MvcApp.Models;

public class CustomModelBinderProvider : IModelBinderProvider 
{
    public IModelBinder GetBinder(Type modelType) 
    {
        return modelType == typeof(Person) ? new PersonModelBinder() : null;
    }
}

protected void Application_Start()
{    
    ModelBinderProviders.BinderProviders.Add(new CustomModelBinderProvider());    
}

public class PersonModelBinder : IModelBinder 
{
    public object BindModel(ControllerContext controllerContext, ModelBindingContext   
                            bindingContext) 
   {
         //add logic here to bind the person object
   } 
```

# python - 将带有 3 个子列表的列表打印到 python 中的文件的最佳方法是什么？

> ID：15839058
> 
> 赞同：2
> 
> 时间：2013-04-05T16:35:08.937
> 
> 标签：python

我有一个包含 3 个子列表的“本地化”列表。我想将此列表打印到一个文件中，每个子列表在一列中。

例如：

```
>>>print localisation

localisation = [['a', 'b', 'c'],['d', 'e', 'f'],['g', 'h', 'i']] 
```

我想要一个看起来像这样的文件：

```
a   d   g
b   e   h
c   f   i 
```

（列可以用单个空格、制表符等分隔）

目前我正在这样做：

```
with open("rssi.txt") as fd:
    for item in localisation:
        print>>fd, item 
```

有没有更好的方法，例如一次打印整个列表的单行？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-05T16:36:26.697

```
localisation = [['a', 'b', 'c'], ['d', 'e', 'f'], ['g', 'h', 'i']]

with open("rssi.txt") as f:
    f.write('\n'.join(' '.join(row) for row in zip(*localisation)))

# a d g
# b e h
# c f i 
```

```
>>> localisation = [['a', 'b', 'c'], ['d', 'e', 'f'], ['g', 'h', 'i']]
>>> zip(*localisation)
[('a', 'd', 'g'), ('b', 'e', 'h'), ('c', 'f', 'i')] 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-05T16:37:47.497

```
with open("rssi.txt", "w") as f:
    for col in zip(*localisation):
        f.write(' '.join(str(x) for x in col) + '\n') 
```

如果您的内部列表中的每个项目都已经是一个字符串，您可以使用`' '.join(col) + '\n'`, 来使用制表符而不是空格分隔`'\t'.join(...)`。

# codeigniter - codeigniter中的分页超出限制

> ID：15839065
> 
> 赞同：0
> 
> 时间：2013-04-05T16:35:34.600
> 
> 标签：codeigniter, pagination

下面的代码清单在消息控制器的一个函数中。我希望一个页面在一个页面上一次只有 5 条记录。在codeignuter中使用分页类我已经设置了限制，这意味着如果一个页面只有三个记录，那么在视图的分页链接中只显示一个，例如< 1而不是< 1 2。如果最后一页也会发生这种情况页数为 8 它显示 9 因此 <... 8 9\. 我错过了什么

```
 $data['message_available'] = $this->getCheckForMessages();        
        $config["base_url"] = base_url() . "messages/inbox/";
        $config['total_rows'] = $this->getMessageCount();
        $config['per_page'] = 5;
        $config["num_links"] = 10;
        $config["full_tag_open"] = '<div id="pagination">';
        $config["full_tag_close"] = '</div>';
        $this->pagination->initialize($config);
        $data['messages'] = $this->getMessages($config['per_page'],      $this->uri->segment(3));
        $data['links'] = $this->pagination->create_links(); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-06T11:52:58.420

您必须深入检查：

```
$config['total_rows'] = $this->getMessageCount(); 
```

可能返回的字段比结果查询多`getMessages();`

请同时发布您的`getMessages()`和`getMessageCount();`查询以更准确

也请改变这个：

```
$config["base_url"] = base_url() . "messages/inbox/"; 
```

对此：

```
$config["base_url"] = site_url('messages/inbox'); 
```

# ios - 在 iOS 的 DateComponents 中获取月份

> ID：15839068
> 
> 赞同：1
> 
> 时间：2013-04-05T16:35:41.793
> 
> 标签：ios, nsdate

我想从 DateComponents 获取月份。

我的代码如下所示：

```
NSDate *date = [NSDate date];
NSDateComponents* dateComponents = [[NSCalendar currentCalendar] components:NSYearCalendarUnit|NSMonthCalendarUnit|NSDayCalendarUnit fromDate:date];
NSString *month = [NSString *stringWithFormat:@"%i",dateComponents.month]; 
```

但是这个月份是一个整数，我希望月份的格式为 mm 或例如：11 月。

我该怎么做？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-05T17:14:18.347

```
int monthNumber = 11; 
NSDateFormatter *df = [[NSDateFormatter alloc] init];
NSString *monthName = [[df monthSymbols] objectAtIndex:(monthNumber-1)];//because dateformatter is zero-based 
```

# sql-server-2008 - 任何指向 Service Broker 最佳实践的链接？

> ID：15839079
> 
> 赞同：2
> 
> 时间：2013-04-05T16:36:36.303
> 
> 标签：sql-server-2008, service-broker

我正在寻找有关 Service Broker 最佳实践的任何权威文章。

特别是，我正在寻找以下主题（我知道答案，但必须找到支持知识的文档）：

*   同一数据库中的队列
*   信息
    *   尺寸
    *   消息只是一个指针并且从表中检索数据的系统
*   检测 - 审计 Service Broker 应用程序

TIA

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-06T12:25:20.710

> 消息只是一个指针并且从表中检索数据的系统

这不是一个 Service Broker 应用程序，只是一个排队应用程序。Service Broker 主要是为分布式应用程序设计的，通信（网络、安全、路由、重试）是主要组件。如果您仅将消息作为指针发送并且数据在表中，那么 SSB 的分布式特性就会崩溃。**试金石是“我可以将我的服务移动到另一台服务器上，并且在修复路由后应用程序继续工作吗？”** . 如果答案是肯定的，那么您正在按照设计的方式使用 SSB。如果不是，则表示您只对队列感兴趣。

将 SSB 用作“哑队列”的问题在于，这是一个非常昂贵的队列（想想由于对话和对话组而对每条消息所需的额外写入）。RECEIVE 语句很昂贵，基本上是来自优化 pov 的黑匣子。您可以比使用 SSB 服务/队列更好地优化[用作队列的表。](http://rusanu.com/2010/03/26/using-tables-as-queues/)我认为 SSB 有一个优势，即使在用作本地队列时也很有吸引力，即[内部激活](http://msdn.microsoft.com/en-us/library/ms171617%28v=sql.105%29.aspx)功能。有人可能会说激活不能用其他任何东西代替（我同意，它不能），但必须意识到成本并平衡利弊。

# jquery - 同位素高度不随内容变化

> ID：15839080
> 
> 赞同：1
> 
> 时间：2013-04-05T16:36:36.663
> 
> 标签：jquery, css, resize, height

我一直在研究同位素容器，并且在获得高度以保持内容动态时遇到了一些麻烦。

我已经为我的容器添加了选项，例如`reLayout`，resizeable true，但似乎无法正常工作。

我注意到我的容器正在注入一个高度样式，但还没有弄清楚从哪里，你会在我的视频中注意到我能够获得适合我的内容的高度的唯一方法是在其中一个上设置一个高度divs ( `col_1`) 在同位素中，容器似乎将高度注入其中，但不会使用其他选项卡调整大小。昨天我整天都在摆弄css来尝试解决这个问题，但我很难过。

下面是我的问题的 jing 视频： [http ://www.screencast.com/t/Zq1giEtdt](http://www.screencast.com/t/Zq1giEtdt)

这是网站： [http ://daniloportal.com/NPC/howitworks.html](http://daniloportal.com/NPC/howitworks.html)

另外，这是我的同位素 js 的片段

```
//Isotope sorting
 var $container = $('.projects');

 $container.isotope({
    filter: '.sort_category1',
    resizesContainer: true,
    resizable: true,    
  });

  $('.projects').isotope('reLayout')

  var $optionSets = $('#options .option-set'),
      $optionLinks = $optionSets.find('a');

  $optionLinks.click(function(){
    var $this = $(this);
    // don't proceed if already selected
    if ( $this.hasClass('selected') ) {
      return false;
    }
    var $optionSet = $this.parents('.option-set');
    $optionSet.find('.selected').removeClass('selected');
    $this.addClass('selected');

    // make option object dynamically, i.e. { filter: '.my-filter-class' }
    var options = {},
        key = $optionSet.attr('data-option-key'),
        value = $this.attr('data-option-value');
    // parse 'false' as false boolean
    value = value === 'false' ? false : value;
    options[ key ] = value;
    if ( key === 'layoutMode' && typeof changeLayoutMode === 'function' ) {
      // changes in layout modes need extra logic
      changeLayoutMode( $this, options )
    } else {
      // otherwise, apply new options
      $container.isotope(options);
    }

    return false;
  }); 
```

});

任何帮助表示赞赏，感谢互联网！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-05T17:59:50.403

好吧，经过一番困惑，我想通了。我有太多为 Col_1 设置的高度样式，我所做的只是消除这些样式，同位素现在动态设置所有高度参数！:D

# java - 使用 ArrayList#toArray 方法将 ArrayList 放入 JList

> ID：15839081
> 
> 赞同：0
> 
> 时间：2013-04-05T16:36:41.587
> 
> 标签：java, swing, list, arraylist, jlist

我在使用类的`toArray`方法时遇到问题`ArrayList`。我需要将`ArrayList`, `vecPersonnages`, 的内容放入`JList`,`listeObjets`中，我想用`ArrayList#toArray`方法来做。我设法通过将列表的值放在选项卡中，然后将此选项卡放在`JList`.

我确实在谷歌上寻求帮助，但我发现的一切都不起作用。我的课程中确实有一个`toString`方法，但是，我`toString`在使用我的`JList`.

这就是我声明我的课程的方式：

```
private JList<Personnage> listeObjets = null;
private ArrayList<Personnage> vecPersonnages = null; 
```

下面是我尝试将我的内容添加到其中的代码以及我尝试过的`ArrayList`一些`JList`事情，并在注释中注明：

```
Personnage[] tabPerso = new Personnage[vecPersonnages.size()];
for (int i = 0; i < vecPersonnages.size(); i++) {
    tabPerso[i] = vecPersonnages.get(i);
}
listeObjets.setListData(tabPerso);
//listeObjets.setListData(vecPersonnages.toArray());
//listeObjets.setListData((Personnage[]) vecPersonnages.toArray());
/*the last line gives me a ClassCastException (java.lang.Object 
  cannot be cast to personnage.Personnage)*/ 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-05T16:42:03.473

使用[`toArray()`](http://docs.oracle.com/javase/7/docs/api/java/util/ArrayList.html#toArray()), [`toArray(T[] a)`](http://docs.oracle.com/javase/7/docs/api/java/util/ArrayList.html#toArray(T%5B%5D));的重载方法

```
Personnage[] array = new Personnage[vecPersonnages.size()]; //Create a new array with the size of the ArrayList
vecPersonnages.toArray(array); // fill the array
listeObjets.setListData(array); 
```

# android - 带有 4 个 MediaPlayers 的 Android 4.2 =“无法播放此视频”

> ID：15839082
> 
> 赞同：7
> 
> 时间：2013-04-05T16:36:50.687
> 
> 标签：android, media-player, android-videoview, android-4.2-jelly-bean

每当我尝试加载至少 4 个媒体播放器时，其中一个会破坏它尝试加载的视频并触发 Android 操作系统消息“无法播放此视频”

其他信息：

对于 3 个 mediaPlayers，一切正常。

**在其他 Android 版本上，与 4.2 不同，相同的代码具有相同的 4 个视频工作。**

4个视频可以在设备上独立播放。没有格式问题。

启动程序并收到“无法播放此视频”消息后，除非我重置设备，否则无法再在任何其他应用程序中播放该视频。

我在surfaceViews上显示的VideoViews或独立的MediaPlayers都试过了。

我在更多运行 Android 4.2 的设备上复制了该错误。在 android 4.1.2 和其他 android 4 版本上，我不记得代码工作正常。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-05T18:43:03.940

在 Android 上，这个想法是所有与媒体编解码器相关的内容都对开发人员隐藏，开发人员必须使用一致且独特的 API [`MediaPlayer`](http://developer.android.com/reference/android/media/MediaPlayer.htm)：.

当您播放媒体时，无论是流还是位于外部设备上的东西，每次应用程序需要帮助时都会实例化低级编解码器/解析器。

但是，由于与硬件解码相关的特殊原因，某些编解码器不能多次实例化。事实上，**每个**应用程序都*必须*[`MediaPlayer.release()`](http://developer.android.com/reference/android/media/MediaPlayer.html#release%28%29)通过在有效状态下调用来释放不再需要的资源（例如编解码器实例） 。

事实上，我所说的在 Android 开发者网站上的[文档中有说明：`release`](http://developer.android.com/reference/android/media/MediaPlayer.html#release%28%29)

> 释放与此 MediaPlayer 对象关联的资源。使用完 MediaPlayer 后调用此方法被认为是一种很好的做法。特别是，每当应用程序的 Activity 暂停（调用其 onPause() 方法）或停止（调用其 onStop() 方法）时，应调用此方法以释放 MediaPlayer 对象，除非应用程序有特殊的需要保持对象周围。除了占用不必要的资源（例如内存和编解码器的实例）外，如果不再需要 MediaPlayer 对象，则未能立即调用该方法还可能导致移动设备持续消耗电池，如果没有，其他应用程序播放失败设备上支持同一编解码器的多个实例。

因此，要么您在播放完毕后没有调用`release`，要么另一个应用程序正在持有此类资源的引用。

**编辑 ：**

如果您需要同时渲染多个视频`Activity`，您有两种选择。正如我在回复中所说，由于低级问题，您最初想要的东西是不可能的，顺便说一句，它也不在 iOS 上。

你可以*尝试*做的是：

*   如果您正在播放的媒体*不是*实时流媒体内容，您可以使用广泛可用的免费视频编辑器之一将 4 个视频打包成一个视频。然后在你的活动中全屏渲染视频，它看起来就像你有 4 `Views`。

*   如果它们是实时/非录制内容，请保持第*一个*视频不变。我假设每个视频都使用相同的编解码器/容器进行编码。您可能正在尝试对其他 3 个视频进行转码，以便它们使用不同的编解码器和不同的格式。确保您正在转码为[Android 支持](http://developer.android.com/guide/appendix/media-formats.html)的编解码器/容器。这*可能*会迫使 Android 同时使用不同的解码器。我认为与您期望的结果相比，这太过分了。

*   最后，您可以使用不同的后端进行解码，例如`MediaPlayer`+`FFMPEG`或 just `FFMPEG`。但同样，即使它有效，我认为这将是一个巨大的矫枉过正。

总而言之，您必须做出妥协才能使其发挥作用。

# java - 是否可以运行 JPanel（没有 JFrame）并动态显示内部的所有组件？

> ID：15839084
> 
> 赞同：0
> 
> 时间：2013-04-05T16:36:59.153
> 
> 标签：java, swing, jpanel

所以基本上，我试图获得一个 JPanel 窗口，它将动态显示内部的所有组件。换句话说，它将重新调整窗口大小，并显示以适合其内容。

我已经能够在 JFrame 及其 pack() 方法的帮助下做到这一点：[“使这个窗口的大小适合其子组件的首选大小和布局”](http://docs.oracle.com/javase/6/docs/api/java/awt/Window.html#pack%28%29)。在我的情况下，我不想使用 JFrame，因为进行所有更改都需要付出很多努力。现在，我能够让它工作，但只有在 jscroll 的帮助下，它包含了文本和/或任何新行，所以窗口大小更加静态。所以我的 JPanel 正在扩展一个 TopComponent 并能够显示它：

```
jpanel.open(); 

jpanel.requestActive(); 
```

所以问题是如何根据该窗口中的操作调整窗口大小以适应其内容。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-05T16:40:42.857

`JPanel`必须添加到 a中`Window`才能有意义。所以我建议你正确使用布局管理器，你会得到一个体面的用户界面。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-05T16:50:06.010

当您从可见面板添加/删除组件时，您需要使用：

```
panel.revalidate();
panel.repaint(); 
```

然后布局管理器将再次布局组件。

# javascript - 使用自定义函数排序，给出相反的结果

> ID：15839093
> 
> 赞同：1
> 
> 时间：2013-04-05T16:37:32.457
> 
> 标签：javascript, arrays, sorting

我有以下数组（这里显示为 JSON）：

```
[{
    "value": -1,
    "absolute": false,
    "callTime": 0
}, {
    "value": 23,
    "absolute": true,
    "callTime": 1365179295887
}, {
    "value": 1,
    "absolute": false,
    "callTime": 0
}, {
    "value": 1,
    "absolute": true,
    "callTime": 0
}] 
```

我需要通过将具有最高`callTime`属性值的对象放在数组顶部来对该数组进行排序。

我使用以下代码（基于[MDN 提供](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Array/sort#Description)的主题的解释）：

```
var handlers = JSON.parse("[...]");

handlers.sort(function(firstHandler, secondHandler) {
    if (firstHandler.callTime < secondHandler.callTime) {
        return -1; // sort firstHandler to a lower index than secondHandler.
    } else {
        return 1; // sort secondHandler to a lower index than firstHandler.
    }

    return 0;
});

console.log(JSON.stringify(handlers)); 
```

运行该函数后，我得到以下输出：

```
[{
    "value": 1,
    "absolute": true,
    "callTime": 0
}, {
    "value": 1,
    "absolute": false,
    "callTime": 0
}, {
    "value": -1,
    "absolute": false,
    "callTime": 0
}, {
    "value": 94,
    "absolute": true,
    "callTime": 1365179553381
}] 
```

这似乎与我所期望的相反（注意唯一`callTime`不同于零的对象在底部）。

我认为我可能在这里遗漏了一些重要的东西，或者我只是被误导了，而且还将函数的主体更改为：

```
return firstHandler.callTime - secondHandler.callTime 
```

应该给出正确的结果，但似乎没有。

我可能做错了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-05T16:41:29.723

您的排序功能不正确。逻辑是相反的，因为您的排序函数表明具有*较小*值的元素`callTime`排在第一位，而您希望较大的值位于数组的顶部。此外，您总是返回 -1 或 1，而不是 0。当元素绑定时，它应该返回 0。

改写如下：

```
handlers.sort(function(firstHandler, secondHandler) {
    if (firstHandler.callTime > secondHandler.callTime) {
        return -1; // sort firstHandler to a LOWER index than secondHandler.
    } else if (firstHandler.callTime < secondHandler.callTime) {
        return 1; // sort secondHandler to a LOWER index than firstHandler.
    }

    return 0; // sort firstHandler and secondHandler as equal
}); 
```

# php - 将 HTML 搜索词添加到结果页面 URL

> ID：15839094
> 
> 赞同：0
> 
> 时间：2013-04-05T16:37:37.550
> 
> 标签：php, html, .htaccess

目前我有一个搜索框`site.com/search.php`。用户输入搜索词并被带到`site.com/index.php`显示搜索词结果的地方。除了，无论用户输入什么，结果页面 URL 将始终只是`site.com/index.php`- 相反，我希望它可以阅读`site.com/search=word1+word2`或类似的东西，以便每个页面都有一个基于搜索输入的唯一 URL。

我还希望它以相反的方式工作，这样理论上有人可以直接进入`site.com/search=query`，就像他们首先进入主搜索页面，输入一些内容，然后点击返回一样。

我是编程新手，最近开始学习`.htaccess`我知道我需要的文件才能做到这一点。我完全不知道如何做我想做的事。我知道我需要某种 URL 重写，但仅此而已。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-05T16:39:49.370

这里最简单的方法是将搜索表单更改为使用`method="get"`而不是`method='post'`.

这将创建一个 URL，如：

site.com/index.php?search=word1+word2...

只需将搜索脚本更改为使用`$_GET`or`$_REQUEST`代替，`$_POST`您将全部设置好，无需任何其他重大更改。它还将允许用户通过 URL 直接运行搜索。

这种方法的唯一缺点是它不会创建一个漂亮的 URL（即仍然显示“index.php”）......但是，您可以通过使用`.htaccess`重写 URL 轻松解决这个问题。

# html - 防止嵌套内容被周围的css格式化

> ID：15839100
> 
> 赞同：1
> 
> 时间：2013-04-05T16:37:50.753
> 
> 标签：html, css

伙计们，现在我正在制作一个转换页面，该页面应该包含在我们合作伙伴的网站上。我们在他们的网站内获得了一定的空间来推广我们的产品。我们提供的空间当然应该使用 html 和 css 进行样式设置。这就是它变得有点复杂的地方。有没有一种聪明的方法来防止我们在他们的 html 结构中的东西被他们的 css 格式化？

当然，我可以检查所有影响的编队，然后用我们自己的 css 编队覆盖它们，但这很脏，而且就未来可能发生的变化而言不是很可靠。

你会怎么处理这个？iFrame 可能是一个有效的解决方案吗？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-05T16:56:27.660

如果没有 iframe，您可以使用通用重置概念的特殊应用。

```
/* cssreset.com */

#your_company_div * {
margin: 0;
padding: 0;
border: 0;
outline: 0;
font-size: 100%;
line-height: 1.5em;
text-decoration: none;
vertical-align: baseline;

/* and perhaps some more... */

background: white;
color: black;
} 
```

您*可能*还想明确定义字体/系列，除非您只想使用他们的字体/系列使其更适合。

这里的想法基本上是，父网站为 CSS 样式定义的内容不再重要，无论如何，您的内容应该看起来基本相同，因为 * 胜过一切。

请注意，使用通用重置也有同样的缺点，因为您需要对继承进行核对，并且如果您想要一个非零值，则必须定义边距和填充。

这对你来说不应该是一个很大的缺点，因为你并没有设计一个完整的网站，因此对于一些额外的工作来说，他们如何改变他们的网站并不重要，你的块将主要停留在相同的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-05T16:44:32.780

如果您使用 Iframe，则可以使用您自己的独立样式在您的合作伙伴网站中将您的页面作为外部调用。否则为 div 及其子元素提供层次结构样式

# java - Quartz SimpleTrigger 事件立即触发，即使 repeatInterval 是一段时间后

> ID：15839107
> 
> 赞同：0
> 
> 时间：2013-04-05T16:38:21.797
> 
> 标签：java, quartz-scheduler

我定义了一个 simpleTrigger。重复间隔为 10 秒。

我注意到在某些情况下，一个事件触发后，它立即触发另一个事件（不是 10 秒后），第三个事件甚至在 10 秒后触发。

关于发生了什么以及如何纠正这种行为的任何想法？我不知道这是否是误触发的情况（我没有看到错误），如果是如何纠正这种行为，我不希望事件在那之后立即触发。

运行程序时，我看到作业以 1365178800586 毫秒触发。

然后以 1365178800593 毫秒触发，即大约在同一时间。

随后在 1365178810583 毫秒触发，即在第一次调用后大约 10 秒。

Java代码片段：

```
String testJobname = "testJob";
JobDetail testJobDetail = new JobDetail();
testJobDetail.setGroup(this.getClass().getName());
testJobDetail.setName(testJobname);
testJobDetail.setJobClass(TestJob.class);

final JobDataMap data = new JobDataMap();
data.put(CheckLimits.class.getName(), checkLimitsCmd);
testJobDetail.setJobDataMap(data);

Trigger testTrigger = new SimpleTrigger(testJobDetail.getName(),
 testJobDetail.getGroup(), SimpleTrigger.REPEAT_INDEFINITELY,
 10000); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-05T19:02:41.203

首先，我认为您应该使用 TriggerBuilder 和 ScheduleBuilder 而不是直接实例化 SimpleTrigger。

```
Schedule schedule = SimpleScheduleBuilder.simpleSchedule().withIntervalInSeconds(10).build();
Trigger trigger = TriggerBuilder.newTrigger().forJob(testJobDetail).usingJobData(data).withSchedule(schedule).build(); 
```

Quartz 文档在 Javadoc 代码中有一些很好的示例，请查看此以获取更多信息 - [http://quartz-scheduler.org/api/2.0.0/org/quartz/SimpleScheduleBuilder.html](http://quartz-scheduler.org/api/2.0.0/org/quartz/SimpleScheduleBuilder.html)

# java - 调用 getter 时出现 NullPointerException

> ID：15839110
> 
> 赞同：4
> 
> 时间：2013-04-05T16:38:29.300
> 
> 标签：java, exception, null, bufferedimage, initializing

我已经对这个问题进行了研究，也试图自己弄清楚，但没有运气。所以我决定问问。

**基本信息：**

有两个班。`FBClient`, 和`State`. 在`FBClient`中，我有一个类型为 的静态变量`fbc`，一个`StateManager`实例，它只有一些处理`State`东西的方法、一些常量和两个 getter。在`State`中，我正在尝试初始化一个`BufferedImage`.

```
public class FBClient
{
    //Static
    public static FBClient fbc;

    //In init method
    private StateManager stateManager;

    //Constants
    private final int INIT_FRAME_WIDTH = 320, INIT_FRAME_HEIGHT = (INIT_FRAME_WIDTH / 4) * 3,  SCALE = 3, FRAME_WIDTH = INIT_FRAME_WIDTH * SCALE, FRAME_HEIGHT = INIT_FRAME_HEIGHT * SCALE;

    public static void main(String[] args)
    {
        try
        {
            //First call in exception chain:
            fbc = new FBClient();
        }
        catch (Exception e)
        {
            e.printStackTrace();
            System.exit(1);
        }
    }

    private FBClient()
        throws IOException
    {
        //Second call in exception chain:
        init();
    }

    private void init()
        throws IOException
    {
        stateManager = new StateManager();
        //Third call in exception chain:
        stateManager.addState(new MainMenu((byte) 0, "Main Menu")); //MainMenu is the subclass of State, and the constructor just calls "super(0, "Main Menu")"
    }

    public int getFRAME_HEIGHT()
    {
        return FRAME_HEIGHT;
    }

    public int getFRAME_WIDTH()
    {
        return FRAME_WIDTH;
    }
}

public abstract class State
{
    protected final byte ID;
    protected final String NAME;
    protected final BufferedImage SCREEN;
    protected final Graphics2D GRAPHICS;

    public State(byte id, String name)
    {
        this.ID = id;
        this.NAME = name;
        //Exception cause:
        this.SCREEN = new BufferedImage(FBClient.fbc.getFRAME_WIDTH(), FBClient.fbc.getFRAME_HEIGHT(), BufferedImage.TYPE_INT_RGB);
        this.GRAPHICS = SCREEN.createGraphics();
    }
} 
```

**更多信息：**

如果我将文字放在 BufferedImage 初始化中，它就可以工作。

如果我在`State`类中初始化两个变量，为它们分配文字并将这些变量放在初始化中，它就可以工作。

如果我没有将文字分配给这些变量，而是将它们分配给`FBClient.fbc.getFRAME_WIDTH()`and `FBClient.fbc.getFRAME_HEIGHT()`，它会抛出一个`NullPointerException`.

如果我`System.out.println(getFRAME_WIDTH + " : " + getFRAME_HEIGHT)`在`FBClient`课堂上做 a ，它会正确打印出来，但如果我在`State`课堂上做（当然`FBClient.fbc.`在它之前添加），它会抛出一个`NullPointerException`.

如果我制作`FRAME_WIDTH`和`FRAME_HEIGHT`常量`public`，并且我尝试通过执行和从`State` 类中访问它们，它会抛出一个.`FBClient.fbc.FRAME_WIDTH``FRAME_HEIGHT``NullPointerException`

如果我尝试`FBClient`直接从类访问常量，而不是 getter，它仍然可以正确打印出来。

**最后**

感谢您抽出宝贵时间，如果您需要更多信息，请在评论中询问我，我会提供。另外，如果问题没有很好地构建/没有很好地解释，我深表歉意。如果是这种情况，请告诉我如何改进它。而且，如果这个问题已经被问过并回答过一次，我很抱歉，我可能错过了，但正如我所说，我做了我的研究。

**编辑#1**

一条评论建议我打印出一个`fbc`值，看看它是否为空。所以我将这行代码添加到`State`构造函数中： `if(FBClient.fbc != null) System.out.println("Not null"); else System.out.println("Null");` 而且，正如怀疑的那样，它打印出 null。这是为什么？我清楚地在方法中初始化了变量`main`......

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-05T16:44:21.543

您指的是 FBClient.fbc在分配**之前**（实际上是在构造函数中，因为 fbc 在构造函数完成工作后被分配）。要修复它添加`static`到最终值，使 getter 静态并使用`FBClient.getFRAME_HEIGHT()`. 您不需要非静态最终变量。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-05T17:29:08.173

您遇到问题的原因是因为您试图在其构造函数调用中引用 FBClient.fbc 并且该对象尚未完成自己的构造。您正在这样做并不是很明显，但是如果您按照构造函数中的代码调用 init()，它最终会调用 State 构造函数，而后者又会尝试使用 FBClient.fbc.getFRAME_WIDTH()。

我建议您不要在 FBClient 构造函数中调用 init() 并将您的主要方法代码更改为：

```
 public static void main(String[] args)
    {
        try
        {
          //First call in exception chain:
          fbc = new FBClient();
          fbc.init();
        }
        catch (Exception e)
        {
          e.printStackTrace();
          System.exit(1);
        }

    } 
```

希望这可以帮助。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-05T16:45:42.853

我认为你`FBClient.fbc`是空的。

# java - Coldfusion 在调用长时间运行的 Java 方法时遇到 java.net.SocketTimeoutException

> ID：15839111
> 
> 赞同：0
> 
> 时间：2013-04-05T16:38:29.377
> 
> 标签：java, coldfusion, coldfusion-8, socket-timeout-exception

我正在尝试在静态 Java 类上调用一个方法，该方法可能需要 10 秒到 1 分钟才能运行。大约 30 秒后，我得到了异常

```
java.net.SocketTimeoutException: Read timed out; Is the timeout preference too low? Are you dumping/calling debug() on large data or cfc instances? 
```

我已经能够使用以下最小示例来复制它。在 Java 中：

```
package some.package;
public class Sleeper {
    public static void sleep(int seconds) {
        Thread.sleep(seconds * 1000);
    }
} 
```

然后我有一个 MxUnit 测试：

```
<cffunction name="timeoutTest" access="public" returnType="void" output="false>
    <cfset sleeper = CreateObject("java", "some.package.Sleeper" />
    <cfset runner.sleep(32) />
</cffunction> 
```

在服务器设置上设置 my `Timeout Requests after ( seconds)`to`99999`没有帮助，也没有将测试更改为：

```
<cffunction name="timeoutTest" access="public" returnType="void" output="false>
    <cfset sleeper = CreateObject("java", "some.package.Sleeper" />
    <cfsetting requesttimeout="64" />
    <cfset runner.sleep(32) />
</cffunction> 
```

我想在某个地方有一个设置，但如果是这样我找不到它。我正在运行 ColdFusion 8

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-05T18:12:32.857

ColdFusion 不是问题，MxUnit 是。默认情况下，单元测试在 30 秒后超时。这可以在 Eclipse 中通过转到 Window -> Preferences -> MXUnit 并将“方法超时”字段更改为`0`.

# windows-phone-7 - 在 Windows Phone 应用程序中进行本地化的更便捷方式

> ID：15839112
> 
> 赞同：2
> 
> 时间：2013-04-05T16:38:30.867
> 
> 标签：windows-phone-7, localization, windows-phone-8, windows-phone

目前，如果您想在 windows phone 应用程序中本地化说应用程序标题，您可以这样做：

```
<TextBlock Text="{Binding LocalizedResources.ApplicationTitle, 
                  Source={StaticResource LocalizedStrings}}" /> 
```

这太长了，并且每次绑定都会重复某些部分。即使您要将`LocalizedResources`属性重命名为`R`和`LocalizedStrings`类`LS`，例如，仍然存在一些重复。

所以我尝试制作一个从`Binding`类继承并实现如下的类：

```
public class LocalizedBinding : Binding {
    public LocalizedBinding(string path) : base(path) {
        Source = Application.Current.Resources["LocalizedStrings"];
    }
} 
```

希望是按如下方式使用它：

```
<TextBlock Text="{b:LocalizedBinding LocalizedResources.ApplicationTitle}" /> 
```

但是，应用程序在启动时立即崩溃，即使在调试器中我也看不到任何错误。关于这可能如何工作的任何提示？

谢谢

**编辑：**

将无参数构造函数`LocalizedBinding`添加`Path=`到绑定并附加到绑定可以修复它。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-05T17:34:55.627

`LocalizedBinding`通过向类添加无参数构造函数来解决此问题

```
public class LocalizedBinding : Binding {
    public LocalizedBinding() {
        Source = Application.Current.Resources["LocalizedStrings"];
    }

    public LocalizedBinding(string path) : base(path) {
        Source = Application.Current.Resources["LocalizedStrings"];
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-11T13:05:36.560

您可以尝试将本地化类放入您的 App.xaml，然后在 Application_Launching 检查用户设置的语言。在您显示文本的任何地方，您都会引用 App.xaml 类。

# excel - Microsoft Excel 2003 中的相关性/数据挖掘

> ID：15839113
> 
> 赞同：0
> 
> 时间：2013-04-05T16:38:32.443
> 
> 标签：excel, pivot, data-mining, correlation

我有一个 Excel 电子表格，其中每一列都是一个特定的变量。在我的专栏末尾，我有一个特殊的最后一列，称为“类型”，可以是 A、B、C 或 D。

每一行都是一个具有不同变量的数据点，这些变量最终出现在最后一列中记录的某个“类型”桶 (A/B/C/D) 中。

我需要一种方法来检查某种类型的所有条目（例如，“C”或“C”|“D”）并找出哪些变量是最后一列的良好预测器，哪些更好预测器比其他人。

一些变量是数字，另一些是固定字符串（来自一组字符串），因此它不仅仅是数字/数字相关。

Excel 2003 是一个很好的工具，还是有更好的统计程序可以让这更容易？我是否为每个类别创建数据透视图/直方图，还是有更好的方法来运行这些查询？谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-12-17T11:34:59.840

您可以使用 microsoft excel 进行一些过滤，尤其是清理数据（我的意思是，将数据值更改为一种类型、字符串或数字）。Execl 还进行一些数据挖掘。但是，对于您遇到的这类问题，我推荐您使用的一个好工具是 WEKA。使用该工具，您可以对所有数据实例（行）进行关联分类预测（即类关联规则挖掘），从而确定哪些项目属于A/B/C/D。您的特殊属性将是您的类属性。

# rest - RESTful 软删除

> ID：15839114
> 
> 赞同：46
> 
> 时间：2013-04-05T16:38:34.407
> 
> 标签：rest, put

我正在尝试构建一个 RESTful webapp，在其中我使用 GET、POST、PUT 和 DELETE。但我有一个关于在这个特定应用程序中使用 DELETE 的问题。

先说一点背景：

我的 webapp 管理的通用实体也在另一个系统中管理（并且，它总是创建）。所以在我的 webapp 中，每个实体都将使用唯一的键存储在数据库中。但是我们通过 URL 访问它们的方式是使用*另一个*系统的唯一密钥。

我想一个简单的例子就可以清楚地说明这一点。取网址`/entity/1`。*这将显示其他系统中*ID 为 1 的实体的信息，而不是我自己的系统。事实上，我系统中的 ID 将完全隐藏。`1`在我自己的系统中，将没有用于访问 ID 为的实体的 URL 方案。

好的，现在我们知道了我的 webapp 的结构，让我们回到删除这些实体。

将有一种方法可以在我的系统中“删除”实体，但我在它周围加上引号，因为它实际上不会从数据库中删除它们。相反，它会使用一个属性标记它们，以防止它在您转到 时出现`/entity/1`。

正因为如此，我觉得我应该使用`PUT`（这种方式'删除'将是幂等的），因为我从数据的角度来看，只是设置一个属性。

所以，问题是：RESTful 方法是否对数据有保真度（在这种情况下，我很清楚我正在`PUT`学习），或者应用程序中的数据表示（在这种情况下，我似乎正在`DELETE`学习）？

* * *

## 回答 #1

> 赞同：75
> 
> 时间：2013-04-05T16:42:11.433

你应该使用`DELETE`.

您打算对数据执行的操作称为“软删除”：您设置了一个标志并避免出现已标记的项目。这是您的 web 应用程序内部的，用户不必知道您正在软删除而不是删除或您想做的任何事情。这就是为什么你应该使用`DELETE`动词。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2021-05-04T09:43:04.367

我认为没有明确的答案。我会依赖 1\. 软删除、恢复和销毁操作是否是您的 api 的实际功能或 2\. 软删除只是一种“偏执”的数据库工程模式。

1.  “软”删除对于 api 客户端是透明的，在这种情况下使用`DELETE`动词似乎是可行的方法

    一切都好像要一劳永逸地删除该项目，但工程师希望将其保留在数据库中的某个位置

2.  Api 客户端具有恢复或销毁软删除资源的能力，在这种情况下，软删除和恢复可以`POST`在不同的操作 url 上使用，例如`/resource/:id/softdelete`，销毁操作将是使用`DELETE`.

    另一种方法可能是使用`DELETE`不带查询参数的软删除，并添加`?destroy=true`到实际销毁。但是这种方法似乎不那么明确并且更容易出错。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2021-07-28T12:44:01.797

> DELETE 方法在 HTTP 中具有非常特定的语义，不能被 REST API 的设计重载或拉伸。具体来说，API 不应通过将 DELETE 映射到较小的操作来扭曲 DELETE 的预期含义，从而使资源及其 URI 可供客户端使用。例如，如果 API 希望提供“软”删除或其他一些改变状态的交互，它应该使用特殊的控制器资源并指示其客户端使用 POST 而不是 DELETE 进行交互。

***资料来源***：Mark Massé 撰写的 Rest-API 设计规则书

***建议***：

```
POST: /entity/1/your-soft-delete-controller-name 
```

# c++ - 为什么在使用 try_lock() 时需要显式比较？

> ID：15839115
> 
> 赞同：1
> 
> 时间：2013-04-05T16:38:36.863
> 
> 标签：c++, c++11, mutex

我正在阅读的文档，[`std::mutex::try_lock`](http://en.cppreference.com/w/cpp/thread/mutex/try_lock)上面有这个例子：

```
#include <iostream>
#include <mutex>

int main()
{
    std::mutex test;
    if (test.try_lock() == true)
        std::cout << "lock acquired" << std::endl;
    else
        std::cout << "lock not acquired" << std::endl;
    test.unlock();  // now unlock the mutex
    test.lock();    // to lock it again
    if (test.try_lock())  // true can be left out
        std::cout << "lock acquired" << std::endl;
    else
        std::cout << "lock not acquired" << std::endl;
    test.lock(); // and now the finale (a block)
} 
```

在第二个 if 语句中，他说 true 可以省略。为什么第二个会这样，而第一个不会。我检查了一下，它说`try_lock`返回一个布尔值，那么它怎么可能不是真假，从而使`== true`检查变得多余？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-05T16:46:44.310

`x == true``x`有类型时很傻`bool`。`test.try_lock()`return `bool`，因此在**这两种**情况下都不需要测试。

# facebook - 在一个网页中拥有超过 1 个 facebook 评论框

> ID：15839116
> 
> 赞同：0
> 
> 时间：2013-04-05T16:38:40.597
> 
> 标签：facebook, comments

一个网页中是否可以有超过 1 个 facebook 评论框？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-07T09:56:14.577

是的，但您需要为要关联的评论指定不同的 url

```
<iframe src="http://www.facebook.com/plugins/comments.php?href=link1.com&permalink=1" scrolling="no" frameborder="0" style="border:none; overflow:hidden; width:130px; height:16px;" allowTransparency="true"></iframe> 

<iframe src="http://www.facebook.com/plugins/comments.php?href=link2.com&permalink=1" scrolling="no" frameborder="0" style="border:none; overflow:hidden; width:130px; height:16px;" allowTransparency="true"></iframe> 
```

# javascript - 从以某个字符开始的文本中划分单词

> ID：15839117
> 
> 赞同：0
> 
> 时间：2013-04-05T16:38:44.633
> 
> 标签：javascript, jquery

我想测试文本中的每个单词是否以字符 # 开头，如果是，我会将单词放入变量“response”中，如果不是，我将继续搜索。我尝试了类似的东西：

```
var found = false;
for (i = 0; i < text.length; i++) {
     if (found = /^#...$/.test(text[i])) {
        found = true;
     }
     if (found== true){
          //other stuff
     }
} 
```

你能帮我做这个吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-05T16:46:59.420

您可以在空间上使用拆分，然后使用子字符串查找第一个字母。然后比较一下。

[**演示**](http://jsfiddle.net/5NzVS/1/)

```
var arr= text.split(' ');

for (i = 0; i < arr.length; i++) {
    if (arr[i].substring(0,1) == '#') {
        console.log('found!: ' + arr[i]);
        break;
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-05T16:45:35.633

你可能想要这样的东西：

```
var found = false, response;
for (i = 0; i < text.length; i++) {
     if (/^#.*$/.test(text[i])) {
        found = true;
        response = text[i];
        break;
     }
} 
```

这匹配以 . 开头的所有内容`#`。如果您只想匹配非空格字符，请使用 RegEx`/^#(\S)*$/`

# oracle - 列存储策略

> ID：15839121
> 
> 赞同：0
> 
> 时间：2013-04-05T16:39:00.293
> 
> 标签：oracle, mongodb, blob

我们有一个应用程序需要非常快速地访问分隔的平面文件中的列，而无需提前知道文件中的列。我最初的方法是将 MongoDB 文档中的每一列存储为一个数组，但是当我达到 16MB 文档限制时，它不会随着文件变大而扩展。

我的第二种方法是按列拆分文件，本质上将它们视为可以从磁盘提供给客户端应用程序的 blob。我直观地认为将位置存储在数据库中并将文件存储在磁盘上是最好的方法，并且将它们作为 blob（或 mongo gridfs）存储在数据库中会增加不必要的开销，但是可能有一些不明显的优点对我来说。所以我的问题是：将它们作为 blob 存储在（Oracle/Mongo）等数据库中的优势是什么，是否有任何数据库特别适合这项任务。

谢谢， 瓦卡

# python - Python（PyRRD）和带有while循环的RRD？

> ID：15839124
> 
> 赞同：2
> 
> 时间：2013-04-05T16:39:07.367
> 
> 标签：python, rrdtool, rrd, raspbian

**进一步解决** 了，添加了解决方案- 文件已创建）。我不确定这是否是正确的方法，但是这段代码每秒都会吐出温度，所以 while 循环至少可以工作。

```
import os
import glob
import time
import subprocess

# RDD-imports
from pyrrd.graph import DEF, CDEF, VDEF
from pyrrd.graph import LINE, AREA, GPRINT
from pyrrd.graph import ColorAttributes, Graph
from pyrrd.rrd import DataSource, RRA, RRD

# Sensor-stuff 
os.system('modprobe w1-gpio')
os.system('modprobe w1-therm')

base_dir = '/sys/bus/w1/devices/'
device_folder = glob.glob(base_dir + '28*')[0]
device_file = device_folder + '/w1_slave'

# RRD-stuff
startTime = int(time.time())
filename = 'temptest.rrd'
dataSources = []
rras = []
dataSource = DataSource(dsName='temp', dsType='DERIVE', heartbeat=5)
dataSources.append(dataSource)
rra1 = RRA(cf='AVERAGE', xff=0.5, steps=1, rows=5)
rra2 = RRA(cf='AVERAGE', xff=0.5, steps=6, rows=10)
rras.extend([rra1, rra2])
myRRD = RRD(filename, ds=dataSources, rra=rras, start=startTime)
myRRD.create()

# Graph-making
graphfile = 'tempgraf.png'
def1 = DEF(rrdfile=myRRD.filename, vname='mytemp', dsName=dataSource.name)
# Data going into green field
cdef1 = CDEF(vname='temp', rpn='%s,3600,*' % def1.vname)
# Line for max value
line1 = LINE(value=30, color='#990000', legend='Max temp allowed')
# Green area
area1 = AREA(defObj=cdef1, color='#006600', legend='Temp')

def read_temp_raw():
    catdata = subprocess.Popen(['cat',device_file], stdout=subprocess.PIPE, stderr=subprocess.PIPE)
    out,err = catdata.communicate()
    out_decode = out.decode('utf-8')
    lines = out_decode.split('\n')
    return lines

def read_temp():
    lines = read_temp_raw()
    while lines[0].strip()[-3:] != 'YES':
        time.sleep(0.2)
        lines = read_temp_raw()
    equals_pos = lines[1].find('t=')
    if equals_pos != -1:
        temp_string = lines[1][equals_pos+2:]
        temp_c = float(temp_string) / 1000.0
        myRRD.bufferValue(int(time.time()), int(temp_c))
        myRRD.update()
        return temp_c

while True:
    print(read_temp())
    g = Graph(graphfile, start=startTime, end=int(time.time()), vertical_label='Temp(c)')
    g.data.extend([def1, cdef1, line1, area1])
    g.write()
    time.sleep(1) 
```

我一直在尝试，在 RRD 手册和初学者教程中阅读了很多内容，但我就是无法做到这一点。我非常不确定#Graph-making 部分中的 rpn-stuff。请帮助我:)另外，如果有更好的方法可以做到这一点，请告诉我！

**解决方案**（针对我的问题）：放弃 PyRRD 并尝试 rrdtools 自己的 python 实现。[http://oss.oetiker.ch/rrdtool/prog/rrdpython.en.html](http://oss.oetiker.ch/rrdtool/prog/rrdpython.en.html)

我在程序之外创建了数据库，并在终端（Linux）中像这样正确设置了步骤：

```
rrdtool create dailyTemp.rrd --step 5      \
DS:temp:GAUGE:10:-100:200                  \
RRA:AVERAGE:0.5:1:2880 RRA:MAX:0.9:1:2880  \ 
```

然后我删除了所有连接到 PyRRD 的代码，只添加了一些导入行和一行用于 rrdtool 更新。更清洁，现在我可以创建我的图表：D 这是“最终”代码：

```
import os
import glob
import time
import subprocess
import sys
sys.path.append('/usr/local/lib/python2.7/site-packages/')
import rrdtool, tempfile

# Sensor-stuff 
os.system('modprobe w1-gpio')
os.system('modprobe w1-therm')

base_dir = '/sys/bus/w1/devices/'
device_folder = glob.glob(base_dir + '28*')[0]
device_file = device_folder + '/w1_slave'

# RRD-stuff, not specific
startTime = int(time.time())

def read_temp_raw():
    catdata = subprocess.Popen(['cat',device_file], stdout=subprocess.PIPE, stderr=subprocess.PIPE)
    out,err = catdata.communicate()
    out_decode = out.decode('utf-8')
    lines = out_decode.split('\n')
    return lines

def read_temp():
    lines = read_temp_raw()
    while lines[0].strip()[-3:] != 'YES':
        time.sleep(0.2)
        lines = read_temp_raw()
    equals_pos = lines[1].find('t=')
    if equals_pos != -1:
        temp_string = lines[1][equals_pos+2:]
        temp_c = float(temp_string) / 1000.0
        print(int(temp_c))
        print(int(time.time()))
        rrdtool.update('dailyTemp.rrd','N:' + `temp_c`)
        return temp_c

while True:
    print(read_temp())
    time.sleep(5) 
```

我还没有在代码中实现图形创建，但可以将过去 2 小时的读数打印出来：

```
rrdtool graph temp120.png --end now --start end-7200s --width 400   \
    DEF:ds0a=dailyTemp.rrd:temp:AVERAGE             \ 
```

图表结果（正在进行中）：我获得所需的声誉后立即添加图片 (10)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-02-22T07:44:52.530

这是获取温度值然后更新您的 RRD 的另一种方法...

```
#!/usr/bin/python

# reads 1-wire DS18B20 temperature sensors and outputs options for rrdupdate

import os
import glob
import rrdtool

sensors = ( {'aab8': {                 # last four characters of sensor ID
                      'DS': 'DSName1', # DS name in rrd
                      'value': 0
                     },
             '5cc3': {
                      'DS': 'DSName2',
                      'value': 0
                     },
             '9ce0': {
                      'DS': 'DSName3',
                      'value': 0
                     }
          } )

RRD='/path/to/my.rrd'

base_dir = '/sys/bus/w1/devices/'
device_folder = glob.glob(base_dir + '28*')

DS_list = ""
value_list = "N:"

for index, sensor in enumerate(device_folder):
    for k, v in sensors.items():
        if sensor[-4:] == k:
            f = open(sensor + '/w1_slave', 'r')
            lines = f.readlines()
            f.close()
            if lines[0].strip()[-3:] == 'YES':
                v['value'] = float(lines[1][lines[1].find('t=')+2:])/1000.0
                DS_list += v['DS'] + ':'
                value_list += str(v['value']) + ':'

DS_list = DS_list[:-1]
value_list = value_list[:-1]

rrdtool.update(RRD, '--template', DS_list, value_list) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-05T17:07:43.823

看起来您对 rrdtool 感到困惑。我建议您先使用 rrdtool 手动生成图形。一旦你了解了它的功能，你就可以转到 pyrrd。

这些 url 包含关于 rrd 的非常好的文档

[http://oss.oetiker.ch/rrdtool/doc/index.en.html](http://oss.oetiker.ch/rrdtool/doc/index.en.html)

如果您已经生成了 rrd，请使用以下 url 并尝试手动生成图表。

[http://oss.oetiker.ch/rrdtool/doc/rrdgraph.en.html](http://oss.oetiker.ch/rrdtool/doc/rrdgraph.en.html)

由于您提到正在生成空的 png 文件，请确保数据已正确更新为 rrd。使用 rrdtool fetch 来确定 rrd 中是否有任何真实数据得到更新。

[http://oss.oetiker.ch/rrdtool/doc/rrdfetch.en.html](http://oss.oetiker.ch/rrdtool/doc/rrdfetch.en.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-09-09T19:42:02.987

在创建像您这样的 rrd 文件时，我已经挂在“步骤”设置上。

创建RRD文件时必须设置它：

```
myRRD = RRD(filename, step=5, ds=dataSources, rra=roundRobinArchives, start=datetime.fromtimestamp(time.time()), step=60)
myRRD.create() 
```

不像我最初想的那样在数据源中......

我在 PyRRD 提供的文件 example5.py 中找到了解决方案

# matlab - 区分后整理表情

> ID：15839127
> 
> 赞同：6
> 
> 时间：2013-04-05T16:39:18.620
> 
> 标签：matlab, symbolic-math, computer-algebra-systems, mupad

我在这个问题中使用的方程包含指数。出于这个原因，在微分之后，除了额外的常数和其他因素外，它们看起来几乎没有变化。我想知道是否有可能将这些指数收集回它们所在的表达式的名称中。这是一个例子：

给定这个函数定义

```
f:= x -> A*exp(B/x) 
```

微分后会得到

```
A*exp(B/x)*(-B/x^2) 
```

如果我能以某种方式将其转换为

```
f(x)*(-B/x^2) 
```

这对 MuPad 或任何其他 CAS 包是否可行？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-23T21:03:27.557

在 MAPLE 中很容易，使用通用替换命令`algsubs`

```
> f:= x -> A*exp(B/x)
> g := diff(f(x), x)
> algsubs(A*exp(B/x) = F, g) 
```

对于更复杂的表达式，请尝试`collect`

# if-statement - 如果满足 3 个条件中的 2 个 (w/o || "OR")

> ID：15839128
> 
> 赞同：0
> 
> 时间：2013-04-05T16:39:40.133
> 
> 标签：if-statement, conditional, conditional-statements

问答

如何在我的条件语句中不执行大量 OR 语句的情况下检查是否满足三个条件中的两个。

IE

`if (((a==true)&&(b==true))||((b==true)&&(c==true))||((c==true)&&(a==true))) {`

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-05T16:39:40.133

使用 (a==true) 之类的条件语句在 if 语句中返回值 1 或 0...

IE

`if (a==true) {`是相同的`if ((a==true)==1) {`

因为所有的条件都是形式`if (1) { else if (0) {`

要缩短
`if (((a==true)&&(b==true))||((b==true)&&(c==true))||((c==true)&&(a==true))) {`
将每个条件`==`语句分配为数值 1 或 0，请将所有条件加起来并检查该值是否大于 1（意味着满足或满足多个条件），因为如果条件不 == true 它如果它返回 1，则返回零，并且将它们相加会给您一个数值...

缩写形式：

`if ((a==true)+(b==true)+(c==true)>1) {`

如果您使用的语言以 obj-c 处理 BOOL 的方式处理 BOOL，那么您可以得到更短的时间。

`if ((a)+(b)+(c)>1) {`

# android - 在 Android 中以编程方式监控 Web 浏览器？

> ID：15839130
> 
> 赞同：0
> 
> 时间：2013-04-05T16:39:43.523
> 
> 标签：android, android-intent, android-activity, android-webview, android-view

我在这里有一个棘手的问题。我需要用户向英国的银行（即巴克莱卡）付款。为此，我有一个 https URL，我将参数（例如支付金额、订单参考等）添加到 URL，将这个 http 连接作为 Intent.ActionView 启动，这会将用户重定向到他所在的浏览器可以在银行网页上输入他的信用卡详细信息，并成功向我们的帐户付款。到现在为止还挺好 ？

我使用的代码如下（出于隐私原因，我更改了值）问题是，当用户完成/失败/取消付款时，我需要返回应用程序。支付成功时，Barclaycard 会自动重定向到特定的 URL，如果失败，则会重定向到另一个 URL。有没有办法知道巴克莱卡付款何时成功，以便我以某种方式回到安卓应用程序？

```
Button cardbutton = (Button) findViewById(R.id.card_button);
cardbutton.setOnClickListener(new View.OnClickListener()
{
    @Override
    public void onClick(View arg0)
    {
        String preHashString = new String();
        String proHashString = new String();
        String SHAPassPhrase = new String();

        SHAPassPhrase = "GSvTh£h70ZkHdAq9b"; // FOR TEST ENVIRONMENT

        preHashString = preHashString + "AMOUNT=" + String.valueOf((int) (order.getPaymentAmount() * 100.00)) + SHAPassPhrase;
        preHashString = preHashString + "BGCOLOR=cccccc" + SHAPassPhrase;
        preHashString = preHashString + "CN=" + user.getString("name") + SHAPassPhrase;
        preHashString = preHashString + "CURRENCY=GBP" + SHAPassPhrase;
        preHashString = preHashString + "LANGUAGE=en_US" + SHAPassPhrase;
        preHashString = preHashString + "ORDERID=" + order.getOrderId() + SHAPassPhrase;

        try
        {
            proHashString = SHA1(preHashString);
        }
        catch (NoSuchAlgorithmException e)
        {
            e.printStackTrace();
        }
        catch (UnsupportedEncodingException e)
        {
            e.printStackTrace();
        }

        String redirecturl = "https://mdepayments.epdq.co.uk/ncol/test/orderstandard.asp";

        redirecturl += "?AMOUNT=" + String.valueOf((int) (order.getPaymentAmount() * 100));
        redirecturl += "&CN=" + user.getString("name");
        redirecturl += "&CURRENCY=GBP";
        redirecturl += "&LANGUAGE=en_US";
        redirecturl += "&ORDERID=" + order.getOrderId();
        redirecturl += "&SHASIGN=" + proHashString;

        Intent i = new Intent(Intent.ACTION_VIEW, Uri.parse(redirecturl));
        startActivity(i);
    }
}); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-05T16:56:39.107

如果您的用户被重定向到一个新的 URL，您可以使用一个`ContentObserver`观察书签历史记录的任何更改：

```
public class UrlObserver extends ContentObserver {

    @Override
    public void onChange(boolean selfChange) {
       super.onChange(selfChange);
       // check last URL in history
    }
} 
```

阅读历史可以通过以下方式完成：

```
private static final Uri CONTENT_URI = Browser.BOOKMARKS_URI;
Cursor cursor = context.getContentResolver().query(
                    CONTENT_URI, Browser.HISTORY_PROJECTION, null, null, null); 
```

内容观察者的注册适用于：

```
UrlObserver observer = new UrlObserver();
context.getContentResolver().registerContentObserver(CONTENT_URI, true, observer); 
```

检测到特定 URL 后，您可以调用 Intent 将您的活动带回前面。 [这](http://code.google.com/p/gbandroid/source/browse/trunk/MobileSpy/src/org/ddth/android/monitor/observer/AndroidBrowsingHistoryWatcher.java?r=47)是一个示例应用程序，在这种情况下可能会对您有所帮助。

我不是 100% 确定如果使用*同一个*站点进行表单传输会发生什么。可能是内容观察者不会触发。在这种情况下，您可能会发现一些有用的日志条目。

注意：Chrome 和 Android 标准浏览器使用不同的 URL 进行查询。搜索互联网以找到合适的。

希望这会有所帮助....干杯！

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-05T17:18:30.587

您可以在您的应用程序中放置自己的 Webview，在某处使用一些完成/关闭按钮。然后您可以跟踪在您的 WebView 中打开的所有 url 并相应地执行您的操作..用户将始终留在您的应用程序中..这解决了你的目的..

要跟踪 WebView 中的所有 url，您需要注册一个 WebViewClient 和 ovveride 下面的函数

```
public boolean shouldOverrideUrlLoading (WebView view, String url) 
```

看看这里的[WebView 和这里](http://developer.android.com/reference/android/webkit/WebView.html)的[WebViewClient](http://developer.android.com/reference/android/webkit/WebViewClient.html)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-04-05T18:30:49.553

你永远不应该在用户设备上做这样的事情。有人可以反编译您的代码并对其进行更改，因此您的应用程序会“认为”他们已付款。

这可能会导致像他们免费使用应用程序这样的小问题，或者像您被迫支付所有款项这样的严重问题。

要么使用服务器端解决方案，要么使用 Google 的应用内购买。

# java - 屏幕熄灭时如何启动活动？

> ID：15839131
> 
> 赞同：0
> 
> 时间：2013-04-05T16:39:43.747
> 
> 标签：java, android, android-intent, android-activity, broadcastreceiver

我有一个应用程序，它只在设备屏幕关闭时才开始工作。我已经设置了广播接收器 ( `Intent.ACTION_SCREEN_OFF`)，它工作正常。当设备屏幕关闭时，我总是在我的 LOGCAT 中记录。到目前为止，一切都很好。

我`onReceive`来自 ACTION_SCREEN_OFF 的代码使用了一些代码计算的东西，并且一切都执行得很好（当屏幕熄灭时）。到目前为止，一切都很好。

在我的`onReceive`代码结束时，我开始了新的活动，但`onCreate`目标活动并不总是在执行。（例如，在我的 HTC Desire 2.3.7 上工作正常。在 HTC Wildfire S 2.3.5、Xperia Arc S 2.3.4 上它不执行，而在三星 Galaxy ACE 2.2.1 上，这取决于。有时正在执行有时不是' t)。我的 LOGCAT 显示`onReceive`执行到最后但 Activity 没有启动。我正在使用以下代码开始此活动：

```
Intent startH_Activity = new Intent(getApplicationContext(), HandleActivity.class);
        startH_Activity.addFlags(Intent.FLAG_ACTIVITY_NEW_TASK);
        startH_Activity.addFlags(Intent.FLAG_ACTIVITY_CLEAR_TOP);
        startActivity(startH_Activity); 
```

**需要注意的重要事项：**

*   我说在上面提到的某些手机上它不起作用。好吧，它不能立即工作，就像它应该的那样（当 SCREEN_OFF 触发时）。总是在屏幕关闭后 10-15 分钟开始活动（这是不可接受的）

*   当屏幕熄灭且活动未启动时，如果我按下设备上的电源按钮，它会立即关闭我的目标活动，并且应用程序正常工作。（同样这是不可接受的。它应该自动触发）。

*   当任何设备连接到 PC 时，它都可以正常工作。屏幕关闭后立即开始活动。

在阅读了很多 Stack Overflow 之后，我意识到这是因为 MAYBE 设备进入了睡眠状态。这就是为什么如果我按下 POWER 按钮它会正常工作，或者在 10-15 分钟后自动唤醒，因为它是同步的或其他东西。所以我使用了 WAKELOCK。

```
//OnCreate Service
powMan = (PowerManager) getSystemService(POWER_SERVICE);
wake = powMan.newWakeLock(PowerManager.ACQUIRE_CAUSES_WAKEUP, "TAG");

//OnReceive (screen goes off)
wake.acquire(); 
```

但仍然没有成功。（我做错了吗？）即使获得了唤醒锁定，我的活动也不会出现在这些设备上。

**基本上就是我要问的。屏幕关闭时如何打开常规活动？或者至少在活动无法启动时如何打开屏幕（请记住，按下电源按钮会显示我的活动**

我现在真的需要一些帮助，因为我对此感到非常沮丧。谢谢你的帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-05T16:53:13.940

当屏幕熄灭时，您应该启动 Service 而不是 Activity。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-10-26T07:40:54.587

我会注册另一个广播接收器并在屏幕打开时启动活动（`Intent.ACTION_SCREEN_ON`）。

两个问题：

1）你如何将数据从一个接收器传递到另一个接收器？我想到的是启动服务或将信息保存到文件（或共享首选项）。

2）如果你有两个必须启动一个活动的事件会发生什么？（例如“某事开始”和“某事完成”。）您必须解决这个问题，要么显示两个事件，要么只显示最新的一个。

请注意，用户可以在不解锁屏幕的情况下打开和关闭屏幕 ( `Intent.ACTION_USER_PRESENT`)，并且如果手机配置为不锁定屏幕，`Intent.ACTION_USER_PRESENT`则不会发生这种情况。

# c# - 解析固定宽度，插入数组。如何？

> ID：15839132
> 
> 赞同：0
> 
> 时间：2013-04-05T16:39:43.887
> 
> 标签：c#

我正在尝试解析[强力球彩票文本文件](http://www.powerball.com/powerball/winnums-text.txt)，将 6 列中的每一列添加到它们自己的数组中，然后稍微尝试一下。

以下是数据示例：

```
Draw Date   WB1 WB2 WB3 WB4 WB5 PB  PP
04/03/2013  35  08  12  01  06  03  
03/30/2013  23  46  11  26  55  27  
03/27/2013  43  48  07  37  52  16  
03/23/2013  29  53  52  17  31  31  
03/20/2013  43  17  14  13  54  15  
03/16/2013  44  53  07  21  03  16  
... 
```

这是我的想法：

```
int[] column1 = new int[] {1, 2, 3, 4, 5, 6, 7, 8, 9, 10};
int[] column2 = new int[] {1, 2, 3, 4, 5, 6, 7, 8, 9, 10};
int[] column3 = new int[] {1, 2, 3, 4, 5, 6, 7, 8, 9, 10};
int[] column4 = new int[] {1, 2, 3, 4, 5, 6, 7, 8, 9, 10};
int[] column5 = new int[] {1, 2, 3, 4, 5, 6, 7, 8, 9, 10};
int[] column6 = new int[] {1, 2, 3, 4, 5, 6, 7, 8, 9, 10}; 
```

只需要一点点解析功能。像PHP的explode函数这样的东西会很好。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-05T16:46:58.370

基本操作模式：拆分成行，按分隔符拆分，处理数据。一个简单的解析函数可能是：

```
var cli = new WebClient();
var raw = cli.DownloadString("http://www.powerball.com/powerball/winnums-text.txt");
var lines = raw.Split('\n');
var records = from line in lines.Skip(1)
              let parts = line.Split(new char[] {' '}, StringSplitOptions.RemoveEmptyEntries)
              select new {
                Date = DateTime.Parse(parts[0], CultureInfo.InvariantCulture),
                Numbers = parts.Skip(1).Take(6).Select(x => int.Parse(x))
              }; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-05T16:42:12.823

我认为您需要拆分功能

```
"text and stuffz".Split('\n'); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-05T16:48:53.673

如果您喜欢固定宽度的方法而不是拆分（但是拆分更容易），您可以只使用子字符串函数：

```
DateTime date = DateTime.ParseExact(line.Substring(0, 10), "MM\\/dd\\/yyyy");
string[] nums = new string[6];
nums[0] = line.Substring(12, 2).Trim();
nums[1] = line.Substring(16, 2).Trim();
etc... 
```

或者

```
string[] nums = new[]
    {
        line.Substring(12, 2).Trim(),
        line.Substring(16, 2).Trim(),
        etc...
    }; 
```

# haskell - 如何在 Haskell 中运行函数？

> ID：15839135
> 
> 赞同：-1
> 
> 时间：2013-04-05T16:39:50.823
> 
> 标签：haskell

我有功能，定义如下

```
function1 :: [Char] -> Int
function1 (x:s) | x=......... 
```

如何在解释器 Hugs 中调用此函数。我的意思是如果我有功能

```
function2 :: Int -> [Int]
function2 n | n < ......... 
```

我可以在解释器中调用它

```
function2 5 
```

例如。

谢谢你。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-05T17:40:22.090

你可以用一个字符列表来调用它，也称为字符串：

```
function1 "foo" 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-05T19:47:10.747

Rein Henrichs 说的是正确的，但是您确定您正在将您编写的函数加载到解释器中吗？

因此，如果您将函数保存在其中，`functions.hs`则在与文件相同的文件夹中启动交互式控制台（Hugs 或 GHCi）并键入：

```
> :load functions.hs
> function1 "foo" 
```

# javascript - 我可以使用淡入淡出将一个饼图转换为另一个饼图吗？

> ID：15839142
> 
> 赞同：0
> 
> 时间：2013-04-05T16:40:13.307
> 
> 标签：javascript, jquery, html, highcharts

我正在使用 Highcharts v.2.3.3 并构建了一个饼图。当用户点击某个东西时，我可以用另一个图表替换该图表，但替换会立即发生。有没有办法让第一个饼图淡出而新饼图淡入，所以有“模糊”效果？

注意：当前第一个饼图在构建新图表之前被删除。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-05T16:42:21.690

我会像这样使用 jquery 淡出当前图表容器：

```
$('#ChartContainer').fadeOut(); 
```

然后我会用新的图表替换图表并使用 jquery fadeIn() 将图表重新显示在视图中。

**编辑**

jquery fadeOut/fadeIn 函数的第一个参数是可选的速度参数，因此您可以对动画进行计时，以便它们“模糊”在一起。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-05T18:35:39.777

我找到了解决方案。我使用 jquery 克隆了第一个图表的 svg 元素并将其附加到绝对位于图表区域上方的 div 中。然后，我使用该“虚拟”图表进行淡出动画，而无需在第二个图表中淡入淡出。

```
var clonedChart = $('#chartContainer').find('svg').clone();
$('<div class="cloned_chart"></div>').append(clonedChart).appendTo('#pieChartWrapper');

// delete first chart and create second one
....

// chart creation callback
$('.cloned_chart').fadeOut('slow', function(){
  $(this).remove();
}); 
```

# opengl - glCheckFramebufferStatus 返回 36062

> ID：15839147
> 
> 赞同：0
> 
> 时间：2013-04-05T16:40:22.120
> 
> 标签：opengl, constants, glew

**问题：** glCheckFramebufferStatus 返回的值（36062）与任何记录的常量都不匹配。

我正在尝试创建一个帧缓冲区对象，然后检查它的状态，但是 glCheckFramebufferStatus 返回一个与任何常量都不匹配的值。
难道我做错了什么？到目前为止，所有其他命令都有效。

*代码（闪电战）：*

```
glGenFramebuffers(1, Varptr gl_Framebuffer)
glGenTextures(1, Varptr gl_FramebufferTex)
glBindTexture(GL_TEXTURE_2D, gl_FramebufferTex)
glTexImage2D(GL_TEXTURE_2D, 0, GL_RGB, vRW, vRH, 0, GL_RGB, GL_UNSIGNED_BYTE, 0)
glTexParameteri(GL_TEXTURE_2D, GL_TEXTURE_MAG_FILTER, GL_NEAREST);
glTexParameteri(GL_TEXTURE_2D, GL_TEXTURE_MIN_FILTER, GL_NEAREST);
glBindFramebuffer(GL_FRAMEBUFFER, gl_Framebuffer)
glFramebufferTextureARB(GL_READ_FRAMEBUFFER, GL_COLOR_ATTACHMENT0, gl_FramebufferTex, 0)
glFramebufferTextureARB(GL_DRAW_FRAMEBUFFER, GL_COLOR_ATTACHMENT0, gl_FramebufferTex, 0)

Local fbo0Status:Int = glCheckFramebufferStatus(gl_Framebuffer)
Select fbo0Status
    Case GL_FRAMEBUFFER_INCOMPLETE_ATTACHMENT
        Print "[FBO0] GL_FRAMEBUFFER_INCOMPLETE_ATTACHMENT"
    ...
    Default
        Print "[FBO0] GL_I_DONT_KNOW_THIS_FREAKING_VALUE (" + fbo0Status + ")"
EndSelect 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-07-24T03:21:48.087

所以我在遵循一些错误的 FBO 演示代码时也遇到了这个问题。经过半小时的调试，我发现了问题所在。

这里的问题是代码

```
Local fbo0Status:Int = glCheckFramebufferStatus(gl_Framebuffer) 
```

根据此处的OpenGL文档：

[http://www.opengl.org/sdk/docs/man3/xhtml/glCheckFramebufferStatus.xml](http://www.opengl.org/sdk/docs/man3/xhtml/glCheckFramebufferStatus.xml)

您不应该传入帧缓冲区 ID。相反，您应该传入 GL_FRAMEBUFFER。

规范规定，在将无效值传递给 glCheckFramebufferStatus() 时，它应该生成 GL_INVALID_ENUM。然而，这似乎是一个驱动程序错误，因为它会生成 36062。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-06T01:10:25.423

好吧，我可以这样说： 0x8CDE (36062 in hex) 不仅不匹配任何预期的返回值 from `glCheckFramebufferStatus`，它也不匹配*OpenGL 中的任何枚举*。

所以这显然是一个驱动程序错误。

话虽如此，您的代码是多余的。您不需要将相同的纹理附加到同一附加点上的同一帧缓冲区*两次*。绑定到`GL_FRAMEBUFFER`同时将相同的 FBO绑定到帧缓冲区`READ`和`DRAW`帧缓冲区。所以你的两个`glFramebufferTexture`电话只是多余的。

但这不应该引起问题。

# c++ - 旋转 NxN 矩阵计数器（反）-顺时针 90 度

> ID：15839151
> 
> 赞同：2
> 
> 时间：2013-04-05T16:40:32.153
> 
> 标签：c++, matrix, rotation

我有一个 2D 矩阵 M[N][N] 我需要逆时针旋转 90 度。我已经看到很多顺时针旋转的答案，但我找不到逆时针方向。这两个操作有多相似？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-05T16:59:48.307

如果你颠倒每一行的顺序，然后以与顺时针旋转相反的顺序取行，你会得到一个逆时针旋转。

```
A B C                  G D A               A D G                  C F I
D E F -> Clockwise ->  H E B -> Reverse -> B E H  -> Opposite ->  B E H
G H I                  I F C    Rows       C F I     Ordering     A D G

Matrix                                                            Counter
                                                                  Clockwise 
```

如果您已经有可用的顺时针旋转算法，通常以相反的顺序对原始矩阵进行顺时针旋转会更容易（并且计算效率更高）。

```
1 2 3                9 8 7                 3 6 9
4 5 6 -> Reverse  -> 6 5 4 -> Clockwise -> 2 5 8
7 8 9    Indices     3 2 1                 1 4 7

Matrix                                     Counter
                                           Clockwise 
```

您也可以顺时针旋转 3 圈以逆时针旋转。

尽管实际上，根据您的目的直接编辑顺时针算法通常相当容易。因此，如果您不关心效率并且不想通过改变旋转方向的逻辑来工作，我只会使用上述选项。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-05T16:45:54.707

从 row(max)，递减，用该列的值一个接一个地填充结果行（递增索引）（递增）。

所以在 3 x 3 中，使用（使用 r，c 符号，如 Excel）

(3, 1), (3, 2), (3, 3), (2, 1), (2, 2), (2, 3),

等等

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-05T16:49:58.960

好的。让我们说`N =2`简单：

```
1  2
3  4 
```

逆时针90度意味着它将变成：

```
2 4
1 3 
```

我们有以下规则：

```
1 last column from top to bottom of original matrix becomes 
  first row of rotated matrix from left to right
2 first column of original matrix becomes last row of rotated matrix
3 same rules apply to other columns of original matrix 
```

您可以轻松地编写代码。另一种方法是首先对矩阵进行转置，然后反转所有行的顺序。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-05T17:00:38.933

如果您使用的是特定的矩阵库，您可以只进行 3 次转置

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2019-08-18T13:44:41.837

```
public static void main(String[] args) {
    int[][] matrix = createAMatrix(3,3);
    List<Stack<Integer>> tiltedMatrix = tiltMatrixBy90Now(matrix, 3);

    int[][] newMatrix = new int[3][3];

    for(int i = 0; i < 3; i ++) {
        for(int j = 0; j < 3; j ++) {
            newMatrix[i][j] = tiltedMatrix.get(j).pop();
        }
    }
    //print new matrix
    for(int i = 0; i < 3; i ++) {
        for(int j = 0; j < 3; j ++) {
            System.out.print(newMatrix[i][j]+" ");
        }
        System.out.println();
    }

}

private static List<Stack<Integer>> tiltMatrixBy90Now(int[][] matrix , long order) {
    List<Stack<Integer>> stackList = new ArrayList<>();
    //filling the stack
    for(int i = 0; i< order ; i++) {
        stackList.add(new Stack<Integer>());
    }

    for(int i = 0; i < order; i ++) {
        for(int j = 0; j < order; j ++) {
            stackList.get(i).push(matrix[i][j]);
        }
    }
    return stackList;
}
private static int[][] createAMatrix(final int a, final int b){
    int counter = 1;
    int[][] matrix  = new int[a][b];
    Scanner scanner = new Scanner(System.in);
    while(counter <= a*b) {
        for(int i = 0; i < a; i ++) {
            for(int j = 0; j < b; j ++) {
                matrix[i][j] = scanner.nextInt();
                counter++;
            }
        }
    }
    return matrix;
} 
```

/*

输入矩阵（3乘3）1 2 3 4 5 6 7 8 9

输出矩阵（3乘3）：3 6 9 2 5 8 1 4 7

代码演练作为文本解释

1.  创建一个矩阵，在上面的代码中是3*3的矩阵
2.  从 3*3 矩阵的每一行创建 3 个堆栈
3.  并行地从每个堆栈中逐一弹出并重新创建矩阵。
4.  将新的倾斜矩阵打印 90 度（逆时针）。

*/

# internet-explorer - 有没有办法强制 IE 以 IE8 标准或更高标准呈现？

> ID：15839156
> 
> 赞同：0
> 
> 时间：2013-04-05T16:40:40.667
> 
> 标签：internet-explorer, standards

我知道要强制 IE 在 ie8 中呈现，请使用：

```
<meta http-equiv="X-UA-Compatible" content="IE=8" /> 
```

但是有没有办法强制 IE 呈现**ie8 或 ie9**？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-05T16:43:18.323

这：

```
<meta http-equiv="X-UA-Compatible" content="IE=Edge" /> 
```

将呈现可用的最高版本，而无需尝试模拟早期版本，如果这就是您的意思。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-05T16:43:36.873

根据[http://msdn.microsoft.com/en-ca/library/jj676915%28v=vs.85%29.aspx](http://msdn.microsoft.com/en-ca/library/jj676915%28v=vs.85%29.aspx)

```
... content="IE=8,9" /> 
```

# php - php静态属性和方法

> ID：15839163
> 
> 赞同：0
> 
> 时间：2013-04-05T16:41:06.173
> 
> 标签：php, methods, properties, static

定义如下

```
class Timer{
    private static $timeRemaining;
    private static $timeLimit;
    private static $nextTime;

    static function block();
    static function updateCookies();
} 
```

在网页之间穿梭时，这些静态属性和方法的寿命是多久？结果，哪个更好，使用上面的类还是单例对象？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-05T16:46:34.543

它们的存在与 PHP 执行代码一样多——而请求存在。

当然，网页之间的所有数据都会被删除。但是您可以使用会话并手动将数据分配给静态变量或非静态实例变量。

单例使用静态变量作为实例的存储。

# javascript - 如何获取选定单选按钮的值？

> ID：15839169
> 
> 赞同：393
> 
> 时间：2013-04-05T16:41:17.223
> 
> 标签：javascript, html, radio-button

我想从一组单选按钮中获取选定的值。

这是我的 HTML：

```
<div id="rates">
  <input type="radio" id="r1" name="rate" value="Fixed Rate"> Fixed Rate
  <input type="radio" id="r2" name="rate" value="Variable Rate"> Variable Rate
  <input type="radio" id="r3" name="rate" value="Multi Rate" checked="checked"> Multi Rate  
</div> 
```

这是我的js：

```
var rates = document.getElementById('rates').value;
var rate_value;
if(rates =='Fixed Rate'){
    rate_value = document.getElementById('r1').value;

}else if(rates =='Variable Rate'){
    rate_value = document.getElementById('r2').value;

}else if(rates =='Multi Rate'){
    rate_value = document.getElementById('r3').value;
}  

document.getElementById('results').innerHTML = rate_value; 
```

我一直不确定。

* * *

## 回答 #1

> 赞同：652
> 
> 时间：2013-04-05T16:59:04.617

这适用于 IE9 及更高版本以及所有其他浏览器。

```
document.querySelector('input[name="rate"]:checked').value; 
```

* * *

## 回答 #2

> 赞同：296
> 
> 时间：2013-04-05T16:50:19.437

```
var rates = document.getElementById('rates').value; 
```

rate 元素是 a `div`，因此它没有值。这可能是`undefined`它的来源。

该`checked`属性会告诉你元素是否被选中：

```
if (document.getElementById('r1').checked) {
  rate_value = document.getElementById('r1').value;
} 
```

或者

```
$("input[type='radio'][name='rate']:checked").val(); 
```

* * *

## 回答 #3

> 赞同：155
> 
> 时间：2013-04-05T16:48:22.567

您可以使用该`checked`属性获取值。

```
var rates = document.getElementsByName('rate');
var rate_value;
for(var i = 0; i < rates.length; i++){
    if(rates[i].checked){
        rate_value = rates[i].value;
    }
} 
```

* * *

## 回答 #4

> 赞同：43
> 
> 时间：2014-10-07T12:46:21.193

对于生活在边缘的人们：

现在有一个叫做[RadioNodeList](https://developer.mozilla.org/en-US/docs/Web/API/RadioNodeList)的东西，访问它的 value 属性将返回当前检查的输入的值。正如我们在许多发布的答案中看到的那样，这将消除首先过滤掉“已检查”输入的必要性。

示例表格

```
<form id="test">
<label><input type="radio" name="test" value="A"> A</label>
<label><input type="radio" name="test" value="B" checked> B</label>
<label><input type="radio" name="test" value="C"> C</label>
</form> 
```

要检索检查的值，您可以执行以下操作：

```
var form = document.getElementById("test");
alert(form.elements["test"].value); 
```

JSFiddle 来证明它：http: [//jsfiddle.net/vjop5xtq/](http://jsfiddle.net/vjop5xtq/)

请注意，这是在 Firefox 33 中实现的（所有其他主要浏览器似乎都支持它）。较旧的浏览器需要 polfyill`RadioNodeList`才能正常运行

* * *

## 回答 #5

> 赞同：17
> 
> 时间：2016-05-23T13:15:17.773

下面从 api.jquery.com 给出了为我工作的那个。

HTML

```
<input type="radio" name="option" value="o1">option1</input>
<input type="radio" name="option" value="o2">option2</input> 
```

JavaScript

```
var selectedOption = $("input:radio[name=option]:checked").val() 
```

变量 selectedOption 将包含所选单选按钮的值（即）o1 或 o2

* * *

## 回答 #6

> 赞同：15
> 
> 时间：2015-02-27T14:43:53.473

另一个（显然较旧）选项是使用格式：“document.nameOfTheForm.nameOfTheInput.value;” 例如**document.mainForm.rads.value；**

```
document.mainForm.onclick = function(){
    var radVal = document.mainForm.rads.value;
    result.innerHTML = 'You selected: '+radVal;
}
```

```
<form id="mainForm" name="mainForm">
    <input type="radio" name="rads" value="1" />
    <input type="radio" name="rads" value="2" />
    <input type="radio" name="rads" value="3" />
    <input type="radio" name="rads" value="4" />
</form>
<span id="result"></span>
```

您可以在表单中通过其名称来引用元素。但是，您的原始 HTML 不包含表单元素。

在这里小提琴（在 Chrome 和 Firefox 中工作）： [https ://jsfiddle.net/Josh_Shields/23kg3tf4/1/](https://jsfiddle.net/Josh_Shields/23kg3tf4/1/)

* * *

## 回答 #7

> 赞同：12
> 
> 时间：2017-11-20T12:20:10.793

使用**document.querySelector('input[type = radio]:checked').value;** 要获取选定复选框的值，您可以使用其他属性来获取值，例如**名称 = 性别** 等。请通过 **下面的代码段肯定会对您有所帮助，**

解决方案

```
document.mainForm.onclick = function(){
    var gender = document.querySelector('input[name = gender]:checked').value;
    result.innerHTML = 'You Gender: '+gender;
}
```

```
<form id="mainForm" name="mainForm">
    <input type="radio" name="gender" value="Male" checked/>Male
    <input type="radio" name="gender" value="Female" />Female
    <input type="radio" name="gender" value="Others" />Others
</form>
<span id="result"></span>
```

谢谢你

* * *

## 回答 #8

> 赞同：10
> 
> 时间：2018-05-25T12:49:33.523

HTML 代码：

`<input type="radio" name="rdoName" value="YES"/> <input type="radio" name="rdoName" value="NO"/>`

查询代码：

```
var value= $("input:radio[name=rdoName]:checked").val(); 
```

```
$("#btnSubmit").click(function(){
var value=$("input:radio[name=rdoName]:checked").val();
console.log(value);
alert(value);
})
```

```
<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
<input type="radio" name="rdoName" value="YES"/> YES
<input type="radio" name="rdoName" value="NO"/> NO
<br/>
<input type="button"id="btnSubmit"value="Which one Selected"/>
```

你会得到

```
value="YES" //if checked Radio Button with the value "YES"
value="NO" //if checked Radio Button with the value "NO" 
```

* * *

## 回答 #9

> 赞同：6
> 
> 时间：2013-10-08T07:45:06.237

**`getElementById()`**在Javascript中，我们可以通过在您发布的上述代码中使用Id的“”来获取值，其中包含名称而不是Id，因此您可以像这样修改

```
if (document.getElementById('r1').checked) {
  rate_value = document.getElementById('r1').value;
} 
```

根据您的代码使用此 rate_value

* * *

## 回答 #10

> 赞同：5
> 
> 时间：2014-05-20T17:47:01.893

自从提出问题以来已经过去了一年左右，但我认为答案的实质性改进是可能的。我发现这是最简单和最通用的脚本，因为它会检查按钮是否被选中，如果是，它的值是什么：

```
<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>Check radio checked and its value</title>
</head>
<body>

    <form name="theFormName">
        <input type="radio" name="theRadioGroupName" value="10">
        <input type="radio" name="theRadioGroupName" value="20">
        <input type="radio" name="theRadioGroupName" value="30">
        <input type="radio" name="theRadioGroupName" value="40">
        <input type="button" value="Check" onclick="getRadioValue('theRadioGroupName')">
    </form>

    <script>
        function getRadioValue(groupName) {
            var radios = theFormName.elements[groupName];
            window.rdValue; // declares the global variable 'rdValue'
            for (var i=0; i<radios.length; i++) {
                var someRadio = radios[i];
                if (someRadio.checked) {
                    rdValue = someRadio.value;
                    break;
                }
                else rdValue = 'noRadioChecked';
            }
            if (rdValue == '10') {
                alert('10'); // or: console.log('10')
            }
            else if (rdValue == 'noRadioChecked') {
                alert('no radio checked');
            }
        }
    </script>
</body>
</html> 
```

您还可以在另一个函数中调用该函数，如下所示：

```
function doSomething() {
    getRadioValue('theRadioGroupName');
    if (rdValue == '10') {
        // do something
    }
    else if (rdValue == 'noRadioChecked') {
        // do something else
    }  
} 
```

* * *

## 回答 #11

> 赞同：5
> 
> 时间：2016-06-03T13:28:40.203

假设您的表单元素由`myForm`下面的变量引用，并且您的单选按钮共享名称“my-radio-button-group-name”，以下是纯 JavaScript 和标准兼容（尽管我没有检查它是否在任何地方都可用):

```
myForm.elements.namedItem("my-radio-button-group-name").value 
```

以上将产生一个*选中*的（或选择的，也称为）单选按钮元素的值，如果有的话，或者`null`其他。解决方案的关键是`namedItem`专门与单选按钮配合使用的功能。

请参阅[HTMLFormElement.elements](https://developer.mozilla.org/en-US/docs/Web/API/HTMLFormElement/elements)、[HTMLFormControlsCollection.namedItem](https://developer.mozilla.org/en-US/docs/Web/API/HTMLFormControlsCollection)，尤其是[RadioNodeList.value](https://developer.mozilla.org/en-US/docs/Web/API/RadioNodeList)，因为`namedItem` *通常*返回一个`RadioNodeList`对象。

我使用 MDN 是因为它允许人们至少在很大程度上跟踪标准合规性，并且因为它比许多 WhatWG 和 W3C 出版物更容易理解。

* * *

## 回答 #12

> 赞同：4
> 
> 时间：2020-07-20T22:20:07.093

# 最短的

```
[...rates.children].find(c=>c.checked).value 
```

```
let v= [...rates.children].find(c=>c.checked).value

console.log(v);
```

```
<div id="rates">
  <input type="radio" id="r1" name="rate" value="Fixed Rate"> Fixed Rate
  <input type="radio" id="r2" name="rate" value="Variable Rate"> Variable Rate
  <input type="radio" id="r3" name="rate" value="Multi Rate" checked="checked"> Multi Rate  
</div>
```

* * *

## 回答 #13

> 赞同：3
> 
> 时间：2013-12-13T11:31:20.473

多次直接调用单选按钮会为您提供 FIRST 按钮的值，而不是 CHECKED 按钮。而不是循环通过单选按钮来查看哪个被选中，我更喜欢调用一个`onclick`javascript函数来设置一个以后可以随意检索的变量。

```
<input type="radio" onclick="handleClick(this)" name="reportContent" id="reportContent" value="/reportFleet.php" > 
```

调用：

```
var currentValue = 0;
function handleClick(myRadio) {
    currentValue = myRadio.value;
    document.getElementById("buttonSubmit").disabled = false; 
} 
```

另一个优点是我可以处理数据和/或对按钮的检查做出反应（在这种情况下，启用提交按钮）。

* * *

## 回答 #14

> 赞同：3
> 
> 时间：2019-12-07T00:05:17.687

您还可以在元素上使用 forEach 循环遍历按钮

```
 var elements = document.getElementsByName('radioButton');
    var checkedButton;
    console.log(elements);
    elements.forEach(e => {
        if (e.checked) {
            //if radio button is checked, set sort style
            checkedButton = e.value;
        }
    }); 
```

* * *

## 回答 #15

> 赞同：2
> 
> 时间：2014-07-25T18:02:56.833

对先前建议功能的改进：

```
function getRadioValue(groupName) {
    var _result;
    try {
        var o_radio_group = document.getElementsByName(groupName);
        for (var a = 0; a < o_radio_group.length; a++) {
            if (o_radio_group[a].checked) {
                _result = o_radio_group[a].value;
                break;
            }
        }
    } catch (e) { }
    return _result;
} 
```

* * *

## 回答 #16

> 赞同：2
> 
> 时间：2016-10-18T11:16:07.357

您可以使用`.find()`来选择选中的元素：

```
var radio = Array.from(document.querySelectorAll('#rate input'))

var value = radio.length && radio.find(r => r.checked).value 
```

* * *

## 回答 #17

> 赞同：2
> 
> 时间：2017-11-21T10:45:52.087

我对纯 javascript 的这个问题的看法是找到选中的节点，找到它的值并将其从数组中弹出。

```
var Anodes = document.getElementsByName('A'),
    AValue = Array.from(Anodes)
       .filter(node => node.checked)
       .map(node => node.value)
       .pop();
console.log(AValue); 
```

请注意，我使用的是[箭头函数](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Functions/Arrow_functions)。请参阅此[小提琴](https://jsfiddle.net/7kjpc2ue/)以获取工作示例。

* * *

## 回答 #18

> 赞同：2
> 
> 时间：2021-08-24T15:41:38.233

如果你使用没有 jQuery 的 javascript，你可以使用这个命令：

```
document.querySelector(`input[type="radio"][name=rate]:checked`).value 
```

* * *

## 回答 #19

> 赞同：1
> 
> 时间：2016-02-23T09:18:43.503

如果您使用的是 jQuery：

`$('input[name="rate"]:checked').val();`

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2017-01-15T00:06:34.103

```
<form id="rates">
  <input type="radio" name="rate" value="Fixed Rate"> Fixed
  <input type="radio" name="rate" value="Variable Rate"> Variable
  <input type="radio" name="rate" value="Multi Rate" checked> Multi
</form> 
```

然后...

```
var rate_value = rates.rate.value; 
```

* * *

## 回答 #21

> 赞同：0
> 
> 时间：2017-02-28T07:10:59.213

按 ID 检查值：

```
var CheckedValues = ($("#r1").is(':checked')) ? 1 : 0; 
```

* * *

## 回答 #22

> 赞同：0
> 
> 时间：2017-04-28T07:27:59.407

我使用 jQuery.click 函数来获得所需的输出：

```
$('input[name=rate]').click(function(){
  console.log('Hey you clicked this: ' + this.value);

  if(this.value == 'Fixed Rate'){
    rate_value = $('#r1').value;
  } else if(this.value =='Variable Rate'){
   rate_value = $('#r2').value;
  } else if(this.value =='Multi Rate'){
   rate_value = $('#r3').value;
  }  

  $('#results').innerHTML = rate_value;
}); 
```

希望能帮助到你。

* * *

## 回答 #23

> 赞同：0
> 
> 时间：2017-04-29T19:47:22.090

如果按钮的形式
`var myform = new FormData(getformbywhatever); myform.get("rate");`
是上面的 QuerySelector 是一个更好的解决方案。但是，这种方法很容易理解，尤其是在您对 CSS 没有任何了解的情况下。另外，输入字段很可能无论如何都在表单中。
没查，还有其他类似的解决方法，抱歉重复

* * *

## 回答 #24

> 赞同：0
> 
> 时间：2017-06-06T12:04:17.913

```
var rates = document.getElementById('rates').value; 
```

无法获得这样的单选按钮的值，而是使用

```
rate_value = document.getElementById('r1').value; 
```

* * *

## 回答 #25

> 赞同：0
> 
> 时间：2017-06-28T10:21:23.930

如果您使用的是`JQuery`，请使用下面的代码段作为单选按钮组。

```
var radioBtValue= $('input[type=radio][name=radiobt]:checked').val(); 
```

* * *

## 回答 #26

> 赞同：0
> 
> 时间：2017-08-31T07:43:12.933

只需使用：`document.querySelector('input[rate][checked]').value`

* * *

## 回答 #27

> 赞同：0
> 
> 时间：2021-09-24T02:18:43.207

这是一个将单选按钮置于常量中并仅在需要时获取所选值的解决方案。

```
const rates = document.forms.rates.elements["rate"]
showRate()
function showRate(){
    document.getElementById('results').innerHTML = rates.value
}
```

```
<form id="rates" onchange="showRate()">
  <input type="radio" id="r1" name="rate" value="Fixed Rate"> Fixed Rate
  <input type="radio" id="r2" name="rate" value="Variable Rate"> Variable Rate
  <input type="radio" id="r3" name="rate" value="Multi Rate" checked="checked"> Multi Rate 
</form>
<div id="results"></div>
```

* * *

## 回答 #28

> 赞同：-1
> 
> 时间：2017-06-24T12:54:21.043

[https://codepen.io/anon/pen/YQxbZJ](https://codepen.io/anon/pen/YQxbZJ)

的HTML

```
<div id="rates">
<input type="radio" id="x1" name="rate" value="Fixed Rate"> Fixed Rate
<input type="radio" id="x2" name="rate" value="Variable Rate" 
checked="checked"> Variable Rate
<input type="radio" id="x3" name="rate" value="Multi Rate" > Multi Rate
</div>

<button id="rdio"> Check Radio </button>
<div id="check">

</div> 
```

JS

```
var x ,y;
var x = document.getElementById("check");
function boom()
{
if (document.getElementById("x1").checked)
  y = document.getElementById("x1").value;

else if(document.getElementById("x2").checked)
  y = document.getElementById("x2").value;

else if (document.getElementById("x3").checked)
  y = document.getElementById("x3").value;
else
  y = "kuch nhi;"
x.innerHTML = y;
}

var z = document.getElementById('rdio');
z.addEventListener("click", boom);` 
```

* * *

## 回答 #29

> 赞同：-1
> 
> 时间：2019-01-23T09:58:37.837

```
 var rates=document.getElementsByName("rate");
            for (i = 0; i < rates.length; i++) {
            if (rates[i].checked) {
              console.log(rates[i].value);
              rate=rates[i].value;
              document.getElementById("rate").innerHTML = rate;
              alert(rate);

            }
          }
```

```
 <div id="rates">
          <input type="radio" id="r1" name="rate" value="Fixed Rate"> Fixed Rate
          <input type="radio" id="r2" name="rate" value="Variable Rate"> Variable Rate
          <input type="radio" id="r3" name="rate" value="Multi Rate" checked="checked"> Multi Rate  
        </div>
        </br>
        <div id='rate'>
        </div>
```

* * *

## 回答 #30

> 赞同：-3
> 
> 时间：2018-07-19T11:35:20.050

在 php 中它是非常简单的
html 页面

```
Male<input type="radio" name="radio" value="male"><br/>
Female<input type="radio" name="radio" value="female"><br/>
Others<input type="radio" name="radio" value="other"><br/>
<input type="submit" value="submit">
```

从表单获取价值到 php

```
$radio=$_POST['radio'];<br/>
use php if(isset($_POST['submit']))<br/>
{<br/>
echo "you selected".$radio."thank u";<br/>
} 
```

# javascript - 大 javascript 函数 document.write 在 Firefox 中渲染 1 秒，在 chrome 中渲染 4 分钟，带有 html 代码

> ID：15839171
> 
> 赞同：-3
> 
> 时间：2013-04-05T16:41:22.530
> 
> 标签：javascript, html, performance, google-chrome, dom

Chrome 需要 4 分钟来呈现一个带有大型 javascript 函数的页面，而 Firefox 需要 1-2 秒。

这是一个简单的代码，一个`document.write`被调用了大约 30 次的 javascript 函数，因此它不必下载 30 x 1mb 的下拉数据。Firefox 在 1 秒内渲染它，在 4 分钟内渲染它。

这是实时 html 链接： html 链接已删除 在 Firefox 中检查并在 Chrome 中检查。

```
<script type="text/javascript">
function writeHTMLasJS_product_type(){
document.write("<option value=\"4\">ITEM 1<\/option>");
document.write("<option value=\"5\">ITEM 2<\/option>");
document.write("<option value=\"144\">Item 3<\/option>");
document.write("<option value=\"145\">Item 4<\/option>");
document.write("<option value=\"146\">Item 5<\/option>");
}
writeHTMLasJS_product_type(); 
```

现在它像 1mb 的数据，像 20 writeHTMLasJS_product_type(); 功能

这与处理器或内存无关，因为我有 5ghz i7 和 48gb 内存……要么是 Google Chrome 的限制，可以被覆盖，要么是可以以更好的方式定制的 javascript 来做同样的事情，你怎么看？

//我在想你们中的一些人会有兴趣看看 Chrome 需要渲染它的时间之间的差异，即使你不知道这里发生了什么。所以请不要仅仅因为你不知道答案就跳到投票否决这个问题。

此致

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-05T16:58:15.317

> DOM 的敌人，即 document.write()，……那么我必须做所有这些额外的工作，因为你是个混蛋。**[document.write() 是个混蛋](http://youtu.be/WxmcDoAxdoY?t=9m36s)** ![外部链接](https://i.stack.imgur.com/OUWhd.png)。

[保罗爱尔兰在 document.write()](http://www.youtube.com/watch?v=WxmcDoAxdoY&feature=youtu.be&t=9m27s) ![外部链接](https://i.stack.imgur.com/OUWhd.png)

长话短说：不要使用`document.write()`. 时期。观看更多视频以了解原因。基本上它会扰乱浏览器的解析过程。`document.write()`而且，显然，Chrome 与Firefox 相比，在使用 's的（巨大！）数量方面遇到了更多麻烦。但真正的问题不是 Chrome 处理`document.write()`速度太慢，而是你`document.write()`没有充分的理由使用。

为什么不直接操作 DOM？将数据放入一个变量/一些变量中（可能使用[JSON](http://en.wikipedia.org/wiki/JSON)，甚至可能使用单个或几个[AJAX](https://en.wikipedia.org/wiki/Ajax_%28programming%29)调用，但这不是必需的）并使用 DOM 操作方法设置所有数据。

我不打算一步一步地放下它，但像这样的东西：

```
function writeHTMLasJS_product_type(){
    document.write("<option value=\"0\">IZABERITE GRUPU<\/option>");
    document.write("<option value=\"4\">DSLR<\/option>");
    document.write("<option value=\"5\">PROSUMER<\/option>");
    document.write("<option value=\"6\">KOMPAKTNI<\/option>");
    document.write("<option value=\"8\">MiniDV KAMERE - VIDEO ZAPIS NA KASETU<\/option>");
    //...4000-or-so more lines
} 
```

应该是这样的：

```
var items = { 
    0: "IZABERITE GRUPU",
    4: "DSLR",
    5: "PROSUMER",
    6: "KOMPAKTNI",
    8: "MiniDV KAMERE - VIDEO ZAPIS NA KASETU",
} 
```

就其本身而言，它已经节省了**大量**带宽。接下来，您只需使用 DOM 操作来迭代项目并将它们添加到您的下拉列表/文本框/whatever-the-hell-it's-supposed-to-do。

![外部链接](https://i.stack.imgur.com/OUWhd.png)这是一个演示基本思想[的小提琴。](http://jsfiddle.net/xMpvF/)

如果您坚持使用`document.write()`（**我再次强烈建议您不要**使用它！），那么至少尝试将调用次数保持在`document.write()`最低限度：

```
document.write(
      '<option value="0">IZABERITE GRUPU<\/option>'
    + '<option value="4">DSLR<\/option>'
    + '<option value="5">PROSUMER<\/option>'
    + '<option value="6">KOMPAKTNI<\/option>'
    + '<option value="8">MiniDV KAMERE - VIDEO ZAPIS NA KASETU<\/option>'); 
```

我自己不要做一个混蛋（而不是`document.write()` ![在此处输入图像描述](https://i.stack.imgur.com/4GwcA.gif)）：我们不再生活在 90 年代；复习您的技术/知识，并在 2013 年与我们同行！

# facebook-graph-api - 登录时桌面应用程序工作流错误

> ID：15839173
> 
> 赞同：1
> 
> 时间：2013-04-05T16:41:25.640
> 
> 标签：facebook-graph-api, login, facebook-oauth

我们的桌面应用程序使用桌面应用程序工作流程与 Facebook 集成，大约需要 10 分钟。18个月一直工作没有任何问题。但是，我们开始收到一些用户的报告，称他们无法通过登录过程。

当登录成功时，Facebook 应该将 access_token 附加到 redirect_uri。我们的应用程序检测到这一点并将用户移动到我们 Facebook 集成的主要部分。在某些情况下似乎发生的情况是缺少 access_token 参数，这导致我们的应用程序使我们的嵌入式浏览器窗口保持打开状态，并显示来自 Facebook 的以下消息：
*“成功
安全警告：请将上面的 URL 视为您的密码并执行不与任何人分享。”*

奇怪的是，并非所有 Facebook 帐户都会出现这种情况，而且出现这种情况的 Facebook 帐户似乎正在发生变化。例如，我们有一份关于这个大约的报告。1 周前，但无法使用我自己的 Facebook 帐户或同事的 Facebook 帐户复制它。今天，我仍然无法用我自己的 Facebook 帐户复制它，但我的同事现在遇到了问题。

我们的代码发送给 Facebook 的 URL 是： [https ://graph.facebook.com/oauth/authorize?client_id=xxxx&redirect_uri=http://www.facebook.com/connect/login_success.html&type=user_agent&display=popup&scope=read_friendlists,user_photos ,friends_photos,user_photo_video_tags,friends_photo_video_tags,user_events,friends_events,user_groups,friends_groups](https://graph.facebook.com/oauth/authorize?client_id=xxxx&redirect_uri=http://www.facebook.com/connect/login_success.html&type=user_agent&display=popup&scope=read_friendlists,user_photos,friends_photos,user_photo_video_tags,friends_photo_video_tags,user_events,friends_events,user_groups,friends_groups)

阅读最新的 API 文档，他们似乎推荐了一种不同的连接方式，我们也尝试过： [https ://www.facebook.com/dialog/oauth?client_id=xxxx&redirect_uri=http://www.facebook.com/connect /login_success.html&scope=read_friendlists,user_photos,friends_photos,user_photo_video_tags,friends_photo_video_tags,user_events,friends_events,user_groups,friends_groups&response_type=token](https://www.facebook.com/dialog/oauth?client_id=xxxx&redirect_uri=http://www.facebook.com/connect/login_success.html&scope=read_friendlists,user_photos,friends_photos,user_photo_video_tags,friends_photo_video_tags,user_events,friends_events,user_groups,friends_groups&response_type=token)

为了排除我们的应用程序的原因，我们直接在 Web 浏览器中尝试了这些 URL。我们发现，当使用我的 Facebook 帐户时，浏览器会重定向到包含 access_token 参数的成功 URL，但是当使用我同事的帐户时，浏览器会重定向到包含 access_token 的成功 URL，然后立即再次重定向到没有 access_token 的成功 URL。

所以...据我们所知，这是：
a）我们无法在任何地方找到记录的 API 更改
b）Facebook 中的错误
c）现在由用户的 Facebook 安全设置控制的东西

有没有人可以解释为什么 Facebook 对不同帐户的行为不同，以及我们如何解决这个问题？

谢谢。
凯文。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-17T15:49:36.630

我的桌面应用程序也有同样的问题。我只是通过仔细阅读 ht*ps://developers.facebook.com/docs/howtos/login/login-for-desktop/ 来解决它。解决方案是将 redirect_uri 从 ht*p://www.facebook.com/... 更改为 ht*ps://www.facebook.com/...

希望这会像它帮助我一样帮助你

注意：

> > 将 ht*p 更改为 http 抱歉，我必须将 http 更改为 ht*p 以便我可以发布答案。

# iphone - 在 iPhone 上滚动时，底部固定的 div 一直在跳跃

> ID：15839174
> 
> 赞同：12
> 
> 时间：2013-04-05T16:41:26.437
> 
> 标签：iphone

我正在做一个响应式设计，我有一个应该固定在视口底部的 div 容器。问题是当我向上/向下滚动页面时 div 会继续移动，并且需要一段时间才能回到固定位置。

有谁知道如何解决这种跳跃问题？除了位置：固定和底部：0，我还能做什么？

谢谢！！:)

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2019-04-09T11:28:53.960

为我使用`position: sticky;`而不是`position: fixed;`解决 iOS 上的跳跃问题。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2015-03-03T10:37:33.807

你试过了吗：

`-webkit-backface-visibility: hidden; backface-visibility: hidden;`

或者可能

`-webkit-overflow-scrolling: touch`

希望这对你有帮助！

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2019-12-04T18:09:36.077

对于我当前的项目，我有一个位置固定的元素`<nav>`嵌套在一个`<header>`具有自己固定位置的元素中（语义上，嵌套 nav 的 DOM 树的标题是有意义的，但视觉上我们希望它们出现在不同的位置用户界面）。将导航移出标题，使其成为元素的直接子`<body>`元素，解决了问题。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2018-10-23T15:51:28.247

这里有一篇很棒的文章。就我而言，我在滚动 div 中有固定*元素*。一旦我把它放在外面，就不再紧张了。

[https://remysharp.com/2012/05/24/issues-with-position-fixed-scrolling-on-ios](https://remysharp.com/2012/05/24/issues-with-position-fixed-scrolling-on-ios)

# hl7 - CCD和HL7 V3 / V2

> ID：15839177
> 
> 赞同：8
> 
> 时间：2013-04-05T16:41:57.540
> 
> 标签：hl7, ccd

我的公司将成为 HIE，我们正在研究如何与其他系统交换我们的信息。我们位于美国，我看到当前的通用标准是 HL7 V2。Hl7 V3 不向后兼容 HL7 V2。这些是我们计划实施的交易：
o 出院总结
o 进度说明
o 实验室结果
o 程序/订单

整个事情很复杂，我正在尝试使用散布在网络中的零碎信息来弄清楚。所以这是我的问题：

1.  我们应该看看 HL7 V3 还是 V2 实现？
2.  CCD 和 HL7 V2 是否兼容？我从 HITSP 看到的大多数文档都在谈论 HL7 V3。
3.  我在哪里可以找到上述所有交易所需的数据字段的详尽列表？它是由 HITSP 定义的吗？
4.  为每个事务定义的字段是否会根据我们使用 HL7 V3 还是 V2 而改变？

任何帮助都感激不尽！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-04-05T18:17:24.177

如果您要成为 HIE，您将需要同时处理 HL7 v2 和 v3。我的经验是，几乎所有“现实生活”的数据传输都是 v2（我认为这可能是因为大多数能够传输 v3 的系统也允许 v2 格式化，而旧系统无法处理 v3，但这只是猜测）。[这里对 v2 和 v3 之间的核心差异进行](https://corepointhealth.com/wp-content/uploads/hl7-history-v2-v3.pdf)了非常肤浅的概述，其中谈到了除了格式（`delimited`vs `xml`）之外正在发生的根本变化

您问题的第二部分并没有真正的明确答案，并且与您的第四个问题相关。CCD*可以与*HL7v2 兼容，但要困难得多，并且依赖于发送方和接收方对许多问题的共同理解（hl7v2 是一个*非常松散*的“标准”）。以下是 HL7standard.com 对此主题的看法：

> 简短的回答是“是”，长的回答是“视情况而定”。
> 
> CDA/CCD 文件有不同级别。假设您有一个相当健壮的某种风格的 HL7 v2 报告（最有可能是 MDM 或 ORU 类型的消息），则可能可以从 HL7 v2 消息创建 Level-1 CDA 文档。
> 
> 获取 HL7 v2 消息并将其转换为 Level-2 或 Level-3 CDA 文档会更加困难。这些格式需要更多数据，并且这些数据需要结构化，而不仅仅是自由格式的文本。
> 
> CDA 基于 HL7 v3 RIM，兼容的 CDA 文档将遵循该数据模型。从一个数据模型映射到另一个数据模型可能具有挑战性。
> 
> 所有 CDA 文件都需要有责任方或“签署”文件的人员。至少，HL7 v2 消息必须具有此信息。
> 
> 将 CDA 文档转换为 HL7 v2 消息是可能的，但如果它是高度结构化的 Level-2 或 Level-3 文档，则可能会丢失原始文档中数据的“上下文”。如果 CDA 仅包含文本报告和一些患者人口统计信息，则可以将其转换为可比较的 v2 消息。

为了获得完整的字段列表，我只需要购买完整的 HL7 标准......也许可以看看[bluebuttonplus.org](http://bluebuttonplus.org) ......虽然请记住，v2 可能会导致一些混乱，因为消息子段并不总是在不同的演员之间始终如一地使用。无论如何，我认为您所问的大多数问题都没有*明确*的答案，但至少您确实需要处理这两种格式。我还想说明你可能想看看像[Mirth](http://www.mirthcorp.com/products/mirth-connect)或[InterfaceWare](http://www.interfaceware.com/)这样的产品来处理你的一些解析和测试。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-27T11:31:06.447

你肯定想看看[HL7.org](http://hl7.org)。HL7 标准现在免费提供，其中很大一部分是免费许可的。就 HL7 版本而言，2.5.1 似乎是 v2 空间的标准。如另一个答案中所述，您需要同时支持 V2 和 V3 HL7。

如果您正在寻找发送 CCD，请查看相同的 HL7 站点搜索 QRDA，即质量文档报告体系结构，一种用于传输 CDA 的 XML HL7 标准。

关于这方面的另外两个注意事项，您将需要查看目前正在与[ONC](http://www.healthit.gov/)进行的围绕 QRDA I 和 QRDA III 的新兴讨论，以及 CCDA 的修订标准。

我相信这是 HL7.org 上最新的 CDA 标准的直接链接 [HL7/ASTM CDA 版本 2 的实施指南 - 持续护理文件 (CCD®) 版本 1](http://www.hl7.org/implement/standards/product_brief.cfm?product_id=6)

最后，您需要与 Epic、Cerner 和 Meditech 等主要 EHR 参与者进行对话。他们需要支持您的解决方案，并可以指导您完成实施过程。除此之外，他们还需要知道如何最好地设置他们的系统以与您的系统交谈，以便他们可以指导他们的客户。没有这个，我担心你不会得到任何牵引力。

# cocoa - 是否有管理 iPhone 主页图标的框架？

> ID：15839182
> 
> 赞同：0
> 
> 时间：2013-04-05T16:42:10.297
> 
> 标签：cocoa, frameworks

是否有框架，或者有一些很好的教程可以帮助我使用 iOS 中的主页图标？我需要制作一个可以对我制作的所有应用程序进行分组的应用程序。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-05T20:05:20.523

Apple 不允许开发人员访问主屏幕、图标、图标位置或类似内容。除非您在越狱设备上谈论，否则无法按照您的要求进行操作。

# jquery - Django 美味派 XMLHttpRequest 无法加载

> ID：15839187
> 
> 赞同：0
> 
> 时间：2013-04-05T16:42:20.043
> 
> 标签：jquery, django, post, xmlhttprequest, tastypie

在过去的一个小时里，我一直在阅读有关 XMLHttpRequest 的内容，但我似乎可以完成这项工作。所以，我在另一个服务器/端口上有一个带有美味派的 django 服务器和一个 JavaScript 客户端，当我尝试做一个 jquery 帖子时，我得到

```
XMLHttpRequest cannot load http://127.0.0.1:8000/api/smart/rating/. Origin http://localhost is not allowed by Access-Control-Allow-Origin. 
```

我在客户端收到 Xmlthhprequest 错误消息

姜戈代码：

```
class RatingResource(ModelResource):
city = fields.ForeignKey(CityResource, 'city')
user = fields.ForeignKey(UserResource, 'user')
class Meta:
    queryset = Rating.objects.all()
    resource_name = 'rating'
    #authentication = BasicAuthentication()
    #authorization = DjangoAuthorization() 
```

我的 jquery 调用从 localhost:80 发布到 localhost:8000：

```
$('#star').raty({
  path: "../assets/img/",
  score    : rating,
  click : function(score, evt) {
      window.rate_app = score;
      var url = "http://127.0.0.1:8000/api/smart/rating/";
      //var comment = $('#textarea').val();
      var comment = "teste do php";
      console.log(cityId);  
      $.post(url,{city : '/api/smart/city/'+cityId+'/' ,comment : comment,id:'4',resource_uri:'/api/smart/rating/4/',rating : score, user: '/api/smart/auth/user/2/'},function(data,status){
          if (data=="error")
              console.log("error");
          else
              console.log("success");
      });

  }
}); 
```

更新：

HTTP/1.0 401 未经授权

```
curl --dump-header - -H "Content-Type: application/json" -X POST --data '{"city": "/api/smart/city/35/", "comment": "teste do php", "id": "4", "resource_uri": "/api/smart/rating/4/", "rating": "3","user_id": "/api/smart/auth/user/2/"}' `http://localhost:8000/api/smart/rating/`
HTTP/1.0 401 UNAUTHORIZED
Date: Mon, 08 Apr 2013 10:52:44 GMT
Server: WSGIServer/0.1 Python/2.7.3
Access-Control-Allow-Origin: *
Access-Control-Allow-Methods: POST,GET,OPTIONS,PUT,DELETE
Content-Type: text/html; charset=utf-8
Access-Control-Allow-Headers: Content-Type,*
Access-Control-Allow-Credentials: true 
```

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-05T18:20:35.533

嗨，我认为您本质上是在提出跨域请求。

要发起跨域请求，浏览器会发送带有 Origin HTTP 标头的请求。此标头的值是提供该页面的站点。

为了允许该请求，它会在其响应中发送一个 Access-Control-Allow-Origin 标头。标头的值指示允许哪些源站点。

```
Access-Control-Allow-Origin: localhost:80 
```

本质上，您需要在服务器端允许一个选项请求，该请求会发回 Access-Control-Allow-Origin 标头

请通过这个以获得更好的想法

[使用跨域资源共享的跨域 POST 查询没有返回数据](https://stackoverflow.com/questions/5251689/cross-domain-post-query-using-cross-origin-resource-sharing-getting-no-data-back)

# c++ - ClassName& 作为返回类型是什么意思？

> ID：15839188
> 
> 赞同：1
> 
> 时间：2013-04-05T16:42:20.293
> 
> 标签：c++, pointers, syntax, types, return-type

我尝试理解以下代码（取自[此处](http://ootips.org/yonat/4dev/smart-pointers.html)）：

```
template <class T> class auto_ptr
{
    T* ptr;
public:
    explicit auto_ptr(T* p = 0) : ptr(p) {}
    ~auto_ptr()                 {delete ptr;}
    T& operator*()              {return *ptr;} // <----- The problematic row.
    T* operator->()             {return ptr;}
    // ...
}; 
```

`T&`当我们用作函数的返回类型时，我无法理解我们的意思。如果`T`是指向整数（或任何其他类型）的指针，那么我将解释`T&`为整数（或任何其他相应类型）。但是在上面给出的代码`T`中不是指针。`T`是一个类，它的一个成员 ( `ptr`) 是一个指向这个类的对象的指针，但`T`不是一个指针类。那么，`T&`作为返回类型是什么意思呢？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-05T16:43:34.617

它与函数返回类型的上下文之外的含义相同，`T&`即*对*`T`. 在这种情况下，该函数返回一个类型对象的引用，`T`调用者可以使用该对象来观察（如果`T`不是`const`-qualified，还可以更改）被引用的对象。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-05T23:22:01.420

> T 是一个类，它的一个成员 (ptr) 是指向此类对象的指针，但 T 不是指针类。

`ptr`不是类的成员`T`。它是类的成员`auto_ptr<T>`。 `ptr` *是*指向 的指针`T`。但是，`T`它不是“指针类”（无论这意味着什么）这一事实并不能阻止某些东西成为指向 a 的指针`T`。

`std::string`是一类字符串，而不是指针。

`std::string str;`是类的对象`std::string`。

`&str`是地址`str`

```
std::string * ps = &str; 
```

是一个指向`std::string`.

从一开始：

`template <class T> class auto_ptr`是一个类模板，其唯一模板参数是`class T`. 您可以通过为某些实际类指定并声明结果类型的某些对象来*实例化模板：*`T`

```
auto_ptr<std::string> aps; 
```

这给了你另一个实际的类，“auto-pointer-to-string”，它就像：

```
class auto_ptr_to_string
{
    std::string * ptr;
public:
    explicit auto_ptr(std::string * p = 0) : ptr(p) {}
    ~auto_ptr()                 {delete ptr;}
    std::string & operator*()   {return *ptr;}
    std::string * operator->()  {return ptr;}
    // ...
}; 
```

并且`aps`是这样定义的对象。

该类有一个数据成员`ptr`，它是一个指向`std::string`.

该类还有一个运算符：

```
std::string & operator*()   {return *ptr;} 
```

该运算符定义了将“*”前缀应用于类型的对象所产生的行为`auto_ptr<std::string>`，例如`*aps`。

操作符的定义告诉你它返回一个对 an 的引用`std::string`，并且`std::string`这个引用所引用的是 `*ptr`，这意味着“数据成员所引用的那个`ptr`”。

所以：

```
auto_ptr<std::string> aps(new std::string("Get it?")); 
```

构造一个`auto_ptr<std::string>`被调用的，构造函数用指向动态分配的包含“Get it?”的指针`aps`初始化数据成员。`aps.ptr``std::string`

和：

```
std::string s = *aps; 
```

根据 的定义`auto_ptr<std::string>::operator*()`，声明一个`std::string` `s`并用`std::string` 引用的 by对其进行初始化`aps.ptr`，即包含“Get it?”的那个。

最后`class T`，模板参数的语法实际上并没有将它们的值限制为类：`auto_ptr<int>`例如，虽然`int`不是类类型，但它很好。我重申迈克西摩关于`auto_ptr`成为一个坏旧事物的评论。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-05T16:44:18.670

`T&`只是对 type的*引用*`T`。该函数返回对类对象的引用`T`。

# java - 在 Java 中，有没有办法格式化双精度/整数或非字符串变量的输出？

> ID：15839190
> 
> 赞同：1
> 
> 时间：2013-04-05T16:42:25.583
> 
> 标签：java, formatting

我意识到这听起来很简单，并且可能是......说这个 main() 中的代码，它位于循环内部：

```
System.out.println(num[i]+"\t     "+qty[i]+"\t     "+money.format(price[i])+"\t"+money.format(value[i])+"\t"+reorder[i]); 
```

此处捕获的总数：

[http://maradastudios.ucoz.com/school/Capture.png](http://maradastudios.ucoz.com/school/Capture.png)

您可能已经注意到，它工作正常。但是，在输出期间，#114 行（倒数第二行）的总价值为 90.00 美元。这是正确的，但它会导致 Reorder Point 变量出现奇怪的间距。简单地说，我可以格式化这个变量以占用与较大数字对应的相同数量的空间吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-05T16:44:42.590

就像是

```
String.format("%10.2f", yourFloat)
// or
System.out.format("%10.2f", yourFloat) 
```

将打印一个 10 字符宽（包括十进制）的字符串，小数点后有两个数字字符。

（[文档](http://docs.oracle.com/javase/7/docs/api/java/lang/String.html#format%28java.lang.String,%20java.lang.Object...%29)）

所以

```
String.format("$%6.2f", value[i]) 
```

将对齐`$`和`.`字符（除非`value[i] > 999.99`）。

* * *

代替：

```
System.out.println(
    num[i]                +"\t     "+
    qty[i]                +"\t     "+
    money.format(price[i])+"\t"+
    money.format(value[i])+"\t"+
    reorder[i]); 
```

（这正是你所拥有的，只是为了清晰起见并删除了滚动条）

我可能会写：

```
System.out.format("%5d\t %5d\t $%5.2f\t $%6.2f\t %5d %n", 
    num[i], qty[i], price[i], value[i], reorder[i]); 
```

这假设`price`and`value`数组是浮点数或双精度数。由于不是标准类，因此除了添加符号`money`之外，很难准确说出它的作用。`$`

* * *

文档中定义了字符串格式语法，但对于浮点数，它**大致**是：

```
%X.Yf 
```

其中`X`是总字段宽度，`Y`是小数点数

例如

```
"123.40"  Has a total width of 6:  
          3 + 1 [decimal point] + 2 = 6)
"  2.34"  Also has a total width of 6:
          2 [spaces] + 1 + 1 [decimal point] + 2 = 6 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-04-05T16:49:58.057

```
Formatter formatter = new Formatter();
    System.out.println(formatter.format("%20s %20s %20s %20s %20s", "Title*", "Title*", "Title*", "Title*", "Title*"));

    for (int i = 0; i < 10; i++) {
        formatter = new Formatter();

        System.out.println(formatter.format("%20s %20s %20s %20s %20s", num[i],qty[i],money.format(price[i]),money.format(value[i]),reorder[i]));
    } 
```

# php - 来自 1 个输入的 2 个值，PHP MySQL

> ID：15839192
> 
> 赞同：-1
> 
> 时间：2013-04-05T16:42:41.840
> 
> 标签：php, jquery, mysql, post, input

我正在为条形码票务系统构建验证器脚本。需要根据数据库检查条形码编号。问题是条形码的前 7 个数字是客户 ID，后 4 个数字是座位 ID。

例如：

```
12345671234
^^^^^^^--Customer ID
       ^^^^-- Seat ID 
```

由于我将使用条码扫描仪扫描条码并将整个条码写入单个输入框中，因此我需要在该 1 个输入中分离这两个值，以便从数据库中获取正确的数据。

它现在像：

```
<form action="validator.php" method="post">
Customer ID: <input id="uuid" name="uuid" maxlength="7"><br>
Seat:       <input id="hash" name="hash" maxlength="4"> 
```

需要像：

```
Barcode: <input id="barcode" name="barcode" maxlength="11"><input  type="submit">

<input  type="submit">
</form> 
```

和 PHP 端

```
<?php

$uuid = $_POST['uuid'];
$hash = $_POST['hash'];

    $con=mysqli_connect("localhost","admin","321","db_name");
    // Check connection
    if (mysqli_connect_errno())
      {
      echo "Failed to connect to MySQL: " . mysqli_connect_error();
      }

    $result = mysqli_query($con,"SELECT * FROM seat_booking_bookings
    WHERE uuid ='$uuid'");

    while($row = mysqli_fetch_array($result))
      {
      echo $row['customer_name'] . " " . $row['customer_phone'];
      echo "<br>";
      }

      $result = mysqli_query($con,"SELECT * FROM seat_booking_bookings_seats
    WHERE hash ='$hash'");

      while($row = mysqli_fetch_array($result))
      {
       echo "Seat:";
      echo $row['seat_id'] . " " . $row['price'];

      }
    ?> 
```

感谢你的帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-05T16:52:09.473

你可以试试这个

```
$uuid = substr($_POST['barcode'], 0,7);
$hash = substr($_POST['barcode'], 7,4); 
```

参考这个。[**PHP 子字符串**](http://php.net/manual/en/function.substr.php)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-05T16:51:29.603

```
$uuid = substr($_POST['barcode'], 0, 7);  
$hash = substr($_POST['barcode'], 7, 4); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-05T16:54:34.053

您只需要在查询中添加一个 AND 语句。您正在尝试基于两个值进行验证，对吗？

```
$result = mysqli_query($con,"SELECT * FROM seat_booking_bookings 
WHERE uuid ='{$uuid}' AND hash ='{$hash}'"); 
```

但是，为了防止 sql 注入，您应该首先转义您的值。所以这会更好：

```
$uuid = mysql_real_escape_string($uuid);
$hash = mysql_real_escape_string($hash);

$result = mysqli_query($con,"SELECT * FROM seat_booking_bookings 
WHERE uuid ='{$uuid}' AND hash ='{$hash}'"); 
```

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2013-04-05T16:48:35.770

```
$uuid = substr($_POST['barcode'],0,7);
$hash = substr($_POST['barcode'],7,4); 
```

我想这就是你要找的……

# asp.net - 联合身份验证和“加密操作期间发生错误”

> ID：15839196
> 
> 赞同：19
> 
> 时间：2013-04-05T16:42:45.120
> 
> 标签：asp.net, .net, federated-identity

当我尝试在 ASP.NET MVC 应用程序上获取我的主页时出现此异常。

> [CryptographicException：加密操作期间发生错误。]
> System.Web.Security.Cryptography.HomogenizingCryptoServiceWrapper.HomogenizeErrors(Func`2 func, Byte[] input) +246
> System.IdentityModel.Services.MachineKeyTransform.Decode(Byte[] 编码) +191
> System.IdentityModel.Tokens.SessionSecurityTokenHandler.ApplyTransforms(Byte[] cookie, Boolean outbound)
> +173 System.IdentityModel.Tokens.SessionSecurityTokenHandler.ReadToken(XmlReader reader, SecurityTokenResolver tokenResolver) +756
> System.IdentityModel.Tokens.SessionSecurityTokenHandler.ReadToken( Byte[] 令牌，SecurityTokenResolver tokenResolver) +100
> System.IdentityModel.Services.SessionAuthenticationModule.ReadSessionTokenFromCookie(Byte[] sessionCookie) +1164
> System.IdentityModel.Services.SessionAuthenticationModule.TryReadSessionTokenFromCookie(SessionSecurityToken& sessionToken) +287
> System.IdentityModel.Services.SessionAuthenticationModule.OnAuthenticateRequest(Object sender, EventArgs eventArgs) +231
> System.Web.SyncEventExecutionStep.System.Web.HttpApplication.IExecutionStep.Execute() +80 System.Web.HttpApplication.ExecuteStep(IExecutionStep step, Boolean& completedSynchronously) +165

据我了解，SessionAuthenticationModule 的 cookie 出现问题。如果您清除 cookie（如已[在 Azure 上的联合身份验证中](https://stackoverflow.com/questions/14119965/federated-authentication-on-azure)所述），它将起作用。我想了解发生了什么，如何捕获异常并解决问题。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2013-04-24T21:46:01.567

cookie 在发出时包含使用当前 machineKey 加密的安全令牌。当来自先前构建的 cookie 被发送回服务器时，SAM（更准确地说是令牌处理程序）尝试使用导致错误的 machineKey 的新值对其进行解密。检查我在相关帖子（[Azure 上的联合身份验证](https://stackoverflow.com/questions/14119965/federated-authentication-on-azure)）中的答案以减轻错误。高温高压

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2016-07-19T14:39:52.400

我遇到了同样的问题。我刚刚清除了所有**浏览器的 cookie**和**缓存数据**，它得到了修复。

# r - R - PNG有不想要的垂直线，情节没有

> ID：15839198
> 
> 赞同：2
> 
> 时间：2013-04-05T16:42:58.483
> 
> 标签：r, plot, png, cairo

我一直在为png写一个情节。该图在屏幕上显示得很好，但是当我对其进行 PNG 时，其中有一些随机的垂直线。

进一步说明 -

1.  我在 Windows 7 上，但使用“cairo-png”输出器。当我切换到“windows”输出器时，线条消失了，但背景不再透明。
2.  更改 png 的大小会更改线条出现的位置。

从 RStudio PNG ![从 RStudio PNG 导出](https://i.stack.imgur.com/hzyrl.png) 从 PNG 源导出： ![来自源的PNG](https://i.stack.imgur.com/bhlHQ.png)

* * *

具体代码：

```
png(file="RetirementRiskRecommendation.png", w=800,h=500,units="px",bg="transparent",family="Lato",type="cairo-png")
    par(mar=c(5,7.1,3,7.1),bty="n")
    barplot(t(as.matrix(other_aa[,-1])),space=0,border=NA,
            width=2,beside=FALSE,col=bmt_cols[c(1,8)],axes=FALSE,names.arg=rep("",length(other_times)))
    axis(1,at=xats,labels=xlabs,cex.axis=axis.cexer,las=1)
    axis(2,at=yats,labels=ylabs,cex.axis=axis.cexer,las=1)
    axis(4,at=yats,labels=ylabs,cex.axis=axis.cexer,las=1)
    #text(42,390000,label="Retirement (much more)",las=1,cex=text.cexer,pos=4,col=goal_cols[2])
    title(xlab="Time until goal",las=1,cex.lab=legend.cexer)
    title(main="General goal asset allocation over time",cex.main=legend.cexer, bty="n",col.main=bmt_cols[1],family="Lato")
    dev.off() 
```

* * *

# sockets - Chrome 挂起“发送请求”似乎与套接字相关

> ID：15839204
> 
> 赞同：7
> 
> 时间：2013-04-05T16:43:19.563
> 
> 标签：sockets, google-chrome

当我为我正在处理的一个相当大的应用程序加载 url 时，我会说每 3-4 次重新加载应用程序就会挂起并停止加载。Chrome 在左下角报告“正在发送请求”。我似乎无法识别它停止的任何文件，而是找到了这个线程：

[https://code.google.com/p/chromium/issues/detail?id=55046](https://code.google.com/p/chromium/issues/detail?id=55046)

这表明它可能是一个套接字问题。从此页面 (chrome://net-internals/#sockets) 刷新套接字会立即释放页面，并且一切都可以正常加载。这是来自该 chrome 内部页面的图像

![chrome内部套接字页面](https://i.stack.imgur.com/bPHOh.png)

我意识到这可能确实是一个 chrome 错误，但与此同时，我需要一个解决方法，因为用户在 chrome 中遇到了这个错误，并且无法加载应用程序。想法？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-14T23:45:24.820

我知道 2 个解决方法，但没有一个是完全方便的：

1.  禁用 SPDY：（`"...\chrome.exe" --use-spdy=off`不幸的是不能通过标志来完成）
2.  禁用同步（“设置 - 断开您的 Google 帐户”）

另一种选择是减少应用程序中的连接数量（为所有客户端-服务器通信提供来自 1 个域的所有静态内容 + 1 个 websocket 连接），并在可能的情况下删除小部件（保持持久连接的 twitter、disqus 等），这可能或者可能无助于考虑在所有 Chrome 选项卡之间共享套接字池:(

就我个人而言，这个错误自 Chrome 21 以来发生在随机网站上，并且在某种程度上被重置池的崩溃所抵消:)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-07-25T10:39:12.503

在您对正在重定向的图像提出建议并使用**Fiddler2 之后**，我发现我在图像中也有很多重定向。在我的例子中，我在**ASP.NET MVC**中有一个重写规则，它将我们的 URL 小写。我们的项目文件夹也是如此，在这种情况下，包含图像的文件夹，例如`URL/Images/OurLogo.png`成为`url/images/ourlogo.png`.

更改我们的重写规则以在条件标记中包含以下行，解决了该问题：

```
<add input="{REQUEST_FILENAME}" matchType="IsFile" negate="true" /> 
```

完整重写规则供参考：

```
<rule name="Convert to lower case" stopProcessing="true">
  <match url=".*[A-Z].*" ignoreCase="false" />
  <conditions>
    <add input="{REQUEST_METHOD}" matchType="Pattern" pattern="GET" ignoreCase="false" />
    <add input="{REQUEST_FILENAME}" matchType="IsFile" negate="true" />
  </conditions>
  <action type="Redirect" url="{ToLower:{R:0}}" redirectType="Permanent" />
</rule> 
```

# javascript - 拉斐尔饼图上的点击事件

> ID：15839210
> 
> 赞同：0
> 
> 时间：2013-04-05T16:43:35.557
> 
> 标签：javascript, jquery, raphael, pie-chart

我有多个饼图，我将它们放在一个数组中：

```
var pie_array = new Array(); 
```

创建饼图，如：

```
for loop{
      pie = r.piechart(48+i*120,40,30,[100],
      {
          colors: ["white"],
          maxSlices: 1
      });
} 
```

现在我将点击事件添加到每个饼图：

```
 $.each(pie_array, function(i, p){
        $(p).click(function(){
            alert(p);
        });
    }); 
```

但是当我单击饼图时无法触发事件......任何解决方案？

可能重复： [如何将 jquery 点击事件添加到 gRaphael 图形？](https://stackoverflow.com/questions/9767709/how-to-add-jquery-click-event-to-graphael-graphics)

和

[如何将 click evet 添加到我的 rapahel 饼图？](https://stackoverflow.com/questions/6013801/how-can-i-add-click-evet-to-my-rapahel-pie-chart)

但没有一个解决方案有效

我什至用过：

```
 //below one says click event on unknown element..I printed p and it raphael set
 $.each(pie_array, function(i, p){
        p.click(function(){
            alert(p);
        });
    }); 

and

$.each(pie_array, function(i, p){
        p.node.oclick = function(){
            alert(p);
        };
    }); 
```

但没有进展

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-05T18:45:31.943

看起来您没有将创建的饼图添加到数组中。

# c# - 从非按钮元素触发点击

> ID：15839212
> 
> 赞同：0
> 
> 时间：2013-04-05T16:43:42.297
> 
> 标签：c#, javascript, awesomium

嗨，我在 WPF/C# 中编程并使用 awesomium WebControl

我试图点击这个：

```
<li class="playlist-item-favorite" data-title="Ulubione" data-is-private="False">
      <a href="javascript: void(0);">
        <span class="playlist-title">
          Ulubione

          <span class="playlist-video-count-container">
            (<span class="playlist-video-count">1</span>)
          </span>
        </span>

        <span class="playlist-public-private">
Publiczny
        </span>
      </a>
    </li> 
```

我的代码 C#：

```
 dynamic lists = (JSObject)Browser.ExecuteJavascriptWithResult("document.getElementsByClassName('playlist-item-favorite')");

            if (lists == null)
                return;

        length = lists.length;
        if (length == 0)
            return;

        using (lists)
        {
            using (JSObject obiekt = lists.Invoke("item", 0))
                obiekt.InvokeAsync("click");
        }
    } 
```

我知道我找到了这个对象，当我得到属性时它没问题，但是点击不工作。

我展示了这个对象的方法，没有像 click 或 onclick 这样的方法。方法：

```
insertAdjacentHTML
insertAdjacentText
insertAdjacentElement
getAttribute
setAttribute
removeAttribute
getAttributeNode
getElementsByTagName
getAttributeNS
setAttributeNS
removeAttributeNS
getElementsByTagNameNS
getAttributeNodeNS
hasAttribute
hasAttributeNS
focus
blur
scrollIntoView
scrollIntoViewIfNeeded
scrollByLines
scrollByPages
getElementsByClassName
querySelector
querySelectorAll
webkitMatchesSelector
getClientRects
getBoundingClientRect
setAttributeNode
removeAttributeNode
setAttributeNodeNS
webkitRequestFullScreen
insertBefore
replaceChild
removeChild
appendChild
hasChildNodes
cloneNode
normalize
isSupported
hasAttributes
lookupPrefix
isDefaultNamespace
lookupNamespaceURI
addEventListener
removeEventListener
isSameNode
isEqualNode
compareDocumentPosition
contains
dispatchEvent 
```

你能帮助我吗？

@Edit我为javascript找到了这个： [从非按钮元素触发按钮点击](https://stackoverflow.com/questions/6367339/trigger-a-button-click-from-a-non-button-element) 但我不能在我的应用程序中使用它。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-05T17:47:15.003

在网页随附的 Javascript 中的某处将有一个绑定到该`<a>`元素的点击事件的函数 - 找到它是什么，然后直接调用它。如果有问题的函数引用了该`self`对象，则需要获取对该函数的引用并`call`在其上调用方法，将锚元素作为第一个参数传递。

另一种选择——你想要做的——可能更复杂。锚元素实际上没有`clicked()`功能，而是您需要[手动创建一个事件](https://stackoverflow.com/a/10829898/252309)。

# css - 站点地图的浮动 div 请看图片

> ID：15839220
> 
> 赞同：0
> 
> 时间：2013-04-05T16:44:15.247
> 
> 标签：css, html, css-float

这就是我所拥有的： ![这就是我所拥有的](https://i.stack.imgur.com/CP6nh.jpg)

这就是我要的 ![在此处输入图像描述](https://i.stack.imgur.com/lsSgH.jpg)

我怎样才能做到这一点？

```
<style type="text/css">
    .sitemap {
        width:560px;
    }
    .sitemap .nav-box {
        float:left;
        width:170px;
        margin-right:15px;
        margin-bottom:20px;
    }
    .sitemap .nav-box span,
    .sitemap .nav-box a {
        display:block;
        border-bottom:1px solid #434343;
    }
    .sitemap .nav-box span {
        color:gray;
        font-size:14px;
        text-transform:uppercase;
        border-bottom:1px solid #434343;
        line-height:20px;
        padding-bottom:3px;
    }
    .sitemap .nav-box a {
        padding:3px 0;
    }
</style>

<div class="sitemap">
    <h3>Sitemap</h3>
    <div class="nav-box">
        <span>Hotels & Apartments</span>
        <a href="#">Alle Hotels</a>
        <a href="#">5 *****</a>
        <a href="#">4 ****</a>
        <a href="#">3 ***</a>
        <a href="#">2 **</a>
        <a href="#">Apartments</a>
    </div>
    <div class="nav-box">
        <span>Ferien-Wohnungen</span>
        <a href="#">Mieten</a>
        <a href="#">Kaufen</a>
    </div>
    <div class="nav-box">
        <span>Dining & Nightlife</span>
        <a href="#">Gault Millau</a>
        <a href="#">Walliser Spezialitäten</a>
        <a href="#">Pasta & Pizza</a>
        <a href="#">Asian</a>
        <a href="#">Bergrestaurant</a>
        <a href="#">Caffe & Bars</a>
        <a href="#">Clubs & Après Ski</a>

    </div>
    <div class="nav-box">
        <span>Shopping & Lifestyle</span>
        <a href="#">Bijouterie</a>
        <a href="#">Fashion</a>
        <a href="#">Sportgeschäfte</a>
        <a href="#">Food & Beverage</a>
        <a href="#">Apotheken</a>
        <a href="#">Spa & Wellness</a>
        <a href="#">Massagen</a>
    </div>
    <div class="nav-box">
        <span>Sports & Adventures</span>
        <a href="#">Skipisten (Pistenbericht)</a>
        <a href="#">Ski & Snowboard-Schulen</a>
        <a href="#">Ski & Bergtouren</a>
        <a href="#">Heliskiing</a>
        <a href="#">Paragliding</a>
        <a href="#">Indoor Klettern</a>
        <a href="#">Curling</a>
    </div>
    <div class="nav-box">
        <span>Kultur & Events</span>
        <a href="#">Kulturelles</a>
        <a href="#">Eventkalender</a>
    </div>
    <div class="clear"></div>
</div> 
```

当然还有一个小提琴[http://jsfiddle.net/caramba/rYkxQ/](http://jsfiddle.net/caramba/rYkxQ/)

谢谢你的帮助！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-05T16:52:56.397

您可以尝试只制作带有几个块的树导航 div。这段代码对我有用（当然最好做细分）：

```
<div class="sitemap">
<h3>Sitemap</h3>
<div class="nav-box">
    <span>Hotels & Apartments</span>
    <a href="#">Alle Hotels</a>
    <a href="#">5 *****</a>
    <a href="#">4 ****</a>
    <a href="#">3 ***</a>
    <a href="#">2 **</a>
    <a href="#">Apartments</a>
    <span>Shopping & Lifestyle</span>
    <a href="#">Bijouterie</a>
    <a href="#">Fashion</a>
    <a href="#">Sportgeschäfte</a>
    <a href="#">Food & Beverage</a>
    <a href="#">Apotheken</a>
    <a href="#">Spa & Wellness</a>
    <a href="#">Massagen</a>
</div>
<div class="nav-box">
    <span>Ferien-Wohnungen</span>
    <a href="#">Mieten</a>
    <a href="#">Kaufen</a>
    <span>Sports & Adventures</span>
    <a href="#">Skipisten (Pistenbericht)</a>
    <a href="#">Ski & Snowboard-Schulen</a>
    <a href="#">Ski & Bergtouren</a>
    <a href="#">Heliskiing</a>
    <a href="#">Paragliding</a>
    <a href="#">Indoor Klettern</a>
    <a href="#">Curling</a>
</div>
<div class="nav-box">
    <span>Dining & Nightlife</span>
    <a href="#">Gault Millau</a>
    <a href="#">Walliser Spezialitäten</a>
    <a href="#">Pasta & Pizza</a>
    <a href="#">Asian</a>
    <a href="#">Bergrestaurant</a>
    <a href="#">Caffe & Bars</a>
    <a href="#">Clubs & Après Ski</a>
    <span>Kultur & Events</span>
    <a href="#">Kulturelles</a>
    <a href="#">Eventkalender</a>

</div>
<div class="clear"></div> 
```

# java - java.awt.image.DataBufferByte 不能转换为 java.awt.image.DataBufferInt

> ID：15839223
> 
> 赞同：7
> 
> 时间：2013-04-05T16:44:24.730
> 
> 标签：java, image, swing, awt, java-canvas

我在使用 JAVA 编码时遇到了一些错误，我一直在尝试解决这个问题，也试图找到有同样问题的其他人并修复它但没有任何效果......

嗯..这是代码

```
 package ca.vanzeben.game;

import java.awt.BorderLayout;
import java.awt.Canvas;
import java.awt.Color;
import java.awt.Dimension;
import java.awt.Graphics;
import java.awt.image.BufferStrategy;
import java.awt.image.BufferedImage;
import java.awt.image.DataBufferInt;

import javax.swing.JFrame;

public class Game extends Canvas implements Runnable {

    private static final long serialVerisionUID = 1L;

    public static final int WIDTH = 160;
    public static final int HEIGHT = WIDTH / 12*9;
    public static final int SCALE = 3;
    public static final String NAME = "Game";

    public boolean running = false;
    public int tickCount = 0;

    private JFrame frame;

    private BufferedImage image = new BufferedImage(WIDTH, HEIGHT, BufferedImage.TYPE_3BYTE_BGR);
    private int[] pixels = ((DataBufferInt)image.getRaster().getDataBuffer()).getData();

    public Game(){
        setMinimumSize(new Dimension(WIDTH*SCALE, HEIGHT * SCALE));
        setMaximumSize(new Dimension(WIDTH*SCALE, HEIGHT * SCALE));
        setPreferredSize(new Dimension(WIDTH*SCALE, HEIGHT * SCALE));

        frame = new JFrame(NAME);

        frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
        frame.setLayout(new BorderLayout());

        frame.add(this, BorderLayout.CENTER);
        frame.pack();

        frame.setResizable(false);
        frame.setLocationRelativeTo(null);
        frame.setVisible(true);
    }

    public synchronized void start() {
        running = true;
        new Thread(this).start();
    }

    public synchronized void stop() {
        running = false;

    }

    public void run(){
        long lastTime = System.nanoTime();
        double nsPerTick = 1000000000D/60D;

        int ticks = 0;
        int frames = 0;

        long lastTimer = System.currentTimeMillis();
        double delta = 0;

        while(running){
            long now = System.nanoTime();
            delta +=(now - lastTime) / nsPerTick;
            lastTime = now;
            boolean shouldRender = true;

            while(delta >= 1){
                ticks++;
                tick();
                delta -= 1;
                shouldRender = true;
            }
            try {
                Thread.sleep(2);
            } catch (InterruptedException e) {
                e.printStackTrace();
            }
            if (shouldRender){
                frames++;
                render();
            }

            if(System.currentTimeMillis() - lastTimer >= 1000){
                lastTimer += 1000;
                System.out.println(ticks + " ticks, " + frames + " frames");
                frames = 0;
                ticks = 0;
            }
        }
    }

    public void tick() {
        tickCount++;
    }

    public void render(){
        BufferStrategy bs = getBufferStrategy();
        if(bs == null)  {
            createBufferStrategy(3);
            return;
        }

        Graphics g = bs.getDrawGraphics();

        g.setColor(Color.black);
        g.fillRect(0, 0, getWidth(), getHeight());

        g.dispose();
        bs.show();
    }

    public static void main(String[] args) {
        new Game().start();
    }   
} 
```

错误是：

```
 Exception in thread "main" java.lang.ClassCastException: java.awt.image.DataBufferByte           cannot be cast to java.awt.image.DataBufferInt
at ca.vanzeben.game.Game.<init>(Game.java:30)
at ca.vanzeben.game.Game.main(Game.java:122) 
```

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-09-06T21:43:44.080

要解决您的问题，您需要更改 BufferedImage 类型

```
private BufferedImage image = new BufferedImage(WIDTH, HEIGHT,  
BufferedImage.TYPE_3BYTE_BGR); 
```

并将其更改为

```
private BufferedImage image = new BufferedImage(WIDTH, HEIGHT, BufferedImage.TYPE_INT_RGB); 
```

问题是`BufferedImage.TYPE_3BYTE_BGR`使用 byte[3] 来表示每个像素并且 `BufferedImage.TYPE_INT_RGB`只使用一个 int

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-04-16T00:59:00.827

问题是`image.getRaster().getDataBuffer()`返回一个 DataBufferByte，而您正试图转换为 DataBufferInt。这是两个不同的类，都是 DataBuffer 的子类，但一个不是另一个的子类，因此它们之间的转换是不可能的。

Raster 的规范没有明确描述是什么决定了 getDataBuffer 返回 DataBufferByte 还是 DataBufferInt（或者可能是其他一些 DataBuffer 风格）。但大概这取决于被解剖的图像类型。您可能正在剖析每像素字节的图像，而代码，就目前而言，需要每像素 32 位。

实际上，您可能需要从该`<init>`部分中删除一些该逻辑并将其添加到显式构造函数中，以便您可以测试返回的 DataBuffer 的类型并相应地处理它，而不是无条件地将其强制转换为 DataBufferInt。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2020-10-05T22:41:33.600

`image.getRaster().getDataBuffer().getDataType()`从类中传递一个类型常量`DataBuffer`，例如`TYPE_BYTE, TYPE_SHORT, TYPE_INT`，每个都绑定一个唯一的`DataBuffer[Type]`子类`DataBuffer`。因此，您可以检测类型化缓冲区强制转换是否会成功。

int 和 byte[4] 之间的转换基本上取决于字节顺序规则，该规则未在 Java 内部类型级别上定义，因此无法很好地定义此类数组的重新解释转换。

如果您不是公认答案假定的图像的发起者，则需要定义和应用类型转换。

**EDIT**
`DataInputStream.readInt`实际上使用了定义的转换：Big-endianness

`byte[]`从to 的转换`int[]`可以通过从作为源的 a 中读取整数来执行`DataInputStream`，`ByteArrayInputStream`并使用字节数组进行初始化。

# data-structures - 纯功能映射和集合的统计性能

> ID：15839227
> 
> 赞同：75
> 
> 时间：2013-04-05T16:44:33.373
> 
> 标签：data-structures, functional-programming, statistics, avl-tree, red-black-tree

给定一个数据结构规范，例如具有已知复杂性界限的纯功能映射，必须在几种实现之间进行选择。关于如何选择正确的树有一些民间传说，例如红黑树通常被认为更快，但 AVL 树在具有许多查找的工作负载上具有更好的性能。

1.  是否对这些知识（与集合/地图相关）进行了系统的介绍（已发表的论文）？理想情况下，我希望看到对实际软件进行的统计分析。例如，它可能会得出结论，有 N 种典型的地图使用类型，并列出每种类型的输入概率分布。

2.  是否有系统的基准测试可以在不同的输入分布上测试地图和设置性能？

3.  是否有使用自适应算法根据实际使用情况更改表示的实现？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-11-27T17:22:54.053

这些基本上都是研究课题，结果一般以结论的形式给出，而统计数据是隐藏的。不过，可以对自己的数据进行统计分析。

对于基准，最好通过实施细节。

第三部分的问题是一个非常主观的问题，实际意图在执行时可能永远不会知道。然而，像 perl 这样的语言尽最大努力为每个操作实现高度优化的解决方案。

以下可能会有所帮助：Chris Okasaki 的纯功能数据结构 [http://www.cs.cmu.edu/~rwh/theses/okasaki.pdf](http://www.cs.cmu.edu/~rwh/theses/okasaki.pdf)

# java - 广度优先搜索算法陷入无限循环

> ID：15839230
> 
> 赞同：0
> 
> 时间：2013-04-05T16:44:48.890
> 
> 标签：java, algorithm, state, breadth-first-search

```
I am trying to implement a Breadth First Search algorithm for 8puzzle. I am somehow not able to get in the `is(RequiredState(see))` condition where my search terminates. My program gets stuck in an infinite loop. I have put the repeating states in a state to prevent getting stuck in a loop, but somehow my program still gets stuck in a loop.

board.java

        public class board {
            public
                int[] square = new int[9];
            board()
            {
                for(int i=0;i<9;i++)
                {
                    square[i]=8-i;
                    square[8] = 0;

                }
            }
            int findBlankPos()
            {
                for(int i=0;i<square.length;i++)
                {
                    if(square[i]==0)
                    {
                        return i;
                    }
                }
                return 9;
            }
            static int size()
            {
                return 9;
            }
            void moveBlankUp(int blankpos)
            {
                square[blankpos] = square[blankpos-3];
                square[blankpos-3] = 0;
            }
            void moveBlankDown(int blankpos)
            {
                square[blankpos] = square[blankpos+3];
                square[blankpos+3] = 0;
            }
            void moveBlankRight(int blankpos)
            {
                square[blankpos] = square[blankpos+1];
                square[blankpos+1] = 0;
            }
            void moveBlankLeft(int blankpos)
            {
                square[blankpos] = square[blankpos-1];
                square[blankpos-1] = 0;
            }
            boolean canMoveUp(int blankpos)
            {
                if((blankpos==0)||(blankpos==1)||(blankpos==2))
                    return false;
                else
                    return true;
            }
            boolean canMoveDown(int blankpos)
            {
                if((blankpos==6)||(blankpos==7)||(blankpos==8))
                    return false;
                else
                    return true;
            }
            boolean canMoveRight(int blankpos)
            {
                if((blankpos==2)||(blankpos==5)||(blankpos==8))
                    return false;
                else
                    return true;
            }
            boolean canMoveLeft(int blankpos)
            {
                if((blankpos==0)||(blankpos==3)||(blankpos==6))
                    return false;
                else
                    return true;
            }
            void display()
            {
                for(int i=0;i<square.length;i++)
                {
                    if((i)%3==0)
                    {
                        System.out.println();
                    }
                    System.out.print(square[i] + " ");
                }
            }
            Integer getAt(int pos)
            {
                return square[pos];
            }
            void setAt(int pos,int value)
            {
                square[pos] = value;
            }
        }

puzzle.java

    import java.awt.List;
    import java.util.HashSet;
    import java.util.LinkedList;
    import java.util.Queue;
    import java.util.Set;

    public class puzzle {
        public static void main(String[] args)
        {
            board b = new board();
            Set<board> set = new HashSet<board>();
            b.display();
            Queue<board> queue = new LinkedList<board>();
            queue.add(b);
            /*b.setAt(4,0);
            b.setAt(8,4);
            b.display();
            System.out.println();
            AddChildrentoQueue(queue,b);*/

            //System.out.println(queue.);
            int itr=0;
            while(!queue.isEmpty())
            {
                itr++;
                System.out.println(itr);
                board see = queue.peek();
                //System.out.println(count);
                if(!(set.contains(see)))
                {
                    set.add(see);
                    //see.display();
                    //System.out.println();
                    if(isRequiredState(see))
                    {
                        queue.peek().display();
                        System.out.println("End it with a Bang");
                        break;
                    }
                        AddChildrentoQueue(queue,queue.peek());
                        //System.out.println(queue.size());
                        if(itr==1)
                            break;

                }
                queue.remove();
            }
            //System.out.println(isRequiredState(b));

        }

        private static boolean isRequiredState(board peek) {
            // TODO Auto-generated method stub
            String state="";
            for(int i=0;i<peek.size();i++)
            {
                String temp = (String)peek.getAt(i).toString();
                //System.out.println(temp);
                state = state + temp;
            }
            //System.out.println(state);
            if(state.equals("123456780"))
            {
                return true;
            }
            return false;
        }

        private static void AddChildrentoQueue(Queue<board> queue, board b) {
            // TODO Auto-generated method stub
            board d;
            if(b.canMoveUp(b.findBlankPos()))
            {
                d = getClone(b);
                d.moveBlankUp(b.findBlankPos());
                d.display();
                System.out.println();
                queue.add(d);
            }
            if(b.canMoveDown(b.findBlankPos()))
            {
                d = getClone(b);
                d.moveBlankDown(b.findBlankPos());
                d.display();
                System.out.println();
                queue.add(d);
            }
            if(b.canMoveRight(b.findBlankPos()))
            {
                d = getClone(b);
                d.moveBlankRight(b.findBlankPos());
                d.display();
                System.out.println();
                queue.add(d);
            }
            if(b.canMoveLeft(b.findBlankPos()))
            {
                d = getClone(b);
                d.moveBlankLeft(b.findBlankPos());
                d.display();
                System.out.println();
                queue.add(d);
            }

        }
        static board getClone(board b)
        {
            board c = new board();
            for(int i=0;i<c.size();i++)
            {
                c.setAt(i,b.getAt(i));
            }
            return c;
        }

    } 
```

所以这就是我最终解决问题的方式。当我处理这个问题时，我发现当我比较检查的元素是否在集合中时，它实际上比较的是地址值而不是所需的对象，并且这就是为什么我无法摆脱无限循环的原因，因为每次生成一个新地址时。因此，我没有使用一组比较对象，而是创建了一组字符串来比较存储为字符串的对象的配置并放入一套。非常感谢你让我找到问题guyz ..干杯！！！

```
import java.awt.List;
import java.util.HashSet;
import java.util.LinkedList;
import java.util.Queue;
import java.util.Set;

public class puzzle {
    public static void main(String[] args)
    {
        board b = new board();
        Set<String> set = new HashSet<String>();
        b.display();
        Queue<board> queue = new LinkedList<board>();
        queue.add(b);
        /*b.setAt(4,0);
        b.setAt(8,4);
        b.display();
        System.out.println();
        AddChildrentoQueue(queue,b);*/

        //System.out.println(queue.);
        //int itr=0;
        while(!queue.isEmpty())
        {
            //itr++;
            board see = queue.peek();
            String check = getSequence(queue.peek());
            //System.out.println(itr);
            //System.out.println(check);
            if(!(set.contains(check)))
            {
                set.add(check);
                //see.display();
                //System.out.println();
                if(isRequiredState(see))
                {
                    queue.peek().display();
                    System.out.println("End it with a Bang");
                    break;
                }
                    AddChildrentoQueue(queue,queue.peek());
                    //System.out.println(queue.size());
            }
            queue.remove();
        }
        //System.out.println(isRequiredState(b));

    }

    private static boolean isRequiredState(board peek) {
        // TODO Auto-generated method stub
        String state = getSequence(peek);
        //System.out.println(state);
        if(state.equals("123456780"))
        {
            return true;
        }
        return false;
    }

    private static String getSequence(board peek) {
        // TODO Auto-generated method stub
        String state="";
        for(int i=0;i<peek.size();i++)
        {
            String temp = (String)peek.getAt(i).toString();
            //System.out.println(temp);
            state = state + temp;
        }
        return state;
    }

    private static void AddChildrentoQueue(Queue<board> queue, board b) {
        // TODO Auto-generated method stub
        board d;
        if(b.canMoveUp(b.findBlankPos()))
        {
            d = getClone(b);
            d.moveBlankUp(b.findBlankPos());
            d.display();
            System.out.println();
            queue.add(d);
        }
        if(b.canMoveDown(b.findBlankPos()))
        {
            d = getClone(b);
            d.moveBlankDown(b.findBlankPos());
            d.display();
            System.out.println();
            queue.add(d);
        }
        if(b.canMoveRight(b.findBlankPos()))
        {
            d = getClone(b);
            d.moveBlankRight(b.findBlankPos());
            d.display();
            System.out.println();
            queue.add(d);
        }
        if(b.canMoveLeft(b.findBlankPos()))
        {
            d = getClone(b);
            d.moveBlankLeft(b.findBlankPos());
            d.display();
            System.out.println();
            queue.add(d);
        }

    }
    static board getClone(board b)
    {
        board c = new board();
        for(int i=0;i<c.size();i++)
        {
            c.setAt(i,b.getAt(i));
        }
        return c;
    }

} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-05T20:19:22.597

在评论中指出了使用散列数据结构而不实现与 a`hashCode()`一致的问题`equals()`，所以这里有一个建议您可以用作 a `hashCode()`：将板的单元格视为数字，其中 0 <= i <= 8 from左上角到右下角。

```
@Override
public int hashCode() {
    int hashCode = 0;

    for(int i = 0; i < square.size; i++) {
        hashcode += (square[i] << (3 + i % 2)*i);
    }
} 
```

您最终会得到一个`int`有点粗略的结果，但仍然明智地从与您的关注点相关的电路板状态中得出，并且肯定与`equals()`检查被比较的两个电路板的所有单元格是否保持相同值一致。确保如果你实现`equals()`and `hashCode()`，你会始终如一地执行它，这大致意味着

`A.equals(B) -> A.hashCode() == B.hashCode()`

`->`逻辑含义在哪里。

# ssh - Jenkins SSH 插件 - 更改文件集的基本目录（默认为工作区。）

> ID：15839236
> 
> 赞同：2
> 
> 时间：2013-04-05T16:45:39.087
> 
> 标签：ssh, jenkins

在使用 Jenkins SSH 插件时，我需要找到一种方法来更改文件集的基本目录 - 默认情况下，基本目录是工作区。有没有办法做到这一点

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-05T20:12:03.517

如果您使用[https://wiki.jenkins-ci.org/display/JENKINS/Publish+Over+SSH+Plugin](https://wiki.jenkins-ci.org/display/JENKINS/Publish+Over+SSH+Plugin)，您可以通过对工作区中的任何目录使用“删除前缀”来实现此目的。

如果您想传输工作区之外的数据，您可能应该描述您想要实现的目标 - 可能还有其他解决方案。最简单的解决方案可能是使用构建步骤将文件复制到您的工作区。

# java - 错误：SPAN_EXCLUSIVE_EXCLUSIVE 跨度的长度不能为零

> ID：15839237
> 
> 赞同：10
> 
> 时间：2013-04-05T16:45:42.067
> 
> 标签：java, android, button, html, oncreate

我的安卓应用有问题。我有一个按钮和事件关联，但是当我第一次单击时出现错误

> “跨度不能有零长度”。

. 但是当我第二次单击时，事件 onclick 运行良好.. 看看我的 java 代码：

```
public class MainActivity extends Activity {
@Override
protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_main);

    final Button selectAltitude = (Button) findViewById(R.id.buttonAltitude1);
    final Button selectAltitude2 = (Button) findViewById(R.id.buttonAltitude2); 

    selectAltitude2.setOnClickListener(new View.OnClickListener() {
        public void onClick(View view){

                String tempAlt = selectAltitude2.getText().toString();
                selectAltitude2.setText(selectAltitude.getText().toString());
                selectAltitude.setText(tempAlt);
        }
    });
    } 
```

带有两个按钮的 xml 代码（出现不推荐使用的警告）：

```
 <?xml version="1.0" encoding="utf-8"?> 
<AbsoluteLayout
  xmlns:android="http://schemas.android.com/apk/res/android" 
  android:orientation="vertical" 
  android:layout_width="fill_parent" 
  android:layout_height="fill_parent"
  android:background="@android:color/black"> 

<Button
        android:id="@+id/buttonAltitude1"
        style="?android:attr/buttonBarButtonStyle"
        android:layout_width="39dp"
        android:layout_height="42dp"
        android:layout_marginLeft="250dp"
        android:layout_x="257dp"
        android:layout_y="419dp"
        android:background="@drawable/drawable1"
        android:focusableInTouchMode="true"
        android:gravity="center_vertical"
        android:includeFontPadding="false"
        android:linksClickable="true"
        android:minHeight="10dp"
        android:minWidth="64dp"
        android:paddingLeft="10dp"
        android:paddingRight="5dp"
        android:scrollHorizontally="true"
        android:text="@string/button_meters"
        android:textColor="@android:color/black"
        android:textSize="22sp"
        android:textStyle="bold" />

        <Button
            android:id="@+id/buttonAltitude2"
            style="?android:attr/buttonBarButtonStyle"
            android:layout_width="65dp"
            android:layout_height="42dp"
            android:layout_marginLeft="250dp"
            android:layout_x="295dp"
            android:layout_y="419dp"
            android:background="@drawable/drawable2"
            android:clickable="true"
            android:focusableInTouchMode="true"
            android:gravity="center_vertical"
            android:includeFontPadding="false"
            android:linksClickable="true"
            android:minHeight="10dp"
            android:minWidth="64dp"
            android:paddingLeft="15dp"
            android:paddingRight="5dp"
            android:scrollHorizontally="true"
            android:text="@string/button_feet"
            android:textColor="@android:color/black"
            android:textSize="25sp"
            android:textStyle="bold" /> 
```

当我第一次单击 Log cat 交互时：

> 04-06 20:01:39.865：I/传感器（6946）：sendDelay --- 200000000 04-06
> 
> 20:01:39.865:D/SensorManager(6946):JNI-sendDelay 04-06
> 
> 20:01:39.865：I/SensorManager(6946)：设置正常延迟 = true 04-06
> 
> 20:01:39.890：E/SpannableStringBuilder（6946）：SPAN_EXCLUSIVE_EXCLUSIVE
> 
> 跨度不能有零长度 04-06 20:01:39.890:
> 
> E/SpannableStringBuilder(6946)：SPAN_EXCLUSIVE_EXCLUSIVE 跨度不能
> 
> 长度为零

你能帮忙吗？；）

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2013-04-05T16:51:23.057

我在 LogCat 中遇到了相同的错误条目。就我而言，这是由我正在使用的第 3 方键盘引起的。当我将其更改回 Android 键盘时，错误条目不再显示。

这是此问题的最可能原因，因为 SwiftKey 也有错误报告：

[http://support.swiftkey.net/forums/116693-2-bug-reports/suggestions/2994580-span-exclusive-exclusive-spans-cannot-have-a-zero-](http://support.swiftkey.net/forums/116693-2-bug-reports/suggestions/2994580-span-exclusive-exclusive-spans-cannot-have-a-zero-)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-07-08T15:01:25.727

要尝试调试此错误，请首先转到您的 android 终端/控制台并执行以下命令：

```
ps | grep THE_ERROR_PID_YOU_GET_(IT_IS_A_NUMBER) 
```

那么如果输出作为您的应用程序出现......这是您的应用程序导致错误。尝试寻找`Strings`您传递到`layout`.

我遇到了同样的问题，这是我的错，因为我在`String`布局中传递了一个空白。更改`""`为此`" "`错误后消失了。

如果您没有从控制台输出中获取您的应用程序，那么是其他原因导致它（可能，正如其他人所说，android 键盘）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-06-17T11:35:53.740

我知道我有点晚了。如果有人仍然需要**第二次单击以使事件 onclick 运行的**帮助，我将其删除：

```
android:focusableInTouchMode="true" 
```

onClick 事件现在将在第一次单击时起作用。

# python - 如何在 Python 中改进井字棋胜利的代码

> ID：15839247
> 
> 赞同：0
> 
> 时间：2013-04-05T16:46:08.933
> 
> 标签：python, tic-tac-toe

我正在编写一个用于制作井字游戏的 python 代码。我需要编写一个函数，它接受三个输入，板、x 和 y。棋盘是棋盘的当前显示，然后 x 和 y 的值是 0、1 或 2。游戏设置为向用户询问坐标。

```
def CheckVictory(board, x, y):

    #check if previous move was on vertical line and caused a win
    if board[0][y] == ('X') and board[1][y] == ('X') and board [2][y] == ('X'):
        return True
    if board[0][y] == ('O') and board[1][y] == ('O') and board [2][y] == ('O'):
        return True

    #check if previous move was on horizontal line and caused a win
    if board[x][0] == ('X') and board[x][1] == ('X') and board [x][2] == ('X'):
        return True
    if board[x][0] == ('O') and board[x][1] == ('O') and board [x][2] == ('O'):
        return True

    #check if previous move was on the main diagonal and caused a win
    if board[0][0] == ('X') and board[1][1] == ('X') and board [2][2] == ('X'):
        return True
    if board[0][0] == ('O') and board[1][1] == ('O') and board [2][2] == ('O'):
        return True
    #check if previous move was on the secondary diagonal and caused a win
    if board[0][2] == ('X') and board[1][1] == ('X') and board [2][0] == ('X'):
        return True
    if board[0][2] == ('O') and board[1][1] == ('O') and board [2][0] == ('O'):
        return True

    return False 
#end of CheckVictory function 
```

该函数在游戏循环中被调用，如下所示

```
p_x, p_y = playerTurn(board)    #let player take turn
displayBoard(board)             #show board after move has been made
if CheckVictory(board, p_x, p_y):   #see if user has won
    print("CONGRATULATIONS, you win!")
    newGame(board)  #game over start new one
    continue 
```

电脑转也是类似的

我觉得有更好的方法来编写这个函数。我觉得我应该更多地使用 x 和 y 或者有更好的方法来检查而不是写下所有的可能性。那么有什么更好的方法来写这个呢？使其简短明了。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-05T17:10:45.490

我看不出你为什么需要`x`和`y`参数，你应该检查是否连续有三个 X 字母或三个 O 字母，你不需要坐标。而是先编辑棋盘，更新玩家输入的坐标，然后检查胜利是否发生。

这是我的做法，但如果你想使用你的方法 - 随意。你仍然可以从我的版本中学到一些东西。

```
def check_victory(board):
    combinations = [
        # horizontal
        ((0,0), (1,0), (2,0)),
        ((0,1), (1,1), (2,1)),
        ((0,2), (1,2), (2,2)),
        # vertical
        ((0,0), (0,1), (0,2)),
        ((1,0), (1,1), (1,2)),
        ((2,0), (2,1), (2,2)),
        # crossed
        ((0,0), (1,1), (2,2)),
        ((2,0), (1,1), (0,2))
    ]

    for coordinates in combinations:
        letters = [board[y][x] for x,y in coordinates]
        if len(set(letters)) == 1:
            return letters[0] # returns corresponding letter for winner (X/O)

    return False 
```

请注意，它使用列表推导和集合。如果您不熟悉这些，我建议您在使用此解决方案之前学习它们。

# javascript - javascript - Firefox 中的“提交不是函数”错误，在 IE 中运行良好

> ID：15839250
> 
> 赞同：1
> 
> 时间：2013-04-05T16:46:28.403
> 
> 标签：javascript, firefox

我在 Firefox 中收到以下代码的“提交不是函数”错误。我也试过 document.getElementById("editInvNotesForm").submit(); 和 document.Forms[0].submit(); 等等 。使用 getElementById 不会给出任何错误，但不会提交更新的表单值。感谢任何帮助。

```
 <input type="submit" value='<liferay-ui:message key="btn.save" />' onclick="return validateNotes(this)" onmouseover="this.className='clsBlueButtonOver'" onmouseout="this.className='clsBlueButton'" class="clsBlueButton" />&nbsp;&nbsp;&nbsp;&nbsp;
                                            </td>

    <script type="javascript">      

                    function validateNotes(saveButton) 
            {

                if(document.getElementById('noteText${itemNoteVo.noteNo}').value<=0 ){
                    alert(Liferay.Language.get('msg.enter-report-note'));
                    document.getElementById('noteText${itemNoteVo.noteNo}').focus();
                    return false;
                }

                 if (document.getElementById('noteText${itemNoteVo.noteNo}').value.search(/[<>]+/) != -1) {              
                    alert(Liferay.Language.get('msg.angle-brackets-not-allowed'));
                    document.getElementById('noteText${itemNoteVo.noteNo}').focus();
                    return false;
                }
                saveButton.disabled=true;
                saveButton.className='clsBlueButton';
                 document.editInvNotesForm.submit();

                return true;
            } 
            </script>

Thanks 
```

# node.js - Express 3.0 HTTPS

> ID：15839253
> 
> 赞同：1
> 
> 时间：2013-04-05T16:46:37.060
> 
> 标签：node.js, ssl, express

我有一个 Node.js Express 3.0 应用程序，它在本地侦听端口 3000 和在线端口 80，这很好。然而，我现在需要做的是引入 SSL 证书。

我在网上查看了许多资源，但它们都过时了，或者只在端口 443 上工作，或者什么都没有。但是，我需要做的是同时监听 443 和 80，并将任何对 80 的请求重定向回 443。

他们有最新的例子吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-05T17:08:23.287

我会用 2 个不同的进程来做到这一点：一个不安全的代理服务器和一个安全的服务器。

不安全的代理侦听端口 80 并通过 302 重定向响应所有请求到安全服务器

# 不安全的代理

```
var http = require('http')
var port = 80
var server = http.createServer(function (req, res) {
  // change this to your secure sever url
  var redirectURL = 'https://www.google.com'
  res.writeHead(302, {
    Location: redirectURL
  });
  res.end();
}).listen(port, function () {
  console.log('insecure proxy listening on port: ' + port)
}) 
```

# 安全服务器

```
var https = require('https')
var express = require('express')
var fs = require('fs')
var keyFilePath = '/path/to/key.pem'
var certFilePath = '/path/to/cert.pem'

var app = express()
// put your express app config here
// app.use(...) etc.

var port = 443 // standard https port
var options = {
  key: fs.readFileSync(keyFilePath, 'utf8'),
  cert: fs.readFileSync(certFilePath, 'utf8')
}

var server = https.createServer(options, app)
server.listen(port, function () {
  console.log('secure server listening on port: ' + port)
}) 
```

请注意，您可以在单个进程中运行这两个服务器，但将关注点分成不同的进程更易于维护。

# regex - 正则表达式从 '_m' 到行尾的日志文件输出的每一行中提取内容

> ID：15839254
> 
> 赞同：0
> 
> 时间：2013-04-05T16:46:38.700
> 
> 标签：regex, logfiles

日志行格式：

```
Xxx x xx:xx:xx xmmxxx XXXXXX: XXXXXXX:XXX: xxx_Mxxx_Xxxxxx_mxxxxxmmxx [XXX xxxx. 
```

我想从`'_m'`行尾提取，`'_'`删除`'m'`.

正则表达式的新手...

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-05T16:53:28.393

如果您的工具/语言支持后视，则此方法有效：匹配第一个`_m`until `EOL`。也忽略领先`_`

```
(?<=_)m.* 
```

用 grep 测试：

```
kent$  echo "Xxx x xx:xx:xx xmmxxx XXXXXX: XXXXXXX:XXX: xxx_Mxxx_Xxxxxx_mxxxxxmmxx [XXX xxxx."|grep -Po '(?<=_)m.*' 
mxxxxxmmxx [XXX xxxx. 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-05T16:55:19.680

与`sed`：

```
sed -n 's/^.*_\(m.*$\)/\1/p' file 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-05T16:52:15.670

这很容易：

此示例是用 C# 编写的，但是正则表达式非常通用，可能在任何地方都可以使用：

```
Regex regex = new Regex(@"_(m.*)");  // If you look for _M the regex should be @"_(M.*)"

Match match = regex.Match(logLine);
if (match.Success)
    Console.WriteLine(match.Groups[1].Value); 
```

希望这对您的追求有所帮助。

# git - Git merge --no-commit 跟踪文件而不提交它们

> ID：15839255
> 
> 赞同：1
> 
> 时间：2013-04-05T16:46:41.163
> 
> 标签：git, merge

在分支上，AI 有两个“故事”，一个我想致力于掌握，一个我没有。

由于这些更改不在功能分支上，因此我需要以某种方式将两者分开。我用了

```
git merge --no-commit --no-ff A 
```

在主人的时候。这给了我一个可以按预期进行调整的临时区域，我

```
git reset file 
```

在那些与不需要的提交有关的文件上。这种方法不正确吗？结果出乎意料。这些文件没有被添加（根据需要），但它们的记录被添加了。Git 将它们作为已删除的文件进行跟踪！现在，当从 master 合并回 A 时，它会尝试删除未提交的工作。这很奇怪，因为主人从来没有这些文件。这非常不方便，谁能建议我如何“同步”这些变化？或者也许是一种更好的方法，为什么 --no-commit 会这样做？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-05T17:01:08.390

我认为最干净的方法是创建两个分支`story1`，并`story2`从 A 和 master 的合并库中创建。然后`A`通过挑选和编辑/吐出提交来分离提交。因此，每个故事分别有两个新分支。然后你可以很容易地合并。

# css - 在 IE10 中，页脚从页面底部向上移动

> ID：15839258
> 
> 赞同：1
> 
> 时间：2013-04-05T16:46:53.373
> 
> 标签：css, internet-explorer-10, sticky-footer

我在一个 MVC 网站上工作，我无法让页脚留在 IE10 的页面底部。由于某种原因，它最初会在页面加载时出现在窗口底部，但是即使向下滚动，它也会保持在相同的位置，因此页脚不再位于页面底部。

奇怪的是，当您调整窗口大小时，页脚会固定在页面底部。当您将页面恢复为全尺寸时，页脚仍然固定在页面底部。如果您刷新页面或转到新页面，则页脚不再固定在页面底部。

我尝试了一些 CSS 解决方案来创建 Sticky Footer，它们在 Firefox、Chrome 和所有较旧的 IE 中都可以使用，但在 IE10 中没有。我已经尝试过[ryanfait 的解决方案](http://ryanfait.com/resources/footer-stick-to-bottom-of-page/)和[cssstickyfooter](http://www.cssstickyfooter.com/using-sticky-footer-code.html)，但都没有为我工作。

我的页脚目前有以下 CSS 代码：

```
#footer{background:#098a9d url(../img/headFootShadow.png) repeat-x 0 -8px;padding:20px 0 0;display:block;height:65px;margin-top:30px;color:#fff}
#footer a{color:#FFF;font-weight:700;text-decoration:none}
#footer a:hover{text-decoration:underline}

/*Sticky footer hack*/

html, body {height: 100%;}
html#lightbox{height:auto;}
#fullWrap {min-height: 100%;}
#main {overflow:auto;padding-bottom:105px;}  /* must be same height as the footer*/
#footer {position: relative;margin-top: -85px; /* negative value of footer height  */height:65px;clear:both} 
```

正如我所说，这适用于 Chrome、Firefox 和较旧的 IE，但不适用于 IE10。有谁知道如何解决这个问题或可能的解决方法？任何帮助将不胜感激。

非常感谢

伯纳德

# jsf-2 - JSF 在页面加载时调用 CDI bean 上的操作

> ID：15839262
> 
> 赞同：0
> 
> 时间：2013-04-05T16:47:02.600
> 
> 标签：jsf-2, cdi

在 JSF 文件中`addLink.xhtml`，我使用 CDI bean `LinkAdapter`。处理 JSF 文件时，其中的每个方法都`LinkAdapter`被调用了多次，尽管现在整个项目中的任何地方都没有引用它们中的大多数。

`LinkAdapter`是`@Named`和`@SessionScoped`。_ 但我认为这无关紧要，因为它似乎发生在任何其他 JSF 文件中的所有其他 bean 上。

谁能告诉我这种行为的原因？

我使用 JBoss AS 7.0.2、prettyfaces (JSF2) 3.3.2 和 Weld 1.0.0.Final

# data-mining - `locality-sensitive` 在局部敏感散列中代表什么？

> ID：15839268
> 
> 赞同：1
> 
> 时间：2013-04-05T16:47:24.563
> 
> 标签：data-mining, discrete-mathematics

`locality-sensitive`代表什么 `locality-sensitive hashing`？这个词有正式的定义吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-05T23:53:32.593

LSH 将高维向量映射到桶，并尝试确保彼此“接近”的向量映射到同一个桶。“近”的定义只是关于某个距离函数（例如欧几里得）的邻域。

“局部”是指空间上的区域；“敏感”意味着附近的位置映射到同一个桶。换句话说，散列函数的输出依赖于（敏感于）空间中的位置（局部性）。

这是我的理解。我相信理论上的人必须有更正式的定义。希望这可以帮助。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-06T16:17:31.750

通常，散列函数将用于*分隔*附近的值，以减少冲突的风险。想想密码散列：你确实希望每一个字符的改变都能完全改变散列码。

这不适用于 LSH 中使用的散列函数。好吧，从技术上讲，它适用于散列函数，但不适用于散列之前的步骤：将数据放入桶中，这是一种有损操作，通常会将附近的点放入同一个桶中。之后，实际上只有存储桶编号被散列（IIRC），因此您不会获得数百万个存储桶，而只会获得所需数量的存储桶。

如果您有用于映射和分箱的独立函数，它们可能会重叠，以便您可以在查询点所在的至少一个哈希冲突桶中找到所有真正的邻居。

# asp.net-mvc - 类项目中的 DbContext 问题

> ID：15839275
> 
> 赞同：1
> 
> 时间：2013-04-05T16:47:44.260
> 
> 标签：asp.net-mvc, entity-framework, asp.net-web-api, dbcontext

**背景**：

我在同一个解决方案中有一个 Web API 项目和一个类库项目，它们共享相同的模型类。两个项目共享同一个数据库，并且都使用 DbContext 来读取/写入数据。

Web API 项目以典型的 UnitOfWork 模式设置并且运行良好。

课堂项目有点不同。我在构造函数而不是 Web.config 文件中指定连接字符串：

```
class MyContext : DbContext
{
    public MyContext(string connectionString)
        : base()
    {
        // Do this to force me to use eager loading
        this.Configuration.LazyLoadingEnabled = false;
        // Init connection string
        this.Database.Connection.ConnectionString = connectionString;
        Database.SetInitializer <CFCalcContext> (null);
    }

    ... DbSets ...

    protected override void OnModelCreating(DbModelBuilder modelBuilder)
    {
        ... modelBuilder details ...
    }
} 
```

我使用 Web API 调用类库中定义的函数。当我尝试使用类库查询数据库时出现错误。

**问题**：

在类库项目中，我得到一个 EntityCommandCompilationException 内部异常为：

> InnerException: System.Data.MappingException HResult=-2146232032 Message= (82,10) : error 3034: 从第 82、90 行开始映射片段时出现问题：具有不同键的两个实体映射到同一行。确保这两个映射片段不会将具有不同键的两组实体映射到同一组行。
> 
> (82,10)：错误 3034：从第 82、98 行开始映射片段时出现问题：具有不同键的两个实体映射到同一行。确保这两个映射片段不会将具有不同键的两组实体映射到同一组行。
> 
> (82,10)：错误 3034：从第 82、106 行开始映射片段时出现问题：具有不同主键的两行映射到同一个实体。确保这两个映射片段不会将具有相同键的两组实体映射到两组重叠的行。
> 
> (82,10)：错误 3034：从第 82、112 行开始映射片段时出现问题：具有不同键的两个实体映射到同一行。确保这两个映射片段不会将具有不同键的两组实体映射到两组重叠的行。
> 
> (82,10)：错误 3034：从第 82、118 行开始映射片段时出现问题：具有不同键的两个实体映射到同一行。确保这两个映射片段不会将具有不同键的两组实体映射到两组重叠的行。
> 
> (90,10)：错误 3034：从第 90、98 行开始映射片段时出现问题：具有不同键的两个实体映射到同一行。确保这两个映射片段不会将具有不同键的两组实体映射到同一组行。

此外，当我右键单击派生的 DbContext 类（在类库中）并使用 Entity Framework Power Tools 来“查看实体数据模型”时，我收到错误消息：“在所选文件中找不到派生自 DbContext 的可构造类型。 " 这在 Web API 项目中工作得很好。

为什么连接到同一个数据库并且配置基本相同的两个 DbContext 会执行不同的操作？我一定错过了一个配置步骤，但我不知道是哪个。

谢谢您的帮助！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-05T17:21:23.000

这里发生了很多事情。首先，如果您手动设置连接字符串，您应该在调用基本构造函数时设置它：

```
public MyContext(string connectionString)
    : base(connectionString) 
```

其次，你真的应该把它放在 Web.Config 中 - 如果名称是问题，你可以给它一个不同的名称，例如：

```
public MyContext()
    : base("Whatever name I used in Web.Config") 
```

第三，这可能是错误的：

```
Database.SetInitializer <CFCalcContext> (null); 
```

[Database.SetInitializer](http://msdn.microsoft.com/en-us/library/gg679461%28v=vs.103%29.aspx)的文档指出：

> 获取或设置数据库初始化策略。当从 DbCompiledModel 初始化 DbContext 实例时，将调用数据库初始化策略。

换句话说，将其设置为 null 可能会使您的 DbContext 在它尝试做任何事情时立即爆炸——我怀疑这就是您在这里发生的事情。

# java - 使用 JAXB 处理缺失节点

> ID：15839276
> 
> 赞同：5
> 
> 时间：2013-04-05T16:47:46.910
> 
> 标签：java, xml, jaxb

我目前正在使用 JAXB 来解析 xml 文件。我通过 xsd 文件生成了所需的类。但是，我收到的 xml 文件不包含在生成的类中声明的所有节点。以下是我的 xml 文件结构的示例：

```
<root>
<firstChild>12/12/2012</firstChild> 
<secondChild>
<firstGrandChild>
<Id>
  </name>
  <characteristics>Description</characteristics> 
  <code>12345</code>
</Id>
</firstGrandChild>
</secondChild>
</root> 
```

我面临以下两种情况：

1.  该节点`<name>`存在于生成的类中，但不存在于 XML 文件中
2.  节点没有价值

在这两种情况下，该值都设置为 null。我希望能够区分 XML 文件中何时不存在节点以及何时存在但具有空值。尽管我进行了搜索，但我没有找到一种方法。任何帮助都非常受欢迎

非常感谢您的时间和帮助

问候

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-05T17:12:14.150

[**JAXB (JSR-222)**](http://jcp.org/en/jsr/detail?id=222)实现不会为不存在的节点调用 set 方法。您可以将逻辑放入您的 set 方法中以跟踪它是否已被调用。

```
public class Foo {

    private String bar;
    private boolean barSet = false;

    public String getBar() {
       return bar;
    }

    public void setBar(String bar) {
        this.bar = bar;
        this.barSet = true;
    }

} 
```

* * *

**更新**

JAXB 还将空节点视为具有 empty 值`String`。

**Java 模型**

```
import javax.xml.bind.annotation.XmlRootElement;

@XmlRootElement
public class Root {

    private String foo;
    private String bar;

    public String getFoo() {
        return foo;
    }

    public void setFoo(String foo) {
        this.foo = foo;
    }

    public String getBar() {
        return bar;
    }

    public void setBar(String bar) {
        this.bar = bar;
    }

} 
```

**演示**

```
import java.io.File;
import javax.xml.bind.*;

public class Demo {

    public static void main(String[] args) throws Exception {
        JAXBContext jc = JAXBContext.newInstance(Root.class);

        Unmarshaller unmarshaller = jc.createUnmarshaller();
        File xml = new File("src/forum15839276/input.xml");
        Root root = (Root) unmarshaller.unmarshal(xml);

        Marshaller marshaller = jc.createMarshaller();
        marshaller.setProperty(Marshaller.JAXB_FORMATTED_OUTPUT, true);
        marshaller.marshal(root, System.out);
    }

} 
```

**输入.xml/输出**

```
<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<root>
    <foo></foo>
</root> 
```

# javascript - jQuery拼接inArray与多个关键对象

> ID：15839281
> 
> 赞同：1
> 
> 时间：2013-04-05T16:48:20.127
> 
> 标签：javascript, jquery

这里是 Javascript 新手——

我有以下数组：

```
var group = ({ 
        one: value1,
        two: value2,
        three: value3
    }); 
```

我想检查数组“group”是否是“groupsArray”的一部分，如果不是则添加它，如果是则删除它。

```
var groupLocate = $.inArray(group, groupsArray);
if(groupLocate ==-1){
        groupsArray.push(group);
        } else {
        groupsArray.splice($.inArray(group, groupsArray),1);
        } 
```

此方法适用于单值数组。不幸的是，在这种情况下，我无法使用三个键和值使其工作，因为 groupLocate 总是返回-1。

我究竟做错了什么？

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-05T17:35:57.120

首先，它有助于理解为什么`$.inArray()`不起作用。让我们尝试一个更简单的案例。将其粘贴到浏览器中加载了 jQuery 的页面上的 JavaScript 控制台（例如我们所在的这个页面）并运行它：

```
var object = { a: 1 };
var array = [ { a: 1 } ];
console.log( '$.inArray: ', $.inArray( object, array ) ); 
```

（注意术语：你的`group`变量是一个对象，而不是一个数组。）

现在它看起来像`object`在数组中，对吧？那为什么要打印`-1`呢？试试这个：

```
console.log( object );
console.log( array[0] ); 
```

它们看起来一样。怎么样：

```
console.log( '== or === works? ', object == array[0], object === array[0] ); 
```

或者更简单：

```
console.log( 'Does {a:1} == {a:1}? ', {a:1} == {a:1} );
console.log( 'What about {} == {}? ', {} == {} ); 
```

那些都打印`false`！

这是因为两个碰巧具有相同内容的对象仍然是两个独立的对象，而当您使用`==`或`===`比较两个对象时，您实际上是在测试它们是否都是对同一个对象的引用。两个不同的对象永远不会比较相等，即使它们包含完全相同的内容。

`$.inArray()`就像使用`===`运算符比较两个对象一样 - 它不会在数组中找到对象，除非它是*相同的对象*，而不仅仅是具有相同内容的对象。

知道了这一点，这是否暗示了解决问题的任何可能方法？您可以通过多种方式编写自己的代码来搜索数组中的对象，或者您可能会发现使用诸如[Underscore.js](http://underscorejs.org/)之类的库很有帮助，该库具有许多有用的数组和对象方法。

例如，您可以使用[`_.findWhere( groupsArray, group )`](http://underscorejs.org/#findWhere)来查找第一个匹配项 - 需要注意的是它只比较对象中的`group`属性。例如，如果`group`is `{a:1}`，它将匹配`groupsArray`数组中的对象是`{a:1,b:2}`。

如果您需要完全匹配，您可以结合下划线[`_.find()`](http://underscorejs.org/#find)和[`_.isEqual()`](http://underscorejs.org/#isEqual)方法：

```
var index = _.find( groupsArray, function( element ) {
    return  _.isEqual( element, group );
}); 
```

现在要注意的最后一件事。您将`group`对象推送到`groupsArray`数组上的代码 - 您知道推送实际`group`对象本身。它不会在数组中复制它，它是对同一个对象的引用。（具有讽刺意味的是，这意味着您`group`在数组中查找的原始代码实际上可以在您自己将同一个`group`对象推送到数组的情况下工作。）

如果您想确保其中的`groupsArray`每个元素都是它们自己的独立对象，而不是对代码中浮动的另一个对象的引用，您可以使用另一个 Underscore 方法进行浅拷贝：

```
groupsArray.push( _.clone(group) ); 
```

但是，如果`group`有任何嵌套对象，则不会复制它们。（我在 Underscore 中没有看到深拷贝功能，但如果需要，您可以编写一个。）

# list - 在 Liferay 中创建进度条

> ID：15839286
> 
> 赞同：5
> 
> 时间：2013-04-05T16:48:42.977
> 
> 标签：list, dynamic, progress-bar, liferay

我希望在 Liferay 中创建一个进度条，希望在动态列表显示插件中，但不一定。不过，进度条的数据将来自列表。有什么建议么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2015-08-27T17:10:42.077

您可以使用 Liferay 6.2 中的 AlloyUI 轻松完成。您需要进度条的占位符 - 如下所示：

```
<div id="myProgressBar" style="width:100%;height:20px;"></div> 
```

然后你可以像这样使用 javascript 创建它：

```
<aui:script use="aui-base,aui-progressbar">
var progressBar = new A.ProgressBar({
        boundingBox: '#myProgressBar',
        label: '<%=percentage%>%',
        orientation: 'horizontal',
        value: '<%=percentage%>',
    }).render();
</aui:script> 
```

您可以在此处阅读有关进度条配置选项的更多信息：http: [//alloyui.com/api/classes/A.ProgressBar.html](http://alloyui.com/api/classes/A.ProgressBar.html)

还有一些示例：http: [//alloyui.com/versions/2.0.x/tutorials/progress-bar/](http://alloyui.com/versions/2.0.x/tutorials/progress-bar/)

# php - PHP 的 class_exists() 是否有命名空间感知替代方案？

> ID：15839292
> 
> 赞同：12
> 
> 时间：2013-04-05T16:49:09.447
> 
> 标签：php, namespaces

如果您尝试在 PHP 中类的方法中使用 class_exists()，则必须指定类的全名——当前命名空间不受尊重。例如，如果我的班级是：

```
 <?
    namespace Foo;

    class Bar{
       public function doesBooClassExist(){
            return class_exists('Boo');
       }
    } 
```

而 Boo 是一个类（正确地自动加载），看起来像这样

```
 namespace Foo;

    class Boo{
       // stuff in here
    } 
```

如果我尝试：

```
$bar = new Bar();
$success = $bar->doesBooClassExist();
var_dump($success); 
```

你会得到一个错误的......有没有另一种方法可以做到这一点而不必明确指定完整的类名（即`class_exits('Foo\Boo')`）？

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2013-04-05T17:31:00.657

在 5.5 之前，最好的方法是始终使用完全限定的类名：

```
public function doesBooClassExist() {
    return class_exists('Foo\Boo');
} 
```

这并不难，而且它使您所指的内容非常清楚。请记住，您应该追求可读性。命名空间导入在编写时很方便，但会使阅读变得混乱（因为在阅读代码时需要牢记当前的命名空间和任何导入）。

然而，在 5.5 中，有一个新的构造即将到来：

```
public function doesBooClassExist() {
    return class_exists(Boo::class);
} 
```

伪魔术`class`常量可以放在任何标识符上，它将返回它将解析为的完全限定类名......

# rally - 最近对 Rally C# REST API 的更改？

> ID：15839293
> 
> 赞同：1
> 
> 时间：2013-04-05T16:49:24.287
> 
> 标签：rally

1) 本周早些时候，我能够使用 Create 方法创建缺陷和测试用例，该方法当时采用 2 个参数（一个字符串和 DynamicJsonObject）。但是现在，它需要三个。我知道其中之一现在是工作区参考。如何获取工作区参考？为了创建缺陷和测试用例，我使用了一个空字符串，这对我来说似乎工作正常。这是可以预料的吗？

2）为了创建测试用例结果，我遇到了一些麻烦。

```
 DynamicJsonObject newTCResult = new DynamicJsonObject();
        newTCResult["Date"] = DateTime.Now.ToString("yyyyMMdd");
        newTCResult["TestCase"] = "/testcase/11271454106";
        newTCResult["Notes"] = "test";
        newTCResult["Build"] = "13.1.0.90";
        newTCResult["Verdict"] = "Pass";

        CreateResult cr = restApi.Create(" ", "TestCaseResult", newTCResult); 
```

截至目前，当我运行它时，绝对没有发生任何事情。本周早些时候我能够成功地做到这一点（当我能够使用带有两个参数的 Create 方法时）。我觉得问题是因为我没有有效的工作区参考。在此之前，我在一个类似的问题中遵循了另一个用户的建议，该问题之前有效，但是现在我遇到了这个问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-10T11:03:39.750

我终于能够解决这个问题。看来日期字段需要转换为 UTC，所以我的代码现在看起来像这样

newTCResult["Date"] = DateTime.UtcNow.ToString("o");

在进行了微小的更改后，结果工作正常。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-05T17:28:36.727

Creates on Stories 或 Defects 使用空字符串作为 Workspace ref 有点令人惊讶，尽管我怀疑在服务器端，Webservices API 只是为关注的用户使用 Default Workspace。

无论哪种方式，您都可以通过以下方式获得感兴趣的工作区的引用：

```
 String myWorkspaceName = "My Workspace";

        // Get a Reference to Target Workspace
        Request workspaceRequest = new Request("workspace");
        workspaceRequest.Fetch = new List<string>()
            {
                "Name",
                "ObjectID"
            };

        workspaceRequest.Query = new Query("Name", Query.Operator.Equals, myWorkspaceName);
        QueryResult workspaceQueryResults = restApi.Query(workspaceRequest);

        var targetWorkspace = workspaceQueryResults.Results.First();
        Console.WriteLine("Found Target Workspace: " + targetWorkspace["Name"]);

        String workspaceRef = targetWorkspace["_ref"]; 
```

然后，您可以`workspaceRef`在对`restApi.Create()`.

# javascript - javascript 大于 if 语句无法正常工作

> ID：15839300
> 
> 赞同：1
> 
> 时间：2013-04-05T16:49:51.097
> 
> 标签：javascript

我不是javascript专家，所以希望有人可以帮助我。

我有以下代码，但由于某种原因它总是认为该陈述是正确的

```
delvNum=document.getElementById("deliveryNum").value;
delvQTY=document.getElementById("delvQTY"+id).value;
orderQTY=document.getElementById("orderQTY"+id).value;

if (delvQTY>orderQTY)
{
  alert("Can't deliver more than " + orderQTY + ", you are trying to deliver " + delvQTY + ". Please fix!");
  document.getElementById("delvQTY"+id).focus();
  return;
} 
```

错误消息确实显示了每个 var 的数量，并且正在正确传递。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-05T16:51:27.730

您正在比较字符串而不是数字。

使用[parseInt](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/parseInt)或[parseFloat](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/parseFloat)

```
if (parseFloat(delvQTY)>parseFloat(orderQTY)) 
```

或者

```
if (parseInt(delvQTY,10)>parseInt(orderQTY,10)) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-05T16:51:19.807

您正在进行字符串比较，而不是数字比较，例如`"9">"1111"`is `true`。

您需要解析您的值：

```
if (parseFloat(delvQTY)>parseFloat(orderQTY)) 
```

请参阅[parseFloat](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/parseFloat)。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-05T16:51:30.627

在进行比较之前，您需要确定`delvQTY`和`orderQTY`是。`Number``>`

`var delvValue = parseInt(delvQTY, 10);`用于转换为整数。

或者对于浮点数：`var delvValue = parseFloat(delvQTY);`

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-04-05T16:51:58.867

您正在比较字符串值，而不是数字值。你应该说：

```
delvNum = parseInt(document.getElementById("deliveryNum").value, 10); 
```

（假设您正在处理整数，否则使用`parseFloat`）。

请注意`10`说您正在处理以 10 为底的问题 - 没有它，如果有人键入前导零，那么您将得到令人困惑的结果。

# javascript - 跟踪子目录重定向链接到 PDF

> ID：15839302
> 
> 赞同：0
> 
> 时间：2013-04-05T16:49:53.660
> 
> 标签：javascript, url, seo, google-analytics, page-refresh

我有一个 DotNetNuke 网站（托管在 IIS 服务器上），而且我的大部分网址都很长。我们发布了我们产品的 PDF，并且为了方便使用元刷新重定向进行重定向，我们设置了一些快捷方式 url。我最近读到这些链接不会被添加到 Google 的索引中，可以被视为“垃圾邮件”。此外，这些重定向会阻止 Google Analytics 跟踪这些页面浏览量。

我们设置的示例快捷方式 url 是：**mysite.com/awesomesauce**

这将重定向到该产品的 PDF 手册：**mysite.com/products/sauces/awesome_sauce.pdf**

我想添加 Google Analytics 跟踪来跟踪人们何时访问或单击快捷方式 url 链接 ( **mysite.com/awesomesauce** )。有没有办法跟踪对这个快捷链接的访问，也可以避免“垃圾邮件”元刷新方法？

我考虑在页面底部放置一些 JavaScript：

```
<script>
// Google Analytics tracking code, etc.
var _gaq = _gaq || [];
_gaq.push(['_setAccount', 'UA-XXXXXXXX-X']);
_gaq.push(['_trackPageview']);
(function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript';
    ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
})();

// Redirect code (after tracking events fire)
window.location = "http://mysite.com/products/sauces/awesome_sauce.pdf";
</script> 
```

# javascript - Backbone JS 中的排序类型（动态）

> ID：15839303
> 
> 赞同：0
> 
> 时间：2013-04-05T16:49:57.857
> 
> 标签：javascript, backbone.js

当我单击 th 时，我正在尝试对我的用户表进行排序。我的用户有：

*   名字
*   姓氏
*   年龄
*   身份证

当我单击 th 时，会发生一种排序，但是：

*   当我按名字或姓氏对用户进行排序时，它仅适用于 asc 方向。
*   当我按年龄对用户进行排序时，双向有效

任何的想法 ？

这是我的观点：

```
var UserListView = Backbone.View.extend({
  el: ".page",
  events: {
    'click .delete': 'deleteUser',
    'click th': 'sortItem',
  },
  initialize: function(){
    this.users = new UsersCollection();

  },

  sortItem: function(ev) {
    var that = this;  
    var field = ev.currentTarget.id;
    this.users.sort_field(field);
    this.render();
  },

  deleteUser: function(ev) {
    var id = ev.currentTarget.dataset.userId;
    var user = new UserModel({
      id: id
    });
    user.destroy({
      success: function() {
        var userList = new UserListView();
        userList.render();
      }
    })
  },

  render: function() {
    var that = this;      
    this.users.fetch({
      success: function(users) {
        var template = _.template(UserListTemplate, {
          users: users.models
        });
        that.$el.html(template);
      }
    });
  }
}); 
```

还有我的收藏：

```
var UsersCollection = Backbone.Collection.extend({
  model: UserModel,
  url: "/users",
  initialize: function() {
    this._compar = 'id';
    this._sortDir = 'asc';
  },
  comparator: function(user) {
    console.log(this._sortDir);
    return this._sortDir == 'asc' ? user.get(this._compar) : -user.get(this._compar);
  },

  sort_field: function(field) {
    this._compar = field;
    this._sortDir = this._sortDir == 'asc' ? 'desc' : 'asc';
    this.sort();
  }

}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-05T19:29:37.283

你有两个问题：

1.  您不能通过否定字符串来反转字符串的排序顺序。
2.  `sort_field`即使您更改字段，每次都会调用您的排序方向翻转，大概更改字段应该将方向重置为升序。

第一件事。如果您切换到两个参数，那么您可以通过将事物与而不是尝试使用*否定来反转顺序*技巧`comparator`来轻松修复**（1） ：**`<``>`

 *```
comparator: function(a, b) {
    a = a.get(this._compar);
    b = b.get(this._compar);
    var els = this._sortDir == 'asc' ? [ a, b ] : [ b, a ];
    return els[0]  > els[1] ?  1
         : els[0]  < els[1] ? -1
         :                     0;
} 
```

有很多方法可以编写该逻辑，但都只是上述主题的变体。

您可以通过检查是否正在更改来修复**（2）**`field`，如果它正在重置排序方向，如果不是那么只需翻转方向：

```
sort_field: function(field) {
    if(this._compar == field) {
        this._sortDir = this._sortDir == 'asc' ? 'desc' : 'asc';
    }
    else {
        this._compar  = field;
        this._sortDir = 'asc';
    }
    this.sort();
} 
```

演示：http: [//jsfiddle.net/ambiguous/Br4Kj/](http://jsfiddle.net/ambiguous/Br4Kj/)

不过，在视图级别分离排序字段和排序方向可能更有意义，然后您可以有单独的字段 ( `collection.sort_field(field)`) 和方向 ( `collection.sort_dir(dir)`) 调用；当然，调用`sort_field`会将方向重置为升序，并`sort_dir`单独保留排序字段。*

# mysql - MySQL按权重排序结果

> ID：15839306
> 
> 赞同：0
> 
> 时间：2013-04-05T16:49:59.587
> 
> 标签：mysql, sql

我有以下查询：

```
SELECT
  p.`ID`,
  (SELECT COUNT(`ID`) FROM `comments` c WHERE c.`post_id` = p.`ID`) AS `comments`,
  (SELECT COUNT(`ID`) FROM `likes` l WHERE l.`post_id` = p.`ID`) AS `likes`
FROM `posts` p 
```

我想根据第三列对结果进行排序，将按以下方式计算：

```
order = comments * 6 + likes * 4 
```

如何创建这个“虚拟”列并在计算中使用其他两个的结果？

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-05T16:51:32.570

```
SELECT p.ID, comments, likes, (comments * 6) + (likes * 4) AS ordering
FROM (

    SELECT
      p.`ID`,
      (SELECT COUNT(`ID`) FROM `comments` c WHERE c.`post_id` = p.`ID`) AS `comments`,
      (SELECT COUNT(`ID`) FROM `likes` l WHERE l.`post_id` = p.`ID`) AS `likes`
    FROM `posts`
) AS p
ORDER BY ordering 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-05T16:53:33.823

我会这样重写你的查询：

```
SELECT
    p.ID,
    COUNT(DISTINCT comments.ID) as comments,
    COUNT(DISTINCT likes.ID) as likes,
    COUNT(DISTINCT comments.ID)* 6 + COUNT(DISTINCT likes.ID)* 4 as `order`
FROM
    posts p LEFT JOIN comments on p.id = comments.post_id
    LEFT JOIN likes` ON likes.`post_id` = p.`ID`
GROUP BY
    p.ID
ORDER BY
    `order` 
```

# xamarin.ios - 如何使用 mvvmcross 对 UITextView 控件进行双向绑定？

> ID：15839310
> 
> 赞同：2
> 
> 时间：2013-04-05T16:50:11.077
> 
> 标签：xamarin.ios, mvvmcross

我有一个使用 XCode（它是 XIB）创建的简单视图。它由两个 UITextView 控件和一个 UIButton 组成。我已将 UITextView 控件公开为 Outlets 并为其命名。我的 View.designer.cs 文件中的一切看起来都不错。

我正在使用以下语法创建绑定：

```
 this.AddBindings(
            new Dictionary<object, string>()
            {
                {lastname, "{'Text':{'Path':'LastName','Mode':'TwoWay'}}"},
                {uservin, "{'Text':{'Path':'CarVIN','Mode':'TwoWay'}}"}

            }); 
```

当我从姓氏 UITextView 移动到 uservin UITextView 时，我希望我的视图模型中的 SETTER 被调用，但它没有。当我单击按钮并检查 ViewModel 上两个文本属性的值时，它们都为空。

有人知道我做错了什么吗？我在周二有一个快速演示，所有其他平台都运行良好，但似乎无法解决这个问题。

干杯，

/j

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-05T19:08:11.197

我认为问题在于您正在使用`UITextView`实例...但是 mvvmcross vnext 仅附带`UITextField`元素的 2 向绑定。

要将`UITextView`2-way 绑定添加到较旧的 mvvmcross 版本：

1.  添加一个自定义目标绑定类 - 有点像 v3 中的这个：[https ://github.com/slodge/MvvmCross/blob/v3/Cirrious/Cirrious.MvvmCross.Binding.Touch/Target/MvxUITextViewTextTargetBinding.cs](https://github.com/slodge/MvvmCross/blob/v3/Cirrious/Cirrious.MvvmCross.Binding.Touch/Target/MvxUITextViewTextTargetBinding.cs)

2.  在 Setup.cs 期间使用如下代码注册它：

    ```
    protected override void FillTargetFactories(IMvxTargetBindingFactoryRegistry registry)
    {
        base.FillTargetFactories(registry);

        registry.RegisterFactory(new MvxSimplePropertyInfoTargetBindingFactory(typeof(MvxUITextViewTextTargetBinding), typeof(UITextView), "Text");
    } 
    ```

* * *

或者（但可能不是在您的直接演示之前），您可以考虑更新到 v3 beta 版本。

* * *

顺便说一句，现在通常使用 'swiss' 绑定语法来执行此操作：

```
 this.AddBindings(
        new Dictionary<object, string>()
        {
            {lastname, "Text LastName"},
            {uservin, "Text CarVIN"}
        }); 
```

...并且`TwoWay`绑定是大多数非 Windows MvvmCross 绑定的默认设置。

# macos - Mac/iPad 无效的配置文件匹配

> ID：15839311
> 
> 赞同：0
> 
> 时间：2013-04-05T16:50:14.960
> 
> 标签：macos, ipad

我在 xcode 中构建我的应用程序时遇到错误。它在说：

找不到与应用程序标识符“MyGameName”匹配的有效配置文件。

在 xcode 中，如果我转到 Window->Organizer，在我连接的 iPad 和 Provisioning Profiles 下，我有我的个人资料。现在个人资料名称与我的游戏名称不同（我认为这很好）。我的理解是配置文件将一些东西捆绑在一起。其中之一是 App ID。当我创建这个 App ID 时，它与我的游戏有关。在具有此配置文件的 Organizer 中有一个 App Identifier 列，但它是一些随机数。那是怎么回事，我假设我在 xcode 中的 Bundle ID 不应该是这个随机数？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-05T17:07:12.067

你检查过项目设置吗？应用程序 ID 必须与您从开发中心获得的应用程序 ID 相似。

# regex - 需要 PCRE 正则表达式帮助

> ID：15839314
> 
> 赞同：1
> 
> 时间：2013-04-05T16:50:21.187
> 
> 标签：regex, perl, pcre

当每个条件之间存在差距时，我无法编写与 perl 兼容的正则表达式来匹配一些不同的事物。当我解释我想要它找到的东西时，它更有意义

**条件**

1.  /世界/
2.  一个字母
3.  破折号或下划线
4.  一个字母
5.  一个时期
6.  三四个字母

我遇到的问题是我不知道如何编写表达式，使得条件#1 和#2 之间可能存在间隙。条件 #2 - #4 可以重复，但并非总是如此。

我一直在使用多个在线正则表达式测试器，但我无法匹配，我不确定我做错了什么。我认为正则表达式正在寻找`/world/x_x` 或`/world/y-y`代替“向前看”来匹配“字母破折号字母”或“字母下划线字母”模式。

**当前的正则表达式**

```
/world/([a-z](-|_)[a-z]){1,}\.[a-z]{3,4}$ 
```

**所需匹配**（当前不匹配）

```
hxxp://armassimchilzeispreu.blackjackipad.com/world/activate_available.jar

hxxp://chubfaceddamsel0.affittobarcheavela.it/world/eternal_threat-clearing.html

hxxp://offdestroyengarabitar.freebookofraslot.com/world/bonus-middle-marathon.pdf 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-05T17:07:45.447

我想你想要这个

```
use strict;
use warnings;

while (<DATA>) {
  chomp;
  print "OK $_\n" if m</world/[a-z]+(?:[_-][a-z]+)+\.[a-z]{3,4}$>;
}

__DATA__
hxxp://armassimchilzeispreu.blackjackipad.com/world/activate_available.jar
hxxp://chubfaceddamsel0.affittobarcheavela.it/world/eternal_threat-clearing.html
hxxp://offdestroyengarabitar.freebookofraslot.com/world/bonus-middle-marathon.pdf 
```

或者也许只是

```
m</world/[a-z-_]+\.[a-z]{3,4}$> 
```

# java - JavaCV 的 cvResize 函数

> ID：15839316
> 
> 赞同：3
> 
> 时间：2013-04-05T16:50:32.300
> 
> 标签：java, opencv, javacv, iplimage

说我在这里使用了错误的类型。img 和 image 都是 iplImages，我应该使用什么类型以及如何使用它？谢谢

```
 IplImage image = IplImage.create(120, 120, IPL_DEPTH_8U, 4);
                    //resize the image
                     cvResize(img,image);

                    cvSaveImage("4-rjb" + capture + ".pgm", img); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2014-10-17T11:03:04.177

这应该工作

```
IplImage resizeImage = IplImage.create(120, 120, origImg.depth(), origImg.nChannels()); 
```

这里有一个完整的例子

```
OpenCVFrameGrabber frameGrabber = new OpenCVFrameGrabber(video_in);
try {
    frameGrabber.start();
    IplImage origImg = frameGrabber.grab();
    IplImage resizedImage = IplImage.create(IMG_WIDTH, IMG_HEIGHT, origImg.depth(), origImg.nChannels());

    //cvSmooth(origImg, origImg);
    cvResize(origImg, resizedImage);
    cvSaveImage(image_out.getAbsolutePath(),resizedImage);
    cvReleaseImage(resizedImage);

} catch (OpenCVFrameGrabber.Exception e) {
    e.printStackTrace();
    throw new NullPointerException("fileExtension");
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-08-29T18:26:23.000

您应该使用与源图像中相同数量的通道

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-03-03T19:52:13.127

用 img.nChannels() 替换 IPL_DEPTH_8U 参数

# prolog - parent_of 序言

> ID：15839322
> 
> 赞同：0
> 
> 时间：2013-04-05T16:50:54.597
> 
> 标签：prolog, family-tree

我是 prolog 的新手，想得到一些建议。

我有一些事实：

```
male(tom).
male(james).
male(john).
female(elly).
female(joanne).
female(evonne).
brother(john,tom).
brother(john,joanne).
sister(elly,joanne).
parent_of(evonne,john).
parent_of(james,john). 
```

`parent_of`是否可以在不使用`sister`and的情况下定义规则`brother`？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-06T06:25:32.787

首先你应该有一些`parent_of`事实作为亲子关系的核心。然后您可以通过将某人作为孩子或父母附加到其中一个事实来扩展这种关系。`siblings/2`因此，如果要附加孩子，则需要使用规则，如果要附加父母，则需要使用规则`couples/2`。

```
%如果你想通过“兄弟姐妹”关系附加一个孩子
parent_of_rule(X, Y) :-
        parent_of(X, Z),
        兄弟姐妹（Z，Y）。

```

```
%如果你想通过“夫妻”关系附加父母
parent_of_rule(X, Y) :-
        parent_of(Z, Y),
        夫妇（X，Z）。

```

我认为`parent_of_rule`不使用第三方关系就不可能制定规则。

# ruby-on-rails - 在 Rails 中使用 I8n.js 的 ActiveAdmin

> ID：15839328
> 
> 赞同：4
> 
> 时间：2013-04-05T16:51:27.137
> 
> 标签：ruby-on-rails, internationalization, activeadmin

[我正在使用ActiveAdmin](http://activeadmin.info/)开发 Rails 应用程序，并且正在使用[I18n.js](https://github.com/fnando/i18n-js)进行 js 翻译。

**问题**是要让 I8n.js 工作，我必须像这样设置语言`.erb`：

```
<script type="text/javascript">
  I18n.defaultLocale = "<%= I18n.default_locale %>";
  I18n.locale = "<%= I18n.locale %>";
</script> 
```

Witch 在应用程序的其余部分工作正常（如果我将它放在`application.erb`文件中），但我找不到一个全局位置来放置它，因此它可以在我的所有 ActiveAdmin 表单中共享。

我真的不想在每个表单中重复代码或修改默认的 ActiveAdmin `erb`（如果可能的话）。

那么有没有办法在所有视图中共享一些 erb 代码？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-04-15T18:33:09.853

我认为有两种方法： 1\. 将此代码放入布局视图 2\. 将此代码放入单独的[部分](http://guides.rubyonrails.org/layouts_and_rendering.html#using-partials)并在每个视图中渲染（前提是布局存在一些问题）

# java - 在 JSP 中使用 for 循环

> ID：15839335
> 
> 赞同：34
> 
> 时间：2013-04-05T16:51:40.050
> 
> 标签：java, html, jsp, loops, for-loop

我想遍历“Festivals”的*ArrayList并使用**get*方法获取它们的信息，打印出它的所有值。出于某种原因，当我使用此代码时，它将始终选择“0”值而不增加循环。

如果我将值硬编码为“get(1)”，它将获得正确的值，所以我的问题显然与语法有关。

```
<h1>All Festival Information</h1>
    <jsp:useBean id="allFestivals" type="java.util.ArrayList" scope="session" />
    <table border="1">
        <tr>
            <td>Festival Name:</td>
            <td>Location:</td>
            <td>Start Date:</td>
            <td>End Date:</td>
            <td>URL:</td>
        </tr>
        <% for(int i = 0; i < allFestivals.size(); i+=1) { %>
            <tr>      
                <td>${allFestivals.get(i).getFestivalName()}</td>
                <td>${allFestivals.get(i).getLocation()}</td>
                <td>${allFestivals.get(i).getStartDate()}</td>
                <td>${allFestivals.get(i).getEndDate()}</td>
                <td>${allFestivals.get(i).getURL()}</td>  
            </tr>
        <% } %>
    </table> 
```

* * *

## 回答 #1

> 赞同：75
> 
> 时间：2013-04-05T17:05:15.840

您的具体问题是因为您将[气馁和老派的小](https://stackoverflow.com/questions/3177733/how-to-avoid-java-code-in-jsp-files/3180202#3180202) *脚本* `<% %>`与其继任者 EL混合在一起`${}`。它们不共享相同的变量范围。在*scriptlet*范围内`allFestivals`不可用，在 EL 范围内不可用。*`i`*

 *您应该安装[JSTL](https://stackoverflow.com/tags/jstl/info)（<-- 单击链接获取说明）并在 JSP 顶部声明它，如下所示：

```
<%@taglib prefix="c" uri="http://java.sun.com/jsp/jstl/core"%> 
```

然后遍历列表如下：

```
<c:forEach items="${allFestivals}" var="festival">
    <tr>      
        <td>${festival.festivalName}</td>
        <td>${festival.location}</td>
        <td>${festival.startDate}</td>
        <td>${festival.endDate}</td>
        <td>${festival.URL}</td>  
    </tr>
</c:forEach> 
```

*（注意可能的[XSS 攻击漏洞](https://stackoverflow.com/questions/2658922/xss-prevention-in-java)，`<c:out>`相应使用）*

不要忘记**删除**，`<jsp:useBean>`因为当您使用 servlet 作为模型和视图控制器时，它在这里没有绝对价值。这只会导致混乱。另请参阅[我们的 servlets wiki 页面](https://stackoverflow.com/tags/servlets/info)。此外，您可以通过以下条目禁用*脚本*`web.xml`，这样您就不会意外使用它们：

```
<jsp-config>
    <jsp-property-group>
        <url-pattern>*.jsp</url-pattern>
        <scripting-invalid>true</scripting-invalid>
    </jsp-property-group>
</jsp-config> 
```

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2013-04-05T16:55:33.367

做这个

```
 <% for(int i = 0; i < allFestivals.size(); i+=1) { %>
        <tr>      
            <td><%=allFestivals.get(i).getFestivalName()%></td>
        </tr>
    <% } %> 
```

更好的方法是使用 c:foreach 查看链接[jstl for each](http://www.tutorialspoint.com/jsp/jstl_core_foreach_tag.htm)*

# python - HTTPCookieProcessor 不提供 cookie

> ID：15839338
> 
> 赞同：1
> 
> 时间：2013-04-05T16:51:51.300
> 
> 标签：python, cookies, urllib2

我正在尝试访问需要 cookie 的网站。使用 urllib2 和 cookielib 我能够从该站点获得响应。HTML 打印输出通知我，我无法通过以下行访问：

```
<h2>Cookies Disabled</h2>
<p> class="share-prompt"><strong>Cookies must be enabled.</strong></p> 
```

我不明白我哪里出错了。下面的代码：

```
import urllib2, cookielib

cookieJar = cookielib.CookieJar()
opener = urllib2.build_opener(urllib2.ProxyHandler({'http':"http://216.208.156.69:3128"}),urllib2.HTTPCookieProcessor(cookieJar))
request = urllib2.Request("[website]")
response = opener.open(request)

print response.read() 
```

谁能看到我哪里出错了？

干杯，

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-06T17:47:10.693

代码看起来不错。例如这个的输出

```
import urllib, urllib2, cookielib

cookieJar = cookielib.CookieJar()
opener = urllib2.build_opener(urllib2.HTTPCookieProcessor(cookieJar))
params = urllib.urlencode({'cookie_name': 'cookie_value'})
request = urllib2.Request('http://httpbin.org/cookies/set?' + params)
opener.open(request)
request = urllib2.Request('http://httpbin.org/cookies')
response = opener.open(request)
print response.read() 
```

是

```
{
  "cookies": {
    "cookie_name": "cookie_value"
  }
} 
```

如果不向我们显示您使用的 url，就无法做到。

# jquery - .on() 未绑定到未来元素 jQuery

> ID：15839343
> 
> 赞同：0
> 
> 时间：2013-04-05T16:52:03.973
> 
> 标签：jquery

我正在使用**单击**`.on()`事件绑定到按钮元素，它将正确绑定到当前加载的元素但是当添加新元素时它不会绑定到它们任何想法？

 **```
$('article#content').on('click', 'button', loadData);

function loadData() {
    var moreTxt = $(this).parent().find('section.hidden')
    var txt = moreTxt.is(':visible') ? 'Read More' : 'Hide';
    $(this).text(txt);
    moreTxt.slideToggle('slow');
} 
```

JsFiddle = [http://jsfiddle.net/jRtMc/](http://jsfiddle.net/jRtMc/)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-05T17:10:06.767

的委托形式`.on()`允许您将处理程序附加到某些将始终存在的父元素，然后根据点击的来源过滤事件。这允许您设置一次处理程序，而不必担心是否已将其附加到新对象。

在此表单中，您调用的元素`.on()`在附加处理程序后不得删除。在您的情况下`$('article#content')`，您致电时必须存在，必须是您关心`on()`的父母`button`（可能存在也可能不存在），并且在您致电后不得删除/创建/重新创建`.on()`。

我怀疑你`#content`是动态生成的。（如果不是，您还有其他问题，因为您的按钮正在引用`.parent()`，这将始终是`#content`）如果`article`是动态的，您需要将处理程序附加到永久父级。您总是可以使用`body`，但它**非常笨拙**，因为在正文中的任何点击都必须通过此处理程序进行过滤。此外，您不能拥有多个相同的 id，因此您需要使用一个类 ( `.content`)，而不是：

```
$('body').on('click', '.content button', loadData); 
```

相反，找到一个永久的父母并使用它：

```
$('#ParentOfArticles').on('click', '.content button', loadData); 
```

[http://jsfiddle.net/HrE6J/](http://jsfiddle.net/HrE6J/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-05T17:16:07.740

您的页面中似乎有多个文章内容，因此您不能使用相同的 id 来标识它们。您应该创建一个`content`类，然后选择它们。

```
$('article.content').on('click', 'button', loadData); 
```**

# sql - sql 按一列分组，然后过滤一列并为不同的值创建新列

> ID：15839348
> 
> 赞同：3
> 
> 时间：2013-04-05T16:52:21.657
> 
> 标签：sql, ms-access, ms-access-2007, pivot

在 MS Access 查询中，如何对一列进行分组，然后使用最大 ID 从表中获取特定值。我知道我可以分组并使用 max 来获取最大 ID，但不确定如何获取多个最大 ID。

如果我有这样的表：

```
+----+------+-------+------+
| ID | Col1 | Col2  | Col3 |
+----+------+-------+------+
|  1 | a    | one   |  100 |
|  2 | a    | two   |  200 |
|  3 | a    | three |  300 |
|  4 | a    | four  |  400 |
|  5 | a    | five  |  500 |
|  6 | b    | one   |  600 |
|  7 | b    | two   |  700 |
|  8 | b    | three |  800 |
|  9 | b    | four  |  900 |
| 10 | b    | one   | 1000 |
| 11 | b    | three | 1100 |
| 12 | b    | six   | 1200 |
| 13 | c    | one   | 1300 |
| 14 | c    | two   | 1400 |
| 15 | c    | three | 1500 |
| 16 | c    | four  | 1600 |
| 17 | c    | six   | 1700 |
| 18 | c    | three | 1800 |
| 19 | c    | two   | 1900 |
| 20 | c    | one   | 2000 |
+----+------+-------+------+ 
```

我想得到这个：

```
+------+------+------+-------+
| Col1 | one  | two  | three |
+------+------+------+-------+
| a    |  100 |  200 |   300 |
| b    | 1000 |  700 |  1100 |
| c    | 2000 | 1900 |  1800 |
+------+------+------+-------+ 
```

当 Col1 = b 且 Col2 = 1 时，ID = 6 和 10。由于 10 较大，因此该行的值是 1000。表的其余部分相同...

我一生都无法弄清楚如何做到这一点。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-05T19:19:10.400

这将返回您在 Access 2007 中使用示例数据请求的结果。

```
SELECT
    sub.Col1,
    DLookup('Col3', 'YourTable', 'ID=' & sub.MaxOfID1) AS [one],
    DLookup('Col3', 'YourTable', 'ID=' & sub.MaxOfID2) AS [two],
    DLookup('Col3', 'YourTable', 'ID=' & sub.MaxOfID3) AS [three]
FROM
    (
        SELECT
            y.Col1,
            Max(IIf(y.Col2='one', y.ID, 0)) AS MaxOfID1,
            Max(IIf(y.Col2='two', y.ID, 0)) AS MaxOfID2,
            Max(IIf(y.Col2='three', y.ID, 0)) AS MaxOfID3
        FROM YourTable AS y
        GROUP BY y.Col1
    ) AS sub; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-05T19:31:45.040

这适用于 MS-Access：

```
TRANSFORM Max(tbl.Col3) AS MaxDiCol3
SELECT tbl.Col1
FROM tbl
WHERE (((tbl.Col2)="one" Or (tbl.Col2)="two" Or (tbl.Col2)="three"))
GROUP BY tbl.Col1
PIVOT tbl.Col2; 
```

如果您需要获取最大 ID，而不是最大值，我建议您改用它：

```
TRANSFORM Max(tbl.ID) AS MaxDiCol3
SELECT tbl.Col1
FROM tbl
WHERE (((tbl.Col2)="one" Or (tbl.Col2)="two" Or (tbl.Col2)="three"))
GROUP BY tbl.Col1
PIVOT tbl.Col2; 
```

并将其保存为查询，例如`Query1`. 然后，您可以使用以下方法获取实际值：

```
SELECT
  Query1.Col1,
  tbl.Col3 AS one,
  tbl_1.Col3 AS two,
  tbl_2.Col3 AS three
FROM
  ((Query1 LEFT JOIN tbl ON Query1.one = tbl.ID)
  LEFT JOIN tbl AS tbl_1 ON Query1.two = tbl_1.ID)
  LEFT JOIN tbl AS tbl_2 ON Query1.three = tbl_2.ID; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-05T17:15:29.053

```
select col1, 
    max(case col2 when 'one' then col3 else 0 end) as One,
    max(case col2 when 'two' then col3 else 0 end) as Two,
    max(case col2 when 'three' then col3 else 0 end) as three
from MyTable
group by col1 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-05T16:56:30.827

由于您没有提到您的 RDBMS，因此几乎所有 RDBMS 都支持以下查询。

```
SELECT  Col1,
        MAX(CASE WHEN Col2 = 'one' THEN Col3 END) one,
        MAX(CASE WHEN Col2 = 'two' THEN Col3 END) two,
        MAX(CASE WHEN Col2 = 'three' THEN Col3 END) three
FROM    TableName
GROUP   BY Col1 
```

*   [SQLFiddle 演示](http://www.sqlfiddle.com/#!2/a2371/1)

输出

```
╔══════╦══════╦══════╦═══════╗
║ COL1 ║ ONE  ║ TWO  ║ THREE ║
╠══════╬══════╬══════╬═══════╣
║ a    ║  100 ║  200 ║   300 ║
║ b    ║ 1000 ║  700 ║  1100 ║
║ c    ║ 2000 ║ 1900 ║  1800 ║
╚══════╩══════╩══════╩═══════╝ 
```

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2013-04-05T17:31:32.220

我认为你需要**[SQL FIDDLE DEMO](http://sqlfiddle.com/#!3/8ea6e/5)****`Dynamic PIVOT and Group By`**

```
 declare @cols varchar(max)
declare @query varchar(max)
DECLARE @selective nvarchar(max)

SELECT @selective =
  STUFF((SELECT ',MAX(' + QUOTENAME(t.col2) +') as ' + QUOTENAME(t.col2)  AS ColName    
         from (
         select distinct  col2                            
         FROM yourtable
         )  t                     
         FOR XML PATH( ''), TYPE).value ('.', 'nvarchar(max)'),1,1,'')

select @cols = STUFF((SELECT ',' + QUOTENAME(t.col2)  AS ColName   
         from (
         select distinct  col2                            
         FROM yourtable
         )  t                 
         FOR XML PATH(''), TYPE).value('.', 'nvarchar(max)'),1,1,'')

set @query = ' ;with CTE_PivotTable
               as
               (
               select ID, Col1, ' + @cols + 
             ' from 
                    ( select ID, Col1, Col2, Col3 
                      from yourtable
                    ) t
                    pivot
                       (
                          max(col3) for col2 in ('+@Cols+')
                        ) as P
                )
                select Col1, ' + @selective + 
                'from CTE_PivotTable
                 group by Col1'

exec(@query) 
```

**输出结果**

```
 COL1 | FIVE  |  FOUR  |  ONE  |  SIX  |  THREE  | TWO
-----------------------------------------------------
a    | 500   |  400   |  100  | (null)|  300    | 200 
b    | (null)|  900   |  1000 | 1200  |  1100   | 700 
c    |(null) |  1600  |  2000 | 1700  |  1800   |1900 
```

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2013-04-05T17:04:37.030

尝试这个：

```
SELECT 
  t1\. col1, 
  MAX(CASE WHEN t1.col2 = 'one' THEN t1.col3 END) AS 'one',
  MAX(CASE WHEN t1.col2 = 'two' THEN t1.col3 END) AS 'two',
  MAX(CASE WHEN t1.col2 = 'three' THEN t1.col3 END) AS 'three'
FROM tablename AS t1
INNER JOIN
(
  SELECT col1, MAX(ID) AS MAXID
  FROM tablename
  WHERE col2 IN('one', 'two', 'three')
  GROUP BY col1, col2
) AS t2 ON t1.col1 = t2.col1 AND t1.id = t2.maxid
GROUP BY t1.col1; 
```

with 子查询将只为您提供每个和`JOIN`的最大 id 值。`col1``col2`

## [SQL 小提琴演示](http://sqlfiddle.com/#!3/94cb2/8)

这会给你：

```
| COL1 |  ONE |  TWO | THREE |
------------------------------
|    a |  100 |  200 |   300 |
|    b | 1000 |  700 |  1100 |
|    c | 2000 | 1900 |  1800 | 
```

* * *

 ~~**但是：**如果您使用的是支持窗口函数和`PIVOT`表运算符的 RDBMS，例如 SQL Server，您可以这样做：

```
WITH CTE 
AS
(
  SELECT *,
    ROW_NUMBER() OVER(PARTITION BY col1, col2
                      ORDER BY ID) AS RN
  FROM tablename
  WHERE col2 IN('one', 'two', 'three')
)
SELECT *
FROM
(
  SELECT col1, col2, col3
  FROM CTE
  WHERE RN <= 3
) AS t
PIVOT
(
  MAX(col3)
  FOR col2 IN([one], [two], [three])
) AS p; 
```

## [更新的 SQL Fiddle 演示](http://sqlfiddle.com/#!3/94cb2/9)~~

# perl - Perl UTF8 到 UTF16 转换错误 - 宽字符

> ID：15839355
> 
> 赞同：2
> 
> 时间：2013-04-05T16:52:52.170
> 
> 标签：perl, unicode

有人能告诉我为什么这个片段失败并出现以下错误吗？我也试过 `utf8::downgrade()`打电话之前`from_to()`没有成功。使用 Perl 5.14.2。

有任何想法吗？？

代码：

```
use Encode qw(from_to);
use HTML::Entities;

$s = "&#3617;&#3627;&#3633;&#3624";
$foo = decode_entities($s);
print "is foo UTF8? ", utf8::is_utf8($foo), "\n";
from_to($foo, 'UTF-8', 'UTF-16'); 
```

输出：

```
is foo UTF8? 1
Cannot decode string with wide characters at /usr/lib/perl/5.14/Encode.pm line 194. 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-05T17:14:19.797

首先，`utf8::is_utf8`不做你认为它做的事。它提供了有关字符串内部存储的详细信息，[您无需检查任何内容](https://stackoverflow.com/questions/14579560/am-i-using-utf8is-utf8-correctly/14584079#14584079)。

问题是您的字符串未使用 UTF-8 编码。它根本没有编码。`decode_entities`两者都接受并返回一个解码的字符串，一个 Unicode 代码点的字符串。

你可以使用

```
encode('UTF-16', decode_entities(decode('UTF-8', $foo))) 
```

# asp.net - 将网站和 MVC4 Web 应用程序部署为单个 IIS 站点，其中包含带有 msbuild/msdeploy 的虚拟应用程序

> ID：15839359
> 
> 赞同：1
> 
> 时间：2013-04-05T16:53:02.187
> 
> 标签：asp.net, asp.net-mvc-4, iis-7, msbuild, webdeploy

我的解决方案中有 2 个 Web 项目：

*   **我们的营销/公共网站，这是一个使用ASP.NET WebPages 2**构建的小型网站。
*   我们的管理应用程序是一个**MVC4**应用程序。

它们目前在 IIS 7.0 中部署为

/ **wwwmywebsitecom**（公共网站的根目录）
---/ **admin**（MVC4 应用程序的根目录）
---/Content
---/Scripts
..etc

将公共站点与管理部分分开的原因是确保第一次加载 FAST 并且不等待由 mvc4 应用程序触发的繁重设置机制（捆绑和缩小、webapi 路由、索引创建、初始设置、 ETC）。

我的目标是使用 MsBuild 和 MsDeploy 打包这些应用程序并将其部署到我们的测试服务器。现在我正在手动执行此操作，但出于显而易见的原因，我需要自动化该过程。（在我弄清楚这部分之后，计划包括一个 CI 服务器）。

我已经阅读了几篇文章，但没有一篇文章涉及这种类型的嵌套场景。

可能吗？
任何帮助将不胜感激。

谢谢，R。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-16T06:43:12.243

假设`admin`远程服务器上的文件夹被标记为“应用程序”，您应该能够一个接一个地部署两个站点。

# python - Pandas Python-可以将日期时间与矢量化输入一起使用

> ID：15839360
> 
> 赞同：0
> 
> 时间：2013-04-05T16:53:13.170
> 
> 标签：python, pandas

我的 pandas 数据框在前 3 列中有年、月和日期。要将它们转换为 datetime 类型，我使用了一个 for 循环，该循环遍历每一行，将每行前 3 列中的内容作为 datetime 函数的输入。有什么办法可以避免这里的for循环并将日期作为日期时间？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-05T17:04:45.947

我不确定是否有矢量化钩子，但`apply`无论如何你都可以使用：

```
>>> df = pd.DataFrame({"year": [1992, 2003, 2014], "month": [2,3,4], "day": [10,20,30]})
>>> df
   day  month  year
0   10      2  1992
1   20      3  2003
2   30      4  2014
>>> df["Date"] = df.apply(lambda x: pd.datetime(x['year'], x['month'], x['day']), axis=1)
>>> df
   day  month  year                Date
0   10      2  1992 1992-02-10 00:00:00
1   20      3  2003 2003-03-20 00:00:00
2   30      4  2014 2014-04-30 00:00:00 
```

# objective-c - 为什么不能每行声明多个方法原型？

> ID：15839364
> 
> 赞同：-1
> 
> 时间：2013-04-05T16:53:23.437
> 
> 标签：objective-c, c, methods, syntax, prototype

鉴于……</p>

```
@interface Hog : NSObject { NSUInteger one, two, three;      }
@property (strong, nonatomic) NSString *four, *five, *six;
-(void) seven;
@end
@implementation Hog
static CGFloat f, ff, fff;
- (NSString*) six { return _four = _five = _six  =  @"sexy"; }
- (void) seven    {          one =   two = three =       33;
                               f =    ff =   fff =     6.66;
                         SEL sevenSelect = @selector(seven);
   NSLog(@" %ld, %0.2f, %@, %@",
   three, fff, self.six, NSStringFromSelector(sevenSelect)); }
@end
int main(int argc,char *argv[]){ Hog *u = Hog.new; [u seven];}

Output: 33, 6.66, sexy, seven 
```

**那么..为什么不可能呢，宣布**

`-(void)seven, eight, nine;`

在标题等？有什么不同？不`objc-c`只是像对待任何其他变量`IMP`、块等一样对待*或其他东西吗？*无论如何，为什么还要打扰原型呢？特别是，如果它在类扩展中，为什么还要麻烦，而您只是要直接在下面编写方法。这似乎只是另一个犯错的机会，不必要的重复，不是吗？我知道我错了，但我要求接受教育，所以继续吧。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-05T17:11:52.057

从语法上讲，方法声明与变量声明不同。它们具有不同的语法，并且只能出现在特定的上下文中。

是否可以修改 Objective-C 的语法以允许多个变量声明以逗号分隔？是的，它会——但它需要比你想象的更大的变化，因为当声明包含参数时，它们会变得更加复杂。仅仅为了让人们编写可读性较差的声明而进行重大的语法更改并没有什么意义。这样做的好处实际上是零。

# google-analytics - 为什么 Google Analytics 目标不读取编码的 URL？

> ID：15839365
> 
> 赞同：0
> 
> 时间：2013-04-05T16:53:25.080
> 
> 标签：google-analytics, goal-tracking

我正在尝试在 Google 分析上设定目标/渠道。URL 的一部分被编码。例如：

第 1 步：[https ://stackoverflow.com/questions/ask?q=5&title=Google%20Analytics%20Goals%20do%20not%20read%20encoded%20urls](https://stackoverflow.com/questions/ask?q=5&title=Google%20Analytics%20Goals%20do%20not%20read%20encoded%20urls)

第 2 步：[https ://stackoverflow.com/questions/ask?q=5&title=Google%20Analytics%20Goals%20do%20not%20read%20encoded%20urls%20at%20all](https://stackoverflow.com/questions/ask?q=5&title=Google%20Analytics%20Goals%20do%20not%20read%20encoded%20urls%20at%20all)

第 3 步：[https ://stackoverflow.com/questions/ask?q=5](https://stackoverflow.com/questions/ask?q=5)

Google Analytics 只读取第 3 步 - 它似乎确实翻译了 URL 编码。

我还尝试插入在 Google Analytics 上解码的 URL，但这也不起作用！

有任何想法吗？

# sql-server - RowState 属性不变

> ID：15839366
> 
> 赞同：0
> 
> 时间：2013-04-05T16:53:25.227
> 
> 标签：sql-server, visual-studio-2005

我有一个不会保存更改的表格编辑。看起来问题在于 RowState 没有改变。foreach 循环用于调试：

```
 private void btnSave_Click(object sender, EventArgs e)
    {

        this.Validate();
        bs.EndEdit();
        dsEdit.Tables["broker"].GetChanges();

        DataTable dtOut = dsEdit.Tables["broker"];
        foreach (DataRow rOut in dtOut.Rows)
        {
            Console.WriteLine(rOut.RowState.ToString());
            Console.WriteLine(rOut["contactfax"]);
            rOut["contactfax"] = "change";
            Console.WriteLine(rOut.RowState.ToString());
            Console.WriteLine(rOut["contactfax"]);
        }

        int n = sdaBkr.Update(dsEdit.Tables["broker"]);
        MessageBox.Show(n.ToString() + " record(s) saved.");

    } 
```

控制台输出如下：

```
Unchanged
fax number here
Unchanged
change 
```

什么会导致这种情况？我没有看到数据库中设置了任何不寻常的属性。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-05T17:36:42.937

在这里找到答案：[BindingSource 上的 EndEdit 更新 DataTable，但行状态仍然不变](https://stackoverflow.com/questions/6995559/endedit-on-bindingsource-updates-datatable-but-rowstate-still-unchanged)

在每一行上调用 EndEdit

```
rOut.EndEdit(); 
```

解决了这个问题，但我不明白，我在任何文档中都没有看到。

# java - 从用 C# 编写的程序中获取数据到 Java 程序中

> ID：15839368
> 
> 赞同：3
> 
> 时间：2013-04-05T16:53:28.823
> 
> 标签：java, c#, executable, code-translation

我有一个用 C# 编写的程序，它从第三方服务器接收数据并将其处理成一系列整数（它们正在快速流式传输）。该程序是用 C# 编写的，因为第三方提供了类来处理数据，但仅在 C# 中提供它们。我想获取这些整数并在 Java 程序中以流的方式使用它们（因此，一旦它们被 C# 程序流式处理和处理，我想在 Java 程序中使用整数）。第二个程序是用 Java 编写的，因为另一个第三方只用 Java 提供他们的类（这是必需的）。所以我的猜测是——

1.  寻找一个在 Java 中运行 C# 类的程序，然后将处理传入数据的 C# 类直接包含到我的 Java 程序中 [这似乎不太有希望 - 我似乎无法获得 jni4net，这是在其他职位，工作]

或者

2.  用 C# 编写另一个程序，将正在处理的整数保存到特定的内存位置。编译程序。然后从 Java 源代码中运行可执行文件，并在 Java 代码中编写某种回调，当特定内存位置的整数发生更改时，该回调会拾取并记录这些新数字是什么[不知道如何开始！ ]

有没有人对什么可能是最不痛苦的方法有任何建议？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-05T16:58:43.493

听起来您想要某种形式的进程间通信机制。

因此，可以采用任何允许通信的方式：

1.  命名管道
2.  插座
3.  TCP 连接
4.  共享内存

在这些选项中，我会推荐命名管道，因为它们最容易掌握并且没有端口不可用等问题。

请参阅：[如何从 Java 打开 Windows 命名管道？](https://stackoverflow.com/questions/634564/how-to-open-a-windows-named-pipe-from-java)

并且：[在 C# 中为 IPC 使用命名管道](http://msdn.microsoft.com/en-us/library/bb546085.aspx)

这篇文章：[使用命名管道在 C# 和 Java 之间进行通信](http://v01ver-howto.blogspot.co.uk/2010/04/howto-use-named-pipes-to-communicate.html)描述了在两种环境中使用管道的端到端方式。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-05T17:27:02.637

过去我必须做类似的事情才能将数据从 Java 系统获取到 Excel（通过 RTD API），并最终使用套接字协议方法。

如果您有一个非常简单的数据集（如您上面提到的整数流），这应该非常简单 - 只需查看 Java Socket 和 ServerSocket 类的文档，以及相应的 C# Socket 类。

如果你最终得到一个更复杂的 API，包含多条消息等，你可能想看看 Google 协议缓冲区，因为周围有 .Net 和 Java 实现。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-05T17:03:21.420

您可以将 Java 和 C# 程序合并为一个，并使用 JNI 桥接 C#/Java 接口。JNI 基本上允许您从 Java 调用 C# 方法，反之亦然。我想这将同样难以编码为套接字，而且会有一些加速。

更多信息在这里： http: [//www.codeproject.com/Articles/245622/Using-the-Java-Native-Interface-in-Csharp](http://www.codeproject.com/Articles/245622/Using-the-Java-Native-Interface-in-Csharp)

# qt4 - 如何在终端中编译 Qt creator Gui 应用程序

> ID：15839373
> 
> 赞同：0
> 
> 时间：2013-04-05T16:53:46.573
> 
> 标签：qt4, cross-compiling

我正在尝试在 ubuntu 终端中交叉编译一个 qt creator 应用程序

/home/prabhu/backup/ToolChain/bin/arm-linux-gnueabi-g++ -I /home/prabhu/Downloads/iMX_For_Qt/qt-everywhere-opensource-src-4.7.3/include main.cpp mainwindow.cpp

这个过程正确吗？或者我们需要提到 mainwindow.ui

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-10T10:26:39.563

*   首先我们需要为 i.MX6 板类型配置 qt-everywhere-opensource-src-4.7.3 make make install 然后我们在文件系统中获得一个文件夹 例如：opt/qt-Arm 我们可以在“opt/”中找到 qmake 文件qt-Arm/qmake" 从 qt creator 我们提供 Tools->options->Qt4->Qt 版本，我们手动提供 qmake 位置。然后我们给出版本名称。使用我们的版本名称作为默认版本名称并编译 Qt 创建者应用程序。然后为 iMX 板编译应用程序。

# macos - pip 无法从 virtualenv 中找到发行版

> ID：15839375
> 
> 赞同：0
> 
> 时间：2013-04-05T16:53:52.227
> 
> 标签：macos, virtualenv, pip, virtualenvwrapper

我设置了一个新的 virtualenv。在其中，pip 找不到任何分布。在环境之外，它可以。这是输出：

```
(wagon-admin)[me@pjs-macbook-pro wagon-admin]$ pip install Django
Downloading/unpacking Django
  Could not fetch URL https://pypi.python.org/simple/Django/: There was a problem confirming the ssl certificate: <urlopen error [Errno 1] _ssl.c:480: error:0D0890A1:asn1 encoding routines:ASN1_verify:unknown message digest algorithm>
  Will skip URL https://pypi.python.org/simple/Django/ when looking for download links for Django
  Could not fetch URL https://pypi.python.org/simple/: There was a problem confirming the ssl certificate: <urlopen error [Errno 1] _ssl.c:480: error:0D0890A1:asn1 encoding routines:ASN1_verify:unknown message digest algorithm>
  Will skip URL https://pypi.python.org/simple/ when looking for download links for Django
  Cannot fetch index base URL https://pypi.python.org/simple/
  Could not fetch URL https://pypi.python.org/simple/Django/: There was a problem confirming the ssl certificate: <urlopen error [Errno 1] _ssl.c:480: error:0D0890A1:asn1 encoding routines:ASN1_verify:unknown message digest algorithm>
  Will skip URL https://pypi.python.org/simple/Django/ when looking for download links for Django
  Could not find any downloads that satisfy the requirement Django
No distributions at all found for Django
Storing complete log in /Users/me/.pip/pip.log 
```

我在 OSX 上，并使用`virtualenvwrapper`.`$ mkvirtualenv <env name>`

这发生在所有包上，而不仅仅是 django。

编辑：我在搜索中发现的唯一类似的东西：[https ://github.com/pypa/pip/issues/829](https://github.com/pypa/pip/issues/829)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-08T09:24:45.890

我有同样的问题，但意识到我没有激活我的 virtualenv。一旦我激活它，安装就成功了。不知道为什么。

查看您粘贴的命令行，您似乎激活了您的环境，但只是想为碰巧偶然发现的其他人注意这一点。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-09T20:55:43.360

我更新到 python 2.7，现在一切正常。

# excel - 条件格式单元格，如果它的值在表的列中找到

> ID：15839389
> 
> 赞同：3
> 
> 时间：2013-04-05T16:54:56.290
> 
> 标签：excel, duplicates, excel-2010, conditional-formatting

我认为这将非常简单：

```
=COUNTIF(Foo[Bar],$A1)>0 
```

将此应用于整个列，我认为会突出显示在表 Foo 的列栏中找到的任何单元格。但是excel告诉我我的公式包含一个错误，即使当我将它粘贴到一个单元格中时，它确实给了我一个正确的真/假值。

我想也许出于某种原因我需要将它复杂化为 excel 所以我尝试了：

```
 =COUNTIF(Foo[Bar],$A1) + CountIf(A1:A10000, $A1>1 
```

不知道我为什么尝试它，但我想为什么不尝试。不管是没有工作。

然后我继续责怪 Range (Foo[Bar]) 并尝试：

```
=COUNTIF($T$2:$T$1048576,$A1)>0 
```

它有效，这里的问题是该表的行数可以根据出天的进度从 1 变为任何值。我不想只使用 50000 作为数字，因为它可能并不总是足够好，而且大多数时候都超过了杀戮。并且当 A 列某天接近 100 万条记录并且表为 100,000 时，会导致永远刷新。

那么，如何动态有条件地格式化我的列以反映表格？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-12-04T05:57:33.700

尝试

```
=COUNTIF(INDIRECT("Foo[Bar]"),$A1)>0 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-06T02:25:04.040

也许（我没有测试过）它可以与命名范围一起使用。将名称 Foo[Bar] 命名为 CheckList 并使用类似`=MATCH($A1,CheckList,0)>0`CF 中的名称。这适用于在 [Bar] 下使用条目扩展的现有表，但我不确定在表更新时会发生什么，尽管在我的表顶部粘贴其他数据确实有效。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-06T03:35:28.067

尝试：

```
=COUNTIF(Foo[[#Data],[Bar]],$A1)>0 
```

或者如果你在这张表中，

```
=COUNTIF(Foo[[#Data],[Bar]],Foo[[#This Row],[A Header]])>0 
```

还有一个很好的资源是使用Excel 为您提供的[自动完成功能。](http://office.microsoft.com/en-us/excel-help/redir/HA010082293.aspx?CTT=5&origin=HA010155686)这将确保您的参考资料准确无误。

# sql-server-2008 - 替换字符串中某些变量的存储过程

> ID：15839391
> 
> 赞同：3
> 
> 时间：2013-04-05T16:54:59.830
> 
> 标签：sql-server-2008, tsql

我正在研究一个存储过程，它将接受一个字符串并返回一个新的文本字符串。输入参数是`@OrderId`并且`@OrderText`是一个带有美元符号封闭变量的字符串，就像这样......`$Order Name$ sent to $Customer$`

有效变量在一个`Variables`表中（订单名称、客户等值，总共 25 个应该保持相当静态）。变量在字符串中只能使用一次。

存储过程需要返回字符串，但将变量替换为各自的值。

示例 1

输入：`123, $Order Name$ sent to $Customer$`

回报：`Toolkit sent to StackCustomer Inc.`

示例 2

输入：`456, $Customer$ requests $delivery method$ for $order type$`

回报：`ABC Inc requests fast shipping for pallet orders.`

可以使用函数检索每个变量。

```
 DECLARE @OrderId int = 123
    DECLARE @InputText VARCHAR(500) = '$Order Name$ sent to $Customer$'
    select 
     @InputText = case when @InputText like '%$order name$%' 
             then replace(@InputText, '$Order Name$', getOrderName(id) else '' end,
     @InputText = case when @InputText like '%$customer$' 
             then replace(@InputText, '$Customer$', getCustomer(id) else '' end
      -- repeat 25 times 
```

有没有更好的办法？我主要关心的是可维护性 - 如果添加、重命名或删除变量，则需要更改此存储过程（尽管我被告知每年只会发生几次，如果那样的话）。在这种情况下，动态 sql 可以提供帮助吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-05T18:21:45.817

就个人而言，我会创建一个关键字表来维护它。像这样的东西

```
CREATE TABLE [keywords] (
  key_value VARCHAR(100) NOT NULL,
  function_value VARCHAR(100) NOT NULL
  )
INSERT INTO [keywords]
VALUES
('$Customer$','getCustomer(id)'),
('$Order Name$' ,'getOrderName(id)'),
('$order type$','getOrderType(id)') 
```

然后使用动态sql创建REPLACE SQL

```
DECLARE @OrderId int = 123
DECLARE @InputText VARCHAR(500) = '$Order Name$ sent to $Customer$'

DECLARE @sql VARCHAR(8000) = 'SELECT '

SELECT 
  @sql = @sql + 
  ' @InputText = replace(@InputText, ''' + key_value + ''', ' + function_value + ')'
    + ' ,'
FROM keywords
WHERE  @InputText LIKE '%' + key_value + '%'

SELECT @sql = LEFT(@sql, LEN(@sql) -1)
PRINT @sql

EXEC(@sql) 
```

[SQLFiddle](http://sqlfiddle.com/#!3/3adc3/17)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-05T18:21:47.860

如果要在过程中使用输入变量，我真的不明白为什么需要进行标记化。

SQL Management Studio 已经有以下形式的令牌模板可用：

```
<(tokenName),(datatype),(defaultvalue)> 
```

您可以使用 CTRL + SHIFT + M 或在 2012 年使用 ALT > Q > S 直接使用 SQL Managment Studio 填充他们的数据，或者通过文本在环境中查找它们的值。

如果您尝试输入一个输入以供外部开发平台访问，该平台会更改 ADO.NET 或 C#/VB.NET 中的实体框架等字符串，我仍然不明白为什么您不只是制作更多输入变量。

你可以很容易地做到这一点：

```
Declare @OrderPlace varchar(128), @Customer varchar(64), @StringCombine varchar(512);

Select 
   @OrderPlace = 'Place I am at'
,  @Customer = 'Mr Customer';

Select @StringCombine = @Customer + ' order at ' + @OrderPlace 
```

然后，如果另一种语言访问您的 SQL 服务器过程，则只需输入两个参数 @Customer 和 @OrderPlace。您甚至可以将 @StringCombine 设置为输出变量。这比文本替换字符然后运行字符串更可取。这可能会导致 SQL 注入攻击，因此清理输入是返回数据的重要组成部分，特别是如果您要在 SQL 运行之前更改某些内容以使其运行。

您提到了可维护性，这更加健壮，因为如果我将逻辑更改为 proc 但不更改变量名称，我不必更改任何其他内容。如果我必须更改 ADO.NET 或其他库以获取引用，然后更改 SQL 代码，那就需要做更多的工作。通常，在使用令牌时，我会努力重用代码，其中一部分可能会下降，只会损害它的那一部分，而不是把整个事情都搞砸。

# c# - 操作无法完成，因为 DbContext 已被释放

> ID：15839393
> 
> 赞同：0
> 
> 时间：2013-04-05T16:55:08.573
> 
> 标签：c#, mysql, asp.net-mvc

这个问题已经被问过很多次了，但我仍然不明白为什么我一直收到这个错误。

在我的控制器中，我有这个方法：

```
//
// POST : /ObjectProducer/Edit/5
[HttpPost]
public ActionResult Edit(OBJECT_PRODUCER _objProd)
{
    if (ModelState.IsValid)
    {
        m_Db.Entry(_objProd).State = EntityState.Modified;
        m_Db.SaveChanges();
        return RedirectToAction("SearchIndex");
    }

    return View(_objProd);
} 
```

但是当我打`m_Db.Entry(_objProd).State = EntityState.Modified;`线时，就会发生错误。谁能向我解释有什么问题？

** 编辑 **

这是启动“编辑”方法的控制器方法（“GET”方法）

```
//
// GET : /PriceProvider/Edit
public ActionResult Edit(int id = 0)
{
    OBJECT_PRODUCER objProd = m_ProductManager.GetObjProdByID(id);

    if (objProd == null)
    {
        ViewData["ErrorMessage"] = m_NoDataFound;
    }

    return View(objProd);
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-05T18:17:07.880

我认为您需要执行几个步骤，这应该可以解决您的问题：

1.  在从用户提交时，您需要从用户正在编辑的 dbContext 中获取实体。
2.  然后根据用户提交的实体从 dbContext 更新实体上的值。

我正在使用 Entity Framework 5，这是我用来根据用户提交的更新实体更新原始实体的代码：

```
public virtual void Update(TEntity entityToUpdate, TEntity originalEntity)
    {
        ctx.Entry(originalEntity).CurrentValues.SetValues(entityToUpdate);
    } 
```

所以我认为在你的情况下：

```
public ActionResult Edit(OBJECT_PRODUCER _objProd)
{
    if (ModelState.IsValid)
    {
        //this line might not be quite right, but basically 
        //get the entity from dbContext based on the id of the submitted object
        OBJECT_PRODUCER originalFromDbContext = m_Db.GetById(_objProd.Id);

        //set the values for the Entity retrieved from m_Db to the new values
        //submitted by the user
        m_Db.Entry(originalFromDbContext).CurrentValues.SetValues(_objProd);

        m_Db.SaveChanges(); //save changes
        return RedirectToAction("SearchIndex");
    }
    return View(_objProd);
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-05T17:01:09.770

尝试从 m_Db 重新获取 _objProd 实体。您在帖子中获得的内容实际上并不是您当前数据上下文的一部分，它来自编辑的获取版本中使用的数据上下文。

```
var _newObjProd = m_Db.GetObjProdByID(_objProd.ID); 
```

基本上，实体在两个 DataContext 中表现不佳。您需要在新的数据上下文中再次加载实体。

# xslt - XSLT 将属性转换为元素并从其他元素复制值

> ID：15839395
> 
> 赞同：0
> 
> 时间：2013-04-05T16:55:13.250
> 
> 标签：xslt, attributes, copy, element

我有这样的 XML 数据

```
<ABC version="1.0">
  <XYZ>
    <ROWSET ROWS="00001">
      <ROWDEF>
        <COLUMN ID="ACCT_ID" LEN="016" NULL="Y"/>
        <COLUMN ID="AGNT_ID" LEN="004" NULL="Y"/>
        <COLUMN ID="CUST_EXTR_ID" LEN="024" NULL="Y"/>
        <COLUMN ID="PI_ID" LEN="019" NULL="Y"/>
        <COLUMN ID="PRIN_ID" LEN="004" NULL="Y"/>
        <COLUMN ID="SYS_ID" LEN="004" NULL="Y"/>
      </ROWDEF>
      <ROW>
        <C>6369921501000060</C>
        <C>0000</C>
        <C>C13093102141063422034238</C>
        <C>6369921501000060   </C>
        <C>1500</C>
        <C>9008</C>
      </ROW>
      <ROW>
        <C>6369921501000061</C>
        <C>0001</C>
        <C>C13093102141063422034231</C>
        <C>6369921501000060   </C>
        <C>1501</C>
        <C>9001</C>
      </ROW>
    </ROWSET>
  </XYZ>
</ABC> 
```

我正在尝试将其转换为

```
<?xml version="1.0" encoding="utf-8"?>
<ABC version="1.0">
  <XYZ RC="0067">
    <ROWSET ROWS="00001">
      <ROWDEF>
        <ACCT_ID>6369921501000060</ACCT_ID>
        <AGNT_ID>0000</AGNT_ID>
        <CUST_EXTR_ID>C13093102141063422034238</CUST_EXTR_ID>
        <PI_ID>6369921501000060</PI_ID>
        <PRIN_ID>1500</PRIN_ID>
        <SYS_ID>9008</SYS_ID>
      </ROWDEF>
      <ROWDEF>
        <ACCT_ID>6369921501000061</ACCT_ID>
        <AGNT_ID>0001</AGNT_ID>
        <CUST_EXTR_ID>C13093102141063422034231</CUST_EXTR_ID>
        <PI_ID>6369921501000060</PI_ID>
        <PRIN_ID>1501</PRIN_ID>
        <SYS_ID>9001</SYS_ID>
      </ROWDEF>
    </ROWSET>
  </XYZ>
</ABC> 
```

我环顾四周并尝试了几件事，但它不起作用。有人可以帮我弄这个吗。下面是我的 XSLT。提前致谢。

```
<?xml version="1.0" encoding="utf-8"?>

<xsl:stylesheet version="1.0"
  xmlns:xsl="http://www.w3.org/1999/XSL/Transform">

  <xsl:output method="xml" version="1.0" encoding="utf-8" indent="yes"/>

  <xsl:template match="@* | node()">
    <xsl:copy>
      <xsl:apply-templates select="@* | node()" />
    </xsl:copy>
  </xsl:template>

  <xsl:template match="COLUMN">
    <xsl:element name="{@ID}">
      <xsl:copy>
        <xsl:apply-templates select="node()"></xsl:apply-templates>
      </xsl:copy>
      <xsl:apply-templates />
      <!--<xsl:call-template name="value"></xsl:call-template>-->
    </xsl:element>
  </xsl:template>

  <!--
  <xsl:template match="ROW" name="value">
    <xsl:copy>
      <xsl:apply-templates select="node()"></xsl:apply-templates>
    </xsl:copy>
  </xsl:template>
  -->

</xsl:stylesheet> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-05T17:45:01.237

该样式表将主要执行您想要的操作，但我无法理解如何为`<XYZ RC="0067">`.

对于`ROWSET`遇到的每一个元素，它都将`ROWDEF`元素保存在一个变量中，复制所有属性节点，然后处理每个`ROW`元素。计算每个`C`元素在 中的位置`ROW`，并且`COLUMN`在存储的元素中的相应位置中的用于从属性`ROWDEF`中获取元素名称。`ID`

```
<?xml version="1.0" encoding="utf-8"?>

<xsl:stylesheet version="1.0"
  xmlns:xsl="http://www.w3.org/1999/XSL/Transform">

  <xsl:output method="xml" version="1.0" encoding="utf-8" indent="yes"/>
  <xsl:strip-space elements="*"/>

  <xsl:template match="@* | node()">
    <xsl:copy>
      <xsl:apply-templates select="@* | node()" />
    </xsl:copy>
  </xsl:template>

  <xsl:template match="ROWSET">

    <xsl:variable name="columns" select="ROWDEF/COLUMN"/>

    <xsl:copy>

      <xsl:apply-templates select="@*" />

      <xsl:for-each select="ROW">
        <ROWDEF>
          <xsl:for-each select="C">
            <xsl:variable name="pos" select="position()"/>
            <xsl:element name="{$columns[$pos]/@ID}">
              <xsl:value-of select="."/>
            </xsl:element>
          </xsl:for-each>
        </ROWDEF>
      </xsl:for-each>

    </xsl:copy>

  </xsl:template>

</xsl:stylesheet> 
```

**输出**

```
<?xml version="1.0" encoding="utf-8"?>
<ABC version="1.0">
   <XYZ>
      <ROWSET ROWS="00001">
         <ROWDEF>
            <ACCT_ID>6369921501000060</ACCT_ID>
            <AGNT_ID>0000</AGNT_ID>
            <CUST_EXTR_ID>C13093102141063422034238</CUST_EXTR_ID>
            <PI_ID>6369921501000060   </PI_ID>
            <PRIN_ID>1500</PRIN_ID>
            <SYS_ID>9008</SYS_ID>
         </ROWDEF>
         <ROWDEF>
            <ACCT_ID>6369921501000061</ACCT_ID>
            <AGNT_ID>0001</AGNT_ID>
            <CUST_EXTR_ID>C13093102141063422034231</CUST_EXTR_ID>
            <PI_ID>6369921501000060   </PI_ID>
            <PRIN_ID>1501</PRIN_ID>
            <SYS_ID>9001</SYS_ID>
         </ROWDEF>
      </ROWSET>
   </XYZ>
</ABC> 
```

# asp.net - 如何将 ButtonField 存储在为 ButtonField 设置列的数据行中

> ID：15839399
> 
> 赞同：0
> 
> 时间：2013-04-05T16:55:30.890
> 
> 标签：asp.net, gridview, datarow, buttonfield

考虑以下代码

```
protected void Button1_Click(object sender, EventArgs e)
    {
        DataTable dt = new DataTable();
        DataColumn dtCol = new DataColumn();

        dtCol = new DataColumn("Name", typeof(string));
        dt.Columns.Add(dtCol);

        dtCol = new DataColumn("Address", typeof(string));
        dt.Columns.Add(dtCol);

        dtCol = new DataColumn("Account No", typeof(ButtonField));
        dt.Columns.Add(dtCol);

        ButtonField bfname = new ButtonField {
            HeaderText = "Account No",
            DataTextField="Account No",
            Text = "Klik", 
            ButtonType = ButtonType.Link, 
            CommandName = "ExecuteMe" };

        string[] strDataRow = new string[3];

        for (int intX = 0; intX < 10; intX++)
        {
            strDataRow[0] = "Name" + Convert.ToString(intX);
            strDataRow[1] = "Address" + Convert.ToString(intX);
            strDataRow[2] = bfname.Text; //Error Type of value has a mismatch with column typeCouldn't store <Account No0> in Account No Column.  Expected type is ButtonField.
            ButtonField btnField = bfname; // No Error but not appear in GridView1

            dt.Rows.Add(new object[] {strDataRow[0], strDataRow[1], strDataRow[2]});
            //dt.Rows.Add(new object[] { strDataRow[0], strDataRow[1], btnField }); // No Error but not appear in GridView1

            /* Error Message on strDataRow[2]
            Type of value has a mismatch with column typeCouldn't store <Account No0> in Account No Column.  Expected type is ButtonField.
             */

        }

        GridView1.DataSource = dt;
        GridView1.DataBind();

    } 
```

如何将 ButtonField 存储在为 ButtonField 设置列的数据行中。ButtonField.Text 如何出现在每个 DataRow 中

和

是否可以将字符串值存储在为 ButtonField 设置的列的数据行中。当字符串为 click 时，将执行 ButtonField.CommandName。

注意*：ASPX 页面中的 GirdView 代码如下。

```
<asp:GridView ID="GridView1" runat="server">
    </asp:GridView> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-05T17:16:08.863

我不确定您的问题，但不是将按钮放在 DataTable 中，而是我认为不可能的事情，为什么不创建一个 GridView 并添加一个包含您的按钮的 TemplateField。

# iphone - ECSlidingViewController 推送数据到表格视图

> ID：15839401
> 
> 赞同：1
> 
> 时间：2013-04-05T16:55:35.137
> 
> 标签：iphone, ios, storyboard, segue

我正在尝试使用 github 上提供的 ECSlidingViewController：

[https://github.com/edgecase/ECSlidingViewController](https://github.com/edgecase/ECSlidingViewController)

无论如何，我想知道如何将数据从菜单视图控制器推送到示例表视图控制器，因为没有 segue。导航控制器通过故事板实例化，但我看不到将任何数据从视图推送到另一个视图的方法。

我现在与代表一起尝试过，但似乎我的代表由于某种我不知道的原因没有解雇。TableView 保持为空。我错过了什么？

请看下面的代码：

```
//MenuviewController.h

#import <UIKit/UIKit.h>
#import "ECSlidingViewController.h"

@protocol TableData <NSObject>

- (void) someData:(NSString*)data;

@end

@interface MenuViewController : UIViewController <UITableViewDataSource, UITabBarControllerDelegate>{

    __unsafe_unretained id <TableData> delegate;
}

@property (nonatomic,assign) id <TableData> delegate;

@end

//MenuViewController.m

#import "MenuViewController.h"

@interface MenuViewController()
@property (nonatomic, strong) NSArray *menuItems;
@end

@implementation MenuViewController
@synthesize menuItems, delegate;

- (void)awakeFromNib
{
  self.menuItems = [NSArray arrayWithObjects:@"First", @"Second", @"Third", @"Navigation", nil];
}

- (void)viewDidLoad
{
  [super viewDidLoad];

  [self.slidingViewController setAnchorRightRevealAmount:280.0f];
  self.slidingViewController.underLeftWidthLayout = ECFullWidth;

}

- (NSInteger)tableView:(UITableView *)tableView numberOfRowsInSection:(NSInteger)sectionIndex
{
  return self.menuItems.count;
}

- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath
{
  NSString *cellIdentifier = @"MenuItemCell";
  UITableViewCell *cell = [tableView dequeueReusableCellWithIdentifier:cellIdentifier];
  if (cell == nil) {
    cell = [[UITableViewCell alloc] initWithStyle:UITableViewCellStyleSubtitle reuseIdentifier:cellIdentifier];
  }

  cell.textLabel.text = [self.menuItems objectAtIndex:indexPath.row];

  return cell;
}

- (void)tableView:(UITableView *)tableView didSelectRowAtIndexPath:(NSIndexPath *)indexPath
{
  NSString *identifier = [NSString stringWithFormat:@"%@Top", [self.menuItems objectAtIndex:indexPath.row]];

  UIViewController *newTopViewController = [self.storyboard instantiateViewControllerWithIdentifier:identifier];

    if ([delegate respondsToSelector:@selector(someData:)]) {
        [delegate someData:@"Hello World"];
    }

  [self.slidingViewController anchorTopViewOffScreenTo:ECRight animations:nil onComplete:^{
    CGRect frame = self.slidingViewController.topViewController.view.frame;
    self.slidingViewController.topViewController = newTopViewController;
    self.slidingViewController.topViewController.view.frame = frame;
    [self.slidingViewController resetTopView];
  }];
}

@end

//SampleTableViewController.h

#import <UIKit/UIKit.h>
#import "ECSlidingViewController.h"
#import "MenuViewController.h"

@interface SampleTableViewController : UITableViewController <UITableViewDataSource, UITabBarControllerDelegate, TableData>

- (IBAction)revealMenu:(id)sender;

@end

//SampleTableViewController.m

#import "SampleTableViewController.h"

@interface SampleTableViewController()
@property (nonatomic, strong) NSArray *sampleItems;
@end

@implementation SampleTableViewController
@synthesize sampleItems;

- (void)awakeFromNib
{
  //self.sampleItems = [NSArray arrayWithObjects:@"One", @"Two", @"Three", nil];
}

- (void) someData:(NSString *)data{

    sampleItems = [NSArray arrayWithContentsOfFile:data];
}

- (NSInteger)tableView:(UITableView *)tableView numberOfRowsInSection:(NSInteger)sectionIndex
{
  return self.sampleItems.count;
}

- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath
{
  NSString *cellIdentifier = @"SampleCell";
  UITableViewCell *cell = [tableView dequeueReusableCellWithIdentifier:cellIdentifier];
  if (cell == nil) {
    cell = [[UITableViewCell alloc] initWithStyle:UITableViewCellStyleSubtitle reuseIdentifier:cellIdentifier];
  }

  cell.textLabel.text = [self.sampleItems objectAtIndex:indexPath.row];

  return cell;
}

- (IBAction)revealMenu:(id)sender
{
  [self.slidingViewController anchorTopViewTo:ECRight];
}

- (BOOL)shouldAutorotateToInterfaceOrientation:(UIInterfaceOrientation)toInterfaceOrientation
{
  return YES;
}

@end 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-05T17:30:31.750

我建议使用代表。这是一个示例：[委托示例](http://www.roostersoftstudios.com/2011/04/12/simple-delegate-tutorial-for-ios-development/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-07T17:37:22.090

我终于发现了。

这是一个例子。

```
UINavigationController *navigationController = [self.storyboard instantiateViewControllerWithIdentifier:identifier];
MBFancyViewController *viewController = navigationController.viewControllers[0];
//or alternative
MBFancyViewController *viewController = (MBFancyViewController *)navigationController.topViewController;
// setup "inner" view controller
viewController.foo = bar;

[self presentViewController:navigationController animated:YES completion:nil]; 
```

# r - 遍历列表中的序列对象？

> ID：15839403
> 
> 赞同：2
> 
> 时间：2013-04-05T16:05:05.530
> 
> 标签：r, data-manipulation, traminer

我有一个包含 24 个`TraMineR`序列对象的列表。现在我想计算每个序列对象的最佳匹配距离（仅在每个对象内）并将其存储在一个新列表中，现在由 24 个 OM 距离对象（距离矩阵）组成。

数据集可以在[这里](https://dl.dropbox.com/u/3674946/event-stream-20-l-m.csv)找到。

```
library(TraMineR)
sequences <- read.csv(file = "event-stream-20-l-m.csv", header = TRUE, nrows=10)
repo_names = colnames(sequences)

# 1\. Loop across and define the 24 sequence objects & store them in sequence_objects
colpicks <- seq(10,240,by=10)
sequence_objects <- mapply(function(start,stop) seqdef(sequences[,start:stop]), colpicks-    9, colpicks)

# 2\. Calculate the costs for OM distances within each object 
costs <- mapply(seqsubm(sequence_objects, method="TRATE"))

# 3\. Calculate the OM distance objects for each sequence object
sequences.om <- seqdist(sequence_objects, method="OM", indel=1, sm=costs, with.missing=FALSE, norm="maxdist") 
```

步骤 (1) 工作正常，但是当我进行到步骤 (2) 时，它告诉我：

```
Error in seqsubm(sequence_objects, method = "TRATE") : 
[!] data is NOT a sequence object, see seqdef function to create one 
```

这是很自然的，因为`sequence_objects`不是序列对象，而是序列对象的列表。

如何将该`seqsubm`函数应用于序列对象列表？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-05T17:52:46.337

我不熟悉这个`TraMineR`包，但是看起来你正在尝试迭代`sequence_objects`.

`mapply`用于同时迭代多个对象。
`lapply`相反，用于迭代单个对象。

因此，以下内容可能对您有用：

```
 costs <- lapply(sequence_objects, seqsubm, method="TRATE") 
```

# c# - MSMQ 导致 Windows 8 崩溃并出现 BSOD

> ID：15839406
> 
> 赞同：7
> 
> 时间：2013-04-05T16:56:06.733
> 
> 标签：c#, windows-8, msmq

我使用 Windows 8 Pro、C# 和 .NET 4.5

我使用 MSMQ 在远程机器上读取或查看或发送消息，但它会导致操作系统蓝屏...

在本地没有问题，但只有当我尝试通过代码使用 msmq 访问远程机器时。

该代码在 XP/Seven 和 Server 2008/2012 下完美运行

这是一个小样本：

```
var messageQueue = new MessageQueue(string.Concat("FormatName:DIRECT=", addressType, ":", _queueServer, @"\private$\", _queueName), false, false, QueueAccessMode.Receive);

messageQueue.Receive() => BSOD!!! 
```

有人有修复或解释吗？

谢谢，

亲切的问候。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-05T18:37:45.203

如果你进入 C:\windows\minidump

然后使用“Windows 调试工具”打开 *.dmp 文件

这应该可以更深入地了解问题的性质。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-10T10:19:25.710

我找到了！！！

MSMQ 4.0 随 windows server 2008 一起提供，任何操作系统的最后一次更新默认使用 ipv6。因此，您必须停用 IPV6 以防止其他操作系统在 Windows 8 事件下的 BSOD，您必须停用它才能读取远程队列！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-25T12:25:37.590

dnx：你的意思是在远程机器上还是在你自己的本地机器上禁用 ipv6？

# c++ - 不使用 FOR/WHILE 循环逐行读取文件

> ID：15839407
> 
> 赞同：0
> 
> 时间：2013-04-05T16:56:07.450
> 
> 标签：c++, file, c++11, iterator

嘿伙计们，这对你们所有人来说都是一个有趣的挑战。我得到了一个文本文件，我应该逐行处理信息。只要我能获得单独的线条，处理部分就很简单。然而，挑战在于：

1.  我必须这样做，而不要在我的代码中使用任何 FOR/WHILE 循环。（这包括递归）
2.  我只被允许使用标准 C++ 库。

目前我最好的解决方案是： [是否有可以逐行迭代文件的 C++ 迭代器？](https://stackoverflow.com/questions/2291802/is-there-a-c-iterator-that-can-iterate-over-a-file-line-by-line) 但我希望有一个更好的，不涉及创建我自己的迭代器类或为 std::string 实现代理。

PS这是一个学校作业，这里的挑战是使用标准功能和算法的组合来解决问题，但我不知道如何去解决它

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-05T17:05:50.127

```
ifstream input("somefile")

if (!input) { /* Handle error */ }

//MyDataType needs to implement an operator>>

std::vector<MyDataType> res;

std::istream_iterator<MyDataType> first(input);
std::istream_iterator<MyDataType> last;
std::copy(first,last, std::back_inserter(res));

//etc.. 
```

您的输入运算符可以是这样的：

```
std::istream& operator>>(std::istream &in,MyDataType & out)
{
    std::string str;
    std::getline(in,str);
    //Do something with str without using loops
    return in;
} 
```

这里有很多循环（你不想使用`goto`，不是吗？），但它们都隐藏在后面`std::copy`并且`std::getline`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-05T18:03:40.907

这只是一个玩具。

它包括一个基于生成器的文件（我发现它很容易编写），以及一个将生成器转换为迭代器的半工作适配器。

在这种情况下，生成器是一个函子，它接受一个 lambda，并将该 lambda 传递给迭代的事物并返回 true，或者返回 false。它形成了一个非常短的循环：

```
while( gen( [&]( std::string line ) {
  // code using line goes here
} ) ); // <- notice that this is an empty while loop that does stuff 
```

但你不能使用它。（这个设计的灵感来自于 python 生成器，老实说，我发现它比 C++ 迭代器更自然地处理多种问题，包括从文件中读取）。

adpator 接受这个生成器并将其变成一个迭代器，所以你可以将它传递给`for_each`.

重点是您的问题本身是空洞的，因此我建议不要做一些明显的事情（转到，或直接`for_each`在 istream 迭代器上使用），而是要搞乱一些迟钝和不同的事情。:)

Line 生成器又好又短：

```
struct LineGenerator {
  LineGenerator(std::ostream& os_):os(&os_) {}
  std::ostream* os;
  template<typename F>
  bool operator()(F&& func) {
    std::string s;
    bool bRet = std::getline( *os, s );
    if (!bRet) return false;
    std::forward<F>(func)(s);
    return true;
  }
}; 
```

另一方面，适配器非常混乱：（未经测试）

```
template<typename Generator>
struct generator_iterator {
  typedef generator_iterator<Generator> my_type;
  typedef typename std::decay< decltype( std::declval<Generator>()() ) >::type value_type;
  Generator g;
  bool bDone;
  value_type val;
  generator_iterator( Generator g_ ):g(g_), bDone(false) {
    next();
  }
  generator_iterator(): bDone(true) {}
private:
  void next() {
    if (bDone) return;
    bDone = g(val);
  }
public:
  generator_iterator& operator++() {
    next();
    return *this;
  }
  value_type operator*() {
    return val;
  }
  const value_type operator*() const {
    return val;
  }
  value_type* operator->() {
    return &val;
  }
  value_type const* operator->() const {
    return &val;
  }
  bool operator==( my_type const& o ) {
    if (bDone != o.bDone) return false;
    if (!bDone && !o.bDone) return true;
    return false;
  }
};
template<typename Generator>
generator_iterator<Generator> make_gen_it( Generator&& g ) {
  return generator_iterator<Generator>( std::forward<Generator>(g) );
}
template<typename Generator>
generator_iterator<Generator> make_end_gen_it() {
  return generator_iterator<Generator>();
} 
```

我希望这很有趣！

# mysql - mysql查询在平均时加入1个表中的3个查询

> ID：15839408
> 
> 赞同：0
> 
> 时间：2013-04-05T16:56:07.420
> 
> 标签：mysql, join, average

我有 3 个非常大的表，每分钟记录一次值，下面是这些表的*摘录*。

我想获得这些表**1 天**的每小时平均值，并根据时间加入它们，请注意 ph 和温度的日志时间之间有几秒钟的差距

***表 PH***（仅提取，此表非常大，有超过 130,000 个值）

```
 ID      time                Ph

    72176   2013-04-06 03:29:34 7.58
    72177   2013-04-06 03:30:34 7.58
    72178   2013-04-06 03:31:34 7.54
    72179   2013-04-06 03:32:34 7.58
    72180   2013-04-06 03:33:34 7.58
    72181   2013-04-06 03:34:34 7.58
    72182   2013-04-06 03:35:34 7.54
    72183   2013-04-06 03:36:34 7.58
    72184   2013-04-06 03:37:34 7.54
    72185   2013-04-06 03:38:34 7.58
    72186   2013-04-06 03:39:34 7.58 
```

***表 temperature1***（仅提取，此表非常大，超过 130,000 个值）

```
 ID      time            temperature

133312  2013-04-06 03:29:36 25.37
133313  2013-04-06 03:30:36 25.37
133314  2013-04-06 03:31:36 25.37
133315  2013-04-06 03:32:36 25.31
133316  2013-04-06 03:33:36 25.31
133317  2013-04-06 03:34:36 25.31
133318  2013-04-06 03:35:36 25.37
133319  2013-04-06 03:36:36 25.31
133320  2013-04-06 03:37:36 25.31
133321  2013-04-06 03:38:36 25.31
133322  2013-04-06 03:39:36 25.37 
```

***表格实体***（仅提取，此表格非常大，包含超过 130,000 个值）

```
 ID      time            solids

123791  2013-04-06 03:29:49 140
123792  2013-04-06 03:30:49 140
123793  2013-04-06 03:31:49 143
123794  2013-04-06 03:32:49 140
123795  2013-04-06 03:33:49 140
123796  2013-04-06 03:34:49 140
123797  2013-04-06 03:35:49 140
123798  2013-04-06 03:36:49 143
123799  2013-04-06 03:37:49 140
123800  2013-04-06 03:38:49 140
123801  2013-04-06 03:39:49 140 
```

我目前正在使用以下查询获取每小时平均值

```
SELECT DATE_FORMAT(x.time,'%Y-%m-%d %H:00:00')
     , avg(x.solids) avg_solids
  FROM solids x where time >= NOW() - INTERVAL 1 DAY
 GROUP 
    BY DATE_FORMAT(x.time,'%Y-%m-%d %H:00:00'); 
```

如何有效地加入（相对于时间）每个传感器（x3）的上述查询结果，以显示在 1 个表中

================================

下面的这个查询获取每小时的值，但不知道如何调整它以获得每小时的平均值

```
SELECT DATE_FORMAT(timeTable.minuteTime, '%Y-%m-%d %k:%i') time,
(oT2.temperature) temperature,
(T2.temperature) temp,
(S2.solids) solids,
(P2.Ph) Ph

FROM
(
    SELECT minuteTime.minuteTime minuteTime,
    ( SELECT MAX(time) FROM outside_temperature WHERE time <= minuteTime.minuteTime AND time >= NOW() - INTERVAL 1 DAY) otempTime, 
    ( SELECT MAX(time) FROM temperature1 WHERE time <= minuteTime.minuteTime AND time >= NOW() - INTERVAL 1 DAY) tempTime, 
    ( SELECT MAX(time) FROM Ph WHERE time <= minuteTime.minuteTime AND time >= NOW() - INTERVAL 1 DAY) phTime,  
    ( SELECT MAX(time) FROM solids WHERE time <= minuteTime.minuteTime AND time >= NOW() - INTERVAL 1 DAY) solidsTime

    FROM  
    (
        SELECT DATE(time) + INTERVAL (HOUR(time) DIV 1 *1 ) HOUR minuteTime
        FROM Ph
        WHERE time >= NOW() - INTERVAL 1 DAY AND time <= NOW()
        UNION SELECT DATE(time) + INTERVAL (HOUR(time) DIV 1 *1) HOUR
        FROM solids
        WHERE time >= NOW() - INTERVAL 1 DAY AND time <= NOW()
        UNION SELECT DATE(time) + INTERVAL (HOUR(time) DIV 1 *1) HOUR
        FROM outside_temperature
        WHERE time >= NOW() - INTERVAL 1 DAY AND time <= NOW()
        UNION SELECT DATE(time) + INTERVAL (HOUR(time) DIV 1 *1) HOUR
        FROM temperature1
        WHERE time >= NOW() - INTERVAL 1 DAY AND time <= NOW()
        GROUP BY 1
    ) minuteTime
) timeTable
LEFT JOIN outside_temperature oT2 ON oT2.time = timeTable.otempTime
LEFT JOIN temperature1 T2 ON T2.time = timeTable.tempTime
LEFT JOIN solids S2 ON S2.time = timeTable.solidsTime
LEFT JOIN Ph P2 ON P2.time = timeTable.phTime

GROUP BY DATE_FORMAT(timeTable.minuteTime, '%Y-%m-%d %k:%i') 
ORDER BY minuteTime ASC 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-05T18:05:20.520

[Hour()](http://dev.mysql.com/doc/refman/5.1/en/date-and-time-functions.html#function_hour)似乎对此很有用，因为您只查看一天。也许这样的事情对你有用：

```
SELECT * FROM
 (SELECT HOUR(time) hour, avg(ph) AS avg_ph
  FROM ph 
  WHERE time >= NOW() - INTERVAL 1 DAY
  GROUP BY hour) p
JOIN 
 (SELECT HOUR(time) hour, avg(temperature) AS avg_temp
  FROM temperature1 
  WHERE time >= NOW() - INTERVAL 1 DAY
  GROUP BY hour) t ON t.hour = p.hour
JOIN 
 (SELECT HOUR(time) hour, avg(solids) AS avg_solids
  FROM solids 
  WHERE time >= NOW() - INTERVAL 1 DAY
  GROUP BY hour) s ON s.hour = p.hour; 
```

由于它使用的是内部连接，我假设每个表一小时内总是至少有一条记录，但这似乎是一个合理的假设。

# c++ - boost::optional 会触发 shared_ptr 上的引用计数吗？

> ID：15839409
> 
> 赞同：3
> 
> 时间：2013-04-05T16:56:12.280
> 
> 标签：c++, boost, shared-ptr

我正在尝试获取一个函数来从我的地图中返回一个可选值。所以是这样的：

```
boost::optional<V> findValue(const K& key) {
    boost::optional<V> ret;
    auto it = map.find(key);
    if (it != map.end()) {
        ret = it->second;
    }
    return ret;
} 
```

如果`V`碰巧是`shared_ptr`某种类型，那么分配是否会`ret`触发引用计数？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-05T16:58:52.667

是的，它必须。`boost::optional`存储一个副本，因此对于 a `shared_ptr`，这意味着有一个副本`shared_ptr`并且这意味着必须增加引用计数。

请注意，只要 为`boost::optional`空，即它不包含 的值`shared_ptr`，就没有对象的引用计数被摆弄。换句话说，空`boost::optional`不包含 (empty or else *)*`shared_ptr`。

请求的“语义”不能真正起作用，因为您`shared_ptr`在地图中保留了一个并返回一个`shared_ptr`.

但是，您可以返回`boost::optional<const V&>`：

```
boost::optional<const V&> findValue(const K& key) {
    auto it = map.find(key);
    if (it != map.end()) {
        return boost::optional<const V&>( it->second );
    }
    return boost::optional<const V&>();
} 
```

但请确保参考在您保留/使用时保持有效。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-05T16:58:29.323

是的。复制共享指针，在这种情况下，通过复制初始化`optional`对象中包含的指针，将增加使用计数。

# javascript - 我应该把 AngularJS 工厂和服务放在哪里？

> ID：15839410
> 
> 赞同：11
> 
> 时间：2013-04-05T16:56:12.563
> 
> 标签：javascript, html, angularjs

我正在努力根据最佳实践清晰地构建我的 AngularJS 应用程序，其中包括将控制器和应用程序分离到不同的脚本文件中。

快速提问：**我应该把我的工厂和服务放在哪里？**我问的是在单个控制器范围之外访问的工厂和服务以及在单个控制器范围内访问的一些工厂和服务。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-04-05T17:09:23.333

**更新：下面的直接答案不再正确。请参阅此答案的最新附录（2015 年 3 月 1 日编写）。**

知道了！根据 Brian Ford 关于[构建 Huuuuuuuge Angular Apps](http://briantford.com/blog/huuuuuge-angular-apps.html)的文章，最佳实践似乎是将服务和工厂连接到单独文件中的应用程序，如下所示：

```
root-app-folder
├── index.html
├── scripts
│   ├── controllers
│   │   └── main.js
│   │   └── ...
│   ├── directives
│   │   └── myDirective.js
│   │   └── ...
│   ├── filters
│   │   └── myFilter.js
│   │   └── ...
│   ├── services
│   │   └── myService.js
│   │   └── ...
│   ├── vendor
│   │   ├── angular.js
│   │   ├── angular.min.js
│   │   ├── es5-shim.min.js
│   │   └── json3.min.js
│   └── app.js
├── styles
│   └── ...
└── views
    ├── main.html
    └── ... 
```

（PSST！如果您想知道，Brian Ford 是 AngularJS 团队的一员，所以他的回答似乎很合理。）

**补充（2013 年 4 月 24 日）**

这就是：**[Yeoman](http://yeoman.io/)**是一个很棒的工具，可以为大型功能性 Angular 应用程序生成具有适当目录结构的应用程序。它甚至包含**[Grunt](http://gruntjs.com/)** & **[Bower](http://bower.io/)**！

**附录（2015 年 3 月 1 日）**

根据PaoloCargnin[的评论](https://stackoverflow.com/questions/15839410/where-should-i-put-angularjs-factories-services/15839611#comment45807241_15839611)[，](https://stackoverflow.com/users/2594354/paolocargnin) Google 实际上推荐了一种不同的结构，如[本文](https://docs.google.com/document/d/1XXMvReO8-Awi1EZXAXS4PzDzdNvV6pGcuaF4Q9821Es/pub)所述。结构应如下所示：

```
sampleapp/
    app.css
    app.js //top-level configuration, route def’ns for the app
    app-controller.js
    app-controller_test.js
    components/
        adminlogin/                                
            adminlogin.css //styles only used by this component
            adminlogin.js //optional file for module definition
            adminlogin-directive.js                         
            adminlogin-directive_test.js        
        private-export-filter/
            private-export-filter.js
            private-export-filter_test.js
        userlogin/
            somefilter.js
            somefilter_test.js
            userlogin.js
            userlogin.css                
            userlogin.html                
            userlogin-directive.js
            userlogin-directive_test.js
            userlogin-service.js
            userlogin-service_test.js                
    index.html
    subsection1/
        subsection1.js
        subsection1-controller.js
        subsection1-controller_test.js
        subsection1_test.js                         
        subsection1-1/                        
            subsection1-1.css
            subsection1-1.html
            subsection1-1.js
            subsection1-1-controller.js
            subsection1-1-controller_test.js
            subsection1-2/                        
    subsection2/
        subsection2.css
        subsection2.html
        subsection2.js
        subsection2-controller.js
        subsection2-controller_test.js
    subsection3/
        subsection3-1/
etc... 
```

# php - 主干.js，视图和路由

> ID：15839415
> 
> 赞同：0
> 
> 时间：2013-04-05T16:56:27.140
> 
> 标签：php, jquery-mobile, backbone.js, routing, slim

我正在使用带有 MySQL 后端的 slim、backbone.js 和 jquery mobile 开发一个应用程序。

工作流程大致如下：

1) 搜索一个 uni 模块。2) 列出匹配的模块。3) 选择并查看模块详情页面。4) 列出与该模块相关的讲师。5) 选择并查看讲师。

我完成了第 1 步到第 4 步，但无法显示讲师详细信息页面。我想我可能将 id 传递给 API 调用错误，或者我的路由搞砸了。

在我的 index.php 中，我有一个 API 调用列表：

> $app = new Slim();
> 
> $app->get('/modules', 'getModules'); $app->get('/modules/:id', 'getModule'); $app->get('/modules/search/:query', 'getModulesByName'); $app->get('/modules/:id/students', 'getStudents'); $app->get('/modules/:id/lecturers', 'getLecturers'); $app->get('/modules/lecturers/:id/lecturer', 'getLecturer');

最后两个涉及拉取与模块关联的讲师列表，然后在您点击他们时拉出单个讲师，显示详细信息。

getLecturers 有效，在这里供参考：

> function getLecturers($id) { $sql = "select l.staffNumber, l.firstName, l.lastName, l.moduleNo1, l.moduleNo2, l.email, m.moduleNo from Lecturertable l, moduletable m where m.moduleNo= :id AND (l.moduleNo1=:id OR l.moduleNo2=:id)";
> 
> ```
> try {
>     $db = getConnection();
>     $stmt = $db->prepare($sql);
>     $stmt->bindParam("id", $id);
>     $stmt->execute();
>     $lecturer = $stmt->fetchAll(PDO::FETCH_OBJ);
>     $db = null;
> 
>     if (!isset($_GET['callback'])) {
>         echo json_encode($lecturer);
>     } else {
>         echo $_GET['callback'] . '(' . json_encode($lecturer) . ');';
>     }
> 
> } catch(PDOException $e) {
>     echo '{"error":{"text":'. $e->getMessage() .'}}';
> } } 
> ```

getLecturer（单人）在这里：

> function getLecturer($id) { $sql = "select l.staffNumber, l.firstName, l.lastName, l.moduleNo1, l.moduleNo2, l.email from Lecturertable l where l.staffNumber=:id";
> 
> ```
> try {
>     $db = getConnection();
>     $stmt = $db->prepare($sql);
>     $stmt->bindParam("id", $id);
>     $stmt->execute();
>     $lecturer = $stmt->fetchObject();
>     $db = null;
> 
>     if (!isset($_GET['callback'])) {
>         echo json_encode($lecturer);
>     } else {
>         echo $_GET['callback'] . '(' . json_encode($lecturer) . ');';
>     }
> 
> } catch(PDOException $e) {
>     echo '{"error":{"text":'. $e->getMessage() .'}}';
> } } 
> ```

这是我在 main.js 中的路线：

> var AppRouter = Backbone.Router.extend({
> 
> ```
> routes:{
>     "":"list",
>     "list":"list",
>     "modules/:id":"moduleDetails",
>     "modules/:id/students":"moduleStudents",
>     "modules/:id/lecturers":"moduleLecturers",
>     "modules/:id/lecturers/:id/lecturer":"lecturerDetails"
> }, 
> ```

以及匹配模块Lecturers 和lecturerDetails 函数：

> moduleLecturers:function (id) { var module = new Module({id:id}); 模块.讲师.fetch(); this.changePage(new ModuleLecturersPage({model:module.lectures})); },
> 
> ```
> lecturerDetails:function (id) {
>     var lecturer = new Lecturer({id:id});
>     var self = this;
>     module.lecturers.lecturer.fetch({
>         success:function (data) {
>             self.changePage(new LecturerView({model:data}));
>         }
>     });
> }, 
> ```

然后我有 Lecturers 和 Lecturer 模型，以及 Lecturers 集合：

> window.Lecturers = Backbone.Model.extend({
> 
> ```
> urlRoot:"../api/lecturers",
> 
> initialize:function () {
>     this.lecturers = new lecturersCollection();
>     this.lecturers.url = '../api/modules/' + this.id + '/lecturers';
> } 
> ```
> 
> });
> 
> window.lecturesCollection = Backbone.Collection.extend({
> 
> ```
> model:Lecturers,
> 
> url:"../api/lecturers", 
> ```
> 
> });
> 
> //新的
> 
> window.Lecturer = Backbone.Model.extend({
> 
> ```
> urlRoot:"../api/lecturer", 
> ```
> 
> });

以及指向“讲师详细信息”html模板的讲师视图，该模板未显示：

> window.LecturerView = Backbone.View.extend({
> 
> ```
> initialize:function () {
>     this.template = _.template(tpl.get('lecturer-details'));
> },
> 
> render:function (eventName) {
>     $(this.el).html(this.template(this.model.toJSON()));
>     return this;
> } 
> ```
> 
> });

讲师列表项，当点击时应显示详细视图，包含一个链接：href='#modules/<%= moduleNo %>/#leturers/<%= staffNumber %>'

尽管 URL 在浏览器中似乎是正确的 (...jquerymobile/#modules/999003/#lecturers/123001)，但讲师详细信息页面并未显示。

几天来我一直在用这个打破我的头 - 如果有人能发现任何不合适的地方，我将不胜感激！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-06T19:37:16.657

您不能使用双标签，只需修复您的链接：

你有：

```
href='#modules/<%= moduleNo %>/#lecturers/<%= staffNumber %>' 
```

权利必须是：

```
href='#modules/<%= moduleNo %>/lecturers/<%= staffNumber %>' 
```

# android - 自定义视图中的TextView onTouchEvent

> ID：15839420
> 
> 赞同：0
> 
> 时间：2013-04-05T16:56:41.440
> 
> 标签：android, android-canvas

我有一个自定义视图，在自定义视图中我创建了 4 个文本视图。我希望这些文本视图中的每一个都响应触摸事件。但是，文本视图本身不响应触摸事件。但是，我可以为整个自定义视图创建一个 ontouch 侦听器。但是，我不希望整个视图都有一个 ontouch 事件，因为我希望我创建的文本视图能够被拖放。我尝试了注册 ontouch 事件的 x 和 y 坐标的路线，并假设如果 ontouch 事件在 textview 的范围内，则更改 textview 的坐标，但这过于复杂，因为如果一个 textview 被拖动到另一个的坐标，然后 ontouch 事件会“拾取”另一个文本视图，所以我会移动两个文本视图，这不是我想要的。所以，

```
 mScale.mPositive.get(0).setOnTouchListener(new OnTouchListener()
                    {
                        @Override
                        public boolean onTouch(View v, MotionEvent event) 
                        {
                                mScale.mCurrentXPos[0] = event.getX();
                                mScale.mCurrentYPos[0] = event.getY();
                                mScale.mDrag = true;

                            return true;
                        }

                    }); 
```

相同的代码适用于自定义视图，但不适用于该自定义视图中的特定文本视图。

这是自定义视图代码：

公共类规模扩展视图{

```
public Scale(Context context, AttributeSet attrs) 
{
    super(context, attrs);
    mContext = this.getContext();
            h = new Handler();
            mCalendarDbHelper=new CalendarDbAdapter(mContext);
            mCalendarDbHelper.open();
    Cursor thoughts = mCalendarDbHelper.fetchThoughts();

    //create a string array of negative thoughts from the db
        while (thoughts.moveToNext())
        {
            if (thoughts.getString(thoughts.getColumnIndexOrThrow(CalendarDbAdapter.COLUMN_NAME_THOUGHT)).length() > 0 && thoughts.getString(thoughts.getColumnIndexOrThrow(CalendarDbAdapter.COLUMN_NAME_THOUGHT)).charAt(0) == '-')
            {
                negative_thoughts.add(thoughts.getString(thoughts.getColumnIndexOrThrow(CalendarDbAdapter.COLUMN_NAME_THOUGHT)));
            }

        }
     thoughts.close();
     array_size = negative_thoughts.size();
     mBag =BitmapFactory.decodeResource(getResources(), R.drawable.bag);
     mGreenBag = BitmapFactory.decodeResource(getResources(), R.drawable.green_bag);

    for (int i = 0; i < 72; i ++)
    {
        try
        {
        mScale[i] = BitmapFactory.decodeStream(context.getAssets().open("scale_"+i+".gif"));
        }
        catch (IOException e) 
        {

        }
    }
}

private Runnable r= new Runnable() 
{

    @Override
    public void run() {
        invalidate();

    }

};

protected void onDraw (Canvas canvas)
{
    if (first == true)
    {
        width = this.getWidth();
        height = this.getHeight();
        mScale[i] = Bitmap.createScaledBitmap(mScale[i], (int) (width * 1.5), height, true);
        mBag = Bitmap.createScaledBitmap(mBag, width/2, height/2, true);
        negative = new TextView(mContext);
        word = negative_thoughts.get((int) (Math.random() * array_size));
        negative.setText(word);
        negative.layout(0, 0, width/3, height/4);
        negative.setGravity(Gravity.CENTER);
        negative.setTextSize(15);
        negative.setTextColor(Color.BLACK);
        negative.setTypeface(Typeface.DEFAULT_BOLD);
        negative.setShadowLayer(5, 2, 2, Color.WHITE);
        negative.setDrawingCacheEnabled(true);
        negative.setBackgroundResource(R.drawable.graycloud);
        positive_paint.setColor(Color.parseColor("#FF4444"));
        positive_paint.setShadowLayer(5, 2, 2, Color.YELLOW);
        positive_paint.setTypeface(Typeface.DEFAULT_BOLD);
        positive_paint.setTextSize(25);
        mCurrentXPos[0] = (width/2);
        mCurrentYPos[0] = height/4;
        mCurrentXPos[1] = (width/2) + (width/8);
        mCurrentYPos[1] = height/6;
        mCurrentXPos[2] = width/2;
        mCurrentYPos[2] = height/12;
        mCurrentXPos[3] = (width/2) + (width/8);
        mCurrentYPos[3] = height/18;
        mMoveXPos[0] = ((width/2) - width)/FRAME_RATE;
        mMoveYPos[0] = ((height/4) - (height + (height/4)))/FRAME_RATE;
        mMoveXPos[1] = (((width/2) + (width/8)) - width)/ FRAME_RATE;
        mMoveYPos[1] = ((height/6) - (height + (height/4)))/FRAME_RATE;
        mMoveXPos[2] = ((width/2) - width)/ FRAME_RATE;
        mMoveYPos[2] = ((height/12) - (height + (height/4)))/FRAME_RATE;
        mMoveXPos[3] = (((width/2) + (width/8)) - width)/ FRAME_RATE;
        mMoveYPos[3] = ((height/18) - (height + (height/4)))/FRAME_RATE;
        mMoveByXPos[0] = -(width/2)/ FRAME_RATE;
        mMoveByYPos[0] = -(height/4)/FRAME_RATE;
        mMoveByXPos[1] =  ((width - (width/3)) - (width/2 + (width/8)))/ FRAME_RATE;
        mMoveByYPos[1] = -(height/6)/FRAME_RATE;
        mMoveByXPos[2] = - (width/2)/ FRAME_RATE;
        mMoveByYPos[2] =  ((height) - (height/12))/FRAME_RATE;
        mMoveByXPos[3] =  ((width - (width/3)) - (width/2 + (width/8)))/ FRAME_RATE;
        mMoveByYPos[3] =  ((height) - (height/18))/FRAME_RATE;
        currentX = width;
        currentY = height + height/4;
        first = false;
    }

    if (game_over == false)
    {
        canvas.drawBitmap(mScale[i], 0 - (width/4), 0, null);
        canvas.drawBitmap(negative.getDrawingCache(),(int) (width/12), (int) (height - (height)/2.5) - (j), null);
    }

    else
    {
        canvas.drawBitmap(mBag, width/4, height/4, null);
    }

    if (mMoveScale == true)
    {
        i++;
        j+=3;
        ScaleIt(canvas, i);
        if (i == 21 || i == 37 || i == 53 || i == 71)
        {
            mMoveScale = false;
        }

    }

    if (tracker > 0)
    {
        if (tracker == 1)
        {
            if (currentX > width/2 && currentY > height/4 && sStop == false)
            {
                currentX += mMoveXPos[0]; 
                currentY += mMoveYPos[0];
                canvas.drawBitmap(mPositive.get(tracker -1 ).getDrawingCache(), currentX, currentY, null);

            }

            else 
            {
                if (sStop == false)
                {

                    mMoveScale = true;
                    sStop = true;
                    currentX = width;
                    currentY = height + height/4;
                    draw_em++;
                }

            }
        }

        if (tracker == 2)
        {

            if (currentX > width/2 + (width/8) && currentY > (height/6) && sStop == false)
            {
                currentX += mMoveXPos[1]; 
                currentY += mMoveYPos[1];
                canvas.drawBitmap(mPositive.get(tracker -1 ).getDrawingCache(), currentX, currentY, null);

            }

            else
            {
                if (sStop == false)
                {
                    mMoveScale = true;
                    sStop = true;
                    currentX = width;
                    currentY = height + height/4;
                    draw_em++;
                }
            }
        }

        if (tracker == 3)
        {

            if (currentX > width/2 && currentY > height/12 && sStop == false)
            {
                currentX += mMoveXPos[2]; 
                currentY += mMoveYPos[2];
                canvas.drawBitmap(mPositive.get(tracker -1 ).getDrawingCache(), currentX, currentY, null);

            }

            else 
            {
                if (sStop == false)
                {
                    mMoveScale = true;
                    sStop = true;
                    currentX = width;
                    currentY = height + height/4;
                    draw_em++;
                }
            }
        }

        if (tracker == 4)
        {

            if (currentX > width/2 + (width/8) && currentY > (height/18) && sStop == false)
            {
                currentX += mMoveXPos[3]; 
                currentY += mMoveYPos[3];
                canvas.drawBitmap(mPositive.get(tracker -1 ).getDrawingCache(), currentX, currentY, null);
            }

            else 
            {
                    if (sStop == false)
                    {
                    mMoveScale = true;
                    sStop = true;
                    game_over = true;
                    currentX = width;
                    currentY = height + height/4;
                    draw_em++;

                    }
            }
        }

        if (draw_em > 0 && game_over == false)
        {
            for (int i = 0; i < draw_em; i ++)
            {
            if (i == 0)
            {
                canvas.drawBitmap(mPositive.get(i).getDrawingCache(), width/2, height/4 + j, null);
            }
            if (i == 1)
            {
                canvas.drawBitmap(mPositive.get(i).getDrawingCache(), width/2 + (width/8), height/6 + j, null);

            }
            if (i == 2)
            {
                canvas.drawBitmap(mPositive.get(i).getDrawingCache(), width/2, height/12 + j, null);

            }
            if (i == 3)
            {
                canvas.drawBitmap(mPositive.get(i).getDrawingCache(), width/2 + (width/8), height/18 + j, null);
            }

        }

        }

        else if (game_over == true)
        {
            for (int i = 0; i < draw_em; i++)
            {
                if (i == 0 && mCurrentXPos[0] > 0 && mCurrentYPos[0] >  0 && mDrag == false)
                {

                    mCurrentXPos[0] += mMoveByXPos[0];
                    mCurrentYPos[0] += mMoveByYPos[0];
                    canvas.drawBitmap(mPositive.get(i).getDrawingCache(), mCurrentXPos[0], mCurrentYPos[0], null);
                }

                else if (i == 0 && mCurrentXPos[0] <= 0 || mCurrentYPos[0] <=  0 && mDrag == false)
                { 
                    canvas.drawBitmap(mPositive.get(0).getDrawingCache(), 0, 0, null);
                }

                else if (i == 0 && mDrag == true)
                {
                    canvas.drawBitmap(mPositive.get(0).getDrawingCache(), mCurrentXPos[0], mCurrentYPos[0], null);
                }

                if (i == 1 && mCurrentXPos[1] < (width - (mPositive.get(i).getWidth()/2)) && mCurrentYPos[1] >  mPositive.get(i).getHeight()/2)
                {
                    mCurrentXPos[1] += mMoveByXPos[1];
                    mCurrentYPos[1] += mMoveByYPos[1];
                    canvas.drawBitmap(mPositive.get(i).getDrawingCache(), mCurrentXPos[1], mCurrentYPos[1], null);

                }

                else if (i == 1 && mCurrentXPos[1] >= (width - (mPositive.get(i).getWidth()/2)) || mCurrentYPos[1] <=  mPositive.get(i).getHeight()/2)
                {
                    canvas.drawBitmap(mPositive.get(1).getDrawingCache(), width - (width/3), 0, null);
                }

                if (i == 2 && mCurrentXPos[2] > (mPositive.get(i).getWidth()/2) && mCurrentYPos[2] <  (height - mPositive.get(i).getHeight()/2))
                {
                    mCurrentXPos[2] += mMoveByXPos[2];
                    mCurrentYPos[2] += mMoveByYPos[2];
                    canvas.drawBitmap(mPositive.get(i).getDrawingCache(), mCurrentXPos[2], mCurrentYPos[2], null);
                }

                else if (i == 2 && mCurrentXPos[2] <= (mPositive.get(i).getWidth()/2) || mCurrentYPos[2] >=  (height - mPositive.get(i).getHeight()/2))
                {
                    canvas.drawBitmap(mPositive.get(2).getDrawingCache(), 0, height - (height/4), null);    
                }

                if (i == 3 && mCurrentXPos[3] < (width - (mPositive.get(i).getWidth()/2)) && mCurrentYPos[3] < (height - mPositive.get(i).getHeight()/2))
                {
                    mCurrentXPos[3] += mMoveByXPos[3];
                    mCurrentYPos[3] += mMoveByYPos[3];
                    canvas.drawBitmap(mPositive.get(i).getDrawingCache(), mCurrentXPos[3], mCurrentYPos[3], null);
                }

                else if (i == 3 && mCurrentXPos[3] >= (width - (mPositive.get(i).getWidth()/2)) || mCurrentYPos[3] >= (height - mPositive.get(i).getHeight()/2))
                {
                    canvas.drawBitmap(mPositive.get(3).getDrawingCache(), width - (width/3), height - (height/4), null);    
                }

            }
        }
    }
    h.postDelayed(r, FRAME_RATE);

}

protected void moveIt(Canvas canvas, int moveX,int moveY, int i)
{
    if (i == 0)
    {
        canvas.drawBitmap(mPositive.get(i).getDrawingCache(), moveX, moveY, null);
    }

    if (i == 1)
    {
        canvas.drawBitmap(mPositive.get(i).getDrawingCache(), moveX, moveY, null);
    }

    if (i == 2)
    {
        canvas.drawBitmap(mPositive.get(i).getDrawingCache(), moveX, moveY, null);
    }

    if (i == 3)
    {
        canvas.drawBitmap(mPositive.get(i).getDrawingCache(), moveX, moveY, null);

    }
}

protected void moveEm(Canvas canvas, int[]mMovePosX, int[] mMovePosY)
{
    for (int i = 0; i < 4; i++)
    {

    }
}

protected void ScaleIt(Canvas canvas, int i)
{
    mScale[i] = Bitmap.createScaledBitmap(mScale[i], (int) (width * 1.5), height, true);
    mScale[i-1].recycle();

}

} 
```

这是活动：

```
 public class ScaleView extends Activity 
 {  
    Context mContext; 
Scale mScale;
EditText positive_thought;
Button fire;
TextView pos;
private static Set<String> mPositiveWords;
private static Set<String> mNegativeWords;
int count;
private Pattern four_letter_words = Pattern.compile("not|cant|cnt|can't"); 
String inputLine;
private String[] inputTokens;
Button question;
Button skip;

public static boolean populatePositiveWords(Context context)
{
    mNegativeWords = new HashSet<String>();

    try
    {
        BufferedReader reader = new BufferedReader(new InputStreamReader(context.getAssets().open("negative_words.txt")));          
        String line = reader.readLine();

        while (line != null)
        {
            mNegativeWords.add(line.toLowerCase(Locale.US));
            line = reader.readLine();
        }

        reader.close();
    }
    catch (IOException exception)
    {
        return false;
    }

    return true;
    //TODO list of negative words 
}

@Override
public void onCreate(Bundle savedInstanceState) 
{
    super.onCreate(savedInstanceState);
    this.getActionBar().hide();
    mContext = this;
    populatePositiveWords(mContext);
    setContentView(R.layout.activity_scale);
    mScale = (Scale) findViewById(R.id.anim_view);
    mScale.setClickable(true);
    positive_thought = (EditText) findViewById(R.id.thoughts);
    fire = (Button) findViewById(R.id.scale_it);
    skip = (Button) findViewById(R.id.skip);
    question = (Button) findViewById(R.id.question);
    InputFilter[] FilterArray = new InputFilter[1];
    FilterArray[0] = new InputFilter.LengthFilter(60);
    positive_thought.setFilters(FilterArray);

    fire.setOnClickListener(new OnClickListener()
    {
        @Override
        public void onClick(View view) 
        {
            //if the button is clicked invalidate the ondraw method and pass in the text of the positive word 
            inputLine = positive_thought.getText().toString();
            inputTokens = inputLine.split(" ");

            if (inputLine.isEmpty())
            {
                Toast.makeText(mContext, "You have to write something!", Toast.LENGTH_SHORT).show();
                return;                 
            }

            if (inputTokens.length < 3)
            {
                Toast.makeText(mContext, "At least three words are required.", Toast.LENGTH_SHORT).show();
                return;
            }               

            if (four_letter_words.matcher(inputLine).find() == true)
            {
                Toast.makeText(mContext, "Make an affirmative statement!", Toast.LENGTH_SHORT).show();
                return;
            }

            boolean matchesToken = false;

            for (int i = 0; i < inputTokens.length; i++)
            {
                String token = inputTokens[i];

                if (mNegativeWords.contains(token.toLowerCase(Locale.US)))
                {
                    matchesToken = true;
                    break;
                }
            }

            if (matchesToken == true)
            {
                Toast.makeText(mContext, "Use positive words!", Toast.LENGTH_SHORT).show();
                return;
            }

            else
            {

            InputMethodManager imm = (InputMethodManager)mContext.getSystemService(
                      Context.INPUT_METHOD_SERVICE);
                imm.hideSoftInputFromWindow(positive_thought.getWindowToken(), 0);
            pos = new TextView (mContext);
            pos.layout(0, 0, mScale.width/3, mScale.height/4);
            pos.setGravity(Gravity.CENTER);
            pos.setTextSize(15);
            pos.setTextColor(Color.RED);
            pos.setTypeface(Typeface.DEFAULT_BOLD);
            pos.setShadowLayer(5, 2, 2, Color.YELLOW);
            pos.setText(positive_thought.getText().toString());
            pos.setDrawingCacheEnabled(true);
            pos.setBackgroundResource(R.drawable.whitecloud);
            pos.setClickable(true);
            mScale.mPositive.add(pos);
            mScale.scale_it = true;
            count++;
            mScale.sStop = false;
            mScale.tracker = count;
            if (count == 4)
            {
                ((RelativeLayout)question.getParent()).removeView(question);
                ((RelativeLayout)skip.getParent()).removeView(skip);
                mScale.mPositive.get(0).setOnTouchListener(new OnTouchListener()
                    {
                        @Override
                        public boolean onTouch(View v, MotionEvent event) 
                        {
                                mScale.mCurrentXPos[0] = event.getX();
                                mScale.mCurrentYPos[0] = event.getY();
                                mScale.mDrag = true;
                                return true;
                        }

                    });

            }

            }
            positive_thought.setText(null);

        }
    });

} 
```

}

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-05T19:19:18.887

您的 TextView 无法接收触摸事件的原因是 TextView 在画布上绘制为位图，而不是视图。下面显示的代码摘录说明了这一点。

```
protected void onDraw(Canvas canvs)
{
    ....
    negative = new TextView(mContext);
    ...
    canvas.drawBitmap(negative.getDrawingCache(), ...) 
```

要将触摸事件传递给您的 TextView，您的 Scale 类应该扩展的不是 View，而是 ViewGroup，并且需要使用 ViewGroup.addView() 或 addViewInLayout() 将 TextView 作为子视图添加到 Scale 类。实现 ViewGroup 子类并非易事。根据您的需要，您可能必须实现 onInterceptTouchEvent(MotionEvent)。

Android 的源代码会有所帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-05T17:04:27.493

您的 CustomView 是否也设置了一些 TouchListner？如果是，那么这可能会导致问题..从 CustomView 中删除 TouchListner 并查看它是否有效..

# excel - Excel 宏到 Word 邮件合并正在尝试合并列中的所有行

> ID：15839422
> 
> 赞同：0
> 
> 时间：2013-04-05T16:56:49.510
> 
> 标签：excel, vba, ms-word, mailmerge

我创建了一个 VBA 表单和宏，它将为我的公司生成自动编号的文档。根据选择的成本中心，它将选择一个 Word 文档来完成合并。它基本上在标题“FirstName”下的 A 列中生成一个字母数字序列（FirstName 与 Word 作为“源”字段很好地配合使用）。

在我开始制作一个前导零的序列之前，一切似乎都运行良好。我从表单中输入“手动”（起始编号）后的每个前导零都被自动删除。我做了一些阅读，最后只是检查了我的字符串的 Len()，如果它小于输入（起始）数字的位数，则重新插入 0。希望你还在这里关注我。:)

这就是我*认为*发生的事情......我在开始时尝试了其他一些事情，包括让宏用单引号（'）写出序列，但它一直在删除那些前导零。我突出显示了整列并格式化为文本（所以，从技术上讲，有 64,000 多行？）但同样的问题。我上一段中的解决方法解决了这个问题，但现在合并正在尝试合并列中的所有行。

答案可能很简单，但是当序列停止时，我在寻找什么让它停止？我有一个生成数字的例程，它只生成我想要的数量：

```
For i = 1 To strFormNums
    If Len(strStartVal) < 4 Then
        rngFormNumbers(i).Value = strCampus & "0" & strStartVal 'Appends a single 0 to show before the starting numbers (making 0800 instead of 800). Otherwise Excel will lose the leading zero after the first number.
    Else
        rngFormNumbers(i).Value = strCampus & strStartVal
    End If

    strStartVal = strStartVal + 1
Next i 
```

我已经对此进行了测试。它生成的行数不会超过 200 或 500 行。这是邮件合并的一个片段，我认为由于某种原因现在正在抓取所有行（以前没有）：

```
strWorkbookName = ThisWorkbook.Path & "\" & ThisWorkbook.Name

wdocSource.MailMerge.MainDocumentType = wdFormLetters

wdocSource.MailMerge.OpenDataSource _
        Name:=strWorkbookName, _
        AddToRecentFiles:=False, _
        Revert:=False, _
        Format:=wdOpenFormatAuto, _
        Connection:="Data Source=" & strWorkbookName & ";Mode=Read", _
        SQLStatement:="SELECT * FROM `Numbers$`"

With wdocSource.MailMerge
    .Destination = wdSendToNewDocument
    .SuppressBlankLines = True
    With .DataSource
        .FirstRecord = wdDefaultFirstRecord
        .LastRecord = wdDefaultLastRecord
    End With
    .Execute Pause:=False
End With 
```

如果我不得不冒险猜测，我会说 SQL 语句现在“看到”更多行，因为整列都已格式化？我进行了手动合并，果然在我的 200 个号码结束后有数千个空白。我在 Word 中手动过滤掉了它们，但我想解决这个问题，因为显然我的程序是为了自动化这个过程。

如果有人需要查看更多代码，我将很乐意提供。提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-08T14:07:41.843

经过一些试验，我决定使用清除 > 清除格式 (Excel 2010) 从 A 列中删除所有格式。邮件合并现在终止于第一个空白行，而不是贯穿整个列。

似乎突出显示一列并将格式设置为文本（例如）确实会破坏邮件合并。如果我错了，请随时纠正我，但这似乎解决了我的问题。

# event-handling - 通过 MouseOut/MouseOver 客户端处理程序隐藏/显示 UI 元素

> ID：15839423
> 
> 赞同：0
> 
> 时间：2013-04-05T16:56:54.157
> 
> 标签：event-handling, listbox, google-apps-script, mouseout

目标是通过 MouseOut/MouseOver 事件相互替换两个元素。具体来说，元素是标签和列表框。有一些 UI 安排，其中实现在 Chrome 中可以接受，但在 IE(9) 中总是失败。问题发生在从列表框中进行选择期间，因为浏览器会忽略下拉区域作为列表框的一部分，它会触发 mouseOut 处理程序并隐藏列表框。

**是否有任何解决方案强制浏览器考虑列表框及其下拉区域？**

```
app.createListBox() .setId('listBox');
app.createLabel('Item1') .setId('label')
    .addMouseOverHandler(app.createClientHandler()
                         .forEventSource().setVisible(false)
                         .forTargets(app.getElementById('listBox')).setVisible(true));
app.getElementById('listBox')
    .addItem('Item1')
    .addItem('Item2')
    .setVisible(false)
    .addMouseOutHandler(app.createClientHandler()
                        .forEventSource().setVisible(false)
                        .forTargets(app.getElementById('label')).setVisible(true)); 
```

非常感谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-05T19:14:16.447

有一种可能的解决方法是使用服务器处理程序来隐藏列表框。从我的测试来看，它的行为非常相似（如果不是更好的话） - 你可以[在这里测试它](https://script.google.com/macros/s/AKfycbyxgXz7E0A516DkS3n2jPrdqt6Re7RTx2wOzu2fiLBuucN8M2U/exec)

```
function doGet() {
  var app = UiApp.createApplication().setStyleAttribute('padding','100px');
  var p = app.createVerticalPanel();
  var serverHandler = app.createServerHandler('handler').addCallbackElement(p)
  var listBox = app.createListBox() .setId('listBox').setName('listBox').addChangeHandler(serverHandler);  
  var label = app.createLabel('Item1').setId('label')
    .addMouseOverHandler(app.createClientHandler()
                         .forEventSource().setVisible(false)
                         .forTargets(listBox).setVisible(true));

  listBox.addItem('Item1').addItem('Item2').addItem('Item3').addItem('Item4')         
              .setVisible(false)

  p.add(listBox).add(label)
  app.add(p)
  return app                       
}

function handler(e){
  var app = UiApp.getActiveApplication();
  var listBox = app.getElementById('listBox')
  var label = app.getElementById('label')
  listBox.setVisible(false)
  label.setVisible(true).setText(e.parameter.listBox)
  return app
} 
```

# javascript - Ember.js Rest Adapter：无根映射 JSON（.NET Web API）

> ID：15839424
> 
> 赞同：8
> 
> 时间：2013-04-05T16:56:58.877
> 
> 标签：javascript, json, ember.js, asp.net-web-api, ember-data

我有一个使用 .NET Web API 编写的现有服务。

例如，此服务以以下格式返回 JSON：

```
[
  { "id": 1, "name": "John" },
  { "id": 2, "name": "Jane" }
] 
```

但是，根据[Ember.js Rest Adapter 文档](http://emberjs.com/guides/models/the-rest-adapter/)，Ember 期望 JSON 采用以下格式：

```
{
  "persons": [
    { "id": 1, "name": "John" },
    { "id": 2, "name": "Jane" }
  ]
} 
```

因此，Ember 返回以下错误： ***您的服务器返回了一个带有键 0 的哈希，但您没有它的映射***

我绝不打算更改我的服务 API 及其返回数据的方式。

是否有可能让 Ember.js（最新版本）处理我的服务返回的现有数据？如果是这样，我该如何实施？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-05T17:25:21.823

从这个意义上说，Ember 非常灵活，能够扩展适配器和序列化程序，以便将您的应用程序与任何后端 API 集成。

您应该获得 WebAPIAdapter，它是[Ember.js Template for Web API](http://www.asp.net/single-page-application/overview/templates/emberjs-template)的一部分。

此外，您可能想看看我作为示例编写的[这个项目](https://github.com/MilkyWayJoe/Ember-Contact-Management-WebAPI)，它基于相同的模板（我自己做了一些修改）。它仍在开发中，还没有包含所有最佳实践（还），但我认为这是一个有效的例子。

您还应该查看这个[repo / library （您也可以](https://github.com/Myslik/csharp-ember-handlebars)[通过 NuGet](http://nuget.org/packages/csharp-ember-handlebars-compiler/1.1.0)安装它），它允许您将 Handlebars 模板直接预编译到`Ember.TEMPLATES`集合中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-08-24T19:09:37.193

在 web api 中只返回 new { object }

```
var persons = _personbService.GetPeople;
        return new { persons }; 
```

这会将您的对象包装在同名的对象中。如果您需要调用该对象，请执行其他操作

```
new { SomeOtherName = persons; } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-08-29T22:04:30.780

我在 ember 中遇到了这个问题，发现对我来说最好的解决方案是构建一个新的序列化程序并覆盖 normalizePayload 方法。下面的代码：

```
export default DS.RESTSerializer.extend({
normalizePayload: function(payload) {
var root = "posts";
var output = {};
output[root] = payload;
return output; 
```

} });

这包装了初始响应并为其添加了根，希望对您有所帮助！

# image - htaccess 将所有图像请求从不存在的文件夹重写为文件夹名称.jpg

> ID：15839426
> 
> 赞同：0
> 
> 时间：2013-04-05T16:57:04.317
> 
> 标签：image, .htaccess, rewrite, directory

例如，这就是我想要做的事情。. .

```
http://www.website.com/images/folder-with-a-crazy-name/any-image-at-all.jpg 
```

将重写为 . . .

```
http://www.website.com/images/folder-with-a-crazy-name.jpg 
```

这有意义吗？

任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-05T20:21:47.223

将文件夹中的所有 jpeg 图像文件重写到该文件夹​​并`.jpg`附加

```
RewriteRule ^images/(.+?)/[^/]+?\.jpg$ /images/$1.jpg [L] 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-05T17:29:56.430

只需将其粘贴到您的*.htaccess*文件中：

```
Options +FollowSymlinks
RewriteEngine on
RewriteRule ^images/([a-z0-9-_]+)/any-image-at-all.jpg /images/$1.jpg 
```

或者，如果您甚至希望重写其他图像格式，则只需将上面代码中的第三行和最后一行替换为以下规则：

```
RewriteRule ^images/([a-z0-9-_]+)/any-image-at-all.([a-z0-9]{3}|[a-z0-9]{4}) /images/$1.$2 
```

如果文件夹*images*也是变量，请尝试以下规则之一：

```
RewriteRule ^([a-z0-9-_]+)/([a-z0-9-_]+)/any-image-at-all.jpg /$1/$2.jpg 
```

如果文件扩展名是一个变量，那么试试这个：

```
RewriteRule ^([a-z0-9-_]+)/([a-z0-9-_]+)/any-image-at-all.([a-z0-9]{3}|[a-z0-9]{4}) /$1/$2.$3 
```

# php - 使用 DOMDocument->saveHTML() 将实际 Unicode 字符自动转换为数值

> ID：15839429
> 
> 赞同：2
> 
> 时间：2013-04-05T16:57:10.287
> 
> 标签：php, unicode, domdocument

我正在使用以下函数来获取 html 字符串的内部 html

```
function DOMinnerHTML($element) 
{ 
    $innerHTML = ""; 
    $children = $element->childNodes; 
    foreach ($children as $child) 
    { 
        $tmp_dom = new DOMDocument('1.0', 'UTF-8');
        $tmp_dom->appendChild($tmp_dom->importNode($child, true)); 
        $innerHTML .= trim($tmp_dom->saveHTML()); 
    }

    return $innerHTML; 
} 
```

我的 html 字符串还包含 unicode 字符。这是html字符串的示例

```
$html = '<div>Thats True. Yes it is well defined آپ مجھے تم کہہ کر پکاریں</div>'; 
```

当我使用上述功能时

```
$output = DOMinnerHTML($html); 
```

输出如下

```
$output = '<div>Thats True. Yes it is well defined 
&#1705;&#1746;&#1748;&#1587;&#1604;&#1591;&#1575</div>'; 
```

转换为数值的实际 unicode 字符。

我已经调试了代码，发现在下面一行之前的 DOMinnerHTML 函数中

```
$innerHTML .= trim($tmp_dom->saveHTML()); 
```

如果我回声

```
echo $tmp_dom->textContent; 
```

它显示实际的 unicode 字符，但在保存后`$innerHTML`输出数字符号。为什么这样做。

注意：请不要建议我使用 html_entity_decode 之类的函数将数字符号转换为真正的 unicode 字符，因为我的 html 字符串中还有用户格式化的数据，我不想转换。

注意：我也试过把

```
<meta http-equiv="content-type" content="text/html; charset=utf-8"> 
```

在我的 html 字符串之前，但没有区别。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-07-13T05:18:33.050

我有一个类似的问题。在阅读了上述评论后，经过进一步调查，我找到了一个非常简单的解决方案。

你所要做的就是用`html_entity_decode()`来转换 的输出`saveHTML()`，如下：

```
// Create a new dom document
$dom = new DOMDocument();

// .... Do some stuff, adding nodes, ...etc.

// the html_entity_decode function will solve the unicode issue you described
$result = html_entity_decode($dom->saveHTML();

// echo your output
echo $result; 
```

这将确保正确显示 unicode 字符

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-05T17:08:54.160

好问题，你做得很好，将问题缩小到导致事情变得混乱的一行代码！这让我弄清楚出了什么问题。

问题在于[DOMDocument 的 saveHTML() 函数](http://php.net/manual/en/domdocument.savehtml.php)。它正在做它应该做的事情，但它的设计不是你想要的。

saveHTML() 将文档转换为“使用 HTML 格式”的字符串 - 这意味着它会为您进行 HTML 实体编码！可悲的是，这不是你想要的。PHP 文档中的注释还表明 DOMDocument 不能很好地处理 utf-8 并且不能很好地处理片段（因为它会自动添加 html、doctype 等）。

只需使用另一个类即可查看此评论以获取建议的解决方案：[DOMDocument 的替代方案](http://www.php.net/manual/en/class.domdocument.php#96709)

> 在看到许多关于某些 DOMDocument 缺点的投诉后，例如编码处理不当以及总是使用 、 和 DOCTYPE 保存 HTML 片段，我决定需要一个更好的解决方案。
> 
> 所以这里是：SmartDOMDocument。您可以在 [http://beerpla.net/projects/smartdomdocument/找到它](http://beerpla.net/projects/smartdomdocument/)
> 
> 目前，主要亮点是：
> 
> *   SmartDOMDocument 继承自 DOMDocument，因此非常易于使用 - 只需声明 SmartDOMDocument 类型的对象而不是 DOMDocument 并享受所有现有功能之上的新行为（参见下面的示例）。
>     
>     
> *   saveHTMLExact() - DOMDocument 有一个设计非常糟糕的“功能”，如果您正在加载的 HTML 代码不包含和标签，它会自动添加它们（是的，没有标志可以关闭此行为）。因此，当您调用 $doc->saveHTML() 时，您新保存的内容中现在包含和 DOCTYPE。尝试使用代码片段时不是很方便（XML 有类似的问题）。SmartDOMDocument 包含一个名为 saveHTMLExact() 的新函数，它完全符合您的要求 - 它保存 HTML 而不添加 DOMDocument 所做的额外垃圾。
>     
>     
> *   编码修复 - 众所周知，DOMDocument 不能正确处理编码（至少是 UTF-8），并且输出会出现乱码。SmartDOMDocument 尝试通过增强 loadHTML() 以正确处理编码来解决此问题。这种行为对您来说是透明的——只需像往常一样使用 loadHTML() 即可。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-08-23T06:57:30.443

mb_convert_encoding($html,'HTML-ENTITIES','UTF-8');

这对我有用

# java - 使用 gsl 的带有 C 函数的 Java JNI。

> ID：15839430
> 
> 赞同：1
> 
> 时间：2013-04-05T16:57:19.537
> 
> 标签：java, c++, java-native-interface, gsl

我正在尝试使用 JNI 来调用 c 中定义的函数。这真的很奇怪，因为当我运行我的 java 程序时，有时我会犯一个错误，而其他时候我会得到一个不同的错误。他们来了：

```
 82 [main] java (5556) C:\Windows\system32\java.exe: *** fatal error - cygheap base mismatch detected - 0x612708F0/0x17FF08F0.
This problem is probably due to using incompatible versions of the cygwin DLL.
Search for cygwin1.dll using the Windows Start->Find/Search facility
and delete all but the most recent version.  The most recent version *should*
reside in x:\cygwin\bin, where 'x' is the drive on which you have
installed the cygwin distribution.  Rebooting is also suggested if you
are unable to find another cygwin DLL.
java.lang.UnsatisfiedLinkError: C:\cygwin\home\Juli▒n\Pruebas_JNI\Caracterizacion.dll: Se realiz▒ un acceso no v▒lido a la ubicaci▒n de memoria
        at java.lang.ClassLoader$NativeLibrary.load(Native Method)
        at java.lang.ClassLoader.loadLibrary1(Unknown Source)
        at java.lang.ClassLoader.loadLibrary0(Unknown Source)
        at java.lang.ClassLoader.loadLibrary(Unknown Source)
        at java.lang.Runtime.loadLibrary0(Unknown Source)
        at java.lang.System.loadLibrary(Unknown Source)
        at Main.<clinit>(Main.java:6)
Exception in thread "main" 
```

和

```
Exception in thread "main" java.lang.UnsatisfiedLinkError: Main.caracterizar()[F
        at Main.caracterizar(Native Method)
        at Main.main(Main.java:10) 
```

我认为我所做的一切都是正确的，甚至认为我似乎没有。

这是我的 C 函数

```
/* 
 * File:   main.c
 * Author: OCARDONAM
 * Created on 14 de enero de 2013, 11:46 AM
 */
#include <stdio.h>
#include <math.h>
#include <string.h>
#include <jni.h>
#include <gsl/gsl_vector.h>
#include <gsl/gsl_statistics.h>
#include <gsl/gsl_blas.h>
#include <gsl/gsl_linalg.h>
#include "sizedata.h"
#include "elementary_math_vec.h"
#include "contar.h"
#include "media.h"
#include "Main.h"

JNIEXPORT jfloatArray JNICALL Java_Main_caracterizar (JNIEnv *env, jclass class) {
    //variables
    int n_fil, n1, n2, i;
    char *filename;
    //features names
    double m,T1,T2,T3,T4,T5,T6,T7,T8,T9,T10,T11;//,F1,F2,F3,F4,F5,F6,F7,F8,F9,F10,F11;
    //load signal and define its size
    filename = "reg_test.txt";
    tamano(filename, &n1, &n2);
    n_fil = n1-2;

    gsl_vector * v = gsl_vector_alloc (n_fil); 
    {
        FILE * f = fopen (filename, "r");
        gsl_vector_fscanf (f, v);
        fclose (f);
    }

    // statistics features in time domain
    double data[n_fil],tmp[n_fil];
    for (i = 0; i < n_fil; i++)
    {
        data[i] = gsl_vector_get(v,i);
    }

    //centered data
    m = gsl_stats_mean(data, 1, n_fil);
    for (i = 0; i < n_fil; i++) {
        data[i] = data[i]-m;
        gsl_vector_set(v,i,data[i]);
    }
    T1 = gsl_stats_mean(data, 1, n_fil);  //mean
    T2 = gsl_stats_sd_m(data, 1, n_fil, T1); //standard deviation    
    T3 = gsl_blas_dnrm2(v)/sqrt(n_fil);//RMS
    T4 = gsl_stats_skew(data, 1, n_fil); //skewness    
    T5 = gsl_stats_kurtosis(data, 1, n_fil) + 3; //kurtosis
    T6 = ch_T6(data,n_fil);
    T7 = ch_T7(data,n_fil); //absolute maximum
    T8 = T7/T3; //Crest Factor
    T9 = T7/T6;
    T10 = ch_T10(data,n_fil,T3);//Shape Factor
    T11 = ch_T11(data,n_fil,T7);

    //print a vector 

    jfloat res[1000];
    jfloatArray jres;

    for (i = 0; i < n1-2; i++) {
        res[i] = (jfloat) gsl_vector_get(v, i);
    }
    gsl_vector_free (v); 

    (*env)->SetFloatArrayRegion(env, jres, 0, n1-2, res);
    return jres;
} 
```

这是我用来调用它的java代码：

```
public class Main {

    public native float[] caracterizar();

    static {
        System.loadLibrary("Caracterizacion");
    }

    public static void main(String args[]) {
        float ans[] = (new Main()).caracterizar();

        for (int i=0 ; i<ans.length ; i++)
            System.out.println(ans[i]);
    }
} 
```

此外，这是我用来编译和链接 c 程序的内容：

```
gcc -D__int64="long long" -c -I/cygdrive/c/Program\ Files/Java/jdk1.7.0_11/include/ -I/cygdrive/c/Program\ Files/Java/jdk1.7.0_11/include/win32/ -o Main.o Main.c 
```

关联：

```
gcc -shared -L/usr/local/lib -o Caracterizacion.dll Main.o -lgsl -lgslcblas -lm 
```

我不确定错误在哪里。我已经测试了其他 JNI 程序并且它们工作正常，所以我认为问题在于我包含 gsl 库的方式。

我希望你能帮助我。谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-10T11:59:51.113

不要使用 cygwin GCC，除非你真的想让你的程序链接到 cygwin 库。如果您需要它，您还必须将 cygwin dll 打包到您的包中。

如果您希望它在 Windows 上运行，请使用 mingw 编译器（Cygwin 也有包，但它会创建 cygwin 独立的二进制文件。）或 MSVC 项目。除非 Java 启用了 cygwin，否则它不会理解 cygwin 路径，但您的本机代码会。那会变得非常混乱。除非你知道你需要它，否则使用 cygwin 编写脚本，但使用 mingw-gcc 作为编译器来制作二进制文件或使用 Min Lin 的工作室项目。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-10T09:51:14.503

我的猜测是您的 gsl 库可能已编译并链接到不同版本的 cygwin。而且你的main.c代码是用你当前版本的cygwin编译的，有冲突。你可以试试这些：

1.  使用当前的 cygwin 环境重建您的 gsl。
2.  链接到 gsl 的静态库。
3.  使用msvc，gsl可以在msvc上编译，我有[visual studio的解决方案](https://github.com/lin-min/GSL1.15-Win)，可以制作静态库或者动态库。

# .net - 进程失败时如何从 vb.net 控制台应用程序发送电子邮件

> ID：15839431
> 
> 赞同：0
> 
> 时间：2013-04-05T16:57:21.830
> 
> 标签：.net, vb.net

我正在使用 gmail 帐户发送电子邮件...当过程失败...像这样

```
 Dim SimpleSMTP As New SmtpClient("smtp.gmail.com") 
        With SimpleSMTP 
            .Port = 587 
            .EnableSsl = True 
            .Credentials = _ 
            New NetworkCredential("mytest@gmail.com", "passtest") 
            .Send(AnEmailMessage) 
        End With 
```

我想用真实的 smtp 详细信息替换这个片段...ussmtp.mysite.com 怎么做？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-05T17:05:45.127

您只需将 URL 从 更改`"smtp.gmail.com"`为`"ussmtp.mysite.com"`，确保端口合适，并根据需要设置凭据。

否则，所编写的代码应该适用于任何 SMTP 服务器。

# javascript - 如何关闭服务器发送事件事件

> ID：15839433
> 
> 赞同：11
> 
> 时间：2013-04-05T16:57:22.000
> 
> 标签：javascript, html, server-sent-events

我想知道如何通过 JavaScript 关闭服务器发送的事件。下面是我的虚拟代码：

```
var ser=new EventSource("path");
ser.onmessage=function(ev){
if(!ev)
   //want to close HERE!!
else
   console.log(ev);
} 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2016-03-04T21:04:17.093

这是我发现最适合我的方式

```
var eventSource = new EventSource("path");
eventSource.onerror = eventSourceErrorFunction;
var eventSourceErrorFunction = function(event)
{
        if (event.eventPhase == EventSource.CLOSED) {
            that.eventSource.close();
            console.log("Event Source Closed");
        }  
} 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2013-04-05T17:07:24.610

关闭服务器端事件的正确方法是使用`close`方法。

[https://developer.mozilla.org/en-US/docs/Server-sent_events/EventSource#Method_overview](https://developer.mozilla.org/en-US/docs/Server-sent_events/EventSource#Method_overview)

所以你会使用：

```
var ser = new EventSource("path");
ser.onmessage = function (ev) {
    if (!ev)
       ser.close();
    else
       console.log(ev);
}; 
```

JavaScript 区分大小写，因此您不能使用`.Close()`，因为它`.close()`与在这种情况下是未定义的不同。

# python - 上传应用程序 Python Google App Engine 时出错

> ID：15839434
> 
> 赞同：1
> 
> 时间：2013-04-05T16:58:01.083
> 
> 标签：python, google-app-engine

我一直在尝试使用 Windows 命令提示符上传 python Google app engine 文件夹。我在文件夹中有 app.yaml 和 python 文件。但是当我在命令提示符中传递以下命令时：

```
appcfg.py --oauth2 update C:/Path/to/the/folder 
```

我得到这个错误。

```
appcfg.py: error: Directory does not contain an Project.yaml configuration file. 
```

我在哪里错了，我应该如何继续？

这是我的 app.yaml 文件：

```
application: myappid
version: 1
runtime: python27
api_version: 1
threadsafe: true

handlers:
- url: /.*
  script: sampleapp.app

libraries:
- name: lxml
  version: "latest" 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-07-21T02:05:06.753

检查你的 shell 语法。由于没有引用正确的项目文件夹，我也收到了此错误消息。注意结尾的斜线：

appcfg.py --oauth2 更新 C:/Path/to/the/folder/

# c - 管理指向套接字文件描述符的指针

> ID：15839437
> 
> 赞同：0
> 
> 时间：2013-04-05T16:58:07.693
> 
> 标签：c, sockets, pointers, udp

我想知道是否可以管理指向套接字 udp 文件描述符的指针，因为我必须同时使用 send() 将数据发送到 2 个不同的套接字。

我有一个创建 2 个套接字的函数（socket() setsocket() bind() connect()...）和另一个更改套接字的函数（如果一个条件为真，但我不写这部分）

```
 void set_socket(){                                    
    socket00 = socket(AF_INET, SOCK_DGRAM, 0);
    socket01 = socket(AF_INET, SOCK_DGRAM, 0);
    ...
    setsocket();
    setsocket();
    ....
    ....
  }

  int change_socketfd (int fd) {    
    if (fd == socket01 ) {          
        return ( socket00 );
    }
    else if (fd == socket00 ) {
        return ( socket01 );
    }
  } 
```

我可以有这样的指针吗？

```
 int *psock;
    psock=&change_socketfd(socket00);
    ris = send(*psock, datagram, sizeof(*datagram)+1 , 0); 
```

我需要的是动态更改 socketfd ，但是我的代码给出了分段错误，所以我不确定这种方法是否正确或可能。感谢您的建议

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-05T17:07:41.850

你这样做的方式是行不通的，因为`&change_socketfd(socket00)`它是给它一个返回值的地址，它只是暂时存在的。我不明白为什么这不能满足您的要求：

```
int psock;
psock = change_socketfd(socket00);
ris = send(psock, datagram, sizeof(*datagram)+1 , 0); 
```

如果你真的需要它是一个指针，那么试试这个：

```
int *psock = malloc(sizeof(int*));
*psock = change_socketfd(socket00);
ris = send(*psock, datagram, sizeof(*datagram)+1 , 0);

...
//When you're finished with psock
free(psock); 
```

# c# - 使用Jquery捕获点击事件 控制

> ID：15839439
> 
> 赞同：0
> 
> 时间：2013-04-05T16:58:29.133
> 
> 标签：c#, jquery, asp.net, file-upload

我的代码：

```
<script>
    $('.Upload').on("click", function () {
        alert("Click event found using class as identifier");
    });

    $('#FileUpload1').on("click", function () {
        alert("Click event found using ID as identifier");
    });
</script>

<asp:FileUpload ID="FileUpload1" runat="server" CssClass="Upload" /> 
```

我正在使用最新版本的 Jquery(1.9)，这就是为什么我使用`.on`而不是`.live`

但是当我单击“浏览”按钮时，我的任何警报都不会触发。

任何人都可以帮忙吗？

谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-05T17:01:37.253

您必须将委托与 .on() 合成器一起使用，参见 live() 等效项：

```
$(document).on("click",".Upload",function(){...}); 
```

# r - 多准则增量与 R 中的重置

> ID：15839443
> 
> 赞同：4
> 
> 时间：2013-04-05T16:58:43.107
> 
> 标签：r

我有一个非常大（近 6m 行）的数据框，称为 DF，具有以下结构：

```
CodeContract    RelMonth    AmtPmt
A0001           10          0.00
A0001           11          15.00
A0002           12          4.55
A0003           4           0.00
...             ...         ... 
```

`RelMonth`定义为自与 相关的特定静态事件以来的月数`CodeContract`。

此数据已按`CodeContract`和按 排序`RelMonth`。数据框当前保持连续`RelMonth`；即对于任何给定`CodeContract`的所有临时`RelMonth`填充，例如对于给定的填充，`CodeContract`如果我有 Min`RelMonth=5`和 Max `RelMonth=12`，那么数据框将包括`RelMonths 5:12`.

我想计算另一个名为的列`Mths_since_last_Pmt`，该列将计算给定`CodeContract`的`RelMonths`自给定 a`CodeContract`以来的数量`AmtPmt > Amt_threshold`。

它会像这样工作（假设`Amt_threshold=5`）

```
CodeContract    RelMonth    AmtPmt  Mths_since_last_Pmt
A0001           1           0.00    1
A0001           2           3.00    2
A0001           3           0.00    3
A0001           4           10.00   0
A0001           5           0.00    1
A0002           1           10.00   0
A0002           2           12.00   0
A0002           3           0.00    1
A0002           4           0.00    2 
```

我目前有一个使用`For`循环的工作解决方案，但它只能处理大约 5,000 行/秒。

我正在寻找一种方法来向量化这个计算，甚至可能不先对数据进行排序，或者不中断`RelMonths`.

我尝试开发的所有矢量化解决方案，通常使用`ddply`那个 call `seq_along`，最终都会耗尽我的 RAM (24GB)。我正在寻找一种可以在 2GB 内存使用下运行的解决方案。也许是自定义函数形式的解决方案？

知道如何进行这项工作吗？

更新@Roland

@罗兰

我发现了一个稍微不同的数据集，它会导致下面的代码输出错误。调整后的输入是：

```
DF <- read.table(text="CodeContract    RelMonth    AmtPmt  Mths_since_last_Pmt
A0001           1           0.00    1
A0001           2           3.00    2
A0001           3           0.00    3
A0001           4           10.00   0
A0001           5           0.00    1
A0002           1           1.00   0
A0002           2           14.00   0
A0002           3           14.00    1
A0002           4           14.00    2",header=TRUE) 
```

对应的输出是：

```
CodeContract RelMonth AmtPmt Mths_since_last_Pmt Mths_since_last_Pmt2
1:        A0001        1      0                   1                    1
2:        A0001        2      3                   2                    2
3:        A0001        3      0                   3                    3
4:        A0001        4     10                   0                    0
5:        A0001        5      0                   1                    1
6:        A0002        1      1                   0                    1
7:        A0002        2     14                   0                    0
8:        A0002        3     14                   1                   -1
9:        A0002        4     14                   2                   -2 
```

最后一行的负数`-1`和`-2`in不正确；`Mths_since_last_Pmt2`他们都应该是`0`因为已经超过了阈值。当第一项是子组（这里是`CodeContract`变化）低于阈值时，算法似乎失败了，足以将其丢弃。

有没有我们可以应用的调整来完成这项工作？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-05T17:21:32.940

试试这个：

```
DF <- read.table(text="CodeContract    RelMonth    AmtPmt  Mths_since_last_Pmt
A0001           1           0.00    1
A0001           2           3.00    2
A0001           3           0.00    3
A0001           4           10.00   0
A0001           5           0.00    1
A0002           1           10.00   0
A0002           2           12.00   0
A0002           3           0.00    1
A0002           4           0.00    2",header=TRUE)

library(data.table)

DT <- data.table(DF,key=c("CodeContract","RelMonth"))

trsh <- 5
DT[,Mths_since_last_Pmt2 := 
       cumsum(AmtPmt<=trsh)-cumsum(cumsum(AmtPmt<=trsh)*(AmtPmt>trsh)),
            by=CodeContract]

#    CodeContract RelMonth AmtPmt Mths_since_last_Pmt Mths_since_last_Pmt2
# 1:        A0001        1      0                   1                    1
# 2:        A0001        2      3                   2                    2
# 3:        A0001        3      0                   3                    3
# 4:        A0001        4     10                   0                    0
# 5:        A0001        5      0                   1                    1
# 6:        A0002        1     10                   0                    0
# 7:        A0002        2     12                   0                    0
# 8:        A0002        3      0                   1                    1
# 9:        A0002        4      0                   2                    2 
```

希望 data.table 的引用分配将使您保持在 RAM 限制之下。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-06-24T18:17:08.180

好吧，我设法找到了在 SO 上有类似[问题](https://stackoverflow.com/questions/21581451/reset-cumsum-value-to-zero-in-r)的人，并且能够根据我的问题调整答案。感谢@sven-hohenstein

答案是这样的：

```
require(data.table)
DF<-as.data.table(DF) 
```

首先，我创建了一个阈值测试向量，`1`如果`AmtPmt`低于阈值则返回：

```
DF$trsh_test[DF$AmtPmt<trsh]<-1
DF$trsh_test[is.na(DF$trsh_test)]<-0 
```

二、与`ave`功能搭配`seq_along`

```
DF[,Mths_since_last_Pmt2 := 
        trsh_test * ave(trsh_test, c(0L, cumsum(diff(trsh_test) != 0)), 
        FUN = seq_along) ,
        by=CodeContract] 
```

您得到以下输出，这是正确的：

```
CodeContract RelMonth AmtPmt Mths_since_last_Pmt trsh_test Mths_since_last_Pmt2
A0001        1      0                   1         1                    1
A0001        2      3                   2         1                    2
A0001        3      0                   3         1                    3
A0001        4     10                   0         0                    0
A0001        5      0                   1         1                    1
A0002        1      1                   0         1                    1
A0002        2     14                   0         0                    0
A0002        3     14                   1         0                    0
A0002        4     14                   2         0                    0 
```

# html - 为多个输入添加 (+) 更多按钮

> ID：15839446
> 
> 赞同：-2
> 
> 时间：2013-04-05T16:58:49.227
> 
> 标签：html, button, input, add

我有一个多输入表单，我想在其中添加第一个输入可见而其他输入隐藏的功能，当单击“添加更多”按钮时，它将显示下一个输入最多 8 个。我想保留id就是他们的样子。我该怎么办？谢谢你。

```
<label for="stop1">Stop 1 :</label>
 <input type="text" id="stop1" name="stop1" /><br />
<label for="stop2">Stop 2 :</label>
 <input type="text" id="stop2" name="stop2" /><br />
<label for="stop3">Stop 3 :</label>
 <input type="text" id="stop3" name="stop3" /><br />
<label for="stop4">Stop 4 :</label>
 <input type="text" id="stop4" name="stop4" /><br />
<label for="stop4">Stop 5 :</label>
 <input type="text" id="stop5" name="stop5" /><br />
<label for="stop6">Stop 6 :</label>
 <input type="text" id="stop6" name="stop6" /><br />
<label for="stop7">Stop 7 :</label>
 <input type="text" id="stop7" name="stop7" /><br />
<label for="stop8">Stop 8 :</label>
 <input type="text" id="stop8" name="stop8" /><br /> 
```

再次感谢你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-05T17:26:11.290

你可以尝试这样的事情：

```
 <script type="text/javascript">

    int countInput = 1;

    function showInput(){
        document.getElementById("stop"+(countInput +1)).style.display = 'block';
    }

function onLoadFunction(){
    var inputs = document.getElementsByTagName("input");

    for (var i = 0; i < inputs.length; i++) { 
        var id = inputs[i].getAttribute("id"); 
        if ( id != "stop1" ) { 
            document.getElementById("stop"+countInput).style.display = 'block';
        }
    countInput++;
    }

    countInput = 1;

}
</script>

<label for="stop1">Stop 1 :</label>
 <input type="text" id="stop1" name="stop1" /><br />
<label for="stop2">Stop 2 :</label>
 <input type="text" id="stop2" name="stop2" /><br />
<label for="stop3">Stop 3 :</label>
 <input type="text" id="stop3" name="stop3" /><br />
<label for="stop4">Stop 4 :</label>
 <input type="text" id="stop4" name="stop4" /><br />
<label for="stop4">Stop 5 :</label>
 <input type="text" id="stop5" name="stop5" /><br />
<label for="stop6">Stop 6 :</label>
 <input type="text" id="stop6" name="stop6" /><br />
<label for="stop7">Stop 7 :</label>
 <input type="text" id="stop7" name="stop7" /><br />
<label for="stop8">Stop 8 :</label>
 <input type="text" id="stop8" name="stop8" /><br />

<button type="button" onclick="showInput"></button> 
```

只需`onLoadFunction`从页面的 onload 属性中调用，它可能会起作用

# r - 年份和日期的“if”函数

> ID：15839450
> 
> 赞同：2
> 
> 时间：2013-04-05T16:59:02.823
> 
> 标签：r, if-statement

在我的数据集中，我有 2 年的数据，所以有 730 个条目。问题是，第 1 年的“Day of Year”列的格式为 1 到 365，第 2 年的格式相同。

我希望“一年中的日期”列中的值是 1 到 730。

我的“新手功能”：

```
set$DoYnew = if (seq(set$Year==2002)) {set$DoY <- set$DoY+365} 
```

没有让我更进一步。它得到的错误是：

> 在 if (z < 0) { :> 条件的长度 > 1 并且只使用第一个元素

问题出在哪里？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-05T17:41:24.623

该错误告诉您该子句 to `if`应该只有一个*值*。
即，要么`TRUE`或`FALSE`，但*不是*例如`c(TRUE, TRUE, FALSE)`。

所以如果试图完成类似的事情

```
if (c(TRUE, FALSE, TRUE))
  < DO SOMETHING WHEN TRUE >
  < DO SOMETHING DIFFERENT WHEN FALSE > 
```

一个基本的`if`陈述是行不通的。
该语句将只查看第***一个***值（如警告所示）。

对于这种情况，要使用的语句是`ifelse`（正如@Joran 在他的回答中指出的那样）

```
ifelse ( c(TRUE, FALSE, TRUE), 
  < DO SOMETHING WHEN TRUE > , 
  < DO SOMETHING DIFFERENT WHEN FALSE > ) 
```

或者

```
set$DoYnew <- ifelse(set$Year == 2002,DoY + 365,DoY) 
```

* * *

此外，如果您的数据在 data.frame 中，您可以根据需要进行子集化：

```
 myDF$day[myDF$Year==2002] <- 365 + myDF$day[myDF$Year==2002]

 # or if using data.table: 

 myDT[year==2002, day := day + 365] 
```

# asp.net - Response.Redirect 上的错误捕获

> ID：15839452
> 
> 赞同：1
> 
> 时间：2013-04-05T16:59:04.993
> 
> 标签：asp.net, visual-studio-2008

我们正在使用`Response.Redirect`将用户发送到网站以进行问卷调查。我们有一个数据库，用于存储有关用户参加调查的资格的信息，如果他们符合条件，他们的主页上会出现一个“参加调查”按钮，并且一个变量存储调查的 URL。

关于`TakeSurvey_Click`事件，代码原来如下：

```
FormsAuthentication.SignOut();
Response.Redirect(TheURL); 
```

非常直截了当，多年来工作得很好。最近，我们更改了用户被重定向到的网站。成千上万的用户没有遇到任何问题；然而，对于一个相当重要的群体（2-3%），当他们按下“参加调查”按钮时，什么也没有发生。

在搜索互联网后，我有理由确定，我已经尝试了所有推荐的方法来处理这种情况，但没有一个能真正达到我想要的效果。我想要发生的是，如果 Take Survey 没有将用户发送到链接（顺便说一句，我们已经检查了为非工作链接生成的链接，它们是很好的链接），我想要一个信息出现的页面告诉他们我们遇到了问题，如果他们可以向我们发送有关其环境的一些信息，这将有助于解决问题。看起来很简单，但无论我尝试什么，我要么无法让页面不显示，要么，如果我使用覆盖并发送错误，它永远不会显示并且永远不会重定向。

有人有想法么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-05T18:24:30.707

`Response.Redirect`向浏览器发送“302 Moved”响应。浏览器负责导航到目标 URL。

因此，一旦您发出`Response.Redirect`，它就无法控制，并且没有简单的方法可以检测浏览器没有成功导航到您选择的 URL。

现在，有几种不同的方法（我能想到的处理这个）：

*   您也许可以`document.location`从客户端 JavaScript 进行设置。
*   发出重定向的页面可以定期刷新自身（使用 JavaScript 或`meta refresh`）。如果它在应该去别的地方之后发现自己仍然在同一页面上，那么它可以发出警告。
*   或者，更简单地说，发出重定向的页面可能只显示“我们正在派您参加调查。如果 30 秒后，您仍在查看此消息，则说明出了点问题。”。

# sql-server - 设置 xact_abort 并尝试一起捕捉

> ID：15839454
> 
> 赞同：9
> 
> 时间：2013-04-05T16:59:09.530
> 
> 标签：sql-server, try-catch, xact-abort

我的 sp 中有一个 try catch 块，在 try 中只有一个 insert 语句。如果是 pk 违规，则 catch 检查错误代码，如果是则进行更新。但有时我得到“当前事务无法提交，并且无法支持写入日志文件的操作。回滚事务。

在批处理结束时检测到不可提交的事务。事务已回滚。”所以我添加了 xact_abort，但随后我不断收到“EXECUTE 后的事务计数表明 BEGIN 和 COMMIT 语句的数量不匹配。”我找到了这个 [。http://www.ashishsheth.com/post /2009/08/14/Set-XACT_ABORT-ON-and-TryCatch-block-in-Sql-Server-2005.aspx](http://www.ashishsheth.com/post/2009/08/14/Set-XACT_ABORT-ON-and-TryCatch-block-in-Sql-Server-2005.aspx)

如果这是真的。如果打开 xact_abort 的 try 块中出现错误，我的 catch 代码会不会运行？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2013-04-05T19:10:03.283

至少在 SQL SERVER 2008 中，SET XACT_ABORT ON 不会导致跳过 CATCH 块的错误：

这是我尝试使用 Northwind 数据库的代码

```
SET XACT_ABORT OFF
BEGIN TRY
    SELECT 1,  @@TRANCOUNT
BEGIN TRAN
    UPDATE [dbo].[Categories]
    SET Description='BLAH'
    WHERE [CategoryID]=2
    SELECT 2,  @@TRANCOUNT

    SELECT 1/0 as whoops

COMMIT
    SELECT 3,  @@TRANCOUNT

END TRY
BEGIN CATCH
    SELECT 'In Catch. Error occured', 4,  @@TRANCOUNT

     IF (XACT_STATE()) = 0
    BEGIN
        SELECT
            N'There is no transaction'

    END;

     IF (XACT_STATE()) = -1
    BEGIN
        SELECT
            N'The transaction is in an uncommittable state.' +
            'Rolling back transaction.'
        ROLLBACK TRANSACTION;
    END;

    -- Test whether the transaction is committable.
    IF (XACT_STATE()) = 1
    BEGIN
        SELECT
            N'The transaction is committable.' +
            'Committing transaction.'
        COMMIT TRANSACTION;   
    END;

END CATCH 
```

显然，这将在遇到 SELECT 1/0 语句时强制出错。在 SET XACT_ABORT OFF 的情况下，当到达 CATCH 块时，XACT_STATE() 函数返回的值为 1，从而导致运行提交事务的代码。当 SET XACT_ABORT 开启时，在 CATCH 块中返回的值为 -1，因此执行回滚事务的代码。

这是基于：

[http://msdn.microsoft.com/en-us/library/ms175976.aspx](http://msdn.microsoft.com/en-us/library/ms175976.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2019-04-30T18:25:51.153

让我补充一点，在那种特定情况下（尝试插入，如果 PK 违反然后捕获并更新），最好使用 IF EXISTS (select....) 来查看该行是否存在并将您的 UPDATE 语句放在那里. 将您的 INSERT 语句放在 ELSE 块中。干净多了。

# ruby - RVM - 无法在 Amazon Linux 上安装 thrift 检查 string.h 中的 strlcpy()

> ID：15839455
> 
> 赞同：1
> 
> 时间：2013-04-05T16:59:12.083
> 
> 标签：ruby, amazon-ec2, rubygems, rvm, thrift

我在用着：

*   亚马逊 Linux - 2012.09
*   RVM v1.19.1
*   Ruby ruby​​-1.9.3-p362（通过 RVM）
*   系统红宝石 1.8.7
*   Thrift v0.7.0（我知道有一个更新的版本删除了 C 依赖，但是，我有一个需要 v0.7.0 的依赖）

我正在运行以下命令，它会愉快地安装 gems，直到在节俭时崩溃：

```
/usr/local/rvm/bin/rvm ruby-1.9.3-p362 exec bundle install 
```

这会产生错误：

```
Installing thrift (0.7.0)
Gem::Installer::ExtensionBuildError: ERROR: Failed to build gem native extension.

    /usr/local/rvm/rubies/ruby-1.9.3-p362/bin/ruby extconf.rb
checking for strlcpy() in string.h... no
creating Makefile

make
compiling compact_protocol.c
compiling struct.c
struct.c:28:1: error: static declaration of ‘strlcpy’ follows non-static declaration
/usr/local/rvm/rubies/ruby-1.9.3-p362/include/ruby-1.9.1/ruby/missing.h:198:20: note: previous declaration of ‘strlcpy’ was here
make: *** [struct.o] Error 1 
```

我可以看到很多关于这个主题的讨论，但是，没有真正的解决方案 - 任何帮助将不胜感激。

谢谢

# google-apps-script - 如何确定可安装触发器的源脚本？

> ID：15839458
> 
> 赞同：4
> 
> 时间：2013-04-05T16:59:24.910
> 
> 标签：google-apps-script, google-sheets, google-drive-api, google-docs

我有一个我找不到的触发器！至少，我不容易找到，可能不得不求助于蛮力的方法。

我有一百多个脚本和带有脚本的电子表格，并且在其中的某个地方我有一个名为的函数`colorRows`，它被设置为触发器。我知道，因为它显示在我的触发器列表中：

![你所有的触发器](https://i.stack.imgur.com/oKmgk.png)

如何找到包含的脚本`colorRows`？

*   我尝试在 Google Drive 中使用搜索，但它似乎无法找到电子表格中包含的脚本内容。（它确实为独立脚本编制索引，因此确实将我的搜索范围缩小到电子表格。）
*   我可以打开每个电子表格，然后打开脚本，然后搜索 - 蛮力。不，谢谢，那仍然是 75 张。
*   `getProjectTriggers()`顾名思义，脚本服务是基于项目的，并且只在它运行的项目中工作。
*   [编程触发器的电子表格源的](https://stackoverflow.com/questions/11045286/spreadsheet-source-of-a-programmed-trigger)标题听起来不错，但完全不同。
*   我不想停止触发器（这很容易），我想找到代码。所以[如何停止孤立触发器](https://stackoverflow.com/questions/12201847/how-to-stop-orphaned-triggers)是无关紧要的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-14T02:45:20.757

有此投诉的记录，[第 146 期](https://code.google.com/p/google-apps-script-issues/issues/detail?id=146)。它于 2010 年 7 月提出，并于 2011 年 2 月因*无法修复*而关闭。

# jquery - 阅读更多关于动态添加元素的链接功能不起作用

> ID：15839464
> 
> 赞同：0
> 
> 时间：2013-04-05T16:59:44.680
> 
> 标签：jquery, html, function

我有一个函数可以在长文本上设置查看更多链接..它适用于页面加载之前存在的元素，但不适用于动态添加的元素，我在添加元素后调用缩短（）函数，然后它只适用于新添加的元素但是加载之前存在并且正在工作的元素，不起作用....下面是我的代码，您可以[在此处查看 jsfiddle](http://jsfiddle.net/R4uRp/2/)

**HTML**

```
 <div class="main">
      <p class="readmore">this is some text this is some text this is some text this is some text this is some text this is some text this is some text this is some text this is some text this is some text this is some text text this is some text this is some text text this is some text this is some text text this is some text this is some text</p>
    </div>
    <div class="new-elem"></div>
    <a href="#" class="addElem">Add</a> 
```

**JS**

```
jQuery.fn.shorten = function (settings) {
var config = {
    showChars: 100,
    ellipsesText: "...",
    moreText: "See More",
    lessText: "See Less"
};

if (settings) {
    jQuery.extend(config, settings);
}

jQuery('body').on('click', '.morelink', function () {
    var his = jQuery(this);
    if (his.hasClass('less')) {
        his.removeClass('less');
        his.html(config.moreText);
    } else {
        his.addClass('less');
        his.html(config.lessText);
    }
    his.parent().prev().toggle();
    his.prev().toggle();

    return false;
});

return this.each(function () {
    var his = jQuery(this);

    var content = his.html();
    if (content.length > config.showChars) {
        var c = content.substr(0, config.showChars);
        var h = content.substr(config.showChars, content.length - config.showChars);
        var html = c + '<span class="moreellipses">' + config.ellipsesText + '&nbsp;</span><span class="morecontent"><span>' + h + '</span>&nbsp;&nbsp;<a href="javascript://nop/" class="morelink">' + config.moreText + '</a></span>';
        his.html(html);
        jQuery(".morecontent span").hide();
    }
});
}

jQuery('.readmore').shorten();  //for load time

jQuery(document).on('click', '.addElem', function () {
    jQuery('.new-elem').append('<p class="readmore">this is some text this is some text this is some text this is some text this is some text this is some text this is some text this is some text this is some text this is some text this is some text</p>');
    jQuery('.readmore').shorten();  //for newly added elements

}); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-05T17:21:02.087

似乎每当单击“添加”链接时，您都会在所有元素上运行“缩短”功能，这会将处理程序多次`.readmore`附加到正文。`click`

第一次单击“添加”链接时，添加了一个段落，并且单击处理程序添加了 2 次（2 个段落中的每个段落一次），单击“查看更多”链接会导致处理程序运行 2 次。第 2 次单击单击处理程序，添加了另一个段落，并且单击处理程序被添加了 3 次，单击“查看更多”链接导致处理程序运行 5 次。下次单击“添加”链接时，会添加另一个段落，并且单击处理程序会再添加 4 次。单击“查看更多”链接会使处理程序运行 9 次。等等。

我认为`jQuery('body').on('click'...)`应该将调用移出`shorten`函数。另外，`jQuery('.readmore').shorten();`应该改成`jQuery('.addElem .readmore:last').shorten();`. 这将导致`click`“查看更多”链接的处理程序仅附加一次，并且将导致`shorten`每个链接仅调用一次方法`.readmore`。

# javascript - 尝试从新页面聚焦已打开的弹出窗口

> ID：15839465
> 
> 赞同：1
> 
> 时间：2013-04-05T16:59:45.067
> 
> 标签：javascript, popup

我有两个页面，页面“a”和页面“b”。

Page'a" 生成一个js弹窗

```
function loadWindow(){
var params = 'status = 0, height = 300, width = 480, resizable = 0';
if(isTouchDevice()){
    params = ''
}
w = window.open('/audio/audioplayer.php?id='+audioId, 'audioplayer', params);
w.document.close();
} 
```

然后访问者转到页面 b（弹出窗口仍然打开）。我想要页面 b 上的按钮，当按下它时，它会将焦点带到在页面 a 上创建的弹出窗口。

我已经尝试寻找答案，但没有任何效果。我知道我可以把注意力集中在

```
window.open('', 'audioplayer', ''); 
```

或者

```
w.focus(); 
```

但问题是我不知道如何从页面“a”引用弹出窗口

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-05T17:09:32.393

您无法访问另一个窗口，因为当您转到页面 b 时，您的参考资料会消失。大多数浏览器不允许这样做 - 出于安全原因。如果这是可能的，任何页面都可以访问您的所有浏览器选项卡。

你可以测试一下。通过打开弹出窗口，然后在其中执行 window.opener。这将返回页面 a。但是当您从页面 a 浏览到页面 b 时。弹出窗口的 opener 属性将为空。

**一种解决**方法是将页面 b 动态加载到页面 a 中。这样窗口和参考将被保留。

# html - 在我的 Ember.js 应用程序中保存编辑状态的最佳方法

> ID：15839467
> 
> 赞同：0
> 
> 时间：2013-04-05T16:59:50.990
> 
> 标签：html, ember.js

在过去的几天里，我一直在研究我的应用程序，试图找出如何最好地跟踪给定控制器中的编辑状态。当然，问题是，这些 ObjectController 一次存在多个，并且在给定时刻只能编辑一个。下面是重要的代码：

**应用程序.js：**

```
var App = Ember.Application.create();

//ROUTES
App.Router.map(function() {
  this.resource('tasks', function() {
    this.resource('task', {path: ':task_id'});
  });
});

App.IndexRoute = Ember.Route.extend({
  redirect: function() {
    this.transitionTo('tasks');
  }
});

App.TasksRoute = Ember.Route.extend({
  model: function() {
    return App.Task.find();
  }
});

App.TaskRoute = Ember.Route.extend({});

//CONTROLLERS
App.TasksController = Ember.ArrayController.extend({
  isEditing: null,
  editing: false,
  newTask: function() {
    console.log('new task');
  },
  toggleEdit: function(id) {
    this.set('isEditing', id);
    if ($('#collapse' + this.get('isEditing')).hasClass('in')) {
      this.set('editing', false);
      this.set('isEditing', null);
      $('.in').collapse('hide');
    } else {
      this.set('editing', true);
      $('.in').collapse('hide');
      $('#' + 'collapse' + this.get('isEditing')).collapse('toggle');
    }
  }
});

App.TaskController = Ember.ObjectController.extend({
  needs: 'tasks',
  collapseId: function() {
    return "collapse" + this.get('id');
  }.property('id'),
  collapseHref: function() {
    return  "#collapse" + this.get('id');
  }.property('id'),
});

//VIEWS
App.ApplicationView = Ember.View.extend({
  didInsertElement: function() {
    var self = this;
    Ember.run.schedule('afterRender', function() {
      self.$('.navbar').affix({offset: -1000});
    });
  }
});

//HANDLEBARS HELPERS

//STORE DEFINITION
App.Store = DS.Store.extend({
  revision: 11,
  adapter: 'DS.FixtureAdapter'
    /*DS.RESTAdapter.extend({
      url: 'http://localhost:3000'
    })*/
});

//MODELS
App.Task = DS.Model.extend({
  summary: DS.attr('string'),
  description: DS.attr('string'),
  start: DS.attr('string'),
  end: DS.attr('string'),
  recurrence: DS.attr('string')
});

//FIXTURE DATA
App.Task.FIXTURES = [{
  id: "q5ji9chrh1hcu05dohvrf4aumc",
  summary: "Test",
  description: null,
  start: "2013-04-01T10:00:00-07:00",
  end: "2013-04-01T11:00:00-07:00",
  recurrence: "FREQ=WEEKLY;BYDAY=MO,WE,TH,FR"
}, {
  id: "mm4m3pq6icbgbl6m49jpdhi8j0",
  summary: "Test 2",
  description: "absafdaerwer",
  start: "2013-04-01",
  end: "2013-04-02",
  recurrence: null
}]; 
```

**主页.HTML：**

```
<!--TEMPLATES-->

<script type="text/x-handlebars">
  <div class="navbar" data-spy="affix">
    <div class="navbar-inner">
      <div class="container">
        <a class="btn btn-navbar">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </a>
      </div>
    </div>
  </div>

  {{outlet}}
</script>

<script type="text/x-handlebars" id="tasks">
  <div class="row-fluid span8 offset2 task-list">
    <div class="space-top"><div>
    <div class="accordion" id="accordion">
      {{partial 'tasks/newTask'}}
      {{#each task in controller}}
        <div class="accordion-group">
          {{render 'task' task}}
        </div>
      {{/each}}
    </div>
  </div>
</script>

<script type="text/x-handlebars" id="tasks/_newTask">
  <div class="accordion-group">
    <div class="new-task-header accordion-heading" {{action newTask on="click"}}>
      <span class="accordion-toggle" data-toggle="collapse" data-parent="#accordion" href="#collapseNew">New Task...</span>
    </div>
    <div id="collapseNew" class="accordion-body collapse">
      <div class="new-task accdion-inner">
        {{#if task.description}}
          <p>{{task.description}}</p>
        {{else}}
          <p>No description</p>
        {{/if}}
      </div>
    </div>
  </div>
</script>

<script type="text/x-handlebars" id="task">
  <div class="task">
  {{#linkTo 'task' task}}
    <div class="accordion-heading" {{action toggleEdit task.id on="click"}}>
      <span class="accordion-toggle" data-toggle="collapse" data-parent="#accordion">
        {{#if controllers.tasks.editing}}
          editing {{task.summary}}
        {{else}}
          {{task.summary}}
        {{/if}}
      </span>
    </div>
  {{/linkTo}}
  </div>
  <div {{bindAttr id="collapseId"}} class="accordion-body collapse">
    <div class="edit-task accdion-inner">
      {{#if task.description}}
        <p>{{task.description}}</p>
      {{else}}
        <p>No description</p>
      {{/if}}
    </div>
  </div>
</script> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-05T20:12:50.840

`TaskController`我相信在这段代码中，没有创建多个s。尝试`itemController: 'task'`在`ArrayController`. （[在此处](http://emberjs.com/api/classes/Ember.ArrayController.html)讨论，如果您正在使用，请参见[此处](http://emberjs.com/blog/2013/03/30/ember-1-0-rc2.html)`1.0.0-rc.2`提及。）这样您就可以在该特定任务上设置一个属性（如果ed 则参考）。这能澄清什么吗？`editing``tasks``need`

# ios - iOS 性能、标签/文本字段与 PNG

> ID：15839471
> 
> 赞同：4
> 
> 时间：2013-04-05T17:00:09.433
> 
> 标签：ios, performance, text

只是在一个带有大量文本的 iPad 应用程序上工作，我想知道使用 UITextFields 和 UILabels 是否比简单地使用带有 PNG 文本的 UIImageView 更多地影响性能/内存。

在某些情况下，文本是动画的，但大多数情况下是静态的。

谢谢你。

更新：根据 Marc 的建议，我对一个新的 XCode 项目进行了一些挖掘。以下是实验细节：

测试1：

*   适用于 iPad 的全新单视图模板 XCode 项目（不使用情节提要）
*   一个以段落文本的 678x828 图像为中心的图像视图（36k 图像）
    *   自定义字体和样式被烘焙到图像中。

结果： **756kb 的 Live Bytes**和**842kb 的 Live Bytes w/ Retina PNG**

测试 2：

*   添加了具有不同段落的第二个图像视图 (699x749 82k)

结果： **767kb 的 Live Bytes**和**854kb 的 Live Bytes w/ Retina PNG**

测试 3：

*   拿了相同的副本并添加了4个UILabels
*   设置字体以匹配 PNG 中烘焙的字体
*   嵌入的自定义字体

结果： **965kb 的实时字节**

测试 4：

*   从第二个图像视图中添加了 4 个具有相同文本和样式的自定义文本标签

结果： **1024kb 的实时字节**

从这个角度来看，使用带有烘焙副本和样式的 PNG 似乎具有更低的内存占用和更好的缩放。显然，这是一个非常快速和肮脏的实验。

# javascript - Angular js 对象数组，用于使用 ngOptions 进行选择

> ID：15839472
> 
> 赞同：0
> 
> 时间：2013-04-05T17:00:11.887
> 
> 标签：javascript, angularjs

我有一个可以包含多种技能的角色。技能可从注入的服务中获得。我基本上想要的是这样的：

```
<div ng-repeat="skill in character.getSkills()">
    <select ng-model="skill" ng-options="select as s.toString() for s in getAllSkills()"></select>
    <button ng-click="character.removeSkill(skill)" >Remove Skill</button>
</div> 
```

使用此代码，选择框无法正常工作。角色中没有设置技能，并且选择不会保留在下拉列表中。

我错过了什么吗？

在此先感谢，罗默

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-06T09:08:37.440

毕竟，我通过子作用域中的 $index 属性引用了 character.skills 数组中的技能：

```
<select ng-model="character.skills[$index]" ng-options="sk as sk.toString() for sk in getAllSkills()"></select> 
```

# java - GWT_HOME 不存在（mac 10.8.3）

> ID：15839477
> 
> 赞同：1
> 
> 时间：2013-04-05T17:00:53.350
> 
> 标签：java, eclipse, macos, gwt

我在 mac os 10.8.3 上运行 Eclipse Juno。我用 eclipse 安装了 GWT (2.5.2) 插件，但是当我尝试运行我的项目时，总是出现这个错误：

```
BUILD FAILED 
/../../${env.GWT_HOME} does not exist. 
```

同样在我的构建文件中，在以下行中：

```
<taskdef resource="dml-ant.xml" classpathref="project.classpath"/> 
```

它显示了同样的错误。

现在我已经看到了[THIS](https://stackoverflow.com/questions/10031079/gwt-home-on-mac)和[THIS](https://stackoverflow.com/questions/8540620/the-project-xxx-does-not-have-any-gwt-sdks-on-its-build-path?rq=1)线程，但没有一个解决方案有效。

在 Eclipse 之外，我在 .profile 文件中定义了 GWT_HOME，如下所示：

```
export GWT_HOME=/Applications/eclipse/plugins/com.google.gwt.eclipse.sdkbundle_2.5.1 
```

在 Eclipse 内部，我有以下配置：

```
- Preferences->Google->Web Toolkit-> GWT::2.5.1::[Location of the gwt-2.5.1 folder in plugins]
- Preferences->Java->Build Path->Classpath Variables-> GWT_HOME [defined to the same place] 
```

在我的项目中：

```
- Properties->Google->Web Toolkit (only one selected)-> Use default SDK (GWT - 2.5.1)
- Properties->Java Build Path->Order and Export->GWT SDK [GWT - 2.5.1] almost on top (above maven libraries, at least) 
```

我已经尝试了一些东西，比如更改 gwt-2.5.1 文件夹（以及它的 GWT_HOME 路径），重新安装了几次并使用旧版本，多次重新启动 eclipse 和计算机等。我可能在这里遗漏了一些明显的东西，这是我第一次使用 GWT（也是第一次使用 Eclipse）。

提前感谢您的所有帮助:)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-06T11:14:09.317

你的项目是用 ant 设置的，不是吗？，如果是这样：

您的 ant 文件 build.xml 似乎没有以下行：

```
 <property environment=”env”/> 
```

运行 eclipse 时也会发生这种情况，它不会获取您在 .profile 中设置的环境变量，也许您必须从​​命令行启动 eclipse。

最后，作为快速修复，编辑您的 ant.xml 文件并将所有出现的 ${env.GWT_HOME} 替换为 /Applications/eclipse/plugins/com.google.gwt.eclipse.sdkbundle_2.5.1。

# angularjs - ngShow 上的 ngAnimate。第一次开始时阻止动画

> ID：15839479
> 
> 赞同：14
> 
> 时间：2013-04-05T17:01:00.983
> 
> 标签：angularjs, ng-animate

我正在玩最近添加的 angular.js 动画功能，但这不能按预期工作

```
<style>
    .myDiv{
        width:400px;
        height:200px;
        background-color:red;
    }
    .fadeIn-setup,.fadeOut-setup {
      -webkit-transition: 1s linear opacity;
      -moz-transition: 1s linear opacity;
      -o-transition: 1s linear opacity;
      transition: 1s linear opacity;
    }
    .fadeIn-setup{
      opacity:0;
    }
    .fadeOut-setup{
      opacity:1;
    }
    .fadeIn-setup.fadeIn-start {
      opacity: 1;
    }
    .fadeOut-setup.fadeOut-start{
        opacity:0;
    }
</style>

<div ng-app>
    <div ng-controller='ctrl'>
       <input type='button' value='click' ng-click='clicked()' />  
       <div ng-show="foo == true"  class='myDiv' ng-animate="{show: 'fadeIn', hide:'fadeOut'}">
       </div>
     </div>
</div>

function ctrl($scope){
    $scope.foo = false;
    $scope.clicked = function(){
       $scope.foo = !($scope.foo);
    }
} 
```

[http://jsfiddle.net/Kx4TS/1](http://jsfiddle.net/Kx4TS/1)

它破坏了 myDiv`dom.ready`并开始淡出。而它最初应该被隐藏。如何解决？

* * *

## 回答 #1

> 赞同：40
> 
> 时间：2014-08-29T06:00:00.137

即使现在使用 1.2.22，这个问题仍然存在。但是，这些解决方案之一很容易解决它。

在尝试了这里提到的所有解决方案之后，我想特别强调 cocoggu 对 ac360 的建议，因为它是迄今为止最简洁的并且“有效”。

正如他所建议的，只需将 ng-hide 类添加到有问题的元素即可立即解决问题。- 它可以防止初始动画故障并允许所有后续动画按预期运行。

**工作解决方案**感谢 cocoggu

`<div id="offending-element" class="ng-hide"></div>`

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2013-04-07T19:00:57.937

我为您的问题找到了 2 种不同的解决方案

最简单的解决方案：在 div 中添加内联样式**style="display:none"**

**另一种解决方案是使用ng-class="state"**向 div 添加一个初始类， 并在单击按钮时重置该类

```
function ctrl($scope){
    $scope.state = 'hide';
    $scope.foo = false;
    $scope.clicked = function() {
       $scope.state = undefined;  
       $scope.foo = !($scope.foo);
    }
} 
```

连同以下CSS：

```
.hide {
    display: none;
} 
```

我想我会使用第一个也是最简单的解决方案

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-03-30T12:31:53.907

这应该可以解决问题：

```
<div ng-class="ng-hide" ng-show="foo == true"  class='myDiv'"> 
```

这是这里的重要部分：`ng-class="ng-hide"`

编辑：正如评论中指出的那样，上述方法不起作用。它应该如下所示：

```
<div class="ng-hide" ng-show="foo == true"  class='myDiv'"> 
```

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2013-05-27T02:29:49.053

现在已解决此问题。升级到 1.1.5。

# xna-4.0 - 将变量传递给另一个类？

> ID：15839483
> 
> 赞同：0
> 
> 时间：2013-04-05T17:01:09.747
> 
> 标签：xna-4.0

如何将变量传递给另一个类？这两个课程不是我的主要课程。我想在 class1 中使用的变量是 test，它是 class2 的 int 5。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-08T16:22:50.560

您可以将它们公开（或者，eben 更好，使用 get set），然后您可以访问它们。公共整数名称；

# algorithm - 如何就地编写合并？

> ID：15839485
> 
> 赞同：0
> 
> 时间：2013-04-05T17:01:14.953
> 
> 标签：algorithm, merge

我们中的许多人都知道来自mergesort 的merge 子例程。在这里，在 python 中：

```
def merge(left, right):
    result = []
    i ,j = 0, 0
    while i < len(left) and j < len(right):
        if left[i] <= right[j]:
            result.append(left[i])
            i += 1
        else:
            result.append(right[j])
            j += 1 
```

有没有一种方法可以在没有额外数组的情况下编写合并（`result`在这种情况下没有）？我尝试利用字符串 $s = xy = (y^Rx^R)^R$ （其中 R 表示反向）无济于事的事实。

这种就地版本的合并将假设两个输入子数组是相邻的。（对于 3 个输入索引 i、j 和 k，第一个数组可能来自 [i, j)，第二个可能来自 [j, k)。）

顺便说一句，我愿意使用 Python 以外的语言，例如 C++ 或 Java。

# android - 目录存在和不存在

> ID：15839489
> 
> 赞同：0
> 
> 时间：2013-04-05T17:01:54.380
> 
> 标签：android

我正在尝试将文件写入我的 android 手机上的 SD 卡，但目录似乎有问题。它存在但不存在。我的意思是当我去安卓手机上的文件浏览器，寻找 GPStracker 文件夹时，我找不到它。`dir.exists()`然而在程序中，当它检查下面的 if 条件时，它似乎承认这个目录存在。然后，当它到达`canWrite()`函数时，它总是返回 false。我现在不知道出了什么问题，有人有任何调试想法吗？谢谢。

```
boolean mExternalStorageAvailable = false;
boolean mExternalStorageWriteable = false;
String state = Environment.getExternalStorageState();

if (Environment.MEDIA_MOUNTED.equals(state)) {
    // We can read and write the media
    mExternalStorageAvailable = mExternalStorageWriteable = true;
} else if (Environment.MEDIA_MOUNTED_READ_ONLY.equals(state)) {
    // We can only read the media
    mExternalStorageAvailable = true;
    mExternalStorageWriteable = false;
} else {
    // Something else is wrong. It may be one of many other states, but all we need
    //  to know is we can neither read nor write
    mExternalStorageAvailable = mExternalStorageWriteable = false;
} 
```

^ 这两个现在都返回 true，解决了这个问题。

显现：

```
<?xml version="1.0" encoding="utf-8"?>
<manifest xmlns:android="http://schemas.android.com/apk/res/android"
    package="com.tinywebteam.gpstracker"
    android:versionCode="1"
    android:versionName="1.0" >

    <uses-permission android:name="android.permission.ACCESS_COARSE_LOCATION" />
    <uses-permission android:name="android.permission.INTERNET" />
    <uses-permission android:name="android.permission.READ_EXTERNAL_STORAGE" />
    <uses-permission android:name="android.permission.WRITE_EXTERNAL_STORAGE"/>
    <uses-sdk
        android:minSdkVersion="8"
        android:targetSdkVersion="17" />

    <application
        android:allowBackup="true"
        android:icon="@drawable/ic_launcher"
        android:label="@string/app_name"
        android:theme="@style/AppTheme" >
        <activity
            android:name="com.tinywebteam.gpstracker.MainActivity"
            android:label="@string/app_name" >
            <intent-filter>
                <action android:name="android.intent.action.MAIN" />

                <category android:name="android.intent.category.LAUNCHER" />
            </intent-filter>
        </activity>
    </application>

</manifest> 
```

代码：

```
try {
            File sdCard = Environment.getExternalStorageDirectory();
            File dir = new File(sdCard + "/GPStracker/data");
            if (!dir.exists()) {
                if (!dir.mkdirs())
                    throw new FileNotFoundException("Couldn't make directory.");
                if (!dir.isDirectory())
                    throw new FileNotFoundException("Couldn't verify directory.");
            }
            File fileOut = new File(dir, "GPSTracker_" + ts + ".csv");
            if (fileOut.canWrite()) {
                FileOutputStream out = new FileOutputStream(fileOut);
                out.write(fileStr.getBytes());
                out.close();
                System.out.println("File written successfully");
            } else {
                System.out.println("Could not write to file");
            }
        } catch (FileNotFoundException e) {
            e.printStackTrace();
        } catch (IOException e) {
            e.printStackTrace();
        } 
```

# bluetooth - 蓝牙可以在无连接（单向）模式下工作吗？

> ID：15839490
> 
> 赞同：3
> 
> 时间：2013-04-05T17:01:57.717
> 
> 标签：bluetooth, bluetooth-lowenergy, bluez, bluetooth-sco

我已经看到一些关于蓝牙 4.0/LE 提供此功能的参考，但我不确定从哪里开始或如何实现它。

明确地说，我的意思是真正的无连接，只有一个设备上的接收器和另一个设备上的发射器。（或者，更具体地说，一个设备上的强大发射器和另一个设备上的弱发射器，因此可以配对设备）。

诸如“即时警报服务”之类的东西听起来不错，但它是否好得令人难以置信？很难判断信号在哪一层是“无连接的”。任何人都可以指出一些文档/实现示例吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-06T02:31:34.973

查看[Core Spec V4.0](http://developer.bluetooth.org/TechnologyOverview/Documents/Core_SPEC.pdf)并搜索“无连接”。有关于使用无连接 L2CAP 方法的详细信息。

# python - 如何清除 Tkinter 画布？

> ID：15839491
> 
> 赞同：52
> 
> 时间：2013-04-05T17:02:07.793
> 
> 标签：python, python-3.x, tkinter, tkinter-canvas

当我使用以下方法绘制形状时：

```
canvas.create_rectangle(10, 10, 50, 50, color="green") 
```

Tkinter 是否会跟踪它的创建事实？

在我正在制作的一个简单游戏中，我的代码`Frame`创建了一堆矩形，然后绘制一个黑色的大矩形以清除屏幕，然后绘制另一组更新的矩形，依此类推。

我是否在内存中创建了数千个矩形对象？

我知道您可以将上面的代码分配给一个变量，但是如果我不这样做并且直接绘制到画布上，它会保留在内存中，还是只绘制像素，就像在 HTML5 画布中一样？

* * *

## 回答 #1

> 赞同：102
> 
> 时间：2013-04-05T17:46:31.773

每个画布项目都是 Tkinter 跟踪的对象。如果您只是通过绘制一个黑色矩形来清除屏幕，那么您实际上已经造成了内存泄漏——最终您的程序将由于已绘制的数百万个项目而崩溃。

要清除画布，请使用[delete](http://effbot.org/tkinterbook/canvas.htm#Tkinter.Canvas.delete-method)方法。给它一个特殊的参数`"all"`来删除画布上的所有项目（字符串`"all"`“是一个特殊的标签，代表画布上的所有项目）：

```
canvas.delete("all") 
```

如果您只想删除画布上的某些项目（例如前景对象，而将背景对象留在显示屏上），您可以为每个项目分配标签。然后，`"all"`您可以提供标签的名称，而不是 。

如果您正在创建游戏，您可能不需要删除和重新创建项目。例如，如果您有一个在屏幕上移动的对象，您可以使用[move](http://effbot.org/tkinterbook/canvas.htm#Tkinter.Canvas.move-method)或[coords](http://effbot.org/tkinterbook/canvas.htm#Tkinter.Canvas.coords-method)方法来移动该项目。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2013-04-05T17:32:50.807

绘制到画布上的项目是持久的。 `create_rectangle`返回您需要跟踪的项目 ID。如果您不删除旧项目，您的程序最终会变慢。

来自 Fredrik Lundh 的[Tkinter 简介](http://effbot.org/tkinterbook/canvas.htm#patterns)：

> 请注意，添加到画布的项目会一直保留，直到您将其删除。如果要更改绘图，可以使用 `coords`、`itemconfig`、 和等方法`move`修改项目，或使用`delete`删除它们。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-04-05T17:33:27.167

是的，我相信您正在创建数千个对象。如果您正在寻找一种简单的方法来一次删除一堆，请使用[此处描述](https://anzeljg.github.io/rin2/book2/2405/docs/tkinter/canvas-tags.html)的画布标签。这使您可以对大量对象执行相同的操作（例如删除）。

# apache-flex - ObjectUtil.copy 不会复制任何 ArrayCollection

> ID：15839493
> 
> 赞同：0
> 
> 时间：2013-04-05T17:02:10.723
> 
> 标签：apache-flex, flex3, adobe, arraycollection

一段时间以来，在我的应用程序中，我使用 ObjectUtil.copy 来复制数组集合。最近我们一直在对应用程序进行大量更改，并且它开始破坏我的任何复制命令。我最初认为这是由于数组中的自定义类，但通过测试空或简单的 ArrayCollections 排除了这一点。

这些都不适合我：

```
var a:ArrayCollection = ObjectUtil.copy(new ArrayCollection());
newWindow.months = ObjectUtil.copy(months) as ArrayCollection; 
```

在第二行中，newWindow 只是一个新的画布，我将使用 'months' 属性显示，而months 是一个 ArrayCollection，其中只有字符串。

在 .copy() 函数内部，它会中断`buffer.writeObject(value);`并抛出此错误“ArgumentError：错误 #2004：参数之一无效。”

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-05T20:34:50.270

复制源数组

```
newWindow.months = new ArrayCollection(ObjectUtil.copy(months.source) as Array); 
```

# maven - 在第一个错误/失败后使用 maven surefire 停止测试执行

> ID：15839495
> 
> 赞同：6
> 
> 时间：2013-04-05T17:02:14.420
> 
> 标签：maven, junit, maven-surefire-plugin

我正在使用 maven surefire 插件来执行我的应用程序的 junit 测试。

我想在第一次失败或错误后停止执行。在我的情况下，这些是修改应用程序状态的集成测试，所以我需要知道失败后的确切系统状态（我们有一个奇怪的问题，如果单独执行测试通过，但如果与整个套件一起执行则不会）。

是否可以？[我在这里](http://maven.apache.org/surefire/maven-surefire-plugin/test-mojo.html)的插件文档中找不到选项。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-04-05T17:45:10.943

实际上，事实证明这与 maven-surefire-plugin 是不可能的。

[我在这里](https://stackoverflow.com/questions/1923857/is-there-a-way-to-fail-fast-for-junit-with-the-maven-surefire-plugin)找到了答案。

我实际上最终使用了@mhaller 提出的解决方案

所以我实现了一个这样的junit监听器：

```
package br.com.xpto;

import org.junit.runner.Description;
import org.junit.runner.notification.Failure;
import org.junit.runner.notification.RunListener;

import br.com.caelum.brutal.integration.scene.AcceptanceTestBase;

public class FailFastListener extends RunListener {

    public void testFailure(Failure failure) throws Exception {
        System.err.println("FAILURE: " + failure);
        AcceptanceTestBase.close();
        System.exit(-1);
    }

    @Override
    public void testFinished(Description description) throws Exception {
        AcceptanceTestBase.close();
        System.exit(-1);
    }
} 
```

并像这样配置 maven-surefire：

```
<plugin>
    <artifactId>maven-surefire-plugin</artifactId>
    <version>2.10</version>
    <executions>
        <execution>
            <id>surefire-integration</id>
            <phase>integration-test</phase>
            <goals>
                <goal>test</goal>
            </goals>
            <configuration>
                <excludes>
                    <exclude>none</exclude>
                </excludes>
                <includes>
                    <include>**/scene/**/*Test.java</include>
                </includes>
                <forkMode>once</forkMode>
                <properties>
                    <property>
                        <name>listener</name>
                        <value>br.com.caelum.brutal.integration.util.FailFastListener</value>
                    </property>
                </properties>
            </configuration>
        </execution>
    </executions>
    <configuration>
        <excludes>
            <exclude>**/*</exclude>
        </excludes>
    </configuration>
</plugin> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-05T17:18:59.643

首先对于集成测试，您应该使用[maven-failsafe-plugin](http://maven.apache.org/surefire/maven-failsafe-plugin/integration-test-mojo.html)而*不是*maven-surefire-plugin。

此外，如果您有失败的集成测试，这通常是在 CI 环境中完成的。之后，您可以通过以下方式运行失败的集成测试

```
mvn -Dit.test=NameOfTheFailedIntegrationTest verify 
```

分别地。

# c# - c# 是否有一个类似 rspec 的测试框架，可以将类似的测试组合在一起？

> ID：15839507
> 
> 赞同：2
> 
> 时间：2013-04-05T17:02:59.537
> 
> 标签：c#, nunit

我想要一个测试框架，可以更轻松地将类似的测试组合在一起。

我喜欢 rpsec 如何更容易地将类似的测试组合在一起，你能用任何基于 .net 的框架来做到这一点吗？

我现在正在使用 nunit。

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2013-04-12T03:33:24.693

您不是在寻找 NUnit 类别属性吗？ [http://www.nunit.org/index.php?p=category&r=2.2](http://www.nunit.org/index.php?p=category&r=2.2)

# c++ - 扩展数组时出错：找不到运算符

> ID：15839510
> 
> 赞同：1
> 
> 时间：2013-04-05T17:03:14.023
> 
> 标签：c++, dynamic-memory-allocation

当我调用 addBranch 函数时，我想将我的数组扩展一，然后将新的 Branch 对象添加到该扩展的空白区域，并且我试图防止我的代码发生内存泄漏。我以为我做得对，但我被这个功能困住了。

它给了我错误“**二进制'='：找不到运算符，它采用'Branch *'类型的右手操作数（或没有可接受的转换）** ”。我需要一些帮助，将最后一个元素分配给一个新的 Branch 对象，该对象在功能消除后不会被删除。我只是 C++ 的新手，所以可能会有一些大错误。我不允许使用向量等。

```
 // ------- Adds a branch to system -------- //
    void BankingSystem::addBranch(const int id, const string name){
        if(isBranchExisting(id)){
            cout << "\n\tBranch " << id << " already exists. Please try it with another id number.";
        }
        else if(!isBranchExisting(id)){
            Branch* tempArray = new Branch[cntAccounts];
            for(int i = 0; i<cntAccounts; i++){
                tempArray[i] = allBranches[i];
            }

            delete[] allBranches;

            allBranches = new Branch[cntAccounts+1];
            for(int i = 0; i<cntAccounts; i++){
                allBranches[i] = tempArray[i];
            }
            allBranches[cntAccounts] = new Branch(id, name);  // error at this line

        }
    } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-05T17:09:23.660

正如错误消息所说，您正在尝试将指针分配给对象。您（可能）想要分配一个对象：

```
allBranches[cntAccounts] = Branch(id, name); // no "new" 
```

我还建议您使用`std::vector<Branch>`而不是手工伪造的数组。这将修复由于忘记删除而导致的内存泄漏`tempArray`，或者如果您确实添加了缺失的内容，则会引发异常`delete[]`。

此外，如果你确实使用`vector`，那么整个舞蹈可以替换为

```
allBranches.push_back(Branch(id, name)); 
```

# c - 程序在 pthread 锁上旋转

> ID：15839515
> 
> 赞同：3
> 
> 时间：2013-04-05T17:03:37.937
> 
> 标签：c, multithreading, posix, critical-section

在这个练习中我的头撞在墙上几个小时后，我被困在那堵墙上。首先，这是一个旨在查找和打印介于 1 和 之间的所有素数的程序`ceiling`，其中上限是一些用户输入。设计是实现 POSIX 线程。

在我的程序中，它成功运行，直到线程方法中的后续迭代之一。当它到达后面的迭代时，它会走到线`pthread_mutex_lock(lock);`并旋转，迫使我用 Ctrl+z 杀死它。我一直在使用的 2 个输入`1`用于线程数和`10`上限。这个缺陷是可重现的，因为每次我尝试它都会发生。注意：虽然这段代码应该能够实现多个线程，但我希望在添加更多线程之前让它与 1 个子线程一起正常工作。

```
#include <stdio.h>
#include <stdlib.h>
#include <pthread.h>

int* numbermarker = NULL;
int* buffer = NULL;
int* checked = NULL;
int pullposition = 0;
int placeposition = 0;
pthread_mutex_t* lock;
int ceiling;

/*This method places one of the primes in the buffer. It 
offers a safe way to manage where the next value will be placed*/
void placevalue(int value){
    buffer[placeposition] = value;
    placeposition++;
}

void* threadmethod(){   
    int i;
    int k;
    int l;
    while(1){   
        printf("pull %d   number %d \n",pullposition, buffer[pullposition]);
        pthread_mutex_lock(lock);
        printf("FLAG\n");
        l = buffer[pullposition];
        pullposition++;
        printf("pullTWO %d   number %d \n",pullposition, buffer[pullposition-1]);
        pthread_mutex_unlock(lock);
        for(k=l+1;k<=ceiling;k++){
            if(k%l){
                if(k%2){
                    checked[k]=1;
                    placevalue(k);
                }
            }
            else{
                numbermarker[k-1] = 1;
            }
        }
        int sum=0;
        for(i=0; i<ceiling; i++){
            if(numbermarker[i]){
                checked[i] = numbermarker[i];
            }
            printf("checked|%d|%d|%d|%d|%d|%d|%d|%d|%d|%d|\n",
checked[0], checked[1], checked[2], checked[3], checked[4], checked[5], checked[6], checked[7], checked[8], checked[9]); 
            sum += checked[i];
            printf("sum %d    ceiling %d\n",sum,ceiling);
        }
        printf("number |%d|%d|%d|%d|%d|%d|%d|%d|%d|%d|\n",
numbermarker[0],    numbermarker[1],    numbermarker[2],    numbermarker[3],    numbermarker[4],    numbermarker[5],    numbermarker[6],    numbermarker[7],    numbermarker[8],    numbermarker[9]);
        if(sum == ceiling){
            return NULL;
        }
    }
}

int main()
{
    int numthreads;
    int i;

    printf("Enter number of threads: \n");
    scanf("%d", &numthreads);

    printf("Enter the highest value to check \n");
    scanf("%d", &ceiling);

    /*  This will hold 1's and 0's.
            1 = number has been checked or is
                    confirmed not to be a prime
            0 = number is a possible prime

            The idea behind these values is that the next
            prime can always be identified by the 0 with
            the lowest index
    */

    numbermarker = (int*)malloc(sizeof(int)*(ceiling));
    checked = (int*)malloc(sizeof(int)*(ceiling));

    /*This will hold the primes as they are found*/
    buffer = (int*)malloc(sizeof(int)*(ceiling));

    /*allocate space for the lock*/
    lock = (pthread_mutex_t *) malloc(sizeof(pthread_mutex_t));
    pthread_mutex_init(lock,NULL);

    for(i=0; i<ceiling; i++){
        if(i<1){
            numbermarker[i] = 1;
        }
        else{
            numbermarker[i] = 0;
        }
        checked[i]=0;
        buffer[i]=0;
        printf("%d \n",numbermarker[i]);
    }
    checked[0]=1;
    placevalue(2);
    printf("checked|%d|%d|%d|%d|%d|%d|%d|%d|%d|%d|\n", checked[0], checked[1], checked[2], checked[3], checked[4], checked[5], checked[6], checked[7], checked[8], checked[9]);

    pthread_t **tid = (pthread_t **) malloc(sizeof(pthread_t *) * numthreads);

    for(i=0;i<numthreads;i++){
        tid[i] = (pthread_t *) malloc(sizeof(pthread_t));
    }

    for(i=0;i<numthreads;i++){
        if(pthread_create(tid[i],
                                            NULL,
                                            threadmethod,
                                            NULL)){
            printf("Could not create thread \n");
            exit(-1);
        }
    }       

    for(i=0;i<numthreads;i++){
        if(pthread_join(*tid[i], NULL)){
            printf("Error Joining with thread \n");
            exit(-1);
        }
        free(tid[i]);
    }

    free(tid);
    for(i=0;i<ceiling;i++){
        if(numbermarker[i] == 0){
            printf("%d sdfsddd \n", numbermarker[i]);
            printf("%d \n", i+1);
        }
    }

    free(buffer);
    free(numbermarker);
    buffer=NULL;
    numbermarker=NULL;
    return(0);
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-05T17:27:05.060

我已经尝试过您的代码并在

```
void placevalue(int value)
{
buffer[placeposition] = value;
placeposition++;
} 
```

`placeposition`超过`buffer`. 这会导致未定义的行为，一个非常合理的结果是互斥体的垃圾（在`malloc()`之后立即编辑`buffer`）。

最重要的是，还有一个竞争条件是`placevalue()`. 但是，如果您使用的是单个工作线程，那么您（还）还没有遇到它。

# javascript - 有没有办法动态改变图标的 颜色？

> ID：15839517
> 
> 赞同：0
> 
> 时间：2013-04-05T17:03:53.770
> 
> 标签：javascript, jquery, html, css

我有一个星形图标。我想以未知数量的颜色使用此图标。

有时我需要一颗红星，有时我需要一颗紫星。

我可以使用 Web 服务在服务器上动态创建图像。

我很好奇，有没有什么方法可以控制这个图标的颜色，而无需为我可能需要的每种颜色显式创建图像？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-05T17:04:55.587

您应该使用 glyphicons 或其他类型的基于图标的字体：http: [//twitter.github.com/bootstrap/base-css.html#icons](http://twitter.github.com/bootstrap/base-css.html#icons)

这是一个基于图标的字体的示例：http: [//css-tricks.com/examples/IconFont/](http://css-tricks.com/examples/IconFont/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-05T17:06:43.263

我可以想到三种方法来做到这一点。

1.  使用您需要的所有不同颜色创建一个精灵表，并移动偏移以更改颜色。这有点作弊。
2.  使用 Canvas 动态生成图像（啊！）
3.  使用 SVG，它将响应 CSS 的更改，类似于通过更改 DIV/SPAN 上的类来更改文本显示

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-05T17:09:58.083

您可以只生成 4 个星形图像：1 个黑色、1 个红色、1 个蓝色和 1 个绿色（如果您有非白色背景，也可以生成 1 个白色）。然后将它们全部堆叠并使用它们的不透明度来获得您想要的颜色。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-04-05T17:06:06.823

使用 SVG 图标，您可以做任何您想做的事情 :)

这是 Raphael JS 库的示例： [http ://raphaeljs.com/icons/](http://raphaeljs.com/icons/)

# scala - Scala 中的 ArrayBuffer 与 ArrayBuilder

> ID：15839519
> 
> 赞同：32
> 
> 时间：2013-04-05T17:04:15.410
> 
> 标签：scala

scala.collections.mutable.ArrayBuilder 和 scala.collections.mutable.ArrayBuffer 有什么区别？例如，如果我需要构建一个 Array[Int]，最好使用哪个？是否有任何性能差异，例如 java.lang.StringBuffer 和 java.lang.StringBuilder？

* * *

## 回答 #1

> 赞同：44
> 
> 时间：2013-04-05T17:20:58.860

`ArrayBuilder`是 a `Builder`，并且构建器旨在通过向它们添加元素来构建其他集合。构建器通常不打算直接在客户端代码中使用。

`ArrayBuffer`is a `Buffer`and `Seq`-- 缓冲区是您可以有效地附加元素的序列。序列带有很多辅助操作。

你可能需要一个`ArrayBuffer`. 它旨在用作`ArrayList`Java中的替代品。该类`ArrayBuffer`是一个功能齐全的序列集合，包含所有批量数据操作，如`foreach`、`map`、`filter`、`zip`和朋友，不像`ArrayBuilder`它只配备`+=`了添加元素并`result`在最后获取数组。

您可能更喜欢 an 的一个地方`ArrayBuilder`是当您为原始类型实例化它`Int`并且您关心性能时。在这种情况下，`ArrayBuilder`变体专门用于不同的原始类型并保存适当原始类型的底层数组，而 an`ArrayBuffer`始终在下面保存一个对象数组——您添加到其中的每个原始类型都会进行装箱。

实例化数组缓冲区：

```
new ArrayBuffer[Int] // gives you an array buffer that will hold boxed integers 
```

要实例化数组构建器：

```
new ArrayBuilder.ofInt // gives you a manually specialized array builder that will hold real primitives 
```

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2016-12-26T15:05:29.637

我对它进行了计时，并且构建一个数组`ArrayBuilder`明显更快：

与`ArrayBuffer`：

```
real    0m40.348s
user    0m29.544s
sys 0m1.017s 
```

与`Array Builder`：

```
real    0m8.392s
user    0m4.769s
sys 0m0.330s 
```

我的代码：

```
import scala.collection.mutable.{ArrayBuffer, ArrayBuilder}

object MyObject {
    def main(args: Array[String]) {

        for (i <- 0 until 100) {
            arrayBuilderMade
            // or arrayBufferMade

        }
    }

    def arrayBufferMade {

        var aBuffer = new ArrayBuffer[Int]()

        for (i <- 0 until 1000000) {
            aBuffer += i
        }

        println(aBuffer.toArray.length)
    }

    def arrayBuilderMade {

        var aBuilder = new ArrayBuilder.ofInt

        for (i <- 0 until 1000000) {
            aBuilder += i
        }

        println(aBuilder.result.length)
    }
} 
```

和

```
time scala my_code.scala 
```

# python - 我在 setup.py 中需要什么选项才能在正确的目录中创建包？

> ID：15839520
> 
> 赞同：17
> 
> 时间：2013-04-05T17:04:24.790
> 
> 标签：python, python-2.7, package, pip, setup.py

我正在使用`setup.py`创建一个 python 包，我想通过`pip`. 正确安装下的文件

```
lib/python2.7/site-packages/<package-name> 
```

我在中使用了以下选项`setup.py`：

```
'package_dir': {'':'lib'} 
```

如此[处所述，](http://docs.python.org/2/distutils/setupscript.html)但出现错误

```
error: package directory 'lib' does not exist 
```

好吧，没有这样的目录，因为我希望将*当前*目录安装为包`lib`或其他任何东西。我也尝试使用

```
'package_dir': {'mycode':''} 
```

它将代码直接安装在

```
lib/python2.7/site-packages/ 
```

并且不低于

```
lib/python2.7/site-packages/<package-name> 
```

我做错了什么，这在哪里记录？我可能会忽略此基本功能的文档，因为文档`setup.py`“次优”。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2013-04-06T06:04:44.243

如何做到这一点的描述可以在[分发文档](https://the-hitchhikers-guide-to-packaging.readthedocs.io/en/latest/quickstart.html)中找到......在包含所有项目的目录中（`TowelStuff/`在给定的示例中），您可以指定实际模块的名称（`towelstuff/`）。要将其包含为*您的*模块，您需要在以下行中添加以下行`setup.py`：

```
'packages': ['towelstuff'] 
```

在创建了 sdist（从内部`TowelStuff/`）之后，这个包的安装将把它安装在下面`site-packages/towelstuff`，可以像往常一样导入（`from towelstuff import ...`）。

# javascript - 获取数字并四舍五入为整数

> ID：15839522
> 
> 赞同：0
> 
> 时间：2013-04-05T17:04:28.977
> 
> 标签：javascript, jquery

我从 Google Map API V3 获取里程，并根据 from 和 to 地址在文本框中显示它。我想解析出数字并将其四舍五入到最接近的整数。

Miles = "29.9 mi" // 我希望结果为 30 Miles = "9.3 mi" // 10

我试过 Math.round 但它返回 NAN。

```
if (status == google.maps.DirectionsStatus.OK) {
        directionsDisplay.setDirections(response);
        var miles = response.routes[0].legs[0].distance.text;
        miles = Math.round(miles);
        $('#TotalMiles').val(miles);
    } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-05T17:06:19.753

你看过用于[round](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Math/round)的 JavaScript API吗？

> **句法**
> 
> `Math.round(x)`
> 
> **参数**
> 
> *   `x`一个号码。
> 
> **描述**
> 
> 如果 number 的小数部分是 0.5 或更大，则将参数四舍五入到下一个更高的整数。如果 number 的小数部分小于 0.5，则将参数四舍五入到下一个较小的整数。
> 
> 因为 round 是 Math 的静态方法，所以您始终将其用作 Math.round()，而不是作为您创建的 Math 对象的方法。

* * *

编辑：

您需要将字符串转换为其部分以获取数字

```
Miles = "29.9 mi"
var num = parseFloat(Miles);
Math.round(num); 
```

以及使用正则表达式的方法

```
Miles = "29 mi"
var rounded = Miles.replace(/(\d+(\.\d+)?)(\s?mi)/, function(match, number, x, units){   return Math.round(parseFloat(number)) + units });
console.log(rounded); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-05T17:09:14.423

尝试`parseFloat`+ `Math.ceil`：

```
var number = "9.3 mi";
console.log(Math.ceil(parseFloat(number))); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-04-05T17:10:15.223

您可能需要拆分多余的字符。

```
var str = "29.9 mi";
var number = str.split(" ");
var new_number = Math.round(parseFloat(number[0])); 
```

这是一个冗长的答案。最后，根据您的确切需要对其进行定制会更有意义，但在这里我只是展示如何在“”（空格）上拆分并在将结果字符串解析为浮点数后对其进行舍入。

不过，我会尝试 KaeruCT 的答案。我认为 parseInt 或 parseFloat 实际上不需要删除非数字字符。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-04-05T17:06:54.660

尝试`Math.round()`：

```
var number =29.9;
console.log(Math.round(number)); 
```

# crystal-reports - Crystal Reports 记录部分不返回与 sql 相同的数据

> ID：15839526
> 
> 赞同：0
> 
> 时间：2013-04-05T17:04:35.263
> 
> 标签：crystal-reports, selection, record

我找到了另一个 Tech 发布的解决方案：

新配方：

```
{Product.Size} <> “xsm” or IsNull({Product.Size}) 
```

不幸的是，在预览您的报告时，您会发现这不起作用。这不是因为我们的逻辑错误，而是我认为是 Crystal Reports 中的错误。如果我采用这个完全相同的条件并使用查询分析器或查询工具将其应用于数据库记录，我会看到空白记录。不幸的是，Crystal 不允许空值通过，即使我们的公式表明它们应该如此。

规避此错误的技巧是将 IsNull() 检查 FIRST 放在公式中。

因此，如果我们将条件重新排列为：

```
IsNull({Product.Size}) or {Product.Size} <> "xsm" 
```

像魅力一样工作

* * *

问题是，如果我为第二个 OR 语句选择标准，`({HiredRate.UTRANSDOC}startswith{?TransYN})`而为第一个选择 NO，`({HiredRate.UTRANSWEB}startswith{?WebYN})`我只会得到一条满足 TransYN 标准的记录。如果我将公式中的位置放在第一位，`({HiredRate.UTRANSDOC}startswith{?TransYN})`我会得到所有数据。

当我运行 SQL 查询时，无论它们的顺序如何，我都会得到所有数据。Crystal Preview 只为我提供 OR 部分的第一个数据。

从 SQL 中查看数据的唯一突出之处是 Crystal 返回的一条记录在 Transdoc 字段中为 YES，而 Transweb 字段为空白。对于 Transdoc，所有其他记录显示 YES，Transweb 字段显示 NULL。

这是水晶唱片选择公式

```
{HiredRate.CONTSUPREF} startswith {?LanguageCombo}
and    {HiredRate.ONDATE} = {?ProjectDate}
and    {HiredRate.ACTVCODE}= "SIG"
and    {HiredRate.RESULTCODE} = "CLM"
and    (
      {HiredRate.UTRANSWEB}startswith{?WebYN} 
or    {HiredRate.UTRANSDOC}startswith{?TransYN}
or    {HiredRate.UTRANLANL0}startswith{?LanloYN}
or    {HiredRate.UINTCONSEC}startswith{?InterpYN}
or    {HiredRate.UINTCONF}startswith{?IntConfYN}
or    {HiredRate.UINTOPI}startswith{?OPIYN}
      ) 
```

这是 Crystal 使用的 SQL 查询：

```
SELECT HiredRate.DEAR, HiredRate.CONTSUPREF, HiredRate.LASTDATE, HiredRate.CONTACT, HiredRate.USOURCLANG, HiredRate.UTARGLANG, HiredRate.UTRANSDOC, HiredRate.UTRANSWEB, HiredRate.UTRANLANL0, HiredRate.UINTCONSEC, HiredRate.UINTCONF, HiredRate.UINTOPI, HiredRate.ONDATE, HiredRate.ACTVCODE, HiredRate.RESULTCODE
FROM GoldMine_Main.dbo.HiredRate HiredRate
WHERE HiredRate.CONTSUPREF LIKE 'ENG>SPA%' AND (HiredRate.ONDATE>={ts '2012-04-01 00:00:00'} AND HiredRate.ONDATE<{ts '2013-04-06 00:00:00'}) AND HiredRate.ACTVCODE='SIG' AND HiredRate.RESULTCODE='CLM' AND (HiredRate.UTRANSWEB LIKE 'NO%' OR HiredRate.UTRANSDOC LIKE 'YES%' OR HiredRate.UTRANLANL0 LIKE 'NO%' OR HiredRate.UINTCONSEC LIKE 'NO%' OR HiredRate.UINTCONF LIKE 'NO%' OR HiredRate.UINTOPI LIKE 'NO%')
ORDER BY HiredRate.DEAR, HiredRate.CONTACT 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-05T17:34:55.913

发生这种情况是因为`{HiredRate.UTRANSWEB}`is null - 因此表达式的其余部分在 Crystal 中评估为 null，即使（逻辑上）它不应该。

当`or`交换前两个条件时，`{HiredRate.UTRANSDOC}`条件的计算结果为真，表达式的其余部分被短路——这就是选择记录*的*原因。

# ruby-on-rails - RoR - Karlsgem::KarlsGeming:Class 的未定义方法“你好”

> ID：15839527
> 
> 赞同：0
> 
> 时间：2013-04-05T17:04:35.497
> 
> 标签：ruby-on-rails, ruby, rubygems

Karlsgem::KarlsGeming:Class 的未定义方法“你好”

请帮忙，我只是希望它在视图中显示字符串，似乎无法解决这个问题？我在错误的文件中吗？

karlsgem.rb

```
require "karlsgem/version"

module Karlsgem
    class KarlsGeming
        def hello
            puts "Hello World"
        end

    end
end 
```

index.html.erb

```
<% if notice %>
<p id="notice" ><%= notice %></p>
<% end %>

<%= @kgem %>

<h1>Your Drinks Catalog</h1>
<% @products.each do |product| %>
<div class="entry" >
<%= image_tag(product.image_url) %>
<h3><%= product.title %></h3>
<%=sanitize product.description %>
<div class="price_line" >
<span class="price" >€&lt;%= product.price %></span>
<%= button_to 'Add to Cart' , line_items_path(:product_id => product) %>
</div>
</div>
<% end %> 
```

store_controller.rb

```
require 'karlsgem'

class StoreController < ApplicationController
  def index
@products = Product.all
@cart = current_cart

@kgem = Karlsgem::KarlsGeming.hello

  end
end 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-05T17:20:04.787

您将 hello 定义为实例方法。为此，`Karlsgem::KarlsGeming.hello`您必须将其定义为类方法：

```
require "karlsgem/version"
module Karlsgem
  class KarlsGeming
    def self.hello
        puts "Hello World"
    end
  end
end 
```

# mysql - mysql根据列结果返回结果

> ID：15839529
> 
> 赞同：-2
> 
> 时间：2013-04-05T17:04:41.963
> 
> 标签：mysql

我正在尝试解析结果

表结构

```
第 1 栏 | 第 2 栏
一个 | if_AT_N
乙| if_ET_n       
C | if_AT_n
```

我想要做的是如果存在“_AT”，则用“是”替换第 2 列结果，如果存在 _ET，则用“否”替换

结果集的目标看起来像

```
一个 | 不
乙| 是的
c | 不
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-05T17:07:13.023

您的陈述与您想要的输出不匹配。您可以交换符合您需要的`YES`和的值。`NO`

```
SELECT  Column1,
        IF(Column2 LIKE '%\_AT\_%', 'NO', 'YES') Result
FROM    TableName 
```

*   [SQLFiddle 演示](http://www.sqlfiddle.com/#!2/1f389/3)

输出

```
╔═════════╦════════╗
║ COLUMN1 ║ RESULT ║
╠═════════╬════════╣
║ A       ║ NO     ║
║ B       ║ YES    ║
║ C       ║ NO     ║
╚═════════╩════════╝ 
```

上面的查询只做投影。这意味着表中没有修改。如果要修改表的值，需要使用`UPDATE`语句。

```
UPDATE TableName
SET   Column2 = IF(Column2 LIKE '%\_AT\_%', 'NO', 'YES') 
```

*   [SQLFiddle 演示](http://www.sqlfiddle.com/#!2/fac9d/1)

# html - 重定向中有明显的安全漏洞？

> ID：15839531
> 
> 赞同：0
> 
> 时间：2013-04-05T17:04:47.857
> 
> 标签：html, servlets, video, https, security

我有一个存储视频的网络应用程序。我正在使用验证用户名和密码的 java servlet（通过 https）。验证详细信息后，我将用户重定向到存储在 AWS S3 中的视频。对于那些不知道 S3 是如何工作的人来说，它只是一个存储对象的 Web 服务（基本上可以将其视为存储文件）。它还使用 https。现在显然为了使这项工作，s3 对象（文件）是公开的。我给了它一个充满数字和字母的随机名称。

所以servlet基本上是这样的：

```
void doGet(request, response){
   if (authenticateUser(request.getParameter("Username"), request.getParameter("Password")){
      response.sendRedirect("https://s3.amazonaws.com/myBucket/xyz1234567.mp4");
   }
} 
```

这显然是简化的，但它得到了重点。这里有什么非常明显的安全漏洞吗？视频标签显然会有类似[https://www.mysite.com/getVideo?Username=](https://www.mysite.com/getVideo?Username=) "Me"&Password="randomletters" 的来源。乍一看，假设我给位于 AWS s3 的文件名提供足够随机的名称，它似乎应该和其他任何东西一样安全？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-05T17:34:50.710

明显的安全漏洞是任何人都可以检测到身份验证 servlet 重定向到哪个 URL，并与他的所有朋友共享这个 URL，从而允许任何人直接访问资源，而无需通过身份验证 servlet。

不幸的是，我根本不了解 S3，所以我不能推荐任何解决安全问题的方法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-07T15:08:07.370

所有这些机制所做的只是提供非常有限的混淆 - 在大多数现代浏览器（或诸如 Fiddler 之类的代理）中使用开发人员工具，用户将能够观看正在加载的视频的 URL，如果它位于公共 S3 存储桶中，然后简单地分享链接。

使用 S3，您唯一真正的解决方案是保护存储桶，然后要求用户登录或使用临时令牌进行访问 [http://docs.aws.amazon.com/AmazonS3/latest/dev/RESTAuthentication。 html] ...虽然这确实使您的解决方案复杂化

我还要提到，在指向视频资产的链接（来自上面的问题）中以明文形式包含密码和用户名是非常不安全的

# visual-studio-2012 - 如何检测 IIS Express 版本？

> ID：15839532
> 
> 赞同：35
> 
> 时间：2013-04-05T17:04:50.747
> 
> 标签：visual-studio-2012, version, updates, iis-express, asp.net-4.5

我发现我们的 ASP.NET 应用程序在 IIS Express 中的不同机器上运行不同。都有 VS 2012、.Net 4.5 和集成模式。但有些有 VS 2012 Update 1，有些没有。

如何找到 IIS Express 版本？

* * *

## 回答 #1

> 赞同：49
> 
> 时间：2013-05-29T11:31:07.563

浏览到`"C:\Program Files\IIS Express"`，选择文件`iisexpress.exe`，按 Alt+Enter 打开属性对话框，单击详细信息选项卡并阅读产品版本。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2013-04-05T18:19:04.090

`HttpRuntime.IISVersion`将为您提供 IIS 的主要和次要版本（例如*8.0*）。

`System.Diagnostics.Process.GetCurrentProcess().MainModule.FileVersionInfo`将为您提供更多信息，包括文件版本和构建风格（例如*8.0.8418.0 (winmain(eokim).120521-1311)*）。

# message-queue - System V MQ 文本长度问题

> ID：15839534
> 
> 赞同：0
> 
> 时间：2013-04-05T17:04:59.443
> 
> 标签：message-queue, arrays

我正在尝试使用 system v mqs 编写简单的聊天应用程序，但我在结构中的 mtext 值存在问题。

```
struct join_buf {
  long mtype;
  char mtext[8];
}; 
```

当我发送插入此结构的消息时。我是在服务器上写的，有时正确，有时错误。我看到的是；字符数填充为 8。

你能推荐我正确阅读多行文本吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-05T17:13:56.690

我想我发现了我正在做的错误。

```
for (i = 0; i < nameLength; i++) {
         joinbuf.mtext[i]=argv[1][i];
    }
    joinbuf.mtext[i]='\0'; 
```

没有最后一行，字符串的结尾是 char 数组的长度。补充说我告诉运行时就是这样！一点也不多！

# javascript - Javascript传递函数不同的参数集

> ID：15839536
> 
> 赞同：2
> 
> 时间：2013-04-05T17:05:08.497
> 
> 标签：javascript

所以我有一个带有很多参数的函数，例如

```
function myFunction(height, width, name, surname, time){
...
} 
```

麻烦的是我想用这个函数来发送不同的参数集。

所以有时候会...

```
 function myFunction(height, width, depth, name, surname, time){
    ...
    } 
```

该函数用于许多任务，我不希望函数中的参数列表很长，并且在调用函数时值列表中存在大量空格。

我需要一些更动态的东西，理想情况下，一个关联数组将被传递给从它创建的函数和变量。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-05T17:09:32.457

因为 JavaScript 没有命名参数，人们通常使用对象作为“接口”

您可以接受作为对象的单个参数并将所有这些参数作为键。

```
function myFunction(options){
   //access to options.height and more...

} 
```

将包装在对象中的参数传递给函数

```
myFunction({
  height: 100,
  widht: 300,
  ...
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-05T17:20:06.733

我的最后一个帖子是错误的。我有不同的想法。对此感到抱歉。

您可以使用长 lsit 参数编写函数，但在执行函数时不必使用所有参数。

功能

```
function foo(a, b, c) {
    //body;
}; 
```

可以这样执行：

```
foo(a);
foo(a,b);
foo(a,b,c); 
```

在函数内部检查参数是否不为空以及是否设置了默认值

```
function foo(a, b, c) {
    a = a !== 'null' ? a : defaultValue;
    b = b !== 'null' ? b : defaultValue;
    c = c !== 'null' ? c : defaultValue;
}; 
```

# core-data - 为什么未保存的 managedObject 会丢失它的 managedObjectContext

> ID：15839539
> 
> 赞同：1
> 
> 时间：2013-04-05T17:05:13.493
> 
> 标签：core-data, nsmanagedobject, nsmanagedobjectcontext

目前，我正在开发一个预订汽车的应用程序。所有预订相关数据都存储在实体“预订”中。由于“Bookings”的某些属性或“Bookings”与其他实体之间的关系是强制性的，我决定将实体“Bookings”的所有 managedObjects 添加到它们自己的 managedObjectContext 中。此上下文也将存储在单独的变量中以避免丢失。除非我签署（企业商店或临时）我的应用程序并部署它，否则这工作正常。ARC 已启用。

**课程预约界面**

```
@interface Bookings : NSManagedObject {
@private
     NSManagedObjectContext *mContext;
}

@end 
```

**课程预订实施**

```
@implementation Bookings {

    + (Bookings *)booking {
         NSManagedObjectContext *context = [[NSManagedObjectContext alloc] initWithConcurrencyType:concurrencyType];
         [context setPersistentStoreCoordinator:[self persistentStoreCoordinator]];

         Bookings *object = (Bookings*)[[NSManagedObject alloc] initWithEntity:[self entityForName:pName] insertIntoMarenagedObjectContext:context];
         [object setSomeReservationData:...];
         ...

         // here I store the context in an ivar of my booking object
         [object->mContext = context];

         return object;
    }
} 
```

在这种状态下，Booking 对象将不会被保存！

**课程预订VC**

```
Bookings *booking = [Bookings booking];
NSLog(@"Context: %@", [booking managedObjectContext]); 
```

没有保存或更改，但上下文为空。

**设备上的控制台输出（通过 iPhone-Configurator 或 Testflight 临时签名和部署）**

```
... Context: (null) 
```

**模拟器或设备上的控制台输出（即席签名但通过 Xcode 安装）**

```
... Context: <NSManagedObjectContext: 0x893c520> 
```

那么为什么一个未保存的 managedObject 会丢失它的 managedObjectContext 以及如何避免呢？它是错误还是预期的行为？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-06T05:16:14.720

您的上下文在函数结束时无效。[看到这里](https://stackoverflow.com/questions/15837104/core-data-entity-lacks-its-attributes-after-being-returned-in-a-method/15837196?noredirect=1#comment22533394_15837196)
你的对象被上下文否定，使其所有属性都为空，在调试模式下，存在一个自动释放池，防止上下文被释放。

# c++ - Linux API 获取 Hugepagesize

> ID：15839543
> 
> 赞同：1
> 
> 时间：2013-04-05T17:05:23.990
> 
> 标签：c++, c, linux

如何获取 /proc/meminfo 中的 Hugepagesize 值

巨页大小：2048 kB

不解析/proc/meminfo？

我可以通过使用获得常规页面大小

```
#include <unistd.h>
long sz = sysconf(_SC_PAGESIZE); 
```

是否有提供 Hugepagesize 的 sysconf 参数？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-05T18:55:54.413

我不认为 Linux 公开了用于从用户空间获取该值的编程 API。但我同意这里的评论...... /proc/meminfo 是一个可靠的选择。

您可以查看 $KERNEL/fs/proc/meminfo.c 中的内核代码以了解它是如何派生的：

```
> meminfo_proc_show()
  > hugetlb_report_meminfo()
    > 1UL << (huge_page_order(h) + PAGE_SHIFT - 10) // actual value 
```

# c# - VS2010 资源图像未从项目中清除

> ID：15839545
> 
> 赞同：0
> 
> 时间：2013-04-05T17:05:30.467
> 
> 标签：c#, winforms, visual-studio-2010, image, resources

使用资源窗口的“删除资源”从项目中删除图像后，我的图像仍保留在解决方案资源管理器中。

这是为什么？我怎样才能“安全地”删除它们？我曾尝试一次手动执行此操作，但它需要我在设计模式下显示我的主窗体以查看 VS2010 是否在我身上崩溃，然后“撤消”我所做的。

必须有一个更简单的方法。有什么想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-09T17:17:32.413

尝试完全手动删除：

*   从 .Resources.Designer.cs 中删除访问资源的属性。它应该看起来像这样（如果调用了资源`btnAdd`）：

    ```
    internal static System.Drawing.Bitmap btnAdd {
        get {
            object obj = ResourceManager.GetObject("btnAdd", resourceCulture);
            return ((System.Drawing.Bitmap)(obj));
        }
    } 
    ```

*   从 .resx 文件中删除对资源的引用。应该是这样的：

    ```
    <data name="btnAdd" type="System.Resources.ResXFileRef, System.Windows.Forms">
      <value>..\..\..\..\..\Icons\CurrentIcons\btnAdd.png;System.Drawing.Bitmap, System.Drawing, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a</value>
    </data> 
    ```

*   右键单击解决方案资源管理器中的项目，卸载它，编辑它并查找类似的内容（并删除它）。

    ```
    <ItemGroup>
      <None Include="btnAdd.png" />
    </ItemGroup> 
    ```

# linux - 基于两列合并两个文件

> ID：15839546
> 
> 赞同：2
> 
> 时间：2013-04-05T17:05:35.943
> 
> 标签：linux, unix, join, merge

我有一个与上一篇文章非常相似的问题： [在 unix 中通过单列合并两个文件，](https://stackoverflow.com/questions/9575972/merging-two-files-by-a-single-column-in-unix) 但我想基于两列合并我的数据（顺序相同，因此无需排序）。例子，

subjectid subID2 姓名 年龄
12 121 Jane 16
24 241 Kristen 90
15 151 Clarke 78
23 231 Joann 31

subjectid subID2 prob_disease
12 121 0.009
24 241 0.738
15 151 0.392
23 231 1.2E-5

输出看起来像

subjectid SubID2 prob_disease name 年龄
12 121 0.009 Jane 16
24 241 0.738 Kristen 90
15 151 0.392 Clarke 78
23 231 1.2E-5 Joanna 31

当我使用 join 时，它只考虑第一列（subjectid）并重复 SubID2 列。请问有没有办法通过join或其他方式做到这一点？谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-05T18:23:38.757

如果订单相同，您仍然可以按单列合并并指定要输出的列的格式，例如：

```
join -o '1.1 1.2 2.3 1.3 1.4' file_a file_b 
```

如[join(1)](http://linux.die.net/man/1/join)中所述。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-05T18:10:38.817

join command doesn't have an option to scan more than one field as a joining criteria. Hence, you will have to add some intelligence into the mix. Assuming your files has a FIXED number of fields on each line, you can use something like this:

```
join f1 f2 | awk '{print $1" "$2" "$3" "$4" "$6}' 
```

provided the the field counts are as given in your examples. Otherwise, you need to adjust the scope of print in the awk command, by adding or taking away some fields.

# php - 通过请求安全令牌自动登录

> ID：15839548
> 
> 赞同：0
> 
> 时间：2013-04-05T17:05:39.373
> 
> 标签：php, javascript, jquery, security

**设想：**

客户端网站只有在用户将安全卡插入 PC 时才能访问。ClientWebsite 不在我的控制范围内，使用安全卡所做的一切也是如此。

我开发了一个需要用户名/密码的 js Web 应用程序。系统请求一个安全令牌，如果提供的凭据有效，则返回一个令牌并将其作为 url 参数附加到所有请求。令牌有效期为 60 分钟。

ClientWebsite 的系统管理员想要在他们的安全站点上放置一个指向我的 js 应用程序的链接。如果有人能够查看 ClientWebsite，他们就可以查看我的 js 应用程序，并且在点击链接后，应该不必再次登录。

我让系统管理员插入了一个测试链接，该链接将指向我们服务器上的一个页面并执行一些 js/jquery 来检索 http 引荐来源网址，但它始终是空白的。结论——我们客户的浏览器可能禁用了referrer，或者ClientWebsite 的配置方式禁用了发送referrer。毫不奇怪，至少可以说这是一个非常安全的网站。

在离开 ClientWebsite 之前通过 ajax/php 请求安全令牌很容易（我会向系统管理员提供代码以放入 ClientWebsite）。此方法将在 php 脚本中使用硬编码凭据，将令牌返回/附加到链接，以便在到达我的 js 应用程序时可用。然后 js 应用程序将检查令牌的有效性，如果确定，则在 js 应用程序上禁止登录。

**问题：**

有人可以 c/p 来自 ClientWebsite 的 ajax 调用，在 ClientWebsite 之外运行它，获取令牌，将令牌传递给可以使用它访问我的 js 应用程序的其他人。

**问题：**

我想在 php 脚本中检查引荐来源网址，然后在引荐来源网址与 ClientWebsite 匹配时发出令牌，但没有发送引荐来源网址，并且引荐来源网址无论如何都可能被欺骗。我可以使用什么其他方法来确定令牌请求实际上来自 ClientWebsite 页面？

谢谢！！

**编辑：**

为系统管理员提供 ajax 调用，如下所示：

```
$('#jsAppLink').click(function(e){
    e.preventDefault();
    var currentHref = $(this).attr('href');
    $.ajax({
        "type":"post",
        "dataType": "jsonp",
        "url": "https://mydomain.com/getTokenUsingCurl.php",
        "success": function (returnData){
            newHref = currentHref + "?token=" + returnData.token;
            window.location = newHref;
        }
    })
}) 
```

onClick，我服务器上的一个 php 脚本被查询。该脚本包含硬编码的凭据。脱离公众视野。将令牌返回给 ClientWebsite，将其附加到 js 应用程序 url，然后继续链接单击将用户路由到 js 应用程序。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-05T18:40:09.303

您需要两层防御来防止这种攻击方式。

首先是使用 SSL 来防止系统外的攻击者拦截传输并获取令牌。听起来您可能已经这样做了（推荐人在启用 SSL 的页面中始终为空白）。

第二个是向令牌引入一个随机化组件（以区分请求）和一个识别组件（用于识别用户）。

因此，您可以做的是让 ClientWebsite 向您的服务器发出反向通道请求以获取令牌。在这个请求中，它应该包含用户的远程 IP，并且您应该验证这个请求是否仅来自 ClientWebsite 的服务器。

然后，不要直接返回令牌，而是使用随机随机数对其进行加密。然后将数据库中的 nonce 与提供的用户远程 IP 相关联。

现在，当浏览器向您的站点发出请求时，它会传递加密的令牌。然后，您从用户的远程 IP (REMOTE_ADDR) 中查找密钥并对其进行解密。

它可以防止重放攻击，因为它需要 IP 欺骗才能做到这一点。但请注意，如果涉及代理，这会使事情变得非常复杂（并且代理将被信任而不是用户）。

这很容易让人联想到 oauth1 的工作方式，除了信任的方向相反（客户端服务器是记录的身份验证源，而在 oauth 中身份验证服务器是身份验证源）......

```
/---------\            /---------------\           /-------------\
| Browser | ---------> | ClientWebsite |    IP     | Your Server |
|         |            |    Server     | --------> |             |
|         |            |               | Encrypted |             |
|         |            |               |   Token   |             |
|         |            |               | <-------- |             |
|         |  Encrypted |               |           |             |
|         |    Token   |               |           |             |
|         | <--------- |               |           |             |
|         |            \---------------/           |             |
|         |                                        |             |
|         |             Encrypted Token            |             |
|         | -------------------------------------> |             |
|         |                                        |             |
|         |             Session Start              |             |
|         | <------------------------------------- |             |
\---------/                                        \-------------/ 
```

它是安全的，因为生成加密令牌（使用强随机密钥加密，永远不会离开服务器）的唯一方法是从 ClientWebsite 的服务器发出请求（因为您正在验证请求直接来自服务器，通过反向通道）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-05T17:17:05.003

让 ClientWebsite 向您传递安全令牌可能是正确的想法（绝对避免引用者）。我认为您缺少的关键部分是确保令牌*始终在变化*。令牌不仅应由预设凭据组成，还应具有可变元素（如果没有别的，则为时间戳），并且是短暂的。

当 ClientWebsite 第一次将用户发送到您的应用程序时，您验证令牌并确保它是最新的（最好在几秒钟内）。如果有人从 ajax 调用复制令牌并将其传递给其他人，您需要确保它不再被视为有效令牌。

# java - NullPointerException 尝试在 Java 应用程序中自动装配服务（Spring）

> ID：15839552
> 
> 赞同：0
> 
> 时间：2013-04-05T17:05:48.230
> 
> 标签：java, spring, autowired

我正在编写一个将使用 Spring、Hibernate 等的 Java 应用程序，它将被打包在一个 Jar 中并从类似的命令运行。

我的主要课程现在如下所示：

```
public class App
{

    private static final Logger logger = LoggerFactory.getLogger(App.class);

    @Autowired
    private static MemberInquiryService memberInquiryService;

    public static void main(String[] args )
    {
        logger.info("Starting Inquiry Batch Process");

        int pendingRecords = memberInquiryService.getPendingRecordCount();

        logger.info("Current Number Of Pendinig Records (" + pendingRecords + ")");

        logger.info("Ending Inquiry Batch Process");
    }
} 
```

在 getPendingRecordCount 我只是返回“10”进行测试：

```
public int getPendingRecordCount()
    {

        return 10;
    }; 
```

为什么我会收到以下错误：

```
Exception in thread "main" java.lang.NullPointerException
    at org.XXXX.inquirybatch.app.App.main(App.java:33)
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
    at java.lang.reflect.Method.invoke(Method.java:601)
    at com.intellij.rt.execution.application.AppMain.main(AppMain.java:120) 
```

这也是我的 DatabaseConfig.class

```
@Configuration
@EnableTransactionManagement
@ComponentScan(basePackages= { "org.xxxx.inquirybatch", "org.xxxx.core" })
@PropertySource("classpath:application.properties")
public class DatabaseConfig  {

    private static final Logger logger = LoggerFactory.getLogger(DatabaseConfig.class);

    @Autowired
    Environment env;

    @Bean
     public DataSource dataSource()  {

        String serverType = env.getProperty("server.type");

        try {

            if(serverType.equalsIgnoreCase("tomcat"))
            {
                com.mchange.v2.c3p0.ComboPooledDataSource ds = new com.mchange.v2.c3p0.ComboPooledDataSource();

                ds.setDriverClass(env.getProperty("database.driver"));
                ds.setUser(env.getProperty("database.user"));
                ds.setPassword(env.getProperty("database.password"));
                ds.setJdbcUrl(env.getProperty("database.url"));

                return ds;
            }
            else
            {
                Context ctx = new InitialContext();
                return (DataSource) ctx.lookup("java:jboss/datasources/mySQLDB");
            }
        }
        catch (Exception e)
        {
                  logger.error(e.getMessage());
        }

        return null;
     }

    @Bean
    public SessionFactory sessionFactory()
    {

        LocalSessionFactoryBean factoryBean = new LocalSessionFactoryBean();
        factoryBean.setDataSource(dataSource());
        factoryBean.setHibernateProperties(getHibernateProperties());
        factoryBean.setPackagesToScan(new String[] { "org.xxxx.inquirybatch.model", "org.xxxx.core.model" } );

        try {
            factoryBean.afterPropertiesSet();
        } catch (IOException e) {
            logger.error(e.getMessage());
            e.printStackTrace();  //To change body of catch statement use File | Settings | File Templates.
        }

        return factoryBean.getObject();
    }

    @Bean
    public Properties getHibernateProperties()
    {
        Properties hibernateProperties = new Properties();

        hibernateProperties.setProperty("hibernate.dialect", env.getProperty("hibernate.dialect"));
        hibernateProperties.setProperty("hibernate.show_sql", env.getProperty("hibernate.show_sql"));
        hibernateProperties.setProperty("hibernate.use_sql_comments", env.getProperty("hibernate.use_sql_comments"));
        hibernateProperties.setProperty("hibernate.format_sql", env.getProperty("hibernate.format_sql"));
        hibernateProperties.setProperty("hibernate.hbm2ddl.auto", env.getProperty("hibernate.hbm2ddl.auto"));

        hibernateProperties.setProperty("hibernate.generate_statistics", env.getProperty("hibernate.generate_statistics"));

        hibernateProperties.setProperty("javax.persistence.validation.mode", env.getProperty("javax.persistence.validation.mode"));

        //Audit History flags
        hibernateProperties.setProperty("org.hibernate.envers.store_data_at_delete", env.getProperty("org.hibernate.envers.store_data_at_delete"));
        hibernateProperties.setProperty("org.hibernate.envers.global_with_modified_flag", env.getProperty("org.hibernate.envers.global_with_modified_flag"));

        return hibernateProperties;
    }

    @Bean
    public HibernateTransactionManager hibernateTransactionManager()
    {
        HibernateTransactionManager htm = new HibernateTransactionManager();
        htm.setSessionFactory(sessionFactory());
        htm.afterPropertiesSet();
        return htm;
    }

} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-05T17:11:09.037

Spring 从不注入静态字段。它只注入从应用程序上下文中检索到的对象，或者它们本身被注入到其他对象中。

您甚至没有在您的程序中创建应用程序上下文，因此 Spring 在该程序中不扮演任何角色。

我建议阅读[文档](http://static.springsource.org/spring/docs/3.2.x/spring-framework-reference/htmlsingle/#beans-introduction)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-05T17:13:48.623

您需要从 ClassPathXmlApplicationContext 获取 memberInquiryService

例如 ：-

```
ApplicationContext context= new ClassPathXmlApplicationContext("spring config.xml");
MmberInquiryService memberInquiryService = context.getBean("memberInquiryService "); 
```

基本上在您的代码片段中 MemberInquiryService 不是弹簧管理的，因为您不是从弹簧容器中获取的。您还需要在 spring config.xml 中声明 MmberInquiryService 条目

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-05T17:34:46.303

我不得不将主要课程更改为..

```
public static void main(String[] args )
    {
        logger.info("Starting Inquiry Batch Process");

        ApplicationContext context = new AnnotationConfigApplicationContext(AppConfig.class);

        MemberInquiryService memberInquiryService = (MemberInquiryService) context.getBean("memberInquiryService");

        int pendingRecords = memberInquiryService.getPendingRecordCount();

        logger.info("Current Number Of Pendinig Records (" + pendingRecords + ")");

        logger.info("Ending Inquiry Batch Process");
    } 
```

# python - .pyc 文件何时刷新？

> ID：15839555
> 
> 赞同：97
> 
> 时间：2013-04-05T17:05:59.277
> 
> 标签：python, python-internals, pyc

我知道“.pyc”文件是纯文本“.py”文件的编译版本，在运行时创建以使程序运行得更快。但是我观察到一些事情：

1.  修改“py”文件后，程序行为会发生变化。这表明“py”文件已编译或至少经过某种散列过程或比较时间戳以判断是否应重新编译它们。
2.  删除所有“.pyc”文件 ( `rm *.pyc`) 后，有时程序行为会发生变化。这表明它们没有在更新“.py”时被编译。

问题：

*   他们如何决定何时编译？
*   有没有办法确保他们在开发过程中进行更严格的检查？

* * *

## 回答 #1

> 赞同：86
> 
> 时间：2013-04-05T17:11:18.690

仅当该`.pyc`python 文件由其他脚本导入时，才会创建（并可能覆盖）文件。如果调用了导入，Python 会检查`.pyc`文件的内部时间戳是否不早于相应的`.py`文件。如果是，则加载`.pyc`; 如果不存在或者`.pyc`不存在，Python会将`.py`文件编译为 a`.pyc`并加载它。

“更严格的检查”是什么意思？

* * *

## 回答 #2

> 赞同：33
> 
> 时间：2013-10-14T04:41:22.080

每当导入相应的代码元素时生成 .pyc 文件，并在相应的代码文件已更新时更新。如果 .pyc 文件被删除，它们将自动重新生成。但是，当相应的代码文件被删除时，它们**不会**被自动删除。

这可能会在文件级重构期间导致一些非常有趣的错误。

首先，您最终可能会推送只能在您的机器上运行而不能在其他人的机器上运行的代码。如果您对已删除的文件有悬空引用，如果您不手动删除相关的 .pyc 文件，这些仍然可以在本地工作，因为 .pyc 文件可以在导入中使用。再加上正确配置的版本控制系统只会将 .py 文件推送到中央存储库，而不是 .pyc 文件，这意味着您的代码可以通过“导入测试”（是否一切都可以导入）就好了，而不是在别人的电脑上工作。

其次，如果你把包变成模块，你可能会遇到一些非常可怕的错误。当您将包（包含文件的`__init__.py`文件夹）转换为模块（.py 文件）时，曾经代表该包的 .pyc 文件仍然存在。尤其是`__init__.pyc`遗迹。因此，如果您的包 foo 包含一些无关紧要的代码，那么稍后删除该包并创建一个具有某些功能的文件 foo.py`def bar(): pass`并运行：

```
from foo import bar 
```

你得到：

```
ImportError: cannot import name bar 
```

因为 python 仍在使用 foo 包中的旧 .pyc 文件，这些文件都没有定义 bar。这在 Web 服务器上尤其成问题，因为 .pyc 文件可能会破坏完全正常运行的代码。

由于这两个原因（可能还有其他原因），您的部署代码和测试代码应该删除 .pyc 文件，例如使用以下 bash 行：

```
find . -name '*.pyc' -delete 
```

此外，从 python 2.6 开始，您可以运行带有`-B`标志的 python 以不使用 .pyc 文件。请参阅[如何避免 .pyc 文件？](https://stackoverflow.com/questions/154443/how-to-avoid-pyc-files)更多细节。

另请参阅：[如何从项目中删除所有 .pyc 文件？](https://stackoverflow.com/questions/785519/how-do-i-remove-all-pyc-files-from-a-project)

# api - Gitlab：通过 API 创建新用户 - 404

> ID：15839560
> 
> 赞同：3
> 
> 时间：2013-04-05T17:06:07.940
> 
> 标签：api, gitlab

我正在尝试使用 gitlab API v3 创建新用户。

Gitlab API 文档：[https ://github.com/gitlabhq/gitlabhq/blob/master/doc/api/users.md#user-creation](https://github.com/gitlabhq/gitlabhq/blob/master/doc/api/users.md#user-creation)

我正在向 mygitlabhost/api/v3/users/ 发送带有所有必需数据的 POST 请求：email=losddsd@gmail.com&password=33wrwsdfsf3&username=testone&name=fuuu 它返回给我 404。实际上我可以通过对 mygitlabhost/ 的 GET 请求列出所有用户api/v3/users/ 所以 API 似乎正在运行。

请求详情：http: [//imm.io/120o6](http://imm.io/120o6)

我错了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-11T10:29:20.563

请注意，[问题 3411“无法将用户添加到团队”](https://github.com/gitlabhq/gitlabhq/issues/3411)有一些解决方法：

*   阿帕奇
    将此添加到`/etc/apache2/sites-available/default`

```
  ProxyPass http://127.0.0.1:8085/gitlab/api
  ProxyPassReverse http://127.0.0.1:8085/gitlab/api

```

*   NGINX

```
位置 /api {
  proxy_set_header X-Forwarded-Proto $scheme;
  proxy_set_header 主机 $http_host;
  proxy_set_header X-Real-IP $remote_addr;
  proxy_pass http://gitlab-sock/gitlab/api;
  proxy_redirect 默认；
}

```

> 要解决此问题，您可以修改文件：[`app/assets/javascripts/api.js.coffee`](https://github.com/gitlabhq/gitlabhq/blob/master/app/assets/javascripts/api.js.coffee#L1-L4)以匹配您的设置。
> 
> 在我们的例子中，路径以 gitlab 作为前缀：

```
users_path: "/gitlab/api/:version/users.json"
user_path: "/gitlab/api/:version/users/:id.json"
notes_path: "/gitlab/api/:version/projects/:id/notes.json" 
```

# c# - 使用 WCF SOAP API 中的 HTTP 授权标头进行身份验证

> ID：15839565
> 
> 赞同：2
> 
> 时间：2013-04-05T17:06:27.067
> 
> 标签：c#, wcf, authentication, soap, header

我们目前有一个 WCF SOAP API，它允许消费者使用用户名和密码进行身份验证（内部使用[UserNamePasswordValidator](http://msdn.microsoft.com/en-us/library/system.identitymodel.selectors.usernamepasswordvalidator.aspx)）作为参考，用户名和密码在 SOAP 正文中传递如下：

```
<o:Security xmlns:o="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" mustUnderstand="1">
<Timestamp Id="_0">
    <Created>
        2013-04-05T16:35:07.341Z</Created>
        <Expires>2013-04-05T16:40:07.341Z</Expires>
    </Timestamp>
    <o:UsernameToken Id="uuid-ac5ffd20-8137-4524-8ea9-3f4f55c0274c-12">
        <o:Username>someusername</o:Username>
        <o:Password o:Type="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-username-token-profile-1.0#PasswordText">somepassword
    </o:Password>
</o:UsernameToken>
</o:Security> 
```

我们希望**额外**支持消费者在[HTTP 授权标头](http://www.w3.org/Protocols/rfc2616/rfc2616-sec14.html#sec14.8)中指定凭据，作为基本身份验证或[OAuth 持有者令牌](https://datatracker.ietf.org/doc/html/draft-ietf-oauth-v2-bearer-15#section-2.1)

我们已经有几种方法可以实际对非 SOAP API 进行身份验证，但我不熟悉如何告诉 WCF 使用我可能为此创建的任何类。我怎样才能做到这一点？我看到的唯一一个试图回答这个问题的问题是[here](https://stackoverflow.com/questions/2074361/wcf-with-http-basic-authentication)，但接受的答案使用 SOAP 标头，而不是 HTTP 标头，并且提问者基本上放弃了。

显然，任何解决方案都需要向后兼容——我们需要继续支持消费者在 SOAP 安全标头中指定凭据。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-14T05:47:46.750

您应该考虑实施`ServiceAuthorizationManager`为您的 WCF 服务实现一个来处理 HTTP Authorization 标头授权。

创建一个继承自 的类`System.ServiceModel.ServiceAuthorizationManager`，并覆盖一个或多个`CheckAccess`函数以检查传入的 Web 请求并决定是允许还是拒绝它。粗略的草图：

```
public class MyServiceAuthorizationManager: System.ServiceModel.ServiceAuthorizationManager
    {
        public override bool CheckAccess(OperationContext operationContext, ref Message message)
        {
            var reqProp = message.Properties[HttpRequestMessageProperty.Name] as HttpRequestMessageProperty;
            var authHeader = reqProp.Headers[HttpRequestHeader.Authorization];

            var authorized = // decide if this message is authorized...

            if (!authorized)
            {
                var webContext = new WebOperationContext(operationContext);
                webContext.OutgoingResponse.StatusCode = HttpStatusCode.Unauthorized;
                webContext.OutgoingResponse.Headers.Add(HttpResponseHeader.WwwAuthenticate, String.Format("Bearer realm=\"{0}\"", baseUri.AbsoluteUri));
            }

            return authorized;
        }
} 
```

将其连接到您创建服务主机的 WCF 服务中：

```
 restAPIServiceHost = new DataServiceHost(typeof(API.RestAPIService), restUris);

    var saz = restAPIServiceHost.Description.Behaviors.Find<ServiceAuthorizationBehavior>();
    if (saz == null)
    {
        saz = new ServiceAuthorizationBehavior();
        restAPIServiceHost.Description.Behaviors.Add(saz);
    }

    saz.ServiceAuthorizationManager = new MyServiceAuthorizationManager();

    restAPIServiceHost.Open(); 
```

这会将授权检查注入到 WCF 服务公开的每个方法中，而无需对服务方法本身进行任何更改。

您的 MyServiceAuthorizationManager 实现也可以使用 web.config 魔术安装到您的 WCF 服务中，但我发现直接代码更易于理解和调试。

请注意，很难在同一服务上使用多个授权检查系统，而不会相互影响或在您的安全范围内留下空白。如果您有`UserNamePasswordValidator`强制处理 SOAP 用户凭据的情况，它将拒绝仅包含 HTTP 授权标头的消息。同样，一个`ServiceAuthorizationManager`仅检查 HTTP Authorization 标头的 a 将使包含 SOAP 用户凭据的 Web 请求失败。您很可能需要弄清楚如何在同一个身份验证检查中检查这两种身份验证凭据表示。例如，如果消息中不存在 HTTP 授权标头，您可以向上面的 CheckAccess 函数添加代码以查找、提取和测试 SOAP 用户凭据。

当您必须接受多个身份验证表示时，您也需要决定优先级。如果存在 HTTP Authorization 标头，我怀疑它应该优先于 SOAP 消息中包含的任何内容。如果 HTTP 授权标头存在但无效，则句号 - 拒绝未授权的请求。SOAP 中的内容并不重要——无效的 HTTP 授权标头总是坏消息。如果根本没有 HTTP Authorization 标头，那么您可以四处寻找是否存在 SOAP 安全元素，您可以从中获取 SOAP 用户凭据并测试它们的有效性。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-14T05:12:56.890

您可以采用的一种方法是使用[MessageInspectors](http://msdn.microsoft.com/en-us/magazine/cc163302.aspx)。
像这样的东西：

*首先*- 创建消息检查器 - 负责使用您的凭据添加标题

```
using System;
using System.Collections.Generic;
using System.IO;
using System.Text;
using System.ServiceModel.Dispatcher;
using System.ServiceModel.Channels;
using System.ServiceModel;
using System.Xml;

namespace your_namespace
{

    /// <summary>
    /// /************************************
    /// * 
    /// * Creating Message inspector for 
    /// * updating all outgoing messages with Caller identifier header
    /// * read http://msdn.microsoft.com/en-us/magazine/cc163302.aspx
    /// * for more details
    /// * 
    /// *********************/
    /// </summary>
    public class CredentialsMessageInspector : IDispatchMessageInspector,
        IClientMessageInspector
    {
        public object AfterReceiveRequest(ref Message request,
            IClientChannel channel,
            InstanceContext instanceContext)
        {
            return null;
        }

        public void BeforeSendReply(ref Message reply, object
            correlationState)
        {
#if DEBUG
            //// Leave empty 
            //MessageBuffer buffer = reply.CreateBufferedCopy(Int32.MaxValue);
            //Message message = buffer.CreateMessage();
            ////Assign a copy to the ref received
            //reply = buffer.CreateMessage();

            //StringWriter stringWriter = new StringWriter();
            //XmlTextWriter xmlTextWriter = new XmlTextWriter(stringWriter);
            //message.WriteMessage(xmlTextWriter);
            //xmlTextWriter.Flush();
            //xmlTextWriter.Close();

            //String messageContent = stringWriter.ToString();
#endif             
        }

        public void AfterReceiveReply(ref Message reply, object
            correlationState)
        {
#if DEBUG
            //// Leave empty 
            //MessageBuffer buffer = reply.CreateBufferedCopy(Int32.MaxValue);
            //Message message = buffer.CreateMessage();
            ////Assign a copy to the ref received
            //reply = buffer.CreateMessage();

            //StringWriter stringWriter = new StringWriter();
            //XmlTextWriter xmlTextWriter = new XmlTextWriter(stringWriter);
            //message.WriteMessage(xmlTextWriter);
            //xmlTextWriter.Flush();
            //xmlTextWriter.Close();

            //String messageContent = stringWriter.ToString();
#endif
        }

        public object BeforeSendRequest(ref Message request,
            IClientChannel channel)
        {
            request = CredentialsHelper.AddCredentialsHeader(ref request);
            return null;
        }

        #region IDispatchMessageInspector Members

        #endregion
    }
} 
```

*第二*- 添加代码以添加标题

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Runtime.CompilerServices;
using System.Text;
using System.ServiceModel.Channels;
using System.ServiceModel;

namespace your_namespace
{

    public class CredentialsHelper
    {
       // siple string is for example - you can use your data structure here
        private static readonly string CredentialsHeaderName = "MyCredentials";
        private static readonly string CredentialsHeaderNamespace = "urn:Urn_probably_like_your_namespance";

        /// <summary>
        /// Update message with credentials
        /// </summary>
        public static Message AddCredentialsHeader(ref Message request)
        {

          string user = "John";
          string password = "Doe";

            string cred = string.Format("{0},{1}",   user, password);

            // Add header
            MessageHeader<string> header = new MessageHeader<string>(cred);
            MessageHeader untyped = header.GetUntypedHeader(CredentialsHeaderName, CredentialsHeaderNamespace);

            request = request.CreateBufferedCopy(int.MaxValue).CreateMessage();
            request.Headers.Add(untyped);

            return request;
        }

        /// <summary>
        /// Get details of current credentials from client-side added incoming headers
        /// 
        /// Return empty credentials when empty credentials specified 
        /// or when exception was occurred
        /// </summary>
        public static string GetCredentials()
        {
            string credentialDetails = string.Empty;
            try
            {
                credentialDetails = OperationContext.Current.IncomingMessageHeaders.
                    GetHeader<string>
                        (CredentialsHeaderName, CredentialsHeaderNamespace);
            }
            catch
            {
                    // TODO: ...
            }
            return credentialDetails;
        }

    }
} 
```

*第三*- 在服务器端获取您的凭据

```
public void MyServerSideMethod()
{
   string credentials = CredentialsHelper.GetCredentials();
   . . . 
} 
```

希望这可以帮助。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-10-28T11:24:37.933

对于基本身份验证，我通过将安全模式设置为传输来使 WCF 正常工作。

例如在 web.config 中：

```
<system.serviceModel>
  <services>
    <service behaviorConfiguration="DefaultServiceBehavior" name="MyService">
      <endpoint address="basic" binding="basicHttpBinding" bindingConfiguration="BasicAuthenticationBinding" name="MyEndpoint" contract="MyContract" />
    </service>
  </services>
  <bindings>
    <basicHttpBinding>
      <binding name="BasicAuthenticationBinding">
        <security mode="Transport">
          <transport clientCredentialType="Basic" />
        </security>
      </binding>
    </basicHttpBinding>
   </bindings>
</system.serviceModel> 
```

# asp.net - 我的 Visual Studio 程序/应用程序/网站默认托管在哪里？

> ID：15839568
> 
> 赞同：0
> 
> 时间：2013-04-05T17:06:31.400
> 
> 标签：asp.net, visual-studio-2010, visual-studio, iis, hosting

默认情况下（/在调试期间）托管的 Visual Studio 程序/应用程序/网站在哪里？我的意思是，当我在工作室中运行我的项目或只是在页面上右键单击并“在浏览器中查看”时......页面托管在哪里？

有人在工作中提到了“Visual Studio 服务器”。并且我们可以指导工作室使用本地 IIS。

任何人都可以对此有所了解，或者指向我可以找到更多信息的博客/文章吗？

谢谢！

编辑：我问这个问题是因为当我在本地和开发服务器上运行服务时，我的 WCF 服务身份验证设置的行为不同（服务不起作用）。我试图弄清楚在哪里寻找那些本地设置。

编辑：我正在使用 VS 2010，并在我的本地安装了 IIS 7。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-05T17:19:17.803

这取决于您安装的版本。在 VS 2012 中，如果你设置了一个 web 应用程序，它默认使用 IIS express，这给它一个`http://localhost:<port>`（例如 2122 或类似的东西）。您必须将其添加为虚拟目录才能在 IIS 下托管。您可以从项目的属性中非常轻松地做到这一点，在 Web 选项卡下。

以前的版本使用 Cassini 作为本地 Web 服务器。

# c# - 打开/关闭表单时出现大量 MVP 应用程序内存泄漏

> ID：15839577
> 
> 赞同：0
> 
> 时间：2013-04-05T17:07:18.993
> 
> 标签：c#, mvp

我正在从事一个存在内存泄漏的项目（基于 MVP 架构构建）。该应用程序正在使用 1GB 的内存，并在网格中显示记录列表。

我在这两个时刻对其进行了分析（拍摄了 2 个内存快照）：1\. 在打开从数据库加载数据的页面之前（内存使用量 = 400 MB）2\. 关闭页面时

关闭页面时，内存使用量保持不变（大约 1 GB），当它至少应该下降时（理想情况下它应该回到 400 MB，但不能总是控制 GC ......可以吗？）。我试图像这样控制进程的内存使用：

> Process.GetCurrentProcess().MaxWorkingSet = new IntPtr(1000000);

我打算使用另一件事：

`SetProcessWorkingSetSize(IntPtr handle, IntPtr min, IntPtr max)`

但我进一步尝试优化代码并且不知道如何。我很快会用大量代码编辑这篇文章，不要-1 ...

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-05T17:56:45.957

检查您的对象是否在大对象堆 (LOH) 中创建。检查您的活动订阅。参考[http://msdn.microsoft.com/en-us/magazine/cc534993.aspx](http://msdn.microsoft.com/en-us/magazine/cc534993.aspx)

# expressionengine - EE2：嵌入无法正确显示

> ID：15839579
> 
> 赞同：0
> 
> 时间：2013-04-05T17:07:31.930
> 
> 标签：expressionengine

我有一个网站，有两个频道，新闻和产品。

使用称为营销的嵌入式渠道条目标签对显示产品。新闻文章使用常规频道条目标签对显示。

当用户点击一篇新闻文章时，网站导航到一个新页面（新闻/视图），其中仅包含相关新闻文章的内容。该模板还包括包含产品标签对的嵌入式模板。这就是问题所在：显示的唯一已发布项目是新闻文章。新闻文章模板上不显示任何产品。

主页和“新闻/视图”模型：

```
{exp:channel:entries channel="news"}
    {title}
    <some markup>
    {body}
{/exp:channel:entries}
{embed="includes/marketing"} 
```

营销嵌入模板如下所示：

```
<some dividing markup>
{exp:channel:entries channel="products"}
<list markup>
   {product_image}
   {product_description}
</list markup>
{/exp:channel:entries}
</some dividing markup> 
```

由于主页和“新闻/视图”模板本质上是相同的，我不知道为什么产品显示在主页上而不是“新闻/视图”页面上。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-05T21:12:32.517

我不完全确定，但尝试将 dynamic="no" 添加到您的频道：条目循环中。这似乎解决了我 99% 的 EE 问题 :)

`{exp:channel:entries channel="products" dynamic="no"}`

# javascript - 加载资源的 JavaScript for 循环（改进加载）

> ID：15839585
> 
> 赞同：0
> 
> 时间：2013-04-05T17:07:47.973
> 
> 标签：javascript, for-loop

我正在编写一个简短的脚本，该脚本循环遍历一个数组并加载找到的每个结果，尽管我在加载时遇到了一些问题。如果我提醒我在每个循环中找到的结果，我会得到正确的数据，但是当我尝试加载这些数据时，它会失败。

```
var arrayScripts = new Array (
        'http://ajax.googleapis.com/ajax/libs/jquery/1.9.0/jquery.min.js', 
        'scripts/tiny_mce/tiny_mce.js',
        'scripts/jquery.cycle.lite.js',
        'scripts/javascript.default.js',
        'scripts/jquery.default.js'
    );

    for (var i=0; i < arrayScripts.length; i++) {
        scripts.add(arrayScripts[i]);
    }
    scripts.load(); 
```

我希望你能看到我在这里做错了什么。它似乎是我循环中的代码。

# sql-server - 分组和求和

> ID：15839586
> 
> 赞同：1
> 
> 时间：2013-04-05T17:07:52.017
> 
> 标签：sql-server, group-by, aggregate-functions

我无法获得 business_code 相同的注册总数。我的代码如下：

```
SELECT DISTINCT lb.building_code ,  lb.bus_code, gl.building_name, gl.bus_name, SUM(gl.enrollment) AS enrollment 
  FROM table1 AS gl 
  RIGHT OUTER JOIN table 2 AS lb ON gl.building_key = lb.building_key
  where gl.bus_name = 'Business'
  and gl.year_cd = 2010
  GROUP BY lb.building_code,  lb.bus_code, gl.building_name, gl.bus_name, gl.enrollment 
```

电流输出：

```
building_code   bus_code    bus_name      enrollment  
4581             0000       Business A    12
4581             0000       Business A    13
4581             0109       Business B    100
4581             0109       Business B    120 
4581             0209       Business C    130 
4581             0402       Business D    35 
```

期望的输出：

```
 building_code   bus_code    bus_name      enrollment  
    4581             0000       Business A    25
    4581             0109       Business B    220
    4581             0209       Business C    130 
    4581             0402       Business D    35 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-05T17:10:15.943

```
 SELECT lb.building_code,  
         lb.bus_code, 
         gl.bus_name,       
         SUM(gl.enrollment) AS enrollment 
  FROM table1 AS gl 
  RIGHT OUTER JOIN table 2 AS lb ON gl.building_key = lb.building_key
  where gl.bus_name = 'Business'
  and gl.year_cd = 2010
  GROUP BY lb.building_code, 
           lb.bus_code, 
           gl.bus_name 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-05T17:11:34.943

`gl.building_name, gl.enrollment`从`GROUP BY`子句中删除：

```
SELECT 
  lb.building_code ,  
  lb.bus_code, 
  gl.bus_name, 
  SUM(gl.enrollment) AS enrollment 
FROM table1 AS gl 
RIGHT OUTER JOIN table 2 AS lb ON gl.building_key = lb.building_key
where gl.bus_name = 'Business'
  and gl.year_cd = 2010
GROUP BY lb.building_code,  lb.bus_code, gl.bus_name; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-05T17:42:23.890

我会考虑重写两次。一，如果你的意思是这是一个外连接（所以包括 table2 中不在 table1 中的行），更改顺序，使其成为左连接，将 table1 的 where 子句移动到 join 子句中，删除不同的，并通过以下方式从组中删除未分组的列：

```
SELECT lb.building_code, lb.bus_code, gl.building_name, 
  gl.bus_name, SUM(gl.enrollment) AS enrollment 
FROM dbo.table2 AS lb
LEFT OUTER JOIN dbo.table1 AS gl 
  ON gl.building_key = lb.building_key
  AND gl.bus_name = 'Business'
  AND gl.year_cd = 2010
GROUP BY lb.building_code, lb.bus_code, gl.building_name, gl.bus_name; 
```

（对于绝大多数人来说， a`LEFT JOIN`比 a 直观得多`RIGHT JOIN`。）

如果您真的不希望 table2 中有任何不在 table1 中的行，那么首先不要将其写为外部联接：

```
SELECT lb.building_code, lb.bus_code, gl.building_name, 
  gl.bus_name, SUM(gl.enrollment) AS enrollment 
FROM dbo.table2 AS lb
INNER JOIN dbo.table1 AS gl 
  ON gl.building_key = lb.building_key
WHERE gl.bus_name = 'Business'
  AND gl.year_cd = 2010
GROUP BY lb.building_code, lb.bus_code, gl.building_name, gl.bus_name; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-05T17:51:02.693

尝试

由于您使用的是右外连接，所以不要忘记在 SUM 聚合器函数中添加 IsNull 来处理表 2 中的不匹配数据

```
SELECT lb.building_code ,  lb.bus_code, gl.bus_name, SUM(Isnull(gl.enrollment,0)) AS enrollment 
  FROM table1 AS gl 
  RIGHT OUTER JOIN table 2 AS lb ON gl.building_key = lb.building_key
  where gl.bus_name = 'Business'
  and gl.year_cd = 2010
  GROUP BY lb.building_code ,  lb.bus_code, gl.bus_name 
```

# php - Google 日历在创建事件时通知

> ID：15839587
> 
> 赞同：0
> 
> 时间：2013-04-05T17:07:52.387
> 
> 标签：php, calendar

在谷歌日历网站上创建事件信息时如何接收事件信息.. 我想获取事件并使用我的脚本处理它..

例子 ：

1- 用户在 Google 日历站点中创建事件 2- Google 将事件推送到我的网址 www.example.com/event.php 3-event.php 将处理事件数据

问题如何配置日历以发送创建事件？这适用还是我应该使用 cron 作业来查询 Google calander 并获取事件

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-02-17T13:41:40.257

Google 为日历引入了推送通知，更多详情请参阅[http://googledevelopers.blogspot.ch/2013/07/google-calendar-api-push-notifications.html](http://googledevelopers.blogspot.ch/2013/07/google-calendar-api-push-notifications.html)

# c# - C# 左移运算符

> ID：15839593
> 
> 赞同：4
> 
> 时间：2013-04-05T17:08:19.917
> 
> 标签：c#, filtering, bit-shift

我的一个同事写了一个我不完全理解的声明。不幸的是，他现在不可用，所以就在这里（名称已修改，我们正在 Unity 中开发一款游戏）。

```
private readonly int FRUIT_LAYERS =
          (1 << LayerMask.NameToLayer("Apple"))
        | (1 << LayerMask.NameToLayer("Banana")); 
```

NameToLayer 接受一个字符串并返回一个整数。我总是看到左移运算符与右侧的常量整数一起使用，而不是左侧，并且我通过 Google 找到的所有示例都遵循这种方法。在这种情况下，我认为他将 Apple 和 Banana 推到了同一个相关层（稍后我将使用它进行过滤）。将来会有更多的“水果”可供过滤。任何出色的stackoverflowers可以给我解释这些行发生了什么？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-04-05T17:13:58.517

`1 << x`本质上是在说“给我一个数字，其中第 (x+1) 位为 1，其余数字均为零。

`x | y`是按位或，因此它将遍历从 1 到 n 的每个位，如果该位在其中一个中为 1，`x`则`y`该位在结果中将为 1，否则将为 0。

因此，如果`LayerMask.NameToLayer("Apple")`返回`2`和`LayerMask.NameToLayer("Banana")`返回，`3`那么`FRUIT_LAYERS`将是一个设置了第 3 位和第 4 位的数字，它是`1100`二进制的，或者以 10 为底的 12。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-05T17:15:43.043

您的同事实际上是`int`在使用 a 代替 a`bool[32]`来尝试节省空间。您显示的代码块类似于

```
bool[] FRUIT_LAYERS = new bool[32];
FRUIT_LAYERS[LayerMask.NameToLayer("Apple")] = true;
FRUIT_LAYERS[LayerMask.NameToLayer("Banana")] = true; 
```

您可能需要考虑更像这样的模式：

```
[Flags]
enum FruitLayers : int
{
    Apple = 1 << 0,
    Banana = 1 << 1,
    Kiwi = 1 << 2,
    ...
}

private readonly FruitLayers FRUIT_LAYERS = FruitLayers.Apple | FruitLayers.Banana; 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-04-05T17:15:16.343

代码将二进制值 1 向左移动，要移动的二进制位数由 Apple 和 Banana 确定，在两个值移位后，以二进制方式进行 ORed

示例：假设 apple 返回 2，banana 返回 3，您将得到： 1 << 2 即 0100（十进制表示 4） 1 << 3 表示 1000（十进制表示 8）

现在 0100 按位或 1000 是 1100 这意味着 12

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-04-05T17:15:49.957

1 << n 基本上相当于 2 ^n。

# c# - 如何隐藏单个表单视图行

> ID：15839597
> 
> 赞同：-1
> 
> 时间：2013-04-05T17:08:25.043
> 
> 标签：c#, asp.net, formview

我试图根据我的会话变量的当前状态隐藏我的表单视图的单行。

目前我正在尝试将行包含在更新面板中，然后简单地将 Visible 属性设置为 true 或 false。

这目前不起作用。

这是代码：

```
 <asp:FormView ID="FormView1" runat="server" Height="51px" Width="387px">
         <EditItemTemplate>
           coffeeName:
           <asp:TextBox ID="coffeeNameTextBox" runat="server" 
               Text='<%# Bind("coffeeName") %>' />
           <br />
           coffeeOrigin:
           <asp:TextBox ID="coffeeOriginTextBox" runat="server" 
               Text='<%# Bind("coffeeOrigin") %>' />
           <br />
           coffeeStrength:
           <asp:TextBox ID="coffeeStrengthTextBox" runat="server" 
               Text='<%# Bind("coffeeStrength") %>' />
           <br />
           coffeePrice:
           <asp:TextBox ID="coffeePriceTextBox" runat="server" 
               Text='<%# Bind("coffeePrice") %>' />
           <br />
           coffeeGrind:
           <asp:TextBox ID="coffeeGrindTextBox" runat="server" 
               Text='<%# Bind("coffeeGrind") %>' />
           <br />
           coffeeQty:
           <asp:TextBox ID="coffeeQtyTextBox" runat="server" 
               Text='<%# Bind("coffeeQty") %>' />
           <br />
           coffeeRRP:
           <asp:TextBox ID="coffeeRRPTextBox" runat="server" 
               Text='<%# Bind("coffeeRRP") %>' />
           <br />
           <asp:LinkButton ID="UpdateButton" runat="server" CausesValidation="True" 
               CommandName="Update" Text="Update" />
           &nbsp;<asp:LinkButton ID="UpdateCancelButton" runat="server" 
               CausesValidation="False" CommandName="Cancel" Text="Cancel" />
       </EditItemTemplate>

       <ItemTemplate>

           <b>Origin:</b>
           <asp:Label ID="coffeeOriginLabel" runat="server" 
               Text='<%# Bind("coffeeOrigin") %>' />
           <br />
                        <br />
            <b>Grind:</b>
           <asp:Label ID="coffeeGrindLabel" runat="server" 
               Text='<%# Bind("coffeeGrind") %>' />
           <br />
                        <br />
           <b>Strength:</b>
           <asp:Label ID="coffeeStrengthLabel" runat="server" 
               Text='<%# Bind("coffeeStrength") %>' />
           <br />
                        <br />
           <b>Price: £</b>
           <asp:Label ID="coffeePriceLabel" runat="server" 
               Text='<%# Bind("coffeePrice") %>' />
           <br />
         <br />

            ********** Panel used to enclose the stock level**********

           <asp:Panel ID="panelLevel" runat="server">
           <b>Stock Level:</b>

           <asp:Label ID="coffeeQtyLabel" runat="server" Text='<%# Bind("coffeeQty") %>' />
           <br />
                        <br />
                                     <br />
       </asp:Panel>

       </ItemTemplate>

   </asp:FormView> 
```

我想达到什么目的。

当前表单视图：

![在此处输入图像描述](https://i.stack.imgur.com/j7Ca7.jpg)

将面板可见性设置为 false 应该会产生以下输出：

![在此处输入图像描述](https://i.stack.imgur.com/2fHLU.jpg)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-05T17:19:50.417

你能再给一些代码吗？更新面板在哪里？您如何设置行可见性？

试试这个，对我有用：

代码 CS：

 **```
 protected void Page_Load(object sender, EventArgs e)
    {
        if (!IsPostBack)
        {
            BindFormView();
        }
    }

    private void BindFormView()
    {
        DataTable dt = new DataTable();
        dt.Columns.Add("coffeeName", typeof(string));
        dt.Columns.Add("coffeeOrigin", typeof(string));
        dt.Columns.Add("coffeeStrength", typeof(int));
        dt.Columns.Add("coffeePrice", typeof(double));
        dt.Columns.Add("coffeeGrind", typeof(string));
        dt.Columns.Add("coffeeQty", typeof(int));
        dt.Columns.Add("coffeeRRP", typeof(int));

        DataRow dr = dt.NewRow();
        dr["coffeeName"] = "Kenya";
        dr["coffeeOrigin"] = "Smooth";
        dr["coffeeStrength"] = 6;
        dr["coffeePrice"] = 2.99;
        dr["coffeeGrind"] = "Kenya";
        dr["coffeeQty"] = 6;

        dt.Rows.Add(dr);

        FormView1.DataSource = dt;
        FormView1.DataBind();
    }

    protected void btnHideRow_Click(object sender, EventArgs e)
    {
        Session["HideRow"] = Session["HideRow"] == null ? false :                                        (bool)Session["HideRow"];
        BindFormView();
    }

    protected void FormView1_DataBound(object sender, EventArgs e)
    {
        if (Session["HideRow"] != null)
        {
            var pnlToHide = FormView1.FindControl("panelLevel");
            pnlToHide.Visible = (bool)Session["HideRow"];
        }
    } 
```**

# django - 开发服务器中 django ajax 站点的 URL 重写

> ID：15839599
> 
> 赞同：0
> 
> 时间：2013-04-05T17:08:31.150
> 
> 标签：django, django-urls

我正在开发一个使用 JavaScript 控制路由的 Ajax 站点。
我希望将每个请求都发送到 IndexView，但文件中声明的请求除外`urls.py`。
这是我的 urls.py 配置：

```
urlpatterns = patterns('',
    url(r'^api/', include('api.urls')),
    url(r'^admin/', include(admin.site.urls)),
    url(r'^$', IndexView.as_view()),
) 
```

如果我将正则表达式更改为`url(r'^', IndexView.as_view())`它可以工作，但 MEDIA_ROOT 中的文件将不会显示。
我知道在生产中我可以配置服务器以我想要的方式提供静态文件，但我希望它与开发服务器一起使用。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-05T17:43:06.390

愚蠢的解决方案。之后添加`url(r'^', IndexView.as_view())`，

```
if settings.DEBUG:
    urlpatterns += patterns('',
        (r'%s(?P<path>.*)' % settings.MEDIA_URL[1:], 'django.views.static.serve', {'document_root': settings.MEDIA_ROOT}),
    ) 
```

做了这项工作。但我对使用这种 ajax 应用程序管理路由的更好方法持开放态度。

# java - 使用 jpcap 伪造 ARPRequest

> ID：15839600
> 
> 赞同：3
> 
> 时间：2013-04-05T17:08:32.340
> 
> 标签：java, arp, jpcap

当我使用 JPCap 伪造 ARP 请求时，我注意到 jpcap 正在向 ARP 的尾部添加一个 18 字节零的尾部，我也对发送这些数据不感兴趣。有没有办法防止这种填充。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-05T18:59:09.143

您看到的零实际上是以太网帧的填充。以太网数据包的最小有效负载大小为 42 字节（原因与发送方需要传输一定时间以检测冲突有关）。据我所知，没有办法阻止这种情况，这样做会违反以太网规范。

另请参阅[https://serverfault.com/questions/496324/arp-packet-received-larger-than-packet-sent-why上的问题](https://serverfault.com/questions/496324/arp-packet-received-larger-than-packet-sent-why)

# localization - DNN中图像按钮的客户端定位

> ID：15839603
> 
> 赞同：0
> 
> 时间：2013-04-05T17:08:41.807
> 
> 标签：localization, dotnetnuke

如何在客户端本地化 DNN 中的图像按钮。我正在使用这种方法，但它的文字不会呈现

```
<asp:ImageButton runat="server" ID="SubmitForm" OnClick="AddContactOrder" CausesValidation="true" CssClass="submit-button" ImageUrl='<%=LocalizeString("btnSubmit") %>' /> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-05T18:42:31.413

类似的东西

```
LocalizeString("btnSubmit.ImageUrl",LocalResourceFile) 
```

您的 ASCX 文件从 PortalModuleBase 继承，并且在 app_localresources 中有一个 RESX 文件 View.ascx.resx（假设您使用的是 view.ascx）。在该 resx 文件中，您将定义 btnSubmit.ImageUrl 是什么。

# c++ - 关于 C++ 中的指针和数组

> ID：15839614
> 
> 赞同：4
> 
> 时间：2013-04-05T17:09:27.497
> 
> 标签：c++, c, arrays, pointers

我想问一个关于 C++ 中的指针和数组的问题。

```
int a[10];

int *p1; p1 = &a[0];

int *p2; p2 = a;

int (*p3)[10]; p3 = &a; 
```

p1，p2和p3有什么区别？他们非常混乱。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-04-05T17:13:04.180

首先，`a`是一个 10`int`秒的数组。那是容易的部分。

`p1`是一个“指向”的指针`int`。您正在为其分配 的值`&a[0]`。这需要 的第一个元素的地址`a`。所以`p1`现在指向 的第一个元素`a`。

`p2`也是一个“指针`int`”。您`a`直接分配给它。在这种情况下，必须进行称为数组到指针转换的标准转换。基本上，数组可以转换为指向其第一个元素的指针。您将此转换的结果分配给`p2`. 所以`p2`也是指向第一个元素的*指针*`a`。

`p3`是一个“指向 10 数组的指针`int`”。您正在获取数组的地址`a`并将其分配给此指针。所以现在这个指针指向数组本身（不是它的第一个元素）。

您可能会认为“第一个元素与数组具有相同的地址，那么有什么区别？” 事实上，当您尝试增加指针时，您会注意到不同之处。递增`p1`或`p2`将为您提供指向数组第二个元素的指针。递增`p3`将为您提供指向下一个 10 `int`s 数组的指针（实际上并不存在）。

```
┌─────┬─────┬─────┬─────┬─────┬─────┬─────┬─────┬─────┬─────┐
│ int │ int │ int │ int │ int │ int │ int │ int │ int │ int │ 
└─────┴─────┴─────┴─────┴─────┴─────┴─────┴─────┴─────┴─────┘
   ^
   └── p1, p2, p3 
```

因此，如果您从所描述的所有指向开始，然后增加它们，您将得到：

```
┌─────┬─────┬─────┬─────┬─────┬─────┬─────┬─────┬─────┬─────┬┄
│ int │ int │ int │ int │ int │ int │ int │ int │ int │ int │ 
└─────┴─────┴─────┴─────┴─────┴─────┴─────┴─────┴─────┴─────┴┄
         ^                                                     ^
         └── p1, p2                                            └── p3 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-04-05T17:12:08.370

`p1`指向 的第一个元素`a`。

`p2`导致`a`衰减为指向第一个元素的指针，因此它也指向 的第一个元素`a`。

`p3`被读取为指向十个整数数组的指针。它指向`a`自己，并且递增它会将其向前移动，`sizeof(int) * 10`而不是`sizeof(int)`.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-07T17:08:20.053

这些指针声明之间没有区别。它们都指向数组**a[]**（索引0）的第一个元素。它们只是编写语句的不同风格。

# java - 为 Applet / Webstart 添加下限

> ID：15839615
> 
> 赞同：0
> 
> 时间：2013-04-05T17:09:27.643
> 
> 标签：java, security, applet, jnlp, restrictions

我有一个简单的 Applet 应用程序，我的代码从 Applet 的相同 url 创建 ImageIcon 对象。当我运行应用程序时，我收到一条关于无限制访问的消息，它吓到了用户。

**如何将我的 Applet 或 JNLP 配置为仅显示特定的限制消息？**

**编辑** 毕竟，我重构了我的代码并找到了正确加载图像的方法。要从 JAR 加载图像：http: *[//docs.oracle.com/javase/tutorial/uiswing/components/applet.html#images](http://docs.oracle.com/javase/tutorial/uiswing/components/applet.html#images)*。从小程序加载图像：`imageIcon = new ImageIcon(getImage(getCodeBase(), "image/image_name.png"));`

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-09T01:04:16.330

> 如何将我的 Applet 或 JNLP 配置为仅显示特定的限制消息？

除了为[JNLP API 服务](http://pscode.org/jws/api.html)`all-permissions`显示的更具体的权限之外，Java 不提供比`j2ee-application-client-permissions`或沙盒（无`security`元素）更精细的权限等级。

* * *

但是，由于 OP 链接的错误，似乎可以看到*此警告。*

[Netbeans 错误 227169 - java.security.AccessControlException：访问被拒绝（“java.lang.RuntimePermission”“modifyThreadGroup”）](https://netbeans.org/bugzilla/show_bug.cgi?id=227169)

# excel - VBA宏使用marlett检查删除未检查的行

> ID：15839622
> 
> 赞同：0
> 
> 时间：2013-04-05T17:09:44.187
> 
> 标签：excel, vba, delete-row

我在 VBA 中并没有太多的背景知识，但我正在尝试创建一个宏，在该宏中，按下按钮，所有在一定范围内没有复选标记的行都会被删除。我浏览了一些论坛，并了解了“marlett”检查，该字体中的字符“a”显示为复选标记。这是我在适当范围内单击 A 列中的单元格时必须自动生成“marlett 检查”的代码：

```
Private Sub Worksheet_SelectionChange(ByVal Target As Range)

    If Target.Cells.Count > 1 Then Exit Sub
        If Not Intersect(Target, Range("A10:A111")) Is Nothing Then
            Target.Font.Name = "Marlett"
                If Target = vbNullString Then
                    Target = "a"
                Else
                    Target = vbNullString
                End If
        End If

End Sub 
```

然后我有另一个宏（分配给一个按钮），当按下按钮时，它实际上删除了“A”列中没有复选标记的行：

```
Sub delete_rows()

Dim c As Range

On Error Resume Next
For Each c in Range("A10:A111")
    If c.Value <> "a" Then
        c.EntireRow.Delete
    End If
Next c

End Sub 
```

一切正常，但唯一的问题是我必须**多次按下按钮**才能删除所有未选中的行！看来我的循环无法正常工作-有人可以帮忙吗？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-05T17:19:14.687

我认为这可能是由于您删除行的方式，每次删除后您可能会跳过一行。

您可能希望将 for-each 更改为常规 for 循环。所以你可以控制你正在处理的索引。[请参阅此答案](https://stackoverflow.com/a/15375279/212869)或该问题的其他答案以了解如何操作。

这是一个修改后的版本，应该适合您的（可能的）问题。

```
Sub Main()
    Dim Row As Long
    Dim Sheet As Worksheet
    Row = 10
    Set Sheet = Worksheets("Sheet1")
    Application.ScreenUpdating = False
    Do
        If Sheet.Cells(Row, 1).Value = "a" Then
            'Sheet.Rows(Row).Delete xlShiftUp
            Row = Row + 1
        Else
            'Row = Row + 1
            Sheet.Rows(Row).Delete xlShiftUp
        End If
    Loop While Row <= 111
    Application.ScreenUpdating = True
End Sub 
```

**更新** ~~尝试我对 if 块所做的编辑，有点猜测。当我有excel时会看它。~~

无论建议的更改如何，它都会进入无限循环。问题是当它接近数据的末尾时，它不断地发现空行（因为没有更多的数据！）所以它一直在删除它们。

下面的代码应该可以工作。

```
Sub Main()
    Dim Row As Long: Row = 10
    Dim Count As Long: Count = 0
    Dim Sheet As Worksheet
    Set Sheet = Worksheets("Sheet1")
    Application.ScreenUpdating = False
    Do
        If Sheet.Cells(Row, 1).Value = "a" Then
            Row = Row + 1
        Else
            Count = Count + 1
            Sheet.Rows(Row).Delete xlShiftUp
        End If
    Loop While Row <= 111 And Row + Count <= 111
    Application.ScreenUpdating = True
End Sub 
```

# c# - 使用具有相同属性的多个模型并使用唯一视图的最佳方法是什么？

> ID：15839623
> 
> 赞同：0
> 
> 时间：2013-04-05T17:09:47.063
> 
> 标签：c#, asp.net-mvc, entity-framework, razor

例如，我有 3 个具有 Id (int)、Name (string) 和 active (bool) 的模型。对于具有相同属性的这些模型，是否可以只使用一个视图？像通用对象这样的技术？继承？这是为了避免使用相同的 HTML 代码编写多个视图。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-05T17:14:28.437

您可以创建一个[ViewModel](http://en.wikipedia.org/wiki/View_model)。

样品：

```
public class CustomerViewModel
{
   public int Id { get; set; }
   public string Name { get; set; }
   public bool Active { get; set; }
} 
```

并创建另一个具有如下类型的 ViewModel：

```
public class CustomersViewModel
{
    public CustomerViewModel Customer1 { get; set; }
    public CustomerViewModel Customer2 { get; set; }
    public CustomerViewModel Customer3 { get; set; }
} 
```

并使用此类型键入您的视图：

```
@model CustomersViewModel 
```

或者只是使用一个集合来输入你的视图

```
@model List<CustomerViewModel> 
```

看看这个答案！ [https://stackoverflow.com/a/694179/316799](https://stackoverflow.com/a/694179/316799)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-05T17:14:53.697

在视图中，您可以

*   为所有模型指定共享基类并使用它。
*   用作`dynamic`模型
*   拆分共享视图（提取到单独视图）和特定部分。比使用现有模型（如果使用基类/动态模型）或简单地基于特定模型中的数据构建的新模型调用共享子视图。

使用继承提取共享部分的示例。使用[Html.Partial](http://msdn.microsoft.com/en-us/library/ee402926%28v=vs.100%29.aspx)呈现共享部分：

```
class SharedModel { /* Id,...*/ }
class SpecificModel : SharedModel { /* Special... */ } 
```

具体视图：

```
@model SpecificModel 
@Html.Partial("SharedView", Model)
<div>@Model.Special</div> 
```

共享视图：

```
@model SharedModel 
<div>@Model.Id</div> 
```

旁注：如果视图名称与操作名称不匹配，您可以在返回结果时使用[View指定视图名称：](http://msdn.microsoft.com/en-us/library/dd460352%28v=vs.108%29.aspx)

```
return View("MySharedView", model); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-05T17:55:57.633

在 ASP.NET MVC4 中，您有机会不为视图定义模型。这意味着将模型的定义留空（不要使用@model MyNamespace.MyClass），然后它将自动使用“动态”作为模型。

问候基督徒

# android - 带有动画的 Listview 项目无法正确呈现

> ID：15839626
> 
> 赞同：3
> 
> 时间：2013-04-05T17:10:07.360
> 
> 标签：android, android-listview, android-animation

当位图异步加载时，有一个由位图填充的 gridView。有时在抛出 gridView 时，某些项目无法正确呈现。动画将触发，但位图根本不会显示。

我已经确认位图确实存在（至少是数据），但它只是不渲染。

这种情况在快速滚动 gridView 时会发生，但也会在慢速滚动时发生。视图回收似乎无法正常工作。这是我的代码：

ListView 适配器：

```
@Override
    public View getView(int position, View convertView, ViewGroup parent)
    {
        if(convertView == null){
            convertView = new FlipAnimatedCacheableImage(mContext);
        }
        final ImageInfo info = mapItem(getItem(position));
        FlipAnimatedCacheableImage image = (FlipAnimatedCacheableImage)convertView;
        image.resetState();
        image.setTitle(info.title);
        image.setSubTitle(info.subTitle);
        image.loadImage(info.imgURL, false);
        return convertView;
    } 
```

FlipAnimatedCacheableImage 的代码：

```
public class FlipAnimatedCacheableImage extends FrameLayout
{
    private static final String TAG = FlipAnimatedCacheableImage.class.getCanonicalName();
    protected static final long DURATION = 300;
    private ImageView mPlaceHolder;
    private NetworkedCacheableImageView mCacheableImage;
    private View mTextContainer;
    private TextView mTitleTv;
    private TextView mSubTitleTv;
    private View mProgress;

    private ImageLoadListener mListener = new ImageLoadListener()
    {

        private boolean isShown;

        @Override
        public void onImageLoaded(boolean animate)
        {
            if(animate){
                mProgress.setVisibility(View.GONE);
                mPlaceHolder.setVisibility(View.VISIBLE);
                mPlaceHolder.setRotationY(0);
                mCacheableImage.setVisibility(View.VISIBLE);
                mCacheableImage.setRotationY(-90);
                mPlaceHolder.animate().rotationY(90).setDuration(DURATION).start();
                mCacheableImage.animate().rotationY(0).setDuration(DURATION).setStartDelay(DURATION).start();

                if(!TextUtils.isEmpty(mTitleTv.getText()) || !TextUtils.isEmpty(mSubTitleTv.getText())){
                    mTextContainer.setVisibility(View.VISIBLE);
                    mTextContainer.setAlpha(0);
                    mTextContainer.animate().alpha(1).setDuration(DURATION).setStartDelay(DURATION * 2).start();
                }
                else{
                    mTextContainer.setVisibility(View.GONE);
                }
                isShown = true;
                FlipAnimatedCacheableImage.this.invalidate();
            }
            else{
                mPlaceHolder.setVisibility(View.GONE);
                mProgress.setVisibility(View.GONE);
                mCacheableImage.setVisibility(View.VISIBLE);
                mCacheableImage.setRotationY(0);
                mCacheableImage.clearAnimation();

                if(!TextUtils.isEmpty(mTitleTv.getText()) || !TextUtils.isEmpty(mSubTitleTv.getText())){
                    mTextContainer.setVisibility(View.VISIBLE);
                    mTextContainer.setAlpha(1);
                }
                else{
                    mTextContainer.setVisibility(View.GONE);
                }

                FlipAnimatedCacheableImage.this.invalidate();
            }
        }
    };

    public FlipAnimatedCacheableImage(Context context, boolean isLarge)
    {
        this(context, null, 0, isLarge);
    }

    public FlipAnimatedCacheableImage(Context context)
    {
        this(context, null);
    }

    public FlipAnimatedCacheableImage(Context context, AttributeSet attrs)
    {
        this(context, attrs, 0, false);
    }

    public FlipAnimatedCacheableImage(Context context, AttributeSet attrs, int defStyle, boolean isLarge)
    {
        super(context, attrs, defStyle);
        LayoutInflater inflater = LayoutInflater.from(context);

        inflater.inflate(R.layout.item_image_thumbnail, this);

        mCacheableImage = (NetworkedCacheableImageView)this.findViewById(R.id.image_view);
        mPlaceHolder = (ImageView)this.findViewById(R.id.place_holder);
        mProgress = this.findViewById(R.id.progressBar);

        // only used by small images
        mTextContainer = this.findViewById(R.id.text_container);
        mTitleTv = (TextView)this.findViewById(R.id.text_title);
        mSubTitleTv = (TextView)this.findViewById(R.id.text_sub_title);

        // listener to animate after loading
        mCacheableImage.setLoadListener(mListener);

        // set default state
        mTextContainer.setVisibility(View.GONE);
        mTitleTv.setVisibility(GONE);
        mSubTitleTv.setVisibility(GONE);
        if(isLarge){
            // adjust the size to the correct dimensions, ignore titleAnd subTitle
            FrameLayout.LayoutParams imageParams = new FrameLayout.LayoutParams((int)context.getResources()
                .getDimension(R.dimen.grid_image_width_large), (int)context.getResources().getDimension(
                R.dimen.grid_image_height_large));
            findViewById(R.id.content_wrapper).setLayoutParams(imageParams);
        }
        // this.setOnClickListener(listener);
        resetState();

    }

    public void resetState()
    {
        mCacheableImage.setVisibility(View.VISIBLE);
        mCacheableImage.setRotationY(0);
        mProgress.setVisibility(View.VISIBLE);
        mPlaceHolder.setVisibility(View.VISIBLE);
        mTextContainer.setVisibility(View.GONE);
        mTitleTv.setVisibility(GONE);
        mSubTitleTv.setVisibility(GONE);
    }

    public boolean loadImage(String url, boolean fullSize)
    {
        return mCacheableImage.loadImage(url, fullSize);
    }

    public void setTitle(String title)
    {
        mTitleTv.setText(title);
        if(!TextUtils.isEmpty(title)){
            mTitleTv.setVisibility(View.VISIBLE);
        }
        else{
            mTitleTv.setVisibility(View.GONE);

        }
    }

    public void setSubTitle(String subTitle)
    {
        mSubTitleTv.setText(subTitle);
        if(!TextUtils.isEmpty(subTitle)){
            mSubTitleTv.setVisibility(View.VISIBLE);
        }
        else{
            mSubTitleTv.setVisibility(View.GONE);
        }
    }

} 
```

[FlipAnimatedCache 将从 Chris Banes 在此处https://github.com/chrisbanes/Android-BitmapCache](https://github.com/chrisbanes/Android-BitmapCache)编写的缓存中请求图像

这是该代码：

```
/*******************************************************************************
 * Copyright 2011, 2013 Chris Banes.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *******************************************************************************/

/**
 * Simple extension of CacheableImageView which allows downloading of Images of
 * the Internet.
 * 
 * This code isn't production quality, but works well enough for this sample.s
 * 
 * @author Chris Banes
 * 
 */
public class NetworkedCacheableImageView extends CacheableImageView
{
    private static final String TAG = NetworkedCacheableImageView.class.getCanonicalName();

    public interface ImageLoadListener
    {
        public void onImageLoaded(boolean animate);
    }

    /**
     * This task simply fetches an Bitmap from the specified URL and wraps it in
     * a wrapper. This implementation is NOT 'best practice' or production ready
     * code.
     */
    private static class ImageUrlAsyncTask extends AsyncTask<String, Void, CacheableBitmapDrawable>
    {

        private final BitmapLruCache mCache;
        private final WeakReference<ImageView> mImageViewRef;
        private final WeakReference<NetworkedCacheableImageView> viewRef;
        private final BitmapFactory.Options mDecodeOpts;

        private final ImageLoadListener mLoadListener;
        private boolean outOfMemoryFailure;
        private String mURL;

        ImageUrlAsyncTask(ImageView imageView, BitmapLruCache cache, BitmapFactory.Options decodeOpts,
            ImageLoadListener listener, NetworkedCacheableImageView view)
        {
            mCache = cache;
            mLoadListener = listener;
            mImageViewRef = new WeakReference<ImageView>(imageView);
            viewRef = new WeakReference<NetworkedCacheableImageView>(view);
            mDecodeOpts = decodeOpts;

        }

        @Override
        protected CacheableBitmapDrawable doInBackground(String... params)
        {
            try{
                // Return early if the ImageView has disappeared.
                if(null == mImageViewRef.get()){
                    return null;
                }

                mURL = params[0];

                // Now we're not on the main thread we can check all caches
                CacheableBitmapDrawable result = mCache.get(mURL, mDecodeOpts);

                if(null == result){
                    Log.w("CACHE", "Downloading: " + mURL);

                    // The bitmap isn't cached so download from the web
                    HttpURLConnection conn = (HttpURLConnection)new URL(mURL).openConnection();
                    InputStream is = new BufferedInputStream(conn.getInputStream());

                    // Add to cache
                    result = mCache.put(mURL, is, mDecodeOpts);
                }
                else{
                    Log.w("CACHE", "Got from Disk Cache: " + mURL);
                }

                return result;

            }
            catch(IOException e){
                Log.e("Error downloading image", e.toString());
            }
            catch(OutOfMemoryError e){
                Log.e(TAG, "running out of memory, trimming image memory cache");
                outOfMemoryFailure = true;
            }

            return null;
        }

        @Override
        protected void onPostExecute(final CacheableBitmapDrawable result)
        {
            // super.onPostExecute(result);
            if(outOfMemoryFailure || result == null || !result.hasValidBitmap()){
                mCache.trimMemory();
                // viewRef.get().loadImageAsync(mURL, mDecodeOpts);
                Log.e(TAG, "image probably did not load::" + mURL);
            }
            else{
                if(BuildConfig.DEBUG){
                    Log.d("bitmapCache", "NetworkedCacheableImageView.ImageUrlAsyncTask.onPostExecute() WIDTH:"
                        + result.getBitmap().getWidth());
                    Log.d("bitmapCache", "NetworkedCacheableImageView.ImageUrlAsyncTask.onPostExecute() HEIGHT:"
                        + result.getBitmap().getHeight());

                }
                Log.i(TAG, "RESULT for :" + mURL + " mImageViewRef::" + mImageViewRef + " outOfMemoryFailure::"
                    + outOfMemoryFailure);
                if(result != null){
                    Log.i(TAG, "RESULT object for :" + mURL + " result:hasValidBitmap" + result.hasValidBitmap()
                        + " result:isReferencedByCache" + result.isReferencedByCache() + " result.isBeingDisplayed() "
                        + result.isBeingDisplayed());
                }

                Runnable runnable = new Runnable()
                {

                    @Override
                    public void run()
                    {
                        if(mImageViewRef != null){
                            final ImageView iv = mImageViewRef.get();
                            Log.e(TAG, "RESULT image view reference :" + mURL + " view ref::" + iv);

                            if(null != iv){
                                iv.setImageDrawable(result);
                                if(mLoadListener != null){
                                    mLoadListener.onImageLoaded(true);
                                }
                            }

                        }

                    }
                };

                Handler handler = new Handler();
                handler.postDelayed(runnable, 50);

            }
            super.onPostExecute(result);
        }
    }

    private final BitmapLruCache mCache;
    private ImageUrlAsyncTask mCurrentTask;
    private ImageLoadListener mListener;

    public NetworkedCacheableImageView(Context context, AttributeSet attrs)
    {
        super(context, attrs);
        mCache = WatchApplication.getBitmapCache();

    }

    public void setLoadListener(ImageLoadListener listener)
    {
        mListener = listener;
    }

    public void removeListener()
    {
        mListener = null;
    }

    /**
     * Loads the Bitmap.
     * 
     * @param url
     *        - URL of image
     * @param fullSize
     *        - Whether the image should be kept at the original size
     * @return true if the bitmap was found in the cache
     */
    public boolean loadImage(String url, final boolean fullSize)
    {
        setImageDrawable(null);
        // First check whether there's already a task running, if so cancel it
        if(TextUtils.isEmpty(url))
            return false;
        if(null != mCurrentTask){
            mCurrentTask.cancel(false);
        }

        // Check to see if the memory cache already has the bitmap. We can
        // safely do
        // this on the main thread.
        BitmapDrawable wrapper = mCache.getFromMemoryCache(url);

        if(null != wrapper){
            // The cache has it, so just display it
            if(BuildConfig.DEBUG){
                Log.w(TAG, "CACHE. FOUND IN MEMORY:" + url);
            }
            setImageDrawable(wrapper);
            if(mListener != null){
                mListener.onImageLoaded(false);
            }
            return true;
        }
        else{
            // Memory Cache doesn't have the URL, do threaded request...

            BitmapFactory.Options decodeOpts = null;

            if(!fullSize){
                decodeOpts = new BitmapFactory.Options();
                // decodeOpts.inDensity = DisplayMetrics.DENSITY_XHIGH;
                decodeOpts.inPurgeable = true;
                decodeOpts.outHeight = this.getHeight();
                decodeOpts.outWidth = this.getWidth();
            }

            loadImageAsync(url, decodeOpts);

            return false;
        }
    }

    public void loadImageAsync(String url, BitmapFactory.Options decodeOpts)
    {
        mCurrentTask = new ImageUrlAsyncTask(this, mCache, decodeOpts, mListener, this);

        if(Build.VERSION.SDK_INT >= Build.VERSION_CODES.HONEYCOMB){
            SDK11.executeOnThreadPool(mCurrentTask, url);
        }
        else{
            mCurrentTask.execute(url);
        }
    }

} 
```

提前感谢您的帮助！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-05T20:16:47.747

有两件事值得尝试——

对于链接动画操作，请使用侦听器：

```
mPlaceHolder.animate()
    .alpha(0f)
    .scaleX(0.9f)
    .scaleY(0.9f)
    .rotationY(90)
    .setDuration(DURATION)
    .setListener(new AnimatorListenerAdapter() {
              @Override
              public void onAnimationEnd(Animator animation) {
                  mCacheableImage.setImageDrawable(drawable);
                  mCacheableImage.animate()
                          .alpha(1f)
                          .scaleY(1f)
                          .scaleX(1f)
                          .rotationY(0)
                          .setDuration(DURATION)
                          .setListener(null);
              }
    }); 
```

使用[setHasTransientState()](https://developer.android.com/reference/android/view/View.html#setHasTransientState%28boolean%29)确保视图不会在 ListView/GridView 中回收。有关更多信息，请参阅此[DevByte 视频](http://www.youtube.com/watch?v=8MIfSxgsHIs)。

# php - 在 javascript 函数参数中插入变量

> ID：15839630
> 
> 赞同：1
> 
> 时间：2013-04-05T17:10:18.067
> 
> 标签：php, javascript, mysql, ajax, oop

我到处找，找不到我的问题的具体答案。我尝试了所有建议都无济于事。

使用 AJAX、javascript、PHP 和 MySQL。我正在创建一个脚本，当被调用时会获取用户列表。在该用户列表上，我想包含一个链接来管理有关该用户的信息。这是我卡住的地方。

链接管理应该链接到 managePlayer("userID")（例如：managePlayer(1)）。这个尚未创建的 javascript 函数将使用用户 ID 并将其传递给 PHP 以生成与该用户 ID 相关的 mySQL 数据库信息。

问题是，我终生无法弄清楚如何将带有变量 userID 参数的 managePlayer 函数输入到链接中。

这是我的代码：

```
 var userID = response.data[index].user_id;

            htmlString += "<tr class='rowLight' height='30'> <td>"
                + response.data[index].user_name
                + "</td><td>"
                + response.data[index].first_name
                + "</td><td>"
                + response.data[index].last_name
                + "</td><td>"
                + response.data[index].email_address
                + "</td><td>"
                **+ "<a href='javascript:' onClick='managePlayer(\'' + userID'\');'>Manage Player</a>"
                + "</td></tr>"; 
```

带有*** * 的行是直接问题所在。

感谢您的所有帮助！谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-05T17:14:02.167

尝试

```
+ '<a href="#" onClick="return managePlayer(\'' + userID +'\');">Manage Player</a>' 
```

因为您需要在单引号中引用用户标识，最后以

```
<a href="#" onclick="return managePlayer('John')">Manage player</a> 
```

并在管理播放器末尾添加

```
return false; 
```

如果 eclipse 不喜欢它，请交换引号

```
+ "<a href='#' onClick='return managePlayer(\""+ userID +"\");'>Manage Player</a>" 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-05T17:13:31.737

试试这个。我想它会起作用的..

```
+ "<a href='javascript:' onClick='managePlayer(\'"+userID+"\');'>Manage Player</a>" 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-05T17:26:13.210

是`userID`一个`Number`还是`String`？

**A）如果它是`String`：**

```
"<a href='javascript:' onClick='managePlayer(\"" + userID + "\");'>Manage Player</a>" 
```

因为生成的 HTML 字符串将是：

例如。如果`userID`是`"123"`。那么 HTML 应该是：

```
<a href='javascript:' onClick='managePlayer("123");'>Manage Player</a> 
```

*诀窍是因为您对 HTML属性*使用了单引号，那么您需要对onclick使用`"`双引号；`managePlayer()`但是，因为您使用的是*JavaScript*字符串`"`，所以您需要对.*`"``managePlayer()`*

 ** * *

**B）如果它是`Number`：**

```
"<a href='javascript:' onClick='managePlayer(" + userID + ");'>Manage Player</a>" 
```

所以生成的 HTML 字符串将是

例如。如果`userID`是`123`。那么 HTML 应该是：

```
<a href='javascript:' onClick='managePlayer(123);'>Manage Player</a> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-05T17:14:11.603

```
+ "<a href='javascript:' onClick='managePlayer('" + userID + "');'>Manage Player</a>"
                                                ^--       ^^^^-- 
```

由于您当时处于双引号字符串中，因此您需要打破该双引号字符串，以便您回到实际构建该字符串的“代码”级别。*

# .net - 如何在本地欺骗主机（用于测试）？

> ID：15839632
> 
> 赞同：1
> 
> 时间：2013-04-05T17:10:21.987
> 
> 标签：.net, iis, asp.net-mvc-4, spoofing

是否可以欺骗主机进行测试？

我正在处理的网站设置为检测请求的 url 并呈现品牌资产。例如，www.aaa.com 和 www.bbb.com 都指向我的网络应用程序，但它检测到请求了 www.aaa.com，因此它为该品牌加载了正确的资产。

问题是我不知道如何有效地测试它。我的第一直觉是将 www.aaa.com 添加到我的主机文件中并将其解析为 127.0.0.1:64099（例如），但您不能指定端口。在不实际发布到 IIS 或在端口 80 上运行的站点的情况下，我还能如何解决这个问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-05T17:18:22.397

您可以将两个 url 添加到主机文件中。不需要在此处指定端口，并且仍然可以使用：

```
127.0.0.1 www.aaa.com
127.0.0.1 www.bbb.com 
```

在浏览器中，键入：

```
http://www.aaa.com:64099
http://www.bbb.com:[port num] 
```

以上假设您的站点绑定到特定的主机名（www.aaa.com 等）和端口号。

# java - Android 首选项特定的权限请求

> ID：15839637
> 
> 赞同：1
> 
> 时间：2013-04-05T17:10:34.697
> 
> 标签：java, android, android-preferences, android-calendar, android-permissions

有没有办法仅在用户启用某个偏好时才请求特定权限？

就我而言，我可以选择与日历同步以添加日期和设置提醒（据我所知，您无法使用 Intents 在日历中设置提醒）。显然我需要访问日历的权限，但仅当用户启用此选项时。我想，当用户启用首选项时，请求权限，然后在未授予权限时禁用该选项。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-05T17:15:34.597

不。不幸的是，没有选择这样做。

`No checks with the user are done while an application is running: it either was granted a particular permission when installed, and can use that feature as desired, or the permission was not granted and any attempt to use the feature will fail without prompting the user.`

[http://developer.android.com/guide/topics/security/permissions.html](http://developer.android.com/guide/topics/security/permissions.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2018-04-23T18:36:52.897

这是可能的，因为棉花糖。观看[视频，展示向 Android Marshmallow 请求许可的最佳做法](https://developer.android.com/guide/topics/permissions/index.html#android-marshmallow-60-asking-for-permission "Android Marshmallow 6.0：请求许可")

您可以在 Android 开发人员指南中找到允许您执行此操作的代码片段，[以请求 Marshmallow 及更高版本的权限](https://developer.android.com/training/permissions/requesting.html)

# spring - 无法使用 Spring 3 连接到 JBoss 5 中的 HornetQ 连接工厂

> ID：15839639
> 
> 赞同：0
> 
> 时间：2013-04-05T17:10:42.460
> 
> 标签：spring, jboss, jms, hornetq

在本地，我的应用程序可以很好地连接到内置的 netty ConnectionFactory，并且我在启动或发送主题消息时没有问题。我的本地机器是独立的 JBoss 5.1 和独立的 HornetQ。

但是，当部署到我们的 DEV 服务器（运行集群 JBoss 5.1 和集群 HornetQ）时，我无法连接，得到以下堆栈跟踪：

```
ERROR [org.apache.catalina.core.ContainerBase.[jboss.web].[localhost].[/eShowroom]] (main) Exception sending context initialized event to listener instance of cla>\ss org.springframework.web.context.ContextLoaderListener
org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'topicConnectionFactory' defined in ServletContext resource [/WEB-INF/applicationContext.xml]: Invocation of init method failed; nested exception is javax.naming.NameNotFoundException: ConnectionFactory not bound 
```

我正在尝试使用默认的内置 netty 连接器，除了我自己的 JMS 主题之外没有额外的配置。我相对不知道 DEV 服务器设置，因为它超出了我的控制范围，对我来说*相当*黑匣子。

**applicationContext.xml**（在`$JBOSS_HOME/server/default/deploy/application.war/WEB-INF`）：

```
 <bean id="jndiTemplate" class="org.springframework.jndi.JndiTemplate">
       <property name="environment">
            <props>
                <prop key="java.naming.factory.initial">org.jnp.interfaces.NamingContextFactory</prop>
                <prop key="java.naming.provider.url">jnp://${jboss.bind.address:localhost}:1099</prop>
                <prop key="java.naming.factory.url.pkgs">org.jboss.naming</prop>
            </props>
       </property>
    </bean>

    <bean id="topicConnectionFactory" class="org.springframework.jndi.JndiObjectFactoryBean">
        <property name="jndiTemplate" ref="jndiTemplate"></property>
        <property name="jndiName" value="/ConnectionFactory"></property>
    </bean>

    <bean id="cacheTopic" class="org.springframework.jndi.JndiObjectFactoryBean">
        <property name="jndiTemplate" ref="jndiTemplate"></property>
        <property name="jndiName" value="/topic/myCacheTopic"></property>
    </bean>

    <bean id="jmsDestinationResolver" class="org.springframework.jms.support.destination.JndiDestinationResolver">
        <property name="jndiTemplate" ref="jndiTemplate"/>
        <property name="cache" value="true"/>
    </bean>

    <bean id="messageSendTemplate" class="org.springframework.jms.core.JmsTemplate">
        <property name="connectionFactory" ref="topicConnectionFactory"/>
        <property name="destinationResolver" ref="jmsDestinationResolver"/>
        <property name="pubSubDomain" value="true"/>
    </bean> 
```

**hornetq-jms.xml** (在`$JBOSS_HOME/server/default/deploy/hornetq.sar`)

```
 <connection-factory name="NettyConnectionFactory">
      <xa>true</xa>
      <connectors>
         <connector-ref connector-name="netty"/>
      </connectors>
      <entries>
         <entry name="/ConnectionFactory"/>
         <entry name="/XAConnectionFactory"/>
      </entries>
   </connection-factory>

   <connection-factory name="NettyThroughputConnectionFactory">
      <xa>true</xa>
       <connectors>
         <connector-ref connector-name="netty-throughput"/>
       </connectors>
        <entries>
            <entry name="/ThroughputConnectionFactory"/>
            <entry name="/XAThroughputConnectionFactory"/>
        </entries>
    </connection-factory>

   <connection-factory name="InVMConnectionFactory">
      <xa>true</xa>
      <connectors>
         <connector-ref connector-name="in-vm"/>
      </connectors>
      <entries>
         <entry name="java:/ConnectionFactory"/>
         <entry name="java:/XAConnectionFactory"/>
      </entries>
   </connection-factory> 
```

我可以轻松发现的本地和 DEV 之间的唯一区别在于 hornetq-configuration.xml。

DEV **hornetq-configuration.xml**（与 hornetq-jms.xml 相同的路径）

```
 <broadcast-groups>
      <broadcast-group name="bg-group1">
         <group-address>${hornetq.broadcast.bg-group1.address:231.7.7.7}</group-address>
         <group-port>${hornetq.broadcast.bg-group1.port:9876}</group-port>
         <broadcast-period>5000</broadcast-period>
         <connector-ref>netty</connector-ref>
      </broadcast-group>
   </broadcast-groups>

   <discovery-groups>
      <discovery-group name="dg-group1">
         <group-address>${hornetq.discovery.dg-group1.address:231.7.7.7}</group-address>
         <group-port>${hornetq.discovery.dg-group1.port:9876}</group-port>
         <refresh-timeout>10000</refresh-timeout>
      </discovery-group>
   </discovery-groups>

   <cluster-connections>
      <cluster-connection name="my-cluster">
         <address>jms</address>  
         <connector-ref>netty</connector-ref>
          <discovery-group-ref discovery-group-name="dg-group1"/>
      </cluster-connection>
   </cluster-connections> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-09-26T17:15:28.160

因此，无论出于何种原因，这都是集群环境中的时间问题。需要连接工厂的 bean 只是被迫等到其他所有东西都启动并运行后再启动。

# stackmob - 如何将 SMValue 解析为字符串数组

> ID：15839642
> 
> 赞同：0
> 
> 时间：2013-04-05T17:10:56.893
> 
> 标签：stackmob

我刚刚熟悉 StackMob 服务器端自定义代码 sdk，我正在尝试获取一个关系字段并以字符串数组的形式遍历它。我怎么做 ？是否可以在不将其解析为数组的情况下对其进行迭代？

```
 DataService ds = serviceProvider.getDataService();
           List<SMCondition> query = new ArrayList<SMCondition>();
           query.add(new SMEquals("product_id", new SMString(jsonObj.getString("product_id"))));
           List<SMObject> results = ds.readObjects("product", query);
           SMObject product= results.get(0); 
           //product.getValue().get("categories"); how do i get this to be a String array? 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-06T17:18:47.373

在最简单的情况下，它看起来像这样：

```
List<SMValue> categories = (List<SMValue>)(rawObj.getValue().get("categories").getValue());
for (SMValue smString : categories) {
    SMString stringValue = (SMString)smString.getValue();
    //do whatever you want with the string value here
} 
```

显然这里有一些未经检查的强制转换，因此您需要根据您的数据和模式将类型/空检查添加到适当的部分。

# awk - 一次设置一个字段？

> ID：15839644
> 
> 赞同：1
> 
> 时间：2013-04-05T17:10:59.867
> 
> 标签：awk, gawk

试图将一些被屠宰的数据变成条形分隔的、未被屠宰的数据......

这是一些示例数据

```
asd1276vdjs12897364vsk Tue Apr  2 08:19:12 2013 [pid 3] [words] FAIL UPLOAD: Client "00.005.006.006", "/0801NSJH.bbf", 0.00Kbyte/sec 
```

进入

```
asd1276vdjs12897364vsk|Tue Apr  2 08:19:12 2013|[pid 3]|[words]|FAIL UPLOAD: Client "00.005.006.006"|"/0801NSJH.bbf"|0.00Kbyte/sec 
```

正则表达式很简单，但我不知道怎么说`first field = regex, second field = regex`等。

这个 sed 是功能性的，但有点 hacky，我想让它在 gawk 中工作。

```
sed 's/ Sun/|Sun/'
sed 's/ Mon/|Mon/'
sed 's/ Tue/|Tue/'
sed 's/ Wed/|Wed/'
sed 's/ Thu/|Thu/'
sed 's/ Fri/|Fri/'
sed 's/ Sat/|Sat/'
sed 's/ Sun/|Sun/'
sed -e 's% \[%|\[%g' -e 's%\] %\]|%g' -e 's%, %|%g' 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-05T17:47:06.830

```
$ cat tst.awk
{ print gensub(/\
([^[:space:]]+)[[:space:]]+\
([^[]+)[[:space:]]+\
([[][^]]+[]])[[:space:]]+\
([[][^]]+[]])[[:space:]]+\
([^,]+),[[:space:]]+\
([^,]+),[[:space:]]+\
/,
"\\1|\\2|\\3|\\4|\\5|\\6|","")
}
$ awk -f tst.awk file
asd1276vdjs12897364vsk|Tue Apr  2 08:19:12 2013|[pid 3]|[words]|FAIL UPLOAD: Client "00.005.006.006"|"/0801NSJH.bbf"|0.00Kbyte/sec 
```

# eclipse - Sublime 文本快速搜索插件

> ID：15839647
> 
> 赞同：0
> 
> 时间：2013-04-05T17:11:19.603
> 
> 标签：eclipse, ide, sublimetext2, sublimetext

在 Eclipse 中，我可以执行 Ctrl + Shift + M 来搜索项目中任何文件中存在的方法，但是 sublime 文本中似乎缺少此功能......是否有任何类型的 Sublime 文本插件可以复制此功能？

我知道有 Ctrl+P 等，但是它只在当前打开的文件中搜索函数，而不是从整个项目中搜索。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-05T17:15:45.747

[这个问题](https://stackoverflow.com/questions/10276340/ide-sublime2-how-to-find-method-definition)也给出了更好的答案。但本质上，从包中获取 sublime 代码 intel，然后当你按`CTRL`+时`R`，你可以跳转到你选择的任何方法。

# jquery - 通过 dataTransfer 传递对象

> ID：15839649
> 
> 赞同：50
> 
> 时间：2013-04-05T17:11:32.820
> 
> 标签：jquery, html, drag-and-drop

我正在尝试找出一种通过 javascript 的 event.dataTransfer 传递本机对象以进行拖放的方法。我正在编写 CMS 的前端编辑器部分，并希望用户能够拖放元素（许多不同类型的元素，从文件到图像到 HTML 片段到几乎任何东西）。这就是为什么我想传递一个真实的对象，所以我可以将数据附加到它以指定为了知道如何呈现它而需要的东西。

一种解决方法是使用 jQuery 的 .data() 将对象附加到页面上的其他内容，然后只需在 setData 中传递选择器字符串……但我并不特别喜欢这种技巧。

这也可以通过 jQuery UI 的可拖放/可拖放来解决（我并不完全反对使用任何库），但由于 dropzone 位于 iframe 中，这实际上是最新 jQuery UI (1.10.2) 中记录的错误）。另外，如果可能的话，我强烈希望在本地进行。这个应用程序中已经有足够的库。

这是问题所在：http: [//jsfiddle.net/AHnh8/](http://jsfiddle.net/AHnh8/)

```
var foo = {foo: "foo", bar: "bar"};

$dragme.on("dragstart", function(e) {
    e.originalEvent.dataTransfer.setData("foo", foo);
});

$dropzone.on("dragenter", function(e) { e.preventDefault(); });
$dropzone.on("dragover", function(e) { e.preventDefault(); });
$dropzone.on("drop", function(e) {
    console.log(e.originalEvent.dataTransfer.getData("foo")); // [Object object]
    console.log(typeof e.originalEvent.dataTransfer.getData("foo")); // string
}); 
```

现在，在阅读了规范之后，我完全理解了为什么会失败。我不明白的是，如何最终实现我想要的。

谢谢

* * *

## 回答 #1

> 赞同：76
> 
> 时间：2013-04-05T17:35:07.373

您应该`JSON.stringify`在使用之前将对象传递给，`setData`因为您只能存储字符串。

```
var j = JSON.stringify(foo);
e.originalEvent.dataTransfer.setData("foo", j); 
```

反过来，您必须将字符串重新转换为对象：

```
var obj = JSON.parse(e.originalEvent.dataTransfer.getData("foo"));
console.log("foo is:", obj); 
```

看到[这个](http://jsfiddle.net/aNErc/2/)工作小提琴

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2015-08-02T16:07:13.453

也许我要提出的建议是错误的（如果是这样，我会很高兴听到为什么）。为什么不在 dragstart 监听器中设置一个变量来引用你所需要的，例如：

```
//global variable
var obj;

//set the global variable to wahtever you wish in the dragstart:
$dragme.on("dragstart", function(e) {
    obj = foo;
    //or even obj = document.getElementById("some element's id");
});

//use this obj in the drop listener.
$dropzone.on("drop", function(e) {
    obj.doWahtEver();
}); 
```

# r - 计算变量或变量组合为 TRUE 的实例数

> ID：15839656
> 
> 赞同：6
> 
> 时间：2013-04-05T17:11:56.370
> 
> 标签：r, for-loop

我是一个热心的 R 新手，需要一些帮助！:)

我有一个看起来像这样的数据框：

```
id<-c(100,200,300,400)
a<-c(1,1,0,1)
b<-c(1,0,1,0)
c<-c(0,0,1,1)

y=data.frame(id=id,a=a,b=b,c=c) 
```

其中*id*是唯一标识符（例如人），而*a*、*b*和*c*是人是否具有此功能的虚拟变量（始终为 1=TRUE）。

我希望 R 创建一个矩阵或数据框，其中我有变量 a、b 和 c 作为列和行的名称。对于矩阵 R 的值，必须计算具有此特征或特征组合的标识符的数量。

例如，ID 100、200 和 400 具有特征 a，然后在矩阵的对角线中 a 和 a 交叉，R 将输入 3。只有 ID 100 具有特征 a 和 b，因此 R 将输入 1，其中 a 和 b交叉等。

生成的数据框必须如下所示：

```
l<-c("","a","b","c")
m<-c("a",3,1,1)
n<-c("b",1,2,1)
o<-c("c",1,1,2)
result<-matrix(c(l,m,n,o),nrow=4,ncol=4) 
```

由于我的数据集有 10 个变量和数百个观察值，我将不得不自动化整个过程。

对你的帮助表示感谢。非常感谢！

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-04-05T17:30:55.573

以 R 为底：

```
crossprod(as.matrix(y[,-1]))
#   a b c
# a 3 1 1
# b 1 2 1
# c 1 1 2 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-05T17:24:55.923

这称为邻接矩阵。您可以使用 qdap 包轻松完成此操作：

```
library(qdap)
adjmat(y[,-1])$adjacency

##   a b c
## a 3 1 1
## b 1 2 1
## c 1 1 2 
```

它会引发警告，因为您正在为其提供数据框。没什么大不了的，可以忽略。还注意到我删除了带有负索引的第一列（ID）`y[, -1]`。

请注意，因为您从布尔矩阵开始，您可以通过以下方式到达那里：

```
Y <- as.matrix(y[,-1])
t(Y) %*% Y 
```

# python - Python程序的初始化

> ID：15839663
> 
> 赞同：1
> 
> 时间：2013-04-05T17:12:19.743
> 
> 标签：python, python-2.7

我有一个 Python 程序，它带有一堆代码，我基本上导入一些模块，初始化一些变量并调用一些函数。这是其中的一部分：

```
import numpy as np
import scipy as sp
import scipy.optimize as opt
import scipy.constants as const
import random
import time

if os.name == 'nt': os.system('cls')
if os.name == 'posix': os.system('clear')
rows, columns = os.popen('stty size', 'r').read().split()

Inclination = math.radians(INCLINATION)
Period = PERIOD*const.day 
```

有没有一种方法可以将所有这些都放入一个单独的模块中并调用它？我试图将所有这些放入一个外部程序并调用它，但据我所知，一切都完成了，但只是在本地，而不是在主代码上。

这个想法是能够在多个程序中使用这个“初始化模块”。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-05T17:15:20.053

您是否尝试将所有这些放入其他 .py 文件中，然后只是`from x import *`? 然后你应该在你调用的任何文件中都有所有这些模块和常量。

**编辑：**如果您担心多次执行所有这些操作，请不要担心。在导入时，Python 会检查一个模块是否已经被加载，然后再次加载该模块。例如说我们有这些文件：

fileA.py => 从初始化程序导入 *
fileB.py => 导入初始化程序
fileC.py => 导入文件A，文件B

当你运行 fileC.py 时，initializer.py 中的代码只运行一次，即使 fileA 和 fileB 都成功加载了它，即使它们以不同的方式加载它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-05T17:16:36.047

你不需要任何特殊的机制。当您导入此模块时，python 会抛出它并初始化所有值，您可以使用它。只需导入它，这就是全部。

# c++ - Xcode C++ 和 Objective-C 重构

> ID：15839664
> 
> 赞同：8
> 
> 时间：2013-04-05T17:12:20.603
> 
> 标签：c++, objective-c, xcode, cocos2d-iphone, box2d

有没有办法在 Xcode 中**重构**混合的 C++/Objective-C 代码？我正在使用 Cocos2D 和 Box2D 编写游戏，而 Box2D 是用 C++ 编写的，所以我编写的每个类都应该有 .mm 扩展名，因此当我尝试重命名变量时，我收到一条消息，例如“ **Xcode 只能重构 C和 Objective-C 代码**”。

提前致谢！

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-04-05T17:19:56.893

Xcode 在重构方面非常有限，即使是普通的 Obj-C。它基本上是重命名，甚至不能在评论中重命名。如果它说它不能做某事，那么它可能不能。

重命名的唯一方法是使用`find & replace`. 请注意，Xcode 可以处理正则表达式，因此它通常已经足够好了。

当然，问题是 find & replace 不了解编程语言，有时会添加一些额外的替换或忘记替换某些东西，因此要格外小心。每次重构后都需要进行干净的构建，以检查所有内容是否正确重命名。

您也可以使用命令行工具（例如`sed`）来实现相同的目的。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-12T23:55:30.880

我在构建的 cocos2d/box2d 游戏中遇到了同样的问题。

**事实 1：** Xcode 4 可以重构 C 和 Objective-C（.m 文件）代码，但不能重构 Objective-C++ 代码（.mm 文件）。

**事实 2：**如果您想与 box2d（用 c++ 编写）进行交互，您需要使用 Objective-C++。

我已经（部分）按照以下步骤解决了这个问题：

1.  我在 Objective-C++ 中为我需要与之交互的 box2d 类创建了一些包装器（例如*MyWorld.mm*是 c++ 类*b2World*的包装器，而*MyBody.mm*是 c++ 类*b2Body*的包装器）。在这里，避免在包装器的 .h 中对 box2d 的任何引用至关重要。
2.  在我项目的所有其他类中，我从未直接引用 box2d 类，而是引用了相关的包装器。当然，我还从这些类中删除了**#import "Box2D.h" 。**
3.  我将项目的所有其他类都转换为普通的 Objective-C (.m)。

结果是现在 Xcode 可以重构我项目的每个类，但当然是包装器。

PS 当然，当您需要在 Objective-C 类中使用包装器（例如 MyWorld）时，您必须导入*MyWorld.h*而不是*MyWorld.mm*。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2014-01-08T12:36:16.677

您可能想在 github 上查看这个项目 - 这是一项正在进行的工作，但仍然：

[https://github.com/lukhnos/refactorial](https://github.com/lukhnos/refactorial)

它是一个基于 Clang 的 C++ 重构工具（即编译器 Xcode 本身所基于的）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-04-22T08:21:08.543

我有某种解决方案 - 将 Objective-C 和 Objective-C++ 代码分开。有一些宏允许检测文件是否在纯 Objective-C 中使用。例子：

[http://philjordan.eu/article/strategies-for-using-c++-in-objective-c-projects](http://philjordan.eu/article/strategies-for-using-c++-in-objective-c-projects)

这个想法是您仍然无法重构 .mm 文件，但您可以重构所有其他代码，即使它包含 Objective-C++ 代码。

# c# - 在 WCF SOAP UserNamePasswordValidator 中确定客户端的 IP 地址

> ID：15839667
> 
> 赞同：2
> 
> 时间：2013-04-05T17:12:43.010
> 
> 标签：c#, wcf, authentication, soap

我们目前正在使用自定义[UserNamePasswordValidator](http://msdn.microsoft.com/en-us/library/system.identitymodel.selectors.usernamepasswordvalidator.aspx)。这允许消费者在 SOAP 标头中指定凭据，如下所示：

```
<o:Security xmlns:o="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" mustUnderstand="1">
<Timestamp Id="_0">
    <Created>
        2013-04-05T16:35:07.341Z</Created>
        <Expires>2013-04-05T16:40:07.341Z</Expires>
    </Timestamp>
    <o:UsernameToken Id="uuid-ac5ffd20-8137-4524-8ea9-3f4f55c0274c-12">
        <o:Username>someusername</o:Username>
        <o:Password o:Type="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-username-token-profile-1.0#PasswordText">somepassword
    </o:Password>
</o:UsernameToken>
</o:Security> 
```

我们需要开始记录客户端的 IP 地址，以及做一些 IP 白名单/黑名单。不幸的是，我看不到在此类中如何检索 IP。在运行时[OperationContext.Current](http://msdn.microsoft.com/en-us/library/system.servicemodel.operationcontext.current.aspx)和[HttpContext.Current](http://msdn.microsoft.com/en-us/library/system.web.httpcontext.current.aspx)属性都为空。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-05T18:47:31.557

您可以打开 ASP.NET 兼容模式，这使您可以访问 HTTPContext 对象。另一种方式是 OperationContext。这有点奇怪，但您可以使用以下代码来获得相同的效果：

```
var client = OperationContext.Current.IncomingMessageProperties[RemoteEndpointMessageProperty.Name] as RemoteEndpointMessageProperty;
Console.WriteLine(client.Address); //This will get the IP Address
Console.WriteLine(client.Port); //This gets the port that the client has open 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-05T19:45:28.147

正确的答案是打开 asp.net 兼容性以获取 http 上下文。很高兴我能帮上忙。

# ruby - NSIS 安装 ruby gems

> ID：15839670
> 
> 赞同：0
> 
> 时间：2013-04-05T17:13:03.343
> 
> 标签：ruby, windows, gem, installation, nsis

这是我在 nsis 脚本中的一个函数：

```
Function rubyDependencies
    DetailPrint "Installing Web Runtime Environment dependencies..."
    ExecWait "gem install rails –v2.3.8"
    ExecWait "gem install rake –v0.8.7"
    ExecWait "gem uninstall rake –v10.0.3"
    ExecWait "rake gems:install"
    DetailPrint "Dependencies installed."
FunctionEnd 
```

我努力了：

```
ExecWait '"gem install rails -v2.3.8" $0' 
```

0 美元上没有显示任何内容，但宝石列表仍然为空。

有什么帮助吗？

谢谢，特尔莫卡多索

编辑：我仍然有问题。我现在正在使用：

```
nsExec::ExecToLog '"$INSTDIR\runtime\ruby\bin\gem.bat" install --ignore-dependencies --no-rdoc --no-ri rails -v=2.3.8' 
```

及其生成：

```
could not find a valid gem '-v=2.3.8' 
```

并安装最新的。很明显，它在参数中传递了一些奇怪的东西。当我在安装程序之外运行命令时，它按预期工作。

有什么帮助吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-05T17:29:45.913

正确的语法是`ExecWait '"c:\full\path\to\program.exe" param1 "space param" param3' $0`. 为了`ExecWait '"gem" ...'`工作，gem.exe 需要位于[CreateProcess](http://msdn.microsoft.com/en-us/library/windows/desktop/ms682425%28v=vs.85%29.aspx)搜索的路径中......

# web-services - 禁用证书验证

> ID：15839674
> 
> 赞同：4
> 
> 时间：2013-04-05T17:13:12.473
> 
> 标签：web-services, delphi, delphi-xe2, x509certificate

我需要使用 WCF，但它有一个证书，我需要禁用它的身份验证。有谁知道我怎么能在 Delphi XE2 中做到这一点？

我已经尝试过以下代码：

第一次尝试 ：

`Rio.HTTPWebNode.InvokeOptions:= [soIgnoreInvalidCerts,soAutoCheckAccessPointViaUDDI];`

Rio 是 THTTPRIO。

第二次尝试：

```
 class procedure ClasseTeste.OnBeforePost(const HTTPReqResp: THTTPReqResp;
      Data: Pointer);
    var
      SecurityFlags: DWord;
      SecurityFlagsLen: DWord;
      Request: HINTERNET;
      begin
      Request := Data;
      if soIgnoreInvalidCerts in Rio.HTTPWebNode.InvokeOptions then
      begin
        SecurityFlagsLen := SizeOf(SecurityFlags);
        InternetQueryOption(Request, INTERNET_OPTION_SECURITY_FLAGS,
        Pointer(@SecurityFlags), SecurityFlagsLen);
        SecurityFlags := SecurityFlags or INTERNET_FLAG_IGNORE_CERT_CN_INVALID;
        InternetSetOption(Request, INTERNET_OPTION_SECURITY_FLAGS,
        Pointer(@SecurityFlags), SecurityFlagsLen);
      end;
    end;

rio.HTTPWebNode.OnBeforePost:= ClasseTeste.OnBeforePost; 
```

我可以使用 c# 执行此操作，代码如下：

```
channel = new ChannelFactory<WsMain.IWsInterface>("****");
                channel.Credentials.UserName.UserName = "*****";
                channel.Credentials.UserName.Password = "*****";
                channel.Credentials.ServiceCertificate.Authentication.CertificateValidationMode = System.ServiceModel.Security.X509CertificateValidationMode.None; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2015-07-10T06:41:43.230

在您的请求后添加以下行：

```
 SecurityFlags := SecurityFlags or SECURITY_FLAG_IGNORE_REVOCATION;
  InternetSetOption(Request, INTERNET_OPTION_SECURITY_FLAGS, Pointer(@SecurityFlags), SecurityFlagsLen); 
```

哪个会做：

```
procedure TForm1.RIO_OnBeforePost(const HTTPReqResp: THTTPReqResp; Data: Pointer);
  var
   SecurityFlags: DWord;
   SecurityFlagsLen: DWord;
   Request: HINTERNET;

begin
  Request := Data;

  SecurityFlagsLen := SizeOf(SecurityFlags);
  InternetQueryOption(Request, INTERNET_OPTION_SECURITY_FLAGS, Pointer(@SecurityFlags), SecurityFlagsLen);

  SecurityFlags := SecurityFlags or SECURITY_FLAG_IGNORE_UNKNOWN_CA;
  InternetSetOption(Request, INTERNET_OPTION_SECURITY_FLAGS, Pointer(@SecurityFlags), SecurityFlagsLen);

  // It solved my problem
  SecurityFlags := SecurityFlags or SECURITY_FLAG_IGNORE_REVOCATION;
  InternetSetOption(Request, INTERNET_OPTION_SECURITY_FLAGS, Pointer(@SecurityFlags), SecurityFlagsLen);

end; 
```

# java - Java 使用 .jar 文件中的图像

> ID：15839683
> 
> 赞同：0
> 
> 时间：2013-04-05T17:13:57.097
> 
> 标签：java, bufferedimage, javax.imageio

我知道以前有人问过这样的问题，但是我已经查看并尝试了很多答案，但没有一个有效。我正在尝试在 .jar 文件中使用图像。图像存储在目录 /world/maps/map1.jpg 中。

```
 BufferedImage bigImg;
            try
            {
                bigImg = ImageIO.read(getClass().getResourceAsStream("/world/maps/" + name + ".jpg"));
            }
            catch(Exception e)
            {
                System.out.println(e + ": is the error");
                bigImg = null;
            } 
```

谢谢您的帮助。

忘了说清楚，但类文件与图像在同一目录中

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-05T17:20:42.730

如果你的目录树是这样的：

```
SomeClass.class
world
|--maps
   |--image.jpg 
```

您可以使用一些参考，例如：

```
SomeClass.class.getResource("./world/maps/image.jpg") 
```

如果该类在另一个目录中，只需添加`../`到路径中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-05T17:28:31.820

被调用的类`getClass()`必须驻留在同一个 jar 中。并且路径必须区分大小写。你确定`name`是`"image"`吗？

# backbone.js - 在每次更改时保存模型，除了第一次初始提取

> ID：15839695
> 
> 赞同：0
> 
> 时间：2013-04-05T17:14:33.640
> 
> 标签：backbone.js

我确定这是一个非常常见且基本的 Backbone 问题，但我找不到答案

我想在每次更改后保存一个模型，*除了*从服务器的初始获取。

例如：

```
 MyModel = Backbone.Model.extend({
    url: "myModelUrl",
    initialize: function () {
      this.on("change", this.save, this);
    }
  }); 
```

获取时，由于它有一些数据，我得到一个更改事件，然后再次触发保存

```
 var myModel = new MyModel({id:"123"}); 
 myModel.fetch(); 
```

有没有办法避免第一次提取时的第一次保存？（例如，如果模型是刚刚获取的，不要保存）

难道唯一的方法是[引导模型](http://backbonejs.org/#FAQ-bootstrap)吗？

例如，根据文档，这真的是唯一的方法吗？

> 请注意，不应在页面加载时使用 fetch 来填充集合——加载时所需的所有模型都应该已经引导到位。fetch 旨在为不需要立即需要的接口延迟加载模型：例如，具有可以切换打开和关闭的注释集合的文档。

**编辑：**

我在引导程序中看到的一个问题是 - 似乎我必须在页面加载时获取我的整个集合，我不能只获取其中的一小部分。为什么？因为如果我的路由使用哈希标记，则在页面刷新时，服务器端将不知道我在哪个路由中（哈希部分不会发送到服务器）。例如，只有当我使用 pushState: true 我才能在页面刷新时引导正确的模型/集合，我是否遗漏了什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-05T18:57:13.573

`sync`是获取模型时触发的事件。只听`sync`一次。稍后再听`change`模型上的事件。

```
var self;     
this.listenToOnce(model,'sync', function(){
   self.listenTo(model,'change',self.changeHandler);
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-05T17:40:14.477

不太明白你的要求。但是如果你只是想避免第一次保存，你可以手动设置一个属性

```
isFirstSave = true 
```

并使您的绑定方法像这样

```
onModelChange: =>
  if @isFirstSave
    @isFirstSave = false
  else
    @save() 
```

丑陋但有效..

# hadoop - Hadoop 不适合跨多个站点的分布式处理？

> ID：15839696
> 
> 赞同：2
> 
> 时间：2013-04-05T17:14:37.850
> 
> 标签：hadoop, distributed-computing, grid-computing

我读过几篇文章，暗示 Hadoop 仅设计用于在单个物理位置的集群上工作，而不是用于许多广泛分布的节点（例如，在 Internet 上从多个站点运行分布式集群）。

有没有人有任何尝试跨多个站点使用 Hadoop 的真实经验？我会遇到什么样的问题？还是我最好只使用不同的框架（例如 BOINC）。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-05T17:26:14.107

如果在一组相对本地的节点上执行与在一组广泛分布的节点上执行之间有任何区别，那将是在节点之间来回移动大量数据所需的时间增加。如果您遇到涉及处理、聚合和连接大量数据的问题，那么您必然会在节点之间发送大量数据。这意味着无论您选择什么平台（hadoop、storm 等），您都必须处理这个问题。BOINC 或其他一些基于志愿者的系统可能更便宜，但您的实施仍然会受到高额数据传输成本的影响。此外，您可能会在混合中引入节点异构性，这将使您的实现在开发和调试方面更加有趣。

顺便说一句，hadoop 和 BOINC 是两种截然不同的动物，它们解决了截然不同的问题。

# string - 如何比较不同工作簿中的两个字符串（Excel VBA）

> ID：15839697
> 
> 赞同：0
> 
> 时间：2013-04-05T17:14:44.803
> 
> 标签：string, excel, vba, compare

为简单起见：我需要将`userID`一个 Excel 工作簿中的数字匹配到另一个。这个想法是查看两个文档中较大的一个是否具有`userID`较小文档中的这个数字。如果较大的文档有`userID`数字，则需要将其他数据复制到较小的文档中（我知道该怎么做）

我的问题是，当我比较每个字段时，我的函数一直将我的 searchString（较大文档中的字符串）显示为空白。它不会像我在较小文档中创建的那样拾取我创建的数组。代码会比我解释得更好。我不是程序员，也不是真正了解 VBA，所以我已经知道我的代码低于标准。

每当我测试我的代码时，我都会让 MsgBox 函数向我显示它正在比较的字符串，由于某种原因，“searchString”总是显示为空白，因此它将包含所需数据的“findString”与空白进行比较出于任何原因的字符串。我需要 MsgBox 函数来显示另一个文档中的数组数据，而不仅仅是一个空白框。

```
'NID Comparisson Script

Sub getUID()

'Select Appropriate cell
Range("C2").Select

'Count the number of rows that contain data in the SCCM document.
Dim rows As Integer
rows = ActiveSheet.UsedRange.rows.count

'Create Array
With Sheets("SMSReportResults(2)")
    arrData = .Range(.Cells(2, 3), .Cells(rows, 3)).Value
End With

'Declare a variable for comparing UID/NID strings
Dim findString As String

'Loop through the document and grab the UID numbers as "searchString"
For i = 1 To rows - 1
    findString = arrData(i, 1)
    Windows("NIDs.xlsx").Activate
    Dim rows2 As Integer
    rows2 = ActiveSheet.UsedRange.rows.count

    'Create second array in the NIDs Workbook
    With Sheets("Sheet1")
        arrData2 = .Range(.Cells(2, 1), .Cells(rows, 1)).Value
    End With

    'Create searchString for NIDs workbook
    Dim searchString As String

    For j = 1 To rows2 - 1
        searchString = arrData2(j, 1)

        Dim compare As Integer
        compare = StrComp(searchString, findString)
        MsgBox (seachString)
        MsgBox (findString)
        MsgBox (compare)
        ActiveCell.Offset(1, 0).Select

    Next
Next

End Sub 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-05T21:10:57.287

转到模块顶部并键入“Option Explicit”。您在“MsgBox (seachString)”中拼错了 searchString，因此创建了一个新变量。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-05T22:08:00.577

可能有一种更有效的方法来执行此操作，使用嵌套循环，但这基本上是我认为您需要做的：

```
Dim rows        As Integer
Dim arrData     As Variant
Dim arrData2    As Variant

rows = ThisWorkbook.ActiveSheet.UsedRange.rows.Count

With Sheets("SMSReportResults(2)")
    arrData = .Range(.Cells(2, 3), .Cells(rows, 3)).Value
End With

On Error Resume Next
    Windows("NIDs.xlsx").Activate
On Error GoTo 0

With Workbooks("NIDS.xlsx").Sheets("Sheet1")
    arrData2 = .Range(.Cells(2, 1), .Cells(rows, 1)).Value
End With

For R1 = 1 To UBound(arrData, 1)
    For C1 = 1 To UBound(arrData, 2)
        For R2 = 1 To UBound(arrData2, 1)
            For C2 = 1 To UBound(arrData2, 2)
                If arrData(R1, C1) = arrData2(R2, C2) Then

                    'Returns the value from the next column in NIDS
                    MsgBox Workbooks("NIDS.xlsx").Sheets("Sheet1").Cells(R2, C2 + 1)

                End If
            Next C2
        Next R2
    Next C1
Next R1 
```

# facebook - 我的 WebApp（使用 facebook 登录）将我注销

> ID：15839713
> 
> 赞同：0
> 
> 时间：2013-04-05T17:15:47.207
> 
> 标签：facebook

我在我的网站上使用 facebook 登录

```
window.fbAsyncInit = function() {

    // init the FB JS SDK
    FB.init({
      appId      : 'XXX', // App ID from the App Dashboard
      channelUrl : 'XXX/channel.php', // Channel File for x-domain communication
      cookie     : true, // set sessions cookies to allow your server to access the session?
      frictionlessRequests: true
    });

}; 
```

问题是，我每隔约 10-20 分钟就会在我的网站上登出。该网站比重新加载，我再次登录。我认为cookie会以某种方式被删除。

有没有办法让那个 cookie 存在更长时间？

我的登录看起来像这样：

```
FB.login(function(response) {}, {scope:'publish_actions'}); 
```

**更新：**

当用户第一次登录时，我的脚本的这一部分被调用：

```
// triggers on first login
if (isset($_GET['first_login'])) {
    if ($me) {
        $facebook->setExtendedAccessToken();
        $friends = $facebook->api('/me/friends');
        $friends = $friends['data'];
        if (!empty($friends)) {
            // sql

        }
        $permissions = $facebook->api("/me/permissions");

        if( array_key_exists('publish_actions', $permissions['data'][0]) ) {
            $attachment = array(
                    'message' => 'XXX',
                    'name' => 'XXX - App',
                    'link' => 'XXX',
                    'description' => 'XXX',
                    'picture'=> 'XXX',
                    'access_token' =>  $facebook->getAccessToken()
            );
            $facebook->api('/'.$facebook->getUser().'/feed', 'POST', $attachment);

            // sql
        }
        header('Location: http:/xxx');
    }
} 
```

但我得到一个错误

> 致命错误：未捕获的 OAuthException：(#1) 创建在第 1254 行的 /facebook/base_facebook.php 中抛出的共享时发生错误

这是由`$facebook->api('/'.$facebook->getUser().'/feed', 'POST', $attachment);`

当我`link`从我的 -attribute中删除时`$attachment`，它可以工作。是链接属性被禁止还是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-12T14:33:35.667

您应该考虑扩展 facebook 访问令牌

[https://developers.facebook.com/docs/howtos/login/extending-tokens/](https://developers.facebook.com/docs/howtos/login/extending-tokens/)

但是，这使用了应用程序机密，因此不应该用 javascript 来完成，而应该用服务器端语言来完成（可能通过将您的代码与 php-sdk 结合起来）

# sql - 具有连接列的 SQL CASE

> ID：15839715
> 
> 赞同：0
> 
> 时间：2013-04-05T17:15:50.150
> 
> 标签：sql, oracle, case

我试图在来自不同列的数据串联中找到一个子字符串，并根据结果返回一个值。我试过这个查询：

```
SELECT
    V_CMR_1.*, 
    T_RICEVITORI.*, 
    CASE 
        WHEN contains(V_CMR_1.SP1C || ' ' || V_CMR_1.SP2C || ' ' || V_CMR_1.SP3C || ' ' || V_CMR_1.SP4C || ' ' || V_CMR_1.SP5C, 'GIALLA') > 0 THEN 'GELBE'
        WHEN contains(V_CMR_1.SP1C || ' ' || V_CMR_1.SP2C || ' ' || V_CMR_1.SP3C || ' ' || V_CMR_1.SP4C || ' ' || V_CMR_1.SP5C, 'ROSSA') > 0 THEN 'ROTE'
        END AS SORTE
FROM 
    MAGAZZINO.V_CMR_1, 
    MAGAZZINO.T_RICEVITORI
WHERE
    V_CMR_1.ID_RICEVITORE=T_RICEVITORI.ID_RICEVITORE 
    AND V_CMR_1.ID_USCITA=:IDUSCITA 
    AND V_CMR_1.ID_POSIZIONE LIKE :ANNO 
```

但是我遇到了奇怪的 oracle 错误（通信通道上的文件结尾）。它会起作用吗？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-05T17:31:17.067

尝试`instr`功能而不是`contains`

```
SELECT V_CMR_1.*, 
       T_RICEVITORI.*, 
       CASE WHEN instr(V_CMR_1.SP1C || ' ' || V_CMR_1.SP2C || ' ' || V_CMR_1.SP3C || ' ' || V_CMR_1.SP4C || ' ' || V_CMR_1.SP5C, 'GIALLA') > 0 THEN 'GELBE'
            WHEN instr(V_CMR_1.SP1C || ' ' || V_CMR_1.SP2C || ' ' || V_CMR_1.SP3C || ' ' || V_CMR_1.SP4C || ' ' || V_CMR_1.SP5C, 'ROSSA') > 0 THEN 'ROTE'
       END AS SORTE
FROM MAGAZZINO.V_CMR_1, MAGAZZINO.T_RICEVITORI
WHERE V_CMR_1.ID_RICEVITORE=T_RICEVITORI.ID_RICEVITORE 
AND V_CMR_1.ID_USCITA=:IDUSCITA AND V_CMR_1.ID_POSIZIONE LIKE :ANNO 
```

# python - 将 HTTP/1.1 与 SimpleHTTPRequestHandler 一起使用

> ID：15839718
> 
> 赞同：4
> 
> 时间：2013-04-05T17:16:04.797
> 
> 标签：python, http, http-1.1

当我将 HTTP/1.1 与 SimpleHTTPRequestHandler 一起使用时，加载一个拉入其他资源的页面将在第二个资源之后挂起。

这是一个小型复制器：

```
from SimpleHTTPServer import SimpleHTTPRequestHandler
from BaseHTTPServer import HTTPServer

class MyRequestHandler(SimpleHTTPRequestHandler):
    #protocol_version = "HTTP/1.0"   # works
    protocol_version = "HTTP/1.1"   # hangs

server = HTTPServer(("localhost", 7080), MyRequestHandler)
server.serve_forever() 
```

使用上述服务器，当浏览器尝试加载时，以下 HTML 将挂起`b.png`：

```
<html>
    <body>
        <img src="a.png">
        <img src="b.png">
    </body>
</html> 
```

HTTP/1.1 可以与 SimpleHTTPServer 模块一起使用吗？如果可以，如何使用？请注意，将 ForkingMixIn 或 ThreadingMixIn 添加到服务器将允许事情进行，但是，似乎没有这些 mixin 中的任何一个都应该是可能的。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-04-14T18:14:19.823

您看到的行为是由于三个原因：

*   `BaseHTTPServer.HTTPServer`默认情况下一次只能处理一个请求
*   大多数用户代理（浏览器）一次打开多个到任何给定主机的连接
*   大多数用户代理使用`keep-alive`HTTP 1.1 的特性，并且在收到请求的实体后不会立即关闭连接

您看到的是，浏览器能够使用它打开到服务器的**第一个**连接来获取所有请求的[实体。](http://www.w3.org/Protocols/rfc2616/rfc2616-sec7.html#sec7)这是页面本身，也可能是它的一些资源。同时浏览器打开额外的连接来获取剩余的资源，但这些连接无法继续，因为服务器与第一个连接。服务器与第一个绑定的原因是，尽管浏览器已经接收到使用此连接请求的实体，但它不会立即关闭它，以防它可以在不久的将来被重用以获取更多实体（服务器不会关闭连接它的一方要么作为浏览器指定版本 1.1 的 HTTP 并发送**`Connection: keep-alive`标题）。只有在第一个连接超时后，服务器才开始处理下一个等待连接，因此正在下载额外的资源（所有这些都是使用此特定连接请求的）。如果您等待足够长的时间，浏览器会设法获取所有资源。`network.http.max-persistent-connections-per-server`当您在 Firefox 中将首选项设置为 1（而不是默认值 6）或在其他浏览器中设置类似时，您可以观察到差异。然后，由于使用相同的连接请求所有资源，因此一旦检索到前一个，就会立即开始检索每个资源，而不会有任何延迟。**

 **我要感谢freenode.net 上*#python* IRC 频道的 marienz 对这个问题的帮助。**

# c# - 如何在 .NET C# WinService 中使用 COM 服务器（ATL、DLL 代理）？

> ID：15839719
> 
> 赞同：2
> 
> 时间：2013-04-05T17:16:05.770
> 
> 标签：c#, delphi, com, interop, com-interop

我有一个 DLL Com 服务器，实际上只由一个旧的 Delphi exe 应用程序使用。

COM Server 是多年前（不是我）用 C++ ATL 编写的。它实现回调（事件 - 是否相同？） - 使用传出接口`IConnectionPointImpl`。类工厂是单例的（标有`DECLARE_CLASSFACTORY_SINGLETON`）

现在要求这个 COM 服务器必须在多个客户端之间共享：Delphi 和 C#（.NET 2.0，VS2008）。我把它说成`DllSurrogate`现在我可以从多个 Delphi 客户端使用它，使用继承自的类`TOleServer`，覆盖`GetServer`始终使用的方法`CoCreateInstance`（因为`GetActiveObject`通常会失败）并且它正在工作。

现在我需要从 C# WinService 使用它，我不知道从哪里开始。我编写了一个使用 WinApi 的小 C# Hello-world，`CoCreateInstance`并且`DllImport("ole32.dll")`- 我能够从 COM 服务器连接到现有实例，但无法订阅事件。

这是VS导入的DLL META-DATA： ![在此处输入图像描述](https://i.stack.imgur.com/jFQnL.png)

我不知道这是否是正确的方法。这是aproximative代码：

```
using System;
using System.Collections.Generic;
using System.Text;
using SWLMLib;
using System.Runtime.InteropServices;
using System.Runtime.InteropServices.ComTypes;

namespace TestSWLM
{
    [Flags]
    enum CLSCTX : uint
    {
        //... defines here CLSCTX
    }

    class Program
    {
        [DllImport("ole32.dll", EntryPoint = "CoCreateInstance", CallingConvention = CallingConvention.StdCall)]
        static extern UInt32 CoCreateInstance([In, MarshalAs(UnmanagedType.LPStruct)] Guid rclsid,
           IntPtr pUnkOuter, UInt32 dwClsContext, [In, MarshalAs(UnmanagedType.LPStruct)] Guid riid,
           [MarshalAs(UnmanagedType.IUnknown)] out object rReturnedComObject);

        public static void AboutExpireHandler(IFeature pFeature, int HoursRemained)
        {
            Console.WriteLine("AboutExpireHandler, pFeature = {0}", pFeature.Code);        
        }

        static void Main(string[] args)
        {
            try
            {
                SWLMLib.ISWMgr lintfSWLMgr = null;

                object instance = null;
                UInt32 dwRes = CoCreateInstance(new Guid("8EAAFAD7-73F8-403B-A53B-4400E16D8EDF"), IntPtr.Zero, (uint)CLSCTX.CLSCTX_LOCAL_SERVER,
                    new Guid("00000000-0000-0000-C000-000000000046"), out instance);
                SWLMLib.SWMgrClass lSWLMgr = null;
                unsafe
                {
                    lintfSWLMgr = (instance as SWLMLib.ISWMgr);
                    Type liType = instance.GetType();
                }

                if (lintfSWLMgr != null)
                {
                    IntPtr iuknw = Marshal.GetIUnknownForObject(lintfSWLMgr);

                    IntPtr ipointer = IntPtr.Zero;
                    Guid lICPCGuid = typeof(IConnectionPointContainer).GUID;
                    Guid lICPGuid = typeof(IConnectionPoint).GUID;
                    Guid lIEv = new Guid("{C13A9D38-4BB0-465B-BF4A-487F371A5538}");
                    IConnectionPoint lCP = null;
                    IConnectionPointContainer lCPC = null;
                    Int32 r = Marshal.QueryInterface(iuknw, ref lICPCGuid, out ipointer);
                    lCPC = (IConnectionPointContainer)Marshal.GetObjectForIUnknown(ipointer);
                    lCPC.FindConnectionPoint(ref lIEv, out lCP);
                    Int32 outID;
                    lCP.Advise(???, out outID); // HERE I don't know what to do further
                    lIEvEv.FeatureAboutToExpire += AboutExpireHandler;
                }
            }
            catch (Exception E)
            {
                Console.WriteLine(E.Message);
                throw;
            }

            Console.ReadLine();
        }
    }
} 
```

欢迎任何建议、链接和诀窍。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-09T12:19:53.720

看来我成功地连接到并处理了 DLL (in-proc) Com Server 的事件。

1.  我将 COM 服务器作为 DLL 代理（[此处为 HowTo](http://msdn.microsoft.com/en-us/library/windows/desktop/ms686606%28v=vs.85%29.aspx)）。
2.  Delphi 客户端 - 形成我的 COM 包装类，继承自 TOleServer 类，我重写了 GetServer 方法：

`function TSWMgr.GetServer: IUnknown; begin OleCheck(CoCreateInstance(ServerData^.ClassId, nil, CLSCTX_LOCAL_SERVER, IUnknown, Result)); end;`

1.  [C#（Hello-World Client）端（在咨询了一些类似这样](http://www.codeproject.com/Articles/37127/Internet-Explorer-Late-Binding-Automation)的 HowTos 之后）：

//使用SWLMLib；//使用 System.Runtime.InteropServices; //使用 System.Runtime.InteropServices.ComTypes;

```
[Flags]
enum ReturnCode : uint
{
    S_OK = 0, S_FALSE = 1, REGDB_E_CLASSNOTREG = 0x80040154, CLASS_E_NOAGGREGATION = 0x80040110, E_NOINTERFACE = 0x80004002, E_POINTER = 0x80004003
}

[Flags]
enum CLSCTX : uint
{
    CLSCTX_INPROC_SERVER = 0x1, CLSCTX_INPROC_HANDLER = 0x2, CLSCTX_LOCAL_SERVER = 0x4,
    //... //others
    CLSCTX_ALL = CLSCTX_SERVER | CLSCTX_INPROC_HANDLER
}

/// <summary>
/// Sink Class implementig COM Server outgoing interface SWLMLib.ISWMgrEvents 
/// </summary>
[ClassInterface(ClassInterfaceType.None)]
class MySink : SWLMLib.ISWMgrEvents
{
    public void FeatureAboutToExpire(SWLMLib.IFeature pFeature, int HoursRemained)
    {
        Console.WriteLine("{0} FeatureAboutToExpire: Feature {1} Hours={2}", DateTime.Now, pFeature.Code, HoursRemained);
        Marshal.ReleaseComObject(pFeature); //WTF??? Without this line COM Server object is not released!
    }

    public void FeatureExpired(SWLMLib.IFeature pFeature)
    {
        Console.WriteLine("FeatureExpired: Feature {0}", pFeature.Code);
        Marshal.ReleaseComObject(pFeature); //Without this line COM Server object is not released!
    }
}

class Program
{
    //Import "CoCreateInstance" to play with run context of created COM-object (3rd parameter)
    [DllImport("ole32.dll", EntryPoint = "CoCreateInstance", CallingConvention = CallingConvention.StdCall)]
    static extern UInt32 CoCreateInstance([In, MarshalAs(UnmanagedType.LPStruct)] Guid rclsid,
       IntPtr pUnkOuter, UInt32 dwClsContext, [In, MarshalAs(UnmanagedType.LPStruct)] Guid riid,
       [MarshalAs(UnmanagedType.IUnknown)] out object rReturnedComObject);

    static void Main(string[] args)
    {
        try
        {
            Guid SWMgrClassObjectGuid = typeof(SWLMLib.SWMgrClass).GUID;    //{8EAAFAD7-73F8-403B-A53B-4400E16D8EDF}
            Guid IUnknownGuid = new Guid("00000000-0000-0000-C000-000000000046"); //Can it be written in more pretty style?

            SWLMLib.ISWMgr lintfSWLMgr = null;

            /* This will create IN-PROC Server because, it seems CoCreateInstance will be invoked with CLSCTX_INPROC_SERVER flag settled
            Type type = Type.GetTypeFromCLSID(SWMgrClassObjectGuid), true);
            object instance0 = Activator.CreateInstance(type);
            lintfSWLMgr = (instance0 as SWLMLib.ISWMgr); */

            Guid Ev1 = typeof(ISWMgrEvents).GUID;
            object instance = null;

            unsafe
            {
                UInt32 dwRes = CoCreateInstance(SWMgrClassObjectGuid,
                                                IntPtr.Zero,
                                                (uint)(CLSCTX.CLSCTX_LOCAL_SERVER), //if OR with CLSCTX_INPROC_SERVER then INPROC Server will be created, because of DLL COM Server
                                                IUnknownGuid,
                                                out instance);
                if (dwRes != 0)
                {
                    int iError = Marshal.GetLastWin32Error();
                    Console.WriteLine("CoCreateInstance Error = {0}, LastWin32Error = {1}", dwRes, iError);
                    return;
                }
                lintfSWLMgr = (instance as SWLMLib.ISWMgr);
            }

            if (lintfSWLMgr != null)
            {
                //lintfSWLMgr.InitializeMethod(...); //Initialize object

                //Find Connection Point for Events
                Guid ISWMgrEventsGuid = typeof(SWLMLib.ISWMgrEvents).GUID;      //{C13A9D38-4BB0-465B-BF4A-487F371A5538} Interface for Evenets Handling
                IConnectionPoint lCP = null;
                IConnectionPointContainer lCPC = (instance as IConnectionPointContainer);
                lCPC.FindConnectionPoint(ref ISWMgrEventsGuid, out lCP);

                MySink lSink = new MySink();
                Int32 dwEventsCookie;
                lCP.Advise(lSink, out dwEventsCookie);
                Console.WriteLine("Waiting for Events Handling...");
                Console.WriteLine("Press ENTER to Exit...");

                Console.ReadLine(); // Until Eneter is not hit, the events arrive properly
                //Here starting to Unsubscribe for Events and Com Objects CleanUP
                lCP.Unadvise(dwEventsCookie);
                Marshal.ReleaseComObject(lCP); 
                Marshal.ReleaseComObject(lintfSWLMgr); 
            }

        }
        catch (Exception E)
        {
            Console.WriteLine(E.Message);
            throw;
        }
    }
} 
```

也许这不是最好的方式（如 TblImp.exe 和/或 COM Wrappers），但这种原始方式有效。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-05T17:38:09.427

我想你会想要编写如下代码：

```
Type type = Type.GetTypeFromCLSID(coClassGuid, true);
object instance = Activator.CreateInstance(type); 
```

您可以认为这类似于`CoCreateInstance`.

C# COM Interop 的做法`QueryInterface`是进行强制转换或使用`as`关键字：

```
IComInterface comInterface = instance as IComInterface; 
```

这将避免您必须直接使用 COM API。

我绝不是 COM 互操作专家，我只需要对它做一些工作，所以我希望这对您有所帮助。

# awk - awk OR 语句

> ID：15839723
> 
> 赞同：44
> 
> 时间：2013-04-05T17:16:09.710
> 
> 标签：awk

awk 是否有一个`OR`声明，*即*给出以下代码段：

```
awk '{if ($2=="abc") print "blah"}' 
```

是否可以添加一个`OR`语句以便 if `$2==abc OR def -> print`？

* * *

## 回答 #1

> 赞同：63
> 
> 时间：2013-04-05T17:22:33.137

是的。您可以使用逻辑 OR `||`：

```
awk '{if ($2=="abc" || $2=="def") print "blah" }' 
```

* * *

## 回答 #2

> 赞同：48
> 
> 时间：2013-04-05T17:30:48.090

您不会在 awk 中编写此代码：

```
awk '{if ($2=="abc") print "blah"}' 
```

你可以这样写：

```
awk '$2=="abc" {print "blah"}' 
```

并添加“或”将是这些中的任何一个，具体取决于您最终要做什么：

```
awk '$2~/^(abc|def)$/ {print "blah"}'

awk '$2=="abc" || $2=="def" {print "blah"}'

awk '
BEGIN{ split("abc def",tmp); for (i in tmp) targets[tmp[i]] }
$2 in targets {print "blah"}
' 
```

如果您有多个要匹配的字符串，那么最后一个将是最合适的。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-04-05T17:23:48.720

```
awk '{if ($2=="abc" || $2=="def") print "blah"}' 
```

# javascript - 更改谷歌地图上的可拖动标记光标

> ID：15839733
> 
> 赞同：0
> 
> 时间：2013-04-05T17:16:48.413
> 
> 标签：javascript, google-maps

在创建新市场时，我使用'cursor' 参数在该市场上设置光标类型，但如果可拖动参数设置为 true，我将无法更改光标。它始终是“指针”。这是我的代码：

```
var marker = new google.maps.Marker({
                map:map,
                draggable:true,
                animation: google.maps.Animation.DROP,
                position: center,
                cursor: 'move'
            }); 
```

因此，如果`draggable`未将 设置为`true`标记的光标 is`'move'`但如果为真，则变为`'pointer'`. 有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-06T02:06:35.120

这是一个已经存在一段时间的错误[https://code.google.com/p/gmaps-api-issues/issues/detail?id=3120](https://code.google.com/p/gmaps-api-issues/issues/detail?id=3120)

# c# - 有没有办法从库中读取命令行参数？

> ID：15839734
> 
> 赞同：0
> 
> 时间：2013-04-05T17:16:55.783
> 
> 标签：c#, .net

我想`string[] args`在一个库中从主 exe 向下几层获得等价物。有没有办法做到这一点？我没有看到任何明显的东西。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-05T17:18:24.210

用这个：

```
string[] args = Environment.GetCommandLineArgs(); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-05T17:19:59.230

```
Environment.GetCommandLineArgs() 
```

# javascript - div 不会在图像悬停时显示

> ID：15839742
> 
> 赞同：1
> 
> 时间：2013-04-05T17:17:30.037
> 
> 标签：javascript, jquery, popup, tooltip

无法弄清楚为什么我的 div 不会在此悬停时显示任何帮助表示赞赏。

```
$('a[rel=tooltipimage]').bind('mouseover',function(e){
e=e?e:window.event;
$('#tooltip').css({
position:'absolute',
top:e.pageY,
left:e.pageX
});
}) 
```

HTML：

```
</span>
<a href="#" class="tooltipimage"><img src="/applications/images/icons/info_icon.gif"/></a>
</span> 
<div class="tooltip" style="margin:0 0 0 18px; display:none;">
<b>tooltip text goes here</b><br />                                                                 
 </div> 
```

我要做的就是在鼠标悬停时显示浮动在图像旁边的 div，并在它们离开时消失。我已经安装了 jquery 和所有东西，但是当我只需要最简单的工具提示时，我不想放入一堆插件和东西。如果我不在经典的 asp 中，我可以使用 modalpopup 但不幸的是没有运气。

在此先感谢，尼克

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-05T17:19:12.970

你的代码需要是这样的

```
$('a.tooltipimage').bind('mouseover',function(e){
e=e?e:window.event;
$('.tooltip').css({
position:'absolute',
top:e.pageY,
left:e.pageX
});
}) 
```

由于工具提示是一个类而不是一个 ID

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-05T17:20:31.670

你的选择器是错误的。它应该是

```
$('a.tooltipimage').bind('mouseover',function(e){
    e = e ? e : window.event;
    $('.tooltip').css({
        position:'absolute',
        top:e.pageY,
        left:e.pageX,
        display: 'block'
    });
}); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-05T17:21:28.117

您的代码有几个错误。试试这个：

```
$('a.tooltipimage').hover(function (e) {
    e = e ? e : window.event;
    $('.tooltip').show().css({
        position: 'absolute',
        top: e.pageY,
        left: e.pageX
    })
}, function () {
    $('.tooltip').hide()
}); 
```

**[jsFiddle 示例](http://jsfiddle.net/j08691/ZBUB9/1)**

*   您正在选择`a[rel=tooltipimage]`哪个不存在，但`a.tooltipimage`确实存在。
*   您还选择`#tooltip`了哪些不存在，但`.tooltip`确实存在。
*   `.bind()``.on()`自 1.7起已弃用，取而代之的是
*   您的开始跨度标签不正确，但我想这只是一个错字。
*   由于您也想隐藏工具提示，因此我曾经`.hover()`在 mouseleave 上隐藏工具提示。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-04-05T17:22:07.810

您的 a 标签没有属性 rel 等于*tooltipimage*。但是它有一个名为 tooltipimage 的类。此外，您隐藏了工具提示，但再也没有显示它。

以下应该可以解决问题：

**[演示](http://jsfiddle.net/P3ZUt/)**

```
$('a.tooltipimage').bind('mouseover',function(e){
    e=e?e:window.event;
    $('.tooltip').css({
        display: 'block',
        position:'absolute',
        top:e.pageY,
        left:e.pageX
    });
}) 
```

您的 html 中的一个小错误是，您有 2 个结束跨度标签，但没有起始标签。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-04-05T17:24:43.803

您的代码有几处错误，首先`span`是关闭，而不是打开，您使用了错误的选择器*anchor*，并且您使用*id*选择器而不是*div的**类*选择器。将所有*CSS*应用到*div*后，您必须显示它。

 *****标记**：

```
<span>
<a href="#" class="tooltipimage"><img src="/applications/images/icons/info_icon.gif"/></a>
</span> 
<div class="tooltip" style="margin:0 0 0 18px; display:none;">
<b>tooltip text goes here</b><br />                                                                 
 </div> 
```

**jQuery** :

```
$('.tooltipimage').on('mouseover',function(e)
{
    e=e?e:window.event;
    $('.tooltip').css(
    {
        position:'absolute',
        top:e.pageY,
        left:e.pageX
    }).show();
}).on("mouseout",function(){$('.tooltip').hide()}); 
```

**jsfiddle**：http: [//jsfiddle.net/vgYeR/](http://jsfiddle.net/vgYeR/)

我还绑定了**mouseout**事件，使它看起来更像一个工具提示。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2013-04-05T17:41:10.403

如果您可以更改某些 html，则不必使用 javascript（除非定位必须是动态的。然后您可以使用 javascript 进行设置）。你可以用普通的CSS来做到这一点。如果你只想要一个小文本，你总是可以使用[title](http://www.w3schools.com/tags/att_global_title.asp)属性

[**演示**](http://jsfiddle.net/P3ZUt/1/)

```
<span class="tooltipimage">
    <a href="#"><img src="/applications/images/icons/info_icon.gif"/></a>
    <label>tooltip text goes here</label>
</span> 

.tooltipimage:hover label{
    display:block;
}

.tooltipimage label{
    display:none;
    position:absolute;
    top:0px;
    left:20px;
}

.tooltipimage{
    display:block;
    position:relative;
} 
```

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2013-04-05T17:18:35.787

```
$('a[rel="tooltipimage"]') 
```

我想你需要引号。***

# ios - UIDocumentInteractionController 间歇性崩溃

> ID：15839743
> 
> 赞同：0
> 
> 时间：2013-04-05T17:17:34.293
> 
> 标签：ios, xcode, ipad

这里有一个奇怪的iOS问题......

我有一个可以在我的 iPad 上打开 PDF 的应用程序。（我只需要在我所处的环境中处理 iPad）

奇怪的是，有时当我尝试加载文件时（DocumentInteractionController 打开，我选择“在 iBooks 中打开”），我的应用程序会崩溃。如果我返回并选择完全相同的选项，它会在一分钟后正常工作。

如果我等了大约 10 分钟，我就会回到我开始的地方 - 应用程序第一次会崩溃，但第二次和以后的时间它工作正常。

这很难调试，因为与 iBooks 的交互需要在 iPad 上运行，我无法在模拟器上运行。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-05T17:36:21.587

前几天我遇到了同样的问题，那是因为我没有强烈引用 UIDocumentInteractionController。在@interface 中添加一个属性：

```
@property (nonatomic, strong) UIDocumentInteractionController *documentController; 
```

并在呈现之前将您的控制器分配给此属性。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-08T15:56:06.823

事实证明，我在 documentInteractionControllerDidDismissOptionsMenu 方法中解除了 documentInteractionController 的分配。这导致了间歇性崩溃。

删除该方法（及其对 dealloc 的调用）解决了该问题。相反，我在 dealloc 方法中释放对象。（对不起，如果我在这里没有使用正确的术语 - 我是 Objective-C/iOS 的新手）

# php - 难题 - 需要在 PHP 中获取视口大小（或任何其他方式）

> ID：15839746
> 
> 赞同：1
> 
> 时间：2013-04-05T17:17:46.240
> 
> 标签：php, javascript, viewport

基本上，我目前有一个用 javascript 编写的网站，但我决定主要用 PHP 重写。我要替换的主要部分使用 spry 将 xml 数据集的值读取到 javascript 变量中。

带有 mySQL 的 PHP 可以轻松地承担我正在使用 spry 的工作，但是我想在服务器端制作脚本的另一部分。

当前发生的情况是，当页面加载时，我的函数决定了图片的大小，因此决定了服务器上的大小。有五个不同大小的文件，它会选择最小的一个，它不必放大（但可以缩小）。它将这些信息与来自 spry 的一些信息结合起来，并设置一个 img 元素的 src，这是以前未设置的（这是我讨厌当前设置的一部分）。

我已经完成了谷歌搜索，我知道问题所在 - PHP 解析服务器端，此时它无法知道屏幕大小。

我可以不用 - 我会保留我现有的 javascript 来完成这项任务，这有​​点不稳定，或者只使用一种尺寸的图像，这只会让我的网站变得不那么好。

我只是想知道是否有任何专家有技巧让 php 决定嵌入哪个图像。我猜浏览器第一次请求该站点时没有发送任何内容..这会出现在我的谷歌搜索中..

我应该提一下，除了在我网站的所有页面上都有一个标签栏的简单事情之外，我没有做过任何 PHP，我使用 php 将其引入并更改所选标签的外观。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-05T17:23:08.210

实际上有一种更简单的方法可以做到这一点。您可以设置 css 媒体查询以根据视口宽度加载不同的图像。

PHP 对客户端了解不多。获取视口大小等信息很困难。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-05T17:22:00.173

你有几个选择：

选项 1：输出一个带有一些 JS 的简单页面，该页面获取浏览器规范，然后进行重定向，将这些规范作为查询参数传递。例如

[http://example.com/stage2.php?x=1024&y=768](http://example.com/stage2.php?x=1024&y=768)

然后这个 stage2 脚本可以根据传递的规范构建真实页面。

选项 2：使用一些 AJAX 延迟加载。页面的主要内容获取规范，通过 AJAX 调用将它们传回，响应是 HTML 的其余部分，经过调整以反映这些规范。例如

```
$('#body').load('example.com?x = ' + window.width + ......); 
```

# c++ - ICS Win 7 Hnetcfg，INetSharingConfiguration 设置特定连接到可用设备之一

> ID：15839749
> 
> 赞同：0
> 
> 时间：2013-04-05T17:17:59.433
> 
> 标签：c++, winapi, windows-7

我设法编写了一个代码来使用启用共享的方法（[http://msdn.microsoft.com/en-us/library/windows/desktop/aa365944%28v=vs.85%29.aspx](http://msdn.microsoft.com/en-us/library/windows/desktop/aa365944%28v=vs.85%29.aspx)）。但它将共享设置为非特定连接。有没有办法传递一个参数或另一个函数，将启用 ICS 的连接设置为与我选择的连接共享？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-11-01T04:44:44.613

也许您正在搜索`INetSharingConfiguration.EnableSharing`功能。你不是Win7中ICS问题的唯一人呵呵。[阅读另一个问题](https://stackoverflow.com/questions/12294820/enable-internet-connection-sharing-programmatically)

我不确定[这个 msdn 上的文档](http://msdn.microsoft.com/en-us/library/windows/desktop/aa365935%28v=vs.85%29.aspx)是否有用。我看到了最低客户端 XP，但没有看到任何关于 Vista/7 进一步兼容性的信息。

[超级用户的另一个问题也许可以帮助你。](https://superuser.com/questions/470319/how-to-enable-internet-connection-sharing-using-command-line). 一个人说他为此做了一个很酷的应用程序。

如果您需要一种简单的方法来从 cmd 在 Win7 下与 ICS 共享，[您可以下载 POWERFULL ICS 管理器（cmd 或 Gui，.net）](https://superuser.com/questions/470319/how-to-enable-internet-connection-sharing-using-command-line) - 请参阅评论 #3。

# c++ - 如果在 C++ 中不能被 5 整除，则移动到 while 循环

> ID：15839755
> 
> 赞同：-4
> 
> 时间：2013-04-05T17:18:27.677
> 
> 标签：c++, loops, while-loop

我正在为一个类编写一个程序，其中用户输入一个被检查为偶数的数字，检查它是否可被 5 整除，如果满足这两个，则该数字将由 while 循环使用。澄清一下，如果数字是偶数并且可被 5 整除，则代码运行，如果它是偶数且可被 2 整除，则代码运行。第一组代码需要在 for 循环中，第二组代码（可被 2 整除）需要在 while 循环中。

我坚持使用 cin 并在第二组代码中使用它，第一组想要先操作它。

任何帮助解决这个问题都会很棒！

代码：

```
#include <iostream>
#include <string>
#include <fstream>    
#include <iomanip>

using namespace std;

int main ()
{
    system ("color F0");

    int number = 0, countIf = 0,countWhile = 0, i=0;

    cout << "Please enter a positive integer or zero to quit: ";
    cin >> number;
    cin.ignore();

    if (number < 0 || number%2 != 0)
        cout << "Error: The integer entered was either not positive or a zero. Try again." << endl;

    //else if (number%5 || (number%2) = 0)

    for (number%5; countIf < number; countIf +=5)
    {
        i = number / 10;
        i += countIf;
        cout << i << " ";        
    }
    cin.ignore();

    while (countWhile <= i && i%2) 
    {
        int x = 0;
        cout << x << " ";
        x += 2;
    }

    system ("pause");
    return 0;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-05T17:33:26.907

我在看你原来的 else if 语句

```
else if (number%5 || (number%2) = 0) 
```

你在这里想要的是

```
else if (number%5 == 0 && number%2 == 0) 
```

并在 else if 块中执行您的代码。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-05T17:21:49.270

在操作数据之前将其复制到另一个变量。

```
cin>>a;
b=a; 
```

并将 b 用于第二组。如果一个数是偶数，它显然能被2整除。所以你不需要检查一个数是否是偶数，它是否能被2整除

# android - 我应该如何在对话框中添加一些操作项？

> ID：15839761
> 
> 赞同：0
> 
> 时间：2013-04-05T17:18:39.603
> 
> 标签：android, android-actionbar, android-dialog, android-menu, android-optionsmenu

我有一个自定义对话框，我想在其中添加一些带有 android 日历之类的图标的操作项。

![带有操作项对话框的 android 日历](https://i.stack.imgur.com/U4S8y.png)

这是为我的活动提供主题的清单代码：

```
 <activity
        android:name=".FileChooser"
        android:label="FileChooser"
        android:theme="@android:style/Theme.DeviceDefault.Dialog"  tools:ignore="NewApi">
    </activity> 
```

在 FileChooser.java 中：

```
 public boolean onCreateOptionsMenu(Menu menu) 
 {
        MenuItem camramnu= menu.add(0,0,0,"Take a picture");
        {
            camramnu.setIcon(R.drawable.camera);
            camramnu.setShowAsAction(MenuItem.SHOW_AS_ACTION_ALWAYS);
        }
        return true;
 } 
```

它从不显示图标！

我该怎么做 ？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-06T21:49:49.503

我看到了问题 - 您有一个选项菜单，但是从您包含的图像中，已经有一个看起来像上下文操作栏菜单正在运行的东西，带有“完成”和“取消”

也许你需要设置你的菜单选项

[http://developer.android.com/guide/topics/ui/menus.html#CAB](http://developer.android.com/guide/topics/ui/menus.html#CAB)

在这种情况下，

```
private ActionMode.Callback mActionModeCallback = new ActionMode.Callback() {

// Called when the action mode is created; startActionMode() was called
@Override
public boolean onCreateActionMode(ActionMode mode, Menu menu) {
    // Inflate a menu resource providing context menu items
    MenuInflater inflater = mode.getMenuInflater();
    inflater.inflate(R.menu.context_menu, menu);
    return true;
}

// Called each time the action mode is shown. Always called after onCreateActionMode, but
// may be called multiple times if the mode is invalidated.
@Override
public boolean onPrepareActionMode(ActionMode mode, Menu menu) {
    return false; // Return false if nothing is done
}

// Called when the user selects a contextual menu item
@Override
public boolean onActionItemClicked(ActionMode mode, MenuItem item) {
    switch (item.getItemId()) {
        case R.id.menu_share:
            shareCurrentItem();
            mode.finish(); // Action picked, so close the CAB
            return true;
        default:
            return false;
    }
}

// Called when the user exits the action mode
@Override
public void onDestroyActionMode(ActionMode mode) {
    mActionMode = null;
} 
```

};

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-05T19:16:26.750

您的菜单在片段中吗？在片段中，您必须使用 setHasOptionsMenu(true);

# c# - 如何释放和处置 Container 实例上的所有 Http 范围的对象？

> ID：15839766
> 
> 赞同：5
> 
> 时间：2013-04-05T17:19:00.317
> 
> 标签：c#, structuremap, httpcontext

在 StructureMap 中，如何在特定的 Container 实例上释放和处置所有 Http 范围的对象？对于对象工厂中的默认实例，我可以执行方法`ReleaseAndDisposeAllHttpScopedObjects()`，但是Container类和IContainer接口似乎没有这种方法。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-05T20:22:33.250

如果您查看 的内部结构`ObjectFactory.ReleaseAndDisposeAllHttpScopedObjects`，您会发现它是一种方便的方法，如下所示：

```
public static void ReleaseAndDisposeAllHttpScopedObjects()
{
    HttpContextLifecycle.DisposeAndClearAll();
} 
```

IE。您可以调用该`HttpContextLifecycle.DisposeAndClearAll`方法来清除对象。

编辑：由于 HttpContextLifecycle 是全局的，而不是每个容器，我认为[嵌套容器](http://codebetter.com/jeremymiller/2010/02/10/nested-containers-in-structuremap-2-6-1/)方法将是在 Http 请求期间对对象生命周期进行更细粒度控制的解决方案。

# django - Django + Gunicorn + Nginx = CSRF cookie 未设置

> ID：15839769
> 
> 赞同：2
> 
> 时间：2013-04-05T17:19:08.287
> 
> 标签：django, nginx, csrf, gunicorn, django-csrf

我已经使用 Gunicorn 在 Nginx 后面设置了 Django，但是当我尝试登录管理面板时，我得到：

```
Forbidden (403)
CSRF verification failed. Request aborted.

Reason given for failure:
CSRF cookie not set. 
```

这很奇怪，因为如果我在本地运行它就可以正常工作。但是，在 nginx 后面，当我使用“python manage.py runserver 0.0.0.0:8000”和“python manage.py run_gunicorn”运行它时它会失败。

设置.py：

```
MIDDLEWARE_CLASSES = (
    'django.middleware.common.CommonMiddleware',
    'django.contrib.sessions.middleware.SessionMiddleware',
    'django.middleware.csrf.CsrfViewMiddleware',
    'django.contrib.auth.middleware.AuthenticationMiddleware',
    'django.contrib.messages.middleware.MessageMiddleware',
    # CORS SUPPORT
    'corsheaders.middleware.CorsMiddleware',
    # Uncomment the next line for simple clickjacking protection:
    # 'django.middleware.clickjacking.XFrameOptionsMiddleware',
) 
```

nginx.conf：

```
server {
        listen 8080;
        server_name  example.com;
        access_log  /var/log/nginx/example.com.access.log;
        error_log  /var/log/nginx/example.com.error.log info;

        keepalive_timeout 5;
        location /assets/grappelli/ {
                alias /var/www/example.com/virtualenv/lib/python2.6/site-packages/grappelli/static/grappelli/;
        }

        location /assets/ { # STATIC_URL
                alias /var/www/example.com/PopcornHour/assets/; # STATIC_ROOT
                expires 30d;
        }

location / {
        proxy_pass_header Server;
        proxy_set_header Host $http_host;
        proxy_redirect off;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Scheme $scheme;
        proxy_connect_timeout 10;
        proxy_read_timeout 10;
        proxy_pass http://localhost:8000/;
    }
    # what to serve if upstream is not available or crashes
    error_page 500 502 503 504 /media/50x.html;

} 
```

非常感谢您的帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-08T19:12:18.450

我发现了它失败的原因——即使我为此域禁用了 Varnish，它仍然与标头和 cookie 混淆，暂时禁用它:)

# asp.net-mvc - 带有 Enum Kendo UI 的 DropDownList

> ID：15839770
> 
> 赞同：6
> 
> 时间：2013-04-05T17:19:09.200
> 
> 标签：asp.net-mvc, kendo-ui, html.dropdownlistfor

我正在更新应用程序以使用 Kendo UI，并且遇到了使用 DropDownList 绑定到 Enum 的问题。我遇到的两个问题是 1）该值不包含 Enum 值，而是包含“Today”（应该为 0），以及 2）显示值始终是“Last10Days”而不是描述中的“Last 10 Days”标签。我查看并找不到有人使用 Kendo UI 将描述显示为文本并包含数值而不是文本的另一个地方。任何帮助表示赞赏。

## 看法

```
<div class="span6">
  @Html.LabelFor(m=> m.DateRanges)
  @(Html.Kendo().DropDownListFor(m => m.DateRanges)
      .BindTo(Enum.GetNames(typeof(SearchDateRanges)).ToList())
      .HtmlAttributes(new { value = "Today" })
      .DataTextField("Text")
      .Events(e => e.Change("DateChange")))
</div>

<div class="span6">
  @Html.LabelFor(m => m.Status)
  @(Html.Kendo().DropDownListFor(m=> m.Status)
      .BindTo(Enum.GetNames(typeof(SearchStatusCriteria)).ToList())
      .HtmlAttributes(new {value = "All"}))
</div> 
```

## 模型

```
 public enum SearchDateRanges
{
    [Description("Today")]
    Today = 0,

    [Description("Last 10 Days")]
    Last10Days = 1,

    /// <summary>
    /// The last 30 days.
    /// </summary>
    [Description("Last 30 Days")]
    Last30Days = 2,

    [Description("Last 60 Days")]
    Last60Days = 3,

    [Description("Last 90 Days")]
    Last90Days = 4,

    [Description("Custom Date Range")]
    CustomRange = 5
} 
```

}

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-05T17:39:47.417

AFAIK，这不是自动支持的。

您可以编写一个小辅助方法，它采用 Enum 类型并将其转换为`List<SelectListItem>`如下形式：

```
public static List<SelectListItem> EnumToSelectList( Type enumType )
{
  return Enum
    .GetValues( enumType )
    .Cast<int>()
    .Select( i => new SelectListItem
      {
        Value = i.ToString(),
        Text = Enum.GetName( enumType, i ),
      }
    )
    .ToList()
} 
```

然后您可以将 DropDownList 绑定到选择列表：

```
.BindTo( EnumToSelectList( typeof( SearchDateRanges ) ) ) 
```

如果您希望文本来自`Description`属性，则必须修改它以获取属性值 - 可能通过反射。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-04-05T17:53:41.700

您似乎在询问枚举的变量名称而不是描述属性：

```
.BindTo(Enum.GetNames(typeof(SearchDateRanges)).ToList()) 
```

要获得 description 属性，您必须做一些工作。这是我找到的一些代码：

```
public static string GetEnumDescription(Enum value)
{
    FieldInfo fi = value.GetType().GetField(value.ToString());

DescriptionAttribute[] attributes =
    (DescriptionAttribute[])fi.GetCustomAttributes(
    typeof(DescriptionAttribute),
    false);

if (attributes != null &&
    attributes.Length > 0)
    return attributes[0].Description;
else
    return value.ToString();
} 
```

您还将文本字段绑定到枚举中不存在的“文本”。

希望这可以帮助。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2014-05-30T14:26:52.263

NET MVC 5.1 与`@Html.EnumDropDownListFor`.

只需`.cshtml`在`Views/EditorTemplate`文件夹中新建一个。

例如，在带有网格的 cshtml 中，

```
@(Html.Kendo().Grid<NameProved.Models.Issuer>()
.Name("IssuerGrid")
.Columns(columns =>
{
    columns.Bound(issuer => issuer.ID);
    columns.Bound(issuer => issuer.Name);
    columns.Bound(issuer => issuer.IssuerType);

    columns.Command(commands =>
        {
            commands.Edit();
            commands.Destroy();
        }).Title("Commands");
})
.ToolBar(toolbar => toolbar.Create())
.Editable(editable => editable
    .Mode(GridEditMode.PopUp)
    )
.DataSource(datasource =>
    datasource
    .Ajax()
    .Events(events => events.Error("grid_error"))
    .Model(model =>
    {
        model.Id(issuer => issuer.ID);
        model.Field(issuer => issuer.ID).Editable(false).DefaultValue(0);
    })
    .Create(create => create.Action("Issuer_Create", "Admin"))
    .Read(read => read.Action("Issuer_Read", "Admin"))
    .Update(update => update.Action("Issuer_Update", "Admin"))
    .Destroy(destroy => destroy.Action("Issuer_Destory", "Admin"))
    )
.Pageable()

)
) 
```

在这里，您必须将 添加`UIHint`到 中`issuerType`，即`enum`.

然后在`Views/Shared/EditorTemplate/IssuerTypeEditor.cshtml`,

```
@model NameProved.Models.IssuerType

@Html.EnumDropDownListFor(issuerType => issuerType) 
```

然后在模型中添加`UIHint`.

```
public class Issuer
{

    public int ID { get; set; }
    public string Name { get; set; }

    [UIHint("IssuerTypeEditor")]
    public IssuerType IssuerType { get; set; }
} 
```

然后你会得到它。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2016-06-17T19:41:46.503

我知道这个线程很旧，但如果有人用谷歌搜索同样的问题，这里是另一种解决方案：

```
@(Html.Kendo().DropDownList()
    .Name("subscriptionTypeTest")
    .DataTextField("Text")
    .DataValueField("Value")
    .BindTo(Html.GetEnumSelectList(typeof(SubscriptionType)))
    .Deferred()
) 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2021-07-02T20:28:53.303

这与 Nikolay Kostov 的回答非常相似。这适用于 Telerik asp.net 核心。这是您的编辑器模板的代码。

```
@model Enum

@(Html.Kendo().DropDownListFor(m => m)
        .DataTextField("Text")
        .DataValueField("Value")
        .BindTo(Html.GetEnumSelectList<Web.Models.YourEnumType>())

    ) 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2016-02-24T21:05:13.687

你可以试试这个

```
@(Html.Kendo().DropDownListFor(model => model.NoticePeriodType)
      .DataTextField("Text")
      .DataValueField("Value")
      .DataSource(source =>
         {
           source.Read(read =>
           {
              read.Action("LoadPeriodTypesAjax", "ControllerName"); //put controller name
            });
         })
   )

public JsonResult LoadPeriodTypesAjax()
{
    var values = Enum.GetValues(typeof(PeriodType)).Cast<int>(); //PeriodType= enum name
    var converter = TypeDescriptor.GetConverter(typeof(PeriodType));
    var datas = from value in values
                select new SelectListItem
                {
                    Text = converter.ConvertToString(value),
                    Value = value.ToValue(),
                };
    return Json(datas, JsonRequestBehavior.AllowGet);
} 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2016-11-30T17:48:30.593

Andre 的答案仅适用于 ASP.Net MVC 5.1 及更高版本。对于旧版本，您可以使用`EnumHelper.GetSelectList`

```
@(Html.Kendo().DropDownList()
    .Name("subscriptionTypeTest")
    .DataTextField("Text")
    .DataValueField("Value")
    .BindTo(EnumHelper.GetSelectList(typeof(SubscriptionType)))
    .Deferred()
) 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2019-11-22T14:16:10.737

如果您需要 Kendo UI 和 ASP.NET Core 中的枚举编辑器模板，您可以在以下位置使用此编辑器模板代码`Enum.cshtml`：

```
@model Enum
@{
    var values = Enum.GetValues(this.ViewData.ModelMetadata.ModelType).Cast<object>()
        .Select(v => new SelectListItem
                     {
                         Selected = v.Equals(this.Model),
                         Text = v.ToString(),
                         Value = ((int)v).ToString()
                     });                               
}

@(this.Html.Kendo().DropDownListFor(m => m)
    .DataTextField("Text")
    .DataValueField("Value")
    .BindTo(values)) 
```

# r - 如何计算 R 中 k 均值聚类的 BIC

> ID：15839774
> 
> 赞同：19
> 
> 时间：2013-04-05T17:19:16.077
> 
> 标签：r, cluster-analysis, k-means

我一直在使用 k-means 在 R 中对我的数据进行聚类，但我希望能够使用贝西信息准则 (BIC) 和 AIC 评估我的聚类的拟合与模型复杂性。目前我在 R 中使用的代码是：

```
KClData <- kmeans(Data, centers=2, nstart= 100) 
```

但我希望能够提取 BIC 和对数似然。任何帮助将不胜感激！

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2014-08-28T20:09:09.103

对于其他登陆这里的人，Sherry Towers 在[http://sherrytowers.com/2013/10/24/k-means-clustering/](http://sherrytowers.com/2013/10/24/k-means-clustering/)提出了一种方法，该方法使用来自`stats::kmeans`. 我引用：

> 可以使用以下函数计算 AIC：
> 
> ```
> kmeansAIC = function(fit){
> 
> m = ncol(fit$centers)
> n = length(fit$cluster)
> k = nrow(fit$centers)
> D = fit$tot.withinss
> return(D + 2*m*k)
> } 
> ```

从 的帮助中`stats::AIC`还可以看到，BIC 的计算方法与 AIC 类似。获取 BIC 的一种简单方法是`return()`将上述函数中的 替换为：

```
return(data.frame(AIC = D + 2*m*k,
                  BIC = D + log(n)*m*k)) 
```

因此，您将按如下方式使用它：

```
fit <- kmeans(x = data,centers = 6)
kmeansAIC(fit) 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2013-04-07T17:40:20.917

要计算 BIC，只需将`.5*k*d*log(n)`（其中`k`是平均值的数量，`d`是数据集中向量的长度，以及`n`数据点的数量）添加到标准 k-means 误差函数。

标准的 k-means 惩罚是`\sum_n (m_k(n)-x_n)^2`，其中`m_k(n)`是与第 n 个数据点相关的平均值。这个惩罚*可以*解释为对数概率，所以 BIC 是完全有效的。

BIC 只是在与 成比例的 k 均值误差上添加了一个额外的惩罚项`k`。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2014-07-31T16:13:58.310

只是为了添加 user1149913 所说的内容（我没有足够的声誉来发表评论），因为您在 R 中使用了 kmeans 函数，`\sum_n (m_k(n)-x_n)^2`因此已经为您计算了`KClData$tot.withinss`.

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2015-10-18T19:22:19.430

我们可以为对象定义一个对数似然函数，而不是重新实现`AIC`or ；这将被包中的函数使用。`BIC``kmeans``BIC``stats`

```
logLik.kmeans <- function(object) structure(
  -object$tot.withinss/2,
  df = nrow(object$centers)*ncol(object$centers),
  nobs = length(object$cluster)
) 
```

然后使用它，`BIC`正常调用。例如：

```
example(kmeans, local=FALSE)
BIC(cl)
# [1] 26.22842084 
```

此方法将在`stackoverflow`软件包的下一个版本中提供。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2021-09-21T12:27:03.647

一个函数[qualityCriterion::longitudinalData](https://search.r-project.org/CRAN/refmans/longitudinalData/html/qualityCriterion.html)可以计算 k-means 集群的 BIC 和 AIC。它首先计算每个集群中心在每个个体上的可能性，然后再与集群大小的权重合并。正态密度函数的 sd 基于 RSS。

虽然原始代码给出了 -BIC 而不是 BIC，但我采用了 BIC 的代码：

```
qualityCriterion <- function (traj, clusters) 
{
    if (nrow(traj) != length(clusters)) {
        stop("[qualityCriterion] the cluster and the number of trajectory should be the same.")
    }

    clusters <- as.integer(clusters)
    nbIndiv <- nrow(traj)
    nbTime <- ncol(traj)
    nbClusters <- length(unique(clusters))

    # Cluster frequency
    preProba <- as.numeric(table(clusters))
    preProba <- preProba / sum(preProba)

    # Centers as cluster means
    moy <- matrix(, nbClusters, nbTime)
    for (i in 1:nbClusters) {
        moy[i, ] <- apply(traj[as.numeric(clusters) == i, , drop = FALSE], 2, meanNA)
    }

    # sd of residuals
    ecart <- sqrt(mean(as.numeric(traj - moy[clusters, ])^2, na.rm=TRUE))

    # likelihood
    vraisIndivXcluster <- matrix(, nbIndiv, nbClusters)
    for (i in 1:nbClusters) {
        vraisIndivXcluster[, i] <- preProba[i] * apply(dnorm(t(traj), moy[i, ], ecart), 
                                                       2, prod, na.rm = TRUE
                                                      )
    }
    vraisIndivXcluster <- apply(vraisIndivXcluster, 1, sum)
    logVraisemblance <- sum(log(vraisIndivXcluster))

    nbParam <- nbClusters * nbTime + 1 # cluster centers and sd
    #BIC <- -2 * logVraisemblance + nbParam * log(nbIndiv) # BIC for time series
    BIC2 <- -2 * logVraisemblance + nbParam * log(nbIndiv * nbTime) # BIC for independent columns
    AIC <- 2 * nbParam - 2 * logVraisemblance
    #AICc <- AIC + (2 * nbParam * (nbParam + 1)) / (nbIndiv - nbParam - 1) # AICc for time series
    #AICc2 <- AIC + (2 * nbParam * (nbParam + 1)) / (nbIndiv * nbTime - nbParam - 1) # AICc for independent columns

    return(list(criters = c(BIC2 = BIC2, AIC = AIC)))
} 
```

100 个个体的示例，每个个体有 2 个数据点，形成 3 个集群：

```
set.seed(1)
dat <- matrix(rnorm(100 * 2), nrow = 100, ncol = 2) # data of 100 individuals
dat[34:66,] <- dat[34:66,] + 4
dat[67:100,] <- dat[67:100,] + 8
plot(dat[,1], dat[,2]) # 3 cluster centers at (0,0), (4,4), (8,8) 
```

[![在此处输入图像描述](https://i.stack.imgur.com/tNdo4.png)](https://i.stack.imgur.com/tNdo4.png)

正如预期的那样，k = 3 个集群时的最小 BIC：

```
# k-means with k = 2:5
clusters_2 <- kmeans(dat, centers = 2)
clusters_3 <- kmeans(dat, centers = 3)
clusters_4 <- kmeans(dat, centers = 4)
clusters_5 <- kmeans(dat, centers = 5)

BIC <- c(qualityCriterion(dat, rep(1, nrow(dat)))$criters["BIC2"],
         qualityCriterion(dat, clusters_2$cluster)$criters["BIC2"],
         qualityCriterion(dat, clusters_3$cluster)$criters["BIC2"],
         qualityCriterion(dat, clusters_4$cluster)$criters["BIC2"],
         qualityCriterion(dat, clusters_5$cluster)$criters["BIC2"]
        )

plot(1:5, BIC, xlab = "k", ylab = "BIC")
lines(1:5, BIC) 
```

[![在此处输入图像描述](https://i.stack.imgur.com/Tx1CM.png)](https://i.stack.imgur.com/Tx1CM.png)

# ios - 2 个 NSData 对象如何在转换为 char 数组时输出相同的 HEX 但不同？

> ID：15839777
> 
> 赞同：0
> 
> 时间：2013-04-05T17:19:18.930
> 
> 标签：ios, objective-c, cocoa-touch, nsdata

所以基本上我有一些 NSData 对象和一个看起来像这样的方法：

```
+ (NSData *)outputData:(NSData *)data andThisData:(NSData *)secondData {
    char cData[data.length];
    [data getBytes:&cData];

    char cSecondData[secondData.length];
    [secondData getBytes:&cSecondData];

    NSLog(@"NSData: %@, %@", data, secondData);
    NSLog(@"HEX: %x, %x",cData,cSecondData);
} 
```

我正在为两个单独的 NSData 对象获取此输出，它们在表面上看起来相同：

```
 NSData: <dc4945fa a76fa1eb 6c3de73e acabf71c>, <c7a75cfc 11697878 14b95c2b 8680b60b ed553909 d199c12b 6e66df1d 20dce6e5 46ef9cf6 0aefa4ee bf98b0d1 6579a311>
    HEX: 5fbfe870, 5fbfe840

 NSData: <dc4945fa a76fa1eb 6c3de73e acabf71c>, <c7a75cfc 11697878 14b95c2b 8680b60b ed553909 d199c12b 6e66df1d 20dce6e5 46ef9cf6 0aefa4ee bf98b0d1 6579a311>
    HEX: 5fbfe820, 5fbfe7f0 
```

正如您所看到的 NSData 输出完全相同，但`char`它们产生的十六进制是不同的（尽管非常相似）。这会抛出一些计算和进一步计算的输出，但我不明白为什么它们会有所不同。

那么在什么情况下会出现这种情况呢？我该如何补救？

非常感谢。（如果您需要更多信息，请告诉我）。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-05T17:21:46.383

您没有打印缓冲区中的数据。您正在打印两个本地数组的地址衰减到的指针。如果您实际打印数据，它们将是相同的：

```
NSMutableString *hex = [NSMutableString string], *secondHex = [NSMutableString string];
for (int i = 0; i < sizeof(cData); i++) {
    [hex appendFormat:@"%02x", cData[i]];
    [secondHex appendFormat:@"%02x", cSecondData[i]];
}

NSLog(@"%@ %@", hex, secondHex); 
```

# jquery - 插件停止使用 JQuery 1.9.1

> ID：15839780
> 
> 赞同：-1
> 
> 时间：2013-04-05T17:19:31.260
> 
> 标签：jquery

前段时间，我使用 JQuery 1.8.3 创建了一个 Balloon 插件。

当我从 JQuery 1.8.3 更新到 JQuery 1.9.1 时，我的插件停止工作。

气球不再显示。我回到 1.8.3 并且它有效。

我试图了解可能出了什么问题，但我找不到。

有人可以帮我吗？这是我的代码：

```
 (function ($) {
      $.fn.Balloon = function (options) {
    var defaults = {
          balloon: "",
          class: "Balloon",
          click: false,
          id: "Balloon",
          sensible: false,
          x: -4,
          y: -40
        };
        var options = $.extend({}, defaults, options);
        var balloon;
        $(this).each(function () {
          var title = $(this).attr("title");
          if (title == undefined) return;
          $(this).hover(function (e) {
            $(this).removeAttr("title")
            balloon = "<div id='{id}' class='{class}'><span class='Text'>{content}</span><span class='Background'></span></div>"
            if (options.balloon == "") {
              balloon = balloon.replace("{class}", options.class).replace("{id}", options.id).replace("{content}", title);
            } else {
              balloon = balloon.replace("{class}", options.class).replace("{id}", options.id).replace("{content}", options.balloon).replace("{title}", title);
            }
            $("body").append(balloon);
            $("#" + options.id).fadeIn("fast");
          },
          function () {
            $("#" + options.id).remove();
            $(this).attr("title", title);
          });
          $(this).mousedown(function (e) {
            if (options.click) {
              $("#" + options.id).remove();
              $(this).attr("title", title);
            }
          }),
          $(this).mousemove(function (e) {
            var x = e.pageX + options.x;
            var y = e.pageY + options.y;
            if (options.sensible) {
              var width = $("#" + options.id).width();
              var height = $("#" + options.id).height();
              var right = $(window).width() - (x + width);
              var bottom = $(window).height() - (y + height);
              if (right < 20) {
                x = e.pageX - width - options.x;
              }
              if (bottom < 20) {
                y = e.pageY - height - options.y;
              }
            }
            $("#" + options.id).css({ top: y, left: x });
          }); // Mouse Move
        }); // Balloon
      };
    })(jQuery); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-05T17:22:26.933

使用[jQuery Migrate](https://github.com/jquery/jquery-migrate/#readme)找出您需要为 jQuery 1.9 修复的内容。

> 此插件可用于检测和恢复在 jQuery 中已弃用并从 1.9 版开始删除的 API 或功能。有关插件生成的消息的更多信息，请参阅 [警告页面。](https://github.com/jquery/jquery-migrate/blob/master/warnings.md)有关 jQuery 1.9 中所做更改的更多信息，请参阅[升级指南](http://jquery.com/upgrade-guide/1.9/)和[博客文章](http://blog.jquery.com/2013/01/15/jquery-1-9-final-jquery-2-0-beta-migrate-final-released/)。
> 
> 在您的网页中，在 jQuery 脚本之后加载此插件：
> 
> ```
> <script src="http://code.jquery.com/jquery-1.9.0.js"></script>
> <script src="http://code.jquery.com/jquery-migrate-1.1.1.js"></script> 
> ```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-05T17:24:36.117

你提到写一个插件。看看[http://jquery.com/upgrade-guide/1.9/](http://jquery.com/upgrade-guide/1.9/)看看 jQuery 1.9 带来的变化。他们做了很多重大改变。

我会使用 jQuery Migrate 插件来识别问题，但不要在生产中使用它。你应该让你的插件与 jQuery 1.9+ 一起工作。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-05T18:30:59.930

我能够通过以下方式替换悬停来解决它：

```
$(this).mouseenter(function (e) {
  // Code
}),
$(this).mouseleave(function (e) {
  // Code
}); 
```

谢谢你，米格尔

# java - 有一个参考的感兴趣的对象？范围是否适用于交互对象？

> ID：15839781
> 
> 赞同：0
> 
> 时间：2013-04-05T17:19:37.760
> 
> 标签：java

1.  即使零是唯一引用它的变量，保存值“dog”的 String 对象是否仍被视为已实习？

    ```
    String zero = "dog"; 
    ```

2.  这段代码中有多少个对象？要么是 1，因为实习对象忽略范围，要么是 2，因为范围仍然适用。

    ```
    String jack = "skellington";

    for(//stuff)
    {
    String sally = "skellington";
    } 
    ```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-05T17:21:30.900

字符串文字总是被实习的，即为它们创建池。如果在贴标一个字符串文字后，该字符串在该 JVM 实例的任何地方都被引用，则只能从池中挑选

1）将创建一个对象。不管它是否被引用

2）将创建一个对象

[请参阅http://docs.oracle.com/javase/1.5.0/docs/api/java/lang/String.html](http://docs.oracle.com/javase/1.5.0/docs/api/java/lang/String.html)上的实习生方法

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-05T17:23:05.290

> 这段代码中有多少个对象？要么是 1，因为实习对象忽略范围，要么是 2，因为范围仍然适用。

由于 java 在给定应用程序的 Stringpool 中实习了 String 字面量，因此***只会为您的代码创建一个对象***。查看Java 语言规范中指定的[字符串文字。](http://docs.oracle.com/javase/specs/jls/se7/html/jls-3.html#jls-3.10.5)它说明了有关字符串文字的以下几点：

> *   **同一包 (§7) 中同一类 (§8) 中的文字字符串表示对同一 String 对象 (§4.3.1) 的引用。**
>     
>     
> *   同一包中不同类中的文字字符串表示对同一 String 对象的引用。
>     
>     
> *   不同包中不同类中的文字字符串同样表示对同一 String 对象的引用。
>     
>     
> *   由常量表达式（第 15.28 节）计算的字符串在编译时计算，然后将其视为文字。
>     
>     
> *   在运行时通过连接计算的字符串是新创建的，因此是不同的。
>     
>     
> *   显式实习计算字符串的结果是与任何具有相同内容的预先存在的文字字符串相同的字符串。

# arrays - Perl grep 两个数组

> ID：15839805
> 
> 赞同：1
> 
> 时间：2013-04-05T17:21:08.720
> 
> 标签：arrays, perl, grep

我有一个用短字符串（@pos）填充的数组和第二个更大的数组（@exome）。我想在第二个数组中搜索与第一个数组匹配的字符串。目标是打印来自@exome 的所有匹配的行

我正在使用 perl，这是我目前所拥有的

```
#!/usr/bin/perl
use strict; use warnings;

my $pos = $ARGV[0];
my $exome = $ARGV[1];

open (F, "$pos") || die "Could not open $pos: $!\n";
my @pos = <F>;
close F;

open (F, "$exome") || die "Could not open $exome: $!\n";
my @exome = <F>;
close F;

foreach (@pos) {
    my @out = grep(/$_/, @exome);
    print @out
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-05T17:32:18.117

问题：

*   `/$_/`意味着`$_ =~ /$_/`，所以也许你应该为模式使用不同的变量。
*   您不会将文本转换为正则表达式模式（可以使用 来完成`quotemeta`）
*   您可以将同一行输出两次。
*   请不要将全局变量用于文件句柄。
*   无需将正在搜索的整个文件加载到内存中。

解决方案：

```
my ($pos_qfn, $exome_qfn) = @ARGV;

open(my $pos_fh, '<', $pos_qfn)
   or die("Could not open $pos_qfn: $!\n");
my @pos = <$pos_fh>;
chomp(@pos);

my $pat = join '|', map quotemeta, @pos;

open(my $exome_fh, '<', $exome_qfn)
   or die("Could not open $exome_qfn: $!\n");

while (<$exome_fh>) {
   print if /$pat/;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-05T18:21:28.100

我认为@ikegami 给出了一个很好的答案，但是，他似乎在打印什么数组时出错了......也许@user2249959 想要打印@exome 数组......所需的核心代码不超过两行：

```
my $grep_pos = join '|', @pos;
my @matched_results = grep { /$grep_pos/ } @exome; 
```

好吧，您可以在第二行立即打印出来，但数组中的元素之间不会有空格。两个 foreach 循环看起来不像 Perl，只是在我自己看来......

PS我加了三点注意
1.注意不可见的“\n”或“\r\n”
2.注意每个字符串开头和结尾的空格。
你可以用简单的代码解决以上两点，例如：

```
map { chomp; s/^\s*|\s*$// } @pos; 
```

这将删除“\n”（如果有）和前面或末尾的空格（如果您认为没有意义）。在 grep
3 之前执行此操作。更重要的是！注意@pos 数组文件中的**空行！**
如果您的文件如下所示：

```
pos_1
pos_2
 <---- totally blank
pos_3 
```

如果你仍然用'|'连接这些行，它将变成'pos_1|pos_2||pos_3'，这意味着@exome中的任何东西都会匹配。（因为 ' **||** '）
chomp 或 s/// 不会有帮助，你必须自己跳这条线
小心点:)

# html - jsp页面下载而不是在浏览器中打开

> ID：15839811
> 
> 赞同：2
> 
> 时间：2013-04-05T17:21:33.243
> 
> 标签：html, jsp

我是jsp编程的新手。我以前可以在浏览器中打开一个 jsp 页面来查看 html 布局，但是现在当我尝试打开一个 jsp 页面时，会弹出文件下载窗口并要求我在 IE9 中保存或打开文件，然后在 Firefox 中显示整个代码。

我已经安装了 tomcat，但是每次运行它只是为了查看小的修改很麻烦。有没有办法让 jsp 页面在 rIE9 或 firefox 中打开，以便我可以查看 html 方面？谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-05T17:28:10.117

首先，您应该启动 TomcatServer 并将您的网页 (jsp) 放入 webapps 文件夹中。尝试这样做，例如：

```
<%
out.println("test");
%> 
```

保存名为 index.jsp 的文件。当你调用网址时，试着把这个：http:\localhost:8080\yourfolder\index.jsp

请记住，您可以将 html 代码与 jsp 代码放在一起。

答案似乎很愚蠢，但就是这样。

问候。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2021-08-17T01:49:55.100

在您的 pom.xml 文件中添加 tomcat embed jasper 依赖项。你甚至可以复制这个并粘贴到 pom.xml

```
 <!-- https://mvnrepository.com/artifact/org.apache.tomcat.embed/tomcat-embed- 
   jasper -->
    <dependency>
        <groupId>org.apache.tomcat.embed</groupId>
        <artifactId>tomcat-embed-jasper</artifactId>
        <version>9.0.40</version>
    </dependency> 
```

# c++ - 在 Unix 文本文件中有多种字体

> ID：15839818
> 
> 赞同：0
> 
> 时间：2013-04-05T17:21:51.713
> 
> 标签：c++, unix, fonts

是否可以？

基本上，我们有这个称为视图 TTY(Teletype) 的功能，它会打开一个文本文件，该文件也是使用标准字符串操作函数在 C++ 中以编程方式生成的

我的问题是，有没有办法在 Unix 上创建一个包含不同字体大小的文本的文本文件？

如果是这样，在将其写入文本文件之前，C++ 中文本的字体大小可以吗？或者，是否必须将其写入另一种格式，例如 pdf？

请建议您知道的任何库/格式。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-05T18:03:40.247

文本文件只包含文本；它们（名义上）不包含有关文本显示方式的任何信息。然而，我名义上说，因为另一个程序很有可能将某些文本解释为标记——我已经将 LaTeX 源输出为文本，并且绝对允许使用任意数量的字体。

如果该文件只能由该查看器查看，那么您需要以标记的形式找出*它*支持的内容，并将其插入文本文件中。如果您有几个具有不同约定的不同查看器，您将必须定义一个中性约定（或使用现有的约定，但大多数现有的都非常复杂），然后为每个目标查看器编写过滤器，从而转换您的标记符合观众的期望。

# neo4j - Neo4j 中的关系类型可以使用数字吗？

> ID：15839824
> 
> 赞同：3
> 
> 时间：2013-04-05T17:22:07.543
> 
> 标签：neo4j, cypher, graph-databases

我创建了一些节点，以及它们与数字类型之间的关系（例如'3'）。创建工作正常，但现在我无法使用 Cypher 选择它们。

因为它允许我创建它们，所以我假设我得到的错误要么是我做错了，要么是一个错误？

这是一个例子。第一个查询有效，并返回类型为“3”的关系。但是，当我将其更改为仅指定类型 3 的关系时，出现错误。

```
neo4j-sh (?)$ START n=node(127) MATCH n-[r]-m RETURN n, r, m;
==> +--------------------------------------------------------------------------------+
==> | n                                 | r           | m                            |
==> +--------------------------------------------------------------------------------+
==> | Node[127]{user_id:"1",name:"Bob"} | :3[0] {}    | Node[118]{category:"state"}  |

neo4j-sh (?)$ START n=node(127) MATCH n-[r:3]-m RETURN n, r, m;
==> SyntaxException: string matching regex ``(``|[^`])*`' expected but `3' found
==> 
==> Think we should have better error message here? Help us by sending this query to cypher@neo4j.org.
==> 
==> Thank you, the Neo4j Team.
==> 
==> "START n=node(127) MATCH n-[r:3]-m RETURN n, r, m" 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-05T17:25:16.040

很明显，我只是需要一些睡眠。昨天在这个问题上敲了一段时间，但只是想出了答案。显然数字属于“不常见字符”类别，需要用反引号括起来。

[http://docs.neo4j.org/chunked/stable/query-match.html#match-relationship-types-with-uncommon-characters](http://docs.neo4j.org/chunked/stable/query-match.html#match-relationship-types-with-uncommon-characters)

现在它工作得很好。

# java - 将第三方对象传递给构造函数的最佳方法是什么

> ID：15839827
> 
> 赞同：2
> 
> 时间：2013-04-05T17:22:15.867
> 
> 标签：java, junit, apache-poi, inputstream, mockito

我有一个类接受一个参数，然后从参数中填充一个私有哈希图。

```
Public class Table {
  private Map<String, String> map = new HashMap<String, String>();
  private Workbook workbook;
  // approach 1
  Public Table(Workbook workbook) {
    this.workbook = workbook;
    // populate map using workbook
  }

  // approach 2
  Public Table(InputStream is) {
    this.workbook = WorkbookFactory.create(is)
    // Populate map
  }

 // approach 3
 Public Table(File file) {
   this.workbook = WorkbookFactory.create(file)
   // populate map
 }
} 
```

Workbook 是一个 Apache Poi 工作簿。考虑到junit和mockito的最佳方法是什么。

我倾向于方法 1，因为根据这个，[http](http://misko.hevery.com/code-reviewers-guide/flaw-constructor-does-real-work/) ://misko.hevery.com/code-reviewers-guide/flaw-constructor-does-real-work/我应该避免在构造函数中使用 new 关键字。但我不希望客户了解 Apache POI 才能使用此类。

方法 2 和 3 非常相似。有了这个，我可以传入文件或输入流，而不必担心底层实现。但是模拟会很困难，因为我不能用这种方法模拟工作簿？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-05T17:28:17.617

您可以创建一个工厂方法并且您的构造函数受到保护。会是这样的：

```
public class Table {

    private final Map<String, String> map = new HashMap<String, String>();
    private final Workbook workbook;

    // not private for testing.
    Table(Workbook workbook) {
       this.workbook = workbook;
    }

    public static Table create(File file) {
         return new Table(WorkbookFactory.create(file));
    }
} 
```

这样，您可以使用模拟测试您的`Table`课程，`Workbook`并且仍然不会向您的用户公开您正在使用它；）

```
@Runwith(MockitoJunitRunner.class)
public class TableTest {
    @Mock
    private Workbook workbook;
    @InjectMocks
    private Table table;

    // do some sweet testing ;D
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-05T17:34:53.503

考虑一下：

```
public class Table {
  private Map<String, String> map = new HashMap<String, String>();
  private Workbook workbook;

  Table(Workbook workbook) {
    this.workbook = workbook;
    // populate map using workbook
  }

  public Table(InputStream is) {
       this(WorkbookFactory.create(is)) ;
  }

 public Table(File file) {
     this(new FileInputStream(file);
 }
} 
```

请注意，工作簿特定的构造函数被声明为包保护，因此普通客户端将无法调用它，但如果您的单元案例与您的库共享相同的包，则直接从单元测试调用该构造函数将没有问题. 这也将允许您为其他两个构造函数编写单独的单元测试。

# javascript - 网络视频播放器

> ID：15839830
> 
> 赞同：0
> 
> 时间：2013-04-05T17:22:31.553
> 
> 标签：javascript, html, flash, video

好吧，我正在寻找一个可以嵌入到我的网络中的视频播放器（对不起，如果我没有使用适当的术语，我不知道要查找哪些词）。我已经尝试了许多基于 JS 和 CSS 的媒体元素或flarevideo，但对于所有这些，我需要以三种格式（mp4、ogv 和 webm）提供每个视频，以便它在所有浏览器中工作。我想知道是否有任何（如果可能的话，使用 HTML5 并回退到 Flash）可以在所有浏览器（或大多数浏览器）中以给定格式（比如 mp4）播放视频。

我认为这三种格式的问题是因为我也尝试使用 HTML5，但这不是真正的要求。我希望这个问题不要重复，我必须说我找不到合适的词来查找，不知道这些词是否正确。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-05T17:28:23.570

您真正的最佳选择是使用[YouTube](http://www.youtube.com)或[Vimeo](http://www.vimeo.com)，然后简单地将视频嵌入您的网站。您不会遇到兼容性问题，它们在 HTML5 上运行并在必要时回退到 Flash，在移动设备上工作，您也不会在主机上遇到存储问题！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-04-12T20:49:53.633

我同意上面乔丹的回答，但有时你必须自己主持。

我最近为一个不想使用**渐进式下载**传送视频的客户完成了一个项目（因为担心视频内容很容易被免费复制和使用）。我试图让他们了解 Vimeo 和 Youtube，但他们提供的服务的价值在于他们提供的视频内容，他们希望**完全拥有和定制**解决方案。

**要求**是将视频传送到最广泛的浏览器和设备。我想让事情变得简单，所以我想要一个适用于所有平台的单一播放器。

他们还希望安全地传送视频。

**我最终得到的一个合适的解决方案是：**

*   播放器：JW Player - 具有 Flash 后备功能
*   主持人：[Azure Media Services](http://azure.microsoft.com/blog/2014/09/16/azure-media-services-now-supported-by-jw-player/)即用即付服务
*   视频格式：HLS 版本 3（原生支持最多的浏览器和设备）

AWS Cloudfront 也可以，但感觉 Azure 定价更具侵略性。我只是想要最便宜的视频流传输解决方案（可扩展）来证明一切，我最终坚持使用 Azure。它也感觉像是一个比 AWS 解决方案更具凝聚力的解决方案。

但是，如果您不需要担心提供自适应流解决方案，那么您可以更轻松地从 S3 或[Azure blob 存储](http://programmerpayback.com/2013/01/30/hosting-progressive-download-videos-on-azure-blobs/)传送视频。

其他可用于自适应流媒体的技术：MPEG-DASH（恕我直言，这是未来，但支持仍仅限于最新的浏览器和设备）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-04-22T20:30:53.200

您还可以查看[http://www.dash-player.com](http://www.dash-player.com)，它是一个 MPEG-DASH 以及用于 HTML5 的 HLS 播放器，以及作为后备的 Flash。

# ruby-on-rails-3.2 - 发送电子邮件后，如何（使用邮件观察者）删除临时（生成的附件）文件？

> ID：15839852
> 
> 赞同：0
> 
> 时间：2013-04-05T17:23:53.953
> 
> 标签：ruby-on-rails-3.2, actionmailer, email-attachments, observers

我基本上是通过在 ActionMailer 的帮助下自动生成的附件（报告）文件向用户发送电子邮件。

这是我的 app/mailer/report_mailer.rb ：

```
class ReportMailer < ActionMailer::Base
  default from: "server.email@my_domaine.com"

  def generated_report(user, file_name, report_name, file_path)
    @user = user
    @report_name = report_name
    attachments[file_name] = File.read(file_path)
    mail(:to => user.email, :subject => "Generated report #{report_name} (automatic message)")
  end
end 
```

从我的控制器调用：

```
...
  t = Time.now
  file_name = "#{generated_name}_#{t.strftime("%Y-%m-%d_%HH-%M-%Ssec")}_#{t.usec}.xls"
  file_path = '/tmp/' + file_name
  ReportMailer.generated_report(current_user, file_name, generated_name, file_path).deliver
... 
```

我的 app/models/generated_report_observer.rb ：

```
class GeneratedReportObserver < ActiveRecord::Observer

  def self.delivered_email(message)
    file_path = ????
    File.delete file_path if File.exist? file_path
  end
end 
```

在 config/initilizer/my_mailer_observer_initializer.rb 中为我的邮件程序初始化我的观察者：

```
ReportMailer.register_observer(GeneratedReportObserver) 
```

感谢帮助

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-05T17:46:28.750

在深入研究[rails 库](http://rdoc.info/github/mikel/mail/Mail/AttachmentsList)后，我设法找到了正确的指令：

所以我最终得到以下 app/models/generated_report_observer.rb ：

```
class GeneratedReportObserver < ActiveRecord::Observer

  def self.delivered_email(message)
    file_path = '/tmp/' + message.attachments[0].filename
    File.delete file_path if File.exist? file_path
  end
end 
```

# jsp - 如何在 index.jsp 上加载 servlet

> ID：15839854
> 
> 赞同：8
> 
> 时间：2013-04-05T17:24:03.343
> 
> 标签：jsp, servlets, welcome-file

有什么方法可以调用 servlet`index.jsp`吗？我的欢迎文件是`index.jsp`. `index.jsp`打开 时，我需要通过 servlet 填充下拉列表值。

我尝试设置`<load-on-startup>`，`web.xml`但没有任何效果。如何获取欢迎文件`index.jsp`来调用 servlet？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2013-04-05T17:27:14.873

只需将欢迎文件 URL 更改为 servlet 之一。

给定这个 servlet 映射，

```
<servlet-mapping>
    <servlet-name>indexServlet</servlet-name>
    <url-pattern>/index</url-pattern>
</servlet-mapping> 
```

只要有这个欢迎文件列表：

```
<welcome-file-list>
    <welcome-file>index</welcome-file>
</welcome-file-list> 
```

不要忘记将 in 移动`/index.jsp`到`/WEB-INF`文件夹以防止最终用户通过猜测其 URL 直接访问它（并且不要忘记将 index servlet 中的转发调用更改为指向`/WEB-INF/index.jsp`）。

或者，如果您只打算拥有“主页 servlet”而不是“索引 servlet”，则将 servlet 映射到空字符串 URL 模式，而不是作为欢迎文件。

```
<servlet-mapping>
    <servlet-name>indexServlet</servlet-name>
    <url-pattern></url-pattern>
</servlet-mapping> 
```

### 也可以看看：

*   [如何在jsp页面加载时调用servlet？](https://stackoverflow.com/questions/10414093/how-to-call-a-servlet-on-jsp-page-load)
*   [servlet 映射 url 模式中 / 和 /* 之间的区别](https://stackoverflow.com/questions/4140448/difference-between-and-in-servlet-mapping-url-pattern/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-05T17:40:38.627

有多种方法可以实现这一点，具体取决于您使用的框架。

简单来说，您可以先调用 servlet 并将数据设置到表单中，然后重定向到您的 JSP。

或者

如果您熟悉 Ajax，您可以从您的 jsp 进行 ajax 调用来为您获取数据

如果您能告诉我您为项目使用的框架，我可以为您提供一个示例

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-08-04T05:03:51.547

只需创建一个**空的虚拟索引页面**...在该页面中只需添加以下行...

**<%request.getRequestDispatcher("Your Servlet name").include(request,response);%>** 例如： **<%request.getRequestDispatcher("Alumni_Servlet?option=first").include(request,response);%>**

然后在那个 Servlet 类中，只需实现逻辑并重定向您的原始主页或索引页面。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2018-10-29T14:37:24.010

使用 JQuery Ajax

```
<body onload="functionName()">
<script>
    function functionName(){

    $.ajax({
       url : 'YourServlet',
       type: "GET",
       async: false,
       success:function(response){

       },
       error: function (event) {

           console.log("ERROR: ", event);
       }
    });
}
</script> 
```

# ruby-on-rails-3 - 尝试创建包含关联的复杂 AR 查询

> ID：15839859
> 
> 赞同：0
> 
> 时间：2013-04-05T17:24:22.037
> 
> 标签：ruby-on-rails-3, activerecord, arel

我有一个具有 :category 属性的 Story 模型。Story 也与 Tag 建立了 HABTM 关系。

```
class Tag < ActiveRecord::Base

    has_and_belongs_to_many :stories, :uniq => true

    validates   :name,   :presence => true
    validates   :creator_id,  :presence => true

end 
```

* * *

```
class Story < ActiveRecord::Base

  attr_accessible :title, :category

  belongs_to    :user
  has_and_belongs_to_many :tags, :uniq => true
end 
```

我想搜索 (i) 具有在传递的 category_array 中的类别或 (ii) 具有在传递的 tag_array 中的关联 tag.name 的故事。

第一部分是直截了当的：

```
Story.where(:category => category_array) 
```

这是扩展我能力的第二部分。任何帮助将不胜感激！

**更新**

这解决了问题并且很容易阅读，但这是最好的方法吗？顺便说一句，我曾想过使用 arel，但我仍然不明白如何在连接表中使用 arel：

```
Story.includes(:tags).where("tags.name in (tag_array) OR category in (cat_array)") 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-17T21:25:27.407

这解决了问题并且很容易阅读，但这是最好的方法吗？

```
Story.includes(:tags).where("tags.name in (tag_array) OR category in (cat_array)") 
```

# matlab - 在 Matlab 中更改间谍的显示

> ID：15839860
> 
> 赞同：0
> 
> 时间：2013-04-05T17:24:22.787
> 
> 标签：matlab, sparse-matrix

我试图让稀疏矩阵的不同元素成为不同的颜色（填充），但它似乎不适用于黑色。但是即使我把黑色换成不同的颜色，我也会得到一个奇怪的模糊

```
spy(A,'ks',3)
markerH = findall(gca,'color','k');
set(markerH,'MarkerFaceColor','k');
hold on
spy(A==10,'gs',3)
markerH = findall(gca,'color','g');
set(markerH,'MarkerFaceColor','g');
hold off 
```

我怎样才能让它工作？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-05T17:54:23.623

因为文本等其他对象也可能具有颜色属性并且是黑色的。采用

```
markerH = findall(gca,'type','line','color','k'); 
```

# excel - Excel 宏：删除标题并仅复制项目

> ID：15839861
> 
> 赞同：0
> 
> 时间：2013-04-05T17:24:26.250
> 
> 标签：excel, copy, paste, vba

所以我知道如何复制值并将其粘贴到另一张纸上并删除空白单元格，但是如何删除标题（ID、ITEM、ITEM NUMBER），以便当我将项目粘贴到另一张纸上时它不会t 有多个头衔

![在此处输入图像描述](https://i.stack.imgur.com/cm5zs.jpg)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-06T21:18:17.990

我假设您已经有一个可以工作的宏来做其他事情。我会检查列`A`以查看它是否是数字并且 VBA 是否具有`IsNumeric`功能。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-05T17:48:08.677

我最近开发了一个获取文件“标题”的函数。它是为 csv 模块编写的，但我认为可以快速修改以处理 Excel。您还需要处理有多个标题的事实。我添加了一个`while`声明来处理这个问题。这是功能：

```
def getHeader(file):
   import csv
   headername = None
   charList = ['a', 'b', 'c', 'd', 'e', 'f', 'g', 'h', 'i', 'j', 'k', 'l', 'm', 'n', 'o', 'p', 'q', 'r', 's', 't', 'u', 'v', 'w', 'x', 'y', 'z', 'A', 'B', 'C', 'D', 'E', 'F', 'G', 'H', 'I', 'J', 'K', 'L', 'M', 'N', 'O', 'P', 'Q', 'R', 'S', 'T', 'U', 'V', 'W', 'X', 'Y', 'Z', '!', '@', '#', '$', '%', '^', '&', '*', '(', ')', '+', '+', "'", '"', '{', '}', '[', ']', '?', '.', ',', '<', '>', '/', '~', '`', '-', '_']
   rowcount = 0
   headercsv = open(file, 'r', newline = '')
   headerreader = csv.reader(headercsv, delimiter = ',')
   while rowcount < 5:
      for row in headerreader:
          rowcount += 1
          if row[0][0] in charList and row[1][0] in charList:
              headername = row
      headercsv.close()
   return headername 
```

我通过设置一个等于它的变量来调用它：`thisHeader = getHeader('filename')`

然后我在代码中实现它（我以 CSV 模块为例——这是我所熟悉的）：

```
for row in csvreader:
    if row == thisHeader:
        continue
    else:
        <get the data> 
```

此外，您还可以使用`thisHeader`在 Excel 电子表格中写入第一行，因此您无需继续处理它。

希望有帮助！

# java - 如何使用 System.out.format() 在 Java 中的一行上显示多个项目？

> ID：15839863
> 
> 赞同：1
> 
> 时间：2013-04-05T17:24:34.147
> 
> 标签：java

```
import java.text.*;
public class program17
{
public static void main(String[] args)
{
    NumberFormat money=NumberFormat.getCurrencyInstance();
    int[] num={2013,2015,2017,2019,2021};
    double[] price={19.85,15.39,16.59,12.35,15.15};
    int[] qty={43,12,34,17,10};
    double[] value={0,0,0,0,0};
    System.out.println("Part  \tItem \tItem    \tTotal");
    System.out.println("Number\tPrice\tQuantity\tValue\n");
    for(int i=0;i<5;i++)
    {
        value[i]=val(price[i],qty[i]);
        //System.out.println(num[i]+"\t"+money.format(price[i])+"\t"+qty[i]+"\t"+money.format(value[i]));
        System.out.format("%4d\t $%5d.2f\t %2d\t %6.2f", num[i], price[i], qty[i], value[i]);
    }
}
public static double val(double p, int q)
{
    double x=p*q;
    return x;
}
} 
```

这是我 100% 的代码。这是我的解决方案的输出： [捕获的输出 http://maradastudios.ucoz.com/school/Capture2.png](http://maradastudios.ucoz.com/school/Capture2.png)

正如您可能知道的那样，我可以简单地使用 System.out.println() 语句显示该程序的“数据行”，但是，我已经需要这种特定类型的 System.out.format()的情况，所以我决定最好实际了解这个错误的含义。我认为这可能是因为我试图显示的变量 price[i] 是 double，而不是 int，例如 num[i]。我得出这个结论是因为起初，我用

```
System.out.format("%4d\t", num[i); 
```

之后工作正常，我运行它

```
System.out.format("%4d\t $%5d.2f\t", num[i], price[i); 
```

之后出现错误。这是我尝试运行的完整代码。谁能告诉我我的 System.out.format() 语句有什么问题，并在我纠正它时帮助我？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-05T17:25:42.980

您`d`在格式字符串中有一个迷路。删除它，你会很高兴的。

```
System.out.format("%4d\t $%5d.2f\t %2d\t %6.2f", num[i], price[i], qty[i], value[i]);
                            ^ 
```

# java - 尝试使用线程时程序锁定

> ID：15839865
> 
> 赞同：1
> 
> 时间：2013-04-05T17:24:38.663
> 
> 标签：java, multithreading

这是我在这里的第一篇文章，所以希望一切都好。

我在netbeans。我用按钮等制作了一个窗口。

我有一个名为 SimpleThread 的类，如下所示：

```
public class SimpleThread extends Thread {

public SimpleThread()
{

}

@Override
public void run()
{

} 
```

而且我有不同种类的子类线程，它们扩展了 simplethread（TimerThread、MouseGrabThread）。

```
public class MouseGrabThread extends SimpleThread{

private Point pt;
private JTextField x, y;

public MouseGrabThread(JTextField x, JTextField y)
{
    super();
    this.x = x; 
    this.y = y;
}

@Override
public void run()
{
    while(this.isAlive())
    {
        int[] xyVal = new int[2];
        xyVal = getCoords();
        x.setText("" + xyVal[0]);
        y.setText("" + xyVal[1]);
    }
}

public int[] getCoords()
{
    Point pt = MouseInfo.getPointerInfo().getLocation();

    int[] retArr = new int[2];
    retArr[0] = (int)pt.getX();
    retArr[1] = (int)pt.getY();

    return retArr;

}

public class TimerThread extends SimpleThread {

private JTextArea label;
private int time;

public TimerThread(JTextArea label, int time)
{
    super();
    this.label = label;
    this.time = time;
}

@Override
public void run()
{
    int counter = time;
    while(counter != -1)
    {

        label.setText("You have: " + counter + " seconds until the timer ends!\n");
        counter--;
        try {
            this.sleep(1000);
        } catch (InterruptedException ex) {
            System.out.println("Thread Interrupted");
        }

    }
    stop();
} 
```

在我的 UI Window 类中，我有这个：

```
private void jButton2MouseClicked(java.awt.event.MouseEvent evt) {                                      
   SimpleThread timer = new TimerThread(jTextArea1, 10); //This counts down from 10 seconds and updates a status text box each second
   SimpleThread mouseGrab = new MouseGrabThread(jTextField1, jTextField2); //This grabs mouse coords and updates two boxes in the UI.
   timer.start();
   if(timer.isAlive())
   {
      mouseGrab.start();
   }
   while(timer.isAlive())//######
   {
       if(!mouseGrab.isAlive())
       {
           mouseGrab.start();
       }
   }
} 
```

当我按下按钮时，程序会冻结 10 秒钟。

我猜我标记的行 (//#####) 是导致 UI 在计时器持续时间内冻结的行，因为它在主线程中运行。我不知道如何纠正这个。

请原谅我缺乏编程知识，当我在大学里上一门关于数据结构的非常简单的课程时，我现在才自己进入线程。如果可能的话，你能不能尽可能地把答案“哑巴”下来？

另外，我知道我这样做很糟糕，但是我调用了 stop() 函数，即使它不好（不要为此开枪，我不知道该怎么做！）如果有人可以回答这对我来说如何做得很好，太棒了！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-05T17:36:50.250

您可能想要的是`mouseGrab`在倒计时结束时结束：

```
private void jButton2MouseClicked(java.awt.event.MouseEvent evt) {                                      
   SimpleThread timer = new TimerThread(jTextArea1, 10); //This counts down from 10 seconds and updates a status text box each second
   SimpleThread mouseGrab = new MouseGrabThread(jTextField1, jTextField2); //This grabs mouse coords and updates two boxes in the UI.

   mouseGrab.start();
   timer.start();

   // Wait until countdown finishes
   while(timer.isAlive()) {}

   mouseGrab.stop();
} 
```

在您粘贴的代码中，您`mouseGrab`在`timer`运行时一直在启动。您可能更希望在定时器开启时​​让鼠标抓取运行。

**编辑**：确实，`stop()`不推荐使用，你真的应该`boolean running`在你的中使用一个属性`TimerThread`并将其`run()`方法的内容包装在一些

```
while (running) {
    /* stuff */
} 
```

然后用一些二传手在外部“停止”这个线程。正确的答案将是例如：

```
 mouseGrab.start();
   timer.start();

   // Wait until countdown finishes
   while(timer.isAlive()) {}

   mouseGrab.setRunning(false);
} 
```

**Edit2**：这最终似乎是你想要的：

```
private void jButton2MouseClicked(java.awt.event.MouseEvent evt) {                                      
   SimpleThread mouseGrab = new MouseGrabThread(jTextField1, jTextField2); //This grabs mouse coords and updates two boxes in the UI.
   SimpleThread timer = new TimerThread(mouseGrab, jTextArea1, 10); //This counts down from 10 seconds and updates a status text box each second

   mouseGrab.start();
   timer.start();
} 
```

和：

```
public class MouseGrabThread extends SimpleThread {

    private Point pt;
    private JTextField x, y;
    private boolean running;

    public MouseGrabThread(JTextField x, JTextField y) {
        super();
        this.x = x; 
        this.y = y;
    }

    @Override
    public void run() {
        running = true;
        while(running) {
            int[] xyVal = new int[2];
            xyVal = getCoords();
            x.setText("" + xyVal[0]);
            y.setText("" + xyVal[1]);
        }
    }

    public int[] getCoords() {
        Point pt = MouseInfo.getPointerInfo().getLocation();

        int[] retArr = new int[2];
        retArr[0] = (int)pt.getX();
        retArr[1] = (int)pt.getY();

        return retArr;

    }

    public void break() {
        this.running = false;
    }
}

// ------------- //

public class TimerThread extends SimpleThread {

    private MouseGrabThread mouseGrab;
    private JTextArea label;
    private int time;

    public TimerThread(MouseGrabThread mouseGrab, JTextArea label, int time)
    {
        super();
        this.label = label;
        this.time = time;
        this.mouseGrab = mouseGrab;
    }

    @Override
    public void run()
    {
        int counter = time;
        while(counter != -1)
        {
            label.setText("You have: " + counter + " seconds until the timer ends!\n");
            counter--;
            try {
                this.sleep(1000);
            } catch (InterruptedException ex) {
                System.out.println("Thread Interrupted");
            }

        }

        mouseGrab.break();
    }
} 
```

# javascript - 在返回键上提交表单时遇到问题

> ID：15839870
> 
> 赞同：0
> 
> 时间：2013-04-05T17:24:52.930
> 
> 标签：javascript, forms

我在页面上有一个表单，它只是电子邮件的一个输入字段和一个提交电子邮件并将其写入 TXT 文件的按钮。

它连接到将其写入 TXT 文件的 JS 脚本：

```
if ($('#subscribe').is(":visible")) {

    $("#subscribe button").click(function() {

        var email   = $("#email").val();
        var emailReg =  /^[a-zA-Z0-9._+-]+@[a-zA-Z0-9-]+\.[a-zA-Z]{2,4}(\.[a-zA-Z]{2,3})?(\.[a-zA-Z\s\s*]{2,3})?[-a-zA-Z0-9_:,.\s]$/ ;

        // client-side validation

         if(emailReg.test(email) == false)
            return false;

        $.ajax({
            type: "post",
            dataType: "json",
            url: "save-email.php",
            data: $("#subscribe").serialize(),
            success: function(data) {

                $('#subscribe').html('<p > <img style="position:relative; bottom:45px;left:30px;"src="assets/img/confirm.png" /></p>');

            }
        });

        return false;
    });

}; 
```

当用户单击返回时，我需要将电子邮件提交到 TXT 文件。我似乎无法让它工作。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-05T17:30:25.463

试试这个

```
if ($('#subscribe').is(":visible")) {
    function submit() {

        var email   = $("#email").val();
        var emailReg =  /^[a-zA-Z0-9._+-]+@[a-zA-Z0-9-]+\.[a-zA-Z]{2,4}(\.[a-zA-Z]{2,3})?(\.[a-zA-Z\s\s*]{2,3})?[-a-zA-Z0-9_:,.\s]$/ ;

        // client-side validation

         if(emailReg.test(email) == false)
            return false;

        $.ajax({
            type: "post",
            dataType: "json",
            url: "save-email.php",
            data: $("#subscribe").serialize(),
            success: function(data) {

                $('#subscribe').html('<p > <img style="position:relative; bottom:45px;left:30px;"src="assets/img/confirm.png" /></p>');

            }
        });

        return false;
    }
    $("#subscribe button").click(submit);
    $("form").submit(submit);

}; 
```

`$("#subscribe button").click(submit);`注意：如果您将此按钮转换为输入类型为提交，则可以删除

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-05T17:36:03.510

好吧，我不是很清楚你想问什么，但据我所知，你可以使用任何服务器端语言，通过使用 AJAX 函数将你的“电子邮件”javascript变量内容传递给服务器，然后在后端你可以做到无论您想要图像、文本或任何内容，我都不知道您使用的是哪种服务器端语言，我是 PHP 开发人员，因此 PHP 可以很容易地处理它。

# java - 解释 Eclipse 内存分析器

> ID：15839871
> 
> 赞同：7
> 
> 时间：2013-04-05T17:24:53.460
> 
> 标签：java, memory-management, memory-leaks, eclipse-memory-analyzer

我已经使用该工具运行了我的一个堆文件，下面是 Leak Hunter 的结果。嫌疑人 2 我猜是由于我正在汇集的性质，所以连接一直都是活跃的。我无法很好地解释嫌疑人 1，因为当我按下详细信息时，它会给出一长串以下详细信息

```
java.lang.ref.Finalizer @ 0xf5e19670 40 92,688 
next java.lang.ref.Finalizer @ 0xf5e1a6a8 40 93,024 
next java.lang.ref.Finalizer @ 0xf5e1bda0 40 122,768 

Suspect 1.

The class "java.lang.ref.Finalizer", loaded by "<system class loader>", occupies 1,337,176 (30.93%) bytes. The memory is accumulated in one instance of "java.lang.ref.Finalizer" loaded by "<system class loader>".

Keywords
java.lang.ref.Finalizer

Suspect 2
 6 instances of "com.mysql.jdbc.JDBC4Connection", loaded by "sun.misc.Launcher$ExtClassLoader @ 0xf58bf000" occupy 432,624 (10.01%) bytes. 

Biggest instances:

•com.mysql.jdbc.JDBC4Connection @ 0xf61c54f8 - 94,864 (2.19%) bytes. 
•com.mysql.jdbc.JDBC4Connection @ 0xf61c4678 - 86,600 (2.00%) bytes. 
•com.mysql.jdbc.JDBC4Connection @ 0xf61c4bf8 - 85,456 (1.98%) bytes. 
•com.mysql.jdbc.JDBC4Connection @ 0xf626c348 - 68,000 (1.57%) bytes. 
•com.mysql.jdbc.JDBC4Connection @ 0xf626c7d0 - 68,000 (1.57%) bytes. 

Keywords
com.mysql.jdbc.JDBC4Connection
sun.misc.Launcher$ExtClassLoader @ 0xf58bf000 
```

# sql - 链接服务器 [ORA] 的 OLE DB 提供程序 [OraOLEDB.Oracle] 返回消息 ORA-00936：缺少表达式

> ID：15839876
> 
> 赞同：0
> 
> 时间：2013-04-05T17:25:19.020
> 
> 标签：sql, sql-server, sql-server-2008, oracle11g

我在使用 OPENQUERY 时遇到了一些问题。

我有这个简单的链接服务器 SQL：

```
SELECT [ITEM_SERIAL].[SERIAL_NO]
       , [ITEM_SERIAL].[SUB_SEQ_NO_FIRM]
       , [ITEM_SERIAL].[ITEM_NO]
FROM [ORA]..[SSDIGICO].[ITEM_SERIAL]
ORDER BY [ITEM_SERIAL].[SERIAL_NO] 
```

这运行顺利，没问题...

现在我正在尝试使用 OPENQUERY 方法来提高性能，例如：

```
SELECT * FROM OPENQUERY(ORA,'
    SELECT [ITEM_SERIAL].[SERIAL_NO]
       , [ITEM_SERIAL].[SUB_SEQ_NO_FIRM]
       , [ITEM_SERIAL].[ITEM_NO]
    FROM [SSDIGICO].[ITEM_SERIAL]
    ORDER BY [ITEM_SERIAL].[SERIAL_NO]
') 
```

由于某种原因，我收到以下错误消息：

> 链接服务器“ORA”的 OLE DB 提供程序“OraOLEDB.Oracle”返回消息“ORA-00936：缺少表达式”。消息 7321，级别 16，状态 2，第 1 行准备查询时发生错误“

有没有人知道我为什么会收到这个错误？

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-05T17:32:39.853

Oracle 不在表或列周围使用方括号。代码应该是：

```
SELECT * FROM OPENQUERY(ORA,'
    SELECT ITEM_SERIAL.SERIAL_NO
       , ITEM_SERIAL.SUB_SEQ_NO_FIRM
       , ITEM_SERIAL.ITEM_NO
    FROM SSDIGICO.ITEM_SERIAL
    ORDER BY ITEM_SERIAL.SERIAL_NO
') 
```

# toggle - Google Fusion Table Layer 默认关闭

> ID：15839880
> 
> 赞同：0
> 
> 时间：2013-04-05T17:25:24.003
> 
> 标签：toggle, google-fusion-tables, layer

Stackoverflow 是一个非常棒的网站！！！我在这里学到了很多，

现在我正在尝试为我的社区做一些好事：带有一些融合表和一些自定义基础地图的 gmaps v3...

我在看这个例子：[http](http://www.geocodezip.com/v3_SO_FusionTables_toggle.html) ://www.geocodezip.com/v3_SO_FusionTables_toggle.html 。我希望在加载页面上关闭图层：有什么建议吗？

提前致谢

安德烈亚

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-05T20:08:48.353

取消选中这些框：

```
 <input type="checkbox" id="show_hide_layer1" onchange="toggleLayer(layer1)"/>
  <label> old boundaries </label>
  <input type="checkbox" id="show_hide_layer2" onchange="toggleLayer(layer2)"/>
  <label> new boundaries </label> 
```

不要设置图层的地图属性：

```
 layer1 = new google.maps.FusionTablesLayer({
    query: {
      select: 'col2',
      from:'1NxFkNmdXHOvvWNnaWscabdxUDQqDul1BpiINtHI'
    }
  });
  layer2 = new google.maps.FusionTablesLayer({
    query: {
      select: 'col2',
      from:'1aM37b7PzUg3nqF14L4GzDbSrUGAfWOuIGcbkV2c'
    }
  }); 
```

# sql-server - 为什么 cte recursive 只返回第一行？

> ID：15839884
> 
> 赞同：-1
> 
> 时间：2013-04-05T17:25:43.820
> 
> 标签：sql-server, common-table-expression

请有人看看这个 CTE 并告诉我它有什么问题？它只返回第一行（锚点）。

**编辑：** 这个应该可以工作，但我想知道表格和数据有什么问题！！！

```
Create table Menus (MenuID uniqueidentifier primary key, MenuName nvarchar(100))
Create table MenuItems (MenuItemID uniqueidentifier primary key, PID uniqueidentifier null, MenuID uniqueidentifier not null, MenuItemName nvarchar(100) not null)

insert into Menus values ('3AB564A7-1D2C-4C43-91E3-A191016CBE67', 'Main')

insert into MenuItems values ('D3B92D1B-7AFA-4E11-AF01-9F6A00B1B2A9', '00000000-0000-0000-0000-000000000000', '3AB564A7-1D2C-4C43-91E3-A191016CBE67', 'Books')
insert into MenuItems values ('70575C44-1EF8-497F-B7B8-A18300F645D7', '00000000-0000-0000-0000-000000000000', '3AB564A7-1D2C-4C43-91E3-A191016CBE67', 'CDs')
insert into MenuItems values ('2D6ED5B3-4C6A-4907-8571-A196009727D7', '00000000-0000-0000-0000-000000000000', '3AB564A7-1D2C-4C43-91E3-A191016CBE67', 'DVDs')
insert into MenuItems values ('3A1096E7-5FD2-4F77-9729-A19600973BDF', '2D6ED5B3-4C6A-4907-8571-A196009727D7', '3AB564A7-1D2C-4C43-91E3-A191016CBE67', 'Movies')
insert into MenuItems values ('5C2AC1F8-DEE0-448B-B538-A19600F0839B', '00000000-0000-0000-0000-000000000000', '3AB564A7-1D2C-4C43-91E3-A191016CBE67', 'Cassetes')
GO

declare @MenuID uniqueidentifier
set @MenuID = '3AB564A7-1D2C-4C43-91E3-A191016CBE67'
;WITH 
cte (MenuItemID, PID, Lvl) 
AS 
    (
    select MenuID as MenuItemID, cast(null as uniqueidentifier) as PID, 1
        from Menus where MenuID = @MenuID
    union all
    select MenuItems.MenuItemID
            , PID = case MenuItems.pid when '00000000-0000-0000-0000-000000000000' then @MenuID else MenuItems.pid end
            , cte.Lvl + 1 
        from MenuItems
            inner join cte on cte.MenuItemID = MenuItems.PID
        where MenuItems.MenuID = @MenuID
    )
select * from cte 
```

**编辑：结果应该是这样的：**

```
3AB564A7-1D2C-4C43-91E3-A191016CBE67    NULL    1
D3B92D1B-7AFA-4E11-AF01-9F6A00B1B2A9    3AB564A7-1D2C-4C43-91E3-A191016CBE67    2
70575C44-1EF8-497F-B7B8-A18300F645D7    3AB564A7-1D2C-4C43-91E3-A191016CBE67    2
2D6ED5B3-4C6A-4907-8571-A196009727D7    3AB564A7-1D2C-4C43-91E3-A191016CBE67    2
5C2AC1F8-DEE0-448B-B538-A19600F0839B    3AB564A7-1D2C-4C43-91E3-A191016CBE67    2
3A1096E7-5FD2-4F77-9729-A19600973BDF    2D6ED5B3-4C6A-4907-8571-A196009727D7    3 
```

提前致谢！

卡多

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-05T17:41:04.083

问题似乎在

```
 inner join cte on cte.MenuItemID = MenuItems.PID 
```

因为 MenuItemID 和 PID 不会匹配。

提供表结构和样本数据以供进一步分析和实际模拟问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-05T18:47:35.630

最后我使用子查询解决了我的问题：

```
declare @MenuID uniqueidentifier
set @MenuID = '3AB564A7-1D2C-4C43-91E3-A191016CBE67'
;WITH 
cte (MenuItemID, PID, Lvl) 
AS 
    (
    select MenuID as MenuItemID, cast(null as uniqueidentifier) as PID, 1
        from Menus where MenuID = @MenuID
    union all 
    select mi.MenuItemID, mi.PID, cte.Lvl + 1  from (select MenuItems.MenuItemID
            , PID = case MenuItems.pid when '00000000-0000-0000-0000-000000000000' then @MenuID else MenuItems.pid end
        from MenuItems
        where MenuItems.MenuID = @MenuID) as mi
            inner join cte on cte.MenuItemID = mi.PID
    )
select * from cte 
```

非常感谢那些试图帮助我的人:)

# adobe - adobe 连接跨域过滤器

> ID：15839891
> 
> 赞同：0
> 
> 时间：2013-04-05T17:26:19.310
> 
> 标签：adobe, cross-domain, jetty, adobe-connect

我正在创建一个 Web 应用程序来检查其他站点和服务的状态。一页检查其他站点是否在其他域上。大多数网站都使用 IIS7，因此我只需添加一个 http 响应标头即可允许从托管我的页面的域进行访问：

```
Access-Control-Allow-Origin, * 
```

我的问题是我必须检查的一件事是 adobe 连接服务器是否已启动，并且它使用 Jetty。我看了这两页：

*   [码头跨源过滤器](https://stackoverflow.com/questions/8303162/jetty-cross-origin-filter)
*   [http://wiki.eclipse.org/Jetty/Feature/Cross_Origin_Filter](http://wiki.eclipse.org/Jetty/Feature/Cross_Origin_Filter)

我下载了`jetty-servlet.jar`，把它放在我的`E:\Breeze\8.2.0.1\appserv\web\WEB-INF\lib`文件夹中，然后在我的文件中添加以下行`E:\Breeze\8.2.0.1\appserv\web\WEB-INF\web.xml` ：

```
<web-app ...>
    ...
    <filter>
        <filter-name>cross-origin</filter-name>
        <filter-class>org.eclipse.jetty.servlets.CrossOriginFilter</filter-class>
    </filter>
    <filter-mapping>
        <filter-name>cross-origin</filter-name>
        <url-pattern>//*</url-pattern>
    </filter-mapping>
    ...
</web-app> 
```

但是当我这样做时，当我尝试在网络浏览器中访问该站点时，我得到一个 404 The requested resource () is not available。

我使用的是 java 1.6 版，我已经尝试`jetty-serlet.jar`了上面网站上列出的每个版本。

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-11T01:21:07.593

首先，标准的 Connect 安装使用的是 Tomcat，而不是 Jetty。（除非您选择在 Jetty 上运行 CPS。）但我认为 CrossOriginFilter 也适用于 Tomcat。

为什么 url 模式中的额外斜线？你不想：

```
<url-pattern>/*</url-pattern> 
```

容器或 CPS 日志中是否有您的请求的任何痕迹？

# multithreading - 将 CreateThread 调用移植到 Win8/WinRT 应用程序

> ID：15839895
> 
> 赞同：1
> 
> 时间：2013-04-05T17:26:46.713
> 
> 标签：multithreading, winapi, windows-8, winrt-async

我需要从我的 C# Win8/WinRT 应用程序中调用 C++ 库。

该库是多线程的，并通过调用 Win32 API（`WaitForSingleObject`等）来管理线程。我能够找出所有这些调用的替代品（总是有一个`...Ex`可用于应用程序的版本，例如，如果您正在寻找它，请`WaitForSingleObjectEx`从[那里查看）。](http://msdn.microsoft.com/en-us/library/windows/desktop/ms686360%28v=vs.85%29.aspx)`<synchapi.h>`

但是有一个调用我无法弄清楚如何替换：它是对[`CreateThread`函数](http://msdn.microsoft.com/en-us/library/windows/desktop/ms682453%28v=vs.85%29.aspx)的调用。没有等价物，所以看起来这样的线程创建现在必须通过新的 API。

但我还没有深入研究 WinRT 上的新线程模型。根据您的经验，移植此线程创建调用的正确方法是什么？唯一的限制是它是一个 C++ 库，我将其构建为“WinApp 的 C++ 库”项目。

**加起来：**

在我为我的应用程序链接的库中，线程是通过[`CreateThread`Win32 API call](http://msdn.microsoft.com/en-us/library/windows/desktop/ms682453%28v=vs.85%29.aspx)创建的。我需要将这些调用更改为什么才能在我的应用程序环境中运行？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-08T17:40:13.797

你是对的：你不能简单地用一个新的调用替换 CreateThread。您必须将线程代码移植到新的 API。

根据我的经验，如果您希望更轻松地将代码移植到 WinRT ThreadPool 模型，Raman Sharma 发布的[链接是一个很好的参考。](http://blogs.msdn.com/b/shawnhar/archive/2012/03/12/createthread-for-windows-8-metro.aspx?PageIndex=2)我已经成功地使用在那里找到的 shim 来实现一个 Win32 线程仿真层，我的旧的 Win32 相关代码可以与之交互。

# spring-security - 覆盖消息 [LDAP：错误代码 32 - 无此类对象]；嵌套异常是 javax.naming.NameNotFoundException

> ID：15839898
> 
> 赞同：0
> 
> 时间：2013-04-05T17:26:56.497
> 
> 标签：spring-security, spring-ldap

我正在使用 Spring LDAP 安全性对用户进行身份验证。在我的 .jsp 中，我有：

```
<c:if test="${not empty param.login_error}">
   <div class="errorText">${sessionScope['SPRING_SECURITY_LAST_EXCEPTION'].message}</div>
</c:if> 
```

我成功地覆盖了 Springframework/security 中的默认消息，并将它们从 Bad credentials 更改为 Incorrect username/password。

**我的问题：** 当我输入无效的 LDAP 用户时，我收到正确的错误消息：

```
[LDAP: error code 32 - No Such Object]; nested exception is javax.naming.NameNotFoundException: [LDAP: error code 32 - No Such Object]; remaining name '' 
```

**我想要的：**用更用户友好的消息覆盖此消息，就像我覆盖了 Bad credentials 消息一样。

在此先感谢您的任何建议。

# ios - 使用 CoreData 保存用户文章 - 如何让所有文章都保留在 UITableView 中？

> ID：15839913
> 
> 赞同：1
> 
> 时间：2013-04-05T17:28:02.870
> 
> 标签：ios, objective-c, uitableview, core-data

我还是 CoreData 的新手，但我觉得我对保存和检索过程有了很好的理解。但是，在检索我们如何使其“无缝”时，我感到困惑，就像它从未离开过一样（也许它永远不会离开，我只是不理解）。

我的 UITableView 的模型`NSArray`充满了`Article`对象。该列表是从文章中填充的。

添加每篇新文章后，我都会将其保存到 CoreData 存储中，因此如果应用程序崩溃或遇到什么问题，我会将其保存。但是，当用户重新打开它时，即使它在后台退出后，我如何让它立即出现？

我可以用核心数据的内容填充文章的 NSArray，但这需要一点时间，然后 tableview 数据源必须从中填充 tableview，所以这几乎不是即时的。

有没有办法让 UITableView 的数据源成为 CoreData？也许我只是真的误会了。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-05T17:32:04.477

是的，实际上创建一个 Core Data 支持的 TableView 控制器非常容易。事实上，如果您创建一个全新的项目并选中“使用核心数据”复选框，它会自动为您设置它。

神奇之处在于使用 an`NSFetchedResultsController`来填充表格。雷在[这里](http://www.raywenderlich.com/999/core-data-tutorial-how-to-use-nsfetchedresultscontroller)有一个很棒的教程。

基本上，Core Data 充当表视图的数据源，在需要显示时将正确的记录交给它。

另请参阅[Apple 的文档](http://developer.apple.com/library/ios/#documentation/UserExperience/Conceptual/TableView_iPhone/AboutTableViewsiPhone/AboutTableViewsiPhone.html#//apple_ref/doc/uid/TP40007451)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-05T17:32:45.497

阅读[NSFetchedResultsController](http://developer.apple.com/library/ios/#documentation/CoreData/Reference/NSFetchedResultsController_Class/Reference/Reference.html)。它与 Core Data 无缝集成。

# javascript - Javascript将对象值分配给新对象

> ID：15839921
> 
> 赞同：1
> 
> 时间：2013-04-05T17:28:26.703
> 
> 标签：javascript, oop

所以我使用选项以文字对象方式将值传递给新对象。

```
var obj = new myObject({height:'500',width:'300');

function myObject(options){

} 
```

我不确定将这些值分配给对象的最佳途径，但这样才能奏效。

```
 function myObject(options){

...assignment...   

alert(this.width);

    } 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-04-05T17:31:27.640

```
function myObject(options){

   // copy the options into the current object
   for (var key in options) {
       if (options.hasOwnProperty(key)) {
           this[key] = options[key];
       }
   }

   alert(this.width);     // 300
}

var obj = new myObject({height:'500',width:'300'}); 
```

您甚至可以*扩展*此概念，您可以在其中拥有*默认*属性值`myObject`，并且可以使用`options`对象覆盖它们：

```
function myObject(options){
    // DEFAULTS
    this.name = 'Box';
    this.width = '100';
    this.height = '100';

   // copy the options into the current object
   for (var key in options) {
       if (options.hasOwnProperty(key)) {
           this[key] = options[key];
       }
   }

   alert(this.width); 
}

var obj = new myObject({height:'500',width:'300'});     // alert: 300
var obj2 = new myObject({height: '500'});               // alert: 100 
```

# prolog - 从 8-Queens 解决方案到 Prolog 中更通用的 n-Queens 解决方案

> ID：15839923
> 
> 赞同：2
> 
> 时间：2013-04-05T17:28:35.197
> 
> 标签：prolog, n-queens

我正在为大学考试学习 Prolog，但我对以下练习有一些问题。

我有以下 8 皇后问题的经典解决方案（这对我来说不是问题），修改这个解决方案我必须为处理可变数量皇后的更通用的 n 皇后问题创建一个新的解决方案。

```
solution([]).

solution([X/Y|Others]) :- solution(Others),
                          member(Y,[1,2,3,4,5,6,7,8]),
                          noattack(X/Y, Others).

noattack(_,[]).

noattack(X/Y, [X1/Y1 | Others]) :-
                      Y =\= Y1,       % Q e Q1 sono su righe diverse
                      % Q e Q1 sono su diagonali diverse:
                      Y1-Y =\= X1-X,
                      Y1-Y =\= X-X1,
                      % Q non attacca regine nella sottolista Others:
                      noattack( X/Y, Others).

% TEMPLATE DELLE SOLUZIONI: c'è una regina su ogni colonna:
template([1/Y1,2/Y2,3/Y3,4/Y4,5/Y5,6/Y6,7/Y7,8/Y8]). 
```

好的，这个程序看起来很简单：我有一个女王列表，他们不能互相攻击。

**如果女王列表为空，则女王不可能攻击列表中的另一个女王，因此空列表是问题的解决方案（它是解决方案的基本情况）**

**如果皇后列表不为空，我可以将其划分为 [X/Y|Others] 其中 X/Y 在列表中第一个皇后的棋盘上的*位置* （位置是夫妇的 rappresentend (X,Y ) 其中 X 是列，Y 是行)

因此，如果以下关系为真，则列表 [X/Y|Others] 是问题的解决方案是真的：

1.  **子列表 Others 本身就是一个解决方案（Others 不包含攻击列表中其他女王的女王）**

2.  **Y 属于 1 到 8 之间的整数值**（因为我有 8 行）

3.  **列表的第一个女王不要攻击子列表中的其他女王**

然后定义了**noattack**关系，它指定我什么时候可以说一个女王不攻击另一个女王是真的（这很简单：他们不能停留在同一行，同一列，同一对角线）

最后，我有一个**解决方案模板**，可以简化我的生活，将 X 值限制在 1 到 8 之间（因为我知道 2 个皇后不能留在同一列……所以解决方案中的每个皇后都留在不同的列所有其他皇后）

所以我认为最大的问题在于我指定列数的那一行：

```
member(Y,[1,2,3,4,5,6,7,8]) 
```

在我定义解决方案模板的那一行：

```
template([1/Y1,2/Y2,3/Y3,4/Y4,5/Y5,6/Y6,7/Y7,8/Y8]). 
```

我不知道如何扩展以前的解决方案来处理可变数量的皇后。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-05T19:42:11.587

似乎很容易，传递大小：

```
solution(_, []).
solution(N, [X/Y|Others]) :-
    solution(N, Others),
    between(1, N, Y),
    noattack(X/Y, Others).

noattack(_,[]).
noattack(X/Y, [X1/Y1 | Others]) :-
    Y =\= Y1,       % Q e Q1 sono su righe diverse
    Y1-Y =\= X1-X,  % Q e Q1 sono su diagonali diverse
    Y1-Y =\= X-X1,
    noattack( X/Y, Others). % Q non attacca regine nella sottolista Others

% TEMPLATE DELLE SOLUZIONI: c'è una regina su ogni colonna:
template(N, L) :-
    findall(I/_, between(1,N,I), L). 
```

测试：

```
?- N=6, template(N, L), solution(N, L).
N = 6,
L = [1/5, 2/3, 3/1, 4/6, 5/4, 6/2] ;
N = 6,
L = [1/4, 2/1, 3/5, 4/2, 5/6, 6/3] ;
N = 6,
L = [1/3, 2/6, 3/2, 4/5, 5/1, 6/4] ;
N = 6,
L = [1/2, 2/4, 3/6, 4/1, 5/3, 6/5] ;
false. 
```

（我应该画出来说好不好……）

# asp.net-mvc-3 - 自动完成的 url.action

> ID：15839927
> 
> 赞同：1
> 
> 时间：2013-04-05T17:28:44.430
> 
> 标签：asp.net-mvc-3

在回复的帮助下，我将代码更改为

```
@Html.TextBoxFor(per => per.Hospital, new { style = "width:220px", @maxlength = "50", data_autocomplete = Url.Action("HospitalList", "Person") }) 
```

我的jQuery是

```
$(document).ready(function () {        
    $('input[data_autocomplete]').each(function () {
        var url = $(this).data('autocomplete');
        $(this).autocomplete({
            source: function (request, response) {
                $.getJSON(url, {
                    term: request.term
                }, response);
            }
        });
    });
}); 
```

并创建了一个新的 Action 结果

```
 public ActionResult HospitalList(string term)
    {
        List<string> result = new List<string>();
        result.Add("Hospital 1");
        result.Add("NYUMC");
        result.Add("Christ");
        result.Add("Bellevue");
        result.Add("NewYork-Presbyterian");
        result.Add("North Central Bronx Hospital");            

        return Json(result , JsonRequestBehavior.AllowGet);
    } 
```

现在我要去哪里wromg。我只看到一个文本框，没有自动完成的行为。我是否应该包含任何 jquery 库以使其正常工作

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-05T17:39:17.713

您还没有显示您正在使用哪个自动完成插件。如果是，[`jQuery UI autocomplete`](http://jqueryui.com/autocomplete/)您可以从控制器操作中将过滤后的结果作为 JSON 返回：

```
[HttpGet]
public ActionResult PersonSearch(string term)
{
    // The term parameter will contain the value entered by the user in the textbox.
    // here you could use it and query your database in order to filter the results.
    string[] result = new string[]
    {
        "filtered value 1",
        "filtered value 2",
        "filtered value 3",
        "filtered value 4",
    };

    return Json(result, JsonRequestBehavior.AllowGet);
} 
```

最后，您将附加插件：

```
$(function() {
    $('input[data-autocomplete]').each(function() {
        var url = $(this).data('autocomplete');
        $(this).autocomplete({
            source: function(request, response) {
                $.getJSON(url, {
                    term: request.term
                }, response);
            }
        });
    });
}); 
```

请注意控制器操作如何获取`term`参数并应返回 JSON 格式的字符串列表。

# image-processing - 如何检测图像何时失焦？

> ID：15839928
> 
> 赞同：11
> 
> 时间：2013-04-05T17:28:48.460
> 
> 标签：image-processing, focus

有时，我们的光学检测系统会失焦，从而导致无意义的测量。我的任务是开发一种“失焦”检测器，用于驱动相机系统的 Z 轴。我可用的图像是bmp。

我正在寻找方法和算法进行调查。例如，我应该隔离特征并测量一致性还是可以使用边缘检测？

这是焦点图像：

![焦点](https://farm9.staticflickr.com/8402/8622674296_8973977730_m.jpg)

这是失焦图像：

![失焦](https://farm9.staticflickr.com/8534/8621571531_c49cc2017c_m.jpg)

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-04-05T17:51:57.003

关键是对焦图像具有更强的梯度和清晰的特征。所以我的建议是应用高斯拉普拉斯滤波器，然后查看结果的像素值分布。下图显示了这个想法在您的图像中的应用，其中黑色表示失焦图像，红色表示聚焦图像。焦点对准的具有更高的值（因为图像具有更锐利的渐变）。

当您有直方图时，您可以通过比较例如分布的 90% 百分位（对尾部敏感）来区分一个。对于失焦图像，它是 7，对于对焦图像，它是 13.6（因此是差异的两倍）。

![在此处输入图像描述](https://i.stack.imgur.com/KzoAV.png)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-05T17:55:14.393

对比度算法的一个快速而肮脏的版本是对相邻像素之间的差异求和 - 更高的和是更多的对比度。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2018-06-05T15:13:06.073

这就是我在 OpenCV 中检测焦点质量的方法：

```
Mat grad;
int scale = 1;
int delta = 0;
int ddepth = CV_8U;
Mat grad_x, grad_y;
Mat abs_grad_x, abs_grad_y;
/// Gradient X
Sobel(matFromSensor, grad_x, ddepth, 1, 0, 3, scale, delta, BORDER_DEFAULT);
/// Gradient Y
Sobel(matFromSensor, grad_y, ddepth, 0, 1, 3, scale, delta, BORDER_DEFAULT);
convertScaleAbs(grad_x, abs_grad_x);
convertScaleAbs(grad_y, abs_grad_y);
addWeighted(abs_grad_x, 0.5, abs_grad_y, 0.5, 0, grad);
cv::Scalar mu, sigma;
cv::meanStdDev(grad, /* mean */ mu, /*stdev*/ sigma);
focusMeasure = mu.val[0] * mu.val[0]; 
```

# ios - 使用 NSSet 进行类跟踪和限制实例

> ID：15839929
> 
> 赞同：5
> 
> 时间：2013-04-05T17:28:48.877
> 
> 标签：ios, objective-c

我希望我的班级检测到一个新实例与某些现有实例等效（相对于 vis `isEqual`: 和`hash`），并且只创建唯一实例。这是我认为可以完成工作的代码，但我担心它会做一些我无法发现的愚蠢的事情......

假设它是这样的 NSURLRequest 子类：

```
// MyClass.h
@interface MyClass : NSMutableURLRequest
@end

// MyClass.m

@implementation MyClass

+ (NSMutableSet *)instances {

    static NSMutableSet *_instances;
    static dispatch_once_t once;

    dispatch_once(&once, ^{ _instances = [[NSMutableSet alloc] init];});
    return _instances;
}

- (id)initWithURL:(NSURL *)URL {

    self = [super initWithURL:URL];
    if (self) {
        if ([self.class.instances containsObject:self])
            self = [self.class.instances member:self];
        else
            [self.class.instances addObject:self];
    }
    return self;
}

// Caller.m
NSURL *urlA = [NSURL urlWithString:@"http://www.yahoo.com"];

MyClass *instance0 = [[MyClass alloc] initWithURL: urlA];
MyClass *instance1 = [[MyClass alloc] initWithURL: urlA];  // 2

BOOL works = instance0 == instance1;  // works => YES, but at what hidden cost? 
```

问题：

1.  在 init 中对 self 的第二个赋值看起来很奇怪，但并不疯狂。或者是吗？
2.  认为第二个分配（实例1）被神奇地清理干净只是一厢情愿的编码吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-05T17:33:24.867

1.  这并不疯狂，但在手动保留/释放模式下，您确实需要`self`事先释放，否则每次运行此方法时都会泄漏一个未初始化的对象。在 ARC 中，原始实例会自动为您释放。

2.  见#1。

### 顺便说一句，对于任何通常只停留在一个答案的读者，下面的 bbum 答案包括一个线程安全实现的完整工作示例。强烈推荐给任何做这件事的人。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-04-05T18:00:20.033

假设您真的想通过 URL 唯一，想一个更好的方法（行下方的原始答案）。如果不是，这也演示了同步原语的使用。

```
@interface UniqueByURLInstances:NSObject
@property(strong) NSURL *url;
@end

@implementation UniqueByURLInstances
static NSMutableDictionary *InstanceCache()
{
    static NSMutableDictionary *cache;
    static dispatch_once_t onceToken;
    dispatch_once(&onceToken, ^{
        cache = [NSMutableDictionary new];
    });
    return cache;
}

static dispatch_queue_t InstanceSerializationQueue()
{
    static dispatch_queue_t queue;
    static dispatch_once_t onceToken;
    dispatch_once(&onceToken, ^{
        queue = dispatch_queue_create("UniqueByURLInstances queue", DISPATCH_QUEUE_SERIAL);
    });
    return queue;
}

+ (instancetype)instanceWithURL:(NSURL*)URL
{
    __block UniqueByURLInstances *returnValue = nil;
    dispatch_sync(InstanceSerializationQueue(), ^{
        returnValue = [InstanceCache() objectForKey:URL];
        if (!returnValue)
        {
            returnValue = [[self alloc] initWithURL:URL];
        }
    });
    return returnValue;
}

- (id)initWithURL:(NSURL *)URL
{
    __block UniqueByURLInstances* returnValue = self;
    dispatch_sync(InstanceSerializationQueue(), ^{
        returnValue = [InstanceCache() objectForKey:URL];
        if (returnValue) return;

        returnValue = [super initWithURL:URL];
        if (returnValue) {
            [InstanceCache() setObject:returnValue forKey:URL];
        }

        _url = URL;
    });

    return returnValue;
}

- (void)dealloc {
    dispatch_sync(InstanceSerializationQueue(), ^{
        [InstanceCache() removeObjectForKey:_url];
    });
    // rest o' dealloc dance here 
}
@end 
```

警告：上面输入了 SO - 从未运行过。我可能搞砸了。它假定 ARC 已启用。是的，当使用工厂方法时，它最终会查找 URL 两次，但是额外的查找应该会在分配和初始化的噪音中丢失。这样做意味着开发人员可以使用工厂或初始化程序，并且仍然可以看到唯一的实例**，但是**当该 URL 的实例已经存在时，在执行工厂方法时不会分配。

（如果你不能通过 URL 唯一，那么回到你的 NSMutableSet 并完全跳过工厂方法。）

* * *

查克说了什么，但还有一些额外的说明：

像这样重构你的代码：

```
+(NSMutableSet*)instances
{
    static NSMutableSet *_instances;
    dispatch_once( ...., ^{ _instances = [[NSMutableSet alloc] init];});
    return instances;
} 
```

然后在您想要访问时调用该方法`instances`。它将所有代码本地化在一个地方并将其隔离`+initialize`（这并不是什么大问题）。

如果您的类可能是从多个线程中实例化的，那么您将希望使用同步原语围绕 check-allocate-or-return。我建议使用 dispatch_queue。

# java - 完成文件的所有 Xml 文件的骆驼路线

> ID：15839931
> 
> 赞同：0
> 
> 时间：2013-04-05T17:29:03.103
> 
> 标签：java, apache-camel

我想用 Apache Camel 做一个看似简单的任务。我想监视 xml 文件的目录。当找到那些xml文件时，如果有对应的同名done文件，那么我希望camel通知我。

这是我正在使用的路线

```
from("file:/tmp?include=.*.xml&doneFileName=${file:name}.done") 
```

但它不会触发。

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-05T21:06:29.560

我认为路线没有任何问题。检查类似的东西

```
from("file:/tmp?include=.*.xml&doneFileName=${file:name}.done")
     .process(
    new Processor() {
         public void process(Exchange e) throws Exception{
        //Any logic or System.out.println("File is "+e.getIn().getBody());
         }
        }); 
```

您确定文件名与模式匹配吗？你是如何触发通知的。您确定代码是否正常或与此路线集成良好。

# android - 如何在 android 中使用共享首选项....我是初学者，所以请帮助我

> ID：15839934
> 
> 赞同：-5
> 
> 时间：2013-04-05T17:29:13.833
> 
> 标签：android, android-intent

我是android的初学者..我只擅长设计android应用程序..我不知道共享偏好..我第一次必须使用共享偏好，。所以任何人都可以在我的代码中做到这一点，以便我可以实现。以下是我的代码，请在我的代码中进行更改：告诉我如何在按钮 a 的单击上保存值，我将其临时存储在不同的变量中。

```
import android.app.Activity;
import android.content.Intent;
import android.os.Bundle;
import android.view.View;
import android.view.Window;
import android.view.WindowManager;
import android.widget.Button;
import android.widget.EditText;
import android.widget.Toast;

public class newpage extends Activity {
    String un = null;
    String pass= null;
    String fname= null;
    String lname= null;
    String age= null;
    String city= null;
    String coun= null;
    String email= null;
    String pno= null;
    String repass= null;

    @Override
    protected void onCreate(Bundle savedInstanceState){
    super.onCreate(savedInstanceState);

    requestWindowFeature(Window.FEATURE_NO_TITLE);
    this.getWindow().setFlags(WindowManager.LayoutParams.FLAG_FULLSCREEN,  
         WindowManager.LayoutParams.FLAG_FULLSCREEN);

            setContentView(R.layout.create_acc);

            final Button b = (Button) findViewById(R.id.button3);
             b.setOnClickListener(new View.OnClickListener() {
                 public void onClick(View v) {

                     Intent i = new Intent(newpage.this, SignIn.class);
                        i.addFlags(
                        Intent.FLAG_ACTIVITY_CLEAR_TOP |
                        Intent.FLAG_ACTIVITY_NEW_TASK);                 
                        startActivity(i);
                 }
             });

             final Button c = (Button) findViewById(R.id.button2);
             c.setOnClickListener(new View.OnClickListener() {
                 public void onClick(View v) {

                     Intent i = new Intent(newpage.this, CreateAcc.class);
                    i.addFlags(
                        Intent.FLAG_ACTIVITY_CLEAR_TOP |
                        Intent.FLAG_ACTIVITY_NEW_TASK);
                        startActivity(i);
                     }
             });

             final Button a = (Button) findViewById(R.id.button1);
             a.setOnClickListener(new View.OnClickListener() {

                    @SuppressLint("ShowToast")
                    public void onClick(View v){

                        EditText input1= (EditText)findViewById(R.id.fname1); 
                        fname = input1.getEditableText().toString();

                        EditText input2= (EditText) findViewById(R.id.lname1); 
                        lname = input2.getEditableText().toString();

                        EditText input3= (EditText) findViewById(R.id.age1); 
                        age = input3.getEditableText().toString();

                        EditText input4= (EditText) findViewById(R.id.city1); 
                        city = input4.getEditableText().toString();

                        EditText input5= (EditText) findViewById(R.id.country1);  
                        coun = input5.getEditableText().toString();

                        EditText input6= (EditText) findViewById(R.id.email1); 
                        email = input6.getEditableText().toString();

                        EditText input7= (EditText) findViewById(R.id.pno1);  
                        pno = input7.getEditableText().toString();

                        EditText input8= (EditText) findViewById(R.id.uname1);
                        un = input8.getEditableText().toString();

                        EditText input9= (EditText) findViewById(R.id.passwd1);
                        pass = input9.getEditableText().toString();

                        EditText input10= (EditText) findViewById(R.id.repass1); 
                         repass = input10.getEditableText().toString();

                        if((fname!=null) && (lname!=null) && (age!=null) && (city!=null) && (coun!=null) && (email!=null) && (pno!=null) && (un!=null) && (pass!=null) && (repass!=null))   
                        {   
                            if(pass == repass)
                            {
                                Toast.makeText(newpage.this, ".....Data Saved....." ,Toast.LENGTH_LONG).show();
                                Intent in = new Intent(newpage.this, SignIn.class);
                                    in.addFlags(
                                    Intent.FLAG_ACTIVITY_CLEAR_TOP |
                                    Intent.FLAG_ACTIVITY_NEW_TASK);
                                    startActivity(in);
                            }
                            else
                            {
                                Toast.makeText(newpage.this, ".....Password Doesn't Match....." ,Toast.LENGTH_LONG).show();
                            }                   
                        }
                        else
                        {
                        Toast.makeText(newpage.this, ".....Complete the Form Please....." ,Toast.LENGTH_LONG).show();
                        }
                  }
             });            
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-05T17:36:25.910

它们真的很简单。您刚刚调用了`SharedPreferences`该类来保存和检索值。最好只存储简单的值，任何复杂的都应该使用`SQLlite`：

此代码将保存电子邮件值：

```
 SharedPreferences settings = getSharedPreferences("[unique id]", Context.MODE_PRIVATE);
 SharedPreferences.Editor editor = settings.edit();

 editor.putString("email", email);
 editor.commit(); 
```

你只需要`putStrings`为其他价值创造更多。

这将检索值：

```
 String email = settings.getString("email", null); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-05T17:36:46.103

读或写给`SharedPreferences`你首先需要得到`SharedPreferences`

```
SharedPreferences prefs = getSharedPreferences(TAG, Context.MODE_PRIVATE); 
```

一旦你有了`SharedPreferences`你就可以写信给他们

```
prefs.edit().putString(KEY, VALUE).commit(); 
```

或者你可以从他们那里读到

```
prefs.getString(KEY, VALUE); 
```

差不多就是这样。首选项中的 TAG 就是您要调用的名称`SharedPreferences`- 它可以是任何字符串。一切都保存为键值对。您需要弄清楚它在代码中的位置，因为我不知道您要存储什么。

# php - html里面的php代码被注释掉了

> ID：15839939
> 
> 赞同：1
> 
> 时间：2013-04-05T17:29:30.647
> 
> 标签：php, html, wordpress

我的 php 代码是从**wordpress**页面中的 html 代码调用的。但是它正在被浏览器注释掉。编码：

```
<?php if (function_exists (gCF)) gCF(); ?> 
```

一个 div 内部的读取如下（当我在 firebug 或 chrome 中看到时）

```
<!--?php if (function_exists (gCF)) gCF(); ?--> 
```

我在网上搜索并发现了类似的问题，但遗憾的是没有合适的解决方案，也没有人提到为什么会发生这种情况。是因为doctype吗？？？

[问题 1](https://stackoverflow.com/questions/8763332/inserting-php-into-html-results-in-commented-out-code) [问题 2](https://stackoverflow.com/questions/14926372/php-in-html-files-not-running-or-being-commented-out) [问题 3](https://stackoverflow.com/questions/15098940/php-code-not-being-rendered-in-browsers) [问题 4](https://stackoverflow.com/questions/12561993/my-php-code-is-commented-out)

提前致谢。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-05T17:31:32.727

在我看来，代码位于没有`.php`扩展名的文件中，因此代码被评估为`HTML`.

如果您想`php`在 wordpress 中使用，请确保它在模板文件中（现有文件或您制作的文件）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-05T17:41:35.193

默认情况下，Wordpress 不支持在帖子中直接使用 PHP 代码。一个简单的[谷歌搜索](https://www.google.co.uk/search?q=wordpress%20plugin%20use%20php%20in%20posts&aq=f&oq=wordpress%20plugin%20use%20php%20in%20posts&aqs=chrome.0.57j0j62l3j64.3490j0&sourceid=chrome&ie=UTF-8)带来了一些可能的插件，可以让你做到这一点。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-05T17:33:20.197

文件可能没有被 PHP 解析。确保文件扩展名是 PHP，或者您的服务器设置为使用 PHP 解析该文件类型。

# ruby - 在没有所需模块文件的情况下测试 ruby 类

> ID：15839942
> 
> 赞同：0
> 
> 时间：2013-04-05T17:29:35.713
> 
> 标签：ruby, testing, module, gem, mocking

我正在使用 Ruby on Rails 开发一个项目。我们有一个使用 gem 中的模块的控制器操作。这个 gem 还没有完成，它不在文件系统上。

我被告知要模拟模块以测试控制器。有没有办法在没有实际宝石的情况下对此进行测试？嘲笑“要求”电话会起作用吗？我们目前正在使用 Mocha 进行 Mocking 和 Stubbing。

有一种方法可以在 python 中模拟导入。也许有一个类似的答案来模拟红宝石中的需求。 [如何模拟导入](https://stackoverflow.com/questions/8658043/how-to-mock-an-import)

或者请让我知道处理此问题的最佳方法是什么。

更新：告诉我模拟它的人建议添加一个存根文件，但这需要向控制器添加测试代码，我不想这样做。

更新 2：控制器使用模块中声明的方法。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-05T19:40:37.580

如果您正在编写测试来模拟方法调用，它们将会失败。例如，

```
controller.should_receive(:method_in_non_existent_module).with(args) #=> errors 
```

在正确的 Red->Green TDD 场景中，这没关系，因为下一步将需要 gem/file，包含模块并在控制器中添加方法调用并使测试通过。但是您将无法通过测试，因为您不能要求该文件，因为它还不存在。

可能是开发人员要求您模拟方法，而不是在您的测试中，而是在您的实际代码中。例如，他正在编写一个 gem 'dongle-jokes'，它有一种方法可以从最近的技术会议中获取最流行的 dongle 笑话。他不希望 gem 成为您完成控制器和视图的障碍，因此他要求您使用一个虚拟接口来吐出一个虚拟响应。

1.  编写失败的测试
2.  添加文件`lib/dongle-jokes.rb`
3.  将以下内容添加到该文件中。

    ```
    module DongleJokes
      def joke
        "Dongle jokes aren't funny!"
      end
    end 
    ```

4.  需要文件并包含模块，使用控制器中的方法。

测试现在应该通过了。`lib/dongle-jokes.rb`您可以在开始使用实际 gem 时删除。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-05T19:43:49.593

如果您在 Rails 中工作，则无论如何都不需要向控制器添加 require，因为当您将 gem 添加到 gemfile 时，它​​将在 Rails 启动时自动需要。

您的同事最可能的意思是您应该对模块本身进行存根。您是否使用 rspec 进行测试？如果是这样，您应该可以使用`stub_const`. 假设该模块被称为`Payments`. 然后，您可以编写如下测试代码：

```
before do
  stub_const("Payments", stub)
  Payments.stub(process: "payments successful")
end 
```

# ios - iOS 应用内存限制

> ID：15839943
> 
> 赞同：0
> 
> 时间：2013-04-05T17:29:39.880
> 
> 标签：ios, memory-management

我编写了一个 iphone 应用程序，它作为第一个功能允许用户下载文件。然后，用户以希望它们在内存中的特定方式操作这些文件。

用户获得的所有文件不必都在内存中，一次只需几个在内存限制范围内即可。但是，由于位置假设（主要是没有假设用户将在 wifi 或数据接收范围内），稍后下载其余部分的选项不可用。

有没有解决的办法？一个例子是拥有某种我可以访问的永久写入。文件存储应用程序就是这样解决这个问题的吗？

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-05T17:47:56.443

您可以使用服务器而不是应用程序来进行操作吗？iphone应用程序将链接发送到服务器，服务器进行操作，然后iphone下载被操作的链接。

# c++ - 处理派生类中派生对象集合的最佳方法是什么

> ID：15839953
> 
> 赞同：3
> 
> 时间：2013-04-05T17:30:25.493
> 
> 标签：c++, collections, derived-class

想象一下，我有一个类“BaseA”，其中包含项目“ItemA”的集合。现在我想扩展“BaseA”以添加额外的功能，所以我从“BaseA”派生了“DerivedA”。“DerivedA”的一个特点是它必须处理更复杂的“DerivedITemA”项目而不是“ItemA”项目。

```
class BaseA {
protected:
    vector<ItemA> x;
    void m1(int i) { x.m1(i); }
};

class ItemA {
protected:
    void m1(int i) { ... }
};

class DerivedItemA : public ItemA {
    void m2(int i) { ... }
}; 
```

现在我想处理这样的事情：

```
class DerivedA : public BaseA {
    vector<DerivedItemA> x;
    void m2(int i) { x[i].m2(); }
}; 
```

即让我的派生类处理派生项目。上述 x 的定义是不正确的，因为它与 BaseA 中的定义相冲突。但我的想法是我希望能够重用 BaseA 中处理 x 的所有方法，只要它们处理 ItemA 元素并且在 DerivedA 中具有扩展方法来处理 DerivedItemA 类型数据的额外复杂性

有什么建议吗？我目前的想法是为 x 定义一个新的数据类型（例如 VectorOfItemA）并从中派生 VectorOfDerivedItemA。我想知道是否有更简单/更好的解决方案。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-05T18:51:22.530

你拥有所有的课程吗？如果是这样，您可以改为重构为模板基类。

```
template <typename ITEM>
class BaseT {
protected:
    vector<ITEM> x;
    void m1(int i) { x[i].m1(); }
};

typedef BaseT<ItemA> BaseA;

class DerivedA: public BaseT<DerivedItemA> {
    void m2(int i) { x[i].m2(); }
}; 
```

如果您打算重用`BaseA`也接受 a 的代码`DerivedA`，那么您可能还需要将它们修改为模板函数/类。

否则，您将需要向量的某种“多态”基础对象。您可以查看[从异构 std::list 中检索数据](https://stackoverflow.com/questions/15796341/retrieve-data-from-heterogeneous-stdlist)（或我的后续问题：[unique_ptr 成员，私有复制构造函数与移动构造函数](https://stackoverflow.com/questions/15821535/unique-ptr-member-private-copy-constructor-versus-move-constructor)）中的一种方法。

* * *

作为多态项的替代方案，您可以为您的基础定义一个接口。

```
class BaseI {
protected:
    virtual void m1(int) = 0;
    //... other interfaces
public:
    virtual ~BaseI () {}
    //... other public interfaces
};

template <typename ITEM>
class BaseT : public BaseI {
protected:
    vector<ITEM> x;
    void m1(int i) { x[i].m1(); }
    //...implement the other interfaces
};

//... 
```

现在，需要 a 的代码`BaseA`需要重构为 a `BaseI`。该新代码也将能够接受 a `DerivedA`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-05T18:07:30.363

您可以尝试使用 Curiously Recurring Template Pattern - [CRTP](http://en.wikipedia.org/wiki/Curiously_recurring_template_pattern)：

[现场演示](http://coliru.stacked-crooked.com/a/0666778779c36500)

```
#include <iostream>
#include <ostream>
#include <vector>

using namespace std;

struct Item
{
    void m1(int i)
    {
        cout << "m1(" << i << ")" << endl;
    }
};
struct DerivedItem : Item
{
    void m2(int i)
    {
        cout << "m2(" << i << ")" << endl;
    }
};

template<typename Derived>
struct IBase
{
    void m1(int i)
    {
        for(auto &&z : static_cast<Derived*>(this)->x)
        {
            z.m1(i);
        }
    }
};
template<typename Derived>
struct IDerivedBase: IBase<Derived>
{
    void m2(int i)
    {
        for(auto &&z : static_cast<Derived*>(this)->x)
        {
            z.m2(i);
        }
    }
};

struct Base : IBase<Base>
{
    vector<Item> x;
};
struct DerivedBase : IDerivedBase<DerivedBase>
{
    vector<DerivedItem> x;
};

int main()
{
    Base b;
    b.x.resize(3);
    DerivedBase d;
    d.x.resize(1);

    b.m1(11);
    d.m1(22);
    d.m2(33);
} 
```

输出是：

```
m1(11)
m1(11)
m1(11)
m1(22)
m2(33) 
```

> Vector 将包含 BaseA 实例中作为 Itama 的所有元素或 DerivedA 实例中 DerivedItemA 的所有元素。没有必要混合。

这种方法没有任何混合：

*   **Base**只有vector< **Item** >提供**m1**方法
*   **DerivedBase**只有 vector< **DerivedItem** > 提供**m1**和**m2**方法。

* * *

但是，在不知道实际使用模式的情况下 - 很难猜出您需要什么。也许对于您的情况，两个独立的向量就足够了：

```
vector<Item> x1;
vector<DerivedItem> x2; 
```

并为它们定义独立的函数。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-05T18:03:12.297

我相信你需要在你的向量中有指针才能处理这个问题。我有点困惑传递给 m1 和 m2 的值，因为 i 似乎是一个索引，但这是我的猜测：

```
class BaseA {
protected:
    vector<ItemA*> x;
    void m1(int i) { x[i]->m1(i); }
};

class ItemA {
protected:
    void m1(int i) { ... }
};

class DerivedItemA : public ItemA {
    void m2(int i) { ... }
};

class DerivedA : public BaseA {
    vector<DerivedItemA*> y; //don't shadow the base class vector!
    void m2(int i) { y[i]->m2(i); }
}; 
```

然后，当您在 DerivedA 中添加一个项目时，将它添加到 x 和 y。这样，BaseA 可以对 x 中的指针执行操作，而 DerivedA 可以对 y 中的指针执行操作。

编辑：您还需要提供一个虚拟方法来添加项目，否则您可能会将未添加到 DerivedA.y 的内容添加到 BaseA.x。

# php - 制作适合任何屏幕尺寸的网站？

> ID：15839954
> 
> 赞同：-4
> 
> 时间：2013-04-05T17:30:26.750
> 
> 标签：php, html, css

我正在这个网站上工作，它在 1280x1024 的屏幕分辨率下看起来不错，但是当我将屏幕分辨率更改为 1280x768 时，它绝对是糟糕透了。

你可以在这里查看我正在开发的网站：http: [//tinyurl.com/d3xhfdq](http://tinyurl.com/d3xhfdq)

我有 4 个 div（mainWraper、页眉、内容和页脚）。

为了使网站适合任何屏幕分辨率，应遵循什么正确程序？

我需要做的是在任何屏幕尺寸的 mainWraper 中安装所有内容？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-05T17:42:34.573

除了使用[媒体查询](http://css-tricks.com/css-media-queries/)，别忘了还使用

```
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes"> 
```

上面的代码（如果你愿意的话）是由苹果开发的，并且随着它使苹果 iphone 和平板电脑呈现为桌面制作的页面而获得动力。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-05T17:45:41.807

使用 CSS3 媒体查询。通常你会指定一个最小或最大宽度来定义你的设计，但你也可以使用高度。

例如，您可以编写一个媒体查询，当窗口高度为 768 像素或更高时执行某段 CSS，当窗口小于 768 像素时执行另一段 CSS：

```
 @media screen and (min-height: 768px) {
    #mainWraper {
      /* your code here */
    }
  }

   @media screen and (min-height: 0px) {
      #mainWraper {
        /* your code here */
      }
   } 
```

您还可以在 html 的头部调用媒体查询，如下所示：

```
<link rel="stylesheet" media="screen and (max-width: 960px)" href="myStylesheet.css" /> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-05T17:50:02.200

响应式设计是您应该研究的主题。[A List Apart](http://alistapart.com/)[收集](http://alistapart.com/topic/responsive-design)了大量与此主题相关的文章。我建议您按以下顺序阅读以下文章：

1.  [流体网格](http://alistapart.com/article/fluidgrids)
2.  [响应式网页设计](http://alistapart.com/article/responsive-web-design)
3.  [流体图像](http://alistapart.com/article/fluid-images)

这三个将使您在响应式设计方面做得很好。另外，不要忘记*php NoOb*建议的 viewport`meta`标签。当您在物理设备上时，它会产生真正的不同（一些模拟器似乎忽略了它）。可以在以下链接中找到有关此特定标签的其他信息：

 **   [使用视口元标记来控制移动浏览器的布局 - Mobile | MDN](https://developer.mozilla.org/en-US/docs/Mobile/Viewport_meta_tag)
*   [快速提示：不要忘记视口元标记 | 网页设计tuts+](http://webdesign.tutsplus.com/tutorials/htmlcss-tutorials/quick-tip-dont-forget-the-viewport-meta-tag/)*

# java - 将一个矩形映射到另一个矩形，包括旋转

> ID：15839960
> 
> 赞同：0
> 
> 时间：2013-04-05T17:30:52.677
> 
> 标签：java, image-processing, affinetransform

我有两个图像、一个*模板*和一个*扫描*页面。
我打印模板然后扫描它。
图像的每个角度都有一个点。
因为扫描可以平移、旋转并且可以具有不同的尺寸（垂直和水平，因为打印机变形）我必须将扫描的四个点映射到模板。
我有每个点的位置。
如何在 Java 中创建 AffineTransform 以应用于扫描？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-06T09:25:44.220

从技术上讲，您可以自己在数学上找到仿射变换，然后使用一些循环自行应用它，该循环为每个目标像素找到源像素并在它们之间进行一些插值，但这确实是浪费时间。

有许多图像处理库可以帮助您，例如 OpenCv。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-06T15:49:33.983

找到方法了！这有点令人困惑，但我希望这可以帮助某人。referenceMarker1..4 是*模板*标记点 translateMarker1..4 是*扫描*标记点

不使用referenceMarker3 和translatedMarker3，可以做一个ennchement。

```
final double translationX = translatedMarker1.getX() - referenceMarker1.getX();
final double translationY = translatedMarker1.getY() - referenceMarker1.getY();

// Calculate translation, rotation and scaling of the sheet
final double originalDx = referenceMarker2.getX() - referenceMarker1.getX();         // X distance between reference markers
final double originalDy = referenceMarker2.getY() - referenceMarker1.getY();         // Y distance between reference markers
final double translatedDx = translatedMarker2.getX() - translatedMarker1.getX();     // X distance between translated markers
final double translatedDy = translatedMarker2.getY() - translatedMarker1.getY();     // Y distance between translated markers

final double angle = Math.atan2(translatedDy, translatedDx) - Math.atan2(originalDy, originalDx);
double scaleX = Math.sqrt(originalDx * originalDx + originalDy * originalDy) / Math.sqrt(translatedDx * translatedDx + translatedDy * translatedDy);

final double originalDx4_2 = referenceMarker4.getX() - referenceMarker2.getX();
final double originalDy4_2 = referenceMarker4.getY() - referenceMarker2.getY();
final double translatedDx4_2 = translatedMarker4.getX() - translatedMarker2.getX();
final double translatedDy4_2 = translatedMarker4.getY() - translatedMarker2.getY();

double scaleY = Math.sqrt(originalDx4_2 * originalDx4_2 + originalDy4_2 * originalDy4_2) / Math.sqrt(translatedDx4_2 * translatedDx4_2 + translatedDy4_2 * translatedDy4_2);

// Generate a transformation matrix
// Translate back
transformation.translate(referenceMarker1.getX() - translationX, referenceMarker1.getY() - translationY);

// Scale
transformation.scale(scaleX, scaleY);

// Rotate
transformation.rotate(-angle);

// Translate first marker to origin to rotate around that point
transformation.translate(-referenceMarker1.getX(), -referenceMarker1.getY()); 
```

# java - JSlider 事件触发两次

> ID：15839961
> 
> 赞同：3
> 
> 时间：2013-04-05T17:30:53.393
> 
> 标签：java, swing, jslider, changelistener

我有一个带有附加 ChangeListerner 的简单 JSlider。这是代码：

```
JSlider slider = new JSlider();
slider.setMinorTickSpacing(2);
slider.setMajorTickSpacing(20);
slider.setPaintLabels(true);
slider.setPaintTicks(true);
slider.setSnapToTicks(true);
slider.setOrientation(SwingConstants.VERTICAL);
contentPane.add(slider, BorderLayout.CENTER);

slider.addChangeListener(new SliderListener());

class SliderListener implements ChangeListener {
    public void stateChanged(ChangeEvent e) {
        JSlider source = (JSlider)e.getSource();
        if (!source.getValueIsAdjusting()) {
            System.out.println("boo");
        }    
    }
} 
```

如您所见，代码并没有做太多事情，我现在要做的就是确保事件只触发一次，因此我的事件只是在 Eclipse 中向控制台打印一些内容。

但是每次更改滑块时，上面的代码都会打印两次“嘘”。我猜这与 Slider 上的鼠标释放有关，但无论如何，我希望它只触发一次事件，因此只打印一次单词。

我怎样才能做到这一点？

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-05T17:45:17.447

你确定听众没有被添加两次吗？以下 SSCCE 在我的机器（OS X、JDK7）上按预期工作

```
import javax.swing.JFrame;
import javax.swing.JSlider;
import javax.swing.WindowConstants;
import javax.swing.event.ChangeEvent;
import javax.swing.event.ChangeListener;
import java.awt.EventQueue;

public class SliderTest {
  public static void main( String[] args ) {
    EventQueue.invokeLater( new Runnable() {
      @Override
      public void run() {
        JFrame frame = new JFrame(  );
        final JSlider slider = new JSlider( 0, 100 );
        frame.add( slider );
        slider.addChangeListener( new ChangeListener() {
          @Override
          public void stateChanged( ChangeEvent e ) {
            if ( !( slider.getValueIsAdjusting() ) ){
              System.out.println( "SliderTest.stateChanged" );
            }
          }
        } );
        frame.pack();
        frame.setVisible( true );
        frame.setDefaultCloseOperation( WindowConstants.EXIT_ON_CLOSE );
      }
    } );
  }
} 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2020-03-17T21:23:28.883

我知道这个问题。我的解决方法是将全局 eventOnwer 设置为所有其他侦听器，这样可以解决其他事件触发，而其中一个是事件所有者。然后，为了解决滑块问题，我将 `getValueIsAdjusting()`a 中的 设置为 true `if`。万一再发生火灾，`return`.

# ios - Adobe AIR 3.4 将 XML 数据保存/写入 iOS

> ID：15839963
> 
> 赞同：1
> 
> 时间：2013-04-05T17:30:59.527
> 
> 标签：ios, actionscript-3, air, adobe

我正在尝试将 XML 数据保存到带有 AIR 3.4 for iOS 的 iPad 4 中，但真的不知道这是否有效。显然没有事件被触发。任何帮助是极大的赞赏。

```
 private function saveData(e:MouseEvent):void {

        var name:String = AssetManager.SAVE_ANNOTATIONS_NAME            
        var file:File = new File()              
        file = File.applicationStorageDirectory.resolvePath(name + "xml");
        var xml:XML = _canvas.getObjectData(FormatType.DEGRAFA);            
        var fileStream:FileStream = new FileStream();
        fileStream.open(file, FileMode.WRITE);
        fileStream.writeUTF(xml.toString());

        fileStream.addEventListener(ProgressEvent.PROGRESS, onFileStream);
        fileStream.addEventListener(Event.ACTIVATE, onFileStream);
        fileStream.addEventListener(Event.OPEN, onFileStream);
        fileStream.addEventListener(Event.DEACTIVATE, onFileStream);
        fileStream.addEventListener(IOErrorEvent.IO_ERROR, onFileStream);
        fileStream.addEventListener(Event.COMPLETE, onFileStream);

    }

    protected function onFileStream(event:Event):void
    {
        trace('filestream event was ' + event)
        fileStream.close();

    } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-05T22:42:08.787

我似乎已经解决了这个问题：

```
 private function saveFile(event:MouseEvent):void
    {  
        var xml:XML = _canvas.getObjectData(FormatType.DEGRAFA);
        trace('xml is ' + xml.toXMLString())
        var file:File = File.documentsDirectory.resolvePath("annotations.xml");         
        var fileStream:FileStream = new FileStream();  

        fileStream.openAsync(file, FileMode.WRITE);  
        fileStream.writeUTFBytes(xml.toXMLString()); 
        fileStream.addEventListener(Event.CLOSE, fileClosed);  
        fileStream.close();  

        function fileClosed(event:Event):void { 

            trace("File Saved");  

        }        
    } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-08-14T09:20:36.063

您在添加侦听器之前编写。正确的顺序应该是：

```
 var fileStream:FileStream = new FileStream(); 
```

// 这里所有的监听器

```
 fileStream.open(file, FileMode.WRITE);
    fileStream.writeUTF(xml.toString()); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-11-16T17:32:28.417

您必须记下用于打开文件流的命令。如果您使用 filestream.openAsync，则文件流将异步打开，这意味着您必须等待 filestream 对象上的 Event.OPEN 事件。如果您使用 filestream.open，那么您可以立即调用 filestream 对象上的函数，而无需等待 OPEN 事件。对我来说，跳转到 ActionScript 及其异步特性需要一些时间来适应。

# android - 需要帮助更改 TextView

> ID：15839971
> 
> 赞同：0
> 
> 时间：2013-04-05T17:31:35.423
> 
> 标签：android, textview, multilingual

我正在尝试为井字游戏动态更改文本。

```
leTexte = (TextView) findViewById(R.id.text); 
```

我想在屏幕上显示一个将要更改的 TextView，例如，如果玩家 X 赢得了比赛，将显示“玩家 X 获胜”，或者法语中的“Joueur X gagne”。

我很容易通过使用仅用一种语言手动执行此操作

```
leTexte.setText("Player X Won"); 
```

但我想将我的 XML 文件用于许多其他语言。这里是主要 XML 的示例

```
 android:id="@+id/text"
  android:text="@string/text" 
```

英文 Strings.xml 看起来像这样

```
 <string name="text"></string> //nothing at start
    <string name="textX">Player X Wins</string>
    <string name="textO">Player O Won !</string>
    <string name="textT">TIE !</string>
    <string name="textU">Your Turn</string> 
```

那么，如何使用“名称”更改文本？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-05T17:33:16.357

您可以在 strings.xml 中引用字符串，如下所示

```
 tv.setText(R.string.text); 
```

在代码中：使用 R 类的子类中的静态整数，例如：

字符串文本

string 是资源类型，text 是资源名称。

更多详细信息，请访问[http://developer.android.com/guide/topics/resources/accessing-resources.html](http://developer.android.com/guide/topics/resources/accessing-resources.html)。

# google-bigquery - 共享对 Google Bigquery 数据集的访问权限

> ID：15839973
> 
> 赞同：4
> 
> 时间：2013-04-05T17:31:46.900
> 
> 标签：google-bigquery

我在 Bigquery 中创建了一个项目和一个数据集。我可以与其他开发人员共享数据集，但不能共享项目。单击左侧窗格中的“团队”链接时，出现 404 错误。有没有办法分享这个项目？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2019-11-08T07:25:16.823

BQ 中的数据集共享有点不直观 - 实际共享非常简单，但与您共享的人的用户体验有点模糊。

如果你想分享：

*   选择数据集
*   选择共享数据集
*   选择电子邮件、谷歌群组等。
*   仅用于数据访问（不具备在您的项目上运行作业的能力 - 因此您无需为他们进行的查询付费）选择`BigQuery Data Viewer`角色。

所有这些都在这里解释：[https ://cloud.google.com/bigquery/docs/dataset-access-controls](https://cloud.google.com/bigquery/docs/dataset-access-controls)

完成此操作后，您与之共享的用户**将能够**在数据集上运行查询，但将**无法在**BQ 控制台左侧的数据资源下查看您的项目和数据集。

这是因为您为他们提供了对数据集而不是项目的 IAM 访问权限（这是正确的方法）。如果他们想查看列出的项目/数据集，他们需要将共享项目/项目固定到 BQ 控制台中的项目：

1.  他们应该输入共享项目的 BQ URL：`https://console.cloud.google.com/bigquery?project=[SHARING_PROJECT_NAME]`
2.  在左侧的数据资源浏览器中选择项目，然后选择 PIN PROJECT
3.  在 BQ 控制台上返回他们的原始项目，现在也会看到那里列出的共享项目。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2019-05-22T02:21:56.570

您可以与***任何***项目中的服务帐户共享数据集。我认为您可以对普通用户帐户执行相同操作，而无需添加到项目中。 [https://cloud.google.com/dataprep/docs/concepts/cross-bq-datasets](https://cloud.google.com/dataprep/docs/concepts/cross-bq-datasets)

从 BigQuery 网络控制台“共享数据集”选项：您可以与这些类型的帐户共享

```
Google Account email: user@gmail.com
Google Group: admins@googlegroups.com
Service account: server@example.gserviceaccount.com
Google Apps domain: example.com
anybody: enter "allUsers" to grant access to the general public
all Google Accounts: enter "allAuthenticatedUsers" to grant access to any user signed in to a G[![enter image description here][1]][1]oogle Account (warning: shares publicly with users outside of your organization) 
```

# android - 使用同一个键在 Android 应用偏好设置中存储多个值

> ID：15839975
> 
> 赞同：1
> 
> 时间：2013-04-05T17:31:53.627
> 
> 标签：android, http-post, sharedpreferences

我不太确定如何使用相同的密钥在 Android 应用程序的共享首选项中存储多个值。

该应用程序所做的是显示一个列表和一个按钮以将该项目添加到收藏夹我想将该数值存储到首选项中，当用户转到收藏夹列表时，通过数组中的 http post 发送所有存储的收藏夹。

**编辑：**我是这样做的，但是当我添加一个新值时它会覆盖最后一个值，检查 implode 方法，我将新值添加到存储列表中为空，或者它必须添加新值并保留最后一个值.

```
import java.util.ArrayList;
import java.util.List;
import java.util.StringTokenizer;

import org.apache.http.NameValuePair;
import org.apache.http.message.BasicNameValuePair;

import android.content.Context;
import android.content.SharedPreferences;
import android.content.SharedPreferences.Editor;
import android.preference.PreferenceManager;

public class FavoriteActivity {

    private static String FAVORITE_LIST = "FAV_LIST";
    private static SharedPreferences sharedPreference;
    private static Editor sharedPrefEditor;

    public static List<NameValuePair> getFavoriteList(Context context) {
        if (sharedPreference == null) {
            sharedPreference = PreferenceManager
                    .getDefaultSharedPreferences(context);
        }
        String storedList = sharedPreference.getString(FAVORITE_LIST, "");
        return explode(storedList);
    }

    public static void saveFavorite(String fav, Context context) {
        if (sharedPreference == null) {
            sharedPreference = PreferenceManager
                    .getDefaultSharedPreferences(context);
        }
        sharedPrefEditor = sharedPreference.edit();
        implode(getFavoriteList(context), fav, 1);
        sharedPrefEditor.putString(FAVORITE_LIST, fav);
        sharedPrefEditor.commit();
    }

    public static List<NameValuePair> explode(String string) {
        StringTokenizer st = new StringTokenizer(string, ",");
        List<NameValuePair> v = new ArrayList<NameValuePair>();
        for (; st.hasMoreTokens();) {
            v.add(new BasicNameValuePair("id[]", st.nextToken()));
        }
        return v;
    }

    public static String implode(List<NameValuePair> list, String value,
            int mode) {
        StringBuffer out = new StringBuffer();
        switch (mode) {
        case 0:
            list.remove(new BasicNameValuePair("id[]", value));
            break;
        case 1:
            list.add(new BasicNameValuePair("id[]", value));
            break;
        }
        boolean first = true;
        for (NameValuePair v : list) {
            if (first)
                first = false;
            else
                out.append(",");
            out.append(v.getValue());
        }
        return out.toString();
    }

} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-05T17:34:11.347

你不能这样做。如果您在任何地方使用相同的键，它将覆盖以前的值。

也许您可以将值转换为数组并[存储数组](https://stackoverflow.com/a/10815983/1069068)，或者考虑使用 SQLite 数据库，您可以在其中指定一列中的键，并在另一列中指定相应的值，然后运行选择所有行的 SELECT 语句里面有钥匙。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-05T19:43:43.540

好的，这就是我这样做的方式并且效果很好，而且它不会添加任何重复项。

```
private static String FAVORITE_LIST = "FAV_LIST";
private static SharedPreferences sharedPreference;
private static Editor sharedPrefEditor;

public static List<NameValuePair> getFavoriteList(Context context) {
    if (sharedPreference == null) {
        sharedPreference = PreferenceManager
                .getDefaultSharedPreferences(context);
    }
    String storedList = sharedPreference.getString(FAVORITE_LIST, "");
    return explode(storedList);
}

public static void saveFavorite(String fav, Context context) {
    modifyFavorite(fav, context, 1);
}

public static void removeFavorite(String fav, Context context) {
    modifyFavorite(fav, context, 0);
}

private static void modifyFavorite(String fav, Context context, int mode) {
    if (sharedPreference == null) {
        sharedPreference = PreferenceManager
                .getDefaultSharedPreferences(context);
    }
    sharedPrefEditor = sharedPreference.edit();
    String newList = implode(getFavoriteList(context), fav, mode);
    sharedPrefEditor.putString(FAVORITE_LIST, newList);
    sharedPrefEditor.commit();
}

private static List<NameValuePair> explode(String string) {
    StringTokenizer st = new StringTokenizer(string, ",");
    List<NameValuePair> v = new ArrayList<NameValuePair>();
    for (; st.hasMoreTokens();) {
        v.add(new BasicNameValuePair("id[]", st.nextToken()));
    }
    return v;
}

private static String implode(List<NameValuePair> list, String value,
        int mode) {
    StringBuffer out = new StringBuffer();
    switch (mode) {
    case 0:
        list.remove(new BasicNameValuePair("id[]", value));
        break;
    case 1:
        list.add(new BasicNameValuePair("id[]", value));
        break;
    }
    boolean first = true;
    for (NameValuePair v : list) {
        if (out.lastIndexOf(v.getValue()) == -1) {
            if (first) {
                first = false;
            } else {
                out.append(",");
            }
            out.append(v.getValue());
        }
    }
    return out.toString();
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-05T17:38:21.570

从 api 11 开始，您可以放置[​​ StringSet](http://developer.android.com/reference/android/content/SharedPreferences.Editor.html#putStringSet%28java.lang.String,%20java.util.Set%3Cjava.lang.String%3E%29)。另一种方式是不可能的。

# django - Jade templates django - 在 urls.py 中使用捕获的 url 值

> ID：15839976
> 
> 赞同：0
> 
> 时间：2013-04-05T17:31:53.773
> 
> 标签：django, pug, pyjade

我有“静态”javascript 模板，我想与我的 Django 应用程序一起使用。通常你把它们放在静态文件夹中，就是这样。这里的问题是模板并不是真正的静态，它们是需要预编译的**玉(pyjade) 模板。**
我的计划是将模板放在应用程序*模板*目录的子目录中，我们称之为*jstemplates*，然后从`urls.py`文件中提供它们，如下所示：

```
...
url(r'^jstemplates/(?P<template>.*)', TemplateView.as_view(template_name=<captured_name>)),
... 
```

但是如何获取捕获的模板名称？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-05T23:12:46.840

想得更好，我想在视图实例化之前捕获的属性将不可用，所以我创建了一个名为 JsTemplateView 的 TemplateView 子类。

```
class JsTemplateView(TemplateView):
    def get_template_names(self):
        return "jstemplates/%s.jade" % self.kwargs['template'] 
```

并在 urls.py 中添加了相应的行`url(r'^jstemplates/(?P<template>.*)', JsTemplateView.as_view()`

# c++ - 无法读取整个文件

> ID：15839977
> 
> 赞同：2
> 
> 时间：2013-04-05T17:31:58.190
> 
> 标签：c++, file, iostream, fstream, bmp

我正在制作一个 C++ 程序，以便能够打开 .bmp 图像，然后能够将其放入 2D 数组中。现在我有这样的代码：

```
#include <iostream>
#include <fstream>
#include <sstream>
#include <string>
#include "Image.h"
using namespace std;

struct colour{
    int red;
    int green;
    int blue;
};

Image::Image(string location){

    fstream stream;
    string tempStr;

    stringstream strstr;
    stream.open(location);

    string completeStr;

    while(!stream.eof()){
        getline(stream, tempStr);
        completeStr.append(tempStr);
    }
    cout << endl << completeStr;

    Image::length = completeStr[0x13]*256 + completeStr[0x12];
    Image::width = completeStr[0x17]*256 + completeStr[0x16];
    cout << Image::length;
    cout << Image::width;
    cout << completeStr.length();

    int hexInt;
    int x = 0x36;
    while(x < completeStr.length()){
        strstr << noskipws << completeStr[x];
        cout << x << ": ";
        hexInt = strstr.get();
        cout << hex << hexInt << " ";
        if((x + 1)%3 == 0){
            cout << endl;
        }
        x++;
    }
} 
```

现在，如果我在我的 256x256 测试文件上运行它，它会打印得很好，直到它到达 0x36E，它给出一个错误/不会更进一步。发生这种情况是因为*completeStr*字符串没有接收到 bmp 文件中的所有数据。为什么无法读取 bmp 文件中的所有行？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-04-05T18:16:21.567

您的代码存在许多问题。主要的（可能是您的问题的原因）是您以文本模式打开文件。从技术上讲，这意味着如果文件包含除可打印字符和一些特定控制字符（如 '\t'）之外的任何内容，则您的行为未定义。实际上，在 Windows 下，这意味着 0x0D、0x0A 的序列将被转换为单个`'\n'`，并且 0x1A 将被解释为文件的结尾。在读取二进制数据时并不是真正想要的。`std::ios_base::binary`您应该以二进制模式 ( )打开流。

`fstream` 不是一个严重的错误，但是如果您只是要读取文件，则不应真正使用 an 。事实上，使用 an `fstream`应该很少见：你应该使用`ifstream` or `ofstream`。同样的事情也适用（但我在读取二进制文件时`stringstream`看不到任何作用）。`stringstream`

另外（这是一个真正的错误），您正在使用结果 `getline`而不检查是否成功。阅读行的通常成语是：

```
while ( std::getline( source, ling ) ) ... 
```

但是`stringstream`，您*不想*`getline`在二进制流上使用；它将删除所有`'\n'`（已经从 CRLF 映射的）。

如果您想要内存中的所有数据，最简单的解决方案是：

```
std::ifstream source( location.c_str(), std::ios_base::binary );
if ( !source.is_open() ) {
    //  error handling...
}
std::vector<char> image( (std::istreambuf_iterator<char>( source ) ),
                         (std::istreambuf_iterator<char>()) ); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-05T17:40:26.713

`std::getline`读入一行文本。

它对二进制文件没有用。

以二进制模式打开文件并使用未格式化的输入操作（如[`read`](http://www.cplusplus.com/reference/istream/istream/read/)）。

# android - 如何通过连接的 Sony Xperia 从 .NET 应用程序发送 SMS

> ID：15839979
> 
> 赞同：2
> 
> 时间：2013-04-05T17:32:03.050
> 
> 标签：android, .net, smartphone, sony

我想通过 USB 将我的 Sony Xperia 智能手机连接到 PC，然后我想开发一个 .NET 应用程序，它使用连接的手机发送短信。这可能吗？

我需要哪些组件？

问候基督徒

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-03-27T14:36:02.023

您可以咨询以回答有关发送短信的问题： [Send SMS in android](https://stackoverflow.com/questions/4967448/send-sms-in-android)

有关 PC 和移动设备之间通过 USB 进行的通信，请查看 Android USB 文档。它包含有关如何通过 USB 实现通信的代码片段。 [http://developer.android.com/guide/topics/connectivity/usb/host.html](http://developer.android.com/guide/topics/connectivity/usb/host.html)

# android - 截取自定义视图的屏幕截图时出现 IllegalArgumentException

> ID：15839983
> 
> 赞同：0
> 
> 时间：2013-04-05T17:32:12.187
> 
> 标签：android, view, screenshot

在尝试制作自定义视图的屏幕截图时，我得到了`IllegalArgumentException : width and height must be >0`. 这是我写的：

```
bitmap = loadBitmapFromView(v1);//v1 the custom view I want to picture.
public static Bitmap loadBitmapFromView(View v) {
Bitmap b = Bitmap.createBitmap( v.getLayoutParams().width, v.getLayoutParams().height, Bitmap.Config.ARGB_8888);                
Canvas c = new Canvas(b);
v.layout(0, 0, v.getLayoutParams().width, v.getLayoutParams().height);
v.draw(c);
return b;
} 
```

有异常的那一行：`Bitmap b = Bitmap.createBitmap( v.getLayoutParams().width, v.getLayoutParams().height, Bitmap.Config.ARGB_8888);`
当然屏幕截图代码是在视图显示后执行的，在next_act按钮代码上

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-05T17:34:59.427

的宽度和高度`LayoutParams`可以是常数，例如`FILL_PARENT`，它们是负数。

要获取视图的测量尺寸，您可以使用：

```
v.getMeasuredWidth() and v.getMeasuredHeight() 
```

但是，这取决于您所追求的，以及是否已测量视图。

在截取屏幕截图之前等到绘制视图可能更有意义；-) 但是您需要更多地解释您的用例。

# php - 只允许 php 中的预期输入是什么意思？

> ID：15839984
> 
> 赞同：0
> 
> 时间：2013-04-05T17:32:13.440
> 
> 标签：php, validation, gpc

我正在阅读一本关于 php 安全性的书，在输入验证章节中，有一小部分讨论了只允许预期的输入。

这是他们显示的代码：

```
<?php
$expected = array( 'carModel', 'year', 'bodyStyle' );
foreach( $expected AS $key ) {
if ( !empty( $_POST[ $key ] ) ) {
${$key} = $_POST[ $key ];
}
else {
${$key} = NULL;
}
}
?> 
```

我有点困惑，有一小段解释了代码的作用。对于我得到的，它从数组中分配一个值作为 $_POST 的键。它还说该数组应该以编程方式从 GPC 数组中复制出来。

我不明白的是我应该在什么情况下使用它？什么是 GPC 阵列？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-05T17:49:30.023

GPC = Get Post Cookie，它指的是来自用户/浏览器的变量。因此，不要使用 $_GET、$_POST、$_COOKIE，您应该将数据清理并验证到您可以信任并知道是干净的变量中。

至于建议，他们正在做的是限制您的代码可以访问的内容。在上面的代码示例中，您可能会在页面上有一个表单，其中包含名为 carMODEl、year 和 bodyStyle 的元素。这里的代码正在做的是将您的代码限制为仅与这 3 个元素交互。

这可以防止有人向您的页面传递额外的参数以尝试注入代码或某种 SQL 注入攻击或任何其他数量的事情。在像这样的简单示例中，它可能没有意义。但是在某些情况下，人们正在接受表单/api请求并在一个 GPC 阵列中的所有内容上运行循环，并在其中处理任何内容。我建议不要一开始就这样做。

这只是保护您的服务器/数据库的许多事情之一。在开发 web 应用程序时，您应该采取不信任来自用户端的立场。

就安全性而言，OWASP 是一个很好的学习资源。[这](https://www.owasp.org/index.php/PHP_Security_Cheat_Sheet)是一个用于 php 的小备忘单。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-05T17:49:31.840

`$_POST`代码从数组中的数据创建变量。变量的名称取自`$_POST`数组的键。PHP 调用这个（即动态命名变量）[变量 variables](http://www.php.net/manual/en/language.variables.variable.php)。

这通常是一个坏主意，因为您无法控制`$_POST`数组中存在哪些键，以及创建了哪些变量。您网站的用户对此进行控制。恶意用户可能会以这样的方式命名 POST 变量，从而覆盖您打算用于不同目的的变量。

该书建议允许数组中的键以*受控方式*`$_POST`覆盖变量。这就是为了。此代码和以下代码仅创建变量和。例如，如果用户向您的应用程序发帖，则*不会*创建值为 1的变量。*`$expected = array('carModel', 'year', 'bodyStyle')``$carModel``$year``$bodyStyle``current_user_has_admin_rights=1``$current_user_has_admin_rights`*

 **我的建议是完全远离变量变量，而是`$_POST`仅通过数组访问 POST 值。这清楚地表明了值的来源，因此更容易发现这样的值是否以不安全的方式处理。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-05T17:54:17.727

**它还说该数组应该以编程方式从 GPC 数组中复制出来。**

这可能意味着您不一定要写：

```
$expected = array('carModel', 'year', 'bodyStyle'); 
```

而是写一些类似的东西：

```
$expected = getExpectedInput('carForm'); 
```

函数 getExpectInput 将在数据库中查询应为“carForm”形式的输入。或者它可能在一个文件中，这个函数会获取那个内容。它们基本上意味着，在表单中硬编码变量不是一个好主意。而是将它们写在某个地方，以便它们易于更改。如果您曾经更改过表单并添加了变量或更改了变量名，则不必更改此特定代码。这意味着此功能可用于不同的表格。这个想法是编写可以重用的函数。不是那些专注于一件事的人。哎呀。

getExpectedInput 函数可能会返回一个数组。您可以随意命名或使用任何方法。**

# java - 修改或循环后平滑组件自动刷新（例如：计时器）

> ID：15839986
> 
> 赞同：0
> 
> 时间：2013-04-05T17:32:20.393
> 
> 标签：java, swing, timer, jframe, jpanel

我看了很多地方，不知道如何自动刷新我的框架。当我单击按钮时，它确实有效（因为我已经在那里使用了许多示例），但不是自动的。

我想创建一个扫雷游戏，并在其中添加计时器，除计时器计数外，一切正常，但仅在单击按钮时更新。因此，简单地重做布局是行不通的......

艰难我知道我的计时器可以工作，如果我把 System.out 放进去，我会以稳定的秒速看到它。

我将在下面放一个小程序，不是我的游戏，因为代码太长，而是我构建的一个小程序，它的情况大致相同，修复它可以解决我的整体问题。

在这种情况下，我没有其他程序中开发良好的按钮，但是只有在我弄乱窗口时时间才会刷新。

```
import java.awt.BorderLayout;
import java.awt.Component;
import java.awt.GridLayout;
import java.util.Timer;
import java.util.TimerTask;
import javax.swing.JButton;
import javax.swing.JFrame;
import javax.swing.JPanel;
import javax.swing.JTextField;

public class ClockTest {
JFrame frame = new JFrame();
JButton test1 = new JButton();
JTextField timer1 = new JTextField();
int hour = 0, min = 0, sec = 0;
String timing;

public ClockTest() {
    frame.setLayout(new BorderLayout());
    frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
    frame.add(center(), BorderLayout.CENTER);
    frame.pack();
    frame.setVisible(true);
}

public Component center() {
    JPanel pan = new JPanel();
    pan.setLayout(new GridLayout(1,2));
    test1.setText("Dummy");
    timer1.setEditable(false);
    timer1.setText(timing);
    pan.add(test1);
    pan.add(timer1);
    return pan;
}

public void count() {
    sec++;
    if(sec == 60) {
        sec -= 60;
        min++;
    }
    if(min == 60) {
        min -= 60;
        hour++;
    }
    timing = hour + ":" + min + " : " + sec;
//This is what i do in my game to refresh, to set flags, get mine "exploded"...
//But since i'm not pressing anything... it does not happen.
    frame.add(center(), BorderLayout.CENTER);
}

public static void main(String[]args) {
    final   ClockTest test1 = new ClockTest();
    TimerTask task = new TimerTask() {
        public void run() {
            test1.count();
        }
    };
    Timer t = new Timer();
    t.schedule(task,0,1000);
}
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-05T18:23:31.263

[益智游戏中的JPanel没有更新](https://stackoverflow.com/questions/3078178/jpanel-in-puzzle-game-not-updating)

更改组件后，您需要通过调用“刷新” Swing 组件`invalidate() or revalidate()`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-08T20:18:02.343

这是 JavaNewb 使用 revalidate() 的想法的答案；

```
import java.awt.BorderLayout;
import java.awt.Component;
import java.awt.GridLayout;
import java.util.Timer;
import java.util.TimerTask;

import javax.swing.JButton;
import javax.swing.JFrame;
import javax.swing.JPanel;
import javax.swing.JTextField;
import javax.swing.border.Border;

public class ClockTest {
JFrame frame = new JFrame();
JButton test1 = new JButton();
JTextField timer1 = new JTextField();
int hour = 0, min = 0, sec = 0;
String timing;

public ClockTest() {
    frame.setLayout(new BorderLayout());
    frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
    frame.add(center(), BorderLayout.CENTER);
    frame.setResizable(true);
    frame.pack();
    frame.setVisible(true);
}

public JPanel center() {
    JPanel pan = new JPanel();
    pan.setLayout(new GridLayout(1,2));
    test1.setText("Dummy");
    timer1.setEditable(false);
    timer1.setText(timing);
    pan.add(test1);
    pan.add(timer1);
    return pan;
}

public void count() {
    sec++;
    if(sec == 60) {
        sec -= 60;
        min++;
    }
    if(min == 60) {
        min -= 60;
        hour++;
    }
    timing = " " + hour + ":" + min + " : " + sec;
// Make the modification here on your components, then .revalidate(); them all
    timer1.setText(timing);
    timer1.revalidate();
}
public static void main(String[]args) {
    final   ClockTest test1 = new ClockTest();
    TimerTask task = new TimerTask() {
        public void run() { 
            test1.count();
        }
    };
    Timer t = new Timer();
    t.schedule(task,0,1000);
}
} 
```

# django - Django + South KeyError：'引擎

> ID：15839989
> 
> 赞同：3
> 
> 时间：2013-04-05T17:32:26.327
> 
> 标签：django, django-south

我正在使用 Django 1.4 和最新的 south + 'ENGINE': 'django.db.backends.mysql' 我将 south 添加到 installed_apps syncdb 返回此错误：

```
ment/commands/__init__.py", line 13, in <module>
from south.management.commands.syncdb import Command as SyncCommand
  File "/usr/local/lib/python2.7/dist-packages/South-0.7.6-py2.7.egg/south/management/commands/syncdb.py", line 17, in <module>
    from south.db import dbs
  File "/usr/local/lib/python2.7/dist-packages/South-0.7.6-py2.7.egg/south/db/__init__.py", line 44, in <module>
    if db_settings['ENGINE'] in engine_modules
KeyError: 'ENGINE' 
```

这取自settings.py：

```
DATABASES = {
    'default': {
        'ENGINE': 'django.db.backends.mysql',
        'NAME': 'db',
        'USER': 'root',
        'PASSWORD': '1111',
        'HOST': '',
        'PORT': '',
    },
    'OPTIONS': {
            'init_command': 'SET storage_engine=INNODB,character_set_connection=utf8,collation_connection=utf8_unicode_ci'
    },
} 
```

我需要在设置中添加一些变量吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-06-05T17:10:37.400

尝试删除 OPTIONS 字典。这对我有用

# javascript - 奇怪的javascript语法

> ID：15839991
> 
> 赞同：2
> 
> 时间：2013-04-05T17:32:31.120
> 
> 标签：javascript, syntax

任何人都可以帮助我使用以下 Js 语法吗？我不明白以 "( $.inArray( wzdId, this....

这是完整的代码：

```
_activateStep: function( wzdId ) {
  if ( condition ) {
    var stepIndex = this._findNav( wzdId ).index(); 
    for( var i = 0; i < stepIndex; ++i) { 
      if( condition ) === -1 ) {
        return;
      }
    }
    ( $.inArray( wzdId, this._activatedSteps ) === -1 ) && this._activatedSteps.push( wzdId );
  }
} 
```

谢谢

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-05T17:34:03.893

你在这里拥有的是

```
A && B 
```

它使用基于短路[逻辑运算符](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Operators/Logical_Operators)的通用技巧：仅当 A 为真时才执行 B。

这是另一种写法

```
if (A) B; 
```

有些人喜欢它，因为它有点短。显然它的可读性也差很多。

# jquery - 单击按钮时获取 Html 表单

> ID：15839992
> 
> 赞同：0
> 
> 时间：2013-04-05T17:32:34.227
> 
> 标签：jquery, forms

当clicci按钮在里面时，我想采用html形式。就像在 jquery Validate 上发生的一样

```
submitHandler: function(form) {
                console.log(form);                   
                saveFunction(form);
            }, 
```

此表单的日志是我单击的表单的结构

里面的 saveFunction 形式是

```
[object HTMLFormElement] 
```

我的页面结构有很多形式，您可以创建一个循环，其中有一个像这样的按钮

```
<button type="button" onclick="delete()">Delete</button> 
```

我想采用单击此按钮的表单结构，例如 find 或最接近

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-08T08:45:49.257

```
<button type="button" onclick="delete(elimina_foto($(this)))">Delete</button> 
```

js：

```
function elimina_foto(n) {
    var form = n.closest('form');
    console.log(n);
    console.log(form.attr('action'));
    console.log(form.serialize());
} 
```